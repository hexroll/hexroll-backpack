var n$$module$libs$htm=function(a,b,c,d){var e;b[0]=0;for(var g=1;g<b.length;g++){var n=b[g++],t=b[g]?(b[0]|=n?1:2,c[b[g++]]):b[++g];3===n?d[0]=t:4===n?d[1]=Object.assign(d[1]||{},t):5===n?(d[1]=d[1]||{})[b[++g]]=t:6===n?d[1][b[++g]]+=t+"":n?(e=a.apply(t,n$$module$libs$htm(a,t,c,["",null])),d.push(e),t[0]?b[0]|=2:(b[g-2]=0,b[g]=e)):d.push(t)}return d},t$$module$libs$htm=new Map,$jscompDefaultExport$$module$libs$htm=function(a){var b=t$$module$libs$htm.get(this);return b||(b=new Map,t$$module$libs$htm.set(this,
b)),1<(b=n$$module$libs$htm(this,b.get(a)||(b.set(a,b=function(c){for(var d,e,g=1,n="",t="",w=[0],z=function(M){1===g&&(M||(n=n.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?w.push(0,M,n):3===g&&(M||n)?(w.push(3,M,n),g=2):2===g&&"..."===n&&M?w.push(4,M,0):2===g&&n&&!M?w.push(5,0,!0,n):5<=g&&((n||!M&&5===g)&&(w.push(g,0,n,e),g=6),M&&(w.push(g,M,0,e),g=6));n=""},C=0;C<c.length;C++){C&&(1===g&&z(),z(C));for(var H=0;H<c[C].length;H++)d=c[C][H],1===g?"<"===d?(z(),w=[w],g=3):n+=d:4===g?"--"===n&&">"===d?(g=1,n=
""):n=d+n[0]:t?d===t?t="":n+=d:'"'===d||"'"===d?t=d:">"===d?(z(),g=1):g&&("="===d?(g=5,e=n,n=""):"/"===d&&(5>g||">"===c[C][H+1])?(z(),3===g&&(w=w[0]),g=w,(w=w[0]).push(2,0,g),g=0):" "===d||"\t"===d||"\n"===d||"\r"===d?(z(),g=2):n+=d),3===g&&"!--"===n&&(g=4,w=w[0])}return z(),w}(a)),b),arguments,[])).length?b:b[0]},module$libs$htm={};module$libs$htm.default=$jscompDefaultExport$$module$libs$htm;var n$$module$libs$preact,l$$module$libs$preact,u$$module$libs$preact,i$$module$libs$preact,t$$module$libs$preact,r$$module$libs$preact,o$$module$libs$preact,f$$module$libs$preact,e$$module$libs$preact,c$$module$libs$preact={},s$$module$libs$preact=[],a$$module$libs$preact=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h$$module$libs$preact(a,b){for(var c in b)a[c]=b[c];return a}function v$$module$libs$preact(a){var b=a.parentNode;b&&b.removeChild(a)}
function y$$module$libs$preact(a,b,c){var d,e,g,n={};for(g in b)"key"==g?d=b[g]:"ref"==g?e=b[g]:n[g]=b[g];if(2<arguments.length&&(n.children=3<arguments.length?n$$module$libs$preact.call(arguments,2):c),"function"==typeof a&&null!=a.defaultProps)for(g in a.defaultProps)void 0===n[g]&&(n[g]=a.defaultProps[g]);return p$$module$libs$preact(a,n,d,e,null)}
function p$$module$libs$preact(a,b,c,d,e){a={type:a,props:b,key:c,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==e?++u$$module$libs$preact:e};return null==e&&null!=l$$module$libs$preact.vnode&&l$$module$libs$preact.vnode(a),a}function d$$module$libs$preact(){return{current:null}}function _$$module$libs$preact(a){return a.children}function k$$module$libs$preact(a,b){this.props=a;this.context=b}
function b$$module$libs$preact(a,b){if(null==b)return a.__?b$$module$libs$preact(a.__,a.__.__k.indexOf(a)+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?b$$module$libs$preact(a):null}function g$$module$libs$preact(a){var b,c;if(null!=(a=a.__)&&null!=a.__c){a.__e=a.__c.base=null;for(b=0;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e){a.__e=a.__c.base=c.__e;break}return g$$module$libs$preact(a)}}
function m$$module$libs$preact(a){(!a.__d&&(a.__d=!0)&&t$$module$libs$preact.push(a)&&!w$$module$libs$preact.__r++||r$$module$libs$preact!==l$$module$libs$preact.debounceRendering)&&((r$$module$libs$preact=l$$module$libs$preact.debounceRendering)||o$$module$libs$preact)(w$$module$libs$preact)}
function w$$module$libs$preact(){var a,b,c,d,e,g,n,t;for(t$$module$libs$preact.sort(f$$module$libs$preact);a=t$$module$libs$preact.shift();)a.__d&&(b=t$$module$libs$preact.length,d=void 0,e=void 0,n=(g=(c=a).__v).__e,(t=c.__P)&&(d=[],(e=h$$module$libs$preact({},g)).__v=g.__v+1,L$$module$libs$preact(t,g,e,c.__n,void 0!==t.ownerSVGElement,null!=g.__h?[n]:null,d,null==n?b$$module$libs$preact(g):n,g.__h),M$$module$libs$preact(d,g),g.__e!=n&&g$$module$libs$preact(g)),t$$module$libs$preact.length>b&&t$$module$libs$preact.sort(f$$module$libs$preact));
w$$module$libs$preact.__r=0}
function x$$module$libs$preact(a,b,c,d,e,g,n,t,w,z){var C,H,M,L,O,S,T=d&&d.__k||s$$module$libs$preact,P=T.length;c.__k=[];for(C=0;C<b.length;C++)if(null!=(L=c.__k[C]=null==(L=b[C])||"boolean"==typeof L||"function"==typeof L?null:"string"==typeof L||"number"==typeof L||"bigint"==typeof L?p$$module$libs$preact(null,L,null,null,L):Array.isArray(L)?p$$module$libs$preact(_$$module$libs$preact,{children:L},null,null,null):0<L.__b?p$$module$libs$preact(L.type,L.props,L.key,L.ref?L.ref:null,L.__v):L)){if(L.__=
c,L.__b=c.__b+1,null===(M=T[C])||M&&L.key==M.key&&L.type===M.type)T[C]=void 0;else for(H=0;H<P;H++){if((M=T[H])&&L.key==M.key&&L.type===M.type){T[H]=void 0;break}M=null}L$$module$libs$preact(a,L,M=M||c$$module$libs$preact,e,g,n,t,w,z);var W=L.__e;(H=L.ref)&&M.ref!=H&&(S||=[],M.ref&&S.push(M.ref,null,L),S.push(H,L.__c||W,L));null!=W?(null==O&&(O=W),"function"==typeof L.type&&L.__k===M.__k?L.__d=w=A$$module$libs$preact(L,w,a):w=C$$module$libs$preact(a,L,M,T,W,w),"function"==typeof c.type&&(c.__d=w)):
w&&M.__e==w&&w.parentNode!=a&&(w=b$$module$libs$preact(M))}c.__e=O;for(C=P;C--;)null!=T[C]&&("function"==typeof c.type&&null!=T[C].__e&&T[C].__e==c.__d&&(c.__d=$$$module$libs$preact(d).nextSibling),S$$module$libs$preact(T[C],T[C]));if(S)for(C=0;C<S.length;C++)O$$module$libs$preact(S[C],S[++C],S[++C])}
function A$$module$libs$preact(a,b,c){for(var d,e=a.__k,g=0;e&&g<e.length;g++)(d=e[g])&&(d.__=a,b="function"==typeof d.type?A$$module$libs$preact(d,b,c):C$$module$libs$preact(c,d,d,e,d.__e,b));return b}function P$$module$libs$preact(a,b){return b=b||[],null==a||"boolean"==typeof a||(Array.isArray(a)?a.some(function(c){P$$module$libs$preact(c,b)}):b.push(a)),b}
function C$$module$libs$preact(a,b,c,d,e,g){if(void 0!==b.__d){var n=b.__d;b.__d=void 0}else if(null==c||e!=g||null==e.parentNode)a:if(null==g||g.parentNode!==a)a.appendChild(e),n=null;else{b=g;for(c=0;(b=b.nextSibling)&&c<d.length;c+=1)if(b==e)break a;a.insertBefore(e,g);n=g}return void 0!==n?n:e.nextSibling}
function $$$module$libs$preact(a){var b,c,d;if(null==a.type||"string"==typeof a.type)return a.__e;if(a.__k)for(b=a.__k.length-1;0<=b;b--)if((c=a.__k[b])&&(d=$$$module$libs$preact(c)))return d;return null}function H$$module$libs$preact(a,b,c,d,e){for(var g in c)"children"===g||"key"===g||g in b||T$$module$libs$preact(a,g,null,c[g],d);for(g in b)e&&"function"!=typeof b[g]||"children"===g||"key"===g||"value"===g||"checked"===g||c[g]===b[g]||T$$module$libs$preact(a,g,b[g],c[g],d)}
function I$$module$libs$preact(a,b,c){"-"===b[0]?a.setProperty(b,null==c?"":c):a[b]=null==c?"":"number"!=typeof c||a$$module$libs$preact.test(b)?c:c+"px"}
function T$$module$libs$preact(a,b,c,d,e){a:if("style"===b)if("string"==typeof c)a.style.cssText=c;else{if("string"==typeof d&&(a.style.cssText=d=""),d)for(b in d)c&&b in c||I$$module$libs$preact(a.style,b,"");if(c)for(b in c)d&&c[b]===d[b]||I$$module$libs$preact(a.style,b,c[b])}else if("o"===b[0]&&"n"===b[1])e=b!==(b=b.replace(/Capture$/,"")),b=b.toLowerCase()in a?b.toLowerCase().slice(2):b.slice(2),a.l||(a.l={}),(a.l[b+e]=c)?d||a.addEventListener(b,e?z$$module$libs$preact:j$$module$libs$preact,
e):a.removeEventListener(b,e?z$$module$libs$preact:j$$module$libs$preact,e);else if("dangerouslySetInnerHTML"!==b){if(e)b=b.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==b&&"height"!==b&&"href"!==b&&"list"!==b&&"form"!==b&&"tabIndex"!==b&&"download"!==b&&b in a)try{a[b]=null==c?"":c;break a}catch(g){}"function"==typeof c||(null==c||!1===c&&-1==b.indexOf("-")?a.removeAttribute(b):a.setAttribute(b,c))}}
function j$$module$libs$preact(a){return this.l[a.type+!1](l$$module$libs$preact.event?l$$module$libs$preact.event(a):a)}function z$$module$libs$preact(a){return this.l[a.type+!0](l$$module$libs$preact.event?l$$module$libs$preact.event(a):a)}
function L$$module$libs$preact(a,b,c,d,e,g,n,t,w){var z,C,H,M,L,O,S,T,P,W,Z,ca,ba,la,ea=b.type;if(void 0!==b.constructor)return null;null!=c.__h&&(w=c.__h,t=b.__e=c.__e,b.__h=null,g=[t]);(z=l$$module$libs$preact.__b)&&z(b);try{a:if("function"==typeof ea){if(T=b.props,P=(z=ea.contextType)&&d[z.__c],W=z?P?P.props.value:z.__:d,c.__c?S=(C=b.__c=c.__c).__=C.__E:("prototype"in ea&&ea.prototype.render?b.__c=C=new ea(T,W):(b.__c=C=new k$$module$libs$preact(T,W),C.constructor=ea,C.render=q$$module$libs$preact),
P&&P.sub(C),C.props=T,C.state||(C.state={}),C.context=W,C.__n=d,H=C.__d=!0,C.__h=[],C._sb=[]),null==C.__s&&(C.__s=C.state),null!=ea.getDerivedStateFromProps&&(C.__s==C.state&&(C.__s=h$$module$libs$preact({},C.__s)),h$$module$libs$preact(C.__s,ea.getDerivedStateFromProps(T,C.__s))),M=C.props,L=C.state,C.__v=b,H)null==ea.getDerivedStateFromProps&&null!=C.componentWillMount&&C.componentWillMount(),null!=C.componentDidMount&&C.__h.push(C.componentDidMount);else{if(null==ea.getDerivedStateFromProps&&T!==
M&&null!=C.componentWillReceiveProps&&C.componentWillReceiveProps(T,W),!C.__e&&null!=C.shouldComponentUpdate&&!1===C.shouldComponentUpdate(T,C.__s,W)||b.__v===c.__v){b.__v!==c.__v&&(C.props=T,C.state=C.__s,C.__d=!1);C.__e=!1;b.__e=c.__e;b.__k=c.__k;b.__k.forEach(function(sa){sa&&(sa.__=b)});for(Z=0;Z<C._sb.length;Z++)C.__h.push(C._sb[Z]);C._sb=[];C.__h.length&&n.push(C);break a}null!=C.componentWillUpdate&&C.componentWillUpdate(T,C.__s,W);null!=C.componentDidUpdate&&C.__h.push(function(){C.componentDidUpdate(M,
L,O)})}if(C.context=W,C.props=T,C.__P=a,ca=l$$module$libs$preact.__r,ba=0,"prototype"in ea&&ea.prototype.render){C.state=C.__s;C.__d=!1;ca&&ca(b);z=C.render(C.props,C.state,C.context);for(la=0;la<C._sb.length;la++)C.__h.push(C._sb[la]);C._sb=[]}else{do C.__d=!1,ca&&ca(b),z=C.render(C.props,C.state,C.context),C.state=C.__s;while(C.__d&&25>++ba)}C.state=C.__s;null!=C.getChildContext&&(d=h$$module$libs$preact(h$$module$libs$preact({},d),C.getChildContext()));H||null==C.getSnapshotBeforeUpdate||(O=C.getSnapshotBeforeUpdate(M,
L));var oa=null!=z&&z.type===_$$module$libs$preact&&null==z.key?z.props.children:z;x$$module$libs$preact(a,Array.isArray(oa)?oa:[oa],b,c,d,e,g,n,t,w);C.base=b.__e;b.__h=null;C.__h.length&&n.push(C);S&&(C.__E=C.__=null);C.__e=!1}else null==g&&b.__v===c.__v?(b.__k=c.__k,b.__e=c.__e):b.__e=N$$module$libs$preact(c.__e,b,c,d,e,g,n,w);(z=l$$module$libs$preact.diffed)&&z(b)}catch(sa){b.__v=null,(w||null!=g)&&(b.__e=t,b.__h=!!w,g[g.indexOf(t)]=null),l$$module$libs$preact.__e(sa,b,c)}}
function M$$module$libs$preact(a,b){l$$module$libs$preact.__c&&l$$module$libs$preact.__c(b,a);a.some(function(c){try{a=c.__h,c.__h=[],a.some(function(d){d.call(c)})}catch(d){l$$module$libs$preact.__e(d,c.__v)}})}
function N$$module$libs$preact(a,b,c,d,e,g,n,t){var w,z,C=c.props,H=b.props,M=b.type,L=0;if("svg"===M&&(e=!0),null!=g)for(;L<g.length;L++)if((w=g[L])&&"setAttribute"in w==!!M&&(M?w.localName===M:3===w.nodeType)){a=w;g[L]=null;break}if(null==a){if(null===M)return document.createTextNode(H);a=e?document.createElementNS("http://www.w3.org/2000/svg",M):document.createElement(M,H.is&&H);g=null;t=!1}if(null===M)C===H||t&&a.data===H||(a.data=H);else{if(g=g&&n$$module$libs$preact.call(a.childNodes),w=(C=
c.props||c$$module$libs$preact).dangerouslySetInnerHTML,z=H.dangerouslySetInnerHTML,!t){if(null!=g)for(C={},L=0;L<a.attributes.length;L++)C[a.attributes[L].name]=a.attributes[L].value;(z||w)&&(z&&(w&&z.__html==w.__html||z.__html===a.innerHTML)||(a.innerHTML=z&&z.__html||""))}if(H$$module$libs$preact(a,H,C,e,t),z)b.__k=[];else if(L=b.props.children,x$$module$libs$preact(a,Array.isArray(L)?L:[L],b,c,d,e&&"foreignObject"!==M,g,n,g?g[0]:c.__k&&b$$module$libs$preact(c,0),t),null!=g)for(L=g.length;L--;)null!=
g[L]&&v$$module$libs$preact(g[L]);t||("value"in H&&void 0!==(L=H.value)&&(L!==a.value||"progress"===M&&!L||"option"===M&&L!==C.value)&&T$$module$libs$preact(a,"value",L,C.value,!1),"checked"in H&&void 0!==(L=H.checked)&&L!==a.checked&&T$$module$libs$preact(a,"checked",L,C.checked,!1))}return a}function O$$module$libs$preact(a,b,c){try{"function"==typeof a?a(b):a.current=b}catch(d){l$$module$libs$preact.__e(d,c)}}
function S$$module$libs$preact(a,b,c){var d,e;if(l$$module$libs$preact.unmount&&l$$module$libs$preact.unmount(a),(d=a.ref)&&(d.current&&d.current!==a.__e||O$$module$libs$preact(d,null,b)),null!=(d=a.__c)){if(d.componentWillUnmount)try{d.componentWillUnmount()}catch(g){l$$module$libs$preact.__e(g,b)}d.base=d.__P=null;a.__c=void 0}if(d=a.__k)for(e=0;e<d.length;e++)d[e]&&S$$module$libs$preact(d[e],b,c||"function"!=typeof a.type);c||null==a.__e||v$$module$libs$preact(a.__e);a.__=a.__e=a.__d=void 0}
function q$$module$libs$preact(a,b,c){return this.constructor(a,c)}
function B$$module$libs$preact(a,b,c){var d;l$$module$libs$preact.__&&l$$module$libs$preact.__(a,b);var e=(d="function"==typeof c)?null:c&&c.__k||b.__k;var g=[];L$$module$libs$preact(b,a=(!d&&c||b).__k=y$$module$libs$preact(_$$module$libs$preact,null,[a]),e||c$$module$libs$preact,c$$module$libs$preact,void 0!==b.ownerSVGElement,!d&&c?[c]:e?null:b.firstChild?n$$module$libs$preact.call(b.childNodes):null,g,!d&&c?c:e?e.__e:b.firstChild,d);M$$module$libs$preact(g,a)}
function D$$module$libs$preact(a,b){B$$module$libs$preact(a,b,D$$module$libs$preact)}function E$$module$libs$preact(a,b,c){var d,e,g,n=h$$module$libs$preact({},a.props);for(g in b)"key"==g?d=b[g]:"ref"==g?e=b[g]:n[g]=b[g];return 2<arguments.length&&(n.children=3<arguments.length?n$$module$libs$preact.call(arguments,2):c),p$$module$libs$preact(a.type,n,d||a.key,e||a.ref,null)}
function F$$module$libs$preact(a,b){var c={__c:b="__cC"+e$$module$libs$preact++,__:a,Consumer:function(d,e){return d.children(e)},Provider:function(d){var e,g;return this.getChildContext||(e=[],(g={})[b]=this,this.getChildContext=function(){return g},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&e.some(function(t){t.__e=!0;m$$module$libs$preact(t)})},this.sub=function(n){e.push(n);var t=n.componentWillUnmount;n.componentWillUnmount=function(){e.splice(e.indexOf(n),1);t&&t.call(n)}}),
d.children}};return c.Provider.__=c.Consumer.contextType=c}n$$module$libs$preact=s$$module$libs$preact.slice;l$$module$libs$preact={__e:function(a,b,c,d){for(var e,g,n;b=b.__;)if((e=b.__c)&&!e.__)try{if((g=e.constructor)&&null!=g.getDerivedStateFromError&&(e.setState(g.getDerivedStateFromError(a)),n=e.__d),null!=e.componentDidCatch&&(e.componentDidCatch(a,d||{}),n=e.__d),n)return e.__E=e}catch(t){a=t}throw a;}};u$$module$libs$preact=0;i$$module$libs$preact=function(a){return null!=a&&void 0===a.constructor};
k$$module$libs$preact.prototype.setState=function(a,b){var c=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=h$$module$libs$preact({},this.state);"function"==typeof a&&(a=a(h$$module$libs$preact({},c),this.props));a&&h$$module$libs$preact(c,a);null!=a&&this.__v&&(b&&this._sb.push(b),m$$module$libs$preact(this))};k$$module$libs$preact.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),m$$module$libs$preact(this))};k$$module$libs$preact.prototype.render=_$$module$libs$preact;
t$$module$libs$preact=[];o$$module$libs$preact="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout;f$$module$libs$preact=function(a,b){return a.__v.__b-b.__v.__b};e$$module$libs$preact=w$$module$libs$preact.__r=0;var module$libs$preact={};module$libs$preact.Component=k$$module$libs$preact;module$libs$preact.Fragment=_$$module$libs$preact;module$libs$preact.cloneElement=E$$module$libs$preact;module$libs$preact.createContext=F$$module$libs$preact;
module$libs$preact.createElement=y$$module$libs$preact;module$libs$preact.createRef=d$$module$libs$preact;module$libs$preact.h=y$$module$libs$preact;module$libs$preact.hydrate=D$$module$libs$preact;module$libs$preact.isValidElement=i$$module$libs$preact;module$libs$preact.options=l$$module$libs$preact;module$libs$preact.render=B$$module$libs$preact;module$libs$preact.toChildArray=P$$module$libs$preact;const PERLIN_YWRAPB$$module$libs$perlin=4,PERLIN_YWRAP$$module$libs$perlin=1<<PERLIN_YWRAPB$$module$libs$perlin,PERLIN_ZWRAPB$$module$libs$perlin=8,PERLIN_ZWRAP$$module$libs$perlin=1<<PERLIN_ZWRAPB$$module$libs$perlin,PERLIN_SIZE$$module$libs$perlin=4095;let perlin_octaves$$module$libs$perlin=4,perlin_amp_falloff$$module$libs$perlin=.5;const scaled_cosine$$module$libs$perlin=a=>.5*(1-Math.cos(a*Math.PI));let perlin$$module$libs$perlin;
function noise$$module$libs$perlin(a,b=0,c=0){if(null==perlin$$module$libs$perlin){perlin$$module$libs$perlin=Array(PERLIN_SIZE$$module$libs$perlin+1);for(var d=0;d<PERLIN_SIZE$$module$libs$perlin+1;d++)perlin$$module$libs$perlin[d]=Math.random()}0>a&&(a=-a);0>b&&(b=-b);0>c&&(c=-c);d=Math.floor(a);let e=Math.floor(b),g=Math.floor(c);a-=d;b-=e;c-=g;let n,t,w=0,z=.5,C,H,M;for(let L=0;L<perlin_octaves$$module$libs$perlin;L++){let O=d+(e<<PERLIN_YWRAPB$$module$libs$perlin)+(g<<PERLIN_ZWRAPB$$module$libs$perlin);
n=scaled_cosine$$module$libs$perlin(a);t=scaled_cosine$$module$libs$perlin(b);C=perlin$$module$libs$perlin[O&PERLIN_SIZE$$module$libs$perlin];C+=n*(perlin$$module$libs$perlin[O+1&PERLIN_SIZE$$module$libs$perlin]-C);H=perlin$$module$libs$perlin[O+PERLIN_YWRAP$$module$libs$perlin&PERLIN_SIZE$$module$libs$perlin];H+=n*(perlin$$module$libs$perlin[O+PERLIN_YWRAP$$module$libs$perlin+1&PERLIN_SIZE$$module$libs$perlin]-H);C+=t*(H-C);O+=PERLIN_ZWRAP$$module$libs$perlin;H=perlin$$module$libs$perlin[O&PERLIN_SIZE$$module$libs$perlin];
H+=n*(perlin$$module$libs$perlin[O+1&PERLIN_SIZE$$module$libs$perlin]-H);M=perlin$$module$libs$perlin[O+PERLIN_YWRAP$$module$libs$perlin&PERLIN_SIZE$$module$libs$perlin];M+=n*(perlin$$module$libs$perlin[O+PERLIN_YWRAP$$module$libs$perlin+1&PERLIN_SIZE$$module$libs$perlin]-M);H+=t*(M-H);C+=scaled_cosine$$module$libs$perlin(c)*(H-C);w+=C*z;z*=perlin_amp_falloff$$module$libs$perlin;d<<=1;a*=2;e<<=1;b*=2;g<<=1;c*=2;1<=a&&(d++,a--);1<=b&&(e++,b--);1<=c&&(g++,c--)}return w}
function noiseDetail$$module$libs$perlin(a,b){0<a&&(perlin_octaves$$module$libs$perlin=a);0<b&&(perlin_amp_falloff$$module$libs$perlin=b)}
function noiseSeed$$module$libs$perlin(a){const b=(()=>{let c,d;return{setSeed(e){d=c=(null==e?4294967296*Math.random():e)>>>0},getSeed(){return c},rand(){d=(1664525*d+1013904223)%4294967296;return d/4294967296}}})();b.setSeed(a);perlin$$module$libs$perlin=Array(PERLIN_SIZE$$module$libs$perlin+1);for(a=0;a<PERLIN_SIZE$$module$libs$perlin+1;a++)perlin$$module$libs$perlin[a]=b.rand()}var module$libs$perlin={};module$libs$perlin.noise=noise$$module$libs$perlin;module$libs$perlin.noiseSeed=noiseSeed$$module$libs$perlin;/*
 GNU Affero General Public License.
 Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 v. 1.2.0
 https://github.com/RaumZeit/MarchingSquares.js

 MarchingSquaresJS is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 MarchingSquaresJS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 As additional permission under GNU Affero General Public License version 3
 section 7, third-party projects (personal or commercial) may distribute,
 include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 requirement that said third-party project for that reason alone becomes
 subject to any requirement of the GNU Affero General Public License version 3.
 Any modifications to MarchingSquaresJS, however, must be shared with the public
 and made available.

 In summary this:
 - allows you to use MarchingSquaresJS at no cost
 - allows you to use MarchingSquaresJS for both personal and commercial purposes
 - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
   license as long as this license notice is included
 - enables you to keep the source code of your program that uses MarchingSquaresJS
   undisclosed
 - forces you to share any modifications you have made to MarchingSquaresJS,
   e.g. bug-fixes

 You should have received a copy of the GNU Affero General Public License
 along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 MIT
 @preserve
 @license GNU Affero General Public License.
 Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 v. 1.2.0
 https://github.com/RaumZeit/MarchingSquares.js

 MarchingSquaresJS is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 MarchingSquaresJS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 As additional permission under GNU Affero General Public License version 3
 section 7, third-party projects (personal or commercial) may distribute,
 include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 requirement that said third-party project for that reason alone becomes
 subject to any requirement of the GNU Affero General Public License version 3.
 Any modifications to MarchingSquaresJS, however, must be shared with the public
 and made available.

 In summary this:
 - allows you to use MarchingSquaresJS at no cost
 - allows you to use MarchingSquaresJS for both personal and commercial purposes
 - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
   license as long as this license notice is included
 - enables you to keep the source code of your program that uses MarchingSquaresJS
   undisclosed
 - forces you to share any modifications you have made to MarchingSquaresJS,
   e.g. bug-fixes

 You should have received a copy of the GNU Affero General Public License
 along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
*/
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b((a="undefined"!=typeof globalThis?globalThis:a||self).turf={})}(this,function(a){function b(f,h,l){void 0===l&&(l={});var q={type:"Feature"};return(0===l.id||l.id)&&(q.id=l.id),l.bbox&&(q.bbox=l.bbox),q.properties=h||{},q.geometry=f,q}function c(f,h,l){switch(f){case "Point":return d(h).geometry;case "LineString":return t(h).geometry;case "Polygon":return g(h).geometry;
case "MultiPoint":return H(h).geometry;case "MultiLineString":return C(h).geometry;case "MultiPolygon":return M(h).geometry;default:throw Error(f+" is invalid");}}function d(f,h,l){if(void 0===l&&(l={}),!f)throw Error("coordinates is required");if(!Array.isArray(f))throw Error("coordinates must be an Array");if(2>f.length)throw Error("coordinates must be at least 2 numbers long");if(!ea(f[0])||!ea(f[1]))throw Error("coordinates must contain numbers");return b({type:"Point",coordinates:f},h,l)}function e(f,
h,l){return void 0===l&&(l={}),z(f.map(function(q){return d(q,h)}),l)}function g(f,h,l){void 0===l&&(l={});for(var q=0;q<f.length;q++){var k=f[q];if(4>k.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var m=0;m<k[k.length-1].length;m++)if(k[k.length-1][m]!==k[0][m])throw Error("First and last Position are not equivalent.");}return b({type:"Polygon",coordinates:f},h,l)}function n(f,h,l){return void 0===l&&(l={}),z(f.map(function(q){return g(q,h)}),l)}function t(f,
h,l){if(void 0===l&&(l={}),2>f.length)throw Error("coordinates must be an array of two or more positions");return b({type:"LineString",coordinates:f},h,l)}function w(f,h,l){return void 0===l&&(l={}),z(f.map(function(q){return t(q,h)}),l)}function z(f,h){void 0===h&&(h={});var l={type:"FeatureCollection"};return h.id&&(l.id=h.id),h.bbox&&(l.bbox=h.bbox),l.features=f,l}function C(f,h,l){return void 0===l&&(l={}),b({type:"MultiLineString",coordinates:f},h,l)}function H(f,h,l){return void 0===l&&(l={}),
b({type:"MultiPoint",coordinates:f},h,l)}function M(f,h,l){return void 0===l&&(l={}),b({type:"MultiPolygon",coordinates:f},h,l)}function L(f,h,l){return void 0===l&&(l={}),b({type:"GeometryCollection",geometries:f},h,l)}function O(f,h){if(void 0===h&&(h=0),h&&!(0<=h))throw Error("precision must be a positive number");h=Math.pow(10,h||0);return Math.round(f*h)/h}function S(f,h){void 0===h&&(h="kilometers");var l=lh[h];if(!l)throw Error(h+" units is invalid");return f*l}function T(f,h){void 0===h&&
(h="kilometers");var l=lh[h];if(!l)throw Error(h+" units is invalid");return f/l}function P(f,h){return Z(T(f,h))}function W(f){f%=360;return 0>f&&(f+=360),f}function Z(f){return f%(2*Math.PI)*180/Math.PI}function ca(f){return f%360*Math.PI/180}function ba(f,h,l){if(void 0===h&&(h="kilometers"),void 0===l&&(l="kilometers"),!(0<=f))throw Error("length must be a positive number");return S(T(f,h),l)}function la(f,h,l){if(void 0===h&&(h="meters"),void 0===l&&(l="kilometers"),!(0<=f))throw Error("area must be a positive number");
h=mh[h];if(!h)throw Error("invalid original units");l=mh[l];if(!l)throw Error("invalid final units");return f/h*l}function ea(f){return!isNaN(f)&&null!==f&&!Array.isArray(f)}function oa(f){return!!f&&f.constructor===Object}function sa(f){if(!f)throw Error("bbox is required");if(!Array.isArray(f))throw Error("bbox must be an Array");if(4!==f.length&&6!==f.length)throw Error("bbox must be an Array of 4 or 6 numbers");f.forEach(function(h){if(!ea(h))throw Error("bbox must only contain numbers");})}function xa(f){if(!f)throw Error("id is required");
if(-1===["string","number"].indexOf(typeof f))throw Error("id must be a number or a string");}function ya(f,h,l){if(null!==f){var q,k,m,r,p=0;var u=f.type;for(var x="FeatureCollection"===u,v="Feature"===u,y=x?f.features.length:1,B=0;B<y;B++){var G=(m=!!(k=x?f.features[B].geometry:v?f.geometry:f)&&"GeometryCollection"===k.type)?k.geometries.length:1;for(var A=0;A<G;A++){var F=0,J=0;if(null!==(q=m?k.geometries[A]:k)){var D=q.coordinates;var E=q.type;switch(r=!l||"Polygon"!==E&&"MultiPolygon"!==E?0:
1,E){case null:break;case "Point":if(!1===h(D,p,B,F,J))return!1;p++;break;case "LineString":case "MultiPoint":for(u=0;u<D.length;u++){if(!1===h(D[u],p,B,F,J))return!1;p++;"MultiPoint"===E&&F++}"LineString"===E&&F++;break;case "Polygon":case "MultiLineString":for(u=0;u<D.length;u++){for(q=0;q<D[u].length-r;q++){if(!1===h(D[u][q],p,B,F,J))return!1;p++}"MultiLineString"===E&&F++;"Polygon"===E&&J++}"Polygon"===E&&F++;break;case "MultiPolygon":for(u=0;u<D.length;u++){for(q=J=0;q<D[u].length;q++){for(E=
0;E<D[u][q].length-r;E++){if(!1===h(D[u][q][E],p,B,F,J))return!1;p++}J++}F++}break;case "GeometryCollection":for(u=0;u<q.geometries.length;u++)if(!1===ya(q.geometries[u],h,l))return!1;break;default:throw Error("Unknown Geometry Type");}}}}}}function Ya(f,h,l,q){var k=l;return ya(f,function(m,r,p,u,x){k=0===r&&void 0===l?m:h(k,m,r,p,u,x)},q),k}function Ja(f,h){var l;switch(f.type){case "FeatureCollection":for(l=0;l<f.features.length&&!1!==h(f.features[l].properties,l);l++);break;case "Feature":h(f.properties,
0)}}function ac(f,h,l){var q=l;return Ja(f,function(k,m){q=0===m&&void 0===l?k:h(q,k,m)}),q}function Ia(f,h){if("Feature"===f.type)h(f,0);else if("FeatureCollection"===f.type)for(var l=0;l<f.features.length&&!1!==h(f.features[l],l);l++);}function Ma(f,h,l){var q=l;return Ia(f,function(k,m){q=0===m&&void 0===l?k:h(q,k,m)}),q}function Nb(f){var h=[];return ya(f,function(l){h.push(l)}),h}function Qb(f,h){var l,q,k,m,r,p=0,u="FeatureCollection"===f.type,x="Feature"===f.type,v=u?f.features.length:1;for(l=
0;l<v;l++){var y=u?f.features[l].geometry:x?f.geometry:f;var B=u?f.features[l].properties:x?f.properties:{};var G=u?f.features[l].bbox:x?f.bbox:void 0;var A=u?f.features[l].id:x?f.id:void 0;var F=(r=!!y&&"GeometryCollection"===y.type)?y.geometries.length:1;for(k=0;k<F;k++)if(null!==(m=r?y.geometries[k]:y))switch(m.type){case "Point":case "LineString":case "MultiPoint":case "Polygon":case "MultiLineString":case "MultiPolygon":if(!1===h(m,p,B,G,A))return!1;break;case "GeometryCollection":for(q=0;q<
m.geometries.length;q++)if(!1===h(m.geometries[q],p,B,G,A))return!1;break;default:throw Error("Unknown Geometry Type");}else if(!1===h(null,p,B,G,A))return!1;p++}}function dd(f,h,l){var q=l;return Qb(f,function(k,m,r,p,u){q=0===m&&void 0===l?k:h(q,k,m,r,p,u)}),q}function eb(f,h){Qb(f,function(l,q,k,m,r){var p=null===l?null:l.type;switch(p){case null:case "Point":case "LineString":case "Polygon":return!1!==h(b(l,k,{bbox:m,id:r}),q,0)&&void 0}switch(p){case "MultiPoint":var u="Point";break;case "MultiLineString":u=
"LineString";break;case "MultiPolygon":u="Polygon"}for(m=0;m<l.coordinates.length;m++)if(!1===h(b({type:u,coordinates:l.coordinates[m]},k),q,m))return!1})}function Vc(f,h,l){var q=l;return eb(f,function(k,m,r){q=0===m&&0===r&&void 0===l?k:h(q,k,m,r)}),q}function Q(f,h){eb(f,function(l,q,k){var m=0;if(l.geometry){var r=l.geometry.type;if("Point"!==r&&"MultiPoint"!==r){var p,u=0,x=0,v=0;return!1!==ya(l,function(y,B,G,A,F){if(void 0===p||q>u||A>x||F>v)return p=y,u=q,x=A,v=F,void(m=0);B=t([p,y],l.properties);
if(!1===h(B,q,k,F,m))return!1;m++;p=y})&&void 0}}})}function R(f,h,l){var q=l,k=!1;return Q(f,function(m,r,p,u,x){q=!1===k&&void 0===l?m:h(q,m,r,p,u,x);k=!0}),q}function V(f,h){if(!f)throw Error("geojson is required");eb(f,function(l,q,k){if(null!==l.geometry){var m=l.geometry.coordinates;switch(l.geometry.type){case "LineString":if(!1===h(l,q,k,0,0))return!1;break;case "Polygon":for(var r=0;r<m.length;r++)if(!1===h(t(m[r],l.properties),q,k,r))return!1}}})}function ja(f,h,l){var q=l;return V(f,function(k,
m,r,p){q=0===m&&void 0===l?k:h(q,k,m,r,p)}),q}function qa(f,h){if(!oa(h=h||{}))throw Error("options is invalid");var l=h.featureIndex||0,q=h.multiFeatureIndex||0,k=h.geometryIndex||0,m=h.segmentIndex||0,r=h.properties;switch(f.type){case "FeatureCollection":0>l&&(l=f.features.length+l);r=r||f.features[l].properties;f=f.features[l].geometry;break;case "Feature":r=r||f.properties;f=f.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;
default:throw Error("geojson is invalid");}if(null===f)return null;l=f.coordinates;switch(f.type){case "Point":case "MultiPoint":return null;case "LineString":return 0>m&&(m=l.length+m-1),t([l[m],l[m+1]],r,h);case "Polygon":return 0>k&&(k=l.length+k),0>m&&(m=l[k].length+m-1),t([l[k][m],l[k][m+1]],r,h);case "MultiLineString":return 0>q&&(q=l.length+q),0>m&&(m=l[q].length+m-1),t([l[q][m],l[q][m+1]],r,h);case "MultiPolygon":return 0>q&&(q=l.length+q),0>k&&(k=l[q].length+k),0>m&&(m=l[q][k].length-m-1),
t([l[q][k][m],l[q][k][m+1]],r,h)}throw Error("geojson is invalid");}function Ca(f,h){if(!oa(h=h||{}))throw Error("options is invalid");var l=h.featureIndex||0,q=h.multiFeatureIndex||0,k=h.geometryIndex||0,m=h.coordIndex||0,r=h.properties;switch(f.type){case "FeatureCollection":0>l&&(l=f.features.length+l);r=r||f.features[l].properties;f=f.features[l].geometry;break;case "Feature":r=r||f.properties;f=f.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;
default:throw Error("geojson is invalid");}if(null===f)return null;l=f.coordinates;switch(f.type){case "Point":return d(l,r,h);case "MultiPoint":return 0>q&&(q=l.length+q),d(l[q],r,h);case "LineString":return 0>m&&(m=l.length+m),d(l[m],r,h);case "Polygon":return 0>k&&(k=l.length+k),0>m&&(m=l[k].length+m),d(l[k][m],r,h);case "MultiLineString":return 0>q&&(q=l.length+q),0>m&&(m=l[q].length+m),d(l[q][m],r,h);case "MultiPolygon":return 0>q&&(q=l.length+q),0>k&&(k=l[q].length+k),0>m&&(m=l[q][k].length-
m),d(l[q][k][m],r,h)}throw Error("geojson is invalid");}function Aa(f){var h=[1/0,1/0,-1/0,-1/0];return ya(f,function(l){h[0]>l[0]&&(h[0]=l[0]);h[1]>l[1]&&(h[1]=l[1]);h[2]<l[0]&&(h[2]=l[0]);h[3]<l[1]&&(h[3]=l[1])}),h}function ia(f){if(!f)throw Error("coord is required");if(!Array.isArray(f)){if("Feature"===f.type&&null!==f.geometry&&"Point"===f.geometry.type)return f.geometry.coordinates;if("Point"===f.type)return f.coordinates}if(Array.isArray(f)&&2<=f.length&&!Array.isArray(f[0])&&!Array.isArray(f[1]))return f;
throw Error("coord must be GeoJSON Point or an Array of numbers");}function fa(f){if(Array.isArray(f))return f;if("Feature"===f.type){if(null!==f.geometry)return f.geometry.coordinates}else if(f.coordinates)return f.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array");}function za(f){if(1<f.length&&ea(f[0])&&ea(f[1]))return!0;if(Array.isArray(f[0])&&f[0].length)return za(f[0]);throw Error("coordinates must only contain numbers");}function Ra(f,h,l){if(!h||!l)throw Error("type and name required");
if(!f||f.type!==h)throw Error("Invalid input to "+l+": must be a "+h+", given "+f.type);}function Sb(f,h,l){if(!f)throw Error("No feature passed");if(!l)throw Error(".featureOf() requires a name");if(!f||"Feature"!==f.type||!f.geometry)throw Error("Invalid input to "+l+", Feature with geometry required");if(!f.geometry||f.geometry.type!==h)throw Error("Invalid input to "+l+": must be a "+h+", given "+f.geometry.type);}function Na(f,h,l){if(!f)throw Error("No featureCollection passed");if(!l)throw Error(".collectionOf() requires a name");
if(!f||"FeatureCollection"!==f.type)throw Error("Invalid input to "+l+", FeatureCollection required");var q=0;for(f=f.features;q<f.length;q++){var k=f[q];if(!k||"Feature"!==k.type||!k.geometry)throw Error("Invalid input to "+l+", Feature with geometry required");if(!k.geometry||k.geometry.type!==h)throw Error("Invalid input to "+l+": must be a "+h+", given "+k.geometry.type);}}function Lb(f){return"Feature"===f.type?f.geometry:f}function sc(f,h){return"FeatureCollection"===f.type?"FeatureCollection":
"GeometryCollection"===f.type?"GeometryCollection":"Feature"===f.type&&null!==f.geometry?f.geometry.type:f.type}function ef(f,h,l){l=l||{};for(var q=Object.keys(Rj),k=0;k<q.length;k++){var m=q[k],r=l[m];r=null!=r?r:Rj[m];nh[m]=r}nh.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+h);f=function(p){var u=[],x=0;return p.cells.forEach(function(v,y){v.forEach(function(B,G){var A;if(void 0!==B&&5!==(A=B).cval&&10!==A.cval&&0!==B.cval&&15!==B.cval){a:{B=p.cells;var F=B.length,
J=[],D=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],E=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],I="none bottom right right top top top top left bottom right right left bottom left none".split(" "),K=B[y][G],N=K.cval,U="none left bottom left right none bottom left top top none top right right bottom none".split(" ")[N];U=ff(K,U);J.push([G+U[0],y+U[1]]);U=I[N];U=ff(K,U);J.push([G+U[0],y+U[1]]);wc(K);for(var X=G+D[N],aa=y+E[N],ha=N;0<=X&&0<=aa&&aa<F&&(X!=G||aa!=y)&&void 0!==(K=B[aa][X]);){if(0===(N=K.cval)||15===
N){G=J;A="mergeable";break a}U=I[N];A=D[N];var da=E[N];5!==N&&10!==N||(5===N?K.flipped?-1===E[ha]?(U="left",A=-1,da=0):(U="right",A=1,da=0):-1===D[ha]&&(U="bottom",A=0,da=-1):10===N&&(K.flipped?-1===D[ha]?(U="top",A=0,da=1):(U="bottom",A=0,da=-1):1===E[ha]&&(U="left",A=-1,da=0)));U=ff(K,U);J.push([X+U[0],aa+U[1]]);wc(K);X+=A;aa+=da;ha=N}G=J;A="closed"}B=!1;if("mergeable"===A)for(da=G[G.length-1][0],F=G[G.length-1][1],A=x-1;0<=A;A--)if(1E-7>=Math.abs(u[A][0][0]-da)&&1E-7>=Math.abs(u[A][0][1]-F)){for(B=
G.length-2;0<=B;--B)u[A].unshift(G[B]);B=!0;break}B||(u[x++]=G)}})}),u}(function(p,u){for(var x=p.length-1,v=p[0].length-1,y={rows:x,cols:v,cells:[]},B=0;B<x;++B){y.cells[B]=[];for(var G=0;G<v;++G){var A=0,F=p[B+1][G],J=p[B+1][G+1],D=p[B][G+1],E=p[B][G];if(!(isNaN(F)||isNaN(J)||isNaN(D)||isNaN(E))){A|=F>=u?8:0;A|=J>=u?4:0;A|=D>=u?2:0;var I,K,N,U=!1;if(5===(A|=E>=u?1:0)||10===A){var X=(F+J+D+E)/4;5===A&&X<u?(A=10,U=!0):10===A&&X<u&&(A=5,U=!0)}0!==A&&15!==A&&(X=I=K=N=.5,1===A?(K=1-bb(u,F,E),I=1-bb(u,
D,E)):2===A?(I=bb(u,E,D),N=1-bb(u,J,D)):3===A?(K=1-bb(u,F,E),N=1-bb(u,J,D)):4===A?(X=bb(u,F,J),N=bb(u,D,J)):5===A?(X=bb(u,F,J),N=bb(u,D,J),I=1-bb(u,D,E),K=1-bb(u,F,E)):6===A?(I=bb(u,E,D),X=bb(u,F,J)):7===A?(K=1-bb(u,F,E),X=bb(u,F,J)):8===A?(K=bb(u,E,F),X=1-bb(u,J,F)):9===A?(I=1-bb(u,D,E),X=1-bb(u,J,F)):10===A?(X=1-bb(u,J,F),N=1-bb(u,J,D),I=bb(u,E,D),K=bb(u,E,F)):11===A?(X=1-bb(u,J,F),N=1-bb(u,J,D)):12===A?(K=bb(u,E,F),N=bb(u,D,J)):13===A?(I=1-bb(u,D,E),N=bb(u,D,J)):14===A?(K=bb(u,E,F),I=bb(u,E,D)):
console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+A),y.cells[B][G]={cval:A,flipped:U,top:X,right:N,bottom:I,left:K})}}}return y}(f,h));return"function"==typeof nh.successCallback&&nh.successCallback(f),f}function bb(f,h,l){return(f-h)/(l-h)}function wc(f){0===f.cval||15===f.cval||5===f.cval||10===f.cval||(f.cval=15)}function ff(f,h){return"top"===h?[f.top,1]:"bottom"===h?[f.bottom,0]:"right"===h?[1,f.right]:"left"===h?[0,f.left]:void 0}function oh(f,h){if(!oa(h=h||{}))throw Error("options is invalid");
var l=h.zProperty||"elevation",q=h.flip;h=h.flags;Na(f,"Point","input must contain Points");f=function(x,v){var y={};return Ia(x,function(B){var G=fa(B)[1];y[G]||(y[G]=[]);y[G].push(B)}),Object.keys(y).map(function(B){return y[B].sort(function(G,A){return fa(G)[0]-fa(A)[0]})}).sort(function(B,G){return v?fa(B[0])[1]-fa(G[0])[1]:fa(G[0])[1]-fa(B[0])[1]})}(f,q);q=[];for(var k=0;k<f.length;k++){for(var m=f[k],r=[],p=0;p<m.length;p++){var u=m[p];u.properties[l]?r.push(u.properties[l]):r.push(0);!0===
h&&(u.properties.matrixPosition=[k,p])}q.push(r)}return q}function bc(f,h,l,q,k){xc(f,h,l||0,q||f.length-1,k||Cn)}function xc(f,h,l,q,k){for(;q>l;){if(600<q-l){var m=q-l+1,r=h-l+1,p=Math.log(m),u=.5*Math.exp(2*p/3);p=.5*Math.sqrt(p*u*(m-u)/m)*(0>r-m/2?-1:1);xc(f,h,Math.max(l,Math.floor(h-r*u/m+p)),Math.min(q,Math.floor(h+(m-r)*u/m+p)),k)}m=f[h];r=l;u=q;ie(f,l,h);for(0<k(f[q],m)&&ie(f,l,q);r<u;){ie(f,r,u);r++;for(u--;0>k(f[r],m);)r++;for(;0<k(f[u],m);)u--}0===k(f[l],m)?ie(f,l,u):ie(f,++u,q);u<=h&&
(l=u+1);h<=u&&(q=u-1)}}function ie(f,h,l){var q=f[h];f[h]=f[l];f[l]=q}function Cn(f,h){return f<h?-1:f>h?1:0}function mg(f,h){if(!(this instanceof mg))return new mg(f,h);this._maxEntries=Math.max(4,f||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));h&&this._initFormat(h);this.clear()}function Bf(f,h){ng(f,0,f.children.length,h,f)}function ng(f,h,l,q,k){k||=Cf(null);k.minX=1/0;k.minY=1/0;k.maxX=-1/0;k.maxY=-1/0;for(var m=h;m<l;m++)h=f.children[m],og(k,f.leaf?q(h):h);return k}function og(f,
h){return f.minX=Math.min(f.minX,h.minX),f.minY=Math.min(f.minY,h.minY),f.maxX=Math.max(f.maxX,h.maxX),f.maxY=Math.max(f.maxY,h.maxY),f}function Sj(f,h){return f.minX-h.minX}function Tj(f,h){return f.minY-h.minY}function oi(f){return(f.maxX-f.minX)*(f.maxY-f.minY)}function ph(f){return f.maxX-f.minX+(f.maxY-f.minY)}function pi(f,h){return f.minX<=h.minX&&f.minY<=h.minY&&h.maxX<=f.maxX&&h.maxY<=f.maxY}function qh(f,h){return h.minX<=f.maxX&&h.minY<=f.maxY&&h.maxX>=f.minX&&h.maxY>=f.minY}function Cf(f){return{children:f,
height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Uj(f,h,l,q,k){for(var m,r=[h,l];r.length;)(l=r.pop())-(h=r.pop())<=q||(m=h+Math.ceil((l-h)/q/2)*q,Vj(f,m,h,l,k),r.push(h,m,m,l))}function je(f){var h={exports:{}};return f(h,h.exports),h.exports}function pg(f,h){if(!(this instanceof pg))return new pg(f,h);if(this.data=f||[],this.length=this.data.length,this.compare=h||Dn,0<this.length)for(f=(this.length>>1)-1;0<=f;f--)this._down(f)}function Dn(f,h){return f<h?-1:f>h?1:0}function Wj(f,
h,l){h=Math.max(0,void 0===h?2:h);l=l||0;for(var q,k=f[0],m=f[0],r=f[0],p=f[0],u=0;u<f.length;u++){var x=f[u];x[0]<k[0]&&(k=x);x[0]>r[0]&&(r=x);x[1]<m[1]&&(m=x);x[1]>p[1]&&(p=x)}m=[k,m,r,p];k=m.slice();for(u=0;u<f.length;u++){p=f[u];r=p[0];p=p[1];x=!1;for(var v=0,y=m.length-1;v<m.length;y=v++){var B=m[v][0],G=m[v][1],A=m[y][0];y=m[y][1];G>p!=y>p&&r<(A-B)*(p-G)/(y-G)+B&&(x=!x)}x||k.push(f[u])}r=En(k);m=[];for(u=0;u<r.length;u++)m.push(k[r[u]]);f=Wc(16,["[0]","[1]","[0]","[1]"]).load(f);u=[];for(r=
0;r<m.length;r++){var F=m[r];f.remove(F);q=Xj(F,q);u.push(q)}k=Wc(16);for(r=0;r<u.length;r++)k.insert(qi(u[r]));h*=h;for(m=l*l;u.length;)if(l=u.shift(),r=l.p,p=l.next.p,x=ri(r,p),!(x<m)){x/=h;a:{var J=f;v=l.prev.p;B=r;G=p;A=l.next.next.p;y=x;var D=k,E=new Yj(null,Fn);for(J=J.data;J;){for(var I=0;I<J.children.length;I++){var K=J.children[I],N=J.leaf?si(K,B,G):Gn(B,G,K);N>y||E.push({node:K,dist:N})}for(;E.length&&!E.peek().node.children;){I=E.pop();K=I.node;N=si(K,v,B);var U=si(K,G,A);if(I.dist<N&&
I.dist<U&&Zj(B,K,D)&&Zj(G,K,D)){v=K;break a}}(J=E.pop())&&(J=J.node)}v=null}(F=v)&&Math.min(ri(F,r),ri(F,p))<=x&&(u.push(l),u.push(Xj(F,l)),f.remove(F),k.remove(l),k.insert(qi(l)),k.insert(qi(l.next)))}l=q;F=[];do F.push(l.p),l=l.next;while(l!==q);return F.push(l.p),F}function Fn(f,h){return f.dist-h.dist}function Gn(f,h,l){if(ak(f,l)||ak(h,l))return 0;var q=rh(f[0],f[1],h[0],h[1],l.minX,l.minY,l.maxX,l.minY);if(0===q)return 0;var k=rh(f[0],f[1],h[0],h[1],l.minX,l.minY,l.minX,l.maxY);if(0===k)return 0;
var m=rh(f[0],f[1],h[0],h[1],l.maxX,l.minY,l.maxX,l.maxY);if(0===m)return 0;f=rh(f[0],f[1],h[0],h[1],l.minX,l.maxY,l.maxX,l.maxY);return 0===f?0:Math.min(q,k,m,f)}function ak(f,h){return f[0]>=h.minX&&f[0]<=h.maxX&&f[1]>=h.minY&&f[1]<=h.maxY}function Zj(f,h,l){var q,k,m,r;l=l.search({minX:Math.min(f[0],h[0]),minY:Math.min(f[1],h[1]),maxX:Math.max(f[0],h[0]),maxY:Math.max(f[1],h[1])});for(var p=0;p<l.length;p++)if(q=l[p].p,k=l[p].next.p,m=f,q!==(r=h)&&k!==m&&0<sh(q,k,m)!=0<sh(q,k,r)&&0<sh(m,r,q)!=
0<sh(m,r,k))return!1;return!0}function qi(f){var h=f.p,l=f.next.p;return f.minX=Math.min(h[0],l[0]),f.minY=Math.min(h[1],l[1]),f.maxX=Math.max(h[0],l[0]),f.maxY=Math.max(h[1],l[1]),f}function Xj(f,h){f={p:f,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return h?(f.next=h.next,f.prev=h,h.next.prev=f,h.next=f):(f.prev=f,f.next=f),f}function ri(f,h){var l=f[0]-h[0];f=f[1]-h[1];return l*l+f*f}function si(f,h,l){var q=h[0];h=h[1];var k=l[0]-q,m=l[1]-h;if(0!==k||0!==m){var r=((f[0]-q)*k+(f[1]-h)*m)/
(k*k+m*m);1<r?(q=l[0],h=l[1]):0<r&&(q+=k*r,h+=m*r)}return(k=f[0]-q)*k+(m=f[1]-h)*m}function rh(f,h,l,q,k,m,r,p){var u,x,v,y,B=l-f,G=q-h,A=r-k,F=p-m,J=f-k,D=h-m,E=B*B+G*G,I=B*A+G*F,K=A*A+F*F;B=B*J+G*D;F=A*J+F*D;D=A=J=E*K-I*I;0===J?(x=0,A=1,y=F,D=K):(y=E*F-I*B,0>(x=I*F-K*B)?(x=0,y=F,D=K):x>A&&(x=A,y=F+I,D=K));0>y?(y=0,0>-B?x=0:-B>E?x=A:(x=-B,A=E)):y>D&&(y=D,0>-B+I?x=0:-B+I>E?x=A:(x=-B+I,A=E));y=(1-(v=0===y?0:y/D))*k+v*r-((1-(u=0===x?0:x/A))*f+u*l);f=(1-v)*m+v*p-((1-u)*h+u*q);return y*y+f*f}function bk(f,
h){void 0===h&&(h={});h.concavity=h.concavity||1/0;var l=[];if(ya(f,function(q){l.push([q[0],q[1]])}),!l.length)return null;f=ck(l,h.concavity);return 3<f.length?g([f]):null}function Wb(f,h,l){if(void 0===l&&(l={}),!f)throw Error("point is required");if(!h)throw Error("polygon is required");f=ia(f);var q=Lb(h),k=h.bbox;h=q.coordinates;if(k&&!1===(k[0]<=f[0]&&k[1]<=f[1]&&k[2]>=f[0]&&k[3]>=f[1]))return!1;"Polygon"===q.type&&(h=[h]);q=!1;for(k=0;k<h.length&&!q;k++)if(dk(f,h[k][0],l.ignoreBoundary)){for(var m=
!1,r=1;r<h[k].length&&!m;)dk(f,h[k][r],!l.ignoreBoundary)&&(m=!0),r++;m||(q=!0)}return q}function dk(f,h,l){var q=!1;h[0][0]===h[h.length-1][0]&&h[0][1]===h[h.length-1][1]&&(h=h.slice(0,h.length-1));for(var k=0,m=h.length-1;k<h.length;m=k++){var r=h[k][0],p=h[k][1],u=h[m][0];m=h[m][1];if(0==f[1]*(r-u)+p*(u-f[0])+m*(f[0]-r)&&0>=(r-f[0])*(u-f[0])&&0>=(p-f[1])*(m-f[1]))return!l;p>f[1]!=m>f[1]&&f[0]<(u-r)*(f[1]-p)/(m-p)+r&&(q=!q)}return q}function ti(f,h){var l=[];return Ia(f,function(q){var k=!1;if("Point"===
q.geometry.type)Qb(h,function(r){Wb(q,r)&&(k=!0)}),k&&l.push(q);else{if("MultiPoint"!==q.geometry.type)throw Error("Input geometry must be a Point or MultiPoint");var m=[];Qb(h,function(r){ya(q,function(p){Wb(p,r)&&(k=!0,m.push(p))})});k&&l.push(H(m))}}),z(l)}function Ob(f,h,l){void 0===l&&(l={});var q=ia(f),k=ia(h);h=ca(k[1]-q[1]);f=ca(k[0]-q[0]);q=ca(q[1]);k=ca(k[1]);h=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(f/2),2)*Math.cos(q)*Math.cos(k);return S(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),
l.units)}function ek(f,h){var l=!1;return z(function(q){if(3>q.length)return[];q.sort(Hn);var k,m=q.length-1,r=q[m].x;var p=q[0].x;for(var u=q[m].y,x=u;m--;)q[m].y<u&&(u=q[m].y),q[m].y>x&&(x=q[m].y);var v,y=p-r,B=x-u;m=y>B?y:B;r=.5*(p+r);u=.5*(x+u);u=[new fk({__sentinel:!0,x:r-20*m,y:u-m},{__sentinel:!0,x:r,y:u+20*m},{__sentinel:!0,x:r+20*m,y:u-m})];x=[];r=[];for(m=q.length;m--;){r.length=0;for(v=u.length;v--;)0<(y=q[m].x-u[v].x)&&y*y>u[v].r?(x.push(u[v]),u.splice(v,1)):y*y+(B=q[m].y-u[v].y)*B>u[v].r||
(r.push(u[v].a,u[v].b,u[v].b,u[v].c,u[v].c,u[v].a),u.splice(v,1));var G=p=void 0;var A=r;var F=A.length;a:for(;F;){v=A[--F];var J=A[--F];for(k=F;k;)if(p=A[--k],J===(G=A[--k])&&v===p||J===p&&v===G){A.splice(F,2);A.splice(k,2);F-=2;continue a}}for(v=r.length;v;)G=r[--v],p=r[--v],k=q[m],J=G.x-p.x,A=G.y-p.y,J=2*(J*(k.y-G.y)-A*(k.x-G.x)),1E-12<Math.abs(J)&&u.push(new fk(p,G,k))}Array.prototype.push.apply(x,u);for(m=x.length;m--;)(x[m].a.__sentinel||x[m].b.__sentinel||x[m].c.__sentinel)&&x.splice(m,1);
return x}(f.features.map(function(q){var k={x:q.geometry.coordinates[0],y:q.geometry.coordinates[1]};return h?k.z=q.properties[h]:3===q.geometry.coordinates.length&&(l=!0,k.z=q.geometry.coordinates[2]),k})).map(function(q){var k=[q.a.x,q.a.y],m=[q.b.x,q.b.y],r=[q.c.x,q.c.y],p={};return l?(k.push(q.a.z),m.push(q.b.z),r.push(q.c.z)):p={a:q.a.z,b:q.b.z,c:q.c.z},g([[k,m,r,k]],p)}))}function Hn(f,h){return h.x-f.x}function Ec(f){if(!f)throw Error("geojson is required");switch(f.type){case "Feature":return gk(f);
case "FeatureCollection":return function(h){var l={type:"FeatureCollection"};return Object.keys(h).forEach(function(q){switch(q){case "type":case "features":break;default:l[q]=h[q]}}),l.features=h.features.map(function(q){return gk(q)}),l}(f);case "Point":case "LineString":case "Polygon":case "MultiPoint":case "MultiLineString":case "MultiPolygon":case "GeometryCollection":return ui(f);default:throw Error("unknown GeoJSON type");}}function gk(f){var h={type:"Feature"};return Object.keys(f).forEach(function(l){switch(l){case "type":case "properties":case "geometry":break;
default:h[l]=f[l]}}),h.properties=hk(f.properties),h.geometry=ui(f.geometry),h}function hk(f){var h={};return f?(Object.keys(f).forEach(function(l){var q=f[l];"object"==typeof q?null===q?h[l]=null:Array.isArray(q)?h[l]=q.map(function(k){return k}):h[l]=hk(q):h[l]=q}),h):h}function ui(f){var h={type:f.type};return f.bbox&&(h.bbox=f.bbox),"GeometryCollection"===f.type?(h.geometries=f.geometries.map(function(l){return ui(l)}),h):(h.coordinates=ik(f.coordinates),h)}function ik(f){return"object"!=typeof f[0]?
f.slice():f.map(function(h){return ik(h)})}function In(f,h){if(void 0===h&&(h={}),!oa(h=h||{}))throw Error("options is invalid");h=h.mutate;if("FeatureCollection"!==sc(f))throw Error("geojson must be a FeatureCollection");if(!f.features.length)throw Error("geojson is empty");!1!==h&&void 0!==h||(f=Ec(f));var l=[];f=ja(f,function(q,k){a:{var m=q.geometry.coordinates;var r=k.geometry.coordinates,p=th(m[0]),u=th(m[m.length-1]),x=th(r[0]),v=th(r[r.length-1]);if(p===v)m=r.concat(m.slice(1));else if(x===
u)m=m.concat(r.slice(1));else if(p===x)m=m.slice(1).reverse().concat(r);else{if(u!==v){m=null;break a}m=m.concat(r.reverse().slice(1))}m=t(m)}return m||(l.push(q),k)});return f&&l.push(f),l.length?1===l.length?l[0]:C(l.map(function(q){return q.coordinates})):null}function th(f){return f[0].toString()+","+f[1].toString()}function Jn(f){return f}function jk(f,h){function l(u){return r(u)}function q(u){for(var x=[],v=0,y=u.length;v<y;++v){var B,G=u[v],A=x;A.length&&A.pop();var F=p[0>G?~G:G],J=0;for(B=
F.length;J<B;++J)A.push(r(F[J],J));if(0>G)for(G=A.length,F=G-B;F<--G;)B=A[F],A[F++]=A[G],A[G]=B}return 2>x.length&&x.push(x[0]),x}function k(u){for(u=q(u);4>u.length;)u.push(u[0]);return u}function m(u){return u.map(k)}var r=function(u){if(null==u)return Jn;var x,v,y=u.scale[0],B=u.scale[1],G=u.translate[0],A=u.translate[1];return function(F,J){J||(x=v=0);J=2;var D=F.length,E=Array(D);E[0]=(x+=F[0])*y+G;for(E[1]=(v+=F[1])*B+A;J<D;)E[J]=F[J],++J;return E}}(f.transform),p=f.arcs;return function v(x){var y=
x.type;switch(y){case "GeometryCollection":return{type:y,geometries:x.geometries.map(v)};case "Point":x=r(x.coordinates);break;case "MultiPoint":x=x.coordinates.map(l);break;case "LineString":x=q(x.arcs);break;case "MultiLineString":x=x.arcs.map(q);break;case "Polygon":x=m(x.arcs);break;case "MultiPolygon":x=x.arcs.map(m);break;default:return null}return{type:y,coordinates:x}}(h)}function Kn(f,h){function l(u,x){for(var v in u){var y=u[v];delete x[y.start];delete y.start;delete y.end;y.forEach(function(B){q[0>
B?~B:B]=1});r.push(y)}}var q={},k={},m={},r=[],p=-1;return h.forEach(function(u,x){var v,y=f.arcs[0>u?~u:u];3>y.length&&!y[1][0]&&!y[1][1]&&(v=h[++p],h[p]=u,h[x]=v)}),h.forEach(function(u){var x=function(B){var G,A=f.arcs[0>B?~B:B],F=A[0];f.transform?(G=[0,0],A.forEach(function(J){G[0]+=J[0];G[1]+=J[1]})):G=A[A.length-1];return 0>B?[G,F]:[F,G]}(u);var v=x[0],y=x[1];(x=m[v])?(delete m[x.end],x.push(u),x.end=y,u=k[y])?(delete k[u.start],v=u===x?x:x.concat(u),k[v.start=x.start]=m[v.end=u.end]=v):k[x.start]=
m[x.end]=x:(x=k[y])?(delete k[x.start],x.unshift(u),x.start=v,u=m[v])?(delete m[u.end],v=u===x?x:u.concat(x),k[v.start=u.start]=m[v.end=x.end]=v):k[x.start]=m[x.end]=x:k[(x=[u]).start=v]=m[x.end=y]=x}),l(m,k),l(k,m),h.forEach(function(u){q[0>u?~u:u]||r.push([u])}),r}function Ln(f,h){function l(p){p.forEach(function(u){u.forEach(function(x){(k[x=0>x?~x:x]||(k[x]=[])).push(p)})});m.push(p)}function q(p){p=jk(f,{type:"Polygon",arcs:[p]}).coordinates[0];for(var u,x=-1,v=p.length,y=p[v-1],B=0;++x<v;)u=
y,y=p[x],B+=u[0]*y[1]-u[1]*y[0];return Math.abs(B)}var k={},m=[],r=[];return h.forEach(function x(u){switch(u.type){case "GeometryCollection":u.geometries.forEach(x);break;case "Polygon":l(u.arcs);break;case "MultiPolygon":u.arcs.forEach(l)}}),m.forEach(function(u){if(!u._){var x=[],v=[u];u._=1;for(r.push(x);u=v.pop();)x.push(u),u.forEach(function(y){y.forEach(function(B){k[0>B?~B:B].forEach(function(G){G._||(G._=1,v.push(G))})})})}}),m.forEach(function(u){delete u._}),{type:"MultiPolygon",arcs:r.map(function(u){var x=
[];if(u.forEach(function(A){A.forEach(function(F){F.forEach(function(J){2>k[0>J?~J:J].length&&x.push(J)})})}),1<(u=(x=Kn(f,x)).length))for(var v,y,B=1,G=q(x[0]);B<u;++B)(v=q(x[B]))>G&&(y=x[0],x[0]=x[B],x[B]=y,G=v);return x}).filter(function(u){return 0<u.length})}}function vi(f,h,l,q,k,m){3===arguments.length&&(q=m=Array,k=null);for(var r=new q(f=1<<Math.max(4,Math.ceil(Math.log(f)/Math.LN2))),p=new m(f),u=f-1,x=0;x<f;++x)r[x]=k;return{set:function(v,y){for(var B=h(v)&u,G=r[B],A=0;G!=k;){if(l(G,v))return p[B]=
y;if(++A>=f)throw Error("full hashmap");G=r[B=B+1&u]}return r[B]=v,p[B]=y,y},maybeSet:function(v,y){for(var B=h(v)&u,G=r[B],A=0;G!=k;){if(l(G,v))return p[B];if(++A>=f)throw Error("full hashmap");G=r[B=B+1&u]}return r[B]=v,p[B]=y,y},get:function(v,y){for(var B=h(v)&u,G=r[B],A=0;G!=k;){if(l(G,v))return p[B];if(++A>=f)break;G=r[B=B+1&u]}return y},keys:function(){for(var v=[],y=0,B=r.length;y<B;++y){var G=r[y];G!=k&&v.push(G)}return v}}}function gf(f,h){return f[0]===h[0]&&f[1]===h[1]}function wi(f){kk[0]=
f[0];kk[1]=f[1];f=uh[0]^uh[1];return 2147483647&(f<<5^f>>7^uh[2]^uh[3])}function Mn(f){function h(I,K,N,U){if(x[N]!==I)if(x[N]=I,I=v[N],0<=I){var X=y[N];I===K&&X===U||I===U&&X===K||(++G,B[N]=1)}else v[N]=K,y[N]=U}function l(I){return wi(m[I])}function q(I,K){return gf(m[I],m[K])}var k,m=f.coordinates,r=f.lines,p=f.rings,u=function(){for(var I=vi(1.4*m.length,l,q,Int32Array,-1,Int32Array),K=new Int32Array(m.length),N=0,U=m.length;N<U;++N)K[N]=I.maybeSet(N,N);return K}(),x=new Int32Array(m.length),
v=new Int32Array(m.length),y=new Int32Array(m.length),B=new Int8Array(m.length),G=0;f=0;for(k=m.length;f<k;++f)x[f]=v[f]=y[f]=-1;f=0;for(k=r.length;f<k;++f){var A=r[f];var F=A[0],J=A[1];A=u[F];var D=u[++F];++G;for(B[A]=1;++F<=J;)h(f,A,A=D,D=u[F]);++G;B[D]=1}f=0;for(k=m.length;f<k;++f)x[f]=-1;f=0;for(k=p.length;f<k;++f)for(A=p[f],r=A[0]+1,F=A[1],h(f,u[F-1],A=u[r-1],D=u[r]);++r<=F;)h(f,A,A=D,D=u[r]);x=v=y=null;var E;p=function(I,K,N,U,X){3===arguments.length&&(U=Array,X=null);for(var aa=new U(I=1<<
Math.max(4,Math.ceil(Math.log(I)/Math.LN2))),ha=I-1,da=0;da<I;++da)aa[da]=X;return{add:function(ka){for(var pa=K(ka)&ha,ra=aa[pa],ma=0;ra!=X;){if(N(ra,ka))return!0;if(++ma>=I)throw Error("full hashset");ra=aa[pa=pa+1&ha]}return aa[pa]=ka,!0},has:function(ka){for(var pa=K(ka)&ha,ra=aa[pa],ma=0;ra!=X;){if(N(ra,ka))return!0;if(++ma>=I)break;ra=aa[pa=pa+1&ha]}return!1},values:function(){for(var ka=[],pa=0,ra=aa.length;pa<ra;++pa){var ma=aa[pa];ma!=X&&ka.push(ma)}return ka}}}(1.4*G,wi,gf);f=0;for(k=m.length;f<
k;++f)B[E=u[f]]&&p.add(m[E]);return p}function xi(f,h,l){for(var q,k=h+(l-- -h>>1);h<k;++h,--l)q=f[h],f[h]=f[l],f[l]=q}function Nn(f){var h,l,q={};for(h in f)q[h]=null==(l=f[h])?{type:null}:("FeatureCollection"===l.type?On:"Feature"===l.type?lk:yi)(l);return q}function On(f){var h={type:"GeometryCollection",geometries:f.features.map(lk)};return null!=f.bbox&&(h.bbox=f.bbox),h}function lk(f){var h,l=yi(f.geometry);for(h in null!=f.id&&(l.id=f.id),null!=f.bbox&&(l.bbox=f.bbox),f.properties){l.properties=
f.properties;break}return l}function yi(f){if(null==f)return{type:null};var h="GeometryCollection"===f.type?{type:"GeometryCollection",geometries:f.geometries.map(yi)}:"Point"===f.type||"MultiPoint"===f.type?{type:f.type,coordinates:f.coordinates}:{type:f.type,arcs:f.coordinates};return null!=f.bbox&&(h.bbox=f.bbox),h}function Pn(f,h){function l(y){y&&vh.call(x,y.type)&&x[y.type](y)}function q(y){var B=[];do{var G=u.get(y);B.push(y[0]<y[1]?G:~G)}while(y=y.next);return B}function k(y){return y.map(q)}
var m=function(y){function B(U){null!=U&&vh.call(K,U.type)&&K[U.type](U)}function G(U){var X=U[0];U=U[1];X<J&&(J=X);X>E&&(E=X);U<D&&(D=U);U>I&&(I=U)}function A(U){U.forEach(G)}function F(U){U.forEach(A)}var J=1/0,D=1/0,E=-1/0,I=-1/0,K={GeometryCollection:function(U){U.geometries.forEach(B)},Point:function(U){G(U.coordinates)},MultiPoint:function(U){U.coordinates.forEach(G)},LineString:function(U){A(U.arcs)},MultiLineString:function(U){U.arcs.forEach(A)},Polygon:function(U){U.arcs.forEach(A)},MultiPolygon:function(U){U.arcs.forEach(F)}},
N;for(N in y)B(y[N]);return E>=J&&I>=D?[J,D,E,I]:void 0}(f=Nn(f));h=0<h&&m&&function(y,B,G){function A(ka){return[Math.round((ka[0]-K)*X),Math.round((ka[1]-N)*aa)]}function F(ka,pa){for(var ra,ma,ta,na,Pa=-1,Sa=0,Vb=ka.length,Ta=Array(Vb);++Pa<Vb;)ra=ka[Pa],na=Math.round((ra[0]-K)*X),ra=Math.round((ra[1]-N)*aa),na===ma&&ra===ta||(Ta[Sa++]=[ma=na,ta=ra]);for(Ta.length=Sa;Sa<pa;)Sa=Ta.push([Ta[0][0],Ta[0][1]]);return Ta}function J(ka){return F(ka,2)}function D(ka){return F(ka,4)}function E(ka){return ka.map(D)}
function I(ka){null!=ka&&vh.call(ha,ka.type)&&ha[ka.type](ka)}var K=B[0],N=B[1],U=B[2];B=B[3];var X=U-K?(G-1)/(U-K):1,aa=B-N?(G-1)/(B-N):1,ha={GeometryCollection:function(ka){ka.geometries.forEach(I)},Point:function(ka){ka.coordinates=A(ka.coordinates)},MultiPoint:function(ka){ka.coordinates=ka.coordinates.map(A)},LineString:function(ka){ka.arcs=J(ka.arcs)},MultiLineString:function(ka){ka.arcs=ka.arcs.map(J)},Polygon:function(ka){ka.arcs=E(ka.arcs)},MultiPolygon:function(ka){ka.arcs=ka.arcs.map(E)}},
da;for(da in y)I(y[da]);return{scale:[1/X,1/aa],translate:[K,N]}}(f,m,h);var r=function(y){function B(da){var ka,pa,ra,ma;if(ra=aa.get(ka=I[da[0]])){var ta=0;for(ma=ra.length;ta<ma;++ta){a:{var na=pa=ra[ta];var Pa=na[0];var Sa=da[0];na=na[1];if(Pa-na!=Sa-da[1])Pa=!1;else{for(;Pa<=na;++Pa,++Sa)if(!gf(I[Pa],I[Sa])){Pa=!1;break a}Pa=!0}}if(Pa)return da[0]=pa[0],void(da[1]=pa[1])}}if(Pa=aa.get(pa=I[da[1]]))for(ta=0,ma=Pa.length;ta<ma;++ta){a:{var Vb=Sa=Pa[ta];na=Vb[0];Vb=Vb[1];var Ta=da[1];if(na-Vb!=
da[0]-Ta)na=!1;else{for(;na<=Vb;++na,--Ta)if(!gf(I[na],I[Ta])){na=!1;break a}na=!0}}if(na)return da[1]=Sa[0],void(da[0]=Sa[1])}ra?ra.push(da):aa.set(ka,[da]);Pa?Pa.push(da):aa.set(pa,[da]);ha.push(da)}function G(da){var ka,pa,ra,ma;if(pa=aa.get(I[da[0]])){var ta=0;for(ma=pa.length;ta<ma;++ta){if(A(ra=pa[ta],da))return da[0]=ra[0],void(da[1]=ra[1]);if(F(ra,da))return da[0]=ra[1],void(da[1]=ra[0])}}if(pa=aa.get(ka=I[da[0]+J(da)]))for(ta=0,ma=pa.length;ta<ma;++ta){if(A(ra=pa[ta],da))return da[0]=ra[0],
void(da[1]=ra[1]);if(F(ra,da))return da[0]=ra[1],void(da[1]=ra[0])}pa?pa.push(da):aa.set(ka,[da]);ha.push(da)}function A(da,ka){var pa=da[0],ra=ka[0],ma=da[1]-pa;if(ma!==ka[1]-ra)return!1;da=J(da);ka=J(ka);for(var ta=0;ta<ma;++ta)if(!gf(I[pa+(ta+da)%ma],I[ra+(ta+ka)%ma]))return!1;return!0}function F(da,ka){var pa=da[0],ra=ka[1],ma=da[1]-pa;if(ma!==ra-ka[0])return!1;da=J(da);ka=ma-J(ka);for(var ta=0;ta<ma;++ta)if(!gf(I[pa+(ta+da)%ma],I[ra-(ta+ka)%ma]))return!1;return!0}function J(da){var ka=da[0];
da=da[1];for(var pa=ka,ra=pa,ma=I[pa];++pa<da;){var ta=I[pa];(ta[0]<ma[0]||ta[0]===ma[0]&&ta[1]<ma[1])&&(ra=pa,ma=ta)}return ra-ka}var D,E,I=y.coordinates,K=y.lines,N=y.rings,U=K.length+N.length;delete y.lines;delete y.rings;var X=0;for(E=K.length;X<E;++X)for(D=K[X];D=D.next;)++U;X=0;for(E=N.length;X<E;++X)for(D=N[X];D=D.next;)++U;var aa=vi(2.8*U,wi,gf),ha=y.arcs=[];X=0;for(E=K.length;X<E;++X){D=K[X];do B(D);while(D=D.next)}X=0;for(E=N.length;X<E;++X)if((D=N[X]).next){do B(D);while(D=D.next)}else G(D);
return y}(function(y){var B,G,A=Mn(y),F=y.coordinates,J=y.lines,D=y.rings;var E=0;for(G=J.length;E<G;++E)for(var I=J[E],K=I[0],N=I[1];++K<N;)A.has(F[K])&&(B={0:K,1:I[1]},I[1]=K,I=I.next=B);E=0;for(G=D.length;E<G;++E){J=D[E];N=I=J[0];K=J[1];for(var U=A.has(F[I]);++N<K;)if(A.has(F[N]))if(U)B={0:N,1:J[1]},J[1]=N,J=J.next=B;else{B=F;U=I;var X=K;N=K-N;xi(B,U,X);xi(B,U,U+N);xi(B,U+N,X);F[K]=F[I];U=!0;N=I}}return y}(function(y){function B(U){U&&vh.call(K,U.type)&&K[U.type](U)}function G(U){for(var X=0,aa=
U.length;X<aa;++X)I[++J]=U[X];U={0:J-aa+1,1:J};return D.push(U),U}function A(U){for(var X=0,aa=U.length;X<aa;++X)I[++J]=U[X];U={0:J-aa+1,1:J};return E.push(U),U}function F(U){return U.map(A)}var J=-1,D=[],E=[],I=[],K={GeometryCollection:function(U){U.geometries.forEach(B)},LineString:function(U){U.arcs=G(U.arcs)},MultiLineString:function(U){U.arcs=U.arcs.map(G)},Polygon:function(U){U.arcs=U.arcs.map(A)},MultiPolygon:function(U){U.arcs=U.arcs.map(F)}},N;for(N in y)B(y[N]);return{type:"Topology",coordinates:I,
lines:D,rings:E,objects:y}}(f))),p=r.coordinates,u=vi(1.4*r.arcs.length,Qn,Rn);f=r.objects;r.bbox=m;r.arcs=r.arcs.map(function(y,B){return u.set(y,B),p.slice(y[0],y[1]+1)});delete r.coordinates;p=null;var x={GeometryCollection:function(y){y.geometries.forEach(l)},LineString:function(y){y.arcs=q(y.arcs)},MultiLineString:function(y){y.arcs=y.arcs.map(q)},Polygon:function(y){y.arcs=y.arcs.map(q)},MultiPolygon:function(y){y.arcs=y.arcs.map(k)}},v;for(v in f)l(f[v]);return h&&(r.transform=h,r.arcs=function(y){for(var B=
-1,G=y.length;++B<G;){var A=y[B],F=0,J=1,D=A.length;var E=A[0];for(var I=E[0],K=E[1];++F<D;){var N=(E=A[F])[0];E=E[1];N===I&&E===K||(A[J++]=[N-I,E-K],I=N,K=E)}1===J&&(A[J++]=[0,0]);A.length=J}return y}(r.arcs)),r}function Qn(f){var h,l=f[0];f=f[1];return f<l&&(h=l,l=f,f=h),l+31*f}function Rn(f,h){var l,q=f[0];f=f[1];var k=h[0];h=h[1];return f<q&&(l=q,q=f,f=l),h<k&&(l=k,k=h,h=l),q===k&&f===h}function Sn(f,h){if(void 0===h&&(h={}),"FeatureCollection"!==sc(f))throw Error("geojson must be a FeatureCollection");
if(!f.features.length)throw Error("geojson is empty");!1!==h.mutate&&void 0!==h.mutate||(f=Ec(f));var l=[];eb(f,function(q){l.push(q.geometry)});f=Pn({geoms:L(l).geometry});return function(q){return jk(q,Ln.apply(this,arguments))}(f,f.objects.geoms.geometries)}function Tn(f,h){if(void 0===h&&(h={}),!oa(h=h||{}))throw Error("options is invalid");var l=h.mutate;if("FeatureCollection"!==sc(f))throw Error("geojson must be a FeatureCollection");if(!f.features.length)throw Error("geojson is empty");!1!==
l&&void 0!==l||(f=Ec(f));l=function(q){var k={};eb(q,function(m){k[m.geometry.type]=!0});q=Object.keys(k);return 1===q.length?q[0]:null}(f);if(!l)throw Error("geojson must be homogenous");switch(l){case "LineString":return In(f,h);case "Polygon":return Sn(f,h);default:throw Error(l+" is not supported");}}function hf(f,h){void 0===h&&(h={});h="object"==typeof h?h.mutate:h;if(!f)throw Error("geojson is required");var l=sc(f),q=[];switch(l){case "LineString":q=zi(f);break;case "MultiLineString":case "Polygon":fa(f).forEach(function(m){q.push(zi(m))});
break;case "MultiPolygon":fa(f).forEach(function(m){var r=[];m.forEach(function(p){r.push(zi(p))});q.push(r)});break;case "Point":return f;case "MultiPoint":var k={};fa(f).forEach(function(m){var r=m.join("-");Object.prototype.hasOwnProperty.call(k,r)||(q.push(m),k[r]=!0)});break;default:throw Error(l+" geometry not supported");}return f.coordinates?!0===h?(f.coordinates=q,f):{type:l,coordinates:q}:!0===h?(f.geometry.coordinates=q,f):b({type:l,coordinates:q},f.properties,{bbox:f.bbox,id:f.id})}function zi(f){f=
fa(f);if(2===f.length&&!mk(f[0],f[1]))return f;var h=[],l=f.length-1,q=h.length;h.push(f[0]);for(var k=1;k<l;k++){var m=h[h.length-1];f[k][0]===m[0]&&f[k][1]===m[1]||(h.push(f[k]),2<(q=h.length)&&nk(h[q-3],h[q-1],h[q-2])&&h.splice(h.length-2,1))}if(h.push(f[f.length-1]),q=h.length,mk(f[0],f[f.length-1])&&4>q)throw Error("invalid polygon");return nk(h[q-3],h[q-1],h[q-2])&&h.splice(h.length-2,1),h}function mk(f,h){return f[0]===h[0]&&f[1]===h[1]}function nk(f,h,l){var q=l[0];l=l[1];var k=f[0];f=f[1];
var m=h[0];h=h[1];var r=m-k,p=h-f;return 0===(q-k)*p-(l-f)*r&&(Math.abs(r)>=Math.abs(p)?0<r?k<=q&&q<=m:m<=q&&q<=k:0<p?f<=l&&l<=h:h<=l&&l<=f)}function Ai(f,h,l,q,k){for(var m,r=q,p=h+1;p<l;p++){var u=f[p],x=f[h];var v=f[l];var y=x.x;x=x.y;var B=v.x-y,G=v.y-x;if(0!==B||0!==G){var A=((u.x-y)*B+(u.y-x)*G)/(B*B+G*G);1<A?(y=v.x,x=v.y):0<A&&(y+=B*A,x+=G*A)}v=(B=u.x-y)*B+(G=u.y-x)*G;v>r&&(m=p,r=v)}r>q&&(1<m-h&&Ai(f,h,m,q,k),k.push(f[m]),1<l-m&&Ai(f,m,l,q,k))}function Bi(f,h,l){if(2>=f.length)return f;h=void 0!==
h?h*h:1;if(!l){for(var q,k,m,r=f[0],p=[r],u=1,x=f.length;u<x;u++)q=f[u],m=r,l=(k=q).x-m.x,k=k.y-m.y,l*l+k*k>h&&(p.push(q),r=q);f=(r!==q&&p.push(q),p)}q=f.length-1;l=[f[0]];return Ai(f,0,q,h,l),l.push(f[q]),l}function ok(f,h,l){return Bi(f.map(function(q){return{x:q[0],y:q[1],z:q[2]}}),h,l).map(function(q){return q.z?[q.x,q.y,q.z]:[q.x,q.y]})}function pk(f,h,l){return f.map(function(q){q=q.map(function(m){return{x:m[0],y:m[1]}});if(4>q.length)throw Error("invalid polygon");for(var k=Bi(q,h,l).map(function(m){return[m.x,
m.y]});3>k.length||3===k.length&&k[2][0]===k[0][0]&&k[2][1]===k[0][1];)k=Bi(q,h-=.01*h,l).map(function(m){return[m.x,m.y]});return k[k.length-1][0]===k[0][0]&&k[k.length-1][1]===k[0][1]||k.push(k[0]),k})}function qk(f,h){void 0===h&&(h={});var l=h.resolution||1E4,q=h.sharpness||.85,k=[];f=Lb(f).coordinates.map(function(r){return{x:r[0],y:r[1]}});var m=new Un({duration:l,points:f,sharpness:q});l=function(r){var p=m.pos(r);0==Math.floor(r/100)%2&&k.push([p.x,p.y])};for(q=0;q<m.duration;q+=10)l(q);return l(m.duration),
t(k,h.properties)}function Ci(f,h){void 0===h&&(h={});var l=Number(f[0]),q=Number(f[1]),k=Number(f[2]),m=Number(f[3]);if(6===f.length)throw Error("@turf/bbox-polygon does not support BBox with 6 positions");var r=[l,q];return g([[r,[k,q],[k,m],[l,m],r]],h.properties,{bbox:f,id:h.id})}function rk(f){return Ci(Aa(f))}function sk(f){var h=f[0],l=f[1],q=f[2],k=f[3];if(Ob(f.slice(0,2),[q,l])>=Ob(f.slice(0,2),[h,k]))return l=(l+k)/2,[h,l-(q-h)/2,q,l+(q-h)/2];h=(h+q)/2;return[h-(k-l)/2,l,h+(k-l)/2,k]}function ke(f,
h,l,q){void 0===q&&(q={});var k=ia(f);f=ca(k[0]);k=ca(k[1]);l=ca(l);h=T(h,q.units);var m=Math.asin(Math.sin(k)*Math.cos(h)+Math.cos(k)*Math.sin(h)*Math.cos(l));return d([Z(f+Math.atan2(Math.sin(l)*Math.sin(h)*Math.cos(k),Math.cos(h)-Math.sin(k)*Math.sin(m))),Z(m)],q.properties)}function Di(f,h,l){void 0===l&&(l={});for(var q=l.steps||64,k=l.properties?l.properties:!Array.isArray(f)&&"Feature"===f.type&&f.properties?f.properties:{},m=[],r=0;r<q;r++)m.push(ke(f,h,-360*r/q,l).geometry.coordinates);return m.push(m[0]),
g([m],k)}function Be(f,h,l){if(void 0===l&&(l={}),!0===l.final)return(Be(h,f)+180)%360;l=ia(f);var q=ia(h);h=ca(l[0]);f=ca(q[0]);l=ca(l[1]);q=ca(q[1]);return Z(Math.atan2(Math.sin(f-h)*Math.cos(q),Math.cos(l)*Math.sin(q)-Math.sin(l)*Math.cos(q)*Math.cos(f-h)))}function wh(f,h){void 0===h&&(h={});f=Aa(f);return d([(f[0]+f[2])/2,(f[1]+f[3])/2],h.properties,h)}function Ne(f,h){void 0===h&&(h={});var l=0,q=0,k=0;return ya(f,function(m){l+=m[0];q+=m[1];k++},!0),d([l/k,q/k],h.properties)}function xh(f){var h=
[];return"FeatureCollection"===f.type?Ia(f,function(l){ya(l,function(q){h.push(d(q,l.properties))})}):ya(f,function(l){h.push(d(l,f.properties))}),z(h)}function yh(f,h,l){l=l||2;var q,k,m,r=h&&h.length,p=r?h[0]*l:f.length,u=tk(f,0,p,l,!0),x=[];if(!u)return x;if(r){r=l;var v,y=[];var B=0;for(v=h.length;B<v;B++){(q=tk(f,h[B]*r,B<v-1?h[B+1]*r:f.length,r,!1))===q.next&&(q.steiner=!0);var G=y,A=G.push,F=q,J=q;do F.x<J.x&&(J=F),F=F.next;while(F!==q);A.call(G,J)}y.sort(Vn);for(B=0;B<y.length;B++)Wn(y[B],
u),u=qg(u,u.next)}if(f.length>80*l){var D=h=f[0];var E=q=f[1];for(r=l;r<p;r+=l)(k=f[r])<D&&(D=k),(m=f[r+1])<E&&(E=m),k>h&&(h=k),m>q&&(q=m);var I=0!==(I=Math.max(h-D,q-E))?1/I:0}return rg(u,x,l,D,E,I),x}function tk(f,h,l,q,k){if(k===0<Ei(f,h,l,q))for(k=h;k<l;k+=q)var m=uk(k,f[k],f[k+1],m);else for(k=l-q;k>=h;k-=q)m=uk(k,f[k],f[k+1],m);return m&&jf(m,m.next)&&(sg(m),m=m.next),m}function qg(f,h){if(!f)return f;h||=f;var l=f;do if(f=!1,l.steiner||!jf(l,l.next)&&0!==Nc(l.prev,l,l.next))l=l.next;else{if(sg(l),
(l=h=l.prev)===l.next)break;f=!0}while(f||l!==h);return h}function rg(f,h,l,q,k,m,r){if(f){if(!r&&m){var p=f,u=p;do null===u.z&&(u.z=Fi(u.x,u.y,q,k,m)),u.prevZ=u.prev,u=u.nextZ=u.next;while(u!==p);u.prevZ.nextZ=null;u.prevZ=null;p=u;var x,v,y,B,G=1;do{u=p;var A=p=null;for(y=0;u;){y++;var F=u;for(x=B=0;x<G&&(B++,F=F.nextZ);x++);for(x=G;0<B||0<x&&F;)0!==B&&(0===x||!F||u.z<=F.z)?(v=u,u=u.nextZ,B--):(v=F,F=F.nextZ,x--),A?A.nextZ=v:p=v,v.prevZ=A,A=v;u=F}A.nextZ=null;G*=2}while(1<y)}for(u=f;f.prev!==f.next;){v=
f.prev;p=f.next;if(m)a:{F=f;G=q;x=k;var J=m;A=F.prev;y=F.next;if(0<=Nc(A,F,y))F=!1;else{var D=A.x>F.x?A.x>y.x?A.x:y.x:F.x>y.x?F.x:y.x,E=A.y>F.y?A.y>y.y?A.y:y.y:F.y>y.y?F.y:y.y;B=Fi(A.x<F.x?A.x<y.x?A.x:y.x:F.x<y.x?F.x:y.x,A.y<F.y?A.y<y.y?A.y:y.y:F.y<y.y?F.y:y.y,G,x,J);G=Fi(D,E,G,x,J);x=F.prevZ;for(J=F.nextZ;x&&x.z>=B&&J&&J.z<=G;){if(x!==F.prev&&x!==F.next&&Df(A.x,A.y,F.x,F.y,y.x,y.y,x.x,x.y)&&0<=Nc(x.prev,x,x.next)||(x=x.prevZ,J!==F.prev&&J!==F.next&&Df(A.x,A.y,F.x,F.y,y.x,y.y,J.x,J.y)&&0<=Nc(J.prev,
J,J.next))){F=!1;break a}J=J.nextZ}for(;x&&x.z>=B;){if(x!==F.prev&&x!==F.next&&Df(A.x,A.y,F.x,F.y,y.x,y.y,x.x,x.y)&&0<=Nc(x.prev,x,x.next)){F=!1;break a}x=x.prevZ}for(;J&&J.z<=G;){if(J!==F.prev&&J!==F.next&&Df(A.x,A.y,F.x,F.y,y.x,y.y,J.x,J.y)&&0<=Nc(J.prev,J,J.next)){F=!1;break a}J=J.nextZ}F=!0}}else a:if(F=f,A=F.prev,y=F.next,0<=Nc(A,F,y))F=!1;else{for(B=F.next.next;B!==F.prev;){if(Df(A.x,A.y,F.x,F.y,y.x,y.y,B.x,B.y)&&0<=Nc(B.prev,B,B.next)){F=!1;break a}B=B.next}F=!0}if(F)h.push(v.i/l),h.push(f.i/
l),h.push(p.i/l),sg(f),u=f=p.next;else if((f=p)===u){if(r)if(1===r){r=rg;v=h;p=l;u=f;do F=u.prev,A=u.next.next,!jf(F,A)&&vk(F,u,u.next,A)&&tg(F,A)&&tg(A,F)&&(v.push(F.i/p),v.push(u.i/p),v.push(A.i/p),sg(u),sg(u.next),u=f=A),u=u.next;while(u!==f);r(u,h,l,q,k,m,2)}else{if(2===r)a:{r=f;do{for(v=r.next.next;v!==r.prev;){if(r.i!==v.i&&Xn(r,v)){f=wk(r,v);r=qg(r,r.next);f=qg(f,f.next);rg(r,h,l,q,k,m);rg(f,h,l,q,k,m);break a}v=v.next}r=r.next}while(r!==f)}}else rg(qg(f),h,l,q,k,m,1);break}}}}function Vn(f,
h){return f.x-h.x}function Wn(f,h){if(h=function(l,q){var k=q,m=l.x,r=l.y,p=-1/0;do{if(r<=k.y&&r>=k.next.y&&k.next.y!==k.y){var u=k.x+(r-k.y)*(k.next.x-k.x)/(k.next.y-k.y);if(u<=m&&u>p){if(p=u,u===m){if(r===k.y)return k;if(r===k.next.y)return k.next}var x=k.x<k.next.x?k:k.next}}k=k.next}while(k!==q);if(!x)return null;if(m===p)return x.prev;var v;q=x;u=x.x;var y=x.y,B=1/0;for(k=x.next;k!==q;)m>=k.x&&k.x>=u&&m!==k.x&&Df(r<y?m:p,r,u,y,r<y?p:m,r,k.x,k.y)&&((v=Math.abs(r-k.y)/(m-k.x))<B||v===B&&k.x>x.x)&&
tg(k,l)&&(x=k,B=v),k=k.next;return x}(f,h))f=wk(h,f),qg(f,f.next)}function Fi(f,h,l,q,k){return 1431655765&((f=858993459&((f=252645135&((f=16711935&((f=32767*(f-l)*k)|f<<8))|f<<4))|f<<2))|f<<1)|(1431655765&((h=858993459&((h=252645135&((h=16711935&((h=32767*(h-q)*k)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function Df(f,h,l,q,k,m,r,p){return 0<=(k-r)*(h-p)-(f-r)*(m-p)&&0<=(f-r)*(q-p)-(l-r)*(h-p)&&0<=(l-r)*(m-p)-(k-r)*(q-p)}function Xn(f,h){return f.next.i!==h.i&&f.prev.i!==h.i&&!function(l,q){var k=l;do{if(k.i!==
l.i&&k.next.i!==l.i&&k.i!==q.i&&k.next.i!==q.i&&vk(k,k.next,l,q))return!0;k=k.next}while(k!==l);return!1}(f,h)&&tg(f,h)&&tg(h,f)&&function(l,q){var k=l,m=!1,r=(l.x+q.x)/2;q=(l.y+q.y)/2;do k.y>q!=k.next.y>q&&k.next.y!==k.y&&r<(k.next.x-k.x)*(q-k.y)/(k.next.y-k.y)+k.x&&(m=!m),k=k.next;while(k!==l);return m}(f,h)}function Nc(f,h,l){return(h.y-f.y)*(l.x-h.x)-(h.x-f.x)*(l.y-h.y)}function jf(f,h){return f.x===h.x&&f.y===h.y}function vk(f,h,l,q){return!!(jf(f,h)&&jf(l,q)||jf(f,q)&&jf(l,h))||0<Nc(f,h,l)!=
0<Nc(f,h,q)&&0<Nc(l,q,f)!=0<Nc(l,q,h)}function tg(f,h){return 0>Nc(f.prev,f,f.next)?0<=Nc(f,h,f.next)&&0<=Nc(f,f.prev,h):0>Nc(f,h,f.prev)||0>Nc(f,f.next,h)}function wk(f,h){var l=new Gi(f.i,f.x,f.y),q=new Gi(h.i,h.x,h.y),k=f.next,m=h.prev;return f.next=h,h.prev=f,l.next=k,k.prev=l,q.next=l,l.prev=q,m.next=q,q.prev=m,q}function uk(f,h,l,q){f=new Gi(f,h,l);return q?(f.next=q.next,f.prev=q,q.next.prev=f,q.next=f):(f.prev=f,f.next=f),f}function sg(f){f.next.prev=f.prev;f.prev.next=f.next;f.prevZ&&(f.prevZ.nextZ=
f.nextZ);f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function Gi(f,h,l){this.i=f;this.x=h;this.y=l;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function Ei(f,h,l,q){for(var k=0,m=l-q;h<l;h+=q)k+=(f[m]-f[h])*(f[h+1]+f[m+1]),m=h;return k}function xk(f){var h=function(r){for(var p=r[0][0].length,u={vertices:[],holes:[],dimensions:p},x=0,v=0;v<r.length;v++){for(var y=0;y<r[v].length;y++)for(var B=0;B<p;B++)u.vertices.push(r[v][y][B]);0<v&&(x+=r[v-1].length,u.holes.push(x))}return u}(f),
l=yk(h.vertices,h.holes,2);f=[];var q=[];l.forEach(function(r,p){r=l[p];q.push([h.vertices[2*r],h.vertices[2*r+1]])});for(var k=0;k<q.length;k+=3){var m=q.slice(k,k+3);m.push(q[k]);f.push(g([m]))}return f}function zh(f,h){if(!f)throw Error("targetPoint is required");if(!h)throw Error("points is required");var l,q=1/0,k=0;return Ia(h,function(m,r){m=Ob(f,m);m<q&&(k=r,q=m)}),(l=Ec(h.features[k])).properties.featureIndex=k,l.properties.distanceToPoint=q,l}function kf(f){if(!f)throw Error("geojson is required");
var h=[];return eb(f,function(l){!function(q,k){var m=[],r=q.geometry;if(null!==r){switch(r.type){case "Polygon":m=fa(r);break;case "LineString":m=[fa(r)]}m.forEach(function(p){(function(u,x){var v=[];return u.reduce(function(y,B){var G=t([y,B],x),A=y[0];y=y[1];var F=B[0],J=B[1];return G.bbox=[A<F?A:F,y<J?y:J,A>F?A:F,y>J?y:J],v.push(G),B}),v})(p,q.properties).forEach(function(u){u.id=k.length;k.push(u)})})}}(l,h)}),z(h)}function ug(f,h,l){if(null!==f){var q,k,m,r,p=0;var u=f.type;for(var x="FeatureCollection"===
u,v="Feature"===u,y=x?f.features.length:1,B=0;B<y;B++){var G=(m=!!(k=x?f.features[B].geometry:v?f.geometry:f)&&"GeometryCollection"===k.type)?k.geometries.length:1;for(var A=0;A<G;A++){var F=0,J=0;if(null!==(q=m?k.geometries[A]:k)){var D=q.coordinates;var E=q.type;switch(r=!l||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case "Point":if(!1===h(D,p,B,F,J))return!1;p++;break;case "LineString":case "MultiPoint":for(u=0;u<D.length;u++){if(!1===h(D[u],p,B,F,J))return!1;p++;"MultiPoint"===E&&
F++}"LineString"===E&&F++;break;case "Polygon":case "MultiLineString":for(u=0;u<D.length;u++){for(q=0;q<D[u].length-r;q++){if(!1===h(D[u][q],p,B,F,J))return!1;p++}"MultiLineString"===E&&F++;"Polygon"===E&&J++}"Polygon"===E&&F++;break;case "MultiPolygon":for(u=0;u<D.length;u++){for(q=J=0;q<D[u].length;q++){for(E=0;E<D[u][q].length-r;E++){if(!1===h(D[u][q][E],p,B,F,J))return!1;p++}J++}F++}break;case "GeometryCollection":for(u=0;u<q.geometries.length;u++)if(!1===ug(q.geometries[u],h,l))return!1;break;
default:throw Error("Unknown Geometry Type");}}}}}}function zk(f,h){var l;switch(f.type){case "FeatureCollection":for(l=0;l<f.features.length&&!1!==h(f.features[l].properties,l);l++);break;case "Feature":h(f.properties,0)}}function Ak(f,h){if("Feature"===f.type)h(f,0);else if("FeatureCollection"===f.type)for(var l=0;l<f.features.length&&!1!==h(f.features[l],l);l++);}function Hi(f,h){var l,q,k,m,r,p=0,u="FeatureCollection"===f.type,x="Feature"===f.type,v=u?f.features.length:1;for(l=0;l<v;l++){var y=
u?f.features[l].geometry:x?f.geometry:f;var B=u?f.features[l].properties:x?f.properties:{};var G=u?f.features[l].bbox:x?f.bbox:void 0;var A=u?f.features[l].id:x?f.id:void 0;var F=(r=!!y&&"GeometryCollection"===y.type)?y.geometries.length:1;for(k=0;k<F;k++)if(null!==(m=r?y.geometries[k]:y))switch(m.type){case "Point":case "LineString":case "MultiPoint":case "Polygon":case "MultiLineString":case "MultiPolygon":if(!1===h(m,p,B,G,A))return!1;break;case "GeometryCollection":for(q=0;q<m.geometries.length;q++)if(!1===
h(m.geometries[q],p,B,G,A))return!1;break;default:throw Error("Unknown Geometry Type");}else if(!1===h(null,p,B,G,A))return!1;p++}}function Ah(f,h){Hi(f,function(l,q,k,m,r){var p=null===l?null:l.type;switch(p){case null:case "Point":case "LineString":case "Polygon":return!1!==h(Fc.feature(l,k,{bbox:m,id:r}),q,0)&&void 0}switch(p){case "MultiPoint":var u="Point";break;case "MultiLineString":u="LineString";break;case "MultiPolygon":u="Polygon"}for(m=0;m<l.coordinates.length;m++)if(!1===h(Fc.feature({type:u,
coordinates:l.coordinates[m]},k),q,m))return!1})}function Bk(f,h){Ah(f,function(l,q,k){var m=0;if(l.geometry){var r=l.geometry.type;if("Point"!==r&&"MultiPoint"!==r){var p,u=0,x=0,v=0;return!1!==ug(l,function(y,B,G,A,F){if(void 0===p||q>u||A>x||F>v)return p=y,u=q,x=A,v=F,void(m=0);B=Fc.lineString([p,y],l.properties);if(!1===h(B,q,k,F,m))return!1;m++;p=y})&&void 0}}})}function Ck(f,h){if(!f)throw Error("geojson is required");Ah(f,function(l,q,k){if(null!==l.geometry){var m=l.geometry.coordinates;switch(l.geometry.type){case "LineString":if(!1===
h(l,q,k,0,0))return!1;break;case "Polygon":for(var r=0;r<m.length;r++)if(!1===h(Fc.lineString(m[r],l.properties),q,k,r))return!1}}})}function Ii(f){var h=[1/0,1/0,-1/0,-1/0];return Ji.coordEach(f,function(l){h[0]>l[0]&&(h[0]=l[0]);h[1]>l[1]&&(h[1]=l[1]);h[2]<l[0]&&(h[2]=l[0]);h[3]<l[1]&&(h[3]=l[1])}),h}function Dk(f){f=Wc(f);return f.insert=function(h){if("Feature"!==h.type)throw Error("invalid feature");return h.bbox=h.bbox?h.bbox:vg(h),Wc.prototype.insert.call(this,h)},f.load=function(h){var l=
[];return Array.isArray(h)?h.forEach(function(q){if("Feature"!==q.type)throw Error("invalid features");q.bbox=q.bbox?q.bbox:vg(q);l.push(q)}):Yn(h,function(q){if("Feature"!==q.type)throw Error("invalid features");q.bbox=q.bbox?q.bbox:vg(q);l.push(q)}),Wc.prototype.load.call(this,l)},f.remove=function(h,l){if("Feature"!==h.type)throw Error("invalid feature");return h.bbox=h.bbox?h.bbox:vg(h),Wc.prototype.remove.call(this,h,l)},f.clear=function(){return Wc.prototype.clear.call(this)},f.search=function(h){h=
Wc.prototype.search.call(this,this.toBBox(h));return Ek(h)},f.collides=function(h){return Wc.prototype.collides.call(this,this.toBBox(h))},f.all=function(){var h=Wc.prototype.all.call(this);return Ek(h)},f.toJSON=function(){return Wc.prototype.toJSON.call(this)},f.fromJSON=function(h){return Wc.prototype.fromJSON.call(this,h)},f.toBBox=function(h){if(h.bbox)h=h.bbox;else if(!Array.isArray(h)||4!==h.length)if(Array.isArray(h)&&6===h.length)h=[h[0],h[1],h[3],h[4]];else{if("Feature"!==h.type&&"FeatureCollection"!==
h.type)throw Error("invalid geojson");h=vg(h)}return{minX:h[0],minY:h[1],maxX:h[2],maxY:h[3]}},f}function le(f,h){var l={},q=[];if("LineString"===f.type&&(f=b(f)),"LineString"===h.type&&(h=b(h)),"Feature"===f.type&&"Feature"===h.type&&null!==f.geometry&&null!==h.geometry&&"LineString"===f.geometry.type&&"LineString"===h.geometry.type&&2===f.geometry.coordinates.length&&2===h.geometry.coordinates.length)return f=Fk(f,h),f&&q.push(f),z(q);var k=wg();return k.load(kf(h)),Ia(kf(f),function(m){Ia(k.search(m),
function(r){if(r=Fk(m,r)){var p=fa(r).join(",");l[p]||(l[p]=!0,q.push(r))}})}),z(q)}function Fk(f,h){var l=fa(f),q=fa(h);if(2!==l.length)throw Error("<intersects> line1 must only contain 2 coordinates");if(2!==q.length)throw Error("<intersects> line2 must only contain 2 coordinates");h=l[0][0];f=l[0][1];var k=l[1][0];l=l[1][1];var m=q[0][0],r=q[0][1],p=q[1][0],u=q[1][1];q=(u-r)*(k-h)-(p-m)*(l-f);if(0===q)return null;p=((p-m)*(f-r)-(u-r)*(h-m))/q;m=((k-h)*(f-r)-(l-f)*(h-m))/q;return 0<=p&&1>=p&&0<=
m&&1>=m?d([h+p*(k-h),f+p*(l-f)]):null}function Ce(f,h,l){void 0===l&&(l={});var q=d([1/0,1/0],{dist:1/0}),k=0;return eb(f,function(m){m=fa(m);for(var r=0;r<m.length-1;r++){var p=d(m[r]);p.properties.dist=Ob(h,p,l);var u=d(m[r+1]);u.properties.dist=Ob(h,u,l);var x=Ob(p,u,l),v=Math.max(p.properties.dist,u.properties.dist),y=Be(p,u),B=ke(h,v,y+90,l);v=ke(h,v,y-90,l);B=le(t([B.geometry.coordinates,v.geometry.coordinates]),t([p.geometry.coordinates,u.geometry.coordinates]));v=null;0<B.features.length&&
((v=B.features[0]).properties.dist=Ob(h,v,l),v.properties.location=k+Ob(p,v,l));p.properties.dist<q.properties.dist&&((q=p).properties.index=r,q.properties.location=k);u.properties.dist<q.properties.dist&&((q=u).properties.index=r+1,q.properties.location=k+x);v&&v.properties.dist<q.properties.dist&&((q=v).properties.index=r);k+=x}}),q}function Bh(f,h,l){void 0===l&&(l={});var q=ia(f),k=ia(h);k[0]+=180<k[0]-q[0]?-360:180<q[0]-k[0]?360:0;f=q[1]*Math.PI/180;var m=k[1]*Math.PI/180;h=m-f;q=Math.abs(k[0]-
q[0])*Math.PI/180;q>Math.PI&&(q-=2*Math.PI);m=Math.log(Math.tan(m/2+Math.PI/4)/Math.tan(f/2+Math.PI/4));f=1E-11<Math.abs(m)?h/m:Math.cos(f);return ba(6371008.8*Math.sqrt(h*h+f*f*q*q),"meters",l.units)}function Gk(f,h,l){if(void 0===l&&(l={}),l.method||(l.method="geodesic"),l.units||(l.units="kilometers"),!f)throw Error("pt is required");if(Array.isArray(f)?f=d(f):"Point"===f.type?f=b(f):Sb(f,"Point","point"),!h)throw Error("line is required");Array.isArray(h)?h=t(h):"LineString"===h.type?h=b(h):Sb(h,
"LineString","line");var q=1/0,k=f.geometry.coordinates;return Q(h,function(m){var r=m.geometry.coordinates[0];var p=m.geometry.coordinates[1];m=l;var u=[p[0]-r[0],p[1]-r[1]];var x=[k[0]-r[0],k[1]-r[1]];x=x[0]*u[0]+x[1]*u[1];if(0>=x)r=Ki(k,r,{method:m.method,units:"degrees"});else{var v=u[0]*u[0]+u[1]*u[1];v<=x?r=Ki(k,p,{method:m.method,units:"degrees"}):(p=x/v,r=Ki(k,[r[0]+p*u[0],r[1]+p*u[1]],{method:m.method,units:"degrees"}))}r<q&&(q=r)}),ba(q,"degrees",l.units)}function Ki(f,h,l){return"planar"===
l.method?Bh(f,h,l):Ob(f,h,l)}function Hk(f){f="FeatureCollection"!==f.type?"Feature"!==f.type?z([b(f)]):z([f]):f;for(var h=wh(f),l=!1,q=0;!l&&q<f.features.length;){var k,m=f.features[q].geometry,r=!1;if("Point"===m.type)h.geometry.coordinates[0]===m.coordinates[0]&&h.geometry.coordinates[1]===m.coordinates[1]&&(l=!0);else if("MultiPoint"===m.type)for(r=!1,k=0;!r&&k<m.coordinates.length;)h.geometry.coordinates[0]===m.coordinates[k][0]&&h.geometry.coordinates[1]===m.coordinates[k][1]&&(l=!0,r=!0),k++;
else if("LineString"===m.type)for(k=0;!r&&k<m.coordinates.length-1;)Ik(h.geometry.coordinates[0],h.geometry.coordinates[1],m.coordinates[k][0],m.coordinates[k][1],m.coordinates[k+1][0],m.coordinates[k+1][1])&&(r=!0,l=!0),k++;else if("MultiLineString"===m.type)for(var p=0;p<m.coordinates.length;){r=!1;k=0;for(var u=m.coordinates[p];!r&&k<u.length-1;)Ik(h.geometry.coordinates[0],h.geometry.coordinates[1],u[k][0],u[k][1],u[k+1][0],u[k+1][1])&&(r=!0,l=!0),k++;p++}else"Polygon"!==m.type&&"MultiPolygon"!==
m.type||Wb(h,m)&&(l=!0);q++}if(l)return h;l=z([]);for(q=0;q<f.features.length;q++)l.features=l.features.concat(xh(f.features[q]).features);return d(zh(h,l).geometry.coordinates)}function Ik(f,h,l,q,k,m){return Math.sqrt((k-l)*(k-l)+(m-q)*(m-q))===Math.sqrt((f-l)*(f-l)+(h-q)*(h-q))+Math.sqrt((k-f)*(k-f)+(m-h)*(m-h))}function Li(f){return dd(f,function(h,l){a:{var q,k=0;switch(l.type){case "Polygon":l=Jk(l.coordinates);break a;case "MultiPolygon":for(q=0;q<l.coordinates.length;q++)k+=Jk(l.coordinates[q]);
l=k;break a}l=0}return h+l},0)}function Jk(f){var h=0;if(f&&0<f.length){h+=Math.abs(Kk(f[0]));for(var l=1;l<f.length;l++)h-=Math.abs(Kk(f[l]))}return h}function Kk(f){var h,l,q,k,m=0,r=f.length;if(2<r){for(k=0;k<r;k++){k===r-2?(h=r-2,l=r-1,q=0):k===r-1?(h=r-1,l=0,q=1):(h=k,l=k+1,q=k+2);var p=f[h];var u=f[l];m+=(f[q][0]*Math.PI/180-p[0]*Math.PI/180)*Math.sin(u[1]*Math.PI/180)}m=40680631590769*m/2}return m}function Mi(f,h){return void 0===h&&(h={}),R(f,function(l,q){q=q.geometry.coordinates;return l+
Ob(q[0],q[1],h)},0)}function Lk(f,h,l,q){if(!oa(q=q||{}))throw Error("options is invalid");var k=[];if("Feature"===f.type)f=f.geometry.coordinates;else{if("LineString"!==f.type)throw Error("input must be a LineString Feature or Geometry");f=f.coordinates}for(var m,r,p,u=f.length,x=0,v=0;v<f.length&&!(h>=x&&v===f.length-1);v++){if(x>h&&0===k.length){if(!(m=h-x))return k.push(f[v]),t(k);r=Be(f[v],f[v-1])-180;p=ke(f[v],m,r,q);k.push(p.geometry.coordinates)}if(x>=l)return(m=l-x)?(r=Be(f[v],f[v-1])-180,
p=ke(f[v],m,r,q),k.push(p.geometry.coordinates),t(k)):(k.push(f[v]),t(k));if(x>=h&&k.push(f[v]),v===f.length-1)return t(k);x+=Ob(f[v],f[v+1],q)}if(x<h&&f.length===u)throw Error("Start position is beyond line");h=f[f.length-1];return t([h,h])}function kd(f,h,l){void 0===l&&(l={});f=ia(f);h=fa(h);for(var q=0;q<h.length-1;q++){var k=!1;l.ignoreEndVertices&&(0===q&&(k="start"),q===h.length-2&&(k="end"),0===q&&q+1===h.length-1&&(k="both"));a:{var m=h[q],r=h[q+1],p=void 0===l.epsilon?null:l.epsilon,u=f[0],
x=f[1],v=m[0];m=m[1];var y=r[0];r=r[1];var B=y-v,G=r-m,A=(f[0]-v)*G-(f[1]-m)*B;if(null!==p){if(Math.abs(A)>p){k=!1;break a}}else if(0!==A){k=!1;break a}k=k?"start"===k?Math.abs(B)>=Math.abs(G)?0<B?v<u&&u<=y:y<=u&&u<v:0<G?m<x&&x<=r:r<=x&&x<m:"end"===k?Math.abs(B)>=Math.abs(G)?0<B?v<=u&&u<y:y<u&&u<=v:0<G?m<=x&&x<r:r<x&&x<=m:"both"===k&&(Math.abs(B)>=Math.abs(G)?0<B?v<u&&u<y:y<u&&u<v:0<G?m<x&&x<r:r<x&&x<m):Math.abs(B)>=Math.abs(G)?0<B?v<=u&&u<=y:y<=u&&u<=v:0<G?m<=x&&x<=r:r<=x&&x<=m}if(k)return!0}return!1}
function Mk(f,h){f=Lb(f);h=Lb(h);var l=f.type,q=h.type;switch(l){case "Point":switch(q){case "MultiPoint":return function(k,m){var r,p=!1;for(r=0;r<m.coordinates.length;r++)if(Nk(m.coordinates[r],k.coordinates)){p=!0;break}return p}(f,h);case "LineString":return kd(f,h,{ignoreEndVertices:!0});case "Polygon":case "MultiPolygon":return Wb(f,h,{ignoreBoundary:!0});default:throw Error("feature2 "+q+" geometry not supported");}case "MultiPoint":switch(q){case "MultiPoint":return function(k,m){for(var r=
0;r<k.coordinates.length;r++){for(var p=!1,u=0;u<m.coordinates.length;u++)Nk(k.coordinates[r],m.coordinates[u])&&(p=!0);if(!p)return!1}return!0}(f,h);case "LineString":return function(k,m){for(var r=!1,p=0;p<k.coordinates.length;p++){if(!kd(k.coordinates[p],m))return!1;r||=kd(k.coordinates[p],m,{ignoreEndVertices:!0})}return r}(f,h);case "Polygon":case "MultiPolygon":return function(k,m){for(var r=!0,p=!1,u=0;u<k.coordinates.length;u++){if(!(p=Wb(k.coordinates[1],m))){r=!1;break}p=Wb(k.coordinates[1],
m,{ignoreBoundary:!0})}return r&&p}(f,h);default:throw Error("feature2 "+q+" geometry not supported");}case "LineString":switch(q){case "LineString":return function(k,m){for(var r=0;r<k.coordinates.length;r++)if(!kd(k.coordinates[r],m))return!1;return!0}(f,h);case "Polygon":case "MultiPolygon":return function(k,m){var r=Aa(m),p=Aa(k);if(!Ok(r,p))return!1;p=!1;for(r=0;r<k.coordinates.length-1;r++){if(!Wb(k.coordinates[r],m))return!1;if(p||=Wb(k.coordinates[r],m,{ignoreBoundary:!0}),!p){p=k.coordinates[r];
var u=k.coordinates[r+1];p=Wb([(p[0]+u[0])/2,(p[1]+u[1])/2],m,{ignoreBoundary:!0})}}return p}(f,h);default:throw Error("feature2 "+q+" geometry not supported");}case "Polygon":switch(q){case "Polygon":case "MultiPolygon":return function(k,m){var r=Aa(k);if(!Ok(Aa(m),r))return!1;for(r=0;r<k.coordinates[0].length;r++)if(!Wb(k.coordinates[0][r],m))return!1;return!0}(f,h);default:throw Error("feature2 "+q+" geometry not supported");}default:throw Error("feature1 "+l+" geometry not supported");}}function Ok(f,
h){return!(f[0]>h[0])&&!(f[2]<h[2])&&!(f[1]>h[1])&&!(f[3]<h[3])}function Nk(f,h){return f[0]===h[0]&&f[1]===h[1]}function Pk(f,h,l){void 0===l&&(l={});l.mask&&!l.units&&(l.units="kilometers");var q=[],k=f[0],m=f[1],r=f[2];f=f[3];var p=h/Ob([k,m],[r,m],l)*(r-k);h=h/Ob([k,m],[k,f],l)*(f-m);var u=r-k,x=f-m;x=(x-Math.floor(x/h)*h)/2;for(k+=(u-Math.floor(u/p)*p)/2;k<=r;){for(u=m+x;u<=f;){var v=d([k,u],l.properties);l.mask?Mk(v,l.mask)&&q.push(v):q.push(v);u+=h}k+=p}return z(q)}function Qk(f,h){void 0===
h&&(h={});var l=h.precision,q=h.coordinates;h=h.mutate;if(l=null==l||isNaN(l)?6:l,q=null==q||isNaN(q)?3:q,!f)throw Error("<geojson> is required");if("number"!=typeof l)throw Error("<precision> must be a number");if("number"!=typeof q)throw Error("<coordinates> must be a number");!1!==h&&void 0!==h||(f=JSON.parse(JSON.stringify(f)));var k=Math.pow(10,l);return ya(f,function(m){m.length>q&&m.splice(q,m.length);for(var r=0;r<m.length;r++)m[r]=Math.round(m[r]*k)/k;!0}),f}function Ni(f){if(!f)throw Error("geojson is required");
var h=[];return eb(f,function(l){h.push(l)}),z(h)}function Zn(f,h,l){function q(B,G,A,F){var J,D,E=m[B][G],I=m[B][G+1],K=m[A][F],N=m[A][F+1];if(xg(E,K)||xg(E,N)||xg(I,K)||xg(N,K))var U=null;else{U=E[0];var X=E[1],aa=I[0],ha=I[1],da=K[0],ka=K[1],pa=N[0],ra=N[1],ma=(U-aa)*(ka-ra)-(X-ha)*(da-pa);U=0===ma?null:[((U*ha-X*aa)*(da-pa)-(U-aa)*(da*ra-ka*pa))/ma,((U*ha-X*aa)*(ka-ra)-(X-ha)*(da*ra-ka*pa))/ma]}null===U||(J=I[0]!==E[0]?(U[0]-E[0])/(I[0]-E[0]):(U[1]-E[1])/(I[1]-E[1]),D=N[0]!==K[0]?(U[0]-K[0])/
(N[0]-K[0]):(U[1]-K[1])/(N[1]-K[1]),1<=J||0>=J||1<=D||0>=D)||(X=U,(aa=!p[X])&&(p[X]=!0),h?r.push(h(U,B,G,E,I,J,A,F,K,N,D,aa)):r.push(U))}function k(B,G){var A,F,J,D,E=m[B][G],I=m[B][G+1];return E[0]<I[0]?(A=E[0],F=I[0]):(A=I[0],F=E[0]),E[1]<I[1]?(J=E[1],D=I[1]):(J=I[1],D=E[1]),{minX:A,minY:J,maxX:F,maxY:D,ring:B,edge:G}}if("Polygon"!==f.geometry.type)throw Error("The input feature must be a Polygon");void 0===l&&(l=1);var m=f.geometry.coordinates,r=[],p={};if(l){f=[];for(var u=0;u<m.length;u++)for(var x=
0;x<m[u].length-1;x++)f.push(k(u,x));u=Wc();u.load(f)}for(var v=0;v<m.length;v++)for(var y=0;y<m[v].length-1;y++)if(l)u.search(k(v,y)).forEach(function(B){q(v,y,B.ring,B.edge)});else for(f=0;f<m.length;f++)for(x=0;x<m[f].length-1;x++)q(v,y,f,x);return h||(r={type:"Feature",geometry:{type:"MultiPoint",coordinates:r}}),r}function xg(f,h){if(!f||!h||f.length!==h.length)return!1;for(var l=0,q=f.length;l<q;l++)if(f[l]instanceof Array&&h[l]instanceof Array){if(!xg(f[l],h[l]))return!1}else if(f[l]!==h[l])return!1;
return!0}function $n(f){function h(){for(var D=[],E=0;E<y.features.length;E++)-1==y.features[E].properties.parent&&D.push(E);if(1<D.length)for(E=0;E<D.length;E++){for(var I=-1,K=0;K<y.features.length;K++)D[E]!=K&&Wb(y.features[D[E]].geometry.coordinates[0][0],y.features[K],{ignoreBoundary:!0})&&Infinity>Li(y.features[K])&&(I=K);y.features[D[E]].properties.parent=I}}function l(){for(var D=0;D<y.features.length;D++)if(-1==y.features[D].properties.parent){var E=y.features[D].properties.winding;y.features[D].properties.netWinding=
E;q(D,E)}}function q(D,E){for(var I=0;I<y.features.length;I++)if(y.features[I].properties.parent==D){var K=E+y.features[I].properties.winding;y.features[I].properties.netWinding=K;q(I,K)}}if("Feature"!=f.type)throw Error("The input must a geojson object of type Feature");if(void 0===f.geometry||null==f.geometry)throw Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=f.geometry.type)throw Error("The input must be a geojson Polygon");for(var k=f.geometry.coordinates.length,
m=[],r=0;r<k;r++){var p=f.geometry.coordinates[r];yg(p[0],p[p.length-1])||p.push(p[0]);m.push.apply(m,p.slice(0,p.length-1))}if(!function(D){for(var E={},I=1,K=0,N=D.length;K<N;++K){if(Object.prototype.hasOwnProperty.call(E,D[K])){I=0;break}E[D[K]]=1}return I}(m))throw Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");m=m.length;var u=Zn(f,function(D,E,I,K,N,U,X,aa,ha,da,ka,pa){return[D,E,I,K,N,U,X,aa,ha,da,ka,pa]}),x=u.length;if(0==x){var v=
[];for(r=0;r<k;r++)v.push(g([f.geometry.coordinates[r]],{parent:-1,winding:ao(f.geometry.coordinates[r])}));var y=z(v);return h(),l(),y}var B=[],G=[];for(r=0;r<k;r++)for(B.push([]),p=0;p<f.geometry.coordinates[r].length-1;p++)B[r].push([new Rk(f.geometry.coordinates[r][Ef(p+1,f.geometry.coordinates[r].length-1)],1,[r,p],[r,Ef(p+1,f.geometry.coordinates[r].length-1)],void 0)]),G.push(new Sk(f.geometry.coordinates[r][p],[r,Ef(p-1,f.geometry.coordinates[r].length-1)],[r,p],void 0,void 0,!1,!0));for(r=
0;r<x;r++)B[u[r][1]][u[r][2]].push(new Rk(u[r][0],u[r][5],[u[r][1],u[r][2]],[u[r][6],u[r][7]],void 0)),u[r][11]&&G.push(new Sk(u[r][0],[u[r][1],u[r][2]],[u[r][6],u[r][7]],void 0,void 0,!0,!0));u=G.length;for(r=0;r<B.length;r++)for(p=0;p<B[r].length;p++)B[r][p].sort(function(D,E){return D.param<E.param?-1:1});p=[];for(r=0;r<u;r++)p.push({minX:G[r].coord[0],minY:G[r].coord[1],maxX:G[r].coord[0],maxY:G[r].coord[1],index:r});x=Wc();x.load(p);for(r=0;r<B.length;r++)for(p=0;p<B[r].length;p++)for(u=0;u<
B[r][p].length;u++)A=u==B[r][p].length-1?B[r][Ef(p+1,f.geometry.coordinates[r].length-1)][0].coord:B[r][p][u+1].coord,A=x.search({minX:A[0],minY:A[1],maxX:A[0],maxY:A[1]})[0],B[r][p][u].nxtIsectAlongEdgeIn=A.index;for(r=0;r<B.length;r++)for(p=0;p<B[r].length;p++)for(u=0;u<B[r][p].length;u++){var A=B[r][p][u].coord,F=(A=x.search({minX:A[0],minY:A[1],maxX:A[0],maxY:A[1]})[0]).index;F<m?G[F].nxtIsectAlongRingAndEdge2=B[r][p][u].nxtIsectAlongEdgeIn:yg(G[F].ringAndEdge1,B[r][p][u].ringAndEdgeIn)?G[F].nxtIsectAlongRingAndEdge1=
B[r][p][u].nxtIsectAlongEdgeIn:G[F].nxtIsectAlongRingAndEdge2=B[r][p][u].nxtIsectAlongEdgeIn}m=[];for(p=r=0;p<k;p++){B=r;for(u=0;u<f.geometry.coordinates[p].length-1;u++)G[r].coord[0]<G[B].coord[0]&&(B=r),r++;x=G[B].nxtIsectAlongRingAndEdge2;for(u=0;u<G.length;u++)if(G[u].nxtIsectAlongRingAndEdge1==B||G[u].nxtIsectAlongRingAndEdge2==B){v=u;break}u=Ch([G[v].coord,G[B].coord,G[x].coord],!0)?1:-1;m.push({isect:B,parent:-1,winding:u})}m.sort(function(D,E){return G[D.isect].coord>G[E.isect].coord?-1:1});
for(v=[];0<m.length;){r=m.pop();f=r.isect;k=r.parent;p=r.winding;B=v.length;u=[G[f].coord];x=f;G[f].ringAndEdge1Walkable?(A=G[f].ringAndEdge1,F=G[f].nxtIsectAlongRingAndEdge1):(A=G[f].ringAndEdge2,F=G[f].nxtIsectAlongRingAndEdge2);for(;!yg(G[f].coord,G[F].coord);){u.push(G[F].coord);var J=void 0;for(r=0;r<m.length;r++)if(m[r].isect==F){J=r;break}if(null!=J&&m.splice(J,1),yg(A,G[F].ringAndEdge1)){if(A=G[F].ringAndEdge2,G[F].ringAndEdge2Walkable=!1,G[F].ringAndEdge1Walkable)r={isect:F},Ch([G[x].coord,
G[F].coord,G[G[F].nxtIsectAlongRingAndEdge2].coord],1==p)?(r.parent=k,r.winding=-p):(r.parent=B,r.winding=p),m.push(r);x=F;F=G[F].nxtIsectAlongRingAndEdge2}else{if(A=G[F].ringAndEdge1,G[F].ringAndEdge1Walkable=!1,G[F].ringAndEdge2Walkable)r={isect:F},Ch([G[x].coord,G[F].coord,G[G[F].nxtIsectAlongRingAndEdge1].coord],1==p)?(r.parent=k,r.winding=-p):(r.parent=B,r.winding=p),m.push(r);x=F;F=G[F].nxtIsectAlongRingAndEdge1}}u.push(G[F].coord);v.push(g([u],{index:B,parent:k,winding:p,netWinding:void 0}))}y=
z(v);return h(),l(),y}function Ch(f,h){if(void 0===h&&(h=!0),3!=f.length)throw Error("This function requires an array of three points [x,y]");return 0<=(f[1][0]-f[0][0])*(f[2][1]-f[0][1])-(f[1][1]-f[0][1])*(f[2][0]-f[0][0])==h}function ao(f){for(var h=0,l=0;l<f.length-1;l++)f[l][0]<f[h][0]&&(h=l);return Ch([f[Ef(h-1,f.length-1)],f[h],f[Ef(h+1,f.length-1)]],!0)?1:-1}function yg(f,h){if(!f||!h||f.length!=h.length)return!1;for(var l=0,q=f.length;l<q;l++)if(f[l]instanceof Array&&h[l]instanceof Array){if(!yg(f[l],
h[l]))return!1}else if(f[l]!=h[l])return!1;return!0}function Ef(f,h){return(f%h+h)%h}function Tk(f,h){var l=[],q=wg();return eb(h,function(k){if(l.forEach(function(p,u){p.id=u}),l.length){var m=q.search(k);if(m.features.length){var r=Uk(k,m);l=l.filter(function(p){return p.id!==r.id});q.remove(r);Ia(Oi(r,k),function(p){l.push(p);q.insert(p)})}}else(l=Oi(f,k).features).forEach(function(p){p.bbox||(p.bbox=sk(Aa(p)))}),q.load(z(l))}),z(l)}function Oi(f,h){var l=[],q=fa(f)[0],k=fa(f)[f.geometry.coordinates.length-
1];if(Pi(q,ia(h))||Pi(k,ia(h)))return z([f]);var m=wg();k=kf(f);m.load(k);m=m.search(h);if(!m.features.length)return z([f]);var r=Uk(h,m);f=Ma(k,function(p,u,x){u=fa(u)[1];var v=ia(h);return x===r.id?(p.push(v),l.push(t(p)),Pi(v,u)?[v]:[v,u]):(p.push(u),p)},[q]);return 1<f.length&&l.push(t(f)),z(l)}function Uk(f,h){if(!h.features.length)throw Error("lines must contain features");if(1===h.features.length)return h.features[0];var l,q=1/0;return Ia(h,function(k){var m=Ce(k,f).properties.dist;m<q&&(l=
k,q=m)}),l}function Pi(f,h){return f[0]===h[0]&&f[1]===h[1]}function Vk(f,h,l,q,k){void 0===k&&(k={});var m=k.steps||64;l=Wk(l);var r=Wk(q);q=Array.isArray(f)||"Feature"!==f.type?{}:f.properties;if(l===r)return t(Di(f,h,k).geometry.coordinates[0],q);r=l<r?r:r+360;for(var p=l,u=[],x=0;p<r;)u.push(ke(f,h,p,k).geometry.coordinates),p=l+360*++x/m;return p>r&&u.push(ke(f,h,r,k).geometry.coordinates),t(u,q)}function Wk(f){f%=360;return 0>f&&(f+=360),f}function zg(f,h){void 0===h&&(h={});var l=Lb(f);switch(h.properties||
"Feature"!==f.type||(h.properties=f.properties),l.type){case "Polygon":return Qi(l,h);case "MultiPolygon":return function(q,k){void 0===k&&(k={});var m=Lb(q).coordinates,r=k.properties?k.properties:"Feature"===q.type?q.properties:{},p=[];return m.forEach(function(u){p.push(Xk(u,r))}),z(p)}(l,h);default:throw Error("invalid poly");}}function Qi(f,h){return void 0===h&&(h={}),Xk(Lb(f).coordinates,h.properties?h.properties:"Feature"===f.type?f.properties:{})}function Xk(f,h){return 1<f.length?C(f,h):
t(f[0],h)}function Yk(f,h){var l,q,k;void 0===h&&(h={});var m=h.properties,r=null===(l=h.autoComplete)||void 0===l||l,p=null===(q=h.orderCoords)||void 0===q||q;switch(null!==(k=h.mutate)&&void 0!==k&&k||(f=Ec(f)),f.type){case "FeatureCollection":var u=[];return f.features.forEach(function(x){u.push(fa(Zk(x,{},r,p)))}),M(u,m);default:return Zk(f,m,r,p)}}function Zk(f,h,l,q){h=h||("Feature"===f.type?f.properties:{});var k=Lb(f);f=k.coordinates;k=k.type;if(!f.length)throw Error("line must contain coordinates");
switch(k){case "LineString":return l&&(f=$k(f)),g([f],h);case "MultiLineString":var m=[],r=0;return f.forEach(function(p){if(l&&(p=$k(p)),q){var u=Aa(t(p));u=Math.abs(u[0]-u[2])*Math.abs(u[1]-u[3]);u>r?(m.unshift(p),r=u):m.push(p)}else m.push(p)}),g(m,h);default:throw Error("geometry type "+k+" is not supported");}}function $k(f){var h=f[0],l=h[1],q=f[f.length-1],k=q[1];return h[0]===q[0]&&l===k||f.push(h),f}function Ri(f,h,l,q){return 8&l?[f[0]+(h[0]-f[0])*(q[3]-f[1])/(h[1]-f[1]),q[3]]:4&l?[f[0]+
(h[0]-f[0])*(q[1]-f[1])/(h[1]-f[1]),q[1]]:2&l?[q[2],f[1]+(h[1]-f[1])*(q[2]-f[0])/(h[0]-f[0])]:1&l?[q[0],f[1]+(h[1]-f[1])*(q[0]-f[0])/(h[0]-f[0])]:null}function Ff(f,h){var l=0;return f[0]<h[0]?l|=1:f[0]>h[2]&&(l|=2),f[1]<h[1]?l|=4:f[1]>h[3]&&(l|=8),l}function al(f,h){for(var l=[],q=0;q<f.length;q++){var k,m=void 0,r,p,u,x=void 0,v=f[q],y=h;for(u=1;8>=u;u*=2){x=[];var B=!(Ff(p=v[v.length-1],y)&u);for(r=0;r<v.length;r++)(k=!(Ff(m=v[r],y)&u))!==B&&x.push(Ri(p,m,u,y)),k&&x.push(m),p=m,B=k;if(!(v=x).length)break}k=
x;0<k.length&&(k[0][0]===k[k.length-1][0]&&k[0][1]===k[k.length-1][1]||k.push(k[0]),4<=k.length&&l.push(k))}return l}function bl(f,h,l){if(void 0===l&&(l={}),!oa(l=l||{}))throw Error("options is invalid");var q,k=l.tolerance||0,m=[],r=wg();f=kf(f);return r.load(f),Q(h,function(p){var u=!1;p&&(Ia(r.search(p),function(x){if(!1===u){var v=fa(p).sort(),y=fa(x).sort();Gf(v,y)||(0===k?kd(v[0],x)&&kd(v[1],x):Ce(x,v[0]).properties.dist<=k&&Ce(x,v[1]).properties.dist<=k)?(u=!0,q=q?cl(q,p):p):(0===k?kd(y[0],
p)&&kd(y[1],p):Ce(p,y[0]).properties.dist<=k&&Ce(p,y[1]).properties.dist<=k)&&(q=q?cl(q,x):x)}}),!1===u&&q&&(m.push(q),q=void 0))}),q&&m.push(q),z(m)}function cl(f,h){h=fa(h);var l=fa(f),q=l[0];l=l[l.length-1];var k=f.geometry.coordinates;return Gf(h[0],q)?k.unshift(h[1]):Gf(h[0],l)?k.push(h[1]):Gf(h[1],q)?k.unshift(h[0]):Gf(h[1],l)&&k.push(h[0]),f}function dl(f){f%=360;return 0>f&&(f+=360),f}function lf(f,h,l){var q;return void 0===l&&(l={}),180<(q=l.final?el(ia(h),ia(f)):el(ia(f),ia(h)))?-(360-
q):q}function el(f,h){var l=ca(f[1]),q=ca(h[1]);f=ca(h[0]-f[0]);f>Math.PI&&(f-=2*Math.PI);f<-Math.PI&&(f+=2*Math.PI);return(Z(Math.atan2(f,Math.log(Math.tan(q/2+Math.PI/4)/Math.tan(l/2+Math.PI/4))))+360)%360}function Hf(f,h,l,q){void 0===q&&(q={});var k=0>h;h=ba(Math.abs(h),q.units,"meters");k&&(h=-Math.abs(h));f=ia(f);k=void 0;k=void 0===k?6371008.8:Number(k);h/=k;k=f[0]*Math.PI/180;var m=ca(f[1]);l=ca(l);var r=h*Math.cos(l),p=m+r;Math.abs(p)>Math.PI/2&&(p=0<p?Math.PI-p:-Math.PI-p);var u=Math.log(Math.tan(p/
2+Math.PI/4)/Math.tan(m/2+Math.PI/4));l=[(180*(k+h*Math.sin(l)/(1E-11<Math.abs(u)?r/u:Math.cos(m)))/Math.PI+540)%360-180,180*p/Math.PI];return l[0]+=180<l[0]-f[0]?-360:180<f[0]-l[0]?360:0,d(l,q.properties)}function fl(f,h,l,q,k,m){for(var r=0;r<f.length;r++){var p=f[r];q=f[r+1];r===f.length-1&&(q=f[0]);q=Ag(p,q,h);0>=l&&0<q?0>Ag(h,p,k)||(k=p):0<l&&0>=q&&(0<Ag(h,p,m)||(m=p));l=q}return[k,m]}function Ag(f,h,l){return(h[0]-f[0])*(l[1]-f[1])-(l[0]-f[0])*(h[1]-f[1])}function Dh(f){for(var h,l=fa(f),q=
0,k=1;k<l.length;)f=h||l[0],q+=((h=l[k])[0]-f[0])*(h[1]+f[1]),k++;return 0<q}function Eh(f,h){switch("Feature"===f.type?f.geometry.type:f.type){case "GeometryCollection":return Qb(f,function(l){Eh(l,h)}),f;case "LineString":return gl(fa(f),h),f;case "Polygon":return hl(fa(f),h),f;case "MultiLineString":return fa(f).forEach(function(l){gl(l,h)}),f;case "MultiPolygon":return fa(f).forEach(function(l){hl(l,h)}),f;case "Point":case "MultiPoint":return f}}function gl(f,h){Dh(f)===h&&f.reverse()}function hl(f,
h){Dh(f[0])!==h&&f[0].reverse();for(var l=1;l<f.length;l++)Dh(f[l])===h&&f[l].reverse()}function bo(f,h){if(!oa(h=h||{}))throw Error("options is invalid");var l=h.zProperty||"elevation",q=h.flip;h=h.flags;Na(f,"Point","input must contain Points");f=function(x,v){var y={};return Ia(x,function(B){var G=fa(B)[1];y[G]||(y[G]=[]);y[G].push(B)}),Object.keys(y).map(function(B){return y[B].sort(function(G,A){return fa(G)[0]-fa(A)[0]})}).sort(function(B,G){return v?fa(B[0])[1]-fa(G[0])[1]:fa(G[0])[1]-fa(B[0])[1]})}(f,
q);q=[];for(var k=0;k<f.length;k++){for(var m=f[k],r=[],p=0;p<m.length;p++){var u=m[p];u.properties[l]?r.push(u.properties[l]):r.push(0);!0===h&&(u.properties.matrixPosition=[k,p])}q.push(r)}return q}function co(f,h,l,q){q=q||{};for(var k=Object.keys(il),m=0;m<k.length;m++){var r=k[m],p=q[r];p=null!=p?p:il[r];mf[r]=p}mf.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+h+":"+(h+l)+"]");var u;f=function(x,v,y){var B=x.length-1,G=x[0].length-1,A={rows:B,cols:G,cells:[]};y=
v+Math.abs(y);for(var F=0;F<B;++F){A.cells[F]=[];for(var J=0;J<G;++J){var D=0,E=x[F+1][J],I=x[F+1][J+1],K=x[F][J+1],N=x[F][J];if(!(isNaN(E)||isNaN(I)||isNaN(K)||isNaN(N))){D|=E<v?0:E>y?128:64;D|=I<v?0:I>y?32:16;D|=K<v?0:K>y?8:4;var U=+(D|=N<v?0:N>y?2:1),X=0;if(17===D||18===D||33===D||34===D||38===D||68===D||72===D||98===D||102===D||132===D||136===D||137===D||152===D||153===D)X=(E+I+K+N)/4,X=X>y?2:X<v?0:1,34===D?1===X?D=35:0===X&&(D=136):136===D?1===X?(D=35,X=4):0===X&&(D=34):17===D?1===X?(D=155,X=
4):0===X&&(D=153):68===D?1===X?(D=103,X=4):0===X&&(D=102):153===D?1===X&&(D=155):102===D?1===X&&(D=103):152===D?2>X&&(D=156,X=1):137===D?2>X&&(D=139,X=1):98===D?2>X&&(D=99,X=1):38===D?2>X&&(D=39,X=1):18===D?0<X?(D=156,X=4):D=152:33===D?0<X?(D=139,X=4):D=137:72===D?0<X?(D=99,X=4):D=98:132===D&&(0<X?(D=39,X=4):D=38);if(0!=D&&170!=D){var aa,ha,da,ka,pa,ra,ma;var ta=aa=ha=da=ka=pa=ra=ma=.5;var na=[];1===D?(ha=1-Y(v,K,N),ma=1-Y(v,E,N),na.push(La[D])):169===D?(ha=Y(y,N,K),ma=Y(y,N,E),na.push(La[D])):4===
D?(pa=1-Y(v,I,K),da=Y(v,N,K),na.push(Ga[D])):166===D?(pa=Y(y,K,I),da=1-Y(y,K,N),na.push(Ga[D])):16===D?(ka=Y(v,K,I),aa=Y(v,E,I),na.push(Ha[D])):154===D?(ka=1-Y(y,I,K),aa=1-Y(y,I,E),na.push(Ha[D])):64===D?(ra=Y(v,N,E),ta=1-Y(v,I,E),na.push(Va[D])):106===D?(ra=1-Y(y,E,N),ta=Y(y,E,I),na.push(Va[D])):168===D?(da=Y(y,N,K),ha=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),na.push(Oa[D]),na.push(La[D])):2===D?(da=1-Y(v,K,N),ha=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),na.push(Oa[D]),na.push(La[D])):162===D?(ka=Y(y,K,I),
pa=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),na.push(Oa[D]),na.push(La[D])):8===D?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),na.push(Ha[D]),na.push(Ga[D])):138===D?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ta=1-Y(y,I,E),aa=1-Y(v,I,E),na.push(Ha[D]),na.push(Ga[D])):32===D?(ka=Y(y,K,I),pa=Y(v,K,I),ta=Y(v,E,I),aa=Y(y,E,I),na.push(Ha[D]),na.push(Ga[D])):42===D?(ma=1-Y(y,E,N),ra=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I),na.push(Wa[D]),na.push(Va[D])):128===D&&(ma=Y(v,N,E),ra=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E),na.push(Wa[D]),
na.push(Va[D]));5===D?(pa=1-Y(v,I,K),ma=1-Y(v,E,N),na.push(Ga[D])):165===D?(pa=Y(y,K,I),ma=Y(y,N,E),na.push(Ga[D])):20===D?(da=Y(v,N,K),aa=Y(v,E,I),na.push(Oa[D])):150===D?(da=1-Y(y,K,N),aa=1-Y(y,I,E),na.push(Oa[D])):80===D?(ka=Y(v,K,I),ra=Y(v,N,E),na.push(Ha[D])):90===D?(ka=1-Y(y,I,K),ra=1-Y(y,E,N),na.push(Ha[D])):65===D?(ha=1-Y(v,K,N),ta=1-Y(v,I,E),na.push(La[D])):105===D?(ha=Y(y,N,K),ta=Y(y,E,I),na.push(La[D])):160===D?(ka=Y(y,K,I),pa=Y(v,K,I),ma=Y(v,N,E),ra=Y(y,N,E),na.push(Ha[D]),na.push(Ga[D])):
10===D?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ma=1-Y(y,E,N),ra=1-Y(v,E,N),na.push(Ha[D]),na.push(Ga[D])):130===D?(da=1-Y(v,K,N),ha=1-Y(y,K,N),ta=1-Y(y,I,E),aa=1-Y(v,I,E),na.push(Oa[D]),na.push(La[D])):40===D?(da=Y(y,N,K),ha=Y(v,N,K),ta=Y(v,E,I),aa=Y(y,E,I),na.push(Oa[D]),na.push(La[D])):101===D?(pa=Y(y,K,I),ta=Y(y,E,I),na.push(Ga[D])):69===D?(pa=1-Y(v,I,K),ta=1-Y(v,I,E),na.push(Ga[D])):149===D?(ma=Y(y,N,E),aa=1-Y(y,I,E),na.push(Wa[D])):21===D?(ma=1-Y(v,E,N),aa=Y(v,E,I),na.push(Wa[D])):86===D?(da=1-Y(y,K,N),
ra=1-Y(y,E,N),na.push(Oa[D])):84===D?(da=Y(v,N,K),ra=Y(v,N,E),na.push(Oa[D])):89===D?(ka=1-Y(y,I,K),ha=Y(y,N,K),na.push(La[D])):81===D?(ka=Y(v,K,I),ha=1-Y(v,K,N),na.push(La[D])):96===D?(ka=Y(y,K,I),pa=Y(v,K,I),ra=Y(v,N,E),ta=Y(y,E,I),na.push(Ha[D]),na.push(Ga[D])):74===D?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ra=1-Y(y,E,N),ta=1-Y(v,I,E),na.push(Ha[D]),na.push(Ga[D])):24===D?(ka=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),aa=Y(v,E,I),na.push(Ha[D]),na.push(La[D])):146===D?(ka=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),aa=
1-Y(y,I,E),na.push(Ha[D]),na.push(La[D])):6===D?(pa=1-Y(v,I,K),da=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),na.push(Ga[D]),na.push(Oa[D])):164===D?(pa=Y(y,K,I),da=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),na.push(Ga[D]),na.push(Oa[D])):129===D?(ha=1-Y(v,K,N),ma=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E),na.push(La[D]),na.push(Wa[D])):41===D?(ha=Y(y,N,K),ma=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I),na.push(La[D]),na.push(Wa[D])):66===D?(da=1-Y(v,K,N),ha=1-Y(y,K,N),ra=1-Y(y,E,N),ta=1-Y(v,I,E),na.push(Oa[D]),na.push(La[D])):
104===D?(da=Y(y,N,K),ha=Y(v,N,K),ra=Y(v,N,E),ta=Y(y,E,I),na.push(La[D]),na.push(hb[D])):144===D?(ka=Y(v,K,I),ma=Y(v,N,E),ra=Y(y,N,E),aa=1-Y(y,I,E),na.push(Ha[D]),na.push(Va[D])):26===D?(ka=1-Y(y,I,K),ma=1-Y(y,E,N),ra=1-Y(v,E,N),aa=Y(v,E,I),na.push(Ha[D]),na.push(Va[D])):36===D?(pa=Y(y,K,I),da=Y(v,N,K),ta=Y(v,E,I),aa=Y(y,E,I),na.push(Ga[D]),na.push(Oa[D])):134===D?(pa=1-Y(v,I,K),da=1-Y(y,K,N),ta=1-Y(y,I,E),aa=1-Y(v,I,E),na.push(Ga[D]),na.push(Oa[D])):9===D?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ha=Y(y,N,K),
ma=1-Y(v,E,N),na.push(Ha[D]),na.push(Ga[D])):161===D?(ka=Y(y,K,I),pa=Y(v,K,I),ha=1-Y(v,K,N),ma=Y(y,N,E),na.push(Ha[D]),na.push(Ga[D])):37===D?(pa=Y(y,K,I),ma=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I),na.push(Ga[D]),na.push(Wa[D])):133===D?(pa=1-Y(v,I,K),ma=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E),na.push(Ga[D]),na.push(Wa[D])):148===D?(da=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),aa=1-Y(y,I,E),na.push(Oa[D]),na.push(Va[D])):22===D?(da=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),aa=Y(v,E,I),na.push(Oa[D]),na.push(Va[D])):
82===D?(ka=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ra=1-Y(y,E,N),na.push(Ha[D]),na.push(La[D])):88===D?(ka=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ra=Y(v,N,E),na.push(Ha[D]),na.push(La[D])):73===D?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ha=Y(y,N,K),ta=1-Y(v,I,E),na.push(Ha[D]),na.push(Ga[D])):97===D?(ka=Y(y,K,I),pa=Y(v,K,I),ha=1-Y(v,K,N),ta=Y(y,E,I),na.push(Ha[D]),na.push(Ga[D])):145===D?(ka=Y(v,K,I),ha=1-Y(v,K,N),ma=Y(y,N,E),aa=1-Y(y,I,E),na.push(Ha[D]),na.push(Wa[D])):25===D?(ka=1-Y(y,I,K),ha=Y(y,N,K),ma=1-Y(v,E,
N),aa=Y(v,E,I),na.push(Ha[D]),na.push(Wa[D])):70===D?(pa=1-Y(v,I,K),da=1-Y(y,K,N),ra=1-Y(y,E,N),ta=1-Y(v,I,E),na.push(Ga[D]),na.push(Oa[D])):100===D?(pa=Y(y,K,I),da=Y(v,N,K),ra=Y(v,N,E),ta=Y(y,E,I),na.push(Ga[D]),na.push(Oa[D])):34===D?(0===X?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E)):(ka=Y(y,K,I),pa=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)),na.push(Ha[D]),na.push(Ga[D]),na.push(Wa[D]),na.push(Va[D])):
35===D?(4===X?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E)):(ka=Y(y,K,I),pa=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)),na.push(Ha[D]),na.push(Ga[D]),na.push(La[D]),na.push(Va[D])):136===D?(0===X?(ka=Y(y,K,I),pa=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)):(ka=1-Y(v,I,K),pa=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),ta=1-Y(y,I,E),aa=
1-Y(v,I,E)),na.push(Ha[D]),na.push(Ga[D]),na.push(Wa[D]),na.push(Va[D])):153===D?(0===X?(ka=Y(v,K,I),ha=1-Y(v,K,N),ma=1-Y(v,E,N),aa=Y(v,E,I)):(ka=1-Y(y,I,K),ha=Y(y,N,K),ma=Y(y,N,E),aa=1-Y(y,I,E)),na.push(Ha[D]),na.push(La[D])):102===D?(0===X?(pa=1-Y(v,I,K),da=Y(v,N,K),ra=Y(v,N,E),ta=1-Y(v,I,E)):(pa=Y(y,K,I),da=1-Y(y,K,N),ra=1-Y(y,E,N),ta=Y(y,E,I)),na.push(Ga[D]),na.push(Va[D])):155===D?(4===X?(ka=Y(v,K,I),ha=1-Y(v,K,N),ma=1-Y(v,E,N),aa=Y(v,E,I)):(ka=1-Y(y,I,K),ha=Y(y,N,K),ma=Y(y,N,E),aa=1-Y(y,I,E)),
na.push(Ha[D]),na.push(Wa[D])):103===D?(4===X?(pa=1-Y(v,I,K),da=Y(v,N,K),ra=Y(v,N,E),ta=1-Y(v,I,E)):(pa=Y(y,K,I),da=1-Y(y,K,N),ra=1-Y(y,E,N),ta=Y(y,E,I)),na.push(Ga[D]),na.push(Oa[D])):152===D?(0===X?(ka=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),aa=Y(v,E,I)):(ka=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),aa=1-Y(y,I,E)),na.push(Ha[D]),na.push(Oa[D]),na.push(La[D])):156===D?(4===X?(ka=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),aa=Y(v,E,I)):
(ka=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),aa=1-Y(y,I,E)),na.push(Ha[D]),na.push(La[D]),na.push(Va[D])):137===D?(0===X?(ka=Y(y,K,I),pa=Y(v,K,I),ha=1-Y(v,K,N),ma=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)):(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ha=Y(y,N,K),ma=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E)),na.push(Ha[D]),na.push(Ga[D]),na.push(La[D])):139===D?(4===X?(ka=Y(y,K,I),pa=Y(v,K,I),ha=1-Y(v,K,N),ma=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)):(ka=1-Y(v,I,K),pa=1-Y(y,I,K),ha=Y(y,N,K),ma=Y(y,N,E),ta=1-Y(y,I,
E),aa=1-Y(v,I,E)),na.push(Ha[D]),na.push(Ga[D]),na.push(Wa[D])):98===D?(0===X?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ra=Y(v,N,E),ta=1-Y(v,I,E)):(ka=Y(y,K,I),pa=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ra=1-Y(y,E,N),ta=Y(y,E,I)),na.push(Ha[D]),na.push(Ga[D]),na.push(Va[D])):99===D?(4===X?(ka=1-Y(v,I,K),pa=1-Y(y,I,K),da=Y(y,N,K),ha=Y(v,N,K),ra=Y(v,N,E),ta=1-Y(v,I,E)):(ka=Y(y,K,I),pa=Y(v,K,I),da=1-Y(v,K,N),ha=1-Y(y,K,N),ra=1-Y(y,E,N),ta=Y(y,E,I)),na.push(Ha[D]),na.push(Ga[D]),na.push(La[D])):
38===D?(0===X?(pa=1-Y(v,I,K),da=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E)):(pa=Y(y,K,I),da=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)),na.push(Ga[D]),na.push(Wa[D]),na.push(Va[D])):39===D?(4===X?(pa=1-Y(v,I,K),da=Y(v,N,K),ma=Y(v,N,E),ra=Y(y,N,E),ta=1-Y(y,I,E),aa=1-Y(v,I,E)):(pa=Y(y,K,I),da=1-Y(y,K,N),ma=1-Y(y,E,N),ra=1-Y(v,E,N),ta=Y(v,E,I),aa=Y(y,E,I)),na.push(Ga[D]),na.push(Oa[D]),na.push(Va[D])):85===D&&(ka=1,pa=0,da=1,ha=0,ma=0,ra=1,ta=0,aa=1);(0>ta||1<ta||
0>aa||1<aa||0>ka||1<ka||0>da||1<da||0>ma||1<ma||0>ra||1<ra)&&console.log("MarchingSquaresJS-isoBands: "+D+" "+U+" "+E+","+I+","+K+","+N+" "+X+" "+ta+" "+aa+" "+ka+" "+pa+" "+da+" "+ha+" "+ma+" "+ra);A.cells[F][J]={cval:D,cval_real:U,flipped:X,topleft:ta,topright:aa,righttop:ka,rightbottom:pa,bottomright:da,bottomleft:ha,leftbottom:ma,lefttop:ra,edges:na}}}}}return A}(f,h,l);return mf.polygons?(mf.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),u=function(x){var v=
[],y=0;return x.cells.forEach(function(B,G){B.forEach(function(A,F){void 0!==A&&(A=Ea[A.cval](A),"object"==typeof A&&Si(A)?"object"==typeof A[0]&&Si(A[0])?"object"==typeof A[0][0]&&Si(A[0][0])?A.forEach(function(J){J.forEach(function(D){D[0]+=F;D[1]+=G});v[y++]=J}):(A.forEach(function(J){J[0]+=F;J[1]+=G}),v[y++]=A):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates"))})}),v}(f)):(mf.verbose&&
console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),u=function(x){for(var v=[],y=x.rows,B=x.cols,G=[],A=0;A<y;A++)for(var F=0;F<B;F++)if(void 0!==x.cells[A][F]&&0<x.cells[A][F].edges.length){var J=eo(x.cells[A][F]),D=null,E=F,I=A;null!==J&&G.push([J.p[0]+E,J.p[1]+I]);do{if(null===(D=fo(x.cells[I][E],J.x,J.y,J.o)))break;if(G.push([D.p[0]+E,D.p[1]+I]),E+=D.x,J=D,0>(I+=D.y)||I>=y||0>E||E>=B||void 0===x.cells[I][E]){J=go(x,E-=D.x,I-=D.y,D.x,D.y,D.o);if(null===J)break;
J.path.forEach(function(K){G.push(K)});E=J.i;I=J.j}}while(void 0!==x.cells[I][E]&&0<x.cells[I][E].edges.length);v.push(G);G=[];0<x.cells[A][F].edges.length&&F--}return v}(f)),"function"==typeof mf.successCallback&&mf.successCallback(u),u}function Y(f,h,l){return(f-h)/(l-h)}function Si(f){return-1<f.constructor.toString().indexOf("Array")}function go(f,h,l,q,k,m){for(var r,p,u=h+q,x=l+k,v=[];;){if(void 0===f.cells[x]||void 0===f.cells[x][u])if(x-=k,u-=q,p=(r=f.cells[x][u]).cval_real,-1===k){if(0===
m)if(1&p)v.push([u,x]),q=-1;else{if(!(4&p)){v.push([u+r.bottomright,x]);q=0;m=k=1;break}v.push([u+1,x]);q=1}else{if(!(1&p)){if(4&p){v.push([u+r.bottomright,x]);q=0;m=k=1;break}v.push([u+r.bottomleft,x]);q=0;k=1;m=0;break}v.push([u,x]);q=-1}m=k=0}else if(1===k){if(0===m&&!(p&Sd)){if(p&Oc){v.push([u+r.topleft,x+1]);q=0;k=-1;m=0;break}v.push([u+r.topright,x+1]);q=0;k=-1;m=1;break}v.push([u+1,x+1]);q=1;k=0;m=1}else if(-1===q){if(0===m){if(!(p&Oc)){if(1&p){v.push([u,x+r.leftbottom]);q=1;m=k=0;break}v.push([u,
x+r.lefttop]);q=1;k=0;m=1;break}}else if(!(p&Oc)){console.log("MarchingSquaresJS-isoBands: wtf");break}v.push([u,x+1]);q=0;k=1;m=0}else{if(1!==q){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===m){if(!(4&p)){v.push([u+1,x+r.rightbottom]);q=-1;m=k=0;break}}else if(!(4&p)){if(p&Sd){v.push([u+1,x+r.righttop]);q=-1;k=0;m=1;break}v.push([u+1,x+r.rightbottom]);q=-1;m=k=0;break}v.push([u+1,x]);q=0;k=-1;m=1}else if(p=(r=f.cells[x][u]).cval_real,-1===q)if(0===m)if(void 0!==f.cells[x-
1]&&void 0!==f.cells[x-1][u])q=0,k=-1,m=1;else{if(!(1&p)){v.push([u+r.bottomright,x]);q=0;m=k=1;break}v.push([u,x])}else{if(!(p&Oc)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+u+","+x);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===q){if(0===m){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==f.cells[x+1]&&void 0!==f.cells[x+1][u])q=0,k=1,m=0;else{if(!(p&Sd)){v.push([u+r.topleft,x+1]);q=0;k=-1;m=0;break}v.push([u+1,x+
1]);q=1;k=0;m=1}}else if(-1===k){if(1!==m){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==f.cells[x][u+1])q=1,k=0;else{if(!(4&p)){v.push([u+1,x+r.righttop]);q=-1;k=0;m=1;break}v.push([u+1,x]);q=0;k=-1}m=1}else{if(1!==k){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==m){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==f.cells[x][u-1])q=-1,k=0;else{if(!(p&Oc)){v.push([u,x+r.leftbottom]);q=1;m=k=0;break}v.push([u,x+1]);q=0;k=1}m=0}if(x+=
k,(u+=q)===h&&x===l)break}return{path:v,i:u,j:x,x:q,y:k,o:m}}function eo(f){if(0<f.edges.length){var h=f.cval_real;switch(f.edges[f.edges.length-1]){case 0:return h&Sd?{p:[1,f.righttop],x:-1,y:0,o:1}:{p:[f.topleft,1],x:0,y:-1,o:0};case 1:return 4&h?{p:[f.topleft,1],x:0,y:-1,o:0}:{p:[1,f.rightbottom],x:-1,y:0,o:0};case 2:return 4&h?{p:[f.bottomright,0],x:0,y:1,o:1}:{p:[f.topleft,1],x:0,y:-1,o:0};case 3:return 1&h?{p:[f.topleft,1],x:0,y:-1,o:0}:{p:[f.bottomleft,0],x:0,y:1,o:0};case 4:return h&Sd?{p:[1,
f.righttop],x:-1,y:0,o:1}:{p:[f.topright,1],x:0,y:-1,o:1};case 5:return 4&h?{p:[f.topright,1],x:0,y:-1,o:1}:{p:[1,f.rightbottom],x:-1,y:0,o:0};case 6:return 4&h?{p:[f.bottomright,0],x:0,y:1,o:1}:{p:[f.topright,1],x:0,y:-1,o:1};case 7:return 1&h?{p:[f.topright,1],x:0,y:-1,o:1}:{p:[f.bottomleft,0],x:0,y:1,o:0};case 8:return 4&h?{p:[f.bottomright,0],x:0,y:1,o:1}:{p:[1,f.righttop],x:-1,y:0,o:1};case 9:return 1&h?{p:[1,f.righttop],x:-1,y:0,o:1}:{p:[f.bottomleft,0],x:0,y:1,o:0};case 10:return 1&h?{p:[0,
f.leftbottom],x:1,y:0,o:0}:{p:[1,f.righttop],x:-1,y:0,o:1};case 11:return h&Oc?{p:[1,f.righttop],x:-1,y:0,o:1}:{p:[0,f.lefttop],x:1,y:0,o:1};case 12:return 4&h?{p:[f.bottomright,0],x:0,y:1,o:1}:{p:[1,f.rightbottom],x:-1,y:0,o:0};case 13:return 1&h?{p:[1,f.rightbottom],x:-1,y:0,o:0}:{p:[f.bottomleft,0],x:0,y:1,o:0};case 14:return 1&h?{p:[0,f.leftbottom],x:1,y:0,o:0}:{p:[1,f.rightbottom],x:-1,y:0,o:0};case 15:return h&Oc?{p:[1,f.rightbottom],x:-1,y:0,o:0}:{p:[0,f.lefttop],x:1,y:0,o:1};case 16:return 4&
h?{p:[f.bottomright,0],x:0,y:1,o:1}:{p:[0,f.leftbottom],x:1,y:0,o:0};case 17:return h&Oc?{p:[f.bottomright,0],x:0,y:1,o:1}:{p:[0,f.lefttop],x:1,y:0,o:1};case 18:return 1&h?{p:[0,f.leftbottom],x:1,y:0,o:0}:{p:[f.bottomleft,0],x:0,y:1,o:0};case 19:return h&Oc?{p:[f.bottomleft,0],x:0,y:1,o:0}:{p:[0,f.lefttop],x:1,y:0,o:1};case 20:return h&Oc?{p:[f.topleft,1],x:0,y:-1,o:0}:{p:[0,f.leftbottom],x:1,y:0,o:0};case 21:return h&Sd?{p:[0,f.leftbottom],x:1,y:0,o:0}:{p:[f.topright,1],x:0,y:-1,o:1};case 22:return h&
Oc?{p:[f.topleft,1],x:0,y:-1,o:0}:{p:[0,f.lefttop],x:1,y:0,o:1};case 23:return h&Sd?{p:[0,f.lefttop],x:1,y:0,o:1}:{p:[f.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(f)}}return null}function fo(f,h,l,q){var k,m=f.cval;switch(h){case -1:switch(q){case 0:var r=Ga[m];var p=ib[m];var u=jb[m];var x=kb[m];break;default:r=Ha[m],p=lb[m],u=mb[m],x=nb[m]}break;case 1:switch(q){case 0:r=Wa[m];p=ob[m];u=pb[m];x=qb[m];break;default:r=Va[m],p=
rb[m],u=sb[m],x=tb[m]}break;default:switch(l){case -1:switch(q){case 0:r=hb[m];p=ub[m];u=vb[m];x=wb[m];break;default:r=Gb[m],p=xb[m],u=yb[m],x=zb[m]}break;case 1:switch(q){case 0:r=La[m];p=Ab[m];u=Bb[m];x=Cb[m];break;default:r=Oa[m],p=Db[m],u=Eb[m],x=Fb[m]}}}if(k=f.edges.indexOf(r),void 0===f.edges[k])return null;delete f.edges[k];for(q=k+1;q<f.edges.length;q++)f.edges[q-1]=f.edges[q];f.edges.pop();switch(m=f.cval_real,r){case 0:m&Sd?(h=f.topleft,l=1):(h=1,l=f.righttop);break;case 1:4&m?(h=1,l=f.rightbottom):
(h=f.topleft,l=1);break;case 2:4&m?(h=f.topleft,l=1):(h=f.bottomright,l=0);break;case 3:1&m?(h=f.bottomleft,l=0):(h=f.topleft,l=1);break;case 4:m&Sd?(h=f.topright,l=1):(h=1,l=f.righttop);break;case 5:4&m?(h=1,l=f.rightbottom):(h=f.topright,l=1);break;case 6:4&m?(h=f.topright,l=1):(h=f.bottomright,l=0);break;case 7:1&m?(h=f.bottomleft,l=0):(h=f.topright,l=1);break;case 8:4&m?(h=1,l=f.righttop):(h=f.bottomright,l=0);break;case 9:1&m?(h=f.bottomleft,l=0):(h=1,l=f.righttop);break;case 10:1&m?(h=1,l=f.righttop):
(h=0,l=f.leftbottom);break;case 11:m&Oc?(h=0,l=f.lefttop):(h=1,l=f.righttop);break;case 12:4&m?(h=1,l=f.rightbottom):(h=f.bottomright,l=0);break;case 13:1&m?(h=f.bottomleft,l=0):(h=1,l=f.rightbottom);break;case 14:1&m?(h=1,l=f.rightbottom):(h=0,l=f.leftbottom);break;case 15:m&Oc?(h=0,l=f.lefttop):(h=1,l=f.rightbottom);break;case 16:4&m?(h=0,l=f.leftbottom):(h=f.bottomright,l=0);break;case 17:m&Oc?(h=0,l=f.lefttop):(h=f.bottomright,l=0);break;case 18:1&m?(h=f.bottomleft,l=0):(h=0,l=f.leftbottom);break;
case 19:m&Oc?(h=0,l=f.lefttop):(h=f.bottomleft,l=0);break;case 20:m&Oc?(h=0,l=f.leftbottom):(h=f.topleft,l=1);break;case 21:m&Sd?(h=f.topright,l=1):(h=0,l=f.leftbottom);break;case 22:m&Oc?(h=0,l=f.lefttop):(h=f.topleft,l=1);break;case 23:m&Sd?(h=f.topright,l=1):(h=0,l=f.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(f),null}return void 0!==h&&void 0!==l&&void 0!==p&&void 0!==u&&void 0!==x||(console.log("MarchingSquaresJS-isoBands: undefined value!"),
console.log(f),console.log(h+" "+l+" "+p+" "+u+" "+x)),{p:[h,l],x:p,y:u,o:x}}function ho(f){var h=[],l=[];f.forEach(function(k){var m=Li(g([k]));l.push(m);h.push({ring:k,area:m})});l.sort(function(k,m){return m-k});var q=[];return l.forEach(function(k){for(var m=0;m<h.length;m++)if(h[m].area===k){q.push(h[m].ring);h.splice(m,1);break}}),q}function io(f){f=f.map(function(r){return{lrCoordinates:r,grouped:!1}});for(var h=[];!jo(f);)for(var l=0;l<f.length;l++)if(!f[l].grouped){var q=[];q.push(f[l].lrCoordinates);
f[l].grouped=!0;for(var k=g([f[l].lrCoordinates]),m=l+1;m<f.length;m++)f[m].grouped||ko(g([f[m].lrCoordinates]),k)&&(q.push(f[m].lrCoordinates),f[m].grouped=!0);h.push(q)}return h}function ko(f,h){f=xh(f);for(var l=0;l<f.features.length;l++)if(!Wb(f.features[l],h))return!1;return!0}function jo(f){for(var h=0;h<f.length;h++)if(!1===f[h].grouped)return!1;return!0}function jl(f,h,l){if(!oa(l=l||{}))throw Error("options is invalid");var q=l.pivot;l=l.mutate;if(!f)throw Error("geojson is required");if(null==
h||isNaN(h))throw Error("angle is required");return 0===h||(q||=Ne(f),!1!==l&&void 0!==l||(f=Ec(f)),ya(f,function(k){var m=lf(q,k)+h,r=Bh(q,k);m=fa(Hf(q,r,m));k[0]=m[0];k[1]=m[1]})),f}function kl(f,h,l){if(!oa(l=l||{}))throw Error("options is invalid");var q=l.origin;l=l.mutate;if(!f)throw Error("geojson required");if("number"!=typeof h||0===h)throw Error("invalid factor");var k=Array.isArray(q)||"object"==typeof q;return!0!==l&&(f=Ec(f)),"FeatureCollection"!==f.type||k?ll(f,h,q):(Ia(f,function(m,
r){f.features[r]=ll(m,h,q)}),f)}function ll(f,h,l){var q="Point"===sc(f);return l=function(k,m){null==m&&(m="centroid");if(Array.isArray(m)||"object"==typeof m)return ia(m);var r=k.bbox?k.bbox:Aa(k),p=r[0],u=r[1],x=r[2];r=r[3];switch(m){case "sw":case "southwest":case "westsouth":case "bottomleft":return d([p,u]);case "se":case "southeast":case "eastsouth":case "bottomright":return d([x,u]);case "nw":case "northwest":case "westnorth":case "topleft":return d([p,r]);case "ne":case "northeast":case "eastnorth":case "topright":return d([x,
r]);case "center":return wh(k);case void 0:case null:case "centroid":return Ne(k);default:throw Error("invalid origin");}}(f,l),1===h||q||ya(f,function(k){var m=Bh(l,k),r=lf(l,k);m=fa(Hf(l,m*h,r));k[0]=m[0];k[1]=m[1];3===k.length&&(k[2]*=h)}),f}function Fh(f){var h=f[0];f=f[1];return[f[0]-h[0],f[1]-h[1]]}function Ti(f,h){return f[0]*h[1]-h[0]*f[1]}function lo(f,h){return!function(l,q){return 0===Ti(Fh(l),Fh(q))}(f,h)&&function(l,q){var k=l[0];l=Fh(l);var m=q[0];q=Fh(q);var r=Ti(l,q);return function(p,
u){return[p[0]+u[0],p[1]+u[1]]}(k,function(p,u){return[p*u[0],p*u[1]]}(Ti([m[0]-k[0],m[1]-k[1]],q)/r,l))}(f,h)}function ml(f,h,l){var q=[],k=P(h,l),m=fa(f),r=[];return m.forEach(function(p,u){if(u!==m.length-1){p=(x=p,v=m[u+1],y=k,B=Math.sqrt((x[0]-v[0])*(x[0]-v[0])+(x[1]-v[1])*(x[1]-v[1])),G=x[0]+y*(v[1]-x[1])/B,A=v[0]+y*(v[1]-x[1])/B,F=x[1]+y*(x[0]-v[0])/B,J=v[1]+y*(x[0]-v[0])/B,[[G,F],[A,J]]);if(q.push(p),0<u)x=q[u-1],v=lo(p,x),!1!==v&&(x[1]=v,p[0]=v),r.push(x[0]),u===m.length-2&&(r.push(p[0]),
r.push(p[1]));2===m.length&&(r.push(p[0]),r.push(p[1]))}var x,v,y,B,G,A,F,J}),t(r,f.properties)}function Ui(f,h,l){f=(h[0]-f[0])*(l[1]-h[1])-(l[0]-h[0])*(h[1]-f[1]);return(0<f)-(0>f)||+f}function nl(f,h){return h.geometry.coordinates[0].every(function(l){return Wb(d(l),f)})}function ol(f,h){var l=!0;return eb(f,function(q){eb(h,function(k){if(!1===l)return!1;l=function(m,r){switch(m.type){case "Point":switch(r.type){case "Point":return p=m.coordinates,u=r.coordinates,!(p[0]===u[0]&&p[1]===u[1]);case "LineString":return!pl(r,
m);case "Polygon":return!Wb(m,r)}break;case "LineString":switch(r.type){case "Point":return!pl(m,r);case "LineString":return m=0<le(m,r).features.length?!0:!1,!m;case "Polygon":return!ql(r,m)}break;case "Polygon":switch(r.type){case "Point":return!Wb(r,m);case "LineString":return!ql(m,r);case "Polygon":a:{p=0;for(u=r.coordinates[0];p<u.length;p++)if(Wb(u[p],m)){m=!0;break a}p=0;for(u=m.coordinates[0];p<u.length;p++)if(Wb(u[p],r)){m=!0;break a}m=0<le(zg(r),zg(m)).features.length?!0:!1}return!m}}var p,
u;return!1}(q.geometry,k.geometry)})}),l}function pl(f,h){for(var l=0;l<f.coordinates.length-1;l++){var q=f.coordinates[l],k=f.coordinates[l+1],m=h.coordinates,r=k[0]-q[0],p=k[1]-q[1];if(0==(m[0]-q[0])*p-(m[1]-q[1])*r&&(Math.abs(r)>=Math.abs(p)?0<r?q[0]<=m[0]&&m[0]<=k[0]:k[0]<=m[0]&&m[0]<=q[0]:0<p?q[1]<=m[1]&&m[1]<=k[1]:k[1]<=m[1]&&m[1]<=q[1]))return!0}return!1}function ql(f,h){for(var l=0,q=h.coordinates;l<q.length;l++)if(Wb(q[l],f))return!0;return 0<le(h,zg(f)).features.length}function rl(f,h){return!(f[0]>
h[0])&&!(f[2]<h[2])&&!(f[1]>h[1])&&!(f[3]<h[3])}function Vi(f,h){return f[0]===h[0]&&f[1]===h[1]}function sl(f,h){for(var l=!1,q=!1,k=f.coordinates.length,m=0;m<k&&!l&&!q;){for(var r=0;r<h.coordinates.length-1;r++){var p=!0;0!==r&&r!==h.coordinates.length-2||(p=!1);tl(h.coordinates[r],h.coordinates[r+1],f.coordinates[m],p)?l=!0:q=!0}m++}return l&&q}function ul(f,h){for(var l=!1,q=!1,k=f.coordinates.length,m=0;m<k&&(!l||!q);m++)Wb(d(f.coordinates[m]),h)?l=!0:q=!0;return q&&l}function tl(f,h,l,q){var k=
h[0]-f[0],m=h[1]-f[1];return 0==(l[0]-f[0])*m-(l[1]-f[1])*k&&(q?Math.abs(k)>=Math.abs(m)?0<k?f[0]<=l[0]&&l[0]<=h[0]:h[0]<=l[0]&&l[0]<=f[0]:0<m?f[1]<=l[1]&&l[1]<=h[1]:h[1]<=l[1]&&l[1]<=f[1]:Math.abs(k)>=Math.abs(m)?0<k?f[0]<l[0]&&l[0]<h[0]:h[0]<l[0]&&l[0]<f[0]:0<m?f[1]<l[1]&&l[1]<h[1]:h[1]<l[1]&&l[1]<f[1])}function vl(f){return f.coordinates.map(function(h){return{type:f.type.replace("Multi",""),coordinates:h}})}function wl(f,h){return f.hasOwnProperty("coordinates")?f.coordinates.length===h.coordinates.length:
f.length===h.length}function mo(f,h){return Gf(f,h,{strict:!0})}function xl(f,h){var l=!1;return eb(f,function(q){eb(h,function(k){if(!0===l)return!0;l=!ol(q.geometry,k.geometry)})}),l}function yl(f,h,l){l=l||[];for(var q=0;q<f;q++)l[q]=h;return l}function zl(f,h){if(f.geometry&&f.geometry.type)return f.geometry.type;if(f.type)return f.type;throw Error("Invalid GeoJSON object for "+h);}function Al(f){for(var h=[];f.parent;)h.unshift(f),f=f.parent;return h}function If(f,h){h=h||{};this.nodes=[];this.diagonal=
!!h.diagonal;this.grid=[];for(h=0;h<f.length;h++){this.grid[h]=[];for(var l=0,q=f[h];l<q.length;l++){var k=new Gh(h,l,q[l]);this.grid[h][l]=k;this.nodes.push(k)}}this.init()}function Gh(f,h,l){this.x=f;this.y=h;this.weight=l}function Bl(f){this.content=[];this.scoreFunction=f}function no(f,h){for(var l=0;l<h.features.length;l++)if(Wb(f,h.features[l]))return!0;return!1}function Cl(f){return function(){return f}}function oo(f){return f[0]}function po(f){return f[1]}function Hh(){this._=null}function Ih(f){f.U=
f.C=f.L=f.R=f.P=f.N=null}function Bg(f,h){var l=h.R,q=h.U;q?q.L===h?q.L=l:q.R=l:f._=l;l.U=q;h.U=l;h.R=l.L;h.R&&(h.R.U=h);l.L=h}function Cg(f,h){var l=h.L,q=h.U;q?q.L===h?q.L=l:q.R=l:f._=l;l.U=q;h.U=l;h.L=l.R;h.L&&(h.L.U=h);l.R=h}function Dl(f){for(;f.L;)f=f.L;return f}function Dg(f,h,l,q){var k=[null,null],m=Xc.push(k)-1;return k.left=f,k.right=h,l&&Jh(k,f,h,l),q&&Jh(k,h,f,q),sd[f.index].halfedges.push(m),sd[h.index].halfedges.push(m),k}function Eg(f,h,l){h=[h,l];return h.left=f,h}function Jh(f,h,
l,q){f[0]||f[1]?f.left===l?f[1]=q:f[0]=q:(f[0]=q,f.left=h,f.right=l)}function qo(f,h,l,q,k){var m,r=f[0],p=f[1],u=r[0];r=r[1];var x=0,v=1,y=p[0]-u;p=p[1]-r;if(m=h-u,y||!(0<m)){if(m/=y,0>y){if(m<x)return;m<v&&(v=m)}else if(0<y){if(m>v)return;m>x&&(x=m)}if(m=q-u,y||!(0>m)){if(m/=y,0>y){if(m>v)return;m>x&&(x=m)}else if(0<y){if(m<x)return;m<v&&(v=m)}if(m=l-r,p||!(0<m)){if(m/=p,0>p){if(m<x)return;m<v&&(v=m)}else if(0<p){if(m>v)return;m>x&&(x=m)}if(m=k-r,p||!(0>m)){if(m/=p,0>p){if(m>v)return;m>x&&(x=m)}else if(0<
p){if(m<x)return;m<v&&(v=m)}return!(0<x||1>v)||(0<x&&(f[0]=[u+x*y,r+x*p]),1>v&&(f[1]=[u+v*y,r+v*p]),!0)}}}}}function ro(f,h,l,q,k){var m=f[1];if(m)return!0;var r,p=f[0],u=f.left;var x=f.right;m=u[0];u=u[1];var v=x[0],y=x[1],B=(m+v)/2;if(y===u){if(B<h||B>=q)return;if(m>v){if(p){if(p[1]>=k)return}else p=[B,l];m=[B,k]}else{if(p){if(p[1]<l)return}else p=[B,k];m=[B,l]}}else if(x=(u+y)/2-(r=(m-v)/(y-u))*B,-1>r||1<r)if(m>v){if(p){if(p[1]>=k)return}else p=[(l-x)/r,l];m=[(k-x)/r,k]}else{if(p){if(p[1]<l)return}else p=
[(k-x)/r,k];m=[(l-x)/r,l]}else if(u<y){if(p){if(p[0]>=q)return}else p=[h,r*h+x];m=[q,r*q+x]}else{if(p){if(p[0]<h)return}else p=[q,r*q+x];m=[h,r*h+x]}return f[0]=p,f[1]=m,!0}function so(f,h){f=f.site;var l=h.left,q=h.right;return f===q&&(q=l,l=f),q?Math.atan2(q[1]-l[1],q[0]-l[0]):(f===l?(l=h[1],q=h[0]):(l=h[0],q=h[1]),Math.atan2(l[0]-q[0],q[1]-l[1]))}function El(f,h){return h[+(h.left!==f.site)]}function to(){Ih(this);this.x=this.y=this.arc=this.site=this.cy=null}function Jf(f){var h=f.P,l=f.N;if(h&&
l){var q=h.site;h=f.site;var k=l.site;if(q!==k){l=h[0];var m=h[1],r=q[0]-l,p=q[1]-m;q=k[0]-l;var u=k[1]-m;k=2*(r*u-p*q);if(!(k>=-uo)){var x=r*r+p*p,v=q*q+u*u;p=(u*x-p*v)/k;q=(r*v-q*x)/k;r=Fl.pop()||new to;r.arc=f;r.site=h;r.x=p+l;r.y=(r.cy=q+m)+Math.sqrt(p*p+q*q);f.circle=r;f=null;for(h=Fg._;h;)if(r.y<h.y||r.y===h.y&&r.x<=h.x){if(!h.L){f=h.P;break}h=h.L}else{if(!h.R){f=h;break}h=h.R}Fg.insert(f,r);f||(Wi=r)}}}}function Kf(f){var h=f.circle;h&&(h.P||(Wi=h.N),Fg.remove(h),Fl.push(h),Ih(h),f.circle=
null)}function vo(){Ih(this);this.edge=this.site=this.circle=null}function Gl(f){var h=Hl.pop()||new vo;return h.site=f,h}function Xi(f){Kf(f);Lf.remove(f);Hl.push(f);Ih(f)}function wo(f){var h=f.circle,l=h.x,q=h.cy;h=[l,q];var k=f.P,m=f.N,r=[f];Xi(f);for(f=k;f.circle&&Math.abs(l-f.circle.x)<Yb&&Math.abs(q-f.circle.cy)<Yb;)k=f.P,r.unshift(f),Xi(f),f=k;r.unshift(f);Kf(f);for(k=m;k.circle&&Math.abs(l-k.circle.x)<Yb&&Math.abs(q-k.circle.cy)<Yb;)m=k.N,r.push(k),Xi(k),k=m;r.push(k);Kf(k);q=r.length;for(l=
1;l<q;++l)k=r[l],f=r[l-1],Jh(k.edge,f.site,k.site,h);f=r[0];(k=r[q-1]).edge=Dg(f.site,k.site,null,h);Jf(f);Jf(k)}function xo(f){for(var h,l,q,k,m=f[0],r=f[1],p=Lf._;p;)if((q=Il(p,r)-m)>Yb)p=p.L;else{var u=p;k=r;var x=u.N;x?k=Il(x,k):(u=u.site,k=u[1]===k?u[0]:1/0);if(!((k=m-k)>Yb)){q>-Yb?(h=p.P,l=p):k>-Yb?(h=p,l=p.N):h=l=p;break}if(!p.R){h=p;break}p=p.R}sd[f.index]={site:f,halfedges:[]};!0;q=Gl(f);if(Lf.insert(h,q),h||l){if(h===l)return Kf(h),l=Gl(h.site),Lf.insert(q,l),q.edge=l.edge=Dg(h.site,q.site),
Jf(h),void Jf(l);if(l){Kf(h);Kf(l);m=h.site;p=m[0];k=m[1];u=f[0]-p;x=f[1]-k;r=l.site;var v=r[0]-p,y=r[1]-k,B=2*(u*y-x*v),G=u*u+x*x,A=v*v+y*y;p=[(y*G-x*A)/B+p,(u*A-v*G)/B+k];Jh(l.edge,m,r,p);q.edge=Dg(m,f,null,p);l.edge=Dg(f,r,null,p);Jf(h);Jf(l)}else q.edge=Dg(h.site,q.site)}}function Il(f,h){var l=f.site,q=l[0],k=l[1],m=k-h;if(!m)return q;f=f.P;if(!f)return-1/0;f=(l=f.site)[0];l=l[1];h=l-h;if(!h)return f;var r=f-q,p=1/m-1/h,u=r/h;return p?(-u+Math.sqrt(u*u-2*p*(r*r/(-2*h)-l+h/2+k-m/2)))/p+q:(q+f)/
2}function yo(f,h){return h[1]-f[1]||h[0]-f[0]}function Yi(f,h){var l,q,k,m=f.sort(yo).pop();Xc=[];sd=Array(f.length);Lf=new Hh;for(Fg=new Hh;;)if(k=Wi,m&&(!k||m[1]<k.y||m[1]===k.y&&m[0]<k.x))m[0]===l&&m[1]===q||(xo(m),l=m[0],q=m[1]),m=f.pop();else{if(!k)break;wo(k.arc)}if(function(){for(var r,p,u,x,v=0,y=sd.length;v<y;++v)if((r=sd[v])&&(x=(p=r.halfedges).length)){var B=Array(x),G=Array(x);for(u=0;u<x;++u)B[u]=u,G[u]=so(r,Xc[p[u]]);B.sort(function(A,F){return G[F]-G[A]});for(u=0;u<x;++u)G[u]=p[B[u]];
for(u=0;u<x;++u)p[u]=G[u]}}(),h)f=+h[0][0],l=+h[0][1],q=+h[1][0],h=+h[1][1],!function(r,p,u,x){for(var v,y=Xc.length;y--;)ro(v=Xc[y],r,p,u,x)&&qo(v,r,p,u,x)&&(Math.abs(v[0][0]-v[1][0])>Yb||Math.abs(v[0][1]-v[1][1])>Yb)||delete Xc[y]}(f,l,q,h),function(r,p,u,x){var v,y,B,G,A,F,J,D=sd.length,E=!0;for(v=0;v<D;++v)if(y=sd[v]){var I=y.site;for(B=(G=y.halfedges).length;B--;)Xc[G[B]]||G.splice(B,1);B=0;for(A=G.length;B<A;){var K=Xc[G[B]];var N=(J=K[+(K.left===y.site)])[0];var U=J[1];K=(F=El(y,Xc[G[++B%A]]))[0];
F=F[1];(Math.abs(N-K)>Yb||Math.abs(U-F)>Yb)&&(G.splice(B,0,Xc.push(Eg(I,J,Math.abs(N-r)<Yb&&x-U>Yb?[r,Math.abs(K-r)<Yb?F:x]:Math.abs(U-x)<Yb&&u-N>Yb?[Math.abs(F-x)<Yb?K:u,x]:Math.abs(N-u)<Yb&&U-p>Yb?[u,Math.abs(K-u)<Yb?F:p]:Math.abs(U-p)<Yb&&N-r>Yb?[Math.abs(F-p)<Yb?K:r,p]:null))-1),++A)}A&&(E=!1)}if(E){var X,aa,ha;B=1/0;v=0;for(E=null;v<D;++v)(y=sd[v])&&(ha=(X=(I=y.site)[0]-r)*X+(aa=I[1]-p)*aa)<B&&(B=ha,E=y);E&&(v=[r,p],r=[r,x],x=[u,x],p=[u,p],E.halfedges.push(Xc.push(Eg(I=E.site,v,r))-1,Xc.push(Eg(I,
r,x))-1,Xc.push(Eg(I,x,p))-1,Xc.push(Eg(I,p,v))-1))}for(v=0;v<D;++v)(y=sd[v])&&(y.halfedges.length||delete sd[v])}(f,l,q,h);this.edges=Xc;this.cells=sd;Lf=Fg=Xc=sd=null}function zo(f){return(f=f.slice()).push(f[0]),g([f])}function Jl(f,h,l,q){var k=(q=q||{}).steps||64,m=q.units||"kilometers",r=q.angle||0,p=q.pivot||f,u=q.properties||f.properties||{};if(!f)throw Error("center is required");if(!h)throw Error("xSemiAxis is required");if(!l)throw Error("ySemiAxis is required");if(!oa(q))throw Error("options must be an object");
if(!ea(k))throw Error("steps must be a number");if(!ea(r))throw Error("angle must be a number");q=ia(f);if("degrees"===m)var x=ca(r);else h=Hf(f,h,90,{units:m}),l=Hf(f,l,0,{units:m}),h=ia(h)[0]-q[0],l=ia(l)[1]-q[1];f=[];for(var v=0;v<k;v+=1){var y=-360*v/k,B=h*l/Math.sqrt(Math.pow(l,2)+Math.pow(h,2)*Math.pow(Math.tan(y*Math.PI/180),2)),G=h*l/Math.sqrt(Math.pow(h,2)+Math.pow(l,2)/Math.pow(Math.tan(y*Math.PI/180),2));if(-90>y&&-270<=y&&(B=-B),-180>y&&-360<=y&&(G=-G),"degrees"===m)y=G*Math.cos(x)-B*
Math.sin(x),B=B*Math.cos(x)+G*Math.sin(x),G=y;f.push([B+q[0],G+q[1]])}return f.push(f[0]),"degrees"===m?g([f],u):jl(g([f],u),r,{pivot:p})}function Zi(f,h){void 0===h&&(h={});var l=0,q=0,k=0;return Qb(f,function(m,r,p){var u=h.weight?null==p?void 0:p[h.weight]:void 0;if(!ea(u=null==u?1:u))throw Error("weight value must be a number for feature index "+r);0<(u=Number(u))&&ya(m,function(x){l+=x[0]*u;q+=x[1]*u;k+=u})}),d([l/k,q/k],h.properties,h)}function Kl(f,h,l,q,k){var m=q.tolerance||.001,r=0,p=0,
u=0,x=0;if(Ia(l,function(B){var G,A=null===(G=B.properties)||void 0===G?void 0:G.weight;G=null==A?1:A;if(!ea(G=Number(G)))throw Error("weight value must be a number");0<G&&(x+=1,A=G*Ob(B,f),0===A&&(A=1),G/=A,r+=B.geometry.coordinates[0]*G,p+=B.geometry.coordinates[1]*G,u+=G)}),1>x)throw Error("no features to measure");var v=r/u,y=p/u;return 1===x||0===k||Math.abs(v-h[0])<m&&Math.abs(y-h[1])<m?d([v,y],{medianCandidates:q.medianCandidates}):(q.medianCandidates.push([v,y]),Kl([v,y],f,l,q,k-1))}function Ll(f,
h){return{x:f[0]-h[0],y:f[1]-h[1]}}function Ao(f,h){var l=0,q=0;ya(f,function(k,m,r,p,u){u>l&&(l=u,q=m,h.push([]));r=f.coordinates[u][m-q+1];m=k[0];k=k[1];p=r[0];r=r[1];h[u].push([.75*m+.25*p,.75*k+.25*r]);h[u].push([.25*m+.75*p,.25*k+.75*r])},!0);h.forEach(function(k){k.push(k[0])})}function Bo(f,h){var l=0,q=0,k=0;ya(f,function(m,r,p,u,x){u>k&&(k=u,q=r,h.push([[]]));x>l&&(l=x,q=r,h[u].push([]));p=f.coordinates[u][x][r-q+1];r=m[0];m=m[1];var v=p[0];p=p[1];h[u][x].push([.75*r+.25*v,.75*m+.25*p]);
h[u][x].push([.25*r+.75*v,.25*m+.75*p])},!0);h.forEach(function(m){m.forEach(function(r){r.push(r[0])})})}function Co(f,h,l){void 0===l&&(l=2);f=ia(f);var q=ia(h);h=f[0]-q[0];f=f[1]-q[1];return 1===l?Math.abs(h)+Math.abs(f):Math.pow(Math.pow(h,l)+Math.pow(f,l),1/l)}function Ml(f,h){var l=(h=h||{}).threshold||1E4,q=h.p||2,k=h.binary||!1,m=h.alpha||-1;h=h.standardization||!1;var r=[];Ia(f,function(v){r.push(Ne(v))});f=[];for(var p=0;p<r.length;p++)f[p]=[];for(p=0;p<r.length;p++)for(var u=p;u<r.length;u++){p===
u&&(f[p][u]=0);var x=Co(r[p],r[u],q);f[p][u]=x;f[u][p]=x}for(p=0;p<r.length;p++)for(u=0;u<r.length;u++)0!==(x=f[p][u])&&(f[p][u]=k?x<=l?1:0:x<=l?Math.pow(x,m):0);if(h)for(p=0;p<r.length;p++)for(l=f[p].reduce(function(v,y){return v+y},0),u=0;u<r.length;u++)f[p][u]/=l;return f}function Nl(f){for(var h=0,l=0;l<f.length;l++)h+=f[l];return h/f.length}function Ol(f,h){return void 0===h&&(h={}),Pl(f,"mercator",h)}function Ql(f,h){return void 0===h&&(h={}),Pl(f,"wgs84",h)}function Pl(f,h,l){void 0===l&&(l=
{});var q=(l=l||{}).mutate;if(!f)throw Error("geojson is required");return Array.isArray(f)&&ea(f[0])?f="mercator"===h?Rl(f):Sl(f):(!0!==q&&(f=Ec(f)),ya(f,function(k){var m="mercator"===h?Rl(k):Sl(k);k[0]=m[0];k[1]=m[1]})),f}function Rl(f){var h=Math.PI/180;if(180>=Math.abs(f[0]))var l=f[0];else l=f[0],l=f[0]-360*(0>l?-1:0<l?1:0);f=[6378137*l*h,6378137*Math.log(Math.tan(.25*Math.PI+.5*f[1]*h))];return 2.0037508342789244E7<f[0]&&(f[0]=2.0037508342789244E7),-2.0037508342789244E7>f[0]&&(f[0]=-2.0037508342789244E7),
2.0037508342789244E7<f[1]&&(f[1]=2.0037508342789244E7),-2.0037508342789244E7>f[1]&&(f[1]=-2.0037508342789244E7),f}function Sl(f){var h=180/Math.PI;return[f[0]*h/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-f[1]/6378137)))*h]}function Gg(f){return Array.isArray(f)?Tl(f):f&&f.bbox?Tl(f.bbox):[360*(Math.random()-.5),180*(Math.random()-.5)]}function Ul(f,h){void 0===h&&(h={});null==f&&(f=1);for(var l=[],q=0;q<f;q++)l.push(d(Gg(h.bbox)));return z(l)}function Vl(f,h){void 0===h&&(h={});null==f&&(f=1);ea(h.num_vertices)&&
void 0!==h.num_vertices||(h.num_vertices=10);ea(h.max_radial_length)&&void 0!==h.max_radial_length||(h.max_radial_length=10);for(var l=[],q=function(m){var r,p=[],u=Do(Array(h.num_vertices+1)).map(Math.random);u.forEach(function(x,v,y){y[v]=0<v?x+y[v-1]:x});u.forEach(function(x){x=2*x*Math.PI/u[u.length-1];var v=Math.random();p.push([v*(h.max_radial_length||10)*Math.sin(x),v*(h.max_radial_length||10)*Math.cos(x)])});p[p.length-1]=p[0];p=p.map((r=Gg(h.bbox),function(x){return[x[0]+r[0],x[1]+r[1]]}));
l.push(g([p]))},k=0;k<f;k++)q();return z(l)}function Wl(f,h){if(void 0===h&&(h={}),!oa(h=h||{}))throw Error("options is invalid");var l=h.bbox,q=h.num_vertices,k=h.max_length;h=h.max_rotation;null==f&&(f=1);(!ea(q)||void 0===q||2>q)&&(q=10);ea(k)&&void 0!==k||(k=1E-4);ea(h)&&void 0!==h||(h=Math.PI/8);for(var m=[],r=0;r<f;r++){for(var p=[Gg(l)],u=0;u<q-1;u++){var x=(0===u?2*Math.random()*Math.PI:Math.tan((p[u][1]-p[u-1][1])/(p[u][0]-p[u-1][0])))+(Math.random()-.5)*h*2,v=Math.random()*k;p.push([p[u][0]+
v*Math.cos(x),p[u][1]+v*Math.sin(x)])}m.push(t(p))}return z(m)}function Tl(f){return[Math.random()*(f[2]-f[0])+f[0],Math.random()*(f[3]-f[1])+f[1]]}function Xl(f,h){if(!f)throw Error("geojson is required");if("FeatureCollection"!==f.type)throw Error("geojson must be a FeatureCollection");if(null==h)throw Error("filter is required");var l=[];return Ia(f,function(q){Kh(q.properties,h)&&l.push(q)}),z(l)}function $i(f,h,l){if(!f)throw Error("geojson is required");if("FeatureCollection"!==f.type)throw Error("geojson must be a FeatureCollection");
if(null==h)throw Error("property is required");h=aj(f,h);for(var q=Object.keys(h),k=0;k<q.length;k++){for(var m=q[k],r=h[m],p=[],u=0;u<r.length;u++)p.push(f.features[r[u]]);l(z(p),m,k)}}function Yl(f,h,l,q){var k=q;return $i(f,h,function(m,r,p){k=0===p&&void 0===q?m:l(k,m,r,p)}),k}function aj(f,h){var l={};return Ia(f,function(q,k){q=q.properties||{};Object.prototype.hasOwnProperty.call(q,String(h))&&(q=q[h],Object.prototype.hasOwnProperty.call(l,q)?l[q].push(k):l[q]=[k])}),l}function Kh(f,h){if(void 0===
f)return!1;var l=typeof h;if("number"===l||"string"===l)return Object.prototype.hasOwnProperty.call(f,h);if(Array.isArray(h)){for(l=0;l<h.length;l++)if(!Kh(f,h[l]))return!1;return!0}return bj(f,h)}function bj(f,h){for(var l=Object.keys(h),q=0;q<l.length;q++){var k=l[q];if(f[k]!==h[k])return!1}return!0}function Zl(f,h){if(!h||!h.length)return{};for(var l={},q=0;q<h.length;q++){var k=h[q];Object.prototype.hasOwnProperty.call(f,k)&&(l[k]=f[k])}return l}function Eo(f,h){return f>h?1:f<h?-1:0}function Oe(f,
h,l){for(var q=new Pe(null,null),k=q,m=q;;){var r=l(f,h.key);if(0>r){if(null===h.left)break;if(0>l(f,h.left.key)&&(r=h.left,h.left=r.right,r.right=h,null===(h=r).left))break;m=m.left=h;h=h.left}else{if(!(0<r))break;if(null===h.right)break;if(0<l(f,h.right.key)&&(r=h.right,h.right=r.left,r.left=h,null===(h=r).right))break;k=k.right=h;h=h.right}}return k.right=h.left,m.left=h.right,h.left=q.right,h.right=q.left,h}function cj(f,h,l,q){h=new Pe(f,h);if(null===l)return h.left=h.right=null,h;f=q(f,(l=Oe(f,
l,q)).key);return 0>f?(h.left=l.left,h.right=l,l.left=null):0<=f&&(h.right=l.right,h.left=l,l.right=null),h}function $l(f,h,l){var q=null,k=null;h&&(l=l((h=Oe(f,h,l)).key,f),0===l?(q=h.left,k=h.right):0>l?(k=h.right,h.right=null,q=h):(q=h.left,h.left=null,k=h));return{left:q,right:k}}function dj(f,h,l,q,k){f&&(q(h+(l?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+k(f)+"\n"),h+=l?"    ":"\u2502   ",f.left&&dj(f.left,h,!1,q,k),f.right&&dj(f.right,h,!0,q,k))}function ej(f,h,l,q){var k=q-l;if(0<k){k=l+
Math.floor(k/2);var m=new Pe(f[k],h[k]);return m.left=ej(f,h,l,k),m.right=ej(f,h,k+1,q),m}return null}function fj(f,h,l){var q=l-h;if(0<q){q=h+Math.floor(q/2);h=fj(f,h,q);var k=f.head;return k.left=h,f.head=f.head.next,k.right=fj(f,q+1,l),k}return null}function gj(f,h,l,q,k){if(!(l>=q)){for(var m=f[l+q>>1],r=l-1,p=q+1;;){do r++;while(0>k(f[r],m));do p--;while(0<k(f[p],m));if(r>=p)break;var u=f[r];f[r]=f[p];f[p]=u;u=h[r];h[r]=h[p];h[p]=u}gj(f,h,l,p,k);gj(f,h,p+1,q,k)}}function Ad(f,h){if(!(f instanceof
h))throw new TypeError("Cannot call a class as a function");}function am(f,h){for(var l=0;l<h.length;l++){var q=h[l];q.enumerable=q.enumerable||!1;q.configurable=!0;"value"in q&&(q.writable=!0);Object.defineProperty(f,q.key,q)}}function ed(f,h,l){return h&&am(f.prototype,h),l&&am(f,l),f}function ld(){}function hj(f){this.message=f||""}function Mf(f){this.message=f||""}function Hg(f){this.message=f||""}function Lh(){}function Tb(f){return null===f?null:f.parent}function me(f,h){null!==f&&(f.color=
h)}function ij(f){return null===f?null:f.left}function bm(f){return null===f?null:f.right}function Bc(){this.root_=null;this.size_=0}function cm(){}function Bd(f){this.array_=[];f instanceof mc&&this.addAll(f)}function Fo(){}function Go(){}function Ho(){}function Io(){}function Mh(f){this.message=f||""}function Cd(){this.array_=[]}function Td(){this.reset()}function dm(f,h,l){var q=f.s=h+l,k=q-h;f.t=h-(q-k)+(l-k)}function em(f){return 1<f?0:-1>f?Rb:Math.acos(f)}function Nf(f){return 1<f?ne:-1>f?-ne:
Math.asin(f)}function Ig(){}function Nh(f,h){f&&fm.hasOwnProperty(f.type)&&fm[f.type](f,h)}function jj(f,h,l){var q=-1,k=f.length-l;for(h.lineStart();++q<k;)l=f[q],h.point(l[0],l[1],l[2]);h.lineEnd()}function gm(f,h){var l=-1,q=f.length;for(h.polygonStart();++l<q;)jj(f[l],h,1);h.polygonEnd()}function kj(f){return[Of(f[1],f[0]),Nf(f[2])]}function Pf(f){var h=f[0];f=f[1];var l=nc(f);return[l*nc(h),l*oc(h),oc(f)]}function Oh(f,h){return f[0]*h[0]+f[1]*h[1]+f[2]*h[2]}function Ph(f,h){return[f[1]*h[2]-
f[2]*h[1],f[2]*h[0]-f[0]*h[2],f[0]*h[1]-f[1]*h[0]]}function lj(f,h){f[0]+=h[0];f[1]+=h[1];f[2]+=h[2]}function Qh(f,h){return[f[0]*h,f[1]*h,f[2]*h]}function mj(f){var h=Jg(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]);f[0]/=h;f[1]/=h;f[2]/=h}function hm(f,h){function l(q,k){return q=f(q,k),h(q[0],q[1])}return f.invert&&h.invert&&(l.invert=function(q,k){return(q=h.invert(q,k))&&f.invert(q[0],q[1])}),l}function nj(f,h){return[f>Rb?f-oe:f<-Rb?f+oe:f,h]}function im(f){return function(h,l){return[(h+=f)>Rb?h-oe:h<-Rb?
h+oe:h,l]}}function jm(f){var h=im(f);return h.invert=im(-f),h}function km(f,h){function l(p,u){var x=nc(u),v=nc(p)*x;p=oc(p)*x;u=oc(u);x=u*q+v*k;return[Of(p*m-x*r,v*q-u*k),Nf(x*m+p*r)]}var q=nc(f),k=oc(f),m=nc(h),r=oc(h);return l.invert=function(p,u){var x=nc(u),v=nc(p)*x;p=oc(p)*x;u=oc(u);x=u*m-p*r;return[Of(p*m+u*r,v*q+x*k),Nf(x*q-v*k)]},l}function lm(f,h){(h=Pf(h))[0]-=f;mj(h);f=em(-h[1]);return((0>-h[2]?-f:f)+oe-1E-6)%oe}function mm(){var f,h=[];return{point:function(l,q){f.push([l,q])},lineStart:function(){h.push(f=
[])},lineEnd:Ig,rejoin:function(){1<h.length&&h.push(h.pop().concat(h.shift()))},result:function(){var l=h;return h=[],f=null,l}}}function Rh(f,h){return 1E-6>Gc(f[0]-h[0])&&1E-6>Gc(f[1]-h[1])}function Sh(f,h,l,q){this.x=f;this.z=h;this.o=l;this.e=q;this.v=!1;this.n=this.p=null}function nm(f,h,l,q,k){var m=[],r=[];if(f.forEach(function(y){if(!(0>=(B=y.length-1))){var B,G=y[0],A=y[B];if(Rh(G,A)){k.lineStart();for(p=0;p<B;++p)k.point((G=y[p])[0],G[1]);k.lineEnd()}else m.push(B=new Sh(G,y,null,!0)),
r.push(B.o=new Sh(G,null,B,!1)),m.push(B=new Sh(A,y,null,!1)),r.push(B.o=new Sh(A,null,B,!0))}}),m.length){r.sort(h);om(m);om(r);var p=0;for(f=r.length;p<f;++p)r[p].e=l=!l;var u;for(h=m[0];;){for(var x=h,v=!0;x.v;)if((x=x.n)===h)return;l=x.z;k.lineStart();do{if(x.v=x.o.v=!0,x.e){if(v)for(p=0,f=l.length;p<f;++p)k.point((u=l[p])[0],u[1]);else q(x.x,x.n.x,1,k);x=x.n}else{if(v)for(l=x.p.z,p=l.length-1;0<=p;--p)k.point((u=l[p])[0],u[1]);else q(x.x,x.p.x,-1,k);x=x.p}l=(x=x.o).z;v=!v}while(!x.v);k.lineEnd()}}}
function om(f){if(h=f.length){for(var h,l,q=0,k=f[0];++q<h;)k.n=l=f[q],l.p=k,k=l;k.n=l=f[0];l.p=k}}function pm(f){var h,l,q=f.length;var k=-1;for(var m=0;++k<q;)m+=f[k].length;for(h=Array(m);0<=--q;)for(k=(l=f[q]).length;0<=--k;)h[--m]=l[k];return h}function Jo(f,h,l,q){function k(u,x,v,y){var B=0,G=0;if(null==u||(B=m(u,v))!==(G=m(x,v))||0>p(u,x)^0<v){do y.point(0===B||3===B?f:l,1<B?q:h);while((B=(B+v+4)%4)!==G)}else y.point(x[0],x[1])}function m(u,x){return 1E-6>Gc(u[0]-f)?0<x?0:3:1E-6>Gc(u[0]-l)?
0<x?2:1:1E-6>Gc(u[1]-h)?0<x?1:0:0<x?3:2}function r(u,x){return p(u.x,x.x)}function p(u,x){var v=m(u,1),y=m(x,1);return v!==y?v-y:0===v?x[1]-u[1]:1===v?u[0]-x[0]:2===v?u[1]-x[1]:x[0]-u[0]}return function(u){function x(ha,da){f<=ha&&ha<=l&&h<=da&&da<=q&&U.point(ha,da)}function v(ha,da){var ka=f<=ha&&ha<=l&&h<=da&&da<=q;if(B&&G.push([ha,da]),K)A=ha,F=da,J=ka,K=!1,ka&&(U.lineStart(),U.point(ha,da));else if(ka&&I)U.point(ha,da);else{var pa=[D=Math.max(-1E9,Math.min(1E9,D)),E=Math.max(-1E9,Math.min(1E9,
E))],ra=[ha=Math.max(-1E9,Math.min(1E9,ha)),da=Math.max(-1E9,Math.min(1E9,da))];(function(ma,ta,na,Pa,Sa,Vb){var Ta,Yc=ma[0],hc=ma[1],pc=0,ec=1,ic=ta[0]-Yc,Hc=ta[1]-hc;if(Ta=na-Yc,ic||!(0<Ta)){if(Ta/=ic,0>ic){if(Ta<pc)return;Ta<ec&&(ec=Ta)}else if(0<ic){if(Ta>ec)return;Ta>pc&&(pc=Ta)}if(Ta=Sa-Yc,ic||!(0>Ta)){if(Ta/=ic,0>ic){if(Ta>ec)return;Ta>pc&&(pc=Ta)}else if(0<ic){if(Ta<pc)return;Ta<ec&&(ec=Ta)}if(Ta=Pa-hc,Hc||!(0<Ta)){if(Ta/=Hc,0>Hc){if(Ta<pc)return;Ta<ec&&(ec=Ta)}else if(0<Hc){if(Ta>ec)return;
Ta>pc&&(pc=Ta)}if(Ta=Vb-hc,Hc||!(0>Ta)){if(Ta/=Hc,0>Hc){if(Ta>ec)return;Ta>pc&&(pc=Ta)}else if(0<Hc){if(Ta<pc)return;Ta<ec&&(ec=Ta)}return 0<pc&&(ma[0]=Yc+pc*ic,ma[1]=hc+pc*Hc),1>ec&&(ta[0]=Yc+ec*ic,ta[1]=hc+ec*Hc),!0}}}}})(pa,ra,f,h,l,q)?(I||(U.lineStart(),U.point(pa[0],pa[1])),U.point(ra[0],ra[1]),ka||U.lineEnd(),N=!1):ka&&(U.lineStart(),U.point(ha,da),N=!1)}D=ha;E=da;I=ka}var y,B,G,A,F,J,D,E,I,K,N,U=u,X=mm(),aa={point:x,lineStart:function(){aa.point=v;B&&B.push(G=[]);K=!0;I=!1;D=E=NaN},lineEnd:function(){y&&
(v(A,F),J&&I&&X.rejoin(),y.push(X.result()));aa.point=x;I&&U.lineEnd()},polygonStart:function(){U=X;y=[];B=[];N=!0},polygonEnd:function(){for(var ha,da=ha=0,ka=B.length;da<ka;++da){var pa=B[da],ra=1,ma=pa.length,ta=pa[0],na=ta[0];for(ta=ta[1];ra<ma;++ra){var Pa=na;var Sa=ta;na=(ta=pa[ra])[0];ta=ta[1];Sa<=q?ta>q&&(na-Pa)*(q-Sa)>(ta-Sa)*(f-Pa)&&++ha:ta<=q&&(na-Pa)*(q-Sa)<(ta-Sa)*(f-Pa)&&--ha}}da=N&&ha;ka=(y=pm(y)).length;(da||ka)&&(u.polygonStart(),da&&(u.lineStart(),k(null,null,1,u),u.lineEnd()),ka&&
nm(y,r,ha,k,u),u.polygonEnd());U=u;y=B=G=null}};return aa}}function qm(f){return f}function rm(f,h,l,q){return function(k,m){function r(U,X){var aa=k(U,X);f(U=aa[0],X=aa[1])&&m.point(U,X)}function p(U,X){U=k(U,X);J.point(U[0],U[1])}function u(){N.point=p;J.lineStart()}function x(){N.point=r;J.lineEnd()}function v(U,X){F.push([U,X]);U=k(U,X);I.point(U[0],U[1])}function y(){I.lineStart();F=[]}function B(){v(F[0][0],F[0][1]);I.lineEnd();var U;var X=I.clean();var aa=E.result();var ha=aa.length;if(F.pop(),
G.push(F),F=null,ha)if(1&X){if(0<(aa=(ha=aa[0]).length-1)){K||(m.polygonStart(),K=!0);m.lineStart();for(X=0;X<aa;++X)m.point((U=ha[X])[0],U[1]);m.lineEnd()}}else 1<ha&&2&X&&aa.push(aa.pop().concat(aa.shift())),A.push(aa.filter(Ko))}var G,A,F,J=h(m),D=k.invert(q[0],q[1]),E=mm(),I=h(E),K=!1,N={point:r,lineStart:u,lineEnd:x,polygonStart:function(){N.point=v;N.lineStart=y;N.lineEnd=B;A=[];G=[]},polygonEnd:function(){N.point=r;N.lineStart=u;N.lineEnd=x;A=pm(A);var U=G;var X=D[0],aa=D[1],ha=[oc(X),-nc(X),
0],da=0,ka=0;oj.reset();for(var pa=0,ra=U.length;pa<ra;++pa)if(ta=(ma=U[pa]).length){var ma,ta,na=ma[ta-1],Pa=na[0],Sa=na[1]/2+sm,Vb=oc(Sa),Ta=nc(Sa);for(Sa=0;Sa<ta;++Sa,Pa=hc,Vb=pc,Ta=ec,na=Yc){var Yc=ma[Sa],hc=Yc[0];ec=Yc[1]/2+sm;var pc=oc(ec),ec=nc(ec),ic=hc-Pa,Hc=0<=ic?1:-1,Qf=Hc*ic,Qe=Qf>Rb;Vb*=pc;if(oj.add(Of(Vb*Hc*oc(Qf),Ta*ec+Vb*nc(Qf))),da+=Qe?ic+Hc*oe:ic,Qe^Pa>=X^hc>=X)na=Ph(Pf(na),Pf(Yc)),mj(na),Pa=Ph(ha,na),mj(Pa),Pa=(Qe^0<=ic?-1:1)*Nf(Pa[2]),(aa>Pa||aa===Pa&&(na[0]||na[1]))&&(ka+=Qe^
0<=ic?1:-1)}}U=(-1E-6>da||1E-6>da&&-1E-6>oj)^1&ka;A.length?(K||(m.polygonStart(),K=!0),nm(A,Lo,U,l,m)):U&&(K||(m.polygonStart(),K=!0),m.lineStart(),l(null,null,1,m),m.lineEnd());K&&(m.polygonEnd(),K=!1);A=G=null},sphere:function(){m.polygonStart();m.lineStart();l(null,null,1,m);m.lineEnd();m.polygonEnd()}};return N}}function Ko(f){return 1<f.length}function Lo(f,h){return(0>(f=f.x)[0]?f[1]-ne-1E-6:ne-f[1])-(0>(h=h.x)[0]?h[1]-ne-1E-6:ne-h[1])}function Mo(f,h){function l(u,x){return nc(u)*nc(x)>m}function q(u,
x,v){var y=[1,0,0],B=Ph(Pf(u),Pf(x)),G=Oh(B,B),A=B[0],F=G-A*A;if(!F)return!v&&u;G=m*G/F;F=-m*A/F;A=Ph(y,B);y=Qh(y,G);lj(y,Qh(B,F));B=Oh(y,A);G=Oh(A,A);F=B*B-G*(Oh(y,y)-1);if(!(0>F)){var J=Jg(F);F=Qh(A,(-B-J)/G);if(lj(F,y),F=kj(F),!v)return F;var D;v=u[0];var E=x[0];u=u[1];x=x[1];E<v&&(D=v,v=E,E=D);var I=E-v,K=1E-6>Gc(I-Rb);if(!K&&x<u&&(D=u,u=x,x=D),K||1E-6>I?K?0<u+x^F[1]<(1E-6>Gc(F[0]-v)?u:x):u<=F[1]&&F[1]<=x:I>Rb^(v<=F[0]&&F[0]<=E))return D=Qh(A,(-B+J)/G),lj(D,y),[F,kj(D)]}}function k(u,x){var v=
r?f:Rb-f,y=0;return u<-v?y|=1:u>v&&(y|=2),x<-v?y|=4:x>v&&(y|=8),y}var m=nc(f),r=0<m,p=1E-6<Gc(m);return rm(l,function(u){var x,v,y,B,G;return{lineStart:function(){B=y=!1;G=1},point:function(A,F){var J,D=[A,F],E=l(A,F);A=r?E?0:k(A,F):E?k(A+(0>A?Rb:-Rb),F):0;if(!x&&(B=y=E)&&u.lineStart(),E!==y&&(!(J=q(x,D))||Rh(x,J)||Rh(D,J))&&(D[0]+=1E-6,D[1]+=1E-6,E=l(D[0],D[1])),E!==y)G=0,E?(u.lineStart(),J=q(D,x),u.point(J[0],J[1])):(J=q(x,D),u.point(J[0],J[1]),u.lineEnd()),x=J;else if(p&&x&&r^E){var I;A&v||!(I=
q(D,x,!0))||(G=0,r?(u.lineStart(),u.point(I[0][0],I[0][1]),u.point(I[1][0],I[1][1]),u.lineEnd()):(u.point(I[1][0],I[1][1]),u.lineEnd(),u.lineStart(),u.point(I[0][0],I[0][1])))}!E||x&&Rh(x,D)||u.point(D[0],D[1]);x=D;y=E;v=A},lineEnd:function(){y&&u.lineEnd();x=null},clean:function(){return G|(B&&y)<<1}}},function(u,x,v,y){var B=u;if(h){u=nc(f);var G=oc(f),A=v*h;null==B?(B=f+v*oe,x=f-A/2):(B=lm(u,B),x=lm(u,x),(0<v?B<x:B>x)&&(B+=v*oe));for(var F=B;0<v?F>x:F<x;F-=A)B=kj([u,-G*nc(F),-G*oc(F)]),y.point(B[0],
B[1])}!0},r?[0,-f]:[-Rb,f-Rb])}function tm(f){return function(h){var l=new pj,q;for(q in f)l[q]=f[q];return l.stream=h,l}}function pj(){}function um(f,h,l){var q=h[1][0]-h[0][0],k=h[1][1]-h[0][1],m=f.clipExtent&&f.clipExtent();f.scale(150).translate([0,0]);null!=m&&f.clipExtent(null);var r=f.stream(vm);l&&wm.hasOwnProperty(l.type)?wm[l.type](l,r):Nh(l,r);r=vm.result();l=Math.min(q/(r[1][0]-r[0][0]),k/(r[1][1]-r[0][1]));q=+h[0][0]+(q-l*(r[1][0]+r[0][0]))/2;h=+h[0][1]+(k-l*(r[1][1]+r[0][1]))/2;return null!=
m&&f.clipExtent(m),f.scale(150*l).translate([q,h])}function xm(f,h){return+h?function(l,q){function k(m,r,p,u,x,v,y,B,G,A,F,J,D,E){var I=y-m,K=B-r,N=I*I+K*K;if(N>4*q&&D--){var U=u+A,X=x+F,aa=v+J,ha=Jg(U*U+X*X+aa*aa),da=Nf(aa/=ha),ka=1E-6>Gc(Gc(aa)-1)||1E-6>Gc(p-G)?(p+G)/2:Of(X,U),pa=l(ka,da);da=pa[0];pa=pa[1];var ra=da-m,ma=pa-r,ta=K*ra-I*ma;(ta*ta/N>q||.3<Gc((I*ra+K*ma)/N-.5)||u*A+x*F+v*J<No)&&(k(m,r,p,u,x,v,da,pa,ka,U/=ha,X/=ha,aa,D,E),E.point(da,pa),k(da,pa,ka,U,X,aa,y,B,G,A,F,J,D,E))}}return function(m){function r(da,
ka){da=l(da,ka);m.point(da[0],da[1])}function p(){K=NaN;ha.point=u;m.lineStart()}function u(da,ka){var pa=Pf([da,ka]);ka=l(da,ka);k(K,N,I,U,X,aa,K=ka[0],N=ka[1],I=da,U=pa[0],X=pa[1],aa=pa[2],16,m);m.point(K,N)}function x(){ha.point=r;m.lineEnd()}function v(){p();ha.point=y;ha.lineEnd=B}function y(da,ka){u(G=da,ka);A=K;F=N;J=U;D=X;E=aa;ha.point=u}function B(){k(K,N,I,U,X,aa,A,F,G,J,D,E,16,m);ha.lineEnd=x;x()}var G,A,F,J,D,E,I,K,N,U,X,aa,ha={point:r,lineStart:p,lineEnd:x,polygonStart:function(){m.polygonStart();
ha.lineStart=v},polygonEnd:function(){m.polygonEnd();ha.lineStart=p}};return ha}}(f,h):function(l){return tm({point:function(q,k){q=l(q,k);this.stream.point(q[0],q[1])}})}(f)}function Oo(f){return function(h){function l(ma){return[(ma=v(ma[0]*Dd,ma[1]*Dd))[0]*J+p,u-ma[1]*J]}function q(ma){return(ma=v.invert((ma[0]-p)/J,(u-ma[1])/J))&&[ma[0]*Re,ma[1]*Re]}function k(ma,ta){return[(ma=r(ma,ta))[0]*J+p,u-ma[1]*J]}function m(){var ma=N,ta=U,na=X;var Pa=(ma%=oe)?ta||na?hm(jm(ma),km(ta,na)):jm(ma):ta||na?
km(ta,na):nj;v=hm(x=Pa,r);Pa=r(I,K);return p=D-Pa[0]*J,u=E+Pa[1]*J,A=F=null,l}var r,p,u,x,v,y,B,G,A,F,J=150,D=480,E=250,I=0,K=0,N=0,U=0,X=0,aa=null,ha=ym,da=null,ka=qm,pa=.5,ra=xm(k,pa);return l.stream=function(ma){return A&&F===ma?A:A=Po(ha(x,ra(ka(F=ma))))},l.clipAngle=function(ma){return arguments.length?(ha=+ma?Mo(aa=ma*Dd,6*Dd):(aa=null,ym),A=F=null,l):aa*Re},l.clipExtent=function(ma){return arguments.length?(ka=null==ma?(da=y=B=G=null,qm):Jo(da=+ma[0][0],y=+ma[0][1],B=+ma[1][0],G=+ma[1][1]),
A=F=null,l):null==da?null:[[da,y],[B,G]]},l.scale=function(ma){return arguments.length?(J=+ma,m()):J},l.translate=function(ma){return arguments.length?(D=+ma[0],E=+ma[1],m()):[D,E]},l.center=function(ma){return arguments.length?(I=ma[0]%360*Dd,K=ma[1]%360*Dd,m()):[I*Re,K*Re]},l.rotate=function(ma){return arguments.length?(N=ma[0]%360*Dd,U=ma[1]%360*Dd,X=2<ma.length?ma[2]%360*Dd:0,m()):[N*Re,U*Re,X*Re]},l.precision=function(ma){return arguments.length?(ra=xm(k,pa=ma*ma),A=F=null,l):Jg(pa)},l.fitExtent=
function(ma,ta){return um(l,ma,ta)},l.fitSize=function(ma,ta){return um(l,[[0,0],ma],ta)},function(){return r=h.apply(this,arguments),l.invert=r.invert&&q,m()}}(function(){return f})()}function Th(f,h,l,q){var k=f.properties||{},m="Feature"===f.type?f.geometry:f;if("GeometryCollection"===m.type){var r=[];return Qb(f,function(u){(u=Th(u,h,l,q))&&r.push(u)}),z(r)}f=function(u){u=wh(u).geometry.coordinates;u=[-u[0],-u[1]];return Oo(zm).scale(79.4188).clipAngle(179.999).rotate(u).scale(6371008.8)}(m);
m={type:m.type,coordinates:Am(m.coordinates,f)};m=(new qj).read(m);var p=S(T(h,l),"meters");m=yc.bufferOp(m,p,q);if(!Bm((m=(new Cm).write(m)).coordinates))return b({type:m.type,coordinates:Dm(m.coordinates,f)},k)}function Bm(f){return Array.isArray(f[0])?Bm(f[0]):isNaN(f[0])}function Am(f,h){return"object"!=typeof f[0]?h(f):f.map(function(l){return Am(l,h)})}function Dm(f,h){return"object"!=typeof f[0]?h.invert(f):f.map(function(l){return Dm(l,h)})}function Kg(f,h,l){void 0===l&&(l={});f=Lb(f);h=
Lb(h);h=De.intersection(f.coordinates,h.coordinates);return 0===h.length?null:1===h.length?g(h[0],l.properties):M(h,l.properties)}function Em(f,h,l){void 0===l&&(l={});var q=JSON.stringify(l.properties||{}),k=f[0],m=f[1],r=f[2],p=f[3];f=(m+p)/2;var u=(k+r)/2;f=2*h/Ob([k,f],[r,f],l)*(r-k);h=2*h/Ob([u,m],[u,p],l)*(p-m);var x=f/2,v=2*x;u=Math.sqrt(3)/2*h;var y=r-k,B=p-m;r=.75*v;p=Math.floor((y-v)/(v-x/2));x=(p*r-x/2-y)/2-x/2+r/2;v=Math.floor((B-u)/u);y=(B-v*u)/2;(B=v*u-B>u/2)&&(y-=u/4);for(var G=[],
A=[],F=0;6>F;F++){var J=2*Math.PI/6*F;G.push(Math.cos(J));A.push(Math.sin(J))}var D=[];for(F=0;F<=p;F++)for(J=0;J<=v;J++){var E=1==F%2;if(!(0===J&&E||0===J&&B)){var I=F*r+k-x,K=J*u+m+y;(E&&(K-=u/2),!0===l.triangles)?Qo([I,K],f/2,h/2,JSON.parse(q),G,A).forEach(function(N){l.mask?Kg(l.mask,N)&&D.push(N):D.push(N)}):(E=Ro([I,K],f/2,h/2,JSON.parse(q),G,A),l.mask?Kg(l.mask,E)&&D.push(E):D.push(E))}}return z(D)}function Ro(f,h,l,q,k,m){for(var r=[],p=0;6>p;p++)r.push([f[0]+h*k[p],f[1]+l*m[p]]);return r.push(r[0].slice()),
g([r],q)}function Qo(f,h,l,q,k,m){for(var r=[],p=0;6>p;p++){var u=[];u.push(f);u.push([f[0]+h*k[p],f[1]+l*m[p]]);u.push([f[0]+h*k[(p+1)%6],f[1]+l*m[(p+1)%6]]);u.push(f);r.push(g([u],q))}return r}function Fm(f,h,l){void 0===l&&(l={});void 0===l&&(l={});var q=[],k=f[0],m=f[1],r=f[2],p=f[3];f=h/Ob([k,m],[r,m],l)*(r-k);h=h/Ob([k,m],[k,p],l)*(p-m);var u=r-k,x=p-m;r=Math.floor(u/f);p=Math.floor(x/h);x=(x-p*h)/2;k+=(u-r*f)/2;for(u=0;u<r;u++){for(var v=m+x,y=0;y<p;y++){var B=g([[[k,v],[k,v+h],[k+f,v+h],[k+
f,v],[k,v]]],l.properties);l.mask?xl(l.mask,B)&&q.push(B):q.push(B);v+=h}k+=f}return z(q)}function Gm(f,h,l){void 0===l&&(l={});var q=[],k=h/Ob([f[0],f[1]],[f[2],f[1]],l)*(f[2]-f[0]);h=h/Ob([f[0],f[1]],[f[0],f[3]],l)*(f[3]-f[1]);for(var m=0,r=f[0];r<=f[2];){for(var p=0,u=f[1];u<=f[3];){var x=null,v=null;0==m%2&&0==p%2?(x=g([[[r,u],[r,u+h],[r+k,u],[r,u]]],l.properties),v=g([[[r,u+h],[r+k,u+h],[r+k,u],[r,u+h]]],l.properties)):0==m%2&&1==p%2?(x=g([[[r,u],[r+k,u+h],[r+k,u],[r,u]]],l.properties),v=g([[[r,
u],[r,u+h],[r+k,u+h],[r,u]]],l.properties)):0==p%2&&1==m%2?(x=g([[[r,u],[r,u+h],[r+k,u+h],[r,u]]],l.properties),v=g([[[r,u],[r+k,u+h],[r+k,u],[r,u]]],l.properties)):1==p%2&&1==m%2&&(x=g([[[r,u],[r,u+h],[r+k,u],[r,u]]],l.properties),v=g([[[r,u+h],[r+k,u+h],[r+k,u],[r,u+h]]],l.properties));l.mask?(Kg(l.mask,x)&&q.push(x),Kg(l.mask,v)&&q.push(v)):(q.push(x),q.push(v));u+=h;p++}m++;r+=k}return z(q)}var lh={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:2.0902260511392E7,inches:39.37*
6371008.8,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:6371008.8/1852,radians:1,yards:6967335.223679999},Hm={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1E3,millimetres:1E3,nauticalmiles:1/1852,radians:1/6371008.8,yards:1.0936133},mh={acres:2.47105E-4,centimeters:1E4,centimetres:1E4,
feet:10.763910417,hectares:1E-4,inches:1550.003100006,kilometers:1E-6,kilometres:1E-6,meters:1,metres:1,miles:3.86E-7,millimeters:1E6,millimetres:1E6,yards:1.195990046},So=Object.freeze({__proto__:null,earthRadius:6371008.8,factors:lh,unitsFactors:Hm,areaFactors:mh,feature:b,geometry:c,point:d,points:e,polygon:g,polygons:n,lineString:t,lineStrings:w,featureCollection:z,multiLineString:C,multiPoint:H,multiPolygon:M,geometryCollection:L,round:O,radiansToLength:S,lengthToRadians:T,lengthToDegrees:P,
bearingToAzimuth:W,radiansToDegrees:Z,degreesToRadians:ca,convertLength:ba,convertArea:la,isNumber:ea,isObject:oa,validateBBox:sa,validateId:xa}),To=Object.freeze({__proto__:null,coordAll:Nb,coordEach:ya,coordReduce:Ya,featureEach:Ia,featureReduce:Ma,findPoint:Ca,findSegment:qa,flattenEach:eb,flattenReduce:Vc,geomEach:Qb,geomReduce:dd,lineEach:V,lineReduce:ja,propEach:Ja,propReduce:ac,segmentEach:Q,segmentReduce:R});Aa.default=Aa;var Uo=Object.freeze({__proto__:null,getCoord:ia,getCoords:fa,containsNumber:za,
geojsonType:Ra,featureOf:Sb,collectionOf:Na,getGeom:Lb,getType:sc}),Im=Object.getOwnPropertySymbols,Vo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,rj=function(){try{if(!Object.assign)return!1;var f=new String("abc");if(f[5]="de","5"===Object.getOwnPropertyNames(f)[0])return!1;var h={};for(f=0;10>f;f++)h["_"+String.fromCharCode(f)]=f;if("0123456789"!==Object.getOwnPropertyNames(h).map(function(q){return h[q]}).join(""))return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(q){l[q]=
q}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},l)).join("")}catch(q){return!1}}()?Object.assign:function(f,h){var l;if(null==f)throw new TypeError("Object.assign cannot be called with null or undefined");var q=Object(f);for(var k=1;k<arguments.length;k++){for(var m in l=Object(arguments[k]))Vo.call(l,m)&&(q[m]=l[m]);if(Im){var r=Im(l);for(var p=0;p<r.length;p++)Wo.call(l,r[p])&&(q[r[p]]=l[r[p]])}}return q},Rj={successCallback:null,verbose:!1},nh={},Vj=bc;Vj.default=bc;var Wc=mg;mg.prototype=
{all:function(){return this._all(this.data,[])},search:function(f){var h=this.data,l=[],q=this.toBBox;if(!qh(f,h))return l;for(var k,m,r,p,u=[];h;){k=0;for(m=h.children.length;k<m;k++)r=h.children[k],qh(f,p=h.leaf?q(r):r)&&(h.leaf?l.push(r):pi(f,p)?this._all(r,l):u.push(r));h=u.pop()}return l},collides:function(f){var h=this.data,l=this.toBBox;if(!qh(f,h))return!1;for(var q,k,m,r,p=[];h;){q=0;for(k=h.children.length;q<k;q++)if(m=h.children[q],qh(f,r=h.leaf?l(m):m)){if(h.leaf||pi(f,r))return!0;p.push(m)}h=
p.pop()}return!1},load:function(f){if(!f||!f.length)return this;if(f.length<this._minEntries){for(var h=0,l=f.length;h<l;h++)this.insert(f[h]);return this}f=this._build(f.slice(),0,f.length-1,0);this.data.children.length?this.data.height===f.height?this._splitRoot(this.data,f):(this.data.height<f.height&&(h=this.data,this.data=f,f=h),this._insert(f,this.data.height-f.height-1,!0)):this.data=f;return this},insert:function(f){return f&&this._insert(f,this.data.height-1),this},clear:function(){return this.data=
Cf([]),this},remove:function(f,h){if(!f)return this;for(var l,q,k,m,r=this.data,p=this.toBBox(f),u=[],x=[];r||u.length;){r||(r=u.pop(),q=u[u.length-1],l=x.pop(),m=!0);var v;if(v=r.leaf){a:{k=f;v=r.children;var y=h;if(y){for(var B=0;B<v.length;B++)if(y(k,v[B])){k=B;break a}k=-1}else k=v.indexOf(k)}v=-1!==k}if(v)return r.children.splice(k,1),u.push(r),this._condense(u),this;m||r.leaf||!pi(r,p)?q?(l++,r=q.children[l],m=!1):r=null:(u.push(r),x.push(l),l=0,q=r,r=r.children[0])}return this},toBBox:function(f){return f},
compareMinX:Sj,compareMinY:Tj,toJSON:function(){return this.data},fromJSON:function(f){return this.data=f,this},_all:function(f,h){for(var l=[];f;)f.leaf?h.push.apply(h,f.children):l.push.apply(l,f.children),f=l.pop();return h},_build:function(f,h,l,q){var k,m=l-h+1,r=this._maxEntries;if(m<=r)return Bf(k=Cf(f.slice(h,l+1)),this.toBBox),k;q||(q=Math.ceil(Math.log(m)/Math.log(r)),r=Math.ceil(m/Math.pow(r,q-1)));(k=Cf([])).leaf=!1;k.height=q;var p,u;m=Math.ceil(m/r);r=m*Math.ceil(Math.sqrt(r));for(Uj(f,
h,l,r,this.compareMinX);h<=l;h+=r)for(Uj(f,h,u=Math.min(h+r-1,l),m,this.compareMinY),p=h;p<=u;p+=m){var x=Math.min(p+m-1,u);k.children.push(this._build(f,p,x,q-1))}return Bf(k,this.toBBox),k},_chooseSubtree:function(f,h,l,q){for(var k,m,r,p,u,x,v,y,B,G;q.push(h),!h.leaf&&q.length-1!==l;){v=y=1/0;k=0;for(m=h.children.length;k<m;k++)u=oi(r=h.children[k]),B=f,G=r,(x=(Math.max(G.maxX,B.maxX)-Math.min(G.minX,B.minX))*(Math.max(G.maxY,B.maxY)-Math.min(G.minY,B.minY))-u)<y?(y=x,v=u<v?u:v,p=r):x===y&&u<v&&
(v=u,p=r);h=p||h.children[0]}return h},_insert:function(f,h,l){var q=this.toBBox;l=l?f:q(f);q=[];var k=this._chooseSubtree(l,this.data,h,q);k.children.push(f);for(og(k,l);0<=h&&q[h].children.length>this._maxEntries;)this._split(q,h),h--;this._adjustParentBBoxes(l,q,h)},_split:function(f,h){var l=f[h],q=l.children.length,k=this._minEntries;this._chooseSplitAxis(l,k,q);q=this._chooseSplitIndex(l,k,q);q=Cf(l.children.splice(q,l.children.length-q));q.height=l.height;q.leaf=l.leaf;Bf(l,this.toBBox);Bf(q,
this.toBBox);h?f[h-1].children.push(q):this._splitRoot(l,q)},_splitRoot:function(f,h){this.data=Cf([f,h]);this.data.height=f.height+1;this.data.leaf=!1;Bf(this.data,this.toBBox)},_chooseSplitIndex:function(f,h,l){var q,k,m;var r=k=1/0;for(q=h;q<=l-h;q++){var p=ng(f,0,q,this.toBBox);var u=ng(f,q,l,this.toBBox);var x=p;var v=u;var y=Math.max(x.minX,v.minX);var B=Math.max(x.minY,v.minY);var G=Math.min(x.maxX,v.maxX);x=Math.min(x.maxY,v.maxY);y=Math.max(0,G-y)*Math.max(0,x-B);p=oi(p)+oi(u);y<r?(r=y,m=
q,k=p<k?p:k):y===r&&p<k&&(k=p,m=q)}return m},_chooseSplitAxis:function(f,h,l){var q=f.leaf?this.compareMinX:Sj,k=f.leaf?this.compareMinY:Tj;this._allDistMargin(f,h,l,q)<this._allDistMargin(f,h,l,k)&&f.children.sort(q)},_allDistMargin:function(f,h,l,q){f.children.sort(q);var k=this.toBBox,m=ng(f,0,h,k),r=ng(f,l-h,l,k),p=ph(m)+ph(r);for(q=h;q<l-h;q++){var u=f.children[q];og(m,f.leaf?k(u):u);p+=ph(m)}for(q=l-h-1;q>=h;q--)u=f.children[q],og(r,f.leaf?k(u):u),p+=ph(r);return p},_adjustParentBBoxes:function(f,
h,l){for(;0<=l;l--)og(h[l],f)},_condense:function(f){for(var h,l=f.length-1;0<=l;l--)0===f[l].children.length?0<l?(h=f[l-1].children).splice(h.indexOf(f[l]),1):this.clear():Bf(f[l],this.toBBox)},_initFormat:function(f){var h=["return a"," - b",";"];this.compareMinX=new Function("a","b",h.join(f[0]));this.compareMinY=new Function("a","b",h.join(f[1]));this.toBBox=new Function("a","return {minX: a"+f[0]+", minY: a"+f[1]+", maxX: a"+f[2]+", maxY: a"+f[3]+"};")}};Wc.default=mg;var Uh=function(f,h,l){var q=
f*h,k=Jm*f;k-=k-f;f-=k;var m=Jm*h;m-=m-h;h-=m;h=f*h-(q-k*m-f*m-k*h);return l?(l[0]=h,l[1]=q,l):[h,q]},Jm=+(Math.pow(2,27)+1),Xo=function(f,h){var l=0|f.length,q=0|h.length;if(1===l&&1===q)return f=f[0],l=h[0],h=f+l,q=h-f,h=(f=f-(h-q)+(l-q))?[f,h]:[h],h;var k,m,r=Array(l+q),p=0,u=0,x=0,v=Math.abs,y=f[u],B=v(y),G=h[x],A=v(G);B<A?(m=y,(u+=1)<l&&(y=f[u],B=v(y))):(m=G,(x+=1)<q&&(G=h[x],A=v(G)));u<l&&B<A||x>=q?(k=y,(u+=1)<l&&(y=f[u],B=v(y))):(k=G,(x+=1)<q&&(G=h[x],A=v(G)));for(var F,J,D=k+m,E,I=m-(D-k),
K=D;u<l&&x<q;)B<A?(k=y,(u+=1)<l&&(y=f[u],B=v(y))):(k=G,(x+=1)<q&&(G=h[x],A=v(G))),(E=(m=I)-((D=k+m)-k))&&(r[p++]=E),I=K-((F=K+D)-(J=F-K))+(D-J),K=F;for(;u<l;)(E=(m=I)-((D=(k=y)+m)-k))&&(r[p++]=E),I=K-((F=K+D)-(J=F-K))+(D-J),K=F,(u+=1)<l&&(y=f[u]);for(;x<q;)(E=(m=I)-((D=(k=G)+m)-k))&&(r[p++]=E),I=K-((F=K+D)-(J=F-K))+(D-J),K=F,(x+=1)<q&&(G=h[x]);I&&(r[p++]=I);K&&(r[p++]=K);p||(r[p++]=0);return r.length=p,r},Yo=function(f,h){var l=f.length;if(1===l)return f=Uh(f[0],h),f[0]?f:[f[1]];var q=Array(2*l),
k=[.1,.1],m=[.1,.1],r=0;Uh(f[0],h,k);k[0]&&(q[r++]=k[0]);for(var p=1;p<l;++p){Uh(f[p],h,m);var u=k[1];var x=m[0],v=k,y=u+x,B=y-u;x-=B;u-=y-B;v&&(v[0]=u+x,v[1]=y);k[0]&&(q[r++]=k[0]);y=m[1];u=k[1];v=y+u;y=u-(v-y);k[1]=v;y&&(q[r++]=y)}k[1]&&(q[r++]=k[1]);0===r&&(q[r++]=0);return q.length=r,q},Zo=function(f,h){var l=0|f.length,q=0|h.length;if(1===l&&1===q)return f=f[0],l=-h[0],h=f+l,q=h-f,h=(f=f-(h-q)+(l-q))?[f,h]:[h],h;var k,m,r=Array(l+q),p=0,u=0,x=0,v=Math.abs,y=f[u],B=v(y),G=-h[x],A=v(G);B<A?(m=
y,(u+=1)<l&&(y=f[u],B=v(y))):(m=G,(x+=1)<q&&(G=-h[x],A=v(G)));u<l&&B<A||x>=q?(k=y,(u+=1)<l&&(y=f[u],B=v(y))):(k=G,(x+=1)<q&&(G=-h[x],A=v(G)));for(var F,J,D=k+m,E,I=m-(D-k),K=D;u<l&&x<q;)B<A?(k=y,(u+=1)<l&&(y=f[u],B=v(y))):(k=G,(x+=1)<q&&(G=-h[x],A=v(G))),(E=(m=I)-((D=k+m)-k))&&(r[p++]=E),I=K-((F=K+D)-(J=F-K))+(D-J),K=F;for(;u<l;)(E=(m=I)-((D=(k=y)+m)-k))&&(r[p++]=E),I=K-((F=K+D)-(J=F-K))+(D-J),K=F,(u+=1)<l&&(y=f[u]);for(;x<q;)(E=(m=I)-((D=(k=G)+m)-k))&&(r[p++]=E),I=K-((F=K+D)-(J=F-K))+(D-J),K=F,(x+=
1)<q&&(G=-h[x]);I&&(r[p++]=I);K&&(r[p++]=K);p||(r[p++]=0);return r.length=p,r},Km=je(function(f){function h(x,v){for(var y=Array(x.length-1),B=1;B<x.length;++B)for(var G=y[B-1]=Array(x.length-1),A=0,F=0;A<x.length;++A)A!==v&&(G[F++]=x[B][A]);return y}function l(x){if(1===x.length)return x[0];if(2===x.length)return["sum(",x[0],",",x[1],")"].join("");var v=x.length>>1;return["sum(",l(x.slice(0,v)),",",l(x.slice(v)),")"].join("")}function q(x){if(2===x.length)return[["sum(prod(",x[0][0],",",x[1][1],
"),prod(-",x[0][1],",",x[1][0],"))"].join("")];for(var v=[],y=0;y<x.length;++y)v.push(["scale(",l(q(h(x,y))),",",(B=y,1&B?"-":""),x[0][y],")"].join(""));return v;var B}function k(x){for(var v=[],y=[],B=Array(x),G=0;G<x;++G){B[G]=Array(x);for(var A=0;A<x;++A)B[G][A]=["m",A,"[",x-G-1,"]"].join("")}G=[];for(A=0;A<x;++A)0==(1&A)?v.push.apply(v,q(h(B,A))):y.push.apply(y,q(h(B,A))),G.push("m"+A);v=l(v);y=l(y);x="orientation"+x+"Exact";x=["function ",x,"(",G.join(),"){var p=",v,",n=",y,",d=sub(p,n);return d[d.length-1];};return ",
x].join("");return(new Function("sum","prod","scale","sub",x))(Xo,Uh,Yo,Zo)}function m(x){var v=u[x.length];return v||=u[x.length]=k(x.length),v.apply(void 0,x)}var r=k(3),p=k(4),u=[function(){return 0},function(){return 0},function(x,v){return v[0]-x[0]},function(x,v,y){var B=(x[1]-y[1])*(v[0]-y[0]);var G=(x[0]-y[0])*(v[1]-y[1]),A=B-G;if(0<B){if(0>=G)return A;B+=G}else{if(!(0>B)||0<=G)return A;B=-(B+G)}B*=3.3306690738754716E-16;return A>=B||A<=-B?A:r(x,v,y)},function(x,v,y,B){var G=x[0]-B[0],A=v[0]-
B[0],F=y[0]-B[0],J=x[1]-B[1],D=v[1]-B[1],E=y[1]-B[1],I=x[2]-B[2],K=v[2]-B[2],N=y[2]-B[2],U=A*E,X=F*D;F*=J;E*=G;G*=D;J*=A;A=I*(U-X)+K*(F-E)+N*(G-J);I=7.771561172376103E-16*((Math.abs(U)+Math.abs(X))*Math.abs(I)+(Math.abs(F)+Math.abs(E))*Math.abs(K)+(Math.abs(G)+Math.abs(J))*Math.abs(N));return A>I||-A>I?A:p(x,v,y,B)}];!function(){for(;5>=u.length;)u.push(k(u.length));for(var x=[],v=["slow"],y=0;5>=y;++y)x.push("a"+y),v.push("o"+y);var B=["function getOrientation(",x.join(),"){switch(arguments.length){case 0:case 1:return 0;"];
for(y=2;5>=y;++y)B.push("case ",y,":return o",y,"(",x.slice(0,y).join(),");");B.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");v.push(B.join(""));x=Function.apply(void 0,v);f.exports=x.apply(void 0,[m].concat(u));for(y=0;5>=y;++y)f.exports[y]=u[y]}()}),En=function(f){var h=f.length;if(3>h){for(var l=Array(h),q=0;q<h;++q)l[q]=q;return 2===h&&f[0][0]===f[1][0]&&f[0][1]===f[1][1]?[0]:l}l=Array(h);for(q=0;q<h;++q)l[q]=
q;l.sort(function(x,v){return f[x][0]-f[v][0]||f[x][1]-f[v][1]});var k=[l[0],l[1]],m=[l[0],l[1]];for(q=2;q<h;++q){for(var r=l[q],p=f[r],u=k.length;1<u&&0>=Lm(f[k[u-2]],f[k[u-1]],p);)--u,k.pop();k.push(r);for(u=m.length;1<u&&0<=Lm(f[m[u-2]],f[m[u-1]],p);)--u,m.pop();m.push(r)}l=Array(m.length+k.length-2);h=0;for(r=(q=0,k.length);q<r;++q)l[h++]=k[q];for(q=m.length-2;0<q;--q)l[h++]=m[q];return l},Lm=Km[3],Yj=pg;pg.prototype={push:function(f){this.data.push(f);this.length++;this._up(this.length-1)},pop:function(){if(0!==
this.length){var f=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),f}},peek:function(){return this.data[0]},_up:function(f){for(var h=this.data,l=this.compare,q=h[f];0<f;){var k=f-1>>1,m=h[k];if(0<=l(q,m))break;h[f]=m;f=k}h[f]=q},_down:function(f){for(var h=this.data,l=this.compare,q=this.length>>1,k=h[f];f<q;){var m=1+(f<<1),r=m+1,p=h[m];if(r<this.length&&0>l(h[r],p)&&(m=r,p=h[r]),0<=l(p,k))break;h[f]=p;f=m}h[f]=k}};Yj.default=
pg;var sh=Km[3],ck=Wj;ck.default=Wj;var fk=function(f,h,l){this.a=f;this.b=h;this.c=l;var q=h.x-f.x;var k=h.y-f.y,m=l.x-f.x,r=l.y-f.y,p=q*(f.x+h.x)+k*(f.y+h.y),u=m*(f.x+l.x)+r*(f.y+l.y);h=2*(q*(l.y-h.y)-k*(l.x-h.x));this.x=(r*p-k*u)/h;this.y=(q*u-m*p)/h;q=this.x-f.x;f=this.y-f.y;this.r=q*q+f*f},vh=Object.prototype.hasOwnProperty,Mm=new ArrayBuffer(16),kk=new Float64Array(Mm),uh=new Uint32Array(Mm),Un=function(){function f(h){this.points=h.points||[];this.duration=h.duration||1E4;this.sharpness=h.sharpness||
.85;this.centers=[];this.controls=[];this.stepLength=h.stepLength||60;this.length=this.points.length;for(h=this.delay=0;h<this.length;h++)this.points[h].z=this.points[h].z||0;for(h=0;h<this.length-1;h++){var l=this.points[h],q=this.points[h+1];this.centers.push({x:(l.x+q.x)/2,y:(l.y+q.y)/2,z:(l.z+q.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(h=0;h<this.centers.length-1;h++){l=this.points[h+1].x-(this.centers[h].x+this.centers[h+1].x)/2;q=this.points[h+1].y-(this.centers[h].y+this.centers[h+
1].y)/2;var k=this.points[h+1].z-(this.centers[h].y+this.centers[h+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[h+1].x+this.sharpness*(this.centers[h].x+l),y:(1-this.sharpness)*this.points[h+1].y+this.sharpness*(this.centers[h].y+q),z:(1-this.sharpness)*this.points[h+1].z+this.sharpness*(this.centers[h].z+k)},{x:(1-this.sharpness)*this.points[h+1].x+this.sharpness*(this.centers[h+1].x+l),y:(1-this.sharpness)*this.points[h+1].y+this.sharpness*(this.centers[h+1].y+q),z:(1-this.sharpness)*
this.points[h+1].z+this.sharpness*(this.centers[h+1].z+k)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return f.prototype.cacheSteps=function(h){var l=[],q=this.pos(0);l.push(0);for(var k=0;k<this.duration;k+=10){var m=this.pos(k);Math.sqrt((m.x-q.x)*(m.x-q.x)+(m.y-q.y)*(m.y-q.y)+(m.z-q.z)*(m.z-q.z))>h&&(l.push(k),q=m)}return l},f.prototype.vector=function(h){var l=this.pos(h+10);h=this.pos(h-10);return{angle:180*
Math.atan2(l.y-h.y,l.x-h.x)/3.14,speed:Math.sqrt((h.x-l.x)*(h.x-l.x)+(h.y-l.y)*(h.y-l.y)+(h.z-l.z)*(h.z-l.z))}},f.prototype.pos=function(h){h-=this.delay;0>h&&(h=0);h>this.duration&&(h=this.duration-1);h/=this.duration;if(1<=h)return this.points[this.length-1];var l=Math.floor((this.points.length-1)*h),q=(this.length-1)*h-l;h=this.points[l];var k=this.controls[l][1],m=this.controls[l+1][0];l=this.points[l+1];var r=q*q;q=[r*q,3*r*(1-q),3*q*(1-q)*(1-q),(1-q)*(1-q)*(1-q)];return{x:l.x*q[0]+m.x*q[1]+
k.x*q[2]+h.x*q[3],y:l.y*q[0]+m.y*q[1]+k.y*q[2]+h.y*q[3],z:l.z*q[0]+m.z*q[1]+k.z*q[2]+h.z*q[3]}},f}(),yk=yh;yh.deviation=function(f,h,l,q){var k=h&&h.length,m=Math.abs(Ei(f,0,k?h[0]*l:f.length,l));if(k){k=0;for(var r=h.length;k<r;k++)m-=Math.abs(Ei(f,h[k]*l,k<r-1?h[k+1]*l:f.length,l))}for(k=h=0;k<q.length;k+=3){r=q[k]*l;var p=q[k+1]*l,u=q[k+2]*l;h+=Math.abs((f[r]-f[u])*(f[p+1]-f[r+1])-(f[r]-f[p])*(f[u+1]-f[r+1]))}return 0===m&&0===h?0:Math.abs((h-m)/m)};yh.flatten=function(f){for(var h=f[0][0].length,
l={vertices:[],holes:[],dimensions:h},q=0,k=0;k<f.length;k++){for(var m=0;m<f[k].length;m++)for(var r=0;r<h;r++)l.vertices.push(f[k][m][r]);0<k&&(q+=f[k-1].length,l.holes.push(q))}return l};yk.default=yh;var Fc=je(function(f,h){function l(A,F,J){void 0===J&&(J={});var D={type:"Feature"};return(0===J.id||J.id)&&(D.id=J.id),J.bbox&&(D.bbox=J.bbox),D.properties=F||{},D.geometry=A,D}function q(A,F,J){if(void 0===J&&(J={}),!A)throw Error("coordinates is required");if(!Array.isArray(A))throw Error("coordinates must be an Array");
if(2>A.length)throw Error("coordinates must be at least 2 numbers long");if(!G(A[0])||!G(A[1]))throw Error("coordinates must contain numbers");return l({type:"Point",coordinates:A},F,J)}function k(A,F,J){void 0===J&&(J={});for(var D=0;D<A.length;D++){var E=A[D];if(4>E.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var I=0;I<E[E.length-1].length;I++)if(E[E.length-1][I]!==E[0][I])throw Error("First and last Position are not equivalent.");}return l({type:"Polygon",
coordinates:A},F,J)}function m(A,F,J){if(void 0===J&&(J={}),2>A.length)throw Error("coordinates must be an array of two or more positions");return l({type:"LineString",coordinates:A},F,J)}function r(A,F){void 0===F&&(F={});var J={type:"FeatureCollection"};return F.id&&(J.id=F.id),F.bbox&&(J.bbox=F.bbox),J.features=A,J}function p(A,F,J){return void 0===J&&(J={}),l({type:"MultiLineString",coordinates:A},F,J)}function u(A,F,J){return void 0===J&&(J={}),l({type:"MultiPoint",coordinates:A},F,J)}function x(A,
F,J){return void 0===J&&(J={}),l({type:"MultiPolygon",coordinates:A},F,J)}function v(A,F){void 0===F&&(F="kilometers");var J=h.factors[F];if(!J)throw Error(F+" units is invalid");return A*J}function y(A,F){void 0===F&&(F="kilometers");var J=h.factors[F];if(!J)throw Error(F+" units is invalid");return A/J}function B(A){return A%(2*Math.PI)*180/Math.PI}function G(A){return!isNaN(A)&&null!==A&&!Array.isArray(A)}Object.defineProperty(h,"__esModule",{value:!0});h.earthRadius=6371008.8;h.factors={centimeters:100*
h.earthRadius,centimetres:100*h.earthRadius,degrees:h.earthRadius/111325,feet:3.28084*h.earthRadius,inches:39.37*h.earthRadius,kilometers:h.earthRadius/1E3,kilometres:h.earthRadius/1E3,meters:h.earthRadius,metres:h.earthRadius,miles:h.earthRadius/1609.344,millimeters:1E3*h.earthRadius,millimetres:1E3*h.earthRadius,nauticalmiles:h.earthRadius/1852,radians:1,yards:1.0936*h.earthRadius};h.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,
meters:1,metres:1,miles:1/1609.344,millimeters:1E3,millimetres:1E3,nauticalmiles:1/1852,radians:1/h.earthRadius,yards:1.0936133};h.areaFactors={acres:2.47105E-4,centimeters:1E4,centimetres:1E4,feet:10.763910417,hectares:1E-4,inches:1550.003100006,kilometers:1E-6,kilometres:1E-6,meters:1,metres:1,miles:3.86E-7,millimeters:1E6,millimetres:1E6,yards:1.195990046};h.feature=l;h.geometry=function(A,F,J){switch(A){case "Point":return q(F).geometry;case "LineString":return m(F).geometry;case "Polygon":return k(F).geometry;
case "MultiPoint":return u(F).geometry;case "MultiLineString":return p(F).geometry;case "MultiPolygon":return x(F).geometry;default:throw Error(A+" is invalid");}};h.point=q;h.points=function(A,F,J){return void 0===J&&(J={}),r(A.map(function(D){return q(D,F)}),J)};h.polygon=k;h.polygons=function(A,F,J){return void 0===J&&(J={}),r(A.map(function(D){return k(D,F)}),J)};h.lineString=m;h.lineStrings=function(A,F,J){return void 0===J&&(J={}),r(A.map(function(D){return m(D,F)}),J)};h.featureCollection=
r;h.multiLineString=p;h.multiPoint=u;h.multiPolygon=x;h.geometryCollection=function(A,F,J){return void 0===J&&(J={}),l({type:"GeometryCollection",geometries:A},F,J)};h.round=function(A,F){if(void 0===F&&(F=0),F&&!(0<=F))throw Error("precision must be a positive number");F=Math.pow(10,F||0);return Math.round(A*F)/F};h.radiansToLength=v;h.lengthToRadians=y;h.lengthToDegrees=function(A,F){return B(y(A,F))};h.bearingToAzimuth=function(A){A%=360;return 0>A&&(A+=360),A};h.radiansToDegrees=B;h.degreesToRadians=
function(A){return A%360*Math.PI/180};h.convertLength=function(A,F,J){if(void 0===F&&(F="kilometers"),void 0===J&&(J="kilometers"),!(0<=A))throw Error("length must be a positive number");return v(y(A,F),J)};h.convertArea=function(A,F,J){if(void 0===F&&(F="meters"),void 0===J&&(J="kilometers"),!(0<=A))throw Error("area must be a positive number");F=h.areaFactors[F];if(!F)throw Error("invalid original units");J=h.areaFactors[J];if(!J)throw Error("invalid final units");return A/F*J};h.isNumber=G;h.isObject=
function(A){return!!A&&A.constructor===Object};h.validateBBox=function(A){if(!A)throw Error("bbox is required");if(!Array.isArray(A))throw Error("bbox must be an Array");if(4!==A.length&&6!==A.length)throw Error("bbox must be an Array of 4 or 6 numbers");A.forEach(function(F){if(!G(F))throw Error("bbox must only contain numbers");})};h.validateId=function(A){if(!A)throw Error("id is required");if(-1===["string","number"].indexOf(typeof A))throw Error("id must be a number or a string");}}),Ji=Object.defineProperty({coordAll:function(f){var h=
[];return ug(f,function(l){h.push(l)}),h},coordEach:ug,coordReduce:function(f,h,l,q){var k=l;return ug(f,function(m,r,p,u,x){k=0===r&&void 0===l?m:h(k,m,r,p,u,x)},q),k},featureEach:Ak,featureReduce:function(f,h,l){var q=l;return Ak(f,function(k,m){q=0===m&&void 0===l?k:h(q,k,m)}),q},findPoint:function(f,h){if(h=h||{},!Fc.isObject(h))throw Error("options is invalid");var l=h.featureIndex||0,q=h.multiFeatureIndex||0,k=h.geometryIndex||0,m=h.coordIndex||0,r=h.properties;switch(f.type){case "FeatureCollection":0>
l&&(l=f.features.length+l);r=r||f.features[l].properties;f=f.features[l].geometry;break;case "Feature":r=r||f.properties;f=f.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;default:throw Error("geojson is invalid");}if(null===f)return null;l=f.coordinates;switch(f.type){case "Point":return Fc.point(l,r,h);case "MultiPoint":return 0>q&&(q=l.length+q),Fc.point(l[q],r,h);case "LineString":return 0>m&&(m=l.length+
m),Fc.point(l[m],r,h);case "Polygon":return 0>k&&(k=l.length+k),0>m&&(m=l[k].length+m),Fc.point(l[k][m],r,h);case "MultiLineString":return 0>q&&(q=l.length+q),0>m&&(m=l[q].length+m),Fc.point(l[q][m],r,h);case "MultiPolygon":return 0>q&&(q=l.length+q),0>k&&(k=l[q].length+k),0>m&&(m=l[q][k].length-m),Fc.point(l[q][k][m],r,h)}throw Error("geojson is invalid");},findSegment:function(f,h){if(h=h||{},!Fc.isObject(h))throw Error("options is invalid");var l=h.featureIndex||0,q=h.multiFeatureIndex||0,k=h.geometryIndex||
0,m=h.segmentIndex||0,r=h.properties;switch(f.type){case "FeatureCollection":0>l&&(l=f.features.length+l);r=r||f.features[l].properties;f=f.features[l].geometry;break;case "Feature":r=r||f.properties;f=f.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;default:throw Error("geojson is invalid");}if(null===f)return null;l=f.coordinates;switch(f.type){case "Point":case "MultiPoint":return null;case "LineString":return 0>
m&&(m=l.length+m-1),Fc.lineString([l[m],l[m+1]],r,h);case "Polygon":return 0>k&&(k=l.length+k),0>m&&(m=l[k].length+m-1),Fc.lineString([l[k][m],l[k][m+1]],r,h);case "MultiLineString":return 0>q&&(q=l.length+q),0>m&&(m=l[q].length+m-1),Fc.lineString([l[q][m],l[q][m+1]],r,h);case "MultiPolygon":return 0>q&&(q=l.length+q),0>k&&(k=l[q].length+k),0>m&&(m=l[q][k].length-m-1),Fc.lineString([l[q][k][m],l[q][k][m+1]],r,h)}throw Error("geojson is invalid");},flattenEach:Ah,flattenReduce:function(f,h,l){var q=
l;return Ah(f,function(k,m,r){q=0===m&&0===r&&void 0===l?k:h(q,k,m,r)}),q},geomEach:Hi,geomReduce:function(f,h,l){var q=l;return Hi(f,function(k,m,r,p,u){q=0===m&&void 0===l?k:h(q,k,m,r,p,u)}),q},lineEach:Ck,lineReduce:function(f,h,l){var q=l;return Ck(f,function(k,m,r,p){q=0===m&&void 0===l?k:h(q,k,m,r,p)}),q},propEach:zk,propReduce:function(f,h,l){var q=l;return zk(f,function(k,m){q=0===m&&void 0===l?k:h(q,k,m)}),q},segmentEach:Bk,segmentReduce:function(f,h,l){var q=l,k=!1;return Bk(f,function(m,
r,p,u,x){q=!1===k&&void 0===l?m:h(q,m,r,p,u,x);k=!0}),q}},"__esModule",{value:!0});Ii.default=Ii;var vg=Object.defineProperty({default:Ii},"__esModule",{value:!0}).default,Yn=Ji.featureEach,Ek=(Ji.coordEach,Fc.polygon,Fc.featureCollection),wg=Dk;wg.default=Dk;var Rk=function(f,h,l,q,k){this.coord=f;this.param=h;this.ringAndEdgeIn=l;this.ringAndEdgeOut=q;this.nxtIsectAlongEdgeIn=k},Sk=function(f,h,l,q,k,m,r){this.coord=f;this.ringAndEdge1=h;this.ringAndEdge2=l;this.nxtIsectAlongRingAndEdge1=q;this.nxtIsectAlongRingAndEdge2=
k;this.ringAndEdge1Walkable=m;this.ringAndEdge2Walkable=r},Nm=Math.PI/180,Om=180/Math.PI,Lg=function(f,h){this.lon=f;this.lat=h;this.x=Nm*f;this.y=Nm*h};Lg.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Lg.prototype.antipode=function(){return new Lg(0>this.lon?180+this.lon:-1*(180-this.lon),-1*this.lat)};var Pm=function(){this.coords=[];this.length=0};Pm.prototype.move_to=function(f){this.length++;this.coords.push(f)};var sj=function(f){this.properties=
f||{};this.geometries=[]};sj.prototype.json=function(){if(0>=this.geometries.length)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var f=[],h=0;h<this.geometries.length;h++)f.push(this.geometries[h].coords);return{geometry:{type:"MultiLineString",coordinates:f},type:"Feature",properties:this.properties}};
sj.prototype.wkt=function(){for(var f="",h="LINESTRING(",l=function(k){h+=k[0]+" "+k[1]+","},q=0;q<this.geometries.length;q++){if(0===this.geometries[q].coords.length)return"LINESTRING(empty)";this.geometries[q].coords.forEach(l);f+=h.substring(0,h.length-1)+")"}return f};var tj=function(f,h,l){if(!f||void 0===f.x||void 0===f.y)throw Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!h||void 0===h.x||void 0===h.y)throw Error("GreatCircle constructor expects two args: start and end objects with x and y properties");
this.start=new Lg(f.x,f.y);this.end=new Lg(h.x,h.y);this.properties=l||{};if(this.g=2*Math.asin(Math.sqrt(Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin((this.start.x-this.end.x)/2),2))),this.g===Math.PI)throw Error("it appears "+f.view()+" and "+h.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw Error("could not calculate great circle between "+f+" and "+
h);};tj.prototype.interpolate=function(f){var h=Math.sin((1-f)*this.g)/Math.sin(this.g);f=Math.sin(f*this.g)/Math.sin(this.g);var l=h*Math.cos(this.start.y)*Math.cos(this.start.x)+f*Math.cos(this.end.y)*Math.cos(this.end.x),q=h*Math.cos(this.start.y)*Math.sin(this.start.x)+f*Math.cos(this.end.y)*Math.sin(this.end.x);return[Om*Math.atan2(q,l),Om*Math.atan2(h*Math.sin(this.start.y)+f*Math.sin(this.end.y),Math.sqrt(Math.pow(l,2)+Math.pow(q,2)))]};tj.prototype.Arc=function(f,h){var l=[];if(!f||2>=f)l.push([this.start.lon,
this.start.lat]),l.push([this.end.lon,this.end.lat]);else for(var q=1/(f-1),k=0;k<f;++k){var m=this.interpolate(q*k);l.push(m)}m=!1;var r=0,p=h&&h.offset?h.offset:10;f=180-p;q=-180+p;k=360-p;for(h=1;h<l.length;++h){var u=l[h-1][0],x=l[h][0],v=Math.abs(x-u);v>k&&(x>f&&u<q||u>f&&x<q)?m=!0:v>r&&(r=v)}h=[];if(m&&r<p)for(m=[],h.push(m),r=0;r<l.length;++r)if(p=parseFloat(l[r][0]),0<r&&Math.abs(p-l[r-1][0])>k){v=parseFloat(l[r-1][0]);u=parseFloat(l[r-1][1]);var y=parseFloat(l[r][0]);x=parseFloat(l[r][1]);
if(-180<v&&v<q&&180===y&&r+1<l.length&&-180<l[r-1][0]&&l[r-1][0]<q)m.push([-180,l[r][1]]),r++,m.push([l[r][0],l[r][1]]);else if(v>f&&180>v&&-180===y&&r+1<l.length&&l[r-1][0]>f&&180>l[r-1][0])m.push([180,l[r][1]]),r++,m.push([l[r][0],l[r][1]]);else{if(v<q&&y>f){var B=v;v=y;y=B;B=u;u=x;x=B}(v>f&&y<q&&(y+=360),180>=v&&180<=y&&v<y)?(v=(180-v)/(y-v),u=v*x+(1-v)*u,m.push([l[r-1][0]>f?180:-180,u]),(m=[]).push([l[r-1][0]>f?-180:180,u])):m=[];h.push(m);m.push([p,l[r][1]])}}else m.push([l[r][0],l[r][1]]);else for(f=
[],h.push(f),q=0;q<l.length;++q)f.push([l[q][0],l[q][1]]);l=new sj(this.properties);for(f=0;f<h.length;++f)for(q=new Pm,l.geometries.push(q),k=h[f],m=0;m<k.length;++m)q.move_to(k[m]);return l};var Qm=je(function(f,h){function l(q){var k=[],m;for(m in q)k.push(m);return k}(f.exports="function"==typeof Object.keys?Object.keys:l).shim=l}),Rm=je(function(f,h){function l(k){return"[object Arguments]"==Object.prototype.toString.call(k)}function q(k){return k&&"object"==typeof k&&"number"==typeof k.length&&
Object.prototype.hasOwnProperty.call(k,"callee")&&!Object.prototype.propertyIsEnumerable.call(k,"callee")||!1}h="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(h=f.exports=h?l:q).supported=l;h.unsupported=q}),Gf=je(function(f){function h(k){return!(!k||"object"!=typeof k||"number"!=typeof k.length)&&"function"==typeof k.copy&&"function"==typeof k.slice&&!(0<k.length&&"number"!=typeof k[0])}var l=Array.prototype.slice,q=f.exports=function(k,m,r){return r||={},
k===m||(k instanceof Date&&m instanceof Date?k.getTime()===m.getTime():!k||!m||"object"!=typeof k&&"object"!=typeof m?r.strict?k===m:k==m:function(p,u,x){var v,y;if(null==p||null==u||p.prototype!==u.prototype)return!1;if(Rm(p))return!!Rm(u)&&(p=l.call(p),u=l.call(u),q(p,u,x));if(h(p)){if(!h(u)||p.length!==u.length)return!1;for(v=0;v<p.length;v++)if(p[v]!==u[v])return!1;return!0}try{var B=Qm(p),G=Qm(u)}catch(A){return!1}if(B.length!=G.length)return!1;B.sort();G.sort();for(v=B.length-1;0<=v;v--)if(B[v]!=
G[v])return!1;for(v=B.length-1;0<=v;v--)if(y=B[v],!q(p[y],u[y],x))return!1;return typeof p==typeof u}(k,m,r))}}),il={successCallback:null,verbose:!1,polygons:!1},mf={},Oc=64,Sd=16,ub=[],vb=[],wb=[],xb=[],yb=[],zb=[],lb=[],mb=[],nb=[],ib=[],jb=[],kb=[],Ab=[],Bb=[],Cb=[],Db=[],Eb=[],Fb=[],rb=[],sb=[],tb=[],ob=[],pb=[],qb=[];lb[85]=ib[85]=-1;mb[85]=jb[85]=0;nb[85]=kb[85]=1;rb[85]=ob[85]=1;sb[85]=pb[85]=0;tb[85]=qb[85]=1;ub[85]=xb[85]=0;vb[85]=yb[85]=-1;wb[85]=Cb[85]=0;Db[85]=Ab[85]=0;Eb[85]=Bb[85]=1;
zb[85]=Fb[85]=1;ob[1]=ob[169]=0;pb[1]=pb[169]=-1;qb[1]=qb[169]=0;Ab[1]=Ab[169]=-1;Bb[1]=Bb[169]=0;Cb[1]=Cb[169]=0;ib[4]=ib[166]=0;jb[4]=jb[166]=-1;kb[4]=kb[166]=1;Db[4]=Db[166]=1;Eb[4]=Eb[166]=0;Fb[4]=Fb[166]=0;lb[16]=lb[154]=0;mb[16]=mb[154]=1;nb[16]=nb[154]=1;xb[16]=xb[154]=1;yb[16]=yb[154]=0;zb[16]=zb[154]=1;rb[64]=rb[106]=0;sb[64]=sb[106]=1;tb[64]=tb[106]=0;ub[64]=ub[106]=-1;vb[64]=vb[106]=0;wb[64]=wb[106]=1;rb[2]=rb[168]=0;sb[2]=sb[168]=-1;tb[2]=tb[168]=1;ob[2]=ob[168]=0;pb[2]=pb[168]=-1;qb[2]=
qb[168]=0;Ab[2]=Ab[168]=-1;Bb[2]=Bb[168]=0;Cb[2]=Cb[168]=0;Db[2]=Db[168]=-1;Eb[2]=Eb[168]=0;Fb[2]=Fb[168]=1;lb[8]=lb[162]=0;mb[8]=mb[162]=-1;nb[8]=nb[162]=0;ib[8]=ib[162]=0;jb[8]=jb[162]=-1;kb[8]=kb[162]=1;Ab[8]=Ab[162]=1;Bb[8]=Bb[162]=0;Cb[8]=Cb[162]=1;Db[8]=Db[162]=1;Eb[8]=Eb[162]=0;Fb[8]=Fb[162]=0;lb[32]=lb[138]=0;mb[32]=mb[138]=1;nb[32]=nb[138]=1;ib[32]=ib[138]=0;jb[32]=jb[138]=1;kb[32]=kb[138]=0;ub[32]=ub[138]=1;vb[32]=vb[138]=0;wb[32]=wb[138]=0;xb[32]=xb[138]=1;yb[32]=yb[138]=0;zb[32]=zb[138]=
1;ob[128]=ob[42]=0;pb[128]=pb[42]=1;qb[128]=qb[42]=1;rb[128]=rb[42]=0;sb[128]=sb[42]=1;tb[128]=tb[42]=0;ub[128]=ub[42]=-1;vb[128]=vb[42]=0;wb[128]=wb[42]=1;xb[128]=xb[42]=-1;yb[128]=yb[42]=0;zb[128]=zb[42]=0;ib[5]=ib[165]=-1;jb[5]=jb[165]=0;kb[5]=kb[165]=0;ob[5]=ob[165]=1;pb[5]=pb[165]=0;qb[5]=qb[165]=0;Db[20]=Db[150]=0;Eb[20]=Eb[150]=1;Fb[20]=Fb[150]=1;xb[20]=xb[150]=0;yb[20]=yb[150]=-1;zb[20]=zb[150]=1;lb[80]=lb[90]=-1;mb[80]=mb[90]=0;nb[80]=nb[90]=1;rb[80]=rb[90]=1;sb[80]=sb[90]=0;tb[80]=tb[90]=
1;Ab[65]=Ab[105]=0;Bb[65]=Bb[105]=1;Cb[65]=Cb[105]=0;ub[65]=ub[105]=0;vb[65]=vb[105]=-1;wb[65]=wb[105]=0;lb[160]=lb[10]=-1;mb[160]=mb[10]=0;nb[160]=nb[10]=1;ib[160]=ib[10]=-1;jb[160]=jb[10]=0;kb[160]=kb[10]=0;ob[160]=ob[10]=1;pb[160]=pb[10]=0;qb[160]=qb[10]=0;rb[160]=rb[10]=1;sb[160]=sb[10]=0;tb[160]=tb[10]=1;Db[130]=Db[40]=0;Eb[130]=Eb[40]=1;Fb[130]=Fb[40]=1;Ab[130]=Ab[40]=0;Bb[130]=Bb[40]=1;Cb[130]=Cb[40]=0;ub[130]=ub[40]=0;vb[130]=vb[40]=-1;wb[130]=wb[40]=0;xb[130]=xb[40]=0;yb[130]=yb[40]=-1;zb[130]=
zb[40]=1;ib[37]=ib[133]=0;jb[37]=jb[133]=1;kb[37]=kb[133]=1;ob[37]=ob[133]=0;pb[37]=pb[133]=1;qb[37]=qb[133]=0;ub[37]=ub[133]=-1;vb[37]=vb[133]=0;wb[37]=wb[133]=0;xb[37]=xb[133]=1;yb[37]=yb[133]=0;zb[37]=zb[133]=0;Db[148]=Db[22]=-1;Eb[148]=Eb[22]=0;Fb[148]=Fb[22]=0;ob[148]=ob[22]=0;pb[148]=pb[22]=-1;qb[148]=qb[22]=1;rb[148]=rb[22]=0;sb[148]=sb[22]=1;tb[148]=tb[22]=1;xb[148]=xb[22]=-1;yb[148]=yb[22]=0;zb[148]=zb[22]=1;lb[82]=lb[88]=0;mb[82]=mb[88]=-1;nb[82]=nb[88]=1;Db[82]=Db[88]=1;Eb[82]=Eb[88]=0;
Fb[82]=Fb[88]=1;Ab[82]=Ab[88]=-1;Bb[82]=Bb[88]=0;Cb[82]=Cb[88]=1;rb[82]=rb[88]=0;sb[82]=sb[88]=-1;tb[82]=tb[88]=0;lb[73]=lb[97]=0;mb[73]=mb[97]=1;nb[73]=nb[97]=0;ib[73]=ib[97]=0;jb[73]=jb[97]=-1;kb[73]=kb[97]=0;Ab[73]=Ab[97]=1;Bb[73]=Bb[97]=0;Cb[73]=Cb[97]=0;ub[73]=ub[97]=1;vb[73]=vb[97]=0;wb[73]=wb[97]=1;lb[145]=lb[25]=0;mb[145]=mb[25]=-1;nb[145]=nb[25]=0;Ab[145]=Ab[25]=1;Bb[145]=Bb[25]=0;Cb[145]=Cb[25]=1;ob[145]=ob[25]=0;pb[145]=pb[25]=1;qb[145]=qb[25]=1;xb[145]=xb[25]=-1;yb[145]=yb[25]=0;zb[145]=
zb[25]=0;ib[70]=ib[100]=0;jb[70]=jb[100]=1;kb[70]=kb[100]=0;Db[70]=Db[100]=-1;Eb[70]=Eb[100]=0;Fb[70]=Fb[100]=1;rb[70]=rb[100]=0;sb[70]=sb[100]=-1;tb[70]=tb[100]=1;ub[70]=ub[100]=1;vb[70]=vb[100]=0;wb[70]=wb[100]=0;ib[101]=ib[69]=0;jb[101]=jb[69]=1;kb[101]=kb[69]=0;ub[101]=ub[69]=1;vb[101]=vb[69]=0;wb[101]=wb[69]=0;ob[149]=ob[21]=0;pb[149]=pb[21]=1;qb[149]=qb[21]=1;xb[149]=xb[21]=-1;yb[149]=yb[21]=0;zb[149]=zb[21]=0;Db[86]=Db[84]=-1;Eb[86]=Eb[84]=0;Fb[86]=Fb[84]=1;rb[86]=rb[84]=0;sb[86]=sb[84]=-1;
tb[86]=tb[84]=1;lb[89]=lb[81]=0;mb[89]=mb[81]=-1;nb[89]=nb[81]=0;Ab[89]=Ab[81]=1;Bb[89]=Bb[81]=0;Cb[89]=Cb[81]=1;lb[96]=lb[74]=0;mb[96]=mb[74]=1;nb[96]=nb[74]=0;ib[96]=ib[74]=-1;jb[96]=jb[74]=0;kb[96]=kb[74]=1;rb[96]=rb[74]=1;sb[96]=sb[74]=0;tb[96]=tb[74]=0;ub[96]=ub[74]=1;vb[96]=vb[74]=0;wb[96]=wb[74]=1;lb[24]=lb[146]=0;mb[24]=mb[146]=-1;nb[24]=nb[146]=1;Db[24]=Db[146]=1;Eb[24]=Eb[146]=0;Fb[24]=Fb[146]=1;Ab[24]=Ab[146]=0;Bb[24]=Bb[146]=1;Cb[24]=Cb[146]=1;xb[24]=xb[146]=0;yb[24]=yb[146]=-1;zb[24]=
zb[146]=0;ib[6]=ib[164]=-1;jb[6]=jb[164]=0;kb[6]=kb[164]=1;Db[6]=Db[164]=-1;Eb[6]=Eb[164]=0;Fb[6]=Fb[164]=0;ob[6]=ob[164]=0;pb[6]=pb[164]=-1;qb[6]=qb[164]=1;rb[6]=rb[164]=1;sb[6]=sb[164]=0;tb[6]=tb[164]=0;Ab[129]=Ab[41]=0;Bb[129]=Bb[41]=1;Cb[129]=Cb[41]=1;ob[129]=ob[41]=0;pb[129]=pb[41]=1;qb[129]=qb[41]=0;ub[129]=ub[41]=-1;vb[129]=vb[41]=0;wb[129]=wb[41]=0;xb[129]=xb[41]=0;yb[129]=yb[41]=-1;zb[129]=zb[41]=0;Db[66]=Db[104]=0;Eb[66]=Eb[104]=1;Fb[66]=Fb[104]=0;Ab[66]=Ab[104]=-1;Bb[66]=Bb[104]=0;Cb[66]=
Cb[104]=1;rb[66]=rb[104]=0;sb[66]=sb[104]=-1;tb[66]=tb[104]=0;ub[66]=ub[104]=0;vb[66]=vb[104]=-1;wb[66]=wb[104]=1;lb[144]=lb[26]=-1;mb[144]=mb[26]=0;nb[144]=nb[26]=0;ob[144]=ob[26]=1;pb[144]=pb[26]=0;qb[144]=qb[26]=1;rb[144]=rb[26]=0;sb[144]=sb[26]=1;tb[144]=tb[26]=1;xb[144]=xb[26]=-1;yb[144]=yb[26]=0;zb[144]=zb[26]=1;ib[36]=ib[134]=0;jb[36]=jb[134]=1;kb[36]=kb[134]=1;Db[36]=Db[134]=0;Eb[36]=Eb[134]=1;Fb[36]=Fb[134]=0;ub[36]=ub[134]=0;vb[36]=vb[134]=-1;wb[36]=wb[134]=1;xb[36]=xb[134]=1;yb[36]=yb[134]=
0;zb[36]=zb[134]=0;lb[9]=lb[161]=-1;mb[9]=mb[161]=0;nb[9]=nb[161]=0;ib[9]=ib[161]=0;jb[9]=jb[161]=-1;kb[9]=kb[161]=0;Ab[9]=Ab[161]=1;Bb[9]=Bb[161]=0;Cb[9]=Cb[161]=0;ob[9]=ob[161]=1;pb[9]=pb[161]=0;qb[9]=qb[161]=1;lb[136]=0;mb[136]=1;nb[136]=1;ib[136]=0;jb[136]=1;kb[136]=0;Db[136]=-1;Eb[136]=0;Fb[136]=1;Ab[136]=-1;Bb[136]=0;Cb[136]=0;ob[136]=0;pb[136]=-1;qb[136]=0;rb[136]=0;sb[136]=-1;tb[136]=1;ub[136]=1;vb[136]=0;wb[136]=0;xb[136]=1;yb[136]=0;zb[136]=1;lb[34]=0;mb[34]=-1;nb[34]=0;ib[34]=0;jb[34]=
-1;kb[34]=1;Db[34]=1;Eb[34]=0;Fb[34]=0;Ab[34]=1;Bb[34]=0;Cb[34]=1;ob[34]=0;pb[34]=1;qb[34]=1;rb[34]=0;sb[34]=1;tb[34]=0;ub[34]=-1;vb[34]=0;wb[34]=1;xb[34]=-1;yb[34]=0;zb[34]=0;lb[35]=0;mb[35]=1;nb[35]=1;ib[35]=0;jb[35]=-1;kb[35]=1;Db[35]=1;Eb[35]=0;Fb[35]=0;Ab[35]=-1;Bb[35]=0;Cb[35]=0;ob[35]=0;pb[35]=-1;qb[35]=0;rb[35]=0;sb[35]=1;tb[35]=0;ub[35]=-1;vb[35]=0;wb[35]=1;xb[35]=1;yb[35]=0;zb[35]=1;lb[153]=0;mb[153]=1;nb[153]=1;Ab[153]=-1;Bb[153]=0;Cb[153]=0;ob[153]=0;pb[153]=-1;qb[153]=0;xb[153]=1;yb[153]=
0;zb[153]=1;ib[102]=0;jb[102]=-1;kb[102]=1;Db[102]=1;Eb[102]=0;Fb[102]=0;rb[102]=0;sb[102]=1;tb[102]=0;ub[102]=-1;vb[102]=0;wb[102]=1;lb[155]=0;mb[155]=-1;nb[155]=0;Ab[155]=1;Bb[155]=0;Cb[155]=1;ob[155]=0;pb[155]=1;qb[155]=1;xb[155]=-1;yb[155]=0;zb[155]=0;ib[103]=0;jb[103]=1;kb[103]=0;Db[103]=-1;Eb[103]=0;Fb[103]=1;rb[103]=0;sb[103]=-1;tb[103]=1;ub[103]=1;vb[103]=0;wb[103]=0;lb[152]=0;mb[152]=1;nb[152]=1;Db[152]=-1;Eb[152]=0;Fb[152]=1;Ab[152]=-1;Bb[152]=0;Cb[152]=0;ob[152]=0;pb[152]=-1;qb[152]=0;
rb[152]=0;sb[152]=-1;tb[152]=1;xb[152]=1;yb[152]=0;zb[152]=1;lb[156]=0;mb[156]=-1;nb[156]=1;Db[156]=1;Eb[156]=0;Fb[156]=1;Ab[156]=-1;Bb[156]=0;Cb[156]=0;ob[156]=0;pb[156]=-1;qb[156]=0;rb[156]=0;sb[156]=1;tb[156]=1;xb[156]=-1;yb[156]=0;zb[156]=1;lb[137]=0;mb[137]=1;nb[137]=1;ib[137]=0;jb[137]=1;kb[137]=0;Ab[137]=-1;Bb[137]=0;Cb[137]=0;ob[137]=0;pb[137]=-1;qb[137]=0;ub[137]=1;vb[137]=0;wb[137]=0;xb[137]=1;yb[137]=0;zb[137]=1;lb[139]=0;mb[139]=1;nb[139]=1;ib[139]=0;jb[139]=-1;kb[139]=0;Ab[139]=1;Bb[139]=
0;Cb[139]=0;ob[139]=0;pb[139]=1;qb[139]=0;ub[139]=-1;vb[139]=0;wb[139]=0;xb[139]=1;yb[139]=0;zb[139]=1;lb[98]=0;mb[98]=-1;nb[98]=0;ib[98]=0;jb[98]=-1;kb[98]=1;Db[98]=1;Eb[98]=0;Fb[98]=0;Ab[98]=1;Bb[98]=0;Cb[98]=1;rb[98]=0;sb[98]=1;tb[98]=0;ub[98]=-1;vb[98]=0;wb[98]=1;lb[99]=0;mb[99]=1;nb[99]=0;ib[99]=0;jb[99]=-1;kb[99]=1;Db[99]=1;Eb[99]=0;Fb[99]=0;Ab[99]=-1;Bb[99]=0;Cb[99]=1;rb[99]=0;sb[99]=-1;tb[99]=0;ub[99]=1;vb[99]=0;wb[99]=1;ib[38]=0;jb[38]=-1;kb[38]=1;Db[38]=1;Eb[38]=0;Fb[38]=0;ob[38]=0;pb[38]=
1;qb[38]=1;rb[38]=0;sb[38]=1;tb[38]=0;ub[38]=-1;vb[38]=0;wb[38]=1;xb[38]=-1;yb[38]=0;zb[38]=0;ib[39]=0;jb[39]=1;kb[39]=1;Db[39]=-1;Eb[39]=0;Fb[39]=0;ob[39]=0;pb[39]=-1;qb[39]=1;rb[39]=0;sb[39]=1;tb[39]=0;ub[39]=-1;vb[39]=0;wb[39]=1;xb[39]=1;yb[39]=0;zb[39]=0;var uj=function(f){return[[f.bottomleft,0],[0,0],[0,f.leftbottom]]},vj=function(f){return[[1,f.rightbottom],[1,0],[f.bottomright,0]]},wj=function(f){return[[f.topright,1],[1,1],[1,f.righttop]]},xj=function(f){return[[0,f.lefttop],[0,1],[f.topleft,
1]]},yj=function(f){return[[f.bottomright,0],[f.bottomleft,0],[0,f.leftbottom],[0,f.lefttop]]},zj=function(f){return[[f.bottomright,0],[f.bottomleft,0],[1,f.righttop],[1,f.rightbottom]]},Aj=function(f){return[[1,f.righttop],[1,f.rightbottom],[f.topleft,1],[f.topright,1]]},Bj=function(f){return[[0,f.leftbottom],[0,f.lefttop],[f.topleft,1],[f.topright,1]]},Ha=[],Ga=[],Oa=[],La=[],Wa=[],Va=[],hb=[],Gb=[];La[1]=Wa[1]=18;La[169]=Wa[169]=18;Oa[4]=Ga[4]=12;Oa[166]=Ga[166]=12;Ha[16]=Gb[16]=4;Ha[154]=Gb[154]=
4;Va[64]=hb[64]=22;Va[106]=hb[106]=22;Oa[2]=Va[2]=17;La[2]=Wa[2]=18;Oa[168]=Va[168]=17;La[168]=Wa[168]=18;Ha[8]=La[8]=9;Ga[8]=Oa[8]=12;Ha[162]=La[162]=9;Ga[162]=Oa[162]=12;Ha[32]=Gb[32]=4;Ga[32]=hb[32]=1;Ha[138]=Gb[138]=4;Ga[138]=hb[138]=1;Wa[128]=Gb[128]=21;Va[128]=hb[128]=22;Wa[42]=Gb[42]=21;Va[42]=hb[42]=22;Ga[5]=Wa[5]=14;Ga[165]=Wa[165]=14;Oa[20]=Gb[20]=6;Oa[150]=Gb[150]=6;Ha[80]=Va[80]=11;Ha[90]=Va[90]=11;La[65]=hb[65]=3;La[105]=hb[105]=3;Ha[160]=Va[160]=11;Ga[160]=Wa[160]=14;Ha[10]=Va[10]=11;
Ga[10]=Wa[10]=14;Oa[130]=Gb[130]=6;La[130]=hb[130]=3;Oa[40]=Gb[40]=6;La[40]=hb[40]=3;Ga[101]=hb[101]=1;Ga[69]=hb[69]=1;Wa[149]=Gb[149]=21;Wa[21]=Gb[21]=21;Oa[86]=Va[86]=17;Oa[84]=Va[84]=17;Ha[89]=La[89]=9;Ha[81]=La[81]=9;Ha[96]=hb[96]=0;Ga[96]=Va[96]=15;Ha[74]=hb[74]=0;Ga[74]=Va[74]=15;Ha[24]=Oa[24]=8;La[24]=Gb[24]=7;Ha[146]=Oa[146]=8;La[146]=Gb[146]=7;Ga[6]=Va[6]=15;Oa[6]=Wa[6]=16;Ga[164]=Va[164]=15;Oa[164]=Wa[164]=16;La[129]=Gb[129]=7;Wa[129]=hb[129]=20;La[41]=Gb[41]=7;Wa[41]=hb[41]=20;Oa[66]=hb[66]=
2;La[66]=Va[66]=19;Oa[104]=hb[104]=2;La[104]=Va[104]=19;Ha[144]=Wa[144]=10;Va[144]=Gb[144]=23;Ha[26]=Wa[26]=10;Va[26]=Gb[26]=23;Ga[36]=Gb[36]=5;Oa[36]=hb[36]=2;Ga[134]=Gb[134]=5;Oa[134]=hb[134]=2;Ha[9]=Wa[9]=10;Ga[9]=La[9]=13;Ha[161]=Wa[161]=10;Ga[161]=La[161]=13;Ga[37]=Gb[37]=5;Wa[37]=hb[37]=20;Ga[133]=Gb[133]=5;Wa[133]=hb[133]=20;Oa[148]=Wa[148]=16;Va[148]=Gb[148]=23;Oa[22]=Wa[22]=16;Va[22]=Gb[22]=23;Ha[82]=Oa[82]=8;La[82]=Va[82]=19;Ha[88]=Oa[88]=8;La[88]=Va[88]=19;Ha[73]=hb[73]=0;Ga[73]=La[73]=
13;Ha[97]=hb[97]=0;Ga[97]=La[97]=13;Ha[145]=La[145]=9;Wa[145]=Gb[145]=21;Ha[25]=La[25]=9;Wa[25]=Gb[25]=21;Ga[70]=hb[70]=1;Oa[70]=Va[70]=17;Ga[100]=hb[100]=1;Oa[100]=Va[100]=17;Ha[34]=La[34]=9;Ga[34]=Oa[34]=12;Wa[34]=Gb[34]=21;Va[34]=hb[34]=22;Ha[136]=Gb[136]=4;Ga[136]=hb[136]=1;Oa[136]=Va[136]=17;La[136]=Wa[136]=18;Ha[35]=Gb[35]=4;Ga[35]=Oa[35]=12;La[35]=Wa[35]=18;Va[35]=hb[35]=22;Ha[153]=Gb[153]=4;La[153]=Wa[153]=18;Ga[102]=Oa[102]=12;Va[102]=hb[102]=22;Ha[155]=La[155]=9;Wa[155]=Gb[155]=23;Ga[103]=
hb[103]=1;Oa[103]=Va[103]=17;Ha[152]=Gb[152]=4;Oa[152]=Va[152]=17;La[152]=Wa[152]=18;Ha[156]=Oa[156]=8;La[156]=Wa[156]=18;Va[156]=Gb[156]=23;Ha[137]=Gb[137]=4;Ga[137]=hb[137]=1;La[137]=Wa[137]=18;Ha[139]=Gb[139]=4;Ga[139]=La[139]=13;Wa[139]=hb[139]=20;Ha[98]=La[98]=9;Ga[98]=Oa[98]=12;Va[98]=hb[98]=22;Ha[99]=hb[99]=0;Ga[99]=Oa[99]=12;La[99]=Va[99]=19;Ga[38]=Oa[38]=12;Wa[38]=Gb[38]=21;Va[38]=hb[38]=22;Ga[39]=Gb[39]=5;Oa[39]=Wa[39]=16;Va[39]=hb[39]=22;var Ea=[];Ea[1]=Ea[169]=uj;Ea[4]=Ea[166]=vj;Ea[16]=
Ea[154]=wj;Ea[64]=Ea[106]=xj;Ea[168]=Ea[2]=yj;Ea[162]=Ea[8]=zj;Ea[138]=Ea[32]=Aj;Ea[42]=Ea[128]=Bj;Ea[5]=Ea[165]=function(f){return[[0,0],[0,f.leftbottom],[1,f.rightbottom],[1,0]]};Ea[20]=Ea[150]=function(f){return[[1,0],[f.bottomright,0],[f.topright,1],[1,1]]};Ea[80]=Ea[90]=function(f){return[[1,1],[1,f.righttop],[0,f.lefttop],[0,1]]};Ea[65]=Ea[105]=function(f){return[[f.bottomleft,0],[0,0],[0,1],[f.topleft,1]]};Ea[160]=Ea[10]=function(f){return[[1,f.righttop],[1,f.rightbottom],[0,f.leftbottom],
[0,f.lefttop]]};Ea[130]=Ea[40]=function(f){return[[f.topleft,1],[f.topright,1],[f.bottomright,0],[f.bottomleft,0]]};Ea[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]};Ea[101]=Ea[69]=function(f){return[[1,f.rightbottom],[1,0],[0,0],[0,1],[f.topleft,1]]};Ea[149]=Ea[21]=function(f){return[[f.topright,1],[1,1],[1,0],[0,0],[0,f.leftbottom]]};Ea[86]=Ea[84]=function(f){return[[1,0],[f.bottomright,0],[0,f.lefttop],[0,1],[1,1]]};Ea[89]=Ea[81]=function(f){return[[1,1],[1,f.righttop],[f.bottomleft,0],[0,0],
[0,1]]};Ea[96]=Ea[74]=function(f){return[[1,f.righttop],[1,f.rightbottom],[0,f.lefttop],[0,1],[f.topleft,1]]};Ea[24]=Ea[146]=function(f){return[[1,1],[1,f.righttop],[f.bottomright,0],[f.bottomleft,0],[f.topright,1]]};Ea[6]=Ea[164]=function(f){return[[1,f.rightbottom],[1,0],[f.bottomright,0],[0,f.leftbottom],[0,f.lefttop]]};Ea[129]=Ea[41]=function(f){return[[f.topright,1],[f.bottomleft,0],[0,0],[0,f.leftbottom],[f.topleft,1]]};Ea[66]=Ea[104]=function(f){return[[f.bottomright,0],[f.bottomleft,0],[0,
f.lefttop],[0,1],[f.topleft,1]]};Ea[144]=Ea[26]=function(f){return[[1,1],[1,f.righttop],[0,f.leftbottom],[0,f.lefttop],[f.topright,1]]};Ea[36]=Ea[134]=function(f){return[[1,f.rightbottom],[1,0],[f.bottomright,0],[f.topleft,1],[f.topright,1]]};Ea[9]=Ea[161]=function(f){return[[1,f.righttop],[1,f.rightbottom],[f.bottomleft,0],[0,0],[0,f.leftbottom]]};Ea[37]=Ea[133]=function(f){return[[1,f.rightbottom],[1,0],[0,0],[0,f.leftbottom],[f.topleft,1],[f.topright,1]]};Ea[148]=Ea[22]=function(f){return[[1,1],
[1,0],[f.bottomright,0],[0,f.leftbottom],[0,f.lefttop],[f.topright,1]]};Ea[82]=Ea[88]=function(f){return[[1,1],[1,f.righttop],[f.bottomright,0],[f.bottomleft,0],[0,f.lefttop],[0,1]]};Ea[73]=Ea[97]=function(f){return[[1,f.righttop],[1,f.rightbottom],[f.bottomleft,0],[0,0],[0,1],[f.topleft,1]]};Ea[145]=Ea[25]=function(f){return[[1,1],[1,f.righttop],[f.bottomleft,0],[0,0],[0,f.leftbottom],[f.topright,1]]};Ea[70]=Ea[100]=function(f){return[[1,f.rightbottom],[1,0],[f.bottomright,0],[0,f.lefttop],[0,1],
[f.topleft,1]]};Ea[34]=function(f){return[Bj(f),zj(f)]};Ea[35]=function(f){return[[1,f.righttop],[1,f.rightbottom],[f.bottomright,0],[f.bottomleft,0],[0,f.leftbottom],[0,f.lefttop],[f.topleft,1],[f.topright,1]]};Ea[136]=function(f){return[Aj(f),yj(f)]};Ea[153]=function(f){return[wj(f),uj(f)]};Ea[102]=function(f){return[vj(f),xj(f)]};Ea[155]=function(f){return[[1,1],[1,f.righttop],[f.bottomleft,0],[0,0],[0,f.leftbottom],[f.topright,1]]};Ea[103]=function(f){return[[1,f.rightbottom],[1,0],[f.bottomright,
0],[0,f.lefttop],[0,1],[f.topleft,1]]};Ea[152]=function(f){return[wj(f),yj(f)]};Ea[156]=function(f){return[[1,1],[1,f.righttop],[f.bottomright,0],[f.bottomleft,0],[0,f.leftbottom],[0,f.lefttop],[f.topright,1]]};Ea[137]=function(f){return[Aj(f),uj(f)]};Ea[139]=function(f){return[[1,f.righttop],[1,f.rightbottom],[f.bottomleft,0],[0,0],[0,f.leftbottom],[f.topleft,1],[f.topright,1]]};Ea[98]=function(f){return[zj(f),xj(f)]};Ea[99]=function(f){return[[1,f.righttop],[1,f.rightbottom],[f.bottomright,0],[f.bottomleft,
0],[0,f.lefttop],[0,1],[f.topleft,1]]};Ea[38]=function(f){return[vj(f),Bj(f)]};Ea[39]=function(f){return[[1,f.rightbottom],[1,0],[f.bottomright,0],[0,f.leftbottom],[0,f.lefttop],[f.topleft,1],[f.topright,1]]};var Sm=function(){function f(h){this.id=f.buildId(h);this.coordinates=h;this.innerEdges=[];this.outerEdges=[];this.outerEdgesSorted=!1}return f.buildId=function(h){return h.join(",")},f.prototype.removeInnerEdge=function(h){this.innerEdges=this.innerEdges.filter(function(l){return l.from.id!==
h.from.id})},f.prototype.removeOuterEdge=function(h){this.outerEdges=this.outerEdges.filter(function(l){return l.to.id!==h.to.id})},f.prototype.addOuterEdge=function(h){this.outerEdges.push(h);this.outerEdgesSorted=!1},f.prototype.sortOuterEdges=function(){var h=this;this.outerEdgesSorted||(this.outerEdges.sort(function(l,q){l=l.to;q=q.to;if(0<=l.coordinates[0]-h.coordinates[0]&&0>q.coordinates[0]-h.coordinates[0])return 1;if(0>l.coordinates[0]-h.coordinates[0]&&0<=q.coordinates[0]-h.coordinates[0])return-1;
if(0==l.coordinates[0]-h.coordinates[0]&&0==q.coordinates[0]-h.coordinates[0])return 0<=l.coordinates[1]-h.coordinates[1]||0<=q.coordinates[1]-h.coordinates[1]?l.coordinates[1]-q.coordinates[1]:q.coordinates[1]-l.coordinates[1];var k=Ui(h.coordinates,l.coordinates,q.coordinates);return 0>k?1:0<k?-1:Math.pow(l.coordinates[0]-h.coordinates[0],2)+Math.pow(l.coordinates[1]-h.coordinates[1],2)-(Math.pow(q.coordinates[0]-h.coordinates[0],2)+Math.pow(q.coordinates[1]-h.coordinates[1],2))}),this.outerEdgesSorted=
!0)},f.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},f.prototype.getOuterEdge=function(h){return this.sortOuterEdges(),this.outerEdges[h]},f.prototype.addInnerEdge=function(h){this.innerEdges.push(h)},f}(),$o=function(){function f(h,l){this.from=h;this.to=l;this.ring=this.symetric=this.label=this.next=void 0;this.from.addOuterEdge(this);this.to.addInnerEdge(this)}return f.prototype.getSymetric=function(){return this.symetric||(this.symetric=new f(this.to,this.from),
this.symetric.symetric=this),this.symetric},f.prototype.deleteEdge=function(){this.from.removeOuterEdge(this);this.to.removeInnerEdge(this)},f.prototype.isEqual=function(h){return this.from.id===h.from.id&&this.to.id===h.to.id},f.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},f.prototype.toLineString=function(){return t([this.from.coordinates,this.to.coordinates])},f.prototype.compareTo=function(h){return Ui(h.from.coordinates,h.to.coordinates,this.to.coordinates)},
f}(),Tm=function(){function f(){this.edges=[];this.envelope=this.polygon=void 0}return f.prototype.push=function(h){this.edges.push(h);this.polygon=this.envelope=void 0},f.prototype.get=function(h){return this.edges[h]},Object.defineProperty(f.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),f.prototype.forEach=function(h){this.edges.forEach(h)},f.prototype.map=function(h){return this.edges.map(h)},f.prototype.some=function(h){return this.edges.some(h)},
f.prototype.isValid=function(){return!0},f.prototype.isHole=function(){var h=this,l=this.edges.reduce(function(m,r,p){return r.from.coordinates[1]>h.edges[m].from.coordinates[1]&&(m=p),m},0),q=(0===l?this.length:l)-1,k=(l+1)%this.length;l=Ui(this.edges[q].from.coordinates,this.edges[l].from.coordinates,this.edges[k].from.coordinates);return 0===l?this.edges[q].from.coordinates[0]>this.edges[k].from.coordinates[0]:0<l},f.prototype.toMultiPoint=function(){return H(this.edges.map(function(h){return h.from.coordinates}))},
f.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var h=this.edges.map(function(l){return l.from.coordinates});return h.push(this.edges[0].from.coordinates),this.polygon=g([h])},f.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=rk(this.toPolygon())},f.findEdgeRingContaining=function(h,l){var q,k,m=h.getEnvelope();return l.forEach(function(r){var p,u,x,v,y=r.getEnvelope();if((k&&(q=k.getEnvelope()),p=y.geometry.coordinates[0].map(function(G){return G[0]}),
u=y.geometry.coordinates[0].map(function(G){return G[1]}),x=m.geometry.coordinates[0].map(function(G){return G[0]}),v=m.geometry.coordinates[0].map(function(G){return G[1]}),Math.max.apply(null,p)!==Math.max.apply(null,x)||Math.max.apply(null,u)!==Math.max.apply(null,v)||Math.min.apply(null,p)!==Math.min.apply(null,x)||Math.min.apply(null,u)!==Math.min.apply(null,v))&&nl(y,m)){var B=void 0;p=function(G){r.some(function(A){return F=G,J=A.from.coordinates,F[0]===J[0]&&F[1]===J[1];var F,J})||(B=G)};
u=0;for(x=h.map(function(G){return G.from.coordinates});u<x.length;u++)p(x[u]);B&&r.inside(d(B))&&(k&&!nl(q,y)||(k=r))}}),k},f.prototype.inside=function(h){return Wb(h,this.toPolygon())},f}(),ap=function(){function f(){this.edges=[];this.nodes={}}return f.fromGeoJson=function(h){if(!h)throw Error("No geojson passed");if("FeatureCollection"!==h.type&&"GeometryCollection"!==h.type&&"MultiLineString"!==h.type&&"LineString"!==h.type&&"Feature"!==h.type)throw Error("Invalid input type '"+h.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature");
!0;var l=new f;return eb(h,function(q){Sb(q,"LineString","Graph::fromGeoJson");Ya(q,function(k,m){if(k){k=l.getNode(k);var r=l.getNode(m);l.addEdge(k,r)}return m})}),l},f.prototype.getNode=function(h){var l=Sm.buildId(h),q=this.nodes[l];return q||=this.nodes[l]=new Sm(h),q},f.prototype.addEdge=function(h,l){h=new $o(h,l);l=h.getSymetric();this.edges.push(h);this.edges.push(l)},f.prototype.deleteDangles=function(){var h=this;Object.keys(this.nodes).map(function(l){return h.nodes[l]}).forEach(function(l){return h._removeIfDangle(l)})},
f.prototype._removeIfDangle=function(h){var l=this;if(1>=h.innerEdges.length){var q=h.getOuterEdges().map(function(k){return k.to});this.removeNode(h);q.forEach(function(k){return l._removeIfDangle(k)})}},f.prototype.deleteCutEdges=function(){var h=this;this._computeNextCWEdges();this._findLabeledEdgeRings();this.edges.forEach(function(l){l.label===l.symetric.label&&(h.removeEdge(l.symetric),h.removeEdge(l))})},f.prototype._computeNextCWEdges=function(h){var l=this;void 0===h?Object.keys(this.nodes).forEach(function(q){return l._computeNextCWEdges(l.nodes[q])}):
h.getOuterEdges().forEach(function(q,k){h.getOuterEdge((0===k?h.getOuterEdges().length:k)-1).symetric.next=q})},f.prototype._computeNextCCWEdges=function(h,l){var q,k;h=h.getOuterEdges();for(var m=h.length-1;0<=m;--m){var r=h[m],p=r.symetric,u=void 0,x=void 0;r.label===l&&(u=r);p.label===l&&(x=p);u&&x&&(x&&(k=x),u&&(k&&(k.next=u,k=void 0),q||=u))}k&&(k.next=q)},f.prototype._findLabeledEdgeRings=function(){var h=[],l=0;return this.edges.forEach(function(q){if(!(0<=q.label)){h.push(q);var k=q;do k.label=
l,k=k.next;while(!q.isEqual(k));l++}}),h},f.prototype.getEdgeRings=function(){var h=this;this._computeNextCWEdges();this.edges.forEach(function(q){q.label=void 0});this._findLabeledEdgeRings().forEach(function(q){h._findIntersectionNodes(q).forEach(function(k){h._computeNextCCWEdges(k,q.label)})});var l=[];return this.edges.forEach(function(q){q.ring||l.push(h._findEdgeRing(q))}),l},f.prototype._findIntersectionNodes=function(h){var l=[],q=h,k=function(){var m=0;q.from.getOuterEdges().forEach(function(r){r.label===
h.label&&++m});1<m&&l.push(q.from);q=q.next};do k();while(!h.isEqual(q));return l},f.prototype._findEdgeRing=function(h){var l=h,q=new Tm;do q.push(l),l.ring=q,l=l.next;while(!h.isEqual(l));return q},f.prototype.removeNode=function(h){var l=this;h.getOuterEdges().forEach(function(q){return l.removeEdge(q)});h.innerEdges.forEach(function(q){return l.removeEdge(q)});delete this.nodes[h.id]},f.prototype.removeEdge=function(h){this.edges=this.edges.filter(function(l){return!l.isEqual(h)});h.deleteEdge()},
f}(),Ud=function(f){this.precision=f&&f.precision?f.precision:17;this.direction=!(!f||!f.direction)&&f.direction;this.pseudoNode=!(!f||!f.pseudoNode)&&f.pseudoNode;this.objectComparator=f&&f.objectComparator?f.objectComparator:mo};Ud.prototype.compare=function(f,h){if(f.type!==h.type||!wl(f,h))return!1;switch(f.type){case "Point":return this.compareCoord(f.coordinates,h.coordinates);case "LineString":return this.compareLine(f.coordinates,h.coordinates,0,!1);case "Polygon":return this.comparePolygon(f,
h);case "Feature":return this.compareFeature(f,h);default:if(0===f.type.indexOf("Multi")){var l=this;f=vl(f);h=vl(h);return f.every(function(q){return this.some(function(k){return l.compare(q,k)})},h)}}return!1};Ud.prototype.compareCoord=function(f,h){if(f.length!==h.length)return!1;for(var l=0;l<f.length;l++)if(f[l].toFixed(this.precision)!==h[l].toFixed(this.precision))return!1;return!0};Ud.prototype.compareLine=function(f,h,l,q){if(!wl(f,h))return!1;f=this.pseudoNode?f:this.removePseudo(f);h=this.pseudoNode?
h:this.removePseudo(h);if(!q||this.compareCoord(f[0],h[0])||(h=this.fixStartIndex(h,f)))return q=this.compareCoord(f[l],h[l]),this.direction||q?this.comparePath(f,h):!!this.compareCoord(f[l],h[h.length-(1+l)])&&this.comparePath(f.slice().reverse(),h)};Ud.prototype.fixStartIndex=function(f,h){for(var l,q=-1,k=0;k<f.length;k++)if(this.compareCoord(f[k],h[0])){q=k;break}return 0<=q&&(l=[].concat(f.slice(q,f.length),f.slice(1,q+1))),l};Ud.prototype.comparePath=function(f,h){var l=this;return f.every(function(q,
k){return l.compareCoord(q,this[k])},h)};Ud.prototype.comparePolygon=function(f,h){if(this.compareLine(f.coordinates[0],h.coordinates[0],1,!0)){f=f.coordinates.slice(1,f.coordinates.length);h=h.coordinates.slice(1,h.coordinates.length);var l=this;return f.every(function(q){return this.some(function(k){return l.compareLine(q,k,1,!0)})},h)}return!1};Ud.prototype.compareFeature=function(f,h){return!(f.id!==h.id||!this.objectComparator(f.properties,h.properties)||!this.compareBBox(f,h))&&this.compare(f.geometry,
h.geometry)};Ud.prototype.compareBBox=function(f,h){return!!(!f.bbox&&!h.bbox||f.bbox&&h.bbox&&this.compareCoord(f.bbox,h.bbox))};Ud.prototype.removePseudo=function(f){return f};var bp=je(function(f){function h(l,q,k,m){this.dataset=[];this.epsilon=1;this.minPts=2;this.distance=this._euclideanDistance;this.clusters=[];this.noise=[];this._visited=[];this._assigned=[];this._datasetLength=0;this._init(l,q,k,m)}h.prototype.run=function(l,q,k,m){this._init(l,q,k,m);for(l=0;l<this._datasetLength;l++)1!==
this._visited[l]&&(this._visited[l]=1,q=this._regionQuery(l),q.length<this.minPts?this.noise.push(l):(k=this.clusters.length,this.clusters.push([]),this._addToCluster(l,k),this._expandCluster(k,q)));return this.clusters};h.prototype._init=function(l,q,k,m){if(l){if(!(l instanceof Array))throw Error("Dataset must be of type array, "+typeof l+" given");this.dataset=l;this.clusters=[];this.noise=[];this._datasetLength=l.length;this._visited=Array(this._datasetLength);this._assigned=Array(this._datasetLength)}q&&
(this.epsilon=q);k&&(this.minPts=k);m&&(this.distance=m)};h.prototype._expandCluster=function(l,q){for(var k=0;k<q.length;k++){var m=q[k];if(1!==this._visited[m]){this._visited[m]=1;var r=this._regionQuery(m);r.length>=this.minPts&&(q=this._mergeArrays(q,r))}1!==this._assigned[m]&&this._addToCluster(m,l)}};h.prototype._addToCluster=function(l,q){this.clusters[q].push(l);this._assigned[l]=1};h.prototype._regionQuery=function(l){for(var q=[],k=0;k<this._datasetLength;k++)this.distance(this.dataset[l],
this.dataset[k])<this.epsilon&&q.push(k);return q};h.prototype._mergeArrays=function(l,q){for(var k=q.length,m=0;m<k;m++){var r=q[m];0>l.indexOf(r)&&l.push(r)}return l};h.prototype._euclideanDistance=function(l,q){for(var k=0,m=Math.min(l.length,q.length);m--;)k+=(l[m]-q[m])*(l[m]-q[m]);return Math.sqrt(k)};f.exports&&(f.exports=h)}),cp=je(function(f){function h(l,q,k){this.k=3;this.dataset=[];this.assignments=[];this.centroids=[];this.init(l,q,k)}h.prototype.init=function(l,q,k){this.assignments=
[];this.centroids=[];void 0!==l&&(this.dataset=l);void 0!==q&&(this.k=q);void 0!==k&&(this.distance=k)};h.prototype.run=function(l,q){this.init(l,q);l=this.dataset.length;for(q=0;q<this.k;q++)this.centroids[q]=this.randomCentroid();for(q=!0;q;){q=this.assign();for(var k=0;k<this.k;k++){for(var m=Array(x),r=0,p=0;p<x;p++)m[p]=0;for(var u=0;u<l;u++){var x=this.dataset[u].length;if(k===this.assignments[u]){for(p=0;p<x;p++)m[p]+=this.dataset[u][p];r++}}if(0<r){for(p=0;p<x;p++)m[p]/=r;this.centroids[k]=
m}else this.centroids[k]=this.randomCentroid(),q=!0}}return this.getClusters()};h.prototype.randomCentroid=function(){var l=this.dataset.length-1;do{var q=Math.round(Math.random()*l);q=this.dataset[q]}while(0<=this.centroids.indexOf(q));return q};h.prototype.assign=function(){for(var l,q=!1,k=this.dataset.length,m=0;m<k;m++)(l=this.argmin(this.dataset[m],this.centroids,this.distance))!=this.assignments[m]&&(this.assignments[m]=l,q=!0);return q};h.prototype.getClusters=function(){for(var l,q=Array(this.k),
k=0;k<this.assignments.length;k++)void 0===q[l=this.assignments[k]]&&(q[l]=[]),q[l].push(k);return q};h.prototype.argmin=function(l,q,k){for(var m,r=Number.MAX_VALUE,p=0,u=q.length,x=0;x<u;x++)(m=k(l,q[x]))<r&&(r=m,p=x);return p};h.prototype.distance=function(l,q){for(var k=0,m=Math.min(l.length,q.length);m--;){var r=l[m]-q[m];k+=r*r}return Math.sqrt(k)};f.exports&&(f.exports=h)}),Um=je(function(f){function h(l,q,k){this._queue=[];this._priorities=[];this._sorting="desc";this._init(l,q,k)}h.prototype.insert=
function(l,q){for(var k=this._queue.length,m=k;m--;){var r=this._priorities[m];"desc"===this._sorting?q>r&&(k=m):q<r&&(k=m)}this._insertAt(l,q,k)};h.prototype.remove=function(l){for(var q=this._queue.length;q--;)if(l===this._queue[q]){this._queue.splice(q,1);this._priorities.splice(q,1);break}};h.prototype.forEach=function(l){this._queue.forEach(l)};h.prototype.getElements=function(){return this._queue};h.prototype.getElementPriority=function(l){return this._priorities[l]};h.prototype.getPriorities=
function(){return this._priorities};h.prototype.getElementsWithPriorities=function(){for(var l=[],q=0,k=this._queue.length;q<k;q++)l.push([this._queue[q],this._priorities[q]]);return l};h.prototype._init=function(l,q,k){if(l&&q){if(this._queue=[],this._priorities=[],l.length!==q.length)throw Error("Arrays must have the same length");for(var m=0;m<l.length;m++)this.insert(l[m],q[m])}k&&(this._sorting=k)};h.prototype._insertAt=function(l,q,k){this._queue.length===k?(this._queue.push(l),this._priorities.push(q)):
(this._queue.splice(k,0,l),this._priorities.splice(k,0,q))};f.exports&&(f.exports=h)}),dp=je(function(f){function h(q,k,m,r){this.minPts=this.epsilon=1;this.distance=this._euclideanDistance;this._reachability=[];this._processed=[];this._coreDistance=0;this._orderedList=[];this._init(q,k,m,r)}if(f.exports)var l=Um;h.prototype.run=function(q,k,m,r){this._init(q,k,m,r);q=0;for(k=this.dataset.length;q<k;q++)if(1!==this._processed[q]){this._processed[q]=1;this.clusters.push([q]);m=this.clusters.length-
1;this._orderedList.push(q);r=new l(null,null,"asc");var p=this._regionQuery(q);void 0!==this._distanceToCore(q)&&(this._updateQueue(q,p,r),this._expandCluster(m,r))}return this.clusters};h.prototype.getReachabilityPlot=function(){for(var q=[],k=0,m=this._orderedList.length;k<m;k++){var r=this._orderedList[k];q.push([r,this._reachability[r]])}return q};h.prototype._init=function(q,k,m,r){if(q){if(!(q instanceof Array))throw Error("Dataset must be of type array, "+typeof q+" given");this.dataset=q;
this.clusters=[];this._reachability=Array(this.dataset.length);this._processed=Array(this.dataset.length);this._coreDistance=0;this._orderedList=[]}k&&(this.epsilon=k);m&&(this.minPts=m);r&&(this.distance=r)};h.prototype._updateQueue=function(q,k,m){var r=this;this._coreDistance=this._distanceToCore(q);k.forEach(function(p){if(void 0===r._processed[p]){var u=r.distance(r.dataset[q],r.dataset[p]);u=Math.max(r._coreDistance,u);void 0===r._reachability[p]?(r._reachability[p]=u,m.insert(p,u)):u<r._reachability[p]&&
(r._reachability[p]=u,m.remove(p),m.insert(p,u))}})};h.prototype._expandCluster=function(q,k){for(var m=k.getElements(),r=0,p=m.length;r<p;r++){var u=m[r];if(void 0===this._processed[u]){var x=this._regionQuery(u);this._processed[u]=1;this.clusters[q].push(u);this._orderedList.push(u);void 0!==this._distanceToCore(u)&&(this._updateQueue(u,x,k),this._expandCluster(q,k))}}};h.prototype._distanceToCore=function(q){for(var k=this.epsilon,m=0;m<k;m++)if(this._regionQuery(q,m).length>=this.minPts)return m};
h.prototype._regionQuery=function(q,k){k=k||this.epsilon;for(var m=[],r=0,p=this.dataset.length;r<p;r++)this.distance(this.dataset[q],this.dataset[r])<k&&m.push(r);return m};h.prototype._euclideanDistance=function(q,k){for(var m=0,r=Math.min(q.length,k.length);r--;)m+=(q[r]-k[r])*(q[r]-k[r]);return Math.sqrt(m)};f.exports&&(f.exports=h)}),ep=je(function(f){f.exports&&(f.exports={DBSCAN:bp,KMEANS:cp,OPTICS:dp,PriorityQueue:Um})}),Vm=function(f,h,l){for(var q=f.length,k=0,m=0;m<q;m++){var r=(f[m]||
0)-(h[m]||0);k+=r*r}return l?Math.sqrt(k):k},fp=function(f,h,l){f=Math.abs(f-h);return l?f:f*f},gp=function(f,h){var l=f[0].length?Vm:fp,q=[],k=f.length,m=f[Math.floor(Math.random()*k)];0<f[0].length&&m.join("_");for(q.push(m);q.length<h;){var r=[],p=q.length,u=0;m=[];for(var x=0;x<k;x++){for(var v=1/0,y=0;y<p;y++){var B=l(f[x],q[y]);B<=v&&(v=B)}r[x]=v}for(p=0;p<k;p++)u+=r[p];for(p=0;p<k;p++)m[p]={i:p,v:f[p],pr:r[p]/u,cs:0};m.sort(function(G,A){return G.pr-A.pr});m[0].cs=m[0].pr;for(r=1;r<k;r++)m[r].cs=
m[r-1].cs+m[r].pr;r=Math.random();for(u=0;u<k-1&&m[u++].cs<r;);q.push(m[u-1].v)}return q},hp=function(f,h,l,q){var k=[],m=[],r=[];q=q||1E4;var p=f.length,u=f[0].length,x=0<u,v=[];if(l)if("kmrand"==l){k={};l=[];var y=h<<2;var B=f.length;for(var G=0<f[0].length;l.length<h&&0<y--;){var A=f[Math.floor(Math.random()*B)],F=G?A.join("_"):""+A;k[F]||(k[F]=!0,l.push(A))}if(l.length<h)throw Error("Error initializating clusters");k=l}else k="kmpp"==l?gp(f,h):l;else for(l={};k.length<h;)y=Math.floor(Math.random()*
p),l[y]||(l[y]=!0,k.push(f[y]));do{yl(h,0,v);for(l=0;l<p;l++){y=1/0;for(G=B=0;G<h;G++)(r=x?Vm(f[l],k[G]):Math.abs(f[l]-k[G]))<=y&&(y=r,B=G);m[l]=B;v[B]++}y=[];for(B=(l=[],0);B<h;B++)y[B]=x?yl(u,0,y[B]):0,l[B]=k[B];if(x){for(B=0;B<h;B++)k[B]=[];for(B=0;B<p;B++)for(G=y[m[B]],A=f[B],F=0;F<u;F++)G[F]+=A[F];B=!0;for(G=0;G<h;G++){A=k[G];var J=y[G];F=l[G];for(var D=v[G],E=0;E<u;E++)A[E]=J[E]/D||0;if(B)for(J=0;J<u;J++)if(F[J]!=A[J]){B=!1;break}}}else{for(B=0;B<p;B++)y[m[B]]+=f[B];for(B=0;B<h;B++)k[B]=y[B]/
v[B]||0;B=!0;for(y=0;y<h;y++)if(l[y]!=k[y]){B=!1;break}}B=B||0>=--q}while(!B);return{it:1E4-q,k:h,idxs:m,centroids:k}},Vh={search:function(f,h,l,q){f.cleanDirty();var k=(q=q||{}).heuristic||Vh.heuristics.manhattan;q=q.closest||!1;var m=new Bl(function(G){return G.f}),r=h;h.h=k(h,l);for(m.push(h);0<m.size();){h=m.pop();if(h===l)return Al(h);h.closed=!0;for(var p=f.neighbors(h),u=0,x=p.length;u<x;++u){var v=p[u];if(!v.closed&&!v.isWall()){var y=h.g+v.getCost(h),B=v.visited;(!B||y<v.g)&&(v.visited=!0,
v.parent=h,v.h=v.h||k(v,l),v.g=y,v.f=v.g+v.h,f.markDirty(v),q&&(v.h<r.h||v.h===r.h&&v.g<r.g)&&(r=v),B?m.rescoreElement(v):m.push(v))}}}return q?Al(r):[]},heuristics:{manhattan:function(f,h){return Math.abs(h.x-f.x)+Math.abs(h.y-f.y)},diagonal:function(f,h){var l=Math.abs(h.x-f.x);f=Math.abs(h.y-f.y);return 1*(l+f)+(Math.sqrt(2)-2)*Math.min(l,f)}},cleanNode:function(f){f.f=0;f.g=0;f.h=0;f.visited=!1;f.closed=!1;f.parent=null}};If.prototype.init=function(){this.dirtyNodes=[];for(var f=0;f<this.nodes.length;f++)Vh.cleanNode(this.nodes[f])};
If.prototype.cleanDirty=function(){for(var f=0;f<this.dirtyNodes.length;f++)Vh.cleanNode(this.dirtyNodes[f]);this.dirtyNodes=[]};If.prototype.markDirty=function(f){this.dirtyNodes.push(f)};If.prototype.neighbors=function(f){var h=[],l=f.x;f=f.y;var q=this.grid;return q[l-1]&&q[l-1][f]&&h.push(q[l-1][f]),q[l+1]&&q[l+1][f]&&h.push(q[l+1][f]),q[l]&&q[l][f-1]&&h.push(q[l][f-1]),q[l]&&q[l][f+1]&&h.push(q[l][f+1]),this.diagonal&&(q[l-1]&&q[l-1][f-1]&&h.push(q[l-1][f-1]),q[l+1]&&q[l+1][f-1]&&h.push(q[l+
1][f-1]),q[l-1]&&q[l-1][f+1]&&h.push(q[l-1][f+1]),q[l+1]&&q[l+1][f+1]&&h.push(q[l+1][f+1])),h};If.prototype.toString=function(){for(var f,h,l,q,k=[],m=this.grid,r=0,p=m.length;r<p;r++){f=[];l=0;for(q=(h=m[r]).length;l<q;l++)f.push(h[l].weight);k.push(f.join(" "))}return k.join("\n")};Gh.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};Gh.prototype.getCost=function(f){return f&&f.x!==this.x&&f.y!==this.y?1.41421*this.weight:this.weight};Gh.prototype.isWall=function(){return 0===this.weight};
Bl.prototype={push:function(f){this.content.push(f);this.sinkDown(this.content.length-1)},pop:function(){var f=this.content[0],h=this.content.pop();return 0<this.content.length&&(this.content[0]=h,this.bubbleUp(0)),f},remove:function(f){var h=this.content.indexOf(f),l=this.content.pop();h!==this.content.length-1&&(this.content[h]=l,this.scoreFunction(l)<this.scoreFunction(f)?this.sinkDown(h):this.bubbleUp(h))},size:function(){return this.content.length},rescoreElement:function(f){this.sinkDown(this.content.indexOf(f))},
sinkDown:function(f){for(var h=this.content[f];0<f;){var l=(f+1>>1)-1,q=this.content[l];if(!(this.scoreFunction(h)<this.scoreFunction(q)))break;this.content[l]=h;this.content[f]=q;f=l}},bubbleUp:function(f){for(var h=this.content.length,l=this.content[f],q=this.scoreFunction(l);;){var k,m=f+1<<1,r=m-1,p=null;r<h&&(k=this.scoreFunction(this.content[r]))<q&&(p=r);m<h&&this.scoreFunction(this.content[m])<(null===p?q:k)&&(p=m);if(null===p)break;this.content[f]=this.content[p];this.content[p]=l;f=p}}};
Hh.prototype={constructor:Hh,insert:function(f,h){var l,q;if(f){if(h.P=f,h.N=f.N,f.N&&(f.N.P=h),f.N=h,f.R){for(f=f.R;f.L;)f=f.L;f.L=h}else f.R=h;var k=f}else this._?(f=Dl(this._),h.P=null,h.N=f,f.P=f.L=h,k=f):(h.P=h.N=null,this._=h,k=null);h.L=h.R=null;h.U=k;h.C=!0;for(f=h;k&&k.C;)k===(l=k.U).L?(q=l.R)&&q.C?(k.C=q.C=!1,l.C=!0,f=l):(f===k.R&&(Bg(this,k),k=(f=k).U),k.C=!1,l.C=!0,Cg(this,l)):(q=l.L)&&q.C?(k.C=q.C=!1,l.C=!0,f=l):(f===k.L&&(Cg(this,k),k=(f=k).U),k.C=!1,l.C=!0,Bg(this,l)),k=f.U;this._.C=
!1},remove:function(f){f.N&&(f.N.P=f.P);f.P&&(f.P.N=f.N);f.N=f.P=null;var h,l,q,k=f.U,m=f.L,r=f.R;if(l=m?r?Dl(r):m:r,k?k.L===f?k.L=l:k.R=l:this._=l,m&&r?(q=l.C,l.C=f.C,l.L=m,m.U=l,l!==r?(k=l.U,l.U=f.U,f=l.R,k.L=f,l.R=r,r.U=l):(l.U=k,k=l,f=l.R)):(q=f.C,f=l),f&&(f.U=k),!q)if(f&&f.C)f.C=!1;else{do{if(f===this._)break;if(f===k.L){if((h=k.R).C&&(h.C=!1,k.C=!0,Bg(this,k),h=k.R),h.L&&h.L.C||h.R&&h.R.C){h.R&&h.R.C||(h.L.C=!1,h.C=!0,Cg(this,h),h=k.R);h.C=k.C;k.C=h.R.C=!1;Bg(this,k);f=this._;break}}else if((h=
k.L).C&&(h.C=!1,k.C=!0,Cg(this,k),h=k.L),h.L&&h.L.C||h.R&&h.R.C){h.L&&h.L.C||(h.R.C=!1,h.C=!0,Bg(this,h),h=k.L);h.C=k.C;k.C=h.L.C=!1;Cg(this,k);f=this._;break}h.C=!0;f=k;k=k.U}while(!f.C);f&&(f.C=!1)}}};var Wi,Fl=[],Hl=[],Lf,sd,Fg,Xc,Yb=1E-6,uo=1E-12;Yi.prototype={constructor:Yi,polygons:function(){var f=this.edges;return this.cells.map(function(h){var l=h.halfedges.map(function(q){return El(h,f[q])});return l.data=h.site.data,l})},triangles:function(){var f=[],h=this.edges;return this.cells.forEach(function(l,
q){if(m=(k=l.halfedges).length)for(var k,m,r,p,u,x=l.site,v=-1,y=h[k[m-1]],B=y.left===x?y.right:y.left;++v<m;)l=B,B=(y=h[k[v]]).left===x?y.right:y.left,l&&B&&q<l.index&&q<B.index&&(p=l,u=B,0>((r=x)[0]-u[0])*(p[1]-r[1])-(r[0]-p[0])*(u[1]-r[1]))&&f.push([x.data,l.data,B.data])}),f},links:function(){return this.edges.filter(function(f){return f.right}).map(function(f){return{source:f.left.data,target:f.right.data}})},find:function(f,h,l){var q,k,m=this,r=m._found||0;for(q=m.cells.length;!(k=m.cells[r]);)if(++r>=
q)return null;q=f-k.site[0];var p=h-k.site[1],u=q*q+p*p;do k=m.cells[q=r],r=null,k.halfedges.forEach(function(x){var v=m.edges[x];x=v.left;if(x!==k.site&&x||(x=v.right)){v=f-x[0];var y=h-x[1];v=v*v+y*y;v<u&&(u=v,r=x.index)}});while(null!==r);return m._found=q,null==l||u<=l*l?k.site:null}};var ip=Object.freeze({__proto__:null,toMercator:Ol,toWgs84:Ql}),Do=function(){for(var f=0,h=0,l=arguments.length;h<l;h++)f+=arguments[h].length;f=Array(f);var q=0;for(h=0;h<l;h++)for(var k=arguments[h],m=0,r=k.length;m<
r;m++,q++)f[q]=k[m];return f},jp=Object.freeze({__proto__:null,randomPosition:Gg,randomPoint:Ul,randomPolygon:Vl,randomLineString:Wl}),kp=Object.freeze({__proto__:null,getCluster:Xl,clusterEach:$i,clusterReduce:Yl,createBins:aj,applyFilter:Kh,propertiesContainsFilter:bj,filterProperties:Zl}),Pe=function(f,h){this.next=null;this.key=f;this.data=h;this.right=this.left=null},Cj=function(){function f(h){void 0===h&&(h=Eo);this._root=null;this._size=0;this._comparator=h}return f.prototype.insert=function(h,
l){return this._size++,this._root=cj(h,l,this._root,this._comparator)},f.prototype.add=function(h,l){l=new Pe(h,l);null===this._root&&(l.left=l.right=null,this._size++,this._root=l);var q=this._comparator,k=Oe(h,this._root,q);h=q(h,k.key);return 0===h?this._root=k:(0>h?(l.left=k.left,l.right=k,k.left=null):0<h&&(l.right=k.right,l.left=k,k.right=null),this._size++,this._root=l),this._root},f.prototype.remove=function(h){this._root=this._remove(h,this._root,this._comparator)},f.prototype._remove=function(h,
l,q){var k;return null===l?null:0===q(h,(l=Oe(h,l,q)).key)?(null===l.left?k=l.right:(k=Oe(h,l.left,q)).right=l.right,this._size--,k):l},f.prototype.pop=function(){var h=this._root;if(h){for(;h.left;)h=h.left;return this._root=Oe(h.key,this._root,this._comparator),this._root=this._remove(h.key,this._root,this._comparator),{key:h.key,data:h.data}}return null},f.prototype.findStatic=function(h){for(var l=this._root,q=this._comparator;l;){var k=q(h,l.key);if(0===k)return l;l=0>k?l.left:l.right}return null},
f.prototype.find=function(h){return this._root&&(this._root=Oe(h,this._root,this._comparator),0!==this._comparator(h,this._root.key))?null:this._root},f.prototype.contains=function(h){for(var l=this._root,q=this._comparator;l;){var k=q(h,l.key);if(0===k)return!0;l=0>k?l.left:l.right}return!1},f.prototype.forEach=function(h,l){for(var q=this._root,k=[],m=!1;!m;)null!==q?(k.push(q),q=q.left):0!==k.length?(q=k.pop(),h.call(l,q),q=q.right):m=!0;return this},f.prototype.range=function(h,l,q,k){for(var m=
[],r=this._comparator,p=this._root;0!==m.length||p;)if(p)m.push(p),p=p.left;else{if(0<r((p=m.pop()).key,l))break;if(0<=r(p.key,h)&&q.call(k,p))break;p=p.right}return this},f.prototype.keys=function(){var h=[];return this.forEach(function(l){return h.push(l.key)}),h},f.prototype.values=function(){var h=[];return this.forEach(function(l){return h.push(l.data)}),h},f.prototype.min=function(){return this._root?this.minNode(this._root).key:null},f.prototype.max=function(){return this._root?this.maxNode(this._root).key:
null},f.prototype.minNode=function(h){if(void 0===h&&(h=this._root),h)for(;h.left;)h=h.left;return h},f.prototype.maxNode=function(h){if(void 0===h&&(h=this._root),h)for(;h.right;)h=h.right;return h},f.prototype.at=function(h){for(var l=this._root,q=!1,k=0,m=[];!q;)if(l)m.push(l),l=l.left;else if(0<m.length){if(l=m.pop(),k===h)return l;k++;l=l.right}else q=!0;return null},f.prototype.next=function(h){var l=this._root,q=null;if(h.right){for(q=h.right;q.left;)q=q.left;return q}for(var k=this._comparator;l;){var m=
k(h.key,l.key);if(0===m)break;0>m?(q=l,l=l.left):l=l.right}return q},f.prototype.prev=function(h){var l=this._root,q=null;if(null!==h.left){for(q=h.left;q.right;)q=q.right;return q}for(var k=this._comparator;l;){var m=k(h.key,l.key);if(0===m)break;0>m?l=l.left:(q=l,l=l.right)}return q},f.prototype.clear=function(){return this._root=null,this._size=0,this},f.prototype.toList=function(){for(var h=this._root,l=[],q=!1,k=new Pe(null,null),m=k;!q;)h?(l.push(h),h=h.left):0<l.length?h=(h=m=m.next=l.pop()).right:
q=!0;return m.next=null,k.next},f.prototype.load=function(h,l,q){void 0===l&&(l=[]);void 0===q&&(q=!1);var k=h.length,m=this._comparator;(q&&gj(h,l,0,k-1,m),null===this._root)?(this._root=ej(h,l,0,k),this._size=k):(h=function(r,p,u){for(var x=new Pe(null,null),v=x;null!==r&&null!==p;)0>u(r.key,p.key)?(v.next=r,r=r.next):(v.next=p,p=p.next),v=v.next;null!==r?v.next=r:null!==p&&(v.next=p);return x.next}(this.toList(),function(r,p){for(var u=new Pe(null,null),x=u,v=0;v<r.length;v++)x=x.next=new Pe(r[v],
p[v]);return x.next=null,u.next}(h,l),m),k=this._size+k,this._root=fj({head:h},0,k));return this},f.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),f.prototype.toString=function(h){void 0===h&&(h=function(q){return String(q.key)});var l=[];return dj(this._root,"",!0,function(q){return l.push(q)},
h),l.join("")},f.prototype.update=function(h,l,q){var k=this._comparator,m=$l(h,this._root,k),r=m.left;m=m.right;0>k(h,l)?m=cj(l,q,m,k):r=cj(l,q,r,k);h=r;l=m;this._root=null===l?h:(null===h||((l=Oe(h.key,l,k)).left=h),l)},f.prototype.split=function(h){return $l(h,this._root,this._comparator)},f}(),Mg=function(f,h){return f.ll.x<=h.x&&h.x<=f.ur.x&&f.ll.y<=h.y&&h.y<=f.ur.y},Dj=function(f,h){return h.ur.x<f.ll.x||f.ur.x<h.ll.x||h.ur.y<f.ll.y||f.ur.y<h.ll.y?null:{ll:{x:f.ll.x<h.ll.x?h.ll.x:f.ll.x,y:f.ll.y<
h.ll.y?h.ll.y:f.ll.y},ur:{x:f.ur.x<h.ur.x?f.ur.x:h.ur.x,y:f.ur.y<h.ur.y?f.ur.y:h.ur.y}}},Se=Number.EPSILON;void 0===Se&&(Se=Math.pow(2,-52));var lp=Se*Se,Ej=function(f,h){if(-Se<f&&f<Se&&-Se<h&&h<Se)return 0;var l=f-h;return l*l<lp*f*h?0:f<h?-1:1},mp=function(){function f(){Ad(this,f);this.reset()}return ed(f,[{key:"reset",value:function(){this.xRounder=new Wm;this.yRounder=new Wm}},{key:"round",value:function(h,l){return{x:this.xRounder.round(h),y:this.yRounder.round(l)}}}]),f}(),Wm=function(){function f(){Ad(this,
f);this.tree=new Cj;this.round(0)}return ed(f,[{key:"round",value:function(h){var l=this.tree.add(h),q=this.tree.prev(l);if(null!==q&&0===Ej(l.key,q.key))return this.tree.remove(h),q.key;q=this.tree.next(l);return null!==q&&0===Ej(l.key,q.key)?(this.tree.remove(h),q.key):h}}]),f}(),Ng=new mp,Og=function(f,h){return f.x*h.y-f.y*h.x},Pg=function(f,h){return f.x*h.x+f.y*h.y},Xm=function(f,h,l){f=Og({x:h.x-f.x,y:h.y-f.y},{x:l.x-f.x,y:l.y-f.y});return Ej(f,0)},Ym=function(f,h,l){return 0===h.y?null:{x:f.x+
h.x/h.y*(l-f.y),y:l}},Zm=function(f,h,l){return 0===h.x?null:{x:l,y:f.y+h.y/h.x*(l-f.x)}},pe=function(){function f(h,l){Ad(this,f);void 0===h.events?h.events=[this]:h.events.push(this);this.point=h;this.isLeft=l}return ed(f,null,[{key:"compare",value:function(h,l){var q=f.comparePoints(h.point,l.point);return 0!==q?q:(h.point!==l.point&&h.link(l),h.isLeft!==l.isLeft?h.isLeft?1:-1:Wh.compare(h.segment,l.segment))}},{key:"comparePoints",value:function(h,l){return h.x<l.x?-1:h.x>l.x?1:h.y<l.y?-1:h.y>
l.y?1:0}}]),ed(f,[{key:"link",value:function(h){if(h.point===this.point)throw Error("Tried to link already linked events");h=h.point.events;for(var l=0,q=h.length;l<q;l++){var k=h[l];this.point.events.push(k);k.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var h=this.point.events.length,l=0;l<h;l++){var q=this.point.events[l];if(void 0===q.segment.consumedBy)for(var k=l+1;k<h;k++){var m=this.point.events[k];void 0===m.consumedBy&&q.otherSE.point.events===
m.otherSE.point.events&&q.segment.consume(m.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var h=[],l=0,q=this.point.events.length;l<q;l++){var k=this.point.events[l];k!==this&&!k.segment.ringOut&&k.segment.isInResult()&&h.push(k)}return h}},{key:"getLeftmostComparator",value:function(h){var l=this,q=new Map,k=function(m){var r,p,u,x,v,y=m.otherSE,B=q.set,G=(r=l.point,p=h.point,u=y.point,x={x:p.x-r.x,y:p.y-r.y},v={x:u.x-r.x,y:u.y-r.y},Og(v,x)/Math.sqrt(Pg(v,v))/Math.sqrt(Pg(x,x)));
r=l.point;p=h.point;y=y.point;p={x:p.x-r.x,y:p.y-r.y};y={x:y.x-r.x,y:y.y-r.y};y=Pg(y,p)/Math.sqrt(Pg(y,y))/Math.sqrt(Pg(p,p));B.call(q,m,{sine:G,cosine:y})};return function(m,r){q.has(m)||k(m);q.has(r)||k(r);var p=q.get(m);m=p.sine;p=p.cosine;var u=q.get(r);r=u.sine;u=u.cosine;return 0<=m&&0<=r?p<u?1:p>u?-1:0:0>m&&0>r?p<u?-1:p>u?1:0:r<m?-1:r>m?1:0}}}]),f}(),np=0,Wh=function(){function f(h,l,q,k){Ad(this,f);this.id=++np;this.leftSE=h;h.segment=this;this.rightSE=h.otherSE=l;l.segment=this;l.otherSE=
h;this.rings=q;this.windings=k}return ed(f,null,[{key:"compare",value:function(h,l){var q=h.leftSE.point.x,k=l.leftSE.point.x,m=h.rightSE.point.x,r=l.rightSE.point.x;if(r<q)return 1;if(m<k)return-1;var p=h.leftSE.point.y,u=l.leftSE.point.y,x=h.rightSE.point.y,v=l.rightSE.point.y;if(q<k){if(u<p&&u<x)return 1;if(u>p&&u>x)return-1;m=h.comparePoint(l.leftSE.point);if(0>m)return 1;if(0<m)return-1;h=l.comparePoint(h.rightSE.point);return 0!==h?h:-1}if(q>k){if(p<u&&p<v)return-1;if(p>u&&p>v)return 1;m=l.comparePoint(h.leftSE.point);
if(0!==m)return m;h=h.comparePoint(l.rightSE.point);return 0>h?1:0<h?-1:1}if(p<u)return-1;if(p>u)return 1;if(m<r){var y=l.comparePoint(h.rightSE.point);if(0!==y)return y}if(m>r){y=h.comparePoint(l.rightSE.point);if(0>y)return 1;if(0<y)return-1}if(m!==r){p=x-p;q=m-q;u=v-u;k=r-k;if(p>q&&u<k)return 1;if(p<q&&u>k)return-1}return m>r?1:m<r||x<v?-1:x>v?1:h.id<l.id?-1:h.id>l.id?1:0}}]),ed(f,[{key:"replaceRightSE",value:function(h){this.rightSE=h;this.rightSE.segment=this;this.rightSE.otherSE=this.leftSE;
this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var h=this.leftSE.point.y,l=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:h<l?h:l},ur:{x:this.rightSE.point.x,y:h>l?h:l}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(h){return h.x===this.leftSE.point.x&&h.y===this.leftSE.point.y||h.x===this.rightSE.point.x&&h.y===this.rightSE.point.y}},{key:"comparePoint",
value:function(h){if(this.isAnEndpoint(h))return 0;var l=this.leftSE.point,q=this.rightSE.point,k=this.vector();if(l.x===q.x)return h.x===l.x?0:h.x<l.x?1:-1;if(h.x===l.x+(h.y-l.y)/k.y*k.x)return 0;l=l.y+(h.x-l.x)/k.x*k.y;return h.y===l?0:h.y<l?-1:1}},{key:"getIntersection",value:function(h){var l=this.bbox(),q=h.bbox(),k=Dj(l,q);if(null===k)return null;var m=this.leftSE.point,r=this.rightSE.point,p=h.leftSE.point,u=h.rightSE.point,x=Mg(l,p)&&0===this.comparePoint(p),v=Mg(q,m)&&0===h.comparePoint(m);
l=Mg(l,u)&&0===this.comparePoint(u);q=Mg(q,r)&&0===h.comparePoint(r);if(v&&x)return q&&!l?r:!q&&l?u:null;if(v)return l&&m.x===u.x&&m.y===u.y?null:m;if(x)return q&&r.x===p.x&&r.y===p.y?null:p;if(q&&l)return null;if(q)return r;if(l)return u;h=function(y,B,G,A){if(0===B.x)return Zm(G,A,y.x);if(0===A.x)return Zm(y,B,G.x);if(0===B.y)return Ym(G,A,y.y);if(0===A.y)return Ym(y,B,G.y);var F=Og(B,A);if(0==F)return null;var J={x:G.x-y.x,y:G.y-y.y},D=Og(J,B)/F;F=Og(J,A)/F;return{x:(y.x+F*B.x+(G.x+D*A.x))/2,y:(y.y+
F*B.y+(G.y+D*A.y))/2}}(m,this.vector(),p,h.vector());return null===h?null:Mg(k,h)?Ng.round(h.x,h.y):null}},{key:"split",value:function(h){var l=[],q=void 0!==h.events,k=new pe(h,!0);h=new pe(h,!1);var m=this.rightSE;this.replaceRightSE(h);l.push(h);l.push(k);m=new f(k,m,this.rings.slice(),this.windings.slice());return 0<pe.comparePoints(m.leftSE.point,m.rightSE.point)&&m.swapEvents(),0<pe.comparePoints(this.leftSE.point,this.rightSE.point)&&this.swapEvents(),q&&(k.checkForConsuming(),h.checkForConsuming()),
l}},{key:"swapEvents",value:function(){var h=this.rightSE;this.rightSE=this.leftSE;this.leftSE=h;this.leftSE.isLeft=!0;this.rightSE.isLeft=!1;h=0;for(var l=this.windings.length;h<l;h++)this.windings[h]*=-1}},{key:"consume",value:function(h){for(var l=this;l.consumedBy;)l=l.consumedBy;for(;h.consumedBy;)h=h.consumedBy;var q=f.compare(l,h);if(0!==q){0<q&&(q=l,l=h,h=q);l.prev===h&&(q=l,l=h,h=q);q=0;for(var k=h.rings.length;q<k;q++){var m=h.rings[q],r=h.windings[q],p=l.rings.indexOf(m);-1===p?(l.rings.push(m),
l.windings.push(r)):l.windings[p]+=r}h.rings=null;h.windings=null;h.consumedBy=l;h.leftSE.consumedBy=l.leftSE;h.rightSE.consumedBy=l.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState?this._beforeState:this._beforeState=this.prev?(this.prev.consumedBy||
this.prev).afterState():{rings:[],windings:[],multiPolys:[]}}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var h=this.beforeState();this._afterState={rings:h.rings.slice(0),windings:h.windings.slice(0),multiPolys:[]};var l=this._afterState.rings,q=this._afterState.windings;h=this._afterState.multiPolys;for(var k=0,m=this.rings.length;k<m;k++){var r=this.rings[k],p=this.windings[k],u=l.indexOf(r);-1===u?(l.push(r),q.push(p)):q[u]+=p}k=[];m=[];r=0;for(p=l.length;r<
p;r++)if(0!==q[r]){u=l[r];var x=u.poly;-1===m.indexOf(x)&&(u.isExterior?k.push(x):(-1===m.indexOf(x)&&m.push(x),u=k.indexOf(u.poly),-1!==u&&k.splice(u,1)))}l=0;for(q=k.length;l<q;l++)m=k[l].multiPoly,-1===h.indexOf(m)&&h.push(m);return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var h=this.beforeState().multiPolys,l=this.afterState().multiPolys;switch(Vd.type){case "union":this._isInResult=0===h.length!==(0===
l.length);break;case "intersection":var q,k;h.length<l.length?(q=h.length,k=l.length):(q=l.length,k=h.length);this._isInResult=k===Vd.numMultiPolys&&q<k;break;case "xor":this._isInResult=1==Math.abs(h.length-l.length)%2;break;case "difference":this._isInResult=(1===h.length&&h[0].isSubject)!==(1===l.length&&l[0].isSubject);break;default:throw Error("Unrecognized operation type found ".concat(Vd.type));}return this._isInResult}}],[{key:"fromRing",value:function(h,l,q){var k=pe.comparePoints(h,l);if(0>
k)k=h,h=l,l=1;else{if(!(0<k))throw Error("Tried to create degenerate segment at [".concat(h.x,", ").concat(h.y,"]"));k=l;l=-1}return new f(new pe(k,!0),new pe(h,!1),[q],[l])}}]),f}(),$m=function(){function f(h,l,q){if(Ad(this,f),!Array.isArray(h)||0===h.length)throw Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=l,this.isExterior=q,this.segments=[],"number"!=typeof h[0][0]||"number"!=typeof h[0][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");l=
Ng.round(h[0][0],h[0][1]);this.bbox={ll:{x:l.x,y:l.y},ur:{x:l.x,y:l.y}};q=l;for(var k=1,m=h.length;k<m;k++){if("number"!=typeof h[k][0]||"number"!=typeof h[k][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");var r=Ng.round(h[k][0],h[k][1]);r.x===q.x&&r.y===q.y||(this.segments.push(Wh.fromRing(q,r,this)),r.x<this.bbox.ll.x&&(this.bbox.ll.x=r.x),r.y<this.bbox.ll.y&&(this.bbox.ll.y=r.y),r.x>this.bbox.ur.x&&(this.bbox.ur.x=r.x),r.y>this.bbox.ur.y&&(this.bbox.ur.y=r.y),q=r)}l.x===
q.x&&l.y===q.y||this.segments.push(Wh.fromRing(q,l,this))}return ed(f,[{key:"getSweepEvents",value:function(){for(var h=[],l=0,q=this.segments.length;l<q;l++){var k=this.segments[l];h.push(k.leftSE);h.push(k.rightSE)}return h}}]),f}(),op=function(){function f(h,l){if(Ad(this,f),!Array.isArray(h))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new $m(h[0],this,!0);this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,
y:this.exteriorRing.bbox.ur.y}};this.interiorRings=[];for(var q=1,k=h.length;q<k;q++){var m=new $m(h[q],this,!1);m.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=m.bbox.ll.x);m.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=m.bbox.ll.y);m.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=m.bbox.ur.x);m.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=m.bbox.ur.y);this.interiorRings.push(m)}this.multiPoly=l}return ed(f,[{key:"getSweepEvents",value:function(){for(var h=this.exteriorRing.getSweepEvents(),l=0,q=this.interiorRings.length;l<
q;l++)for(var k=this.interiorRings[l].getSweepEvents(),m=0,r=k.length;m<r;m++)h.push(k[m]);return h}}]),f}(),an=function(){function f(h,l){if(Ad(this,f),!Array.isArray(h))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof h[0][0][0]&&(h=[h])}catch(r){}this.polys=[];this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var q=0,k=h.length;q<k;q++){var m=new op(h[q],this);m.bbox.ll.x<
this.bbox.ll.x&&(this.bbox.ll.x=m.bbox.ll.x);m.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=m.bbox.ll.y);m.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=m.bbox.ur.x);m.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=m.bbox.ur.y);this.polys.push(m)}this.isSubject=l}return ed(f,[{key:"getSweepEvents",value:function(){for(var h=[],l=0,q=this.polys.length;l<q;l++)for(var k=this.polys[l].getSweepEvents(),m=0,r=k.length;m<r;m++)h.push(k[m]);return h}}]),f}(),pp=function(){function f(h){Ad(this,f);this.events=h;for(var l=
0,q=h.length;l<q;l++)h[l].segment.ringOut=this;this.poly=null}return ed(f,null,[{key:"factory",value:function(h){for(var l=[],q=0,k=h.length;q<k;q++){var m=h[q];if(m.isInResult()&&!m.ringOut){var r,p=m.leftSE,u=m.rightSE;m=[p];for(var x=p.point,v=[];r=p,p=u,m.push(p),p.point!==x;)for(;;){u=p.getAvailableLinkedEvents();if(0===u.length)throw h=m[0].point,l=m[m.length-1].point,Error("Unable to complete output ring starting at [".concat(h.x,",")+" ".concat(h.y,"]. Last matching segment found ends at")+
" [".concat(l.x,", ").concat(l.y,"]."));if(1===u.length){u=u[0].otherSE;break}for(var y=null,B=0,G=v.length;B<G;B++)if(v[B].point===p.point){y=B;break}if(null===y){v.push({index:m.length,point:p.point});r=p.getLeftmostComparator(r);u=u.sort(r)[0].otherSE;break}u=v.splice(y)[0];u=m.splice(u.index);u.unshift(u[0].otherSE);l.push(new f(u.reverse()))}l.push(new f(m))}}return l}}]),ed(f,[{key:"getGeom",value:function(){for(var h=this.events[0].point,l=[h],q=1,k=this.events.length-1;q<k;q++){var m=this.events[q].point;
0!==Xm(m,h,this.events[q+1].point)&&(l.push(m),h=m)}if(1===l.length)return null;0===Xm(l[0],h,l[1])&&l.shift();l.push(l[0]);h=this.isExteriorRing()?1:-1;m=this.isExteriorRing()?0:l.length-1;q=this.isExteriorRing()?l.length:-1;for(k=[];m!=q;m+=h)k.push([l[m].x,l[m].y]);return k}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var h=this.enclosingRing();this._isExteriorRing=!h||!h.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===
this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var h=this.events[0],l=1,q=this.events.length;l<q;l++){var k=this.events[l];0<pe.compare(h,k)&&(h=k)}for(l=(h=h.segment.prevInResult())?h.prevInResult():null;;){if(!h)return null;if(!l)return h.ringOut;if(l.ringOut!==h.ringOut)return l.ringOut.enclosingRing()!==h.ringOut?h.ringOut:h.ringOut.enclosingRing();l=(h=l.prevInResult())?h.prevInResult():null}}}]),f}(),
bn=function(){function f(h){Ad(this,f);this.exteriorRing=h;h.poly=this;this.interiorRings=[]}return ed(f,[{key:"addInterior",value:function(h){this.interiorRings.push(h);h.poly=this}},{key:"getGeom",value:function(){var h=[this.exteriorRing.getGeom()];if(null===h[0])return null;for(var l=0,q=this.interiorRings.length;l<q;l++){var k=this.interiorRings[l].getGeom();null!==k&&h.push(k)}return h}}]),f}(),qp=function(){function f(h){Ad(this,f);this.rings=h;this.polys=this._composePolys(h)}return ed(f,
[{key:"getGeom",value:function(){for(var h=[],l=0,q=this.polys.length;l<q;l++){var k=this.polys[l].getGeom();null!==k&&h.push(k)}return h}},{key:"_composePolys",value:function(h){for(var l=[],q=0,k=h.length;q<k;q++){var m=h[q];if(!m.poly)if(m.isExteriorRing())l.push(new bn(m));else{var r=m.enclosingRing();r.poly||l.push(new bn(r));r.poly.addInterior(m)}}return l}}]),f}(),rp=function(){function f(h){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Wh.compare;Ad(this,f);this.queue=h;this.tree=
new Cj(l);this.segments=[]}return ed(f,[{key:"process",value:function(h){var l=h.segment,q=[];if(h.consumedBy)return h.isLeft?this.queue.remove(h.otherSE):this.tree.remove(l),q;var k=h.isLeft?this.tree.insert(l):this.tree.find(l);if(!k)throw Error("Unable to find segment #".concat(l.id," ")+"[".concat(l.leftSE.point.x,", ").concat(l.leftSE.point.y,"] -> ")+"[".concat(l.rightSE.point.x,", ").concat(l.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var m=k,r=k,p=k=void 0;void 0===
k;)null===(m=this.tree.prev(m))?k=null:void 0===m.key.consumedBy&&(k=m.key);for(;void 0===p;)null===(r=this.tree.next(r))?p=null:void 0===r.key.consumedBy&&(p=r.key);if(h.isLeft){m=null;if(k&&(r=k.getIntersection(l),null!==r&&(l.isAnEndpoint(r)||(m=r),!k.isAnEndpoint(r)))){r=this._splitSafely(k,r);for(var u=0,x=r.length;u<x;u++)q.push(r[u])}r=null;if(p&&(u=p.getIntersection(l),null!==u&&(l.isAnEndpoint(u)||(r=u),!p.isAnEndpoint(u))))for(p=this._splitSafely(p,u),u=0,x=p.length;u<x;u++)q.push(p[u]);
if(null!==m||null!==r)for(p=null===m?r:null===r?m:0>=pe.comparePoints(m,r)?m:r,this.queue.remove(l.rightSE),q.push(l.rightSE),p=l.split(p),m=0,r=p.length;m<r;m++)q.push(p[m]);0<q.length?(this.tree.remove(l),q.push(h)):(this.segments.push(l),l.prev=k)}else{if(k&&p&&(h=k.getIntersection(p),null!==h)){if(!k.isAnEndpoint(h))for(k=this._splitSafely(k,h),m=0,r=k.length;m<r;m++)q.push(k[m]);if(!p.isAnEndpoint(h))for(h=this._splitSafely(p,h),k=0,p=h.length;k<p;k++)q.push(h[k])}this.tree.remove(l)}return q}},
{key:"_splitSafely",value:function(h,l){this.tree.remove(h);var q=h.rightSE;this.queue.remove(q);l=h.split(l);return l.push(q),void 0===h.consumedBy&&this.tree.insert(h),l}}]),f}(),cn="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1E6,sp="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1E6,Vd=new (function(){function f(){Ad(this,f)}return ed(f,[{key:"run",value:function(h,l,q){Vd.type=h;Ng.reset();h=[new an(l,!0)];l=0;for(var k=q.length;l<
k;l++)h.push(new an(q[l],!1));if(Vd.numMultiPolys=h.length,"difference"===Vd.type)for(q=h[0],l=1;l<h.length;)null!==Dj(h[l].bbox,q.bbox)?l++:h.splice(l,1);if("intersection"===Vd.type)for(q=0,l=h.length;q<l;q++){k=h[q];for(var m=q+1,r=h.length;m<r;m++)if(null===Dj(k.bbox,h[m].bbox))return[]}q=new Cj(pe.compare);l=0;for(k=h.length;l<k;l++){m=h[l].getSweepEvents();r=0;for(var p=m.length;r<p;r++)if(q.insert(m[r]),q.size>cn)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");
}h=new rp(q);l=q.size;for(k=q.pop();k;){k=k.key;if(q.size===l)throw h=k.segment,Error("Unable to pop() ".concat(k.isLeft?"left":"right"," SweepEvent ")+"[".concat(k.point.x,", ").concat(k.point.y,"] from segment #").concat(h.id," ")+"[".concat(h.leftSE.point.x,", ").concat(h.leftSE.point.y,"] -> ")+"[".concat(h.rightSE.point.x,", ").concat(h.rightSE.point.y,"] from queue. ")+"Please file a bug report.");if(q.size>cn)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");
if(h.segments.length>sp)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");l=h.process(k);k=0;for(m=l.length;k<m;k++)r=l[k],void 0===r.consumedBy&&q.insert(r);l=q.size;k=q.pop()}Ng.reset();h=pp.factory(h.segments);return(new qp(h)).getGeom()}}]),f}()),De={union:function(f){for(var h=arguments.length,l=Array(1<h?h-1:0),q=1;q<h;q++)l[q-1]=arguments[q];return Vd.run("union",f,l)},intersection:function(f){for(var h=arguments.length,
l=Array(1<h?h-1:0),q=1;q<h;q++)l[q-1]=arguments[q];return Vd.run("intersection",f,l)},xor:function(f){for(var h=arguments.length,l=Array(1<h?h-1:0),q=1;q<h;q++)l[q-1]=arguments[q];return Vd.run("xor",f,l)},difference:function(f){for(var h=arguments.length,l=Array(1<h?h-1:0),q=1;q<h;q++)l[q-1]=arguments[q];return Vd.run("difference",f,l)}};"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(f){if(null==this)throw new TypeError(this+" is not an object");
var h=Object(this),l=Math.max(Math.min(h.length,9007199254740991),0)||0,q=1 in arguments&&parseInt(Number(arguments[1]),10)||0;q=0>q?Math.max(l+q,0):Math.min(q,l);var k=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:l;for(k=0>k?Math.max(l+arguments[2],0):Math.min(k,l);q<k;)h[q]=f,++q;return h},writable:!0});Number.isFinite=Number.isFinite||function(f){return"number"==typeof f&&isFinite(f)};Number.isInteger=Number.isInteger||function(f){return"number"==typeof f&&isFinite(f)&&
Math.floor(f)===f};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(f){return f!=f};Math.trunc=Math.trunc||function(f){return 0>f?Math.ceil(f):Math.floor(f)};var nf=function(){};nf.prototype.interfaces_=function(){return[]};nf.prototype.getClass=function(){return nf};nf.prototype.equalsWithTolerance=function(f,h,l){return Math.abs(f-h)<=l};var cc=function(f){function h(l){f.call(this,l);this.name="IllegalArgumentException";this.message=l;this.stack=(new f).stack}
return f&&(h.__proto__=f),h.prototype=Object.create(f&&f.prototype),h.prototype.constructor=h,h}(Error),Za=function(){},dn={MAX_VALUE:{configurable:!0}};Za.isNaN=function(f){return Number.isNaN(f)};Za.doubleToLongBits=function(f){return f};Za.longBitsToDouble=function(f){return f};Za.isInfinite=function(f){return!Number.isFinite(f)};dn.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Za,dn);var md=function(){},Xh=function(){},Rf=function(){},ua=function h(){if(this.x=null,
this.y=null,this.z=null,0===arguments.length)this.y=this.x=0,this.z=h.NULL_ORDINATE;else if(1===arguments.length){var l=arguments[0];this.x=l.x;this.y=l.y;this.z=l.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=h.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},of={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};
ua.prototype.setOrdinate=function(h,l){switch(h){case ua.X:this.x=l;break;case ua.Y:this.y=l;break;case ua.Z:this.z=l;break;default:throw new cc("Invalid ordinate index: "+h);}};ua.prototype.equals2D=function(){if(1===arguments.length){var h=arguments[0];return this.x===h.x&&this.y===h.y}if(2===arguments.length){h=arguments[0];var l=arguments[1];return!!nf.equalsWithTolerance(this.x,h.x,l)&&!!nf.equalsWithTolerance(this.y,h.y,l)}};ua.prototype.getOrdinate=function(h){switch(h){case ua.X:return this.x;
case ua.Y:return this.y;case ua.Z:return this.z}throw new cc("Invalid ordinate index: "+h);};ua.prototype.equals3D=function(h){return this.x===h.x&&this.y===h.y&&(this.z===h.z||Za.isNaN(this.z))&&Za.isNaN(h.z)};ua.prototype.equals=function(h){return h instanceof ua&&this.equals2D(h)};ua.prototype.equalInZ=function(h,l){return nf.equalsWithTolerance(this.z,h.z,l)};ua.prototype.compareTo=function(h){return this.x<h.x?-1:this.x>h.x?1:this.y<h.y?-1:this.y>h.y?1:0};ua.prototype.clone=function(){};ua.prototype.copy=
function(){return new ua(this)};ua.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};ua.prototype.distance3D=function(h){var l=this.x-h.x,q=this.y-h.y;h=this.z-h.z;return Math.sqrt(l*l+q*q+h*h)};ua.prototype.distance=function(h){var l=this.x-h.x;h=this.y-h.y;return Math.sqrt(l*l+h*h)};ua.prototype.hashCode=function(){return 37*(629+ua.hashCode(this.x))+ua.hashCode(this.y)};ua.prototype.setCoordinate=function(h){this.x=h.x;this.y=h.y;this.z=h.z};ua.prototype.interfaces_=function(){return[md,
Xh,ld]};ua.prototype.getClass=function(){return ua};ua.hashCode=function(){if(1===arguments.length){var h=Za.doubleToLongBits(arguments[0]);return Math.trunc((h^h)>>>32)}};of.DimensionalComparator.get=function(){return Ee};of.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800};of.NULL_ORDINATE.get=function(){return Za.NaN};of.X.get=function(){return 0};of.Y.get=function(){return 1};of.Z.get=function(){return 2};Object.defineProperties(ua,of);var Ee=function(h){if((this._dimensionsToTest=2,
0!==arguments.length)&&1===arguments.length){var l=arguments[0];if(2!==l&&3!==l)throw new cc("only 2 or 3 dimensions may be specified");this._dimensionsToTest=l}};Ee.prototype.compare=function(h,l){var q=Ee.compare(h.x,l.x);if(0!==q)return q;q=Ee.compare(h.y,l.y);return 0!==q?q:2>=this._dimensionsToTest?0:Ee.compare(h.z,l.z)};Ee.prototype.interfaces_=function(){return[Rf]};Ee.prototype.getClass=function(){return Ee};Ee.compare=function(h,l){return h<l?-1:h>l?1:Za.isNaN(h)?Za.isNaN(l)?0:-1:Za.isNaN(l)?
1:0};var Sf=function(){};Sf.prototype.create=function(){};Sf.prototype.interfaces_=function(){return[]};Sf.prototype.getClass=function(){return Sf};var va=function(){},Qg={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};va.prototype.interfaces_=function(){return[]};va.prototype.getClass=function(){return va};va.toLocationSymbol=function(h){switch(h){case va.EXTERIOR:return"e";case va.BOUNDARY:return"b";case va.INTERIOR:return"i";case va.NONE:return"-"}throw new cc("Unknown location value: "+
h);};Qg.INTERIOR.get=function(){return 0};Qg.BOUNDARY.get=function(){return 1};Qg.EXTERIOR.get=function(){return 2};Qg.NONE.get=function(){return-1};Object.defineProperties(va,Qg);var Xa=function(h,l){return h.interfaces_&&-1<h.interfaces_().indexOf(l)},fd=function(){},en={LOG_10:{configurable:!0}};fd.prototype.interfaces_=function(){return[]};fd.prototype.getClass=function(){return fd};fd.log10=function(h){h=Math.log(h);return Za.isInfinite(h)||Za.isNaN(h)?h:h/fd.LOG_10};fd.min=function(h,l,q,k){return l<
h&&(h=l),q<h&&(h=q),k<h&&(h=k),h};fd.clamp=function(h,l,q){if("number"==typeof q&&"number"==typeof h&&"number"==typeof l||Number.isInteger(q)&&Number.isInteger(h)&&Number.isInteger(l))return h<l?l:h>q?q:h};fd.wrap=function(h,l){return 0>h?l- -h%l:h%l};fd.max=function(){if(3===arguments.length){var h=arguments[1],l=arguments[2],q=arguments[0];return h>q&&(q=h),l>q&&(q=l),q}if(4===arguments.length){h=arguments[1];l=arguments[2];q=arguments[3];var k=arguments[0];return h>k&&(k=h),l>k&&(k=l),q>k&&(k=
q),k}};fd.average=function(h,l){return(h+l)/2};en.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(fd,en);var Ed=function(h){this.str=h};Ed.prototype.append=function(h){this.str+=h};Ed.prototype.setCharAt=function(h,l){this.str=this.str.substr(0,h)+l+this.str.substr(h+1)};Ed.prototype.toString=function(h){return this.str};var Fd=function(h){this.value=h};Fd.prototype.intValue=function(){return this.value};Fd.prototype.compareTo=function(h){return this.value<h?-1:this.value>h?1:0};
Fd.isNaN=function(h){return Number.isNaN(h)};var Rg=function(){};Rg.isWhitespace=function(h){return 32>=h&&0<=h||127===h};Rg.toUpperCase=function(h){return h.toUpperCase()};var wa=function l(){(this._hi=0,this._lo=0,0===arguments.length)?this.init(0):1===arguments.length?"number"==typeof arguments[0]?this.init(arguments[0]):arguments[0]instanceof l?this.init(arguments[0]):"string"==typeof arguments[0]&&l.call(this,l.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},
td={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};wa.prototype.le=function(l){return(this._hi<l._hi||this._hi===l._hi)&&this._lo<=l._lo};wa.prototype.extractSignificantDigits=function(l,q){var k=this.abs(),m=wa.magnitude(k._hi),r=wa.TEN.pow(m);
(k=k.divide(r)).gt(wa.TEN)?(k=k.divide(wa.TEN),m+=1):k.lt(wa.ONE)&&(k=k.multiply(wa.TEN),--m);r=m+1;for(var p=new Ed,u=wa.MAX_PRINT_DIGITS-1,x=0;x<=u;x++){l&&x===r&&p.append(".");var v=Math.trunc(k._hi);if(0>v)break;var y=!1,B=0;9<v?(y=!0,B="9"):B="0"+v;p.append(B);k=k.subtract(wa.valueOf(v)).multiply(wa.TEN);y&&k.selfAdd(wa.TEN);v=!0;y=wa.magnitude(k._hi);if(0>y&&Math.abs(y)>=u-x&&(v=!1),!v)break}return q[0]=m,p.toString()};wa.prototype.sqr=function(){return this.multiply(this)};wa.prototype.doubleValue=
function(){return this._hi+this._lo};wa.prototype.subtract=function(l){if(l instanceof wa)return this.add(l.negate());if("number"==typeof l)return this.add(-l)};wa.prototype.equals=function(){if(1===arguments.length){var l=arguments[0];return this._hi===l._hi&&this._lo===l._lo}};wa.prototype.isZero=function(){return 0===this._hi&&0===this._lo};wa.prototype.selfSubtract=function(l){if(l instanceof wa)return this.isNaN()?this:this.selfAdd(-l._hi,-l._lo);if("number"==typeof l)return this.isNaN()?this:
this.selfAdd(-l,0)};wa.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};wa.prototype.min=function(l){return this.le(l)?this:l};wa.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof wa){var l=arguments[0];return this.selfDivide(l._hi,l._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){l=arguments[0];var q=arguments[1],k=null,m=null,r=null,p=null,u=null,x=null,v=null,
y=null;return u=this._hi/l,y=(k=(x=wa.SPLIT*u)-(k=x-u))*(r=(y=wa.SPLIT*l)-(r=y-l))-(v=u*l)+k*(p=l-r)+(m=u-k)*r+m*p,y=u+(x=(this._hi-v-y+this._lo-u*q)/l),this._hi=y,this._lo=u-y+x,this}};wa.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};wa.prototype.divide=function(l){if(l instanceof wa){var q,k=null,m=null,r=null,p=null,u=null;var x=(r=this._hi/l._hi)-(q=(p=wa.SPLIT*r)-(q=p-r));u=q*(k=(u=wa.SPLIT*l._hi)-(k=u-l._hi))-(p=r*l._hi)+q*(m=l._hi-k)+x*k+x*m;l=u=r+(p=(this._hi-p-u+this._lo-
r*l._lo)/l._hi);return new wa(l,r-u+p)}if("number"==typeof l)return Za.isNaN(l)?wa.createNaN():wa.copy(this).selfDivide(l,0)};wa.prototype.ge=function(l){return(this._hi>l._hi||this._hi===l._hi)&&this._lo>=l._lo};wa.prototype.pow=function(l){if(0===l)return wa.valueOf(1);var q=new wa(this),k=wa.valueOf(1),m=Math.abs(l);if(1<m)for(;0<m;)1==m%2&&k.selfMultiply(q),0<(m/=2)&&(q=q.sqr());else k=q;return 0>l?k.reciprocal():k};wa.prototype.ceil=function(){if(this.isNaN())return wa.NaN;var l=Math.ceil(this._hi),
q=0;return l===this._hi&&(q=Math.ceil(this._lo)),new wa(l,q)};wa.prototype.compareTo=function(l){return this._hi<l._hi?-1:this._hi>l._hi?1:this._lo<l._lo?-1:this._lo>l._lo?1:0};wa.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()};wa.prototype.setValue=function(l){if(l instanceof wa||"number"==typeof l)return this.init(l),this};wa.prototype.max=function(l){return this.ge(l)?this:l};wa.prototype.sqrt=function(){if(this.isZero())return wa.valueOf(0);if(this.isNegative())return wa.NaN;
var l=1/Math.sqrt(this._hi),q=wa.valueOf(this._hi*l);l*=.5*this.subtract(q.sqr())._hi;return q.add(l)};wa.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof wa){var l=arguments[0];return this.selfAdd(l._hi,l._lo)}if("number"==typeof arguments[0]){l=arguments[0];var q=null,k=null,m=null,r=null,p=null,u=null;return r=(m=this._hi+l)-(p=m-this._hi),k=(u=l-p+(this._hi-r)+this._lo)+(m-(q=m+u)),this._hi=q+k,this._lo=k+(q-this._hi),this}}else if(2===arguments.length){u=arguments[0];
l=arguments[1];q=null;m=this._hi+u;var x=this._lo+l;var v=m-(r=m-this._hi);k=x-(p=x-this._lo);u=(q=m+(r=u-r+(this._hi-v)+x))+(r=l-p+(this._lo-k)+(r+(m-q)));return this._hi=u,this._lo=r+(q-u),this}};wa.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof wa){var l=arguments[0];return this.selfMultiply(l._hi,l._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){l=arguments[0];var q=arguments[1],k=null,m;var r=(m=
wa.SPLIT*this._hi)-this._hi;var p=wa.SPLIT*l;r=m-r;var u=this._hi-r;var x=p-l;var v=(m=this._hi*l)+(p=r*(x=p-x)-m+r*(k=l-x)+u*x+u*k+(this._hi*q+this._lo*l));return this._hi=v,this._lo=p+(m-v),this}};wa.prototype.selfSqr=function(){return this.selfMultiply(this)};wa.prototype.floor=function(){if(this.isNaN())return wa.NaN;var l=Math.floor(this._hi),q=0;return l===this._hi&&(q=Math.floor(this._lo)),new wa(l,q)};wa.prototype.negate=function(){return this.isNaN()?this:new wa(-this._hi,-this._lo)};wa.prototype.clone=
function(){};wa.prototype.multiply=function(l){if(l instanceof wa)return l.isNaN()?wa.createNaN():wa.copy(this).selfMultiply(l);if("number"==typeof l)return Za.isNaN(l)?wa.createNaN():wa.copy(this).selfMultiply(l,0)};wa.prototype.isNaN=function(){return Za.isNaN(this._hi)};wa.prototype.intValue=function(){return Math.trunc(this._hi)};wa.prototype.toString=function(){var l=wa.magnitude(this._hi);return-3<=l&&20>=l?this.toStandardNotation():this.toSciNotation()};wa.prototype.toStandardNotation=function(){var l=
this.getSpecialNumberString();if(null!==l)return l;var q=Array(1).fill(null);l=this.extractSignificantDigits(!0,q);q=q[0]+1;var k=l;"."===l.charAt(0)?k="0"+l:0>q?k="0."+wa.stringOfChar("0",-q)+l:-1===l.indexOf(".")&&(k=l+wa.stringOfChar("0",q-l.length)+".0");return this.isNegative()?"-"+k:k};wa.prototype.reciprocal=function(){var l,q,k,m,r=null,p;var u=(q=1/this._hi)-(m=(r=wa.SPLIT*q)-(m=r-q));var x=(p=wa.SPLIT*this._hi)-this._hi;var v=q+(r=(1-(k=q*this._hi)-(m*(x=p-x)-k+m*(l=this._hi-x)+u*x+u*l)-
q*this._lo)/this._hi);return new wa(v,q-v+r)};wa.prototype.toSciNotation=function(){if(this.isZero())return wa.SCI_NOT_ZERO;var l=this.getSpecialNumberString();if(null!==l)return l;var q=Array(1).fill(null);l=this.extractSignificantDigits(!1,q);q=wa.SCI_NOT_EXPONENT_CHAR+q[0];if("0"===l.charAt(0))throw Error("Found leading zero: "+l);var k="";1<l.length&&(k=l.substring(1));l=l.charAt(0)+"."+k;return this.isNegative()?"-"+l+q:l+q};wa.prototype.abs=function(){return this.isNaN()?wa.NaN:this.isNegative()?
this.negate():new wa(this)};wa.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo};wa.prototype.lt=function(l){return(this._hi<l._hi||this._hi===l._hi)&&this._lo<l._lo};wa.prototype.add=function(l){if(l instanceof wa||"number"==typeof l)return wa.copy(this).selfAdd(l)};wa.prototype.init=function(){if(1===arguments.length)if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else{if(arguments[0]instanceof wa){var l=arguments[0];this._hi=l._hi;this._lo=l._lo}}else 2===
arguments.length&&(l=arguments[1],this._hi=arguments[0],this._lo=l)};wa.prototype.gt=function(l){return(this._hi>l._hi||this._hi===l._hi)&&this._lo>l._lo};wa.prototype.isNegative=function(){return(0>this._hi||0===this._hi)&&0>this._lo};wa.prototype.trunc=function(){return this.isNaN()?wa.NaN:this.isPositive()?this.floor():this.ceil()};wa.prototype.signum=function(){return 0<this._hi?1:0>this._hi?-1:0<this._lo?1:0>this._lo?-1:0};wa.prototype.interfaces_=function(){return[ld,md,Xh]};wa.prototype.getClass=
function(){return wa};wa.sqr=function(l){return wa.valueOf(l).selfMultiply(l)};wa.valueOf=function(l){if("string"==typeof l)return wa.parse(l);if("number"==typeof l)return new wa(l)};wa.sqrt=function(l){return wa.valueOf(l).sqrt()};wa.parse=function(l){for(var q=0,k=l.length;Rg.isWhitespace(l.charAt(q));)q++;var m=!1;if(q<k){var r=l.charAt(q);"-"!==r&&"+"!==r||(q++,"-"===r&&(m=!0))}r=new wa;for(var p=0,u=0,x=0;!(q>=k);){var v=l.charAt(q);if(q++,Rg.isDigit(v))v-=0,r.selfMultiply(wa.TEN),r.selfAdd(v),
p++;else{if("."!==v){if("e"===v||"E"===v){q=l.substring(q);try{x=Fd.parseInt(q)}catch(y){throw y instanceof Error?Error("Invalid exponent "+q+" in string "+l):y;}break}throw Error("Unexpected character '"+v+"' at position "+q+" in string "+l);}u=p}}l=r;p=p-u-x;0===p?l=r:0<p?(l=wa.TEN.pow(p),l=r.divide(l)):0>p&&(l=wa.TEN.pow(-p),l=r.multiply(l));return m?l.negate():l};wa.createNaN=function(){return new wa(Za.NaN,Za.NaN)};wa.copy=function(l){return new wa(l)};wa.magnitude=function(l){l=Math.abs(l);
var q=Math.trunc(Math.floor(Math.log(l)/Math.log(10)));return 10*Math.pow(10,q)<=l&&(q+=1),q};wa.stringOfChar=function(l,q){for(var k=new Ed,m=0;m<q;m++)k.append(l);return k.toString()};td.PI.get=function(){return new wa(3.141592653589793,1.2246467991473532E-16)};td.TWO_PI.get=function(){return new wa(6.283185307179586,2.4492935982947064E-16)};td.PI_2.get=function(){return new wa(1.5707963267948966,6.123233995736766E-17)};td.E.get=function(){return new wa(2.718281828459045,1.4456468917292502E-16)};
td.NaN.get=function(){return new wa(Za.NaN,Za.NaN)};td.EPS.get=function(){return 1.23259516440783E-32};td.SPLIT.get=function(){return 134217729};td.MAX_PRINT_DIGITS.get=function(){return 32};td.TEN.get=function(){return wa.valueOf(10)};td.ONE.get=function(){return wa.valueOf(1)};td.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};td.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(wa,td);var Zc=function(){},fn={DP_SAFE_EPSILON:{configurable:!0}};Zc.prototype.interfaces_=function(){return[]};
Zc.prototype.getClass=function(){return Zc};Zc.orientationIndex=function(l,q,k){var m=Zc.orientationIndexFilter(l,q,k);if(1>=m)return m;m=wa.valueOf(q.x).selfAdd(-l.x);l=wa.valueOf(q.y).selfAdd(-l.y);var r=wa.valueOf(k.x).selfAdd(-q.x);q=wa.valueOf(k.y).selfAdd(-q.y);return m.selfMultiply(q).selfSubtract(l.selfMultiply(r)).signum()};Zc.signOfDet2x2=function(l,q,k,m){return l.multiply(m).selfSubtract(q.multiply(k)).signum()};Zc.intersection=function(l,q,k,m){var r=wa.valueOf(m.y).selfSubtract(k.y).selfMultiply(wa.valueOf(q.x).selfSubtract(l.x)),
p=wa.valueOf(m.x).selfSubtract(k.x).selfMultiply(wa.valueOf(q.y).selfSubtract(l.y));r=r.subtract(p);p=wa.valueOf(m.x).selfSubtract(k.x).selfMultiply(wa.valueOf(l.y).selfSubtract(k.y));var u=wa.valueOf(m.y).selfSubtract(k.y).selfMultiply(wa.valueOf(l.x).selfSubtract(k.x));p=p.subtract(u).selfDivide(r).doubleValue();p=wa.valueOf(l.x).selfAdd(wa.valueOf(q.x).selfSubtract(l.x).selfMultiply(p)).doubleValue();u=wa.valueOf(q.x).selfSubtract(l.x).selfMultiply(wa.valueOf(l.y).selfSubtract(k.y));l=wa.valueOf(q.y).selfSubtract(l.y).selfMultiply(wa.valueOf(l.x).selfSubtract(k.x));
l=u.subtract(l).selfDivide(r).doubleValue();k=wa.valueOf(k.y).selfAdd(wa.valueOf(m.y).selfSubtract(k.y).selfMultiply(l)).doubleValue();return new ua(p,k)};Zc.orientationIndexFilter=function(l,q,k){var m=(l.x-k.x)*(q.y-k.y);q=(l.y-k.y)*(q.x-k.x);l=m-q;if(0<m){if(0>=q)return Zc.signum(l);m+=q}else{if(!(0>m)||0<=q)return Zc.signum(l);m=-m-q}m*=Zc.DP_SAFE_EPSILON;return l>=m||-l>=m?Zc.signum(l):2};Zc.signum=function(l){return 0<l?1:0>l?-1:0};fn.DP_SAFE_EPSILON.get=function(){return 1E-15};Object.defineProperties(Zc,
fn);var gb=function(){},Sg={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Sg.X.get=function(){return 0};Sg.Y.get=function(){return 1};Sg.Z.get=function(){return 2};Sg.M.get=function(){return 3};gb.prototype.setOrdinate=function(l,q,k){};gb.prototype.size=function(){};gb.prototype.getOrdinate=function(l,q){};gb.prototype.getCoordinate=function(){};gb.prototype.getCoordinateCopy=function(l){};gb.prototype.getDimension=function(){};gb.prototype.getX=function(l){};gb.prototype.clone=
function(){};gb.prototype.expandEnvelope=function(l){};gb.prototype.copy=function(){};gb.prototype.getY=function(l){};gb.prototype.toCoordinateArray=function(){};gb.prototype.interfaces_=function(){return[Xh]};gb.prototype.getClass=function(){return gb};Object.defineProperties(gb,Sg);var gn=function(){},Tf=function(l){function q(){l.call(this,"Projective point not representable on the Cartesian plane.")}return l&&(q.__proto__=l),q.prototype=Object.create(l&&l.prototype),q.prototype.constructor=q,
q.prototype.interfaces_=function(){return[]},q.prototype.getClass=function(){return q},q}(gn),Pc=function(){};Pc.arraycopy=function(l,q,k,m,r){for(var p=0,u=q;u<q+r;u++)k[m+p]=l[u],p++};Pc.getProperty=function(l){return{"line.separator":"\n"}[l]};var ud=function q(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.y=this.x=0,this.w=1;else if(1===arguments.length){var k=arguments[0];this.x=k.x;this.y=k.y;this.w=1}else if(2===arguments.length)if("number"==typeof arguments[0]&&"number"==
typeof arguments[1])k=arguments[1],this.x=arguments[0],this.y=k,this.w=1;else if(arguments[0]instanceof q&&arguments[1]instanceof q){k=arguments[0];var m=arguments[1];this.x=k.y*m.w-m.y*k.w;this.y=m.x*k.w-k.x*m.w;this.w=k.x*m.y-m.x*k.y}else arguments[0]instanceof ua&&arguments[1]instanceof ua&&(k=arguments[0],m=arguments[1],this.x=k.y-m.y,this.y=m.x-k.x,this.w=k.x*m.y-m.x*k.y);else if(3===arguments.length)k=arguments[1],m=arguments[2],this.x=arguments[0],this.y=k,this.w=m;else if(4===arguments.length){var r=
arguments[0],p=arguments[1],u=arguments[2],x=arguments[3];k=r.y-p.y;m=p.x-r.x;r=r.x*p.y-p.x*r.y;p=u.y-x.y;var v=x.x-u.x;u=u.x*x.y-x.x*u.y;this.x=m*u-v*r;this.y=p*r-k*u;this.w=k*v-p*m}};ud.prototype.getY=function(){var q=this.y/this.w;if(Za.isNaN(q)||Za.isInfinite(q))throw new Tf;return q};ud.prototype.getX=function(){var q=this.x/this.w;if(Za.isNaN(q)||Za.isInfinite(q))throw new Tf;return q};ud.prototype.getCoordinate=function(){var q=new ua;return q.x=this.getX(),q.y=this.getY(),q};ud.prototype.interfaces_=
function(){return[]};ud.prototype.getClass=function(){return ud};ud.intersection=function(q,k,m,r){var p=q.y-k.y,u=k.x-q.x;q=q.x*k.y-k.x*q.y;k=m.y-r.y;var x=r.x-m.x;m=m.x*r.y-r.x*m.y;r=p*x-k*u;u=(u*m-x*q)/r;p=(k*q-p*m)/r;if(Za.isNaN(u)||Za.isInfinite(u)||Za.isNaN(p)||Za.isInfinite(p))throw new Tf;return new ua(u,p)};var Ka=function k(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof ua){var m=
arguments[0];this.init(m.x,m.x,m.y,m.y)}else arguments[0]instanceof k&&this.init(arguments[0]);else if(2===arguments.length){m=arguments[0];var r=arguments[1];this.init(m.x,r.x,m.y,r.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},hn={serialVersionUID:{configurable:!0}};Ka.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ka.prototype.equals=function(k){return k instanceof Ka?this.isNull()?k.isNull():this._maxx===k.getMaxX()&&this._maxy===
k.getMaxY()&&this._minx===k.getMinX()&&this._miny===k.getMinY():!1};Ka.prototype.intersection=function(k){return this.isNull()||k.isNull()||!this.intersects(k)?new Ka:new Ka(this._minx>k._minx?this._minx:k._minx,this._maxx<k._maxx?this._maxx:k._maxx,this._miny>k._miny?this._miny:k._miny,this._maxy<k._maxy?this._maxy:k._maxy)};Ka.prototype.isNull=function(){return this._maxx<this._minx};Ka.prototype.getMaxX=function(){return this._maxx};Ka.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof
ua){var k=arguments[0];return this.covers(k.x,k.y)}if(arguments[0]instanceof Ka)return k=arguments[0],!this.isNull()&&!k.isNull()&&k.getMinX()>=this._minx&&k.getMaxX()<=this._maxx&&k.getMinY()>=this._miny&&k.getMaxY()<=this._maxy}else if(2===arguments.length){k=arguments[0];var m=arguments[1];return!this.isNull()&&k>=this._minx&&k<=this._maxx&&m>=this._miny&&m<=this._maxy}};Ka.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Ka){var k=arguments[0];return!this.isNull()&&
!k.isNull()&&!(k._minx>this._maxx||k._maxx<this._minx||k._miny>this._maxy||k._maxy<this._miny)}if(arguments[0]instanceof ua)return k=arguments[0],this.intersects(k.x,k.y)}else if(2===arguments.length){k=arguments[0];var m=arguments[1];return!this.isNull()&&!(k>this._maxx||k<this._minx||m>this._maxy||m<this._miny)}};Ka.prototype.getMinY=function(){return this._miny};Ka.prototype.getMinX=function(){return this._minx};Ka.prototype.expandToInclude=function(){if(1===arguments.length)if(arguments[0]instanceof
ua){var k=arguments[0];this.expandToInclude(k.x,k.y)}else{if(arguments[0]instanceof Ka){k=arguments[0];if(k.isNull())return null;this.isNull()?(this._minx=k.getMinX(),this._maxx=k.getMaxX(),this._miny=k.getMinY(),this._maxy=k.getMaxY()):(k._minx<this._minx&&(this._minx=k._minx),k._maxx>this._maxx&&(this._maxx=k._maxx),k._miny<this._miny&&(this._miny=k._miny),k._maxy>this._maxy&&(this._maxy=k._maxy))}}else if(2===arguments.length){k=arguments[0];var m=arguments[1];this.isNull()?(this._minx=k,this._maxx=
k,this._miny=m,this._maxy=m):(k<this._minx&&(this._minx=k),k>this._maxx&&(this._maxx=k),m<this._miny&&(this._miny=m),m>this._maxy&&(this._maxy=m))}};Ka.prototype.minExtent=function(){if(this.isNull())return 0;var k=this.getWidth(),m=this.getHeight();return k<m?k:m};Ka.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};Ka.prototype.compareTo=function(k){return this.isNull()?k.isNull()?0:-1:k.isNull()?1:this._minx<k._minx?-1:this._minx>k._minx?1:this._miny<k._miny?-1:this._miny>
k._miny?1:this._maxx<k._maxx?-1:this._maxx>k._maxx?1:this._maxy<k._maxy?-1:this._maxy>k._maxy?1:0};Ka.prototype.translate=function(k,m){if(this.isNull())return null;this.init(this.getMinX()+k,this.getMaxX()+k,this.getMinY()+m,this.getMaxY()+m)};Ka.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};Ka.prototype.setToNull=function(){this._minx=0;this._maxx=-1;this._miny=0;this._maxy=-1};Ka.prototype.getHeight=function(){return this.isNull()?
0:this._maxy-this._miny};Ka.prototype.maxExtent=function(){if(this.isNull())return 0;var k=this.getWidth(),m=this.getHeight();return k>m?k:m};Ka.prototype.expandBy=function(){if(1===arguments.length){var k=arguments[0];this.expandBy(k,k)}else if(2===arguments.length){k=arguments[0];var m=arguments[1];if(this.isNull())return null;this._minx-=k;this._maxx+=k;this._miny-=m;this._maxy+=m;(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};Ka.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof
Ka||arguments[0]instanceof ua)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])};Ka.prototype.centre=function(){return this.isNull()?null:new ua((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};Ka.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length)if(arguments[0]instanceof ua){var k=arguments[0];this.init(k.x,k.x,k.y,k.y)}else arguments[0]instanceof Ka&&(k=arguments[0],this._minx=
k._minx,this._maxx=k._maxx,this._miny=k._miny,this._maxy=k._maxy);else if(2===arguments.length){k=arguments[0];var m=arguments[1];this.init(k.x,m.x,k.y,m.y)}else if(4===arguments.length){k=arguments[0];m=arguments[1];var r=arguments[2],p=arguments[3];k<m?(this._minx=k,this._maxx=m):(this._minx=m,this._maxx=k);r<p?(this._miny=r,this._maxy=p):(this._miny=p,this._maxy=r)}};Ka.prototype.getMaxY=function(){return this._maxy};Ka.prototype.distance=function(k){if(this.intersects(k))return 0;var m=0;this._maxx<
k._minx?m=k._minx-this._maxx:this._minx>k._maxx&&(m=this._minx-k._maxx);var r=0;return this._maxy<k._miny?r=k._miny-this._maxy:this._miny>k._maxy&&(r=this._miny-k._maxy),0===m?r:0===r?m:Math.sqrt(m*m+r*r)};Ka.prototype.hashCode=function(){return 37*(37*(37*(629+ua.hashCode(this._minx))+ua.hashCode(this._maxx))+ua.hashCode(this._miny))+ua.hashCode(this._maxy)};Ka.prototype.interfaces_=function(){return[md,ld]};Ka.prototype.getClass=function(){return Ka};Ka.intersects=function(){if(3===arguments.length){var k=
arguments[0],m=arguments[1],r=arguments[2];return r.x>=(k.x<m.x?k.x:m.x)&&r.x<=(k.x>m.x?k.x:m.x)&&r.y>=(k.y<m.y?k.y:m.y)&&r.y<=(k.y>m.y?k.y:m.y)}if(4===arguments.length){k=arguments[0];m=arguments[1];r=arguments[2];var p=arguments[3],u=Math.min(r.x,p.x),x=Math.max(r.x,p.x),v=Math.min(k.x,m.x),y=Math.max(k.x,m.x);return!(v>x)&&!(y<u)&&(u=Math.min(r.y,p.y),x=Math.max(r.y,p.y),v=Math.min(k.y,m.y),y=Math.max(k.y,m.y),!(v>x)&&!(y<u))}};hn.serialVersionUID.get=function(){return 0x51845cd552189800};Object.defineProperties(Ka,
hn);var tp=/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,up=/^\s*(\w+)\s*EMPTY\s*$/,Fj=/\s+/,jn=/\)\s*,\s*\(/,vp=/\)\s*\)\s*,\s*\(\s*\(/,Yh=/^\s*\(?(.*?)\)?\s*$/,Zh=function(k){this.geometryFactory=k||new db};Zh.prototype.read=function(k){var m,r,p;k=k.replace(/[\n\r]/g," ");var u=tp.exec(k);if(-1!==k.search("EMPTY")&&((u=up.exec(k))[2]=void 0),u&&(r=u[1].toLowerCase(),p=u[2],Uf[r]&&(m=Uf[r].apply(this,[p]))),void 0===m)throw Error("Could not parse WKT "+k);return m};Zh.prototype.write=function(k){return this.extractGeometry(k)};
Zh.prototype.extractGeometry=function(k){var m=k.getGeometryType().toLowerCase();if(!qe[m])return null;var r=m.toUpperCase();return k.isEmpty()?r+" EMPTY":r+"("+qe[m].apply(this,[k])+")"};var qe={coordinate:function(k){return k.x+" "+k.y},point:function(k){return qe.coordinate.call(this,k._coordinates._coordinates[0])},multipoint:function(k){for(var m=[],r=0,p=k._geometries.length;r<p;++r)m.push("("+qe.point.apply(this,[k._geometries[r]])+")");return m.join(",")},linestring:function(k){for(var m=
[],r=0,p=k._points._coordinates.length;r<p;++r)m.push(qe.coordinate.apply(this,[k._points._coordinates[r]]));return m.join(",")},linearring:function(k){for(var m=[],r=0,p=k._points._coordinates.length;r<p;++r)m.push(qe.coordinate.apply(this,[k._points._coordinates[r]]));return m.join(",")},multilinestring:function(k){for(var m=[],r=0,p=k._geometries.length;r<p;++r)m.push("("+qe.linestring.apply(this,[k._geometries[r]])+")");return m.join(",")},polygon:function(k){var m=[];m.push("("+qe.linestring.apply(this,
[k._shell])+")");for(var r=0,p=k._holes.length;r<p;++r)m.push("("+qe.linestring.apply(this,[k._holes[r]])+")");return m.join(",")},multipolygon:function(k){for(var m=[],r=0,p=k._geometries.length;r<p;++r)m.push("("+qe.polygon.apply(this,[k._geometries[r]])+")");return m.join(",")},geometrycollection:function(k){for(var m=[],r=0,p=k._geometries.length;r<p;++r)m.push(this.extractGeometry(k._geometries[r]));return m.join(",")}},Uf={point:function(k){if(void 0===k)return this.geometryFactory.createPoint();
k=k.trim().split(Fj);return this.geometryFactory.createPoint(new ua(Number.parseFloat(k[0]),Number.parseFloat(k[1])))},multipoint:function(k){if(void 0===k)return this.geometryFactory.createMultiPoint();for(var m=k.trim().split(","),r=[],p=0,u=m.length;p<u;++p)k=m[p].replace(Yh,"$1"),r.push(Uf.point.apply(this,[k]));return this.geometryFactory.createMultiPoint(r)},linestring:function(k){if(void 0===k)return this.geometryFactory.createLineString();for(var m=k.trim().split(","),r=[],p=0,u=m.length;p<
u;++p)k=m[p].trim().split(Fj),r.push(new ua(Number.parseFloat(k[0]),Number.parseFloat(k[1])));return this.geometryFactory.createLineString(r)},linearring:function(k){if(void 0===k)return this.geometryFactory.createLinearRing();for(var m=k.trim().split(","),r=[],p=0,u=m.length;p<u;++p)k=m[p].trim().split(Fj),r.push(new ua(Number.parseFloat(k[0]),Number.parseFloat(k[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(k){if(void 0===k)return this.geometryFactory.createMultiLineString();
for(var m=k.trim().split(jn),r=[],p=0,u=m.length;p<u;++p)k=m[p].replace(Yh,"$1"),r.push(Uf.linestring.apply(this,[k]));return this.geometryFactory.createMultiLineString(r)},polygon:function(k){if(void 0===k)return this.geometryFactory.createPolygon();var m;k=k.trim().split(jn);for(var r=[],p=0,u=k.length;p<u;++p){var x=k[p].replace(Yh,"$1");x=Uf.linestring.apply(this,[x]);x=this.geometryFactory.createLinearRing(x._points);0===p?m=x:r.push(x)}return this.geometryFactory.createPolygon(m,r)},multipolygon:function(k){if(void 0===
k)return this.geometryFactory.createMultiPolygon();for(var m=k.trim().split(vp),r=[],p=0,u=m.length;p<u;++p)k=m[p].replace(Yh,"$1"),r.push(Uf.polygon.apply(this,[k]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(k){if(void 0===k)return this.geometryFactory.createGeometryCollection();k=k.replace(/,\s*([A-Za-z])/g,"|$1").trim().split("|");for(var m=[],r=0,p=k.length;r<p;++r)m.push(this.read(k[r]));return this.geometryFactory.createGeometryCollection(m)}},re=function(k){this.parser=
new Zh(k)};re.prototype.write=function(k){return this.parser.write(k)};re.toLineString=function(k,m){if(2!==arguments.length)throw Error("Not implemented");return"LINESTRING ( "+k.x+" "+k.y+", "+m.x+" "+m.y+" )"};var se=function(k){function m(r){k.call(this,r);this.name="RuntimeException";this.message=r;this.stack=(new k).stack}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m}(Error),$h=function(k){function m(){(k.call(this),0===arguments.length)?k.call(this):
1===arguments.length&&k.call(this,arguments[0])}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},m}(se),$a=function(){};$a.prototype.interfaces_=function(){return[]};$a.prototype.getClass=function(){return $a};$a.shouldNeverReachHere=function(){if(0===arguments.length)$a.shouldNeverReachHere(null);else if(1===arguments.length){var k=arguments[0];throw new $h("Should never reach here"+
(null!==k?": "+k:""));}};$a.isTrue=function(){var k;if(1===arguments.length)$a.isTrue(arguments[0],null);else if(2===arguments.length&&(k=arguments[1],!arguments[0]))throw null===k?new $h:new $h(k);};$a.equals=function(){var k,m,r;if(2===arguments.length)$a.equals(arguments[0],arguments[1],null);else if(3===arguments.length&&(k=arguments[0],r=arguments[2],!(m=arguments[1]).equals(k)))throw new $h("Expected "+k+" but encountered "+m+(null!==r?": "+r:""));};var Zb=function(){this._result=null;this._inputLines=
Array(2).fill().map(function(){return Array(2)});this._intPt=Array(2).fill(null);this._precisionModel=this._pb=this._pa=this._isProper=this._intLineIndex=null;this._intPt[0]=new ua;this._intPt[1]=new ua;this._pa=this._intPt[0];this._pb=this._intPt[1];this._result=0},pf={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Zb.prototype.getIndexAlongSegment=
function(k,m){return this.computeIntLineIndex(),this._intLineIndex[k][m]};Zb.prototype.getTopologySummary=function(){var k=new Ed;return this.isEndPoint()&&k.append(" endpoint"),this._isProper&&k.append(" proper"),this.isCollinear()&&k.append(" collinear"),k.toString()};Zb.prototype.computeIntersection=function(k,m,r,p){this._inputLines[0][0]=k;this._inputLines[0][1]=m;this._inputLines[1][0]=r;this._inputLines[1][1]=p;this._result=this.computeIntersect(k,m,r,p)};Zb.prototype.getIntersectionNum=function(){return this._result};
Zb.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var k=arguments[0],m=this.getEdgeDistance(k,0),r=this.getEdgeDistance(k,1);m>r?(this._intLineIndex[k][0]=0,this._intLineIndex[k][1]=1):(this._intLineIndex[k][0]=1,this._intLineIndex[k][1]=0)}};Zb.prototype.isProper=function(){return this.hasIntersection()&&
this._isProper};Zb.prototype.setPrecisionModel=function(k){this._precisionModel=k};Zb.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var k=arguments[0],m=0;m<this._result;m++)if(!this._intPt[m].equals2D(this._inputLines[k][0])&&!this._intPt[m].equals2D(this._inputLines[k][1]))return!0;return!1}};Zb.prototype.getIntersection=function(k){return this._intPt[k]};Zb.prototype.isEndPoint=
function(){return this.hasIntersection()&&!this._isProper};Zb.prototype.hasIntersection=function(){return this._result!==Zb.NO_INTERSECTION};Zb.prototype.getEdgeDistance=function(k,m){return Zb.computeEdgeDistance(this._intPt[m],this._inputLines[k][0],this._inputLines[k][1])};Zb.prototype.isCollinear=function(){return this._result===Zb.COLLINEAR_INTERSECTION};Zb.prototype.toString=function(){return re.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+re.toLineString(this._inputLines[1][0],
this._inputLines[1][1])+this.getTopologySummary()};Zb.prototype.getEndpoint=function(k,m){return this._inputLines[k][m]};Zb.prototype.isIntersection=function(k){for(var m=0;m<this._result;m++)if(this._intPt[m].equals2D(k))return!0;return!1};Zb.prototype.getIntersectionAlongSegment=function(k,m){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[k][m]]};Zb.prototype.interfaces_=function(){return[]};Zb.prototype.getClass=function(){return Zb};Zb.computeEdgeDistance=function(k,m,r){var p=
Math.abs(r.x-m.x),u=Math.abs(r.y-m.y);if(k.equals(m))p=0;else if(k.equals(r))p=p>u?p:u;else{r=Math.abs(k.x-m.x);var x=Math.abs(k.y-m.y);0!==(p=p>u?r:x)||k.equals(m)||(p=Math.max(r,x))}return $a.isTrue(!(0===p&&!k.equals(m)),"Bad distance calculation"),p};Zb.nonRobustComputeEdgeDistance=function(k,m,r){r=k.x-m.x;var p=k.y-m.y;r=Math.sqrt(r*r+p*p);return $a.isTrue(!(0===r&&!k.equals(m)),"Invalid distance calculation"),r};pf.DONT_INTERSECT.get=function(){return 0};pf.DO_INTERSECT.get=function(){return 1};
pf.COLLINEAR.get=function(){return 2};pf.NO_INTERSECTION.get=function(){return 0};pf.POINT_INTERSECTION.get=function(){return 1};pf.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(Zb,pf);var Te=function(k){function m(){k.apply(this,arguments)}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m.prototype.isInSegmentEnvelopes=function(r){var p=new Ka(this._inputLines[0][0],this._inputLines[0][1]),u=new Ka(this._inputLines[1][0],this._inputLines[1][1]);
return p.contains(r)&&u.contains(r)},m.prototype.computeIntersection=function(){if(3!==arguments.length)return k.prototype.computeIntersection.apply(this,arguments);var r=arguments[0],p=arguments[1],u=arguments[2];if(this._isProper=!1,Ka.intersects(p,u,r)&&0===Da.orientationIndex(p,u,r)&&0===Da.orientationIndex(u,p,r))return this._isProper=!0,(r.equals(p)||r.equals(u))&&(this._isProper=!1),this._result=k.POINT_INTERSECTION,null;this._result=k.NO_INTERSECTION},m.prototype.normalizeToMinimum=function(r,
p,u,x,v){v.x=this.smallestInAbsValue(r.x,p.x,u.x,x.x);v.y=this.smallestInAbsValue(r.y,p.y,u.y,x.y);r.x-=v.x;r.y-=v.y;p.x-=v.x;p.y-=v.y;u.x-=v.x;u.y-=v.y;x.x-=v.x;x.y-=v.y},m.prototype.safeHCoordinateIntersection=function(r,p,u,x){var v=null;try{v=ud.intersection(r,p,u,x)}catch(y){if(!(y instanceof Tf))throw y;v=m.nearestEndpoint(r,p,u,x)}return v},m.prototype.intersection=function(r,p,u,x){var v=this.intersectionWithNormalization(r,p,u,x);return this.isInSegmentEnvelopes(v)||(v=new ua(m.nearestEndpoint(r,
p,u,x))),null!==this._precisionModel&&this._precisionModel.makePrecise(v),v},m.prototype.smallestInAbsValue=function(r,p,u,x){var v=Math.abs(r);return Math.abs(p)<v&&(r=p,v=Math.abs(p)),Math.abs(u)<v&&(r=u,v=Math.abs(u)),Math.abs(x)<v&&(r=x),r},m.prototype.checkDD=function(r,p,u,x,v){r=Zc.intersection(r,p,u,x);p=this.isInSegmentEnvelopes(r);Pc.out.println("DD in env = "+p+"  --------------------- "+r);1E-4<v.distance(r)&&Pc.out.println("Distance = "+v.distance(r))},m.prototype.intersectionWithNormalization=
function(r,p,u,x){r=new ua(r);p=new ua(p);u=new ua(u);var v=new ua(x);x=new ua;this.normalizeToEnvCentre(r,p,u,v,x);r=this.safeHCoordinateIntersection(r,p,u,v);return r.x+=x.x,r.y+=x.y,r},m.prototype.computeCollinearIntersection=function(r,p,u,x){var v=Ka.intersects(r,p,u),y=Ka.intersects(r,p,x),B=Ka.intersects(u,x,r),G=Ka.intersects(u,x,p);return v&&y?(this._intPt[0]=u,this._intPt[1]=x,k.COLLINEAR_INTERSECTION):B&&G?(this._intPt[0]=r,this._intPt[1]=p,k.COLLINEAR_INTERSECTION):v&&B?(this._intPt[0]=
u,this._intPt[1]=r,!u.equals(r)||y||G?k.COLLINEAR_INTERSECTION:k.POINT_INTERSECTION):v&&G?(this._intPt[0]=u,this._intPt[1]=p,!u.equals(p)||y||B?k.COLLINEAR_INTERSECTION:k.POINT_INTERSECTION):y&&B?(this._intPt[0]=x,this._intPt[1]=r,!x.equals(r)||v||G?k.COLLINEAR_INTERSECTION:k.POINT_INTERSECTION):y&&G?(this._intPt[0]=x,this._intPt[1]=p,!x.equals(p)||v||B?k.COLLINEAR_INTERSECTION:k.POINT_INTERSECTION):k.NO_INTERSECTION},m.prototype.normalizeToEnvCentre=function(r,p,u,x,v){var y=r.x<p.x?r.x:p.x,B=r.y<
p.y?r.y:p.y,G=r.x>p.x?r.x:p.x,A=r.y>p.y?r.y:p.y,F=u.x<x.x?u.x:x.x,J=u.y<x.y?u.y:x.y,D=u.x>x.x?u.x:x.x,E=u.y>x.y?u.y:x.y;v.x=((y>F?y:F)+(G<D?G:D))/2;v.y=((B>J?B:J)+(A<E?A:E))/2;r.x-=v.x;r.y-=v.y;p.x-=v.x;p.y-=v.y;u.x-=v.x;u.y-=v.y;x.x-=v.x;x.y-=v.y},m.prototype.computeIntersect=function(r,p,u,x){if(this._isProper=!1,!Ka.intersects(r,p,u,x))return k.NO_INTERSECTION;var v=Da.orientationIndex(r,p,u),y=Da.orientationIndex(r,p,x);if(0<v&&0<y||0>v&&0>y)return k.NO_INTERSECTION;var B=Da.orientationIndex(u,
x,r),G=Da.orientationIndex(u,x,p);return 0<B&&0<G||0>B&&0>G?k.NO_INTERSECTION:0===v&&0===y&&0===B&&0===G?this.computeCollinearIntersection(r,p,u,x):(0===v||0===y||0===B||0===G?(this._isProper=!1,r.equals2D(u)||r.equals2D(x)?this._intPt[0]=r:p.equals2D(u)||p.equals2D(x)?this._intPt[0]=p:0===v?this._intPt[0]=new ua(u):0===y?this._intPt[0]=new ua(x):0===B?this._intPt[0]=new ua(r):0===G&&(this._intPt[0]=new ua(p))):(this._isProper=!0,this._intPt[0]=this.intersection(r,p,u,x)),k.POINT_INTERSECTION)},m.prototype.interfaces_=
function(){return[]},m.prototype.getClass=function(){return m},m.nearestEndpoint=function(r,p,u,x){var v=r,y=Da.distancePointLine(r,u,x),B=Da.distancePointLine(p,u,x);return B<y&&(y=B,v=p),(B=Da.distancePointLine(u,r,p))<y&&(y=B,v=u),Da.distancePointLine(x,r,p)<y&&(v=x),v},m}(Zb),qf=function(){};qf.prototype.interfaces_=function(){return[]};qf.prototype.getClass=function(){return qf};qf.orientationIndex=function(k,m,r){return qf.signOfDet2x2(m.x-k.x,m.y-k.y,r.x-m.x,r.y-m.y)};qf.signOfDet2x2=function(k,
m,r,p){var u,x=null;if(u=1,0===k||0===p)return 0===m||0===r?0:0<m?0<r?-u:u:0<r?u:-u;if(0===m||0===r)return 0<p?0<k?u:-u:0<k?-u:u;if(0<m?0<p?m<=p||(u=-u,x=k,k=r,r=x,x=m,m=p,p=x):m<=-p?(u=-u,r=-r,p=-p):(x=k,k=-r,r=x,x=m,m=-p,p=x):0<p?-m<=p?(u=-u,k=-k,m=-m):(x=-k,k=r,r=x,x=-m,m=p,p=x):m>=p?(k=-k,m=-m,r=-r,p=-p):(u=-u,x=-k,k=-r,r=x,x=-m,m=-p,p=x),0<k){if(!(0<r&&k<=r))return u}else{if(0<r||!(k>=r))return-u;u=-u;k=-k;r=-r}for(;;){if(0>(p-=(x=Math.floor(r/k))*m))return-u;if(p>m)return u;if(k>(r-=x*k)+r){if(m<
p+p)return u}else{if(m>p+p)return-u;r=k-r;p=m-p;u=-u}if(0===p)return 0===r?0:-u;if(0===r||0>(m-=(x=Math.floor(k/r))*p))return u;if(m>p)return-u;if(r>(k-=x*r)+k){if(p<m+m)return-u}else{if(p>m+m)return u;k=r-k;m=p-m;u=-u}if(0===m)return 0===k?0:u;if(0===k)return-u}};var Gd=function(k){this._crossingCount=0;this._isPointOnSegment=!1;this._p=k};Gd.prototype.countSegment=function(k,m){if(k.x<this._p.x&&m.x<this._p.x)return null;if(this._p.x===m.x&&this._p.y===m.y)return this._isPointOnSegment=!0,null;
if(k.y===this._p.y&&m.y===this._p.y){var r=k.x,p=m.x;return r>p&&(r=m.x,p=k.x),this._p.x>=r&&this._p.x<=p&&(this._isPointOnSegment=!0),null}if(k.y>this._p.y&&m.y<=this._p.y||m.y>this._p.y&&k.y<=this._p.y){r=k.y-this._p.y;p=m.y-this._p.y;k=qf.signOfDet2x2(k.x-this._p.x,r,m.x-this._p.x,p);if(0===k)return this._isPointOnSegment=!0,null;p<r&&(k=-k);0<k&&this._crossingCount++}};Gd.prototype.isPointInPolygon=function(){return this.getLocation()!==va.EXTERIOR};Gd.prototype.getLocation=function(){return this._isPointOnSegment?
va.BOUNDARY:1==this._crossingCount%2?va.INTERIOR:va.EXTERIOR};Gd.prototype.isOnSegment=function(){return this._isPointOnSegment};Gd.prototype.interfaces_=function(){return[]};Gd.prototype.getClass=function(){return Gd};Gd.locatePointInRing=function(k,m){if(k instanceof ua&&Xa(m,gb)){k=new Gd(k);for(var r=new ua,p=new ua,u=1;u<m.size()&&(m.getCoordinate(u,r),m.getCoordinate(u-1,p),k.countSegment(r,p),!k.isOnSegment());u++);return k.getLocation()}if(k instanceof ua&&m instanceof Array){k=new Gd(k);
for(r=1;r<m.length&&(k.countSegment(m[r],m[r-1]),!k.isOnSegment());r++);return k.getLocation()}};var Da=function(){},rf={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Da.prototype.interfaces_=function(){return[]};Da.prototype.getClass=function(){return Da};Da.orientationIndex=function(k,m,r){return Zc.orientationIndex(k,m,r)};Da.signedArea=function(k){if(k instanceof Array){if(3>
k.length)return 0;for(var m=0,r=k[0].x,p=1;p<k.length-1;p++)m+=(k[p].x-r)*(k[p-1].y-k[p+1].y);return m/2}if(Xa(k,gb)){m=k.size();if(3>m)return 0;r=new ua;p=new ua;var u=new ua;k.getCoordinate(0,p);k.getCoordinate(1,u);var x=p.x;u.x-=x;for(var v=0,y=1;y<m-1;y++)r.y=p.y,p.x=u.x,p.y=u.y,k.getCoordinate(y+1,u),u.x-=x,v+=p.x*(r.y-u.y);return v/2}};Da.distanceLineLine=function(k,m,r,p){if(k.equals(m))return Da.distancePointLine(k,r,p);if(r.equals(p))return Da.distancePointLine(p,k,m);var u=!1;if(Ka.intersects(k,
m,r,p)){var x=(m.x-k.x)*(p.y-r.y)-(m.y-k.y)*(p.x-r.x);if(0===x)u=!0;else{var v=((k.y-r.y)*(m.x-k.x)-(k.x-r.x)*(m.y-k.y))/x;x=((k.y-r.y)*(p.x-r.x)-(k.x-r.x)*(p.y-r.y))/x;(0>x||1<x||0>v||1<v)&&(u=!0)}}else u=!0;return u?fd.min(Da.distancePointLine(k,r,p),Da.distancePointLine(m,r,p),Da.distancePointLine(r,k,m),Da.distancePointLine(p,k,m)):0};Da.isPointInRing=function(k,m){return Da.locatePointInRing(k,m)!==va.EXTERIOR};Da.computeLength=function(k){var m=k.size();if(1>=m)return 0;var r=0,p=new ua;k.getCoordinate(0,
p);for(var u=p.x,x=p.y,v=1;v<m;v++){k.getCoordinate(v,p);var y=p.x,B=p.y;u=y-u;x=B-x;r+=Math.sqrt(u*u+x*x);u=y;x=B}return r};Da.isCCW=function(k){var m=k.length-1;if(3>m)throw new cc("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=k[0],p=0,u=1;u<=m;u++){var x=k[u];x.y>r.y&&(r=x,p=u)}x=p;do 0>--x&&(x=m);while(k[x].equals2D(r)&&x!==p);u=p;do u=(u+1)%m;while(k[u].equals2D(r)&&u!==p);m=k[x];k=k[u];if(m.equals2D(r)||k.equals2D(r)||m.equals2D(k))return!1;r=Da.computeOrientation(m,
r,k);p=!1;return p=0===r?m.x>k.x:0<r,p};Da.locatePointInRing=function(k,m){return Gd.locatePointInRing(k,m)};Da.distancePointLinePerpendicular=function(k,m,r){var p=(r.x-m.x)*(r.x-m.x)+(r.y-m.y)*(r.y-m.y);return Math.abs(((m.y-k.y)*(r.x-m.x)-(m.x-k.x)*(r.y-m.y))/p)*Math.sqrt(p)};Da.computeOrientation=function(k,m,r){return Da.orientationIndex(k,m,r)};Da.distancePointLine=function(){if(2===arguments.length){var k=arguments[0],m=arguments[1];if(0===m.length)throw new cc("Line array must contain at least one vertex");
for(var r=k.distance(m[0]),p=0;p<m.length-1;p++){var u=Da.distancePointLine(k,m[p],m[p+1]);u<r&&(r=u)}return r}if(3===arguments.length){k=arguments[0];m=arguments[1];r=arguments[2];if(m.x===r.x&&m.y===r.y)return k.distance(m);p=(r.x-m.x)*(r.x-m.x)+(r.y-m.y)*(r.y-m.y);u=((k.x-m.x)*(r.x-m.x)+(k.y-m.y)*(r.y-m.y))/p;return 0>=u?k.distance(m):1<=u?k.distance(r):Math.abs(((m.y-k.y)*(r.x-m.x)-(m.x-k.x)*(r.y-m.y))/p)*Math.sqrt(p)}};Da.isOnLine=function(k,m){for(var r=new Te,p=1;p<m.length;p++)if(r.computeIntersection(k,
m[p-1],m[p]),r.hasIntersection())return!0;return!1};rf.CLOCKWISE.get=function(){return-1};rf.RIGHT.get=function(){return Da.CLOCKWISE};rf.COUNTERCLOCKWISE.get=function(){return 1};rf.LEFT.get=function(){return Da.COUNTERCLOCKWISE};rf.COLLINEAR.get=function(){return 0};rf.STRAIGHT.get=function(){return Da.COLLINEAR};Object.defineProperties(Da,rf);var te=function(){};te.prototype.filter=function(k){};te.prototype.interfaces_=function(){return[]};te.prototype.getClass=function(){return te};var Ua=function(k){this._userData=
this._SRID=this._envelope=null;this._factory=k;this._SRID=k.getSRID()},Wd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Ua.prototype.isGeometryCollection=
function(){return this.getSortIndex()===Ua.SORTINDEX_GEOMETRYCOLLECTION};Ua.prototype.getFactory=function(){return this._factory};Ua.prototype.getGeometryN=function(k){return this};Ua.prototype.getArea=function(){return 0};Ua.prototype.isRectangle=function(){return!1};Ua.prototype.equals=function(k){if(k instanceof Ua)return null!==k&&this.equalsTopo(k);if(k instanceof Object)return k instanceof Ua?this.equalsExact(k):!1};Ua.prototype.equalsExact=function(k){return this===k||this.equalsExact(k,0)};
Ua.prototype.geometryChanged=function(){this.apply(Ua.geometryChangedFilter)};Ua.prototype.geometryChangedAction=function(){this._envelope=null};Ua.prototype.equalsNorm=function(k){return null!==k&&this.norm().equalsExact(k.norm())};Ua.prototype.getLength=function(){return 0};Ua.prototype.getNumGeometries=function(){return 1};Ua.prototype.compareTo=function(){if(1===arguments.length){var k=arguments[0];return this.getSortIndex()!==k.getSortIndex()?this.getSortIndex()-k.getSortIndex():this.isEmpty()&&
k.isEmpty()?0:this.isEmpty()?-1:k.isEmpty()?1:this.compareToSameClass(k)}if(2===arguments.length){k=arguments[0];var m=arguments[1];return this.getSortIndex()!==k.getSortIndex()?this.getSortIndex()-k.getSortIndex():this.isEmpty()&&k.isEmpty()?0:this.isEmpty()?-1:k.isEmpty()?1:this.compareToSameClass(k,m)}};Ua.prototype.getUserData=function(){return this._userData};Ua.prototype.getSRID=function(){return this._SRID};Ua.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};
Ua.prototype.checkNotGeometryCollection=function(k){if(k.getSortIndex()===Ua.SORTINDEX_GEOMETRYCOLLECTION)throw new cc("This method does not support GeometryCollection arguments");};Ua.prototype.equal=function(k,m,r){return 0===r?k.equals(m):k.distance(m)<=r};Ua.prototype.norm=function(){var k=this.copy();return k.normalize(),k};Ua.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Ua.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=
this.computeEnvelopeInternal()),new Ka(this._envelope)};Ua.prototype.setSRID=function(k){this._SRID=k};Ua.prototype.setUserData=function(k){this._userData=k};Ua.prototype.compare=function(k,m){k=k.iterator();for(m=m.iterator();k.hasNext()&&m.hasNext();){var r=k.next(),p=m.next();r=r.compareTo(p);if(0!==r)return r}return k.hasNext()?1:m.hasNext()?-1:0};Ua.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Ua.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===
Ua.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Ua.SORTINDEX_MULTIPOINT||this.getSortIndex()===Ua.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Ua.SORTINDEX_MULTIPOLYGON};Ua.prototype.interfaces_=function(){return[Xh,md,ld]};Ua.prototype.getClass=function(){return Ua};Ua.hasNonEmptyElements=function(k){for(var m=0;m<k.length;m++)if(!k[m].isEmpty())return!0;return!1};Ua.hasNullElements=function(k){for(var m=0;m<k.length;m++)if(null===k[m])return!0;return!1};Wd.serialVersionUID.get=function(){return 0x799ea46522854c00};
Wd.SORTINDEX_POINT.get=function(){return 0};Wd.SORTINDEX_MULTIPOINT.get=function(){return 1};Wd.SORTINDEX_LINESTRING.get=function(){return 2};Wd.SORTINDEX_LINEARRING.get=function(){return 3};Wd.SORTINDEX_MULTILINESTRING.get=function(){return 4};Wd.SORTINDEX_POLYGON.get=function(){return 5};Wd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Wd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Wd.geometryChangedFilter.get=function(){return Gj};Object.defineProperties(Ua,Wd);var Gj=function(){};
Gj.interfaces_=function(){return[te]};Gj.filter=function(k){k.geometryChangedAction()};var Fe=function(){};Fe.prototype.filter=function(k){};Fe.prototype.interfaces_=function(){return[]};Fe.prototype.getClass=function(){return Fe};var nd=function(){},ue={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},
MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};nd.prototype.isInBoundary=function(k){};nd.prototype.interfaces_=function(){return[]};nd.prototype.getClass=function(){return nd};ue.Mod2BoundaryNodeRule.get=function(){return Vf};ue.EndPointBoundaryNodeRule.get=function(){return Wf};ue.MultiValentEndPointBoundaryNodeRule.get=function(){return Xf};ue.MonoValentEndPointBoundaryNodeRule.get=function(){return Yf};
ue.MOD2_BOUNDARY_RULE.get=function(){return new Vf};ue.ENDPOINT_BOUNDARY_RULE.get=function(){return new Wf};ue.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Xf};ue.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Yf};ue.OGC_SFS_BOUNDARY_RULE.get=function(){return nd.MOD2_BOUNDARY_RULE};Object.defineProperties(nd,ue);var Vf=function(){};Vf.prototype.isInBoundary=function(k){return 1==k%2};Vf.prototype.interfaces_=function(){return[nd]};Vf.prototype.getClass=function(){return Vf};
var Wf=function(){};Wf.prototype.isInBoundary=function(k){return 0<k};Wf.prototype.interfaces_=function(){return[nd]};Wf.prototype.getClass=function(){return Wf};var Xf=function(){};Xf.prototype.isInBoundary=function(k){return 1<k};Xf.prototype.interfaces_=function(){return[nd]};Xf.prototype.getClass=function(){return Xf};var Yf=function(){};Yf.prototype.isInBoundary=function(k){return 1===k};Yf.prototype.interfaces_=function(){return[nd]};Yf.prototype.getClass=function(){return Yf};var mc=function(){};
mc.prototype.add=function(){};mc.prototype.addAll=function(){};mc.prototype.isEmpty=function(){};mc.prototype.iterator=function(){};mc.prototype.size=function(){};mc.prototype.toArray=function(){};mc.prototype.remove=function(){};hj.prototype=Error();hj.prototype.name="IndexOutOfBoundsException";var Zf=function(){};Zf.prototype.hasNext=function(){};Zf.prototype.next=function(){};Zf.prototype.remove=function(){};var ve=function(k){function m(){k.apply(this,arguments)}return k&&(m.__proto__=k),m.prototype=
Object.create(k&&k.prototype),m.prototype.constructor=m,m.prototype.get=function(){},m.prototype.set=function(){},m.prototype.isEmpty=function(){},m}(mc);Mf.prototype=Error();Mf.prototype.name="NoSuchElementException";var Fa=function(k){function m(r){k.call(this);this.array_=[];r instanceof mc&&this.addAll(r)}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m.prototype.ensureCapacity=function(){},m.prototype.interfaces_=function(){return[k,mc]},m.prototype.add=
function(r){return 1===arguments.length?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},m.prototype.clear=function(){this.array_=[]},m.prototype.addAll=function(r){for(r=r.iterator();r.hasNext();)this.add(r.next());return!0},m.prototype.set=function(r,p){var u=this.array_[r];return this.array_[r]=p,u},m.prototype.iterator=function(){return new wp(this)},m.prototype.get=function(r){if(0>r||r>=this.size())throw new hj;return this.array_[r]},m.prototype.isEmpty=function(){return 0===
this.array_.length},m.prototype.size=function(){return this.array_.length},m.prototype.toArray=function(){for(var r=[],p=0,u=this.array_.length;p<u;p++)r.push(this.array_[p]);return r},m.prototype.remove=function(r){for(var p=!1,u=0,x=this.array_.length;u<x;u++)if(this.array_[u]===r){this.array_.splice(u,1);p=!0;break}return p},m}(ve),wp=function(k){function m(r){k.call(this);this.arrayList_=r;this.position_=0}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=
m,m.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Mf;return this.arrayList_.get(this.position_++)},m.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},m.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},m.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},m}(Zf),Tg=function(k){function m(){if(k.call(this),0!==arguments.length)if(1===arguments.length){var p=arguments[0];this.ensureCapacity(p.length);
this.add(p,!0)}else if(2===arguments.length){p=arguments[0];var u=arguments[1];this.ensureCapacity(p.length);this.add(p,u)}}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={coordArrayType:{configurable:!0}};return r.coordArrayType.get=function(){return[].fill(null)},m.prototype.getCoordinate=function(p){return this.get(p)},m.prototype.addAll=function(){if(2===arguments.length){for(var p=arguments[1],u=!1,x=arguments[0].iterator();x.hasNext();)this.add(x.next(),
p),u=!0;return u}return k.prototype.addAll.apply(this,arguments)},m.prototype.clone=function(){for(var p=k.prototype.clone.call(this),u=0;u<this.size();u++)p.add(u,this.get(u).copy());return p},m.prototype.toCoordinateArray=function(){return this.toArray(m.coordArrayType)},m.prototype.add=function(){if(1===arguments.length)k.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],
!0),!0;if(arguments[0]instanceof ua&&"boolean"==typeof arguments[1]){var p=arguments[0];if(!arguments[1]&&1<=this.size()&&this.get(this.size()-1).equals2D(p))return null;k.prototype.add.call(this,p)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){p=arguments[0];var u=arguments[1];if(arguments[2])for(var x=
0;x<p.length;x++)this.add(p[x],u);else for(x=p.length-1;0<=x;x--)this.add(p[x],u);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof ua){p=arguments[0];u=arguments[1];if(!arguments[2]&&(x=this.size(),0<x&&(0<p&&this.get(p-1).equals2D(u)||p<x&&this.get(p).equals2D(u))))return null;k.prototype.add.call(this,p,u)}}else if(4===arguments.length){p=arguments[0];u=arguments[1];var v=arguments[2];x=arguments[3];var y=1;for(v>x&&(y=-1);v!==x;v+=y)this.add(p[v],
u);return!0}},m.prototype.closeRing=function(){0<this.size()&&this.add(new ua(this.get(0)),!1)},m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},Object.defineProperties(m,r),m}(Fa),cb=function(){},ai={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};ai.ForwardComparator.get=function(){return Ug};ai.BidirectionalComparator.get=function(){return $f};ai.coordArrayType.get=function(){return[].fill(null)};
cb.prototype.interfaces_=function(){return[]};cb.prototype.getClass=function(){return cb};cb.isRing=function(k){return!(4>k.length)&&!!k[0].equals2D(k[k.length-1])};cb.ptNotInList=function(k,m){for(var r=0;r<k.length;r++){var p=k[r];if(0>cb.indexOf(p,m))return p}return null};cb.scroll=function(k,m){m=cb.indexOf(m,k);if(0>m)return null;var r=Array(k.length).fill(null);Pc.arraycopy(k,m,r,0,k.length-m);Pc.arraycopy(k,0,r,k.length-m,m);Pc.arraycopy(r,0,k,0,k.length)};cb.equals=function(){if(2===arguments.length){var k=
arguments[0],m=arguments[1];if(k===m)return!0;if(null===k||null===m||k.length!==m.length)return!1;for(var r=0;r<k.length;r++)if(!k[r].equals(m[r]))return!1;return!0}if(3===arguments.length){k=arguments[0];m=arguments[1];r=arguments[2];if(k===m)return!0;if(null===k||null===m||k.length!==m.length)return!1;for(var p=0;p<k.length;p++)if(0!==r.compare(k[p],m[p]))return!1;return!0}};cb.intersection=function(k,m){for(var r=new Tg,p=0;p<k.length;p++)m.intersects(k[p])&&r.add(k[p],!0);return r.toCoordinateArray()};
cb.hasRepeatedPoints=function(k){for(var m=1;m<k.length;m++)if(k[m-1].equals(k[m]))return!0;return!1};cb.removeRepeatedPoints=function(k){return cb.hasRepeatedPoints(k)?(new Tg(k,!1)).toCoordinateArray():k};cb.reverse=function(k){for(var m=k.length-1,r=Math.trunc(m/2),p=0;p<=r;p++){var u=k[p];k[p]=k[m-p];k[m-p]=u}};cb.removeNull=function(k){for(var m=0,r=0;r<k.length;r++)null!==k[r]&&m++;r=Array(m).fill(null);if(0===m)return r;for(var p=m=0;p<k.length;p++)null!==k[p]&&(r[m++]=k[p]);return r};cb.copyDeep=
function(){if(1===arguments.length){for(var k=arguments[0],m=Array(k.length).fill(null),r=0;r<k.length;r++)m[r]=new ua(k[r]);return m}if(5===arguments.length){k=arguments[0];m=arguments[1];r=arguments[2];for(var p=arguments[3],u=arguments[4],x=0;x<u;x++)r[p+x]=new ua(k[m+x])}};cb.isEqualReversed=function(k,m){for(var r=0;r<k.length;r++)if(0!==k[r].compareTo(m[k.length-r-1]))return!1;return!0};cb.envelope=function(k){for(var m=new Ka,r=0;r<k.length;r++)m.expandToInclude(k[r]);return m};cb.toCoordinateArray=
function(k){return k.toArray(cb.coordArrayType)};cb.atLeastNCoordinatesOrNothing=function(k,m){return m.length>=k?m:[]};cb.indexOf=function(k,m){for(var r=0;r<m.length;r++)if(k.equals(m[r]))return r;return-1};cb.increasingDirection=function(k){for(var m=0;m<Math.trunc(k.length/2);m++){var r=k[m].compareTo(k[k.length-1-m]);if(0!==r)return r}return 1};cb.compare=function(k,m){for(var r=0;r<k.length&&r<m.length;){var p=k[r].compareTo(m[r]);if(0!==p)return p;r++}return r<m.length?-1:r<k.length?1:0};cb.minCoordinate=
function(k){for(var m=null,r=0;r<k.length;r++)(null===m||0<m.compareTo(k[r]))&&(m=k[r]);return m};cb.extract=function(k,m,r){m=fd.clamp(m,0,k.length);var p=(r=fd.clamp(r,-1,k.length))-m+1;0>r&&(p=0);m>=k.length&&(p=0);r<m&&(p=0);var u=Array(p).fill(null);if(0===p)return u;for(p=0;m<=r;m++)u[p++]=k[m];return u};Object.defineProperties(cb,ai);var Ug=function(){};Ug.prototype.compare=function(k,m){return cb.compare(k,m)};Ug.prototype.interfaces_=function(){return[Rf]};Ug.prototype.getClass=function(){return Ug};
var $f=function(){};$f.prototype.compare=function(k,m){if(k.length<m.length)return-1;if(k.length>m.length)return 1;if(0===k.length)return 0;var r=cb.compare(k,m);return cb.isEqualReversed(k,m)?0:r};$f.prototype.OLDcompare=function(k,m){if(k.length<m.length)return-1;if(k.length>m.length)return 1;if(0===k.length)return 0;for(var r=cb.increasingDirection(k),p=cb.increasingDirection(m),u=0<r?0:k.length-1,x=0<p?0:k.length-1,v=0;v<k.length;v++){var y=k[u].compareTo(m[x]);if(0!==y)return y;u+=r;x+=p}return 0};
$f.prototype.interfaces_=function(){return[Rf]};$f.prototype.getClass=function(){return $f};var sf=function(){};sf.prototype.get=function(){};sf.prototype.put=function(){};sf.prototype.size=function(){};sf.prototype.values=function(){};sf.prototype.entrySet=function(){};var xp=function(k){function m(){k.apply(this,arguments)}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m}(sf);Hg.prototype=Error();Hg.prototype.name="OperationNotSupported";Lh.prototype=
new mc;Lh.prototype.contains=function(){};var Hj=function(k){function m(r){k.call(this);this.array_=[];r instanceof mc&&this.addAll(r)}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m.prototype.contains=function(r){for(var p=0,u=this.array_.length;p<u;p++)if(this.array_[p]===r)return!0;return!1},m.prototype.add=function(r){return!this.contains(r)&&(this.array_.push(r),!0)},m.prototype.addAll=function(r){for(r=r.iterator();r.hasNext();)this.add(r.next());
return!0},m.prototype.remove=function(r){throw Error();},m.prototype.size=function(){return this.array_.length},m.prototype.isEmpty=function(){return 0===this.array_.length},m.prototype.toArray=function(){for(var r=[],p=0,u=this.array_.length;p<u;p++)r.push(this.array_[p]);return r},m.prototype.iterator=function(){return new yp(this)},m}(Lh),yp=function(k){function m(r){k.call(this);this.hashSet_=r;this.position_=0}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=
m,m.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Mf;return this.hashSet_.array_[this.position_++]},m.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},m.prototype.remove=function(){throw new Hg;},m}(Zf);Bc.prototype=new xp;Bc.prototype.get=function(k){for(var m=this.root_;null!==m;){var r=k.compareTo(m.key);if(0>r)m=m.left;else{if(!(0<r))return m.value;m=m.right}}return null};Bc.prototype.put=function(k,m){if(null===this.root_)return this.root_=
{key:k,value:m,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var r,p,u=this.root_;do if(r=u,0>(p=k.compareTo(u.key)))u=u.left;else{if(!(0<p))return r=u.value,u.value=m,r;u=u.right}while(null!==u);m={key:k,left:null,right:null,value:m,parent:r,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>p?r.left=m:r.right=m,this.fixAfterInsertion(m),this.size_++,null};Bc.prototype.fixAfterInsertion=
function(k){for(k.color=1;null!=k&&k!==this.root_&&1===k.parent.color;)if(Tb(k)===ij(Tb(Tb(k)))){var m=bm(Tb(Tb(k)));1===(null===m?0:m.color)?(me(Tb(k),0),me(m,0),me(Tb(Tb(k)),1),k=Tb(Tb(k))):(k===bm(Tb(k))&&(k=Tb(k),this.rotateLeft(k)),me(Tb(k),0),me(Tb(Tb(k)),1),this.rotateRight(Tb(Tb(k))))}else m=ij(Tb(Tb(k))),1===(null===m?0:m.color)?(me(Tb(k),0),me(m,0),me(Tb(Tb(k)),1),k=Tb(Tb(k))):(k===ij(Tb(k))&&(k=Tb(k),this.rotateRight(k)),me(Tb(k),0),me(Tb(Tb(k)),1),this.rotateLeft(Tb(Tb(k))));this.root_.color=
0};Bc.prototype.values=function(){var k=new Fa,m=this.getFirstEntry();if(null!==m)for(k.add(m.value);null!==(m=Bc.successor(m));)k.add(m.value);return k};Bc.prototype.entrySet=function(){var k=new Hj,m=this.getFirstEntry();if(null!==m)for(k.add(m);null!==(m=Bc.successor(m));)k.add(m);return k};Bc.prototype.rotateLeft=function(k){if(null!=k){var m=k.right;k.right=m.left;null!=m.left&&(m.left.parent=k);m.parent=k.parent;null===k.parent?this.root_=m:k.parent.left===k?k.parent.left=m:k.parent.right=m;
m.left=k;k.parent=m}};Bc.prototype.rotateRight=function(k){if(null!=k){var m=k.left;k.left=m.right;null!=m.right&&(m.right.parent=k);m.parent=k.parent;null===k.parent?this.root_=m:k.parent.right===k?k.parent.right=m:k.parent.left=m;m.right=k;k.parent=m}};Bc.prototype.getFirstEntry=function(){var k=this.root_;if(null!=k)for(;null!=k.left;)k=k.left;return k};Bc.successor=function(k){if(null===k)return null;if(null!==k.right){for(var m=k.right;null!==m.left;)m=m.left;return m}for(m=k.parent;null!==m&&
k===m.right;)k=m,m=m.parent;return m};Bc.prototype.size=function(){return this.size_};var Vg=function(){};Vg.prototype.interfaces_=function(){return[]};Vg.prototype.getClass=function(){return Vg};cm.prototype=new Lh;Bd.prototype=new cm;Bd.prototype.contains=function(k){for(var m=0,r=this.array_.length;m<r;m++)if(0===this.array_[m].compareTo(k))return!0;return!1};Bd.prototype.add=function(k){if(this.contains(k))return!1;for(var m=0,r=this.array_.length;m<r;m++)if(1===this.array_[m].compareTo(k))return this.array_.splice(m,
0,k),!0;return this.array_.push(k),!0};Bd.prototype.addAll=function(k){for(k=k.iterator();k.hasNext();)this.add(k.next());return!0};Bd.prototype.remove=function(k){throw new Hg;};Bd.prototype.size=function(){return this.array_.length};Bd.prototype.isEmpty=function(){return 0===this.array_.length};Bd.prototype.toArray=function(){for(var k=[],m=0,r=this.array_.length;m<r;m++)k.push(this.array_[m]);return k};Bd.prototype.iterator=function(){return new bi(this)};var bi=function(k){this.treeSet_=k;this.position_=
0};bi.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Mf;return this.treeSet_.array_[this.position_++]};bi.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};bi.prototype.remove=function(){throw new Hg;};var Ue=function(){};Ue.sort=function(){var k,m=arguments[0];if(1===arguments.length){var r=function(u,x){return u.compareTo(x)};m.sort(r)}else if(2===arguments.length){var p=arguments[1];r=function(u,x){return p.compare(u,x)};m.sort(r)}else if(3===
arguments.length)for((k=m.slice(arguments[1],arguments[2])).sort(),r=m.slice(0,arguments[1]).concat(k,m.slice(arguments[2],m.length)),m.splice(0,m.length),k=0;k<r.length;k++)m.push(r[k]);else if(4===arguments.length)for(k=m.slice(arguments[1],arguments[2]),p=arguments[3],r=function(u,x){return p.compare(u,x)},k.sort(r),r=m.slice(0,arguments[1]).concat(k,m.slice(arguments[2],m.length)),m.splice(0,m.length),k=0;k<r.length;k++)m.push(r[k])};Ue.asList=function(k){for(var m=new Fa,r=0,p=k.length;r<p;r++)m.add(k[r]);
return m};var Hb=function(){},vd={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};vd.P.get=function(){return 0};vd.L.get=function(){return 1};vd.A.get=function(){return 2};vd.FALSE.get=function(){return-1};vd.TRUE.get=function(){return-2};vd.DONTCARE.get=function(){return-3};
vd.SYM_FALSE.get=function(){return"F"};vd.SYM_TRUE.get=function(){return"T"};vd.SYM_DONTCARE.get=function(){return"*"};vd.SYM_P.get=function(){return"0"};vd.SYM_L.get=function(){return"1"};vd.SYM_A.get=function(){return"2"};Hb.prototype.interfaces_=function(){return[]};Hb.prototype.getClass=function(){return Hb};Hb.toDimensionSymbol=function(k){switch(k){case Hb.FALSE:return Hb.SYM_FALSE;case Hb.TRUE:return Hb.SYM_TRUE;case Hb.DONTCARE:return Hb.SYM_DONTCARE;case Hb.P:return Hb.SYM_P;case Hb.L:return Hb.SYM_L;
case Hb.A:return Hb.SYM_A}throw new cc("Unknown dimension value: "+k);};Hb.toDimensionValue=function(k){switch(Rg.toUpperCase(k)){case Hb.SYM_FALSE:return Hb.FALSE;case Hb.SYM_TRUE:return Hb.TRUE;case Hb.SYM_DONTCARE:return Hb.DONTCARE;case Hb.SYM_P:return Hb.P;case Hb.SYM_L:return Hb.L;case Hb.SYM_A:return Hb.A}throw new cc("Unknown dimension symbol: "+k);};Object.defineProperties(Hb,vd);var Ve=function(){};Ve.prototype.filter=function(k){};Ve.prototype.interfaces_=function(){return[]};Ve.prototype.getClass=
function(){return Ve};var Xd=function(){};Xd.prototype.filter=function(k,m){};Xd.prototype.isDone=function(){};Xd.prototype.isGeometryChanged=function(){};Xd.prototype.interfaces_=function(){return[]};Xd.prototype.getClass=function(){return Xd};var wd=function(k){function m(p,u){if(k.call(this,u),this._geometries=p||[],k.hasNullElements(this._geometries))throw new cc("geometries must not contain null elements");}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=
m;var r={serialVersionUID:{configurable:!0}};return m.prototype.computeEnvelopeInternal=function(){for(var p=new Ka,u=0;u<this._geometries.length;u++)p.expandToInclude(this._geometries[u].getEnvelopeInternal());return p},m.prototype.getGeometryN=function(p){return this._geometries[p]},m.prototype.getSortIndex=function(){return k.SORTINDEX_GEOMETRYCOLLECTION},m.prototype.getCoordinates=function(){for(var p=Array(this.getNumPoints()).fill(null),u=-1,x=0;x<this._geometries.length;x++)for(var v=this._geometries[x].getCoordinates(),
y=0;y<v.length;y++)p[++u]=v[y];return p},m.prototype.getArea=function(){for(var p=0,u=0;u<this._geometries.length;u++)p+=this._geometries[u].getArea();return p},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];if(!this.isEquivalentClass(p)||this._geometries.length!==p._geometries.length)return!1;for(var x=0;x<this._geometries.length;x++)if(!this._geometries[x].equalsExact(p._geometries[x],u))return!1;return!0}return k.prototype.equalsExact.apply(this,arguments)},
m.prototype.normalize=function(){for(var p=0;p<this._geometries.length;p++)this._geometries[p].normalize();Ue.sort(this._geometries)},m.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},m.prototype.getBoundaryDimension=function(){for(var p=Hb.FALSE,u=0;u<this._geometries.length;u++)p=Math.max(p,this._geometries[u].getBoundaryDimension());return p},m.prototype.getDimension=function(){for(var p=Hb.FALSE,u=0;u<this._geometries.length;u++)p=Math.max(p,
this._geometries[u].getDimension());return p},m.prototype.getLength=function(){for(var p=0,u=0;u<this._geometries.length;u++)p+=this._geometries[u].getLength();return p},m.prototype.getNumPoints=function(){for(var p=0,u=0;u<this._geometries.length;u++)p+=this._geometries[u].getNumPoints();return p},m.prototype.getNumGeometries=function(){return this._geometries.length},m.prototype.reverse=function(){for(var p=Array(this._geometries.length).fill(null),u=0;u<this._geometries.length;u++)p[u]=this._geometries[u].reverse();
return this.getFactory().createGeometryCollection(p)},m.prototype.compareToSameClass=function(){if(1===arguments.length){var p=arguments[0],u=new Bd(Ue.asList(this._geometries));p=new Bd(Ue.asList(p._geometries));return this.compare(u,p)}if(2===arguments.length){u=arguments[1];p=arguments[0];for(var x=this.getNumGeometries(),v=p.getNumGeometries(),y=0;y<x&&y<v;){var B=this.getGeometryN(y),G=p.getGeometryN(y);B=B.compareToSameClass(G,u);if(0!==B)return B;y++}return y<x?1:y<v?-1:0}},m.prototype.apply=
function(p){if(Xa(p,Fe))for(var u=0;u<this._geometries.length;u++)this._geometries[u].apply(p);else if(Xa(p,Xd)){if(0===this._geometries.length)return null;for(u=0;u<this._geometries.length&&(this._geometries[u].apply(p),!p.isDone());u++);p.isGeometryChanged()&&this.geometryChanged()}else if(Xa(p,Ve))for(p.filter(this),u=0;u<this._geometries.length;u++)this._geometries[u].apply(p);else if(Xa(p,te))for(p.filter(this),u=0;u<this._geometries.length;u++)this._geometries[u].apply(p)},m.prototype.getBoundary=
function(){return this.checkNotGeometryCollection(this),$a.shouldNeverReachHere(),null},m.prototype.clone=function(){var p=k.prototype.clone.call(this);p._geometries=Array(this._geometries.length).fill(null);for(var u=0;u<this._geometries.length;u++)p._geometries[u]=this._geometries[u].clone();return p},m.prototype.getGeometryType=function(){return"GeometryCollection"},m.prototype.copy=function(){for(var p=Array(this._geometries.length).fill(null),u=0;u<p.length;u++)p[u]=this._geometries[u].copy();
return new m(p,this._factory)},m.prototype.isEmpty=function(){for(var p=0;p<this._geometries.length;p++)if(!this._geometries[p].isEmpty())return!1;return!0},m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(m,r),m}(Ua),We=function(k){function m(){k.apply(this,arguments)}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={serialVersionUID:{configurable:!0}};
return m.prototype.getSortIndex=function(){return Ua.SORTINDEX_MULTILINESTRING},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];return!!this.isEquivalentClass(p)&&k.prototype.equalsExact.call(this,p,u)}return k.prototype.equalsExact.apply(this,arguments)},m.prototype.getBoundaryDimension=function(){return this.isClosed()?Hb.FALSE:0},m.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var p=0;p<this._geometries.length;p++)if(!this._geometries[p].isClosed())return!1;
return!0},m.prototype.getDimension=function(){return 1},m.prototype.reverse=function(){for(var p=this._geometries.length,u=Array(p).fill(null),x=0;x<this._geometries.length;x++)u[p-1-x]=this._geometries[x].reverse();return this.getFactory().createMultiLineString(u)},m.prototype.getBoundary=function(){return(new od(this)).getBoundary()},m.prototype.getGeometryType=function(){return"MultiLineString"},m.prototype.copy=function(){for(var p=Array(this._geometries.length).fill(null),u=0;u<p.length;u++)p[u]=
this._geometries[u].copy();return new m(p,this._factory)},m.prototype.interfaces_=function(){return[Vg]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(m,r),m}(wd),od=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var k=arguments[0],m=nd.MOD2_BOUNDARY_RULE;this._geom=k;this._geomFact=k.getFactory();this._bnRule=m}else 2===arguments.length&&(k=arguments[0],
m=arguments[1],this._geom=k,this._geomFact=k.getFactory(),this._bnRule=m)};od.prototype.boundaryMultiLineString=function(k){if(this._geom.isEmpty())return this.getEmptyMultiPoint();k=this.computeBoundaryCoordinates(k);return 1===k.length?this._geomFact.createPoint(k[0]):this._geomFact.createMultiPointFromCoords(k)};od.prototype.getBoundary=function(){return this._geom instanceof Ic?this.boundaryLineString(this._geom):this._geom instanceof We?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};
od.prototype.boundaryLineString=function(k){return this._geom.isEmpty()?this.getEmptyMultiPoint():k.isClosed()?this._bnRule.isInBoundary(2)?k.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([k.getStartPoint(),k.getEndPoint()])};od.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};od.prototype.computeBoundaryCoordinates=function(k){var m=new Fa;this._endpointMap=new Bc;for(var r=0;r<k.getNumGeometries();r++){var p=k.getGeometryN(r);
0!==p.getNumPoints()&&(this.addEndpoint(p.getCoordinateN(0)),this.addEndpoint(p.getCoordinateN(p.getNumPoints()-1)))}for(k=this._endpointMap.entrySet().iterator();k.hasNext();)r=k.next(),p=r.getValue().count,this._bnRule.isInBoundary(p)&&m.add(r.getKey());return cb.toCoordinateArray(m)};od.prototype.addEndpoint=function(k){var m=this._endpointMap.get(k);null===m&&(m=new ci,this._endpointMap.put(k,m));m.count++};od.prototype.interfaces_=function(){return[]};od.prototype.getClass=function(){return od};
od.getBoundary=function(){if(1===arguments.length)return(new od(arguments[0])).getBoundary();if(2===arguments.length)return(new od(arguments[0],arguments[1])).getBoundary()};var ci=function(){this.count=null};ci.prototype.interfaces_=function(){return[]};ci.prototype.getClass=function(){return ci};var zp=function(){},pd=function(){},Ij={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};pd.prototype.interfaces_=function(){return[]};pd.prototype.getClass=function(){return pd};pd.chars=
function(k,m){for(var r=Array(m).fill(null),p=0;p<m;p++)r[p]=k;return String(r)};pd.getStackTrace=function(){if(1===arguments.length){var k=arguments[0],m=new Ho,r=new Fo(m);return k.printStackTrace(r),m.toString()}if(2===arguments.length){k=arguments[1];m="";r=new Go(pd.getStackTrace(arguments[0]));r=new Io(r);for(var p=0;p<k;p++)try{m+=r.readLine()+pd.NEWLINE}catch(u){throw u;}return m}};pd.split=function(k,m){var r=m.length,p=new Fa;k=""+k;for(var u=k.indexOf(m);0<=u;){var x=k.substring(0,u);p.add(x);
u=(k=k.substring(u+r)).indexOf(m)}0<k.length&&p.add(k);m=Array(p.size()).fill(null);for(r=0;r<m.length;r++)m[r]=p.get(r);return m};pd.toString=function(){if(1===arguments.length)return pd.SIMPLE_ORDINATE_FORMAT.format(arguments[0])};pd.spaces=function(k){return pd.chars(" ",k)};Ij.NEWLINE.get=function(){return Pc.getProperty("line.separator")};Ij.SIMPLE_ORDINATE_FORMAT.get=function(){return new zp("0.#")};Object.defineProperties(pd,Ij);var fc=function(){};fc.prototype.interfaces_=function(){return[]};
fc.prototype.getClass=function(){return fc};fc.copyCoord=function(k,m,r,p){for(var u=Math.min(k.getDimension(),r.getDimension()),x=0;x<u;x++)r.setOrdinate(p,x,k.getOrdinate(m,x))};fc.isRing=function(k){var m=k.size();return 0===m||!(3>=m)&&k.getOrdinate(0,gb.X)===k.getOrdinate(m-1,gb.X)&&k.getOrdinate(0,gb.Y)===k.getOrdinate(m-1,gb.Y)};fc.isEqual=function(k,m){var r=k.size();if(r!==m.size())return!1;for(var p=Math.min(k.getDimension(),m.getDimension()),u=0;u<r;u++)for(var x=0;x<p;x++){var v=k.getOrdinate(u,
x),y=m.getOrdinate(u,x);if(!(k.getOrdinate(u,x)===m.getOrdinate(u,x)||Za.isNaN(v)&&Za.isNaN(y)))return!1}return!0};fc.extend=function(k,m,r){k=k.create(r,m.getDimension());var p=m.size();if(fc.copy(m,0,k,0,p),0<p)for(var u=p;u<r;u++)fc.copy(m,p-1,k,u,1);return k};fc.reverse=function(k){for(var m=k.size()-1,r=Math.trunc(m/2),p=0;p<=r;p++)fc.swap(k,p,m-p)};fc.swap=function(k,m,r){if(m===r)return null;for(var p=0;p<k.getDimension();p++){var u=k.getOrdinate(m,p);k.setOrdinate(m,p,k.getOrdinate(r,p));
k.setOrdinate(r,p,u)}};fc.copy=function(k,m,r,p,u){for(var x=0;x<u;x++)fc.copyCoord(k,m+x,r,p+x)};fc.toString=function(){if(1===arguments.length){var k=arguments[0],m=k.size();if(0===m)return"()";var r=k.getDimension(),p=new Ed;p.append("(");for(var u=0;u<m;u++){0<u&&p.append(" ");for(var x=0;x<r;x++)0<x&&p.append(","),p.append(pd.toString(k.getOrdinate(u,x)))}return p.append(")"),p.toString()}};fc.ensureValidRing=function(k,m){var r=m.size();return 0===r?m:3>=r?fc.createClosedRing(k,m,4):m.getOrdinate(0,
gb.X)===m.getOrdinate(r-1,gb.X)&&m.getOrdinate(0,gb.Y)===m.getOrdinate(r-1,gb.Y)?m:fc.createClosedRing(k,m,r+1)};fc.createClosedRing=function(k,m,r){k=k.create(r,m.getDimension());var p=m.size();for(fc.copy(m,0,k,0,p);p<r;p++)fc.copy(m,0,k,p,1);return k};var Ic=function(k){function m(p,u){k.call(this,u);this._points=null;this.init(p)}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={serialVersionUID:{configurable:!0}};return m.prototype.computeEnvelopeInternal=
function(){return this.isEmpty()?new Ka:this._points.expandEnvelope(new Ka)},m.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},m.prototype.getSortIndex=function(){return k.SORTINDEX_LINESTRING},m.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];if(!this.isEquivalentClass(p)||this._points.size()!==p._points.size())return!1;for(var x=0;x<this._points.size();x++)if(!this.equal(this._points.getCoordinate(x),
p._points.getCoordinate(x),u))return!1;return!0}return k.prototype.equalsExact.apply(this,arguments)},m.prototype.normalize=function(){for(var p=0;p<Math.trunc(this._points.size()/2);p++){var u=this._points.size()-1-p;if(!this._points.getCoordinate(p).equals(this._points.getCoordinate(u)))return 0<this._points.getCoordinate(p).compareTo(this._points.getCoordinate(u))&&fc.reverse(this._points),null}},m.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},m.prototype.getBoundaryDimension=
function(){return this.isClosed()?Hb.FALSE:0},m.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},m.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},m.prototype.getDimension=function(){return 1},m.prototype.getLength=function(){return Da.computeLength(this._points)},m.prototype.getNumPoints=function(){return this._points.size()},m.prototype.reverse=function(){var p=this._points.copy();
return fc.reverse(p),this.getFactory().createLineString(p)},m.prototype.compareToSameClass=function(){if(1===arguments.length){for(var p=arguments[0],u=0,x=0;u<this._points.size()&&x<p._points.size();){var v=this._points.getCoordinate(u).compareTo(p._points.getCoordinate(x));if(0!==v)return v;u++;x++}return u<this._points.size()?1:x<p._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},m.prototype.apply=function(p){if(Xa(p,Fe))for(var u=0;u<
this._points.size();u++)p.filter(this._points.getCoordinate(u));else if(Xa(p,Xd)){if(0===this._points.size())return null;for(u=0;u<this._points.size()&&(p.filter(this._points,u),!p.isDone());u++);p.isGeometryChanged()&&this.geometryChanged()}else Xa(p,Ve)?p.filter(this):Xa(p,te)&&p.filter(this)},m.prototype.getBoundary=function(){return(new od(this)).getBoundary()},m.prototype.isEquivalentClass=function(p){return p instanceof m},m.prototype.clone=function(){var p=k.prototype.clone.call(this);return p._points=
this._points.clone(),p},m.prototype.getCoordinateN=function(p){return this._points.getCoordinate(p)},m.prototype.getGeometryType=function(){return"LineString"},m.prototype.copy=function(){return new m(this._points.copy(),this._factory)},m.prototype.getCoordinateSequence=function(){return this._points},m.prototype.isEmpty=function(){return 0===this._points.size()},m.prototype.init=function(p){if(null===p&&(p=this.getFactory().getCoordinateSequenceFactory().create([])),1===p.size())throw new cc("Invalid number of points in LineString (found "+
p.size()+" - must be 0 or >= 2)");this._points=p},m.prototype.isCoordinate=function(p){for(var u=0;u<this._points.size();u++)if(this._points.getCoordinate(u).equals(p))return!0;return!1},m.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},m.prototype.getPointN=function(p){return this.getFactory().createPoint(this._points.getCoordinate(p))},m.prototype.interfaces_=function(){return[Vg]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},
Object.defineProperties(m,r),m}(Ua),Wg=function(){};Wg.prototype.interfaces_=function(){return[]};Wg.prototype.getClass=function(){return Wg};var Yd=function(k){function m(p,u){k.call(this,u);this._coordinates=p||null;this.init(this._coordinates)}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={serialVersionUID:{configurable:!0}};return m.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ka;var p=new Ka;return p.expandToInclude(this._coordinates.getX(0),
this._coordinates.getY(0)),p},m.prototype.getSortIndex=function(){return k.SORTINDEX_POINT},m.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];return!!this.isEquivalentClass(p)&&(!(!this.isEmpty()||!p.isEmpty())||this.isEmpty()===p.isEmpty()&&this.equal(p.getCoordinate(),this.getCoordinate(),u))}return k.prototype.equalsExact.apply(this,arguments)},m.prototype.normalize=
function(){},m.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},m.prototype.getBoundaryDimension=function(){return Hb.FALSE},m.prototype.getDimension=function(){return 0},m.prototype.getNumPoints=function(){return this.isEmpty()?0:1},m.prototype.reverse=function(){return this.copy()},m.prototype.getX=function(){if(null===this.getCoordinate())throw Error("getX called on empty Point");return this.getCoordinate().x},m.prototype.compareToSameClass=
function(){if(1===arguments.length){var p=arguments[0];return this.getCoordinate().compareTo(p.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},m.prototype.apply=function(p){if(Xa(p,Fe)){if(this.isEmpty())return null;p.filter(this.getCoordinate())}else if(Xa(p,Xd)){if(this.isEmpty())return null;p.filter(this._coordinates,0);p.isGeometryChanged()&&this.geometryChanged()}else Xa(p,Ve)?p.filter(this):Xa(p,te)&&p.filter(this)},m.prototype.getBoundary=
function(){return this.getFactory().createGeometryCollection(null)},m.prototype.clone=function(){var p=k.prototype.clone.call(this);return p._coordinates=this._coordinates.clone(),p},m.prototype.getGeometryType=function(){return"Point"},m.prototype.copy=function(){return new m(this._coordinates.copy(),this._factory)},m.prototype.getCoordinateSequence=function(){return this._coordinates},m.prototype.getY=function(){if(null===this.getCoordinate())throw Error("getY called on empty Point");return this.getCoordinate().y},
m.prototype.isEmpty=function(){return 0===this._coordinates.size()},m.prototype.init=function(p){null===p&&(p=this.getFactory().getCoordinateSequenceFactory().create([]));$a.isTrue(1>=p.size());this._coordinates=p},m.prototype.isSimple=function(){return!0},m.prototype.interfaces_=function(){return[Wg]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(m,r),m}(Ua),Xe=function(){};Xe.prototype.interfaces_=function(){return[]};
Xe.prototype.getClass=function(){return Xe};var Hd=function(k){function m(p,u,x){if(k.call(this,x),this._shell=null,this._holes=null,null===p&&(p=this.getFactory().createLinearRing()),null===u&&(u=[]),k.hasNullElements(u))throw new cc("holes must not contain null elements");if(p.isEmpty()&&k.hasNonEmptyElements(u))throw new cc("shell is empty but holes are not");this._shell=p;this._holes=u}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={serialVersionUID:{configurable:!0}};
return m.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},m.prototype.getSortIndex=function(){return k.SORTINDEX_POLYGON},m.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var p=Array(this.getNumPoints()).fill(null),u=-1,x=this._shell.getCoordinates(),v=0;v<x.length;v++)p[++u]=x[v];for(x=0;x<this._holes.length;x++){v=this._holes[x].getCoordinates();for(var y=0;y<v.length;y++)p[++u]=v[y]}return p},m.prototype.getArea=function(){var p=0+Math.abs(Da.signedArea(this._shell.getCoordinateSequence()));
for(var u=0;u<this._holes.length;u++)p-=Math.abs(Da.signedArea(this._holes[u].getCoordinateSequence()));return p},m.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var p=this._shell.getCoordinateSequence(),u=this.getEnvelopeInternal(),x=0;5>x;x++){var v=p.getX(x);if(v!==u.getMinX()&&v!==u.getMaxX())return!1;v=p.getY(x);if(v!==u.getMinY()&&v!==u.getMaxY())return!1}u=p.getX(0);x=p.getY(0);for(v=1;4>=v;v++){var y=p.getX(v),
B=p.getY(v);if(y!==u===(B!==x))return!1;u=y;x=B}return!0},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];if(!this.isEquivalentClass(p)||!this._shell.equalsExact(p._shell,u)||this._holes.length!==p._holes.length)return!1;for(var x=0;x<this._holes.length;x++)if(!this._holes[x].equalsExact(p._holes[x],u))return!1;return!0}return k.prototype.equalsExact.apply(this,arguments)},m.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,
!0);for(var p=0;p<this._holes.length;p++)this.normalize(this._holes[p],!1);Ue.sort(this._holes)}else if(2===arguments.length){p=arguments[0];var u=arguments[1];if(p.isEmpty())return null;var x=Array(p.getCoordinates().length-1).fill(null);Pc.arraycopy(p.getCoordinates(),0,x,0,x.length);var v=cb.minCoordinate(p.getCoordinates());cb.scroll(x,v);Pc.arraycopy(x,0,p.getCoordinates(),0,x.length);p.getCoordinates()[x.length]=x[0];Da.isCCW(p.getCoordinates())===u&&cb.reverse(p.getCoordinates())}},m.prototype.getCoordinate=
function(){return this._shell.getCoordinate()},m.prototype.getNumInteriorRing=function(){return this._holes.length},m.prototype.getBoundaryDimension=function(){return 1},m.prototype.getDimension=function(){return 2},m.prototype.getLength=function(){var p=0+this._shell.getLength();for(var u=0;u<this._holes.length;u++)p+=this._holes[u].getLength();return p},m.prototype.getNumPoints=function(){for(var p=this._shell.getNumPoints(),u=0;u<this._holes.length;u++)p+=this._holes[u].getNumPoints();return p},
m.prototype.reverse=function(){var p=this.copy();p._shell=this._shell.copy().reverse();p._holes=Array(this._holes.length).fill(null);for(var u=0;u<this._holes.length;u++)p._holes[u]=this._holes[u].copy().reverse();return p},m.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},m.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var p=arguments[1],u=arguments[0],x=this._shell.compareToSameClass(u._shell,
p);if(0!==x)return x;x=this.getNumInteriorRing();for(var v=u.getNumInteriorRing(),y=0;y<x&&y<v;){var B=this.getInteriorRingN(y),G=u.getInteriorRingN(y);B=B.compareToSameClass(G,p);if(0!==B)return B;y++}return y<x?1:y<v?-1:0}},m.prototype.apply=function(p){if(Xa(p,Fe)){this._shell.apply(p);for(var u=0;u<this._holes.length;u++)this._holes[u].apply(p)}else if(Xa(p,Xd)){if(this._shell.apply(p),!p.isDone())for(u=0;u<this._holes.length&&(this._holes[u].apply(p),!p.isDone());u++);p.isGeometryChanged()&&
this.geometryChanged()}else if(Xa(p,Ve))p.filter(this);else if(Xa(p,te))for(p.filter(this),this._shell.apply(p),u=0;u<this._holes.length;u++)this._holes[u].apply(p)},m.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var p=Array(this._holes.length+1).fill(null);p[0]=this._shell;for(var u=0;u<this._holes.length;u++)p[u+1]=this._holes[u];return 1>=p.length?this.getFactory().createLinearRing(p[0].getCoordinateSequence()):this.getFactory().createMultiLineString(p)},
m.prototype.clone=function(){var p=k.prototype.clone.call(this);p._shell=this._shell.clone();p._holes=Array(this._holes.length).fill(null);for(var u=0;u<this._holes.length;u++)p._holes[u]=this._holes[u].clone();return p},m.prototype.getGeometryType=function(){return"Polygon"},m.prototype.copy=function(){for(var p=this._shell.copy(),u=Array(this._holes.length).fill(null),x=0;x<u.length;x++)u[x]=this._holes[x].copy();return new m(p,u,this._factory)},m.prototype.getExteriorRing=function(){return this._shell},
m.prototype.isEmpty=function(){return this._shell.isEmpty()},m.prototype.getInteriorRingN=function(p){return this._holes[p]},m.prototype.interfaces_=function(){return[Xe]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(m,r),m}(Ua),ag=function(k){function m(){k.apply(this,arguments)}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={serialVersionUID:{configurable:!0}};return m.prototype.getSortIndex=
function(){return Ua.SORTINDEX_MULTIPOINT},m.prototype.isValid=function(){return!0},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];return!!this.isEquivalentClass(p)&&k.prototype.equalsExact.call(this,p,u)}return k.prototype.equalsExact.apply(this,arguments)},m.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():k.prototype.getCoordinate.apply(this,arguments)},m.prototype.getBoundaryDimension=function(){return Hb.FALSE},
m.prototype.getDimension=function(){return 0},m.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},m.prototype.getGeometryType=function(){return"MultiPoint"},m.prototype.copy=function(){for(var p=Array(this._geometries.length).fill(null),u=0;u<p.length;u++)p[u]=this._geometries[u].copy();return new m(p,this._factory)},m.prototype.interfaces_=function(){return[Wg]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},
Object.defineProperties(m,r),m}(wd),Zd=function(k){function m(p,u){p instanceof ua&&u instanceof db&&(p=u.getCoordinateSequenceFactory().create(p));k.call(this,p,u);this.validateConstruction()}k&&(m.__proto__=k);m.prototype=Object.create(k&&k.prototype);m.prototype.constructor=m;var r={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return m.prototype.getSortIndex=function(){return Ua.SORTINDEX_LINEARRING},m.prototype.getBoundaryDimension=function(){return Hb.FALSE},m.prototype.isClosed=
function(){return!!this.isEmpty()||k.prototype.isClosed.call(this)},m.prototype.reverse=function(){var p=this._points.copy();return fc.reverse(p),this.getFactory().createLinearRing(p)},m.prototype.validateConstruction=function(){if(!this.isEmpty()&&!k.prototype.isClosed.call(this))throw new cc("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<m.MINIMUM_VALID_SIZE)throw new cc("Invalid number of points in LinearRing (found "+
this.getCoordinateSequence().size()+" - must be 0 or >= 4)");},m.prototype.getGeometryType=function(){return"LinearRing"},m.prototype.copy=function(){return new m(this._points.copy(),this._factory)},m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},r.MINIMUM_VALID_SIZE.get=function(){return 4},r.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(m,r),m}(Ic),Ge=function(k){function m(){k.apply(this,arguments)}k&&(m.__proto__=k);m.prototype=
Object.create(k&&k.prototype);m.prototype.constructor=m;var r={serialVersionUID:{configurable:!0}};return m.prototype.getSortIndex=function(){return Ua.SORTINDEX_MULTIPOLYGON},m.prototype.equalsExact=function(){if(2===arguments.length){var p=arguments[0],u=arguments[1];return!!this.isEquivalentClass(p)&&k.prototype.equalsExact.call(this,p,u)}return k.prototype.equalsExact.apply(this,arguments)},m.prototype.getBoundaryDimension=function(){return 1},m.prototype.getDimension=function(){return 2},m.prototype.reverse=
function(){for(var p=Array(this._geometries.length).fill(null),u=0;u<this._geometries.length;u++)p[u]=this._geometries[u].reverse();return this.getFactory().createMultiPolygon(p)},m.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var p=new Fa,u=0;u<this._geometries.length;u++)for(var x=this._geometries[u].getBoundary(),v=0;v<x.getNumGeometries();v++)p.add(x.getGeometryN(v));u=Array(p.size()).fill(null);return this.getFactory().createMultiLineString(p.toArray(u))},
m.prototype.getGeometryType=function(){return"MultiPolygon"},m.prototype.copy=function(){for(var p=Array(this._geometries.length).fill(null),u=0;u<p.length;u++)p[u]=this._geometries[u].copy();return new m(p,this._factory)},m.prototype.interfaces_=function(){return[Xe]},m.prototype.getClass=function(){return m},r.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(m,r),m}(wd),qd=function(k){this._factory=k||null;this._isUserDataCopied=!1},di={NoOpGeometryOperation:{configurable:!0},
CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};qd.prototype.setCopyUserData=function(k){this._isUserDataCopied=k};qd.prototype.edit=function(k,m){if(null===k)return null;m=this.editInternal(k,m);return this._isUserDataCopied&&m.setUserData(k.getUserData()),m};qd.prototype.editInternal=function(k,m){return null===this._factory&&(this._factory=k.getFactory()),k instanceof wd?this.editGeometryCollection(k,m):k instanceof Hd?this.editPolygon(k,m):k instanceof Yd||
k instanceof Ic?m.edit(k,this._factory):($a.shouldNeverReachHere("Unsupported Geometry class: "+k.getClass().getName()),null)};qd.prototype.editGeometryCollection=function(k,m){k=m.edit(k,this._factory);for(var r=new Fa,p=0;p<k.getNumGeometries();p++){var u=this.edit(k.getGeometryN(p),m);null===u||u.isEmpty()||r.add(u)}return k.getClass()===ag?this._factory.createMultiPoint(r.toArray([])):k.getClass()===We?this._factory.createMultiLineString(r.toArray([])):k.getClass()===Ge?this._factory.createMultiPolygon(r.toArray([])):
this._factory.createGeometryCollection(r.toArray([]))};qd.prototype.editPolygon=function(k,m){k=m.edit(k,this._factory);if(null===k&&(k=this._factory.createPolygon(null)),k.isEmpty())return k;var r=this.edit(k.getExteriorRing(),m);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var p=new Fa,u=0;u<k.getNumInteriorRing();u++){var x=this.edit(k.getInteriorRingN(u),m);null===x||x.isEmpty()||p.add(x)}return this._factory.createPolygon(r,p.toArray([]))};qd.prototype.interfaces_=function(){return[]};
qd.prototype.getClass=function(){return qd};qd.GeometryEditorOperation=function(){};di.NoOpGeometryOperation.get=function(){return Xg};di.CoordinateOperation.get=function(){return Yg};di.CoordinateSequenceOperation.get=function(){return Zg};Object.defineProperties(qd,di);var Xg=function(){};Xg.prototype.edit=function(k,m){return k};Xg.prototype.interfaces_=function(){return[qd.GeometryEditorOperation]};Xg.prototype.getClass=function(){return Xg};var Yg=function(){};Yg.prototype.edit=function(k,m){var r=
this.editCoordinates(k.getCoordinates(),k);return null===r?k:k instanceof Zd?m.createLinearRing(r):k instanceof Ic?m.createLineString(r):k instanceof Yd?0<r.length?m.createPoint(r[0]):m.createPoint():k};Yg.prototype.interfaces_=function(){return[qd.GeometryEditorOperation]};Yg.prototype.getClass=function(){return Yg};var Zg=function(){};Zg.prototype.edit=function(k,m){return k instanceof Zd?m.createLinearRing(this.edit(k.getCoordinateSequence(),k)):k instanceof Ic?m.createLineString(this.edit(k.getCoordinateSequence(),
k)):k instanceof Yd?m.createPoint(this.edit(k.getCoordinateSequence(),k)):k};Zg.prototype.interfaces_=function(){return[qd.GeometryEditorOperation]};Zg.prototype.getClass=function(){return Zg};var jc=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length)if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var k=arguments[0];this._coordinates=Array(k).fill(null);for(var m=0;m<k;m++)this._coordinates[m]=new ua}else{if(Xa(arguments[0],
gb)){k=arguments[0];if(null===k)return this._coordinates=[].fill(null),null;this._dimension=k.getDimension();this._coordinates=Array(k.size()).fill(null);for(m=0;m<this._coordinates.length;m++)this._coordinates[m]=k.getCoordinateCopy(m)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1]))k=arguments[0],m=arguments[1],this._coordinates=k,this._dimension=m,null===k&&(this._coordinates=[].fill(null));else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1]))for(k=
arguments[0],m=arguments[1],this._coordinates=Array(k).fill(null),this._dimension=m,m=0;m<k;m++)this._coordinates[m]=new ua},kn={serialVersionUID:{configurable:!0}};jc.prototype.setOrdinate=function(k,m,r){switch(m){case gb.X:this._coordinates[k].x=r;break;case gb.Y:this._coordinates[k].y=r;break;case gb.Z:this._coordinates[k].z=r;break;default:throw new cc("invalid ordinateIndex");}};jc.prototype.size=function(){return this._coordinates.length};jc.prototype.getOrdinate=function(k,m){switch(m){case gb.X:return this._coordinates[k].x;
case gb.Y:return this._coordinates[k].y;case gb.Z:return this._coordinates[k].z}return Za.NaN};jc.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var k=arguments[0],m=arguments[1];m.x=this._coordinates[k].x;m.y=this._coordinates[k].y;m.z=this._coordinates[k].z}};jc.prototype.getCoordinateCopy=function(k){return new ua(this._coordinates[k])};jc.prototype.getDimension=function(){return this._dimension};jc.prototype.getX=function(k){return this._coordinates[k].x};
jc.prototype.clone=function(){for(var k=Array(this.size()).fill(null),m=0;m<this._coordinates.length;m++)k[m]=this._coordinates[m].clone();return new jc(k,this._dimension)};jc.prototype.expandEnvelope=function(k){for(var m=0;m<this._coordinates.length;m++)k.expandToInclude(this._coordinates[m]);return k};jc.prototype.copy=function(){for(var k=Array(this.size()).fill(null),m=0;m<this._coordinates.length;m++)k[m]=this._coordinates[m].copy();return new jc(k,this._dimension)};jc.prototype.toString=function(){if(0<
this._coordinates.length){var k=new Ed(17*this._coordinates.length);k.append("(");k.append(this._coordinates[0]);for(var m=1;m<this._coordinates.length;m++)k.append(", "),k.append(this._coordinates[m]);return k.append(")"),k.toString()}return"()"};jc.prototype.getY=function(k){return this._coordinates[k].y};jc.prototype.toCoordinateArray=function(){return this._coordinates};jc.prototype.interfaces_=function(){return[gb,ld]};jc.prototype.getClass=function(){return jc};kn.serialVersionUID.get=function(){return-0xcb44a778db18e00};
Object.defineProperties(jc,kn);var $d=function(){},Jj={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};$d.prototype.readResolve=function(){return $d.instance()};$d.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array||Xa(arguments[0],gb))return new jc(arguments[0])}else if(2===arguments.length){var k=arguments[0],m=arguments[1];return 3<m&&(m=3),2>m?new jc(k):new jc(k,m)}};$d.prototype.interfaces_=function(){return[Sf,ld]};$d.prototype.getClass=
function(){return $d};$d.instance=function(){return $d.instanceObject};Jj.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};Jj.instanceObject.get=function(){return new $d};Object.defineProperties($d,Jj);var ln=function(k){function m(){k.call(this);this.map_=new Map}return k&&(m.__proto__=k),m.prototype=Object.create(k&&k.prototype),m.prototype.constructor=m,m.prototype.get=function(r){return this.map_.get(r)||null},m.prototype.put=function(r,p){return this.map_.set(r,p),p},m.prototype.values=
function(){for(var r=new Fa,p=this.map_.values(),u=p.next();!u.done;)r.add(u.value),u=p.next();return r},m.prototype.entrySet=function(){var r=new Hj;return this.map_.entries().forEach(function(p){return r.add(p)}),r},m.prototype.size=function(){return this.map_.size()},m}(sf),Ib=function m(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=m.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Id){var r=arguments[0];this._modelType=r;r===m.FIXED&&this.setScale(1)}else"number"==
typeof arguments[0]?(r=arguments[0],this._modelType=m.FIXED,this.setScale(r)):arguments[0]instanceof m&&(r=arguments[0],this._modelType=r._modelType,this._scale=r._scale)},Kj={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Ib.prototype.equals=function(m){return m instanceof Ib?this._modelType===m._modelType&&this._scale===m._scale:!1};Ib.prototype.compareTo=function(m){var r=this.getMaximumSignificantDigits();m=m.getMaximumSignificantDigits();return(new Fd(r)).compareTo(new Fd(m))};
Ib.prototype.getScale=function(){return this._scale};Ib.prototype.isFloating=function(){return this._modelType===Ib.FLOATING||this._modelType===Ib.FLOATING_SINGLE};Ib.prototype.getType=function(){return this._modelType};Ib.prototype.toString=function(){var m="UNKNOWN";return this._modelType===Ib.FLOATING?m="Floating":this._modelType===Ib.FLOATING_SINGLE?m="Floating-Single":this._modelType===Ib.FIXED&&(m="Fixed (Scale="+this.getScale()+")"),m};Ib.prototype.makePrecise=function(m){if("number"==typeof m)return Za.isNaN(m)||
this._modelType===Ib.FLOATING_SINGLE?m:this._modelType===Ib.FIXED?Math.round(m*this._scale)/this._scale:m;if(m instanceof ua){if(this._modelType===Ib.FLOATING)return null;m.x=this.makePrecise(m.x);m.y=this.makePrecise(m.y)}};Ib.prototype.getMaximumSignificantDigits=function(){var m=16;return this._modelType===Ib.FLOATING?m=16:this._modelType===Ib.FLOATING_SINGLE?m=6:this._modelType===Ib.FIXED&&(m=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),m};Ib.prototype.setScale=function(m){this._scale=
Math.abs(m)};Ib.prototype.interfaces_=function(){return[ld,md]};Ib.prototype.getClass=function(){return Ib};Ib.mostPrecise=function(m,r){return 0<=m.compareTo(r)?m:r};Kj.serialVersionUID.get=function(){return 0x6bee6404e9a25c00};Kj.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Ib,Kj);var Id=function p(r){this._name=r||null;p.nameToTypeMap.put(r,this)},Lj={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Id.prototype.readResolve=function(){return Id.nameToTypeMap.get(this._name)};
Id.prototype.toString=function(){return this._name};Id.prototype.interfaces_=function(){return[ld]};Id.prototype.getClass=function(){return Id};Lj.serialVersionUID.get=function(){return-0x4cb98acd40a6b400};Lj.nameToTypeMap.get=function(){return new ln};Object.defineProperties(Id,Lj);Ib.Type=Id;Ib.FIXED=new Id("FIXED");Ib.FLOATING=new Id("FLOATING");Ib.FLOATING_SINGLE=new Id("FLOATING SINGLE");var db=function p(){this._precisionModel=new Ib;this._SRID=0;this._coordinateSequenceFactory=p.getDefaultCoordinateSequenceFactory();
0===arguments.length||(1===arguments.length?Xa(arguments[0],Sf)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Ib&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},mn={serialVersionUID:{configurable:!0}};db.prototype.toGeometry=function(p){return p.isNull()?this.createPoint(null):p.getMinX()===
p.getMaxX()&&p.getMinY()===p.getMaxY()?this.createPoint(new ua(p.getMinX(),p.getMinY())):p.getMinX()===p.getMaxX()||p.getMinY()===p.getMaxY()?this.createLineString([new ua(p.getMinX(),p.getMinY()),new ua(p.getMaxX(),p.getMaxY())]):this.createPolygon(this.createLinearRing([new ua(p.getMinX(),p.getMinY()),new ua(p.getMinX(),p.getMaxY()),new ua(p.getMaxX(),p.getMaxY()),new ua(p.getMaxX(),p.getMinY()),new ua(p.getMinX(),p.getMinY())]),null)};db.prototype.createLineString=function(p){return p?p instanceof
Array?new Ic(this.getCoordinateSequenceFactory().create(p),this):Xa(p,gb)?new Ic(p,this):void 0:new Ic(this.getCoordinateSequenceFactory().create([]),this)};db.prototype.createMultiLineString=function(){if(0===arguments.length)return new We(null,this);if(1===arguments.length)return new We(arguments[0],this)};db.prototype.buildGeometry=function(p){for(var u=null,x=!1,v=!1,y=p.iterator();y.hasNext();){var B=y.next(),G=B.getClass();null===u&&(u=G);G!==u&&(x=!0);B.isGeometryCollectionOrDerived()&&(v=
!0)}if(null===u)return this.createGeometryCollection();if(x||v)return this.createGeometryCollection(db.toGeometryArray(p));u=p.iterator().next();if(1<p.size()){if(u instanceof Hd)return this.createMultiPolygon(db.toPolygonArray(p));if(u instanceof Ic)return this.createMultiLineString(db.toLineStringArray(p));if(u instanceof Yd)return this.createMultiPoint(db.toPointArray(p));$a.shouldNeverReachHere("Unhandled class: "+u.getClass().getName())}return u};db.prototype.createMultiPointFromCoords=function(p){return this.createMultiPoint(null!==
p?this.getCoordinateSequenceFactory().create(p):null)};db.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof ua){var p=arguments[0];return this.createPoint(null!==p?this.getCoordinateSequenceFactory().create([p]):null)}if(Xa(arguments[0],gb))return new Yd(arguments[0],this)}};db.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};db.prototype.createPolygon=
function(){if(0===arguments.length)return new Hd(null,null,this);if(1===arguments.length){if(Xa(arguments[0],gb)||arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Zd)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new Hd(arguments[0],arguments[1],this)};db.prototype.getSRID=function(){return this._SRID};db.prototype.createGeometryCollection=function(){if(0===arguments.length)return new wd(null,this);
if(1===arguments.length)return new wd(arguments[0],this)};db.prototype.createGeometry=function(p){return(new qd(this)).edit(p,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})};db.prototype.getPrecisionModel=function(){return this._precisionModel};db.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var p=
arguments[0];return this.createLinearRing(null!==p?this.getCoordinateSequenceFactory().create(p):null)}if(Xa(arguments[0],gb))return new Zd(arguments[0],this)}};db.prototype.createMultiPolygon=function(){if(0===arguments.length)return new Ge(null,this);if(1===arguments.length)return new Ge(arguments[0],this)};db.prototype.createMultiPoint=function(){if(0===arguments.length)return new ag(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ag(arguments[0],this);if(arguments[0]instanceof
Array){var p=arguments[0];return this.createMultiPoint(null!==p?this.getCoordinateSequenceFactory().create(p):null)}if(Xa(arguments[0],gb)){p=arguments[0];if(null===p)return this.createMultiPoint([].fill(null));for(var u=Array(p.size()).fill(null),x=0;x<p.size();x++){var v=this.getCoordinateSequenceFactory().create(1,p.getDimension());fc.copy(p,x,v,0,1);u[x]=this.createPoint(v)}return this.createMultiPoint(u)}}};db.prototype.interfaces_=function(){return[ld]};db.prototype.getClass=function(){return db};
db.toMultiPolygonArray=function(p){var u=Array(p.size()).fill(null);return p.toArray(u)};db.toGeometryArray=function(p){if(null===p)return null;var u=Array(p.size()).fill(null);return p.toArray(u)};db.getDefaultCoordinateSequenceFactory=function(){return $d.instance()};db.toMultiLineStringArray=function(p){var u=Array(p.size()).fill(null);return p.toArray(u)};db.toLineStringArray=function(p){var u=Array(p.size()).fill(null);return p.toArray(u)};db.toMultiPointArray=function(p){var u=Array(p.size()).fill(null);
return p.toArray(u)};db.toLinearRingArray=function(p){var u=Array(p.size()).fill(null);return p.toArray(u)};db.toPointArray=function(p){var u=Array(p.size()).fill(null);return p.toArray(u)};db.toPolygonArray=function(p){var u=Array(p.size()).fill(null);return p.toArray(u)};db.createPointFromInternalCoord=function(p,u){return u.getPrecisionModel().makePrecise(p),u.getFactory().createPoint(p)};mn.serialVersionUID.get=function(){return-0x5ea75f2051eeb400};Object.defineProperties(db,mn);var Ap="Point MultiPoint LineString MultiLineString Polygon MultiPolygon".split(" "),
ei=function(p){this.geometryFactory=p||new db};ei.prototype.read=function(p){var u=(p="string"==typeof p?JSON.parse(p):p).type;if(!Jd[u])throw Error("Unknown GeoJSON type: "+p.type);return-1!==Ap.indexOf(u)?Jd[u].apply(this,[p.coordinates]):"GeometryCollection"===u?Jd[u].apply(this,[p.geometries]):Jd[u].apply(this,[p])};ei.prototype.write=function(p){var u=p.getGeometryType();if(!we[u])throw Error("Geometry is not supported");return we[u].apply(this,[p])};var Jd={Feature:function(p){var u={},x;for(x in p)u[x]=
p[x];if(p.geometry){if(!Jd[p.geometry.type])throw Error("Unknown GeoJSON type: "+p.type);u.geometry=this.read(p.geometry)}return p.bbox&&(u.bbox=Jd.bbox.apply(this,[p.bbox])),u},FeatureCollection:function(p){var u={};if(p.features){u.features=[];for(var x=0;x<p.features.length;++x)u.features.push(this.read(p.features[x]))}return p.bbox&&(u.bbox=this.parse.bbox.apply(this,[p.bbox])),u},coordinates:function(p){for(var u=[],x=0;x<p.length;++x){var v=p[x];u.push(new ua(v[0],v[1]))}return u},bbox:function(p){return this.geometryFactory.createLinearRing([new ua(p[0],
p[1]),new ua(p[2],p[1]),new ua(p[2],p[3]),new ua(p[0],p[3]),new ua(p[0],p[1])])},Point:function(p){p=new ua(p[0],p[1]);return this.geometryFactory.createPoint(p)},MultiPoint:function(p){for(var u=[],x=0;x<p.length;++x)u.push(Jd.Point.apply(this,[p[x]]));return this.geometryFactory.createMultiPoint(u)},LineString:function(p){p=Jd.coordinates.apply(this,[p]);return this.geometryFactory.createLineString(p)},MultiLineString:function(p){for(var u=[],x=0;x<p.length;++x)u.push(Jd.LineString.apply(this,[p[x]]));
return this.geometryFactory.createMultiLineString(u)},Polygon:function(p){var u=Jd.coordinates.apply(this,[p[0]]);u=this.geometryFactory.createLinearRing(u);for(var x=[],v=1;v<p.length;++v){var y=Jd.coordinates.apply(this,[p[v]]);y=this.geometryFactory.createLinearRing(y);x.push(y)}return this.geometryFactory.createPolygon(u,x)},MultiPolygon:function(p){for(var u=[],x=0;x<p.length;++x)u.push(Jd.Polygon.apply(this,[p[x]]));return this.geometryFactory.createMultiPolygon(u)},GeometryCollection:function(p){for(var u=
[],x=0;x<p.length;++x)u.push(this.read(p[x]));return this.geometryFactory.createGeometryCollection(u)}},we={coordinate:function(p){return[p.x,p.y]},Point:function(p){return{type:"Point",coordinates:we.coordinate.apply(this,[p.getCoordinate()])}},MultiPoint:function(p){for(var u=[],x=0;x<p._geometries.length;++x){var v=we.Point.apply(this,[p._geometries[x]]);u.push(v.coordinates)}return{type:"MultiPoint",coordinates:u}},LineString:function(p){var u=[];p=p.getCoordinates();for(var x=0;x<p.length;++x)u.push(we.coordinate.apply(this,
[p[x]]));return{type:"LineString",coordinates:u}},MultiLineString:function(p){for(var u=[],x=0;x<p._geometries.length;++x){var v=we.LineString.apply(this,[p._geometries[x]]);u.push(v.coordinates)}return{type:"MultiLineString",coordinates:u}},Polygon:function(p){var u=[],x=we.LineString.apply(this,[p._shell]);u.push(x.coordinates);for(x=0;x<p._holes.length;++x){var v=we.LineString.apply(this,[p._holes[x]]);u.push(v.coordinates)}return{type:"Polygon",coordinates:u}},MultiPolygon:function(p){for(var u=
[],x=0;x<p._geometries.length;++x){var v=we.Polygon.apply(this,[p._geometries[x]]);u.push(v.coordinates)}return{type:"MultiPolygon",coordinates:u}},GeometryCollection:function(p){for(var u=[],x=0;x<p._geometries.length;++x){var v=p._geometries[x],y=v.getGeometryType();u.push(we[y].apply(this,[v]))}return{type:"GeometryCollection",geometries:u}}},qj=function(p){this.geometryFactory=p||new db;this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new ei(this.geometryFactory)};qj.prototype.read=
function(p){p=this.parser.read(p);return this.precisionModel.getType()===Ib.FIXED&&this.reducePrecision(p),p};qj.prototype.reducePrecision=function(p){var u;if(p.coordinate)this.precisionModel.makePrecise(p.coordinate);else if(p.points){var x=0;for(u=p.points.length;x<u;x++)this.precisionModel.makePrecise(p.points[x])}else if(p.geometries)for(x=0,u=p.geometries.length;x<u;x++)this.reducePrecision(p.geometries[x])};var Cm=function(){this.parser=new ei(this.geometryFactory)};Cm.prototype.write=function(p){return this.parser.write(p)};
var Ba=function(){},fi={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Ba.prototype.interfaces_=function(){return[]};Ba.prototype.getClass=function(){return Ba};Ba.opposite=function(p){return p===Ba.LEFT?Ba.RIGHT:p===Ba.RIGHT?Ba.LEFT:p};fi.ON.get=function(){return 0};fi.LEFT.get=function(){return 1};fi.RIGHT.get=function(){return 2};Object.defineProperties(Ba,fi);Mh.prototype=Error();Mh.prototype.name="EmptyStackException";Cd.prototype=new ve;Cd.prototype.add=function(p){return this.array_.push(p),
!0};Cd.prototype.get=function(p){if(0>p||p>=this.size())throw Error();return this.array_[p]};Cd.prototype.push=function(p){return this.array_.push(p),p};Cd.prototype.pop=function(p){if(0===this.array_.length)throw new Mh;return this.array_.pop()};Cd.prototype.peek=function(){if(0===this.array_.length)throw new Mh;return this.array_[this.array_.length-1]};Cd.prototype.empty=function(){return 0===this.array_.length};Cd.prototype.isEmpty=function(){return this.empty()};Cd.prototype.search=function(p){return this.array_.indexOf(p)};
Cd.prototype.size=function(){return this.array_.length};Cd.prototype.toArray=function(){for(var p=[],u=0,x=this.array_.length;u<x;u++)p.push(this.array_[u]);return p};var Kd=function(){this._minIndex=-1;this._orientedDe=this._minDe=this._minCoord=null};Kd.prototype.getCoordinate=function(){return this._minCoord};Kd.prototype.getRightmostSide=function(p,u){var x=this.getRightmostSideOfSegment(p,u);return 0>x&&(x=this.getRightmostSideOfSegment(p,u-1)),0>x&&(this._minCoord=null,this.checkForRightmostCoordinate(p)),
x};Kd.prototype.findRightmostEdgeAtVertex=function(){var p=this._minDe.getEdge().getCoordinates();$a.isTrue(0<this._minIndex&&this._minIndex<p.length,"rightmost point expected to be interior vertex of edge");var u=p[this._minIndex-1];p=p[this._minIndex+1];var x=Da.computeOrientation(this._minCoord,p,u),v=!1;(u.y<this._minCoord.y&&p.y<this._minCoord.y&&x===Da.COUNTERCLOCKWISE||u.y>this._minCoord.y&&p.y>this._minCoord.y&&x===Da.CLOCKWISE)&&(v=!0);v&&--this._minIndex};Kd.prototype.getRightmostSideOfSegment=
function(p,u){p=p.getEdge().getCoordinates();if(0>u||u+1>=p.length||p[u].y===p[u+1].y)return-1;var x=Ba.LEFT;return p[u].y<p[u+1].y&&(x=Ba.RIGHT),x};Kd.prototype.getEdge=function(){return this._orientedDe};Kd.prototype.checkForRightmostCoordinate=function(p){for(var u=p.getEdge().getCoordinates(),x=0;x<u.length-1;x++)(null===this._minCoord||u[x].x>this._minCoord.x)&&(this._minDe=p,this._minIndex=x,this._minCoord=u[x])};Kd.prototype.findRightmostEdgeAtNode=function(){this._minDe=this._minDe.getNode().getEdges().getRightmostEdge();
this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Kd.prototype.findEdge=function(p){for(p=p.iterator();p.hasNext();){var u=p.next();u.isForward()&&this.checkForRightmostCoordinate(u)}$a.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing");0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex();this._orientedDe=this._minDe;this.getRightmostSide(this._minDe,
this._minIndex)===Ba.LEFT&&(this._orientedDe=this._minDe.getSym())};Kd.prototype.interfaces_=function(){return[]};Kd.prototype.getClass=function(){return Kd};var xe=function(p){function u(x,v){p.call(this,u.msgWithCoord(x,v));this.pt=v?new ua(v):null;this.name="TopologyException"}return p&&(u.__proto__=p),u.prototype=Object.create(p&&p.prototype),u.prototype.constructor=u,u.prototype.getCoordinate=function(){return this.pt},u.prototype.interfaces_=function(){return[]},u.prototype.getClass=function(){return u},
u.msgWithCoord=function(x,v){return v?x:x+" [ "+v+" ]"},u}(se),gi=function(){this.array_=[]};gi.prototype.addLast=function(p){this.array_.push(p)};gi.prototype.removeFirst=function(){return this.array_.shift()};gi.prototype.isEmpty=function(){return 0===this.array_.length};var Jc=function(){this._finder=null;this._dirEdgeList=new Fa;this._nodes=new Fa;this._env=this._rightMostCoord=null;this._finder=new Kd};Jc.prototype.clearVisitedEdges=function(){for(var p=this._dirEdgeList.iterator();p.hasNext();)p.next().setVisited(!1)};
Jc.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Jc.prototype.computeNodeDepth=function(p){for(var u=null,x=p.getEdges().iterator();x.hasNext();){var v=x.next();if(v.isVisited()||v.getSym().isVisited()){u=v;break}}if(null===u)throw new xe("unable to find edge to compute depths at "+p.getCoordinate());p.getEdges().computeDepths(u);for(p=p.getEdges().iterator();p.hasNext();)u=p.next(),u.setVisited(!0),this.copySymDepths(u)};Jc.prototype.computeDepth=function(p){this.clearVisitedEdges();
var u=this._finder.getEdge();u.setEdgeDepths(Ba.RIGHT,p);this.copySymDepths(u);this.computeDepths(u)};Jc.prototype.create=function(p){this.addReachable(p);this._finder.findEdge(this._dirEdgeList);this._rightMostCoord=this._finder.getCoordinate()};Jc.prototype.findResultEdges=function(){for(var p=this._dirEdgeList.iterator();p.hasNext();){var u=p.next();1<=u.getDepth(Ba.RIGHT)&&0>=u.getDepth(Ba.LEFT)&&!u.isInteriorAreaEdge()&&u.setInResult(!0)}};Jc.prototype.computeDepths=function(p){var u=new Hj,
x=new gi,v=p.getNode();x.addLast(v);u.add(v);for(p.setVisited(!0);!x.isEmpty();)for(p=x.removeFirst(),u.add(p),this.computeNodeDepth(p),p=p.getEdges().iterator();p.hasNext();)v=p.next().getSym(),v.isVisited()||(v=v.getNode(),u.contains(v)||(x.addLast(v),u.add(v)))};Jc.prototype.compareTo=function(p){return this._rightMostCoord.x<p._rightMostCoord.x?-1:this._rightMostCoord.x>p._rightMostCoord.x?1:0};Jc.prototype.getEnvelope=function(){if(null===this._env){for(var p=new Ka,u=this._dirEdgeList.iterator();u.hasNext();)for(var x=
u.next().getEdge().getCoordinates(),v=0;v<x.length-1;v++)p.expandToInclude(x[v]);this._env=p}return this._env};Jc.prototype.addReachable=function(p){var u=new Cd;for(u.add(p);!u.empty();)p=u.pop(),this.add(p,u)};Jc.prototype.copySymDepths=function(p){var u=p.getSym();u.setDepth(Ba.LEFT,p.getDepth(Ba.RIGHT));u.setDepth(Ba.RIGHT,p.getDepth(Ba.LEFT))};Jc.prototype.add=function(p,u){p.setVisited(!0);this._nodes.add(p);for(p=p.getEdges().iterator();p.hasNext();){var x=p.next();this._dirEdgeList.add(x);
x=x.getSym().getNode();x.isVisited()||u.push(x)}};Jc.prototype.getNodes=function(){return this._nodes};Jc.prototype.getDirectedEdges=function(){return this._dirEdgeList};Jc.prototype.interfaces_=function(){return[md]};Jc.prototype.getClass=function(){return Jc};var Ub=function u(){if(this.location=null,1===arguments.length)if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var x=arguments[0];this.init(1);this.location[Ba.ON]=x}else{if(arguments[0]instanceof
u&&(x=arguments[0],this.init(x.location.length),null!==x))for(var v=0;v<this.location.length;v++)this.location[v]=x.location[v]}else if(3===arguments.length){x=arguments[0];v=arguments[1];var y=arguments[2];this.init(3);this.location[Ba.ON]=x;this.location[Ba.LEFT]=v;this.location[Ba.RIGHT]=y}};Ub.prototype.setAllLocations=function(u){for(var x=0;x<this.location.length;x++)this.location[x]=u};Ub.prototype.isNull=function(){for(var u=0;u<this.location.length;u++)if(this.location[u]!==va.NONE)return!1;
return!0};Ub.prototype.setAllLocationsIfNull=function(u){for(var x=0;x<this.location.length;x++)this.location[x]===va.NONE&&(this.location[x]=u)};Ub.prototype.isLine=function(){return 1===this.location.length};Ub.prototype.merge=function(u){if(u.location.length>this.location.length){var x=Array(3).fill(null);x[Ba.ON]=this.location[Ba.ON];x[Ba.LEFT]=va.NONE;x[Ba.RIGHT]=va.NONE;this.location=x}for(x=0;x<this.location.length;x++)this.location[x]===va.NONE&&x<u.location.length&&(this.location[x]=u.location[x])};
Ub.prototype.getLocations=function(){return this.location};Ub.prototype.flip=function(){if(1>=this.location.length)return null;var u=this.location[Ba.LEFT];this.location[Ba.LEFT]=this.location[Ba.RIGHT];this.location[Ba.RIGHT]=u};Ub.prototype.toString=function(){var u=new Ed;return 1<this.location.length&&u.append(va.toLocationSymbol(this.location[Ba.LEFT])),u.append(va.toLocationSymbol(this.location[Ba.ON])),1<this.location.length&&u.append(va.toLocationSymbol(this.location[Ba.RIGHT])),u.toString()};
Ub.prototype.setLocations=function(u,x,v){this.location[Ba.ON]=u;this.location[Ba.LEFT]=x;this.location[Ba.RIGHT]=v};Ub.prototype.get=function(u){return u<this.location.length?this.location[u]:va.NONE};Ub.prototype.isArea=function(){return 1<this.location.length};Ub.prototype.isAnyNull=function(){for(var u=0;u<this.location.length;u++)if(this.location[u]===va.NONE)return!0;return!1};Ub.prototype.setLocation=function(){1===arguments.length?this.setLocation(Ba.ON,arguments[0]):2===arguments.length&&
(this.location[arguments[0]]=arguments[1])};Ub.prototype.init=function(u){this.location=Array(u).fill(null);this.setAllLocations(va.NONE)};Ub.prototype.isEqualOnSide=function(u,x){return this.location[x]===u.location[x]};Ub.prototype.allPositionsEqual=function(u){for(var x=0;x<this.location.length;x++)if(this.location[x]!==u)return!1;return!0};Ub.prototype.interfaces_=function(){return[]};Ub.prototype.getClass=function(){return Ub};var Mb=function x(){if(this.elt=Array(2).fill(null),1===arguments.length)if(Number.isInteger(arguments[0])){var v=
arguments[0];this.elt[0]=new Ub(v);this.elt[1]=new Ub(v)}else arguments[0]instanceof x&&(v=arguments[0],this.elt[0]=new Ub(v.elt[0]),this.elt[1]=new Ub(v.elt[1]));else if(2===arguments.length){v=arguments[0];var y=arguments[1];this.elt[0]=new Ub(va.NONE);this.elt[1]=new Ub(va.NONE);this.elt[v].setLocation(y)}else if(3===arguments.length){v=arguments[0];y=arguments[1];var B=arguments[2];this.elt[0]=new Ub(v,y,B);this.elt[1]=new Ub(v,y,B)}else if(4===arguments.length){v=arguments[0];y=arguments[1];
B=arguments[2];var G=arguments[3];this.elt[0]=new Ub(va.NONE,va.NONE,va.NONE);this.elt[1]=new Ub(va.NONE,va.NONE,va.NONE);this.elt[v].setLocations(y,B,G)}};Mb.prototype.getGeometryCount=function(){var x=0;return this.elt[0].isNull()||x++,this.elt[1].isNull()||x++,x};Mb.prototype.setAllLocations=function(x,v){this.elt[x].setAllLocations(v)};Mb.prototype.isNull=function(x){return this.elt[x].isNull()};Mb.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var x=arguments[0];this.setAllLocationsIfNull(0,
x);this.setAllLocationsIfNull(1,x)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])};Mb.prototype.isLine=function(x){return this.elt[x].isLine()};Mb.prototype.merge=function(x){for(var v=0;2>v;v++)null===this.elt[v]&&null!==x.elt[v]?this.elt[v]=new Ub(x.elt[v]):this.elt[v].merge(x.elt[v])};Mb.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip()};Mb.prototype.getLocation=function(){if(1===arguments.length)return this.elt[arguments[0]].get(Ba.ON);if(2===
arguments.length)return this.elt[arguments[0]].get(arguments[1])};Mb.prototype.toString=function(){var x=new Ed;return null!==this.elt[0]&&(x.append("A:"),x.append(this.elt[0].toString())),null!==this.elt[1]&&(x.append(" B:"),x.append(this.elt[1].toString())),x.toString()};Mb.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length)return this.elt[arguments[0]].isArea()};Mb.prototype.isAnyNull=function(x){return this.elt[x].isAnyNull()};
Mb.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(Ba.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])};Mb.prototype.isEqualOnSide=function(x,v){return this.elt[0].isEqualOnSide(x.elt[0],v)&&this.elt[1].isEqualOnSide(x.elt[1],v)};Mb.prototype.allPositionsEqual=function(x,v){return this.elt[x].allPositionsEqual(v)};Mb.prototype.toLine=function(x){this.elt[x].isArea()&&(this.elt[x]=new Ub(this.elt[x].location[0]))};
Mb.prototype.interfaces_=function(){return[]};Mb.prototype.getClass=function(){return Mb};Mb.toLineLabel=function(x){for(var v=new Mb(va.NONE),y=0;2>y;y++)v.setLocation(y,x.getLocation(y));return v};var kc=function(x,v){this._startDe=null;this._maxNodeDegree=-1;this._edges=new Fa;this._pts=new Fa;this._label=new Mb(va.NONE);this._shell=this._isHole=this._ring=null;this._holes=new Fa;this._geometryFactory=v;this.computePoints(x);this.computeRing()};kc.prototype.computeRing=function(){if(null!==this._ring)return null;
for(var x=Array(this._pts.size()).fill(null),v=0;v<this._pts.size();v++)x[v]=this._pts.get(v);this._ring=this._geometryFactory.createLinearRing(x);this._isHole=Da.isCCW(this._ring.getCoordinates())};kc.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()};kc.prototype.computePoints=function(x){this._startDe=x;var v=!0;do{if(null===x)throw new xe("Found null DirectedEdge");if(x.getEdgeRing()===this)throw new xe("Directed Edge visited twice during ring-building at "+x.getCoordinate());
this._edges.add(x);var y=x.getLabel();$a.isTrue(y.isArea());this.mergeLabel(y);this.addPoints(x.getEdge(),x.isForward(),v);v=!1;this.setEdgeRing(x,this);x=this.getNext(x)}while(x!==this._startDe)};kc.prototype.getLinearRing=function(){return this._ring};kc.prototype.getCoordinate=function(x){return this._pts.get(x)};kc.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var x=this._startDe;do{var v=x.getNode().getEdges().getOutgoingDegree(this);v>this._maxNodeDegree&&(this._maxNodeDegree=
v);x=this.getNext(x)}while(x!==this._startDe);this._maxNodeDegree*=2};kc.prototype.addPoints=function(x,v,y){x=x.getCoordinates();if(v)for(v=1,y&&(v=0),y=v;y<x.length;y++)this._pts.add(x[y]);else for(v=x.length-2,y&&(v=x.length-1),y=v;0<=y;y--)this._pts.add(x[y])};kc.prototype.isHole=function(){return this._isHole};kc.prototype.setInResult=function(){var x=this._startDe;do x.getEdge().setInResult(!0),x=x.getNext();while(x!==this._startDe)};kc.prototype.containsPoint=function(x){var v=this.getLinearRing();
if(!v.getEnvelopeInternal().contains(x)||!Da.isPointInRing(x,v.getCoordinates()))return!1;for(v=this._holes.iterator();v.hasNext();)if(v.next().containsPoint(x))return!1;return!0};kc.prototype.addHole=function(x){this._holes.add(x)};kc.prototype.isShell=function(){return null===this._shell};kc.prototype.getLabel=function(){return this._label};kc.prototype.getEdges=function(){return this._edges};kc.prototype.getMaxNodeDegree=function(){return 0>this._maxNodeDegree&&this.computeMaxNodeDegree(),this._maxNodeDegree};
kc.prototype.getShell=function(){return this._shell};kc.prototype.mergeLabel=function(){if(1===arguments.length){var x=arguments[0];this.mergeLabel(x,0);this.mergeLabel(x,1)}else if(2===arguments.length){x=arguments[1];var v=arguments[0].getLocation(x,Ba.RIGHT);if(v===va.NONE)return null;if(this._label.getLocation(x)===va.NONE)return this._label.setLocation(x,v),null}};kc.prototype.setShell=function(x){this._shell=x;null!==x&&x.addHole(this)};kc.prototype.toPolygon=function(x){for(var v=Array(this._holes.size()).fill(null),
y=0;y<this._holes.size();y++)v[y]=this._holes.get(y).getLinearRing();return x.createPolygon(this.getLinearRing(),v)};kc.prototype.interfaces_=function(){return[]};kc.prototype.getClass=function(){return kc};var Bp=function(x){function v(y,B){x.call(this,y,B)}return x&&(v.__proto__=x),v.prototype=Object.create(x&&x.prototype),v.prototype.constructor=v,v.prototype.setEdgeRing=function(y,B){y.setMinEdgeRing(B)},v.prototype.getNext=function(y){return y.getNextMin()},v.prototype.interfaces_=function(){return[]},
v.prototype.getClass=function(){return v},v}(kc),Cp=function(x){function v(y,B){x.call(this,y,B)}return x&&(v.__proto__=x),v.prototype=Object.create(x&&x.prototype),v.prototype.constructor=v,v.prototype.buildMinimalRings=function(){var y=new Fa,B=this._startDe;do{if(null===B.getMinEdgeRing()){var G=new Bp(B,this._geometryFactory);y.add(G)}B=B.getNext()}while(B!==this._startDe);return y},v.prototype.setEdgeRing=function(y,B){y.setEdgeRing(B)},v.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var y=
this._startDe;do y.getNode().getEdges().linkMinimalDirectedEdges(this),y=y.getNext();while(y!==this._startDe)},v.prototype.getNext=function(y){return y.getNext()},v.prototype.interfaces_=function(){return[]},v.prototype.getClass=function(){return v},v}(kc),gd=function(){(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length)&&1===arguments.length&&(this._label=arguments[0])};gd.prototype.setVisited=function(x){this._isVisited=x};gd.prototype.setInResult=
function(x){this._isInResult=x};gd.prototype.isCovered=function(){return this._isCovered};gd.prototype.isCoveredSet=function(){return this._isCoveredSet};gd.prototype.setLabel=function(x){this._label=x};gd.prototype.getLabel=function(){return this._label};gd.prototype.setCovered=function(x){this._isCovered=x;this._isCoveredSet=!0};gd.prototype.updateIM=function(x){$a.isTrue(2<=this._label.getGeometryCount(),"found partial label");this.computeIM(x)};gd.prototype.isInResult=function(){return this._isInResult};
gd.prototype.isVisited=function(){return this._isVisited};gd.prototype.interfaces_=function(){return[]};gd.prototype.getClass=function(){return gd};var hi=function(x){function v(y,B){x.call(this);this._coord=y;this._edges=B;this._label=new Mb(0,va.NONE)}return x&&(v.__proto__=x),v.prototype=Object.create(x&&x.prototype),v.prototype.constructor=v,v.prototype.isIncidentEdgeInResult=function(){for(var y=this.getEdges().getEdges().iterator();y.hasNext();)if(y.next().getEdge().isInResult())return!0;return!1},
v.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},v.prototype.getCoordinate=function(){return this._coord},v.prototype.print=function(y){y.println("node "+this._coord+" lbl: "+this._label)},v.prototype.computeIM=function(y){},v.prototype.computeMergedLocation=function(y,B){var G;(G=this._label.getLocation(B),y.isNull(B))||(y=y.getLocation(B),G!==va.BOUNDARY&&(G=y));return G},v.prototype.setLabel=function(){if(2!==arguments.length)return x.prototype.setLabel.apply(this,arguments);
var y=arguments[0],B=arguments[1];null===this._label?this._label=new Mb(y,B):this._label.setLocation(y,B)},v.prototype.getEdges=function(){return this._edges},v.prototype.mergeLabel=function(y){if(y instanceof v)this.mergeLabel(y._label);else if(y instanceof Mb)for(var B=0;2>B;B++){var G=this.computeMergedLocation(y,B);this._label.getLocation(B)===va.NONE&&this._label.setLocation(B,G)}},v.prototype.add=function(y){this._edges.insert(y);y.setNode(this)},v.prototype.setLabelBoundary=function(y){if(null===
this._label)return null;var B=va.NONE;null!==this._label&&(B=this._label.getLocation(y));switch(B){case va.BOUNDARY:B=va.INTERIOR;break;default:B=va.BOUNDARY}this._label.setLocation(y,B)},v.prototype.interfaces_=function(){return[]},v.prototype.getClass=function(){return v},v}(gd),Ld=function(x){this.nodeMap=new Bc;this.nodeFact=x};Ld.prototype.find=function(x){return this.nodeMap.get(x)};Ld.prototype.addNode=function(x){if(x instanceof ua){var v=this.nodeMap.get(x);return null===v&&(v=this.nodeFact.createNode(x),
this.nodeMap.put(x,v)),v}if(x instanceof hi)return v=this.nodeMap.get(x.getCoordinate()),null===v?(this.nodeMap.put(x.getCoordinate(),x),x):(v.mergeLabel(x),v)};Ld.prototype.print=function(x){for(var v=this.iterator();v.hasNext();)v.next().print(x)};Ld.prototype.iterator=function(){return this.nodeMap.values().iterator()};Ld.prototype.values=function(){return this.nodeMap.values()};Ld.prototype.getBoundaryNodes=function(x){for(var v=new Fa,y=this.iterator();y.hasNext();){var B=y.next();B.getLabel().getLocation(x)===
va.BOUNDARY&&v.add(B)}return v};Ld.prototype.add=function(x){var v=x.getCoordinate();this.addNode(v).add(x)};Ld.prototype.interfaces_=function(){return[]};Ld.prototype.getClass=function(){return Ld};var Pb=function(){},$g={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Pb.prototype.interfaces_=function(){return[]};Pb.prototype.getClass=function(){return Pb};Pb.isNorthern=function(x){return x===Pb.NE||x===Pb.NW};Pb.isOpposite=function(x,v){return x!==v&&2===(x-
v+4)%4};Pb.commonHalfPlane=function(x,v){if(x===v)return x;if(2===(x-v+4)%4)return-1;var y=x<v?x:v;return 0===y&&3===(x>v?x:v)?3:y};Pb.isInHalfPlane=function(x,v){return v===Pb.SE?x===Pb.SE||x===Pb.SW:x===v||x===v+1};Pb.quadrant=function(x,v){if("number"==typeof x&&"number"==typeof v){if(0===x&&0===v)throw new cc("Cannot compute the quadrant for point ( "+x+", "+v+" )");return 0<=x?0<=v?Pb.NE:Pb.SE:0<=v?Pb.NW:Pb.SW}if(x instanceof ua&&v instanceof ua){if(v.x===x.x&&v.y===x.y)throw new cc("Cannot compute the quadrant for two identical points "+
x);return v.x>=x.x?v.y>=x.y?Pb.NE:Pb.SE:v.y>=x.y?Pb.NW:Pb.SW}};$g.NE.get=function(){return 0};$g.NW.get=function(){return 1};$g.SW.get=function(){return 2};$g.SE.get=function(){return 3};Object.defineProperties(Pb,$g);var Cc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var x=arguments[1],v=arguments[2];this._edge=arguments[0];this.init(x,
v);this._label=null}else if(4===arguments.length){x=arguments[1];v=arguments[2];var y=arguments[3];this._edge=arguments[0];this.init(x,v);this._label=y}};Cc.prototype.compareDirection=function(x){return this._dx===x._dx&&this._dy===x._dy?0:this._quadrant>x._quadrant?1:this._quadrant<x._quadrant?-1:Da.computeOrientation(x._p0,x._p1,this._p1)};Cc.prototype.getDy=function(){return this._dy};Cc.prototype.getCoordinate=function(){return this._p0};Cc.prototype.setNode=function(x){this._node=x};Cc.prototype.print=
function(x){var v=Math.atan2(this._dy,this._dx),y=this.getClass().getName(),B=y.lastIndexOf(".");y=y.substring(B+1);x.print("  "+y+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+v+"   "+this._label)};Cc.prototype.compareTo=function(x){return this.compareDirection(x)};Cc.prototype.getDirectedCoordinate=function(){return this._p1};Cc.prototype.getDx=function(){return this._dx};Cc.prototype.getLabel=function(){return this._label};Cc.prototype.getEdge=function(){return this._edge};Cc.prototype.getQuadrant=
function(){return this._quadrant};Cc.prototype.getNode=function(){return this._node};Cc.prototype.toString=function(){var x=Math.atan2(this._dy,this._dx),v=this.getClass().getName(),y=v.lastIndexOf(".");return"  "+v.substring(y+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+x+"   "+this._label};Cc.prototype.computeLabel=function(x){};Cc.prototype.init=function(x,v){this._p0=x;this._p1=v;this._dx=v.x-x.x;this._dy=v.y-x.y;this._quadrant=Pb.quadrant(this._dx,this._dy);$a.isTrue(!(0===this._dx&&
0===this._dy),"EdgeEnd with identical endpoints found")};Cc.prototype.interfaces_=function(){return[md]};Cc.prototype.getClass=function(){return Cc};var Mj=function(x){function v(y,B){(x.call(this,y),this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=B,B)?this.init(y.getCoordinate(0),y.getCoordinate(1)):(B=y.getNumPoints()-1,this.init(y.getCoordinate(B),y.getCoordinate(B-1)));
this.computeDirectedLabel()}return x&&(v.__proto__=x),v.prototype=Object.create(x&&x.prototype),v.prototype.constructor=v,v.prototype.getNextMin=function(){return this._nextMin},v.prototype.getDepth=function(y){return this._depth[y]},v.prototype.setVisited=function(y){this._isVisited=y},v.prototype.computeDirectedLabel=function(){this._label=new Mb(this._edge.getLabel());this._isForward||this._label.flip()},v.prototype.getNext=function(){return this._next},v.prototype.setDepth=function(y,B){if(-999!==
this._depth[y]&&this._depth[y]!==B)throw new xe("assigned depths do not match",this.getCoordinate());this._depth[y]=B},v.prototype.isInteriorAreaEdge=function(){for(var y=!0,B=0;2>B;B++)this._label.isArea(B)&&this._label.getLocation(B,Ba.LEFT)===va.INTERIOR&&this._label.getLocation(B,Ba.RIGHT)===va.INTERIOR||(y=!1);return y},v.prototype.setNextMin=function(y){this._nextMin=y},v.prototype.print=function(y){x.prototype.print.call(this,y);y.print(" "+this._depth[Ba.LEFT]+"/"+this._depth[Ba.RIGHT]);y.print(" ("+
this.getDepthDelta()+")");this._isInResult&&y.print(" inResult")},v.prototype.setMinEdgeRing=function(y){this._minEdgeRing=y},v.prototype.isLineEdge=function(){var y=this._label.isLine(0)||this._label.isLine(1),B=!this._label.isArea(0)||this._label.allPositionsEqual(0,va.EXTERIOR),G=!this._label.isArea(1)||this._label.allPositionsEqual(1,va.EXTERIOR);return y&&B&&G},v.prototype.setEdgeRing=function(y){this._edgeRing=y},v.prototype.getMinEdgeRing=function(){return this._minEdgeRing},v.prototype.getDepthDelta=
function(){var y=this._edge.getDepthDelta();return this._isForward||(y=-y),y},v.prototype.setInResult=function(y){this._isInResult=y},v.prototype.getSym=function(){return this._sym},v.prototype.isForward=function(){return this._isForward},v.prototype.getEdge=function(){return this._edge},v.prototype.printEdge=function(y){this.print(y);y.print(" ");this._isForward?this._edge.print(y):this._edge.printReverse(y)},v.prototype.setSym=function(y){this._sym=y},v.prototype.setVisitedEdge=function(y){this.setVisited(y);
this._sym.setVisited(y)},v.prototype.setEdgeDepths=function(y,B){var G=this.getEdge().getDepthDelta();this._isForward||(G=-G);var A=1;y===Ba.LEFT&&(A=-1);var F=Ba.opposite(y);G=B+G*A;this.setDepth(y,B);this.setDepth(F,G)},v.prototype.getEdgeRing=function(){return this._edgeRing},v.prototype.isInResult=function(){return this._isInResult},v.prototype.setNext=function(y){this._next=y},v.prototype.isVisited=function(){return this._isVisited},v.prototype.interfaces_=function(){return[]},v.prototype.getClass=
function(){return v},v.depthFactor=function(y,B){return y===va.EXTERIOR&&B===va.INTERIOR?1:y===va.INTERIOR&&B===va.EXTERIOR?-1:0},v}(Cc),bg=function(){};bg.prototype.createNode=function(x){return new hi(x,null)};bg.prototype.interfaces_=function(){return[]};bg.prototype.getClass=function(){return bg};var $b=function(){(this._edges=new Fa,this._nodes=null,this._edgeEndList=new Fa,0===arguments.length)?this._nodes=new Ld(new bg):1===arguments.length&&(this._nodes=new Ld(arguments[0]))};$b.prototype.printEdges=
function(x){x.println("Edges:");for(var v=0;v<this._edges.size();v++){x.println("edge "+v+":");var y=this._edges.get(v);y.print(x);y.eiList.print(x)}};$b.prototype.find=function(x){return this._nodes.find(x)};$b.prototype.addNode=function(x){if(x instanceof hi||x instanceof ua)return this._nodes.addNode(x)};$b.prototype.getNodeIterator=function(){return this._nodes.iterator()};$b.prototype.linkResultDirectedEdges=function(){for(var x=this._nodes.iterator();x.hasNext();)x.next().getEdges().linkResultDirectedEdges()};
$b.prototype.debugPrintln=function(x){Pc.out.println(x)};$b.prototype.isBoundaryNode=function(x,v){v=this._nodes.find(v);if(null===v)return!1;v=v.getLabel();return null!==v&&v.getLocation(x)===va.BOUNDARY};$b.prototype.linkAllDirectedEdges=function(){for(var x=this._nodes.iterator();x.hasNext();)x.next().getEdges().linkAllDirectedEdges()};$b.prototype.matchInSameDirection=function(x,v,y,B){return!!x.equals(y)&&Da.computeOrientation(x,v,B)===Da.COLLINEAR&&Pb.quadrant(x,v)===Pb.quadrant(y,B)};$b.prototype.getEdgeEnds=
function(){return this._edgeEndList};$b.prototype.debugPrint=function(x){Pc.out.print(x)};$b.prototype.getEdgeIterator=function(){return this._edges.iterator()};$b.prototype.findEdgeInSameDirection=function(x,v){for(var y=0;y<this._edges.size();y++){var B=this._edges.get(y),G=B.getCoordinates();if(this.matchInSameDirection(x,v,G[0],G[1])||this.matchInSameDirection(x,v,G[G.length-1],G[G.length-2]))return B}return null};$b.prototype.insertEdge=function(x){this._edges.add(x)};$b.prototype.findEdgeEnd=
function(x){for(var v=this.getEdgeEnds().iterator();v.hasNext();){var y=v.next();if(y.getEdge()===x)return y}return null};$b.prototype.addEdges=function(x){for(x=x.iterator();x.hasNext();){var v=x.next();this._edges.add(v);var y=new Mj(v,!0);v=new Mj(v,!1);y.setSym(v);v.setSym(y);this.add(y);this.add(v)}};$b.prototype.add=function(x){this._nodes.add(x);this._edgeEndList.add(x)};$b.prototype.getNodes=function(){return this._nodes.values()};$b.prototype.findEdge=function(x,v){for(var y=0;y<this._edges.size();y++){var B=
this._edges.get(y),G=B.getCoordinates();if(x.equals(G[0])&&v.equals(G[1]))return B}return null};$b.prototype.interfaces_=function(){return[]};$b.prototype.getClass=function(){return $b};$b.linkResultDirectedEdges=function(x){for(x=x.iterator();x.hasNext();)x.next().getEdges().linkResultDirectedEdges()};var $c=function(x){this._geometryFactory=null;this._shellList=new Fa;this._geometryFactory=x};$c.prototype.sortShellsAndHoles=function(x,v,y){for(x=x.iterator();x.hasNext();){var B=x.next();B.isHole()?
y.add(B):v.add(B)}};$c.prototype.computePolygons=function(x){var v=new Fa;for(x=x.iterator();x.hasNext();){var y=x.next().toPolygon(this._geometryFactory);v.add(y)}return v};$c.prototype.placeFreeHoles=function(x,v){for(v=v.iterator();v.hasNext();){var y=v.next();if(null===y.getShell()){var B=this.findEdgeRingContaining(y,x);if(null===B)throw new xe("unable to assign hole to a shell",y.getCoordinate(0));y.setShell(B)}}};$c.prototype.buildMinimalEdgeRings=function(x,v,y){var B=new Fa;for(x=x.iterator();x.hasNext();){var G=
x.next();if(2<G.getMaxNodeDegree()){G.linkDirectedEdgesForMinimalEdgeRings();G=G.buildMinimalRings();var A=this.findShell(G);null!==A?(this.placePolygonHoles(A,G),v.add(A)):y.addAll(G)}else B.add(G)}return B};$c.prototype.containsPoint=function(x){for(var v=this._shellList.iterator();v.hasNext();)if(v.next().containsPoint(x))return!0;return!1};$c.prototype.buildMaximalEdgeRings=function(x){var v=new Fa;for(x=x.iterator();x.hasNext();){var y=x.next();y.isInResult()&&y.getLabel().isArea()&&null===y.getEdgeRing()&&
(y=new Cp(y,this._geometryFactory),v.add(y),y.setInResult())}return v};$c.prototype.placePolygonHoles=function(x,v){for(v=v.iterator();v.hasNext();){var y=v.next();y.isHole()&&y.setShell(x)}};$c.prototype.getPolygons=function(){return this.computePolygons(this._shellList)};$c.prototype.findEdgeRingContaining=function(x,v){var y=x.getLinearRing();x=y.getEnvelopeInternal();y=y.getCoordinateN(0);var B=null,G=null;for(v=v.iterator();v.hasNext();){var A=v.next(),F=A.getLinearRing(),J=F.getEnvelopeInternal();
null!==B&&(G=B.getLinearRing().getEnvelopeInternal());var D=!1;J.contains(x)&&Da.isPointInRing(y,F.getCoordinates())&&(D=!0);D&&(null===B||G.contains(J))&&(B=A)}return B};$c.prototype.findShell=function(x){var v=0,y=null;for(x=x.iterator();x.hasNext();){var B=x.next();B.isHole()||(y=B,v++)}return $a.isTrue(1>=v,"found two shells in MinimalEdgeRing list"),y};$c.prototype.add=function(){if(1===arguments.length){var x=arguments[0];this.add(x.getEdgeEnds(),x.getNodes())}else if(2===arguments.length){x=
arguments[0];$b.linkResultDirectedEdges(arguments[1]);var v=this.buildMaximalEdgeRings(x);x=new Fa;v=this.buildMinimalEdgeRings(v,this._shellList,x);this.sortShellsAndHoles(v,this._shellList,x);this.placeFreeHoles(this._shellList,x)}};$c.prototype.interfaces_=function(){return[]};$c.prototype.getClass=function(){return $c};var cg=function(){};cg.prototype.getBounds=function(){};cg.prototype.interfaces_=function(){return[]};cg.prototype.getClass=function(){return cg};var xd=function(x,v){this._bounds=
x;this._item=v};xd.prototype.getItem=function(){return this._item};xd.prototype.getBounds=function(){return this._bounds};xd.prototype.interfaces_=function(){return[cg,ld]};xd.prototype.getClass=function(){return xd};var ye=function(){this._items=null;this._size=0;this._items=new Fa;this._items.add(null)};ye.prototype.poll=function(){if(this.isEmpty())return null;var x=this._items.get(1);return this._items.set(1,this._items.get(this._size)),--this._size,this.reorder(1),x};ye.prototype.size=function(){return this._size};
ye.prototype.reorder=function(x){for(var v=null,y=this._items.get(x);2*x<=this._size&&((v=2*x)!==this._size&&0>this._items.get(v+1).compareTo(this._items.get(v))&&v++,0>this._items.get(v).compareTo(y));x=v)this._items.set(x,this._items.get(v));this._items.set(x,y)};ye.prototype.clear=function(){this._size=0;this._items.clear()};ye.prototype.isEmpty=function(){return 0===this._size};ye.prototype.add=function(x){this._items.add(null);var v=this._size+=1;for(this._items.set(0,x);0>x.compareTo(this._items.get(Math.trunc(v/
2)));v/=2)this._items.set(v,this._items.get(Math.trunc(v/2)));this._items.set(v,x)};ye.prototype.interfaces_=function(){return[]};ye.prototype.getClass=function(){return ye};var He=function(){};He.prototype.visitItem=function(x){};He.prototype.interfaces_=function(){return[]};He.prototype.getClass=function(){return He};var tf=function(){};tf.prototype.insert=function(x,v){};tf.prototype.remove=function(x,v){};tf.prototype.query=function(){};tf.prototype.interfaces_=function(){return[]};tf.prototype.getClass=
function(){return tf};var qc=function(){(this._childBoundables=new Fa,this._bounds=null,this._level=null,0!==arguments.length)&&1===arguments.length&&(this._level=arguments[0])},nn={serialVersionUID:{configurable:!0}};qc.prototype.getLevel=function(){return this._level};qc.prototype.size=function(){return this._childBoundables.size()};qc.prototype.getChildBoundables=function(){return this._childBoundables};qc.prototype.addChildBoundable=function(x){$a.isTrue(null===this._bounds);this._childBoundables.add(x)};
qc.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};qc.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds};qc.prototype.interfaces_=function(){return[cg,ld]};qc.prototype.getClass=function(){return qc};nn.serialVersionUID.get=function(){return 0x5a1e55ec41369800};Object.defineProperties(qc,nn);var Md=function(){};Md.reverseOrder=function(){return{compare:function(x,v){return v.compareTo(x)}}};Md.min=function(x){return Md.sort(x),
x.get(0)};Md.sort=function(x,v){var y=x.toArray();v?Ue.sort(y,v):Ue.sort(y);x=x.iterator();v=0;for(var B=y.length;v<B;v++)x.next(),x.set(y[v])};Md.singletonList=function(x){var v=new Fa;return v.add(x),v};var lc=function(x,v,y){this._distance=null;this._boundable1=x;this._boundable2=v;this._itemDistance=y;this._distance=this.distance()};lc.prototype.expandToQueue=function(x,v){var y=lc.isComposite(this._boundable1),B=lc.isComposite(this._boundable2);if(y&&B)return lc.area(this._boundable1)>lc.area(this._boundable2)?
(this.expand(this._boundable1,this._boundable2,x,v),null):(this.expand(this._boundable2,this._boundable1,x,v),null);if(y)return this.expand(this._boundable1,this._boundable2,x,v),null;if(B)return this.expand(this._boundable2,this._boundable1,x,v),null;throw new cc("neither boundable is composite");};lc.prototype.isLeaves=function(){return!(lc.isComposite(this._boundable1)||lc.isComposite(this._boundable2))};lc.prototype.compareTo=function(x){return this._distance<x._distance?-1:this._distance>x._distance?
1:0};lc.prototype.expand=function(x,v,y,B){for(x=x.getChildBoundables().iterator();x.hasNext();){var G=x.next();G=new lc(G,v,this._itemDistance);G.getDistance()<B&&y.add(G)}};lc.prototype.getBoundable=function(x){return 0===x?this._boundable1:this._boundable2};lc.prototype.getDistance=function(){return this._distance};lc.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};
lc.prototype.interfaces_=function(){return[md]};lc.prototype.getClass=function(){return lc};lc.area=function(x){return x.getBounds().getArea()};lc.isComposite=function(x){return x instanceof qc};var tc=function v(){if(this._root=null,this._built=!1,this._itemBoundables=new Fa,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=v.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var y=arguments[0];$a.isTrue(1<y,"Node capacity must be greater than 1");this._nodeCapacity=y}},ii={IntersectsOp:{configurable:!0},
serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};tc.prototype.getNodeCapacity=function(){return this._nodeCapacity};tc.prototype.lastNode=function(v){return v.get(v.size()-1)};tc.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var v=0,y=arguments[0].getChildBoundables().iterator();y.hasNext();){var B=y.next();B instanceof qc?v+=this.size(B):B instanceof xd&&(v+=1)}return v}};tc.prototype.removeItem=
function(v,y){for(var B=null,G=v.getChildBoundables().iterator();G.hasNext();){var A=G.next();A instanceof xd&&A.getItem()===y&&(B=A)}return null!==B&&(v.getChildBoundables().remove(B),!0)};tc.prototype.itemsTree=function(){if(0===arguments.length){this.build();var v=this.itemsTree(this._root);return null===v?new Fa:v}if(1===arguments.length){var y=arguments[0];v=new Fa;for(y=y.getChildBoundables().iterator();y.hasNext();){var B=y.next();B instanceof qc?(B=this.itemsTree(B),null!==B&&v.add(B)):B instanceof
xd?v.add(B.getItem()):$a.shouldNeverReachHere()}return 0>=v.size()?null:v}};tc.prototype.insert=function(v,y){$a.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built.");this._itemBoundables.add(new xd(v,y))};tc.prototype.boundablesAtLevel=function(){if(1===arguments.length){var v=arguments[0],y=new Fa;return this.boundablesAtLevel(v,this._root,y),y}if(3===arguments.length){v=arguments[0];var B=arguments[1];y=arguments[2];if($a.isTrue(-2<v),B.getLevel()===v)return y.add(B),
null;for(B=B.getChildBoundables().iterator();B.hasNext();){var G=B.next();G instanceof qc?this.boundablesAtLevel(v,G,y):($a.isTrue(G instanceof xd),-1===v&&y.add(G))}return null}};tc.prototype.query=function(){if(1===arguments.length){var v=arguments[0];this.build();var y=new Fa;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),v)&&this.query(v,this._root,y),y}if(2===arguments.length){v=arguments[0];y=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),
v)&&this.query(v,this._root,y)}else if(3===arguments.length)if(Xa(arguments[2],He)&&arguments[0]instanceof Object&&arguments[1]instanceof qc){v=arguments[0];y=arguments[2];for(var B=arguments[1].getChildBoundables(),G=0;G<B.size();G++){var A=B.get(G);this.getIntersectsOp().intersects(A.getBounds(),v)&&(A instanceof qc?this.query(v,A,y):A instanceof xd?y.visitItem(A.getItem()):$a.shouldNeverReachHere())}}else if(Xa(arguments[2],ve)&&arguments[0]instanceof Object&&arguments[1]instanceof qc)for(v=arguments[0],
y=arguments[2],B=arguments[1].getChildBoundables(),G=0;G<B.size();G++)A=B.get(G),this.getIntersectsOp().intersects(A.getBounds(),v)&&(A instanceof qc?this.query(v,A,y):A instanceof xd?y.add(A.getItem()):$a.shouldNeverReachHere())};tc.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1);this._itemBoundables=null;this._built=!0};tc.prototype.getRoot=function(){return this.build(),this._root};
tc.prototype.remove=function(){if(2===arguments.length){var v=arguments[0],y=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),v)&&this.remove(v,this._root,y)}if(3===arguments.length){v=arguments[0];y=arguments[1];var B=arguments[2],G=this.removeItem(y,B);if(G)return!0;for(var A=null,F=y.getChildBoundables().iterator();F.hasNext();){var J=F.next();if(this.getIntersectsOp().intersects(J.getBounds(),v)&&J instanceof qc&&(G=this.remove(v,J,B))){A=J;break}}return null!==
A&&A.getChildBoundables().isEmpty()&&y.getChildBoundables().remove(A),G}};tc.prototype.createHigherLevels=function(v,y){$a.isTrue(!v.isEmpty());v=this.createParentBoundables(v,y+1);return 1===v.size()?v.get(0):this.createHigherLevels(v,y+1)};tc.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var v=0,y=arguments[0].getChildBoundables().iterator();y.hasNext();){var B=y.next();B instanceof qc&&(B=this.depth(B),
B>v&&(v=B))}return v+1}};tc.prototype.createParentBoundables=function(v,y){$a.isTrue(!v.isEmpty());var B=new Fa;B.add(this.createNode(y));v=new Fa(v);Md.sort(v,this.getComparator());for(v=v.iterator();v.hasNext();){var G=v.next();this.lastNode(B).getChildBoundables().size()===this.getNodeCapacity()&&B.add(this.createNode(y));this.lastNode(B).addChildBoundable(G)}return B};tc.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};tc.prototype.interfaces_=
function(){return[ld]};tc.prototype.getClass=function(){return tc};tc.compareDoubles=function(v,y){return v>y?1:v<y?-1:0};ii.IntersectsOp.get=function(){return Dp};ii.serialVersionUID.get=function(){return-0x35ef64c82d4c5400};ii.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(tc,ii);var Dp=function(){},dg=function(){};dg.prototype.distance=function(v,y){};dg.prototype.interfaces_=function(){return[]};dg.prototype.getClass=function(){return dg};var Ep=function(v){function y(G){G=
G||y.DEFAULT_NODE_CAPACITY;v.call(this,G)}v&&(y.__proto__=v);y.prototype=Object.create(v&&v.prototype);y.prototype.constructor=y;var B={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return y.prototype.createParentBoundablesFromVerticalSlices=function(G,A){$a.isTrue(0<G.length);for(var F=new Fa,J=0;J<G.length;J++)F.addAll(this.createParentBoundablesFromVerticalSlice(G[J],
A));return F},y.prototype.createNode=function(G){return new on(G)},y.prototype.size=function(){return 0===arguments.length?v.prototype.size.call(this):v.prototype.size.apply(this,arguments)},y.prototype.insert=function(){if(2!==arguments.length)return v.prototype.insert.apply(this,arguments);var G=arguments[0],A=arguments[1];if(G.isNull())return null;v.prototype.insert.call(this,G,A)},y.prototype.getIntersectsOp=function(){return y.intersectsOp},y.prototype.verticalSlices=function(G,A){var F=Math.trunc(Math.ceil(G.size()/
A)),J=Array(A).fill(null);G=G.iterator();for(var D=0;D<A;D++){J[D]=new Fa;for(var E=0;G.hasNext()&&E<F;){var I=G.next();J[D].add(I);E++}}return J},y.prototype.query=function(){if(1===arguments.length)return v.prototype.query.call(this,arguments[0]);2===arguments.length?v.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Xa(arguments[2],He)&&arguments[0]instanceof Object&&arguments[1]instanceof qc?v.prototype.query.call(this,arguments[0],arguments[1],arguments[2]):Xa(arguments[2],
ve)&&arguments[0]instanceof Object&&arguments[1]instanceof qc&&v.prototype.query.call(this,arguments[0],arguments[1],arguments[2]))},y.prototype.getComparator=function(){return y.yComparator},y.prototype.createParentBoundablesFromVerticalSlice=function(G,A){return v.prototype.createParentBoundables.call(this,G,A)},y.prototype.remove=function(){return 2===arguments.length?v.prototype.remove.call(this,arguments[0],arguments[1]):v.prototype.remove.apply(this,arguments)},y.prototype.depth=function(){return 0===
arguments.length?v.prototype.depth.call(this):v.prototype.depth.apply(this,arguments)},y.prototype.createParentBoundables=function(G,A){$a.isTrue(!G.isEmpty());var F=Math.trunc(Math.ceil(G.size()/this.getNodeCapacity()));G=new Fa(G);Md.sort(G,y.xComparator);F=this.verticalSlices(G,Math.trunc(Math.ceil(Math.sqrt(F))));return this.createParentBoundablesFromVerticalSlices(F,A)},y.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Xa(arguments[0],dg)){var G=arguments[0];G=new lc(this.getRoot(),
this.getRoot(),G);return this.nearestNeighbour(G)}if(arguments[0]instanceof lc)return this.nearestNeighbour(arguments[0],Za.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof y&&Xa(arguments[1],dg)){G=arguments[0];var A=arguments[1];G=new lc(this.getRoot(),G.getRoot(),A);return this.nearestNeighbour(G)}if(arguments[0]instanceof lc&&"number"==typeof arguments[1]){var F=arguments[0];G=arguments[1];A=null;var J=new ye;for(J.add(F);!J.isEmpty()&&0<G;){F=J.poll();var D=F.getDistance();
if(D>=G)break;F.isLeaves()?(G=D,A=F):F.expandToQueue(J,G)}return[A.getBoundable(0).getItem(),A.getBoundable(1).getItem()]}}else if(3===arguments.length)return G=arguments[2],A=new xd(arguments[0],arguments[1]),G=new lc(this.getRoot(),A,G),this.nearestNeighbour(G)[0]},y.prototype.interfaces_=function(){return[tf,ld]},y.prototype.getClass=function(){return y},y.centreX=function(G){return y.avg(G.getMinX(),G.getMaxX())},y.avg=function(G,A){return(G+A)/2},y.centreY=function(G){return y.avg(G.getMinY(),
G.getMaxY())},B.STRtreeNode.get=function(){return on},B.serialVersionUID.get=function(){return 0x39920f7d5f261e0},B.xComparator.get=function(){return{interfaces_:function(){return[Rf]},compare:function(G,A){return v.compareDoubles(y.centreX(G.getBounds()),y.centreX(A.getBounds()))}}},B.yComparator.get=function(){return{interfaces_:function(){return[Rf]},compare:function(G,A){return v.compareDoubles(y.centreY(G.getBounds()),y.centreY(A.getBounds()))}}},B.intersectsOp.get=function(){return{interfaces_:function(){return[v.IntersectsOp]},
intersects:function(G,A){return G.intersects(A)}}},B.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(y,B),y}(tc),on=function(v){function y(B){v.call(this,B)}return v&&(y.__proto__=v),y.prototype=Object.create(v&&v.prototype),y.prototype.constructor=y,y.prototype.computeBounds=function(){for(var B=null,G=this.getChildBoundables().iterator();G.hasNext();){var A=G.next();null===B?B=new Ka(A.getBounds()):B.expandToInclude(A.getBounds())}return B},y.prototype.interfaces_=function(){return[]},
y.prototype.getClass=function(){return y},y}(qc),Qc=function(){};Qc.prototype.interfaces_=function(){return[]};Qc.prototype.getClass=function(){return Qc};Qc.relativeSign=function(v,y){return v<y?-1:v>y?1:0};Qc.compare=function(v,y,B){if(y.equals2D(B))return 0;var G=Qc.relativeSign(y.x,B.x);y=Qc.relativeSign(y.y,B.y);switch(v){case 0:return Qc.compareValue(G,y);case 1:return Qc.compareValue(y,G);case 2:return Qc.compareValue(y,-G);case 3:return Qc.compareValue(-G,y);case 4:return Qc.compareValue(-G,
-y);case 5:return Qc.compareValue(-y,-G);case 6:return Qc.compareValue(-y,G);case 7:return Qc.compareValue(G,-y)}return $a.shouldNeverReachHere("invalid octant value"),0};Qc.compareValue=function(v,y){return 0>v?-1:0<v?1:0>y?-1:0<y?1:0};var Ie=function(v,y,B,G){this._isInterior=this._segmentOctant=this.segmentIndex=this.coord=null;this._segString=v;this.coord=new ua(y);this.segmentIndex=B;this._segmentOctant=G;this._isInterior=!y.equals2D(v.getCoordinate(B))};Ie.prototype.getCoordinate=function(){return this.coord};
Ie.prototype.print=function(v){v.print(this.coord);v.print(" seg # = "+this.segmentIndex)};Ie.prototype.compareTo=function(v){return this.segmentIndex<v.segmentIndex?-1:this.segmentIndex>v.segmentIndex?1:this.coord.equals2D(v.coord)?0:Qc.compare(this._segmentOctant,this.coord,v.coord)};Ie.prototype.isEndPoint=function(v){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===v};Ie.prototype.isInterior=function(){return this._isInterior};Ie.prototype.interfaces_=function(){return[md]};
Ie.prototype.getClass=function(){return Ie};var Kc=function(v){this._nodeMap=new Bc;this._edge=v};Kc.prototype.getSplitCoordinates=function(){var v=new Tg;this.addEndpoints();for(var y=this.iterator(),B=y.next();y.hasNext();){var G=y.next();this.addEdgeCoordinates(B,G,v);B=G}return v.toCoordinateArray()};Kc.prototype.addCollapsedNodes=function(){var v=new Fa;this.findCollapsesFromInsertedNodes(v);this.findCollapsesFromExistingVertices(v);for(v=v.iterator();v.hasNext();){var y=v.next().intValue();
this.add(this._edge.getCoordinate(y),y)}};Kc.prototype.print=function(v){v.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(v)};Kc.prototype.findCollapsesFromExistingVertices=function(v){for(var y=0;y<this._edge.size()-2;y++){var B=this._edge.getCoordinate(y),G=this._edge.getCoordinate(y+2);B.equals2D(G)&&v.add(new Fd(y+1))}};Kc.prototype.addEdgeCoordinates=function(v,y,B){var G=this._edge.getCoordinate(y.segmentIndex);G=y.isInterior()||!y.coord.equals2D(G);B.add(new ua(v.coord),
!1);for(v=v.segmentIndex+1;v<=y.segmentIndex;v++)B.add(this._edge.getCoordinate(v));G&&B.add(new ua(y.coord))};Kc.prototype.iterator=function(){return this._nodeMap.values().iterator()};Kc.prototype.addSplitEdges=function(v){this.addEndpoints();this.addCollapsedNodes();for(var y=this.iterator(),B=y.next();y.hasNext();){var G=y.next();B=this.createSplitEdge(B,G);v.add(B);B=G}};Kc.prototype.findCollapseIndex=function(v,y,B){if(!v.coord.equals2D(y.coord))return!1;var G=y.segmentIndex-v.segmentIndex;
return y.isInterior()||G--,1===G&&(B[0]=v.segmentIndex+1,!0)};Kc.prototype.findCollapsesFromInsertedNodes=function(v){for(var y=Array(1).fill(null),B=this.iterator(),G=B.next();B.hasNext();){var A=B.next();this.findCollapseIndex(G,A,y)&&v.add(new Fd(y[0]));G=A}};Kc.prototype.getEdge=function(){return this._edge};Kc.prototype.addEndpoints=function(){var v=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0);this.add(this._edge.getCoordinate(v),v)};Kc.prototype.createSplitEdge=function(v,y){var B=
y.segmentIndex-v.segmentIndex+2,G=this._edge.getCoordinate(y.segmentIndex);(G=y.isInterior()||!y.coord.equals2D(G))||B--;B=Array(B).fill(null);var A=0;B[A++]=new ua(v.coord);for(v=v.segmentIndex+1;v<=y.segmentIndex;v++)B[A++]=this._edge.getCoordinate(v);return G&&(B[A]=new ua(y.coord)),new gc(B,this._edge.getData())};Kc.prototype.add=function(v,y){y=new Ie(this._edge,v,y,this._edge.getSegmentOctant(y));var B=this._nodeMap.get(y);return null!==B?($a.isTrue(B.coord.equals2D(v),"Found equal nodes with different coordinates"),
B):(this._nodeMap.put(y,y),y)};Kc.prototype.checkSplitEdgesCorrectness=function(v){var y=this._edge.getCoordinates(),B=v.get(0).getCoordinate(0);if(!B.equals2D(y[0]))throw new se("bad split edge start point at "+B);v=v.get(v.size()-1).getCoordinates();v=v[v.length-1];if(!v.equals2D(y[y.length-1]))throw new se("bad split edge end point at "+v);};Kc.prototype.interfaces_=function(){return[]};Kc.prototype.getClass=function(){return Kc};var uf=function(){};uf.prototype.interfaces_=function(){return[]};
uf.prototype.getClass=function(){return uf};uf.octant=function(v,y){if("number"==typeof v&&"number"==typeof y){if(0===v&&0===y)throw new cc("Cannot compute the octant for point ( "+v+", "+y+" )");var B=Math.abs(v),G=Math.abs(y);return 0<=v?0<=y?B>=G?0:1:B>=G?7:6:0<=y?B>=G?3:2:B>=G?4:5}if(v instanceof ua&&y instanceof ua){B=y.x-v.x;y=y.y-v.y;if(0===B&&0===y)throw new cc("Cannot compute the octant for two identical points "+v);return uf.octant(B,y)}};var ae=function(){};ae.prototype.getCoordinates=
function(){};ae.prototype.size=function(){};ae.prototype.getCoordinate=function(v){};ae.prototype.isClosed=function(){};ae.prototype.setData=function(v){};ae.prototype.getData=function(){};ae.prototype.interfaces_=function(){return[]};ae.prototype.getClass=function(){return ae};var ah=function(){};ah.prototype.addIntersection=function(v,y){};ah.prototype.interfaces_=function(){return[ae]};ah.prototype.getClass=function(){return ah};var gc=function(v,y){this._nodeList=new Kc(this);this._pts=v;this._data=
y};gc.prototype.getCoordinates=function(){return this._pts};gc.prototype.size=function(){return this._pts.length};gc.prototype.getCoordinate=function(v){return this._pts[v]};gc.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};gc.prototype.getSegmentOctant=function(v){return v===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(v),this.getCoordinate(v+1))};gc.prototype.setData=function(v){this._data=v};gc.prototype.safeOctant=function(v,y){return v.equals2D(y)?
0:uf.octant(v,y)};gc.prototype.getData=function(){return this._data};gc.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var v=arguments[1],y=new ua(arguments[0].getIntersection(arguments[3]));this.addIntersection(y,v)}};gc.prototype.toString=function(){return re.toLineString(new jc(this._pts))};gc.prototype.getNodeList=function(){return this._nodeList};gc.prototype.addIntersectionNode=function(v,y){var B=
y+1;B<this._pts.length&&v.equals2D(this._pts[B])&&(y=B);return this._nodeList.add(v,y)};gc.prototype.addIntersections=function(v,y,B){for(var G=0;G<v.getIntersectionNum();G++)this.addIntersection(v,y,B,G)};gc.prototype.interfaces_=function(){return[ah]};gc.prototype.getClass=function(){return gc};gc.getNodedSubstrings=function(){if(1===arguments.length){var v=arguments[0],y=new Fa;return gc.getNodedSubstrings(v,y),y}if(2===arguments.length)for(v=arguments[1],y=arguments[0].iterator();y.hasNext();)y.next().getNodeList().addSplitEdges(v)};
var Qa=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new ua,this.p1=new ua;else if(1===arguments.length){var v=arguments[0];this.p0=new ua(v.p0);this.p1=new ua(v.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){v=arguments[2];var y=arguments[3];this.p0=new ua(arguments[0],arguments[1]);this.p1=new ua(v,y)}},pn={serialVersionUID:{configurable:!0}};Qa.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};Qa.prototype.orientationIndex=
function(v){if(v instanceof Qa){var y=Da.orientationIndex(this.p0,this.p1,v.p0);v=Da.orientationIndex(this.p0,this.p1,v.p1);return 0<=y&&0<=v||0>=y&&0>=v?Math.max(y,v):0}if(v instanceof ua)return Da.orientationIndex(this.p0,this.p1,v)};Qa.prototype.toGeometry=function(v){return v.createLineString([this.p0,this.p1])};Qa.prototype.isVertical=function(){return this.p0.x===this.p1.x};Qa.prototype.equals=function(v){return v instanceof Qa?this.p0.equals(v.p0)&&this.p1.equals(v.p1):!1};Qa.prototype.intersection=
function(v){var y=new Te;return y.computeIntersection(this.p0,this.p1,v.p0,v.p1),y.hasIntersection()?y.getIntersection(0):null};Qa.prototype.project=function(v){if(v instanceof ua){if(v.equals(this.p0)||v.equals(this.p1))return new ua(v);var y=this.projectionFactor(v),B=new ua;return B.x=this.p0.x+y*(this.p1.x-this.p0.x),B.y=this.p0.y+y*(this.p1.y-this.p0.y),B}if(v instanceof Qa){var G=this.projectionFactor(v.p0);y=this.projectionFactor(v.p1);if(1<=G&&1<=y||0>=G&&0>=y)return null;B=this.project(v.p0);
0>G&&(B=this.p0);1<G&&(B=this.p1);v=this.project(v.p1);return 0>y&&(v=this.p0),1<y&&(v=this.p1),new Qa(B,v)}};Qa.prototype.normalize=function(){0>this.p1.compareTo(this.p0)&&this.reverse()};Qa.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};Qa.prototype.getCoordinate=function(v){return 0===v?this.p0:this.p1};Qa.prototype.distancePerpendicular=function(v){return Da.distancePointLinePerpendicular(v,this.p0,this.p1)};Qa.prototype.minY=function(){return Math.min(this.p0.y,
this.p1.y)};Qa.prototype.midPoint=function(){return Qa.midPoint(this.p0,this.p1)};Qa.prototype.projectionFactor=function(v){if(v.equals(this.p0))return 0;if(v.equals(this.p1))return 1;var y=this.p1.x-this.p0.x,B=this.p1.y-this.p0.y,G=y*y+B*B;return 0>=G?Za.NaN:((v.x-this.p0.x)*y+(v.y-this.p0.y)*B)/G};Qa.prototype.closestPoints=function(v){var y=this.intersection(v);if(null!==y)return[y,y];y=Array(2).fill(null);var B=null,G=this.closestPoint(v.p0);var A=G.distance(v.p0);y[0]=G;y[1]=v.p0;G=this.closestPoint(v.p1);
(B=G.distance(v.p1))<A&&(A=B,y[0]=G,y[1]=v.p1);G=v.closestPoint(this.p0);(B=G.distance(this.p0))<A&&(A=B,y[0]=this.p0,y[1]=G);v=v.closestPoint(this.p1);return v.distance(this.p1)<A&&(y[0]=this.p1,y[1]=v),y};Qa.prototype.closestPoint=function(v){var y=this.projectionFactor(v);return 0<y&&1>y?this.project(v):this.p0.distance(v)<this.p1.distance(v)?this.p0:this.p1};Qa.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};Qa.prototype.getLength=function(){return this.p0.distance(this.p1)};Qa.prototype.compareTo=
function(v){var y=this.p0.compareTo(v.p0);return 0!==y?y:this.p1.compareTo(v.p1)};Qa.prototype.reverse=function(){var v=this.p0;this.p0=this.p1;this.p1=v};Qa.prototype.equalsTopo=function(v){return this.p0.equals(v.p0)&&(this.p1.equals(v.p1)||this.p0.equals(v.p1))&&this.p1.equals(v.p0)};Qa.prototype.lineIntersection=function(v){try{return ud.intersection(this.p0,this.p1,v.p0,v.p1)}catch(y){if(!(y instanceof Tf))throw y;}return null};Qa.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};
Qa.prototype.pointAlongOffset=function(v,y){var B=this.p0.x+v*(this.p1.x-this.p0.x);v=this.p0.y+v*(this.p1.y-this.p0.y);var G=this.p1.x-this.p0.x,A=this.p1.y-this.p0.y,F=Math.sqrt(G*G+A*A),J=0,D=0;if(0!==y){if(0>=F)throw Error("Cannot compute offset from zero-length line segment");J=y*G/F;D=y*A/F}return new ua(B-D,v+J)};Qa.prototype.setCoordinates=function(){if(1===arguments.length){var v=arguments[0];this.setCoordinates(v.p0,v.p1)}else if(2===arguments.length){v=arguments[0];var y=arguments[1];this.p0.x=
v.x;this.p0.y=v.y;this.p1.x=y.x;this.p1.y=y.y}};Qa.prototype.segmentFraction=function(v){v=this.projectionFactor(v);return 0>v?v=0:(1<v||Za.isNaN(v))&&(v=1),v};Qa.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};Qa.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};Qa.prototype.distance=function(v){if(v instanceof Qa)return Da.distanceLineLine(this.p0,this.p1,v.p0,v.p1);if(v instanceof ua)return Da.distancePointLine(v,this.p0,
this.p1)};Qa.prototype.pointAlong=function(v){var y=new ua;return y.x=this.p0.x+v*(this.p1.x-this.p0.x),y.y=this.p0.y+v*(this.p1.y-this.p0.y),y};Qa.prototype.hashCode=function(){var v=Za.doubleToLongBits(this.p0.x);v^=31*Za.doubleToLongBits(this.p0.y);v=Math.trunc(v)^Math.trunc(v>>32);var y=Za.doubleToLongBits(this.p1.x);return y^=31*Za.doubleToLongBits(this.p1.y),v^Math.trunc(y)^Math.trunc(y>>32)};Qa.prototype.interfaces_=function(){return[md,ld]};Qa.prototype.getClass=function(){return Qa};Qa.midPoint=
function(v,y){return new ua((v.x+y.x)/2,(v.y+y.y)/2)};pn.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(Qa,pn);var bh=function(){this.tempEnv1=new Ka;this.tempEnv2=new Ka;this._overlapSeg1=new Qa;this._overlapSeg2=new Qa};bh.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var v=arguments[2],y=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1);v.getLineSegment(y,this._overlapSeg2);this.overlap(this._overlapSeg1,this._overlapSeg2)}};
bh.prototype.interfaces_=function(){return[]};bh.prototype.getClass=function(){return bh};var ad=function(v,y,B,G){this._id=this._env=null;this._pts=v;this._start=y;this._end=B;this._context=G};ad.prototype.getLineSegment=function(v,y){y.p0=this._pts[v];y.p1=this._pts[v+1]};ad.prototype.computeSelect=function(v,y,B,G){if(G.tempEnv1.init(this._pts[y],this._pts[B]),1==B-y)return G.select(this,y),null;if(!v.intersects(G.tempEnv1))return null;var A=Math.trunc((y+B)/2);y<A&&this.computeSelect(v,y,A,G);
A<B&&this.computeSelect(v,A,B,G)};ad.prototype.getCoordinates=function(){for(var v=Array(this._end-this._start+1).fill(null),y=0,B=this._start;B<=this._end;B++)v[y++]=this._pts[B];return v};ad.prototype.computeOverlaps=function(v,y){this.computeOverlapsInternal(this._start,this._end,v,v._start,v._end,y)};ad.prototype.setId=function(v){this._id=v};ad.prototype.select=function(v,y){this.computeSelect(v,this._start,this._end,y)};ad.prototype.getEnvelope=function(){null===this._env&&(this._env=new Ka(this._pts[this._start],
this._pts[this._end]));return this._env};ad.prototype.getEndIndex=function(){return this._end};ad.prototype.getStartIndex=function(){return this._start};ad.prototype.getContext=function(){return this._context};ad.prototype.getId=function(){return this._id};ad.prototype.computeOverlapsInternal=function(v,y,B,G,A,F){var J=this._pts[v],D=this._pts[y],E=B._pts[G],I=B._pts[A];if(1==y-v&&1==A-G)return F.overlap(this,v,B,G),null;if(F.tempEnv1.init(J,D),F.tempEnv2.init(E,I),!F.tempEnv1.intersects(F.tempEnv2))return null;
J=Math.trunc((v+y)/2);D=Math.trunc((G+A)/2);v<J&&(G<D&&this.computeOverlapsInternal(v,J,B,G,D,F),D<A&&this.computeOverlapsInternal(v,J,B,D,A,F));J<y&&(G<D&&this.computeOverlapsInternal(J,y,B,G,D,F),D<A&&this.computeOverlapsInternal(J,y,B,D,A,F))};ad.prototype.interfaces_=function(){return[]};ad.prototype.getClass=function(){return ad};var Nd=function(){};Nd.prototype.interfaces_=function(){return[]};Nd.prototype.getClass=function(){return Nd};Nd.getChainStartIndices=function(v){var y=0,B=new Fa;B.add(new Fd(y));
do y=Nd.findChainEnd(v,y),B.add(new Fd(y));while(y<v.length-1);return Nd.toIntArray(B)};Nd.findChainEnd=function(v,y){for(var B=y;B<v.length-1&&v[B].equals2D(v[B+1]);)B++;if(B>=v.length-1)return v.length-1;B=Pb.quadrant(v[B],v[B+1]);for(y+=1;y<v.length&&(v[y-1].equals2D(v[y])||Pb.quadrant(v[y-1],v[y])===B);)y++;return y-1};Nd.getChains=function(){if(1===arguments.length)return Nd.getChains(arguments[0],null);if(2===arguments.length){for(var v=arguments[0],y=arguments[1],B=new Fa,G=Nd.getChainStartIndices(v),
A=0;A<G.length-1;A++){var F=new ad(v,G[A],G[A+1],y);B.add(F)}return B}};Nd.toIntArray=function(v){for(var y=Array(v.size()).fill(null),B=0;B<y.length;B++)y[B]=v.get(B).intValue();return y};var Ye=function(){};Ye.prototype.computeNodes=function(v){};Ye.prototype.getNodedSubstrings=function(){};Ye.prototype.interfaces_=function(){return[]};Ye.prototype.getClass=function(){return Ye};var ch=function(){(this._segInt=null,0!==arguments.length)&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};
ch.prototype.setSegmentIntersector=function(v){this._segInt=v};ch.prototype.interfaces_=function(){return[Ye]};ch.prototype.getClass=function(){return ch};var Nj=function(v){function y(G){G?v.call(this,G):v.call(this);this._monoChains=new Fa;this._index=new Ep;this._idCounter=0;this._nodedSegStrings=null;this._nOverlaps=0}v&&(y.__proto__=v);y.prototype=Object.create(v&&v.prototype);y.prototype.constructor=y;var B={SegmentOverlapAction:{configurable:!0}};return y.prototype.getMonotoneChains=function(){return this._monoChains},
y.prototype.getNodedSubstrings=function(){return gc.getNodedSubstrings(this._nodedSegStrings)},y.prototype.getIndex=function(){return this._index},y.prototype.add=function(G){for(G=Nd.getChains(G.getCoordinates(),G).iterator();G.hasNext();){var A=G.next();A.setId(this._idCounter++);this._index.insert(A.getEnvelope(),A);this._monoChains.add(A)}},y.prototype.computeNodes=function(G){this._nodedSegStrings=G;for(G=G.iterator();G.hasNext();)this.add(G.next());this.intersectChains()},y.prototype.intersectChains=
function(){for(var G=new qn(this._segInt),A=this._monoChains.iterator();A.hasNext();)for(var F=A.next(),J=this._index.query(F.getEnvelope()).iterator();J.hasNext();){var D=J.next();if(D.getId()>F.getId()&&(F.computeOverlaps(D,G),this._nOverlaps++),this._segInt.isDone())return null}},y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},B.SegmentOverlapAction.get=function(){return qn},Object.defineProperties(y,B),y}(ch),qn=function(v){function y(B){v.call(this);this._si=
B}return v&&(y.__proto__=v),y.prototype=Object.create(v&&v.prototype),y.prototype.constructor=y,y.prototype.overlap=function(){if(4!==arguments.length)return v.prototype.overlap.apply(this,arguments);var B=arguments[1],G=arguments[2],A=arguments[3],F=arguments[0].getContext();G=G.getContext();this._si.processIntersections(F,B,G,A)},y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y}(bh),Jb=function y(){if(this._quadrantSegments=y.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=
y.CAP_ROUND,this._joinStyle=y.JOIN_ROUND,this._mitreLimit=y.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=y.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var B=arguments[1];this.setQuadrantSegments(arguments[0]);this.setEndCapStyle(B)}else if(4===arguments.length){B=arguments[1];var G=arguments[2],A=arguments[3];this.setQuadrantSegments(arguments[0]);this.setEndCapStyle(B);this.setJoinStyle(G);
this.setMitreLimit(A)}},ze={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Jb.prototype.getEndCapStyle=function(){return this._endCapStyle};Jb.prototype.isSingleSided=function(){return this._isSingleSided};Jb.prototype.setQuadrantSegments=function(y){this._quadrantSegments=
y;0===this._quadrantSegments&&(this._joinStyle=Jb.JOIN_BEVEL);0>this._quadrantSegments&&(this._joinStyle=Jb.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments));0>=y&&(this._quadrantSegments=1);this._joinStyle!==Jb.JOIN_ROUND&&(this._quadrantSegments=Jb.DEFAULT_QUADRANT_SEGMENTS)};Jb.prototype.getJoinStyle=function(){return this._joinStyle};Jb.prototype.setJoinStyle=function(y){this._joinStyle=y};Jb.prototype.setSimplifyFactor=function(y){this._simplifyFactor=0>y?0:y};Jb.prototype.getSimplifyFactor=
function(){return this._simplifyFactor};Jb.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Jb.prototype.setEndCapStyle=function(y){this._endCapStyle=y};Jb.prototype.getMitreLimit=function(){return this._mitreLimit};Jb.prototype.setMitreLimit=function(y){this._mitreLimit=y};Jb.prototype.setSingleSided=function(y){this._isSingleSided=y};Jb.prototype.interfaces_=function(){return[]};Jb.prototype.getClass=function(){return Jb};Jb.bufferDistanceError=function(y){return 1-Math.cos(Math.PI/
2/y/2)};ze.CAP_ROUND.get=function(){return 1};ze.CAP_FLAT.get=function(){return 2};ze.CAP_SQUARE.get=function(){return 3};ze.JOIN_ROUND.get=function(){return 1};ze.JOIN_MITRE.get=function(){return 2};ze.JOIN_BEVEL.get=function(){return 3};ze.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};ze.DEFAULT_MITRE_LIMIT.get=function(){return 5};ze.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01};Object.defineProperties(Jb,ze);var dc=function(y){this._isDeleted=this._distanceTol=null;this._angleOrientation=
Da.COUNTERCLOCKWISE;this._inputLine=y||null},dh={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};dc.prototype.isDeletable=function(y,B,G,A){var F=this._inputLine[y];B=this._inputLine[B];var J=this._inputLine[G];return!!this.isConcave(F,B,J)&&!!this.isShallow(F,B,J,A)&&this.isShallowSampled(F,B,y,G,A)};dc.prototype.deleteShallowConcavities=function(){for(var y=1,B=this.findNextNonDeletedIndex(y),G=this.findNextNonDeletedIndex(B),A=!1;G<this._inputLine.length;){var F=
!1;this.isDeletable(y,B,G,this._distanceTol)&&(this._isDeleted[B]=dc.DELETE,F=!0,A=!0);y=F?G:B;B=this.findNextNonDeletedIndex(y);G=this.findNextNonDeletedIndex(B)}return A};dc.prototype.isShallowConcavity=function(y,B,G,A){return Da.computeOrientation(y,B,G)===this._angleOrientation&&Da.distancePointLine(B,y,G)<A};dc.prototype.isShallowSampled=function(y,B,G,A,F){var J=Math.trunc((A-G)/dc.NUM_PTS_TO_CHECK);for(0>=J&&(J=1);G<A;G+=J)if(!this.isShallow(y,B,this._inputLine[G],F))return!1;return!0};dc.prototype.isConcave=
function(y,B,G){return Da.computeOrientation(y,B,G)===this._angleOrientation};dc.prototype.simplify=function(y){this._distanceTol=Math.abs(y);0>y&&(this._angleOrientation=Da.CLOCKWISE);this._isDeleted=Array(this._inputLine.length).fill(null);do y=this.deleteShallowConcavities();while(y);return this.collapseLine()};dc.prototype.findNextNonDeletedIndex=function(y){for(y+=1;y<this._inputLine.length&&this._isDeleted[y]===dc.DELETE;)y++;return y};dc.prototype.isShallow=function(y,B,G,A){return Da.distancePointLine(B,
y,G)<A};dc.prototype.collapseLine=function(){for(var y=new Tg,B=0;B<this._inputLine.length;B++)this._isDeleted[B]!==dc.DELETE&&y.add(this._inputLine[B]);return y.toCoordinateArray()};dc.prototype.interfaces_=function(){return[]};dc.prototype.getClass=function(){return dc};dc.simplify=function(y,B){return(new dc(y)).simplify(B)};dh.INIT.get=function(){return 0};dh.DELETE.get=function(){return 1};dh.KEEP.get=function(){return 1};dh.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(dc,
dh);var hd=function(){this._precisionModel=this._ptList=null;this._minimimVertexDistance=0;this._ptList=new Fa},rn={COORDINATE_ARRAY_TYPE:{configurable:!0}};hd.prototype.getCoordinates=function(){return this._ptList.toArray(hd.COORDINATE_ARRAY_TYPE)};hd.prototype.setPrecisionModel=function(y){this._precisionModel=y};hd.prototype.addPt=function(y){y=new ua(y);if(this._precisionModel.makePrecise(y),this.isRedundant(y))return null;this._ptList.add(y)};hd.prototype.revere=function(){};hd.prototype.addPts=
function(y,B){if(B)for(B=0;B<y.length;B++)this.addPt(y[B]);else for(B=y.length-1;0<=B;B--)this.addPt(y[B])};hd.prototype.isRedundant=function(y){if(1>this._ptList.size())return!1;var B=this._ptList.get(this._ptList.size()-1);return y.distance(B)<this._minimimVertexDistance};hd.prototype.toString=function(){return(new db).createLineString(this.getCoordinates()).toString()};hd.prototype.closeRing=function(){if(1>this._ptList.size())return null;var y=new ua(this._ptList.get(0)),B=this._ptList.get(this._ptList.size()-
1);if(y.equals(B))return null;this._ptList.add(y)};hd.prototype.setMinimumVertexDistance=function(y){this._minimimVertexDistance=y};hd.prototype.interfaces_=function(){return[]};hd.prototype.getClass=function(){return hd};rn.COORDINATE_ARRAY_TYPE.get=function(){return[].fill(null)};Object.defineProperties(hd,rn);var fb=function(){},vf={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};
fb.prototype.interfaces_=function(){return[]};fb.prototype.getClass=function(){return fb};fb.toDegrees=function(y){return 180*y/Math.PI};fb.normalize=function(y){for(;y>Math.PI;)y-=fb.PI_TIMES_2;for(;y<=-Math.PI;)y+=fb.PI_TIMES_2;return y};fb.angle=function(){if(1===arguments.length){var y=arguments[0];return Math.atan2(y.y,y.x)}if(2===arguments.length){y=arguments[0];var B=arguments[1];return Math.atan2(B.y-y.y,B.x-y.x)}};fb.isAcute=function(y,B,G){return 0<(y.x-B.x)*(G.x-B.x)+(y.y-B.y)*(G.y-B.y)};
fb.isObtuse=function(y,B,G){return 0>(y.x-B.x)*(G.x-B.x)+(y.y-B.y)*(G.y-B.y)};fb.interiorAngle=function(y,B,G){y=fb.angle(B,y);B=fb.angle(B,G);return Math.abs(B-y)};fb.normalizePositive=function(y){if(0>y){for(;0>y;)y+=fb.PI_TIMES_2;y>=fb.PI_TIMES_2&&(y=0)}else{for(;y>=fb.PI_TIMES_2;)y-=fb.PI_TIMES_2;0>y&&(y=0)}return y};fb.angleBetween=function(y,B,G){y=fb.angle(B,y);B=fb.angle(B,G);return fb.diff(y,B)};fb.diff=function(y,B){var G=null;return(G=y<B?B-y:y-B)>Math.PI&&(G=2*Math.PI-G),G};fb.toRadians=
function(y){return y*Math.PI/180};fb.getTurn=function(y,B){y=Math.sin(B-y);return 0<y?fb.COUNTERCLOCKWISE:0>y?fb.CLOCKWISE:fb.NONE};fb.angleBetweenOriented=function(y,B,G){y=fb.angle(B,y);B=fb.angle(B,G)-y;return B<=-Math.PI?B+fb.PI_TIMES_2:B>Math.PI?B-fb.PI_TIMES_2:B};vf.PI_TIMES_2.get=function(){return 2*Math.PI};vf.PI_OVER_2.get=function(){return Math.PI/2};vf.PI_OVER_4.get=function(){return Math.PI/4};vf.COUNTERCLOCKWISE.get=function(){return Da.COUNTERCLOCKWISE};vf.CLOCKWISE.get=function(){return Da.CLOCKWISE};
vf.NONE.get=function(){return Da.COLLINEAR};Object.defineProperties(fb,vf);var Xb=function F(B,G,A){this._maxCurveSegmentError=0;this._filletAngleQuantum=null;this._closingSegLengthFactor=1;this._segList=null;this._distance=0;this._s2=this._s1=this._s0=this._li=this._bufParams=this._precisionModel=null;this._seg0=new Qa;this._seg1=new Qa;this._offset0=new Qa;this._offset1=new Qa;this._side=0;this._hasNarrowConcaveAngle=!1;this._precisionModel=B;this._bufParams=G;this._li=new Te;this._filletAngleQuantum=
Math.PI/2/G.getQuadrantSegments();8<=G.getQuadrantSegments()&&G.getJoinStyle()===Jb.JOIN_ROUND&&(this._closingSegLengthFactor=F.MAX_CLOSING_SEG_LEN_FACTOR);this.init(A)},eh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Xb.prototype.addNextSegment=function(B,G){if(this._s0=this._s1,this._s1=this._s2,this._s2=B,this._seg0.setCoordinates(this._s0,
this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;B=Da.computeOrientation(this._s0,this._s1,this._s2);var A=B===Da.CLOCKWISE&&this._side===Ba.LEFT||B===Da.COUNTERCLOCKWISE&&this._side===Ba.RIGHT;0===B?this.addCollinear(G):A?this.addOutsideTurn(B,G):this.addInsideTurn(B,G)};Xb.prototype.addLineEndCap=function(B,
G){var A=new Qa(B,G),F=new Qa;this.computeOffsetSegment(A,Ba.LEFT,this._distance,F);var J=new Qa;this.computeOffsetSegment(A,Ba.RIGHT,this._distance,J);B=Math.atan2(G.y-B.y,G.x-B.x);switch(this._bufParams.getEndCapStyle()){case Jb.CAP_ROUND:this._segList.addPt(F.p1);this.addFilletArc(G,B+Math.PI/2,B-Math.PI/2,Da.CLOCKWISE,this._distance);this._segList.addPt(J.p1);break;case Jb.CAP_FLAT:this._segList.addPt(F.p1);this._segList.addPt(J.p1);break;case Jb.CAP_SQUARE:G=new ua,G.x=Math.abs(this._distance)*
Math.cos(B),G.y=Math.abs(this._distance)*Math.sin(B),F=new ua(F.p1.x+G.x,F.p1.y+G.y),J=new ua(J.p1.x+G.x,J.p1.y+G.y),this._segList.addPt(F),this._segList.addPt(J)}};Xb.prototype.getCoordinates=function(){return this._segList.getCoordinates()};Xb.prototype.addMitreJoin=function(B,G,A,F){var J=!0,D=null;try{D=ud.intersection(G.p0,G.p1,A.p0,A.p1),(0>=F?1:D.distance(B)/Math.abs(F))>this._bufParams.getMitreLimit()&&(J=!1)}catch(E){if(!(E instanceof Tf))throw E;D=new ua(0,0);J=!1}J?this._segList.addPt(D):
this.addLimitedMitreJoin(G,A,F,this._bufParams.getMitreLimit())};Xb.prototype.addFilletCorner=function(B,G,A,F,J){var D=Math.atan2(G.y-B.y,G.x-B.x),E=Math.atan2(A.y-B.y,A.x-B.x);F===Da.CLOCKWISE?D<=E&&(D+=2*Math.PI):D>=E&&(D-=2*Math.PI);this._segList.addPt(G);this.addFilletArc(B,D,E,F,J);this._segList.addPt(A)};Xb.prototype.addOutsideTurn=function(B,G){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Xb.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;
this._bufParams.getJoinStyle()===Jb.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Jb.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(G&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,B,this._distance),this._segList.addPt(this._offset1.p0))};Xb.prototype.createSquare=function(B){this._segList.addPt(new ua(B.x+this._distance,B.y+this._distance));this._segList.addPt(new ua(B.x+
this._distance,B.y-this._distance));this._segList.addPt(new ua(B.x-this._distance,B.y-this._distance));this._segList.addPt(new ua(B.x-this._distance,B.y+this._distance));this._segList.closeRing()};Xb.prototype.addSegments=function(B,G){this._segList.addPts(B,G)};Xb.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Xb.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Xb.prototype.initSideSegments=function(B,G,A){this._s1=B;this._s2=G;this._side=A;
this._seg1.setCoordinates(B,G);this.computeOffsetSegment(this._seg1,A,this._distance,this._offset1)};Xb.prototype.addLimitedMitreJoin=function(B,G,A,F){B=this._seg0.p1;var J=fb.angle(B,this._seg0.p0);G=fb.angleBetweenOriented(this._seg0.p0,B,this._seg1.p1)/2;J=fb.normalize(J+G);J=fb.normalize(J+Math.PI);F*=A;A-=F*Math.abs(Math.sin(G));F=new ua(B.x+F*Math.cos(J),B.y+F*Math.sin(J));F=new Qa(B,F);B=F.pointAlongOffset(1,A);A=F.pointAlongOffset(1,-A);this._side===Ba.LEFT?(this._segList.addPt(B),this._segList.addPt(A)):
(this._segList.addPt(A),this._segList.addPt(B))};Xb.prototype.computeOffsetSegment=function(B,G,A,F){G=G===Ba.LEFT?1:-1;var J=B.p1.x-B.p0.x,D=B.p1.y-B.p0.y,E=Math.sqrt(J*J+D*D);J=G*A*J/E;A=G*A*D/E;F.p0.x=B.p0.x-A;F.p0.y=B.p0.y+J;F.p1.x=B.p1.x-A;F.p1.y=B.p1.y+J};Xb.prototype.addFilletArc=function(B,G,A,F,J){F=F===Da.CLOCKWISE?-1:1;A=Math.abs(G-A);var D=Math.trunc(A/this._filletAngleQuantum+.5);if(1>D)return null;D=A/D;for(var E=0,I=new ua;E<A;){var K=G+F*E;I.x=B.x+J*Math.cos(K);I.y=B.y+J*Math.sin(K);
this._segList.addPt(I);E+=D}};Xb.prototype.addInsideTurn=function(B,G){(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())?this._segList.addPt(this._li.getIntersection(0)):(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Xb.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)?this._segList.addPt(this._offset0.p1):((this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor)?(B=new ua((this._closingSegLengthFactor*
this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(B),B=new ua((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(B)):this._segList.addPt(this._s1),this._segList.addPt(this._offset1.p0))};Xb.prototype.createCircle=function(B){var G=
new ua(B.x+this._distance,B.y);this._segList.addPt(G);this.addFilletArc(B,0,2*Math.PI,-1,this._distance);this._segList.closeRing()};Xb.prototype.addBevelJoin=function(B,G){this._segList.addPt(B.p1);this._segList.addPt(G.p0)};Xb.prototype.init=function(B){this._distance=B;this._maxCurveSegmentError=B*(1-Math.cos(this._filletAngleQuantum/2));this._segList=new hd;this._segList.setPrecisionModel(this._precisionModel);this._segList.setMinimumVertexDistance(B*Xb.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Xb.prototype.addCollinear=
function(B){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===Jb.JOIN_BEVEL||this._bufParams.getJoinStyle()===Jb.JOIN_MITRE?(B&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Da.CLOCKWISE,this._distance))};Xb.prototype.closeRing=function(){this._segList.closeRing()};Xb.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};
Xb.prototype.interfaces_=function(){return[]};Xb.prototype.getClass=function(){return Xb};eh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001};eh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001};eh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1E-6};eh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Xb,eh);var Rc=function(B,G){this._distance=0;this._precisionModel=B;this._bufParams=G};Rc.prototype.getOffsetCurve=function(B,G){if(this._distance=
G,0===G)return null;var A=0>G;G=this.getSegGen(Math.abs(G));1>=B.length?this.computePointCurve(B[0],G):this.computeOffsetCurve(B,A,G);B=G.getCoordinates();return A&&cb.reverse(B),B};Rc.prototype.computeSingleSidedBufferCurve=function(B,G,A){var F=this.simplifyTolerance(this._distance);if(G)for(A.addSegments(B,!0),B=dc.simplify(B,-F),G=B.length-1,A.initSideSegments(B[G],B[G-1],Ba.LEFT),A.addFirstSegment(),G-=2;0<=G;G--)A.addNextSegment(B[G],!0);else for(A.addSegments(B,!1),B=dc.simplify(B,F),G=B.length-
1,A.initSideSegments(B[0],B[1],Ba.LEFT),A.addFirstSegment(),F=2;F<=G;F++)A.addNextSegment(B[F],!0);A.addLastSegment();A.closeRing()};Rc.prototype.computeRingBufferCurve=function(B,G,A){var F=this.simplifyTolerance(this._distance);G===Ba.RIGHT&&(F=-F);B=dc.simplify(B,F);F=B.length-1;A.initSideSegments(B[F-1],B[0],G);for(G=1;G<=F;G++)A.addNextSegment(B[G],1!==G);A.closeRing()};Rc.prototype.computeLineBufferCurve=function(B,G){var A=this.simplifyTolerance(this._distance),F=dc.simplify(B,A),J=F.length-
1;G.initSideSegments(F[0],F[1],Ba.LEFT);for(var D=2;D<=J;D++)G.addNextSegment(F[D],!0);G.addLastSegment();G.addLineEndCap(F[J-1],F[J]);B=dc.simplify(B,-A);A=B.length-1;G.initSideSegments(B[A],B[A-1],Ba.LEFT);for(A-=2;0<=A;A--)G.addNextSegment(B[A],!0);G.addLastSegment();G.addLineEndCap(B[1],B[0]);G.closeRing()};Rc.prototype.computePointCurve=function(B,G){switch(this._bufParams.getEndCapStyle()){case Jb.CAP_ROUND:G.createCircle(B);break;case Jb.CAP_SQUARE:G.createSquare(B)}};Rc.prototype.getLineCurve=
function(B,G){if((this._distance=G,0>G&&!this._bufParams.isSingleSided())||0===G)return null;var A=this.getSegGen(Math.abs(G));1>=B.length?this.computePointCurve(B[0],A):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(B,0>G,A):this.computeLineBufferCurve(B,A);return A.getCoordinates()};Rc.prototype.getBufferParameters=function(){return this._bufParams};Rc.prototype.simplifyTolerance=function(B){return B*this._bufParams.getSimplifyFactor()};Rc.prototype.getRingCurve=function(B,G,
A){if(this._distance=A,2>=B.length)return this.getLineCurve(B,A);if(0===A)return Rc.copyCoordinates(B);A=this.getSegGen(A);return this.computeRingBufferCurve(B,G,A),A.getCoordinates()};Rc.prototype.computeOffsetCurve=function(B,G,A){var F=this.simplifyTolerance(this._distance);if(G)for(B=dc.simplify(B,-F),G=B.length-1,A.initSideSegments(B[G],B[G-1],Ba.LEFT),A.addFirstSegment(),G-=2;0<=G;G--)A.addNextSegment(B[G],!0);else for(B=dc.simplify(B,F),G=B.length-1,A.initSideSegments(B[0],B[1],Ba.LEFT),A.addFirstSegment(),
F=2;F<=G;F++)A.addNextSegment(B[F],!0);A.addLastSegment()};Rc.prototype.getSegGen=function(B){return new Xb(this._precisionModel,this._bufParams,B)};Rc.prototype.interfaces_=function(){return[]};Rc.prototype.getClass=function(){return Rc};Rc.copyCoordinates=function(B){for(var G=Array(B.length).fill(null),A=0;A<G.length;A++)G[A]=new ua(B[A]);return G};var wf=function(B){this._subgraphs=null;this._seg=new Qa;this._cga=new Da;this._subgraphs=B},sn={DepthSegment:{configurable:!0}};wf.prototype.findStabbedSegments=
function(){if(1===arguments.length){for(var B=arguments[0],G=new Fa,A=this._subgraphs.iterator();A.hasNext();){var F=A.next(),J=F.getEnvelope();B.y<J.getMinY()||B.y>J.getMaxY()||this.findStabbedSegments(B,F.getDirectedEdges(),G)}return G}if(3===arguments.length)if(Xa(arguments[2],ve)&&arguments[0]instanceof ua&&arguments[1]instanceof Mj)for(B=arguments[0],G=arguments[1],A=arguments[2],F=G.getEdge().getCoordinates(),J=0;J<F.length-1;J++){if(this._seg.p0=F[J],this._seg.p1=F[J+1],this._seg.p0.y>this._seg.p1.y&&
this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<B.x||this._seg.isHorizontal()||B.y<this._seg.p0.y||B.y>this._seg.p1.y||Da.computeOrientation(this._seg.p0,this._seg.p1,B)===Da.RIGHT)){var D=G.getDepth(Ba.LEFT);this._seg.p0.equals(F[J])||(D=G.getDepth(Ba.RIGHT));D=new Ze(this._seg,D);A.add(D)}}else if(Xa(arguments[2],ve)&&arguments[0]instanceof ua&&Xa(arguments[1],ve))for(B=arguments[0],G=arguments[2],A=arguments[1].iterator();A.hasNext();)F=A.next(),F.isForward()&&this.findStabbedSegments(B,
F,G)};wf.prototype.getDepth=function(B){B=this.findStabbedSegments(B);return 0===B.size()?0:Md.min(B)._leftDepth};wf.prototype.interfaces_=function(){return[]};wf.prototype.getClass=function(){return wf};sn.DepthSegment.get=function(){return Ze};Object.defineProperties(wf,sn);var Ze=function(B,G){this._leftDepth=this._upwardSeg=null;this._upwardSeg=new Qa(B);this._leftDepth=G};Ze.prototype.compareTo=function(B){if(this._upwardSeg.minX()>=B._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=B._upwardSeg.minX())return-1;
var G=this._upwardSeg.orientationIndex(B._upwardSeg);return 0!==G||0!==(G=-1*B._upwardSeg.orientationIndex(this._upwardSeg))?G:this._upwardSeg.compareTo(B._upwardSeg)};Ze.prototype.compareX=function(B,G){var A=B.p0.compareTo(G.p0);return 0!==A?A:B.p1.compareTo(G.p1)};Ze.prototype.toString=function(){return this._upwardSeg.toString()};Ze.prototype.interfaces_=function(){return[md]};Ze.prototype.getClass=function(){return Ze};var Kb=function(B,G,A){this.p0=B||null;this.p1=G||null;this.p2=A||null};Kb.prototype.area=
function(){return Kb.area(this.p0,this.p1,this.p2)};Kb.prototype.signedArea=function(){return Kb.signedArea(this.p0,this.p1,this.p2)};Kb.prototype.interpolateZ=function(B){if(null===B)throw new cc("Supplied point is null.");return Kb.interpolateZ(B,this.p0,this.p1,this.p2)};Kb.prototype.longestSideLength=function(){return Kb.longestSideLength(this.p0,this.p1,this.p2)};Kb.prototype.isAcute=function(){return Kb.isAcute(this.p0,this.p1,this.p2)};Kb.prototype.circumcentre=function(){return Kb.circumcentre(this.p0,
this.p1,this.p2)};Kb.prototype.area3D=function(){return Kb.area3D(this.p0,this.p1,this.p2)};Kb.prototype.centroid=function(){return Kb.centroid(this.p0,this.p1,this.p2)};Kb.prototype.inCentre=function(){return Kb.inCentre(this.p0,this.p1,this.p2)};Kb.prototype.interfaces_=function(){return[]};Kb.prototype.getClass=function(){return Kb};Kb.area=function(B,G,A){return Math.abs(((A.x-B.x)*(G.y-B.y)-(G.x-B.x)*(A.y-B.y))/2)};Kb.signedArea=function(B,G,A){return((A.x-B.x)*(G.y-B.y)-(G.x-B.x)*(A.y-B.y))/
2};Kb.det=function(B,G,A,F){return B*F-G*A};Kb.interpolateZ=function(B,G,A,F){var J=G.x,D=G.y,E=A.x-J,I=F.x-J,K=A.y-D,N=F.y-D,U=E*N-I*K;J=B.x-J;B=B.y-D;return G.z+(N*J-I*B)/U*(A.z-G.z)+(-K*J+E*B)/U*(F.z-G.z)};Kb.longestSideLength=function(B,G,A){var F=B.distance(G);G=G.distance(A);B=A.distance(B);return G>F&&(F=G),B>F&&(F=B),F};Kb.isAcute=function(B,G,A){return!!fb.isAcute(B,G,A)&&!!fb.isAcute(G,A,B)&&!!fb.isAcute(A,B,G)};Kb.circumcentre=function(B,G,A){var F=A.x;A=A.y;var J=B.x-F;B=B.y-A;var D=G.x-
F,E=G.y-A;G=2*Kb.det(J,B,D,E);var I=Kb.det(B,J*J+B*B,E,D*D+E*E);J=Kb.det(J,J*J+B*B,D,D*D+E*E);return new ua(F-I/G,A+J/G)};Kb.perpendicularBisector=function(B,G){var A=G.x-B.x,F=G.y-B.y;G=new ud(B.x+A/2,B.y+F/2,1);B=new ud(B.x-F+A/2,B.y+A+F/2,1);return new ud(G,B)};Kb.angleBisector=function(B,G,A){var F=G.distance(B);G=F/(F+G.distance(A));return new ua(B.x+G*(A.x-B.x),B.y+G*(A.y-B.y))};Kb.area3D=function(B,G,A){var F=G.x-B.x,J=G.y-B.y,D=G.z-B.z;G=A.x-B.x;var E=A.y-B.y;A=A.z-B.z;B=J*A-D*E;D=D*G-F*A;
F=F*E-J*G;return Math.sqrt(B*B+D*D+F*F)/2};Kb.centroid=function(B,G,A){return new ua((B.x+G.x+A.x)/3,(B.y+G.y+A.y)/3)};Kb.inCentre=function(B,G,A){var F=G.distance(A),J=B.distance(A),D=B.distance(G),E=F+J+D;return new ua((F*B.x+J*G.x+D*A.x)/E,(F*B.y+J*G.y+D*A.y)/E)};var rd=function(B,G,A){this._curveBuilder=this._distance=this._inputGeom=null;this._curveList=new Fa;this._inputGeom=B;this._distance=G;this._curveBuilder=A};rd.prototype.addPoint=function(B){if(0>=this._distance)return null;B=B.getCoordinates();
B=this._curveBuilder.getLineCurve(B,this._distance);this.addCurve(B,va.EXTERIOR,va.INTERIOR)};rd.prototype.addPolygon=function(B){var G=this._distance,A=Ba.LEFT;0>this._distance&&(G=-this._distance,A=Ba.RIGHT);var F=B.getExteriorRing(),J=cb.removeRepeatedPoints(F.getCoordinates());if(0>this._distance&&this.isErodedCompletely(F,this._distance)||0>=this._distance&&3>J.length)return null;this.addPolygonRing(J,G,A,va.EXTERIOR,va.INTERIOR);for(F=0;F<B.getNumInteriorRing();F++){J=B.getInteriorRingN(F);
var D=cb.removeRepeatedPoints(J.getCoordinates());0<this._distance&&this.isErodedCompletely(J,-this._distance)||this.addPolygonRing(D,G,Ba.opposite(A),va.INTERIOR,va.EXTERIOR)}};rd.prototype.isTriangleErodedCompletely=function(B,G){B=new Kb(B[0],B[1],B[2]);var A=B.inCentre();return Da.distancePointLine(A,B.p0,B.p1)<Math.abs(G)};rd.prototype.addLineString=function(B){if(0>=this._distance&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;B=cb.removeRepeatedPoints(B.getCoordinates());
B=this._curveBuilder.getLineCurve(B,this._distance);this.addCurve(B,va.EXTERIOR,va.INTERIOR)};rd.prototype.addCurve=function(B,G,A){if(null===B||2>B.length)return null;B=new gc(B,new Mb(0,va.BOUNDARY,G,A));this._curveList.add(B)};rd.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};rd.prototype.addPolygonRing=function(B,G,A,F,J){if(0===G&&B.length<Zd.MINIMUM_VALID_SIZE)return null;var D=F,E=J;B.length>=Zd.MINIMUM_VALID_SIZE&&Da.isCCW(B)&&(D=J,E=F,A=Ba.opposite(A));B=
this._curveBuilder.getRingCurve(B,A,G);this.addCurve(B,D,E)};rd.prototype.add=function(B){if(B.isEmpty())return null;B instanceof Hd?this.addPolygon(B):B instanceof Ic?this.addLineString(B):B instanceof Yd?this.addPoint(B):(B instanceof ag||B instanceof We||B instanceof Ge||B instanceof wd)&&this.addCollection(B)};rd.prototype.isErodedCompletely=function(B,G){var A=B.getCoordinates();if(4>A.length)return 0>G;if(4===A.length)return this.isTriangleErodedCompletely(A,G);B=B.getEnvelopeInternal();B=Math.min(B.getHeight(),
B.getWidth());return 0>G&&2*Math.abs(G)>B};rd.prototype.addCollection=function(B){for(var G=0;G<B.getNumGeometries();G++){var A=B.getGeometryN(G);this.add(A)}};rd.prototype.interfaces_=function(){return[]};rd.prototype.getClass=function(){return rd};var eg=function(){};eg.prototype.locate=function(B){};eg.prototype.interfaces_=function(){return[]};eg.prototype.getClass=function(){return eg};var be=function(B){this._subcollectionIterator=this._max=null;this._parent=B;this._atStart=!0;this._index=0;
this._max=B.getNumGeometries()};be.prototype.next=function(){if(this._atStart)return this._atStart=!1,be.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Mf;var B=this._parent.getGeometryN(this._index++);return B instanceof wd?(this._subcollectionIterator=new be(B),this._subcollectionIterator.next()):B};be.prototype.remove=
function(){throw Error(this.getClass().getName());};be.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};be.prototype.interfaces_=function(){return[Zf]};be.prototype.getClass=function(){return be};be.isAtomic=function(B){return!(B instanceof wd)};var id=function(B){this._geom=B};id.prototype.locate=function(B){return id.locate(B,this._geom)};
id.prototype.interfaces_=function(){return[eg]};id.prototype.getClass=function(){return id};id.isPointInRing=function(B,G){return!!G.getEnvelopeInternal().intersects(B)&&Da.isPointInRing(B,G.getCoordinates())};id.containsPointInPolygon=function(B,G){if(G.isEmpty())return!1;var A=G.getExteriorRing();if(!id.isPointInRing(B,A))return!1;for(A=0;A<G.getNumInteriorRing();A++){var F=G.getInteriorRingN(A);if(id.isPointInRing(B,F))return!1}return!0};id.containsPoint=function(B,G){if(G instanceof Hd)return id.containsPointInPolygon(B,
G);if(G instanceof wd)for(var A=new be(G);A.hasNext();){var F=A.next();if(F!==G&&id.containsPoint(B,F))return!0}return!1};id.locate=function(B,G){return G.isEmpty()?va.EXTERIOR:id.containsPoint(B,G)?va.INTERIOR:va.EXTERIOR};var Dc=function(){this._edgeMap=new Bc;this._edgeList=null;this._ptInAreaLocation=[va.NONE,va.NONE]};Dc.prototype.getNextCW=function(B){this.getEdges();B=this._edgeList.indexOf(B);var G=B-1;return 0===B&&(G=this._edgeList.size()-1),this._edgeList.get(G)};Dc.prototype.propagateSideLabels=
function(B){for(var G=va.NONE,A=this.iterator();A.hasNext();){var F=A.next().getLabel();F.isArea(B)&&F.getLocation(B,Ba.LEFT)!==va.NONE&&(G=F.getLocation(B,Ba.LEFT))}if(G===va.NONE)return null;for(A=this.iterator();A.hasNext();){F=A.next();var J=F.getLabel();if(J.getLocation(B,Ba.ON)===va.NONE&&J.setLocation(B,Ba.ON,G),J.isArea(B)){var D=J.getLocation(B,Ba.LEFT),E=J.getLocation(B,Ba.RIGHT);if(E!==va.NONE){if(E!==G)throw new xe("side location conflict",F.getCoordinate());D===va.NONE&&$a.shouldNeverReachHere("found single null side (at "+
F.getCoordinate()+")");G=D}else $a.isTrue(J.getLocation(B,Ba.LEFT)===va.NONE,"found single null side"),J.setLocation(B,Ba.RIGHT,G),J.setLocation(B,Ba.LEFT,G)}}};Dc.prototype.getCoordinate=function(){var B=this.iterator();return B.hasNext()?B.next().getCoordinate():null};Dc.prototype.print=function(B){Pc.out.println("EdgeEndStar:   "+this.getCoordinate());for(var G=this.iterator();G.hasNext();)G.next().print(B)};Dc.prototype.isAreaLabelsConsistent=function(B){return this.computeEdgeEndLabels(B.getBoundaryNodeRule()),
this.checkAreaLabelsConsistent(0)};Dc.prototype.checkAreaLabelsConsistent=function(B){var G=this.getEdges();if(0>=G.size())return!0;var A=G.size()-1;G=G.get(A).getLabel().getLocation(B,Ba.LEFT);$a.isTrue(G!==va.NONE,"Found unlabelled area edge");for(A=this.iterator();A.hasNext();){var F=A.next().getLabel();$a.isTrue(F.isArea(B),"Found non-area edge");var J=F.getLocation(B,Ba.LEFT);F=F.getLocation(B,Ba.RIGHT);if(J===F||F!==G)return!1;G=J}return!0};Dc.prototype.findIndex=function(B){this.iterator();
for(var G=0;G<this._edgeList.size();G++)if(this._edgeList.get(G)===B)return G;return-1};Dc.prototype.iterator=function(){return this.getEdges().iterator()};Dc.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Fa(this._edgeMap.values())),this._edgeList};Dc.prototype.getLocation=function(B,G,A){return this._ptInAreaLocation[B]===va.NONE&&(this._ptInAreaLocation[B]=id.locate(G,A[B].getGeometry())),this._ptInAreaLocation[B]};Dc.prototype.toString=function(){var B=new Ed;
B.append("EdgeEndStar:   "+this.getCoordinate());B.append("\n");for(var G=this.iterator();G.hasNext();){var A=G.next();B.append(A);B.append("\n")}return B.toString()};Dc.prototype.computeEdgeEndLabels=function(B){for(var G=this.iterator();G.hasNext();)G.next().computeLabel(B)};Dc.prototype.computeLabelling=function(B){this.computeEdgeEndLabels(B[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);for(var G=[!1,!1],A=this.iterator();A.hasNext();)for(var F=A.next().getLabel(),
J=0;2>J;J++)F.isLine(J)&&F.getLocation(J)===va.BOUNDARY&&(G[J]=!0);for(A=this.iterator();A.hasNext();){F=A.next();J=F.getLabel();for(var D=0;2>D;D++)if(J.isAnyNull(D)){if(G[D])var E=va.EXTERIOR;else E=F.getCoordinate(),E=this.getLocation(D,E,B);J.setAllLocationsIfNull(D,E)}}};Dc.prototype.getDegree=function(){return this._edgeMap.size()};Dc.prototype.insertEdgeEnd=function(B,G){this._edgeMap.put(B,G);this._edgeList=null};Dc.prototype.interfaces_=function(){return[]};Dc.prototype.getClass=function(){return Dc};
var Fp=function(B){function G(){B.call(this);this._label=this._resultAreaEdgeList=null;this._SCANNING_FOR_INCOMING=1;this._LINKING_TO_OUTGOING=2}return B&&(G.__proto__=B),G.prototype=Object.create(B&&B.prototype),G.prototype.constructor=G,G.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var A=null,F=null,J=this._SCANNING_FOR_INCOMING,D=0;D<this._resultAreaEdgeList.size();D++){var E=this._resultAreaEdgeList.get(D),I=E.getSym();if(E.getLabel().isArea())switch(null===A&&E.isInResult()&&
(A=E),J){case this._SCANNING_FOR_INCOMING:if(!I.isInResult())continue;F=I;J=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:E.isInResult()&&(F.setNext(E),J=this._SCANNING_FOR_INCOMING)}}if(J===this._LINKING_TO_OUTGOING){if(null===A)throw new xe("no outgoing dirEdge found",this.getCoordinate());$a.isTrue(A.isInResult(),"unable to link last incoming dirEdge");F.setNext(A)}},G.prototype.insert=function(A){this.insertEdgeEnd(A,A)},G.prototype.getRightmostEdge=function(){var A=this.getEdges(),
F=A.size();if(1>F)return null;var J=A.get(0);if(1===F)return J;A=A.get(F-1);F=J.getQuadrant();var D=A.getQuadrant();return Pb.isNorthern(F)&&Pb.isNorthern(D)?J:Pb.isNorthern(F)||Pb.isNorthern(D)?0!==J.getDy()?J:0!==A.getDy()?A:($a.shouldNeverReachHere("found two horizontal edges incident on node"),null):A},G.prototype.print=function(A){Pc.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var F=this.iterator();F.hasNext();){var J=F.next();A.print("out ");J.print(A);A.println();A.print("in ");
J.getSym().print(A);A.println()}},G.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Fa;for(var A=this.iterator();A.hasNext();){var F=A.next();(F.isInResult()||F.getSym().isInResult())&&this._resultAreaEdgeList.add(F)}return this._resultAreaEdgeList},G.prototype.updateLabelling=function(A){for(var F=this.iterator();F.hasNext();){var J=F.next().getLabel();J.setAllLocationsIfNull(0,A.getLocation(0));J.setAllLocationsIfNull(1,
A.getLocation(1))}},G.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var A=null,F=null,J=this._edgeList.size()-1;0<=J;J--){var D=this._edgeList.get(J),E=D.getSym();null===F&&(F=E);null!==A&&E.setNext(A);A=D}F.setNext(A)},G.prototype.computeDepths=function(){if(1===arguments.length){var A=arguments[0],F=this.findIndex(A),J=A.getDepth(Ba.LEFT),D=A.getDepth(Ba.RIGHT);J=this.computeDepths(F+1,this._edgeList.size(),J);if(this.computeDepths(0,F,J)!==D)throw new xe("depth mismatch at "+A.getCoordinate());
}else if(3===arguments.length){A=arguments[1];F=arguments[2];for(D=arguments[0];D<A;D++)J=this._edgeList.get(D),J.setEdgeDepths(Ba.RIGHT,F),F=J.getDepth(Ba.LEFT);return F}},G.prototype.mergeSymLabels=function(){for(var A=this.iterator();A.hasNext();){var F=A.next();F.getLabel().merge(F.getSym().getLabel())}},G.prototype.linkMinimalDirectedEdges=function(A){for(var F=null,J=null,D=this._SCANNING_FOR_INCOMING,E=this._resultAreaEdgeList.size()-1;0<=E;E--){var I=this._resultAreaEdgeList.get(E),K=I.getSym();
switch(null===F&&I.getEdgeRing()===A&&(F=I),D){case this._SCANNING_FOR_INCOMING:if(K.getEdgeRing()!==A)continue;J=K;D=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:I.getEdgeRing()===A&&(J.setNextMin(I),D=this._SCANNING_FOR_INCOMING)}}D===this._LINKING_TO_OUTGOING&&($a.isTrue(null!==F,"found null for first outgoing dirEdge"),$a.isTrue(F.getEdgeRing()===A,"unable to link last incoming dirEdge"),J.setNextMin(F))},G.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var A=
0,F=this.iterator();F.hasNext();)F.next().isInResult()&&A++;return A}if(1===arguments.length){A=arguments[0];F=0;for(var J=this.iterator();J.hasNext();)J.next().getEdgeRing()===A&&F++;return F}},G.prototype.getLabel=function(){return this._label},G.prototype.findCoveredLineEdges=function(){for(var A=va.NONE,F=this.iterator();F.hasNext();){var J=F.next(),D=J.getSym();if(!J.isLineEdge()){if(J.isInResult()){A=va.INTERIOR;break}if(D.isInResult()){A=va.EXTERIOR;break}}}if(A===va.NONE)return null;for(F=
this.iterator();F.hasNext();)J=F.next(),D=J.getSym(),J.isLineEdge()?J.getEdge().setCovered(A===va.INTERIOR):(J.isInResult()&&(A=va.EXTERIOR),D.isInResult()&&(A=va.INTERIOR))},G.prototype.computeLabelling=function(A){B.prototype.computeLabelling.call(this,A);this._label=new Mb(va.NONE);for(A=this.iterator();A.hasNext();)for(var F=A.next().getEdge().getLabel(),J=0;2>J;J++){var D=F.getLocation(J);D!==va.INTERIOR&&D!==va.BOUNDARY||this._label.setLocation(J,va.INTERIOR)}},G.prototype.interfaces_=function(){return[]},
G.prototype.getClass=function(){return G},G}(Dc),tn=function(B){function G(){B.apply(this,arguments)}return B&&(G.__proto__=B),G.prototype=Object.create(B&&B.prototype),G.prototype.constructor=G,G.prototype.createNode=function(A){return new hi(A,new Fp)},G.prototype.interfaces_=function(){return[]},G.prototype.getClass=function(){return G},G}(bg),Je=function A(G){this._orientation=null;this._pts=G;this._orientation=A.orientation(G)};Je.prototype.compareTo=function(G){return Je.compareOriented(this._pts,
this._orientation,G._pts,G._orientation)};Je.prototype.interfaces_=function(){return[md]};Je.prototype.getClass=function(){return Je};Je.orientation=function(G){return 1===cb.increasingDirection(G)};Je.compareOriented=function(G,A,F,J){var D=A?1:-1,E=J?1:-1,I=A?G.length:-1,K=J?F.length:-1;A=A?0:G.length-1;for(J=J?0:F.length-1;;){var N=G[A].compareTo(F[J]);if(0!==N)return N;N=(A+=D)===I;var U=(J+=E)===K;if(N&&!U)return-1;if(!N&&U)return 1;if(N&&U)return 0}};var yd=function(){this._edges=new Fa;this._ocaMap=
new Bc};yd.prototype.print=function(G){G.print("MULTILINESTRING ( ");for(var A=0;A<this._edges.size();A++){var F=this._edges.get(A);0<A&&G.print(",");G.print("(");F=F.getCoordinates();for(var J=0;J<F.length;J++)0<J&&G.print(","),G.print(F[J].x+" "+F[J].y);G.println(")")}G.print(")  ")};yd.prototype.addAll=function(G){for(G=G.iterator();G.hasNext();)this.add(G.next())};yd.prototype.findEdgeIndex=function(G){for(var A=0;A<this._edges.size();A++)if(this._edges.get(A).equals(G))return A;return-1};yd.prototype.iterator=
function(){return this._edges.iterator()};yd.prototype.getEdges=function(){return this._edges};yd.prototype.get=function(G){return this._edges.get(G)};yd.prototype.findEqualEdge=function(G){G=new Je(G.getCoordinates());return this._ocaMap.get(G)};yd.prototype.add=function(G){this._edges.add(G);var A=new Je(G.getCoordinates());this._ocaMap.put(A,G)};yd.prototype.interfaces_=function(){return[]};yd.prototype.getClass=function(){return yd};var $e=function(){};$e.prototype.processIntersections=function(G,
A,F,J){};$e.prototype.isDone=function(){};$e.prototype.interfaces_=function(){return[]};$e.prototype.getClass=function(){return $e};var jd=function(G){this._hasInterior=this._hasProperInterior=this._hasProper=this._hasIntersection=!1;this._isSelfIntersection=this._properIntersectionPoint=null;this.numTests=this.numProperIntersections=this.numInteriorIntersections=this.numIntersections=0;this._li=G};jd.prototype.isTrivialIntersection=function(G,A,F,J){return G===F&&1===this._li.getIntersectionNum()&&
(jd.isAdjacentSegments(A,J)||G.isClosed()&&(G=G.size()-1,0===A&&J===G||0===J&&A===G))?!0:!1};jd.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};jd.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};jd.prototype.getLineIntersector=function(){return this._li};jd.prototype.hasProperIntersection=function(){return this._hasProper};jd.prototype.processIntersections=function(G,A,F,J){if(G===F&&A===J)return null;this.numTests++;var D=G.getCoordinates()[A],
E=G.getCoordinates()[A+1],I=F.getCoordinates()[J],K=F.getCoordinates()[J+1];this._li.computeIntersection(D,E,I,K);this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(G,A,F,J)||(this._hasIntersection=!0,G.addIntersections(this._li,A,0),F.addIntersections(this._li,J,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};jd.prototype.hasIntersection=
function(){return this._hasIntersection};jd.prototype.isDone=function(){return!1};jd.prototype.hasInteriorIntersection=function(){return this._hasInterior};jd.prototype.interfaces_=function(){return[$e]};jd.prototype.getClass=function(){return jd};jd.isAdjacentSegments=function(G,A){return 1===Math.abs(G-A)};var Od=function(G,A,F){this.dist=this.segmentIndex=this.coord=null;this.coord=new ua(G);this.segmentIndex=A;this.dist=F};Od.prototype.getSegmentIndex=function(){return this.segmentIndex};Od.prototype.getCoordinate=
function(){return this.coord};Od.prototype.print=function(G){G.print(this.coord);G.print(" seg # = "+this.segmentIndex);G.println(" dist = "+this.dist)};Od.prototype.compareTo=function(G){return this.compare(G.segmentIndex,G.dist)};Od.prototype.isEndPoint=function(G){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===G};Od.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Od.prototype.getDistance=function(){return this.dist};Od.prototype.compare=
function(G,A){return this.segmentIndex<G?-1:this.segmentIndex>G?1:this.dist<A?-1:this.dist>A?1:0};Od.prototype.interfaces_=function(){return[md]};Od.prototype.getClass=function(){return Od};var ce=function(G){this._nodeMap=new Bc;this.edge=G};ce.prototype.print=function(G){G.println("Intersections:");for(var A=this.iterator();A.hasNext();)A.next().print(G)};ce.prototype.iterator=function(){return this._nodeMap.values().iterator()};ce.prototype.addSplitEdges=function(G){this.addEndpoints();for(var A=
this.iterator(),F=A.next();A.hasNext();){var J=A.next();F=this.createSplitEdge(F,J);G.add(F);F=J}};ce.prototype.addEndpoints=function(){var G=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0);this.add(this.edge.pts[G],G,0)};ce.prototype.createSplitEdge=function(G,A){var F=A.segmentIndex-G.segmentIndex+2,J=this.edge.pts[A.segmentIndex];(J=0<A.dist||!A.coord.equals2D(J))||F--;F=Array(F).fill(null);var D=0;F[D++]=new ua(G.coord);for(G=G.segmentIndex+1;G<=A.segmentIndex;G++)F[D++]=this.edge.pts[G];
return J&&(F[D]=A.coord),new ji(F,new Mb(this.edge._label))};ce.prototype.add=function(G,A,F){G=new Od(G,A,F);A=this._nodeMap.get(G);return null!==A?A:(this._nodeMap.put(G,G),G)};ce.prototype.isIntersection=function(G){for(var A=this.iterator();A.hasNext();)if(A.next().coord.equals(G))return!0;return!1};ce.prototype.interfaces_=function(){return[]};ce.prototype.getClass=function(){return ce};var af=function(){};af.prototype.getChainStartIndices=function(G){var A=0,F=new Fa;F.add(new Fd(A));do A=this.findChainEnd(G,
A),F.add(new Fd(A));while(A<G.length-1);return af.toIntArray(F)};af.prototype.findChainEnd=function(G,A){var F=Pb.quadrant(G[A],G[A+1]);for(A+=1;A<G.length&&Pb.quadrant(G[A-1],G[A])===F;)A++;return A-1};af.prototype.interfaces_=function(){return[]};af.prototype.getClass=function(){return af};af.toIntArray=function(G){for(var A=Array(G.size()).fill(null),F=0;F<A.length;F++)A[F]=G.get(F).intValue();return A};var Ae=function(G){this.startIndex=this.pts=this.e=null;this.env1=new Ka;this.env2=new Ka;this.e=
G;this.pts=G.getCoordinates();this.startIndex=(new af).getChainStartIndices(this.pts)};Ae.prototype.getCoordinates=function(){return this.pts};Ae.prototype.getMaxX=function(G){var A=this.pts[this.startIndex[G]].x;G=this.pts[this.startIndex[G+1]].x;return A>G?A:G};Ae.prototype.getMinX=function(G){var A=this.pts[this.startIndex[G]].x;G=this.pts[this.startIndex[G+1]].x;return A<G?A:G};Ae.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var G=arguments[0],A=arguments[1],F=arguments[2];
this.computeIntersectsForChain(this.startIndex[G],this.startIndex[G+1],A,A.startIndex[F],A.startIndex[F+1],arguments[3])}else if(6===arguments.length){G=arguments[0];A=arguments[1];F=arguments[2];var J=arguments[3],D=arguments[4],E=arguments[5],I=this.pts[G],K=this.pts[A],N=F.pts[J],U=F.pts[D];if(1==A-G&&1==D-J)return E.addIntersections(this.e,G,F.e,J),null;if(this.env1.init(I,K),this.env2.init(N,U),!this.env1.intersects(this.env2))return null;I=Math.trunc((G+A)/2);K=Math.trunc((J+D)/2);G<I&&(J<K&&
this.computeIntersectsForChain(G,I,F,J,K,E),K<D&&this.computeIntersectsForChain(G,I,F,K,D,E));I<A&&(J<K&&this.computeIntersectsForChain(I,A,F,J,K,E),K<D&&this.computeIntersectsForChain(I,A,F,K,D,E))}};Ae.prototype.getStartIndexes=function(){return this.startIndex};Ae.prototype.computeIntersects=function(G,A){for(var F=0;F<this.startIndex.length-1;F++)for(var J=0;J<G.startIndex.length-1;J++)this.computeIntersectsForChain(F,G,J,A)};Ae.prototype.interfaces_=function(){return[]};Ae.prototype.getClass=
function(){return Ae};var zc=function A(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var F=0;2>F;F++)for(var J=0;3>J;J++)this._depth[F][J]=A.NULL_VALUE},un={NULL_VALUE:{configurable:!0}};zc.prototype.getDepth=function(A,F){return this._depth[A][F]};zc.prototype.setDepth=function(A,F,J){this._depth[A][F]=J};zc.prototype.isNull=function(){if(0===arguments.length){for(var A=0;2>A;A++)for(var F=0;3>F;F++)if(this._depth[A][F]!==zc.NULL_VALUE)return!1;return!0}if(1===arguments.length)return this._depth[arguments[0]][1]===
zc.NULL_VALUE;if(2===arguments.length)return this._depth[arguments[0]][arguments[1]]===zc.NULL_VALUE};zc.prototype.normalize=function(){for(var A=0;2>A;A++)if(!this.isNull(A)){var F=this._depth[A][1];this._depth[A][2]<F&&(F=this._depth[A][2]);0>F&&(F=0);for(var J=1;3>J;J++){var D=0;this._depth[A][J]>F&&(D=1);this._depth[A][J]=D}}};zc.prototype.getDelta=function(A){return this._depth[A][Ba.RIGHT]-this._depth[A][Ba.LEFT]};zc.prototype.getLocation=function(A,F){return 0>=this._depth[A][F]?va.EXTERIOR:
va.INTERIOR};zc.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};zc.prototype.add=function(){if(1===arguments.length)for(var A=arguments[0],F=0;2>F;F++)for(var J=1;3>J;J++){var D=A.getLocation(F,J);D!==va.EXTERIOR&&D!==va.INTERIOR||(this.isNull(F,J)?this._depth[F][J]=zc.depthAtLocation(D):this._depth[F][J]+=zc.depthAtLocation(D))}else 3===arguments.length&&(A=arguments[0],F=arguments[1],arguments[2]===va.INTERIOR&&this._depth[A][F]++)};
zc.prototype.interfaces_=function(){return[]};zc.prototype.getClass=function(){return zc};zc.depthAtLocation=function(A){return A===va.EXTERIOR?0:A===va.INTERIOR?1:zc.NULL_VALUE};un.NULL_VALUE.get=function(){return-1};Object.defineProperties(zc,un);var ji=function(A){function F(){if(A.call(this),this.pts=null,this._env=null,this.eiList=new ce(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new zc,this._depthDelta=0,1===arguments.length)F.call(this,arguments[0],null);else if(2===
arguments.length){var J=arguments[1];this.pts=arguments[0];this._label=J}}return A&&(F.__proto__=A),F.prototype=Object.create(A&&A.prototype),F.prototype.constructor=F,F.prototype.getDepth=function(){return this._depth},F.prototype.getCollapsedEdge=function(){var J=Array(2).fill(null);return J[0]=this.pts[0],J[1]=this.pts[1],new F(J,Mb.toLineLabel(this._label))},F.prototype.isIsolated=function(){return this._isIsolated},F.prototype.getCoordinates=function(){return this.pts},F.prototype.setIsolated=
function(J){this._isIsolated=J},F.prototype.setName=function(J){this._name=J},F.prototype.equals=function(J){if(!(J instanceof F)||this.pts.length!==J.pts.length)return!1;for(var D=!0,E=!0,I=this.pts.length,K=0;K<this.pts.length;K++)if(this.pts[K].equals2D(J.pts[K])||(D=!1),this.pts[K].equals2D(J.pts[--I])||(E=!1),!D&&!E)return!1;return!0},F.prototype.getCoordinate=function(){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length)return this.pts[arguments[0]]},F.prototype.print=
function(J){J.print("edge "+this._name+": ");J.print("LINESTRING (");for(var D=0;D<this.pts.length;D++)0<D&&J.print(","),J.print(this.pts[D].x+" "+this.pts[D].y);J.print(")  "+this._label+" "+this._depthDelta)},F.prototype.computeIM=function(J){F.updateIM(this._label,J)},F.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},F.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},F.prototype.getMaximumSegmentIndex=
function(){return this.pts.length-1},F.prototype.getDepthDelta=function(){return this._depthDelta},F.prototype.getNumPoints=function(){return this.pts.length},F.prototype.printReverse=function(J){J.print("edge "+this._name+": ");for(var D=this.pts.length-1;0<=D;D--)J.print(this.pts[D]+" ");J.println("")},F.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Ae(this)),this._mce},F.prototype.getEnvelope=function(){if(null===this._env){this._env=new Ka;for(var J=0;J<this.pts.length;J++)this._env.expandToInclude(this.pts[J])}return this._env},
F.prototype.addIntersection=function(J,D,E,I){var K=new ua(J.getIntersection(I));J=J.getEdgeDistance(E,I);E=D+1;E<this.pts.length&&K.equals2D(this.pts[E])&&(D=E,J=0);this.eiList.add(K,D,J)},F.prototype.toString=function(){var J=new Ed;J.append("edge "+this._name+": ");J.append("LINESTRING (");for(var D=0;D<this.pts.length;D++)0<D&&J.append(","),J.append(this.pts[D].x+" "+this.pts[D].y);return J.append(")  "+this._label+" "+this._depthDelta),J.toString()},F.prototype.isPointwiseEqual=function(J){if(this.pts.length!==
J.pts.length)return!1;for(var D=0;D<this.pts.length;D++)if(!this.pts[D].equals2D(J.pts[D]))return!1;return!0},F.prototype.setDepthDelta=function(J){this._depthDelta=J},F.prototype.getEdgeIntersectionList=function(){return this.eiList},F.prototype.addIntersections=function(J,D,E){for(var I=0;I<J.getIntersectionNum();I++)this.addIntersection(J,D,E,I)},F.prototype.interfaces_=function(){return[]},F.prototype.getClass=function(){return F},F.updateIM=function(){if(2!==arguments.length)return A.prototype.updateIM.apply(this,
arguments);var J=arguments[0],D=arguments[1];D.setAtLeastIfValid(J.getLocation(0,Ba.ON),J.getLocation(1,Ba.ON),1);J.isArea()&&(D.setAtLeastIfValid(J.getLocation(0,Ba.LEFT),J.getLocation(1,Ba.LEFT),2),D.setAtLeastIfValid(J.getLocation(0,Ba.RIGHT),J.getLocation(1,Ba.RIGHT),2))},F}(gd),Lc=function(A){this._graph=this._geomFact=this._workingNoder=this._workingPrecisionModel=null;this._edgeList=new yd;this._bufParams=A||null};Lc.prototype.setWorkingPrecisionModel=function(A){this._workingPrecisionModel=
A};Lc.prototype.insertUniqueEdge=function(A){var F=this._edgeList.findEqualEdge(A);if(null!==F){var J=F.getLabel(),D=A.getLabel();F.isPointwiseEqual(A)||(D=new Mb(A.getLabel())).flip();J.merge(D);A=Lc.depthDelta(D);A=F.getDepthDelta()+A;F.setDepthDelta(A)}else this._edgeList.add(A),A.setDepthDelta(Lc.depthDelta(A.getLabel()))};Lc.prototype.buildSubgraphs=function(A,F){var J=new Fa;for(A=A.iterator();A.hasNext();){var D=A.next(),E=D.getRightmostCoordinate();E=(new wf(J)).getDepth(E);D.computeDepth(E);
D.findResultEdges();J.add(D);F.add(D.getDirectedEdges(),D.getNodes())}};Lc.prototype.createSubgraphs=function(A){var F=new Fa;for(A=A.getNodes().iterator();A.hasNext();){var J=A.next();if(!J.isVisited()){var D=new Jc;D.create(J);F.add(D)}}return Md.sort(F,Md.reverseOrder()),F};Lc.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()};Lc.prototype.getNoder=function(A){if(null!==this._workingNoder)return this._workingNoder;var F=new Nj,J=new Te;return J.setPrecisionModel(A),
F.setSegmentIntersector(new jd(J)),F};Lc.prototype.buffer=function(A,F){var J=this._workingPrecisionModel;null===J&&(J=A.getPrecisionModel());this._geomFact=A.getFactory();var D=new Rc(J,this._bufParams);A=(new rd(A,F,D)).getCurves();if(0>=A.size())return this.createEmptyResultGeometry();this.computeNodedEdges(A,J);this._graph=new $b(new tn);this._graph.addEdges(this._edgeList.getEdges());J=this.createSubgraphs(this._graph);A=new $c(this._geomFact);this.buildSubgraphs(J,A);J=A.getPolygons();return 0>=
J.size()?this.createEmptyResultGeometry():this._geomFact.buildGeometry(J)};Lc.prototype.computeNodedEdges=function(A,F){F=this.getNoder(F);F.computeNodes(A);for(A=F.getNodedSubstrings().iterator();A.hasNext();){F=A.next();var J=F.getCoordinates();2===J.length&&J[0].equals2D(J[1])||(J=F.getData(),F=new ji(F.getCoordinates(),new Mb(J)),this.insertUniqueEdge(F))}};Lc.prototype.setNoder=function(A){this._workingNoder=A};Lc.prototype.interfaces_=function(){return[]};Lc.prototype.getClass=function(){return Lc};
Lc.depthDelta=function(A){var F=A.getLocation(0,Ba.LEFT);A=A.getLocation(0,Ba.RIGHT);return F===va.INTERIOR&&A===va.EXTERIOR?1:F===va.EXTERIOR&&A===va.INTERIOR?-1:0};Lc.convertSegStrings=function(A){for(var F=new db,J=new Fa;A.hasNext();){var D=A.next();D=F.createLineString(D.getCoordinates());J.add(D)}return F.buildGeometry(J)};var Ke=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var A=arguments[1];this._noder=
arguments[0];this._scaleFactor=A;this._offsetY=this._offsetX=0;this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){A=arguments[1];var F=arguments[2],J=arguments[3];this._noder=arguments[0];this._scaleFactor=A;this._offsetX=F;this._offsetY=J;this._isScaled=!this.isIntegerPrecision()}};Ke.prototype.rescale=function(A){if(Xa(A,mc))for(A=A.iterator();A.hasNext();){var F=A.next();this.rescale(F.getCoordinates())}else if(A instanceof Array){for(F=0;F<A.length;F++)A[F].x=A[F].x/this._scaleFactor+
this._offsetX,A[F].y=A[F].y/this._scaleFactor+this._offsetY;2===A.length&&A[0].equals2D(A[1])&&Pc.out.println(A)}};Ke.prototype.scale=function(A){if(Xa(A,mc)){var F=new Fa;for(A=A.iterator();A.hasNext();){var J=A.next();F.add(new gc(this.scale(J.getCoordinates()),J.getData()))}return F}if(A instanceof Array){F=Array(A.length).fill(null);for(J=0;J<A.length;J++)F[J]=new ua(Math.round((A[J].x-this._offsetX)*this._scaleFactor),Math.round((A[J].y-this._offsetY)*this._scaleFactor),A[J].z);return cb.removeRepeatedPoints(F)}};
Ke.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor};Ke.prototype.getNodedSubstrings=function(){var A=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(A),A};Ke.prototype.computeNodes=function(A){var F=A;this._isScaled&&(F=this.scale(A));this._noder.computeNodes(F)};Ke.prototype.interfaces_=function(){return[Ye]};Ke.prototype.getClass=function(){return Ke};var Pd=function(A){this._li=new Te;this._segStrings=A},vn={fact:{configurable:!0}};Pd.prototype.checkEndPtVertexIntersections=
function(){if(0===arguments.length)for(var A=this._segStrings.iterator();A.hasNext();){var F=A.next().getCoordinates();this.checkEndPtVertexIntersections(F[0],this._segStrings);this.checkEndPtVertexIntersections(F[F.length-1],this._segStrings)}else if(2===arguments.length)for(A=arguments[0],F=arguments[1].iterator();F.hasNext();)for(var J=F.next().getCoordinates(),D=1;D<J.length-1;D++)if(J[D].equals(A))throw new se("found endpt/interior pt intersection at index "+D+" :pt "+A);};Pd.prototype.checkInteriorIntersections=
function(){if(0===arguments.length)for(var A=this._segStrings.iterator();A.hasNext();)for(var F=A.next(),J=this._segStrings.iterator();J.hasNext();){var D=J.next();this.checkInteriorIntersections(F,D)}else if(2===arguments.length){A=arguments[0];F=arguments[1];J=A.getCoordinates();D=F.getCoordinates();for(var E=0;E<J.length-1;E++)for(var I=0;I<D.length-1;I++)this.checkInteriorIntersections(A,E,F,I)}else if(4===arguments.length){D=arguments[0];E=arguments[1];F=arguments[2];J=arguments[3];if(D===F&&
E===J)return null;A=D.getCoordinates()[E];D=D.getCoordinates()[E+1];E=F.getCoordinates()[J];F=F.getCoordinates()[J+1];if(this._li.computeIntersection(A,D,E,F),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,A,D)||this.hasInteriorIntersection(this._li,E,F)))throw new se("found non-noded intersection at "+A+"-"+D+" and "+E+"-"+F);}};Pd.prototype.checkValid=function(){this.checkEndPtVertexIntersections();this.checkInteriorIntersections();this.checkCollapses()};
Pd.prototype.checkCollapses=function(){if(0===arguments.length)for(var A=this._segStrings.iterator();A.hasNext();){var F=A.next();this.checkCollapses(F)}else if(1===arguments.length)for(A=arguments[0].getCoordinates(),F=0;F<A.length-2;F++)this.checkCollapse(A[F],A[F+1],A[F+2])};Pd.prototype.hasInteriorIntersection=function(A,F,J){for(var D=0;D<A.getIntersectionNum();D++){var E=A.getIntersection(D);if(!E.equals(F)&&!E.equals(J))return!0}return!1};Pd.prototype.checkCollapse=function(A,F,J){if(A.equals(J))throw new se("found non-noded collapse at "+
Pd.fact.createLineString([A,F,J]));};Pd.prototype.interfaces_=function(){return[]};Pd.prototype.getClass=function(){return Pd};vn.fact.get=function(){return new db};Object.defineProperties(Pd,vn);var Sc=function(A,F,J){this._maxy=this._miny=this._maxx=this._minx=this._scaleFactor=this._p1Scaled=this._p0Scaled=this._ptScaled=this._originalPt=this._pt=this._li=null;this._corner=Array(4).fill(null);this._safeEnv=null;if(this._originalPt=A,this._pt=A,this._scaleFactor=F,this._li=J,0>=F)throw new cc("Scale factor must be non-zero");
1!==F&&(this._pt=new ua(this.scale(A.x),this.scale(A.y)),this._p0Scaled=new ua,this._p1Scaled=new ua);this.initCorners(this._pt)},wn={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Sc.prototype.intersectsScaled=function(A,F){var J=Math.max(A.x,F.x),D=Math.min(A.y,F.y),E=Math.max(A.y,F.y);if(J=this._maxx<Math.min(A.x,F.x)||this._minx>J||this._maxy<D||this._miny>E)return!1;A=this.intersectsToleranceSquare(A,F);return $a.isTrue(!(J&&A),"Found bad envelope test"),A};Sc.prototype.initCorners=function(A){this._minx=
A.x-.5;this._maxx=A.x+.5;this._miny=A.y-.5;this._maxy=A.y+.5;this._corner[0]=new ua(this._maxx,this._maxy);this._corner[1]=new ua(this._minx,this._maxy);this._corner[2]=new ua(this._minx,this._miny);this._corner[3]=new ua(this._maxx,this._miny)};Sc.prototype.intersects=function(A,F){return 1===this._scaleFactor?this.intersectsScaled(A,F):(this.copyScaled(A,this._p0Scaled),this.copyScaled(F,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Sc.prototype.scale=function(A){return Math.round(A*
this._scaleFactor)};Sc.prototype.getCoordinate=function(){return this._originalPt};Sc.prototype.copyScaled=function(A,F){F.x=this.scale(A.x);F.y=this.scale(A.y)};Sc.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var A=Sc.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ka(this._originalPt.x-A,this._originalPt.x+A,this._originalPt.y-A,this._originalPt.y+A)}return this._safeEnv};Sc.prototype.intersectsPixelClosure=function(A,F){return this._li.computeIntersection(A,F,this._corner[0],
this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(A,F,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(A,F,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(A,F,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))};Sc.prototype.intersectsToleranceSquare=function(A,F){var J=!1,D=!1;return this._li.computeIntersection(A,F,this._corner[0],this._corner[1]),!!this._li.isProper()||
(this._li.computeIntersection(A,F,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(J=!0),this._li.computeIntersection(A,F,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(D=!0),this._li.computeIntersection(A,F,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!J||!D)||!!A.equals(this._pt)||!!F.equals(this._pt))))};Sc.prototype.addSnappedNode=function(A,F){var J=A.getCoordinate(F),D=A.getCoordinate(F+1);return!!this.intersects(J,
D)&&(A.addIntersection(this.getCoordinate(),F),!0)};Sc.prototype.interfaces_=function(){return[]};Sc.prototype.getClass=function(){return Sc};wn.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75};Object.defineProperties(Sc,wn);var fh=function(){this.tempEnv1=new Ka;this.selectedSegment=new Qa};fh.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))};fh.prototype.interfaces_=function(){return[]};
fh.prototype.getClass=function(){return fh};var fg=function(A){this._index=A},xn={HotPixelSnapAction:{configurable:!0}};fg.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var A=arguments[0],F=arguments[1],J=arguments[2],D=A.getSafeEnvelope(),E=new yn(A,F,J);return this._index.query(D,{interfaces_:function(){return[He]},visitItem:function(I){I.select(D,E)}}),E.isNodeAdded()}};fg.prototype.interfaces_=function(){return[]};fg.prototype.getClass=
function(){return fg};xn.HotPixelSnapAction.get=function(){return yn};Object.defineProperties(fg,xn);var yn=function(A){function F(J,D,E){A.call(this);this._isNodeAdded=!1;this._hotPixel=J;this._parentEdge=D;this._hotPixelVertexIndex=E}return A&&(F.__proto__=A),F.prototype=Object.create(A&&A.prototype),F.prototype.constructor=F,F.prototype.isNodeAdded=function(){return this._isNodeAdded},F.prototype.select=function(){if(2!==arguments.length)return A.prototype.select.apply(this,arguments);var J=arguments[1],
D=arguments[0].getContext();if(null!==this._parentEdge&&D===this._parentEdge&&J===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(D,J)},F.prototype.interfaces_=function(){return[]},F.prototype.getClass=function(){return F},F}(fh),xf=function(A){this._interiorIntersections=null;this._li=A;this._interiorIntersections=new Fa};xf.prototype.processIntersections=function(A,F,J,D){if(A===J&&F===D)return null;var E=A.getCoordinates()[F],I=A.getCoordinates()[F+1],K=J.getCoordinates()[D],
N=J.getCoordinates()[D+1];if(this._li.computeIntersection(E,I,K,N),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(E=0;E<this._li.getIntersectionNum();E++)this._interiorIntersections.add(this._li.getIntersection(E));A.addIntersections(this._li,F,0);J.addIntersections(this._li,D,1)}};xf.prototype.isDone=function(){return!1};xf.prototype.getInteriorIntersections=function(){return this._interiorIntersections};xf.prototype.interfaces_=function(){return[$e]};xf.prototype.getClass=function(){return xf};
var de=function(A){this._nodedSegStrings=this._pointSnapper=this._noder=this._scaleFactor=this._li=null;this._pm=A;this._li=new Te;this._li.setPrecisionModel(A);this._scaleFactor=A.getScale()};de.prototype.checkCorrectness=function(A){A=gc.getNodedSubstrings(A);A=new Pd(A);try{A.checkValid()}catch(F){if(!(F instanceof gn))throw F;F.printStackTrace()}};de.prototype.getNodedSubstrings=function(){return gc.getNodedSubstrings(this._nodedSegStrings)};de.prototype.snapRound=function(A,F){F=this.findInteriorIntersections(A,
F);this.computeIntersectionSnaps(F);this.computeVertexSnaps(A)};de.prototype.findInteriorIntersections=function(A,F){F=new xf(F);return this._noder.setSegmentIntersector(F),this._noder.computeNodes(A),F.getInteriorIntersections()};de.prototype.computeVertexSnaps=function(A){if(Xa(A,mc))for(A=A.iterator();A.hasNext();){var F=A.next();this.computeVertexSnaps(F)}else if(A instanceof gc){F=A.getCoordinates();for(var J=0;J<F.length;J++){var D=new Sc(F[J],this._scaleFactor,this._li);this._pointSnapper.snap(D,
A,J)&&A.addIntersection(F[J],J)}}};de.prototype.computeNodes=function(A){this._nodedSegStrings=A;this._noder=new Nj;this._pointSnapper=new fg(this._noder.getIndex());this.snapRound(A,this._li)};de.prototype.computeIntersectionSnaps=function(A){for(A=A.iterator();A.hasNext();){var F=A.next();F=new Sc(F,this._scaleFactor,this._li);this._pointSnapper.snap(F)}};de.prototype.interfaces_=function(){return[Ye]};de.prototype.getClass=function(){return de};var yc=function(){if(this._argGeom=null,this._distance=
null,this._bufParams=new Jb,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var A=arguments[1];this._argGeom=arguments[0];this._bufParams=A}},gg={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};yc.prototype.bufferFixedPrecision=function(A){var F=new Ke(new de(new Ib(1)),A.getScale()),J=new Lc(this._bufParams);J.setWorkingPrecisionModel(A);
J.setNoder(F);this._resultGeometry=J.buffer(this._argGeom,this._distance)};yc.prototype.bufferReducedPrecision=function(){if(0===arguments.length){for(var A=yc.MAX_PRECISION_DIGITS;0<=A;A--){try{this.bufferReducedPrecision(A)}catch(F){if(!(F instanceof xe))throw F;this._saveException=F}if(null!==this._resultGeometry)return null}throw this._saveException;}1===arguments.length&&(A=yc.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),A=new Ib(A),this.bufferFixedPrecision(A))};yc.prototype.computeGeometry=
function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var A=this._argGeom.getFactory().getPrecisionModel();A.getType()===Ib.FIXED?this.bufferFixedPrecision(A):this.bufferReducedPrecision()};yc.prototype.setQuadrantSegments=function(A){this._bufParams.setQuadrantSegments(A)};yc.prototype.bufferOriginalPrecision=function(){try{this._resultGeometry=(new Lc(this._bufParams)).buffer(this._argGeom,this._distance)}catch(A){if(!(A instanceof se))throw A;this._saveException=
A}};yc.prototype.getResultGeometry=function(A){return this._distance=A,this.computeGeometry(),this._resultGeometry};yc.prototype.setEndCapStyle=function(A){this._bufParams.setEndCapStyle(A)};yc.prototype.interfaces_=function(){return[]};yc.prototype.getClass=function(){return yc};yc.bufferOp=function(){if(2===arguments.length){var A=arguments[1];return(new yc(arguments[0])).getResultGeometry(A)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ua&&"number"==typeof arguments[1]){A=
arguments[1];var F=arguments[2],J=new yc(arguments[0]);J.setQuadrantSegments(F);return J.getResultGeometry(A)}if(arguments[2]instanceof Jb&&arguments[0]instanceof Ua&&"number"==typeof arguments[1])return A=arguments[1],(new yc(arguments[0],arguments[2])).getResultGeometry(A)}else if(4===arguments.length){A=arguments[1];F=arguments[2];J=arguments[3];var D=new yc(arguments[0]);D.setQuadrantSegments(F);D.setEndCapStyle(J);return D.getResultGeometry(A)}};yc.precisionScaleFactor=function(A,F,J){A=A.getEnvelopeInternal();
F=fd.max(Math.abs(A.getMaxX()),Math.abs(A.getMaxY()),Math.abs(A.getMinX()),Math.abs(A.getMinY()))+2*(0<F?F:0);return Math.pow(10,J-Math.trunc(Math.log(F)/Math.log(10)+1))};gg.CAP_ROUND.get=function(){return Jb.CAP_ROUND};gg.CAP_BUTT.get=function(){return Jb.CAP_FLAT};gg.CAP_FLAT.get=function(){return Jb.CAP_FLAT};gg.CAP_SQUARE.get=function(){return Jb.CAP_SQUARE};gg.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(yc,gg);var bd=function(){if(this._lines=null,this._isForcedToLineString=
!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var A=arguments[1];this._lines=arguments[0];this._isForcedToLineString=A}};bd.prototype.filter=function(A){if(this._isForcedToLineString&&A instanceof Zd)return A=A.getFactory().createLineString(A.getCoordinateSequence()),this._lines.add(A),null;A instanceof Ic&&this._lines.add(A)};bd.prototype.setForceToLineString=function(A){this._isForcedToLineString=A};bd.prototype.interfaces_=function(){return[te]};bd.prototype.getClass=
function(){return bd};bd.getGeometry=function(){if(1===arguments.length){var A=arguments[0];return A.getFactory().buildGeometry(bd.getLines(A))}if(2===arguments.length){A=arguments[0];var F=arguments[1];return A.getFactory().buildGeometry(bd.getLines(A,F))}};bd.getLines=function(){if(1===arguments.length)return bd.getLines(arguments[0],!1);if(2===arguments.length){if(Xa(arguments[0],mc)&&Xa(arguments[1],mc)){for(var A=arguments[1],F=arguments[0].iterator();F.hasNext();){var J=F.next();bd.getLines(J,
A)}return A}if(arguments[0]instanceof Ua&&"boolean"==typeof arguments[1])return A=arguments[0],F=arguments[1],J=new Fa,A.apply(new bd(J,F)),J;if(arguments[0]instanceof Ua&&Xa(arguments[1],mc))return A=arguments[0],F=arguments[1],A instanceof Ic?F.add(A):A.apply(new bd(F)),F}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Xa(arguments[0],mc)&&Xa(arguments[1],mc)){A=arguments[1];F=arguments[2];for(J=arguments[0].iterator();J.hasNext();){var D=J.next();bd.getLines(D,A,F)}return A}if("boolean"==
typeof arguments[2]&&arguments[0]instanceof Ua&&Xa(arguments[1],mc))return A=arguments[1],arguments[0].apply(new bd(A,arguments[2])),A}};var ee=function(){if((this._boundaryRule=nd.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length)&&1===arguments.length){var A=arguments[0];if(null===A)throw new cc("Rule must be non-null");this._boundaryRule=A}};ee.prototype.locateInternal=function(A,F){if(A instanceof ua&&F instanceof Hd){if(F.isEmpty())return va.EXTERIOR;var J=F.getExteriorRing();
J=this.locateInPolygonRing(A,J);if(J===va.EXTERIOR)return va.EXTERIOR;if(J===va.BOUNDARY)return va.BOUNDARY;for(J=0;J<F.getNumInteriorRing();J++){var D=F.getInteriorRingN(J);D=this.locateInPolygonRing(A,D);if(D===va.INTERIOR)return va.EXTERIOR;if(D===va.BOUNDARY)return va.BOUNDARY}return va.INTERIOR}if(A instanceof ua&&F instanceof Ic){if(!F.getEnvelopeInternal().intersects(A))return va.EXTERIOR;J=F.getCoordinates();return F.isClosed()||!A.equals(J[0])&&!A.equals(J[J.length-1])?Da.isOnLine(A,J)?va.INTERIOR:
va.EXTERIOR:va.BOUNDARY}if(A instanceof ua&&F instanceof Yd)return F.getCoordinate().equals2D(A)?va.INTERIOR:va.EXTERIOR};ee.prototype.locateInPolygonRing=function(A,F){return F.getEnvelopeInternal().intersects(A)?Da.locatePointInRing(A,F.getCoordinates()):va.EXTERIOR};ee.prototype.intersects=function(A,F){return this.locate(A,F)!==va.EXTERIOR};ee.prototype.updateLocationInfo=function(A){A===va.INTERIOR&&(this._isIn=!0);A===va.BOUNDARY&&this._numBoundaries++};ee.prototype.computeLocation=function(A,
F){if(F instanceof Yd&&this.updateLocationInfo(this.locateInternal(A,F)),F instanceof Ic)this.updateLocationInfo(this.locateInternal(A,F));else if(F instanceof Hd)this.updateLocationInfo(this.locateInternal(A,F));else if(F instanceof We)for(var J=0;J<F.getNumGeometries();J++){var D=F.getGeometryN(J);this.updateLocationInfo(this.locateInternal(A,D))}else if(F instanceof Ge)for(J=0;J<F.getNumGeometries();J++)D=F.getGeometryN(J),this.updateLocationInfo(this.locateInternal(A,D));else if(F instanceof wd)for(J=
new be(F);J.hasNext();)D=J.next(),D!==F&&this.computeLocation(A,D)};ee.prototype.locate=function(A,F){return F.isEmpty()?va.EXTERIOR:F instanceof Ic||F instanceof Hd?this.locateInternal(A,F):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(A,F),this._boundaryRule.isInBoundary(this._numBoundaries)?va.BOUNDARY:0<this._numBoundaries||this._isIn?va.INTERIOR:va.EXTERIOR)};ee.prototype.interfaces_=function(){return[]};ee.prototype.getClass=function(){return ee};var Qd=function(A,F){this._pts=A;
this._data=F};Qd.prototype.getCoordinates=function(){return this._pts};Qd.prototype.size=function(){return this._pts.length};Qd.prototype.getCoordinate=function(A){return this._pts[A]};Qd.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Qd.prototype.getSegmentOctant=function(A){return A===this._pts.length-1?-1:uf.octant(this.getCoordinate(A),this.getCoordinate(A+1))};Qd.prototype.setData=function(A){this._data=A};Qd.prototype.getData=function(){return this._data};
Qd.prototype.toString=function(){return re.toLineString(new jc(this._pts))};Qd.prototype.interfaces_=function(){return[ae]};Qd.prototype.getClass=function(){return Qd};var uc=function(A){this._isCheckEndSegmentsOnly=this._findAllIntersections=!1;this._intSegments=this._interiorIntersection=this._li=null;this._intersections=new Fa;this._intersectionCount=0;this._keepIntersections=!0;this._li=A;this._interiorIntersection=null};uc.prototype.getInteriorIntersection=function(){return this._interiorIntersection};
uc.prototype.setCheckEndSegmentsOnly=function(A){this._isCheckEndSegmentsOnly=A};uc.prototype.getIntersectionSegments=function(){return this._intSegments};uc.prototype.count=function(){return this._intersectionCount};uc.prototype.getIntersections=function(){return this._intersections};uc.prototype.setFindAllIntersections=function(A){this._findAllIntersections=A};uc.prototype.setKeepIntersections=function(A){this._keepIntersections=A};uc.prototype.processIntersections=function(A,F,J,D){if(!this._findAllIntersections&&
this.hasIntersection()||A===J&&F===D||this._isCheckEndSegmentsOnly&&!this.isEndSegment(A,F)&&!this.isEndSegment(J,D))return null;var E=A.getCoordinates()[F];A=A.getCoordinates()[F+1];F=J.getCoordinates()[D];J=J.getCoordinates()[D+1];this._li.computeIntersection(E,A,F,J);this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=Array(4).fill(null),this._intSegments[0]=E,this._intSegments[1]=A,this._intSegments[2]=F,this._intSegments[3]=J,this._interiorIntersection=this._li.getIntersection(0),
this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};uc.prototype.isEndSegment=function(A,F){return 0===F||F>=A.size()-2};uc.prototype.hasIntersection=function(){return null!==this._interiorIntersection};uc.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection};uc.prototype.interfaces_=function(){return[$e]};uc.prototype.getClass=function(){return uc};uc.createAllIntersectionsFinder=function(A){A=new uc(A);
return A.setFindAllIntersections(!0),A};uc.createAnyIntersectionFinder=function(A){return new uc(A)};uc.createIntersectionCounter=function(A){A=new uc(A);return A.setFindAllIntersections(!0),A.setKeepIntersections(!1),A};var zd=function(A){this._li=new Te;this._findAllIntersections=!1;this._segInt=null;this._isValid=!0;this._segStrings=A};zd.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()};zd.prototype.getIntersections=function(){return this._segInt.getIntersections()};
zd.prototype.isValid=function(){return this.execute(),this._isValid};zd.prototype.setFindAllIntersections=function(A){this._findAllIntersections=A};zd.prototype.checkInteriorIntersections=function(){this._isValid=!0;this._segInt=new uc(this._li);this._segInt.setFindAllIntersections(this._findAllIntersections);var A=new Nj;if(A.setSegmentIntersector(this._segInt),A.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};zd.prototype.checkValid=function(){if(this.execute(),
!this._isValid)throw new xe(this.getErrorMessage(),this._segInt.getInteriorIntersection());};zd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var A=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+re.toLineString(A[0],A[1])+" and "+re.toLineString(A[2],A[3])};zd.prototype.interfaces_=function(){return[]};zd.prototype.getClass=function(){return zd};zd.computeIntersections=function(A){A=new zd(A);return A.setFindAllIntersections(!0),
A.isValid(),A.getIntersections()};var bf=function J(F){this._nv=null;this._nv=new zd(J.toSegmentStrings(F))};bf.prototype.checkValid=function(){this._nv.checkValid()};bf.prototype.interfaces_=function(){return[]};bf.prototype.getClass=function(){return bf};bf.toSegmentStrings=function(F){var J=new Fa;for(F=F.iterator();F.hasNext();){var D=F.next();J.add(new Qd(D.getCoordinates(),D))}return J};bf.checkValid=function(F){(new bf(F)).checkValid()};var yf=function(F){this._mapOp=F};yf.prototype.map=function(F){for(var J=
new Fa,D=0;D<F.getNumGeometries();D++){var E=this._mapOp.map(F.getGeometryN(D));E.isEmpty()||J.add(E)}return F.getFactory().createGeometryCollection(db.toGeometryArray(J))};yf.prototype.interfaces_=function(){return[]};yf.prototype.getClass=function(){return yf};yf.map=function(F,J){return(new yf(J)).map(F)};var Rd=function(F,J,D){this._ptLocator=this._geometryFactory=this._op=null;this._lineEdgesList=new Fa;this._resultLineList=new Fa;this._op=F;this._geometryFactory=J;this._ptLocator=D};Rd.prototype.collectLines=
function(F){for(var J=this._op.getGraph().getEdgeEnds().iterator();J.hasNext();){var D=J.next();this.collectLineEdge(D,F,this._lineEdgesList);this.collectBoundaryTouchEdge(D,F,this._lineEdgesList)}};Rd.prototype.labelIsolatedLine=function(F,J){var D=this._ptLocator.locate(F.getCoordinate(),this._op.getArgGeometry(J));F.getLabel().setLocation(J,D)};Rd.prototype.build=function(F){return this.findCoveredLineEdges(),this.collectLines(F),this.buildLines(F),this._resultLineList};Rd.prototype.collectLineEdge=
function(F,J,D){var E=F.getLabel(),I=F.getEdge();F.isLineEdge()&&(F.isVisited()||!ab.isResultOfOp(E,J)||I.isCovered()||(D.add(I),F.setVisitedEdge(!0)))};Rd.prototype.findCoveredLineEdges=function(){for(var F=this._op.getGraph().getNodes().iterator();F.hasNext();)F.next().getEdges().findCoveredLineEdges();for(F=this._op.getGraph().getEdgeEnds().iterator();F.hasNext();){var J=F.next(),D=J.getEdge();J.isLineEdge()&&!D.isCoveredSet()&&(J=this._op.isCoveredByA(J.getCoordinate()),D.setCovered(J))}};Rd.prototype.labelIsolatedLines=
function(F){for(F=F.iterator();F.hasNext();){var J=F.next(),D=J.getLabel();J.isIsolated()&&(D.isNull(0)?this.labelIsolatedLine(J,0):this.labelIsolatedLine(J,1))}};Rd.prototype.buildLines=function(F){for(F=this._lineEdgesList.iterator();F.hasNext();){var J=F.next(),D=this._geometryFactory.createLineString(J.getCoordinates());this._resultLineList.add(D);J.setInResult(!0)}};Rd.prototype.collectBoundaryTouchEdge=function(F,J,D){var E=F.getLabel();return F.isLineEdge()||F.isVisited()||F.isInteriorAreaEdge()||
F.getEdge().isInResult()?null:($a.isTrue(!(F.isInResult()||F.getSym().isInResult())||!F.getEdge().isInResult()),void(ab.isResultOfOp(E,J)&&J===ab.INTERSECTION&&(D.add(F.getEdge()),F.setVisitedEdge(!0))))};Rd.prototype.interfaces_=function(){return[]};Rd.prototype.getClass=function(){return Rd};var zf=function(F,J){this._geometryFactory=this._op=null;this._resultPointList=new Fa;this._op=F;this._geometryFactory=J};zf.prototype.filterCoveredNodeToPoint=function(F){F=F.getCoordinate();this._op.isCoveredByLA(F)||
(F=this._geometryFactory.createPoint(F),this._resultPointList.add(F))};zf.prototype.extractNonCoveredResultNodes=function(F){for(var J=this._op.getGraph().getNodes().iterator();J.hasNext();){var D=J.next();if(!(D.isInResult()||D.isIncidentEdgeInResult()||0!==D.getEdges().getDegree()&&F!==ab.INTERSECTION)){var E=D.getLabel();ab.isResultOfOp(E,F)&&this.filterCoveredNodeToPoint(D)}}};zf.prototype.build=function(F){return this.extractNonCoveredResultNodes(F),this._resultPointList};zf.prototype.interfaces_=
function(){return[]};zf.prototype.getClass=function(){return zf};var Tc=function(){this._factory=this._inputGeom=null;this._preserveGeometryCollectionType=this._pruneEmptyGeometry=!0;this._preserveType=this._preserveCollections=!1};Tc.prototype.transformPoint=function(F,J){return this._factory.createPoint(this.transformCoordinates(F.getCoordinateSequence(),F))};Tc.prototype.transformPolygon=function(F,J){var D=!0;J=this.transformLinearRing(F.getExteriorRing(),F);null!==J&&J instanceof Zd&&!J.isEmpty()||
(D=!1);for(var E=new Fa,I=0;I<F.getNumInteriorRing();I++){var K=this.transformLinearRing(F.getInteriorRingN(I),F);null===K||K.isEmpty()||(K instanceof Zd||(D=!1),E.add(K))}if(D)return this._factory.createPolygon(J,E.toArray([]));F=new Fa;return null!==J&&F.add(J),F.addAll(E),this._factory.buildGeometry(F)};Tc.prototype.createCoordinateSequence=function(F){return this._factory.getCoordinateSequenceFactory().create(F)};Tc.prototype.getInputGeometry=function(){return this._inputGeom};Tc.prototype.transformMultiLineString=
function(F,J){J=new Fa;for(var D=0;D<F.getNumGeometries();D++){var E=this.transformLineString(F.getGeometryN(D),F);null!==E&&(E.isEmpty()||J.add(E))}return this._factory.buildGeometry(J)};Tc.prototype.transformCoordinates=function(F,J){return this.copy(F)};Tc.prototype.transformLineString=function(F,J){return this._factory.createLineString(this.transformCoordinates(F.getCoordinateSequence(),F))};Tc.prototype.transformMultiPoint=function(F,J){J=new Fa;for(var D=0;D<F.getNumGeometries();D++){var E=
this.transformPoint(F.getGeometryN(D),F);null!==E&&(E.isEmpty()||J.add(E))}return this._factory.buildGeometry(J)};Tc.prototype.transformMultiPolygon=function(F,J){J=new Fa;for(var D=0;D<F.getNumGeometries();D++){var E=this.transformPolygon(F.getGeometryN(D),F);null!==E&&(E.isEmpty()||J.add(E))}return this._factory.buildGeometry(J)};Tc.prototype.copy=function(F){return F.copy()};Tc.prototype.transformGeometryCollection=function(F,J){J=new Fa;for(var D=0;D<F.getNumGeometries();D++){var E=this.transform(F.getGeometryN(D));
null!==E&&(this._pruneEmptyGeometry&&E.isEmpty()||J.add(E))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(db.toGeometryArray(J)):this._factory.buildGeometry(J)};Tc.prototype.transform=function(F){if(this._inputGeom=F,this._factory=F.getFactory(),F instanceof Yd)return this.transformPoint(F,null);if(F instanceof ag)return this.transformMultiPoint(F,null);if(F instanceof Zd)return this.transformLinearRing(F,null);if(F instanceof Ic)return this.transformLineString(F,
null);if(F instanceof We)return this.transformMultiLineString(F,null);if(F instanceof Hd)return this.transformPolygon(F,null);if(F instanceof Ge)return this.transformMultiPolygon(F,null);if(F instanceof wd)return this.transformGeometryCollection(F,null);throw new cc("Unknown Geometry subtype: "+F.getClass().getName());};Tc.prototype.transformLinearRing=function(F,J){F=this.transformCoordinates(F.getCoordinateSequence(),F);if(null===F)return this._factory.createLinearRing(null);J=F.size();return 0<
J&&4>J&&!this._preserveType?this._factory.createLineString(F):this._factory.createLinearRing(F)};Tc.prototype.interfaces_=function(){return[]};Tc.prototype.getClass=function(){return Tc};var fe=function E(J,D){(this._snapTolerance=0,this._srcPts=null,this._seg=new Qa,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,J instanceof Ic&&"number"==typeof D)?E.call(this,J.getCoordinates(),D):J instanceof Array&&"number"==typeof D&&(this._srcPts=J,this._isClosed=E.isClosed(J),this._snapTolerance=
D)};fe.prototype.snapVertices=function(J,D){for(var E=this._isClosed?J.size()-1:J.size(),I=0;I<E;I++){var K=J.get(I);K=this.findSnapForVertex(K,D);null!==K&&(J.set(I,new ua(K)),0===I&&this._isClosed&&J.set(J.size()-1,new ua(K)))}};fe.prototype.findSnapForVertex=function(J,D){for(var E=0;E<D.length&&!J.equals2D(D[E]);E++)if(J.distance(D[E])<this._snapTolerance)return D[E];return null};fe.prototype.snapTo=function(J){var D=new Tg(this._srcPts);return this.snapVertices(D,J),this.snapSegments(D,J),D.toCoordinateArray()};
fe.prototype.snapSegments=function(J,D){if(0===D.length)return null;var E=D.length;D[0].equals2D(D[D.length-1])&&(E=D.length-1);for(var I=0;I<E;I++){var K=D[I],N=this.findSegmentIndexToSnap(K,J);0<=N&&J.add(N+1,new ua(K),!1)}};fe.prototype.findSegmentIndexToSnap=function(J,D){for(var E=Za.MAX_VALUE,I=-1,K=0;K<D.size()-1;K++){if(this._seg.p0=D.get(K),this._seg.p1=D.get(K+1),this._seg.p0.equals2D(J)||this._seg.p1.equals2D(J)){if(this._allowSnappingToSourceVertices)continue;return-1}var N=this._seg.distance(J);
N<this._snapTolerance&&N<E&&(E=N,I=K)}return I};fe.prototype.setAllowSnappingToSourceVertices=function(J){this._allowSnappingToSourceVertices=J};fe.prototype.interfaces_=function(){return[]};fe.prototype.getClass=function(){return fe};fe.isClosed=function(J){return!(1>=J.length)&&J[0].equals2D(J[J.length-1])};var rc=function(J){this._srcGeom=J||null},zn={SNAP_PRECISION_FACTOR:{configurable:!0}};rc.prototype.snapTo=function(J,D){J=this.extractTargetCoordinates(J);return(new An(D,J)).transform(this._srcGeom)};
rc.prototype.snapToSelf=function(J,D){var E=this.extractTargetCoordinates(this._srcGeom);E=J=(new An(J,E,!0)).transform(this._srcGeom);return D&&Xa(E,Xe)&&(E=J.buffer(0)),E};rc.prototype.computeSnapTolerance=function(J){return this.computeMinimumSegmentLength(J)/10};rc.prototype.extractTargetCoordinates=function(J){var D=new Bd;J=J.getCoordinates();for(var E=0;E<J.length;E++)D.add(J[E]);return D.toArray([].fill(null))};rc.prototype.computeMinimumSegmentLength=function(J){for(var D=Za.MAX_VALUE,E=
0;E<J.length-1;E++){var I=J[E].distance(J[E+1]);I<D&&(D=I)}return D};rc.prototype.interfaces_=function(){return[]};rc.prototype.getClass=function(){return rc};rc.snap=function(J,D,E){var I=Array(2).fill(null);J=new rc(J);I[0]=J.snapTo(D,E);D=new rc(D);return I[1]=D.snapTo(I[0],E),I};rc.computeOverlaySnapTolerance=function(){if(1===arguments.length){var J=arguments[0],D=rc.computeSizeBasedSnapTolerance(J);J=J.getPrecisionModel();J.getType()===Ib.FIXED&&(J=1/J.getScale()*2/1.415,J>D&&(D=J));return D}if(2===
arguments.length)return D=arguments[1],Math.min(rc.computeOverlaySnapTolerance(arguments[0]),rc.computeOverlaySnapTolerance(D))};rc.computeSizeBasedSnapTolerance=function(J){J=J.getEnvelopeInternal();return Math.min(J.getHeight(),J.getWidth())*rc.SNAP_PRECISION_FACTOR};rc.snapToSelf=function(J,D,E){return(new rc(J)).snapToSelf(D,E)};zn.SNAP_PRECISION_FACTOR.get=function(){return 1E-9};Object.defineProperties(rc,zn);var An=function(J){function D(E,I,K){J.call(this);this._snapTolerance=E||null;this._snapPts=
I||null;this._isSelfSnap=void 0!==K&&K}return J&&(D.__proto__=J),D.prototype=Object.create(J&&J.prototype),D.prototype.constructor=D,D.prototype.snapLine=function(E,I){E=new fe(E,this._snapTolerance);return E.setAllowSnappingToSourceVertices(this._isSelfSnap),E.snapTo(I)},D.prototype.transformCoordinates=function(E,I){E=E.toCoordinateArray();E=this.snapLine(E,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(E)},D.prototype.interfaces_=function(){return[]},D.prototype.getClass=
function(){return D},D}(Tc),Mc=function(){this._isFirst=!0;this._commonMantissaBitsCount=53;this._commonBits=0;this._commonSignExp=null};Mc.prototype.getCommon=function(){return Za.longBitsToDouble(this._commonBits)};Mc.prototype.add=function(J){J=Za.doubleToLongBits(J);return this._isFirst?(this._commonBits=J,this._commonSignExp=Mc.signExpBits(this._commonBits),this._isFirst=!1,null):Mc.signExpBits(J)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Mc.numCommonMostSigMantissaBits(this._commonBits,
J),void(this._commonBits=Mc.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))};Mc.prototype.toString=function(){if(1===arguments.length){var J=arguments[0],D=Za.longBitsToDouble(J);J="0000000000000000000000000000000000000000000000000000000000000000"+Za.toBinaryString(J);J=J.substring(J.length-64);return J.substring(0,1)+"  "+J.substring(1,12)+"(exp) "+J.substring(12)+" [ "+D+" ]"}};Mc.prototype.interfaces_=function(){return[]};Mc.prototype.getClass=function(){return Mc};Mc.getBit=
function(J,D){return 0!=(J&1<<D)?1:0};Mc.signExpBits=function(J){return J>>52};Mc.zeroLowerBits=function(J,D){return J&~((1<<D)-1)};Mc.numCommonMostSigMantissaBits=function(J,D){for(var E=0,I=52;0<=I;I--){if(Mc.getBit(J,I)!==Mc.getBit(D,I))return E;E++}return 52};var Le=function(){this._commonCoord=null;this._ccFilter=new Af},Oj={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Le.prototype.addCommonBits=function(J){var D=new Me(this._commonCoord);J.apply(D);J.geometryChanged()};
Le.prototype.removeCommonBits=function(J){if(0===this._commonCoord.x&&0===this._commonCoord.y)return J;var D=new ua(this._commonCoord);D.x=-D.x;D.y=-D.y;D=new Me(D);return J.apply(D),J.geometryChanged(),J};Le.prototype.getCommonCoordinate=function(){return this._commonCoord};Le.prototype.add=function(J){J.apply(this._ccFilter);this._commonCoord=this._ccFilter.getCommonCoordinate()};Le.prototype.interfaces_=function(){return[]};Le.prototype.getClass=function(){return Le};Oj.CommonCoordinateFilter.get=
function(){return Af};Oj.Translater.get=function(){return Me};Object.defineProperties(Le,Oj);var Af=function(){this._commonBitsX=new Mc;this._commonBitsY=new Mc};Af.prototype.filter=function(J){this._commonBitsX.add(J.x);this._commonBitsY.add(J.y)};Af.prototype.getCommonCoordinate=function(){return new ua(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Af.prototype.interfaces_=function(){return[Fe]};Af.prototype.getClass=function(){return Af};var Me=function(J){this.trans=J};Me.prototype.filter=
function(J,D){var E=J.getOrdinate(D,0)+this.trans.x,I=J.getOrdinate(D,1)+this.trans.y;J.setOrdinate(D,0,E);J.setOrdinate(D,1,I)};Me.prototype.isDone=function(){return!1};Me.prototype.isGeometryChanged=function(){return!0};Me.prototype.interfaces_=function(){return[Xd]};Me.prototype.getClass=function(){return Me};var vc=function(J,D){this._geom=Array(2).fill(null);this._cbr=this._snapTolerance=null;this._geom[0]=J;this._geom[1]=D;this.computeSnapTolerance()};vc.prototype.selfSnap=function(J){return(new rc(J)).snapTo(J,
this._snapTolerance)};vc.prototype.removeCommonBits=function(J){this._cbr=new Le;this._cbr.add(J[0]);this._cbr.add(J[1]);var D=Array(2).fill(null);return D[0]=this._cbr.removeCommonBits(J[0].copy()),D[1]=this._cbr.removeCommonBits(J[1].copy()),D};vc.prototype.prepareResult=function(J){return this._cbr.addCommonBits(J),J};vc.prototype.getResultGeometry=function(J){var D=this.snap(this._geom);J=ab.overlayOp(D[0],D[1],J);return this.prepareResult(J)};vc.prototype.checkValid=function(J){J.isValid()||
Pc.out.println("Snapped geometry is invalid")};vc.prototype.computeSnapTolerance=function(){this._snapTolerance=rc.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};vc.prototype.snap=function(J){J=this.removeCommonBits(J);return rc.snap(J[0],J[1],this._snapTolerance)};vc.prototype.interfaces_=function(){return[]};vc.prototype.getClass=function(){return vc};vc.overlayOp=function(J,D,E){return(new vc(J,D)).getResultGeometry(E)};vc.union=function(J,D){return vc.overlayOp(J,D,ab.UNION)};vc.intersection=
function(J,D){return vc.overlayOp(J,D,ab.INTERSECTION)};vc.symDifference=function(J,D){return vc.overlayOp(J,D,ab.SYMDIFFERENCE)};vc.difference=function(J,D){return vc.overlayOp(J,D,ab.DIFFERENCE)};var Uc=function(J,D){this._geom=Array(2).fill(null);this._geom[0]=J;this._geom[1]=D};Uc.prototype.getResultGeometry=function(J){var D=null,E=!1,I=null;try{D=ab.overlayOp(this._geom[0],this._geom[1],J),E=!0}catch(K){if(!(K instanceof se))throw K;I=K}if(!E)try{D=vc.overlayOp(this._geom[0],this._geom[1],J)}catch(K){throw K instanceof
se?I:K;}return D};Uc.prototype.interfaces_=function(){return[]};Uc.prototype.getClass=function(){return Uc};Uc.overlayOp=function(J,D,E){return(new Uc(J,D)).getResultGeometry(E)};Uc.union=function(J,D){return Uc.overlayOp(J,D,ab.UNION)};Uc.intersection=function(J,D){return Uc.overlayOp(J,D,ab.INTERSECTION)};Uc.symDifference=function(J,D){return Uc.overlayOp(J,D,ab.SYMDIFFERENCE)};Uc.difference=function(J,D){return Uc.overlayOp(J,D,ab.DIFFERENCE)};var gh=function(J,D){this.mce=J;this.chainIndex=D};
gh.prototype.computeIntersections=function(J,D){this.mce.computeIntersectsForChain(this.chainIndex,J.mce,J.chainIndex,D)};gh.prototype.interfaces_=function(){return[]};gh.prototype.getClass=function(){return gh};var cd=function D(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var E=arguments[0],I=arguments[1];this._eventType=D.DELETE;this._xValue=E;this._insertEvent=I}else if(3===arguments.length){E=
arguments[0];I=arguments[1];var K=arguments[2];this._eventType=D.INSERT;this._label=E;this._xValue=I;this._obj=K}},Pj={INSERT:{configurable:!0},DELETE:{configurable:!0}};cd.prototype.isDelete=function(){return this._eventType===cd.DELETE};cd.prototype.setDeleteEventIndex=function(D){this._deleteEventIndex=D};cd.prototype.getObject=function(){return this._obj};cd.prototype.compareTo=function(D){return this._xValue<D._xValue?-1:this._xValue>D._xValue?1:this._eventType<D._eventType?-1:this._eventType>
D._eventType?1:0};cd.prototype.getInsertEvent=function(){return this._insertEvent};cd.prototype.isInsert=function(){return this._eventType===cd.INSERT};cd.prototype.isSameLabel=function(D){return null!==this._label&&this._label===D._label};cd.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};cd.prototype.interfaces_=function(){return[md]};cd.prototype.getClass=function(){return cd};Pj.INSERT.get=function(){return 1};Pj.DELETE.get=function(){return 2};Object.defineProperties(cd,
Pj);var ki=function(){};ki.prototype.interfaces_=function(){return[]};ki.prototype.getClass=function(){return ki};var Ac=function(D,E,I){this._hasProperInterior=this._hasProper=this._hasIntersection=!1;this._isSelfIntersection=this._properIntersectionPoint=null;this.numTests=this._numIntersections=0;this._bdyNodes=null;this._isDoneWhenProperInt=this._isDone=!1;this._li=D;this._includeProper=E;this._recordIsolated=I};Ac.prototype.isTrivialIntersection=function(D,E,I,K){return D===I&&1===this._li.getIntersectionNum()&&
(Ac.isAdjacentSegments(E,K)||D.isClosed()&&(D=D.getNumPoints()-1,0===E&&K===D||0===K&&E===D))?!0:!1};Ac.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Ac.prototype.setIsDoneIfProperInt=function(D){this._isDoneWhenProperInt=D};Ac.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Ac.prototype.isBoundaryPointInternal=function(D,E){for(E=E.iterator();E.hasNext();){var I=E.next().getCoordinate();if(D.isIntersection(I))return!0}return!1};
Ac.prototype.hasProperIntersection=function(){return this._hasProper};Ac.prototype.hasIntersection=function(){return this._hasIntersection};Ac.prototype.isDone=function(){return this._isDone};Ac.prototype.isBoundaryPoint=function(D,E){return null!==E&&(!!this.isBoundaryPointInternal(D,E[0])||!!this.isBoundaryPointInternal(D,E[1]))};Ac.prototype.setBoundaryNodes=function(D,E){this._bdyNodes=Array(2).fill(null);this._bdyNodes[0]=D;this._bdyNodes[1]=E};Ac.prototype.addIntersections=function(D,E,I,K){if(D===
I&&E===K)return null;this.numTests++;var N=D.getCoordinates()[E],U=D.getCoordinates()[E+1],X=I.getCoordinates()[K],aa=I.getCoordinates()[K+1];this._li.computeIntersection(N,U,X,aa);this._li.hasIntersection()&&(this._recordIsolated&&(D.setIsolated(!1),I.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(D,E,I,K)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(D.addIntersections(this._li,E,0),I.addIntersections(this._li,K,1)),this._li.isProper()&&(this._properIntersectionPoint=
this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};Ac.prototype.interfaces_=function(){return[]};Ac.prototype.getClass=function(){return Ac};Ac.isAdjacentSegments=function(D,E){return 1===Math.abs(D-E)};var Gp=function(D){function E(){D.call(this);this.events=new Fa;this.nOverlaps=null}return D&&(E.__proto__=D),E.prototype=Object.create(D&&D.prototype),E.prototype.constructor=
E,E.prototype.prepareEvents=function(){Md.sort(this.events);for(var I=0;I<this.events.size();I++){var K=this.events.get(I);K.isDelete()&&K.getInsertEvent().setDeleteEventIndex(I)}},E.prototype.computeIntersections=function(){if(1===arguments.length){var I=arguments[0];this.nOverlaps=0;this.prepareEvents();for(var K=0;K<this.events.size();K++){var N=this.events.get(K);if(N.isInsert()&&this.processOverlaps(K,N.getDeleteEventIndex(),N,I),I.isDone())break}}else 3===arguments.length&&(arguments[2]instanceof
Ac&&Xa(arguments[0],ve)&&Xa(arguments[1],ve)?(I=arguments[0],K=arguments[1],N=arguments[2],this.addEdges(I,I),this.addEdges(K,K),this.computeIntersections(N)):"boolean"==typeof arguments[2]&&Xa(arguments[0],ve)&&arguments[1]instanceof Ac&&(I=arguments[0],K=arguments[1],arguments[2]?this.addEdges(I,null):this.addEdges(I),this.computeIntersections(K)))},E.prototype.addEdge=function(I,K){I=I.getMonotoneChainEdge();for(var N=I.getStartIndexes(),U=0;U<N.length-1;U++){var X=new gh(I,U);X=new cd(K,I.getMinX(U),
X);this.events.add(X);this.events.add(new cd(I.getMaxX(U),X))}},E.prototype.processOverlaps=function(I,K,N,U){for(var X=N.getObject();I<K;I++){var aa=this.events.get(I);if(aa.isInsert()){var ha=aa.getObject();N.isSameLabel(aa)||(X.computeIntersections(ha,U),this.nOverlaps++)}}},E.prototype.addEdges=function(){if(1===arguments.length)for(var I=arguments[0].iterator();I.hasNext();){var K=I.next();this.addEdge(K,K)}else if(2===arguments.length)for(I=arguments[1],K=arguments[0].iterator();K.hasNext();){var N=
K.next();this.addEdge(N,I)}},E.prototype.interfaces_=function(){return[]},E.prototype.getClass=function(){return E},E}(ki),ge=function(){this._min=Za.POSITIVE_INFINITY;this._max=Za.NEGATIVE_INFINITY},Bn={NodeComparator:{configurable:!0}};ge.prototype.getMin=function(){return this._min};ge.prototype.intersects=function(D,E){return!(this._min>E||this._max<D)};ge.prototype.getMax=function(){return this._max};ge.prototype.toString=function(){return re.toLineString(new ua(this._min,0),new ua(this._max,
0))};ge.prototype.interfaces_=function(){return[]};ge.prototype.getClass=function(){return ge};Bn.NodeComparator.get=function(){return hh};Object.defineProperties(ge,Bn);var hh=function(){};hh.prototype.compare=function(D,E){D=(D._min+D._max)/2;E=(E._min+E._max)/2;return D<E?-1:D>E?1:0};hh.prototype.interfaces_=function(){return[Rf]};hh.prototype.getClass=function(){return hh};var Hp=function(D){function E(I,K,N){D.call(this);this._min=I;this._max=K;this._item=N}return D&&(E.__proto__=D),E.prototype=
Object.create(D&&D.prototype),E.prototype.constructor=E,E.prototype.query=function(I,K,N){if(!this.intersects(I,K))return null;N.visitItem(this._item)},E.prototype.interfaces_=function(){return[]},E.prototype.getClass=function(){return E},E}(ge),Ip=function(D){function E(I,K){D.call(this);this._node1=I;this._node2=K;this.buildExtent(this._node1,this._node2)}return D&&(E.__proto__=D),E.prototype=Object.create(D&&D.prototype),E.prototype.constructor=E,E.prototype.buildExtent=function(I,K){this._min=
Math.min(I._min,K._min);this._max=Math.max(I._max,K._max)},E.prototype.query=function(I,K,N){if(!this.intersects(I,K))return null;null!==this._node1&&this._node1.query(I,K,N);null!==this._node2&&this._node2.query(I,K,N)},E.prototype.interfaces_=function(){return[]},E.prototype.getClass=function(){return E},E}(ge),he=function(){this._leaves=new Fa;this._root=null;this._level=0};he.prototype.buildTree=function(){Md.sort(this._leaves,new ge.NodeComparator);for(var D=this._leaves,E,I=new Fa;;){if(this.buildLevel(D,
I),1===I.size())return I.get(0);E=D;D=I;I=E}};he.prototype.insert=function(D,E,I){if(null!==this._root)throw Error("Index cannot be added to once it has been queried");this._leaves.add(new Hp(D,E,I))};he.prototype.query=function(D,E,I){this.init();this._root.query(D,E,I)};he.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()};he.prototype.printNode=function(D){Pc.out.println(re.toLineString(new ua(D._min,this._level),new ua(D._max,this._level)))};he.prototype.init=
function(){if(null!==this._root)return null;this.buildRoot()};he.prototype.buildLevel=function(D,E){this._level++;E.clear();for(var I=0;I<D.size();I+=2){var K=D.get(I);null===(I+1<D.size()?D.get(I):null)?E.add(K):(K=new Ip(D.get(I),D.get(I+1)),E.add(K))}};he.prototype.interfaces_=function(){return[]};he.prototype.getClass=function(){return he};var hg=function(){this._items=new Fa};hg.prototype.visitItem=function(D){this._items.add(D)};hg.prototype.getItems=function(){return this._items};hg.prototype.interfaces_=
function(){return[He]};hg.prototype.getClass=function(){return hg};var ig=function(D){this._index=null;if(!Xa(D,Xe))throw new cc("Argument must be Polygonal");this._index=new cf(D)},Qj={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};ig.prototype.locate=function(D){var E=new Gd(D),I=new jg(E);return this._index.query(D.y,D.y,I),E.getLocation()};ig.prototype.interfaces_=function(){return[eg]};ig.prototype.getClass=function(){return ig};Qj.SegmentVisitor.get=function(){return jg};
Qj.IntervalIndexedGeometry.get=function(){return cf};Object.defineProperties(ig,Qj);var jg=function(D){this._counter=D};jg.prototype.visitItem=function(D){this._counter.countSegment(D.getCoordinate(0),D.getCoordinate(1))};jg.prototype.interfaces_=function(){return[He]};jg.prototype.getClass=function(){return jg};var cf=function(D){this._index=new he;this.init(D)};cf.prototype.init=function(D){for(D=bd.getLines(D).iterator();D.hasNext();){var E=D.next().getCoordinates();this.addLine(E)}};cf.prototype.addLine=
function(D){for(var E=1;E<D.length;E++){var I=new Qa(D[E-1],D[E]);this._index.insert(Math.min(I.p0.y,I.p1.y),Math.max(I.p0.y,I.p1.y),I)}};cf.prototype.query=function(){if(2===arguments.length){var D=arguments[0],E=arguments[1],I=new hg;return this._index.query(D,E,I),I.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])};cf.prototype.interfaces_=function(){return[]};cf.prototype.getClass=function(){return cf};var ih=function(D){function E(){if(D.call(this),this._parentGeom=
null,this._lineEdgeMap=new ln,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new ee,2===arguments.length){var I=arguments[1],K=nd.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0];this._parentGeom=I;this._boundaryNodeRule=K;null!==I&&this.add(I)}else 3===arguments.length&&(I=arguments[1],K=arguments[2],this._argIndex=arguments[0],this._parentGeom=
I,this._boundaryNodeRule=K,null!==I&&this.add(I))}return D&&(E.__proto__=D),E.prototype=Object.create(D&&D.prototype),E.prototype.constructor=E,E.prototype.insertBoundaryPoint=function(I,K){K=this._nodes.addNode(K).getLabel();var N=1;K.getLocation(I,Ba.ON)===va.BOUNDARY&&N++;N=E.determineBoundary(this._boundaryNodeRule,N);K.setLocation(I,N)},E.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var I=arguments[1],
K=arguments[2],N=new Ac(arguments[0],!0,!1);N.setIsDoneIfProperInt(K);K=this.createEdgeSetIntersector();var U=this._parentGeom instanceof Zd||this._parentGeom instanceof Hd||this._parentGeom instanceof Ge;return K.computeIntersections(this._edges,N,I||!U),this.addSelfIntersectionNodes(this._argIndex),N}},E.prototype.computeSplitEdges=function(I){for(var K=this._edges.iterator();K.hasNext();)K.next().eiList.addSplitEdges(I)},E.prototype.computeEdgeIntersections=function(I,K,N){K=new Ac(K,N,!0);return K.setBoundaryNodes(this.getBoundaryNodes(),
I.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,I._edges,K),K},E.prototype.getGeometry=function(){return this._parentGeom},E.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},E.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},E.prototype.addPoint=function(I){I instanceof Yd?(I=I.getCoordinate(),this.insertPoint(this._argIndex,I,va.INTERIOR)):I instanceof ua&&this.insertPoint(this._argIndex,I,va.INTERIOR)},E.prototype.addPolygon=
function(I){this.addPolygonRing(I.getExteriorRing(),va.EXTERIOR,va.INTERIOR);for(var K=0;K<I.getNumInteriorRing();K++){var N=I.getInteriorRingN(K);this.addPolygonRing(N,va.INTERIOR,va.EXTERIOR)}},E.prototype.addEdge=function(I){this.insertEdge(I);I=I.getCoordinates();this.insertPoint(this._argIndex,I[0],va.BOUNDARY);this.insertPoint(this._argIndex,I[I.length-1],va.BOUNDARY)},E.prototype.addLineString=function(I){var K=cb.removeRepeatedPoints(I.getCoordinates());if(2>K.length)return this._hasTooFewPoints=
!0,this._invalidPoint=K[0],null;var N=new ji(K,new Mb(this._argIndex,va.INTERIOR));this._lineEdgeMap.put(I,N);this.insertEdge(N);$a.isTrue(2<=K.length,"found LineString with single point");this.insertBoundaryPoint(this._argIndex,K[0]);this.insertBoundaryPoint(this._argIndex,K[K.length-1])},E.prototype.getInvalidPoint=function(){return this._invalidPoint},E.prototype.getBoundaryPoints=function(){var I=this.getBoundaryNodes(),K=Array(I.size()).fill(null),N=0;for(I=I.iterator();I.hasNext();){var U=I.next();
K[N++]=U.getCoordinate().copy()}return K},E.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},E.prototype.addSelfIntersectionNode=function(I,K,N){if(this.isBoundaryNode(I,K))return null;N===va.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(I,K):this.insertPoint(I,K,N)},E.prototype.addPolygonRing=function(I,K,N){if(I.isEmpty())return null;var U=cb.removeRepeatedPoints(I.getCoordinates());
if(4>U.length)return this._hasTooFewPoints=!0,this._invalidPoint=U[0],null;var X=K,aa=N;Da.isCCW(U)&&(X=N,aa=K);K=new ji(U,new Mb(this._argIndex,va.BOUNDARY,X,aa));this._lineEdgeMap.put(I,K);this.insertEdge(K);this.insertPoint(this._argIndex,U[0],va.BOUNDARY)},E.prototype.insertPoint=function(I,K,N){K=this._nodes.addNode(K);var U=K.getLabel();null===U?K._label=new Mb(I,N):U.setLocation(I,N)},E.prototype.createEdgeSetIntersector=function(){return new Gp},E.prototype.addSelfIntersectionNodes=function(I){for(var K=
this._edges.iterator();K.hasNext();){var N=K.next(),U=N.getLabel().getLocation(I);for(N=N.eiList.iterator();N.hasNext();){var X=N.next();this.addSelfIntersectionNode(I,X.coord,U)}}},E.prototype.add=function(){if(1!==arguments.length)return D.prototype.add.apply(this,arguments);var I=arguments[0];if(I.isEmpty())return null;if(I instanceof Ge&&(this._useBoundaryDeterminationRule=!1),I instanceof Hd)this.addPolygon(I);else if(I instanceof Ic)this.addLineString(I);else if(I instanceof Yd)this.addPoint(I);
else{if(!(I instanceof ag||I instanceof We||I instanceof Ge||I instanceof wd))throw Error(I.getClass().getName());this.addCollection(I)}},E.prototype.addCollection=function(I){for(var K=0;K<I.getNumGeometries();K++){var N=I.getGeometryN(K);this.add(N)}},E.prototype.locate=function(I){return Xa(this._parentGeom,Xe)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new ig(this._parentGeom)),this._areaPtLocator.locate(I)):this._ptLocator.locate(I,this._parentGeom)},
E.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):D.prototype.findEdge.apply(this,arguments)},E.prototype.interfaces_=function(){return[]},E.prototype.getClass=function(){return E},E.determineBoundary=function(I,K){return I.isInBoundary(K)?va.BOUNDARY:va.INTERIOR},E}($b),kg=function(){if(this._li=new Te,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var D=arguments[0];this.setComputationPrecision(D.getPrecisionModel());this._arg=
Array(1).fill(null);this._arg[0]=new ih(0,D)}else if(2===arguments.length){D=arguments[0];var E=arguments[1],I=nd.OGC_SFS_BOUNDARY_RULE;0<=D.getPrecisionModel().compareTo(E.getPrecisionModel())?this.setComputationPrecision(D.getPrecisionModel()):this.setComputationPrecision(E.getPrecisionModel());this._arg=Array(2).fill(null);this._arg[0]=new ih(0,D,I);this._arg[1]=new ih(1,E,I)}else 3===arguments.length&&(D=arguments[0],E=arguments[1],I=arguments[2],0<=D.getPrecisionModel().compareTo(E.getPrecisionModel())?
this.setComputationPrecision(D.getPrecisionModel()):this.setComputationPrecision(E.getPrecisionModel()),this._arg=Array(2).fill(null),this._arg[0]=new ih(0,D,I),this._arg[1]=new ih(1,E,I))};kg.prototype.getArgGeometry=function(D){return this._arg[D].getGeometry()};kg.prototype.setComputationPrecision=function(D){this._resultPrecisionModel=D;this._li.setPrecisionModel(this._resultPrecisionModel)};kg.prototype.interfaces_=function(){return[]};kg.prototype.getClass=function(){return kg};var df=function(){};
df.prototype.interfaces_=function(){return[]};df.prototype.getClass=function(){return df};df.map=function(D,E){if(D instanceof Ua&&Xa(E,df.MapOp)){for(var I=new Fa,K=0;K<D.getNumGeometries();K++){var N=E.map(D.getGeometryN(K));null!==N&&I.add(N)}return D.getFactory().buildGeometry(I)}if(Xa(D,mc)&&Xa(E,df.MapOp)){I=new Fa;for(D=D.iterator();D.hasNext();)K=D.next(),K=E.map(K),null!==K&&I.add(K);return I}};df.MapOp=function(){};var ab=function(D){function E(I,K){D.call(this,I,K);this._ptLocator=new ee;
this._graph=this._resultGeom=this._geomFact=null;this._edgeList=new yd;this._resultPolyList=new Fa;this._resultLineList=new Fa;this._resultPointList=new Fa;this._graph=new $b(new tn);this._geomFact=I.getFactory()}return D&&(E.__proto__=D),E.prototype=Object.create(D&&D.prototype),E.prototype.constructor=E,E.prototype.insertUniqueEdge=function(I){var K=this._edgeList.findEqualEdge(I);if(null!==K){var N=K.getLabel(),U=I.getLabel();K.isPointwiseEqual(I)||(U=new Mb(I.getLabel())).flip();I=K.getDepth();
I.isNull()&&I.add(N);I.add(U);N.merge(U)}else this._edgeList.add(I)},E.prototype.getGraph=function(){return this._graph},E.prototype.cancelDuplicateResultEdges=function(){for(var I=this._graph.getEdgeEnds().iterator();I.hasNext();){var K=I.next(),N=K.getSym();K.isInResult()&&N.isInResult()&&(K.setInResult(!1),N.setInResult(!1))}},E.prototype.isCoveredByLA=function(I){return!!this.isCovered(I,this._resultLineList)||!!this.isCovered(I,this._resultPolyList)},E.prototype.computeGeometry=function(I,K,
N,U){var X=new Fa;return X.addAll(I),X.addAll(K),X.addAll(N),X.isEmpty()?E.createEmptyResult(U,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(X)},E.prototype.mergeSymLabels=function(){for(var I=this._graph.getNodes().iterator();I.hasNext();)I.next().getEdges().mergeSymLabels()},E.prototype.isCovered=function(I,K){for(K=K.iterator();K.hasNext();){var N=K.next();if(this._ptLocator.locate(I,N)!==va.EXTERIOR)return!0}return!1},E.prototype.replaceCollapsedEdges=
function(){for(var I=new Fa,K=this._edgeList.iterator();K.hasNext();){var N=K.next();N.isCollapsed()&&(K.remove(),I.add(N.getCollapsedEdge()))}this._edgeList.addAll(I)},E.prototype.updateNodeLabelling=function(){for(var I=this._graph.getNodes().iterator();I.hasNext();){var K=I.next(),N=K.getEdges().getLabel();K.getLabel().merge(N)}},E.prototype.getResultGeometry=function(I){return this.computeOverlay(I),this._resultGeom},E.prototype.insertUniqueEdges=function(I){for(I=I.iterator();I.hasNext();){var K=
I.next();this.insertUniqueEdge(K)}},E.prototype.computeOverlay=function(I){this.copyPoints(0);this.copyPoints(1);this._arg[0].computeSelfNodes(this._li,!1);this._arg[1].computeSelfNodes(this._li,!1);this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var K=new Fa;this._arg[0].computeSplitEdges(K);this._arg[1].computeSplitEdges(K);this.insertUniqueEdges(K);this.computeLabelsFromDepths();this.replaceCollapsedEdges();bf.checkValid(this._edgeList.getEdges());this._graph.addEdges(this._edgeList.getEdges());
this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(I);this.cancelDuplicateResultEdges();K=new $c(this._geomFact);K.add(this._graph);this._resultPolyList=K.getPolygons();this._resultLineList=(new Rd(this,this._geomFact,this._ptLocator)).build(I);this._resultPointList=(new zf(this,this._geomFact,this._ptLocator)).build(I);this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,I)},E.prototype.labelIncompleteNode=function(I,K){var N=
this._ptLocator.locate(I.getCoordinate(),this._arg[K].getGeometry());I.getLabel().setLocation(K,N)},E.prototype.copyPoints=function(I){for(var K=this._arg[I].getNodeIterator();K.hasNext();){var N=K.next();this._graph.addNode(N.getCoordinate()).setLabel(I,N.getLabel().getLocation(I))}},E.prototype.findResultAreaEdges=function(I){for(var K=this._graph.getEdgeEnds().iterator();K.hasNext();){var N=K.next(),U=N.getLabel();U.isArea()&&!N.isInteriorAreaEdge()&&E.isResultOfOp(U.getLocation(0,Ba.RIGHT),U.getLocation(1,
Ba.RIGHT),I)&&N.setInResult(!0)}},E.prototype.computeLabelsFromDepths=function(){for(var I=this._edgeList.iterator();I.hasNext();){var K=I.next(),N=K.getLabel();K=K.getDepth();if(!K.isNull()){K.normalize();for(var U=0;2>U;U++)N.isNull(U)||!N.isArea()||K.isNull(U)||(0===K.getDelta(U)?N.toLine(U):($a.isTrue(!K.isNull(U,Ba.LEFT),"depth of LEFT side has not been initialized"),N.setLocation(U,Ba.LEFT,K.getLocation(U,Ba.LEFT)),$a.isTrue(!K.isNull(U,Ba.RIGHT),"depth of RIGHT side has not been initialized"),
N.setLocation(U,Ba.RIGHT,K.getLocation(U,Ba.RIGHT))))}}},E.prototype.computeLabelling=function(){for(var I=this._graph.getNodes().iterator();I.hasNext();)I.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels();this.updateNodeLabelling()},E.prototype.labelIncompleteNodes=function(){for(var I=this._graph.getNodes().iterator();I.hasNext();){var K=I.next(),N=K.getLabel();K.isIsolated()&&(N.isNull(0)?this.labelIncompleteNode(K,0):this.labelIncompleteNode(K,1));K.getEdges().updateLabelling(N)}},
E.prototype.isCoveredByA=function(I){return!!this.isCovered(I,this._resultPolyList)},E.prototype.interfaces_=function(){return[]},E.prototype.getClass=function(){return E},E}(kg);ab.overlayOp=function(D,E,I){return(new ab(D,E)).getResultGeometry(I)};ab.intersection=function(D,E){return D.isEmpty()||E.isEmpty()?ab.createEmptyResult(ab.INTERSECTION,D,E,D.getFactory()):D.isGeometryCollection()?yf.map(D,{interfaces_:function(){return[df.MapOp]},map:function(I){return I.intersection(E)}}):(D.checkNotGeometryCollection(D),
D.checkNotGeometryCollection(E),Uc.overlayOp(D,E,ab.INTERSECTION))};ab.symDifference=function(D,E){if(D.isEmpty()||E.isEmpty()){if(D.isEmpty()&&E.isEmpty())return ab.createEmptyResult(ab.SYMDIFFERENCE,D,E,D.getFactory());if(D.isEmpty())return E.copy();if(E.isEmpty())return D.copy()}return D.checkNotGeometryCollection(D),D.checkNotGeometryCollection(E),Uc.overlayOp(D,E,ab.SYMDIFFERENCE)};ab.resultDimension=function(D,E,I){E=E.getDimension();I=I.getDimension();var K=-1;switch(D){case ab.INTERSECTION:K=
Math.min(E,I);break;case ab.UNION:K=Math.max(E,I);break;case ab.DIFFERENCE:K=E;break;case ab.SYMDIFFERENCE:K=Math.max(E,I)}return K};ab.createEmptyResult=function(D,E,I,K){var N=null;switch(ab.resultDimension(D,E,I)){case -1:N=K.createGeometryCollection([].fill(null));break;case 0:N=K.createPoint();break;case 1:N=K.createLineString();break;case 2:N=K.createPolygon()}return N};ab.difference=function(D,E){return D.isEmpty()?ab.createEmptyResult(ab.DIFFERENCE,D,E,D.getFactory()):E.isEmpty()?D.copy():
(D.checkNotGeometryCollection(D),D.checkNotGeometryCollection(E),Uc.overlayOp(D,E,ab.DIFFERENCE))};ab.isResultOfOp=function(){if(2===arguments.length){var D=arguments[0],E=arguments[1],I=D.getLocation(0);D=D.getLocation(1);return ab.isResultOfOp(I,D,E)}if(3===arguments.length){E=arguments[0];I=arguments[1];D=arguments[2];switch(E===va.BOUNDARY&&(E=va.INTERIOR),I===va.BOUNDARY&&(I=va.INTERIOR),D){case ab.INTERSECTION:return E===va.INTERIOR&&I===va.INTERIOR;case ab.UNION:return E===va.INTERIOR||I===
va.INTERIOR;case ab.DIFFERENCE:return E===va.INTERIOR&&I!==va.INTERIOR;case ab.SYMDIFFERENCE:return E===va.INTERIOR&&I!==va.INTERIOR||E!==va.INTERIOR&&I===va.INTERIOR}return!1}};ab.INTERSECTION=1;ab.UNION=2;ab.DIFFERENCE=3;ab.SYMDIFFERENCE=4;Td.prototype={constructor:Td,reset:function(){this.s=this.t=0},add:function(D){dm(li,D,this.t);dm(this,li.s,this.s);this.s?this.t+=li.t:this.s=li.t},valueOf:function(){return this.s}};var li=new Td,Rb=Math.PI,ne=Rb/2,sm=Rb/4,oe=2*Rb,Re=180/Rb,Dd=Rb/180,Gc=Math.abs,
Jp=Math.atan,Of=Math.atan2,nc=Math.cos,oc=Math.sin,Jg=Math.sqrt,wm={Feature:function(D,E){Nh(D.geometry,E)},FeatureCollection:function(D,E){D=D.features;for(var I=-1,K=D.length;++I<K;)Nh(D[I].geometry,E)}},fm={Sphere:function(D,E){E.sphere()},Point:function(D,E){D=D.coordinates;E.point(D[0],D[1],D[2])},MultiPoint:function(D,E){for(var I=D.coordinates,K=-1,N=I.length;++K<N;)D=I[K],E.point(D[0],D[1],D[2])},LineString:function(D,E){jj(D.coordinates,E,0)},MultiLineString:function(D,E){D=D.coordinates;
for(var I=-1,K=D.length;++I<K;)jj(D[I],E,0)},Polygon:function(D,E){gm(D.coordinates,E)},MultiPolygon:function(D,E){D=D.coordinates;for(var I=-1,K=D.length;++I<K;)gm(D[I],E)},GeometryCollection:function(D,E){D=D.geometries;for(var I=-1,K=D.length;++I<K;)Nh(D[I],E)}};new Td;new Td;new Td;nj.invert=nj;var oj=new Td;new Td;new Td;new Td;var lg=1/0,mi=lg,jh=-lg,ni=jh,vm={point:function(D,E){D<lg&&(lg=D);D>jh&&(jh=D);E<mi&&(mi=E);E>ni&&(ni=E)},lineStart:Ig,lineEnd:Ig,polygonStart:Ig,polygonEnd:Ig,result:function(){var D=
[[lg,mi],[jh,ni]];return jh=ni=-(mi=lg=1/0),D}};new Td;var ym=rm(function(){return!0},function(D){var E,I=NaN,K=NaN,N=NaN;return{lineStart:function(){D.lineStart();E=1},point:function(U,X){var aa=0<U?Rb:-Rb,ha=Gc(U-I);if(1E-6>Gc(ha-Rb))D.point(I,K=0<(K+X)/2?ne:-ne),D.point(N,K),D.lineEnd(),D.lineStart(),D.point(aa,K),D.point(U,K),E=0;else if(N!==aa&&ha>=Rb){1E-6>Gc(I-N)&&(I-=1E-6*N);1E-6>Gc(U-aa)&&(U-=1E-6*aa);ha=I;var da=K,ka=U,pa,ra,ma=oc(ha-ka);K=1E-6<Gc(ma)?Jp((oc(da)*(ra=nc(X))*oc(ka)-oc(X)*
(pa=nc(da))*oc(ha))/(pa*ra*ma)):(da+X)/2;D.point(N,K);D.lineEnd();D.lineStart();D.point(aa,K);E=0}D.point(I=U,K=X);N=aa},lineEnd:function(){D.lineEnd();I=K=NaN},clean:function(){return 2-E}}},function(D,E,I,K){null==D?(I*=ne,K.point(-Rb,I),K.point(0,I),K.point(Rb,I),K.point(Rb,0),K.point(Rb,-I),K.point(0,-I),K.point(-Rb,-I),K.point(-Rb,0),K.point(-Rb,I)):1E-6<Gc(D[0]-E[0])?(D=D[0]<E[0]?Rb:-Rb,I=I*D/2,K.point(-D,I),K.point(0,I),K.point(D,I)):K.point(E[0],E[1])},[-Rb,-ne]);pj.prototype={constructor:pj,
point:function(D,E){this.stream.point(D,E)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var No=nc(30*Dd),Po=tm({point:function(D,E){this.stream.point(D*Dd,E*Dd)}}),zm=function(D){return function(E,I){var K=nc(E),N=nc(I);K=D(K*N);return[K*N*oc(E),K*oc(I)]}}(function(D){return(D=em(D))&&D/oc(D)});zm.invert=function(D){return function(E,
I){var K=Jg(E*E+I*I),N=D(K),U=oc(N);N=nc(N);return[Of(E*U,K*N),Nf(K&&I*U/K)]}}(function(D){return D});a.along=function(D,E,I){void 0===I&&(I={});D=Lb(D).coordinates;for(var K=0,N=0;N<D.length&&!(E>=K&&N===D.length-1);N++){if(K>=E)return(E-=K)?(K=Be(D[N],D[N-1])-180,ke(D[N],E,K,I)):d(D[N]);K+=Ob(D[N],D[N+1],I)}return d(D[D.length-1])};a.angle=function(D,E,I,K){if(void 0===K&&(K={}),!oa(K))throw Error("options is invalid");if(!D)throw Error("startPoint is required");if(!E)throw Error("midPoint is required");
if(!I)throw Error("endPoint is required");D=W(!0!==K.mercator?Be(D,E):lf(D,E));E=W(!0!==K.mercator?Be(I,E):lf(I,E));E=Math.abs(D-E);return!0===K.explementary?360-E:E};a.applyFilter=Kh;a.area=Li;a.areaFactors=mh;a.bbox=Aa;a.bboxClip=function(D,E){var I=Lb(D),K=I.type;D="Feature"===D.type?D.properties:{};I=I.coordinates;switch(K){case "LineString":case "MultiLineString":var N=[];return"LineString"===K&&(I=[I]),I.forEach(function(U){var X=N,aa,ha,da,ka,pa=U.length,ra=Ff(U[0],E),ma=[];X||=[];for(aa=1;aa<
pa;aa++){var ta=U[aa-1];for(ha=da=Ff(ka=U[aa],E);;){if(!(ra|ha)){ma.push(ta);ha!==da?(ma.push(ka),aa<pa-1&&(X.push(ma),ma=[])):aa===pa-1&&ma.push(ka);break}if(ra&ha)break;ra?ra=Ff(ta=Ri(ta,ka,ra,E),E):ha=Ff(ka=Ri(ta,ka,ha,E),E)}ra=da}ma.length&&X.push(ma);!0}),1===N.length?t(N[0],D):C(N,D);case "Polygon":return g(al(I,E),D);case "MultiPolygon":return M(I.map(function(U){return al(U,E)}),D);default:throw Error("geometry "+K+" not supported");}};a.bboxPolygon=Ci;a.bearing=Be;a.bearingToAngle=W;a.bearingToAzimuth=
W;a.bezier=qk;a.bezierSpline=qk;a.booleanClockwise=Dh;a.booleanContains=function(D,E){D=Lb(D);E=Lb(E);var I=D.type,K=E.type,N=D.coordinates,U=E.coordinates;switch(I){case "Point":switch(K){case "Point":return Vi(N,U);default:throw Error("feature2 "+K+" geometry not supported");}case "MultiPoint":switch(K){case "Point":return function(X,aa){var ha,da=!1;for(ha=0;ha<X.coordinates.length;ha++)if(Vi(X.coordinates[ha],aa.coordinates)){da=!0;break}return da}(D,E);case "MultiPoint":return function(X,aa){var ha=
0;for(aa=aa.coordinates;ha<aa.length;ha++){for(var da=aa[ha],ka=!1,pa=0,ra=X.coordinates;pa<ra.length;pa++)if(Vi(da,ra[pa])){ka=!0;break}if(!ka)return!1}return!0}(D,E);default:throw Error("feature2 "+K+" geometry not supported");}case "LineString":switch(K){case "Point":return kd(E,D,{ignoreEndVertices:!0});case "LineString":return function(X,aa){var ha=!1,da=0;for(aa=aa.coordinates;da<aa.length;da++){var ka=aa[da];if(kd({type:"Point",coordinates:ka},X,{ignoreEndVertices:!0})&&(ha=!0),!kd({type:"Point",
coordinates:ka},X,{ignoreEndVertices:!1}))return!1}return ha}(D,E);case "MultiPoint":return function(X,aa){var ha=!1,da=0;for(aa=aa.coordinates;da<aa.length;da++){var ka=aa[da];if(kd(ka,X,{ignoreEndVertices:!0})&&(ha=!0),!kd(ka,X))return!1}return ha?!0:!1}(D,E);default:throw Error("feature2 "+K+" geometry not supported");}case "Polygon":switch(K){case "Point":return Wb(E,D,{ignoreBoundary:!0});case "LineString":return function(X,aa){var ha=!1,da=0,ka=Aa(X),pa=Aa(aa);if(!rl(ka,pa))return!1;for(;da<
aa.coordinates.length-1;da++)if(ka=aa.coordinates[da],pa=aa.coordinates[da+1],Wb({type:"Point",coordinates:[(ka[0]+pa[0])/2,(ka[1]+pa[1])/2]},X,{ignoreBoundary:!0})){ha=!0;break}return ha}(D,E);case "Polygon":return function(X,aa){if("Feature"===X.type&&null===X.geometry||"Feature"===aa.type&&null===aa.geometry)return!1;var ha=Aa(X),da=Aa(aa);if(!rl(ha,da))return!1;ha=0;for(aa=Lb(aa).coordinates;ha<aa.length;ha++){da=0;for(var ka=aa[ha];da<ka.length;da++)if(!Wb(ka[da],X))return!1}return!0}(D,E);case "MultiPoint":return function(X,
aa){var ha=0;for(aa=aa.coordinates;ha<aa.length;ha++)if(!Wb(aa[ha],X,{ignoreBoundary:!0}))return!1;return!0}(D,E);default:throw Error("feature2 "+K+" geometry not supported");}default:throw Error("feature1 "+I+" geometry not supported");}};a.booleanCrosses=function(D,E){D=Lb(D);E=Lb(E);var I=D.type,K=E.type;switch(I){case "MultiPoint":switch(K){case "LineString":return sl(D,E);case "Polygon":return ul(D,E);default:throw Error("feature2 "+K+" geometry not supported");}case "LineString":switch(K){case "MultiPoint":return sl(E,
D);case "LineString":a:{if(0<le(D,E).features.length)for(I=0;I<D.coordinates.length-1;I++)for(K=0;K<E.coordinates.length-1;K++){var N=!0;if(0!==K&&K!==E.coordinates.length-2||(N=!1),tl(D.coordinates[I],D.coordinates[I+1],E.coordinates[K],N)){D=!0;break a}}D=!1}return D;case "Polygon":return 0<le(D,Qi(E)).features.length;default:throw Error("feature2 "+K+" geometry not supported");}case "Polygon":switch(K){case "MultiPoint":return ul(E,D);case "LineString":return 0<le(E,Qi(D)).features.length;default:throw Error("feature2 "+
K+" geometry not supported");}default:throw Error("feature1 "+I+" geometry not supported");}};a.booleanDisjoint=ol;a.booleanEqual=function(D,E){return Lb(D).type===Lb(E).type&&(new Ud({precision:6})).compare(hf(D),hf(E))};a.booleanIntersects=xl;a.booleanOverlap=function(D,E){var I=Lb(D),K=Lb(E),N=I.type,U=K.type;if("MultiPoint"===N&&"MultiPoint"!==U||("LineString"===N||"MultiLineString"===N)&&"LineString"!==U&&"MultiLineString"!==U||("Polygon"===N||"MultiPolygon"===N)&&"Polygon"!==U&&"MultiPolygon"!==
U)throw Error("features must be of the same type");if("Point"===N)throw Error("Point geometry not supported");if((new Ud({precision:6})).compare(D,E))return!1;var X=0;switch(N){case "MultiPoint":for(D=0;D<I.coordinates.length;D++)for(N=0;N<K.coordinates.length;N++){U=I.coordinates[D];var aa=K.coordinates[N];if(U[0]===aa[0]&&U[1]===aa[1])return!0}return!1;case "LineString":case "MultiLineString":Q(D,function(ha){Q(E,function(da){bl(ha,da).features.length&&X++})});break;case "Polygon":case "MultiPolygon":Q(D,
function(ha){Q(E,function(da){le(ha,da).features.length&&X++})})}return 0<X};a.booleanParallel=function(D,E){if(!D)throw Error("line1 is required");if(!E)throw Error("line2 is required");if("LineString"!==zl(D,"line1"))throw Error("line1 must be a LineString");if("LineString"!==zl(E,"line2"))throw Error("line2 must be a LineString");D=kf(hf(D)).features;E=kf(hf(E)).features;for(var I=0;I<D.length;I++){var K=D[I].geometry.coordinates;if(!E[I])break;var N=E[I].geometry.coordinates;if(W(lf(K[0],K[1]))!==
W(lf(N[0],N[1])))return!1}return!0};a.booleanPointInPolygon=Wb;a.booleanPointOnLine=kd;a.booleanWithin=Mk;a.buffer=function(D,E,I){var K=(I=I||{}).units||"kilometers",N=I.steps||8;if(!D)throw Error("geojson is required");if("object"!=typeof I)throw Error("options must be an object");if("number"!=typeof N)throw Error("steps must be an number");if(void 0===E)throw Error("radius is required");if(0>=N)throw Error("steps must be greater than 0");var U=[];switch(D.type){case "GeometryCollection":return Qb(D,
function(X){(X=Th(X,E,K,N))&&U.push(X)}),z(U);case "FeatureCollection":return Ia(D,function(X){(X=Th(X,E,K,N))&&Ia(X,function(aa){aa&&U.push(aa)})}),z(U)}return Th(D,E,K,N)};a.center=wh;a.centerMean=Zi;a.centerMedian=function(D,E){if(void 0===E&&(E={}),!oa(E=E||{}))throw Error("options is invalid");var I=E.counter||10;if(!ea(I))throw Error("counter must be a number");var K=E.weight,N=Zi(D,{weight:E.weight}),U=z([]);Ia(D,function(X){var aa;U.features.push(Ne(X,{properties:{weight:null===(aa=X.properties)||
void 0===aa?void 0:aa[K]}}))});return Kl(N.geometry.coordinates,[0,0],U,{tolerance:E.tolerance,medianCandidates:[]},I)};a.centerOfMass=function K(E,I){switch(void 0===I&&(I={}),sc(E)){case "Point":return d(ia(E),I.properties);case "Polygon":var N=[];ya(E,function(Pa){N.push(Pa)});var U,X,aa,ha,da=Ne(E,{properties:I.properties}),ka=da.geometry.coordinates,pa=E=0,ra=0,ma=N.map(function(Pa){return[Pa[0]-ka[0],Pa[1]-ka[1]]});for(U=0;U<N.length-1;U++){var ta=(X=ma[U])[0];var na=X[1];X=(aa=ma[U+1])[0];
ra+=ha=ta*(aa=aa[1])-X*na;E+=(ta+X)*ha;pa+=(na+aa)*ha}if(0===ra)return da;U=1/(3*ra);return d([ka[0]+U*E,ka[1]+U*pa],I.properties);default:return(pa=bk(E))?K(pa,{properties:I.properties}):Ne(E,{properties:I.properties})}};a.centroid=Ne;a.circle=Di;a.cleanCoords=hf;a.clone=Ec;a.clusterEach=$i;a.clusterReduce=Yl;a.clusters=kp;a.clustersDbscan=function(E,I,K){void 0===K&&(K={});!0!==K.mutate&&(E=Ec(E));K.minPoints=K.minPoints||3;var N=new ep.DBSCAN,U=-1;return N.run(Nb(E),ba(I,K.units),K.minPoints,Ob).forEach(function(X){U++;
X.forEach(function(aa){aa=E.features[aa];aa.properties||(aa.properties={});aa.properties.cluster=U;aa.properties.dbscan="core"})}),N.noise.forEach(function(X){X=E.features[X];X.properties||(X.properties={});X.properties.cluster?X.properties.dbscan="edge":X.properties.dbscan="noise"}),E};a.clustersKmeans=function(E,I){void 0===I&&(I={});var K=E.features.length;I.numberOfClusters=I.numberOfClusters||Math.round(Math.sqrt(K/2));I.numberOfClusters>K&&(I.numberOfClusters=K);!0!==I.mutate&&(E=Ec(E));K=Nb(E);
var N=K.slice(0,I.numberOfClusters),U=hp(K,I.numberOfClusters,N),X={};return U.centroids.forEach(function(aa,ha){X[ha]=aa}),Ia(E,function(aa,ha){ha=U.idxs[ha];aa.properties.cluster=ha;aa.properties.centroid=X[ha]}),E};a.collect=function(E,I,K,N){var U=Wc(6);I=I.features.map(function(X){var aa;return{minX:X.geometry.coordinates[0],minY:X.geometry.coordinates[1],maxX:X.geometry.coordinates[0],maxY:X.geometry.coordinates[1],property:null===(aa=X.properties)||void 0===aa?void 0:aa[K]}});return U.load(I),
E.features.forEach(function(X){X.properties||(X.properties={});var aa=Aa(X),ha=[];U.search({minX:aa[0],minY:aa[1],maxX:aa[2],maxY:aa[3]}).forEach(function(da){Wb([da.minX,da.minY],X)&&ha.push(da.property)});X.properties[N]=ha}),E};a.collectionOf=Na;a.combine=function(E){var I={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return Ia(E,function(K){var N,U,X,aa;switch(null===(aa=K.geometry)||void 0===aa?void 0:aa.type){case "Point":I.MultiPoint.coordinates.push(K.geometry.coordinates);
I.MultiPoint.properties.push(K.properties);break;case "MultiPoint":(N=I.MultiPoint.coordinates).push.apply(N,K.geometry.coordinates);I.MultiPoint.properties.push(K.properties);break;case "LineString":I.MultiLineString.coordinates.push(K.geometry.coordinates);I.MultiLineString.properties.push(K.properties);break;case "MultiLineString":(U=I.MultiLineString.coordinates).push.apply(U,K.geometry.coordinates);I.MultiLineString.properties.push(K.properties);break;case "Polygon":I.MultiPolygon.coordinates.push(K.geometry.coordinates);
I.MultiPolygon.properties.push(K.properties);break;case "MultiPolygon":(X=I.MultiPolygon.coordinates).push.apply(X,K.geometry.coordinates),I.MultiPolygon.properties.push(K.properties)}}),z(Object.keys(I).filter(function(K){return I[K].coordinates.length}).sort().map(function(K){return b({type:K,coordinates:I[K].coordinates},{collectedProperties:I[K].properties})}))};a.concave=function(E,I){void 0===I&&(I={});var K=I.maxEdge||1/0;E=ek(function(N){var U=[],X={};return Ia(N,function(aa){if(aa.geometry){var ha=
aa.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(X,ha)||(U.push(aa),X[ha]=!0)}}),z(U)}(E));if(E.features=E.features.filter(function(N){var U=N.geometry.coordinates[0][0],X=N.geometry.coordinates[0][1],aa=N.geometry.coordinates[0][2];N=Ob(U,X,I);X=Ob(X,aa,I);U=Ob(U,aa,I);return N<=K&&X<=K&&U<=K}),1>E.features.length)return null;E=Tn(E);return 1===E.coordinates.length&&(E.coordinates=E.coordinates[0],E.type="Polygon"),b(E)};a.containsNumber=za;a.convertArea=la;a.convertDistance=
ba;a.convertLength=ba;a.convex=bk;a.coordAll=Nb;a.coordEach=ya;a.coordReduce=Ya;a.createBins=aj;a.degrees2radians=ca;a.degreesToRadians=ca;a.destination=ke;a.difference=function(E,I){var K=Lb(E);I=Lb(I);E=E.properties||{};K=De.difference(K.coordinates,I.coordinates);return 0===K.length?null:1===K.length?g(K[0],E):M(K,E)};a.dissolve=function(E,I){if(!oa(I=I||{}))throw Error("options is invalid");var K=I.propertyName;Na(E,"Polygon","dissolve");var N=[];if(!I.propertyName)return Ni(M(De.union.apply(null,
E.features.map(function(aa){return aa.geometry.coordinates}))));var U={};Ia(E,function(aa){Object.prototype.hasOwnProperty.call(U,aa.properties[K])||(U[aa.properties[K]]=[]);U[aa.properties[K]].push(aa)});E=Object.keys(U);for(I=0;I<E.length;I++){var X=M(De.union.apply(null,U[E[I]].map(function(aa){return aa.geometry.coordinates})));X.properties[K]=E[I];N.push(X)}return Ni(z(N))};a.distance=Ob;a.distanceToDegrees=P;a.distanceToRadians=T;a.distanceWeight=Ml;a.earthRadius=6371008.8;a.ellipse=Jl;a.envelope=
rk;a.explode=xh;a.factors=lh;a.feature=b;a.featureCollection=z;a.featureEach=Ia;a.featureOf=Sb;a.featureReduce=Ma;a.filterProperties=Zl;a.findPoint=Ca;a.findSegment=qa;a.flatten=Ni;a.flattenEach=eb;a.flattenReduce=Vc;a.flip=function(E,I){if(!oa(I=I||{}))throw Error("options is invalid");I=I.mutate;if(!E)throw Error("geojson is required");return!1!==I&&void 0!==I||(E=Ec(E)),ya(E,function(K){var N=K[0];K[0]=K[1];K[1]=N}),E};a.geojsonType=Ra;a.geomEach=Qb;a.geomReduce=dd;a.geometry=c;a.geometryCollection=
L;a.getCluster=Xl;a.getCoord=ia;a.getCoords=fa;a.getGeom=Lb;a.getType=sc;a.greatCircle=function(E,I,K){if("object"!=typeof(K=K||{}))throw Error("options is invalid");var N=K.properties,U=K.npoints;K=K.offset;return E=ia(E),I=ia(I),N=N||{},U=U||100,K=K||10,(new tj({x:E[0],y:E[1]},{x:I[0],y:I[1]},N)).Arc(U,{offset:K}).json()};a.helpers=So;a.hexGrid=Em;a.inside=Wb;a.interpolate=function(E,I,K){if("object"!=typeof(K=K||{}))throw Error("options is invalid");var N=K.gridType,U=K.property,X=K.weight;if(!E)throw Error("points is required");
if(Na(E,"Point","input must contain Points"),!I)throw Error("cellSize is required");if(void 0!==X&&"number"!=typeof X)throw Error("weight must be a number");U=U||"elevation";N=N||"square";X=X||1;var aa=Aa(E);switch(N){case "point":case "points":I=Pk(aa,I,K);break;case "square":case "squares":I=Fm(aa,I,K);break;case "hex":case "hexes":I=Em(aa,I,K);break;case "triangle":case "triangles":I=Gm(aa,I,K);break;default:throw Error("invalid gridType");}var ha=[];return Ia(I,function(da){var ka=0,pa=0;Ia(E,
function(ma){var ta,na=Ob("point"===N?da:Ne(da),ma,K);if(void 0!==U&&(ta=ma.properties[U]),void 0===ta&&(ta=ma.geometry.coordinates[2]),void 0===ta)throw Error("zValue is missing");0===na&&(ka=ta);ma=1/Math.pow(na,X);pa+=ma;ka+=ma*ta});var ra=Ec(da);ra.properties[U]=ka/pa;ha.push(ra)}),z(ha)};a.intersect=Kg;a.invariant=Uo;a.isNumber=ea;a.isObject=oa;a.isobands=function(E,I,K){if(!oa(K=K||{}))throw Error("options is invalid");var N=K.zProperty||"elevation",U=K.commonProperties||{},X=K.breaksProperties||
[];if(Na(E,"Point","Input must contain Points"),!I)throw Error("breaks is required");if(!Array.isArray(I))throw Error("breaks is not an Array");if(!oa(U))throw Error("commonProperties is not an Object");if(!Array.isArray(X))throw Error("breaksProperties is not an Array");K=bo(E,{zProperty:N,flip:!0});I=function(aa,ha,da){for(var ka=[],pa=1;pa<ha.length;pa++){var ra=+ha[pa-1],ma=+ha[pa],ta=io(ho(co(aa,ra,ma-ra))),na={};na.groupedRings=ta;na[da]=ra+"-"+ma;ka.push(na)}return ka}(K,I,N);return z((I=function(aa,
ha,da){da=Aa(da);var ka=da[0],pa=da[1],ra=(da[2]-da[0])/(ha[0].length-1),ma=(da[3]-da[1])/(ha.length-1),ta=function(na){na[0]=na[0]*ra+ka;na[1]=na[1]*ma+pa};return aa.forEach(function(na){na.groupedRings.forEach(function(Pa){Pa.forEach(function(Sa){Sa.forEach(ta)})})}),aa}(I,K,E)).map(function(aa,ha){if(X[ha]&&!oa(X[ha]))throw Error("Each mappedProperty is required to be an Object");ha=rj({},U,X[ha]);return ha[N]=aa[N],M(aa.groupedRings,ha)}))};a.isolines=function(E,I,K){if(!oa(K=K||{}))throw Error("options is invalid");
var N=K.zProperty||"elevation",U=K.commonProperties||{};K=K.breaksProperties||[];if(Na(E,"Point","Input must contain Points"),!I)throw Error("breaks is required");if(!Array.isArray(I))throw Error("breaks must be an Array");if(!oa(U))throw Error("commonProperties must be an Object");if(!Array.isArray(K))throw Error("breaksProperties must be an Array");var X=oh(E,{zProperty:N,flip:!0});return z(function(aa,ha,da){da=Aa(da);var ka=da[0],pa=da[1],ra=(da[2]-da[0])/(ha[0].length-1),ma=(da[3]-da[1])/(ha.length-
1),ta=function(na){na[0]=na[0]*ra+ka;na[1]=na[1]*ma+pa};return aa.forEach(function(na){ya(na,ta)}),aa}(function(aa,ha,da,ka,pa){for(var ra=[],ma=1;ma<ha.length;ma++){var ta=+ha[ma],na=rj({},ka,pa[ma]);na[da]=ta;ta=C(ef(aa,ta),na);ra.push(ta)}return ra}(X,I,N,U,K),X,E))};a.kinks=function(E){var I={type:"FeatureCollection",features:[]};if("LineString"===(E="Feature"===E.type?E.geometry:E).type)var K=[E.coordinates];else if("MultiLineString"===E.type)K=E.coordinates;else if("MultiPolygon"===E.type)K=
[].concat.apply([],E.coordinates);else{if("Polygon"!==E.type)throw Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");K=E.coordinates}return K.forEach(function(N){K.forEach(function(U){for(var X=0;X<N.length-1;X++)for(var aa=X;aa<U.length-1;aa++){if(N===U){if(1===Math.abs(X-aa))continue;if(0===X&&aa===N.length-2&&N[X][0]===N[N.length-1][0]&&N[X][1]===N[N.length-1][1])continue}var ha,da=void 0,ka=void 0,pa=void 0,ra=void 0,ma=N[X][0],ta=N[X][1],na=N[X+
1][0],Pa=N[X+1][1],Sa=U[aa][0],Vb=U[aa][1],Ta=U[aa+1][0],Yc=U[aa+1][1],hc={x:null,y:null,onLine1:!1,onLine2:!1};(ha=0===(ra=(Yc-Vb)*(na-ma)-(Ta-Sa)*(Pa-ta))?null!==hc.x&&null!==hc.y&&hc:(da=(na-ma)*(pa=ta-Vb)-(Pa-ta)*(ka=ma-Sa),pa=((Ta-Sa)*pa-(Yc-Vb)*ka)/ra,ka=da/ra,hc.x=ma+pa*(na-ma),hc.y=ta+pa*(Pa-ta),0<=pa&&1>=pa&&(hc.onLine1=!0),0<=ka&&1>=ka&&(hc.onLine2=!0),!(!hc.onLine1||!hc.onLine2)&&[hc.x,hc.y]))&&I.features.push(d([ha[0],ha[1]]))}})}),I};a.length=Mi;a.lengthToDegrees=P;a.lengthToRadians=
T;a.lineArc=Vk;a.lineChunk=function(E,I,K){if(!oa(K=K||{}))throw Error("options is invalid");var N=K.units,U=K.reverse;if(!E)throw Error("geojson is required");if(0>=I)throw Error("segmentLength must be greater than 0");var X=[];return eb(E,function(aa){U&&(aa.geometry.coordinates=aa.geometry.coordinates.reverse());(function(ha,da,ka,pa){var ra=Mi(ha,{units:ka});if(ra<=da)return pa(ha);ra/=da;Number.isInteger(ra)||(ra=Math.floor(ra)+1);for(var ma=0;ma<ra;ma++)pa(Lk(ha,da*ma,da*(ma+1),{units:ka}),
ma)})(aa,I,N,function(ha){X.push(ha)})}),z(X)};a.lineDistance=Mi;a.lineEach=V;a.lineIntersect=le;a.lineOffset=function(E,I,K){if(!oa(K=K||{}))throw Error("options is invalid");var N=K.units;if(!E)throw Error("geojson is required");if(null==I||isNaN(I))throw Error("distance is required");K=sc(E);var U=E.properties;switch(K){case "LineString":return ml(E,I,N);case "MultiLineString":var X=[];return eb(E,function(aa){X.push(ml(aa,I,N).geometry.coordinates)}),C(X,U);default:throw Error("geometry "+K+" is not supported");
}};a.lineOverlap=bl;a.lineReduce=ja;a.lineSegment=kf;a.lineSlice=function(E,I,K){var N=fa(K);if("LineString"!==sc(K))throw Error("line must be a LineString");E=Ce(K,E);I=Ce(K,I);E=[(I=E.properties.index<=I.properties.index?[E,I]:[I,E])[0].geometry.coordinates];for(var U=I[0].properties.index+1;U<I[1].properties.index+1;U++)E.push(N[U]);return E.push(I[1].geometry.coordinates),t(E,K.properties)};a.lineSliceAlong=Lk;a.lineSplit=function(E,I){if(!E)throw Error("line is required");if(!I)throw Error("splitter is required");
var K=sc(E),N=sc(I);if("LineString"!==K)throw Error("line must be LineString");if("FeatureCollection"===N)throw Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===N)throw Error("splitter cannot be a GeometryCollection");I=Qk(I,{precision:7});switch(N){case "Point":return Oi(E,I);case "MultiPoint":return Tk(E,I);case "LineString":case "MultiLineString":case "Polygon":case "MultiPolygon":return Tk(E,le(E,I))}};a.lineString=t;a.lineStringToPolygon=Yk;a.lineStrings=w;a.lineToPolygon=
Yk;a.mask=function(E,I){var K=g(I&&I.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]);I=null;return"FeatureCollection"===E.type?I=M(2===E.features.length?De.union(E.features[0].geometry.coordinates,E.features[1].geometry.coordinates):De.union.apply(De,E.features.map(function(N){return N.geometry.coordinates}))):I=M(De.union(E.geometry.coordinates)),I.geometry.coordinates.forEach(function(N){K.geometry.coordinates.push(N[0])}),K};a.meta=To;a.midpoint=function(E,I){return ke(E,
Ob(E,I)/2,Be(E,I))};a.moranIndex=function(E,I){var K=I.inputField,N=Ml(E,{alpha:I.alpha||-1,binary:I.binary||!1,p:I.p||2,standardization:I.standardization||!0,threshold:I.threshold||1E5}),U=[];Ia(E,function(ta){U.push((ta.properties||{})[K])});for(var X=Nl(U),aa=function(ta){for(var na=Nl(ta),Pa=0,Sa=0;Sa<ta.length;Sa++)Pa+=Math.pow(ta[Sa]-na,2);return Pa/ta.length}(U),ha=0,da=I=E=0,ka=N.length,pa=0;pa<ka;pa++){for(var ra=0,ma=0;ma<ka;ma++)ha+=N[pa][ma]*(U[pa]-X)*(U[ma]-X),E+=N[pa][ma],I+=Math.pow(N[pa][ma]+
N[ma][pa],2),ra+=N[pa][ma]+N[ma][pa];da+=Math.pow(ra,2)}N=ha/E/aa;X=-1/(ka-1);aa=(ka*ka*(I*=.5)-ka*da+E*E*3)/((ka-1)*(ka+1)*E*E)-X*X;E=Math.sqrt(aa);return{expectedMoranIndex:X,moranIndex:N,stdNorm:E,zNorm:(N-X)/E}};a.multiLineString=C;a.multiPoint=H;a.multiPolygon=M;a.nearest=zh;a.nearestPoint=zh;a.nearestPointOnLine=Ce;a.nearestPointToLine=function(E,I,K){void 0===K&&(K={});var N=K.units;K=K.properties||{};E=function(aa){var ha=[];switch(aa.geometry?aa.geometry.type:aa.type){case "GeometryCollection":return Qb(aa,
function(da){"Point"===da.type&&ha.push({type:"Feature",properties:{},geometry:da})}),{type:"FeatureCollection",features:ha};case "FeatureCollection":return aa.features=aa.features.filter(function(da){return"Point"===da.geometry.type}),aa;default:throw Error("points must be a Point Collection");}}(E);if(!E.features.length)throw Error("points must contain features");if(!I)throw Error("line is required");if("LineString"!==sc(I))throw Error("line must be a LineString");var U=1/0,X=null;return Ia(E,function(aa){var ha=
Gk(aa,I,{units:N});ha<U&&(U=ha,X=aa)}),X&&(X.properties=rj({dist:U},X.properties,K)),X};a.planepoint=function(E,I){var K=ia(E);E=Lb(I).coordinates[0];if(4>E.length)throw Error("OuterRing of a Polygon must have 4 or more Positions.");I=I.properties||{};var N=I.a,U=I.b,X=I.c;I=K[0];K=K[1];var aa=E[0][0],ha=E[0][1];N=void 0!==N?N:E[0][2];var da=E[1][0],ka=E[1][1];U=void 0!==U?U:E[1][2];var pa=E[2][0],ra=E[2][1];E=void 0!==X?X:E[2][2];return(E*(I-aa)*(K-ka)+N*(I-da)*(K-ra)+U*(I-pa)*(K-ha)-U*(I-aa)*(K-
ra)-E*(I-da)*(K-ha)-N*(I-pa)*(K-ka))/((I-aa)*(K-ka)+(I-da)*(K-ra)+(I-pa)*(K-ha)-(I-aa)*(K-ra)-(I-da)*(K-ha)-(I-pa)*(K-ka))};a.point=d;a.pointGrid=Pk;a.pointOnFeature=Hk;a.pointOnLine=Ce;a.pointOnSurface=Hk;a.pointToLineDistance=Gk;a.points=e;a.pointsWithinPolygon=ti;a.polygon=g;a.polygonSmooth=function(E,I){var K=[],N=I.iterations||1;if(!E)throw Error("inputPolys is required");return Qb(E,function(U,X,aa){switch(U.type){case "Polygon":X=[[]];for(var ha=0;ha<N;ha++){var da=[[]];var ka=U;0<ha&&(ka=
g(X).geometry);Ao(ka,da);X=da.slice(0)}K.push(g(X,aa));break;case "MultiPolygon":X=[[[]]];for(ha=0;ha<N;ha++)da=[[[]]],ka=U,0<ha&&(ka=M(X).geometry),Bo(ka,da),X=da.slice(0);K.push(M(X,aa));break;default:throw Error("geometry is invalid, must be Polygon or MultiPolygon");}}),z(K)};a.polygonTangents=function(E,I){var K=fa(E),N=fa(I),U=Aa(I),X=0,aa=null;switch(K[0]>U[0]&&K[0]<U[2]&&K[1]>U[1]&&K[1]<U[3]&&(X=(aa=zh(E,xh(I))).properties.featureIndex),sc(I)){case "Polygon":var ha=N[0][X];var da=N[0][0];
null!==aa&&aa.geometry.coordinates[1]<K[1]&&(da=N[0][X]);var ka=Ag(N[0][0],N[0][N[0].length-1],K);N=fl(N[0],K,ka,void 0,ha,da);ha=N[0];da=N[1];break;case "MultiPolygon":for(aa=U=I=E=0;aa<N[0].length;aa++){E=aa;for(var pa=!1,ra=0;ra<N[0][aa].length;ra++){if(I=ra,U===X){pa=!0;break}U++}if(pa)break}ha=N[0][E][I];da=N[0][E][I];ka=Ag(N[0][0][0],N[0][0][N[0][0].length-1],K);N.forEach(function(ma){ma=fl(ma[0],K,ka,void 0,ha,da);ha=ma[0];da=ma[1]})}return z([d(ha),d(da)])};a.polygonToLine=zg;a.polygonToLineString=
zg;a.polygonize=function(E){E=ap.fromGeoJson(E);E.deleteDangles();E.deleteCutEdges();var I=[],K=[];return E.getEdgeRings().filter(function(N){return N.isValid()}).forEach(function(N){N.isHole()?I.push(N):K.push(N)}),I.forEach(function(N){Tm.findEdgeRingContaining(N,K)&&K.push(N)}),z(K.map(function(N){return N.toPolygon()}))};a.polygons=n;a.projection=ip;a.propEach=Ja;a.propReduce=ac;a.propertiesContainsFilter=bj;a.radians2degrees=Z;a.radiansToDegrees=Z;a.radiansToDistance=S;a.radiansToLength=S;a.random=
jp;a.randomLineString=Wl;a.randomPoint=Ul;a.randomPolygon=Vl;a.randomPosition=Gg;a.rewind=function(E,I){if(!oa(I=I||{}))throw Error("options is invalid");var K=I.reverse||!1;I=I.mutate||!1;if(!E)throw Error("<geojson> is required");if("boolean"!=typeof K)throw Error("<reverse> must be a boolean");if("boolean"!=typeof I)throw Error("<mutate> must be a boolean");!1===I&&(E=Ec(E));var N=[];switch(E.type){case "GeometryCollection":return Qb(E,function(U){Eh(U,K)}),E;case "FeatureCollection":return Ia(E,
function(U){Ia(Eh(U,K),function(X){N.push(X)})}),z(N)}return Eh(E,K)};a.rhumbBearing=lf;a.rhumbDestination=Hf;a.rhumbDistance=Bh;a.round=O;a.sample=function(E,I){if(!E)throw Error("featurecollection is required");if(null==I)throw Error("num is required");if("number"!=typeof I)throw Error("num must be a number");var K=E.features,N;E=K.slice(0);K=K.length;for(var U=K-I;K-- >U;)I=E[N=Math.floor((K+1)*Math.random())],E[N]=E[K],E[K]=I;E=E.slice(U);return z(E)};a.sector=function(E,I,K,N,U){if(!oa(U=U||
{}))throw Error("options is invalid");var X=U.properties;if(!E)throw Error("center is required");if(null==K)throw Error("bearing1 is required");if(null==N)throw Error("bearing2 is required");if(!I)throw Error("radius is required");if("object"!=typeof U)throw Error("options must be an object");if(dl(K)===dl(N))return Di(E,I,U);var aa=fa(E);E=Vk(E,I,K,N,U);var ha=[[aa]];return ya(E,function(da){ha[0].push(da)}),ha[0].push(aa),g(ha,X)};a.segmentEach=Q;a.segmentReduce=R;a.shortestPath=function(E,I,K){if(!oa(K=
K||{}))throw Error("options is invalid");var N=K.resolution,U=K.minDistance,X=K.obstacles||z([]);if(!E)throw Error("start is required");if(!I)throw Error("end is required");if(N&&!ea(N)||0>=N)throw Error("options.resolution must be a number, greater than 0");if(U)throw Error("options.minDistance is not yet implemented");U=ia(E);var aa=ia(I);switch(E=d(U),I=d(aa),sc(X)){case "FeatureCollection":if(0===X.features.length)return t([U,aa]);break;case "Polygon":X=z([b(Lb(X))]);break;default:throw Error("invalid obstacles");
}var ha=X;ha.features.push(E);ha.features.push(I);var da=Aa(kl(Ci(Aa(ha)),1.15));N||=Ob([da[0],da[1]],[da[2],da[1]],K)/100;ha.features.pop();ha.features.pop();ha=da[0];var ka=da[1],pa=da[2],ra=da[3];da=N/Ob([ha,ka],[pa,ka],K)*(pa-ha);K=N/Ob([ha,ka],[ha,ra],K)*(ra-ka);N=pa-ha;var ma=ra-ka,ta=(N-Math.floor(N/da)*da)/2,na=[],Pa=[];N=[];var Sa=[],Vb=1/0,Ta=1/0;ra-=(ma-Math.floor(ma/K)*K)/2;for(ma=0;ra>=ka;){for(var Yc=[],hc=[],pc=ha+ta,ec=0;pc<=pa;){var ic=d([pc,ra]),Hc=no(ic,X);Yc.push(Hc?0:1);hc.push(pc+
"|"+ra);var Qf=Ob(ic,E);!Hc&&Qf<Vb&&(Vb=Qf,N={x:ec,y:ma});ic=Ob(ic,I);!Hc&&ic<Ta&&(Ta=ic,Sa={x:ec,y:ma});pc+=da;ec++}Pa.push(Yc);na.push(hc);ra-=K;ma++}E=new If(Pa,{diagonal:!0});E=Vh.search(E,E.grid[N.y][N.x],E.grid[Sa.y][Sa.x]);var Qe=[U];return E.forEach(function(kh){kh=na[kh.x][kh.y].split("|");Qe.push([+kh[0],+kh[1]])}),Qe.push(aa),hf(t(Qe))};a.simplify=function(E,I){if(!oa(I=I||{}))throw Error("options is invalid");var K=void 0!==I.tolerance?I.tolerance:1,N=I.highQuality||!1;I=I.mutate||!1;
if(!E)throw Error("geojson is required");if(K&&0>K)throw Error("invalid tolerance");return!0!==I&&(E=Ec(E)),Qb(E,function(U){!function(X,aa,ha){var da=X.type;if("Point"===da||"MultiPoint"===da)return X;hf(X,!0);var ka=X.coordinates;switch(da){case "LineString":X.coordinates=ok(ka,aa,ha);break;case "MultiLineString":X.coordinates=ka.map(function(pa){return ok(pa,aa,ha)});break;case "Polygon":X.coordinates=pk(ka,aa,ha);break;case "MultiPolygon":X.coordinates=ka.map(function(pa){return pk(pa,aa,ha)})}}(U,
K,N)}),E};a.square=sk;a.squareGrid=Fm;a.standardDeviationalEllipse=function(E,I){if(!oa(I=I||{}))throw Error("options is invalid");var K=I.steps||64,N=I.weight,U=I.properties||{};if(!ea(K))throw Error("steps must be a number");if(!oa(U))throw Error("properties must be a number");I=Nb(E).length;var X=Zi(E,{weight:N}),aa=0,ha=0,da=0;Ia(E,function(Sa){var Vb=Sa.properties[N]||1;Sa=Ll(fa(Sa),fa(X));aa+=Math.pow(Sa.x,2)*Vb;ha+=Math.pow(Sa.y,2)*Vb;da+=Sa.x*Sa.y*Vb});var ka=aa-ha,pa=Math.atan((ka+Math.sqrt(Math.pow(ka,
2)+4*Math.pow(da,2)))/(2*da));ka=180*pa/Math.PI;var ra=0,ma=0,ta=0;Ia(E,function(Sa){var Vb=Sa.properties[N]||1;Sa=Ll(fa(Sa),fa(X));ra+=Math.pow(Sa.x*Math.cos(pa)-Sa.y*Math.sin(pa),2)*Vb;ma+=Math.pow(Sa.x*Math.sin(pa)+Sa.y*Math.cos(pa),2)*Vb;ta+=Vb});var na=Math.sqrt(2*ra/ta),Pa=Math.sqrt(2*ma/ta);K=Jl(X,na,Pa,{units:"degrees",angle:ka,steps:K,properties:U});E=ti(E,z([K]));E={meanCenterCoordinates:fa(X),semiMajorAxis:na,semiMinorAxis:Pa,numberOfFeatures:I,angle:ka,percentageWithinEllipse:100*Nb(E).length/
I};return K.properties.standardDeviationalEllipse=E,K};a.tag=function(E,I,K,N){return E=Ec(E),I=Ec(I),Ia(E,function(U){U.properties||(U.properties={});Ia(I,function(X){void 0===U.properties[N]&&Wb(U,X)&&(U.properties[N]=X.properties[K])})}),E};a.tesselate=function(E){if(!E.geometry||"Polygon"!==E.geometry.type&&"MultiPolygon"!==E.geometry.type)throw Error("input must be a Polygon or MultiPolygon");var I={type:"FeatureCollection",features:[]};return"Polygon"===E.geometry.type?I.features=xk(E.geometry.coordinates):
E.geometry.coordinates.forEach(function(K){I.features=I.features.concat(xk(K))}),I};a.tin=ek;a.toMercator=Ol;a.toWgs84=Ql;a.transformRotate=jl;a.transformScale=kl;a.transformTranslate=function(E,I,K,N){if(!oa(N=N||{}))throw Error("options is invalid");var U=N.units,X=N.zTranslation;N=N.mutate;if(!E)throw Error("geojson is required");if(null==I||isNaN(I))throw Error("distance is required");if(X&&"number"!=typeof X&&isNaN(X))throw Error("zTranslation is not a number");if(X=void 0!==X?X:0,0===I&&0===
X)return E;if(null==K||isNaN(K))throw Error("direction is required");return 0>I&&(I=-I,K+=180),!1!==N&&void 0!==N||(E=Ec(E)),ya(E,function(aa){var ha=fa(Hf(aa,I,K,{units:U}));aa[0]=ha[0];aa[1]=ha[1];X&&3===aa.length&&(aa[2]+=X)}),E};a.triangleGrid=Gm;a.truncate=Qk;a.union=function(E,I,K){void 0===K&&(K={});E=Lb(E);I=Lb(I);I=De.union(E.coordinates,I.coordinates);return 0===I.length?null:1===I.length?g(I[0],K.properties):M(I,K.properties)};a.unitsFactors=Hm;a.unkinkPolygon=function(E){var I=[];return eb(E,
function(K){"Polygon"===K.geometry.type&&Ia($n(K),function(N){I.push(g(N.geometry.coordinates,K.properties))})}),z(I)};a.validateBBox=sa;a.validateId=xa;a.voronoi=function(E,I){if(!oa(I=I||{}))throw Error("options is invalid");I=I.bbox||[-180,-85,180,85];if(!E)throw Error("points is required");if(!Array.isArray(I))throw Error("bbox is invalid");return Na(E,"Point","points"),z(function(){function K(aa){return new Yi(aa.map(function(ha,da){var ka=[Math.round(N(ha,da,aa)/Yb)*Yb,Math.round(U(ha,da,aa)/
Yb)*Yb];return ka.index=da,ka.data=ha,ka}),X)}var N=oo,U=po,X=null;return K.polygons=function(aa){return K(aa).polygons()},K.links=function(aa){return K(aa).links()},K.triangles=function(aa){return K(aa).triangles()},K.x=function(aa){return arguments.length?(N="function"==typeof aa?aa:Cl(+aa),K):N},K.y=function(aa){return arguments.length?(U="function"==typeof aa?aa:Cl(+aa),K):U},K.extent=function(aa){return arguments.length?(X=null==aa?null:[[+aa[0][0],+aa[0][1]],[+aa[1][0],+aa[1][1]]],K):X&&[[X[0][0],
X[0][1]],[X[1][0],X[1][1]]]},K.size=function(aa){return arguments.length?(X=null==aa?null:[[0,0],[+aa[0],+aa[1]]],K):X&&[X[1][0]-X[0][0],X[1][1]-X[0][1]]},K}().x(function(K){return K.geometry.coordinates[0]}).y(function(K){return K.geometry.coordinates[1]}).extent([[I[0],I[1]],[I[2],I[3]]]).polygons(E.features).map(zo))};a.within=ti;Object.defineProperty(a,"__esModule",{value:!0})});var module$libs$turf_min={};class Queue$$module$libs$polylabel{constructor(a=[],b=defaultCompare$$module$libs$polylabel){this.data=a;this.length=this.data.length;this.compare=b;if(0<this.length)for(a=(this.length>>1)-1;0<=a;a--)this._down(a)}push(a){this.data.push(a);this._up(this.length++)}pop(){if(0!==this.length){var a=this.data[0],b=this.data.pop();0<--this.length&&(this.data[0]=b,this._down(0));return a}}peek(){return this.data[0]}_up(a){const {data:b,compare:c}=this,d=b[a];for(;0<a;){const e=a-1>>1,g=b[e];if(0<=c(d,g))break;
b[a]=g;a=e}b[a]=d}_down(a){const {data:b,compare:c}=this,d=this.length>>1,e=b[a];for(;a<d;){let g=(a<<1)+1;const n=g+1;n<this.length&&0>c(b[n],b[g])&&(g=n);if(0<=c(b[g],e))break;b[a]=b[g];a=g}b[a]=e}}function defaultCompare$$module$libs$polylabel(a,b){return a<b?-1:a>b?1:0}
function polylabel$$module$libs$polylabel(a,b,c){b=b||1;for(var d,e,g,n,t=0;t<a[0].length;t++){var w=a[0][t];if(!t||w[0]<d)d=w[0];if(!t||w[1]<e)e=w[1];if(!t||w[0]>g)g=w[0];if(!t||w[1]>n)n=w[1]}var z=g-d,C=n-e,H=Math.min(z,C);w=H/2;if(0===H)return a=[d,e],a.distance=0,a;t=new Queue$$module$libs$polylabel(void 0,compareMax$$module$libs$polylabel);for(var M=d;M<g;M+=H)for(var L=e;L<n;L+=H)t.push(new Cell$$module$libs$polylabel(M+w,L+w,w,a));g=getCentroidCell$$module$libs$polylabel(a);d=new Cell$$module$libs$polylabel(d+
z/2,e+C/2,0,a);d.d>g.d&&(g=d);for(d=t.length;t.length;)e=t.pop(),e.d>g.d&&(g=e,c&&console.log("found best %f after %d probes",Math.round(1E4*e.d)/1E4,d)),e.max-g.d<=b||(w=e.h/2,t.push(new Cell$$module$libs$polylabel(e.x-w,e.y-w,w,a)),t.push(new Cell$$module$libs$polylabel(e.x+w,e.y-w,w,a)),t.push(new Cell$$module$libs$polylabel(e.x-w,e.y+w,w,a)),t.push(new Cell$$module$libs$polylabel(e.x+w,e.y+w,w,a)),d+=4);c&&(console.log("num probes: "+d),console.log("best distance: "+g.d));a=[g.x,g.y];a.distance=
g.d;return a}function compareMax$$module$libs$polylabel(a,b){return b.max-a.max}function Cell$$module$libs$polylabel(a,b,c,d){this.x=a;this.y=b;this.h=c;this.d=pointToPolygonDist$$module$libs$polylabel(a,b,d);this.max=this.d+this.h*Math.SQRT2}
function pointToPolygonDist$$module$libs$polylabel(a,b,c){for(var d=!1,e=Infinity,g=0;g<c.length;g++)for(var n=c[g],t=0,w=n.length,z=w-1;t<w;z=t++){var C=n[t];z=n[z];C[1]>b!==z[1]>b&&a<(z[0]-C[0])*(b-C[1])/(z[1]-C[1])+C[0]&&(d=!d);e=Math.min(e,getSegDistSq$$module$libs$polylabel(a,b,C,z))}return 0===e?0:(d?1:-1)*Math.sqrt(e)}
function getCentroidCell$$module$libs$polylabel(a){for(var b=0,c=0,d=0,e=a[0],g=0,n=e.length,t=n-1;g<n;t=g++){var w=e[g];t=e[t];var z=w[0]*t[1]-t[0]*w[1];c+=(w[0]+t[0])*z;d+=(w[1]+t[1])*z;b+=3*z}return 0===b?new Cell$$module$libs$polylabel(e[0][0],e[0][1],0,a):new Cell$$module$libs$polylabel(c/b,d/b,0,a)}
function getSegDistSq$$module$libs$polylabel(a,b,c,d){var e=c[0];c=c[1];var g=d[0]-e,n=d[1]-c;if(0!==g||0!==n){var t=((a-e)*g+(b-c)*n)/(g*g+n*n);1<t?(e=d[0],c=d[1]):0<t&&(e+=g*t,c+=n*t)}g=a-e;n=b-c;return g*g+n*n}var module$libs$polylabel={};module$libs$polylabel.polylabel=polylabel$$module$libs$polylabel;var t$$module$libs$hooks_module,r$$module$libs$hooks_module,u$$module$libs$hooks_module,i$$module$libs$hooks_module,o$$module$libs$hooks_module=0,f$$module$libs$hooks_module=[],c$$module$libs$hooks_module=[],e$$module$libs$hooks_module=l$$module$libs$preact.__b,a$$module$libs$hooks_module=l$$module$libs$preact.__r,v$$module$libs$hooks_module=l$$module$libs$preact.diffed,l$$module$libs$hooks_module=l$$module$libs$preact.__c,m$$module$libs$hooks_module=l$$module$libs$preact.unmount;
function d$$module$libs$hooks_module(a,b){l$$module$libs$preact.__h&&l$$module$libs$preact.__h(r$$module$libs$hooks_module,a,o$$module$libs$hooks_module||b);o$$module$libs$hooks_module=0;b=r$$module$libs$hooks_module.__H||(r$$module$libs$hooks_module.__H={__:[],__h:[]});return a>=b.__.length&&b.__.push({__V:c$$module$libs$hooks_module}),b.__[a]}function h$$module$libs$hooks_module(a){return o$$module$libs$hooks_module=1,s$$module$libs$hooks_module(B$$module$libs$hooks_module,a)}
function s$$module$libs$hooks_module(a,b,c){var d=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,2);if(d.t=a,!d.__c&&(d.__=[c?c(b):B$$module$libs$hooks_module(void 0,b),function(t){var w=d.__N?d.__N[0]:d.__[0];t=d.t(w,t);w!==t&&(d.__N=[t,d.__[1]],d.__c.setState({}))}],d.__c=r$$module$libs$hooks_module,!r$$module$libs$hooks_module.u)){var e=function(t,w,z){if(!d.__c.__H)return!0;var C=d.__c.__H.__.filter(function(M){return M.__c});if(C.every(function(M){return!M.__N}))return!g||g.call(this,
t,w,z);var H=!1;return C.forEach(function(M){if(M.__N){var L=M.__[0];M.__=M.__N;M.__N=void 0;L!==M.__[0]&&(H=!0)}}),!(!H&&d.__c.props===t)&&(!g||g.call(this,t,w,z))};r$$module$libs$hooks_module.u=!0;var g=r$$module$libs$hooks_module.shouldComponentUpdate,n=r$$module$libs$hooks_module.componentWillUpdate;r$$module$libs$hooks_module.componentWillUpdate=function(t,w,z){if(this.__e){var C=g;g=void 0;e(t,w,z);g=C}n&&n.call(this,t,w,z)};r$$module$libs$hooks_module.shouldComponentUpdate=e}return d.__N||
d.__}function p$$module$libs$hooks_module(a,b){var c=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,3);!l$$module$libs$preact.__s&&z$$module$libs$hooks_module(c.__H,b)&&(c.__=a,c.i=b,r$$module$libs$hooks_module.__H.__h.push(c))}function y$$module$libs$hooks_module(a,b){var c=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,4);!l$$module$libs$preact.__s&&z$$module$libs$hooks_module(c.__H,b)&&(c.__=a,c.i=b,r$$module$libs$hooks_module.__h.push(c))}
function _$$module$libs$hooks_module(a){return o$$module$libs$hooks_module=5,F$$module$libs$hooks_module(function(){return{current:a}},[])}function A$$module$libs$hooks_module(a,b,c){o$$module$libs$hooks_module=6;y$$module$libs$hooks_module(function(){return"function"==typeof a?(a(b()),function(){return a(null)}):a?(a.current=b(),function(){return a.current=null}):void 0},null==c?c:c.concat(a))}
function F$$module$libs$hooks_module(a,b){var c=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,7);return z$$module$libs$hooks_module(c.__H,b)?(c.__V=a(),c.i=b,c.__h=a,c.__V):c.__}function T$$module$libs$hooks_module(a,b){return o$$module$libs$hooks_module=8,F$$module$libs$hooks_module(function(){return a},b)}
function q$$module$libs$hooks_module(a){var b=r$$module$libs$hooks_module.context[a.__c],c=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,9);return c.c=a,b?(null==c.__&&(c.__=!0,b.sub(r$$module$libs$hooks_module)),b.props.value):a.__}function x$$module$libs$hooks_module(a,b){l$$module$libs$preact.useDebugValue&&l$$module$libs$preact.useDebugValue(b?b(a):a)}
function P$$module$libs$hooks_module(a){var b=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,10),c=h$$module$libs$hooks_module();return b.__=a,r$$module$libs$hooks_module.componentDidCatch||(r$$module$libs$hooks_module.componentDidCatch=function(d,e){b.__&&b.__(d,e);c[1](d)}),[c[0],function(){c[1](void 0)}]}
function V$$module$libs$hooks_module(){var a=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,11);if(!a.__){for(var b=r$$module$libs$hooks_module.__v;null!==b&&!b.__m&&null!==b.__;)b=b.__;b=b.__m||(b.__m=[0,0]);a.__="P"+b[0]+"-"+b[1]++}return a.__}
function b$$module$libs$hooks_module(){for(var a;a=f$$module$libs$hooks_module.shift();)if(a.__P&&a.__H)try{a.__H.__h.forEach(k$$module$libs$hooks_module),a.__H.__h.forEach(w$$module$libs$hooks_module),a.__H.__h=[]}catch(b){a.__H.__h=[],l$$module$libs$preact.__e(b,a.__v)}}l$$module$libs$preact.__b=function(a){r$$module$libs$hooks_module=null;e$$module$libs$hooks_module&&e$$module$libs$hooks_module(a)};
l$$module$libs$preact.__r=function(a){a$$module$libs$hooks_module&&a$$module$libs$hooks_module(a);t$$module$libs$hooks_module=0;(a=(r$$module$libs$hooks_module=a.__c).__H)&&(u$$module$libs$hooks_module===r$$module$libs$hooks_module?(a.__h=[],r$$module$libs$hooks_module.__h=[],a.__.forEach(function(b){b.__N&&(b.__=b.__N);b.__V=c$$module$libs$hooks_module;b.__N=b.i=void 0})):(a.__h.forEach(k$$module$libs$hooks_module),a.__h.forEach(w$$module$libs$hooks_module),a.__h=[]));u$$module$libs$hooks_module=
r$$module$libs$hooks_module};
l$$module$libs$preact.diffed=function(a){v$$module$libs$hooks_module&&v$$module$libs$hooks_module(a);(a=a.__c)&&a.__H&&(a.__H.__h.length&&(1!==f$$module$libs$hooks_module.push(a)&&i$$module$libs$hooks_module===l$$module$libs$preact.requestAnimationFrame||((i$$module$libs$hooks_module=l$$module$libs$preact.requestAnimationFrame)||j$$module$libs$hooks_module)(b$$module$libs$hooks_module)),a.__H.__.forEach(function(b){b.i&&(b.__H=b.i);b.__V!==c$$module$libs$hooks_module&&(b.__=b.__V);b.i=void 0;b.__V=
c$$module$libs$hooks_module}));u$$module$libs$hooks_module=r$$module$libs$hooks_module=null};l$$module$libs$preact.__c=function(a,b){b.some(function(c){try{c.__h.forEach(k$$module$libs$hooks_module),c.__h=c.__h.filter(function(d){return!d.__||w$$module$libs$hooks_module(d)})}catch(d){b.some(function(e){e.__h&&(e.__h=[])}),b=[],l$$module$libs$preact.__e(d,c.__v)}});l$$module$libs$hooks_module&&l$$module$libs$hooks_module(a,b)};
l$$module$libs$preact.unmount=function(a){m$$module$libs$hooks_module&&m$$module$libs$hooks_module(a);var b;(a=a.__c)&&a.__H&&(a.__H.__.forEach(function(c){try{k$$module$libs$hooks_module(c)}catch(d){b=d}}),a.__H=void 0,b&&l$$module$libs$preact.__e(b,a.__v))};var g$$module$libs$hooks_module="function"==typeof requestAnimationFrame;
function j$$module$libs$hooks_module(a){var b,c=function(){clearTimeout(d);g$$module$libs$hooks_module&&cancelAnimationFrame(b);setTimeout(a)},d=setTimeout(c,100);g$$module$libs$hooks_module&&(b=requestAnimationFrame(c))}function k$$module$libs$hooks_module(a){var b=r$$module$libs$hooks_module,c=a.__c;"function"==typeof c&&(a.__c=void 0,c());r$$module$libs$hooks_module=b}function w$$module$libs$hooks_module(a){var b=r$$module$libs$hooks_module;a.__c=a.__();r$$module$libs$hooks_module=b}
function z$$module$libs$hooks_module(a,b){return!a||a.length!==b.length||b.some(function(c,d){return c!==a[d]})}function B$$module$libs$hooks_module(a,b){return"function"==typeof b?b(a):b}var module$libs$hooks_module={};module$libs$hooks_module.useCallback=T$$module$libs$hooks_module;module$libs$hooks_module.useContext=q$$module$libs$hooks_module;module$libs$hooks_module.useDebugValue=x$$module$libs$hooks_module;module$libs$hooks_module.useEffect=p$$module$libs$hooks_module;
module$libs$hooks_module.useErrorBoundary=P$$module$libs$hooks_module;module$libs$hooks_module.useId=V$$module$libs$hooks_module;module$libs$hooks_module.useImperativeHandle=A$$module$libs$hooks_module;module$libs$hooks_module.useLayoutEffect=y$$module$libs$hooks_module;module$libs$hooks_module.useMemo=F$$module$libs$hooks_module;module$libs$hooks_module.useReducer=s$$module$libs$hooks_module;module$libs$hooks_module.useRef=_$$module$libs$hooks_module;module$libs$hooks_module.useState=h$$module$libs$hooks_module;var a$$module$libs$preact_router_module={};function c$$module$libs$preact_router_module(a,b){for(var c in b)a[c]=b[c];return a}
function s$$module$libs$preact_router_module(a,b,c){var d=/(?:\?([^#]*))?(#.*)?$/,e=a.match(d),g={};if(e&&e[1]){e=e[1].split("&");for(var n=0;n<e.length;n++){var t=e[n].split("=");g[decodeURIComponent(t[0])]=decodeURIComponent(t.slice(1).join("="))}}a=d$$module$libs$preact_router_module(a.replace(d,""));b=d$$module$libs$preact_router_module(b||"");d=Math.max(a.length,b.length);for(e=0;e<d;e++)if(b[e]&&":"===b[e].charAt(0)){n=b[e].replace(/(^:|[+*?]+$)/g,"");t=(b[e].match(/[+*?]+$/)||a$$module$libs$preact_router_module)[0]||
"";var w=~t.indexOf("+"),z=~t.indexOf("*"),C=a[e]||"";if(!C&&!z&&(0>t.indexOf("?")||w)){var H=!1;break}if(g[n]=decodeURIComponent(C),w||z){g[n]=a.slice(e).map(decodeURIComponent).join("/");break}}else if(b[e]!==a[e]){H=!1;break}return(!0===c.default||!1!==H)&&g}function h$$module$libs$preact_router_module(a,b){return a.rank<b.rank?1:a.rank>b.rank?-1:a.index-b.index}
function v$$module$libs$preact_router_module(a,b){return a.index=b,a.rank=a.props.default?0:d$$module$libs$preact_router_module(a.props.path).map(l$$module$libs$preact_router_module).join(""),a.props}function d$$module$libs$preact_router_module(a){return a.replace(/(^\/+|\/+$)/g,"").split("/")}function l$$module$libs$preact_router_module(a){return":"==a.charAt(0)?1+"*+?".indexOf(a.charAt(a.length-1))||4:5}
var p$$module$libs$preact_router_module={},m$$module$libs$preact_router_module=[],y$$module$libs$preact_router_module=[],U$$module$libs$preact_router_module=null,g$$module$libs$preact_router_module={url:R$$module$libs$preact_router_module()},k$$module$libs$preact_router_module=F$$module$libs$preact(g$$module$libs$preact_router_module);
function C$$module$libs$preact_router_module(){var a=q$$module$libs$hooks_module(k$$module$libs$preact_router_module);if(a===g$$module$libs$preact_router_module){var b=h$$module$libs$hooks_module()[1];p$$module$libs$hooks_module(function(){return y$$module$libs$preact_router_module.push(b),function(){return y$$module$libs$preact_router_module.splice(y$$module$libs$preact_router_module.indexOf(b),1)}},[])}return[a,$$$module$libs$preact_router_module]}
function R$$module$libs$preact_router_module(){var a;return""+((a=U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module.location?U$$module$libs$preact_router_module.location:U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module.getCurrentLocation?U$$module$libs$preact_router_module.getCurrentLocation():"undefined"!=typeof location?location:p$$module$libs$preact_router_module).pathname||"")+(a.search||"")}
function $$$module$libs$preact_router_module(a,b){return void 0===b&&(b=!1),"string"!=typeof a&&a.url&&(b=a.replace,a=a.url),function(c){for(var d=m$$module$libs$preact_router_module.length;d--;)if(m$$module$libs$preact_router_module[d].canRoute(c))return!0;return!1}(a)&&function(c,d){void 0===d&&(d="push");U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module[d]?U$$module$libs$preact_router_module[d](c):"undefined"!=typeof history&&history[d+"State"]&&history[d+"State"](null,null,
c)}(a,b?"replace":"push"),I$$module$libs$preact_router_module(a)}function I$$module$libs$preact_router_module(a){for(var b=!1,c=0;c<m$$module$libs$preact_router_module.length;c++)m$$module$libs$preact_router_module[c].routeTo(a)&&(b=!0);return b}function M$$module$libs$preact_router_module(a){if(a&&a.getAttribute){var b=a.getAttribute("href");a=a.getAttribute("target");if(b&&b.match(/^\//g)&&(!a||a.match(/^_?self$/i)))return $$$module$libs$preact_router_module(b)}}
function b$$module$libs$preact_router_module(a){return a.stopImmediatePropagation&&a.stopImmediatePropagation(),a.stopPropagation&&a.stopPropagation(),a.preventDefault(),!1}
function W$$module$libs$preact_router_module(a){if(!(a.ctrlKey||a.metaKey||a.altKey||a.shiftKey||a.button)){var b=a.target;do if("a"===b.localName&&b.getAttribute("href")){if(b.hasAttribute("data-native")||b.hasAttribute("native"))break;if(M$$module$libs$preact_router_module(b))return b$$module$libs$preact_router_module(a)}while(b=b.parentNode)}}var w$$module$libs$preact_router_module=!1;
function D$$module$libs$preact_router_module(a){a.history&&(U$$module$libs$preact_router_module=a.history);this.state={url:a.url||R$$module$libs$preact_router_module()}}
c$$module$libs$preact_router_module(D$$module$libs$preact_router_module.prototype=new k$$module$libs$preact,{shouldComponentUpdate:function(a){return!0!==a.static||a.url!==this.props.url||a.onChange!==this.props.onChange},canRoute:function(a){var b=P$$module$libs$preact(this.props.children);return void 0!==this.g(b,a)},routeTo:function(a){this.setState({url:a});a=this.canRoute(a);return this.p||this.forceUpdate(),a},componentWillMount:function(){this.p=!0},componentDidMount:function(){var a=this;
w$$module$libs$preact_router_module||(w$$module$libs$preact_router_module=!0,U$$module$libs$preact_router_module||addEventListener("popstate",function(){I$$module$libs$preact_router_module(R$$module$libs$preact_router_module())}),addEventListener("click",W$$module$libs$preact_router_module));m$$module$libs$preact_router_module.push(this);U$$module$libs$preact_router_module&&(this.u=U$$module$libs$preact_router_module.listen(function(b){b=b.location||b;a.routeTo(""+(b.pathname||"")+(b.search||""))}));
this.p=!1},componentWillUnmount:function(){"function"==typeof this.u&&this.u();m$$module$libs$preact_router_module.splice(m$$module$libs$preact_router_module.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(a,b){a=a.filter(v$$module$libs$preact_router_module).sort(h$$module$libs$preact_router_module);for(var c=0;c<a.length;c++){var d=a[c],e=s$$module$libs$preact_router_module(b,d.props.path,d.props);if(e)return[d,e]}},render:function(a,
b){var c,d,e=a.onChange,g=b.url;b=this.c;a=this.g(P$$module$libs$preact(a.children),g);if(a&&(d=E$$module$libs$preact(a[0],c$$module$libs$preact_router_module(c$$module$libs$preact_router_module({url:g,matches:c=a[1]},c),{key:void 0,ref:void 0}))),g!==(b&&b.url)){c$$module$libs$preact_router_module(g$$module$libs$preact_router_module,b=this.c={url:g,previous:b&&b.url,current:d,path:d?d.props.path:null,matches:c});b.router=this;b.active=d?[d]:[];for(c=y$$module$libs$preact_router_module.length;c--;)y$$module$libs$preact_router_module[c]({});
"function"==typeof e&&e(b)}return y$$module$libs$preact(k$$module$libs$preact_router_module.Provider,{value:b},d)}});var E$$module$libs$preact_router_module=function(a){return y$$module$libs$preact("a",c$$module$libs$preact_router_module({onClick:W$$module$libs$preact_router_module},a))},L$$module$libs$preact_router_module=function(a){return y$$module$libs$preact(a.component,a)},module$libs$preact_router_module={};module$libs$preact_router_module.Link=E$$module$libs$preact_router_module;
module$libs$preact_router_module.Route=L$$module$libs$preact_router_module;module$libs$preact_router_module.Router=D$$module$libs$preact_router_module;module$libs$preact_router_module.default=D$$module$libs$preact_router_module;module$libs$preact_router_module.exec=s$$module$libs$preact_router_module;module$libs$preact_router_module.getCurrentUrl=R$$module$libs$preact_router_module;module$libs$preact_router_module.route=$$$module$libs$preact_router_module;
module$libs$preact_router_module.useRouter=C$$module$libs$preact_router_module;const is_electron$$module$api_shim=!0;function api_call_html$$module$api_shim(a,b,c){return new Promise(async d=>{let e=await window.api.get(c);d(e)})}function api_call_map$$module$api_shim(a){return new Promise(async b=>{let c=JSON.parse(await window.api.map());b(c)})}function api_call_dungeon$$module$api_shim(a,b){return new Promise(async c=>{let d=JSON.parse(await window.api.dungeon(b));c(d)})}
function api_call_hazards$$module$api_shim(a,b){return new Promise(async c=>{let d=JSON.parse(await window.api.hazards(b));c(d)})}function api_call_city$$module$api_shim(a,b){return new Promise(async c=>{let d=JSON.parse(await window.api.city(b));c(d)})}function api_call_version$$module$api_shim(a){return new Promise(async b=>{b({})})}function api_call_search$$module$api_shim(a,b){return new Promise(async c=>{let d={};d.results=await window.api.search(b);c(d)})}var module$api_shim={};
module$api_shim.api_call_city=api_call_city$$module$api_shim;module$api_shim.api_call_dungeon=api_call_dungeon$$module$api_shim;module$api_shim.api_call_hazards=api_call_hazards$$module$api_shim;module$api_shim.api_call_html=api_call_html$$module$api_shim;module$api_shim.api_call_map=api_call_map$$module$api_shim;module$api_shim.api_call_search=api_call_search$$module$api_shim;module$api_shim.api_call_version=api_call_version$$module$api_shim;module$api_shim.is_electron=is_electron$$module$api_shim;const BUILD_ID$$module$version="2408031853";var module$version={};module$version.BUILD_ID=BUILD_ID$$module$version;const html$$module$themes=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),DEFAULT_THEME$$module$themes={svg:is_electron$$module$api_shim?"hexroll-default-theme.svg?"+BUILD_ID$$module$version:"/hexroll-default-theme.svg?"+BUILD_ID$$module$version,no_rims:!0,rims_for_rivers:!1,borderline_zoom_factor:1E3,river_edge_color:"#1166aa",river_flow_color:"#3399cc",river_main_color:"#1166aa",trail_color:"#22222277",ocean_fill:"#049",ocean_stroke:"#25a",generate_thumbnail_scale:5,svg_style:html$$module$themes`
    <style>
      svg#canvas {
        background-color: #004499;
      }
      polygon.underwear {
        fill: #667722;
      }

      polygon.underwear-fow {
        fill: #171910;
      }

      polygon.continent {
        color: #ff0000;
        stroke: #ff0000;
        stroke-width: 2;
        fill: #667722;
        fill: #8c8e36;
      }
      .cc-label {
        font-family: 'Oswald';
        font-size: 0.1em;
        fill: #222;
        text-anchor: middle;
      }
      .hex-label {
        font-family: 'Lakki Reddy';
        font-weight: bolder;
        paint-order: stroke;
        pointer-events: none;
        fill: #333;
        stroke: #ddd;
        stroke-width: 0.5px;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
      .region-label {
        font-family: 'Lakki Reddy';
        font-weight: bolder;
        paint-order: stroke;
        pointer-events: none;
        fill: #333;
        stroke: #ddd;
        stroke-width: 1px;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
      .realm-label {
        font-family: 'Lakki Reddy';
        font-weight: bolder;
        paint-order: stroke;
        pointer-events: none;
        fill: #333;
        stroke: #aaa;
        stroke-width: 0.2em;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
    </style>
  `},PENZILLA_THEME$$module$themes={svg:is_electron$$module$api_shim?"hexroll-penzilla-theme.svg?"+BUILD_ID$$module$version:"/hexroll-penzilla-theme.svg?"+BUILD_ID$$module$version,no_rims:!1,rims_for_rivers:!1,borderline_zoom_factor:20,river_edge_color:"#33ccff",river_flow_color:"#88eeff",river_main_color:"#11aaff",trail_color:"#22000099",ocean_fill:"#09f",ocean_stroke:"#3bf",generate_thumbnail_scale:4,svg_style:html$$module$themes`
    <style>
      svg#canvas {
        background-color: #0099ff;
      }
      polygon.underwear {
        fill: #c8cc1e;
      }

      polygon.underwear-fow {
        fill: #171910;
      }

      polygon.continent {
        color: #ff0000;
        stroke: #ff0000;
        stroke-width: 2;
        fill: #c8cc1e;
      }

      .cc-label {
        font-family: 'Oswald';
        font-size: 0.1em;
        text-anchor: middle;
        fill: #fff;
      }
      .hex-label {
        font-family: 'Lakki Reddy';
        paint-order: stroke;
        pointer-events: none;
        fill: #fbf5c4;
        stroke: #4a4d40;
        stroke-width: 0.5px;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
      .region-label {
        font-family: 'Lakki Reddy';
        paint-order: stroke;
        pointer-events: none;
        fill: #fbf5c4;
        stroke: #4a4d40;
        stroke-width: 1px;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
      .realm-label {
        font-family: 'Lakki Reddy';
        paint-order: stroke;
        pointer-events: none;
        fill: #fbf5c4;
        stroke: #4a4d40;
        stroke-width: 0.2em;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
    </style>
  `},ANDREW_THEME$$module$themes={svg:is_electron$$module$api_shim?"hexroll-asheppard-theme.svg?"+BUILD_ID$$module$version:"/hexroll-asheppard-theme.svg?"+BUILD_ID$$module$version,no_rims:!1,rims_for_rivers:!0,borderline_zoom_factor:20,river_edge_color:"#78c8b6",river_flow_color:"#b2dec4",river_main_color:"#78c8b6",trail_color:"#00000099",ocean_fill:"#31899d",ocean_stroke:"#245f6d",generate_thumbnail_scale:4,svg_style:html$$module$themes`
    <style>
      svg#canvas {
        background-color: #31899d;
      }
      polygon.underwear {
        fill: #c8cc1e;
      }

      polygon.underwear-fow {
        fill: #171910;
      }

      polygon.continent {
        color: #ff0000;
        stroke: #ff0000;
        stroke-width: 2;
        fill: #c8cc1e;
      }

      .cc-label {
        font-family: 'Oswald';
        font-size: 0.1em;
        text-anchor: middle;
        fill: #fff;
      }
      .hex-label {
        font-family: 'Lakki Reddy';
        paint-order: stroke;
        pointer-events: none;
        fill: #fbf5c4;
        stroke: #4a4d40;
        stroke-width: 0.5px;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
      .region-label {
        font-family: 'Lakki Reddy';
        paint-order: stroke;
        pointer-events: none;
        fill: #fbf5c4;
        stroke: #4a4d40;
        stroke-width: 1px;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
      .realm-label {
        font-family: 'Lakki Reddy';
        paint-order: stroke;
        pointer-events: none;
        fill: #fbf5c4;
        stroke: #4a4d40;
        stroke-width: 0.2em;
        stroke-linecap: round;
        stroke-linejoin: bevel;
      }
    </style>
  `},THEMES$$module$themes={default:DEFAULT_THEME$$module$themes,penzilla:PENZILLA_THEME$$module$themes,andrew:ANDREW_THEME$$module$themes};function getThemeByIndex$$module$themes(a){a=a||window.app.theme_index;const b=Object.keys(THEMES$$module$themes);return a>=b.length?THEMES$$module$themes.default:THEMES$$module$themes[b[a]]}
function nextTheme$$module$themes(){let a=window.app.theme_index+1;const b=Object.keys(THEMES$$module$themes);window.app.theme_index=a>=b.length?0:a;window.app.theme=getThemeByIndex$$module$themes(window.app.theme_index)}var module$themes={};module$themes.THEMES=THEMES$$module$themes;module$themes.getThemeByIndex=getThemeByIndex$$module$themes;module$themes.nextTheme=nextTheme$$module$themes;function state_to_json$$module$state(){return JSON.stringify({state:{theme_index:window.app.theme_index,show_labels:window.app.map.state.show_labels,show_dice_bar:window.app.map.state.show_dice_bar,desaturate_palette:window.app.map.state.desaturate_palette,spoilers_on:window.app.map.state.spoilers_on,solo_mode:window.app.solo_mode,pins:window.app.map.map.hexpins,vtt:window.app.doc_test()}})}
function saveState$$module$state(a,b){!is_electron$$module$api_shim&&window.app.vtt_referee&&(window.app.map&&window.app.map.state.ephemeral?window.localStorage.setItem(a,state_to_json$$module$state()):(window.app.save_state_timeout&&window.clearTimeout(window.app.save_state_timeout),window.app.map&&(window.localStorage.getItem(a)&&window.localStorage.removeItem(a),window.app.save_state_timeout=window.setTimeout(()=>{fetch("/state/"+a+"/default",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},
body:state_to_json$$module$state()}).then(c=>c.json()).catch(c=>{console.error("Error:",c)});window.app.save_state_timeout=null},1E3))))}
function restoreState$$module$state(a,b,c,d){if(is_electron$$module$api_shim)d();else{if(b=window.localStorage.getItem(a))try{const e=JSON.parse(b);e.state?(window.app.theme_index=e.state.theme_index,window.app.theme=getThemeByIndex$$module$themes(),window.app.vtt_referee&&window.app.apply_doc_update(Uint8Array.from(e.state.vtt)),c(e)):d()}catch{}else d();window.app.map&&window.app.map.state.ephemeral?d():fetch("/state/"+a+"/default",{method:"GET"}).then(e=>e.json()).then(e=>{e.state?(window.app.theme_index=
e.state.theme_index,window.app.theme=getThemeByIndex$$module$themes(),window.app.vtt_referee&&window.app.apply_doc_update(Uint8Array.from(e.state.vtt)),c(e)):d()}).catch(e=>{console.error("Error:",e)})}}var module$state={};module$state.restoreState=restoreState$$module$state;module$state.saveState=saveState$$module$state;const html$$module$utils=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class Slider$$module$utils extends k$$module$libs$preact{constructor(){super();this.state={transition:"hidden"}}componentDidMount(a,b,c){0==this.props.switch?this.setState({visible:!1,transition:"hidden"}):this.setState({visible:!0,transition:"visible"})}componentWillUpdate(a){if(this.props.switch!=a.switch){window.clearTimeout(this.interval);0==a.switch?this.setState({transition:"hidden"}):this.setState({transition:"visible"});var b=this;a.keep||(0==a.switch?this.interval=window.setTimeout(function(){b.setState({visible:!1})},
500):b.setState({visible:!0}))}}render(a,b){return html$$module$utils`<div id="${a.id}" class="${b.transition}">
      ${b.visible?a.visible():html$$module$utils``}
    </div> `}}function rand$$module$utils(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function dist$$module$utils(a,b){const c=a.x-b.x;a=a.y-b.y;return Math.sqrt(c*c+a*a)}function get_polygon_extents$$module$utils(a){if(3>a.length)return{w:0,h:0};let b=a[0].x,c=a[0].x,d=a[0].y,e=a[0].y;for(var g=0,n=a.length;g<n;g++){const t=a[g].x,w=a[g].y;b=b<t?b:t;c=c>t?c:t;d=d<w?b:w;e=e>w?c:w}return{w:Math.abs(b-c),h:Math.abs(d-e)}}
function get_polygon_area$$module$utils(a){for(var b=0,c=0,d=a.length;c<d;c++){var e=a[c==a.length-1?0:c+1].x,g=a[c].y;b+=a[c].x*a[c==a.length-1?0:c+1].y*.5;b-=e*g*.5}return Math.abs(b)}function clamp$$module$utils(a,b,c){return Math.min(Math.max(a,b),c)}function make_xy_polygon$$module$utils(a){let b=[];for(let c=0;c<a.length;c++)b.push({x:a[c][0],y:a[c][1]});return b}
function get_polygon_centroid$$module$utils(a){var b=a[0],c=a[a.length-1];b.x==c.x&&b.y==c.y||a.push(b);var d=c=b=0,e=a.length,g,n=0;for(g=e-1;n<e;g=n++){var t=a[n];g=a[g];var w=t.x*g.y-g.x*t.y;b+=w;c+=(t.x+g.x)*w;d+=(t.y+g.y)*w}w=3*b;return{x:c/w,y:d/w}}function get_centroidic_point$$module$utils(a){for(var b={x:0,y:0},c=0;c<a.length;c++){var d=a[c];b.x+=d.x;b.y+=d.y}b.x/=a.length;b.y/=a.length;c=1E6;d=-1;for(let e=0;e<a.length;e++){const g=dist$$module$utils(a[e],b);g<c&&(c=g,d=e)}return a[d]}
function uuidv4$$module$utils(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16))}
class ModalDialog$$module$utils extends k$$module$libs$preact{componentDidMount(){window.app.inhibit_hotkeys=!0;this.props.toggleModal();window.addEventListener("keydown",a=>this.onKeyDown(a))}onKeyDown(a){if("Escape"===a.key&&this.props.onExit)this.props.onExit()}componentWillUnmount(){window.app.inhibit_hotkeys=!1;this.props.toggleModal()}}function canonical_coords$$module$utils(a,b){return(0<a?"E":0>a?"W":"")+(a?Math.abs(a):"")+(0<b?"S":0>b?"N":"")+(b?Math.abs(b):"")}
function parse_canonical_coords$$module$utils(a){a=/E?([0-9]+)?W?([0-9]+)?N?([0-9]+)?S?([0-9]+)?/.exec(a);return{x:a[1]||-1*a[2]||0,y:a[4]||-1*a[3]||0}}function make_tuple_polygon$$module$utils(a){let b=[];for(let c=0;c<a.length;c++)b.push([a[c].x,a[c].y]);return b}function capitalize$$module$utils(a){return a.charAt(0).toUpperCase()+a.slice(1)}var module$utils={};module$utils.ModalDialog=ModalDialog$$module$utils;module$utils.Slider=Slider$$module$utils;module$utils.canonical_coords=canonical_coords$$module$utils;
module$utils.capitalize=capitalize$$module$utils;module$utils.clamp=clamp$$module$utils;module$utils.dist=dist$$module$utils;module$utils.get_centroidic_point=get_centroidic_point$$module$utils;module$utils.get_polygon_area=get_polygon_area$$module$utils;module$utils.get_polygon_centroid=get_polygon_centroid$$module$utils;module$utils.get_polygon_extents=get_polygon_extents$$module$utils;module$utils.make_tuple_polygon=make_tuple_polygon$$module$utils;module$utils.make_xy_polygon=make_xy_polygon$$module$utils;
module$utils.parse_canonical_coords=parse_canonical_coords$$module$utils;module$utils.rand=rand$$module$utils;module$utils.uuidv4=uuidv4$$module$utils;const html$$module$battlemap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),kScale$$module$battlemap=.01,kScaleMultiplier$$module$battlemap=10*kScale$$module$battlemap;
class Token$$module$battlemap{constructor(a,b,c,d,e,g,n,t,w,z,C=!1,H=!1,M=0){this.uuid=a;this.tuid=b;this.x=c;this.y=d;this.w=g;this.h=n;this.r=e;this.offset=t;this.tid=w;this.light=z;this.pc=C;this.no_base=H;this.c=M}pointInside(a,b){const c=this.x+this.offset.x,d=this.y+this.offset.y,e=this.w/2,g=this.h/2;return a>=c-e&&a<=c+e&&b>=d-g&&b<=d+g}}function setTokenData$$module$battlemap(a,b){window.app.zarray.set(a,b)}
class TokenSurface$$module$battlemap extends k$$module$libs$preact{clicked(a,b){if(window.app.inhibit_click)window.app.inhibit_click=!1;else if(a&&window.app.token_hotkey_mode&&window.app.vtt_referee){let c=document.getElementById("canvas"),d=c.createSVGPoint();d.x=b.clientX;d.y=b.clientY;b=d.matrixTransform(c.getScreenCTM().inverse());this.props.onToken(a,b)}else window.app.kill_hotkey_mode||this.props.onClick(a,window.app.hotkey_mode&&window.app.vtt_referee)}}
const TOKEN_COLORS$$module$battlemap="#232121ff #344b67ff #566734ff #674434ff #542a2aff #542a54ff #2b2d53ff #ff3333ff #23212144".split(" ");function Tokens$$module$battlemap(a){return html$$module$battlemap`
    <g transform="scale(1.0) rotate(0)">
      ${Array.from(window.app.tokens[a.uuid]).map(([,b])=>html$$module$battlemap`
          <g
            onmouseenter=${()=>{if(window.app.vtt_referee||b.pc)window.app.selected_token={tuid:b.tuid,uuid:b.uuid};let c=document.getElementById("tbase_"+b.tuid);c&&!window.app.map.map.drag&&c.classList.add("disabled-token-base-highlight")}}
            onmouseleave=${()=>{window.app.selected_token&&window.app.selected_token.tuid&&window.app.selected_token.tuid==b.tuid&&(window.app.selected_token=null);let c=document.getElementById("tbase_"+b.tuid);c&&!window.app.map.map.drag&&c.classList.remove("disabled-token-base-highlight")}}
            onclick=${()=>window.app.kill_hotkey_mode&&window.app.zarray.delete(b.tuid)}
            transform="translate(${b.x},${b.y}) scale(${a.tokens_scale}) rotate(${b.r})"
            fill="#232121"
            fill=${TOKEN_COLORS$$module$battlemap[b.c]}
            stroke=${b.pc||!a.vtt?"#fff":"none"}
            stroke-width="0.1"
            stroke-linejoin="round"
          >
            ${b.no_base||html$$module$battlemap`
              <circle
                id="tbase_${b.tuid}"
                cx="0"
                cy="0"
                r="7"
                opacity="0"
                fill="#ff0000aa"
                stroke="none"
              />
            `}
            <use xlink:href="${window.app.tokens_svg}#${b.tid}" />
          </g>
        `)}
      <${window.app.hotkey_mode&&window.app.vtt_referee&&TorchIndicator$$module$battlemap}
        uuid=${a.uuid}
      />
    </g>
  `}class BattleMapArea$$module$battlemap extends TokenSurface$$module$battlemap{render(a){return html$$module$battlemap` <g>
      <rect
        class="cgrid"
        x="-1000"
        y="-1000"
        width="2000"
        height="2000"
        mask="url(#FilterMask)"
        fill="url(#grid)"
        onClick=${b=>this.clicked(a.uuid,b)}
      />
    </g>`}}function TorchMask$$module$battlemap(a){const b=a.scale?a.scale:kScale$$module$battlemap;return html$$module$battlemap` <mask
    id="${a.prefix?a.prefix:"LightMask"}${a.uuid}"
  >
    <rect x="-1000" y="-1000" width="2000" height="2000" fill="#000" />
    ${Array.from(window.app.tokens[a.uuid]).map(([,c])=>c.light&&html$$module$battlemap` <circle
          cx=${c.x/b}
          cy=${c.y/b}
          r=${.01/b*c.light}
          fill="url('#TorchGradient${a.uuid}')"
        />`)}
  </mask>`}function TorchIndicator$$module$battlemap(a){return html$$module$battlemap`${Array.from(window.app.tokens[a.uuid]).map(([,b])=>b.light&&html$$module$battlemap`<circle
        cx=${b.x}
        cy=${b.y}
        r=${b.light*kScale$$module$battlemap}
        fill="none"
        stroke-width="0.005"
        stroke="#ff0000"
      />`)}`}
class BaseBattleMap$$module$battlemap extends k$$module$libs$preact{constructor(){super();this.tokens_scale=.006;this.loaded=!1}componentWillUpdate(a){this.props.uuid!=a.uuid&&(window.app.tokens[a.uuid]=new Map)}componentDidUpdate(a,b,c){this.props.uuid!=a.uuid&&this.request_map_data(this.props.hex)}setRevealByPeers(a){window.app.yarray.get(a.uuid)&&"reveal"==window.app.yarray.get(a.uuid)[0]&&(a.reveal=!0)}pointsToCoords(a){let b=[];for(let c=0;c<a.length;c++)b.push([a[c].x,a[c].y]);return b}endSyncWithPeers(){this.sync_areas&&
window.app.yarray.unobserve(this.yarr_observer);window.app.zarray.unobserve(this.zarr_observer)}async request_map_data(a){this.loaded=!0}setLocalToken(a,b){window.app.tokens[this.props.uuid].set(a,new Token$$module$battlemap(this.props.uuid,a,b.x,b.y,b.r,5*kScale$$module$battlemap,5*kScale$$module$battlemap,this.props.zoff,b.t,b.l,b.pc,b.no_base,b.c))}syncDungeonAreas(a,b){if(a){b.keysChanged.has("reload")&&this.request_map_data(this.props.hex);for(let c of a)b.keysChanged.has(c.uuid)&&window.app.yarray.get(c.uuid)&&
("reveal"==window.app.yarray.get(c.uuid)[0]?c.reveal=!0:c.reveal=!1)}}beginSyncWithPeers(){let a=this;window.app.zarray.observe(this.zarr_observer=b=>{for(const c of b.keysChanged)window.app.zarray.has(c)?(b=window.app.zarray.get(c),b.d==this.props.uuid&&(this.setLocalToken(c,b),a.forceUpdate())):(window.app.tokens[this.props.uuid].delete(c),window.app.selected_token&&window.app.selected_token.tuid==c&&(window.app.selected_token=null),a.forceUpdate());saveState$$module$state(this.props.instance,"default")});
this.sync_areas&&window.app.yarray.observe(this.yarr_observer=b=>{this.syncDungeonAreas(a.state.dungeon.caverns||a.state.dungeon.areas,b);a.forceUpdate()})}addToken(a,b){window.app.map.showTokenChooser(c=>{window.app.ydoc.transact(()=>{const d=uuidv4$$module$utils();setTokenData$$module$battlemap(d,{u:d,t:c.id,x:b.x-this.props.zoff.x,y:b.y-this.props.zoff.y,r:0,l:c.light,pc:c.pc,d:this.props.uuid,no_base:c.no_base})})})}componentWillMount(a,b,c){window.app.tokens[this.props.uuid]=new Map;this.beginSyncWithPeers();
for(const [d,e]of window.app.zarray)e.d==this.props.uuid&&this.setLocalToken(d,e)}componentWillUnmount(){window.app.reroll_handlers.delete("dungeon"+this.props.hex);this.endSyncWithPeers()}updatePeerOnReveal(a,b){window.app.yarray.set(a,[b?"reveal":""])}}class BattleMap$$module$battlemap extends BaseBattleMap$$module$battlemap{constructor(){super()}render(a,b){return html$$module$battlemap`
      <filter id="noise" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence
          type="fractalNoise"
          baseFrequency="0.125"
          numOctaves="2"
          seed="15"
          stitchTiles="stitch"
          result="turbulence"
        ></feTurbulence>
        <feComponentTransfer>
          <feFuncR type="discrete" tableValues="0 0 1 1" />
          <feFuncG type="discrete" tableValues="2 2 0 0" />
          <feFuncB type="discrete" tableValues="0 0 1 1" />
        </feComponentTransfer>
      </filter>
      <defs>
        <radialGradient id="TorchGradient${a.uuid}">
          <stop offset="10%" stop-color="#ffffffff" />
          <stop offset="30%" stop-color="#ffffffff" />
          <stop offset="95%" stop-color="#ffffff00" />
        </radialGradient>
        <pattern id="grid" width="5" height="5" patternUnits="userSpaceOnUse">
          <path
            d="M 5 0 L 0 0 0 5"
            fill="none"
            stroke="#86817c"
            stroke="#00000066"
            stroke-width="0.2"
          />
        </pattern>
      </defs>
      <${a.vtt&&TorchMask$$module$battlemap}
        scale="1.0"
        prefix="SecLightMask"
        uuid="${a.uuid}"
      />
      <mask id="SecAreasMask${a.uuid}">
        <g>
          <circle cx="0" cy="0" r="500" fill="#fff" />
        </g>
      </mask>
      <g mask="url(#SecAreasMask${a.uuid})">
        <g transform="scale(${kScale$$module$battlemap}) rotate(0)">
          <g>
            <mask id="FilterMask">
              <rect
                x="-1000"
                y="-1000"
                width="2000"
                height="2000"
                filter="url(#noise)"
              />
            </mask>
          </g>
          <mask id="BattleGridMask${a.uuid}">
            <circle cx="0" cy="0" r="500" fill="#fff" />
          </mask>
          <g mask="url(#BattleGridMask${a.uuid})">
            <${BattleMapArea$$module$battlemap}
              uuid=${a.uuid}
              onClick=${()=>{}}
              onToken=${(c,d)=>{this.addToken(c,d)}}
            />
          </g>
        </g>

        <${Tokens$$module$battlemap}
          uuid=${a.uuid}
          vtt=${a.vtt}
          tokens_scale=${this.tokens_scale}
        />
      </g>
    `}}var module$battlemap={};module$battlemap.BaseBattleMap=BaseBattleMap$$module$battlemap;module$battlemap.BattleMap=BattleMap$$module$battlemap;module$battlemap.TokenSurface=TokenSurface$$module$battlemap;module$battlemap.Tokens=Tokens$$module$battlemap;module$battlemap.TorchMask=TorchMask$$module$battlemap;module$battlemap.setTokenData=setTokenData$$module$battlemap;const html$$module$dicebox=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),is_mobile$$module$dicebox=navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/);
class Dice$$module$dicebox extends k$$module$libs$preact{constructor(){super();this.setState({diceColor:"#ff0000"});this.black=0}roll(a){window.app.rollDice(a)}changeColor(){this.black++;let a="#";if(0===this.black%10)a="#111111";else for(var b=0;6>b;b++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];window.app.diceBox.updateConfig({themeColor:a});this.setState({diceColor:a})}render(a,b){if(!is_mobile$$module$dicebox)return html$$module$dicebox`
      <${Slider$$module$utils}
        id="dice-toggles"
        switch=${!a.visible}
        visible=${()=>html$$module$dicebox`
              <a
                title="Roll a D20 [press 2]"
                onclick=${()=>{this.roll("1d20")}}
              >
                <svg
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m0.949-14.5c-9e-3 0.126-0.0274 0.393-0.0274 0.393 6e-3 0.386-0.143 1.1 0.569 1.32 1.82 0.559 4.82 1.32 6.66 1.81-1.96-1.02-5.23-2.53-7.2-3.53zm-1.95 0.0873c-3.65 0.998-5.25 1.55-7.61 3.29 1.95-0.518 4.57-1.05 6.45-1.7 0.587-0.289 1.56-1.38 1.16-1.6zm-0.843 3.27c-2.81 0.69-5.85 1.54-9.94 2.73 0.437 3.53 1.05 7.25 2.41 10.7 2.59-4.43 5.14-8.88 7.52-13.4zm3.68 0.0334c0.567 1.11 3.07 5.77 7.43 13.4 1.14-3.27 2.05-6.86 1.99-10.4-3.85-1.33-5.64-2.09-9.43-3.01zm-1.79 0.304-8.09 14.2c5.33-0.01 10.7 0.0298 16-0.0527-2.62-4.72-5.3-9.41-7.9-14.1zm12.8 6.51c-0.632 3.02-1.45 5.77-2.41 8.3 0.836 0.687 1.64 1.41 2.48 2.1 0.229-3.18 0.539-7.13-0.0687-10.4zm-25.8 0.0837c-0.378 3.41-0.248 6.91 0.0367 10.3 0.817-0.681 1.68-1.32 2.38-2.13-0.871-2.53-1.45-5.7-2.42-8.2zm11.8 9.19c-2.98 9e-3 -5.59 0.0591-6.54 0.122v0c2.46 3.22 5.02 6.36 7.7 9.4 2.67-3.02 5.18-6.18 7.63-9.39-2.45-0.106-5.81-0.139-8.79-0.131zm10.7 0.481c-0.855 1.07-1.71 2.15-2.57 3.22-1.12 1.41-2.24 2.81-3.37 4.22 2.9-1.7 5.78-3.45 8.67-5.18-0.891-0.777-1.78-1.56-2.73-2.26zm-19.1 0.0154c-0.901 0.745-1.83 1.46-2.65 2.29 2.87 1.8 5.79 3.51 8.71 5.23-2.01-2.52-4.03-5.02-6.06-7.53z"
                    fill="currentColor"
                  />
                </svg>
              </a>
              <a
                title="Roll a D12 [press 3]"
                onclick=${()=>{this.roll("1d12")}}
              >
                <svg
                  id="dice-d12"
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m-0.848-15.1-7.87 2.49c-1.62 2.28-3.3 4.53-4.84 6.87 1.15 0.481 2.32 0.934 3.53 1.25 3.16-2.08 6.17-4.39 9.24-6.6-0.0132-1.34 0.0344-2.68-0.0506-4.01zm1.69 0c-0.0841 1.33-0.0478 2.66-0.0506 4 3.02 2.21 6.02 4.46 9.08 6.62 1.24-0.381 2.49-0.743 3.69-1.25-1.55-2.34-3.22-4.59-4.85-6.87-2.62-0.831-5.25-1.64-7.87-2.49zm-0.844 5.49c-2.85 2.09-5.74 4.13-8.57 6.25 0.808 3.35 1.84 6.62 2.97 9.86 0.933 1.21 9.32 0.417 11.1 0.299 1.21-3.33 2.23-6.72 3.07-10.2-2.83-2.11-5.7-4.17-8.56-6.25zm-13.9 5.55-0.11 8.7c1.55 2.12 3.02 4.26 4.63 6.31 0.839-1.06 1.65-2.15 2.46-3.23-1.14-3.52-2.29-7.03-3.43-10.5-1.18-0.417-2.4-0.887-3.55-1.23zm27.8 0c-0.118 0.0354-0.237 0.0702-0.356 0.105-1.02 0.325-2.14 0.745-3.2 1.12-1.14 3.52-2.28 7.04-3.42 10.6 0.816 1.06 1.57 2.17 2.49 3.14 1.59-2.03 3.07-4.14 4.59-6.21-0.0363-2.91 0.0863-5.82-0.107-8.72zm-8.22 12.9-11.4 6e-3c-0.743 1.01-1.54 1.98-2.21 3.03 2.52 1.06 5.1 2.03 7.75 2.74 2.67-0.583 7.89-2.29 7.96-2.69 0.0693-0.407-1.42-2.16-2.12-3.08z"
                    fill="currentColor"
                  />
                </svg>
              </a>
              <a
                title="Roll a D10 [press 4]"
                onclick=${()=>{this.roll("1d10")}}
              >
                <svg
                  id="dice-d10"
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m0.0111-14.7c-1.24 2.35-4.13 8.01-6.28 12.7 2.03 0.946 4.09 1.84 6.19 2.61 2.2-0.8 4.41-1.59 6.52-2.6-2.03-4.3-4.19-8.54-6.44-12.7zm3.64 3.27c0.748 1.55 3.23 6.68 4.58 8.91 1.74 0.763 3.22 1.19 4.78 1.58-3.06-3.55-6.21-7.03-9.36-10.5zm-7.32 0.146c-2.54 2.81-6.26 6.93-9.2 10.3 1.56-0.407 3.13-0.775 4.66-1.25 1.56-3.01 3.04-6.05 4.53-9.09zm11.4 10.7-6.62 2.59c-0.0193 3.69-0.137 7.38-0.0682 11.1 5.04-4.64 10.9-10.6 12.4-12.1-2.61-0.66-3.76-1.11-5.7-1.57zm-15.4 0.01c-4.37 1.1-4.89 1.24-5.83 1.53 4.02 4.2 8.23 8.22 12.5 12.1 0.111-3.68-0.0071-7.37-0.0295-11.1-2.22-0.872-4.44-1.75-6.66-2.62z"
                    fill="currentColor"
                  />
                </svg>
              </a>
              <a
                title="Roll a D8 [press 5]"
                onclick=${()=>{this.roll("1d8")}}
              >
                <svg
                  id="dice-d8"
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m0.0106-15.2c-4.12 7.01-8.15 14.1-12.1 21.2 8.76-0.0395 19.5 0.141 24.4 0.0548-5.41-9.96-11.9-20.6-12.3-21.2zm2.45 0.526 10.4 18.1c-3e-3 -3.89 0.176-7.79-0.0228-11.7 0.0543-0.634-4.04-2.92-10.4-6.41zm-4.8 6e-3c-3.57 1.98-7.08 4.05-10.6 6.09 0.0177 4.09-0.0426 8.19 0.0548 12.3 3.59-6.08 7.12-12.2 10.6-18.4zm12.9 22.5h-20.9c3.47 1.99 6.92 4.02 10.4 5.92 3.53-1.89 6.98-3.94 10.5-5.92z"
                    fill="currentColor"
                  />
                </svg>
              </a>
              <a
                title="Roll a D6 [press 6]"
                onclick=${()=>{this.roll("1d6")}}
              >
                <svg
                  id="dice-d6"
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m-0.244-15.1c-3.99 2.16-7.88 4.51-11.7 6.91 3.86 2.4 7.79 4.75 11.8 6.95 4.13-2.2 8.13-4.62 12.2-6.94-4.03-2.39-8.1-4.73-12.2-6.92zm13.1 8.41-12.1 6.94c0.0203 4.63-0.0588 9.26 0.0997 13.9 4.05-2.27 8.05-4.61 12.1-6.93-0.0192-4.63 0.0566-9.27-0.0977-13.9zm-25.8 0.0313-0.0351 14c4 2.29 7.96 4.66 12 6.83-0.0323-4.9-0.0597-11.2-0.0863-13.9-3.89-2.36-7.93-4.69-11.9-6.97z"
                    fill="currentColor"
                  />
                </svg>
              </a>
              <a
                title="Roll a D4 [press 7]"
                onclick=${()=>{this.roll("1d4")}}
              >
                <svg
                  id="dice-d4"
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m0.873-15 6e-3 27.3c0.0986 0.566 12.4-7.14 13.5-7.81-4.41-6.54-8.93-13-13.5-19.5zm-2.17 0.536-13.1 19c4.39 2.76 8.88 5.43 13.4 8.02 0.0251-9.09-0.336-27-0.336-27z"
                    fill="currentColor"
                  />
                </svg>
              </a>
              <svg
                id="dice-d4"
                width="10mm"
                height="10mm"
                version="1.1"
                viewBox="-15.5 -15.5 31 31"
                xmlns="http://www.w3.org/2000/svg"
              >
              <a
                title="Randomize Dice Color"
                onclick=${()=>{this.changeColor()}}
              >
                <circle
                  cx="0"
                  cy="0"
                  r="12"
                  fill=${b.diceColor}
                  stroke="#e1e1e1"
                  stroke-width="3"
                />
              </svg></a>
            `}
      />
    `}}
class DiceRollSnackbar$$module$dicebox extends k$$module$libs$preact{constructor(){super();this.setState({snackbar:!1,results:[]});this.lastIndex=0;this.past_init=!1}componentDidMount(){window.app.rarray.observe(this.arr_observer=a=>{this.past_init||(this.lastIndex=window.app.rarray.length-1,this.past_init=!0);a=this.state.results;for(let c=this.lastIndex;c<window.app.rarray.length;c++){const d=window.app.rarray.get(c);var b=d.result;const e=[],g=new Map;let n=0;for(let t=0;t<b.length;t++){n+=b[t].value;
e.push(b[t].value);const w=b[t].sides;let z=0;g.has(w)&&(z=g.get(w));g.set(w,z+1)}b=Array.from(g,([t,w])=>""+w+t);a.push({id:c,player:d.from,result:n,components:10<e.length?"...":e.join(" + "),dice:10<b.length?"many dice":b.join("+")});window.setTimeout(()=>{this.state.results.length&&(this.state.results.shift(),this.setState({results:this.state.results}))},1E4)}this.lastIndex=window.app.rarray.length;this.setState({results:a,snackbar:!0})})}componentWillUnmount(){window.app.rarray.unobserve(this.arr_observer);
window.clearInterval(this.reducer)}render(a){if(!is_mobile$$module$dicebox)return html$$module$dicebox`
      <${Slider$$module$utils}
        id="dice-rolls-snackbar"
        switch=${this.state.snackbar}
        result=${a.result}
        visible=${()=>html$$module$dicebox`
            ${this.state.results.map((b,c)=>html$$module$dicebox`
                <div id="dice_result_${b.id}">
                  ${b.player} rolled ${b.dice} and got (${b.components}) =
                  <span class="dice-snackbar-result">${b.result}</span>
                </div>
              `)}
          `}
      />
    `}}var module$dicebox={};module$dicebox.Dice=Dice$$module$dicebox;module$dicebox.DiceRollSnackbar=DiceRollSnackbar$$module$dicebox;var Zl$$module$libs$dice_box_es=Object.defineProperty,ml$$module$libs$dice_box_es=(a,b,c)=>b in a?Zl$$module$libs$dice_box_es(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,S$$module$libs$dice_box_es=(a,b,c)=>(ml$$module$libs$dice_box_es(a,"symbol"!=typeof b?b+"":b,c),c),T$$module$libs$dice_box_es=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c);},W$$module$libs$dice_box_es=(a,b,c)=>(T$$module$libs$dice_box_es(a,b,"read from private field"),c?c.call(a):b.get(a)),J$$module$libs$dice_box_es=
(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},i$$module$libs$dice_box_es=(a,b,c,d)=>(T$$module$libs$dice_box_es(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c),H$$module$libs$dice_box_es=(a,b,c,d)=>({set _(e){i$$module$libs$dice_box_es(a,b,e,c)},get _(){return W$$module$libs$dice_box_es(a,b,d)}}),y$$module$libs$dice_box_es=(a,b,c)=>(T$$module$libs$dice_box_es(a,b,"access private method"),c);
function cl$$module$libs$dice_box_es(a){const {selector:b,id:c}=a;if(!b||"string"!=typeof b)throw Error("You must provide a DOM selector as the first argument in order to render the Dice Box");let d;a=document.querySelector(b);if(null==a||!a.nodeName)throw Error(`DiceBox target DOM node: '${b}' not found or not available yet. Try invoking inside a DOMContentLoaded event`);return"canvas"!==a.nodeName.toLowerCase()?(d=document.createElement("canvas"),d.id=c,a.appendChild(d)):d=a,d}
const $$$module$libs$dice_box_es="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHB0KHAsdCxtKXtyZXR1cm4gcCooMS1tKSt0Km19dmFyIFp0PXR5cGVvZiBkb2N1bWVudDwidSImJmRvY3VtZW50LmN1cnJlbnRTY3JpcHQ/ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmM6dm9pZCAwO3R5cGVvZiBfX2ZpbGVuYW1lPCJ1IiYmKFp0PVp0fHxfX2ZpbGVuYW1lKTtmdW5jdGlvbiBnbChwKXtwPXB8fHt9O3ZhciB0O3R8fCh0PXR5cGVvZiBwPCJ1Ij9wOnt9KTt2YXIgbTt0LnJlYWR5PW5ldyBQcm9taXNlKGZ1bmN0aW9uKGUpe209ZX0pO3ZhciBkPXt9LGo7Zm9yKGogaW4gdCl0Lmhhc093blByb3BlcnR5KGopJiYoZFtqXT10W2pdKTt2YXIgVj0hMSxYPSExLFU9ITEsRz0hMTtWPXR5cGVvZiB3aW5kb3c9PSJvYmplY3QiLFg9dHlwZW9mIGltcG9ydFNjcmlwdHM9PSJmdW5jdGlvbiIsVT10eXBlb2YgcHJvY2Vzcz09Im9iamVjdCImJnR5cGVvZiBwcm9jZXNzLnZlcnNpb25zPT0ib2JqZWN0IiYmdHlwZW9mIHByb2Nlc3MudmVyc2lvbnMubm9kZT09InN0cmluZyIsRz0hViYmIVUmJiFYO3ZhciB2PSIiLFEsdHQsd3QsejtVPyh2PVg/cmVxdWlyZSgicGF0aCIpLmRpcm5hbWUodikrIi8iOl9fZGlybmFtZSsiLyIsUT1mdW5jdGlvbihlLG8pe3JldHVybiB3dHx8KHd0PXJlcXVpcmUoImZzIikpLHp8fCh6PXJlcXVpcmUoInBhdGgiKSksZT16Lm5vcm1hbGl6ZShlKSx3dC5yZWFkRmlsZVN5bmMoZSxvP251bGw6InV0ZjgiKX0sdHQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9UShlLCEwKSxlLmJ1ZmZlcnx8KGU9bmV3IFVpbnQ4QXJyYXkoZSkpLEx0KGUuYnVmZmVyKSxlfSwxPHByb2Nlc3MuYXJndi5sZW5ndGgmJnByb2Nlc3MuYXJndlsxXS5yZXBsYWNlKC9cXC9nLCIvIikscHJvY2Vzcy5hcmd2LnNsaWNlKDIpLHByb2Nlc3Mub24oInVuY2F1Z2h0RXhjZXB0aW9uIixmdW5jdGlvbihlKXt0aHJvdyBlfSkscHJvY2Vzcy5vbigidW5oYW5kbGVkUmVqZWN0aW9uIixHdCksdC5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIltFbXNjcmlwdGVuIE1vZHVsZSBvYmplY3RdIn0pOkc/KHR5cGVvZiByZWFkPCJ1IiYmKFE9ZnVuY3Rpb24oZSl7cmV0dXJuIHJlYWQoZSl9KSx0dD1mdW5jdGlvbihlKXtyZXR1cm4gdHlwZW9mIHJlYWRidWZmZXI9PSJmdW5jdGlvbiI/bmV3IFVpbnQ4QXJyYXkocmVhZGJ1ZmZlcihlKSk6KGU9cmVhZChlLCJiaW5hcnkiKSxMdCh0eXBlb2YgZT09Im9iamVjdCIpLGUpfSx0eXBlb2YgcHJpbnQ8InUiJiYodHlwZW9mIGNvbnNvbGU+InUiJiYoY29uc29sZT17fSksY29uc29sZS5sb2c9cHJpbnQsY29uc29sZS53YXJuPWNvbnNvbGUuZXJyb3I9dHlwZW9mIHByaW50RXJyPCJ1Ij9wcmludEVycjpwcmludCkpOihWfHxYKSYmKFg/dj1zZWxmLmxvY2F0aW9uLmhyZWY6ZG9jdW1lbnQuY3VycmVudFNjcmlwdCYmKHY9ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpLFp0JiYodj1adCksdj12LmluZGV4T2YoImJsb2I6IikhPT0wP3Yuc3Vic3RyKDAsdi5sYXN0SW5kZXhPZigiLyIpKzEpOiIiLFE9ZnVuY3Rpb24oZSl7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiBvLm9wZW4oIkdFVCIsZSwhMSksby5zZW5kKG51bGwpLG8ucmVzcG9uc2VUZXh0fSxYJiYodHQ9ZnVuY3Rpb24oZSl7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiBvLm9wZW4oIkdFVCIsZSwhMSksby5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixvLnNlbmQobnVsbCksbmV3IFVpbnQ4QXJyYXkoby5yZXNwb25zZSl9KSk7dmFyIHp0PXQucHJpbnR8fGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksT3Q9dC5wcmludEVycnx8Y29uc29sZS53YXJuLmJpbmQoY29uc29sZSk7Zm9yKGogaW4gZClkLmhhc093blByb3BlcnR5KGopJiYodFtqXT1kW2pdKTtkPW51bGw7dmFyIGVlPVtdLEJ0LGZ0O3Qud2FzbUJpbmFyeSYmKGZ0PXQud2FzbUJpbmFyeSksdC5ub0V4aXRSdW50aW1lJiZ0Lm5vRXhpdFJ1bnRpbWUsdHlwZW9mIFdlYkFzc2VtYmx5IT0ib2JqZWN0IiYmT3QoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKTt2YXIga3QsV3Q9bmV3IFdlYkFzc2VtYmx5LlRhYmxlKHtpbml0aWFsOjQ3NSxlbGVtZW50OiJhbnlmdW5jIn0pLG9lPSExO2Z1bmN0aW9uIEx0KGUsbyl7ZXx8R3QoIkFzc2VydGlvbiBmYWlsZWQ6ICIrbyl9dmFyIEN0LEh0LFl0LFh0LG5lLFB0PXQuSU5JVElBTF9NRU1PUll8fDY3MTA4ODY0OyhrdD10Lndhc21NZW1vcnk/dC53YXNtTWVtb3J5Om5ldyBXZWJBc3NlbWJseS5NZW1vcnkoe2luaXRpYWw6UHQvNjU1MzYsbWF4aW11bTpQdC82NTUzNn0pKSYmKEN0PWt0LmJ1ZmZlciksUHQ9Q3QuYnl0ZUxlbmd0aDt2YXIgZXQ9Q3Q7Q3Q9ZXQsdC5IRUFQOD1uZXcgSW50OEFycmF5KGV0KSx0LkhFQVAxNj1uZXcgSW50MTZBcnJheShldCksdC5IRUFQMzI9WXQ9bmV3IEludDMyQXJyYXkoZXQpLHQuSEVBUFU4PUh0PW5ldyBVaW50OEFycmF5KGV0KSx0LkhFQVBVMTY9bmV3IFVpbnQxNkFycmF5KGV0KSx0LkhFQVBVMzI9bmV3IFVpbnQzMkFycmF5KGV0KSx0LkhFQVBGMzI9WHQ9bmV3IEZsb2F0MzJBcnJheShldCksdC5IRUFQRjY0PW5lPW5ldyBGbG9hdDY0QXJyYXkoZXQpLFl0WzQ0OTJdPTUyNjEwMDg7ZnVuY3Rpb24gVXQoZSl7Zm9yKDswPGUubGVuZ3RoOyl7dmFyIG89ZS5zaGlmdCgpO2lmKHR5cGVvZiBvPT0iZnVuY3Rpb24iKW8odCk7ZWxzZXt2YXIgbj1vLmhpO3R5cGVvZiBuPT0ibnVtYmVyIj9vLmNpPT09dm9pZCAwP3QuZHluQ2FsbF92KG4pOnQuZHluQ2FsbF92aShuLG8uY2kpOm4oby5jaT09PXZvaWQgMD9udWxsOm8uY2kpfX19dmFyIHJlPVtdLF9lPVtdLFZ0PVtdLEllPVtdLE9lPSExO2Z1bmN0aW9uIE9sKCl7dmFyIGU9dC5wcmVSdW4uc2hpZnQoKTtyZS51bnNoaWZ0KGUpfXZhciBRdD0wLHF0PW51bGw7dC5wcmVsb2FkZWRJbWFnZXM9e30sdC5wcmVsb2FkZWRBdWRpb3M9e307ZnVuY3Rpb24gR3QoZSl7dGhyb3cgdC5vbkFib3J0JiZ0Lm9uQWJvcnQoZSksZSs9IiIsenQoZSksT3QoZSksb2U9ITAsbmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcigiYWJvcnQoIitlKyIpLiBCdWlsZCB3aXRoIC1zIEFTU0VSVElPTlM9MSBmb3IgbW9yZSBpbmZvLiIpfWZ1bmN0aW9uIGdlKGUpe3ZhciBvPXh0O3JldHVybiBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGg/by5zdGFydHNXaXRoKGUpOm8uaW5kZXhPZihlKT09PTB9ZnVuY3Rpb24gQmUoKXtyZXR1cm4gZ2UoImRhdGE6YXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtO2Jhc2U2NCwiKX12YXIgeHQ9ImFtbW8ud2FzbS53YXNtIjtpZighQmUoKSl7dmFyIFBlPXh0O3h0PXQubG9jYXRlRmlsZT90LmxvY2F0ZUZpbGUoUGUsdik6ditQZX1mdW5jdGlvbiB4ZSgpe3RyeXtpZihmdClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZnQpO2lmKHR0KXJldHVybiB0dCh4dCk7dGhyb3ciYm90aCBhc3luYyBhbmQgc3luYyBmZXRjaGluZyBvZiB0aGUgd2FzbSBmYWlsZWQifWNhdGNoKGUpe0d0KGUpfX1mdW5jdGlvbiBCbCgpe3JldHVybiBmdHx8IVYmJiFYfHx0eXBlb2YgZmV0Y2ghPSJmdW5jdGlvbiJ8fGdlKCJmaWxlOi8vIik/bmV3IFByb21pc2UoZnVuY3Rpb24oZSl7ZSh4ZSgpKX0pOmZldGNoKHh0LHtjcmVkZW50aWFsczoic2FtZS1vcmlnaW4ifSkudGhlbihmdW5jdGlvbihlKXtpZighZS5vayl0aHJvdyJmYWlsZWQgdG8gbG9hZCB3YXNtIGJpbmFyeSBmaWxlIGF0ICciK3h0KyInIjtyZXR1cm4gZS5hcnJheUJ1ZmZlcigpfSkuY2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4geGUoKX0pfXZhciBQbD17MTM3NjpmdW5jdGlvbihlLG8sbixyLGMsRCxOLHl0KXtpZihlPXQuZ2V0Q2FjaGUodC5Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFjaylbZV0sIWUuaGFzT3duUHJvcGVydHkoImFkZFNpbmdsZVJlc3VsdCIpKXRocm93ImEgSlNJbXBsZW1lbnRhdGlvbiBtdXN0IGltcGxlbWVudCBhbGwgZnVuY3Rpb25zLCB5b3UgZm9yZ290IENvbmNyZXRlQ29udGFjdFJlc3VsdENhbGxiYWNrOjphZGRTaW5nbGVSZXN1bHQuIjtyZXR1cm4gZS5hZGRTaW5nbGVSZXN1bHQobyxuLHIsYyxELE4seXQpfX07X2UucHVzaCh7aGk6ZnVuY3Rpb24oKXtUZSgpfX0pO3ZhciBkZT1bXSx4bD17ZTpmdW5jdGlvbigpe0d0KCl9LGI6ZnVuY3Rpb24oZSxvLG4pe2RlLmxlbmd0aD0wO3ZhciByO2ZvcihuPj49MjtyPUh0W28rK107KWRlLnB1c2goMTA1PnI/bmVbKytuPj4xXTpZdFtuXSksKytuO3JldHVybiBQbFtlXS5hcHBseShudWxsLGRlKX0sYzpmdW5jdGlvbihlLG8sbil7SHQuY29weVdpdGhpbihlLG8sbytuKX0sZDpmdW5jdGlvbigpe0d0KCJPT00iKX0sYTpmdW5jdGlvbihlKXt2YXIgbz1EYXRlLm5vdygpO3JldHVybiBZdFtlPj4yXT1vLzFlM3wwLFl0W2UrND4+Ml09byUxZTMqMWUzfDAsMH0sbWVtb3J5Omt0LHRhYmxlOld0fTsoZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGMpe3QuYXNtPWMuZXhwb3J0cyxRdC0tLHQubW9uaXRvclJ1bkRlcGVuZGVuY2llcyYmdC5tb25pdG9yUnVuRGVwZW5kZW5jaWVzKFF0KSxRdD09MCYmcXQmJihjPXF0LHF0PW51bGwsYygpKX1mdW5jdGlvbiBvKGMpe2UoYy5pbnN0YW5jZSl9ZnVuY3Rpb24gbihjKXtyZXR1cm4gQmwoKS50aGVuKGZ1bmN0aW9uKEQpe3JldHVybiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZShELHIpfSkudGhlbihjLGZ1bmN0aW9uKEQpe090KCJmYWlsZWQgdG8gYXN5bmNocm9ub3VzbHkgcHJlcGFyZSB3YXNtOiAiK0QpLEd0KEQpfSkuY2F0Y2goRD0+e2NvbnNvbGUuZXJyb3IoImVycm9yIixEKSxjb25zb2xlLmVycm9yKGBBbW1vIGZpbGUgJyR7eHR9JyBub3QgZm91bmQuIFRoaXMgaXMgcmVxdWlyZWQgdG8gcnVuIHRoZSBwaHlzaWNzIHNpbXVsYXRpb24uIElzIHlvdXIgJ2Fzc2V0UGF0aCcgY29uZmlnIG9wdGlvbiBjb3JyZWN0IGFuZCBpcyB0aGVyZSBhbiAnYW1tbycgZm9sZGVyIHdpdGggdGhlICdhbW1vLndhc20ud2FzbScgZmlsZT8gRW5zdXJlIHlvdXIgc2VydmVyIGhhcyB0aGUgcHJvcGVyIG1pbWUgdHlwZSBmb3IgJy53YXNtJyBmaWxlcy5gKX0pfXZhciByPXthOnhsfTtpZihRdCsrLHQubW9uaXRvclJ1bkRlcGVuZGVuY2llcyYmdC5tb25pdG9yUnVuRGVwZW5kZW5jaWVzKFF0KSx0Lmluc3RhbnRpYXRlV2FzbSl0cnl7cmV0dXJuIHQuaW5zdGFudGlhdGVXYXNtKHIsZSl9Y2F0Y2goYyl7cmV0dXJuIE90KCJNb2R1bGUuaW5zdGFudGlhdGVXYXNtIGNhbGxiYWNrIGZhaWxlZCB3aXRoIGVycm9yOiAiK2MpLCExfXJldHVybiBmdW5jdGlvbigpe2lmKGZ0fHx0eXBlb2YgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmchPSJmdW5jdGlvbiJ8fEJlKCl8fGdlKCJmaWxlOi8vIil8fHR5cGVvZiBmZXRjaCE9ImZ1bmN0aW9uIilyZXR1cm4gbihvKTtmZXRjaCh4dCx7Y3JlZGVudGlhbHM6InNhbWUtb3JpZ2luIn0pLnRoZW4oZnVuY3Rpb24oYyl7cmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlU3RyZWFtaW5nKGMscikudGhlbihvLGZ1bmN0aW9uKEQpe3JldHVybiBPdCgid2FzbSBzdHJlYW1pbmcgY29tcGlsZSBmYWlsZWQ6ICIrRCksT3QoImZhbGxpbmcgYmFjayB0byBBcnJheUJ1ZmZlciBpbnN0YW50aWF0aW9uIiksbihvKX0pfSl9KCkse319KSgpO3ZhciBUZT10Ll9fX3dhc21fY2FsbF9jdG9ycz1mdW5jdGlvbigpe3JldHVybihUZT10Ll9fX3dhc21fY2FsbF9jdG9ycz10LmFzbS5mKS5hcHBseShudWxsLGFyZ3VtZW50cyl9O3QuX19fZW1fanNfX2FycmF5X2JvdW5kc19jaGVja19lcnJvcj1mdW5jdGlvbigpe3JldHVybih0Ll9fX2VtX2pzX19hcnJheV9ib3VuZHNfY2hlY2tfZXJyb3I9dC5hc20uZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfTt2YXIgRmU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9nZXREaXNwYXRjaGVyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRmU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9nZXREaXNwYXRjaGVyXzA9dC5hc20uaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldFBhaXJDYWNoZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKE1lPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfZ2V0UGFpckNhY2hlXzA9dC5hc20uaSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldERpc3BhdGNoSW5mb18wPWZ1bmN0aW9uKCl7cmV0dXJuKEFlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9dC5hc20uaikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3ZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHdlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20uaykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8yPWZ1bmN0aW9uKCl7cmV0dXJuKGtlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzI9dC5hc20ubCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8zPWZ1bmN0aW9uKCl7cmV0dXJuKExlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9dC5hc20ubSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX3JlbW92ZUNvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEhlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20ubikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldEJyb2FkcGhhc2VfMD1mdW5jdGlvbigpe3JldHVybihZZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2dldEJyb2FkcGhhc2VfMD10LmFzbS5vKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfY29udmV4U3dlZXBUZXN0XzU9ZnVuY3Rpb24oKXtyZXR1cm4oVmU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9jb252ZXhTd2VlcFRlc3RfNT10LmFzbS5wKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfY29udGFjdFBhaXJUZXN0XzM9ZnVuY3Rpb24oKXtyZXR1cm4oUWU9dC5fZWJfYnRDb2xsaXNpb25Xb3JsZF9jb250YWN0UGFpclRlc3RfMz10LmFzbS5xKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfY29udGFjdFRlc3RfMj1mdW5jdGlvbigpe3JldHVybihFZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX2NvbnRhY3RUZXN0XzI9dC5hc20ucikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX3VwZGF0ZVNpbmdsZUFhYmJfMT1mdW5jdGlvbigpe3JldHVybihYZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX3VwZGF0ZVNpbmdsZUFhYmJfMT10LmFzbS5zKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFVlPXQuX2ViX2J0Q29sbGlzaW9uV29ybGRfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihVZT10Ll9lYl9idENvbGxpc2lvbldvcmxkX19fZGVzdHJveV9fXzA9dC5hc20udCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHZT10Ll9lYl9idFF1YWRXb3JkX3hfMD1mdW5jdGlvbigpe3JldHVybihHZT10Ll9lYl9idFF1YWRXb3JkX3hfMD10LmFzbS51KS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE5lPXQuX2ViX2J0UXVhZFdvcmRfeV8wPWZ1bmN0aW9uKCl7cmV0dXJuKE5lPXQuX2ViX2J0UXVhZFdvcmRfeV8wPXQuYXNtLnYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0semU9dC5fZWJfYnRRdWFkV29yZF96XzA9ZnVuY3Rpb24oKXtyZXR1cm4oemU9dC5fZWJfYnRRdWFkV29yZF96XzA9dC5hc20udykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxZT10Ll9lYl9idFF1YWRXb3JkX3dfMD1mdW5jdGlvbigpe3JldHVybihxZT10Ll9lYl9idFF1YWRXb3JkX3dfMD10LmFzbS54KS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFplPXQuX2ViX2J0UXVhZFdvcmRfc2V0WF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFplPXQuX2ViX2J0UXVhZFdvcmRfc2V0WF8xPXQuYXNtLnkpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS2U9dC5fZWJfYnRRdWFkV29yZF9zZXRZXzE9ZnVuY3Rpb24oKXtyZXR1cm4oS2U9dC5fZWJfYnRRdWFkV29yZF9zZXRZXzE9dC5hc20ueikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkZT10Ll9lYl9idFF1YWRXb3JkX3NldFpfMT1mdW5jdGlvbigpe3JldHVybigkZT10Ll9lYl9idFF1YWRXb3JkX3NldFpfMT10LmFzbS5BKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEplPXQuX2ViX2J0UXVhZFdvcmRfc2V0V18xPWZ1bmN0aW9uKCl7cmV0dXJuKEplPXQuX2ViX2J0UXVhZFdvcmRfc2V0V18xPXQuYXNtLkIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdG89dC5fZWJfYnRRdWFkV29yZF9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKHRvPXQuX2ViX2J0UXVhZFdvcmRfX19kZXN0cm95X19fMD10LmFzbS5DKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGVvPXQuX2ViX2J0TW90aW9uU3RhdGVfZ2V0V29ybGRUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihlbz10Ll9lYl9idE1vdGlvblN0YXRlX2dldFdvcmxkVHJhbnNmb3JtXzE9dC5hc20uRCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvbz10Ll9lYl9idE1vdGlvblN0YXRlX3NldFdvcmxkVHJhbnNmb3JtXzE9ZnVuY3Rpb24oKXtyZXR1cm4ob289dC5fZWJfYnRNb3Rpb25TdGF0ZV9zZXRXb3JsZFRyYW5zZm9ybV8xPXQuYXNtLkUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbm89dC5fZWJfYnRNb3Rpb25TdGF0ZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKG5vPXQuX2ViX2J0TW90aW9uU3RhdGVfX19kZXN0cm95X19fMD10LmFzbS5GKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldEFuaXNvdHJvcGljRnJpY3Rpb25fMj1mdW5jdGlvbigpe3JldHVybihybz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRBbmlzb3Ryb3BpY0ZyaWN0aW9uXzI9dC5hc20uRykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRDb2xsaXNpb25TaGFwZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKF9vPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldENvbGxpc2lvblNoYXBlXzA9dC5hc20uSCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxpbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDb250YWN0UHJvY2Vzc2luZ1RocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGlvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkXzE9dC5hc20uSSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRBY3RpdmF0aW9uU3RhdGVfMT1mdW5jdGlvbigpe3JldHVybihhbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRBY3RpdmF0aW9uU3RhdGVfMT10LmFzbS5KKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHNvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2ZvcmNlQWN0aXZhdGlvblN0YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oc289dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZm9yY2VBY3RpdmF0aW9uU3RhdGVfMT10LmFzbS5LKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHBvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2FjdGl2YXRlXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfYWN0aXZhdGVfMD10LmFzbS5MKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2FjdGl2YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4obG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfYWN0aXZhdGVfMT10LmFzbS5NKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHVvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzQWN0aXZlXzA9ZnVuY3Rpb24oKXtyZXR1cm4odW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfaXNBY3RpdmVfMD10LmFzbS5OKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzS2luZW1hdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oY289dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfaXNLaW5lbWF0aWNPYmplY3RfMD10LmFzbS5PKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzU3RhdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oeW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfaXNTdGF0aWNPYmplY3RfMD10LmFzbS5QKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGhvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2lzU3RhdGljT3JLaW5lbWF0aWNPYmplY3RfMD1mdW5jdGlvbigpe3JldHVybihobz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0XzA9dC5hc20uUSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxmbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRSZXN0aXR1dGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKGZvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFJlc3RpdHV0aW9uXzA9dC5hc20uUikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRGcmljdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKG1vPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldEZyaWN0aW9uXzA9dC5hc20uUykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxibz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRSb2xsaW5nRnJpY3Rpb25fMD1mdW5jdGlvbigpe3JldHVybihibz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRSb2xsaW5nRnJpY3Rpb25fMD10LmFzbS5UKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFJlc3RpdHV0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZ289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0UmVzdGl0dXRpb25fMT10LmFzbS5VKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldEZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oV289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0RnJpY3Rpb25fMT10LmFzbS5WKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LENvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFJvbGxpbmdGcmljdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKENvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFJvbGxpbmdGcmljdGlvbl8xPXQuYXNtLlcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sam89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0V29ybGRUcmFuc2Zvcm1fMD1mdW5jdGlvbigpe3JldHVybihqbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRXb3JsZFRyYW5zZm9ybV8wPXQuYXNtLlgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdm89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0Q29sbGlzaW9uRmxhZ3NfMD1mdW5jdGlvbigpe3JldHVybih2bz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9nZXRDb2xsaXNpb25GbGFnc18wPXQuYXNtLlkpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q29sbGlzaW9uRmxhZ3NfMT1mdW5jdGlvbigpe3JldHVybihEbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDb2xsaXNpb25GbGFnc18xPXQuYXNtLlopLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUm89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0V29ybGRUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihSbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRXb3JsZFRyYW5zZm9ybV8xPXQuYXNtLl8pLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q29sbGlzaW9uU2hhcGVfMT1mdW5jdGlvbigpe3JldHVybihTbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDb2xsaXNpb25TaGFwZV8xPXQuYXNtLiQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q2NkTW90aW9uVGhyZXNob2xkXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSW89dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q2NkTW90aW9uVGhyZXNob2xkXzE9dC5hc20uYWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT289dC5fZWJfYnRDb2xsaXNpb25PYmplY3Rfc2V0Q2NkU3dlcHRTcGhlcmVSYWRpdXNfMT1mdW5jdGlvbigpe3JldHVybihPbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRDY2RTd2VwdFNwaGVyZVJhZGl1c18xPXQuYXNtLmJhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFVzZXJJbmRleF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEJvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFVzZXJJbmRleF8wPXQuYXNtLmNhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFBvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFVzZXJJbmRleF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFBvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFVzZXJJbmRleF8xPXQuYXNtLmRhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHhvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldFVzZXJQb2ludGVyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oeG89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0VXNlclBvaW50ZXJfMD10LmFzbS5lYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxUbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9zZXRVc2VyUG9pbnRlcl8xPWZ1bmN0aW9uKCl7cmV0dXJuKFRvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X3NldFVzZXJQb2ludGVyXzE9dC5hc20uZmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRm89dC5fZWJfYnRDb2xsaXNpb25PYmplY3RfZ2V0QnJvYWRwaGFzZUhhbmRsZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKEZvPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X2dldEJyb2FkcGhhc2VIYW5kbGVfMD10LmFzbS5nYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNbz10Ll9lYl9idENvbGxpc2lvbk9iamVjdF9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE1vPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0X19fZGVzdHJveV9fXzA9dC5hc20uaGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQW89dC5fZWJfQ29udGFjdFJlc3VsdENhbGxiYWNrX2FkZFNpbmdsZVJlc3VsdF83PWZ1bmN0aW9uKCl7cmV0dXJuKEFvPXQuX2ViX0NvbnRhY3RSZXN1bHRDYWxsYmFja19hZGRTaW5nbGVSZXN1bHRfNz10LmFzbS5pYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3bz10Ll9lYl9Db250YWN0UmVzdWx0Q2FsbGJhY2tfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybih3bz10Ll9lYl9Db250YWN0UmVzdWx0Q2FsbGJhY2tfX19kZXN0cm95X19fMD10LmFzbS5qYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19oYXNIaXRfMD1mdW5jdGlvbigpe3JldHVybihrbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19oYXNIaXRfMD10LmFzbS5rYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPWZ1bmN0aW9uKCl7cmV0dXJuKExvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwXzA9dC5hc20ubGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSG89dC5fZWJfQ29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29sbGlzaW9uRmlsdGVyR3JvdXBfMT1mdW5jdGlvbigpe3JldHVybihIbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPXQuYXNtLm1hKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFlvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMD1mdW5jdGlvbigpe3JldHVybihZbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzA9dC5hc20ubmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVm89dC5fZWJfQ29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29sbGlzaW9uRmlsdGVyTWFza18xPWZ1bmN0aW9uKCl7cmV0dXJuKFZvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMT10LmFzbS5vYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxRbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMD1mdW5jdGlvbigpe3JldHVybihRbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMD10LmFzbS5wYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxFbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihFbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMT10LmFzbS5xYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYbz10Ll9lYl9Db252ZXhSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFhvPXQuX2ViX0NvbnZleFJlc3VsdENhbGxiYWNrX19fZGVzdHJveV9fXzA9dC5hc20ucmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVW89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9zZXRMb2NhbFNjYWxpbmdfMT1mdW5jdGlvbigpe3JldHVybihVbz10Ll9lYl9idENvbGxpc2lvblNoYXBlX3NldExvY2FsU2NhbGluZ18xPXQuYXNtLnNhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEdvPXQuX2ViX2J0Q29sbGlzaW9uU2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oR289dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9nZXRMb2NhbFNjYWxpbmdfMD10LmFzbS50YSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxObz10Ll9lYl9idENvbGxpc2lvblNoYXBlX2NhbGN1bGF0ZUxvY2FsSW5lcnRpYV8yPWZ1bmN0aW9uKCl7cmV0dXJuKE5vPXQuX2ViX2J0Q29sbGlzaW9uU2hhcGVfY2FsY3VsYXRlTG9jYWxJbmVydGlhXzI9dC5hc20udWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sem89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9zZXRNYXJnaW5fMT1mdW5jdGlvbigpe3JldHVybih6bz10Ll9lYl9idENvbGxpc2lvblNoYXBlX3NldE1hcmdpbl8xPXQuYXNtLnZhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHFvPXQuX2ViX2J0Q29sbGlzaW9uU2hhcGVfZ2V0TWFyZ2luXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocW89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9nZXRNYXJnaW5fMD10LmFzbS53YSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxabz10Ll9lYl9idENvbGxpc2lvblNoYXBlX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oWm89dC5fZWJfYnRDb2xsaXNpb25TaGFwZV9fX2Rlc3Ryb3lfX18wPXQuYXNtLnhhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEtvPXQuX2ViX2J0RGlzcGF0Y2hlcl9nZXROdW1NYW5pZm9sZHNfMD1mdW5jdGlvbigpe3JldHVybihLbz10Ll9lYl9idERpc3BhdGNoZXJfZ2V0TnVtTWFuaWZvbGRzXzA9dC5hc20ueWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sJG89dC5fZWJfYnREaXNwYXRjaGVyX2dldE1hbmlmb2xkQnlJbmRleEludGVybmFsXzE9ZnVuY3Rpb24oKXtyZXR1cm4oJG89dC5fZWJfYnREaXNwYXRjaGVyX2dldE1hbmlmb2xkQnlJbmRleEludGVybmFsXzE9dC5hc20uemEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSm89dC5fZWJfYnREaXNwYXRjaGVyX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oSm89dC5fZWJfYnREaXNwYXRjaGVyX19fZGVzdHJveV9fXzA9dC5hc20uQWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdG49dC5fZWJfYnREeW5hbWljc1dvcmxkX2FkZEFjdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKHRuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9hZGRBY3Rpb25fMT10LmFzbS5CYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlbj10Ll9lYl9idER5bmFtaWNzV29ybGRfcmVtb3ZlQWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZW49dC5fZWJfYnREeW5hbWljc1dvcmxkX3JlbW92ZUFjdGlvbl8xPXQuYXNtLkNhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG9uPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9nZXRTb2x2ZXJJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4ob249dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldFNvbHZlckluZm9fMD10LmFzbS5EYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxubj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMT1mdW5jdGlvbigpe3JldHVybihubj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMT10LmFzbS5FYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxybj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMj1mdW5jdGlvbigpe3JldHVybihybj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMj10LmFzbS5GYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfbj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMz1mdW5jdGlvbigpe3JldHVybihfbj10Ll9lYl9idER5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMz10LmFzbS5HYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhbj10Ll9lYl9idER5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hlcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKGFuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9nZXREaXNwYXRjaGVyXzA9dC5hc20uSGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc249dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldFBhaXJDYWNoZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKHNuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9nZXRQYWlyQ2FjaGVfMD10LmFzbS5JYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwbj10Ll9lYl9idER5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocG49dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldERpc3BhdGNoSW5mb18wPXQuYXNtLkphKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9hZGRDb2xsaXNpb25PYmplY3RfMT1mdW5jdGlvbigpe3JldHVybihsbj10Ll9lYl9idER5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20uS2EpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdW49dC5fZWJfYnREeW5hbWljc1dvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8yPWZ1bmN0aW9uKCl7cmV0dXJuKHVuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9hZGRDb2xsaXNpb25PYmplY3RfMj10LmFzbS5MYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxjbj10Ll9lYl9idER5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9ZnVuY3Rpb24oKXtyZXR1cm4oY249dC5fZWJfYnREeW5hbWljc1dvcmxkX2FkZENvbGxpc2lvbk9iamVjdF8zPXQuYXNtLk1hKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHluPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9yZW1vdmVDb2xsaXNpb25PYmplY3RfMT1mdW5jdGlvbigpe3JldHVybih5bj10Ll9lYl9idER5bmFtaWNzV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20uTmEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saG49dC5fZWJfYnREeW5hbWljc1dvcmxkX2dldEJyb2FkcGhhc2VfMD1mdW5jdGlvbigpe3JldHVybihobj10Ll9lYl9idER5bmFtaWNzV29ybGRfZ2V0QnJvYWRwaGFzZV8wPXQuYXNtLk9hKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZuPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9jb252ZXhTd2VlcFRlc3RfNT1mdW5jdGlvbigpe3JldHVybihmbj10Ll9lYl9idER5bmFtaWNzV29ybGRfY29udmV4U3dlZXBUZXN0XzU9dC5hc20uUGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbW49dC5fZWJfYnREeW5hbWljc1dvcmxkX2NvbnRhY3RQYWlyVGVzdF8zPWZ1bmN0aW9uKCl7cmV0dXJuKG1uPXQuX2ViX2J0RHluYW1pY3NXb3JsZF9jb250YWN0UGFpclRlc3RfMz10LmFzbS5RYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxibj10Ll9lYl9idER5bmFtaWNzV29ybGRfY29udGFjdFRlc3RfMj1mdW5jdGlvbigpe3JldHVybihibj10Ll9lYl9idER5bmFtaWNzV29ybGRfY29udGFjdFRlc3RfMj10LmFzbS5SYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxnbj10Ll9lYl9idER5bmFtaWNzV29ybGRfdXBkYXRlU2luZ2xlQWFiYl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGduPXQuX2ViX2J0RHluYW1pY3NXb3JsZF91cGRhdGVTaW5nbGVBYWJiXzE9dC5hc20uU2EpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZG49dC5fZWJfYnREeW5hbWljc1dvcmxkX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZG49dC5fZWJfYnREeW5hbWljc1dvcmxkX19fZGVzdHJveV9fXzA9dC5hc20uVGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sV249dC5fZWJfVm9pZFB0cl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFduPXQuX2ViX1ZvaWRQdHJfX19kZXN0cm95X19fMD10LmFzbS5VYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxDbj10Ll9lYl9idFZlY3RvcjNfYnRWZWN0b3IzXzA9ZnVuY3Rpb24oKXtyZXR1cm4oQ249dC5fZWJfYnRWZWN0b3IzX2J0VmVjdG9yM18wPXQuYXNtLlZhKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGpuPXQuX2ViX2J0VmVjdG9yM19idFZlY3RvcjNfMz1mdW5jdGlvbigpe3JldHVybihqbj10Ll9lYl9idFZlY3RvcjNfYnRWZWN0b3IzXzM9dC5hc20uV2EpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdm49dC5fZWJfYnRWZWN0b3IzX2xlbmd0aF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHZuPXQuX2ViX2J0VmVjdG9yM19sZW5ndGhfMD10LmFzbS5YYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxEbj10Ll9lYl9idFZlY3RvcjNfeF8wPWZ1bmN0aW9uKCl7cmV0dXJuKERuPXQuX2ViX2J0VmVjdG9yM194XzA9dC5hc20uWWEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUm49dC5fZWJfYnRWZWN0b3IzX3lfMD1mdW5jdGlvbigpe3JldHVybihSbj10Ll9lYl9idFZlY3RvcjNfeV8wPXQuYXNtLlphKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFNuPXQuX2ViX2J0VmVjdG9yM196XzA9ZnVuY3Rpb24oKXtyZXR1cm4oU249dC5fZWJfYnRWZWN0b3IzX3pfMD10LmFzbS5fYSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxJbj10Ll9lYl9idFZlY3RvcjNfc2V0WF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEluPXQuX2ViX2J0VmVjdG9yM19zZXRYXzE9dC5hc20uJGEpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT249dC5fZWJfYnRWZWN0b3IzX3NldFlfMT1mdW5jdGlvbigpe3JldHVybihPbj10Ll9lYl9idFZlY3RvcjNfc2V0WV8xPXQuYXNtLmFiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJuPXQuX2ViX2J0VmVjdG9yM19zZXRaXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQm49dC5fZWJfYnRWZWN0b3IzX3NldFpfMT10LmFzbS5iYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQbj10Ll9lYl9idFZlY3RvcjNfc2V0VmFsdWVfMz1mdW5jdGlvbigpe3JldHVybihQbj10Ll9lYl9idFZlY3RvcjNfc2V0VmFsdWVfMz10LmFzbS5jYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx4bj10Ll9lYl9idFZlY3RvcjNfbm9ybWFsaXplXzA9ZnVuY3Rpb24oKXtyZXR1cm4oeG49dC5fZWJfYnRWZWN0b3IzX25vcm1hbGl6ZV8wPXQuYXNtLmRiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRuPXQuX2ViX2J0VmVjdG9yM19yb3RhdGVfMj1mdW5jdGlvbigpe3JldHVybihUbj10Ll9lYl9idFZlY3RvcjNfcm90YXRlXzI9dC5hc20uZWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRm49dC5fZWJfYnRWZWN0b3IzX2RvdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEZuPXQuX2ViX2J0VmVjdG9yM19kb3RfMT10LmFzbS5mYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNbj10Ll9lYl9idFZlY3RvcjNfb3BfbXVsXzE9ZnVuY3Rpb24oKXtyZXR1cm4oTW49dC5fZWJfYnRWZWN0b3IzX29wX211bF8xPXQuYXNtLmdiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEFuPXQuX2ViX2J0VmVjdG9yM19vcF9hZGRfMT1mdW5jdGlvbigpe3JldHVybihBbj10Ll9lYl9idFZlY3RvcjNfb3BfYWRkXzE9dC5hc20uaGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sd249dC5fZWJfYnRWZWN0b3IzX29wX3N1Yl8xPWZ1bmN0aW9uKCl7cmV0dXJuKHduPXQuX2ViX2J0VmVjdG9yM19vcF9zdWJfMT10LmFzbS5pYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrbj10Ll9lYl9idFZlY3RvcjNfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihrbj10Ll9lYl9idFZlY3RvcjNfX19kZXN0cm95X19fMD10LmFzbS5qYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMbj10Ll9lYl9idFF1YXRlcm5pb25fYnRRdWF0ZXJuaW9uXzQ9ZnVuY3Rpb24oKXtyZXR1cm4oTG49dC5fZWJfYnRRdWF0ZXJuaW9uX2J0UXVhdGVybmlvbl80PXQuYXNtLmtiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEhuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRWYWx1ZV80PWZ1bmN0aW9uKCl7cmV0dXJuKEhuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRWYWx1ZV80PXQuYXNtLmxiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFluPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRFdWxlclpZWF8zPWZ1bmN0aW9uKCl7cmV0dXJuKFluPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRFdWxlclpZWF8zPXQuYXNtLm1iKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRSb3RhdGlvbl8yPWZ1bmN0aW9uKCl7cmV0dXJuKFZuPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRSb3RhdGlvbl8yPXQuYXNtLm5iKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFuPXQuX2ViX2J0UXVhdGVybmlvbl9ub3JtYWxpemVfMD1mdW5jdGlvbigpe3JldHVybihRbj10Ll9lYl9idFF1YXRlcm5pb25fbm9ybWFsaXplXzA9dC5hc20ub2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRW49dC5fZWJfYnRRdWF0ZXJuaW9uX2xlbmd0aDJfMD1mdW5jdGlvbigpe3JldHVybihFbj10Ll9lYl9idFF1YXRlcm5pb25fbGVuZ3RoMl8wPXQuYXNtLnBiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFhuPXQuX2ViX2J0UXVhdGVybmlvbl9sZW5ndGhfMD1mdW5jdGlvbigpe3JldHVybihYbj10Ll9lYl9idFF1YXRlcm5pb25fbGVuZ3RoXzA9dC5hc20ucWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVW49dC5fZWJfYnRRdWF0ZXJuaW9uX2RvdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFVuPXQuX2ViX2J0UXVhdGVybmlvbl9kb3RfMT10LmFzbS5yYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHbj10Ll9lYl9idFF1YXRlcm5pb25fbm9ybWFsaXplZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEduPXQuX2ViX2J0UXVhdGVybmlvbl9ub3JtYWxpemVkXzA9dC5hc20uc2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTm49dC5fZWJfYnRRdWF0ZXJuaW9uX2dldEF4aXNfMD1mdW5jdGlvbigpe3JldHVybihObj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QXhpc18wPXQuYXNtLnRiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHpuPXQuX2ViX2J0UXVhdGVybmlvbl9pbnZlcnNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oem49dC5fZWJfYnRRdWF0ZXJuaW9uX2ludmVyc2VfMD10LmFzbS51YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxbj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVfMD1mdW5jdGlvbigpe3JldHVybihxbj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVfMD10LmFzbS52YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxabj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVTaG9ydGVzdFBhdGhfMD1mdW5jdGlvbigpe3JldHVybihabj10Ll9lYl9idFF1YXRlcm5pb25fZ2V0QW5nbGVTaG9ydGVzdFBhdGhfMD10LmFzbS53YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxLbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVfMT1mdW5jdGlvbigpe3JldHVybihLbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVfMT10LmFzbS54YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVTaG9ydGVzdFBhdGhfMT1mdW5jdGlvbigpe3JldHVybigkbj10Ll9lYl9idFF1YXRlcm5pb25fYW5nbGVTaG9ydGVzdFBhdGhfMT10LmFzbS55YikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxKbj10Ll9lYl9idFF1YXRlcm5pb25fb3BfYWRkXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSm49dC5fZWJfYnRRdWF0ZXJuaW9uX29wX2FkZF8xPXQuYXNtLnpiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHRyPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9zdWJfMT1mdW5jdGlvbigpe3JldHVybih0cj10Ll9lYl9idFF1YXRlcm5pb25fb3Bfc3ViXzE9dC5hc20uQWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZXI9dC5fZWJfYnRRdWF0ZXJuaW9uX29wX211bF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGVyPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9tdWxfMT10LmFzbS5CYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvcj10Ll9lYl9idFF1YXRlcm5pb25fb3BfbXVscV8xPWZ1bmN0aW9uKCl7cmV0dXJuKG9yPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9tdWxxXzE9dC5hc20uQ2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbnI9dC5fZWJfYnRRdWF0ZXJuaW9uX29wX2Rpdl8xPWZ1bmN0aW9uKCl7cmV0dXJuKG5yPXQuX2ViX2J0UXVhdGVybmlvbl9vcF9kaXZfMT10LmFzbS5EYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxycj10Ll9lYl9idFF1YXRlcm5pb25feF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHJyPXQuX2ViX2J0UXVhdGVybmlvbl94XzA9dC5hc20uRWIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX3I9dC5fZWJfYnRRdWF0ZXJuaW9uX3lfMD1mdW5jdGlvbigpe3JldHVybihfcj10Ll9lYl9idFF1YXRlcm5pb25feV8wPXQuYXNtLkZiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGlyPXQuX2ViX2J0UXVhdGVybmlvbl96XzA9ZnVuY3Rpb24oKXtyZXR1cm4oaXI9dC5fZWJfYnRRdWF0ZXJuaW9uX3pfMD10LmFzbS5HYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhcj10Ll9lYl9idFF1YXRlcm5pb25fd18wPWZ1bmN0aW9uKCl7cmV0dXJuKGFyPXQuX2ViX2J0UXVhdGVybmlvbl93XzA9dC5hc20uSGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc3I9dC5fZWJfYnRRdWF0ZXJuaW9uX3NldFhfMT1mdW5jdGlvbigpe3JldHVybihzcj10Ll9lYl9idFF1YXRlcm5pb25fc2V0WF8xPXQuYXNtLkliKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHByPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRZXzE9ZnVuY3Rpb24oKXtyZXR1cm4ocHI9dC5fZWJfYnRRdWF0ZXJuaW9uX3NldFlfMT10LmFzbS5KYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxscj10Ll9lYl9idFF1YXRlcm5pb25fc2V0Wl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGxyPXQuX2ViX2J0UXVhdGVybmlvbl9zZXRaXzE9dC5hc20uS2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdXI9dC5fZWJfYnRRdWF0ZXJuaW9uX3NldFdfMT1mdW5jdGlvbigpe3JldHVybih1cj10Ll9lYl9idFF1YXRlcm5pb25fc2V0V18xPXQuYXNtLkxiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNyPXQuX2ViX2J0UXVhdGVybmlvbl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGNyPXQuX2ViX2J0UXVhdGVybmlvbl9fX2Rlc3Ryb3lfX18wPXQuYXNtLk1iKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlyPXQuX2ViX2J0TWF0cml4M3gzX3NldEV1bGVyWllYXzM9ZnVuY3Rpb24oKXtyZXR1cm4oeXI9dC5fZWJfYnRNYXRyaXgzeDNfc2V0RXVsZXJaWVhfMz10LmFzbS5OYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxocj10Ll9lYl9idE1hdHJpeDN4M19nZXRSb3RhdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGhyPXQuX2ViX2J0TWF0cml4M3gzX2dldFJvdGF0aW9uXzE9dC5hc20uT2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZnI9dC5fZWJfYnRNYXRyaXgzeDNfZ2V0Um93XzE9ZnVuY3Rpb24oKXtyZXR1cm4oZnI9dC5fZWJfYnRNYXRyaXgzeDNfZ2V0Um93XzE9dC5hc20uUGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbXI9dC5fZWJfYnRNYXRyaXgzeDNfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihtcj10Ll9lYl9idE1hdHJpeDN4M19fX2Rlc3Ryb3lfX18wPXQuYXNtLlFiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGJyPXQuX2ViX2J0VHJhbnNmb3JtX2J0VHJhbnNmb3JtXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYnI9dC5fZWJfYnRUcmFuc2Zvcm1fYnRUcmFuc2Zvcm1fMD10LmFzbS5SYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxncj10Ll9lYl9idFRyYW5zZm9ybV9idFRyYW5zZm9ybV8yPWZ1bmN0aW9uKCl7cmV0dXJuKGdyPXQuX2ViX2J0VHJhbnNmb3JtX2J0VHJhbnNmb3JtXzI9dC5hc20uU2IpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZHI9dC5fZWJfYnRUcmFuc2Zvcm1fc2V0SWRlbnRpdHlfMD1mdW5jdGlvbigpe3JldHVybihkcj10Ll9lYl9idFRyYW5zZm9ybV9zZXRJZGVudGl0eV8wPXQuYXNtLlRiKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdyPXQuX2ViX2J0VHJhbnNmb3JtX3NldE9yaWdpbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKFdyPXQuX2ViX2J0VHJhbnNmb3JtX3NldE9yaWdpbl8xPXQuYXNtLlViKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LENyPXQuX2ViX2J0VHJhbnNmb3JtX3NldFJvdGF0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQ3I9dC5fZWJfYnRUcmFuc2Zvcm1fc2V0Um90YXRpb25fMT10LmFzbS5WYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxqcj10Ll9lYl9idFRyYW5zZm9ybV9nZXRPcmlnaW5fMD1mdW5jdGlvbigpe3JldHVybihqcj10Ll9lYl9idFRyYW5zZm9ybV9nZXRPcmlnaW5fMD10LmFzbS5XYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx2cj10Ll9lYl9idFRyYW5zZm9ybV9nZXRSb3RhdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKHZyPXQuX2ViX2J0VHJhbnNmb3JtX2dldFJvdGF0aW9uXzA9dC5hc20uWGIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRHI9dC5fZWJfYnRUcmFuc2Zvcm1fZ2V0QmFzaXNfMD1mdW5jdGlvbigpe3JldHVybihEcj10Ll9lYl9idFRyYW5zZm9ybV9nZXRCYXNpc18wPXQuYXNtLlliKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFJyPXQuX2ViX2J0VHJhbnNmb3JtX3NldEZyb21PcGVuR0xNYXRyaXhfMT1mdW5jdGlvbigpe3JldHVybihScj10Ll9lYl9idFRyYW5zZm9ybV9zZXRGcm9tT3BlbkdMTWF0cml4XzE9dC5hc20uWmIpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU3I9dC5fZWJfYnRUcmFuc2Zvcm1faW52ZXJzZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFNyPXQuX2ViX2J0VHJhbnNmb3JtX2ludmVyc2VfMD10LmFzbS5fYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxJcj10Ll9lYl9idFRyYW5zZm9ybV9vcF9tdWxfMT1mdW5jdGlvbigpe3JldHVybihJcj10Ll9lYl9idFRyYW5zZm9ybV9vcF9tdWxfMT10LmFzbS4kYikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxPcj10Ll9lYl9idFRyYW5zZm9ybV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE9yPXQuX2ViX2J0VHJhbnNmb3JtX19fZGVzdHJveV9fXzA9dC5hc20uYWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQnI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfYnREZWZhdWx0TW90aW9uU3RhdGVfMD1mdW5jdGlvbigpe3JldHVybihCcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9idERlZmF1bHRNb3Rpb25TdGF0ZV8wPXQuYXNtLmJjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFByPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX2J0RGVmYXVsdE1vdGlvblN0YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUHI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfYnREZWZhdWx0TW90aW9uU3RhdGVfMT10LmFzbS5jYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx4cj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9idERlZmF1bHRNb3Rpb25TdGF0ZV8yPWZ1bmN0aW9uKCl7cmV0dXJuKHhyPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX2J0RGVmYXVsdE1vdGlvblN0YXRlXzI9dC5hc20uZGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVHI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfZ2V0V29ybGRUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihUcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9nZXRXb3JsZFRyYW5zZm9ybV8xPXQuYXNtLmVjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEZyPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX3NldFdvcmxkVHJhbnNmb3JtXzE9ZnVuY3Rpb24oKXtyZXR1cm4oRnI9dC5fZWJfYnREZWZhdWx0TW90aW9uU3RhdGVfc2V0V29ybGRUcmFuc2Zvcm1fMT10LmFzbS5mYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9nZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMD1mdW5jdGlvbigpe3JldHVybihNcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9nZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMD10LmFzbS5nYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9zZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMT1mdW5jdGlvbigpe3JldHVybihBcj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9zZXRfbV9ncmFwaGljc1dvcmxkVHJhbnNfMT10LmFzbS5oYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3cj10Ll9lYl9idERlZmF1bHRNb3Rpb25TdGF0ZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKHdyPXQuX2ViX2J0RGVmYXVsdE1vdGlvblN0YXRlX19fZGVzdHJveV9fXzA9dC5hc20uaWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa3I9dC5fZWJfYnRDb2xsaXNpb25PYmplY3RXcmFwcGVyX2dldFdvcmxkVHJhbnNmb3JtXzA9ZnVuY3Rpb24oKXtyZXR1cm4oa3I9dC5fZWJfYnRDb2xsaXNpb25PYmplY3RXcmFwcGVyX2dldFdvcmxkVHJhbnNmb3JtXzA9dC5hc20uamMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTHI9dC5fZWJfYnRDb2xsaXNpb25PYmplY3RXcmFwcGVyX2dldENvbGxpc2lvbk9iamVjdF8wPWZ1bmN0aW9uKCl7cmV0dXJuKExyPXQuX2ViX2J0Q29sbGlzaW9uT2JqZWN0V3JhcHBlcl9nZXRDb2xsaXNpb25PYmplY3RfMD10LmFzbS5rYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIcj10Ll9lYl9idENvbGxpc2lvbk9iamVjdFdyYXBwZXJfZ2V0Q29sbGlzaW9uU2hhcGVfMD1mdW5jdGlvbigpe3JldHVybihIcj10Ll9lYl9idENvbGxpc2lvbk9iamVjdFdyYXBwZXJfZ2V0Q29sbGlzaW9uU2hhcGVfMD10LmFzbS5sYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZcj10Ll9lYl9idENvbnN0Q29sbGlzaW9uT2JqZWN0QXJyYXlfc2l6ZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFlyPXQuX2ViX2J0Q29uc3RDb2xsaXNpb25PYmplY3RBcnJheV9zaXplXzA9dC5hc20ubWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X2F0XzE9ZnVuY3Rpb24oKXtyZXR1cm4oVnI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X2F0XzE9dC5hc20ubmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUXI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oUXI9dC5fZWJfYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5X19fZGVzdHJveV9fXzA9dC5hc20ub2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRXI9dC5fZWJfYnRTY2FsYXJBcnJheV9zaXplXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRXI9dC5fZWJfYnRTY2FsYXJBcnJheV9zaXplXzA9dC5hc20ucGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWHI9dC5fZWJfYnRTY2FsYXJBcnJheV9hdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFhyPXQuX2ViX2J0U2NhbGFyQXJyYXlfYXRfMT10LmFzbS5xYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxVcj10Ll9lYl9idFNjYWxhckFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oVXI9dC5fZWJfYnRTY2FsYXJBcnJheV9fX2Rlc3Ryb3lfX18wPXQuYXNtLnJjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEdyPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRQb3NpdGlvbldvcmxkT25BXzA9ZnVuY3Rpb24oKXtyZXR1cm4oR3I9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldFBvc2l0aW9uV29ybGRPbkFfMD10LmFzbS5zYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxOcj10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0UG9zaXRpb25Xb3JsZE9uQl8wPWZ1bmN0aW9uKCl7cmV0dXJuKE5yPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRQb3NpdGlvbldvcmxkT25CXzA9dC5hc20udGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0senI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldEFwcGxpZWRJbXB1bHNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oenI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldEFwcGxpZWRJbXB1bHNlXzA9dC5hc20udWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scXI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldERpc3RhbmNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocXI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldERpc3RhbmNlXzA9dC5hc20udmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRBXzA9ZnVuY3Rpb24oKXtyZXR1cm4oWnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRBXzA9dC5hc20ud2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS3I9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRBXzE9ZnVuY3Rpb24oKXtyZXR1cm4oS3I9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRBXzE9dC5hc20ueGMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sJHI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRCXzA9ZnVuY3Rpb24oKXtyZXR1cm4oJHI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX2xvY2FsUG9pbnRCXzA9dC5hc20ueWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRCXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSnI9dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX2xvY2FsUG9pbnRCXzE9dC5hc20uemMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdF89dC5fZWJfYnRNYW5pZm9sZFBvaW50X2dldF9tX3Bvc2l0aW9uV29ybGRPbkJfMD1mdW5jdGlvbigpe3JldHVybih0Xz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0X21fcG9zaXRpb25Xb3JsZE9uQl8wPXQuYXNtLkFjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGVfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV9wb3NpdGlvbldvcmxkT25CXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZV89dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX3Bvc2l0aW9uV29ybGRPbkJfMT10LmFzbS5CYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0X21fcG9zaXRpb25Xb3JsZE9uQV8wPWZ1bmN0aW9uKCl7cmV0dXJuKG9fPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV9wb3NpdGlvbldvcmxkT25BXzA9dC5hc20uQ2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbl89dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX3Bvc2l0aW9uV29ybGRPbkFfMT1mdW5jdGlvbigpe3JldHVybihuXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfc2V0X21fcG9zaXRpb25Xb3JsZE9uQV8xPXQuYXNtLkRjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV9ub3JtYWxXb3JsZE9uQl8wPWZ1bmN0aW9uKCl7cmV0dXJuKHJfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV9ub3JtYWxXb3JsZE9uQl8wPXQuYXNtLkVjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9fPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV9ub3JtYWxXb3JsZE9uQl8xPWZ1bmN0aW9uKCl7cmV0dXJuKF9fPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV9ub3JtYWxXb3JsZE9uQl8xPXQuYXNtLkZjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGlfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9nZXRfbV91c2VyUGVyc2lzdGVudERhdGFfMD1mdW5jdGlvbigpe3JldHVybihpXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfZ2V0X21fdXNlclBlcnNpc3RlbnREYXRhXzA9dC5hc20uR2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYV89dC5fZWJfYnRNYW5pZm9sZFBvaW50X3NldF9tX3VzZXJQZXJzaXN0ZW50RGF0YV8xPWZ1bmN0aW9uKCl7cmV0dXJuKGFfPXQuX2ViX2J0TWFuaWZvbGRQb2ludF9zZXRfbV91c2VyUGVyc2lzdGVudERhdGFfMT10LmFzbS5IYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxzXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihzXz10Ll9lYl9idE1hbmlmb2xkUG9pbnRfX19kZXN0cm95X19fMD10LmFzbS5JYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwXz10Ll9lYl9Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFja19Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFja18wPWZ1bmN0aW9uKCl7cmV0dXJuKHBfPXQuX2ViX0NvbmNyZXRlQ29udGFjdFJlc3VsdENhbGxiYWNrX0NvbmNyZXRlQ29udGFjdFJlc3VsdENhbGxiYWNrXzA9dC5hc20uSmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbF89dC5fZWJfQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2tfYWRkU2luZ2xlUmVzdWx0Xzc9ZnVuY3Rpb24oKXtyZXR1cm4obF89dC5fZWJfQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2tfYWRkU2luZ2xlUmVzdWx0Xzc9dC5hc20uS2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdV89dC5fZWJfQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2tfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybih1Xz10Ll9lYl9Db25jcmV0ZUNvbnRhY3RSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPXQuYXNtLkxjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX2dldF9tX3NoYXBlUGFydF8wPWZ1bmN0aW9uKCl7cmV0dXJuKGNfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX2dldF9tX3NoYXBlUGFydF8wPXQuYXNtLk1jKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX3NldF9tX3NoYXBlUGFydF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHlfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX3NldF9tX3NoYXBlUGFydF8xPXQuYXNtLk5jKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGhfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX2dldF9tX3RyaWFuZ2xlSW5kZXhfMD1mdW5jdGlvbigpe3JldHVybihoXz10Ll9lYl9Mb2NhbFNoYXBlSW5mb19nZXRfbV90cmlhbmdsZUluZGV4XzA9dC5hc20uT2MpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZl89dC5fZWJfTG9jYWxTaGFwZUluZm9fc2V0X21fdHJpYW5nbGVJbmRleF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGZfPXQuX2ViX0xvY2FsU2hhcGVJbmZvX3NldF9tX3RyaWFuZ2xlSW5kZXhfMT10LmFzbS5QYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtXz10Ll9lYl9Mb2NhbFNoYXBlSW5mb19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKG1fPXQuX2ViX0xvY2FsU2hhcGVJbmZvX19fZGVzdHJveV9fXzA9dC5hc20uUWMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYl89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfTG9jYWxDb252ZXhSZXN1bHRfNT1mdW5jdGlvbigpe3JldHVybihiXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9Mb2NhbENvbnZleFJlc3VsdF81PXQuYXNtLlJjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X2dldF9tX2hpdENvbGxpc2lvbk9iamVjdF8wPWZ1bmN0aW9uKCl7cmV0dXJuKGdfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X2dldF9tX2hpdENvbGxpc2lvbk9iamVjdF8wPXQuYXNtLlNjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGRfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdENvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKGRfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdENvbGxpc2lvbk9iamVjdF8xPXQuYXNtLlRjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X2dldF9tX2xvY2FsU2hhcGVJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4oV189dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21fbG9jYWxTaGFwZUluZm9fMD10LmFzbS5VYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxDXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9zZXRfbV9sb2NhbFNoYXBlSW5mb18xPWZ1bmN0aW9uKCl7cmV0dXJuKENfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2xvY2FsU2hhcGVJbmZvXzE9dC5hc20uVmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sal89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21faGl0Tm9ybWFsTG9jYWxfMD1mdW5jdGlvbigpe3JldHVybihqXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9nZXRfbV9oaXROb3JtYWxMb2NhbF8wPXQuYXNtLldjKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHZfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdE5vcm1hbExvY2FsXzE9ZnVuY3Rpb24oKXtyZXR1cm4odl89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfc2V0X21faGl0Tm9ybWFsTG9jYWxfMT10LmFzbS5YYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxEXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9nZXRfbV9oaXRQb2ludExvY2FsXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRF89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21faGl0UG9pbnRMb2NhbF8wPXQuYXNtLlljKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFJfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdFBvaW50TG9jYWxfMT1mdW5jdGlvbigpe3JldHVybihSXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9zZXRfbV9oaXRQb2ludExvY2FsXzE9dC5hc20uWmMpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU189dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfZ2V0X21faGl0RnJhY3Rpb25fMD1mdW5jdGlvbigpe3JldHVybihTXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9nZXRfbV9oaXRGcmFjdGlvbl8wPXQuYXNtLl9jKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LElfPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X3NldF9tX2hpdEZyYWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSV89dC5fZWJfTG9jYWxDb252ZXhSZXN1bHRfc2V0X21faGl0RnJhY3Rpb25fMT10LmFzbS4kYykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxPXz10Ll9lYl9Mb2NhbENvbnZleFJlc3VsdF9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE9fPXQuX2ViX0xvY2FsQ29udmV4UmVzdWx0X19fZGVzdHJveV9fXzA9dC5hc20uYWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQl89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja18yPWZ1bmN0aW9uKCl7cmV0dXJuKEJfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfMj10LmFzbS5iZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfaGFzSGl0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oUF89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2hhc0hpdF8wPXQuYXNtLmNkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHhfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9oaXRDb2xsaXNpb25PYmplY3RfMD1mdW5jdGlvbigpe3JldHVybih4Xz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0Q29sbGlzaW9uT2JqZWN0XzA9dC5hc20uZGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVF89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2hpdENvbGxpc2lvbk9iamVjdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFRfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9oaXRDb2xsaXNpb25PYmplY3RfMT10LmFzbS5lZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21fY29udmV4RnJvbVdvcmxkXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRl89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbnZleEZyb21Xb3JsZF8wPXQuYXNtLmZkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE1fPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb252ZXhGcm9tV29ybGRfMT1mdW5jdGlvbigpe3JldHVybihNXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29udmV4RnJvbVdvcmxkXzE9dC5hc20uZ2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbnZleFRvV29ybGRfMD1mdW5jdGlvbigpe3JldHVybihBXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21fY29udmV4VG9Xb3JsZF8wPXQuYXNtLmhkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHdfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb252ZXhUb1dvcmxkXzE9ZnVuY3Rpb24oKXtyZXR1cm4od189dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2NvbnZleFRvV29ybGRfMT10LmFzbS5pZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0Tm9ybWFsV29ybGRfMD1mdW5jdGlvbigpe3JldHVybihrXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0Tm9ybWFsV29ybGRfMD10LmFzbS5qZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21faGl0Tm9ybWFsV29ybGRfMT1mdW5jdGlvbigpe3JldHVybihMXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21faGl0Tm9ybWFsV29ybGRfMT10LmFzbS5rZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfZ2V0X21faGl0UG9pbnRXb3JsZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEhfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9oaXRQb2ludFdvcmxkXzA9dC5hc20ubGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2hpdFBvaW50V29ybGRfMT1mdW5jdGlvbigpe3JldHVybihZXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21faGl0UG9pbnRXb3JsZF8xPXQuYXNtLm1kKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPWZ1bmN0aW9uKCl7cmV0dXJuKFZfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPXQuYXNtLm5kKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFFfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPXQuYXNtLm9kKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMD10LmFzbS5wZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY29sbGlzaW9uRmlsdGVyTWFza18xPWZ1bmN0aW9uKCl7cmV0dXJuKFhfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19zZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzE9dC5hc20ucWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVV89dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX2dldF9tX2Nsb3Nlc3RIaXRGcmFjdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFVfPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19nZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb25fMD10LmFzbS5yZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHXz10Ll9lYl9DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2tfc2V0X21fY2xvc2VzdEhpdEZyYWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oR189dC5fZWJfQ2xvc2VzdENvbnZleFJlc3VsdENhbGxiYWNrX3NldF9tX2Nsb3Nlc3RIaXRGcmFjdGlvbl8xPXQuYXNtLnNkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE5fPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKE5fPXQuX2ViX0Nsb3Nlc3RDb252ZXhSZXN1bHRDYWxsYmFja19fX2Rlc3Ryb3lfX18wPXQuYXNtLnRkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHpfPXQuX2ViX2J0Q29udmV4U2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4oel89dC5fZWJfYnRDb252ZXhTaGFwZV9zZXRMb2NhbFNjYWxpbmdfMT10LmFzbS51ZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxXz10Ll9lYl9idENvbnZleFNoYXBlX2dldExvY2FsU2NhbGluZ18wPWZ1bmN0aW9uKCl7cmV0dXJuKHFfPXQuX2ViX2J0Q29udmV4U2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9dC5hc20udmQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWl89dC5fZWJfYnRDb252ZXhTaGFwZV9jYWxjdWxhdGVMb2NhbEluZXJ0aWFfMj1mdW5jdGlvbigpe3JldHVybihaXz10Ll9lYl9idENvbnZleFNoYXBlX2NhbGN1bGF0ZUxvY2FsSW5lcnRpYV8yPXQuYXNtLndkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEtfPXQuX2ViX2J0Q29udmV4U2hhcGVfc2V0TWFyZ2luXzE9ZnVuY3Rpb24oKXtyZXR1cm4oS189dC5fZWJfYnRDb252ZXhTaGFwZV9zZXRNYXJnaW5fMT10LmFzbS54ZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkXz10Ll9lYl9idENvbnZleFNoYXBlX2dldE1hcmdpbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKCRfPXQuX2ViX2J0Q29udmV4U2hhcGVfZ2V0TWFyZ2luXzA9dC5hc20ueWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSl89dC5fZWJfYnRDb252ZXhTaGFwZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKEpfPXQuX2ViX2J0Q29udmV4U2hhcGVfX19kZXN0cm95X19fMD10LmFzbS56ZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0aT10Ll9lYl9idEJveFNoYXBlX2J0Qm94U2hhcGVfMT1mdW5jdGlvbigpe3JldHVybih0aT10Ll9lYl9idEJveFNoYXBlX2J0Qm94U2hhcGVfMT10LmFzbS5BZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlaT10Ll9lYl9idEJveFNoYXBlX3NldE1hcmdpbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGVpPXQuX2ViX2J0Qm94U2hhcGVfc2V0TWFyZ2luXzE9dC5hc20uQmQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sb2k9dC5fZWJfYnRCb3hTaGFwZV9nZXRNYXJnaW5fMD1mdW5jdGlvbigpe3JldHVybihvaT10Ll9lYl9idEJveFNoYXBlX2dldE1hcmdpbl8wPXQuYXNtLkNkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG5pPXQuX2ViX2J0Qm94U2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4obmk9dC5fZWJfYnRCb3hTaGFwZV9zZXRMb2NhbFNjYWxpbmdfMT10LmFzbS5EZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxyaT10Ll9lYl9idEJveFNoYXBlX2dldExvY2FsU2NhbGluZ18wPWZ1bmN0aW9uKCl7cmV0dXJuKHJpPXQuX2ViX2J0Qm94U2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9dC5hc20uRWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX2k9dC5fZWJfYnRCb3hTaGFwZV9jYWxjdWxhdGVMb2NhbEluZXJ0aWFfMj1mdW5jdGlvbigpe3JldHVybihfaT10Ll9lYl9idEJveFNoYXBlX2NhbGN1bGF0ZUxvY2FsSW5lcnRpYV8yPXQuYXNtLkZkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGlpPXQuX2ViX2J0Qm94U2hhcGVfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihpaT10Ll9lYl9idEJveFNoYXBlX19fZGVzdHJveV9fXzA9dC5hc20uR2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYWk9dC5fZWJfYnRJbnRBcnJheV9zaXplXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYWk9dC5fZWJfYnRJbnRBcnJheV9zaXplXzA9dC5hc20uSGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc2k9dC5fZWJfYnRJbnRBcnJheV9hdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHNpPXQuX2ViX2J0SW50QXJyYXlfYXRfMT10LmFzbS5JZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwaT10Ll9lYl9idEludEFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocGk9dC5fZWJfYnRJbnRBcnJheV9fX2Rlc3Ryb3lfX18wPXQuYXNtLkpkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxpPXQuX2ViX2J0RmFjZV9nZXRfbV9pbmRpY2VzXzA9ZnVuY3Rpb24oKXtyZXR1cm4obGk9dC5fZWJfYnRGYWNlX2dldF9tX2luZGljZXNfMD10LmFzbS5LZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx1aT10Ll9lYl9idEZhY2Vfc2V0X21faW5kaWNlc18xPWZ1bmN0aW9uKCl7cmV0dXJuKHVpPXQuX2ViX2J0RmFjZV9zZXRfbV9pbmRpY2VzXzE9dC5hc20uTGQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sY2k9dC5fZWJfYnRGYWNlX2dldF9tX3BsYW5lXzE9ZnVuY3Rpb24oKXtyZXR1cm4oY2k9dC5fZWJfYnRGYWNlX2dldF9tX3BsYW5lXzE9dC5hc20uTWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0seWk9dC5fZWJfYnRGYWNlX3NldF9tX3BsYW5lXzI9ZnVuY3Rpb24oKXtyZXR1cm4oeWk9dC5fZWJfYnRGYWNlX3NldF9tX3BsYW5lXzI9dC5hc20uTmQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saGk9dC5fZWJfYnRGYWNlX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oaGk9dC5fZWJfYnRGYWNlX19fZGVzdHJveV9fXzA9dC5hc20uT2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZmk9dC5fZWJfYnRWZWN0b3IzQXJyYXlfc2l6ZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKGZpPXQuX2ViX2J0VmVjdG9yM0FycmF5X3NpemVfMD10LmFzbS5QZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtaT10Ll9lYl9idFZlY3RvcjNBcnJheV9hdF8xPWZ1bmN0aW9uKCl7cmV0dXJuKG1pPXQuX2ViX2J0VmVjdG9yM0FycmF5X2F0XzE9dC5hc20uUWQpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYmk9dC5fZWJfYnRWZWN0b3IzQXJyYXlfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihiaT10Ll9lYl9idFZlY3RvcjNBcnJheV9fX2Rlc3Ryb3lfX18wPXQuYXNtLlJkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdpPXQuX2ViX2J0RmFjZUFycmF5X3NpemVfMD1mdW5jdGlvbigpe3JldHVybihnaT10Ll9lYl9idEZhY2VBcnJheV9zaXplXzA9dC5hc20uU2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZGk9dC5fZWJfYnRGYWNlQXJyYXlfYXRfMT1mdW5jdGlvbigpe3JldHVybihkaT10Ll9lYl9idEZhY2VBcnJheV9hdF8xPXQuYXNtLlRkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdpPXQuX2ViX2J0RmFjZUFycmF5X19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oV2k9dC5fZWJfYnRGYWNlQXJyYXlfX19kZXN0cm95X19fMD10LmFzbS5VZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxDaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fdmVydGljZXNfMD1mdW5jdGlvbigpe3JldHVybihDaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fdmVydGljZXNfMD10LmFzbS5WZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxqaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fdmVydGljZXNfMT1mdW5jdGlvbigpe3JldHVybihqaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fdmVydGljZXNfMT10LmFzbS5XZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx2aT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fZmFjZXNfMD1mdW5jdGlvbigpe3JldHVybih2aT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fZ2V0X21fZmFjZXNfMD10LmFzbS5YZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxEaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fZmFjZXNfMT1mdW5jdGlvbigpe3JldHVybihEaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fc2V0X21fZmFjZXNfMT10LmFzbS5ZZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxSaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihSaT10Ll9lYl9idENvbnZleFBvbHloZWRyb25fX19kZXN0cm95X19fMD10LmFzbS5aZCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxTaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9idENvbnZleEh1bGxTaGFwZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFNpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2J0Q29udmV4SHVsbFNoYXBlXzA9dC5hc20uX2QpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSWk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfYnRDb252ZXhIdWxsU2hhcGVfMT1mdW5jdGlvbigpe3JldHVybihJaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9idENvbnZleEh1bGxTaGFwZV8xPXQuYXNtLiRkKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE9pPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2J0Q29udmV4SHVsbFNoYXBlXzI9ZnVuY3Rpb24oKXtyZXR1cm4oT2k9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfYnRDb252ZXhIdWxsU2hhcGVfMj10LmFzbS5hZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxCaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9hZGRQb2ludF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEJpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2FkZFBvaW50XzE9dC5hc20uYmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sUGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfYWRkUG9pbnRfMj1mdW5jdGlvbigpe3JldHVybihQaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9hZGRQb2ludF8yPXQuYXNtLmNlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHhpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3NldE1hcmdpbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKHhpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3NldE1hcmdpbl8xPXQuYXNtLmRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldE1hcmdpbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFRpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldE1hcmdpbl8wPXQuYXNtLmVlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEZpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldE51bVZlcnRpY2VzXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRmk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfZ2V0TnVtVmVydGljZXNfMD10LmFzbS5mZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9pbml0aWFsaXplUG9seWhlZHJhbEZlYXR1cmVzXzE9ZnVuY3Rpb24oKXtyZXR1cm4oTWk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfaW5pdGlhbGl6ZVBvbHloZWRyYWxGZWF0dXJlc18xPXQuYXNtLmdlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEFpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3JlY2FsY0xvY2FsQWFiYl8wPWZ1bmN0aW9uKCl7cmV0dXJuKEFpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX3JlY2FsY0xvY2FsQWFiYl8wPXQuYXNtLmhlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHdpPXQuX2ViX2J0Q29udmV4SHVsbFNoYXBlX2dldENvbnZleFBvbHloZWRyb25fMD1mdW5jdGlvbigpe3JldHVybih3aT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9nZXRDb252ZXhQb2x5aGVkcm9uXzA9dC5hc20uaWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa2k9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4oa2k9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfc2V0TG9jYWxTY2FsaW5nXzE9dC5hc20uamUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfZ2V0TG9jYWxTY2FsaW5nXzA9dC5hc20ua2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfY2FsY3VsYXRlTG9jYWxJbmVydGlhXzI9ZnVuY3Rpb24oKXtyZXR1cm4oSGk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfY2FsY3VsYXRlTG9jYWxJbmVydGlhXzI9dC5hc20ubGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWWk9dC5fZWJfYnRDb252ZXhIdWxsU2hhcGVfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihZaT10Ll9lYl9idENvbnZleEh1bGxTaGFwZV9fX2Rlc3Ryb3lfX18wPXQuYXNtLm1lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFZpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm9fYnREZWZhdWx0Q29sbGlzaW9uQ29uc3RydWN0aW9uSW5mb18wPWZ1bmN0aW9uKCl7cmV0dXJuKFZpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm9fYnREZWZhdWx0Q29sbGlzaW9uQ29uc3RydWN0aW9uSW5mb18wPXQuYXNtLm5lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm9fX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihRaT10Ll9lYl9idERlZmF1bHRDb2xsaXNpb25Db25zdHJ1Y3Rpb25JbmZvX19fZGVzdHJveV9fXzA9dC5hc20ub2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRWk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oRWk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzA9dC5hc20ucGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWGk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oWGk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9idERlZmF1bHRDb2xsaXNpb25Db25maWd1cmF0aW9uXzE9dC5hc20ucWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVWk9dC5fZWJfYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFVpPXQuX2ViX2J0RGVmYXVsdENvbGxpc2lvbkNvbmZpZ3VyYXRpb25fX19kZXN0cm95X19fMD10LmFzbS5yZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9idFBlcnNpc3RlbnRNYW5pZm9sZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKEdpPXQuX2ViX2J0UGVyc2lzdGVudE1hbmlmb2xkX2J0UGVyc2lzdGVudE1hbmlmb2xkXzA9dC5hc20uc2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTmk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Qm9keTBfMD1mdW5jdGlvbigpe3JldHVybihOaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9nZXRCb2R5MF8wPXQuYXNtLnRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHppPXQuX2ViX2J0UGVyc2lzdGVudE1hbmlmb2xkX2dldEJvZHkxXzA9ZnVuY3Rpb24oKXtyZXR1cm4oemk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Qm9keTFfMD10LmFzbS51ZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9nZXROdW1Db250YWN0c18wPWZ1bmN0aW9uKCl7cmV0dXJuKHFpPXQuX2ViX2J0UGVyc2lzdGVudE1hbmlmb2xkX2dldE51bUNvbnRhY3RzXzA9dC5hc20udmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWmk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Q29udGFjdFBvaW50XzE9ZnVuY3Rpb24oKXtyZXR1cm4oWmk9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfZ2V0Q29udGFjdFBvaW50XzE9dC5hc20ud2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS2k9dC5fZWJfYnRQZXJzaXN0ZW50TWFuaWZvbGRfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihLaT10Ll9lYl9idFBlcnNpc3RlbnRNYW5pZm9sZF9fX2Rlc3Ryb3lfX18wPXQuYXNtLnhlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LCRpPXQuX2ViX2J0Q29sbGlzaW9uRGlzcGF0Y2hlcl9idENvbGxpc2lvbkRpc3BhdGNoZXJfMT1mdW5jdGlvbigpe3JldHVybigkaT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfYnRDb2xsaXNpb25EaXNwYXRjaGVyXzE9dC5hc20ueWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sSmk9dC5fZWJfYnRDb2xsaXNpb25EaXNwYXRjaGVyX2dldE51bU1hbmlmb2xkc18wPWZ1bmN0aW9uKCl7cmV0dXJuKEppPXQuX2ViX2J0Q29sbGlzaW9uRGlzcGF0Y2hlcl9nZXROdW1NYW5pZm9sZHNfMD10LmFzbS56ZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0YT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWxfMT1mdW5jdGlvbigpe3JldHVybih0YT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWxfMT10LmFzbS5BZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxlYT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihlYT10Ll9lYl9idENvbGxpc2lvbkRpc3BhdGNoZXJfX19kZXN0cm95X19fMD10LmFzbS5CZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvYT10Ll9lYl9idE92ZXJsYXBwaW5nUGFpckNhbGxiYWNrX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4ob2E9dC5fZWJfYnRPdmVybGFwcGluZ1BhaXJDYWxsYmFja19fX2Rlc3Ryb3lfX18wPXQuYXNtLkNlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG5hPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfc2V0SW50ZXJuYWxHaG9zdFBhaXJDYWxsYmFja18xPWZ1bmN0aW9uKCl7cmV0dXJuKG5hPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfc2V0SW50ZXJuYWxHaG9zdFBhaXJDYWxsYmFja18xPXQuYXNtLkRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJhPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfZ2V0TnVtT3ZlcmxhcHBpbmdQYWlyc18wPWZ1bmN0aW9uKCl7cmV0dXJuKHJhPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfZ2V0TnVtT3ZlcmxhcHBpbmdQYWlyc18wPXQuYXNtLkVlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9hPXQuX2ViX2J0T3ZlcmxhcHBpbmdQYWlyQ2FjaGVfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybihfYT10Ll9lYl9idE92ZXJsYXBwaW5nUGFpckNhY2hlX19fZGVzdHJveV9fXzA9dC5hc20uRmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX2dldE92ZXJsYXBwaW5nUGFpckNhY2hlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oaWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX2dldE92ZXJsYXBwaW5nUGFpckNhY2hlXzA9dC5hc20uR2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYWE9dC5fZWJfYnRCcm9hZHBoYXNlSW50ZXJmYWNlX19fZGVzdHJveV9fXzA9dC5hc20uSGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc2E9dC5fZWJfYnRDb2xsaXNpb25Db25maWd1cmF0aW9uX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oc2E9dC5fZWJfYnRDb2xsaXNpb25Db25maWd1cmF0aW9uX19fZGVzdHJveV9fXzA9dC5hc20uSWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scGE9dC5fZWJfYnREYnZ0QnJvYWRwaGFzZV9idERidnRCcm9hZHBoYXNlXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocGE9dC5fZWJfYnREYnZ0QnJvYWRwaGFzZV9idERidnRCcm9hZHBoYXNlXzA9dC5hc20uSmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbGE9dC5fZWJfYnREYnZ0QnJvYWRwaGFzZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGxhPXQuX2ViX2J0RGJ2dEJyb2FkcGhhc2VfX19kZXN0cm95X19fMD10LmFzbS5LZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx1YT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9nZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHVhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X2dldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwXzA9dC5hc20uTGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sY2E9dC5fZWJfYnRCcm9hZHBoYXNlUHJveHlfc2V0X21fY29sbGlzaW9uRmlsdGVyR3JvdXBfMT1mdW5jdGlvbigpe3JldHVybihjYT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cF8xPXQuYXNtLk1lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X2dldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMD1mdW5jdGlvbigpe3JldHVybih5YT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9nZXRfbV9jb2xsaXNpb25GaWx0ZXJNYXNrXzA9dC5hc20uTmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saGE9dC5fZWJfYnRCcm9hZHBoYXNlUHJveHlfc2V0X21fY29sbGlzaW9uRmlsdGVyTWFza18xPWZ1bmN0aW9uKCl7cmV0dXJuKGhhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X3NldF9tX2NvbGxpc2lvbkZpbHRlck1hc2tfMT10LmFzbS5PZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxmYT10Ll9lYl9idEJyb2FkcGhhc2VQcm94eV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGZhPXQuX2ViX2J0QnJvYWRwaGFzZVByb3h5X19fZGVzdHJveV9fXzA9dC5hc20uUGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbWE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb18zPWZ1bmN0aW9uKCl7cmV0dXJuKG1hPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fMz10LmFzbS5RZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxiYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvXzQ9ZnVuY3Rpb24oKXtyZXR1cm4oYmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb180PXQuYXNtLlJlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9saW5lYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZ2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2xpbmVhckRhbXBpbmdfMD10LmFzbS5TZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxkYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fbGluZWFyRGFtcGluZ18xPWZ1bmN0aW9uKCl7cmV0dXJuKGRhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9saW5lYXJEYW1waW5nXzE9dC5hc20uVGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sV2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FuZ3VsYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oV2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FuZ3VsYXJEYW1waW5nXzA9dC5hc20uVWUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQ2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FuZ3VsYXJEYW1waW5nXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQ2E9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FuZ3VsYXJEYW1waW5nXzE9dC5hc20uVmUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0samE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2ZyaWN0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oamE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2ZyaWN0aW9uXzA9dC5hc20uV2UpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2ZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4odmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2ZyaWN0aW9uXzE9dC5hc20uWGUpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRGE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX3JvbGxpbmdGcmljdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKERhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9yb2xsaW5nRnJpY3Rpb25fMD10LmFzbS5ZZSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxSYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fcm9sbGluZ0ZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX3JvbGxpbmdGcmljdGlvbl8xPXQuYXNtLlplKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFNhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9yZXN0aXR1dGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFNhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9yZXN0aXR1dGlvbl8wPXQuYXNtLl9lKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LElhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9yZXN0aXR1dGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKElhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9yZXN0aXR1dGlvbl8xPXQuYXNtLiRlKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE9hPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8wPWZ1bmN0aW9uKCl7cmV0dXJuKE9hPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8wPXQuYXNtLmFmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKEJhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZF8xPXQuYXNtLmJmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFBhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9hbmd1bGFyU2xlZXBpbmdUaHJlc2hvbGRfMD1mdW5jdGlvbigpe3JldHVybihQYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYW5ndWxhclNsZWVwaW5nVGhyZXNob2xkXzA9dC5hc20uY2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0seGE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FuZ3VsYXJTbGVlcGluZ1RocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHhhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9hbmd1bGFyU2xlZXBpbmdUaHJlc2hvbGRfMT10LmFzbS5kZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxUYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdfMD1mdW5jdGlvbigpe3JldHVybihUYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdfMD10LmFzbS5lZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdfMT1mdW5jdGlvbigpe3JldHVybihGYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdfMT10LmFzbS5mZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxNYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMD1mdW5jdGlvbigpe3JldHVybihNYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMD10LmFzbS5nZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMT1mdW5jdGlvbigpe3JldHVybihBYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3JfMT10LmFzbS5oZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx3YT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMD1mdW5jdGlvbigpe3JldHVybih3YT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMD10LmFzbS5qZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxrYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMT1mdW5jdGlvbigpe3JldHVybihrYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXJfMT10LmFzbS5rZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxMYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fZ2V0X21fYWRkaXRpb25hbEFuZ3VsYXJEYW1waW5nVGhyZXNob2xkU3FyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTGE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ1RocmVzaG9sZFNxcl8wPXQuYXNtLmxmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEhhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19zZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdUaHJlc2hvbGRTcXJfMT1mdW5jdGlvbigpe3JldHVybihIYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbEFuZ3VsYXJEYW1waW5nVGhyZXNob2xkU3FyXzE9dC5hc20ubWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWWE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX2dldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3Rvcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKFlhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19nZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdGYWN0b3JfMD10LmFzbS5uZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxWYT10Ll9lYl9idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm9fc2V0X21fYWRkaXRpb25hbEFuZ3VsYXJEYW1waW5nRmFjdG9yXzE9ZnVuY3Rpb24oKXtyZXR1cm4oVmE9dC5fZWJfYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvX3NldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3Rvcl8xPXQuYXNtLm9mKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKFFhPXQuX2ViX2J0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mb19fX2Rlc3Ryb3lfX18wPXQuYXNtLnBmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVhPXQuX2ViX2J0UmlnaWRCb2R5X2J0UmlnaWRCb2R5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oRWE9dC5fZWJfYnRSaWdpZEJvZHlfYnRSaWdpZEJvZHlfMT10LmFzbS5xZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxYYT10Ll9lYl9idFJpZ2lkQm9keV9nZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMD1mdW5jdGlvbigpe3JldHVybihYYT10Ll9lYl9idFJpZ2lkQm9keV9nZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMD10LmFzbS5yZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxVYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMT1mdW5jdGlvbigpe3JldHVybihVYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm1fMT10LmFzbS5zZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRTbGVlcGluZ1RocmVzaG9sZHNfMj1mdW5jdGlvbigpe3JldHVybihHYT10Ll9lYl9idFJpZ2lkQm9keV9zZXRTbGVlcGluZ1RocmVzaG9sZHNfMj10LmFzbS50ZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxOYT10Ll9lYl9idFJpZ2lkQm9keV9nZXRMaW5lYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTmE9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0TGluZWFyRGFtcGluZ18wPXQuYXNtLnVmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHphPXQuX2ViX2J0UmlnaWRCb2R5X2dldEFuZ3VsYXJEYW1waW5nXzA9ZnVuY3Rpb24oKXtyZXR1cm4oemE9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QW5ndWxhckRhbXBpbmdfMD10LmFzbS52ZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxYT10Ll9lYl9idFJpZ2lkQm9keV9zZXREYW1waW5nXzI9ZnVuY3Rpb24oKXtyZXR1cm4ocWE9dC5fZWJfYnRSaWdpZEJvZHlfc2V0RGFtcGluZ18yPXQuYXNtLndmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFphPXQuX2ViX2J0UmlnaWRCb2R5X3NldE1hc3NQcm9wc18yPWZ1bmN0aW9uKCl7cmV0dXJuKFphPXQuX2ViX2J0UmlnaWRCb2R5X3NldE1hc3NQcm9wc18yPXQuYXNtLnhmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEthPXQuX2ViX2J0UmlnaWRCb2R5X2dldExpbmVhckZhY3Rvcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKEthPXQuX2ViX2J0UmlnaWRCb2R5X2dldExpbmVhckZhY3Rvcl8wPXQuYXNtLnlmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LCRhPXQuX2ViX2J0UmlnaWRCb2R5X3NldExpbmVhckZhY3Rvcl8xPWZ1bmN0aW9uKCl7cmV0dXJuKCRhPXQuX2ViX2J0UmlnaWRCb2R5X3NldExpbmVhckZhY3Rvcl8xPXQuYXNtLnpmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEphPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5VG9ycXVlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oSmE9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlUb3JxdWVfMT10LmFzbS5BZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0cz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUxvY2FsVG9ycXVlXzE9ZnVuY3Rpb24oKXtyZXR1cm4odHM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlMb2NhbFRvcnF1ZV8xPXQuYXNtLkJmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGVzPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5Rm9yY2VfMj1mdW5jdGlvbigpe3JldHVybihlcz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUZvcmNlXzI9dC5hc20uQ2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sb3M9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlDZW50cmFsRm9yY2VfMT1mdW5jdGlvbigpe3JldHVybihvcz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUNlbnRyYWxGb3JjZV8xPXQuYXNtLkRmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG5zPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5Q2VudHJhbExvY2FsRm9yY2VfMT1mdW5jdGlvbigpe3JldHVybihucz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUNlbnRyYWxMb2NhbEZvcmNlXzE9dC5hc20uRWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scnM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlUb3JxdWVJbXB1bHNlXzE9ZnVuY3Rpb24oKXtyZXR1cm4ocnM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlUb3JxdWVJbXB1bHNlXzE9dC5hc20uRmYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX3M9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlJbXB1bHNlXzI9ZnVuY3Rpb24oKXtyZXR1cm4oX3M9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlJbXB1bHNlXzI9dC5hc20uR2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saXM9dC5fZWJfYnRSaWdpZEJvZHlfYXBwbHlDZW50cmFsSW1wdWxzZV8xPWZ1bmN0aW9uKCl7cmV0dXJuKGlzPXQuX2ViX2J0UmlnaWRCb2R5X2FwcGx5Q2VudHJhbEltcHVsc2VfMT10LmFzbS5IZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxhcz10Ll9lYl9idFJpZ2lkQm9keV91cGRhdGVJbmVydGlhVGVuc29yXzA9ZnVuY3Rpb24oKXtyZXR1cm4oYXM9dC5fZWJfYnRSaWdpZEJvZHlfdXBkYXRlSW5lcnRpYVRlbnNvcl8wPXQuYXNtLklmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHNzPXQuX2ViX2J0UmlnaWRCb2R5X2dldExpbmVhclZlbG9jaXR5XzA9ZnVuY3Rpb24oKXtyZXR1cm4oc3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0TGluZWFyVmVsb2NpdHlfMD10LmFzbS5KZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRBbmd1bGFyVmVsb2NpdHlfMD1mdW5jdGlvbigpe3JldHVybihwcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRBbmd1bGFyVmVsb2NpdHlfMD10LmFzbS5LZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxscz10Ll9lYl9idFJpZ2lkQm9keV9zZXRMaW5lYXJWZWxvY2l0eV8xPWZ1bmN0aW9uKCl7cmV0dXJuKGxzPXQuX2ViX2J0UmlnaWRCb2R5X3NldExpbmVhclZlbG9jaXR5XzE9dC5hc20uTGYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0QW5ndWxhclZlbG9jaXR5XzE9ZnVuY3Rpb24oKXtyZXR1cm4odXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0QW5ndWxhclZlbG9jaXR5XzE9dC5hc20uTWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sY3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0TW90aW9uU3RhdGVfMD1mdW5jdGlvbigpe3JldHVybihjcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRNb3Rpb25TdGF0ZV8wPXQuYXNtLk5mKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlzPXQuX2ViX2J0UmlnaWRCb2R5X3NldE1vdGlvblN0YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oeXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0TW90aW9uU3RhdGVfMT10LmFzbS5PZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxocz10Ll9lYl9idFJpZ2lkQm9keV9nZXRBbmd1bGFyRmFjdG9yXzA9ZnVuY3Rpb24oKXtyZXR1cm4oaHM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QW5ndWxhckZhY3Rvcl8wPXQuYXNtLlBmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEFuZ3VsYXJGYWN0b3JfMT1mdW5jdGlvbigpe3JldHVybihmcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBbmd1bGFyRmFjdG9yXzE9dC5hc20uUWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sbXM9dC5fZWJfYnRSaWdpZEJvZHlfdXBjYXN0XzE9ZnVuY3Rpb24oKXtyZXR1cm4obXM9dC5fZWJfYnRSaWdpZEJvZHlfdXBjYXN0XzE9dC5hc20uUmYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYnM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QWFiYl8yPWZ1bmN0aW9uKCl7cmV0dXJuKGJzPXQuX2ViX2J0UmlnaWRCb2R5X2dldEFhYmJfMj10LmFzbS5TZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxncz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUdyYXZpdHlfMD1mdW5jdGlvbigpe3JldHVybihncz10Ll9lYl9idFJpZ2lkQm9keV9hcHBseUdyYXZpdHlfMD10LmFzbS5UZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxkcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRHcmF2aXR5XzA9ZnVuY3Rpb24oKXtyZXR1cm4oZHM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0R3Jhdml0eV8wPXQuYXNtLlVmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFdzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEdyYXZpdHlfMT1mdW5jdGlvbigpe3JldHVybihXcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRHcmF2aXR5XzE9dC5hc20uVmYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQ3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QnJvYWRwaGFzZVByb3h5XzA9ZnVuY3Rpb24oKXtyZXR1cm4oQ3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0QnJvYWRwaGFzZVByb3h5XzA9dC5hc20uV2YpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sanM9dC5fZWJfYnRSaWdpZEJvZHlfY2xlYXJGb3JjZXNfMD1mdW5jdGlvbigpe3JldHVybihqcz10Ll9lYl9idFJpZ2lkQm9keV9jbGVhckZvcmNlc18wPXQuYXNtLlhmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHZzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEFuaXNvdHJvcGljRnJpY3Rpb25fMj1mdW5jdGlvbigpe3JldHVybih2cz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBbmlzb3Ryb3BpY0ZyaWN0aW9uXzI9dC5hc20uWWYpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRHM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Q29sbGlzaW9uU2hhcGVfMD1mdW5jdGlvbigpe3JldHVybihEcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRDb2xsaXNpb25TaGFwZV8wPXQuYXNtLlpmKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFJzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUnM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q29udGFjdFByb2Nlc3NpbmdUaHJlc2hvbGRfMT10LmFzbS5fZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxTcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBY3RpdmF0aW9uU3RhdGVfMT1mdW5jdGlvbigpe3JldHVybihTcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRBY3RpdmF0aW9uU3RhdGVfMT10LmFzbS4kZikuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxJcz10Ll9lYl9idFJpZ2lkQm9keV9mb3JjZUFjdGl2YXRpb25TdGF0ZV8xPWZ1bmN0aW9uKCl7cmV0dXJuKElzPXQuX2ViX2J0UmlnaWRCb2R5X2ZvcmNlQWN0aXZhdGlvblN0YXRlXzE9dC5hc20uYWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT3M9dC5fZWJfYnRSaWdpZEJvZHlfYWN0aXZhdGVfMD1mdW5jdGlvbigpe3JldHVybihPcz10Ll9lYl9idFJpZ2lkQm9keV9hY3RpdmF0ZV8wPXQuYXNtLmJnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEJzPXQuX2ViX2J0UmlnaWRCb2R5X2FjdGl2YXRlXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQnM9dC5fZWJfYnRSaWdpZEJvZHlfYWN0aXZhdGVfMT10LmFzbS5jZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQcz10Ll9lYl9idFJpZ2lkQm9keV9pc0FjdGl2ZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFBzPXQuX2ViX2J0UmlnaWRCb2R5X2lzQWN0aXZlXzA9dC5hc20uZGcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0seHM9dC5fZWJfYnRSaWdpZEJvZHlfaXNLaW5lbWF0aWNPYmplY3RfMD1mdW5jdGlvbigpe3JldHVybih4cz10Ll9lYl9idFJpZ2lkQm9keV9pc0tpbmVtYXRpY09iamVjdF8wPXQuYXNtLmVnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRzPXQuX2ViX2J0UmlnaWRCb2R5X2lzU3RhdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oVHM9dC5fZWJfYnRSaWdpZEJvZHlfaXNTdGF0aWNPYmplY3RfMD10LmFzbS5mZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGcz10Ll9lYl9idFJpZ2lkQm9keV9pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0XzA9ZnVuY3Rpb24oKXtyZXR1cm4oRnM9dC5fZWJfYnRSaWdpZEJvZHlfaXNTdGF0aWNPcktpbmVtYXRpY09iamVjdF8wPXQuYXNtLmdnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE1zPXQuX2ViX2J0UmlnaWRCb2R5X2dldFJlc3RpdHV0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oTXM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0UmVzdGl0dXRpb25fMD10LmFzbS5oZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxBcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRGcmljdGlvbl8wPWZ1bmN0aW9uKCl7cmV0dXJuKEFzPXQuX2ViX2J0UmlnaWRCb2R5X2dldEZyaWN0aW9uXzA9dC5hc20uaWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sd3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Um9sbGluZ0ZyaWN0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4od3M9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Um9sbGluZ0ZyaWN0aW9uXzA9dC5hc20uamcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa3M9dC5fZWJfYnRSaWdpZEJvZHlfc2V0UmVzdGl0dXRpb25fMT1mdW5jdGlvbigpe3JldHVybihrcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRSZXN0aXR1dGlvbl8xPXQuYXNtLmtnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LExzPXQuX2ViX2J0UmlnaWRCb2R5X3NldEZyaWN0aW9uXzE9ZnVuY3Rpb24oKXtyZXR1cm4oTHM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0RnJpY3Rpb25fMT10LmFzbS5sZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxIcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRSb2xsaW5nRnJpY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihIcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRSb2xsaW5nRnJpY3Rpb25fMT10LmFzbS5tZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRXb3JsZFRyYW5zZm9ybV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFlzPXQuX2ViX2J0UmlnaWRCb2R5X2dldFdvcmxkVHJhbnNmb3JtXzA9dC5hc20ubmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnM9dC5fZWJfYnRSaWdpZEJvZHlfZ2V0Q29sbGlzaW9uRmxhZ3NfMD1mdW5jdGlvbigpe3JldHVybihWcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRDb2xsaXNpb25GbGFnc18wPXQuYXNtLm9nKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENvbGxpc2lvbkZsYWdzXzE9ZnVuY3Rpb24oKXtyZXR1cm4oUXM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q29sbGlzaW9uRmxhZ3NfMT10LmFzbS5wZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxFcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRXb3JsZFRyYW5zZm9ybV8xPWZ1bmN0aW9uKCl7cmV0dXJuKEVzPXQuX2ViX2J0UmlnaWRCb2R5X3NldFdvcmxkVHJhbnNmb3JtXzE9dC5hc20ucWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWHM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q29sbGlzaW9uU2hhcGVfMT1mdW5jdGlvbigpe3JldHVybihYcz10Ll9lYl9idFJpZ2lkQm9keV9zZXRDb2xsaXNpb25TaGFwZV8xPXQuYXNtLnJnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFVzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENjZE1vdGlvblRocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKFVzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENjZE1vdGlvblRocmVzaG9sZF8xPXQuYXNtLnNnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEdzPXQuX2ViX2J0UmlnaWRCb2R5X3NldENjZFN3ZXB0U3BoZXJlUmFkaXVzXzE9ZnVuY3Rpb24oKXtyZXR1cm4oR3M9dC5fZWJfYnRSaWdpZEJvZHlfc2V0Q2NkU3dlcHRTcGhlcmVSYWRpdXNfMT10LmFzbS50ZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxOcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRVc2VySW5kZXhfMD1mdW5jdGlvbigpe3JldHVybihOcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRVc2VySW5kZXhfMD10LmFzbS51ZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx6cz10Ll9lYl9idFJpZ2lkQm9keV9zZXRVc2VySW5kZXhfMT1mdW5jdGlvbigpe3JldHVybih6cz10Ll9lYl9idFJpZ2lkQm9keV9zZXRVc2VySW5kZXhfMT10LmFzbS52ZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxxcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRVc2VyUG9pbnRlcl8wPWZ1bmN0aW9uKCl7cmV0dXJuKHFzPXQuX2ViX2J0UmlnaWRCb2R5X2dldFVzZXJQb2ludGVyXzA9dC5hc20ud2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnM9dC5fZWJfYnRSaWdpZEJvZHlfc2V0VXNlclBvaW50ZXJfMT1mdW5jdGlvbigpe3JldHVybihacz10Ll9lYl9idFJpZ2lkQm9keV9zZXRVc2VyUG9pbnRlcl8xPXQuYXNtLnhnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEtzPXQuX2ViX2J0UmlnaWRCb2R5X2dldEJyb2FkcGhhc2VIYW5kbGVfMD1mdW5jdGlvbigpe3JldHVybihLcz10Ll9lYl9idFJpZ2lkQm9keV9nZXRCcm9hZHBoYXNlSGFuZGxlXzA9dC5hc20ueWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sJHM9dC5fZWJfYnRSaWdpZEJvZHlfX19kZXN0cm95X19fMD1mdW5jdGlvbigpe3JldHVybigkcz10Ll9lYl9idFJpZ2lkQm9keV9fX2Rlc3Ryb3lfX18wPXQuYXNtLnpnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEpzPXQuX2ViX2J0U2VxdWVudGlhbEltcHVsc2VDb25zdHJhaW50U29sdmVyX2J0U2VxdWVudGlhbEltcHVsc2VDb25zdHJhaW50U29sdmVyXzA9ZnVuY3Rpb24oKXtyZXR1cm4oSnM9dC5fZWJfYnRTZXF1ZW50aWFsSW1wdWxzZUNvbnN0cmFpbnRTb2x2ZXJfYnRTZXF1ZW50aWFsSW1wdWxzZUNvbnN0cmFpbnRTb2x2ZXJfMD10LmFzbS5BZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0cD10Ll9lYl9idFNlcXVlbnRpYWxJbXB1bHNlQ29uc3RyYWludFNvbHZlcl9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKHRwPXQuX2ViX2J0U2VxdWVudGlhbEltcHVsc2VDb25zdHJhaW50U29sdmVyX19fZGVzdHJveV9fXzA9dC5hc20uQmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZXA9dC5fZWJfYnRDb25zdHJhaW50U29sdmVyX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZXA9dC5fZWJfYnRDb25zdHJhaW50U29sdmVyX19fZGVzdHJveV9fXzA9dC5hc20uQ2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sb3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV90aW1lU3RlcF8wPWZ1bmN0aW9uKCl7cmV0dXJuKG9wPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdGltZVN0ZXBfMD10LmFzbS5EZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxucD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3RpbWVTdGVwXzE9ZnVuY3Rpb24oKXtyZXR1cm4obnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV90aW1lU3RlcF8xPXQuYXNtLkVnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHJwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fc3RlcENvdW50XzA9ZnVuY3Rpb24oKXtyZXR1cm4ocnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9zdGVwQ291bnRfMD10LmFzbS5GZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3N0ZXBDb3VudF8xPWZ1bmN0aW9uKCl7cmV0dXJuKF9wPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fc3RlcENvdW50XzE9dC5hc20uR2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saXA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9kaXNwYXRjaEZ1bmNfMD1mdW5jdGlvbigpe3JldHVybihpcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX2Rpc3BhdGNoRnVuY18wPXQuYXNtLkhnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGFwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fZGlzcGF0Y2hGdW5jXzE9ZnVuY3Rpb24oKXtyZXR1cm4oYXA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV9kaXNwYXRjaEZ1bmNfMT10LmFzbS5JZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxzcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX3RpbWVPZkltcGFjdF8wPWZ1bmN0aW9uKCl7cmV0dXJuKHNwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdGltZU9mSW1wYWN0XzA9dC5hc20uSmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scHA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV90aW1lT2ZJbXBhY3RfMT1mdW5jdGlvbigpe3JldHVybihwcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3RpbWVPZkltcGFjdF8xPXQuYXNtLktnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGxwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdXNlQ29udGludW91c18wPWZ1bmN0aW9uKCl7cmV0dXJuKGxwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdXNlQ29udGludW91c18wPXQuYXNtLkxnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHVwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fdXNlQ29udGludW91c18xPWZ1bmN0aW9uKCl7cmV0dXJuKHVwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fdXNlQ29udGludW91c18xPXQuYXNtLk1nKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fZW5hYmxlU2F0Q29udmV4XzA9ZnVuY3Rpb24oKXtyZXR1cm4oY3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9lbmFibGVTYXRDb252ZXhfMD10LmFzbS5OZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx5cD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX2VuYWJsZVNhdENvbnZleF8xPWZ1bmN0aW9uKCl7cmV0dXJuKHlwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fZW5hYmxlU2F0Q29udmV4XzE9dC5hc20uT2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saHA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9lbmFibGVTUFVfMD1mdW5jdGlvbigpe3JldHVybihocD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX2VuYWJsZVNQVV8wPXQuYXNtLlBnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fZW5hYmxlU1BVXzE9ZnVuY3Rpb24oKXtyZXR1cm4oZnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV9lbmFibGVTUFVfMT10LmFzbS5RZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxtcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX3VzZUVwYV8wPWZ1bmN0aW9uKCl7cmV0dXJuKG1wPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fdXNlRXBhXzA9dC5hc20uUmcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYnA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV91c2VFcGFfMT1mdW5jdGlvbigpe3JldHVybihicD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX3VzZUVwYV8xPXQuYXNtLlNnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGdwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fZ2V0X21fYWxsb3dlZENjZFBlbmV0cmF0aW9uXzA9ZnVuY3Rpb24oKXtyZXR1cm4oZ3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9hbGxvd2VkQ2NkUGVuZXRyYXRpb25fMD10LmFzbS5UZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxkcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX2FsbG93ZWRDY2RQZW5ldHJhdGlvbl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGRwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fYWxsb3dlZENjZFBlbmV0cmF0aW9uXzE9dC5hc20uVWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sV3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWxfMD1mdW5jdGlvbigpe3JldHVybihXcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX3VzZUNvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVXRpbF8wPXQuYXNtLlZnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LENwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fdXNlQ29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VVdGlsXzE9ZnVuY3Rpb24oKXtyZXR1cm4oQ3A9dC5fZWJfYnREaXNwYXRjaGVySW5mb19zZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWxfMT10LmFzbS5XZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxqcD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX2dldF9tX2NvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVGhyZXNob2xkXzA9ZnVuY3Rpb24oKXtyZXR1cm4oanA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19nZXRfbV9jb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVRocmVzaG9sZF8wPXQuYXNtLlhnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHZwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fc2V0X21fY29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VUaHJlc2hvbGRfMT1mdW5jdGlvbigpe3JldHVybih2cD10Ll9lYl9idERpc3BhdGNoZXJJbmZvX3NldF9tX2NvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVGhyZXNob2xkXzE9dC5hc20uWWcpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sRHA9dC5fZWJfYnREaXNwYXRjaGVySW5mb19fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKERwPXQuX2ViX2J0RGlzcGF0Y2hlckluZm9fX19kZXN0cm95X19fMD10LmFzbS5aZykuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxScD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX3NwbGl0SW1wdWxzZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKFJwPXQuX2ViX2J0Q29udGFjdFNvbHZlckluZm9fZ2V0X21fc3BsaXRJbXB1bHNlXzA9dC5hc20uX2cpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sU3A9dC5fZWJfYnRDb250YWN0U29sdmVySW5mb19zZXRfbV9zcGxpdEltcHVsc2VfMT1mdW5jdGlvbigpe3JldHVybihTcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX3NldF9tX3NwbGl0SW1wdWxzZV8xPXQuYXNtLiRnKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LElwPXQuX2ViX2J0Q29udGFjdFNvbHZlckluZm9fZ2V0X21fc3BsaXRJbXB1bHNlUGVuZXRyYXRpb25UaHJlc2hvbGRfMD1mdW5jdGlvbigpe3JldHVybihJcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX3NwbGl0SW1wdWxzZVBlbmV0cmF0aW9uVGhyZXNob2xkXzA9dC5hc20uYWgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sT3A9dC5fZWJfYnRDb250YWN0U29sdmVySW5mb19zZXRfbV9zcGxpdEltcHVsc2VQZW5ldHJhdGlvblRocmVzaG9sZF8xPWZ1bmN0aW9uKCl7cmV0dXJuKE9wPXQuX2ViX2J0Q29udGFjdFNvbHZlckluZm9fc2V0X21fc3BsaXRJbXB1bHNlUGVuZXRyYXRpb25UaHJlc2hvbGRfMT10LmFzbS5iaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxCcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX251bUl0ZXJhdGlvbnNfMD1mdW5jdGlvbigpe3JldHVybihCcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX2dldF9tX251bUl0ZXJhdGlvbnNfMD10LmFzbS5jaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxQcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX3NldF9tX251bUl0ZXJhdGlvbnNfMT1mdW5jdGlvbigpe3JldHVybihQcD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX3NldF9tX251bUl0ZXJhdGlvbnNfMT10LmFzbS5kaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx4cD10Ll9lYl9idENvbnRhY3RTb2x2ZXJJbmZvX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oeHA9dC5fZWJfYnRDb250YWN0U29sdmVySW5mb19fX2Rlc3Ryb3lfX18wPXQuYXNtLmVoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFRwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkXzQ9ZnVuY3Rpb24oKXtyZXR1cm4oVHA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfND10LmFzbS5maCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxGcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRHcmF2aXR5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oRnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0R3Jhdml0eV8xPXQuYXNtLmdoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LE1wPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2dldEdyYXZpdHlfMD1mdW5jdGlvbigpe3JldHVybihNcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9nZXRHcmF2aXR5XzA9dC5hc20uaGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sQXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oQXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzE9dC5hc20uaWgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sd3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzM9ZnVuY3Rpb24oKXtyZXR1cm4od3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkUmlnaWRCb2R5XzM9dC5hc20uamgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sa3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlUmlnaWRCb2R5XzE9ZnVuY3Rpb24oKXtyZXR1cm4oa3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlUmlnaWRCb2R5XzE9dC5hc20ua2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTHA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc3RlcFNpbXVsYXRpb25fMT1mdW5jdGlvbigpe3JldHVybihMcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zdGVwU2ltdWxhdGlvbl8xPXQuYXNtLmxoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEhwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3N0ZXBTaW11bGF0aW9uXzI9ZnVuY3Rpb24oKXtyZXR1cm4oSHA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc3RlcFNpbXVsYXRpb25fMj10LmFzbS5taCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxZcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zdGVwU2ltdWxhdGlvbl8zPWZ1bmN0aW9uKCl7cmV0dXJuKFlwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3N0ZXBTaW11bGF0aW9uXzM9dC5hc20ubmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0Q29udGFjdEFkZGVkQ2FsbGJhY2tfMT1mdW5jdGlvbigpe3JldHVybihWcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRDb250YWN0QWRkZWRDYWxsYmFja18xPXQuYXNtLm9oKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFFwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3RQcm9jZXNzZWRDYWxsYmFja18xPWZ1bmN0aW9uKCl7cmV0dXJuKFFwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3RQcm9jZXNzZWRDYWxsYmFja18xPXQuYXNtLnBoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEVwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3REZXN0cm95ZWRDYWxsYmFja18xPWZ1bmN0aW9uKCl7cmV0dXJuKEVwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldENvbnRhY3REZXN0cm95ZWRDYWxsYmFja18xPXQuYXNtLnFoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LFhwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2dldERpc3BhdGNoZXJfMD1mdW5jdGlvbigpe3JldHVybihYcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9nZXREaXNwYXRjaGVyXzA9dC5hc20ucmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0UGFpckNhY2hlXzA9ZnVuY3Rpb24oKXtyZXR1cm4oVXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0UGFpckNhY2hlXzA9dC5hc20uc2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sR3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4oR3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0RGlzcGF0Y2hJbmZvXzA9dC5hc20udGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sTnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9ZnVuY3Rpb24oKXtyZXR1cm4oTnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20udWgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0senA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzI9ZnVuY3Rpb24oKXtyZXR1cm4oenA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzI9dC5hc20udmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9ZnVuY3Rpb24oKXtyZXR1cm4ocXA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfYWRkQ29sbGlzaW9uT2JqZWN0XzM9dC5hc20ud2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9ZnVuY3Rpb24oKXtyZXR1cm4oWnA9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfcmVtb3ZlQ29sbGlzaW9uT2JqZWN0XzE9dC5hc20ueGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS3A9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0QnJvYWRwaGFzZV8wPWZ1bmN0aW9uKCl7cmV0dXJuKEtwPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2dldEJyb2FkcGhhc2VfMD10LmFzbS55aCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSwkcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb252ZXhTd2VlcFRlc3RfNT1mdW5jdGlvbigpe3JldHVybigkcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb252ZXhTd2VlcFRlc3RfNT10LmFzbS56aCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxKcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb250YWN0UGFpclRlc3RfMz1mdW5jdGlvbigpe3JldHVybihKcD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb250YWN0UGFpclRlc3RfMz10LmFzbS5BaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0bD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9jb250YWN0VGVzdF8yPWZ1bmN0aW9uKCl7cmV0dXJuKHRsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX2NvbnRhY3RUZXN0XzI9dC5hc20uQmgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZWw9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfdXBkYXRlU2luZ2xlQWFiYl8xPWZ1bmN0aW9uKCl7cmV0dXJuKGVsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3VwZGF0ZVNpbmdsZUFhYmJfMT10LmFzbS5DaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9hZGRBY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihvbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9hZGRBY3Rpb25fMT10LmFzbS5EaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxubD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9yZW1vdmVBY3Rpb25fMT1mdW5jdGlvbigpe3JldHVybihubD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9yZW1vdmVBY3Rpb25fMT10LmFzbS5FaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxybD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9nZXRTb2x2ZXJJbmZvXzA9ZnVuY3Rpb24oKXtyZXR1cm4ocmw9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfZ2V0U29sdmVySW5mb18wPXQuYXNtLkZoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9sPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldEludGVybmFsVGlja0NhbGxiYWNrXzE9ZnVuY3Rpb24oKXtyZXR1cm4oX2w9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMT10LmFzbS5HaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxpbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRJbnRlcm5hbFRpY2tDYWxsYmFja18yPWZ1bmN0aW9uKCl7cmV0dXJuKGlsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX3NldEludGVybmFsVGlja0NhbGxiYWNrXzI9dC5hc20uSGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYWw9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2tfMz1mdW5jdGlvbigpe3JldHVybihhbD10Ll9lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9zZXRJbnRlcm5hbFRpY2tDYWxsYmFja18zPXQuYXNtLkloKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHNsPXQuX2ViX2J0RGlzY3JldGVEeW5hbWljc1dvcmxkX19fZGVzdHJveV9fXzA9ZnVuY3Rpb24oKXtyZXR1cm4oc2w9dC5fZWJfYnREaXNjcmV0ZUR5bmFtaWNzV29ybGRfX19kZXN0cm95X19fMD10LmFzbS5KaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxwbD10Ll9lYl9idEFjdGlvbkludGVyZmFjZV91cGRhdGVBY3Rpb25fMj1mdW5jdGlvbigpe3JldHVybihwbD10Ll9lYl9idEFjdGlvbkludGVyZmFjZV91cGRhdGVBY3Rpb25fMj10LmFzbS5LaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxsbD10Ll9lYl9idEFjdGlvbkludGVyZmFjZV9fX2Rlc3Ryb3lfX18wPWZ1bmN0aW9uKCl7cmV0dXJuKGxsPXQuX2ViX2J0QWN0aW9uSW50ZXJmYWNlX19fZGVzdHJveV9fXzA9dC5hc20uTGgpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sdWw9dC5fZW1zY3JpcHRlbl9lbnVtX1BIWV9TY2FsYXJUeXBlX1BIWV9GTE9BVD1mdW5jdGlvbigpe3JldHVybih1bD10Ll9lbXNjcmlwdGVuX2VudW1fUEhZX1NjYWxhclR5cGVfUEhZX0ZMT0FUPXQuYXNtLk1oKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGNsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRE9VQkxFPWZ1bmN0aW9uKCl7cmV0dXJuKGNsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRE9VQkxFPXQuYXNtLk5oKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHlsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfSU5URUdFUj1mdW5jdGlvbigpe3JldHVybih5bD10Ll9lbXNjcmlwdGVuX2VudW1fUEhZX1NjYWxhclR5cGVfUEhZX0lOVEVHRVI9dC5hc20uT2gpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0saGw9dC5fZW1zY3JpcHRlbl9lbnVtX1BIWV9TY2FsYXJUeXBlX1BIWV9TSE9SVD1mdW5jdGlvbigpe3JldHVybihobD10Ll9lbXNjcmlwdGVuX2VudW1fUEhZX1NjYWxhclR5cGVfUEhZX1NIT1JUPXQuYXNtLlBoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGZsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRklYRURQT0lOVDg4PWZ1bmN0aW9uKCl7cmV0dXJuKGZsPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfRklYRURQT0lOVDg4PXQuYXNtLlFoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG1sPXQuX2Vtc2NyaXB0ZW5fZW51bV9QSFlfU2NhbGFyVHlwZV9QSFlfVUNIQVI9ZnVuY3Rpb24oKXtyZXR1cm4obWw9dC5fZW1zY3JpcHRlbl9lbnVtX1BIWV9TY2FsYXJUeXBlX1BIWV9VQ0hBUj10LmFzbS5SaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfTt0Ll9tYWxsb2M9ZnVuY3Rpb24oKXtyZXR1cm4odC5fbWFsbG9jPXQuYXNtLlNoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHQuX2ZyZWU9ZnVuY3Rpb24oKXtyZXR1cm4odC5fZnJlZT10LmFzbS5UaCkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSx0LmR5bkNhbGxfdmk9ZnVuY3Rpb24oKXtyZXR1cm4odC5keW5DYWxsX3ZpPXQuYXNtLlVoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHQuZHluQ2FsbF92PWZ1bmN0aW9uKCl7cmV0dXJuKHQuZHluQ2FsbF92PXQuYXNtLlZoKS5hcHBseShudWxsLGFyZ3VtZW50cyl9LHQuYWRkRnVuY3Rpb249ZnVuY3Rpb24oZSxvKXtpZighQnQpe0J0PW5ldyBXZWFrTWFwO2Zvcih2YXIgbj0wO248V3QubGVuZ3RoO24rKyl7dmFyIHI9V3QuZ2V0KG4pO3ImJkJ0LnNldChyLG4pfX1pZihCdC5oYXMoZSkpZT1CdC5nZXQoZSk7ZWxzZXtpZihlZS5sZW5ndGgpbj1lZS5wb3AoKTtlbHNle249V3QubGVuZ3RoO3RyeXtXdC5ncm93KDEpfWNhdGNoKHl0KXt0aHJvdyB5dCBpbnN0YW5jZW9mIFJhbmdlRXJyb3I/IlVuYWJsZSB0byBncm93IHdhc20gdGFibGUuIFNldCBBTExPV19UQUJMRV9HUk9XVEguIjp5dH19dHJ5e1d0LnNldChuLGUpfWNhdGNoKHl0KXtpZighKHl0IGluc3RhbmNlb2YgVHlwZUVycm9yKSl0aHJvdyB5dDtpZih0eXBlb2YgV2ViQXNzZW1ibHkuRnVuY3Rpb249PSJmdW5jdGlvbiIpe3ZhciBjPXtpOiJpMzIiLGo6Imk2NCIsZjoiZjMyIixkOiJmNjQifSxEPXtwYXJhbWV0ZXJzOltdLHJlc3VsdHM6b1swXT09InYiP1tdOltjW29bMF1dXX07Zm9yKHI9MTtyPG8ubGVuZ3RoOysrcilELnBhcmFtZXRlcnMucHVzaChjW29bcl1dKTtvPW5ldyBXZWJBc3NlbWJseS5GdW5jdGlvbihELGUpfWVsc2V7Yz1bMSwwLDEsOTZdLEQ9by5zbGljZSgwLDEpLG89by5zbGljZSgxKTt2YXIgTj17aToxMjcsajoxMjYsZjoxMjUsZDoxMjR9O2ZvcihjLnB1c2goby5sZW5ndGgpLHI9MDtyPG8ubGVuZ3RoOysrciljLnB1c2goTltvW3JdXSk7RD09InYiP2MucHVzaCgwKTpjPWMuY29uY2F0KFsxLE5bRF1dKSxjWzFdPWMubGVuZ3RoLTIsbz1uZXcgVWludDhBcnJheShbMCw5NywxMTUsMTA5LDEsMCwwLDBdLmNvbmNhdChjLFsyLDcsMSwxLDEwMSwxLDEwMiwwLDAsNyw1LDEsMSwxMDIsMCwwXSkpLG89bmV3IFdlYkFzc2VtYmx5Lk1vZHVsZShvKSxvPW5ldyBXZWJBc3NlbWJseS5JbnN0YW5jZShvLHtlOntmOmV9fSkuZXhwb3J0cy5mfVd0LnNldChuLG8pfUJ0LnNldChlLG4pLGU9bn1yZXR1cm4gZX07dmFyIGllO3F0PWZ1bmN0aW9uIGUoKXtpZXx8V2UoKSxpZXx8KHF0PWUpfTtmdW5jdGlvbiBXZSgpe2Z1bmN0aW9uIGUoKXtpZighaWUmJihpZT0hMCx0LmNhbGxlZFJ1bj0hMCwhb2UpKXtpZihPZT0hMCxVdChfZSksVXQoVnQpLG0odCksdC5vblJ1bnRpbWVJbml0aWFsaXplZCYmdC5vblJ1bnRpbWVJbml0aWFsaXplZCgpLHQucG9zdFJ1bilmb3IodHlwZW9mIHQucG9zdFJ1bj09ImZ1bmN0aW9uIiYmKHQucG9zdFJ1bj1bdC5wb3N0UnVuXSk7dC5wb3N0UnVuLmxlbmd0aDspe3ZhciBvPXQucG9zdFJ1bi5zaGlmdCgpO0llLnVuc2hpZnQobyl9VXQoSWUpfX1pZighKDA8UXQpKXtpZih0LnByZVJ1bilmb3IodHlwZW9mIHQucHJlUnVuPT0iZnVuY3Rpb24iJiYodC5wcmVSdW49W3QucHJlUnVuXSk7dC5wcmVSdW4ubGVuZ3RoOylPbCgpO1V0KHJlKSwwPFF0fHwodC5zZXRTdGF0dXM/KHQuc2V0U3RhdHVzKCJSdW5uaW5nLi4uIiksc2V0VGltZW91dChmdW5jdGlvbigpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnNldFN0YXR1cygiIil9LDEpLGUoKX0sMSkpOmUoKSl9fWlmKHQucnVuPVdlLHQucHJlSW5pdClmb3IodHlwZW9mIHQucHJlSW5pdD09ImZ1bmN0aW9uIiYmKHQucHJlSW5pdD1bdC5wcmVJbml0XSk7MDx0LnByZUluaXQubGVuZ3RoOyl0LnByZUluaXQucG9wKCkoKTtXZSgpO2Z1bmN0aW9uIGIoKXt9Yi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksYi5wcm90b3R5cGUuY29uc3RydWN0b3I9YixiLnByb3RvdHlwZS5YaD1iLGIuWWg9e30sdC5XcmFwcGVyT2JqZWN0PWI7ZnVuY3Rpb24gQShlKXtyZXR1cm4oZXx8YikuWWh9dC5nZXRDYWNoZT1BO2Z1bmN0aW9uIGEoZSxvKXt2YXIgbj1BKG8pLHI9bltlXTtyZXR1cm4gcnx8KHI9T2JqZWN0LmNyZWF0ZSgob3x8YikucHJvdG90eXBlKSxyLldoPWUsbltlXT1yKX10LndyYXBQb2ludGVyPWEsdC5jYXN0T2JqZWN0PWZ1bmN0aW9uKGUsbyl7cmV0dXJuIGEoZS5XaCxvKX0sdC5OVUxMPWEoMCksdC5kZXN0cm95PWZ1bmN0aW9uKGUpe2lmKCFlLl9fZGVzdHJveV9fKXRocm93IkVycm9yOiBDYW5ub3QgZGVzdHJveSBvYmplY3QuIChEaWQgeW91IGNyZWF0ZSBpdCB5b3Vyc2VsZj8pIjtlLl9fZGVzdHJveV9fKCksZGVsZXRlIEEoZS5YaClbZS5XaF19LHQuY29tcGFyZT1mdW5jdGlvbihlLG8pe3JldHVybiBlLldoPT09by5XaH0sdC5nZXRQb2ludGVyPWZ1bmN0aW9uKGUpe3JldHVybiBlLldofSx0LmdldENsYXNzPWZ1bmN0aW9uKGUpe3JldHVybiBlLlhofTt2YXIgRXQ9MCxhZT0wLHNlPTAscGU9W10sbGU9MDtmdW5jdGlvbiBDZSgpe2lmKGxlKXtmb3IodmFyIGU9MDtlPHBlLmxlbmd0aDtlKyspdC5fZnJlZShwZVtlXSk7cGUubGVuZ3RoPTAsdC5fZnJlZShFdCksRXQ9MCxhZSs9bGUsbGU9MH1FdHx8KGFlKz0xMjgsRXQ9dC5fbWFsbG9jKGFlKSxMdChFdCkpLHNlPTB9ZnVuY3Rpb24gYmwoZSl7aWYodHlwZW9mIGU9PSJvYmplY3QiKXtMdChFdCk7dmFyIG89ZS5sZW5ndGgqWHQuQllURVNfUEVSX0VMRU1FTlQ7aWYobz1vKzcmLTgsc2Urbz49YWUpe0x0KDA8byksbGUrPW87dmFyIG49dC5fbWFsbG9jKG8pO3BlLnB1c2gobil9ZWxzZSBuPUV0K3NlLHNlKz1vO3N3aXRjaChvPW4sbj1vPj4+MCxYdC5CWVRFU19QRVJfRUxFTUVOVCl7Y2FzZSAyOm4+Pj49MTticmVhaztjYXNlIDQ6bj4+Pj0yO2JyZWFrO2Nhc2UgODpuPj4+PTN9Zm9yKHZhciByPTA7cjxlLmxlbmd0aDtyKyspWHRbbityXT1lW3JdO3JldHVybiBvfXJldHVybiBlfWZ1bmN0aW9uIEwoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb2xsaXNpb25Xb3JsZCwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1MLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxMLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1MLEwucHJvdG90eXBlLlhoPUwsTC5ZaD17fSx0LmJ0Q29sbGlzaW9uV29ybGQ9TCxMLnByb3RvdHlwZS5nZXREaXNwYXRjaGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoRmUodGhpcy5XaCksSyl9LEwucHJvdG90eXBlLmdldFBhaXJDYWNoZT1mdW5jdGlvbigpe3JldHVybiBhKE1lKHRoaXMuV2gpLEopfSxMLnByb3RvdHlwZS5nZXREaXNwYXRjaEluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShBZSh0aGlzLldoKSxzKX0sTC5wcm90b3R5cGUuYWRkQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/d2UocixlKTpuPT09dm9pZCAwP2tlKHIsZSxvKTpMZShyLGUsbyxuKX0sTC5wcm90b3R5cGUucmVtb3ZlQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxIZShvLGUpfSxMLnByb3RvdHlwZS5nZXRCcm9hZHBoYXNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoWWUodGhpcy5XaCksc3QpfSxMLnByb3RvdHlwZS5jb252ZXhTd2VlcFRlc3Q9ZnVuY3Rpb24oZSxvLG4scixjKXt2YXIgRD10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksYyYmdHlwZW9mIGM9PSJvYmplY3QiJiYoYz1jLldoKSxWZShELGUsbyxuLHIsYyl9LEwucHJvdG90eXBlLmNvbnRhY3RQYWlyVGVzdD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxRZShyLGUsbyxuKX0sTC5wcm90b3R5cGUuY29udGFjdFRlc3Q9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxFZShuLGUsbyl9LEwucHJvdG90eXBlLnVwZGF0ZVNpbmdsZUFhYmI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFhlKG8sZSl9LEwucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7VWUodGhpcy5XaCl9O2Z1bmN0aW9uIHcoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRRdWFkV29yZCwgbm8gY29uc3RydWN0b3IgaW4gSURMIn13LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSx3LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj13LHcucHJvdG90eXBlLlhoPXcsdy5ZaD17fSx0LmJ0UXVhZFdvcmQ9dyx3LnByb3RvdHlwZS54PXcucHJvdG90eXBlLng9ZnVuY3Rpb24oKXtyZXR1cm4gR2UodGhpcy5XaCl9LHcucHJvdG90eXBlLnk9dy5wcm90b3R5cGUueT1mdW5jdGlvbigpe3JldHVybiBOZSh0aGlzLldoKX0sdy5wcm90b3R5cGUuej13LnByb3RvdHlwZS56PWZ1bmN0aW9uKCl7cmV0dXJuIHplKHRoaXMuV2gpfSx3LnByb3RvdHlwZS53PWZ1bmN0aW9uKCl7cmV0dXJuIHFlKHRoaXMuV2gpfSx3LnByb3RvdHlwZS5zZXRYPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxaZShvLGUpfSx3LnByb3RvdHlwZS5zZXRZPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxLZShvLGUpfSx3LnByb3RvdHlwZS5zZXRaPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSwkZShvLGUpfSx3LnByb3RvdHlwZS5zZXRXPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxKZShvLGUpfSx3LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe3RvKHRoaXMuV2gpfTtmdW5jdGlvbiBudCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidE1vdGlvblN0YXRlLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifW50LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxudC5wcm90b3R5cGUuY29uc3RydWN0b3I9bnQsbnQucHJvdG90eXBlLlhoPW50LG50LlloPXt9LHQuYnRNb3Rpb25TdGF0ZT1udCxudC5wcm90b3R5cGUuZ2V0V29ybGRUcmFuc2Zvcm09ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGVvKG8sZSl9LG50LnByb3RvdHlwZS5zZXRXb3JsZFRyYW5zZm9ybT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksb28obyxlKX0sbnQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bm8odGhpcy5XaCl9O2Z1bmN0aW9uIEMoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb2xsaXNpb25PYmplY3QsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Qy5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksQy5wcm90b3R5cGUuY29uc3RydWN0b3I9QyxDLnByb3RvdHlwZS5YaD1DLEMuWWg9e30sdC5idENvbGxpc2lvbk9iamVjdD1DLEMucHJvdG90eXBlLnNldEFuaXNvdHJvcGljRnJpY3Rpb249ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxybyhuLGUsbyl9LEMucHJvdG90eXBlLmdldENvbGxpc2lvblNoYXBlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoX28odGhpcy5XaCksSCl9LEMucHJvdG90eXBlLnNldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxpbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRBY3RpdmF0aW9uU3RhdGU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGFvKG8sZSl9LEMucHJvdG90eXBlLmZvcmNlQWN0aXZhdGlvblN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxzbyhvLGUpfSxDLnByb3RvdHlwZS5hY3RpdmF0ZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZT09PXZvaWQgMD9wbyhvKTpsbyhvLGUpfSxDLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiEhdW8odGhpcy5XaCl9LEMucHJvdG90eXBlLmlzS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISFjbyh0aGlzLldoKX0sQy5wcm90b3R5cGUuaXNTdGF0aWNPYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4hIXlvKHRoaXMuV2gpfSxDLnByb3RvdHlwZS5pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISFobyh0aGlzLldoKX0sQy5wcm90b3R5cGUuZ2V0UmVzdGl0dXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gZm8odGhpcy5XaCl9LEMucHJvdG90eXBlLmdldEZyaWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIG1vKHRoaXMuV2gpfSxDLnByb3RvdHlwZS5nZXRSb2xsaW5nRnJpY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gYm8odGhpcy5XaCl9LEMucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxnbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRGcmljdGlvbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksV28obyxlKX0sQy5wcm90b3R5cGUuc2V0Um9sbGluZ0ZyaWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxDbyhvLGUpfSxDLnByb3RvdHlwZS5nZXRXb3JsZFRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBhKGpvKHRoaXMuV2gpLE8pfSxDLnByb3RvdHlwZS5nZXRDb2xsaXNpb25GbGFncz1mdW5jdGlvbigpe3JldHVybiB2byh0aGlzLldoKX0sQy5wcm90b3R5cGUuc2V0Q29sbGlzaW9uRmxhZ3M9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLERvKG8sZSl9LEMucHJvdG90eXBlLnNldFdvcmxkVHJhbnNmb3JtPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxSbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRDb2xsaXNpb25TaGFwZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksU28obyxlKX0sQy5wcm90b3R5cGUuc2V0Q2NkTW90aW9uVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxJbyhvLGUpfSxDLnByb3RvdHlwZS5zZXRDY2RTd2VwdFNwaGVyZVJhZGl1cz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksT28obyxlKX0sQy5wcm90b3R5cGUuZ2V0VXNlckluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIEJvKHRoaXMuV2gpfSxDLnByb3RvdHlwZS5zZXRVc2VySW5kZXg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFBvKG8sZSl9LEMucHJvdG90eXBlLmdldFVzZXJQb2ludGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoeG8odGhpcy5XaCksYnQpfSxDLnByb3RvdHlwZS5zZXRVc2VyUG9pbnRlcj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksVG8obyxlKX0sQy5wcm90b3R5cGUuZ2V0QnJvYWRwaGFzZUhhbmRsZT1mdW5jdGlvbigpe3JldHVybiBhKEZvKHRoaXMuV2gpLEIpfSxDLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe01vKHRoaXMuV2gpfTtmdW5jdGlvbiBtdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBDb250YWN0UmVzdWx0Q2FsbGJhY2ssIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9bXQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLG10LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1tdCxtdC5wcm90b3R5cGUuWGg9bXQsbXQuWWg9e30sdC5Db250YWN0UmVzdWx0Q2FsbGJhY2s9bXQsbXQucHJvdG90eXBlLmFkZFNpbmdsZVJlc3VsdD1mdW5jdGlvbihlLG8sbixyLGMsRCxOKXt2YXIgeXQ9dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSxjJiZ0eXBlb2YgYz09Im9iamVjdCImJihjPWMuV2gpLEQmJnR5cGVvZiBEPT0ib2JqZWN0IiYmKEQ9RC5XaCksTiYmdHlwZW9mIE49PSJvYmplY3QiJiYoTj1OLldoKSxBbyh5dCxlLG8sbixyLGMsRCxOKX0sbXQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7d28odGhpcy5XaCl9O2Z1bmN0aW9uIFIoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgQ29udmV4UmVzdWx0Q2FsbGJhY2ssIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Ui5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksUi5wcm90b3R5cGUuY29uc3RydWN0b3I9UixSLnByb3RvdHlwZS5YaD1SLFIuWWg9e30sdC5Db252ZXhSZXN1bHRDYWxsYmFjaz1SLFIucHJvdG90eXBlLmhhc0hpdD1mdW5jdGlvbigpe3JldHVybiEha28odGhpcy5XaCl9LFIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwPVIucHJvdG90eXBlLlpoPWZ1bmN0aW9uKCl7cmV0dXJuIExvKHRoaXMuV2gpfSxSLnByb3RvdHlwZS5zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cD1SLnByb3RvdHlwZS5haT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSG8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFIucHJvdG90eXBlLCJtX2NvbGxpc2lvbkZpbHRlckdyb3VwIix7Z2V0OlIucHJvdG90eXBlLlpoLHNldDpSLnByb3RvdHlwZS5haX0pLFIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Ui5wcm90b3R5cGUuJGg9ZnVuY3Rpb24oKXtyZXR1cm4gWW8odGhpcy5XaCl9LFIucHJvdG90eXBlLnNldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Ui5wcm90b3R5cGUuYmk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFZvKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSLnByb3RvdHlwZSwibV9jb2xsaXNpb25GaWx0ZXJNYXNrIix7Z2V0OlIucHJvdG90eXBlLiRoLHNldDpSLnByb3RvdHlwZS5iaX0pLFIucHJvdG90eXBlLmdldF9tX2Nsb3Nlc3RIaXRGcmFjdGlvbj1SLnByb3RvdHlwZS5kaT1mdW5jdGlvbigpe3JldHVybiBRbyh0aGlzLldoKX0sUi5wcm90b3R5cGUuc2V0X21fY2xvc2VzdEhpdEZyYWN0aW9uPVIucHJvdG90eXBlLmZpPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxFbyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoUi5wcm90b3R5cGUsIm1fY2xvc2VzdEhpdEZyYWN0aW9uIix7Z2V0OlIucHJvdG90eXBlLmRpLHNldDpSLnByb3RvdHlwZS5maX0pLFIucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7WG8odGhpcy5XaCl9O2Z1bmN0aW9uIEgoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb2xsaXNpb25TaGFwZSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1ILnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxILnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1ILEgucHJvdG90eXBlLlhoPUgsSC5ZaD17fSx0LmJ0Q29sbGlzaW9uU2hhcGU9SCxILnByb3RvdHlwZS5zZXRMb2NhbFNjYWxpbmc9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFVvKG8sZSl9LEgucHJvdG90eXBlLmdldExvY2FsU2NhbGluZz1mdW5jdGlvbigpe3JldHVybiBhKEdvKHRoaXMuV2gpLHkpfSxILnByb3RvdHlwZS5jYWxjdWxhdGVMb2NhbEluZXJ0aWE9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxObyhuLGUsbyl9LEgucHJvdG90eXBlLnNldE1hcmdpbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksem8obyxlKX0sSC5wcm90b3R5cGUuZ2V0TWFyZ2luPWZ1bmN0aW9uKCl7cmV0dXJuIHFvKHRoaXMuV2gpfSxILnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1pvKHRoaXMuV2gpfTtmdW5jdGlvbiBLKCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0RGlzcGF0Y2hlciwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1LLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxLLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1LLEsucHJvdG90eXBlLlhoPUssSy5ZaD17fSx0LmJ0RGlzcGF0Y2hlcj1LLEsucHJvdG90eXBlLmdldE51bU1hbmlmb2xkcz1mdW5jdGlvbigpe3JldHVybiBLbyh0aGlzLldoKX0sSy5wcm90b3R5cGUuZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWw9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKCRvKG8sZSkscSl9LEsucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7Sm8odGhpcy5XaCl9O2Z1bmN0aW9uIHgoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnREeW5hbWljc1dvcmxkLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoTC5wcm90b3R5cGUpLHgucHJvdG90eXBlLmNvbnN0cnVjdG9yPXgseC5wcm90b3R5cGUuWGg9eCx4LlloPXt9LHQuYnREeW5hbWljc1dvcmxkPXgseC5wcm90b3R5cGUuYWRkQWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx0bihvLGUpfSx4LnByb3RvdHlwZS5yZW1vdmVBY3Rpb249ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGVuKG8sZSl9LHgucHJvdG90eXBlLmdldFNvbHZlckluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShvbih0aGlzLldoKSxTKX0seC5wcm90b3R5cGUuc2V0SW50ZXJuYWxUaWNrQ2FsbGJhY2s9ZnVuY3Rpb24oZSxvLG4pe3ZhciByPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksbz09PXZvaWQgMD9ubihyLGUpOm49PT12b2lkIDA/cm4ocixlLG8pOl9uKHIsZSxvLG4pfSx4LnByb3RvdHlwZS5nZXREaXNwYXRjaGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoYW4odGhpcy5XaCksSyl9LHgucHJvdG90eXBlLmdldFBhaXJDYWNoZT1mdW5jdGlvbigpe3JldHVybiBhKHNuKHRoaXMuV2gpLEopfSx4LnByb3RvdHlwZS5nZXREaXNwYXRjaEluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShwbih0aGlzLldoKSxzKX0seC5wcm90b3R5cGUuYWRkQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/bG4ocixlKTpuPT09dm9pZCAwP3VuKHIsZSxvKTpjbihyLGUsbyxuKX0seC5wcm90b3R5cGUucmVtb3ZlQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx5bihvLGUpfSx4LnByb3RvdHlwZS5nZXRCcm9hZHBoYXNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoaG4odGhpcy5XaCksc3QpfSx4LnByb3RvdHlwZS5jb252ZXhTd2VlcFRlc3Q9ZnVuY3Rpb24oZSxvLG4scixjKXt2YXIgRD10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksYyYmdHlwZW9mIGM9PSJvYmplY3QiJiYoYz1jLldoKSxmbihELGUsbyxuLHIsYyl9LHgucHJvdG90eXBlLmNvbnRhY3RQYWlyVGVzdD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxtbihyLGUsbyxuKX0seC5wcm90b3R5cGUuY29udGFjdFRlc3Q9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxibihuLGUsbyl9LHgucHJvdG90eXBlLnVwZGF0ZVNpbmdsZUFhYmI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGduKG8sZSl9LHgucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7ZG4odGhpcy5XaCl9O2Z1bmN0aW9uIGJ0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIFZvaWRQdHIsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9YnQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLGJ0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1idCxidC5wcm90b3R5cGUuWGg9YnQsYnQuWWg9e30sdC5Wb2lkUHRyPWJ0LGJ0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1duKHRoaXMuV2gpfTtmdW5jdGlvbiB5KGUsbyxuKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSx0aGlzLldoPWU9PT12b2lkIDA/Q24oKTpvPT09dm9pZCAwP19lYl9idFZlY3RvcjNfYnRWZWN0b3IzXzEoZSk6bj09PXZvaWQgMD9fZWJfYnRWZWN0b3IzX2J0VmVjdG9yM18yKGUsbyk6am4oZSxvLG4pLEEoeSlbdGhpcy5XaF09dGhpc315LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSx5LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj15LHkucHJvdG90eXBlLlhoPXkseS5ZaD17fSx0LmJ0VmVjdG9yMz15LHkucHJvdG90eXBlLmxlbmd0aD15LnByb3RvdHlwZS5sZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdm4odGhpcy5XaCl9LHkucHJvdG90eXBlLng9eS5wcm90b3R5cGUueD1mdW5jdGlvbigpe3JldHVybiBEbih0aGlzLldoKX0seS5wcm90b3R5cGUueT15LnByb3RvdHlwZS55PWZ1bmN0aW9uKCl7cmV0dXJuIFJuKHRoaXMuV2gpfSx5LnByb3RvdHlwZS56PXkucHJvdG90eXBlLno9ZnVuY3Rpb24oKXtyZXR1cm4gU24odGhpcy5XaCl9LHkucHJvdG90eXBlLnNldFg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEluKG8sZSl9LHkucHJvdG90eXBlLnNldFk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLE9uKG8sZSl9LHkucHJvdG90eXBlLnNldFo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEJuKG8sZSl9LHkucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLFBuKHIsZSxvLG4pfSx5LnByb3RvdHlwZS5ub3JtYWxpemU9eS5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7eG4odGhpcy5XaCl9LHkucHJvdG90eXBlLnJvdGF0ZT15LnByb3RvdHlwZS5yb3RhdGU9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksYShUbihuLGUsbykseSl9LHkucHJvdG90eXBlLmRvdD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEZuKG8sZSl9LHkucHJvdG90eXBlLm9wX211bD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEoTW4obyxlKSx5KX0seS5wcm90b3R5cGUub3BfYWRkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShBbihvLGUpLHkpfSx5LnByb3RvdHlwZS5vcF9zdWI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKHduKG8sZSkseSl9LHkucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7a24odGhpcy5XaCl9O2Z1bmN0aW9uIGYoZSxvLG4scil7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSx0aGlzLldoPUxuKGUsbyxuLHIpLEEoZilbdGhpcy5XaF09dGhpc31mLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHcucHJvdG90eXBlKSxmLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1mLGYucHJvdG90eXBlLlhoPWYsZi5ZaD17fSx0LmJ0UXVhdGVybmlvbj1mLGYucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKGUsbyxuLHIpe3ZhciBjPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSxIbihjLGUsbyxuLHIpfSxmLnByb3RvdHlwZS5zZXRFdWxlclpZWD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxZbihyLGUsbyxuKX0sZi5wcm90b3R5cGUuc2V0Um90YXRpb249ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxWbihuLGUsbyl9LGYucHJvdG90eXBlLm5vcm1hbGl6ZT1mLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXtRbih0aGlzLldoKX0sZi5wcm90b3R5cGUubGVuZ3RoMj1mdW5jdGlvbigpe3JldHVybiBFbih0aGlzLldoKX0sZi5wcm90b3R5cGUubGVuZ3RoPWYucHJvdG90eXBlLmxlbmd0aD1mdW5jdGlvbigpe3JldHVybiBYbih0aGlzLldoKX0sZi5wcm90b3R5cGUuZG90PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksVW4obyxlKX0sZi5wcm90b3R5cGUubm9ybWFsaXplZD1mdW5jdGlvbigpe3JldHVybiBhKEduKHRoaXMuV2gpLGYpfSxmLnByb3RvdHlwZS5nZXRBeGlzPWZ1bmN0aW9uKCl7cmV0dXJuIGEoTm4odGhpcy5XaCkseSl9LGYucHJvdG90eXBlLmludmVyc2U9Zi5wcm90b3R5cGUuaW52ZXJzZT1mdW5jdGlvbigpe3JldHVybiBhKHpuKHRoaXMuV2gpLGYpfSxmLnByb3RvdHlwZS5nZXRBbmdsZT1mdW5jdGlvbigpe3JldHVybiBxbih0aGlzLldoKX0sZi5wcm90b3R5cGUuZ2V0QW5nbGVTaG9ydGVzdFBhdGg9ZnVuY3Rpb24oKXtyZXR1cm4gWm4odGhpcy5XaCl9LGYucHJvdG90eXBlLmFuZ2xlPWYucHJvdG90eXBlLmFuZ2xlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksS24obyxlKX0sZi5wcm90b3R5cGUuYW5nbGVTaG9ydGVzdFBhdGg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSwkbihvLGUpfSxmLnByb3RvdHlwZS5vcF9hZGQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKEpuKG8sZSksZil9LGYucHJvdG90eXBlLm9wX3N1Yj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEodHIobyxlKSxmKX0sZi5wcm90b3R5cGUub3BfbXVsPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShlcihvLGUpLGYpfSxmLnByb3RvdHlwZS5vcF9tdWxxPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShvcihvLGUpLGYpfSxmLnByb3RvdHlwZS5vcF9kaXY9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKG5yKG8sZSksZil9LGYucHJvdG90eXBlLng9Zi5wcm90b3R5cGUueD1mdW5jdGlvbigpe3JldHVybiBycih0aGlzLldoKX0sZi5wcm90b3R5cGUueT1mLnByb3RvdHlwZS55PWZ1bmN0aW9uKCl7cmV0dXJuIF9yKHRoaXMuV2gpfSxmLnByb3RvdHlwZS56PWYucHJvdG90eXBlLno9ZnVuY3Rpb24oKXtyZXR1cm4gaXIodGhpcy5XaCl9LGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oKXtyZXR1cm4gYXIodGhpcy5XaCl9LGYucHJvdG90eXBlLnNldFg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHNyKG8sZSl9LGYucHJvdG90eXBlLnNldFk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHByKG8sZSl9LGYucHJvdG90eXBlLnNldFo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGxyKG8sZSl9LGYucHJvdG90eXBlLnNldFc9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHVyKG8sZSl9LGYucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7Y3IodGhpcy5XaCl9O2Z1bmN0aW9uIHJ0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0TWF0cml4M3gzLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXJ0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxydC5wcm90b3R5cGUuY29uc3RydWN0b3I9cnQscnQucHJvdG90eXBlLlhoPXJ0LHJ0LlloPXt9LHQuYnRNYXRyaXgzeDM9cnQscnQucHJvdG90eXBlLnNldEV1bGVyWllYPWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHlyKHIsZSxvLG4pfSxydC5wcm90b3R5cGUuZ2V0Um90YXRpb249ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGhyKG8sZSl9LHJ0LnByb3RvdHlwZS5nZXRSb3c9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKGZyKG8sZSkseSl9LHJ0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe21yKHRoaXMuV2gpfTtmdW5jdGlvbiBPKGUsbyl7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLHRoaXMuV2g9ZT09PXZvaWQgMD9icigpOm89PT12b2lkIDA/X2ViX2J0VHJhbnNmb3JtX2J0VHJhbnNmb3JtXzEoZSk6Z3IoZSxvKSxBKE8pW3RoaXMuV2hdPXRoaXN9Ty5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksTy5wcm90b3R5cGUuY29uc3RydWN0b3I9TyxPLnByb3RvdHlwZS5YaD1PLE8uWWg9e30sdC5idFRyYW5zZm9ybT1PLE8ucHJvdG90eXBlLnNldElkZW50aXR5PWZ1bmN0aW9uKCl7ZHIodGhpcy5XaCl9LE8ucHJvdG90eXBlLnNldE9yaWdpbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksV3IobyxlKX0sTy5wcm90b3R5cGUuc2V0Um90YXRpb249ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLENyKG8sZSl9LE8ucHJvdG90eXBlLmdldE9yaWdpbj1mdW5jdGlvbigpe3JldHVybiBhKGpyKHRoaXMuV2gpLHkpfSxPLnByb3RvdHlwZS5nZXRSb3RhdGlvbj1mdW5jdGlvbigpe3JldHVybiBhKHZyKHRoaXMuV2gpLGYpfSxPLnByb3RvdHlwZS5nZXRCYXNpcz1mdW5jdGlvbigpe3JldHVybiBhKERyKHRoaXMuV2gpLHJ0KX0sTy5wcm90b3R5cGUuc2V0RnJvbU9wZW5HTE1hdHJpeD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO0NlKCksdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1ibChlKSksUnIobyxlKX0sTy5wcm90b3R5cGUuaW52ZXJzZT1PLnByb3RvdHlwZS5pbnZlcnNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoU3IodGhpcy5XaCksTyl9LE8ucHJvdG90eXBlLm9wX211bD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEoSXIobyxlKSxPKX0sTy5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtPcih0aGlzLldoKX07ZnVuY3Rpb24gRShlLG8pe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx0aGlzLldoPWU9PT12b2lkIDA/QnIoKTpvPT09dm9pZCAwP1ByKGUpOnhyKGUsbyksQShFKVt0aGlzLldoXT10aGlzfUUucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobnQucHJvdG90eXBlKSxFLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1FLEUucHJvdG90eXBlLlhoPUUsRS5ZaD17fSx0LmJ0RGVmYXVsdE1vdGlvblN0YXRlPUUsRS5wcm90b3R5cGUuZ2V0V29ybGRUcmFuc2Zvcm09ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFRyKG8sZSl9LEUucHJvdG90eXBlLnNldFdvcmxkVHJhbnNmb3JtPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxGcihvLGUpfSxFLnByb3RvdHlwZS5nZXRfbV9ncmFwaGljc1dvcmxkVHJhbnM9RS5wcm90b3R5cGUuemk9ZnVuY3Rpb24oKXtyZXR1cm4gYShNcih0aGlzLldoKSxPKX0sRS5wcm90b3R5cGUuc2V0X21fZ3JhcGhpY3NXb3JsZFRyYW5zPUUucHJvdG90eXBlLnRqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxBcihvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRS5wcm90b3R5cGUsIm1fZ3JhcGhpY3NXb3JsZFRyYW5zIix7Z2V0OkUucHJvdG90eXBlLnppLHNldDpFLnByb3RvdHlwZS50an0pLEUucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7d3IodGhpcy5XaCl9O2Z1bmN0aW9uIGd0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29sbGlzaW9uT2JqZWN0V3JhcHBlciwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1ndC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksZ3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPWd0LGd0LnByb3RvdHlwZS5YaD1ndCxndC5ZaD17fSx0LmJ0Q29sbGlzaW9uT2JqZWN0V3JhcHBlcj1ndCxndC5wcm90b3R5cGUuZ2V0V29ybGRUcmFuc2Zvcm09ZnVuY3Rpb24oKXtyZXR1cm4gYShrcih0aGlzLldoKSxPKX0sZ3QucHJvdG90eXBlLmdldENvbGxpc2lvbk9iamVjdD1mdW5jdGlvbigpe3JldHVybiBhKExyKHRoaXMuV2gpLEMpfSxndC5wcm90b3R5cGUuZ2V0Q29sbGlzaW9uU2hhcGU9ZnVuY3Rpb24oKXtyZXR1cm4gYShIcih0aGlzLldoKSxIKX07ZnVuY3Rpb24gbHQoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5LCBubyBjb25zdHJ1Y3RvciBpbiBJREwifWx0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxsdC5wcm90b3R5cGUuY29uc3RydWN0b3I9bHQsbHQucHJvdG90eXBlLlhoPWx0LGx0LlloPXt9LHQuYnRDb25zdENvbGxpc2lvbk9iamVjdEFycmF5PWx0LGx0LnByb3RvdHlwZS5zaXplPWx0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIFlyKHRoaXMuV2gpfSxsdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKFZyKG8sZSksQyl9LGx0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1FyKHRoaXMuV2gpfTtmdW5jdGlvbiB1dCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidFNjYWxhckFycmF5LCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXV0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSx1dC5wcm90b3R5cGUuY29uc3RydWN0b3I9dXQsdXQucHJvdG90eXBlLlhoPXV0LHV0LlloPXt9LHQuYnRTY2FsYXJBcnJheT11dCx1dC5wcm90b3R5cGUuc2l6ZT11dC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiBFcih0aGlzLldoKX0sdXQucHJvdG90eXBlLmF0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWHIobyxlKX0sdXQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7VXIodGhpcy5XaCl9O2Z1bmN0aW9uIGgoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRNYW5pZm9sZFBvaW50LCBubyBjb25zdHJ1Y3RvciBpbiBJREwifWgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLGgucHJvdG90eXBlLmNvbnN0cnVjdG9yPWgsaC5wcm90b3R5cGUuWGg9aCxoLlloPXt9LHQuYnRNYW5pZm9sZFBvaW50PWgsaC5wcm90b3R5cGUuZ2V0UG9zaXRpb25Xb3JsZE9uQT1mdW5jdGlvbigpe3JldHVybiBhKEdyKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5nZXRQb3NpdGlvbldvcmxkT25CPWZ1bmN0aW9uKCl7cmV0dXJuIGEoTnIodGhpcy5XaCkseSl9LGgucHJvdG90eXBlLmdldEFwcGxpZWRJbXB1bHNlPWZ1bmN0aW9uKCl7cmV0dXJuIHpyKHRoaXMuV2gpfSxoLnByb3RvdHlwZS5nZXREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiBxcih0aGlzLldoKX0saC5wcm90b3R5cGUuZ2V0X21fbG9jYWxQb2ludEE9aC5wcm90b3R5cGUuSWk9ZnVuY3Rpb24oKXtyZXR1cm4gYShacih0aGlzLldoKSx5KX0saC5wcm90b3R5cGUuc2V0X21fbG9jYWxQb2ludEE9aC5wcm90b3R5cGUuQ2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEtyKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShoLnByb3RvdHlwZSwibV9sb2NhbFBvaW50QSIse2dldDpoLnByb3RvdHlwZS5JaSxzZXQ6aC5wcm90b3R5cGUuQ2p9KSxoLnByb3RvdHlwZS5nZXRfbV9sb2NhbFBvaW50Qj1oLnByb3RvdHlwZS5KaT1mdW5jdGlvbigpe3JldHVybiBhKCRyKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5zZXRfbV9sb2NhbFBvaW50Qj1oLnByb3RvdHlwZS5Eaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSnIobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGgucHJvdG90eXBlLCJtX2xvY2FsUG9pbnRCIix7Z2V0OmgucHJvdG90eXBlLkppLHNldDpoLnByb3RvdHlwZS5Ean0pLGgucHJvdG90eXBlLmdldF9tX3Bvc2l0aW9uV29ybGRPbkI9aC5wcm90b3R5cGUuUGk9ZnVuY3Rpb24oKXtyZXR1cm4gYSh0Xyh0aGlzLldoKSx5KX0saC5wcm90b3R5cGUuc2V0X21fcG9zaXRpb25Xb3JsZE9uQj1oLnByb3RvdHlwZS5Kaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZV8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGgucHJvdG90eXBlLCJtX3Bvc2l0aW9uV29ybGRPbkIiLHtnZXQ6aC5wcm90b3R5cGUuUGksc2V0OmgucHJvdG90eXBlLkpqfSksaC5wcm90b3R5cGUuZ2V0X21fcG9zaXRpb25Xb3JsZE9uQT1oLnByb3RvdHlwZS5PaT1mdW5jdGlvbigpe3JldHVybiBhKG9fKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5zZXRfbV9wb3NpdGlvbldvcmxkT25BPWgucHJvdG90eXBlLklqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxuXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaC5wcm90b3R5cGUsIm1fcG9zaXRpb25Xb3JsZE9uQSIse2dldDpoLnByb3RvdHlwZS5PaSxzZXQ6aC5wcm90b3R5cGUuSWp9KSxoLnByb3RvdHlwZS5nZXRfbV9ub3JtYWxXb3JsZE9uQj1oLnByb3RvdHlwZS5MaT1mdW5jdGlvbigpe3JldHVybiBhKHJfKHRoaXMuV2gpLHkpfSxoLnByb3RvdHlwZS5zZXRfbV9ub3JtYWxXb3JsZE9uQj1oLnByb3RvdHlwZS5Gaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksX18obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGgucHJvdG90eXBlLCJtX25vcm1hbFdvcmxkT25CIix7Z2V0OmgucHJvdG90eXBlLkxpLHNldDpoLnByb3RvdHlwZS5Gan0pLGgucHJvdG90eXBlLmdldF9tX3VzZXJQZXJzaXN0ZW50RGF0YT1oLnByb3RvdHlwZS5iaj1mdW5jdGlvbigpe3JldHVybiBpXyh0aGlzLldoKX0saC5wcm90b3R5cGUuc2V0X21fdXNlclBlcnNpc3RlbnREYXRhPWgucHJvdG90eXBlLldqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoaC5wcm90b3R5cGUsIm1fdXNlclBlcnNpc3RlbnREYXRhIix7Z2V0OmgucHJvdG90eXBlLmJqLHNldDpoLnByb3RvdHlwZS5Xan0pLGgucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7c18odGhpcy5XaCl9O2Z1bmN0aW9uIGR0KCl7dGhpcy5XaD1wXygpLEEoZHQpW3RoaXMuV2hdPXRoaXN9ZHQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobXQucHJvdG90eXBlKSxkdC5wcm90b3R5cGUuY29uc3RydWN0b3I9ZHQsZHQucHJvdG90eXBlLlhoPWR0LGR0LlloPXt9LHQuQ29uY3JldGVDb250YWN0UmVzdWx0Q2FsbGJhY2s9ZHQsZHQucHJvdG90eXBlLmFkZFNpbmdsZVJlc3VsdD1mdW5jdGlvbihlLG8sbixyLGMsRCxOKXt2YXIgeXQ9dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSxjJiZ0eXBlb2YgYz09Im9iamVjdCImJihjPWMuV2gpLEQmJnR5cGVvZiBEPT0ib2JqZWN0IiYmKEQ9RC5XaCksTiYmdHlwZW9mIE49PSJvYmplY3QiJiYoTj1OLldoKSxsXyh5dCxlLG8sbixyLGMsRCxOKX0sZHQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7dV8odGhpcy5XaCl9O2Z1bmN0aW9uIFQoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgTG9jYWxTaGFwZUluZm8sIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9VC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksVC5wcm90b3R5cGUuY29uc3RydWN0b3I9VCxULnByb3RvdHlwZS5YaD1ULFQuWWg9e30sdC5Mb2NhbFNoYXBlSW5mbz1ULFQucHJvdG90eXBlLmdldF9tX3NoYXBlUGFydD1ULnByb3RvdHlwZS5TaT1mdW5jdGlvbigpe3JldHVybiBjXyh0aGlzLldoKX0sVC5wcm90b3R5cGUuc2V0X21fc2hhcGVQYXJ0PVQucHJvdG90eXBlLk1qPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx5XyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoVC5wcm90b3R5cGUsIm1fc2hhcGVQYXJ0Iix7Z2V0OlQucHJvdG90eXBlLlNpLHNldDpULnByb3RvdHlwZS5Nan0pLFQucHJvdG90eXBlLmdldF9tX3RyaWFuZ2xlSW5kZXg9VC5wcm90b3R5cGUuWWk9ZnVuY3Rpb24oKXtyZXR1cm4gaF8odGhpcy5XaCl9LFQucHJvdG90eXBlLnNldF9tX3RyaWFuZ2xlSW5kZXg9VC5wcm90b3R5cGUuU2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGZfKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShULnByb3RvdHlwZSwibV90cmlhbmdsZUluZGV4Iix7Z2V0OlQucHJvdG90eXBlLllpLHNldDpULnByb3RvdHlwZS5Tan0pLFQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bV8odGhpcy5XaCl9O2Z1bmN0aW9uIFcoZSxvLG4scixjKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxyJiZ0eXBlb2Ygcj09Im9iamVjdCImJihyPXIuV2gpLGMmJnR5cGVvZiBjPT0ib2JqZWN0IiYmKGM9Yy5XaCksdGhpcy5XaD1iXyhlLG8sbixyLGMpLEEoVylbdGhpcy5XaF09dGhpc31XLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxXLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1XLFcucHJvdG90eXBlLlhoPVcsVy5ZaD17fSx0LkxvY2FsQ29udmV4UmVzdWx0PVcsVy5wcm90b3R5cGUuZ2V0X21faGl0Q29sbGlzaW9uT2JqZWN0PVcucHJvdG90eXBlLmVpPWZ1bmN0aW9uKCl7cmV0dXJuIGEoZ18odGhpcy5XaCksQyl9LFcucHJvdG90eXBlLnNldF9tX2hpdENvbGxpc2lvbk9iamVjdD1XLnByb3RvdHlwZS5naT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZF8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFcucHJvdG90eXBlLCJtX2hpdENvbGxpc2lvbk9iamVjdCIse2dldDpXLnByb3RvdHlwZS5laSxzZXQ6Vy5wcm90b3R5cGUuZ2l9KSxXLnByb3RvdHlwZS5nZXRfbV9sb2NhbFNoYXBlSW5mbz1XLnByb3RvdHlwZS5LaT1mdW5jdGlvbigpe3JldHVybiBhKFdfKHRoaXMuV2gpLFQpfSxXLnByb3RvdHlwZS5zZXRfbV9sb2NhbFNoYXBlSW5mbz1XLnByb3RvdHlwZS5Faj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksQ18obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFcucHJvdG90eXBlLCJtX2xvY2FsU2hhcGVJbmZvIix7Z2V0OlcucHJvdG90eXBlLktpLHNldDpXLnByb3RvdHlwZS5Fan0pLFcucHJvdG90eXBlLmdldF9tX2hpdE5vcm1hbExvY2FsPVcucHJvdG90eXBlLkJpPWZ1bmN0aW9uKCl7cmV0dXJuIGEoal8odGhpcy5XaCkseSl9LFcucHJvdG90eXBlLnNldF9tX2hpdE5vcm1hbExvY2FsPVcucHJvdG90eXBlLnZqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx2XyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoVy5wcm90b3R5cGUsIm1faGl0Tm9ybWFsTG9jYWwiLHtnZXQ6Vy5wcm90b3R5cGUuQmksc2V0OlcucHJvdG90eXBlLnZqfSksVy5wcm90b3R5cGUuZ2V0X21faGl0UG9pbnRMb2NhbD1XLnByb3RvdHlwZS5EaT1mdW5jdGlvbigpe3JldHVybiBhKERfKHRoaXMuV2gpLHkpfSxXLnByb3RvdHlwZS5zZXRfbV9oaXRQb2ludExvY2FsPVcucHJvdG90eXBlLnhqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxSXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoVy5wcm90b3R5cGUsIm1faGl0UG9pbnRMb2NhbCIse2dldDpXLnByb3RvdHlwZS5EaSxzZXQ6Vy5wcm90b3R5cGUueGp9KSxXLnByb3RvdHlwZS5nZXRfbV9oaXRGcmFjdGlvbj1XLnByb3RvdHlwZS5BaT1mdW5jdGlvbigpe3JldHVybiBTXyh0aGlzLldoKX0sVy5wcm90b3R5cGUuc2V0X21faGl0RnJhY3Rpb249Vy5wcm90b3R5cGUudWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLElfKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXLnByb3RvdHlwZSwibV9oaXRGcmFjdGlvbiIse2dldDpXLnByb3RvdHlwZS5BaSxzZXQ6Vy5wcm90b3R5cGUudWp9KSxXLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe09fKHRoaXMuV2gpfTtmdW5jdGlvbiB1KGUsbyl7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLHRoaXMuV2g9Ql8oZSxvKSxBKHUpW3RoaXMuV2hdPXRoaXN9dS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShSLnByb3RvdHlwZSksdS5wcm90b3R5cGUuY29uc3RydWN0b3I9dSx1LnByb3RvdHlwZS5YaD11LHUuWWg9e30sdC5DbG9zZXN0Q29udmV4UmVzdWx0Q2FsbGJhY2s9dSx1LnByb3RvdHlwZS5oYXNIaXQ9ZnVuY3Rpb24oKXtyZXR1cm4hIVBfKHRoaXMuV2gpfSx1LnByb3RvdHlwZS5nZXRfbV9oaXRDb2xsaXNpb25PYmplY3Q9dS5wcm90b3R5cGUuZWk9ZnVuY3Rpb24oKXtyZXR1cm4gYSh4Xyh0aGlzLldoKSxDKX0sdS5wcm90b3R5cGUuc2V0X21faGl0Q29sbGlzaW9uT2JqZWN0PXUucHJvdG90eXBlLmdpPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxUXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodS5wcm90b3R5cGUsIm1faGl0Q29sbGlzaW9uT2JqZWN0Iix7Z2V0OnUucHJvdG90eXBlLmVpLHNldDp1LnByb3RvdHlwZS5naX0pLHUucHJvdG90eXBlLmdldF9tX2NvbnZleEZyb21Xb3JsZD11LnByb3RvdHlwZS5zaT1mdW5jdGlvbigpe3JldHVybiBhKEZfKHRoaXMuV2gpLHkpfSx1LnByb3RvdHlwZS5zZXRfbV9jb252ZXhGcm9tV29ybGQ9dS5wcm90b3R5cGUubWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLE1fKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LnByb3RvdHlwZSwibV9jb252ZXhGcm9tV29ybGQiLHtnZXQ6dS5wcm90b3R5cGUuc2ksc2V0OnUucHJvdG90eXBlLm1qfSksdS5wcm90b3R5cGUuZ2V0X21fY29udmV4VG9Xb3JsZD11LnByb3RvdHlwZS50aT1mdW5jdGlvbigpe3JldHVybiBhKEFfKHRoaXMuV2gpLHkpfSx1LnByb3RvdHlwZS5zZXRfbV9jb252ZXhUb1dvcmxkPXUucHJvdG90eXBlLm5qPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx3XyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodS5wcm90b3R5cGUsIm1fY29udmV4VG9Xb3JsZCIse2dldDp1LnByb3RvdHlwZS50aSxzZXQ6dS5wcm90b3R5cGUubmp9KSx1LnByb3RvdHlwZS5nZXRfbV9oaXROb3JtYWxXb3JsZD11LnByb3RvdHlwZS5DaT1mdW5jdGlvbigpe3JldHVybiBhKGtfKHRoaXMuV2gpLHkpfSx1LnByb3RvdHlwZS5zZXRfbV9oaXROb3JtYWxXb3JsZD11LnByb3RvdHlwZS53aj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksTF8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHUucHJvdG90eXBlLCJtX2hpdE5vcm1hbFdvcmxkIix7Z2V0OnUucHJvdG90eXBlLkNpLHNldDp1LnByb3RvdHlwZS53an0pLHUucHJvdG90eXBlLmdldF9tX2hpdFBvaW50V29ybGQ9dS5wcm90b3R5cGUuRWk9ZnVuY3Rpb24oKXtyZXR1cm4gYShIXyh0aGlzLldoKSx5KX0sdS5wcm90b3R5cGUuc2V0X21faGl0UG9pbnRXb3JsZD11LnByb3RvdHlwZS55aj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWV8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHUucHJvdG90eXBlLCJtX2hpdFBvaW50V29ybGQiLHtnZXQ6dS5wcm90b3R5cGUuRWksc2V0OnUucHJvdG90eXBlLnlqfSksdS5wcm90b3R5cGUuZ2V0X21fY29sbGlzaW9uRmlsdGVyR3JvdXA9dS5wcm90b3R5cGUuWmg9ZnVuY3Rpb24oKXtyZXR1cm4gVl8odGhpcy5XaCl9LHUucHJvdG90eXBlLnNldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwPXUucHJvdG90eXBlLmFpPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxRXyhvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodS5wcm90b3R5cGUsIm1fY29sbGlzaW9uRmlsdGVyR3JvdXAiLHtnZXQ6dS5wcm90b3R5cGUuWmgsc2V0OnUucHJvdG90eXBlLmFpfSksdS5wcm90b3R5cGUuZ2V0X21fY29sbGlzaW9uRmlsdGVyTWFzaz11LnByb3RvdHlwZS4kaD1mdW5jdGlvbigpe3JldHVybiBFXyh0aGlzLldoKX0sdS5wcm90b3R5cGUuc2V0X21fY29sbGlzaW9uRmlsdGVyTWFzaz11LnByb3RvdHlwZS5iaT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWF8obyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHUucHJvdG90eXBlLCJtX2NvbGxpc2lvbkZpbHRlck1hc2siLHtnZXQ6dS5wcm90b3R5cGUuJGgsc2V0OnUucHJvdG90eXBlLmJpfSksdS5wcm90b3R5cGUuZ2V0X21fY2xvc2VzdEhpdEZyYWN0aW9uPXUucHJvdG90eXBlLmRpPWZ1bmN0aW9uKCl7cmV0dXJuIFVfKHRoaXMuV2gpfSx1LnByb3RvdHlwZS5zZXRfbV9jbG9zZXN0SGl0RnJhY3Rpb249dS5wcm90b3R5cGUuZmk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEdfKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LnByb3RvdHlwZSwibV9jbG9zZXN0SGl0RnJhY3Rpb24iLHtnZXQ6dS5wcm90b3R5cGUuZGksc2V0OnUucHJvdG90eXBlLmZpfSksdS5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtOXyh0aGlzLldoKX07ZnVuY3Rpb24gb3QoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRDb252ZXhTaGFwZSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1vdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShILnByb3RvdHlwZSksb3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPW90LG90LnByb3RvdHlwZS5YaD1vdCxvdC5ZaD17fSx0LmJ0Q29udmV4U2hhcGU9b3Qsb3QucHJvdG90eXBlLnNldExvY2FsU2NhbGluZz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksel8obyxlKX0sb3QucHJvdG90eXBlLmdldExvY2FsU2NhbGluZz1mdW5jdGlvbigpe3JldHVybiBhKHFfKHRoaXMuV2gpLHkpfSxvdC5wcm90b3R5cGUuY2FsY3VsYXRlTG9jYWxJbmVydGlhPWZ1bmN0aW9uKGUsbyl7dmFyIG49dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksWl8obixlLG8pfSxvdC5wcm90b3R5cGUuc2V0TWFyZ2luPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxLXyhvLGUpfSxvdC5wcm90b3R5cGUuZ2V0TWFyZ2luPWZ1bmN0aW9uKCl7cmV0dXJuICRfKHRoaXMuV2gpfSxvdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtKXyh0aGlzLldoKX07ZnVuY3Rpb24gJChlKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHRoaXMuV2g9dGkoZSksQSgkKVt0aGlzLldoXT10aGlzfSQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoSC5wcm90b3R5cGUpLCQucHJvdG90eXBlLmNvbnN0cnVjdG9yPSQsJC5wcm90b3R5cGUuWGg9JCwkLlloPXt9LHQuYnRCb3hTaGFwZT0kLCQucHJvdG90eXBlLnNldE1hcmdpbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZWkobyxlKX0sJC5wcm90b3R5cGUuZ2V0TWFyZ2luPWZ1bmN0aW9uKCl7cmV0dXJuIG9pKHRoaXMuV2gpfSwkLnByb3RvdHlwZS5zZXRMb2NhbFNjYWxpbmc9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG5pKG8sZSl9LCQucHJvdG90eXBlLmdldExvY2FsU2NhbGluZz1mdW5jdGlvbigpe3JldHVybiBhKHJpKHRoaXMuV2gpLHkpfSwkLnByb3RvdHlwZS5jYWxjdWxhdGVMb2NhbEluZXJ0aWE9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxfaShuLGUsbyl9LCQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7aWkodGhpcy5XaCl9O2Z1bmN0aW9uIF90KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0SW50QXJyYXksIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9X3QucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLF90LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1fdCxfdC5wcm90b3R5cGUuWGg9X3QsX3QuWWg9e30sdC5idEludEFycmF5PV90LF90LnByb3RvdHlwZS5zaXplPV90LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGFpKHRoaXMuV2gpfSxfdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxzaShvLGUpfSxfdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtwaSh0aGlzLldoKX07ZnVuY3Rpb24gRigpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidEZhY2UsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Ri5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksRi5wcm90b3R5cGUuY29uc3RydWN0b3I9RixGLnByb3RvdHlwZS5YaD1GLEYuWWg9e30sdC5idEZhY2U9RixGLnByb3RvdHlwZS5nZXRfbV9pbmRpY2VzPUYucHJvdG90eXBlLkZpPWZ1bmN0aW9uKCl7cmV0dXJuIGEobGkodGhpcy5XaCksX3QpfSxGLnByb3RvdHlwZS5zZXRfbV9pbmRpY2VzPUYucHJvdG90eXBlLnpqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx1aShvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRi5wcm90b3R5cGUsIm1faW5kaWNlcyIse2dldDpGLnByb3RvdHlwZS5GaSxzZXQ6Ri5wcm90b3R5cGUuemp9KSxGLnByb3RvdHlwZS5nZXRfbV9wbGFuZT1GLnByb3RvdHlwZS5OaT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGNpKG8sZSl9LEYucHJvdG90eXBlLnNldF9tX3BsYW5lPUYucHJvdG90eXBlLkhqPWZ1bmN0aW9uKGUsbyl7dmFyIG49dGhpcy5XaDtDZSgpLGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx5aShuLGUsbyl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGLnByb3RvdHlwZSwibV9wbGFuZSIse2dldDpGLnByb3RvdHlwZS5OaSxzZXQ6Ri5wcm90b3R5cGUuSGp9KSxGLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe2hpKHRoaXMuV2gpfTtmdW5jdGlvbiBpdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidFZlY3RvcjNBcnJheSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1pdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksaXQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWl0LGl0LnByb3RvdHlwZS5YaD1pdCxpdC5ZaD17fSx0LmJ0VmVjdG9yM0FycmF5PWl0LGl0LnByb3RvdHlwZS5zaXplPWl0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGZpKHRoaXMuV2gpfSxpdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKG1pKG8sZSkseSl9LGl0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe2JpKHRoaXMuV2gpfTtmdW5jdGlvbiBhdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidEZhY2VBcnJheSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1hdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksYXQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWF0LGF0LnByb3RvdHlwZS5YaD1hdCxhdC5ZaD17fSx0LmJ0RmFjZUFycmF5PWF0LGF0LnByb3RvdHlwZS5zaXplPWF0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGdpKHRoaXMuV2gpfSxhdC5wcm90b3R5cGUuYXQ9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKGRpKG8sZSksRil9LGF0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1dpKHRoaXMuV2gpfTtmdW5jdGlvbiBNKCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29udmV4UG9seWhlZHJvbiwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1NLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxNLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1NLE0ucHJvdG90eXBlLlhoPU0sTS5ZaD17fSx0LmJ0Q29udmV4UG9seWhlZHJvbj1NLE0ucHJvdG90eXBlLmdldF9tX3ZlcnRpY2VzPU0ucHJvdG90eXBlLmNqPWZ1bmN0aW9uKCl7cmV0dXJuIGEoQ2kodGhpcy5XaCksaXQpfSxNLnByb3RvdHlwZS5zZXRfbV92ZXJ0aWNlcz1NLnByb3RvdHlwZS5Yaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksamkobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE0ucHJvdG90eXBlLCJtX3ZlcnRpY2VzIix7Z2V0Ok0ucHJvdG90eXBlLmNqLHNldDpNLnByb3RvdHlwZS5Yan0pLE0ucHJvdG90eXBlLmdldF9tX2ZhY2VzPU0ucHJvdG90eXBlLnhpPWZ1bmN0aW9uKCl7cmV0dXJuIGEodmkodGhpcy5XaCksYXQpfSxNLnByb3RvdHlwZS5zZXRfbV9mYWNlcz1NLnByb3RvdHlwZS5yaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksRGkobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE0ucHJvdG90eXBlLCJtX2ZhY2VzIix7Z2V0Ok0ucHJvdG90eXBlLnhpLHNldDpNLnByb3RvdHlwZS5yan0pLE0ucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7UmkodGhpcy5XaCl9O2Z1bmN0aW9uIFkoZSxvKXtDZSgpLHR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9YmwoZSkpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksdGhpcy5XaD1lPT09dm9pZCAwP1NpKCk6bz09PXZvaWQgMD9JaShlKTpPaShlLG8pLEEoWSlbdGhpcy5XaF09dGhpc31ZLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEgucHJvdG90eXBlKSxZLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1ZLFkucHJvdG90eXBlLlhoPVksWS5ZaD17fSx0LmJ0Q29udmV4SHVsbFNoYXBlPVksWS5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxvPT09dm9pZCAwP0JpKG4sZSk6UGkobixlLG8pfSxZLnByb3RvdHlwZS5zZXRNYXJnaW49ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHhpKG8sZSl9LFkucHJvdG90eXBlLmdldE1hcmdpbj1mdW5jdGlvbigpe3JldHVybiBUaSh0aGlzLldoKX0sWS5wcm90b3R5cGUuZ2V0TnVtVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gRmkodGhpcy5XaCl9LFkucHJvdG90eXBlLmluaXRpYWxpemVQb2x5aGVkcmFsRmVhdHVyZXM9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSwhIU1pKG8sZSl9LFkucHJvdG90eXBlLnJlY2FsY0xvY2FsQWFiYj1mdW5jdGlvbigpe0FpKHRoaXMuV2gpfSxZLnByb3RvdHlwZS5nZXRDb252ZXhQb2x5aGVkcm9uPWZ1bmN0aW9uKCl7cmV0dXJuIGEod2kodGhpcy5XaCksTSl9LFkucHJvdG90eXBlLnNldExvY2FsU2NhbGluZz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksa2kobyxlKX0sWS5wcm90b3R5cGUuZ2V0TG9jYWxTY2FsaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGEoTGkodGhpcy5XaCkseSl9LFkucHJvdG90eXBlLmNhbGN1bGF0ZUxvY2FsSW5lcnRpYT1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLEhpKG4sZSxvKX0sWS5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtZaSh0aGlzLldoKX07ZnVuY3Rpb24ganQoKXt0aGlzLldoPVZpKCksQShqdClbdGhpcy5XaF09dGhpc31qdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksanQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWp0LGp0LnByb3RvdHlwZS5YaD1qdCxqdC5ZaD17fSx0LmJ0RGVmYXVsdENvbGxpc2lvbkNvbnN0cnVjdGlvbkluZm89anQsanQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7UWkodGhpcy5XaCl9O2Z1bmN0aW9uIHZ0KGUpe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdGhpcy5XaD1lPT09dm9pZCAwP0VpKCk6WGkoZSksQSh2dClbdGhpcy5XaF09dGhpc312dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksdnQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXZ0LHZ0LnByb3RvdHlwZS5YaD12dCx2dC5ZaD17fSx0LmJ0RGVmYXVsdENvbGxpc2lvbkNvbmZpZ3VyYXRpb249dnQsdnQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7VWkodGhpcy5XaCl9O2Z1bmN0aW9uIHEoKXt0aGlzLldoPUdpKCksQShxKVt0aGlzLldoXT10aGlzfXEucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLHEucHJvdG90eXBlLmNvbnN0cnVjdG9yPXEscS5wcm90b3R5cGUuWGg9cSxxLlloPXt9LHQuYnRQZXJzaXN0ZW50TWFuaWZvbGQ9cSxxLnByb3RvdHlwZS5nZXRCb2R5MD1mdW5jdGlvbigpe3JldHVybiBhKE5pKHRoaXMuV2gpLEMpfSxxLnByb3RvdHlwZS5nZXRCb2R5MT1mdW5jdGlvbigpe3JldHVybiBhKHppKHRoaXMuV2gpLEMpfSxxLnByb3RvdHlwZS5nZXROdW1Db250YWN0cz1mdW5jdGlvbigpe3JldHVybiBxaSh0aGlzLldoKX0scS5wcm90b3R5cGUuZ2V0Q29udGFjdFBvaW50PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYShaaShvLGUpLGgpfSxxLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe0tpKHRoaXMuV2gpfTtmdW5jdGlvbiBjdChlKXtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHRoaXMuV2g9JGkoZSksQShjdClbdGhpcy5XaF09dGhpc31jdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShLLnByb3RvdHlwZSksY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPWN0LGN0LnByb3RvdHlwZS5YaD1jdCxjdC5ZaD17fSx0LmJ0Q29sbGlzaW9uRGlzcGF0Y2hlcj1jdCxjdC5wcm90b3R5cGUuZ2V0TnVtTWFuaWZvbGRzPWZ1bmN0aW9uKCl7cmV0dXJuIEppKHRoaXMuV2gpfSxjdC5wcm90b3R5cGUuZ2V0TWFuaWZvbGRCeUluZGV4SW50ZXJuYWw9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtyZXR1cm4gZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhKHRhKG8sZSkscSl9LGN0LnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe2VhKHRoaXMuV2gpfTtmdW5jdGlvbiBUdCgpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidE92ZXJsYXBwaW5nUGFpckNhbGxiYWNrLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifVR0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxUdC5wcm90b3R5cGUuY29uc3RydWN0b3I9VHQsVHQucHJvdG90eXBlLlhoPVR0LFR0LlloPXt9LHQuYnRPdmVybGFwcGluZ1BhaXJDYWxsYmFjaz1UdCxUdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtvYSh0aGlzLldoKX07ZnVuY3Rpb24gSigpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidE92ZXJsYXBwaW5nUGFpckNhY2hlLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifUoucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLEoucHJvdG90eXBlLmNvbnN0cnVjdG9yPUosSi5wcm90b3R5cGUuWGg9SixKLlloPXt9LHQuYnRPdmVybGFwcGluZ1BhaXJDYWNoZT1KLEoucHJvdG90eXBlLnNldEludGVybmFsR2hvc3RQYWlyQ2FsbGJhY2s9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG5hKG8sZSl9LEoucHJvdG90eXBlLmdldE51bU92ZXJsYXBwaW5nUGFpcnM9ZnVuY3Rpb24oKXtyZXR1cm4gcmEodGhpcy5XaCl9LEoucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7X2EodGhpcy5XaCl9O2Z1bmN0aW9uIHN0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0QnJvYWRwaGFzZUludGVyZmFjZSwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1zdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksc3QucHJvdG90eXBlLmNvbnN0cnVjdG9yPXN0LHN0LnByb3RvdHlwZS5YaD1zdCxzdC5ZaD17fSx0LmJ0QnJvYWRwaGFzZUludGVyZmFjZT1zdCxzdC5wcm90b3R5cGUuZ2V0T3ZlcmxhcHBpbmdQYWlyQ2FjaGU9ZnVuY3Rpb24oKXtyZXR1cm4gYShpYSh0aGlzLldoKSxKKX0sc3QucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7YWEodGhpcy5XaCl9O2Z1bmN0aW9uIEZ0KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29sbGlzaW9uQ29uZmlndXJhdGlvbiwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1GdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksRnQucHJvdG90eXBlLmNvbnN0cnVjdG9yPUZ0LEZ0LnByb3RvdHlwZS5YaD1GdCxGdC5ZaD17fSx0LmJ0Q29sbGlzaW9uQ29uZmlndXJhdGlvbj1GdCxGdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtzYSh0aGlzLldoKX07ZnVuY3Rpb24gRHQoKXt0aGlzLldoPXBhKCksQShEdClbdGhpcy5XaF09dGhpc31EdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksRHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPUR0LER0LnByb3RvdHlwZS5YaD1EdCxEdC5ZaD17fSx0LmJ0RGJ2dEJyb2FkcGhhc2U9RHQsRHQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bGEodGhpcy5XaCl9O2Z1bmN0aW9uIEIoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRCcm9hZHBoYXNlUHJveHksIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9Qi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksQi5wcm90b3R5cGUuY29uc3RydWN0b3I9QixCLnByb3RvdHlwZS5YaD1CLEIuWWg9e30sdC5idEJyb2FkcGhhc2VQcm94eT1CLEIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlckdyb3VwPUIucHJvdG90eXBlLlpoPWZ1bmN0aW9uKCl7cmV0dXJuIHVhKHRoaXMuV2gpfSxCLnByb3RvdHlwZS5zZXRfbV9jb2xsaXNpb25GaWx0ZXJHcm91cD1CLnByb3RvdHlwZS5haT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksY2EobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KEIucHJvdG90eXBlLCJtX2NvbGxpc2lvbkZpbHRlckdyb3VwIix7Z2V0OkIucHJvdG90eXBlLlpoLHNldDpCLnByb3RvdHlwZS5haX0pLEIucHJvdG90eXBlLmdldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Qi5wcm90b3R5cGUuJGg9ZnVuY3Rpb24oKXtyZXR1cm4geWEodGhpcy5XaCl9LEIucHJvdG90eXBlLnNldF9tX2NvbGxpc2lvbkZpbHRlck1hc2s9Qi5wcm90b3R5cGUuYmk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGhhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCLnByb3RvdHlwZSwibV9jb2xsaXNpb25GaWx0ZXJNYXNrIix7Z2V0OkIucHJvdG90eXBlLiRoLHNldDpCLnByb3RvdHlwZS5iaX0pLEIucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7ZmEodGhpcy5XaCl9O2Z1bmN0aW9uIF8oZSxvLG4scil7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLG4mJnR5cGVvZiBuPT0ib2JqZWN0IiYmKG49bi5XaCksciYmdHlwZW9mIHI9PSJvYmplY3QiJiYocj1yLldoKSx0aGlzLldoPXI9PT12b2lkIDA/bWEoZSxvLG4pOmJhKGUsbyxuLHIpLEEoXylbdGhpcy5XaF09dGhpc31fLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxfLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1fLF8ucHJvdG90eXBlLlhoPV8sXy5ZaD17fSx0LmJ0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mbz1fLF8ucHJvdG90eXBlLmdldF9tX2xpbmVhckRhbXBpbmc9Xy5wcm90b3R5cGUuR2k9ZnVuY3Rpb24oKXtyZXR1cm4gZ2EodGhpcy5XaCl9LF8ucHJvdG90eXBlLnNldF9tX2xpbmVhckRhbXBpbmc9Xy5wcm90b3R5cGUuQWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGRhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9saW5lYXJEYW1waW5nIix7Z2V0Ol8ucHJvdG90eXBlLkdpLHNldDpfLnByb3RvdHlwZS5Ban0pLF8ucHJvdG90eXBlLmdldF9tX2FuZ3VsYXJEYW1waW5nPV8ucHJvdG90eXBlLm9pPWZ1bmN0aW9uKCl7cmV0dXJuIFdhKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9hbmd1bGFyRGFtcGluZz1fLnByb3RvdHlwZS5qaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksQ2EobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2FuZ3VsYXJEYW1waW5nIix7Z2V0Ol8ucHJvdG90eXBlLm9pLHNldDpfLnByb3RvdHlwZS5qan0pLF8ucHJvdG90eXBlLmdldF9tX2ZyaWN0aW9uPV8ucHJvdG90eXBlLnlpPWZ1bmN0aW9uKCl7cmV0dXJuIGphKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9mcmljdGlvbj1fLnByb3RvdHlwZS5zaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdmEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2ZyaWN0aW9uIix7Z2V0Ol8ucHJvdG90eXBlLnlpLHNldDpfLnByb3RvdHlwZS5zan0pLF8ucHJvdG90eXBlLmdldF9tX3JvbGxpbmdGcmljdGlvbj1fLnByb3RvdHlwZS5SaT1mdW5jdGlvbigpe3JldHVybiBEYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fcm9sbGluZ0ZyaWN0aW9uPV8ucHJvdG90eXBlLkxqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxSYShvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoXy5wcm90b3R5cGUsIm1fcm9sbGluZ0ZyaWN0aW9uIix7Z2V0Ol8ucHJvdG90eXBlLlJpLHNldDpfLnByb3RvdHlwZS5Man0pLF8ucHJvdG90eXBlLmdldF9tX3Jlc3RpdHV0aW9uPV8ucHJvdG90eXBlLlFpPWZ1bmN0aW9uKCl7cmV0dXJuIFNhKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9yZXN0aXR1dGlvbj1fLnByb3RvdHlwZS5Laj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSWEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX3Jlc3RpdHV0aW9uIix7Z2V0Ol8ucHJvdG90eXBlLlFpLHNldDpfLnByb3RvdHlwZS5Lan0pLF8ucHJvdG90eXBlLmdldF9tX2xpbmVhclNsZWVwaW5nVGhyZXNob2xkPV8ucHJvdG90eXBlLkhpPWZ1bmN0aW9uKCl7cmV0dXJuIE9hKHRoaXMuV2gpfSxfLnByb3RvdHlwZS5zZXRfbV9saW5lYXJTbGVlcGluZ1RocmVzaG9sZD1fLnByb3RvdHlwZS5Caj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksQmEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2xpbmVhclNsZWVwaW5nVGhyZXNob2xkIix7Z2V0Ol8ucHJvdG90eXBlLkhpLHNldDpfLnByb3RvdHlwZS5Can0pLF8ucHJvdG90eXBlLmdldF9tX2FuZ3VsYXJTbGVlcGluZ1RocmVzaG9sZD1fLnByb3RvdHlwZS5waT1mdW5jdGlvbigpe3JldHVybiBQYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYW5ndWxhclNsZWVwaW5nVGhyZXNob2xkPV8ucHJvdG90eXBlLmtqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx4YShvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoXy5wcm90b3R5cGUsIm1fYW5ndWxhclNsZWVwaW5nVGhyZXNob2xkIix7Z2V0Ol8ucHJvdG90eXBlLnBpLHNldDpfLnByb3RvdHlwZS5ran0pLF8ucHJvdG90eXBlLmdldF9tX2FkZGl0aW9uYWxEYW1waW5nPV8ucHJvdG90eXBlLmtpPWZ1bmN0aW9uKCl7cmV0dXJuISFUYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYWRkaXRpb25hbERhbXBpbmc9Xy5wcm90b3R5cGUuZmo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEZhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9hZGRpdGlvbmFsRGFtcGluZyIse2dldDpfLnByb3RvdHlwZS5raSxzZXQ6Xy5wcm90b3R5cGUuZmp9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsRGFtcGluZ0ZhY3Rvcj1fLnByb3RvdHlwZS5saT1mdW5jdGlvbigpe3JldHVybiBNYSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYWRkaXRpb25hbERhbXBpbmdGYWN0b3I9Xy5wcm90b3R5cGUuZ2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEFhKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9hZGRpdGlvbmFsRGFtcGluZ0ZhY3RvciIse2dldDpfLnByb3RvdHlwZS5saSxzZXQ6Xy5wcm90b3R5cGUuZ2p9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsTGluZWFyRGFtcGluZ1RocmVzaG9sZFNxcj1fLnByb3RvdHlwZS5taT1mdW5jdGlvbigpe3JldHVybiB3YSh0aGlzLldoKX0sXy5wcm90b3R5cGUuc2V0X21fYWRkaXRpb25hbExpbmVhckRhbXBpbmdUaHJlc2hvbGRTcXI9Xy5wcm90b3R5cGUuaGo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGthKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfLnByb3RvdHlwZSwibV9hZGRpdGlvbmFsTGluZWFyRGFtcGluZ1RocmVzaG9sZFNxciIse2dldDpfLnByb3RvdHlwZS5taSxzZXQ6Xy5wcm90b3R5cGUuaGp9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdUaHJlc2hvbGRTcXI9Xy5wcm90b3R5cGUuamk9ZnVuY3Rpb24oKXtyZXR1cm4gTGEodGhpcy5XaCl9LF8ucHJvdG90eXBlLnNldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ1RocmVzaG9sZFNxcj1fLnByb3RvdHlwZS5laj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksSGEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ1RocmVzaG9sZFNxciIse2dldDpfLnByb3RvdHlwZS5qaSxzZXQ6Xy5wcm90b3R5cGUuZWp9KSxfLnByb3RvdHlwZS5nZXRfbV9hZGRpdGlvbmFsQW5ndWxhckRhbXBpbmdGYWN0b3I9Xy5wcm90b3R5cGUuaWk9ZnVuY3Rpb24oKXtyZXR1cm4gWWEodGhpcy5XaCl9LF8ucHJvdG90eXBlLnNldF9tX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3Rvcj1fLnByb3RvdHlwZS5kaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksVmEobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KF8ucHJvdG90eXBlLCJtX2FkZGl0aW9uYWxBbmd1bGFyRGFtcGluZ0ZhY3RvciIse2dldDpfLnByb3RvdHlwZS5paSxzZXQ6Xy5wcm90b3R5cGUuZGp9KSxfLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe1FhKHRoaXMuV2gpfTtmdW5jdGlvbiBsKGUpe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdGhpcy5XaD1FYShlKSxBKGwpW3RoaXMuV2hdPXRoaXN9bC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShDLnByb3RvdHlwZSksbC5wcm90b3R5cGUuY29uc3RydWN0b3I9bCxsLnByb3RvdHlwZS5YaD1sLGwuWWg9e30sdC5idFJpZ2lkQm9keT1sLGwucHJvdG90eXBlLmdldENlbnRlck9mTWFzc1RyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBhKFhhKHRoaXMuV2gpLE8pfSxsLnByb3RvdHlwZS5zZXRDZW50ZXJPZk1hc3NUcmFuc2Zvcm09ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFVhKG8sZSl9LGwucHJvdG90eXBlLnNldFNsZWVwaW5nVGhyZXNob2xkcz1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLEdhKG4sZSxvKX0sbC5wcm90b3R5cGUuZ2V0TGluZWFyRGFtcGluZz1mdW5jdGlvbigpe3JldHVybiBOYSh0aGlzLldoKX0sbC5wcm90b3R5cGUuZ2V0QW5ndWxhckRhbXBpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gemEodGhpcy5XaCl9LGwucHJvdG90eXBlLnNldERhbXBpbmc9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxxYShuLGUsbyl9LGwucHJvdG90eXBlLnNldE1hc3NQcm9wcz1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLFphKG4sZSxvKX0sbC5wcm90b3R5cGUuZ2V0TGluZWFyRmFjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIGEoS2EodGhpcy5XaCkseSl9LGwucHJvdG90eXBlLnNldExpbmVhckZhY3Rvcj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksJGEobyxlKX0sbC5wcm90b3R5cGUuYXBwbHlUb3JxdWU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEphKG8sZSl9LGwucHJvdG90eXBlLmFwcGx5TG9jYWxUb3JxdWU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHRzKG8sZSl9LGwucHJvdG90eXBlLmFwcGx5Rm9yY2U9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxlcyhuLGUsbyl9LGwucHJvdG90eXBlLmFwcGx5Q2VudHJhbEZvcmNlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvcyhvLGUpfSxsLnByb3RvdHlwZS5hcHBseUNlbnRyYWxMb2NhbEZvcmNlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxucyhvLGUpfSxsLnByb3RvdHlwZS5hcHBseVRvcnF1ZUltcHVsc2U9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHJzKG8sZSl9LGwucHJvdG90eXBlLmFwcGx5SW1wdWxzZT1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLF9zKG4sZSxvKX0sbC5wcm90b3R5cGUuYXBwbHlDZW50cmFsSW1wdWxzZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksaXMobyxlKX0sbC5wcm90b3R5cGUudXBkYXRlSW5lcnRpYVRlbnNvcj1mdW5jdGlvbigpe2FzKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5nZXRMaW5lYXJWZWxvY2l0eT1mdW5jdGlvbigpe3JldHVybiBhKHNzKHRoaXMuV2gpLHkpfSxsLnByb3RvdHlwZS5nZXRBbmd1bGFyVmVsb2NpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYShwcyh0aGlzLldoKSx5KX0sbC5wcm90b3R5cGUuc2V0TGluZWFyVmVsb2NpdHk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGxzKG8sZSl9LGwucHJvdG90eXBlLnNldEFuZ3VsYXJWZWxvY2l0eT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksdXMobyxlKX0sbC5wcm90b3R5cGUuZ2V0TW90aW9uU3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gYShjcyh0aGlzLldoKSxudCl9LGwucHJvdG90eXBlLnNldE1vdGlvblN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx5cyhvLGUpfSxsLnByb3RvdHlwZS5nZXRBbmd1bGFyRmFjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIGEoaHModGhpcy5XaCkseSl9LGwucHJvdG90eXBlLnNldEFuZ3VsYXJGYWN0b3I9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGZzKG8sZSl9LGwucHJvdG90eXBlLnVwY2FzdD1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO3JldHVybiBlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGEobXMobyxlKSxsKX0sbC5wcm90b3R5cGUuZ2V0QWFiYj1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLGJzKG4sZSxvKX0sbC5wcm90b3R5cGUuYXBwbHlHcmF2aXR5PWZ1bmN0aW9uKCl7Z3ModGhpcy5XaCl9LGwucHJvdG90eXBlLmdldEdyYXZpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYShkcyh0aGlzLldoKSx5KX0sbC5wcm90b3R5cGUuc2V0R3Jhdml0eT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksV3MobyxlKX0sbC5wcm90b3R5cGUuZ2V0QnJvYWRwaGFzZVByb3h5PWZ1bmN0aW9uKCl7cmV0dXJuIGEoQ3ModGhpcy5XaCksQil9LGwucHJvdG90eXBlLmNsZWFyRm9yY2VzPWZ1bmN0aW9uKCl7anModGhpcy5XaCl9LGwucHJvdG90eXBlLnNldEFuaXNvdHJvcGljRnJpY3Rpb249ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx2cyhuLGUsbyl9LGwucHJvdG90eXBlLmdldENvbGxpc2lvblNoYXBlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoRHModGhpcy5XaCksSCl9LGwucHJvdG90eXBlLnNldENvbnRhY3RQcm9jZXNzaW5nVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxScyhvLGUpfSxsLnByb3RvdHlwZS5zZXRBY3RpdmF0aW9uU3RhdGU9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFNzKG8sZSl9LGwucHJvdG90eXBlLmZvcmNlQWN0aXZhdGlvblN0YXRlPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxJcyhvLGUpfSxsLnByb3RvdHlwZS5hY3RpdmF0ZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZT09PXZvaWQgMD9PcyhvKTpCcyhvLGUpfSxsLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiEhUHModGhpcy5XaCl9LGwucHJvdG90eXBlLmlzS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISF4cyh0aGlzLldoKX0sbC5wcm90b3R5cGUuaXNTdGF0aWNPYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4hIVRzKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5pc1N0YXRpY09yS2luZW1hdGljT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuISFGcyh0aGlzLldoKX0sbC5wcm90b3R5cGUuZ2V0UmVzdGl0dXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gTXModGhpcy5XaCl9LGwucHJvdG90eXBlLmdldEZyaWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIEFzKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5nZXRSb2xsaW5nRnJpY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gd3ModGhpcy5XaCl9LGwucHJvdG90eXBlLnNldFJlc3RpdHV0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxrcyhvLGUpfSxsLnByb3RvdHlwZS5zZXRGcmljdGlvbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksTHMobyxlKX0sbC5wcm90b3R5cGUuc2V0Um9sbGluZ0ZyaWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxIcyhvLGUpfSxsLnByb3RvdHlwZS5nZXRXb3JsZFRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBhKFlzKHRoaXMuV2gpLE8pfSxsLnByb3RvdHlwZS5nZXRDb2xsaXNpb25GbGFncz1mdW5jdGlvbigpe3JldHVybiBWcyh0aGlzLldoKX0sbC5wcm90b3R5cGUuc2V0Q29sbGlzaW9uRmxhZ3M9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFFzKG8sZSl9LGwucHJvdG90eXBlLnNldFdvcmxkVHJhbnNmb3JtPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxFcyhvLGUpfSxsLnByb3RvdHlwZS5zZXRDb2xsaXNpb25TaGFwZT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWHMobyxlKX0sbC5wcm90b3R5cGUuc2V0Q2NkTW90aW9uVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxVcyhvLGUpfSxsLnByb3RvdHlwZS5zZXRDY2RTd2VwdFNwaGVyZVJhZGl1cz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksR3MobyxlKX0sbC5wcm90b3R5cGUuZ2V0VXNlckluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIE5zKHRoaXMuV2gpfSxsLnByb3RvdHlwZS5zZXRVc2VySW5kZXg9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHpzKG8sZSl9LGwucHJvdG90eXBlLmdldFVzZXJQb2ludGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEocXModGhpcy5XaCksYnQpfSxsLnByb3RvdHlwZS5zZXRVc2VyUG9pbnRlcj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksWnMobyxlKX0sbC5wcm90b3R5cGUuZ2V0QnJvYWRwaGFzZUhhbmRsZT1mdW5jdGlvbigpe3JldHVybiBhKEtzKHRoaXMuV2gpLEIpfSxsLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpeyRzKHRoaXMuV2gpfTtmdW5jdGlvbiBSdCgpe3RoaXMuV2g9SnMoKSxBKFJ0KVt0aGlzLldoXT10aGlzfVJ0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxSdC5wcm90b3R5cGUuY29uc3RydWN0b3I9UnQsUnQucHJvdG90eXBlLlhoPVJ0LFJ0LlloPXt9LHQuYnRTZXF1ZW50aWFsSW1wdWxzZUNvbnN0cmFpbnRTb2x2ZXI9UnQsUnQucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7dHAodGhpcy5XaCl9O2Z1bmN0aW9uIE10KCl7dGhyb3ciY2Fubm90IGNvbnN0cnVjdCBhIGJ0Q29uc3RyYWludFNvbHZlciwgbm8gY29uc3RydWN0b3IgaW4gSURMIn1NdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShiLnByb3RvdHlwZSksTXQucHJvdG90eXBlLmNvbnN0cnVjdG9yPU10LE10LnByb3RvdHlwZS5YaD1NdCxNdC5ZaD17fSx0LmJ0Q29uc3RyYWludFNvbHZlcj1NdCxNdC5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtlcCh0aGlzLldoKX07ZnVuY3Rpb24gcygpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidERpc3BhdGNoZXJJbmZvLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifXMucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLHMucHJvdG90eXBlLmNvbnN0cnVjdG9yPXMscy5wcm90b3R5cGUuWGg9cyxzLlloPXt9LHQuYnREaXNwYXRjaGVySW5mbz1zLHMucHJvdG90eXBlLmdldF9tX3RpbWVTdGVwPXMucHJvdG90eXBlLlhpPWZ1bmN0aW9uKCl7cmV0dXJuIG9wKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV90aW1lU3RlcD1zLnByb3RvdHlwZS5Saj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbnAobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMucHJvdG90eXBlLCJtX3RpbWVTdGVwIix7Z2V0OnMucHJvdG90eXBlLlhpLHNldDpzLnByb3RvdHlwZS5San0pLHMucHJvdG90eXBlLmdldF9tX3N0ZXBDb3VudD1zLnByb3RvdHlwZS5WaT1mdW5jdGlvbigpe3JldHVybiBycCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fc3RlcENvdW50PXMucHJvdG90eXBlLlBqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxfcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fc3RlcENvdW50Iix7Z2V0OnMucHJvdG90eXBlLlZpLHNldDpzLnByb3RvdHlwZS5Qan0pLHMucHJvdG90eXBlLmdldF9tX2Rpc3BhdGNoRnVuYz1zLnByb3RvdHlwZS51aT1mdW5jdGlvbigpe3JldHVybiBpcCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fZGlzcGF0Y2hGdW5jPXMucHJvdG90eXBlLm9qPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxhcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fZGlzcGF0Y2hGdW5jIix7Z2V0OnMucHJvdG90eXBlLnVpLHNldDpzLnByb3RvdHlwZS5van0pLHMucHJvdG90eXBlLmdldF9tX3RpbWVPZkltcGFjdD1zLnByb3RvdHlwZS5XaT1mdW5jdGlvbigpe3JldHVybiBzcCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fdGltZU9mSW1wYWN0PXMucHJvdG90eXBlLlFqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxwcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fdGltZU9mSW1wYWN0Iix7Z2V0OnMucHJvdG90eXBlLldpLHNldDpzLnByb3RvdHlwZS5Ran0pLHMucHJvdG90eXBlLmdldF9tX3VzZUNvbnRpbnVvdXM9cy5wcm90b3R5cGUuWmk9ZnVuY3Rpb24oKXtyZXR1cm4hIWxwKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV91c2VDb250aW51b3VzPXMucHJvdG90eXBlLlRqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx1cChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fdXNlQ29udGludW91cyIse2dldDpzLnByb3RvdHlwZS5aaSxzZXQ6cy5wcm90b3R5cGUuVGp9KSxzLnByb3RvdHlwZS5nZXRfbV9lbmFibGVTYXRDb252ZXg9cy5wcm90b3R5cGUud2k9ZnVuY3Rpb24oKXtyZXR1cm4hIWNwKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV9lbmFibGVTYXRDb252ZXg9cy5wcm90b3R5cGUucWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLHlwKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLnByb3RvdHlwZSwibV9lbmFibGVTYXRDb252ZXgiLHtnZXQ6cy5wcm90b3R5cGUud2ksc2V0OnMucHJvdG90eXBlLnFqfSkscy5wcm90b3R5cGUuZ2V0X21fZW5hYmxlU1BVPXMucHJvdG90eXBlLnZpPWZ1bmN0aW9uKCl7cmV0dXJuISFocCh0aGlzLldoKX0scy5wcm90b3R5cGUuc2V0X21fZW5hYmxlU1BVPXMucHJvdG90eXBlLnBqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxmcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fZW5hYmxlU1BVIix7Z2V0OnMucHJvdG90eXBlLnZpLHNldDpzLnByb3RvdHlwZS5wan0pLHMucHJvdG90eXBlLmdldF9tX3VzZUVwYT1zLnByb3RvdHlwZS5haj1mdW5jdGlvbigpe3JldHVybiEhbXAodGhpcy5XaCl9LHMucHJvdG90eXBlLnNldF9tX3VzZUVwYT1zLnByb3RvdHlwZS5Waj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksYnAobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMucHJvdG90eXBlLCJtX3VzZUVwYSIse2dldDpzLnByb3RvdHlwZS5haixzZXQ6cy5wcm90b3R5cGUuVmp9KSxzLnByb3RvdHlwZS5nZXRfbV9hbGxvd2VkQ2NkUGVuZXRyYXRpb249cy5wcm90b3R5cGUubmk9ZnVuY3Rpb24oKXtyZXR1cm4gZ3AodGhpcy5XaCl9LHMucHJvdG90eXBlLnNldF9tX2FsbG93ZWRDY2RQZW5ldHJhdGlvbj1zLnByb3RvdHlwZS5paj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksZHAobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMucHJvdG90eXBlLCJtX2FsbG93ZWRDY2RQZW5ldHJhdGlvbiIse2dldDpzLnByb3RvdHlwZS5uaSxzZXQ6cy5wcm90b3R5cGUuaWp9KSxzLnByb3RvdHlwZS5nZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWw9cy5wcm90b3R5cGUuJGk9ZnVuY3Rpb24oKXtyZXR1cm4hIVdwKHRoaXMuV2gpfSxzLnByb3RvdHlwZS5zZXRfbV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWw9cy5wcm90b3R5cGUuVWo9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLENwKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLnByb3RvdHlwZSwibV91c2VDb252ZXhDb25zZXJ2YXRpdmVEaXN0YW5jZVV0aWwiLHtnZXQ6cy5wcm90b3R5cGUuJGksc2V0OnMucHJvdG90eXBlLlVqfSkscy5wcm90b3R5cGUuZ2V0X21fY29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VUaHJlc2hvbGQ9cy5wcm90b3R5cGUucmk9ZnVuY3Rpb24oKXtyZXR1cm4ganAodGhpcy5XaCl9LHMucHJvdG90eXBlLnNldF9tX2NvbnZleENvbnNlcnZhdGl2ZURpc3RhbmNlVGhyZXNob2xkPXMucHJvdG90eXBlLmxqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSx2cChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5wcm90b3R5cGUsIm1fY29udmV4Q29uc2VydmF0aXZlRGlzdGFuY2VUaHJlc2hvbGQiLHtnZXQ6cy5wcm90b3R5cGUucmksc2V0OnMucHJvdG90eXBlLmxqfSkscy5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtEcCh0aGlzLldoKX07ZnVuY3Rpb24gUygpe3Rocm93ImNhbm5vdCBjb25zdHJ1Y3QgYSBidENvbnRhY3RTb2x2ZXJJbmZvLCBubyBjb25zdHJ1Y3RvciBpbiBJREwifVMucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYi5wcm90b3R5cGUpLFMucHJvdG90eXBlLmNvbnN0cnVjdG9yPVMsUy5wcm90b3R5cGUuWGg9UyxTLlloPXt9LHQuYnRDb250YWN0U29sdmVySW5mbz1TLFMucHJvdG90eXBlLmdldF9tX3NwbGl0SW1wdWxzZT1TLnByb3RvdHlwZS5UaT1mdW5jdGlvbigpe3JldHVybiEhUnAodGhpcy5XaCl9LFMucHJvdG90eXBlLnNldF9tX3NwbGl0SW1wdWxzZT1TLnByb3RvdHlwZS5Oaj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksU3AobyxlKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KFMucHJvdG90eXBlLCJtX3NwbGl0SW1wdWxzZSIse2dldDpTLnByb3RvdHlwZS5UaSxzZXQ6Uy5wcm90b3R5cGUuTmp9KSxTLnByb3RvdHlwZS5nZXRfbV9zcGxpdEltcHVsc2VQZW5ldHJhdGlvblRocmVzaG9sZD1TLnByb3RvdHlwZS5VaT1mdW5jdGlvbigpe3JldHVybiBJcCh0aGlzLldoKX0sUy5wcm90b3R5cGUuc2V0X21fc3BsaXRJbXB1bHNlUGVuZXRyYXRpb25UaHJlc2hvbGQ9Uy5wcm90b3R5cGUuT2o9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLE9wKG8sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTLnByb3RvdHlwZSwibV9zcGxpdEltcHVsc2VQZW5ldHJhdGlvblRocmVzaG9sZCIse2dldDpTLnByb3RvdHlwZS5VaSxzZXQ6Uy5wcm90b3R5cGUuT2p9KSxTLnByb3RvdHlwZS5nZXRfbV9udW1JdGVyYXRpb25zPVMucHJvdG90eXBlLk1pPWZ1bmN0aW9uKCl7cmV0dXJuIEJwKHRoaXMuV2gpfSxTLnByb3RvdHlwZS5zZXRfbV9udW1JdGVyYXRpb25zPVMucHJvdG90eXBlLkdqPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxQcChvLGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoUy5wcm90b3R5cGUsIm1fbnVtSXRlcmF0aW9ucyIse2dldDpTLnByb3RvdHlwZS5NaSxzZXQ6Uy5wcm90b3R5cGUuR2p9KSxTLnByb3RvdHlwZS5fX2Rlc3Ryb3lfXz1mdW5jdGlvbigpe3hwKHRoaXMuV2gpfTtmdW5jdGlvbiBJKGUsbyxuLHIpe2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksdGhpcy5XaD1UcChlLG8sbixyKSxBKEkpW3RoaXMuV2hdPXRoaXN9SS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh4LnByb3RvdHlwZSksSS5wcm90b3R5cGUuY29uc3RydWN0b3I9SSxJLnByb3RvdHlwZS5YaD1JLEkuWWg9e30sdC5idERpc2NyZXRlRHluYW1pY3NXb3JsZD1JLEkucHJvdG90eXBlLnNldEdyYXZpdHk9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLEZwKG8sZSl9LEkucHJvdG90eXBlLmdldEdyYXZpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYShNcCh0aGlzLldoKSx5KX0sSS5wcm90b3R5cGUuYWRkUmlnaWRCb2R5PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/QXAocixlKTpuPT09dm9pZCAwP19lYl9idERpc2NyZXRlRHluYW1pY3NXb3JsZF9hZGRSaWdpZEJvZHlfMihyLGUsbyk6d3AocixlLG8sbil9LEkucHJvdG90eXBlLnJlbW92ZVJpZ2lkQm9keT1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksa3AobyxlKX0sSS5wcm90b3R5cGUuc3RlcFNpbXVsYXRpb249ZnVuY3Rpb24oZSxvLG4pe3ZhciByPXRoaXMuV2g7cmV0dXJuIGUmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/THAocixlKTpuPT09dm9pZCAwP0hwKHIsZSxvKTpZcChyLGUsbyxuKX0sSS5wcm90b3R5cGUuc2V0Q29udGFjdEFkZGVkQ2FsbGJhY2s9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLFZwKG8sZSl9LEkucHJvdG90eXBlLnNldENvbnRhY3RQcm9jZXNzZWRDYWxsYmFjaz1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksUXAobyxlKX0sSS5wcm90b3R5cGUuc2V0Q29udGFjdERlc3Ryb3llZENhbGxiYWNrPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxFcChvLGUpfSxJLnByb3RvdHlwZS5nZXREaXNwYXRjaGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGEoWHAodGhpcy5XaCksSyl9LEkucHJvdG90eXBlLmdldFBhaXJDYWNoZT1mdW5jdGlvbigpe3JldHVybiBhKFVwKHRoaXMuV2gpLEopfSxJLnByb3RvdHlwZS5nZXREaXNwYXRjaEluZm89ZnVuY3Rpb24oKXtyZXR1cm4gYShHcCh0aGlzLldoKSxzKX0sSS5wcm90b3R5cGUuYWRkQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/TnAocixlKTpuPT09dm9pZCAwP3pwKHIsZSxvKTpxcChyLGUsbyxuKX0sSS5wcm90b3R5cGUucmVtb3ZlQ29sbGlzaW9uT2JqZWN0PWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxacChvLGUpfSxJLnByb3RvdHlwZS5nZXRCcm9hZHBoYXNlPWZ1bmN0aW9uKCl7cmV0dXJuIGEoS3AodGhpcy5XaCksc3QpfSxJLnByb3RvdHlwZS5jb252ZXhTd2VlcFRlc3Q9ZnVuY3Rpb24oZSxvLG4scixjKXt2YXIgRD10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLHImJnR5cGVvZiByPT0ib2JqZWN0IiYmKHI9ci5XaCksYyYmdHlwZW9mIGM9PSJvYmplY3QiJiYoYz1jLldoKSwkcChELGUsbyxuLHIsYyl9LEkucHJvdG90eXBlLmNvbnRhY3RQYWlyVGVzdD1mdW5jdGlvbihlLG8sbil7dmFyIHI9dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLG8mJnR5cGVvZiBvPT0ib2JqZWN0IiYmKG89by5XaCksbiYmdHlwZW9mIG49PSJvYmplY3QiJiYobj1uLldoKSxKcChyLGUsbyxuKX0sSS5wcm90b3R5cGUuY29udGFjdFRlc3Q9ZnVuY3Rpb24oZSxvKXt2YXIgbj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSx0bChuLGUsbyl9LEkucHJvdG90eXBlLnVwZGF0ZVNpbmdsZUFhYmI9ZnVuY3Rpb24oZSl7dmFyIG89dGhpcy5XaDtlJiZ0eXBlb2YgZT09Im9iamVjdCImJihlPWUuV2gpLGVsKG8sZSl9LEkucHJvdG90eXBlLmFkZEFjdGlvbj1mdW5jdGlvbihlKXt2YXIgbz10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksb2wobyxlKX0sSS5wcm90b3R5cGUucmVtb3ZlQWN0aW9uPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxubChvLGUpfSxJLnByb3RvdHlwZS5nZXRTb2x2ZXJJbmZvPWZ1bmN0aW9uKCl7cmV0dXJuIGEocmwodGhpcy5XaCksUyl9LEkucHJvdG90eXBlLnNldEludGVybmFsVGlja0NhbGxiYWNrPWZ1bmN0aW9uKGUsbyxuKXt2YXIgcj10aGlzLldoO2UmJnR5cGVvZiBlPT0ib2JqZWN0IiYmKGU9ZS5XaCksbyYmdHlwZW9mIG89PSJvYmplY3QiJiYobz1vLldoKSxuJiZ0eXBlb2Ygbj09Im9iamVjdCImJihuPW4uV2gpLG89PT12b2lkIDA/X2wocixlKTpuPT09dm9pZCAwP2lsKHIsZSxvKTphbChyLGUsbyxuKX0sSS5wcm90b3R5cGUuX19kZXN0cm95X189ZnVuY3Rpb24oKXtzbCh0aGlzLldoKX07ZnVuY3Rpb24gU3QoKXt0aHJvdyJjYW5ub3QgY29uc3RydWN0IGEgYnRBY3Rpb25JbnRlcmZhY2UsIG5vIGNvbnN0cnVjdG9yIGluIElETCJ9cmV0dXJuIFN0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGIucHJvdG90eXBlKSxTdC5wcm90b3R5cGUuY29uc3RydWN0b3I9U3QsU3QucHJvdG90eXBlLlhoPVN0LFN0LlloPXt9LHQuYnRBY3Rpb25JbnRlcmZhY2U9U3QsU3QucHJvdG90eXBlLnVwZGF0ZUFjdGlvbj1mdW5jdGlvbihlLG8pe3ZhciBuPXRoaXMuV2g7ZSYmdHlwZW9mIGU9PSJvYmplY3QiJiYoZT1lLldoKSxvJiZ0eXBlb2Ygbz09Im9iamVjdCImJihvPW8uV2gpLHBsKG4sZSxvKX0sU3QucHJvdG90eXBlLl9fZGVzdHJveV9fPWZ1bmN0aW9uKCl7bGwodGhpcy5XaCl9LGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3QuUEhZX0ZMT0FUPXVsKCksdC5QSFlfRE9VQkxFPWNsKCksdC5QSFlfSU5URUdFUj15bCgpLHQuUEhZX1NIT1JUPWhsKCksdC5QSFlfRklYRURQT0lOVDg4PWZsKCksdC5QSFlfVUNIQVI9bWwoKX1PZT9lKCk6VnQudW5zaGlmdChlKX0oKSx0LkNPTlRBQ1RfQURERURfQ0FMTEJBQ0tfU0lHTkFUVVJFPSJpaWlpaWlpaSIsdC5DT05UQUNUX0RFU1RST1lFRF9DQUxMQkFDS19TSUdOQVRVUkU9ImlpIix0LkNPTlRBQ1RfUFJPQ0VTU0VEX0NBTExCQUNLX1NJR05BVFVSRT0iaWlpaSIsdC5JTlRFUk5BTF9USUNLX0NBTExCQUNLX1NJR05BVFVSRT0idmlmIix0aGlzLkFtbW89dCxwLnJlYWR5fWxldCBBdD1bXSxOdD1bXSxJdD17fSxaLGcsdWUsS3QsY2UsJHQ9MTUwLEp0PTE1MCxodD0xLHRlPSExLGplPTYwLGk9ey4uLntzaXplOjkuNSxzdGFydGluZ0hlaWdodDo4LHNwaW5Gb3JjZTo2LHRocm93Rm9yY2U6NSxncmF2aXR5OjEsbWFzczoxLGZyaWN0aW9uOi44LHJlc3RpdHV0aW9uOi4xLGxpbmVhckRhbXBpbmc6LjUsYW5ndWxhckRhbXBpbmc6LjQsc2V0dGxlVGltZW91dDo1ZTN9fSx5ZSxrO3NlbGYub25tZXNzYWdlPXA9Pntzd2l0Y2gocC5kYXRhLmFjdGlvbil7Y2FzZSJyb2xsRGllIjpiZShwLmRhdGEuc2lkZXMpO2JyZWFrO2Nhc2UiaW5pdCI6ZGwocC5kYXRhKS50aGVuKCgpPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJpbml0LWNvbXBsZXRlIn0pfSk7YnJlYWs7Y2FzZSJjbGVhckRpY2UiOlJsKCk7YnJlYWs7Y2FzZSJyZW1vdmVEaWUiOkRlKHAuZGF0YS5pZCk7YnJlYWs7Y2FzZSJyZXNpemUiOiR0PXAuZGF0YS53aWR0aCxKdD1wLmRhdGEuaGVpZ2h0LGh0PSR0L0p0LG1lKGkuc2l6ZSxpLnN0YXJ0aW5nSGVpZ2h0KzEwKTticmVhaztjYXNlInVwZGF0ZUNvbmZpZyI6V2wocC5kYXRhLm9wdGlvbnMpO2JyZWFrO2Nhc2UiY29ubmVjdCI6dWU9cC5wb3J0c1swXSx1ZS5vbm1lc3NhZ2U9dD0+e3N3aXRjaCh0LmRhdGEuYWN0aW9uKXtjYXNlImluaXRCdWZmZXIiOms9bmV3IEZsb2F0MzJBcnJheSh0LmRhdGEuZGljZUJ1ZmZlciksa1swXT0tMTticmVhaztjYXNlImxvYWRNb2RlbHMiOkNsKHQuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImFkZERpZSI6dC5kYXRhLm9wdGlvbnMubmV3U3RhcnRQb2ludCYmaGUoKTtjb25zdCBtPURsKHQuZGF0YS5vcHRpb25zKTtiZShtKTticmVhaztjYXNlInJvbGxEaWUiOmJlKHQuZGF0YS5pZCk7YnJlYWs7Y2FzZSJyZW1vdmVEaWUiOkRlKHQuZGF0YS5pZCk7YnJlYWs7Y2FzZSJzdG9wU2ltdWxhdGlvbiI6dGU9ITA7YnJlYWs7Y2FzZSJyZXN1bWVTaW11bGF0aW9uIjp0LmRhdGEubmV3U3RhcnRQb2ludCYmaGUoKSx0ZT0hMSxTZSgpO2JyZWFrO2Nhc2Uic3RlcFNpbXVsYXRpb24iOms9bmV3IEZsb2F0MzJBcnJheSh0LmRhdGEuZGljZUJ1ZmZlciksU2UoKTticmVhaztkZWZhdWx0OmNvbnNvbGUuZXJyb3IoImFjdGlvbiBub3QgZm91bmQgaW4gcGh5c2ljcyB3b3JrZXIgZnJvbSB3b3JsZE9mZnNjcmVlbiB3b3JrZXI6Iix0LmRhdGEuYWN0aW9uKX19O2JyZWFrO2RlZmF1bHQ6Y29uc29sZS5lcnJvcigiYWN0aW9uIG5vdCBmb3VuZCBpbiBwaHlzaWNzIHdvcmtlcjoiLHAuZGF0YS5hY3Rpb24pfX07Y29uc3QgZGw9YXN5bmMgcD0+eyR0PXAud2lkdGgsSnQ9cC5oZWlnaHQsaHQ9JHQvSnQsaT17Li4uaSwuLi5wLm9wdGlvbnN9LGkuZ3Jhdml0eT09PTB8fGkuZ3Jhdml0eStpLm1hc3MvMyxpLm1hc3M9MStpLm1hc3MvMyxpLnNwaW5Gb3JjZT1pLnNwaW5Gb3JjZS9qZSxpLnRocm93Rm9yY2U9aS50aHJvd0ZvcmNlLzIvaS5tYXNzKigxK2kuc2NhbGUvNiksaS5zdGFydGluZ0hlaWdodD1pLnN0YXJ0aW5nSGVpZ2h0PDE/MTppLnN0YXJ0aW5nSGVpZ2h0O2NvbnN0IHQ9e2xvY2F0ZUZpbGU6KCk9PmAke2kub3JpZ2luK2kuYXNzZXRQYXRofWFtbW8vYW1tby53YXNtLndhc21gfTtnPWF3YWl0IG5ldyBnbCh0KSxLdD1uZXcgZy5idFRyYW5zZm9ybSxjZT1uZXcgZy5idFZlY3RvcjMoMCwwLDApLHllPVAoMCwwLDApLGhlKCksWj1TbCgpLG1lKGkuc2l6ZSxpLnN0YXJ0aW5nSGVpZ2h0KzEwKX0sV2w9cD0+e2k9ey4uLmksLi4ucH0saS5tYXNzPTEraS5tYXNzLzMsaS5ncmF2aXR5PWkuZ3Jhdml0eT09PTA/MDppLmdyYXZpdHkraS5tYXNzLzMsaS5zcGluRm9yY2U9aS5zcGluRm9yY2UvamUsaS50aHJvd0ZvcmNlPWkudGhyb3dGb3JjZS8yL2kubWFzcyooMStpLnNjYWxlLzYpLGkuc3RhcnRpbmdIZWlnaHQ9aS5zdGFydGluZ0hlaWdodDwxPzE6aS5zdGFydGluZ0hlaWdodCx2ZSgpLG1lKGkuc2l6ZSxpLnN0YXJ0aW5nSGVpZ2h0KzEwKSxaLnNldEdyYXZpdHkoUCgwLC05LjgxKmkuZ3Jhdml0eSwwKSksT2JqZWN0LnZhbHVlcyhJdCkubWFwKHQ9Pnt0LmNvbnZleEh1bGwuc2V0TG9jYWxTY2FsaW5nKFAoaS5zY2FsZSxpLnNjYWxlLGkuc2NhbGUpKX0pfSxDbD1hc3luYyh7Y29sbGlkZXJzOnAsbWVzaE5hbWU6dH0pPT57bGV0IG09ITEsZD0hMTtwLmZvckVhY2goKGosVik9PntJdFt0KyJfIitqLm5hbWVdPWosSXRbdCsiXyIrai5uYW1lXS5jb252ZXhIdWxsPWpsKGopLGR8fChkPWouaWQ9PT0iZDEwX2NvbGxpZGVyIiksbXx8KG09ai5pZD09PSJkMTAwX2NvbGxpZGVyIil9KSwhbSYmZCYmKEl0W2Ake3R9X2QxMDBfY29sbGlkZXJgXT1JdFtgJHt0fV9kMTBfY29sbGlkZXJgXSl9LFA9KHAsdCxtKT0+KGNlLnNldFZhbHVlKHAsdCxtKSxjZSksaGU9KCk9PntsZXQgcD1pLnNpemUsdD0uNSxtPXAqaHQvMi10LGQ9cCpodC8tMit0LGo9cC8yLXQsVj1wLy0yK3QsWD1wdChtLGQsTWF0aC5yYW5kb20oKSksVT1wdChqLFYsTWF0aC5yYW5kb20oKSksRz1NYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpLHY9TWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSxRPU1hdGgucm91bmQoTWF0aC5yYW5kb20oKSk7aS5zdGFydFBvc2l0aW9uPVtRP1g6dj9kOm0saS5zdGFydGluZ0hlaWdodCxRP0c/VjpqOlVdfSxqbD1wPT57Y29uc3QgdD1uZXcgZy5idENvbnZleEh1bGxTaGFwZTtsZXQgbT1wLnBvc2l0aW9ucy5sZW5ndGg7Zm9yKGxldCBkPTA7ZDxtO2QrPTMpe2xldCBqPVAocC5wb3NpdGlvbnNbZF0scC5wb3NpdGlvbnNbZCsxXSxwLnBvc2l0aW9uc1tkKzJdKTt0LmFkZFBvaW50KGosITApfXJldHVybiB0LnNldExvY2FsU2NhbGluZyhQKHAuc2NhbGluZ1swXSppLnNjYWxlLHAuc2NhbGluZ1sxXSppLnNjYWxlLHAuc2NhbGluZ1syXSppLnNjYWxlKSksdH0sdmw9KHAsdCk9Pntjb25zdHttYXNzOm09LjEsY29sbGlzaW9uRmxhZ3M6ZD0wLHBvczpqPVswLDAsMF0scXVhdDpWPVtwdCgtMS41LDEuNSxNYXRoLnJhbmRvbSgpKSxwdCgtMS41LDEuNSxNYXRoLnJhbmRvbSgpKSxwdCgtMS41LDEuNSxNYXRoLnJhbmRvbSgpKSwtMV0sc2NhbGU6WD1bMSwxLDFdLGZyaWN0aW9uOlU9aS5mcmljdGlvbixyZXN0aXR1dGlvbjpHPWkucmVzdGl0dXRpb259PXQsdj1uZXcgZy5idFRyYW5zZm9ybTt2LnNldElkZW50aXR5KCksdi5zZXRPcmlnaW4oUChqWzBdLGpbMV0salsyXSkpLHYuc2V0Um90YXRpb24obmV3IGcuYnRRdWF0ZXJuaW9uKFZbMF0sVlsxXSxWWzJdLFZbM10pKTtjb25zdCBRPW5ldyBnLmJ0RGVmYXVsdE1vdGlvblN0YXRlKHYpLHR0PVAoMCwwLDApO20+MCYmcC5jYWxjdWxhdGVMb2NhbEluZXJ0aWEobSx0dCk7Y29uc3Qgd3Q9bmV3IGcuYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvKG0sUSxwLHR0KSx6PW5ldyBnLmJ0UmlnaWRCb2R5KHd0KTtyZXR1cm4gbT4wJiZ6LnNldEFjdGl2YXRpb25TdGF0ZSg0KSx6LnNldENvbGxpc2lvbkZsYWdzKGQpLHouc2V0RnJpY3Rpb24oVSksei5zZXRSZXN0aXR1dGlvbihHKSx6LnNldERhbXBpbmcoaS5saW5lYXJEYW1waW5nLGkuYW5ndWxhckRhbXBpbmcpLHp9O2xldCBmZT1bXTtjb25zdCBtZT0ocCx0KT0+e2NvbnN0IG09W10sZD1QKDAsMCwwKSxqPW5ldyBnLmJ0VHJhbnNmb3JtO2ouc2V0SWRlbnRpdHkoKSxqLnNldE9yaWdpbihQKDAsLS41LDApKTtjb25zdCBWPW5ldyBnLmJ0Qm94U2hhcGUoUChwKmh0LDEscCkpLFg9bmV3IGcuYnREZWZhdWx0TW90aW9uU3RhdGUoaiksVT1uZXcgZy5idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm8oMCxYLFYsZCksRz1uZXcgZy5idFJpZ2lkQm9keShVKTtHLnNldEZyaWN0aW9uKGkuZnJpY3Rpb24pLEcuc2V0UmVzdGl0dXRpb24oaS5yZXN0aXR1dGlvbiksWi5hZGRSaWdpZEJvZHkoRyksbS5wdXNoKEcpO2NvbnN0IHY9bmV3IGcuYnRUcmFuc2Zvcm07di5zZXRJZGVudGl0eSgpLHYuc2V0T3JpZ2luKFAoMCx0LS41LDApKTtjb25zdCBRPW5ldyBnLmJ0Qm94U2hhcGUoUChwKmh0LDEscCkpLHR0PW5ldyBnLmJ0RGVmYXVsdE1vdGlvblN0YXRlKHYpLHd0PW5ldyBnLmJ0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mbygwLHR0LFEsZCksej1uZXcgZy5idFJpZ2lkQm9keSh3dCk7ei5zZXRGcmljdGlvbihpLmZyaWN0aW9uKSx6LnNldFJlc3RpdHV0aW9uKGkucmVzdGl0dXRpb24pLFouYWRkUmlnaWRCb2R5KHopLG0ucHVzaCh6KTtjb25zdCB6dD1uZXcgZy5idFRyYW5zZm9ybTt6dC5zZXRJZGVudGl0eSgpLHp0LnNldE9yaWdpbihQKDAsMCxwLy0yLS41KSk7Y29uc3QgT3Q9bmV3IGcuYnRCb3hTaGFwZShQKHAqaHQsdCwxKSksZWU9bmV3IGcuYnREZWZhdWx0TW90aW9uU3RhdGUoenQpLEJ0PW5ldyBnLmJ0UmlnaWRCb2R5Q29uc3RydWN0aW9uSW5mbygwLGVlLE90LGQpLGZ0PW5ldyBnLmJ0UmlnaWRCb2R5KEJ0KTtmdC5zZXRGcmljdGlvbihpLmZyaWN0aW9uKSxmdC5zZXRSZXN0aXR1dGlvbihpLnJlc3RpdHV0aW9uKSxaLmFkZFJpZ2lkQm9keShmdCksbS5wdXNoKGZ0KTtjb25zdCBrdD1uZXcgZy5idFRyYW5zZm9ybTtrdC5zZXRJZGVudGl0eSgpLGt0LnNldE9yaWdpbihQKDAsMCxwLzIrLjUpKTtjb25zdCBXdD1uZXcgZy5idEJveFNoYXBlKFAocCpodCx0LDEpKSxvZT1uZXcgZy5idERlZmF1bHRNb3Rpb25TdGF0ZShrdCksTHQ9bmV3IGcuYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvKDAsb2UsV3QsZCksQ3Q9bmV3IGcuYnRSaWdpZEJvZHkoTHQpO0N0LnNldEZyaWN0aW9uKGkuZnJpY3Rpb24pLEN0LnNldFJlc3RpdHV0aW9uKGkucmVzdGl0dXRpb24pLFouYWRkUmlnaWRCb2R5KEN0KSxtLnB1c2goQ3QpO2NvbnN0IEh0PW5ldyBnLmJ0VHJhbnNmb3JtO0h0LnNldElkZW50aXR5KCksSHQuc2V0T3JpZ2luKFAocCpodC8tMi0uNSwwLDApKTtjb25zdCBZdD1uZXcgZy5idEJveFNoYXBlKFAoMSx0LHApKSxYdD1uZXcgZy5idERlZmF1bHRNb3Rpb25TdGF0ZShIdCksbmU9bmV3IGcuYnRSaWdpZEJvZHlDb25zdHJ1Y3Rpb25JbmZvKDAsWHQsWXQsZCksUHQ9bmV3IGcuYnRSaWdpZEJvZHkobmUpO1B0LnNldEZyaWN0aW9uKGkuZnJpY3Rpb24pLFB0LnNldFJlc3RpdHV0aW9uKGkucmVzdGl0dXRpb24pLFouYWRkUmlnaWRCb2R5KFB0KSxtLnB1c2goUHQpO2NvbnN0IGV0PW5ldyBnLmJ0VHJhbnNmb3JtO2V0LnNldElkZW50aXR5KCksZXQuc2V0T3JpZ2luKFAocCpodC8yKy41LDAsMCkpO2NvbnN0IFV0PW5ldyBnLmJ0Qm94U2hhcGUoUCgxLHQscCkpLHJlPW5ldyBnLmJ0RGVmYXVsdE1vdGlvblN0YXRlKGV0KSxfZT1uZXcgZy5idFJpZ2lkQm9keUNvbnN0cnVjdGlvbkluZm8oMCxyZSxVdCxkKSxWdD1uZXcgZy5idFJpZ2lkQm9keShfZSk7VnQuc2V0RnJpY3Rpb24oaS5mcmljdGlvbiksVnQuc2V0UmVzdGl0dXRpb24oaS5yZXN0aXR1dGlvbiksWi5hZGRSaWdpZEJvZHkoVnQpLG0ucHVzaChWdCksZmUubGVuZ3RoJiZ2ZSgpLGZlPVsuLi5tXX0sdmU9KCk9PntmZS5mb3JFYWNoKHA9PloucmVtb3ZlUmlnaWRCb2R5KHApKX0sRGw9cD0+e3ZhciB0dDtjb25zdHtzaWRlczp0LGlkOm0sbWVzaE5hbWU6ZCxzY2FsZTpqfT1wO2xldCBYPWAke051bWJlci5pc0ludGVnZXIodCk/YGQke3R9YDp0fV9jb2xsaWRlcmA7Y29uc3QgVT1gJHtkfV8ke1h9YCx2PSgoKHR0PUl0W1VdKT09bnVsbD92b2lkIDA6dHQucGh5c2ljc01hc3MpfHwuMSkqaS5tYXNzKmkuc2NhbGUsUT12bChJdFtVXS5jb252ZXhIdWxsLHttYXNzOnYsc2NhbGluZzpJdFtVXS5zY2FsaW5nLHBvczppLnN0YXJ0UG9zaXRpb259KTtyZXR1cm4gUS5pZD1tLFEudGltZW91dD1pLnNldHRsZVRpbWVvdXQsUS5tYXNzPXYsWi5hZGRSaWdpZEJvZHkoUSksQXQucHVzaChRKSxRfSxiZT1wPT57cC5zZXRMaW5lYXJWZWxvY2l0eShQKHB0KC1pLnN0YXJ0UG9zaXRpb25bMF0qLjUsLWkuc3RhcnRQb3NpdGlvblswXSppLnRocm93Rm9yY2UsTWF0aC5yYW5kb20oKSkscHQoLWkuc3RhcnRQb3NpdGlvblsxXSwtaS5zdGFydFBvc2l0aW9uWzFdKjIsTWF0aC5yYW5kb20oKSkscHQoLWkuc3RhcnRQb3NpdGlvblsyXSouNSwtaS5zdGFydFBvc2l0aW9uWzJdKmkudGhyb3dGb3JjZSxNYXRoLnJhbmRvbSgpKSkpO2NvbnN0IHQ9bmV3IGcuYnRWZWN0b3IzKHB0KC1pLnNwaW5Gb3JjZSxpLnNwaW5Gb3JjZSxNYXRoLnJhbmRvbSgpKSxwdCgtaS5zcGluRm9yY2UsaS5zcGluRm9yY2UsTWF0aC5yYW5kb20oKSkscHQoLWkuc3BpbkZvcmNlLGkuc3BpbkZvcmNlLE1hdGgucmFuZG9tKCkpKSxtPU1hdGguYWJzKGkuc2NhbGUtMSkraS5zY2FsZSppLnNjYWxlKihwLm1hc3MvaS5tYXNzKSouNzU7cC5hcHBseUltcHVsc2UodCxQKG0sbSxtKSl9LERlPXA9PntOdD1OdC5maWx0ZXIodD0+e2xldCBtPXQuaWQ9PT1wO3JldHVybiBtJiZaLnJlbW92ZVJpZ2lkQm9keSh0KSwhbX0pfSxSbD0oKT0+e2suYnl0ZUxlbmd0aCYmay5maWxsKDApLHRlPSEwLEF0LmZvckVhY2gocD0+Wi5yZW1vdmVSaWdpZEJvZHkocCkpLE50LmZvckVhY2gocD0+Wi5yZW1vdmVSaWdpZEJvZHkocCkpLEF0PVtdLE50PVtdfSxTbD0oKT0+e2NvbnN0IHA9bmV3IGcuYnREZWZhdWx0Q29sbGlzaW9uQ29uZmlndXJhdGlvbix0PW5ldyBnLmJ0RGJ2dEJyb2FkcGhhc2UsbT1uZXcgZy5idFNlcXVlbnRpYWxJbXB1bHNlQ29uc3RyYWludFNvbHZlcixkPW5ldyBnLmJ0Q29sbGlzaW9uRGlzcGF0Y2hlcihwKSxqPW5ldyBnLmJ0RGlzY3JldGVEeW5hbWljc1dvcmxkKGQsdCxtLHApO3JldHVybiBqLnNldEdyYXZpdHkoUCgwLC05LjgxKmkuZ3Jhdml0eSwwKSksan0sSWw9cD0+e2NvbnN0IHQ9cC8xZTM7Wi5zdGVwU2ltdWxhdGlvbih0LDIsMS85MCksa1swXT1BdC5sZW5ndGg7Zm9yKGxldCBtPUF0Lmxlbmd0aC0xO20+PTA7bS0tKXtjb25zdCBkPUF0W21dLGo9ZC5nZXRMaW5lYXJWZWxvY2l0eSgpLmxlbmd0aCgpLFY9ZC5nZXRBbmd1bGFyVmVsb2NpdHkoKS5sZW5ndGgoKTtpZihqPC4wMSYmVjwuMDA1fHxkLnRpbWVvdXQ8MCl7a1ttKjgrMV09ZC5pZCxrW20qOCsyXT0tMSxkLmFzbGVlcD0hMCxkLnNldE1hc3NQcm9wcygwKSxkLmZvcmNlQWN0aXZhdGlvblN0YXRlKDMpLGQuc2V0TGluZWFyVmVsb2NpdHkoeWUpLGQuc2V0QW5ndWxhclZlbG9jaXR5KHllKSxOdC5wdXNoKEF0LnNwbGljZShtLDEpWzBdKTtjb250aW51ZX1kLnRpbWVvdXQtPXA7Y29uc3QgWD1kLmdldE1vdGlvblN0YXRlKCk7aWYoWCl7WC5nZXRXb3JsZFRyYW5zZm9ybShLdCk7bGV0IFU9S3QuZ2V0T3JpZ2luKCksRz1LdC5nZXRSb3RhdGlvbigpLHY9bSo4KzE7a1t2XT1kLmlkLGtbdisxXT1VLngoKSxrW3YrMl09VS55KCksa1t2KzNdPVUueigpLGtbdis0XT1HLngoKSxrW3YrNV09Ry55KCksa1t2KzZdPUcueigpLGtbdis3XT1HLncoKX19fTtsZXQgUmU9bmV3IERhdGUoKS5nZXRUaW1lKCk7Y29uc3QgU2U9KCk9PntsZXQgcD1uZXcgRGF0ZSgpLmdldFRpbWUoKTtjb25zdCB0PXAtUmU7UmU9cCwhdGUmJmsuYnl0ZUxlbmd0aCYmKElsKHQpLHVlLnBvc3RNZXNzYWdlKHthY3Rpb246InVwZGF0ZXMiLGRpY2VCdWZmZXI6ay5idWZmZXJ9LFtrLmJ1ZmZlcl0pKX19KSgpOwo=",
O$$module$libs$dice_box_es="u">typeof window&&window.Blob&&new Blob([atob($$$module$libs$dice_box_es)],{type:"text/javascript;charset=utf-8"});function Gl$$module$libs$dice_box_es(){const a=O$$module$libs$dice_box_es&&(window.URL||window.webkitURL).createObjectURL(O$$module$libs$dice_box_es);try{return a?new Worker(a):new Worker("data:application/javascript;base64,"+$$$module$libs$dice_box_es)}finally{a&&(window.URL||window.webkitURL).revokeObjectURL(a)}}
const Wl$$module$libs$dice_box_es=a=>{let b;return function(){let c=this,d=arguments;b&&window.cancelAnimationFrame(b);b=window.requestAnimationFrame(function(){a.apply(c,d)})}},Vl$$module$libs$dice_box_es=(a={dedupe:!1})=>{const {dedupe:b}=a;let c=[],d;const e=async()=>{const g=[];for(;c.length;){const n=c.shift();g.push(await n())}return g};return{push:g=>(b&&(c=[]),c.push(g),d||=e(),d.finally(()=>{d=void 0})),queue:c,flush:()=>d||Promise.resolve([])}},Jl$$module$libs$dice_box_es=a=>JSON.parse(JSON.stringify(a));
class q$$module$libs$dice_box_es{static value(){const a=window.crypto||window.msCrypto,b=new Uint32Array(1);return a.getRandomValues(b)[0]/2**32}static range(a,b){return Math.floor(Math.pow(10,14)*this.value()*this.value())%(b-a+1)+a}}
const Rl$$module$libs$dice_box_es=a=>{let b=!1;a=a.slice(a.startsWith("#")?1:0);3===a.length?a=[...a].map(d=>d+d).join(""):8===a.length&&(b=!0);a=parseInt(a,16);let c={r:a>>>16,g:(a&65280)>>>8,b:a&255};return b&&(c.r=a>>>24,c.g=(a&16711680)>>>16,c.b=(a&65280)>>>8,c.a=a&255),c},ul$$module$libs$dice_box_es={id:`dice-canvas-${Date.now()}`,enableShadows:!0,shadowTransparency:.8,lightIntensity:1,delay:10,scale:5,theme:"default",themeColor:"#2e8555",offscreen:!0,assetPath:"/assets/dice-box/",origin:"u">
typeof window?window.location.origin:"",meshFile:"models/default.json",suspendSimulation:!1};
var F$$module$libs$dice_box_es,f$$module$libs$dice_box_es,x$$module$libs$dice_box_es,e$$module$libs$dice_box_es,u$$module$libs$dice_box_es,K$$module$libs$dice_box_es,z$$module$libs$dice_box_es,a$$module$libs$dice_box_es,t$$module$libs$dice_box_es,B$$module$libs$dice_box_es,Q$$module$libs$dice_box_es,_$$module$libs$dice_box_es,P$$module$libs$dice_box_es,ll$$module$libs$dice_box_es,j$$module$libs$dice_box_es,bl$$module$libs$dice_box_es,w$$module$libs$dice_box_es,M$$module$libs$dice_box_es,C$$module$libs$dice_box_es,
D$$module$libs$dice_box_es;
class il$$module$libs$dice_box_es{constructor(a,b={}){J$$module$libs$dice_box_es(this,Q$$module$libs$dice_box_es);J$$module$libs$dice_box_es(this,P$$module$libs$dice_box_es);J$$module$libs$dice_box_es(this,j$$module$libs$dice_box_es);J$$module$libs$dice_box_es(this,w$$module$libs$dice_box_es);J$$module$libs$dice_box_es(this,C$$module$libs$dice_box_es);S$$module$libs$dice_box_es(this,"rollCollectionData",{});S$$module$libs$dice_box_es(this,"rollGroupData",{});S$$module$libs$dice_box_es(this,"rollDiceData",
{});S$$module$libs$dice_box_es(this,"themeData",[]);S$$module$libs$dice_box_es(this,"themesLoadedData",{});J$$module$libs$dice_box_es(this,F$$module$libs$dice_box_es,0);J$$module$libs$dice_box_es(this,f$$module$libs$dice_box_es,0);J$$module$libs$dice_box_es(this,x$$module$libs$dice_box_es,0);J$$module$libs$dice_box_es(this,e$$module$libs$dice_box_es,0);J$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es,{});J$$module$libs$dice_box_es(this,K$$module$libs$dice_box_es,void 0);J$$module$libs$dice_box_es(this,
z$$module$libs$dice_box_es,void 0);J$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es,void 0);J$$module$libs$dice_box_es(this,t$$module$libs$dice_box_es,void 0);J$$module$libs$dice_box_es(this,B$$module$libs$dice_box_es,void 0);S$$module$libs$dice_box_es(this,"noop",()=>{});if("object"!=typeof b)throw Error("Config options should be an object. Config reference: https://fantasticdice.games/docs/usage/config#configuration-options");const {onDieComplete:c,onRollComplete:d,onRemoveComplete:e,
onThemeConfigLoaded:g,onThemeLoaded:n,...t}=b;this.config={...ul$$module$libs$dice_box_es,...t};this.onDieComplete=b.onDieComplete||this.noop;this.onRollComplete=b.onRollComplete||this.noop;this.onRemoveComplete=b.onRemoveComplete||this.noop;this.onThemeLoaded=b.onThemeLoaded||this.noop;this.onThemeConfigLoaded=b.onThemeConfigLoaded||this.noop;this.canvas=cl$$module$libs$dice_box_es({selector:a,id:this.config.id});this.isVisible=!0;this.loadThemeQueue=Vl$$module$libs$dice_box_es({dedupe:!0})}resizeWorld(){const a=
Wl$$module$libs$dice_box_es(()=>{W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).resize({width:this.canvas.clientWidth,height:this.canvas.clientHeight});W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).postMessage({action:"resize",width:this.canvas.clientWidth,height:this.canvas.clientHeight})});window.addEventListener("resize",a)}async init(){return y$$module$libs$dice_box_es(this,P$$module$libs$dice_box_es,ll$$module$libs$dice_box_es).call(this),await y$$module$libs$dice_box_es(this,
Q$$module$libs$dice_box_es,_$$module$libs$dice_box_es).call(this),this.resizeWorld(),W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).onRollResult=a=>{const b=this.rollDiceData[a.rollId],c=this.rollCollectionData[b.collectionId];this.rollGroupData[b.groupId].rolls[b.rollId].value=a.value;c.completedRolls++;c.completedRolls==c.rolls.length&&c.resolve(Object.values(c.rolls).map(({collectionId:n,id:t,meshName:w,...z})=>z));const {collectionId:d,id:e,...g}=b;this.onDieComplete(g)},W$$module$libs$dice_box_es(this,
u$$module$libs$dice_box_es).onRollComplete=()=>{this.onRollComplete(this.getRollResults())},W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).onDieRemoved=a=>{a=this.rollDiceData[a];const b=this.rollCollectionData[a.removeCollectionId];b.completedRolls++;delete this.rollDiceData[a.rollId];const c=this.rollGroupData[a.groupId];delete c.rolls[a.rollId];const d=y$$module$libs$dice_box_es(this,C$$module$libs$dice_box_es,D$$module$libs$dice_box_es).call(this,a.groupId);c.value=d.value;c.qty=
d.rollsArray.length;b.completedRolls==b.rolls.length&&b.resolve(Object.values(b.rolls).map(({id:z,...C})=>C));const {collectionId:e,id:g,removeCollectionId:n,meshName:t,...w}=a;this.onRemoveComplete(w)},await Promise.all([W$$module$libs$dice_box_es(this,K$$module$libs$dice_box_es),W$$module$libs$dice_box_es(this,t$$module$libs$dice_box_es)]),y$$module$libs$dice_box_es(this,j$$module$libs$dice_box_es,bl$$module$libs$dice_box_es).call(this),await this.loadThemeQueue.push(()=>this.loadTheme(this.config.theme)),
this}async getThemeConfig(a){const b=`${this.config.origin}${this.config.assetPath}themes/${a}`;let c;"default"===a?c={name:"Default Colors",material:{type:"color",diffuseTexture:{light:"diffuse-light.png",dark:"diffuse-dark.png"},diffuseLevel:1,bumpTexture:"normal.png",bumpLevel:.5,specularTexture:"specular.jpg",specularPower:1}}:c=await fetch(`${b}/theme.config.json`).then(g=>{if(g.ok){const n=g.headers.get("content-type");if(n&&-1!==n.indexOf("application/json")||g.type&&"basic"===g.type)return g.json();
throw Error(`Incorrect contentType: ${n}. Expected "application/json" or "basic"`);}throw Error(`Unable to fetch config file for theme: '${a}'. Request rejected with status ${g.status}: ${g.statusText}`);}).catch(g=>console.error(g));let d=this.config.origin+this.config.assetPath+this.config.meshFile,e="default";if(!c)throw Error("No theme config data to work with.");if(c.hasOwnProperty("meshFile")&&(d=`${b}/${c.meshFile}`,c.hasOwnProperty("meshName")?e=c.meshName:(console.warn("You should provide a meshName in your theme.config.json file"),
e=c.meshFile.replace(/(.*)\..{2,4}$/,"$1"))),c.hasOwnProperty("diceAvailable")||(c.diceAvailable="d4 d6 d8 d10 d12 d20 d100".split(" ")),c.hasOwnProperty("extends")){let g=this.themesLoadedData[c.extends];g||=await this.loadTheme(c.extends).catch(n=>console.error(n));g&&(c.diceInherited=[...(c.diceInherited||[])],g.diceAvailable.map(n=>{c.diceInherited[n]=g.systemName}))}return Object.assign(c,{basePath:b,meshFilePath:d,meshName:e,theme:a}),c}async loadTheme(a){if(this.themesLoadedData[a])return this.themesLoadedData[a];
a=this.themesLoadedData[a]=await this.getThemeConfig(a).catch(b=>console.error(b));if(this.onThemeConfigLoaded(a),a)return await W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).loadTheme(a).catch(b=>console.error(b)),this.onThemeLoaded(a),a}async updateConfig(a){const b={...this.config,...a};return await this.loadThemeQueue.push(()=>this.loadTheme(b.theme)),this.config=b,W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).updateConfig(b),W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).postMessage({action:"updateConfig",
options:b}),this}clear(){return i$$module$libs$dice_box_es(this,F$$module$libs$dice_box_es,0),i$$module$libs$dice_box_es(this,f$$module$libs$dice_box_es,0),i$$module$libs$dice_box_es(this,x$$module$libs$dice_box_es,0),i$$module$libs$dice_box_es(this,e$$module$libs$dice_box_es,0),this.rollCollectionData={},this.rollGroupData={},this.rollDiceData={},W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).clear(),W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).postMessage({action:"clearDice"}),
this}hide(){return this.canvas.style.display="none",this.isVisible=!1,this}show(){return this.canvas.style.display="block",this.isVisible=!0,this.resizeWorld(),this}roll(a,{theme:b=this.config.theme,themeColor:c=this.config.themeColor,newStartPoint:d=!0}={}){this.clear();const e=H$$module$libs$dice_box_es(this,F$$module$libs$dice_box_es)._++;this.rollCollectionData[e]=new g$$module$libs$dice_box_es({id:e,notation:a,theme:b,themeColor:c,newStartPoint:d});a=this.createNotationArray(a,this.themesLoadedData[b].diceAvailable);
return y$$module$libs$dice_box_es(this,w$$module$libs$dice_box_es,M$$module$libs$dice_box_es).call(this,a,e),this.rollCollectionData[e].promise}add(a,{theme:b=this.config.theme,themeColor:c=this.config.themeColor,newStartPoint:d=!0}={}){const e=H$$module$libs$dice_box_es(this,F$$module$libs$dice_box_es)._++;this.rollCollectionData[e]=new g$$module$libs$dice_box_es({id:e,notation:a,theme:b,themeColor:c,newStartPoint:d});a=this.createNotationArray(a,this.themesLoadedData[b].diceAvailable);return y$$module$libs$dice_box_es(this,
w$$module$libs$dice_box_es,M$$module$libs$dice_box_es).call(this,a,e),this.rollCollectionData[e].promise}reroll(a,{remove:b=!1,hide:c=!1,newStartPoint:d=!0}={}){a=(Array.isArray(a)?a:[a]).map(({value:e,...g})=>g);return!0===b&&this.remove(a,{hide:c}),this.add(a,{newStartPoint:d})}remove(a,{}={}){const b=Array.isArray(a)?a:[a],c=H$$module$libs$dice_box_es(this,F$$module$libs$dice_box_es)._++;return this.rollCollectionData[c]=new g$$module$libs$dice_box_es({id:c,notation:a,rolls:b}),b.map(d=>{this.rollDiceData[d.rollId].removeCollectionId=
c;let e=this.rollDiceData[d.rollId].id;W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).remove({id:e,rollId:d.rollId});W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).postMessage({action:"removeDie",id:e})}),this.rollCollectionData[c].promise}createNotationArray(a,b){const c=Array.isArray(a)?a:[a];let d=[];const e=g=>{if(g.hasOwnProperty("rollId")&&this.rollDiceData.hasOwnProperty(g.rollId)){var n=g.rollId;n=n.toString();n=n.split(".");n=(n[1]?n[1]=parseInt(n[1])+1:n[1]=1,n[0]+
"."+n[1]);g.rollId=n}};return c.forEach(g=>{if("string"==typeof g)d.push(this.parse(g,b));else if("object"==typeof c){e(g);if(g.hasOwnProperty("qty")||(g.qty=1),g.hasOwnProperty("sides"))var n=("100"===g.sides&&(g.sides=100,g.data="single"),!0);else throw Error("Roll notation is missing sides");n&&d.push(g)}}),d}parse(a,b){var c=/(\d+)([dD]{1}\d+)(.*)$/i;const d=/(\d+)[dD]([0%]+)(.*)$/i,e=/(\d+)[dD](f+[ate]*)(.*)$/i,g=/(\d+)[dD]([\d\w]+)([+-]{0,1}\d+)?/i;var n=/([+-])(\d+)/;const t=a.trim().replace(/\s+/g,
"");var w=(C,H)=>{if(C=Number(C),Number.isNaN(C)||!Number.isInteger(C)||1>C)throw Error(H);return C};c=t.match(d)||t.match(c)||t.match(e)||t.match(g);var z=0;a="Invalid notation: "+a;if(!c||!c.length||3>c.length)throw Error(a);c[3]&&n.test(c[3])&&(n=c[3].match(n),z=w(n[2],a),"-"===n[1].trim()&&(z*=-1));w={qty:w(c[1],a),modifier:z};return t.match(d)?(w.sides=c[2],w.data="single"):t.match(e)?w.sides="fate":(b.includes(t.match(g)[2]),w.sides=c[2]),w}getRollResults(){return Object.entries(this.rollGroupData).map(([a,
b])=>{a=y$$module$libs$dice_box_es(this,C$$module$libs$dice_box_es,D$$module$libs$dice_box_es).call(this,a);b.value=a.value;b.qty=a.rollsArray.length;b={...b};return b.rolls=a.rollsArray,b})}}F$$module$libs$dice_box_es=new WeakMap;f$$module$libs$dice_box_es=new WeakMap;x$$module$libs$dice_box_es=new WeakMap;e$$module$libs$dice_box_es=new WeakMap;u$$module$libs$dice_box_es=new WeakMap;K$$module$libs$dice_box_es=new WeakMap;z$$module$libs$dice_box_es=new WeakMap;a$$module$libs$dice_box_es=new WeakMap;
t$$module$libs$dice_box_es=new WeakMap;B$$module$libs$dice_box_es=new WeakMap;Q$$module$libs$dice_box_es=new WeakSet;
_$$module$libs$dice_box_es=async function(){i$$module$libs$dice_box_es(this,K$$module$libs$dice_box_es,new Promise((c,d)=>{i$$module$libs$dice_box_es(this,z$$module$libs$dice_box_es,c)}));const a=()=>{W$$module$libs$dice_box_es(this,z$$module$libs$dice_box_es).call(this)};if("OffscreenCanvas"in window&&"transferControlToOffscreen"in this.canvas&&this.config.offscreen){var b=await Promise.resolve(module$libs$world_offscreen).then(c=>c.default);i$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es,
new b({canvas:this.canvas,options:this.config,onInitComplete:a}))}else this.config.offscreen&&(console.warn("This browser does not support OffscreenCanvas. Using standard canvas fallback."),this.config.offscreen=!1),b=await Promise.resolve(module$libs$world_onscreen).then(c=>c.default),i$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es,new b({canvas:this.canvas,options:this.config,onInitComplete:a}))};P$$module$libs$dice_box_es=new WeakSet;
ll$$module$libs$dice_box_es=function(){i$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es,new Gl$$module$libs$dice_box_es);i$$module$libs$dice_box_es(this,t$$module$libs$dice_box_es,new Promise((a,b)=>{i$$module$libs$dice_box_es(this,B$$module$libs$dice_box_es,a)}));W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).onmessage=a=>{switch(a.data.action){case "init-complete":W$$module$libs$dice_box_es(this,B$$module$libs$dice_box_es).call(this)}};W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).postMessage({action:"init",
width:this.canvas.clientWidth,height:this.canvas.clientHeight,options:this.config})};j$$module$libs$dice_box_es=new WeakSet;bl$$module$libs$dice_box_es=function(){const a=new MessageChannel;W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).connect(a.port1);W$$module$libs$dice_box_es(this,a$$module$libs$dice_box_es).postMessage({action:"connect"},[a.port2])};w$$module$libs$dice_box_es=new WeakSet;
M$$module$libs$dice_box_es=async function(a,b){const c=this.rollCollectionData[b];let d=c.newStartPoint;a.forEach(async e=>{if(!e.sides)throw Error("Improper dice notation or unable to parse notation");const g=e.theme||c.theme||this.config.theme,n=e.themeColor||c.themeColor||this.config.themeColor,t={},w=void 0!==e.groupId;let z;await this.loadThemeQueue.push(()=>this.loadTheme(g));const {meshName:C,diceAvailable:H,diceInherited:M={},material:{type:L}}=this.themesLoadedData[g],O=Object.keys(M);let S=
"";var T;"color"===L&&(T=Rl$$module$libs$dice_box_es(n),S=175<.299*T.r+.587*T.g+.114*T.b?"_dark":"_light");T=0;for(var P=e.qty;T<P;T++){var W=void 0!==e.rollId?e.rollId:H$$module$libs$dice_box_es(this,x$$module$libs$dice_box_es)._++,Z=void 0!==e.id?e.id:H$$module$libs$dice_box_es(this,e$$module$libs$dice_box_es)._++;z=w?e.groupId:W$$module$libs$dice_box_es(this,f$$module$libs$dice_box_es);const ca=Number.isInteger(e.sides)?`d${e.sides}`:e.sides;Z={sides:e.sides,data:e.data,dieType:ca,groupId:z,collectionId:c.id,
rollId:W,id:Z,theme:g,themeColor:n,meshName:C};if(t[W]=Z,this.rollDiceData[W]=Z,c.rolls.push(this.rollDiceData[W]),"fate"!==Z.sides||H.includes(ca)||O.includes(ca))if(this.config.suspendSimulation||!H.includes(ca)&&!O.includes(ca))console.warn(this.config.suspendSimulation?"3D simulation suspended. Using fallback.":`${Z.sides} die unavailable in '${g}' theme. Using fallback.`),W=Number.isInteger(Z.sides)?Z.sides:parseInt(Z.sides.replace(/\D/g,"")),Z.value=q$$module$libs$dice_box_es.range(1,W),W$$module$libs$dice_box_es(this,
u$$module$libs$dice_box_es).addNonDie(Z);else{let ba;O.includes(ca)&&(ba=this.themesLoadedData[M[ca]]);W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).add({...Z,newStartPoint:d,theme:(null==ba?void 0:ba.systemName)||g,meshName:(null==ba?void 0:ba.meshName)||C,colorSuffix:S})}else console.warn(`fate die unavailable in '${g}' theme. Using fallback.`),Z.value=q$$module$libs$dice_box_es.range(-1,1),W$$module$libs$dice_box_es(this,u$$module$libs$dice_box_es).addNonDie(Z);d=!1}w?Object.assign(this.rollGroupData[z].rolls,
t):(e.rolls=t,e.id=z,this.rollGroupData[z]=e,++H$$module$libs$dice_box_es(this,f$$module$libs$dice_box_es)._)})};C$$module$libs$dice_box_es=new WeakSet;D$$module$libs$dice_box_es=function(a){a=this.rollGroupData[a];const b=Object.values(a.rolls).map(({collectionId:d,id:e,meshName:g,...n})=>n);let c=b.reduce((d,e)=>{e=isNaN(e.value)?0:e.value;return d+e},0);return c+=a.modifier?a.modifier:0,{value:c,rollsArray:b}};
class g$$module$libs$dice_box_es{constructor(a){Object.assign(this,a);this.rolls=a.rolls||[];this.completedRolls=0;const b=this;this.promise=new Promise((c,d)=>{b.resolve=c;b.reject=d})}}var module$libs$dice_box_es={};module$libs$dice_box_es.d=Jl$$module$libs$dice_box_es;module$libs$dice_box_es.default=il$$module$libs$dice_box_es;var u$$module$libs$world_offscreen=Object.defineProperty,J$$module$libs$world_offscreen=(a,b,c)=>b in a?u$$module$libs$world_offscreen(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,d$$module$libs$world_offscreen=(a,b,c)=>(J$$module$libs$world_offscreen(a,"symbol"!=typeof b?b+"":b,c),c),R$$module$libs$world_offscreen=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c);},V$$module$libs$world_offscreen=(a,b,c)=>(R$$module$libs$world_offscreen(a,b,"read from private field"),c?c.call(a):
b.get(a)),m$$module$libs$world_offscreen=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},h$$module$libs$world_offscreen=(a,b,c,d)=>(R$$module$libs$world_offscreen(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c),a$$module$libs$world_offscreen=(a,b,c)=>(R$$module$libs$world_offscreen(a,b,"access private method"),c);
const p$$module$libs$world_offscreen="dmFyIExsPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgTmw9KFgsU2UseWUpPT5TZSBpbiBYP0xsKFgsU2Use2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOnllfSk6WFtTZV09eWU7dmFyIGJ0PShYLFNlLHllKT0+KE5sKFgsdHlwZW9mIFNlIT0ic3ltYm9sIj9TZSsiIjpTZSx5ZSkseWUpLGpzPShYLFNlLHllKT0+e2lmKCFTZS5oYXMoWCkpdGhyb3cgVHlwZUVycm9yKCJDYW5ub3QgIit5ZSl9O3ZhciBZPShYLFNlLHllKT0+KGpzKFgsU2UsInJlYWQgZnJvbSBwcml2YXRlIGZpZWxkIikseWU/eWUuY2FsbChYKTpTZS5nZXQoWCkpLG50PShYLFNlLHllKT0+e2lmKFNlLmhhcyhYKSl0aHJvdyBUeXBlRXJyb3IoIkNhbm5vdCBhZGQgdGhlIHNhbWUgcHJpdmF0ZSBtZW1iZXIgbW9yZSB0aGFuIG9uY2UiKTtTZSBpbnN0YW5jZW9mIFdlYWtTZXQ/U2UuYWRkKFgpOlNlLnNldChYLHllKX0sbHQ9KFgsU2UseWUseGUpPT4oanMoWCxTZSwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZCIpLHhlP3hlLmNhbGwoWCx5ZSk6U2Uuc2V0KFgseWUpLHllKSx5aT0oWCxTZSx5ZSx4ZSk9Pih7c2V0IF8oQmUpe2x0KFgsU2UsQmUseWUpfSxnZXQgXygpe3JldHVybiBZKFgsU2UseGUpfX0pLHpyPShYLFNlLHllKT0+KGpzKFgsU2UsImFjY2VzcyBwcml2YXRlIG1ldGhvZCIpLHllKTsoZnVuY3Rpb24oKXt2YXIgWGUsQWksRnQsUmksTXQsVHQsSmUsY3MsQXQsVmksV2ksZ3QsemksdXMsR3I7InVzZSBzdHJpY3QiO2NsYXNzIFh7c3RhdGljIFdpdGhpbkVwc2lsb24oZSx0LGk9MTQwMTI5OGUtNTEpe3JldHVybiBNYXRoLmFicyhlLXQpPD1pfXN0YXRpYyBUb0hleChlKXtjb25zdCB0PWUudG9TdHJpbmcoMTYpO3JldHVybiBlPD0xNT8oIjAiK3QpLnRvVXBwZXJDYXNlKCk6dC50b1VwcGVyQ2FzZSgpfXN0YXRpYyBTaWduKGUpe3JldHVybiBlPStlLGU9PT0wfHxpc05hTihlKT9lOmU+MD8xOi0xfXN0YXRpYyBDbGFtcChlLHQ9MCxpPTEpe3JldHVybiBNYXRoLm1pbihpLE1hdGgubWF4KHQsZSkpfXN0YXRpYyBMb2cyKGUpe3JldHVybiBNYXRoLmxvZyhlKSpNYXRoLkxPRzJFfXN0YXRpYyBJTG9nMihlKXtpZihNYXRoLmxvZzIpcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5sb2cyKGUpKTtpZihlPDApcmV0dXJuIE5hTjtpZihlPT09MClyZXR1cm4tMS8wO2xldCB0PTA7aWYoZTwxKXtmb3IoO2U8MTspdCsrLGU9ZSoyO3Q9LXR9ZWxzZSBpZihlPjEpZm9yKDtlPjE7KXQrKyxlPU1hdGguZmxvb3IoZS8yKTtyZXR1cm4gdH1zdGF0aWMgUmVwZWF0KGUsdCl7cmV0dXJuIGUtTWF0aC5mbG9vcihlL3QpKnR9c3RhdGljIE5vcm1hbGl6ZShlLHQsaSl7cmV0dXJuKGUtdCkvKGktdCl9c3RhdGljIERlbm9ybWFsaXplKGUsdCxpKXtyZXR1cm4gZSooaS10KSt0fXN0YXRpYyBEZWx0YUFuZ2xlKGUsdCl7bGV0IGk9WC5SZXBlYXQodC1lLDM2MCk7cmV0dXJuIGk+MTgwJiYoaS09MzYwKSxpfXN0YXRpYyBQaW5nUG9uZyhlLHQpe2NvbnN0IGk9WC5SZXBlYXQoZSx0KjIpO3JldHVybiB0LU1hdGguYWJzKGktdCl9c3RhdGljIFNtb290aFN0ZXAoZSx0LGkpe2xldCBzPVguQ2xhbXAoaSk7cmV0dXJuIHM9LTIqcypzKnMrMypzKnMsdCpzK2UqKDEtcyl9c3RhdGljIE1vdmVUb3dhcmRzKGUsdCxpKXtsZXQgcz0wO3JldHVybiBNYXRoLmFicyh0LWUpPD1pP3M9dDpzPWUrWC5TaWduKHQtZSkqaSxzfXN0YXRpYyBNb3ZlVG93YXJkc0FuZ2xlKGUsdCxpKXtjb25zdCBzPVguRGVsdGFBbmdsZShlLHQpO2xldCByPTA7cmV0dXJuLWk8cyYmczxpP3I9dDoodD1lK3Mscj1YLk1vdmVUb3dhcmRzKGUsdCxpKSkscn1zdGF0aWMgTGVycChlLHQsaSl7cmV0dXJuIGUrKHQtZSkqaX1zdGF0aWMgTGVycEFuZ2xlKGUsdCxpKXtsZXQgcz1YLlJlcGVhdCh0LWUsMzYwKTtyZXR1cm4gcz4xODAmJihzLT0zNjApLGUrcypYLkNsYW1wKGkpfXN0YXRpYyBJbnZlcnNlTGVycChlLHQsaSl7bGV0IHM9MDtyZXR1cm4gZSE9dD9zPVguQ2xhbXAoKGktZSkvKHQtZSkpOnM9MCxzfXN0YXRpYyBIZXJtaXRlKGUsdCxpLHMscil7Y29uc3Qgbj1yKnIsYT1yKm4sbz0yKmEtMypuKzEsaD0tMiphKzMqbixsPWEtMipuK3IsdT1hLW47cmV0dXJuIGUqbytpKmgrdCpsK3MqdX1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmUoZSx0LGkscyxyKXtjb25zdCBuPXIqcjtyZXR1cm4obi1yKSo2KmUrKDMqbi00KnIrMSkqdCsoLW4rcikqNippKygzKm4tMipyKSpzfXN0YXRpYyBSYW5kb21SYW5nZShlLHQpe3JldHVybiBlPT09dD9lOk1hdGgucmFuZG9tKCkqKHQtZSkrZX1zdGF0aWMgUmFuZ2VUb1BlcmNlbnQoZSx0LGkpe3JldHVybihlLXQpLyhpLXQpfXN0YXRpYyBQZXJjZW50VG9SYW5nZShlLHQsaSl7cmV0dXJuKGktdCkqZSt0fXN0YXRpYyBOb3JtYWxpemVSYWRpYW5zKGUpe3JldHVybiBlLT1YLlR3b1BpKk1hdGguZmxvb3IoKGUrTWF0aC5QSSkvWC5Ud29QaSksZX1zdGF0aWMgSENGKGUsdCl7Y29uc3QgaT1lJXQ7cmV0dXJuIGk9PT0wP3Q6WC5IQ0YodCxpKX19WC5Ud29QaT1NYXRoLlBJKjI7Y29uc3QgU2U9MS8yLjIseWU9Mi4yLHhlPS4wMDE7Y2xhc3MgQmV7c3RhdGljIEJ1aWxkQXJyYXkoZSx0KXtjb25zdCBpPVtdO2ZvcihsZXQgcz0wO3M8ZTsrK3MpaS5wdXNoKHQoKSk7cmV0dXJuIGl9c3RhdGljIEJ1aWxkVHVwbGUoZSx0KXtyZXR1cm4gQmUuQnVpbGRBcnJheShlLHQpfX1mdW5jdGlvbiBYcihjLGUsdCl7Y29uc3QgaT1jW2VdO2lmKHR5cGVvZiBpIT0iZnVuY3Rpb24iKXJldHVybiBudWxsO2NvbnN0IHM9ZnVuY3Rpb24oKXtjb25zdCByPWMubGVuZ3RoLG49cy5wcmV2aW91cy5hcHBseShjLGFyZ3VtZW50cyk7cmV0dXJuIHQoZSxyKSxufTtyZXR1cm4gaS5uZXh0PXMscy5wcmV2aW91cz1pLGNbZV09cywoKT0+e2NvbnN0IHI9cy5wcmV2aW91cztpZighcilyZXR1cm47Y29uc3Qgbj1zLm5leHQ7bj8oci5uZXh0PW4sbi5wcmV2aW91cz1yKTooci5uZXh0PXZvaWQgMCxjW2VdPXIpLHMubmV4dD12b2lkIDAscy5wcmV2aW91cz12b2lkIDB9fWNvbnN0IEhyPVsicHVzaCIsInNwbGljZSIsInBvcCIsInNoaWZ0IiwidW5zaGlmdCJdO2Z1bmN0aW9uICRzKGMsZSl7Y29uc3QgdD1Ici5tYXAoaT0+WHIoYyxpLGUpKTtyZXR1cm4oKT0+e3QuZm9yRWFjaChpPT57aT09bnVsbHx8aSgpfSl9fWNvbnN0IFFzPXt9O2Z1bmN0aW9uIGl0KGMsZSl7UXNbY109ZX1mdW5jdGlvbiByaShjKXtyZXR1cm4gUXNbY119Y2xhc3MgVWV7c3RhdGljIFNldE1hdHJpeFByZWNpc2lvbihlKXtpZihVZS5NYXRyaXhUcmFja1ByZWNpc2lvbkNoYW5nZT0hMSxlJiYhVWUuTWF0cml4VXNlNjRCaXRzJiZVZS5NYXRyaXhUcmFja2VkTWF0cmljZXMpZm9yKGxldCB0PTA7dDxVZS5NYXRyaXhUcmFja2VkTWF0cmljZXMubGVuZ3RoOysrdCl7Y29uc3QgaT1VZS5NYXRyaXhUcmFja2VkTWF0cmljZXNbdF0scz1pLl9tO2kuX209bmV3IEFycmF5KDE2KTtmb3IobGV0IHI9MDtyPDE2OysrcilpLl9tW3JdPXNbcl19VWUuTWF0cml4VXNlNjRCaXRzPWUsVWUuTWF0cml4Q3VycmVudFR5cGU9VWUuTWF0cml4VXNlNjRCaXRzP0FycmF5OkZsb2F0MzJBcnJheSxVZS5NYXRyaXhUcmFja2VkTWF0cmljZXM9bnVsbH19VWUuTWF0cml4VXNlNjRCaXRzPSExLFVlLk1hdHJpeFRyYWNrUHJlY2lzaW9uQ2hhbmdlPSEwLFVlLk1hdHJpeEN1cnJlbnRUeXBlPUZsb2F0MzJBcnJheSxVZS5NYXRyaXhUcmFja2VkTWF0cmljZXM9W107Y2xhc3MgZmV7c3RhdGljIGdldCBMYXN0Q3JlYXRlZEVuZ2luZSgpe3JldHVybiB0aGlzLkluc3RhbmNlcy5sZW5ndGg9PT0wP251bGw6dGhpcy5JbnN0YW5jZXNbdGhpcy5JbnN0YW5jZXMubGVuZ3RoLTFdfXN0YXRpYyBnZXQgTGFzdENyZWF0ZWRTY2VuZSgpe3JldHVybiB0aGlzLl9MYXN0Q3JlYXRlZFNjZW5lfX1mZS5JbnN0YW5jZXM9bmV3IEFycmF5LGZlLl9MYXN0Q3JlYXRlZFNjZW5lPW51bGwsZmUuVXNlRmFsbGJhY2tUZXh0dXJlPSEwLGZlLkZhbGxiYWNrVGV4dHVyZT0iIjtjb25zdCBzdD1jPT5wYXJzZUludChjLnRvU3RyaW5nKCkucmVwbGFjZSgvXFcvZywiIikpO2NsYXNzIHZle2NvbnN0cnVjdG9yKGU9MCx0PTApe3RoaXMueD1lLHRoaXMueT10fXRvU3RyaW5nKCl7cmV0dXJuYHtYOiAke3RoaXMueH0gWTogJHt0aGlzLnl9fWB9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlZlY3RvcjIifWdldEhhc2hDb2RlKCl7Y29uc3QgZT1zdCh0aGlzLngpLHQ9c3QodGhpcy55KTtsZXQgaT1lO3JldHVybiBpPWkqMzk3XnQsaX10b0FycmF5KGUsdD0wKXtyZXR1cm4gZVt0XT10aGlzLngsZVt0KzFdPXRoaXMueSx0aGlzfWZyb21BcnJheShlLHQ9MCl7cmV0dXJuIHZlLkZyb21BcnJheVRvUmVmKGUsdCx0aGlzKSx0aGlzfWFzQXJyYXkoKXtjb25zdCBlPW5ldyBBcnJheTtyZXR1cm4gdGhpcy50b0FycmF5KGUsMCksZX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy54PWUueCx0aGlzLnk9ZS55LHRoaXN9Y29weUZyb21GbG9hdHMoZSx0KXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpc31zZXQoZSx0KXtyZXR1cm4gdGhpcy5jb3B5RnJvbUZsb2F0cyhlLHQpfWFkZChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54K2UueCx0aGlzLnkrZS55KX1hZGRUb1JlZihlLHQpe3JldHVybiB0Lng9dGhpcy54K2UueCx0Lnk9dGhpcy55K2UueSx0fWFkZEluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCs9ZS54LHRoaXMueSs9ZS55LHRoaXN9YWRkVmVjdG9yMyhlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54K2UueCx0aGlzLnkrZS55KX1zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LWUueCx0aGlzLnktZS55KX1zdWJ0cmFjdFRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLngtZS54LHQueT10aGlzLnktZS55LHR9c3VidHJhY3RJblBsYWNlKGUpe3JldHVybiB0aGlzLngtPWUueCx0aGlzLnktPWUueSx0aGlzfW11bHRpcGx5SW5QbGFjZShlKXtyZXR1cm4gdGhpcy54Kj1lLngsdGhpcy55Kj1lLnksdGhpc31tdWx0aXBseShlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54KmUueCx0aGlzLnkqZS55KX1tdWx0aXBseVRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLngqZS54LHQueT10aGlzLnkqZS55LHR9bXVsdGlwbHlCeUZsb2F0cyhlLHQpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngqZSx0aGlzLnkqdCl9ZGl2aWRlKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngvZS54LHRoaXMueS9lLnkpfWRpdmlkZVRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLngvZS54LHQueT10aGlzLnkvZS55LHR9ZGl2aWRlSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5kaXZpZGVUb1JlZihlLHRoaXMpfW5lZ2F0ZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigtdGhpcy54LC10aGlzLnkpfW5lZ2F0ZUluUGxhY2UoKXtyZXR1cm4gdGhpcy54Kj0tMSx0aGlzLnkqPS0xLHRoaXN9bmVnYXRlVG9SZWYoZSl7cmV0dXJuIGUuY29weUZyb21GbG9hdHModGhpcy54Ki0xLHRoaXMueSotMSl9c2NhbGVJblBsYWNlKGUpe3JldHVybiB0aGlzLngqPWUsdGhpcy55Kj1lLHRoaXN9c2NhbGUoZSl7Y29uc3QgdD1uZXcgdGhpcy5jb25zdHJ1Y3RvcigwLDApO3JldHVybiB0aGlzLnNjYWxlVG9SZWYoZSx0KSx0fXNjYWxlVG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueCplLHQueT10aGlzLnkqZSx0fXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC54Kz10aGlzLngqZSx0LnkrPXRoaXMueSplLHR9ZXF1YWxzKGUpe3JldHVybiBlJiZ0aGlzLng9PT1lLngmJnRoaXMueT09PWUueX1lcXVhbHNXaXRoRXBzaWxvbihlLHQ9eGUpe3JldHVybiBlJiZYLldpdGhpbkVwc2lsb24odGhpcy54LGUueCx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMueSxlLnksdCl9Zmxvb3IoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoTWF0aC5mbG9vcih0aGlzLngpLE1hdGguZmxvb3IodGhpcy55KSl9ZnJhY3QoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LU1hdGguZmxvb3IodGhpcy54KSx0aGlzLnktTWF0aC5mbG9vcih0aGlzLnkpKX1yb3RhdGVUb1JlZihlLHQpe2NvbnN0IGk9TWF0aC5jb3MoZSkscz1NYXRoLnNpbihlKTtyZXR1cm4gdC54PWkqdGhpcy54LXMqdGhpcy55LHQueT1zKnRoaXMueCtpKnRoaXMueSx0fWxlbmd0aCgpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55KX1sZW5ndGhTcXVhcmVkKCl7cmV0dXJuIHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueX1ub3JtYWxpemUoKXtyZXR1cm4gdmUuTm9ybWFsaXplVG9SZWYodGhpcyx0aGlzKSx0aGlzfWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCx0aGlzLnkpfXN0YXRpYyBaZXJvKCl7cmV0dXJuIG5ldyB2ZSgwLDApfXN0YXRpYyBPbmUoKXtyZXR1cm4gbmV3IHZlKDEsMSl9c3RhdGljIGdldCBaZXJvUmVhZE9ubHkoKXtyZXR1cm4gdmUuX1plcm9SZWFkT25seX1zdGF0aWMgRnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gbmV3IHZlKGVbdF0sZVt0KzFdKX1zdGF0aWMgRnJvbUFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBpLng9ZVt0XSxpLnk9ZVt0KzFdLGl9c3RhdGljIENhdG11bGxSb20oZSx0LGkscyxyKXtjb25zdCBuPXIqcixhPXIqbixvPS41KigyKnQueCsoLWUueCtpLngpKnIrKDIqZS54LTUqdC54KzQqaS54LXMueCkqbisoLWUueCszKnQueC0zKmkueCtzLngpKmEpLGg9LjUqKDIqdC55KygtZS55K2kueSkqcisoMiplLnktNSp0LnkrNCppLnktcy55KSpuKygtZS55KzMqdC55LTMqaS55K3MueSkqYSk7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKG8saCl9c3RhdGljIENsYW1wKGUsdCxpKXtsZXQgcz1lLng7cz1zPmkueD9pLng6cyxzPXM8dC54P3QueDpzO2xldCByPWUueTtyZXR1cm4gcj1yPmkueT9pLnk6cixyPXI8dC55P3QueTpyLG5ldyBlLmNvbnN0cnVjdG9yKHMscil9c3RhdGljIEhlcm1pdGUoZSx0LGkscyxyKXtjb25zdCBuPXIqcixhPXIqbixvPTIqYS0zKm4rMSxoPS0yKmErMypuLGw9YS0yKm4rcix1PWEtbixkPWUueCpvK2kueCpoK3QueCpsK3MueCp1LGY9ZS55Km8raS55KmgrdC55Kmwrcy55KnU7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGQsZil9c3RhdGljIEhlcm1pdGUxc3REZXJpdmF0aXZlKGUsdCxpLHMscil7Y29uc3Qgbj1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5IZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKSxufXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIqcjtyZXR1cm4gbi54PShhLXIpKjYqZS54KygzKmEtNCpyKzEpKnQueCsoLWErcikqNippLngrKDMqYS0yKnIpKnMueCxuLnk9KGEtcikqNiplLnkrKDMqYS00KnIrMSkqdC55KygtYStyKSo2KmkueSsoMyphLTIqcikqcy55LG59c3RhdGljIExlcnAoZSx0LGkpe2NvbnN0IHM9ZS54Kyh0LngtZS54KSppLHI9ZS55Kyh0LnktZS55KSppO3JldHVybiBuZXcgZS5jb25zdHJ1Y3RvcihzLHIpfXN0YXRpYyBEb3QoZSx0KXtyZXR1cm4gZS54KnQueCtlLnkqdC55fXN0YXRpYyBOb3JtYWxpemUoZSl7Y29uc3QgdD1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5Ob3JtYWxpemVUb1JlZihlLHQpLHR9c3RhdGljIE5vcm1hbGl6ZVRvUmVmKGUsdCl7Y29uc3QgaT1lLmxlbmd0aCgpO3JldHVybiBpPT09MHx8KHQueD1lLngvaSx0Lnk9ZS55L2kpLHR9c3RhdGljIE1pbmltaXplKGUsdCl7Y29uc3QgaT1lLng8dC54P2UueDp0Lngscz1lLnk8dC55P2UueTp0Lnk7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGkscyl9c3RhdGljIE1heGltaXplKGUsdCl7Y29uc3QgaT1lLng+dC54P2UueDp0Lngscz1lLnk+dC55P2UueTp0Lnk7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGkscyl9c3RhdGljIFRyYW5zZm9ybShlLHQpe2NvbnN0IGk9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHZlLlRyYW5zZm9ybVRvUmVmKGUsdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Ub1JlZihlLHQsaSl7Y29uc3Qgcz10Lm0scj1lLngqc1swXStlLnkqc1s0XStzWzEyXSxuPWUueCpzWzFdK2UueSpzWzVdK3NbMTNdO3JldHVybiBpLng9cixpLnk9bixpfXN0YXRpYyBQb2ludEluVHJpYW5nbGUoZSx0LGkscyl7Y29uc3Qgcj0uNSooLWkueSpzLngrdC55KigtaS54K3MueCkrdC54KihpLnktcy55KStpLngqcy55KSxuPXI8MD8tMToxLGE9KHQueSpzLngtdC54KnMueSsocy55LXQueSkqZS54Kyh0Lngtcy54KSplLnkpKm4sbz0odC54KmkueS10LnkqaS54Kyh0LnktaS55KSplLngrKGkueC10LngpKmUueSkqbjtyZXR1cm4gYT4wJiZvPjAmJmErbzwyKnIqbn1zdGF0aWMgRGlzdGFuY2UoZSx0KXtyZXR1cm4gTWF0aC5zcXJ0KHZlLkRpc3RhbmNlU3F1YXJlZChlLHQpKX1zdGF0aWMgRGlzdGFuY2VTcXVhcmVkKGUsdCl7Y29uc3QgaT1lLngtdC54LHM9ZS55LXQueTtyZXR1cm4gaSppK3Mqc31zdGF0aWMgQ2VudGVyKGUsdCl7Y29uc3QgaT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdmUuQ2VudGVyVG9SZWYoZSx0LGkpfXN0YXRpYyBDZW50ZXJUb1JlZihlLHQsaSl7cmV0dXJuIGkuY29weUZyb21GbG9hdHMoKGUueCt0LngpLzIsKGUueSt0LnkpLzIpfXN0YXRpYyBEaXN0YW5jZU9mUG9pbnRGcm9tU2VnbWVudChlLHQsaSl7Y29uc3Qgcz12ZS5EaXN0YW5jZVNxdWFyZWQodCxpKTtpZihzPT09MClyZXR1cm4gdmUuRGlzdGFuY2UoZSx0KTtjb25zdCByPWkuc3VidHJhY3QodCksbj1NYXRoLm1heCgwLE1hdGgubWluKDEsdmUuRG90KGUuc3VidHJhY3QodCkscikvcykpLGE9dC5hZGQoci5tdWx0aXBseUJ5RmxvYXRzKG4sbikpO3JldHVybiB2ZS5EaXN0YW5jZShlLGEpfX12ZS5fWmVyb1JlYWRPbmx5PXZlLlplcm8oKTtjbGFzcyBwe2NvbnN0cnVjdG9yKGU9MCx0PTAsaT0wKXt0aGlzLl9pc0RpcnR5PSEwLHRoaXMuX3g9ZSx0aGlzLl95PXQsdGhpcy5fej1pfWdldCB4KCl7cmV0dXJuIHRoaXMuX3h9c2V0IHgoZSl7dGhpcy5feD1lLHRoaXMuX2lzRGlydHk9ITB9Z2V0IHkoKXtyZXR1cm4gdGhpcy5feX1zZXQgeShlKXt0aGlzLl95PWUsdGhpcy5faXNEaXJ0eT0hMH1nZXQgeigpe3JldHVybiB0aGlzLl96fXNldCB6KGUpe3RoaXMuX3o9ZSx0aGlzLl9pc0RpcnR5PSEwfXRvU3RyaW5nKCl7cmV0dXJuYHtYOiAke3RoaXMuX3h9IFk6ICR7dGhpcy5feX0gWjogJHt0aGlzLl96fX1gfWdldENsYXNzTmFtZSgpe3JldHVybiJWZWN0b3IzIn1nZXRIYXNoQ29kZSgpe2NvbnN0IGU9c3QodGhpcy5feCksdD1zdCh0aGlzLl95KSxpPXN0KHRoaXMuX3opO2xldCBzPWU7cmV0dXJuIHM9cyozOTdedCxzPXMqMzk3Xmksc31hc0FycmF5KCl7Y29uc3QgZT1bXTtyZXR1cm4gdGhpcy50b0FycmF5KGUsMCksZX10b0FycmF5KGUsdD0wKXtyZXR1cm4gZVt0XT10aGlzLl94LGVbdCsxXT10aGlzLl95LGVbdCsyXT10aGlzLl96LHRoaXN9ZnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gcC5Gcm9tQXJyYXlUb1JlZihlLHQsdGhpcyksdGhpc310b1F1YXRlcm5pb24oKXtyZXR1cm4gWi5Sb3RhdGlvbllhd1BpdGNoUm9sbCh0aGlzLl95LHRoaXMuX3gsdGhpcy5feil9YWRkSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5hZGRJblBsYWNlRnJvbUZsb2F0cyhlLl94LGUuX3ksZS5feil9YWRkSW5QbGFjZUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLngrPWUsdGhpcy55Kz10LHRoaXMueis9aSx0aGlzfWFkZChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCtlLl94LHRoaXMuX3krZS5feSx0aGlzLl96K2UuX3opfWFkZFRvUmVmKGUsdCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHModGhpcy5feCtlLl94LHRoaXMuX3krZS5feSx0aGlzLl96K2UuX3opfXN1YnRyYWN0SW5QbGFjZShlKXtyZXR1cm4gdGhpcy54LT1lLl94LHRoaXMueS09ZS5feSx0aGlzLnotPWUuX3osdGhpc31zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feC1lLl94LHRoaXMuX3ktZS5feSx0aGlzLl96LWUuX3opfXN1YnRyYWN0VG9SZWYoZSx0KXtyZXR1cm4gdGhpcy5zdWJ0cmFjdEZyb21GbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0KX1zdWJ0cmFjdEZyb21GbG9hdHMoZSx0LGkpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94LWUsdGhpcy5feS10LHRoaXMuX3otaSl9c3VidHJhY3RGcm9tRmxvYXRzVG9SZWYoZSx0LGkscyl7cmV0dXJuIHMuY29weUZyb21GbG9hdHModGhpcy5feC1lLHRoaXMuX3ktdCx0aGlzLl96LWkpfW5lZ2F0ZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigtdGhpcy5feCwtdGhpcy5feSwtdGhpcy5feil9bmVnYXRlSW5QbGFjZSgpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzfW5lZ2F0ZVRvUmVmKGUpe3JldHVybiBlLmNvcHlGcm9tRmxvYXRzKHRoaXMuX3gqLTEsdGhpcy5feSotMSx0aGlzLl96Ki0xKX1zY2FsZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXN9c2NhbGUoZSl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gqZSx0aGlzLl95KmUsdGhpcy5feiplKX1zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHModGhpcy5feCplLHRoaXMuX3kqZSx0aGlzLl96KmUpfWdldE5vcm1hbFRvUmVmKGUpe2NvbnN0IHQ9dGhpcy5sZW5ndGgoKTtsZXQgaT1NYXRoLmFjb3ModGhpcy55L3QpO2NvbnN0IHM9TWF0aC5hdGFuMih0aGlzLnosdGhpcy54KTtpPk1hdGguUEkvMj9pLT1NYXRoLlBJLzI6aSs9TWF0aC5QSS8yO2NvbnN0IHI9dCpNYXRoLnNpbihpKSpNYXRoLmNvcyhzKSxuPXQqTWF0aC5jb3MoaSksYT10Kk1hdGguc2luKGkpKk1hdGguc2luKHMpO3JldHVybiBlLnNldChyLG4sYSksZX1hcHBseVJvdGF0aW9uUXVhdGVybmlvblRvUmVmKGUsdCl7Y29uc3QgaT1lLncqdGhpcy54K2UueSp0aGlzLnotZS56KnRoaXMueSxzPWUudyp0aGlzLnkrZS56KnRoaXMueC1lLngqdGhpcy56LHI9ZS53KnRoaXMueitlLngqdGhpcy55LWUueSp0aGlzLngsbj0tZS54KnRoaXMueC1lLnkqdGhpcy55LWUueip0aGlzLno7cmV0dXJuIHQueD1pKmUudytuKi1lLngrcyotZS56LXIqLWUueSx0Lnk9cyplLncrbiotZS55K3IqLWUueC1pKi1lLnosdC56PXIqZS53K24qLWUueitpKi1lLnktcyotZS54LHR9YXBwbHlSb3RhdGlvblF1YXRlcm5pb25JblBsYWNlKGUpe3JldHVybiB0aGlzLmFwcGx5Um90YXRpb25RdWF0ZXJuaW9uVG9SZWYoZSx0aGlzKX1hcHBseVJvdGF0aW9uUXVhdGVybmlvbihlKXtyZXR1cm4gdGhpcy5hcHBseVJvdGF0aW9uUXVhdGVybmlvblRvUmVmKGUsbmV3IHRoaXMuY29uc3RydWN0b3IpfXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC5hZGRJblBsYWNlRnJvbUZsb2F0cyh0aGlzLl94KmUsdGhpcy5feSplLHRoaXMuX3oqZSl9cHJvamVjdE9uUGxhbmUoZSx0KXtjb25zdCBpPW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiB0aGlzLnByb2plY3RPblBsYW5lVG9SZWYoZSx0LGkpLGl9cHJvamVjdE9uUGxhbmVUb1JlZihlLHQsaSl7Y29uc3Qgcz1lLm5vcm1hbCxyPWUuZCxuPUsuVmVjdG9yM1swXTt0aGlzLnN1YnRyYWN0VG9SZWYodCxuKSxuLm5vcm1hbGl6ZSgpO2NvbnN0IGE9cC5Eb3QobixzKTtpZihNYXRoLmFicyhhKTxNYXRoLnBvdygxMCwtMTApKWkuc2V0QWxsKDEvMCk7ZWxzZXtjb25zdCBvPS0ocC5Eb3QodCxzKStyKS9hLGg9bi5zY2FsZUluUGxhY2Uobyk7dC5hZGRUb1JlZihoLGkpfXJldHVybiBpfWVxdWFscyhlKXtyZXR1cm4gZSYmdGhpcy5feD09PWUuX3gmJnRoaXMuX3k9PT1lLl95JiZ0aGlzLl96PT09ZS5fen1lcXVhbHNXaXRoRXBzaWxvbihlLHQ9eGUpe3JldHVybiBlJiZYLldpdGhpbkVwc2lsb24odGhpcy5feCxlLl94LHQpJiZYLldpdGhpbkVwc2lsb24odGhpcy5feSxlLl95LHQpJiZYLldpdGhpbkVwc2lsb24odGhpcy5feixlLl96LHQpfWVxdWFsc1RvRmxvYXRzKGUsdCxpKXtyZXR1cm4gdGhpcy5feD09PWUmJnRoaXMuX3k9PT10JiZ0aGlzLl96PT09aX1tdWx0aXBseUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZS5feCx0aGlzLnkqPWUuX3ksdGhpcy56Kj1lLl96LHRoaXN9bXVsdGlwbHkoZSl7cmV0dXJuIHRoaXMubXVsdGlwbHlCeUZsb2F0cyhlLl94LGUuX3ksZS5feil9bXVsdGlwbHlUb1JlZihlLHQpe3JldHVybiB0LmNvcHlGcm9tRmxvYXRzKHRoaXMuX3gqZS5feCx0aGlzLl95KmUuX3ksdGhpcy5feiplLl96KX1tdWx0aXBseUJ5RmxvYXRzKGUsdCxpKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCplLHRoaXMuX3kqdCx0aGlzLl96KmkpfWRpdmlkZShlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feC9lLl94LHRoaXMuX3kvZS5feSx0aGlzLl96L2UuX3opfWRpdmlkZVRvUmVmKGUsdCl7cmV0dXJuIHQuY29weUZyb21GbG9hdHModGhpcy5feC9lLl94LHRoaXMuX3kvZS5feSx0aGlzLl96L2UuX3opfWRpdmlkZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMuZGl2aWRlVG9SZWYoZSx0aGlzKX1taW5pbWl6ZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMubWluaW1pemVJblBsYWNlRnJvbUZsb2F0cyhlLl94LGUuX3ksZS5feil9bWF4aW1pemVJblBsYWNlKGUpe3JldHVybiB0aGlzLm1heGltaXplSW5QbGFjZUZyb21GbG9hdHMoZS5feCxlLl95LGUuX3opfW1pbmltaXplSW5QbGFjZUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiBlPHRoaXMuX3gmJih0aGlzLng9ZSksdDx0aGlzLl95JiYodGhpcy55PXQpLGk8dGhpcy5feiYmKHRoaXMuej1pKSx0aGlzfW1heGltaXplSW5QbGFjZUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiBlPnRoaXMuX3gmJih0aGlzLng9ZSksdD50aGlzLl95JiYodGhpcy55PXQpLGk+dGhpcy5feiYmKHRoaXMuej1pKSx0aGlzfWlzTm9uVW5pZm9ybVdpdGhpbkVwc2lsb24oZSl7Y29uc3QgdD1NYXRoLmFicyh0aGlzLl94KSxpPU1hdGguYWJzKHRoaXMuX3kpO2lmKCFYLldpdGhpbkVwc2lsb24odCxpLGUpKXJldHVybiEwO2NvbnN0IHM9TWF0aC5hYnModGhpcy5feik7cmV0dXJuIVguV2l0aGluRXBzaWxvbih0LHMsZSl8fCFYLldpdGhpbkVwc2lsb24oaSxzLGUpfWdldCBpc05vblVuaWZvcm0oKXtjb25zdCBlPU1hdGguYWJzKHRoaXMuX3gpLHQ9TWF0aC5hYnModGhpcy5feSk7aWYoZSE9PXQpcmV0dXJuITA7Y29uc3QgaT1NYXRoLmFicyh0aGlzLl96KTtyZXR1cm4gZSE9PWl9Zmxvb3IoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoTWF0aC5mbG9vcih0aGlzLl94KSxNYXRoLmZsb29yKHRoaXMuX3kpLE1hdGguZmxvb3IodGhpcy5feikpfWZyYWN0KCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gtTWF0aC5mbG9vcih0aGlzLl94KSx0aGlzLl95LU1hdGguZmxvb3IodGhpcy5feSksdGhpcy5fei1NYXRoLmZsb29yKHRoaXMuX3opKX1sZW5ndGgoKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMuX3gqdGhpcy5feCt0aGlzLl95KnRoaXMuX3krdGhpcy5feip0aGlzLl96KX1sZW5ndGhTcXVhcmVkKCl7cmV0dXJuIHRoaXMuX3gqdGhpcy5feCt0aGlzLl95KnRoaXMuX3krdGhpcy5feip0aGlzLl96fWdldCBoYXNBWmVyb0NvbXBvbmVudCgpe3JldHVybiB0aGlzLl94KnRoaXMuX3kqdGhpcy5fej09PTB9bm9ybWFsaXplKCl7cmV0dXJuIHRoaXMubm9ybWFsaXplRnJvbUxlbmd0aCh0aGlzLmxlbmd0aCgpKX1yZW9yZGVySW5QbGFjZShlKXtyZXR1cm4gZT1lLnRvTG93ZXJDYXNlKCksZT09PSJ4eXoiP3RoaXM6KEsuVmVjdG9yM1swXS5jb3B5RnJvbSh0aGlzKSxbIngiLCJ5IiwieiJdLmZvckVhY2goKHQsaSk9Pnt0aGlzW3RdPUsuVmVjdG9yM1swXVtlW2ldXX0pLHRoaXMpfXJvdGF0ZUJ5UXVhdGVybmlvblRvUmVmKGUsdCl7cmV0dXJuIGUudG9Sb3RhdGlvbk1hdHJpeChLLk1hdHJpeFswXSkscC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKHRoaXMsSy5NYXRyaXhbMF0sdCksdH1yb3RhdGVCeVF1YXRlcm5pb25Bcm91bmRQb2ludFRvUmVmKGUsdCxpKXtyZXR1cm4gdGhpcy5zdWJ0cmFjdFRvUmVmKHQsSy5WZWN0b3IzWzBdKSxLLlZlY3RvcjNbMF0ucm90YXRlQnlRdWF0ZXJuaW9uVG9SZWYoZSxLLlZlY3RvcjNbMF0pLHQuYWRkVG9SZWYoSy5WZWN0b3IzWzBdLGkpLGl9Y3Jvc3MoZSl7Y29uc3QgdD1uZXcgdGhpcy5jb25zdHJ1Y3RvcjtyZXR1cm4gcC5Dcm9zc1RvUmVmKHRoaXMsZSx0KX1ub3JtYWxpemVGcm9tTGVuZ3RoKGUpe3JldHVybiBlPT09MHx8ZT09PTE/dGhpczp0aGlzLnNjYWxlSW5QbGFjZSgxL2UpfW5vcm1hbGl6ZVRvTmV3KCl7Y29uc3QgZT1uZXcgdGhpcy5jb25zdHJ1Y3RvcigwLDAsMCk7cmV0dXJuIHRoaXMubm9ybWFsaXplVG9SZWYoZSksZX1ub3JtYWxpemVUb1JlZihlKXtjb25zdCB0PXRoaXMubGVuZ3RoKCk7cmV0dXJuIHQ9PT0wfHx0PT09MT9lLmNvcHlGcm9tRmxvYXRzKHRoaXMuX3gsdGhpcy5feSx0aGlzLl96KTp0aGlzLnNjYWxlVG9SZWYoMS90LGUpfWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gsdGhpcy5feSx0aGlzLl96KX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy5jb3B5RnJvbUZsb2F0cyhlLl94LGUuX3ksZS5feil9Y29weUZyb21GbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzfXNldChlLHQsaSl7cmV0dXJuIHRoaXMuY29weUZyb21GbG9hdHMoZSx0LGkpfXNldEFsbChlKXtyZXR1cm4gdGhpcy54PXRoaXMueT10aGlzLno9ZSx0aGlzfXN0YXRpYyBHZXRDbGlwRmFjdG9yKGUsdCxpLHMpe2NvbnN0IHI9cC5Eb3QoZSxpKS1zLG49cC5Eb3QodCxpKS1zO3JldHVybiByLyhyLW4pfXN0YXRpYyBHZXRBbmdsZUJldHdlZW5WZWN0b3JzKGUsdCxpKXtjb25zdCBzPWUubm9ybWFsaXplVG9SZWYoSy5WZWN0b3IzWzFdKSxyPXQubm9ybWFsaXplVG9SZWYoSy5WZWN0b3IzWzJdKTtsZXQgbj1wLkRvdChzLHIpO249WC5DbGFtcChuLC0xLDEpO2NvbnN0IGE9TWF0aC5hY29zKG4pLG89Sy5WZWN0b3IzWzNdO3JldHVybiBwLkNyb3NzVG9SZWYocyxyLG8pLHAuRG90KG8saSk+MD9pc05hTihhKT8wOmE6aXNOYU4oYSk/LU1hdGguUEk6LU1hdGguYWNvcyhuKX1zdGF0aWMgR2V0QW5nbGVCZXR3ZWVuVmVjdG9yc09uUGxhbmUoZSx0LGkpe0suVmVjdG9yM1swXS5jb3B5RnJvbShlKTtjb25zdCBzPUsuVmVjdG9yM1swXTtLLlZlY3RvcjNbMV0uY29weUZyb20odCk7Y29uc3Qgcj1LLlZlY3RvcjNbMV07Sy5WZWN0b3IzWzJdLmNvcHlGcm9tKGkpO2NvbnN0IG49Sy5WZWN0b3IzWzJdLGE9Sy5WZWN0b3IzWzNdLG89Sy5WZWN0b3IzWzRdO3Mubm9ybWFsaXplKCksci5ub3JtYWxpemUoKSxuLm5vcm1hbGl6ZSgpLHAuQ3Jvc3NUb1JlZihuLHMsYSkscC5Dcm9zc1RvUmVmKGEsbixvKTtjb25zdCBoPU1hdGguYXRhbjIocC5Eb3QocixhKSxwLkRvdChyLG8pKTtyZXR1cm4gWC5Ob3JtYWxpemVSYWRpYW5zKGgpfXN0YXRpYyBQaXRjaFlhd1JvbGxUb01vdmVCZXR3ZWVuUG9pbnRzVG9SZWYoZSx0LGkpe2NvbnN0IHM9RC5WZWN0b3IzWzBdO3JldHVybiB0LnN1YnRyYWN0VG9SZWYoZSxzKSxpLnk9TWF0aC5hdGFuMihzLngscy56KXx8MCxpLng9TWF0aC5hdGFuMihNYXRoLnNxcnQocy54KioyK3MueioqMikscy55KXx8MCxpLno9MCxpfXN0YXRpYyBQaXRjaFlhd1JvbGxUb01vdmVCZXR3ZWVuUG9pbnRzKGUsdCl7Y29uc3QgaT1wLlplcm8oKTtyZXR1cm4gcC5QaXRjaFlhd1JvbGxUb01vdmVCZXR3ZWVuUG9pbnRzVG9SZWYoZSx0LGkpfXN0YXRpYyBTbGVycFRvUmVmKGUsdCxpLHMpe2k9WC5DbGFtcChpLDAsMSk7Y29uc3Qgcj1LLlZlY3RvcjNbMF0sbj1LLlZlY3RvcjNbMV07ci5jb3B5RnJvbShlKTtjb25zdCBhPXIubGVuZ3RoKCk7ci5ub3JtYWxpemVGcm9tTGVuZ3RoKGEpLG4uY29weUZyb20odCk7Y29uc3Qgbz1uLmxlbmd0aCgpO24ubm9ybWFsaXplRnJvbUxlbmd0aChvKTtjb25zdCBoPXAuRG90KHIsbik7bGV0IGwsdTtpZihoPDEteGUpe2NvbnN0IGQ9TWF0aC5hY29zKGgpLGY9MS9NYXRoLnNpbihkKTtsPU1hdGguc2luKCgxLWkpKmQpKmYsdT1NYXRoLnNpbihpKmQpKmZ9ZWxzZSBsPTEtaSx1PWk7cmV0dXJuIHIuc2NhbGVJblBsYWNlKGwpLG4uc2NhbGVJblBsYWNlKHUpLHMuY29weUZyb20ocikuYWRkSW5QbGFjZShuKSxzLnNjYWxlSW5QbGFjZShYLkxlcnAoYSxvLGkpKSxzfXN0YXRpYyBTbW9vdGhUb1JlZihlLHQsaSxzLHIpe3JldHVybiBwLlNsZXJwVG9SZWYoZSx0LHM9PT0wPzE6aS9zLHIpLHJ9c3RhdGljIEZyb21BcnJheShlLHQ9MCl7cmV0dXJuIG5ldyBwKGVbdF0sZVt0KzFdLGVbdCsyXSl9c3RhdGljIEZyb21GbG9hdEFycmF5KGUsdCl7cmV0dXJuIHAuRnJvbUFycmF5KGUsdCl9c3RhdGljIEZyb21BcnJheVRvUmVmKGUsdCxpKXtyZXR1cm4gaS54PWVbdF0saS55PWVbdCsxXSxpLno9ZVt0KzJdLGl9c3RhdGljIEZyb21GbG9hdEFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBwLkZyb21BcnJheVRvUmVmKGUsdCxpKX1zdGF0aWMgRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMpe3JldHVybiBzLmNvcHlGcm9tRmxvYXRzKGUsdCxpKSxzfXN0YXRpYyBaZXJvKCl7cmV0dXJuIG5ldyBwKDAsMCwwKX1zdGF0aWMgT25lKCl7cmV0dXJuIG5ldyBwKDEsMSwxKX1zdGF0aWMgVXAoKXtyZXR1cm4gbmV3IHAoMCwxLDApfXN0YXRpYyBnZXQgVXBSZWFkT25seSgpe3JldHVybiBwLl9VcFJlYWRPbmx5fXN0YXRpYyBnZXQgRG93blJlYWRPbmx5KCl7cmV0dXJuIHAuX0Rvd25SZWFkT25seX1zdGF0aWMgZ2V0IFJpZ2h0UmVhZE9ubHkoKXtyZXR1cm4gcC5fUmlnaHRSZWFkT25seX1zdGF0aWMgZ2V0IExlZnRSZWFkT25seSgpe3JldHVybiBwLl9MZWZ0UmVhZE9ubHl9c3RhdGljIGdldCBMZWZ0SGFuZGVkRm9yd2FyZFJlYWRPbmx5KCl7cmV0dXJuIHAuX0xlZnRIYW5kZWRGb3J3YXJkUmVhZE9ubHl9c3RhdGljIGdldCBSaWdodEhhbmRlZEZvcndhcmRSZWFkT25seSgpe3JldHVybiBwLl9SaWdodEhhbmRlZEZvcndhcmRSZWFkT25seX1zdGF0aWMgZ2V0IFplcm9SZWFkT25seSgpe3JldHVybiBwLl9aZXJvUmVhZE9ubHl9c3RhdGljIERvd24oKXtyZXR1cm4gbmV3IHAoMCwtMSwwKX1zdGF0aWMgRm9yd2FyZChlPSExKXtyZXR1cm4gbmV3IHAoMCwwLGU/LTE6MSl9c3RhdGljIEJhY2t3YXJkKGU9ITEpe3JldHVybiBuZXcgcCgwLDAsZT8xOi0xKX1zdGF0aWMgUmlnaHQoKXtyZXR1cm4gbmV3IHAoMSwwLDApfXN0YXRpYyBMZWZ0KCl7cmV0dXJuIG5ldyBwKC0xLDAsMCl9c3RhdGljIFRyYW5zZm9ybUNvb3JkaW5hdGVzKGUsdCl7Y29uc3QgaT1wLlplcm8oKTtyZXR1cm4gcC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKXtyZXR1cm4gcC5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0LGkpLGl9c3RhdGljIFRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMscil7Y29uc3Qgbj1zLm0sYT1lKm5bMF0rdCpuWzRdK2kqbls4XStuWzEyXSxvPWUqblsxXSt0Km5bNV0raSpuWzldK25bMTNdLGg9ZSpuWzJdK3Qqbls2XStpKm5bMTBdK25bMTRdLGw9MS8oZSpuWzNdK3Qqbls3XStpKm5bMTFdK25bMTVdKTtyZXR1cm4gci54PWEqbCxyLnk9bypsLHIuej1oKmwscn1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsKGUsdCl7Y29uc3QgaT1wLlplcm8oKTtyZXR1cm4gcC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLHQsaSksaX1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsVG9SZWYoZSx0LGkpe3JldHVybiB0aGlzLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0LGkpLGl9c3RhdGljIFRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihlLHQsaSxzLHIpe2NvbnN0IG49cy5tO3JldHVybiByLng9ZSpuWzBdK3Qqbls0XStpKm5bOF0sci55PWUqblsxXSt0Km5bNV0raSpuWzldLHIuej1lKm5bMl0rdCpuWzZdK2kqblsxMF0scn1zdGF0aWMgQ2F0bXVsbFJvbShlLHQsaSxzLHIpe2NvbnN0IG49cipyLGE9cipuLG89LjUqKDIqdC5feCsoLWUuX3graS5feCkqcisoMiplLl94LTUqdC5feCs0KmkuX3gtcy5feCkqbisoLWUuX3grMyp0Ll94LTMqaS5feCtzLl94KSphKSxoPS41KigyKnQuX3krKC1lLl95K2kuX3kpKnIrKDIqZS5feS01KnQuX3krNCppLl95LXMuX3kpKm4rKC1lLl95KzMqdC5feS0zKmkuX3krcy5feSkqYSksbD0uNSooMip0Ll96KygtZS5feitpLl96KSpyKygyKmUuX3otNSp0Ll96KzQqaS5fei1zLl96KSpuKygtZS5feiszKnQuX3otMyppLl96K3MuX3opKmEpO3JldHVybiBuZXcgZS5jb25zdHJ1Y3RvcihvLGgsbCl9c3RhdGljIENsYW1wKGUsdCxpKXtjb25zdCBzPW5ldyBlLmNvbnN0cnVjdG9yO3JldHVybiBwLkNsYW1wVG9SZWYoZSx0LGkscyksc31zdGF0aWMgQ2xhbXBUb1JlZihlLHQsaSxzKXtsZXQgcj1lLl94O3I9cj5pLl94P2kuX3g6cixyPXI8dC5feD90Ll94OnI7bGV0IG49ZS5feTtuPW4+aS5feT9pLl95Om4sbj1uPHQuX3k/dC5feTpuO2xldCBhPWUuX3o7cmV0dXJuIGE9YT5pLl96P2kuX3o6YSxhPWE8dC5fej90Ll96OmEscy5jb3B5RnJvbUZsb2F0cyhyLG4sYSksc31zdGF0aWMgQ2hlY2tFeHRlbmRzKGUsdCxpKXt0Lm1pbmltaXplSW5QbGFjZShlKSxpLm1heGltaXplSW5QbGFjZShlKX1zdGF0aWMgSGVybWl0ZShlLHQsaSxzLHIpe2NvbnN0IG49cipyLGE9cipuLG89MiphLTMqbisxLGg9LTIqYSszKm4sbD1hLTIqbityLHU9YS1uLGQ9ZS5feCpvK2kuX3gqaCt0Ll94Kmwrcy5feCp1LGY9ZS5feSpvK2kuX3kqaCt0Ll95Kmwrcy5feSp1LF89ZS5feipvK2kuX3oqaCt0Ll96Kmwrcy5feip1O3JldHVybiBuZXcgZS5jb25zdHJ1Y3RvcihkLGYsXyl9c3RhdGljIEhlcm1pdGUxc3REZXJpdmF0aXZlKGUsdCxpLHMscil7Y29uc3Qgbj1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5IZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKSxufXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIqcjtyZXR1cm4gbi54PShhLXIpKjYqZS54KygzKmEtNCpyKzEpKnQueCsoLWErcikqNippLngrKDMqYS0yKnIpKnMueCxuLnk9KGEtcikqNiplLnkrKDMqYS00KnIrMSkqdC55KygtYStyKSo2KmkueSsoMyphLTIqcikqcy55LG4uej0oYS1yKSo2KmUueisoMyphLTQqcisxKSp0LnorKC1hK3IpKjYqaS56KygzKmEtMipyKSpzLnosbn1zdGF0aWMgTGVycChlLHQsaSl7Y29uc3Qgcz1uZXcgZS5jb25zdHJ1Y3RvcigwLDAsMCk7cmV0dXJuIHAuTGVycFRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIExlcnBUb1JlZihlLHQsaSxzKXtyZXR1cm4gcy54PWUuX3grKHQuX3gtZS5feCkqaSxzLnk9ZS5feSsodC5feS1lLl95KSppLHMuej1lLl96Kyh0Ll96LWUuX3opKmksc31zdGF0aWMgRG90KGUsdCl7cmV0dXJuIGUuX3gqdC5feCtlLl95KnQuX3krZS5feip0Ll96fXN0YXRpYyBDcm9zcyhlLHQpe2NvbnN0IGk9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHAuQ3Jvc3NUb1JlZihlLHQsaSksaX1zdGF0aWMgQ3Jvc3NUb1JlZihlLHQsaSl7Y29uc3Qgcz1lLl95KnQuX3otZS5feip0Ll95LHI9ZS5feip0Ll94LWUuX3gqdC5feixuPWUuX3gqdC5feS1lLl95KnQuX3g7cmV0dXJuIGkuY29weUZyb21GbG9hdHMocyxyLG4pLGl9c3RhdGljIE5vcm1hbGl6ZShlKXtjb25zdCB0PXAuWmVybygpO3JldHVybiBwLk5vcm1hbGl6ZVRvUmVmKGUsdCksdH1zdGF0aWMgTm9ybWFsaXplVG9SZWYoZSx0KXtyZXR1cm4gZS5ub3JtYWxpemVUb1JlZih0KSx0fXN0YXRpYyBQcm9qZWN0KGUsdCxpLHMpe2NvbnN0IHI9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHAuUHJvamVjdFRvUmVmKGUsdCxpLHMscikscn1zdGF0aWMgUHJvamVjdFRvUmVmKGUsdCxpLHMscil7Y29uc3Qgbj1zLndpZHRoLGE9cy5oZWlnaHQsbz1zLngsaD1zLnksbD1LLk1hdHJpeFsxXTt4LkZyb21WYWx1ZXNUb1JlZihuLzIsMCwwLDAsMCwtYS8yLDAsMCwwLDAsLjUsMCxvK24vMixhLzIraCwuNSwxLGwpO2NvbnN0IHU9Sy5NYXRyaXhbMF07cmV0dXJuIHQubXVsdGlwbHlUb1JlZihpLHUpLHUubXVsdGlwbHlUb1JlZihsLHUpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihlLHUscikscn1zdGF0aWMgUmVmbGVjdChlLHQpe3JldHVybiB0aGlzLlJlZmxlY3RUb1JlZihlLHQsbmV3IHApfXN0YXRpYyBSZWZsZWN0VG9SZWYoZSx0LGkpe2NvbnN0IHM9RC5WZWN0b3IzWzBdO3JldHVybiBzLmNvcHlGcm9tKHQpLnNjYWxlSW5QbGFjZSgyKnAuRG90KGUsdCkpLGkuY29weUZyb20oZSkuc3VidHJhY3RJblBsYWNlKHMpfXN0YXRpYyBfVW5wcm9qZWN0RnJvbUludmVydGVkTWF0cml4VG9SZWYoZSx0LGkpe3AuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihlLHQsaSk7Y29uc3Qgcz10Lm0scj1lLl94KnNbM10rZS5feSpzWzddK2UuX3oqc1sxMV0rc1sxNV07cmV0dXJuIFguV2l0aGluRXBzaWxvbihyLDEpJiZpLnNjYWxlSW5QbGFjZSgxL3IpLGl9c3RhdGljIFVucHJvamVjdEZyb21UcmFuc2Zvcm0oZSx0LGkscyxyKXtyZXR1cm4gdGhpcy5VbnByb2plY3QoZSx0LGkscyxyLHguSWRlbnRpdHlSZWFkT25seSl9c3RhdGljIFVucHJvamVjdChlLHQsaSxzLHIsbil7Y29uc3QgYT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gcC5VbnByb2plY3RUb1JlZihlLHQsaSxzLHIsbixhKSxhfXN0YXRpYyBVbnByb2plY3RUb1JlZihlLHQsaSxzLHIsbixhKXtyZXR1cm4gcC5VbnByb2plY3RGbG9hdHNUb1JlZihlLl94LGUuX3ksZS5feix0LGkscyxyLG4sYSksYX1zdGF0aWMgVW5wcm9qZWN0RmxvYXRzVG9SZWYoZSx0LGkscyxyLG4sYSxvLGgpe3ZhciBsO2NvbnN0IHU9Sy5NYXRyaXhbMF07bi5tdWx0aXBseVRvUmVmKGEsdSksdS5tdWx0aXBseVRvUmVmKG8sdSksdS5pbnZlcnQoKTtjb25zdCBkPUsuVmVjdG9yM1swXTtyZXR1cm4gZC54PWUvcyoyLTEsZC55PS0odC9yKjItMSksISgobD1mZS5MYXN0Q3JlYXRlZEVuZ2luZSk9PT1udWxsfHxsPT09dm9pZCAwKSYmbC5pc05EQ0hhbGZaUmFuZ2U/ZC56PWk6ZC56PTIqaS0xLHAuX1VucHJvamVjdEZyb21JbnZlcnRlZE1hdHJpeFRvUmVmKGQsdSxoKSxofXN0YXRpYyBNaW5pbWl6ZShlLHQpe2NvbnN0IGk9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIGkuY29weUZyb20oZSksaS5taW5pbWl6ZUluUGxhY2UodCksaX1zdGF0aWMgTWF4aW1pemUoZSx0KXtjb25zdCBpPW5ldyBlLmNvbnN0cnVjdG9yO3JldHVybiBpLmNvcHlGcm9tKGUpLGkubWF4aW1pemVJblBsYWNlKHQpLGl9c3RhdGljIERpc3RhbmNlKGUsdCl7cmV0dXJuIE1hdGguc3FydChwLkRpc3RhbmNlU3F1YXJlZChlLHQpKX1zdGF0aWMgRGlzdGFuY2VTcXVhcmVkKGUsdCl7Y29uc3QgaT1lLl94LXQuX3gscz1lLl95LXQuX3kscj1lLl96LXQuX3o7cmV0dXJuIGkqaStzKnMrcipyfXN0YXRpYyBQcm9qZWN0T25UcmlhbmdsZVRvUmVmKGUsdCxpLHMscil7Y29uc3Qgbj1LLlZlY3RvcjNbMF0sYT1LLlZlY3RvcjNbMV0sbz1LLlZlY3RvcjNbMl0saD1LLlZlY3RvcjNbM10sbD1LLlZlY3RvcjNbNF07aS5zdWJ0cmFjdFRvUmVmKHQsbikscy5zdWJ0cmFjdFRvUmVmKHQsYSkscy5zdWJ0cmFjdFRvUmVmKGksbyk7Y29uc3QgdT1uLmxlbmd0aCgpLGQ9YS5sZW5ndGgoKSxmPW8ubGVuZ3RoKCk7aWYodTx4ZXx8ZDx4ZXx8Zjx4ZSlyZXR1cm4gci5jb3B5RnJvbSh0KSxwLkRpc3RhbmNlKGUsdCk7ZS5zdWJ0cmFjdFRvUmVmKHQsbCkscC5Dcm9zc1RvUmVmKG4sYSxoKTtjb25zdCBfPWgubGVuZ3RoKCk7aWYoXzx4ZSlyZXR1cm4gci5jb3B5RnJvbSh0KSxwLkRpc3RhbmNlKGUsdCk7aC5ub3JtYWxpemVGcm9tTGVuZ3RoKF8pO2xldCBFPWwubGVuZ3RoKCk7aWYoRTx4ZSlyZXR1cm4gci5jb3B5RnJvbSh0KSwwO2wubm9ybWFsaXplRnJvbUxlbmd0aChFKTtjb25zdCBtPXAuRG90KGgsbCksdj1LLlZlY3RvcjNbNV0sUz1LLlZlY3RvcjNbNl07di5jb3B5RnJvbShoKS5zY2FsZUluUGxhY2UoLUUqbSksUy5jb3B5RnJvbShlKS5hZGRJblBsYWNlKHYpO2NvbnN0IHk9Sy5WZWN0b3IzWzRdLEE9Sy5WZWN0b3IzWzVdLEM9Sy5WZWN0b3IzWzddLGI9Sy5WZWN0b3IzWzhdO3kuY29weUZyb20obikuc2NhbGVJblBsYWNlKDEvdSksYi5jb3B5RnJvbShhKS5zY2FsZUluUGxhY2UoMS9kKSx5LmFkZEluUGxhY2UoYikuc2NhbGVJblBsYWNlKC0xKSxBLmNvcHlGcm9tKG4pLnNjYWxlSW5QbGFjZSgtMS91KSxiLmNvcHlGcm9tKG8pLnNjYWxlSW5QbGFjZSgxL2YpLEEuYWRkSW5QbGFjZShiKS5zY2FsZUluUGxhY2UoLTEpLEMuY29weUZyb20obykuc2NhbGVJblBsYWNlKC0xL2YpLGIuY29weUZyb20oYSkuc2NhbGVJblBsYWNlKC0xL2QpLEMuYWRkSW5QbGFjZShiKS5zY2FsZUluUGxhY2UoLTEpO2NvbnN0IE09Sy5WZWN0b3IzWzldO2xldCBMO00uY29weUZyb20oUykuc3VidHJhY3RJblBsYWNlKHQpLHAuQ3Jvc3NUb1JlZih5LE0sYiksTD1wLkRvdChiLGgpO2NvbnN0IGs9TDtNLmNvcHlGcm9tKFMpLnN1YnRyYWN0SW5QbGFjZShpKSxwLkNyb3NzVG9SZWYoQSxNLGIpLEw9cC5Eb3QoYixoKTtjb25zdCB3PUw7TS5jb3B5RnJvbShTKS5zdWJ0cmFjdEluUGxhY2UocykscC5Dcm9zc1RvUmVmKEMsTSxiKSxMPXAuRG90KGIsaCk7Y29uc3QgZGU9TCxjZT1LLlZlY3RvcjNbMTBdO2xldCBzZSx0ZTtrPjAmJnc8MD8oY2UuY29weUZyb20obiksc2U9dCx0ZT1pKTp3PjAmJmRlPDA/KGNlLmNvcHlGcm9tKG8pLHNlPWksdGU9cyk6KGNlLmNvcHlGcm9tKGEpLnNjYWxlSW5QbGFjZSgtMSksc2U9cyx0ZT10KTtjb25zdCBGZT1LLlZlY3RvcjNbOV0sd2U9Sy5WZWN0b3IzWzRdO2lmKHNlLnN1YnRyYWN0VG9SZWYoUyxiKSx0ZS5zdWJ0cmFjdFRvUmVmKFMsRmUpLHAuQ3Jvc3NUb1JlZihiLEZlLHdlKSwhKHAuRG90KHdlLGgpPDApKXJldHVybiByLmNvcHlGcm9tKFMpLE1hdGguYWJzKEUqbSk7Y29uc3QgS2U9Sy5WZWN0b3IzWzVdO3AuQ3Jvc3NUb1JlZihjZSx3ZSxLZSksS2Uubm9ybWFsaXplKCk7Y29uc3QgWWU9Sy5WZWN0b3IzWzldO1llLmNvcHlGcm9tKHNlKS5zdWJ0cmFjdEluUGxhY2UoUyk7Y29uc3QgcHQ9WWUubGVuZ3RoKCk7aWYocHQ8eGUpcmV0dXJuIHIuY29weUZyb20oc2UpLHAuRGlzdGFuY2UoZSxzZSk7WWUubm9ybWFsaXplRnJvbUxlbmd0aChwdCk7Y29uc3QgaHQ9cC5Eb3QoS2UsWWUpLHd0PUsuVmVjdG9yM1s3XTt3dC5jb3B5RnJvbShTKS5hZGRJblBsYWNlKEtlLnNjYWxlSW5QbGFjZShwdCpodCkpLGIuY29weUZyb20od3QpLnN1YnRyYWN0SW5QbGFjZShzZSksRT1jZS5sZW5ndGgoKSxjZS5ub3JtYWxpemVGcm9tTGVuZ3RoKEUpO2xldCBzaT1wLkRvdChiLGNlKS9NYXRoLm1heChFLHhlKTtyZXR1cm4gc2k9WC5DbGFtcChzaSwwLDEpLHd0LmNvcHlGcm9tKHNlKS5hZGRJblBsYWNlKGNlLnNjYWxlSW5QbGFjZShzaSpFKSksci5jb3B5RnJvbSh3dCkscC5EaXN0YW5jZShlLHd0KX1zdGF0aWMgQ2VudGVyKGUsdCl7cmV0dXJuIHAuQ2VudGVyVG9SZWYoZSx0LHAuWmVybygpKX1zdGF0aWMgQ2VudGVyVG9SZWYoZSx0LGkpe3JldHVybiBpLmNvcHlGcm9tRmxvYXRzKChlLl94K3QuX3gpLzIsKGUuX3krdC5feSkvMiwoZS5feit0Ll96KS8yKX1zdGF0aWMgUm90YXRpb25Gcm9tQXhpcyhlLHQsaSl7Y29uc3Qgcz1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gcC5Sb3RhdGlvbkZyb21BeGlzVG9SZWYoZSx0LGkscyksc31zdGF0aWMgUm90YXRpb25Gcm9tQXhpc1RvUmVmKGUsdCxpLHMpe2NvbnN0IHI9Sy5RdWF0ZXJuaW9uWzBdO3JldHVybiBaLlJvdGF0aW9uUXVhdGVybmlvbkZyb21BeGlzVG9SZWYoZSx0LGksciksci50b0V1bGVyQW5nbGVzVG9SZWYocyksc319cC5fVXBSZWFkT25seT1wLlVwKCkscC5fRG93blJlYWRPbmx5PXAuRG93bigpLHAuX0xlZnRIYW5kZWRGb3J3YXJkUmVhZE9ubHk9cC5Gb3J3YXJkKCExKSxwLl9SaWdodEhhbmRlZEZvcndhcmRSZWFkT25seT1wLkZvcndhcmQoITApLHAuX1JpZ2h0UmVhZE9ubHk9cC5SaWdodCgpLHAuX0xlZnRSZWFkT25seT1wLkxlZnQoKSxwLl9aZXJvUmVhZE9ubHk9cC5aZXJvKCk7Y2xhc3MgQ2V7Y29uc3RydWN0b3IoZT0wLHQ9MCxpPTAscz0wKXt0aGlzLng9ZSx0aGlzLnk9dCx0aGlzLno9aSx0aGlzLnc9c310b1N0cmluZygpe3JldHVybmB7WDogJHt0aGlzLnh9IFk6ICR7dGhpcy55fSBaOiAke3RoaXMuen0gVzogJHt0aGlzLnd9fWB9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlZlY3RvcjQifWdldEhhc2hDb2RlKCl7Y29uc3QgZT1zdCh0aGlzLngpLHQ9c3QodGhpcy55KSxpPXN0KHRoaXMueikscz1zdCh0aGlzLncpO2xldCByPWU7cmV0dXJuIHI9ciozOTdedCxyPXIqMzk3Xmkscj1yKjM5N15zLHJ9YXNBcnJheSgpe2NvbnN0IGU9bmV3IEFycmF5O3JldHVybiB0aGlzLnRvQXJyYXkoZSwwKSxlfXRvQXJyYXkoZSx0KXtyZXR1cm4gdD09PXZvaWQgMCYmKHQ9MCksZVt0XT10aGlzLngsZVt0KzFdPXRoaXMueSxlW3QrMl09dGhpcy56LGVbdCszXT10aGlzLncsdGhpc31mcm9tQXJyYXkoZSx0PTApe3JldHVybiBDZS5Gcm9tQXJyYXlUb1JlZihlLHQsdGhpcyksdGhpc31hZGRJblBsYWNlKGUpe3JldHVybiB0aGlzLngrPWUueCx0aGlzLnkrPWUueSx0aGlzLnorPWUueix0aGlzLncrPWUudyx0aGlzfWFkZChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54K2UueCx0aGlzLnkrZS55LHRoaXMueitlLnosdGhpcy53K2Uudyl9YWRkVG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueCtlLngsdC55PXRoaXMueStlLnksdC56PXRoaXMueitlLnosdC53PXRoaXMudytlLncsdH1zdWJ0cmFjdEluUGxhY2UoZSl7cmV0dXJuIHRoaXMueC09ZS54LHRoaXMueS09ZS55LHRoaXMuei09ZS56LHRoaXMudy09ZS53LHRoaXN9c3VidHJhY3QoZSl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueC1lLngsdGhpcy55LWUueSx0aGlzLnotZS56LHRoaXMudy1lLncpfXN1YnRyYWN0VG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueC1lLngsdC55PXRoaXMueS1lLnksdC56PXRoaXMuei1lLnosdC53PXRoaXMudy1lLncsdH1zdWJ0cmFjdEZyb21GbG9hdHMoZSx0LGkscyl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueC1lLHRoaXMueS10LHRoaXMuei1pLHRoaXMudy1zKX1zdWJ0cmFjdEZyb21GbG9hdHNUb1JlZihlLHQsaSxzLHIpe3JldHVybiByLng9dGhpcy54LWUsci55PXRoaXMueS10LHIuej10aGlzLnotaSxyLnc9dGhpcy53LXMscn1uZWdhdGUoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoLXRoaXMueCwtdGhpcy55LC10aGlzLnosLXRoaXMudyl9bmVnYXRlSW5QbGFjZSgpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzLncqPS0xLHRoaXN9bmVnYXRlVG9SZWYoZSl7cmV0dXJuIGUuY29weUZyb21GbG9hdHModGhpcy54Ki0xLHRoaXMueSotMSx0aGlzLnoqLTEsdGhpcy53Ki0xKX1zY2FsZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXMudyo9ZSx0aGlzfXNjYWxlKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngqZSx0aGlzLnkqZSx0aGlzLnoqZSx0aGlzLncqZSl9c2NhbGVUb1JlZihlLHQpe3JldHVybiB0Lng9dGhpcy54KmUsdC55PXRoaXMueSplLHQuej10aGlzLnoqZSx0Lnc9dGhpcy53KmUsdH1zY2FsZUFuZEFkZFRvUmVmKGUsdCl7cmV0dXJuIHQueCs9dGhpcy54KmUsdC55Kz10aGlzLnkqZSx0LnorPXRoaXMueiplLHQudys9dGhpcy53KmUsdH1lcXVhbHMoZSl7cmV0dXJuIGUmJnRoaXMueD09PWUueCYmdGhpcy55PT09ZS55JiZ0aGlzLno9PT1lLnomJnRoaXMudz09PWUud31lcXVhbHNXaXRoRXBzaWxvbihlLHQ9eGUpe3JldHVybiBlJiZYLldpdGhpbkVwc2lsb24odGhpcy54LGUueCx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMueSxlLnksdCkmJlguV2l0aGluRXBzaWxvbih0aGlzLnosZS56LHQpJiZYLldpdGhpbkVwc2lsb24odGhpcy53LGUudyx0KX1lcXVhbHNUb0Zsb2F0cyhlLHQsaSxzKXtyZXR1cm4gdGhpcy54PT09ZSYmdGhpcy55PT09dCYmdGhpcy56PT09aSYmdGhpcy53PT09c31tdWx0aXBseUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZS54LHRoaXMueSo9ZS55LHRoaXMueio9ZS56LHRoaXMudyo9ZS53LHRoaXN9bXVsdGlwbHkoZSl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCplLngsdGhpcy55KmUueSx0aGlzLnoqZS56LHRoaXMudyplLncpfW11bHRpcGx5VG9SZWYoZSx0KXtyZXR1cm4gdC54PXRoaXMueCplLngsdC55PXRoaXMueSplLnksdC56PXRoaXMueiplLnosdC53PXRoaXMudyplLncsdH1tdWx0aXBseUJ5RmxvYXRzKGUsdCxpLHMpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngqZSx0aGlzLnkqdCx0aGlzLnoqaSx0aGlzLncqcyl9ZGl2aWRlKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngvZS54LHRoaXMueS9lLnksdGhpcy56L2Uueix0aGlzLncvZS53KX1kaXZpZGVUb1JlZihlLHQpe3JldHVybiB0Lng9dGhpcy54L2UueCx0Lnk9dGhpcy55L2UueSx0Lno9dGhpcy56L2Uueix0Lnc9dGhpcy53L2Uudyx0fWRpdmlkZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMuZGl2aWRlVG9SZWYoZSx0aGlzKX1taW5pbWl6ZUluUGxhY2UoZSl7cmV0dXJuIGUueDx0aGlzLngmJih0aGlzLng9ZS54KSxlLnk8dGhpcy55JiYodGhpcy55PWUueSksZS56PHRoaXMueiYmKHRoaXMuej1lLnopLGUudzx0aGlzLncmJih0aGlzLnc9ZS53KSx0aGlzfW1heGltaXplSW5QbGFjZShlKXtyZXR1cm4gZS54PnRoaXMueCYmKHRoaXMueD1lLngpLGUueT50aGlzLnkmJih0aGlzLnk9ZS55KSxlLno+dGhpcy56JiYodGhpcy56PWUueiksZS53PnRoaXMudyYmKHRoaXMudz1lLncpLHRoaXN9Zmxvb3IoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoTWF0aC5mbG9vcih0aGlzLngpLE1hdGguZmxvb3IodGhpcy55KSxNYXRoLmZsb29yKHRoaXMueiksTWF0aC5mbG9vcih0aGlzLncpKX1mcmFjdCgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngtTWF0aC5mbG9vcih0aGlzLngpLHRoaXMueS1NYXRoLmZsb29yKHRoaXMueSksdGhpcy56LU1hdGguZmxvb3IodGhpcy56KSx0aGlzLnctTWF0aC5mbG9vcih0aGlzLncpKX1sZW5ndGgoKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56K3RoaXMudyp0aGlzLncpfWxlbmd0aFNxdWFyZWQoKXtyZXR1cm4gdGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55K3RoaXMueip0aGlzLnordGhpcy53KnRoaXMud31ub3JtYWxpemUoKXtjb25zdCBlPXRoaXMubGVuZ3RoKCk7cmV0dXJuIGU9PT0wP3RoaXM6dGhpcy5zY2FsZUluUGxhY2UoMS9lKX10b1ZlY3RvcjMoKXtyZXR1cm4gbmV3IHAodGhpcy54LHRoaXMueSx0aGlzLnopfWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCx0aGlzLnksdGhpcy56LHRoaXMudyl9Y29weUZyb20oZSl7cmV0dXJuIHRoaXMueD1lLngsdGhpcy55PWUueSx0aGlzLno9ZS56LHRoaXMudz1lLncsdGhpc31jb3B5RnJvbUZsb2F0cyhlLHQsaSxzKXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWksdGhpcy53PXMsdGhpc31zZXQoZSx0LGkscyl7cmV0dXJuIHRoaXMuY29weUZyb21GbG9hdHMoZSx0LGkscyl9c2V0QWxsKGUpe3JldHVybiB0aGlzLng9dGhpcy55PXRoaXMuej10aGlzLnc9ZSx0aGlzfXN0YXRpYyBGcm9tQXJyYXkoZSx0KXtyZXR1cm4gdHx8KHQ9MCksbmV3IENlKGVbdF0sZVt0KzFdLGVbdCsyXSxlW3QrM10pfXN0YXRpYyBGcm9tQXJyYXlUb1JlZihlLHQsaSl7cmV0dXJuIGkueD1lW3RdLGkueT1lW3QrMV0saS56PWVbdCsyXSxpLnc9ZVt0KzNdLGl9c3RhdGljIEZyb21GbG9hdEFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBDZS5Gcm9tQXJyYXlUb1JlZihlLHQsaSksaX1zdGF0aWMgRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMscil7cmV0dXJuIHIueD1lLHIueT10LHIuej1pLHIudz1zLHJ9c3RhdGljIFplcm8oKXtyZXR1cm4gbmV3IENlKDAsMCwwLDApfXN0YXRpYyBPbmUoKXtyZXR1cm4gbmV3IENlKDEsMSwxLDEpfXN0YXRpYyBnZXQgWmVyb1JlYWRPbmx5KCl7cmV0dXJuIENlLl9aZXJvUmVhZE9ubHl9c3RhdGljIE5vcm1hbGl6ZShlKXtjb25zdCB0PUNlLlplcm8oKTtyZXR1cm4gQ2UuTm9ybWFsaXplVG9SZWYoZSx0KSx0fXN0YXRpYyBOb3JtYWxpemVUb1JlZihlLHQpe3JldHVybiB0LmNvcHlGcm9tKGUpLHQubm9ybWFsaXplKCksdH1zdGF0aWMgTWluaW1pemUoZSx0KXtjb25zdCBpPW5ldyBlLmNvbnN0cnVjdG9yO3JldHVybiBpLmNvcHlGcm9tKGUpLGkubWluaW1pemVJblBsYWNlKHQpLGl9c3RhdGljIE1heGltaXplKGUsdCl7Y29uc3QgaT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gaS5jb3B5RnJvbShlKSxpLm1heGltaXplSW5QbGFjZSh0KSxpfXN0YXRpYyBEaXN0YW5jZShlLHQpe3JldHVybiBNYXRoLnNxcnQoQ2UuRGlzdGFuY2VTcXVhcmVkKGUsdCkpfXN0YXRpYyBEaXN0YW5jZVNxdWFyZWQoZSx0KXtjb25zdCBpPWUueC10Lngscz1lLnktdC55LHI9ZS56LXQueixuPWUudy10Lnc7cmV0dXJuIGkqaStzKnMrcipyK24qbn1zdGF0aWMgQ2VudGVyKGUsdCl7cmV0dXJuIENlLkNlbnRlclRvUmVmKGUsdCxDZS5aZXJvKCkpfXN0YXRpYyBDZW50ZXJUb1JlZihlLHQsaSl7cmV0dXJuIGkuY29weUZyb21GbG9hdHMoKGUueCt0LngpLzIsKGUueSt0LnkpLzIsKGUueit0LnopLzIsKGUudyt0LncpLzIpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlcyhlLHQpe2NvbnN0IGk9Q2UuWmVybygpO3JldHVybiBDZS5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUsdCxpKXtyZXR1cm4gQ2UuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYoZS5feCxlLl95LGUuX3osdCxpKSxpfXN0YXRpYyBUcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihlLHQsaSxzLHIpe2NvbnN0IG49cy5tLGE9ZSpuWzBdK3Qqbls0XStpKm5bOF0rblsxMl0sbz1lKm5bMV0rdCpuWzVdK2kqbls5XStuWzEzXSxoPWUqblsyXSt0Km5bNl0raSpuWzEwXStuWzE0XSxsPWUqblszXSt0Km5bN10raSpuWzExXStuWzE1XTtyZXR1cm4gci54PWEsci55PW8sci56PWgsci53PWwscn1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsKGUsdCl7Y29uc3QgaT1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gQ2UuVHJhbnNmb3JtTm9ybWFsVG9SZWYoZSx0LGkpLGl9c3RhdGljIFRyYW5zZm9ybU5vcm1hbFRvUmVmKGUsdCxpKXtjb25zdCBzPXQubSxyPWUueCpzWzBdK2UueSpzWzRdK2UueipzWzhdLG49ZS54KnNbMV0rZS55KnNbNV0rZS56KnNbOV0sYT1lLngqc1syXStlLnkqc1s2XStlLnoqc1sxMF07cmV0dXJuIGkueD1yLGkueT1uLGkuej1hLGkudz1lLncsaX1zdGF0aWMgVHJhbnNmb3JtTm9ybWFsRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIubTtyZXR1cm4gbi54PWUqYVswXSt0KmFbNF0raSphWzhdLG4ueT1lKmFbMV0rdCphWzVdK2kqYVs5XSxuLno9ZSphWzJdK3QqYVs2XStpKmFbMTBdLG4udz1zLG59c3RhdGljIEZyb21WZWN0b3IzKGUsdD0wKXtyZXR1cm4gbmV3IENlKGUuX3gsZS5feSxlLl96LHQpfX1DZS5fWmVyb1JlYWRPbmx5PUNlLlplcm8oKTtjbGFzcyBae2NvbnN0cnVjdG9yKGU9MCx0PTAsaT0wLHM9MSl7dGhpcy5faXNEaXJ0eT0hMCx0aGlzLl94PWUsdGhpcy5feT10LHRoaXMuX3o9aSx0aGlzLl93PXN9Z2V0IHgoKXtyZXR1cm4gdGhpcy5feH1zZXQgeChlKXt0aGlzLl94PWUsdGhpcy5faXNEaXJ0eT0hMH1nZXQgeSgpe3JldHVybiB0aGlzLl95fXNldCB5KGUpe3RoaXMuX3k9ZSx0aGlzLl9pc0RpcnR5PSEwfWdldCB6KCl7cmV0dXJuIHRoaXMuX3p9c2V0IHooZSl7dGhpcy5fej1lLHRoaXMuX2lzRGlydHk9ITB9Z2V0IHcoKXtyZXR1cm4gdGhpcy5fd31zZXQgdyhlKXt0aGlzLl93PWUsdGhpcy5faXNEaXJ0eT0hMH10b1N0cmluZygpe3JldHVybmB7WDogJHt0aGlzLl94fSBZOiAke3RoaXMuX3l9IFo6ICR7dGhpcy5fen0gVzogJHt0aGlzLl93fX1gfWdldENsYXNzTmFtZSgpe3JldHVybiJRdWF0ZXJuaW9uIn1nZXRIYXNoQ29kZSgpe2NvbnN0IGU9c3QodGhpcy5feCksdD1zdCh0aGlzLl95KSxpPXN0KHRoaXMuX3opLHM9c3QodGhpcy5fdyk7bGV0IHI9ZTtyZXR1cm4gcj1yKjM5N150LHI9ciozOTdeaSxyPXIqMzk3XnMscn1hc0FycmF5KCl7cmV0dXJuW3RoaXMuX3gsdGhpcy5feSx0aGlzLl96LHRoaXMuX3ddfXRvQXJyYXkoZSx0PTApe3JldHVybiBlW3RdPXRoaXMueCxlW3QrMV09dGhpcy55LGVbdCsyXT10aGlzLnosZVt0KzNdPXRoaXMudyx0aGlzfWVxdWFscyhlKXtyZXR1cm4gZSYmdGhpcy5feD09PWUuX3gmJnRoaXMuX3k9PT1lLl95JiZ0aGlzLl96PT09ZS5feiYmdGhpcy5fdz09PWUuX3d9ZXF1YWxzV2l0aEVwc2lsb24oZSx0PXhlKXtyZXR1cm4gZSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3gsZS5feCx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3ksZS5feSx0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3osZS5feix0KSYmWC5XaXRoaW5FcHNpbG9uKHRoaXMuX3csZS5fdyx0KX1jbG9uZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94LHRoaXMuX3ksdGhpcy5feix0aGlzLl93KX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy54PWUuX3gsdGhpcy55PWUuX3ksdGhpcy56PWUuX3osdGhpcy53PWUuX3csdGhpc31jb3B5RnJvbUZsb2F0cyhlLHQsaSxzKXtyZXR1cm4gdGhpcy54PWUsdGhpcy55PXQsdGhpcy56PWksdGhpcy53PXMsdGhpc31zZXQoZSx0LGkscyl7cmV0dXJuIHRoaXMuY29weUZyb21GbG9hdHMoZSx0LGkscyl9YWRkKGUpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94K2UuX3gsdGhpcy5feStlLl95LHRoaXMuX3orZS5feix0aGlzLl93K2UuX3cpfWFkZEluUGxhY2UoZSl7cmV0dXJuIHRoaXMuX3grPWUuX3gsdGhpcy5feSs9ZS5feSx0aGlzLl96Kz1lLl96LHRoaXMuX3crPWUuX3csdGhpc31zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feC1lLl94LHRoaXMuX3ktZS5feSx0aGlzLl96LWUuX3osdGhpcy5fdy1lLl93KX1zdWJ0cmFjdEluUGxhY2UoZSl7cmV0dXJuIHRoaXMuX3gtPWUuX3gsdGhpcy5feS09ZS5feSx0aGlzLl96LT1lLl96LHRoaXMuX3ctPWUuX3csdGhpc31zY2FsZShlKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCplLHRoaXMuX3kqZSx0aGlzLl96KmUsdGhpcy5fdyplKX1zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQueD10aGlzLl94KmUsdC55PXRoaXMuX3kqZSx0Lno9dGhpcy5feiplLHQudz10aGlzLl93KmUsdH1zY2FsZUluUGxhY2UoZSl7cmV0dXJuIHRoaXMueCo9ZSx0aGlzLnkqPWUsdGhpcy56Kj1lLHRoaXMudyo9ZSx0aGlzfXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC54Kz10aGlzLl94KmUsdC55Kz10aGlzLl95KmUsdC56Kz10aGlzLl96KmUsdC53Kz10aGlzLl93KmUsdH1tdWx0aXBseShlKXtjb25zdCB0PW5ldyB0aGlzLmNvbnN0cnVjdG9yKDAsMCwwLDEpO3JldHVybiB0aGlzLm11bHRpcGx5VG9SZWYoZSx0KSx0fW11bHRpcGx5VG9SZWYoZSx0KXtjb25zdCBpPXRoaXMuX3gqZS5fdyt0aGlzLl95KmUuX3otdGhpcy5feiplLl95K3RoaXMuX3cqZS5feCxzPS10aGlzLl94KmUuX3ordGhpcy5feSplLl93K3RoaXMuX3oqZS5feCt0aGlzLl93KmUuX3kscj10aGlzLl94KmUuX3ktdGhpcy5feSplLl94K3RoaXMuX3oqZS5fdyt0aGlzLl93KmUuX3osbj0tdGhpcy5feCplLl94LXRoaXMuX3kqZS5feS10aGlzLl96KmUuX3ordGhpcy5fdyplLl93O3JldHVybiB0LmNvcHlGcm9tRmxvYXRzKGkscyxyLG4pLHR9bXVsdGlwbHlJblBsYWNlKGUpe3JldHVybiB0aGlzLm11bHRpcGx5VG9SZWYoZSx0aGlzKSx0aGlzfWNvbmp1Z2F0ZVRvUmVmKGUpe3JldHVybiBlLmNvcHlGcm9tRmxvYXRzKC10aGlzLl94LC10aGlzLl95LC10aGlzLl96LHRoaXMuX3cpLGV9Y29uanVnYXRlSW5QbGFjZSgpe3JldHVybiB0aGlzLngqPS0xLHRoaXMueSo9LTEsdGhpcy56Kj0tMSx0aGlzfWNvbmp1Z2F0ZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigtdGhpcy5feCwtdGhpcy5feSwtdGhpcy5feix0aGlzLl93KX1pbnZlcnQoKXtjb25zdCBlPXRoaXMuY29uanVnYXRlKCksdD10aGlzLmxlbmd0aFNxdWFyZWQoKTtyZXR1cm4gdD09MHx8dD09MXx8ZS5zY2FsZUluUGxhY2UoMS90KSxlfWludmVydEluUGxhY2UoKXt0aGlzLmNvbmp1Z2F0ZUluUGxhY2UoKTtjb25zdCBlPXRoaXMubGVuZ3RoU3F1YXJlZCgpO3JldHVybiBlPT0wfHxlPT0xP3RoaXM6KHRoaXMuc2NhbGVJblBsYWNlKDEvZSksdGhpcyl9bGVuZ3RoU3F1YXJlZCgpe3JldHVybiB0aGlzLl94KnRoaXMuX3grdGhpcy5feSp0aGlzLl95K3RoaXMuX3oqdGhpcy5feit0aGlzLl93KnRoaXMuX3d9bGVuZ3RoKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLmxlbmd0aFNxdWFyZWQoKSl9bm9ybWFsaXplKCl7Y29uc3QgZT10aGlzLmxlbmd0aCgpO2lmKGU9PT0wKXJldHVybiB0aGlzO2NvbnN0IHQ9MS9lO3JldHVybiB0aGlzLnNjYWxlSW5QbGFjZSh0KSx0aGlzfW5vcm1hbGl6ZVRvTmV3KCl7Y29uc3QgZT10aGlzLmxlbmd0aCgpO2lmKGU9PT0wKXJldHVybiB0aGlzLmNsb25lKCk7Y29uc3QgdD0xL2U7cmV0dXJuIHRoaXMuc2NhbGUodCl9dG9FdWxlckFuZ2xlcygpe2NvbnN0IGU9cC5aZXJvKCk7cmV0dXJuIHRoaXMudG9FdWxlckFuZ2xlc1RvUmVmKGUpLGV9dG9FdWxlckFuZ2xlc1RvUmVmKGUpe2NvbnN0IHQ9dGhpcy5feixpPXRoaXMuX3gscz10aGlzLl95LHI9dGhpcy5fdyxuPXMqdC1pKnIsYT0uNDk5OTk5OTtpZihuPC1hKWUueT0yKk1hdGguYXRhbjIocyxyKSxlLng9TWF0aC5QSS8yLGUuej0wO2Vsc2UgaWYobj5hKWUueT0yKk1hdGguYXRhbjIocyxyKSxlLng9LU1hdGguUEkvMixlLno9MDtlbHNle2NvbnN0IG89cipyLGg9dCp0LGw9aSppLHU9cypzO2Uuej1NYXRoLmF0YW4yKDIqKGkqcyt0KnIpLC1oLWwrdStvKSxlLng9TWF0aC5hc2luKC0yKm4pLGUueT1NYXRoLmF0YW4yKDIqKHQqaStzKnIpLGgtbC11K28pfXJldHVybiBlfXRvUm90YXRpb25NYXRyaXgoZSl7cmV0dXJuIHguRnJvbVF1YXRlcm5pb25Ub1JlZih0aGlzLGUpLGV9ZnJvbVJvdGF0aW9uTWF0cml4KGUpe3JldHVybiBaLkZyb21Sb3RhdGlvbk1hdHJpeFRvUmVmKGUsdGhpcyksdGhpc31zdGF0aWMgRnJvbVJvdGF0aW9uTWF0cml4KGUpe2NvbnN0IHQ9bmV3IFo7cmV0dXJuIFouRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYoZSx0KSx0fXN0YXRpYyBGcm9tUm90YXRpb25NYXRyaXhUb1JlZihlLHQpe2NvbnN0IGk9ZS5tLHM9aVswXSxyPWlbNF0sbj1pWzhdLGE9aVsxXSxvPWlbNV0saD1pWzldLGw9aVsyXSx1PWlbNl0sZD1pWzEwXSxmPXMrbytkO2xldCBfO3JldHVybiBmPjA/KF89LjUvTWF0aC5zcXJ0KGYrMSksdC53PS4yNS9fLHQueD0odS1oKSpfLHQueT0obi1sKSpfLHQuej0oYS1yKSpfKTpzPm8mJnM+ZD8oXz0yKk1hdGguc3FydCgxK3Mtby1kKSx0Lnc9KHUtaCkvXyx0Lng9LjI1Kl8sdC55PShyK2EpL18sdC56PShuK2wpL18pOm8+ZD8oXz0yKk1hdGguc3FydCgxK28tcy1kKSx0Lnc9KG4tbCkvXyx0Lng9KHIrYSkvXyx0Lnk9LjI1Kl8sdC56PShoK3UpL18pOihfPTIqTWF0aC5zcXJ0KDErZC1zLW8pLHQudz0oYS1yKS9fLHQueD0obitsKS9fLHQueT0oaCt1KS9fLHQuej0uMjUqXyksdH1zdGF0aWMgRG90KGUsdCl7cmV0dXJuIGUuX3gqdC5feCtlLl95KnQuX3krZS5feip0Ll96K2UuX3cqdC5fd31zdGF0aWMgQXJlQ2xvc2UoZSx0LGk9LjEpe2NvbnN0IHM9Wi5Eb3QoZSx0KTtyZXR1cm4gMS1zKnM8PWl9c3RhdGljIFNtb290aFRvUmVmKGUsdCxpLHMscil7bGV0IG49cz09PTA/MTppL3M7cmV0dXJuIG49WC5DbGFtcChuLDAsMSksWi5TbGVycFRvUmVmKGUsdCxuLHIpLHJ9c3RhdGljIFplcm8oKXtyZXR1cm4gbmV3IFooMCwwLDAsMCl9c3RhdGljIEludmVyc2UoZSl7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKC1lLl94LC1lLl95LC1lLl96LGUuX3cpfXN0YXRpYyBJbnZlcnNlVG9SZWYoZSx0KXtyZXR1cm4gdC5zZXQoLWUuX3gsLWUuX3ksLWUuX3osZS5fdyksdH1zdGF0aWMgSWRlbnRpdHkoKXtyZXR1cm4gbmV3IFooMCwwLDAsMSl9c3RhdGljIElzSWRlbnRpdHkoZSl7cmV0dXJuIGUmJmUuX3g9PT0wJiZlLl95PT09MCYmZS5fej09PTAmJmUuX3c9PT0xfXN0YXRpYyBSb3RhdGlvbkF4aXMoZSx0KXtyZXR1cm4gWi5Sb3RhdGlvbkF4aXNUb1JlZihlLHQsbmV3IFopfXN0YXRpYyBSb3RhdGlvbkF4aXNUb1JlZihlLHQsaSl7Y29uc3Qgcz1NYXRoLnNpbih0LzIpO3JldHVybiBlLm5vcm1hbGl6ZSgpLGkudz1NYXRoLmNvcyh0LzIpLGkueD1lLl94KnMsaS55PWUuX3kqcyxpLno9ZS5feipzLGl9c3RhdGljIEZyb21BcnJheShlLHQpe3JldHVybiB0fHwodD0wKSxuZXcgWihlW3RdLGVbdCsxXSxlW3QrMl0sZVt0KzNdKX1zdGF0aWMgRnJvbUFycmF5VG9SZWYoZSx0LGkpe3JldHVybiBpLng9ZVt0XSxpLnk9ZVt0KzFdLGkuej1lW3QrMl0saS53PWVbdCszXSxpfXN0YXRpYyBGcm9tRXVsZXJBbmdsZXMoZSx0LGkpe2NvbnN0IHM9bmV3IFo7cmV0dXJuIFouUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0LGUsaSxzKSxzfXN0YXRpYyBGcm9tRXVsZXJBbmdsZXNUb1JlZihlLHQsaSxzKXtyZXR1cm4gWi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHQsZSxpLHMpLHN9c3RhdGljIEZyb21FdWxlclZlY3RvcihlKXtjb25zdCB0PW5ldyBaO3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZS5feSxlLl94LGUuX3osdCksdH1zdGF0aWMgRnJvbUV1bGVyVmVjdG9yVG9SZWYoZSx0KXtyZXR1cm4gWi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKGUuX3ksZS5feCxlLl96LHQpLHR9c3RhdGljIEZyb21Vbml0VmVjdG9yc1RvUmVmKGUsdCxpKXtjb25zdCBzPXAuRG90KGUsdCkrMTtyZXR1cm4gczx4ZT9NYXRoLmFicyhlLngpPk1hdGguYWJzKGUueik/aS5zZXQoLWUueSxlLngsMCwwKTppLnNldCgwLC1lLnosZS55LDApOihwLkNyb3NzVG9SZWYoZSx0LEQuVmVjdG9yM1swXSksaS5zZXQoRC5WZWN0b3IzWzBdLngsRC5WZWN0b3IzWzBdLnksRC5WZWN0b3IzWzBdLnoscykpLGkubm9ybWFsaXplKCl9c3RhdGljIFJvdGF0aW9uWWF3UGl0Y2hSb2xsKGUsdCxpKXtjb25zdCBzPW5ldyBaO3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZSx0LGkscyksc31zdGF0aWMgUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihlLHQsaSxzKXtjb25zdCByPWkqLjUsbj10Ki41LGE9ZSouNSxvPU1hdGguc2luKHIpLGg9TWF0aC5jb3MociksbD1NYXRoLnNpbihuKSx1PU1hdGguY29zKG4pLGQ9TWF0aC5zaW4oYSksZj1NYXRoLmNvcyhhKTtyZXR1cm4gcy54PWYqbCpoK2QqdSpvLHMueT1kKnUqaC1mKmwqbyxzLno9Zip1Km8tZCpsKmgscy53PWYqdSpoK2QqbCpvLHN9c3RhdGljIFJvdGF0aW9uQWxwaGFCZXRhR2FtbWEoZSx0LGkpe2NvbnN0IHM9bmV3IFo7cmV0dXJuIFouUm90YXRpb25BbHBoYUJldGFHYW1tYVRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIFJvdGF0aW9uQWxwaGFCZXRhR2FtbWFUb1JlZihlLHQsaSxzKXtjb25zdCByPShpK2UpKi41LG49KGktZSkqLjUsYT10Ki41O3JldHVybiBzLng9TWF0aC5jb3MobikqTWF0aC5zaW4oYSkscy55PU1hdGguc2luKG4pKk1hdGguc2luKGEpLHMuej1NYXRoLnNpbihyKSpNYXRoLmNvcyhhKSxzLnc9TWF0aC5jb3MocikqTWF0aC5jb3MoYSksc31zdGF0aWMgUm90YXRpb25RdWF0ZXJuaW9uRnJvbUF4aXMoZSx0LGkpe2NvbnN0IHM9bmV3IFooMCwwLDAsMCk7cmV0dXJuIFouUm90YXRpb25RdWF0ZXJuaW9uRnJvbUF4aXNUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBSb3RhdGlvblF1YXRlcm5pb25Gcm9tQXhpc1RvUmVmKGUsdCxpLHMpe2NvbnN0IHI9Sy5NYXRyaXhbMF07cmV0dXJuIHguRnJvbVhZWkF4ZXNUb1JlZihlLm5vcm1hbGl6ZSgpLHQubm9ybWFsaXplKCksaS5ub3JtYWxpemUoKSxyKSxaLkZyb21Sb3RhdGlvbk1hdHJpeFRvUmVmKHIscyksc31zdGF0aWMgRnJvbUxvb2tEaXJlY3Rpb25MSChlLHQpe2NvbnN0IGk9bmV3IFo7cmV0dXJuIFouRnJvbUxvb2tEaXJlY3Rpb25MSFRvUmVmKGUsdCxpKSxpfXN0YXRpYyBGcm9tTG9va0RpcmVjdGlvbkxIVG9SZWYoZSx0LGkpe2NvbnN0IHM9Sy5NYXRyaXhbMF07cmV0dXJuIHguTG9va0RpcmVjdGlvbkxIVG9SZWYoZSx0LHMpLFouRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYocyxpKSxpfXN0YXRpYyBGcm9tTG9va0RpcmVjdGlvblJIKGUsdCl7Y29uc3QgaT1uZXcgWjtyZXR1cm4gWi5Gcm9tTG9va0RpcmVjdGlvblJIVG9SZWYoZSx0LGkpLGl9c3RhdGljIEZyb21Mb29rRGlyZWN0aW9uUkhUb1JlZihlLHQsaSl7Y29uc3Qgcz1LLk1hdHJpeFswXTtyZXR1cm4geC5Mb29rRGlyZWN0aW9uUkhUb1JlZihlLHQscyksWi5Gcm9tUm90YXRpb25NYXRyaXhUb1JlZihzLGkpfXN0YXRpYyBTbGVycChlLHQsaSl7Y29uc3Qgcz1aLklkZW50aXR5KCk7cmV0dXJuIFouU2xlcnBUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBTbGVycFRvUmVmKGUsdCxpLHMpe2xldCByLG4sYT1lLl94KnQuX3grZS5feSp0Ll95K2UuX3oqdC5feitlLl93KnQuX3csbz0hMTtpZihhPDAmJihvPSEwLGE9LWEpLGE+Ljk5OTk5OSluPTEtaSxyPW8/LWk6aTtlbHNle2NvbnN0IGg9TWF0aC5hY29zKGEpLGw9MS9NYXRoLnNpbihoKTtuPU1hdGguc2luKCgxLWkpKmgpKmwscj1vPy1NYXRoLnNpbihpKmgpKmw6TWF0aC5zaW4oaSpoKSpsfXJldHVybiBzLng9biplLl94K3IqdC5feCxzLnk9biplLl95K3IqdC5feSxzLno9biplLl96K3IqdC5feixzLnc9biplLl93K3IqdC5fdyxzfXN0YXRpYyBIZXJtaXRlKGUsdCxpLHMscil7Y29uc3Qgbj1yKnIsYT1yKm4sbz0yKmEtMypuKzEsaD0tMiphKzMqbixsPWEtMipuK3IsdT1hLW4sZD1lLl94Km8raS5feCpoK3QuX3gqbCtzLl94KnUsZj1lLl95Km8raS5feSpoK3QuX3kqbCtzLl95KnUsXz1lLl96Km8raS5feipoK3QuX3oqbCtzLl96KnUsRT1lLl93Km8raS5fdypoK3QuX3cqbCtzLl93KnU7cmV0dXJuIG5ldyBlLmNvbnN0cnVjdG9yKGQsZixfLEUpfXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZShlLHQsaSxzLHIpe2NvbnN0IG49bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMuSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbiksbn1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbil7Y29uc3QgYT1yKnI7cmV0dXJuIG4ueD0oYS1yKSo2KmUueCsoMyphLTQqcisxKSp0LngrKC1hK3IpKjYqaS54KygzKmEtMipyKSpzLngsbi55PShhLXIpKjYqZS55KygzKmEtNCpyKzEpKnQueSsoLWErcikqNippLnkrKDMqYS0yKnIpKnMueSxuLno9KGEtcikqNiplLnorKDMqYS00KnIrMSkqdC56KygtYStyKSo2KmkueisoMyphLTIqcikqcy56LG4udz0oYS1yKSo2KmUudysoMyphLTQqcisxKSp0LncrKC1hK3IpKjYqaS53KygzKmEtMipyKSpzLncsbn19Y2xhc3MgeHtjb25zdHJ1Y3Rvcigpe3RoaXMuX2lzSWRlbnRpdHk9ITEsdGhpcy5faXNJZGVudGl0eURpcnR5PSEwLHRoaXMuX2lzSWRlbnRpdHkzeDI9ITAsdGhpcy5faXNJZGVudGl0eTN4MkRpcnR5PSEwLHRoaXMudXBkYXRlRmxhZz0tMSxVZS5NYXRyaXhUcmFja1ByZWNpc2lvbkNoYW5nZSYmVWUuTWF0cml4VHJhY2tlZE1hdHJpY2VzLnB1c2godGhpcyksdGhpcy5fbT1uZXcgVWUuTWF0cml4Q3VycmVudFR5cGUoMTYpLHRoaXMubWFya0FzVXBkYXRlZCgpfXN0YXRpYyBnZXQgVXNlNjRCaXRzKCl7cmV0dXJuIFVlLk1hdHJpeFVzZTY0Qml0c31nZXQgbSgpe3JldHVybiB0aGlzLl9tfW1hcmtBc1VwZGF0ZWQoKXt0aGlzLnVwZGF0ZUZsYWc9eC5fVXBkYXRlRmxhZ1NlZWQrKyx0aGlzLl9pc0lkZW50aXR5PSExLHRoaXMuX2lzSWRlbnRpdHkzeDI9ITEsdGhpcy5faXNJZGVudGl0eURpcnR5PSEwLHRoaXMuX2lzSWRlbnRpdHkzeDJEaXJ0eT0hMH1fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZSx0PSExLGk9ITEscz0hMCl7dGhpcy5faXNJZGVudGl0eT1lLHRoaXMuX2lzSWRlbnRpdHkzeDI9ZXx8aSx0aGlzLl9pc0lkZW50aXR5RGlydHk9dGhpcy5faXNJZGVudGl0eT8hMTp0LHRoaXMuX2lzSWRlbnRpdHkzeDJEaXJ0eT10aGlzLl9pc0lkZW50aXR5M3gyPyExOnN9aXNJZGVudGl0eSgpe2lmKHRoaXMuX2lzSWRlbnRpdHlEaXJ0eSl7dGhpcy5faXNJZGVudGl0eURpcnR5PSExO2NvbnN0IGU9dGhpcy5fbTt0aGlzLl9pc0lkZW50aXR5PWVbMF09PT0xJiZlWzFdPT09MCYmZVsyXT09PTAmJmVbM109PT0wJiZlWzRdPT09MCYmZVs1XT09PTEmJmVbNl09PT0wJiZlWzddPT09MCYmZVs4XT09PTAmJmVbOV09PT0wJiZlWzEwXT09PTEmJmVbMTFdPT09MCYmZVsxMl09PT0wJiZlWzEzXT09PTAmJmVbMTRdPT09MCYmZVsxNV09PT0xfXJldHVybiB0aGlzLl9pc0lkZW50aXR5fWlzSWRlbnRpdHlBczN4Migpe3JldHVybiB0aGlzLl9pc0lkZW50aXR5M3gyRGlydHkmJih0aGlzLl9pc0lkZW50aXR5M3gyRGlydHk9ITEsdGhpcy5fbVswXSE9PTF8fHRoaXMuX21bNV0hPT0xfHx0aGlzLl9tWzE1XSE9PTE/dGhpcy5faXNJZGVudGl0eTN4Mj0hMTp0aGlzLl9tWzFdIT09MHx8dGhpcy5fbVsyXSE9PTB8fHRoaXMuX21bM10hPT0wfHx0aGlzLl9tWzRdIT09MHx8dGhpcy5fbVs2XSE9PTB8fHRoaXMuX21bN10hPT0wfHx0aGlzLl9tWzhdIT09MHx8dGhpcy5fbVs5XSE9PTB8fHRoaXMuX21bMTBdIT09MHx8dGhpcy5fbVsxMV0hPT0wfHx0aGlzLl9tWzEyXSE9PTB8fHRoaXMuX21bMTNdIT09MHx8dGhpcy5fbVsxNF0hPT0wP3RoaXMuX2lzSWRlbnRpdHkzeDI9ITE6dGhpcy5faXNJZGVudGl0eTN4Mj0hMCksdGhpcy5faXNJZGVudGl0eTN4Mn1kZXRlcm1pbmFudCgpe2lmKHRoaXMuX2lzSWRlbnRpdHk9PT0hMClyZXR1cm4gMTtjb25zdCBlPXRoaXMuX20sdD1lWzBdLGk9ZVsxXSxzPWVbMl0scj1lWzNdLG49ZVs0XSxhPWVbNV0sbz1lWzZdLGg9ZVs3XSxsPWVbOF0sdT1lWzldLGQ9ZVsxMF0sZj1lWzExXSxfPWVbMTJdLEU9ZVsxM10sbT1lWzE0XSx2PWVbMTVdLFM9ZCp2LW0qZix5PXUqdi1FKmYsQT11Km0tRSpkLEM9bCp2LV8qZixiPWwqbS1kKl8sTT1sKkUtXyp1LEw9KyhhKlMtbyp5K2gqQSksaz0tKG4qUy1vKkMraCpiKSx3PSsobip5LWEqQytoKk0pLGRlPS0obipBLWEqYitvKk0pO3JldHVybiB0KkwraSprK3MqdytyKmRlfXRvQXJyYXkoKXtyZXR1cm4gdGhpcy5fbX1hc0FycmF5KCl7cmV0dXJuIHRoaXMuX219aW52ZXJ0KCl7cmV0dXJuIHRoaXMuaW52ZXJ0VG9SZWYodGhpcyksdGhpc31yZXNldCgpe3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZigwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHRoaXMpLHRoaXMuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKCExKSx0aGlzfWFkZChlKXtjb25zdCB0PW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiB0aGlzLmFkZFRvUmVmKGUsdCksdH1hZGRUb1JlZihlLHQpe2NvbnN0IGk9dGhpcy5fbSxzPXQuX20scj1lLm07Zm9yKGxldCBuPTA7bjwxNjtuKyspc1tuXT1pW25dK3Jbbl07cmV0dXJuIHQubWFya0FzVXBkYXRlZCgpLHR9YWRkVG9TZWxmKGUpe2NvbnN0IHQ9dGhpcy5fbSxpPWUubTtmb3IobGV0IHM9MDtzPDE2O3MrKyl0W3NdKz1pW3NdO3JldHVybiB0aGlzLm1hcmtBc1VwZGF0ZWQoKSx0aGlzfWludmVydFRvUmVmKGUpe2lmKHRoaXMuX2lzSWRlbnRpdHk9PT0hMClyZXR1cm4geC5JZGVudGl0eVRvUmVmKGUpLGU7Y29uc3QgdD10aGlzLl9tLGk9dFswXSxzPXRbMV0scj10WzJdLG49dFszXSxhPXRbNF0sbz10WzVdLGg9dFs2XSxsPXRbN10sdT10WzhdLGQ9dFs5XSxmPXRbMTBdLF89dFsxMV0sRT10WzEyXSxtPXRbMTNdLHY9dFsxNF0sUz10WzE1XSx5PWYqUy12Kl8sQT1kKlMtbSpfLEM9ZCp2LW0qZixiPXUqUy1FKl8sTT11KnYtZipFLEw9dSptLUUqZCxrPSsobyp5LWgqQStsKkMpLHc9LShhKnktaCpiK2wqTSksZGU9KyhhKkEtbypiK2wqTCksY2U9LShhKkMtbypNK2gqTCksc2U9aSprK3MqdytyKmRlK24qY2U7aWYoc2U9PT0wKXJldHVybiBlLmNvcHlGcm9tKHRoaXMpLGU7Y29uc3QgdGU9MS9zZSxGZT1oKlMtdipsLHdlPW8qUy1tKmwsSGU9byp2LW0qaCxLZT1hKlMtRSpsLFllPWEqdi1FKmgscHQ9YSptLUUqbyxodD1oKl8tZipsLHd0PW8qXy1kKmwsc2k9bypmLWQqaCxkcz1hKl8tdSpsLGZzPWEqZi11KmgsX3M9YSpkLXUqbyxYcz0tKHMqeS1yKkErbipDKSxIcz0rKGkqeS1yKmIrbipNKSxLcz0tKGkqQS1zKmIrbipMKSxZcz0rKGkqQy1zKk0rcipMKSxacz0rKHMqRmUtcip3ZStuKkhlKSxxcz0tKGkqRmUtcipLZStuKlllKSxIdD0rKGkqd2UtcypLZStuKnB0KSxLdD0tKGkqSGUtcypZZStyKnB0KSxZdD0tKHMqaHQtcip3dCtuKnNpKSxadD0rKGkqaHQtcipkcytuKmZzKSx3bD0tKGkqd3QtcypkcytuKl9zKSxPbD0rKGkqc2ktcypmcytyKl9zKTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoayp0ZSxYcyp0ZSxacyp0ZSxZdCp0ZSx3KnRlLEhzKnRlLHFzKnRlLFp0KnRlLGRlKnRlLEtzKnRlLEh0KnRlLHdsKnRlLGNlKnRlLFlzKnRlLEt0KnRlLE9sKnRlLGUpLGV9YWRkQXRJbmRleChlLHQpe3JldHVybiB0aGlzLl9tW2VdKz10LHRoaXMubWFya0FzVXBkYXRlZCgpLHRoaXN9bXVsdGlwbHlBdEluZGV4KGUsdCl7cmV0dXJuIHRoaXMuX21bZV0qPXQsdGhpcy5tYXJrQXNVcGRhdGVkKCksdGhpc31zZXRUcmFuc2xhdGlvbkZyb21GbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLl9tWzEyXT1lLHRoaXMuX21bMTNdPXQsdGhpcy5fbVsxNF09aSx0aGlzLm1hcmtBc1VwZGF0ZWQoKSx0aGlzfWFkZFRyYW5zbGF0aW9uRnJvbUZsb2F0cyhlLHQsaSl7cmV0dXJuIHRoaXMuX21bMTJdKz1lLHRoaXMuX21bMTNdKz10LHRoaXMuX21bMTRdKz1pLHRoaXMubWFya0FzVXBkYXRlZCgpLHRoaXN9c2V0VHJhbnNsYXRpb24oZSl7cmV0dXJuIHRoaXMuc2V0VHJhbnNsYXRpb25Gcm9tRmxvYXRzKGUuX3gsZS5feSxlLl96KX1nZXRUcmFuc2xhdGlvbigpe3JldHVybiBuZXcgcCh0aGlzLl9tWzEyXSx0aGlzLl9tWzEzXSx0aGlzLl9tWzE0XSl9Z2V0VHJhbnNsYXRpb25Ub1JlZihlKXtyZXR1cm4gZS54PXRoaXMuX21bMTJdLGUueT10aGlzLl9tWzEzXSxlLno9dGhpcy5fbVsxNF0sZX1yZW1vdmVSb3RhdGlvbkFuZFNjYWxpbmcoKXtjb25zdCBlPXRoaXMubTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsZVsxMl0sZVsxM10sZVsxNF0sZVsxNV0sdGhpcyksdGhpcy5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZVsxMl09PT0wJiZlWzEzXT09PTAmJmVbMTRdPT09MCYmZVsxNV09PT0xKSx0aGlzfW11bHRpcGx5KGUpe2NvbnN0IHQ9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMubXVsdGlwbHlUb1JlZihlLHQpLHR9Y29weUZyb20oZSl7ZS5jb3B5VG9BcnJheSh0aGlzLl9tKTtjb25zdCB0PWU7cmV0dXJuIHRoaXMudXBkYXRlRmxhZz10LnVwZGF0ZUZsYWcsdGhpcy5fdXBkYXRlSWRlbnRpdHlTdGF0dXModC5faXNJZGVudGl0eSx0Ll9pc0lkZW50aXR5RGlydHksdC5faXNJZGVudGl0eTN4Mix0Ll9pc0lkZW50aXR5M3gyRGlydHkpLHRoaXN9Y29weVRvQXJyYXkoZSx0PTApe2NvbnN0IGk9dGhpcy5fbTtyZXR1cm4gZVt0XT1pWzBdLGVbdCsxXT1pWzFdLGVbdCsyXT1pWzJdLGVbdCszXT1pWzNdLGVbdCs0XT1pWzRdLGVbdCs1XT1pWzVdLGVbdCs2XT1pWzZdLGVbdCs3XT1pWzddLGVbdCs4XT1pWzhdLGVbdCs5XT1pWzldLGVbdCsxMF09aVsxMF0sZVt0KzExXT1pWzExXSxlW3QrMTJdPWlbMTJdLGVbdCsxM109aVsxM10sZVt0KzE0XT1pWzE0XSxlW3QrMTVdPWlbMTVdLHRoaXN9bXVsdGlwbHlUb1JlZihlLHQpe3JldHVybiB0aGlzLl9pc0lkZW50aXR5Pyh0LmNvcHlGcm9tKGUpLHQpOmUuX2lzSWRlbnRpdHk/KHQuY29weUZyb20odGhpcyksdCk6KHRoaXMubXVsdGlwbHlUb0FycmF5KGUsdC5fbSwwKSx0Lm1hcmtBc1VwZGF0ZWQoKSx0KX1tdWx0aXBseVRvQXJyYXkoZSx0LGkpe2NvbnN0IHM9dGhpcy5fbSxyPWUubSxuPXNbMF0sYT1zWzFdLG89c1syXSxoPXNbM10sbD1zWzRdLHU9c1s1XSxkPXNbNl0sZj1zWzddLF89c1s4XSxFPXNbOV0sbT1zWzEwXSx2PXNbMTFdLFM9c1sxMl0seT1zWzEzXSxBPXNbMTRdLEM9c1sxNV0sYj1yWzBdLE09clsxXSxMPXJbMl0saz1yWzNdLHc9cls0XSxkZT1yWzVdLGNlPXJbNl0sc2U9cls3XSx0ZT1yWzhdLEZlPXJbOV0sd2U9clsxMF0sSGU9clsxMV0sS2U9clsxMl0sWWU9clsxM10scHQ9clsxNF0saHQ9clsxNV07cmV0dXJuIHRbaV09bipiK2EqdytvKnRlK2gqS2UsdFtpKzFdPW4qTSthKmRlK28qRmUraCpZZSx0W2krMl09bipMK2EqY2Urbyp3ZStoKnB0LHRbaSszXT1uKmsrYSpzZStvKkhlK2gqaHQsdFtpKzRdPWwqYit1KncrZCp0ZStmKktlLHRbaSs1XT1sKk0rdSpkZStkKkZlK2YqWWUsdFtpKzZdPWwqTCt1KmNlK2Qqd2UrZipwdCx0W2krN109bCprK3Uqc2UrZCpIZStmKmh0LHRbaSs4XT1fKmIrRSp3K20qdGUrdipLZSx0W2krOV09XypNK0UqZGUrbSpGZSt2KlllLHRbaSsxMF09XypMK0UqY2UrbSp3ZSt2KnB0LHRbaSsxMV09XyprK0Uqc2UrbSpIZSt2Kmh0LHRbaSsxMl09UypiK3kqdytBKnRlK0MqS2UsdFtpKzEzXT1TKk0reSpkZStBKkZlK0MqWWUsdFtpKzE0XT1TKkwreSpjZStBKndlK0MqcHQsdFtpKzE1XT1TKmsreSpzZStBKkhlK0MqaHQsdGhpc31lcXVhbHMoZSl7Y29uc3QgdD1lO2lmKCF0KXJldHVybiExO2lmKCh0aGlzLl9pc0lkZW50aXR5fHx0Ll9pc0lkZW50aXR5KSYmIXRoaXMuX2lzSWRlbnRpdHlEaXJ0eSYmIXQuX2lzSWRlbnRpdHlEaXJ0eSlyZXR1cm4gdGhpcy5faXNJZGVudGl0eSYmdC5faXNJZGVudGl0eTtjb25zdCBpPXRoaXMubSxzPXQubTtyZXR1cm4gaVswXT09PXNbMF0mJmlbMV09PT1zWzFdJiZpWzJdPT09c1syXSYmaVszXT09PXNbM10mJmlbNF09PT1zWzRdJiZpWzVdPT09c1s1XSYmaVs2XT09PXNbNl0mJmlbN109PT1zWzddJiZpWzhdPT09c1s4XSYmaVs5XT09PXNbOV0mJmlbMTBdPT09c1sxMF0mJmlbMTFdPT09c1sxMV0mJmlbMTJdPT09c1sxMl0mJmlbMTNdPT09c1sxM10mJmlbMTRdPT09c1sxNF0mJmlbMTVdPT09c1sxNV19Y2xvbmUoKXtjb25zdCBlPW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiBlLmNvcHlGcm9tKHRoaXMpLGV9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIk1hdHJpeCJ9Z2V0SGFzaENvZGUoKXtsZXQgZT1zdCh0aGlzLl9tWzBdKTtmb3IobGV0IHQ9MTt0PDE2O3QrKyllPWUqMzk3XnN0KHRoaXMuX21bdF0pO3JldHVybiBlfWRlY29tcG9zZVRvVHJhbnNmb3JtTm9kZShlKXtyZXR1cm4gZS5yb3RhdGlvblF1YXRlcm5pb249ZS5yb3RhdGlvblF1YXRlcm5pb258fG5ldyBaLHRoaXMuZGVjb21wb3NlKGUuc2NhbGluZyxlLnJvdGF0aW9uUXVhdGVybmlvbixlLnBvc2l0aW9uKX1kZWNvbXBvc2UoZSx0LGkscyl7aWYodGhpcy5faXNJZGVudGl0eSlyZXR1cm4gaSYmaS5zZXRBbGwoMCksZSYmZS5zZXRBbGwoMSksdCYmdC5jb3B5RnJvbUZsb2F0cygwLDAsMCwxKSwhMDtjb25zdCByPXRoaXMuX207aWYoaSYmaS5jb3B5RnJvbUZsb2F0cyhyWzEyXSxyWzEzXSxyWzE0XSksZT1lfHxLLlZlY3RvcjNbMF0sZS54PU1hdGguc3FydChyWzBdKnJbMF0rclsxXSpyWzFdK3JbMl0qclsyXSksZS55PU1hdGguc3FydChyWzRdKnJbNF0rcls1XSpyWzVdK3JbNl0qcls2XSksZS56PU1hdGguc3FydChyWzhdKnJbOF0rcls5XSpyWzldK3JbMTBdKnJbMTBdKSxzKXtjb25zdCBuPXMuc2NhbGluZy54PDA/LTE6MSxhPXMuc2NhbGluZy55PDA/LTE6MSxvPXMuc2NhbGluZy56PDA/LTE6MTtlLngqPW4sZS55Kj1hLGUueio9b31lbHNlIHRoaXMuZGV0ZXJtaW5hbnQoKTw9MCYmKGUueSo9LTEpO2lmKGUuX3g9PT0wfHxlLl95PT09MHx8ZS5fej09PTApcmV0dXJuIHQmJnQuY29weUZyb21GbG9hdHMoMCwwLDAsMSksITE7aWYodCl7Y29uc3Qgbj0xL2UuX3gsYT0xL2UuX3ksbz0xL2UuX3o7eC5Gcm9tVmFsdWVzVG9SZWYoclswXSpuLHJbMV0qbixyWzJdKm4sMCxyWzRdKmEscls1XSphLHJbNl0qYSwwLHJbOF0qbyxyWzldKm8sclsxMF0qbywwLDAsMCwwLDEsSy5NYXRyaXhbMF0pLFouRnJvbVJvdGF0aW9uTWF0cml4VG9SZWYoSy5NYXRyaXhbMF0sdCl9cmV0dXJuITB9Z2V0Um93KGUpe2lmKGU8MHx8ZT4zKXJldHVybiBudWxsO2NvbnN0IHQ9ZSo0O3JldHVybiBuZXcgQ2UodGhpcy5fbVt0KzBdLHRoaXMuX21bdCsxXSx0aGlzLl9tW3QrMl0sdGhpcy5fbVt0KzNdKX1nZXRSb3dUb1JlZihlLHQpe2lmKGU+PTAmJmU8Myl7Y29uc3QgaT1lKjQ7dC54PXRoaXMuX21baSswXSx0Lnk9dGhpcy5fbVtpKzFdLHQuej10aGlzLl9tW2krMl0sdC53PXRoaXMuX21baSszXX1yZXR1cm4gdH1zZXRSb3coZSx0KXtyZXR1cm4gdGhpcy5zZXRSb3dGcm9tRmxvYXRzKGUsdC54LHQueSx0LnosdC53KX10cmFuc3Bvc2UoKXtjb25zdCBlPW5ldyB0aGlzLmNvbnN0cnVjdG9yO3JldHVybiB4LlRyYW5zcG9zZVRvUmVmKHRoaXMsZSksZX10cmFuc3Bvc2VUb1JlZihlKXtyZXR1cm4geC5UcmFuc3Bvc2VUb1JlZih0aGlzLGUpLGV9c2V0Um93RnJvbUZsb2F0cyhlLHQsaSxzLHIpe2lmKGU8MHx8ZT4zKXJldHVybiB0aGlzO2NvbnN0IG49ZSo0O3JldHVybiB0aGlzLl9tW24rMF09dCx0aGlzLl9tW24rMV09aSx0aGlzLl9tW24rMl09cyx0aGlzLl9tW24rM109cix0aGlzLm1hcmtBc1VwZGF0ZWQoKSx0aGlzfXNjYWxlKGUpe2NvbnN0IHQ9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMuc2NhbGVUb1JlZihlLHQpLHR9c2NhbGVUb1JlZihlLHQpe2ZvcihsZXQgaT0wO2k8MTY7aSsrKXQuX21baV09dGhpcy5fbVtpXSplO3JldHVybiB0Lm1hcmtBc1VwZGF0ZWQoKSx0fXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtmb3IobGV0IGk9MDtpPDE2O2krKyl0Ll9tW2ldKz10aGlzLl9tW2ldKmU7cmV0dXJuIHQubWFya0FzVXBkYXRlZCgpLHR9dG9Ob3JtYWxNYXRyaXgoZSl7Y29uc3QgdD1LLk1hdHJpeFswXTt0aGlzLmludmVydFRvUmVmKHQpLHQudHJhbnNwb3NlVG9SZWYoZSk7Y29uc3QgaT1lLl9tO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihpWzBdLGlbMV0saVsyXSwwLGlbNF0saVs1XSxpWzZdLDAsaVs4XSxpWzldLGlbMTBdLDAsMCwwLDAsMSxlKSxlfWdldFJvdGF0aW9uTWF0cml4KCl7Y29uc3QgZT1uZXcgdGhpcy5jb25zdHJ1Y3RvcjtyZXR1cm4gdGhpcy5nZXRSb3RhdGlvbk1hdHJpeFRvUmVmKGUpLGV9Z2V0Um90YXRpb25NYXRyaXhUb1JlZihlKXtjb25zdCB0PUsuVmVjdG9yM1swXTtpZighdGhpcy5kZWNvbXBvc2UodCkpcmV0dXJuIHguSWRlbnRpdHlUb1JlZihlKSxlO2NvbnN0IGk9dGhpcy5fbSxzPTEvdC5feCxyPTEvdC5feSxuPTEvdC5fejtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoaVswXSpzLGlbMV0qcyxpWzJdKnMsMCxpWzRdKnIsaVs1XSpyLGlbNl0qciwwLGlbOF0qbixpWzldKm4saVsxMF0qbiwwLDAsMCwwLDEsZSksZX10b2dnbGVNb2RlbE1hdHJpeEhhbmRJblBsYWNlKCl7Y29uc3QgZT10aGlzLl9tO3JldHVybiBlWzJdKj0tMSxlWzZdKj0tMSxlWzhdKj0tMSxlWzldKj0tMSxlWzE0XSo9LTEsdGhpcy5tYXJrQXNVcGRhdGVkKCksdGhpc310b2dnbGVQcm9qZWN0aW9uTWF0cml4SGFuZEluUGxhY2UoKXtjb25zdCBlPXRoaXMuX207cmV0dXJuIGVbOF0qPS0xLGVbOV0qPS0xLGVbMTBdKj0tMSxlWzExXSo9LTEsdGhpcy5tYXJrQXNVcGRhdGVkKCksdGhpc31zdGF0aWMgRnJvbUFycmF5KGUsdD0wKXtjb25zdCBpPW5ldyB4O3JldHVybiB4LkZyb21BcnJheVRvUmVmKGUsdCxpKSxpfXN0YXRpYyBGcm9tQXJyYXlUb1JlZihlLHQsaSl7Zm9yKGxldCBzPTA7czwxNjtzKyspaS5fbVtzXT1lW3MrdF07cmV0dXJuIGkubWFya0FzVXBkYXRlZCgpLGl9c3RhdGljIEZyb21GbG9hdDMyQXJyYXlUb1JlZlNjYWxlZChlLHQsaSxzKXtmb3IobGV0IHI9MDtyPDE2O3IrKylzLl9tW3JdPWVbcit0XSppO3JldHVybiBzLm1hcmtBc1VwZGF0ZWQoKSxzfXN0YXRpYyBnZXQgSWRlbnRpdHlSZWFkT25seSgpe3JldHVybiB4Ll9JZGVudGl0eVJlYWRPbmx5fXN0YXRpYyBGcm9tVmFsdWVzVG9SZWYoZSx0LGkscyxyLG4sYSxvLGgsbCx1LGQsZixfLEUsbSx2KXtjb25zdCBTPXYuX207U1swXT1lLFNbMV09dCxTWzJdPWksU1szXT1zLFNbNF09cixTWzVdPW4sU1s2XT1hLFNbN109byxTWzhdPWgsU1s5XT1sLFNbMTBdPXUsU1sxMV09ZCxTWzEyXT1mLFNbMTNdPV8sU1sxNF09RSxTWzE1XT1tLHYubWFya0FzVXBkYXRlZCgpfXN0YXRpYyBGcm9tVmFsdWVzKGUsdCxpLHMscixuLGEsbyxoLGwsdSxkLGYsXyxFLG0pe2NvbnN0IHY9bmV3IHgsUz12Ll9tO3JldHVybiBTWzBdPWUsU1sxXT10LFNbMl09aSxTWzNdPXMsU1s0XT1yLFNbNV09bixTWzZdPWEsU1s3XT1vLFNbOF09aCxTWzldPWwsU1sxMF09dSxTWzExXT1kLFNbMTJdPWYsU1sxM109XyxTWzE0XT1FLFNbMTVdPW0sdi5tYXJrQXNVcGRhdGVkKCksdn1zdGF0aWMgQ29tcG9zZShlLHQsaSl7Y29uc3Qgcz1uZXcgeDtyZXR1cm4geC5Db21wb3NlVG9SZWYoZSx0LGkscyksc31zdGF0aWMgQ29tcG9zZVRvUmVmKGUsdCxpLHMpe2NvbnN0IHI9cy5fbSxuPXQuX3gsYT10Ll95LG89dC5feixoPXQuX3csbD1uK24sdT1hK2EsZD1vK28sZj1uKmwsXz1uKnUsRT1uKmQsbT1hKnUsdj1hKmQsUz1vKmQseT1oKmwsQT1oKnUsQz1oKmQsYj1lLl94LE09ZS5feSxMPWUuX3o7cmV0dXJuIHJbMF09KDEtKG0rUykpKmIsclsxXT0oXytDKSpiLHJbMl09KEUtQSkqYixyWzNdPTAscls0XT0oXy1DKSpNLHJbNV09KDEtKGYrUykpKk0scls2XT0odit5KSpNLHJbN109MCxyWzhdPShFK0EpKkwscls5XT0odi15KSpMLHJbMTBdPSgxLShmK20pKSpMLHJbMTFdPTAsclsxMl09aS5feCxyWzEzXT1pLl95LHJbMTRdPWkuX3osclsxNV09MSxzLm1hcmtBc1VwZGF0ZWQoKSxzfXN0YXRpYyBJZGVudGl0eSgpe2NvbnN0IGU9eC5Gcm9tVmFsdWVzKDEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDEpO3JldHVybiBlLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMCksZX1zdGF0aWMgSWRlbnRpdHlUb1JlZihlKXtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsMCwwLDAsMSxlKSxlLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMCksZX1zdGF0aWMgWmVybygpe2NvbnN0IGU9eC5Gcm9tVmFsdWVzKDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDApO3JldHVybiBlLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMSksZX1zdGF0aWMgUm90YXRpb25YKGUpe2NvbnN0IHQ9bmV3IHg7cmV0dXJuIHguUm90YXRpb25YVG9SZWYoZSx0KSx0fXN0YXRpYyBJbnZlcnQoZSl7Y29uc3QgdD1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4gZS5pbnZlcnRUb1JlZih0KSx0fXN0YXRpYyBSb3RhdGlvblhUb1JlZihlLHQpe2NvbnN0IGk9TWF0aC5zaW4oZSkscz1NYXRoLmNvcyhlKTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoMSwwLDAsMCwwLHMsaSwwLDAsLWkscywwLDAsMCwwLDEsdCksdC5fdXBkYXRlSWRlbnRpdHlTdGF0dXMocz09PTEmJmk9PT0wKSx0fXN0YXRpYyBSb3RhdGlvblkoZSl7Y29uc3QgdD1uZXcgeDtyZXR1cm4geC5Sb3RhdGlvbllUb1JlZihlLHQpLHR9c3RhdGljIFJvdGF0aW9uWVRvUmVmKGUsdCl7Y29uc3QgaT1NYXRoLnNpbihlKSxzPU1hdGguY29zKGUpO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihzLDAsLWksMCwwLDEsMCwwLGksMCxzLDAsMCwwLDAsMSx0KSx0Ll91cGRhdGVJZGVudGl0eVN0YXR1cyhzPT09MSYmaT09PTApLHR9c3RhdGljIFJvdGF0aW9uWihlKXtjb25zdCB0PW5ldyB4O3JldHVybiB4LlJvdGF0aW9uWlRvUmVmKGUsdCksdH1zdGF0aWMgUm90YXRpb25aVG9SZWYoZSx0KXtjb25zdCBpPU1hdGguc2luKGUpLHM9TWF0aC5jb3MoZSk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKHMsaSwwLDAsLWkscywwLDAsMCwwLDEsMCwwLDAsMCwxLHQpLHQuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKHM9PT0xJiZpPT09MCksdH1zdGF0aWMgUm90YXRpb25BeGlzKGUsdCl7Y29uc3QgaT1uZXcgeDtyZXR1cm4geC5Sb3RhdGlvbkF4aXNUb1JlZihlLHQsaSksaX1zdGF0aWMgUm90YXRpb25BeGlzVG9SZWYoZSx0LGkpe2NvbnN0IHM9TWF0aC5zaW4oLXQpLHI9TWF0aC5jb3MoLXQpLG49MS1yO2Uubm9ybWFsaXplKCk7Y29uc3QgYT1pLl9tO3JldHVybiBhWzBdPWUuX3gqZS5feCpuK3IsYVsxXT1lLl94KmUuX3kqbi1lLl96KnMsYVsyXT1lLl94KmUuX3oqbitlLl95KnMsYVszXT0wLGFbNF09ZS5feSplLl94Km4rZS5feipzLGFbNV09ZS5feSplLl95Km4rcixhWzZdPWUuX3kqZS5feipuLWUuX3gqcyxhWzddPTAsYVs4XT1lLl96KmUuX3gqbi1lLl95KnMsYVs5XT1lLl96KmUuX3kqbitlLl94KnMsYVsxMF09ZS5feiplLl96Km4rcixhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsaS5tYXJrQXNVcGRhdGVkKCksaX1zdGF0aWMgUm90YXRpb25BbGlnblRvUmVmKGUsdCxpKXtjb25zdCBzPXAuRG90KHQsZSkscj1pLl9tO2lmKHM8LTEreGUpclswXT0tMSxyWzFdPTAsclsyXT0wLHJbM109MCxyWzRdPTAscls1XT0tMSxyWzZdPTAscls3XT0wLHJbOF09MCxyWzldPTAsclsxMF09MSxyWzExXT0wO2Vsc2V7Y29uc3Qgbj1wLkNyb3NzKHQsZSksYT0xLygxK3MpO3JbMF09bi5feCpuLl94KmErcyxyWzFdPW4uX3kqbi5feCphLW4uX3osclsyXT1uLl96Km4uX3gqYStuLl95LHJbM109MCxyWzRdPW4uX3gqbi5feSphK24uX3oscls1XT1uLl95Km4uX3kqYStzLHJbNl09bi5feipuLl95KmEtbi5feCxyWzddPTAscls4XT1uLl94Km4uX3oqYS1uLl95LHJbOV09bi5feSpuLl96KmErbi5feCxyWzEwXT1uLl96Km4uX3oqYStzLHJbMTFdPTB9cmV0dXJuIHJbMTJdPTAsclsxM109MCxyWzE0XT0wLHJbMTVdPTEsaS5tYXJrQXNVcGRhdGVkKCksaX1zdGF0aWMgUm90YXRpb25ZYXdQaXRjaFJvbGwoZSx0LGkpe2NvbnN0IHM9bmV3IHg7cmV0dXJuIHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBSb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKGUsdCxpLHMpe3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYoZSx0LGksSy5RdWF0ZXJuaW9uWzBdKSxLLlF1YXRlcm5pb25bMF0udG9Sb3RhdGlvbk1hdHJpeChzKSxzfXN0YXRpYyBTY2FsaW5nKGUsdCxpKXtjb25zdCBzPW5ldyB4O3JldHVybiB4LlNjYWxpbmdUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBTY2FsaW5nVG9SZWYoZSx0LGkscyl7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGUsMCwwLDAsMCx0LDAsMCwwLDAsaSwwLDAsMCwwLDEscykscy5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZT09PTEmJnQ9PT0xJiZpPT09MSksc31zdGF0aWMgVHJhbnNsYXRpb24oZSx0LGkpe2NvbnN0IHM9bmV3IHg7cmV0dXJuIHguVHJhbnNsYXRpb25Ub1JlZihlLHQsaSxzKSxzfXN0YXRpYyBUcmFuc2xhdGlvblRvUmVmKGUsdCxpLHMpe3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZigxLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCxlLHQsaSwxLHMpLHMuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKGU9PT0wJiZ0PT09MCYmaT09PTApLHN9c3RhdGljIExlcnAoZSx0LGkpe2NvbnN0IHM9bmV3IGUuY29uc3RydWN0b3I7cmV0dXJuIHguTGVycFRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIExlcnBUb1JlZihlLHQsaSxzKXtjb25zdCByPXMuX20sbj1lLm0sYT10Lm07Zm9yKGxldCBvPTA7bzwxNjtvKyspcltvXT1uW29dKigxLWkpK2Fbb10qaTtyZXR1cm4gcy5tYXJrQXNVcGRhdGVkKCksc31zdGF0aWMgRGVjb21wb3NlTGVycChlLHQsaSl7Y29uc3Qgcz1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4geC5EZWNvbXBvc2VMZXJwVG9SZWYoZSx0LGkscyksc31zdGF0aWMgRGVjb21wb3NlTGVycFRvUmVmKGUsdCxpLHMpe2NvbnN0IHI9Sy5WZWN0b3IzWzBdLG49Sy5RdWF0ZXJuaW9uWzBdLGE9Sy5WZWN0b3IzWzFdO2UuZGVjb21wb3NlKHIsbixhKTtjb25zdCBvPUsuVmVjdG9yM1syXSxoPUsuUXVhdGVybmlvblsxXSxsPUsuVmVjdG9yM1szXTt0LmRlY29tcG9zZShvLGgsbCk7Y29uc3QgdT1LLlZlY3RvcjNbNF07cC5MZXJwVG9SZWYocixvLGksdSk7Y29uc3QgZD1LLlF1YXRlcm5pb25bMl07Wi5TbGVycFRvUmVmKG4saCxpLGQpO2NvbnN0IGY9Sy5WZWN0b3IzWzVdO3JldHVybiBwLkxlcnBUb1JlZihhLGwsaSxmKSx4LkNvbXBvc2VUb1JlZih1LGQsZixzKSxzfXN0YXRpYyBMb29rQXRMSChlLHQsaSl7Y29uc3Qgcz1uZXcgeDtyZXR1cm4geC5Mb29rQXRMSFRvUmVmKGUsdCxpLHMpLHN9c3RhdGljIExvb2tBdExIVG9SZWYoZSx0LGkscyl7Y29uc3Qgcj1LLlZlY3RvcjNbMF0sbj1LLlZlY3RvcjNbMV0sYT1LLlZlY3RvcjNbMl07dC5zdWJ0cmFjdFRvUmVmKGUsYSksYS5ub3JtYWxpemUoKSxwLkNyb3NzVG9SZWYoaSxhLHIpO2NvbnN0IG89ci5sZW5ndGhTcXVhcmVkKCk7bz09PTA/ci54PTE6ci5ub3JtYWxpemVGcm9tTGVuZ3RoKE1hdGguc3FydChvKSkscC5Dcm9zc1RvUmVmKGEscixuKSxuLm5vcm1hbGl6ZSgpO2NvbnN0IGg9LXAuRG90KHIsZSksbD0tcC5Eb3QobixlKSx1PS1wLkRvdChhLGUpO3guRnJvbVZhbHVlc1RvUmVmKHIuX3gsbi5feCxhLl94LDAsci5feSxuLl95LGEuX3ksMCxyLl96LG4uX3osYS5feiwwLGgsbCx1LDEscyl9c3RhdGljIExvb2tBdFJIKGUsdCxpKXtjb25zdCBzPW5ldyB4O3JldHVybiB4Lkxvb2tBdFJIVG9SZWYoZSx0LGkscyksc31zdGF0aWMgTG9va0F0UkhUb1JlZihlLHQsaSxzKXtjb25zdCByPUsuVmVjdG9yM1swXSxuPUsuVmVjdG9yM1sxXSxhPUsuVmVjdG9yM1syXTtlLnN1YnRyYWN0VG9SZWYodCxhKSxhLm5vcm1hbGl6ZSgpLHAuQ3Jvc3NUb1JlZihpLGEscik7Y29uc3Qgbz1yLmxlbmd0aFNxdWFyZWQoKTtvPT09MD9yLng9MTpyLm5vcm1hbGl6ZUZyb21MZW5ndGgoTWF0aC5zcXJ0KG8pKSxwLkNyb3NzVG9SZWYoYSxyLG4pLG4ubm9ybWFsaXplKCk7Y29uc3QgaD0tcC5Eb3QocixlKSxsPS1wLkRvdChuLGUpLHU9LXAuRG90KGEsZSk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKHIuX3gsbi5feCxhLl94LDAsci5feSxuLl95LGEuX3ksMCxyLl96LG4uX3osYS5feiwwLGgsbCx1LDEscyksc31zdGF0aWMgTG9va0RpcmVjdGlvbkxIKGUsdCl7Y29uc3QgaT1uZXcgeDtyZXR1cm4geC5Mb29rRGlyZWN0aW9uTEhUb1JlZihlLHQsaSksaX1zdGF0aWMgTG9va0RpcmVjdGlvbkxIVG9SZWYoZSx0LGkpe2NvbnN0IHM9Sy5WZWN0b3IzWzBdO3MuY29weUZyb20oZSkscy5zY2FsZUluUGxhY2UoLTEpO2NvbnN0IHI9Sy5WZWN0b3IzWzFdO3JldHVybiBwLkNyb3NzVG9SZWYodCxzLHIpLHguRnJvbVZhbHVlc1RvUmVmKHIuX3gsci5feSxyLl96LDAsdC5feCx0Ll95LHQuX3osMCxzLl94LHMuX3kscy5feiwwLDAsMCwwLDEsaSksaX1zdGF0aWMgTG9va0RpcmVjdGlvblJIKGUsdCl7Y29uc3QgaT1uZXcgeDtyZXR1cm4geC5Mb29rRGlyZWN0aW9uUkhUb1JlZihlLHQsaSksaX1zdGF0aWMgTG9va0RpcmVjdGlvblJIVG9SZWYoZSx0LGkpe2NvbnN0IHM9Sy5WZWN0b3IzWzJdO3JldHVybiBwLkNyb3NzVG9SZWYodCxlLHMpLHguRnJvbVZhbHVlc1RvUmVmKHMuX3gscy5feSxzLl96LDAsdC5feCx0Ll95LHQuX3osMCxlLl94LGUuX3ksZS5feiwwLDAsMCwwLDEsaSksaX1zdGF0aWMgT3J0aG9MSChlLHQsaSxzLHIpe2NvbnN0IG49bmV3IHg7cmV0dXJuIHguT3J0aG9MSFRvUmVmKGUsdCxpLHMsbixyKSxufXN0YXRpYyBPcnRob0xIVG9SZWYoZSx0LGkscyxyLG4pe2NvbnN0IGE9aSxvPXMsaD0yL2UsbD0yL3QsdT0yLyhvLWEpLGQ9LShvK2EpLyhvLWEpO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihoLDAsMCwwLDAsbCwwLDAsMCwwLHUsMCwwLDAsZCwxLHIpLG4mJnIubXVsdGlwbHlUb1JlZihxdCxyKSxyLl91cGRhdGVJZGVudGl0eVN0YXR1cyhoPT09MSYmbD09PTEmJnU9PT0xJiZkPT09MCkscn1zdGF0aWMgT3J0aG9PZmZDZW50ZXJMSChlLHQsaSxzLHIsbixhKXtjb25zdCBvPW5ldyB4O3JldHVybiB4Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZihlLHQsaSxzLHIsbixvLGEpLG99c3RhdGljIE9ydGhvT2ZmQ2VudGVyTEhUb1JlZihlLHQsaSxzLHIsbixhLG8pe2NvbnN0IGg9cixsPW4sdT0yLyh0LWUpLGQ9Mi8ocy1pKSxmPTIvKGwtaCksXz0tKGwraCkvKGwtaCksRT0oZSt0KS8oZS10KSxtPShzK2kpLyhpLXMpO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZih1LDAsMCwwLDAsZCwwLDAsMCwwLGYsMCxFLG0sXywxLGEpLG8mJmEubXVsdGlwbHlUb1JlZihxdCxhKSxhLm1hcmtBc1VwZGF0ZWQoKSxhfXN0YXRpYyBPcnRob09mZkNlbnRlclJIKGUsdCxpLHMscixuLGEpe2NvbnN0IG89bmV3IHg7cmV0dXJuIHguT3J0aG9PZmZDZW50ZXJSSFRvUmVmKGUsdCxpLHMscixuLG8sYSksb31zdGF0aWMgT3J0aG9PZmZDZW50ZXJSSFRvUmVmKGUsdCxpLHMscixuLGEsbyl7cmV0dXJuIHguT3J0aG9PZmZDZW50ZXJMSFRvUmVmKGUsdCxpLHMscixuLGEsbyksYS5fbVsxMF0qPS0xLGF9c3RhdGljIFBlcnNwZWN0aXZlTEgoZSx0LGkscyxyLG49MCl7Y29uc3QgYT1uZXcgeCxvPWksaD1zLGw9MipvL2UsdT0yKm8vdCxkPShoK28pLyhoLW8pLGY9LTIqaCpvLyhoLW8pLF89TWF0aC50YW4obik7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGwsMCwwLDAsMCx1LDAsXywwLDAsZCwxLDAsMCxmLDAsYSksciYmYS5tdWx0aXBseVRvUmVmKHF0LGEpLGEuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKCExKSxhfXN0YXRpYyBQZXJzcGVjdGl2ZUZvdkxIKGUsdCxpLHMscixuPTAsYT0hMSl7Y29uc3Qgbz1uZXcgeDtyZXR1cm4geC5QZXJzcGVjdGl2ZUZvdkxIVG9SZWYoZSx0LGkscyxvLCEwLHIsbixhKSxvfXN0YXRpYyBQZXJzcGVjdGl2ZUZvdkxIVG9SZWYoZSx0LGkscyxyLG49ITAsYSxvPTAsaD0hMSl7Y29uc3QgbD1pLHU9cyxkPTEvTWF0aC50YW4oZSouNSksZj1uP2QvdDpkLF89bj9kOmQqdCxFPWgmJmw9PT0wPy0xOnUhPT0wPyh1K2wpLyh1LWwpOjEsbT1oJiZsPT09MD8yKnU6dSE9PTA/LTIqdSpsLyh1LWwpOi0yKmwsdj1NYXRoLnRhbihvKTtyZXR1cm4geC5Gcm9tVmFsdWVzVG9SZWYoZiwwLDAsMCwwLF8sMCx2LDAsMCxFLDEsMCwwLG0sMCxyKSxhJiZyLm11bHRpcGx5VG9SZWYocXQsciksci5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoITEpLHJ9c3RhdGljIFBlcnNwZWN0aXZlRm92UmV2ZXJzZUxIVG9SZWYoZSx0LGkscyxyLG49ITAsYSxvPTApe2NvbnN0IGg9MS9NYXRoLnRhbihlKi41KSxsPW4/aC90OmgsdT1uP2g6aCp0LGQ9TWF0aC50YW4obyk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGwsMCwwLDAsMCx1LDAsZCwwLDAsLWksMSwwLDAsMSwwLHIpLGEmJnIubXVsdGlwbHlUb1JlZihxdCxyKSxyLl91cGRhdGVJZGVudGl0eVN0YXR1cyghMSkscn1zdGF0aWMgUGVyc3BlY3RpdmVGb3ZSSChlLHQsaSxzLHIsbj0wLGE9ITEpe2NvbnN0IG89bmV3IHg7cmV0dXJuIHguUGVyc3BlY3RpdmVGb3ZSSFRvUmVmKGUsdCxpLHMsbywhMCxyLG4sYSksb31zdGF0aWMgUGVyc3BlY3RpdmVGb3ZSSFRvUmVmKGUsdCxpLHMscixuPSEwLGEsbz0wLGg9ITEpe2NvbnN0IGw9aSx1PXMsZD0xL01hdGgudGFuKGUqLjUpLGY9bj9kL3Q6ZCxfPW4/ZDpkKnQsRT1oJiZsPT09MD8xOnUhPT0wPy0odStsKS8odS1sKTotMSxtPWgmJmw9PT0wPzIqdTp1IT09MD8tMip1KmwvKHUtbCk6LTIqbCx2PU1hdGgudGFuKG8pO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihmLDAsMCwwLDAsXywwLHYsMCwwLEUsLTEsMCwwLG0sMCxyKSxhJiZyLm11bHRpcGx5VG9SZWYocXQsciksci5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoITEpLHJ9c3RhdGljIFBlcnNwZWN0aXZlRm92UmV2ZXJzZVJIVG9SZWYoZSx0LGkscyxyLG49ITAsYSxvPTApe2NvbnN0IGg9MS9NYXRoLnRhbihlKi41KSxsPW4/aC90OmgsdT1uP2g6aCp0LGQ9TWF0aC50YW4obyk7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGwsMCwwLDAsMCx1LDAsZCwwLDAsLWksLTEsMCwwLC0xLDAsciksYSYmci5tdWx0aXBseVRvUmVmKHF0LHIpLHIuX3VwZGF0ZUlkZW50aXR5U3RhdHVzKCExKSxyfXN0YXRpYyBQZXJzcGVjdGl2ZUZvdldlYlZSVG9SZWYoZSx0LGkscyxyPSExLG4sYT0wKXtjb25zdCBvPXI/LTE6MSxoPU1hdGgudGFuKGUudXBEZWdyZWVzKk1hdGguUEkvMTgwKSxsPU1hdGgudGFuKGUuZG93bkRlZ3JlZXMqTWF0aC5QSS8xODApLHU9TWF0aC50YW4oZS5sZWZ0RGVncmVlcypNYXRoLlBJLzE4MCksZD1NYXRoLnRhbihlLnJpZ2h0RGVncmVlcypNYXRoLlBJLzE4MCksZj0yLyh1K2QpLF89Mi8oaCtsKSxFPU1hdGgudGFuKGEpLG09cy5fbTtyZXR1cm4gbVswXT1mLG1bMV09bVsyXT1tWzNdPW1bNF09MCxtWzVdPV8sbVs2XT0wLG1bN109RSxtWzhdPSh1LWQpKmYqLjUsbVs5XT0tKChoLWwpKl8qLjUpLG1bMTBdPS1pLyh0LWkpLG1bMTFdPTEqbyxtWzEyXT1tWzEzXT1tWzE1XT0wLG1bMTRdPS0oMippKnQpLyhpLXQpLG4mJnMubXVsdGlwbHlUb1JlZihxdCxzKSxzLm1hcmtBc1VwZGF0ZWQoKSxzfXN0YXRpYyBHZXRGaW5hbE1hdHJpeChlLHQsaSxzLHIsbil7Y29uc3QgYT1lLndpZHRoLG89ZS5oZWlnaHQsaD1lLngsbD1lLnksdT14LkZyb21WYWx1ZXMoYS8yLDAsMCwwLDAsLW8vMiwwLDAsMCwwLG4tciwwLGgrYS8yLG8vMitsLHIsMSksZD1uZXcgdC5jb25zdHJ1Y3RvcjtyZXR1cm4gdC5tdWx0aXBseVRvUmVmKGksZCksZC5tdWx0aXBseVRvUmVmKHMsZCksZC5tdWx0aXBseVRvUmVmKHUsZCl9c3RhdGljIEdldEFzTWF0cml4MngyKGUpe2NvbnN0IHQ9ZS5tLGk9W3RbMF0sdFsxXSx0WzRdLHRbNV1dO3JldHVybiBVZS5NYXRyaXhVc2U2NEJpdHM/aTpuZXcgRmxvYXQzMkFycmF5KGkpfXN0YXRpYyBHZXRBc01hdHJpeDN4MyhlKXtjb25zdCB0PWUubSxpPVt0WzBdLHRbMV0sdFsyXSx0WzRdLHRbNV0sdFs2XSx0WzhdLHRbOV0sdFsxMF1dO3JldHVybiBVZS5NYXRyaXhVc2U2NEJpdHM/aTpuZXcgRmxvYXQzMkFycmF5KGkpfXN0YXRpYyBUcmFuc3Bvc2UoZSl7Y29uc3QgdD1uZXcgZS5jb25zdHJ1Y3RvcjtyZXR1cm4geC5UcmFuc3Bvc2VUb1JlZihlLHQpLHR9c3RhdGljIFRyYW5zcG9zZVRvUmVmKGUsdCl7Y29uc3QgaT10Ll9tLHM9ZS5tO3JldHVybiBpWzBdPXNbMF0saVsxXT1zWzRdLGlbMl09c1s4XSxpWzNdPXNbMTJdLGlbNF09c1sxXSxpWzVdPXNbNV0saVs2XT1zWzldLGlbN109c1sxM10saVs4XT1zWzJdLGlbOV09c1s2XSxpWzEwXT1zWzEwXSxpWzExXT1zWzE0XSxpWzEyXT1zWzNdLGlbMTNdPXNbN10saVsxNF09c1sxMV0saVsxNV09c1sxNV0sdC5tYXJrQXNVcGRhdGVkKCksdC5fdXBkYXRlSWRlbnRpdHlTdGF0dXMoZS5faXNJZGVudGl0eSxlLl9pc0lkZW50aXR5RGlydHkpLHR9c3RhdGljIFJlZmxlY3Rpb24oZSl7Y29uc3QgdD1uZXcgeDtyZXR1cm4geC5SZWZsZWN0aW9uVG9SZWYoZSx0KSx0fXN0YXRpYyBSZWZsZWN0aW9uVG9SZWYoZSx0KXtlLm5vcm1hbGl6ZSgpO2NvbnN0IGk9ZS5ub3JtYWwueCxzPWUubm9ybWFsLnkscj1lLm5vcm1hbC56LG49LTIqaSxhPS0yKnMsbz0tMipyO3JldHVybiB4LkZyb21WYWx1ZXNUb1JlZihuKmkrMSxhKmksbyppLDAsbipzLGEqcysxLG8qcywwLG4qcixhKnIsbypyKzEsMCxuKmUuZCxhKmUuZCxvKmUuZCwxLHQpLHR9c3RhdGljIEZyb21YWVpBeGVzVG9SZWYoZSx0LGkscyl7cmV0dXJuIHguRnJvbVZhbHVlc1RvUmVmKGUuX3gsZS5feSxlLl96LDAsdC5feCx0Ll95LHQuX3osMCxpLl94LGkuX3ksaS5feiwwLDAsMCwwLDEscyksc31zdGF0aWMgRnJvbVF1YXRlcm5pb25Ub1JlZihlLHQpe2NvbnN0IGk9ZS5feCplLl94LHM9ZS5feSplLl95LHI9ZS5feiplLl96LG49ZS5feCplLl95LGE9ZS5feiplLl93LG89ZS5feiplLl94LGg9ZS5feSplLl93LGw9ZS5feSplLl96LHU9ZS5feCplLl93O3JldHVybiB0Ll9tWzBdPTEtMioocytyKSx0Ll9tWzFdPTIqKG4rYSksdC5fbVsyXT0yKihvLWgpLHQuX21bM109MCx0Ll9tWzRdPTIqKG4tYSksdC5fbVs1XT0xLTIqKHIraSksdC5fbVs2XT0yKihsK3UpLHQuX21bN109MCx0Ll9tWzhdPTIqKG8raCksdC5fbVs5XT0yKihsLXUpLHQuX21bMTBdPTEtMioocytpKSx0Ll9tWzExXT0wLHQuX21bMTJdPTAsdC5fbVsxM109MCx0Ll9tWzE0XT0wLHQuX21bMTVdPTEsdC5tYXJrQXNVcGRhdGVkKCksdH19eC5fVXBkYXRlRmxhZ1NlZWQ9MCx4Ll9JZGVudGl0eVJlYWRPbmx5PXguSWRlbnRpdHkoKTtjbGFzcyBLe31LLlZlY3RvcjM9QmUuQnVpbGRUdXBsZSgxMSxwLlplcm8pLEsuTWF0cml4PUJlLkJ1aWxkVHVwbGUoMix4LklkZW50aXR5KSxLLlF1YXRlcm5pb249QmUuQnVpbGRUdXBsZSgzLFouWmVybyk7Y2xhc3MgRHt9RC5WZWN0b3IyPUJlLkJ1aWxkVHVwbGUoMyx2ZS5aZXJvKSxELlZlY3RvcjM9QmUuQnVpbGRUdXBsZSgxMyxwLlplcm8pLEQuVmVjdG9yND1CZS5CdWlsZFR1cGxlKDMsQ2UuWmVybyksRC5RdWF0ZXJuaW9uPUJlLkJ1aWxkVHVwbGUoMixaLlplcm8pLEQuTWF0cml4PUJlLkJ1aWxkVHVwbGUoOCx4LklkZW50aXR5KSxpdCgiQkFCWUxPTi5WZWN0b3IyIix2ZSksaXQoIkJBQllMT04uVmVjdG9yMyIscCksaXQoIkJBQllMT04uVmVjdG9yNCIsQ2UpLGl0KCJCQUJZTE9OLk1hdHJpeCIseCk7Y29uc3QgcXQ9eC5Gcm9tVmFsdWVzKDEsMCwwLDAsMCwxLDAsMCwwLDAsLjUsMCwwLDAsLjUsMSk7Y2xhc3MgS3J7Y29uc3RydWN0b3IoZSx0PSExLGkscyl7dGhpcy5pbml0aWFsaXplKGUsdCxpLHMpfWluaXRpYWxpemUoZSx0PSExLGkscyl7cmV0dXJuIHRoaXMubWFzaz1lLHRoaXMuc2tpcE5leHRPYnNlcnZlcnM9dCx0aGlzLnRhcmdldD1pLHRoaXMuY3VycmVudFRhcmdldD1zLHRoaXN9fWNsYXNzIFlye2NvbnN0cnVjdG9yKGUsdCxpPW51bGwpe3RoaXMuY2FsbGJhY2s9ZSx0aGlzLm1hc2s9dCx0aGlzLnNjb3BlPWksdGhpcy5fd2lsbEJlVW5yZWdpc3RlcmVkPSExLHRoaXMudW5yZWdpc3Rlck9uTmV4dENhbGw9ITF9fWNsYXNzIEZ7Y29uc3RydWN0b3IoZSl7dGhpcy5fb2JzZXJ2ZXJzPW5ldyBBcnJheSx0aGlzLl9udW1PYnNlcnZlcnNNYXJrZWRBc0RlbGV0ZWQ9MCx0aGlzLl9ldmVudFN0YXRlPW5ldyBLcigwKSxlJiYodGhpcy5fb25PYnNlcnZlckFkZGVkPWUpfXN0YXRpYyBGcm9tUHJvbWlzZShlLHQpe2NvbnN0IGk9bmV3IEY7cmV0dXJuIGUudGhlbihzPT57aS5ub3RpZnlPYnNlcnZlcnMocyl9KS5jYXRjaChzPT57aWYodCl0Lm5vdGlmeU9ic2VydmVycyhzKTtlbHNlIHRocm93IHN9KSxpfWdldCBvYnNlcnZlcnMoKXtyZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzfWFkZChlLHQ9LTEsaT0hMSxzPW51bGwscj0hMSl7aWYoIWUpcmV0dXJuIG51bGw7Y29uc3Qgbj1uZXcgWXIoZSx0LHMpO3JldHVybiBuLnVucmVnaXN0ZXJPbk5leHRDYWxsPXIsaT90aGlzLl9vYnNlcnZlcnMudW5zaGlmdChuKTp0aGlzLl9vYnNlcnZlcnMucHVzaChuKSx0aGlzLl9vbk9ic2VydmVyQWRkZWQmJnRoaXMuX29uT2JzZXJ2ZXJBZGRlZChuKSxufWFkZE9uY2UoZSl7cmV0dXJuIHRoaXMuYWRkKGUsdm9pZCAwLHZvaWQgMCx2b2lkIDAsITApfXJlbW92ZShlKXtyZXR1cm4gZSYmdGhpcy5fb2JzZXJ2ZXJzLmluZGV4T2YoZSkhPT0tMT8odGhpcy5fZGVmZXJVbnJlZ2lzdGVyKGUpLCEwKTohMX1yZW1vdmVDYWxsYmFjayhlLHQpe2ZvcihsZXQgaT0wO2k8dGhpcy5fb2JzZXJ2ZXJzLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5fb2JzZXJ2ZXJzW2ldO2lmKCFzLl93aWxsQmVVbnJlZ2lzdGVyZWQmJnMuY2FsbGJhY2s9PT1lJiYoIXR8fHQ9PT1zLnNjb3BlKSlyZXR1cm4gdGhpcy5fZGVmZXJVbnJlZ2lzdGVyKHMpLCEwfXJldHVybiExfV9kZWZlclVucmVnaXN0ZXIoZSl7dGhpcy5fbnVtT2JzZXJ2ZXJzTWFya2VkQXNEZWxldGVkKyssZS51bnJlZ2lzdGVyT25OZXh0Q2FsbD0hMSxlLl93aWxsQmVVbnJlZ2lzdGVyZWQ9ITAsc2V0VGltZW91dCgoKT0+e3RoaXMuX3JlbW92ZShlKX0sMCl9X3JlbW92ZShlKXtpZighZSlyZXR1cm4hMTtjb25zdCB0PXRoaXMuX29ic2VydmVycy5pbmRleE9mKGUpO3JldHVybiB0IT09LTE/KHRoaXMuX251bU9ic2VydmVyc01hcmtlZEFzRGVsZXRlZC0tLHRoaXMuX29ic2VydmVycy5zcGxpY2UodCwxKSwhMCk6ITF9bWFrZU9ic2VydmVyVG9wUHJpb3JpdHkoZSl7dGhpcy5fcmVtb3ZlKGUpLHRoaXMuX29ic2VydmVycy51bnNoaWZ0KGUpfW1ha2VPYnNlcnZlckJvdHRvbVByaW9yaXR5KGUpe3RoaXMuX3JlbW92ZShlKSx0aGlzLl9vYnNlcnZlcnMucHVzaChlKX1ub3RpZnlPYnNlcnZlcnMoZSx0PS0xLGkscyxyKXtpZighdGhpcy5fb2JzZXJ2ZXJzLmxlbmd0aClyZXR1cm4hMDtjb25zdCBuPXRoaXMuX2V2ZW50U3RhdGU7bi5tYXNrPXQsbi50YXJnZXQ9aSxuLmN1cnJlbnRUYXJnZXQ9cyxuLnNraXBOZXh0T2JzZXJ2ZXJzPSExLG4ubGFzdFJldHVyblZhbHVlPWUsbi51c2VySW5mbz1yO2Zvcihjb25zdCBhIG9mIHRoaXMuX29ic2VydmVycylpZighYS5fd2lsbEJlVW5yZWdpc3RlcmVkJiYoYS5tYXNrJnQmJihhLnVucmVnaXN0ZXJPbk5leHRDYWxsJiZ0aGlzLl9kZWZlclVucmVnaXN0ZXIoYSksYS5zY29wZT9uLmxhc3RSZXR1cm5WYWx1ZT1hLmNhbGxiYWNrLmFwcGx5KGEuc2NvcGUsW2Usbl0pOm4ubGFzdFJldHVyblZhbHVlPWEuY2FsbGJhY2soZSxuKSksbi5za2lwTmV4dE9ic2VydmVycykpcmV0dXJuITE7cmV0dXJuITB9bm90aWZ5T2JzZXJ2ZXIoZSx0LGk9LTEpe2lmKGUuX3dpbGxCZVVucmVnaXN0ZXJlZClyZXR1cm47Y29uc3Qgcz10aGlzLl9ldmVudFN0YXRlO3MubWFzaz1pLHMuc2tpcE5leHRPYnNlcnZlcnM9ITEsZS51bnJlZ2lzdGVyT25OZXh0Q2FsbCYmdGhpcy5fZGVmZXJVbnJlZ2lzdGVyKGUpLGUuY2FsbGJhY2sodCxzKX1oYXNPYnNlcnZlcnMoKXtyZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzLmxlbmd0aC10aGlzLl9udW1PYnNlcnZlcnNNYXJrZWRBc0RlbGV0ZWQ+MH1jbGVhcigpe3RoaXMuX29ic2VydmVycz1uZXcgQXJyYXksdGhpcy5fb25PYnNlcnZlckFkZGVkPW51bGx9Y2xvbmUoKXtjb25zdCBlPW5ldyBGO3JldHVybiBlLl9vYnNlcnZlcnM9dGhpcy5fb2JzZXJ2ZXJzLnNsaWNlKDApLGV9aGFzU3BlY2lmaWNNYXNrKGU9LTEpe2Zvcihjb25zdCB0IG9mIHRoaXMuX29ic2VydmVycylpZih0Lm1hc2smZXx8dC5tYXNrPT09ZSlyZXR1cm4hMDtyZXR1cm4hMX19Y2xhc3MgWnJ7Y29uc3RydWN0b3IoKXt0aGlzLnNhbXBsaW5nTW9kZT0tMSx0aGlzLl91c2VNaXBNYXBzPSEwLHRoaXMuX2NhY2hlZFdyYXBVPW51bGwsdGhpcy5fY2FjaGVkV3JhcFY9bnVsbCx0aGlzLl9jYWNoZWRXcmFwUj1udWxsLHRoaXMuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9bnVsbCx0aGlzLl9jb21wYXJpc29uRnVuY3Rpb249MH1nZXQgd3JhcFUoKXtyZXR1cm4gdGhpcy5fY2FjaGVkV3JhcFV9c2V0IHdyYXBVKGUpe3RoaXMuX2NhY2hlZFdyYXBVPWV9Z2V0IHdyYXBWKCl7cmV0dXJuIHRoaXMuX2NhY2hlZFdyYXBWfXNldCB3cmFwVihlKXt0aGlzLl9jYWNoZWRXcmFwVj1lfWdldCB3cmFwUigpe3JldHVybiB0aGlzLl9jYWNoZWRXcmFwUn1zZXQgd3JhcFIoZSl7dGhpcy5fY2FjaGVkV3JhcFI9ZX1nZXQgYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbCgpe3JldHVybiB0aGlzLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsfXNldCBhbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsKGUpe3RoaXMuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9ZX1nZXQgY29tcGFyaXNvbkZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbXBhcmlzb25GdW5jdGlvbn1zZXQgY29tcGFyaXNvbkZ1bmN0aW9uKGUpe3RoaXMuX2NvbXBhcmlzb25GdW5jdGlvbj1lfWdldCB1c2VNaXBNYXBzKCl7cmV0dXJuIHRoaXMuX3VzZU1pcE1hcHN9c2V0IHVzZU1pcE1hcHMoZSl7dGhpcy5fdXNlTWlwTWFwcz1lfXNldFBhcmFtZXRlcnMoZT0xLHQ9MSxpPTEscz0xLHI9MixuPTApe3JldHVybiB0aGlzLl9jYWNoZWRXcmFwVT1lLHRoaXMuX2NhY2hlZFdyYXBWPXQsdGhpcy5fY2FjaGVkV3JhcFI9aSx0aGlzLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPXMsdGhpcy5zYW1wbGluZ01vZGU9cix0aGlzLl9jb21wYXJpc29uRnVuY3Rpb249bix0aGlzfWNvbXBhcmVTYW1wbGVyKGUpe3JldHVybiB0aGlzLl9jYWNoZWRXcmFwVT09PWUuX2NhY2hlZFdyYXBVJiZ0aGlzLl9jYWNoZWRXcmFwVj09PWUuX2NhY2hlZFdyYXBWJiZ0aGlzLl9jYWNoZWRXcmFwUj09PWUuX2NhY2hlZFdyYXBSJiZ0aGlzLl9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPT09ZS5fY2FjaGVkQW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbCYmdGhpcy5zYW1wbGluZ01vZGU9PT1lLnNhbXBsaW5nTW9kZSYmdGhpcy5fY29tcGFyaXNvbkZ1bmN0aW9uPT09ZS5fY29tcGFyaXNvbkZ1bmN0aW9uJiZ0aGlzLl91c2VNaXBNYXBzPT09ZS5fdXNlTWlwTWFwc319dmFyIE5lOyhmdW5jdGlvbihjKXtjW2MuVW5rbm93bj0wXT0iVW5rbm93biIsY1tjLlVybD0xXT0iVXJsIixjW2MuVGVtcD0yXT0iVGVtcCIsY1tjLlJhdz0zXT0iUmF3IixjW2MuRHluYW1pYz00XT0iRHluYW1pYyIsY1tjLlJlbmRlclRhcmdldD01XT0iUmVuZGVyVGFyZ2V0IixjW2MuTXVsdGlSZW5kZXJUYXJnZXQ9Nl09Ik11bHRpUmVuZGVyVGFyZ2V0IixjW2MuQ3ViZT03XT0iQ3ViZSIsY1tjLkN1YmVSYXc9OF09IkN1YmVSYXciLGNbYy5DdWJlUHJlZmlsdGVyZWQ9OV09IkN1YmVQcmVmaWx0ZXJlZCIsY1tjLlJhdzNEPTEwXT0iUmF3M0QiLGNbYy5SYXcyREFycmF5PTExXT0iUmF3MkRBcnJheSIsY1tjLkRlcHRoU3RlbmNpbD0xMl09IkRlcHRoU3RlbmNpbCIsY1tjLkN1YmVSYXdSR0JEPTEzXT0iQ3ViZVJhd1JHQkQiLGNbYy5EZXB0aD0xNF09IkRlcHRoIn0pKE5lfHwoTmU9e30pKTtjbGFzcyBPdCBleHRlbmRzIFpye2NvbnN0cnVjdG9yKGUsdCxpPSExKXtzdXBlcigpLHRoaXMuaXNSZWFkeT0hMSx0aGlzLmlzQ3ViZT0hMSx0aGlzLmlzM0Q9ITEsdGhpcy5pczJEQXJyYXk9ITEsdGhpcy5pc011bHRpdmlldz0hMSx0aGlzLnVybD0iIix0aGlzLmdlbmVyYXRlTWlwTWFwcz0hMSx0aGlzLnNhbXBsZXM9MCx0aGlzLnR5cGU9LTEsdGhpcy5mb3JtYXQ9LTEsdGhpcy5vbkxvYWRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkVycm9yT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUmVidWlsZENhbGxiYWNrPW51bGwsdGhpcy53aWR0aD0wLHRoaXMuaGVpZ2h0PTAsdGhpcy5kZXB0aD0wLHRoaXMuYmFzZVdpZHRoPTAsdGhpcy5iYXNlSGVpZ2h0PTAsdGhpcy5iYXNlRGVwdGg9MCx0aGlzLmludmVydFk9ITEsdGhpcy5faW52ZXJ0VlNjYWxlPSExLHRoaXMuX2Fzc29jaWF0ZWRDaGFubmVsPS0xLHRoaXMuX3NvdXJjZT1OZS5Vbmtub3duLHRoaXMuX2J1ZmZlcj1udWxsLHRoaXMuX2J1ZmZlclZpZXc9bnVsbCx0aGlzLl9idWZmZXJWaWV3QXJyYXk9bnVsbCx0aGlzLl9idWZmZXJWaWV3QXJyYXlBcnJheT1udWxsLHRoaXMuX3NpemU9MCx0aGlzLl9leHRlbnNpb249IiIsdGhpcy5fZmlsZXM9bnVsbCx0aGlzLl93b3JraW5nQ2FudmFzPW51bGwsdGhpcy5fd29ya2luZ0NvbnRleHQ9bnVsbCx0aGlzLl9jYWNoZWRDb29yZGluYXRlc01vZGU9bnVsbCx0aGlzLl9pc0Rpc2FibGVkPSExLHRoaXMuX2NvbXByZXNzaW9uPW51bGwsdGhpcy5fc3BoZXJpY2FsUG9seW5vbWlhbD1udWxsLHRoaXMuX3NwaGVyaWNhbFBvbHlub21pYWxQcm9taXNlPW51bGwsdGhpcy5fc3BoZXJpY2FsUG9seW5vbWlhbENvbXB1dGVkPSExLHRoaXMuX2xvZEdlbmVyYXRpb25TY2FsZT0wLHRoaXMuX2xvZEdlbmVyYXRpb25PZmZzZXQ9MCx0aGlzLl91c2VTUkdCQnVmZmVyPSExLHRoaXMuX2xvZFRleHR1cmVIaWdoPW51bGwsdGhpcy5fbG9kVGV4dHVyZU1pZD1udWxsLHRoaXMuX2xvZFRleHR1cmVMb3c9bnVsbCx0aGlzLl9pc1JHQkQ9ITEsdGhpcy5fbGluZWFyU3BlY3VsYXJMT0Q9ITEsdGhpcy5faXJyYWRpYW5jZVRleHR1cmU9bnVsbCx0aGlzLl9oYXJkd2FyZVRleHR1cmU9bnVsbCx0aGlzLl9tYXhMb2RMZXZlbD1udWxsLHRoaXMuX3JlZmVyZW5jZXM9MSx0aGlzLl9nYW1tYVNwYWNlPW51bGwsdGhpcy5fZW5naW5lPWUsdGhpcy5fc291cmNlPXQsdGhpcy5fdW5pcXVlSWQ9T3QuX0NvdW50ZXIrKyxpfHwodGhpcy5faGFyZHdhcmVUZXh0dXJlPWUuX2NyZWF0ZUhhcmR3YXJlVGV4dHVyZSgpKX1nZXQgdXNlTWlwTWFwcygpe3JldHVybiB0aGlzLmdlbmVyYXRlTWlwTWFwc31zZXQgdXNlTWlwTWFwcyhlKXt0aGlzLmdlbmVyYXRlTWlwTWFwcz1lfWdldCB1bmlxdWVJZCgpe3JldHVybiB0aGlzLl91bmlxdWVJZH1fc2V0VW5pcXVlSWQoZSl7dGhpcy5fdW5pcXVlSWQ9ZX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWdldCBzb3VyY2UoKXtyZXR1cm4gdGhpcy5fc291cmNlfWluY3JlbWVudFJlZmVyZW5jZXMoKXt0aGlzLl9yZWZlcmVuY2VzKyt9dXBkYXRlU2l6ZShlLHQsaT0xKXt0aGlzLl9lbmdpbmUudXBkYXRlVGV4dHVyZURpbWVuc2lvbnModGhpcyxlLHQsaSksdGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PXQsdGhpcy5kZXB0aD1pLHRoaXMuYmFzZVdpZHRoPWUsdGhpcy5iYXNlSGVpZ2h0PXQsdGhpcy5iYXNlRGVwdGg9aSx0aGlzLl9zaXplPWUqdCppfV9yZWJ1aWxkKCl7dmFyIGU7aWYodGhpcy5pc1JlYWR5PSExLHRoaXMuX2NhY2hlZENvb3JkaW5hdGVzTW9kZT1udWxsLHRoaXMuX2NhY2hlZFdyYXBVPW51bGwsdGhpcy5fY2FjaGVkV3JhcFY9bnVsbCx0aGlzLl9jYWNoZWRXcmFwUj1udWxsLHRoaXMuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9bnVsbCx0aGlzLm9uUmVidWlsZENhbGxiYWNrKXtjb25zdCBpPXRoaXMub25SZWJ1aWxkQ2FsbGJhY2sodGhpcykscz1yPT57ci5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9aS5pc1JlYWR5fTtpLmlzQXN5bmM/aS5wcm94eS50aGVuKHMpOnMoaS5wcm94eSk7cmV0dXJufWxldCB0O3N3aXRjaCh0aGlzLnNvdXJjZSl7Y2FzZSBOZS5UZW1wOmJyZWFrO2Nhc2UgTmUuVXJsOnQ9dGhpcy5fZW5naW5lLmNyZWF0ZVRleHR1cmUoKGU9dGhpcy5fb3JpZ2luYWxVcmwpIT09bnVsbCYmZSE9PXZvaWQgMD9lOnRoaXMudXJsLCF0aGlzLmdlbmVyYXRlTWlwTWFwcyx0aGlzLmludmVydFksbnVsbCx0aGlzLnNhbXBsaW5nTW9kZSxpPT57aS5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITB9LG51bGwsdGhpcy5fYnVmZmVyLHZvaWQgMCx0aGlzLmZvcm1hdCx0aGlzLl9leHRlbnNpb24sdm9pZCAwLHZvaWQgMCx2b2lkIDAsdGhpcy5fdXNlU1JHQkJ1ZmZlcik7cmV0dXJuO2Nhc2UgTmUuUmF3OnQ9dGhpcy5fZW5naW5lLmNyZWF0ZVJhd1RleHR1cmUodGhpcy5fYnVmZmVyVmlldyx0aGlzLmJhc2VXaWR0aCx0aGlzLmJhc2VIZWlnaHQsdGhpcy5mb3JtYXQsdGhpcy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5pbnZlcnRZLHRoaXMuc2FtcGxpbmdNb2RlLHRoaXMuX2NvbXByZXNzaW9uLHRoaXMudHlwZSx2b2lkIDAsdGhpcy5fdXNlU1JHQkJ1ZmZlciksdC5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITA7YnJlYWs7Y2FzZSBOZS5SYXczRDp0PXRoaXMuX2VuZ2luZS5jcmVhdGVSYXdUZXh0dXJlM0QodGhpcy5fYnVmZmVyVmlldyx0aGlzLmJhc2VXaWR0aCx0aGlzLmJhc2VIZWlnaHQsdGhpcy5iYXNlRGVwdGgsdGhpcy5mb3JtYXQsdGhpcy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5pbnZlcnRZLHRoaXMuc2FtcGxpbmdNb2RlLHRoaXMuX2NvbXByZXNzaW9uLHRoaXMudHlwZSksdC5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITA7YnJlYWs7Y2FzZSBOZS5SYXcyREFycmF5OnQ9dGhpcy5fZW5naW5lLmNyZWF0ZVJhd1RleHR1cmUyREFycmF5KHRoaXMuX2J1ZmZlclZpZXcsdGhpcy5iYXNlV2lkdGgsdGhpcy5iYXNlSGVpZ2h0LHRoaXMuYmFzZURlcHRoLHRoaXMuZm9ybWF0LHRoaXMuZ2VuZXJhdGVNaXBNYXBzLHRoaXMuaW52ZXJ0WSx0aGlzLnNhbXBsaW5nTW9kZSx0aGlzLl9jb21wcmVzc2lvbix0aGlzLnR5cGUpLHQuX3N3YXBBbmREaWUodGhpcywhMSksdGhpcy5pc1JlYWR5PSEwO2JyZWFrO2Nhc2UgTmUuRHluYW1pYzp0PXRoaXMuX2VuZ2luZS5jcmVhdGVEeW5hbWljVGV4dHVyZSh0aGlzLmJhc2VXaWR0aCx0aGlzLmJhc2VIZWlnaHQsdGhpcy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5zYW1wbGluZ01vZGUpLHQuX3N3YXBBbmREaWUodGhpcywhMSksdGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNUZXh0dXJlKHRoaXMsdGhpcy5fZW5naW5lLmdldFJlbmRlcmluZ0NhbnZhcygpLHRoaXMuaW52ZXJ0WSx2b2lkIDAsdm9pZCAwLCEwKTticmVhaztjYXNlIE5lLkN1YmU6dD10aGlzLl9lbmdpbmUuY3JlYXRlQ3ViZVRleHR1cmUodGhpcy51cmwsbnVsbCx0aGlzLl9maWxlcywhdGhpcy5nZW5lcmF0ZU1pcE1hcHMsKCk9Pnt0Ll9zd2FwQW5kRGllKHRoaXMsITEpLHRoaXMuaXNSZWFkeT0hMH0sbnVsbCx0aGlzLmZvcm1hdCx0aGlzLl9leHRlbnNpb24sITEsMCwwLG51bGwsdm9pZCAwLHRoaXMuX3VzZVNSR0JCdWZmZXIpO3JldHVybjtjYXNlIE5lLkN1YmVSYXc6dD10aGlzLl9lbmdpbmUuY3JlYXRlUmF3Q3ViZVRleHR1cmUodGhpcy5fYnVmZmVyVmlld0FycmF5LHRoaXMud2lkdGgsdGhpcy5mb3JtYXQsdGhpcy50eXBlLHRoaXMuZ2VuZXJhdGVNaXBNYXBzLHRoaXMuaW52ZXJ0WSx0aGlzLnNhbXBsaW5nTW9kZSx0aGlzLl9jb21wcmVzc2lvbiksdC5fc3dhcEFuZERpZSh0aGlzLCExKSx0aGlzLmlzUmVhZHk9ITA7YnJlYWs7Y2FzZSBOZS5DdWJlUmF3UkdCRDpyZXR1cm47Y2FzZSBOZS5DdWJlUHJlZmlsdGVyZWQ6dD10aGlzLl9lbmdpbmUuY3JlYXRlUHJlZmlsdGVyZWRDdWJlVGV4dHVyZSh0aGlzLnVybCxudWxsLHRoaXMuX2xvZEdlbmVyYXRpb25TY2FsZSx0aGlzLl9sb2RHZW5lcmF0aW9uT2Zmc2V0LGk9PntpJiZpLl9zd2FwQW5kRGllKHRoaXMsITEpLHRoaXMuaXNSZWFkeT0hMH0sbnVsbCx0aGlzLmZvcm1hdCx0aGlzLl9leHRlbnNpb24pLHQuX3NwaGVyaWNhbFBvbHlub21pYWw9dGhpcy5fc3BoZXJpY2FsUG9seW5vbWlhbDtyZXR1cm59fV9zd2FwQW5kRGllKGUsdD0hMCl7dmFyIGk7KGk9dGhpcy5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fGk9PT12b2lkIDB8fGkuc2V0VXNhZ2UoZS5fc291cmNlLHRoaXMuZ2VuZXJhdGVNaXBNYXBzLHRoaXMuaXNDdWJlLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLGUuX2hhcmR3YXJlVGV4dHVyZT10aGlzLl9oYXJkd2FyZVRleHR1cmUsdCYmKGUuX2lzUkdCRD10aGlzLl9pc1JHQkQpLHRoaXMuX2xvZFRleHR1cmVIaWdoJiYoZS5fbG9kVGV4dHVyZUhpZ2gmJmUuX2xvZFRleHR1cmVIaWdoLmRpc3Bvc2UoKSxlLl9sb2RUZXh0dXJlSGlnaD10aGlzLl9sb2RUZXh0dXJlSGlnaCksdGhpcy5fbG9kVGV4dHVyZU1pZCYmKGUuX2xvZFRleHR1cmVNaWQmJmUuX2xvZFRleHR1cmVNaWQuZGlzcG9zZSgpLGUuX2xvZFRleHR1cmVNaWQ9dGhpcy5fbG9kVGV4dHVyZU1pZCksdGhpcy5fbG9kVGV4dHVyZUxvdyYmKGUuX2xvZFRleHR1cmVMb3cmJmUuX2xvZFRleHR1cmVMb3cuZGlzcG9zZSgpLGUuX2xvZFRleHR1cmVMb3c9dGhpcy5fbG9kVGV4dHVyZUxvdyksdGhpcy5faXJyYWRpYW5jZVRleHR1cmUmJihlLl9pcnJhZGlhbmNlVGV4dHVyZSYmZS5faXJyYWRpYW5jZVRleHR1cmUuZGlzcG9zZSgpLGUuX2lycmFkaWFuY2VUZXh0dXJlPXRoaXMuX2lycmFkaWFuY2VUZXh0dXJlKTtjb25zdCBzPXRoaXMuX2VuZ2luZS5nZXRMb2FkZWRUZXh0dXJlc0NhY2hlKCk7bGV0IHI9cy5pbmRleE9mKHRoaXMpO3IhPT0tMSYmcy5zcGxpY2UociwxKSxyPXMuaW5kZXhPZihlKSxyPT09LTEmJnMucHVzaChlKX1kaXNwb3NlKCl7dGhpcy5fcmVmZXJlbmNlcy0tLHRoaXMub25Mb2FkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkVycm9yT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX3JlZmVyZW5jZXM9PT0wJiYodGhpcy5fZW5naW5lLl9yZWxlYXNlVGV4dHVyZSh0aGlzKSx0aGlzLl9oYXJkd2FyZVRleHR1cmU9bnVsbCl9fU90Ll9Db3VudGVyPTA7ZnVuY3Rpb24gamUoKXtyZXR1cm4gdHlwZW9mIHdpbmRvdzwidSJ9ZnVuY3Rpb24gSnMoKXtyZXR1cm4gdHlwZW9mIG5hdmlnYXRvcjwidSJ9ZnVuY3Rpb24gQ2koKXtyZXR1cm4gdHlwZW9mIGRvY3VtZW50PCJ1In1mdW5jdGlvbiBncyhjKXtsZXQgZT0iIix0PWMuZmlyc3RDaGlsZDtmb3IoO3Q7KXQubm9kZVR5cGU9PT0zJiYoZSs9dC50ZXh0Q29udGVudCksdD10Lm5leHRTaWJsaW5nO3JldHVybiBlfWNvbnN0IHBzPXtJc1dpbmRvd09iamVjdEV4aXN0OmplLElzTmF2aWdhdG9yQXZhaWxhYmxlOkpzLElzRG9jdW1lbnRBdmFpbGFibGU6Q2ksR2V0RE9NVGV4dENvbnRlbnQ6Z3N9O2Z1bmN0aW9uICQoYyl7cmV0dXJuYCR7Y30gbmVlZHMgdG8gYmUgaW1wb3J0ZWQgYmVmb3JlIGFzIGl0IGNvbnRhaW5zIGEgc2lkZS1lZmZlY3QgcmVxdWlyZWQgYnkgeW91ciBjb2RlLmB9Y2xhc3MgT3tzdGF0aWMgX0NoZWNrTGltaXQoZSx0KXtsZXQgaT1PLl9Mb2dMaW1pdE91dHB1dHNbZV07cmV0dXJuIGk/aS5jdXJyZW50Kys6KGk9e2xpbWl0OnQsY3VycmVudDoxfSxPLl9Mb2dMaW1pdE91dHB1dHNbZV09aSksaS5jdXJyZW50PD1pLmxpbWl0fXN0YXRpYyBfR2VuZXJhdGVMaW1pdE1lc3NhZ2UoZSx0PTEpe3ZhciBpO2NvbnN0IHM9Ty5fTG9nTGltaXRPdXRwdXRzW2VdO2lmKCFzfHwhTy5NZXNzYWdlTGltaXRSZWFjaGVkKXJldHVybjtjb25zdCByPXRoaXMuX0xldmVsc1t0XTtzLmN1cnJlbnQ9PT1zLmxpbWl0JiZPW3IubmFtZV0oTy5NZXNzYWdlTGltaXRSZWFjaGVkLnJlcGxhY2UoLyVMSU1JVCUvZywiIitzLmxpbWl0KS5yZXBsYWNlKC8lVFlQRSUvZywoaT1yLm5hbWUpIT09bnVsbCYmaSE9PXZvaWQgMD9pOiIiKSl9c3RhdGljIF9BZGRMb2dFbnRyeShlKXtPLl9Mb2dDYWNoZT1lK08uX0xvZ0NhY2hlLE8uT25OZXdDYWNoZUVudHJ5JiZPLk9uTmV3Q2FjaGVFbnRyeShlKX1zdGF0aWMgX0Zvcm1hdE1lc3NhZ2UoZSl7Y29uc3QgdD1zPT5zPDEwPyIwIitzOiIiK3MsaT1uZXcgRGF0ZTtyZXR1cm4iWyIrdChpLmdldEhvdXJzKCkpKyI6Iit0KGkuZ2V0TWludXRlcygpKSsiOiIrdChpLmdldFNlY29uZHMoKSkrIl06ICIrZX1zdGF0aWMgX0xvZ0Rpc2FibGVkKGUsdCl7fXN0YXRpYyBfTG9nRW5hYmxlZChlPTEsdCxpKXtpZihpIT09dm9pZCAwJiYhTy5fQ2hlY2tMaW1pdCh0LGkpKXJldHVybjtjb25zdCBzPU8uX0Zvcm1hdE1lc3NhZ2UodCkscj10aGlzLl9MZXZlbHNbZV07ci5sb2dGdW5jJiZyLmxvZ0Z1bmMoIkJKUyAtICIrcyk7Y29uc3Qgbj1gPGRpdiBzdHlsZT0nY29sb3I6JHtyLmNvbG9yfSc+JHtzfTwvZGl2Pjxicj5gO08uX0FkZExvZ0VudHJ5KG4pLE8uX0dlbmVyYXRlTGltaXRNZXNzYWdlKHQsZSl9c3RhdGljIGdldCBMb2dDYWNoZSgpe3JldHVybiBPLl9Mb2dDYWNoZX1zdGF0aWMgQ2xlYXJMb2dDYWNoZSgpe08uX0xvZ0NhY2hlPSIiLE8uX0xvZ0xpbWl0T3V0cHV0cz17fSxPLmVycm9yc0NvdW50PTB9c3RhdGljIHNldCBMb2dMZXZlbHMoZSl7Ty5Mb2c9Ty5fTG9nRGlzYWJsZWQsTy5XYXJuPU8uX0xvZ0Rpc2FibGVkLE8uRXJyb3I9Ty5fTG9nRGlzYWJsZWQsW08uTWVzc2FnZUxvZ0xldmVsLE8uV2FybmluZ0xvZ0xldmVsLE8uRXJyb3JMb2dMZXZlbF0uZm9yRWFjaCh0PT57aWYoKGUmdCk9PT10KXtjb25zdCBpPXRoaXMuX0xldmVsc1t0XTtPW2kubmFtZV09Ty5fTG9nRW5hYmxlZC5iaW5kKE8sdCl9fSl9fU8uTm9uZUxvZ0xldmVsPTAsTy5NZXNzYWdlTG9nTGV2ZWw9MSxPLldhcm5pbmdMb2dMZXZlbD0yLE8uRXJyb3JMb2dMZXZlbD00LE8uQWxsTG9nTGV2ZWw9NyxPLk1lc3NhZ2VMaW1pdFJlYWNoZWQ9IlRvbyBtYW55ICVUWVBFJXMgKCVMSU1JVCUpLCBubyBtb3JlICVUWVBFJXMgd2lsbCBiZSByZXBvcnRlZCBmb3IgdGhpcyBtZXNzYWdlLiIsTy5fTG9nQ2FjaGU9IiIsTy5fTG9nTGltaXRPdXRwdXRzPXt9LE8uX0xldmVscz1be30se2NvbG9yOiJ3aGl0ZSIsbG9nRnVuYzpjb25zb2xlLmxvZyxuYW1lOiJMb2cifSx7Y29sb3I6Im9yYW5nZSIsbG9nRnVuYzpjb25zb2xlLndhcm4sbmFtZToiV2FybiJ9LHt9LHtjb2xvcjoicmVkIixsb2dGdW5jOmNvbnNvbGUuZXJyb3IsbmFtZToiRXJyb3IifV0sTy5lcnJvcnNDb3VudD0wLE8uTG9nPU8uX0xvZ0VuYWJsZWQuYmluZChPLE8uTWVzc2FnZUxvZ0xldmVsKSxPLldhcm49Ty5fTG9nRW5hYmxlZC5iaW5kKE8sTy5XYXJuaW5nTG9nTGV2ZWwpLE8uRXJyb3I9Ty5fTG9nRW5hYmxlZC5iaW5kKE8sTy5FcnJvckxvZ0xldmVsKTtjb25zdCBxcj0iYXR0cmlidXRlIixqcj0idmFyeWluZyI7Y2xhc3MgSWl7Y29uc3RydWN0b3IoKXt0aGlzLmNoaWxkcmVuPVtdfWlzVmFsaWQoZSl7cmV0dXJuITB9cHJvY2VzcyhlLHQpe3ZhciBpLHMscixuLGEsbztsZXQgaD0iIjtpZih0aGlzLmxpbmUpe2xldCBsPXRoaXMubGluZTtjb25zdCB1PXQucHJvY2Vzc29yO2lmKHUpe3UubGluZVByb2Nlc3NvciYmKGw9dS5saW5lUHJvY2Vzc29yKGwsdC5pc0ZyYWdtZW50LHQucHJvY2Vzc2luZ0NvbnRleHQpKTtjb25zdCBkPShzPShpPXQucHJvY2Vzc29yKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmkuYXR0cmlidXRlS2V5d29yZE5hbWUpIT09bnVsbCYmcyE9PXZvaWQgMD9zOnFyLGY9dC5pc0ZyYWdtZW50JiYoISgocj10LnByb2Nlc3Nvcik9PT1udWxsfHxyPT09dm9pZCAwKSYmci52YXJ5aW5nRnJhZ21lbnRLZXl3b3JkTmFtZSk/KG49dC5wcm9jZXNzb3IpPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi52YXJ5aW5nRnJhZ21lbnRLZXl3b3JkTmFtZTohdC5pc0ZyYWdtZW50JiYoISgoYT10LnByb2Nlc3Nvcik9PT1udWxsfHxhPT09dm9pZCAwKSYmYS52YXJ5aW5nVmVydGV4S2V5d29yZE5hbWUpPyhvPXQucHJvY2Vzc29yKT09PW51bGx8fG89PT12b2lkIDA/dm9pZCAwOm8udmFyeWluZ1ZlcnRleEtleXdvcmROYW1lOmpyOyF0LmlzRnJhZ21lbnQmJnUuYXR0cmlidXRlUHJvY2Vzc29yJiZ0aGlzLmxpbmUuc3RhcnRzV2l0aChkKT9sPXUuYXR0cmlidXRlUHJvY2Vzc29yKHRoaXMubGluZSxlLHQucHJvY2Vzc2luZ0NvbnRleHQpOnUudmFyeWluZ1Byb2Nlc3NvciYmdGhpcy5saW5lLnN0YXJ0c1dpdGgoZik/bD11LnZhcnlpbmdQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCxlLHQucHJvY2Vzc2luZ0NvbnRleHQpOnUudW5pZm9ybVByb2Nlc3NvciYmdS51bmlmb3JtUmVnZXhwJiZ1LnVuaWZvcm1SZWdleHAudGVzdCh0aGlzLmxpbmUpP3QubG9va0ZvckNsb3NpbmdCcmFja2V0Rm9yVW5pZm9ybUJ1ZmZlcnx8KGw9dS51bmlmb3JtUHJvY2Vzc29yKHRoaXMubGluZSx0LmlzRnJhZ21lbnQsZSx0LnByb2Nlc3NpbmdDb250ZXh0KSk6dS51bmlmb3JtQnVmZmVyUHJvY2Vzc29yJiZ1LnVuaWZvcm1CdWZmZXJSZWdleHAmJnUudW5pZm9ybUJ1ZmZlclJlZ2V4cC50ZXN0KHRoaXMubGluZSk/dC5sb29rRm9yQ2xvc2luZ0JyYWNrZXRGb3JVbmlmb3JtQnVmZmVyfHwobD11LnVuaWZvcm1CdWZmZXJQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSx0Lmxvb2tGb3JDbG9zaW5nQnJhY2tldEZvclVuaWZvcm1CdWZmZXI9ITApOnUudGV4dHVyZVByb2Nlc3NvciYmdS50ZXh0dXJlUmVnZXhwJiZ1LnRleHR1cmVSZWdleHAudGVzdCh0aGlzLmxpbmUpP2w9dS50ZXh0dXJlUHJvY2Vzc29yKHRoaXMubGluZSx0LmlzRnJhZ21lbnQsZSx0LnByb2Nlc3NpbmdDb250ZXh0KToodS51bmlmb3JtUHJvY2Vzc29yfHx1LnVuaWZvcm1CdWZmZXJQcm9jZXNzb3IpJiZ0aGlzLmxpbmUuc3RhcnRzV2l0aCgidW5pZm9ybSIpJiYhdC5sb29rRm9yQ2xvc2luZ0JyYWNrZXRGb3JVbmlmb3JtQnVmZmVyJiYoL3VuaWZvcm1ccysoPzooPzpoaWdocCk/fCg/Omxvd3ApPylccyooXFMrKVxzKyhcUyspXHMqOy8udGVzdCh0aGlzLmxpbmUpP3UudW5pZm9ybVByb2Nlc3NvciYmKGw9dS51bmlmb3JtUHJvY2Vzc29yKHRoaXMubGluZSx0LmlzRnJhZ21lbnQsZSx0LnByb2Nlc3NpbmdDb250ZXh0KSk6dS51bmlmb3JtQnVmZmVyUHJvY2Vzc29yJiYobD11LnVuaWZvcm1CdWZmZXJQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSx0Lmxvb2tGb3JDbG9zaW5nQnJhY2tldEZvclVuaWZvcm1CdWZmZXI9ITApKSx0Lmxvb2tGb3JDbG9zaW5nQnJhY2tldEZvclVuaWZvcm1CdWZmZXImJnRoaXMubGluZS5pbmRleE9mKCJ9IikhPT0tMSYmKHQubG9va0ZvckNsb3NpbmdCcmFja2V0Rm9yVW5pZm9ybUJ1ZmZlcj0hMSx1LmVuZE9mVW5pZm9ybUJ1ZmZlclByb2Nlc3NvciYmKGw9dS5lbmRPZlVuaWZvcm1CdWZmZXJQcm9jZXNzb3IodGhpcy5saW5lLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSkpfWgrPWwrYFxyCmB9cmV0dXJuIHRoaXMuY2hpbGRyZW4uZm9yRWFjaChsPT57aCs9bC5wcm9jZXNzKGUsdCl9KSx0aGlzLmFkZGl0aW9uYWxEZWZpbmVLZXkmJihlW3RoaXMuYWRkaXRpb25hbERlZmluZUtleV09dGhpcy5hZGRpdGlvbmFsRGVmaW5lVmFsdWV8fCJ0cnVlIiksaH19Y2xhc3MgJHJ7Y29uc3RydWN0b3IoKXt0aGlzLl9saW5lcz1bXX1nZXQgY3VycmVudExpbmUoKXtyZXR1cm4gdGhpcy5fbGluZXNbdGhpcy5saW5lSW5kZXhdfWdldCBjYW5SZWFkKCl7cmV0dXJuIHRoaXMubGluZUluZGV4PHRoaXMuX2xpbmVzLmxlbmd0aC0xfXNldCBsaW5lcyhlKXt0aGlzLl9saW5lcy5sZW5ndGg9MDtmb3IoY29uc3QgdCBvZiBlKXtpZih0WzBdPT09IiMiKXt0aGlzLl9saW5lcy5wdXNoKHQpO2NvbnRpbnVlfWlmKHQudHJpbSgpLnN0YXJ0c1dpdGgoIi8vIikpe3RoaXMuX2xpbmVzLnB1c2godCk7Y29udGludWV9Y29uc3QgaT10LnNwbGl0KCI7Iik7Zm9yKGxldCBzPTA7czxpLmxlbmd0aDtzKyspe2xldCByPWlbc107cj1yLnRyaW0oKSxyJiZ0aGlzLl9saW5lcy5wdXNoKHIrKHMhPT1pLmxlbmd0aC0xPyI7IjoiIikpfX19fWNsYXNzIG1zIGV4dGVuZHMgSWl7cHJvY2VzcyhlLHQpe2ZvcihsZXQgaT0wO2k8dGhpcy5jaGlsZHJlbi5sZW5ndGg7aSsrKXtjb25zdCBzPXRoaXMuY2hpbGRyZW5baV07aWYocy5pc1ZhbGlkKGUpKXJldHVybiBzLnByb2Nlc3MoZSx0KX1yZXR1cm4iIn19Y2xhc3MgUXIgZXh0ZW5kcyBJaXtpc1ZhbGlkKGUpe3JldHVybiB0aGlzLnRlc3RFeHByZXNzaW9uLmlzVHJ1ZShlKX19Y2xhc3MgZXR7aXNUcnVlKGUpe3JldHVybiEwfXN0YXRpYyBwb3N0Zml4VG9JbmZpeChlKXtjb25zdCB0PVtdO2Zvcihjb25zdCBpIG9mIGUpaWYoZXQuX09wZXJhdG9yUHJpb3JpdHlbaV09PT12b2lkIDApdC5wdXNoKGkpO2Vsc2V7Y29uc3Qgcz10W3QubGVuZ3RoLTFdLHI9dFt0Lmxlbmd0aC0yXTt0Lmxlbmd0aC09Mix0LnB1c2goYCgke3J9JHtpfSR7c30pYCl9cmV0dXJuIHRbdC5sZW5ndGgtMV19c3RhdGljIGluZml4VG9Qb3N0Zml4KGUpe2NvbnN0IHQ9W107bGV0IGk9LTE7Y29uc3Qgcz0oKT0+e2g9aC50cmltKCksaCE9PSIiJiYodC5wdXNoKGgpLGg9IiIpfSxyPWw9PntpPGV0Ll9TdGFjay5sZW5ndGgtMSYmKGV0Ll9TdGFja1srK2ldPWwpfSxuPSgpPT5ldC5fU3RhY2tbaV0sYT0oKT0+aT09PS0xPyIhIUlOVkFMSUQgRVhQUkVTU0lPTiEhIjpldC5fU3RhY2tbaS0tXTtsZXQgbz0wLGg9IiI7Zm9yKDtvPGUubGVuZ3RoOyl7Y29uc3QgbD1lLmNoYXJBdChvKSx1PW88ZS5sZW5ndGgtMT9lLnN1YnN0cihvLDIpOiIiO2lmKGw9PT0iKCIpaD0iIixyKGwpO2Vsc2UgaWYobD09PSIpIil7Zm9yKHMoKTtpIT09LTEmJm4oKSE9PSIoIjspdC5wdXNoKGEoKSk7YSgpfWVsc2UgaWYoZXQuX09wZXJhdG9yUHJpb3JpdHlbdV0+MSl7Zm9yKHMoKTtpIT09LTEmJmV0Ll9PcGVyYXRvclByaW9yaXR5W24oKV0+PWV0Ll9PcGVyYXRvclByaW9yaXR5W3VdOyl0LnB1c2goYSgpKTtyKHUpLG8rK31lbHNlIGgrPWw7bysrfWZvcihzKCk7aSE9PS0xOyluKCk9PT0iKCI/YSgpOnQucHVzaChhKCkpO3JldHVybiB0fX1ldC5fT3BlcmF0b3JQcmlvcml0eT17IikiOjAsIigiOjEsInx8IjoyLCImJiI6M30sZXQuX1N0YWNrPVsiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIiwiIl07Y2xhc3MgR2kgZXh0ZW5kcyBldHtjb25zdHJ1Y3RvcihlLHQ9ITEpe3N1cGVyKCksdGhpcy5kZWZpbmU9ZSx0aGlzLm5vdD10fWlzVHJ1ZShlKXtsZXQgdD1lW3RoaXMuZGVmaW5lXSE9PXZvaWQgMDtyZXR1cm4gdGhpcy5ub3QmJih0PSF0KSx0fX1jbGFzcyBKciBleHRlbmRzIGV0e2lzVHJ1ZShlKXtyZXR1cm4gdGhpcy5sZWZ0T3BlcmFuZC5pc1RydWUoZSl8fHRoaXMucmlnaHRPcGVyYW5kLmlzVHJ1ZShlKX19Y2xhc3MgZW4gZXh0ZW5kcyBldHtpc1RydWUoZSl7cmV0dXJuIHRoaXMubGVmdE9wZXJhbmQuaXNUcnVlKGUpJiZ0aGlzLnJpZ2h0T3BlcmFuZC5pc1RydWUoZSl9fWNsYXNzIHRuIGV4dGVuZHMgZXR7Y29uc3RydWN0b3IoZSx0LGkpe3N1cGVyKCksdGhpcy5kZWZpbmU9ZSx0aGlzLm9wZXJhbmQ9dCx0aGlzLnRlc3RWYWx1ZT1pfWlzVHJ1ZShlKXtsZXQgdD1lW3RoaXMuZGVmaW5lXTt0PT09dm9pZCAwJiYodD10aGlzLmRlZmluZSk7bGV0IGk9ITE7Y29uc3Qgcz1wYXJzZUludCh0KSxyPXBhcnNlSW50KHRoaXMudGVzdFZhbHVlKTtzd2l0Y2godGhpcy5vcGVyYW5kKXtjYXNlIj4iOmk9cz5yO2JyZWFrO2Nhc2UiPCI6aT1zPHI7YnJlYWs7Y2FzZSI8PSI6aT1zPD1yO2JyZWFrO2Nhc2UiPj0iOmk9cz49cjticmVhaztjYXNlIj09IjppPXM9PT1yO2JyZWFrfXJldHVybiBpfX12YXIgWmU7KGZ1bmN0aW9uKGMpe2NbYy5HTFNMPTBdPSJHTFNMIixjW2MuV0dTTD0xXT0iV0dTTCJ9KShaZXx8KFplPXt9KSk7Y29uc3Qgc249L2RlZmluZWRccyo/XCgoLis/KVwpL2csRXM9L2RlZmluZWRccyo/XFsoLis/KVxdL2csZXI9LyNpbmNsdWRlXHM/PCguKyk+KFwoKC4qKVwpKSooXFsoLiopXF0pKi9nO2NsYXNzIG5pe3N0YXRpYyBJbml0aWFsaXplKGUpe2UucHJvY2Vzc29yJiZlLnByb2Nlc3Nvci5pbml0aWFsaXplU2hhZGVycyYmZS5wcm9jZXNzb3IuaW5pdGlhbGl6ZVNoYWRlcnMoZS5wcm9jZXNzaW5nQ29udGV4dCl9c3RhdGljIFByb2Nlc3MoZSx0LGkscyl7dmFyIHI7ISgocj10LnByb2Nlc3Nvcik9PT1udWxsfHxyPT09dm9pZCAwKSYmci5wcmVQcm9jZXNzU2hhZGVyQ29kZSYmKGU9dC5wcm9jZXNzb3IucHJlUHJvY2Vzc1NoYWRlckNvZGUoZSx0LmlzRnJhZ21lbnQpKSx0aGlzLl9Qcm9jZXNzSW5jbHVkZXMoZSx0LG49Pnt0LnByb2Nlc3NDb2RlQWZ0ZXJJbmNsdWRlcyYmKG49dC5wcm9jZXNzQ29kZUFmdGVySW5jbHVkZXModC5pc0ZyYWdtZW50PyJmcmFnbWVudCI6InZlcnRleCIsbikpO2NvbnN0IGE9dGhpcy5fUHJvY2Vzc1NoYWRlckNvbnZlcnNpb24obix0LHMpO2koYSxuKX0pfXN0YXRpYyBQcmVQcm9jZXNzKGUsdCxpLHMpe3ZhciByOyEoKHI9dC5wcm9jZXNzb3IpPT09bnVsbHx8cj09PXZvaWQgMCkmJnIucHJlUHJvY2Vzc1NoYWRlckNvZGUmJihlPXQucHJvY2Vzc29yLnByZVByb2Nlc3NTaGFkZXJDb2RlKGUsdC5pc0ZyYWdtZW50KSksdGhpcy5fUHJvY2Vzc0luY2x1ZGVzKGUsdCxuPT57dC5wcm9jZXNzQ29kZUFmdGVySW5jbHVkZXMmJihuPXQucHJvY2Vzc0NvZGVBZnRlckluY2x1ZGVzKHQuaXNGcmFnbWVudD8iZnJhZ21lbnQiOiJ2ZXJ0ZXgiLG4pKTtjb25zdCBhPXRoaXMuX0FwcGx5UHJlUHJvY2Vzc2luZyhuLHQscyk7aShhLG4pfSl9c3RhdGljIEZpbmFsaXplKGUsdCxpKXtyZXR1cm4haS5wcm9jZXNzb3J8fCFpLnByb2Nlc3Nvci5maW5hbGl6ZVNoYWRlcnM/e3ZlcnRleENvZGU6ZSxmcmFnbWVudENvZGU6dH06aS5wcm9jZXNzb3IuZmluYWxpemVTaGFkZXJzKGUsdCxpLnByb2Nlc3NpbmdDb250ZXh0KX1zdGF0aWMgX1Byb2Nlc3NQcmVjaXNpb24oZSx0KXt2YXIgaTtpZighKChpPXQucHJvY2Vzc29yKT09PW51bGx8fGk9PT12b2lkIDApJiZpLm5vUHJlY2lzaW9uKXJldHVybiBlO2NvbnN0IHM9dC5zaG91bGRVc2VIaWdoUHJlY2lzaW9uU2hhZGVyO3JldHVybiBlLmluZGV4T2YoInByZWNpc2lvbiBoaWdocCBmbG9hdCIpPT09LTE/cz9lPWBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CmArZTplPWBwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKYCtlOnN8fChlPWUucmVwbGFjZSgicHJlY2lzaW9uIGhpZ2hwIGZsb2F0IiwicHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQiKSksZX1zdGF0aWMgX0V4dHJhY3RPcGVyYXRpb24oZSl7Y29uc3QgaT0vZGVmaW5lZFwoKC4rKVwpLy5leGVjKGUpO2lmKGkmJmkubGVuZ3RoKXJldHVybiBuZXcgR2koaVsxXS50cmltKCksZVswXT09PSIhIik7Y29uc3Qgcz1bIj09IiwiPj0iLCI8PSIsIjwiLCI+Il07bGV0IHI9IiIsbj0wO2ZvcihyIG9mIHMpaWYobj1lLmluZGV4T2Yociksbj4tMSlicmVhaztpZihuPT09LTEpcmV0dXJuIG5ldyBHaShlKTtjb25zdCBhPWUuc3Vic3RyaW5nKDAsbikudHJpbSgpLG89ZS5zdWJzdHJpbmcobityLmxlbmd0aCkudHJpbSgpO3JldHVybiBuZXcgdG4oYSxyLG8pfXN0YXRpYyBfQnVpbGRTdWJFeHByZXNzaW9uKGUpe2U9ZS5yZXBsYWNlKHNuLCJkZWZpbmVkWyQxXSIpO2NvbnN0IHQ9ZXQuaW5maXhUb1Bvc3RmaXgoZSksaT1bXTtmb3IoY29uc3QgciBvZiB0KWlmKHIhPT0ifHwiJiZyIT09IiYmIilpLnB1c2gocik7ZWxzZSBpZihpLmxlbmd0aD49Mil7bGV0IG49aVtpLmxlbmd0aC0xXSxhPWlbaS5sZW5ndGgtMl07aS5sZW5ndGgtPTI7Y29uc3Qgbz1yPT0iJiYiP25ldyBlbjpuZXcgSnI7dHlwZW9mIG49PSJzdHJpbmciJiYobj1uLnJlcGxhY2UoRXMsImRlZmluZWQoJDEpIikpLHR5cGVvZiBhPT0ic3RyaW5nIiYmKGE9YS5yZXBsYWNlKEVzLCJkZWZpbmVkKCQxKSIpKSxvLmxlZnRPcGVyYW5kPXR5cGVvZiBhPT0ic3RyaW5nIj90aGlzLl9FeHRyYWN0T3BlcmF0aW9uKGEpOmEsby5yaWdodE9wZXJhbmQ9dHlwZW9mIG49PSJzdHJpbmciP3RoaXMuX0V4dHJhY3RPcGVyYXRpb24obik6bixpLnB1c2gobyl9bGV0IHM9aVtpLmxlbmd0aC0xXTtyZXR1cm4gdHlwZW9mIHM9PSJzdHJpbmciJiYocz1zLnJlcGxhY2UoRXMsImRlZmluZWQoJDEpIikpLHR5cGVvZiBzPT0ic3RyaW5nIj90aGlzLl9FeHRyYWN0T3BlcmF0aW9uKHMpOnN9c3RhdGljIF9CdWlsZEV4cHJlc3Npb24oZSx0KXtjb25zdCBpPW5ldyBRcixzPWUuc3Vic3RyaW5nKDAsdCk7bGV0IHI9ZS5zdWJzdHJpbmcodCk7cmV0dXJuIHI9ci5zdWJzdHJpbmcoMCwoci5pbmRleE9mKCIvLyIpKzF8fHIubGVuZ3RoKzEpLTEpLnRyaW0oKSxzPT09IiNpZmRlZiI/aS50ZXN0RXhwcmVzc2lvbj1uZXcgR2kocik6cz09PSIjaWZuZGVmIj9pLnRlc3RFeHByZXNzaW9uPW5ldyBHaShyLCEwKTppLnRlc3RFeHByZXNzaW9uPXRoaXMuX0J1aWxkU3ViRXhwcmVzc2lvbihyKSxpfXN0YXRpYyBfTW92ZUN1cnNvcldpdGhpbklmKGUsdCxpKXtsZXQgcz1lLmN1cnJlbnRMaW5lO2Zvcig7dGhpcy5fTW92ZUN1cnNvcihlLGkpOyl7cz1lLmN1cnJlbnRMaW5lO2NvbnN0IHI9cy5zdWJzdHJpbmcoMCw1KS50b0xvd2VyQ2FzZSgpO2lmKHI9PT0iI2Vsc2UiKXtjb25zdCBuPW5ldyBJaTt0LmNoaWxkcmVuLnB1c2gobiksdGhpcy5fTW92ZUN1cnNvcihlLG4pO3JldHVybn1lbHNlIGlmKHI9PT0iI2VsaWYiKXtjb25zdCBuPXRoaXMuX0J1aWxkRXhwcmVzc2lvbihzLDUpO3QuY2hpbGRyZW4ucHVzaChuKSxpPW59fX1zdGF0aWMgX01vdmVDdXJzb3IoZSx0KXtmb3IoO2UuY2FuUmVhZDspe2UubGluZUluZGV4Kys7Y29uc3QgaT1lLmN1cnJlbnRMaW5lLHI9LygjaWZkZWYpfCgjZWxzZSl8KCNlbGlmKXwoI2VuZGlmKXwoI2lmbmRlZil8KCNpZikvLmV4ZWMoaSk7aWYociYmci5sZW5ndGgpc3dpdGNoKHJbMF0pe2Nhc2UiI2lmZGVmIjp7Y29uc3QgYT1uZXcgbXM7dC5jaGlsZHJlbi5wdXNoKGEpO2NvbnN0IG89dGhpcy5fQnVpbGRFeHByZXNzaW9uKGksNik7YS5jaGlsZHJlbi5wdXNoKG8pLHRoaXMuX01vdmVDdXJzb3JXaXRoaW5JZihlLGEsbyk7YnJlYWt9Y2FzZSIjZWxzZSI6Y2FzZSIjZWxpZiI6cmV0dXJuITA7Y2FzZSIjZW5kaWYiOnJldHVybiExO2Nhc2UiI2lmbmRlZiI6e2NvbnN0IGE9bmV3IG1zO3QuY2hpbGRyZW4ucHVzaChhKTtjb25zdCBvPXRoaXMuX0J1aWxkRXhwcmVzc2lvbihpLDcpO2EuY2hpbGRyZW4ucHVzaChvKSx0aGlzLl9Nb3ZlQ3Vyc29yV2l0aGluSWYoZSxhLG8pO2JyZWFrfWNhc2UiI2lmIjp7Y29uc3QgYT1uZXcgbXMsbz10aGlzLl9CdWlsZEV4cHJlc3Npb24oaSwzKTt0LmNoaWxkcmVuLnB1c2goYSksYS5jaGlsZHJlbi5wdXNoKG8pLHRoaXMuX01vdmVDdXJzb3JXaXRoaW5JZihlLGEsbyk7YnJlYWt9fWVsc2V7Y29uc3Qgbj1uZXcgSWk7aWYobi5saW5lPWksdC5jaGlsZHJlbi5wdXNoKG4pLGlbMF09PT0iIyImJmlbMV09PT0iZCIpe2NvbnN0IGE9aS5yZXBsYWNlKCI7IiwiIikuc3BsaXQoIiAiKTtuLmFkZGl0aW9uYWxEZWZpbmVLZXk9YVsxXSxhLmxlbmd0aD09PTMmJihuLmFkZGl0aW9uYWxEZWZpbmVWYWx1ZT1hWzJdKX19fXJldHVybiExfXN0YXRpYyBfRXZhbHVhdGVQcmVQcm9jZXNzb3JzKGUsdCxpKXtjb25zdCBzPW5ldyBJaSxyPW5ldyAkcjtyZXR1cm4gci5saW5lSW5kZXg9LTEsci5saW5lcz1lLnNwbGl0KGAKYCksdGhpcy5fTW92ZUN1cnNvcihyLHMpLHMucHJvY2Vzcyh0LGkpfXN0YXRpYyBfUHJlcGFyZVByZVByb2Nlc3NvcnMoZSx0KXt2YXIgaTtjb25zdCBzPWUuZGVmaW5lcyxyPXt9O2Zvcihjb25zdCBuIG9mIHMpe2NvbnN0IG89bi5yZXBsYWNlKCIjZGVmaW5lIiwiIikucmVwbGFjZSgiOyIsIiIpLnRyaW0oKS5zcGxpdCgiICIpO3Jbb1swXV09by5sZW5ndGg+MT9vWzFdOiIifXJldHVybigoaT1lLnByb2Nlc3Nvcik9PT1udWxsfHxpPT09dm9pZCAwP3ZvaWQgMDppLnNoYWRlckxhbmd1YWdlKT09PVplLkdMU0wmJihyLkdMX0VTPSJ0cnVlIiksci5fX1ZFUlNJT05fXz1lLnZlcnNpb24scltlLnBsYXRmb3JtTmFtZV09InRydWUiLHQuX2dldEdsb2JhbERlZmluZXMocikscn1zdGF0aWMgX1Byb2Nlc3NTaGFkZXJDb252ZXJzaW9uKGUsdCxpKXtsZXQgcz10aGlzLl9Qcm9jZXNzUHJlY2lzaW9uKGUsdCk7aWYoIXQucHJvY2Vzc29yfHx0LnByb2Nlc3Nvci5zaGFkZXJMYW5ndWFnZT09PVplLkdMU0wmJnMuaW5kZXhPZigiI3ZlcnNpb24gMyIpIT09LTEmJihzPXMucmVwbGFjZSgiI3ZlcnNpb24gMzAwIGVzIiwiIiksIXQucHJvY2Vzc29yLnBhcnNlR0xFUzMpKXJldHVybiBzO2NvbnN0IHI9dC5kZWZpbmVzLG49dGhpcy5fUHJlcGFyZVByZVByb2Nlc3NvcnModCxpKTtyZXR1cm4gdC5wcm9jZXNzb3IucHJlUHJvY2Vzc29yJiYocz10LnByb2Nlc3Nvci5wcmVQcm9jZXNzb3IocyxyLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0KSkscz10aGlzLl9FdmFsdWF0ZVByZVByb2Nlc3NvcnMocyxuLHQpLHQucHJvY2Vzc29yLnBvc3RQcm9jZXNzb3ImJihzPXQucHJvY2Vzc29yLnBvc3RQcm9jZXNzb3IocyxyLHQuaXNGcmFnbWVudCx0LnByb2Nlc3NpbmdDb250ZXh0LGkpKSxpLl9mZWF0dXJlcy5uZWVkU2hhZGVyQ29kZUlubGluaW5nJiYocz1pLmlubGluZVNoYWRlckNvZGUocykpLHN9c3RhdGljIF9BcHBseVByZVByb2Nlc3NpbmcoZSx0LGkpe3ZhciBzLHI7bGV0IG49ZTtjb25zdCBhPXQuZGVmaW5lcyxvPXRoaXMuX1ByZXBhcmVQcmVQcm9jZXNzb3JzKHQsaSk7cmV0dXJuISgocz10LnByb2Nlc3Nvcik9PT1udWxsfHxzPT09dm9pZCAwKSYmcy5wcmVQcm9jZXNzb3ImJihuPXQucHJvY2Vzc29yLnByZVByb2Nlc3NvcihuLGEsdC5pc0ZyYWdtZW50LHQucHJvY2Vzc2luZ0NvbnRleHQpKSxuPXRoaXMuX0V2YWx1YXRlUHJlUHJvY2Vzc29ycyhuLG8sdCksISgocj10LnByb2Nlc3Nvcik9PT1udWxsfHxyPT09dm9pZCAwKSYmci5wb3N0UHJvY2Vzc29yJiYobj10LnByb2Nlc3Nvci5wb3N0UHJvY2Vzc29yKG4sYSx0LmlzRnJhZ21lbnQsdC5wcm9jZXNzaW5nQ29udGV4dCxpKSksaS5fZmVhdHVyZXMubmVlZFNoYWRlckNvZGVJbmxpbmluZyYmKG49aS5pbmxpbmVTaGFkZXJDb2RlKG4pKSxufXN0YXRpYyBfUHJvY2Vzc0luY2x1ZGVzKGUsdCxpKXtsZXQgcz1lci5leGVjKGUpLHI9bmV3IFN0cmluZyhlKSxuPSExO2Zvcig7cyE9bnVsbDspe2xldCBhPXNbMV07aWYoYS5pbmRleE9mKCJfX2RlY2xfXyIpIT09LTEmJihhPWEucmVwbGFjZSgvX19kZWNsX18vLCIiKSx0LnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMmJihhPWEucmVwbGFjZSgvVmVydGV4LywiVWJvIiksYT1hLnJlcGxhY2UoL0ZyYWdtZW50LywiVWJvIikpLGE9YSsiRGVjbGFyYXRpb24iKSx0LmluY2x1ZGVzU2hhZGVyc1N0b3JlW2FdKXtsZXQgbz10LmluY2x1ZGVzU2hhZGVyc1N0b3JlW2FdO2lmKHNbMl0pe2NvbnN0IGg9c1szXS5zcGxpdCgiLCIpO2ZvcihsZXQgbD0wO2w8aC5sZW5ndGg7bCs9Mil7Y29uc3QgdT1uZXcgUmVnRXhwKGhbbF0sImciKSxkPWhbbCsxXTtvPW8ucmVwbGFjZSh1LGQpfX1pZihzWzRdKXtjb25zdCBoPXNbNV07aWYoaC5pbmRleE9mKCIuLiIpIT09LTEpe2NvbnN0IGw9aC5zcGxpdCgiLi4iKSx1PXBhcnNlSW50KGxbMF0pO2xldCBkPXBhcnNlSW50KGxbMV0pLGY9by5zbGljZSgwKTtvPSIiLGlzTmFOKGQpJiYoZD10LmluZGV4UGFyYW1ldGVyc1tsWzFdXSk7Zm9yKGxldCBfPXU7XzxkO18rKyl0LnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnN8fChmPWYucmVwbGFjZSgvbGlnaHRce1hcfS4oXHcqKS9nLChFLG0pPT5tKyJ7WH0iKSksbys9Zi5yZXBsYWNlKC9ce1hcfS9nLF8udG9TdHJpbmcoKSkrYApgfWVsc2UgdC5zdXBwb3J0c1VuaWZvcm1CdWZmZXJzfHwobz1vLnJlcGxhY2UoL2xpZ2h0XHtYXH0uKFx3KikvZywobCx1KT0+dSsie1h9IikpLG89by5yZXBsYWNlKC9ce1hcfS9nLGgpfXI9ci5yZXBsYWNlKHNbMF0sbyksbj1ufHxvLmluZGV4T2YoIiNpbmNsdWRlPCIpPj0wfHxvLmluZGV4T2YoIiNpbmNsdWRlIDwiKT49MH1lbHNle2NvbnN0IG89dC5zaGFkZXJzUmVwb3NpdG9yeSsiU2hhZGVyc0luY2x1ZGUvIithKyIuZngiO25pLl9GaWxlVG9vbHNMb2FkRmlsZShvLGg9Pnt0LmluY2x1ZGVzU2hhZGVyc1N0b3JlW2FdPWgsdGhpcy5fUHJvY2Vzc0luY2x1ZGVzKHIsdCxpKX0pO3JldHVybn1zPWVyLmV4ZWMoZSl9bj90aGlzLl9Qcm9jZXNzSW5jbHVkZXMoci50b1N0cmluZygpLHQsaSk6aShyKX1zdGF0aWMgX0ZpbGVUb29sc0xvYWRGaWxlKGUsdCxpLHMscixuKXt0aHJvdyAkKCJGaWxlVG9vbHMiKX19Y2xhc3MgVXtzdGF0aWMgR2V0U2hhZGVyc1JlcG9zaXRvcnkoZT1aZS5HTFNMKXtyZXR1cm4gZT09PVplLkdMU0w/VS5TaGFkZXJzUmVwb3NpdG9yeTpVLlNoYWRlcnNSZXBvc2l0b3J5V0dTTH1zdGF0aWMgR2V0U2hhZGVyc1N0b3JlKGU9WmUuR0xTTCl7cmV0dXJuIGU9PT1aZS5HTFNMP1UuU2hhZGVyc1N0b3JlOlUuU2hhZGVyc1N0b3JlV0dTTH1zdGF0aWMgR2V0SW5jbHVkZXNTaGFkZXJzU3RvcmUoZT1aZS5HTFNMKXtyZXR1cm4gZT09PVplLkdMU0w/VS5JbmNsdWRlc1NoYWRlcnNTdG9yZTpVLkluY2x1ZGVzU2hhZGVyc1N0b3JlV0dTTH19VS5TaGFkZXJzUmVwb3NpdG9yeT0ic3JjL1NoYWRlcnMvIixVLlNoYWRlcnNTdG9yZT17fSxVLkluY2x1ZGVzU2hhZGVyc1N0b3JlPXt9LFUuU2hhZGVyc1JlcG9zaXRvcnlXR1NMPSJzcmMvU2hhZGVyc1dHU0wvIixVLlNoYWRlcnNTdG9yZVdHU0w9e30sVS5JbmNsdWRlc1NoYWRlcnNTdG9yZVdHU0w9e307Y2xhc3MgUGV7Y29uc3RydWN0b3IoZSx0LGkscz1udWxsLHIsbj1udWxsLGE9bnVsbCxvPW51bGwsaD1udWxsLGwsdT0iIixkPVplLkdMU0wpe3ZhciBmLF8sRTt0aGlzLm5hbWU9bnVsbCx0aGlzLmRlZmluZXM9IiIsdGhpcy5vbkNvbXBpbGVkPW51bGwsdGhpcy5vbkVycm9yPW51bGwsdGhpcy5vbkJpbmQ9bnVsbCx0aGlzLnVuaXF1ZUlkPTAsdGhpcy5vbkNvbXBpbGVPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25FcnJvck9ic2VydmFibGU9bmV3IEYsdGhpcy5fb25CaW5kT2JzZXJ2YWJsZT1udWxsLHRoaXMuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMSx0aGlzLl9mb3JjZVJlYmluZE9uTmV4dENhbGw9ITEsdGhpcy5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPW51bGwsdGhpcy5faXNEaXNwb3NlZD0hMSx0aGlzLl9ib25lc0NvbXB1dGF0aW9uRm9yY2VkVG9DUFU9ITEsdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lcz17fSx0aGlzLl9tdWx0aVRhcmdldD0hMSx0aGlzLl9zYW1wbGVycz17fSx0aGlzLl9pc1JlYWR5PSExLHRoaXMuX2NvbXBpbGF0aW9uRXJyb3I9IiIsdGhpcy5fYWxsRmFsbGJhY2tzUHJvY2Vzc2VkPSExLHRoaXMuX3VuaWZvcm1zPXt9LHRoaXMuX2tleT0iIix0aGlzLl9mYWxsYmFja3M9bnVsbCx0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlT3ZlcnJpZGU9IiIsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlT3ZlcnJpZGU9IiIsdGhpcy5fdHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5ncz1udWxsLHRoaXMuX3BpcGVsaW5lQ29udGV4dD1udWxsLHRoaXMuX3ZlcnRleFNvdXJjZUNvZGU9IiIsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlPSIiLHRoaXMuX3ZlcnRleFNvdXJjZUNvZGVCZWZvcmVNaWdyYXRpb249IiIsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9uPSIiLHRoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGU9IiIsdGhpcy5fcmF3RnJhZ21lbnRTb3VyY2VDb2RlPSIiLHRoaXMubmFtZT1lLHRoaXMuX2tleT11O2xldCBtLHY9bnVsbDtpZih0LmF0dHJpYnV0ZXMpe2NvbnN0IGs9dDtpZih0aGlzLl9lbmdpbmU9aSx0aGlzLl9hdHRyaWJ1dGVzTmFtZXM9ay5hdHRyaWJ1dGVzLHRoaXMuX3VuaWZvcm1zTmFtZXM9ay51bmlmb3Jtc05hbWVzLmNvbmNhdChrLnNhbXBsZXJzKSx0aGlzLl9zYW1wbGVyTGlzdD1rLnNhbXBsZXJzLnNsaWNlKCksdGhpcy5kZWZpbmVzPWsuZGVmaW5lcyx0aGlzLm9uRXJyb3I9ay5vbkVycm9yLHRoaXMub25Db21waWxlZD1rLm9uQ29tcGlsZWQsdGhpcy5fZmFsbGJhY2tzPWsuZmFsbGJhY2tzLHRoaXMuX2luZGV4UGFyYW1ldGVycz1rLmluZGV4UGFyYW1ldGVycyx0aGlzLl90cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzPWsudHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5nc3x8bnVsbCx0aGlzLl9tdWx0aVRhcmdldD0hIWsubXVsdGlUYXJnZXQsdGhpcy5fc2hhZGVyTGFuZ3VhZ2U9KGY9ay5zaGFkZXJMYW5ndWFnZSkhPT1udWxsJiZmIT09dm9pZCAwP2Y6WmUuR0xTTCxrLnVuaWZvcm1CdWZmZXJzTmFtZXMpe3RoaXMuX3VuaWZvcm1CdWZmZXJzTmFtZXNMaXN0PWsudW5pZm9ybUJ1ZmZlcnNOYW1lcy5zbGljZSgpO2ZvcihsZXQgdz0wO3c8ay51bmlmb3JtQnVmZmVyc05hbWVzLmxlbmd0aDt3KyspdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lc1trLnVuaWZvcm1CdWZmZXJzTmFtZXNbd11dPXd9dj0oXz1rLnByb2Nlc3NGaW5hbENvZGUpIT09bnVsbCYmXyE9PXZvaWQgMD9fOm51bGwsbT0oRT1rLnByb2Nlc3NDb2RlQWZ0ZXJJbmNsdWRlcykhPT1udWxsJiZFIT09dm9pZCAwP0U6dm9pZCAwfWVsc2UgdGhpcy5fZW5naW5lPXIsdGhpcy5kZWZpbmVzPW4/PyIiLHRoaXMuX3VuaWZvcm1zTmFtZXM9aS5jb25jYXQocyksdGhpcy5fc2FtcGxlckxpc3Q9cz9zLnNsaWNlKCk6W10sdGhpcy5fYXR0cmlidXRlc05hbWVzPXQsdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lc0xpc3Q9W10sdGhpcy5fc2hhZGVyTGFuZ3VhZ2U9ZCx0aGlzLm9uRXJyb3I9aCx0aGlzLm9uQ29tcGlsZWQ9byx0aGlzLl9pbmRleFBhcmFtZXRlcnM9bCx0aGlzLl9mYWxsYmFja3M9YTt0aGlzLl9hdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZT17fSx0aGlzLnVuaXF1ZUlkPVBlLl9VbmlxdWVJZFNlZWQrKztsZXQgUyx5O2NvbnN0IEE9amUoKT90aGlzLl9lbmdpbmUuZ2V0SG9zdERvY3VtZW50KCk6bnVsbDtlLnZlcnRleFNvdXJjZT9TPSJzb3VyY2U6IitlLnZlcnRleFNvdXJjZTplLnZlcnRleEVsZW1lbnQ/KFM9QT9BLmdldEVsZW1lbnRCeUlkKGUudmVydGV4RWxlbWVudCk6bnVsbCxTfHwoUz1lLnZlcnRleEVsZW1lbnQpKTpTPWUudmVydGV4fHxlLGUuZnJhZ21lbnRTb3VyY2U/eT0ic291cmNlOiIrZS5mcmFnbWVudFNvdXJjZTplLmZyYWdtZW50RWxlbWVudD8oeT1BP0EuZ2V0RWxlbWVudEJ5SWQoZS5mcmFnbWVudEVsZW1lbnQpOm51bGwseXx8KHk9ZS5mcmFnbWVudEVsZW1lbnQpKTp5PWUuZnJhZ21lbnR8fGUsdGhpcy5fcHJvY2Vzc2luZ0NvbnRleHQ9dGhpcy5fZW5naW5lLl9nZXRTaGFkZXJQcm9jZXNzaW5nQ29udGV4dCh0aGlzLl9zaGFkZXJMYW5ndWFnZSk7bGV0IEM9e2RlZmluZXM6dGhpcy5kZWZpbmVzLnNwbGl0KGAKYCksaW5kZXhQYXJhbWV0ZXJzOnRoaXMuX2luZGV4UGFyYW1ldGVycyxpc0ZyYWdtZW50OiExLHNob3VsZFVzZUhpZ2hQcmVjaXNpb25TaGFkZXI6dGhpcy5fZW5naW5lLl9zaG91bGRVc2VIaWdoUHJlY2lzaW9uU2hhZGVyLHByb2Nlc3Nvcjp0aGlzLl9lbmdpbmUuX2dldFNoYWRlclByb2Nlc3Nvcih0aGlzLl9zaGFkZXJMYW5ndWFnZSksc3VwcG9ydHNVbmlmb3JtQnVmZmVyczp0aGlzLl9lbmdpbmUuc3VwcG9ydHNVbmlmb3JtQnVmZmVycyxzaGFkZXJzUmVwb3NpdG9yeTpVLkdldFNoYWRlcnNSZXBvc2l0b3J5KHRoaXMuX3NoYWRlckxhbmd1YWdlKSxpbmNsdWRlc1NoYWRlcnNTdG9yZTpVLkdldEluY2x1ZGVzU2hhZGVyc1N0b3JlKHRoaXMuX3NoYWRlckxhbmd1YWdlKSx2ZXJzaW9uOih0aGlzLl9lbmdpbmUudmVyc2lvbioxMDApLnRvU3RyaW5nKCkscGxhdGZvcm1OYW1lOnRoaXMuX2VuZ2luZS5zaGFkZXJQbGF0Zm9ybU5hbWUscHJvY2Vzc2luZ0NvbnRleHQ6dGhpcy5fcHJvY2Vzc2luZ0NvbnRleHQsaXNORENIYWxmWlJhbmdlOnRoaXMuX2VuZ2luZS5pc05EQ0hhbGZaUmFuZ2UsdXNlUmV2ZXJzZURlcHRoQnVmZmVyOnRoaXMuX2VuZ2luZS51c2VSZXZlcnNlRGVwdGhCdWZmZXIscHJvY2Vzc0NvZGVBZnRlckluY2x1ZGVzOm19O2NvbnN0IGI9W3ZvaWQgMCx2b2lkIDBdLE09KCk9PntpZihiWzBdJiZiWzFdKXtDLmlzRnJhZ21lbnQ9ITA7Y29uc3Rbayx3XT1iO25pLlByb2Nlc3ModyxDLChkZSxjZSk9Pnt0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVCZWZvcmVNaWdyYXRpb249Y2UsdiYmKGRlPXYoImZyYWdtZW50IixkZSkpO2NvbnN0IHNlPW5pLkZpbmFsaXplKGssZGUsQyk7dGhpcy5fdXNlRmluYWxDb2RlKHNlLnZlcnRleENvZGUsc2UuZnJhZ21lbnRDb2RlLGUpfSx0aGlzLl9lbmdpbmUpfX07dGhpcy5fbG9hZFNoYWRlcihTLCJWZXJ0ZXgiLCIiLGs9PntuaS5Jbml0aWFsaXplKEMpLG5pLlByb2Nlc3MoayxDLCh3LGRlKT0+e3RoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGU9ayx0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9uPWRlLHYmJih3PXYoInZlcnRleCIsdykpLGJbMF09dyxNKCl9LHRoaXMuX2VuZ2luZSl9KSx0aGlzLl9sb2FkU2hhZGVyKHksIkZyYWdtZW50IiwiUGl4ZWwiLGs9Pnt0aGlzLl9yYXdGcmFnbWVudFNvdXJjZUNvZGU9ayxiWzFdPWssTSgpfSksQz1udWxsO2NvbnN0IEw9ZnVuY3Rpb24oayl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BpcGVsaW5lQ29udGV4dCYmdGhpcy5fcGlwZWxpbmVDb250ZXh0W2tdLmFwcGx5KHRoaXMuX3BpcGVsaW5lQ29udGV4dCxhcmd1bWVudHMpLHRoaXN9fTtbIkludD8iLCJVSW50PyIsIkludEFycmF5PyIsIlVJbnRBcnJheT8iLCJBcnJheT8iLCJDb2xvcj8iLCJWZWN0b3I/IiwiRmxvYXQ/IiwiTWF0cmljZXMiLCJNYXRyaXgiLCJNYXRyaXgzeDMiLCJNYXRyaXgyeDIiLCJRdWF0ZXJuaW9uIiwiRGlyZWN0Q29sb3I0Il0uZm9yRWFjaChrPT57Y29uc3Qgdz1gc2V0JHtrfWA7dy5lbmRzV2l0aCgiPyIpP1siIiwyLDMsNF0uZm9yRWFjaChkZT0+e3RoaXNbdy5zbGljZSgwLC0xKStkZV09dGhpc1t3LnNsaWNlKDAsLTEpK2RlXXx8TCh3LnNsaWNlKDAsLTEpK2RlKS5iaW5kKHRoaXMpfSk6dGhpc1t3XT10aGlzW3ddfHxMKHcpLmJpbmQodGhpcyl9KX1zdGF0aWMgZ2V0IFNoYWRlcnNSZXBvc2l0b3J5KCl7cmV0dXJuIFUuU2hhZGVyc1JlcG9zaXRvcnl9c3RhdGljIHNldCBTaGFkZXJzUmVwb3NpdG9yeShlKXtVLlNoYWRlcnNSZXBvc2l0b3J5PWV9Z2V0IG9uQmluZE9ic2VydmFibGUoKXtyZXR1cm4gdGhpcy5fb25CaW5kT2JzZXJ2YWJsZXx8KHRoaXMuX29uQmluZE9ic2VydmFibGU9bmV3IEYpLHRoaXMuX29uQmluZE9ic2VydmFibGV9X3VzZUZpbmFsQ29kZShlLHQsaSl7aWYoaSl7Y29uc3Qgcz1pLnZlcnRleEVsZW1lbnR8fGkudmVydGV4fHxpLnNwZWN0b3JOYW1lfHxpLHI9aS5mcmFnbWVudEVsZW1lbnR8fGkuZnJhZ21lbnR8fGkuc3BlY3Rvck5hbWV8fGk7dGhpcy5fdmVydGV4U291cmNlQ29kZT0odGhpcy5fc2hhZGVyTGFuZ3VhZ2U9PT1aZS5XR1NMPyIvLyI6IiIpKyIjZGVmaW5lIFNIQURFUl9OQU1FIHZlcnRleDoiK3MrYApgK2UsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlPSh0aGlzLl9zaGFkZXJMYW5ndWFnZT09PVplLldHU0w/Ii8vIjoiIikrIiNkZWZpbmUgU0hBREVSX05BTUUgZnJhZ21lbnQ6IityK2AKYCt0fWVsc2UgdGhpcy5fdmVydGV4U291cmNlQ29kZT1lLHRoaXMuX2ZyYWdtZW50U291cmNlQ29kZT10O3RoaXMuX3ByZXBhcmVFZmZlY3QoKX1nZXQga2V5KCl7cmV0dXJuIHRoaXMuX2tleX1pc1JlYWR5KCl7dHJ5e3JldHVybiB0aGlzLl9pc1JlYWR5SW50ZXJuYWwoKX1jYXRjaHtyZXR1cm4hMX19X2lzUmVhZHlJbnRlcm5hbCgpe3JldHVybiB0aGlzLl9pc1JlYWR5PyEwOnRoaXMuX3BpcGVsaW5lQ29udGV4dD90aGlzLl9waXBlbGluZUNvbnRleHQuaXNSZWFkeTohMX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWdldFBpcGVsaW5lQ29udGV4dCgpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHR9Z2V0QXR0cmlidXRlc05hbWVzKCl7cmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXNOYW1lc31nZXRBdHRyaWJ1dGVMb2NhdGlvbihlKXtyZXR1cm4gdGhpcy5fYXR0cmlidXRlc1tlXX1nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShlKXtyZXR1cm4gdGhpcy5fYXR0cmlidXRlTG9jYXRpb25CeU5hbWVbZV19Z2V0QXR0cmlidXRlc0NvdW50KCl7cmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXMubGVuZ3RofWdldFVuaWZvcm1JbmRleChlKXtyZXR1cm4gdGhpcy5fdW5pZm9ybXNOYW1lcy5pbmRleE9mKGUpfWdldFVuaWZvcm0oZSl7cmV0dXJuIHRoaXMuX3VuaWZvcm1zW2VdfWdldFNhbXBsZXJzKCl7cmV0dXJuIHRoaXMuX3NhbXBsZXJMaXN0fWdldFVuaWZvcm1OYW1lcygpe3JldHVybiB0aGlzLl91bmlmb3Jtc05hbWVzfWdldFVuaWZvcm1CdWZmZXJzTmFtZXMoKXtyZXR1cm4gdGhpcy5fdW5pZm9ybUJ1ZmZlcnNOYW1lc0xpc3R9Z2V0SW5kZXhQYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX2luZGV4UGFyYW1ldGVyc31nZXRDb21waWxhdGlvbkVycm9yKCl7cmV0dXJuIHRoaXMuX2NvbXBpbGF0aW9uRXJyb3J9YWxsRmFsbGJhY2tzUHJvY2Vzc2VkKCl7cmV0dXJuIHRoaXMuX2FsbEZhbGxiYWNrc1Byb2Nlc3NlZH1leGVjdXRlV2hlbkNvbXBpbGVkKGUpe2lmKHRoaXMuaXNSZWFkeSgpKXtlKHRoaXMpO3JldHVybn10aGlzLm9uQ29tcGlsZU9ic2VydmFibGUuYWRkKHQ9PntlKHQpfSksKCF0aGlzLl9waXBlbGluZUNvbnRleHR8fHRoaXMuX3BpcGVsaW5lQ29udGV4dC5pc0FzeW5jKSYmc2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrSXNSZWFkeShudWxsKX0sMTYpfV9jaGVja0lzUmVhZHkoZSl7dHJ5e2lmKHRoaXMuX2lzUmVhZHlJbnRlcm5hbCgpKXJldHVybn1jYXRjaCh0KXt0aGlzLl9wcm9jZXNzQ29tcGlsYXRpb25FcnJvcnModCxlKTtyZXR1cm59dGhpcy5faXNEaXNwb3NlZHx8c2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrSXNSZWFkeShlKX0sMTYpfV9sb2FkU2hhZGVyKGUsdCxpLHMpe2lmKHR5cGVvZiBIVE1MRWxlbWVudDwidSImJmUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7Y29uc3QgYT1ncyhlKTtzKGEpO3JldHVybn1pZihlLnN1YnN0cigwLDcpPT09InNvdXJjZToiKXtzKGUuc3Vic3RyKDcpKTtyZXR1cm59aWYoZS5zdWJzdHIoMCw3KT09PSJiYXNlNjQ6Iil7Y29uc3QgYT13aW5kb3cuYXRvYihlLnN1YnN0cig3KSk7cyhhKTtyZXR1cm59Y29uc3Qgcj1VLkdldFNoYWRlcnNTdG9yZSh0aGlzLl9zaGFkZXJMYW5ndWFnZSk7aWYocltlK3QrIlNoYWRlciJdKXtzKHJbZSt0KyJTaGFkZXIiXSk7cmV0dXJufWlmKGkmJnJbZStpKyJTaGFkZXIiXSl7cyhyW2UraSsiU2hhZGVyIl0pO3JldHVybn1sZXQgbjtlWzBdPT09Ii4ifHxlWzBdPT09Ii8ifHxlLmluZGV4T2YoImh0dHAiKT4tMT9uPWU6bj1VLkdldFNoYWRlcnNSZXBvc2l0b3J5KHRoaXMuX3NoYWRlckxhbmd1YWdlKStlLHRoaXMuX2VuZ2luZS5fbG9hZEZpbGUobisiLiIrdC50b0xvd2VyQ2FzZSgpKyIuZngiLHMpfWdldCB2ZXJ0ZXhTb3VyY2VDb2RlKCl7dmFyIGUsdDtyZXR1cm4gdGhpcy5fdmVydGV4U291cmNlQ29kZU92ZXJyaWRlJiZ0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZT90aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlT3ZlcnJpZGU6KHQ9KGU9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuX2dldFZlcnRleFNoYWRlckNvZGUoKSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6dGhpcy5fdmVydGV4U291cmNlQ29kZX1nZXQgZnJhZ21lbnRTb3VyY2VDb2RlKCl7dmFyIGUsdDtyZXR1cm4gdGhpcy5fdmVydGV4U291cmNlQ29kZU92ZXJyaWRlJiZ0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZT90aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZToodD0oZT10aGlzLl9waXBlbGluZUNvbnRleHQpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5fZ2V0RnJhZ21lbnRTaGFkZXJDb2RlKCkpIT09bnVsbCYmdCE9PXZvaWQgMD90OnRoaXMuX2ZyYWdtZW50U291cmNlQ29kZX1nZXQgdmVydGV4U291cmNlQ29kZUJlZm9yZU1pZ3JhdGlvbigpe3JldHVybiB0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9ufWdldCBmcmFnbWVudFNvdXJjZUNvZGVCZWZvcmVNaWdyYXRpb24oKXtyZXR1cm4gdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlQmVmb3JlTWlncmF0aW9ufWdldCByYXdWZXJ0ZXhTb3VyY2VDb2RlKCl7cmV0dXJuIHRoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGV9Z2V0IHJhd0ZyYWdtZW50U291cmNlQ29kZSgpe3JldHVybiB0aGlzLl9yYXdGcmFnbWVudFNvdXJjZUNvZGV9X3JlYnVpbGRQcm9ncmFtKGUsdCxpLHMpe3RoaXMuX2lzUmVhZHk9ITEsdGhpcy5fdmVydGV4U291cmNlQ29kZU92ZXJyaWRlPWUsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlT3ZlcnJpZGU9dCx0aGlzLm9uRXJyb3I9KHIsbik9PntzJiZzKG4pfSx0aGlzLm9uQ29tcGlsZWQ9KCk9Pntjb25zdCByPXRoaXMuZ2V0RW5naW5lKCkuc2NlbmVzO2lmKHIpZm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspcltuXS5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSg2Myk7dGhpcy5fcGlwZWxpbmVDb250ZXh0Ll9oYW5kbGVzU3BlY3RvclJlYnVpbGRDYWxsYmFjayhpKX0sdGhpcy5fZmFsbGJhY2tzPW51bGwsdGhpcy5fcHJlcGFyZUVmZmVjdCgpfV9wcmVwYXJlRWZmZWN0KCl7Y29uc3QgZT10aGlzLl9hdHRyaWJ1dGVzTmFtZXMsdD10aGlzLmRlZmluZXMsaT10aGlzLl9waXBlbGluZUNvbnRleHQ7dGhpcy5faXNSZWFkeT0hMTt0cnl7Y29uc3Qgcz10aGlzLl9lbmdpbmU7dGhpcy5fcGlwZWxpbmVDb250ZXh0PXMuY3JlYXRlUGlwZWxpbmVDb250ZXh0KHRoaXMuX3Byb2Nlc3NpbmdDb250ZXh0KSx0aGlzLl9waXBlbGluZUNvbnRleHQuX25hbWU9dGhpcy5fa2V5O2NvbnN0IHI9dGhpcy5fcmVidWlsZFByb2dyYW0uYmluZCh0aGlzKTt0aGlzLl92ZXJ0ZXhTb3VyY2VDb2RlT3ZlcnJpZGUmJnRoaXMuX2ZyYWdtZW50U291cmNlQ29kZU92ZXJyaWRlP3MuX3ByZXBhcmVQaXBlbGluZUNvbnRleHQodGhpcy5fcGlwZWxpbmVDb250ZXh0LHRoaXMuX3ZlcnRleFNvdXJjZUNvZGVPdmVycmlkZSx0aGlzLl9mcmFnbWVudFNvdXJjZUNvZGVPdmVycmlkZSwhMCx0aGlzLl9yYXdWZXJ0ZXhTb3VyY2VDb2RlLHRoaXMuX3Jhd0ZyYWdtZW50U291cmNlQ29kZSxyLG51bGwsdGhpcy5fdHJhbnNmb3JtRmVlZGJhY2tWYXJ5aW5ncyx0aGlzLl9rZXkpOnMuX3ByZXBhcmVQaXBlbGluZUNvbnRleHQodGhpcy5fcGlwZWxpbmVDb250ZXh0LHRoaXMuX3ZlcnRleFNvdXJjZUNvZGUsdGhpcy5fZnJhZ21lbnRTb3VyY2VDb2RlLCExLHRoaXMuX3Jhd1ZlcnRleFNvdXJjZUNvZGUsdGhpcy5fcmF3RnJhZ21lbnRTb3VyY2VDb2RlLHIsdCx0aGlzLl90cmFuc2Zvcm1GZWVkYmFja1ZhcnlpbmdzLHRoaXMuX2tleSkscy5fZXhlY3V0ZVdoZW5SZW5kZXJpbmdTdGF0ZUlzQ29tcGlsZWQodGhpcy5fcGlwZWxpbmVDb250ZXh0LCgpPT57aWYodGhpcy5fYXR0cmlidXRlcz1bXSx0aGlzLl9waXBlbGluZUNvbnRleHQuX2ZpbGxFZmZlY3RJbmZvcm1hdGlvbih0aGlzLHRoaXMuX3VuaWZvcm1CdWZmZXJzTmFtZXMsdGhpcy5fdW5pZm9ybXNOYW1lcyx0aGlzLl91bmlmb3Jtcyx0aGlzLl9zYW1wbGVyTGlzdCx0aGlzLl9zYW1wbGVycyxlLHRoaXMuX2F0dHJpYnV0ZXMpLGUpZm9yKGxldCBuPTA7bjxlLmxlbmd0aDtuKyspe2NvbnN0IGE9ZVtuXTt0aGlzLl9hdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZVthXT10aGlzLl9hdHRyaWJ1dGVzW25dfXMuYmluZFNhbXBsZXJzKHRoaXMpLHRoaXMuX2NvbXBpbGF0aW9uRXJyb3I9IiIsdGhpcy5faXNSZWFkeT0hMCx0aGlzLm9uQ29tcGlsZWQmJnRoaXMub25Db21waWxlZCh0aGlzKSx0aGlzLm9uQ29tcGlsZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25Db21waWxlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX2ZhbGxiYWNrcyYmdGhpcy5fZmFsbGJhY2tzLnVuQmluZE1lc2goKSxpJiZ0aGlzLmdldEVuZ2luZSgpLl9kZWxldGVQaXBlbGluZUNvbnRleHQoaSl9KSx0aGlzLl9waXBlbGluZUNvbnRleHQuaXNBc3luYyYmdGhpcy5fY2hlY2tJc1JlYWR5KGkpfWNhdGNoKHMpe3RoaXMuX3Byb2Nlc3NDb21waWxhdGlvbkVycm9ycyhzLGkpfX1fZ2V0U2hhZGVyQ29kZUFuZEVycm9yTGluZShlLHQsaSl7Y29uc3Qgcz1pPy9GUkFHTUVOVCBTSEFERVIgRVJST1I6IDA6KFxkKz8pOi86L1ZFUlRFWCBTSEFERVIgRVJST1I6IDA6KFxkKz8pOi87bGV0IHI9bnVsbDtpZih0JiZlKXtjb25zdCBuPXQubWF0Y2gocyk7aWYobiYmbi5sZW5ndGg9PT0yKXtjb25zdCBhPXBhcnNlSW50KG5bMV0pLG89ZS5zcGxpdChgCmAsLTEpO28ubGVuZ3RoPj1hJiYocj1gT2ZmZW5kaW5nIGxpbmUgWyR7YX1dIGluICR7aT8iZnJhZ21lbnQiOiJ2ZXJ0ZXgifSBjb2RlOiAke29bYS0xXX1gKX19cmV0dXJuW2Uscl19X3Byb2Nlc3NDb21waWxhdGlvbkVycm9ycyhlLHQ9bnVsbCl7dmFyIGkscyxyO3RoaXMuX2NvbXBpbGF0aW9uRXJyb3I9ZS5tZXNzYWdlO2NvbnN0IG49dGhpcy5fYXR0cmlidXRlc05hbWVzLGE9dGhpcy5fZmFsbGJhY2tzO2lmKE8uRXJyb3IoIlVuYWJsZSB0byBjb21waWxlIGVmZmVjdDoiKSxPLkVycm9yKCJVbmlmb3JtczogIit0aGlzLl91bmlmb3Jtc05hbWVzLm1hcChmdW5jdGlvbihoKXtyZXR1cm4iICIraH0pKSxPLkVycm9yKCJBdHRyaWJ1dGVzOiAiK24ubWFwKGZ1bmN0aW9uKGgpe3JldHVybiIgIitofSkpLE8uRXJyb3IoYERlZmluZXM6XHIKYCt0aGlzLmRlZmluZXMpLFBlLkxvZ1NoYWRlckNvZGVPbkNvbXBpbGF0aW9uRXJyb3Ipe2xldCBoPW51bGwsbD1udWxsLHU9bnVsbDshKChpPXRoaXMuX3BpcGVsaW5lQ29udGV4dCk9PT1udWxsfHxpPT09dm9pZCAwKSYmaS5fZ2V0VmVydGV4U2hhZGVyQ29kZSgpJiYoW3UsaF09dGhpcy5fZ2V0U2hhZGVyQ29kZUFuZEVycm9yTGluZSh0aGlzLl9waXBlbGluZUNvbnRleHQuX2dldFZlcnRleFNoYWRlckNvZGUoKSx0aGlzLl9jb21waWxhdGlvbkVycm9yLCExKSx1JiYoTy5FcnJvcigiVmVydGV4IGNvZGU6IiksTy5FcnJvcih1KSkpLCEoKHM9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fHM9PT12b2lkIDApJiZzLl9nZXRGcmFnbWVudFNoYWRlckNvZGUoKSYmKFt1LGxdPXRoaXMuX2dldFNoYWRlckNvZGVBbmRFcnJvckxpbmUoKHI9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fHI9PT12b2lkIDA/dm9pZCAwOnIuX2dldEZyYWdtZW50U2hhZGVyQ29kZSgpLHRoaXMuX2NvbXBpbGF0aW9uRXJyb3IsITApLHUmJihPLkVycm9yKCJGcmFnbWVudCBjb2RlOiIpLE8uRXJyb3IodSkpKSxoJiZPLkVycm9yKGgpLGwmJk8uRXJyb3IobCl9Ty5FcnJvcigiRXJyb3I6ICIrdGhpcy5fY29tcGlsYXRpb25FcnJvcik7Y29uc3Qgbz0oKT0+e3RoaXMub25FcnJvciYmdGhpcy5vbkVycm9yKHRoaXMsdGhpcy5fY29tcGlsYXRpb25FcnJvciksdGhpcy5vbkVycm9yT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9O3QmJih0aGlzLl9waXBlbGluZUNvbnRleHQ9dCx0aGlzLl9pc1JlYWR5PSEwLG8oKSksYT8odGhpcy5fcGlwZWxpbmVDb250ZXh0PW51bGwsYS5oYXNNb3JlRmFsbGJhY2tzPyh0aGlzLl9hbGxGYWxsYmFja3NQcm9jZXNzZWQ9ITEsTy5FcnJvcigiVHJ5aW5nIG5leHQgZmFsbGJhY2suIiksdGhpcy5kZWZpbmVzPWEucmVkdWNlKHRoaXMuZGVmaW5lcyx0aGlzKSx0aGlzLl9wcmVwYXJlRWZmZWN0KCkpOih0aGlzLl9hbGxGYWxsYmFja3NQcm9jZXNzZWQ9ITAsbygpLHRoaXMub25FcnJvck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9mYWxsYmFja3MmJnRoaXMuX2ZhbGxiYWNrcy51bkJpbmRNZXNoKCkpKToodGhpcy5fYWxsRmFsbGJhY2tzUHJvY2Vzc2VkPSEwLHR8fG8oKSl9Z2V0IGlzU3VwcG9ydGVkKCl7cmV0dXJuIHRoaXMuX2NvbXBpbGF0aW9uRXJyb3I9PT0iIn1fYmluZFRleHR1cmUoZSx0KXt0aGlzLl9lbmdpbmUuX2JpbmRUZXh0dXJlKHRoaXMuX3NhbXBsZXJzW2VdLHQsZSl9c2V0VGV4dHVyZShlLHQpe3RoaXMuX2VuZ2luZS5zZXRUZXh0dXJlKHRoaXMuX3NhbXBsZXJzW2VdLHRoaXMuX3VuaWZvcm1zW2VdLHQsZSl9c2V0RGVwdGhTdGVuY2lsVGV4dHVyZShlLHQpe3RoaXMuX2VuZ2luZS5zZXREZXB0aFN0ZW5jaWxUZXh0dXJlKHRoaXMuX3NhbXBsZXJzW2VdLHRoaXMuX3VuaWZvcm1zW2VdLHQsZSl9c2V0VGV4dHVyZUFycmF5KGUsdCl7Y29uc3QgaT1lKyJFeCI7aWYodGhpcy5fc2FtcGxlckxpc3QuaW5kZXhPZihpKyIwIik9PT0tMSl7Y29uc3Qgcz10aGlzLl9zYW1wbGVyTGlzdC5pbmRleE9mKGUpO2ZvcihsZXQgbj0xO248dC5sZW5ndGg7bisrKXtjb25zdCBhPWkrKG4tMSkudG9TdHJpbmcoKTt0aGlzLl9zYW1wbGVyTGlzdC5zcGxpY2UocytuLDAsYSl9bGV0IHI9MDtmb3IoY29uc3QgbiBvZiB0aGlzLl9zYW1wbGVyTGlzdCl0aGlzLl9zYW1wbGVyc1tuXT1yLHIrPTF9dGhpcy5fZW5naW5lLnNldFRleHR1cmVBcnJheSh0aGlzLl9zYW1wbGVyc1tlXSx0aGlzLl91bmlmb3Jtc1tlXSx0LGUpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3MoZSx0KXt0aGlzLl9lbmdpbmUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2Vzcyh0aGlzLl9zYW1wbGVyc1tlXSx0LGUpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3NPdXRwdXQoZSx0KXt0aGlzLl9lbmdpbmUuc2V0VGV4dHVyZUZyb21Qb3N0UHJvY2Vzc091dHB1dCh0aGlzLl9zYW1wbGVyc1tlXSx0LGUpfWJpbmRVbmlmb3JtQnVmZmVyKGUsdCl7Y29uc3QgaT10aGlzLl91bmlmb3JtQnVmZmVyc05hbWVzW3RdO2k9PT12b2lkIDB8fFBlLl9CYXNlQ2FjaGVbaV09PT1lJiZ0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnVzZVVCT0JpbmRpbmdDYWNoZXx8KFBlLl9CYXNlQ2FjaGVbaV09ZSx0aGlzLl9lbmdpbmUuYmluZFVuaWZvcm1CdWZmZXJCYXNlKGUsaSx0KSl9YmluZFVuaWZvcm1CbG9jayhlLHQpe3RoaXMuX2VuZ2luZS5iaW5kVW5pZm9ybUJsb2NrKHRoaXMuX3BpcGVsaW5lQ29udGV4dCxlLHQpfXNldEZsb2F0QXJyYXkoZSx0KXtyZXR1cm4gdGhpcy5fcGlwZWxpbmVDb250ZXh0LnNldEFycmF5KGUsdCksdGhpc31zZXRGbG9hdEFycmF5MihlLHQpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHQuc2V0QXJyYXkyKGUsdCksdGhpc31zZXRGbG9hdEFycmF5MyhlLHQpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHQuc2V0QXJyYXkzKGUsdCksdGhpc31zZXRGbG9hdEFycmF5NChlLHQpe3JldHVybiB0aGlzLl9waXBlbGluZUNvbnRleHQuc2V0QXJyYXk0KGUsdCksdGhpc31zZXRCb29sKGUsdCl7cmV0dXJuIHRoaXMuX3BpcGVsaW5lQ29udGV4dC5zZXRJbnQoZSx0PzE6MCksdGhpc31kaXNwb3NlKCl7dmFyIGU7KGU9dGhpcy5fcGlwZWxpbmVDb250ZXh0KT09PW51bGx8fGU9PT12b2lkIDB8fGUuZGlzcG9zZSgpLHRoaXMuX2VuZ2luZS5fcmVsZWFzZUVmZmVjdCh0aGlzKSx0aGlzLl9pc0Rpc3Bvc2VkPSEwfXN0YXRpYyBSZWdpc3RlclNoYWRlcihlLHQsaSxzPVplLkdMU0wpe3QmJihVLkdldFNoYWRlcnNTdG9yZShzKVtgJHtlfVBpeGVsU2hhZGVyYF09dCksaSYmKFUuR2V0U2hhZGVyc1N0b3JlKHMpW2Ake2V9VmVydGV4U2hhZGVyYF09aSl9c3RhdGljIFJlc2V0Q2FjaGUoKXtQZS5fQmFzZUNhY2hlPXt9fX1QZS5Mb2dTaGFkZXJDb2RlT25Db21waWxhdGlvbkVycm9yPSEwLFBlLl9VbmlxdWVJZFNlZWQ9MCxQZS5fQmFzZUNhY2hlPXt9LFBlLlNoYWRlcnNTdG9yZT1VLlNoYWRlcnNTdG9yZSxQZS5JbmNsdWRlc1NoYWRlcnNTdG9yZT1VLkluY2x1ZGVzU2hhZGVyc1N0b3JlO2NsYXNzIHJue2NvbnN0cnVjdG9yKGU9ITApe3RoaXMuX2lzRGVwdGhUZXN0RGlydHk9ITEsdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMSx0aGlzLl9pc0RlcHRoRnVuY0RpcnR5PSExLHRoaXMuX2lzQ3VsbEZhY2VEaXJ0eT0hMSx0aGlzLl9pc0N1bGxEaXJ0eT0hMSx0aGlzLl9pc1pPZmZzZXREaXJ0eT0hMSx0aGlzLl9pc0Zyb250RmFjZURpcnR5PSExLGUmJnRoaXMucmVzZXQoKX1nZXQgaXNEaXJ0eSgpe3JldHVybiB0aGlzLl9pc0RlcHRoRnVuY0RpcnR5fHx0aGlzLl9pc0RlcHRoVGVzdERpcnR5fHx0aGlzLl9pc0RlcHRoTWFza0RpcnR5fHx0aGlzLl9pc0N1bGxGYWNlRGlydHl8fHRoaXMuX2lzQ3VsbERpcnR5fHx0aGlzLl9pc1pPZmZzZXREaXJ0eXx8dGhpcy5faXNGcm9udEZhY2VEaXJ0eX1nZXQgek9mZnNldCgpe3JldHVybiB0aGlzLl96T2Zmc2V0fXNldCB6T2Zmc2V0KGUpe3RoaXMuX3pPZmZzZXQhPT1lJiYodGhpcy5fek9mZnNldD1lLHRoaXMuX2lzWk9mZnNldERpcnR5PSEwKX1nZXQgek9mZnNldFVuaXRzKCl7cmV0dXJuIHRoaXMuX3pPZmZzZXRVbml0c31zZXQgek9mZnNldFVuaXRzKGUpe3RoaXMuX3pPZmZzZXRVbml0cyE9PWUmJih0aGlzLl96T2Zmc2V0VW5pdHM9ZSx0aGlzLl9pc1pPZmZzZXREaXJ0eT0hMCl9Z2V0IGN1bGxGYWNlKCl7cmV0dXJuIHRoaXMuX2N1bGxGYWNlfXNldCBjdWxsRmFjZShlKXt0aGlzLl9jdWxsRmFjZSE9PWUmJih0aGlzLl9jdWxsRmFjZT1lLHRoaXMuX2lzQ3VsbEZhY2VEaXJ0eT0hMCl9Z2V0IGN1bGwoKXtyZXR1cm4gdGhpcy5fY3VsbH1zZXQgY3VsbChlKXt0aGlzLl9jdWxsIT09ZSYmKHRoaXMuX2N1bGw9ZSx0aGlzLl9pc0N1bGxEaXJ0eT0hMCl9Z2V0IGRlcHRoRnVuYygpe3JldHVybiB0aGlzLl9kZXB0aEZ1bmN9c2V0IGRlcHRoRnVuYyhlKXt0aGlzLl9kZXB0aEZ1bmMhPT1lJiYodGhpcy5fZGVwdGhGdW5jPWUsdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eT0hMCl9Z2V0IGRlcHRoTWFzaygpe3JldHVybiB0aGlzLl9kZXB0aE1hc2t9c2V0IGRlcHRoTWFzayhlKXt0aGlzLl9kZXB0aE1hc2shPT1lJiYodGhpcy5fZGVwdGhNYXNrPWUsdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMCl9Z2V0IGRlcHRoVGVzdCgpe3JldHVybiB0aGlzLl9kZXB0aFRlc3R9c2V0IGRlcHRoVGVzdChlKXt0aGlzLl9kZXB0aFRlc3QhPT1lJiYodGhpcy5fZGVwdGhUZXN0PWUsdGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMCl9Z2V0IGZyb250RmFjZSgpe3JldHVybiB0aGlzLl9mcm9udEZhY2V9c2V0IGZyb250RmFjZShlKXt0aGlzLl9mcm9udEZhY2UhPT1lJiYodGhpcy5fZnJvbnRGYWNlPWUsdGhpcy5faXNGcm9udEZhY2VEaXJ0eT0hMCl9cmVzZXQoKXt0aGlzLl9kZXB0aE1hc2s9ITAsdGhpcy5fZGVwdGhUZXN0PSEwLHRoaXMuX2RlcHRoRnVuYz1udWxsLHRoaXMuX2N1bGxGYWNlPW51bGwsdGhpcy5fY3VsbD1udWxsLHRoaXMuX3pPZmZzZXQ9MCx0aGlzLl96T2Zmc2V0VW5pdHM9MCx0aGlzLl9mcm9udEZhY2U9bnVsbCx0aGlzLl9pc0RlcHRoVGVzdERpcnR5PSEwLHRoaXMuX2lzRGVwdGhNYXNrRGlydHk9ITAsdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eT0hMSx0aGlzLl9pc0N1bGxGYWNlRGlydHk9ITEsdGhpcy5faXNDdWxsRGlydHk9ITEsdGhpcy5faXNaT2Zmc2V0RGlydHk9ITAsdGhpcy5faXNGcm9udEZhY2VEaXJ0eT0hMX1hcHBseShlKXt0aGlzLmlzRGlydHkmJih0aGlzLl9pc0N1bGxEaXJ0eSYmKHRoaXMuY3VsbD9lLmVuYWJsZShlLkNVTExfRkFDRSk6ZS5kaXNhYmxlKGUuQ1VMTF9GQUNFKSx0aGlzLl9pc0N1bGxEaXJ0eT0hMSksdGhpcy5faXNDdWxsRmFjZURpcnR5JiYoZS5jdWxsRmFjZSh0aGlzLmN1bGxGYWNlKSx0aGlzLl9pc0N1bGxGYWNlRGlydHk9ITEpLHRoaXMuX2lzRGVwdGhNYXNrRGlydHkmJihlLmRlcHRoTWFzayh0aGlzLmRlcHRoTWFzayksdGhpcy5faXNEZXB0aE1hc2tEaXJ0eT0hMSksdGhpcy5faXNEZXB0aFRlc3REaXJ0eSYmKHRoaXMuZGVwdGhUZXN0P2UuZW5hYmxlKGUuREVQVEhfVEVTVCk6ZS5kaXNhYmxlKGUuREVQVEhfVEVTVCksdGhpcy5faXNEZXB0aFRlc3REaXJ0eT0hMSksdGhpcy5faXNEZXB0aEZ1bmNEaXJ0eSYmKGUuZGVwdGhGdW5jKHRoaXMuZGVwdGhGdW5jKSx0aGlzLl9pc0RlcHRoRnVuY0RpcnR5PSExKSx0aGlzLl9pc1pPZmZzZXREaXJ0eSYmKHRoaXMuek9mZnNldHx8dGhpcy56T2Zmc2V0VW5pdHM/KGUuZW5hYmxlKGUuUE9MWUdPTl9PRkZTRVRfRklMTCksZS5wb2x5Z29uT2Zmc2V0KHRoaXMuek9mZnNldCx0aGlzLnpPZmZzZXRVbml0cykpOmUuZGlzYWJsZShlLlBPTFlHT05fT0ZGU0VUX0ZJTEwpLHRoaXMuX2lzWk9mZnNldERpcnR5PSExKSx0aGlzLl9pc0Zyb250RmFjZURpcnR5JiYoZS5mcm9udEZhY2UodGhpcy5mcm9udEZhY2UpLHRoaXMuX2lzRnJvbnRGYWNlRGlydHk9ITEpKX19Y2xhc3MgTHR7Y29uc3RydWN0b3IoKXt0aGlzLnJlc2V0KCl9cmVzZXQoKXt0aGlzLmVuYWJsZWQ9ITEsdGhpcy5tYXNrPTI1NSx0aGlzLmZ1bmM9THQuQUxXQVlTLHRoaXMuZnVuY1JlZj0xLHRoaXMuZnVuY01hc2s9MjU1LHRoaXMub3BTdGVuY2lsRmFpbD1MdC5LRUVQLHRoaXMub3BEZXB0aEZhaWw9THQuS0VFUCx0aGlzLm9wU3RlbmNpbERlcHRoUGFzcz1MdC5SRVBMQUNFfWdldCBzdGVuY2lsRnVuYygpe3JldHVybiB0aGlzLmZ1bmN9c2V0IHN0ZW5jaWxGdW5jKGUpe3RoaXMuZnVuYz1lfWdldCBzdGVuY2lsRnVuY1JlZigpe3JldHVybiB0aGlzLmZ1bmNSZWZ9c2V0IHN0ZW5jaWxGdW5jUmVmKGUpe3RoaXMuZnVuY1JlZj1lfWdldCBzdGVuY2lsRnVuY01hc2soKXtyZXR1cm4gdGhpcy5mdW5jTWFza31zZXQgc3RlbmNpbEZ1bmNNYXNrKGUpe3RoaXMuZnVuY01hc2s9ZX1nZXQgc3RlbmNpbE9wU3RlbmNpbEZhaWwoKXtyZXR1cm4gdGhpcy5vcFN0ZW5jaWxGYWlsfXNldCBzdGVuY2lsT3BTdGVuY2lsRmFpbChlKXt0aGlzLm9wU3RlbmNpbEZhaWw9ZX1nZXQgc3RlbmNpbE9wRGVwdGhGYWlsKCl7cmV0dXJuIHRoaXMub3BEZXB0aEZhaWx9c2V0IHN0ZW5jaWxPcERlcHRoRmFpbChlKXt0aGlzLm9wRGVwdGhGYWlsPWV9Z2V0IHN0ZW5jaWxPcFN0ZW5jaWxEZXB0aFBhc3MoKXtyZXR1cm4gdGhpcy5vcFN0ZW5jaWxEZXB0aFBhc3N9c2V0IHN0ZW5jaWxPcFN0ZW5jaWxEZXB0aFBhc3MoZSl7dGhpcy5vcFN0ZW5jaWxEZXB0aFBhc3M9ZX1nZXQgc3RlbmNpbE1hc2soKXtyZXR1cm4gdGhpcy5tYXNrfXNldCBzdGVuY2lsTWFzayhlKXt0aGlzLm1hc2s9ZX1nZXQgc3RlbmNpbFRlc3QoKXtyZXR1cm4gdGhpcy5lbmFibGVkfXNldCBzdGVuY2lsVGVzdChlKXt0aGlzLmVuYWJsZWQ9ZX19THQuQUxXQVlTPTUxOSxMdC5LRUVQPTc2ODAsTHQuUkVQTEFDRT03NjgxO2NsYXNzIG5ue2NvbnN0cnVjdG9yKCl7dGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnM9bmV3IEFycmF5KDQpLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzPW5ldyBBcnJheSgyKSx0aGlzLl9ibGVuZENvbnN0YW50cz1uZXcgQXJyYXkoNCksdGhpcy5faXNCbGVuZENvbnN0YW50c0RpcnR5PSExLHRoaXMuX2FscGhhQmxlbmQ9ITEsdGhpcy5faXNBbHBoYUJsZW5kRGlydHk9ITEsdGhpcy5faXNCbGVuZEZ1bmN0aW9uUGFyYW1ldGVyc0RpcnR5PSExLHRoaXMuX2lzQmxlbmRFcXVhdGlvblBhcmFtZXRlcnNEaXJ0eT0hMSx0aGlzLnJlc2V0KCl9Z2V0IGlzRGlydHkoKXtyZXR1cm4gdGhpcy5faXNBbHBoYUJsZW5kRGlydHl8fHRoaXMuX2lzQmxlbmRGdW5jdGlvblBhcmFtZXRlcnNEaXJ0eXx8dGhpcy5faXNCbGVuZEVxdWF0aW9uUGFyYW1ldGVyc0RpcnR5fWdldCBhbHBoYUJsZW5kKCl7cmV0dXJuIHRoaXMuX2FscGhhQmxlbmR9c2V0IGFscGhhQmxlbmQoZSl7dGhpcy5fYWxwaGFCbGVuZCE9PWUmJih0aGlzLl9hbHBoYUJsZW5kPWUsdGhpcy5faXNBbHBoYUJsZW5kRGlydHk9ITApfXNldEFscGhhQmxlbmRDb25zdGFudHMoZSx0LGkscyl7dGhpcy5fYmxlbmRDb25zdGFudHNbMF09PT1lJiZ0aGlzLl9ibGVuZENvbnN0YW50c1sxXT09PXQmJnRoaXMuX2JsZW5kQ29uc3RhbnRzWzJdPT09aSYmdGhpcy5fYmxlbmRDb25zdGFudHNbM109PT1zfHwodGhpcy5fYmxlbmRDb25zdGFudHNbMF09ZSx0aGlzLl9ibGVuZENvbnN0YW50c1sxXT10LHRoaXMuX2JsZW5kQ29uc3RhbnRzWzJdPWksdGhpcy5fYmxlbmRDb25zdGFudHNbM109cyx0aGlzLl9pc0JsZW5kQ29uc3RhbnRzRGlydHk9ITApfXNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnMoZSx0LGkscyl7dGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMF09PT1lJiZ0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1sxXT09PXQmJnRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdPT09aSYmdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbM109PT1zfHwodGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMF09ZSx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1sxXT10LHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdPWksdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbM109cyx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITApfXNldEFscGhhRXF1YXRpb25QYXJhbWV0ZXJzKGUsdCl7dGhpcy5fYmxlbmRFcXVhdGlvblBhcmFtZXRlcnNbMF09PT1lJiZ0aGlzLl9ibGVuZEVxdWF0aW9uUGFyYW1ldGVyc1sxXT09PXR8fCh0aGlzLl9ibGVuZEVxdWF0aW9uUGFyYW1ldGVyc1swXT1lLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzFdPXQsdGhpcy5faXNCbGVuZEVxdWF0aW9uUGFyYW1ldGVyc0RpcnR5PSEwKX1yZXNldCgpe3RoaXMuX2FscGhhQmxlbmQ9ITEsdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbMF09bnVsbCx0aGlzLl9ibGVuZEZ1bmN0aW9uUGFyYW1ldGVyc1sxXT1udWxsLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdPW51bGwsdGhpcy5fYmxlbmRGdW5jdGlvblBhcmFtZXRlcnNbM109bnVsbCx0aGlzLl9ibGVuZEVxdWF0aW9uUGFyYW1ldGVyc1swXT1udWxsLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzFdPW51bGwsdGhpcy5fYmxlbmRDb25zdGFudHNbMF09bnVsbCx0aGlzLl9ibGVuZENvbnN0YW50c1sxXT1udWxsLHRoaXMuX2JsZW5kQ29uc3RhbnRzWzJdPW51bGwsdGhpcy5fYmxlbmRDb25zdGFudHNbM109bnVsbCx0aGlzLl9pc0FscGhhQmxlbmREaXJ0eT0hMCx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITEsdGhpcy5faXNCbGVuZEVxdWF0aW9uUGFyYW1ldGVyc0RpcnR5PSExLHRoaXMuX2lzQmxlbmRDb25zdGFudHNEaXJ0eT0hMX1hcHBseShlKXt0aGlzLmlzRGlydHkmJih0aGlzLl9pc0FscGhhQmxlbmREaXJ0eSYmKHRoaXMuX2FscGhhQmxlbmQ/ZS5lbmFibGUoZS5CTEVORCk6ZS5kaXNhYmxlKGUuQkxFTkQpLHRoaXMuX2lzQWxwaGFCbGVuZERpcnR5PSExKSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHkmJihlLmJsZW5kRnVuY1NlcGFyYXRlKHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzBdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzFdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzJdLHRoaXMuX2JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzWzNdKSx0aGlzLl9pc0JsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzRGlydHk9ITEpLHRoaXMuX2lzQmxlbmRFcXVhdGlvblBhcmFtZXRlcnNEaXJ0eSYmKGUuYmxlbmRFcXVhdGlvblNlcGFyYXRlKHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzBdLHRoaXMuX2JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzWzFdKSx0aGlzLl9pc0JsZW5kRXF1YXRpb25QYXJhbWV0ZXJzRGlydHk9ITEpLHRoaXMuX2lzQmxlbmRDb25zdGFudHNEaXJ0eSYmKGUuYmxlbmRDb2xvcih0aGlzLl9ibGVuZENvbnN0YW50c1swXSx0aGlzLl9ibGVuZENvbnN0YW50c1sxXSx0aGlzLl9ibGVuZENvbnN0YW50c1syXSx0aGlzLl9ibGVuZENvbnN0YW50c1szXSksdGhpcy5faXNCbGVuZENvbnN0YW50c0RpcnR5PSExKSl9fWNsYXNzIGFue2NvbnN0cnVjdG9yKCl7dGhpcy5zaGFkZXJMYW5ndWFnZT1aZS5HTFNMfXBvc3RQcm9jZXNzb3IoZSx0LGkscyxyKXtpZighci5nZXRDYXBzKCkuZHJhd0J1ZmZlcnNFeHRlbnNpb24pe2NvbnN0IG49LyNleHRlbnNpb24uK0dMX0VYVF9kcmF3X2J1ZmZlcnMuKyhlbmFibGV8cmVxdWlyZSkvZztlPWUucmVwbGFjZShuLCIiKX1yZXR1cm4gZX19Y2xhc3Mgb257Y29uc3RydWN0b3IoKXt0aGlzLnNoYWRlckxhbmd1YWdlPVplLkdMU0x9YXR0cmlidXRlUHJvY2Vzc29yKGUpe3JldHVybiBlLnJlcGxhY2UoImF0dHJpYnV0ZSIsImluIil9dmFyeWluZ1Byb2Nlc3NvcihlLHQpe3JldHVybiBlLnJlcGxhY2UoInZhcnlpbmciLHQ/ImluIjoib3V0Iil9cG9zdFByb2Nlc3NvcihlLHQsaSl7Y29uc3Qgcz1lLnNlYXJjaCgvI2V4dGVuc2lvbi4rR0xfRVhUX2RyYXdfYnVmZmVycy4rcmVxdWlyZS8pIT09LTEscj0vI2V4dGVuc2lvbi4rKEdMX09WUl9tdWx0aXZpZXcyfEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlc3xHTF9FWFRfc2hhZGVyX3RleHR1cmVfbG9kfEdMX0VYVF9mcmFnX2RlcHRofEdMX0VYVF9kcmF3X2J1ZmZlcnMpLisoZW5hYmxlfHJlcXVpcmUpL2c7aWYoZT1lLnJlcGxhY2UociwiIiksZT1lLnJlcGxhY2UoL3RleHR1cmUyRFxzKlwoL2csInRleHR1cmUoIiksaSllPWUucmVwbGFjZSgvdGV4dHVyZTJETG9kRVhUXHMqXCgvZywidGV4dHVyZUxvZCgiKSxlPWUucmVwbGFjZSgvdGV4dHVyZUN1YmVMb2RFWFRccypcKC9nLCJ0ZXh0dXJlTG9kKCIpLGU9ZS5yZXBsYWNlKC90ZXh0dXJlQ3ViZVxzKlwoL2csInRleHR1cmUoIiksZT1lLnJlcGxhY2UoL2dsX0ZyYWdEZXB0aEVYVC9nLCJnbF9GcmFnRGVwdGgiKSxlPWUucmVwbGFjZSgvZ2xfRnJhZ0NvbG9yL2csImdsRnJhZ0NvbG9yIiksZT1lLnJlcGxhY2UoL2dsX0ZyYWdEYXRhL2csImdsRnJhZ0RhdGEiKSxlPWUucmVwbGFjZSgvdm9pZFxzKz9tYWluXHMqXCgvZywocz8iIjpgbGF5b3V0KGxvY2F0aW9uID0gMCkgb3V0IHZlYzQgZ2xGcmFnQ29sb3I7CmApKyJ2b2lkIG1haW4oIik7ZWxzZSBpZih0LmluZGV4T2YoIiNkZWZpbmUgTVVMVElWSUVXIikhPT0tMSlyZXR1cm5gI2V4dGVuc2lvbiBHTF9PVlJfbXVsdGl2aWV3MiA6IHJlcXVpcmUKbGF5b3V0IChudW1fdmlld3MgPSAyKSBpbjsKYCtlO3JldHVybiBlfX1jbGFzcyBQaXtjb25zdHJ1Y3Rvcigpe3RoaXMucmVmZXJlbmNlcz0wLHRoaXMuY2FwYWNpdHk9MCx0aGlzLmlzMzJCaXRzPSExLHRoaXMudW5pcXVlSWQ9UGkuX0NvdW50ZXIrK31nZXQgdW5kZXJseWluZ1Jlc291cmNlKCl7cmV0dXJuIG51bGx9fVBpLl9Db3VudGVyPTA7Y2xhc3MgRGkgZXh0ZW5kcyBQaXtjb25zdHJ1Y3RvcihlKXtzdXBlcigpLHRoaXMuX2J1ZmZlcj1lfWdldCB1bmRlcmx5aW5nUmVzb3VyY2UoKXtyZXR1cm4gdGhpcy5fYnVmZmVyfX1jb25zdCBobj1bIkludCIsIkludDIiLCJJbnQzIiwiSW50NCIsIlVJbnQiLCJVSW50MiIsIlVJbnQzIiwiVUludDQiLCJWZWN0b3IyIiwiVmVjdG9yMyIsIlZlY3RvcjQiLCJGbG9hdDIiLCJGbG9hdCIsIkZsb2F0MyIsIkZsb2F0NCIsIlF1YXRlcm5pb24iLCJDb2xvcjMiLCJDb2xvcjQiLCJEaXJlY3RDb2xvcjQiXTtjbGFzcyBsbntjb25zdHJ1Y3Rvcigpe3RoaXMuX3ZhbHVlQ2FjaGU9e30sdGhpcy52ZXJ0ZXhDb21waWxhdGlvbkVycm9yPW51bGwsdGhpcy5mcmFnbWVudENvbXBpbGF0aW9uRXJyb3I9bnVsbCx0aGlzLnByb2dyYW1MaW5rRXJyb3I9bnVsbCx0aGlzLnByb2dyYW1WYWxpZGF0aW9uRXJyb3I9bnVsbDtjb25zdCBlPVtdLHQ9ZnVuY3Rpb24oKXtlLmxlbmd0aD0wLEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGUsYXJndW1lbnRzKSxlWzBdPXRoaXMuX3VuaWZvcm1zW2VbMF1dfSxpPXM9Pntjb25zdCByPWhuLmluY2x1ZGVzKHMuc3Vic3RyaW5nKDMpKSYmIkZsb2F0TiI7aWYocil7Y29uc3Qgbj10aGlzW2BfY2FjaGUke3J9YF07cmV0dXJuIGZ1bmN0aW9uKCl7Y29uc3QgYT10aGlzLmVuZ2luZVtzXTt0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSxuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKGEuYXBwbHkodGhpcy5lbmdpbmUsZSl8fCh0aGlzLl92YWx1ZUNhY2hlW2FyZ3VtZW50c1swXV09bnVsbCkpfX1lbHNlIHJldHVybiBmdW5jdGlvbigpe2NvbnN0IG49dGhpcy5lbmdpbmVbc107dC5hcHBseSh0aGlzLGFyZ3VtZW50cyksYXJndW1lbnRzWzFdIT09dm9pZCAwJiYodGhpcy5fdmFsdWVDYWNoZVthcmd1bWVudHNbMF1dPW51bGwsbi5hcHBseSh0aGlzLmVuZ2luZSxlKSl9fTtbIkludD8iLCJVSW50PyIsIkludEFycmF5PyIsIlVJbnRBcnJheT8iLCJBcnJheT8iLCJGbG9hdD8iLCJNYXRyaWNlcyIsIk1hdHJpeDN4MyIsIk1hdHJpeDJ4MiJdLmZvckVhY2gocz0+e2NvbnN0IHI9YHNldCR7c31gO3RoaXNbcl18fChyLmVuZHNXaXRoKCI/Iik/WyIiLDIsMyw0XS5mb3JFYWNoKG49Pnt0aGlzW3Iuc2xpY2UoMCwtMSkrbl09dGhpc1tyLnNsaWNlKDAsLTEpK25dfHxpKHIuc2xpY2UoMCwtMSkrbikuYmluZCh0aGlzKX0pOnRoaXNbcl09dGhpc1tyXXx8aShyKS5iaW5kKHRoaXMpKX0pfWdldCBpc0FzeW5jKCl7cmV0dXJuIHRoaXMuaXNQYXJhbGxlbENvbXBpbGVkfWdldCBpc1JlYWR5KCl7cmV0dXJuIHRoaXMucHJvZ3JhbT90aGlzLmlzUGFyYWxsZWxDb21waWxlZD90aGlzLmVuZ2luZS5faXNSZW5kZXJpbmdTdGF0ZUNvbXBpbGVkKHRoaXMpOiEwOiExfV9oYW5kbGVzU3BlY3RvclJlYnVpbGRDYWxsYmFjayhlKXtlJiZ0aGlzLnByb2dyYW0mJmUodGhpcy5wcm9ncmFtKX1fZmlsbEVmZmVjdEluZm9ybWF0aW9uKGUsdCxpLHMscixuLGEsbyl7Y29uc3QgaD10aGlzLmVuZ2luZTtpZihoLnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMpZm9yKGNvbnN0IGQgaW4gdCllLmJpbmRVbmlmb3JtQmxvY2soZCx0W2RdKTt0aGlzLmVuZ2luZS5nZXRVbmlmb3Jtcyh0aGlzLGkpLmZvckVhY2goKGQsZik9PntzW2lbZl1dPWR9KSx0aGlzLl91bmlmb3Jtcz1zO2xldCB1O2Zvcih1PTA7dTxyLmxlbmd0aDt1KyspZS5nZXRVbmlmb3JtKHJbdV0pPT1udWxsJiYoci5zcGxpY2UodSwxKSx1LS0pO3IuZm9yRWFjaCgoZCxmKT0+e25bZF09Zn0pO2Zvcihjb25zdCBkIG9mIGguZ2V0QXR0cmlidXRlcyh0aGlzLGEpKW8ucHVzaChkKX1kaXNwb3NlKCl7dGhpcy5fdW5pZm9ybXM9e319X2NhY2hlTWF0cml4KGUsdCl7Y29uc3QgaT10aGlzLl92YWx1ZUNhY2hlW2VdLHM9dC51cGRhdGVGbGFnO3JldHVybiBpIT09dm9pZCAwJiZpPT09cz8hMToodGhpcy5fdmFsdWVDYWNoZVtlXT1zLCEwKX1fY2FjaGVGbG9hdE4oZSx0LGkscyxyKXtsZXQgbj10aGlzLl92YWx1ZUNhY2hlW2FyZ3VtZW50c1swXV07aWYoIW58fG4ubGVuZ3RoIT09YXJndW1lbnRzLmxlbmd0aC0xKXJldHVybiBuPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSx0aGlzLl92YWx1ZUNhY2hlW2FyZ3VtZW50c1swXV09biwhMDtsZXQgYT0hMTtmb3IobGV0IG89MDtvPG4ubGVuZ3RoOysrbyluW29dIT09YXJndW1lbnRzW28rMV0mJihuW29dPWFyZ3VtZW50c1tvKzFdLGE9ITApO3JldHVybiBhfV9jYWNoZUZsb2F0MihlLHQsaSl7cmV0dXJuIHRoaXMuX2NhY2hlRmxvYXROKGUsdCxpKX1fY2FjaGVGbG9hdDMoZSx0LGkscyl7cmV0dXJuIHRoaXMuX2NhY2hlRmxvYXROKGUsdCxpLHMpfV9jYWNoZUZsb2F0NChlLHQsaSxzLHIpe3JldHVybiB0aGlzLl9jYWNoZUZsb2F0TihlLHQsaSxzLHIpfXNldE1hdHJpeChlLHQpe3RoaXMuX2NhY2hlTWF0cml4KGUsdCkmJih0aGlzLmVuZ2luZS5zZXRNYXRyaWNlcyh0aGlzLl91bmlmb3Jtc1tlXSx0LnRvQXJyYXkoKSl8fCh0aGlzLl92YWx1ZUNhY2hlW2VdPW51bGwpKX1zZXRWZWN0b3IyKGUsdCl7dGhpcy5zZXRGbG9hdDIoZSx0LngsdC55KX1zZXRWZWN0b3IzKGUsdCl7dGhpcy5zZXRGbG9hdDMoZSx0LngsdC55LHQueil9c2V0VmVjdG9yNChlLHQpe3RoaXMuc2V0RmxvYXQ0KGUsdC54LHQueSx0LnosdC53KX1zZXRRdWF0ZXJuaW9uKGUsdCl7dGhpcy5zZXRGbG9hdDQoZSx0LngsdC55LHQueix0LncpfXNldENvbG9yMyhlLHQpe3RoaXMuc2V0RmxvYXQzKGUsdC5yLHQuZyx0LmIpfXNldENvbG9yNChlLHQsaSl7dGhpcy5zZXRGbG9hdDQoZSx0LnIsdC5nLHQuYixpKX1zZXREaXJlY3RDb2xvcjQoZSx0KXt0aGlzLnNldEZsb2F0NChlLHQucix0LmcsdC5iLHQuYSl9X2dldFZlcnRleFNoYWRlckNvZGUoKXtyZXR1cm4gdGhpcy52ZXJ0ZXhTaGFkZXI/dGhpcy5lbmdpbmUuX2dldFNoYWRlclNvdXJjZSh0aGlzLnZlcnRleFNoYWRlcik6bnVsbH1fZ2V0RnJhZ21lbnRTaGFkZXJDb2RlKCl7cmV0dXJuIHRoaXMuZnJhZ21lbnRTaGFkZXI/dGhpcy5lbmdpbmUuX2dldFNoYWRlclNvdXJjZSh0aGlzLmZyYWdtZW50U2hhZGVyKTpudWxsfX1jbGFzcyB0cntjb25zdHJ1Y3RvcihlPW51bGwsdCl7aWYodGhpcy5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsLHRoaXMuX2NvbnRleHQ9dCwhZSYmKGU9dC5jcmVhdGVUZXh0dXJlKCksIWUpKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSB3ZWJHTCB0ZXh0dXJlIik7dGhpcy5zZXQoZSl9Z2V0IHVuZGVybHlpbmdSZXNvdXJjZSgpe3JldHVybiB0aGlzLl93ZWJHTFRleHR1cmV9c2V0VXNhZ2UoKXt9c2V0KGUpe3RoaXMuX3dlYkdMVGV4dHVyZT1lfXJlc2V0KCl7dGhpcy5fd2ViR0xUZXh0dXJlPW51bGwsdGhpcy5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsfXJlbGVhc2UoKXt0aGlzLl9NU0FBUmVuZGVyQnVmZmVyJiYodGhpcy5fY29udGV4dC5kZWxldGVSZW5kZXJidWZmZXIodGhpcy5fTVNBQVJlbmRlckJ1ZmZlciksdGhpcy5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsKSx0aGlzLl93ZWJHTFRleHR1cmUmJnRoaXMuX2NvbnRleHQuZGVsZXRlVGV4dHVyZSh0aGlzLl93ZWJHTFRleHR1cmUpLHRoaXMucmVzZXQoKX19Y2xhc3MgbWl7Y29uc3RydWN0b3IoZSx0PSEwKXt0aGlzLmVmZmVjdD1udWxsLHRoaXMuZGVmaW5lcz1udWxsLHRoaXMuZHJhd0NvbnRleHQ9ZS5jcmVhdGVEcmF3Q29udGV4dCgpLHQmJih0aGlzLm1hdGVyaWFsQ29udGV4dD1lLmNyZWF0ZU1hdGVyaWFsQ29udGV4dCgpKX1zdGF0aWMgSXNXcmFwcGVyKGUpe3JldHVybiBlLmdldFBpcGVsaW5lQ29udGV4dD09PXZvaWQgMH1zdGF0aWMgR2V0RWZmZWN0KGUpe3JldHVybiBlLmdldFBpcGVsaW5lQ29udGV4dD09PXZvaWQgMD9lLmVmZmVjdDplfXNldEVmZmVjdChlLHQsaT0hMCl7dmFyIHM7dGhpcy5lZmZlY3Q9ZSx0IT09dm9pZCAwJiYodGhpcy5kZWZpbmVzPXQpLGkmJigocz10aGlzLmRyYXdDb250ZXh0KT09PW51bGx8fHM9PT12b2lkIDB8fHMucmVzZXQoKSl9ZGlzcG9zZSgpe3ZhciBlOyhlPXRoaXMuZHJhd0NvbnRleHQpPT09bnVsbHx8ZT09PXZvaWQgMHx8ZS5kaXNwb3NlKCl9fWNsYXNzIGNue2NvbnN0cnVjdG9yKGU9ITApe3RoaXMuX2lzU3RlbmNpbFRlc3REaXJ0eT0hMSx0aGlzLl9pc1N0ZW5jaWxNYXNrRGlydHk9ITEsdGhpcy5faXNTdGVuY2lsRnVuY0RpcnR5PSExLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITEsdGhpcy51c2VTdGVuY2lsR2xvYmFsT25seT0hMSxlJiZ0aGlzLnJlc2V0KCl9Z2V0IGlzRGlydHkoKXtyZXR1cm4gdGhpcy5faXNTdGVuY2lsVGVzdERpcnR5fHx0aGlzLl9pc1N0ZW5jaWxNYXNrRGlydHl8fHRoaXMuX2lzU3RlbmNpbEZ1bmNEaXJ0eXx8dGhpcy5faXNTdGVuY2lsT3BEaXJ0eX1nZXQgZnVuYygpe3JldHVybiB0aGlzLl9mdW5jfXNldCBmdW5jKGUpe3RoaXMuX2Z1bmMhPT1lJiYodGhpcy5fZnVuYz1lLHRoaXMuX2lzU3RlbmNpbEZ1bmNEaXJ0eT0hMCl9Z2V0IGZ1bmNSZWYoKXtyZXR1cm4gdGhpcy5fZnVuY1JlZn1zZXQgZnVuY1JlZihlKXt0aGlzLl9mdW5jUmVmIT09ZSYmKHRoaXMuX2Z1bmNSZWY9ZSx0aGlzLl9pc1N0ZW5jaWxGdW5jRGlydHk9ITApfWdldCBmdW5jTWFzaygpe3JldHVybiB0aGlzLl9mdW5jTWFza31zZXQgZnVuY01hc2soZSl7dGhpcy5fZnVuY01hc2shPT1lJiYodGhpcy5fZnVuY01hc2s9ZSx0aGlzLl9pc1N0ZW5jaWxGdW5jRGlydHk9ITApfWdldCBvcFN0ZW5jaWxGYWlsKCl7cmV0dXJuIHRoaXMuX29wU3RlbmNpbEZhaWx9c2V0IG9wU3RlbmNpbEZhaWwoZSl7dGhpcy5fb3BTdGVuY2lsRmFpbCE9PWUmJih0aGlzLl9vcFN0ZW5jaWxGYWlsPWUsdGhpcy5faXNTdGVuY2lsT3BEaXJ0eT0hMCl9Z2V0IG9wRGVwdGhGYWlsKCl7cmV0dXJuIHRoaXMuX29wRGVwdGhGYWlsfXNldCBvcERlcHRoRmFpbChlKXt0aGlzLl9vcERlcHRoRmFpbCE9PWUmJih0aGlzLl9vcERlcHRoRmFpbD1lLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITApfWdldCBvcFN0ZW5jaWxEZXB0aFBhc3MoKXtyZXR1cm4gdGhpcy5fb3BTdGVuY2lsRGVwdGhQYXNzfXNldCBvcFN0ZW5jaWxEZXB0aFBhc3MoZSl7dGhpcy5fb3BTdGVuY2lsRGVwdGhQYXNzIT09ZSYmKHRoaXMuX29wU3RlbmNpbERlcHRoUGFzcz1lLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITApfWdldCBtYXNrKCl7cmV0dXJuIHRoaXMuX21hc2t9c2V0IG1hc2soZSl7dGhpcy5fbWFzayE9PWUmJih0aGlzLl9tYXNrPWUsdGhpcy5faXNTdGVuY2lsTWFza0RpcnR5PSEwKX1nZXQgZW5hYmxlZCgpe3JldHVybiB0aGlzLl9lbmFibGVkfXNldCBlbmFibGVkKGUpe3RoaXMuX2VuYWJsZWQhPT1lJiYodGhpcy5fZW5hYmxlZD1lLHRoaXMuX2lzU3RlbmNpbFRlc3REaXJ0eT0hMCl9cmVzZXQoKXt2YXIgZTt0aGlzLnN0ZW5jaWxNYXRlcmlhbD12b2lkIDAsKGU9dGhpcy5zdGVuY2lsR2xvYmFsKT09PW51bGx8fGU9PT12b2lkIDB8fGUucmVzZXQoKSx0aGlzLl9pc1N0ZW5jaWxUZXN0RGlydHk9ITAsdGhpcy5faXNTdGVuY2lsTWFza0RpcnR5PSEwLHRoaXMuX2lzU3RlbmNpbEZ1bmNEaXJ0eT0hMCx0aGlzLl9pc1N0ZW5jaWxPcERpcnR5PSEwfWFwcGx5KGUpe3ZhciB0O2lmKCFlKXJldHVybjtjb25zdCBpPSF0aGlzLnVzZVN0ZW5jaWxHbG9iYWxPbmx5JiYhISghKCh0PXRoaXMuc3RlbmNpbE1hdGVyaWFsKT09PW51bGx8fHQ9PT12b2lkIDApJiZ0LmVuYWJsZWQpO3RoaXMuZW5hYmxlZD1pP3RoaXMuc3RlbmNpbE1hdGVyaWFsLmVuYWJsZWQ6dGhpcy5zdGVuY2lsR2xvYmFsLmVuYWJsZWQsdGhpcy5mdW5jPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwuZnVuYzp0aGlzLnN0ZW5jaWxHbG9iYWwuZnVuYyx0aGlzLmZ1bmNSZWY9aT90aGlzLnN0ZW5jaWxNYXRlcmlhbC5mdW5jUmVmOnRoaXMuc3RlbmNpbEdsb2JhbC5mdW5jUmVmLHRoaXMuZnVuY01hc2s9aT90aGlzLnN0ZW5jaWxNYXRlcmlhbC5mdW5jTWFzazp0aGlzLnN0ZW5jaWxHbG9iYWwuZnVuY01hc2ssdGhpcy5vcFN0ZW5jaWxGYWlsPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwub3BTdGVuY2lsRmFpbDp0aGlzLnN0ZW5jaWxHbG9iYWwub3BTdGVuY2lsRmFpbCx0aGlzLm9wRGVwdGhGYWlsPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwub3BEZXB0aEZhaWw6dGhpcy5zdGVuY2lsR2xvYmFsLm9wRGVwdGhGYWlsLHRoaXMub3BTdGVuY2lsRGVwdGhQYXNzPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwub3BTdGVuY2lsRGVwdGhQYXNzOnRoaXMuc3RlbmNpbEdsb2JhbC5vcFN0ZW5jaWxEZXB0aFBhc3MsdGhpcy5tYXNrPWk/dGhpcy5zdGVuY2lsTWF0ZXJpYWwubWFzazp0aGlzLnN0ZW5jaWxHbG9iYWwubWFzayx0aGlzLmlzRGlydHkmJih0aGlzLl9pc1N0ZW5jaWxUZXN0RGlydHkmJih0aGlzLmVuYWJsZWQ/ZS5lbmFibGUoZS5TVEVOQ0lMX1RFU1QpOmUuZGlzYWJsZShlLlNURU5DSUxfVEVTVCksdGhpcy5faXNTdGVuY2lsVGVzdERpcnR5PSExKSx0aGlzLl9pc1N0ZW5jaWxNYXNrRGlydHkmJihlLnN0ZW5jaWxNYXNrKHRoaXMubWFzayksdGhpcy5faXNTdGVuY2lsTWFza0RpcnR5PSExKSx0aGlzLl9pc1N0ZW5jaWxGdW5jRGlydHkmJihlLnN0ZW5jaWxGdW5jKHRoaXMuZnVuYyx0aGlzLmZ1bmNSZWYsdGhpcy5mdW5jTWFzayksdGhpcy5faXNTdGVuY2lsRnVuY0RpcnR5PSExKSx0aGlzLl9pc1N0ZW5jaWxPcERpcnR5JiYoZS5zdGVuY2lsT3AodGhpcy5vcFN0ZW5jaWxGYWlsLHRoaXMub3BEZXB0aEZhaWwsdGhpcy5vcFN0ZW5jaWxEZXB0aFBhc3MpLHRoaXMuX2lzU3RlbmNpbE9wRGlydHk9ITEpKX19Y2xhc3MgYWl7c3RhdGljIGdldCBOb3coKXtyZXR1cm4gcHMuSXNXaW5kb3dPYmplY3RFeGlzdCgpJiZ3aW5kb3cucGVyZm9ybWFuY2UmJndpbmRvdy5wZXJmb3JtYW5jZS5ub3c/d2luZG93LnBlcmZvcm1hbmNlLm5vdygpOkRhdGUubm93KCl9fWNsYXNzIHVue31jbGFzcyBvZXtjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLl9uYW1lPSJXZWJHTCIsdGhpcy5mb3JjZVBPVFRleHR1cmVzPSExLHRoaXMuaXNGdWxsc2NyZWVuPSExLHRoaXMuY3VsbEJhY2tGYWNlcz1udWxsLHRoaXMucmVuZGVyRXZlbkluQmFja2dyb3VuZD0hMCx0aGlzLnByZXZlbnRDYWNoZVdpcGVCZXR3ZWVuRnJhbWVzPSExLHRoaXMudmFsaWRhdGVTaGFkZXJQcm9ncmFtcz0hMSx0aGlzLl91c2VSZXZlcnNlRGVwdGhCdWZmZXI9ITEsdGhpcy5pc05EQ0hhbGZaUmFuZ2U9ITEsdGhpcy5oYXNPcmlnaW5Cb3R0b21MZWZ0PSEwLHRoaXMuZGlzYWJsZVVuaWZvcm1CdWZmZXJzPSExLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9mcmFtZUlkPTAsdGhpcy5fdW5pZm9ybUJ1ZmZlcnM9bmV3IEFycmF5LHRoaXMuX3N0b3JhZ2VCdWZmZXJzPW5ldyBBcnJheSx0aGlzLl93ZWJHTFZlcnNpb249MSx0aGlzLl93aW5kb3dJc0JhY2tncm91bmQ9ITEsdGhpcy5faGlnaFByZWNpc2lvblNoYWRlcnNBbGxvd2VkPSEwLHRoaXMuX2JhZE9TPSExLHRoaXMuX2JhZERlc2t0b3BPUz0hMSx0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSExLHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzPW5ldyBBcnJheSx0aGlzLm9uQ29udGV4dExvc3RPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25Db250ZXh0UmVzdG9yZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2NvbnRleHRXYXNMb3N0PSExLHRoaXMuX2RvTm90SGFuZGxlQ29udGV4dExvc3Q9ITEsdGhpcy5kaXNhYmxlVmVydGV4QXJyYXlPYmplY3RzPSExLHRoaXMuX2NvbG9yV3JpdGU9ITAsdGhpcy5fY29sb3JXcml0ZUNoYW5nZWQ9ITAsdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGU9bmV3IHJuLHRoaXMuX3N0ZW5jaWxTdGF0ZUNvbXBvc2VyPW5ldyBjbix0aGlzLl9zdGVuY2lsU3RhdGU9bmV3IEx0LHRoaXMuX2FscGhhU3RhdGU9bmV3IG5uLHRoaXMuX2FscGhhTW9kZT0xLHRoaXMuX2FscGhhRXF1YXRpb249MCx0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGU9bmV3IEFycmF5LHRoaXMuX3JlbmRlclRhcmdldFdyYXBwZXJDYWNoZT1uZXcgQXJyYXksdGhpcy5fYWN0aXZlQ2hhbm5lbD0wLHRoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbD0tMSx0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGU9e30sdGhpcy5fY29tcGlsZWRFZmZlY3RzPXt9LHRoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWQ9W10sdGhpcy5fdWludEluZGljZXNDdXJyZW50bHlTZXQ9ITEsdGhpcy5fY3VycmVudEJvdW5kQnVmZmVyPW5ldyBBcnJheSx0aGlzLl9jdXJyZW50RnJhbWVidWZmZXI9bnVsbCx0aGlzLl9kdW1teUZyYW1lYnVmZmVyPW51bGwsdGhpcy5fY3VycmVudEJ1ZmZlclBvaW50ZXJzPW5ldyBBcnJheSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnM9bmV3IEFycmF5LHRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnM9bmV3IEFycmF5LHRoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3M9ITEsdGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzPSExLHRoaXMuX25leHRGcmVlVGV4dHVyZVNsb3RzPW5ldyBBcnJheSx0aGlzLl9tYXhTaW11bHRhbmVvdXNUZXh0dXJlcz0wLHRoaXMuX21heE1TQUFTYW1wbGVzT3ZlcnJpZGU9bnVsbCx0aGlzLl9hY3RpdmVSZXF1ZXN0cz1uZXcgQXJyYXksdGhpcy5hZGFwdFRvRGV2aWNlUmF0aW89ITEsdGhpcy5fbGFzdERldmljZVBpeGVsUmF0aW89MSx0aGlzLl90cmFuc2Zvcm1UZXh0dXJlVXJsPW51bGwsdGhpcy5ob3N0SW5mb3JtYXRpb249e2lzTW9iaWxlOiExfSx0aGlzLnByZW11bHRpcGxpZWRBbHBoYT0hMCx0aGlzLm9uQmVmb3JlVGV4dHVyZUluaXRPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2lzV2ViR1BVPSExLHRoaXMuX3NuYXBzaG90UmVuZGVyaW5nTW9kZT0wLHRoaXMuX3VzZUV4YWN0U3JnYkNvbnZlcnNpb25zPSExLHRoaXMuX3ZpZXdwb3J0Q2FjaGVkPXt4OjAseTowLHo6MCx3OjB9LHRoaXMuX3VucGFja0ZsaXBZQ2FjaGVkPW51bGwsdGhpcy5lbmFibGVVbnBhY2tGbGlwWUNhY2hlZD0hMCx0aGlzLl9ib3VuZFVuaWZvcm1zPXt9LHRoaXMuc3RhcnRUaW1lPWFpLk5vdztsZXQgcj1udWxsO2lmKGk9aXx8e30sdGhpcy5fY3JlYXRpb25PcHRpb25zPWksdGhpcy5hZGFwdFRvRGV2aWNlUmF0aW89cz8/ITEsdGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXIuc3RlbmNpbEdsb2JhbD10aGlzLl9zdGVuY2lsU3RhdGUsVWUuU2V0TWF0cml4UHJlY2lzaW9uKCEhaS51c2VIaWdoUHJlY2lzaW9uTWF0cml4KSwhZSlyZXR1cm47aWYocz1zfHxpLmFkYXB0VG9EZXZpY2VSYXRpb3x8ITEsZS5nZXRDb250ZXh0KXtpZihyPWUsdGhpcy5fcmVuZGVyaW5nQ2FudmFzPXIsdCE9PXZvaWQgMCYmKGkuYW50aWFsaWFzPXQpLGkuZGV0ZXJtaW5pc3RpY0xvY2tzdGVwPT09dm9pZCAwJiYoaS5kZXRlcm1pbmlzdGljTG9ja3N0ZXA9ITEpLGkubG9ja3N0ZXBNYXhTdGVwcz09PXZvaWQgMCYmKGkubG9ja3N0ZXBNYXhTdGVwcz00KSxpLnRpbWVTdGVwPT09dm9pZCAwJiYoaS50aW1lU3RlcD0xLzYwKSxpLnByZXNlcnZlRHJhd2luZ0J1ZmZlcj09PXZvaWQgMCYmKGkucHJlc2VydmVEcmF3aW5nQnVmZmVyPSExKSxpLmF1ZGlvRW5naW5lPT09dm9pZCAwJiYoaS5hdWRpb0VuZ2luZT0hMCksaS5hdWRpb0VuZ2luZU9wdGlvbnMhPT12b2lkIDAmJmkuYXVkaW9FbmdpbmVPcHRpb25zLmF1ZGlvQ29udGV4dCE9PXZvaWQgMCYmKHRoaXMuX2F1ZGlvQ29udGV4dD1pLmF1ZGlvRW5naW5lT3B0aW9ucy5hdWRpb0NvbnRleHQpLGkuYXVkaW9FbmdpbmVPcHRpb25zIT09dm9pZCAwJiZpLmF1ZGlvRW5naW5lT3B0aW9ucy5hdWRpb0Rlc3RpbmF0aW9uIT09dm9pZCAwJiYodGhpcy5fYXVkaW9EZXN0aW5hdGlvbj1pLmF1ZGlvRW5naW5lT3B0aW9ucy5hdWRpb0Rlc3RpbmF0aW9uKSxpLnN0ZW5jaWw9PT12b2lkIDAmJihpLnN0ZW5jaWw9ITApLGkucHJlbXVsdGlwbGllZEFscGhhPT09ITEmJih0aGlzLnByZW11bHRpcGxpZWRBbHBoYT0hMSksaS54ckNvbXBhdGlibGU9PT12b2lkIDAmJihpLnhyQ29tcGF0aWJsZT0hMCksaS51c2VFeGFjdFNyZ2JDb252ZXJzaW9ucyE9PXZvaWQgMCYmKHRoaXMuX3VzZUV4YWN0U3JnYkNvbnZlcnNpb25zPWkudXNlRXhhY3RTcmdiQ29udmVyc2lvbnMpLHRoaXMuX2RvTm90SGFuZGxlQ29udGV4dExvc3Q9ISFpLmRvTm90SGFuZGxlQ29udGV4dExvc3QsbmF2aWdhdG9yJiZuYXZpZ2F0b3IudXNlckFnZW50KXt0aGlzLl9jaGVja0Zvck1vYmlsZT0oKT0+e2NvbnN0IGw9bmF2aWdhdG9yLnVzZXJBZ2VudDt0aGlzLmhvc3RJbmZvcm1hdGlvbi5pc01vYmlsZT1sLmluZGV4T2YoIk1vYmlsZSIpIT09LTF8fGwuaW5kZXhPZigiTWFjIikhPT0tMSYmQ2koKSYmIm9udG91Y2hlbmQiaW4gZG9jdW1lbnR9LHRoaXMuX2NoZWNrRm9yTW9iaWxlKCksamUoKSYmd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsdGhpcy5fY2hlY2tGb3JNb2JpbGUpO2NvbnN0IGg9bmF2aWdhdG9yLnVzZXJBZ2VudDtmb3IoY29uc3QgbCBvZiBvZS5FeGNlcHRpb25MaXN0KXtjb25zdCB1PWwua2V5LGQ9bC50YXJnZXRzO2lmKG5ldyBSZWdFeHAodSkudGVzdChoKSl7aWYobC5jYXB0dXJlJiZsLmNhcHR1cmVDb25zdHJhaW50KXtjb25zdCBfPWwuY2FwdHVyZSxFPWwuY2FwdHVyZUNvbnN0cmFpbnQsdj1uZXcgUmVnRXhwKF8pLmV4ZWMoaCk7aWYodiYmdi5sZW5ndGg+MCYmcGFyc2VJbnQodlt2Lmxlbmd0aC0xXSk+PUUpY29udGludWV9Zm9yKGNvbnN0IF8gb2YgZClzd2l0Y2goXyl7Y2FzZSJ1bmlmb3JtQnVmZmVyIjp0aGlzLmRpc2FibGVVbmlmb3JtQnVmZmVycz0hMDticmVhaztjYXNlInZhbyI6dGhpcy5kaXNhYmxlVmVydGV4QXJyYXlPYmplY3RzPSEwO2JyZWFrO2Nhc2UiYW50aWFsaWFzIjppLmFudGlhbGlhcz0hMTticmVhaztjYXNlIm1heE1TQUFTYW1wbGVzIjp0aGlzLl9tYXhNU0FBU2FtcGxlc092ZXJyaWRlPTE7YnJlYWt9fX19aWYodGhpcy5fZG9Ob3RIYW5kbGVDb250ZXh0TG9zdHx8KHRoaXMuX29uQ29udGV4dExvc3Q9aD0+e2gucHJldmVudERlZmF1bHQoKSx0aGlzLl9jb250ZXh0V2FzTG9zdD0hMCxPLldhcm4oIldlYkdMIGNvbnRleHQgbG9zdC4iKSx0aGlzLm9uQ29udGV4dExvc3RPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX0sdGhpcy5fb25Db250ZXh0UmVzdG9yZWQ9KCk9Pnt0aGlzLl9yZXN0b3JlRW5naW5lQWZ0ZXJDb250ZXh0TG9zdCh0aGlzLl9pbml0R0xDb250ZXh0LmJpbmQodGhpcykpfSxyLmFkZEV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dGxvc3QiLHRoaXMuX29uQ29udGV4dExvc3QsITEpLHIuYWRkRXZlbnRMaXN0ZW5lcigid2ViZ2xjb250ZXh0cmVzdG9yZWQiLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkLCExKSxpLnBvd2VyUHJlZmVyZW5jZT0iaGlnaC1wZXJmb3JtYW5jZSIpLHRoaXMuX2JhZERlc2t0b3BPUz0vXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLHRoaXMuX2JhZERlc2t0b3BPUyYmKGkueHJDb21wYXRpYmxlPSExKSwhaS5kaXNhYmxlV2ViR0wyU3VwcG9ydCl0cnl7dGhpcy5fZ2w9ci5nZXRDb250ZXh0KCJ3ZWJnbDIiLGkpfHxyLmdldENvbnRleHQoImV4cGVyaW1lbnRhbC13ZWJnbDIiLGkpLHRoaXMuX2dsJiYodGhpcy5fd2ViR0xWZXJzaW9uPTIsdGhpcy5fc2hhZGVyUGxhdGZvcm1OYW1lPSJXRUJHTDIiLHRoaXMuX2dsLmRlbGV0ZVF1ZXJ5fHwodGhpcy5fd2ViR0xWZXJzaW9uPTEsdGhpcy5fc2hhZGVyUGxhdGZvcm1OYW1lPSJXRUJHTDEiKSl9Y2F0Y2h7fWlmKCF0aGlzLl9nbCl7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJUaGUgcHJvdmlkZWQgY2FudmFzIGlzIG51bGwgb3IgdW5kZWZpbmVkLiIpO3RyeXt0aGlzLl9nbD1yLmdldENvbnRleHQoIndlYmdsIixpKXx8ci5nZXRDb250ZXh0KCJleHBlcmltZW50YWwtd2ViZ2wiLGkpfWNhdGNoe3Rocm93IG5ldyBFcnJvcigiV2ViR0wgbm90IHN1cHBvcnRlZCIpfX1pZighdGhpcy5fZ2wpdGhyb3cgbmV3IEVycm9yKCJXZWJHTCBub3Qgc3VwcG9ydGVkIil9ZWxzZXt0aGlzLl9nbD1lLHRoaXMuX3JlbmRlcmluZ0NhbnZhcz10aGlzLl9nbC5jYW52YXMsdGhpcy5fZ2wucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlPyh0aGlzLl93ZWJHTFZlcnNpb249Mix0aGlzLl9zaGFkZXJQbGF0Zm9ybU5hbWU9IldFQkdMMiIpOnRoaXMuX3NoYWRlclBsYXRmb3JtTmFtZT0iV0VCR0wxIjtjb25zdCBoPXRoaXMuX2dsLmdldENvbnRleHRBdHRyaWJ1dGVzKCk7aCYmKGkuc3RlbmNpbD1oLnN0ZW5jaWwpfXRoaXMuX2dsLnBpeGVsU3RvcmVpKHRoaXMuX2dsLlVOUEFDS19DT0xPUlNQQUNFX0NPTlZFUlNJT05fV0VCR0wsdGhpcy5fZ2wuTk9ORSksaS51c2VIaWdoUHJlY2lzaW9uRmxvYXRzIT09dm9pZCAwJiYodGhpcy5faGlnaFByZWNpc2lvblNoYWRlcnNBbGxvd2VkPWkudXNlSGlnaFByZWNpc2lvbkZsb2F0cyk7Y29uc3Qgbj1qZSgpJiZ3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpb3x8MSxhPWkubGltaXREZXZpY2VSYXRpb3x8bjt0aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbD1zPzEvTWF0aC5taW4oYSxuKToxLHRoaXMuX2xhc3REZXZpY2VQaXhlbFJhdGlvPW4sdGhpcy5yZXNpemUoKSx0aGlzLl9pc1N0ZW5jaWxFbmFibGU9ISFpLnN0ZW5jaWwsdGhpcy5faW5pdEdMQ29udGV4dCgpLHRoaXMuX2luaXRGZWF0dXJlcygpO2ZvcihsZXQgaD0wO2g8dGhpcy5fY2Fwcy5tYXhWZXJ0ZXhBdHRyaWJzO2grKyl0aGlzLl9jdXJyZW50QnVmZmVyUG9pbnRlcnNbaF09bmV3IHVuO3RoaXMuX3NoYWRlclByb2Nlc3Nvcj10aGlzLndlYkdMVmVyc2lvbj4xP25ldyBvbjpuZXcgYW4sdGhpcy5fYmFkT1M9L2lQYWQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpfHwvaVBob25lL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtjb25zdCBvPWBCYWJ5bG9uLmpzIHYke29lLlZlcnNpb259YDtjb25zb2xlLmxvZyhvK2AgLSAke3RoaXMuZGVzY3JpcHRpb259YCksdGhpcy5fcmVuZGVyaW5nQ2FudmFzJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMuc2V0QXR0cmlidXRlJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMuc2V0QXR0cmlidXRlKCJkYXRhLWVuZ2luZSIsbyl9c3RhdGljIGdldCBOcG1QYWNrYWdlKCl7cmV0dXJuImJhYnlsb25qc0A1LjQzLjAifXN0YXRpYyBnZXQgVmVyc2lvbigpe3JldHVybiI1LjQzLjAifWdldCBkZXNjcmlwdGlvbigpe2xldCBlPXRoaXMubmFtZSt0aGlzLndlYkdMVmVyc2lvbjtyZXR1cm4gdGhpcy5fY2Fwcy5wYXJhbGxlbFNoYWRlckNvbXBpbGUmJihlKz0iIC0gUGFyYWxsZWwgc2hhZGVyIGNvbXBpbGF0aW9uIiksZX1nZXQgbmFtZSgpe3JldHVybiB0aGlzLl9uYW1lfXNldCBuYW1lKGUpe3RoaXMuX25hbWU9ZX1nZXQgdmVyc2lvbigpe3JldHVybiB0aGlzLl93ZWJHTFZlcnNpb259c3RhdGljIGdldCBTaGFkZXJzUmVwb3NpdG9yeSgpe3JldHVybiBQZS5TaGFkZXJzUmVwb3NpdG9yeX1zdGF0aWMgc2V0IFNoYWRlcnNSZXBvc2l0b3J5KGUpe1BlLlNoYWRlcnNSZXBvc2l0b3J5PWV9X2dldFNoYWRlclByb2Nlc3NvcihlKXtyZXR1cm4gdGhpcy5fc2hhZGVyUHJvY2Vzc29yfWdldCB1c2VSZXZlcnNlRGVwdGhCdWZmZXIoKXtyZXR1cm4gdGhpcy5fdXNlUmV2ZXJzZURlcHRoQnVmZmVyfXNldCB1c2VSZXZlcnNlRGVwdGhCdWZmZXIoZSl7ZSE9PXRoaXMuX3VzZVJldmVyc2VEZXB0aEJ1ZmZlciYmKHRoaXMuX3VzZVJldmVyc2VEZXB0aEJ1ZmZlcj1lLGU/dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jPTUxODp0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aEZ1bmM9NTE1KX1nZXQgZnJhbWVJZCgpe3JldHVybiB0aGlzLl9mcmFtZUlkfWdldCBzdXBwb3J0c1VuaWZvcm1CdWZmZXJzKCl7cmV0dXJuIHRoaXMud2ViR0xWZXJzaW9uPjEmJiF0aGlzLmRpc2FibGVVbmlmb3JtQnVmZmVyc31nZXRDcmVhdGlvbk9wdGlvbnMoKXtyZXR1cm4gdGhpcy5fY3JlYXRpb25PcHRpb25zfWdldCBfc2hvdWxkVXNlSGlnaFByZWNpc2lvblNoYWRlcigpe3JldHVybiEhKHRoaXMuX2NhcHMuaGlnaFByZWNpc2lvblNoYWRlclN1cHBvcnRlZCYmdGhpcy5faGlnaFByZWNpc2lvblNoYWRlcnNBbGxvd2VkKX1nZXQgbmVlZFBPVFRleHR1cmVzKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbjwyfHx0aGlzLmZvcmNlUE9UVGV4dHVyZXN9Z2V0IGFjdGl2ZVJlbmRlckxvb3BzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzfWdldCBkb05vdEhhbmRsZUNvbnRleHRMb3N0KCl7cmV0dXJuIHRoaXMuX2RvTm90SGFuZGxlQ29udGV4dExvc3R9c2V0IGRvTm90SGFuZGxlQ29udGV4dExvc3QoZSl7dGhpcy5fZG9Ob3RIYW5kbGVDb250ZXh0TG9zdD1lfWdldCBfc3VwcG9ydHNIYXJkd2FyZVRleHR1cmVSZXNjYWxpbmcoKXtyZXR1cm4hMX1zZXQgZnJhbWVidWZmZXJEaW1lbnNpb25zT2JqZWN0KGUpe3RoaXMuX2ZyYW1lYnVmZmVyRGltZW5zaW9uc09iamVjdD1lfWdldCBjdXJyZW50Vmlld3BvcnQoKXtyZXR1cm4gdGhpcy5fY2FjaGVkVmlld3BvcnR9Z2V0IGVtcHR5VGV4dHVyZSgpe3JldHVybiB0aGlzLl9lbXB0eVRleHR1cmV8fCh0aGlzLl9lbXB0eVRleHR1cmU9dGhpcy5jcmVhdGVSYXdUZXh0dXJlKG5ldyBVaW50OEFycmF5KDQpLDEsMSw1LCExLCExLDEpKSx0aGlzLl9lbXB0eVRleHR1cmV9Z2V0IGVtcHR5VGV4dHVyZTNEKCl7cmV0dXJuIHRoaXMuX2VtcHR5VGV4dHVyZTNEfHwodGhpcy5fZW1wdHlUZXh0dXJlM0Q9dGhpcy5jcmVhdGVSYXdUZXh0dXJlM0QobmV3IFVpbnQ4QXJyYXkoNCksMSwxLDEsNSwhMSwhMSwxKSksdGhpcy5fZW1wdHlUZXh0dXJlM0R9Z2V0IGVtcHR5VGV4dHVyZTJEQXJyYXkoKXtyZXR1cm4gdGhpcy5fZW1wdHlUZXh0dXJlMkRBcnJheXx8KHRoaXMuX2VtcHR5VGV4dHVyZTJEQXJyYXk9dGhpcy5jcmVhdGVSYXdUZXh0dXJlMkRBcnJheShuZXcgVWludDhBcnJheSg0KSwxLDEsMSw1LCExLCExLDEpKSx0aGlzLl9lbXB0eVRleHR1cmUyREFycmF5fWdldCBlbXB0eUN1YmVUZXh0dXJlKCl7aWYoIXRoaXMuX2VtcHR5Q3ViZVRleHR1cmUpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoNCksdD1bZSxlLGUsZSxlLGVdO3RoaXMuX2VtcHR5Q3ViZVRleHR1cmU9dGhpcy5jcmVhdGVSYXdDdWJlVGV4dHVyZSh0LDEsNSwwLCExLCExLDEpfXJldHVybiB0aGlzLl9lbXB0eUN1YmVUZXh0dXJlfWdldCBpc1dlYkdQVSgpe3JldHVybiB0aGlzLl9pc1dlYkdQVX1nZXQgc2hhZGVyUGxhdGZvcm1OYW1lKCl7cmV0dXJuIHRoaXMuX3NoYWRlclBsYXRmb3JtTmFtZX1nZXQgc25hcHNob3RSZW5kZXJpbmcoKXtyZXR1cm4hMX1zZXQgc25hcHNob3RSZW5kZXJpbmcoZSl7fWdldCBzbmFwc2hvdFJlbmRlcmluZ01vZGUoKXtyZXR1cm4gdGhpcy5fc25hcHNob3RSZW5kZXJpbmdNb2RlfXNldCBzbmFwc2hvdFJlbmRlcmluZ01vZGUoZSl7dGhpcy5fc25hcHNob3RSZW5kZXJpbmdNb2RlPWV9Z2V0IHVzZUV4YWN0U3JnYkNvbnZlcnNpb25zKCl7cmV0dXJuIHRoaXMuX3VzZUV4YWN0U3JnYkNvbnZlcnNpb25zfXNuYXBzaG90UmVuZGVyaW5nUmVzZXQoKXt0aGlzLnNuYXBzaG90UmVuZGVyaW5nPSExfXN0YXRpYyBfQ3JlYXRlQ2FudmFzKGUsdCl7aWYodHlwZW9mIGRvY3VtZW50PiJ1IilyZXR1cm4gbmV3IE9mZnNjcmVlbkNhbnZhcyhlLHQpO2NvbnN0IGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7cmV0dXJuIGkud2lkdGg9ZSxpLmhlaWdodD10LGl9Y3JlYXRlQ2FudmFzKGUsdCl7cmV0dXJuIG9lLl9DcmVhdGVDYW52YXMoZSx0KX1jcmVhdGVDYW52YXNJbWFnZSgpe3JldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKX1fcmVzdG9yZUVuZ2luZUFmdGVyQ29udGV4dExvc3QoZSl7c2V0VGltZW91dChhc3luYygpPT57dmFyIHQ7dGhpcy5fZHVtbXlGcmFtZWJ1ZmZlcj1udWxsO2NvbnN0IGk9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0LHM9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jLHI9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhNYXNrLG49dGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxUZXN0O2F3YWl0IGUoKSx0aGlzLndpcGVDYWNoZXMoITApLHRoaXMuX3JlYnVpbGRFZmZlY3RzKCksKHQ9dGhpcy5fcmVidWlsZENvbXB1dGVFZmZlY3RzKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuY2FsbCh0aGlzKSx0aGlzLl9yZWJ1aWxkQnVmZmVycygpLHRoaXMuX3JlYnVpbGRJbnRlcm5hbFRleHR1cmVzKCksdGhpcy5fcmVidWlsZFJlbmRlclRhcmdldFdyYXBwZXJzKCksdGhpcy53aXBlQ2FjaGVzKCEwKSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aFRlc3Q9aSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aEZ1bmM9cyx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aE1hc2s9cix0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbFRlc3Q9bixPLldhcm4odGhpcy5uYW1lKyIgY29udGV4dCBzdWNjZXNzZnVsbHkgcmVzdG9yZWQuIiksdGhpcy5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX2NvbnRleHRXYXNMb3N0PSExfSwwKX1fc2hhcmVkSW5pdChlLHQsaSl7dGhpcy5fcmVuZGVyaW5nQ2FudmFzPWV9X2dldFNoYWRlclByb2Nlc3NpbmdDb250ZXh0KGUpe3JldHVybiBudWxsfV9yZWJ1aWxkSW50ZXJuYWxUZXh0dXJlcygpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnNsaWNlKCk7Zm9yKGNvbnN0IHQgb2YgZSl0Ll9yZWJ1aWxkKCl9X3JlYnVpbGRSZW5kZXJUYXJnZXRXcmFwcGVycygpe2NvbnN0IGU9dGhpcy5fcmVuZGVyVGFyZ2V0V3JhcHBlckNhY2hlLnNsaWNlKCk7Zm9yKGNvbnN0IHQgb2YgZSl0Ll9yZWJ1aWxkKCl9X3JlYnVpbGRFZmZlY3RzKCl7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fY29tcGlsZWRFZmZlY3RzKXtjb25zdCB0PXRoaXMuX2NvbXBpbGVkRWZmZWN0c1tlXTt0Ll9waXBlbGluZUNvbnRleHQ9bnVsbCx0Ll93YXNQcmV2aW91c2x5UmVhZHk9ITEsdC5fcHJlcGFyZUVmZmVjdCgpfVBlLlJlc2V0Q2FjaGUoKX1hcmVBbGxFZmZlY3RzUmVhZHkoKXtmb3IoY29uc3QgZSBpbiB0aGlzLl9jb21waWxlZEVmZmVjdHMpaWYoIXRoaXMuX2NvbXBpbGVkRWZmZWN0c1tlXS5pc1JlYWR5KCkpcmV0dXJuITE7cmV0dXJuITB9X3JlYnVpbGRCdWZmZXJzKCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5fdW5pZm9ybUJ1ZmZlcnMpZS5fcmVidWlsZCgpO2Zvcihjb25zdCBlIG9mIHRoaXMuX3N0b3JhZ2VCdWZmZXJzKWUuX3JlYnVpbGQoKX1faW5pdEdMQ29udGV4dCgpe3ZhciBlO3RoaXMuX2NhcHM9e21heFRleHR1cmVzSW1hZ2VVbml0czp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1RFWFRVUkVfSU1BR0VfVU5JVFMpLG1heENvbWJpbmVkVGV4dHVyZXNJbWFnZVVuaXRzOnRoaXMuX2dsLmdldFBhcmFtZXRlcih0aGlzLl9nbC5NQVhfQ09NQklORURfVEVYVFVSRV9JTUFHRV9VTklUUyksbWF4VmVydGV4VGV4dHVyZUltYWdlVW5pdHM6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9WRVJURVhfVEVYVFVSRV9JTUFHRV9VTklUUyksbWF4VGV4dHVyZVNpemU6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9URVhUVVJFX1NJWkUpLG1heFNhbXBsZXM6dGhpcy5fd2ViR0xWZXJzaW9uPjE/dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9TQU1QTEVTKToxLG1heEN1YmVtYXBUZXh0dXJlU2l6ZTp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX0NVQkVfTUFQX1RFWFRVUkVfU0laRSksbWF4UmVuZGVyVGV4dHVyZVNpemU6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9SRU5ERVJCVUZGRVJfU0laRSksbWF4VmVydGV4QXR0cmliczp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1ZFUlRFWF9BVFRSSUJTKSxtYXhWYXJ5aW5nVmVjdG9yczp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX1ZBUllJTkdfVkVDVE9SUyksbWF4RnJhZ21lbnRVbmlmb3JtVmVjdG9yczp0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuTUFYX0ZSQUdNRU5UX1VOSUZPUk1fVkVDVE9SUyksbWF4VmVydGV4VW5pZm9ybVZlY3RvcnM6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9WRVJURVhfVU5JRk9STV9WRUNUT1JTKSxwYXJhbGxlbFNoYWRlckNvbXBpbGU6dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJLSFJfcGFyYWxsZWxfc2hhZGVyX2NvbXBpbGUiKXx8dm9pZCAwLHN0YW5kYXJkRGVyaXZhdGl2ZXM6dGhpcy5fd2ViR0xWZXJzaW9uPjF8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIikhPT1udWxsLG1heEFuaXNvdHJvcHk6MSxhc3RjOnRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2FzdGMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2FzdGMiKSxicHRjOnRoaXMuX2dsLmdldEV4dGVuc2lvbigiRVhUX3RleHR1cmVfY29tcHJlc3Npb25fYnB0YyIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQktJVF9FWFRfdGV4dHVyZV9jb21wcmVzc2lvbl9icHRjIiksczN0Yzp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjIil8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCS0lUX1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjIiksczN0Y19zcmdiOnRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGNfc3JnYiIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQktJVF9XRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0Y19zcmdiIikscHZydGM6dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3B2cnRjIiksZXRjMTp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMxIil8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCS0lUX1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMxIiksZXRjMjp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJLSVRfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2V0YyIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9lczNfMCIpLHRleHR1cmVBbmlzb3Ryb3BpY0ZpbHRlckV4dGVuc2lvbjp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpYyIpfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQktJVF9FWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWMiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJNT1pfRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljIiksdWludEluZGljZXM6dGhpcy5fd2ViR0xWZXJzaW9uPjF8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX2VsZW1lbnRfaW5kZXhfdWludCIpIT09bnVsbCxmcmFnbWVudERlcHRoU3VwcG9ydGVkOnRoaXMuX3dlYkdMVmVyc2lvbj4xfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF9mcmFnX2RlcHRoIikhPT1udWxsLGhpZ2hQcmVjaXNpb25TaGFkZXJTdXBwb3J0ZWQ6ITEsdGltZXJRdWVyeTp0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF9kaXNqb2ludF90aW1lcl9xdWVyeV93ZWJnbDIiKXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJFWFRfZGlzam9pbnRfdGltZXJfcXVlcnkiKSxzdXBwb3J0T2NjbHVzaW9uUXVlcnk6dGhpcy5fd2ViR0xWZXJzaW9uPjEsY2FuVXNlVGltZXN0YW1wRm9yVGltZXJRdWVyeTohMSxkcmF3QnVmZmVyc0V4dGVuc2lvbjohMSxtYXhNU0FBU2FtcGxlczoxLGNvbG9yQnVmZmVyRmxvYXQ6ISEodGhpcy5fd2ViR0xWZXJzaW9uPjEmJnRoaXMuX2dsLmdldEV4dGVuc2lvbigiRVhUX2NvbG9yX2J1ZmZlcl9mbG9hdCIpKSx0ZXh0dXJlRmxvYXQ6ISEodGhpcy5fd2ViR0xWZXJzaW9uPjF8fHRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfZmxvYXQiKSksdGV4dHVyZUhhbGZGbG9hdDohISh0aGlzLl93ZWJHTFZlcnNpb24+MXx8dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0IikpLHRleHR1cmVIYWxmRmxvYXRSZW5kZXI6ITEsdGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nOiExLHRleHR1cmVGbG9hdFJlbmRlcjohMSx0ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nOiExLHZlcnRleEFycmF5T2JqZWN0OiExLGluc3RhbmNlZEFycmF5czohMSx0ZXh0dXJlTE9EOiEhKHRoaXMuX3dlYkdMVmVyc2lvbj4xfHx0aGlzLl9nbC5nZXRFeHRlbnNpb24oIkVYVF9zaGFkZXJfdGV4dHVyZV9sb2QiKSksYmxlbmRNaW5NYXg6ITEsbXVsdGl2aWV3OnRoaXMuX2dsLmdldEV4dGVuc2lvbigiT1ZSX211bHRpdmlldzIiKSxvY3VsdXNNdWx0aXZpZXc6dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJPQ1VMVVNfbXVsdGl2aWV3IiksZGVwdGhUZXh0dXJlRXh0ZW5zaW9uOiExLGNhblVzZUdMSW5zdGFuY2VJRDp0aGlzLl93ZWJHTFZlcnNpb24+MSxjYW5Vc2VHTFZlcnRleElEOnRoaXMuX3dlYkdMVmVyc2lvbj4xLHN1cHBvcnRDb21wdXRlU2hhZGVyczohMSxzdXBwb3J0U1JHQkJ1ZmZlcnM6ITEsc3VwcG9ydFRyYW5zZm9ybUZlZWRiYWNrczp0aGlzLl93ZWJHTFZlcnNpb24+MSx0ZXh0dXJlTWF4TGV2ZWw6dGhpcy5fd2ViR0xWZXJzaW9uPjEsdGV4dHVyZTJEQXJyYXlNYXhMYXllckNvdW50OnRoaXMuX3dlYkdMVmVyc2lvbj4xPzI1NjoxMjh9LHRoaXMuX2dsVmVyc2lvbj10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuVkVSU0lPTik7Y29uc3QgdD10aGlzLl9nbC5nZXRFeHRlbnNpb24oIldFQkdMX2RlYnVnX3JlbmRlcmVyX2luZm8iKTtpZih0IT1udWxsJiYodGhpcy5fZ2xSZW5kZXJlcj10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodC5VTk1BU0tFRF9SRU5ERVJFUl9XRUJHTCksdGhpcy5fZ2xWZW5kb3I9dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHQuVU5NQVNLRURfVkVORE9SX1dFQkdMKSksdGhpcy5fZ2xWZW5kb3J8fCh0aGlzLl9nbFZlbmRvcj10aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuVkVORE9SKXx8IlVua25vd24gdmVuZG9yIiksdGhpcy5fZ2xSZW5kZXJlcnx8KHRoaXMuX2dsUmVuZGVyZXI9dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLlJFTkRFUkVSKXx8IlVua25vd24gcmVuZGVyZXIiKSx0aGlzLl9nbC5IQUxGX0ZMT0FUX09FUyE9PTM2MTkzJiYodGhpcy5fZ2wuSEFMRl9GTE9BVF9PRVM9MzYxOTMpLHRoaXMuX2dsLlJHQkExNkYhPT0zNDg0MiYmKHRoaXMuX2dsLlJHQkExNkY9MzQ4NDIpLHRoaXMuX2dsLlJHQkEzMkYhPT0zNDgzNiYmKHRoaXMuX2dsLlJHQkEzMkY9MzQ4MzYpLHRoaXMuX2dsLkRFUFRIMjRfU1RFTkNJTDghPT0zNTA1NiYmKHRoaXMuX2dsLkRFUFRIMjRfU1RFTkNJTDg9MzUwNTYpLHRoaXMuX2NhcHMudGltZXJRdWVyeSYmKHRoaXMuX3dlYkdMVmVyc2lvbj09PTEmJih0aGlzLl9nbC5nZXRRdWVyeT10aGlzLl9jYXBzLnRpbWVyUXVlcnkuZ2V0UXVlcnlFWFQuYmluZCh0aGlzLl9jYXBzLnRpbWVyUXVlcnkpKSx0aGlzLl9jYXBzLmNhblVzZVRpbWVzdGFtcEZvclRpbWVyUXVlcnk9KChlPXRoaXMuX2dsLmdldFF1ZXJ5KHRoaXMuX2NhcHMudGltZXJRdWVyeS5USU1FU1RBTVBfRVhULHRoaXMuX2NhcHMudGltZXJRdWVyeS5RVUVSWV9DT1VOVEVSX0JJVFNfRVhUKSkhPT1udWxsJiZlIT09dm9pZCAwP2U6MCk+MCksdGhpcy5fY2Fwcy5tYXhBbmlzb3Ryb3B5PXRoaXMuX2NhcHMudGV4dHVyZUFuaXNvdHJvcGljRmlsdGVyRXh0ZW5zaW9uP3RoaXMuX2dsLmdldFBhcmFtZXRlcih0aGlzLl9jYXBzLnRleHR1cmVBbmlzb3Ryb3BpY0ZpbHRlckV4dGVuc2lvbi5NQVhfVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQpOjAsdGhpcy5fY2Fwcy50ZXh0dXJlRmxvYXRMaW5lYXJGaWx0ZXJpbmc9ISEodGhpcy5fY2Fwcy50ZXh0dXJlRmxvYXQmJnRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfZmxvYXRfbGluZWFyIikpLHRoaXMuX2NhcHMudGV4dHVyZUZsb2F0UmVuZGVyPSEhKHRoaXMuX2NhcHMudGV4dHVyZUZsb2F0JiZ0aGlzLl9jYW5SZW5kZXJUb0Zsb2F0RnJhbWVidWZmZXIoKSksdGhpcy5fY2Fwcy50ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nPSEhKHRoaXMuX3dlYkdMVmVyc2lvbj4xfHx0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXQmJnRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3RleHR1cmVfaGFsZl9mbG9hdF9saW5lYXIiKSksdGhpcy5fY2Fwcy5hc3RjJiYodGhpcy5fZ2wuQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfQVNUQ180eDRfS0hSPXRoaXMuX2NhcHMuYXN0Yy5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9BU1RDXzR4NF9LSFIpLHRoaXMuX2NhcHMuYnB0YyYmKHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9CUFRDX1VOT1JNX0VYVD10aGlzLl9jYXBzLmJwdGMuQ09NUFJFU1NFRF9TUkdCX0FMUEhBX0JQVENfVU5PUk1fRVhUKSx0aGlzLl9jYXBzLnMzdGNfc3JnYiYmKHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9TM1RDX0RYVDFfRVhUPXRoaXMuX2NhcHMuczN0Y19zcmdiLkNPTVBSRVNTRURfU1JHQl9TM1RDX0RYVDFfRVhULHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDFfRVhUPXRoaXMuX2NhcHMuczN0Y19zcmdiLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDFfRVhULHRoaXMuX2dsLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDVfRVhUPXRoaXMuX2NhcHMuczN0Y19zcmdiLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDVfRVhUKSx0aGlzLl9jYXBzLmV0YzImJih0aGlzLl9nbC5DT01QUkVTU0VEX1NSR0I4X0VUQzI9dGhpcy5fY2Fwcy5ldGMyLkNPTVBSRVNTRURfU1JHQjhfRVRDMix0aGlzLl9nbC5DT01QUkVTU0VEX1NSR0I4X0FMUEhBOF9FVEMyX0VBQz10aGlzLl9jYXBzLmV0YzIuQ09NUFJFU1NFRF9TUkdCOF9BTFBIQThfRVRDMl9FQUMpLHRoaXMuX3dlYkdMVmVyc2lvbj4xJiZ0aGlzLl9nbC5IQUxGX0ZMT0FUX09FUyE9PTUxMzEmJih0aGlzLl9nbC5IQUxGX0ZMT0FUX09FUz01MTMxKSx0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRSZW5kZXI9dGhpcy5fY2Fwcy50ZXh0dXJlSGFsZkZsb2F0JiZ0aGlzLl9jYW5SZW5kZXJUb0hhbGZGbG9hdEZyYW1lYnVmZmVyKCksdGhpcy5fd2ViR0xWZXJzaW9uPjEpdGhpcy5fY2Fwcy5kcmF3QnVmZmVyc0V4dGVuc2lvbj0hMCx0aGlzLl9jYXBzLm1heE1TQUFTYW1wbGVzPXRoaXMuX21heE1TQUFTYW1wbGVzT3ZlcnJpZGUhPT1udWxsP3RoaXMuX21heE1TQUFTYW1wbGVzT3ZlcnJpZGU6dGhpcy5fZ2wuZ2V0UGFyYW1ldGVyKHRoaXMuX2dsLk1BWF9TQU1QTEVTKTtlbHNle2NvbnN0IGk9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJHTF9kcmF3X2J1ZmZlcnMiKTtpZihpIT09bnVsbCl7dGhpcy5fY2Fwcy5kcmF3QnVmZmVyc0V4dGVuc2lvbj0hMCx0aGlzLl9nbC5kcmF3QnVmZmVycz1pLmRyYXdCdWZmZXJzV0VCR0wuYmluZChpKSx0aGlzLl9nbC5EUkFXX0ZSQU1FQlVGRkVSPXRoaXMuX2dsLkZSQU1FQlVGRkVSO2ZvcihsZXQgcz0wO3M8MTY7cysrKXRoaXMuX2dsWyJDT0xPUl9BVFRBQ0hNRU5UIitzKyJfV0VCR0wiXT1pWyJDT0xPUl9BVFRBQ0hNRU5UIitzKyJfV0VCR0wiXX19aWYodGhpcy5fd2ViR0xWZXJzaW9uPjEpdGhpcy5fY2Fwcy5kZXB0aFRleHR1cmVFeHRlbnNpb249ITA7ZWxzZXtjb25zdCBpPXRoaXMuX2dsLmdldEV4dGVuc2lvbigiV0VCR0xfZGVwdGhfdGV4dHVyZSIpO2khPW51bGwmJih0aGlzLl9jYXBzLmRlcHRoVGV4dHVyZUV4dGVuc2lvbj0hMCx0aGlzLl9nbC5VTlNJR05FRF9JTlRfMjRfOD1pLlVOU0lHTkVEX0lOVF8yNF84X1dFQkdMKX1pZih0aGlzLmRpc2FibGVWZXJ0ZXhBcnJheU9iamVjdHMpdGhpcy5fY2Fwcy52ZXJ0ZXhBcnJheU9iamVjdD0hMTtlbHNlIGlmKHRoaXMuX3dlYkdMVmVyc2lvbj4xKXRoaXMuX2NhcHMudmVydGV4QXJyYXlPYmplY3Q9ITA7ZWxzZXtjb25zdCBpPXRoaXMuX2dsLmdldEV4dGVuc2lvbigiT0VTX3ZlcnRleF9hcnJheV9vYmplY3QiKTtpIT1udWxsJiYodGhpcy5fY2Fwcy52ZXJ0ZXhBcnJheU9iamVjdD0hMCx0aGlzLl9nbC5jcmVhdGVWZXJ0ZXhBcnJheT1pLmNyZWF0ZVZlcnRleEFycmF5T0VTLmJpbmQoaSksdGhpcy5fZ2wuYmluZFZlcnRleEFycmF5PWkuYmluZFZlcnRleEFycmF5T0VTLmJpbmQoaSksdGhpcy5fZ2wuZGVsZXRlVmVydGV4QXJyYXk9aS5kZWxldGVWZXJ0ZXhBcnJheU9FUy5iaW5kKGkpKX1pZih0aGlzLl93ZWJHTFZlcnNpb24+MSl0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cz0hMDtlbHNle2NvbnN0IGk9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzIik7aSE9bnVsbD8odGhpcy5fY2Fwcy5pbnN0YW5jZWRBcnJheXM9ITAsdGhpcy5fZ2wuZHJhd0FycmF5c0luc3RhbmNlZD1pLmRyYXdBcnJheXNJbnN0YW5jZWRBTkdMRS5iaW5kKGkpLHRoaXMuX2dsLmRyYXdFbGVtZW50c0luc3RhbmNlZD1pLmRyYXdFbGVtZW50c0luc3RhbmNlZEFOR0xFLmJpbmQoaSksdGhpcy5fZ2wudmVydGV4QXR0cmliRGl2aXNvcj1pLnZlcnRleEF0dHJpYkRpdmlzb3JBTkdMRS5iaW5kKGkpKTp0aGlzLl9jYXBzLmluc3RhbmNlZEFycmF5cz0hMX1pZih0aGlzLl9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQpe2NvbnN0IGk9dGhpcy5fZ2wuZ2V0U2hhZGVyUHJlY2lzaW9uRm9ybWF0KHRoaXMuX2dsLlZFUlRFWF9TSEFERVIsdGhpcy5fZ2wuSElHSF9GTE9BVCkscz10aGlzLl9nbC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQodGhpcy5fZ2wuRlJBR01FTlRfU0hBREVSLHRoaXMuX2dsLkhJR0hfRkxPQVQpO2kmJnMmJih0aGlzLl9jYXBzLmhpZ2hQcmVjaXNpb25TaGFkZXJTdXBwb3J0ZWQ9aS5wcmVjaXNpb24hPT0wJiZzLnByZWNpc2lvbiE9PTApfWlmKHRoaXMuX3dlYkdMVmVyc2lvbj4xKXRoaXMuX2NhcHMuYmxlbmRNaW5NYXg9ITA7ZWxzZXtjb25zdCBpPXRoaXMuX2dsLmdldEV4dGVuc2lvbigiRVhUX2JsZW5kX21pbm1heCIpO2khPW51bGwmJih0aGlzLl9jYXBzLmJsZW5kTWluTWF4PSEwLHRoaXMuX2dsLk1BWD1pLk1BWF9FWFQsdGhpcy5fZ2wuTUlOPWkuTUlOX0VYVCl9aWYoIXRoaXMuX2NhcHMuc3VwcG9ydFNSR0JCdWZmZXJzKXtpZih0aGlzLl93ZWJHTFZlcnNpb24+MSl0aGlzLl9jYXBzLnN1cHBvcnRTUkdCQnVmZmVycz0hMDtlbHNle2NvbnN0IGk9dGhpcy5fZ2wuZ2V0RXh0ZW5zaW9uKCJFWFRfc1JHQiIpO2khPW51bGwmJih0aGlzLl9jYXBzLnN1cHBvcnRTUkdCQnVmZmVycz0hMCx0aGlzLl9nbC5TUkdCPWkuU1JHQl9FWFQsdGhpcy5fZ2wuU1JHQjg9aS5TUkdCX0FMUEhBX0VYVCx0aGlzLl9nbC5TUkdCOF9BTFBIQTg9aS5TUkdCX0FMUEhBX0VYVCl9dGhpcy5fY2Fwcy5zdXBwb3J0U1JHQkJ1ZmZlcnM9dGhpcy5fY2Fwcy5zdXBwb3J0U1JHQkJ1ZmZlcnMmJiEhKHRoaXMuX2NyZWF0aW9uT3B0aW9ucyYmdGhpcy5fY3JlYXRpb25PcHRpb25zLmZvcmNlU1JHQkJ1ZmZlclN1cHBvcnRTdGF0ZSl9dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0PSEwLHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz10aGlzLl9nbC5MRVFVQUwsdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhNYXNrPSEwLHRoaXMuX21heFNpbXVsdGFuZW91c1RleHR1cmVzPXRoaXMuX2NhcHMubWF4Q29tYmluZWRUZXh0dXJlc0ltYWdlVW5pdHM7Zm9yKGxldCBpPTA7aTx0aGlzLl9tYXhTaW11bHRhbmVvdXNUZXh0dXJlcztpKyspdGhpcy5fbmV4dEZyZWVUZXh0dXJlU2xvdHMucHVzaChpKX1faW5pdEZlYXR1cmVzKCl7dGhpcy5fZmVhdHVyZXM9e2ZvcmNlQml0bWFwT3ZlckhUTUxJbWFnZUVsZW1lbnQ6ITEsc3VwcG9ydFJlbmRlckFuZENvcHlUb0xvZEZvckZsb2F0VGV4dHVyZXM6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0RGVwdGhTdGVuY2lsVGV4dHVyZTp0aGlzLl93ZWJHTFZlcnNpb24hPT0xLHN1cHBvcnRTaGFkb3dTYW1wbGVyczp0aGlzLl93ZWJHTFZlcnNpb24hPT0xLHVuaWZvcm1CdWZmZXJIYXJkQ2hlY2tNYXRyaXg6ITEsYWxsb3dUZXh0dXJlUHJlZmlsdGVyaW5nOnRoaXMuX3dlYkdMVmVyc2lvbiE9PTEsdHJhY2tVYm9zSW5GcmFtZTohMSxjaGVja1Vib3NDb250ZW50QmVmb3JlVXBsb2FkOiExLHN1cHBvcnRDU006dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxiYXNpc05lZWRzUE9UOnRoaXMuX3dlYkdMVmVyc2lvbj09PTEsc3VwcG9ydDNEVGV4dHVyZXM6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxuZWVkVHlwZVN1ZmZpeEluU2hhZGVyQ29uc3RhbnRzOnRoaXMuX3dlYkdMVmVyc2lvbiE9PTEsc3VwcG9ydE1TQUE6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0U1NBTzI6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0RXh0ZW5kZWRUZXh0dXJlRm9ybWF0czp0aGlzLl93ZWJHTFZlcnNpb24hPT0xLHN1cHBvcnRTd2l0Y2hDYXNlSW5TaGFkZXI6dGhpcy5fd2ViR0xWZXJzaW9uIT09MSxzdXBwb3J0U3luY1RleHR1cmVSZWFkOiEwLG5lZWRzSW52ZXJ0aW5nQml0bWFwOiEwLHVzZVVCT0JpbmRpbmdDYWNoZTohMCxuZWVkU2hhZGVyQ29kZUlubGluaW5nOiExLG5lZWRUb0Fsd2F5c0JpbmRVbmlmb3JtQnVmZmVyczohMSxzdXBwb3J0UmVuZGVyUGFzc2VzOiExLHN1cHBvcnRTcHJpdGVJbnN0YW5jaW5nOiEwLF9jb2xsZWN0VWJvc1VwZGF0ZWRJbkZyYW1lOiExfX1nZXQgd2ViR0xWZXJzaW9uKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbn1nZXRDbGFzc05hbWUoKXtyZXR1cm4iVGhpbkVuZ2luZSJ9Z2V0IGlzU3RlbmNpbEVuYWJsZSgpe3JldHVybiB0aGlzLl9pc1N0ZW5jaWxFbmFibGV9X3ByZXBhcmVXb3JraW5nQ2FudmFzKCl7aWYodGhpcy5fd29ya2luZ0NhbnZhcylyZXR1cm47dGhpcy5fd29ya2luZ0NhbnZhcz10aGlzLmNyZWF0ZUNhbnZhcygxLDEpO2NvbnN0IGU9dGhpcy5fd29ya2luZ0NhbnZhcy5nZXRDb250ZXh0KCIyZCIpO2UmJih0aGlzLl93b3JraW5nQ29udGV4dD1lKX1yZXNldFRleHR1cmVDYWNoZSgpe2Zvcihjb25zdCBlIGluIHRoaXMuX2JvdW5kVGV4dHVyZXNDYWNoZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5fYm91bmRUZXh0dXJlc0NhY2hlLGUpJiYodGhpcy5fYm91bmRUZXh0dXJlc0NhY2hlW2VdPW51bGwpO3RoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbD0tMX1nZXRJbmZvKCl7cmV0dXJuIHRoaXMuZ2V0R2xJbmZvKCl9Z2V0R2xJbmZvKCl7cmV0dXJue3ZlbmRvcjp0aGlzLl9nbFZlbmRvcixyZW5kZXJlcjp0aGlzLl9nbFJlbmRlcmVyLHZlcnNpb246dGhpcy5fZ2xWZXJzaW9ufX1zZXRIYXJkd2FyZVNjYWxpbmdMZXZlbChlKXt0aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbD1lLHRoaXMucmVzaXplKCl9Z2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKXtyZXR1cm4gdGhpcy5faGFyZHdhcmVTY2FsaW5nTGV2ZWx9Z2V0TG9hZGVkVGV4dHVyZXNDYWNoZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGV9Z2V0Q2Fwcygpe3JldHVybiB0aGlzLl9jYXBzfXN0b3BSZW5kZXJMb29wKGUpe2lmKCFlKXt0aGlzLl9hY3RpdmVSZW5kZXJMb29wcz1bXTtyZXR1cm59Y29uc3QgdD10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5pbmRleE9mKGUpO3Q+PTAmJnRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLnNwbGljZSh0LDEpfV9yZW5kZXJMb29wKCl7aWYoIXRoaXMuX2NvbnRleHRXYXNMb3N0KXtsZXQgZT0hMDtpZighdGhpcy5yZW5kZXJFdmVuSW5CYWNrZ3JvdW5kJiZ0aGlzLl93aW5kb3dJc0JhY2tncm91bmQmJihlPSExKSxlKXt0aGlzLmJlZ2luRnJhbWUoKTtmb3IobGV0IHQ9MDt0PHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHNbdF07aSgpfXRoaXMuZW5kRnJhbWUoKX19dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHMubGVuZ3RoPjA/dGhpcy5fZnJhbWVIYW5kbGVyPXRoaXMuX3F1ZXVlTmV3RnJhbWUodGhpcy5fYm91bmRSZW5kZXJGdW5jdGlvbix0aGlzLmdldEhvc3RXaW5kb3coKSk6dGhpcy5fcmVuZGVyaW5nUXVldWVMYXVuY2hlZD0hMX1nZXRSZW5kZXJpbmdDYW52YXMoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzfWdldEF1ZGlvQ29udGV4dCgpe3JldHVybiB0aGlzLl9hdWRpb0NvbnRleHR9Z2V0QXVkaW9EZXN0aW5hdGlvbigpe3JldHVybiB0aGlzLl9hdWRpb0Rlc3RpbmF0aW9ufWdldEhvc3RXaW5kb3coKXtyZXR1cm4gamUoKT90aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5vd25lckRvY3VtZW50JiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldz90aGlzLl9yZW5kZXJpbmdDYW52YXMub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldzp3aW5kb3c6bnVsbH1nZXRSZW5kZXJXaWR0aChlPSExKXtyZXR1cm4hZSYmdGhpcy5fY3VycmVudFJlbmRlclRhcmdldD90aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0LndpZHRoOnRoaXMuX2ZyYW1lYnVmZmVyRGltZW5zaW9uc09iamVjdD90aGlzLl9mcmFtZWJ1ZmZlckRpbWVuc2lvbnNPYmplY3QuZnJhbWVidWZmZXJXaWR0aDp0aGlzLl9nbC5kcmF3aW5nQnVmZmVyV2lkdGh9Z2V0UmVuZGVySGVpZ2h0KGU9ITEpe3JldHVybiFlJiZ0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0P3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQuaGVpZ2h0OnRoaXMuX2ZyYW1lYnVmZmVyRGltZW5zaW9uc09iamVjdD90aGlzLl9mcmFtZWJ1ZmZlckRpbWVuc2lvbnNPYmplY3QuZnJhbWVidWZmZXJIZWlnaHQ6dGhpcy5fZ2wuZHJhd2luZ0J1ZmZlckhlaWdodH1fcXVldWVOZXdGcmFtZShlLHQpe3JldHVybiBvZS5RdWV1ZU5ld0ZyYW1lKGUsdCl9cnVuUmVuZGVyTG9vcChlKXt0aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5pbmRleE9mKGUpPT09LTEmJih0aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5wdXNoKGUpLHRoaXMuX3JlbmRlcmluZ1F1ZXVlTGF1bmNoZWR8fCh0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSEwLHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb249dGhpcy5fcmVuZGVyTG9vcC5iaW5kKHRoaXMpLHRoaXMuX2ZyYW1lSGFuZGxlcj10aGlzLl9xdWV1ZU5ld0ZyYW1lKHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb24sdGhpcy5nZXRIb3N0V2luZG93KCkpKSl9Y2xlYXIoZSx0LGkscz0hMSl7Y29uc3Qgcj10aGlzLnN0ZW5jaWxTdGF0ZUNvbXBvc2VyLnVzZVN0ZW5jaWxHbG9iYWxPbmx5O3RoaXMuc3RlbmNpbFN0YXRlQ29tcG9zZXIudXNlU3RlbmNpbEdsb2JhbE9ubHk9ITAsdGhpcy5hcHBseVN0YXRlcygpLHRoaXMuc3RlbmNpbFN0YXRlQ29tcG9zZXIudXNlU3RlbmNpbEdsb2JhbE9ubHk9cjtsZXQgbj0wO3QmJmUmJih0aGlzLl9nbC5jbGVhckNvbG9yKGUucixlLmcsZS5iLGUuYSE9PXZvaWQgMD9lLmE6MSksbnw9dGhpcy5fZ2wuQ09MT1JfQlVGRkVSX0JJVCksaSYmKHRoaXMudXNlUmV2ZXJzZURlcHRoQnVmZmVyPyh0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aEZ1bmM9dGhpcy5fZ2wuR0VRVUFMLHRoaXMuX2dsLmNsZWFyRGVwdGgoMCkpOnRoaXMuX2dsLmNsZWFyRGVwdGgoMSksbnw9dGhpcy5fZ2wuREVQVEhfQlVGRkVSX0JJVCkscyYmKHRoaXMuX2dsLmNsZWFyU3RlbmNpbCgwKSxufD10aGlzLl9nbC5TVEVOQ0lMX0JVRkZFUl9CSVQpLHRoaXMuX2dsLmNsZWFyKG4pfV92aWV3cG9ydChlLHQsaSxzKXsoZSE9PXRoaXMuX3ZpZXdwb3J0Q2FjaGVkLnh8fHQhPT10aGlzLl92aWV3cG9ydENhY2hlZC55fHxpIT09dGhpcy5fdmlld3BvcnRDYWNoZWQuenx8cyE9PXRoaXMuX3ZpZXdwb3J0Q2FjaGVkLncpJiYodGhpcy5fdmlld3BvcnRDYWNoZWQueD1lLHRoaXMuX3ZpZXdwb3J0Q2FjaGVkLnk9dCx0aGlzLl92aWV3cG9ydENhY2hlZC56PWksdGhpcy5fdmlld3BvcnRDYWNoZWQudz1zLHRoaXMuX2dsLnZpZXdwb3J0KGUsdCxpLHMpKX1zZXRWaWV3cG9ydChlLHQsaSl7Y29uc3Qgcz10fHx0aGlzLmdldFJlbmRlcldpZHRoKCkscj1pfHx0aGlzLmdldFJlbmRlckhlaWdodCgpLG49ZS54fHwwLGE9ZS55fHwwO3RoaXMuX2NhY2hlZFZpZXdwb3J0PWUsdGhpcy5fdmlld3BvcnQobipzLGEqcixzKmUud2lkdGgsciplLmhlaWdodCl9YmVnaW5GcmFtZSgpe31lbmRGcmFtZSgpe3RoaXMuX2JhZE9TJiZ0aGlzLmZsdXNoRnJhbWVidWZmZXIoKSx0aGlzLl9mcmFtZUlkKyt9cmVzaXplKGU9ITEpe2xldCB0LGk7aWYodGhpcy5hZGFwdFRvRGV2aWNlUmF0aW8pe2NvbnN0IHM9amUoKSYmd2luZG93LmRldmljZVBpeGVsUmF0aW98fDEscj10aGlzLl9sYXN0RGV2aWNlUGl4ZWxSYXRpby9zO3RoaXMuX2xhc3REZXZpY2VQaXhlbFJhdGlvPXMsdGhpcy5faGFyZHdhcmVTY2FsaW5nTGV2ZWwqPXJ9amUoKT8odD10aGlzLl9yZW5kZXJpbmdDYW52YXM/dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmNsaWVudFdpZHRofHx0aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGg6d2luZG93LmlubmVyV2lkdGgsaT10aGlzLl9yZW5kZXJpbmdDYW52YXM/dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmNsaWVudEhlaWdodHx8dGhpcy5fcmVuZGVyaW5nQ2FudmFzLmhlaWdodDp3aW5kb3cuaW5uZXJIZWlnaHQpOih0PXRoaXMuX3JlbmRlcmluZ0NhbnZhcz90aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGg6MTAwLGk9dGhpcy5fcmVuZGVyaW5nQ2FudmFzP3RoaXMuX3JlbmRlcmluZ0NhbnZhcy5oZWlnaHQ6MTAwKSx0aGlzLnNldFNpemUodC90aGlzLl9oYXJkd2FyZVNjYWxpbmdMZXZlbCxpL3RoaXMuX2hhcmR3YXJlU2NhbGluZ0xldmVsLGUpfXNldFNpemUoZSx0LGk9ITEpe3JldHVybiF0aGlzLl9yZW5kZXJpbmdDYW52YXN8fChlPWV8MCx0PXR8MCwhaSYmdGhpcy5fcmVuZGVyaW5nQ2FudmFzLndpZHRoPT09ZSYmdGhpcy5fcmVuZGVyaW5nQ2FudmFzLmhlaWdodD09PXQpPyExOih0aGlzLl9yZW5kZXJpbmdDYW52YXMud2lkdGg9ZSx0aGlzLl9yZW5kZXJpbmdDYW52YXMuaGVpZ2h0PXQsITApfWJpbmRGcmFtZWJ1ZmZlcihlLHQ9MCxpLHMscixuPTAsYT0wKXt2YXIgbyxoLGwsdSxkO2NvbnN0IGY9ZTt0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0JiZ0aGlzLnVuQmluZEZyYW1lYnVmZmVyKHRoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQpLHRoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ9ZSx0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGYuX01TQUFGcmFtZWJ1ZmZlcj9mLl9NU0FBRnJhbWVidWZmZXI6Zi5fZnJhbWVidWZmZXIpO2NvbnN0IF89dGhpcy5fZ2w7ZS5pczJEQXJyYXk/Xy5mcmFtZWJ1ZmZlclRleHR1cmVMYXllcihfLkZSQU1FQlVGRkVSLF8uQ09MT1JfQVRUQUNITUVOVDAsKG89ZS50ZXh0dXJlLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8bz09PXZvaWQgMD92b2lkIDA6by51bmRlcmx5aW5nUmVzb3VyY2UsbixhKTplLmlzQ3ViZSYmXy5mcmFtZWJ1ZmZlclRleHR1cmUyRChfLkZSQU1FQlVGRkVSLF8uQ09MT1JfQVRUQUNITUVOVDAsXy5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grdCwoaD1lLnRleHR1cmUuX2hhcmR3YXJlVGV4dHVyZSk9PT1udWxsfHxoPT09dm9pZCAwP3ZvaWQgMDpoLnVuZGVybHlpbmdSZXNvdXJjZSxuKTtjb25zdCBFPWUuX2RlcHRoU3RlbmNpbFRleHR1cmU7aWYoRSl7Y29uc3QgbT1lLl9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw/Xy5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQ6Xy5ERVBUSF9BVFRBQ0hNRU5UO2UuaXMyREFycmF5P18uZnJhbWVidWZmZXJUZXh0dXJlTGF5ZXIoXy5GUkFNRUJVRkZFUixtLChsPUUuX2hhcmR3YXJlVGV4dHVyZSk9PT1udWxsfHxsPT09dm9pZCAwP3ZvaWQgMDpsLnVuZGVybHlpbmdSZXNvdXJjZSxuLGEpOmUuaXNDdWJlP18uZnJhbWVidWZmZXJUZXh0dXJlMkQoXy5GUkFNRUJVRkZFUixtLF8uVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YK3QsKHU9RS5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fHU9PT12b2lkIDA/dm9pZCAwOnUudW5kZXJseWluZ1Jlc291cmNlLG4pOl8uZnJhbWVidWZmZXJUZXh0dXJlMkQoXy5GUkFNRUJVRkZFUixtLF8uVEVYVFVSRV8yRCwoZD1FLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8ZD09PXZvaWQgMD92b2lkIDA6ZC51bmRlcmx5aW5nUmVzb3VyY2Usbil9dGhpcy5fY2FjaGVkVmlld3BvcnQmJiFyP3RoaXMuc2V0Vmlld3BvcnQodGhpcy5fY2FjaGVkVmlld3BvcnQsaSxzKTooaXx8KGk9ZS53aWR0aCxuJiYoaT1pL01hdGgucG93KDIsbikpKSxzfHwocz1lLmhlaWdodCxuJiYocz1zL01hdGgucG93KDIsbikpKSx0aGlzLl92aWV3cG9ydCgwLDAsaSxzKSksdGhpcy53aXBlQ2FjaGVzKCl9c2V0U3RhdGUoZSx0PTAsaSxzPSExLHIsbixhPTApe3ZhciBvLGg7KHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmN1bGwhPT1lfHxpKSYmKHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmN1bGw9ZSk7Y29uc3QgbD0hKChoPShvPXRoaXMuY3VsbEJhY2tGYWNlcykhPT1udWxsJiZvIT09dm9pZCAwP286cikhPT1udWxsJiZoIT09dm9pZCAwKXx8aD90aGlzLl9nbC5CQUNLOnRoaXMuX2dsLkZST05UOyh0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5jdWxsRmFjZSE9PWx8fGkpJiYodGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuY3VsbEZhY2U9bCksdGhpcy5zZXRaT2Zmc2V0KHQpLHRoaXMuc2V0Wk9mZnNldFVuaXRzKGEpO2NvbnN0IHU9cz90aGlzLl9nbC5DVzp0aGlzLl9nbC5DQ1c7KHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmZyb250RmFjZSE9PXV8fGkpJiYodGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZnJvbnRGYWNlPXUpLHRoaXMuX3N0ZW5jaWxTdGF0ZUNvbXBvc2VyLnN0ZW5jaWxNYXRlcmlhbD1ufWdldERlcHRoQnVmZmVyKCl7cmV0dXJuIHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoVGVzdH1zZXREZXB0aEJ1ZmZlcihlKXt0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5kZXB0aFRlc3Q9ZX1zZXRaT2Zmc2V0KGUpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLnpPZmZzZXQ9dGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/LWU6ZX1nZXRaT2Zmc2V0KCl7Y29uc3QgZT10aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS56T2Zmc2V0O3JldHVybiB0aGlzLnVzZVJldmVyc2VEZXB0aEJ1ZmZlcj8tZTplfXNldFpPZmZzZXRVbml0cyhlKXt0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS56T2Zmc2V0VW5pdHM9dGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/LWU6ZX1nZXRaT2Zmc2V0VW5pdHMoKXtjb25zdCBlPXRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLnpPZmZzZXRVbml0cztyZXR1cm4gdGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/LWU6ZX1fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihlKXt0aGlzLl9jdXJyZW50RnJhbWVidWZmZXIhPT1lJiYodGhpcy5fZ2wuYmluZEZyYW1lYnVmZmVyKHRoaXMuX2dsLkZSQU1FQlVGRkVSLGUpLHRoaXMuX2N1cnJlbnRGcmFtZWJ1ZmZlcj1lKX1fY3VycmVudEZyYW1lQnVmZmVySXNEZWZhdWx0RnJhbWVCdWZmZXIoKXtyZXR1cm4gdGhpcy5fY3VycmVudEZyYW1lYnVmZmVyPT09bnVsbH1nZW5lcmF0ZU1pcG1hcHMoZSl7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseSh0aGlzLl9nbC5URVhUVVJFXzJELGUsITApLHRoaXMuX2dsLmdlbmVyYXRlTWlwbWFwKHRoaXMuX2dsLlRFWFRVUkVfMkQpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8yRCxudWxsKX11bkJpbmRGcmFtZWJ1ZmZlcihlLHQ9ITEsaSl7dmFyIHM7Y29uc3Qgcj1lO3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ9bnVsbDtjb25zdCBuPXRoaXMuX2dsO2lmKHIuX01TQUFGcmFtZWJ1ZmZlcil7aWYoZS5pc011bHRpKXt0aGlzLnVuQmluZE11bHRpQ29sb3JBdHRhY2htZW50RnJhbWVidWZmZXIoZSx0LGkpO3JldHVybn1uLmJpbmRGcmFtZWJ1ZmZlcihuLlJFQURfRlJBTUVCVUZGRVIsci5fTVNBQUZyYW1lYnVmZmVyKSxuLmJpbmRGcmFtZWJ1ZmZlcihuLkRSQVdfRlJBTUVCVUZGRVIsci5fZnJhbWVidWZmZXIpLG4uYmxpdEZyYW1lYnVmZmVyKDAsMCxlLndpZHRoLGUuaGVpZ2h0LDAsMCxlLndpZHRoLGUuaGVpZ2h0LG4uQ09MT1JfQlVGRkVSX0JJVCxuLk5FQVJFU1QpfSEoKHM9ZS50ZXh0dXJlKT09PW51bGx8fHM9PT12b2lkIDApJiZzLmdlbmVyYXRlTWlwTWFwcyYmIXQmJiFlLmlzQ3ViZSYmdGhpcy5nZW5lcmF0ZU1pcG1hcHMoZS50ZXh0dXJlKSxpJiYoci5fTVNBQUZyYW1lYnVmZmVyJiZ0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKHIuX2ZyYW1lYnVmZmVyKSxpKCkpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCl9Zmx1c2hGcmFtZWJ1ZmZlcigpe3RoaXMuX2dsLmZsdXNoKCl9cmVzdG9yZURlZmF1bHRGcmFtZWJ1ZmZlcigpe3RoaXMuX2N1cnJlbnRSZW5kZXJUYXJnZXQ/dGhpcy51bkJpbmRGcmFtZWJ1ZmZlcih0aGlzLl9jdXJyZW50UmVuZGVyVGFyZ2V0KTp0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKG51bGwpLHRoaXMuX2NhY2hlZFZpZXdwb3J0JiZ0aGlzLnNldFZpZXdwb3J0KHRoaXMuX2NhY2hlZFZpZXdwb3J0KSx0aGlzLndpcGVDYWNoZXMoKX1fcmVzZXRWZXJ0ZXhCdWZmZXJCaW5kaW5nKCl7dGhpcy5iaW5kQXJyYXlCdWZmZXIobnVsbCksdGhpcy5fY2FjaGVkVmVydGV4QnVmZmVycz1udWxsfWNyZWF0ZVZlcnRleEJ1ZmZlcihlKXtyZXR1cm4gdGhpcy5fY3JlYXRlVmVydGV4QnVmZmVyKGUsdGhpcy5fZ2wuU1RBVElDX0RSQVcpfV9jcmVhdGVWZXJ0ZXhCdWZmZXIoZSx0KXtjb25zdCBpPXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO2lmKCFpKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSB2ZXJ0ZXggYnVmZmVyIik7Y29uc3Qgcz1uZXcgRGkoaSk7cmV0dXJuIHRoaXMuYmluZEFycmF5QnVmZmVyKHMpLGUgaW5zdGFuY2VvZiBBcnJheT90aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUixuZXcgRmxvYXQzMkFycmF5KGUpLHQpOnRoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGUsdCksdGhpcy5fcmVzZXRWZXJ0ZXhCdWZmZXJCaW5kaW5nKCkscy5yZWZlcmVuY2VzPTEsc31jcmVhdGVEeW5hbWljVmVydGV4QnVmZmVyKGUpe3JldHVybiB0aGlzLl9jcmVhdGVWZXJ0ZXhCdWZmZXIoZSx0aGlzLl9nbC5EWU5BTUlDX0RSQVcpfV9yZXNldEluZGV4QnVmZmVyQmluZGluZygpe3RoaXMuYmluZEluZGV4QnVmZmVyKG51bGwpLHRoaXMuX2NhY2hlZEluZGV4QnVmZmVyPW51bGx9Y3JlYXRlSW5kZXhCdWZmZXIoZSx0KXtjb25zdCBpPXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpLHM9bmV3IERpKGkpO2lmKCFpKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBpbmRleCBidWZmZXIiKTt0aGlzLmJpbmRJbmRleEJ1ZmZlcihzKTtjb25zdCByPXRoaXMuX25vcm1hbGl6ZUluZGV4RGF0YShlKTtyZXR1cm4gdGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5FTEVNRU5UX0FSUkFZX0JVRkZFUixyLHQ/dGhpcy5fZ2wuRFlOQU1JQ19EUkFXOnRoaXMuX2dsLlNUQVRJQ19EUkFXKSx0aGlzLl9yZXNldEluZGV4QnVmZmVyQmluZGluZygpLHMucmVmZXJlbmNlcz0xLHMuaXMzMkJpdHM9ci5CWVRFU19QRVJfRUxFTUVOVD09PTQsc31fbm9ybWFsaXplSW5kZXhEYXRhKGUpe2lmKGUuQllURVNfUEVSX0VMRU1FTlQ9PT0yKXJldHVybiBlO2lmKHRoaXMuX2NhcHMudWludEluZGljZXMpe2lmKGUgaW5zdGFuY2VvZiBVaW50MzJBcnJheSlyZXR1cm4gZTtmb3IobGV0IGk9MDtpPGUubGVuZ3RoO2krKylpZihlW2ldPj02NTUzNSlyZXR1cm4gbmV3IFVpbnQzMkFycmF5KGUpO3JldHVybiBuZXcgVWludDE2QXJyYXkoZSl9cmV0dXJuIG5ldyBVaW50MTZBcnJheShlKX1iaW5kQXJyYXlCdWZmZXIoZSl7dGhpcy5fdmFvUmVjb3JkSW5Qcm9ncmVzc3x8dGhpcy5fdW5iaW5kVmVydGV4QXJyYXlPYmplY3QoKSx0aGlzLl9iaW5kQnVmZmVyKGUsdGhpcy5fZ2wuQVJSQVlfQlVGRkVSKX1iaW5kVW5pZm9ybUJsb2NrKGUsdCxpKXtjb25zdCBzPWUucHJvZ3JhbSxyPXRoaXMuX2dsLmdldFVuaWZvcm1CbG9ja0luZGV4KHMsdCk7dGhpcy5fZ2wudW5pZm9ybUJsb2NrQmluZGluZyhzLHIsaSl9YmluZEluZGV4QnVmZmVyKGUpe3RoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3N8fHRoaXMuX3VuYmluZFZlcnRleEFycmF5T2JqZWN0KCksdGhpcy5fYmluZEJ1ZmZlcihlLHRoaXMuX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSKX1fYmluZEJ1ZmZlcihlLHQpeyh0aGlzLl92YW9SZWNvcmRJblByb2dyZXNzfHx0aGlzLl9jdXJyZW50Qm91bmRCdWZmZXJbdF0hPT1lKSYmKHRoaXMuX2dsLmJpbmRCdWZmZXIodCxlP2UudW5kZXJseWluZ1Jlc291cmNlOm51bGwpLHRoaXMuX2N1cnJlbnRCb3VuZEJ1ZmZlclt0XT1lKX11cGRhdGVBcnJheUJ1ZmZlcihlKXt0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUiwwLGUpfV92ZXJ0ZXhBdHRyaWJQb2ludGVyKGUsdCxpLHMscixuLGEpe2NvbnN0IG89dGhpcy5fY3VycmVudEJ1ZmZlclBvaW50ZXJzW3RdO2lmKCFvKXJldHVybjtsZXQgaD0hMTtvLmFjdGl2ZT8oby5idWZmZXIhPT1lJiYoby5idWZmZXI9ZSxoPSEwKSxvLnNpemUhPT1pJiYoby5zaXplPWksaD0hMCksby50eXBlIT09cyYmKG8udHlwZT1zLGg9ITApLG8ubm9ybWFsaXplZCE9PXImJihvLm5vcm1hbGl6ZWQ9cixoPSEwKSxvLnN0cmlkZSE9PW4mJihvLnN0cmlkZT1uLGg9ITApLG8ub2Zmc2V0IT09YSYmKG8ub2Zmc2V0PWEsaD0hMCkpOihoPSEwLG8uYWN0aXZlPSEwLG8uaW5kZXg9dCxvLnNpemU9aSxvLnR5cGU9cyxvLm5vcm1hbGl6ZWQ9cixvLnN0cmlkZT1uLG8ub2Zmc2V0PWEsby5idWZmZXI9ZSksKGh8fHRoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3MpJiYodGhpcy5iaW5kQXJyYXlCdWZmZXIoZSkscz09PXRoaXMuX2dsLlVOU0lHTkVEX0lOVHx8cz09PXRoaXMuX2dsLklOVD90aGlzLl9nbC52ZXJ0ZXhBdHRyaWJJUG9pbnRlcih0LGkscyxuLGEpOnRoaXMuX2dsLnZlcnRleEF0dHJpYlBvaW50ZXIodCxpLHMscixuLGEpKX1fYmluZEluZGV4QnVmZmVyV2l0aENhY2hlKGUpe2UhPW51bGwmJnRoaXMuX2NhY2hlZEluZGV4QnVmZmVyIT09ZSYmKHRoaXMuX2NhY2hlZEluZGV4QnVmZmVyPWUsdGhpcy5iaW5kSW5kZXhCdWZmZXIoZSksdGhpcy5fdWludEluZGljZXNDdXJyZW50bHlTZXQ9ZS5pczMyQml0cyl9X2JpbmRWZXJ0ZXhCdWZmZXJzQXR0cmlidXRlcyhlLHQsaSl7Y29uc3Qgcz10LmdldEF0dHJpYnV0ZXNOYW1lcygpO3RoaXMuX3Zhb1JlY29yZEluUHJvZ3Jlc3N8fHRoaXMuX3VuYmluZFZlcnRleEFycmF5T2JqZWN0KCksdGhpcy51bmJpbmRBbGxBdHRyaWJ1dGVzKCk7Zm9yKGxldCByPTA7cjxzLmxlbmd0aDtyKyspe2NvbnN0IG49dC5nZXRBdHRyaWJ1dGVMb2NhdGlvbihyKTtpZihuPj0wKXtjb25zdCBhPXNbcl07bGV0IG89bnVsbDtpZihpJiYobz1pW2FdKSxvfHwobz1lW2FdKSwhbyljb250aW51ZTt0aGlzLl9nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShuKSx0aGlzLl92YW9SZWNvcmRJblByb2dyZXNzfHwodGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFtuXT0hMCk7Y29uc3QgaD1vLmdldEJ1ZmZlcigpO2gmJih0aGlzLl92ZXJ0ZXhBdHRyaWJQb2ludGVyKGgsbixvLmdldFNpemUoKSxvLnR5cGUsby5ub3JtYWxpemVkLG8uYnl0ZVN0cmlkZSxvLmJ5dGVPZmZzZXQpLG8uZ2V0SXNJbnN0YW5jZWQoKSYmKHRoaXMuX2dsLnZlcnRleEF0dHJpYkRpdmlzb3IobixvLmdldEluc3RhbmNlRGl2aXNvcigpKSx0aGlzLl92YW9SZWNvcmRJblByb2dyZXNzfHwodGhpcy5fY3VycmVudEluc3RhbmNlTG9jYXRpb25zLnB1c2gobiksdGhpcy5fY3VycmVudEluc3RhbmNlQnVmZmVycy5wdXNoKGgpKSkpfX19cmVjb3JkVmVydGV4QXJyYXlPYmplY3QoZSx0LGkscyl7Y29uc3Qgcj10aGlzLl9nbC5jcmVhdGVWZXJ0ZXhBcnJheSgpO2lmKCFyKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBWQU8iKTtyZXR1cm4gdGhpcy5fdmFvUmVjb3JkSW5Qcm9ncmVzcz0hMCx0aGlzLl9nbC5iaW5kVmVydGV4QXJyYXkociksdGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzPSEwLHRoaXMuX2JpbmRWZXJ0ZXhCdWZmZXJzQXR0cmlidXRlcyhlLGkscyksdGhpcy5iaW5kSW5kZXhCdWZmZXIodCksdGhpcy5fdmFvUmVjb3JkSW5Qcm9ncmVzcz0hMSx0aGlzLl9nbC5iaW5kVmVydGV4QXJyYXkobnVsbCkscn1iaW5kVmVydGV4QXJyYXlPYmplY3QoZSx0KXt0aGlzLl9jYWNoZWRWZXJ0ZXhBcnJheU9iamVjdCE9PWUmJih0aGlzLl9jYWNoZWRWZXJ0ZXhBcnJheU9iamVjdD1lLHRoaXMuX2dsLmJpbmRWZXJ0ZXhBcnJheShlKSx0aGlzLl9jYWNoZWRWZXJ0ZXhCdWZmZXJzPW51bGwsdGhpcy5fY2FjaGVkSW5kZXhCdWZmZXI9bnVsbCx0aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD10IT1udWxsJiZ0LmlzMzJCaXRzLHRoaXMuX211c3RXaXBlVmVydGV4QXR0cmlidXRlcz0hMCl9YmluZEJ1ZmZlcnNEaXJlY3RseShlLHQsaSxzLHIpe2lmKHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnMhPT1lfHx0aGlzLl9jYWNoZWRFZmZlY3RGb3JWZXJ0ZXhCdWZmZXJzIT09cil7dGhpcy5fY2FjaGVkVmVydGV4QnVmZmVycz1lLHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnM9cjtjb25zdCBuPXIuZ2V0QXR0cmlidXRlc0NvdW50KCk7dGhpcy5fdW5iaW5kVmVydGV4QXJyYXlPYmplY3QoKSx0aGlzLnVuYmluZEFsbEF0dHJpYnV0ZXMoKTtsZXQgYT0wO2ZvcihsZXQgbz0wO288bjtvKyspaWYobzxpLmxlbmd0aCl7Y29uc3QgaD1yLmdldEF0dHJpYnV0ZUxvY2F0aW9uKG8pO2g+PTAmJih0aGlzLl9nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShoKSx0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW2hdPSEwLHRoaXMuX3ZlcnRleEF0dHJpYlBvaW50ZXIoZSxoLGlbb10sdGhpcy5fZ2wuRkxPQVQsITEscyxhKSksYSs9aVtvXSo0fX10aGlzLl9iaW5kSW5kZXhCdWZmZXJXaXRoQ2FjaGUodCl9X3VuYmluZFZlcnRleEFycmF5T2JqZWN0KCl7dGhpcy5fY2FjaGVkVmVydGV4QXJyYXlPYmplY3QmJih0aGlzLl9jYWNoZWRWZXJ0ZXhBcnJheU9iamVjdD1udWxsLHRoaXMuX2dsLmJpbmRWZXJ0ZXhBcnJheShudWxsKSl9YmluZEJ1ZmZlcnMoZSx0LGkscyl7KHRoaXMuX2NhY2hlZFZlcnRleEJ1ZmZlcnMhPT1lfHx0aGlzLl9jYWNoZWRFZmZlY3RGb3JWZXJ0ZXhCdWZmZXJzIT09aSkmJih0aGlzLl9jYWNoZWRWZXJ0ZXhCdWZmZXJzPWUsdGhpcy5fY2FjaGVkRWZmZWN0Rm9yVmVydGV4QnVmZmVycz1pLHRoaXMuX2JpbmRWZXJ0ZXhCdWZmZXJzQXR0cmlidXRlcyhlLGkscykpLHRoaXMuX2JpbmRJbmRleEJ1ZmZlcldpdGhDYWNoZSh0KX11bmJpbmRJbnN0YW5jZUF0dHJpYnV0ZXMoKXtsZXQgZTtmb3IobGV0IHQ9MCxpPXRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucy5sZW5ndGg7dDxpO3QrKyl7Y29uc3Qgcz10aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzW3RdO2UhPXMmJnMucmVmZXJlbmNlcyYmKGU9cyx0aGlzLmJpbmRBcnJheUJ1ZmZlcihzKSk7Y29uc3Qgcj10aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnNbdF07dGhpcy5fZ2wudmVydGV4QXR0cmliRGl2aXNvcihyLDApfXRoaXMuX2N1cnJlbnRJbnN0YW5jZUJ1ZmZlcnMubGVuZ3RoPTAsdGhpcy5fY3VycmVudEluc3RhbmNlTG9jYXRpb25zLmxlbmd0aD0wfXJlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdChlKXt0aGlzLl9nbC5kZWxldGVWZXJ0ZXhBcnJheShlKX1fcmVsZWFzZUJ1ZmZlcihlKXtyZXR1cm4gZS5yZWZlcmVuY2VzLS0sZS5yZWZlcmVuY2VzPT09MD8odGhpcy5fZGVsZXRlQnVmZmVyKGUpLCEwKTohMX1fZGVsZXRlQnVmZmVyKGUpe3RoaXMuX2dsLmRlbGV0ZUJ1ZmZlcihlLnVuZGVybHlpbmdSZXNvdXJjZSl9dXBkYXRlQW5kQmluZEluc3RhbmNlc0J1ZmZlcihlLHQsaSl7aWYodGhpcy5iaW5kQXJyYXlCdWZmZXIoZSksdCYmdGhpcy5fZ2wuYnVmZmVyU3ViRGF0YSh0aGlzLl9nbC5BUlJBWV9CVUZGRVIsMCx0KSxpWzBdLmluZGV4IT09dm9pZCAwKXRoaXMuYmluZEluc3RhbmNlc0J1ZmZlcihlLGksITApO2Vsc2UgZm9yKGxldCBzPTA7czw0O3MrKyl7Y29uc3Qgcj1pW3NdO3RoaXMuX3ZlcnRleEF0dHJpYkFycmF5c0VuYWJsZWRbcl18fCh0aGlzLl9nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShyKSx0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW3JdPSEwKSx0aGlzLl92ZXJ0ZXhBdHRyaWJQb2ludGVyKGUsciw0LHRoaXMuX2dsLkZMT0FULCExLDY0LHMqMTYpLHRoaXMuX2dsLnZlcnRleEF0dHJpYkRpdmlzb3IociwxKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMucHVzaChyKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzLnB1c2goZSl9fWJpbmRJbnN0YW5jZXNCdWZmZXIoZSx0LGk9ITApe3RoaXMuYmluZEFycmF5QnVmZmVyKGUpO2xldCBzPTA7aWYoaSlmb3IobGV0IHI9MDtyPHQubGVuZ3RoO3IrKyl7Y29uc3Qgbj10W3JdO3MrPW4uYXR0cmlidXRlU2l6ZSo0fWZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXtjb25zdCBuPXRbcl07bi5pbmRleD09PXZvaWQgMCYmKG4uaW5kZXg9dGhpcy5fY3VycmVudEVmZmVjdC5nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShuLmF0dHJpYnV0ZU5hbWUpKSwhKG4uaW5kZXg8MCkmJih0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW24uaW5kZXhdfHwodGhpcy5fZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkobi5pbmRleCksdGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFtuLmluZGV4XT0hMCksdGhpcy5fdmVydGV4QXR0cmliUG9pbnRlcihlLG4uaW5kZXgsbi5hdHRyaWJ1dGVTaXplLG4uYXR0cmlidXRlVHlwZXx8dGhpcy5fZ2wuRkxPQVQsbi5ub3JtYWxpemVkfHwhMSxzLG4ub2Zmc2V0KSx0aGlzLl9nbC52ZXJ0ZXhBdHRyaWJEaXZpc29yKG4uaW5kZXgsbi5kaXZpc29yPT09dm9pZCAwPzE6bi5kaXZpc29yKSx0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMucHVzaChuLmluZGV4KSx0aGlzLl9jdXJyZW50SW5zdGFuY2VCdWZmZXJzLnB1c2goZSkpfX1kaXNhYmxlSW5zdGFuY2VBdHRyaWJ1dGVCeU5hbWUoZSl7aWYoIXRoaXMuX2N1cnJlbnRFZmZlY3QpcmV0dXJuO2NvbnN0IHQ9dGhpcy5fY3VycmVudEVmZmVjdC5nZXRBdHRyaWJ1dGVMb2NhdGlvbkJ5TmFtZShlKTt0aGlzLmRpc2FibGVJbnN0YW5jZUF0dHJpYnV0ZSh0KX1kaXNhYmxlSW5zdGFuY2VBdHRyaWJ1dGUoZSl7bGV0IHQ9ITEsaTtmb3IoOyhpPXRoaXMuX2N1cnJlbnRJbnN0YW5jZUxvY2F0aW9ucy5pbmRleE9mKGUpKSE9PS0xOyl0aGlzLl9jdXJyZW50SW5zdGFuY2VMb2NhdGlvbnMuc3BsaWNlKGksMSksdGhpcy5fY3VycmVudEluc3RhbmNlQnVmZmVycy5zcGxpY2UoaSwxKSx0PSEwLGk9dGhpcy5fY3VycmVudEluc3RhbmNlTG9jYXRpb25zLmluZGV4T2YoZSk7dCYmKHRoaXMuX2dsLnZlcnRleEF0dHJpYkRpdmlzb3IoZSwwKSx0aGlzLmRpc2FibGVBdHRyaWJ1dGVCeUluZGV4KGUpKX1kaXNhYmxlQXR0cmlidXRlQnlJbmRleChlKXt0aGlzLl9nbC5kaXNhYmxlVmVydGV4QXR0cmliQXJyYXkoZSksdGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZFtlXT0hMSx0aGlzLl9jdXJyZW50QnVmZmVyUG9pbnRlcnNbZV0uYWN0aXZlPSExfWRyYXcoZSx0LGkscyl7dGhpcy5kcmF3RWxlbWVudHNUeXBlKGU/MDoxLHQsaSxzKX1kcmF3UG9pbnRDbG91ZHMoZSx0LGkpe3RoaXMuZHJhd0FycmF5c1R5cGUoMixlLHQsaSl9ZHJhd1VuSW5kZXhlZChlLHQsaSxzKXt0aGlzLmRyYXdBcnJheXNUeXBlKGU/MDoxLHQsaSxzKX1kcmF3RWxlbWVudHNUeXBlKGUsdCxpLHMpe3RoaXMuYXBwbHlTdGF0ZXMoKSx0aGlzLl9yZXBvcnREcmF3Q2FsbCgpO2NvbnN0IHI9dGhpcy5fZHJhd01vZGUoZSksbj10aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD90aGlzLl9nbC5VTlNJR05FRF9JTlQ6dGhpcy5fZ2wuVU5TSUdORURfU0hPUlQsYT10aGlzLl91aW50SW5kaWNlc0N1cnJlbnRseVNldD80OjI7cz90aGlzLl9nbC5kcmF3RWxlbWVudHNJbnN0YW5jZWQocixpLG4sdCphLHMpOnRoaXMuX2dsLmRyYXdFbGVtZW50cyhyLGksbix0KmEpfWRyYXdBcnJheXNUeXBlKGUsdCxpLHMpe3RoaXMuYXBwbHlTdGF0ZXMoKSx0aGlzLl9yZXBvcnREcmF3Q2FsbCgpO2NvbnN0IHI9dGhpcy5fZHJhd01vZGUoZSk7cz90aGlzLl9nbC5kcmF3QXJyYXlzSW5zdGFuY2VkKHIsdCxpLHMpOnRoaXMuX2dsLmRyYXdBcnJheXMocix0LGkpfV9kcmF3TW9kZShlKXtzd2l0Y2goZSl7Y2FzZSAwOnJldHVybiB0aGlzLl9nbC5UUklBTkdMRVM7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5QT0lOVFM7Y2FzZSAxOnJldHVybiB0aGlzLl9nbC5MSU5FUztjYXNlIDM6cmV0dXJuIHRoaXMuX2dsLlBPSU5UUztjYXNlIDQ6cmV0dXJuIHRoaXMuX2dsLkxJTkVTO2Nhc2UgNTpyZXR1cm4gdGhpcy5fZ2wuTElORV9MT09QO2Nhc2UgNjpyZXR1cm4gdGhpcy5fZ2wuTElORV9TVFJJUDtjYXNlIDc6cmV0dXJuIHRoaXMuX2dsLlRSSUFOR0xFX1NUUklQO2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuVFJJQU5HTEVfRkFOO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlRSSUFOR0xFU319X3JlcG9ydERyYXdDYWxsKCl7fV9yZWxlYXNlRWZmZWN0KGUpe3RoaXMuX2NvbXBpbGVkRWZmZWN0c1tlLl9rZXldJiZkZWxldGUgdGhpcy5fY29tcGlsZWRFZmZlY3RzW2UuX2tleV07Y29uc3QgdD1lLmdldFBpcGVsaW5lQ29udGV4dCgpO3QmJnRoaXMuX2RlbGV0ZVBpcGVsaW5lQ29udGV4dCh0KX1fZGVsZXRlUGlwZWxpbmVDb250ZXh0KGUpe2NvbnN0IHQ9ZTt0JiZ0LnByb2dyYW0mJih0LnByb2dyYW0uX19TUEVDVE9SX3JlYnVpbGRQcm9ncmFtPW51bGwsdGhpcy5fZ2wuZGVsZXRlUHJvZ3JhbSh0LnByb2dyYW0pKX1fZ2V0R2xvYmFsRGVmaW5lcyhlKXtpZihlKXt0aGlzLmlzTkRDSGFsZlpSYW5nZT9lLklTX05EQ19IQUxGX1pSQU5HRT0iIjpkZWxldGUgZS5JU19ORENfSEFMRl9aUkFOR0UsdGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXI/ZS5VU0VfUkVWRVJTRV9ERVBUSEJVRkZFUj0iIjpkZWxldGUgZS5VU0VfUkVWRVJTRV9ERVBUSEJVRkZFUix0aGlzLnVzZUV4YWN0U3JnYkNvbnZlcnNpb25zP2UuVVNFX0VYQUNUX1NSR0JfQ09OVkVSU0lPTlM9IiI6ZGVsZXRlIGUuVVNFX0VYQUNUX1NSR0JfQ09OVkVSU0lPTlM7cmV0dXJufWVsc2V7bGV0IHQ9IiI7cmV0dXJuIHRoaXMuaXNORENIYWxmWlJhbmdlJiYodCs9IiNkZWZpbmUgSVNfTkRDX0hBTEZfWlJBTkdFIiksdGhpcy51c2VSZXZlcnNlRGVwdGhCdWZmZXImJih0JiYodCs9YApgKSx0Kz0iI2RlZmluZSBVU0VfUkVWRVJTRV9ERVBUSEJVRkZFUiIpLHRoaXMudXNlRXhhY3RTcmdiQ29udmVyc2lvbnMmJih0JiYodCs9YApgKSx0Kz0iI2RlZmluZSBVU0VfRVhBQ1RfU1JHQl9DT05WRVJTSU9OUyIpLHR9fWNyZWF0ZUVmZmVjdChlLHQsaSxzLHIsbixhLG8saCxsPVplLkdMU0wpe3ZhciB1O2NvbnN0IGQ9ZS52ZXJ0ZXhFbGVtZW50fHxlLnZlcnRleHx8ZS52ZXJ0ZXhUb2tlbnx8ZS52ZXJ0ZXhTb3VyY2V8fGUsZj1lLmZyYWdtZW50RWxlbWVudHx8ZS5mcmFnbWVudHx8ZS5mcmFnbWVudFRva2VufHxlLmZyYWdtZW50U291cmNlfHxlLF89dGhpcy5fZ2V0R2xvYmFsRGVmaW5lcygpO2xldCBFPSh1PXI/P3QuZGVmaW5lcykhPT1udWxsJiZ1IT09dm9pZCAwP3U6IiI7XyYmKEUrPV8pO2NvbnN0IG09ZCsiKyIrZisiQCIrRTtpZih0aGlzLl9jb21waWxlZEVmZmVjdHNbbV0pe2NvbnN0IFM9dGhpcy5fY29tcGlsZWRFZmZlY3RzW21dO3JldHVybiBhJiZTLmlzUmVhZHkoKSYmYShTKSxTfWNvbnN0IHY9bmV3IFBlKGUsdCxpLHMsdGhpcyxyLG4sYSxvLGgsbSxsKTtyZXR1cm4gdGhpcy5fY29tcGlsZWRFZmZlY3RzW21dPXYsdn1zdGF0aWMgX0NvbmNhdGVuYXRlU2hhZGVyKGUsdCxpPSIiKXtyZXR1cm4gaSsodD90K2AKYDoiIikrZX1fY29tcGlsZVNoYWRlcihlLHQsaSxzKXtyZXR1cm4gdGhpcy5fY29tcGlsZVJhd1NoYWRlcihvZS5fQ29uY2F0ZW5hdGVTaGFkZXIoZSxpLHMpLHQpfV9jb21waWxlUmF3U2hhZGVyKGUsdCl7Y29uc3QgaT10aGlzLl9nbCxzPWkuY3JlYXRlU2hhZGVyKHQ9PT0idmVydGV4Ij9pLlZFUlRFWF9TSEFERVI6aS5GUkFHTUVOVF9TSEFERVIpO2lmKCFzKXtsZXQgcj1pLk5PX0VSUk9SLG49aS5OT19FUlJPUjtmb3IoOyhuPWkuZ2V0RXJyb3IoKSkhPT1pLk5PX0VSUk9SOylyPW47dGhyb3cgbmV3IEVycm9yKGBTb21ldGhpbmcgd2VudCB3cm9uZyB3aGlsZSBjcmVhdGluZyBhIGdsICR7dH0gc2hhZGVyIG9iamVjdC4gZ2wgZXJyb3I9JHtyfSwgZ2wgaXNDb250ZXh0TG9zdD0ke2kuaXNDb250ZXh0TG9zdCgpfSwgX2NvbnRleHRXYXNMb3N0PSR7dGhpcy5fY29udGV4dFdhc0xvc3R9YCl9cmV0dXJuIGkuc2hhZGVyU291cmNlKHMsZSksaS5jb21waWxlU2hhZGVyKHMpLHN9X2dldFNoYWRlclNvdXJjZShlKXtyZXR1cm4gdGhpcy5fZ2wuZ2V0U2hhZGVyU291cmNlKGUpfWNyZWF0ZVJhd1NoYWRlclByb2dyYW0oZSx0LGkscyxyPW51bGwpe3M9c3x8dGhpcy5fZ2w7Y29uc3Qgbj10aGlzLl9jb21waWxlUmF3U2hhZGVyKHQsInZlcnRleCIpLGE9dGhpcy5fY29tcGlsZVJhd1NoYWRlcihpLCJmcmFnbWVudCIpO3JldHVybiB0aGlzLl9jcmVhdGVTaGFkZXJQcm9ncmFtKGUsbixhLHMscil9Y3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHIsbj1udWxsKXtyPXJ8fHRoaXMuX2dsO2NvbnN0IGE9dGhpcy5fd2ViR0xWZXJzaW9uPjE/YCN2ZXJzaW9uIDMwMCBlcwojZGVmaW5lIFdFQkdMMiAKYDoiIixvPXRoaXMuX2NvbXBpbGVTaGFkZXIodCwidmVydGV4IixzLGEpLGg9dGhpcy5fY29tcGlsZVNoYWRlcihpLCJmcmFnbWVudCIscyxhKTtyZXR1cm4gdGhpcy5fY3JlYXRlU2hhZGVyUHJvZ3JhbShlLG8saCxyLG4pfWlubGluZVNoYWRlckNvZGUoZSl7cmV0dXJuIGV9Y3JlYXRlUGlwZWxpbmVDb250ZXh0KGUpe2NvbnN0IHQ9bmV3IGxuO3JldHVybiB0LmVuZ2luZT10aGlzLHRoaXMuX2NhcHMucGFyYWxsZWxTaGFkZXJDb21waWxlJiYodC5pc1BhcmFsbGVsQ29tcGlsZWQ9ITApLHR9Y3JlYXRlTWF0ZXJpYWxDb250ZXh0KCl7fWNyZWF0ZURyYXdDb250ZXh0KCl7fV9jcmVhdGVTaGFkZXJQcm9ncmFtKGUsdCxpLHMscj1udWxsKXtjb25zdCBuPXMuY3JlYXRlUHJvZ3JhbSgpO2lmKGUucHJvZ3JhbT1uLCFuKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBwcm9ncmFtIik7cmV0dXJuIHMuYXR0YWNoU2hhZGVyKG4sdCkscy5hdHRhY2hTaGFkZXIobixpKSxzLmxpbmtQcm9ncmFtKG4pLGUuY29udGV4dD1zLGUudmVydGV4U2hhZGVyPXQsZS5mcmFnbWVudFNoYWRlcj1pLGUuaXNQYXJhbGxlbENvbXBpbGVkfHx0aGlzLl9maW5hbGl6ZVBpcGVsaW5lQ29udGV4dChlKSxufV9maW5hbGl6ZVBpcGVsaW5lQ29udGV4dChlKXtjb25zdCB0PWUuY29udGV4dCxpPWUudmVydGV4U2hhZGVyLHM9ZS5mcmFnbWVudFNoYWRlcixyPWUucHJvZ3JhbTtpZighdC5nZXRQcm9ncmFtUGFyYW1ldGVyKHIsdC5MSU5LX1NUQVRVUykpe2lmKCF0aGlzLl9nbC5nZXRTaGFkZXJQYXJhbWV0ZXIoaSx0aGlzLl9nbC5DT01QSUxFX1NUQVRVUykpe2NvbnN0IG89dGhpcy5fZ2wuZ2V0U2hhZGVySW5mb0xvZyhpKTtpZihvKXRocm93IGUudmVydGV4Q29tcGlsYXRpb25FcnJvcj1vLG5ldyBFcnJvcigiVkVSVEVYIFNIQURFUiAiK28pfWlmKCF0aGlzLl9nbC5nZXRTaGFkZXJQYXJhbWV0ZXIocyx0aGlzLl9nbC5DT01QSUxFX1NUQVRVUykpe2NvbnN0IG89dGhpcy5fZ2wuZ2V0U2hhZGVySW5mb0xvZyhzKTtpZihvKXRocm93IGUuZnJhZ21lbnRDb21waWxhdGlvbkVycm9yPW8sbmV3IEVycm9yKCJGUkFHTUVOVCBTSEFERVIgIitvKX1jb25zdCBhPXQuZ2V0UHJvZ3JhbUluZm9Mb2cocik7aWYoYSl0aHJvdyBlLnByb2dyYW1MaW5rRXJyb3I9YSxuZXcgRXJyb3IoYSl9aWYodGhpcy52YWxpZGF0ZVNoYWRlclByb2dyYW1zJiYodC52YWxpZGF0ZVByb2dyYW0ociksIXQuZ2V0UHJvZ3JhbVBhcmFtZXRlcihyLHQuVkFMSURBVEVfU1RBVFVTKSkpe2NvbnN0IG89dC5nZXRQcm9ncmFtSW5mb0xvZyhyKTtpZihvKXRocm93IGUucHJvZ3JhbVZhbGlkYXRpb25FcnJvcj1vLG5ldyBFcnJvcihvKX10LmRlbGV0ZVNoYWRlcihpKSx0LmRlbGV0ZVNoYWRlcihzKSxlLnZlcnRleFNoYWRlcj12b2lkIDAsZS5mcmFnbWVudFNoYWRlcj12b2lkIDAsZS5vbkNvbXBpbGVkJiYoZS5vbkNvbXBpbGVkKCksZS5vbkNvbXBpbGVkPXZvaWQgMCl9X3ByZXBhcmVQaXBlbGluZUNvbnRleHQoZSx0LGkscyxyLG4sYSxvLGgsbCl7Y29uc3QgdT1lO3M/dS5wcm9ncmFtPXRoaXMuY3JlYXRlUmF3U2hhZGVyUHJvZ3JhbSh1LHQsaSx2b2lkIDAsaCk6dS5wcm9ncmFtPXRoaXMuY3JlYXRlU2hhZGVyUHJvZ3JhbSh1LHQsaSxvLHZvaWQgMCxoKSx1LnByb2dyYW0uX19TUEVDVE9SX3JlYnVpbGRQcm9ncmFtPWF9X2lzUmVuZGVyaW5nU3RhdGVDb21waWxlZChlKXtjb25zdCB0PWU7cmV0dXJuIHRoaXMuX2dsLmdldFByb2dyYW1QYXJhbWV0ZXIodC5wcm9ncmFtLHRoaXMuX2NhcHMucGFyYWxsZWxTaGFkZXJDb21waWxlLkNPTVBMRVRJT05fU1RBVFVTX0tIUik/KHRoaXMuX2ZpbmFsaXplUGlwZWxpbmVDb250ZXh0KHQpLCEwKTohMX1fZXhlY3V0ZVdoZW5SZW5kZXJpbmdTdGF0ZUlzQ29tcGlsZWQoZSx0KXtjb25zdCBpPWU7aWYoIWkuaXNQYXJhbGxlbENvbXBpbGVkKXt0KCk7cmV0dXJufWNvbnN0IHM9aS5vbkNvbXBpbGVkO3M/aS5vbkNvbXBpbGVkPSgpPT57cygpLHQoKX06aS5vbkNvbXBpbGVkPXR9Z2V0VW5pZm9ybXMoZSx0KXtjb25zdCBpPW5ldyBBcnJheSxzPWU7Zm9yKGxldCByPTA7cjx0Lmxlbmd0aDtyKyspaS5wdXNoKHRoaXMuX2dsLmdldFVuaWZvcm1Mb2NhdGlvbihzLnByb2dyYW0sdFtyXSkpO3JldHVybiBpfWdldEF0dHJpYnV0ZXMoZSx0KXtjb25zdCBpPVtdLHM9ZTtmb3IobGV0IHI9MDtyPHQubGVuZ3RoO3IrKyl0cnl7aS5wdXNoKHRoaXMuX2dsLmdldEF0dHJpYkxvY2F0aW9uKHMucHJvZ3JhbSx0W3JdKSl9Y2F0Y2h7aS5wdXNoKC0xKX1yZXR1cm4gaX1lbmFibGVFZmZlY3QoZSl7ZT1lIT09bnVsbCYmbWkuSXNXcmFwcGVyKGUpP2UuZWZmZWN0OmUsISghZXx8ZT09PXRoaXMuX2N1cnJlbnRFZmZlY3QpJiYodGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXIuc3RlbmNpbE1hdGVyaWFsPXZvaWQgMCxlPWUsdGhpcy5iaW5kU2FtcGxlcnMoZSksdGhpcy5fY3VycmVudEVmZmVjdD1lLGUub25CaW5kJiZlLm9uQmluZChlKSxlLl9vbkJpbmRPYnNlcnZhYmxlJiZlLl9vbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSl9c2V0SW50KGUsdCl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0xaShlLHQpLCEwKTohMX1zZXRJbnQyKGUsdCxpKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTJpKGUsdCxpKSwhMCk6ITF9c2V0SW50MyhlLHQsaSxzKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTNpKGUsdCxpLHMpLCEwKTohMX1zZXRJbnQ0KGUsdCxpLHMscil7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm00aShlLHQsaSxzLHIpLCEwKTohMX1zZXRJbnRBcnJheShlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtMWl2KGUsdCksITApOiExfXNldEludEFycmF5MihlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCUyIT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTJpdihlLHQpLCEwKX1zZXRJbnRBcnJheTMoZSx0KXtyZXR1cm4hZXx8dC5sZW5ndGglMyE9PTA/ITE6KHRoaXMuX2dsLnVuaWZvcm0zaXYoZSx0KSwhMCl9c2V0SW50QXJyYXk0KGUsdCl7cmV0dXJuIWV8fHQubGVuZ3RoJTQhPT0wPyExOih0aGlzLl9nbC51bmlmb3JtNGl2KGUsdCksITApfXNldFVJbnQoZSx0KXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTF1aShlLHQpLCEwKTohMX1zZXRVSW50MihlLHQsaSl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0ydWkoZSx0LGkpLCEwKTohMX1zZXRVSW50MyhlLHQsaSxzKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTN1aShlLHQsaSxzKSwhMCk6ITF9c2V0VUludDQoZSx0LGkscyxyKXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTR1aShlLHQsaSxzLHIpLCEwKTohMX1zZXRVSW50QXJyYXkoZSx0KXtyZXR1cm4gZT8odGhpcy5fZ2wudW5pZm9ybTF1aXYoZSx0KSwhMCk6ITF9c2V0VUludEFycmF5MihlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCUyIT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTJ1aXYoZSx0KSwhMCl9c2V0VUludEFycmF5MyhlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCUzIT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTN1aXYoZSx0KSwhMCl9c2V0VUludEFycmF5NChlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCU0IT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTR1aXYoZSx0KSwhMCl9c2V0QXJyYXkoZSx0KXtyZXR1cm4hZXx8dC5sZW5ndGg8MT8hMToodGhpcy5fZ2wudW5pZm9ybTFmdihlLHQpLCEwKX1zZXRBcnJheTIoZSx0KXtyZXR1cm4hZXx8dC5sZW5ndGglMiE9PTA/ITE6KHRoaXMuX2dsLnVuaWZvcm0yZnYoZSx0KSwhMCl9c2V0QXJyYXkzKGUsdCl7cmV0dXJuIWV8fHQubGVuZ3RoJTMhPT0wPyExOih0aGlzLl9nbC51bmlmb3JtM2Z2KGUsdCksITApfXNldEFycmF5NChlLHQpe3JldHVybiFlfHx0Lmxlbmd0aCU0IT09MD8hMToodGhpcy5fZ2wudW5pZm9ybTRmdihlLHQpLCEwKX1zZXRNYXRyaWNlcyhlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtTWF0cml4NGZ2KGUsITEsdCksITApOiExfXNldE1hdHJpeDN4MyhlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtTWF0cml4M2Z2KGUsITEsdCksITApOiExfXNldE1hdHJpeDJ4MihlLHQpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtTWF0cml4MmZ2KGUsITEsdCksITApOiExfXNldEZsb2F0KGUsdCl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0xZihlLHQpLCEwKTohMX1zZXRGbG9hdDIoZSx0LGkpe3JldHVybiBlPyh0aGlzLl9nbC51bmlmb3JtMmYoZSx0LGkpLCEwKTohMX1zZXRGbG9hdDMoZSx0LGkscyl7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm0zZihlLHQsaSxzKSwhMCk6ITF9c2V0RmxvYXQ0KGUsdCxpLHMscil7cmV0dXJuIGU/KHRoaXMuX2dsLnVuaWZvcm00ZihlLHQsaSxzLHIpLCEwKTohMX1hcHBseVN0YXRlcygpe2lmKHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmFwcGx5KHRoaXMuX2dsKSx0aGlzLl9zdGVuY2lsU3RhdGVDb21wb3Nlci5hcHBseSh0aGlzLl9nbCksdGhpcy5fYWxwaGFTdGF0ZS5hcHBseSh0aGlzLl9nbCksdGhpcy5fY29sb3JXcml0ZUNoYW5nZWQpe3RoaXMuX2NvbG9yV3JpdGVDaGFuZ2VkPSExO2NvbnN0IGU9dGhpcy5fY29sb3JXcml0ZTt0aGlzLl9nbC5jb2xvck1hc2soZSxlLGUsZSl9fXNldENvbG9yV3JpdGUoZSl7ZSE9PXRoaXMuX2NvbG9yV3JpdGUmJih0aGlzLl9jb2xvcldyaXRlQ2hhbmdlZD0hMCx0aGlzLl9jb2xvcldyaXRlPWUpfWdldENvbG9yV3JpdGUoKXtyZXR1cm4gdGhpcy5fY29sb3JXcml0ZX1nZXQgZGVwdGhDdWxsaW5nU3RhdGUoKXtyZXR1cm4gdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGV9Z2V0IGFscGhhU3RhdGUoKXtyZXR1cm4gdGhpcy5fYWxwaGFTdGF0ZX1nZXQgc3RlbmNpbFN0YXRlKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZX1nZXQgc3RlbmNpbFN0YXRlQ29tcG9zZXIoKXtyZXR1cm4gdGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXJ9Y2xlYXJJbnRlcm5hbFRleHR1cmVzQ2FjaGUoKXt0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGUubGVuZ3RoPTB9d2lwZUNhY2hlcyhlKXt0aGlzLnByZXZlbnRDYWNoZVdpcGVCZXR3ZWVuRnJhbWVzJiYhZXx8KHRoaXMuX2N1cnJlbnRFZmZlY3Q9bnVsbCx0aGlzLl92aWV3cG9ydENhY2hlZC54PTAsdGhpcy5fdmlld3BvcnRDYWNoZWQueT0wLHRoaXMuX3ZpZXdwb3J0Q2FjaGVkLno9MCx0aGlzLl92aWV3cG9ydENhY2hlZC53PTAsdGhpcy5fdW5iaW5kVmVydGV4QXJyYXlPYmplY3QoKSxlJiYodGhpcy5fY3VycmVudFByb2dyYW09bnVsbCx0aGlzLnJlc2V0VGV4dHVyZUNhY2hlKCksdGhpcy5fc3RlbmNpbFN0YXRlQ29tcG9zZXIucmVzZXQoKSx0aGlzLl9kZXB0aEN1bGxpbmdTdGF0ZS5yZXNldCgpLHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoRnVuYz10aGlzLl9nbC5MRVFVQUwsdGhpcy5fYWxwaGFTdGF0ZS5yZXNldCgpLHRoaXMuX2FscGhhTW9kZT0xLHRoaXMuX2FscGhhRXF1YXRpb249MCx0aGlzLl9jb2xvcldyaXRlPSEwLHRoaXMuX2NvbG9yV3JpdGVDaGFuZ2VkPSEwLHRoaXMuX3VucGFja0ZsaXBZQ2FjaGVkPW51bGwsdGhpcy5fZ2wucGl4ZWxTdG9yZWkodGhpcy5fZ2wuVU5QQUNLX0NPTE9SU1BBQ0VfQ09OVkVSU0lPTl9XRUJHTCx0aGlzLl9nbC5OT05FKSx0aGlzLl9nbC5waXhlbFN0b3JlaSh0aGlzLl9nbC5VTlBBQ0tfUFJFTVVMVElQTFlfQUxQSEFfV0VCR0wsMCksdGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzPSEwLHRoaXMudW5iaW5kQWxsQXR0cmlidXRlcygpKSx0aGlzLl9yZXNldFZlcnRleEJ1ZmZlckJpbmRpbmcoKSx0aGlzLl9jYWNoZWRJbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2NhY2hlZEVmZmVjdEZvclZlcnRleEJ1ZmZlcnM9bnVsbCx0aGlzLmJpbmRJbmRleEJ1ZmZlcihudWxsKSl9X2dldFNhbXBsaW5nUGFyYW1ldGVycyhlLHQpe2NvbnN0IGk9dGhpcy5fZ2w7bGV0IHM9aS5ORUFSRVNULHI9aS5ORUFSRVNUO3N3aXRjaChlKXtjYXNlIDExOnM9aS5MSU5FQVIsdD9yPWkuTElORUFSX01JUE1BUF9ORUFSRVNUOnI9aS5MSU5FQVI7YnJlYWs7Y2FzZSAzOnM9aS5MSU5FQVIsdD9yPWkuTElORUFSX01JUE1BUF9MSU5FQVI6cj1pLkxJTkVBUjticmVhaztjYXNlIDg6cz1pLk5FQVJFU1QsdD9yPWkuTkVBUkVTVF9NSVBNQVBfTElORUFSOnI9aS5ORUFSRVNUO2JyZWFrO2Nhc2UgNDpzPWkuTkVBUkVTVCx0P3I9aS5ORUFSRVNUX01JUE1BUF9ORUFSRVNUOnI9aS5ORUFSRVNUO2JyZWFrO2Nhc2UgNTpzPWkuTkVBUkVTVCx0P3I9aS5MSU5FQVJfTUlQTUFQX05FQVJFU1Q6cj1pLkxJTkVBUjticmVhaztjYXNlIDY6cz1pLk5FQVJFU1QsdD9yPWkuTElORUFSX01JUE1BUF9MSU5FQVI6cj1pLkxJTkVBUjticmVhaztjYXNlIDc6cz1pLk5FQVJFU1Qscj1pLkxJTkVBUjticmVhaztjYXNlIDE6cz1pLk5FQVJFU1Qscj1pLk5FQVJFU1Q7YnJlYWs7Y2FzZSA5OnM9aS5MSU5FQVIsdD9yPWkuTkVBUkVTVF9NSVBNQVBfTkVBUkVTVDpyPWkuTkVBUkVTVDticmVhaztjYXNlIDEwOnM9aS5MSU5FQVIsdD9yPWkuTkVBUkVTVF9NSVBNQVBfTElORUFSOnI9aS5ORUFSRVNUO2JyZWFrO2Nhc2UgMjpzPWkuTElORUFSLHI9aS5MSU5FQVI7YnJlYWs7Y2FzZSAxMjpzPWkuTElORUFSLHI9aS5ORUFSRVNUO2JyZWFrfXJldHVybnttaW46cixtYWc6c319X2NyZWF0ZVRleHR1cmUoKXtjb25zdCBlPXRoaXMuX2dsLmNyZWF0ZVRleHR1cmUoKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgdGV4dHVyZSIpO3JldHVybiBlfV9jcmVhdGVIYXJkd2FyZVRleHR1cmUoKXtyZXR1cm4gbmV3IHRyKHRoaXMuX2NyZWF0ZVRleHR1cmUoKSx0aGlzLl9nbCl9X2NyZWF0ZUludGVybmFsVGV4dHVyZShlLHQsaT0hMCxzPU5lLlVua25vd24pe3ZhciByO2xldCBuPSExLGE9MCxvPTMsaD01LGw9ITEsdT0xO3QhPT12b2lkIDAmJnR5cGVvZiB0PT0ib2JqZWN0Ij8obj0hIXQuZ2VuZXJhdGVNaXBNYXBzLGE9dC50eXBlPT09dm9pZCAwPzA6dC50eXBlLG89dC5zYW1wbGluZ01vZGU9PT12b2lkIDA/Mzp0LnNhbXBsaW5nTW9kZSxoPXQuZm9ybWF0PT09dm9pZCAwPzU6dC5mb3JtYXQsbD10LnVzZVNSR0JCdWZmZXI9PT12b2lkIDA/ITE6dC51c2VTUkdCQnVmZmVyLHU9KHI9dC5zYW1wbGVzKSE9PW51bGwmJnIhPT12b2lkIDA/cjoxKTpuPSEhdCxsJiYobD10aGlzLl9jYXBzLnN1cHBvcnRTUkdCQnVmZmVycyYmKHRoaXMud2ViR0xWZXJzaW9uPjF8fHRoaXMuaXNXZWJHUFUpKSwoYT09PTEmJiF0aGlzLl9jYXBzLnRleHR1cmVGbG9hdExpbmVhckZpbHRlcmluZ3x8YT09PTImJiF0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmcpJiYobz0xKSxhPT09MSYmIXRoaXMuX2NhcHMudGV4dHVyZUZsb2F0JiYoYT0wLE8uV2FybigiRmxvYXQgdGV4dHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIFR5cGUgZm9yY2VkIHRvIFRFWFRVUkVUWVBFX1VOU0lHTkVEX0JZVEUiKSk7Y29uc3QgZD10aGlzLl9nbCxmPW5ldyBPdCh0aGlzLHMpLF89ZS53aWR0aHx8ZSxFPWUuaGVpZ2h0fHxlLG09ZS5sYXllcnN8fDAsdj10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMobyxuKSxTPW0hPT0wP2QuVEVYVFVSRV8yRF9BUlJBWTpkLlRFWFRVUkVfMkQseT10aGlzLl9nZXRSR0JBQnVmZmVySW50ZXJuYWxTaXplZEZvcm1hdChhLGgsbCksQT10aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChoKSxDPXRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoYSk7cmV0dXJuIHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoUyxmKSxtIT09MD8oZi5pczJEQXJyYXk9ITAsZC50ZXhJbWFnZTNEKFMsMCx5LF8sRSxtLDAsQSxDLG51bGwpKTpkLnRleEltYWdlMkQoUywwLHksXyxFLDAsQSxDLG51bGwpLGQudGV4UGFyYW1ldGVyaShTLGQuVEVYVFVSRV9NQUdfRklMVEVSLHYubWFnKSxkLnRleFBhcmFtZXRlcmkoUyxkLlRFWFRVUkVfTUlOX0ZJTFRFUix2Lm1pbiksZC50ZXhQYXJhbWV0ZXJpKFMsZC5URVhUVVJFX1dSQVBfUyxkLkNMQU1QX1RPX0VER0UpLGQudGV4UGFyYW1ldGVyaShTLGQuVEVYVFVSRV9XUkFQX1QsZC5DTEFNUF9UT19FREdFKSxuJiZ0aGlzLl9nbC5nZW5lcmF0ZU1pcG1hcChTKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KFMsbnVsbCksZi5fdXNlU1JHQkJ1ZmZlcj1sLGYuYmFzZVdpZHRoPV8sZi5iYXNlSGVpZ2h0PUUsZi53aWR0aD1fLGYuaGVpZ2h0PUUsZi5kZXB0aD1tLGYuaXNSZWFkeT0hMCxmLnNhbXBsZXM9dSxmLmdlbmVyYXRlTWlwTWFwcz1uLGYuc2FtcGxpbmdNb2RlPW8sZi50eXBlPWEsZi5mb3JtYXQ9aCx0aGlzLl9pbnRlcm5hbFRleHR1cmVzQ2FjaGUucHVzaChmKSxmfV9nZXRVc2VTUkdCQnVmZmVyKGUsdCl7cmV0dXJuIGUmJnRoaXMuX2NhcHMuc3VwcG9ydFNSR0JCdWZmZXJzJiYodGhpcy53ZWJHTFZlcnNpb24+MXx8dGhpcy5pc1dlYkdQVXx8dCl9X2NyZWF0ZVRleHR1cmVCYXNlKGUsdCxpLHMscj0zLG49bnVsbCxhPW51bGwsbyxoLGw9bnVsbCx1PW51bGwsZD1udWxsLGY9bnVsbCxfLEUsbSl7ZT1lfHwiIjtjb25zdCB2PWUuc3Vic3RyKDAsNSk9PT0iZGF0YToiLFM9ZS5zdWJzdHIoMCw1KT09PSJibG9iOiIseT12JiZlLmluZGV4T2YoIjtiYXNlNjQsIikhPT0tMSxBPXV8fG5ldyBPdCh0aGlzLE5lLlVybCksQz1lO3RoaXMuX3RyYW5zZm9ybVRleHR1cmVVcmwmJiF5JiYhdSYmIWwmJihlPXRoaXMuX3RyYW5zZm9ybVRleHR1cmVVcmwoZSkpLEMhPT1lJiYoQS5fb3JpZ2luYWxVcmw9Qyk7Y29uc3QgYj1lLmxhc3RJbmRleE9mKCIuIik7bGV0IE09Znx8KGI+LTE/ZS5zdWJzdHJpbmcoYikudG9Mb3dlckNhc2UoKToiIiksTD1udWxsO00uaW5kZXhPZigiPyIpPi0xJiYoTT1NLnNwbGl0KCI/IilbMF0pO2Zvcihjb25zdCBjZSBvZiBvZS5fVGV4dHVyZUxvYWRlcnMpaWYoY2UuY2FuTG9hZChNLF8pKXtMPWNlO2JyZWFrfXMmJnMuYWRkUGVuZGluZ0RhdGEoQSksQS51cmw9ZSxBLmdlbmVyYXRlTWlwTWFwcz0hdCxBLnNhbXBsaW5nTW9kZT1yLEEuaW52ZXJ0WT1pLEEuX3VzZVNSR0JCdWZmZXI9dGhpcy5fZ2V0VXNlU1JHQkJ1ZmZlcighIW0sdCksdGhpcy5fZG9Ob3RIYW5kbGVDb250ZXh0TG9zdHx8KEEuX2J1ZmZlcj1sKTtsZXQgdz1udWxsO24mJiF1JiYodz1BLm9uTG9hZGVkT2JzZXJ2YWJsZS5hZGQobikpLHV8fHRoaXMuX2ludGVybmFsVGV4dHVyZXNDYWNoZS5wdXNoKEEpO2NvbnN0IGRlPShjZSxzZSk9PntzJiZzLnJlbW92ZVBlbmRpbmdEYXRhKEEpLGU9PT1DPyh3JiZBLm9uTG9hZGVkT2JzZXJ2YWJsZS5yZW1vdmUodyksZmUuVXNlRmFsbGJhY2tUZXh0dXJlJiZ0aGlzLl9jcmVhdGVUZXh0dXJlQmFzZShmZS5GYWxsYmFja1RleHR1cmUsdCxBLmludmVydFkscyxyLG51bGwsYSxvLGgsbCxBKSxjZT0oY2V8fCJVbmtub3duIGVycm9yIikrKGZlLlVzZUZhbGxiYWNrVGV4dHVyZT8iIC0gRmFsbGJhY2sgdGV4dHVyZSB3YXMgdXNlZCI6IiIpLEEub25FcnJvck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHttZXNzYWdlOmNlLGV4Y2VwdGlvbjpzZX0pLGEmJmEoY2Usc2UpKTooTy5XYXJuKGBGYWlsZWQgdG8gbG9hZCAke2V9LCBmYWxsaW5nIGJhY2sgdG8gJHtDfWApLHRoaXMuX2NyZWF0ZVRleHR1cmVCYXNlKEMsdCxBLmludmVydFkscyxyLG4sYSxvLGgsbCxBLGQsZixfLEUsbSkpfTtpZihMKXtjb25zdCBjZT1zZT0+e0wubG9hZERhdGEoc2UsQSwodGUsRmUsd2UsSGUsS2UsWWUpPT57WWU/ZGUoIlRleHR1cmVMb2FkZXIgZmFpbGVkIHRvIGxvYWQgZGF0YSIpOm8oQSxNLHMse3dpZHRoOnRlLGhlaWdodDpGZX0sQS5pbnZlcnRZLCF3ZSxIZSwoKT0+KEtlKCksITEpLHIpfSxFKX07bD9sIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/Y2UobmV3IFVpbnQ4QXJyYXkobCkpOkFycmF5QnVmZmVyLmlzVmlldyhsKT9jZShsKTphJiZhKCJVbmFibGUgdG8gbG9hZDogb25seSBBcnJheUJ1ZmZlciBvciBBcnJheUJ1ZmZlclZpZXcgaXMgc3VwcG9ydGVkIixudWxsKTp0aGlzLl9sb2FkRmlsZShlLHNlPT5jZShuZXcgVWludDhBcnJheShzZSkpLHZvaWQgMCxzP3Mub2ZmbGluZVByb3ZpZGVyOnZvaWQgMCwhMCwoc2UsdGUpPT57ZGUoIlVuYWJsZSB0byBsb2FkICIrKHNlJiZzZS5yZXNwb25zZVVSTCx0ZSkpfSl9ZWxzZXtjb25zdCBjZT1zZT0+e1MmJiF0aGlzLl9kb05vdEhhbmRsZUNvbnRleHRMb3N0JiYoQS5fYnVmZmVyPXNlKSxvKEEsTSxzLHNlLEEuaW52ZXJ0WSx0LCExLGgscil9OyF2fHx5P2wmJih0eXBlb2YgbC5kZWNvZGluZz09InN0cmluZyJ8fGwuY2xvc2UpP2NlKGwpOm9lLl9GaWxlVG9vbHNMb2FkSW1hZ2UoZSxjZSxkZSxzP3Mub2ZmbGluZVByb3ZpZGVyOm51bGwsXyxBLmludmVydFkmJnRoaXMuX2ZlYXR1cmVzLm5lZWRzSW52ZXJ0aW5nQml0bWFwP3tpbWFnZU9yaWVudGF0aW9uOiJmbGlwWSJ9OnZvaWQgMCk6dHlwZW9mIGw9PSJzdHJpbmcifHxsIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fEFycmF5QnVmZmVyLmlzVmlldyhsKXx8bCBpbnN0YW5jZW9mIEJsb2I/b2UuX0ZpbGVUb29sc0xvYWRJbWFnZShsLGNlLGRlLHM/cy5vZmZsaW5lUHJvdmlkZXI6bnVsbCxfLEEuaW52ZXJ0WSYmdGhpcy5fZmVhdHVyZXMubmVlZHNJbnZlcnRpbmdCaXRtYXA/e2ltYWdlT3JpZW50YXRpb246ImZsaXBZIn06dm9pZCAwKTpsJiZjZShsKX1yZXR1cm4gQX1jcmVhdGVUZXh0dXJlKGUsdCxpLHMscj0zLG49bnVsbCxhPW51bGwsbz1udWxsLGg9bnVsbCxsPW51bGwsdT1udWxsLGQsZixfLEUpe3JldHVybiB0aGlzLl9jcmVhdGVUZXh0dXJlQmFzZShlLHQsaSxzLHIsbixhLHRoaXMuX3ByZXBhcmVXZWJHTFRleHR1cmUuYmluZCh0aGlzKSwobSx2LFMseSxBLEMpPT57Y29uc3QgYj10aGlzLl9nbCxNPVMud2lkdGg9PT1tJiZTLmhlaWdodD09PXYsTD1sP3RoaXMuX2dldEludGVybmFsRm9ybWF0KGwsQS5fdXNlU1JHQkJ1ZmZlcik6eT09PSIuanBnIiYmIUEuX3VzZVNSR0JCdWZmZXI/Yi5SR0I6QS5fdXNlU1JHQkJ1ZmZlcj9iLlNSR0I4X0FMUEhBODpiLlJHQkE7bGV0IGs9bD90aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChsKTp5PT09Ii5qcGciJiYhQS5fdXNlU1JHQkJ1ZmZlcj9iLlJHQjpiLlJHQkE7aWYoQS5fdXNlU1JHQkJ1ZmZlciYmdGhpcy53ZWJHTFZlcnNpb249PT0xJiYoaz1MKSxNKXJldHVybiBiLnRleEltYWdlMkQoYi5URVhUVVJFXzJELDAsTCxrLGIuVU5TSUdORURfQllURSxTKSwhMTtjb25zdCB3PXRoaXMuX2NhcHMubWF4VGV4dHVyZVNpemU7aWYoUy53aWR0aD53fHxTLmhlaWdodD53fHwhdGhpcy5fc3VwcG9ydHNIYXJkd2FyZVRleHR1cmVSZXNjYWxpbmcpcmV0dXJuIHRoaXMuX3ByZXBhcmVXb3JraW5nQ2FudmFzKCksIXRoaXMuX3dvcmtpbmdDYW52YXN8fCF0aGlzLl93b3JraW5nQ29udGV4dHx8KHRoaXMuX3dvcmtpbmdDYW52YXMud2lkdGg9bSx0aGlzLl93b3JraW5nQ2FudmFzLmhlaWdodD12LHRoaXMuX3dvcmtpbmdDb250ZXh0LmRyYXdJbWFnZShTLDAsMCxTLndpZHRoLFMuaGVpZ2h0LDAsMCxtLHYpLGIudGV4SW1hZ2UyRChiLlRFWFRVUkVfMkQsMCxMLGssYi5VTlNJR05FRF9CWVRFLHRoaXMuX3dvcmtpbmdDYW52YXMpLEEud2lkdGg9bSxBLmhlaWdodD12KSwhMTt7Y29uc3QgZGU9bmV3IE90KHRoaXMsTmUuVGVtcCk7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShiLlRFWFRVUkVfMkQsZGUsITApLGIudGV4SW1hZ2UyRChiLlRFWFRVUkVfMkQsMCxMLGssYi5VTlNJR05FRF9CWVRFLFMpLHRoaXMuX3Jlc2NhbGVUZXh0dXJlKGRlLEEscyxMLCgpPT57dGhpcy5fcmVsZWFzZVRleHR1cmUoZGUpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoYi5URVhUVVJFXzJELEEsITApLEMoKX0pfXJldHVybiEwfSxvLGgsbCx1LGQsZixFKX1zdGF0aWMgX0ZpbGVUb29sc0xvYWRJbWFnZShlLHQsaSxzLHIsbil7dGhyb3cgJCgiRmlsZVRvb2xzIil9X3Jlc2NhbGVUZXh0dXJlKGUsdCxpLHMscil7fWNyZWF0ZVJhd1RleHR1cmUoZSx0LGkscyxyLG4sYSxvPW51bGwsaD0wLGw9MCx1PSExKXt0aHJvdyAkKCJFbmdpbmUuUmF3VGV4dHVyZSIpfWNyZWF0ZVJhd0N1YmVUZXh0dXJlKGUsdCxpLHMscixuLGEsbz1udWxsKXt0aHJvdyAkKCJFbmdpbmUuUmF3VGV4dHVyZSIpfWNyZWF0ZVJhd1RleHR1cmUzRChlLHQsaSxzLHIsbixhLG8saD1udWxsLGw9MCl7dGhyb3cgJCgiRW5naW5lLlJhd1RleHR1cmUiKX1jcmVhdGVSYXdUZXh0dXJlMkRBcnJheShlLHQsaSxzLHIsbixhLG8saD1udWxsLGw9MCl7dGhyb3cgJCgiRW5naW5lLlJhd1RleHR1cmUiKX1fdW5wYWNrRmxpcFkoZSl7dGhpcy5fdW5wYWNrRmxpcFlDYWNoZWQhPT1lJiYodGhpcy5fZ2wucGl4ZWxTdG9yZWkodGhpcy5fZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCxlPzE6MCksdGhpcy5lbmFibGVVbnBhY2tGbGlwWUNhY2hlZCYmKHRoaXMuX3VucGFja0ZsaXBZQ2FjaGVkPWUpKX1fZ2V0VW5wYWNrQWxpZ25lbWVudCgpe3JldHVybiB0aGlzLl9nbC5nZXRQYXJhbWV0ZXIodGhpcy5fZ2wuVU5QQUNLX0FMSUdOTUVOVCl9X2dldFRleHR1cmVUYXJnZXQoZSl7cmV0dXJuIGUuaXNDdWJlP3RoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVA6ZS5pczNEP3RoaXMuX2dsLlRFWFRVUkVfM0Q6ZS5pczJEQXJyYXl8fGUuaXNNdWx0aXZpZXc/dGhpcy5fZ2wuVEVYVFVSRV8yRF9BUlJBWTp0aGlzLl9nbC5URVhUVVJFXzJEfXVwZGF0ZVRleHR1cmVTYW1wbGluZ01vZGUoZSx0LGk9ITEpe2NvbnN0IHM9dGhpcy5fZ2V0VGV4dHVyZVRhcmdldCh0KSxyPXRoaXMuX2dldFNhbXBsaW5nUGFyYW1ldGVycyhlLHQuZ2VuZXJhdGVNaXBNYXBzfHxpKTt0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihzLHRoaXMuX2dsLlRFWFRVUkVfTUFHX0ZJTFRFUixyLm1hZyx0KSx0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihzLHRoaXMuX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUixyLm1pbiksaSYmKHQuZ2VuZXJhdGVNaXBNYXBzPSEwLHRoaXMuX2dsLmdlbmVyYXRlTWlwbWFwKHMpKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHMsbnVsbCksdC5zYW1wbGluZ01vZGU9ZX11cGRhdGVUZXh0dXJlRGltZW5zaW9ucyhlLHQsaSxzPTEpe311cGRhdGVUZXh0dXJlV3JhcHBpbmdNb2RlKGUsdCxpPW51bGwscz1udWxsKXtjb25zdCByPXRoaXMuX2dldFRleHR1cmVUYXJnZXQoZSk7dCE9PW51bGwmJih0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihyLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9TLHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZSh0KSxlKSxlLl9jYWNoZWRXcmFwVT10KSxpIT09bnVsbCYmKHRoaXMuX3NldFRleHR1cmVQYXJhbWV0ZXJJbnRlZ2VyKHIsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1QsdGhpcy5fZ2V0VGV4dHVyZVdyYXBNb2RlKGkpLGUpLGUuX2NhY2hlZFdyYXBWPWkpLChlLmlzMkRBcnJheXx8ZS5pczNEKSYmcyE9PW51bGwmJih0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihyLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9SLHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZShzKSxlKSxlLl9jYWNoZWRXcmFwUj1zKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHIsbnVsbCl9X3NldHVwRGVwdGhTdGVuY2lsVGV4dHVyZShlLHQsaSxzLHIsbj0xKXtjb25zdCBhPXQud2lkdGh8fHQsbz10LmhlaWdodHx8dCxoPXQubGF5ZXJzfHwwO2UuYmFzZVdpZHRoPWEsZS5iYXNlSGVpZ2h0PW8sZS53aWR0aD1hLGUuaGVpZ2h0PW8sZS5pczJEQXJyYXk9aD4wLGUuZGVwdGg9aCxlLmlzUmVhZHk9ITAsZS5zYW1wbGVzPW4sZS5nZW5lcmF0ZU1pcE1hcHM9ITEsZS5zYW1wbGluZ01vZGU9cz8yOjEsZS50eXBlPTAsZS5fY29tcGFyaXNvbkZ1bmN0aW9uPXI7Y29uc3QgbD10aGlzLl9nbCx1PXRoaXMuX2dldFRleHR1cmVUYXJnZXQoZSksZD10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMoZS5zYW1wbGluZ01vZGUsITEpO2wudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9NQUdfRklMVEVSLGQubWFnKSxsLnRleFBhcmFtZXRlcmkodSxsLlRFWFRVUkVfTUlOX0ZJTFRFUixkLm1pbiksbC50ZXhQYXJhbWV0ZXJpKHUsbC5URVhUVVJFX1dSQVBfUyxsLkNMQU1QX1RPX0VER0UpLGwudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9XUkFQX1QsbC5DTEFNUF9UT19FREdFKSx0aGlzLndlYkdMVmVyc2lvbj4xJiYocj09PTA/KGwudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9DT01QQVJFX0ZVTkMsNTE1KSxsLnRleFBhcmFtZXRlcmkodSxsLlRFWFRVUkVfQ09NUEFSRV9NT0RFLGwuTk9ORSkpOihsLnRleFBhcmFtZXRlcmkodSxsLlRFWFRVUkVfQ09NUEFSRV9GVU5DLHIpLGwudGV4UGFyYW1ldGVyaSh1LGwuVEVYVFVSRV9DT01QQVJFX01PREUsbC5DT01QQVJFX1JFRl9UT19URVhUVVJFKSkpfV91cGxvYWRDb21wcmVzc2VkRGF0YVRvVGV4dHVyZURpcmVjdGx5KGUsdCxpLHMscixuPTAsYT0wKXtjb25zdCBvPXRoaXMuX2dsO2xldCBoPW8uVEVYVFVSRV8yRDtpZihlLmlzQ3ViZSYmKGg9by5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grbiksZS5fdXNlU1JHQkJ1ZmZlcilzd2l0Y2godCl7Y2FzZSAzNzQ5MjpjYXNlIDM2MTk2OnRoaXMuX2NhcHMuZXRjMj90PW8uQ09NUFJFU1NFRF9TUkdCOF9FVEMyOmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWs7Y2FzZSAzNzQ5Njp0aGlzLl9jYXBzLmV0YzI/dD1vLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0VUQzJfRUFDOmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWs7Y2FzZSAzNjQ5Mjp0PW8uQ09NUFJFU1NFRF9TUkdCX0FMUEhBX0JQVENfVU5PUk1fRVhUO2JyZWFrO2Nhc2UgMzc4MDg6dD1vLkNPTVBSRVNTRURfU1JHQjhfQUxQSEE4X0FTVENfNHg0X0tIUjticmVhaztjYXNlIDMzNzc2OnRoaXMuX2NhcHMuczN0Y19zcmdiP3Q9by5DT01QUkVTU0VEX1NSR0JfUzNUQ19EWFQxX0VYVDplLl91c2VTUkdCQnVmZmVyPSExO2JyZWFrO2Nhc2UgMzM3Nzc6dGhpcy5fY2Fwcy5zM3RjX3NyZ2I/dD1vLkNPTVBSRVNTRURfU1JHQl9BTFBIQV9TM1RDX0RYVDFfRVhUOmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWs7Y2FzZSAzMzc3OTp0aGlzLl9jYXBzLnMzdGNfc3JnYj90PW8uQ09NUFJFU1NFRF9TUkdCX0FMUEhBX1MzVENfRFhUNV9FWFQ6ZS5fdXNlU1JHQkJ1ZmZlcj0hMTticmVhaztkZWZhdWx0OmUuX3VzZVNSR0JCdWZmZXI9ITE7YnJlYWt9dGhpcy5fZ2wuY29tcHJlc3NlZFRleEltYWdlMkQoaCxhLHQsaSxzLDAscil9X3VwbG9hZERhdGFUb1RleHR1cmVEaXJlY3RseShlLHQsaT0wLHM9MCxyLG49ITEpe2NvbnN0IGE9dGhpcy5fZ2wsbz10aGlzLl9nZXRXZWJHTFRleHR1cmVUeXBlKGUudHlwZSksaD10aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChlLmZvcm1hdCksbD1yPT09dm9pZCAwP3RoaXMuX2dldFJHQkFCdWZmZXJJbnRlcm5hbFNpemVkRm9ybWF0KGUudHlwZSxlLmZvcm1hdCxlLl91c2VTUkdCQnVmZmVyKTp0aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChyLGUuX3VzZVNSR0JCdWZmZXIpO3RoaXMuX3VucGFja0ZsaXBZKGUuaW52ZXJ0WSk7bGV0IHU9YS5URVhUVVJFXzJEO2UuaXNDdWJlJiYodT1hLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtpKTtjb25zdCBkPU1hdGgucm91bmQoTWF0aC5sb2coZS53aWR0aCkqTWF0aC5MT0cyRSksZj1NYXRoLnJvdW5kKE1hdGgubG9nKGUuaGVpZ2h0KSpNYXRoLkxPRzJFKSxfPW4/ZS53aWR0aDpNYXRoLnBvdygyLE1hdGgubWF4KGQtcywwKSksRT1uP2UuaGVpZ2h0Ok1hdGgucG93KDIsTWF0aC5tYXgoZi1zLDApKTthLnRleEltYWdlMkQodSxzLGwsXyxFLDAsaCxvLHQpfXVwZGF0ZVRleHR1cmVEYXRhKGUsdCxpLHMscixuLGE9MCxvPTAsaD0hMSl7Y29uc3QgbD10aGlzLl9nbCx1PXRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoZS50eXBlKSxkPXRoaXMuX2dldEludGVybmFsRm9ybWF0KGUuZm9ybWF0KTt0aGlzLl91bnBhY2tGbGlwWShlLmludmVydFkpO2xldCBmPWwuVEVYVFVSRV8yRCxfPWwuVEVYVFVSRV8yRDtlLmlzQ3ViZSYmKF89bC5URVhUVVJFX0NVQkVfTUFQX1BPU0lUSVZFX1grYSxmPWwuVEVYVFVSRV9DVUJFX01BUCksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShmLGUsITApLGwudGV4U3ViSW1hZ2UyRChfLG8saSxzLHIsbixkLHUsdCksaCYmdGhpcy5fZ2wuZ2VuZXJhdGVNaXBtYXAoXyksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShmLG51bGwpfV91cGxvYWRBcnJheUJ1ZmZlclZpZXdUb1RleHR1cmUoZSx0LGk9MCxzPTApe2NvbnN0IHI9dGhpcy5fZ2wsbj1lLmlzQ3ViZT9yLlRFWFRVUkVfQ1VCRV9NQVA6ci5URVhUVVJFXzJEO3RoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkobixlLCEwKSx0aGlzLl91cGxvYWREYXRhVG9UZXh0dXJlRGlyZWN0bHkoZSx0LGkscyksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShuLG51bGwsITApfV9wcmVwYXJlV2ViR0xUZXh0dXJlQ29udGludWF0aW9uKGUsdCxpLHMscil7Y29uc3Qgbj10aGlzLl9nbDtpZighbilyZXR1cm47Y29uc3QgYT10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMociwhaSk7bi50ZXhQYXJhbWV0ZXJpKG4uVEVYVFVSRV8yRCxuLlRFWFRVUkVfTUFHX0ZJTFRFUixhLm1hZyksbi50ZXhQYXJhbWV0ZXJpKG4uVEVYVFVSRV8yRCxuLlRFWFRVUkVfTUlOX0ZJTFRFUixhLm1pbiksIWkmJiFzJiZuLmdlbmVyYXRlTWlwbWFwKG4uVEVYVFVSRV8yRCksdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShuLlRFWFRVUkVfMkQsbnVsbCksdCYmdC5yZW1vdmVQZW5kaW5nRGF0YShlKSxlLm9uTG9hZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksZS5vbkxvYWRlZE9ic2VydmFibGUuY2xlYXIoKX1fcHJlcGFyZVdlYkdMVGV4dHVyZShlLHQsaSxzLHIsbixhLG8saD0zKXtjb25zdCBsPXRoaXMuZ2V0Q2FwcygpLm1heFRleHR1cmVTaXplLHU9TWF0aC5taW4obCx0aGlzLm5lZWRQT1RUZXh0dXJlcz9vZS5HZXRFeHBvbmVudE9mVHdvKHMud2lkdGgsbCk6cy53aWR0aCksZD1NYXRoLm1pbihsLHRoaXMubmVlZFBPVFRleHR1cmVzP29lLkdldEV4cG9uZW50T2ZUd28ocy5oZWlnaHQsbCk6cy5oZWlnaHQpLGY9dGhpcy5fZ2w7aWYoZil7aWYoIWUuX2hhcmR3YXJlVGV4dHVyZSl7aSYmaS5yZW1vdmVQZW5kaW5nRGF0YShlKTtyZXR1cm59dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShmLlRFWFRVUkVfMkQsZSwhMCksdGhpcy5fdW5wYWNrRmxpcFkocj09PXZvaWQgMD8hMDohIXIpLGUuYmFzZVdpZHRoPXMud2lkdGgsZS5iYXNlSGVpZ2h0PXMuaGVpZ2h0LGUud2lkdGg9dSxlLmhlaWdodD1kLGUuaXNSZWFkeT0hMCwhbyh1LGQscyx0LGUsKCk9Pnt0aGlzLl9wcmVwYXJlV2ViR0xUZXh0dXJlQ29udGludWF0aW9uKGUsaSxuLGEsaCl9KSYmdGhpcy5fcHJlcGFyZVdlYkdMVGV4dHVyZUNvbnRpbnVhdGlvbihlLGksbixhLGgpfX1fc2V0dXBGcmFtZWJ1ZmZlckRlcHRoQXR0YWNobWVudHMoZSx0LGkscyxyPTEpe2NvbnN0IG49dGhpcy5fZ2w7aWYoZSYmdClyZXR1cm4gdGhpcy5fY3JlYXRlUmVuZGVyQnVmZmVyKGkscyxyLG4uREVQVEhfU1RFTkNJTCxuLkRFUFRIMjRfU1RFTkNJTDgsbi5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQpO2lmKHQpe2xldCBhPW4uREVQVEhfQ09NUE9ORU5UMTY7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbj4xJiYoYT1uLkRFUFRIX0NPTVBPTkVOVDMyRiksdGhpcy5fY3JlYXRlUmVuZGVyQnVmZmVyKGkscyxyLGEsYSxuLkRFUFRIX0FUVEFDSE1FTlQpfXJldHVybiBlP3RoaXMuX2NyZWF0ZVJlbmRlckJ1ZmZlcihpLHMscixuLlNURU5DSUxfSU5ERVg4LG4uU1RFTkNJTF9JTkRFWDgsbi5TVEVOQ0lMX0FUVEFDSE1FTlQpOm51bGx9X2NyZWF0ZVJlbmRlckJ1ZmZlcihlLHQsaSxzLHIsbixhPSEwKXtjb25zdCBoPXRoaXMuX2dsLmNyZWF0ZVJlbmRlcmJ1ZmZlcigpO3JldHVybiB0aGlzLl91cGRhdGVSZW5kZXJCdWZmZXIoaCxlLHQsaSxzLHIsbixhKX1fdXBkYXRlUmVuZGVyQnVmZmVyKGUsdCxpLHMscixuLGEsbz0hMCl7Y29uc3QgaD10aGlzLl9nbDtyZXR1cm4gaC5iaW5kUmVuZGVyYnVmZmVyKGguUkVOREVSQlVGRkVSLGUpLHM+MSYmaC5yZW5kZXJidWZmZXJTdG9yYWdlTXVsdGlzYW1wbGU/aC5yZW5kZXJidWZmZXJTdG9yYWdlTXVsdGlzYW1wbGUoaC5SRU5ERVJCVUZGRVIscyxuLHQsaSk6aC5yZW5kZXJidWZmZXJTdG9yYWdlKGguUkVOREVSQlVGRkVSLHIsdCxpKSxoLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGguRlJBTUVCVUZGRVIsYSxoLlJFTkRFUkJVRkZFUixlKSxvJiZoLmJpbmRSZW5kZXJidWZmZXIoaC5SRU5ERVJCVUZGRVIsbnVsbCksZX1fcmVsZWFzZVRleHR1cmUoZSl7dmFyIHQ7dGhpcy5fZGVsZXRlVGV4dHVyZSgodD1lLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC51bmRlcmx5aW5nUmVzb3VyY2UpLHRoaXMudW5iaW5kQWxsVGV4dHVyZXMoKTtjb25zdCBpPXRoaXMuX2ludGVybmFsVGV4dHVyZXNDYWNoZS5pbmRleE9mKGUpO2khPT0tMSYmdGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnNwbGljZShpLDEpLGUuX2xvZFRleHR1cmVIaWdoJiZlLl9sb2RUZXh0dXJlSGlnaC5kaXNwb3NlKCksZS5fbG9kVGV4dHVyZU1pZCYmZS5fbG9kVGV4dHVyZU1pZC5kaXNwb3NlKCksZS5fbG9kVGV4dHVyZUxvdyYmZS5fbG9kVGV4dHVyZUxvdy5kaXNwb3NlKCksZS5faXJyYWRpYW5jZVRleHR1cmUmJmUuX2lycmFkaWFuY2VUZXh0dXJlLmRpc3Bvc2UoKX1fcmVsZWFzZVJlbmRlclRhcmdldFdyYXBwZXIoZSl7Y29uc3QgdD10aGlzLl9yZW5kZXJUYXJnZXRXcmFwcGVyQ2FjaGUuaW5kZXhPZihlKTt0IT09LTEmJnRoaXMuX3JlbmRlclRhcmdldFdyYXBwZXJDYWNoZS5zcGxpY2UodCwxKX1fZGVsZXRlVGV4dHVyZShlKXtlJiZ0aGlzLl9nbC5kZWxldGVUZXh0dXJlKGUpfV9zZXRQcm9ncmFtKGUpe3RoaXMuX2N1cnJlbnRQcm9ncmFtIT09ZSYmKHRoaXMuX2dsLnVzZVByb2dyYW0oZSksdGhpcy5fY3VycmVudFByb2dyYW09ZSl9YmluZFNhbXBsZXJzKGUpe2NvbnN0IHQ9ZS5nZXRQaXBlbGluZUNvbnRleHQoKTt0aGlzLl9zZXRQcm9ncmFtKHQucHJvZ3JhbSk7Y29uc3QgaT1lLmdldFNhbXBsZXJzKCk7Zm9yKGxldCBzPTA7czxpLmxlbmd0aDtzKyspe2NvbnN0IHI9ZS5nZXRVbmlmb3JtKGlbc10pO3ImJih0aGlzLl9ib3VuZFVuaWZvcm1zW3NdPXIpfXRoaXMuX2N1cnJlbnRFZmZlY3Q9bnVsbH1fYWN0aXZhdGVDdXJyZW50VGV4dHVyZSgpe3RoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbCE9PXRoaXMuX2FjdGl2ZUNoYW5uZWwmJih0aGlzLl9nbC5hY3RpdmVUZXh0dXJlKHRoaXMuX2dsLlRFWFRVUkUwK3RoaXMuX2FjdGl2ZUNoYW5uZWwpLHRoaXMuX2N1cnJlbnRUZXh0dXJlQ2hhbm5lbD10aGlzLl9hY3RpdmVDaGFubmVsKX1fYmluZFRleHR1cmVEaXJlY3RseShlLHQsaT0hMSxzPSExKXt2YXIgcixuO2xldCBhPSExO2NvbnN0IG89dCYmdC5fYXNzb2NpYXRlZENoYW5uZWw+LTE7aWYoaSYmbyYmKHRoaXMuX2FjdGl2ZUNoYW5uZWw9dC5fYXNzb2NpYXRlZENoYW5uZWwpLHRoaXMuX2JvdW5kVGV4dHVyZXNDYWNoZVt0aGlzLl9hY3RpdmVDaGFubmVsXSE9PXR8fHMpe2lmKHRoaXMuX2FjdGl2YXRlQ3VycmVudFRleHR1cmUoKSx0JiZ0LmlzTXVsdGl2aWV3KXRocm93IGNvbnNvbGUuZXJyb3IoZSx0KSwiX2JpbmRUZXh0dXJlRGlyZWN0bHkgY2FsbGVkIHdpdGggYSBtdWx0aXZpZXcgdGV4dHVyZSEiO3RoaXMuX2dsLmJpbmRUZXh0dXJlKGUsKG49KHI9dD09bnVsbD92b2lkIDA6dC5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fHI9PT12b2lkIDA/dm9pZCAwOnIudW5kZXJseWluZ1Jlc291cmNlKSE9PW51bGwmJm4hPT12b2lkIDA/bjpudWxsKSx0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGVbdGhpcy5fYWN0aXZlQ2hhbm5lbF09dCx0JiYodC5fYXNzb2NpYXRlZENoYW5uZWw9dGhpcy5fYWN0aXZlQ2hhbm5lbCl9ZWxzZSBpJiYoYT0hMCx0aGlzLl9hY3RpdmF0ZUN1cnJlbnRUZXh0dXJlKCkpO3JldHVybiBvJiYhaSYmdGhpcy5fYmluZFNhbXBsZXJVbmlmb3JtVG9DaGFubmVsKHQuX2Fzc29jaWF0ZWRDaGFubmVsLHRoaXMuX2FjdGl2ZUNoYW5uZWwpLGF9X2JpbmRUZXh0dXJlKGUsdCxpKXtpZihlPT09dm9pZCAwKXJldHVybjt0JiYodC5fYXNzb2NpYXRlZENoYW5uZWw9ZSksdGhpcy5fYWN0aXZlQ2hhbm5lbD1lO2NvbnN0IHM9dD90aGlzLl9nZXRUZXh0dXJlVGFyZ2V0KHQpOnRoaXMuX2dsLlRFWFRVUkVfMkQ7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShzLHQpfXVuYmluZEFsbFRleHR1cmVzKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLl9tYXhTaW11bHRhbmVvdXNUZXh0dXJlcztlKyspdGhpcy5fYWN0aXZlQ2hhbm5lbD1lLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8yRCxudWxsKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCksdGhpcy53ZWJHTFZlcnNpb24+MSYmKHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8zRCxudWxsKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkRfQVJSQVksbnVsbCkpfXNldFRleHR1cmUoZSx0LGkscyl7ZSE9PXZvaWQgMCYmKHQmJih0aGlzLl9ib3VuZFVuaWZvcm1zW2VdPXQpLHRoaXMuX3NldFRleHR1cmUoZSxpKSl9X2JpbmRTYW1wbGVyVW5pZm9ybVRvQ2hhbm5lbChlLHQpe2NvbnN0IGk9dGhpcy5fYm91bmRVbmlmb3Jtc1tlXTshaXx8aS5fY3VycmVudFN0YXRlPT09dHx8KHRoaXMuX2dsLnVuaWZvcm0xaShpLHQpLGkuX2N1cnJlbnRTdGF0ZT10KX1fZ2V0VGV4dHVyZVdyYXBNb2RlKGUpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIHRoaXMuX2dsLlJFUEVBVDtjYXNlIDA6cmV0dXJuIHRoaXMuX2dsLkNMQU1QX1RPX0VER0U7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5NSVJST1JFRF9SRVBFQVR9cmV0dXJuIHRoaXMuX2dsLlJFUEVBVH1fc2V0VGV4dHVyZShlLHQsaT0hMSxzPSExLHI9IiIpe2lmKCF0KXJldHVybiB0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGVbZV0hPW51bGwmJih0aGlzLl9hY3RpdmVDaGFubmVsPWUsdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseSh0aGlzLl9nbC5URVhUVVJFXzJELG51bGwpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV9DVUJFX01BUCxudWxsKSx0aGlzLndlYkdMVmVyc2lvbj4xJiYodGhpcy5fYmluZFRleHR1cmVEaXJlY3RseSh0aGlzLl9nbC5URVhUVVJFXzNELG51bGwpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkodGhpcy5fZ2wuVEVYVFVSRV8yRF9BUlJBWSxudWxsKSkpLCExO2lmKHQudmlkZW8pdGhpcy5fYWN0aXZlQ2hhbm5lbD1lLHQudXBkYXRlKCk7ZWxzZSBpZih0LmRlbGF5TG9hZFN0YXRlPT09NClyZXR1cm4gdC5kZWxheUxvYWQoKSwhMTtsZXQgbjtzP249dC5kZXB0aFN0ZW5jaWxUZXh0dXJlOnQuaXNSZWFkeSgpP249dC5nZXRJbnRlcm5hbFRleHR1cmUoKTp0LmlzQ3ViZT9uPXRoaXMuZW1wdHlDdWJlVGV4dHVyZTp0LmlzM0Q/bj10aGlzLmVtcHR5VGV4dHVyZTNEOnQuaXMyREFycmF5P249dGhpcy5lbXB0eVRleHR1cmUyREFycmF5Om49dGhpcy5lbXB0eVRleHR1cmUsIWkmJm4mJihuLl9hc3NvY2lhdGVkQ2hhbm5lbD1lKTtsZXQgYT0hMDt0aGlzLl9ib3VuZFRleHR1cmVzQ2FjaGVbZV09PT1uJiYoaXx8dGhpcy5fYmluZFNhbXBsZXJVbmlmb3JtVG9DaGFubmVsKG4uX2Fzc29jaWF0ZWRDaGFubmVsLGUpLGE9ITEpLHRoaXMuX2FjdGl2ZUNoYW5uZWw9ZTtjb25zdCBvPXRoaXMuX2dldFRleHR1cmVUYXJnZXQobik7aWYoYSYmdGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShvLG4saSksbiYmIW4uaXNNdWx0aXZpZXcpe2lmKG4uaXNDdWJlJiZuLl9jYWNoZWRDb29yZGluYXRlc01vZGUhPT10LmNvb3JkaW5hdGVzTW9kZSl7bi5fY2FjaGVkQ29vcmRpbmF0ZXNNb2RlPXQuY29vcmRpbmF0ZXNNb2RlO2NvbnN0IGg9dC5jb29yZGluYXRlc01vZGUhPT0zJiZ0LmNvb3JkaW5hdGVzTW9kZSE9PTU/MTowO3Qud3JhcFU9aCx0LndyYXBWPWh9bi5fY2FjaGVkV3JhcFUhPT10LndyYXBVJiYobi5fY2FjaGVkV3JhcFU9dC53cmFwVSx0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihvLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9TLHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZSh0LndyYXBVKSxuKSksbi5fY2FjaGVkV3JhcFYhPT10LndyYXBWJiYobi5fY2FjaGVkV3JhcFY9dC53cmFwVix0aGlzLl9zZXRUZXh0dXJlUGFyYW1ldGVySW50ZWdlcihvLHRoaXMuX2dsLlRFWFRVUkVfV1JBUF9ULHRoaXMuX2dldFRleHR1cmVXcmFwTW9kZSh0LndyYXBWKSxuKSksbi5pczNEJiZuLl9jYWNoZWRXcmFwUiE9PXQud3JhcFImJihuLl9jYWNoZWRXcmFwUj10LndyYXBSLHRoaXMuX3NldFRleHR1cmVQYXJhbWV0ZXJJbnRlZ2VyKG8sdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1IsdGhpcy5fZ2V0VGV4dHVyZVdyYXBNb2RlKHQud3JhcFIpLG4pKSx0aGlzLl9zZXRBbmlzb3Ryb3BpY0xldmVsKG8sbix0LmFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWwpfXJldHVybiEwfXNldFRleHR1cmVBcnJheShlLHQsaSxzKXtpZighKGU9PT12b2lkIDB8fCF0KSl7KCF0aGlzLl90ZXh0dXJlVW5pdHN8fHRoaXMuX3RleHR1cmVVbml0cy5sZW5ndGghPT1pLmxlbmd0aCkmJih0aGlzLl90ZXh0dXJlVW5pdHM9bmV3IEludDMyQXJyYXkoaS5sZW5ndGgpKTtmb3IobGV0IHI9MDtyPGkubGVuZ3RoO3IrKyl7Y29uc3Qgbj1pW3JdLmdldEludGVybmFsVGV4dHVyZSgpO24/KHRoaXMuX3RleHR1cmVVbml0c1tyXT1lK3Isbi5fYXNzb2NpYXRlZENoYW5uZWw9ZStyKTp0aGlzLl90ZXh0dXJlVW5pdHNbcl09LTF9dGhpcy5fZ2wudW5pZm9ybTFpdih0LHRoaXMuX3RleHR1cmVVbml0cyk7Zm9yKGxldCByPTA7cjxpLmxlbmd0aDtyKyspdGhpcy5fc2V0VGV4dHVyZSh0aGlzLl90ZXh0dXJlVW5pdHNbcl0saVtyXSwhMCl9fV9zZXRBbmlzb3Ryb3BpY0xldmVsKGUsdCxpKXtjb25zdCBzPXRoaXMuX2NhcHMudGV4dHVyZUFuaXNvdHJvcGljRmlsdGVyRXh0ZW5zaW9uO3Quc2FtcGxpbmdNb2RlIT09MTEmJnQuc2FtcGxpbmdNb2RlIT09MyYmdC5zYW1wbGluZ01vZGUhPT0yJiYoaT0xKSxzJiZ0Ll9jYWNoZWRBbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsIT09aSYmKHRoaXMuX3NldFRleHR1cmVQYXJhbWV0ZXJGbG9hdChlLHMuVEVYVFVSRV9NQVhfQU5JU09UUk9QWV9FWFQsTWF0aC5taW4oaSx0aGlzLl9jYXBzLm1heEFuaXNvdHJvcHkpLHQpLHQuX2NhY2hlZEFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWw9aSl9X3NldFRleHR1cmVQYXJhbWV0ZXJGbG9hdChlLHQsaSxzKXt0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KGUscywhMCwhMCksdGhpcy5fZ2wudGV4UGFyYW1ldGVyZihlLHQsaSl9X3NldFRleHR1cmVQYXJhbWV0ZXJJbnRlZ2VyKGUsdCxpLHMpe3MmJnRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoZSxzLCEwLCEwKSx0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKGUsdCxpKX11bmJpbmRBbGxBdHRyaWJ1dGVzKCl7aWYodGhpcy5fbXVzdFdpcGVWZXJ0ZXhBdHRyaWJ1dGVzKXt0aGlzLl9tdXN0V2lwZVZlcnRleEF0dHJpYnV0ZXM9ITE7Zm9yKGxldCBlPTA7ZTx0aGlzLl9jYXBzLm1heFZlcnRleEF0dHJpYnM7ZSsrKXRoaXMuZGlzYWJsZUF0dHJpYnV0ZUJ5SW5kZXgoZSk7cmV0dXJufWZvcihsZXQgZT0wLHQ9dGhpcy5fdmVydGV4QXR0cmliQXJyYXlzRW5hYmxlZC5sZW5ndGg7ZTx0O2UrKyllPj10aGlzLl9jYXBzLm1heFZlcnRleEF0dHJpYnN8fCF0aGlzLl92ZXJ0ZXhBdHRyaWJBcnJheXNFbmFibGVkW2VdfHx0aGlzLmRpc2FibGVBdHRyaWJ1dGVCeUluZGV4KGUpfXJlbGVhc2VFZmZlY3RzKCl7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fY29tcGlsZWRFZmZlY3RzKXtjb25zdCB0PXRoaXMuX2NvbXBpbGVkRWZmZWN0c1tlXS5nZXRQaXBlbGluZUNvbnRleHQoKTt0aGlzLl9kZWxldGVQaXBlbGluZUNvbnRleHQodCl9dGhpcy5fY29tcGlsZWRFZmZlY3RzPXt9fWRpc3Bvc2UoKXt2YXIgZTt0aGlzLnN0b3BSZW5kZXJMb29wKCksdGhpcy5vbkJlZm9yZVRleHR1cmVJbml0T2JzZXJ2YWJsZSYmdGhpcy5vbkJlZm9yZVRleHR1cmVJbml0T2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX2VtcHR5VGV4dHVyZSYmKHRoaXMuX3JlbGVhc2VUZXh0dXJlKHRoaXMuX2VtcHR5VGV4dHVyZSksdGhpcy5fZW1wdHlUZXh0dXJlPW51bGwpLHRoaXMuX2VtcHR5Q3ViZVRleHR1cmUmJih0aGlzLl9yZWxlYXNlVGV4dHVyZSh0aGlzLl9lbXB0eUN1YmVUZXh0dXJlKSx0aGlzLl9lbXB0eUN1YmVUZXh0dXJlPW51bGwpLHRoaXMuX2R1bW15RnJhbWVidWZmZXImJnRoaXMuX2dsLmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuX2R1bW15RnJhbWVidWZmZXIpLHRoaXMucmVsZWFzZUVmZmVjdHMoKSwoZT10aGlzLnJlbGVhc2VDb21wdXRlRWZmZWN0cyk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmNhbGwodGhpcyksdGhpcy51bmJpbmRBbGxBdHRyaWJ1dGVzKCksdGhpcy5fYm91bmRVbmlmb3Jtcz17fSxqZSgpJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMmJih0aGlzLl9kb05vdEhhbmRsZUNvbnRleHRMb3N0fHwodGhpcy5fcmVuZGVyaW5nQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dGxvc3QiLHRoaXMuX29uQ29udGV4dExvc3QpLHRoaXMuX3JlbmRlcmluZ0NhbnZhcy5yZW1vdmVFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRyZXN0b3JlZCIsdGhpcy5fb25Db250ZXh0UmVzdG9yZWQpKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIix0aGlzLl9jaGVja0Zvck1vYmlsZSkpLHRoaXMuX3dvcmtpbmdDYW52YXM9bnVsbCx0aGlzLl93b3JraW5nQ29udGV4dD1udWxsLHRoaXMuX2N1cnJlbnRCdWZmZXJQb2ludGVycy5sZW5ndGg9MCx0aGlzLl9yZW5kZXJpbmdDYW52YXM9bnVsbCx0aGlzLl9jdXJyZW50UHJvZ3JhbT1udWxsLHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb249bnVsbCxQZS5SZXNldENhY2hlKCk7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fYWN0aXZlUmVxdWVzdHMpdC5hYm9ydCgpO3RoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLmNsZWFyKCl9YXR0YWNoQ29udGV4dExvc3RFdmVudChlKXt0aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRsb3N0IixlLCExKX1hdHRhY2hDb250ZXh0UmVzdG9yZWRFdmVudChlKXt0aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRyZXN0b3JlZCIsZSwhMSl9Z2V0RXJyb3IoKXtyZXR1cm4gdGhpcy5fZ2wuZ2V0RXJyb3IoKX1fY2FuUmVuZGVyVG9GbG9hdEZyYW1lYnVmZmVyKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbj4xP3RoaXMuX2NhcHMuY29sb3JCdWZmZXJGbG9hdDp0aGlzLl9jYW5SZW5kZXJUb0ZyYW1lYnVmZmVyKDEpfV9jYW5SZW5kZXJUb0hhbGZGbG9hdEZyYW1lYnVmZmVyKCl7cmV0dXJuIHRoaXMuX3dlYkdMVmVyc2lvbj4xP3RoaXMuX2NhcHMuY29sb3JCdWZmZXJGbG9hdDp0aGlzLl9jYW5SZW5kZXJUb0ZyYW1lYnVmZmVyKDIpfV9jYW5SZW5kZXJUb0ZyYW1lYnVmZmVyKGUpe2NvbnN0IHQ9dGhpcy5fZ2w7Zm9yKDt0LmdldEVycm9yKCkhPT10Lk5PX0VSUk9SOyk7bGV0IGk9ITA7Y29uc3Qgcz10LmNyZWF0ZVRleHR1cmUoKTt0LmJpbmRUZXh0dXJlKHQuVEVYVFVSRV8yRCxzKSx0LnRleEltYWdlMkQodC5URVhUVVJFXzJELDAsdGhpcy5fZ2V0UkdCQUJ1ZmZlckludGVybmFsU2l6ZWRGb3JtYXQoZSksMSwxLDAsdC5SR0JBLHRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoZSksbnVsbCksdC50ZXhQYXJhbWV0ZXJpKHQuVEVYVFVSRV8yRCx0LlRFWFRVUkVfTUlOX0ZJTFRFUix0Lk5FQVJFU1QpLHQudGV4UGFyYW1ldGVyaSh0LlRFWFRVUkVfMkQsdC5URVhUVVJFX01BR19GSUxURVIsdC5ORUFSRVNUKTtjb25zdCByPXQuY3JlYXRlRnJhbWVidWZmZXIoKTt0LmJpbmRGcmFtZWJ1ZmZlcih0LkZSQU1FQlVGRkVSLHIpLHQuZnJhbWVidWZmZXJUZXh0dXJlMkQodC5GUkFNRUJVRkZFUix0LkNPTE9SX0FUVEFDSE1FTlQwLHQuVEVYVFVSRV8yRCxzLDApO2NvbnN0IG49dC5jaGVja0ZyYW1lYnVmZmVyU3RhdHVzKHQuRlJBTUVCVUZGRVIpO2lmKGk9aSYmbj09PXQuRlJBTUVCVUZGRVJfQ09NUExFVEUsaT1pJiZ0LmdldEVycm9yKCk9PT10Lk5PX0VSUk9SLGkmJih0LmNsZWFyKHQuQ09MT1JfQlVGRkVSX0JJVCksaT1pJiZ0LmdldEVycm9yKCk9PT10Lk5PX0VSUk9SKSxpKXt0LmJpbmRGcmFtZWJ1ZmZlcih0LkZSQU1FQlVGRkVSLG51bGwpO2NvbnN0IGE9dC5SR0JBLG89dC5VTlNJR05FRF9CWVRFLGg9bmV3IFVpbnQ4QXJyYXkoNCk7dC5yZWFkUGl4ZWxzKDAsMCwxLDEsYSxvLGgpLGk9aSYmdC5nZXRFcnJvcigpPT09dC5OT19FUlJPUn1mb3IodC5kZWxldGVUZXh0dXJlKHMpLHQuZGVsZXRlRnJhbWVidWZmZXIociksdC5iaW5kRnJhbWVidWZmZXIodC5GUkFNRUJVRkZFUixudWxsKTshaSYmdC5nZXRFcnJvcigpIT09dC5OT19FUlJPUjspO3JldHVybiBpfV9nZXRXZWJHTFRleHR1cmVUeXBlKGUpe2lmKHRoaXMuX3dlYkdMVmVyc2lvbj09PTEpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIHRoaXMuX2dsLkZMT0FUO2Nhc2UgMjpyZXR1cm4gdGhpcy5fZ2wuSEFMRl9GTE9BVF9PRVM7Y2FzZSAwOnJldHVybiB0aGlzLl9nbC5VTlNJR05FRF9CWVRFO2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNF80XzRfNDtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX1NIT1JUXzVfNV81XzE7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNV82XzV9cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0JZVEV9c3dpdGNoKGUpe2Nhc2UgMzpyZXR1cm4gdGhpcy5fZ2wuQllURTtjYXNlIDA6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0JZVEU7Y2FzZSA0OnJldHVybiB0aGlzLl9nbC5TSE9SVDtjYXNlIDU6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX1NIT1JUO2Nhc2UgNjpyZXR1cm4gdGhpcy5fZ2wuSU5UO2Nhc2UgNzpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfSU5UO2Nhc2UgMTpyZXR1cm4gdGhpcy5fZ2wuRkxPQVQ7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5IQUxGX0ZMT0FUO2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNF80XzRfNDtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX1NIT1JUXzVfNV81XzE7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfU0hPUlRfNV82XzU7Y2FzZSAxMTpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfSU5UXzJfMTBfMTBfMTBfUkVWO2Nhc2UgMTI6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0lOVF8yNF84O2Nhc2UgMTM6cmV0dXJuIHRoaXMuX2dsLlVOU0lHTkVEX0lOVF8xMEZfMTFGXzExRl9SRVY7Y2FzZSAxNDpyZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfSU5UXzVfOV85XzlfUkVWO2Nhc2UgMTU6cmV0dXJuIHRoaXMuX2dsLkZMT0FUXzMyX1VOU0lHTkVEX0lOVF8yNF84X1JFVn1yZXR1cm4gdGhpcy5fZ2wuVU5TSUdORURfQllURX1fZ2V0SW50ZXJuYWxGb3JtYXQoZSx0PSExKXtsZXQgaT10P3RoaXMuX2dsLlNSR0I4X0FMUEhBODp0aGlzLl9nbC5SR0JBO3N3aXRjaChlKXtjYXNlIDA6aT10aGlzLl9nbC5BTFBIQTticmVhaztjYXNlIDE6aT10aGlzLl9nbC5MVU1JTkFOQ0U7YnJlYWs7Y2FzZSAyOmk9dGhpcy5fZ2wuTFVNSU5BTkNFX0FMUEhBO2JyZWFrO2Nhc2UgNjppPXRoaXMuX2dsLlJFRDticmVhaztjYXNlIDc6aT10aGlzLl9nbC5SRzticmVhaztjYXNlIDQ6aT10P3RoaXMuX2dsLlNSR0I6dGhpcy5fZ2wuUkdCO2JyZWFrO2Nhc2UgNTppPXQ/dGhpcy5fZ2wuU1JHQjhfQUxQSEE4OnRoaXMuX2dsLlJHQkE7YnJlYWt9aWYodGhpcy5fd2ViR0xWZXJzaW9uPjEpc3dpdGNoKGUpe2Nhc2UgODppPXRoaXMuX2dsLlJFRF9JTlRFR0VSO2JyZWFrO2Nhc2UgOTppPXRoaXMuX2dsLlJHX0lOVEVHRVI7YnJlYWs7Y2FzZSAxMDppPXRoaXMuX2dsLlJHQl9JTlRFR0VSO2JyZWFrO2Nhc2UgMTE6aT10aGlzLl9nbC5SR0JBX0lOVEVHRVI7YnJlYWt9cmV0dXJuIGl9X2dldFJHQkFCdWZmZXJJbnRlcm5hbFNpemVkRm9ybWF0KGUsdCxpPSExKXtpZih0aGlzLl93ZWJHTFZlcnNpb249PT0xKXtpZih0IT09dm9pZCAwKXN3aXRjaCh0KXtjYXNlIDA6cmV0dXJuIHRoaXMuX2dsLkFMUEhBO2Nhc2UgMTpyZXR1cm4gdGhpcy5fZ2wuTFVNSU5BTkNFO2Nhc2UgMjpyZXR1cm4gdGhpcy5fZ2wuTFVNSU5BTkNFX0FMUEhBO2Nhc2UgNDpyZXR1cm4gaT90aGlzLl9nbC5TUkdCOnRoaXMuX2dsLlJHQn1yZXR1cm4gdGhpcy5fZ2wuUkdCQX1zd2l0Y2goZSl7Y2FzZSAzOnN3aXRjaCh0KXtjYXNlIDY6cmV0dXJuIHRoaXMuX2dsLlI4X1NOT1JNO2Nhc2UgNzpyZXR1cm4gdGhpcy5fZ2wuUkc4X1NOT1JNO2Nhc2UgNDpyZXR1cm4gdGhpcy5fZ2wuUkdCOF9TTk9STTtjYXNlIDg6cmV0dXJuIHRoaXMuX2dsLlI4STtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHOEk7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCOEk7Y2FzZSAxMTpyZXR1cm4gdGhpcy5fZ2wuUkdCQThJO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQkE4X1NOT1JNfWNhc2UgMDpzd2l0Y2godCl7Y2FzZSA2OnJldHVybiB0aGlzLl9nbC5SODtjYXNlIDc6cmV0dXJuIHRoaXMuX2dsLlJHODtjYXNlIDQ6cmV0dXJuIGk/dGhpcy5fZ2wuU1JHQjg6dGhpcy5fZ2wuUkdCODtjYXNlIDU6cmV0dXJuIGk/dGhpcy5fZ2wuU1JHQjhfQUxQSEE4OnRoaXMuX2dsLlJHQkE4O2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuUjhVSTtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHOFVJO2Nhc2UgMTA6cmV0dXJuIHRoaXMuX2dsLlJHQjhVSTtjYXNlIDExOnJldHVybiB0aGlzLl9nbC5SR0JBOFVJO2Nhc2UgMDpyZXR1cm4gdGhpcy5fZ2wuQUxQSEE7Y2FzZSAxOnJldHVybiB0aGlzLl9nbC5MVU1JTkFOQ0U7Y2FzZSAyOnJldHVybiB0aGlzLl9nbC5MVU1JTkFOQ0VfQUxQSEE7ZGVmYXVsdDpyZXR1cm4gdGhpcy5fZ2wuUkdCQTh9Y2FzZSA0OnN3aXRjaCh0KXtjYXNlIDg6cmV0dXJuIHRoaXMuX2dsLlIxNkk7Y2FzZSA5OnJldHVybiB0aGlzLl9nbC5SRzE2STtjYXNlIDEwOnJldHVybiB0aGlzLl9nbC5SR0IxNkk7Y2FzZSAxMTpyZXR1cm4gdGhpcy5fZ2wuUkdCQTE2STtkZWZhdWx0OnJldHVybiB0aGlzLl9nbC5SR0JBMTZJfWNhc2UgNTpzd2l0Y2godCl7Y2FzZSA4OnJldHVybiB0aGlzLl9nbC5SMTZVSTtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHMTZVSTtjYXNlIDEwOnJldHVybiB0aGlzLl9nbC5SR0IxNlVJO2Nhc2UgMTE6cmV0dXJuIHRoaXMuX2dsLlJHQkExNlVJO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQkExNlVJfWNhc2UgNjpzd2l0Y2godCl7Y2FzZSA4OnJldHVybiB0aGlzLl9nbC5SMzJJO2Nhc2UgOTpyZXR1cm4gdGhpcy5fZ2wuUkczMkk7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCMzJJO2Nhc2UgMTE6cmV0dXJuIHRoaXMuX2dsLlJHQkEzMkk7ZGVmYXVsdDpyZXR1cm4gdGhpcy5fZ2wuUkdCQTMySX1jYXNlIDc6c3dpdGNoKHQpe2Nhc2UgODpyZXR1cm4gdGhpcy5fZ2wuUjMyVUk7Y2FzZSA5OnJldHVybiB0aGlzLl9nbC5SRzMyVUk7Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCMzJVSTtjYXNlIDExOnJldHVybiB0aGlzLl9nbC5SR0JBMzJVSTtkZWZhdWx0OnJldHVybiB0aGlzLl9nbC5SR0JBMzJVSX1jYXNlIDE6c3dpdGNoKHQpe2Nhc2UgNjpyZXR1cm4gdGhpcy5fZ2wuUjMyRjtjYXNlIDc6cmV0dXJuIHRoaXMuX2dsLlJHMzJGO2Nhc2UgNDpyZXR1cm4gdGhpcy5fZ2wuUkdCMzJGO2Nhc2UgNTpyZXR1cm4gdGhpcy5fZ2wuUkdCQTMyRjtkZWZhdWx0OnJldHVybiB0aGlzLl9nbC5SR0JBMzJGfWNhc2UgMjpzd2l0Y2godCl7Y2FzZSA2OnJldHVybiB0aGlzLl9nbC5SMTZGO2Nhc2UgNzpyZXR1cm4gdGhpcy5fZ2wuUkcxNkY7Y2FzZSA0OnJldHVybiB0aGlzLl9nbC5SR0IxNkY7Y2FzZSA1OnJldHVybiB0aGlzLl9nbC5SR0JBMTZGO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQkExNkZ9Y2FzZSAxMDpyZXR1cm4gdGhpcy5fZ2wuUkdCNTY1O2Nhc2UgMTM6cmV0dXJuIHRoaXMuX2dsLlIxMUZfRzExRl9CMTBGO2Nhc2UgMTQ6cmV0dXJuIHRoaXMuX2dsLlJHQjlfRTU7Y2FzZSA4OnJldHVybiB0aGlzLl9nbC5SR0JBNDtjYXNlIDk6cmV0dXJuIHRoaXMuX2dsLlJHQjVfQTE7Y2FzZSAxMTpzd2l0Y2godCl7Y2FzZSA1OnJldHVybiB0aGlzLl9nbC5SR0IxMF9BMjtjYXNlIDExOnJldHVybiB0aGlzLl9nbC5SR0IxMF9BMlVJO2RlZmF1bHQ6cmV0dXJuIHRoaXMuX2dsLlJHQjEwX0EyfX1yZXR1cm4gaT90aGlzLl9nbC5TUkdCOF9BTFBIQTg6dGhpcy5fZ2wuUkdCQTh9X2dldFJHQkFNdWx0aVNhbXBsZUJ1ZmZlckZvcm1hdChlKXtyZXR1cm4gZT09PTE/dGhpcy5fZ2wuUkdCQTMyRjplPT09Mj90aGlzLl9nbC5SR0JBMTZGOnRoaXMuX2dsLlJHQkE4fV9sb2FkRmlsZShlLHQsaSxzLHIsbil7Y29uc3QgYT1vZS5fRmlsZVRvb2xzTG9hZEZpbGUoZSx0LGkscyxyLG4pO3JldHVybiB0aGlzLl9hY3RpdmVSZXF1ZXN0cy5wdXNoKGEpLGEub25Db21wbGV0ZU9ic2VydmFibGUuYWRkKG89Pnt0aGlzLl9hY3RpdmVSZXF1ZXN0cy5zcGxpY2UodGhpcy5fYWN0aXZlUmVxdWVzdHMuaW5kZXhPZihvKSwxKX0pLGF9c3RhdGljIF9GaWxlVG9vbHNMb2FkRmlsZShlLHQsaSxzLHIsbil7dGhyb3cgJCgiRmlsZVRvb2xzIil9cmVhZFBpeGVscyhlLHQsaSxzLHI9ITAsbj0hMCl7Y29uc3QgYT1yPzQ6MyxvPXI/dGhpcy5fZ2wuUkdCQTp0aGlzLl9nbC5SR0IsaD1uZXcgVWludDhBcnJheShzKmkqYSk7cmV0dXJuIG4mJnRoaXMuZmx1c2hGcmFtZWJ1ZmZlcigpLHRoaXMuX2dsLnJlYWRQaXhlbHMoZSx0LGkscyxvLHRoaXMuX2dsLlVOU0lHTkVEX0JZVEUsaCksUHJvbWlzZS5yZXNvbHZlKGgpfXN0YXRpYyBnZXQgSXNTdXBwb3J0ZWRBc3luYygpe3JldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5pc1N1cHBvcnRlZCgpKX1zdGF0aWMgZ2V0IElzU3VwcG9ydGVkKCl7cmV0dXJuIHRoaXMuaXNTdXBwb3J0ZWQoKX1zdGF0aWMgaXNTdXBwb3J0ZWQoKXtpZih0aGlzLl9IYXNNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0IT09bnVsbClyZXR1cm4hdGhpcy5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDtpZih0aGlzLl9Jc1N1cHBvcnRlZD09PW51bGwpdHJ5e2NvbnN0IGU9dGhpcy5fQ3JlYXRlQ2FudmFzKDEsMSksdD1lLmdldENvbnRleHQoIndlYmdsIil8fGUuZ2V0Q29udGV4dCgiZXhwZXJpbWVudGFsLXdlYmdsIik7dGhpcy5fSXNTdXBwb3J0ZWQ9dCE9bnVsbCYmISF3aW5kb3cuV2ViR0xSZW5kZXJpbmdDb250ZXh0fWNhdGNoe3RoaXMuX0lzU3VwcG9ydGVkPSExfXJldHVybiB0aGlzLl9Jc1N1cHBvcnRlZH1zdGF0aWMgZ2V0IEhhc01ham9yUGVyZm9ybWFuY2VDYXZlYXQoKXtpZih0aGlzLl9IYXNNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0PT09bnVsbCl0cnl7Y29uc3QgZT10aGlzLl9DcmVhdGVDYW52YXMoMSwxKSx0PWUuZ2V0Q29udGV4dCgid2ViZ2wiLHtmYWlsSWZNYWpvclBlcmZvcm1hbmNlQ2F2ZWF0OiEwfSl8fGUuZ2V0Q29udGV4dCgiZXhwZXJpbWVudGFsLXdlYmdsIix7ZmFpbElmTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDohMH0pO3RoaXMuX0hhc01ham9yUGVyZm9ybWFuY2VDYXZlYXQ9IXR9Y2F0Y2h7dGhpcy5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdD0hMX1yZXR1cm4gdGhpcy5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdH1zdGF0aWMgQ2VpbGluZ1BPVChlKXtyZXR1cm4gZS0tLGV8PWU+PjEsZXw9ZT4+MixlfD1lPj40LGV8PWU+PjgsZXw9ZT4+MTYsZSsrLGV9c3RhdGljIEZsb29yUE9UKGUpe3JldHVybiBlPWV8ZT4+MSxlPWV8ZT4+MixlPWV8ZT4+NCxlPWV8ZT4+OCxlPWV8ZT4+MTYsZS0oZT4+MSl9c3RhdGljIE5lYXJlc3RQT1QoZSl7Y29uc3QgdD1vZS5DZWlsaW5nUE9UKGUpLGk9b2UuRmxvb3JQT1QoZSk7cmV0dXJuIHQtZT5lLWk/aTp0fXN0YXRpYyBHZXRFeHBvbmVudE9mVHdvKGUsdCxpPTIpe2xldCBzO3N3aXRjaChpKXtjYXNlIDE6cz1vZS5GbG9vclBPVChlKTticmVhaztjYXNlIDI6cz1vZS5OZWFyZXN0UE9UKGUpO2JyZWFrO2Nhc2UgMzpkZWZhdWx0OnM9b2UuQ2VpbGluZ1BPVChlKTticmVha31yZXR1cm4gTWF0aC5taW4ocyx0KX1zdGF0aWMgUXVldWVOZXdGcmFtZShlLHQpe2lmKGplKCkpe2NvbnN0e3JlcXVlc3RQb3N0QW5pbWF0aW9uRnJhbWU6aSxyZXF1ZXN0QW5pbWF0aW9uRnJhbWU6c309dHx8d2luZG93O2lmKHR5cGVvZiBpPT0iZnVuY3Rpb24iKXJldHVybiBpKGUpO2lmKHR5cGVvZiBzPT0iZnVuY3Rpb24iKXJldHVybiBzKGUpfWVsc2UgaWYodHlwZW9mIHJlcXVlc3RBbmltYXRpb25GcmFtZT09ImZ1bmN0aW9uIilyZXR1cm4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGUpO3JldHVybiBzZXRUaW1lb3V0KGUsMTYpfWdldEhvc3REb2N1bWVudCgpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdDYW52YXMmJnRoaXMuX3JlbmRlcmluZ0NhbnZhcy5vd25lckRvY3VtZW50P3RoaXMuX3JlbmRlcmluZ0NhbnZhcy5vd25lckRvY3VtZW50OkNpKCk/ZG9jdW1lbnQ6bnVsbH19b2UuRXhjZXB0aW9uTGlzdD1be2tleToiQ2hyb21lLzYzLjAiLGNhcHR1cmU6IjYzXFwuMFxcLjMyMzlcXC4oXFxkKykiLGNhcHR1cmVDb25zdHJhaW50OjEwOCx0YXJnZXRzOlsidW5pZm9ybUJ1ZmZlciJdfSx7a2V5OiJGaXJlZm94LzU4IixjYXB0dXJlOm51bGwsY2FwdHVyZUNvbnN0cmFpbnQ6bnVsbCx0YXJnZXRzOlsidW5pZm9ybUJ1ZmZlciJdfSx7a2V5OiJGaXJlZm94LzU5IixjYXB0dXJlOm51bGwsY2FwdHVyZUNvbnN0cmFpbnQ6bnVsbCx0YXJnZXRzOlsidW5pZm9ybUJ1ZmZlciJdfSx7a2V5OiJDaHJvbWUvNzIuKz9Nb2JpbGUiLGNhcHR1cmU6bnVsbCxjYXB0dXJlQ29uc3RyYWludDpudWxsLHRhcmdldHM6WyJ2YW8iXX0se2tleToiQ2hyb21lLzczLis/TW9iaWxlIixjYXB0dXJlOm51bGwsY2FwdHVyZUNvbnN0cmFpbnQ6bnVsbCx0YXJnZXRzOlsidmFvIl19LHtrZXk6IkNocm9tZS83NC4rP01vYmlsZSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInZhbyJdfSx7a2V5OiJNYWMgT1MuK0Nocm9tZS83MSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInZhbyJdfSx7a2V5OiJNYWMgT1MuK0Nocm9tZS83MiIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInZhbyJdfSx7a2V5OiJNYWMgT1MuK0Nocm9tZSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbInVuaWZvcm1CdWZmZXIiXX0se2tleToiLipBcHBsZVdlYktpdC4qKDE1LjQpLipTYWZhcmkiLGNhcHR1cmU6bnVsbCxjYXB0dXJlQ29uc3RyYWludDpudWxsLHRhcmdldHM6WyJhbnRpYWxpYXMiLCJtYXhNU0FBU2FtcGxlcyJdfSx7a2V5OiIuKigxNS40KS4qQXBwbGVXZWJLaXQuKlNhZmFyaSIsY2FwdHVyZTpudWxsLGNhcHR1cmVDb25zdHJhaW50Om51bGwsdGFyZ2V0czpbImFudGlhbGlhcyIsIm1heE1TQUFTYW1wbGVzIl19XSxvZS5fVGV4dHVyZUxvYWRlcnM9W10sb2UuQ29sbGlzaW9uc0Vwc2lsb249LjAwMSxvZS5fSXNTdXBwb3J0ZWQ9bnVsbCxvZS5fSGFzTWFqb3JQZXJmb3JtYW5jZUNhdmVhdD1udWxsO2NsYXNzIGRue2NvbnN0cnVjdG9yKGU9MzApe3RoaXMuX2VuYWJsZWQ9ITAsdGhpcy5fcm9sbGluZ0ZyYW1lVGltZT1uZXcgZm4oZSl9c2FtcGxlRnJhbWUoZT1haS5Ob3cpe2lmKHRoaXMuX2VuYWJsZWQpe2lmKHRoaXMuX2xhc3RGcmFtZVRpbWVNcyE9bnVsbCl7Y29uc3QgdD1lLXRoaXMuX2xhc3RGcmFtZVRpbWVNczt0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLmFkZCh0KX10aGlzLl9sYXN0RnJhbWVUaW1lTXM9ZX19Z2V0IGF2ZXJhZ2VGcmFtZVRpbWUoKXtyZXR1cm4gdGhpcy5fcm9sbGluZ0ZyYW1lVGltZS5hdmVyYWdlfWdldCBhdmVyYWdlRnJhbWVUaW1lVmFyaWFuY2UoKXtyZXR1cm4gdGhpcy5fcm9sbGluZ0ZyYW1lVGltZS52YXJpYW5jZX1nZXQgaW5zdGFudGFuZW91c0ZyYW1lVGltZSgpe3JldHVybiB0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLmhpc3RvcnkoMCl9Z2V0IGF2ZXJhZ2VGUFMoKXtyZXR1cm4gMWUzL3RoaXMuX3JvbGxpbmdGcmFtZVRpbWUuYXZlcmFnZX1nZXQgaW5zdGFudGFuZW91c0ZQUygpe2NvbnN0IGU9dGhpcy5fcm9sbGluZ0ZyYW1lVGltZS5oaXN0b3J5KDApO3JldHVybiBlPT09MD8wOjFlMy9lfWdldCBpc1NhdHVyYXRlZCgpe3JldHVybiB0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLmlzU2F0dXJhdGVkKCl9ZW5hYmxlKCl7dGhpcy5fZW5hYmxlZD0hMH1kaXNhYmxlKCl7dGhpcy5fZW5hYmxlZD0hMSx0aGlzLl9sYXN0RnJhbWVUaW1lTXM9bnVsbH1nZXQgaXNFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2VuYWJsZWR9cmVzZXQoKXt0aGlzLl9sYXN0RnJhbWVUaW1lTXM9bnVsbCx0aGlzLl9yb2xsaW5nRnJhbWVUaW1lLnJlc2V0KCl9fWNsYXNzIGZue2NvbnN0cnVjdG9yKGUpe3RoaXMuX3NhbXBsZXM9bmV3IEFycmF5KGUpLHRoaXMucmVzZXQoKX1hZGQoZSl7bGV0IHQ7aWYodGhpcy5pc1NhdHVyYXRlZCgpKXtjb25zdCBpPXRoaXMuX3NhbXBsZXNbdGhpcy5fcG9zXTt0PWktdGhpcy5hdmVyYWdlLHRoaXMuYXZlcmFnZS09dC8odGhpcy5fc2FtcGxlQ291bnQtMSksdGhpcy5fbTItPXQqKGktdGhpcy5hdmVyYWdlKX1lbHNlIHRoaXMuX3NhbXBsZUNvdW50Kys7dD1lLXRoaXMuYXZlcmFnZSx0aGlzLmF2ZXJhZ2UrPXQvdGhpcy5fc2FtcGxlQ291bnQsdGhpcy5fbTIrPXQqKGUtdGhpcy5hdmVyYWdlKSx0aGlzLnZhcmlhbmNlPXRoaXMuX20yLyh0aGlzLl9zYW1wbGVDb3VudC0xKSx0aGlzLl9zYW1wbGVzW3RoaXMuX3Bvc109ZSx0aGlzLl9wb3MrKyx0aGlzLl9wb3MlPXRoaXMuX3NhbXBsZXMubGVuZ3RofWhpc3RvcnkoZSl7aWYoZT49dGhpcy5fc2FtcGxlQ291bnR8fGU+PXRoaXMuX3NhbXBsZXMubGVuZ3RoKXJldHVybiAwO2NvbnN0IHQ9dGhpcy5fd3JhcFBvc2l0aW9uKHRoaXMuX3Bvcy0xKTtyZXR1cm4gdGhpcy5fc2FtcGxlc1t0aGlzLl93cmFwUG9zaXRpb24odC1lKV19aXNTYXR1cmF0ZWQoKXtyZXR1cm4gdGhpcy5fc2FtcGxlQ291bnQ+PXRoaXMuX3NhbXBsZXMubGVuZ3RofXJlc2V0KCl7dGhpcy5hdmVyYWdlPTAsdGhpcy52YXJpYW5jZT0wLHRoaXMuX3NhbXBsZUNvdW50PTAsdGhpcy5fcG9zPTAsdGhpcy5fbTI9MH1fd3JhcFBvc2l0aW9uKGUpe2NvbnN0IHQ9dGhpcy5fc2FtcGxlcy5sZW5ndGg7cmV0dXJuKGUldCt0KSV0fX1jbGFzcyBSdHtjb25zdHJ1Y3Rvcigpe3RoaXMuX3N0YXJ0TW9uaXRvcmluZ1RpbWU9MCx0aGlzLl9taW49MCx0aGlzLl9tYXg9MCx0aGlzLl9hdmVyYWdlPTAsdGhpcy5fbGFzdFNlY0F2ZXJhZ2U9MCx0aGlzLl9jdXJyZW50PTAsdGhpcy5fdG90YWxWYWx1ZUNvdW50PTAsdGhpcy5fdG90YWxBY2N1bXVsYXRlZD0wLHRoaXMuX2xhc3RTZWNBY2N1bXVsYXRlZD0wLHRoaXMuX2xhc3RTZWNUaW1lPTAsdGhpcy5fbGFzdFNlY1ZhbHVlQ291bnQ9MH1nZXQgbWluKCl7cmV0dXJuIHRoaXMuX21pbn1nZXQgbWF4KCl7cmV0dXJuIHRoaXMuX21heH1nZXQgYXZlcmFnZSgpe3JldHVybiB0aGlzLl9hdmVyYWdlfWdldCBsYXN0U2VjQXZlcmFnZSgpe3JldHVybiB0aGlzLl9sYXN0U2VjQXZlcmFnZX1nZXQgY3VycmVudCgpe3JldHVybiB0aGlzLl9jdXJyZW50fWdldCB0b3RhbCgpe3JldHVybiB0aGlzLl90b3RhbEFjY3VtdWxhdGVkfWdldCBjb3VudCgpe3JldHVybiB0aGlzLl90b3RhbFZhbHVlQ291bnR9ZmV0Y2hOZXdGcmFtZSgpe3RoaXMuX3RvdGFsVmFsdWVDb3VudCsrLHRoaXMuX2N1cnJlbnQ9MCx0aGlzLl9sYXN0U2VjVmFsdWVDb3VudCsrfWFkZENvdW50KGUsdCl7UnQuRW5hYmxlZCYmKHRoaXMuX2N1cnJlbnQrPWUsdCYmdGhpcy5fZmV0Y2hSZXN1bHQoKSl9YmVnaW5Nb25pdG9yaW5nKCl7UnQuRW5hYmxlZCYmKHRoaXMuX3N0YXJ0TW9uaXRvcmluZ1RpbWU9YWkuTm93KX1lbmRNb25pdG9yaW5nKGU9ITApe2lmKCFSdC5FbmFibGVkKXJldHVybjtlJiZ0aGlzLmZldGNoTmV3RnJhbWUoKTtjb25zdCB0PWFpLk5vdzt0aGlzLl9jdXJyZW50PXQtdGhpcy5fc3RhcnRNb25pdG9yaW5nVGltZSxlJiZ0aGlzLl9mZXRjaFJlc3VsdCgpfV9mZXRjaFJlc3VsdCgpe3RoaXMuX3RvdGFsQWNjdW11bGF0ZWQrPXRoaXMuX2N1cnJlbnQsdGhpcy5fbGFzdFNlY0FjY3VtdWxhdGVkKz10aGlzLl9jdXJyZW50LHRoaXMuX21pbj1NYXRoLm1pbih0aGlzLl9taW4sdGhpcy5fY3VycmVudCksdGhpcy5fbWF4PU1hdGgubWF4KHRoaXMuX21heCx0aGlzLl9jdXJyZW50KSx0aGlzLl9hdmVyYWdlPXRoaXMuX3RvdGFsQWNjdW11bGF0ZWQvdGhpcy5fdG90YWxWYWx1ZUNvdW50O2NvbnN0IGU9YWkuTm93O2UtdGhpcy5fbGFzdFNlY1RpbWU+MWUzJiYodGhpcy5fbGFzdFNlY0F2ZXJhZ2U9dGhpcy5fbGFzdFNlY0FjY3VtdWxhdGVkL3RoaXMuX2xhc3RTZWNWYWx1ZUNvdW50LHRoaXMuX2xhc3RTZWNUaW1lPWUsdGhpcy5fbGFzdFNlY0FjY3VtdWxhdGVkPTAsdGhpcy5fbGFzdFNlY1ZhbHVlQ291bnQ9MCl9fVJ0LkVuYWJsZWQ9ITAsb2UucHJvdG90eXBlLnNldEFscGhhQ29uc3RhbnRzPWZ1bmN0aW9uKGMsZSx0LGkpe3RoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZENvbnN0YW50cyhjLGUsdCxpKX0sb2UucHJvdG90eXBlLnNldEFscGhhTW9kZT1mdW5jdGlvbihjLGU9ITEpe2lmKHRoaXMuX2FscGhhTW9kZSE9PWMpe3N3aXRjaChjKXtjYXNlIDA6dGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSExO2JyZWFrO2Nhc2UgNzp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2UgODp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDI6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlNSQ19BTFBIQSx0aGlzLl9nbC5PTkVfTUlOVVNfU1JDX0FMUEhBLHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDY6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlNSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDM6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLlpFUk8sdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSA0OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5EU1RfQ09MT1IsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSA1OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5TUkNfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSA5OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5DT05TVEFOVF9DT0xPUix0aGlzLl9nbC5PTkVfTUlOVVNfQ09OU1RBTlRfQ09MT1IsdGhpcy5fZ2wuQ09OU1RBTlRfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX0NPTlNUQU5UX0FMUEhBKSx0aGlzLl9hbHBoYVN0YXRlLmFscGhhQmxlbmQ9ITA7YnJlYWs7Y2FzZSAxMDp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhQmxlbmRGdW5jdGlvblBhcmFtZXRlcnModGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQ09MT1IsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDExOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDEyOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5EU1RfQUxQSEEsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLlpFUk8sdGhpcy5fZ2wuWkVSTyksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2UgMTM6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLk9ORV9NSU5VU19EU1RfQ09MT1IsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19DT0xPUix0aGlzLl9nbC5PTkVfTUlOVVNfRFNUX0FMUEhBLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQUxQSEEpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE0OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrO2Nhc2UgMTU6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUJsZW5kRnVuY3Rpb25QYXJhbWV0ZXJzKHRoaXMuX2dsLk9ORSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FLHRoaXMuX2dsLlpFUk8pLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE2OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5PTkVfTUlOVVNfRFNUX0NPTE9SLHRoaXMuX2dsLk9ORV9NSU5VU19TUkNfQ09MT1IsdGhpcy5fZ2wuWkVSTyx0aGlzLl9nbC5PTkUpLHRoaXMuX2FscGhhU3RhdGUuYWxwaGFCbGVuZD0hMDticmVhaztjYXNlIDE3OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFCbGVuZEZ1bmN0aW9uUGFyYW1ldGVycyh0aGlzLl9nbC5TUkNfQUxQSEEsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSx0aGlzLl9nbC5PTkUsdGhpcy5fZ2wuT05FX01JTlVTX1NSQ19BTFBIQSksdGhpcy5fYWxwaGFTdGF0ZS5hbHBoYUJsZW5kPSEwO2JyZWFrfWV8fCh0aGlzLmRlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFzaz1jPT09MCksdGhpcy5fYWxwaGFNb2RlPWN9fSxvZS5wcm90b3R5cGUuZ2V0QWxwaGFNb2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FscGhhTW9kZX0sb2UucHJvdG90eXBlLnNldEFscGhhRXF1YXRpb249ZnVuY3Rpb24oYyl7aWYodGhpcy5fYWxwaGFFcXVhdGlvbiE9PWMpe3N3aXRjaChjKXtjYXNlIDA6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUVxdWF0aW9uUGFyYW1ldGVycygzMjc3NCwzMjc3NCk7YnJlYWs7Y2FzZSAxOnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFFcXVhdGlvblBhcmFtZXRlcnMoMzI3NzgsMzI3NzgpO2JyZWFrO2Nhc2UgMjp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhRXF1YXRpb25QYXJhbWV0ZXJzKDMyNzc5LDMyNzc5KTticmVhaztjYXNlIDM6dGhpcy5fYWxwaGFTdGF0ZS5zZXRBbHBoYUVxdWF0aW9uUGFyYW1ldGVycygzMjc3NiwzMjc3Nik7YnJlYWs7Y2FzZSA0OnRoaXMuX2FscGhhU3RhdGUuc2V0QWxwaGFFcXVhdGlvblBhcmFtZXRlcnMoMzI3NzUsMzI3NzUpO2JyZWFrO2Nhc2UgNTp0aGlzLl9hbHBoYVN0YXRlLnNldEFscGhhRXF1YXRpb25QYXJhbWV0ZXJzKDMyNzc1LDMyNzc0KTticmVha310aGlzLl9hbHBoYUVxdWF0aW9uPWN9fSxvZS5wcm90b3R5cGUuZ2V0QWxwaGFFcXVhdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbHBoYUVxdWF0aW9ufTtmdW5jdGlvbiBfbihjLGUsdD0hMSxpKXtzd2l0Y2goYyl7Y2FzZSAzOntjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgSW50OEFycmF5KGUpOm5ldyBJbnQ4QXJyYXkoZSk7cmV0dXJuIGkmJnIuc2V0KG5ldyBJbnQ4QXJyYXkoaSkpLHJ9Y2FzZSAwOntjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgVWludDhBcnJheShlKTpuZXcgVWludDhBcnJheShlKTtyZXR1cm4gaSYmci5zZXQobmV3IFVpbnQ4QXJyYXkoaSkpLHJ9Y2FzZSA0Ontjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgSW50MTZBcnJheShlKTpuZXcgSW50MTZBcnJheSh0P2UvMjplKTtyZXR1cm4gaSYmci5zZXQobmV3IEludDE2QXJyYXkoaSkpLHJ9Y2FzZSA1OmNhc2UgODpjYXNlIDk6Y2FzZSAxMDpjYXNlIDI6e2NvbnN0IHI9ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP25ldyBVaW50MTZBcnJheShlKTpuZXcgVWludDE2QXJyYXkodD9lLzI6ZSk7cmV0dXJuIGkmJnIuc2V0KG5ldyBVaW50MTZBcnJheShpKSkscn1jYXNlIDY6e2NvbnN0IHI9ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP25ldyBJbnQzMkFycmF5KGUpOm5ldyBJbnQzMkFycmF5KHQ/ZS80OmUpO3JldHVybiBpJiZyLnNldChuZXcgSW50MzJBcnJheShpKSkscn1jYXNlIDc6Y2FzZSAxMTpjYXNlIDEyOmNhc2UgMTM6Y2FzZSAxNDpjYXNlIDE1Ontjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgVWludDMyQXJyYXkoZSk6bmV3IFVpbnQzMkFycmF5KHQ/ZS80OmUpO3JldHVybiBpJiZyLnNldChuZXcgVWludDMyQXJyYXkoaSkpLHJ9Y2FzZSAxOntjb25zdCByPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgRmxvYXQzMkFycmF5KGUpOm5ldyBGbG9hdDMyQXJyYXkodD9lLzQ6ZSk7cmV0dXJuIGkmJnIuc2V0KG5ldyBGbG9hdDMyQXJyYXkoaSkpLHJ9fWNvbnN0IHM9ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP25ldyBVaW50OEFycmF5KGUpOm5ldyBVaW50OEFycmF5KGUpO3JldHVybiBpJiZzLnNldChuZXcgVWludDhBcnJheShpKSksc31vZS5wcm90b3R5cGUuX3JlYWRUZXh0dXJlUGl4ZWxzU3luYz1mdW5jdGlvbihjLGUsdCxpPS0xLHM9MCxyPW51bGwsbj0hMCxhPSExLG89MCxoPTApe3ZhciBsLHU7Y29uc3QgZD10aGlzLl9nbDtpZighZCl0aHJvdyBuZXcgRXJyb3IoIkVuZ2luZSBkb2VzIG5vdCBoYXZlIGdsIHJlbmRlcmluZyBjb250ZXh0LiIpO2lmKCF0aGlzLl9kdW1teUZyYW1lYnVmZmVyKXtjb25zdCBfPWQuY3JlYXRlRnJhbWVidWZmZXIoKTtpZighXyl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgZHVtbXkgZnJhbWVidWZmZXIiKTt0aGlzLl9kdW1teUZyYW1lYnVmZmVyPV99ZC5iaW5kRnJhbWVidWZmZXIoZC5GUkFNRUJVRkZFUix0aGlzLl9kdW1teUZyYW1lYnVmZmVyKSxpPi0xP2QuZnJhbWVidWZmZXJUZXh0dXJlMkQoZC5GUkFNRUJVRkZFUixkLkNPTE9SX0FUVEFDSE1FTlQwLGQuVEVYVFVSRV9DVUJFX01BUF9QT1NJVElWRV9YK2ksKGw9Yy5faGFyZHdhcmVUZXh0dXJlKT09PW51bGx8fGw9PT12b2lkIDA/dm9pZCAwOmwudW5kZXJseWluZ1Jlc291cmNlLHMpOmQuZnJhbWVidWZmZXJUZXh0dXJlMkQoZC5GUkFNRUJVRkZFUixkLkNPTE9SX0FUVEFDSE1FTlQwLGQuVEVYVFVSRV8yRCwodT1jLl9oYXJkd2FyZVRleHR1cmUpPT09bnVsbHx8dT09PXZvaWQgMD92b2lkIDA6dS51bmRlcmx5aW5nUmVzb3VyY2Uscyk7bGV0IGY9Yy50eXBlIT09dm9pZCAwP3RoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoYy50eXBlKTpkLlVOU0lHTkVEX0JZVEU7aWYoYSlyfHwocj1fbihjLnR5cGUsNCplKnQpKTtlbHNlIHN3aXRjaChmKXtjYXNlIGQuVU5TSUdORURfQllURTpyfHwocj1uZXcgVWludDhBcnJheSg0KmUqdCkpLGY9ZC5VTlNJR05FRF9CWVRFO2JyZWFrO2RlZmF1bHQ6cnx8KHI9bmV3IEZsb2F0MzJBcnJheSg0KmUqdCkpLGY9ZC5GTE9BVDticmVha31yZXR1cm4gbiYmdGhpcy5mbHVzaEZyYW1lYnVmZmVyKCksZC5yZWFkUGl4ZWxzKG8saCxlLHQsZC5SR0JBLGYsciksZC5iaW5kRnJhbWVidWZmZXIoZC5GUkFNRUJVRkZFUix0aGlzLl9jdXJyZW50RnJhbWVidWZmZXIpLHJ9LG9lLnByb3RvdHlwZS5fcmVhZFRleHR1cmVQaXhlbHM9ZnVuY3Rpb24oYyxlLHQsaT0tMSxzPTAscj1udWxsLG49ITAsYT0hMSxvPTAsaD0wKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX3JlYWRUZXh0dXJlUGl4ZWxzU3luYyhjLGUsdCxpLHMscixuLGEsbyxoKSl9LG9lLnByb3RvdHlwZS51cGRhdGVEeW5hbWljSW5kZXhCdWZmZXI9ZnVuY3Rpb24oYyxlLHQ9MCl7dGhpcy5fY3VycmVudEJvdW5kQnVmZmVyW3RoaXMuX2dsLkVMRU1FTlRfQVJSQVlfQlVGRkVSXT1udWxsLHRoaXMuYmluZEluZGV4QnVmZmVyKGMpO2xldCBpO2MuaXMzMkJpdHM/aT1lIGluc3RhbmNlb2YgVWludDMyQXJyYXk/ZTpuZXcgVWludDMyQXJyYXkoZSk6aT1lIGluc3RhbmNlb2YgVWludDE2QXJyYXk/ZTpuZXcgVWludDE2QXJyYXkoZSksdGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5FTEVNRU5UX0FSUkFZX0JVRkZFUixpLHRoaXMuX2dsLkRZTkFNSUNfRFJBVyksdGhpcy5fcmVzZXRJbmRleEJ1ZmZlckJpbmRpbmcoKX0sb2UucHJvdG90eXBlLnVwZGF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXI9ZnVuY3Rpb24oYyxlLHQsaSl7dGhpcy5iaW5kQXJyYXlCdWZmZXIoYyksdD09PXZvaWQgMCYmKHQ9MCk7Y29uc3Qgcz1lLmJ5dGVMZW5ndGh8fGUubGVuZ3RoO2k9PT12b2lkIDB8fGk+PXMmJnQ9PT0wP2UgaW5zdGFuY2VvZiBBcnJheT90aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUix0LG5ldyBGbG9hdDMyQXJyYXkoZSkpOnRoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLHQsZSk6ZSBpbnN0YW5jZW9mIEFycmF5P3RoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLDAsbmV3IEZsb2F0MzJBcnJheShlKS5zdWJhcnJheSh0LHQraSkpOihlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/ZT1uZXcgVWludDhBcnJheShlLHQsaSk6ZT1uZXcgVWludDhBcnJheShlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQrdCxpKSx0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLkFSUkFZX0JVRkZFUiwwLGUpKSx0aGlzLl9yZXNldFZlcnRleEJ1ZmZlckJpbmRpbmcoKX07Y2xhc3MgSSBleHRlbmRzIG9le2NvbnN0cnVjdG9yKGUsdCxpLHM9ITEpe2lmKHN1cGVyKGUsdCxpLHMpLHRoaXMuZW5hYmxlT2ZmbGluZVN1cHBvcnQ9ITEsdGhpcy5kaXNhYmxlTWFuaWZlc3RDaGVjaz0hMSx0aGlzLmRpc2FibGVDb250ZXh0TWVudT0hMCx0aGlzLnNjZW5lcz1uZXcgQXJyYXksdGhpcy5fdmlydHVhbFNjZW5lcz1uZXcgQXJyYXksdGhpcy5vbk5ld1NjZW5lQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMucG9zdFByb2Nlc3Nlcz1uZXcgQXJyYXksdGhpcy5pc1BvaW50ZXJMb2NrPSExLHRoaXMub25SZXNpemVPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25DYW52YXNCbHVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQ2FudmFzRm9jdXNPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25DYW52YXNQb2ludGVyT3V0T2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQmVnaW5GcmFtZU9ic2VydmFibGU9bmV3IEYsdGhpcy5jdXN0b21BbmltYXRpb25GcmFtZVJlcXVlc3Rlcj1udWxsLHRoaXMub25FbmRGcmFtZU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVNoYWRlckNvbXBpbGF0aW9uT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJTaGFkZXJDb21waWxhdGlvbk9ic2VydmFibGU9bmV3IEYsdGhpcy5fZGV0ZXJtaW5pc3RpY0xvY2tzdGVwPSExLHRoaXMuX2xvY2tzdGVwTWF4U3RlcHM9NCx0aGlzLl90aW1lU3RlcD0xLzYwLHRoaXMuX2Zwcz02MCx0aGlzLl9kZWx0YVRpbWU9MCx0aGlzLl9kcmF3Q2FsbHM9bmV3IFJ0LHRoaXMuY2FudmFzVGFiSW5kZXg9MSx0aGlzLmRpc2FibGVQZXJmb3JtYW5jZU1vbml0b3JJbkJhY2tncm91bmQ9ITEsdGhpcy5fcGVyZm9ybWFuY2VNb25pdG9yPW5ldyBkbix0aGlzLl9jb21wYXRpYmlsaXR5TW9kZT0hMCx0aGlzLmN1cnJlbnRSZW5kZXJQYXNzSWQ9MCx0aGlzLl9yZW5kZXJQYXNzTmFtZXM9WyJtYWluIl0sSS5JbnN0YW5jZXMucHVzaCh0aGlzKSwhIWUpe2lmKHRoaXMuX2ZlYXR1cmVzLnN1cHBvcnRSZW5kZXJQYXNzZXM9ITAsaT10aGlzLl9jcmVhdGlvbk9wdGlvbnMsZS5nZXRDb250ZXh0KXtjb25zdCByPWU7dGhpcy5fc2hhcmVkSW5pdChyLCEhaS5kb05vdEhhbmRsZVRvdWNoQWN0aW9uLGkuYXVkaW9FbmdpbmUpLENpKCkmJih0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2U9KCk9Pnt0aGlzLmlzRnVsbHNjcmVlbj0hIWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50LHRoaXMuaXNGdWxsc2NyZWVuJiZ0aGlzLl9wb2ludGVyTG9ja1JlcXVlc3RlZCYmciYmSS5fUmVxdWVzdFBvaW50ZXJsb2NrKHIpfSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJmdWxsc2NyZWVuY2hhbmdlIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UiLHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwhMSksdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZT0oKT0+e3RoaXMuaXNQb2ludGVyTG9jaz1kb2N1bWVudC5wb2ludGVyTG9ja0VsZW1lbnQ9PT1yfSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybG9ja2NoYW5nZSIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigid2Via2l0cG9pbnRlcmxvY2tjaGFuZ2UiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UsITEpLCFJLmF1ZGlvRW5naW5lJiZpLmF1ZGlvRW5naW5lJiZJLkF1ZGlvRW5naW5lRmFjdG9yeSYmKEkuYXVkaW9FbmdpbmU9SS5BdWRpb0VuZ2luZUZhY3RvcnkodGhpcy5nZXRSZW5kZXJpbmdDYW52YXMoKSx0aGlzLmdldEF1ZGlvQ29udGV4dCgpLHRoaXMuZ2V0QXVkaW9EZXN0aW5hdGlvbigpKSkpLHRoaXMuX2Nvbm5lY3RWUkV2ZW50cygpLHRoaXMuZW5hYmxlT2ZmbGluZVN1cHBvcnQ9SS5PZmZsaW5lUHJvdmlkZXJGYWN0b3J5IT09dm9pZCAwLHRoaXMuX2RldGVybWluaXN0aWNMb2Nrc3RlcD0hIWkuZGV0ZXJtaW5pc3RpY0xvY2tzdGVwLHRoaXMuX2xvY2tzdGVwTWF4U3RlcHM9aS5sb2Nrc3RlcE1heFN0ZXBzfHwwLHRoaXMuX3RpbWVTdGVwPWkudGltZVN0ZXB8fDEvNjB9dGhpcy5fcHJlcGFyZVZSQ29tcG9uZW50KCksaS5hdXRvRW5hYmxlV2ViVlImJnRoaXMuaW5pdFdlYlZSKCl9fXN0YXRpYyBnZXQgTnBtUGFja2FnZSgpe3JldHVybiBvZS5OcG1QYWNrYWdlfXN0YXRpYyBnZXQgVmVyc2lvbigpe3JldHVybiBvZS5WZXJzaW9ufXN0YXRpYyBnZXQgSW5zdGFuY2VzKCl7cmV0dXJuIGZlLkluc3RhbmNlc31zdGF0aWMgZ2V0IExhc3RDcmVhdGVkRW5naW5lKCl7cmV0dXJuIGZlLkxhc3RDcmVhdGVkRW5naW5lfXN0YXRpYyBnZXQgTGFzdENyZWF0ZWRTY2VuZSgpe3JldHVybiBmZS5MYXN0Q3JlYXRlZFNjZW5lfV9jcmVhdGVJbWFnZUJpdG1hcEZyb21Tb3VyY2UoZSx0KXtyZXR1cm4gbmV3IFByb21pc2UoKHMscik9Pntjb25zdCBuPW5ldyBJbWFnZTtuLm9ubG9hZD0oKT0+e24uZGVjb2RlKCkudGhlbigoKT0+e3RoaXMuY3JlYXRlSW1hZ2VCaXRtYXAobix0KS50aGVuKGE9PntzKGEpfSl9KX0sbi5vbmVycm9yPSgpPT57cihgRXJyb3IgbG9hZGluZyBpbWFnZSAke24uc3JjfWApfSxuLnNyYz1lfSl9Y3JlYXRlSW1hZ2VCaXRtYXAoZSx0KXtyZXR1cm4gY3JlYXRlSW1hZ2VCaXRtYXAoZSx0KX1yZXNpemVJbWFnZUJpdG1hcChlLHQsaSl7Y29uc3Qgcj10aGlzLmNyZWF0ZUNhbnZhcyh0LGkpLmdldENvbnRleHQoIjJkIik7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gZ2V0IDJkIGNvbnRleHQgZm9yIHJlc2l6ZUltYWdlQml0bWFwIik7cmV0dXJuIHIuZHJhd0ltYWdlKGUsMCwwKSxyLmdldEltYWdlRGF0YSgwLDAsdCxpKS5kYXRhfXN0YXRpYyBNYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eShlLHQpe2ZvcihsZXQgaT0wO2k8SS5JbnN0YW5jZXMubGVuZ3RoO2krKyl7Y29uc3Qgcz1JLkluc3RhbmNlc1tpXTtmb3IobGV0IHI9MDtyPHMuc2NlbmVzLmxlbmd0aDtyKyspcy5zY2VuZXNbcl0ubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoZSx0KX19c3RhdGljIERlZmF1bHRMb2FkaW5nU2NyZWVuRmFjdG9yeShlKXt0aHJvdyAkKCJMb2FkaW5nU2NyZWVuIil9Z2V0IF9zdXBwb3J0c0hhcmR3YXJlVGV4dHVyZVJlc2NhbGluZygpe3JldHVybiEhSS5fUmVzY2FsZVBvc3RQcm9jZXNzRmFjdG9yeX1nZXQgcGVyZm9ybWFuY2VNb25pdG9yKCl7cmV0dXJuIHRoaXMuX3BlcmZvcm1hbmNlTW9uaXRvcn1nZXQgY29tcGF0aWJpbGl0eU1vZGUoKXtyZXR1cm4gdGhpcy5fY29tcGF0aWJpbGl0eU1vZGV9c2V0IGNvbXBhdGliaWxpdHlNb2RlKGUpe3RoaXMuX2NvbXBhdGliaWxpdHlNb2RlPSEwfWdldElucHV0RWxlbWVudCgpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdDYW52YXN9X2luaXRHTENvbnRleHQoKXtzdXBlci5faW5pdEdMQ29udGV4dCgpLHRoaXMuX3Jlc2NhbGVQb3N0UHJvY2Vzcz1udWxsfV9zaGFyZWRJbml0KGUsdCxpKXtzdXBlci5fc2hhcmVkSW5pdChlLHQsaSksdGhpcy5fb25DYW52YXNGb2N1cz0oKT0+e3RoaXMub25DYW52YXNGb2N1c09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfSx0aGlzLl9vbkNhbnZhc0JsdXI9KCk9Pnt0aGlzLm9uQ2FudmFzQmx1ck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfSx0aGlzLl9vbkNhbnZhc0NvbnRleHRNZW51PXI9Pnt0aGlzLmRpc2FibGVDb250ZXh0TWVudSYmci5wcmV2ZW50RGVmYXVsdCgpfSxlLmFkZEV2ZW50TGlzdGVuZXIoImZvY3VzIix0aGlzLl9vbkNhbnZhc0ZvY3VzKSxlLmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLHRoaXMuX29uQ2FudmFzQmx1ciksZS5hZGRFdmVudExpc3RlbmVyKCJjb250ZXh0bWVudSIsdGhpcy5fb25DYW52YXNDb250ZXh0TWVudSksdGhpcy5fb25CbHVyPSgpPT57dGhpcy5kaXNhYmxlUGVyZm9ybWFuY2VNb25pdG9ySW5CYWNrZ3JvdW5kJiZ0aGlzLl9wZXJmb3JtYW5jZU1vbml0b3IuZGlzYWJsZSgpLHRoaXMuX3dpbmRvd0lzQmFja2dyb3VuZD0hMH0sdGhpcy5fb25Gb2N1cz0oKT0+e3RoaXMuZGlzYWJsZVBlcmZvcm1hbmNlTW9uaXRvckluQmFja2dyb3VuZCYmdGhpcy5fcGVyZm9ybWFuY2VNb25pdG9yLmVuYWJsZSgpLHRoaXMuX3dpbmRvd0lzQmFja2dyb3VuZD0hMX0sdGhpcy5fb25DYW52YXNQb2ludGVyT3V0PXI9Pntkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHIuY2xpZW50WCxyLmNsaWVudFkpIT09ZSYmdGhpcy5vbkNhbnZhc1BvaW50ZXJPdXRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKX07Y29uc3Qgcz10aGlzLmdldEhvc3RXaW5kb3coKTtzJiZ0eXBlb2Ygcy5hZGRFdmVudExpc3RlbmVyPT0iZnVuY3Rpb24iJiYocy5hZGRFdmVudExpc3RlbmVyKCJibHVyIix0aGlzLl9vbkJsdXIpLHMuYWRkRXZlbnRMaXN0ZW5lcigiZm9jdXMiLHRoaXMuX29uRm9jdXMpKSxlLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJvdXQiLHRoaXMuX29uQ2FudmFzUG9pbnRlck91dCksdHx8dGhpcy5fZGlzYWJsZVRvdWNoQWN0aW9uKCksIUkuYXVkaW9FbmdpbmUmJmkmJkkuQXVkaW9FbmdpbmVGYWN0b3J5JiYoSS5hdWRpb0VuZ2luZT1JLkF1ZGlvRW5naW5lRmFjdG9yeSh0aGlzLmdldFJlbmRlcmluZ0NhbnZhcygpLHRoaXMuZ2V0QXVkaW9Db250ZXh0KCksdGhpcy5nZXRBdWRpb0Rlc3RpbmF0aW9uKCkpKX1nZXRBc3BlY3RSYXRpbyhlLHQ9ITEpe2NvbnN0IGk9ZS52aWV3cG9ydDtyZXR1cm4gdGhpcy5nZXRSZW5kZXJXaWR0aCh0KSppLndpZHRoLyh0aGlzLmdldFJlbmRlckhlaWdodCh0KSppLmhlaWdodCl9Z2V0U2NyZWVuQXNwZWN0UmF0aW8oKXtyZXR1cm4gdGhpcy5nZXRSZW5kZXJXaWR0aCghMCkvdGhpcy5nZXRSZW5kZXJIZWlnaHQoITApfWdldFJlbmRlcmluZ0NhbnZhc0NsaWVudFJlY3QoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzP3RoaXMuX3JlbmRlcmluZ0NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTpudWxsfWdldElucHV0RWxlbWVudENsaWVudFJlY3QoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nQ2FudmFzP3RoaXMuZ2V0SW5wdXRFbGVtZW50KCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk6bnVsbH1pc0RldGVybWluaXN0aWNMb2NrU3RlcCgpe3JldHVybiB0aGlzLl9kZXRlcm1pbmlzdGljTG9ja3N0ZXB9Z2V0TG9ja3N0ZXBNYXhTdGVwcygpe3JldHVybiB0aGlzLl9sb2Nrc3RlcE1heFN0ZXBzfWdldFRpbWVTdGVwKCl7cmV0dXJuIHRoaXMuX3RpbWVTdGVwKjFlM31nZW5lcmF0ZU1pcE1hcHNGb3JDdWJlbWFwKGUsdD0hMCl7aWYoZS5nZW5lcmF0ZU1pcE1hcHMpe2NvbnN0IGk9dGhpcy5fZ2w7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShpLlRFWFRVUkVfQ1VCRV9NQVAsZSwhMCksaS5nZW5lcmF0ZU1pcG1hcChpLlRFWFRVUkVfQ1VCRV9NQVApLHQmJnRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoaS5URVhUVVJFX0NVQkVfTUFQLG51bGwpfX1nZXREZXB0aFdyaXRlKCl7cmV0dXJuIHRoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFza31zZXREZXB0aFdyaXRlKGUpe3RoaXMuX2RlcHRoQ3VsbGluZ1N0YXRlLmRlcHRoTWFzaz1lfWdldFN0ZW5jaWxCdWZmZXIoKXtyZXR1cm4gdGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxUZXN0fXNldFN0ZW5jaWxCdWZmZXIoZSl7dGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxUZXN0PWV9Z2V0U3RlbmNpbE1hc2soKXtyZXR1cm4gdGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxNYXNrfXNldFN0ZW5jaWxNYXNrKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsTWFzaz1lfWdldFN0ZW5jaWxGdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbEZ1bmN9Z2V0U3RlbmNpbEZ1bmN0aW9uUmVmZXJlbmNlKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuY1JlZn1nZXRTdGVuY2lsRnVuY3Rpb25NYXNrKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuY01hc2t9c2V0U3RlbmNpbEZ1bmN0aW9uKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuYz1lfXNldFN0ZW5jaWxGdW5jdGlvblJlZmVyZW5jZShlKXt0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbEZ1bmNSZWY9ZX1zZXRTdGVuY2lsRnVuY3Rpb25NYXNrKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsRnVuY01hc2s9ZX1nZXRTdGVuY2lsT3BlcmF0aW9uRmFpbCgpe3JldHVybiB0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbE9wU3RlbmNpbEZhaWx9Z2V0U3RlbmNpbE9wZXJhdGlvbkRlcHRoRmFpbCgpe3JldHVybiB0aGlzLl9zdGVuY2lsU3RhdGUuc3RlbmNpbE9wRGVwdGhGYWlsfWdldFN0ZW5jaWxPcGVyYXRpb25QYXNzKCl7cmV0dXJuIHRoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsT3BTdGVuY2lsRGVwdGhQYXNzfXNldFN0ZW5jaWxPcGVyYXRpb25GYWlsKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsT3BTdGVuY2lsRmFpbD1lfXNldFN0ZW5jaWxPcGVyYXRpb25EZXB0aEZhaWwoZSl7dGhpcy5fc3RlbmNpbFN0YXRlLnN0ZW5jaWxPcERlcHRoRmFpbD1lfXNldFN0ZW5jaWxPcGVyYXRpb25QYXNzKGUpe3RoaXMuX3N0ZW5jaWxTdGF0ZS5zdGVuY2lsT3BTdGVuY2lsRGVwdGhQYXNzPWV9c2V0RGl0aGVyaW5nU3RhdGUoZSl7ZT90aGlzLl9nbC5lbmFibGUodGhpcy5fZ2wuRElUSEVSKTp0aGlzLl9nbC5kaXNhYmxlKHRoaXMuX2dsLkRJVEhFUil9c2V0UmFzdGVyaXplclN0YXRlKGUpe2U/dGhpcy5fZ2wuZGlzYWJsZSh0aGlzLl9nbC5SQVNURVJJWkVSX0RJU0NBUkQpOnRoaXMuX2dsLmVuYWJsZSh0aGlzLl9nbC5SQVNURVJJWkVSX0RJU0NBUkQpfWdldERlcHRoRnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jfXNldERlcHRoRnVuY3Rpb24oZSl7dGhpcy5fZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhGdW5jPWV9c2V0RGVwdGhGdW5jdGlvblRvR3JlYXRlcigpe3RoaXMuc2V0RGVwdGhGdW5jdGlvbig1MTYpfXNldERlcHRoRnVuY3Rpb25Ub0dyZWF0ZXJPckVxdWFsKCl7dGhpcy5zZXREZXB0aEZ1bmN0aW9uKDUxOCl9c2V0RGVwdGhGdW5jdGlvblRvTGVzcygpe3RoaXMuc2V0RGVwdGhGdW5jdGlvbig1MTMpfXNldERlcHRoRnVuY3Rpb25Ub0xlc3NPckVxdWFsKCl7dGhpcy5zZXREZXB0aEZ1bmN0aW9uKDUxNSl9Y2FjaGVTdGVuY2lsU3RhdGUoKXt0aGlzLl9jYWNoZWRTdGVuY2lsQnVmZmVyPXRoaXMuZ2V0U3RlbmNpbEJ1ZmZlcigpLHRoaXMuX2NhY2hlZFN0ZW5jaWxGdW5jdGlvbj10aGlzLmdldFN0ZW5jaWxGdW5jdGlvbigpLHRoaXMuX2NhY2hlZFN0ZW5jaWxNYXNrPXRoaXMuZ2V0U3RlbmNpbE1hc2soKSx0aGlzLl9jYWNoZWRTdGVuY2lsT3BlcmF0aW9uUGFzcz10aGlzLmdldFN0ZW5jaWxPcGVyYXRpb25QYXNzKCksdGhpcy5fY2FjaGVkU3RlbmNpbE9wZXJhdGlvbkZhaWw9dGhpcy5nZXRTdGVuY2lsT3BlcmF0aW9uRmFpbCgpLHRoaXMuX2NhY2hlZFN0ZW5jaWxPcGVyYXRpb25EZXB0aEZhaWw9dGhpcy5nZXRTdGVuY2lsT3BlcmF0aW9uRGVwdGhGYWlsKCksdGhpcy5fY2FjaGVkU3RlbmNpbFJlZmVyZW5jZT10aGlzLmdldFN0ZW5jaWxGdW5jdGlvblJlZmVyZW5jZSgpfXJlc3RvcmVTdGVuY2lsU3RhdGUoKXt0aGlzLnNldFN0ZW5jaWxGdW5jdGlvbih0aGlzLl9jYWNoZWRTdGVuY2lsRnVuY3Rpb24pLHRoaXMuc2V0U3RlbmNpbE1hc2sodGhpcy5fY2FjaGVkU3RlbmNpbE1hc2spLHRoaXMuc2V0U3RlbmNpbEJ1ZmZlcih0aGlzLl9jYWNoZWRTdGVuY2lsQnVmZmVyKSx0aGlzLnNldFN0ZW5jaWxPcGVyYXRpb25QYXNzKHRoaXMuX2NhY2hlZFN0ZW5jaWxPcGVyYXRpb25QYXNzKSx0aGlzLnNldFN0ZW5jaWxPcGVyYXRpb25GYWlsKHRoaXMuX2NhY2hlZFN0ZW5jaWxPcGVyYXRpb25GYWlsKSx0aGlzLnNldFN0ZW5jaWxPcGVyYXRpb25EZXB0aEZhaWwodGhpcy5fY2FjaGVkU3RlbmNpbE9wZXJhdGlvbkRlcHRoRmFpbCksdGhpcy5zZXRTdGVuY2lsRnVuY3Rpb25SZWZlcmVuY2UodGhpcy5fY2FjaGVkU3RlbmNpbFJlZmVyZW5jZSl9c2V0RGlyZWN0Vmlld3BvcnQoZSx0LGkscyl7Y29uc3Qgcj10aGlzLl9jYWNoZWRWaWV3cG9ydDtyZXR1cm4gdGhpcy5fY2FjaGVkVmlld3BvcnQ9bnVsbCx0aGlzLl92aWV3cG9ydChlLHQsaSxzKSxyfXNjaXNzb3JDbGVhcihlLHQsaSxzLHIpe3RoaXMuZW5hYmxlU2Npc3NvcihlLHQsaSxzKSx0aGlzLmNsZWFyKHIsITAsITAsITApLHRoaXMuZGlzYWJsZVNjaXNzb3IoKX1lbmFibGVTY2lzc29yKGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5fZ2w7ci5lbmFibGUoci5TQ0lTU09SX1RFU1QpLHIuc2Npc3NvcihlLHQsaSxzKX1kaXNhYmxlU2Npc3Nvcigpe2NvbnN0IGU9dGhpcy5fZ2w7ZS5kaXNhYmxlKGUuU0NJU1NPUl9URVNUKX1fcmVwb3J0RHJhd0NhbGwoZT0xKXt0aGlzLl9kcmF3Q2FsbHMuYWRkQ291bnQoZSwhMSl9aW5pdFdlYlZSKCl7dGhyb3cgJCgiV2ViVlJDYW1lcmEiKX1fcHJlcGFyZVZSQ29tcG9uZW50KCl7fV9jb25uZWN0VlJFdmVudHMoZSx0KXt9X3N1Ym1pdFZSRnJhbWUoKXt9ZGlzYWJsZVZSKCl7fWlzVlJQcmVzZW50aW5nKCl7cmV0dXJuITF9X3JlcXVlc3RWUkZyYW1lKCl7fV9sb2FkRmlsZUFzeW5jKGUsdCxpKXtyZXR1cm4gbmV3IFByb21pc2UoKHMscik9Pnt0aGlzLl9sb2FkRmlsZShlLG49PntzKG4pfSx2b2lkIDAsdCxpLChuLGEpPT57cihhKX0pfSl9Z2V0VmVydGV4U2hhZGVyU291cmNlKGUpe2NvbnN0IHQ9dGhpcy5fZ2wuZ2V0QXR0YWNoZWRTaGFkZXJzKGUpO3JldHVybiB0P3RoaXMuX2dsLmdldFNoYWRlclNvdXJjZSh0WzBdKTpudWxsfWdldEZyYWdtZW50U2hhZGVyU291cmNlKGUpe2NvbnN0IHQ9dGhpcy5fZ2wuZ2V0QXR0YWNoZWRTaGFkZXJzKGUpO3JldHVybiB0P3RoaXMuX2dsLmdldFNoYWRlclNvdXJjZSh0WzFdKTpudWxsfXNldERlcHRoU3RlbmNpbFRleHR1cmUoZSx0LGkscyl7ZSE9PXZvaWQgMCYmKHQmJih0aGlzLl9ib3VuZFVuaWZvcm1zW2VdPXQpLCFpfHwhaS5kZXB0aFN0ZW5jaWxUZXh0dXJlP3RoaXMuX3NldFRleHR1cmUoZSxudWxsLHZvaWQgMCx2b2lkIDAscyk6dGhpcy5fc2V0VGV4dHVyZShlLGksITEsITAscykpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3MoZSx0LGkpe3ZhciBzO2xldCByPW51bGw7dCYmKHQuX3RleHR1cmVzLmRhdGFbdC5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdP3I9dC5fdGV4dHVyZXMuZGF0YVt0Ll9jdXJyZW50UmVuZGVyVGV4dHVyZUluZF06dC5fZm9yY2VkT3V0cHV0VGV4dHVyZSYmKHI9dC5fZm9yY2VkT3V0cHV0VGV4dHVyZSkpLHRoaXMuX2JpbmRUZXh0dXJlKGUsKHM9cj09bnVsbD92b2lkIDA6ci50ZXh0dXJlKSE9PW51bGwmJnMhPT12b2lkIDA/czpudWxsLGkpfXNldFRleHR1cmVGcm9tUG9zdFByb2Nlc3NPdXRwdXQoZSx0LGkpe3ZhciBzLHI7dGhpcy5fYmluZFRleHR1cmUoZSwocj0ocz10PT1udWxsP3ZvaWQgMDp0Ll9vdXRwdXRUZXh0dXJlKT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMudGV4dHVyZSkhPT1udWxsJiZyIT09dm9pZCAwP3I6bnVsbCxpKX1fcmVidWlsZEJ1ZmZlcnMoKXtmb3IoY29uc3QgZSBvZiB0aGlzLnNjZW5lcyllLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKSxlLl9yZWJ1aWxkR2VvbWV0cmllcygpLGUuX3JlYnVpbGRUZXh0dXJlcygpO2Zvcihjb25zdCBlIG9mIHRoaXMuX3ZpcnR1YWxTY2VuZXMpZS5yZXNldENhY2hlZE1hdGVyaWFsKCksZS5fcmVidWlsZEdlb21ldHJpZXMoKSxlLl9yZWJ1aWxkVGV4dHVyZXMoKTtzdXBlci5fcmVidWlsZEJ1ZmZlcnMoKX1fcmVuZGVyRnJhbWUoKXtmb3IobGV0IGU9MDtlPHRoaXMuX2FjdGl2ZVJlbmRlckxvb3BzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5fYWN0aXZlUmVuZGVyTG9vcHNbZV07dCgpfX1fcmVuZGVyTG9vcCgpe2lmKCF0aGlzLl9jb250ZXh0V2FzTG9zdCl7bGV0IGU9ITA7IXRoaXMucmVuZGVyRXZlbkluQmFja2dyb3VuZCYmdGhpcy5fd2luZG93SXNCYWNrZ3JvdW5kJiYoZT0hMSksZSYmKHRoaXMuYmVnaW5GcmFtZSgpLHRoaXMuX3JlbmRlclZpZXdzKCl8fHRoaXMuX3JlbmRlckZyYW1lKCksdGhpcy5lbmRGcmFtZSgpKX10aGlzLl9hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg+MD90aGlzLmN1c3RvbUFuaW1hdGlvbkZyYW1lUmVxdWVzdGVyPyh0aGlzLmN1c3RvbUFuaW1hdGlvbkZyYW1lUmVxdWVzdGVyLnJlcXVlc3RJRD10aGlzLl9xdWV1ZU5ld0ZyYW1lKHRoaXMuY3VzdG9tQW5pbWF0aW9uRnJhbWVSZXF1ZXN0ZXIucmVuZGVyRnVuY3Rpb258fHRoaXMuX2JvdW5kUmVuZGVyRnVuY3Rpb24sdGhpcy5jdXN0b21BbmltYXRpb25GcmFtZVJlcXVlc3RlciksdGhpcy5fZnJhbWVIYW5kbGVyPXRoaXMuY3VzdG9tQW5pbWF0aW9uRnJhbWVSZXF1ZXN0ZXIucmVxdWVzdElEKTp0aGlzLmlzVlJQcmVzZW50aW5nKCk/dGhpcy5fcmVxdWVzdFZSRnJhbWUoKTp0aGlzLl9mcmFtZUhhbmRsZXI9dGhpcy5fcXVldWVOZXdGcmFtZSh0aGlzLl9ib3VuZFJlbmRlckZ1bmN0aW9uLHRoaXMuZ2V0SG9zdFdpbmRvdygpKTp0aGlzLl9yZW5kZXJpbmdRdWV1ZUxhdW5jaGVkPSExfV9yZW5kZXJWaWV3cygpe3JldHVybiExfXN3aXRjaEZ1bGxzY3JlZW4oZSl7dGhpcy5pc0Z1bGxzY3JlZW4/dGhpcy5leGl0RnVsbHNjcmVlbigpOnRoaXMuZW50ZXJGdWxsc2NyZWVuKGUpfWVudGVyRnVsbHNjcmVlbihlKXt0aGlzLmlzRnVsbHNjcmVlbnx8KHRoaXMuX3BvaW50ZXJMb2NrUmVxdWVzdGVkPWUsdGhpcy5fcmVuZGVyaW5nQ2FudmFzJiZJLl9SZXF1ZXN0RnVsbHNjcmVlbih0aGlzLl9yZW5kZXJpbmdDYW52YXMpKX1leGl0RnVsbHNjcmVlbigpe3RoaXMuaXNGdWxsc2NyZWVuJiZJLl9FeGl0RnVsbHNjcmVlbigpfWVudGVyUG9pbnRlcmxvY2soKXt0aGlzLl9yZW5kZXJpbmdDYW52YXMmJkkuX1JlcXVlc3RQb2ludGVybG9jayh0aGlzLl9yZW5kZXJpbmdDYW52YXMpfWV4aXRQb2ludGVybG9jaygpe0kuX0V4aXRQb2ludGVybG9jaygpfWJlZ2luRnJhbWUoKXt0aGlzLl9tZWFzdXJlRnBzKCksdGhpcy5vbkJlZ2luRnJhbWVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSxzdXBlci5iZWdpbkZyYW1lKCl9ZW5kRnJhbWUoKXtzdXBlci5lbmRGcmFtZSgpLHRoaXMuX3N1Ym1pdFZSRnJhbWUoKSx0aGlzLm9uRW5kRnJhbWVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1yZXNpemUoZT0hMSl7dGhpcy5pc1ZSUHJlc2VudGluZygpfHxzdXBlci5yZXNpemUoZSl9c2V0U2l6ZShlLHQsaT0hMSl7aWYoIXRoaXMuX3JlbmRlcmluZ0NhbnZhc3x8IXN1cGVyLnNldFNpemUoZSx0LGkpKXJldHVybiExO2lmKHRoaXMuc2NlbmVzKXtmb3IobGV0IHM9MDtzPHRoaXMuc2NlbmVzLmxlbmd0aDtzKyspe2NvbnN0IHI9dGhpcy5zY2VuZXNbc107Zm9yKGxldCBuPTA7bjxyLmNhbWVyYXMubGVuZ3RoO24rKyl7Y29uc3QgYT1yLmNhbWVyYXNbbl07YS5fY3VycmVudFJlbmRlcklkPTB9fXRoaXMub25SZXNpemVPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZ0aGlzLm9uUmVzaXplT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9cmV0dXJuITB9X2RlbGV0ZVBpcGVsaW5lQ29udGV4dChlKXtjb25zdCB0PWU7dCYmdC5wcm9ncmFtJiZ0LnRyYW5zZm9ybUZlZWRiYWNrJiYodGhpcy5kZWxldGVUcmFuc2Zvcm1GZWVkYmFjayh0LnRyYW5zZm9ybUZlZWRiYWNrKSx0LnRyYW5zZm9ybUZlZWRiYWNrPW51bGwpLHN1cGVyLl9kZWxldGVQaXBlbGluZUNvbnRleHQoZSl9Y3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHIsbj1udWxsKXtyPXJ8fHRoaXMuX2dsLHRoaXMub25CZWZvcmVTaGFkZXJDb21waWxhdGlvbk9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IGE9c3VwZXIuY3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHIsbik7cmV0dXJuIHRoaXMub25BZnRlclNoYWRlckNvbXBpbGF0aW9uT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksYX1fY3JlYXRlU2hhZGVyUHJvZ3JhbShlLHQsaSxzLHI9bnVsbCl7Y29uc3Qgbj1zLmNyZWF0ZVByb2dyYW0oKTtpZihlLnByb2dyYW09biwhbil0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgcHJvZ3JhbSIpO2lmKHMuYXR0YWNoU2hhZGVyKG4sdCkscy5hdHRhY2hTaGFkZXIobixpKSx0aGlzLndlYkdMVmVyc2lvbj4xJiZyKXtjb25zdCBhPXRoaXMuY3JlYXRlVHJhbnNmb3JtRmVlZGJhY2soKTt0aGlzLmJpbmRUcmFuc2Zvcm1GZWVkYmFjayhhKSx0aGlzLnNldFRyYW5mb3JtRmVlZGJhY2tWYXJ5aW5ncyhuLHIpLGUudHJhbnNmb3JtRmVlZGJhY2s9YX1yZXR1cm4gcy5saW5rUHJvZ3JhbShuKSx0aGlzLndlYkdMVmVyc2lvbj4xJiZyJiZ0aGlzLmJpbmRUcmFuc2Zvcm1GZWVkYmFjayhudWxsKSxlLmNvbnRleHQ9cyxlLnZlcnRleFNoYWRlcj10LGUuZnJhZ21lbnRTaGFkZXI9aSxlLmlzUGFyYWxsZWxDb21waWxlZHx8dGhpcy5fZmluYWxpemVQaXBlbGluZUNvbnRleHQoZSksbn1fcmVsZWFzZVRleHR1cmUoZSl7c3VwZXIuX3JlbGVhc2VUZXh0dXJlKGUpfV9yZWxlYXNlUmVuZGVyVGFyZ2V0V3JhcHBlcihlKXtzdXBlci5fcmVsZWFzZVJlbmRlclRhcmdldFdyYXBwZXIoZSksdGhpcy5zY2VuZXMuZm9yRWFjaCh0PT57dC5wb3N0UHJvY2Vzc2VzLmZvckVhY2goaT0+e2kuX291dHB1dFRleHR1cmU9PT1lJiYoaS5fb3V0cHV0VGV4dHVyZT1udWxsKX0pLHQuY2FtZXJhcy5mb3JFYWNoKGk9PntpLl9wb3N0UHJvY2Vzc2VzLmZvckVhY2gocz0+e3MmJnMuX291dHB1dFRleHR1cmU9PT1lJiYocy5fb3V0cHV0VGV4dHVyZT1udWxsKX0pfSl9KX1nZXRSZW5kZXJQYXNzTmFtZXMoKXtyZXR1cm4gdGhpcy5fcmVuZGVyUGFzc05hbWVzfWdldEN1cnJlbnRSZW5kZXJQYXNzTmFtZSgpe3JldHVybiB0aGlzLl9yZW5kZXJQYXNzTmFtZXNbdGhpcy5jdXJyZW50UmVuZGVyUGFzc0lkXX1jcmVhdGVSZW5kZXJQYXNzSWQoZSl7Y29uc3QgdD0rK0kuX1JlbmRlclBhc3NJZENvdW50ZXI7cmV0dXJuIHRoaXMuX3JlbmRlclBhc3NOYW1lc1t0XT1lPz8iTk9OQU1FIix0fXJlbGVhc2VSZW5kZXJQYXNzSWQoZSl7dGhpcy5fcmVuZGVyUGFzc05hbWVzW2VdPXZvaWQgMDtmb3IobGV0IHQ9MDt0PHRoaXMuc2NlbmVzLmxlbmd0aDsrK3Qpe2NvbnN0IGk9dGhpcy5zY2VuZXNbdF07Zm9yKGxldCBzPTA7czxpLm1lc2hlcy5sZW5ndGg7KytzKXtjb25zdCByPWkubWVzaGVzW3NdO2lmKHIuc3ViTWVzaGVzKWZvcihsZXQgbj0wO248ci5zdWJNZXNoZXMubGVuZ3RoOysrbilyLnN1Yk1lc2hlc1tuXS5fcmVtb3ZlRHJhd1dyYXBwZXIoZSl9fX1fcmVzY2FsZVRleHR1cmUoZSx0LGkscyxyKXt0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfMkQsdGhpcy5fZ2wuVEVYVFVSRV9NQUdfRklMVEVSLHRoaXMuX2dsLkxJTkVBUiksdGhpcy5fZ2wudGV4UGFyYW1ldGVyaSh0aGlzLl9nbC5URVhUVVJFXzJELHRoaXMuX2dsLlRFWFRVUkVfTUlOX0ZJTFRFUix0aGlzLl9nbC5MSU5FQVIpLHRoaXMuX2dsLnRleFBhcmFtZXRlcmkodGhpcy5fZ2wuVEVYVFVSRV8yRCx0aGlzLl9nbC5URVhUVVJFX1dSQVBfUyx0aGlzLl9nbC5DTEFNUF9UT19FREdFKSx0aGlzLl9nbC50ZXhQYXJhbWV0ZXJpKHRoaXMuX2dsLlRFWFRVUkVfMkQsdGhpcy5fZ2wuVEVYVFVSRV9XUkFQX1QsdGhpcy5fZ2wuQ0xBTVBfVE9fRURHRSk7Y29uc3Qgbj10aGlzLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoe3dpZHRoOnQud2lkdGgsaGVpZ2h0OnQuaGVpZ2h0fSx7Z2VuZXJhdGVNaXBNYXBzOiExLHR5cGU6MCxzYW1wbGluZ01vZGU6MixnZW5lcmF0ZURlcHRoQnVmZmVyOiExLGdlbmVyYXRlU3RlbmNpbEJ1ZmZlcjohMX0pOyF0aGlzLl9yZXNjYWxlUG9zdFByb2Nlc3MmJkkuX1Jlc2NhbGVQb3N0UHJvY2Vzc0ZhY3RvcnkmJih0aGlzLl9yZXNjYWxlUG9zdFByb2Nlc3M9SS5fUmVzY2FsZVBvc3RQcm9jZXNzRmFjdG9yeSh0aGlzKSksdGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzJiYodGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzLmV4dGVybmFsVGV4dHVyZVNhbXBsZXJCaW5kaW5nPSEwLHRoaXMuX3Jlc2NhbGVQb3N0UHJvY2Vzcy5nZXRFZmZlY3QoKS5leGVjdXRlV2hlbkNvbXBpbGVkKCgpPT57dGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzLm9uQXBwbHk9ZnVuY3Rpb24obyl7by5fYmluZFRleHR1cmUoInRleHR1cmVTYW1wbGVyIixlKX07bGV0IGE9aTthfHwoYT10aGlzLnNjZW5lc1t0aGlzLnNjZW5lcy5sZW5ndGgtMV0pLGEucG9zdFByb2Nlc3NNYW5hZ2VyLmRpcmVjdFJlbmRlcihbdGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzXSxuLCEwKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkQsdCwhMCksdGhpcy5fZ2wuY29weVRleEltYWdlMkQodGhpcy5fZ2wuVEVYVFVSRV8yRCwwLHMsMCwwLHQud2lkdGgsdC5oZWlnaHQsMCksdGhpcy51bkJpbmRGcmFtZWJ1ZmZlcihuKSxuLmRpc3Bvc2UoKSxyJiZyKCl9KSl9Z2V0RnBzKCl7cmV0dXJuIHRoaXMuX2Zwc31nZXREZWx0YVRpbWUoKXtyZXR1cm4gdGhpcy5fZGVsdGFUaW1lfV9tZWFzdXJlRnBzKCl7dGhpcy5fcGVyZm9ybWFuY2VNb25pdG9yLnNhbXBsZUZyYW1lKCksdGhpcy5fZnBzPXRoaXMuX3BlcmZvcm1hbmNlTW9uaXRvci5hdmVyYWdlRlBTLHRoaXMuX2RlbHRhVGltZT10aGlzLl9wZXJmb3JtYW5jZU1vbml0b3IuaW5zdGFudGFuZW91c0ZyYW1lVGltZXx8MH13cmFwV2ViR0xUZXh0dXJlKGUpe2NvbnN0IHQ9bmV3IHRyKGUsdGhpcy5fZ2wpLGk9bmV3IE90KHRoaXMsTmUuVW5rbm93biwhMCk7cmV0dXJuIGkuX2hhcmR3YXJlVGV4dHVyZT10LGkuaXNSZWFkeT0hMCxpfV91cGxvYWRJbWFnZVRvVGV4dHVyZShlLHQsaT0wLHM9MCl7Y29uc3Qgcj10aGlzLl9nbCxuPXRoaXMuX2dldFdlYkdMVGV4dHVyZVR5cGUoZS50eXBlKSxhPXRoaXMuX2dldEludGVybmFsRm9ybWF0KGUuZm9ybWF0KSxvPXRoaXMuX2dldFJHQkFCdWZmZXJJbnRlcm5hbFNpemVkRm9ybWF0KGUudHlwZSxhKSxoPWUuaXNDdWJlP3IuVEVYVFVSRV9DVUJFX01BUDpyLlRFWFRVUkVfMkQ7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShoLGUsITApLHRoaXMuX3VucGFja0ZsaXBZKGUuaW52ZXJ0WSk7bGV0IGw9ci5URVhUVVJFXzJEO2UuaXNDdWJlJiYobD1yLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtpKSxyLnRleEltYWdlMkQobCxzLG8sYSxuLHQpLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkoaCxudWxsLCEwKX11cGRhdGVUZXh0dXJlQ29tcGFyaXNvbkZ1bmN0aW9uKGUsdCl7aWYodGhpcy53ZWJHTFZlcnNpb249PT0xKXtPLkVycm9yKCJXZWJHTCAxIGRvZXMgbm90IHN1cHBvcnQgdGV4dHVyZSBjb21wYXJpc29uLiIpO3JldHVybn1jb25zdCBpPXRoaXMuX2dsO2UuaXNDdWJlPyh0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsZSwhMCksdD09PTA/KGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfQ1VCRV9NQVAsaS5URVhUVVJFX0NPTVBBUkVfRlVOQyw1MTUpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfQ1VCRV9NQVAsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLk5PTkUpKTooaS50ZXhQYXJhbWV0ZXJpKGkuVEVYVFVSRV9DVUJFX01BUCxpLlRFWFRVUkVfQ09NUEFSRV9GVU5DLHQpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfQ1VCRV9NQVAsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLkNPTVBBUkVfUkVGX1RPX1RFWFRVUkUpKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfQ1VCRV9NQVAsbnVsbCkpOih0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkQsZSwhMCksdD09PTA/KGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfMkQsaS5URVhUVVJFX0NPTVBBUkVfRlVOQyw1MTUpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfMkQsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLk5PTkUpKTooaS50ZXhQYXJhbWV0ZXJpKGkuVEVYVFVSRV8yRCxpLlRFWFRVUkVfQ09NUEFSRV9GVU5DLHQpLGkudGV4UGFyYW1ldGVyaShpLlRFWFRVUkVfMkQsaS5URVhUVVJFX0NPTVBBUkVfTU9ERSxpLkNPTVBBUkVfUkVGX1RPX1RFWFRVUkUpKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHRoaXMuX2dsLlRFWFRVUkVfMkQsbnVsbCkpLGUuX2NvbXBhcmlzb25GdW5jdGlvbj10fWNyZWF0ZUluc3RhbmNlc0J1ZmZlcihlKXtjb25zdCB0PXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO2lmKCF0KXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBpbnN0YW5jZSBidWZmZXIiKTtjb25zdCBpPW5ldyBEaSh0KTtyZXR1cm4gaS5jYXBhY2l0eT1lLHRoaXMuYmluZEFycmF5QnVmZmVyKGkpLHRoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuQVJSQVlfQlVGRkVSLGUsdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKSxpLnJlZmVyZW5jZXM9MSxpfWRlbGV0ZUluc3RhbmNlc0J1ZmZlcihlKXt0aGlzLl9nbC5kZWxldGVCdWZmZXIoZSl9X2NsaWVudFdhaXRBc3luYyhlLHQ9MCxpPTEwKXtjb25zdCBzPXRoaXMuX2dsO3JldHVybiBuZXcgUHJvbWlzZSgocixuKT0+e2NvbnN0IGE9KCk9Pntjb25zdCBvPXMuY2xpZW50V2FpdFN5bmMoZSx0LDApO2lmKG89PXMuV0FJVF9GQUlMRUQpe24oKTtyZXR1cm59aWYobz09cy5USU1FT1VUX0VYUElSRUQpe3NldFRpbWVvdXQoYSxpKTtyZXR1cm59cigpfTthKCl9KX1fcmVhZFBpeGVsc0FzeW5jKGUsdCxpLHMscixuLGEpe2lmKHRoaXMuX3dlYkdMVmVyc2lvbjwyKXRocm93IG5ldyBFcnJvcigiX3JlYWRQaXhlbHNBc3luYyBvbmx5IHdvcmsgb24gV2ViR0wyKyIpO2NvbnN0IG89dGhpcy5fZ2wsaD1vLmNyZWF0ZUJ1ZmZlcigpO28uYmluZEJ1ZmZlcihvLlBJWEVMX1BBQ0tfQlVGRkVSLGgpLG8uYnVmZmVyRGF0YShvLlBJWEVMX1BBQ0tfQlVGRkVSLGEuYnl0ZUxlbmd0aCxvLlNUUkVBTV9SRUFEKSxvLnJlYWRQaXhlbHMoZSx0LGkscyxyLG4sMCksby5iaW5kQnVmZmVyKG8uUElYRUxfUEFDS19CVUZGRVIsbnVsbCk7Y29uc3QgbD1vLmZlbmNlU3luYyhvLlNZTkNfR1BVX0NPTU1BTkRTX0NPTVBMRVRFLDApO3JldHVybiBsPyhvLmZsdXNoKCksdGhpcy5fY2xpZW50V2FpdEFzeW5jKGwsMCwxMCkudGhlbigoKT0+KG8uZGVsZXRlU3luYyhsKSxvLmJpbmRCdWZmZXIoby5QSVhFTF9QQUNLX0JVRkZFUixoKSxvLmdldEJ1ZmZlclN1YkRhdGEoby5QSVhFTF9QQUNLX0JVRkZFUiwwLGEpLG8uYmluZEJ1ZmZlcihvLlBJWEVMX1BBQ0tfQlVGRkVSLG51bGwpLG8uZGVsZXRlQnVmZmVyKGgpLGEpKSk6bnVsbH1kaXNwb3NlKCl7Zm9yKHRoaXMuaGlkZUxvYWRpbmdVSSgpLHRoaXMub25OZXdTY2VuZUFkZGVkT2JzZXJ2YWJsZS5jbGVhcigpO3RoaXMucG9zdFByb2Nlc3Nlcy5sZW5ndGg7KXRoaXMucG9zdFByb2Nlc3Nlc1swXS5kaXNwb3NlKCk7Zm9yKHRoaXMuX3Jlc2NhbGVQb3N0UHJvY2VzcyYmdGhpcy5fcmVzY2FsZVBvc3RQcm9jZXNzLmRpc3Bvc2UoKTt0aGlzLnNjZW5lcy5sZW5ndGg7KXRoaXMuc2NlbmVzWzBdLmRpc3Bvc2UoKTtmb3IoO3RoaXMuX3ZpcnR1YWxTY2VuZXMubGVuZ3RoOyl0aGlzLl92aXJ0dWFsU2NlbmVzWzBdLmRpc3Bvc2UoKTtJLkluc3RhbmNlcy5sZW5ndGg9PT0xJiZJLmF1ZGlvRW5naW5lJiYoSS5hdWRpb0VuZ2luZS5kaXNwb3NlKCksSS5hdWRpb0VuZ2luZT1udWxsKSx0aGlzLmRpc2FibGVWUigpO2NvbnN0IGU9dGhpcy5nZXRIb3N0V2luZG93KCk7ZSYmdHlwZW9mIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj09ImZ1bmN0aW9uIiYmKGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYmx1ciIsdGhpcy5fb25CbHVyKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImZvY3VzIix0aGlzLl9vbkZvY3VzKSksdGhpcy5fcmVuZGVyaW5nQ2FudmFzJiYodGhpcy5fcmVuZGVyaW5nQ2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoImZvY3VzIix0aGlzLl9vbkNhbnZhc0ZvY3VzKSx0aGlzLl9yZW5kZXJpbmdDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYmx1ciIsdGhpcy5fb25DYW52YXNCbHVyKSx0aGlzLl9yZW5kZXJpbmdDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm91dCIsdGhpcy5fb25DYW52YXNQb2ludGVyT3V0KSx0aGlzLl9yZW5kZXJpbmdDYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY29udGV4dG1lbnUiLHRoaXMuX29uQ2FudmFzQ29udGV4dE1lbnUpKSxDaSgpJiYoZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZnVsbHNjcmVlbmNoYW5nZSIsdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3pmdWxsc2NyZWVuY2hhbmdlIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIndlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UiLHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibXNmdWxsc2NyZWVuY2hhbmdlIix0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJsb2NrY2hhbmdlIix0aGlzLl9vblBvaW50ZXJMb2NrQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtc3BvaW50ZXJsb2NrY2hhbmdlIix0aGlzLl9vblBvaW50ZXJMb2NrQ2hhbmdlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3pwb2ludGVybG9ja2NoYW5nZSIsdGhpcy5fb25Qb2ludGVyTG9ja0NoYW5nZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2Via2l0cG9pbnRlcmxvY2tjaGFuZ2UiLHRoaXMuX29uUG9pbnRlckxvY2tDaGFuZ2UpKSxzdXBlci5kaXNwb3NlKCk7Y29uc3QgdD1JLkluc3RhbmNlcy5pbmRleE9mKHRoaXMpO3Q+PTAmJkkuSW5zdGFuY2VzLnNwbGljZSh0LDEpLHRoaXMub25SZXNpemVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNhbnZhc0JsdXJPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNhbnZhc0ZvY3VzT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25DYW52YXNQb2ludGVyT3V0T2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWdpbkZyYW1lT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25FbmRGcmFtZU9ic2VydmFibGUuY2xlYXIoKX1fZGlzYWJsZVRvdWNoQWN0aW9uKCl7IXRoaXMuX3JlbmRlcmluZ0NhbnZhc3x8IXRoaXMuX3JlbmRlcmluZ0NhbnZhcy5zZXRBdHRyaWJ1dGV8fCh0aGlzLl9yZW5kZXJpbmdDYW52YXMuc2V0QXR0cmlidXRlKCJ0b3VjaC1hY3Rpb24iLCJub25lIiksdGhpcy5fcmVuZGVyaW5nQ2FudmFzLnN0eWxlLnRvdWNoQWN0aW9uPSJub25lIix0aGlzLl9yZW5kZXJpbmdDYW52YXMuc3R5bGUud2Via2l0VGFwSGlnaGxpZ2h0Q29sb3I9InRyYW5zcGFyZW50Iil9ZGlzcGxheUxvYWRpbmdVSSgpe2lmKCFqZSgpKXJldHVybjtjb25zdCBlPXRoaXMubG9hZGluZ1NjcmVlbjtlJiZlLmRpc3BsYXlMb2FkaW5nVUkoKX1oaWRlTG9hZGluZ1VJKCl7aWYoIWplKCkpcmV0dXJuO2NvbnN0IGU9dGhpcy5fbG9hZGluZ1NjcmVlbjtlJiZlLmhpZGVMb2FkaW5nVUkoKX1nZXQgbG9hZGluZ1NjcmVlbigpe3JldHVybiF0aGlzLl9sb2FkaW5nU2NyZWVuJiZ0aGlzLl9yZW5kZXJpbmdDYW52YXMmJih0aGlzLl9sb2FkaW5nU2NyZWVuPUkuRGVmYXVsdExvYWRpbmdTY3JlZW5GYWN0b3J5KHRoaXMuX3JlbmRlcmluZ0NhbnZhcykpLHRoaXMuX2xvYWRpbmdTY3JlZW59c2V0IGxvYWRpbmdTY3JlZW4oZSl7dGhpcy5fbG9hZGluZ1NjcmVlbj1lfXNldCBsb2FkaW5nVUlUZXh0KGUpe3RoaXMubG9hZGluZ1NjcmVlbi5sb2FkaW5nVUlUZXh0PWV9c2V0IGxvYWRpbmdVSUJhY2tncm91bmRDb2xvcihlKXt0aGlzLmxvYWRpbmdTY3JlZW4ubG9hZGluZ1VJQmFja2dyb3VuZENvbG9yPWV9Y3JlYXRlVmlkZW9FbGVtZW50KGUpe3JldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ2aWRlbyIpfXN0YXRpYyBfUmVxdWVzdFBvaW50ZXJsb2NrKGUpe2UucmVxdWVzdFBvaW50ZXJMb2NrJiYoZS5yZXF1ZXN0UG9pbnRlckxvY2soKSxlLmZvY3VzKCkpfXN0YXRpYyBfRXhpdFBvaW50ZXJsb2NrKCl7ZG9jdW1lbnQuZXhpdFBvaW50ZXJMb2NrJiZkb2N1bWVudC5leGl0UG9pbnRlckxvY2soKX1zdGF0aWMgX1JlcXVlc3RGdWxsc2NyZWVuKGUpe2NvbnN0IHQ9ZS5yZXF1ZXN0RnVsbHNjcmVlbnx8ZS53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbjt0JiZ0LmNhbGwoZSl9c3RhdGljIF9FeGl0RnVsbHNjcmVlbigpe2NvbnN0IGU9ZG9jdW1lbnQ7ZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4/ZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKTplLndlYmtpdENhbmNlbEZ1bGxTY3JlZW4mJmUud2Via2l0Q2FuY2VsRnVsbFNjcmVlbigpfWdldEZvbnRPZmZzZXQoZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7dC5pbm5lckhUTUw9IkhnIix0LnNldEF0dHJpYnV0ZSgic3R5bGUiLGBmb250OiAke2V9ICFpbXBvcnRhbnRgKTtjb25zdCBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2kuc3R5bGUuZGlzcGxheT0iaW5saW5lLWJsb2NrIixpLnN0eWxlLndpZHRoPSIxcHgiLGkuc3R5bGUuaGVpZ2h0PSIwcHgiLGkuc3R5bGUudmVydGljYWxBbGlnbj0iYm90dG9tIjtjb25zdCBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3Muc3R5bGUud2hpdGVTcGFjZT0ibm93cmFwIixzLmFwcGVuZENoaWxkKHQpLHMuYXBwZW5kQ2hpbGQoaSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzKTtsZXQgcj0wLG49MDt0cnl7bj1pLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcC10LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCxpLnN0eWxlLnZlcnRpY2FsQWxpZ249ImJhc2VsaW5lIixyPWkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wLXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wfWZpbmFsbHl7ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChzKX1yZXR1cm57YXNjZW50OnIsaGVpZ2h0Om4sZGVzY2VudDpuLXJ9fX1JLkFMUEhBX0RJU0FCTEU9MCxJLkFMUEhBX0FERD0xLEkuQUxQSEFfQ09NQklORT0yLEkuQUxQSEFfU1VCVFJBQ1Q9MyxJLkFMUEhBX01VTFRJUExZPTQsSS5BTFBIQV9NQVhJTUlaRUQ9NSxJLkFMUEhBX09ORU9ORT02LEkuQUxQSEFfUFJFTVVMVElQTElFRD03LEkuQUxQSEFfUFJFTVVMVElQTElFRF9QT1JURVJEVUZGPTgsSS5BTFBIQV9JTlRFUlBPTEFURT05LEkuQUxQSEFfU0NSRUVOTU9ERT0xMCxJLkRFTEFZTE9BRFNUQVRFX05PTkU9MCxJLkRFTEFZTE9BRFNUQVRFX0xPQURFRD0xLEkuREVMQVlMT0FEU1RBVEVfTE9BRElORz0yLEkuREVMQVlMT0FEU1RBVEVfTk9UTE9BREVEPTQsSS5ORVZFUj01MTIsSS5BTFdBWVM9NTE5LEkuTEVTUz01MTMsSS5FUVVBTD01MTQsSS5MRVFVQUw9NTE1LEkuR1JFQVRFUj01MTYsSS5HRVFVQUw9NTE4LEkuTk9URVFVQUw9NTE3LEkuS0VFUD03NjgwLEkuUkVQTEFDRT03NjgxLEkuSU5DUj03NjgyLEkuREVDUj03NjgzLEkuSU5WRVJUPTUzODYsSS5JTkNSX1dSQVA9MzQwNTUsSS5ERUNSX1dSQVA9MzQwNTYsSS5URVhUVVJFX0NMQU1QX0FERFJFU1NNT0RFPTAsSS5URVhUVVJFX1dSQVBfQUREUkVTU01PREU9MSxJLlRFWFRVUkVfTUlSUk9SX0FERFJFU1NNT0RFPTIsSS5URVhUVVJFRk9STUFUX0FMUEhBPTAsSS5URVhUVVJFRk9STUFUX0xVTUlOQU5DRT0xLEkuVEVYVFVSRUZPUk1BVF9MVU1JTkFOQ0VfQUxQSEE9MixJLlRFWFRVUkVGT1JNQVRfUkdCPTQsSS5URVhUVVJFRk9STUFUX1JHQkE9NSxJLlRFWFRVUkVGT1JNQVRfUkVEPTYsSS5URVhUVVJFRk9STUFUX1I9NixJLlRFWFRVUkVGT1JNQVRfUkc9NyxJLlRFWFRVUkVGT1JNQVRfUkVEX0lOVEVHRVI9OCxJLlRFWFRVUkVGT1JNQVRfUl9JTlRFR0VSPTgsSS5URVhUVVJFRk9STUFUX1JHX0lOVEVHRVI9OSxJLlRFWFRVUkVGT1JNQVRfUkdCX0lOVEVHRVI9MTAsSS5URVhUVVJFRk9STUFUX1JHQkFfSU5URUdFUj0xMSxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0JZVEU9MCxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVD0wLEkuVEVYVFVSRVRZUEVfRkxPQVQ9MSxJLlRFWFRVUkVUWVBFX0hBTEZfRkxPQVQ9MixJLlRFWFRVUkVUWVBFX0JZVEU9MyxJLlRFWFRVUkVUWVBFX1NIT1JUPTQsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVD01LEkuVEVYVFVSRVRZUEVfSU5UPTYsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9JTlRFR0VSPTcsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVF80XzRfNF80PTgsSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVF81XzVfNV8xPTksSS5URVhUVVJFVFlQRV9VTlNJR05FRF9TSE9SVF81XzZfNT0xMCxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVF8yXzEwXzEwXzEwX1JFVj0xMSxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVF8yNF84PTEyLEkuVEVYVFVSRVRZUEVfVU5TSUdORURfSU5UXzEwRl8xMUZfMTFGX1JFVj0xMyxJLlRFWFRVUkVUWVBFX1VOU0lHTkVEX0lOVF81XzlfOV85X1JFVj0xNCxJLlRFWFRVUkVUWVBFX0ZMT0FUXzMyX1VOU0lHTkVEX0lOVF8yNF84X1JFVj0xNSxJLlRFWFRVUkVfTkVBUkVTVF9TQU1QTElOR01PREU9MSxJLlRFWFRVUkVfQklMSU5FQVJfU0FNUExJTkdNT0RFPTIsSS5URVhUVVJFX1RSSUxJTkVBUl9TQU1QTElOR01PREU9MyxJLlRFWFRVUkVfTkVBUkVTVF9ORUFSRVNUX01JUExJTkVBUj04LEkuVEVYVFVSRV9MSU5FQVJfTElORUFSX01JUE5FQVJFU1Q9MTEsSS5URVhUVVJFX0xJTkVBUl9MSU5FQVJfTUlQTElORUFSPTMsSS5URVhUVVJFX05FQVJFU1RfTkVBUkVTVF9NSVBORUFSRVNUPTQsSS5URVhUVVJFX05FQVJFU1RfTElORUFSX01JUE5FQVJFU1Q9NSxJLlRFWFRVUkVfTkVBUkVTVF9MSU5FQVJfTUlQTElORUFSPTYsSS5URVhUVVJFX05FQVJFU1RfTElORUFSPTcsSS5URVhUVVJFX05FQVJFU1RfTkVBUkVTVD0xLEkuVEVYVFVSRV9MSU5FQVJfTkVBUkVTVF9NSVBORUFSRVNUPTksSS5URVhUVVJFX0xJTkVBUl9ORUFSRVNUX01JUExJTkVBUj0xMCxJLlRFWFRVUkVfTElORUFSX0xJTkVBUj0yLEkuVEVYVFVSRV9MSU5FQVJfTkVBUkVTVD0xMixJLlRFWFRVUkVfRVhQTElDSVRfTU9ERT0wLEkuVEVYVFVSRV9TUEhFUklDQUxfTU9ERT0xLEkuVEVYVFVSRV9QTEFOQVJfTU9ERT0yLEkuVEVYVFVSRV9DVUJJQ19NT0RFPTMsSS5URVhUVVJFX1BST0pFQ1RJT05fTU9ERT00LEkuVEVYVFVSRV9TS1lCT1hfTU9ERT01LEkuVEVYVFVSRV9JTlZDVUJJQ19NT0RFPTYsSS5URVhUVVJFX0VRVUlSRUNUQU5HVUxBUl9NT0RFPTcsSS5URVhUVVJFX0ZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NT0RFPTgsSS5URVhUVVJFX0ZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NSVJST1JFRF9NT0RFPTksSS5TQ0FMRU1PREVfRkxPT1I9MSxJLlNDQUxFTU9ERV9ORUFSRVNUPTIsSS5TQ0FMRU1PREVfQ0VJTElORz0zLEkuX1Jlc2NhbGVQb3N0UHJvY2Vzc0ZhY3Rvcnk9bnVsbCxJLl9SZW5kZXJQYXNzSWRDb3VudGVyPTAsb2UucHJvdG90eXBlLl9kZWJ1Z1B1c2hHcm91cD1mdW5jdGlvbihjLGUpe30sb2UucHJvdG90eXBlLl9kZWJ1Z1BvcEdyb3VwPWZ1bmN0aW9uKGMpe30sb2UucHJvdG90eXBlLl9kZWJ1Z0luc2VydE1hcmtlcj1mdW5jdGlvbihjLGUpe30sb2UucHJvdG90eXBlLl9kZWJ1Z0ZsdXNoUGVuZGluZ0NvbW1hbmRzPWZ1bmN0aW9uKCl7fTtmdW5jdGlvbiBnbihjKXtyZXR1cm4gbmV3IEkoYywhMCx7cHJlc2VydmVEcmF3aW5nQnVmZmVyOiEwLHN0ZW5jaWw6ITB9KX1jbGFzcyByZXtjb25zdHJ1Y3RvcihlPTAsdD0wLGk9MCl7dGhpcy5yPWUsdGhpcy5nPXQsdGhpcy5iPWl9dG9TdHJpbmcoKXtyZXR1cm4ie1I6ICIrdGhpcy5yKyIgRzoiK3RoaXMuZysiIEI6Iit0aGlzLmIrIn0ifWdldENsYXNzTmFtZSgpe3JldHVybiJDb2xvcjMifWdldEhhc2hDb2RlKCl7bGV0IGU9dGhpcy5yKjI1NXwwO3JldHVybiBlPWUqMzk3Xih0aGlzLmcqMjU1fDApLGU9ZSozOTdeKHRoaXMuYioyNTV8MCksZX10b0FycmF5KGUsdD0wKXtyZXR1cm4gZVt0XT10aGlzLnIsZVt0KzFdPXRoaXMuZyxlW3QrMl09dGhpcy5iLHRoaXN9ZnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gcmUuRnJvbUFycmF5VG9SZWYoZSx0LHRoaXMpLHRoaXN9dG9Db2xvcjQoZT0xKXtyZXR1cm4gbmV3IG1lKHRoaXMucix0aGlzLmcsdGhpcy5iLGUpfWFzQXJyYXkoKXtyZXR1cm5bdGhpcy5yLHRoaXMuZyx0aGlzLmJdfXRvTHVtaW5hbmNlKCl7cmV0dXJuIHRoaXMuciouMyt0aGlzLmcqLjU5K3RoaXMuYiouMTF9bXVsdGlwbHkoZSl7cmV0dXJuIG5ldyByZSh0aGlzLnIqZS5yLHRoaXMuZyplLmcsdGhpcy5iKmUuYil9bXVsdGlwbHlUb1JlZihlLHQpe3JldHVybiB0LnI9dGhpcy5yKmUucix0Lmc9dGhpcy5nKmUuZyx0LmI9dGhpcy5iKmUuYix0aGlzfWVxdWFscyhlKXtyZXR1cm4gZSYmdGhpcy5yPT09ZS5yJiZ0aGlzLmc9PT1lLmcmJnRoaXMuYj09PWUuYn1lcXVhbHNGbG9hdHMoZSx0LGkpe3JldHVybiB0aGlzLnI9PT1lJiZ0aGlzLmc9PT10JiZ0aGlzLmI9PT1pfXNjYWxlKGUpe3JldHVybiBuZXcgcmUodGhpcy5yKmUsdGhpcy5nKmUsdGhpcy5iKmUpfXNjYWxlSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5yKj1lLHRoaXMuZyo9ZSx0aGlzLmIqPWUsdGhpc31zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnIqZSx0Lmc9dGhpcy5nKmUsdC5iPXRoaXMuYiplLHRoaXN9c2NhbGVBbmRBZGRUb1JlZihlLHQpe3JldHVybiB0LnIrPXRoaXMuciplLHQuZys9dGhpcy5nKmUsdC5iKz10aGlzLmIqZSx0aGlzfWNsYW1wVG9SZWYoZT0wLHQ9MSxpKXtyZXR1cm4gaS5yPVguQ2xhbXAodGhpcy5yLGUsdCksaS5nPVguQ2xhbXAodGhpcy5nLGUsdCksaS5iPVguQ2xhbXAodGhpcy5iLGUsdCksdGhpc31hZGQoZSl7cmV0dXJuIG5ldyByZSh0aGlzLnIrZS5yLHRoaXMuZytlLmcsdGhpcy5iK2UuYil9YWRkVG9SZWYoZSx0KXtyZXR1cm4gdC5yPXRoaXMucitlLnIsdC5nPXRoaXMuZytlLmcsdC5iPXRoaXMuYitlLmIsdGhpc31zdWJ0cmFjdChlKXtyZXR1cm4gbmV3IHJlKHRoaXMuci1lLnIsdGhpcy5nLWUuZyx0aGlzLmItZS5iKX1zdWJ0cmFjdFRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnItZS5yLHQuZz10aGlzLmctZS5nLHQuYj10aGlzLmItZS5iLHRoaXN9Y2xvbmUoKXtyZXR1cm4gbmV3IHJlKHRoaXMucix0aGlzLmcsdGhpcy5iKX1jb3B5RnJvbShlKXtyZXR1cm4gdGhpcy5yPWUucix0aGlzLmc9ZS5nLHRoaXMuYj1lLmIsdGhpc31jb3B5RnJvbUZsb2F0cyhlLHQsaSl7cmV0dXJuIHRoaXMucj1lLHRoaXMuZz10LHRoaXMuYj1pLHRoaXN9c2V0KGUsdCxpKXtyZXR1cm4gdGhpcy5jb3B5RnJvbUZsb2F0cyhlLHQsaSl9dG9IZXhTdHJpbmcoKXtjb25zdCBlPU1hdGgucm91bmQodGhpcy5yKjI1NSksdD1NYXRoLnJvdW5kKHRoaXMuZyoyNTUpLGk9TWF0aC5yb3VuZCh0aGlzLmIqMjU1KTtyZXR1cm4iIyIrWC5Ub0hleChlKStYLlRvSGV4KHQpK1guVG9IZXgoaSl9dG9MaW5lYXJTcGFjZSgpe2NvbnN0IGU9bmV3IHJlO3JldHVybiB0aGlzLnRvTGluZWFyU3BhY2VUb1JlZihlKSxlfXRvSFNWKCl7Y29uc3QgZT1uZXcgcmU7cmV0dXJuIHRoaXMudG9IU1ZUb1JlZihlKSxlfXRvSFNWVG9SZWYoZSl7Y29uc3QgdD10aGlzLnIsaT10aGlzLmcscz10aGlzLmIscj1NYXRoLm1heCh0LGkscyksbj1NYXRoLm1pbih0LGkscyk7bGV0IGE9MCxvPTA7Y29uc3QgaD1yLGw9ci1uO3IhPT0wJiYobz1sL3IpLHIhPW4mJihyPT10PyhhPShpLXMpL2wsaTxzJiYoYSs9NikpOnI9PWk/YT0ocy10KS9sKzI6cj09cyYmKGE9KHQtaSkvbCs0KSxhKj02MCksZS5yPWEsZS5nPW8sZS5iPWh9dG9MaW5lYXJTcGFjZVRvUmVmKGUpe3JldHVybiBlLnI9TWF0aC5wb3codGhpcy5yLHllKSxlLmc9TWF0aC5wb3codGhpcy5nLHllKSxlLmI9TWF0aC5wb3codGhpcy5iLHllKSx0aGlzfXRvR2FtbWFTcGFjZSgpe2NvbnN0IGU9bmV3IHJlO3JldHVybiB0aGlzLnRvR2FtbWFTcGFjZVRvUmVmKGUpLGV9dG9HYW1tYVNwYWNlVG9SZWYoZSl7cmV0dXJuIGUucj1NYXRoLnBvdyh0aGlzLnIsU2UpLGUuZz1NYXRoLnBvdyh0aGlzLmcsU2UpLGUuYj1NYXRoLnBvdyh0aGlzLmIsU2UpLHRoaXN9c3RhdGljIEhTVnRvUkdCVG9SZWYoZSx0LGkscyl7Y29uc3Qgcj1pKnQsbj1lLzYwLGE9ciooMS1NYXRoLmFicyhuJTItMSkpO2xldCBvPTAsaD0wLGw9MDtuPj0wJiZuPD0xPyhvPXIsaD1hKTpuPj0xJiZuPD0yPyhvPWEsaD1yKTpuPj0yJiZuPD0zPyhoPXIsbD1hKTpuPj0zJiZuPD00PyhoPWEsbD1yKTpuPj00JiZuPD01PyhvPWEsbD1yKTpuPj01JiZuPD02JiYobz1yLGw9YSk7Y29uc3QgdT1pLXI7cy5zZXQobyt1LGgrdSxsK3UpfXN0YXRpYyBGcm9tSFNWKGUsdCxpKXtjb25zdCBzPW5ldyByZSgwLDAsMCk7cmV0dXJuIHJlLkhTVnRvUkdCVG9SZWYoZSx0LGkscyksc31zdGF0aWMgRnJvbUhleFN0cmluZyhlKXtpZihlLnN1YnN0cmluZygwLDEpIT09IiMifHxlLmxlbmd0aCE9PTcpcmV0dXJuIG5ldyByZSgwLDAsMCk7Y29uc3QgdD1wYXJzZUludChlLnN1YnN0cmluZygxLDMpLDE2KSxpPXBhcnNlSW50KGUuc3Vic3RyaW5nKDMsNSksMTYpLHM9cGFyc2VJbnQoZS5zdWJzdHJpbmcoNSw3KSwxNik7cmV0dXJuIHJlLkZyb21JbnRzKHQsaSxzKX1zdGF0aWMgRnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gbmV3IHJlKGVbdF0sZVt0KzFdLGVbdCsyXSl9c3RhdGljIEZyb21BcnJheVRvUmVmKGUsdD0wLGkpe2kucj1lW3RdLGkuZz1lW3QrMV0saS5iPWVbdCsyXX1zdGF0aWMgRnJvbUludHMoZSx0LGkpe3JldHVybiBuZXcgcmUoZS8yNTUsdC8yNTUsaS8yNTUpfXN0YXRpYyBMZXJwKGUsdCxpKXtjb25zdCBzPW5ldyByZSgwLDAsMCk7cmV0dXJuIHJlLkxlcnBUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBMZXJwVG9SZWYoZSx0LGkscyl7cy5yPWUucisodC5yLWUucikqaSxzLmc9ZS5nKyh0LmctZS5nKSppLHMuYj1lLmIrKHQuYi1lLmIpKml9c3RhdGljIEhlcm1pdGUoZSx0LGkscyxyKXtjb25zdCBuPXIqcixhPXIqbixvPTIqYS0zKm4rMSxoPS0yKmErMypuLGw9YS0yKm4rcix1PWEtbixkPWUucipvK2kucipoK3QucipsK3Mucip1LGY9ZS5nKm8raS5nKmgrdC5nKmwrcy5nKnUsXz1lLmIqbytpLmIqaCt0LmIqbCtzLmIqdTtyZXR1cm4gbmV3IHJlKGQsZixfKX1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmUoZSx0LGkscyxyKXtjb25zdCBuPXJlLkJsYWNrKCk7cmV0dXJuIHRoaXMuSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbiksbn1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmVUb1JlZihlLHQsaSxzLHIsbil7Y29uc3QgYT1yKnI7bi5yPShhLXIpKjYqZS5yKygzKmEtNCpyKzEpKnQucisoLWErcikqNippLnIrKDMqYS0yKnIpKnMucixuLmc9KGEtcikqNiplLmcrKDMqYS00KnIrMSkqdC5nKygtYStyKSo2KmkuZysoMyphLTIqcikqcy5nLG4uYj0oYS1yKSo2KmUuYisoMyphLTQqcisxKSp0LmIrKC1hK3IpKjYqaS5iKygzKmEtMipyKSpzLmJ9c3RhdGljIFJlZCgpe3JldHVybiBuZXcgcmUoMSwwLDApfXN0YXRpYyBHcmVlbigpe3JldHVybiBuZXcgcmUoMCwxLDApfXN0YXRpYyBCbHVlKCl7cmV0dXJuIG5ldyByZSgwLDAsMSl9c3RhdGljIEJsYWNrKCl7cmV0dXJuIG5ldyByZSgwLDAsMCl9c3RhdGljIGdldCBCbGFja1JlYWRPbmx5KCl7cmV0dXJuIHJlLl9CbGFja1JlYWRPbmx5fXN0YXRpYyBXaGl0ZSgpe3JldHVybiBuZXcgcmUoMSwxLDEpfXN0YXRpYyBQdXJwbGUoKXtyZXR1cm4gbmV3IHJlKC41LDAsLjUpfXN0YXRpYyBNYWdlbnRhKCl7cmV0dXJuIG5ldyByZSgxLDAsMSl9c3RhdGljIFllbGxvdygpe3JldHVybiBuZXcgcmUoMSwxLDApfXN0YXRpYyBHcmF5KCl7cmV0dXJuIG5ldyByZSguNSwuNSwuNSl9c3RhdGljIFRlYWwoKXtyZXR1cm4gbmV3IHJlKDAsMSwxKX1zdGF0aWMgUmFuZG9tKCl7cmV0dXJuIG5ldyByZShNYXRoLnJhbmRvbSgpLE1hdGgucmFuZG9tKCksTWF0aC5yYW5kb20oKSl9fXJlLl9CbGFja1JlYWRPbmx5PXJlLkJsYWNrKCk7bGV0IG1lPWNsYXNze2NvbnN0cnVjdG9yKGU9MCx0PTAsaT0wLHM9MSl7dGhpcy5yPWUsdGhpcy5nPXQsdGhpcy5iPWksdGhpcy5hPXN9YWRkSW5QbGFjZShlKXtyZXR1cm4gdGhpcy5yKz1lLnIsdGhpcy5nKz1lLmcsdGhpcy5iKz1lLmIsdGhpcy5hKz1lLmEsdGhpc31hc0FycmF5KCl7cmV0dXJuW3RoaXMucix0aGlzLmcsdGhpcy5iLHRoaXMuYV19dG9BcnJheShlLHQ9MCl7cmV0dXJuIGVbdF09dGhpcy5yLGVbdCsxXT10aGlzLmcsZVt0KzJdPXRoaXMuYixlW3QrM109dGhpcy5hLHRoaXN9ZnJvbUFycmF5KGUsdD0wKXtyZXR1cm4gbWUuRnJvbUFycmF5VG9SZWYoZSx0LHRoaXMpLHRoaXN9ZXF1YWxzKGUpe3JldHVybiBlJiZ0aGlzLnI9PT1lLnImJnRoaXMuZz09PWUuZyYmdGhpcy5iPT09ZS5iJiZ0aGlzLmE9PT1lLmF9YWRkKGUpe3JldHVybiBuZXcgbWUodGhpcy5yK2Uucix0aGlzLmcrZS5nLHRoaXMuYitlLmIsdGhpcy5hK2UuYSl9c3VidHJhY3QoZSl7cmV0dXJuIG5ldyBtZSh0aGlzLnItZS5yLHRoaXMuZy1lLmcsdGhpcy5iLWUuYix0aGlzLmEtZS5hKX1zdWJ0cmFjdFRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnItZS5yLHQuZz10aGlzLmctZS5nLHQuYj10aGlzLmItZS5iLHQuYT10aGlzLmEtZS5hLHRoaXN9c2NhbGUoZSl7cmV0dXJuIG5ldyBtZSh0aGlzLnIqZSx0aGlzLmcqZSx0aGlzLmIqZSx0aGlzLmEqZSl9c2NhbGVJblBsYWNlKGUpe3JldHVybiB0aGlzLnIqPWUsdGhpcy5nKj1lLHRoaXMuYio9ZSx0aGlzLmEqPWUsdGhpc31zY2FsZVRvUmVmKGUsdCl7cmV0dXJuIHQucj10aGlzLnIqZSx0Lmc9dGhpcy5nKmUsdC5iPXRoaXMuYiplLHQuYT10aGlzLmEqZSx0aGlzfXNjYWxlQW5kQWRkVG9SZWYoZSx0KXtyZXR1cm4gdC5yKz10aGlzLnIqZSx0LmcrPXRoaXMuZyplLHQuYis9dGhpcy5iKmUsdC5hKz10aGlzLmEqZSx0aGlzfWNsYW1wVG9SZWYoZT0wLHQ9MSxpKXtyZXR1cm4gaS5yPVguQ2xhbXAodGhpcy5yLGUsdCksaS5nPVguQ2xhbXAodGhpcy5nLGUsdCksaS5iPVguQ2xhbXAodGhpcy5iLGUsdCksaS5hPVguQ2xhbXAodGhpcy5hLGUsdCksdGhpc31tdWx0aXBseShlKXtyZXR1cm4gbmV3IG1lKHRoaXMuciplLnIsdGhpcy5nKmUuZyx0aGlzLmIqZS5iLHRoaXMuYSplLmEpfW11bHRpcGx5VG9SZWYoZSx0KXtyZXR1cm4gdC5yPXRoaXMuciplLnIsdC5nPXRoaXMuZyplLmcsdC5iPXRoaXMuYiplLmIsdC5hPXRoaXMuYSplLmEsdH10b1N0cmluZygpe3JldHVybiJ7UjogIit0aGlzLnIrIiBHOiIrdGhpcy5nKyIgQjoiK3RoaXMuYisiIEE6Iit0aGlzLmErIn0ifWdldENsYXNzTmFtZSgpe3JldHVybiJDb2xvcjQifWdldEhhc2hDb2RlKCl7bGV0IGU9dGhpcy5yKjI1NXwwO3JldHVybiBlPWUqMzk3Xih0aGlzLmcqMjU1fDApLGU9ZSozOTdeKHRoaXMuYioyNTV8MCksZT1lKjM5N14odGhpcy5hKjI1NXwwKSxlfWNsb25lKCl7cmV0dXJuIG5ldyBtZSh0aGlzLnIsdGhpcy5nLHRoaXMuYix0aGlzLmEpfWNvcHlGcm9tKGUpe3JldHVybiB0aGlzLnI9ZS5yLHRoaXMuZz1lLmcsdGhpcy5iPWUuYix0aGlzLmE9ZS5hLHRoaXN9Y29weUZyb21GbG9hdHMoZSx0LGkscyl7cmV0dXJuIHRoaXMucj1lLHRoaXMuZz10LHRoaXMuYj1pLHRoaXMuYT1zLHRoaXN9c2V0KGUsdCxpLHMpe3JldHVybiB0aGlzLmNvcHlGcm9tRmxvYXRzKGUsdCxpLHMpfXRvSGV4U3RyaW5nKGU9ITEpe2NvbnN0IHQ9TWF0aC5yb3VuZCh0aGlzLnIqMjU1KSxpPU1hdGgucm91bmQodGhpcy5nKjI1NSkscz1NYXRoLnJvdW5kKHRoaXMuYioyNTUpO2lmKGUpcmV0dXJuIiMiK1guVG9IZXgodCkrWC5Ub0hleChpKStYLlRvSGV4KHMpO2NvbnN0IHI9TWF0aC5yb3VuZCh0aGlzLmEqMjU1KTtyZXR1cm4iIyIrWC5Ub0hleCh0KStYLlRvSGV4KGkpK1guVG9IZXgocykrWC5Ub0hleChyKX10b0xpbmVhclNwYWNlKCl7Y29uc3QgZT1uZXcgbWU7cmV0dXJuIHRoaXMudG9MaW5lYXJTcGFjZVRvUmVmKGUpLGV9dG9MaW5lYXJTcGFjZVRvUmVmKGUpe3JldHVybiBlLnI9TWF0aC5wb3codGhpcy5yLHllKSxlLmc9TWF0aC5wb3codGhpcy5nLHllKSxlLmI9TWF0aC5wb3codGhpcy5iLHllKSxlLmE9dGhpcy5hLHRoaXN9dG9HYW1tYVNwYWNlKCl7Y29uc3QgZT1uZXcgbWU7cmV0dXJuIHRoaXMudG9HYW1tYVNwYWNlVG9SZWYoZSksZX10b0dhbW1hU3BhY2VUb1JlZihlKXtyZXR1cm4gZS5yPU1hdGgucG93KHRoaXMucixTZSksZS5nPU1hdGgucG93KHRoaXMuZyxTZSksZS5iPU1hdGgucG93KHRoaXMuYixTZSksZS5hPXRoaXMuYSx0aGlzfXN0YXRpYyBGcm9tSGV4U3RyaW5nKGUpe2lmKGUuc3Vic3RyaW5nKDAsMSkhPT0iIyJ8fGUubGVuZ3RoIT09OSYmZS5sZW5ndGghPT03KXJldHVybiBuZXcgbWUoMCwwLDAsMCk7Y29uc3QgdD1wYXJzZUludChlLnN1YnN0cmluZygxLDMpLDE2KSxpPXBhcnNlSW50KGUuc3Vic3RyaW5nKDMsNSksMTYpLHM9cGFyc2VJbnQoZS5zdWJzdHJpbmcoNSw3KSwxNikscj1lLmxlbmd0aD09PTk/cGFyc2VJbnQoZS5zdWJzdHJpbmcoNyw5KSwxNik6MjU1O3JldHVybiBtZS5Gcm9tSW50cyh0LGkscyxyKX1zdGF0aWMgTGVycChlLHQsaSl7Y29uc3Qgcz1uZXcgbWUoMCwwLDAsMCk7cmV0dXJuIG1lLkxlcnBUb1JlZihlLHQsaSxzKSxzfXN0YXRpYyBMZXJwVG9SZWYoZSx0LGkscyl7cy5yPWUucisodC5yLWUucikqaSxzLmc9ZS5nKyh0LmctZS5nKSppLHMuYj1lLmIrKHQuYi1lLmIpKmkscy5hPWUuYSsodC5hLWUuYSkqaX1zdGF0aWMgSGVybWl0ZShlLHQsaSxzLHIpe2NvbnN0IG49cipyLGE9cipuLG89MiphLTMqbisxLGg9LTIqYSszKm4sbD1hLTIqbityLHU9YS1uLGQ9ZS5yKm8raS5yKmgrdC5yKmwrcy5yKnUsZj1lLmcqbytpLmcqaCt0LmcqbCtzLmcqdSxfPWUuYipvK2kuYipoK3QuYipsK3MuYip1LEU9ZS5hKm8raS5hKmgrdC5hKmwrcy5hKnU7cmV0dXJuIG5ldyBtZShkLGYsXyxFKX1zdGF0aWMgSGVybWl0ZTFzdERlcml2YXRpdmUoZSx0LGkscyxyKXtjb25zdCBuPW5ldyBtZTtyZXR1cm4gdGhpcy5IZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKSxufXN0YXRpYyBIZXJtaXRlMXN0RGVyaXZhdGl2ZVRvUmVmKGUsdCxpLHMscixuKXtjb25zdCBhPXIqcjtuLnI9KGEtcikqNiplLnIrKDMqYS00KnIrMSkqdC5yKygtYStyKSo2KmkucisoMyphLTIqcikqcy5yLG4uZz0oYS1yKSo2KmUuZysoMyphLTQqcisxKSp0LmcrKC1hK3IpKjYqaS5nKygzKmEtMipyKSpzLmcsbi5iPShhLXIpKjYqZS5iKygzKmEtNCpyKzEpKnQuYisoLWErcikqNippLmIrKDMqYS0yKnIpKnMuYixuLmE9KGEtcikqNiplLmErKDMqYS00KnIrMSkqdC5hKygtYStyKSo2KmkuYSsoMyphLTIqcikqcy5hfXN0YXRpYyBGcm9tQ29sb3IzKGUsdD0xKXtyZXR1cm4gbmV3IG1lKGUucixlLmcsZS5iLHQpfXN0YXRpYyBGcm9tQXJyYXkoZSx0PTApe3JldHVybiBuZXcgbWUoZVt0XSxlW3QrMV0sZVt0KzJdLGVbdCszXSl9c3RhdGljIEZyb21BcnJheVRvUmVmKGUsdD0wLGkpe2kucj1lW3RdLGkuZz1lW3QrMV0saS5iPWVbdCsyXSxpLmE9ZVt0KzNdfXN0YXRpYyBGcm9tSW50cyhlLHQsaSxzKXtyZXR1cm4gbmV3IG1lKGUvMjU1LHQvMjU1LGkvMjU1LHMvMjU1KX1zdGF0aWMgQ2hlY2tDb2xvcnM0KGUsdCl7aWYoZS5sZW5ndGg9PT10KjMpe2NvbnN0IGk9W107Zm9yKGxldCBzPTA7czxlLmxlbmd0aDtzKz0zKXtjb25zdCByPXMvMyo0O2lbcl09ZVtzXSxpW3IrMV09ZVtzKzFdLGlbcisyXT1lW3MrMl0saVtyKzNdPTF9cmV0dXJuIGl9cmV0dXJuIGV9fTtjbGFzcyBFaXt9RWkuQ29sb3IzPUJlLkJ1aWxkQXJyYXkoMyxyZS5CbGFjayksRWkuQ29sb3I0PUJlLkJ1aWxkQXJyYXkoMywoKT0+bmV3IG1lKDAsMCwwLDApKSxpdCgiQkFCWUxPTi5Db2xvcjMiLHJlKSxpdCgiQkFCWUxPTi5Db2xvcjQiLG1lKTtjb25zdCBpcj0oYyxlKT0+IWN8fGMuZ2V0Q2xhc3NOYW1lJiZjLmdldENsYXNzTmFtZSgpPT09Ik1lc2giP251bGw6Yy5nZXRDbGFzc05hbWUmJmMuZ2V0Q2xhc3NOYW1lKCk9PT0iU3ViTWVzaCI/Yy5jbG9uZShlKTpjLmNsb25lP2MuY2xvbmUoKTpudWxsO2Z1bmN0aW9uIHBuKGMpe2NvbnN0IGU9W107ZG8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYykuZm9yRWFjaChmdW5jdGlvbih0KXtlLmluZGV4T2YodCk9PT0tMSYmZS5wdXNoKHQpfSk7d2hpbGUoYz1PYmplY3QuZ2V0UHJvdG90eXBlT2YoYykpO3JldHVybiBlfWNsYXNzIHZze3N0YXRpYyBEZWVwQ29weShlLHQsaSxzKXtjb25zdCByPXBuKGUpO2Zvcihjb25zdCBuIG9mIHIpe2lmKG5bMF09PT0iXyImJighc3x8cy5pbmRleE9mKG4pPT09LTEpfHxuLmVuZHNXaXRoKCJPYnNlcnZhYmxlIil8fGkmJmkuaW5kZXhPZihuKSE9PS0xKWNvbnRpbnVlO2NvbnN0IGE9ZVtuXSxvPXR5cGVvZiBhO2lmKG8hPT0iZnVuY3Rpb24iKXRyeXtpZihvPT09Im9iamVjdCIpaWYoYSBpbnN0YW5jZW9mIEFycmF5KXtpZih0W25dPVtdLGEubGVuZ3RoPjApaWYodHlwZW9mIGFbMF09PSJvYmplY3QiKWZvcihsZXQgaD0wO2g8YS5sZW5ndGg7aCsrKXtjb25zdCBsPWlyKGFbaF0sdCk7dFtuXS5pbmRleE9mKGwpPT09LTEmJnRbbl0ucHVzaChsKX1lbHNlIHRbbl09YS5zbGljZSgwKX1lbHNlIHRbbl09aXIoYSx0KTtlbHNlIHRbbl09YX1jYXRjaChoKXtPLldhcm4oaC5tZXNzYWdlKX19fX1mdW5jdGlvbiBtbigpe3JldHVybiB0eXBlb2YgX25hdGl2ZTwidSImJl9uYXRpdmUuWE1MSHR0cFJlcXVlc3Q/bmV3IF9uYXRpdmUuWE1MSHR0cFJlcXVlc3Q6bmV3IFhNTEh0dHBSZXF1ZXN0fWNsYXNzIGN0e2NvbnN0cnVjdG9yKCl7dGhpcy5feGhyPW1uKCksdGhpcy5fcmVxdWVzdFVSTD0iIn1faW5qZWN0Q3VzdG9tUmVxdWVzdEhlYWRlcnMoKXtpZighdGhpcy5fc2hvdWxkU2tpcFJlcXVlc3RNb2RpZmljYXRpb25zKHRoaXMuX3JlcXVlc3RVUkwpKWZvcihjb25zdCBlIGluIGN0LkN1c3RvbVJlcXVlc3RIZWFkZXJzKXtjb25zdCB0PWN0LkN1c3RvbVJlcXVlc3RIZWFkZXJzW2VdO3QmJnRoaXMuX3hoci5zZXRSZXF1ZXN0SGVhZGVyKGUsdCl9fV9zaG91bGRTa2lwUmVxdWVzdE1vZGlmaWNhdGlvbnMoZSl7cmV0dXJuIGN0LlNraXBSZXF1ZXN0TW9kaWZpY2F0aW9uRm9yQmFieWxvbkNETiYmKGUuaW5jbHVkZXMoInByZXZpZXcuYmFieWxvbmpzLmNvbSIpfHxlLmluY2x1ZGVzKCJjZG4uYmFieWxvbmpzLmNvbSIpKX1nZXQgb25wcm9ncmVzcygpe3JldHVybiB0aGlzLl94aHIub25wcm9ncmVzc31zZXQgb25wcm9ncmVzcyhlKXt0aGlzLl94aHIub25wcm9ncmVzcz1lfWdldCByZWFkeVN0YXRlKCl7cmV0dXJuIHRoaXMuX3hoci5yZWFkeVN0YXRlfWdldCBzdGF0dXMoKXtyZXR1cm4gdGhpcy5feGhyLnN0YXR1c31nZXQgc3RhdHVzVGV4dCgpe3JldHVybiB0aGlzLl94aHIuc3RhdHVzVGV4dH1nZXQgcmVzcG9uc2UoKXtyZXR1cm4gdGhpcy5feGhyLnJlc3BvbnNlfWdldCByZXNwb25zZVVSTCgpe3JldHVybiB0aGlzLl94aHIucmVzcG9uc2VVUkx9Z2V0IHJlc3BvbnNlVGV4dCgpe3JldHVybiB0aGlzLl94aHIucmVzcG9uc2VUZXh0fWdldCByZXNwb25zZVR5cGUoKXtyZXR1cm4gdGhpcy5feGhyLnJlc3BvbnNlVHlwZX1zZXQgcmVzcG9uc2VUeXBlKGUpe3RoaXMuX3hoci5yZXNwb25zZVR5cGU9ZX1nZXQgdGltZW91dCgpe3JldHVybiB0aGlzLl94aHIudGltZW91dH1zZXQgdGltZW91dChlKXt0aGlzLl94aHIudGltZW91dD1lfWFkZEV2ZW50TGlzdGVuZXIoZSx0LGkpe3RoaXMuX3hoci5hZGRFdmVudExpc3RlbmVyKGUsdCxpKX1yZW1vdmVFdmVudExpc3RlbmVyKGUsdCxpKXt0aGlzLl94aHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHQsaSl9YWJvcnQoKXt0aGlzLl94aHIuYWJvcnQoKX1zZW5kKGUpe2N0LkN1c3RvbVJlcXVlc3RIZWFkZXJzJiZ0aGlzLl9pbmplY3RDdXN0b21SZXF1ZXN0SGVhZGVycygpLHRoaXMuX3hoci5zZW5kKGUpfW9wZW4oZSx0KXtmb3IoY29uc3QgaSBvZiBjdC5DdXN0b21SZXF1ZXN0TW9kaWZpZXJzKXtpZih0aGlzLl9zaG91bGRTa2lwUmVxdWVzdE1vZGlmaWNhdGlvbnModCkpcmV0dXJuO2kodGhpcy5feGhyLHQpfXJldHVybiB0PXQucmVwbGFjZSgiZmlsZTpodHRwOiIsImh0dHA6IiksdD10LnJlcGxhY2UoImZpbGU6aHR0cHM6IiwiaHR0cHM6IiksdGhpcy5fcmVxdWVzdFVSTD10LHRoaXMuX3hoci5vcGVuKGUsdCwhMCl9c2V0UmVxdWVzdEhlYWRlcihlLHQpe3RoaXMuX3hoci5zZXRSZXF1ZXN0SGVhZGVyKGUsdCl9Z2V0UmVzcG9uc2VIZWFkZXIoZSl7cmV0dXJuIHRoaXMuX3hoci5nZXRSZXNwb25zZUhlYWRlcihlKX19Y3QuQ3VzdG9tUmVxdWVzdEhlYWRlcnM9e30sY3QuQ3VzdG9tUmVxdWVzdE1vZGlmaWVycz1uZXcgQXJyYXksY3QuU2tpcFJlcXVlc3RNb2RpZmljYXRpb25Gb3JCYWJ5bG9uQ0ROPSEwO2NsYXNzIEZpe31GaS5GaWxlc1RvTG9hZD17fTtjbGFzcyBFbntzdGF0aWMgRXhwb25lbnRpYWxCYWNrb2ZmKGU9Myx0PTUwMCl7cmV0dXJuKGkscyxyKT0+cy5zdGF0dXMhPT0wfHxyPj1lfHxpLmluZGV4T2YoImZpbGU6IikhPT0tMT8tMTpNYXRoLnBvdygyLHIpKnR9fWNsYXNzIHZpIGV4dGVuZHMgRXJyb3J7fXZpLl9zZXRQcm90b3R5cGVPZj1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fCgoYyxlKT0+KGMuX19wcm90b19fPWUsYykpO2NvbnN0IG9pPXtNZXNoSW52YWxpZFBvc2l0aW9uc0Vycm9yOjAsVW5zdXBwb3J0ZWRUZXh0dXJlRXJyb3I6MWUzLEdMVEZMb2FkZXJVbmV4cGVjdGVkTWFnaWNFcnJvcjoyZTMsU2NlbmVMb2FkZXJFcnJvcjozZTMsTG9hZEZpbGVFcnJvcjo0ZTMsUmVxdWVzdEZpbGVFcnJvcjo0MDAxLFJlYWRGaWxlRXJyb3I6NDAwMn07Y2xhc3MgTnQgZXh0ZW5kcyB2aXtjb25zdHJ1Y3RvcihlLHQsaSl7c3VwZXIoZSksdGhpcy5lcnJvckNvZGU9dCx0aGlzLmlubmVyRXJyb3I9aSx0aGlzLm5hbWU9IlJ1bnRpbWVFcnJvciIsdmkuX3NldFByb3RvdHlwZU9mKHRoaXMsTnQucHJvdG90eXBlKX19Y29uc3Qgc3I9Yz0+e2NvbnN0IGU9IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89IjtsZXQgdD0iIixpLHMscixuLGEsbyxoLGw9MDtjb25zdCB1PUFycmF5QnVmZmVyLmlzVmlldyhjKT9uZXcgVWludDhBcnJheShjLmJ1ZmZlcixjLmJ5dGVPZmZzZXQsYy5ieXRlTGVuZ3RoKTpuZXcgVWludDhBcnJheShjKTtmb3IoO2w8dS5sZW5ndGg7KWk9dVtsKytdLHM9bDx1Lmxlbmd0aD91W2wrK106TnVtYmVyLk5hTixyPWw8dS5sZW5ndGg/dVtsKytdOk51bWJlci5OYU4sbj1pPj4yLGE9KGkmMyk8PDR8cz4+NCxvPShzJjE1KTw8MnxyPj42LGg9ciY2Myxpc05hTihzKT9vPWg9NjQ6aXNOYU4ocikmJihoPTY0KSx0Kz1lLmNoYXJBdChuKStlLmNoYXJBdChhKStlLmNoYXJBdChvKStlLmNoYXJBdChoKTtyZXR1cm4gdH0scnI9Yz0+YXRvYihjKSx2bj1jPT57Y29uc3QgZT1ycihjKSx0PWUubGVuZ3RoLGk9bmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5QnVmZmVyKHQpKTtmb3IobGV0IHM9MDtzPHQ7cysrKWlbc109ZS5jaGFyQ29kZUF0KHMpO3JldHVybiBpLmJ1ZmZlcn07Y2xhc3MgWGl7c3RhdGljIFNldEltbWVkaWF0ZShlKXtqZSgpJiZ3aW5kb3cuc2V0SW1tZWRpYXRlP3dpbmRvdy5zZXRJbW1lZGlhdGUoZSk6c2V0VGltZW91dChlLDEpfX1jb25zdCBucj1uZXcgUmVnRXhwKC9eZGF0YTooW14sXStcL1teLF0rKT87YmFzZTY0LC9pKTtjbGFzcyBIaSBleHRlbmRzIE50e2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIoZSxvaS5Mb2FkRmlsZUVycm9yKSx0aGlzLm5hbWU9IkxvYWRGaWxlRXJyb3IiLHZpLl9zZXRQcm90b3R5cGVPZih0aGlzLEhpLnByb3RvdHlwZSksdCBpbnN0YW5jZW9mIGN0P3RoaXMucmVxdWVzdD10OnRoaXMuZmlsZT10fX1jbGFzcyBLaSBleHRlbmRzIE50e2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIoZSxvaS5SZXF1ZXN0RmlsZUVycm9yKSx0aGlzLnJlcXVlc3Q9dCx0aGlzLm5hbWU9IlJlcXVlc3RGaWxlRXJyb3IiLHZpLl9zZXRQcm90b3R5cGVPZih0aGlzLEtpLnByb3RvdHlwZSl9fWNsYXNzIFRzIGV4dGVuZHMgTnR7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLG9pLlJlYWRGaWxlRXJyb3IpLHRoaXMuZmlsZT10LHRoaXMubmFtZT0iUmVhZEZpbGVFcnJvciIsdmkuX3NldFByb3RvdHlwZU9mKHRoaXMsVHMucHJvdG90eXBlKX19Y29uc3QgcWU9e0RlZmF1bHRSZXRyeVN0cmF0ZWd5OkVuLkV4cG9uZW50aWFsQmFja29mZigpLEJhc2VVcmw6IiIsQ29yc0JlaGF2aW9yOiJhbm9ueW1vdXMiLFByZXByb2Nlc3NVcmw6Yz0+Y30sYXI9Yz0+KGM9Yy5yZXBsYWNlKC8jL2dtLCIlMjMiKSxjKSxicz0oYyxlKT0+e2lmKCEoYyYmYy5pbmRleE9mKCJkYXRhOiIpPT09MCkmJnFlLkNvcnNCZWhhdmlvcilpZih0eXBlb2YgcWUuQ29yc0JlaGF2aW9yPT0ic3RyaW5nInx8cWUuQ29yc0JlaGF2aW9yIGluc3RhbmNlb2YgU3RyaW5nKWUuY3Jvc3NPcmlnaW49cWUuQ29yc0JlaGF2aW9yO2Vsc2V7Y29uc3QgdD1xZS5Db3JzQmVoYXZpb3IoYyk7dCYmKGUuY3Jvc3NPcmlnaW49dCl9fSxTcz0oYyxlLHQsaSxzPSIiLHIpPT57dmFyIG47bGV0IGEsbz0hMTtjIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fEFycmF5QnVmZmVyLmlzVmlldyhjKT90eXBlb2YgQmxvYjwidSImJnR5cGVvZiBVUkw8InUiPyhhPVVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2NdLHt0eXBlOnN9KSksbz0hMCk6YT1gZGF0YToke3N9O2Jhc2U2NCxgK3NyKGMpOmMgaW5zdGFuY2VvZiBCbG9iPyhhPVVSTC5jcmVhdGVPYmplY3RVUkwoYyksbz0hMCk6KGE9YXIoYyksYT1xZS5QcmVwcm9jZXNzVXJsKGMpKTtjb25zdCBoPWZlLkxhc3RDcmVhdGVkRW5naW5lLGw9Yj0+e2lmKHQpe2NvbnN0IE09YXx8Yy50b1N0cmluZygpO3QoYEVycm9yIHdoaWxlIHRyeWluZyB0byBsb2FkIGltYWdlOiAke00uaW5kZXhPZigiaHR0cCIpPT09MHx8TS5sZW5ndGg8PTEyOD9NOk0uc2xpY2UoMCwxMjgpKyIuLi4ifWAsYil9fTtpZih0eXBlb2YgSW1hZ2U+InUifHwobj1oPT1udWxsP3ZvaWQgMDpoLl9mZWF0dXJlcy5mb3JjZUJpdG1hcE92ZXJIVE1MSW1hZ2VFbGVtZW50KSE9PW51bGwmJm4hPT12b2lkIDAmJm4pcmV0dXJuIGp0KGEsYj0+e2guY3JlYXRlSW1hZ2VCaXRtYXAobmV3IEJsb2IoW2JdLHt0eXBlOnN9KSx7cHJlbXVsdGlwbHlBbHBoYToibm9uZSIsLi4ucn0pLnRoZW4oTT0+e2UoTSksbyYmVVJMLnJldm9rZU9iamVjdFVSTChhKX0pLmNhdGNoKE09Pnt0JiZ0KCJFcnJvciB3aGlsZSB0cnlpbmcgdG8gbG9hZCBpbWFnZTogIitjLE0pfSl9LHZvaWQgMCxpfHx2b2lkIDAsITAsKGIsTSk9PntsKE0pfSksbnVsbDtjb25zdCB1PW5ldyBJbWFnZTticyhhLHUpO2NvbnN0IGQ9W10sZj0oKT0+e2QuZm9yRWFjaChiPT57Yi50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihiLm5hbWUsYi5oYW5kbGVyKX0pfSxfPSgpPT57ZC5mb3JFYWNoKGI9PntiLnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGIubmFtZSxiLmhhbmRsZXIpfSksZC5sZW5ndGg9MH0sRT0oKT0+e18oKSxlKHUpLG8mJnUuc3JjJiZVUkwucmV2b2tlT2JqZWN0VVJMKHUuc3JjKX0sbT1iPT57XygpLGwoYiksbyYmdS5zcmMmJlVSTC5yZXZva2VPYmplY3RVUkwodS5zcmMpfSx2PWI9PntfKCk7Y29uc3QgTT1uZXcgRXJyb3IoYENTUCB2aW9sYXRpb24gb2YgcG9saWN5ICR7Yi5lZmZlY3RpdmVEaXJlY3RpdmV9ICR7Yi5ibG9ja2VkVVJJfS4gQ3VycmVudCBwb2xpY3kgaXMgJHtiLm9yaWdpbmFsUG9saWN5fWApO2ZlLlVzZUZhbGxiYWNrVGV4dHVyZT0hMSxsKE0pLG8mJnUuc3JjJiZVUkwucmV2b2tlT2JqZWN0VVJMKHUuc3JjKSx1LnNyYz0iIn07ZC5wdXNoKHt0YXJnZXQ6dSxuYW1lOiJsb2FkIixoYW5kbGVyOkV9KSxkLnB1c2goe3RhcmdldDp1LG5hbWU6ImVycm9yIixoYW5kbGVyOm19KSxkLnB1c2goe3RhcmdldDpkb2N1bWVudCxuYW1lOiJzZWN1cml0eXBvbGljeXZpb2xhdGlvbiIsaGFuZGxlcjp2fSksZigpO2NvbnN0IFM9YS5zdWJzdHJpbmcoMCw1KT09PSJibG9iOiIseT1hLnN1YnN0cmluZygwLDUpPT09ImRhdGE6IixBPSgpPT57U3x8eT91LnNyYz1hOmp0KGEsKGIsTSxMKT0+e2NvbnN0IGs9IXMmJkw/TDpzLHc9bmV3IEJsb2IoW2JdLHt0eXBlOmt9KSxkZT1VUkwuY3JlYXRlT2JqZWN0VVJMKHcpO289ITAsdS5zcmM9ZGV9LHZvaWQgMCxpfHx2b2lkIDAsITAsKGIsTSk9PntsKE0pfSl9LEM9KCk9PntpJiZpLmxvYWRJbWFnZShhLHUpfTtpZighUyYmIXkmJmkmJmkuZW5hYmxlVGV4dHVyZXNPZmZsaW5lKWkub3BlbihDLEEpO2Vsc2V7aWYoYS5pbmRleE9mKCJmaWxlOiIpIT09LTEpe2NvbnN0IGI9ZGVjb2RlVVJJQ29tcG9uZW50KGEuc3Vic3RyaW5nKDUpLnRvTG93ZXJDYXNlKCkpO2lmKEZpLkZpbGVzVG9Mb2FkW2JdJiZ0eXBlb2YgVVJMPCJ1Iil7dHJ5e2xldCBNO3RyeXtNPVVSTC5jcmVhdGVPYmplY3RVUkwoRmkuRmlsZXNUb0xvYWRbYl0pfWNhdGNoe009VVJMLmNyZWF0ZU9iamVjdFVSTChGaS5GaWxlc1RvTG9hZFtiXSl9dS5zcmM9TSxvPSEwfWNhdGNoe3Uuc3JjPSIifXJldHVybiB1fX1BKCl9cmV0dXJuIHV9LHdpPShjLGUsdCxpLHMpPT57Y29uc3Qgcj1uZXcgRmlsZVJlYWRlcixuPXtvbkNvbXBsZXRlT2JzZXJ2YWJsZTpuZXcgRixhYm9ydDooKT0+ci5hYm9ydCgpfTtyZXR1cm4gci5vbmxvYWRlbmQ9KCk9Pm4ub25Db21wbGV0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKG4pLHMmJihyLm9uZXJyb3I9KCk9PntzKG5ldyBUcyhgVW5hYmxlIHRvIHJlYWQgJHtjLm5hbWV9YCxjKSl9KSxyLm9ubG9hZD1hPT57ZShhLnRhcmdldC5yZXN1bHQpfSx0JiYoci5vbnByb2dyZXNzPXQpLGk/ci5yZWFkQXNBcnJheUJ1ZmZlcihjKTpyLnJlYWRBc1RleHQoYyksbn0sanQ9KGMsZSx0LGkscyxyLG4pPT57aWYoYy5uYW1lKXJldHVybiB3aShjLGUsdCxzLHI/bD0+e3Iodm9pZCAwLGwpfTp2b2lkIDApO2NvbnN0IGE9YztpZihhLmluZGV4T2YoImZpbGU6IikhPT0tMSl7bGV0IGw9ZGVjb2RlVVJJQ29tcG9uZW50KGEuc3Vic3RyaW5nKDUpLnRvTG93ZXJDYXNlKCkpO2wuaW5kZXhPZigiLi8iKT09PTAmJihsPWwuc3Vic3RyaW5nKDIpKTtjb25zdCB1PUZpLkZpbGVzVG9Mb2FkW2xdO2lmKHUpcmV0dXJuIHdpKHUsZSx0LHMscj9kPT5yKHZvaWQgMCxuZXcgSGkoZC5tZXNzYWdlLGQuZmlsZSkpOnZvaWQgMCl9Y29uc3R7bWF0Y2g6byx0eXBlOmh9PVRuKGEpO2lmKG8pe2NvbnN0IGw9e29uQ29tcGxldGVPYnNlcnZhYmxlOm5ldyBGLGFib3J0OigpPT4oKT0+e319O3RyeXtjb25zdCB1PXM/QXMoYSk6aHIoYSk7ZSh1LHZvaWQgMCxoKX1jYXRjaCh1KXtyP3Iodm9pZCAwLHUpOk8uRXJyb3IodS5tZXNzYWdlfHwiRmFpbGVkIHRvIHBhcnNlIHRoZSBEYXRhIFVSTCIpfXJldHVybiBYaS5TZXRJbW1lZGlhdGUoKCk9PntsLm9uQ29tcGxldGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhsKX0pLGx9cmV0dXJuIHhzKGEsKGwsdSk9PntlKGwsdT09bnVsbD92b2lkIDA6dS5yZXNwb25zZVVSTCx1PT1udWxsP3ZvaWQgMDp1LmdldFJlc3BvbnNlSGVhZGVyKCJjb250ZW50LXR5cGUiKSl9LHQsaSxzLHI/bD0+e3IobC5yZXF1ZXN0LG5ldyBIaShsLm1lc3NhZ2UsbC5yZXF1ZXN0KSl9OnZvaWQgMCxuKX0seHM9KGMsZSx0LGkscyxyLG4pPT57Yz1hcihjKSxjPXFlLlByZXByb2Nlc3NVcmwoYyk7Y29uc3QgYT1xZS5CYXNlVXJsK2M7bGV0IG89ITE7Y29uc3QgaD17b25Db21wbGV0ZU9ic2VydmFibGU6bmV3IEYsYWJvcnQ6KCk9Pm89ITB9LGw9KCk9PntsZXQgdT1uZXcgY3QsZD1udWxsLGY7Y29uc3QgXz0oKT0+e3UmJih0JiZ1LnJlbW92ZUV2ZW50TGlzdGVuZXIoInByb2dyZXNzIix0KSxmJiZ1LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLGYpLHUucmVtb3ZlRXZlbnRMaXN0ZW5lcigibG9hZGVuZCIsRSkpfTtsZXQgRT0oKT0+e18oKSxoLm9uQ29tcGxldGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhoKSxoLm9uQ29tcGxldGVPYnNlcnZhYmxlLmNsZWFyKCksdD12b2lkIDAsZj1udWxsLEU9bnVsbCxyPXZvaWQgMCxuPXZvaWQgMCxlPXZvaWQgMH07aC5hYm9ydD0oKT0+e289ITAsRSYmRSgpLHUmJnUucmVhZHlTdGF0ZSE9PShYTUxIdHRwUmVxdWVzdC5ET05FfHw0KSYmdS5hYm9ydCgpLGQhPT1udWxsJiYoY2xlYXJUaW1lb3V0KGQpLGQ9bnVsbCksdT1udWxsfTtjb25zdCBtPVM9Pntjb25zdCB5PVMubWVzc2FnZXx8IlVua25vd24gZXJyb3IiO3ImJnU/cihuZXcgS2koeSx1KSk6Ty5FcnJvcih5KX0sdj1TPT57aWYodSl7aWYodS5vcGVuKCJHRVQiLGEpLG4pdHJ5e24odSl9Y2F0Y2goeSl7bSh5KTtyZXR1cm59cyYmKHUucmVzcG9uc2VUeXBlPSJhcnJheWJ1ZmZlciIpLHQmJnUuYWRkRXZlbnRMaXN0ZW5lcigicHJvZ3Jlc3MiLHQpLEUmJnUuYWRkRXZlbnRMaXN0ZW5lcigibG9hZGVuZCIsRSksZj0oKT0+e2lmKCEob3x8IXUpJiZ1LnJlYWR5U3RhdGU9PT0oWE1MSHR0cFJlcXVlc3QuRE9ORXx8NCkpe2lmKGYmJnUucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVhZHlzdGF0ZWNoYW5nZSIsZiksdS5zdGF0dXM+PTIwMCYmdS5zdGF0dXM8MzAwfHx1LnN0YXR1cz09PTAmJighamUoKXx8b3IoKSkpe3RyeXtlJiZlKHM/dS5yZXNwb25zZTp1LnJlc3BvbnNlVGV4dCx1KX1jYXRjaChDKXttKEMpfXJldHVybn1jb25zdCB5PXFlLkRlZmF1bHRSZXRyeVN0cmF0ZWd5O2lmKHkpe2NvbnN0IEM9eShhLHUsUyk7aWYoQyE9PS0xKXtfKCksdT1uZXcgY3QsZD1zZXRUaW1lb3V0KCgpPT52KFMrMSksQyk7cmV0dXJufX1jb25zdCBBPW5ldyBLaSgiRXJyb3Igc3RhdHVzOiAiK3Uuc3RhdHVzKyIgIit1LnN0YXR1c1RleHQrIiAtIFVuYWJsZSB0byBsb2FkICIrYSx1KTtyJiZyKEEpfX0sdS5hZGRFdmVudExpc3RlbmVyKCJyZWFkeXN0YXRlY2hhbmdlIixmKSx1LnNlbmQoKX19O3YoMCl9O2lmKGkmJmkuZW5hYmxlU2NlbmVPZmZsaW5lKXtjb25zdCB1PWY9PntmJiZmLnN0YXR1cz40MDA/ciYmcihmKTpsKCl9LGQ9KCk9PntpJiZpLmxvYWRGaWxlKHFlLkJhc2VVcmwrYyxmPT57IW8mJmUmJmUoZiksaC5vbkNvbXBsZXRlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoaCl9LHQ/Zj0+eyFvJiZ0JiZ0KGYpfTp2b2lkIDAsdSxzKX07aS5vcGVuKGQsdSl9ZWxzZSBsKCk7cmV0dXJuIGh9LG9yPSgpPT50eXBlb2YgbG9jYXRpb248InUiJiZsb2NhdGlvbi5wcm90b2NvbD09PSJmaWxlOiIsTXM9Yz0+bnIudGVzdChjKSxUbj1jPT57Y29uc3QgZT1uci5leGVjKGMpO3JldHVybiBlPT09bnVsbHx8ZS5sZW5ndGg9PT0wP3ttYXRjaDohMSx0eXBlOiIifTp7bWF0Y2g6ITAsdHlwZTplWzBdLnJlcGxhY2UoImRhdGE6IiwiIikucmVwbGFjZSgiYmFzZTY0LCIsIiIpfX07ZnVuY3Rpb24gQXMoYyl7cmV0dXJuIHZuKGMuc3BsaXQoIiwiKVsxXSl9Y29uc3QgaHI9Yz0+cnIoYy5zcGxpdCgiLCIpWzFdKTsoKCk9PntvZS5fRmlsZVRvb2xzTG9hZEltYWdlPVNzLG9lLl9GaWxlVG9vbHNMb2FkRmlsZT1qdCxuaS5fRmlsZVRvb2xzTG9hZEZpbGU9anR9KSgpO2xldCBPaTsoKGMsZSx0LGkscyxyLG4sYSxvLGgpPT57T2k9e0RlY29kZUJhc2U2NFVybFRvQmluYXJ5OmMsRGVjb2RlQmFzZTY0VXJsVG9TdHJpbmc6ZSxEZWZhdWx0UmV0cnlTdHJhdGVneTp0LkRlZmF1bHRSZXRyeVN0cmF0ZWd5LEJhc2VVcmw6dC5CYXNlVXJsLENvcnNCZWhhdmlvcjp0LkNvcnNCZWhhdmlvcixQcmVwcm9jZXNzVXJsOnQuUHJlcHJvY2Vzc1VybCxJc0Jhc2U2NERhdGFVcmw6aSxJc0ZpbGVVUkw6cyxMb2FkRmlsZTpyLExvYWRJbWFnZTpuLFJlYWRGaWxlOmEsUmVxdWVzdEZpbGU6byxTZXRDb3JzQmVoYXZpb3I6aH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KE9pLCJEZWZhdWx0UmV0cnlTdHJhdGVneSIse2dldDpmdW5jdGlvbigpe3JldHVybiB0LkRlZmF1bHRSZXRyeVN0cmF0ZWd5fSxzZXQ6ZnVuY3Rpb24obCl7dC5EZWZhdWx0UmV0cnlTdHJhdGVneT1sfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPaSwiQmFzZVVybCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0LkJhc2VVcmx9LHNldDpmdW5jdGlvbihsKXt0LkJhc2VVcmw9bH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoT2ksIlByZXByb2Nlc3NVcmwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5QcmVwcm9jZXNzVXJsfSxzZXQ6ZnVuY3Rpb24obCl7dC5QcmVwcm9jZXNzVXJsPWx9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KE9pLCJDb3JzQmVoYXZpb3IiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdC5Db3JzQmVoYXZpb3J9LHNldDpmdW5jdGlvbihsKXt0LkNvcnNCZWhhdmlvcj1sfX0pfSkoQXMsaHIscWUsTXMsb3IsanQsU3Msd2kseHMsYnMpO2NsYXNzIExpe3N0YXRpYyBJbnN0YW50aWF0ZShlKXtpZih0aGlzLlJlZ2lzdGVyZWRFeHRlcm5hbENsYXNzZXMmJnRoaXMuUmVnaXN0ZXJlZEV4dGVybmFsQ2xhc3Nlc1tlXSlyZXR1cm4gdGhpcy5SZWdpc3RlcmVkRXh0ZXJuYWxDbGFzc2VzW2VdO2NvbnN0IHQ9cmkoZSk7aWYodClyZXR1cm4gdDtPLldhcm4oZSsiIG5vdCBmb3VuZCwgeW91IG1heSBoYXZlIG1pc3NlZCBhbiBpbXBvcnQuIik7Y29uc3QgaT1lLnNwbGl0KCIuIik7bGV0IHM9d2luZG93fHx0aGlzO2ZvcihsZXQgcj0wLG49aS5sZW5ndGg7cjxuO3IrKylzPXNbaVtyXV07cmV0dXJuIHR5cGVvZiBzIT0iZnVuY3Rpb24iP251bGw6c319TGkuUmVnaXN0ZXJlZEV4dGVybmFsQ2xhc3Nlcz17fTtmdW5jdGlvbiBscigpe3JldHVybiJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgiLnJlcGxhY2UoL1t4eV0vZyxjPT57Y29uc3QgZT1NYXRoLnJhbmRvbSgpKjE2fDA7cmV0dXJuKGM9PT0ieCI/ZTplJjN8OCkudG9TdHJpbmcoMTYpfSl9Y2xhc3MgSHtzdGF0aWMgZ2V0IEJhc2VVcmwoKXtyZXR1cm4gcWUuQmFzZVVybH1zdGF0aWMgc2V0IEJhc2VVcmwoZSl7cWUuQmFzZVVybD1lfXN0YXRpYyBnZXQgRGVmYXVsdFJldHJ5U3RyYXRlZ3koKXtyZXR1cm4gcWUuRGVmYXVsdFJldHJ5U3RyYXRlZ3l9c3RhdGljIHNldCBEZWZhdWx0UmV0cnlTdHJhdGVneShlKXtxZS5EZWZhdWx0UmV0cnlTdHJhdGVneT1lfXN0YXRpYyBnZXQgQ29yc0JlaGF2aW9yKCl7cmV0dXJuIHFlLkNvcnNCZWhhdmlvcn1zdGF0aWMgc2V0IENvcnNCZWhhdmlvcihlKXtxZS5Db3JzQmVoYXZpb3I9ZX1zdGF0aWMgZ2V0IFVzZUZhbGxiYWNrVGV4dHVyZSgpe3JldHVybiBmZS5Vc2VGYWxsYmFja1RleHR1cmV9c3RhdGljIHNldCBVc2VGYWxsYmFja1RleHR1cmUoZSl7ZmUuVXNlRmFsbGJhY2tUZXh0dXJlPWV9c3RhdGljIGdldCBSZWdpc3RlcmVkRXh0ZXJuYWxDbGFzc2VzKCl7cmV0dXJuIExpLlJlZ2lzdGVyZWRFeHRlcm5hbENsYXNzZXN9c3RhdGljIHNldCBSZWdpc3RlcmVkRXh0ZXJuYWxDbGFzc2VzKGUpe0xpLlJlZ2lzdGVyZWRFeHRlcm5hbENsYXNzZXM9ZX1zdGF0aWMgZ2V0IGZhbGxiYWNrVGV4dHVyZSgpe3JldHVybiBmZS5GYWxsYmFja1RleHR1cmV9c3RhdGljIHNldCBmYWxsYmFja1RleHR1cmUoZSl7ZmUuRmFsbGJhY2tUZXh0dXJlPWV9c3RhdGljIEZldGNoVG9SZWYoZSx0LGkscyxyLG4pe2NvbnN0IGE9TWF0aC5hYnMoZSkqaSVpfDAsbz1NYXRoLmFicyh0KSpzJXN8MCxoPShhK28qaSkqNDtuLnI9cltoXS8yNTUsbi5nPXJbaCsxXS8yNTUsbi5iPXJbaCsyXS8yNTUsbi5hPXJbaCszXS8yNTV9c3RhdGljIE1peChlLHQsaSl7cmV0dXJuIGUqKDEtaSkrdCppfXN0YXRpYyBJbnN0YW50aWF0ZShlKXtyZXR1cm4gTGkuSW5zdGFudGlhdGUoZSl9c3RhdGljIFNldEltbWVkaWF0ZShlKXtYaS5TZXRJbW1lZGlhdGUoZSl9c3RhdGljIElzRXhwb25lbnRPZlR3byhlKXtsZXQgdD0xO2RvIHQqPTI7d2hpbGUodDxlKTtyZXR1cm4gdD09PWV9c3RhdGljIEZsb2F0Um91bmQoZSl7cmV0dXJuIE1hdGguZnJvdW5kP01hdGguZnJvdW5kKGUpOihILl9UbXBGbG9hdEFycmF5WzBdPWUsSC5fVG1wRmxvYXRBcnJheVswXSl9c3RhdGljIEdldEZpbGVuYW1lKGUpe2NvbnN0IHQ9ZS5sYXN0SW5kZXhPZigiLyIpO3JldHVybiB0PDA/ZTplLnN1YnN0cmluZyh0KzEpfXN0YXRpYyBHZXRGb2xkZXJQYXRoKGUsdD0hMSl7Y29uc3QgaT1lLmxhc3RJbmRleE9mKCIvIik7cmV0dXJuIGk8MD90P2U6IiI6ZS5zdWJzdHJpbmcoMCxpKzEpfXN0YXRpYyBUb0RlZ3JlZXMoZSl7cmV0dXJuIGUqMTgwL01hdGguUEl9c3RhdGljIFRvUmFkaWFucyhlKXtyZXR1cm4gZSpNYXRoLlBJLzE4MH1zdGF0aWMgU21vb3RoQW5nbGVDaGFuZ2UoZSx0LGk9Ljkpe2NvbnN0IHM9dGhpcy5Ub1JhZGlhbnMoZSkscj10aGlzLlRvUmFkaWFucyh0KTtyZXR1cm4gdGhpcy5Ub0RlZ3JlZXMoTWF0aC5hdGFuMigoMS1pKSpNYXRoLnNpbihyKStpKk1hdGguc2luKHMpLCgxLWkpKk1hdGguY29zKHIpK2kqTWF0aC5jb3MocykpKX1zdGF0aWMgTWFrZUFycmF5KGUsdCl7cmV0dXJuIHQhPT0hMCYmKGU9PT12b2lkIDB8fGU9PW51bGwpP251bGw6QXJyYXkuaXNBcnJheShlKT9lOltlXX1zdGF0aWMgR2V0UG9pbnRlclByZWZpeChlKXtsZXQgdD0icG9pbnRlciI7cmV0dXJuIGplKCkmJiF3aW5kb3cuUG9pbnRlckV2ZW50JiYodD0ibW91c2UiKSxlLl9iYWREZXNrdG9wT1MmJiFlLl9iYWRPUyYmIShkb2N1bWVudCYmIm9udG91Y2hlbmQiaW4gZG9jdW1lbnQpJiYodD0ibW91c2UiKSx0fXN0YXRpYyBTZXRDb3JzQmVoYXZpb3IoZSx0KXticyhlLHQpfXN0YXRpYyBTZXRSZWZlcnJlclBvbGljeUJlaGF2aW9yKGUsdCl7dC5yZWZlcnJlclBvbGljeT1lfXN0YXRpYyBDbGVhblVybChlKXtyZXR1cm4gZT1lLnJlcGxhY2UoLyMvZ20sIiUyMyIpLGV9c3RhdGljIGdldCBQcmVwcm9jZXNzVXJsKCl7cmV0dXJuIHFlLlByZXByb2Nlc3NVcmx9c3RhdGljIHNldCBQcmVwcm9jZXNzVXJsKGUpe3FlLlByZXByb2Nlc3NVcmw9ZX1zdGF0aWMgTG9hZEltYWdlKGUsdCxpLHMscixuKXtyZXR1cm4gU3MoZSx0LGkscyxyLG4pfXN0YXRpYyBMb2FkRmlsZShlLHQsaSxzLHIsbil7cmV0dXJuIGp0KGUsdCxpLHMscixuKX1zdGF0aWMgTG9hZEZpbGVBc3luYyhlLHQ9ITApe3JldHVybiBuZXcgUHJvbWlzZSgoaSxzKT0+e2p0KGUscj0+e2kocil9LHZvaWQgMCx2b2lkIDAsdCwocixuKT0+e3Mobil9KX0pfXN0YXRpYyBMb2FkU2NyaXB0KGUsdCxpLHMpe2lmKHR5cGVvZiBpbXBvcnRTY3JpcHRzPT0iZnVuY3Rpb24iKXt0cnl7aW1wb3J0U2NyaXB0cyhlKSx0KCl9Y2F0Y2goYSl7aT09bnVsbHx8aShgVW5hYmxlIHRvIGxvYWQgc2NyaXB0ICcke2V9JyBpbiB3b3JrZXJgLGEpfXJldHVybn1lbHNlIGlmKCFqZSgpKXtpPT1udWxsfHxpKGBDYW5ub3QgbG9hZCBzY3JpcHQgJyR7ZX0nIG91dHNpZGUgb2YgYSB3aW5kb3cgb3IgYSB3b3JrZXJgKTtyZXR1cm59Y29uc3Qgcj1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdLG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7bi5zZXRBdHRyaWJ1dGUoInR5cGUiLCJ0ZXh0L2phdmFzY3JpcHQiKSxuLnNldEF0dHJpYnV0ZSgic3JjIixlKSxzJiYobi5pZD1zKSxuLm9ubG9hZD0oKT0+e3QmJnQoKX0sbi5vbmVycm9yPWE9PntpJiZpKGBVbmFibGUgdG8gbG9hZCBzY3JpcHQgJyR7ZX0nYCxhKX0sci5hcHBlbmRDaGlsZChuKX1zdGF0aWMgTG9hZFNjcmlwdEFzeW5jKGUpe3JldHVybiBuZXcgUHJvbWlzZSgodCxpKT0+e3RoaXMuTG9hZFNjcmlwdChlLCgpPT57dCgpfSwocyxyKT0+e2kocnx8bmV3IEVycm9yKHMpKX0pfSl9c3RhdGljIFJlYWRGaWxlQXNEYXRhVVJMKGUsdCxpKXtjb25zdCBzPW5ldyBGaWxlUmVhZGVyLHI9e29uQ29tcGxldGVPYnNlcnZhYmxlOm5ldyBGLGFib3J0OigpPT5zLmFib3J0KCl9O3JldHVybiBzLm9ubG9hZGVuZD0oKT0+e3Iub25Db21wbGV0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIpfSxzLm9ubG9hZD1uPT57dChuLnRhcmdldC5yZXN1bHQpfSxzLm9ucHJvZ3Jlc3M9aSxzLnJlYWRBc0RhdGFVUkwoZSkscn1zdGF0aWMgUmVhZEZpbGUoZSx0LGkscyxyKXtyZXR1cm4gd2koZSx0LGkscyxyKX1zdGF0aWMgRmlsZUFzVVJMKGUpe2NvbnN0IHQ9bmV3IEJsb2IoW2VdKTtyZXR1cm4gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwodCl9c3RhdGljIEZvcm1hdChlLHQ9Mil7cmV0dXJuIGUudG9GaXhlZCh0KX1zdGF0aWMgRGVlcENvcHkoZSx0LGkscyl7dnMuRGVlcENvcHkoZSx0LGkscyl9c3RhdGljIElzRW1wdHkoZSl7Zm9yKGNvbnN0IHQgaW4gZSlpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KSlyZXR1cm4hMTtyZXR1cm4hMH1zdGF0aWMgUmVnaXN0ZXJUb3BSb290RXZlbnRzKGUsdCl7Zm9yKGxldCBpPTA7aTx0Lmxlbmd0aDtpKyspe2NvbnN0IHM9dFtpXTtlLmFkZEV2ZW50TGlzdGVuZXIocy5uYW1lLHMuaGFuZGxlciwhMSk7dHJ5e3dpbmRvdy5wYXJlbnQmJndpbmRvdy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihzLm5hbWUscy5oYW5kbGVyLCExKX1jYXRjaHt9fX1zdGF0aWMgVW5yZWdpc3RlclRvcFJvb3RFdmVudHMoZSx0KXtmb3IobGV0IGk9MDtpPHQubGVuZ3RoO2krKyl7Y29uc3Qgcz10W2ldO2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihzLm5hbWUscy5oYW5kbGVyKTt0cnl7ZS5wYXJlbnQmJmUucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIocy5uYW1lLHMuaGFuZGxlcil9Y2F0Y2h7fX19c3RhdGljIGFzeW5jIER1bXBGcmFtZWJ1ZmZlcihlLHQsaSxzLHI9ImltYWdlL3BuZyIsbil7dGhyb3cgJCgiRHVtcFRvb2xzIil9c3RhdGljIER1bXBEYXRhKGUsdCxpLHMscj0iaW1hZ2UvcG5nIixuLGE9ITEsbz0hMSxoKXt0aHJvdyAkKCJEdW1wVG9vbHMiKX1zdGF0aWMgRHVtcERhdGFBc3luYyhlLHQsaSxzPSJpbWFnZS9wbmciLHIsbj0hMSxhPSExLG8pe3Rocm93ICQoIkR1bXBUb29scyIpfXN0YXRpYyBUb0Jsb2IoZSx0LGk9ImltYWdlL3BuZyIscyl7ZS50b0Jsb2J8fChlLnRvQmxvYj1mdW5jdGlvbihyLG4sYSl7c2V0VGltZW91dCgoKT0+e2NvbnN0IG89YXRvYih0aGlzLnRvRGF0YVVSTChuLGEpLnNwbGl0KCIsIilbMV0pLGg9by5sZW5ndGgsbD1uZXcgVWludDhBcnJheShoKTtmb3IobGV0IHU9MDt1PGg7dSsrKWxbdV09by5jaGFyQ29kZUF0KHUpO3IobmV3IEJsb2IoW2xdKSl9KX0pLGUudG9CbG9iKGZ1bmN0aW9uKHIpe3Qocil9LGkscyl9c3RhdGljIERvd25sb2FkQmxvYihlLHQpe2lmKCJkb3dubG9hZCJpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIikpe2lmKCF0KXtjb25zdCBpPW5ldyBEYXRlO3Q9InNjcmVlbnNob3RfIisoKGkuZ2V0RnVsbFllYXIoKSsiLSIrKGkuZ2V0TW9udGgoKSsxKSkuc2xpY2UoMikrIi0iK2kuZ2V0RGF0ZSgpKyJfIitpLmdldEhvdXJzKCkrIi0iKygiMCIraS5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKSkrIi5wbmcifUguRG93bmxvYWQoZSx0KX1lbHNlIGlmKGUmJnR5cGVvZiBVUkw8InUiKXtjb25zdCBpPVVSTC5jcmVhdGVPYmplY3RVUkwoZSkscz13aW5kb3cub3BlbigiIik7aWYoIXMpcmV0dXJuO2NvbnN0IHI9cy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTtyLm9ubG9hZD1mdW5jdGlvbigpe1VSTC5yZXZva2VPYmplY3RVUkwoaSl9LHIuc3JjPWkscy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHIpfX1zdGF0aWMgRW5jb2RlU2NyZWVuc2hvdENhbnZhc0RhdGEoZSx0LGk9ImltYWdlL3BuZyIscyxyKXtpZih0KXtjb25zdCBuPWUudG9EYXRhVVJMKGkscik7dChuKX1lbHNlIHRoaXMuVG9CbG9iKGUsZnVuY3Rpb24obil7biYmSC5Eb3dubG9hZEJsb2IobixzKX0saSxyKX1zdGF0aWMgRG93bmxvYWQoZSx0KXtpZih0eXBlb2YgVVJMPiJ1IilyZXR1cm47Y29uc3QgaT13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChlKSxzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHMpLHMuc3R5bGUuZGlzcGxheT0ibm9uZSIscy5ocmVmPWkscy5kb3dubG9hZD10LHMuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT57cy5wYXJlbnRFbGVtZW50JiZzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocyl9KSxzLmNsaWNrKCksd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwoaSl9c3RhdGljIEJhY2tDb21wYXRDYW1lcmFOb1ByZXZlbnREZWZhdWx0KGUpe3JldHVybiB0eXBlb2YgZVswXT09ImJvb2xlYW4iP2VbMF06dHlwZW9mIGVbMV09PSJib29sZWFuIj9lWzFdOiExfXN0YXRpYyBDcmVhdGVTY3JlZW5zaG90KGUsdCxpLHMscj0iaW1hZ2UvcG5nIil7dGhyb3cgJCgiU2NyZWVuc2hvdFRvb2xzIil9c3RhdGljIENyZWF0ZVNjcmVlbnNob3RBc3luYyhlLHQsaSxzPSJpbWFnZS9wbmciKXt0aHJvdyAkKCJTY3JlZW5zaG90VG9vbHMiKX1zdGF0aWMgQ3JlYXRlU2NyZWVuc2hvdFVzaW5nUmVuZGVyVGFyZ2V0KGUsdCxpLHMscj0iaW1hZ2UvcG5nIixuPTEsYT0hMSxvKXt0aHJvdyAkKCJTY3JlZW5zaG90VG9vbHMiKX1zdGF0aWMgQ3JlYXRlU2NyZWVuc2hvdFVzaW5nUmVuZGVyVGFyZ2V0QXN5bmMoZSx0LGkscz0iaW1hZ2UvcG5nIixyPTEsbj0hMSxhKXt0aHJvdyAkKCJTY3JlZW5zaG90VG9vbHMiKX1zdGF0aWMgUmFuZG9tSWQoKXtyZXR1cm4gbHIoKX1zdGF0aWMgSXNCYXNlNjQoZSl7cmV0dXJuIE1zKGUpfXN0YXRpYyBEZWNvZGVCYXNlNjQoZSl7cmV0dXJuIEFzKGUpfXN0YXRpYyBnZXQgZXJyb3JzQ291bnQoKXtyZXR1cm4gTy5lcnJvcnNDb3VudH1zdGF0aWMgTG9nKGUpe08uTG9nKGUpfXN0YXRpYyBXYXJuKGUpe08uV2FybihlKX1zdGF0aWMgRXJyb3IoZSl7Ty5FcnJvcihlKX1zdGF0aWMgZ2V0IExvZ0NhY2hlKCl7cmV0dXJuIE8uTG9nQ2FjaGV9c3RhdGljIENsZWFyTG9nQ2FjaGUoKXtPLkNsZWFyTG9nQ2FjaGUoKX1zdGF0aWMgc2V0IExvZ0xldmVscyhlKXtPLkxvZ0xldmVscz1lfXN0YXRpYyBzZXQgUGVyZm9ybWFuY2VMb2dMZXZlbChlKXtpZigoZSZILlBlcmZvcm1hbmNlVXNlck1hcmtMb2dMZXZlbCk9PT1ILlBlcmZvcm1hbmNlVXNlck1hcmtMb2dMZXZlbCl7SC5TdGFydFBlcmZvcm1hbmNlQ291bnRlcj1ILl9TdGFydFVzZXJNYXJrLEguRW5kUGVyZm9ybWFuY2VDb3VudGVyPUguX0VuZFVzZXJNYXJrO3JldHVybn1pZigoZSZILlBlcmZvcm1hbmNlQ29uc29sZUxvZ0xldmVsKT09PUguUGVyZm9ybWFuY2VDb25zb2xlTG9nTGV2ZWwpe0guU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fU3RhcnRQZXJmb3JtYW5jZUNvbnNvbGUsSC5FbmRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fRW5kUGVyZm9ybWFuY2VDb25zb2xlO3JldHVybn1ILlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyPUguX1N0YXJ0UGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQsSC5FbmRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fRW5kUGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWR9c3RhdGljIF9TdGFydFBlcmZvcm1hbmNlQ291bnRlckRpc2FibGVkKGUsdCl7fXN0YXRpYyBfRW5kUGVyZm9ybWFuY2VDb3VudGVyRGlzYWJsZWQoZSx0KXt9c3RhdGljIF9TdGFydFVzZXJNYXJrKGUsdD0hMCl7aWYoIUguX1BlcmZvcm1hbmNlKXtpZighamUoKSlyZXR1cm47SC5fUGVyZm9ybWFuY2U9d2luZG93LnBlcmZvcm1hbmNlfSF0fHwhSC5fUGVyZm9ybWFuY2UubWFya3x8SC5fUGVyZm9ybWFuY2UubWFyayhlKyItQmVnaW4iKX1zdGF0aWMgX0VuZFVzZXJNYXJrKGUsdD0hMCl7IXR8fCFILl9QZXJmb3JtYW5jZS5tYXJrfHwoSC5fUGVyZm9ybWFuY2UubWFyayhlKyItRW5kIiksSC5fUGVyZm9ybWFuY2UubWVhc3VyZShlLGUrIi1CZWdpbiIsZSsiLUVuZCIpKX1zdGF0aWMgX1N0YXJ0UGVyZm9ybWFuY2VDb25zb2xlKGUsdD0hMCl7dCYmKEguX1N0YXJ0VXNlck1hcmsoZSx0KSxjb25zb2xlLnRpbWUmJmNvbnNvbGUudGltZShlKSl9c3RhdGljIF9FbmRQZXJmb3JtYW5jZUNvbnNvbGUoZSx0PSEwKXt0JiYoSC5fRW5kVXNlck1hcmsoZSx0KSxjb25zb2xlLnRpbWVFbmQoZSkpfXN0YXRpYyBnZXQgTm93KCl7cmV0dXJuIGFpLk5vd31zdGF0aWMgR2V0Q2xhc3NOYW1lKGUsdD0hMSl7bGV0IGk9bnVsbDtyZXR1cm4hdCYmZS5nZXRDbGFzc05hbWU/aT1lLmdldENsYXNzTmFtZSgpOihlIGluc3RhbmNlb2YgT2JqZWN0JiYoaT0odD9lOk9iamVjdC5nZXRQcm90b3R5cGVPZihlKSkuY29uc3RydWN0b3IuX19ianNjbGFzc05hbWVfXyksaXx8KGk9dHlwZW9mIGUpKSxpfXN0YXRpYyBGaXJzdChlLHQpe2Zvcihjb25zdCBpIG9mIGUpaWYodChpKSlyZXR1cm4gaTtyZXR1cm4gbnVsbH1zdGF0aWMgZ2V0RnVsbENsYXNzTmFtZShlLHQ9ITEpe2xldCBpPW51bGwscz1udWxsO2lmKCF0JiZlLmdldENsYXNzTmFtZSlpPWUuZ2V0Q2xhc3NOYW1lKCk7ZWxzZXtpZihlIGluc3RhbmNlb2YgT2JqZWN0KXtjb25zdCByPXQ/ZTpPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSk7aT1yLmNvbnN0cnVjdG9yLl9fYmpzY2xhc3NOYW1lX18scz1yLmNvbnN0cnVjdG9yLl9fYmpzbW9kdWxlTmFtZV9ffWl8fChpPXR5cGVvZiBlKX1yZXR1cm4gaT8ocyE9bnVsbD9zKyIuIjoiIikraTpudWxsfXN0YXRpYyBEZWxheUFzeW5jKGUpe3JldHVybiBuZXcgUHJvbWlzZSh0PT57c2V0VGltZW91dCgoKT0+e3QoKX0sZSl9KX1zdGF0aWMgSXNTYWZhcmkoKXtyZXR1cm4gSnMoKT8vXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpOiExfX1ILlVzZUN1c3RvbVJlcXVlc3RIZWFkZXJzPSExLEguQ3VzdG9tUmVxdWVzdEhlYWRlcnM9Y3QuQ3VzdG9tUmVxdWVzdEhlYWRlcnMsSC5fVG1wRmxvYXRBcnJheT1uZXcgRmxvYXQzMkFycmF5KDEpLEguR2V0RE9NVGV4dENvbnRlbnQ9Z3MsSC5HZXRBYnNvbHV0ZVVybD10eXBlb2YgZG9jdW1lbnQ9PSJvYmplY3QiP2M9Pntjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtyZXR1cm4gZS5ocmVmPWMsZS5ocmVmfTp0eXBlb2YgVVJMPT0iZnVuY3Rpb24iJiZ0eXBlb2YgbG9jYXRpb249PSJvYmplY3QiP2M9Pm5ldyBVUkwoYyxsb2NhdGlvbi5vcmlnaW4pLmhyZWY6KCk9Pnt0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBnZXQgYWJzb2x1dGUgVVJMLiBPdmVycmlkZSBCQUJZTE9OLlRvb2xzLkdldEFic29sdXRlVXJsIHRvIGEgY3VzdG9tIGltcGxlbWVudGF0aW9uIGZvciB0aGUgY3VycmVudCBjb250ZXh0LiIpfSxILk5vbmVMb2dMZXZlbD1PLk5vbmVMb2dMZXZlbCxILk1lc3NhZ2VMb2dMZXZlbD1PLk1lc3NhZ2VMb2dMZXZlbCxILldhcm5pbmdMb2dMZXZlbD1PLldhcm5pbmdMb2dMZXZlbCxILkVycm9yTG9nTGV2ZWw9Ty5FcnJvckxvZ0xldmVsLEguQWxsTG9nTGV2ZWw9Ty5BbGxMb2dMZXZlbCxILklzV2luZG93T2JqZWN0RXhpc3Q9amUsSC5QZXJmb3JtYW5jZU5vbmVMb2dMZXZlbD0wLEguUGVyZm9ybWFuY2VVc2VyTWFya0xvZ0xldmVsPTEsSC5QZXJmb3JtYW5jZUNvbnNvbGVMb2dMZXZlbD0yLEguU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXI9SC5fU3RhcnRQZXJmb3JtYW5jZUNvdW50ZXJEaXNhYmxlZCxILkVuZFBlcmZvcm1hbmNlQ291bnRlcj1ILl9FbmRQZXJmb3JtYW5jZUNvdW50ZXJEaXNhYmxlZDtjbGFzcyBZaXtjb25zdHJ1Y3RvcihlLHQsaSxzPTApe3RoaXMuaXRlcmF0aW9ucz1lLHRoaXMuaW5kZXg9cy0xLHRoaXMuX2RvbmU9ITEsdGhpcy5fZm49dCx0aGlzLl9zdWNjZXNzQ2FsbGJhY2s9aX1leGVjdXRlTmV4dCgpe3RoaXMuX2RvbmV8fCh0aGlzLmluZGV4KzE8dGhpcy5pdGVyYXRpb25zPygrK3RoaXMuaW5kZXgsdGhpcy5fZm4odGhpcykpOnRoaXMuYnJlYWtMb29wKCkpfWJyZWFrTG9vcCgpe3RoaXMuX2RvbmU9ITAsdGhpcy5fc3VjY2Vzc0NhbGxiYWNrKCl9c3RhdGljIFJ1bihlLHQsaSxzPTApe2NvbnN0IHI9bmV3IFlpKGUsdCxpLHMpO3JldHVybiByLmV4ZWN1dGVOZXh0KCkscn1zdGF0aWMgU3luY0FzeW5jRm9yTG9vcChlLHQsaSxzLHIsbj0wKXtyZXR1cm4gWWkuUnVuKE1hdGguY2VpbChlL3QpLGE9PntyJiZyKCk/YS5icmVha0xvb3AoKTpzZXRUaW1lb3V0KCgpPT57Zm9yKGxldCBvPTA7bzx0Oysrbyl7Y29uc3QgaD1hLmluZGV4KnQrbztpZihoPj1lKWJyZWFrO2lmKGkoaCksciYmcigpKXthLmJyZWFrTG9vcCgpO2JyZWFrfX1hLmV4ZWN1dGVOZXh0KCl9LG4pfSxzKX19ZmUuRmFsbGJhY2tUZXh0dXJlPSJkYXRhOmltYWdlL2pwZztiYXNlNjQsLzlqLzRBQVFTa1pKUmdBQkFRRUFZQUJnQUFELzRRQm1SWGhwWmdBQVRVMEFLZ0FBQUFnQUJBRWFBQVVBQUFBQkFBQUFQZ0ViQUFVQUFBQUJBQUFBUmdFb0FBTUFBQUFCQUFJQUFBRXhBQUlBQUFBUUFBQUFUZ0FBQUFBQUFBQmdBQUFBQVFBQUFHQUFBQUFCY0dGcGJuUXVibVYwSURRdU1DNDFBUC9iQUVNQUJBSURBd01DQkFNREF3UUVCQVFGQ1FZRkJRVUZDd2dJQmdrTkN3ME5EUXNNREE0UUZCRU9EeE1QREF3U0dCSVRGUllYRnhjT0VSa2JHUllhRkJZWEZ2L2JBRU1CQkFRRUJRVUZDZ1lHQ2hZUERBOFdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRmhZV0ZoWVdGaFlXRnYvQUFCRUlBUUFCQUFNQklnQUNFUUVERVFIL3hBQWZBQUFCQlFFQkFRRUJBUUFBQUFBQUFBQUFBUUlEQkFVR0J3Z0pDZ3YveEFDMUVBQUNBUU1EQWdRREJRVUVCQUFBQVgwQkFnTUFCQkVGRWlFeFFRWVRVV0VISW5FVU1vR1JvUWdqUXJIQkZWTFI4Q1F6WW5LQ0NRb1dGeGdaR2lVbUp5Z3BLalExTmpjNE9UcERSRVZHUjBoSlNsTlVWVlpYV0ZsYVkyUmxabWRvYVdwemRIVjJkM2g1ZW9PRWhZYUhpSW1La3BPVWxaYVhtSm1hb3FPa3BhYW5xS21xc3JPMHRiYTN1TG02d3NQRXhjYkh5TW5LMHRQVTFkYlgyTm5hNGVMajVPWG01K2pwNnZIeTgvVDE5dmY0K2ZyL3hBQWZBUUFEQVFFQkFRRUJBUUVCQUFBQUFBQUFBUUlEQkFVR0J3Z0pDZ3YveEFDMUVRQUNBUUlFQkFNRUJ3VUVCQUFCQW5jQUFRSURFUVFGSVRFR0VrRlJCMkZ4RXlJeWdRZ1VRcEdoc2NFSkl6TlM4QlZpY3RFS0ZpUTA0U1h4RnhnWkdpWW5LQ2txTlRZM09EazZRMFJGUmtkSVNVcFRWRlZXVjFoWldtTmtaV1puYUdscWMzUjFkbmQ0ZVhxQ2c0U0Zob2VJaVlxU2s1U1ZscGVZbVpxaW82U2xwcWVvcWFxeXM3UzF0cmU0dWJyQ3c4VEZ4c2ZJeWNyUzA5VFYxdGZZMmRyaTQrVGw1dWZvNmVyeTgvVDE5dmY0K2ZyLzJnQU1Bd0VBQWhFREVRQS9BUEg2S0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RkNpaWlnRDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytnb29vb0ErWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVUtLS0tBUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZDaWlpZ0Q1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCUW9vb29BK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm9LS0tLQVBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGQ2lpaWdENmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2dvb29vQStYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVS0tLS0FQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NkNpaWlnRDVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JRb29vb0Erb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92b0tLS0tBUGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZDaWlpZ0Q2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrZ29vb29BK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UGwraWlpdnVqK0JUNmdvb29yNFUvdm8rWDZLS0srNlA0RlBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1VLS0tLQVBxQ2lpaXZoVCsrajVmb29vcjdvL2dVK29LS0tLK0ZQNzZQbCtpaWl2dWorQlQ2Z29vb3I0VS92bytYNktLSys2UDRGUHFDaWlpdmhUKytqNWZvb29yN28vZ1Urb0tLS0srRlA3NlBsK2lpaXZ1aitCVDZnb29vcjRVL3ZvK1g2S0tLKzZQNEZQcUNpaWl2aFQrK2o1Zm9vb3I3by9nVStvS0tLSytGUDc2UC8vWiI7Y2xhc3MgJGV7Y29uc3RydWN0b3IoZSl7dGhpcy5sZW5ndGg9MCx0aGlzLmRhdGE9bmV3IEFycmF5KGUpLHRoaXMuX2lkPSRlLl9HbG9iYWxJZCsrfXB1c2goZSl7dGhpcy5kYXRhW3RoaXMubGVuZ3RoKytdPWUsdGhpcy5sZW5ndGg+dGhpcy5kYXRhLmxlbmd0aCYmKHRoaXMuZGF0YS5sZW5ndGgqPTIpfWZvckVhY2goZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmxlbmd0aDt0KyspZSh0aGlzLmRhdGFbdF0pfXNvcnQoZSl7dGhpcy5kYXRhLnNvcnQoZSl9cmVzZXQoKXt0aGlzLmxlbmd0aD0wfWRpc3Bvc2UoKXt0aGlzLnJlc2V0KCksdGhpcy5kYXRhJiYodGhpcy5kYXRhLmxlbmd0aD0wKX1jb25jYXQoZSl7aWYoZS5sZW5ndGghPT0wKXt0aGlzLmxlbmd0aCtlLmxlbmd0aD50aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5kYXRhLmxlbmd0aD0odGhpcy5sZW5ndGgrZS5sZW5ndGgpKjIpO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXRoaXMuZGF0YVt0aGlzLmxlbmd0aCsrXT0oZS5kYXRhfHxlKVt0XX19aW5kZXhPZihlKXtjb25zdCB0PXRoaXMuZGF0YS5pbmRleE9mKGUpO3JldHVybiB0Pj10aGlzLmxlbmd0aD8tMTp0fWNvbnRhaW5zKGUpe3JldHVybiB0aGlzLmluZGV4T2YoZSkhPT0tMX19JGUuX0dsb2JhbElkPTA7Y2xhc3MgaGkgZXh0ZW5kcyAkZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5fZHVwbGljYXRlSWQ9MH1wdXNoKGUpe3N1cGVyLnB1c2goZSksZS5fX3NtYXJ0QXJyYXlGbGFnc3x8KGUuX19zbWFydEFycmF5RmxhZ3M9e30pLGUuX19zbWFydEFycmF5RmxhZ3NbdGhpcy5faWRdPXRoaXMuX2R1cGxpY2F0ZUlkfXB1c2hOb0R1cGxpY2F0ZShlKXtyZXR1cm4gZS5fX3NtYXJ0QXJyYXlGbGFncyYmZS5fX3NtYXJ0QXJyYXlGbGFnc1t0aGlzLl9pZF09PT10aGlzLl9kdXBsaWNhdGVJZD8hMToodGhpcy5wdXNoKGUpLCEwKX1yZXNldCgpe3N1cGVyLnJlc2V0KCksdGhpcy5fZHVwbGljYXRlSWQrK31jb25jYXRXaXRoTm9EdXBsaWNhdGUoZSl7aWYoZS5sZW5ndGghPT0wKXt0aGlzLmxlbmd0aCtlLmxlbmd0aD50aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5kYXRhLmxlbmd0aD0odGhpcy5sZW5ndGgrZS5sZW5ndGgpKjIpO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXtjb25zdCBpPShlLmRhdGF8fGUpW3RdO3RoaXMucHVzaE5vRHVwbGljYXRlKGkpfX19fWNsYXNzIGNye2NvbnN0cnVjdG9yKCl7dGhpcy5fY291bnQ9MCx0aGlzLl9kYXRhPXt9fWNvcHlGcm9tKGUpe3RoaXMuY2xlYXIoKSxlLmZvckVhY2goKHQsaSk9PnRoaXMuYWRkKHQsaSkpfWdldChlKXtjb25zdCB0PXRoaXMuX2RhdGFbZV07aWYodCE9PXZvaWQgMClyZXR1cm4gdH1nZXRPckFkZFdpdGhGYWN0b3J5KGUsdCl7bGV0IGk9dGhpcy5nZXQoZSk7cmV0dXJuIGkhPT12b2lkIDB8fChpPXQoZSksaSYmdGhpcy5hZGQoZSxpKSksaX1nZXRPckFkZChlLHQpe2NvbnN0IGk9dGhpcy5nZXQoZSk7cmV0dXJuIGkhPT12b2lkIDA/aToodGhpcy5hZGQoZSx0KSx0KX1jb250YWlucyhlKXtyZXR1cm4gdGhpcy5fZGF0YVtlXSE9PXZvaWQgMH1hZGQoZSx0KXtyZXR1cm4gdGhpcy5fZGF0YVtlXSE9PXZvaWQgMD8hMToodGhpcy5fZGF0YVtlXT10LCsrdGhpcy5fY291bnQsITApfXNldChlLHQpe3JldHVybiB0aGlzLl9kYXRhW2VdPT09dm9pZCAwPyExOih0aGlzLl9kYXRhW2VdPXQsITApfWdldEFuZFJlbW92ZShlKXtjb25zdCB0PXRoaXMuZ2V0KGUpO3JldHVybiB0IT09dm9pZCAwPyhkZWxldGUgdGhpcy5fZGF0YVtlXSwtLXRoaXMuX2NvdW50LHQpOm51bGx9cmVtb3ZlKGUpe3JldHVybiB0aGlzLmNvbnRhaW5zKGUpPyhkZWxldGUgdGhpcy5fZGF0YVtlXSwtLXRoaXMuX2NvdW50LCEwKTohMX1jbGVhcigpe3RoaXMuX2RhdGE9e30sdGhpcy5fY291bnQ9MH1nZXQgY291bnQoKXtyZXR1cm4gdGhpcy5fY291bnR9Zm9yRWFjaChlKXtmb3IoY29uc3QgdCBpbiB0aGlzLl9kYXRhKXtjb25zdCBpPXRoaXMuX2RhdGFbdF07ZSh0LGkpfX1maXJzdChlKXtmb3IoY29uc3QgdCBpbiB0aGlzLl9kYXRhKXtjb25zdCBpPXRoaXMuX2RhdGFbdF0scz1lKHQsaSk7aWYocylyZXR1cm4gc31yZXR1cm4gbnVsbH19Y2xhc3MgbGl7c3RhdGljIEV2YWwoZSx0KXtyZXR1cm4gZS5tYXRjaCgvXChbXigpXSpcKS9nKT9lPWUucmVwbGFjZSgvXChbXigpXSpcKS9nLGk9PihpPWkuc2xpY2UoMSxpLmxlbmd0aC0xKSxsaS5fSGFuZGxlUGFyZW50aGVzaXNDb250ZW50KGksdCkpKTplPWxpLl9IYW5kbGVQYXJlbnRoZXNpc0NvbnRlbnQoZSx0KSxlPT09InRydWUiPyEwOmU9PT0iZmFsc2UiPyExOmxpLkV2YWwoZSx0KX1zdGF0aWMgX0hhbmRsZVBhcmVudGhlc2lzQ29udGVudChlLHQpe3Q9dHx8KHI9PnI9PT0idHJ1ZSIpO2xldCBpO2NvbnN0IHM9ZS5zcGxpdCgifHwiKTtmb3IoY29uc3QgciBpbiBzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLHIpKXtsZXQgbj1saS5fU2ltcGxpZnlOZWdhdGlvbihzW3JdLnRyaW0oKSk7Y29uc3QgYT1uLnNwbGl0KCImJiIpO2lmKGEubGVuZ3RoPjEpZm9yKGxldCBvPTA7bzxhLmxlbmd0aDsrK28pe2NvbnN0IGg9bGkuX1NpbXBsaWZ5TmVnYXRpb24oYVtvXS50cmltKCkpO2lmKGghPT0idHJ1ZSImJmghPT0iZmFsc2UiP2hbMF09PT0iISI/aT0hdChoLnN1YnN0cmluZygxKSk6aT10KGgpOmk9aD09PSJ0cnVlIiwhaSl7bj0iZmFsc2UiO2JyZWFrfX1pZihpfHxuPT09InRydWUiKXtpPSEwO2JyZWFrfW4hPT0idHJ1ZSImJm4hPT0iZmFsc2UiP25bMF09PT0iISI/aT0hdChuLnN1YnN0cmluZygxKSk6aT10KG4pOmk9bj09PSJ0cnVlIn1yZXR1cm4gaT8idHJ1ZSI6ImZhbHNlIn1zdGF0aWMgX1NpbXBsaWZ5TmVnYXRpb24oZSl7cmV0dXJuIGU9ZS5yZXBsYWNlKC9eW1xzIV0rLyx0PT4odD10LnJlcGxhY2UoL1tcc10vZywoKT0+IiIpLHQubGVuZ3RoJTI/IiEiOiIiKSksZT1lLnRyaW0oKSxlPT09IiF0cnVlIj9lPSJmYWxzZSI6ZT09PSIhZmFsc2UiJiYoZT0idHJ1ZSIpLGV9fWNsYXNzIGdle3N0YXRpYyBFbmFibGVGb3IoZSl7ZS5fdGFncz1lLl90YWdzfHx7fSxlLmhhc1RhZ3M9KCk9PmdlLkhhc1RhZ3MoZSksZS5hZGRUYWdzPXQ9PmdlLkFkZFRhZ3NUbyhlLHQpLGUucmVtb3ZlVGFncz10PT5nZS5SZW1vdmVUYWdzRnJvbShlLHQpLGUubWF0Y2hlc1RhZ3NRdWVyeT10PT5nZS5NYXRjaGVzUXVlcnkoZSx0KX1zdGF0aWMgRGlzYWJsZUZvcihlKXtkZWxldGUgZS5fdGFncyxkZWxldGUgZS5oYXNUYWdzLGRlbGV0ZSBlLmFkZFRhZ3MsZGVsZXRlIGUucmVtb3ZlVGFncyxkZWxldGUgZS5tYXRjaGVzVGFnc1F1ZXJ5fXN0YXRpYyBIYXNUYWdzKGUpe2lmKCFlLl90YWdzKXJldHVybiExO2NvbnN0IHQ9ZS5fdGFncztmb3IoY29uc3QgaSBpbiB0KWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LGkpKXJldHVybiEwO3JldHVybiExfXN0YXRpYyBHZXRUYWdzKGUsdD0hMCl7aWYoIWUuX3RhZ3MpcmV0dXJuIG51bGw7aWYodCl7Y29uc3QgaT1bXTtmb3IoY29uc3QgcyBpbiBlLl90YWdzKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLl90YWdzLHMpJiZlLl90YWdzW3NdPT09ITAmJmkucHVzaChzKTtyZXR1cm4gaS5qb2luKCIgIil9ZWxzZSByZXR1cm4gZS5fdGFnc31zdGF0aWMgQWRkVGFnc1RvKGUsdCl7aWYoIXR8fHR5cGVvZiB0IT0ic3RyaW5nIilyZXR1cm47dC5zcGxpdCgiICIpLmZvckVhY2goZnVuY3Rpb24ocyl7Z2UuX0FkZFRhZ1RvKGUscyl9KX1zdGF0aWMgX0FkZFRhZ1RvKGUsdCl7dD10LnRyaW0oKSwhKHQ9PT0iInx8dD09PSJ0cnVlInx8dD09PSJmYWxzZSIpJiYodC5tYXRjaCgvW1xzXS8pfHx0Lm1hdGNoKC9eKFshXXwoW3xdfFsmXSl7Mn0pLyl8fChnZS5FbmFibGVGb3IoZSksZS5fdGFnc1t0XT0hMCkpfXN0YXRpYyBSZW1vdmVUYWdzRnJvbShlLHQpe2lmKCFnZS5IYXNUYWdzKGUpKXJldHVybjtjb25zdCBpPXQuc3BsaXQoIiAiKTtmb3IoY29uc3QgcyBpbiBpKWdlLl9SZW1vdmVUYWdGcm9tKGUsaVtzXSl9c3RhdGljIF9SZW1vdmVUYWdGcm9tKGUsdCl7ZGVsZXRlIGUuX3RhZ3NbdF19c3RhdGljIE1hdGNoZXNRdWVyeShlLHQpe3JldHVybiB0PT09dm9pZCAwPyEwOnQ9PT0iIj9nZS5IYXNUYWdzKGUpOmxpLkV2YWwodCxpPT5nZS5IYXNUYWdzKGUpJiZlLl90YWdzW2ldKX19Y2xhc3MgWml7Y29uc3RydWN0b3IoKXt0aGlzLnJvb3ROb2Rlcz1uZXcgQXJyYXksdGhpcy5jYW1lcmFzPW5ldyBBcnJheSx0aGlzLmxpZ2h0cz1uZXcgQXJyYXksdGhpcy5tZXNoZXM9bmV3IEFycmF5LHRoaXMuc2tlbGV0b25zPW5ldyBBcnJheSx0aGlzLnBhcnRpY2xlU3lzdGVtcz1uZXcgQXJyYXksdGhpcy5hbmltYXRpb25zPVtdLHRoaXMuYW5pbWF0aW9uR3JvdXBzPW5ldyBBcnJheSx0aGlzLm11bHRpTWF0ZXJpYWxzPW5ldyBBcnJheSx0aGlzLm1hdGVyaWFscz1uZXcgQXJyYXksdGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzPW5ldyBBcnJheSx0aGlzLmdlb21ldHJpZXM9bmV3IEFycmF5LHRoaXMudHJhbnNmb3JtTm9kZXM9bmV3IEFycmF5LHRoaXMuYWN0aW9uTWFuYWdlcnM9bmV3IEFycmF5LHRoaXMudGV4dHVyZXM9bmV3IEFycmF5LHRoaXMuX2Vudmlyb25tZW50VGV4dHVyZT1udWxsLHRoaXMucG9zdFByb2Nlc3Nlcz1uZXcgQXJyYXl9c3RhdGljIEFkZFBhcnNlcihlLHQpe3RoaXMuX0JhYnlsb25GaWxlUGFyc2Vyc1tlXT10fXN0YXRpYyBHZXRQYXJzZXIoZSl7cmV0dXJuIHRoaXMuX0JhYnlsb25GaWxlUGFyc2Vyc1tlXT90aGlzLl9CYWJ5bG9uRmlsZVBhcnNlcnNbZV06bnVsbH1zdGF0aWMgQWRkSW5kaXZpZHVhbFBhcnNlcihlLHQpe3RoaXMuX0luZGl2aWR1YWxCYWJ5bG9uRmlsZVBhcnNlcnNbZV09dH1zdGF0aWMgR2V0SW5kaXZpZHVhbFBhcnNlcihlKXtyZXR1cm4gdGhpcy5fSW5kaXZpZHVhbEJhYnlsb25GaWxlUGFyc2Vyc1tlXT90aGlzLl9JbmRpdmlkdWFsQmFieWxvbkZpbGVQYXJzZXJzW2VdOm51bGx9c3RhdGljIFBhcnNlKGUsdCxpLHMpe2Zvcihjb25zdCByIGluIHRoaXMuX0JhYnlsb25GaWxlUGFyc2VycylPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5fQmFieWxvbkZpbGVQYXJzZXJzLHIpJiZ0aGlzLl9CYWJ5bG9uRmlsZVBhcnNlcnNbcl0oZSx0LGkscyl9Z2V0IGVudmlyb25tZW50VGV4dHVyZSgpe3JldHVybiB0aGlzLl9lbnZpcm9ubWVudFRleHR1cmV9c2V0IGVudmlyb25tZW50VGV4dHVyZShlKXt0aGlzLl9lbnZpcm9ubWVudFRleHR1cmU9ZX1nZXROb2Rlcygpe2xldCBlPW5ldyBBcnJheTtyZXR1cm4gZT1lLmNvbmNhdCh0aGlzLm1lc2hlcyksZT1lLmNvbmNhdCh0aGlzLmxpZ2h0cyksZT1lLmNvbmNhdCh0aGlzLmNhbWVyYXMpLGU9ZS5jb25jYXQodGhpcy50cmFuc2Zvcm1Ob2RlcyksdGhpcy5za2VsZXRvbnMuZm9yRWFjaCh0PT5lPWUuY29uY2F0KHQuYm9uZXMpKSxlfX1aaS5fQmFieWxvbkZpbGVQYXJzZXJzPXt9LFppLl9JbmRpdmlkdWFsQmFieWxvbkZpbGVQYXJzZXJzPXt9O2Z1bmN0aW9uIFQoYyxlLHQsaSl7dmFyIHM9YXJndW1lbnRzLmxlbmd0aCxyPXM8Mz9lOmk9PT1udWxsP2k9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpOmksbjtpZih0eXBlb2YgUmVmbGVjdD09Im9iamVjdCImJnR5cGVvZiBSZWZsZWN0LmRlY29yYXRlPT0iZnVuY3Rpb24iKXI9UmVmbGVjdC5kZWNvcmF0ZShjLGUsdCxpKTtlbHNlIGZvcih2YXIgYT1jLmxlbmd0aC0xO2E+PTA7YS0tKShuPWNbYV0pJiYocj0oczwzP24ocik6cz4zP24oZSx0LHIpOm4oZSx0KSl8fHIpO3JldHVybiBzPjMmJnImJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQscikscn1jb25zdCBxaT17fSxqaT17fSx1cj1mdW5jdGlvbihjLGUsdCl7Y29uc3QgaT1jKCk7Z2UmJmdlLkFkZFRhZ3NUbyhpLGUudGFncyk7Y29uc3Qgcz1ScyhpKTtmb3IoY29uc3QgciBpbiBzKXtjb25zdCBuPXNbcl0sYT1lW3JdLG89bi50eXBlO2lmKGEhPW51bGwmJihyIT09InVuaXF1ZUlkInx8YWUuQWxsb3dMb2FkaW5nVW5pcXVlSWQpKXN3aXRjaChvKXtjYXNlIDA6Y2FzZSA2OmNhc2UgMTE6aVtyXT1hO2JyZWFrO2Nhc2UgMTppW3JdPXR8fGEuaXNSZW5kZXJUYXJnZXQ/YTphLmNsb25lKCk7YnJlYWs7Y2FzZSAyOmNhc2UgMzpjYXNlIDQ6Y2FzZSA1OmNhc2UgNzpjYXNlIDEwOmNhc2UgMTI6aVtyXT10P2E6YS5jbG9uZSgpO2JyZWFrfX1yZXR1cm4gaX07ZnVuY3Rpb24gYm4oYyl7Y29uc3QgZT1jLmdldENsYXNzTmFtZSgpO3JldHVybiBxaVtlXXx8KHFpW2VdPXt9KSxxaVtlXX1mdW5jdGlvbiBScyhjKXtjb25zdCBlPWMuZ2V0Q2xhc3NOYW1lKCk7aWYoamlbZV0pcmV0dXJuIGppW2VdO2ppW2VdPXt9O2NvbnN0IHQ9amlbZV07bGV0IGk9YyxzPWU7Zm9yKDtzOyl7Y29uc3Qgcj1xaVtzXTtmb3IoY29uc3QgbyBpbiByKXRbb109cltvXTtsZXQgbixhPSExO2Rve2lmKG49T2JqZWN0LmdldFByb3RvdHlwZU9mKGkpLCFuLmdldENsYXNzTmFtZSl7YT0hMDticmVha31pZihuLmdldENsYXNzTmFtZSgpIT09cylicmVhaztpPW59d2hpbGUobik7aWYoYSlicmVhaztzPW4uZ2V0Q2xhc3NOYW1lKCksaT1ufXJldHVybiB0fWZ1bmN0aW9uIHl0KGMsZSl7cmV0dXJuKHQsaSk9Pntjb25zdCBzPWJuKHQpO3NbaV18fChzW2ldPXt0eXBlOmMsc291cmNlTmFtZTplfSl9fWZ1bmN0aW9uIFNuKGMsZT1udWxsKXtyZXR1cm4odCxpKT0+e2NvbnN0IHM9ZXx8Il8iK2k7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsaSx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbc119LHNldDpmdW5jdGlvbihyKXt0eXBlb2YgdGhpcy5lcXVhbHM9PSJmdW5jdGlvbiImJnRoaXMuZXF1YWxzKHIpfHx0aGlzW3NdIT09ciYmKHRoaXNbc109cix0W2NdLmFwcGx5KHRoaXMpKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KX19ZnVuY3Rpb24gYmUoYyxlPW51bGwpe3JldHVybiBTbihjLGUpfWZ1bmN0aW9uIFIoYyl7cmV0dXJuIHl0KDAsYyl9ZnVuY3Rpb24gbXQoYyl7cmV0dXJuIHl0KDEsYyl9ZnVuY3Rpb24gY2koYyl7cmV0dXJuIHl0KDIsYyl9ZnVuY3Rpb24gTmkoYyl7cmV0dXJuIHl0KDMsYyl9ZnVuY3Rpb24geG4oYyl7cmV0dXJuIHl0KDQsYyl9ZnVuY3Rpb24gQnQoYyl7cmV0dXJuIHl0KDUsYyl9ZnVuY3Rpb24gTW4oYyl7cmV0dXJuIHl0KDYsYyl9ZnVuY3Rpb24gQW4oYyl7cmV0dXJuIHl0KDcsYyl9ZnVuY3Rpb24gZHIoYyl7cmV0dXJuIHl0KDgsYyl9ZnVuY3Rpb24gUm4oYyl7cmV0dXJuIHl0KDEwLGMpfWNsYXNzIGFle3N0YXRpYyBBcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyhlLHQpe2lmKGUuYW5pbWF0aW9ucyl7dC5hbmltYXRpb25zPVtdO2ZvcihsZXQgaT0wO2k8ZS5hbmltYXRpb25zLmxlbmd0aDtpKyspe2NvbnN0IHM9ZS5hbmltYXRpb25zW2ldO3QuYW5pbWF0aW9ucy5wdXNoKHMuc2VyaWFsaXplKCkpfX19c3RhdGljIFNlcmlhbGl6ZShlLHQpe3R8fCh0PXt9KSxnZSYmKHQudGFncz1nZS5HZXRUYWdzKGUpKTtjb25zdCBpPVJzKGUpO2Zvcihjb25zdCBzIGluIGkpe2NvbnN0IHI9aVtzXSxuPXIuc291cmNlTmFtZXx8cyxhPXIudHlwZSxvPWVbc107aWYobyE9bnVsbCYmKHMhPT0idW5pcXVlSWQifHxhZS5BbGxvd0xvYWRpbmdVbmlxdWVJZCkpc3dpdGNoKGEpe2Nhc2UgMDp0W25dPW87YnJlYWs7Y2FzZSAxOnRbbl09by5zZXJpYWxpemUoKTticmVhaztjYXNlIDI6dFtuXT1vLmFzQXJyYXkoKTticmVhaztjYXNlIDM6dFtuXT1vLnNlcmlhbGl6ZSgpO2JyZWFrO2Nhc2UgNDp0W25dPW8uYXNBcnJheSgpO2JyZWFrO2Nhc2UgNTp0W25dPW8uYXNBcnJheSgpO2JyZWFrO2Nhc2UgNjp0W25dPW8uaWQ7YnJlYWs7Y2FzZSA3OnRbbl09by5zZXJpYWxpemUoKTticmVhaztjYXNlIDg6dFtuXT1vLmFzQXJyYXkoKTticmVhaztjYXNlIDk6dFtuXT1vLnNlcmlhbGl6ZSgpO2JyZWFrO2Nhc2UgMTA6dFtuXT1vLmFzQXJyYXkoKTticmVhaztjYXNlIDExOnRbbl09by5pZDticmVhaztjYXNlIDEyOnRbbl09by5hc0FycmF5KCk7YnJlYWt9fXJldHVybiB0fXN0YXRpYyBQYXJzZShlLHQsaSxzPW51bGwpe2NvbnN0IHI9ZSgpO3N8fChzPSIiKSxnZSYmZ2UuQWRkVGFnc1RvKHIsdC50YWdzKTtjb25zdCBuPVJzKHIpO2Zvcihjb25zdCBhIGluIG4pe2NvbnN0IG89blthXSxoPXRbby5zb3VyY2VOYW1lfHxhXSxsPW8udHlwZTtpZihoIT1udWxsJiYoYSE9PSJ1bmlxdWVJZCJ8fGFlLkFsbG93TG9hZGluZ1VuaXF1ZUlkKSl7Y29uc3QgdT1yO3N3aXRjaChsKXtjYXNlIDA6dVthXT1oO2JyZWFrO2Nhc2UgMTppJiYodVthXT1hZS5fVGV4dHVyZVBhcnNlcihoLGkscykpO2JyZWFrO2Nhc2UgMjp1W2FdPXJlLkZyb21BcnJheShoKTticmVhaztjYXNlIDM6dVthXT1hZS5fRnJlc25lbFBhcmFtZXRlcnNQYXJzZXIoaCk7YnJlYWs7Y2FzZSA0OnVbYV09dmUuRnJvbUFycmF5KGgpO2JyZWFrO2Nhc2UgNTp1W2FdPXAuRnJvbUFycmF5KGgpO2JyZWFrO2Nhc2UgNjppJiYodVthXT1pLmdldExhc3RNZXNoQnlJZChoKSk7YnJlYWs7Y2FzZSA3OnVbYV09YWUuX0NvbG9yQ3VydmVzUGFyc2VyKGgpO2JyZWFrO2Nhc2UgODp1W2FdPW1lLkZyb21BcnJheShoKTticmVhaztjYXNlIDk6dVthXT1hZS5fSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvblBhcnNlcihoKTticmVhaztjYXNlIDEwOnVbYV09Wi5Gcm9tQXJyYXkoaCk7YnJlYWs7Y2FzZSAxMTppJiYodVthXT1pLmdldENhbWVyYUJ5SWQoaCkpO2JyZWFrO2Nhc2UgMTI6dVthXT14LkZyb21BcnJheShoKTticmVha319fXJldHVybiByfXN0YXRpYyBDbG9uZShlLHQpe3JldHVybiB1cihlLHQsITEpfXN0YXRpYyBJbnN0YW5jaWF0ZShlLHQpe3JldHVybiB1cihlLHQsITApfX1hZS5BbGxvd0xvYWRpbmdVbmlxdWVJZD0hMSxhZS5fSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvblBhcnNlcj1jPT57dGhyb3cgJCgiSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiIpfSxhZS5fRnJlc25lbFBhcmFtZXRlcnNQYXJzZXI9Yz0+e3Rocm93ICQoIkZyZXNuZWxQYXJhbWV0ZXJzIil9LGFlLl9Db2xvckN1cnZlc1BhcnNlcj1jPT57dGhyb3cgJCgiQ29sb3JDdXJ2ZXMiKX0sYWUuX1RleHR1cmVQYXJzZXI9KGMsZSx0KT0+e3Rocm93ICQoIlRleHR1cmUiKX07ZnVuY3Rpb24gJHQoYyxlLHQsaSl7Y29uc3Qgcz10LnZhbHVlO3QudmFsdWU9KC4uLnIpPT57bGV0IG49cztpZih0eXBlb2YgX25hdGl2ZTwidSImJl9uYXRpdmVbZV0pe2NvbnN0IGE9X25hdGl2ZVtlXTtpP249KC4uLm8pPT5pKC4uLm8pP2EoLi4ubyk6cyguLi5vKTpuPWF9cmV0dXJuIGNbZV09bixuKC4uLnIpfX0kdC5maWx0ZXI9ZnVuY3Rpb24oYyl7cmV0dXJuKGUsdCxpKT0+JHQoZSx0LGksYyl9O2NsYXNzIHlze2NvbnN0cnVjdG9yKGUpe2lmKHRoaXMuX2tleXM9W10sdGhpcy5faXNEaXJ0eT0hMCx0aGlzLl9hcmVMaWdodHNEaXJ0eT0hMCx0aGlzLl9hcmVMaWdodHNEaXNwb3NlZD0hMSx0aGlzLl9hcmVBdHRyaWJ1dGVzRGlydHk9ITAsdGhpcy5fYXJlVGV4dHVyZXNEaXJ0eT0hMCx0aGlzLl9hcmVGcmVzbmVsRGlydHk9ITAsdGhpcy5fYXJlTWlzY0RpcnR5PSEwLHRoaXMuX2FyZVByZVBhc3NEaXJ0eT0hMCx0aGlzLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eT0hMCx0aGlzLl9ub3JtYWxzPSExLHRoaXMuX3V2cz0hMSx0aGlzLl9uZWVkTm9ybWFscz0hMSx0aGlzLl9uZWVkVVZzPSExLHRoaXMuX2V4dGVybmFsUHJvcGVydGllcz1lLGUpZm9yKGNvbnN0IHQgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KSYmdGhpcy5fc2V0RGVmYXVsdFZhbHVlKHQpfWdldCBpc0RpcnR5KCl7cmV0dXJuIHRoaXMuX2lzRGlydHl9bWFya0FzUHJvY2Vzc2VkKCl7dGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9hcmVBdHRyaWJ1dGVzRGlydHk9ITEsdGhpcy5fYXJlVGV4dHVyZXNEaXJ0eT0hMSx0aGlzLl9hcmVGcmVzbmVsRGlydHk9ITEsdGhpcy5fYXJlTGlnaHRzRGlydHk9ITEsdGhpcy5fYXJlTGlnaHRzRGlzcG9zZWQ9ITEsdGhpcy5fYXJlTWlzY0RpcnR5PSExLHRoaXMuX2FyZVByZVBhc3NEaXJ0eT0hMSx0aGlzLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eT0hMX1tYXJrQXNVbnByb2Nlc3NlZCgpe3RoaXMuX2lzRGlydHk9ITB9bWFya0FsbEFzRGlydHkoKXt0aGlzLl9hcmVUZXh0dXJlc0RpcnR5PSEwLHRoaXMuX2FyZUF0dHJpYnV0ZXNEaXJ0eT0hMCx0aGlzLl9hcmVMaWdodHNEaXJ0eT0hMCx0aGlzLl9hcmVGcmVzbmVsRGlydHk9ITAsdGhpcy5fYXJlTWlzY0RpcnR5PSEwLHRoaXMuX2FyZUltYWdlUHJvY2Vzc2luZ0RpcnR5PSEwLHRoaXMuX2lzRGlydHk9ITB9bWFya0FzSW1hZ2VQcm9jZXNzaW5nRGlydHkoKXt0aGlzLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc0xpZ2h0RGlydHkoZT0hMSl7dGhpcy5fYXJlTGlnaHRzRGlydHk9ITAsdGhpcy5fYXJlTGlnaHRzRGlzcG9zZWQ9dGhpcy5fYXJlTGlnaHRzRGlzcG9zZWR8fGUsdGhpcy5faXNEaXJ0eT0hMH1tYXJrQXNBdHRyaWJ1dGVzRGlydHkoKXt0aGlzLl9hcmVBdHRyaWJ1dGVzRGlydHk9ITAsdGhpcy5faXNEaXJ0eT0hMH1tYXJrQXNUZXh0dXJlc0RpcnR5KCl7dGhpcy5fYXJlVGV4dHVyZXNEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc0ZyZXNuZWxEaXJ0eSgpe3RoaXMuX2FyZUZyZXNuZWxEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc01pc2NEaXJ0eSgpe3RoaXMuX2FyZU1pc2NEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfW1hcmtBc1ByZVBhc3NEaXJ0eSgpe3RoaXMuX2FyZVByZVBhc3NEaXJ0eT0hMCx0aGlzLl9pc0RpcnR5PSEwfXJlYnVpbGQoKXt0aGlzLl9rZXlzLmxlbmd0aD0wO2Zvcihjb25zdCBlIG9mIE9iamVjdC5rZXlzKHRoaXMpKWVbMF0hPT0iXyImJnRoaXMuX2tleXMucHVzaChlKTtpZih0aGlzLl9leHRlcm5hbFByb3BlcnRpZXMpZm9yKGNvbnN0IGUgaW4gdGhpcy5fZXh0ZXJuYWxQcm9wZXJ0aWVzKXRoaXMuX2tleXMuaW5kZXhPZihlKT09PS0xJiZ0aGlzLl9rZXlzLnB1c2goZSl9aXNFcXVhbChlKXtpZih0aGlzLl9rZXlzLmxlbmd0aCE9PWUuX2tleXMubGVuZ3RoKXJldHVybiExO2ZvcihsZXQgdD0wO3Q8dGhpcy5fa2V5cy5sZW5ndGg7dCsrKXtjb25zdCBpPXRoaXMuX2tleXNbdF07aWYodGhpc1tpXSE9PWVbaV0pcmV0dXJuITF9cmV0dXJuITB9Y2xvbmVUbyhlKXt0aGlzLl9rZXlzLmxlbmd0aCE9PWUuX2tleXMubGVuZ3RoJiYoZS5fa2V5cz10aGlzLl9rZXlzLnNsaWNlKDApKTtmb3IobGV0IHQ9MDt0PHRoaXMuX2tleXMubGVuZ3RoO3QrKyl7Y29uc3QgaT10aGlzLl9rZXlzW3RdO2VbaV09dGhpc1tpXX19cmVzZXQoKXt0aGlzLl9rZXlzLmZvckVhY2goZT0+dGhpcy5fc2V0RGVmYXVsdFZhbHVlKGUpKX1fc2V0RGVmYXVsdFZhbHVlKGUpe3ZhciB0LGkscyxyLG47Y29uc3QgYT0ocz0oaT0odD10aGlzLl9leHRlcm5hbFByb3BlcnRpZXMpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dFtlXSk9PT1udWxsfHxpPT09dm9pZCAwP3ZvaWQgMDppLnR5cGUpIT09bnVsbCYmcyE9PXZvaWQgMD9zOnR5cGVvZiB0aGlzW2VdLG89KG49KHI9dGhpcy5fZXh0ZXJuYWxQcm9wZXJ0aWVzKT09PW51bGx8fHI9PT12b2lkIDA/dm9pZCAwOnJbZV0pPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi5kZWZhdWx0O3N3aXRjaChhKXtjYXNlIm51bWJlciI6dGhpc1tlXT1vPz8wO2JyZWFrO2Nhc2Uic3RyaW5nIjp0aGlzW2VdPW8/PyIiO2JyZWFrO2RlZmF1bHQ6dGhpc1tlXT1vPz8hMTticmVha319dG9TdHJpbmcoKXtsZXQgZT0iIjtmb3IobGV0IHQ9MDt0PHRoaXMuX2tleXMubGVuZ3RoO3QrKyl7Y29uc3QgaT10aGlzLl9rZXlzW3RdLHM9dGhpc1tpXTtzd2l0Y2godHlwZW9mIHMpe2Nhc2UibnVtYmVyIjpjYXNlInN0cmluZyI6ZSs9IiNkZWZpbmUgIitpKyIgIitzK2AKYDticmVhaztkZWZhdWx0OnMmJihlKz0iI2RlZmluZSAiK2krYApgKTticmVha319cmV0dXJuIGV9fWNsYXNzIEFle2NvbnN0cnVjdG9yKCl7dGhpcy5fZGlydHk9ITAsdGhpcy5fdGVtcENvbG9yPW5ldyBtZSgwLDAsMCwwKSx0aGlzLl9nbG9iYWxDdXJ2ZT1uZXcgbWUoMCwwLDAsMCksdGhpcy5faGlnaGxpZ2h0c0N1cnZlPW5ldyBtZSgwLDAsMCwwKSx0aGlzLl9taWR0b25lc0N1cnZlPW5ldyBtZSgwLDAsMCwwKSx0aGlzLl9zaGFkb3dzQ3VydmU9bmV3IG1lKDAsMCwwLDApLHRoaXMuX3Bvc2l0aXZlQ3VydmU9bmV3IG1lKDAsMCwwLDApLHRoaXMuX25lZ2F0aXZlQ3VydmU9bmV3IG1lKDAsMCwwLDApLHRoaXMuX2dsb2JhbEh1ZT0zMCx0aGlzLl9nbG9iYWxEZW5zaXR5PTAsdGhpcy5fZ2xvYmFsU2F0dXJhdGlvbj0wLHRoaXMuX2dsb2JhbEV4cG9zdXJlPTAsdGhpcy5faGlnaGxpZ2h0c0h1ZT0zMCx0aGlzLl9oaWdobGlnaHRzRGVuc2l0eT0wLHRoaXMuX2hpZ2hsaWdodHNTYXR1cmF0aW9uPTAsdGhpcy5faGlnaGxpZ2h0c0V4cG9zdXJlPTAsdGhpcy5fbWlkdG9uZXNIdWU9MzAsdGhpcy5fbWlkdG9uZXNEZW5zaXR5PTAsdGhpcy5fbWlkdG9uZXNTYXR1cmF0aW9uPTAsdGhpcy5fbWlkdG9uZXNFeHBvc3VyZT0wLHRoaXMuX3NoYWRvd3NIdWU9MzAsdGhpcy5fc2hhZG93c0RlbnNpdHk9MCx0aGlzLl9zaGFkb3dzU2F0dXJhdGlvbj0wLHRoaXMuX3NoYWRvd3NFeHBvc3VyZT0wfWdldCBnbG9iYWxIdWUoKXtyZXR1cm4gdGhpcy5fZ2xvYmFsSHVlfXNldCBnbG9iYWxIdWUoZSl7dGhpcy5fZ2xvYmFsSHVlPWUsdGhpcy5fZGlydHk9ITB9Z2V0IGdsb2JhbERlbnNpdHkoKXtyZXR1cm4gdGhpcy5fZ2xvYmFsRGVuc2l0eX1zZXQgZ2xvYmFsRGVuc2l0eShlKXt0aGlzLl9nbG9iYWxEZW5zaXR5PWUsdGhpcy5fZGlydHk9ITB9Z2V0IGdsb2JhbFNhdHVyYXRpb24oKXtyZXR1cm4gdGhpcy5fZ2xvYmFsU2F0dXJhdGlvbn1zZXQgZ2xvYmFsU2F0dXJhdGlvbihlKXt0aGlzLl9nbG9iYWxTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9Z2V0IGdsb2JhbEV4cG9zdXJlKCl7cmV0dXJuIHRoaXMuX2dsb2JhbEV4cG9zdXJlfXNldCBnbG9iYWxFeHBvc3VyZShlKXt0aGlzLl9nbG9iYWxFeHBvc3VyZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBoaWdobGlnaHRzSHVlKCl7cmV0dXJuIHRoaXMuX2hpZ2hsaWdodHNIdWV9c2V0IGhpZ2hsaWdodHNIdWUoZSl7dGhpcy5faGlnaGxpZ2h0c0h1ZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBoaWdobGlnaHRzRGVuc2l0eSgpe3JldHVybiB0aGlzLl9oaWdobGlnaHRzRGVuc2l0eX1zZXQgaGlnaGxpZ2h0c0RlbnNpdHkoZSl7dGhpcy5faGlnaGxpZ2h0c0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgaGlnaGxpZ2h0c1NhdHVyYXRpb24oKXtyZXR1cm4gdGhpcy5faGlnaGxpZ2h0c1NhdHVyYXRpb259c2V0IGhpZ2hsaWdodHNTYXR1cmF0aW9uKGUpe3RoaXMuX2hpZ2hsaWdodHNTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9Z2V0IGhpZ2hsaWdodHNFeHBvc3VyZSgpe3JldHVybiB0aGlzLl9oaWdobGlnaHRzRXhwb3N1cmV9c2V0IGhpZ2hsaWdodHNFeHBvc3VyZShlKXt0aGlzLl9oaWdobGlnaHRzRXhwb3N1cmU9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgbWlkdG9uZXNIdWUoKXtyZXR1cm4gdGhpcy5fbWlkdG9uZXNIdWV9c2V0IG1pZHRvbmVzSHVlKGUpe3RoaXMuX21pZHRvbmVzSHVlPWUsdGhpcy5fZGlydHk9ITB9Z2V0IG1pZHRvbmVzRGVuc2l0eSgpe3JldHVybiB0aGlzLl9taWR0b25lc0RlbnNpdHl9c2V0IG1pZHRvbmVzRGVuc2l0eShlKXt0aGlzLl9taWR0b25lc0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgbWlkdG9uZXNTYXR1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX21pZHRvbmVzU2F0dXJhdGlvbn1zZXQgbWlkdG9uZXNTYXR1cmF0aW9uKGUpe3RoaXMuX21pZHRvbmVzU2F0dXJhdGlvbj1lLHRoaXMuX2RpcnR5PSEwfWdldCBtaWR0b25lc0V4cG9zdXJlKCl7cmV0dXJuIHRoaXMuX21pZHRvbmVzRXhwb3N1cmV9c2V0IG1pZHRvbmVzRXhwb3N1cmUoZSl7dGhpcy5fbWlkdG9uZXNFeHBvc3VyZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBzaGFkb3dzSHVlKCl7cmV0dXJuIHRoaXMuX3NoYWRvd3NIdWV9c2V0IHNoYWRvd3NIdWUoZSl7dGhpcy5fc2hhZG93c0h1ZT1lLHRoaXMuX2RpcnR5PSEwfWdldCBzaGFkb3dzRGVuc2l0eSgpe3JldHVybiB0aGlzLl9zaGFkb3dzRGVuc2l0eX1zZXQgc2hhZG93c0RlbnNpdHkoZSl7dGhpcy5fc2hhZG93c0RlbnNpdHk9ZSx0aGlzLl9kaXJ0eT0hMH1nZXQgc2hhZG93c1NhdHVyYXRpb24oKXtyZXR1cm4gdGhpcy5fc2hhZG93c1NhdHVyYXRpb259c2V0IHNoYWRvd3NTYXR1cmF0aW9uKGUpe3RoaXMuX3NoYWRvd3NTYXR1cmF0aW9uPWUsdGhpcy5fZGlydHk9ITB9Z2V0IHNoYWRvd3NFeHBvc3VyZSgpe3JldHVybiB0aGlzLl9zaGFkb3dzRXhwb3N1cmV9c2V0IHNoYWRvd3NFeHBvc3VyZShlKXt0aGlzLl9zaGFkb3dzRXhwb3N1cmU9ZSx0aGlzLl9kaXJ0eT0hMH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQ29sb3JDdXJ2ZXMifXN0YXRpYyBCaW5kKGUsdCxpPSJ2Q2FtZXJhQ29sb3JDdXJ2ZVBvc2l0aXZlIixzPSJ2Q2FtZXJhQ29sb3JDdXJ2ZU5ldXRyYWwiLHI9InZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmUiKXtlLl9kaXJ0eSYmKGUuX2RpcnR5PSExLGUuX2dldENvbG9yR3JhZGluZ0RhdGFUb1JlZihlLl9nbG9iYWxIdWUsZS5fZ2xvYmFsRGVuc2l0eSxlLl9nbG9iYWxTYXR1cmF0aW9uLGUuX2dsb2JhbEV4cG9zdXJlLGUuX2dsb2JhbEN1cnZlKSxlLl9nZXRDb2xvckdyYWRpbmdEYXRhVG9SZWYoZS5faGlnaGxpZ2h0c0h1ZSxlLl9oaWdobGlnaHRzRGVuc2l0eSxlLl9oaWdobGlnaHRzU2F0dXJhdGlvbixlLl9oaWdobGlnaHRzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9oaWdobGlnaHRzQ3VydmUpLGUuX2dldENvbG9yR3JhZGluZ0RhdGFUb1JlZihlLl9taWR0b25lc0h1ZSxlLl9taWR0b25lc0RlbnNpdHksZS5fbWlkdG9uZXNTYXR1cmF0aW9uLGUuX21pZHRvbmVzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9taWR0b25lc0N1cnZlKSxlLl9nZXRDb2xvckdyYWRpbmdEYXRhVG9SZWYoZS5fc2hhZG93c0h1ZSxlLl9zaGFkb3dzRGVuc2l0eSxlLl9zaGFkb3dzU2F0dXJhdGlvbixlLl9zaGFkb3dzRXhwb3N1cmUsZS5fdGVtcENvbG9yKSxlLl90ZW1wQ29sb3IubXVsdGlwbHlUb1JlZihlLl9nbG9iYWxDdXJ2ZSxlLl9zaGFkb3dzQ3VydmUpLGUuX2hpZ2hsaWdodHNDdXJ2ZS5zdWJ0cmFjdFRvUmVmKGUuX21pZHRvbmVzQ3VydmUsZS5fcG9zaXRpdmVDdXJ2ZSksZS5fbWlkdG9uZXNDdXJ2ZS5zdWJ0cmFjdFRvUmVmKGUuX3NoYWRvd3NDdXJ2ZSxlLl9uZWdhdGl2ZUN1cnZlKSksdCYmKHQuc2V0RmxvYXQ0KGksZS5fcG9zaXRpdmVDdXJ2ZS5yLGUuX3Bvc2l0aXZlQ3VydmUuZyxlLl9wb3NpdGl2ZUN1cnZlLmIsZS5fcG9zaXRpdmVDdXJ2ZS5hKSx0LnNldEZsb2F0NChzLGUuX21pZHRvbmVzQ3VydmUucixlLl9taWR0b25lc0N1cnZlLmcsZS5fbWlkdG9uZXNDdXJ2ZS5iLGUuX21pZHRvbmVzQ3VydmUuYSksdC5zZXRGbG9hdDQocixlLl9uZWdhdGl2ZUN1cnZlLnIsZS5fbmVnYXRpdmVDdXJ2ZS5nLGUuX25lZ2F0aXZlQ3VydmUuYixlLl9uZWdhdGl2ZUN1cnZlLmEpKX1zdGF0aWMgUHJlcGFyZVVuaWZvcm1zKGUpe2UucHVzaCgidkNhbWVyYUNvbG9yQ3VydmVOZXV0cmFsIiwidkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZSIsInZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmUiKX1fZ2V0Q29sb3JHcmFkaW5nRGF0YVRvUmVmKGUsdCxpLHMscil7ZSE9bnVsbCYmKGU9QWUuX0NsYW1wKGUsMCwzNjApLHQ9QWUuX0NsYW1wKHQsLTEwMCwxMDApLGk9QWUuX0NsYW1wKGksLTEwMCwxMDApLHM9QWUuX0NsYW1wKHMsLTEwMCwxMDApLHQ9QWUuX0FwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKHQpLHQqPS41LHM9QWUuX0FwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKHMpLHQ8MCYmKHQqPS0xLGU9KGUrMTgwKSUzNjApLEFlLl9Gcm9tSFNCVG9SZWYoZSx0LDUwKy4yNSpzLHIpLHIuc2NhbGVUb1JlZigyLHIpLHIuYT0xKy4wMSppKX1zdGF0aWMgX0FwcGx5Q29sb3JHcmFkaW5nU2xpZGVyTm9ubGluZWFyKGUpe2UvPTEwMDtsZXQgdD1NYXRoLmFicyhlKTtyZXR1cm4gdD1NYXRoLnBvdyh0LDIpLGU8MCYmKHQqPS0xKSx0Kj0xMDAsdH1zdGF0aWMgX0Zyb21IU0JUb1JlZihlLHQsaSxzKXtsZXQgcj1BZS5fQ2xhbXAoZSwwLDM2MCk7Y29uc3Qgbj1BZS5fQ2xhbXAodC8xMDAsMCwxKSxhPUFlLl9DbGFtcChpLzEwMCwwLDEpO2lmKG49PT0wKXMucj1hLHMuZz1hLHMuYj1hO2Vsc2V7ci89NjA7Y29uc3Qgbz1NYXRoLmZsb29yKHIpLGg9ci1vLGw9YSooMS1uKSx1PWEqKDEtbipoKSxkPWEqKDEtbiooMS1oKSk7c3dpdGNoKG8pe2Nhc2UgMDpzLnI9YSxzLmc9ZCxzLmI9bDticmVhaztjYXNlIDE6cy5yPXUscy5nPWEscy5iPWw7YnJlYWs7Y2FzZSAyOnMucj1sLHMuZz1hLHMuYj1kO2JyZWFrO2Nhc2UgMzpzLnI9bCxzLmc9dSxzLmI9YTticmVhaztjYXNlIDQ6cy5yPWQscy5nPWwscy5iPWE7YnJlYWs7ZGVmYXVsdDpzLnI9YSxzLmc9bCxzLmI9dTticmVha319cy5hPTF9c3RhdGljIF9DbGFtcChlLHQsaSl7cmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGUsdCksaSl9Y2xvbmUoKXtyZXR1cm4gYWUuQ2xvbmUoKCk9Pm5ldyBBZSx0aGlzKX1zZXJpYWxpemUoKXtyZXR1cm4gYWUuU2VyaWFsaXplKHRoaXMpfXN0YXRpYyBQYXJzZShlKXtyZXR1cm4gYWUuUGFyc2UoKCk9Pm5ldyBBZSxlLG51bGwsbnVsbCl9fVQoW1IoKV0sQWUucHJvdG90eXBlLCJfZ2xvYmFsSHVlIix2b2lkIDApLFQoW1IoKV0sQWUucHJvdG90eXBlLCJfZ2xvYmFsRGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLEFlLnByb3RvdHlwZSwiX2dsb2JhbFNhdHVyYXRpb24iLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9nbG9iYWxFeHBvc3VyZSIsdm9pZCAwKSxUKFtSKCldLEFlLnByb3RvdHlwZSwiX2hpZ2hsaWdodHNIdWUiLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9oaWdobGlnaHRzRGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLEFlLnByb3RvdHlwZSwiX2hpZ2hsaWdodHNTYXR1cmF0aW9uIix2b2lkIDApLFQoW1IoKV0sQWUucHJvdG90eXBlLCJfaGlnaGxpZ2h0c0V4cG9zdXJlIix2b2lkIDApLFQoW1IoKV0sQWUucHJvdG90eXBlLCJfbWlkdG9uZXNIdWUiLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9taWR0b25lc0RlbnNpdHkiLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9taWR0b25lc1NhdHVyYXRpb24iLHZvaWQgMCksVChbUigpXSxBZS5wcm90b3R5cGUsIl9taWR0b25lc0V4cG9zdXJlIix2b2lkIDApLGFlLl9Db2xvckN1cnZlc1BhcnNlcj1BZS5QYXJzZTtjbGFzcyBwZXtjb25zdHJ1Y3Rvcigpe3RoaXMuY29sb3JDdXJ2ZXM9bmV3IEFlLHRoaXMuX2NvbG9yQ3VydmVzRW5hYmxlZD0hMSx0aGlzLl9jb2xvckdyYWRpbmdFbmFibGVkPSExLHRoaXMuX2NvbG9yR3JhZGluZ1dpdGhHcmVlbkRlcHRoPSEwLHRoaXMuX2NvbG9yR3JhZGluZ0JHUj0hMCx0aGlzLl9leHBvc3VyZT0xLHRoaXMuX3RvbmVNYXBwaW5nRW5hYmxlZD0hMSx0aGlzLl90b25lTWFwcGluZ1R5cGU9cGUuVE9ORU1BUFBJTkdfU1RBTkRBUkQsdGhpcy5fY29udHJhc3Q9MSx0aGlzLnZpZ25ldHRlU3RyZXRjaD0wLHRoaXMudmlnbmV0dGVDZW50ZXJYPTAsdGhpcy52aWduZXR0ZUNlbnRlclk9MCx0aGlzLnZpZ25ldHRlV2VpZ2h0PTEuNSx0aGlzLnZpZ25ldHRlQ29sb3I9bmV3IG1lKDAsMCwwLDApLHRoaXMudmlnbmV0dGVDYW1lcmFGb3Y9LjUsdGhpcy5fdmlnbmV0dGVCbGVuZE1vZGU9cGUuVklHTkVUVEVNT0RFX01VTFRJUExZLHRoaXMuX3ZpZ25ldHRlRW5hYmxlZD0hMSx0aGlzLl9kaXRoZXJpbmdFbmFibGVkPSExLHRoaXMuX2RpdGhlcmluZ0ludGVuc2l0eT0xLzI1NSx0aGlzLl9za2lwRmluYWxDb2xvckNsYW1wPSExLHRoaXMuX2FwcGx5QnlQb3N0UHJvY2Vzcz0hMSx0aGlzLl9pc0VuYWJsZWQ9ITAsdGhpcy5vblVwZGF0ZVBhcmFtZXRlcnM9bmV3IEZ9Z2V0IGNvbG9yQ3VydmVzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9jb2xvckN1cnZlc0VuYWJsZWR9c2V0IGNvbG9yQ3VydmVzRW5hYmxlZChlKXt0aGlzLl9jb2xvckN1cnZlc0VuYWJsZWQhPT1lJiYodGhpcy5fY29sb3JDdXJ2ZXNFbmFibGVkPWUsdGhpcy5fdXBkYXRlUGFyYW1ldGVycygpKX1nZXQgY29sb3JHcmFkaW5nVGV4dHVyZSgpe3JldHVybiB0aGlzLl9jb2xvckdyYWRpbmdUZXh0dXJlfXNldCBjb2xvckdyYWRpbmdUZXh0dXJlKGUpe3RoaXMuX2NvbG9yR3JhZGluZ1RleHR1cmUhPT1lJiYodGhpcy5fY29sb3JHcmFkaW5nVGV4dHVyZT1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGNvbG9yR3JhZGluZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fY29sb3JHcmFkaW5nRW5hYmxlZH1zZXQgY29sb3JHcmFkaW5nRW5hYmxlZChlKXt0aGlzLl9jb2xvckdyYWRpbmdFbmFibGVkIT09ZSYmKHRoaXMuX2NvbG9yR3JhZGluZ0VuYWJsZWQ9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBjb2xvckdyYWRpbmdXaXRoR3JlZW5EZXB0aCgpe3JldHVybiB0aGlzLl9jb2xvckdyYWRpbmdXaXRoR3JlZW5EZXB0aH1zZXQgY29sb3JHcmFkaW5nV2l0aEdyZWVuRGVwdGgoZSl7dGhpcy5fY29sb3JHcmFkaW5nV2l0aEdyZWVuRGVwdGghPT1lJiYodGhpcy5fY29sb3JHcmFkaW5nV2l0aEdyZWVuRGVwdGg9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBjb2xvckdyYWRpbmdCR1IoKXtyZXR1cm4gdGhpcy5fY29sb3JHcmFkaW5nQkdSfXNldCBjb2xvckdyYWRpbmdCR1IoZSl7dGhpcy5fY29sb3JHcmFkaW5nQkdSIT09ZSYmKHRoaXMuX2NvbG9yR3JhZGluZ0JHUj1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGV4cG9zdXJlKCl7cmV0dXJuIHRoaXMuX2V4cG9zdXJlfXNldCBleHBvc3VyZShlKXt0aGlzLl9leHBvc3VyZSE9PWUmJih0aGlzLl9leHBvc3VyZT1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IHRvbmVNYXBwaW5nRW5hYmxlZCgpe3JldHVybiB0aGlzLl90b25lTWFwcGluZ0VuYWJsZWR9c2V0IHRvbmVNYXBwaW5nRW5hYmxlZChlKXt0aGlzLl90b25lTWFwcGluZ0VuYWJsZWQhPT1lJiYodGhpcy5fdG9uZU1hcHBpbmdFbmFibGVkPWUsdGhpcy5fdXBkYXRlUGFyYW1ldGVycygpKX1nZXQgdG9uZU1hcHBpbmdUeXBlKCl7cmV0dXJuIHRoaXMuX3RvbmVNYXBwaW5nVHlwZX1zZXQgdG9uZU1hcHBpbmdUeXBlKGUpe3RoaXMuX3RvbmVNYXBwaW5nVHlwZSE9PWUmJih0aGlzLl90b25lTWFwcGluZ1R5cGU9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBjb250cmFzdCgpe3JldHVybiB0aGlzLl9jb250cmFzdH1zZXQgY29udHJhc3QoZSl7dGhpcy5fY29udHJhc3QhPT1lJiYodGhpcy5fY29udHJhc3Q9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCB2aWduZXR0ZUNlbnRyZVkoKXtyZXR1cm4gdGhpcy52aWduZXR0ZUNlbnRlcll9c2V0IHZpZ25ldHRlQ2VudHJlWShlKXt0aGlzLnZpZ25ldHRlQ2VudGVyWT1lfWdldCB2aWduZXR0ZUNlbnRyZVgoKXtyZXR1cm4gdGhpcy52aWduZXR0ZUNlbnRlclh9c2V0IHZpZ25ldHRlQ2VudHJlWChlKXt0aGlzLnZpZ25ldHRlQ2VudGVyWD1lfWdldCB2aWduZXR0ZUJsZW5kTW9kZSgpe3JldHVybiB0aGlzLl92aWduZXR0ZUJsZW5kTW9kZX1zZXQgdmlnbmV0dGVCbGVuZE1vZGUoZSl7dGhpcy5fdmlnbmV0dGVCbGVuZE1vZGUhPT1lJiYodGhpcy5fdmlnbmV0dGVCbGVuZE1vZGU9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCB2aWduZXR0ZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fdmlnbmV0dGVFbmFibGVkfXNldCB2aWduZXR0ZUVuYWJsZWQoZSl7dGhpcy5fdmlnbmV0dGVFbmFibGVkIT09ZSYmKHRoaXMuX3ZpZ25ldHRlRW5hYmxlZD1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGRpdGhlcmluZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fZGl0aGVyaW5nRW5hYmxlZH1zZXQgZGl0aGVyaW5nRW5hYmxlZChlKXt0aGlzLl9kaXRoZXJpbmdFbmFibGVkIT09ZSYmKHRoaXMuX2RpdGhlcmluZ0VuYWJsZWQ9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBkaXRoZXJpbmdJbnRlbnNpdHkoKXtyZXR1cm4gdGhpcy5fZGl0aGVyaW5nSW50ZW5zaXR5fXNldCBkaXRoZXJpbmdJbnRlbnNpdHkoZSl7dGhpcy5fZGl0aGVyaW5nSW50ZW5zaXR5IT09ZSYmKHRoaXMuX2RpdGhlcmluZ0ludGVuc2l0eT1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IHNraXBGaW5hbENvbG9yQ2xhbXAoKXtyZXR1cm4gdGhpcy5fc2tpcEZpbmFsQ29sb3JDbGFtcH1zZXQgc2tpcEZpbmFsQ29sb3JDbGFtcChlKXt0aGlzLl9za2lwRmluYWxDb2xvckNsYW1wIT09ZSYmKHRoaXMuX3NraXBGaW5hbENvbG9yQ2xhbXA9ZSx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBhcHBseUJ5UG9zdFByb2Nlc3MoKXtyZXR1cm4gdGhpcy5fYXBwbHlCeVBvc3RQcm9jZXNzfXNldCBhcHBseUJ5UG9zdFByb2Nlc3MoZSl7dGhpcy5fYXBwbHlCeVBvc3RQcm9jZXNzIT09ZSYmKHRoaXMuX2FwcGx5QnlQb3N0UHJvY2Vzcz1lLHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGlzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9pc0VuYWJsZWR9c2V0IGlzRW5hYmxlZChlKXt0aGlzLl9pc0VuYWJsZWQhPT1lJiYodGhpcy5faXNFbmFibGVkPWUsdGhpcy5fdXBkYXRlUGFyYW1ldGVycygpKX1fdXBkYXRlUGFyYW1ldGVycygpe3RoaXMub25VcGRhdGVQYXJhbWV0ZXJzLm5vdGlmeU9ic2VydmVycyh0aGlzKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiJ9c3RhdGljIFByZXBhcmVVbmlmb3JtcyhlLHQpe3QuRVhQT1NVUkUmJmUucHVzaCgiZXhwb3N1cmVMaW5lYXIiKSx0LkNPTlRSQVNUJiZlLnB1c2goImNvbnRyYXN0IiksdC5DT0xPUkdSQURJTkcmJmUucHVzaCgiY29sb3JUcmFuc2Zvcm1TZXR0aW5ncyIpLCh0LlZJR05FVFRFfHx0LkRJVEhFUikmJmUucHVzaCgidkludmVyc2VTY3JlZW5TaXplIiksdC5WSUdORVRURSYmKGUucHVzaCgidmlnbmV0dGVTZXR0aW5nczEiKSxlLnB1c2goInZpZ25ldHRlU2V0dGluZ3MyIikpLHQuQ09MT1JDVVJWRVMmJkFlLlByZXBhcmVVbmlmb3JtcyhlKSx0LkRJVEhFUiYmZS5wdXNoKCJkaXRoZXJJbnRlbnNpdHkiKX1zdGF0aWMgUHJlcGFyZVNhbXBsZXJzKGUsdCl7dC5DT0xPUkdSQURJTkcmJmUucHVzaCgidHhDb2xvclRyYW5zZm9ybSIpfXByZXBhcmVEZWZpbmVzKGUsdD0hMSl7aWYodCE9PXRoaXMuYXBwbHlCeVBvc3RQcm9jZXNzfHwhdGhpcy5faXNFbmFibGVkKXtlLlZJR05FVFRFPSExLGUuVE9ORU1BUFBJTkc9ITEsZS5UT05FTUFQUElOR19BQ0VTPSExLGUuQ09OVFJBU1Q9ITEsZS5FWFBPU1VSRT0hMSxlLkNPTE9SQ1VSVkVTPSExLGUuQ09MT1JHUkFESU5HPSExLGUuQ09MT1JHUkFESU5HM0Q9ITEsZS5ESVRIRVI9ITEsZS5JTUFHRVBST0NFU1NJTkc9ITEsZS5TS0lQRklOQUxDT0xPUkNMQU1QPXRoaXMuc2tpcEZpbmFsQ29sb3JDbGFtcCxlLklNQUdFUFJPQ0VTU0lOR1BPU1RQUk9DRVNTPXRoaXMuYXBwbHlCeVBvc3RQcm9jZXNzJiZ0aGlzLl9pc0VuYWJsZWQ7cmV0dXJufXN3aXRjaChlLlZJR05FVFRFPXRoaXMudmlnbmV0dGVFbmFibGVkLGUuVklHTkVUVEVCTEVORE1PREVNVUxUSVBMWT10aGlzLnZpZ25ldHRlQmxlbmRNb2RlPT09cGUuX1ZJR05FVFRFTU9ERV9NVUxUSVBMWSxlLlZJR05FVFRFQkxFTkRNT0RFT1BBUVVFPSFlLlZJR05FVFRFQkxFTkRNT0RFTVVMVElQTFksZS5UT05FTUFQUElORz10aGlzLnRvbmVNYXBwaW5nRW5hYmxlZCx0aGlzLl90b25lTWFwcGluZ1R5cGUpe2Nhc2UgcGUuVE9ORU1BUFBJTkdfQUNFUzplLlRPTkVNQVBQSU5HX0FDRVM9ITA7YnJlYWs7ZGVmYXVsdDplLlRPTkVNQVBQSU5HX0FDRVM9ITE7YnJlYWt9ZS5DT05UUkFTVD10aGlzLmNvbnRyYXN0IT09MSxlLkVYUE9TVVJFPXRoaXMuZXhwb3N1cmUhPT0xLGUuQ09MT1JDVVJWRVM9dGhpcy5jb2xvckN1cnZlc0VuYWJsZWQmJiEhdGhpcy5jb2xvckN1cnZlcyxlLkNPTE9SR1JBRElORz10aGlzLmNvbG9yR3JhZGluZ0VuYWJsZWQmJiEhdGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlLGUuQ09MT1JHUkFESU5HP2UuQ09MT1JHUkFESU5HM0Q9dGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlLmlzM0Q6ZS5DT0xPUkdSQURJTkczRD0hMSxlLlNBTVBMRVIzREdSRUVOREVQVEg9dGhpcy5jb2xvckdyYWRpbmdXaXRoR3JlZW5EZXB0aCxlLlNBTVBMRVIzREJHUk1BUD10aGlzLmNvbG9yR3JhZGluZ0JHUixlLkRJVEhFUj10aGlzLl9kaXRoZXJpbmdFbmFibGVkLGUuSU1BR0VQUk9DRVNTSU5HUE9TVFBST0NFU1M9dGhpcy5hcHBseUJ5UG9zdFByb2Nlc3MsZS5TS0lQRklOQUxDT0xPUkNMQU1QPXRoaXMuc2tpcEZpbmFsQ29sb3JDbGFtcCxlLklNQUdFUFJPQ0VTU0lORz1lLlZJR05FVFRFfHxlLlRPTkVNQVBQSU5HfHxlLkNPTlRSQVNUfHxlLkVYUE9TVVJFfHxlLkNPTE9SQ1VSVkVTfHxlLkNPTE9SR1JBRElOR3x8ZS5ESVRIRVJ9aXNSZWFkeSgpe3JldHVybiF0aGlzLmNvbG9yR3JhZGluZ0VuYWJsZWR8fCF0aGlzLmNvbG9yR3JhZGluZ1RleHR1cmV8fHRoaXMuY29sb3JHcmFkaW5nVGV4dHVyZS5pc1JlYWR5KCl9YmluZChlLHQpe2lmKHRoaXMuX2NvbG9yQ3VydmVzRW5hYmxlZCYmdGhpcy5jb2xvckN1cnZlcyYmQWUuQmluZCh0aGlzLmNvbG9yQ3VydmVzLGUpLHRoaXMuX3ZpZ25ldHRlRW5hYmxlZHx8dGhpcy5fZGl0aGVyaW5nRW5hYmxlZCl7Y29uc3QgaT0xL2UuZ2V0RW5naW5lKCkuZ2V0UmVuZGVyV2lkdGgoKSxzPTEvZS5nZXRFbmdpbmUoKS5nZXRSZW5kZXJIZWlnaHQoKTtpZihlLnNldEZsb2F0MigidkludmVyc2VTY3JlZW5TaXplIixpLHMpLHRoaXMuX2RpdGhlcmluZ0VuYWJsZWQmJmUuc2V0RmxvYXQoImRpdGhlckludGVuc2l0eSIsLjUqdGhpcy5fZGl0aGVyaW5nSW50ZW5zaXR5KSx0aGlzLl92aWduZXR0ZUVuYWJsZWQpe2NvbnN0IHI9dD8/cy9pO2xldCBuPU1hdGgudGFuKHRoaXMudmlnbmV0dGVDYW1lcmFGb3YqLjUpLGE9bipyO2NvbnN0IG89TWF0aC5zcXJ0KGEqbik7YT1ILk1peChhLG8sdGhpcy52aWduZXR0ZVN0cmV0Y2gpLG49SC5NaXgobixvLHRoaXMudmlnbmV0dGVTdHJldGNoKSxlLnNldEZsb2F0NCgidmlnbmV0dGVTZXR0aW5nczEiLGEsbiwtYSp0aGlzLnZpZ25ldHRlQ2VudGVyWCwtbip0aGlzLnZpZ25ldHRlQ2VudGVyWSk7Y29uc3QgaD0tMip0aGlzLnZpZ25ldHRlV2VpZ2h0O2Uuc2V0RmxvYXQ0KCJ2aWduZXR0ZVNldHRpbmdzMiIsdGhpcy52aWduZXR0ZUNvbG9yLnIsdGhpcy52aWduZXR0ZUNvbG9yLmcsdGhpcy52aWduZXR0ZUNvbG9yLmIsaCl9fWlmKGUuc2V0RmxvYXQoImV4cG9zdXJlTGluZWFyIix0aGlzLmV4cG9zdXJlKSxlLnNldEZsb2F0KCJjb250cmFzdCIsdGhpcy5jb250cmFzdCksdGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlKXtlLnNldFRleHR1cmUoInR4Q29sb3JUcmFuc2Zvcm0iLHRoaXMuY29sb3JHcmFkaW5nVGV4dHVyZSk7Y29uc3QgaT10aGlzLmNvbG9yR3JhZGluZ1RleHR1cmUuZ2V0U2l6ZSgpLmhlaWdodDtlLnNldEZsb2F0NCgiY29sb3JUcmFuc2Zvcm1TZXR0aW5ncyIsKGktMSkvaSwuNS9pLGksdGhpcy5jb2xvckdyYWRpbmdUZXh0dXJlLmxldmVsKX19Y2xvbmUoKXtyZXR1cm4gYWUuQ2xvbmUoKCk9Pm5ldyBwZSx0aGlzKX1zZXJpYWxpemUoKXtyZXR1cm4gYWUuU2VyaWFsaXplKHRoaXMpfXN0YXRpYyBQYXJzZShlKXtjb25zdCB0PWFlLlBhcnNlKCgpPT5uZXcgcGUsZSxudWxsLG51bGwpO3JldHVybiBlLnZpZ25ldHRlQ2VudHJlWCE9PXZvaWQgMCYmKHQudmlnbmV0dGVDZW50ZXJYPWUudmlnbmV0dGVDZW50cmVYKSxlLnZpZ25ldHRlQ2VudHJlWSE9PXZvaWQgMCYmKHQudmlnbmV0dGVDZW50ZXJZPWUudmlnbmV0dGVDZW50cmVZKSx0fXN0YXRpYyBnZXQgVklHTkVUVEVNT0RFX01VTFRJUExZKCl7cmV0dXJuIHRoaXMuX1ZJR05FVFRFTU9ERV9NVUxUSVBMWX1zdGF0aWMgZ2V0IFZJR05FVFRFTU9ERV9PUEFRVUUoKXtyZXR1cm4gdGhpcy5fVklHTkVUVEVNT0RFX09QQVFVRX19cGUuVE9ORU1BUFBJTkdfU1RBTkRBUkQ9MCxwZS5UT05FTUFQUElOR19BQ0VTPTEscGUuX1ZJR05FVFRFTU9ERV9NVUxUSVBMWT0wLHBlLl9WSUdORVRURU1PREVfT1BBUVVFPTEsVChbQW4oKV0scGUucHJvdG90eXBlLCJjb2xvckN1cnZlcyIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX2NvbG9yQ3VydmVzRW5hYmxlZCIsdm9pZCAwKSxUKFttdCgiY29sb3JHcmFkaW5nVGV4dHVyZSIpXSxwZS5wcm90b3R5cGUsIl9jb2xvckdyYWRpbmdUZXh0dXJlIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfY29sb3JHcmFkaW5nRW5hYmxlZCIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX2NvbG9yR3JhZGluZ1dpdGhHcmVlbkRlcHRoIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfY29sb3JHcmFkaW5nQkdSIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfZXhwb3N1cmUiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl90b25lTWFwcGluZ0VuYWJsZWQiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl90b25lTWFwcGluZ1R5cGUiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl9jb250cmFzdCIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwidmlnbmV0dGVTdHJldGNoIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJ2aWduZXR0ZUNlbnRlclgiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsInZpZ25ldHRlQ2VudGVyWSIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwidmlnbmV0dGVXZWlnaHQiLHZvaWQgMCksVChbZHIoKV0scGUucHJvdG90eXBlLCJ2aWduZXR0ZUNvbG9yIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJ2aWduZXR0ZUNhbWVyYUZvdiIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX3ZpZ25ldHRlQmxlbmRNb2RlIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfdmlnbmV0dGVFbmFibGVkIix2b2lkIDApLFQoW1IoKV0scGUucHJvdG90eXBlLCJfZGl0aGVyaW5nRW5hYmxlZCIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX2RpdGhlcmluZ0ludGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLHBlLnByb3RvdHlwZSwiX3NraXBGaW5hbENvbG9yQ2xhbXAiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl9hcHBseUJ5UG9zdFByb2Nlc3MiLHZvaWQgMCksVChbUigpXSxwZS5wcm90b3R5cGUsIl9pc0VuYWJsZWQiLHZvaWQgMCksYWUuX0ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb25QYXJzZXI9cGUuUGFyc2Usb2UucHJvdG90eXBlLmNyZWF0ZVVuaWZvcm1CdWZmZXI9ZnVuY3Rpb24oYyl7Y29uc3QgZT10aGlzLl9nbC5jcmVhdGVCdWZmZXIoKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgdW5pZm9ybSBidWZmZXIiKTtjb25zdCB0PW5ldyBEaShlKTtyZXR1cm4gdGhpcy5iaW5kVW5pZm9ybUJ1ZmZlcih0KSxjIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3RoaXMuX2dsLmJ1ZmZlckRhdGEodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsYyx0aGlzLl9nbC5TVEFUSUNfRFJBVyk6dGhpcy5fZ2wuYnVmZmVyRGF0YSh0aGlzLl9nbC5VTklGT1JNX0JVRkZFUixuZXcgRmxvYXQzMkFycmF5KGMpLHRoaXMuX2dsLlNUQVRJQ19EUkFXKSx0aGlzLmJpbmRVbmlmb3JtQnVmZmVyKG51bGwpLHQucmVmZXJlbmNlcz0xLHR9LG9lLnByb3RvdHlwZS5jcmVhdGVEeW5hbWljVW5pZm9ybUJ1ZmZlcj1mdW5jdGlvbihjKXtjb25zdCBlPXRoaXMuX2dsLmNyZWF0ZUJ1ZmZlcigpO2lmKCFlKXRocm93IG5ldyBFcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSBkeW5hbWljIHVuaWZvcm0gYnVmZmVyIik7Y29uc3QgdD1uZXcgRGkoZSk7cmV0dXJuIHRoaXMuYmluZFVuaWZvcm1CdWZmZXIodCksYyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLGMsdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKTp0aGlzLl9nbC5idWZmZXJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLG5ldyBGbG9hdDMyQXJyYXkoYyksdGhpcy5fZ2wuRFlOQU1JQ19EUkFXKSx0aGlzLmJpbmRVbmlmb3JtQnVmZmVyKG51bGwpLHQucmVmZXJlbmNlcz0xLHR9LG9lLnByb3RvdHlwZS51cGRhdGVVbmlmb3JtQnVmZmVyPWZ1bmN0aW9uKGMsZSx0LGkpe3RoaXMuYmluZFVuaWZvcm1CdWZmZXIoYyksdD09PXZvaWQgMCYmKHQ9MCksaT09PXZvaWQgMD9lIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3RoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsdCxlKTp0aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLHQsbmV3IEZsb2F0MzJBcnJheShlKSk6ZSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheT90aGlzLl9nbC5idWZmZXJTdWJEYXRhKHRoaXMuX2dsLlVOSUZPUk1fQlVGRkVSLDAsZS5zdWJhcnJheSh0LHQraSkpOnRoaXMuX2dsLmJ1ZmZlclN1YkRhdGEodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsMCxuZXcgRmxvYXQzMkFycmF5KGUpLnN1YmFycmF5KHQsdCtpKSksdGhpcy5iaW5kVW5pZm9ybUJ1ZmZlcihudWxsKX0sb2UucHJvdG90eXBlLmJpbmRVbmlmb3JtQnVmZmVyPWZ1bmN0aW9uKGMpe3RoaXMuX2dsLmJpbmRCdWZmZXIodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsYz9jLnVuZGVybHlpbmdSZXNvdXJjZTpudWxsKX0sb2UucHJvdG90eXBlLmJpbmRVbmlmb3JtQnVmZmVyQmFzZT1mdW5jdGlvbihjLGUsdCl7dGhpcy5fZ2wuYmluZEJ1ZmZlckJhc2UodGhpcy5fZ2wuVU5JRk9STV9CVUZGRVIsZSxjP2MudW5kZXJseWluZ1Jlc291cmNlOm51bGwpfSxvZS5wcm90b3R5cGUuYmluZFVuaWZvcm1CbG9jaz1mdW5jdGlvbihjLGUsdCl7Y29uc3QgaT1jLnByb2dyYW0scz10aGlzLl9nbC5nZXRVbmlmb3JtQmxvY2tJbmRleChpLGUpO3MhPT00Mjk0OTY3Mjk1JiZ0aGlzLl9nbC51bmlmb3JtQmxvY2tCaW5kaW5nKGkscyx0KX07Y2xhc3MgVntjb25zdHJ1Y3RvcihlLHQsaSxzLHI9ITEpe3RoaXMuX3ZhbHVlQ2FjaGU9e30sdGhpcy5fZW5naW5lPWUsdGhpcy5fbm9VQk89IWUuc3VwcG9ydHNVbmlmb3JtQnVmZmVyc3x8cix0aGlzLl9keW5hbWljPWksdGhpcy5fbmFtZT1zPz8ibm8tbmFtZSIsdGhpcy5fZGF0YT10fHxbXSx0aGlzLl91bmlmb3JtTG9jYXRpb25zPXt9LHRoaXMuX3VuaWZvcm1TaXplcz17fSx0aGlzLl91bmlmb3JtQXJyYXlTaXplcz17fSx0aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyPTAsdGhpcy5fbmVlZFN5bmM9ITEsdGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lJiYodGhpcy5fYnVmZmVycz1bXSx0aGlzLl9idWZmZXJJbmRleD0tMSx0aGlzLl9jcmVhdGVCdWZmZXJPbldyaXRlPSExLHRoaXMuX2N1cnJlbnRGcmFtZUlkPTApLHRoaXMuX25vVUJPPyh0aGlzLnVwZGF0ZU1hdHJpeDN4Mz10aGlzLl91cGRhdGVNYXRyaXgzeDNGb3JFZmZlY3QsdGhpcy51cGRhdGVNYXRyaXgyeDI9dGhpcy5fdXBkYXRlTWF0cml4MngyRm9yRWZmZWN0LHRoaXMudXBkYXRlRmxvYXQ9dGhpcy5fdXBkYXRlRmxvYXRGb3JFZmZlY3QsdGhpcy51cGRhdGVGbG9hdDI9dGhpcy5fdXBkYXRlRmxvYXQyRm9yRWZmZWN0LHRoaXMudXBkYXRlRmxvYXQzPXRoaXMuX3VwZGF0ZUZsb2F0M0ZvckVmZmVjdCx0aGlzLnVwZGF0ZUZsb2F0ND10aGlzLl91cGRhdGVGbG9hdDRGb3JFZmZlY3QsdGhpcy51cGRhdGVGbG9hdEFycmF5PXRoaXMuX3VwZGF0ZUZsb2F0QXJyYXlGb3JFZmZlY3QsdGhpcy51cGRhdGVBcnJheT10aGlzLl91cGRhdGVBcnJheUZvckVmZmVjdCx0aGlzLnVwZGF0ZUludEFycmF5PXRoaXMuX3VwZGF0ZUludEFycmF5Rm9yRWZmZWN0LHRoaXMudXBkYXRlVUludEFycmF5PXRoaXMuX3VwZGF0ZVVJbnRBcnJheUZvckVmZmVjdCx0aGlzLnVwZGF0ZU1hdHJpeD10aGlzLl91cGRhdGVNYXRyaXhGb3JFZmZlY3QsdGhpcy51cGRhdGVNYXRyaWNlcz10aGlzLl91cGRhdGVNYXRyaWNlc0ZvckVmZmVjdCx0aGlzLnVwZGF0ZVZlY3RvcjM9dGhpcy5fdXBkYXRlVmVjdG9yM0ZvckVmZmVjdCx0aGlzLnVwZGF0ZVZlY3RvcjQ9dGhpcy5fdXBkYXRlVmVjdG9yNEZvckVmZmVjdCx0aGlzLnVwZGF0ZUNvbG9yMz10aGlzLl91cGRhdGVDb2xvcjNGb3JFZmZlY3QsdGhpcy51cGRhdGVDb2xvcjQ9dGhpcy5fdXBkYXRlQ29sb3I0Rm9yRWZmZWN0LHRoaXMudXBkYXRlRGlyZWN0Q29sb3I0PXRoaXMuX3VwZGF0ZURpcmVjdENvbG9yNEZvckVmZmVjdCx0aGlzLnVwZGF0ZUludD10aGlzLl91cGRhdGVJbnRGb3JFZmZlY3QsdGhpcy51cGRhdGVJbnQyPXRoaXMuX3VwZGF0ZUludDJGb3JFZmZlY3QsdGhpcy51cGRhdGVJbnQzPXRoaXMuX3VwZGF0ZUludDNGb3JFZmZlY3QsdGhpcy51cGRhdGVJbnQ0PXRoaXMuX3VwZGF0ZUludDRGb3JFZmZlY3QsdGhpcy51cGRhdGVVSW50PXRoaXMuX3VwZGF0ZVVJbnRGb3JFZmZlY3QsdGhpcy51cGRhdGVVSW50Mj10aGlzLl91cGRhdGVVSW50MkZvckVmZmVjdCx0aGlzLnVwZGF0ZVVJbnQzPXRoaXMuX3VwZGF0ZVVJbnQzRm9yRWZmZWN0LHRoaXMudXBkYXRlVUludDQ9dGhpcy5fdXBkYXRlVUludDRGb3JFZmZlY3QpOih0aGlzLl9lbmdpbmUuX3VuaWZvcm1CdWZmZXJzLnB1c2godGhpcyksdGhpcy51cGRhdGVNYXRyaXgzeDM9dGhpcy5fdXBkYXRlTWF0cml4M3gzRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZU1hdHJpeDJ4Mj10aGlzLl91cGRhdGVNYXRyaXgyeDJGb3JVbmlmb3JtLHRoaXMudXBkYXRlRmxvYXQ9dGhpcy5fdXBkYXRlRmxvYXRGb3JVbmlmb3JtLHRoaXMudXBkYXRlRmxvYXQyPXRoaXMuX3VwZGF0ZUZsb2F0MkZvclVuaWZvcm0sdGhpcy51cGRhdGVGbG9hdDM9dGhpcy5fdXBkYXRlRmxvYXQzRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUZsb2F0ND10aGlzLl91cGRhdGVGbG9hdDRGb3JVbmlmb3JtLHRoaXMudXBkYXRlRmxvYXRBcnJheT10aGlzLl91cGRhdGVGbG9hdEFycmF5Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUFycmF5PXRoaXMuX3VwZGF0ZUFycmF5Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUludEFycmF5PXRoaXMuX3VwZGF0ZUludEFycmF5Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnRBcnJheT10aGlzLl91cGRhdGVVSW50QXJyYXlGb3JVbmlmb3JtLHRoaXMudXBkYXRlTWF0cml4PXRoaXMuX3VwZGF0ZU1hdHJpeEZvclVuaWZvcm0sdGhpcy51cGRhdGVNYXRyaWNlcz10aGlzLl91cGRhdGVNYXRyaWNlc0ZvclVuaWZvcm0sdGhpcy51cGRhdGVWZWN0b3IzPXRoaXMuX3VwZGF0ZVZlY3RvcjNGb3JVbmlmb3JtLHRoaXMudXBkYXRlVmVjdG9yND10aGlzLl91cGRhdGVWZWN0b3I0Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUNvbG9yMz10aGlzLl91cGRhdGVDb2xvcjNGb3JVbmlmb3JtLHRoaXMudXBkYXRlQ29sb3I0PXRoaXMuX3VwZGF0ZUNvbG9yNEZvclVuaWZvcm0sdGhpcy51cGRhdGVEaXJlY3RDb2xvcjQ9dGhpcy5fdXBkYXRlRGlyZWN0Q29sb3I0Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUludD10aGlzLl91cGRhdGVJbnRGb3JVbmlmb3JtLHRoaXMudXBkYXRlSW50Mj10aGlzLl91cGRhdGVJbnQyRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZUludDM9dGhpcy5fdXBkYXRlSW50M0ZvclVuaWZvcm0sdGhpcy51cGRhdGVJbnQ0PXRoaXMuX3VwZGF0ZUludDRGb3JVbmlmb3JtLHRoaXMudXBkYXRlVUludD10aGlzLl91cGRhdGVVSW50Rm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnQyPXRoaXMuX3VwZGF0ZVVJbnQyRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnQzPXRoaXMuX3VwZGF0ZVVJbnQzRm9yVW5pZm9ybSx0aGlzLnVwZGF0ZVVJbnQ0PXRoaXMuX3VwZGF0ZVVJbnQ0Rm9yVW5pZm9ybSl9Z2V0IHVzZVVibygpe3JldHVybiF0aGlzLl9ub1VCT31nZXQgaXNTeW5jKCl7cmV0dXJuIXRoaXMuX25lZWRTeW5jfWlzRHluYW1pYygpe3JldHVybiB0aGlzLl9keW5hbWljIT09dm9pZCAwfWdldERhdGEoKXtyZXR1cm4gdGhpcy5fYnVmZmVyRGF0YX1nZXRCdWZmZXIoKXtyZXR1cm4gdGhpcy5fYnVmZmVyfV9maWxsQWxpZ25tZW50KGUpe2xldCB0O2lmKGU8PTI/dD1lOnQ9NCx0aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyJXQhPT0wKXtjb25zdCBpPXRoaXMuX3VuaWZvcm1Mb2NhdGlvblBvaW50ZXI7dGhpcy5fdW5pZm9ybUxvY2F0aW9uUG9pbnRlcis9dC10aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyJXQ7Y29uc3Qgcz10aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyLWk7Zm9yKGxldCByPTA7cjxzO3IrKyl0aGlzLl9kYXRhLnB1c2goMCl9fWFkZFVuaWZvcm0oZSx0LGk9MCl7aWYodGhpcy5fbm9VQk98fHRoaXMuX3VuaWZvcm1Mb2NhdGlvbnNbZV0hPT12b2lkIDApcmV0dXJuO2xldCBzO2lmKGk+MCl7aWYodCBpbnN0YW5jZW9mIEFycmF5KXRocm93ImFkZFVuaWZvcm0gc2hvdWxkIG5vdCBiZSB1c2Ugd2l0aCBBcnJheSBpbiBVQk86ICIrZTtpZih0aGlzLl9maWxsQWxpZ25tZW50KDQpLHRoaXMuX3VuaWZvcm1BcnJheVNpemVzW2VdPXtzdHJpZGVTaXplOnQsYXJyYXlTaXplOml9LHQ9PTE2KXQ9dCppO2Vsc2V7Y29uc3Qgbj0oNC10KSppO3Q9dCppK259cz1bXTtmb3IobGV0IHI9MDtyPHQ7cisrKXMucHVzaCgwKX1lbHNle2lmKHQgaW5zdGFuY2VvZiBBcnJheSlzPXQsdD1zLmxlbmd0aDtlbHNle3Q9dCxzPVtdO2ZvcihsZXQgcj0wO3I8dDtyKyspcy5wdXNoKDApfXRoaXMuX2ZpbGxBbGlnbm1lbnQodCl9dGhpcy5fdW5pZm9ybVNpemVzW2VdPXQsdGhpcy5fdW5pZm9ybUxvY2F0aW9uc1tlXT10aGlzLl91bmlmb3JtTG9jYXRpb25Qb2ludGVyLHRoaXMuX3VuaWZvcm1Mb2NhdGlvblBvaW50ZXIrPXQ7Zm9yKGxldCByPTA7cjx0O3IrKyl0aGlzLl9kYXRhLnB1c2goc1tyXSk7dGhpcy5fbmVlZFN5bmM9ITB9YWRkTWF0cml4KGUsdCl7dGhpcy5hZGRVbmlmb3JtKGUsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodC50b0FycmF5KCkpKX1hZGRGbG9hdDIoZSx0LGkpe2NvbnN0IHM9W3QsaV07dGhpcy5hZGRVbmlmb3JtKGUscyl9YWRkRmxvYXQzKGUsdCxpLHMpe2NvbnN0IHI9W3QsaSxzXTt0aGlzLmFkZFVuaWZvcm0oZSxyKX1hZGRDb2xvcjMoZSx0KXtjb25zdCBpPVt0LnIsdC5nLHQuYl07dGhpcy5hZGRVbmlmb3JtKGUsaSl9YWRkQ29sb3I0KGUsdCxpKXtjb25zdCBzPVt0LnIsdC5nLHQuYixpXTt0aGlzLmFkZFVuaWZvcm0oZSxzKX1hZGRWZWN0b3IzKGUsdCl7Y29uc3QgaT1bdC54LHQueSx0LnpdO3RoaXMuYWRkVW5pZm9ybShlLGkpfWFkZE1hdHJpeDN4MyhlKXt0aGlzLmFkZFVuaWZvcm0oZSwxMil9YWRkTWF0cml4MngyKGUpe3RoaXMuYWRkVW5pZm9ybShlLDgpfWNyZWF0ZSgpe3RoaXMuX25vVUJPfHx0aGlzLl9idWZmZXJ8fCh0aGlzLl9maWxsQWxpZ25tZW50KDQpLHRoaXMuX2J1ZmZlckRhdGE9bmV3IEZsb2F0MzJBcnJheSh0aGlzLl9kYXRhKSx0aGlzLl9yZWJ1aWxkKCksdGhpcy5fbmVlZFN5bmM9ITApfV9yZWJ1aWxkKCl7dGhpcy5fbm9VQk98fCF0aGlzLl9idWZmZXJEYXRhfHwodGhpcy5fZHluYW1pYz90aGlzLl9idWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZUR5bmFtaWNVbmlmb3JtQnVmZmVyKHRoaXMuX2J1ZmZlckRhdGEpOnRoaXMuX2J1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlVW5pZm9ybUJ1ZmZlcih0aGlzLl9idWZmZXJEYXRhKSx0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnRyYWNrVWJvc0luRnJhbWUmJih0aGlzLl9idWZmZXJzLnB1c2goW3RoaXMuX2J1ZmZlcix0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLmNoZWNrVWJvc0NvbnRlbnRCZWZvcmVVcGxvYWQ/dGhpcy5fYnVmZmVyRGF0YS5zbGljZSgpOnZvaWQgMF0pLHRoaXMuX2J1ZmZlckluZGV4PXRoaXMuX2J1ZmZlcnMubGVuZ3RoLTEsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSkpfWdldCBfbnVtQnVmZmVycygpe3JldHVybiB0aGlzLl9idWZmZXJzLmxlbmd0aH1nZXQgX2luZGV4QnVmZmVyKCl7cmV0dXJuIHRoaXMuX2J1ZmZlckluZGV4fWdldCBuYW1lKCl7cmV0dXJuIHRoaXMuX25hbWV9X2J1ZmZlcnNFcXVhbChlLHQpe2ZvcihsZXQgaT0wO2k8ZS5sZW5ndGg7KytpKWlmKGVbaV0hPT10W2ldKXJldHVybiExO3JldHVybiEwfV9jb3B5QnVmZmVyKGUsdCl7Zm9yKGxldCBpPTA7aTxlLmxlbmd0aDsrK2kpdFtpXT1lW2ldfXVwZGF0ZSgpe2lmKCF0aGlzLl9ub1VCTyl7aWYodGhpcy5iaW5kVW5pZm9ybUJ1ZmZlcigpLCF0aGlzLl9idWZmZXIpe3RoaXMuY3JlYXRlKCk7cmV0dXJufWlmKCF0aGlzLl9keW5hbWljJiYhdGhpcy5fbmVlZFN5bmMpe3RoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGU9dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lO3JldHVybn1pZih0aGlzLl9idWZmZXJzJiZ0aGlzLl9idWZmZXJzLmxlbmd0aD4xJiZ0aGlzLl9idWZmZXJzW3RoaXMuX2J1ZmZlckluZGV4XVsxXSlpZih0aGlzLl9idWZmZXJzRXF1YWwodGhpcy5fYnVmZmVyRGF0YSx0aGlzLl9idWZmZXJzW3RoaXMuX2J1ZmZlckluZGV4XVsxXSkpe3RoaXMuX25lZWRTeW5jPSExLHRoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGU9dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lO3JldHVybn1lbHNlIHRoaXMuX2NvcHlCdWZmZXIodGhpcy5fYnVmZmVyRGF0YSx0aGlzLl9idWZmZXJzW3RoaXMuX2J1ZmZlckluZGV4XVsxXSk7dGhpcy5fZW5naW5lLnVwZGF0ZVVuaWZvcm1CdWZmZXIodGhpcy5fYnVmZmVyLHRoaXMuX2J1ZmZlckRhdGEpLHRoaXMuX2VuZ2luZS5fZmVhdHVyZXMuX2NvbGxlY3RVYm9zVXBkYXRlZEluRnJhbWUmJihWLl9VcGRhdGVkVWJvc0luRnJhbWVbdGhpcy5fbmFtZV18fChWLl9VcGRhdGVkVWJvc0luRnJhbWVbdGhpcy5fbmFtZV09MCksVi5fVXBkYXRlZFVib3NJbkZyYW1lW3RoaXMuX25hbWVdKyspLHRoaXMuX25lZWRTeW5jPSExLHRoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGU9dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lfX1fY3JlYXRlTmV3QnVmZmVyKCl7dGhpcy5fYnVmZmVySW5kZXgrMTx0aGlzLl9idWZmZXJzLmxlbmd0aD8odGhpcy5fYnVmZmVySW5kZXgrKyx0aGlzLl9idWZmZXI9dGhpcy5fYnVmZmVyc1t0aGlzLl9idWZmZXJJbmRleF1bMF0sdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSx0aGlzLl9uZWVkU3luYz0hMCk6dGhpcy5fcmVidWlsZCgpfV9jaGVja05ld0ZyYW1lKCl7dGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lJiZ0aGlzLl9jdXJyZW50RnJhbWVJZCE9PXRoaXMuX2VuZ2luZS5mcmFtZUlkJiYodGhpcy5fY3VycmVudEZyYW1lSWQ9dGhpcy5fZW5naW5lLmZyYW1lSWQsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSx0aGlzLl9idWZmZXJzJiZ0aGlzLl9idWZmZXJzLmxlbmd0aD4wPyh0aGlzLl9uZWVkU3luYz10aGlzLl9idWZmZXJJbmRleCE9PTAsdGhpcy5fYnVmZmVySW5kZXg9MCx0aGlzLl9idWZmZXI9dGhpcy5fYnVmZmVyc1t0aGlzLl9idWZmZXJJbmRleF1bMF0pOnRoaXMuX2J1ZmZlckluZGV4PS0xKX11cGRhdGVVbmlmb3JtKGUsdCxpKXt0aGlzLl9jaGVja05ld0ZyYW1lKCk7bGV0IHM9dGhpcy5fdW5pZm9ybUxvY2F0aW9uc1tlXTtpZihzPT09dm9pZCAwKXtpZih0aGlzLl9idWZmZXIpe08uRXJyb3IoIkNhbm5vdCBhZGQgYW4gdW5pZm9ybSBhZnRlciBVQk8gaGFzIGJlZW4gY3JlYXRlZC4iKTtyZXR1cm59dGhpcy5hZGRVbmlmb3JtKGUsaSkscz10aGlzLl91bmlmb3JtTG9jYXRpb25zW2VdfWlmKHRoaXMuX2J1ZmZlcnx8dGhpcy5jcmVhdGUoKSx0aGlzLl9keW5hbWljKWZvcihsZXQgcj0wO3I8aTtyKyspdGhpcy5fYnVmZmVyRGF0YVtzK3JdPXRbcl07ZWxzZXtsZXQgcj0hMTtmb3IobGV0IG49MDtuPGk7bisrKShpPT09MTYmJiF0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnVuaWZvcm1CdWZmZXJIYXJkQ2hlY2tNYXRyaXh8fHRoaXMuX2J1ZmZlckRhdGFbcytuXSE9PUguRmxvYXRSb3VuZCh0W25dKSkmJihyPSEwLHRoaXMuX2NyZWF0ZUJ1ZmZlck9uV3JpdGUmJnRoaXMuX2NyZWF0ZU5ld0J1ZmZlcigpLHRoaXMuX2J1ZmZlckRhdGFbcytuXT10W25dKTt0aGlzLl9uZWVkU3luYz10aGlzLl9uZWVkU3luY3x8cn19dXBkYXRlVW5pZm9ybUFycmF5KGUsdCxpKXt0aGlzLl9jaGVja05ld0ZyYW1lKCk7Y29uc3Qgcz10aGlzLl91bmlmb3JtTG9jYXRpb25zW2VdO2lmKHM9PT12b2lkIDApe08uRXJyb3IoIkNhbm5vdCBhZGQgYW4gdW5pZm9ybSBBcnJheSBkeW5hbWljYWxseS4gUGxlYXNlLCBhZGQgaXQgdXNpbmcgYWRkVW5pZm9ybSBhbmQgbWFrZSBzdXJlIHRoYXQgdW5pZm9ybSBidWZmZXJzIGFyZSBzdXBwb3J0ZWQgYnkgdGhlIGN1cnJlbnQgZW5naW5lLiIpO3JldHVybn10aGlzLl9idWZmZXJ8fHRoaXMuY3JlYXRlKCk7Y29uc3Qgcj10aGlzLl91bmlmb3JtQXJyYXlTaXplc1tlXTtpZih0aGlzLl9keW5hbWljKWZvcihsZXQgbj0wO248aTtuKyspdGhpcy5fYnVmZmVyRGF0YVtzK25dPXRbbl07ZWxzZXtsZXQgbj0hMSxhPTAsbz0wO2ZvcihsZXQgaD0wO2g8aTtoKyspaWYodGhpcy5fYnVmZmVyRGF0YVtzK28qNCthXSE9PUguRmxvYXRSb3VuZCh0W2hdKSYmKG49ITAsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZSYmdGhpcy5fY3JlYXRlTmV3QnVmZmVyKCksdGhpcy5fYnVmZmVyRGF0YVtzK28qNCthXT10W2hdKSxhKyssYT09PXIuc3RyaWRlU2l6ZSl7Zm9yKDthPDQ7YSsrKXRoaXMuX2J1ZmZlckRhdGFbcytvKjQrYV09MDthPTAsbysrfXRoaXMuX25lZWRTeW5jPXRoaXMuX25lZWRTeW5jfHxufX1fY2FjaGVNYXRyaXgoZSx0KXt0aGlzLl9jaGVja05ld0ZyYW1lKCk7Y29uc3QgaT10aGlzLl92YWx1ZUNhY2hlW2VdLHM9dC51cGRhdGVGbGFnO3JldHVybiBpIT09dm9pZCAwJiZpPT09cz8hMToodGhpcy5fdmFsdWVDYWNoZVtlXT1zLCEwKX1fdXBkYXRlTWF0cml4M3gzRm9yVW5pZm9ybShlLHQpe2ZvcihsZXQgaT0wO2k8MztpKyspVi5fVGVtcEJ1ZmZlcltpKjRdPXRbaSozXSxWLl9UZW1wQnVmZmVyW2kqNCsxXT10W2kqMysxXSxWLl9UZW1wQnVmZmVyW2kqNCsyXT10W2kqMysyXSxWLl9UZW1wQnVmZmVyW2kqNCszXT0wO3RoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsMTIpfV91cGRhdGVNYXRyaXgzeDNGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldE1hdHJpeDN4MyhlLHQpfV91cGRhdGVNYXRyaXgyeDJGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldE1hdHJpeDJ4MihlLHQpfV91cGRhdGVNYXRyaXgyeDJGb3JVbmlmb3JtKGUsdCl7Zm9yKGxldCBpPTA7aTwyO2krKylWLl9UZW1wQnVmZmVyW2kqNF09dFtpKjJdLFYuX1RlbXBCdWZmZXJbaSo0KzFdPXRbaSoyKzFdLFYuX1RlbXBCdWZmZXJbaSo0KzJdPTAsVi5fVGVtcEJ1ZmZlcltpKjQrM109MDt0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDgpfV91cGRhdGVGbG9hdEZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0RmxvYXQoZSx0KX1fdXBkYXRlRmxvYXRGb3JVbmlmb3JtKGUsdCl7Vi5fVGVtcEJ1ZmZlclswXT10LHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsMSl9X3VwZGF0ZUZsb2F0MkZvckVmZmVjdChlLHQsaSxzPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEZsb2F0MihlK3MsdCxpKX1fdXBkYXRlRmxvYXQyRm9yVW5pZm9ybShlLHQsaSl7Vi5fVGVtcEJ1ZmZlclswXT10LFYuX1RlbXBCdWZmZXJbMV09aSx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDIpfV91cGRhdGVGbG9hdDNGb3JFZmZlY3QoZSx0LGkscyxyPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEZsb2F0MyhlK3IsdCxpLHMpfV91cGRhdGVGbG9hdDNGb3JVbmlmb3JtKGUsdCxpLHMpe1YuX1RlbXBCdWZmZXJbMF09dCxWLl9UZW1wQnVmZmVyWzFdPWksVi5fVGVtcEJ1ZmZlclsyXT1zLHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsMyl9X3VwZGF0ZUZsb2F0NEZvckVmZmVjdChlLHQsaSxzLHIsbj0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRGbG9hdDQoZStuLHQsaSxzLHIpfV91cGRhdGVGbG9hdDRGb3JVbmlmb3JtKGUsdCxpLHMscil7Vi5fVGVtcEJ1ZmZlclswXT10LFYuX1RlbXBCdWZmZXJbMV09aSxWLl9UZW1wQnVmZmVyWzJdPXMsVi5fVGVtcEJ1ZmZlclszXT1yLHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsNCl9X3VwZGF0ZUZsb2F0QXJyYXlGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEZsb2F0QXJyYXkoZSx0KX1fdXBkYXRlRmxvYXRBcnJheUZvclVuaWZvcm0oZSx0KXt0aGlzLnVwZGF0ZVVuaWZvcm1BcnJheShlLHQsdC5sZW5ndGgpfV91cGRhdGVBcnJheUZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0QXJyYXkoZSx0KX1fdXBkYXRlQXJyYXlGb3JVbmlmb3JtKGUsdCl7dGhpcy51cGRhdGVVbmlmb3JtQXJyYXkoZSx0LHQubGVuZ3RoKX1fdXBkYXRlSW50QXJyYXlGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEludEFycmF5KGUsdCl9X3VwZGF0ZUludEFycmF5Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXcuc2V0KHQpLHRoaXMudXBkYXRlVW5pZm9ybUFycmF5KGUsVi5fVGVtcEJ1ZmZlcix0Lmxlbmd0aCl9X3VwZGF0ZVVJbnRBcnJheUZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0VUludEFycmF5KGUsdCl9X3VwZGF0ZVVJbnRBcnJheUZvclVuaWZvcm0oZSx0KXtWLl9UZW1wQnVmZmVyVUludDMyVmlldy5zZXQodCksdGhpcy51cGRhdGVVbmlmb3JtQXJyYXkoZSxWLl9UZW1wQnVmZmVyLHQubGVuZ3RoKX1fdXBkYXRlTWF0cml4Rm9yRWZmZWN0KGUsdCl7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRNYXRyaXgoZSx0KX1fdXBkYXRlTWF0cml4Rm9yVW5pZm9ybShlLHQpe3RoaXMuX2NhY2hlTWF0cml4KGUsdCkmJnRoaXMudXBkYXRlVW5pZm9ybShlLHQudG9BcnJheSgpLDE2KX1fdXBkYXRlTWF0cmljZXNGb3JFZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldE1hdHJpY2VzKGUsdCl9X3VwZGF0ZU1hdHJpY2VzRm9yVW5pZm9ybShlLHQpe3RoaXMudXBkYXRlVW5pZm9ybShlLHQsdC5sZW5ndGgpfV91cGRhdGVWZWN0b3IzRm9yRWZmZWN0KGUsdCl7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRWZWN0b3IzKGUsdCl9X3VwZGF0ZVZlY3RvcjNGb3JVbmlmb3JtKGUsdCl7Vi5fVGVtcEJ1ZmZlclswXT10LngsVi5fVGVtcEJ1ZmZlclsxXT10LnksVi5fVGVtcEJ1ZmZlclsyXT10LnosdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwzKX1fdXBkYXRlVmVjdG9yNEZvckVmZmVjdChlLHQpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0VmVjdG9yNChlLHQpfV91cGRhdGVWZWN0b3I0Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJbMF09dC54LFYuX1RlbXBCdWZmZXJbMV09dC55LFYuX1RlbXBCdWZmZXJbMl09dC56LFYuX1RlbXBCdWZmZXJbM109dC53LHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsNCl9X3VwZGF0ZUNvbG9yM0ZvckVmZmVjdChlLHQsaT0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRDb2xvcjMoZStpLHQpfV91cGRhdGVDb2xvcjNGb3JVbmlmb3JtKGUsdCl7Vi5fVGVtcEJ1ZmZlclswXT10LnIsVi5fVGVtcEJ1ZmZlclsxXT10LmcsVi5fVGVtcEJ1ZmZlclsyXT10LmIsdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwzKX1fdXBkYXRlQ29sb3I0Rm9yRWZmZWN0KGUsdCxpLHM9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0Q29sb3I0KGUrcyx0LGkpfV91cGRhdGVEaXJlY3RDb2xvcjRGb3JFZmZlY3QoZSx0LGk9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0RGlyZWN0Q29sb3I0KGUraSx0KX1fdXBkYXRlQ29sb3I0Rm9yVW5pZm9ybShlLHQsaSl7Vi5fVGVtcEJ1ZmZlclswXT10LnIsVi5fVGVtcEJ1ZmZlclsxXT10LmcsVi5fVGVtcEJ1ZmZlclsyXT10LmIsVi5fVGVtcEJ1ZmZlclszXT1pLHRoaXMudXBkYXRlVW5pZm9ybShlLFYuX1RlbXBCdWZmZXIsNCl9X3VwZGF0ZURpcmVjdENvbG9yNEZvclVuaWZvcm0oZSx0KXtWLl9UZW1wQnVmZmVyWzBdPXQucixWLl9UZW1wQnVmZmVyWzFdPXQuZyxWLl9UZW1wQnVmZmVyWzJdPXQuYixWLl9UZW1wQnVmZmVyWzNdPXQuYSx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDQpfV91cGRhdGVJbnRGb3JFZmZlY3QoZSx0LGk9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0SW50KGUraSx0KX1fdXBkYXRlSW50Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMF09dCx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDEpfV91cGRhdGVJbnQyRm9yRWZmZWN0KGUsdCxpLHM9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0SW50MihlK3MsdCxpKX1fdXBkYXRlSW50MkZvclVuaWZvcm0oZSx0LGkpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMF09dCxWLl9UZW1wQnVmZmVySW50MzJWaWV3WzFdPWksdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwyKX1fdXBkYXRlSW50M0ZvckVmZmVjdChlLHQsaSxzLHI9IiIpe3RoaXMuX2N1cnJlbnRFZmZlY3Quc2V0SW50MyhlK3IsdCxpLHMpfV91cGRhdGVJbnQzRm9yVW5pZm9ybShlLHQsaSxzKXtWLl9UZW1wQnVmZmVySW50MzJWaWV3WzBdPXQsVi5fVGVtcEJ1ZmZlckludDMyVmlld1sxXT1pLFYuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMl09cyx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDMpfV91cGRhdGVJbnQ0Rm9yRWZmZWN0KGUsdCxpLHMscixuPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldEludDQoZStuLHQsaSxzLHIpfV91cGRhdGVJbnQ0Rm9yVW5pZm9ybShlLHQsaSxzLHIpe1YuX1RlbXBCdWZmZXJJbnQzMlZpZXdbMF09dCxWLl9UZW1wQnVmZmVySW50MzJWaWV3WzFdPWksVi5fVGVtcEJ1ZmZlckludDMyVmlld1syXT1zLFYuX1RlbXBCdWZmZXJJbnQzMlZpZXdbM109cix0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDQpfV91cGRhdGVVSW50Rm9yRWZmZWN0KGUsdCxpPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldFVJbnQoZStpLHQpfV91cGRhdGVVSW50Rm9yVW5pZm9ybShlLHQpe1YuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzBdPXQsdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwxKX1fdXBkYXRlVUludDJGb3JFZmZlY3QoZSx0LGkscz0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRVSW50MihlK3MsdCxpKX1fdXBkYXRlVUludDJGb3JVbmlmb3JtKGUsdCxpKXtWLl9UZW1wQnVmZmVyVUludDMyVmlld1swXT10LFYuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzFdPWksdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciwyKX1fdXBkYXRlVUludDNGb3JFZmZlY3QoZSx0LGkscyxyPSIiKXt0aGlzLl9jdXJyZW50RWZmZWN0LnNldFVJbnQzKGUrcix0LGkscyl9X3VwZGF0ZVVJbnQzRm9yVW5pZm9ybShlLHQsaSxzKXtWLl9UZW1wQnVmZmVyVUludDMyVmlld1swXT10LFYuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzFdPWksVi5fVGVtcEJ1ZmZlclVJbnQzMlZpZXdbMl09cyx0aGlzLnVwZGF0ZVVuaWZvcm0oZSxWLl9UZW1wQnVmZmVyLDMpfV91cGRhdGVVSW50NEZvckVmZmVjdChlLHQsaSxzLHIsbj0iIil7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRVSW50NChlK24sdCxpLHMscil9X3VwZGF0ZVVJbnQ0Rm9yVW5pZm9ybShlLHQsaSxzLHIpe1YuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzBdPXQsVi5fVGVtcEJ1ZmZlclVJbnQzMlZpZXdbMV09aSxWLl9UZW1wQnVmZmVyVUludDMyVmlld1syXT1zLFYuX1RlbXBCdWZmZXJVSW50MzJWaWV3WzNdPXIsdGhpcy51cGRhdGVVbmlmb3JtKGUsVi5fVGVtcEJ1ZmZlciw0KX1zZXRUZXh0dXJlKGUsdCl7dGhpcy5fY3VycmVudEVmZmVjdC5zZXRUZXh0dXJlKGUsdCl9dXBkYXRlVW5pZm9ybURpcmVjdGx5KGUsdCl7dGhpcy51cGRhdGVVbmlmb3JtKGUsdCx0Lmxlbmd0aCksdGhpcy51cGRhdGUoKX1iaW5kVG9FZmZlY3QoZSx0KXt0aGlzLl9jdXJyZW50RWZmZWN0PWUsdGhpcy5fY3VycmVudEVmZmVjdE5hbWU9dH1iaW5kVW5pZm9ybUJ1ZmZlcigpeyF0aGlzLl9ub1VCTyYmdGhpcy5fYnVmZmVyJiZ0aGlzLl9jdXJyZW50RWZmZWN0JiZ0aGlzLl9jdXJyZW50RWZmZWN0LmJpbmRVbmlmb3JtQnVmZmVyKHRoaXMuX2J1ZmZlcix0aGlzLl9jdXJyZW50RWZmZWN0TmFtZSl9dW5iaW5kRWZmZWN0KCl7dGhpcy5fY3VycmVudEVmZmVjdD12b2lkIDAsdGhpcy5fY3VycmVudEVmZmVjdE5hbWU9dm9pZCAwfXNldERhdGFCdWZmZXIoZSl7aWYoIXRoaXMuX2J1ZmZlcnMpcmV0dXJuIHRoaXMuX2J1ZmZlcj09PWU7Zm9yKGxldCB0PTA7dDx0aGlzLl9idWZmZXJzLmxlbmd0aDsrK3QpaWYodGhpcy5fYnVmZmVyc1t0XVswXT09PWUpcmV0dXJuIHRoaXMuX2J1ZmZlckluZGV4PXQsdGhpcy5fYnVmZmVyPWUsdGhpcy5fY3JlYXRlQnVmZmVyT25Xcml0ZT0hMSx0aGlzLl9jdXJyZW50RWZmZWN0PXZvaWQgMCwhMDtyZXR1cm4hMX1kaXNwb3NlKCl7aWYodGhpcy5fbm9VQk8pcmV0dXJuO2NvbnN0IGU9dGhpcy5fZW5naW5lLl91bmlmb3JtQnVmZmVycyx0PWUuaW5kZXhPZih0aGlzKTtpZih0IT09LTEmJihlW3RdPWVbZS5sZW5ndGgtMV0sZS5wb3AoKSksdGhpcy5fZW5naW5lLl9mZWF0dXJlcy50cmFja1Vib3NJbkZyYW1lJiZ0aGlzLl9idWZmZXJzKWZvcihsZXQgaT0wO2k8dGhpcy5fYnVmZmVycy5sZW5ndGg7KytpKXtjb25zdCBzPXRoaXMuX2J1ZmZlcnNbaV1bMF07dGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHMpfWVsc2UgdGhpcy5fYnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5fYnVmZmVyKSYmKHRoaXMuX2J1ZmZlcj1udWxsKX19Vi5fVXBkYXRlZFVib3NJbkZyYW1lPXt9LFYuX01BWF9VTklGT1JNX1NJWkU9MjU2LFYuX1RlbXBCdWZmZXI9bmV3IEZsb2F0MzJBcnJheShWLl9NQVhfVU5JRk9STV9TSVpFKSxWLl9UZW1wQnVmZmVySW50MzJWaWV3PW5ldyBJbnQzMkFycmF5KFYuX1RlbXBCdWZmZXIuYnVmZmVyKSxWLl9UZW1wQnVmZmVyVUludDMyVmlldz1uZXcgVWludDMyQXJyYXkoVi5fVGVtcEJ1ZmZlci5idWZmZXIpO2NsYXNzICRpe2NvbnN0cnVjdG9yKGUsdCxpLHM9MCxyPSExLG49ITEsYT0hMSxvKXt0aGlzLl9pc0FscmVhZHlPd25lZD0hMSxlLmdldFNjZW5lP3RoaXMuX2VuZ2luZT1lLmdldFNjZW5lKCkuZ2V0RW5naW5lKCk6dGhpcy5fZW5naW5lPWUsdGhpcy5fdXBkYXRhYmxlPWksdGhpcy5faW5zdGFuY2VkPW4sdGhpcy5fZGl2aXNvcj1vfHwxLHQgaW5zdGFuY2VvZiBQaT8odGhpcy5fZGF0YT1udWxsLHRoaXMuX2J1ZmZlcj10KToodGhpcy5fZGF0YT10LHRoaXMuX2J1ZmZlcj1udWxsKSx0aGlzLmJ5dGVTdHJpZGU9YT9zOnMqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULHJ8fHRoaXMuY3JlYXRlKCl9Y3JlYXRlVmVydGV4QnVmZmVyKGUsdCxpLHMscixuPSExLGEpe2NvbnN0IG89bj90OnQqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULGg9cz9uP3M6cypGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQ6dGhpcy5ieXRlU3RyaWRlO3JldHVybiBuZXcgZyh0aGlzLl9lbmdpbmUsdGhpcyxlLHRoaXMuX3VwZGF0YWJsZSwhMCxoLHI9PT12b2lkIDA/dGhpcy5faW5zdGFuY2VkOnIsbyxpLHZvaWQgMCx2b2lkIDAsITAsdGhpcy5fZGl2aXNvcnx8YSl9aXNVcGRhdGFibGUoKXtyZXR1cm4gdGhpcy5fdXBkYXRhYmxlfWdldERhdGEoKXtyZXR1cm4gdGhpcy5fZGF0YX1nZXRCdWZmZXIoKXtyZXR1cm4gdGhpcy5fYnVmZmVyfWdldFN0cmlkZVNpemUoKXtyZXR1cm4gdGhpcy5ieXRlU3RyaWRlL0Zsb2F0MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVH1jcmVhdGUoZT1udWxsKXshZSYmdGhpcy5fYnVmZmVyfHwoZT1lfHx0aGlzLl9kYXRhLGUmJih0aGlzLl9idWZmZXI/dGhpcy5fdXBkYXRhYmxlJiYodGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXIodGhpcy5fYnVmZmVyLGUpLHRoaXMuX2RhdGE9ZSk6dGhpcy5fdXBkYXRhYmxlPyh0aGlzLl9idWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXIoZSksdGhpcy5fZGF0YT1lKTp0aGlzLl9idWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZVZlcnRleEJ1ZmZlcihlKSkpfV9yZWJ1aWxkKCl7dGhpcy5fYnVmZmVyPW51bGwsdGhpcy5jcmVhdGUodGhpcy5fZGF0YSl9dXBkYXRlKGUpe3RoaXMuY3JlYXRlKGUpfXVwZGF0ZURpcmVjdGx5KGUsdCxpLHM9ITEpe3RoaXMuX2J1ZmZlciYmdGhpcy5fdXBkYXRhYmxlJiYodGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNWZXJ0ZXhCdWZmZXIodGhpcy5fYnVmZmVyLGUscz90OnQqRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULGk/aSp0aGlzLmJ5dGVTdHJpZGU6dm9pZCAwKSx0PT09MCYmaT09PXZvaWQgMD90aGlzLl9kYXRhPWU6dGhpcy5fZGF0YT1udWxsKX1faW5jcmVhc2VSZWZlcmVuY2VzKCl7aWYodGhpcy5fYnVmZmVyKXtpZighdGhpcy5faXNBbHJlYWR5T3duZWQpe3RoaXMuX2lzQWxyZWFkeU93bmVkPSEwO3JldHVybn10aGlzLl9idWZmZXIucmVmZXJlbmNlcysrfX1kaXNwb3NlKCl7dGhpcy5fYnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5fYnVmZmVyKSYmKHRoaXMuX2J1ZmZlcj1udWxsLHRoaXMuX2RhdGE9bnVsbCl9fWNsYXNzIGd7Y29uc3RydWN0b3IoZSx0LGkscyxyLG4sYSxvLGgsbCx1PSExLGQ9ITEsZj0xLF89ITEpe2lmKHQgaW5zdGFuY2VvZiAkaT8odGhpcy5fYnVmZmVyPXQsdGhpcy5fb3duc0J1ZmZlcj1fKToodGhpcy5fYnVmZmVyPW5ldyAkaShlLHQscyxuLHIsYSxkKSx0aGlzLl9vd25zQnVmZmVyPSEwKSx0aGlzLnVuaXF1ZUlkPWcuX0NvdW50ZXIrKyx0aGlzLl9raW5kPWksbD09bnVsbCl7Y29uc3QgbT10aGlzLmdldERhdGEoKTt0aGlzLnR5cGU9Zy5GTE9BVCxtIGluc3RhbmNlb2YgSW50OEFycmF5P3RoaXMudHlwZT1nLkJZVEU6bSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXk/dGhpcy50eXBlPWcuVU5TSUdORURfQllURTptIGluc3RhbmNlb2YgSW50MTZBcnJheT90aGlzLnR5cGU9Zy5TSE9SVDptIGluc3RhbmNlb2YgVWludDE2QXJyYXk/dGhpcy50eXBlPWcuVU5TSUdORURfU0hPUlQ6bSBpbnN0YW5jZW9mIEludDMyQXJyYXk/dGhpcy50eXBlPWcuSU5UOm0gaW5zdGFuY2VvZiBVaW50MzJBcnJheSYmKHRoaXMudHlwZT1nLlVOU0lHTkVEX0lOVCl9ZWxzZSB0aGlzLnR5cGU9bDtjb25zdCBFPWcuR2V0VHlwZUJ5dGVMZW5ndGgodGhpcy50eXBlKTtkPyh0aGlzLl9zaXplPWh8fChuP24vRTpnLkRlZHVjZVN0cmlkZShpKSksdGhpcy5ieXRlU3RyaWRlPW58fHRoaXMuX2J1ZmZlci5ieXRlU3RyaWRlfHx0aGlzLl9zaXplKkUsdGhpcy5ieXRlT2Zmc2V0PW98fDApOih0aGlzLl9zaXplPWh8fG58fGcuRGVkdWNlU3RyaWRlKGkpLHRoaXMuYnl0ZVN0cmlkZT1uP24qRTp0aGlzLl9idWZmZXIuYnl0ZVN0cmlkZXx8dGhpcy5fc2l6ZSpFLHRoaXMuYnl0ZU9mZnNldD0ob3x8MCkqRSksdGhpcy5ub3JtYWxpemVkPXUsdGhpcy5faW5zdGFuY2VkPWEhPT12b2lkIDA/YTohMSx0aGlzLl9pbnN0YW5jZURpdmlzb3I9YT9mOjAsdGhpcy5fY29tcHV0ZUhhc2hDb2RlKCl9Z2V0IGluc3RhbmNlRGl2aXNvcigpe3JldHVybiB0aGlzLl9pbnN0YW5jZURpdmlzb3J9c2V0IGluc3RhbmNlRGl2aXNvcihlKXtjb25zdCB0PWUhPTA7dGhpcy5faW5zdGFuY2VEaXZpc29yPWUsdCE9PXRoaXMuX2luc3RhbmNlZCYmKHRoaXMuX2luc3RhbmNlZD10LHRoaXMuX2NvbXB1dGVIYXNoQ29kZSgpKX1fY29tcHV0ZUhhc2hDb2RlKCl7dGhpcy5oYXNoQ29kZT0odGhpcy50eXBlLTUxMjA8PDApKygodGhpcy5ub3JtYWxpemVkPzE6MCk8PDMpKyh0aGlzLl9zaXplPDw0KSsoKHRoaXMuX2luc3RhbmNlZD8xOjApPDw2KSsodGhpcy5ieXRlU3RyaWRlPDwxMil9X3JlYnVpbGQoKXt0aGlzLl9idWZmZXImJnRoaXMuX2J1ZmZlci5fcmVidWlsZCgpfWdldEtpbmQoKXtyZXR1cm4gdGhpcy5fa2luZH1pc1VwZGF0YWJsZSgpe3JldHVybiB0aGlzLl9idWZmZXIuaXNVcGRhdGFibGUoKX1nZXREYXRhKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5nZXREYXRhKCl9Z2V0RmxvYXREYXRhKGUsdCl7Y29uc3QgaT10aGlzLmdldERhdGEoKTtpZighaSlyZXR1cm4gbnVsbDtjb25zdCBzPXRoaXMuZ2V0U2l6ZSgpKmcuR2V0VHlwZUJ5dGVMZW5ndGgodGhpcy50eXBlKSxyPWUqdGhpcy5nZXRTaXplKCk7aWYodGhpcy50eXBlIT09Zy5GTE9BVHx8dGhpcy5ieXRlU3RyaWRlIT09cyl7Y29uc3Qgbj1uZXcgRmxvYXQzMkFycmF5KHIpO3JldHVybiB0aGlzLmZvckVhY2gociwoYSxvKT0+bltvXT1hKSxufWlmKCEoaSBpbnN0YW5jZW9mIEFycmF5fHxpIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXx8dGhpcy5ieXRlT2Zmc2V0IT09MHx8aS5sZW5ndGghPT1yKWlmKGkgaW5zdGFuY2VvZiBBcnJheSl7Y29uc3Qgbj10aGlzLmJ5dGVPZmZzZXQvNDtyZXR1cm4gaS5zbGljZShuLG4rcil9ZWxzZXtpZihpIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoaSx0aGlzLmJ5dGVPZmZzZXQscik7e2xldCBuPWkuYnl0ZU9mZnNldCt0aGlzLmJ5dGVPZmZzZXQ7aWYodCl7Y29uc3Qgbz1uZXcgRmxvYXQzMkFycmF5KHIpLGg9bmV3IEZsb2F0MzJBcnJheShpLmJ1ZmZlcixuLHIpO3JldHVybiBvLnNldChoKSxvfWNvbnN0IGE9biU0O3JldHVybiBhJiYobj1NYXRoLm1heCgwLG4tYSkpLG5ldyBGbG9hdDMyQXJyYXkoaS5idWZmZXIsbixyKX19cmV0dXJuIHQ/aS5zbGljZSgpOml9Z2V0QnVmZmVyKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5nZXRCdWZmZXIoKX1nZXRTdHJpZGVTaXplKCl7cmV0dXJuIHRoaXMuYnl0ZVN0cmlkZS9nLkdldFR5cGVCeXRlTGVuZ3RoKHRoaXMudHlwZSl9Z2V0T2Zmc2V0KCl7cmV0dXJuIHRoaXMuYnl0ZU9mZnNldC9nLkdldFR5cGVCeXRlTGVuZ3RoKHRoaXMudHlwZSl9Z2V0U2l6ZShlPSExKXtyZXR1cm4gZT90aGlzLl9zaXplKmcuR2V0VHlwZUJ5dGVMZW5ndGgodGhpcy50eXBlKTp0aGlzLl9zaXplfWdldElzSW5zdGFuY2VkKCl7cmV0dXJuIHRoaXMuX2luc3RhbmNlZH1nZXRJbnN0YW5jZURpdmlzb3IoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEaXZpc29yfWNyZWF0ZShlKXt0aGlzLl9idWZmZXIuY3JlYXRlKGUpfXVwZGF0ZShlKXt0aGlzLl9idWZmZXIudXBkYXRlKGUpfXVwZGF0ZURpcmVjdGx5KGUsdCxpPSExKXt0aGlzLl9idWZmZXIudXBkYXRlRGlyZWN0bHkoZSx0LHZvaWQgMCxpKX1kaXNwb3NlKCl7dGhpcy5fb3duc0J1ZmZlciYmdGhpcy5fYnVmZmVyLmRpc3Bvc2UoKX1mb3JFYWNoKGUsdCl7Zy5Gb3JFYWNoKHRoaXMuX2J1ZmZlci5nZXREYXRhKCksdGhpcy5ieXRlT2Zmc2V0LHRoaXMuYnl0ZVN0cmlkZSx0aGlzLl9zaXplLHRoaXMudHlwZSxlLHRoaXMubm9ybWFsaXplZCx0KX1zdGF0aWMgRGVkdWNlU3RyaWRlKGUpe3N3aXRjaChlKXtjYXNlIGcuVVZLaW5kOmNhc2UgZy5VVjJLaW5kOmNhc2UgZy5VVjNLaW5kOmNhc2UgZy5VVjRLaW5kOmNhc2UgZy5VVjVLaW5kOmNhc2UgZy5VVjZLaW5kOnJldHVybiAyO2Nhc2UgZy5Ob3JtYWxLaW5kOmNhc2UgZy5Qb3NpdGlvbktpbmQ6cmV0dXJuIDM7Y2FzZSBnLkNvbG9yS2luZDpjYXNlIGcuTWF0cmljZXNJbmRpY2VzS2luZDpjYXNlIGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kOmNhc2UgZy5NYXRyaWNlc1dlaWdodHNLaW5kOmNhc2UgZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQ6Y2FzZSBnLlRhbmdlbnRLaW5kOnJldHVybiA0O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGtpbmQgJyIrZSsiJyIpfX1zdGF0aWMgR2V0VHlwZUJ5dGVMZW5ndGgoZSl7c3dpdGNoKGUpe2Nhc2UgZy5CWVRFOmNhc2UgZy5VTlNJR05FRF9CWVRFOnJldHVybiAxO2Nhc2UgZy5TSE9SVDpjYXNlIGcuVU5TSUdORURfU0hPUlQ6cmV0dXJuIDI7Y2FzZSBnLklOVDpjYXNlIGcuVU5TSUdORURfSU5UOmNhc2UgZy5GTE9BVDpyZXR1cm4gNDtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0eXBlICcke2V9J2ApfX1zdGF0aWMgRm9yRWFjaChlLHQsaSxzLHIsbixhLG8pe2lmKGUgaW5zdGFuY2VvZiBBcnJheSl7bGV0IGg9dC80O2NvbnN0IGw9aS80O2ZvcihsZXQgdT0wO3U8bjt1Kz1zKXtmb3IobGV0IGQ9MDtkPHM7ZCsrKW8oZVtoK2RdLHUrZCk7aCs9bH19ZWxzZXtjb25zdCBoPWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgRGF0YVZpZXcoZSk6bmV3IERhdGFWaWV3KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCxlLmJ5dGVMZW5ndGgpLGw9Zy5HZXRUeXBlQnl0ZUxlbmd0aChyKTtmb3IobGV0IHU9MDt1PG47dSs9cyl7bGV0IGQ9dDtmb3IobGV0IGY9MDtmPHM7ZisrKXtjb25zdCBfPWcuX0dldEZsb2F0VmFsdWUoaCxyLGQsYSk7byhfLHUrZiksZCs9bH10Kz1pfX19c3RhdGljIF9HZXRGbG9hdFZhbHVlKGUsdCxpLHMpe3N3aXRjaCh0KXtjYXNlIGcuQllURTp7bGV0IHI9ZS5nZXRJbnQ4KGkpO3JldHVybiBzJiYocj1NYXRoLm1heChyLzEyNywtMSkpLHJ9Y2FzZSBnLlVOU0lHTkVEX0JZVEU6e2xldCByPWUuZ2V0VWludDgoaSk7cmV0dXJuIHMmJihyPXIvMjU1KSxyfWNhc2UgZy5TSE9SVDp7bGV0IHI9ZS5nZXRJbnQxNihpLCEwKTtyZXR1cm4gcyYmKHI9TWF0aC5tYXgoci8zMjc2NywtMSkpLHJ9Y2FzZSBnLlVOU0lHTkVEX1NIT1JUOntsZXQgcj1lLmdldFVpbnQxNihpLCEwKTtyZXR1cm4gcyYmKHI9ci82NTUzNSkscn1jYXNlIGcuSU5UOnJldHVybiBlLmdldEludDMyKGksITApO2Nhc2UgZy5VTlNJR05FRF9JTlQ6cmV0dXJuIGUuZ2V0VWludDMyKGksITApO2Nhc2UgZy5GTE9BVDpyZXR1cm4gZS5nZXRGbG9hdDMyKGksITApO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGNvbXBvbmVudCB0eXBlICR7dH1gKX19fWcuX0NvdW50ZXI9MCxnLkJZVEU9NTEyMCxnLlVOU0lHTkVEX0JZVEU9NTEyMSxnLlNIT1JUPTUxMjIsZy5VTlNJR05FRF9TSE9SVD01MTIzLGcuSU5UPTUxMjQsZy5VTlNJR05FRF9JTlQ9NTEyNSxnLkZMT0FUPTUxMjYsZy5Qb3NpdGlvbktpbmQ9InBvc2l0aW9uIixnLk5vcm1hbEtpbmQ9Im5vcm1hbCIsZy5UYW5nZW50S2luZD0idGFuZ2VudCIsZy5VVktpbmQ9InV2IixnLlVWMktpbmQ9InV2MiIsZy5VVjNLaW5kPSJ1djMiLGcuVVY0S2luZD0idXY0IixnLlVWNUtpbmQ9InV2NSIsZy5VVjZLaW5kPSJ1djYiLGcuQ29sb3JLaW5kPSJjb2xvciIsZy5Db2xvckluc3RhbmNlS2luZD0iaW5zdGFuY2VDb2xvciIsZy5NYXRyaWNlc0luZGljZXNLaW5kPSJtYXRyaWNlc0luZGljZXMiLGcuTWF0cmljZXNXZWlnaHRzS2luZD0ibWF0cmljZXNXZWlnaHRzIixnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZD0ibWF0cmljZXNJbmRpY2VzRXh0cmEiLGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kPSJtYXRyaWNlc1dlaWdodHNFeHRyYSI7Y2xhc3MgVXR7Y29uc3RydWN0b3IoKXt0aGlzLmhpdD0hMSx0aGlzLmRpc3RhbmNlPTAsdGhpcy5waWNrZWRQb2ludD1udWxsLHRoaXMucGlja2VkTWVzaD1udWxsLHRoaXMuYnU9MCx0aGlzLmJ2PTAsdGhpcy5mYWNlSWQ9LTEsdGhpcy5zdWJNZXNoRmFjZUlkPS0xLHRoaXMuc3ViTWVzaElkPTAsdGhpcy5waWNrZWRTcHJpdGU9bnVsbCx0aGlzLnRoaW5JbnN0YW5jZUluZGV4PS0xLHRoaXMucmF5PW51bGwsdGhpcy5vcmlnaW5NZXNoPW51bGwsdGhpcy5haW1UcmFuc2Zvcm09bnVsbCx0aGlzLmdyaXBUcmFuc2Zvcm09bnVsbH1nZXROb3JtYWwoZT0hMSx0PSEwKXtpZighdGhpcy5waWNrZWRNZXNofHx0JiYhdGhpcy5waWNrZWRNZXNoLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpKXJldHVybiBudWxsO2NvbnN0IGk9dGhpcy5waWNrZWRNZXNoLmdldEluZGljZXMoKTtpZighaSlyZXR1cm4gbnVsbDtsZXQgcztpZih0KXtjb25zdCBuPXRoaXMucGlja2VkTWVzaC5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKTtsZXQgYT1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqM10qMyksbz1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqMysxXSozKSxoPXAuRnJvbUFycmF5KG4saVt0aGlzLmZhY2VJZCozKzJdKjMpO2E9YS5zY2FsZSh0aGlzLmJ1KSxvPW8uc2NhbGUodGhpcy5idiksaD1oLnNjYWxlKDEtdGhpcy5idS10aGlzLmJ2KSxzPW5ldyBwKGEueCtvLngraC54LGEueStvLnkraC55LGEueitvLnoraC56KX1lbHNle2NvbnN0IG49dGhpcy5waWNrZWRNZXNoLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCksYT1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqM10qMyksbz1wLkZyb21BcnJheShuLGlbdGhpcy5mYWNlSWQqMysxXSozKSxoPXAuRnJvbUFycmF5KG4saVt0aGlzLmZhY2VJZCozKzJdKjMpLGw9YS5zdWJ0cmFjdChvKSx1PWguc3VidHJhY3Qobyk7cz1wLkNyb3NzKGwsdSl9Y29uc3Qgcj0obixhKT0+e2xldCBvPW4uZ2V0V29ybGRNYXRyaXgoKTtuLm5vblVuaWZvcm1TY2FsaW5nJiYoRC5NYXRyaXhbMF0uY29weUZyb20obyksbz1ELk1hdHJpeFswXSxvLnNldFRyYW5zbGF0aW9uRnJvbUZsb2F0cygwLDAsMCksby5pbnZlcnQoKSxvLnRyYW5zcG9zZVRvUmVmKEQuTWF0cml4WzFdKSxvPUQuTWF0cml4WzFdKSxwLlRyYW5zZm9ybU5vcm1hbFRvUmVmKGEsbyxhKX07aWYoZSYmcih0aGlzLnBpY2tlZE1lc2gscyksdGhpcy5yYXkpe2NvbnN0IG49RC5WZWN0b3IzWzBdLmNvcHlGcm9tKHMpO2V8fHIodGhpcy5waWNrZWRNZXNoLG4pLHAuRG90KG4sdGhpcy5yYXkuZGlyZWN0aW9uKT4wJiZzLm5lZ2F0ZUluUGxhY2UoKX1yZXR1cm4gcy5ub3JtYWxpemUoKSxzfWdldFRleHR1cmVDb29yZGluYXRlcygpe2lmKCF0aGlzLnBpY2tlZE1lc2h8fCF0aGlzLnBpY2tlZE1lc2guaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVVZLaW5kKSlyZXR1cm4gbnVsbDtjb25zdCBlPXRoaXMucGlja2VkTWVzaC5nZXRJbmRpY2VzKCk7aWYoIWUpcmV0dXJuIG51bGw7Y29uc3QgdD10aGlzLnBpY2tlZE1lc2guZ2V0VmVydGljZXNEYXRhKGcuVVZLaW5kKTtpZighdClyZXR1cm4gbnVsbDtsZXQgaT12ZS5Gcm9tQXJyYXkodCxlW3RoaXMuZmFjZUlkKjNdKjIpLHM9dmUuRnJvbUFycmF5KHQsZVt0aGlzLmZhY2VJZCozKzFdKjIpLHI9dmUuRnJvbUFycmF5KHQsZVt0aGlzLmZhY2VJZCozKzJdKjIpO3JldHVybiBpPWkuc2NhbGUodGhpcy5idSkscz1zLnNjYWxlKHRoaXMuYnYpLHI9ci5zY2FsZSgxLXRoaXMuYnUtdGhpcy5idiksbmV3IHZlKGkueCtzLngrci54LGkueStzLnkrci55KX19Y2xhc3MgVmV7Y29uc3RydWN0b3IoZSx0LGkscyxyLG4pe3RoaXMuc291cmNlPWUsdGhpcy5wb2ludGVyWD10LHRoaXMucG9pbnRlclk9aSx0aGlzLm1lc2hVbmRlclBvaW50ZXI9cyx0aGlzLnNvdXJjZUV2ZW50PXIsdGhpcy5hZGRpdGlvbmFsRGF0YT1ufXN0YXRpYyBDcmVhdGVOZXcoZSx0LGkpe2NvbnN0IHM9ZS5nZXRTY2VuZSgpO3JldHVybiBuZXcgVmUoZSxzLnBvaW50ZXJYLHMucG9pbnRlclkscy5tZXNoVW5kZXJQb2ludGVyfHxlLHQsaSl9c3RhdGljIENyZWF0ZU5ld0Zyb21TcHJpdGUoZSx0LGkscyl7cmV0dXJuIG5ldyBWZShlLHQucG9pbnRlclgsdC5wb2ludGVyWSx0Lm1lc2hVbmRlclBvaW50ZXIsaSxzKX1zdGF0aWMgQ3JlYXRlTmV3RnJvbVNjZW5lKGUsdCl7cmV0dXJuIG5ldyBWZShudWxsLGUucG9pbnRlclgsZS5wb2ludGVyWSxlLm1lc2hVbmRlclBvaW50ZXIsdCl9c3RhdGljIENyZWF0ZU5ld0Zyb21QcmltaXRpdmUoZSx0LGkscyl7cmV0dXJuIG5ldyBWZShlLHQueCx0LnksbnVsbCxpLHMpfX1jbGFzcyBRaXtjb25zdHJ1Y3RvcihlKXt0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX3NjZW5lPWV9X3ByZXBhcmVCdWZmZXJzKCl7aWYodGhpcy5fdmVydGV4QnVmZmVyc1tnLlBvc2l0aW9uS2luZF0pcmV0dXJuO2NvbnN0IGU9W107ZS5wdXNoKDEsMSksZS5wdXNoKC0xLDEpLGUucHVzaCgtMSwtMSksZS5wdXNoKDEsLTEpLHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZy5Qb3NpdGlvbktpbmRdPW5ldyBnKHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLGUsZy5Qb3NpdGlvbktpbmQsITEsITEsMiksdGhpcy5fYnVpbGRJbmRleEJ1ZmZlcigpfV9idWlsZEluZGV4QnVmZmVyKCl7Y29uc3QgZT1bXTtlLnB1c2goMCksZS5wdXNoKDEpLGUucHVzaCgyKSxlLnB1c2goMCksZS5wdXNoKDIpLGUucHVzaCgzKSx0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVJbmRleEJ1ZmZlcihlKX1fcmVidWlsZCgpe2NvbnN0IGU9dGhpcy5fdmVydGV4QnVmZmVyc1tnLlBvc2l0aW9uS2luZF07ZSYmKGUuX3JlYnVpbGQoKSx0aGlzLl9idWlsZEluZGV4QnVmZmVyKCkpfV9wcmVwYXJlRnJhbWUoZT1udWxsLHQ9bnVsbCl7Y29uc3QgaT10aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmE7cmV0dXJuIWl8fCh0PXR8fGkuX3Bvc3RQcm9jZXNzZXMuZmlsdGVyKHM9PnMhPW51bGwpLCF0fHx0Lmxlbmd0aD09PTB8fCF0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZCk/ITE6KHRbMF0uYWN0aXZhdGUoaSxlLHQhPW51bGwpLCEwKX1kaXJlY3RSZW5kZXIoZSx0PW51bGwsaT0hMSxzPTAscj0wLG49ITEpe3ZhciBhO2NvbnN0IG89dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7Zm9yKGxldCBoPTA7aDxlLmxlbmd0aDtoKyspe2g8ZS5sZW5ndGgtMT9lW2grMV0uYWN0aXZhdGUodGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLHQ9PW51bGw/dm9pZCAwOnQudGV4dHVyZSk6KHQ/by5iaW5kRnJhbWVidWZmZXIodCxzLHZvaWQgMCx2b2lkIDAsaSxyKTpufHxvLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSwoYT1vLl9kZWJ1Z0luc2VydE1hcmtlcik9PT1udWxsfHxhPT09dm9pZCAwfHxhLmNhbGwobyxgcG9zdCBwcm9jZXNzICR7ZVtoXS5uYW1lfSBvdXRwdXRgKSk7Y29uc3QgbD1lW2hdLHU9bC5hcHBseSgpO3UmJihsLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModSksdGhpcy5fcHJlcGFyZUJ1ZmZlcnMoKSxvLmJpbmRCdWZmZXJzKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsdGhpcy5faW5kZXhCdWZmZXIsdSksby5kcmF3RWxlbWVudHNUeXBlKDAsMCw2KSxsLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh1KSl9by5zZXREZXB0aEJ1ZmZlcighMCksby5zZXREZXB0aFdyaXRlKCEwKX1fZmluYWxpemVGcmFtZShlLHQsaSxzLHI9ITEpe3ZhciBuO2NvbnN0IGE9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO2lmKCFhfHwocz1zfHxhLl9wb3N0UHJvY2Vzc2VzLmZpbHRlcihoPT5oIT1udWxsKSxzLmxlbmd0aD09PTB8fCF0aGlzLl9zY2VuZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZCkpcmV0dXJuO2NvbnN0IG89dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7Zm9yKGxldCBoPTAsbD1zLmxlbmd0aDtoPGw7aCsrKXtjb25zdCB1PXNbaF07aWYoaDxsLTE/dS5fb3V0cHV0VGV4dHVyZT1zW2grMV0uYWN0aXZhdGUoYSx0PT1udWxsP3ZvaWQgMDp0LnRleHR1cmUpOih0PyhvLmJpbmRGcmFtZWJ1ZmZlcih0LGksdm9pZCAwLHZvaWQgMCxyKSx1Ll9vdXRwdXRUZXh0dXJlPXQpOihvLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSx1Ll9vdXRwdXRUZXh0dXJlPW51bGwpLChuPW8uX2RlYnVnSW5zZXJ0TWFya2VyKT09PW51bGx8fG49PT12b2lkIDB8fG4uY2FsbChvLGBwb3N0IHByb2Nlc3MgJHtzW2hdLm5hbWV9IG91dHB1dGApKSxlKWJyZWFrO2NvbnN0IGQ9dS5hcHBseSgpO2QmJih1Lm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZCksdGhpcy5fcHJlcGFyZUJ1ZmZlcnMoKSxvLmJpbmRCdWZmZXJzKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsdGhpcy5faW5kZXhCdWZmZXIsZCksby5kcmF3RWxlbWVudHNUeXBlKDAsMCw2KSx1Lm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhkKSl9by5zZXREZXB0aEJ1ZmZlcighMCksby5zZXREZXB0aFdyaXRlKCEwKSxvLnNldEFscGhhTW9kZSgwKX1kaXNwb3NlKCl7Y29uc3QgZT10aGlzLl92ZXJ0ZXhCdWZmZXJzW2cuUG9zaXRpb25LaW5kXTtlJiYoZS5kaXNwb3NlKCksdGhpcy5fdmVydGV4QnVmZmVyc1tnLlBvc2l0aW9uS2luZF09bnVsbCksdGhpcy5faW5kZXhCdWZmZXImJih0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5fcmVsZWFzZUJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlciksdGhpcy5faW5kZXhCdWZmZXI9bnVsbCl9fWNsYXNzIFN0e2NvbnN0cnVjdG9yKGUsdCxpPW51bGwscz1udWxsLHI9bnVsbCl7dGhpcy5pbmRleD1lLHRoaXMuX29wYXF1ZVN1Yk1lc2hlcz1uZXcgJGUoMjU2KSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcz1uZXcgJGUoMjU2KSx0aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXM9bmV3ICRlKDI1NiksdGhpcy5fZGVwdGhPbmx5U3ViTWVzaGVzPW5ldyAkZSgyNTYpLHRoaXMuX3BhcnRpY2xlU3lzdGVtcz1uZXcgJGUoMjU2KSx0aGlzLl9zcHJpdGVNYW5hZ2Vycz1uZXcgJGUoMjU2KSx0aGlzLl9lbXB0eT0hMCx0aGlzLl9lZGdlc1JlbmRlcmVycz1uZXcgaGkoMTYpLHRoaXMuX3NjZW5lPXQsdGhpcy5vcGFxdWVTb3J0Q29tcGFyZUZuPWksdGhpcy5hbHBoYVRlc3RTb3J0Q29tcGFyZUZuPXMsdGhpcy50cmFuc3BhcmVudFNvcnRDb21wYXJlRm49cn1zZXQgb3BhcXVlU29ydENvbXBhcmVGbihlKXtlP3RoaXMuX29wYXF1ZVNvcnRDb21wYXJlRm49ZTp0aGlzLl9vcGFxdWVTb3J0Q29tcGFyZUZuPVN0LlBhaW50ZXJTb3J0Q29tcGFyZSx0aGlzLl9yZW5kZXJPcGFxdWU9dGhpcy5fcmVuZGVyT3BhcXVlU29ydGVkfXNldCBhbHBoYVRlc3RTb3J0Q29tcGFyZUZuKGUpe2U/dGhpcy5fYWxwaGFUZXN0U29ydENvbXBhcmVGbj1lOnRoaXMuX2FscGhhVGVzdFNvcnRDb21wYXJlRm49U3QuUGFpbnRlclNvcnRDb21wYXJlLHRoaXMuX3JlbmRlckFscGhhVGVzdD10aGlzLl9yZW5kZXJBbHBoYVRlc3RTb3J0ZWR9c2V0IHRyYW5zcGFyZW50U29ydENvbXBhcmVGbihlKXtlP3RoaXMuX3RyYW5zcGFyZW50U29ydENvbXBhcmVGbj1lOnRoaXMuX3RyYW5zcGFyZW50U29ydENvbXBhcmVGbj1TdC5kZWZhdWx0VHJhbnNwYXJlbnRTb3J0Q29tcGFyZSx0aGlzLl9yZW5kZXJUcmFuc3BhcmVudD10aGlzLl9yZW5kZXJUcmFuc3BhcmVudFNvcnRlZH1yZW5kZXIoZSx0LGkscyl7aWYoZSl7ZSh0aGlzLl9vcGFxdWVTdWJNZXNoZXMsdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzLHRoaXMuX2RlcHRoT25seVN1Yk1lc2hlcyk7cmV0dXJufWNvbnN0IHI9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7dGhpcy5fZGVwdGhPbmx5U3ViTWVzaGVzLmxlbmd0aCE9PTAmJihyLnNldENvbG9yV3JpdGUoITEpLHRoaXMuX3JlbmRlckFscGhhVGVzdCh0aGlzLl9kZXB0aE9ubHlTdWJNZXNoZXMpLHIuc2V0Q29sb3JXcml0ZSghMCkpLHRoaXMuX29wYXF1ZVN1Yk1lc2hlcy5sZW5ndGghPT0wJiZ0aGlzLl9yZW5kZXJPcGFxdWUodGhpcy5fb3BhcXVlU3ViTWVzaGVzKSx0aGlzLl9hbHBoYVRlc3RTdWJNZXNoZXMubGVuZ3RoIT09MCYmdGhpcy5fcmVuZGVyQWxwaGFUZXN0KHRoaXMuX2FscGhhVGVzdFN1Yk1lc2hlcyk7Y29uc3Qgbj1yLmdldFN0ZW5jaWxCdWZmZXIoKTtpZihyLnNldFN0ZW5jaWxCdWZmZXIoITEpLHQmJnRoaXMuX3JlbmRlclNwcml0ZXMoKSxpJiZ0aGlzLl9yZW5kZXJQYXJ0aWNsZXMocyksdGhpcy5vbkJlZm9yZVRyYW5zcGFyZW50UmVuZGVyaW5nJiZ0aGlzLm9uQmVmb3JlVHJhbnNwYXJlbnRSZW5kZXJpbmcoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5sZW5ndGghPT0wfHx0aGlzLl9zY2VuZS51c2VPcmRlckluZGVwZW5kZW50VHJhbnNwYXJlbmN5KXtpZihyLnNldFN0ZW5jaWxCdWZmZXIobiksdGhpcy5fc2NlbmUudXNlT3JkZXJJbmRlcGVuZGVudFRyYW5zcGFyZW5jeSl7Y29uc3QgYT10aGlzLl9zY2VuZS5kZXB0aFBlZWxpbmdSZW5kZXJlci5yZW5kZXIodGhpcy5fdHJhbnNwYXJlbnRTdWJNZXNoZXMpO2EubGVuZ3RoJiZ0aGlzLl9yZW5kZXJUcmFuc3BhcmVudChhKX1lbHNlIHRoaXMuX3JlbmRlclRyYW5zcGFyZW50KHRoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzKTtyLnNldEFscGhhTW9kZSgwKX1pZihyLnNldFN0ZW5jaWxCdWZmZXIoITEpLHRoaXMuX2VkZ2VzUmVuZGVyZXJzLmxlbmd0aCl7Zm9yKGxldCBhPTA7YTx0aGlzLl9lZGdlc1JlbmRlcmVycy5sZW5ndGg7YSsrKXRoaXMuX2VkZ2VzUmVuZGVyZXJzLmRhdGFbYV0ucmVuZGVyKCk7ci5zZXRBbHBoYU1vZGUoMCl9ci5zZXRTdGVuY2lsQnVmZmVyKG4pfV9yZW5kZXJPcGFxdWVTb3J0ZWQoZSl7cmV0dXJuIFN0Ll9SZW5kZXJTb3J0ZWQoZSx0aGlzLl9vcGFxdWVTb3J0Q29tcGFyZUZuLHRoaXMuX3NjZW5lLmFjdGl2ZUNhbWVyYSwhMSl9X3JlbmRlckFscGhhVGVzdFNvcnRlZChlKXtyZXR1cm4gU3QuX1JlbmRlclNvcnRlZChlLHRoaXMuX2FscGhhVGVzdFNvcnRDb21wYXJlRm4sdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLCExKX1fcmVuZGVyVHJhbnNwYXJlbnRTb3J0ZWQoZSl7cmV0dXJuIFN0Ll9SZW5kZXJTb3J0ZWQoZSx0aGlzLl90cmFuc3BhcmVudFNvcnRDb21wYXJlRm4sdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLCEwKX1zdGF0aWMgX1JlbmRlclNvcnRlZChlLHQsaSxzKXtsZXQgcj0wLG47Y29uc3QgYT1pP2kuZ2xvYmFsUG9zaXRpb246U3QuX1plcm9WZWN0b3I7aWYocylmb3IoO3I8ZS5sZW5ndGg7cisrKW49ZS5kYXRhW3JdLG4uX2FscGhhSW5kZXg9bi5nZXRNZXNoKCkuYWxwaGFJbmRleCxuLl9kaXN0YW5jZVRvQ2FtZXJhPXAuRGlzdGFuY2Uobi5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ1NwaGVyZS5jZW50ZXJXb3JsZCxhKTtjb25zdCBvPWUubGVuZ3RoPT09ZS5kYXRhLmxlbmd0aD9lLmRhdGE6ZS5kYXRhLnNsaWNlKDAsZS5sZW5ndGgpO3QmJm8uc29ydCh0KTtjb25zdCBoPW9bMF0uZ2V0TWVzaCgpLmdldFNjZW5lKCk7Zm9yKHI9MDtyPG8ubGVuZ3RoO3IrKylpZihuPW9bcl0sIShoLl9hY3RpdmVNZXNoZXNGcm96ZW5CdXRLZWVwQ2xpcHBpbmcmJiFuLmlzSW5GcnVzdHVtKGguX2ZydXN0dW1QbGFuZXMpKSl7aWYocyl7Y29uc3QgbD1uLmdldE1hdGVyaWFsKCk7aWYobCYmbC5uZWVkRGVwdGhQcmVQYXNzKXtjb25zdCB1PWwuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTt1LnNldENvbG9yV3JpdGUoITEpLHUuc2V0QWxwaGFNb2RlKDApLG4ucmVuZGVyKCExKSx1LnNldENvbG9yV3JpdGUoITApfX1uLnJlbmRlcihzKX19c3RhdGljIGRlZmF1bHRUcmFuc3BhcmVudFNvcnRDb21wYXJlKGUsdCl7cmV0dXJuIGUuX2FscGhhSW5kZXg+dC5fYWxwaGFJbmRleD8xOmUuX2FscGhhSW5kZXg8dC5fYWxwaGFJbmRleD8tMTpTdC5iYWNrVG9Gcm9udFNvcnRDb21wYXJlKGUsdCl9c3RhdGljIGJhY2tUb0Zyb250U29ydENvbXBhcmUoZSx0KXtyZXR1cm4gZS5fZGlzdGFuY2VUb0NhbWVyYTx0Ll9kaXN0YW5jZVRvQ2FtZXJhPzE6ZS5fZGlzdGFuY2VUb0NhbWVyYT50Ll9kaXN0YW5jZVRvQ2FtZXJhPy0xOjB9c3RhdGljIGZyb250VG9CYWNrU29ydENvbXBhcmUoZSx0KXtyZXR1cm4gZS5fZGlzdGFuY2VUb0NhbWVyYTx0Ll9kaXN0YW5jZVRvQ2FtZXJhPy0xOmUuX2Rpc3RhbmNlVG9DYW1lcmE+dC5fZGlzdGFuY2VUb0NhbWVyYT8xOjB9c3RhdGljIFBhaW50ZXJTb3J0Q29tcGFyZShlLHQpe2NvbnN0IGk9ZS5nZXRNZXNoKCkscz10LmdldE1lc2goKTtyZXR1cm4gaS5tYXRlcmlhbCYmcy5tYXRlcmlhbD9pLm1hdGVyaWFsLnVuaXF1ZUlkLXMubWF0ZXJpYWwudW5pcXVlSWQ6aS51bmlxdWVJZC1zLnVuaXF1ZUlkfXByZXBhcmUoKXt0aGlzLl9vcGFxdWVTdWJNZXNoZXMucmVzZXQoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX2FscGhhVGVzdFN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX2RlcHRoT25seVN1Yk1lc2hlcy5yZXNldCgpLHRoaXMuX3BhcnRpY2xlU3lzdGVtcy5yZXNldCgpLHRoaXMucHJlcGFyZVNwcml0ZXMoKSx0aGlzLl9lZGdlc1JlbmRlcmVycy5yZXNldCgpLHRoaXMuX2VtcHR5PSEwfXByZXBhcmVTcHJpdGVzKCl7dGhpcy5fc3ByaXRlTWFuYWdlcnMucmVzZXQoKX1kaXNwb3NlKCl7dGhpcy5fb3BhcXVlU3ViTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLl90cmFuc3BhcmVudFN1Yk1lc2hlcy5kaXNwb3NlKCksdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLl9kZXB0aE9ubHlTdWJNZXNoZXMuZGlzcG9zZSgpLHRoaXMuX3BhcnRpY2xlU3lzdGVtcy5kaXNwb3NlKCksdGhpcy5fc3ByaXRlTWFuYWdlcnMuZGlzcG9zZSgpLHRoaXMuX2VkZ2VzUmVuZGVyZXJzLmRpc3Bvc2UoKX1kaXNwYXRjaChlLHQsaSl7dD09PXZvaWQgMCYmKHQ9ZS5nZXRNZXNoKCkpLGk9PT12b2lkIDAmJihpPWUuZ2V0TWF0ZXJpYWwoKSksaSE9bnVsbCYmKGkubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKHQpP3RoaXMuX3RyYW5zcGFyZW50U3ViTWVzaGVzLnB1c2goZSk6aS5uZWVkQWxwaGFUZXN0aW5nKCk/KGkubmVlZERlcHRoUHJlUGFzcyYmdGhpcy5fZGVwdGhPbmx5U3ViTWVzaGVzLnB1c2goZSksdGhpcy5fYWxwaGFUZXN0U3ViTWVzaGVzLnB1c2goZSkpOihpLm5lZWREZXB0aFByZVBhc3MmJnRoaXMuX2RlcHRoT25seVN1Yk1lc2hlcy5wdXNoKGUpLHRoaXMuX29wYXF1ZVN1Yk1lc2hlcy5wdXNoKGUpKSx0Ll9yZW5kZXJpbmdHcm91cD10aGlzLHQuX2VkZ2VzUmVuZGVyZXImJnQuX2VkZ2VzUmVuZGVyZXIuaXNFbmFibGVkJiZ0aGlzLl9lZGdlc1JlbmRlcmVycy5wdXNoTm9EdXBsaWNhdGUodC5fZWRnZXNSZW5kZXJlciksdGhpcy5fZW1wdHk9ITEpfWRpc3BhdGNoU3ByaXRlcyhlKXt0aGlzLl9zcHJpdGVNYW5hZ2Vycy5wdXNoKGUpLHRoaXMuX2VtcHR5PSExfWRpc3BhdGNoUGFydGljbGVzKGUpe3RoaXMuX3BhcnRpY2xlU3lzdGVtcy5wdXNoKGUpLHRoaXMuX2VtcHR5PSExfV9yZW5kZXJQYXJ0aWNsZXMoZSl7aWYodGhpcy5fcGFydGljbGVTeXN0ZW1zLmxlbmd0aD09PTApcmV0dXJuO2NvbnN0IHQ9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO3RoaXMuX3NjZW5lLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcy5fc2NlbmUpO2ZvcihsZXQgaT0wO2k8dGhpcy5fcGFydGljbGVTeXN0ZW1zLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5fcGFydGljbGVTeXN0ZW1zLmRhdGFbaV07aWYoKHQmJnQubGF5ZXJNYXNrJnMubGF5ZXJNYXNrKT09PTApY29udGludWU7Y29uc3Qgcj1zLmVtaXR0ZXI7KCFyLnBvc2l0aW9ufHwhZXx8ZS5pbmRleE9mKHIpIT09LTEpJiZ0aGlzLl9zY2VuZS5fYWN0aXZlUGFydGljbGVzLmFkZENvdW50KHMucmVuZGVyKCksITEpfXRoaXMuX3NjZW5lLm9uQWZ0ZXJQYXJ0aWNsZXNSZW5kZXJpbmdPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9zY2VuZSl9X3JlbmRlclNwcml0ZXMoKXtpZighdGhpcy5fc2NlbmUuc3ByaXRlc0VuYWJsZWR8fHRoaXMuX3Nwcml0ZU1hbmFnZXJzLmxlbmd0aD09PTApcmV0dXJuO2NvbnN0IGU9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO3RoaXMuX3NjZW5lLm9uQmVmb3JlU3ByaXRlc1JlbmRlcmluZ09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuX3NjZW5lKTtmb3IobGV0IHQ9MDt0PHRoaXMuX3Nwcml0ZU1hbmFnZXJzLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5fc3ByaXRlTWFuYWdlcnMuZGF0YVt0XTsoZSYmZS5sYXllck1hc2smaS5sYXllck1hc2spIT09MCYmaS5yZW5kZXIoKX10aGlzLl9zY2VuZS5vbkFmdGVyU3ByaXRlc1JlbmRlcmluZ09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuX3NjZW5lKX19U3QuX1plcm9WZWN0b3I9cC5aZXJvKCk7Y2xhc3MgeW57fWNsYXNzIFdle2NvbnN0cnVjdG9yKGUpe3RoaXMuX3VzZVNjZW5lQXV0b0NsZWFyU2V0dXA9ITEsdGhpcy5fcmVuZGVyaW5nR3JvdXBzPW5ldyBBcnJheSx0aGlzLl9hdXRvQ2xlYXJEZXB0aFN0ZW5jaWw9e30sdGhpcy5fY3VzdG9tT3BhcXVlU29ydENvbXBhcmVGbj17fSx0aGlzLl9jdXN0b21BbHBoYVRlc3RTb3J0Q29tcGFyZUZuPXt9LHRoaXMuX2N1c3RvbVRyYW5zcGFyZW50U29ydENvbXBhcmVGbj17fSx0aGlzLl9yZW5kZXJpbmdHcm91cEluZm89bmV3IHluLHRoaXMuX21haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPSExLHRoaXMuX3NjZW5lPWU7Zm9yKGxldCB0PVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7dDxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO3QrKyl0aGlzLl9hdXRvQ2xlYXJEZXB0aFN0ZW5jaWxbdF09e2F1dG9DbGVhcjohMCxkZXB0aDohMCxzdGVuY2lsOiEwfX1nZXQgbWFpbnRhaW5TdGF0ZUJldHdlZW5GcmFtZXMoKXtyZXR1cm4gdGhpcy5fbWFpbnRhaW5TdGF0ZUJldHdlZW5GcmFtZXN9c2V0IG1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzKGUpe2lmKGUhPT10aGlzLl9tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmKHRoaXMuX21haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPWUsIXRoaXMuX21haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzKSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fc2NlbmUubWVzaGVzKWlmKHQuc3ViTWVzaGVzKWZvcihjb25zdCBpIG9mIHQuc3ViTWVzaGVzKWkuX3dhc0Rpc3BhdGNoZWQ9ITE7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMpdC5fd2FzRGlzcGF0Y2hlZD0hMTtmb3IoY29uc3QgdCBvZiB0aGlzLl9zY2VuZS5wYXJ0aWNsZVN5c3RlbXMpdC5fd2FzRGlzcGF0Y2hlZD0hMX19Z2V0UmVuZGVyaW5nR3JvdXAoZSl7Y29uc3QgdD1lfHwwO3JldHVybiB0aGlzLl9wcmVwYXJlUmVuZGVyaW5nR3JvdXAodCksdGhpcy5fcmVuZGVyaW5nR3JvdXBzW3RdfV9jbGVhckRlcHRoU3RlbmNpbEJ1ZmZlcihlPSEwLHQ9ITApe3RoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlckFscmVhZHlDbGVhbmVkfHwodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuY2xlYXIobnVsbCwhMSxlLHQpLHRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlckFscmVhZHlDbGVhbmVkPSEwKX1yZW5kZXIoZSx0LGkscyl7Y29uc3Qgcj10aGlzLl9yZW5kZXJpbmdHcm91cEluZm87aWYoci5zY2VuZT10aGlzLl9zY2VuZSxyLmNhbWVyYT10aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmEsdGhpcy5fc2NlbmUuc3ByaXRlTWFuYWdlcnMmJnMpZm9yKGxldCBuPTA7bjx0aGlzLl9zY2VuZS5zcHJpdGVNYW5hZ2Vycy5sZW5ndGg7bisrKXtjb25zdCBhPXRoaXMuX3NjZW5lLnNwcml0ZU1hbmFnZXJzW25dO3RoaXMuZGlzcGF0Y2hTcHJpdGVzKGEpfWZvcihsZXQgbj1XZS5NSU5fUkVOREVSSU5HR1JPVVBTO248V2UuTUFYX1JFTkRFUklOR0dST1VQUztuKyspe3RoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlckFscmVhZHlDbGVhbmVkPW49PT1XZS5NSU5fUkVOREVSSU5HR1JPVVBTO2NvbnN0IGE9dGhpcy5fcmVuZGVyaW5nR3JvdXBzW25dO2lmKCFhfHxhLl9lbXB0eSljb250aW51ZTtjb25zdCBvPU1hdGgucG93KDIsbik7aWYoci5yZW5kZXJpbmdHcm91cElkPW4sdGhpcy5fc2NlbmUub25CZWZvcmVSZW5kZXJpbmdHcm91cE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIsbyksV2UuQVVUT0NMRUFSKXtjb25zdCBoPXRoaXMuX3VzZVNjZW5lQXV0b0NsZWFyU2V0dXA/dGhpcy5fc2NlbmUuZ2V0QXV0b0NsZWFyRGVwdGhTdGVuY2lsU2V0dXAobik6dGhpcy5fYXV0b0NsZWFyRGVwdGhTdGVuY2lsW25dO2gmJmguYXV0b0NsZWFyJiZ0aGlzLl9jbGVhckRlcHRoU3RlbmNpbEJ1ZmZlcihoLmRlcHRoLGguc3RlbmNpbCl9Zm9yKGNvbnN0IGggb2YgdGhpcy5fc2NlbmUuX2JlZm9yZVJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlKWguYWN0aW9uKG4pO2EucmVuZGVyKGUscyxpLHQpO2Zvcihjb25zdCBoIG9mIHRoaXMuX3NjZW5lLl9hZnRlclJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlKWguYWN0aW9uKG4pO3RoaXMuX3NjZW5lLm9uQWZ0ZXJSZW5kZXJpbmdHcm91cE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIsbyl9fXJlc2V0KCl7aWYoIXRoaXMubWFpbnRhaW5TdGF0ZUJldHdlZW5GcmFtZXMpZm9yKGxldCBlPVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7ZTxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO2UrKyl7Y29uc3QgdD10aGlzLl9yZW5kZXJpbmdHcm91cHNbZV07dCYmdC5wcmVwYXJlKCl9fXJlc2V0U3ByaXRlcygpe2lmKCF0aGlzLm1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzKWZvcihsZXQgZT1XZS5NSU5fUkVOREVSSU5HR1JPVVBTO2U8V2UuTUFYX1JFTkRFUklOR0dST1VQUztlKyspe2NvbnN0IHQ9dGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdO3QmJnQucHJlcGFyZVNwcml0ZXMoKX19ZGlzcG9zZSgpe3RoaXMuZnJlZVJlbmRlcmluZ0dyb3VwcygpLHRoaXMuX3JlbmRlcmluZ0dyb3Vwcy5sZW5ndGg9MCx0aGlzLl9yZW5kZXJpbmdHcm91cEluZm89bnVsbH1mcmVlUmVuZGVyaW5nR3JvdXBzKCl7Zm9yKGxldCBlPVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7ZTxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO2UrKyl7Y29uc3QgdD10aGlzLl9yZW5kZXJpbmdHcm91cHNbZV07dCYmdC5kaXNwb3NlKCl9fV9wcmVwYXJlUmVuZGVyaW5nR3JvdXAoZSl7dGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdPT09dm9pZCAwJiYodGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdPW5ldyBTdChlLHRoaXMuX3NjZW5lLHRoaXMuX2N1c3RvbU9wYXF1ZVNvcnRDb21wYXJlRm5bZV0sdGhpcy5fY3VzdG9tQWxwaGFUZXN0U29ydENvbXBhcmVGbltlXSx0aGlzLl9jdXN0b21UcmFuc3BhcmVudFNvcnRDb21wYXJlRm5bZV0pKX1kaXNwYXRjaFNwcml0ZXMoZSl7dGhpcy5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmZS5fd2FzRGlzcGF0Y2hlZHx8KGUuX3dhc0Rpc3BhdGNoZWQ9ITAsdGhpcy5nZXRSZW5kZXJpbmdHcm91cChlLnJlbmRlcmluZ0dyb3VwSWQpLmRpc3BhdGNoU3ByaXRlcyhlKSl9ZGlzcGF0Y2hQYXJ0aWNsZXMoZSl7dGhpcy5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmZS5fd2FzRGlzcGF0Y2hlZHx8KGUuX3dhc0Rpc3BhdGNoZWQ9ITAsdGhpcy5nZXRSZW5kZXJpbmdHcm91cChlLnJlbmRlcmluZ0dyb3VwSWQpLmRpc3BhdGNoUGFydGljbGVzKGUpKX1kaXNwYXRjaChlLHQsaSl7dD09PXZvaWQgMCYmKHQ9ZS5nZXRNZXNoKCkpLCEodGhpcy5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcyYmZS5fd2FzRGlzcGF0Y2hlZCkmJihlLl93YXNEaXNwYXRjaGVkPSEwLHRoaXMuZ2V0UmVuZGVyaW5nR3JvdXAodC5yZW5kZXJpbmdHcm91cElkKS5kaXNwYXRjaChlLHQsaSkpfXNldFJlbmRlcmluZ09yZGVyKGUsdD1udWxsLGk9bnVsbCxzPW51bGwpe2lmKHRoaXMuX2N1c3RvbU9wYXF1ZVNvcnRDb21wYXJlRm5bZV09dCx0aGlzLl9jdXN0b21BbHBoYVRlc3RTb3J0Q29tcGFyZUZuW2VdPWksdGhpcy5fY3VzdG9tVHJhbnNwYXJlbnRTb3J0Q29tcGFyZUZuW2VdPXMsdGhpcy5fcmVuZGVyaW5nR3JvdXBzW2VdKXtjb25zdCByPXRoaXMuX3JlbmRlcmluZ0dyb3Vwc1tlXTtyLm9wYXF1ZVNvcnRDb21wYXJlRm49dGhpcy5fY3VzdG9tT3BhcXVlU29ydENvbXBhcmVGbltlXSxyLmFscGhhVGVzdFNvcnRDb21wYXJlRm49dGhpcy5fY3VzdG9tQWxwaGFUZXN0U29ydENvbXBhcmVGbltlXSxyLnRyYW5zcGFyZW50U29ydENvbXBhcmVGbj10aGlzLl9jdXN0b21UcmFuc3BhcmVudFNvcnRDb21wYXJlRm5bZV19fXNldFJlbmRlcmluZ0F1dG9DbGVhckRlcHRoU3RlbmNpbChlLHQsaT0hMCxzPSEwKXt0aGlzLl9hdXRvQ2xlYXJEZXB0aFN0ZW5jaWxbZV09e2F1dG9DbGVhcjp0LGRlcHRoOmksc3RlbmNpbDpzfX1nZXRBdXRvQ2xlYXJEZXB0aFN0ZW5jaWxTZXR1cChlKXtyZXR1cm4gdGhpcy5fYXV0b0NsZWFyRGVwdGhTdGVuY2lsW2VdfX1XZS5NQVhfUkVOREVSSU5HR1JPVVBTPTQsV2UuTUlOX1JFTkRFUklOR0dST1VQUz0wLFdlLkFVVE9DTEVBUj0hMDtjbGFzcyBxe31xLk5BTUVfRUZGRUNUTEFZRVI9IkVmZmVjdExheWVyIixxLk5BTUVfTEFZRVI9IkxheWVyIixxLk5BTUVfTEVOU0ZMQVJFU1lTVEVNPSJMZW5zRmxhcmVTeXN0ZW0iLHEuTkFNRV9CT1VORElOR0JPWFJFTkRFUkVSPSJCb3VuZGluZ0JveFJlbmRlcmVyIixxLk5BTUVfUEFSVElDTEVTWVNURU09IlBhcnRpY2xlU3lzdGVtIixxLk5BTUVfR0FNRVBBRD0iR2FtZXBhZCIscS5OQU1FX1NJTVBMSUZJQ0FUSU9OUVVFVUU9IlNpbXBsaWZpY2F0aW9uUXVldWUiLHEuTkFNRV9HRU9NRVRSWUJVRkZFUlJFTkRFUkVSPSJHZW9tZXRyeUJ1ZmZlclJlbmRlcmVyIixxLk5BTUVfUFJFUEFTU1JFTkRFUkVSPSJQcmVQYXNzUmVuZGVyZXIiLHEuTkFNRV9ERVBUSFJFTkRFUkVSPSJEZXB0aFJlbmRlcmVyIixxLk5BTUVfREVQVEhQRUVMSU5HUkVOREVSRVI9IkRlcHRoUGVlbGluZ1JlbmRlcmVyIixxLk5BTUVfUE9TVFBST0NFU1NSRU5ERVJQSVBFTElORU1BTkFHRVI9IlBvc3RQcm9jZXNzUmVuZGVyUGlwZWxpbmVNYW5hZ2VyIixxLk5BTUVfU1BSSVRFPSJTcHJpdGUiLHEuTkFNRV9TVUJTVVJGQUNFPSJTdWJTdXJmYWNlIixxLk5BTUVfT1VUTElORVJFTkRFUkVSPSJPdXRsaW5lIixxLk5BTUVfUFJPQ0VEVVJBTFRFWFRVUkU9IlByb2NlZHVyYWxUZXh0dXJlIixxLk5BTUVfU0hBRE9XR0VORVJBVE9SPSJTaGFkb3dHZW5lcmF0b3IiLHEuTkFNRV9PQ1RSRUU9Ik9jdHJlZSIscS5OQU1FX1BIWVNJQ1NFTkdJTkU9IlBoeXNpY3NFbmdpbmUiLHEuTkFNRV9BVURJTz0iQXVkaW8iLHEuTkFNRV9GTFVJRFJFTkRFUkVSPSJGbHVpZFJlbmRlcmVyIixxLlNURVBfSVNSRUFEWUZPUk1FU0hfRUZGRUNUTEFZRVI9MCxxLlNURVBfQkVGT1JFRVZBTFVBVEVBQ1RJVkVNRVNIX0JPVU5ESU5HQk9YUkVOREVSRVI9MCxxLlNURVBfRVZBTFVBVEVTVUJNRVNIX0JPVU5ESU5HQk9YUkVOREVSRVI9MCxxLlNURVBfUFJFQUNUSVZFTUVTSF9CT1VORElOR0JPWFJFTkRFUkVSPTAscS5TVEVQX0NBTUVSQURSQVdSRU5ERVJUQVJHRVRfRUZGRUNUTEFZRVI9MSxxLlNURVBfQkVGT1JFQ0FNRVJBRFJBV19QUkVQQVNTPTAscS5TVEVQX0JFRk9SRUNBTUVSQURSQVdfRUZGRUNUTEFZRVI9MSxxLlNURVBfQkVGT1JFQ0FNRVJBRFJBV19MQVlFUj0yLHEuU1RFUF9CRUZPUkVSRU5ERVJUQVJHRVREUkFXX1BSRVBBU1M9MCxxLlNURVBfQkVGT1JFUkVOREVSVEFSR0VURFJBV19MQVlFUj0xLHEuU1RFUF9CRUZPUkVSRU5ERVJJTkdNRVNIX1BSRVBBU1M9MCxxLlNURVBfQkVGT1JFUkVOREVSSU5HTUVTSF9PVVRMSU5FPTEscS5TVEVQX0FGVEVSUkVOREVSSU5HTUVTSF9QUkVQQVNTPTAscS5TVEVQX0FGVEVSUkVOREVSSU5HTUVTSF9PVVRMSU5FPTEscS5TVEVQX0FGVEVSUkVOREVSSU5HR1JPVVBEUkFXX0VGRkVDVExBWUVSX0RSQVc9MCxxLlNURVBfQUZURVJSRU5ERVJJTkdHUk9VUERSQVdfQk9VTkRJTkdCT1hSRU5ERVJFUj0xLHEuU1RFUF9CRUZPUkVDQU1FUkFVUERBVEVfU0lNUExJRklDQVRJT05RVUVVRT0wLHEuU1RFUF9CRUZPUkVDQU1FUkFVUERBVEVfR0FNRVBBRD0xLHEuU1RFUF9CRUZPUkVDTEVBUl9QUk9DRURVUkFMVEVYVFVSRT0wLHEuU1RFUF9CRUZPUkVDTEVBUl9QUkVQQVNTPTEscS5TVEVQX0JFRk9SRVJFTkRFUlRBUkdFVENMRUFSX1BSRVBBU1M9MCxxLlNURVBfQUZURVJSRU5ERVJUQVJHRVREUkFXX1BSRVBBU1M9MCxxLlNURVBfQUZURVJSRU5ERVJUQVJHRVREUkFXX0xBWUVSPTEscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19QUkVQQVNTPTAscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19FRkZFQ1RMQVlFUj0xLHEuU1RFUF9BRlRFUkNBTUVSQURSQVdfTEVOU0ZMQVJFU1lTVEVNPTIscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19FRkZFQ1RMQVlFUl9EUkFXPTMscS5TVEVQX0FGVEVSQ0FNRVJBRFJBV19MQVlFUj00LHEuU1RFUF9BRlRFUkNBTUVSQURSQVdfRkxVSURSRU5ERVJFUj01LHEuU1RFUF9BRlRFUkNBTUVSQVBPU1RQUk9DRVNTX0xBWUVSPTAscS5TVEVQX0FGVEVSUkVOREVSVEFSR0VUUE9TVFBST0NFU1NfTEFZRVI9MCxxLlNURVBfQUZURVJSRU5ERVJfQVVESU89MCxxLlNURVBfR0FUSEVSUkVOREVSVEFSR0VUU19ERVBUSFJFTkRFUkVSPTAscS5TVEVQX0dBVEhFUlJFTkRFUlRBUkdFVFNfR0VPTUVUUllCVUZGRVJSRU5ERVJFUj0xLHEuU1RFUF9HQVRIRVJSRU5ERVJUQVJHRVRTX1NIQURPV0dFTkVSQVRPUj0yLHEuU1RFUF9HQVRIRVJSRU5ERVJUQVJHRVRTX1BPU1RQUk9DRVNTUkVOREVSUElQRUxJTkVNQU5BR0VSPTMscS5TVEVQX0dBVEhFUkFDVElWRUNBTUVSQVJFTkRFUlRBUkdFVFNfREVQVEhSRU5ERVJFUj0wLHEuU1RFUF9HQVRIRVJBQ1RJVkVDQU1FUkFSRU5ERVJUQVJHRVRTX0ZMVUlEUkVOREVSRVI9MSxxLlNURVBfUE9JTlRFUk1PVkVfU1BSSVRFPTAscS5TVEVQX1BPSU5URVJET1dOX1NQUklURT0wLHEuU1RFUF9QT0lOVEVSVVBfU1BSSVRFPTA7Y2xhc3MgSWUgZXh0ZW5kcyBBcnJheXtjb25zdHJ1Y3RvcihlKXtzdXBlciguLi5lKX1zdGF0aWMgQ3JlYXRlKCl7cmV0dXJuIE9iamVjdC5jcmVhdGUoSWUucHJvdG90eXBlKX1yZWdpc3RlclN0ZXAoZSx0LGkpe2xldCBzPTAscj1OdW1iZXIuTUFYX1ZBTFVFO2Zvcig7czx0aGlzLmxlbmd0aCYmKHI9dGhpc1tzXS5pbmRleCwhKGU8cikpO3MrKyk7dGhpcy5zcGxpY2UocywwLHtpbmRleDplLGNvbXBvbmVudDp0LGFjdGlvbjppLmJpbmQodCl9KX1jbGVhcigpe3RoaXMubGVuZ3RoPTB9fWNsYXNzIFRle31UZS5QT0lOVEVSRE9XTj0xLFRlLlBPSU5URVJVUD0yLFRlLlBPSU5URVJNT1ZFPTQsVGUuUE9JTlRFUldIRUVMPTgsVGUuUE9JTlRFUlBJQ0s9MTYsVGUuUE9JTlRFUlRBUD0zMixUZS5QT0lOVEVSRE9VQkxFVEFQPTY0O2NsYXNzIGZye2NvbnN0cnVjdG9yKGUsdCl7dGhpcy50eXBlPWUsdGhpcy5ldmVudD10fX1jbGFzcyBDbiBleHRlbmRzIGZye2NvbnN0cnVjdG9yKGUsdCxpLHMpe3N1cGVyKGUsdCksdGhpcy5yYXk9bnVsbCx0aGlzLm9yaWdpbmFsUGlja2luZ0luZm89bnVsbCx0aGlzLnNraXBPblBvaW50ZXJPYnNlcnZhYmxlPSExLHRoaXMubG9jYWxQb3NpdGlvbj1uZXcgdmUoaSxzKX19Y2xhc3MgdWkgZXh0ZW5kcyBmcntjb25zdHJ1Y3RvcihlLHQsaSxzPW51bGwpe3N1cGVyKGUsdCksdGhpcy5fcGlja0luZm89aSx0aGlzLl9pbnB1dE1hbmFnZXI9c31nZXQgcGlja0luZm8oKXtyZXR1cm4gdGhpcy5fcGlja0luZm98fHRoaXMuX2dlbmVyYXRlUGlja0luZm8oKSx0aGlzLl9waWNrSW5mb31fZ2VuZXJhdGVQaWNrSW5mbygpe3RoaXMuX2lucHV0TWFuYWdlciYmKHRoaXMuX3BpY2tJbmZvPXRoaXMuX2lucHV0TWFuYWdlci5fcGlja01vdmUodGhpcy5ldmVudC5wb2ludGVySWQpLHRoaXMuX2lucHV0TWFuYWdlci5fc2V0UmF5T25Qb2ludGVySW5mbyh0aGlzLl9waWNrSW5mbyx0aGlzLmV2ZW50KSx0aGlzLl9pbnB1dE1hbmFnZXI9bnVsbCl9fWNsYXNzIHV0e2NvbnN0cnVjdG9yKCl7dGhpcy5ob3ZlckN1cnNvcj0iIix0aGlzLmFjdGlvbnM9bmV3IEFycmF5LHRoaXMuaXNSZWN1cnNpdmU9ITF9c3RhdGljIGdldCBIYXNUcmlnZ2Vycygpe2Zvcihjb25zdCBlIGluIHV0LlRyaWdnZXJzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh1dC5UcmlnZ2VycyxlKSlyZXR1cm4hMDtyZXR1cm4hMX1zdGF0aWMgZ2V0IEhhc1BpY2tUcmlnZ2Vycygpe2Zvcihjb25zdCBlIGluIHV0LlRyaWdnZXJzKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh1dC5UcmlnZ2VycyxlKSl7Y29uc3QgdD1wYXJzZUludChlKTtpZih0Pj0xJiZ0PD03KXJldHVybiEwfXJldHVybiExfXN0YXRpYyBIYXNTcGVjaWZpY1RyaWdnZXIoZSl7Zm9yKGNvbnN0IHQgaW4gdXQuVHJpZ2dlcnMpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHV0LlRyaWdnZXJzLHQpJiZwYXJzZUludCh0KT09PWUpcmV0dXJuITA7cmV0dXJuITF9fXV0LlRyaWdnZXJzPXt9O2NsYXNzIEppe31KaS5LRVlET1dOPTEsSmkuS0VZVVA9MjtjbGFzcyBDc3tjb25zdHJ1Y3RvcihlLHQpe3RoaXMudHlwZT1lLHRoaXMuZXZlbnQ9dH19Y2xhc3MgX3IgZXh0ZW5kcyBDc3tjb25zdHJ1Y3RvcihlLHQpe3N1cGVyKGUsdCksdGhpcy50eXBlPWUsdGhpcy5ldmVudD10LHRoaXMuc2tpcE9uS2V5Ym9hcmRPYnNlcnZhYmxlPSExfWdldCBza2lwT25Qb2ludGVyT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLnNraXBPbktleWJvYXJkT2JzZXJ2YWJsZX1zZXQgc2tpcE9uUG9pbnRlck9ic2VydmFibGUoZSl7dGhpcy5za2lwT25LZXlib2FyZE9ic2VydmFibGU9ZX19dmFyIHo7KGZ1bmN0aW9uKGMpe2NbYy5HZW5lcmljPTBdPSJHZW5lcmljIixjW2MuS2V5Ym9hcmQ9MV09IktleWJvYXJkIixjW2MuTW91c2U9Ml09Ik1vdXNlIixjW2MuVG91Y2g9M109IlRvdWNoIixjW2MuRHVhbFNob2NrPTRdPSJEdWFsU2hvY2siLGNbYy5YYm94PTVdPSJYYm94IixjW2MuU3dpdGNoPTZdPSJTd2l0Y2giLGNbYy5EdWFsU2Vuc2U9N109IkR1YWxTZW5zZSJ9KSh6fHwoej17fSkpO3ZhciBROyhmdW5jdGlvbihjKXtjW2MuSG9yaXpvbnRhbD0wXT0iSG9yaXpvbnRhbCIsY1tjLlZlcnRpY2FsPTFdPSJWZXJ0aWNhbCIsY1tjLkxlZnRDbGljaz0yXT0iTGVmdENsaWNrIixjW2MuTWlkZGxlQ2xpY2s9M109Ik1pZGRsZUNsaWNrIixjW2MuUmlnaHRDbGljaz00XT0iUmlnaHRDbGljayIsY1tjLkJyb3dzZXJCYWNrPTVdPSJCcm93c2VyQmFjayIsY1tjLkJyb3dzZXJGb3J3YXJkPTZdPSJCcm93c2VyRm9yd2FyZCIsY1tjLk1vdXNlV2hlZWxYPTddPSJNb3VzZVdoZWVsWCIsY1tjLk1vdXNlV2hlZWxZPThdPSJNb3VzZVdoZWVsWSIsY1tjLk1vdXNlV2hlZWxaPTldPSJNb3VzZVdoZWVsWiIsY1tjLk1vdmU9MTJdPSJNb3ZlIn0pKFF8fChRPXt9KSk7dmFyIGVzOyhmdW5jdGlvbihjKXtjW2MuSG9yaXpvbnRhbD0wXT0iSG9yaXpvbnRhbCIsY1tjLlZlcnRpY2FsPTFdPSJWZXJ0aWNhbCIsY1tjLkxlZnRDbGljaz0yXT0iTGVmdENsaWNrIixjW2MuTWlkZGxlQ2xpY2s9M109Ik1pZGRsZUNsaWNrIixjW2MuUmlnaHRDbGljaz00XT0iUmlnaHRDbGljayIsY1tjLkJyb3dzZXJCYWNrPTVdPSJCcm93c2VyQmFjayIsY1tjLkJyb3dzZXJGb3J3YXJkPTZdPSJCcm93c2VyRm9yd2FyZCIsY1tjLk1vdXNlV2hlZWxYPTddPSJNb3VzZVdoZWVsWCIsY1tjLk1vdXNlV2hlZWxZPThdPSJNb3VzZVdoZWVsWSIsY1tjLk1vdXNlV2hlZWxaPTldPSJNb3VzZVdoZWVsWiIsY1tjLkRlbHRhSG9yaXpvbnRhbD0xMF09IkRlbHRhSG9yaXpvbnRhbCIsY1tjLkRlbHRhVmVydGljYWw9MTFdPSJEZWx0YVZlcnRpY2FsIn0pKGVzfHwoZXM9e30pKTt2YXIgZ3I7KGZ1bmN0aW9uKGMpe2NbYy5Dcm9zcz0wXT0iQ3Jvc3MiLGNbYy5DaXJjbGU9MV09IkNpcmNsZSIsY1tjLlNxdWFyZT0yXT0iU3F1YXJlIixjW2MuVHJpYW5nbGU9M109IlRyaWFuZ2xlIixjW2MuTDE9NF09IkwxIixjW2MuUjE9NV09IlIxIixjW2MuTDI9Nl09IkwyIixjW2MuUjI9N109IlIyIixjW2MuU2hhcmU9OF09IlNoYXJlIixjW2MuT3B0aW9ucz05XT0iT3B0aW9ucyIsY1tjLkwzPTEwXT0iTDMiLGNbYy5SMz0xMV09IlIzIixjW2MuRFBhZFVwPTEyXT0iRFBhZFVwIixjW2MuRFBhZERvd249MTNdPSJEUGFkRG93biIsY1tjLkRQYWRMZWZ0PTE0XT0iRFBhZExlZnQiLGNbYy5EUGFkUmlnaHQ9MTVdPSJEUGFkUmlnaHQiLGNbYy5Ib21lPTE2XT0iSG9tZSIsY1tjLlRvdWNoUGFkPTE3XT0iVG91Y2hQYWQiLGNbYy5MU3RpY2tYQXhpcz0xOF09IkxTdGlja1hBeGlzIixjW2MuTFN0aWNrWUF4aXM9MTldPSJMU3RpY2tZQXhpcyIsY1tjLlJTdGlja1hBeGlzPTIwXT0iUlN0aWNrWEF4aXMiLGNbYy5SU3RpY2tZQXhpcz0yMV09IlJTdGlja1lBeGlzIn0pKGdyfHwoZ3I9e30pKTt2YXIgcHI7KGZ1bmN0aW9uKGMpe2NbYy5Dcm9zcz0wXT0iQ3Jvc3MiLGNbYy5DaXJjbGU9MV09IkNpcmNsZSIsY1tjLlNxdWFyZT0yXT0iU3F1YXJlIixjW2MuVHJpYW5nbGU9M109IlRyaWFuZ2xlIixjW2MuTDE9NF09IkwxIixjW2MuUjE9NV09IlIxIixjW2MuTDI9Nl09IkwyIixjW2MuUjI9N109IlIyIixjW2MuQ3JlYXRlPThdPSJDcmVhdGUiLGNbYy5PcHRpb25zPTldPSJPcHRpb25zIixjW2MuTDM9MTBdPSJMMyIsY1tjLlIzPTExXT0iUjMiLGNbYy5EUGFkVXA9MTJdPSJEUGFkVXAiLGNbYy5EUGFkRG93bj0xM109IkRQYWREb3duIixjW2MuRFBhZExlZnQ9MTRdPSJEUGFkTGVmdCIsY1tjLkRQYWRSaWdodD0xNV09IkRQYWRSaWdodCIsY1tjLkhvbWU9MTZdPSJIb21lIixjW2MuVG91Y2hQYWQ9MTddPSJUb3VjaFBhZCIsY1tjLkxTdGlja1hBeGlzPTE4XT0iTFN0aWNrWEF4aXMiLGNbYy5MU3RpY2tZQXhpcz0xOV09IkxTdGlja1lBeGlzIixjW2MuUlN0aWNrWEF4aXM9MjBdPSJSU3RpY2tYQXhpcyIsY1tjLlJTdGlja1lBeGlzPTIxXT0iUlN0aWNrWUF4aXMifSkocHJ8fChwcj17fSkpO3ZhciBtcjsoZnVuY3Rpb24oYyl7Y1tjLkE9MF09IkEiLGNbYy5CPTFdPSJCIixjW2MuWD0yXT0iWCIsY1tjLlk9M109IlkiLGNbYy5MQj00XT0iTEIiLGNbYy5SQj01XT0iUkIiLGNbYy5MVD02XT0iTFQiLGNbYy5SVD03XT0iUlQiLGNbYy5CYWNrPThdPSJCYWNrIixjW2MuU3RhcnQ9OV09IlN0YXJ0IixjW2MuTFM9MTBdPSJMUyIsY1tjLlJTPTExXT0iUlMiLGNbYy5EUGFkVXA9MTJdPSJEUGFkVXAiLGNbYy5EUGFkRG93bj0xM109IkRQYWREb3duIixjW2MuRFBhZExlZnQ9MTRdPSJEUGFkTGVmdCIsY1tjLkRQYWRSaWdodD0xNV09IkRQYWRSaWdodCIsY1tjLkhvbWU9MTZdPSJIb21lIixjW2MuTFN0aWNrWEF4aXM9MTddPSJMU3RpY2tYQXhpcyIsY1tjLkxTdGlja1lBeGlzPTE4XT0iTFN0aWNrWUF4aXMiLGNbYy5SU3RpY2tYQXhpcz0xOV09IlJTdGlja1hBeGlzIixjW2MuUlN0aWNrWUF4aXM9MjBdPSJSU3RpY2tZQXhpcyJ9KShtcnx8KG1yPXt9KSk7dmFyIEVyOyhmdW5jdGlvbihjKXtjW2MuQj0wXT0iQiIsY1tjLkE9MV09IkEiLGNbYy5ZPTJdPSJZIixjW2MuWD0zXT0iWCIsY1tjLkw9NF09IkwiLGNbYy5SPTVdPSJSIixjW2MuWkw9Nl09IlpMIixjW2MuWlI9N109IlpSIixjW2MuTWludXM9OF09Ik1pbnVzIixjW2MuUGx1cz05XT0iUGx1cyIsY1tjLkxTPTEwXT0iTFMiLGNbYy5SUz0xMV09IlJTIixjW2MuRFBhZFVwPTEyXT0iRFBhZFVwIixjW2MuRFBhZERvd249MTNdPSJEUGFkRG93biIsY1tjLkRQYWRMZWZ0PTE0XT0iRFBhZExlZnQiLGNbYy5EUGFkUmlnaHQ9MTVdPSJEUGFkUmlnaHQiLGNbYy5Ib21lPTE2XT0iSG9tZSIsY1tjLkNhcHR1cmU9MTddPSJDYXB0dXJlIixjW2MuTFN0aWNrWEF4aXM9MThdPSJMU3RpY2tYQXhpcyIsY1tjLkxTdGlja1lBeGlzPTE5XT0iTFN0aWNrWUF4aXMiLGNbYy5SU3RpY2tYQXhpcz0yMF09IlJTdGlja1hBeGlzIixjW2MuUlN0aWNrWUF4aXM9MjFdPSJSU3RpY2tZQXhpcyJ9KShFcnx8KEVyPXt9KSk7dmFyIHZyOyhmdW5jdGlvbihjKXtjW2MuUG9pbnRlck1vdmU9MF09IlBvaW50ZXJNb3ZlIixjW2MuUG9pbnRlckRvd249MV09IlBvaW50ZXJEb3duIixjW2MuUG9pbnRlclVwPTJdPSJQb2ludGVyVXAifSkodnJ8fCh2cj17fSkpO2NsYXNzIHRze310cy5ET01fREVMVEFfUElYRUw9MCx0cy5ET01fREVMVEFfTElORT0xLHRzLkRPTV9ERUxUQV9QQUdFPTI7Y2xhc3MgZGl7c3RhdGljIENyZWF0ZURldmljZUV2ZW50KGUsdCxpLHMscixuKXtzd2l0Y2goZSl7Y2FzZSB6LktleWJvYXJkOnJldHVybiB0aGlzLl9DcmVhdGVLZXlib2FyZEV2ZW50KGkscyxyLG4pO2Nhc2Ugei5Nb3VzZTppZihpPT09US5Nb3VzZVdoZWVsWHx8aT09PVEuTW91c2VXaGVlbFl8fGk9PT1RLk1vdXNlV2hlZWxaKXJldHVybiB0aGlzLl9DcmVhdGVXaGVlbEV2ZW50KGUsdCxpLHMscixuKTtjYXNlIHouVG91Y2g6cmV0dXJuIHRoaXMuX0NyZWF0ZVBvaW50ZXJFdmVudChlLHQsaSxzLHIsbik7ZGVmYXVsdDp0aHJvd2BVbmFibGUgdG8gZ2VuZXJhdGUgZXZlbnQgZm9yIGRldmljZSAke3pbZV19YH19c3RhdGljIF9DcmVhdGVQb2ludGVyRXZlbnQoZSx0LGkscyxyLG4pe2NvbnN0IGE9dGhpcy5fQ3JlYXRlTW91c2VFdmVudChlLHQsaSxzLHIsbik7cmV0dXJuIGU9PT16Lk1vdXNlPyhhLmRldmljZVR5cGU9ei5Nb3VzZSxhLnBvaW50ZXJJZD0xLGEucG9pbnRlclR5cGU9Im1vdXNlIik6KGEuZGV2aWNlVHlwZT16LlRvdWNoLGEucG9pbnRlcklkPXQsYS5wb2ludGVyVHlwZT0idG91Y2giKSxpPT09US5Nb3ZlP2EudHlwZT0icG9pbnRlcm1vdmUiOmk+PVEuTGVmdENsaWNrJiZpPD1RLlJpZ2h0Q2xpY2smJihhLnR5cGU9cz09PTE/InBvaW50ZXJkb3duIjoicG9pbnRlcnVwIixhLmJ1dHRvbj1pLTIpLGF9c3RhdGljIF9DcmVhdGVXaGVlbEV2ZW50KGUsdCxpLHMscixuKXtjb25zdCBhPXRoaXMuX0NyZWF0ZU1vdXNlRXZlbnQoZSx0LGkscyxyLG4pO3N3aXRjaChhLnR5cGU9IndoZWVsIixhLmRlbHRhTW9kZT10cy5ET01fREVMVEFfUElYRUwsYS5kZWx0YVg9MCxhLmRlbHRhWT0wLGEuZGVsdGFaPTAsaSl7Y2FzZSBRLk1vdXNlV2hlZWxYOmEuZGVsdGFYPXM7YnJlYWs7Y2FzZSBRLk1vdXNlV2hlZWxZOmEuZGVsdGFZPXM7YnJlYWs7Y2FzZSBRLk1vdXNlV2hlZWxaOmEuZGVsdGFaPXM7YnJlYWt9cmV0dXJuIGF9c3RhdGljIF9DcmVhdGVNb3VzZUV2ZW50KGUsdCxpLHMscixuKXtjb25zdCBhPXRoaXMuX0NyZWF0ZUV2ZW50KG4pLG89ci5wb2xsSW5wdXQoZSx0LFEuSG9yaXpvbnRhbCksaD1yLnBvbGxJbnB1dChlLHQsUS5WZXJ0aWNhbCk7cmV0dXJuIG4/KGEubW92ZW1lbnRYPTAsYS5tb3ZlbWVudFk9MCxhLm9mZnNldFg9YS5tb3ZlbWVudFgtbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS54LGEub2Zmc2V0WT1hLm1vdmVtZW50WS1uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkpOihhLm1vdmVtZW50WD1yLnBvbGxJbnB1dChlLHQsZXMuRGVsdGFIb3Jpem9udGFsKSxhLm1vdmVtZW50WT1yLnBvbGxJbnB1dChlLHQsZXMuRGVsdGFWZXJ0aWNhbCksYS5vZmZzZXRYPTAsYS5vZmZzZXRZPTApLHRoaXMuX0NoZWNrTm9uQ2hhcmFjdGVyS2V5cyhhLHIpLGEuY2xpZW50WD1vLGEuY2xpZW50WT1oLGEueD1vLGEueT1oLGEuZGV2aWNlVHlwZT1lLGEuZGV2aWNlU2xvdD10LGEuaW5wdXRJbmRleD1pLGF9c3RhdGljIF9DcmVhdGVLZXlib2FyZEV2ZW50KGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5fQ3JlYXRlRXZlbnQocyk7cmV0dXJuIHRoaXMuX0NoZWNrTm9uQ2hhcmFjdGVyS2V5cyhyLGkpLHIuZGV2aWNlVHlwZT16LktleWJvYXJkLHIuZGV2aWNlU2xvdD0wLHIuaW5wdXRJbmRleD1lLHIudHlwZT10PT09MT8ia2V5ZG93biI6ImtleXVwIixyLmtleT1TdHJpbmcuZnJvbUNoYXJDb2RlKGUpLHIua2V5Q29kZT1lLHJ9c3RhdGljIF9DaGVja05vbkNoYXJhY3RlcktleXMoZSx0KXtjb25zdCBpPXQuaXNEZXZpY2VBdmFpbGFibGUoei5LZXlib2FyZCkscz1pJiZ0LnBvbGxJbnB1dCh6LktleWJvYXJkLDAsMTgpPT09MSxyPWkmJnQucG9sbElucHV0KHouS2V5Ym9hcmQsMCwxNyk9PT0xLG49aSYmKHQucG9sbElucHV0KHouS2V5Ym9hcmQsMCw5MSk9PT0xfHx0LnBvbGxJbnB1dCh6LktleWJvYXJkLDAsOTIpPT09MXx8dC5wb2xsSW5wdXQoei5LZXlib2FyZCwwLDkzKT09PTEpLGE9aSYmdC5wb2xsSW5wdXQoei5LZXlib2FyZCwwLDE2KT09PTE7ZS5hbHRLZXk9cyxlLmN0cmxLZXk9cixlLm1ldGFLZXk9bixlLnNoaWZ0S2V5PWF9c3RhdGljIF9DcmVhdGVFdmVudChlKXtjb25zdCB0PXt9O3JldHVybiB0LnByZXZlbnREZWZhdWx0PSgpPT57fSx0LnRhcmdldD1lLHR9fWNsYXNzIElue2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLl9uYXRpdmVJbnB1dD1fbmF0aXZlLkRldmljZUlucHV0U3lzdGVtP25ldyBfbmF0aXZlLkRldmljZUlucHV0U3lzdGVtKGUsdCwocyxyLG4sYSk9Pntjb25zdCBvPWRpLkNyZWF0ZURldmljZUV2ZW50KHMscixuLGEsdGhpcyk7aShzLHIsbyl9KTp0aGlzLl9jcmVhdGVEdW1teU5hdGl2ZUlucHV0KCl9cG9sbElucHV0KGUsdCxpKXtyZXR1cm4gdGhpcy5fbmF0aXZlSW5wdXQucG9sbElucHV0KGUsdCxpKX1pc0RldmljZUF2YWlsYWJsZShlKXtyZXR1cm4gZT09PXouTW91c2V8fGU9PT16LlRvdWNofWRpc3Bvc2UoKXt0aGlzLl9uYXRpdmVJbnB1dC5kaXNwb3NlKCl9X2NyZWF0ZUR1bW15TmF0aXZlSW5wdXQoKXtyZXR1cm57cG9sbElucHV0OigpPT4wLGlzRGV2aWNlQXZhaWxhYmxlOigpPT4hMSxkaXNwb3NlOigpPT57fX19fWNvbnN0IFRyPTI1NSxicj1PYmplY3Qua2V5cyhRKS5sZW5ndGgvMjtjbGFzcyBQbntjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLl9pbnB1dHM9W10sdGhpcy5fa2V5Ym9hcmRBY3RpdmU9ITEsdGhpcy5fcG9pbnRlckFjdGl2ZT0hMSx0aGlzLl91c2luZ1NhZmFyaT1ILklzU2FmYXJpKCksdGhpcy5fdXNpbmdNYWNPUz0vKE1hY3xpUGhvbmV8aVBvZHxpUGFkKS9pLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSx0aGlzLl9rZXlib2FyZERvd25FdmVudD1yPT57fSx0aGlzLl9rZXlib2FyZFVwRXZlbnQ9cj0+e30sdGhpcy5fa2V5Ym9hcmRCbHVyRXZlbnQ9cj0+e30sdGhpcy5fcG9pbnRlck1vdmVFdmVudD1yPT57fSx0aGlzLl9wb2ludGVyRG93bkV2ZW50PXI9Pnt9LHRoaXMuX3BvaW50ZXJVcEV2ZW50PXI9Pnt9LHRoaXMuX3BvaW50ZXJDYW5jZWxFdmVudD1yPT57fSx0aGlzLl9wb2ludGVyV2hlZWxFdmVudD1yPT57fSx0aGlzLl9wb2ludGVyQmx1ckV2ZW50PXI9Pnt9LHRoaXMuX2V2ZW50c0F0dGFjaGVkPSExLHRoaXMuX21vdXNlSWQ9LTEsdGhpcy5faXNVc2luZ0ZpcmVmb3g9cHMuSXNOYXZpZ2F0b3JBdmFpbGFibGUoKSYmbmF2aWdhdG9yLnVzZXJBZ2VudCYmbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJGaXJlZm94IikhPT0tMSx0aGlzLl9tYXhUb3VjaFBvaW50cz0wLHRoaXMuX3BvaW50ZXJJbnB1dENsZWFyT2JzZXJ2ZXI9bnVsbCx0aGlzLl9nYW1lcGFkQ29ubmVjdGVkRXZlbnQ9cj0+e30sdGhpcy5fZ2FtZXBhZERpc2Nvbm5lY3RlZEV2ZW50PXI9Pnt9LHRoaXMuX2V2ZW50UHJlZml4PUguR2V0UG9pbnRlclByZWZpeChlKSx0aGlzLl9lbmdpbmU9ZSx0aGlzLl9vbkRldmljZUNvbm5lY3RlZD10LHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkPWksdGhpcy5fb25JbnB1dENoYW5nZWQ9cyx0aGlzLl9lbmFibGVFdmVudHMoKSx0aGlzLl91c2luZ01hY09TJiYodGhpcy5fbWV0YUtleXM9W10pLHRoaXMuX2VuZ2luZS5fb25FbmdpbmVWaWV3Q2hhbmdlZHx8KHRoaXMuX2VuZ2luZS5fb25FbmdpbmVWaWV3Q2hhbmdlZD0oKT0+e3RoaXMuX2VuYWJsZUV2ZW50cygpfSl9cG9sbElucHV0KGUsdCxpKXtjb25zdCBzPXRoaXMuX2lucHV0c1tlXVt0XTtpZighcyl0aHJvd2BVbmFibGUgdG8gZmluZCBkZXZpY2UgJHt6W2VdfWA7ZT49ei5EdWFsU2hvY2smJmU8PXouRHVhbFNlbnNlJiZ0aGlzLl91cGRhdGVEZXZpY2UoZSx0LGkpO2NvbnN0IHI9c1tpXTtpZihyPT09dm9pZCAwKXRocm93YFVuYWJsZSB0byBmaW5kIGlucHV0ICR7aX0gZm9yIGRldmljZSAke3pbZV19IGluIHNsb3QgJHt0fWA7cmV0dXJuIGk9PT1RLk1vdmUmJkguV2FybigiVW5hYmxlIHRvIHByb3ZpZGUgaW5mb3JtYXRpb24gZm9yIFBvaW50ZXJJbnB1dC5Nb3ZlLiAgVHJ5IHVzaW5nIFBvaW50ZXJJbnB1dC5Ib3Jpem9udGFsIG9yIFBvaW50ZXJJbnB1dC5WZXJ0aWNhbCBmb3IgbW92ZSBkYXRhLiIpLHJ9aXNEZXZpY2VBdmFpbGFibGUoZSl7cmV0dXJuIHRoaXMuX2lucHV0c1tlXSE9PXZvaWQgMH1kaXNwb3NlKCl7dGhpcy5fb25EZXZpY2VDb25uZWN0ZWQ9KCk9Pnt9LHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkPSgpPT57fSx0aGlzLl9vbklucHV0Q2hhbmdlZD0oKT0+e30sZGVsZXRlIHRoaXMuX2VuZ2luZS5fb25FbmdpbmVWaWV3Q2hhbmdlZCx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyYmdGhpcy5fZGlzYWJsZUV2ZW50cygpfV9lbmFibGVFdmVudHMoKXtjb25zdCBlPXRoaXM9PT1udWxsfHx0aGlzPT09dm9pZCAwP3ZvaWQgMDp0aGlzLl9lbmdpbmUuZ2V0SW5wdXRFbGVtZW50KCk7aWYoZSYmKCF0aGlzLl9ldmVudHNBdHRhY2hlZHx8dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8hPT1lKSl7aWYodGhpcy5fZGlzYWJsZUV2ZW50cygpLHRoaXMuX2lucHV0cyl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5faW5wdXRzKWlmKHQpZm9yKGNvbnN0IGkgaW4gdCl7Y29uc3Qgcz0raSxyPXRbc107aWYocilmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKylyW25dPTB9fXRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvPWUsdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8udGFiSW5kZXg9dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8udGFiSW5kZXghPT0tMT90aGlzLl9lbGVtZW50VG9BdHRhY2hUby50YWJJbmRleDp0aGlzLl9lbmdpbmUuY2FudmFzVGFiSW5kZXgsdGhpcy5faGFuZGxlS2V5QWN0aW9ucygpLHRoaXMuX2hhbmRsZVBvaW50ZXJBY3Rpb25zKCksdGhpcy5faGFuZGxlR2FtZXBhZEFjdGlvbnMoKSx0aGlzLl9ldmVudHNBdHRhY2hlZD0hMCx0aGlzLl9jaGVja0ZvckNvbm5lY3RlZERldmljZXMoKX19X2Rpc2FibGVFdmVudHMoKXt0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyYmKHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbW92ZUV2ZW50TGlzdGVuZXIoImJsdXIiLHRoaXMuX2tleWJvYXJkQmx1ckV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZW1vdmVFdmVudExpc3RlbmVyKCJibHVyIix0aGlzLl9wb2ludGVyQmx1ckV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIix0aGlzLl9rZXlib2FyZERvd25FdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5dXAiLHRoaXMuX2tleWJvYXJkVXBFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsibW92ZSIsdGhpcy5fcG9pbnRlck1vdmVFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsiZG93biIsdGhpcy5fcG9pbnRlckRvd25FdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsidXAiLHRoaXMuX3BvaW50ZXJVcEV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX2V2ZW50UHJlZml4KyJjYW5jZWwiLHRoaXMuX3BvaW50ZXJDYW5jZWxFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl93aGVlbEV2ZW50TmFtZSx0aGlzLl9wb2ludGVyV2hlZWxFdmVudCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImdhbWVwYWRjb25uZWN0ZWQiLHRoaXMuX2dhbWVwYWRDb25uZWN0ZWRFdmVudCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImdhbWVwYWRkaXNjb25uZWN0ZWQiLHRoaXMuX2dhbWVwYWREaXNjb25uZWN0ZWRFdmVudCkpLHRoaXMuX3BvaW50ZXJJbnB1dENsZWFyT2JzZXJ2ZXImJnRoaXMuX2VuZ2luZS5vbkVuZEZyYW1lT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fcG9pbnRlcklucHV0Q2xlYXJPYnNlcnZlciksdGhpcy5fZXZlbnRzQXR0YWNoZWQ9ITF9X2NoZWNrRm9yQ29ubmVjdGVkRGV2aWNlcygpe2lmKG5hdmlnYXRvci5nZXRHYW1lcGFkcyl7Y29uc3QgZT1uYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKTtmb3IoY29uc3QgdCBvZiBlKXQmJnRoaXMuX2FkZEdhbWVQYWQodCl9dHlwZW9mIG1hdGNoTWVkaWE9PSJmdW5jdGlvbiImJm1hdGNoTWVkaWEoIihwb2ludGVyOmZpbmUpIikubWF0Y2hlcyYmdGhpcy5fYWRkUG9pbnRlckRldmljZSh6Lk1vdXNlLDAsMCwwKX1fYWRkR2FtZVBhZChlKXtjb25zdCB0PXRoaXMuX2dldEdhbWVwYWREZXZpY2VUeXBlKGUuaWQpLGk9ZS5pbmRleDt0aGlzLl9nYW1lcGFkcz10aGlzLl9nYW1lcGFkc3x8bmV3IEFycmF5KGUuaW5kZXgrMSksdGhpcy5fcmVnaXN0ZXJEZXZpY2UodCxpLGUuYnV0dG9ucy5sZW5ndGgrZS5heGVzLmxlbmd0aCksdGhpcy5fZ2FtZXBhZHNbaV09dH1fYWRkUG9pbnRlckRldmljZShlLHQsaSxzKXt0aGlzLl9wb2ludGVyQWN0aXZlfHwodGhpcy5fcG9pbnRlckFjdGl2ZT0hMCksdGhpcy5fcmVnaXN0ZXJEZXZpY2UoZSx0LGJyKTtjb25zdCByPXRoaXMuX2lucHV0c1tlXVt0XTtyWzBdPWksclsxXT1zfV9yZWdpc3RlckRldmljZShlLHQsaSl7aWYodD09PXZvaWQgMCl0aHJvd2BVbmFibGUgdG8gcmVnaXN0ZXIgZGV2aWNlICR7eltlXX0gdG8gdW5kZWZpbmVkIHNsb3QuYDtpZih0aGlzLl9pbnB1dHNbZV18fCh0aGlzLl9pbnB1dHNbZV09e30pLCF0aGlzLl9pbnB1dHNbZV1bdF0pe2NvbnN0IHM9bmV3IEFycmF5KGkpO3MuZmlsbCgwKSx0aGlzLl9pbnB1dHNbZV1bdF09cyx0aGlzLl9vbkRldmljZUNvbm5lY3RlZChlLHQpfX1fdW5yZWdpc3RlckRldmljZShlLHQpe3RoaXMuX2lucHV0c1tlXVt0XSYmKGRlbGV0ZSB0aGlzLl9pbnB1dHNbZV1bdF0sdGhpcy5fb25EZXZpY2VEaXNjb25uZWN0ZWQoZSx0KSl9X2hhbmRsZUtleUFjdGlvbnMoKXt0aGlzLl9rZXlib2FyZERvd25FdmVudD1lPT57dGhpcy5fa2V5Ym9hcmRBY3RpdmV8fCh0aGlzLl9rZXlib2FyZEFjdGl2ZT0hMCx0aGlzLl9yZWdpc3RlckRldmljZSh6LktleWJvYXJkLDAsVHIpKTtjb25zdCB0PXRoaXMuX2lucHV0c1t6LktleWJvYXJkXVswXTtpZih0KXt0W2Uua2V5Q29kZV09MTtjb25zdCBpPWU7aS5pbnB1dEluZGV4PWUua2V5Q29kZSx0aGlzLl91c2luZ01hY09TJiZlLm1ldGFLZXkmJmUua2V5IT09Ik1ldGEiJiYodGhpcy5fbWV0YUtleXMuaW5jbHVkZXMoZS5rZXlDb2RlKXx8dGhpcy5fbWV0YUtleXMucHVzaChlLmtleUNvZGUpKSx0aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAsaSl9fSx0aGlzLl9rZXlib2FyZFVwRXZlbnQ9ZT0+e3RoaXMuX2tleWJvYXJkQWN0aXZlfHwodGhpcy5fa2V5Ym9hcmRBY3RpdmU9ITAsdGhpcy5fcmVnaXN0ZXJEZXZpY2Uoei5LZXlib2FyZCwwLFRyKSk7Y29uc3QgdD10aGlzLl9pbnB1dHNbei5LZXlib2FyZF1bMF07aWYodCl7dFtlLmtleUNvZGVdPTA7Y29uc3QgaT1lO2lmKGkuaW5wdXRJbmRleD1lLmtleUNvZGUsdGhpcy5fdXNpbmdNYWNPUyYmZS5rZXk9PT0iTWV0YSImJnRoaXMuX21ldGFLZXlzLmxlbmd0aD4wKXtmb3IoY29uc3QgcyBvZiB0aGlzLl9tZXRhS2V5cyl7Y29uc3Qgcj1kaS5DcmVhdGVEZXZpY2VFdmVudCh6LktleWJvYXJkLDAscywwLHRoaXMsdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pO3Rbc109MCx0aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAscil9dGhpcy5fbWV0YUtleXMuc3BsaWNlKDAsdGhpcy5fbWV0YUtleXMubGVuZ3RoKX10aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAsaSl9fSx0aGlzLl9rZXlib2FyZEJsdXJFdmVudD0oKT0+e2lmKHRoaXMuX2tleWJvYXJkQWN0aXZlKXtjb25zdCBlPXRoaXMuX2lucHV0c1t6LktleWJvYXJkXVswXTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoO3QrKylpZihlW3RdIT09MCl7ZVt0XT0wO2NvbnN0IGk9ZGkuQ3JlYXRlRGV2aWNlRXZlbnQoei5LZXlib2FyZCwwLHQsMCx0aGlzLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvKTt0aGlzLl9vbklucHV0Q2hhbmdlZCh6LktleWJvYXJkLDAsaSl9dGhpcy5fdXNpbmdNYWNPUyYmdGhpcy5fbWV0YUtleXMuc3BsaWNlKDAsdGhpcy5fbWV0YUtleXMubGVuZ3RoKX19LHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLHRoaXMuX2tleWJvYXJkRG93bkV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5hZGRFdmVudExpc3RlbmVyKCJrZXl1cCIsdGhpcy5fa2V5Ym9hcmRVcEV2ZW50KSx0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5hZGRFdmVudExpc3RlbmVyKCJibHVyIix0aGlzLl9rZXlib2FyZEJsdXJFdmVudCl9X2hhbmRsZVBvaW50ZXJBY3Rpb25zKCl7dGhpcy5fbWF4VG91Y2hQb2ludHM9cHMuSXNOYXZpZ2F0b3JBdmFpbGFibGUoKSYmbmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzfHwyLHRoaXMuX2FjdGl2ZVRvdWNoSWRzfHwodGhpcy5fYWN0aXZlVG91Y2hJZHM9bmV3IEFycmF5KHRoaXMuX21heFRvdWNoUG9pbnRzKSk7Zm9yKGxldCBpPTA7aTx0aGlzLl9tYXhUb3VjaFBvaW50cztpKyspdGhpcy5fYWN0aXZlVG91Y2hJZHNbaV09LTE7dGhpcy5fcG9pbnRlck1vdmVFdmVudD1pPT57Y29uc3Qgcz10aGlzLl9nZXRQb2ludGVyVHlwZShpKSxyPXM9PT16Lk1vdXNlPzA6dGhpcy5fYWN0aXZlVG91Y2hJZHMuaW5kZXhPZihpLnBvaW50ZXJJZCk7dGhpcy5faW5wdXRzW3NdfHwodGhpcy5faW5wdXRzW3NdPXt9KSx0aGlzLl9pbnB1dHNbc11bcl18fHRoaXMuX2FkZFBvaW50ZXJEZXZpY2UocyxyLGkuY2xpZW50WCxpLmNsaWVudFkpO2NvbnN0IG49dGhpcy5faW5wdXRzW3NdW3JdO2lmKG4pe2NvbnN0IGE9aTthLmlucHV0SW5kZXg9US5Nb3ZlLG5bUS5Ib3Jpem9udGFsXT1pLmNsaWVudFgsbltRLlZlcnRpY2FsXT1pLmNsaWVudFksdGhpcy5fb25JbnB1dENoYW5nZWQocyxyLGEpLCF0aGlzLl91c2luZ1NhZmFyaSYmaS5idXR0b24hPT0tMSYmKGEuaW5wdXRJbmRleD1pLmJ1dHRvbisyLG5baS5idXR0b24rMl09bltpLmJ1dHRvbisyXT8wOjEsdGhpcy5fb25JbnB1dENoYW5nZWQocyxyLGEpKX19LHRoaXMuX3BvaW50ZXJEb3duRXZlbnQ9aT0+e2NvbnN0IHM9dGhpcy5fZ2V0UG9pbnRlclR5cGUoaSk7bGV0IHI9cz09PXouTW91c2U/MDppLnBvaW50ZXJJZDtpZihzPT09ei5Ub3VjaCl7Y29uc3QgYT10aGlzLl9hY3RpdmVUb3VjaElkcy5pbmRleE9mKC0xKTtpZihhPj0wKXI9YSx0aGlzLl9hY3RpdmVUb3VjaElkc1thXT1pLnBvaW50ZXJJZDtlbHNle0guV2FybihgTWF4IG51bWJlciBvZiB0b3VjaGVzIGV4Y2VlZGVkLiAgSWdub3JpbmcgdG91Y2hlcyBpbiBleGNlc3Mgb2YgJHt0aGlzLl9tYXhUb3VjaFBvaW50c31gKTtyZXR1cm59fXRoaXMuX2lucHV0c1tzXXx8KHRoaXMuX2lucHV0c1tzXT17fSksdGhpcy5faW5wdXRzW3NdW3JdP3M9PT16LlRvdWNoJiZ0aGlzLl9vbkRldmljZUNvbm5lY3RlZChzLHIpOnRoaXMuX2FkZFBvaW50ZXJEZXZpY2UocyxyLGkuY2xpZW50WCxpLmNsaWVudFkpO2NvbnN0IG49dGhpcy5faW5wdXRzW3NdW3JdO2lmKG4pe2NvbnN0IGE9bltRLkhvcml6b250YWxdLG89bltRLlZlcnRpY2FsXTtpZihzPT09ei5Nb3VzZSl7aWYodGhpcy5fbW91c2VJZD09PS0xJiYoaS5wb2ludGVySWQ9PT12b2lkIDA/dGhpcy5fbW91c2VJZD10aGlzLl9pc1VzaW5nRmlyZWZveD8wOjE6dGhpcy5fbW91c2VJZD1pLnBvaW50ZXJJZCksIWRvY3VtZW50LnBvaW50ZXJMb2NrRWxlbWVudCl0cnl7dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8uc2V0UG9pbnRlckNhcHR1cmUodGhpcy5fbW91c2VJZCl9Y2F0Y2h7fX1lbHNlIGlmKGkucG9pbnRlcklkJiYhZG9jdW1lbnQucG9pbnRlckxvY2tFbGVtZW50KXRyeXt0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5zZXRQb2ludGVyQ2FwdHVyZShpLnBvaW50ZXJJZCl9Y2F0Y2h7fW5bUS5Ib3Jpem9udGFsXT1pLmNsaWVudFgsbltRLlZlcnRpY2FsXT1pLmNsaWVudFksbltpLmJ1dHRvbisyXT0xO2NvbnN0IGg9aTtoLmlucHV0SW5kZXg9aS5idXR0b24rMix0aGlzLl9vbklucHV0Q2hhbmdlZChzLHIsaCksKGEhPT1pLmNsaWVudFh8fG8hPT1pLmNsaWVudFkpJiYoaC5pbnB1dEluZGV4PVEuTW92ZSx0aGlzLl9vbklucHV0Q2hhbmdlZChzLHIsaCkpfX0sdGhpcy5fcG9pbnRlclVwRXZlbnQ9aT0+e3ZhciBzLHIsbixhLG87Y29uc3QgaD10aGlzLl9nZXRQb2ludGVyVHlwZShpKSxsPWg9PT16Lk1vdXNlPzA6dGhpcy5fYWN0aXZlVG91Y2hJZHMuaW5kZXhPZihpLnBvaW50ZXJJZCk7aWYoaD09PXouVG91Y2gpe2lmKGw9PT0tMSlyZXR1cm47dGhpcy5fYWN0aXZlVG91Y2hJZHNbbF09LTF9Y29uc3QgdT0ocz10aGlzLl9pbnB1dHNbaF0pPT09bnVsbHx8cz09PXZvaWQgMD92b2lkIDA6c1tsXTtpZih1JiZ1W2kuYnV0dG9uKzJdIT09MCl7Y29uc3QgZD11W1EuSG9yaXpvbnRhbF0sZj11W1EuVmVydGljYWxdO3VbUS5Ib3Jpem9udGFsXT1pLmNsaWVudFgsdVtRLlZlcnRpY2FsXT1pLmNsaWVudFksdVtpLmJ1dHRvbisyXT0wO2NvbnN0IF89aTsoZCE9PWkuY2xpZW50WHx8ZiE9PWkuY2xpZW50WSkmJihfLmlucHV0SW5kZXg9US5Nb3ZlLHRoaXMuX29uSW5wdXRDaGFuZ2VkKGgsbCxfKSksXy5pbnB1dEluZGV4PWkuYnV0dG9uKzIsaD09PXouTW91c2UmJnRoaXMuX21vdXNlSWQ+PTAmJighKChuPShyPXRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvKS5oYXNQb2ludGVyQ2FwdHVyZSk9PT1udWxsfHxuPT09dm9pZCAwKSYmbi5jYWxsKHIsdGhpcy5fbW91c2VJZCkpP3RoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbGVhc2VQb2ludGVyQ2FwdHVyZSh0aGlzLl9tb3VzZUlkKTppLnBvaW50ZXJJZCYmKCEoKG89KGE9dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pLmhhc1BvaW50ZXJDYXB0dXJlKT09PW51bGx8fG89PT12b2lkIDApJiZvLmNhbGwoYSxpLnBvaW50ZXJJZCkpJiZ0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZWxlYXNlUG9pbnRlckNhcHR1cmUoaS5wb2ludGVySWQpLHRoaXMuX29uSW5wdXRDaGFuZ2VkKGgsbCxfKSxoPT09ei5Ub3VjaCYmdGhpcy5fb25EZXZpY2VEaXNjb25uZWN0ZWQoaCxsKX19LHRoaXMuX3BvaW50ZXJDYW5jZWxFdmVudD1pPT57dmFyIHMscixuLGE7aWYoaS5wb2ludGVyVHlwZT09PSJtb3VzZSIpe2NvbnN0IG89dGhpcy5faW5wdXRzW3ouTW91c2VdWzBdO3RoaXMuX21vdXNlSWQ+PTAmJighKChyPShzPXRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvKS5oYXNQb2ludGVyQ2FwdHVyZSk9PT1udWxsfHxyPT09dm9pZCAwKSYmci5jYWxsKHMsdGhpcy5fbW91c2VJZCkpJiZ0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZWxlYXNlUG9pbnRlckNhcHR1cmUodGhpcy5fbW91c2VJZCk7Zm9yKGxldCBoPVEuTGVmdENsaWNrO2g8PVEuQnJvd3NlckZvcndhcmQ7aCsrKWlmKG9baF09PT0xKXtvW2hdPTA7Y29uc3QgbD1kaS5DcmVhdGVEZXZpY2VFdmVudCh6Lk1vdXNlLDAsaCwwLHRoaXMsdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pO3RoaXMuX29uSW5wdXRDaGFuZ2VkKHouTW91c2UsMCxsKX19ZWxzZXtjb25zdCBvPXRoaXMuX2FjdGl2ZVRvdWNoSWRzLmluZGV4T2YoaS5wb2ludGVySWQpOyEoKGE9KG49dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pLmhhc1BvaW50ZXJDYXB0dXJlKT09PW51bGx8fGE9PT12b2lkIDApJiZhLmNhbGwobixpLnBvaW50ZXJJZCkmJnRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbGVhc2VQb2ludGVyQ2FwdHVyZShpLnBvaW50ZXJJZCksdGhpcy5faW5wdXRzW3ouVG91Y2hdW29dW1EuTGVmdENsaWNrXT0wO2NvbnN0IGg9ZGkuQ3JlYXRlRGV2aWNlRXZlbnQoei5Ub3VjaCxvLFEuTGVmdENsaWNrLDAsdGhpcyx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyk7dGhpcy5fb25JbnB1dENoYW5nZWQoei5Ub3VjaCxvLGgpLHRoaXMuX2FjdGl2ZVRvdWNoSWRzW29dPS0xLHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkKHouVG91Y2gsbyl9fSx0aGlzLl93aGVlbEV2ZW50TmFtZT0ib253aGVlbCJpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKT8id2hlZWwiOmRvY3VtZW50Lm9ubW91c2V3aGVlbCE9PXZvaWQgMD8ibW91c2V3aGVlbCI6IkRPTU1vdXNlU2Nyb2xsIjtsZXQgZT0hMTtjb25zdCB0PWZ1bmN0aW9uKCl7fTt0cnl7Y29uc3QgaT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sInBhc3NpdmUiLHtnZXQ6ZnVuY3Rpb24oKXtlPSEwfX0pO3RoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIoInRlc3QiLHQsaSksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigidGVzdCIsdCxpKX1jYXRjaHt9dGhpcy5fcG9pbnRlckJsdXJFdmVudD0oKT0+e3ZhciBpLHMscixuLGE7aWYodGhpcy5pc0RldmljZUF2YWlsYWJsZSh6Lk1vdXNlKSl7Y29uc3Qgbz10aGlzLl9pbnB1dHNbei5Nb3VzZV1bMF07dGhpcy5fbW91c2VJZD49MCYmKCEoKHM9KGk9dGhpcy5fZWxlbWVudFRvQXR0YWNoVG8pLmhhc1BvaW50ZXJDYXB0dXJlKT09PW51bGx8fHM9PT12b2lkIDApJiZzLmNhbGwoaSx0aGlzLl9tb3VzZUlkKSkmJnRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLnJlbGVhc2VQb2ludGVyQ2FwdHVyZSh0aGlzLl9tb3VzZUlkKTtmb3IobGV0IGg9US5MZWZ0Q2xpY2s7aDw9US5Ccm93c2VyRm9yd2FyZDtoKyspaWYob1toXT09PTEpe29baF09MDtjb25zdCBsPWRpLkNyZWF0ZURldmljZUV2ZW50KHouTW91c2UsMCxoLDAsdGhpcyx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyk7dGhpcy5fb25JbnB1dENoYW5nZWQoei5Nb3VzZSwwLGwpfX1pZih0aGlzLmlzRGV2aWNlQXZhaWxhYmxlKHouVG91Y2gpKXtjb25zdCBvPXRoaXMuX2lucHV0c1t6LlRvdWNoXTtmb3IobGV0IGg9MDtoPHRoaXMuX2FjdGl2ZVRvdWNoSWRzLmxlbmd0aDtoKyspe2NvbnN0IGw9dGhpcy5fYWN0aXZlVG91Y2hJZHNbaF07aWYoISgobj0ocj10aGlzLl9lbGVtZW50VG9BdHRhY2hUbykuaGFzUG9pbnRlckNhcHR1cmUpPT09bnVsbHx8bj09PXZvaWQgMCkmJm4uY2FsbChyLGwpJiZ0aGlzLl9lbGVtZW50VG9BdHRhY2hUby5yZWxlYXNlUG9pbnRlckNhcHR1cmUobCksbCE9PS0xJiYoKGE9b1toXSk9PT1udWxsfHxhPT09dm9pZCAwP3ZvaWQgMDphW1EuTGVmdENsaWNrXSk9PT0xKXtvW2hdW1EuTGVmdENsaWNrXT0wO2NvbnN0IHU9ZGkuQ3JlYXRlRGV2aWNlRXZlbnQoei5Ub3VjaCxoLFEuTGVmdENsaWNrLDAsdGhpcyx0aGlzLl9lbGVtZW50VG9BdHRhY2hUbyk7dGhpcy5fb25JbnB1dENoYW5nZWQoei5Ub3VjaCxoLHUpLHRoaXMuX2FjdGl2ZVRvdWNoSWRzW2hdPS0xLHRoaXMuX29uRGV2aWNlRGlzY29ubmVjdGVkKHouVG91Y2gsaCl9fX19LHRoaXMuX3BvaW50ZXJXaGVlbEV2ZW50PWk9Pntjb25zdCBzPXouTW91c2Uscj0wO3RoaXMuX2lucHV0c1tzXXx8KHRoaXMuX2lucHV0c1tzXT1bXSksdGhpcy5faW5wdXRzW3NdW3JdfHwodGhpcy5fcG9pbnRlckFjdGl2ZT0hMCx0aGlzLl9yZWdpc3RlckRldmljZShzLHIsYnIpKTtjb25zdCBuPXRoaXMuX2lucHV0c1tzXVtyXTtpZihuKXtuW1EuTW91c2VXaGVlbFhdPWkuZGVsdGFYfHwwLG5bUS5Nb3VzZVdoZWVsWV09aS5kZWx0YVl8fGkud2hlZWxEZWx0YXx8MCxuW1EuTW91c2VXaGVlbFpdPWkuZGVsdGFafHwwO2NvbnN0IGE9aTtuW1EuTW91c2VXaGVlbFhdIT09MCYmKGEuaW5wdXRJbmRleD1RLk1vdXNlV2hlZWxYLHRoaXMuX29uSW5wdXRDaGFuZ2VkKHMscixhKSksbltRLk1vdXNlV2hlZWxZXSE9PTAmJihhLmlucHV0SW5kZXg9US5Nb3VzZVdoZWVsWSx0aGlzLl9vbklucHV0Q2hhbmdlZChzLHIsYSkpLG5bUS5Nb3VzZVdoZWVsWl0hPT0wJiYoYS5pbnB1dEluZGV4PVEuTW91c2VXaGVlbFosdGhpcy5fb25JbnB1dENoYW5nZWQocyxyLGEpKX19LHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRQcmVmaXgrIm1vdmUiLHRoaXMuX3BvaW50ZXJNb3ZlRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRQcmVmaXgrImRvd24iLHRoaXMuX3BvaW50ZXJEb3duRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fZXZlbnRQcmVmaXgrInVwIix0aGlzLl9wb2ludGVyVXBFdmVudCksdGhpcy5fZWxlbWVudFRvQXR0YWNoVG8uYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9ldmVudFByZWZpeCsiY2FuY2VsIix0aGlzLl9wb2ludGVyQ2FuY2VsRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLHRoaXMuX3BvaW50ZXJCbHVyRXZlbnQpLHRoaXMuX2VsZW1lbnRUb0F0dGFjaFRvLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fd2hlZWxFdmVudE5hbWUsdGhpcy5fcG9pbnRlcldoZWVsRXZlbnQsZT97cGFzc2l2ZTohMX06ITEpLHRoaXMuX3BvaW50ZXJJbnB1dENsZWFyT2JzZXJ2ZXI9dGhpcy5fZW5naW5lLm9uRW5kRnJhbWVPYnNlcnZhYmxlLmFkZCgoKT0+e2lmKHRoaXMuaXNEZXZpY2VBdmFpbGFibGUoei5Nb3VzZSkpe2NvbnN0IGk9dGhpcy5faW5wdXRzW3ouTW91c2VdWzBdO2lbUS5Nb3VzZVdoZWVsWF09MCxpW1EuTW91c2VXaGVlbFldPTAsaVtRLk1vdXNlV2hlZWxaXT0wfX0pfV9oYW5kbGVHYW1lcGFkQWN0aW9ucygpe3RoaXMuX2dhbWVwYWRDb25uZWN0ZWRFdmVudD1lPT57dGhpcy5fYWRkR2FtZVBhZChlLmdhbWVwYWQpfSx0aGlzLl9nYW1lcGFkRGlzY29ubmVjdGVkRXZlbnQ9ZT0+e2lmKHRoaXMuX2dhbWVwYWRzKXtjb25zdCB0PXRoaXMuX2dldEdhbWVwYWREZXZpY2VUeXBlKGUuZ2FtZXBhZC5pZCksaT1lLmdhbWVwYWQuaW5kZXg7dGhpcy5fdW5yZWdpc3RlckRldmljZSh0LGkpLGRlbGV0ZSB0aGlzLl9nYW1lcGFkc1tpXX19LHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJnYW1lcGFkY29ubmVjdGVkIix0aGlzLl9nYW1lcGFkQ29ubmVjdGVkRXZlbnQpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJnYW1lcGFkZGlzY29ubmVjdGVkIix0aGlzLl9nYW1lcGFkRGlzY29ubmVjdGVkRXZlbnQpfV91cGRhdGVEZXZpY2UoZSx0LGkpe2NvbnN0IHM9bmF2aWdhdG9yLmdldEdhbWVwYWRzKClbdF07aWYocyYmZT09PXRoaXMuX2dhbWVwYWRzW3RdKXtjb25zdCByPXRoaXMuX2lucHV0c1tlXVt0XTtpPj1zLmJ1dHRvbnMubGVuZ3RoP3JbaV09cy5heGVzW2ktcy5idXR0b25zLmxlbmd0aF0udmFsdWVPZigpOnJbaV09cy5idXR0b25zW2ldLnZhbHVlfX1fZ2V0R2FtZXBhZERldmljZVR5cGUoZSl7cmV0dXJuIGUuaW5kZXhPZigiMDU0YyIpIT09LTE/ZS5pbmRleE9mKCIwY2U2IikhPT0tMT96LkR1YWxTZW5zZTp6LkR1YWxTaG9jazplLmluZGV4T2YoIlhib3ggT25lIikhPT0tMXx8ZS5zZWFyY2goIlhib3ggMzYwIikhPT0tMXx8ZS5zZWFyY2goInhpbnB1dCIpIT09LTE/ei5YYm94OmUuaW5kZXhPZigiMDU3ZSIpIT09LTE/ei5Td2l0Y2g6ei5HZW5lcmljfV9nZXRQb2ludGVyVHlwZShlKXtsZXQgdD16Lk1vdXNlO3JldHVybihlLnBvaW50ZXJUeXBlPT09InRvdWNoInx8ZS5wb2ludGVyVHlwZT09PSJwZW4ifHxlLnRvdWNoZXMpJiYodD16LlRvdWNoKSx0fX1jbGFzcyBTcntjb25zdHJ1Y3RvcihlLHQsaT0wKXt0aGlzLmRldmljZVR5cGU9dCx0aGlzLmRldmljZVNsb3Q9aSx0aGlzLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbT1lfWdldElucHV0KGUpe3JldHVybiB0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbS5wb2xsSW5wdXQodGhpcy5kZXZpY2VUeXBlLHRoaXMuZGV2aWNlU2xvdCxlKX19Y2xhc3MgRG57Y29uc3RydWN0b3IoZSl7dGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzPW5ldyBBcnJheSx0aGlzLl9yZWZDb3VudD0wLHRoaXMucmVnaXN0ZXJNYW5hZ2VyPW49Pntmb3IobGV0IGE9MDthPHRoaXMuX2RldmljZXMubGVuZ3RoO2ErKyl7Y29uc3Qgbz10aGlzLl9kZXZpY2VzW2FdO2Zvcihjb25zdCBoIGluIG8pe2NvbnN0IGw9K2g7bi5fYWRkRGV2aWNlKG5ldyBTcih0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbSxhLGwpKX19dGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzLnB1c2gobil9LHRoaXMudW5yZWdpc3Rlck1hbmFnZXI9bj0+e2NvbnN0IGE9dGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzLmluZGV4T2Yobik7YT4tMSYmdGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzLnNwbGljZShhLDEpfTtjb25zdCB0PU9iamVjdC5rZXlzKHopLmxlbmd0aC8yO3RoaXMuX2RldmljZXM9bmV3IEFycmF5KHQpO2NvbnN0IGk9KG4sYSk9Pnt0aGlzLl9kZXZpY2VzW25dfHwodGhpcy5fZGV2aWNlc1tuXT1uZXcgQXJyYXkpLHRoaXMuX2RldmljZXNbbl1bYV18fCh0aGlzLl9kZXZpY2VzW25dW2FdPWEpO2Zvcihjb25zdCBvIG9mIHRoaXMuX3JlZ2lzdGVyZWRNYW5hZ2Vycyl7Y29uc3QgaD1uZXcgU3IodGhpcy5fZGV2aWNlSW5wdXRTeXN0ZW0sbixhKTtvLl9hZGREZXZpY2UoaCl9fSxzPShuLGEpPT57dmFyIG87ISgobz10aGlzLl9kZXZpY2VzW25dKT09PW51bGx8fG89PT12b2lkIDApJiZvW2FdJiZkZWxldGUgdGhpcy5fZGV2aWNlc1tuXVthXTtmb3IoY29uc3QgaCBvZiB0aGlzLl9yZWdpc3RlcmVkTWFuYWdlcnMpaC5fcmVtb3ZlRGV2aWNlKG4sYSl9LHI9KG4sYSxvKT0+e2lmKG8pZm9yKGNvbnN0IGggb2YgdGhpcy5fcmVnaXN0ZXJlZE1hbmFnZXJzKWguX29uSW5wdXRDaGFuZ2VkKG4sYSxvKX07dHlwZW9mIF9uYXRpdmU8InUiP3RoaXMuX2RldmljZUlucHV0U3lzdGVtPW5ldyBJbihpLHMscik6dGhpcy5fZGV2aWNlSW5wdXRTeXN0ZW09bmV3IFBuKGUsaSxzLHIpfWRpc3Bvc2UoKXt0aGlzLl9kZXZpY2VJbnB1dFN5c3RlbS5kaXNwb3NlKCl9fWNsYXNzIEZue2NvbnN0cnVjdG9yKGUpe2NvbnN0IHQ9T2JqZWN0LmtleXMoeikubGVuZ3RoLzI7dGhpcy5fZGV2aWNlcz1uZXcgQXJyYXkodCksdGhpcy5fZmlyc3REZXZpY2U9bmV3IEFycmF5KHQpLHRoaXMuX2VuZ2luZT1lLHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlcnx8KHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlcj1uZXcgRG4oZSkpLHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlci5fcmVmQ291bnQrKyx0aGlzLm9uRGV2aWNlQ29ubmVjdGVkT2JzZXJ2YWJsZT1uZXcgRihpPT57Zm9yKGNvbnN0IHMgb2YgdGhpcy5fZGV2aWNlcylpZihzKWZvcihjb25zdCByIG9mIHMpciYmdGhpcy5vbkRldmljZUNvbm5lY3RlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXIoaSxyKX0pLHRoaXMub25EZXZpY2VEaXNjb25uZWN0ZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2VuZ2luZS5fZGV2aWNlU291cmNlTWFuYWdlci5yZWdpc3Rlck1hbmFnZXIodGhpcyksdGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXI9ZS5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuZGlzcG9zZSgpfSl9Z2V0RGV2aWNlU291cmNlKGUsdCl7aWYodD09PXZvaWQgMCl7aWYodGhpcy5fZmlyc3REZXZpY2VbZV09PT12b2lkIDApcmV0dXJuIG51bGw7dD10aGlzLl9maXJzdERldmljZVtlXX1yZXR1cm4hdGhpcy5fZGV2aWNlc1tlXXx8dGhpcy5fZGV2aWNlc1tlXVt0XT09PXZvaWQgMD9udWxsOnRoaXMuX2RldmljZXNbZV1bdF19Z2V0RGV2aWNlU291cmNlcyhlKXtyZXR1cm4gdGhpcy5fZGV2aWNlc1tlXT90aGlzLl9kZXZpY2VzW2VdLmZpbHRlcih0PT4hIXQpOltdfWRpc3Bvc2UoKXt0aGlzLm9uRGV2aWNlQ29ubmVjdGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25EZXZpY2VEaXNjb25uZWN0ZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyJiYodGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLnVucmVnaXN0ZXJNYW5hZ2VyKHRoaXMpLC0tdGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLl9yZWZDb3VudDwxJiYodGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLmRpc3Bvc2UoKSxkZWxldGUgdGhpcy5fZW5naW5lLl9kZXZpY2VTb3VyY2VNYW5hZ2VyKSksdGhpcy5fZW5naW5lLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKX1fYWRkRGV2aWNlKGUpe3RoaXMuX2RldmljZXNbZS5kZXZpY2VUeXBlXXx8KHRoaXMuX2RldmljZXNbZS5kZXZpY2VUeXBlXT1uZXcgQXJyYXkpLHRoaXMuX2RldmljZXNbZS5kZXZpY2VUeXBlXVtlLmRldmljZVNsb3RdfHwodGhpcy5fZGV2aWNlc1tlLmRldmljZVR5cGVdW2UuZGV2aWNlU2xvdF09ZSx0aGlzLl91cGRhdGVGaXJzdERldmljZXMoZS5kZXZpY2VUeXBlKSksdGhpcy5vbkRldmljZUNvbm5lY3RlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpfV9yZW1vdmVEZXZpY2UoZSx0KXt2YXIgaSxzO2NvbnN0IHI9KGk9dGhpcy5fZGV2aWNlc1tlXSk9PT1udWxsfHxpPT09dm9pZCAwP3ZvaWQgMDppW3RdO3RoaXMub25EZXZpY2VEaXNjb25uZWN0ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKSwhKChzPXRoaXMuX2RldmljZXNbZV0pPT09bnVsbHx8cz09PXZvaWQgMCkmJnNbdF0mJmRlbGV0ZSB0aGlzLl9kZXZpY2VzW2VdW3RdLHRoaXMuX3VwZGF0ZUZpcnN0RGV2aWNlcyhlKX1fb25JbnB1dENoYW5nZWQoZSx0LGkpe3ZhciBzLHI7KHI9KHM9dGhpcy5fZGV2aWNlc1tlXSk9PT1udWxsfHxzPT09dm9pZCAwP3ZvaWQgMDpzW3RdKT09PW51bGx8fHI9PT12b2lkIDB8fHIub25JbnB1dENoYW5nZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhpKX1fdXBkYXRlRmlyc3REZXZpY2VzKGUpe3N3aXRjaChlKXtjYXNlIHouS2V5Ym9hcmQ6Y2FzZSB6Lk1vdXNlOnRoaXMuX2ZpcnN0RGV2aWNlW2VdPTA7YnJlYWs7Y2FzZSB6LlRvdWNoOmNhc2Ugei5EdWFsU2Vuc2U6Y2FzZSB6LkR1YWxTaG9jazpjYXNlIHouWGJveDpjYXNlIHouU3dpdGNoOmNhc2Ugei5HZW5lcmljOntkZWxldGUgdGhpcy5fZmlyc3REZXZpY2VbZV07Y29uc3QgdD10aGlzLl9kZXZpY2VzW2VdO2lmKHQpe2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7aSsrKWlmKHRbaV0pe3RoaXMuX2ZpcnN0RGV2aWNlW2VdPWk7YnJlYWt9fWJyZWFrfX19fWNsYXNzIHhye2NvbnN0cnVjdG9yKCl7dGhpcy5fc2luZ2xlQ2xpY2s9ITEsdGhpcy5fZG91YmxlQ2xpY2s9ITEsdGhpcy5faGFzU3dpcGVkPSExLHRoaXMuX2lnbm9yZT0hMX1nZXQgc2luZ2xlQ2xpY2soKXtyZXR1cm4gdGhpcy5fc2luZ2xlQ2xpY2t9Z2V0IGRvdWJsZUNsaWNrKCl7cmV0dXJuIHRoaXMuX2RvdWJsZUNsaWNrfWdldCBoYXNTd2lwZWQoKXtyZXR1cm4gdGhpcy5faGFzU3dpcGVkfWdldCBpZ25vcmUoKXtyZXR1cm4gdGhpcy5faWdub3JlfXNldCBzaW5nbGVDbGljayhlKXt0aGlzLl9zaW5nbGVDbGljaz1lfXNldCBkb3VibGVDbGljayhlKXt0aGlzLl9kb3VibGVDbGljaz1lfXNldCBoYXNTd2lwZWQoZSl7dGhpcy5faGFzU3dpcGVkPWV9c2V0IGlnbm9yZShlKXt0aGlzLl9pZ25vcmU9ZX19Y2xhc3MgRGV7Y29uc3RydWN0b3IoZSl7dGhpcy5fYWxyZWFkeUF0dGFjaGVkPSExLHRoaXMuX21lc2hQaWNrUHJvY2VlZD0hMSx0aGlzLl9jdXJyZW50UGlja1Jlc3VsdD1udWxsLHRoaXMuX3ByZXZpb3VzUGlja1Jlc3VsdD1udWxsLHRoaXMuX3RvdGFsUG9pbnRlcnNQcmVzc2VkPTAsdGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkPSExLHRoaXMuX2lzU3dpcGluZz0hMSx0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9LTEsdGhpcy5fc2tpcFBvaW50ZXJUYXA9ITEsdGhpcy5fcG9pbnRlclg9MCx0aGlzLl9wb2ludGVyWT0wLHRoaXMuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uPW5ldyB2ZSgwLDApLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyUG9zaXRpb249bmV3IHZlKDAsMCksdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuX3BvaW50ZXJDYXB0dXJlcz17fSx0aGlzLl9tZXNoVW5kZXJQb2ludGVySWQ9e30sdGhpcy5fbW92ZVBvaW50ZXJJbmZvPW51bGwsdGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudD0wLHRoaXMuX2RldmljZVNvdXJjZU1hbmFnZXI9bnVsbCx0aGlzLl9zY2VuZT1lfHxmZS5MYXN0Q3JlYXRlZFNjZW5lLHRoaXMuX3NjZW5lfWdldCBtZXNoVW5kZXJQb2ludGVyKCl7cmV0dXJuIHRoaXMuX21vdmVQb2ludGVySW5mbyYmKHRoaXMuX21vdmVQb2ludGVySW5mby5fZ2VuZXJhdGVQaWNrSW5mbygpLHRoaXMuX21vdmVQb2ludGVySW5mbz1udWxsKSx0aGlzLl9wb2ludGVyT3Zlck1lc2h9Z2V0TWVzaFVuZGVyUG9pbnRlckJ5UG9pbnRlcklkKGUpe3JldHVybiB0aGlzLl9tZXNoVW5kZXJQb2ludGVySWRbZV18fG51bGx9Z2V0IHVuVHJhbnNsYXRlZFBvaW50ZXIoKXtyZXR1cm4gbmV3IHZlKHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZKX1nZXQgcG9pbnRlclgoKXtyZXR1cm4gdGhpcy5fcG9pbnRlclh9c2V0IHBvaW50ZXJYKGUpe3RoaXMuX3BvaW50ZXJYPWV9Z2V0IHBvaW50ZXJZKCl7cmV0dXJuIHRoaXMuX3BvaW50ZXJZfXNldCBwb2ludGVyWShlKXt0aGlzLl9wb2ludGVyWT1lfV91cGRhdGVQb2ludGVyUG9zaXRpb24oZSl7Y29uc3QgdD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5nZXRJbnB1dEVsZW1lbnRDbGllbnRSZWN0KCk7dCYmKHRoaXMuX3BvaW50ZXJYPWUuY2xpZW50WC10LmxlZnQsdGhpcy5fcG9pbnRlclk9ZS5jbGllbnRZLXQudG9wLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYPXRoaXMuX3BvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZPXRoaXMuX3BvaW50ZXJZKX1fcHJvY2Vzc1BvaW50ZXJNb3ZlKGUsdCl7Y29uc3QgaT10aGlzLl9zY2VuZSxzPWkuZ2V0RW5naW5lKCkscj1zLmdldElucHV0RWxlbWVudCgpO3ImJihyLnRhYkluZGV4PXMuY2FudmFzVGFiSW5kZXgsaS5kb05vdEhhbmRsZUN1cnNvcnN8fChyLnN0eWxlLmN1cnNvcj1pLmRlZmF1bHRDdXJzb3IpKSx0aGlzLl9zZXRDdXJzb3JBbmRQb2ludGVyT3Zlck1lc2goZSx0LnBvaW50ZXJJZCxpKTtmb3IoY29uc3QgbyBvZiBpLl9wb2ludGVyTW92ZVN0YWdlKXtjb25zdCBoPSEhKGUhPW51bGwmJmUucGlja2VkTWVzaCk7ZT1vLmFjdGlvbih0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWCx0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWSxlLGgscil9Y29uc3Qgbj10LmlucHV0SW5kZXg+PVEuTW91c2VXaGVlbFgmJnQuaW5wdXRJbmRleDw9US5Nb3VzZVdoZWVsWj9UZS5QT0lOVEVSV0hFRUw6VGUuUE9JTlRFUk1PVkU7aS5vblBvaW50ZXJNb3ZlJiYoZT1lfHx0aGlzLl9waWNrTW92ZSh0LnBvaW50ZXJJZCksaS5vblBvaW50ZXJNb3ZlKHQsZSxuKSk7bGV0IGE7ZT8oYT1uZXcgdWkobix0LGUpLHRoaXMuX3NldFJheU9uUG9pbnRlckluZm8oZSx0KSk6KGE9bmV3IHVpKG4sdCxudWxsLHRoaXMpLHRoaXMuX21vdmVQb2ludGVySW5mbz1hKSxpLm9uUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJmkub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoYSxuKX1fc2V0UmF5T25Qb2ludGVySW5mbyhlLHQpe2NvbnN0IGk9dGhpcy5fc2NlbmU7ZSYmaS5fcGlja2luZ0F2YWlsYWJsZSYmKGUucmF5fHwoZS5yYXk9aS5jcmVhdGVQaWNraW5nUmF5KHQub2Zmc2V0WCx0Lm9mZnNldFkseC5JZGVudGl0eSgpLGkuYWN0aXZlQ2FtZXJhKSkpfV9hZGRDYW1lcmFQb2ludGVyT2JzZXJ2ZXIoZSx0KXtyZXR1cm4gdGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudCsrLHRoaXMuX3NjZW5lLm9uUG9pbnRlck9ic2VydmFibGUuYWRkKGUsdCl9X3JlbW92ZUNhbWVyYVBvaW50ZXJPYnNlcnZlcihlKXtyZXR1cm4gdGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudC0tLHRoaXMuX3NjZW5lLm9uUG9pbnRlck9ic2VydmFibGUucmVtb3ZlKGUpfV9jaGVja0ZvclBpY2tpbmcoKXtyZXR1cm4hISh0aGlzLl9zY2VuZS5vblBvaW50ZXJPYnNlcnZhYmxlLm9ic2VydmVycy5sZW5ndGg+dGhpcy5fY2FtZXJhT2JzZXJ2ZXJDb3VudHx8dGhpcy5fc2NlbmUub25Qb2ludGVyUGljayl9X2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUoZSx0LGkpe2NvbnN0IHM9dGhpcy5fc2NlbmUscj1uZXcgQ24oaSx0LHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZKTtyZXR1cm4gZSYmKHIub3JpZ2luYWxQaWNraW5nSW5mbz1lLHIucmF5PWUucmF5LGUub3JpZ2luTWVzaCYmKHIubmVhckludGVyYWN0aW9uUGlja2luZ0luZm89ZSkpLHMub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMocixpKSwhIXIuc2tpcE9uUG9pbnRlck9ic2VydmFibGV9X3BpY2tNb3ZlKGUpe2NvbnN0IHQ9dGhpcy5fc2NlbmUsaT10LnBpY2sodGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclksdC5wb2ludGVyTW92ZVByZWRpY2F0ZSwhMSx0LmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMsdC5wb2ludGVyTW92ZVRyaWFuZ2xlUHJlZGljYXRlKTtyZXR1cm4gdGhpcy5fc2V0Q3Vyc29yQW5kUG9pbnRlck92ZXJNZXNoKGksZSx0KSxpfV9zZXRDdXJzb3JBbmRQb2ludGVyT3Zlck1lc2goZSx0LGkpe2NvbnN0IHI9aS5nZXRFbmdpbmUoKS5nZXRJbnB1dEVsZW1lbnQoKTtpZihlIT1udWxsJiZlLnBpY2tlZE1lc2gpe2lmKHRoaXMuc2V0UG9pbnRlck92ZXJNZXNoKGUucGlja2VkTWVzaCx0LGUpLCFpLmRvTm90SGFuZGxlQ3Vyc29ycyYmciYmdGhpcy5fcG9pbnRlck92ZXJNZXNoKXtjb25zdCBuPXRoaXMuX3BvaW50ZXJPdmVyTWVzaC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoKTtuJiZuLmhhc1BvaW50ZXJUcmlnZ2VycyYmKHIuc3R5bGUuY3Vyc29yPW4uaG92ZXJDdXJzb3J8fGkuaG92ZXJDdXJzb3IpfX1lbHNlIHRoaXMuc2V0UG9pbnRlck92ZXJNZXNoKG51bGwsdCxlKX1zaW11bGF0ZVBvaW50ZXJNb3ZlKGUsdCl7Y29uc3QgaT1uZXcgUG9pbnRlckV2ZW50KCJwb2ludGVybW92ZSIsdCk7aS5pbnB1dEluZGV4PVEuTW92ZSwhdGhpcy5fY2hlY2tQcmVQb2ludGVyT2JzZXJ2YWJsZShlLGksVGUuUE9JTlRFUk1PVkUpJiZ0aGlzLl9wcm9jZXNzUG9pbnRlck1vdmUoZSxpKX1zaW11bGF0ZVBvaW50ZXJEb3duKGUsdCl7Y29uc3QgaT1uZXcgUG9pbnRlckV2ZW50KCJwb2ludGVyZG93biIsdCk7aS5pbnB1dEluZGV4PWkuYnV0dG9uKzIsIXRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUoZSxpLFRlLlBPSU5URVJET1dOKSYmdGhpcy5fcHJvY2Vzc1BvaW50ZXJEb3duKGUsaSl9X3Byb2Nlc3NQb2ludGVyRG93bihlLHQpe2NvbnN0IGk9dGhpcy5fc2NlbmU7aWYoZSE9bnVsbCYmZS5waWNrZWRNZXNoKXt0aGlzLl9waWNrZWREb3duTWVzaD1lLnBpY2tlZE1lc2g7Y29uc3Qgbj1lLnBpY2tlZE1lc2guX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKCk7aWYobil7aWYobi5oYXNQaWNrVHJpZ2dlcnMpc3dpdGNoKG4ucHJvY2Vzc1RyaWdnZXIoNSxWZS5DcmVhdGVOZXcoZS5waWNrZWRNZXNoLHQpKSx0LmJ1dHRvbil7Y2FzZSAwOm4ucHJvY2Vzc1RyaWdnZXIoMixWZS5DcmVhdGVOZXcoZS5waWNrZWRNZXNoLHQpKTticmVhaztjYXNlIDE6bi5wcm9jZXNzVHJpZ2dlcig0LFZlLkNyZWF0ZU5ldyhlLnBpY2tlZE1lc2gsdCkpO2JyZWFrO2Nhc2UgMjpuLnByb2Nlc3NUcmlnZ2VyKDMsVmUuQ3JlYXRlTmV3KGUucGlja2VkTWVzaCx0KSk7YnJlYWt9bi5oYXNTcGVjaWZpY1RyaWdnZXIoOCkmJndpbmRvdy5zZXRUaW1lb3V0KCgpPT57Y29uc3QgYT1pLnBpY2sodGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclksbz0+by5pc1BpY2thYmxlJiZvLmlzVmlzaWJsZSYmby5pc1JlYWR5KCkmJm8uYWN0aW9uTWFuYWdlciYmby5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcig4KSYmbz09PXRoaXMuX3BpY2tlZERvd25NZXNoLCExLGkuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyk7YSE9bnVsbCYmYS5waWNrZWRNZXNoJiZuJiZ0aGlzLl90b3RhbFBvaW50ZXJzUHJlc3NlZCE9PTAmJkRhdGUubm93KCktdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT5EZS5Mb25nUHJlc3NEZWxheSYmIXRoaXMuX2lzUG9pbnRlclN3aXBpbmcoKSYmKHRoaXMuX3N0YXJ0aW5nUG9pbnRlclRpbWU9MCxuLnByb2Nlc3NUcmlnZ2VyKDgsVmUuQ3JlYXRlTmV3KGEucGlja2VkTWVzaCx0KSkpfSxEZS5Mb25nUHJlc3NEZWxheSl9fWVsc2UgZm9yKGNvbnN0IG4gb2YgaS5fcG9pbnRlckRvd25TdGFnZSllPW4uYWN0aW9uKHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJYLHRoaXMuX3VuVHJhbnNsYXRlZFBvaW50ZXJZLGUsdCwhMSk7bGV0IHM7Y29uc3Qgcj1UZS5QT0lOVEVSRE9XTjtlPyhpLm9uUG9pbnRlckRvd24mJmkub25Qb2ludGVyRG93bih0LGUscikscz1uZXcgdWkocix0LGUpLHRoaXMuX3NldFJheU9uUG9pbnRlckluZm8oZSx0KSk6cz1uZXcgdWkocix0LG51bGwsdGhpcyksaS5vblBvaW50ZXJPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZpLm9uUG9pbnRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHMscil9X2lzUG9pbnRlclN3aXBpbmcoKXtyZXR1cm4gdGhpcy5faXNTd2lwaW5nfXNpbXVsYXRlUG9pbnRlclVwKGUsdCxpKXtjb25zdCBzPW5ldyBQb2ludGVyRXZlbnQoInBvaW50ZXJ1cCIsdCk7cy5pbnB1dEluZGV4PVEuTW92ZTtjb25zdCByPW5ldyB4cjtpP3IuZG91YmxlQ2xpY2s9ITA6ci5zaW5nbGVDbGljaz0hMCwhdGhpcy5fY2hlY2tQcmVQb2ludGVyT2JzZXJ2YWJsZShlLHMsVGUuUE9JTlRFUlVQKSYmdGhpcy5fcHJvY2Vzc1BvaW50ZXJVcChlLHMscil9X3Byb2Nlc3NQb2ludGVyVXAoZSx0LGkpe2NvbnN0IHM9dGhpcy5fc2NlbmU7aWYoZSE9bnVsbCYmZS5waWNrZWRNZXNoKXtpZih0aGlzLl9waWNrZWRVcE1lc2g9ZS5waWNrZWRNZXNoLHRoaXMuX3BpY2tlZERvd25NZXNoPT09dGhpcy5fcGlja2VkVXBNZXNoJiYocy5vblBvaW50ZXJQaWNrJiZzLm9uUG9pbnRlclBpY2sodCxlKSxpLnNpbmdsZUNsaWNrJiYhaS5pZ25vcmUmJnMub25Qb2ludGVyT2JzZXJ2YWJsZS5vYnNlcnZlcnMubGVuZ3RoPnRoaXMuX2NhbWVyYU9ic2VydmVyQ291bnQpKXtjb25zdCBuPVRlLlBPSU5URVJQSUNLLGE9bmV3IHVpKG4sdCxlKTt0aGlzLl9zZXRSYXlPblBvaW50ZXJJbmZvKGUsdCkscy5vblBvaW50ZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhhLG4pfWNvbnN0IHI9ZS5waWNrZWRNZXNoLl9nZXRBY3Rpb25NYW5hZ2VyRm9yVHJpZ2dlcigpO2lmKHImJiFpLmlnbm9yZSl7ci5wcm9jZXNzVHJpZ2dlcig3LFZlLkNyZWF0ZU5ldyhlLnBpY2tlZE1lc2gsdCxlKSksIWkuaGFzU3dpcGVkJiZpLnNpbmdsZUNsaWNrJiZyLnByb2Nlc3NUcmlnZ2VyKDEsVmUuQ3JlYXRlTmV3KGUucGlja2VkTWVzaCx0LGUpKTtjb25zdCBuPWUucGlja2VkTWVzaC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoNik7aS5kb3VibGVDbGljayYmbiYmbi5wcm9jZXNzVHJpZ2dlcig2LFZlLkNyZWF0ZU5ldyhlLnBpY2tlZE1lc2gsdCxlKSl9fWVsc2UgaWYoIWkuaWdub3JlKWZvcihjb25zdCByIG9mIHMuX3BvaW50ZXJVcFN0YWdlKWU9ci5hY3Rpb24odGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclgsdGhpcy5fdW5UcmFuc2xhdGVkUG9pbnRlclksZSx0LGkuZG91YmxlQ2xpY2spO2lmKHRoaXMuX3BpY2tlZERvd25NZXNoJiZ0aGlzLl9waWNrZWREb3duTWVzaCE9PXRoaXMuX3BpY2tlZFVwTWVzaCl7Y29uc3Qgcj10aGlzLl9waWNrZWREb3duTWVzaC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoMTYpO3ImJnIucHJvY2Vzc1RyaWdnZXIoMTYsVmUuQ3JlYXRlTmV3KHRoaXMuX3BpY2tlZERvd25NZXNoLHQpKX1pZighaS5pZ25vcmUpe2NvbnN0IHI9bmV3IHVpKFRlLlBPSU5URVJVUCx0LGUpO2lmKHRoaXMuX3NldFJheU9uUG9pbnRlckluZm8oZSx0KSxzLm9uUG9pbnRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHIsVGUuUE9JTlRFUlVQKSxzLm9uUG9pbnRlclVwJiZzLm9uUG9pbnRlclVwKHQsZSxUZS5QT0lOVEVSVVApLCFpLmhhc1N3aXBlZCYmIXRoaXMuX3NraXBQb2ludGVyVGFwKXtsZXQgbj0wO2lmKGkuc2luZ2xlQ2xpY2s/bj1UZS5QT0lOVEVSVEFQOmkuZG91YmxlQ2xpY2smJihuPVRlLlBPSU5URVJET1VCTEVUQVApLG4pe2NvbnN0IGE9bmV3IHVpKG4sdCxlKTtzLm9uUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJnMub25Qb2ludGVyT2JzZXJ2YWJsZS5oYXNTcGVjaWZpY01hc2sobikmJnMub25Qb2ludGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoYSxuKX19fX1pc1BvaW50ZXJDYXB0dXJlZChlPTApe3JldHVybiB0aGlzLl9wb2ludGVyQ2FwdHVyZXNbZV19YXR0YWNoQ29udHJvbChlPSEwLHQ9ITAsaT0hMCxzPW51bGwpe2NvbnN0IHI9dGhpcy5fc2NlbmUsbj1yLmdldEVuZ2luZSgpO3N8fChzPW4uZ2V0SW5wdXRFbGVtZW50KCkpLHRoaXMuX2FscmVhZHlBdHRhY2hlZCYmdGhpcy5kZXRhY2hDb250cm9sKCkscyYmKHRoaXMuX2FscmVhZHlBdHRhY2hlZFRvPXMpLHRoaXMuX2RldmljZVNvdXJjZU1hbmFnZXI9bmV3IEZuKG4pLHRoaXMuX2luaXRBY3Rpb25NYW5hZ2VyPWE9PntpZighdGhpcy5fbWVzaFBpY2tQcm9jZWVkKXtjb25zdCBvPXIuc2tpcFBvaW50ZXJVcFBpY2tpbmd8fHIuX3JlZ2lzdGVyZWRBY3Rpb25zPT09MCYmIXRoaXMuX2NoZWNrRm9yUGlja2luZygpJiYhci5vblBvaW50ZXJVcD9udWxsOnIucGljayh0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWCx0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWSxyLnBvaW50ZXJVcFByZWRpY2F0ZSwhMSxyLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnMpO3RoaXMuX2N1cnJlbnRQaWNrUmVzdWx0PW8sbyYmKGE9by5oaXQmJm8ucGlja2VkTWVzaD9vLnBpY2tlZE1lc2guX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKCk6bnVsbCksdGhpcy5fbWVzaFBpY2tQcm9jZWVkPSEwfXJldHVybiBhfSx0aGlzLl9kZWxheWVkU2ltcGxlQ2xpY2s9KGEsbyxoKT0+eyhEYXRlLm5vdygpLXRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT5EZS5Eb3VibGVDbGlja0RlbGF5JiYhdGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkfHxhIT09dGhpcy5fcHJldmlvdXNCdXR0b25QcmVzc2VkKSYmKHRoaXMuX2RvdWJsZUNsaWNrT2NjdXJlZD0hMSxvLnNpbmdsZUNsaWNrPSEwLG8uaWdub3JlPSExLGgobyx0aGlzLl9jdXJyZW50UGlja1Jlc3VsdCkpfSx0aGlzLl9pbml0Q2xpY2tFdmVudD0oYSxvLGgsbCk9Pntjb25zdCB1PW5ldyB4cjt0aGlzLl9jdXJyZW50UGlja1Jlc3VsdD1udWxsO2xldCBkPW51bGwsZj1hLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSUElDSyl8fG8uaGFzU3BlY2lmaWNNYXNrKFRlLlBPSU5URVJQSUNLKXx8YS5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUlRBUCl8fG8uaGFzU3BlY2lmaWNNYXNrKFRlLlBPSU5URVJUQVApfHxhLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSRE9VQkxFVEFQKXx8by5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUkRPVUJMRVRBUCk7IWYmJnV0JiYoZD10aGlzLl9pbml0QWN0aW9uTWFuYWdlcihkLHUpLGQmJihmPWQuaGFzUGlja1RyaWdnZXJzKSk7bGV0IF89ITE7aWYoZil7Y29uc3QgRT1oLmJ1dHRvbjtpZih1Lmhhc1N3aXBlZD10aGlzLl9pc1BvaW50ZXJTd2lwaW5nKCksIXUuaGFzU3dpcGVkKXtsZXQgbT0hRGUuRXhjbHVzaXZlRG91YmxlQ2xpY2tNb2RlO218fChtPSFhLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSRE9VQkxFVEFQKSYmIW8uaGFzU3BlY2lmaWNNYXNrKFRlLlBPSU5URVJET1VCTEVUQVApLG0mJiF1dC5IYXNTcGVjaWZpY1RyaWdnZXIoNikmJihkPXRoaXMuX2luaXRBY3Rpb25NYW5hZ2VyKGQsdSksZCYmKG09IWQuaGFzU3BlY2lmaWNUcmlnZ2VyKDYpKSkpLG0/KERhdGUubm93KCktdGhpcy5fcHJldmlvdXNTdGFydGluZ1BvaW50ZXJUaW1lPkRlLkRvdWJsZUNsaWNrRGVsYXl8fEUhPT10aGlzLl9wcmV2aW91c0J1dHRvblByZXNzZWQpJiYodS5zaW5nbGVDbGljaz0hMCxsKHUsdGhpcy5fY3VycmVudFBpY2tSZXN1bHQpLF89ITApOih0aGlzLl9wcmV2aW91c0RlbGF5ZWRTaW1wbGVDbGlja1RpbWVvdXQ9dGhpcy5fZGVsYXllZFNpbXBsZUNsaWNrVGltZW91dCx0aGlzLl9kZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0PXdpbmRvdy5zZXRUaW1lb3V0KHRoaXMuX2RlbGF5ZWRTaW1wbGVDbGljay5iaW5kKHRoaXMsRSx1LGwpLERlLkRvdWJsZUNsaWNrRGVsYXkpKTtsZXQgdj1hLmhhc1NwZWNpZmljTWFzayhUZS5QT0lOVEVSRE9VQkxFVEFQKXx8by5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUkRPVUJMRVRBUCk7IXYmJnV0Lkhhc1NwZWNpZmljVHJpZ2dlcig2KSYmKGQ9dGhpcy5faW5pdEFjdGlvbk1hbmFnZXIoZCx1KSxkJiYodj1kLmhhc1NwZWNpZmljVHJpZ2dlcig2KSkpLHYmJihFPT09dGhpcy5fcHJldmlvdXNCdXR0b25QcmVzc2VkJiZEYXRlLm5vdygpLXRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZTxEZS5Eb3VibGVDbGlja0RlbGF5JiYhdGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkPyghdS5oYXNTd2lwZWQmJiF0aGlzLl9pc1BvaW50ZXJTd2lwaW5nKCk/KHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT0wLHRoaXMuX2RvdWJsZUNsaWNrT2NjdXJlZD0hMCx1LmRvdWJsZUNsaWNrPSEwLHUuaWdub3JlPSExLERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZSYmdGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0JiZjbGVhclRpbWVvdXQodGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0KSx0aGlzLl9wcmV2aW91c0RlbGF5ZWRTaW1wbGVDbGlja1RpbWVvdXQ9dGhpcy5fZGVsYXllZFNpbXBsZUNsaWNrVGltZW91dCxsKHUsdGhpcy5fY3VycmVudFBpY2tSZXN1bHQpKToodGhpcy5fZG91YmxlQ2xpY2tPY2N1cmVkPSExLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyVGltZT10aGlzLl9zdGFydGluZ1BvaW50ZXJUaW1lLHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueD10aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54LHRoaXMuX3ByZXZpb3VzU3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueT10aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi55LHRoaXMuX3ByZXZpb3VzQnV0dG9uUHJlc3NlZD1FLERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZT8odGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0JiZjbGVhclRpbWVvdXQodGhpcy5fcHJldmlvdXNEZWxheWVkU2ltcGxlQ2xpY2tUaW1lb3V0KSx0aGlzLl9wcmV2aW91c0RlbGF5ZWRTaW1wbGVDbGlja1RpbWVvdXQ9dGhpcy5fZGVsYXllZFNpbXBsZUNsaWNrVGltZW91dCxsKHUsdGhpcy5fcHJldmlvdXNQaWNrUmVzdWx0KSk6bCh1LHRoaXMuX2N1cnJlbnRQaWNrUmVzdWx0KSksXz0hMCk6KHRoaXMuX2RvdWJsZUNsaWNrT2NjdXJlZD0hMSx0aGlzLl9wcmV2aW91c1N0YXJ0aW5nUG9pbnRlclRpbWU9dGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZSx0aGlzLl9wcmV2aW91c1N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLng9dGhpcy5fc3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueCx0aGlzLl9wcmV2aW91c1N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnk9dGhpcy5fc3RhcnRpbmdQb2ludGVyUG9zaXRpb24ueSx0aGlzLl9wcmV2aW91c0J1dHRvblByZXNzZWQ9RSkpfX1ffHxsKHUsdGhpcy5fY3VycmVudFBpY2tSZXN1bHQpfSx0aGlzLl9vblBvaW50ZXJNb3ZlPWE9PntpZihhLnBvaW50ZXJJZD09PXZvaWQgMCYmKGEucG9pbnRlcklkPTApLHRoaXMuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihhKSwhdGhpcy5faXNTd2lwaW5nJiZ0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQhPT0tMSYmKHRoaXMuX2lzU3dpcGluZz1NYXRoLmFicyh0aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54LXRoaXMuX3BvaW50ZXJYKT5EZS5EcmFnTW92ZW1lbnRUaHJlc2hvbGR8fE1hdGguYWJzKHRoaXMuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnktdGhpcy5fcG9pbnRlclkpPkRlLkRyYWdNb3ZlbWVudFRocmVzaG9sZCksdGhpcy5fY2hlY2tQcmVQb2ludGVyT2JzZXJ2YWJsZShudWxsLGEsYS5pbnB1dEluZGV4Pj1RLk1vdXNlV2hlZWxYJiZhLmlucHV0SW5kZXg8PVEuTW91c2VXaGVlbFo/VGUuUE9JTlRFUldIRUVMOlRlLlBPSU5URVJNT1ZFKXx8IXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyYmIXIuYWN0aXZlQ2FtZXJhKXJldHVybjtpZihyLnNraXBQb2ludGVyTW92ZVBpY2tpbmcpe3RoaXMuX3Byb2Nlc3NQb2ludGVyTW92ZShuZXcgVXQsYSk7cmV0dXJufXIucG9pbnRlck1vdmVQcmVkaWNhdGV8fChyLnBvaW50ZXJNb3ZlUHJlZGljYXRlPWg9PmguaXNQaWNrYWJsZSYmaC5pc1Zpc2libGUmJmguaXNSZWFkeSgpJiZoLmlzRW5hYmxlZCgpJiYoaC5lbmFibGVQb2ludGVyTW92ZUV2ZW50c3x8ci5jb25zdGFudGx5VXBkYXRlTWVzaFVuZGVyUG9pbnRlcnx8aC5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoKSE9PW51bGwpJiYoIXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8KHIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycy5sYXllck1hc2smaC5sYXllck1hc2spIT09MCkpO2NvbnN0IG89ci5fcmVnaXN0ZXJlZEFjdGlvbnM+MD90aGlzLl9waWNrTW92ZShhLnBvaW50ZXJJZCk6bnVsbDt0aGlzLl9wcm9jZXNzUG9pbnRlck1vdmUobyxhKX0sdGhpcy5fb25Qb2ludGVyRG93bj1hPT57aWYodGhpcy5fdG90YWxQb2ludGVyc1ByZXNzZWQrKyx0aGlzLl9waWNrZWREb3duTWVzaD1udWxsLHRoaXMuX21lc2hQaWNrUHJvY2VlZD0hMSxhLnBvaW50ZXJJZD09PXZvaWQgMCYmKGEucG9pbnRlcklkPTApLHRoaXMuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihhKSx0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9PT0tMSYmKHRoaXMuX3N3aXBlQnV0dG9uUHJlc3NlZD1hLmJ1dHRvbiksci5wcmV2ZW50RGVmYXVsdE9uUG9pbnRlckRvd24mJnMmJihhLnByZXZlbnREZWZhdWx0KCkscy5mb2N1cygpKSx0aGlzLl9zdGFydGluZ1BvaW50ZXJQb3NpdGlvbi54PXRoaXMuX3BvaW50ZXJYLHRoaXMuX3N0YXJ0aW5nUG9pbnRlclBvc2l0aW9uLnk9dGhpcy5fcG9pbnRlclksdGhpcy5fc3RhcnRpbmdQb2ludGVyVGltZT1EYXRlLm5vdygpLHRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUobnVsbCxhLFRlLlBPSU5URVJET1dOKXx8IXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyYmIXIuYWN0aXZlQ2FtZXJhKXJldHVybjt0aGlzLl9wb2ludGVyQ2FwdHVyZXNbYS5wb2ludGVySWRdPSEwLHIucG9pbnRlckRvd25QcmVkaWNhdGV8fChyLnBvaW50ZXJEb3duUHJlZGljYXRlPWg9PmguaXNQaWNrYWJsZSYmaC5pc1Zpc2libGUmJmguaXNSZWFkeSgpJiZoLmlzRW5hYmxlZCgpJiYoIXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVyc3x8KHIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycy5sYXllck1hc2smaC5sYXllck1hc2spIT09MCkpLHRoaXMuX3BpY2tlZERvd25NZXNoPW51bGw7bGV0IG87ci5za2lwUG9pbnRlckRvd25QaWNraW5nfHxyLl9yZWdpc3RlcmVkQWN0aW9ucz09PTAmJiF0aGlzLl9jaGVja0ZvclBpY2tpbmcoKSYmIXIub25Qb2ludGVyRG93bj9vPW5ldyBVdDpvPXIucGljayh0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWCx0aGlzLl91blRyYW5zbGF0ZWRQb2ludGVyWSxyLnBvaW50ZXJEb3duUHJlZGljYXRlLCExLHIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyksdGhpcy5fcHJvY2Vzc1BvaW50ZXJEb3duKG8sYSl9LHRoaXMuX29uUG9pbnRlclVwPWE9Pnt0aGlzLl90b3RhbFBvaW50ZXJzUHJlc3NlZCE9PTAmJih0aGlzLl90b3RhbFBvaW50ZXJzUHJlc3NlZC0tLHRoaXMuX3BpY2tlZFVwTWVzaD1udWxsLHRoaXMuX21lc2hQaWNrUHJvY2VlZD0hMSxhLnBvaW50ZXJJZD09PXZvaWQgMCYmKGEucG9pbnRlcklkPTApLHRoaXMuX3VwZGF0ZVBvaW50ZXJQb3NpdGlvbihhKSxyLnByZXZlbnREZWZhdWx0T25Qb2ludGVyVXAmJnMmJihhLnByZXZlbnREZWZhdWx0KCkscy5mb2N1cygpKSx0aGlzLl9pbml0Q2xpY2tFdmVudChyLm9uUHJlUG9pbnRlck9ic2VydmFibGUsci5vblBvaW50ZXJPYnNlcnZhYmxlLGEsKG8saCk9PntpZihyLm9uUHJlUG9pbnRlck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJih0aGlzLl9za2lwUG9pbnRlclRhcD0hMSwhby5pZ25vcmUpKXtpZih0aGlzLl9jaGVja1ByZVBvaW50ZXJPYnNlcnZhYmxlKG51bGwsYSxUZS5QT0lOVEVSVVApKXt0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9PT1hLmJ1dHRvbiYmKHRoaXMuX2lzU3dpcGluZz0hMSx0aGlzLl9zd2lwZUJ1dHRvblByZXNzZWQ9LTEpO3JldHVybn1vLmhhc1N3aXBlZHx8KG8uc2luZ2xlQ2xpY2smJnIub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUlRBUCkmJnRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUobnVsbCxhLFRlLlBPSU5URVJUQVApJiYodGhpcy5fc2tpcFBvaW50ZXJUYXA9ITApLG8uZG91YmxlQ2xpY2smJnIub25QcmVQb2ludGVyT2JzZXJ2YWJsZS5oYXNTcGVjaWZpY01hc2soVGUuUE9JTlRFUkRPVUJMRVRBUCkmJnRoaXMuX2NoZWNrUHJlUG9pbnRlck9ic2VydmFibGUobnVsbCxhLFRlLlBPSU5URVJET1VCTEVUQVApJiYodGhpcy5fc2tpcFBvaW50ZXJUYXA9ITApKX10aGlzLl9wb2ludGVyQ2FwdHVyZXNbYS5wb2ludGVySWRdPSExLCEoIXIuY2FtZXJhVG9Vc2VGb3JQb2ludGVycyYmIXIuYWN0aXZlQ2FtZXJhKSYmKHIucG9pbnRlclVwUHJlZGljYXRlfHwoci5wb2ludGVyVXBQcmVkaWNhdGU9bD0+bC5pc1BpY2thYmxlJiZsLmlzVmlzaWJsZSYmbC5pc1JlYWR5KCkmJmwuaXNFbmFibGVkKCkmJighci5jYW1lcmFUb1VzZUZvclBvaW50ZXJzfHwoci5jYW1lcmFUb1VzZUZvclBvaW50ZXJzLmxheWVyTWFzayZsLmxheWVyTWFzaykhPT0wKSksIXRoaXMuX21lc2hQaWNrUHJvY2VlZCYmKHV0JiZ1dC5IYXNUcmlnZ2Vyc3x8dGhpcy5fY2hlY2tGb3JQaWNraW5nKCl8fHIub25Qb2ludGVyVXApJiZ0aGlzLl9pbml0QWN0aW9uTWFuYWdlcihudWxsLG8pLGh8fChoPXRoaXMuX2N1cnJlbnRQaWNrUmVzdWx0KSx0aGlzLl9wcm9jZXNzUG9pbnRlclVwKGgsYSxvKSx0aGlzLl9wcmV2aW91c1BpY2tSZXN1bHQ9dGhpcy5fY3VycmVudFBpY2tSZXN1bHQsdGhpcy5fc3dpcGVCdXR0b25QcmVzc2VkPT09YS5idXR0b24mJih0aGlzLl9pc1N3aXBpbmc9ITEsdGhpcy5fc3dpcGVCdXR0b25QcmVzc2VkPS0xKSl9KSl9LHRoaXMuX29uS2V5RG93bj1hPT57Y29uc3Qgbz1KaS5LRVlET1dOO2lmKHIub25QcmVLZXlib2FyZE9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpe2NvbnN0IGg9bmV3IF9yKG8sYSk7aWYoci5vblByZUtleWJvYXJkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoaCxvKSxoLnNraXBPbktleWJvYXJkT2JzZXJ2YWJsZSlyZXR1cm59aWYoci5vbktleWJvYXJkT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKSl7Y29uc3QgaD1uZXcgQ3MobyxhKTtyLm9uS2V5Ym9hcmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhoLG8pfXIuYWN0aW9uTWFuYWdlciYmci5hY3Rpb25NYW5hZ2VyLnByb2Nlc3NUcmlnZ2VyKDE0LFZlLkNyZWF0ZU5ld0Zyb21TY2VuZShyLGEpKX0sdGhpcy5fb25LZXlVcD1hPT57Y29uc3Qgbz1KaS5LRVlVUDtpZihyLm9uUHJlS2V5Ym9hcmRPYnNlcnZhYmxlLmhhc09ic2VydmVycygpKXtjb25zdCBoPW5ldyBfcihvLGEpO2lmKHIub25QcmVLZXlib2FyZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGgsbyksaC5za2lwT25LZXlib2FyZE9ic2VydmFibGUpcmV0dXJufWlmKHIub25LZXlib2FyZE9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkpe2NvbnN0IGg9bmV3IENzKG8sYSk7ci5vbktleWJvYXJkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoaCxvKX1yLmFjdGlvbk1hbmFnZXImJnIuYWN0aW9uTWFuYWdlci5wcm9jZXNzVHJpZ2dlcigxNSxWZS5DcmVhdGVOZXdGcm9tU2NlbmUocixhKSl9LHRoaXMuX2RldmljZVNvdXJjZU1hbmFnZXIub25EZXZpY2VDb25uZWN0ZWRPYnNlcnZhYmxlLmFkZChhPT57YS5kZXZpY2VUeXBlPT09ei5Nb3VzZT9hLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQobz0+e28uaW5wdXRJbmRleD09PVEuTGVmdENsaWNrfHxvLmlucHV0SW5kZXg9PT1RLk1pZGRsZUNsaWNrfHxvLmlucHV0SW5kZXg9PT1RLlJpZ2h0Q2xpY2t8fG8uaW5wdXRJbmRleD09PVEuQnJvd3NlckJhY2t8fG8uaW5wdXRJbmRleD09PVEuQnJvd3NlckZvcndhcmQ/dCYmYS5nZXRJbnB1dChvLmlucHV0SW5kZXgpPT09MT90aGlzLl9vblBvaW50ZXJEb3duKG8pOmUmJmEuZ2V0SW5wdXQoby5pbnB1dEluZGV4KT09PTAmJnRoaXMuX29uUG9pbnRlclVwKG8pOmkmJihvLmlucHV0SW5kZXg9PT1RLk1vdmU/dGhpcy5fb25Qb2ludGVyTW92ZShvKTooby5pbnB1dEluZGV4PT09US5Nb3VzZVdoZWVsWHx8by5pbnB1dEluZGV4PT09US5Nb3VzZVdoZWVsWXx8by5pbnB1dEluZGV4PT09US5Nb3VzZVdoZWVsWikmJnRoaXMuX29uUG9pbnRlck1vdmUobykpfSk6YS5kZXZpY2VUeXBlPT09ei5Ub3VjaD9hLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQobz0+e28uaW5wdXRJbmRleD09PVEuTGVmdENsaWNrJiYodCYmYS5nZXRJbnB1dChvLmlucHV0SW5kZXgpPT09MT90aGlzLl9vblBvaW50ZXJEb3duKG8pOmUmJmEuZ2V0SW5wdXQoby5pbnB1dEluZGV4KT09PTAmJnRoaXMuX29uUG9pbnRlclVwKG8pKSxpJiZvLmlucHV0SW5kZXg9PT1RLk1vdmUmJnRoaXMuX29uUG9pbnRlck1vdmUobyl9KTphLmRldmljZVR5cGU9PT16LktleWJvYXJkJiZhLm9uSW5wdXRDaGFuZ2VkT2JzZXJ2YWJsZS5hZGQobz0+e28udHlwZT09PSJrZXlkb3duIj90aGlzLl9vbktleURvd24obyk6by50eXBlPT09ImtleXVwIiYmdGhpcy5fb25LZXlVcChvKX0pfSksdGhpcy5fYWxyZWFkeUF0dGFjaGVkPSEwfWRldGFjaENvbnRyb2woKXt0aGlzLl9hbHJlYWR5QXR0YWNoZWQmJih0aGlzLl9kZXZpY2VTb3VyY2VNYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLl9kZXZpY2VTb3VyY2VNYW5hZ2VyPW51bGwsdGhpcy5fYWxyZWFkeUF0dGFjaGVkVG8mJiF0aGlzLl9zY2VuZS5kb05vdEhhbmRsZUN1cnNvcnMmJih0aGlzLl9hbHJlYWR5QXR0YWNoZWRUby5zdHlsZS5jdXJzb3I9dGhpcy5fc2NlbmUuZGVmYXVsdEN1cnNvciksdGhpcy5fYWxyZWFkeUF0dGFjaGVkPSExLHRoaXMuX2FscmVhZHlBdHRhY2hlZFRvPW51bGwpfXNldFBvaW50ZXJPdmVyTWVzaChlLHQ9MCxpKXtpZih0aGlzLl9tZXNoVW5kZXJQb2ludGVySWRbdF09PT1lJiYoIWV8fCFlLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZykpcmV0dXJuO2NvbnN0IHM9dGhpcy5fbWVzaFVuZGVyUG9pbnRlcklkW3RdO2xldCByO3MmJihyPXMuX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKDEwKSxyJiZyLnByb2Nlc3NUcmlnZ2VyKDEwLFZlLkNyZWF0ZU5ldyhzLHZvaWQgMCx7cG9pbnRlcklkOnR9KSkpLGU/KHRoaXMuX21lc2hVbmRlclBvaW50ZXJJZFt0XT1lLHRoaXMuX3BvaW50ZXJPdmVyTWVzaD1lLHI9ZS5fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoOSksciYmci5wcm9jZXNzVHJpZ2dlcig5LFZlLkNyZWF0ZU5ldyhlLHZvaWQgMCx7cG9pbnRlcklkOnQscGlja1Jlc3VsdDppfSkpKTooZGVsZXRlIHRoaXMuX21lc2hVbmRlclBvaW50ZXJJZFt0XSx0aGlzLl9wb2ludGVyT3Zlck1lc2g9bnVsbCl9Z2V0UG9pbnRlck92ZXJNZXNoKCl7cmV0dXJuIHRoaXMubWVzaFVuZGVyUG9pbnRlcn1faW52YWxpZGF0ZU1lc2goZSl7dGhpcy5fcG9pbnRlck92ZXJNZXNoPT09ZSYmKHRoaXMuX3BvaW50ZXJPdmVyTWVzaD1udWxsKSx0aGlzLl9waWNrZWREb3duTWVzaD09PWUmJih0aGlzLl9waWNrZWREb3duTWVzaD1udWxsKSx0aGlzLl9waWNrZWRVcE1lc2g9PT1lJiYodGhpcy5fcGlja2VkVXBNZXNoPW51bGwpO2Zvcihjb25zdCB0IGluIHRoaXMuX21lc2hVbmRlclBvaW50ZXJJZCl0aGlzLl9tZXNoVW5kZXJQb2ludGVySWRbdF09PT1lJiZkZWxldGUgdGhpcy5fbWVzaFVuZGVyUG9pbnRlcklkW3RdfX1EZS5EcmFnTW92ZW1lbnRUaHJlc2hvbGQ9MTAsRGUuTG9uZ1ByZXNzRGVsYXk9NTAwLERlLkRvdWJsZUNsaWNrRGVsYXk9MzAwLERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZT0hMTtjbGFzcyB4dHtjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLm5vcm1hbD1uZXcgcChlLHQsaSksdGhpcy5kPXN9YXNBcnJheSgpe3JldHVyblt0aGlzLm5vcm1hbC54LHRoaXMubm9ybWFsLnksdGhpcy5ub3JtYWwueix0aGlzLmRdfWNsb25lKCl7cmV0dXJuIG5ldyB4dCh0aGlzLm5vcm1hbC54LHRoaXMubm9ybWFsLnksdGhpcy5ub3JtYWwueix0aGlzLmQpfWdldENsYXNzTmFtZSgpe3JldHVybiJQbGFuZSJ9Z2V0SGFzaENvZGUoKXtsZXQgZT10aGlzLm5vcm1hbC5nZXRIYXNoQ29kZSgpO3JldHVybiBlPWUqMzk3Xih0aGlzLmR8MCksZX1ub3JtYWxpemUoKXtjb25zdCBlPU1hdGguc3FydCh0aGlzLm5vcm1hbC54KnRoaXMubm9ybWFsLngrdGhpcy5ub3JtYWwueSp0aGlzLm5vcm1hbC55K3RoaXMubm9ybWFsLnoqdGhpcy5ub3JtYWwueik7bGV0IHQ9MDtyZXR1cm4gZSE9PTAmJih0PTEvZSksdGhpcy5ub3JtYWwueCo9dCx0aGlzLm5vcm1hbC55Kj10LHRoaXMubm9ybWFsLnoqPXQsdGhpcy5kKj10LHRoaXN9dHJhbnNmb3JtKGUpe2NvbnN0IHQ9eHQuX1RtcE1hdHJpeDtlLmludmVydFRvUmVmKHQpO2NvbnN0IGk9dC5tLHM9dGhpcy5ub3JtYWwueCxyPXRoaXMubm9ybWFsLnksbj10aGlzLm5vcm1hbC56LGE9dGhpcy5kLG89cyppWzBdK3IqaVsxXStuKmlbMl0rYSppWzNdLGg9cyppWzRdK3IqaVs1XStuKmlbNl0rYSppWzddLGw9cyppWzhdK3IqaVs5XStuKmlbMTBdK2EqaVsxMV0sdT1zKmlbMTJdK3IqaVsxM10rbippWzE0XSthKmlbMTVdO3JldHVybiBuZXcgeHQobyxoLGwsdSl9ZG90Q29vcmRpbmF0ZShlKXtyZXR1cm4gdGhpcy5ub3JtYWwueCplLngrdGhpcy5ub3JtYWwueSplLnkrdGhpcy5ub3JtYWwueiplLnordGhpcy5kfWNvcHlGcm9tUG9pbnRzKGUsdCxpKXtjb25zdCBzPXQueC1lLngscj10LnktZS55LG49dC56LWUueixhPWkueC1lLngsbz1pLnktZS55LGg9aS56LWUueixsPXIqaC1uKm8sdT1uKmEtcypoLGQ9cypvLXIqYSxmPU1hdGguc3FydChsKmwrdSp1K2QqZCk7bGV0IF87cmV0dXJuIGYhPT0wP189MS9mOl89MCx0aGlzLm5vcm1hbC54PWwqXyx0aGlzLm5vcm1hbC55PXUqXyx0aGlzLm5vcm1hbC56PWQqXyx0aGlzLmQ9LSh0aGlzLm5vcm1hbC54KmUueCt0aGlzLm5vcm1hbC55KmUueSt0aGlzLm5vcm1hbC56KmUueiksdGhpc31pc0Zyb250RmFjaW5nVG8oZSx0KXtyZXR1cm4gcC5Eb3QodGhpcy5ub3JtYWwsZSk8PXR9c2lnbmVkRGlzdGFuY2VUbyhlKXtyZXR1cm4gcC5Eb3QoZSx0aGlzLm5vcm1hbCkrdGhpcy5kfXN0YXRpYyBGcm9tQXJyYXkoZSl7cmV0dXJuIG5ldyB4dChlWzBdLGVbMV0sZVsyXSxlWzNdKX1zdGF0aWMgRnJvbVBvaW50cyhlLHQsaSl7Y29uc3Qgcz1uZXcgeHQoMCwwLDAsMCk7cmV0dXJuIHMuY29weUZyb21Qb2ludHMoZSx0LGkpLHN9c3RhdGljIEZyb21Qb3NpdGlvbkFuZE5vcm1hbChlLHQpe2NvbnN0IGk9bmV3IHh0KDAsMCwwLDApO3JldHVybiB0Lm5vcm1hbGl6ZSgpLGkubm9ybWFsPXQsaS5kPS0odC54KmUueCt0LnkqZS55K3QueiplLnopLGl9c3RhdGljIFNpZ25lZERpc3RhbmNlVG9QbGFuZUZyb21Qb3NpdGlvbkFuZE5vcm1hbChlLHQsaSl7Y29uc3Qgcz0tKHQueCplLngrdC55KmUueSt0LnoqZS56KTtyZXR1cm4gcC5Eb3QoaSx0KStzfX14dC5fVG1wTWF0cml4PXguSWRlbnRpdHkoKTtjbGFzcyBFdHtzdGF0aWMgR2V0UGxhbmVzKGUpe2NvbnN0IHQ9W107Zm9yKGxldCBpPTA7aTw2O2krKyl0LnB1c2gobmV3IHh0KDAsMCwwLDApKTtyZXR1cm4gRXQuR2V0UGxhbmVzVG9SZWYoZSx0KSx0fXN0YXRpYyBHZXROZWFyUGxhbmVUb1JlZihlLHQpe2NvbnN0IGk9ZS5tO3Qubm9ybWFsLng9aVszXStpWzJdLHQubm9ybWFsLnk9aVs3XStpWzZdLHQubm9ybWFsLno9aVsxMV0raVsxMF0sdC5kPWlbMTVdK2lbMTRdLHQubm9ybWFsaXplKCl9c3RhdGljIEdldEZhclBsYW5lVG9SZWYoZSx0KXtjb25zdCBpPWUubTt0Lm5vcm1hbC54PWlbM10taVsyXSx0Lm5vcm1hbC55PWlbN10taVs2XSx0Lm5vcm1hbC56PWlbMTFdLWlbMTBdLHQuZD1pWzE1XS1pWzE0XSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRMZWZ0UGxhbmVUb1JlZihlLHQpe2NvbnN0IGk9ZS5tO3Qubm9ybWFsLng9aVszXStpWzBdLHQubm9ybWFsLnk9aVs3XStpWzRdLHQubm9ybWFsLno9aVsxMV0raVs4XSx0LmQ9aVsxNV0raVsxMl0sdC5ub3JtYWxpemUoKX1zdGF0aWMgR2V0UmlnaHRQbGFuZVRvUmVmKGUsdCl7Y29uc3QgaT1lLm07dC5ub3JtYWwueD1pWzNdLWlbMF0sdC5ub3JtYWwueT1pWzddLWlbNF0sdC5ub3JtYWwuej1pWzExXS1pWzhdLHQuZD1pWzE1XS1pWzEyXSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRUb3BQbGFuZVRvUmVmKGUsdCl7Y29uc3QgaT1lLm07dC5ub3JtYWwueD1pWzNdLWlbMV0sdC5ub3JtYWwueT1pWzddLWlbNV0sdC5ub3JtYWwuej1pWzExXS1pWzldLHQuZD1pWzE1XS1pWzEzXSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRCb3R0b21QbGFuZVRvUmVmKGUsdCl7Y29uc3QgaT1lLm07dC5ub3JtYWwueD1pWzNdK2lbMV0sdC5ub3JtYWwueT1pWzddK2lbNV0sdC5ub3JtYWwuej1pWzExXStpWzldLHQuZD1pWzE1XStpWzEzXSx0Lm5vcm1hbGl6ZSgpfXN0YXRpYyBHZXRQbGFuZXNUb1JlZihlLHQpe0V0LkdldE5lYXJQbGFuZVRvUmVmKGUsdFswXSksRXQuR2V0RmFyUGxhbmVUb1JlZihlLHRbMV0pLEV0LkdldExlZnRQbGFuZVRvUmVmKGUsdFsyXSksRXQuR2V0UmlnaHRQbGFuZVRvUmVmKGUsdFszXSksRXQuR2V0VG9wUGxhbmVUb1JlZihlLHRbNF0pLEV0LkdldEJvdHRvbVBsYW5lVG9SZWYoZSx0WzVdKX19Y2xhc3MgTXJ7c3RhdGljIGdldCBVbmlxdWVJZCgpe2NvbnN0IGU9dGhpcy5fVW5pcXVlSWRDb3VudGVyO3JldHVybiB0aGlzLl9VbmlxdWVJZENvdW50ZXIrKyxlfX1Nci5fVW5pcXVlSWRDb3VudGVyPTE7Y2xhc3MgRWV7c3RhdGljIENvbXBhcmVMaWdodHNQcmlvcml0eShlLHQpe3JldHVybiBlLnNoYWRvd0VuYWJsZWQhPT10LnNoYWRvd0VuYWJsZWQ/KHQuc2hhZG93RW5hYmxlZD8xOjApLShlLnNoYWRvd0VuYWJsZWQ/MTowKTp0LnJlbmRlclByaW9yaXR5LWUucmVuZGVyUHJpb3JpdHl9fUVlLkZBTExPRkZfREVGQVVMVD0wLEVlLkZBTExPRkZfUEhZU0lDQUw9MSxFZS5GQUxMT0ZGX0dMVEY9MixFZS5GQUxMT0ZGX1NUQU5EQVJEPTMsRWUuTElHSFRNQVBfREVGQVVMVD0wLEVlLkxJR0hUTUFQX1NQRUNVTEFSPTEsRWUuTElHSFRNQVBfU0hBRE9XU09OTFk9MixFZS5JTlRFTlNJVFlNT0RFX0FVVE9NQVRJQz0wLEVlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNQT1dFUj0xLEVlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNJTlRFTlNJVFk9MixFZS5JTlRFTlNJVFlNT0RFX0lMTFVNSU5BTkNFPTMsRWUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0U9NCxFZS5MSUdIVFRZUEVJRF9QT0lOVExJR0hUPTAsRWUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD0xLEVlLkxJR0hUVFlQRUlEX1NQT1RMSUdIVD0yLEVlLkxJR0hUVFlQRUlEX0hFTUlTUEhFUklDTElHSFQ9Mzt2YXIgQ3Q7KGZ1bmN0aW9uKGMpe2NbYy5CYWNrd2FyZENvbXBhdGlibGU9MF09IkJhY2t3YXJkQ29tcGF0aWJsZSIsY1tjLkludGVybWVkaWF0ZT0xXT0iSW50ZXJtZWRpYXRlIixjW2MuQWdncmVzc2l2ZT0yXT0iQWdncmVzc2l2ZSJ9KShDdHx8KEN0PXt9KSk7Y2xhc3MgbmUgZXh0ZW5kcyBaaXtjb25zdHJ1Y3RvcihlLHQpe3N1cGVyKCksdGhpcy5faW5wdXRNYW5hZ2VyPW5ldyBEZSh0aGlzKSx0aGlzLmNhbWVyYVRvVXNlRm9yUG9pbnRlcnM9bnVsbCx0aGlzLl9pc1NjZW5lPSEwLHRoaXMuX2Jsb2NrRW50aXR5Q29sbGVjdGlvbj0hMSx0aGlzLmF1dG9DbGVhcj0hMCx0aGlzLmF1dG9DbGVhckRlcHRoQW5kU3RlbmNpbD0hMCx0aGlzLmNsZWFyQ29sb3I9bmV3IG1lKC4yLC4yLC4zLDEpLHRoaXMuYW1iaWVudENvbG9yPW5ldyByZSgwLDAsMCksdGhpcy5lbnZpcm9ubWVudEludGVuc2l0eT0xLHRoaXMuX3BlcmZvcm1hbmNlUHJpb3JpdHk9Q3QuQmFja3dhcmRDb21wYXRpYmxlLHRoaXMuX2ZvcmNlV2lyZWZyYW1lPSExLHRoaXMuX3NraXBGcnVzdHVtQ2xpcHBpbmc9ITEsdGhpcy5fZm9yY2VQb2ludHNDbG91ZD0hMSx0aGlzLmFuaW1hdGlvbnNFbmFibGVkPSEwLHRoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZT1udWxsLHRoaXMudXNlQ29uc3RhbnRBbmltYXRpb25EZWx0YVRpbWU9ITEsdGhpcy5jb25zdGFudGx5VXBkYXRlTWVzaFVuZGVyUG9pbnRlcj0hMSx0aGlzLmhvdmVyQ3Vyc29yPSJwb2ludGVyIix0aGlzLmRlZmF1bHRDdXJzb3I9IiIsdGhpcy5kb05vdEhhbmRsZUN1cnNvcnM9ITEsdGhpcy5wcmV2ZW50RGVmYXVsdE9uUG9pbnRlckRvd249ITAsdGhpcy5wcmV2ZW50RGVmYXVsdE9uUG9pbnRlclVwPSEwLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLnJlc2VydmVkRGF0YVN0b3JlPW51bGwsdGhpcy5kaXNhYmxlT2ZmbGluZVN1cHBvcnRFeGNlcHRpb25SdWxlcz1uZXcgQXJyYXksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPW51bGwsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlcj1udWxsLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyQ2FtZXJhT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXI9bnVsbCx0aGlzLm9uQmVmb3JlQW5pbWF0aW9uc09ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyQW5pbWF0aW9uc09ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZURyYXdQaGFzZU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyRHJhd1BoYXNlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUmVhZHlPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXI9bnVsbCx0aGlzLm9uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZlcj1udWxsLHRoaXMub25CZWZvcmVBY3RpdmVNZXNoZXNFdmFsdWF0aW9uT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJBY3RpdmVNZXNoZXNFdmFsdWF0aW9uT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJQYXJ0aWNsZXNSZW5kZXJpbmdPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25EYXRhTG9hZGVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3Q2FtZXJhQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25DYW1lcmFSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3TGlnaHRBZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld0dlb21ldHJ5QWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25HZW9tZXRyeVJlbW92ZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25OZXdUcmFuc2Zvcm1Ob2RlQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25UcmFuc2Zvcm1Ob2RlUmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld01lc2hBZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3U2tlbGV0b25BZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vblNrZWxldG9uUmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld01hdGVyaWFsQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25OZXdNdWx0aU1hdGVyaWFsQWRkZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25NYXRlcmlhbFJlbW92ZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25NdWx0aU1hdGVyaWFsUmVtb3ZlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbk5ld1RleHR1cmVBZGRlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vblRleHR1cmVSZW1vdmVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVN0ZXBPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlclN0ZXBPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BY3RpdmVDYW1lcmFDaGFuZ2VkPW5ldyBGLHRoaXMub25BY3RpdmVDYW1lcmFzQ2hhbmdlZD1uZXcgRix0aGlzLm9uQmVmb3JlUmVuZGVyaW5nR3JvdXBPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlclJlbmRlcmluZ0dyb3VwT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTWVzaEltcG9ydGVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQW5pbWF0aW9uRmlsZUltcG9ydGVkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9yZWdpc3RlcmVkRm9yTGF0ZUFuaW1hdGlvbkJpbmRpbmdzPW5ldyBoaSgyNTYpLHRoaXMuc2tpcFBvaW50ZXJNb3ZlUGlja2luZz0hMSx0aGlzLnNraXBQb2ludGVyRG93blBpY2tpbmc9ITEsdGhpcy5za2lwUG9pbnRlclVwUGlja2luZz0hMSx0aGlzLm9uUHJlUG9pbnRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vblBvaW50ZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25QcmVLZXlib2FyZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbktleWJvYXJkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl91c2VSaWdodEhhbmRlZFN5c3RlbT0hMSx0aGlzLl90aW1lQWNjdW11bGF0b3I9MCx0aGlzLl9jdXJyZW50U3RlcElkPTAsdGhpcy5fY3VycmVudEludGVybmFsU3RlcD0wLHRoaXMuX2ZvZ0VuYWJsZWQ9ITAsdGhpcy5fZm9nTW9kZT1uZS5GT0dNT0RFX05PTkUsdGhpcy5mb2dDb2xvcj1uZXcgcmUoLjIsLjIsLjMpLHRoaXMuZm9nRGVuc2l0eT0uMSx0aGlzLmZvZ1N0YXJ0PTAsdGhpcy5mb2dFbmQ9MWUzLHRoaXMubmVlZHNQcmV2aW91c1dvcmxkTWF0cmljZXM9ITEsdGhpcy5fc2hhZG93c0VuYWJsZWQ9ITAsdGhpcy5fbGlnaHRzRW5hYmxlZD0hMCx0aGlzLl91bk9ic2VydmVBY3RpdmVDYW1lcmFzPW51bGwsdGhpcy5fdGV4dHVyZXNFbmFibGVkPSEwLHRoaXMucGh5c2ljc0VuYWJsZWQ9ITAsdGhpcy5wYXJ0aWNsZXNFbmFibGVkPSEwLHRoaXMuc3ByaXRlc0VuYWJsZWQ9ITAsdGhpcy5fc2tlbGV0b25zRW5hYmxlZD0hMCx0aGlzLmxlbnNGbGFyZXNFbmFibGVkPSEwLHRoaXMuY29sbGlzaW9uc0VuYWJsZWQ9ITAsdGhpcy5ncmF2aXR5PW5ldyBwKDAsLTkuODA3LDApLHRoaXMucG9zdFByb2Nlc3Nlc0VuYWJsZWQ9ITAsdGhpcy5yZW5kZXJUYXJnZXRzRW5hYmxlZD0hMCx0aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cz0hMSx0aGlzLmN1c3RvbVJlbmRlclRhcmdldHM9bmV3IEFycmF5LHRoaXMuaW1wb3J0ZWRNZXNoZXNGaWxlcz1uZXcgQXJyYXksdGhpcy5wcm9iZXNFbmFibGVkPSEwLHRoaXMuX21lc2hlc0ZvckludGVyc2VjdGlvbnM9bmV3IGhpKDI1NiksdGhpcy5wcm9jZWR1cmFsVGV4dHVyZXNFbmFibGVkPSEwLHRoaXMuX3RvdGFsVmVydGljZXM9bmV3IFJ0LHRoaXMuX2FjdGl2ZUluZGljZXM9bmV3IFJ0LHRoaXMuX2FjdGl2ZVBhcnRpY2xlcz1uZXcgUnQsdGhpcy5fYWN0aXZlQm9uZXM9bmV3IFJ0LHRoaXMuX2FuaW1hdGlvblRpbWU9MCx0aGlzLmFuaW1hdGlvblRpbWVTY2FsZT0xLHRoaXMuX3JlbmRlcklkPTAsdGhpcy5fZnJhbWVJZD0wLHRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9bnVsbCx0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmc9ITEsdGhpcy5fZGVmYXVsdEZyYW1lQnVmZmVyQ2xlYXJlZD0hMSx0aGlzLl92aWV3VXBkYXRlRmxhZz0tMSx0aGlzLl9wcm9qZWN0aW9uVXBkYXRlRmxhZz0tMSx0aGlzLl90b0JlRGlzcG9zZWQ9bmV3IEFycmF5KDI1NiksdGhpcy5fYWN0aXZlUmVxdWVzdHM9bmV3IEFycmF5LHRoaXMuX3BlbmRpbmdEYXRhPW5ldyBBcnJheSx0aGlzLl9pc0Rpc3Bvc2VkPSExLHRoaXMuZGlzcGF0Y2hBbGxTdWJNZXNoZXNPZkFjdGl2ZU1lc2hlcz0hMSx0aGlzLl9hY3RpdmVNZXNoZXM9bmV3ICRlKDI1NiksdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzPW5ldyAkZSgyNTYpLHRoaXMuX3JlbmRlclRhcmdldHM9bmV3IGhpKDI1NiksdGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cz1uZXcgaGkoMjU2KSx0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXM9bmV3ICRlKDI1NiksdGhpcy5fYWN0aXZlU2tlbGV0b25zPW5ldyBoaSgzMiksdGhpcy5fc29mdHdhcmVTa2lubmVkTWVzaGVzPW5ldyBoaSgzMiksdGhpcy5fYWN0aXZlQW5pbWF0YWJsZXM9bmV3IEFycmF5LHRoaXMuX3RyYW5zZm9ybU1hdHJpeD14Llplcm8oKSx0aGlzLnJlcXVpcmVMaWdodFNvcnRpbmc9ITEsdGhpcy5fY29tcG9uZW50cz1bXSx0aGlzLl9zZXJpYWxpemFibGVDb21wb25lbnRzPVtdLHRoaXMuX3RyYW5zaWVudENvbXBvbmVudHM9W10sdGhpcy5fYmVmb3JlQ2FtZXJhVXBkYXRlU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYmVmb3JlQ2xlYXJTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9iZWZvcmVSZW5kZXJUYXJnZXRDbGVhclN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2dhdGhlclJlbmRlclRhcmdldHNTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9nYXRoZXJBY3RpdmVDYW1lcmFSZW5kZXJUYXJnZXRzU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5faXNSZWFkeUZvck1lc2hTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9iZWZvcmVFdmFsdWF0ZUFjdGl2ZU1lc2hTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9ldmFsdWF0ZVN1Yk1lc2hTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9wcmVBY3RpdmVNZXNoU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fY2FtZXJhRHJhd1JlbmRlclRhcmdldFN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2JlZm9yZUNhbWVyYURyYXdTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9iZWZvcmVSZW5kZXJUYXJnZXREcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYmVmb3JlUmVuZGVyaW5nR3JvdXBEcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYmVmb3JlUmVuZGVyaW5nTWVzaFN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyaW5nTWVzaFN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyaW5nR3JvdXBEcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYWZ0ZXJDYW1lcmFEcmF3U3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fYWZ0ZXJDYW1lcmFQb3N0UHJvY2Vzc1N0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyVGFyZ2V0RHJhd1N0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX2FmdGVyUmVuZGVyVGFyZ2V0UG9zdFByb2Nlc3NTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9hZnRlclJlbmRlclN0YWdlPUllLkNyZWF0ZSgpLHRoaXMuX3BvaW50ZXJNb3ZlU3RhZ2U9SWUuQ3JlYXRlKCksdGhpcy5fcG9pbnRlckRvd25TdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9wb2ludGVyVXBTdGFnZT1JZS5DcmVhdGUoKSx0aGlzLl9nZW9tZXRyaWVzQnlVbmlxdWVJZD1udWxsLHRoaXMuX2RlZmF1bHRNZXNoQ2FuZGlkYXRlcz17ZGF0YTpbXSxsZW5ndGg6MH0sdGhpcy5fZGVmYXVsdFN1Yk1lc2hDYW5kaWRhdGVzPXtkYXRhOltdLGxlbmd0aDowfSx0aGlzLl9wcmV2ZW50RnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3Vwcz0hMSx0aGlzLl9hY3RpdmVNZXNoZXNGcm96ZW49ITEsdGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuQnV0S2VlcENsaXBwaW5nPSExLHRoaXMuX3NraXBFdmFsdWF0ZUFjdGl2ZU1lc2hlc0NvbXBsZXRlbHk9ITEsdGhpcy5fYWxsb3dQb3N0UHJvY2Vzc0NsZWFyQ29sb3I9ITAsdGhpcy5nZXREZXRlcm1pbmlzdGljRnJhbWVUaW1lPSgpPT50aGlzLl9lbmdpbmUuZ2V0VGltZVN0ZXAoKSx0aGlzLl9yZWdpc3RlcmVkQWN0aW9ucz0wLHRoaXMuX2Jsb2NrTWF0ZXJpYWxEaXJ0eU1lY2hhbmlzbT0hMSx0aGlzLl9wZXJmQ29sbGVjdG9yPW51bGwsdGhpcy5hY3RpdmVDYW1lcmFzPW5ldyBBcnJheTtjb25zdCBpPXt1c2VHZW9tZXRyeVVuaXF1ZUlkc01hcDohMCx1c2VNYXRlcmlhbE1lc2hNYXA6ITAsdXNlQ2xvbmVkTWVzaE1hcDohMCx2aXJ0dWFsOiExLC4uLnR9O3RoaXMuX2VuZ2luZT1lfHxmZS5MYXN0Q3JlYXRlZEVuZ2luZSxpLnZpcnR1YWw/dGhpcy5fZW5naW5lLl92aXJ0dWFsU2NlbmVzLnB1c2godGhpcyk6KGZlLl9MYXN0Q3JlYXRlZFNjZW5lPXRoaXMsdGhpcy5fZW5naW5lLnNjZW5lcy5wdXNoKHRoaXMpKSx0aGlzLl91aWQ9bnVsbCx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyPW5ldyBXZSh0aGlzKSxRaSYmKHRoaXMucG9zdFByb2Nlc3NNYW5hZ2VyPW5ldyBRaSh0aGlzKSksamUoKSYmdGhpcy5hdHRhY2hDb250cm9sKCksdGhpcy5fY3JlYXRlVWJvKCkscGUmJih0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uPW5ldyBwZSksdGhpcy5zZXREZWZhdWx0Q2FuZGlkYXRlUHJvdmlkZXJzKCksaS51c2VHZW9tZXRyeVVuaXF1ZUlkc01hcCYmKHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkPXt9KSx0aGlzLnVzZU1hdGVyaWFsTWVzaE1hcD1pLnVzZU1hdGVyaWFsTWVzaE1hcCx0aGlzLnVzZUNsb25lZE1lc2hNYXA9aS51c2VDbG9uZWRNZXNoTWFwLCghdHx8IXQudmlydHVhbCkmJnRoaXMuX2VuZ2luZS5vbk5ld1NjZW5lQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1zdGF0aWMgRGVmYXVsdE1hdGVyaWFsRmFjdG9yeShlKXt0aHJvdyAkKCJTdGFuZGFyZE1hdGVyaWFsIil9c3RhdGljIENvbGxpc2lvbkNvb3JkaW5hdG9yRmFjdG9yeSgpe3Rocm93ICQoIkRlZmF1bHRDb2xsaXNpb25Db29yZGluYXRvciIpfWdldCBlbnZpcm9ubWVudFRleHR1cmUoKXtyZXR1cm4gdGhpcy5fZW52aXJvbm1lbnRUZXh0dXJlfXNldCBlbnZpcm9ubWVudFRleHR1cmUoZSl7dGhpcy5fZW52aXJvbm1lbnRUZXh0dXJlIT09ZSYmKHRoaXMuX2Vudmlyb25tZW50VGV4dHVyZT1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfWdldCBpbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb259Z2V0IHBlcmZvcm1hbmNlUHJpb3JpdHkoKXtyZXR1cm4gdGhpcy5fcGVyZm9ybWFuY2VQcmlvcml0eX1zZXQgcGVyZm9ybWFuY2VQcmlvcml0eShlKXtpZihlIT09dGhpcy5fcGVyZm9ybWFuY2VQcmlvcml0eSlzd2l0Y2godGhpcy5fcGVyZm9ybWFuY2VQcmlvcml0eT1lLGUpe2Nhc2UgQ3QuQmFja3dhcmRDb21wYXRpYmxlOnRoaXMuc2tpcEZydXN0dW1DbGlwcGluZz0hMSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLm1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPSExLHRoaXMuc2tpcFBvaW50ZXJNb3ZlUGlja2luZz0hMSx0aGlzLmF1dG9DbGVhcj0hMDticmVhaztjYXNlIEN0LkludGVybWVkaWF0ZTp0aGlzLnNraXBGcnVzdHVtQ2xpcHBpbmc9ITEsdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5tYWludGFpblN0YXRlQmV0d2VlbkZyYW1lcz0hMSx0aGlzLnNraXBQb2ludGVyTW92ZVBpY2tpbmc9ITAsdGhpcy5hdXRvQ2xlYXI9ITE7YnJlYWs7Y2FzZSBDdC5BZ2dyZXNzaXZlOnRoaXMuc2tpcEZydXN0dW1DbGlwcGluZz0hMCx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLm1haW50YWluU3RhdGVCZXR3ZWVuRnJhbWVzPSEwLHRoaXMuc2tpcFBvaW50ZXJNb3ZlUGlja2luZz0hMCx0aGlzLmF1dG9DbGVhcj0hMTticmVha319c2V0IGZvcmNlV2lyZWZyYW1lKGUpe3RoaXMuX2ZvcmNlV2lyZWZyYW1lIT09ZSYmKHRoaXMuX2ZvcmNlV2lyZWZyYW1lPWUsdGhpcy5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxNikpfWdldCBmb3JjZVdpcmVmcmFtZSgpe3JldHVybiB0aGlzLl9mb3JjZVdpcmVmcmFtZX1zZXQgc2tpcEZydXN0dW1DbGlwcGluZyhlKXt0aGlzLl9za2lwRnJ1c3R1bUNsaXBwaW5nIT09ZSYmKHRoaXMuX3NraXBGcnVzdHVtQ2xpcHBpbmc9ZSl9Z2V0IHNraXBGcnVzdHVtQ2xpcHBpbmcoKXtyZXR1cm4gdGhpcy5fc2tpcEZydXN0dW1DbGlwcGluZ31zZXQgZm9yY2VQb2ludHNDbG91ZChlKXt0aGlzLl9mb3JjZVBvaW50c0Nsb3VkIT09ZSYmKHRoaXMuX2ZvcmNlUG9pbnRzQ2xvdWQ9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDE2KSl9Z2V0IGZvcmNlUG9pbnRzQ2xvdWQoKXtyZXR1cm4gdGhpcy5fZm9yY2VQb2ludHNDbG91ZH1nZXQgYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlKCl7cmV0dXJuIHRoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZX1zZXQgYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlKGUpe3RoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZT1lfXNldCBvbkRpc3Bvc2UoZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IGJlZm9yZVJlbmRlcihlKXt0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciksZSYmKHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpKX1zZXQgYWZ0ZXJSZW5kZXIoZSl7dGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXIpLGUmJih0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZSkpfXNldCBiZWZvcmVDYW1lcmFSZW5kZXIoZSl7dGhpcy5fb25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZUNhbWVyYVJlbmRlck9ic2VydmFibGUuYWRkKGUpfXNldCBhZnRlckNhbWVyYVJlbmRlcihlKXt0aGlzLl9vbkFmdGVyQ2FtZXJhUmVuZGVyT2JzZXJ2ZXImJnRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWZ0ZXJDYW1lcmFSZW5kZXJPYnNlcnZlciksdGhpcy5fb25BZnRlckNhbWVyYVJlbmRlck9ic2VydmVyPXRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUuYWRkKGUpfWdldCB1blRyYW5zbGF0ZWRQb2ludGVyKCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci51blRyYW5zbGF0ZWRQb2ludGVyfXN0YXRpYyBnZXQgRHJhZ01vdmVtZW50VGhyZXNob2xkKCl7cmV0dXJuIERlLkRyYWdNb3ZlbWVudFRocmVzaG9sZH1zdGF0aWMgc2V0IERyYWdNb3ZlbWVudFRocmVzaG9sZChlKXtEZS5EcmFnTW92ZW1lbnRUaHJlc2hvbGQ9ZX1zdGF0aWMgZ2V0IExvbmdQcmVzc0RlbGF5KCl7cmV0dXJuIERlLkxvbmdQcmVzc0RlbGF5fXN0YXRpYyBzZXQgTG9uZ1ByZXNzRGVsYXkoZSl7RGUuTG9uZ1ByZXNzRGVsYXk9ZX1zdGF0aWMgZ2V0IERvdWJsZUNsaWNrRGVsYXkoKXtyZXR1cm4gRGUuRG91YmxlQ2xpY2tEZWxheX1zdGF0aWMgc2V0IERvdWJsZUNsaWNrRGVsYXkoZSl7RGUuRG91YmxlQ2xpY2tEZWxheT1lfXN0YXRpYyBnZXQgRXhjbHVzaXZlRG91YmxlQ2xpY2tNb2RlKCl7cmV0dXJuIERlLkV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZX1zdGF0aWMgc2V0IEV4Y2x1c2l2ZURvdWJsZUNsaWNrTW9kZShlKXtEZS5FeGNsdXNpdmVEb3VibGVDbGlja01vZGU9ZX1iaW5kRXllUG9zaXRpb24oZSx0PSJ2RXllUG9zaXRpb24iLGk9ITEpe3ZhciBzO2NvbnN0IHI9dGhpcy5fZm9yY2VkVmlld1Bvc2l0aW9uP3RoaXMuX2ZvcmNlZFZpZXdQb3NpdGlvbjp0aGlzLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uP3RoaXMuX21pcnJvcmVkQ2FtZXJhUG9zaXRpb246KHM9dGhpcy5hY3RpdmVDYW1lcmEuZ2xvYmFsUG9zaXRpb24pIT09bnVsbCYmcyE9PXZvaWQgMD9zOnRoaXMuYWN0aXZlQ2FtZXJhLmRldmljZVBvc2l0aW9uLG49dGhpcy51c2VSaWdodEhhbmRlZFN5c3RlbT09PSh0aGlzLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uIT1udWxsKTtyZXR1cm4gRC5WZWN0b3I0WzBdLnNldChyLngsci55LHIueixuPy0xOjEpLGUmJihpP2Uuc2V0RmxvYXQzKHQsRC5WZWN0b3I0WzBdLngsRC5WZWN0b3I0WzBdLnksRC5WZWN0b3I0WzBdLnopOmUuc2V0VmVjdG9yNCh0LEQuVmVjdG9yNFswXSkpLEQuVmVjdG9yNFswXX1maW5hbGl6ZVNjZW5lVWJvKCl7Y29uc3QgZT10aGlzLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLHQ9dGhpcy5iaW5kRXllUG9zaXRpb24obnVsbCk7cmV0dXJuIGUudXBkYXRlRmxvYXQ0KCJ2RXllUG9zaXRpb24iLHQueCx0LnksdC56LHQudyksZS51cGRhdGUoKSxlfXNldCB1c2VSaWdodEhhbmRlZFN5c3RlbShlKXt0aGlzLl91c2VSaWdodEhhbmRlZFN5c3RlbSE9PWUmJih0aGlzLl91c2VSaWdodEhhbmRlZFN5c3RlbT1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMTYpKX1nZXQgdXNlUmlnaHRIYW5kZWRTeXN0ZW0oKXtyZXR1cm4gdGhpcy5fdXNlUmlnaHRIYW5kZWRTeXN0ZW19c2V0U3RlcElkKGUpe3RoaXMuX2N1cnJlbnRTdGVwSWQ9ZX1nZXRTdGVwSWQoKXtyZXR1cm4gdGhpcy5fY3VycmVudFN0ZXBJZH1nZXRJbnRlcm5hbFN0ZXAoKXtyZXR1cm4gdGhpcy5fY3VycmVudEludGVybmFsU3RlcH1zZXQgZm9nRW5hYmxlZChlKXt0aGlzLl9mb2dFbmFibGVkIT09ZSYmKHRoaXMuX2ZvZ0VuYWJsZWQ9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDE2KSl9Z2V0IGZvZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fZm9nRW5hYmxlZH1zZXQgZm9nTW9kZShlKXt0aGlzLl9mb2dNb2RlIT09ZSYmKHRoaXMuX2ZvZ01vZGU9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDE2KSl9Z2V0IGZvZ01vZGUoKXtyZXR1cm4gdGhpcy5fZm9nTW9kZX1nZXQgcHJlUGFzcygpe3JldHVybiEhdGhpcy5wcmVQYXNzUmVuZGVyZXImJnRoaXMucHJlUGFzc1JlbmRlcmVyLmRlZmF1bHRSVC5lbmFibGVkfXNldCBzaGFkb3dzRW5hYmxlZChlKXt0aGlzLl9zaGFkb3dzRW5hYmxlZCE9PWUmJih0aGlzLl9zaGFkb3dzRW5hYmxlZD1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMikpfWdldCBzaGFkb3dzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9zaGFkb3dzRW5hYmxlZH1zZXQgbGlnaHRzRW5hYmxlZChlKXt0aGlzLl9saWdodHNFbmFibGVkIT09ZSYmKHRoaXMuX2xpZ2h0c0VuYWJsZWQ9ZSx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDIpKX1nZXQgbGlnaHRzRW5hYmxlZCgpe3JldHVybiB0aGlzLl9saWdodHNFbmFibGVkfWdldCBhY3RpdmVDYW1lcmFzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUNhbWVyYXN9c2V0IGFjdGl2ZUNhbWVyYXMoZSl7dGhpcy5fdW5PYnNlcnZlQWN0aXZlQ2FtZXJhcyYmKHRoaXMuX3VuT2JzZXJ2ZUFjdGl2ZUNhbWVyYXMoKSx0aGlzLl91bk9ic2VydmVBY3RpdmVDYW1lcmFzPW51bGwpLGUmJih0aGlzLl91bk9ic2VydmVBY3RpdmVDYW1lcmFzPSRzKGUsKCk9Pnt0aGlzLm9uQWN0aXZlQ2FtZXJhc0NoYW5nZWQubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpfSkpLHRoaXMuX2FjdGl2ZUNhbWVyYXM9ZX1nZXQgYWN0aXZlQ2FtZXJhKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUNhbWVyYX1zZXQgYWN0aXZlQ2FtZXJhKGUpe2UhPT10aGlzLl9hY3RpdmVDYW1lcmEmJih0aGlzLl9hY3RpdmVDYW1lcmE9ZSx0aGlzLm9uQWN0aXZlQ2FtZXJhQ2hhbmdlZC5ub3RpZnlPYnNlcnZlcnModGhpcykpfWdldCBkZWZhdWx0TWF0ZXJpYWwoKXtyZXR1cm4gdGhpcy5fZGVmYXVsdE1hdGVyaWFsfHwodGhpcy5fZGVmYXVsdE1hdGVyaWFsPW5lLkRlZmF1bHRNYXRlcmlhbEZhY3RvcnkodGhpcykpLHRoaXMuX2RlZmF1bHRNYXRlcmlhbH1zZXQgZGVmYXVsdE1hdGVyaWFsKGUpe3RoaXMuX2RlZmF1bHRNYXRlcmlhbD1lfXNldCB0ZXh0dXJlc0VuYWJsZWQoZSl7dGhpcy5fdGV4dHVyZXNFbmFibGVkIT09ZSYmKHRoaXMuX3RleHR1cmVzRW5hYmxlZD1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfWdldCB0ZXh0dXJlc0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZXNFbmFibGVkfXNldCBza2VsZXRvbnNFbmFibGVkKGUpe3RoaXMuX3NrZWxldG9uc0VuYWJsZWQhPT1lJiYodGhpcy5fc2tlbGV0b25zRW5hYmxlZD1lLHRoaXMubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoOCkpfWdldCBza2VsZXRvbnNFbmFibGVkKCl7cmV0dXJuIHRoaXMuX3NrZWxldG9uc0VuYWJsZWR9Z2V0IGNvbGxpc2lvbkNvb3JkaW5hdG9yKCl7cmV0dXJuIHRoaXMuX2NvbGxpc2lvbkNvb3JkaW5hdG9yfHwodGhpcy5fY29sbGlzaW9uQ29vcmRpbmF0b3I9bmUuQ29sbGlzaW9uQ29vcmRpbmF0b3JGYWN0b3J5KCksdGhpcy5fY29sbGlzaW9uQ29vcmRpbmF0b3IuaW5pdCh0aGlzKSksdGhpcy5fY29sbGlzaW9uQ29vcmRpbmF0b3J9Z2V0IHJlbmRlcmluZ01hbmFnZXIoKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nTWFuYWdlcn1nZXQgZnJ1c3R1bVBsYW5lcygpe3JldHVybiB0aGlzLl9mcnVzdHVtUGxhbmVzfV9yZWdpc3RlclRyYW5zaWVudENvbXBvbmVudHMoKXtpZih0aGlzLl90cmFuc2llbnRDb21wb25lbnRzLmxlbmd0aD4wKXtmb3IoY29uc3QgZSBvZiB0aGlzLl90cmFuc2llbnRDb21wb25lbnRzKWUucmVnaXN0ZXIoKTt0aGlzLl90cmFuc2llbnRDb21wb25lbnRzLmxlbmd0aD0wfX1fYWRkQ29tcG9uZW50KGUpe3RoaXMuX2NvbXBvbmVudHMucHVzaChlKSx0aGlzLl90cmFuc2llbnRDb21wb25lbnRzLnB1c2goZSk7Y29uc3QgdD1lO3QuYWRkRnJvbUNvbnRhaW5lciYmdC5zZXJpYWxpemUmJnRoaXMuX3NlcmlhbGl6YWJsZUNvbXBvbmVudHMucHVzaCh0KX1fZ2V0Q29tcG9uZW50KGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2NvbXBvbmVudHMpaWYodC5uYW1lPT09ZSlyZXR1cm4gdDtyZXR1cm4gbnVsbH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iU2NlbmUifV9nZXREZWZhdWx0TWVzaENhbmRpZGF0ZXMoKXtyZXR1cm4gdGhpcy5fZGVmYXVsdE1lc2hDYW5kaWRhdGVzLmRhdGE9dGhpcy5tZXNoZXMsdGhpcy5fZGVmYXVsdE1lc2hDYW5kaWRhdGVzLmxlbmd0aD10aGlzLm1lc2hlcy5sZW5ndGgsdGhpcy5fZGVmYXVsdE1lc2hDYW5kaWRhdGVzfV9nZXREZWZhdWx0U3ViTWVzaENhbmRpZGF0ZXMoZSl7cmV0dXJuIHRoaXMuX2RlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlcy5kYXRhPWUuc3ViTWVzaGVzLHRoaXMuX2RlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlcy5sZW5ndGg9ZS5zdWJNZXNoZXMubGVuZ3RoLHRoaXMuX2RlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlc31zZXREZWZhdWx0Q2FuZGlkYXRlUHJvdmlkZXJzKCl7dGhpcy5nZXRBY3RpdmVNZXNoQ2FuZGlkYXRlcz10aGlzLl9nZXREZWZhdWx0TWVzaENhbmRpZGF0ZXMuYmluZCh0aGlzKSx0aGlzLmdldEFjdGl2ZVN1Yk1lc2hDYW5kaWRhdGVzPXRoaXMuX2dldERlZmF1bHRTdWJNZXNoQ2FuZGlkYXRlcy5iaW5kKHRoaXMpLHRoaXMuZ2V0SW50ZXJzZWN0aW5nU3ViTWVzaENhbmRpZGF0ZXM9dGhpcy5fZ2V0RGVmYXVsdFN1Yk1lc2hDYW5kaWRhdGVzLmJpbmQodGhpcyksdGhpcy5nZXRDb2xsaWRpbmdTdWJNZXNoQ2FuZGlkYXRlcz10aGlzLl9nZXREZWZhdWx0U3ViTWVzaENhbmRpZGF0ZXMuYmluZCh0aGlzKX1nZXQgbWVzaFVuZGVyUG9pbnRlcigpe3JldHVybiB0aGlzLl9pbnB1dE1hbmFnZXIubWVzaFVuZGVyUG9pbnRlcn1nZXQgcG9pbnRlclgoKXtyZXR1cm4gdGhpcy5faW5wdXRNYW5hZ2VyLnBvaW50ZXJYfXNldCBwb2ludGVyWChlKXt0aGlzLl9pbnB1dE1hbmFnZXIucG9pbnRlclg9ZX1nZXQgcG9pbnRlclkoKXtyZXR1cm4gdGhpcy5faW5wdXRNYW5hZ2VyLnBvaW50ZXJZfXNldCBwb2ludGVyWShlKXt0aGlzLl9pbnB1dE1hbmFnZXIucG9pbnRlclk9ZX1nZXRDYWNoZWRNYXRlcmlhbCgpe3JldHVybiB0aGlzLl9jYWNoZWRNYXRlcmlhbH1nZXRDYWNoZWRFZmZlY3QoKXtyZXR1cm4gdGhpcy5fY2FjaGVkRWZmZWN0fWdldENhY2hlZFZpc2liaWxpdHkoKXtyZXR1cm4gdGhpcy5fY2FjaGVkVmlzaWJpbGl0eX1pc0NhY2hlZE1hdGVyaWFsSW52YWxpZChlLHQsaT0xKXtyZXR1cm4gdGhpcy5fY2FjaGVkRWZmZWN0IT09dHx8dGhpcy5fY2FjaGVkTWF0ZXJpYWwhPT1lfHx0aGlzLl9jYWNoZWRWaXNpYmlsaXR5IT09aX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gdGhpcy5fdG90YWxWZXJ0aWNlcy5jdXJyZW50fWdldCB0b3RhbFZlcnRpY2VzUGVyZkNvdW50ZXIoKXtyZXR1cm4gdGhpcy5fdG90YWxWZXJ0aWNlc31nZXRBY3RpdmVJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUluZGljZXMuY3VycmVudH1nZXQgdG90YWxBY3RpdmVJbmRpY2VzUGVyZkNvdW50ZXIoKXtyZXR1cm4gdGhpcy5fYWN0aXZlSW5kaWNlc31nZXRBY3RpdmVQYXJ0aWNsZXMoKXtyZXR1cm4gdGhpcy5fYWN0aXZlUGFydGljbGVzLmN1cnJlbnR9Z2V0IGFjdGl2ZVBhcnRpY2xlc1BlcmZDb3VudGVyKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZVBhcnRpY2xlc31nZXRBY3RpdmVCb25lcygpe3JldHVybiB0aGlzLl9hY3RpdmVCb25lcy5jdXJyZW50fWdldCBhY3RpdmVCb25lc1BlcmZDb3VudGVyKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUJvbmVzfWdldEFjdGl2ZU1lc2hlcygpe3JldHVybiB0aGlzLl9hY3RpdmVNZXNoZXN9Z2V0QW5pbWF0aW9uUmF0aW8oKXtyZXR1cm4gdGhpcy5fYW5pbWF0aW9uUmF0aW8hPT12b2lkIDA/dGhpcy5fYW5pbWF0aW9uUmF0aW86MX1nZXRSZW5kZXJJZCgpe3JldHVybiB0aGlzLl9yZW5kZXJJZH1nZXRGcmFtZUlkKCl7cmV0dXJuIHRoaXMuX2ZyYW1lSWR9aW5jcmVtZW50UmVuZGVySWQoKXt0aGlzLl9yZW5kZXJJZCsrfV9jcmVhdGVVYm8oKXt0aGlzLnNldFNjZW5lVW5pZm9ybUJ1ZmZlcih0aGlzLmNyZWF0ZVNjZW5lVW5pZm9ybUJ1ZmZlcigpKX1zaW11bGF0ZVBvaW50ZXJNb3ZlKGUsdCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5zaW11bGF0ZVBvaW50ZXJNb3ZlKGUsdCksdGhpc31zaW11bGF0ZVBvaW50ZXJEb3duKGUsdCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5zaW11bGF0ZVBvaW50ZXJEb3duKGUsdCksdGhpc31zaW11bGF0ZVBvaW50ZXJVcChlLHQsaSl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5zaW11bGF0ZVBvaW50ZXJVcChlLHQsaSksdGhpc31pc1BvaW50ZXJDYXB0dXJlZChlPTApe3JldHVybiB0aGlzLl9pbnB1dE1hbmFnZXIuaXNQb2ludGVyQ2FwdHVyZWQoZSl9YXR0YWNoQ29udHJvbChlPSEwLHQ9ITAsaT0hMCl7dGhpcy5faW5wdXRNYW5hZ2VyLmF0dGFjaENvbnRyb2woZSx0LGkpfWRldGFjaENvbnRyb2woKXt0aGlzLl9pbnB1dE1hbmFnZXIuZGV0YWNoQ29udHJvbCgpfWlzUmVhZHkoZT0hMCl7aWYodGhpcy5faXNEaXNwb3NlZClyZXR1cm4hMTtsZXQgdDtjb25zdCBpPXRoaXMuZ2V0RW5naW5lKCk7bGV0IHM9ITA7Zm9yKHRoaXMuX3BlbmRpbmdEYXRhLmxlbmd0aD4wJiYocz0hMSksZSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5yZXNldCgpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMucmVzZXQoKSksdD0wO3Q8dGhpcy5tZXNoZXMubGVuZ3RoO3QrKyl7Y29uc3Qgcj10aGlzLm1lc2hlc1t0XTtpZighci5zdWJNZXNoZXN8fHIuc3ViTWVzaGVzLmxlbmd0aD09PTApY29udGludWU7aWYoIXIuaXNSZWFkeSghMCkpe3M9ITE7Y29udGludWV9Y29uc3Qgbj1yLmhhc1RoaW5JbnN0YW5jZXN8fHIuZ2V0Q2xhc3NOYW1lKCk9PT0iSW5zdGFuY2VkTWVzaCJ8fHIuZ2V0Q2xhc3NOYW1lKCk9PT0iSW5zdGFuY2VkTGluZXNNZXNoInx8aS5nZXRDYXBzKCkuaW5zdGFuY2VkQXJyYXlzJiZyLmluc3RhbmNlcy5sZW5ndGg+MDtmb3IoY29uc3QgbyBvZiB0aGlzLl9pc1JlYWR5Rm9yTWVzaFN0YWdlKW8uYWN0aW9uKHIsbil8fChzPSExKTtpZighZSljb250aW51ZTtjb25zdCBhPXIubWF0ZXJpYWx8fHRoaXMuZGVmYXVsdE1hdGVyaWFsO2lmKGEpaWYoYS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcylmb3IoY29uc3QgbyBvZiByLnN1Yk1lc2hlcyl7Y29uc3QgaD1vLmdldE1hdGVyaWFsKCk7aCYmaC5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyYmaC5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcyE9bnVsbCYmdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2YoaCk9PT0tMSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5wdXNoKGgpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKGguZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMoKSkpfWVsc2UgYS5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyYmYS5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcyE9bnVsbCYmdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2YoYSk9PT0tMSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5wdXNoKGEpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKGEuZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMoKSkpfWlmKCFzfHwhaS5hcmVBbGxFZmZlY3RzUmVhZHkoKSlyZXR1cm4hMTtpZihlKXtmb3IodD0wO3Q8dGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cy5sZW5ndGg7Kyt0KWlmKCF0aGlzLl9tYXRlcmlhbHNSZW5kZXJUYXJnZXRzLmRhdGFbdF0uaXNSZWFkeUZvclJlbmRlcmluZygpKXJldHVybiExfWZvcih0PTA7dDx0aGlzLmdlb21ldHJpZXMubGVuZ3RoO3QrKylpZih0aGlzLmdlb21ldHJpZXNbdF0uZGVsYXlMb2FkU3RhdGU9PT0yKXJldHVybiExO2lmKHRoaXMuYWN0aXZlQ2FtZXJhcyYmdGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aD4wKXtmb3IoY29uc3QgciBvZiB0aGlzLmFjdGl2ZUNhbWVyYXMpaWYoIXIuaXNSZWFkeSghMCkpcmV0dXJuITF9ZWxzZSBpZih0aGlzLmFjdGl2ZUNhbWVyYSYmIXRoaXMuYWN0aXZlQ2FtZXJhLmlzUmVhZHkoITApKXJldHVybiExO2Zvcihjb25zdCByIG9mIHRoaXMucGFydGljbGVTeXN0ZW1zKWlmKCFyLmlzUmVhZHkoKSlyZXR1cm4hMTtyZXR1cm4hMH1yZXNldENhY2hlZE1hdGVyaWFsKCl7dGhpcy5fY2FjaGVkTWF0ZXJpYWw9bnVsbCx0aGlzLl9jYWNoZWRFZmZlY3Q9bnVsbCx0aGlzLl9jYWNoZWRWaXNpYmlsaXR5PW51bGx9cmVnaXN0ZXJCZWZvcmVSZW5kZXIoZSl7dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpfXVucmVnaXN0ZXJCZWZvcmVSZW5kZXIoZSl7dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSl9cmVnaXN0ZXJBZnRlclJlbmRlcihlKXt0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX11bnJlZ2lzdGVyQWZ0ZXJSZW5kZXIoZSl7dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmVDYWxsYmFjayhlKX1fZXhlY3V0ZU9uY2VCZWZvcmVSZW5kZXIoZSl7Y29uc3QgdD0oKT0+e2UoKSxzZXRUaW1lb3V0KCgpPT57dGhpcy51bnJlZ2lzdGVyQmVmb3JlUmVuZGVyKHQpfSl9O3RoaXMucmVnaXN0ZXJCZWZvcmVSZW5kZXIodCl9ZXhlY3V0ZU9uY2VCZWZvcmVSZW5kZXIoZSx0KXt0IT09dm9pZCAwP3NldFRpbWVvdXQoKCk9Pnt0aGlzLl9leGVjdXRlT25jZUJlZm9yZVJlbmRlcihlKX0sdCk6dGhpcy5fZXhlY3V0ZU9uY2VCZWZvcmVSZW5kZXIoZSl9YWRkUGVuZGluZ0RhdGEoZSl7dGhpcy5fcGVuZGluZ0RhdGEucHVzaChlKX1yZW1vdmVQZW5kaW5nRGF0YShlKXtjb25zdCB0PXRoaXMuaXNMb2FkaW5nLGk9dGhpcy5fcGVuZGluZ0RhdGEuaW5kZXhPZihlKTtpIT09LTEmJnRoaXMuX3BlbmRpbmdEYXRhLnNwbGljZShpLDEpLHQmJiF0aGlzLmlzTG9hZGluZyYmdGhpcy5vbkRhdGFMb2FkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1nZXRXYWl0aW5nSXRlbXNDb3VudCgpe3JldHVybiB0aGlzLl9wZW5kaW5nRGF0YS5sZW5ndGh9Z2V0IGlzTG9hZGluZygpe3JldHVybiB0aGlzLl9wZW5kaW5nRGF0YS5sZW5ndGg+MH1leGVjdXRlV2hlblJlYWR5KGUsdD0hMSl7dGhpcy5vblJlYWR5T2JzZXJ2YWJsZS5hZGRPbmNlKGUpLHRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9PT1udWxsJiZ0aGlzLl9jaGVja0lzUmVhZHkodCl9d2hlblJlYWR5QXN5bmMoZT0hMSl7cmV0dXJuIG5ldyBQcm9taXNlKHQ9Pnt0aGlzLmV4ZWN1dGVXaGVuUmVhZHkoKCk9Pnt0KCl9LGUpfSl9X2NoZWNrSXNSZWFkeShlPSExKXtpZih0aGlzLl9yZWdpc3RlclRyYW5zaWVudENvbXBvbmVudHMoKSx0aGlzLmlzUmVhZHkoZSkpe3RoaXMub25SZWFkeU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25SZWFkeU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9leGVjdXRlV2hlblJlYWR5VGltZW91dElkPW51bGw7cmV0dXJufWlmKHRoaXMuX2lzRGlzcG9zZWQpe3RoaXMub25SZWFkeU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9leGVjdXRlV2hlblJlYWR5VGltZW91dElkPW51bGw7cmV0dXJufXRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9c2V0VGltZW91dCgoKT0+e3RoaXMuaW5jcmVtZW50UmVuZGVySWQoKSx0aGlzLl9jaGVja0lzUmVhZHkoZSl9LDEwMCl9Z2V0IGFuaW1hdGFibGVzKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZUFuaW1hdGFibGVzfXJlc2V0TGFzdEFuaW1hdGlvblRpbWVGcmFtZSgpe3RoaXMuX2FuaW1hdGlvblRpbWVMYXN0PWFpLk5vd31nZXRWaWV3TWF0cml4KCl7cmV0dXJuIHRoaXMuX3ZpZXdNYXRyaXh9Z2V0UHJvamVjdGlvbk1hdHJpeCgpe3JldHVybiB0aGlzLl9wcm9qZWN0aW9uTWF0cml4fWdldFRyYW5zZm9ybU1hdHJpeCgpe3JldHVybiB0aGlzLl90cmFuc2Zvcm1NYXRyaXh9c2V0VHJhbnNmb3JtTWF0cml4KGUsdCxpLHMpeyFpJiYhcyYmdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm8mJih0aGlzLl9tdWx0aXZpZXdTY2VuZVViby5kaXNwb3NlKCksdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm89bnVsbCksISh0aGlzLl92aWV3VXBkYXRlRmxhZz09PWUudXBkYXRlRmxhZyYmdGhpcy5fcHJvamVjdGlvblVwZGF0ZUZsYWc9PT10LnVwZGF0ZUZsYWcpJiYodGhpcy5fdmlld1VwZGF0ZUZsYWc9ZS51cGRhdGVGbGFnLHRoaXMuX3Byb2plY3Rpb25VcGRhdGVGbGFnPXQudXBkYXRlRmxhZyx0aGlzLl92aWV3TWF0cml4PWUsdGhpcy5fcHJvamVjdGlvbk1hdHJpeD10LHRoaXMuX3ZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybU1hdHJpeCksdGhpcy5fZnJ1c3R1bVBsYW5lcz9FdC5HZXRQbGFuZXNUb1JlZih0aGlzLl90cmFuc2Zvcm1NYXRyaXgsdGhpcy5fZnJ1c3R1bVBsYW5lcyk6dGhpcy5fZnJ1c3R1bVBsYW5lcz1FdC5HZXRQbGFuZXModGhpcy5fdHJhbnNmb3JtTWF0cml4KSx0aGlzLl9tdWx0aXZpZXdTY2VuZVVibyYmdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm8udXNlVWJvP3RoaXMuX3VwZGF0ZU11bHRpdmlld1VibyhpLHMpOnRoaXMuX3NjZW5lVWJvLnVzZVVibyYmKHRoaXMuX3NjZW5lVWJvLnVwZGF0ZU1hdHJpeCgidmlld1Byb2plY3Rpb24iLHRoaXMuX3RyYW5zZm9ybU1hdHJpeCksdGhpcy5fc2NlbmVVYm8udXBkYXRlTWF0cml4KCJ2aWV3Iix0aGlzLl92aWV3TWF0cml4KSx0aGlzLl9zY2VuZVViby51cGRhdGVNYXRyaXgoInByb2plY3Rpb24iLHRoaXMuX3Byb2plY3Rpb25NYXRyaXgpKSl9Z2V0U2NlbmVVbmlmb3JtQnVmZmVyKCl7cmV0dXJuIHRoaXMuX211bHRpdmlld1NjZW5lVWJvP3RoaXMuX211bHRpdmlld1NjZW5lVWJvOnRoaXMuX3NjZW5lVWJvfWNyZWF0ZVNjZW5lVW5pZm9ybUJ1ZmZlcihlKXtjb25zdCB0PW5ldyBWKHRoaXMuX2VuZ2luZSx2b2lkIDAsITEsZT8/InNjZW5lIik7cmV0dXJuIHQuYWRkVW5pZm9ybSgidmlld1Byb2plY3Rpb24iLDE2KSx0LmFkZFVuaWZvcm0oInZpZXciLDE2KSx0LmFkZFVuaWZvcm0oInByb2plY3Rpb24iLDE2KSx0LmFkZFVuaWZvcm0oInZFeWVQb3NpdGlvbiIsNCksdH1zZXRTY2VuZVVuaWZvcm1CdWZmZXIoZSl7dGhpcy5fc2NlbmVVYm89ZSx0aGlzLl92aWV3VXBkYXRlRmxhZz0tMSx0aGlzLl9wcm9qZWN0aW9uVXBkYXRlRmxhZz0tMX1nZXRVbmlxdWVJZCgpe3JldHVybiBNci5VbmlxdWVJZH1hZGRNZXNoKGUsdD0hMSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5tZXNoZXMucHVzaChlKSxlLl9yZXN5bmNMaWdodFNvdXJjZXMoKSxlLnBhcmVudHx8ZS5fYWRkVG9TY2VuZVJvb3ROb2RlcygpLHRoaXMub25OZXdNZXNoQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0JiZlLmdldENoaWxkTWVzaGVzKCkuZm9yRWFjaChpPT57dGhpcy5hZGRNZXNoKGkpfSkpfXJlbW92ZU1lc2goZSx0PSExKXtjb25zdCBpPXRoaXMubWVzaGVzLmluZGV4T2YoZSk7cmV0dXJuIGkhPT0tMSYmKHRoaXMubWVzaGVzW2ldPXRoaXMubWVzaGVzW3RoaXMubWVzaGVzLmxlbmd0aC0xXSx0aGlzLm1lc2hlcy5wb3AoKSxlLnBhcmVudHx8ZS5fcmVtb3ZlRnJvbVNjZW5lUm9vdE5vZGVzKCkpLHRoaXMuX2lucHV0TWFuYWdlci5faW52YWxpZGF0ZU1lc2goZSksdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksdCYmZS5nZXRDaGlsZE1lc2hlcygpLmZvckVhY2gocz0+e3RoaXMucmVtb3ZlTWVzaChzKX0pLGl9YWRkVHJhbnNmb3JtTm9kZShlKXt0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb258fGUuZ2V0U2NlbmUoKT09PXRoaXMmJmUuX2luZGV4SW5TY2VuZVRyYW5zZm9ybU5vZGVzQXJyYXkhPT0tMXx8KGUuX2luZGV4SW5TY2VuZVRyYW5zZm9ybU5vZGVzQXJyYXk9dGhpcy50cmFuc2Zvcm1Ob2Rlcy5sZW5ndGgsdGhpcy50cmFuc2Zvcm1Ob2Rlcy5wdXNoKGUpLGUucGFyZW50fHxlLl9hZGRUb1NjZW5lUm9vdE5vZGVzKCksdGhpcy5vbk5ld1RyYW5zZm9ybU5vZGVBZGRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKX1yZW1vdmVUcmFuc2Zvcm1Ob2RlKGUpe2NvbnN0IHQ9ZS5faW5kZXhJblNjZW5lVHJhbnNmb3JtTm9kZXNBcnJheTtpZih0IT09LTEpe2lmKHQhPT10aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aC0xKXtjb25zdCBpPXRoaXMudHJhbnNmb3JtTm9kZXNbdGhpcy50cmFuc2Zvcm1Ob2Rlcy5sZW5ndGgtMV07dGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XT1pLGkuX2luZGV4SW5TY2VuZVRyYW5zZm9ybU5vZGVzQXJyYXk9dH1lLl9pbmRleEluU2NlbmVUcmFuc2Zvcm1Ob2Rlc0FycmF5PS0xLHRoaXMudHJhbnNmb3JtTm9kZXMucG9wKCksZS5wYXJlbnR8fGUuX3JlbW92ZUZyb21TY2VuZVJvb3ROb2RlcygpfXJldHVybiB0aGlzLm9uVHJhbnNmb3JtTm9kZVJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fXJlbW92ZVNrZWxldG9uKGUpe2NvbnN0IHQ9dGhpcy5za2VsZXRvbnMuaW5kZXhPZihlKTtyZXR1cm4gdCE9PS0xJiYodGhpcy5za2VsZXRvbnMuc3BsaWNlKHQsMSksdGhpcy5vblNrZWxldG9uUmVtb3ZlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLHRoaXMuX2V4ZWN1dGVBY3RpdmVDb250YWluZXJDbGVhbnVwKHRoaXMuX2FjdGl2ZVNrZWxldG9ucykpLHR9cmVtb3ZlTW9ycGhUYXJnZXRNYW5hZ2VyKGUpe2NvbnN0IHQ9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLnNwbGljZSh0LDEpLHR9cmVtb3ZlTGlnaHQoZSl7Y29uc3QgdD10aGlzLmxpZ2h0cy5pbmRleE9mKGUpO2lmKHQhPT0tMSl7Zm9yKGNvbnN0IGkgb2YgdGhpcy5tZXNoZXMpaS5fcmVtb3ZlTGlnaHRTb3VyY2UoZSwhMSk7dGhpcy5saWdodHMuc3BsaWNlKHQsMSksdGhpcy5zb3J0TGlnaHRzQnlQcmlvcml0eSgpLGUucGFyZW50fHxlLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKX1yZXR1cm4gdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpLHR9cmVtb3ZlQ2FtZXJhKGUpe2NvbnN0IHQ9dGhpcy5jYW1lcmFzLmluZGV4T2YoZSk7aWYodCE9PS0xJiYodGhpcy5jYW1lcmFzLnNwbGljZSh0LDEpLGUucGFyZW50fHxlLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKSksdGhpcy5hY3RpdmVDYW1lcmFzKXtjb25zdCBpPXRoaXMuYWN0aXZlQ2FtZXJhcy5pbmRleE9mKGUpO2khPT0tMSYmdGhpcy5hY3RpdmVDYW1lcmFzLnNwbGljZShpLDEpfXJldHVybiB0aGlzLmFjdGl2ZUNhbWVyYT09PWUmJih0aGlzLmNhbWVyYXMubGVuZ3RoPjA/dGhpcy5hY3RpdmVDYW1lcmE9dGhpcy5jYW1lcmFzWzBdOnRoaXMuYWN0aXZlQ2FtZXJhPW51bGwpLHRoaXMub25DYW1lcmFSZW1vdmVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksdH1yZW1vdmVQYXJ0aWNsZVN5c3RlbShlKXtjb25zdCB0PXRoaXMucGFydGljbGVTeXN0ZW1zLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmKHRoaXMucGFydGljbGVTeXN0ZW1zLnNwbGljZSh0LDEpLHRoaXMuX2V4ZWN1dGVBY3RpdmVDb250YWluZXJDbGVhbnVwKHRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcykpLHR9cmVtb3ZlQW5pbWF0aW9uKGUpe2NvbnN0IHQ9dGhpcy5hbmltYXRpb25zLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5hbmltYXRpb25zLnNwbGljZSh0LDEpLHR9c3RvcEFuaW1hdGlvbihlLHQsaSl7fXJlbW92ZUFuaW1hdGlvbkdyb3VwKGUpe2NvbnN0IHQ9dGhpcy5hbmltYXRpb25Hcm91cHMuaW5kZXhPZihlKTtyZXR1cm4gdCE9PS0xJiZ0aGlzLmFuaW1hdGlvbkdyb3Vwcy5zcGxpY2UodCwxKSx0fXJlbW92ZU11bHRpTWF0ZXJpYWwoZSl7Y29uc3QgdD10aGlzLm11bHRpTWF0ZXJpYWxzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5tdWx0aU1hdGVyaWFscy5zcGxpY2UodCwxKSx0aGlzLm9uTXVsdGlNYXRlcmlhbFJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fXJlbW92ZU1hdGVyaWFsKGUpe2NvbnN0IHQ9ZS5faW5kZXhJblNjZW5lTWF0ZXJpYWxBcnJheTtpZih0IT09LTEmJnQ8dGhpcy5tYXRlcmlhbHMubGVuZ3RoKXtpZih0IT09dGhpcy5tYXRlcmlhbHMubGVuZ3RoLTEpe2NvbnN0IGk9dGhpcy5tYXRlcmlhbHNbdGhpcy5tYXRlcmlhbHMubGVuZ3RoLTFdO3RoaXMubWF0ZXJpYWxzW3RdPWksaS5faW5kZXhJblNjZW5lTWF0ZXJpYWxBcnJheT10fWUuX2luZGV4SW5TY2VuZU1hdGVyaWFsQXJyYXk9LTEsdGhpcy5tYXRlcmlhbHMucG9wKCl9cmV0dXJuIHRoaXMub25NYXRlcmlhbFJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fXJlbW92ZUFjdGlvbk1hbmFnZXIoZSl7Y29uc3QgdD10aGlzLmFjdGlvbk1hbmFnZXJzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy5hY3Rpb25NYW5hZ2Vycy5zcGxpY2UodCwxKSx0fXJlbW92ZVRleHR1cmUoZSl7Y29uc3QgdD10aGlzLnRleHR1cmVzLmluZGV4T2YoZSk7cmV0dXJuIHQhPT0tMSYmdGhpcy50ZXh0dXJlcy5zcGxpY2UodCwxKSx0aGlzLm9uVGV4dHVyZVJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0fWFkZExpZ2h0KGUpe2lmKCF0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb24pe3RoaXMubGlnaHRzLnB1c2goZSksdGhpcy5zb3J0TGlnaHRzQnlQcmlvcml0eSgpLGUucGFyZW50fHxlLl9hZGRUb1NjZW5lUm9vdE5vZGVzKCk7Zm9yKGNvbnN0IHQgb2YgdGhpcy5tZXNoZXMpdC5saWdodFNvdXJjZXMuaW5kZXhPZihlKT09PS0xJiYodC5saWdodFNvdXJjZXMucHVzaChlKSx0Ll9yZXN5bmNMaWdodFNvdXJjZXMoKSk7dGhpcy5vbk5ld0xpZ2h0QWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKX19c29ydExpZ2h0c0J5UHJpb3JpdHkoKXt0aGlzLnJlcXVpcmVMaWdodFNvcnRpbmcmJnRoaXMubGlnaHRzLnNvcnQoRWUuQ29tcGFyZUxpZ2h0c1ByaW9yaXR5KX1hZGRDYW1lcmEoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5jYW1lcmFzLnB1c2goZSksdGhpcy5vbk5ld0NhbWVyYUFkZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSksZS5wYXJlbnR8fGUuX2FkZFRvU2NlbmVSb290Tm9kZXMoKSl9YWRkU2tlbGV0b24oZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5za2VsZXRvbnMucHVzaChlKSx0aGlzLm9uTmV3U2tlbGV0b25BZGRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKX1hZGRQYXJ0aWNsZVN5c3RlbShlKXt0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb258fHRoaXMucGFydGljbGVTeXN0ZW1zLnB1c2goZSl9YWRkQW5pbWF0aW9uKGUpe3RoaXMuX2Jsb2NrRW50aXR5Q29sbGVjdGlvbnx8dGhpcy5hbmltYXRpb25zLnB1c2goZSl9YWRkQW5pbWF0aW9uR3JvdXAoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHx0aGlzLmFuaW1hdGlvbkdyb3Vwcy5wdXNoKGUpfWFkZE11bHRpTWF0ZXJpYWwoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy5tdWx0aU1hdGVyaWFscy5wdXNoKGUpLHRoaXMub25OZXdNdWx0aU1hdGVyaWFsQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSl9YWRkTWF0ZXJpYWwoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHxlLmdldFNjZW5lKCk9PT10aGlzJiZlLl9pbmRleEluU2NlbmVNYXRlcmlhbEFycmF5IT09LTF8fChlLl9pbmRleEluU2NlbmVNYXRlcmlhbEFycmF5PXRoaXMubWF0ZXJpYWxzLmxlbmd0aCx0aGlzLm1hdGVyaWFscy5wdXNoKGUpLHRoaXMub25OZXdNYXRlcmlhbEFkZGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSkpfWFkZE1vcnBoVGFyZ2V0TWFuYWdlcihlKXt0aGlzLl9ibG9ja0VudGl0eUNvbGxlY3Rpb258fHRoaXMubW9ycGhUYXJnZXRNYW5hZ2Vycy5wdXNoKGUpfWFkZEdlb21ldHJ5KGUpe3RoaXMuX2Jsb2NrRW50aXR5Q29sbGVjdGlvbnx8KHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkJiYodGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWRbZS51bmlxdWVJZF09dGhpcy5nZW9tZXRyaWVzLmxlbmd0aCksdGhpcy5nZW9tZXRyaWVzLnB1c2goZSkpfWFkZEFjdGlvbk1hbmFnZXIoZSl7dGhpcy5hY3Rpb25NYW5hZ2Vycy5wdXNoKGUpfWFkZFRleHR1cmUoZSl7dGhpcy5fYmxvY2tFbnRpdHlDb2xsZWN0aW9ufHwodGhpcy50ZXh0dXJlcy5wdXNoKGUpLHRoaXMub25OZXdUZXh0dXJlQWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSl9c3dpdGNoQWN0aXZlQ2FtZXJhKGUsdD0hMCl7dGhpcy5fZW5naW5lLmdldElucHV0RWxlbWVudCgpJiYodGhpcy5hY3RpdmVDYW1lcmEmJnRoaXMuYWN0aXZlQ2FtZXJhLmRldGFjaENvbnRyb2woKSx0aGlzLmFjdGl2ZUNhbWVyYT1lLHQmJmUuYXR0YWNoQ29udHJvbCgpKX1zZXRBY3RpdmVDYW1lcmFCeUlkKGUpe2NvbnN0IHQ9dGhpcy5nZXRDYW1lcmFCeUlkKGUpO3JldHVybiB0Pyh0aGlzLmFjdGl2ZUNhbWVyYT10LHQpOm51bGx9c2V0QWN0aXZlQ2FtZXJhQnlOYW1lKGUpe2NvbnN0IHQ9dGhpcy5nZXRDYW1lcmFCeU5hbWUoZSk7cmV0dXJuIHQ/KHRoaXMuYWN0aXZlQ2FtZXJhPXQsdCk6bnVsbH1nZXRBbmltYXRpb25Hcm91cEJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMuYW5pbWF0aW9uR3JvdXBzLmxlbmd0aDt0KyspaWYodGhpcy5hbmltYXRpb25Hcm91cHNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMuYW5pbWF0aW9uR3JvdXBzW3RdO3JldHVybiBudWxsfV9nZXRNYXRlcmlhbChlLHQpe2ZvcihsZXQgaT0wO2k8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO2krKyl7Y29uc3Qgcz10aGlzLm1hdGVyaWFsc1tpXTtpZih0KHMpKXJldHVybiBzfWlmKGUpZm9yKGxldCBpPTA7aTx0aGlzLm11bHRpTWF0ZXJpYWxzLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5tdWx0aU1hdGVyaWFsc1tpXTtpZih0KHMpKXJldHVybiBzfXJldHVybiBudWxsfWdldE1hdGVyaWFsQnlVbmlxdWVJRChlLHQ9ITEpe3JldHVybiB0aGlzLl9nZXRNYXRlcmlhbCh0LGk9PmkudW5pcXVlSWQ9PT1lKX1nZXRNYXRlcmlhbEJ5SWQoZSx0PSExKXtyZXR1cm4gdGhpcy5fZ2V0TWF0ZXJpYWwodCxpPT5pLmlkPT09ZSl9Z2V0TWF0ZXJpYWxCeU5hbWUoZSx0PSExKXtyZXR1cm4gdGhpcy5fZ2V0TWF0ZXJpYWwodCxpPT5pLm5hbWU9PT1lKX1nZXRMYXN0TWF0ZXJpYWxCeUlkKGUsdD0hMSl7Zm9yKGxldCBpPXRoaXMubWF0ZXJpYWxzLmxlbmd0aC0xO2k+PTA7aS0tKWlmKHRoaXMubWF0ZXJpYWxzW2ldLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbHNbaV07aWYodCl7Zm9yKGxldCBpPXRoaXMubXVsdGlNYXRlcmlhbHMubGVuZ3RoLTE7aT49MDtpLS0paWYodGhpcy5tdWx0aU1hdGVyaWFsc1tpXS5pZD09PWUpcmV0dXJuIHRoaXMubXVsdGlNYXRlcmlhbHNbaV19cmV0dXJuIG51bGx9Z2V0VGV4dHVyZUJ5VW5pcXVlSWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRleHR1cmVzLmxlbmd0aDt0KyspaWYodGhpcy50ZXh0dXJlc1t0XS51bmlxdWVJZD09PWUpcmV0dXJuIHRoaXMudGV4dHVyZXNbdF07cmV0dXJuIG51bGx9Z2V0VGV4dHVyZUJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMudGV4dHVyZXMubGVuZ3RoO3QrKylpZih0aGlzLnRleHR1cmVzW3RdLm5hbWU9PT1lKXJldHVybiB0aGlzLnRleHR1cmVzW3RdO3JldHVybiBudWxsfWdldENhbWVyYUJ5SWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmNhbWVyYXMubGVuZ3RoO3QrKylpZih0aGlzLmNhbWVyYXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLmNhbWVyYXNbdF07cmV0dXJuIG51bGx9Z2V0Q2FtZXJhQnlVbmlxdWVJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuY2FtZXJhcy5sZW5ndGg7dCsrKWlmKHRoaXMuY2FtZXJhc1t0XS51bmlxdWVJZD09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtyZXR1cm4gbnVsbH1nZXRDYW1lcmFCeU5hbWUoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmNhbWVyYXMubGVuZ3RoO3QrKylpZih0aGlzLmNhbWVyYXNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtyZXR1cm4gbnVsbH1nZXRCb25lQnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuc2tlbGV0b25zLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5za2VsZXRvbnNbdF07Zm9yKGxldCBzPTA7czxpLmJvbmVzLmxlbmd0aDtzKyspaWYoaS5ib25lc1tzXS5pZD09PWUpcmV0dXJuIGkuYm9uZXNbc119cmV0dXJuIG51bGx9Z2V0Qm9uZUJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMuc2tlbGV0b25zLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5za2VsZXRvbnNbdF07Zm9yKGxldCBzPTA7czxpLmJvbmVzLmxlbmd0aDtzKyspaWYoaS5ib25lc1tzXS5uYW1lPT09ZSlyZXR1cm4gaS5ib25lc1tzXX1yZXR1cm4gbnVsbH1nZXRMaWdodEJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMubGlnaHRzLmxlbmd0aDt0KyspaWYodGhpcy5saWdodHNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMubGlnaHRzW3RdO3JldHVybiBudWxsfWdldExpZ2h0QnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubGlnaHRzLmxlbmd0aDt0KyspaWYodGhpcy5saWdodHNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLmxpZ2h0c1t0XTtyZXR1cm4gbnVsbH1nZXRMaWdodEJ5VW5pcXVlSWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLmxpZ2h0cy5sZW5ndGg7dCsrKWlmKHRoaXMubGlnaHRzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5saWdodHNbdF07cmV0dXJuIG51bGx9Z2V0UGFydGljbGVTeXN0ZW1CeUlkKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO3QrKylpZih0aGlzLnBhcnRpY2xlU3lzdGVtc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMucGFydGljbGVTeXN0ZW1zW3RdO3JldHVybiBudWxsfWdldEdlb21ldHJ5QnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7dCsrKWlmKHRoaXMuZ2VvbWV0cmllc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuZ2VvbWV0cmllc1t0XTtyZXR1cm4gbnVsbH1fZ2V0R2VvbWV0cnlCeVVuaXF1ZUlkKGUpe2lmKHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkKXtjb25zdCB0PXRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkW2VdO2lmKHQhPT12b2lkIDApcmV0dXJuIHRoaXMuZ2VvbWV0cmllc1t0XX1lbHNlIGZvcihsZXQgdD0wO3Q8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDt0KyspaWYodGhpcy5nZW9tZXRyaWVzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5nZW9tZXRyaWVzW3RdO3JldHVybiBudWxsfXB1c2hHZW9tZXRyeShlLHQpe3JldHVybiF0JiZ0aGlzLl9nZXRHZW9tZXRyeUJ5VW5pcXVlSWQoZS51bmlxdWVJZCk/ITE6KHRoaXMuYWRkR2VvbWV0cnkoZSksdGhpcy5vbk5ld0dlb21ldHJ5QWRkZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSwhMCl9cmVtb3ZlR2VvbWV0cnkoZSl7bGV0IHQ7aWYodGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWQpe2lmKHQ9dGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWRbZS51bmlxdWVJZF0sdD09PXZvaWQgMClyZXR1cm4hMX1lbHNlIGlmKHQ9dGhpcy5nZW9tZXRyaWVzLmluZGV4T2YoZSksdDwwKXJldHVybiExO2lmKHQhPT10aGlzLmdlb21ldHJpZXMubGVuZ3RoLTEpe2NvbnN0IGk9dGhpcy5nZW9tZXRyaWVzW3RoaXMuZ2VvbWV0cmllcy5sZW5ndGgtMV07aSYmKHRoaXMuZ2VvbWV0cmllc1t0XT1pLHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkJiYodGhpcy5fZ2VvbWV0cmllc0J5VW5pcXVlSWRbaS51bmlxdWVJZF09dCkpfXJldHVybiB0aGlzLl9nZW9tZXRyaWVzQnlVbmlxdWVJZCYmKHRoaXMuX2dlb21ldHJpZXNCeVVuaXF1ZUlkW2UudW5pcXVlSWRdPXZvaWQgMCksdGhpcy5nZW9tZXRyaWVzLnBvcCgpLHRoaXMub25HZW9tZXRyeVJlbW92ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSwhMH1nZXRHZW9tZXRyaWVzKCl7cmV0dXJuIHRoaXMuZ2VvbWV0cmllc31nZXRNZXNoQnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0uaWQ9PT1lKXJldHVybiB0aGlzLm1lc2hlc1t0XTtyZXR1cm4gbnVsbH1nZXRNZXNoZXNCeUlkKGUpe3JldHVybiB0aGlzLm1lc2hlcy5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIHQuaWQ9PT1lfSl9Z2V0VHJhbnNmb3JtTm9kZUJ5SWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aDt0KyspaWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMudHJhbnNmb3JtTm9kZXNbdF07cmV0dXJuIG51bGx9Z2V0VHJhbnNmb3JtTm9kZUJ5VW5pcXVlSWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aDt0KyspaWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS51bmlxdWVJZD09PWUpcmV0dXJuIHRoaXMudHJhbnNmb3JtTm9kZXNbdF07cmV0dXJuIG51bGx9Z2V0VHJhbnNmb3JtTm9kZXNCeUlkKGUpe3JldHVybiB0aGlzLnRyYW5zZm9ybU5vZGVzLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gdC5pZD09PWV9KX1nZXRNZXNoQnlVbmlxdWVJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0udW5pcXVlSWQ9PT1lKXJldHVybiB0aGlzLm1lc2hlc1t0XTtyZXR1cm4gbnVsbH1nZXRMYXN0TWVzaEJ5SWQoZSl7Zm9yKGxldCB0PXRoaXMubWVzaGVzLmxlbmd0aC0xO3Q+PTA7dC0tKWlmKHRoaXMubWVzaGVzW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5tZXNoZXNbdF07cmV0dXJuIG51bGx9Z2V0TGFzdEVudHJ5QnlJZChlKXtsZXQgdDtmb3IodD10aGlzLm1lc2hlcy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLm1lc2hlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubWVzaGVzW3RdO2Zvcih0PXRoaXMudHJhbnNmb3JtTm9kZXMubGVuZ3RoLTE7dD49MDt0LS0paWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMudHJhbnNmb3JtTm9kZXNbdF07Zm9yKHQ9dGhpcy5jYW1lcmFzLmxlbmd0aC0xO3Q+PTA7dC0tKWlmKHRoaXMuY2FtZXJhc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuY2FtZXJhc1t0XTtmb3IodD10aGlzLmxpZ2h0cy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLmxpZ2h0c1t0XS5pZD09PWUpcmV0dXJuIHRoaXMubGlnaHRzW3RdO3JldHVybiBudWxsfWdldE5vZGVCeUlkKGUpe2NvbnN0IHQ9dGhpcy5nZXRNZXNoQnlJZChlKTtpZih0KXJldHVybiB0O2NvbnN0IGk9dGhpcy5nZXRUcmFuc2Zvcm1Ob2RlQnlJZChlKTtpZihpKXJldHVybiBpO2NvbnN0IHM9dGhpcy5nZXRMaWdodEJ5SWQoZSk7aWYocylyZXR1cm4gcztjb25zdCByPXRoaXMuZ2V0Q2FtZXJhQnlJZChlKTtpZihyKXJldHVybiByO2NvbnN0IG49dGhpcy5nZXRCb25lQnlJZChlKTtyZXR1cm4gbnx8bnVsbH1nZXROb2RlQnlOYW1lKGUpe2NvbnN0IHQ9dGhpcy5nZXRNZXNoQnlOYW1lKGUpO2lmKHQpcmV0dXJuIHQ7Y29uc3QgaT10aGlzLmdldFRyYW5zZm9ybU5vZGVCeU5hbWUoZSk7aWYoaSlyZXR1cm4gaTtjb25zdCBzPXRoaXMuZ2V0TGlnaHRCeU5hbWUoZSk7aWYocylyZXR1cm4gcztjb25zdCByPXRoaXMuZ2V0Q2FtZXJhQnlOYW1lKGUpO2lmKHIpcmV0dXJuIHI7Y29uc3Qgbj10aGlzLmdldEJvbmVCeU5hbWUoZSk7cmV0dXJuIG58fG51bGx9Z2V0TWVzaEJ5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMubWVzaGVzLmxlbmd0aDt0KyspaWYodGhpcy5tZXNoZXNbdF0ubmFtZT09PWUpcmV0dXJuIHRoaXMubWVzaGVzW3RdO3JldHVybiBudWxsfWdldFRyYW5zZm9ybU5vZGVCeU5hbWUoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYW5zZm9ybU5vZGVzLmxlbmd0aDt0KyspaWYodGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy50cmFuc2Zvcm1Ob2Rlc1t0XTtyZXR1cm4gbnVsbH1nZXRMYXN0U2tlbGV0b25CeUlkKGUpe2ZvcihsZXQgdD10aGlzLnNrZWxldG9ucy5sZW5ndGgtMTt0Pj0wO3QtLSlpZih0aGlzLnNrZWxldG9uc1t0XS5pZD09PWUpcmV0dXJuIHRoaXMuc2tlbGV0b25zW3RdO3JldHVybiBudWxsfWdldFNrZWxldG9uQnlVbmlxdWVJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMuc2tlbGV0b25zLmxlbmd0aDt0KyspaWYodGhpcy5za2VsZXRvbnNbdF0udW5pcXVlSWQ9PT1lKXJldHVybiB0aGlzLnNrZWxldG9uc1t0XTtyZXR1cm4gbnVsbH1nZXRTa2VsZXRvbkJ5SWQoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWlmKHRoaXMuc2tlbGV0b25zW3RdLmlkPT09ZSlyZXR1cm4gdGhpcy5za2VsZXRvbnNbdF07cmV0dXJuIG51bGx9Z2V0U2tlbGV0b25CeU5hbWUoZSl7Zm9yKGxldCB0PTA7dDx0aGlzLnNrZWxldG9ucy5sZW5ndGg7dCsrKWlmKHRoaXMuc2tlbGV0b25zW3RdLm5hbWU9PT1lKXJldHVybiB0aGlzLnNrZWxldG9uc1t0XTtyZXR1cm4gbnVsbH1nZXRNb3JwaFRhcmdldE1hbmFnZXJCeUlkKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLmxlbmd0aDt0KyspaWYodGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzW3RdLnVuaXF1ZUlkPT09ZSlyZXR1cm4gdGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzW3RdO3JldHVybiBudWxsfWdldE1vcnBoVGFyZ2V0QnlJZChlKXtmb3IobGV0IHQ9MDt0PHRoaXMubW9ycGhUYXJnZXRNYW5hZ2Vycy5sZW5ndGg7Kyt0KXtjb25zdCBpPXRoaXMubW9ycGhUYXJnZXRNYW5hZ2Vyc1t0XTtmb3IobGV0IHM9MDtzPGkubnVtVGFyZ2V0czsrK3Mpe2NvbnN0IHI9aS5nZXRUYXJnZXQocyk7aWYoci5pZD09PWUpcmV0dXJuIHJ9fXJldHVybiBudWxsfWdldE1vcnBoVGFyZ2V0QnlOYW1lKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzLmxlbmd0aDsrK3Qpe2NvbnN0IGk9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXJzW3RdO2ZvcihsZXQgcz0wO3M8aS5udW1UYXJnZXRzOysrcyl7Y29uc3Qgcj1pLmdldFRhcmdldChzKTtpZihyLm5hbWU9PT1lKXJldHVybiByfX1yZXR1cm4gbnVsbH1nZXRQb3N0UHJvY2Vzc0J5TmFtZShlKXtmb3IobGV0IHQ9MDt0PHRoaXMucG9zdFByb2Nlc3Nlcy5sZW5ndGg7Kyt0KXtjb25zdCBpPXRoaXMucG9zdFByb2Nlc3Nlc1t0XTtpZihpLm5hbWU9PT1lKXJldHVybiBpfXJldHVybiBudWxsfWlzQWN0aXZlTWVzaChlKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzLmluZGV4T2YoZSkhPT0tMX1nZXQgdWlkKCl7cmV0dXJuIHRoaXMuX3VpZHx8KHRoaXMuX3VpZD1ILlJhbmRvbUlkKCkpLHRoaXMuX3VpZH1hZGRFeHRlcm5hbERhdGEoZSx0KXtyZXR1cm4gdGhpcy5fZXh0ZXJuYWxEYXRhfHwodGhpcy5fZXh0ZXJuYWxEYXRhPW5ldyBjciksdGhpcy5fZXh0ZXJuYWxEYXRhLmFkZChlLHQpfWdldEV4dGVybmFsRGF0YShlKXtyZXR1cm4gdGhpcy5fZXh0ZXJuYWxEYXRhP3RoaXMuX2V4dGVybmFsRGF0YS5nZXQoZSk6bnVsbH1nZXRPckFkZEV4dGVybmFsRGF0YVdpdGhGYWN0b3J5KGUsdCl7cmV0dXJuIHRoaXMuX2V4dGVybmFsRGF0YXx8KHRoaXMuX2V4dGVybmFsRGF0YT1uZXcgY3IpLHRoaXMuX2V4dGVybmFsRGF0YS5nZXRPckFkZFdpdGhGYWN0b3J5KGUsdCl9cmVtb3ZlRXh0ZXJuYWxEYXRhKGUpe3JldHVybiB0aGlzLl9leHRlcm5hbERhdGEucmVtb3ZlKGUpfV9ldmFsdWF0ZVN1Yk1lc2goZSx0LGkscyl7aWYoc3x8ZS5pc0luRnJ1c3R1bSh0aGlzLl9mcnVzdHVtUGxhbmVzKSl7Zm9yKGNvbnN0IG4gb2YgdGhpcy5fZXZhbHVhdGVTdWJNZXNoU3RhZ2Upbi5hY3Rpb24odCxlKTtjb25zdCByPWUuZ2V0TWF0ZXJpYWwoKTtyIT1udWxsJiYoci5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyYmci5nZXRSZW5kZXJUYXJnZXRUZXh0dXJlcyE9bnVsbCYmdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLmluZGV4T2Yocik9PT0tMSYmKHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5wdXNoKHIpLHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKHIuZ2V0UmVuZGVyVGFyZ2V0VGV4dHVyZXMoKSkpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIuZGlzcGF0Y2goZSx0LHIpKX19ZnJlZVByb2Nlc3NlZE1hdGVyaWFscygpe3RoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5kaXNwb3NlKCl9Z2V0IGJsb2NrZnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3Vwcygpe3JldHVybiB0aGlzLl9wcmV2ZW50RnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3Vwc31zZXQgYmxvY2tmcmVlQWN0aXZlTWVzaGVzQW5kUmVuZGVyaW5nR3JvdXBzKGUpe3RoaXMuX3ByZXZlbnRGcmVlQWN0aXZlTWVzaGVzQW5kUmVuZGVyaW5nR3JvdXBzIT09ZSYmKGUmJih0aGlzLmZyZWVBY3RpdmVNZXNoZXMoKSx0aGlzLmZyZWVSZW5kZXJpbmdHcm91cHMoKSksdGhpcy5fcHJldmVudEZyZWVBY3RpdmVNZXNoZXNBbmRSZW5kZXJpbmdHcm91cHM9ZSl9ZnJlZUFjdGl2ZU1lc2hlcygpe2lmKCF0aGlzLmJsb2NrZnJlZUFjdGl2ZU1lc2hlc0FuZFJlbmRlcmluZ0dyb3VwcyYmKHRoaXMuX2FjdGl2ZU1lc2hlcy5kaXNwb3NlKCksdGhpcy5hY3RpdmVDYW1lcmEmJnRoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMmJnRoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMuZGlzcG9zZSgpLHRoaXMuYWN0aXZlQ2FtZXJhcykpZm9yKGxldCBlPTA7ZTx0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoO2UrKyl7Y29uc3QgdD10aGlzLmFjdGl2ZUNhbWVyYXNbZV07dCYmdC5fYWN0aXZlTWVzaGVzJiZ0Ll9hY3RpdmVNZXNoZXMuZGlzcG9zZSgpfX1mcmVlUmVuZGVyaW5nR3JvdXBzKCl7aWYoIXRoaXMuYmxvY2tmcmVlQWN0aXZlTWVzaGVzQW5kUmVuZGVyaW5nR3JvdXBzJiYodGhpcy5fcmVuZGVyaW5nTWFuYWdlciYmdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5mcmVlUmVuZGVyaW5nR3JvdXBzKCksdGhpcy50ZXh0dXJlcykpZm9yKGxldCBlPTA7ZTx0aGlzLnRleHR1cmVzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy50ZXh0dXJlc1tlXTt0JiZ0LnJlbmRlckxpc3QmJnQuZnJlZVJlbmRlcmluZ0dyb3VwcygpfX1faXNJbkludGVybWVkaWF0ZVJlbmRlcmluZygpe3JldHVybiB0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmd9ZnJlZXplQWN0aXZlTWVzaGVzKGU9ITEsdCxpLHM9ITAscj0hMSl7cmV0dXJuIHRoaXMuZXhlY3V0ZVdoZW5SZWFkeSgoKT0+e2lmKCF0aGlzLmFjdGl2ZUNhbWVyYSl7aSYmaSgiTm8gYWN0aXZlIGNhbWVyYSBmb3VuZCIpO3JldHVybn1pZih0aGlzLl9mcnVzdHVtUGxhbmVzfHx0aGlzLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLHRoaXMuX2V2YWx1YXRlQWN0aXZlTWVzaGVzKCksdGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuPSEwLHRoaXMuX2FjdGl2ZU1lc2hlc0Zyb3plbkJ1dEtlZXBDbGlwcGluZz1yLHRoaXMuX3NraXBFdmFsdWF0ZUFjdGl2ZU1lc2hlc0NvbXBsZXRlbHk9ZSxzKWZvcihsZXQgbj0wO248dGhpcy5fYWN0aXZlTWVzaGVzLmxlbmd0aDtuKyspdGhpcy5fYWN0aXZlTWVzaGVzLmRhdGFbbl0uX2ZyZWV6ZSgpO3QmJnQoKX0pLHRoaXN9dW5mcmVlemVBY3RpdmVNZXNoZXMoKXtmb3IobGV0IGU9MDtlPHRoaXMubWVzaGVzLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5tZXNoZXNbZV07dC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mbyYmKHQuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlPSExKX1mb3IobGV0IGU9MDtlPHRoaXMuX2FjdGl2ZU1lc2hlcy5sZW5ndGg7ZSsrKXRoaXMuX2FjdGl2ZU1lc2hlcy5kYXRhW2VdLl91bkZyZWV6ZSgpO3JldHVybiB0aGlzLl9hY3RpdmVNZXNoZXNGcm96ZW49ITEsdGhpc31fZXhlY3V0ZUFjdGl2ZUNvbnRhaW5lckNsZWFudXAoZSl7ISh0aGlzLl9lbmdpbmUuc25hcHNob3RSZW5kZXJpbmcmJnRoaXMuX2VuZ2luZS5zbmFwc2hvdFJlbmRlcmluZ01vZGU9PT0xKSYmdGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuJiZ0aGlzLl9hY3RpdmVNZXNoZXMubGVuZ3RofHx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGRPbmNlKCgpPT5lLmRpc3Bvc2UoKSl9X2V2YWx1YXRlQWN0aXZlTWVzaGVzKCl7dmFyIGU7aWYodGhpcy5fZW5naW5lLnNuYXBzaG90UmVuZGVyaW5nJiZ0aGlzLl9lbmdpbmUuc25hcHNob3RSZW5kZXJpbmdNb2RlPT09MSl7dGhpcy5fYWN0aXZlTWVzaGVzLmxlbmd0aD4wJiYoKGU9dGhpcy5hY3RpdmVDYW1lcmEpPT09bnVsbHx8ZT09PXZvaWQgMHx8ZS5fYWN0aXZlTWVzaGVzLnJlc2V0KCksdGhpcy5fYWN0aXZlTWVzaGVzLnJlc2V0KCksdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5yZXNldCgpLHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5yZXNldCgpLHRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcy5yZXNldCgpLHRoaXMuX2FjdGl2ZVNrZWxldG9ucy5yZXNldCgpLHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5yZXNldCgpKTtyZXR1cm59aWYodGhpcy5fYWN0aXZlTWVzaGVzRnJvemVuJiZ0aGlzLl9hY3RpdmVNZXNoZXMubGVuZ3RoKXtpZighdGhpcy5fc2tpcEV2YWx1YXRlQWN0aXZlTWVzaGVzQ29tcGxldGVseSl7Y29uc3Qgcz10aGlzLl9hY3RpdmVNZXNoZXMubGVuZ3RoO2ZvcihsZXQgcj0wO3I8cztyKyspdGhpcy5fYWN0aXZlTWVzaGVzLmRhdGFbcl0uY29tcHV0ZVdvcmxkTWF0cml4KCl9aWYodGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zKXtjb25zdCBzPXRoaXMuX2FjdGl2ZVBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7Zm9yKGxldCByPTA7cjxzO3IrKyl0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXMuZGF0YVtyXS5hbmltYXRlKCl9dGhpcy5fcmVuZGVyaW5nTWFuYWdlci5yZXNldFNwcml0ZXMoKTtyZXR1cm59aWYoIXRoaXMuYWN0aXZlQ2FtZXJhKXJldHVybjt0aGlzLm9uQmVmb3JlQWN0aXZlTWVzaGVzRXZhbHVhdGlvbk9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuYWN0aXZlQ2FtZXJhLl9hY3RpdmVNZXNoZXMucmVzZXQoKSx0aGlzLl9hY3RpdmVNZXNoZXMucmVzZXQoKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlc2V0KCksdGhpcy5fcHJvY2Vzc2VkTWF0ZXJpYWxzLnJlc2V0KCksdGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zLnJlc2V0KCksdGhpcy5fYWN0aXZlU2tlbGV0b25zLnJlc2V0KCksdGhpcy5fc29mdHdhcmVTa2lubmVkTWVzaGVzLnJlc2V0KCksdGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cy5yZXNldCgpO2Zvcihjb25zdCBzIG9mIHRoaXMuX2JlZm9yZUV2YWx1YXRlQWN0aXZlTWVzaFN0YWdlKXMuYWN0aW9uKCk7Y29uc3QgdD10aGlzLmdldEFjdGl2ZU1lc2hDYW5kaWRhdGVzKCksaT10Lmxlbmd0aDtmb3IobGV0IHM9MDtzPGk7cysrKXtjb25zdCByPXQuZGF0YVtzXTtpZihyLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9jdXJyZW50TE9ESXNVcFRvRGF0ZT0hMSxyLmlzQmxvY2tlZHx8KHRoaXMuX3RvdGFsVmVydGljZXMuYWRkQ291bnQoci5nZXRUb3RhbFZlcnRpY2VzKCksITEpLCFyLmlzUmVhZHkoKXx8IXIuaXNFbmFibGVkKCl8fHIuc2NhbGluZy5oYXNBWmVyb0NvbXBvbmVudCkpY29udGludWU7ci5jb21wdXRlV29ybGRNYXRyaXgoKSxyLmFjdGlvbk1hbmFnZXImJnIuYWN0aW9uTWFuYWdlci5oYXNTcGVjaWZpY1RyaWdnZXJzMigxMiwxMykmJnRoaXMuX21lc2hlc0ZvckludGVyc2VjdGlvbnMucHVzaE5vRHVwbGljYXRlKHIpO2xldCBuPXRoaXMuY3VzdG9tTE9EU2VsZWN0b3I/dGhpcy5jdXN0b21MT0RTZWxlY3RvcihyLHRoaXMuYWN0aXZlQ2FtZXJhKTpyLmdldExPRCh0aGlzLmFjdGl2ZUNhbWVyYSk7aWYoci5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY3VycmVudExPRD1uLHIuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0RJc1VwVG9EYXRlPSEwLG4hPW51bGwmJihuIT09ciYmbi5iaWxsYm9hcmRNb2RlIT09MCYmbi5jb21wdXRlV29ybGRNYXRyaXgoKSxyLl9wcmVBY3RpdmF0ZSgpLHIuaXNWaXNpYmxlJiZyLnZpc2liaWxpdHk+MCYmci5sYXllck1hc2smdGhpcy5hY3RpdmVDYW1lcmEubGF5ZXJNYXNrJiYodGhpcy5fc2tpcEZydXN0dW1DbGlwcGluZ3x8ci5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2h8fHIuaXNJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcykpKSl7dGhpcy5fYWN0aXZlTWVzaGVzLnB1c2gociksdGhpcy5hY3RpdmVDYW1lcmEuX2FjdGl2ZU1lc2hlcy5wdXNoKHIpLG4hPT1yJiZuLl9hY3RpdmF0ZSh0aGlzLl9yZW5kZXJJZCwhMSk7Zm9yKGNvbnN0IGEgb2YgdGhpcy5fcHJlQWN0aXZlTWVzaFN0YWdlKWEuYWN0aW9uKHIpO3IuX2FjdGl2YXRlKHRoaXMuX3JlbmRlcklkLCExKSYmKHIuaXNBbkluc3RhbmNlP3IuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FjdEFzUmVndWxhck1lc2gmJihuPXIpOm4uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX29ubHlGb3JJbnN0YW5jZXM9ITEsbi5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faXNBY3RpdmU9ITAsdGhpcy5fYWN0aXZlTWVzaChyLG4pKSxyLl9wb3N0QWN0aXZhdGUoKX19aWYodGhpcy5wYXJ0aWNsZXNFbmFibGVkKXt0aGlzLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7Zm9yKGxldCBzPTA7czx0aGlzLnBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7cysrKXtjb25zdCByPXRoaXMucGFydGljbGVTeXN0ZW1zW3NdO2lmKCFyLmlzU3RhcnRlZCgpfHwhci5lbWl0dGVyKWNvbnRpbnVlO2NvbnN0IG49ci5lbWl0dGVyOyghbi5wb3NpdGlvbnx8bi5pc0VuYWJsZWQoKSkmJih0aGlzLl9hY3RpdmVQYXJ0aWNsZVN5c3RlbXMucHVzaChyKSxyLmFuaW1hdGUoKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLmRpc3BhdGNoUGFydGljbGVzKHIpKX10aGlzLm9uQWZ0ZXJQYXJ0aWNsZXNSZW5kZXJpbmdPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX19X2FjdGl2ZU1lc2goZSx0KXt0aGlzLl9za2VsZXRvbnNFbmFibGVkJiZ0LnNrZWxldG9uIT09bnVsbCYmdC5za2VsZXRvbiE9PXZvaWQgMCYmKHRoaXMuX2FjdGl2ZVNrZWxldG9ucy5wdXNoTm9EdXBsaWNhdGUodC5za2VsZXRvbikmJih0LnNrZWxldG9uLnByZXBhcmUoKSx0aGlzLl9hY3RpdmVCb25lcy5hZGRDb3VudCh0LnNrZWxldG9uLmJvbmVzLmxlbmd0aCwhMSkpLHQuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzfHx0aGlzLl9zb2Z0d2FyZVNraW5uZWRNZXNoZXMucHVzaE5vRHVwbGljYXRlKHQpKTtsZXQgaT1lLmhhc0luc3RhbmNlc3x8ZS5pc0FuSW5zdGFuY2V8fHRoaXMuZGlzcGF0Y2hBbGxTdWJNZXNoZXNPZkFjdGl2ZU1lc2hlc3x8dGhpcy5fc2tpcEZydXN0dW1DbGlwcGluZ3x8dC5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2g7aWYodCYmdC5zdWJNZXNoZXMmJnQuc3ViTWVzaGVzLmxlbmd0aD4wKXtjb25zdCBzPXRoaXMuZ2V0QWN0aXZlU3ViTWVzaENhbmRpZGF0ZXModCkscj1zLmxlbmd0aDtpPWl8fHI9PT0xO2ZvcihsZXQgbj0wO248cjtuKyspe2NvbnN0IGE9cy5kYXRhW25dO3RoaXMuX2V2YWx1YXRlU3ViTWVzaChhLHQsZSxpKX19fXVwZGF0ZVRyYW5zZm9ybU1hdHJpeChlKXtpZih0aGlzLmFjdGl2ZUNhbWVyYSlpZih0aGlzLmFjdGl2ZUNhbWVyYS5fcmVuZGVyaW5nTXVsdGl2aWV3KXtjb25zdCB0PXRoaXMuYWN0aXZlQ2FtZXJhLl9yaWdDYW1lcmFzWzBdLGk9dGhpcy5hY3RpdmVDYW1lcmEuX3JpZ0NhbWVyYXNbMV07dGhpcy5zZXRUcmFuc2Zvcm1NYXRyaXgodC5nZXRWaWV3TWF0cml4KCksdC5nZXRQcm9qZWN0aW9uTWF0cml4KGUpLGkuZ2V0Vmlld01hdHJpeCgpLGkuZ2V0UHJvamVjdGlvbk1hdHJpeChlKSl9ZWxzZSB0aGlzLnNldFRyYW5zZm9ybU1hdHJpeCh0aGlzLmFjdGl2ZUNhbWVyYS5nZXRWaWV3TWF0cml4KCksdGhpcy5hY3RpdmVDYW1lcmEuZ2V0UHJvamVjdGlvbk1hdHJpeChlKSl9X2JpbmRGcmFtZUJ1ZmZlcihlLHQ9ITApe2UmJmUuX211bHRpdmlld1RleHR1cmU/ZS5fbXVsdGl2aWV3VGV4dHVyZS5fYmluZEZyYW1lQnVmZmVyKCk6ZSYmZS5vdXRwdXRSZW5kZXJUYXJnZXQ/ZS5vdXRwdXRSZW5kZXJUYXJnZXQuX2JpbmRGcmFtZUJ1ZmZlcigpOnRoaXMuX2VuZ2luZS5fY3VycmVudEZyYW1lQnVmZmVySXNEZWZhdWx0RnJhbWVCdWZmZXIoKXx8dGhpcy5fZW5naW5lLnJlc3RvcmVEZWZhdWx0RnJhbWVidWZmZXIoKSx0JiZ0aGlzLl9jbGVhckZyYW1lQnVmZmVyKGUpfV9jbGVhckZyYW1lQnVmZmVyKGUpe2lmKCEoZSYmZS5fbXVsdGl2aWV3VGV4dHVyZSkpaWYoZSYmZS5vdXRwdXRSZW5kZXJUYXJnZXQmJiFlLl9yZW5kZXJpbmdNdWx0aXZpZXcpe2NvbnN0IHQ9ZS5vdXRwdXRSZW5kZXJUYXJnZXQ7dC5vbkNsZWFyT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKT90Lm9uQ2xlYXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9lbmdpbmUpOnQuc2tpcEluaXRpYWxDbGVhcnx8KHRoaXMuYXV0b0NsZWFyJiZ0aGlzLl9lbmdpbmUuY2xlYXIodC5jbGVhckNvbG9yfHx0aGlzLmNsZWFyQ29sb3IsIXQuX2NsZWFyZWQsITAsITApLHQuX2NsZWFyZWQ9ITApfWVsc2UgdGhpcy5fZGVmYXVsdEZyYW1lQnVmZmVyQ2xlYXJlZD90aGlzLl9lbmdpbmUuY2xlYXIobnVsbCwhMSwhMCwhMCk6KHRoaXMuX2RlZmF1bHRGcmFtZUJ1ZmZlckNsZWFyZWQ9ITAsdGhpcy5fY2xlYXIoKSl9X3JlbmRlckZvckNhbWVyYShlLHQsaT0hMCl7dmFyIHMscixuO2lmKGUmJmUuX3NraXBSZW5kZXJpbmcpcmV0dXJuO2NvbnN0IGE9dGhpcy5fZW5naW5lO2lmKHRoaXMuX2FjdGl2ZUNhbWVyYT1lLCF0aGlzLmFjdGl2ZUNhbWVyYSl0aHJvdyBuZXcgRXJyb3IoIkFjdGl2ZSBjYW1lcmEgbm90IHNldCIpO2lmKGEuc2V0Vmlld3BvcnQodGhpcy5hY3RpdmVDYW1lcmEudmlld3BvcnQpLHRoaXMucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMuX3JlbmRlcklkKyssIXRoaXMucHJlUGFzcyYmaSl7bGV0IGg9ITA7ZS5fcmVuZGVyaW5nTXVsdGl2aWV3JiZlLm91dHB1dFJlbmRlclRhcmdldCYmKGg9ZS5vdXRwdXRSZW5kZXJUYXJnZXQuc2tpcEluaXRpYWxDbGVhcix0aGlzLmF1dG9DbGVhciYmKGUub3V0cHV0UmVuZGVyVGFyZ2V0LnNraXBJbml0aWFsQ2xlYXI9ITEpKSx0aGlzLl9iaW5kRnJhbWVCdWZmZXIodGhpcy5fYWN0aXZlQ2FtZXJhKSxlLl9yZW5kZXJpbmdNdWx0aXZpZXcmJmUub3V0cHV0UmVuZGVyVGFyZ2V0JiYoZS5vdXRwdXRSZW5kZXJUYXJnZXQuc2tpcEluaXRpYWxDbGVhcj1oKX10aGlzLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLHRoaXMub25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLmFjdGl2ZUNhbWVyYSksdGhpcy5fZXZhbHVhdGVBY3RpdmVNZXNoZXMoKTtmb3IobGV0IGg9MDtoPHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5sZW5ndGg7aCsrKXtjb25zdCBsPXRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5kYXRhW2hdO2wuYXBwbHlTa2VsZXRvbihsLnNrZWxldG9uKX10aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3JlbmRlclRhcmdldHMuY29uY2F0V2l0aE5vRHVwbGljYXRlKHRoaXMuX21hdGVyaWFsc1JlbmRlclRhcmdldHMpLGUuY3VzdG9tUmVuZGVyVGFyZ2V0cyYmZS5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aD4wJiZ0aGlzLl9yZW5kZXJUYXJnZXRzLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZShlLmN1c3RvbVJlbmRlclRhcmdldHMpLHQmJnQuY3VzdG9tUmVuZGVyVGFyZ2V0cyYmdC5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aD4wJiZ0aGlzLl9yZW5kZXJUYXJnZXRzLmNvbmNhdFdpdGhOb0R1cGxpY2F0ZSh0LmN1c3RvbVJlbmRlclRhcmdldHMpLHRoaXMuZW52aXJvbm1lbnRUZXh0dXJlJiZ0aGlzLmVudmlyb25tZW50VGV4dHVyZS5pc1JlbmRlclRhcmdldCYmdGhpcy5fcmVuZGVyVGFyZ2V0cy5wdXNoTm9EdXBsaWNhdGUodGhpcy5lbnZpcm9ubWVudFRleHR1cmUpO2Zvcihjb25zdCBoIG9mIHRoaXMuX2dhdGhlckFjdGl2ZUNhbWVyYVJlbmRlclRhcmdldHNTdGFnZSloLmFjdGlvbih0aGlzLl9yZW5kZXJUYXJnZXRzKTtsZXQgbz0hMTtpZih0aGlzLnJlbmRlclRhcmdldHNFbmFibGVkKXtpZih0aGlzLl9pbnRlcm1lZGlhdGVSZW5kZXJpbmc9ITAsdGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCl7SC5TdGFydFBlcmZvcm1hbmNlQ291bnRlcigiUmVuZGVyIHRhcmdldHMiLHRoaXMuX3JlbmRlclRhcmdldHMubGVuZ3RoPjApO2ZvcihsZXQgaD0wO2g8dGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg7aCsrKXtjb25zdCBsPXRoaXMuX3JlbmRlclRhcmdldHMuZGF0YVtoXTtpZihsLl9zaG91bGRSZW5kZXIoKSl7dGhpcy5fcmVuZGVySWQrKztjb25zdCB1PWwuYWN0aXZlQ2FtZXJhJiZsLmFjdGl2ZUNhbWVyYSE9PXRoaXMuYWN0aXZlQ2FtZXJhO2wucmVuZGVyKHUsdGhpcy5kdW1wTmV4dFJlbmRlclRhcmdldHMpLG89ITB9fUguRW5kUGVyZm9ybWFuY2VDb3VudGVyKCJSZW5kZXIgdGFyZ2V0cyIsdGhpcy5fcmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCksdGhpcy5fcmVuZGVySWQrK31mb3IoY29uc3QgaCBvZiB0aGlzLl9jYW1lcmFEcmF3UmVuZGVyVGFyZ2V0U3RhZ2Upbz1oLmFjdGlvbih0aGlzLmFjdGl2ZUNhbWVyYSl8fG87dGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSExfXRoaXMuX2VuZ2luZS5jdXJyZW50UmVuZGVyUGFzc0lkPShuPShyPShzPWUub3V0cHV0UmVuZGVyVGFyZ2V0KT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMucmVuZGVyUGFzc0lkKSE9PW51bGwmJnIhPT12b2lkIDA/cjplLnJlbmRlclBhc3NJZCkhPT1udWxsJiZuIT09dm9pZCAwP246MCxvJiYhdGhpcy5wcmVQYXNzJiZ0aGlzLl9iaW5kRnJhbWVCdWZmZXIodGhpcy5fYWN0aXZlQ2FtZXJhLCExKSx0aGlzLm9uQWZ0ZXJSZW5kZXJUYXJnZXRzUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5wb3N0UHJvY2Vzc01hbmFnZXImJiFlLl9tdWx0aXZpZXdUZXh0dXJlJiYhdGhpcy5wcmVQYXNzJiZ0aGlzLnBvc3RQcm9jZXNzTWFuYWdlci5fcHJlcGFyZUZyYW1lKCk7Zm9yKGNvbnN0IGggb2YgdGhpcy5fYmVmb3JlQ2FtZXJhRHJhd1N0YWdlKWguYWN0aW9uKHRoaXMuYWN0aXZlQ2FtZXJhKTt0aGlzLm9uQmVmb3JlRHJhd1BoYXNlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksYS5zbmFwc2hvdFJlbmRlcmluZyYmYS5zbmFwc2hvdFJlbmRlcmluZ01vZGU9PT0xJiZ0aGlzLmZpbmFsaXplU2NlbmVVYm8oKSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlbmRlcihudWxsLG51bGwsITAsITApLHRoaXMub25BZnRlckRyYXdQaGFzZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2Zvcihjb25zdCBoIG9mIHRoaXMuX2FmdGVyQ2FtZXJhRHJhd1N0YWdlKWguYWN0aW9uKHRoaXMuYWN0aXZlQ2FtZXJhKTtpZih0aGlzLnBvc3RQcm9jZXNzTWFuYWdlciYmIWUuX211bHRpdmlld1RleHR1cmUpe2NvbnN0IGg9ZS5vdXRwdXRSZW5kZXJUYXJnZXQ/ZS5vdXRwdXRSZW5kZXJUYXJnZXQucmVuZGVyVGFyZ2V0OnZvaWQgMDt0aGlzLnBvc3RQcm9jZXNzTWFuYWdlci5fZmluYWxpemVGcmFtZShlLmlzSW50ZXJtZWRpYXRlLGgpfWZvcihjb25zdCBoIG9mIHRoaXMuX2FmdGVyQ2FtZXJhUG9zdFByb2Nlc3NTdGFnZSloLmFjdGlvbih0aGlzLmFjdGl2ZUNhbWVyYSk7dGhpcy5fcmVuZGVyVGFyZ2V0cy5yZXNldCgpLHRoaXMub25BZnRlckNhbWVyYVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMuYWN0aXZlQ2FtZXJhKX1fcHJvY2Vzc1N1YkNhbWVyYXMoZSx0PSEwKXtpZihlLmNhbWVyYVJpZ01vZGU9PT0wfHxlLl9yZW5kZXJpbmdNdWx0aXZpZXcpe2UuX3JlbmRlcmluZ011bHRpdmlldyYmIXRoaXMuX211bHRpdmlld1NjZW5lVWJvJiZ0aGlzLl9jcmVhdGVNdWx0aXZpZXdVYm8oKSx0aGlzLl9yZW5kZXJGb3JDYW1lcmEoZSx2b2lkIDAsdCksdGhpcy5vbkFmdGVyUmVuZGVyQ2FtZXJhT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSk7cmV0dXJufWlmKGUuX3VzZU11bHRpdmlld1RvU2luZ2xlVmlldyl0aGlzLl9yZW5kZXJNdWx0aXZpZXdUb1NpbmdsZVZpZXcoZSk7ZWxzZXt0aGlzLm9uQmVmb3JlQ2FtZXJhUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSk7Zm9yKGxldCBpPTA7aTxlLl9yaWdDYW1lcmFzLmxlbmd0aDtpKyspdGhpcy5fcmVuZGVyRm9yQ2FtZXJhKGUuX3JpZ0NhbWVyYXNbaV0sZSl9dGhpcy5fYWN0aXZlQ2FtZXJhPWUsdGhpcy51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJDYW1lcmFPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKX1fY2hlY2tJbnRlcnNlY3Rpb25zKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLl9tZXNoZXNGb3JJbnRlcnNlY3Rpb25zLmxlbmd0aDtlKyspe2NvbnN0IHQ9dGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5kYXRhW2VdO2lmKHQuYWN0aW9uTWFuYWdlcilmb3IobGV0IGk9MDt0LmFjdGlvbk1hbmFnZXImJmk8dC5hY3Rpb25NYW5hZ2VyLmFjdGlvbnMubGVuZ3RoO2krKyl7Y29uc3Qgcz10LmFjdGlvbk1hbmFnZXIuYWN0aW9uc1tpXTtpZihzLnRyaWdnZXI9PT0xMnx8cy50cmlnZ2VyPT09MTMpe2NvbnN0IHI9cy5nZXRUcmlnZ2VyUGFyYW1ldGVyKCksbj1yLm1lc2g/ci5tZXNoOnIsYT1uLmludGVyc2VjdHNNZXNoKHQsci51c2VQcmVjaXNlSW50ZXJzZWN0aW9uKSxvPXQuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLmluZGV4T2Yobik7YSYmbz09PS0xP3MudHJpZ2dlcj09PTEyPyhzLl9leGVjdXRlQ3VycmVudChWZS5DcmVhdGVOZXcodCx2b2lkIDAsbikpLHQuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzLnB1c2gobikpOnMudHJpZ2dlcj09PTEzJiZ0Ll9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5wdXNoKG4pOiFhJiZvPi0xJiYocy50cmlnZ2VyPT09MTMmJnMuX2V4ZWN1dGVDdXJyZW50KFZlLkNyZWF0ZU5ldyh0LHZvaWQgMCxuKSksKCF0LmFjdGlvbk1hbmFnZXIuaGFzU3BlY2lmaWNUcmlnZ2VyKDEzLGg9Pntjb25zdCBsPWgubWVzaD9oLm1lc2g6aDtyZXR1cm4gbj09PWx9KXx8cy50cmlnZ2VyPT09MTMpJiZ0Ll9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5zcGxpY2UobywxKSl9fX19X2FkdmFuY2VQaHlzaWNzRW5naW5lU3RlcChlKXt9X2FuaW1hdGUoKXt9YW5pbWF0ZSgpe2lmKHRoaXMuX2VuZ2luZS5pc0RldGVybWluaXN0aWNMb2NrU3RlcCgpKXtsZXQgZT1NYXRoLm1heChuZS5NaW5EZWx0YVRpbWUsTWF0aC5taW4odGhpcy5fZW5naW5lLmdldERlbHRhVGltZSgpLG5lLk1heERlbHRhVGltZSkpK3RoaXMuX3RpbWVBY2N1bXVsYXRvcjtjb25zdCB0PXRoaXMuX2VuZ2luZS5nZXRUaW1lU3RlcCgpLGk9MWUzL3QvMWUzO2xldCBzPTA7Y29uc3Qgcj10aGlzLl9lbmdpbmUuZ2V0TG9ja3N0ZXBNYXhTdGVwcygpO2xldCBuPU1hdGguZmxvb3IoZS90KTtmb3Iobj1NYXRoLm1pbihuLHIpO2U+MCYmczxuOyl0aGlzLm9uQmVmb3JlU3RlcE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX2FuaW1hdGlvblJhdGlvPXQqaSx0aGlzLl9hbmltYXRlKCksdGhpcy5vbkFmdGVyQW5pbWF0aW9uc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMucGh5c2ljc0VuYWJsZWQmJnRoaXMuX2FkdmFuY2VQaHlzaWNzRW5naW5lU3RlcCh0KSx0aGlzLm9uQWZ0ZXJTdGVwT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5fY3VycmVudFN0ZXBJZCsrLHMrKyxlLT10O3RoaXMuX3RpbWVBY2N1bXVsYXRvcj1lPDA/MDplfWVsc2V7Y29uc3QgZT10aGlzLnVzZUNvbnN0YW50QW5pbWF0aW9uRGVsdGFUaW1lPzE2Ok1hdGgubWF4KG5lLk1pbkRlbHRhVGltZSxNYXRoLm1pbih0aGlzLl9lbmdpbmUuZ2V0RGVsdGFUaW1lKCksbmUuTWF4RGVsdGFUaW1lKSk7dGhpcy5fYW5pbWF0aW9uUmF0aW89ZSooNjAvMWUzKSx0aGlzLl9hbmltYXRlKCksdGhpcy5vbkFmdGVyQW5pbWF0aW9uc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMucGh5c2ljc0VuYWJsZWQmJnRoaXMuX2FkdmFuY2VQaHlzaWNzRW5naW5lU3RlcChlKX19X2NsZWFyKCl7KHRoaXMuYXV0b0NsZWFyRGVwdGhBbmRTdGVuY2lsfHx0aGlzLmF1dG9DbGVhcikmJnRoaXMuX2VuZ2luZS5jbGVhcih0aGlzLmNsZWFyQ29sb3IsdGhpcy5hdXRvQ2xlYXJ8fHRoaXMuZm9yY2VXaXJlZnJhbWV8fHRoaXMuZm9yY2VQb2ludHNDbG91ZCx0aGlzLmF1dG9DbGVhckRlcHRoQW5kU3RlbmNpbCx0aGlzLmF1dG9DbGVhckRlcHRoQW5kU3RlbmNpbCl9X2NoZWNrQ2FtZXJhUmVuZGVyVGFyZ2V0KGUpe3ZhciB0O2lmKGUhPW51bGwmJmUub3V0cHV0UmVuZGVyVGFyZ2V0JiYhKGUhPW51bGwmJmUuaXNSaWdDYW1lcmEpJiYoZS5vdXRwdXRSZW5kZXJUYXJnZXQuX2NsZWFyZWQ9ITEpLCEoKHQ9ZT09bnVsbD92b2lkIDA6ZS5yaWdDYW1lcmFzKT09PW51bGx8fHQ9PT12b2lkIDApJiZ0Lmxlbmd0aClmb3IobGV0IGk9MDtpPGUucmlnQ2FtZXJhcy5sZW5ndGg7KytpKXtjb25zdCBzPWUucmlnQ2FtZXJhc1tpXS5vdXRwdXRSZW5kZXJUYXJnZXQ7cyYmKHMuX2NsZWFyZWQ9ITEpfX1yZXNldERyYXdDYWNoZShlKXtpZih0aGlzLm1lc2hlcylmb3IoY29uc3QgdCBvZiB0aGlzLm1lc2hlcyl0LnJlc2V0RHJhd0NhY2hlKGUpfXJlbmRlcihlPSEwLHQ9ITEpe3ZhciBpLHMscjtpZih0aGlzLmlzRGlzcG9zZWQpcmV0dXJuO3RoaXMub25SZWFkeU9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCkmJnRoaXMuX2V4ZWN1dGVXaGVuUmVhZHlUaW1lb3V0SWQ9PT1udWxsJiZ0aGlzLl9jaGVja0lzUmVhZHkoKSx0aGlzLl9mcmFtZUlkKyssdGhpcy5fZGVmYXVsdEZyYW1lQnVmZmVyQ2xlYXJlZD0hMSx0aGlzLl9jaGVja0NhbWVyYVJlbmRlclRhcmdldCh0aGlzLmFjdGl2ZUNhbWVyYSksISgoaT10aGlzLmFjdGl2ZUNhbWVyYXMpPT09bnVsbHx8aT09PXZvaWQgMCkmJmkubGVuZ3RoJiZ0aGlzLmFjdGl2ZUNhbWVyYXMuZm9yRWFjaCh0aGlzLl9jaGVja0NhbWVyYVJlbmRlclRhcmdldCksdGhpcy5fcmVnaXN0ZXJUcmFuc2llbnRDb21wb25lbnRzKCksdGhpcy5fYWN0aXZlUGFydGljbGVzLmZldGNoTmV3RnJhbWUoKSx0aGlzLl90b3RhbFZlcnRpY2VzLmZldGNoTmV3RnJhbWUoKSx0aGlzLl9hY3RpdmVJbmRpY2VzLmZldGNoTmV3RnJhbWUoKSx0aGlzLl9hY3RpdmVCb25lcy5mZXRjaE5ld0ZyYW1lKCksdGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5yZXNldCgpLHRoaXMucmVzZXRDYWNoZWRNYXRlcmlhbCgpLHRoaXMub25CZWZvcmVBbmltYXRpb25zT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5hY3Rpb25NYW5hZ2VyJiZ0aGlzLmFjdGlvbk1hbmFnZXIucHJvY2Vzc1RyaWdnZXIoMTEpLHR8fHRoaXMuYW5pbWF0ZSgpO2Zvcihjb25zdCBvIG9mIHRoaXMuX2JlZm9yZUNhbWVyYVVwZGF0ZVN0YWdlKW8uYWN0aW9uKCk7aWYoZSl7aWYodGhpcy5hY3RpdmVDYW1lcmFzJiZ0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoPjApZm9yKGxldCBvPTA7bzx0aGlzLmFjdGl2ZUNhbWVyYXMubGVuZ3RoO28rKyl7Y29uc3QgaD10aGlzLmFjdGl2ZUNhbWVyYXNbb107aWYoaC51cGRhdGUoKSxoLmNhbWVyYVJpZ01vZGUhPT0wKWZvcihsZXQgbD0wO2w8aC5fcmlnQ2FtZXJhcy5sZW5ndGg7bCsrKWguX3JpZ0NhbWVyYXNbbF0udXBkYXRlKCl9ZWxzZSBpZih0aGlzLmFjdGl2ZUNhbWVyYSYmKHRoaXMuYWN0aXZlQ2FtZXJhLnVwZGF0ZSgpLHRoaXMuYWN0aXZlQ2FtZXJhLmNhbWVyYVJpZ01vZGUhPT0wKSlmb3IobGV0IG89MDtvPHRoaXMuYWN0aXZlQ2FtZXJhLl9yaWdDYW1lcmFzLmxlbmd0aDtvKyspdGhpcy5hY3RpdmVDYW1lcmEuX3JpZ0NhbWVyYXNbb10udXBkYXRlKCl9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IG49dGhpcy5nZXRFbmdpbmUoKTt0aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IGE9ISgocz10aGlzLmFjdGl2ZUNhbWVyYXMpPT09bnVsbHx8cz09PXZvaWQgMCkmJnMubGVuZ3RoP3RoaXMuYWN0aXZlQ2FtZXJhc1swXTp0aGlzLmFjdGl2ZUNhbWVyYTtpZih0aGlzLnJlbmRlclRhcmdldHNFbmFibGVkKXtILlN0YXJ0UGVyZm9ybWFuY2VDb3VudGVyKCJDdXN0b20gcmVuZGVyIHRhcmdldHMiLHRoaXMuY3VzdG9tUmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCksdGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSEwO2ZvcihsZXQgbz0wO288dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aDtvKyspe2NvbnN0IGg9dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzW29dO2lmKGguX3Nob3VsZFJlbmRlcigpKXtpZih0aGlzLl9yZW5kZXJJZCsrLHRoaXMuYWN0aXZlQ2FtZXJhPWguYWN0aXZlQ2FtZXJhfHx0aGlzLmFjdGl2ZUNhbWVyYSwhdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKCJBY3RpdmUgY2FtZXJhIG5vdCBzZXQiKTtuLnNldFZpZXdwb3J0KHRoaXMuYWN0aXZlQ2FtZXJhLnZpZXdwb3J0KSx0aGlzLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLGgucmVuZGVyKGEhPT10aGlzLmFjdGl2ZUNhbWVyYSx0aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cyl9fUguRW5kUGVyZm9ybWFuY2VDb3VudGVyKCJDdXN0b20gcmVuZGVyIHRhcmdldHMiLHRoaXMuY3VzdG9tUmVuZGVyVGFyZ2V0cy5sZW5ndGg+MCksdGhpcy5faW50ZXJtZWRpYXRlUmVuZGVyaW5nPSExLHRoaXMuX3JlbmRlcklkKyt9dGhpcy5fZW5naW5lLmN1cnJlbnRSZW5kZXJQYXNzSWQ9KHI9YT09bnVsbD92b2lkIDA6YS5yZW5kZXJQYXNzSWQpIT09bnVsbCYmciE9PXZvaWQgMD9yOjAsdGhpcy5hY3RpdmVDYW1lcmE9YSx0aGlzLl9hY3RpdmVDYW1lcmEmJnRoaXMuX2FjdGl2ZUNhbWVyYS5jYW1lcmFSaWdNb2RlIT09MjImJiF0aGlzLnByZVBhc3MmJnRoaXMuX2JpbmRGcmFtZUJ1ZmZlcih0aGlzLl9hY3RpdmVDYW1lcmEsITEpLHRoaXMub25BZnRlclJlbmRlclRhcmdldHNSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKTtmb3IoY29uc3QgbyBvZiB0aGlzLl9iZWZvcmVDbGVhclN0YWdlKW8uYWN0aW9uKCk7dGhpcy5fY2xlYXJGcmFtZUJ1ZmZlcih0aGlzLmFjdGl2ZUNhbWVyYSk7Zm9yKGNvbnN0IG8gb2YgdGhpcy5fZ2F0aGVyUmVuZGVyVGFyZ2V0c1N0YWdlKW8uYWN0aW9uKHRoaXMuX3JlbmRlclRhcmdldHMpO2lmKHRoaXMuYWN0aXZlQ2FtZXJhcyYmdGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aD4wKWZvcihsZXQgbz0wO288dGhpcy5hY3RpdmVDYW1lcmFzLmxlbmd0aDtvKyspdGhpcy5fcHJvY2Vzc1N1YkNhbWVyYXModGhpcy5hY3RpdmVDYW1lcmFzW29dLG8+MCk7ZWxzZXtpZighdGhpcy5hY3RpdmVDYW1lcmEpdGhyb3cgbmV3IEVycm9yKCJObyBjYW1lcmEgZGVmaW5lZCIpO3RoaXMuX3Byb2Nlc3NTdWJDYW1lcmFzKHRoaXMuYWN0aXZlQ2FtZXJhLCEhdGhpcy5hY3RpdmVDYW1lcmEub3V0cHV0UmVuZGVyVGFyZ2V0KX10aGlzLl9jaGVja0ludGVyc2VjdGlvbnMoKTtmb3IoY29uc3QgbyBvZiB0aGlzLl9hZnRlclJlbmRlclN0YWdlKW8uYWN0aW9uKCk7aWYodGhpcy5hZnRlclJlbmRlciYmdGhpcy5hZnRlclJlbmRlcigpLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3RvQmVEaXNwb3NlZC5sZW5ndGgpe2ZvcihsZXQgbz0wO288dGhpcy5fdG9CZURpc3Bvc2VkLmxlbmd0aDtvKyspe2NvbnN0IGg9dGhpcy5fdG9CZURpc3Bvc2VkW29dO2gmJmguZGlzcG9zZSgpfXRoaXMuX3RvQmVEaXNwb3NlZC5sZW5ndGg9MH10aGlzLmR1bXBOZXh0UmVuZGVyVGFyZ2V0cyYmKHRoaXMuZHVtcE5leHRSZW5kZXJUYXJnZXRzPSExKSx0aGlzLl9hY3RpdmVCb25lcy5hZGRDb3VudCgwLCEwKSx0aGlzLl9hY3RpdmVJbmRpY2VzLmFkZENvdW50KDAsITApLHRoaXMuX2FjdGl2ZVBhcnRpY2xlcy5hZGRDb3VudCgwLCEwKSx0aGlzLl9lbmdpbmUucmVzdG9yZURlZmF1bHRGcmFtZWJ1ZmZlcigpfWZyZWV6ZU1hdGVyaWFscygpe2ZvcihsZXQgZT0wO2U8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO2UrKyl0aGlzLm1hdGVyaWFsc1tlXS5mcmVlemUoKX11bmZyZWV6ZU1hdGVyaWFscygpe2ZvcihsZXQgZT0wO2U8dGhpcy5tYXRlcmlhbHMubGVuZ3RoO2UrKyl0aGlzLm1hdGVyaWFsc1tlXS51bmZyZWV6ZSgpfWRpc3Bvc2UoKXtpZih0aGlzLmlzRGlzcG9zZWQpcmV0dXJuO3RoaXMuYmVmb3JlUmVuZGVyPW51bGwsdGhpcy5hZnRlclJlbmRlcj1udWxsLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLnNrZWxldG9ucy5sZW5ndGg9MCx0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcnMubGVuZ3RoPTAsdGhpcy5fdHJhbnNpZW50Q29tcG9uZW50cy5sZW5ndGg9MCx0aGlzLl9pc1JlYWR5Rm9yTWVzaFN0YWdlLmNsZWFyKCksdGhpcy5fYmVmb3JlRXZhbHVhdGVBY3RpdmVNZXNoU3RhZ2UuY2xlYXIoKSx0aGlzLl9ldmFsdWF0ZVN1Yk1lc2hTdGFnZS5jbGVhcigpLHRoaXMuX3ByZUFjdGl2ZU1lc2hTdGFnZS5jbGVhcigpLHRoaXMuX2NhbWVyYURyYXdSZW5kZXJUYXJnZXRTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZUNhbWVyYURyYXdTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZVJlbmRlclRhcmdldERyYXdTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZVJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlLmNsZWFyKCksdGhpcy5fYmVmb3JlUmVuZGVyaW5nTWVzaFN0YWdlLmNsZWFyKCksdGhpcy5fYWZ0ZXJSZW5kZXJpbmdNZXNoU3RhZ2UuY2xlYXIoKSx0aGlzLl9hZnRlclJlbmRlcmluZ0dyb3VwRHJhd1N0YWdlLmNsZWFyKCksdGhpcy5fYWZ0ZXJDYW1lcmFEcmF3U3RhZ2UuY2xlYXIoKSx0aGlzLl9hZnRlclJlbmRlclRhcmdldERyYXdTdGFnZS5jbGVhcigpLHRoaXMuX2FmdGVyUmVuZGVyU3RhZ2UuY2xlYXIoKSx0aGlzLl9iZWZvcmVDYW1lcmFVcGRhdGVTdGFnZS5jbGVhcigpLHRoaXMuX2JlZm9yZUNsZWFyU3RhZ2UuY2xlYXIoKSx0aGlzLl9nYXRoZXJSZW5kZXJUYXJnZXRzU3RhZ2UuY2xlYXIoKSx0aGlzLl9nYXRoZXJBY3RpdmVDYW1lcmFSZW5kZXJUYXJnZXRzU3RhZ2UuY2xlYXIoKSx0aGlzLl9wb2ludGVyTW92ZVN0YWdlLmNsZWFyKCksdGhpcy5fcG9pbnRlckRvd25TdGFnZS5jbGVhcigpLHRoaXMuX3BvaW50ZXJVcFN0YWdlLmNsZWFyKCksdGhpcy5pbXBvcnRlZE1lc2hlc0ZpbGVzPW5ldyBBcnJheSx0aGlzLnN0b3BBbGxBbmltYXRpb25zJiZ0aGlzLnN0b3BBbGxBbmltYXRpb25zKCksdGhpcy5yZXNldENhY2hlZE1hdGVyaWFsKCksdGhpcy5hY3RpdmVDYW1lcmEmJih0aGlzLmFjdGl2ZUNhbWVyYS5fYWN0aXZlTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLmFjdGl2ZUNhbWVyYT1udWxsKSx0aGlzLmFjdGl2ZUNhbWVyYXM9bnVsbCx0aGlzLl9hY3RpdmVNZXNoZXMuZGlzcG9zZSgpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3Byb2Nlc3NlZE1hdGVyaWFscy5kaXNwb3NlKCksdGhpcy5fYWN0aXZlUGFydGljbGVTeXN0ZW1zLmRpc3Bvc2UoKSx0aGlzLl9hY3RpdmVTa2VsZXRvbnMuZGlzcG9zZSgpLHRoaXMuX3NvZnR3YXJlU2tpbm5lZE1lc2hlcy5kaXNwb3NlKCksdGhpcy5fcmVuZGVyVGFyZ2V0cy5kaXNwb3NlKCksdGhpcy5fbWF0ZXJpYWxzUmVuZGVyVGFyZ2V0cy5kaXNwb3NlKCksdGhpcy5fcmVnaXN0ZXJlZEZvckxhdGVBbmltYXRpb25CaW5kaW5ncy5kaXNwb3NlKCksdGhpcy5fbWVzaGVzRm9ySW50ZXJzZWN0aW9ucy5kaXNwb3NlKCksdGhpcy5fdG9CZURpc3Bvc2VkLmxlbmd0aD0wO2NvbnN0IGU9dGhpcy5fYWN0aXZlUmVxdWVzdHMuc2xpY2UoKTtmb3IoY29uc3QgciBvZiBlKXIuYWJvcnQoKTt0aGlzLl9hY3RpdmVSZXF1ZXN0cy5sZW5ndGg9MDt0cnl7dGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1jYXRjaChyKXtjb25zb2xlLmVycm9yKCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBjYWxsaW5nIG9uRGlzcG9zZU9ic2VydmFibGUhIixyKX1pZih0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyVGFyZ2V0c1JlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJUYXJnZXRzUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclN0ZXBPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZVN0ZXBPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZUFjdGl2ZU1lc2hlc0V2YWx1YXRpb25PYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyQWN0aXZlTWVzaGVzRXZhbHVhdGlvbk9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUGFydGljbGVzUmVuZGVyaW5nT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclBhcnRpY2xlc1JlbmRlcmluZ09ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlRHJhd1BoYXNlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlckRyYXdQaGFzZU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlQW5pbWF0aW9uc09ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJBbmltYXRpb25zT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25EYXRhTG9hZGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWZvcmVSZW5kZXJpbmdHcm91cE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJSZW5kZXJpbmdHcm91cE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTWVzaEltcG9ydGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25CZWZvcmVDYW1lcmFSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyQ2FtZXJhUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25SZWFkeU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTmV3Q2FtZXJhQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNhbWVyYVJlbW92ZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld0xpZ2h0QWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkxpZ2h0UmVtb3ZlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTmV3R2VvbWV0cnlBZGRlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uR2VvbWV0cnlSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25OZXdUcmFuc2Zvcm1Ob2RlQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vblRyYW5zZm9ybU5vZGVSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25OZXdNZXNoQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk1lc2hSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25OZXdTa2VsZXRvbkFkZGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25Ta2VsZXRvblJlbW92ZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld01hdGVyaWFsQWRkZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld011bHRpTWF0ZXJpYWxBZGRlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTWF0ZXJpYWxSZW1vdmVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25NdWx0aU1hdGVyaWFsUmVtb3ZlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uTmV3VGV4dHVyZUFkZGVkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25UZXh0dXJlUmVtb3ZlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uUHJlUG9pbnRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uUG9pbnRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uUHJlS2V5Ym9hcmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbktleWJvYXJkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BY3RpdmVDYW1lcmFDaGFuZ2VkLmNsZWFyKCksdGhpcy5kZXRhY2hDb250cm9sKCksdGhpcy5fZW5naW5lLmdldElucHV0RWxlbWVudCgpKWZvcihsZXQgcj0wO3I8dGhpcy5jYW1lcmFzLmxlbmd0aDtyKyspdGhpcy5jYW1lcmFzW3JdLmRldGFjaENvbnRyb2woKTt0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLmFuaW1hdGlvbkdyb3VwcyksdGhpcy5fZGlzcG9zZUxpc3QodGhpcy5saWdodHMpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMubWVzaGVzLHI9PnIuZGlzcG9zZSghMCkpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMudHJhbnNmb3JtTm9kZXMscj0+ci5kaXNwb3NlKCEwKSk7Y29uc3QgaT10aGlzLmNhbWVyYXM7dGhpcy5fZGlzcG9zZUxpc3QoaSksdGhpcy5fZGVmYXVsdE1hdGVyaWFsJiZ0aGlzLl9kZWZhdWx0TWF0ZXJpYWwuZGlzcG9zZSgpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMubXVsdGlNYXRlcmlhbHMpLHRoaXMuX2Rpc3Bvc2VMaXN0KHRoaXMubWF0ZXJpYWxzKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLnBhcnRpY2xlU3lzdGVtcyksdGhpcy5fZGlzcG9zZUxpc3QodGhpcy5wb3N0UHJvY2Vzc2VzKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLnRleHR1cmVzKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcnMpLHRoaXMuX3NjZW5lVWJvLmRpc3Bvc2UoKSx0aGlzLl9tdWx0aXZpZXdTY2VuZVVibyYmdGhpcy5fbXVsdGl2aWV3U2NlbmVVYm8uZGlzcG9zZSgpLHRoaXMucG9zdFByb2Nlc3NNYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLl9kaXNwb3NlTGlzdCh0aGlzLl9jb21wb25lbnRzKTtsZXQgcz10aGlzLl9lbmdpbmUuc2NlbmVzLmluZGV4T2YodGhpcyk7cz4tMSYmdGhpcy5fZW5naW5lLnNjZW5lcy5zcGxpY2UocywxKSxmZS5fTGFzdENyZWF0ZWRTY2VuZT09PXRoaXMmJih0aGlzLl9lbmdpbmUuc2NlbmVzLmxlbmd0aD4wP2ZlLl9MYXN0Q3JlYXRlZFNjZW5lPXRoaXMuX2VuZ2luZS5zY2VuZXNbdGhpcy5fZW5naW5lLnNjZW5lcy5sZW5ndGgtMV06ZmUuX0xhc3RDcmVhdGVkU2NlbmU9bnVsbCkscz10aGlzLl9lbmdpbmUuX3ZpcnR1YWxTY2VuZXMuaW5kZXhPZih0aGlzKSxzPi0xJiZ0aGlzLl9lbmdpbmUuX3ZpcnR1YWxTY2VuZXMuc3BsaWNlKHMsMSksdGhpcy5fZW5naW5lLndpcGVDYWNoZXMoITApLHRoaXMuX2lzRGlzcG9zZWQ9ITB9X2Rpc3Bvc2VMaXN0KGUsdCl7Y29uc3QgaT1lLnNsaWNlKDApO3Q9dD8/KHM9PnMuZGlzcG9zZSgpKTtmb3IoY29uc3QgcyBvZiBpKXQocyk7ZS5sZW5ndGg9MH1nZXQgaXNEaXNwb3NlZCgpe3JldHVybiB0aGlzLl9pc0Rpc3Bvc2VkfWNsZWFyQ2FjaGVkVmVydGV4RGF0YSgpe2ZvcihsZXQgZT0wO2U8dGhpcy5tZXNoZXMubGVuZ3RoO2UrKyl7Y29uc3QgaT10aGlzLm1lc2hlc1tlXS5nZW9tZXRyeTtpJiZpLmNsZWFyQ2FjaGVkRGF0YSgpfX1jbGVhbkNhY2hlZFRleHR1cmVCdWZmZXIoKXtmb3IoY29uc3QgZSBvZiB0aGlzLnRleHR1cmVzKWUuX2J1ZmZlciYmKGUuX2J1ZmZlcj1udWxsKX1nZXRXb3JsZEV4dGVuZHMoZSl7Y29uc3QgdD1uZXcgcChOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksaT1uZXcgcCgtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSwtTnVtYmVyLk1BWF9WQUxVRSk7cmV0dXJuIGU9ZXx8KCgpPT4hMCksdGhpcy5tZXNoZXMuZmlsdGVyKGUpLmZvckVhY2gocz0+e2lmKHMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSwhcy5zdWJNZXNoZXN8fHMuc3ViTWVzaGVzLmxlbmd0aD09PTB8fHMuaW5maW5pdGVEaXN0YW5jZSlyZXR1cm47Y29uc3Qgcj1zLmdldEJvdW5kaW5nSW5mbygpLG49ci5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQsYT1yLmJvdW5kaW5nQm94Lm1heGltdW1Xb3JsZDtwLkNoZWNrRXh0ZW5kcyhuLHQsaSkscC5DaGVja0V4dGVuZHMoYSx0LGkpfSkse21pbjp0LG1heDppfX1jcmVhdGVQaWNraW5nUmF5KGUsdCxpLHMscj0hMSl7dGhyb3cgJCgiUmF5Iil9Y3JlYXRlUGlja2luZ1JheVRvUmVmKGUsdCxpLHMscixuPSExLGE9ITEpe3Rocm93ICQoIlJheSIpfWNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlKGUsdCxpKXt0aHJvdyAkKCJSYXkiKX1jcmVhdGVQaWNraW5nUmF5SW5DYW1lcmFTcGFjZVRvUmVmKGUsdCxpLHMpe3Rocm93ICQoIlJheSIpfWdldCBfcGlja2luZ0F2YWlsYWJsZSgpe3JldHVybiExfXBpY2soZSx0LGkscyxyLG4pe3JldHVybiBuZXcgVXR9cGlja1dpdGhCb3VuZGluZ0luZm8oZSx0LGkscyxyKXtyZXR1cm4gbmV3IFV0fXBpY2tXaXRoUmF5KGUsdCxpLHMpe3Rocm93ICQoIlJheSIpfW11bHRpUGljayhlLHQsaSxzLHIpe3Rocm93ICQoIlJheSIpfW11bHRpUGlja1dpdGhSYXkoZSx0LGkpe3Rocm93ICQoIlJheSIpfXNldFBvaW50ZXJPdmVyTWVzaChlLHQsaSl7dGhpcy5faW5wdXRNYW5hZ2VyLnNldFBvaW50ZXJPdmVyTWVzaChlLHQsaSl9Z2V0UG9pbnRlck92ZXJNZXNoKCl7cmV0dXJuIHRoaXMuX2lucHV0TWFuYWdlci5nZXRQb2ludGVyT3Zlck1lc2goKX1fcmVidWlsZEdlb21ldHJpZXMoKXtmb3IoY29uc3QgZSBvZiB0aGlzLmdlb21ldHJpZXMpZS5fcmVidWlsZCgpO2Zvcihjb25zdCBlIG9mIHRoaXMubWVzaGVzKWUuX3JlYnVpbGQoKTt0aGlzLnBvc3RQcm9jZXNzTWFuYWdlciYmdGhpcy5wb3N0UHJvY2Vzc01hbmFnZXIuX3JlYnVpbGQoKTtmb3IoY29uc3QgZSBvZiB0aGlzLl9jb21wb25lbnRzKWUucmVidWlsZCgpO2Zvcihjb25zdCBlIG9mIHRoaXMucGFydGljbGVTeXN0ZW1zKWUucmVidWlsZCgpO2lmKHRoaXMuc3ByaXRlTWFuYWdlcnMpZm9yKGNvbnN0IGUgb2YgdGhpcy5zcHJpdGVNYW5hZ2VycyllLnJlYnVpbGQoKX1fcmVidWlsZFRleHR1cmVzKCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy50ZXh0dXJlcyllLl9yZWJ1aWxkKCk7dGhpcy5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKX1fZ2V0QnlUYWdzKGUsdCxpKXtpZih0PT09dm9pZCAwKXJldHVybiBlO2NvbnN0IHM9W107aT1pfHwocj0+e30pO2Zvcihjb25zdCByIGluIGUpe2NvbnN0IG49ZVtyXTtnZSYmZ2UuTWF0Y2hlc1F1ZXJ5KG4sdCkmJihzLnB1c2gobiksaShuKSl9cmV0dXJuIHN9Z2V0TWVzaGVzQnlUYWdzKGUsdCl7cmV0dXJuIHRoaXMuX2dldEJ5VGFncyh0aGlzLm1lc2hlcyxlLHQpfWdldENhbWVyYXNCeVRhZ3MoZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMuY2FtZXJhcyxlLHQpfWdldExpZ2h0c0J5VGFncyhlLHQpe3JldHVybiB0aGlzLl9nZXRCeVRhZ3ModGhpcy5saWdodHMsZSx0KX1nZXRNYXRlcmlhbEJ5VGFncyhlLHQpe3JldHVybiB0aGlzLl9nZXRCeVRhZ3ModGhpcy5tYXRlcmlhbHMsZSx0KS5jb25jYXQodGhpcy5fZ2V0QnlUYWdzKHRoaXMubXVsdGlNYXRlcmlhbHMsZSx0KSl9Z2V0VHJhbnNmb3JtTm9kZXNCeVRhZ3MoZSx0KXtyZXR1cm4gdGhpcy5fZ2V0QnlUYWdzKHRoaXMudHJhbnNmb3JtTm9kZXMsZSx0KX1zZXRSZW5kZXJpbmdPcmRlcihlLHQ9bnVsbCxpPW51bGwscz1udWxsKXt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnNldFJlbmRlcmluZ09yZGVyKGUsdCxpLHMpfXNldFJlbmRlcmluZ0F1dG9DbGVhckRlcHRoU3RlbmNpbChlLHQsaT0hMCxzPSEwKXt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnNldFJlbmRlcmluZ0F1dG9DbGVhckRlcHRoU3RlbmNpbChlLHQsaSxzKX1nZXRBdXRvQ2xlYXJEZXB0aFN0ZW5jaWxTZXR1cChlKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5nZXRBdXRvQ2xlYXJEZXB0aFN0ZW5jaWxTZXR1cChlKX1nZXQgYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtKCl7cmV0dXJuIHRoaXMuX2Jsb2NrTWF0ZXJpYWxEaXJ0eU1lY2hhbmlzbX1zZXQgYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtKGUpe3RoaXMuX2Jsb2NrTWF0ZXJpYWxEaXJ0eU1lY2hhbmlzbSE9PWUmJih0aGlzLl9ibG9ja01hdGVyaWFsRGlydHlNZWNoYW5pc209ZSxlfHx0aGlzLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDYzKSl9bWFya0FsbE1hdGVyaWFsc0FzRGlydHkoZSx0KXtpZighdGhpcy5fYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtKWZvcihjb25zdCBpIG9mIHRoaXMubWF0ZXJpYWxzKXQmJiF0KGkpfHxpLm1hcmtBc0RpcnR5KGUpfV9sb2FkRmlsZShlLHQsaSxzLHIsbixhKXtjb25zdCBvPWp0KGUsdCxpLHM/dGhpcy5vZmZsaW5lUHJvdmlkZXI6dm9pZCAwLHIsbixhKTtyZXR1cm4gdGhpcy5fYWN0aXZlUmVxdWVzdHMucHVzaChvKSxvLm9uQ29tcGxldGVPYnNlcnZhYmxlLmFkZChoPT57dGhpcy5fYWN0aXZlUmVxdWVzdHMuc3BsaWNlKHRoaXMuX2FjdGl2ZVJlcXVlc3RzLmluZGV4T2YoaCksMSl9KSxvfV9sb2FkRmlsZUFzeW5jKGUsdCxpLHMscil7cmV0dXJuIG5ldyBQcm9taXNlKChuLGEpPT57dGhpcy5fbG9hZEZpbGUoZSxvPT57bihvKX0sdCxpLHMsKG8saCk9PnthKGgpfSxyKX0pfV9yZXF1ZXN0RmlsZShlLHQsaSxzLHIsbixhKXtjb25zdCBvPXhzKGUsdCxpLHM/dGhpcy5vZmZsaW5lUHJvdmlkZXI6dm9pZCAwLHIsbixhKTtyZXR1cm4gdGhpcy5fYWN0aXZlUmVxdWVzdHMucHVzaChvKSxvLm9uQ29tcGxldGVPYnNlcnZhYmxlLmFkZChoPT57dGhpcy5fYWN0aXZlUmVxdWVzdHMuc3BsaWNlKHRoaXMuX2FjdGl2ZVJlcXVlc3RzLmluZGV4T2YoaCksMSl9KSxvfV9yZXF1ZXN0RmlsZUFzeW5jKGUsdCxpLHMscil7cmV0dXJuIG5ldyBQcm9taXNlKChuLGEpPT57dGhpcy5fcmVxdWVzdEZpbGUoZSxvPT57bihvKX0sdCxpLHMsbz0+e2Eobyl9LHIpfSl9X3JlYWRGaWxlKGUsdCxpLHMscil7Y29uc3Qgbj13aShlLHQsaSxzLHIpO3JldHVybiB0aGlzLl9hY3RpdmVSZXF1ZXN0cy5wdXNoKG4pLG4ub25Db21wbGV0ZU9ic2VydmFibGUuYWRkKGE9Pnt0aGlzLl9hY3RpdmVSZXF1ZXN0cy5zcGxpY2UodGhpcy5fYWN0aXZlUmVxdWVzdHMuaW5kZXhPZihhKSwxKX0pLG59X3JlYWRGaWxlQXN5bmMoZSx0LGkpe3JldHVybiBuZXcgUHJvbWlzZSgocyxyKT0+e3RoaXMuX3JlYWRGaWxlKGUsbj0+e3Mobil9LHQsaSxuPT57cihuKX0pfSl9Z2V0UGVyZkNvbGxlY3Rvcigpe3Rocm93ICQoInBlcmZvcm1hbmNlVmlld2VyU2NlbmVFeHRlbnNpb24iKX19bmUuRk9HTU9ERV9OT05FPTAsbmUuRk9HTU9ERV9FWFA9MSxuZS5GT0dNT0RFX0VYUDI9MixuZS5GT0dNT0RFX0xJTkVBUj0zLG5lLk1pbkRlbHRhVGltZT0xLG5lLk1heERlbHRhVGltZT0xZTMsbmUucHJvdG90eXBlLnNldEFjdGl2ZUNhbWVyYUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuc2V0QWN0aXZlQ2FtZXJhQnlJZChjKX0sbmUucHJvdG90eXBlLmdldExhc3RNYXRlcmlhbEJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0TGFzdE1hdGVyaWFsQnlJZChjKX0sbmUucHJvdG90eXBlLmdldE1hdGVyaWFsQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRNYXRlcmlhbEJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRUZXh0dXJlQnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRUZXh0dXJlQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldENhbWVyYUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0Q2FtZXJhQnlJZChjKX0sbmUucHJvdG90eXBlLmdldENhbWVyYUJ5VW5pcXVlSUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0Q2FtZXJhQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldEJvbmVCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldEJvbmVCeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0TGlnaHRCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldExpZ2h0QnlJZChjKX0sbmUucHJvdG90eXBlLmdldExpZ2h0QnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRMaWdodEJ5VW5pcXVlSWQoYyl9LG5lLnByb3RvdHlwZS5nZXRQYXJ0aWNsZVN5c3RlbUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0UGFydGljbGVTeXN0ZW1CeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0R2VvbWV0cnlCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldEdlb21ldHJ5QnlJZChjKX0sbmUucHJvdG90eXBlLmdldE1lc2hCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldE1lc2hCeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0TWVzaGVzQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRNZXNoZXNCeUlkKGMpfSxuZS5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtTm9kZUJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0VHJhbnNmb3JtTm9kZUJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm1Ob2RlQnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRUcmFuc2Zvcm1Ob2RlQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldFRyYW5zZm9ybU5vZGVzQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRUcmFuc2Zvcm1Ob2Rlc0J5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRNZXNoQnlVbmlxdWVJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRNZXNoQnlVbmlxdWVJZChjKX0sbmUucHJvdG90eXBlLmdldExhc3RNZXNoQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXRMYXN0TWVzaEJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXRMYXN0RW50cnlCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmdldExhc3RFbnRyeUJ5SWQoYyl9LG5lLnByb3RvdHlwZS5nZXROb2RlQnlJRD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5nZXROb2RlQnlJZChjKX0sbmUucHJvdG90eXBlLmdldExhc3RTa2VsZXRvbkJ5SUQ9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuZ2V0TGFzdFNrZWxldG9uQnlJZChjKX07ZnVuY3Rpb24gSXMoYyxlLHQpe3RyeXtjb25zdCBpPWMubmV4dCgpO2kuZG9uZT9lKGkpOmkudmFsdWU/aS52YWx1ZS50aGVuKCgpPT57aS52YWx1ZT12b2lkIDAsZShpKX0sdCk6ZShpKX1jYXRjaChpKXt0KGkpfX1mdW5jdGlvbiB3bihjPTI1KXtsZXQgZTtyZXR1cm4odCxpLHMpPT57Y29uc3Qgcj1wZXJmb3JtYW5jZS5ub3coKTtlPT09dm9pZCAwfHxyLWU+Yz8oZT1yLHNldFRpbWVvdXQoKCk9PntJcyh0LGkscyl9LDApKTpJcyh0LGkscyl9fWZ1bmN0aW9uIEFyKGMsZSx0LGkscyl7Y29uc3Qgcj0oKT0+e2xldCBuO2NvbnN0IGE9bz0+e28uZG9uZT90KG8udmFsdWUpOm49PT12b2lkIDA/bj0hMDpyKCl9O2RvIG49dm9pZCAwLCFzfHwhcy5hYm9ydGVkP2UoYyxhLGkpOmkobmV3IEVycm9yKCJBYm9ydGVkIikpLG49PT12b2lkIDAmJihuPSExKTt3aGlsZShuKX07cigpfWZ1bmN0aW9uIFBzKGMsZSl7bGV0IHQ7cmV0dXJuIEFyKGMsSXMsaT0+dD1pLGk9Pnt0aHJvdyBpfSxlKSx0fWZ1bmN0aW9uIE9uKGMsZSx0KXtyZXR1cm4gbmV3IFByb21pc2UoKGkscyk9PntBcihjLGUsaSxzLHQpfSl9ZnVuY3Rpb24gTG4oYyxlKXtyZXR1cm4oLi4udCk9PlBzKGMoLi4udCksZSl9Y2xhc3MgTm57Y29uc3RydWN0b3IoKXt0aGlzLl9kb05vdFNlcmlhbGl6ZT0hMSx0aGlzLl9pc0Rpc3Bvc2VkPSExLHRoaXMuX3NjZW5lUm9vdE5vZGVzSW5kZXg9LTEsdGhpcy5faXNFbmFibGVkPSEwLHRoaXMuX2lzUGFyZW50RW5hYmxlZD0hMCx0aGlzLl9pc1JlYWR5PSEwLHRoaXMuX29uRW5hYmxlZFN0YXRlQ2hhbmdlZE9ic2VydmFibGU9bmV3IEYsdGhpcy5fb25DbG9uZWRPYnNlcnZhYmxlPW5ldyBGfX1jbGFzcyB6ZXtjb25zdHJ1Y3RvcihlLHQ9bnVsbCl7dGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9ub2RlRGF0YVN0b3JhZ2U9bmV3IE5uLHRoaXMuc3RhdGU9IiIsdGhpcy5tZXRhZGF0YT1udWxsLHRoaXMucmVzZXJ2ZWREYXRhU3RvcmU9bnVsbCx0aGlzLl9hY2Nlc3NpYmlsaXR5VGFnPW51bGwsdGhpcy5vbkFjY2Vzc2liaWxpdHlUYWdDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9wYXJlbnRDb250YWluZXI9bnVsbCx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuX3Jhbmdlcz17fSx0aGlzLm9uUmVhZHk9bnVsbCx0aGlzLl9jdXJyZW50UmVuZGVySWQ9LTEsdGhpcy5fcGFyZW50VXBkYXRlSWQ9LTEsdGhpcy5fY2hpbGRVcGRhdGVJZD0tMSx0aGlzLl93YWl0aW5nUGFyZW50SWQ9bnVsbCx0aGlzLl93YWl0aW5nUGFyZW50SW5zdGFuY2VJbmRleD1udWxsLHRoaXMuX3dhaXRpbmdQYXJzZWRVbmlxdWVJZD1udWxsLHRoaXMuX2NhY2hlPXt9LHRoaXMuX3BhcmVudE5vZGU9bnVsbCx0aGlzLl9jaGlsZHJlbj1udWxsLHRoaXMuX3dvcmxkTWF0cml4PXguSWRlbnRpdHkoKSx0aGlzLl93b3JsZE1hdHJpeERldGVybWluYW50PTAsdGhpcy5fd29ybGRNYXRyaXhEZXRlcm1pbmFudElzRGlydHk9ITAsdGhpcy5fYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlPW51bGwsdGhpcy5faXNOb2RlPSEwLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj1udWxsLHRoaXMuX2JlaGF2aW9ycz1uZXcgQXJyYXksdGhpcy5uYW1lPWUsdGhpcy5pZD1lLHRoaXMuX3NjZW5lPXR8fGZlLkxhc3RDcmVhdGVkU2NlbmUsdGhpcy51bmlxdWVJZD10aGlzLl9zY2VuZS5nZXRVbmlxdWVJZCgpLHRoaXMuX2luaXRDYWNoZSgpfXN0YXRpYyBBZGROb2RlQ29uc3RydWN0b3IoZSx0KXt0aGlzLl9Ob2RlQ29uc3RydWN0b3JzW2VdPXR9c3RhdGljIENvbnN0cnVjdChlLHQsaSxzKXtjb25zdCByPXRoaXMuX05vZGVDb25zdHJ1Y3RvcnNbZV07cmV0dXJuIHI/cih0LGkscyk6bnVsbH1zZXQgYWNjZXNzaWJpbGl0eVRhZyhlKXt0aGlzLl9hY2Nlc3NpYmlsaXR5VGFnPWUsdGhpcy5vbkFjY2Vzc2liaWxpdHlUYWdDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZSl9Z2V0IGFjY2Vzc2liaWxpdHlUYWcoKXtyZXR1cm4gdGhpcy5fYWNjZXNzaWJpbGl0eVRhZ31nZXQgZG9Ob3RTZXJpYWxpemUoKXtyZXR1cm4gdGhpcy5fbm9kZURhdGFTdG9yYWdlLl9kb05vdFNlcmlhbGl6ZT8hMDp0aGlzLl9wYXJlbnROb2RlP3RoaXMuX3BhcmVudE5vZGUuZG9Ob3RTZXJpYWxpemU6ITF9c2V0IGRvTm90U2VyaWFsaXplKGUpe3RoaXMuX25vZGVEYXRhU3RvcmFnZS5fZG9Ob3RTZXJpYWxpemU9ZX1pc0Rpc3Bvc2VkKCl7cmV0dXJuIHRoaXMuX25vZGVEYXRhU3RvcmFnZS5faXNEaXNwb3NlZH1zZXQgcGFyZW50KGUpe2lmKHRoaXMuX3BhcmVudE5vZGU9PT1lKXJldHVybjtjb25zdCB0PXRoaXMuX3BhcmVudE5vZGU7aWYodGhpcy5fcGFyZW50Tm9kZSYmdGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4hPT12b2lkIDAmJnRoaXMuX3BhcmVudE5vZGUuX2NoaWxkcmVuIT09bnVsbCl7Y29uc3QgaT10aGlzLl9wYXJlbnROb2RlLl9jaGlsZHJlbi5pbmRleE9mKHRoaXMpO2khPT0tMSYmdGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4uc3BsaWNlKGksMSksIWUmJiF0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRGlzcG9zZWQmJnRoaXMuX2FkZFRvU2NlbmVSb290Tm9kZXMoKX10aGlzLl9wYXJlbnROb2RlPWUsdGhpcy5fcGFyZW50Tm9kZSYmKCh0aGlzLl9wYXJlbnROb2RlLl9jaGlsZHJlbj09PXZvaWQgMHx8dGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW49PT1udWxsKSYmKHRoaXMuX3BhcmVudE5vZGUuX2NoaWxkcmVuPW5ldyBBcnJheSksdGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRyZW4ucHVzaCh0aGlzKSx0fHx0aGlzLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKSksdGhpcy5fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpfWdldCBwYXJlbnQoKXtyZXR1cm4gdGhpcy5fcGFyZW50Tm9kZX1fc2VyaWFsaXplQXNQYXJlbnQoZSl7ZS5wYXJlbnRJZD10aGlzLnVuaXF1ZUlkfV9hZGRUb1NjZW5lUm9vdE5vZGVzKCl7dGhpcy5fbm9kZURhdGFTdG9yYWdlLl9zY2VuZVJvb3ROb2Rlc0luZGV4PT09LTEmJih0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXg9dGhpcy5fc2NlbmUucm9vdE5vZGVzLmxlbmd0aCx0aGlzLl9zY2VuZS5yb290Tm9kZXMucHVzaCh0aGlzKSl9X3JlbW92ZUZyb21TY2VuZVJvb3ROb2Rlcygpe2lmKHRoaXMuX25vZGVEYXRhU3RvcmFnZS5fc2NlbmVSb290Tm9kZXNJbmRleCE9PS0xKXtjb25zdCBlPXRoaXMuX3NjZW5lLnJvb3ROb2Rlcyx0PWUubGVuZ3RoLTE7ZVt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXhdPWVbdF0sZVt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXhdLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXg9dGhpcy5fbm9kZURhdGFTdG9yYWdlLl9zY2VuZVJvb3ROb2Rlc0luZGV4LHRoaXMuX3NjZW5lLnJvb3ROb2Rlcy5wb3AoKSx0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX3NjZW5lUm9vdE5vZGVzSW5kZXg9LTF9fWdldCBhbmltYXRpb25Qcm9wZXJ0aWVzT3ZlcnJpZGUoKXtyZXR1cm4gdGhpcy5fYW5pbWF0aW9uUHJvcGVydGllc092ZXJyaWRlP3RoaXMuX2FuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZTp0aGlzLl9zY2VuZS5hbmltYXRpb25Qcm9wZXJ0aWVzT3ZlcnJpZGV9c2V0IGFuaW1hdGlvblByb3BlcnRpZXNPdmVycmlkZShlKXt0aGlzLl9hbmltYXRpb25Qcm9wZXJ0aWVzT3ZlcnJpZGU9ZX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iTm9kZSJ9c2V0IG9uRGlzcG9zZShlKXt0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlciYmdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlciksdGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXI9dGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZChlKX1nZXQgb25FbmFibGVkU3RhdGVDaGFuZ2VkT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX29uRW5hYmxlZFN0YXRlQ2hhbmdlZE9ic2VydmFibGV9Z2V0IG9uQ2xvbmVkT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX29uQ2xvbmVkT2JzZXJ2YWJsZX1nZXRTY2VuZSgpe3JldHVybiB0aGlzLl9zY2VuZX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCl9YWRkQmVoYXZpb3IoZSx0PSExKXtyZXR1cm4gdGhpcy5fYmVoYXZpb3JzLmluZGV4T2YoZSkhPT0tMT90aGlzOihlLmluaXQoKSx0aGlzLl9zY2VuZS5pc0xvYWRpbmcmJiF0P3RoaXMuX3NjZW5lLm9uRGF0YUxvYWRlZE9ic2VydmFibGUuYWRkT25jZSgoKT0+e2UuYXR0YWNoKHRoaXMpfSk6ZS5hdHRhY2godGhpcyksdGhpcy5fYmVoYXZpb3JzLnB1c2goZSksdGhpcyl9cmVtb3ZlQmVoYXZpb3IoZSl7Y29uc3QgdD10aGlzLl9iZWhhdmlvcnMuaW5kZXhPZihlKTtyZXR1cm4gdD09PS0xP3RoaXM6KHRoaXMuX2JlaGF2aW9yc1t0XS5kZXRhY2goKSx0aGlzLl9iZWhhdmlvcnMuc3BsaWNlKHQsMSksdGhpcyl9Z2V0IGJlaGF2aW9ycygpe3JldHVybiB0aGlzLl9iZWhhdmlvcnN9Z2V0QmVoYXZpb3JCeU5hbWUoZSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fYmVoYXZpb3JzKWlmKHQubmFtZT09PWUpcmV0dXJuIHQ7cmV0dXJuIG51bGx9Z2V0V29ybGRNYXRyaXgoKXtyZXR1cm4gdGhpcy5fY3VycmVudFJlbmRlcklkIT09dGhpcy5fc2NlbmUuZ2V0UmVuZGVySWQoKSYmdGhpcy5jb21wdXRlV29ybGRNYXRyaXgoKSx0aGlzLl93b3JsZE1hdHJpeH1fZ2V0V29ybGRNYXRyaXhEZXRlcm1pbmFudCgpe3JldHVybiB0aGlzLl93b3JsZE1hdHJpeERldGVybWluYW50SXNEaXJ0eSYmKHRoaXMuX3dvcmxkTWF0cml4RGV0ZXJtaW5hbnRJc0RpcnR5PSExLHRoaXMuX3dvcmxkTWF0cml4RGV0ZXJtaW5hbnQ9dGhpcy5fd29ybGRNYXRyaXguZGV0ZXJtaW5hbnQoKSksdGhpcy5fd29ybGRNYXRyaXhEZXRlcm1pbmFudH1nZXQgd29ybGRNYXRyaXhGcm9tQ2FjaGUoKXtyZXR1cm4gdGhpcy5fd29ybGRNYXRyaXh9X2luaXRDYWNoZSgpe3RoaXMuX2NhY2hlPXt9LHRoaXMuX2NhY2hlLnBhcmVudD12b2lkIDB9dXBkYXRlQ2FjaGUoZSl7IWUmJnRoaXMuaXNTeW5jaHJvbml6ZWQoKXx8KHRoaXMuX2NhY2hlLnBhcmVudD10aGlzLnBhcmVudCx0aGlzLl91cGRhdGVDYWNoZSgpKX1fZ2V0QWN0aW9uTWFuYWdlckZvclRyaWdnZXIoZSx0PSEwKXtyZXR1cm4gdGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQuX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKGUsITEpOm51bGx9X3VwZGF0ZUNhY2hlKGUpe31faXNTeW5jaHJvbml6ZWQoKXtyZXR1cm4hMH1fbWFya1N5bmNlZFdpdGhQYXJlbnQoKXt0aGlzLl9wYXJlbnROb2RlJiYodGhpcy5fcGFyZW50VXBkYXRlSWQ9dGhpcy5fcGFyZW50Tm9kZS5fY2hpbGRVcGRhdGVJZCl9aXNTeW5jaHJvbml6ZWRXaXRoUGFyZW50KCl7cmV0dXJuIHRoaXMuX3BhcmVudE5vZGU/dGhpcy5fcGFyZW50Tm9kZS5faXNEaXJ0eXx8dGhpcy5fcGFyZW50VXBkYXRlSWQhPT10aGlzLl9wYXJlbnROb2RlLl9jaGlsZFVwZGF0ZUlkPyExOnRoaXMuX3BhcmVudE5vZGUuaXNTeW5jaHJvbml6ZWQoKTohMH1pc1N5bmNocm9uaXplZCgpe3JldHVybiB0aGlzLl9jYWNoZS5wYXJlbnQhPT10aGlzLl9wYXJlbnROb2RlPyh0aGlzLl9jYWNoZS5wYXJlbnQ9dGhpcy5fcGFyZW50Tm9kZSwhMSk6dGhpcy5fcGFyZW50Tm9kZSYmIXRoaXMuaXNTeW5jaHJvbml6ZWRXaXRoUGFyZW50KCk/ITE6dGhpcy5faXNTeW5jaHJvbml6ZWQoKX1pc1JlYWR5KGU9ITEpe3JldHVybiB0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUmVhZHl9bWFya0FzRGlydHkoZSl7cmV0dXJuIHRoaXMuX2N1cnJlbnRSZW5kZXJJZD1OdW1iZXIuTUFYX1ZBTFVFLHRoaXMuX2lzRGlydHk9ITAsdGhpc31pc0VuYWJsZWQoZT0hMCl7cmV0dXJuIGU9PT0hMT90aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZDp0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZD90aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUGFyZW50RW5hYmxlZDohMX1fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpe3RoaXMuX25vZGVEYXRhU3RvcmFnZS5faXNQYXJlbnRFbmFibGVkPXRoaXMuX3BhcmVudE5vZGU/dGhpcy5fcGFyZW50Tm9kZS5pc0VuYWJsZWQoKTohMCx0aGlzLl9jaGlsZHJlbiYmdGhpcy5fY2hpbGRyZW4uZm9yRWFjaChlPT57ZS5fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpfSl9c2V0RW5hYmxlZChlKXt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZCE9PWUmJih0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzRW5hYmxlZD1lLHRoaXMuX3N5bmNQYXJlbnRFbmFibGVkU3RhdGUoKSx0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX29uRW5hYmxlZFN0YXRlQ2hhbmdlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKX1pc0Rlc2NlbmRhbnRPZihlKXtyZXR1cm4gdGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQ9PT1lPyEwOnRoaXMucGFyZW50LmlzRGVzY2VuZGFudE9mKGUpOiExfV9nZXREZXNjZW5kYW50cyhlLHQ9ITEsaSl7aWYodGhpcy5fY2hpbGRyZW4pZm9yKGxldCBzPTA7czx0aGlzLl9jaGlsZHJlbi5sZW5ndGg7cysrKXtjb25zdCByPXRoaXMuX2NoaWxkcmVuW3NdOyghaXx8aShyKSkmJmUucHVzaChyKSx0fHxyLl9nZXREZXNjZW5kYW50cyhlLCExLGkpfX1nZXREZXNjZW5kYW50cyhlLHQpe2NvbnN0IGk9bmV3IEFycmF5O3JldHVybiB0aGlzLl9nZXREZXNjZW5kYW50cyhpLGUsdCksaX1nZXRDaGlsZE1lc2hlcyhlLHQpe2NvbnN0IGk9W107cmV0dXJuIHRoaXMuX2dldERlc2NlbmRhbnRzKGksZSxzPT4oIXR8fHQocykpJiZzLmN1bGxpbmdTdHJhdGVneSE9PXZvaWQgMCksaX1nZXRDaGlsZHJlbihlLHQ9ITApe3JldHVybiB0aGlzLmdldERlc2NlbmRhbnRzKHQsZSl9X3NldFJlYWR5KGUpe2lmKGUhPT10aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUmVhZHkpe2lmKCFlKXt0aGlzLl9ub2RlRGF0YVN0b3JhZ2UuX2lzUmVhZHk9ITE7cmV0dXJufXRoaXMub25SZWFkeSYmdGhpcy5vblJlYWR5KHRoaXMpLHRoaXMuX25vZGVEYXRhU3RvcmFnZS5faXNSZWFkeT0hMH19Z2V0QW5pbWF0aW9uQnlOYW1lKGUpe2ZvcihsZXQgdD0wO3Q8dGhpcy5hbmltYXRpb25zLmxlbmd0aDt0Kyspe2NvbnN0IGk9dGhpcy5hbmltYXRpb25zW3RdO2lmKGkubmFtZT09PWUpcmV0dXJuIGl9cmV0dXJuIG51bGx9Y3JlYXRlQW5pbWF0aW9uUmFuZ2UoZSx0LGkpe2lmKCF0aGlzLl9yYW5nZXNbZV0pe3RoaXMuX3Jhbmdlc1tlXT16ZS5fQW5pbWF0aW9uUmFuZ2VGYWN0b3J5KGUsdCxpKTtmb3IobGV0IHM9MCxyPXRoaXMuYW5pbWF0aW9ucy5sZW5ndGg7czxyO3MrKyl0aGlzLmFuaW1hdGlvbnNbc10mJnRoaXMuYW5pbWF0aW9uc1tzXS5jcmVhdGVSYW5nZShlLHQsaSl9fWRlbGV0ZUFuaW1hdGlvblJhbmdlKGUsdD0hMCl7Zm9yKGxldCBpPTAscz10aGlzLmFuaW1hdGlvbnMubGVuZ3RoO2k8cztpKyspdGhpcy5hbmltYXRpb25zW2ldJiZ0aGlzLmFuaW1hdGlvbnNbaV0uZGVsZXRlUmFuZ2UoZSx0KTt0aGlzLl9yYW5nZXNbZV09bnVsbH1nZXRBbmltYXRpb25SYW5nZShlKXtyZXR1cm4gdGhpcy5fcmFuZ2VzW2VdfHxudWxsfWdldEFuaW1hdGlvblJhbmdlcygpe2NvbnN0IGU9W107bGV0IHQ7Zm9yKHQgaW4gdGhpcy5fcmFuZ2VzKWUucHVzaCh0aGlzLl9yYW5nZXNbdF0pO3JldHVybiBlfWJlZ2luQW5pbWF0aW9uKGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5nZXRBbmltYXRpb25SYW5nZShlKTtyZXR1cm4gcj90aGlzLl9zY2VuZS5iZWdpbkFuaW1hdGlvbih0aGlzLHIuZnJvbSxyLnRvLHQsaSxzKTpudWxsfXNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcygpe2NvbnN0IGU9W107Zm9yKGNvbnN0IHQgaW4gdGhpcy5fcmFuZ2VzKXtjb25zdCBpPXRoaXMuX3Jhbmdlc1t0XTtpZighaSljb250aW51ZTtjb25zdCBzPXt9O3MubmFtZT10LHMuZnJvbT1pLmZyb20scy50bz1pLnRvLGUucHVzaChzKX1yZXR1cm4gZX1jb21wdXRlV29ybGRNYXRyaXgoZSl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fHwodGhpcy5fd29ybGRNYXRyaXg9eC5JZGVudGl0eSgpKSx0aGlzLl93b3JsZE1hdHJpeH1kaXNwb3NlKGUsdD0hMSl7aWYodGhpcy5fbm9kZURhdGFTdG9yYWdlLl9pc0Rpc3Bvc2VkPSEwLCFlKXtjb25zdCBpPXRoaXMuZ2V0RGVzY2VuZGFudHMoITApO2Zvcihjb25zdCBzIG9mIGkpcy5kaXNwb3NlKGUsdCl9dGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQ9bnVsbDp0aGlzLl9yZW1vdmVGcm9tU2NlbmVSb290Tm9kZXMoKSx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25FbmFibGVkU3RhdGVDaGFuZ2VkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLmNsZWFyKCk7Zm9yKGNvbnN0IGkgb2YgdGhpcy5fYmVoYXZpb3JzKWkuZGV0YWNoKCk7dGhpcy5fYmVoYXZpb3JzLmxlbmd0aD0wLHRoaXMubWV0YWRhdGE9bnVsbH1zdGF0aWMgUGFyc2VBbmltYXRpb25SYW5nZXMoZSx0LGkpe2lmKHQucmFuZ2VzKWZvcihsZXQgcz0wO3M8dC5yYW5nZXMubGVuZ3RoO3MrKyl7Y29uc3Qgcj10LnJhbmdlc1tzXTtlLmNyZWF0ZUFuaW1hdGlvblJhbmdlKHIubmFtZSxyLmZyb20sci50byl9fWdldEhpZXJhcmNoeUJvdW5kaW5nVmVjdG9ycyhlPSEwLHQ9bnVsbCl7dGhpcy5nZXRTY2VuZSgpLmluY3JlbWVudFJlbmRlcklkKCksdGhpcy5jb21wdXRlV29ybGRNYXRyaXgoITApO2xldCBpLHM7Y29uc3Qgcj10aGlzO2lmKHIuZ2V0Qm91bmRpbmdJbmZvJiZyLnN1Yk1lc2hlcyl7Y29uc3Qgbj1yLmdldEJvdW5kaW5nSW5mbygpO2k9bi5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQuY2xvbmUoKSxzPW4uYm91bmRpbmdCb3gubWF4aW11bVdvcmxkLmNsb25lKCl9ZWxzZSBpPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSxzPW5ldyBwKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKTtpZihlKXtjb25zdCBuPXRoaXMuZ2V0RGVzY2VuZGFudHMoITEpO2Zvcihjb25zdCBhIG9mIG4pe2NvbnN0IG89YTtpZihvLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksdCYmIXQobyl8fCFvLmdldEJvdW5kaW5nSW5mb3x8by5nZXRUb3RhbFZlcnRpY2VzKCk9PT0wKWNvbnRpbnVlO2NvbnN0IGw9by5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveCx1PWwubWluaW11bVdvcmxkLGQ9bC5tYXhpbXVtV29ybGQ7cC5DaGVja0V4dGVuZHModSxpLHMpLHAuQ2hlY2tFeHRlbmRzKGQsaSxzKX19cmV0dXJue21pbjppLG1heDpzfX19emUuX0FuaW1hdGlvblJhbmdlRmFjdG9yeT0oYyxlLHQpPT57dGhyb3cgJCgiQW5pbWF0aW9uUmFuZ2UiKX0semUuX05vZGVDb25zdHJ1Y3RvcnM9e30sVChbUigpXSx6ZS5wcm90b3R5cGUsIm5hbWUiLHZvaWQgMCksVChbUigpXSx6ZS5wcm90b3R5cGUsImlkIix2b2lkIDApLFQoW1IoKV0semUucHJvdG90eXBlLCJ1bmlxdWVJZCIsdm9pZCAwKSxUKFtSKCldLHplLnByb3RvdHlwZSwic3RhdGUiLHZvaWQgMCksVChbUigpXSx6ZS5wcm90b3R5cGUsIm1ldGFkYXRhIix2b2lkIDApO2NsYXNzIEJpe2NvbnN0cnVjdG9yKGUsdCxpLHMpe3RoaXMueD1lLHRoaXMueT10LHRoaXMud2lkdGg9aSx0aGlzLmhlaWdodD1zfXRvR2xvYmFsKGUsdCl7cmV0dXJuIG5ldyBCaSh0aGlzLngqZSx0aGlzLnkqdCx0aGlzLndpZHRoKmUsdGhpcy5oZWlnaHQqdCl9dG9HbG9iYWxUb1JlZihlLHQsaSl7cmV0dXJuIGkueD10aGlzLngqZSxpLnk9dGhpcy55KnQsaS53aWR0aD10aGlzLndpZHRoKmUsaS5oZWlnaHQ9dGhpcy5oZWlnaHQqdCx0aGlzfWNsb25lKCl7cmV0dXJuIG5ldyBCaSh0aGlzLngsdGhpcy55LHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpfX1jbGFzcyBqIGV4dGVuZHMgemV7Y29uc3RydWN0b3IoZSx0LGkscz0hMCl7c3VwZXIoZSxpKSx0aGlzLl9wb3NpdGlvbj1wLlplcm8oKSx0aGlzLl91cFZlY3Rvcj1wLlVwKCksdGhpcy5fb3J0aG9MZWZ0PW51bGwsdGhpcy5fb3J0aG9SaWdodD1udWxsLHRoaXMuX29ydGhvQm90dG9tPW51bGwsdGhpcy5fb3J0aG9Ub3A9bnVsbCx0aGlzLmZvdj0uOCx0aGlzLnByb2plY3Rpb25QbGFuZVRpbHQ9MCx0aGlzLm1pblo9MSx0aGlzLm1heFo9MWU0LHRoaXMuaW5lcnRpYT0uOSx0aGlzLl9tb2RlPWouUEVSU1BFQ1RJVkVfQ0FNRVJBLHRoaXMuaXNJbnRlcm1lZGlhdGU9ITEsdGhpcy52aWV3cG9ydD1uZXcgQmkoMCwwLDEsMSksdGhpcy5sYXllck1hc2s9MjY4NDM1NDU1LHRoaXMuZm92TW9kZT1qLkZPVk1PREVfVkVSVElDQUxfRklYRUQsdGhpcy5jYW1lcmFSaWdNb2RlPWouUklHX01PREVfTk9ORSx0aGlzLmN1c3RvbVJlbmRlclRhcmdldHM9bmV3IEFycmF5LHRoaXMub3V0cHV0UmVuZGVyVGFyZ2V0PW51bGwsdGhpcy5vblZpZXdNYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUHJvamVjdGlvbk1hdHJpeENoYW5nZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlckNoZWNrSW5wdXRzT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uUmVzdG9yZVN0YXRlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLmlzUmlnQ2FtZXJhPSExLHRoaXMuX3JpZ0NhbWVyYXM9bmV3IEFycmF5LHRoaXMuX3dlYnZyVmlld01hdHJpeD14LklkZW50aXR5KCksdGhpcy5fc2tpcFJlbmRlcmluZz0hMSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4PW5ldyB4LHRoaXMuX3Bvc3RQcm9jZXNzZXM9bmV3IEFycmF5LHRoaXMuX2FjdGl2ZU1lc2hlcz1uZXcgJGUoMjU2KSx0aGlzLl9nbG9iYWxQb3NpdGlvbj1wLlplcm8oKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg9eC5JZGVudGl0eSgpLHRoaXMuX2RvTm90Q29tcHV0ZVByb2plY3Rpb25NYXRyaXg9ITEsdGhpcy5fdHJhbnNmb3JtTWF0cml4PXguWmVybygpLHRoaXMuX3JlZnJlc2hGcnVzdHVtUGxhbmVzPSEwLHRoaXMuX2Fic29sdXRlUm90YXRpb249Wi5JZGVudGl0eSgpLHRoaXMuX2lzQ2FtZXJhPSEwLHRoaXMuX2lzTGVmdENhbWVyYT0hMSx0aGlzLl9pc1JpZ2h0Q2FtZXJhPSExLHRoaXMuZ2V0U2NlbmUoKS5hZGRDYW1lcmEodGhpcykscyYmIXRoaXMuZ2V0U2NlbmUoKS5hY3RpdmVDYW1lcmEmJih0aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhPXRoaXMpLHRoaXMucG9zaXRpb249dCx0aGlzLnJlbmRlclBhc3NJZD10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuY3JlYXRlUmVuZGVyUGFzc0lkKGBDYW1lcmEgJHtlfWApfWdldCBwb3NpdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvbn1zZXQgcG9zaXRpb24oZSl7dGhpcy5fcG9zaXRpb249ZX1zZXQgdXBWZWN0b3IoZSl7dGhpcy5fdXBWZWN0b3I9ZX1nZXQgdXBWZWN0b3IoKXtyZXR1cm4gdGhpcy5fdXBWZWN0b3J9Z2V0IHNjcmVlbkFyZWEoKXt2YXIgZSx0LGkscztsZXQgcj0wLG49MDtpZih0aGlzLm1vZGU9PT1qLlBFUlNQRUNUSVZFX0NBTUVSQSl0aGlzLmZvdk1vZGU9PT1qLkZPVk1PREVfVkVSVElDQUxfRklYRUQ/KG49dGhpcy5taW5aKjIqTWF0aC50YW4odGhpcy5mb3YvMikscj10aGlzLmdldEVuZ2luZSgpLmdldEFzcGVjdFJhdGlvKHRoaXMpKm4pOihyPXRoaXMubWluWioyKk1hdGgudGFuKHRoaXMuZm92LzIpLG49ci90aGlzLmdldEVuZ2luZSgpLmdldEFzcGVjdFJhdGlvKHRoaXMpKTtlbHNle2NvbnN0IGE9dGhpcy5nZXRFbmdpbmUoKS5nZXRSZW5kZXJXaWR0aCgpLzIsbz10aGlzLmdldEVuZ2luZSgpLmdldFJlbmRlckhlaWdodCgpLzI7cj0oKGU9dGhpcy5vcnRob1JpZ2h0KSE9PW51bGwmJmUhPT12b2lkIDA/ZTphKS0oKHQ9dGhpcy5vcnRob0xlZnQpIT09bnVsbCYmdCE9PXZvaWQgMD90Oi1hKSxuPSgoaT10aGlzLm9ydGhvVG9wKSE9PW51bGwmJmkhPT12b2lkIDA/aTpvKS0oKHM9dGhpcy5vcnRob0JvdHRvbSkhPT1udWxsJiZzIT09dm9pZCAwP3M6LW8pfXJldHVybiByKm59c2V0IG9ydGhvTGVmdChlKXt0aGlzLl9vcnRob0xlZnQ9ZTtmb3IoY29uc3QgdCBvZiB0aGlzLl9yaWdDYW1lcmFzKXQub3J0aG9MZWZ0PWV9Z2V0IG9ydGhvTGVmdCgpe3JldHVybiB0aGlzLl9vcnRob0xlZnR9c2V0IG9ydGhvUmlnaHQoZSl7dGhpcy5fb3J0aG9SaWdodD1lO2Zvcihjb25zdCB0IG9mIHRoaXMuX3JpZ0NhbWVyYXMpdC5vcnRob1JpZ2h0PWV9Z2V0IG9ydGhvUmlnaHQoKXtyZXR1cm4gdGhpcy5fb3J0aG9SaWdodH1zZXQgb3J0aG9Cb3R0b20oZSl7dGhpcy5fb3J0aG9Cb3R0b209ZTtmb3IoY29uc3QgdCBvZiB0aGlzLl9yaWdDYW1lcmFzKXQub3J0aG9Cb3R0b209ZX1nZXQgb3J0aG9Cb3R0b20oKXtyZXR1cm4gdGhpcy5fb3J0aG9Cb3R0b219c2V0IG9ydGhvVG9wKGUpe3RoaXMuX29ydGhvVG9wPWU7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fcmlnQ2FtZXJhcyl0Lm9ydGhvVG9wPWV9Z2V0IG9ydGhvVG9wKCl7cmV0dXJuIHRoaXMuX29ydGhvVG9wfXNldCBtb2RlKGUpe3RoaXMuX21vZGU9ZTtmb3IoY29uc3QgdCBvZiB0aGlzLl9yaWdDYW1lcmFzKXQubW9kZT1lfWdldCBtb2RlKCl7cmV0dXJuIHRoaXMuX21vZGV9c3RvcmVTdGF0ZSgpe3JldHVybiB0aGlzLl9zdGF0ZVN0b3JlZD0hMCx0aGlzLl9zdG9yZWRGb3Y9dGhpcy5mb3YsdGhpc31fcmVzdG9yZVN0YXRlVmFsdWVzKCl7cmV0dXJuIHRoaXMuX3N0YXRlU3RvcmVkPyh0aGlzLmZvdj10aGlzLl9zdG9yZWRGb3YsITApOiExfXJlc3RvcmVTdGF0ZSgpe3JldHVybiB0aGlzLl9yZXN0b3JlU3RhdGVWYWx1ZXMoKT8odGhpcy5vblJlc3RvcmVTdGF0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLCEwKTohMX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQ2FtZXJhIn10b1N0cmluZyhlKXtsZXQgdD0iTmFtZTogIit0aGlzLm5hbWU7aWYodCs9IiwgdHlwZTogIit0aGlzLmdldENsYXNzTmFtZSgpLHRoaXMuYW5pbWF0aW9ucylmb3IobGV0IGk9MDtpPHRoaXMuYW5pbWF0aW9ucy5sZW5ndGg7aSsrKXQrPSIsIGFuaW1hdGlvblswXTogIit0aGlzLmFuaW1hdGlvbnNbaV0udG9TdHJpbmcoZSk7cmV0dXJuIHR9YXBwbHlWZXJ0aWNhbENvcnJlY3Rpb24oKXtjb25zdCBlPXRoaXMuYWJzb2x1dGVSb3RhdGlvbi50b0V1bGVyQW5nbGVzKCk7dGhpcy5wcm9qZWN0aW9uUGxhbmVUaWx0PXRoaXMuX3NjZW5lLnVzZVJpZ2h0SGFuZGVkU3lzdGVtPy1lLng6ZS54fWdldCBnbG9iYWxQb3NpdGlvbigpe3JldHVybiB0aGlzLl9nbG9iYWxQb3NpdGlvbn1nZXRBY3RpdmVNZXNoZXMoKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzfWlzQWN0aXZlTWVzaChlKXtyZXR1cm4gdGhpcy5fYWN0aXZlTWVzaGVzLmluZGV4T2YoZSkhPT0tMX1pc1JlYWR5KGU9ITEpe2lmKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX3Bvc3RQcm9jZXNzZXMpaWYodCYmIXQuaXNSZWFkeSgpKXJldHVybiExfXJldHVybiBzdXBlci5pc1JlYWR5KGUpfV9pbml0Q2FjaGUoKXtzdXBlci5faW5pdENhY2hlKCksdGhpcy5fY2FjaGUucG9zaXRpb249bmV3IHAoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlLnVwVmVjdG9yPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSx0aGlzLl9jYWNoZS5tb2RlPXZvaWQgMCx0aGlzLl9jYWNoZS5taW5aPXZvaWQgMCx0aGlzLl9jYWNoZS5tYXhaPXZvaWQgMCx0aGlzLl9jYWNoZS5mb3Y9dm9pZCAwLHRoaXMuX2NhY2hlLmZvdk1vZGU9dm9pZCAwLHRoaXMuX2NhY2hlLmFzcGVjdFJhdGlvPXZvaWQgMCx0aGlzLl9jYWNoZS5vcnRob0xlZnQ9dm9pZCAwLHRoaXMuX2NhY2hlLm9ydGhvUmlnaHQ9dm9pZCAwLHRoaXMuX2NhY2hlLm9ydGhvQm90dG9tPXZvaWQgMCx0aGlzLl9jYWNoZS5vcnRob1RvcD12b2lkIDAsdGhpcy5fY2FjaGUucmVuZGVyV2lkdGg9dm9pZCAwLHRoaXMuX2NhY2hlLnJlbmRlckhlaWdodD12b2lkIDB9X3VwZGF0ZUNhY2hlKGUpe2V8fHN1cGVyLl91cGRhdGVDYWNoZSgpLHRoaXMuX2NhY2hlLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLHRoaXMuX2NhY2hlLnVwVmVjdG9yLmNvcHlGcm9tKHRoaXMudXBWZWN0b3IpfV9pc1N5bmNocm9uaXplZCgpe3JldHVybiB0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKSYmdGhpcy5faXNTeW5jaHJvbml6ZWRQcm9qZWN0aW9uTWF0cml4KCl9X2lzU3luY2hyb25pemVkVmlld01hdHJpeCgpe3JldHVybiBzdXBlci5faXNTeW5jaHJvbml6ZWQoKT90aGlzLl9jYWNoZS5wb3NpdGlvbi5lcXVhbHModGhpcy5wb3NpdGlvbikmJnRoaXMuX2NhY2hlLnVwVmVjdG9yLmVxdWFscyh0aGlzLnVwVmVjdG9yKSYmdGhpcy5pc1N5bmNocm9uaXplZFdpdGhQYXJlbnQoKTohMX1faXNTeW5jaHJvbml6ZWRQcm9qZWN0aW9uTWF0cml4KCl7bGV0IGU9dGhpcy5fY2FjaGUubW9kZT09PXRoaXMubW9kZSYmdGhpcy5fY2FjaGUubWluWj09PXRoaXMubWluWiYmdGhpcy5fY2FjaGUubWF4Wj09PXRoaXMubWF4WjtpZighZSlyZXR1cm4hMTtjb25zdCB0PXRoaXMuZ2V0RW5naW5lKCk7cmV0dXJuIHRoaXMubW9kZT09PWouUEVSU1BFQ1RJVkVfQ0FNRVJBP2U9dGhpcy5fY2FjaGUuZm92PT09dGhpcy5mb3YmJnRoaXMuX2NhY2hlLmZvdk1vZGU9PT10aGlzLmZvdk1vZGUmJnRoaXMuX2NhY2hlLmFzcGVjdFJhdGlvPT09dC5nZXRBc3BlY3RSYXRpbyh0aGlzKSYmdGhpcy5fY2FjaGUucHJvamVjdGlvblBsYW5lVGlsdD09PXRoaXMucHJvamVjdGlvblBsYW5lVGlsdDplPXRoaXMuX2NhY2hlLm9ydGhvTGVmdD09PXRoaXMub3J0aG9MZWZ0JiZ0aGlzLl9jYWNoZS5vcnRob1JpZ2h0PT09dGhpcy5vcnRob1JpZ2h0JiZ0aGlzLl9jYWNoZS5vcnRob0JvdHRvbT09PXRoaXMub3J0aG9Cb3R0b20mJnRoaXMuX2NhY2hlLm9ydGhvVG9wPT09dGhpcy5vcnRob1RvcCYmdGhpcy5fY2FjaGUucmVuZGVyV2lkdGg9PT10LmdldFJlbmRlcldpZHRoKCkmJnRoaXMuX2NhY2hlLnJlbmRlckhlaWdodD09PXQuZ2V0UmVuZGVySGVpZ2h0KCksZX1hdHRhY2hDb250cm9sKGUsdCl7fWRldGFjaENvbnRyb2woZSl7fXVwZGF0ZSgpe3RoaXMuX2NoZWNrSW5wdXRzKCksdGhpcy5jYW1lcmFSaWdNb2RlIT09ai5SSUdfTU9ERV9OT05FJiZ0aGlzLl91cGRhdGVSaWdDYW1lcmFzKCl9X2NoZWNrSW5wdXRzKCl7dGhpcy5vbkFmdGVyQ2hlY2tJbnB1dHNPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1nZXQgcmlnQ2FtZXJhcygpe3JldHVybiB0aGlzLl9yaWdDYW1lcmFzfWdldCByaWdQb3N0UHJvY2Vzcygpe3JldHVybiB0aGlzLl9yaWdQb3N0UHJvY2Vzc31fZ2V0Rmlyc3RQb3N0UHJvY2Vzcygpe2ZvcihsZXQgZT0wO2U8dGhpcy5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg7ZSsrKWlmKHRoaXMuX3Bvc3RQcm9jZXNzZXNbZV0hPT1udWxsKXJldHVybiB0aGlzLl9wb3N0UHJvY2Vzc2VzW2VdO3JldHVybiBudWxsfV9jYXNjYWRlUG9zdFByb2Nlc3Nlc1RvUmlnQ2Ftcygpe2NvbnN0IGU9dGhpcy5fZ2V0Rmlyc3RQb3N0UHJvY2VzcygpO2UmJmUubWFya1RleHR1cmVEaXJ0eSgpO2ZvcihsZXQgdD0wLGk9dGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg7dDxpO3QrKyl7Y29uc3Qgcz10aGlzLl9yaWdDYW1lcmFzW3RdLHI9cy5fcmlnUG9zdFByb2Nlc3M7cj8oci5nZXRFZmZlY3ROYW1lKCk9PT0icGFzcyImJihzLmlzSW50ZXJtZWRpYXRlPXRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoPT09MCkscy5fcG9zdFByb2Nlc3Nlcz10aGlzLl9wb3N0UHJvY2Vzc2VzLnNsaWNlKDApLmNvbmNhdChyKSxyLm1hcmtUZXh0dXJlRGlydHkoKSk6cy5fcG9zdFByb2Nlc3Nlcz10aGlzLl9wb3N0UHJvY2Vzc2VzLnNsaWNlKDApfX1hdHRhY2hQb3N0UHJvY2VzcyhlLHQ9bnVsbCl7cmV0dXJuIWUuaXNSZXVzYWJsZSgpJiZ0aGlzLl9wb3N0UHJvY2Vzc2VzLmluZGV4T2YoZSk+LTE/KE8uRXJyb3IoIllvdSdyZSB0cnlpbmcgdG8gcmV1c2UgYSBwb3N0IHByb2Nlc3Mgbm90IGRlZmluZWQgYXMgcmV1c2FibGUuIiksMCk6KHQ9PW51bGx8fHQ8MD90aGlzLl9wb3N0UHJvY2Vzc2VzLnB1c2goZSk6dGhpcy5fcG9zdFByb2Nlc3Nlc1t0XT09PW51bGw/dGhpcy5fcG9zdFByb2Nlc3Nlc1t0XT1lOnRoaXMuX3Bvc3RQcm9jZXNzZXMuc3BsaWNlKHQsMCxlKSx0aGlzLl9jYXNjYWRlUG9zdFByb2Nlc3Nlc1RvUmlnQ2FtcygpLHRoaXMuX3NjZW5lLnByZVBhc3NSZW5kZXJlciYmdGhpcy5fc2NlbmUucHJlUGFzc1JlbmRlcmVyLm1hcmtBc0RpcnR5KCksdGhpcy5fcG9zdFByb2Nlc3Nlcy5pbmRleE9mKGUpKX1kZXRhY2hQb3N0UHJvY2VzcyhlKXtjb25zdCB0PXRoaXMuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZihlKTt0IT09LTEmJih0aGlzLl9wb3N0UHJvY2Vzc2VzW3RdPW51bGwpLHRoaXMuX3NjZW5lLnByZVBhc3NSZW5kZXJlciYmdGhpcy5fc2NlbmUucHJlUGFzc1JlbmRlcmVyLm1hcmtBc0RpcnR5KCksdGhpcy5fY2FzY2FkZVBvc3RQcm9jZXNzZXNUb1JpZ0NhbXMoKX1nZXRXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKT90aGlzLl93b3JsZE1hdHJpeDoodGhpcy5nZXRWaWV3TWF0cml4KCksdGhpcy5fd29ybGRNYXRyaXgpfV9nZXRWaWV3TWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHkoKX1nZXRWaWV3TWF0cml4KGUpe3JldHVybiFlJiZ0aGlzLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKT90aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg6KHRoaXMudXBkYXRlQ2FjaGUoKSx0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXg9dGhpcy5fZ2V0Vmlld01hdHJpeCgpLHRoaXMuX2N1cnJlbnRSZW5kZXJJZD10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKSx0aGlzLl9jaGlsZFVwZGF0ZUlkKyssdGhpcy5fcmVmcmVzaEZydXN0dW1QbGFuZXM9ITAsdGhpcy5fY2FtZXJhUmlnUGFyYW1zJiZ0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJQcmVWaWV3TWF0cml4JiZ0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJQcmVWaWV3TWF0cml4LHRoaXMuX2NvbXB1dGVkVmlld01hdHJpeCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50Lm9uVmlld01hdHJpeENoYW5nZWRPYnNlcnZhYmxlJiZ0aGlzLnBhcmVudC5vblZpZXdNYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcy5wYXJlbnQpLHRoaXMub25WaWV3TWF0cml4Q2hhbmdlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX2NvbXB1dGVkVmlld01hdHJpeC5pbnZlcnRUb1JlZih0aGlzLl93b3JsZE1hdHJpeCksdGhpcy5fY29tcHV0ZWRWaWV3TWF0cml4KX1mcmVlemVQcm9qZWN0aW9uTWF0cml4KGUpe3RoaXMuX2RvTm90Q29tcHV0ZVByb2plY3Rpb25NYXRyaXg9ITAsZSE9PXZvaWQgMCYmKHRoaXMuX3Byb2plY3Rpb25NYXRyaXg9ZSl9dW5mcmVlemVQcm9qZWN0aW9uTWF0cml4KCl7dGhpcy5fZG9Ob3RDb21wdXRlUHJvamVjdGlvbk1hdHJpeD0hMX1nZXRQcm9qZWN0aW9uTWF0cml4KGUpe3ZhciB0LGkscyxyLG4sYSxvLGg7aWYodGhpcy5fZG9Ob3RDb21wdXRlUHJvamVjdGlvbk1hdHJpeHx8IWUmJnRoaXMuX2lzU3luY2hyb25pemVkUHJvamVjdGlvbk1hdHJpeCgpKXJldHVybiB0aGlzLl9wcm9qZWN0aW9uTWF0cml4O3RoaXMuX2NhY2hlLm1vZGU9dGhpcy5tb2RlLHRoaXMuX2NhY2hlLm1pblo9dGhpcy5taW5aLHRoaXMuX2NhY2hlLm1heFo9dGhpcy5tYXhaLHRoaXMuX3JlZnJlc2hGcnVzdHVtUGxhbmVzPSEwO2NvbnN0IGw9dGhpcy5nZXRFbmdpbmUoKSx1PXRoaXMuZ2V0U2NlbmUoKSxkPWwudXNlUmV2ZXJzZURlcHRoQnVmZmVyO2lmKHRoaXMubW9kZT09PWouUEVSU1BFQ1RJVkVfQ0FNRVJBKXt0aGlzLl9jYWNoZS5mb3Y9dGhpcy5mb3YsdGhpcy5fY2FjaGUuZm92TW9kZT10aGlzLmZvdk1vZGUsdGhpcy5fY2FjaGUuYXNwZWN0UmF0aW89bC5nZXRBc3BlY3RSYXRpbyh0aGlzKSx0aGlzLl9jYWNoZS5wcm9qZWN0aW9uUGxhbmVUaWx0PXRoaXMucHJvamVjdGlvblBsYW5lVGlsdCx0aGlzLm1pblo8PTAmJih0aGlzLm1pblo9LjEpO2xldCBmO3UudXNlUmlnaHRIYW5kZWRTeXN0ZW0/Zj14LlBlcnNwZWN0aXZlRm92UkhUb1JlZjpmPXguUGVyc3BlY3RpdmVGb3ZMSFRvUmVmLGYodGhpcy5mb3YsbC5nZXRBc3BlY3RSYXRpbyh0aGlzKSxkP3RoaXMubWF4Wjp0aGlzLm1pblosZD90aGlzLm1pblo6dGhpcy5tYXhaLHRoaXMuX3Byb2plY3Rpb25NYXRyaXgsdGhpcy5mb3ZNb2RlPT09ai5GT1ZNT0RFX1ZFUlRJQ0FMX0ZJWEVELGwuaXNORENIYWxmWlJhbmdlLHRoaXMucHJvamVjdGlvblBsYW5lVGlsdCxkKX1lbHNle2NvbnN0IGY9bC5nZXRSZW5kZXJXaWR0aCgpLzIsXz1sLmdldFJlbmRlckhlaWdodCgpLzI7dS51c2VSaWdodEhhbmRlZFN5c3RlbT94Lk9ydGhvT2ZmQ2VudGVyUkhUb1JlZigodD10aGlzLm9ydGhvTGVmdCkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6LWYsKGk9dGhpcy5vcnRob1JpZ2h0KSE9PW51bGwmJmkhPT12b2lkIDA/aTpmLChzPXRoaXMub3J0aG9Cb3R0b20pIT09bnVsbCYmcyE9PXZvaWQgMD9zOi1fLChyPXRoaXMub3J0aG9Ub3ApIT09bnVsbCYmciE9PXZvaWQgMD9yOl8sZD90aGlzLm1heFo6dGhpcy5taW5aLGQ/dGhpcy5taW5aOnRoaXMubWF4Wix0aGlzLl9wcm9qZWN0aW9uTWF0cml4LGwuaXNORENIYWxmWlJhbmdlKTp4Lk9ydGhvT2ZmQ2VudGVyTEhUb1JlZigobj10aGlzLm9ydGhvTGVmdCkhPT1udWxsJiZuIT09dm9pZCAwP246LWYsKGE9dGhpcy5vcnRob1JpZ2h0KSE9PW51bGwmJmEhPT12b2lkIDA/YTpmLChvPXRoaXMub3J0aG9Cb3R0b20pIT09bnVsbCYmbyE9PXZvaWQgMD9vOi1fLChoPXRoaXMub3J0aG9Ub3ApIT09bnVsbCYmaCE9PXZvaWQgMD9oOl8sZD90aGlzLm1heFo6dGhpcy5taW5aLGQ/dGhpcy5taW5aOnRoaXMubWF4Wix0aGlzLl9wcm9qZWN0aW9uTWF0cml4LGwuaXNORENIYWxmWlJhbmdlKSx0aGlzLl9jYWNoZS5vcnRob0xlZnQ9dGhpcy5vcnRob0xlZnQsdGhpcy5fY2FjaGUub3J0aG9SaWdodD10aGlzLm9ydGhvUmlnaHQsdGhpcy5fY2FjaGUub3J0aG9Cb3R0b209dGhpcy5vcnRob0JvdHRvbSx0aGlzLl9jYWNoZS5vcnRob1RvcD10aGlzLm9ydGhvVG9wLHRoaXMuX2NhY2hlLnJlbmRlcldpZHRoPWwuZ2V0UmVuZGVyV2lkdGgoKSx0aGlzLl9jYWNoZS5yZW5kZXJIZWlnaHQ9bC5nZXRSZW5kZXJIZWlnaHQoKX1yZXR1cm4gdGhpcy5vblByb2plY3Rpb25NYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5fcHJvamVjdGlvbk1hdHJpeH1nZXRUcmFuc2Zvcm1hdGlvbk1hdHJpeCgpe3JldHVybiB0aGlzLl9jb21wdXRlZFZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybU1hdHJpeCksdGhpcy5fdHJhbnNmb3JtTWF0cml4fV91cGRhdGVGcnVzdHVtUGxhbmVzKCl7dGhpcy5fcmVmcmVzaEZydXN0dW1QbGFuZXMmJih0aGlzLmdldFRyYW5zZm9ybWF0aW9uTWF0cml4KCksdGhpcy5fZnJ1c3R1bVBsYW5lcz9FdC5HZXRQbGFuZXNUb1JlZih0aGlzLl90cmFuc2Zvcm1NYXRyaXgsdGhpcy5fZnJ1c3R1bVBsYW5lcyk6dGhpcy5fZnJ1c3R1bVBsYW5lcz1FdC5HZXRQbGFuZXModGhpcy5fdHJhbnNmb3JtTWF0cml4KSx0aGlzLl9yZWZyZXNoRnJ1c3R1bVBsYW5lcz0hMSl9aXNJbkZydXN0dW0oZSx0PSExKXtpZih0aGlzLl91cGRhdGVGcnVzdHVtUGxhbmVzKCksdCYmdGhpcy5yaWdDYW1lcmFzLmxlbmd0aD4wKXtsZXQgaT0hMTtyZXR1cm4gdGhpcy5yaWdDYW1lcmFzLmZvckVhY2gocz0+e3MuX3VwZGF0ZUZydXN0dW1QbGFuZXMoKSxpPWl8fGUuaXNJbkZydXN0dW0ocy5fZnJ1c3R1bVBsYW5lcyl9KSxpfWVsc2UgcmV0dXJuIGUuaXNJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcyl9aXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpe3JldHVybiB0aGlzLl91cGRhdGVGcnVzdHVtUGxhbmVzKCksZS5pc0NvbXBsZXRlbHlJbkZydXN0dW0odGhpcy5fZnJ1c3R1bVBsYW5lcyl9Z2V0Rm9yd2FyZFJheShlPTEwMCx0LGkpe3Rocm93ICQoIlJheSIpfWdldEZvcndhcmRSYXlUb1JlZihlLHQ9MTAwLGkscyl7dGhyb3cgJCgiUmF5Iil9ZGlzcG9zZShlLHQ9ITEpe2Zvcih0aGlzLm9uVmlld01hdHJpeENoYW5nZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vblByb2plY3Rpb25NYXRyaXhDaGFuZ2VkT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlckNoZWNrSW5wdXRzT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25SZXN0b3JlU3RhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5pbnB1dHMmJnRoaXMuaW5wdXRzLmNsZWFyKCksdGhpcy5nZXRTY2VuZSgpLnN0b3BBbmltYXRpb24odGhpcyksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZUNhbWVyYSh0aGlzKTt0aGlzLl9yaWdDYW1lcmFzLmxlbmd0aD4wOyl7Y29uc3Qgcz10aGlzLl9yaWdDYW1lcmFzLnBvcCgpO3MmJnMuZGlzcG9zZSgpfWlmKHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3Qgcz10aGlzLl9wYXJlbnRDb250YWluZXIuY2FtZXJhcy5pbmRleE9mKHRoaXMpO3M+LTEmJnRoaXMuX3BhcmVudENvbnRhaW5lci5jYW1lcmFzLnNwbGljZShzLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKHRoaXMuX3JpZ1Bvc3RQcm9jZXNzKXRoaXMuX3JpZ1Bvc3RQcm9jZXNzLmRpc3Bvc2UodGhpcyksdGhpcy5fcmlnUG9zdFByb2Nlc3M9bnVsbCx0aGlzLl9wb3N0UHJvY2Vzc2VzLmxlbmd0aD0wO2Vsc2UgaWYodGhpcy5jYW1lcmFSaWdNb2RlIT09ai5SSUdfTU9ERV9OT05FKXRoaXMuX3JpZ1Bvc3RQcm9jZXNzPW51bGwsdGhpcy5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg9MDtlbHNle2xldCBzPXRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoO2Zvcig7LS1zPj0wOyl7Y29uc3Qgcj10aGlzLl9wb3N0UHJvY2Vzc2VzW3NdO3ImJnIuZGlzcG9zZSh0aGlzKX19bGV0IGk9dGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzLmxlbmd0aDtmb3IoOy0taT49MDspdGhpcy5jdXN0b21SZW5kZXJUYXJnZXRzW2ldLmRpc3Bvc2UoKTt0aGlzLmN1c3RvbVJlbmRlclRhcmdldHMubGVuZ3RoPTAsdGhpcy5fYWN0aXZlTWVzaGVzLmRpc3Bvc2UoKSx0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkucmVsZWFzZVJlbmRlclBhc3NJZCh0aGlzLnJlbmRlclBhc3NJZCksc3VwZXIuZGlzcG9zZShlLHQpfWdldCBpc0xlZnRDYW1lcmEoKXtyZXR1cm4gdGhpcy5faXNMZWZ0Q2FtZXJhfWdldCBpc1JpZ2h0Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX2lzUmlnaHRDYW1lcmF9Z2V0IGxlZnRDYW1lcmEoKXtyZXR1cm4gdGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg8MT9udWxsOnRoaXMuX3JpZ0NhbWVyYXNbMF19Z2V0IHJpZ2h0Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX3JpZ0NhbWVyYXMubGVuZ3RoPDI/bnVsbDp0aGlzLl9yaWdDYW1lcmFzWzFdfWdldExlZnRUYXJnZXQoKXtyZXR1cm4gdGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg8MT9udWxsOnRoaXMuX3JpZ0NhbWVyYXNbMF0uZ2V0VGFyZ2V0KCl9Z2V0UmlnaHRUYXJnZXQoKXtyZXR1cm4gdGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg8Mj9udWxsOnRoaXMuX3JpZ0NhbWVyYXNbMV0uZ2V0VGFyZ2V0KCl9c2V0Q2FtZXJhUmlnTW9kZShlLHQpe2lmKHRoaXMuY2FtZXJhUmlnTW9kZSE9PWUpe2Zvcig7dGhpcy5fcmlnQ2FtZXJhcy5sZW5ndGg+MDspe2NvbnN0IGk9dGhpcy5fcmlnQ2FtZXJhcy5wb3AoKTtpJiZpLmRpc3Bvc2UoKX1pZih0aGlzLmNhbWVyYVJpZ01vZGU9ZSx0aGlzLl9jYW1lcmFSaWdQYXJhbXM9e30sdGhpcy5fY2FtZXJhUmlnUGFyYW1zLmludGVyYXhpYWxEaXN0YW5jZT10LmludGVyYXhpYWxEaXN0YW5jZXx8LjA2MzcsdGhpcy5fY2FtZXJhUmlnUGFyYW1zLnN0ZXJlb0hhbGZBbmdsZT1ILlRvUmFkaWFucyh0aGlzLl9jYW1lcmFSaWdQYXJhbXMuaW50ZXJheGlhbERpc3RhbmNlLy4wNjM3KSx0aGlzLmNhbWVyYVJpZ01vZGUhPT1qLlJJR19NT0RFX05PTkUpe2NvbnN0IGk9dGhpcy5jcmVhdGVSaWdDYW1lcmEodGhpcy5uYW1lKyJfTCIsMCk7aSYmKGkuX2lzTGVmdENhbWVyYT0hMCk7Y29uc3Qgcz10aGlzLmNyZWF0ZVJpZ0NhbWVyYSh0aGlzLm5hbWUrIl9SIiwxKTtzJiYocy5faXNSaWdodENhbWVyYT0hMCksaSYmcyYmKHRoaXMuX3JpZ0NhbWVyYXMucHVzaChpKSx0aGlzLl9yaWdDYW1lcmFzLnB1c2gocykpfXRoaXMuX3NldFJpZ01vZGUodCksdGhpcy5fY2FzY2FkZVBvc3RQcm9jZXNzZXNUb1JpZ0NhbXMoKSx0aGlzLnVwZGF0ZSgpfX1fc2V0UmlnTW9kZShlKXt9X2dldFZSUHJvamVjdGlvbk1hdHJpeCgpe3JldHVybiB4LlBlcnNwZWN0aXZlRm92TEhUb1JlZih0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJNZXRyaWNzLmFzcGVjdFJhdGlvRm92LHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy52ck1ldHJpY3MuYXNwZWN0UmF0aW8sdGhpcy5taW5aLHRoaXMubWF4Wix0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJXb3JrTWF0cml4LCEwLHRoaXMuZ2V0RW5naW5lKCkuaXNORENIYWxmWlJhbmdlKSx0aGlzLl9jYW1lcmFSaWdQYXJhbXMudnJXb3JrTWF0cml4Lm11bHRpcGx5VG9SZWYodGhpcy5fY2FtZXJhUmlnUGFyYW1zLnZySE1hdHJpeCx0aGlzLl9wcm9qZWN0aW9uTWF0cml4KSx0aGlzLl9wcm9qZWN0aW9uTWF0cml4fV91cGRhdGVDYW1lcmFSb3RhdGlvbk1hdHJpeCgpe31fdXBkYXRlV2ViVlJDYW1lcmFSb3RhdGlvbk1hdHJpeCgpe31fZ2V0V2ViVlJQcm9qZWN0aW9uTWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHkoKX1fZ2V0V2ViVlJWaWV3TWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHkoKX1zZXRDYW1lcmFSaWdQYXJhbWV0ZXIoZSx0KXt0aGlzLl9jYW1lcmFSaWdQYXJhbXN8fCh0aGlzLl9jYW1lcmFSaWdQYXJhbXM9e30pLHRoaXMuX2NhbWVyYVJpZ1BhcmFtc1tlXT10LGU9PT0iaW50ZXJheGlhbERpc3RhbmNlIiYmKHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy5zdGVyZW9IYWxmQW5nbGU9SC5Ub1JhZGlhbnModC8uMDYzNykpfWNyZWF0ZVJpZ0NhbWVyYShlLHQpe3JldHVybiBudWxsfV91cGRhdGVSaWdDYW1lcmFzKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLl9yaWdDYW1lcmFzLmxlbmd0aDtlKyspdGhpcy5fcmlnQ2FtZXJhc1tlXS5taW5aPXRoaXMubWluWix0aGlzLl9yaWdDYW1lcmFzW2VdLm1heFo9dGhpcy5tYXhaLHRoaXMuX3JpZ0NhbWVyYXNbZV0uZm92PXRoaXMuZm92LHRoaXMuX3JpZ0NhbWVyYXNbZV0udXBWZWN0b3IuY29weUZyb20odGhpcy51cFZlY3Rvcik7dGhpcy5jYW1lcmFSaWdNb2RlPT09ai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEgmJih0aGlzLl9yaWdDYW1lcmFzWzBdLnZpZXdwb3J0PXRoaXMuX3JpZ0NhbWVyYXNbMV0udmlld3BvcnQ9dGhpcy52aWV3cG9ydCl9X3NldHVwSW5wdXRzKCl7fXNlcmlhbGl6ZSgpe2NvbnN0IGU9YWUuU2VyaWFsaXplKHRoaXMpO3JldHVybiBlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZS50eXBlPXRoaXMuZ2V0Q2xhc3NOYW1lKCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50Ll9zZXJpYWxpemVBc1BhcmVudChlKSx0aGlzLmlucHV0cyYmdGhpcy5pbnB1dHMuc2VyaWFsaXplKGUpLGFlLkFwcGVuZFNlcmlhbGl6ZWRBbmltYXRpb25zKHRoaXMsZSksZS5yYW5nZXM9dGhpcy5zZXJpYWxpemVBbmltYXRpb25SYW5nZXMoKSxlLmlzRW5hYmxlZD10aGlzLmlzRW5hYmxlZCgpLGV9Y2xvbmUoZSx0PW51bGwpe2NvbnN0IGk9YWUuQ2xvbmUoai5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKHRoaXMuZ2V0Q2xhc3NOYW1lKCksZSx0aGlzLmdldFNjZW5lKCksdGhpcy5pbnRlcmF4aWFsRGlzdGFuY2UsdGhpcy5pc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGUpLHRoaXMpO3JldHVybiBpLm5hbWU9ZSxpLnBhcmVudD10LHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhpKSxpfWdldERpcmVjdGlvbihlKXtjb25zdCB0PXAuWmVybygpO3JldHVybiB0aGlzLmdldERpcmVjdGlvblRvUmVmKGUsdCksdH1nZXQgYWJzb2x1dGVSb3RhdGlvbigpe3JldHVybiB0aGlzLmdldFdvcmxkTWF0cml4KCkuZGVjb21wb3NlKHZvaWQgMCx0aGlzLl9hYnNvbHV0ZVJvdGF0aW9uKSx0aGlzLl9hYnNvbHV0ZVJvdGF0aW9ufWdldERpcmVjdGlvblRvUmVmKGUsdCl7cC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLHRoaXMuZ2V0V29ybGRNYXRyaXgoKSx0KX1zdGF0aWMgR2V0Q29uc3RydWN0b3JGcm9tTmFtZShlLHQsaSxzPTAscj0hMCl7Y29uc3Qgbj16ZS5Db25zdHJ1Y3QoZSx0LGkse2ludGVyYXhpYWxfZGlzdGFuY2U6cyxpc1N0ZXJlb3Njb3BpY1NpZGVCeVNpZGU6cn0pO3JldHVybiBufHwoKCk9PmouX0NyZWF0ZURlZmF1bHRQYXJzZWRDYW1lcmEodCxpKSl9Y29tcHV0ZVdvcmxkTWF0cml4KCl7cmV0dXJuIHRoaXMuZ2V0V29ybGRNYXRyaXgoKX1zdGF0aWMgUGFyc2UoZSx0KXtjb25zdCBpPWUudHlwZSxzPWouR2V0Q29uc3RydWN0b3JGcm9tTmFtZShpLGUubmFtZSx0LGUuaW50ZXJheGlhbF9kaXN0YW5jZSxlLmlzU3RlcmVvc2NvcGljU2lkZUJ5U2lkZSkscj1hZS5QYXJzZShzLGUsdCk7aWYoZS5wYXJlbnRJZCE9PXZvaWQgMCYmKHIuX3dhaXRpbmdQYXJlbnRJZD1lLnBhcmVudElkKSxlLnBhcmVudEluc3RhbmNlSW5kZXghPT12b2lkIDAmJihyLl93YWl0aW5nUGFyZW50SW5zdGFuY2VJbmRleD1lLnBhcmVudEluc3RhbmNlSW5kZXgpLHIuaW5wdXRzJiYoci5pbnB1dHMucGFyc2UoZSksci5fc2V0dXBJbnB1dHMoKSksZS51cFZlY3RvciYmKHIudXBWZWN0b3I9cC5Gcm9tQXJyYXkoZS51cFZlY3RvcikpLHIuc2V0UG9zaXRpb24mJihyLnBvc2l0aW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwKSxyLnNldFBvc2l0aW9uKHAuRnJvbUFycmF5KGUucG9zaXRpb24pKSksZS50YXJnZXQmJnIuc2V0VGFyZ2V0JiZyLnNldFRhcmdldChwLkZyb21BcnJheShlLnRhcmdldCkpLGUuY2FtZXJhUmlnTW9kZSl7Y29uc3Qgbj1lLmludGVyYXhpYWxfZGlzdGFuY2U/e2ludGVyYXhpYWxEaXN0YW5jZTplLmludGVyYXhpYWxfZGlzdGFuY2V9Ont9O3Iuc2V0Q2FtZXJhUmlnTW9kZShlLmNhbWVyYVJpZ01vZGUsbil9aWYoZS5hbmltYXRpb25zKXtmb3IobGV0IG49MDtuPGUuYW5pbWF0aW9ucy5sZW5ndGg7bisrKXtjb25zdCBhPWUuYW5pbWF0aW9uc1tuXSxvPXJpKCJCQUJZTE9OLkFuaW1hdGlvbiIpO28mJnIuYW5pbWF0aW9ucy5wdXNoKG8uUGFyc2UoYSkpfXplLlBhcnNlQW5pbWF0aW9uUmFuZ2VzKHIsZSx0KX1yZXR1cm4gZS5hdXRvQW5pbWF0ZSYmdC5iZWdpbkFuaW1hdGlvbihyLGUuYXV0b0FuaW1hdGVGcm9tLGUuYXV0b0FuaW1hdGVUbyxlLmF1dG9BbmltYXRlTG9vcCxlLmF1dG9BbmltYXRlU3BlZWR8fDEpLGUuaXNFbmFibGVkIT09dm9pZCAwJiZyLnNldEVuYWJsZWQoZS5pc0VuYWJsZWQpLHJ9fWouX0NyZWF0ZURlZmF1bHRQYXJzZWRDYW1lcmE9KGMsZSk9Pnt0aHJvdyAkKCJVbml2ZXJzYWxDYW1lcmEiKX0sai5QRVJTUEVDVElWRV9DQU1FUkE9MCxqLk9SVEhPR1JBUEhJQ19DQU1FUkE9MSxqLkZPVk1PREVfVkVSVElDQUxfRklYRUQ9MCxqLkZPVk1PREVfSE9SSVpPTlRBTF9GSVhFRD0xLGouUklHX01PREVfTk9ORT0wLGouUklHX01PREVfU1RFUkVPU0NPUElDX0FOQUdMWVBIPTEwLGouUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfUEFSQUxMRUw9MTEsai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ9MTIsai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfT1ZFUlVOREVSPTEzLGouUklHX01PREVfU1RFUkVPU0NPUElDX0lOVEVSTEFDRUQ9MTQsai5SSUdfTU9ERV9WUj0yMCxqLlJJR19NT0RFX1dFQlZSPTIxLGouUklHX01PREVfQ1VTVE9NPTIyLGouRm9yY2VBdHRhY2hDb250cm9sVG9BbHdheXNQcmV2ZW50RGVmYXVsdD0hMSxUKFtCdCgicG9zaXRpb24iKV0sai5wcm90b3R5cGUsIl9wb3NpdGlvbiIsdm9pZCAwKSxUKFtCdCgidXBWZWN0b3IiKV0sai5wcm90b3R5cGUsIl91cFZlY3RvciIsdm9pZCAwKSxUKFtSKCldLGoucHJvdG90eXBlLCJvcnRob0xlZnQiLG51bGwpLFQoW1IoKV0sai5wcm90b3R5cGUsIm9ydGhvUmlnaHQiLG51bGwpLFQoW1IoKV0sai5wcm90b3R5cGUsIm9ydGhvQm90dG9tIixudWxsKSxUKFtSKCldLGoucHJvdG90eXBlLCJvcnRob1RvcCIsbnVsbCksVChbUigpXSxqLnByb3RvdHlwZSwiZm92Iix2b2lkIDApLFQoW1IoKV0sai5wcm90b3R5cGUsInByb2plY3Rpb25QbGFuZVRpbHQiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwibWluWiIsdm9pZCAwKSxUKFtSKCldLGoucHJvdG90eXBlLCJtYXhaIix2b2lkIDApLFQoW1IoKV0sai5wcm90b3R5cGUsImluZXJ0aWEiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwibW9kZSIsbnVsbCksVChbUigpXSxqLnByb3RvdHlwZSwibGF5ZXJNYXNrIix2b2lkIDApLFQoW1IoKV0sai5wcm90b3R5cGUsImZvdk1vZGUiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwiY2FtZXJhUmlnTW9kZSIsdm9pZCAwKSxUKFtSKCldLGoucHJvdG90eXBlLCJpbnRlcmF4aWFsRGlzdGFuY2UiLHZvaWQgMCksVChbUigpXSxqLnByb3RvdHlwZSwiaXNTdGVyZW9zY29waWNTaWRlQnlTaWRlIix2b2lkIDApO2NsYXNzIGVle2NvbnN0cnVjdG9yKCl7dGhpcy5fYXBwbHlUbz1Mbih0aGlzLl9hcHBseVRvQ29yb3V0aW5lLmJpbmQodGhpcykpfXNldChlLHQpe3N3aXRjaChlLmxlbmd0aHx8Ty5XYXJuKGBTZXR0aW5nIHZlcnRleCBkYXRhIGtpbmQgJyR7dH0nIHdpdGggYW4gZW1wdHkgYXJyYXlgKSx0KXtjYXNlIGcuUG9zaXRpb25LaW5kOnRoaXMucG9zaXRpb25zPWU7YnJlYWs7Y2FzZSBnLk5vcm1hbEtpbmQ6dGhpcy5ub3JtYWxzPWU7YnJlYWs7Y2FzZSBnLlRhbmdlbnRLaW5kOnRoaXMudGFuZ2VudHM9ZTticmVhaztjYXNlIGcuVVZLaW5kOnRoaXMudXZzPWU7YnJlYWs7Y2FzZSBnLlVWMktpbmQ6dGhpcy51dnMyPWU7YnJlYWs7Y2FzZSBnLlVWM0tpbmQ6dGhpcy51dnMzPWU7YnJlYWs7Y2FzZSBnLlVWNEtpbmQ6dGhpcy51dnM0PWU7YnJlYWs7Y2FzZSBnLlVWNUtpbmQ6dGhpcy51dnM1PWU7YnJlYWs7Y2FzZSBnLlVWNktpbmQ6dGhpcy51dnM2PWU7YnJlYWs7Y2FzZSBnLkNvbG9yS2luZDp0aGlzLmNvbG9ycz1lO2JyZWFrO2Nhc2UgZy5NYXRyaWNlc0luZGljZXNLaW5kOnRoaXMubWF0cmljZXNJbmRpY2VzPWU7YnJlYWs7Y2FzZSBnLk1hdHJpY2VzV2VpZ2h0c0tpbmQ6dGhpcy5tYXRyaWNlc1dlaWdodHM9ZTticmVhaztjYXNlIGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kOnRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmE9ZTticmVhaztjYXNlIGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kOnRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmE9ZTticmVha319YXBwbHlUb01lc2goZSx0KXtyZXR1cm4gdGhpcy5fYXBwbHlUbyhlLHQsITEpLHRoaXN9YXBwbHlUb0dlb21ldHJ5KGUsdCl7cmV0dXJuIHRoaXMuX2FwcGx5VG8oZSx0LCExKSx0aGlzfXVwZGF0ZU1lc2goZSl7cmV0dXJuIHRoaXMuX3VwZGF0ZShlKSx0aGlzfXVwZGF0ZUdlb21ldHJ5KGUpe3JldHVybiB0aGlzLl91cGRhdGUoZSksdGhpc30qX2FwcGx5VG9Db3JvdXRpbmUoZSx0PSExLGkpe3JldHVybiB0aGlzLnBvc2l0aW9ucyYmKGUuc2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLHRoaXMucG9zaXRpb25zLHQpLGkmJih5aWVsZCkpLHRoaXMubm9ybWFscyYmKGUuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0aGlzLm5vcm1hbHMsdCksaSYmKHlpZWxkKSksdGhpcy50YW5nZW50cyYmKGUuc2V0VmVydGljZXNEYXRhKGcuVGFuZ2VudEtpbmQsdGhpcy50YW5nZW50cyx0KSxpJiYoeWllbGQpKSx0aGlzLnV2cyYmKGUuc2V0VmVydGljZXNEYXRhKGcuVVZLaW5kLHRoaXMudXZzLHQpLGkmJih5aWVsZCkpLHRoaXMudXZzMiYmKGUuc2V0VmVydGljZXNEYXRhKGcuVVYyS2luZCx0aGlzLnV2czIsdCksaSYmKHlpZWxkKSksdGhpcy51dnMzJiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5VVjNLaW5kLHRoaXMudXZzMyx0KSxpJiYoeWllbGQpKSx0aGlzLnV2czQmJihlLnNldFZlcnRpY2VzRGF0YShnLlVWNEtpbmQsdGhpcy51dnM0LHQpLGkmJih5aWVsZCkpLHRoaXMudXZzNSYmKGUuc2V0VmVydGljZXNEYXRhKGcuVVY1S2luZCx0aGlzLnV2czUsdCksaSYmKHlpZWxkKSksdGhpcy51dnM2JiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5VVjZLaW5kLHRoaXMudXZzNix0KSxpJiYoeWllbGQpKSx0aGlzLmNvbG9ycyYmKGUuc2V0VmVydGljZXNEYXRhKGcuQ29sb3JLaW5kLHRoaXMuY29sb3JzLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNJbmRpY2VzJiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNXZWlnaHRzJiYoZS5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc1dlaWdodHNLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEmJihlLnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzSW5kaWNlc0V4dHJhLHQpLGkmJih5aWVsZCkpLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEmJihlLnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhLHQpLGkmJih5aWVsZCkpLHRoaXMuaW5kaWNlcz8oZS5zZXRJbmRpY2VzKHRoaXMuaW5kaWNlcyxudWxsLHQpLGkmJih5aWVsZCkpOmUuc2V0SW5kaWNlcyhbXSxudWxsKSx0aGlzfV91cGRhdGUoZSx0LGkpe3JldHVybiB0aGlzLnBvc2l0aW9ucyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdGhpcy5wb3NpdGlvbnMsdCxpKSx0aGlzLm5vcm1hbHMmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0aGlzLm5vcm1hbHMsdCxpKSx0aGlzLnRhbmdlbnRzJiZlLnVwZGF0ZVZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kLHRoaXMudGFuZ2VudHMsdCxpKSx0aGlzLnV2cyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5VVktpbmQsdGhpcy51dnMsdCxpKSx0aGlzLnV2czImJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVYyS2luZCx0aGlzLnV2czIsdCxpKSx0aGlzLnV2czMmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVYzS2luZCx0aGlzLnV2czMsdCxpKSx0aGlzLnV2czQmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVY0S2luZCx0aGlzLnV2czQsdCxpKSx0aGlzLnV2czUmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVY1S2luZCx0aGlzLnV2czUsdCxpKSx0aGlzLnV2czYmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuVVY2S2luZCx0aGlzLnV2czYsdCxpKSx0aGlzLmNvbG9ycyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Db2xvcktpbmQsdGhpcy5jb2xvcnMsdCxpKSx0aGlzLm1hdHJpY2VzSW5kaWNlcyYmZS51cGRhdGVWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzLHQsaSksdGhpcy5tYXRyaWNlc1dlaWdodHMmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0cyx0LGkpLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEmJmUudXBkYXRlVmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsdCxpKSx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhJiZlLnVwZGF0ZVZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhLHQsaSksdGhpcy5pbmRpY2VzJiZlLnNldEluZGljZXModGhpcy5pbmRpY2VzLG51bGwpLHRoaXN9c3RhdGljIF9UcmFuc2Zvcm1WZWN0b3IzQ29vcmRpbmF0ZXMoZSx0LGk9MCxzPWUubGVuZ3RoKXtjb25zdCByPUQuVmVjdG9yM1swXSxuPUQuVmVjdG9yM1sxXTtmb3IobGV0IGE9aTthPGkrczthKz0zKXAuRnJvbUFycmF5VG9SZWYoZSxhLHIpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihyLHQsbiksZVthXT1uLngsZVthKzFdPW4ueSxlW2ErMl09bi56fXN0YXRpYyBfVHJhbnNmb3JtVmVjdG9yM05vcm1hbHMoZSx0LGk9MCxzPWUubGVuZ3RoKXtjb25zdCByPUQuVmVjdG9yM1swXSxuPUQuVmVjdG9yM1sxXTtmb3IobGV0IGE9aTthPGkrczthKz0zKXAuRnJvbUFycmF5VG9SZWYoZSxhLHIpLHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYocix0LG4pLGVbYV09bi54LGVbYSsxXT1uLnksZVthKzJdPW4uen1zdGF0aWMgX1RyYW5zZm9ybVZlY3RvcjROb3JtYWxzKGUsdCxpPTAscz1lLmxlbmd0aCl7Y29uc3Qgcj1ELlZlY3RvcjRbMF0sbj1ELlZlY3RvcjRbMV07Zm9yKGxldCBhPWk7YTxpK3M7YSs9NClDZS5Gcm9tQXJyYXlUb1JlZihlLGEsciksQ2UuVHJhbnNmb3JtTm9ybWFsVG9SZWYocix0LG4pLGVbYV09bi54LGVbYSsxXT1uLnksZVthKzJdPW4ueixlW2ErM109bi53fXN0YXRpYyBfRmxpcEZhY2VzKGUsdD0wLGk9ZS5sZW5ndGgpe2ZvcihsZXQgcz10O3M8dCtpO3MrPTMpe2NvbnN0IHI9ZVtzKzFdO2VbcysxXT1lW3MrMl0sZVtzKzJdPXJ9fXRyYW5zZm9ybShlKXtjb25zdCB0PWUuZGV0ZXJtaW5hbnQoKTwwO3JldHVybiB0aGlzLnBvc2l0aW9ucyYmZWUuX1RyYW5zZm9ybVZlY3RvcjNDb29yZGluYXRlcyh0aGlzLnBvc2l0aW9ucyxlKSx0aGlzLm5vcm1hbHMmJmVlLl9UcmFuc2Zvcm1WZWN0b3IzTm9ybWFscyh0aGlzLm5vcm1hbHMsZSksdGhpcy50YW5nZW50cyYmZWUuX1RyYW5zZm9ybVZlY3RvcjROb3JtYWxzKHRoaXMudGFuZ2VudHMsZSksdCYmdGhpcy5pbmRpY2VzJiZlZS5fRmxpcEZhY2VzKHRoaXMuaW5kaWNlcyksdGhpc31tZXJnZShlLHQ9ITEsaT0hMSl7Y29uc3Qgcz1BcnJheS5pc0FycmF5KGUpP2UubWFwKHI9PltyLHZvaWQgMF0pOltbZSx2b2lkIDBdXTtyZXR1cm4gUHModGhpcy5fbWVyZ2VDb3JvdXRpbmUodm9pZCAwLHMsdCwhMSxpKSl9Kl9tZXJnZUNvcm91dGluZShlLHQsaT0hMSxzLHIpe3ZhciBuLGEsbyxoO3RoaXMuX3ZhbGlkYXRlKCk7Y29uc3QgbD10Lm1hcChfPT5fWzBdKTtmb3IoY29uc3QgXyBvZiBsKWlmKF8uX3ZhbGlkYXRlKCksIXRoaXMubm9ybWFscyE9IV8ubm9ybWFsc3x8IXRoaXMudGFuZ2VudHMhPSFfLnRhbmdlbnRzfHwhdGhpcy51dnMhPSFfLnV2c3x8IXRoaXMudXZzMiE9IV8udXZzMnx8IXRoaXMudXZzMyE9IV8udXZzM3x8IXRoaXMudXZzNCE9IV8udXZzNHx8IXRoaXMudXZzNSE9IV8udXZzNXx8IXRoaXMudXZzNiE9IV8udXZzNnx8IXRoaXMuY29sb3JzIT0hXy5jb2xvcnN8fCF0aGlzLm1hdHJpY2VzSW5kaWNlcyE9IV8ubWF0cmljZXNJbmRpY2VzfHwhdGhpcy5tYXRyaWNlc1dlaWdodHMhPSFfLm1hdHJpY2VzV2VpZ2h0c3x8IXRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEhPSFfLm1hdHJpY2VzSW5kaWNlc0V4dHJhfHwhdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSE9IV8ubWF0cmljZXNXZWlnaHRzRXh0cmEpdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgbWVyZ2UgdmVydGV4IGRhdGEgdGhhdCBkbyBub3QgaGF2ZSB0aGUgc2FtZSBzZXQgb2YgYXR0cmlidXRlcyIpO2NvbnN0IHU9bC5yZWR1Y2UoKF8sRSk9Pnt2YXIgbSx2O3JldHVybiBfKygodj0obT1FLmluZGljZXMpPT09bnVsbHx8bT09PXZvaWQgMD92b2lkIDA6bS5sZW5ndGgpIT09bnVsbCYmdiE9PXZvaWQgMD92OjApfSwoYT0obj10aGlzLmluZGljZXMpPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi5sZW5ndGgpIT09bnVsbCYmYSE9PXZvaWQgMD9hOjApO2xldCBmPXJ8fGwuc29tZShfPT5fLmluZGljZXM9PT10aGlzLmluZGljZXMpPyhvPXRoaXMuaW5kaWNlcyk9PT1udWxsfHxvPT09dm9pZCAwP3ZvaWQgMDpvLnNsaWNlKCk6dGhpcy5pbmRpY2VzO2lmKHU+MCl7bGV0IF89KGg9Zj09bnVsbD92b2lkIDA6Zi5sZW5ndGgpIT09bnVsbCYmaCE9PXZvaWQgMD9oOjA7aWYoZnx8KGY9bmV3IEFycmF5KHUpKSxmLmxlbmd0aCE9PXUpe2lmKEFycmF5LmlzQXJyYXkoZikpZi5sZW5ndGg9dTtlbHNle2NvbnN0IG09aXx8ZiBpbnN0YW5jZW9mIFVpbnQzMkFycmF5P25ldyBVaW50MzJBcnJheSh1KTpuZXcgVWludDE2QXJyYXkodSk7bS5zZXQoZiksZj1tfWUmJmUuZGV0ZXJtaW5hbnQoKTwwJiZlZS5fRmxpcEZhY2VzKGYsMCxfKX1sZXQgRT10aGlzLnBvc2l0aW9ucz90aGlzLnBvc2l0aW9ucy5sZW5ndGgvMzowO2Zvcihjb25zdFttLHZdb2YgdClpZihtLmluZGljZXMpe2ZvcihsZXQgUz0wO1M8bS5pbmRpY2VzLmxlbmd0aDtTKyspZltfK1NdPW0uaW5kaWNlc1tTXStFO3YmJnYuZGV0ZXJtaW5hbnQoKTwwJiZlZS5fRmxpcEZhY2VzKGYsXyxtLmluZGljZXMubGVuZ3RoKSxFKz1tLnBvc2l0aW9ucy5sZW5ndGgvMyxfKz1tLmluZGljZXMubGVuZ3RoLHMmJih5aWVsZCl9fXJldHVybiB0aGlzLmluZGljZXM9Zix0aGlzLnBvc2l0aW9ucz1lZS5fTWVyZ2VFbGVtZW50KGcuUG9zaXRpb25LaW5kLHRoaXMucG9zaXRpb25zLGUsdC5tYXAoXz0+W19bMF0ucG9zaXRpb25zLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLm5vcm1hbHM9ZWUuX01lcmdlRWxlbWVudChnLk5vcm1hbEtpbmQsdGhpcy5ub3JtYWxzLGUsdC5tYXAoXz0+W19bMF0ubm9ybWFscyxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy50YW5nZW50cz1lZS5fTWVyZ2VFbGVtZW50KGcuVGFuZ2VudEtpbmQsdGhpcy50YW5nZW50cyxlLHQubWFwKF89PltfWzBdLnRhbmdlbnRzLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLnV2cz1lZS5fTWVyZ2VFbGVtZW50KGcuVVZLaW5kLHRoaXMudXZzLGUsdC5tYXAoXz0+W19bMF0udXZzLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLnV2czI9ZWUuX01lcmdlRWxlbWVudChnLlVWMktpbmQsdGhpcy51dnMyLGUsdC5tYXAoXz0+W19bMF0udXZzMixfWzFdXSkpLHMmJih5aWVsZCksdGhpcy51dnMzPWVlLl9NZXJnZUVsZW1lbnQoZy5VVjNLaW5kLHRoaXMudXZzMyxlLHQubWFwKF89PltfWzBdLnV2czMsX1sxXV0pKSxzJiYoeWllbGQpLHRoaXMudXZzND1lZS5fTWVyZ2VFbGVtZW50KGcuVVY0S2luZCx0aGlzLnV2czQsZSx0Lm1hcChfPT5bX1swXS51dnM0LF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLnV2czU9ZWUuX01lcmdlRWxlbWVudChnLlVWNUtpbmQsdGhpcy51dnM1LGUsdC5tYXAoXz0+W19bMF0udXZzNSxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy51dnM2PWVlLl9NZXJnZUVsZW1lbnQoZy5VVjZLaW5kLHRoaXMudXZzNixlLHQubWFwKF89PltfWzBdLnV2czYsX1sxXV0pKSxzJiYoeWllbGQpLHRoaXMuY29sb3JzPWVlLl9NZXJnZUVsZW1lbnQoZy5Db2xvcktpbmQsdGhpcy5jb2xvcnMsZSx0Lm1hcChfPT5bX1swXS5jb2xvcnMsX1sxXV0pKSxzJiYoeWllbGQpLHRoaXMubWF0cmljZXNJbmRpY2VzPWVlLl9NZXJnZUVsZW1lbnQoZy5NYXRyaWNlc0luZGljZXNLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzLGUsdC5tYXAoXz0+W19bMF0ubWF0cmljZXNJbmRpY2VzLF9bMV1dKSkscyYmKHlpZWxkKSx0aGlzLm1hdHJpY2VzV2VpZ2h0cz1lZS5fTWVyZ2VFbGVtZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCx0aGlzLm1hdHJpY2VzV2VpZ2h0cyxlLHQubWFwKF89PltfWzBdLm1hdHJpY2VzV2VpZ2h0cyxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYT1lZS5fTWVyZ2VFbGVtZW50KGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEsZSx0Lm1hcChfPT5bX1swXS5tYXRyaWNlc0luZGljZXNFeHRyYSxfWzFdXSkpLHMmJih5aWVsZCksdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYT1lZS5fTWVyZ2VFbGVtZW50KGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEsZSx0Lm1hcChfPT5bX1swXS5tYXRyaWNlc1dlaWdodHNFeHRyYSxfWzFdXSkpLHRoaXN9c3RhdGljIF9NZXJnZUVsZW1lbnQoZSx0LGkscyl7Y29uc3Qgcj1zLmZpbHRlcihvPT5vWzBdIT09bnVsbCYmb1swXSE9PXZvaWQgMCk7aWYoIXQmJnIubGVuZ3RoPT0wKXJldHVybiB0O2lmKCF0KXJldHVybiB0aGlzLl9NZXJnZUVsZW1lbnQoZSxyWzBdWzBdLHJbMF1bMV0sci5zbGljZSgxKSk7Y29uc3Qgbj1yLnJlZHVjZSgobyxoKT0+bytoWzBdLmxlbmd0aCx0Lmxlbmd0aCksYT1lPT09Zy5Qb3NpdGlvbktpbmQ/ZWUuX1RyYW5zZm9ybVZlY3RvcjNDb29yZGluYXRlczplPT09Zy5Ob3JtYWxLaW5kP2VlLl9UcmFuc2Zvcm1WZWN0b3IzTm9ybWFsczplPT09Zy5UYW5nZW50S2luZD9lZS5fVHJhbnNmb3JtVmVjdG9yNE5vcm1hbHM6KCk9Pnt9O2lmKHQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkpe2NvbnN0IG89bmV3IEZsb2F0MzJBcnJheShuKTtvLnNldCh0KSxpJiZhKG8saSwwLHQubGVuZ3RoKTtsZXQgaD10Lmxlbmd0aDtmb3IoY29uc3RbbCx1XW9mIHIpby5zZXQobCxoKSx1JiZhKG8sdSxoLGwubGVuZ3RoKSxoKz1sLmxlbmd0aDtyZXR1cm4gb31lbHNle2NvbnN0IG89bmV3IEFycmF5KG4pO2ZvcihsZXQgbD0wO2w8dC5sZW5ndGg7bCsrKW9bbF09dFtsXTtpJiZhKG8saSwwLHQubGVuZ3RoKTtsZXQgaD10Lmxlbmd0aDtmb3IoY29uc3RbbCx1XW9mIHIpe2ZvcihsZXQgZD0wO2Q8bC5sZW5ndGg7ZCsrKW9baCtkXT1sW2RdO3UmJmEobyx1LGgsbC5sZW5ndGgpLGgrPWwubGVuZ3RofXJldHVybiBvfX1fdmFsaWRhdGUoKXtpZighdGhpcy5wb3NpdGlvbnMpdGhyb3cgbmV3IE50KCJQb3NpdGlvbnMgYXJlIHJlcXVpcmVkIixvaS5NZXNoSW52YWxpZFBvc2l0aW9uc0Vycm9yKTtjb25zdCBlPShzLHIpPT57Y29uc3Qgbj1nLkRlZHVjZVN0cmlkZShzKTtpZihyLmxlbmd0aCVuIT09MCl0aHJvdyBuZXcgRXJyb3IoIlRoZSAiK3MrInMgYXJyYXkgY291bnQgbXVzdCBiZSBhIG11bHRpcGxlIG9mICIrbik7cmV0dXJuIHIubGVuZ3RoL259LHQ9ZShnLlBvc2l0aW9uS2luZCx0aGlzLnBvc2l0aW9ucyksaT0ocyxyKT0+e2NvbnN0IG49ZShzLHIpO2lmKG4hPT10KXRocm93IG5ldyBFcnJvcigiVGhlICIrcysicyBlbGVtZW50IGNvdW50ICgiK24rIikgZG9lcyBub3QgbWF0Y2ggdGhlIHBvc2l0aW9ucyBjb3VudCAoIit0KyIpIil9O3RoaXMubm9ybWFscyYmaShnLk5vcm1hbEtpbmQsdGhpcy5ub3JtYWxzKSx0aGlzLnRhbmdlbnRzJiZpKGcuVGFuZ2VudEtpbmQsdGhpcy50YW5nZW50cyksdGhpcy51dnMmJmkoZy5VVktpbmQsdGhpcy51dnMpLHRoaXMudXZzMiYmaShnLlVWMktpbmQsdGhpcy51dnMyKSx0aGlzLnV2czMmJmkoZy5VVjNLaW5kLHRoaXMudXZzMyksdGhpcy51dnM0JiZpKGcuVVY0S2luZCx0aGlzLnV2czQpLHRoaXMudXZzNSYmaShnLlVWNUtpbmQsdGhpcy51dnM1KSx0aGlzLnV2czYmJmkoZy5VVjZLaW5kLHRoaXMudXZzNiksdGhpcy5jb2xvcnMmJmkoZy5Db2xvcktpbmQsdGhpcy5jb2xvcnMpLHRoaXMubWF0cmljZXNJbmRpY2VzJiZpKGcuTWF0cmljZXNJbmRpY2VzS2luZCx0aGlzLm1hdHJpY2VzSW5kaWNlcyksdGhpcy5tYXRyaWNlc1dlaWdodHMmJmkoZy5NYXRyaWNlc1dlaWdodHNLaW5kLHRoaXMubWF0cmljZXNXZWlnaHRzKSx0aGlzLm1hdHJpY2VzSW5kaWNlc0V4dHJhJiZpKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLHRoaXMubWF0cmljZXNJbmRpY2VzRXh0cmEpLHRoaXMubWF0cmljZXNXZWlnaHRzRXh0cmEmJmkoZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQsdGhpcy5tYXRyaWNlc1dlaWdodHNFeHRyYSl9c2VyaWFsaXplKCl7Y29uc3QgZT17fTtyZXR1cm4gdGhpcy5wb3NpdGlvbnMmJihlLnBvc2l0aW9ucz10aGlzLnBvc2l0aW9ucyksdGhpcy5ub3JtYWxzJiYoZS5ub3JtYWxzPXRoaXMubm9ybWFscyksdGhpcy50YW5nZW50cyYmKGUudGFuZ2VudHM9dGhpcy50YW5nZW50cyksdGhpcy51dnMmJihlLnV2cz10aGlzLnV2cyksdGhpcy51dnMyJiYoZS51dnMyPXRoaXMudXZzMiksdGhpcy51dnMzJiYoZS51dnMzPXRoaXMudXZzMyksdGhpcy51dnM0JiYoZS51dnM0PXRoaXMudXZzNCksdGhpcy51dnM1JiYoZS51dnM1PXRoaXMudXZzNSksdGhpcy51dnM2JiYoZS51dnM2PXRoaXMudXZzNiksdGhpcy5jb2xvcnMmJihlLmNvbG9ycz10aGlzLmNvbG9ycyksdGhpcy5tYXRyaWNlc0luZGljZXMmJihlLm1hdHJpY2VzSW5kaWNlcz10aGlzLm1hdHJpY2VzSW5kaWNlcyxlLm1hdHJpY2VzSW5kaWNlcy5faXNFeHBhbmRlZD0hMCksdGhpcy5tYXRyaWNlc1dlaWdodHMmJihlLm1hdHJpY2VzV2VpZ2h0cz10aGlzLm1hdHJpY2VzV2VpZ2h0cyksdGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYSYmKGUubWF0cmljZXNJbmRpY2VzRXh0cmE9dGhpcy5tYXRyaWNlc0luZGljZXNFeHRyYSxlLm1hdHJpY2VzSW5kaWNlc0V4dHJhLl9pc0V4cGFuZGVkPSEwKSx0aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhJiYoZS5tYXRyaWNlc1dlaWdodHNFeHRyYT10aGlzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhKSxlLmluZGljZXM9dGhpcy5pbmRpY2VzLGV9c3RhdGljIEV4dHJhY3RGcm9tTWVzaChlLHQsaSl7cmV0dXJuIGVlLl9FeHRyYWN0RnJvbShlLHQsaSl9c3RhdGljIEV4dHJhY3RGcm9tR2VvbWV0cnkoZSx0LGkpe3JldHVybiBlZS5fRXh0cmFjdEZyb20oZSx0LGkpfXN0YXRpYyBfRXh0cmFjdEZyb20oZSx0LGkpe2NvbnN0IHM9bmV3IGVlO3JldHVybiBlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlBvc2l0aW9uS2luZCkmJihzLnBvc2l0aW9ucz1lLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpJiYocy5ub3JtYWxzPWUuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlRhbmdlbnRLaW5kKSYmKHMudGFuZ2VudHM9ZS5nZXRWZXJ0aWNlc0RhdGEoZy5UYW5nZW50S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWS2luZCkmJihzLnV2cz1lLmdldFZlcnRpY2VzRGF0YShnLlVWS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWMktpbmQpJiYocy51dnMyPWUuZ2V0VmVydGljZXNEYXRhKGcuVVYyS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWM0tpbmQpJiYocy51dnMzPWUuZ2V0VmVydGljZXNEYXRhKGcuVVYzS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNEtpbmQpJiYocy51dnM0PWUuZ2V0VmVydGljZXNEYXRhKGcuVVY0S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNUtpbmQpJiYocy51dnM1PWUuZ2V0VmVydGljZXNEYXRhKGcuVVY1S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNktpbmQpJiYocy51dnM2PWUuZ2V0VmVydGljZXNEYXRhKGcuVVY2S2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLkNvbG9yS2luZCkmJihzLmNvbG9ycz1lLmdldFZlcnRpY2VzRGF0YShnLkNvbG9yS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzSW5kaWNlc0tpbmQpJiYocy5tYXRyaWNlc0luZGljZXM9ZS5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kLHQsaSkpLGUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCkmJihzLm1hdHJpY2VzV2VpZ2h0cz1lLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQsdCxpKSksZS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5NYXRyaWNlc0luZGljZXNFeHRyYUtpbmQpJiYocy5tYXRyaWNlc0luZGljZXNFeHRyYT1lLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCx0LGkpKSxlLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCkmJihzLm1hdHJpY2VzV2VpZ2h0c0V4dHJhPWUuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLHQsaSkpLHMuaW5kaWNlcz1lLmdldEluZGljZXModCxpKSxzfXN0YXRpYyBDcmVhdGVSaWJib24oZSl7dGhyb3cgJCgicmliYm9uQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVCb3goZSl7dGhyb3cgJCgiYm94QnVpbGRlciIpfXN0YXRpYyBDcmVhdGVUaWxlZEJveChlKXt0aHJvdyAkKCJ0aWxlZEJveEJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlVGlsZWRQbGFuZShlKXt0aHJvdyAkKCJ0aWxlZFBsYW5lQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVTcGhlcmUoZSl7dGhyb3cgJCgic3BoZXJlQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVDeWxpbmRlcihlKXt0aHJvdyAkKCJjeWxpbmRlckJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlVG9ydXMoZSl7dGhyb3cgJCgidG9ydXNCdWlsZGVyIil9c3RhdGljIENyZWF0ZUxpbmVTeXN0ZW0oZSl7dGhyb3cgJCgibGluZXNCdWlsZGVyIil9c3RhdGljIENyZWF0ZURhc2hlZExpbmVzKGUpe3Rocm93ICQoImxpbmVzQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVHcm91bmQoZSl7dGhyb3cgJCgiZ3JvdW5kQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVUaWxlZEdyb3VuZChlKXt0aHJvdyAkKCJncm91bmRCdWlsZGVyIil9c3RhdGljIENyZWF0ZUdyb3VuZEZyb21IZWlnaHRNYXAoZSl7dGhyb3cgJCgiZ3JvdW5kQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVQbGFuZShlKXt0aHJvdyAkKCJwbGFuZUJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlRGlzYyhlKXt0aHJvdyAkKCJkaXNjQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVQb2x5Z29uKGUsdCxpLHMscixuLGEpe3Rocm93ICQoInBvbHlnb25CdWlsZGVyIil9c3RhdGljIENyZWF0ZUljb1NwaGVyZShlKXt0aHJvdyAkKCJpY29TcGhlcmVCdWlsZGVyIil9c3RhdGljIENyZWF0ZVBvbHloZWRyb24oZSl7dGhyb3cgJCgicG9seWhlZHJvbkJ1aWxkZXIiKX1zdGF0aWMgQ3JlYXRlQ2Fwc3VsZShlPXtvcmllbnRhdGlvbjpwLlVwKCksc3ViZGl2aXNpb25zOjIsdGVzc2VsbGF0aW9uOjE2LGhlaWdodDoxLHJhZGl1czouMjUsY2FwU3ViZGl2aXNpb25zOjZ9KXt0aHJvdyAkKCJjYXBzdWxlQnVpbGRlciIpfXN0YXRpYyBDcmVhdGVUb3J1c0tub3QoZSl7dGhyb3cgJCgidG9ydXNLbm90QnVpbGRlciIpfXN0YXRpYyBDb21wdXRlTm9ybWFscyhlLHQsaSxzKXtsZXQgcj0wLG49MCxhPTAsbz0wLGg9MCxsPTAsdT0wLGQ9MCxmPTAsXz0wLEU9MCxtPTAsdj0wLFM9MCx5PTAsQT0wLEM9MCxiPTAsTT0wLEw9MCxrPSExLHc9ITEsZGU9ITEsY2U9ITEsc2U9MSx0ZT0wLEZlPW51bGw7cyYmKGs9ISFzLmZhY2V0Tm9ybWFscyx3PSEhcy5mYWNldFBvc2l0aW9ucyxkZT0hIXMuZmFjZXRQYXJ0aXRpb25pbmcsc2U9cy51c2VSaWdodEhhbmRlZFN5c3RlbT09PSEwPy0xOjEsdGU9cy5yYXRpb3x8MCxjZT0hIXMuZGVwdGhTb3J0LEZlPXMuZGlzdGFuY2VUbyxjZSYmRmU9PT12b2lkIDAmJihGZT1wLlplcm8oKSkpO2xldCB3ZT0wLEhlPTAsS2U9MCxZZT0wO2ZvcihkZSYmcyYmcy5iYlNpemUmJih3ZT1zLnN1YkRpdi5YKnRlL3MuYmJTaXplLngsSGU9cy5zdWJEaXYuWSp0ZS9zLmJiU2l6ZS55LEtlPXMuc3ViRGl2LloqdGUvcy5iYlNpemUueixZZT1zLnN1YkRpdi5tYXgqcy5zdWJEaXYubWF4LHMuZmFjZXRQYXJ0aXRpb25pbmcubGVuZ3RoPTApLHI9MDtyPGUubGVuZ3RoO3IrKylpW3JdPTA7Y29uc3QgcHQ9dC5sZW5ndGgvM3wwO2ZvcihyPTA7cjxwdDtyKyspe2lmKG09dFtyKjNdKjMsdj1tKzEsUz1tKzIseT10W3IqMysxXSozLEE9eSsxLEM9eSsyLGI9dFtyKjMrMl0qMyxNPWIrMSxMPWIrMixuPWVbbV0tZVt5XSxhPWVbdl0tZVtBXSxvPWVbU10tZVtDXSxoPWVbYl0tZVt5XSxsPWVbTV0tZVtBXSx1PWVbTF0tZVtDXSxkPXNlKihhKnUtbypsKSxmPXNlKihvKmgtbip1KSxfPXNlKihuKmwtYSpoKSxFPU1hdGguc3FydChkKmQrZipmK18qXyksRT1FPT09MD8xOkUsZC89RSxmLz1FLF8vPUUsayYmcyYmKHMuZmFjZXROb3JtYWxzW3JdLng9ZCxzLmZhY2V0Tm9ybWFsc1tyXS55PWYscy5mYWNldE5vcm1hbHNbcl0uej1fKSx3JiZzJiYocy5mYWNldFBvc2l0aW9uc1tyXS54PShlW21dK2VbeV0rZVtiXSkvMyxzLmZhY2V0UG9zaXRpb25zW3JdLnk9KGVbdl0rZVtBXStlW01dKS8zLHMuZmFjZXRQb3NpdGlvbnNbcl0uej0oZVtTXStlW0NdK2VbTF0pLzMpLGRlJiZzKXtjb25zdCBodD1NYXRoLmZsb29yKChzLmZhY2V0UG9zaXRpb25zW3JdLngtcy5iSW5mby5taW5pbXVtLngqdGUpKndlKSx3dD1NYXRoLmZsb29yKChzLmZhY2V0UG9zaXRpb25zW3JdLnktcy5iSW5mby5taW5pbXVtLnkqdGUpKkhlKSxzaT1NYXRoLmZsb29yKChzLmZhY2V0UG9zaXRpb25zW3JdLnotcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxkcz1NYXRoLmZsb29yKChlW21dLXMuYkluZm8ubWluaW11bS54KnRlKSp3ZSksZnM9TWF0aC5mbG9vcigoZVt2XS1zLmJJbmZvLm1pbmltdW0ueSp0ZSkqSGUpLF9zPU1hdGguZmxvb3IoKGVbU10tcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxYcz1NYXRoLmZsb29yKChlW3ldLXMuYkluZm8ubWluaW11bS54KnRlKSp3ZSksSHM9TWF0aC5mbG9vcigoZVtBXS1zLmJJbmZvLm1pbmltdW0ueSp0ZSkqSGUpLEtzPU1hdGguZmxvb3IoKGVbQ10tcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxZcz1NYXRoLmZsb29yKChlW2JdLXMuYkluZm8ubWluaW11bS54KnRlKSp3ZSksWnM9TWF0aC5mbG9vcigoZVtNXS1zLmJJbmZvLm1pbmltdW0ueSp0ZSkqSGUpLHFzPU1hdGguZmxvb3IoKGVbTF0tcy5iSW5mby5taW5pbXVtLnoqdGUpKktlKSxIdD1kcytzLnN1YkRpdi5tYXgqZnMrWWUqX3MsS3Q9WHMrcy5zdWJEaXYubWF4KkhzK1llKktzLFl0PVlzK3Muc3ViRGl2Lm1heCpacytZZSpxcyxadD1odCtzLnN1YkRpdi5tYXgqd3QrWWUqc2k7cy5mYWNldFBhcnRpdGlvbmluZ1tadF09cy5mYWNldFBhcnRpdGlvbmluZ1tadF0/cy5mYWNldFBhcnRpdGlvbmluZ1tadF06bmV3IEFycmF5LHMuZmFjZXRQYXJ0aXRpb25pbmdbSHRdPXMuZmFjZXRQYXJ0aXRpb25pbmdbSHRdP3MuZmFjZXRQYXJ0aXRpb25pbmdbSHRdOm5ldyBBcnJheSxzLmZhY2V0UGFydGl0aW9uaW5nW0t0XT1zLmZhY2V0UGFydGl0aW9uaW5nW0t0XT9zLmZhY2V0UGFydGl0aW9uaW5nW0t0XTpuZXcgQXJyYXkscy5mYWNldFBhcnRpdGlvbmluZ1tZdF09cy5mYWNldFBhcnRpdGlvbmluZ1tZdF0/cy5mYWNldFBhcnRpdGlvbmluZ1tZdF06bmV3IEFycmF5LHMuZmFjZXRQYXJ0aXRpb25pbmdbSHRdLnB1c2gociksS3QhPUh0JiZzLmZhY2V0UGFydGl0aW9uaW5nW0t0XS5wdXNoKHIpLFl0PT1LdHx8WXQ9PUh0fHxzLmZhY2V0UGFydGl0aW9uaW5nW1l0XS5wdXNoKHIpLFp0PT1IdHx8WnQ9PUt0fHxadD09WXR8fHMuZmFjZXRQYXJ0aXRpb25pbmdbWnRdLnB1c2gocil9aWYoY2UmJnMmJnMuZmFjZXRQb3NpdGlvbnMpe2NvbnN0IGh0PXMuZGVwdGhTb3J0ZWRGYWNldHNbcl07aHQuaW5kPXIqMyxodC5zcURpc3RhbmNlPXAuRGlzdGFuY2VTcXVhcmVkKHMuZmFjZXRQb3NpdGlvbnNbcl0sRmUpfWlbbV0rPWQsaVt2XSs9ZixpW1NdKz1fLGlbeV0rPWQsaVtBXSs9ZixpW0NdKz1fLGlbYl0rPWQsaVtNXSs9ZixpW0xdKz1ffWZvcihyPTA7cjxpLmxlbmd0aC8zO3IrKylkPWlbciozXSxmPWlbciozKzFdLF89aVtyKjMrMl0sRT1NYXRoLnNxcnQoZCpkK2YqZitfKl8pLEU9RT09PTA/MTpFLGQvPUUsZi89RSxfLz1FLGlbciozXT1kLGlbciozKzFdPWYsaVtyKjMrMl09X31zdGF0aWMgX0NvbXB1dGVTaWRlcyhlLHQsaSxzLHIsbixhKXtjb25zdCBvPWkubGVuZ3RoLGg9cy5sZW5ndGg7bGV0IGwsdTtzd2l0Y2goZT1lfHxlZS5ERUZBVUxUU0lERSxlKXtjYXNlIGVlLkZST05UU0lERTpicmVhaztjYXNlIGVlLkJBQ0tTSURFOmZvcihsPTA7bDxvO2wrPTMpe2NvbnN0IGQ9aVtsXTtpW2xdPWlbbCsyXSxpW2wrMl09ZH1mb3IodT0wO3U8aDt1Kyspc1t1XT0tc1t1XTticmVhaztjYXNlIGVlLkRPVUJMRVNJREU6e2NvbnN0IGQ9dC5sZW5ndGgsZj1kLzM7Zm9yKGxldCBtPTA7bTxkO20rKyl0W2QrbV09dFttXTtmb3IobD0wO2w8bztsKz0zKWlbbCtvXT1pW2wrMl0rZixpW2wrMStvXT1pW2wrMV0rZixpW2wrMitvXT1pW2xdK2Y7Zm9yKHU9MDt1PGg7dSsrKXNbaCt1XT0tc1t1XTtjb25zdCBfPXIubGVuZ3RoO2xldCBFPTA7Zm9yKEU9MDtFPF87RSsrKXJbRStfXT1yW0VdO2ZvcihuPW58fG5ldyBDZSgwLDAsMSwxKSxhPWF8fG5ldyBDZSgwLDAsMSwxKSxFPTAsbD0wO2w8Xy8yO2wrKylyW0VdPW4ueCsobi56LW4ueCkqcltFXSxyW0UrMV09bi55KyhuLnctbi55KSpyW0UrMV0scltFK19dPWEueCsoYS56LWEueCkqcltFK19dLHJbRStfKzFdPWEueSsoYS53LWEueSkqcltFK18rMV0sRSs9MjticmVha319fXN0YXRpYyBJbXBvcnRWZXJ0ZXhEYXRhKGUsdCl7Y29uc3QgaT1uZXcgZWUscz1lLnBvc2l0aW9ucztzJiZpLnNldChzLGcuUG9zaXRpb25LaW5kKTtjb25zdCByPWUubm9ybWFscztyJiZpLnNldChyLGcuTm9ybWFsS2luZCk7Y29uc3Qgbj1lLnRhbmdlbnRzO24mJmkuc2V0KG4sZy5UYW5nZW50S2luZCk7Y29uc3QgYT1lLnV2czthJiZpLnNldChhLGcuVVZLaW5kKTtjb25zdCBvPWUudXYycztvJiZpLnNldChvLGcuVVYyS2luZCk7Y29uc3QgaD1lLnV2M3M7aCYmaS5zZXQoaCxnLlVWM0tpbmQpO2NvbnN0IGw9ZS51djRzO2wmJmkuc2V0KGwsZy5VVjRLaW5kKTtjb25zdCB1PWUudXY1czt1JiZpLnNldCh1LGcuVVY1S2luZCk7Y29uc3QgZD1lLnV2NnM7ZCYmaS5zZXQoZCxnLlVWNktpbmQpO2NvbnN0IGY9ZS5jb2xvcnM7ZiYmaS5zZXQobWUuQ2hlY2tDb2xvcnM0KGYscy5sZW5ndGgvMyksZy5Db2xvcktpbmQpO2NvbnN0IF89ZS5tYXRyaWNlc0luZGljZXM7XyYmaS5zZXQoXyxnLk1hdHJpY2VzSW5kaWNlc0tpbmQpO2NvbnN0IEU9ZS5tYXRyaWNlc1dlaWdodHM7RSYmaS5zZXQoRSxnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpO2NvbnN0IG09ZS5pbmRpY2VzO20mJihpLmluZGljZXM9bSksdC5zZXRBbGxWZXJ0aWNlc0RhdGEoaSxlLnVwZGF0YWJsZSl9fWVlLkZST05UU0lERT0wLGVlLkJBQ0tTSURFPTEsZWUuRE9VQkxFU0lERT0yLGVlLkRFRkFVTFRTSURFPTAsVChbJHQuZmlsdGVyKCguLi5bY10pPT4hQXJyYXkuaXNBcnJheShjKSldLGVlLCJfVHJhbnNmb3JtVmVjdG9yM0Nvb3JkaW5hdGVzIixudWxsKSxUKFskdC5maWx0ZXIoKC4uLltjXSk9PiFBcnJheS5pc0FycmF5KGMpKV0sZWUsIl9UcmFuc2Zvcm1WZWN0b3IzTm9ybWFscyIsbnVsbCksVChbJHQuZmlsdGVyKCguLi5bY10pPT4hQXJyYXkuaXNBcnJheShjKSldLGVlLCJfVHJhbnNmb3JtVmVjdG9yNE5vcm1hbHMiLG51bGwpLFQoWyR0LmZpbHRlcigoLi4uW2NdKT0+IUFycmF5LmlzQXJyYXkoYykpXSxlZSwiX0ZsaXBGYWNlcyIsbnVsbCk7Y2xhc3MgRHN7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuYnU9ZSx0aGlzLmJ2PXQsdGhpcy5kaXN0YW5jZT1pLHRoaXMuZmFjZUlkPTAsdGhpcy5zdWJNZXNoSWQ9MH19Y2xhc3Mga3R7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMudmVjdG9ycz1CZS5CdWlsZEFycmF5KDgscC5aZXJvKSx0aGlzLmNlbnRlcj1wLlplcm8oKSx0aGlzLmNlbnRlcldvcmxkPXAuWmVybygpLHRoaXMuZXh0ZW5kU2l6ZT1wLlplcm8oKSx0aGlzLmV4dGVuZFNpemVXb3JsZD1wLlplcm8oKSx0aGlzLmRpcmVjdGlvbnM9QmUuQnVpbGRBcnJheSgzLHAuWmVybyksdGhpcy52ZWN0b3JzV29ybGQ9QmUuQnVpbGRBcnJheSg4LHAuWmVybyksdGhpcy5taW5pbXVtV29ybGQ9cC5aZXJvKCksdGhpcy5tYXhpbXVtV29ybGQ9cC5aZXJvKCksdGhpcy5taW5pbXVtPXAuWmVybygpLHRoaXMubWF4aW11bT1wLlplcm8oKSx0aGlzLl9kcmF3V3JhcHBlckZyb250PW51bGwsdGhpcy5fZHJhd1dyYXBwZXJCYWNrPW51bGwsdGhpcy5yZUNvbnN0cnVjdChlLHQsaSl9cmVDb25zdHJ1Y3QoZSx0LGkpe2NvbnN0IHM9ZS54LHI9ZS55LG49ZS56LGE9dC54LG89dC55LGg9dC56LGw9dGhpcy52ZWN0b3JzO3RoaXMubWluaW11bS5jb3B5RnJvbUZsb2F0cyhzLHIsbiksdGhpcy5tYXhpbXVtLmNvcHlGcm9tRmxvYXRzKGEsbyxoKSxsWzBdLmNvcHlGcm9tRmxvYXRzKHMscixuKSxsWzFdLmNvcHlGcm9tRmxvYXRzKGEsbyxoKSxsWzJdLmNvcHlGcm9tRmxvYXRzKGEscixuKSxsWzNdLmNvcHlGcm9tRmxvYXRzKHMsbyxuKSxsWzRdLmNvcHlGcm9tRmxvYXRzKHMscixoKSxsWzVdLmNvcHlGcm9tRmxvYXRzKGEsbyxuKSxsWzZdLmNvcHlGcm9tRmxvYXRzKHMsbyxoKSxsWzddLmNvcHlGcm9tRmxvYXRzKGEscixoKSx0LmFkZFRvUmVmKGUsdGhpcy5jZW50ZXIpLnNjYWxlSW5QbGFjZSguNSksdC5zdWJ0cmFjdFRvUmVmKGUsdGhpcy5leHRlbmRTaXplKS5zY2FsZUluUGxhY2UoLjUpLHRoaXMuX3dvcmxkTWF0cml4PWl8fHguSWRlbnRpdHlSZWFkT25seSx0aGlzLl91cGRhdGUodGhpcy5fd29ybGRNYXRyaXgpfXNjYWxlKGUpe2NvbnN0IHQ9a3QuX1RtcFZlY3RvcjMsaT10aGlzLm1heGltdW0uc3VidHJhY3RUb1JlZih0aGlzLm1pbmltdW0sdFswXSkscz1pLmxlbmd0aCgpO2kubm9ybWFsaXplRnJvbUxlbmd0aChzKTtjb25zdCByPXMqZSxuPWkuc2NhbGVJblBsYWNlKHIqLjUpLGE9dGhpcy5jZW50ZXIuc3VidHJhY3RUb1JlZihuLHRbMV0pLG89dGhpcy5jZW50ZXIuYWRkVG9SZWYobix0WzJdKTtyZXR1cm4gdGhpcy5yZUNvbnN0cnVjdChhLG8sdGhpcy5fd29ybGRNYXRyaXgpLHRoaXN9Z2V0V29ybGRNYXRyaXgoKXtyZXR1cm4gdGhpcy5fd29ybGRNYXRyaXh9X3VwZGF0ZShlKXtjb25zdCB0PXRoaXMubWluaW11bVdvcmxkLGk9dGhpcy5tYXhpbXVtV29ybGQscz10aGlzLmRpcmVjdGlvbnMscj10aGlzLnZlY3RvcnNXb3JsZCxuPXRoaXMudmVjdG9ycztpZihlLmlzSWRlbnRpdHkoKSl7dC5jb3B5RnJvbSh0aGlzLm1pbmltdW0pLGkuY29weUZyb20odGhpcy5tYXhpbXVtKTtmb3IobGV0IGE9MDthPDg7KythKXJbYV0uY29weUZyb20oblthXSk7dGhpcy5leHRlbmRTaXplV29ybGQuY29weUZyb20odGhpcy5leHRlbmRTaXplKSx0aGlzLmNlbnRlcldvcmxkLmNvcHlGcm9tKHRoaXMuY2VudGVyKX1lbHNle3Quc2V0QWxsKE51bWJlci5NQVhfVkFMVUUpLGkuc2V0QWxsKC1OdW1iZXIuTUFYX1ZBTFVFKTtmb3IobGV0IGE9MDthPDg7KythKXtjb25zdCBvPXJbYV07cC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKG5bYV0sZSxvKSx0Lm1pbmltaXplSW5QbGFjZShvKSxpLm1heGltaXplSW5QbGFjZShvKX1pLnN1YnRyYWN0VG9SZWYodCx0aGlzLmV4dGVuZFNpemVXb3JsZCkuc2NhbGVJblBsYWNlKC41KSxpLmFkZFRvUmVmKHQsdGhpcy5jZW50ZXJXb3JsZCkuc2NhbGVJblBsYWNlKC41KX1wLkZyb21BcnJheVRvUmVmKGUubSwwLHNbMF0pLHAuRnJvbUFycmF5VG9SZWYoZS5tLDQsc1sxXSkscC5Gcm9tQXJyYXlUb1JlZihlLm0sOCxzWzJdKSx0aGlzLl93b3JsZE1hdHJpeD1lfWlzSW5GcnVzdHVtKGUpe3JldHVybiBrdC5Jc0luRnJ1c3R1bSh0aGlzLnZlY3RvcnNXb3JsZCxlKX1pc0NvbXBsZXRlbHlJbkZydXN0dW0oZSl7cmV0dXJuIGt0LklzQ29tcGxldGVseUluRnJ1c3R1bSh0aGlzLnZlY3RvcnNXb3JsZCxlKX1pbnRlcnNlY3RzUG9pbnQoZSl7Y29uc3QgdD10aGlzLm1pbmltdW1Xb3JsZCxpPXRoaXMubWF4aW11bVdvcmxkLHM9dC54LHI9dC55LG49dC56LGE9aS54LG89aS55LGg9aS56LGw9ZS54LHU9ZS55LGQ9ZS56LGY9LXhlO3JldHVybiEoYS1sPGZ8fGY+bC1zfHxvLXU8Znx8Zj51LXJ8fGgtZDxmfHxmPmQtbil9aW50ZXJzZWN0c1NwaGVyZShlKXtyZXR1cm4ga3QuSW50ZXJzZWN0c1NwaGVyZSh0aGlzLm1pbmltdW1Xb3JsZCx0aGlzLm1heGltdW1Xb3JsZCxlLmNlbnRlcldvcmxkLGUucmFkaXVzV29ybGQpfWludGVyc2VjdHNNaW5NYXgoZSx0KXtjb25zdCBpPXRoaXMubWluaW11bVdvcmxkLHM9dGhpcy5tYXhpbXVtV29ybGQscj1pLngsbj1pLnksYT1pLnosbz1zLngsaD1zLnksbD1zLnosdT1lLngsZD1lLnksZj1lLnosXz10LngsRT10LnksbT10Lno7cmV0dXJuIShvPHV8fHI+X3x8aDxkfHxuPkV8fGw8Znx8YT5tKX1kaXNwb3NlKCl7dmFyIGUsdDsoZT10aGlzLl9kcmF3V3JhcHBlckZyb250KT09PW51bGx8fGU9PT12b2lkIDB8fGUuZGlzcG9zZSgpLCh0PXRoaXMuX2RyYXdXcmFwcGVyQmFjayk9PT1udWxsfHx0PT09dm9pZCAwfHx0LmRpc3Bvc2UoKX1zdGF0aWMgSW50ZXJzZWN0cyhlLHQpe3JldHVybiBlLmludGVyc2VjdHNNaW5NYXgodC5taW5pbXVtV29ybGQsdC5tYXhpbXVtV29ybGQpfXN0YXRpYyBJbnRlcnNlY3RzU3BoZXJlKGUsdCxpLHMpe2NvbnN0IHI9a3QuX1RtcFZlY3RvcjNbMF07cmV0dXJuIHAuQ2xhbXBUb1JlZihpLGUsdCxyKSxwLkRpc3RhbmNlU3F1YXJlZChpLHIpPD1zKnN9c3RhdGljIElzQ29tcGxldGVseUluRnJ1c3R1bShlLHQpe2ZvcihsZXQgaT0wO2k8NjsrK2kpe2NvbnN0IHM9dFtpXTtmb3IobGV0IHI9MDtyPDg7KytyKWlmKHMuZG90Q29vcmRpbmF0ZShlW3JdKTwwKXJldHVybiExfXJldHVybiEwfXN0YXRpYyBJc0luRnJ1c3R1bShlLHQpe2ZvcihsZXQgaT0wO2k8NjsrK2kpe2xldCBzPSEwO2NvbnN0IHI9dFtpXTtmb3IobGV0IG49MDtuPDg7KytuKWlmKHIuZG90Q29vcmRpbmF0ZShlW25dKT49MCl7cz0hMTticmVha31pZihzKXJldHVybiExfXJldHVybiEwfX1rdC5fVG1wVmVjdG9yMz1CZS5CdWlsZEFycmF5KDMscC5aZXJvKTtjbGFzcyBmaXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5jZW50ZXI9cC5aZXJvKCksdGhpcy5jZW50ZXJXb3JsZD1wLlplcm8oKSx0aGlzLm1pbmltdW09cC5aZXJvKCksdGhpcy5tYXhpbXVtPXAuWmVybygpLHRoaXMucmVDb25zdHJ1Y3QoZSx0LGkpfXJlQ29uc3RydWN0KGUsdCxpKXt0aGlzLm1pbmltdW0uY29weUZyb20oZSksdGhpcy5tYXhpbXVtLmNvcHlGcm9tKHQpO2NvbnN0IHM9cC5EaXN0YW5jZShlLHQpO3QuYWRkVG9SZWYoZSx0aGlzLmNlbnRlcikuc2NhbGVJblBsYWNlKC41KSx0aGlzLnJhZGl1cz1zKi41LHRoaXMuX3VwZGF0ZShpfHx4LklkZW50aXR5UmVhZE9ubHkpfXNjYWxlKGUpe2NvbnN0IHQ9dGhpcy5yYWRpdXMqZSxpPWZpLl9UbXBWZWN0b3IzLHM9aVswXS5zZXRBbGwodCkscj10aGlzLmNlbnRlci5zdWJ0cmFjdFRvUmVmKHMsaVsxXSksbj10aGlzLmNlbnRlci5hZGRUb1JlZihzLGlbMl0pO3JldHVybiB0aGlzLnJlQ29uc3RydWN0KHIsbix0aGlzLl93b3JsZE1hdHJpeCksdGhpc31nZXRXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl93b3JsZE1hdHJpeH1fdXBkYXRlKGUpe2lmKGUuaXNJZGVudGl0eSgpKXRoaXMuY2VudGVyV29ybGQuY29weUZyb20odGhpcy5jZW50ZXIpLHRoaXMucmFkaXVzV29ybGQ9dGhpcy5yYWRpdXM7ZWxzZXtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5jZW50ZXIsZSx0aGlzLmNlbnRlcldvcmxkKTtjb25zdCB0PWZpLl9UbXBWZWN0b3IzWzBdO3AuVHJhbnNmb3JtTm9ybWFsRnJvbUZsb2F0c1RvUmVmKDEsMSwxLGUsdCksdGhpcy5yYWRpdXNXb3JsZD1NYXRoLm1heChNYXRoLmFicyh0LngpLE1hdGguYWJzKHQueSksTWF0aC5hYnModC56KSkqdGhpcy5yYWRpdXN9fWlzSW5GcnVzdHVtKGUpe2NvbnN0IHQ9dGhpcy5jZW50ZXJXb3JsZCxpPXRoaXMucmFkaXVzV29ybGQ7Zm9yKGxldCBzPTA7czw2O3MrKylpZihlW3NdLmRvdENvb3JkaW5hdGUodCk8PS1pKXJldHVybiExO3JldHVybiEwfWlzQ2VudGVySW5GcnVzdHVtKGUpe2NvbnN0IHQ9dGhpcy5jZW50ZXJXb3JsZDtmb3IobGV0IGk9MDtpPDY7aSsrKWlmKGVbaV0uZG90Q29vcmRpbmF0ZSh0KTwwKXJldHVybiExO3JldHVybiEwfWludGVyc2VjdHNQb2ludChlKXtjb25zdCB0PXAuRGlzdGFuY2VTcXVhcmVkKHRoaXMuY2VudGVyV29ybGQsZSk7cmV0dXJuISh0aGlzLnJhZGl1c1dvcmxkKnRoaXMucmFkaXVzV29ybGQ8dCl9c3RhdGljIEludGVyc2VjdHMoZSx0KXtjb25zdCBpPXAuRGlzdGFuY2VTcXVhcmVkKGUuY2VudGVyV29ybGQsdC5jZW50ZXJXb3JsZCkscz1lLnJhZGl1c1dvcmxkK3QucmFkaXVzV29ybGQ7cmV0dXJuIShzKnM8aSl9c3RhdGljIENyZWF0ZUZyb21DZW50ZXJBbmRSYWRpdXMoZSx0LGkpe3RoaXMuX1RtcFZlY3RvcjNbMF0uY29weUZyb20oZSksdGhpcy5fVG1wVmVjdG9yM1sxXS5jb3B5RnJvbUZsb2F0cygwLDAsdCksdGhpcy5fVG1wVmVjdG9yM1syXS5jb3B5RnJvbShlKSx0aGlzLl9UbXBWZWN0b3IzWzBdLmFkZEluUGxhY2UodGhpcy5fVG1wVmVjdG9yM1sxXSksdGhpcy5fVG1wVmVjdG9yM1syXS5zdWJ0cmFjdEluUGxhY2UodGhpcy5fVG1wVmVjdG9yM1sxXSk7Y29uc3Qgcz1uZXcgZmkodGhpcy5fVG1wVmVjdG9yM1swXSx0aGlzLl9UbXBWZWN0b3IzWzJdKTtyZXR1cm4gaT9zLl93b3JsZE1hdHJpeD1pOnMuX3dvcmxkTWF0cml4PXguSWRlbnRpdHkoKSxzfX1maS5fVG1wVmVjdG9yMz1CZS5CdWlsZEFycmF5KDMscC5aZXJvKTtjb25zdCBGcz17bWluOjAsbWF4OjB9LHdzPXttaW46MCxtYXg6MH0sUnI9KGMsZSx0KT0+e2NvbnN0IGk9cC5Eb3QoZS5jZW50ZXJXb3JsZCxjKSxzPU1hdGguYWJzKHAuRG90KGUuZGlyZWN0aW9uc1swXSxjKSkqZS5leHRlbmRTaXplLngscj1NYXRoLmFicyhwLkRvdChlLmRpcmVjdGlvbnNbMV0sYykpKmUuZXh0ZW5kU2l6ZS55LG49TWF0aC5hYnMocC5Eb3QoZS5kaXJlY3Rpb25zWzJdLGMpKSplLmV4dGVuZFNpemUueixhPXMrcituO3QubWluPWktYSx0Lm1heD1pK2F9LHJ0PShjLGUsdCk9PihScihjLGUsRnMpLFJyKGMsdCx3cyksIShGcy5taW4+d3MubWF4fHx3cy5taW4+RnMubWF4KSk7Y2xhc3MgZHR7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuX2lzTG9ja2VkPSExLHRoaXMuYm91bmRpbmdCb3g9bmV3IGt0KGUsdCxpKSx0aGlzLmJvdW5kaW5nU3BoZXJlPW5ldyBmaShlLHQsaSl9cmVDb25zdHJ1Y3QoZSx0LGkpe3RoaXMuYm91bmRpbmdCb3gucmVDb25zdHJ1Y3QoZSx0LGkpLHRoaXMuYm91bmRpbmdTcGhlcmUucmVDb25zdHJ1Y3QoZSx0LGkpfWdldCBtaW5pbXVtKCl7cmV0dXJuIHRoaXMuYm91bmRpbmdCb3gubWluaW11bX1nZXQgbWF4aW11bSgpe3JldHVybiB0aGlzLmJvdW5kaW5nQm94Lm1heGltdW19Z2V0IGlzTG9ja2VkKCl7cmV0dXJuIHRoaXMuX2lzTG9ja2VkfXNldCBpc0xvY2tlZChlKXt0aGlzLl9pc0xvY2tlZD1lfXVwZGF0ZShlKXt0aGlzLl9pc0xvY2tlZHx8KHRoaXMuYm91bmRpbmdCb3guX3VwZGF0ZShlKSx0aGlzLmJvdW5kaW5nU3BoZXJlLl91cGRhdGUoZSkpfWNlbnRlck9uKGUsdCl7Y29uc3QgaT1kdC5fVG1wVmVjdG9yM1swXS5jb3B5RnJvbShlKS5zdWJ0cmFjdEluUGxhY2UodCkscz1kdC5fVG1wVmVjdG9yM1sxXS5jb3B5RnJvbShlKS5hZGRJblBsYWNlKHQpO3JldHVybiB0aGlzLmJvdW5kaW5nQm94LnJlQ29uc3RydWN0KGkscyx0aGlzLmJvdW5kaW5nQm94LmdldFdvcmxkTWF0cml4KCkpLHRoaXMuYm91bmRpbmdTcGhlcmUucmVDb25zdHJ1Y3QoaSxzLHRoaXMuYm91bmRpbmdCb3guZ2V0V29ybGRNYXRyaXgoKSksdGhpc31lbmNhcHN1bGF0ZShlKXtjb25zdCB0PXAuTWluaW1pemUodGhpcy5taW5pbXVtLGUpLGk9cC5NYXhpbWl6ZSh0aGlzLm1heGltdW0sZSk7cmV0dXJuIHRoaXMucmVDb25zdHJ1Y3QodCxpLHRoaXMuYm91bmRpbmdCb3guZ2V0V29ybGRNYXRyaXgoKSksdGhpc31lbmNhcHN1bGF0ZUJvdW5kaW5nSW5mbyhlKXtyZXR1cm4gdGhpcy5lbmNhcHN1bGF0ZShlLmJvdW5kaW5nQm94LmNlbnRlcldvcmxkLnN1YnRyYWN0KGUuYm91bmRpbmdCb3guZXh0ZW5kU2l6ZVdvcmxkKSksdGhpcy5lbmNhcHN1bGF0ZShlLmJvdW5kaW5nQm94LmNlbnRlcldvcmxkLmFkZChlLmJvdW5kaW5nQm94LmV4dGVuZFNpemVXb3JsZCkpLHRoaXN9c2NhbGUoZSl7cmV0dXJuIHRoaXMuYm91bmRpbmdCb3guc2NhbGUoZSksdGhpcy5ib3VuZGluZ1NwaGVyZS5zY2FsZShlKSx0aGlzfWlzSW5GcnVzdHVtKGUsdD0wKXtyZXR1cm4odD09PTJ8fHQ9PT0zKSYmdGhpcy5ib3VuZGluZ1NwaGVyZS5pc0NlbnRlckluRnJ1c3R1bShlKT8hMDp0aGlzLmJvdW5kaW5nU3BoZXJlLmlzSW5GcnVzdHVtKGUpP3Q9PT0xfHx0PT09Mz8hMDp0aGlzLmJvdW5kaW5nQm94LmlzSW5GcnVzdHVtKGUpOiExfWdldCBkaWFnb25hbExlbmd0aCgpe2NvbnN0IGU9dGhpcy5ib3VuZGluZ0JveDtyZXR1cm4gZS5tYXhpbXVtV29ybGQuc3VidHJhY3RUb1JlZihlLm1pbmltdW1Xb3JsZCxkdC5fVG1wVmVjdG9yM1swXSkubGVuZ3RoKCl9aXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpe3JldHVybiB0aGlzLmJvdW5kaW5nQm94LmlzQ29tcGxldGVseUluRnJ1c3R1bShlKX1fY2hlY2tDb2xsaXNpb24oZSl7cmV0dXJuIGUuX2NhbkRvQ29sbGlzaW9uKHRoaXMuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQsdGhpcy5ib3VuZGluZ1NwaGVyZS5yYWRpdXNXb3JsZCx0aGlzLmJvdW5kaW5nQm94Lm1pbmltdW1Xb3JsZCx0aGlzLmJvdW5kaW5nQm94Lm1heGltdW1Xb3JsZCl9aW50ZXJzZWN0c1BvaW50KGUpe3JldHVybiEoIXRoaXMuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGR8fCF0aGlzLmJvdW5kaW5nU3BoZXJlLmludGVyc2VjdHNQb2ludChlKXx8IXRoaXMuYm91bmRpbmdCb3guaW50ZXJzZWN0c1BvaW50KGUpKX1pbnRlcnNlY3RzKGUsdCl7aWYoIWZpLkludGVyc2VjdHModGhpcy5ib3VuZGluZ1NwaGVyZSxlLmJvdW5kaW5nU3BoZXJlKXx8IWt0LkludGVyc2VjdHModGhpcy5ib3VuZGluZ0JveCxlLmJvdW5kaW5nQm94KSlyZXR1cm4hMTtpZighdClyZXR1cm4hMDtjb25zdCBpPXRoaXMuYm91bmRpbmdCb3gscz1lLmJvdW5kaW5nQm94O3JldHVybiEoIXJ0KGkuZGlyZWN0aW9uc1swXSxpLHMpfHwhcnQoaS5kaXJlY3Rpb25zWzFdLGkscyl8fCFydChpLmRpcmVjdGlvbnNbMl0saSxzKXx8IXJ0KHMuZGlyZWN0aW9uc1swXSxpLHMpfHwhcnQocy5kaXJlY3Rpb25zWzFdLGkscyl8fCFydChzLmRpcmVjdGlvbnNbMl0saSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzBdLHMuZGlyZWN0aW9uc1swXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzBdLHMuZGlyZWN0aW9uc1sxXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzBdLHMuZGlyZWN0aW9uc1syXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzFdLHMuZGlyZWN0aW9uc1swXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzFdLHMuZGlyZWN0aW9uc1sxXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzFdLHMuZGlyZWN0aW9uc1syXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzJdLHMuZGlyZWN0aW9uc1swXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzJdLHMuZGlyZWN0aW9uc1sxXSksaSxzKXx8IXJ0KHAuQ3Jvc3MoaS5kaXJlY3Rpb25zWzJdLHMuZGlyZWN0aW9uc1syXSksaSxzKSl9fWR0Ll9UbXBWZWN0b3IzPUJlLkJ1aWxkQXJyYXkoMixwLlplcm8pO2NsYXNzIGlze3N0YXRpYyBleHRyYWN0TWluQW5kTWF4SW5kZXhlZChlLHQsaSxzLHIsbil7Zm9yKGxldCBhPWk7YTxpK3M7YSsrKXtjb25zdCBvPXRbYV0qMyxoPWVbb10sbD1lW28rMV0sdT1lW28rMl07ci5taW5pbWl6ZUluUGxhY2VGcm9tRmxvYXRzKGgsbCx1KSxuLm1heGltaXplSW5QbGFjZUZyb21GbG9hdHMoaCxsLHUpfX1zdGF0aWMgZXh0cmFjdE1pbkFuZE1heChlLHQsaSxzLHIsbil7Zm9yKGxldCBhPXQsbz10KnM7YTx0K2k7YSsrLG8rPXMpe2NvbnN0IGg9ZVtvXSxsPWVbbysxXSx1PWVbbysyXTtyLm1pbmltaXplSW5QbGFjZUZyb21GbG9hdHMoaCxsLHUpLG4ubWF4aW1pemVJblBsYWNlRnJvbUZsb2F0cyhoLGwsdSl9fX1UKFskdC5maWx0ZXIoKC4uLltjLGVdKT0+IUFycmF5LmlzQXJyYXkoYykmJiFBcnJheS5pc0FycmF5KGUpKV0saXMsImV4dHJhY3RNaW5BbmRNYXhJbmRleGVkIixudWxsKSxUKFskdC5maWx0ZXIoKC4uLltjXSk9PiFBcnJheS5pc0FycmF5KGMpKV0saXMsImV4dHJhY3RNaW5BbmRNYXgiLG51bGwpO2Z1bmN0aW9uIEJuKGMsZSx0LGkscz1udWxsKXtjb25zdCByPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSxuPW5ldyBwKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKTtyZXR1cm4gaXMuZXh0cmFjdE1pbkFuZE1heEluZGV4ZWQoYyxlLHQsaSxyLG4pLHMmJihyLngtPXIueCpzLngrcy55LHIueS09ci55KnMueCtzLnksci56LT1yLnoqcy54K3MueSxuLngrPW4ueCpzLngrcy55LG4ueSs9bi55KnMueCtzLnksbi56Kz1uLnoqcy54K3MueSkse21pbmltdW06cixtYXhpbXVtOm59fWZ1bmN0aW9uIHlyKGMsZSx0LGk9bnVsbCxzKXtjb25zdCByPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSxuPW5ldyBwKC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFLC1OdW1iZXIuTUFYX1ZBTFVFKTtyZXR1cm4gc3x8KHM9MyksaXMuZXh0cmFjdE1pbkFuZE1heChjLGUsdCxzLHIsbiksaSYmKHIueC09ci54KmkueCtpLnksci55LT1yLnkqaS54K2kueSxyLnotPXIueippLngraS55LG4ueCs9bi54KmkueCtpLnksbi55Kz1uLnkqaS54K2kueSxuLnorPW4ueippLngraS55KSx7bWluaW11bTpyLG1heGltdW06bn19Y2xhc3MgdnR7Y29uc3RydWN0b3IoZSx0LGkscyxyLG4sYSxvPSEwLGg9ITApe3RoaXMubWF0ZXJpYWxJbmRleD1lLHRoaXMudmVydGljZXNTdGFydD10LHRoaXMudmVydGljZXNDb3VudD1pLHRoaXMuaW5kZXhTdGFydD1zLHRoaXMuaW5kZXhDb3VudD1yLHRoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlPW51bGwsdGhpcy5fbGluZXNJbmRleENvdW50PTAsdGhpcy5fbGluZXNJbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXM9bnVsbCx0aGlzLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXg9bnVsbCx0aGlzLl93YXNEaXNwYXRjaGVkPSExLHRoaXMuX3JlbmRlcklkPTAsdGhpcy5fYWxwaGFJbmRleD0wLHRoaXMuX2Rpc3RhbmNlVG9DYW1lcmE9MCx0aGlzLl9jdXJyZW50TWF0ZXJpYWw9bnVsbCx0aGlzLl9tZXNoPW4sdGhpcy5fcmVuZGVyaW5nTWVzaD1hfHxuLGgmJm4uc3ViTWVzaGVzLnB1c2godGhpcyksdGhpcy5fZW5naW5lPXRoaXMuX21lc2guZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKSx0aGlzLnJlc2V0RHJhd0NhY2hlKCksdGhpcy5fdHJpYW5nbGVQbGFuZXM9W10sdGhpcy5faWQ9bi5zdWJNZXNoZXMubGVuZ3RoLTEsbyYmKHRoaXMucmVmcmVzaEJvdW5kaW5nSW5mbygpLG4uY29tcHV0ZVdvcmxkTWF0cml4KCEwKSl9Z2V0IG1hdGVyaWFsRGVmaW5lcygpe3ZhciBlO3JldHVybiB0aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZT90aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZS5kZWZpbmVzOihlPXRoaXMuX2dldERyYXdXcmFwcGVyKCkpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5kZWZpbmVzfXNldCBtYXRlcmlhbERlZmluZXMoZSl7dmFyIHQ7Y29uc3QgaT0odD10aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6dGhpcy5fZ2V0RHJhd1dyYXBwZXIodm9pZCAwLCEwKTtpLmRlZmluZXM9ZX1fZ2V0RHJhd1dyYXBwZXIoZSx0PSExKXtlPWU/P3RoaXMuX2VuZ2luZS5jdXJyZW50UmVuZGVyUGFzc0lkO2xldCBpPXRoaXMuX2RyYXdXcmFwcGVyc1tlXTtyZXR1cm4haSYmdCYmKHRoaXMuX2RyYXdXcmFwcGVyc1tlXT1pPW5ldyBtaSh0aGlzLl9tZXNoLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkpKSxpfV9yZW1vdmVEcmF3V3JhcHBlcihlLHQ9ITApe3ZhciBpO3QmJigoaT10aGlzLl9kcmF3V3JhcHBlcnNbZV0pPT09bnVsbHx8aT09PXZvaWQgMHx8aS5kaXNwb3NlKCkpLHRoaXMuX2RyYXdXcmFwcGVyc1tlXT12b2lkIDB9Z2V0IGVmZmVjdCgpe3ZhciBlLHQ7cmV0dXJuIHRoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlP3RoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlLmVmZmVjdDoodD0oZT10aGlzLl9nZXREcmF3V3JhcHBlcigpKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuZWZmZWN0KSE9PW51bGwmJnQhPT12b2lkIDA/dDpudWxsfWdldCBfZHJhd1dyYXBwZXIoKXt2YXIgZTtyZXR1cm4oZT10aGlzLl9tYWluRHJhd1dyYXBwZXJPdmVycmlkZSkhPT1udWxsJiZlIT09dm9pZCAwP2U6dGhpcy5fZ2V0RHJhd1dyYXBwZXIodm9pZCAwLCEwKX1nZXQgX2RyYXdXcmFwcGVyT3ZlcnJpZGUoKXtyZXR1cm4gdGhpcy5fbWFpbkRyYXdXcmFwcGVyT3ZlcnJpZGV9X3NldE1haW5EcmF3V3JhcHBlck92ZXJyaWRlKGUpe3RoaXMuX21haW5EcmF3V3JhcHBlck92ZXJyaWRlPWV9c2V0RWZmZWN0KGUsdD1udWxsLGkscz0hMCl7Y29uc3Qgcj10aGlzLl9kcmF3V3JhcHBlcjtyLnNldEVmZmVjdChlLHQscyksaSE9PXZvaWQgMCYmKHIubWF0ZXJpYWxDb250ZXh0PWkpLGV8fChyLmRlZmluZXM9bnVsbCxyLm1hdGVyaWFsQ29udGV4dD12b2lkIDApfXJlc2V0RHJhd0NhY2hlKGUpe2lmKHRoaXMuX2RyYXdXcmFwcGVycylpZihlIT09dm9pZCAwKXt0aGlzLl9yZW1vdmVEcmF3V3JhcHBlcihlKTtyZXR1cm59ZWxzZSBmb3IoY29uc3QgdCBvZiB0aGlzLl9kcmF3V3JhcHBlcnMpdD09bnVsbHx8dC5kaXNwb3NlKCk7dGhpcy5fZHJhd1dyYXBwZXJzPVtdfXN0YXRpYyBBZGRUb01lc2goZSx0LGkscyxyLG4sYSxvPSEwKXtyZXR1cm4gbmV3IHZ0KGUsdCxpLHMscixuLGEsbyl9Z2V0IElzR2xvYmFsKCl7cmV0dXJuIHRoaXMudmVydGljZXNTdGFydD09PTAmJnRoaXMudmVydGljZXNDb3VudD09PXRoaXMuX21lc2guZ2V0VG90YWxWZXJ0aWNlcygpJiZ0aGlzLmluZGV4U3RhcnQ9PT0wJiZ0aGlzLmluZGV4Q291bnQ9PT10aGlzLl9tZXNoLmdldFRvdGFsSW5kaWNlcygpfWdldEJvdW5kaW5nSW5mbygpe3JldHVybiB0aGlzLklzR2xvYmFsP3RoaXMuX21lc2guZ2V0Qm91bmRpbmdJbmZvKCk6dGhpcy5fYm91bmRpbmdJbmZvfXNldEJvdW5kaW5nSW5mbyhlKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdJbmZvPWUsdGhpc31nZXRNZXNoKCl7cmV0dXJuIHRoaXMuX21lc2h9Z2V0UmVuZGVyaW5nTWVzaCgpe3JldHVybiB0aGlzLl9yZW5kZXJpbmdNZXNofWdldFJlcGxhY2VtZW50TWVzaCgpe3JldHVybiB0aGlzLl9tZXNoLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoP3RoaXMuX21lc2g6bnVsbH1nZXRFZmZlY3RpdmVNZXNoKCl7Y29uc3QgZT10aGlzLl9tZXNoLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoP3RoaXMuX21lc2g6bnVsbDtyZXR1cm4gZXx8dGhpcy5fcmVuZGVyaW5nTWVzaH1nZXRNYXRlcmlhbChlPSEwKXt2YXIgdDtjb25zdCBpPSh0PXRoaXMuX3JlbmRlcmluZ01lc2guZ2V0TWF0ZXJpYWxGb3JSZW5kZXJQYXNzKHRoaXMuX2VuZ2luZS5jdXJyZW50UmVuZGVyUGFzc0lkKSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6dGhpcy5fcmVuZGVyaW5nTWVzaC5tYXRlcmlhbDtpZihpKXtpZih0aGlzLl9pc011bHRpTWF0ZXJpYWwoaSkpe2NvbnN0IHM9aS5nZXRTdWJNYXRlcmlhbCh0aGlzLm1hdGVyaWFsSW5kZXgpO3JldHVybiB0aGlzLl9jdXJyZW50TWF0ZXJpYWwhPT1zJiYodGhpcy5fY3VycmVudE1hdGVyaWFsPXMsdGhpcy5yZXNldERyYXdDYWNoZSgpKSxzfX1lbHNlIHJldHVybiBlP3RoaXMuX21lc2guZ2V0U2NlbmUoKS5kZWZhdWx0TWF0ZXJpYWw6bnVsbDtyZXR1cm4gaX1faXNNdWx0aU1hdGVyaWFsKGUpe3JldHVybiBlLmdldFN1Yk1hdGVyaWFsIT09dm9pZCAwfXJlZnJlc2hCb3VuZGluZ0luZm8oZT1udWxsKXtpZih0aGlzLl9sYXN0Q29sbGlkZXJXb3JsZFZlcnRpY2VzPW51bGwsdGhpcy5Jc0dsb2JhbHx8IXRoaXMuX3JlbmRlcmluZ01lc2h8fCF0aGlzLl9yZW5kZXJpbmdNZXNoLmdlb21ldHJ5KXJldHVybiB0aGlzO2lmKGV8fChlPXRoaXMuX3JlbmRlcmluZ01lc2guZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kKSksIWUpcmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbz10aGlzLl9tZXNoLmdldEJvdW5kaW5nSW5mbygpLHRoaXM7Y29uc3QgdD10aGlzLl9yZW5kZXJpbmdNZXNoLmdldEluZGljZXMoKTtsZXQgaTtpZih0aGlzLmluZGV4U3RhcnQ9PT0wJiZ0aGlzLmluZGV4Q291bnQ9PT10Lmxlbmd0aCl7Y29uc3Qgcz10aGlzLl9yZW5kZXJpbmdNZXNoLmdldEJvdW5kaW5nSW5mbygpO2k9e21pbmltdW06cy5taW5pbXVtLmNsb25lKCksbWF4aW11bTpzLm1heGltdW0uY2xvbmUoKX19ZWxzZSBpPUJuKGUsdCx0aGlzLmluZGV4U3RhcnQsdGhpcy5pbmRleENvdW50LHRoaXMuX3JlbmRlcmluZ01lc2guZ2VvbWV0cnkuYm91bmRpbmdCaWFzKTtyZXR1cm4gdGhpcy5fYm91bmRpbmdJbmZvP3RoaXMuX2JvdW5kaW5nSW5mby5yZUNvbnN0cnVjdChpLm1pbmltdW0saS5tYXhpbXVtKTp0aGlzLl9ib3VuZGluZ0luZm89bmV3IGR0KGkubWluaW11bSxpLm1heGltdW0pLHRoaXN9X2NoZWNrQ29sbGlzaW9uKGUpe3JldHVybiB0aGlzLmdldEJvdW5kaW5nSW5mbygpLl9jaGVja0NvbGxpc2lvbihlKX11cGRhdGVCb3VuZGluZ0luZm8oZSl7bGV0IHQ9dGhpcy5nZXRCb3VuZGluZ0luZm8oKTtyZXR1cm4gdHx8KHRoaXMucmVmcmVzaEJvdW5kaW5nSW5mbygpLHQ9dGhpcy5nZXRCb3VuZGluZ0luZm8oKSksdCYmdC51cGRhdGUoZSksdGhpc31pc0luRnJ1c3R1bShlKXtjb25zdCB0PXRoaXMuZ2V0Qm91bmRpbmdJbmZvKCk7cmV0dXJuIHQ/dC5pc0luRnJ1c3R1bShlLHRoaXMuX21lc2guY3VsbGluZ1N0cmF0ZWd5KTohMX1pc0NvbXBsZXRlbHlJbkZydXN0dW0oZSl7Y29uc3QgdD10aGlzLmdldEJvdW5kaW5nSW5mbygpO3JldHVybiB0P3QuaXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpOiExfXJlbmRlcihlKXtyZXR1cm4gdGhpcy5fcmVuZGVyaW5nTWVzaC5yZW5kZXIodGhpcyxlLHRoaXMuX21lc2guX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FjdEFzUmVndWxhck1lc2g/dGhpcy5fbWVzaDp2b2lkIDApLHRoaXN9X2dldExpbmVzSW5kZXhCdWZmZXIoZSx0KXtpZighdGhpcy5fbGluZXNJbmRleEJ1ZmZlcil7Y29uc3QgaT1bXTtmb3IobGV0IHM9dGhpcy5pbmRleFN0YXJ0O3M8dGhpcy5pbmRleFN0YXJ0K3RoaXMuaW5kZXhDb3VudDtzKz0zKWkucHVzaChlW3NdLGVbcysxXSxlW3MrMV0sZVtzKzJdLGVbcysyXSxlW3NdKTt0aGlzLl9saW5lc0luZGV4QnVmZmVyPXQuY3JlYXRlSW5kZXhCdWZmZXIoaSksdGhpcy5fbGluZXNJbmRleENvdW50PWkubGVuZ3RofXJldHVybiB0aGlzLl9saW5lc0luZGV4QnVmZmVyfWNhbkludGVyc2VjdHMoZSl7Y29uc3QgdD10aGlzLmdldEJvdW5kaW5nSW5mbygpO3JldHVybiB0P2UuaW50ZXJzZWN0c0JveCh0LmJvdW5kaW5nQm94KTohMX1pbnRlcnNlY3RzKGUsdCxpLHMscil7Y29uc3Qgbj10aGlzLmdldE1hdGVyaWFsKCk7aWYoIW4pcmV0dXJuIG51bGw7bGV0IGE9MyxvPSExO3N3aXRjaChuLmZpbGxNb2RlKXtjYXNlIDM6Y2FzZSA1OmNhc2UgNjpjYXNlIDg6cmV0dXJuIG51bGw7Y2FzZSA3OmE9MSxvPSEwO2JyZWFrfXJldHVybiBuLmZpbGxNb2RlPT09ND9pLmxlbmd0aD90aGlzLl9pbnRlcnNlY3RMaW5lcyhlLHQsaSx0aGlzLl9tZXNoLmludGVyc2VjdGlvblRocmVzaG9sZCxzKTp0aGlzLl9pbnRlcnNlY3RVbkluZGV4ZWRMaW5lcyhlLHQsaSx0aGlzLl9tZXNoLmludGVyc2VjdGlvblRocmVzaG9sZCxzKTohaS5sZW5ndGgmJnRoaXMuX21lc2guX3VuSW5kZXhlZD90aGlzLl9pbnRlcnNlY3RVbkluZGV4ZWRUcmlhbmdsZXMoZSx0LGkscyxyKTp0aGlzLl9pbnRlcnNlY3RUcmlhbmdsZXMoZSx0LGksYSxvLHMscil9X2ludGVyc2VjdExpbmVzKGUsdCxpLHMscil7bGV0IG49bnVsbDtmb3IobGV0IGE9dGhpcy5pbmRleFN0YXJ0O2E8dGhpcy5pbmRleFN0YXJ0K3RoaXMuaW5kZXhDb3VudDthKz0yKXtjb25zdCBvPXRbaVthXV0saD10W2lbYSsxXV0sbD1lLmludGVyc2VjdGlvblNlZ21lbnQobyxoLHMpO2lmKCEobDwwKSYmKHJ8fCFufHxsPG4uZGlzdGFuY2UpJiYobj1uZXcgRHMobnVsbCxudWxsLGwpLG4uZmFjZUlkPWEvMixyKSlicmVha31yZXR1cm4gbn1faW50ZXJzZWN0VW5JbmRleGVkTGluZXMoZSx0LGkscyxyKXtsZXQgbj1udWxsO2ZvcihsZXQgYT10aGlzLnZlcnRpY2VzU3RhcnQ7YTx0aGlzLnZlcnRpY2VzU3RhcnQrdGhpcy52ZXJ0aWNlc0NvdW50O2ErPTIpe2NvbnN0IG89dFthXSxoPXRbYSsxXSxsPWUuaW50ZXJzZWN0aW9uU2VnbWVudChvLGgscyk7aWYoIShsPDApJiYocnx8IW58fGw8bi5kaXN0YW5jZSkmJihuPW5ldyBEcyhudWxsLG51bGwsbCksbi5mYWNlSWQ9YS8yLHIpKWJyZWFrfXJldHVybiBufV9pbnRlcnNlY3RUcmlhbmdsZXMoZSx0LGkscyxyLG4sYSl7bGV0IG89bnVsbCxoPS0xO2ZvcihsZXQgbD10aGlzLmluZGV4U3RhcnQ7bDx0aGlzLmluZGV4U3RhcnQrdGhpcy5pbmRleENvdW50LSgzLXMpO2wrPXMpe2grKztjb25zdCB1PWlbbF0sZD1pW2wrMV0sZj1pW2wrMl07aWYociYmZj09PTQyOTQ5NjcyOTUpe2wrPTI7Y29udGludWV9Y29uc3QgXz10W3VdLEU9dFtkXSxtPXRbZl07aWYoIV98fCFFfHwhbXx8YSYmIWEoXyxFLG0sZSx1LGQsZikpY29udGludWU7Y29uc3Qgdj1lLmludGVyc2VjdHNUcmlhbmdsZShfLEUsbSk7aWYodil7aWYodi5kaXN0YW5jZTwwKWNvbnRpbnVlO2lmKChufHwhb3x8di5kaXN0YW5jZTxvLmRpc3RhbmNlKSYmKG89dixvLmZhY2VJZD1oLG4pKWJyZWFrfX1yZXR1cm4gb31faW50ZXJzZWN0VW5JbmRleGVkVHJpYW5nbGVzKGUsdCxpLHMscil7bGV0IG49bnVsbDtmb3IobGV0IGE9dGhpcy52ZXJ0aWNlc1N0YXJ0O2E8dGhpcy52ZXJ0aWNlc1N0YXJ0K3RoaXMudmVydGljZXNDb3VudDthKz0zKXtjb25zdCBvPXRbYV0saD10W2ErMV0sbD10W2ErMl07aWYociYmIXIobyxoLGwsZSwtMSwtMSwtMSkpY29udGludWU7Y29uc3QgdT1lLmludGVyc2VjdHNUcmlhbmdsZShvLGgsbCk7aWYodSl7aWYodS5kaXN0YW5jZTwwKWNvbnRpbnVlO2lmKChzfHwhbnx8dS5kaXN0YW5jZTxuLmRpc3RhbmNlKSYmKG49dSxuLmZhY2VJZD1hLzMscykpYnJlYWt9fXJldHVybiBufV9yZWJ1aWxkKCl7dGhpcy5fbGluZXNJbmRleEJ1ZmZlciYmKHRoaXMuX2xpbmVzSW5kZXhCdWZmZXI9bnVsbCl9Y2xvbmUoZSx0KXtjb25zdCBpPW5ldyB2dCh0aGlzLm1hdGVyaWFsSW5kZXgsdGhpcy52ZXJ0aWNlc1N0YXJ0LHRoaXMudmVydGljZXNDb3VudCx0aGlzLmluZGV4U3RhcnQsdGhpcy5pbmRleENvdW50LGUsdCwhMSk7aWYoIXRoaXMuSXNHbG9iYWwpe2NvbnN0IHM9dGhpcy5nZXRCb3VuZGluZ0luZm8oKTtpZighcylyZXR1cm4gaTtpLl9ib3VuZGluZ0luZm89bmV3IGR0KHMubWluaW11bSxzLm1heGltdW0pfXJldHVybiBpfWRpc3Bvc2UoKXt0aGlzLl9saW5lc0luZGV4QnVmZmVyJiYodGhpcy5fbWVzaC5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2xpbmVzSW5kZXhCdWZmZXIpLHRoaXMuX2xpbmVzSW5kZXhCdWZmZXI9bnVsbCk7Y29uc3QgZT10aGlzLl9tZXNoLnN1Yk1lc2hlcy5pbmRleE9mKHRoaXMpO3RoaXMuX21lc2guc3ViTWVzaGVzLnNwbGljZShlLDEpLHRoaXMucmVzZXREcmF3Q2FjaGUoKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iU3ViTWVzaCJ9c3RhdGljIENyZWF0ZUZyb21JbmRpY2VzKGUsdCxpLHMscixuPSEwKXtsZXQgYT1OdW1iZXIuTUFYX1ZBTFVFLG89LU51bWJlci5NQVhfVkFMVUU7Y29uc3QgbD0ocnx8cykuZ2V0SW5kaWNlcygpO2ZvcihsZXQgdT10O3U8dCtpO3UrKyl7Y29uc3QgZD1sW3VdO2Q8YSYmKGE9ZCksZD5vJiYobz1kKX1yZXR1cm4gbmV3IHZ0KGUsYSxvLWErMSx0LGkscyxyLG4pfX1jbGFzcyBPZXtzdGF0aWMgZ2V0IEZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsKCl7cmV0dXJuIE9lLl9Gb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbH1zdGF0aWMgc2V0IEZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsKGUpe09lLl9Gb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbD1lfXN0YXRpYyBnZXQgU2hvd0xvYWRpbmdTY3JlZW4oKXtyZXR1cm4gT2UuX1Nob3dMb2FkaW5nU2NyZWVufXN0YXRpYyBzZXQgU2hvd0xvYWRpbmdTY3JlZW4oZSl7T2UuX1Nob3dMb2FkaW5nU2NyZWVuPWV9c3RhdGljIGdldCBsb2dnaW5nTGV2ZWwoKXtyZXR1cm4gT2UuX0xvZ2dpbmdMZXZlbH1zdGF0aWMgc2V0IGxvZ2dpbmdMZXZlbChlKXtPZS5fTG9nZ2luZ0xldmVsPWV9c3RhdGljIGdldCBDbGVhbkJvbmVNYXRyaXhXZWlnaHRzKCl7cmV0dXJuIE9lLl9DbGVhbkJvbmVNYXRyaXhXZWlnaHRzfXN0YXRpYyBzZXQgQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cyhlKXtPZS5fQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cz1lfX1PZS5fRm9yY2VGdWxsU2NlbmVMb2FkaW5nRm9ySW5jcmVtZW50YWw9ITEsT2UuX1Nob3dMb2FkaW5nU2NyZWVuPSEwLE9lLl9DbGVhbkJvbmVNYXRyaXhXZWlnaHRzPSExLE9lLl9Mb2dnaW5nTGV2ZWw9MDtjbGFzcyBmdHt9ZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj0hMTtjbGFzcyBhdHtjb25zdHJ1Y3RvcihlLHQsaSxzPSExLHI9bnVsbCl7dGhpcy5kZWxheUxvYWRTdGF0ZT0wLHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9pc0Rpc3Bvc2VkPSExLHRoaXMuX2luZGV4QnVmZmVySXNVcGRhdGFibGU9ITEsdGhpcy5fcG9zaXRpb25zQ2FjaGU9W10sdGhpcy5fcGFyZW50Q29udGFpbmVyPW51bGwsdGhpcy51c2VCb3VuZGluZ0luZm9Gcm9tR2VvbWV0cnk9ITEsdGhpcy5fc2NlbmU9dHx8ZmUuTGFzdENyZWF0ZWRTY2VuZSx0aGlzLl9zY2VuZSYmKHRoaXMuaWQ9ZSx0aGlzLnVuaXF1ZUlkPXRoaXMuX3NjZW5lLmdldFVuaXF1ZUlkKCksdGhpcy5fZW5naW5lPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLHRoaXMuX21lc2hlcz1bXSx0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX2luZGljZXM9W10sdGhpcy5fdXBkYXRhYmxlPXMsaT90aGlzLnNldEFsbFZlcnRpY2VzRGF0YShpLHMpOnRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9lbmdpbmUuZ2V0Q2FwcygpLnZlcnRleEFycmF5T2JqZWN0JiYodGhpcy5fdmVydGV4QXJyYXlPYmplY3RzPXt9KSxyJiYodGhpcy5hcHBseVRvTWVzaChyKSxyLmNvbXB1dGVXb3JsZE1hdHJpeCghMCkpKX1nZXQgYm91bmRpbmdCaWFzKCl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nQmlhc31zZXQgYm91bmRpbmdCaWFzKGUpe3RoaXMuX2JvdW5kaW5nQmlhcz90aGlzLl9ib3VuZGluZ0JpYXMuY29weUZyb20oZSk6dGhpcy5fYm91bmRpbmdCaWFzPWUuY2xvbmUoKSx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oITAsbnVsbCl9c3RhdGljIENyZWF0ZUdlb21ldHJ5Rm9yTWVzaChlKXtjb25zdCB0PW5ldyBhdChhdC5SYW5kb21JZCgpLGUuZ2V0U2NlbmUoKSk7cmV0dXJuIHQuYXBwbHlUb01lc2goZSksdH1nZXQgbWVzaGVzKCl7cmV0dXJuIHRoaXMuX21lc2hlc31nZXQgZXh0ZW5kKCl7cmV0dXJuIHRoaXMuX2V4dGVuZH1nZXRTY2VuZSgpe3JldHVybiB0aGlzLl9zY2VuZX1nZXRFbmdpbmUoKXtyZXR1cm4gdGhpcy5fZW5naW5lfWlzUmVhZHkoKXtyZXR1cm4gdGhpcy5kZWxheUxvYWRTdGF0ZT09PTF8fHRoaXMuZGVsYXlMb2FkU3RhdGU9PT0wfWdldCBkb05vdFNlcmlhbGl6ZSgpe2ZvcihsZXQgZT0wO2U8dGhpcy5fbWVzaGVzLmxlbmd0aDtlKyspaWYoIXRoaXMuX21lc2hlc1tlXS5kb05vdFNlcmlhbGl6ZSlyZXR1cm4hMTtyZXR1cm4hMH1fcmVidWlsZCgpe3RoaXMuX3ZlcnRleEFycmF5T2JqZWN0cyYmKHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0cz17fSksdGhpcy5fbWVzaGVzLmxlbmd0aCE9PTAmJnRoaXMuX2luZGljZXMmJih0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlSW5kZXhCdWZmZXIodGhpcy5faW5kaWNlcyx0aGlzLl91cGRhdGFibGUpKTtmb3IoY29uc3QgZSBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXRoaXMuX3ZlcnRleEJ1ZmZlcnNbZV0uX3JlYnVpbGQoKX1zZXRBbGxWZXJ0aWNlc0RhdGEoZSx0KXtlLmFwcGx5VG9HZW9tZXRyeSh0aGlzLHQpLHRoaXMuX25vdGlmeVVwZGF0ZSgpfXNldFZlcnRpY2VzRGF0YShlLHQsaT0hMSxzKXtpJiZBcnJheS5pc0FycmF5KHQpJiYodD1uZXcgRmxvYXQzMkFycmF5KHQpKTtjb25zdCByPW5ldyBnKHRoaXMuX2VuZ2luZSx0LGUsaSx0aGlzLl9tZXNoZXMubGVuZ3RoPT09MCxzKTt0aGlzLnNldFZlcnRpY2VzQnVmZmVyKHIpfXJlbW92ZVZlcnRpY2VzRGF0YShlKXt0aGlzLl92ZXJ0ZXhCdWZmZXJzW2VdJiYodGhpcy5fdmVydGV4QnVmZmVyc1tlXS5kaXNwb3NlKCksZGVsZXRlIHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZV0pLHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0cyYmdGhpcy5fZGlzcG9zZVZlcnRleEFycmF5T2JqZWN0cygpfXNldFZlcnRpY2VzQnVmZmVyKGUsdD1udWxsLGk9ITApe2NvbnN0IHM9ZS5nZXRLaW5kKCk7dGhpcy5fdmVydGV4QnVmZmVyc1tzXSYmaSYmdGhpcy5fdmVydGV4QnVmZmVyc1tzXS5kaXNwb3NlKCksZS5fYnVmZmVyJiZlLl9idWZmZXIuX2luY3JlYXNlUmVmZXJlbmNlcygpLHRoaXMuX3ZlcnRleEJ1ZmZlcnNbc109ZTtjb25zdCByPXRoaXMuX21lc2hlcyxuPXIubGVuZ3RoO2lmKHM9PT1nLlBvc2l0aW9uS2luZCl7Y29uc3QgYT1lLmdldERhdGEoKTt0IT1udWxsP3RoaXMuX3RvdGFsVmVydGljZXM9dDphIT1udWxsJiYodGhpcy5fdG90YWxWZXJ0aWNlcz1hLmxlbmd0aC8oZS50eXBlPT09Zy5CWVRFP2UuYnl0ZVN0cmlkZTplLmJ5dGVTdHJpZGUvNCkpLHRoaXMuX3VwZGF0ZUV4dGVuZChhKSx0aGlzLl9yZXNldFBvaW50c0FycmF5Q2FjaGUoKTtmb3IobGV0IG89MDtvPG47bysrKXtjb25zdCBoPXJbb107aC5idWlsZEJvdW5kaW5nSW5mbyh0aGlzLl9leHRlbmQubWluaW11bSx0aGlzLl9leHRlbmQubWF4aW11bSksaC5fY3JlYXRlR2xvYmFsU3ViTWVzaChoLmlzVW5JbmRleGVkKSxoLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksaC5zeW5jaHJvbml6ZUluc3RhbmNlcygpfX10aGlzLl9ub3RpZnlVcGRhdGUocyl9dXBkYXRlVmVydGljZXNEYXRhRGlyZWN0bHkoZSx0LGkscz0hMSl7Y29uc3Qgcj10aGlzLmdldFZlcnRleEJ1ZmZlcihlKTtyJiYoci51cGRhdGVEaXJlY3RseSh0LGkscyksdGhpcy5fbm90aWZ5VXBkYXRlKGUpKX11cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGk9ITEpe2NvbnN0IHM9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIoZSk7cyYmKHMudXBkYXRlKHQpLGU9PT1nLlBvc2l0aW9uS2luZCYmdGhpcy5fdXBkYXRlQm91bmRpbmdJbmZvKGksdCksdGhpcy5fbm90aWZ5VXBkYXRlKGUpKX1fdXBkYXRlQm91bmRpbmdJbmZvKGUsdCl7aWYoZSYmdGhpcy5fdXBkYXRlRXh0ZW5kKHQpLHRoaXMuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpLGUpe2NvbnN0IGk9dGhpcy5fbWVzaGVzO2Zvcihjb25zdCBzIG9mIGkpe3MuaGFzQm91bmRpbmdJbmZvP3MuZ2V0Qm91bmRpbmdJbmZvKCkucmVDb25zdHJ1Y3QodGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pOnMuYnVpbGRCb3VuZGluZ0luZm8odGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pO2NvbnN0IHI9cy5zdWJNZXNoZXM7Zm9yKGNvbnN0IG4gb2YgciluLnJlZnJlc2hCb3VuZGluZ0luZm8oKX19fV9iaW5kKGUsdCxpLHMpe2lmKCFlKXJldHVybjt0PT09dm9pZCAwJiYodD10aGlzLl9pbmRleEJ1ZmZlcik7Y29uc3Qgcj10aGlzLmdldFZlcnRleEJ1ZmZlcnMoKTtpZighcilyZXR1cm47aWYodCE9dGhpcy5faW5kZXhCdWZmZXJ8fCF0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHMmJiFzKXt0aGlzLl9lbmdpbmUuYmluZEJ1ZmZlcnMocix0LGUsaSk7cmV0dXJufWNvbnN0IG49c3x8dGhpcy5fdmVydGV4QXJyYXlPYmplY3RzO25bZS5rZXldfHwobltlLmtleV09dGhpcy5fZW5naW5lLnJlY29yZFZlcnRleEFycmF5T2JqZWN0KHIsdCxlLGkpKSx0aGlzLl9lbmdpbmUuYmluZFZlcnRleEFycmF5T2JqZWN0KG5bZS5rZXldLHQpfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5fdG90YWxWZXJ0aWNlczowfWdldFZlcnRpY2VzRGF0YShlLHQsaSl7Y29uc3Qgcz10aGlzLmdldFZlcnRleEJ1ZmZlcihlKTtyZXR1cm4gcz9zLmdldEZsb2F0RGF0YSh0aGlzLl90b3RhbFZlcnRpY2VzLGl8fHQmJnRoaXMuX21lc2hlcy5sZW5ndGghPT0xKTpudWxsfWlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGUpe2NvbnN0IHQ9dGhpcy5fdmVydGV4QnVmZmVyc1tlXTtyZXR1cm4gdD90LmlzVXBkYXRhYmxlKCk6ITF9Z2V0VmVydGV4QnVmZmVyKGUpe3JldHVybiB0aGlzLmlzUmVhZHkoKT90aGlzLl92ZXJ0ZXhCdWZmZXJzW2VdOm51bGx9Z2V0VmVydGV4QnVmZmVycygpe3JldHVybiB0aGlzLmlzUmVhZHkoKT90aGlzLl92ZXJ0ZXhCdWZmZXJzOm51bGx9aXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpe3JldHVybiB0aGlzLl92ZXJ0ZXhCdWZmZXJzP3RoaXMuX3ZlcnRleEJ1ZmZlcnNbZV0hPT12b2lkIDA6dGhpcy5fZGVsYXlJbmZvP3RoaXMuX2RlbGF5SW5mby5pbmRleE9mKGUpIT09LTE6ITF9Z2V0VmVydGljZXNEYXRhS2luZHMoKXtjb25zdCBlPVtdO2xldCB0O2lmKCF0aGlzLl92ZXJ0ZXhCdWZmZXJzJiZ0aGlzLl9kZWxheUluZm8pZm9yKHQgaW4gdGhpcy5fZGVsYXlJbmZvKWUucHVzaCh0KTtlbHNlIGZvcih0IGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpZS5wdXNoKHQpO3JldHVybiBlfXVwZGF0ZUluZGljZXMoZSx0LGk9ITEpe2lmKHRoaXMuX2luZGV4QnVmZmVyKWlmKCF0aGlzLl9pbmRleEJ1ZmZlcklzVXBkYXRhYmxlKXRoaXMuc2V0SW5kaWNlcyhlLG51bGwsITApO2Vsc2V7Y29uc3Qgcz1lLmxlbmd0aCE9PXRoaXMuX2luZGljZXMubGVuZ3RoO2lmKGl8fCh0aGlzLl9pbmRpY2VzPWUuc2xpY2UoKSksdGhpcy5fZW5naW5lLnVwZGF0ZUR5bmFtaWNJbmRleEJ1ZmZlcih0aGlzLl9pbmRleEJ1ZmZlcixlLHQpLHMpZm9yKGNvbnN0IHIgb2YgdGhpcy5fbWVzaGVzKXIuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goITApfX1zZXRJbmRpY2VzKGUsdD1udWxsLGk9ITEpe3RoaXMuX2luZGV4QnVmZmVyJiZ0aGlzLl9lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX2luZGljZXM9ZSx0aGlzLl9pbmRleEJ1ZmZlcklzVXBkYXRhYmxlPWksdGhpcy5fbWVzaGVzLmxlbmd0aCE9PTAmJnRoaXMuX2luZGljZXMmJih0aGlzLl9pbmRleEJ1ZmZlcj10aGlzLl9lbmdpbmUuY3JlYXRlSW5kZXhCdWZmZXIodGhpcy5faW5kaWNlcyxpKSksdCE9bnVsbCYmKHRoaXMuX3RvdGFsVmVydGljZXM9dCk7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fbWVzaGVzKXMuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goITApLHMuc3luY2hyb25pemVJbnN0YW5jZXMoKTt0aGlzLl9ub3RpZnlVcGRhdGUoKX1nZXRUb3RhbEluZGljZXMoKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5faW5kaWNlcy5sZW5ndGg6MH1nZXRJbmRpY2VzKGUsdCl7aWYoIXRoaXMuaXNSZWFkeSgpKXJldHVybiBudWxsO2NvbnN0IGk9dGhpcy5faW5kaWNlcztyZXR1cm4hdCYmKCFlfHx0aGlzLl9tZXNoZXMubGVuZ3RoPT09MSk/aTppLnNsaWNlKCl9Z2V0SW5kZXhCdWZmZXIoKXtyZXR1cm4gdGhpcy5pc1JlYWR5KCk/dGhpcy5faW5kZXhCdWZmZXI6bnVsbH1fcmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KGU9bnVsbCl7IWV8fCF0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHN8fHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0c1tlLmtleV0mJih0aGlzLl9lbmdpbmUucmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0c1tlLmtleV0pLGRlbGV0ZSB0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHNbZS5rZXldKX1yZWxlYXNlRm9yTWVzaChlLHQpe2NvbnN0IGk9dGhpcy5fbWVzaGVzLHM9aS5pbmRleE9mKGUpO3MhPT0tMSYmKGkuc3BsaWNlKHMsMSksdGhpcy5fdmVydGV4QXJyYXlPYmplY3RzJiZlLl9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpLGUuX2dlb21ldHJ5PW51bGwsaS5sZW5ndGg9PT0wJiZ0JiZ0aGlzLmRpc3Bvc2UoKSl9YXBwbHlUb01lc2goZSl7aWYoZS5fZ2VvbWV0cnk9PT10aGlzKXJldHVybjtjb25zdCB0PWUuX2dlb21ldHJ5O3QmJnQucmVsZWFzZUZvck1lc2goZSksdGhpcy5fdmVydGV4QXJyYXlPYmplY3RzJiZlLl9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpO2NvbnN0IGk9dGhpcy5fbWVzaGVzO2UuX2dlb21ldHJ5PXRoaXMsZS5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcG9zaXRpb25zPW51bGwsdGhpcy5fc2NlbmUucHVzaEdlb21ldHJ5KHRoaXMpLGkucHVzaChlKSx0aGlzLmlzUmVhZHkoKT90aGlzLl9hcHBseVRvTWVzaChlKTp0aGlzLl9ib3VuZGluZ0luZm8mJmUuc2V0Qm91bmRpbmdJbmZvKHRoaXMuX2JvdW5kaW5nSW5mbyl9X3VwZGF0ZUV4dGVuZChlPW51bGwpe2lmKHRoaXMudXNlQm91bmRpbmdJbmZvRnJvbUdlb21ldHJ5JiZ0aGlzLl9ib3VuZGluZ0luZm8pdGhpcy5fZXh0ZW5kPXttaW5pbXVtOnRoaXMuX2JvdW5kaW5nSW5mby5taW5pbXVtLmNsb25lKCksbWF4aW11bTp0aGlzLl9ib3VuZGluZ0luZm8ubWF4aW11bS5jbG9uZSgpfTtlbHNle2lmKCFlJiYoZT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCksIWUpKXJldHVybjt0aGlzLl9leHRlbmQ9eXIoZSwwLHRoaXMuX3RvdGFsVmVydGljZXMsdGhpcy5ib3VuZGluZ0JpYXMsMyl9fV9hcHBseVRvTWVzaChlKXtjb25zdCB0PXRoaXMuX21lc2hlcy5sZW5ndGg7Zm9yKGNvbnN0IGkgaW4gdGhpcy5fdmVydGV4QnVmZmVycyl0PT09MSYmdGhpcy5fdmVydGV4QnVmZmVyc1tpXS5jcmVhdGUoKSxpPT09Zy5Qb3NpdGlvbktpbmQmJih0aGlzLl9leHRlbmR8fHRoaXMuX3VwZGF0ZUV4dGVuZCgpLGUuYnVpbGRCb3VuZGluZ0luZm8odGhpcy5fZXh0ZW5kLm1pbmltdW0sdGhpcy5fZXh0ZW5kLm1heGltdW0pLGUuX2NyZWF0ZUdsb2JhbFN1Yk1lc2goZS5pc1VuSW5kZXhlZCksZS5fdXBkYXRlQm91bmRpbmdJbmZvKCkpO3Q9PT0xJiZ0aGlzLl9pbmRpY2VzJiZ0aGlzLl9pbmRpY2VzLmxlbmd0aD4wJiYodGhpcy5faW5kZXhCdWZmZXI9dGhpcy5fZW5naW5lLmNyZWF0ZUluZGV4QnVmZmVyKHRoaXMuX2luZGljZXMsdGhpcy5fdXBkYXRhYmxlKSksZS5fc3luY0dlb21ldHJ5V2l0aE1vcnBoVGFyZ2V0TWFuYWdlcigpLGUuc3luY2hyb25pemVJbnN0YW5jZXMoKX1fbm90aWZ5VXBkYXRlKGUpe3RoaXMub25HZW9tZXRyeVVwZGF0ZWQmJnRoaXMub25HZW9tZXRyeVVwZGF0ZWQodGhpcyxlKSx0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHMmJnRoaXMuX2Rpc3Bvc2VWZXJ0ZXhBcnJheU9iamVjdHMoKTtmb3IoY29uc3QgdCBvZiB0aGlzLl9tZXNoZXMpdC5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl9bG9hZChlLHQpe2lmKHRoaXMuZGVsYXlMb2FkU3RhdGUhPT0yKXtpZih0aGlzLmlzUmVhZHkoKSl7dCYmdCgpO3JldHVybn10aGlzLmRlbGF5TG9hZFN0YXRlPTIsdGhpcy5fcXVldWVMb2FkKGUsdCl9fV9xdWV1ZUxvYWQoZSx0KXt0aGlzLmRlbGF5TG9hZGluZ0ZpbGUmJihlLmFkZFBlbmRpbmdEYXRhKHRoaXMpLGUuX2xvYWRGaWxlKHRoaXMuZGVsYXlMb2FkaW5nRmlsZSxpPT57aWYoIXRoaXMuX2RlbGF5TG9hZGluZ0Z1bmN0aW9uKXJldHVybjt0aGlzLl9kZWxheUxvYWRpbmdGdW5jdGlvbihKU09OLnBhcnNlKGkpLHRoaXMpLHRoaXMuZGVsYXlMb2FkU3RhdGU9MSx0aGlzLl9kZWxheUluZm89W10sZS5yZW1vdmVQZW5kaW5nRGF0YSh0aGlzKTtjb25zdCBzPXRoaXMuX21lc2hlcyxyPXMubGVuZ3RoO2ZvcihsZXQgbj0wO248cjtuKyspdGhpcy5fYXBwbHlUb01lc2goc1tuXSk7dCYmdCgpfSx2b2lkIDAsITApKX10b0xlZnRIYW5kZWQoKXtjb25zdCBlPXRoaXMuZ2V0SW5kaWNlcyghMSk7aWYoZSE9bnVsbCYmZS5sZW5ndGg+MCl7Zm9yKGxldCBzPTA7czxlLmxlbmd0aDtzKz0zKXtjb25zdCByPWVbcyswXTtlW3MrMF09ZVtzKzJdLGVbcysyXT1yfXRoaXMuc2V0SW5kaWNlcyhlKX1jb25zdCB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLCExKTtpZih0IT1udWxsJiZ0Lmxlbmd0aD4wKXtmb3IobGV0IHM9MDtzPHQubGVuZ3RoO3MrPTMpdFtzKzJdPS10W3MrMl07dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdCwhMSl9Y29uc3QgaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQsITEpO2lmKGkhPW51bGwmJmkubGVuZ3RoPjApe2ZvcihsZXQgcz0wO3M8aS5sZW5ndGg7cys9MylpW3MrMl09LWlbcysyXTt0aGlzLnNldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQsaSwhMSl9fV9yZXNldFBvaW50c0FycmF5Q2FjaGUoKXt0aGlzLl9wb3NpdGlvbnM9bnVsbH1fZ2VuZXJhdGVQb2ludHNBcnJheSgpe2lmKHRoaXMuX3Bvc2l0aW9ucylyZXR1cm4hMDtjb25zdCBlPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kKTtpZighZXx8ZS5sZW5ndGg9PT0wKXJldHVybiExO2ZvcihsZXQgdD10aGlzLl9wb3NpdGlvbnNDYWNoZS5sZW5ndGgqMyxpPXRoaXMuX3Bvc2l0aW9uc0NhY2hlLmxlbmd0aDt0PGUubGVuZ3RoO3QrPTMsKytpKXRoaXMuX3Bvc2l0aW9uc0NhY2hlW2ldPXAuRnJvbUFycmF5KGUsdCk7Zm9yKGxldCB0PTAsaT0wO3Q8ZS5sZW5ndGg7dCs9MywrK2kpdGhpcy5fcG9zaXRpb25zQ2FjaGVbaV0uc2V0KGVbMCt0XSxlWzErdF0sZVsyK3RdKTtyZXR1cm4gdGhpcy5fcG9zaXRpb25zQ2FjaGUubGVuZ3RoPWUubGVuZ3RoLzMsdGhpcy5fcG9zaXRpb25zPXRoaXMuX3Bvc2l0aW9uc0NhY2hlLCEwfWlzRGlzcG9zZWQoKXtyZXR1cm4gdGhpcy5faXNEaXNwb3NlZH1fZGlzcG9zZVZlcnRleEFycmF5T2JqZWN0cygpe2lmKHRoaXMuX3ZlcnRleEFycmF5T2JqZWN0cyl7Zm9yKGNvbnN0IGkgaW4gdGhpcy5fdmVydGV4QXJyYXlPYmplY3RzKXRoaXMuX2VuZ2luZS5yZWxlYXNlVmVydGV4QXJyYXlPYmplY3QodGhpcy5fdmVydGV4QXJyYXlPYmplY3RzW2ldKTt0aGlzLl92ZXJ0ZXhBcnJheU9iamVjdHM9e307Y29uc3QgZT10aGlzLl9tZXNoZXMsdD1lLmxlbmd0aDtmb3IobGV0IGk9MDtpPHQ7aSsrKWVbaV0uX2ludmFsaWRhdGVJbnN0YW5jZVZlcnRleEFycmF5T2JqZWN0KCl9fWRpc3Bvc2UoKXtjb25zdCBlPXRoaXMuX21lc2hlcyx0PWUubGVuZ3RoO2xldCBpO2ZvcihpPTA7aTx0O2krKyl0aGlzLnJlbGVhc2VGb3JNZXNoKGVbaV0pO3RoaXMuX21lc2hlcy5sZW5ndGg9MCx0aGlzLl9kaXNwb3NlVmVydGV4QXJyYXlPYmplY3RzKCk7Zm9yKGNvbnN0IHMgaW4gdGhpcy5fdmVydGV4QnVmZmVycyl0aGlzLl92ZXJ0ZXhCdWZmZXJzW3NdLmRpc3Bvc2UoKTtpZih0aGlzLl92ZXJ0ZXhCdWZmZXJzPXt9LHRoaXMuX3RvdGFsVmVydGljZXM9MCx0aGlzLl9pbmRleEJ1ZmZlciYmdGhpcy5fZW5naW5lLl9yZWxlYXNlQnVmZmVyKHRoaXMuX2luZGV4QnVmZmVyKSx0aGlzLl9pbmRleEJ1ZmZlcj1udWxsLHRoaXMuX2luZGljZXM9W10sdGhpcy5kZWxheUxvYWRTdGF0ZT0wLHRoaXMuZGVsYXlMb2FkaW5nRmlsZT1udWxsLHRoaXMuX2RlbGF5TG9hZGluZ0Z1bmN0aW9uPW51bGwsdGhpcy5fZGVsYXlJbmZvPVtdLHRoaXMuX2JvdW5kaW5nSW5mbz1udWxsLHRoaXMuX3NjZW5lLnJlbW92ZUdlb21ldHJ5KHRoaXMpLHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3Qgcz10aGlzLl9wYXJlbnRDb250YWluZXIuZ2VvbWV0cmllcy5pbmRleE9mKHRoaXMpO3M+LTEmJnRoaXMuX3BhcmVudENvbnRhaW5lci5nZW9tZXRyaWVzLnNwbGljZShzLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfXRoaXMuX2lzRGlzcG9zZWQ9ITB9Y29weShlKXtjb25zdCB0PW5ldyBlZTt0LmluZGljZXM9W107Y29uc3QgaT10aGlzLmdldEluZGljZXMoKTtpZihpKWZvcihsZXQgbz0wO288aS5sZW5ndGg7bysrKXQuaW5kaWNlcy5wdXNoKGlbb10pO2xldCBzPSExLHI9ITEsbjtmb3IobiBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXtjb25zdCBvPXRoaXMuZ2V0VmVydGljZXNEYXRhKG4pO2lmKG8mJihvIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3Quc2V0KG5ldyBGbG9hdDMyQXJyYXkobyksbik6dC5zZXQoby5zbGljZSgwKSxuKSwhcikpe2NvbnN0IGg9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIobik7aCYmKHM9aC5pc1VwZGF0YWJsZSgpLHI9IXMpfX1jb25zdCBhPW5ldyBhdChlLHRoaXMuX3NjZW5lLHQscyk7YS5kZWxheUxvYWRTdGF0ZT10aGlzLmRlbGF5TG9hZFN0YXRlLGEuZGVsYXlMb2FkaW5nRmlsZT10aGlzLmRlbGF5TG9hZGluZ0ZpbGUsYS5fZGVsYXlMb2FkaW5nRnVuY3Rpb249dGhpcy5fZGVsYXlMb2FkaW5nRnVuY3Rpb247Zm9yKG4gaW4gdGhpcy5fZGVsYXlJbmZvKWEuX2RlbGF5SW5mbz1hLl9kZWxheUluZm98fFtdLGEuX2RlbGF5SW5mby5wdXNoKG4pO3JldHVybiBhLl9ib3VuZGluZ0luZm89bmV3IGR0KHRoaXMuX2V4dGVuZC5taW5pbXVtLHRoaXMuX2V4dGVuZC5tYXhpbXVtKSxhfXNlcmlhbGl6ZSgpe2NvbnN0IGU9e307cmV0dXJuIGUuaWQ9dGhpcy5pZCxlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZS51cGRhdGFibGU9dGhpcy5fdXBkYXRhYmxlLGdlJiZnZS5IYXNUYWdzKHRoaXMpJiYoZS50YWdzPWdlLkdldFRhZ3ModGhpcykpLGV9X3RvTnVtYmVyQXJyYXkoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/ZTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlKX1jbGVhckNhY2hlZERhdGEoKXt0aGlzLl9pbmRpY2VzPVtdLHRoaXMuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpO2Zvcihjb25zdCBlIGluIHRoaXMuX3ZlcnRleEJ1ZmZlcnMpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuX3ZlcnRleEJ1ZmZlcnMsZSkmJih0aGlzLl92ZXJ0ZXhCdWZmZXJzW2VdLl9idWZmZXIuX2RhdGE9bnVsbCl9c2VyaWFsaXplVmVydGljZURhdGEoKXtjb25zdCBlPXRoaXMuc2VyaWFsaXplKCk7cmV0dXJuIHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuUG9zaXRpb25LaW5kKSYmKGUucG9zaXRpb25zPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpKSx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuUG9zaXRpb25LaW5kKSYmKGUucG9zaXRpb25zLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpJiYoZS5ub3JtYWxzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLk5vcm1hbEtpbmQpJiYoZS5ub3JtYWxzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlRhbmdlbnRLaW5kKSYmKGUudGFuZ2VudHM9dGhpcy5fdG9OdW1iZXJBcnJheSh0aGlzLmdldFZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlRhbmdlbnRLaW5kKSYmKGUudGFuZ2VudHMuX3VwZGF0YWJsZT0hMCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVVZLaW5kKSYmKGUudXZzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVktpbmQpKSx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuVVZLaW5kKSYmKGUudXZzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWMktpbmQpJiYoZS51djJzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjJLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWMktpbmQpJiYoZS51djJzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWM0tpbmQpJiYoZS51djNzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjNLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWM0tpbmQpJiYoZS51djNzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNEtpbmQpJiYoZS51djRzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjRLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWNEtpbmQpJiYoZS51djRzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNUtpbmQpJiYoZS51djVzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjVLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWNUtpbmQpJiYoZS51djVzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWNktpbmQpJiYoZS51djZzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5VVjZLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlVWNktpbmQpJiYoZS51djZzLl91cGRhdGFibGU9ITApKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLkNvbG9yS2luZCkmJihlLmNvbG9ycz10aGlzLl90b051bWJlckFycmF5KHRoaXMuZ2V0VmVydGljZXNEYXRhKGcuQ29sb3JLaW5kKSksdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLkNvbG9yS2luZCkmJihlLmNvbG9ycy5fdXBkYXRhYmxlPSEwKSksdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5NYXRyaWNlc0luZGljZXNLaW5kKSYmKGUubWF0cmljZXNJbmRpY2VzPXRoaXMuX3RvTnVtYmVyQXJyYXkodGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSksZS5tYXRyaWNlc0luZGljZXMuX2lzRXhwYW5kZWQ9ITAsdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLk1hdHJpY2VzSW5kaWNlc0tpbmQpJiYoZS5tYXRyaWNlc0luZGljZXMuX3VwZGF0YWJsZT0hMCkpLHRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCkmJihlLm1hdHJpY2VzV2VpZ2h0cz10aGlzLl90b051bWJlckFycmF5KHRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCkpLHRoaXMuaXNWZXJ0ZXhCdWZmZXJVcGRhdGFibGUoZy5NYXRyaWNlc1dlaWdodHNLaW5kKSYmKGUubWF0cmljZXNXZWlnaHRzLl91cGRhdGFibGU9ITApKSxlLmluZGljZXM9dGhpcy5fdG9OdW1iZXJBcnJheSh0aGlzLmdldEluZGljZXMoKSksZX1zdGF0aWMgRXh0cmFjdEZyb21NZXNoKGUsdCl7Y29uc3QgaT1lLl9nZW9tZXRyeTtyZXR1cm4gaT9pLmNvcHkodCk6bnVsbH1zdGF0aWMgUmFuZG9tSWQoKXtyZXR1cm4gSC5SYW5kb21JZCgpfXN0YXRpYyBfR2V0R2VvbWV0cnlCeUxvYWRlZFVuaXF1ZUlkKGUsdCl7Zm9yKGxldCBpPTA7aTx0Lmdlb21ldHJpZXMubGVuZ3RoO2krKylpZih0Lmdlb21ldHJpZXNbaV0uX2xvYWRlZFVuaXF1ZUlkPT09ZSlyZXR1cm4gdC5nZW9tZXRyaWVzW2ldO3JldHVybiBudWxsfXN0YXRpYyBfSW1wb3J0R2VvbWV0cnkoZSx0KXtjb25zdCBpPXQuZ2V0U2NlbmUoKSxzPWUuZ2VvbWV0cnlVbmlxdWVJZCxyPWUuZ2VvbWV0cnlJZDtpZihzfHxyKXtjb25zdCBuPXM/dGhpcy5fR2V0R2VvbWV0cnlCeUxvYWRlZFVuaXF1ZUlkKHMsaSk6aS5nZXRHZW9tZXRyeUJ5SWQocik7biYmbi5hcHBseVRvTWVzaCh0KX1lbHNlIGlmKGUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7Y29uc3Qgbj10Ll9iaW5hcnlJbmZvO2lmKG4ucG9zaXRpb25zQXR0ckRlc2MmJm4ucG9zaXRpb25zQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi5wb3NpdGlvbnNBdHRyRGVzYy5vZmZzZXQsbi5wb3NpdGlvbnNBdHRyRGVzYy5jb3VudCk7dC5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsYSwhMSl9aWYobi5ub3JtYWxzQXR0ckRlc2MmJm4ubm9ybWFsc0F0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4ubm9ybWFsc0F0dHJEZXNjLm9mZnNldCxuLm5vcm1hbHNBdHRyRGVzYy5jb3VudCk7dC5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLGEsITEpfWlmKG4udGFuZ2V0c0F0dHJEZXNjJiZuLnRhbmdldHNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoZSxuLnRhbmdldHNBdHRyRGVzYy5vZmZzZXQsbi50YW5nZXRzQXR0ckRlc2MuY291bnQpO3Quc2V0VmVydGljZXNEYXRhKGcuVGFuZ2VudEtpbmQsYSwhMSl9aWYobi51dnNBdHRyRGVzYyYmbi51dnNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoZSxuLnV2c0F0dHJEZXNjLm9mZnNldCxuLnV2c0F0dHJEZXNjLmNvdW50KTtpZihmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWKWZvcihsZXQgbz0xO288YS5sZW5ndGg7bys9MilhW29dPTEtYVtvXTt0LnNldFZlcnRpY2VzRGF0YShnLlVWS2luZCxhLCExKX1pZihuLnV2czJBdHRyRGVzYyYmbi51dnMyQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi51dnMyQXR0ckRlc2Mub2Zmc2V0LG4udXZzMkF0dHJEZXNjLmNvdW50KTtpZihmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWKWZvcihsZXQgbz0xO288YS5sZW5ndGg7bys9MilhW29dPTEtYVtvXTt0LnNldFZlcnRpY2VzRGF0YShnLlVWMktpbmQsYSwhMSl9aWYobi51dnMzQXR0ckRlc2MmJm4udXZzM0F0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4udXZzM0F0dHJEZXNjLm9mZnNldCxuLnV2czNBdHRyRGVzYy5jb3VudCk7aWYoZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVilmb3IobGV0IG89MTtvPGEubGVuZ3RoO28rPTIpYVtvXT0xLWFbb107dC5zZXRWZXJ0aWNlc0RhdGEoZy5VVjNLaW5kLGEsITEpfWlmKG4udXZzNEF0dHJEZXNjJiZuLnV2czRBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoZSxuLnV2czRBdHRyRGVzYy5vZmZzZXQsbi51dnM0QXR0ckRlc2MuY291bnQpO2lmKGZ0LlVzZU9wZW5HTE9yaWVudGF0aW9uRm9yVVYpZm9yKGxldCBvPTE7bzxhLmxlbmd0aDtvKz0yKWFbb109MS1hW29dO3Quc2V0VmVydGljZXNEYXRhKGcuVVY0S2luZCxhLCExKX1pZihuLnV2czVBdHRyRGVzYyYmbi51dnM1QXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi51dnM1QXR0ckRlc2Mub2Zmc2V0LG4udXZzNUF0dHJEZXNjLmNvdW50KTtpZihmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWKWZvcihsZXQgbz0xO288YS5sZW5ndGg7bys9MilhW29dPTEtYVtvXTt0LnNldFZlcnRpY2VzRGF0YShnLlVWNUtpbmQsYSwhMSl9aWYobi51dnM2QXR0ckRlc2MmJm4udXZzNkF0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4udXZzNkF0dHJEZXNjLm9mZnNldCxuLnV2czZBdHRyRGVzYy5jb3VudCk7aWYoZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVilmb3IobGV0IG89MTtvPGEubGVuZ3RoO28rPTIpYVtvXT0xLWFbb107dC5zZXRWZXJ0aWNlc0RhdGEoZy5VVjZLaW5kLGEsITEpfWlmKG4uY29sb3JzQXR0ckRlc2MmJm4uY29sb3JzQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgRmxvYXQzMkFycmF5KGUsbi5jb2xvcnNBdHRyRGVzYy5vZmZzZXQsbi5jb2xvcnNBdHRyRGVzYy5jb3VudCk7dC5zZXRWZXJ0aWNlc0RhdGEoZy5Db2xvcktpbmQsYSwhMSxuLmNvbG9yc0F0dHJEZXNjLnN0cmlkZSl9aWYobi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYyYmbi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBJbnQzMkFycmF5KGUsbi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5vZmZzZXQsbi5tYXRyaWNlc0luZGljZXNBdHRyRGVzYy5jb3VudCksbz1bXTtmb3IobGV0IGg9MDtoPGEubGVuZ3RoO2grKyl7Y29uc3QgbD1hW2hdO28ucHVzaChsJjI1NSksby5wdXNoKChsJjY1MjgwKT4+OCksby5wdXNoKChsJjE2NzExNjgwKT4+MTYpLG8ucHVzaChsPj4yNCYyNTUpfXQuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzS2luZCxvLCExKX1pZihuLm1hdHJpY2VzSW5kaWNlc0V4dHJhQXR0ckRlc2MmJm4ubWF0cmljZXNJbmRpY2VzRXh0cmFBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBJbnQzMkFycmF5KGUsbi5tYXRyaWNlc0luZGljZXNFeHRyYUF0dHJEZXNjLm9mZnNldCxuLm1hdHJpY2VzSW5kaWNlc0V4dHJhQXR0ckRlc2MuY291bnQpLG89W107Zm9yKGxldCBoPTA7aDxhLmxlbmd0aDtoKyspe2NvbnN0IGw9YVtoXTtvLnB1c2gobCYyNTUpLG8ucHVzaCgobCY2NTI4MCk+PjgpLG8ucHVzaCgobCYxNjcxMTY4MCk+PjE2KSxvLnB1c2gobD4+MjQmMjU1KX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCxvLCExKX1pZihuLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjJiZuLm1hdHJpY2VzV2VpZ2h0c0F0dHJEZXNjLmNvdW50PjApe2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShlLG4ubWF0cmljZXNXZWlnaHRzQXR0ckRlc2Mub2Zmc2V0LG4ubWF0cmljZXNXZWlnaHRzQXR0ckRlc2MuY291bnQpO3Quc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCxhLCExKX1pZihuLmluZGljZXNBdHRyRGVzYyYmbi5pbmRpY2VzQXR0ckRlc2MuY291bnQ+MCl7Y29uc3QgYT1uZXcgSW50MzJBcnJheShlLG4uaW5kaWNlc0F0dHJEZXNjLm9mZnNldCxuLmluZGljZXNBdHRyRGVzYy5jb3VudCk7dC5zZXRJbmRpY2VzKGEsbnVsbCl9aWYobi5zdWJNZXNoZXNBdHRyRGVzYyYmbi5zdWJNZXNoZXNBdHRyRGVzYy5jb3VudD4wKXtjb25zdCBhPW5ldyBJbnQzMkFycmF5KGUsbi5zdWJNZXNoZXNBdHRyRGVzYy5vZmZzZXQsbi5zdWJNZXNoZXNBdHRyRGVzYy5jb3VudCo1KTt0LnN1Yk1lc2hlcz1bXTtmb3IobGV0IG89MDtvPG4uc3ViTWVzaGVzQXR0ckRlc2MuY291bnQ7bysrKXtjb25zdCBoPWFbbyo1KzBdLGw9YVtvKjUrMV0sdT1hW28qNSsyXSxkPWFbbyo1KzNdLGY9YVtvKjUrNF07dnQuQWRkVG9NZXNoKGgsbCx1LGQsZix0KX19fWVsc2UgaWYoZS5wb3NpdGlvbnMmJmUubm9ybWFscyYmZS5pbmRpY2VzKXtpZih0LnNldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCxlLnBvc2l0aW9ucyxlLnBvc2l0aW9ucy5fdXBkYXRhYmxlKSx0LnNldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQsZS5ub3JtYWxzLGUubm9ybWFscy5fdXBkYXRhYmxlKSxlLnRhbmdlbnRzJiZ0LnNldFZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kLGUudGFuZ2VudHMsZS50YW5nZW50cy5fdXBkYXRhYmxlKSxlLnV2cyYmdC5zZXRWZXJ0aWNlc0RhdGEoZy5VVktpbmQsZS51dnMsZS51dnMuX3VwZGF0YWJsZSksZS51dnMyJiZ0LnNldFZlcnRpY2VzRGF0YShnLlVWMktpbmQsZS51dnMyLGUudXZzMi5fdXBkYXRhYmxlKSxlLnV2czMmJnQuc2V0VmVydGljZXNEYXRhKGcuVVYzS2luZCxlLnV2czMsZS51dnMzLl91cGRhdGFibGUpLGUudXZzNCYmdC5zZXRWZXJ0aWNlc0RhdGEoZy5VVjRLaW5kLGUudXZzNCxlLnV2czQuX3VwZGF0YWJsZSksZS51dnM1JiZ0LnNldFZlcnRpY2VzRGF0YShnLlVWNUtpbmQsZS51dnM1LGUudXZzNS5fdXBkYXRhYmxlKSxlLnV2czYmJnQuc2V0VmVydGljZXNEYXRhKGcuVVY2S2luZCxlLnV2czYsZS51dnM2Ll91cGRhdGFibGUpLGUuY29sb3JzJiZ0LnNldFZlcnRpY2VzRGF0YShnLkNvbG9yS2luZCxtZS5DaGVja0NvbG9yczQoZS5jb2xvcnMsZS5wb3NpdGlvbnMubGVuZ3RoLzMpLGUuY29sb3JzLl91cGRhdGFibGUpLGUubWF0cmljZXNJbmRpY2VzKWlmKGUubWF0cmljZXNJbmRpY2VzLl9pc0V4cGFuZGVkKWRlbGV0ZSBlLm1hdHJpY2VzSW5kaWNlcy5faXNFeHBhbmRlZCx0LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0tpbmQsZS5tYXRyaWNlc0luZGljZXMsZS5tYXRyaWNlc0luZGljZXMuX3VwZGF0YWJsZSk7ZWxzZXtjb25zdCBuPVtdO2ZvcihsZXQgYT0wO2E8ZS5tYXRyaWNlc0luZGljZXMubGVuZ3RoO2ErKyl7Y29uc3Qgbz1lLm1hdHJpY2VzSW5kaWNlc1thXTtuLnB1c2gobyYyNTUpLG4ucHVzaCgobyY2NTI4MCk+PjgpLG4ucHVzaCgobyYxNjcxMTY4MCk+PjE2KSxuLnB1c2gobz4+MjQmMjU1KX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0tpbmQsbixlLm1hdHJpY2VzSW5kaWNlcy5fdXBkYXRhYmxlKX1pZihlLm1hdHJpY2VzSW5kaWNlc0V4dHJhKWlmKGUubWF0cmljZXNJbmRpY2VzRXh0cmEuX2lzRXhwYW5kZWQpZGVsZXRlIGUubWF0cmljZXNJbmRpY2VzLl9pc0V4cGFuZGVkLHQuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kLGUubWF0cmljZXNJbmRpY2VzRXh0cmEsZS5tYXRyaWNlc0luZGljZXNFeHRyYS5fdXBkYXRhYmxlKTtlbHNle2NvbnN0IG49W107Zm9yKGxldCBhPTA7YTxlLm1hdHJpY2VzSW5kaWNlc0V4dHJhLmxlbmd0aDthKyspe2NvbnN0IG89ZS5tYXRyaWNlc0luZGljZXNFeHRyYVthXTtuLnB1c2gobyYyNTUpLG4ucHVzaCgobyY2NTI4MCk+PjgpLG4ucHVzaCgobyYxNjcxMTY4MCk+PjE2KSxuLnB1c2gobz4+MjQmMjU1KX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCxuLGUubWF0cmljZXNJbmRpY2VzRXh0cmEuX3VwZGF0YWJsZSl9ZS5tYXRyaWNlc1dlaWdodHMmJihhdC5fQ2xlYW5NYXRyaWNlc1dlaWdodHMoZSx0KSx0LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQsZS5tYXRyaWNlc1dlaWdodHMsZS5tYXRyaWNlc1dlaWdodHMuX3VwZGF0YWJsZSkpLGUubWF0cmljZXNXZWlnaHRzRXh0cmEmJnQuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kLGUubWF0cmljZXNXZWlnaHRzRXh0cmEsZS5tYXRyaWNlc1dlaWdodHMuX3VwZGF0YWJsZSksdC5zZXRJbmRpY2VzKGUuaW5kaWNlcyxudWxsKX1pZihlLnN1Yk1lc2hlcyl7dC5zdWJNZXNoZXM9W107Zm9yKGxldCBuPTA7bjxlLnN1Yk1lc2hlcy5sZW5ndGg7bisrKXtjb25zdCBhPWUuc3ViTWVzaGVzW25dO3Z0LkFkZFRvTWVzaChhLm1hdGVyaWFsSW5kZXgsYS52ZXJ0aWNlc1N0YXJ0LGEudmVydGljZXNDb3VudCxhLmluZGV4U3RhcnQsYS5pbmRleENvdW50LHQpfX10Ll9zaG91bGRHZW5lcmF0ZUZsYXRTaGFkaW5nJiYodC5jb252ZXJ0VG9GbGF0U2hhZGVkTWVzaCgpLHQuX3Nob3VsZEdlbmVyYXRlRmxhdFNoYWRpbmc9ITEpLHQuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSxpLm9uTWVzaEltcG9ydGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModCl9c3RhdGljIF9DbGVhbk1hdHJpY2VzV2VpZ2h0cyhlLHQpe2lmKCFPZS5DbGVhbkJvbmVNYXRyaXhXZWlnaHRzKXJldHVybjtsZXQgcz0wO2lmKGUuc2tlbGV0b25JZD4tMSl7Y29uc3QgdT10LmdldFNjZW5lKCkuZ2V0TGFzdFNrZWxldG9uQnlJZChlLnNrZWxldG9uSWQpO2lmKCF1KXJldHVybjtzPXUuYm9uZXMubGVuZ3RofWVsc2UgcmV0dXJuO2NvbnN0IHI9dC5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSxuPXQuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKSxhPWUubWF0cmljZXNXZWlnaHRzLG89ZS5tYXRyaWNlc1dlaWdodHNFeHRyYSxoPWUubnVtQm9uZUluZmx1ZW5jZXIsbD1hLmxlbmd0aDtmb3IobGV0IHU9MDt1PGw7dSs9NCl7bGV0IGQ9MCxmPS0xO2ZvcihsZXQgXz0wO188NDtfKyspe2NvbnN0IEU9YVt1K19dO2QrPUUsRTwuMDAxJiZmPDAmJihmPV8pfWlmKG8pZm9yKGxldCBfPTA7Xzw0O18rKyl7Y29uc3QgRT1vW3UrX107ZCs9RSxFPC4wMDEmJmY8MCYmKGY9Xys0KX1pZigoZjwwfHxmPmgtMSkmJihmPWgtMSksZD4uMDAxKXtjb25zdCBfPTEvZDtmb3IobGV0IEU9MDtFPDQ7RSsrKWFbdStFXSo9XztpZihvKWZvcihsZXQgRT0wO0U8NDtFKyspb1t1K0VdKj1ffWVsc2UgZj49ND8ob1t1K2YtNF09MS1kLG5bdStmLTRdPXMpOihhW3UrZl09MS1kLHJbdStmXT1zKX10LnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0tpbmQsciksZS5tYXRyaWNlc1dlaWdodHNFeHRyYSYmdC5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNFeHRyYUtpbmQsbil9c3RhdGljIFBhcnNlKGUsdCxpKXtjb25zdCBzPW5ldyBhdChlLmlkLHQsdm9pZCAwLGUudXBkYXRhYmxlKTtyZXR1cm4gcy5fbG9hZGVkVW5pcXVlSWQ9ZS51bmlxdWVJZCxnZSYmZ2UuQWRkVGFnc1RvKHMsZS50YWdzKSxlLmRlbGF5TG9hZGluZ0ZpbGU/KHMuZGVsYXlMb2FkU3RhdGU9NCxzLmRlbGF5TG9hZGluZ0ZpbGU9aStlLmRlbGF5TG9hZGluZ0ZpbGUscy5fYm91bmRpbmdJbmZvPW5ldyBkdChwLkZyb21BcnJheShlLmJvdW5kaW5nQm94TWluaW11bSkscC5Gcm9tQXJyYXkoZS5ib3VuZGluZ0JveE1heGltdW0pKSxzLl9kZWxheUluZm89W10sZS5oYXNVVnMmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVZLaW5kKSxlLmhhc1VWczImJnMuX2RlbGF5SW5mby5wdXNoKGcuVVYyS2luZCksZS5oYXNVVnMzJiZzLl9kZWxheUluZm8ucHVzaChnLlVWM0tpbmQpLGUuaGFzVVZzNCYmcy5fZGVsYXlJbmZvLnB1c2goZy5VVjRLaW5kKSxlLmhhc1VWczUmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVY1S2luZCksZS5oYXNVVnM2JiZzLl9kZWxheUluZm8ucHVzaChnLlVWNktpbmQpLGUuaGFzQ29sb3JzJiZzLl9kZWxheUluZm8ucHVzaChnLkNvbG9yS2luZCksZS5oYXNNYXRyaWNlc0luZGljZXMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNJbmRpY2VzS2luZCksZS5oYXNNYXRyaWNlc1dlaWdodHMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNXZWlnaHRzS2luZCkscy5fZGVsYXlMb2FkaW5nRnVuY3Rpb249ZWUuSW1wb3J0VmVydGV4RGF0YSk6ZWUuSW1wb3J0VmVydGV4RGF0YShlLHMpLHQucHVzaEdlb21ldHJ5KHMsITApLHN9fXZhciBWdDsoZnVuY3Rpb24oYyl7Y1tjLkxPQ0FMPTBdPSJMT0NBTCIsY1tjLldPUkxEPTFdPSJXT1JMRCIsY1tjLkJPTkU9Ml09IkJPTkUifSkoVnR8fChWdD17fSkpO2NsYXNzIF9pe31faS5YPW5ldyBwKDEsMCwwKSxfaS5ZPW5ldyBwKDAsMSwwKSxfaS5aPW5ldyBwKDAsMCwxKTt2YXIgQ3I7KGZ1bmN0aW9uKGMpe2NbYy5YPTBdPSJYIixjW2MuWT0xXT0iWSIsY1tjLlo9Ml09IloifSkoQ3J8fChDcj17fSkpO2NsYXNzIEogZXh0ZW5kcyB6ZXtjb25zdHJ1Y3RvcihlLHQ9bnVsbCxpPSEwKXtzdXBlcihlLHQpLHRoaXMuX2ZvcndhcmQ9bmV3IHAoMCwwLDEpLHRoaXMuX3VwPW5ldyBwKDAsMSwwKSx0aGlzLl9yaWdodD1uZXcgcCgxLDAsMCksdGhpcy5fcG9zaXRpb249cC5aZXJvKCksdGhpcy5fcm90YXRpb249cC5aZXJvKCksdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPW51bGwsdGhpcy5fc2NhbGluZz1wLk9uZSgpLHRoaXMuX3RyYW5zZm9ybVRvQm9uZVJlZmVyYWw9bnVsbCx0aGlzLl9pc0Fic29sdXRlU3luY2VkPSExLHRoaXMuX2JpbGxib2FyZE1vZGU9Si5CSUxMQk9BUkRNT0RFX05PTkUsdGhpcy5fcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZD0hMSx0aGlzLnNjYWxpbmdEZXRlcm1pbmFudD0xLHRoaXMuX2luZmluaXRlRGlzdGFuY2U9ITEsdGhpcy5pZ25vcmVOb25Vbmlmb3JtU2NhbGluZz0hMSx0aGlzLnJlSW50ZWdyYXRlUm90YXRpb25JbnRvUm90YXRpb25RdWF0ZXJuaW9uPSExLHRoaXMuX3Bvc2VNYXRyaXg9bnVsbCx0aGlzLl9sb2NhbE1hdHJpeD14Llplcm8oKSx0aGlzLl91c2VQaXZvdE1hdHJpeD0hMSx0aGlzLl9hYnNvbHV0ZVBvc2l0aW9uPXAuWmVybygpLHRoaXMuX2Fic29sdXRlU2NhbGluZz1wLlplcm8oKSx0aGlzLl9hYnNvbHV0ZVJvdGF0aW9uUXVhdGVybmlvbj1aLklkZW50aXR5KCksdGhpcy5fcGl2b3RNYXRyaXg9eC5JZGVudGl0eSgpLHRoaXMuX3Bvc3RNdWx0aXBseVBpdm90TWF0cml4PSExLHRoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW49ITEsdGhpcy5faW5kZXhJblNjZW5lVHJhbnNmb3JtTm9kZXNBcnJheT0tMSx0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGU9bmV3IEYsdGhpcy5fbm9uVW5pZm9ybVNjYWxpbmc9ITEsaSYmdGhpcy5nZXRTY2VuZSgpLmFkZFRyYW5zZm9ybU5vZGUodGhpcyl9Z2V0IGJpbGxib2FyZE1vZGUoKXtyZXR1cm4gdGhpcy5fYmlsbGJvYXJkTW9kZX1zZXQgYmlsbGJvYXJkTW9kZShlKXt0aGlzLl9iaWxsYm9hcmRNb2RlIT09ZSYmKHRoaXMuX2JpbGxib2FyZE1vZGU9ZSl9Z2V0IHByZXNlcnZlUGFyZW50Um90YXRpb25Gb3JCaWxsYm9hcmQoKXtyZXR1cm4gdGhpcy5fcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZH1zZXQgcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZChlKXtlIT09dGhpcy5fcHJlc2VydmVQYXJlbnRSb3RhdGlvbkZvckJpbGxib2FyZCYmKHRoaXMuX3ByZXNlcnZlUGFyZW50Um90YXRpb25Gb3JCaWxsYm9hcmQ9ZSl9Z2V0IGluZmluaXRlRGlzdGFuY2UoKXtyZXR1cm4gdGhpcy5faW5maW5pdGVEaXN0YW5jZX1zZXQgaW5maW5pdGVEaXN0YW5jZShlKXt0aGlzLl9pbmZpbml0ZURpc3RhbmNlIT09ZSYmKHRoaXMuX2luZmluaXRlRGlzdGFuY2U9ZSl9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlRyYW5zZm9ybU5vZGUifWdldCBwb3NpdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvbn1zZXQgcG9zaXRpb24oZSl7dGhpcy5fcG9zaXRpb249ZSx0aGlzLl9pc0RpcnR5PSEwfWlzVXNpbmdQaXZvdE1hdHJpeCgpe3JldHVybiB0aGlzLl91c2VQaXZvdE1hdHJpeH1nZXQgcm90YXRpb24oKXtyZXR1cm4gdGhpcy5fcm90YXRpb259c2V0IHJvdGF0aW9uKGUpe3RoaXMuX3JvdGF0aW9uPWUsdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPW51bGwsdGhpcy5faXNEaXJ0eT0hMH1nZXQgc2NhbGluZygpe3JldHVybiB0aGlzLl9zY2FsaW5nfXNldCBzY2FsaW5nKGUpe3RoaXMuX3NjYWxpbmc9ZSx0aGlzLl9pc0RpcnR5PSEwfWdldCByb3RhdGlvblF1YXRlcm5pb24oKXtyZXR1cm4gdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9ufXNldCByb3RhdGlvblF1YXRlcm5pb24oZSl7dGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPWUsZSYmdGhpcy5fcm90YXRpb24uc2V0QWxsKDApLHRoaXMuX2lzRGlydHk9ITB9Z2V0IGZvcndhcmQoKXtyZXR1cm4gcC5UcmFuc2Zvcm1Ob3JtYWxGcm9tRmxvYXRzVG9SZWYoMCwwLHRoaXMuZ2V0U2NlbmUoKS51c2VSaWdodEhhbmRlZFN5c3RlbT8tMToxLHRoaXMuZ2V0V29ybGRNYXRyaXgoKSx0aGlzLl9mb3J3YXJkKSx0aGlzLl9mb3J3YXJkLm5vcm1hbGl6ZSgpfWdldCB1cCgpe3JldHVybiBwLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZigwLDEsMCx0aGlzLmdldFdvcmxkTWF0cml4KCksdGhpcy5fdXApLHRoaXMuX3VwLm5vcm1hbGl6ZSgpfWdldCByaWdodCgpe3JldHVybiBwLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZih0aGlzLmdldFNjZW5lKCkudXNlUmlnaHRIYW5kZWRTeXN0ZW0/LTE6MSwwLDAsdGhpcy5nZXRXb3JsZE1hdHJpeCgpLHRoaXMuX3JpZ2h0KSx0aGlzLl9yaWdodC5ub3JtYWxpemUoKX11cGRhdGVQb3NlTWF0cml4KGUpe3JldHVybiB0aGlzLl9wb3NlTWF0cml4Pyh0aGlzLl9wb3NlTWF0cml4LmNvcHlGcm9tKGUpLHRoaXMpOih0aGlzLl9wb3NlTWF0cml4PWUuY2xvbmUoKSx0aGlzKX1nZXRQb3NlTWF0cml4KCl7cmV0dXJuIHRoaXMuX3Bvc2VNYXRyaXh8fCh0aGlzLl9wb3NlTWF0cml4PXguSWRlbnRpdHkoKSksdGhpcy5fcG9zZU1hdHJpeH1faXNTeW5jaHJvbml6ZWQoKXtjb25zdCBlPXRoaXMuX2NhY2hlO3JldHVybiEodGhpcy5fYmlsbGJvYXJkTW9kZSE9PWUuYmlsbGJvYXJkTW9kZXx8dGhpcy5fYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FfHxlLnBpdm90TWF0cml4VXBkYXRlZHx8dGhpcy5faW5maW5pdGVEaXN0YW5jZXx8dGhpcy5fcG9zaXRpb24uX2lzRGlydHl8fHRoaXMuX3NjYWxpbmcuX2lzRGlydHl8fHRoaXMuX3JvdGF0aW9uUXVhdGVybmlvbiYmdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uLl9pc0RpcnR5fHx0aGlzLl9yb3RhdGlvbi5faXNEaXJ0eSl9X2luaXRDYWNoZSgpe3N1cGVyLl9pbml0Q2FjaGUoKTtjb25zdCBlPXRoaXMuX2NhY2hlO2UubG9jYWxNYXRyaXhVcGRhdGVkPSExLGUuYmlsbGJvYXJkTW9kZT0tMSxlLmluZmluaXRlRGlzdGFuY2U9ITF9Z2V0IGFic29sdXRlUG9zaXRpb24oKXtyZXR1cm4gdGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCl9Z2V0IGFic29sdXRlU2NhbGluZygpe3JldHVybiB0aGlzLl9zeW5jQWJzb2x1dGVTY2FsaW5nQW5kUm90YXRpb24oKSx0aGlzLl9hYnNvbHV0ZVNjYWxpbmd9Z2V0IGFic29sdXRlUm90YXRpb25RdWF0ZXJuaW9uKCl7cmV0dXJuIHRoaXMuX3N5bmNBYnNvbHV0ZVNjYWxpbmdBbmRSb3RhdGlvbigpLHRoaXMuX2Fic29sdXRlUm90YXRpb25RdWF0ZXJuaW9ufXNldFByZVRyYW5zZm9ybU1hdHJpeChlKXtyZXR1cm4gdGhpcy5zZXRQaXZvdE1hdHJpeChlLCExKX1zZXRQaXZvdE1hdHJpeChlLHQ9ITApe3JldHVybiB0aGlzLl9waXZvdE1hdHJpeC5jb3B5RnJvbShlKSx0aGlzLl91c2VQaXZvdE1hdHJpeD0hdGhpcy5fcGl2b3RNYXRyaXguaXNJZGVudGl0eSgpLHRoaXMuX2NhY2hlLnBpdm90TWF0cml4VXBkYXRlZD0hMCx0aGlzLl9wb3N0TXVsdGlwbHlQaXZvdE1hdHJpeD10LHRoaXMuX3Bvc3RNdWx0aXBseVBpdm90TWF0cml4JiYodGhpcy5fcGl2b3RNYXRyaXhJbnZlcnNlP3RoaXMuX3Bpdm90TWF0cml4LmludmVydFRvUmVmKHRoaXMuX3Bpdm90TWF0cml4SW52ZXJzZSk6dGhpcy5fcGl2b3RNYXRyaXhJbnZlcnNlPXguSW52ZXJ0KHRoaXMuX3Bpdm90TWF0cml4KSksdGhpc31nZXRQaXZvdE1hdHJpeCgpe3JldHVybiB0aGlzLl9waXZvdE1hdHJpeH1pbnN0YW50aWF0ZUhpZXJhcmNoeShlPW51bGwsdCxpKXtjb25zdCBzPXRoaXMuY2xvbmUoIkNsb25lIG9mICIrKHRoaXMubmFtZXx8dGhpcy5pZCksZXx8dGhpcy5wYXJlbnQsITApO3MmJmkmJmkodGhpcyxzKTtmb3IoY29uc3QgciBvZiB0aGlzLmdldENoaWxkVHJhbnNmb3JtTm9kZXMoITApKXIuaW5zdGFudGlhdGVIaWVyYXJjaHkocyx0LGkpO3JldHVybiBzfWZyZWV6ZVdvcmxkTWF0cml4KGU9bnVsbCx0PSExKXtyZXR1cm4gZT90Pyh0aGlzLl9yb3RhdGlvbi5zZXRBbGwoMCksdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPXRoaXMuX3JvdGF0aW9uUXVhdGVybmlvbnx8Wi5JZGVudGl0eSgpLGUuZGVjb21wb3NlKHRoaXMuX3NjYWxpbmcsdGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uLHRoaXMuX3Bvc2l0aW9uKSx0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCkpOih0aGlzLl93b3JsZE1hdHJpeD1lLHRoaXMuX2Fic29sdXRlUG9zaXRpb24uY29weUZyb21GbG9hdHModGhpcy5fd29ybGRNYXRyaXgubVsxMl0sdGhpcy5fd29ybGRNYXRyaXgubVsxM10sdGhpcy5fd29ybGRNYXRyaXgubVsxNF0pLHRoaXMuX2FmdGVyQ29tcHV0ZVdvcmxkTWF0cml4KCkpOih0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSExLHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSksdGhpcy5faXNEaXJ0eT0hMSx0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSEwLHRoaXN9dW5mcmVlemVXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVuPSExLHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSx0aGlzfWdldCBpc1dvcmxkTWF0cml4RnJvemVuKCl7cmV0dXJuIHRoaXMuX2lzV29ybGRNYXRyaXhGcm96ZW59Z2V0QWJzb2x1dGVQb3NpdGlvbigpe3JldHVybiB0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMuX2Fic29sdXRlUG9zaXRpb259c2V0QWJzb2x1dGVQb3NpdGlvbihlKXtpZighZSlyZXR1cm4gdGhpcztsZXQgdCxpLHM7aWYoZS54PT09dm9pZCAwKXtpZihhcmd1bWVudHMubGVuZ3RoPDMpcmV0dXJuIHRoaXM7dD1hcmd1bWVudHNbMF0saT1hcmd1bWVudHNbMV0scz1hcmd1bWVudHNbMl19ZWxzZSB0PWUueCxpPWUueSxzPWUuejtpZih0aGlzLnBhcmVudCl7Y29uc3Qgcj1ELk1hdHJpeFswXTt0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLmludmVydFRvUmVmKHIpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYodCxpLHMscix0aGlzLnBvc2l0aW9uKX1lbHNlIHRoaXMucG9zaXRpb24ueD10LHRoaXMucG9zaXRpb24ueT1pLHRoaXMucG9zaXRpb24uej1zO3JldHVybiB0aGlzLl9hYnNvbHV0ZVBvc2l0aW9uLmNvcHlGcm9tKGUpLHRoaXN9c2V0UG9zaXRpb25XaXRoTG9jYWxWZWN0b3IoZSl7cmV0dXJuIHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCksdGhpcy5wb3NpdGlvbj1wLlRyYW5zZm9ybU5vcm1hbChlLHRoaXMuX2xvY2FsTWF0cml4KSx0aGlzfWdldFBvc2l0aW9uRXhwcmVzc2VkSW5Mb2NhbFNwYWNlKCl7dGhpcy5jb21wdXRlV29ybGRNYXRyaXgoKTtjb25zdCBlPUQuTWF0cml4WzBdO3JldHVybiB0aGlzLl9sb2NhbE1hdHJpeC5pbnZlcnRUb1JlZihlKSxwLlRyYW5zZm9ybU5vcm1hbCh0aGlzLnBvc2l0aW9uLGUpfWxvY2FsbHlUcmFuc2xhdGUoZSl7cmV0dXJuIHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSx0aGlzLnBvc2l0aW9uPXAuVHJhbnNmb3JtQ29vcmRpbmF0ZXMoZSx0aGlzLl9sb2NhbE1hdHJpeCksdGhpc31sb29rQXQoZSx0PTAsaT0wLHM9MCxyPVZ0LkxPQ0FMKXtjb25zdCBuPUouX0xvb2tBdFZlY3RvckNhY2hlLGE9cj09PVZ0LkxPQ0FMP3RoaXMucG9zaXRpb246dGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7aWYoZS5zdWJ0cmFjdFRvUmVmKGEsbiksdGhpcy5zZXREaXJlY3Rpb24obix0LGkscykscj09PVZ0LldPUkxEJiZ0aGlzLnBhcmVudClpZih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbil7Y29uc3Qgbz1ELk1hdHJpeFswXTt0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi50b1JvdGF0aW9uTWF0cml4KG8pO2NvbnN0IGg9RC5NYXRyaXhbMV07dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5nZXRSb3RhdGlvbk1hdHJpeFRvUmVmKGgpLGguaW52ZXJ0KCksby5tdWx0aXBseVRvUmVmKGgsbyksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24uZnJvbVJvdGF0aW9uTWF0cml4KG8pfWVsc2V7Y29uc3Qgbz1ELlF1YXRlcm5pb25bMF07Wi5Gcm9tRXVsZXJWZWN0b3JUb1JlZih0aGlzLnJvdGF0aW9uLG8pO2NvbnN0IGg9RC5NYXRyaXhbMF07by50b1JvdGF0aW9uTWF0cml4KGgpO2NvbnN0IGw9RC5NYXRyaXhbMV07dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5nZXRSb3RhdGlvbk1hdHJpeFRvUmVmKGwpLGwuaW52ZXJ0KCksaC5tdWx0aXBseVRvUmVmKGwsaCksby5mcm9tUm90YXRpb25NYXRyaXgoaCksby50b0V1bGVyQW5nbGVzVG9SZWYodGhpcy5yb3RhdGlvbil9cmV0dXJuIHRoaXN9Z2V0RGlyZWN0aW9uKGUpe2NvbnN0IHQ9cC5aZXJvKCk7cmV0dXJuIHRoaXMuZ2V0RGlyZWN0aW9uVG9SZWYoZSx0KSx0fWdldERpcmVjdGlvblRvUmVmKGUsdCl7cmV0dXJuIHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYoZSx0aGlzLmdldFdvcmxkTWF0cml4KCksdCksdGhpc31zZXREaXJlY3Rpb24oZSx0PTAsaT0wLHM9MCl7Y29uc3Qgcj0tTWF0aC5hdGFuMihlLnosZS54KStNYXRoLlBJLzIsbj1NYXRoLnNxcnQoZS54KmUueCtlLnoqZS56KSxhPS1NYXRoLmF0YW4yKGUueSxuKTtyZXR1cm4gdGhpcy5yb3RhdGlvblF1YXRlcm5pb24/Wi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHIrdCxhK2kscyx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbik6KHRoaXMucm90YXRpb24ueD1hK2ksdGhpcy5yb3RhdGlvbi55PXIrdCx0aGlzLnJvdGF0aW9uLno9cyksdGhpc31zZXRQaXZvdFBvaW50KGUsdD1WdC5MT0NBTCl7dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCk9PTAmJnRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKTtjb25zdCBpPXRoaXMuZ2V0V29ybGRNYXRyaXgoKTtpZih0PT1WdC5XT1JMRCl7Y29uc3Qgcz1ELk1hdHJpeFswXTtpLmludmVydFRvUmVmKHMpLGU9cC5UcmFuc2Zvcm1Db29yZGluYXRlcyhlLHMpfXJldHVybiB0aGlzLnNldFBpdm90TWF0cml4KHguVHJhbnNsYXRpb24oLWUueCwtZS55LC1lLnopLCEwKX1nZXRQaXZvdFBvaW50KCl7Y29uc3QgZT1wLlplcm8oKTtyZXR1cm4gdGhpcy5nZXRQaXZvdFBvaW50VG9SZWYoZSksZX1nZXRQaXZvdFBvaW50VG9SZWYoZSl7cmV0dXJuIGUueD0tdGhpcy5fcGl2b3RNYXRyaXgubVsxMl0sZS55PS10aGlzLl9waXZvdE1hdHJpeC5tWzEzXSxlLno9LXRoaXMuX3Bpdm90TWF0cml4Lm1bMTRdLHRoaXN9Z2V0QWJzb2x1dGVQaXZvdFBvaW50KCl7Y29uc3QgZT1wLlplcm8oKTtyZXR1cm4gdGhpcy5nZXRBYnNvbHV0ZVBpdm90UG9pbnRUb1JlZihlKSxlfWdldEFic29sdXRlUGl2b3RQb2ludFRvUmVmKGUpe3JldHVybiB0aGlzLmdldFBpdm90UG9pbnRUb1JlZihlKSxwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZSx0aGlzLmdldFdvcmxkTWF0cml4KCksZSksdGhpc31tYXJrQXNEaXJ0eShlKXtpZih0aGlzLl9pc0RpcnR5KXJldHVybiB0aGlzO2lmKHRoaXMuX2NoaWxkcmVuKWZvcihjb25zdCB0IG9mIHRoaXMuX2NoaWxkcmVuKXQubWFya0FzRGlydHkoZSk7cmV0dXJuIHN1cGVyLm1hcmtBc0RpcnR5KGUpfXNldFBhcmVudChlLHQ9ITEsaT0hMSl7aWYoIWUmJiF0aGlzLnBhcmVudClyZXR1cm4gdGhpcztjb25zdCBzPUQuUXVhdGVybmlvblswXSxyPUQuVmVjdG9yM1swXSxuPUQuVmVjdG9yM1sxXSxhPUQuTWF0cml4WzFdO3guSWRlbnRpdHlUb1JlZihhKTtjb25zdCBvPUQuTWF0cml4WzBdO3RoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKTtsZXQgaD10aGlzLnJvdGF0aW9uUXVhdGVybmlvbjtyZXR1cm4gaHx8KGg9Si5fVG1wUm90YXRpb24sWi5Sb3RhdGlvbllhd1BpdGNoUm9sbFRvUmVmKHRoaXMuX3JvdGF0aW9uLnksdGhpcy5fcm90YXRpb24ueCx0aGlzLl9yb3RhdGlvbi56LGgpKSx4LkNvbXBvc2VUb1JlZih0aGlzLnNjYWxpbmcsaCx0aGlzLnBvc2l0aW9uLG8pLHRoaXMucGFyZW50JiZvLm11bHRpcGx5VG9SZWYodGhpcy5wYXJlbnQuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSxvKSxlJiYoZS5jb21wdXRlV29ybGRNYXRyaXgoITApLmludmVydFRvUmVmKGEpLG8ubXVsdGlwbHlUb1JlZihhLG8pKSxvLmRlY29tcG9zZShuLHMscix0P3RoaXM6dm9pZCAwKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbShzKTpzLnRvRXVsZXJBbmdsZXNUb1JlZih0aGlzLnJvdGF0aW9uKSx0aGlzLnNjYWxpbmcuY29weUZyb20obiksdGhpcy5wb3NpdGlvbi5jb3B5RnJvbShyKSx0aGlzLnBhcmVudD1lLGkmJnRoaXMuc2V0UGl2b3RNYXRyaXgoeC5JZGVudGl0eSgpKSx0aGlzfWdldCBub25Vbmlmb3JtU2NhbGluZygpe3JldHVybiB0aGlzLl9ub25Vbmlmb3JtU2NhbGluZ31fdXBkYXRlTm9uVW5pZm9ybVNjYWxpbmdTdGF0ZShlKXtyZXR1cm4gdGhpcy5fbm9uVW5pZm9ybVNjYWxpbmc9PT1lPyExOih0aGlzLl9ub25Vbmlmb3JtU2NhbGluZz1lLCEwKX1hdHRhY2hUb0JvbmUoZSx0KXtyZXR1cm4gdGhpcy5fY3VycmVudFBhcmVudFdoZW5BdHRhY2hpbmdUb0JvbmU9dGhpcy5wYXJlbnQsdGhpcy5fdHJhbnNmb3JtVG9Cb25lUmVmZXJhbD10LHRoaXMucGFyZW50PWUsZS5nZXRTa2VsZXRvbigpLnByZXBhcmUoKSxlLmdldFdvcmxkTWF0cml4KCkuZGV0ZXJtaW5hbnQoKTwwJiYodGhpcy5zY2FsaW5nRGV0ZXJtaW5hbnQqPS0xKSx0aGlzfWRldGFjaEZyb21Cb25lKGU9ITEpe3JldHVybiB0aGlzLnBhcmVudD8odGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5kZXRlcm1pbmFudCgpPDAmJih0aGlzLnNjYWxpbmdEZXRlcm1pbmFudCo9LTEpLHRoaXMuX3RyYW5zZm9ybVRvQm9uZVJlZmVyYWw9bnVsbCxlP3RoaXMucGFyZW50PXRoaXMuX2N1cnJlbnRQYXJlbnRXaGVuQXR0YWNoaW5nVG9Cb25lOnRoaXMucGFyZW50PW51bGwsdGhpcyk6KGUmJih0aGlzLnBhcmVudD10aGlzLl9jdXJyZW50UGFyZW50V2hlbkF0dGFjaGluZ1RvQm9uZSksdGhpcyl9cm90YXRlKGUsdCxpKXtlLm5vcm1hbGl6ZSgpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9ufHwodGhpcy5yb3RhdGlvblF1YXRlcm5pb249dGhpcy5yb3RhdGlvbi50b1F1YXRlcm5pb24oKSx0aGlzLnJvdGF0aW9uLnNldEFsbCgwKSk7bGV0IHM7aWYoIWl8fGk9PT1WdC5MT0NBTClzPVouUm90YXRpb25BeGlzVG9SZWYoZSx0LEouX1JvdGF0aW9uQXhpc0NhY2hlKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5tdWx0aXBseVRvUmVmKHMsdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pO2Vsc2V7aWYodGhpcy5wYXJlbnQpe2NvbnN0IHI9RC5NYXRyaXhbMF07dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKS5pbnZlcnRUb1JlZihyKSxlPXAuVHJhbnNmb3JtTm9ybWFsKGUscil9cz1aLlJvdGF0aW9uQXhpc1RvUmVmKGUsdCxKLl9Sb3RhdGlvbkF4aXNDYWNoZSkscy5tdWx0aXBseVRvUmVmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKX1yZXR1cm4gdGhpc31yb3RhdGVBcm91bmQoZSx0LGkpe3Qubm9ybWFsaXplKCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb258fCh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj1aLlJvdGF0aW9uWWF3UGl0Y2hSb2xsKHRoaXMucm90YXRpb24ueSx0aGlzLnJvdGF0aW9uLngsdGhpcy5yb3RhdGlvbi56KSx0aGlzLnJvdGF0aW9uLnNldEFsbCgwKSk7Y29uc3Qgcz1ELlZlY3RvcjNbMF0scj1ELlZlY3RvcjNbMV0sbj1ELlZlY3RvcjNbMl0sYT1ELlF1YXRlcm5pb25bMF0sbz1ELk1hdHJpeFswXSxoPUQuTWF0cml4WzFdLGw9RC5NYXRyaXhbMl0sdT1ELk1hdHJpeFszXTtyZXR1cm4gZS5zdWJ0cmFjdFRvUmVmKHRoaXMucG9zaXRpb24scykseC5UcmFuc2xhdGlvblRvUmVmKHMueCxzLnkscy56LG8pLHguVHJhbnNsYXRpb25Ub1JlZigtcy54LC1zLnksLXMueixoKSx4LlJvdGF0aW9uQXhpc1RvUmVmKHQsaSxsKSxoLm11bHRpcGx5VG9SZWYobCx1KSx1Lm11bHRpcGx5VG9SZWYobyx1KSx1LmRlY29tcG9zZShyLGEsbiksdGhpcy5wb3NpdGlvbi5hZGRJblBsYWNlKG4pLGEubXVsdGlwbHlUb1JlZih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbix0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiksdGhpc310cmFuc2xhdGUoZSx0LGkpe2NvbnN0IHM9ZS5zY2FsZSh0KTtpZighaXx8aT09PVZ0LkxPQ0FMKXtjb25zdCByPXRoaXMuZ2V0UG9zaXRpb25FeHByZXNzZWRJbkxvY2FsU3BhY2UoKS5hZGQocyk7dGhpcy5zZXRQb3NpdGlvbldpdGhMb2NhbFZlY3RvcihyKX1lbHNlIHRoaXMuc2V0QWJzb2x1dGVQb3NpdGlvbih0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKS5hZGQocykpO3JldHVybiB0aGlzfWFkZFJvdGF0aW9uKGUsdCxpKXtsZXQgczt0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj9zPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uOihzPUQuUXVhdGVybmlvblsxXSxaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnoscykpO2NvbnN0IHI9RC5RdWF0ZXJuaW9uWzBdO3JldHVybiBaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodCxlLGkscikscy5tdWx0aXBseUluUGxhY2UociksdGhpcy5yb3RhdGlvblF1YXRlcm5pb258fHMudG9FdWxlckFuZ2xlc1RvUmVmKHRoaXMucm90YXRpb24pLHRoaXN9X2dldEVmZmVjdGl2ZVBhcmVudCgpe3JldHVybiB0aGlzLnBhcmVudH1jb21wdXRlV29ybGRNYXRyaXgoZSl7aWYodGhpcy5faXNXb3JsZE1hdHJpeEZyb3plbiYmIXRoaXMuX2lzRGlydHkpcmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4O2NvbnN0IHQ9dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCk7aWYoIXRoaXMuX2lzRGlydHkmJiFlJiYodGhpcy5fY3VycmVudFJlbmRlcklkPT09dHx8dGhpcy5pc1N5bmNocm9uaXplZCgpKSlyZXR1cm4gdGhpcy5fY3VycmVudFJlbmRlcklkPXQsdGhpcy5fd29ybGRNYXRyaXg7Y29uc3QgaT10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhLHM9KHRoaXMuX2JpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX1VTRV9QT1NJVElPTikhPT0wLHI9dGhpcy5fYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FJiYhdGhpcy5wcmVzZXJ2ZVBhcmVudFJvdGF0aW9uRm9yQmlsbGJvYXJkO3RoaXMuX3VwZGF0ZUNhY2hlKCk7Y29uc3Qgbj10aGlzLl9jYWNoZTtuLnBpdm90TWF0cml4VXBkYXRlZD0hMSxuLmJpbGxib2FyZE1vZGU9dGhpcy5iaWxsYm9hcmRNb2RlLG4uaW5maW5pdGVEaXN0YW5jZT10aGlzLmluZmluaXRlRGlzdGFuY2Usbi5wYXJlbnQ9dGhpcy5fcGFyZW50Tm9kZSx0aGlzLl9jdXJyZW50UmVuZGVySWQ9dCx0aGlzLl9jaGlsZFVwZGF0ZUlkKz0xLHRoaXMuX2lzRGlydHk9ITEsdGhpcy5fcG9zaXRpb24uX2lzRGlydHk9ITEsdGhpcy5fcm90YXRpb24uX2lzRGlydHk9ITEsdGhpcy5fc2NhbGluZy5faXNEaXJ0eT0hMTtjb25zdCBhPXRoaXMuX2dldEVmZmVjdGl2ZVBhcmVudCgpLG89Si5fVG1wU2NhbGluZztsZXQgaD10aGlzLl9wb3NpdGlvbjtpZih0aGlzLl9pbmZpbml0ZURpc3RhbmNlJiYhdGhpcy5wYXJlbnQmJmkpe2NvbnN0IHU9aS5nZXRXb3JsZE1hdHJpeCgpLGQ9bmV3IHAodS5tWzEyXSx1Lm1bMTNdLHUubVsxNF0pO2g9Si5fVG1wVHJhbnNsYXRpb24saC5jb3B5RnJvbUZsb2F0cyh0aGlzLl9wb3NpdGlvbi54K2QueCx0aGlzLl9wb3NpdGlvbi55K2QueSx0aGlzLl9wb3NpdGlvbi56K2Queil9by5jb3B5RnJvbUZsb2F0cyh0aGlzLl9zY2FsaW5nLngqdGhpcy5zY2FsaW5nRGV0ZXJtaW5hbnQsdGhpcy5fc2NhbGluZy55KnRoaXMuc2NhbGluZ0RldGVybWluYW50LHRoaXMuX3NjYWxpbmcueip0aGlzLnNjYWxpbmdEZXRlcm1pbmFudCk7bGV0IGw7aWYodGhpcy5fcm90YXRpb25RdWF0ZXJuaW9uPyh0aGlzLl9yb3RhdGlvblF1YXRlcm5pb24uX2lzRGlydHk9ITEsbD10aGlzLl9yb3RhdGlvblF1YXRlcm5pb24sdGhpcy5yZUludGVncmF0ZVJvdGF0aW9uSW50b1JvdGF0aW9uUXVhdGVybmlvbiYmdGhpcy5yb3RhdGlvbi5sZW5ndGhTcXVhcmVkKCkmJih0aGlzLl9yb3RhdGlvblF1YXRlcm5pb24ubXVsdGlwbHlJblBsYWNlKFouUm90YXRpb25ZYXdQaXRjaFJvbGwodGhpcy5fcm90YXRpb24ueSx0aGlzLl9yb3RhdGlvbi54LHRoaXMuX3JvdGF0aW9uLnopKSx0aGlzLl9yb3RhdGlvbi5jb3B5RnJvbUZsb2F0cygwLDAsMCkpKToobD1KLl9UbXBSb3RhdGlvbixaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5fcm90YXRpb24ueSx0aGlzLl9yb3RhdGlvbi54LHRoaXMuX3JvdGF0aW9uLnosbCkpLHRoaXMuX3VzZVBpdm90TWF0cml4KXtjb25zdCB1PUQuTWF0cml4WzFdO3guU2NhbGluZ1RvUmVmKG8ueCxvLnksby56LHUpO2NvbnN0IGQ9RC5NYXRyaXhbMF07bC50b1JvdGF0aW9uTWF0cml4KGQpLHRoaXMuX3Bpdm90TWF0cml4Lm11bHRpcGx5VG9SZWYodSxELk1hdHJpeFs0XSksRC5NYXRyaXhbNF0ubXVsdGlwbHlUb1JlZihkLHRoaXMuX2xvY2FsTWF0cml4KSx0aGlzLl9wb3N0TXVsdGlwbHlQaXZvdE1hdHJpeCYmdGhpcy5fbG9jYWxNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9waXZvdE1hdHJpeEludmVyc2UsdGhpcy5fbG9jYWxNYXRyaXgpLHRoaXMuX2xvY2FsTWF0cml4LmFkZFRyYW5zbGF0aW9uRnJvbUZsb2F0cyhoLngsaC55LGgueil9ZWxzZSB4LkNvbXBvc2VUb1JlZihvLGwsaCx0aGlzLl9sb2NhbE1hdHJpeCk7aWYoYSYmYS5nZXRXb3JsZE1hdHJpeCl7aWYoZSYmYS5jb21wdXRlV29ybGRNYXRyaXgoZSkscil7dGhpcy5fdHJhbnNmb3JtVG9Cb25lUmVmZXJhbD9hLmdldFdvcmxkTWF0cml4KCkubXVsdGlwbHlUb1JlZih0aGlzLl90cmFuc2Zvcm1Ub0JvbmVSZWZlcmFsLmdldFdvcmxkTWF0cml4KCksRC5NYXRyaXhbN10pOkQuTWF0cml4WzddLmNvcHlGcm9tKGEuZ2V0V29ybGRNYXRyaXgoKSk7Y29uc3QgdT1ELlZlY3RvcjNbNV0sZD1ELlZlY3RvcjNbNl0sZj1ELlF1YXRlcm5pb25bMF07RC5NYXRyaXhbN10uZGVjb21wb3NlKGQsZix1KSx4LlNjYWxpbmdUb1JlZihkLngsZC55LGQueixELk1hdHJpeFs3XSksRC5NYXRyaXhbN10uc2V0VHJhbnNsYXRpb24odSksSi5CaWxsYm9hcmRVc2VQYXJlbnRPcmllbnRhdGlvbiYmKHRoaXMuX3Bvc2l0aW9uLmFwcGx5Um90YXRpb25RdWF0ZXJuaW9uVG9SZWYoZix1KSx0aGlzLl9sb2NhbE1hdHJpeC5zZXRUcmFuc2xhdGlvbih1KSksdGhpcy5fbG9jYWxNYXRyaXgubXVsdGlwbHlUb1JlZihELk1hdHJpeFs3XSx0aGlzLl93b3JsZE1hdHJpeCl9ZWxzZSB0aGlzLl90cmFuc2Zvcm1Ub0JvbmVSZWZlcmFsPyh0aGlzLl9sb2NhbE1hdHJpeC5tdWx0aXBseVRvUmVmKGEuZ2V0V29ybGRNYXRyaXgoKSxELk1hdHJpeFs2XSksRC5NYXRyaXhbNl0ubXVsdGlwbHlUb1JlZih0aGlzLl90cmFuc2Zvcm1Ub0JvbmVSZWZlcmFsLmdldFdvcmxkTWF0cml4KCksdGhpcy5fd29ybGRNYXRyaXgpKTp0aGlzLl9sb2NhbE1hdHJpeC5tdWx0aXBseVRvUmVmKGEuZ2V0V29ybGRNYXRyaXgoKSx0aGlzLl93b3JsZE1hdHJpeCk7dGhpcy5fbWFya1N5bmNlZFdpdGhQYXJlbnQoKX1lbHNlIHRoaXMuX3dvcmxkTWF0cml4LmNvcHlGcm9tKHRoaXMuX2xvY2FsTWF0cml4KTtpZihyJiZpJiZ0aGlzLmJpbGxib2FyZE1vZGUmJiFzKXtjb25zdCB1PUQuVmVjdG9yM1swXTtpZih0aGlzLl93b3JsZE1hdHJpeC5nZXRUcmFuc2xhdGlvblRvUmVmKHUpLEQuTWF0cml4WzFdLmNvcHlGcm9tKGkuZ2V0Vmlld01hdHJpeCgpKSxELk1hdHJpeFsxXS5zZXRUcmFuc2xhdGlvbkZyb21GbG9hdHMoMCwwLDApLEQuTWF0cml4WzFdLmludmVydFRvUmVmKEQuTWF0cml4WzBdKSwodGhpcy5iaWxsYm9hcmRNb2RlJkouQklMTEJPQVJETU9ERV9BTEwpIT09Si5CSUxMQk9BUkRNT0RFX0FMTCl7RC5NYXRyaXhbMF0uZGVjb21wb3NlKHZvaWQgMCxELlF1YXRlcm5pb25bMF0sdm9pZCAwKTtjb25zdCBkPUQuVmVjdG9yM1sxXTtELlF1YXRlcm5pb25bMF0udG9FdWxlckFuZ2xlc1RvUmVmKGQpLCh0aGlzLmJpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX1gpIT09Si5CSUxMQk9BUkRNT0RFX1gmJihkLng9MCksKHRoaXMuYmlsbGJvYXJkTW9kZSZKLkJJTExCT0FSRE1PREVfWSkhPT1KLkJJTExCT0FSRE1PREVfWSYmKGQueT0wKSwodGhpcy5iaWxsYm9hcmRNb2RlJkouQklMTEJPQVJETU9ERV9aKSE9PUouQklMTEJPQVJETU9ERV9aJiYoZC56PTApLHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihkLnksZC54LGQueixELk1hdHJpeFswXSl9dGhpcy5fd29ybGRNYXRyaXguc2V0VHJhbnNsYXRpb25Gcm9tRmxvYXRzKDAsMCwwKSx0aGlzLl93b3JsZE1hdHJpeC5tdWx0aXBseVRvUmVmKEQuTWF0cml4WzBdLHRoaXMuX3dvcmxkTWF0cml4KSx0aGlzLl93b3JsZE1hdHJpeC5zZXRUcmFuc2xhdGlvbihELlZlY3RvcjNbMF0pfWVsc2UgaWYociYmaSYmdGhpcy5iaWxsYm9hcmRNb2RlJiZzKXtjb25zdCB1PUQuVmVjdG9yM1swXTt0aGlzLl93b3JsZE1hdHJpeC5nZXRUcmFuc2xhdGlvblRvUmVmKHUpO2NvbnN0IGQ9aS5nbG9iYWxQb3NpdGlvbjt0aGlzLl93b3JsZE1hdHJpeC5pbnZlcnRUb1JlZihELk1hdHJpeFsxXSk7Y29uc3QgZj1ELlZlY3RvcjNbMV07cC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGQsRC5NYXRyaXhbMV0sZiksZi5ub3JtYWxpemUoKTtjb25zdCBfPS1NYXRoLmF0YW4yKGYueixmLngpK01hdGguUEkvMixFPU1hdGguc3FydChmLngqZi54K2YueipmLnopLG09LU1hdGguYXRhbjIoZi55LEUpO2lmKFouUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZihfLG0sMCxELlF1YXRlcm5pb25bMF0pLCh0aGlzLmJpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX0FMTCkhPT1KLkJJTExCT0FSRE1PREVfQUxMKXtjb25zdCB2PUQuVmVjdG9yM1sxXTtELlF1YXRlcm5pb25bMF0udG9FdWxlckFuZ2xlc1RvUmVmKHYpLCh0aGlzLmJpbGxib2FyZE1vZGUmSi5CSUxMQk9BUkRNT0RFX1gpIT09Si5CSUxMQk9BUkRNT0RFX1gmJih2Lng9MCksKHRoaXMuYmlsbGJvYXJkTW9kZSZKLkJJTExCT0FSRE1PREVfWSkhPT1KLkJJTExCT0FSRE1PREVfWSYmKHYueT0wKSwodGhpcy5iaWxsYm9hcmRNb2RlJkouQklMTEJPQVJETU9ERV9aKSE9PUouQklMTEJPQVJETU9ERV9aJiYodi56PTApLHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih2Lnksdi54LHYueixELk1hdHJpeFswXSl9ZWxzZSB4LkZyb21RdWF0ZXJuaW9uVG9SZWYoRC5RdWF0ZXJuaW9uWzBdLEQuTWF0cml4WzBdKTt0aGlzLl93b3JsZE1hdHJpeC5zZXRUcmFuc2xhdGlvbkZyb21GbG9hdHMoMCwwLDApLHRoaXMuX3dvcmxkTWF0cml4Lm11bHRpcGx5VG9SZWYoRC5NYXRyaXhbMF0sdGhpcy5fd29ybGRNYXRyaXgpLHRoaXMuX3dvcmxkTWF0cml4LnNldFRyYW5zbGF0aW9uKEQuVmVjdG9yM1swXSl9cmV0dXJuIHRoaXMuaWdub3JlTm9uVW5pZm9ybVNjYWxpbmc/dGhpcy5fdXBkYXRlTm9uVW5pZm9ybVNjYWxpbmdTdGF0ZSghMSk6dGhpcy5fc2NhbGluZy5pc05vblVuaWZvcm1XaXRoaW5FcHNpbG9uKDFlLTYpP3RoaXMuX3VwZGF0ZU5vblVuaWZvcm1TY2FsaW5nU3RhdGUoITApOmEmJmEuX25vblVuaWZvcm1TY2FsaW5nP3RoaXMuX3VwZGF0ZU5vblVuaWZvcm1TY2FsaW5nU3RhdGUoYS5fbm9uVW5pZm9ybVNjYWxpbmcpOnRoaXMuX3VwZGF0ZU5vblVuaWZvcm1TY2FsaW5nU3RhdGUoITEpLHRoaXMuX2FmdGVyQ29tcHV0ZVdvcmxkTWF0cml4KCksdGhpcy5fYWJzb2x1dGVQb3NpdGlvbi5jb3B5RnJvbUZsb2F0cyh0aGlzLl93b3JsZE1hdHJpeC5tWzEyXSx0aGlzLl93b3JsZE1hdHJpeC5tWzEzXSx0aGlzLl93b3JsZE1hdHJpeC5tWzE0XSksdGhpcy5faXNBYnNvbHV0ZVN5bmNlZD0hMSx0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMuX3Bvc2VNYXRyaXh8fCh0aGlzLl9wb3NlTWF0cml4PXguSW52ZXJ0KHRoaXMuX3dvcmxkTWF0cml4KSksdGhpcy5fd29ybGRNYXRyaXhEZXRlcm1pbmFudElzRGlydHk9ITAsdGhpcy5fd29ybGRNYXRyaXh9cmVzZXRMb2NhbE1hdHJpeChlPSEwKXtpZih0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpLGUpe2NvbnN0IHQ9dGhpcy5nZXRDaGlsZHJlbigpO2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7KytpKXtjb25zdCBzPXRbaV07aWYocyl7cy5jb21wdXRlV29ybGRNYXRyaXgoKTtjb25zdCByPUQuTWF0cml4WzBdO3MuX2xvY2FsTWF0cml4Lm11bHRpcGx5VG9SZWYodGhpcy5fbG9jYWxNYXRyaXgscik7Y29uc3Qgbj1ELlF1YXRlcm5pb25bMF07ci5kZWNvbXBvc2Uocy5zY2FsaW5nLG4scy5wb3NpdGlvbikscy5yb3RhdGlvblF1YXRlcm5pb24/cy5yb3RhdGlvblF1YXRlcm5pb24uY29weUZyb20obik6bi50b0V1bGVyQW5nbGVzVG9SZWYocy5yb3RhdGlvbil9fX10aGlzLnNjYWxpbmcuY29weUZyb21GbG9hdHMoMSwxLDEpLHRoaXMucG9zaXRpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMucm90YXRpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb249Wi5JZGVudGl0eSgpKSx0aGlzLl93b3JsZE1hdHJpeD14LklkZW50aXR5KCl9X2FmdGVyQ29tcHV0ZVdvcmxkTWF0cml4KCl7fXJlZ2lzdGVyQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZShlKXtyZXR1cm4gdGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmFkZChlKSx0aGlzfXVucmVnaXN0ZXJBZnRlcldvcmxkTWF0cml4VXBkYXRlKGUpe3JldHVybiB0aGlzLm9uQWZ0ZXJXb3JsZE1hdHJpeFVwZGF0ZU9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSksdGhpc31nZXRQb3NpdGlvbkluQ2FtZXJhU3BhY2UoZT1udWxsKXtyZXR1cm4gZXx8KGU9dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYSkscC5UcmFuc2Zvcm1Db29yZGluYXRlcyh0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKSxlLmdldFZpZXdNYXRyaXgoKSl9Z2V0RGlzdGFuY2VUb0NhbWVyYShlPW51bGwpe3JldHVybiBlfHwoZT10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhKSx0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKS5zdWJ0cmFjdChlLmdsb2JhbFBvc2l0aW9uKS5sZW5ndGgoKX1jbG9uZShlLHQsaSl7Y29uc3Qgcz1hZS5DbG9uZSgoKT0+bmV3IEooZSx0aGlzLmdldFNjZW5lKCkpLHRoaXMpO2lmKHMubmFtZT1lLHMuaWQ9ZSx0JiYocy5wYXJlbnQ9dCksIWkpe2NvbnN0IHI9dGhpcy5nZXREZXNjZW5kYW50cyghMCk7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspe2NvbnN0IGE9cltuXTthLmNsb25lJiZhLmNsb25lKGUrIi4iK2EubmFtZSxzKX19cmV0dXJuIHN9c2VyaWFsaXplKGUpe2NvbnN0IHQ9YWUuU2VyaWFsaXplKHRoaXMsZSk7cmV0dXJuIHQudHlwZT10aGlzLmdldENsYXNzTmFtZSgpLHQudW5pcXVlSWQ9dGhpcy51bmlxdWVJZCx0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuX3NlcmlhbGl6ZUFzUGFyZW50KHQpLHQubG9jYWxNYXRyaXg9dGhpcy5nZXRQaXZvdE1hdHJpeCgpLmFzQXJyYXkoKSx0LmlzRW5hYmxlZD10aGlzLmlzRW5hYmxlZCgpLHR9c3RhdGljIFBhcnNlKGUsdCxpKXtjb25zdCBzPWFlLlBhcnNlKCgpPT5uZXcgSihlLm5hbWUsdCksZSx0LGkpO3JldHVybiBlLmxvY2FsTWF0cml4P3Muc2V0UHJlVHJhbnNmb3JtTWF0cml4KHguRnJvbUFycmF5KGUubG9jYWxNYXRyaXgpKTplLnBpdm90TWF0cml4JiZzLnNldFBpdm90TWF0cml4KHguRnJvbUFycmF5KGUucGl2b3RNYXRyaXgpKSxzLnNldEVuYWJsZWQoZS5pc0VuYWJsZWQpLHMuX3dhaXRpbmdQYXJzZWRVbmlxdWVJZD1lLnVuaXF1ZUlkLGUucGFyZW50SWQhPT12b2lkIDAmJihzLl93YWl0aW5nUGFyZW50SWQ9ZS5wYXJlbnRJZCksZS5wYXJlbnRJbnN0YW5jZUluZGV4IT09dm9pZCAwJiYocy5fd2FpdGluZ1BhcmVudEluc3RhbmNlSW5kZXg9ZS5wYXJlbnRJbnN0YW5jZUluZGV4KSxzfWdldENoaWxkVHJhbnNmb3JtTm9kZXMoZSx0KXtjb25zdCBpPVtdO3JldHVybiB0aGlzLl9nZXREZXNjZW5kYW50cyhpLGUscz0+KCF0fHx0KHMpKSYmcyBpbnN0YW5jZW9mIEopLGl9ZGlzcG9zZShlLHQ9ITEpe2lmKHRoaXMuZ2V0U2NlbmUoKS5zdG9wQW5pbWF0aW9uKHRoaXMpLHRoaXMuZ2V0U2NlbmUoKS5yZW1vdmVUcmFuc2Zvcm1Ob2RlKHRoaXMpLHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3QgaT10aGlzLl9wYXJlbnRDb250YWluZXIudHJhbnNmb3JtTm9kZXMuaW5kZXhPZih0aGlzKTtpPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIudHJhbnNmb3JtTm9kZXMuc3BsaWNlKGksMSksdGhpcy5fcGFyZW50Q29udGFpbmVyPW51bGx9aWYodGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmNsZWFyKCksZSl7Y29uc3QgaT10aGlzLmdldENoaWxkVHJhbnNmb3JtTm9kZXMoITApO2Zvcihjb25zdCBzIG9mIGkpcy5wYXJlbnQ9bnVsbCxzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCl9c3VwZXIuZGlzcG9zZShlLHQpfW5vcm1hbGl6ZVRvVW5pdEN1YmUoZT0hMCx0PSExLGkpe2xldCBzPW51bGwscj1udWxsO3QmJih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj8ocj10aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jbG9uZSgpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tRmxvYXRzKDAsMCwwLDEpKTp0aGlzLnJvdGF0aW9uJiYocz10aGlzLnJvdGF0aW9uLmNsb25lKCksdGhpcy5yb3RhdGlvbi5jb3B5RnJvbUZsb2F0cygwLDAsMCkpKTtjb25zdCBuPXRoaXMuZ2V0SGllcmFyY2h5Qm91bmRpbmdWZWN0b3JzKGUsaSksYT1uLm1heC5zdWJ0cmFjdChuLm1pbiksbz1NYXRoLm1heChhLngsYS55LGEueik7aWYobz09PTApcmV0dXJuIHRoaXM7Y29uc3QgaD0xL287cmV0dXJuIHRoaXMuc2NhbGluZy5zY2FsZUluUGxhY2UoaCksdCYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZyP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tKHIpOnRoaXMucm90YXRpb24mJnMmJnRoaXMucm90YXRpb24uY29weUZyb20ocykpLHRoaXN9X3N5bmNBYnNvbHV0ZVNjYWxpbmdBbmRSb3RhdGlvbigpe3RoaXMuX2lzQWJzb2x1dGVTeW5jZWR8fCh0aGlzLl93b3JsZE1hdHJpeC5kZWNvbXBvc2UodGhpcy5fYWJzb2x1dGVTY2FsaW5nLHRoaXMuX2Fic29sdXRlUm90YXRpb25RdWF0ZXJuaW9uKSx0aGlzLl9pc0Fic29sdXRlU3luY2VkPSEwKX19Si5CSUxMQk9BUkRNT0RFX05PTkU9MCxKLkJJTExCT0FSRE1PREVfWD0xLEouQklMTEJPQVJETU9ERV9ZPTIsSi5CSUxMQk9BUkRNT0RFX1o9NCxKLkJJTExCT0FSRE1PREVfQUxMPTcsSi5CSUxMQk9BUkRNT0RFX1VTRV9QT1NJVElPTj0xMjgsSi5CaWxsYm9hcmRVc2VQYXJlbnRPcmllbnRhdGlvbj0hMSxKLl9UbXBSb3RhdGlvbj1aLlplcm8oKSxKLl9UbXBTY2FsaW5nPXAuWmVybygpLEouX1RtcFRyYW5zbGF0aW9uPXAuWmVybygpLEouX0xvb2tBdFZlY3RvckNhY2hlPW5ldyBwKDAsMCwwKSxKLl9Sb3RhdGlvbkF4aXNDYWNoZT1uZXcgWixUKFtCdCgicG9zaXRpb24iKV0sSi5wcm90b3R5cGUsIl9wb3NpdGlvbiIsdm9pZCAwKSxUKFtCdCgicm90YXRpb24iKV0sSi5wcm90b3R5cGUsIl9yb3RhdGlvbiIsdm9pZCAwKSxUKFtSbigicm90YXRpb25RdWF0ZXJuaW9uIildLEoucHJvdG90eXBlLCJfcm90YXRpb25RdWF0ZXJuaW9uIix2b2lkIDApLFQoW0J0KCJzY2FsaW5nIildLEoucHJvdG90eXBlLCJfc2NhbGluZyIsdm9pZCAwKSxUKFtSKCJiaWxsYm9hcmRNb2RlIildLEoucHJvdG90eXBlLCJfYmlsbGJvYXJkTW9kZSIsdm9pZCAwKSxUKFtSKCldLEoucHJvdG90eXBlLCJzY2FsaW5nRGV0ZXJtaW5hbnQiLHZvaWQgMCksVChbUigiaW5maW5pdGVEaXN0YW5jZSIpXSxKLnByb3RvdHlwZSwiX2luZmluaXRlRGlzdGFuY2UiLHZvaWQgMCksVChbUigpXSxKLnByb3RvdHlwZSwiaWdub3JlTm9uVW5pZm9ybVNjYWxpbmciLHZvaWQgMCksVChbUigpXSxKLnByb3RvdHlwZSwicmVJbnRlZ3JhdGVSb3RhdGlvbkludG9Sb3RhdGlvblF1YXRlcm5pb24iLHZvaWQgMCk7Y2xhc3MgVW57Y29uc3RydWN0b3IoKXt0aGlzLl9jaGVja0NvbGxpc2lvbnM9ITEsdGhpcy5fY29sbGlzaW9uTWFzaz0tMSx0aGlzLl9jb2xsaXNpb25Hcm91cD0tMSx0aGlzLl9zdXJyb3VuZGluZ01lc2hlcz1udWxsLHRoaXMuX2NvbGxpZGVyPW51bGwsdGhpcy5fb2xkUG9zaXRpb25Gb3JDb2xsaXNpb25zPW5ldyBwKDAsMCwwKSx0aGlzLl9kaWZmUG9zaXRpb25Gb3JDb2xsaXNpb25zPW5ldyBwKDAsMCwwKSx0aGlzLl9jb2xsaXNpb25SZXNwb25zZT0hMH19Y2xhc3Mga257Y29uc3RydWN0b3IoKXt0aGlzLmZhY2V0TmI9MCx0aGlzLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9ucz0xMCx0aGlzLnBhcnRpdGlvbmluZ0JCb3hSYXRpbz0xLjAxLHRoaXMuZmFjZXREYXRhRW5hYmxlZD0hMSx0aGlzLmZhY2V0UGFyYW1ldGVycz17fSx0aGlzLmJiU2l6ZT1wLlplcm8oKSx0aGlzLnN1YkRpdj17bWF4OjEsWDoxLFk6MSxaOjF9LHRoaXMuZmFjZXREZXB0aFNvcnQ9ITEsdGhpcy5mYWNldERlcHRoU29ydEVuYWJsZWQ9ITF9fWNsYXNzIFZue2NvbnN0cnVjdG9yKCl7dGhpcy5faGFzVmVydGV4QWxwaGE9ITEsdGhpcy5fdXNlVmVydGV4Q29sb3JzPSEwLHRoaXMuX251bUJvbmVJbmZsdWVuY2Vycz00LHRoaXMuX2FwcGx5Rm9nPSEwLHRoaXMuX3JlY2VpdmVTaGFkb3dzPSExLHRoaXMuX2ZhY2V0RGF0YT1uZXcga24sdGhpcy5fdmlzaWJpbGl0eT0xLHRoaXMuX3NrZWxldG9uPW51bGwsdGhpcy5fbGF5ZXJNYXNrPTI2ODQzNTQ1NSx0aGlzLl9jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM9ITAsdGhpcy5faXNBY3RpdmU9ITEsdGhpcy5fb25seUZvckluc3RhbmNlcz0hMSx0aGlzLl9pc0FjdGl2ZUludGVybWVkaWF0ZT0hMSx0aGlzLl9vbmx5Rm9ySW5zdGFuY2VzSW50ZXJtZWRpYXRlPSExLHRoaXMuX2FjdEFzUmVndWxhck1lc2g9ITEsdGhpcy5fY3VycmVudExPRD1udWxsLHRoaXMuX2N1cnJlbnRMT0RJc1VwVG9EYXRlPSExLHRoaXMuX2NvbGxpc2lvblJldHJ5Q291bnQ9Myx0aGlzLl9tb3JwaFRhcmdldE1hbmFnZXI9bnVsbCx0aGlzLl9yZW5kZXJpbmdHcm91cElkPTAsdGhpcy5fYmFrZWRWZXJ0ZXhBbmltYXRpb25NYW5hZ2VyPW51bGwsdGhpcy5fbWF0ZXJpYWw9bnVsbCx0aGlzLl9wb3NpdGlvbnM9bnVsbCx0aGlzLl9wb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZz0hMSx0aGlzLl9tZXNoQ29sbGlzaW9uRGF0YT1uZXcgVW4sdGhpcy5fZW5hYmxlRGlzdGFudFBpY2tpbmc9ITF9fWNsYXNzIG90IGV4dGVuZHMgSntjb25zdHJ1Y3RvcihlLHQ9bnVsbCl7c3dpdGNoKHN1cGVyKGUsdCwhMSksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mbz1uZXcgVm4sdGhpcy5fd2FpdGluZ01hdGVyaWFsSWQ9bnVsbCx0aGlzLmN1bGxpbmdTdHJhdGVneT1vdC5DVUxMSU5HU1RSQVRFR1lfQk9VTkRJTkdTUEhFUkVfT05MWSx0aGlzLm9uQ29sbGlkZU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTWF0ZXJpYWxDaGFuZ2VkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLmRlZmluZWRGYWNpbmdGb3J3YXJkPSEwLHRoaXMuX29jY2x1c2lvblF1ZXJ5PW51bGwsdGhpcy5fcmVuZGVyaW5nR3JvdXA9bnVsbCx0aGlzLmFscGhhSW5kZXg9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLmlzVmlzaWJsZT0hMCx0aGlzLmlzUGlja2FibGU9ITAsdGhpcy5pc05lYXJQaWNrYWJsZT0hMSx0aGlzLmlzTmVhckdyYWJiYWJsZT0hMSx0aGlzLnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveD0hMSx0aGlzLmlzQmxvY2tlcj0hMSx0aGlzLmVuYWJsZVBvaW50ZXJNb3ZlRXZlbnRzPSExLHRoaXMub3V0bGluZUNvbG9yPXJlLlJlZCgpLHRoaXMub3V0bGluZVdpZHRoPS4wMix0aGlzLm92ZXJsYXlDb2xvcj1yZS5SZWQoKSx0aGlzLm92ZXJsYXlBbHBoYT0uNSx0aGlzLnVzZU9jdHJlZUZvclJlbmRlcmluZ1NlbGVjdGlvbj0hMCx0aGlzLnVzZU9jdHJlZUZvclBpY2tpbmc9ITAsdGhpcy51c2VPY3RyZWVGb3JDb2xsaXNpb25zPSEwLHRoaXMuYWx3YXlzU2VsZWN0QXNBY3RpdmVNZXNoPSExLHRoaXMuZG9Ob3RTeW5jQm91bmRpbmdJbmZvPSExLHRoaXMuYWN0aW9uTWFuYWdlcj1udWxsLHRoaXMuZWxsaXBzb2lkPW5ldyBwKC41LDEsLjUpLHRoaXMuZWxsaXBzb2lkT2Zmc2V0PW5ldyBwKDAsMCwwKSx0aGlzLmVkZ2VzV2lkdGg9MSx0aGlzLmVkZ2VzQ29sb3I9bmV3IG1lKDEsMCwwLDEpLHRoaXMuX2VkZ2VzUmVuZGVyZXI9bnVsbCx0aGlzLl9tYXN0ZXJNZXNoPW51bGwsdGhpcy5fYm91bmRpbmdJbmZvPW51bGwsdGhpcy5fYm91bmRpbmdJbmZvSXNEaXJ0eT0hMCx0aGlzLl9yZW5kZXJJZD0wLHRoaXMuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzPW5ldyBBcnJheSx0aGlzLl91bkluZGV4ZWQ9ITEsdGhpcy5fbGlnaHRTb3VyY2VzPW5ldyBBcnJheSx0aGlzLl93YWl0aW5nRGF0YT17bG9kczpudWxsLGFjdGlvbnM6bnVsbCxmcmVlemVXb3JsZE1hdHJpeDpudWxsfSx0aGlzLl9ib25lc1RyYW5zZm9ybU1hdHJpY2VzPW51bGwsdGhpcy5fdHJhbnNmb3JtTWF0cml4VGV4dHVyZT1udWxsLHRoaXMub25SZWJ1aWxkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlPShpLHMscj1udWxsKT0+e3Muc3VidHJhY3RUb1JlZih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fb2xkUG9zaXRpb25Gb3JDb2xsaXNpb25zLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9kaWZmUG9zaXRpb25Gb3JDb2xsaXNpb25zKSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fZGlmZlBvc2l0aW9uRm9yQ29sbGlzaW9ucy5sZW5ndGgoKT5JLkNvbGxpc2lvbnNFcHNpbG9uJiZ0aGlzLnBvc2l0aW9uLmFkZEluUGxhY2UodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2RpZmZQb3NpdGlvbkZvckNvbGxpc2lvbnMpLHImJnRoaXMub25Db2xsaWRlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMociksdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcy5wb3NpdGlvbil9LHQ9dGhpcy5nZXRTY2VuZSgpLHQuYWRkTWVzaCh0aGlzKSx0aGlzLl9yZXN5bmNMaWdodFNvdXJjZXMoKSx0aGlzLl91bmlmb3JtQnVmZmVyPW5ldyBWKHRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKSx2b2lkIDAsdm9pZCAwLGUsIXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5pc1dlYkdQVSksdGhpcy5fYnVpbGRVbmlmb3JtTGF5b3V0KCksdC5wZXJmb3JtYW5jZVByaW9yaXR5KXtjYXNlIEN0LkFnZ3Jlc3NpdmU6dGhpcy5kb05vdFN5bmNCb3VuZGluZ0luZm89ITA7Y2FzZSBDdC5JbnRlcm1lZGlhdGU6dGhpcy5hbHdheXNTZWxlY3RBc0FjdGl2ZU1lc2g9ITAsdGhpcy5pc1BpY2thYmxlPSExO2JyZWFrfX1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfTk9ORSgpe3JldHVybiBKLkJJTExCT0FSRE1PREVfTk9ORX1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfWCgpe3JldHVybiBKLkJJTExCT0FSRE1PREVfWH1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfWSgpe3JldHVybiBKLkJJTExCT0FSRE1PREVfWX1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfWigpe3JldHVybiBKLkJJTExCT0FSRE1PREVfWn1zdGF0aWMgZ2V0IEJJTExCT0FSRE1PREVfQUxMKCl7cmV0dXJuIEouQklMTEJPQVJETU9ERV9BTEx9c3RhdGljIGdldCBCSUxMQk9BUkRNT0RFX1VTRV9QT1NJVElPTigpe3JldHVybiBKLkJJTExCT0FSRE1PREVfVVNFX1BPU0lUSU9OfWdldCBmYWNldE5iKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldE5ifWdldCBwYXJ0aXRpb25pbmdTdWJkaXZpc2lvbnMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9uc31zZXQgcGFydGl0aW9uaW5nU3ViZGl2aXNpb25zKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5wYXJ0aXRpb25pbmdTdWJkaXZpc2lvbnM9ZX1nZXQgcGFydGl0aW9uaW5nQkJveFJhdGlvKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5wYXJ0aXRpb25pbmdCQm94UmF0aW99c2V0IHBhcnRpdGlvbmluZ0JCb3hSYXRpbyhlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGEucGFydGl0aW9uaW5nQkJveFJhdGlvPWV9Z2V0IG11c3REZXB0aFNvcnRGYWNldHMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhLmZhY2V0RGVwdGhTb3J0fXNldCBtdXN0RGVwdGhTb3J0RmFjZXRzKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldERlcHRoU29ydD1lfWdldCBmYWNldERlcHRoU29ydEZyb20oKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhLmZhY2V0RGVwdGhTb3J0RnJvbX1zZXQgZmFjZXREZXB0aFNvcnRGcm9tKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldERlcHRoU29ydEZyb209ZX1nZXQgY29sbGlzaW9uUmV0cnlDb3VudCgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9jb2xsaXNpb25SZXRyeUNvdW50fXNldCBjb2xsaXNpb25SZXRyeUNvdW50KGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbGxpc2lvblJldHJ5Q291bnQ9ZX1nZXQgaXNGYWNldERhdGFFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldERhdGFFbmFibGVkfWdldCBtb3JwaFRhcmdldE1hbmFnZXIoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbW9ycGhUYXJnZXRNYW5hZ2VyfXNldCBtb3JwaFRhcmdldE1hbmFnZXIoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbW9ycGhUYXJnZXRNYW5hZ2VyIT09ZSYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21vcnBoVGFyZ2V0TWFuYWdlcj1lLHRoaXMuX3N5bmNHZW9tZXRyeVdpdGhNb3JwaFRhcmdldE1hbmFnZXIoKSl9Z2V0IGJha2VkVmVydGV4QW5pbWF0aW9uTWFuYWdlcigpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9iYWtlZFZlcnRleEFuaW1hdGlvbk1hbmFnZXJ9c2V0IGJha2VkVmVydGV4QW5pbWF0aW9uTWFuYWdlcihlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9iYWtlZFZlcnRleEFuaW1hdGlvbk1hbmFnZXIhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fYmFrZWRWZXJ0ZXhBbmltYXRpb25NYW5hZ2VyPWUsdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCkpfV9zeW5jR2VvbWV0cnlXaXRoTW9ycGhUYXJnZXRNYW5hZ2VyKCl7fV91cGRhdGVOb25Vbmlmb3JtU2NhbGluZ1N0YXRlKGUpe3JldHVybiBzdXBlci5fdXBkYXRlTm9uVW5pZm9ybVNjYWxpbmdTdGF0ZShlKT8odGhpcy5fbWFya1N1Yk1lc2hlc0FzTWlzY0RpcnR5KCksITApOiExfXNldCBvbkNvbGxpZGUoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlkZU9ic2VydmVyJiZ0aGlzLm9uQ29sbGlkZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9vbkNvbGxpZGVPYnNlcnZlciksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlkZU9ic2VydmVyPXRoaXMub25Db2xsaWRlT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IG9uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2UoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlciYmdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlciksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX29uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZlcj10aGlzLm9uQ29sbGlzaW9uUG9zaXRpb25DaGFuZ2VPYnNlcnZhYmxlLmFkZChlKX1nZXQgdmlzaWJpbGl0eSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl92aXNpYmlsaXR5fXNldCB2aXNpYmlsaXR5KGUpe2lmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Zpc2liaWxpdHk9PT1lKXJldHVybjtjb25zdCB0PXRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Zpc2liaWxpdHk7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fdmlzaWJpbGl0eT1lLCh0PT09MSYmZSE9PTF8fHQhPT0xJiZlPT09MSkmJnRoaXMuX21hcmtTdWJNZXNoZXNBc01pc2NEaXJ0eSgpfWdldCBwb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb2ludGVyT3ZlckRpc2FibGVNZXNoVGVzdGluZ31zZXQgcG9pbnRlck92ZXJEaXNhYmxlTWVzaFRlc3RpbmcoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcG9pbnRlck92ZXJEaXNhYmxlTWVzaFRlc3Rpbmc9ZX1nZXQgcmVuZGVyaW5nR3JvdXBJZCgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9yZW5kZXJpbmdHcm91cElkfXNldCByZW5kZXJpbmdHcm91cElkKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3JlbmRlcmluZ0dyb3VwSWQ9ZX1nZXQgbWF0ZXJpYWwoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWx9c2V0IG1hdGVyaWFsKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsIT09ZSYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsJiZ0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbC5tZXNoTWFwJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWwubWVzaE1hcFt0aGlzLnVuaXF1ZUlkXT12b2lkIDApLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsPWUsZSYmZS5tZXNoTWFwJiYoZS5tZXNoTWFwW3RoaXMudW5pcXVlSWRdPXRoaXMpLHRoaXMub25NYXRlcmlhbENoYW5nZWRPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZ0aGlzLm9uTWF0ZXJpYWxDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5zdWJNZXNoZXMmJih0aGlzLnJlc2V0RHJhd0NhY2hlKCksdGhpcy5fdW5CaW5kRWZmZWN0KCkpKX1nZXRNYXRlcmlhbEZvclJlbmRlclBhc3MoZSl7dmFyIHQ7cmV0dXJuKHQ9dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWxGb3JSZW5kZXJQYXNzKT09PW51bGx8fHQ9PT12b2lkIDA/dm9pZCAwOnRbZV19c2V0TWF0ZXJpYWxGb3JSZW5kZXJQYXNzKGUsdCl7dGhpcy5yZXNldERyYXdDYWNoZShlKSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbEZvclJlbmRlclBhc3N8fCh0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbEZvclJlbmRlclBhc3M9W10pLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsRm9yUmVuZGVyUGFzc1tlXT10fWdldCByZWNlaXZlU2hhZG93cygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9yZWNlaXZlU2hhZG93c31zZXQgcmVjZWl2ZVNoYWRvd3MoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcmVjZWl2ZVNoYWRvd3MhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcmVjZWl2ZVNoYWRvd3M9ZSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KCkpfWdldCBoYXNWZXJ0ZXhBbHBoYSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9oYXNWZXJ0ZXhBbHBoYX1zZXQgaGFzVmVydGV4QWxwaGEoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faGFzVmVydGV4QWxwaGEhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faGFzVmVydGV4QWxwaGE9ZSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNBdHRyaWJ1dGVzRGlydHkoKSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNNaXNjRGlydHkoKSl9Z2V0IHVzZVZlcnRleENvbG9ycygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl91c2VWZXJ0ZXhDb2xvcnN9c2V0IHVzZVZlcnRleENvbG9ycyhlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl91c2VWZXJ0ZXhDb2xvcnMhPT1lJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fdXNlVmVydGV4Q29sb3JzPWUsdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCkpfWdldCBjb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzfXNldCBjb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzIT09ZSYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVycz1lLHRoaXMuX21hcmtTdWJNZXNoZXNBc0F0dHJpYnV0ZXNEaXJ0eSgpKX1nZXQgbnVtQm9uZUluZmx1ZW5jZXJzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX251bUJvbmVJbmZsdWVuY2Vyc31zZXQgbnVtQm9uZUluZmx1ZW5jZXJzKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX251bUJvbmVJbmZsdWVuY2VycyE9PWUmJih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9udW1Cb25lSW5mbHVlbmNlcnM9ZSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNBdHRyaWJ1dGVzRGlydHkoKSl9Z2V0IGFwcGx5Rm9nKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FwcGx5Rm9nfXNldCBhcHBseUZvZyhlKXt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hcHBseUZvZyE9PWUmJih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hcHBseUZvZz1lLHRoaXMuX21hcmtTdWJNZXNoZXNBc01pc2NEaXJ0eSgpKX1nZXQgZW5hYmxlRGlzdGFudFBpY2tpbmcoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZW5hYmxlRGlzdGFudFBpY2tpbmd9c2V0IGVuYWJsZURpc3RhbnRQaWNraW5nKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2VuYWJsZURpc3RhbnRQaWNraW5nPWV9Z2V0IGxheWVyTWFzaygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9sYXllck1hc2t9c2V0IGxheWVyTWFzayhlKXtlIT09dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbGF5ZXJNYXNrJiYodGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbGF5ZXJNYXNrPWUsdGhpcy5fcmVzeW5jTGlnaHRTb3VyY2VzKCkpfWdldCBjb2xsaXNpb25NYXNrKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25NYXNrfXNldCBjb2xsaXNpb25NYXNrKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25NYXNrPWlzTmFOKGUpPy0xOmV9Z2V0IGNvbGxpc2lvblJlc3BvbnNlKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25SZXNwb25zZX1zZXQgY29sbGlzaW9uUmVzcG9uc2UoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2NvbGxpc2lvblJlc3BvbnNlPWV9Z2V0IGNvbGxpc2lvbkdyb3VwKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9jb2xsaXNpb25Hcm91cH1zZXQgY29sbGlzaW9uR3JvdXAoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2NvbGxpc2lvbkdyb3VwPWlzTmFOKGUpPy0xOmV9Z2V0IHN1cnJvdW5kaW5nTWVzaGVzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9zdXJyb3VuZGluZ01lc2hlc31zZXQgc3Vycm91bmRpbmdNZXNoZXMoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX3N1cnJvdW5kaW5nTWVzaGVzPWV9Z2V0IGxpZ2h0U291cmNlcygpe3JldHVybiB0aGlzLl9saWdodFNvdXJjZXN9Z2V0IF9wb3NpdGlvbnMoKXtyZXR1cm4gbnVsbH1zZXQgc2tlbGV0b24oZSl7Y29uc3QgdD10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9za2VsZXRvbjt0JiZ0Lm5lZWRJbml0aWFsU2tpbk1hdHJpeCYmdC5fdW5yZWdpc3Rlck1lc2hXaXRoUG9zZU1hdHJpeCh0aGlzKSxlJiZlLm5lZWRJbml0aWFsU2tpbk1hdHJpeCYmZS5fcmVnaXN0ZXJNZXNoV2l0aFBvc2VNYXRyaXgodGhpcyksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fc2tlbGV0b249ZSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9za2VsZXRvbnx8KHRoaXMuX2JvbmVzVHJhbnNmb3JtTWF0cmljZXM9bnVsbCksdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl9Z2V0IHNrZWxldG9uKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3NrZWxldG9ufV9idWlsZFVuaWZvcm1MYXlvdXQoKXt0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oIndvcmxkIiwxNiksdGhpcy5fdW5pZm9ybUJ1ZmZlci5hZGRVbmlmb3JtKCJ2aXNpYmlsaXR5IiwxKSx0aGlzLl91bmlmb3JtQnVmZmVyLmNyZWF0ZSgpfXRyYW5zZmVyVG9FZmZlY3QoZSl7Y29uc3QgdD10aGlzLl91bmlmb3JtQnVmZmVyO3QudXBkYXRlTWF0cml4KCJ3b3JsZCIsZSksdC51cGRhdGVGbG9hdCgidmlzaWJpbGl0eSIsdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fdmlzaWJpbGl0eSksdC51cGRhdGUoKX1nZXRNZXNoVW5pZm9ybUJ1ZmZlcigpe3JldHVybiB0aGlzLl91bmlmb3JtQnVmZmVyfWdldENsYXNzTmFtZSgpe3JldHVybiJBYnN0cmFjdE1lc2gifXRvU3RyaW5nKGUpe2xldCB0PSJOYW1lOiAiK3RoaXMubmFtZSsiLCBpc0luc3RhbmNlOiAiKyh0aGlzLmdldENsYXNzTmFtZSgpIT09Ikluc3RhbmNlZE1lc2giPyJZRVMiOiJOTyIpO3QrPSIsICMgb2Ygc3VibWVzaGVzOiAiKyh0aGlzLnN1Yk1lc2hlcz90aGlzLnN1Yk1lc2hlcy5sZW5ndGg6MCk7Y29uc3QgaT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9za2VsZXRvbjtyZXR1cm4gaSYmKHQrPSIsIHNrZWxldG9uOiAiK2kubmFtZSksZSYmKHQrPSIsIGJpbGxib2FyZCBtb2RlOiAiK1siTk9ORSIsIlgiLCJZIixudWxsLCJaIixudWxsLG51bGwsIkFMTCJdW3RoaXMuYmlsbGJvYXJkTW9kZV0sdCs9IiwgZnJlZXplIHdybGQgbWF0OiAiKyh0aGlzLl9pc1dvcmxkTWF0cml4RnJvemVufHx0aGlzLl93YWl0aW5nRGF0YS5mcmVlemVXb3JsZE1hdHJpeD8iWUVTIjoiTk8iKSksdH1fZ2V0RWZmZWN0aXZlUGFyZW50KCl7cmV0dXJuIHRoaXMuX21hc3Rlck1lc2gmJnRoaXMuYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FP3RoaXMuX21hc3Rlck1lc2g6c3VwZXIuX2dldEVmZmVjdGl2ZVBhcmVudCgpfV9nZXRBY3Rpb25NYW5hZ2VyRm9yVHJpZ2dlcihlLHQ9ITApe2lmKHRoaXMuYWN0aW9uTWFuYWdlciYmKHR8fHRoaXMuYWN0aW9uTWFuYWdlci5pc1JlY3Vyc2l2ZSkpaWYoZSl7aWYodGhpcy5hY3Rpb25NYW5hZ2VyLmhhc1NwZWNpZmljVHJpZ2dlcihlKSlyZXR1cm4gdGhpcy5hY3Rpb25NYW5hZ2VyfWVsc2UgcmV0dXJuIHRoaXMuYWN0aW9uTWFuYWdlcjtyZXR1cm4gdGhpcy5wYXJlbnQ/dGhpcy5wYXJlbnQuX2dldEFjdGlvbk1hbmFnZXJGb3JUcmlnZ2VyKGUsITEpOm51bGx9X3JlYnVpbGQoZT0hMSl7aWYodGhpcy5vblJlYnVpbGRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSx0aGlzLl9vY2NsdXNpb25RdWVyeSE9PW51bGwmJih0aGlzLl9vY2NsdXNpb25RdWVyeT1udWxsKSwhIXRoaXMuc3ViTWVzaGVzKWZvcihjb25zdCB0IG9mIHRoaXMuc3ViTWVzaGVzKXQuX3JlYnVpbGQoKX1fcmVzeW5jTGlnaHRTb3VyY2VzKCl7dGhpcy5fbGlnaHRTb3VyY2VzLmxlbmd0aD0wO2Zvcihjb25zdCBlIG9mIHRoaXMuZ2V0U2NlbmUoKS5saWdodHMpZS5pc0VuYWJsZWQoKSYmZS5jYW5BZmZlY3RNZXNoKHRoaXMpJiZ0aGlzLl9saWdodFNvdXJjZXMucHVzaChlKTt0aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KCl9X3Jlc3luY0xpZ2h0U291cmNlKGUpe2NvbnN0IHQ9ZS5pc0VuYWJsZWQoKSYmZS5jYW5BZmZlY3RNZXNoKHRoaXMpLGk9dGhpcy5fbGlnaHRTb3VyY2VzLmluZGV4T2YoZSk7bGV0IHM9ITE7aWYoaT09PS0xKXtpZighdClyZXR1cm47dGhpcy5fbGlnaHRTb3VyY2VzLnB1c2goZSl9ZWxzZXtpZih0KXJldHVybjtzPSEwLHRoaXMuX2xpZ2h0U291cmNlcy5zcGxpY2UoaSwxKX10aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KHMpfV91bkJpbmRFZmZlY3QoKXtmb3IoY29uc3QgZSBvZiB0aGlzLnN1Yk1lc2hlcyllLnNldEVmZmVjdChudWxsKX1fcmVtb3ZlTGlnaHRTb3VyY2UoZSx0KXtjb25zdCBpPXRoaXMuX2xpZ2h0U291cmNlcy5pbmRleE9mKGUpO2khPT0tMSYmKHRoaXMuX2xpZ2h0U291cmNlcy5zcGxpY2UoaSwxKSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNMaWdodERpcnR5KHQpKX1fbWFya1N1Yk1lc2hlc0FzRGlydHkoZSl7aWYodGhpcy5zdWJNZXNoZXMpZm9yKGNvbnN0IHQgb2YgdGhpcy5zdWJNZXNoZXMpZm9yKGxldCBpPTA7aTx0Ll9kcmF3V3JhcHBlcnMubGVuZ3RoOysraSl7Y29uc3Qgcz10Ll9kcmF3V3JhcHBlcnNbaV07IXN8fCFzLmRlZmluZXN8fCFzLmRlZmluZXMubWFya0FsbEFzRGlydHl8fGUocy5kZWZpbmVzKX19X21hcmtTdWJNZXNoZXNBc0xpZ2h0RGlydHkoZT0hMSl7dGhpcy5fbWFya1N1Yk1lc2hlc0FzRGlydHkodD0+dC5tYXJrQXNMaWdodERpcnR5KGUpKX1fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl7dGhpcy5fbWFya1N1Yk1lc2hlc0FzRGlydHkoZT0+ZS5tYXJrQXNBdHRyaWJ1dGVzRGlydHkoKSl9X21hcmtTdWJNZXNoZXNBc01pc2NEaXJ0eSgpe3RoaXMuX21hcmtTdWJNZXNoZXNBc0RpcnR5KGU9PmUubWFya0FzTWlzY0RpcnR5KCkpfW1hcmtBc0RpcnR5KGUpe3JldHVybiB0aGlzLl9jdXJyZW50UmVuZGVySWQ9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLl9pc0RpcnR5PSEwLHRoaXN9cmVzZXREcmF3Q2FjaGUoZSl7aWYodGhpcy5zdWJNZXNoZXMpZm9yKGNvbnN0IHQgb2YgdGhpcy5zdWJNZXNoZXMpdC5yZXNldERyYXdDYWNoZShlKX1nZXQgaXNCbG9ja2VkKCl7cmV0dXJuITF9Z2V0TE9EKGUpe3JldHVybiB0aGlzfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gMH1nZXRUb3RhbEluZGljZXMoKXtyZXR1cm4gMH1nZXRJbmRpY2VzKCl7cmV0dXJuIG51bGx9Z2V0VmVydGljZXNEYXRhKGUpe3JldHVybiBudWxsfXNldFZlcnRpY2VzRGF0YShlLHQsaSxzKXtyZXR1cm4gdGhpc311cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGkscyl7cmV0dXJuIHRoaXN9c2V0SW5kaWNlcyhlLHQpe3JldHVybiB0aGlzfWlzVmVydGljZXNEYXRhUHJlc2VudChlKXtyZXR1cm4hMX1nZXRCb3VuZGluZ0luZm8oKXtyZXR1cm4gdGhpcy5fbWFzdGVyTWVzaD90aGlzLl9tYXN0ZXJNZXNoLmdldEJvdW5kaW5nSW5mbygpOih0aGlzLl9ib3VuZGluZ0luZm9Jc0RpcnR5JiYodGhpcy5fYm91bmRpbmdJbmZvSXNEaXJ0eT0hMSx0aGlzLl91cGRhdGVCb3VuZGluZ0luZm8oKSksdGhpcy5fYm91bmRpbmdJbmZvKX1zZXRCb3VuZGluZ0luZm8oZSl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbz1lLHRoaXN9Z2V0IGhhc0JvdW5kaW5nSW5mbygpe3JldHVybiB0aGlzLl9ib3VuZGluZ0luZm8hPT1udWxsfWJ1aWxkQm91bmRpbmdJbmZvKGUsdCxpKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdJbmZvPW5ldyBkdChlLHQsaSksdGhpcy5fYm91bmRpbmdJbmZvfW5vcm1hbGl6ZVRvVW5pdEN1YmUoZT0hMCx0PSExLGkpe3JldHVybiBzdXBlci5ub3JtYWxpemVUb1VuaXRDdWJlKGUsdCxpKX1nZXQgdXNlQm9uZXMoKXtyZXR1cm4gdGhpcy5za2VsZXRvbiYmdGhpcy5nZXRTY2VuZSgpLnNrZWxldG9uc0VuYWJsZWQmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNJbmRpY2VzS2luZCkmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCl9X3ByZUFjdGl2YXRlKCl7fV9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZyhlKXt9X2FjdGl2YXRlKGUsdCl7cmV0dXJuIHRoaXMuX3JlbmRlcklkPWUsITB9X3Bvc3RBY3RpdmF0ZSgpe31fZnJlZXplKCl7fV91bkZyZWV6ZSgpe31nZXRXb3JsZE1hdHJpeCgpe3JldHVybiB0aGlzLl9tYXN0ZXJNZXNoJiZ0aGlzLmJpbGxib2FyZE1vZGU9PT1KLkJJTExCT0FSRE1PREVfTk9ORT90aGlzLl9tYXN0ZXJNZXNoLmdldFdvcmxkTWF0cml4KCk6c3VwZXIuZ2V0V29ybGRNYXRyaXgoKX1fZ2V0V29ybGRNYXRyaXhEZXRlcm1pbmFudCgpe3JldHVybiB0aGlzLl9tYXN0ZXJNZXNoP3RoaXMuX21hc3Rlck1lc2guX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKTpzdXBlci5fZ2V0V29ybGRNYXRyaXhEZXRlcm1pbmFudCgpfWdldCBpc0FuSW5zdGFuY2UoKXtyZXR1cm4hMX1nZXQgaGFzSW5zdGFuY2VzKCl7cmV0dXJuITF9Z2V0IGhhc1RoaW5JbnN0YW5jZXMoKXtyZXR1cm4hMX1tb3ZlUE9WKGUsdCxpKXtyZXR1cm4gdGhpcy5wb3NpdGlvbi5hZGRJblBsYWNlKHRoaXMuY2FsY01vdmVQT1YoZSx0LGkpKSx0aGlzfWNhbGNNb3ZlUE9WKGUsdCxpKXtjb25zdCBzPW5ldyB4Oyh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj90aGlzLnJvdGF0aW9uUXVhdGVybmlvbjpaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsKHRoaXMucm90YXRpb24ueSx0aGlzLnJvdGF0aW9uLngsdGhpcy5yb3RhdGlvbi56KSkudG9Sb3RhdGlvbk1hdHJpeChzKTtjb25zdCBuPXAuWmVybygpLGE9dGhpcy5kZWZpbmVkRmFjaW5nRm9yd2FyZD8tMToxO3JldHVybiBwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUqYSx0LGkqYSxzLG4pLG59cm90YXRlUE9WKGUsdCxpKXtyZXR1cm4gdGhpcy5yb3RhdGlvbi5hZGRJblBsYWNlKHRoaXMuY2FsY1JvdGF0ZVBPVihlLHQsaSkpLHRoaXN9Y2FsY1JvdGF0ZVBPVihlLHQsaSl7Y29uc3Qgcz10aGlzLmRlZmluZWRGYWNpbmdGb3J3YXJkPzE6LTE7cmV0dXJuIG5ldyBwKGUqcyx0LGkqcyl9cmVmcmVzaEJvdW5kaW5nSW5mbyhlPSExLHQ9ITEpe3JldHVybiB0aGlzLl9ib3VuZGluZ0luZm8mJnRoaXMuX2JvdW5kaW5nSW5mby5pc0xvY2tlZD90aGlzOih0aGlzLl9yZWZyZXNoQm91bmRpbmdJbmZvKHRoaXMuX2dldFBvc2l0aW9uRGF0YShlLHQpLG51bGwpLHRoaXMpfV9yZWZyZXNoQm91bmRpbmdJbmZvKGUsdCl7aWYoZSl7Y29uc3QgaT15cihlLDAsdGhpcy5nZXRUb3RhbFZlcnRpY2VzKCksdCk7dGhpcy5fYm91bmRpbmdJbmZvP3RoaXMuX2JvdW5kaW5nSW5mby5yZUNvbnN0cnVjdChpLm1pbmltdW0saS5tYXhpbXVtKTp0aGlzLl9ib3VuZGluZ0luZm89bmV3IGR0KGkubWluaW11bSxpLm1heGltdW0pfWlmKHRoaXMuc3ViTWVzaGVzKWZvcihsZXQgaT0wO2k8dGhpcy5zdWJNZXNoZXMubGVuZ3RoO2krKyl0aGlzLnN1Yk1lc2hlc1tpXS5yZWZyZXNoQm91bmRpbmdJbmZvKGUpO3RoaXMuX3VwZGF0ZUJvdW5kaW5nSW5mbygpfV9nZXREYXRhKGU9ITEsdD0hMSxpLHM9Zy5Qb3NpdGlvbktpbmQpe2lmKGk9aT8/dGhpcy5nZXRWZXJ0aWNlc0RhdGEocykuc2xpY2UoKSxpJiZ0JiZ0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcil7bGV0IHI9MCxuPTA7Zm9yKGxldCBhPTA7YTxpLmxlbmd0aDthKyspe2ZvcihsZXQgbz0wO288dGhpcy5tb3JwaFRhcmdldE1hbmFnZXIubnVtVGFyZ2V0cztvKyspe2NvbnN0IGg9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXIuZ2V0VGFyZ2V0KG8pLGw9aC5pbmZsdWVuY2U7aWYobD4wKXtjb25zdCB1PWguZ2V0UG9zaXRpb25zKCk7dSYmKGlbYV0rPSh1W2FdLWlbYV0pKmwpfX1pZihyKysscz09PWcuUG9zaXRpb25LaW5kJiZ0aGlzLl9wb3NpdGlvbnMmJnI9PT0zKXtyPTA7Y29uc3Qgbz1uKjM7dGhpcy5fcG9zaXRpb25zW24rK10uY29weUZyb21GbG9hdHMoaVtvXSxpW28rMV0saVtvKzJdKX19fWlmKGkmJmUmJnRoaXMuc2tlbGV0b24pe2NvbnN0IHI9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSxuPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCk7aWYobiYmcil7Y29uc3QgYT10aGlzLm51bUJvbmVJbmZsdWVuY2Vycz40LG89YT90aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCk6bnVsbCxoPWE/dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpOm51bGwsbD10aGlzLnNrZWxldG9uLmdldFRyYW5zZm9ybU1hdHJpY2VzKHRoaXMpLHU9RC5WZWN0b3IzWzBdLGQ9RC5NYXRyaXhbMF0sZj1ELk1hdHJpeFsxXTtsZXQgXz0wO2ZvcihsZXQgRT0wO0U8aS5sZW5ndGg7RSs9MyxfKz00KXtkLnJlc2V0KCk7bGV0IG0sdjtmb3IobT0wO208NDttKyspdj1uW18rbV0sdj4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQobCxNYXRoLmZsb29yKHJbXyttXSoxNiksdixmKSxkLmFkZFRvU2VsZihmKSk7aWYoYSlmb3IobT0wO208NDttKyspdj1oW18rbV0sdj4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQobCxNYXRoLmZsb29yKG9bXyttXSoxNiksdixmKSxkLmFkZFRvU2VsZihmKSk7cz09PWcuTm9ybWFsS2luZD9wLlRyYW5zZm9ybU5vcm1hbEZyb21GbG9hdHNUb1JlZihpW0VdLGlbRSsxXSxpW0UrMl0sZCx1KTpwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGlbRV0saVtFKzFdLGlbRSsyXSxkLHUpLHUudG9BcnJheShpLEUpLHM9PT1nLlBvc2l0aW9uS2luZCYmdGhpcy5fcG9zaXRpb25zJiZ0aGlzLl9wb3NpdGlvbnNbRS8zXS5jb3B5RnJvbSh1KX19fXJldHVybiBpfWdldE5vcm1hbHNEYXRhKGU9ITEsdD0hMSl7cmV0dXJuIHRoaXMuX2dldERhdGEoZSx0LG51bGwsZy5Ob3JtYWxLaW5kKX1nZXRQb3NpdGlvbkRhdGEoZT0hMSx0PSExLGkpe3JldHVybiB0aGlzLl9nZXREYXRhKGUsdCxpLGcuUG9zaXRpb25LaW5kKX1fZ2V0UG9zaXRpb25EYXRhKGUsdCl7dmFyIGk7bGV0IHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpO2lmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Bvc2l0aW9ucyYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Bvc2l0aW9ucz1udWxsKSxzJiYoZSYmdGhpcy5za2VsZXRvbnx8dCYmdGhpcy5tb3JwaFRhcmdldE1hbmFnZXIpKXtpZihzPXMuc2xpY2UoKSx0aGlzLl9nZW5lcmF0ZVBvaW50c0FycmF5KCksdGhpcy5fcG9zaXRpb25zKXtjb25zdCByPXRoaXMuX3Bvc2l0aW9uczt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb3NpdGlvbnM9bmV3IEFycmF5KHIubGVuZ3RoKTtmb3IobGV0IG49MDtuPHIubGVuZ3RoO24rKyl0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9wb3NpdGlvbnNbbl09KChpPXJbbl0pPT09bnVsbHx8aT09PXZvaWQgMD92b2lkIDA6aS5jbG9uZSgpKXx8bmV3IHB9cmV0dXJuIHRoaXMuZ2V0UG9zaXRpb25EYXRhKGUsdCxzKX1yZXR1cm4gc31fdXBkYXRlQm91bmRpbmdJbmZvKCl7cmV0dXJuIHRoaXMuX2JvdW5kaW5nSW5mbz90aGlzLl9ib3VuZGluZ0luZm8udXBkYXRlKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpOnRoaXMuX2JvdW5kaW5nSW5mbz1uZXcgZHQocC5aZXJvKCkscC5aZXJvKCksdGhpcy53b3JsZE1hdHJpeEZyb21DYWNoZSksdGhpcy5fdXBkYXRlU3ViTWVzaGVzQm91bmRpbmdJbmZvKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpLHRoaXN9X3VwZGF0ZVN1Yk1lc2hlc0JvdW5kaW5nSW5mbyhlKXtpZighdGhpcy5zdWJNZXNoZXMpcmV0dXJuIHRoaXM7Y29uc3QgdD10aGlzLnN1Yk1lc2hlcy5sZW5ndGg7Zm9yKGxldCBpPTA7aTx0O2krKyl7Y29uc3Qgcz10aGlzLnN1Yk1lc2hlc1tpXTsodD4xfHwhcy5Jc0dsb2JhbCkmJnMudXBkYXRlQm91bmRpbmdJbmZvKGUpfXJldHVybiB0aGlzfV9hZnRlckNvbXB1dGVXb3JsZE1hdHJpeCgpe3RoaXMuZG9Ob3RTeW5jQm91bmRpbmdJbmZvfHwodGhpcy5fYm91bmRpbmdJbmZvSXNEaXJ0eT0hMCl9aXNJbkZydXN0dW0oZSl7cmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuaXNJbkZydXN0dW0oZSx0aGlzLmN1bGxpbmdTdHJhdGVneSl9aXNDb21wbGV0ZWx5SW5GcnVzdHVtKGUpe3JldHVybiB0aGlzLmdldEJvdW5kaW5nSW5mbygpLmlzQ29tcGxldGVseUluRnJ1c3R1bShlKX1pbnRlcnNlY3RzTWVzaChlLHQ9ITEsaSl7Y29uc3Qgcz10aGlzLmdldEJvdW5kaW5nSW5mbygpLHI9ZS5nZXRCb3VuZGluZ0luZm8oKTtpZihzLmludGVyc2VjdHMocix0KSlyZXR1cm4hMDtpZihpKXtmb3IoY29uc3QgbiBvZiB0aGlzLmdldENoaWxkTWVzaGVzKCkpaWYobi5pbnRlcnNlY3RzTWVzaChlLHQsITApKXJldHVybiEwfXJldHVybiExfWludGVyc2VjdHNQb2ludChlKXtyZXR1cm4gdGhpcy5nZXRCb3VuZGluZ0luZm8oKS5pbnRlcnNlY3RzUG9pbnQoZSl9Z2V0IGNoZWNrQ29sbGlzaW9ucygpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY2hlY2tDb2xsaXNpb25zfXNldCBjaGVja0NvbGxpc2lvbnMoZSl7dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWVzaENvbGxpc2lvbkRhdGEuX2NoZWNrQ29sbGlzaW9ucz1lfWdldCBjb2xsaWRlcigpe3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXJ9bW92ZVdpdGhDb2xsaXNpb25zKGUpe3RoaXMuZ2V0QWJzb2x1dGVQb3NpdGlvbigpLmFkZFRvUmVmKHRoaXMuZWxsaXBzb2lkT2Zmc2V0LHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9vbGRQb3NpdGlvbkZvckNvbGxpc2lvbnMpO2NvbnN0IGk9dGhpcy5nZXRTY2VuZSgpLmNvbGxpc2lvbkNvb3JkaW5hdG9yO3JldHVybiB0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXJ8fCh0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXI9aS5jcmVhdGVDb2xsaWRlcigpKSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXIuX3JhZGl1cz10aGlzLmVsbGlwc29pZCxpLmdldE5ld1Bvc2l0aW9uKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21lc2hDb2xsaXNpb25EYXRhLl9vbGRQb3NpdGlvbkZvckNvbGxpc2lvbnMsZSx0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tZXNoQ29sbGlzaW9uRGF0YS5fY29sbGlkZXIsdGhpcy5jb2xsaXNpb25SZXRyeUNvdW50LHRoaXMsdGhpcy5fb25Db2xsaXNpb25Qb3NpdGlvbkNoYW5nZSx0aGlzLnVuaXF1ZUlkKSx0aGlzfV9jb2xsaWRlRm9yU3ViTWVzaChlLHQsaSl7dmFyIHM7aWYodGhpcy5fZ2VuZXJhdGVQb2ludHNBcnJheSgpLCF0aGlzLl9wb3NpdGlvbnMpcmV0dXJuIHRoaXM7aWYoIWUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXN8fCFlLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXguZXF1YWxzKHQpKXtlLl9sYXN0Q29sbGlkZXJUcmFuc2Zvcm1NYXRyaXg9dC5jbG9uZSgpLGUuX2xhc3RDb2xsaWRlcldvcmxkVmVydGljZXM9W10sZS5fdHJpYW5nbGVQbGFuZXM9W107Y29uc3Qgcj1lLnZlcnRpY2VzU3RhcnQsbj1lLnZlcnRpY2VzU3RhcnQrZS52ZXJ0aWNlc0NvdW50O2ZvcihsZXQgYT1yO2E8bjthKyspZS5fbGFzdENvbGxpZGVyV29ybGRWZXJ0aWNlcy5wdXNoKHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXModGhpcy5fcG9zaXRpb25zW2FdLHQpKX1yZXR1cm4gaS5fY29sbGlkZShlLl90cmlhbmdsZVBsYW5lcyxlLl9sYXN0Q29sbGlkZXJXb3JsZFZlcnRpY2VzLHRoaXMuZ2V0SW5kaWNlcygpLGUuaW5kZXhTdGFydCxlLmluZGV4U3RhcnQrZS5pbmRleENvdW50LGUudmVydGljZXNTdGFydCwhIWUuZ2V0TWF0ZXJpYWwoKSx0aGlzLHRoaXMuX3Nob3VsZENvbnZlcnRSSFMoKSwoKHM9ZS5nZXRNYXRlcmlhbCgpKT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMuZmlsbE1vZGUpPT09NyksdGhpc31fcHJvY2Vzc0NvbGxpc2lvbnNGb3JTdWJNZXNoZXMoZSx0KXtjb25zdCBpPXRoaXMuX3NjZW5lLmdldENvbGxpZGluZ1N1Yk1lc2hDYW5kaWRhdGVzKHRoaXMsZSkscz1pLmxlbmd0aDtmb3IobGV0IHI9MDtyPHM7cisrKXtjb25zdCBuPWkuZGF0YVtyXTtzPjEmJiFuLl9jaGVja0NvbGxpc2lvbihlKXx8dGhpcy5fY29sbGlkZUZvclN1Yk1lc2gobix0LGUpfXJldHVybiB0aGlzfV9zaG91bGRDb252ZXJ0UkhTKCl7cmV0dXJuITF9X2NoZWNrQ29sbGlzaW9uKGUpe2lmKCF0aGlzLmdldEJvdW5kaW5nSW5mbygpLl9jaGVja0NvbGxpc2lvbihlKSlyZXR1cm4gdGhpcztjb25zdCB0PUQuTWF0cml4WzBdLGk9RC5NYXRyaXhbMV07cmV0dXJuIHguU2NhbGluZ1RvUmVmKDEvZS5fcmFkaXVzLngsMS9lLl9yYWRpdXMueSwxL2UuX3JhZGl1cy56LHQpLHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUubXVsdGlwbHlUb1JlZih0LGkpLHRoaXMuX3Byb2Nlc3NDb2xsaXNpb25zRm9yU3ViTWVzaGVzKGUsaSksdGhpc31fZ2VuZXJhdGVQb2ludHNBcnJheSgpe3JldHVybiExfWludGVyc2VjdHMoZSx0LGkscz0hMSxyLG49ITEpe2NvbnN0IGE9bmV3IFV0LG89dGhpcy5nZXRDbGFzc05hbWUoKT09PSJJbnN0YW5jZWRMaW5lc01lc2gifHx0aGlzLmdldENsYXNzTmFtZSgpPT09IkxpbmVzTWVzaCI/dGhpcy5pbnRlcnNlY3Rpb25UaHJlc2hvbGQ6MCxoPXRoaXMuZ2V0Qm91bmRpbmdJbmZvKCk7aWYoIXRoaXMuc3ViTWVzaGVzfHwhbiYmKCFlLmludGVyc2VjdHNTcGhlcmUoaC5ib3VuZGluZ1NwaGVyZSxvKXx8IWUuaW50ZXJzZWN0c0JveChoLmJvdW5kaW5nQm94LG8pKSlyZXR1cm4gYTtpZihzKXJldHVybiBhLmhpdD0hbixhLnBpY2tlZE1lc2g9bj9udWxsOnRoaXMsYS5kaXN0YW5jZT1uPzA6cC5EaXN0YW5jZShlLm9yaWdpbixoLmJvdW5kaW5nU3BoZXJlLmNlbnRlciksYS5zdWJNZXNoSWQ9MCxhO2lmKCF0aGlzLl9nZW5lcmF0ZVBvaW50c0FycmF5KCkpcmV0dXJuIGE7bGV0IGw9bnVsbDtjb25zdCB1PXRoaXMuX3NjZW5lLmdldEludGVyc2VjdGluZ1N1Yk1lc2hDYW5kaWRhdGVzKHRoaXMsZSksZD11Lmxlbmd0aDtsZXQgZj0hMTtmb3IobGV0IF89MDtfPGQ7XysrKXtjb25zdCBtPXUuZGF0YVtfXS5nZXRNYXRlcmlhbCgpO2lmKG0mJihtLmZpbGxNb2RlPT03fHxtLmZpbGxNb2RlPT0wfHxtLmZpbGxNb2RlPT0xfHxtLmZpbGxNb2RlPT0yfHxtLmZpbGxNb2RlPT00KSl7Zj0hMDticmVha319aWYoIWYpcmV0dXJuIGEuaGl0PSEwLGEucGlja2VkTWVzaD10aGlzLGEuZGlzdGFuY2U9cC5EaXN0YW5jZShlLm9yaWdpbixoLmJvdW5kaW5nU3BoZXJlLmNlbnRlciksYS5zdWJNZXNoSWQ9LTEsYTtmb3IobGV0IF89MDtfPGQ7XysrKXtjb25zdCBFPXUuZGF0YVtfXTtpZihkPjEmJiFFLmNhbkludGVyc2VjdHMoZSkpY29udGludWU7Y29uc3QgbT1FLmludGVyc2VjdHMoZSx0aGlzLl9wb3NpdGlvbnMsdGhpcy5nZXRJbmRpY2VzKCksdCxpKTtpZihtJiYodHx8IWx8fG0uZGlzdGFuY2U8bC5kaXN0YW5jZSkmJihsPW0sbC5zdWJNZXNoSWQ9Xyx0KSlicmVha31pZihsKXtjb25zdCBfPXI/P3RoaXMuZ2V0V29ybGRNYXRyaXgoKSxFPUQuVmVjdG9yM1swXSxtPUQuVmVjdG9yM1sxXTtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZS5vcmlnaW4sXyxFKSxlLmRpcmVjdGlvbi5zY2FsZVRvUmVmKGwuZGlzdGFuY2UsbSk7Y29uc3QgUz1wLlRyYW5zZm9ybU5vcm1hbChtLF8pLmFkZEluUGxhY2UoRSk7cmV0dXJuIGEuaGl0PSEwLGEuZGlzdGFuY2U9cC5EaXN0YW5jZShFLFMpLGEucGlja2VkUG9pbnQ9UyxhLnBpY2tlZE1lc2g9dGhpcyxhLmJ1PWwuYnV8fDAsYS5idj1sLmJ2fHwwLGEuc3ViTWVzaEZhY2VJZD1sLmZhY2VJZCxhLmZhY2VJZD1sLmZhY2VJZCt1LmRhdGFbbC5zdWJNZXNoSWRdLmluZGV4U3RhcnQvKHRoaXMuZ2V0Q2xhc3NOYW1lKCkuaW5kZXhPZigiTGluZXNNZXNoIikhPT0tMT8yOjMpLGEuc3ViTWVzaElkPWwuc3ViTWVzaElkLGF9cmV0dXJuIGF9Y2xvbmUoZSx0LGkpe3JldHVybiBudWxsfXJlbGVhc2VTdWJNZXNoZXMoKXtpZih0aGlzLnN1Yk1lc2hlcylmb3IoO3RoaXMuc3ViTWVzaGVzLmxlbmd0aDspdGhpcy5zdWJNZXNoZXNbMF0uZGlzcG9zZSgpO2Vsc2UgdGhpcy5zdWJNZXNoZXM9bmV3IEFycmF5O3JldHVybiB0aGlzfWRpc3Bvc2UoZSx0PSExKXtsZXQgaTtmb3IodGhpcy5fc2NlbmUudXNlTWF0ZXJpYWxNZXNoTWFwJiZ0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tYXRlcmlhbCYmdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWwubWVzaE1hcCYmKHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX21hdGVyaWFsLm1lc2hNYXBbdGhpcy51bmlxdWVJZF09dm9pZCAwKSx0aGlzLmdldFNjZW5lKCkuZnJlZUFjdGl2ZU1lc2hlcygpLHRoaXMuZ2V0U2NlbmUoKS5mcmVlUmVuZGVyaW5nR3JvdXBzKCksdGhpcy5hY3Rpb25NYW5hZ2VyIT09dm9pZCAwJiZ0aGlzLmFjdGlvbk1hbmFnZXIhPT1udWxsJiYodGhpcy5hY3Rpb25NYW5hZ2VyLmRpc3Bvc2UoKSx0aGlzLmFjdGlvbk1hbmFnZXI9bnVsbCksdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fc2tlbGV0b249bnVsbCx0aGlzLl90cmFuc2Zvcm1NYXRyaXhUZXh0dXJlJiYodGhpcy5fdHJhbnNmb3JtTWF0cml4VGV4dHVyZS5kaXNwb3NlKCksdGhpcy5fdHJhbnNmb3JtTWF0cml4VGV4dHVyZT1udWxsKSxpPTA7aTx0aGlzLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5sZW5ndGg7aSsrKXtjb25zdCBuPXRoaXMuX2ludGVyc2VjdGlvbnNJblByb2dyZXNzW2ldLGE9bi5faW50ZXJzZWN0aW9uc0luUHJvZ3Jlc3MuaW5kZXhPZih0aGlzKTtuLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5zcGxpY2UoYSwxKX10aGlzLl9pbnRlcnNlY3Rpb25zSW5Qcm9ncmVzcy5sZW5ndGg9MCx0aGlzLmdldFNjZW5lKCkubGlnaHRzLmZvckVhY2gobj0+e2xldCBhPW4uaW5jbHVkZWRPbmx5TWVzaGVzLmluZGV4T2YodGhpcyk7YSE9PS0xJiZuLmluY2x1ZGVkT25seU1lc2hlcy5zcGxpY2UoYSwxKSxhPW4uZXhjbHVkZWRNZXNoZXMuaW5kZXhPZih0aGlzKSxhIT09LTEmJm4uZXhjbHVkZWRNZXNoZXMuc3BsaWNlKGEsMSk7Y29uc3Qgbz1uLmdldFNoYWRvd0dlbmVyYXRvcnMoKTtpZihvKXtjb25zdCBoPW8udmFsdWVzKCk7Zm9yKGxldCBsPWgubmV4dCgpO2wuZG9uZSE9PSEwO2w9aC5uZXh0KCkpe2NvbnN0IGQ9bC52YWx1ZS5nZXRTaGFkb3dNYXAoKTtkJiZkLnJlbmRlckxpc3QmJihhPWQucmVuZGVyTGlzdC5pbmRleE9mKHRoaXMpLGEhPT0tMSYmZC5yZW5kZXJMaXN0LnNwbGljZShhLDEpKX19fSksKHRoaXMuZ2V0Q2xhc3NOYW1lKCkhPT0iSW5zdGFuY2VkTWVzaCJ8fHRoaXMuZ2V0Q2xhc3NOYW1lKCkhPT0iSW5zdGFuY2VkTGluZXNNZXNoIikmJnRoaXMucmVsZWFzZVN1Yk1lc2hlcygpO2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO2lmKHRoaXMuX29jY2x1c2lvblF1ZXJ5IT09bnVsbCYmKHRoaXMuaXNPY2NsdXNpb25RdWVyeUluUHJvZ3Jlc3M9ITEsci5kZWxldGVRdWVyeSh0aGlzLl9vY2NsdXNpb25RdWVyeSksdGhpcy5fb2NjbHVzaW9uUXVlcnk9bnVsbCksci53aXBlQ2FjaGVzKCksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZU1lc2godGhpcyksdGhpcy5fcGFyZW50Q29udGFpbmVyKXtjb25zdCBuPXRoaXMuX3BhcmVudENvbnRhaW5lci5tZXNoZXMuaW5kZXhPZih0aGlzKTtuPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIubWVzaGVzLnNwbGljZShuLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKHQmJnRoaXMubWF0ZXJpYWwmJih0aGlzLm1hdGVyaWFsLmdldENsYXNzTmFtZSgpPT09Ik11bHRpTWF0ZXJpYWwiP3RoaXMubWF0ZXJpYWwuZGlzcG9zZSghMSwhMCwhMCk6dGhpcy5tYXRlcmlhbC5kaXNwb3NlKCExLCEwKSksIWUpZm9yKGk9MDtpPHRoaXMuZ2V0U2NlbmUoKS5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2krKyl0aGlzLmdldFNjZW5lKCkucGFydGljbGVTeXN0ZW1zW2ldLmVtaXR0ZXI9PT10aGlzJiYodGhpcy5nZXRTY2VuZSgpLnBhcnRpY2xlU3lzdGVtc1tpXS5kaXNwb3NlKCksaS0tKTt0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGEuZmFjZXREYXRhRW5hYmxlZCYmdGhpcy5kaXNhYmxlRmFjZXREYXRhKCksdGhpcy5fdW5pZm9ybUJ1ZmZlci5kaXNwb3NlKCksdGhpcy5vbkFmdGVyV29ybGRNYXRyaXhVcGRhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNvbGxpZGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNvbGxpc2lvblBvc2l0aW9uQ2hhbmdlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25SZWJ1aWxkT2JzZXJ2YWJsZS5jbGVhcigpLHN1cGVyLmRpc3Bvc2UoZSx0KX1hZGRDaGlsZChlLHQ9ITEpe3JldHVybiBlLnNldFBhcmVudCh0aGlzLHQpLHRoaXN9cmVtb3ZlQ2hpbGQoZSx0PSExKXtyZXR1cm4gZS5zZXRQYXJlbnQobnVsbCx0KSx0aGlzfV9pbml0RmFjZXREYXRhKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGE7ZS5mYWNldE5vcm1hbHN8fChlLmZhY2V0Tm9ybWFscz1uZXcgQXJyYXkpLGUuZmFjZXRQb3NpdGlvbnN8fChlLmZhY2V0UG9zaXRpb25zPW5ldyBBcnJheSksZS5mYWNldFBhcnRpdGlvbmluZ3x8KGUuZmFjZXRQYXJ0aXRpb25pbmc9bmV3IEFycmF5KSxlLmZhY2V0TmI9dGhpcy5nZXRJbmRpY2VzKCkubGVuZ3RoLzN8MCxlLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9ucz1lLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9ucz9lLnBhcnRpdGlvbmluZ1N1YmRpdmlzaW9uczoxMCxlLnBhcnRpdGlvbmluZ0JCb3hSYXRpbz1lLnBhcnRpdGlvbmluZ0JCb3hSYXRpbz9lLnBhcnRpdGlvbmluZ0JCb3hSYXRpbzoxLjAxO2ZvcihsZXQgdD0wO3Q8ZS5mYWNldE5iO3QrKyllLmZhY2V0Tm9ybWFsc1t0XT1wLlplcm8oKSxlLmZhY2V0UG9zaXRpb25zW3RdPXAuWmVybygpO3JldHVybiBlLmZhY2V0RGF0YUVuYWJsZWQ9ITAsdGhpc311cGRhdGVGYWNldERhdGEoKXtjb25zdCBlPXRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YTtlLmZhY2V0RGF0YUVuYWJsZWR8fHRoaXMuX2luaXRGYWNldERhdGEoKTtjb25zdCB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kKSxpPXRoaXMuZ2V0SW5kaWNlcygpLHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKSxyPXRoaXMuZ2V0Qm91bmRpbmdJbmZvKCk7aWYoZS5mYWNldERlcHRoU29ydCYmIWUuZmFjZXREZXB0aFNvcnRFbmFibGVkKXtpZihlLmZhY2V0RGVwdGhTb3J0RW5hYmxlZD0hMCxpIGluc3RhbmNlb2YgVWludDE2QXJyYXkpZS5kZXB0aFNvcnRlZEluZGljZXM9bmV3IFVpbnQxNkFycmF5KGkpO2Vsc2UgaWYoaSBpbnN0YW5jZW9mIFVpbnQzMkFycmF5KWUuZGVwdGhTb3J0ZWRJbmRpY2VzPW5ldyBVaW50MzJBcnJheShpKTtlbHNle2xldCBhPSExO2ZvcihsZXQgbz0wO288aS5sZW5ndGg7bysrKWlmKGlbb10+NjU1MzUpe2E9ITA7YnJlYWt9YT9lLmRlcHRoU29ydGVkSW5kaWNlcz1uZXcgVWludDMyQXJyYXkoaSk6ZS5kZXB0aFNvcnRlZEluZGljZXM9bmV3IFVpbnQxNkFycmF5KGkpfWlmKGUuZmFjZXREZXB0aFNvcnRGdW5jdGlvbj1mdW5jdGlvbihhLG8pe3JldHVybiBvLnNxRGlzdGFuY2UtYS5zcURpc3RhbmNlfSwhZS5mYWNldERlcHRoU29ydEZyb20pe2NvbnN0IGE9dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYTtlLmZhY2V0RGVwdGhTb3J0RnJvbT1hP2EucG9zaXRpb246cC5aZXJvKCl9ZS5kZXB0aFNvcnRlZEZhY2V0cz1bXTtmb3IobGV0IGE9MDthPGUuZmFjZXROYjthKyspe2NvbnN0IG89e2luZDphKjMsc3FEaXN0YW5jZTowfTtlLmRlcHRoU29ydGVkRmFjZXRzLnB1c2gobyl9ZS5pbnZlcnRlZE1hdHJpeD14LklkZW50aXR5KCksZS5mYWNldERlcHRoU29ydE9yaWdpbj1wLlplcm8oKX1lLmJiU2l6ZS54PXIubWF4aW11bS54LXIubWluaW11bS54PnhlP3IubWF4aW11bS54LXIubWluaW11bS54OnhlLGUuYmJTaXplLnk9ci5tYXhpbXVtLnktci5taW5pbXVtLnk+eGU/ci5tYXhpbXVtLnktci5taW5pbXVtLnk6eGUsZS5iYlNpemUuej1yLm1heGltdW0uei1yLm1pbmltdW0uej54ZT9yLm1heGltdW0uei1yLm1pbmltdW0uejp4ZTtsZXQgbj1lLmJiU2l6ZS54PmUuYmJTaXplLnk/ZS5iYlNpemUueDplLmJiU2l6ZS55O2lmKG49bj5lLmJiU2l6ZS56P246ZS5iYlNpemUueixlLnN1YkRpdi5tYXg9ZS5wYXJ0aXRpb25pbmdTdWJkaXZpc2lvbnMsZS5zdWJEaXYuWD1NYXRoLmZsb29yKGUuc3ViRGl2Lm1heCplLmJiU2l6ZS54L24pLGUuc3ViRGl2Llk9TWF0aC5mbG9vcihlLnN1YkRpdi5tYXgqZS5iYlNpemUueS9uKSxlLnN1YkRpdi5aPU1hdGguZmxvb3IoZS5zdWJEaXYubWF4KmUuYmJTaXplLnovbiksZS5zdWJEaXYuWD1lLnN1YkRpdi5YPDE/MTplLnN1YkRpdi5YLGUuc3ViRGl2Llk9ZS5zdWJEaXYuWTwxPzE6ZS5zdWJEaXYuWSxlLnN1YkRpdi5aPWUuc3ViRGl2Llo8MT8xOmUuc3ViRGl2LlosZS5mYWNldFBhcmFtZXRlcnMuZmFjZXROb3JtYWxzPXRoaXMuZ2V0RmFjZXRMb2NhbE5vcm1hbHMoKSxlLmZhY2V0UGFyYW1ldGVycy5mYWNldFBvc2l0aW9ucz10aGlzLmdldEZhY2V0TG9jYWxQb3NpdGlvbnMoKSxlLmZhY2V0UGFyYW1ldGVycy5mYWNldFBhcnRpdGlvbmluZz10aGlzLmdldEZhY2V0TG9jYWxQYXJ0aXRpb25pbmcoKSxlLmZhY2V0UGFyYW1ldGVycy5iSW5mbz1yLGUuZmFjZXRQYXJhbWV0ZXJzLmJiU2l6ZT1lLmJiU2l6ZSxlLmZhY2V0UGFyYW1ldGVycy5zdWJEaXY9ZS5zdWJEaXYsZS5mYWNldFBhcmFtZXRlcnMucmF0aW89dGhpcy5wYXJ0aXRpb25pbmdCQm94UmF0aW8sZS5mYWNldFBhcmFtZXRlcnMuZGVwdGhTb3J0PWUuZmFjZXREZXB0aFNvcnQsZS5mYWNldERlcHRoU29ydCYmZS5mYWNldERlcHRoU29ydEVuYWJsZWQmJih0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCksdGhpcy5fd29ybGRNYXRyaXguaW52ZXJ0VG9SZWYoZS5pbnZlcnRlZE1hdHJpeCkscC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKGUuZmFjZXREZXB0aFNvcnRGcm9tLGUuaW52ZXJ0ZWRNYXRyaXgsZS5mYWNldERlcHRoU29ydE9yaWdpbiksZS5mYWNldFBhcmFtZXRlcnMuZGlzdGFuY2VUbz1lLmZhY2V0RGVwdGhTb3J0T3JpZ2luKSxlLmZhY2V0UGFyYW1ldGVycy5kZXB0aFNvcnRlZEZhY2V0cz1lLmRlcHRoU29ydGVkRmFjZXRzLHMmJmVlLkNvbXB1dGVOb3JtYWxzKHQsaSxzLGUuZmFjZXRQYXJhbWV0ZXJzKSxlLmZhY2V0RGVwdGhTb3J0JiZlLmZhY2V0RGVwdGhTb3J0RW5hYmxlZCl7ZS5kZXB0aFNvcnRlZEZhY2V0cy5zb3J0KGUuZmFjZXREZXB0aFNvcnRGdW5jdGlvbik7Y29uc3QgYT1lLmRlcHRoU29ydGVkSW5kaWNlcy5sZW5ndGgvM3wwO2ZvcihsZXQgbz0wO288YTtvKyspe2NvbnN0IGg9ZS5kZXB0aFNvcnRlZEZhY2V0c1tvXS5pbmQ7ZS5kZXB0aFNvcnRlZEluZGljZXNbbyozXT1pW2hdLGUuZGVwdGhTb3J0ZWRJbmRpY2VzW28qMysxXT1pW2grMV0sZS5kZXB0aFNvcnRlZEluZGljZXNbbyozKzJdPWlbaCsyXX10aGlzLnVwZGF0ZUluZGljZXMoZS5kZXB0aFNvcnRlZEluZGljZXMsdm9pZCAwLCEwKX1yZXR1cm4gdGhpc31nZXRGYWNldExvY2FsTm9ybWFscygpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhO3JldHVybiBlLmZhY2V0Tm9ybWFsc3x8dGhpcy51cGRhdGVGYWNldERhdGEoKSxlLmZhY2V0Tm9ybWFsc31nZXRGYWNldExvY2FsUG9zaXRpb25zKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGE7cmV0dXJuIGUuZmFjZXRQb3NpdGlvbnN8fHRoaXMudXBkYXRlRmFjZXREYXRhKCksZS5mYWNldFBvc2l0aW9uc31nZXRGYWNldExvY2FsUGFydGl0aW9uaW5nKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9mYWNldERhdGE7cmV0dXJuIGUuZmFjZXRQYXJ0aXRpb25pbmd8fHRoaXMudXBkYXRlRmFjZXREYXRhKCksZS5mYWNldFBhcnRpdGlvbmluZ31nZXRGYWNldFBvc2l0aW9uKGUpe2NvbnN0IHQ9cC5aZXJvKCk7cmV0dXJuIHRoaXMuZ2V0RmFjZXRQb3NpdGlvblRvUmVmKGUsdCksdH1nZXRGYWNldFBvc2l0aW9uVG9SZWYoZSx0KXtjb25zdCBpPXRoaXMuZ2V0RmFjZXRMb2NhbFBvc2l0aW9ucygpW2VdLHM9dGhpcy5nZXRXb3JsZE1hdHJpeCgpO3JldHVybiBwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoaSxzLHQpLHRoaXN9Z2V0RmFjZXROb3JtYWwoZSl7Y29uc3QgdD1wLlplcm8oKTtyZXR1cm4gdGhpcy5nZXRGYWNldE5vcm1hbFRvUmVmKGUsdCksdH1nZXRGYWNldE5vcm1hbFRvUmVmKGUsdCl7Y29uc3QgaT10aGlzLmdldEZhY2V0TG9jYWxOb3JtYWxzKClbZV07cmV0dXJuIHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYoaSx0aGlzLmdldFdvcmxkTWF0cml4KCksdCksdGhpc31nZXRGYWNldHNBdExvY2FsQ29vcmRpbmF0ZXMoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRCb3VuZGluZ0luZm8oKSxyPXRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YSxuPU1hdGguZmxvb3IoKGUtcy5taW5pbXVtLngqci5wYXJ0aXRpb25pbmdCQm94UmF0aW8pKnIuc3ViRGl2Llgqci5wYXJ0aXRpb25pbmdCQm94UmF0aW8vci5iYlNpemUueCksYT1NYXRoLmZsb29yKCh0LXMubWluaW11bS55KnIucGFydGl0aW9uaW5nQkJveFJhdGlvKSpyLnN1YkRpdi5ZKnIucGFydGl0aW9uaW5nQkJveFJhdGlvL3IuYmJTaXplLnkpLG89TWF0aC5mbG9vcigoaS1zLm1pbmltdW0ueipyLnBhcnRpdGlvbmluZ0JCb3hSYXRpbykqci5zdWJEaXYuWipyLnBhcnRpdGlvbmluZ0JCb3hSYXRpby9yLmJiU2l6ZS56KTtyZXR1cm4gbjwwfHxuPnIuc3ViRGl2Lm1heHx8YTwwfHxhPnIuc3ViRGl2Lm1heHx8bzwwfHxvPnIuc3ViRGl2Lm1heD9udWxsOnIuZmFjZXRQYXJ0aXRpb25pbmdbbityLnN1YkRpdi5tYXgqYStyLnN1YkRpdi5tYXgqci5zdWJEaXYubWF4Km9dfWdldENsb3Nlc3RGYWNldEF0Q29vcmRpbmF0ZXMoZSx0LGkscyxyPSExLG49ITApe2NvbnN0IGE9dGhpcy5nZXRXb3JsZE1hdHJpeCgpLG89RC5NYXRyaXhbNV07YS5pbnZlcnRUb1JlZihvKTtjb25zdCBoPUQuVmVjdG9yM1s4XTtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUsdCxpLG8saCk7Y29uc3QgbD10aGlzLmdldENsb3Nlc3RGYWNldEF0TG9jYWxDb29yZGluYXRlcyhoLngsaC55LGgueixzLHIsbik7cmV0dXJuIHMmJnAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNGcm9tRmxvYXRzVG9SZWYocy54LHMueSxzLnosYSxzKSxsfWdldENsb3Nlc3RGYWNldEF0TG9jYWxDb29yZGluYXRlcyhlLHQsaSxzLHI9ITEsbj0hMCl7bGV0IGE9bnVsbCxvPTAsaD0wLGw9MCx1PTAsZD0wLGY9MCxfPTAsRT0wO2NvbnN0IG09dGhpcy5nZXRGYWNldExvY2FsUG9zaXRpb25zKCksdj10aGlzLmdldEZhY2V0TG9jYWxOb3JtYWxzKCksUz10aGlzLmdldEZhY2V0c0F0TG9jYWxDb29yZGluYXRlcyhlLHQsaSk7aWYoIVMpcmV0dXJuIG51bGw7bGV0IHk9TnVtYmVyLk1BWF9WQUxVRSxBPXksQyxiLE07Zm9yKGxldCBMPTA7TDxTLmxlbmd0aDtMKyspQz1TW0xdLGI9dltDXSxNPW1bQ10sdT0oZS1NLngpKmIueCsodC1NLnkpKmIueSsoaS1NLnopKmIueiwoIXJ8fHImJm4mJnU+PTB8fHImJiFuJiZ1PD0wKSYmKHU9Yi54Kk0ueCtiLnkqTS55K2IueipNLnosZD0tKGIueCplK2IueSp0K2IueippLXUpLyhiLngqYi54K2IueSpiLnkrYi56KmIueiksZj1lK2IueCpkLF89dCtiLnkqZCxFPWkrYi56KmQsbz1mLWUsaD1fLXQsbD1FLWksQT1vKm8raCpoK2wqbCxBPHkmJih5PUEsYT1DLHMmJihzLng9ZixzLnk9XyxzLno9RSkpKTtyZXR1cm4gYX1nZXRGYWNldERhdGFQYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2ZhY2V0RGF0YS5mYWNldFBhcmFtZXRlcnN9ZGlzYWJsZUZhY2V0RGF0YSgpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fZmFjZXREYXRhO3JldHVybiBlLmZhY2V0RGF0YUVuYWJsZWQmJihlLmZhY2V0RGF0YUVuYWJsZWQ9ITEsZS5mYWNldFBvc2l0aW9ucz1uZXcgQXJyYXksZS5mYWNldE5vcm1hbHM9bmV3IEFycmF5LGUuZmFjZXRQYXJ0aXRpb25pbmc9bmV3IEFycmF5LGUuZmFjZXRQYXJhbWV0ZXJzPW51bGwsZS5kZXB0aFNvcnRlZEluZGljZXM9bmV3IFVpbnQzMkFycmF5KDApKSx0aGlzfXVwZGF0ZUluZGljZXMoZSx0LGk9ITEpe3JldHVybiB0aGlzfWNyZWF0ZU5vcm1hbHMoZSl7Y29uc3QgdD10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCksaT10aGlzLmdldEluZGljZXMoKTtsZXQgcztyZXR1cm4gdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Ob3JtYWxLaW5kKT9zPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCk6cz1bXSxlZS5Db21wdXRlTm9ybWFscyh0LGkscyx7dXNlUmlnaHRIYW5kZWRTeXN0ZW06dGhpcy5nZXRTY2VuZSgpLnVzZVJpZ2h0SGFuZGVkU3lzdGVtfSksdGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLHMsZSksdGhpc31hbGlnbldpdGhOb3JtYWwoZSx0KXt0fHwodD1faS5ZKTtjb25zdCBpPUQuVmVjdG9yM1swXSxzPUQuVmVjdG9yM1sxXTtyZXR1cm4gcC5Dcm9zc1RvUmVmKHQsZSxzKSxwLkNyb3NzVG9SZWYoZSxzLGkpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP1ouUm90YXRpb25RdWF0ZXJuaW9uRnJvbUF4aXNUb1JlZihpLGUscyx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbik6cC5Sb3RhdGlvbkZyb21BeGlzVG9SZWYoaSxlLHMsdGhpcy5yb3RhdGlvbiksdGhpc31fY2hlY2tPY2NsdXNpb25RdWVyeSgpe3JldHVybiExfWRpc2FibGVFZGdlc1JlbmRlcmluZygpe3Rocm93ICQoIkVkZ2VzUmVuZGVyZXIiKX1lbmFibGVFZGdlc1JlbmRlcmluZyhlLHQsaSl7dGhyb3cgJCgiRWRnZXNSZW5kZXJlciIpfWdldENvbm5lY3RlZFBhcnRpY2xlU3lzdGVtcygpe3JldHVybiB0aGlzLl9zY2VuZS5wYXJ0aWNsZVN5c3RlbXMuZmlsdGVyKGU9PmUuZW1pdHRlcj09PXRoaXMpfX1vdC5PQ0NMVVNJT05fVFlQRV9OT05FPTAsb3QuT0NDTFVTSU9OX1RZUEVfT1BUSU1JU1RJQz0xLG90Lk9DQ0xVU0lPTl9UWVBFX1NUUklDVD0yLG90Lk9DQ0xVU0lPTl9BTEdPUklUSE1fVFlQRV9BQ0NVUkFURT0wLG90Lk9DQ0xVU0lPTl9BTEdPUklUSE1fVFlQRV9DT05TRVJWQVRJVkU9MSxvdC5DVUxMSU5HU1RSQVRFR1lfU1RBTkRBUkQ9MCxvdC5DVUxMSU5HU1RSQVRFR1lfQk9VTkRJTkdTUEhFUkVfT05MWT0xLG90LkNVTExJTkdTVFJBVEVHWV9PUFRJTUlTVElDX0lOQ0xVU0lPTj0yLG90LkNVTExJTkdTVFJBVEVHWV9PUFRJTUlTVElDX0lOQ0xVU0lPTl9USEVOX0JTUEhFUkVfT05MWT0zLGl0KCJCQUJZTE9OLkFic3RyYWN0TWVzaCIsb3QpO2Z1bmN0aW9uIHNzKGMpe2MuaW5kZXhPZigidkNsaXBQbGFuZSIpPT09LTEmJmMucHVzaCgidkNsaXBQbGFuZSIpLGMuaW5kZXhPZigidkNsaXBQbGFuZTIiKT09PS0xJiZjLnB1c2goInZDbGlwUGxhbmUyIiksYy5pbmRleE9mKCJ2Q2xpcFBsYW5lMyIpPT09LTEmJmMucHVzaCgidkNsaXBQbGFuZTMiKSxjLmluZGV4T2YoInZDbGlwUGxhbmU0Iik9PT0tMSYmYy5wdXNoKCJ2Q2xpcFBsYW5lNCIpLGMuaW5kZXhPZigidkNsaXBQbGFuZTUiKT09PS0xJiZjLnB1c2goInZDbGlwUGxhbmU1IiksYy5pbmRleE9mKCJ2Q2xpcFBsYW5lNiIpPT09LTEmJmMucHVzaCgidkNsaXBQbGFuZTYiKX1mdW5jdGlvbiBPcyhjLGUsdCl7dmFyIGkscyxyLG4sYSxvO2xldCBoPSExLGw9KGk9Yy5jbGlwUGxhbmUpIT09bnVsbCYmaSE9PXZvaWQgMD9pOmUuY2xpcFBsYW5lO3JldHVybiBoPWJpKGwsdCwiQ0xJUFBMQU5FIil8fGgsbD0ocz1jLmNsaXBQbGFuZTIpIT09bnVsbCYmcyE9PXZvaWQgMD9zOmUuY2xpcFBsYW5lMixoPWJpKGwsdCwiQ0xJUFBMQU5FMiIpfHxoLGw9KHI9Yy5jbGlwUGxhbmUzKSE9PW51bGwmJnIhPT12b2lkIDA/cjplLmNsaXBQbGFuZTMsaD1iaShsLHQsIkNMSVBQTEFORTMiKXx8aCxsPShuPWMuY2xpcFBsYW5lNCkhPT1udWxsJiZuIT09dm9pZCAwP246ZS5jbGlwUGxhbmU0LGg9YmkobCx0LCJDTElQUExBTkU0Iil8fGgsbD0oYT1jLmNsaXBQbGFuZTUpIT09bnVsbCYmYSE9PXZvaWQgMD9hOmUuY2xpcFBsYW5lNSxoPWJpKGwsdCwiQ0xJUFBMQU5FNSIpfHxoLGw9KG89Yy5jbGlwUGxhbmU2KSE9PW51bGwmJm8hPT12b2lkIDA/bzplLmNsaXBQbGFuZTYsaD1iaShsLHQsIkNMSVBQTEFORTYiKXx8aCxofWZ1bmN0aW9uIHJzKGMsZSx0KXt2YXIgaSxzLHIsbixhLG87bGV0IGg9KGk9ZS5jbGlwUGxhbmUpIT09bnVsbCYmaSE9PXZvaWQgMD9pOnQuY2xpcFBsYW5lO1RpKGMsInZDbGlwUGxhbmUiLGgpLGg9KHM9ZS5jbGlwUGxhbmUyKSE9PW51bGwmJnMhPT12b2lkIDA/czp0LmNsaXBQbGFuZTIsVGkoYywidkNsaXBQbGFuZTIiLGgpLGg9KHI9ZS5jbGlwUGxhbmUzKSE9PW51bGwmJnIhPT12b2lkIDA/cjp0LmNsaXBQbGFuZTMsVGkoYywidkNsaXBQbGFuZTMiLGgpLGg9KG49ZS5jbGlwUGxhbmU0KSE9PW51bGwmJm4hPT12b2lkIDA/bjp0LmNsaXBQbGFuZTQsVGkoYywidkNsaXBQbGFuZTQiLGgpLGg9KGE9ZS5jbGlwUGxhbmU1KSE9PW51bGwmJmEhPT12b2lkIDA/YTp0LmNsaXBQbGFuZTUsVGkoYywidkNsaXBQbGFuZTUiLGgpLGg9KG89ZS5jbGlwUGxhbmU2KSE9PW51bGwmJm8hPT12b2lkIDA/bzp0LmNsaXBQbGFuZTYsVGkoYywidkNsaXBQbGFuZTYiLGgpfWZ1bmN0aW9uIFRpKGMsZSx0KXt0JiZjLnNldEZsb2F0NChlLHQubm9ybWFsLngsdC5ub3JtYWwueSx0Lm5vcm1hbC56LHQuZCl9ZnVuY3Rpb24gYmkoYyxlLHQpe2xldCBpPSEwO2lmKGMpaWYoQXJyYXkuaXNBcnJheShlKSl7Y29uc3Qgcz0iI2RlZmluZSAiK3Q7aT1lLmluZGV4T2YocykhPT0tMSxpfHxlLnB1c2gocyl9ZWxzZSBpPWVbdF0sZVt0XT0hMDtyZXR1cm4haX1jbGFzcyBpZXtzdGF0aWMgQmluZFNjZW5lVW5pZm9ybUJ1ZmZlcihlLHQpe3QuYmluZFRvRWZmZWN0KGUsIlNjZW5lIil9c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYoZSx0LGkpe3QuX25lZWRVVnM9ITAsdFtpXT0hMCxlLm9wdGltaXplVVZBbGxvY2F0aW9uJiZlLmdldFRleHR1cmVNYXRyaXgoKS5pc0lkZW50aXR5QXMzeDIoKT8odFtpKyJESVJFQ1RVViJdPWUuY29vcmRpbmF0ZXNJbmRleCsxLHRbIk1BSU5VViIrKGUuY29vcmRpbmF0ZXNJbmRleCsxKV09ITApOnRbaSsiRElSRUNUVVYiXT0wfXN0YXRpYyBCaW5kVGV4dHVyZU1hdHJpeChlLHQsaSl7Y29uc3Qgcz1lLmdldFRleHR1cmVNYXRyaXgoKTt0LnVwZGF0ZU1hdHJpeChpKyJNYXRyaXgiLHMpfXN0YXRpYyBHZXRGb2dTdGF0ZShlLHQpe3JldHVybiB0LmZvZ0VuYWJsZWQmJmUuYXBwbHlGb2cmJnQuZm9nTW9kZSE9PW5lLkZPR01PREVfTk9ORX1zdGF0aWMgUHJlcGFyZURlZmluZXNGb3JNaXNjKGUsdCxpLHMscixuLGEpe2EuX2FyZU1pc2NEaXJ0eSYmKGEuTE9HQVJJVEhNSUNERVBUSD1pLGEuUE9JTlRTSVpFPXMsYS5GT0c9ciYmdGhpcy5HZXRGb2dTdGF0ZShlLHQpLGEuTk9OVU5JRk9STVNDQUxJTkc9ZS5ub25Vbmlmb3JtU2NhbGluZyxhLkFMUEhBVEVTVD1uKX1zdGF0aWMgUHJlcGFyZURlZmluZXNGb3JDYW1lcmEoZSx0KXtsZXQgaT0hMTtpZihlLmFjdGl2ZUNhbWVyYSl7Y29uc3Qgcz10LkNBTUVSQV9PUlRIT0dSQVBISUM/MTowLHI9dC5DQU1FUkFfUEVSU1BFQ1RJVkU/MTowLG49ZS5hY3RpdmVDYW1lcmEubW9kZT09PWouT1JUSE9HUkFQSElDX0NBTUVSQT8xOjAsYT1lLmFjdGl2ZUNhbWVyYS5tb2RlPT09ai5QRVJTUEVDVElWRV9DQU1FUkE/MTowOyhzXm58fHJeYSkmJih0LkNBTUVSQV9PUlRIT0dSQVBISUM9bj09PTEsdC5DQU1FUkFfUEVSU1BFQ1RJVkU9YT09PTEsaT0hMCl9cmV0dXJuIGl9c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yRnJhbWVCb3VuZFZhbHVlcyhlLHQsaSxzLHIsbj1udWxsLGE9ITEpe2xldCBvPWllLlByZXBhcmVEZWZpbmVzRm9yQ2FtZXJhKGUscyk7biE9PSExJiYobz1PcyhpLGUscykpLHMuREVQVEhQUkVQQVNTIT09IXQuZ2V0Q29sb3JXcml0ZSgpJiYocy5ERVBUSFBSRVBBU1M9IXMuREVQVEhQUkVQQVNTLG89ITApLHMuSU5TVEFOQ0VTIT09ciYmKHMuSU5TVEFOQ0VTPXIsbz0hMCkscy5USElOX0lOU1RBTkNFUyE9PWEmJihzLlRISU5fSU5TVEFOQ0VTPWEsbz0hMCksbyYmcy5tYXJrQXNVbnByb2Nlc3NlZCgpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckJvbmVzKGUsdCl7aWYoZS51c2VCb25lcyYmZS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJmUuc2tlbGV0b24pe3QuTlVNX0JPTkVfSU5GTFVFTkNFUlM9ZS5udW1Cb25lSW5mbHVlbmNlcnM7Y29uc3QgaT10LkJPTkVURVhUVVJFIT09dm9pZCAwO2lmKGUuc2tlbGV0b24uaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcyYmaSl0LkJPTkVURVhUVVJFPSEwO2Vsc2V7dC5Cb25lc1Blck1lc2g9ZS5za2VsZXRvbi5ib25lcy5sZW5ndGgrMSx0LkJPTkVURVhUVVJFPWk/ITE6dm9pZCAwO2NvbnN0IHM9ZS5nZXRTY2VuZSgpLnByZVBhc3NSZW5kZXJlcjtpZihzJiZzLmVuYWJsZWQpe2NvbnN0IHI9cy5leGNsdWRlZFNraW5uZWRNZXNoLmluZGV4T2YoZSk9PT0tMTt0LkJPTkVTX1ZFTE9DSVRZX0VOQUJMRUQ9cn19fWVsc2UgdC5OVU1fQk9ORV9JTkZMVUVOQ0VSUz0wLHQuQm9uZXNQZXJNZXNoPTAsdC5CT05FVEVYVFVSRSE9PXZvaWQgMCYmKHQuQk9ORVRFWFRVUkU9ITEpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0Zvck1vcnBoVGFyZ2V0cyhlLHQpe2NvbnN0IGk9ZS5tb3JwaFRhcmdldE1hbmFnZXI7aT8odC5NT1JQSFRBUkdFVFNfVVY9aS5zdXBwb3J0c1VWcyYmdC5VVjEsdC5NT1JQSFRBUkdFVFNfVEFOR0VOVD1pLnN1cHBvcnRzVGFuZ2VudHMmJnQuVEFOR0VOVCx0Lk1PUlBIVEFSR0VUU19OT1JNQUw9aS5zdXBwb3J0c05vcm1hbHMmJnQuTk9STUFMLHQuTU9SUEhUQVJHRVRTPWkubnVtSW5mbHVlbmNlcnM+MCx0Lk5VTV9NT1JQSF9JTkZMVUVOQ0VSUz1pLm51bUluZmx1ZW5jZXJzLHQuTU9SUEhUQVJHRVRTX1RFWFRVUkU9aS5pc1VzaW5nVGV4dHVyZUZvclRhcmdldHMpOih0Lk1PUlBIVEFSR0VUU19VVj0hMSx0Lk1PUlBIVEFSR0VUU19UQU5HRU5UPSExLHQuTU9SUEhUQVJHRVRTX05PUk1BTD0hMSx0Lk1PUlBIVEFSR0VUUz0hMSx0Lk5VTV9NT1JQSF9JTkZMVUVOQ0VSUz0wKX1zdGF0aWMgUHJlcGFyZURlZmluZXNGb3JCYWtlZFZlcnRleEFuaW1hdGlvbihlLHQpe2NvbnN0IGk9ZS5iYWtlZFZlcnRleEFuaW1hdGlvbk1hbmFnZXI7dC5CQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkU9ISEoaSYmaS5pc0VuYWJsZWQpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckF0dHJpYnV0ZXMoZSx0LGkscyxyPSExLG49ITAsYT0hMCl7aWYoIXQuX2FyZUF0dHJpYnV0ZXNEaXJ0eSYmdC5fbmVlZE5vcm1hbHM9PT10Ll9ub3JtYWxzJiZ0Ll9uZWVkVVZzPT09dC5fdXZzKXJldHVybiExO3QuX25vcm1hbHM9dC5fbmVlZE5vcm1hbHMsdC5fdXZzPXQuX25lZWRVVnMsdC5OT1JNQUw9dC5fbmVlZE5vcm1hbHMmJmUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCksdC5fbmVlZE5vcm1hbHMmJmUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVGFuZ2VudEtpbmQpJiYodC5UQU5HRU5UPSEwKTtmb3IobGV0IG89MTtvPD02Oysrbyl0WyJVViIrb109dC5fbmVlZFVWcz9lLmlzVmVydGljZXNEYXRhUHJlc2VudChgdXYke289PT0xPyIiOm99YCk6ITE7aWYoaSl7Y29uc3Qgbz1lLnVzZVZlcnRleENvbG9ycyYmZS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Db2xvcktpbmQpO3QuVkVSVEVYQ09MT1I9byx0LlZFUlRFWEFMUEhBPWUuaGFzVmVydGV4QWxwaGEmJm8mJm59cmV0dXJuIGUuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuQ29sb3JJbnN0YW5jZUtpbmQpJiYoZS5oYXNJbnN0YW5jZXN8fGUuaGFzVGhpbkluc3RhbmNlcykmJih0LklOU1RBTkNFU0NPTE9SPSEwKSxzJiZ0aGlzLlByZXBhcmVEZWZpbmVzRm9yQm9uZXMoZSx0KSxyJiZ0aGlzLlByZXBhcmVEZWZpbmVzRm9yTW9ycGhUYXJnZXRzKGUsdCksYSYmdGhpcy5QcmVwYXJlRGVmaW5lc0ZvckJha2VkVmVydGV4QW5pbWF0aW9uKGUsdCksITB9c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yTXVsdGl2aWV3KGUsdCl7aWYoZS5hY3RpdmVDYW1lcmEpe2NvbnN0IGk9dC5NVUxUSVZJRVc7dC5NVUxUSVZJRVc9ZS5hY3RpdmVDYW1lcmEub3V0cHV0UmVuZGVyVGFyZ2V0IT09bnVsbCYmZS5hY3RpdmVDYW1lcmEub3V0cHV0UmVuZGVyVGFyZ2V0LmdldFZpZXdDb3VudCgpPjEsdC5NVUxUSVZJRVchPWkmJnQubWFya0FzVW5wcm9jZXNzZWQoKX19c3RhdGljIFByZXBhcmVEZWZpbmVzRm9yT0lUKGUsdCxpKXtjb25zdCBzPXQuT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZLHI9dC5PUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1lfMTZCSVRTO3QuT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZPWUudXNlT3JkZXJJbmRlcGVuZGVudFRyYW5zcGFyZW5jeSYmaSx0Lk9SREVSX0lOREVQRU5ERU5UX1RSQU5TUEFSRU5DWV8xNkJJVFM9IWUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnRleHR1cmVGbG9hdExpbmVhckZpbHRlcmluZywocyE9PXQuT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZfHxyIT09dC5PUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1lfMTZCSVRTKSYmdC5tYXJrQXNVbnByb2Nlc3NlZCgpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvclByZVBhc3MoZSx0LGkpe2NvbnN0IHM9dC5QUkVQQVNTO2lmKCF0Ll9hcmVQcmVQYXNzRGlydHkpcmV0dXJuO2NvbnN0IHI9W3t0eXBlOjEsZGVmaW5lOiJQUkVQQVNTX1BPU0lUSU9OIixpbmRleDoiUFJFUEFTU19QT1NJVElPTl9JTkRFWCJ9LHt0eXBlOjIsZGVmaW5lOiJQUkVQQVNTX1ZFTE9DSVRZIixpbmRleDoiUFJFUEFTU19WRUxPQ0lUWV9JTkRFWCJ9LHt0eXBlOjMsZGVmaW5lOiJQUkVQQVNTX1JFRkxFQ1RJVklUWSIsaW5kZXg6IlBSRVBBU1NfUkVGTEVDVElWSVRZX0lOREVYIn0se3R5cGU6MCxkZWZpbmU6IlBSRVBBU1NfSVJSQURJQU5DRSIsaW5kZXg6IlBSRVBBU1NfSVJSQURJQU5DRV9JTkRFWCJ9LHt0eXBlOjcsZGVmaW5lOiJQUkVQQVNTX0FMQkVET19TUVJUIixpbmRleDoiUFJFUEFTU19BTEJFRE9fU1FSVF9JTkRFWCJ9LHt0eXBlOjUsZGVmaW5lOiJQUkVQQVNTX0RFUFRIIixpbmRleDoiUFJFUEFTU19ERVBUSF9JTkRFWCJ9LHt0eXBlOjYsZGVmaW5lOiJQUkVQQVNTX05PUk1BTCIsaW5kZXg6IlBSRVBBU1NfTk9STUFMX0lOREVYIn1dO2lmKGUucHJlUGFzc1JlbmRlcmVyJiZlLnByZVBhc3NSZW5kZXJlci5lbmFibGVkJiZpKXt0LlBSRVBBU1M9ITAsdC5TQ0VORV9NUlRfQ09VTlQ9ZS5wcmVQYXNzUmVuZGVyZXIubXJ0Q291bnQ7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKyspe2NvbnN0IGE9ZS5wcmVQYXNzUmVuZGVyZXIuZ2V0SW5kZXgocltuXS50eXBlKTthIT09LTE/KHRbcltuXS5kZWZpbmVdPSEwLHRbcltuXS5pbmRleF09YSk6dFtyW25dLmRlZmluZV09ITF9fWVsc2V7dC5QUkVQQVNTPSExO2ZvcihsZXQgbj0wO248ci5sZW5ndGg7bisrKXRbcltuXS5kZWZpbmVdPSExfXQuUFJFUEFTUyE9cyYmKHQubWFya0FzVW5wcm9jZXNzZWQoKSx0Lm1hcmtBc0ltYWdlUHJvY2Vzc2luZ0RpcnR5KCkpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckxpZ2h0KGUsdCxpLHMscixuLGEpe3ZhciBvO3N3aXRjaChhLm5lZWROb3JtYWxzPSEwLHJbIkxJR0hUIitzXT09PXZvaWQgMCYmKGEubmVlZFJlYnVpbGQ9ITApLHJbIkxJR0hUIitzXT0hMCxyWyJTUE9UTElHSFQiK3NdPSExLHJbIkhFTUlMSUdIVCIrc109ITEsclsiUE9JTlRMSUdIVCIrc109ITEsclsiRElSTElHSFQiK3NdPSExLGkucHJlcGFyZUxpZ2h0U3BlY2lmaWNEZWZpbmVzKHIscyksclsiTElHSFRfRkFMTE9GRl9QSFlTSUNBTCIrc109ITEsclsiTElHSFRfRkFMTE9GRl9HTFRGIitzXT0hMSxyWyJMSUdIVF9GQUxMT0ZGX1NUQU5EQVJEIitzXT0hMSxpLmZhbGxvZmZUeXBlKXtjYXNlIEVlLkZBTExPRkZfR0xURjpyWyJMSUdIVF9GQUxMT0ZGX0dMVEYiK3NdPSEwO2JyZWFrO2Nhc2UgRWUuRkFMTE9GRl9QSFlTSUNBTDpyWyJMSUdIVF9GQUxMT0ZGX1BIWVNJQ0FMIitzXT0hMDticmVhaztjYXNlIEVlLkZBTExPRkZfU1RBTkRBUkQ6clsiTElHSFRfRkFMTE9GRl9TVEFOREFSRCIrc109ITA7YnJlYWt9aWYobiYmIWkuc3BlY3VsYXIuZXF1YWxzRmxvYXRzKDAsMCwwKSYmKGEuc3BlY3VsYXJFbmFibGVkPSEwKSxyWyJTSEFET1ciK3NdPSExLHJbIlNIQURPV0NTTSIrc109ITEsclsiU0hBRE9XQ1NNREVCVUciK3NdPSExLHJbIlNIQURPV0NTTU5VTV9DQVNDQURFUyIrc109ITEsclsiU0hBRE9XQ1NNVVNFU0hBRE9XTUFYWiIrc109ITEsclsiU0hBRE9XQ1NNTk9CTEVORCIrc109ITEsclsiU0hBRE9XQ1NNX1JJR0hUSEFOREVEIitzXT0hMSxyWyJTSEFET1dQQ0YiK3NdPSExLHJbIlNIQURPV1BDU1MiK3NdPSExLHJbIlNIQURPV1BPSVNTT04iK3NdPSExLHJbIlNIQURPV0VTTSIrc109ITEsclsiU0hBRE9XQ0xPU0VFU00iK3NdPSExLHJbIlNIQURPV0NVQkUiK3NdPSExLHJbIlNIQURPV0xPV1FVQUxJVFkiK3NdPSExLHJbIlNIQURPV01FRElVTVFVQUxJVFkiK3NdPSExLHQmJnQucmVjZWl2ZVNoYWRvd3MmJmUuc2hhZG93c0VuYWJsZWQmJmkuc2hhZG93RW5hYmxlZCl7Y29uc3QgaD0obz1pLmdldFNoYWRvd0dlbmVyYXRvcihlLmFjdGl2ZUNhbWVyYSkpIT09bnVsbCYmbyE9PXZvaWQgMD9vOmkuZ2V0U2hhZG93R2VuZXJhdG9yKCk7aWYoaCl7Y29uc3QgbD1oLmdldFNoYWRvd01hcCgpO2wmJmwucmVuZGVyTGlzdCYmbC5yZW5kZXJMaXN0Lmxlbmd0aD4wJiYoYS5zaGFkb3dFbmFibGVkPSEwLGgucHJlcGFyZURlZmluZXMocixzKSl9fWkubGlnaHRtYXBNb2RlIT1FZS5MSUdIVE1BUF9ERUZBVUxUPyhhLmxpZ2h0bWFwTW9kZT0hMCxyWyJMSUdIVE1BUEVYQ0xVREVEIitzXT0hMCxyWyJMSUdIVE1BUE5PU1BFQ1VMQVIiK3NdPWkubGlnaHRtYXBNb2RlPT1FZS5MSUdIVE1BUF9TSEFET1dTT05MWSk6KHJbIkxJR0hUTUFQRVhDTFVERUQiK3NdPSExLHJbIkxJR0hUTUFQTk9TUEVDVUxBUiIrc109ITEpfXN0YXRpYyBQcmVwYXJlRGVmaW5lc0ZvckxpZ2h0cyhlLHQsaSxzLHI9NCxuPSExKXtpZighaS5fYXJlTGlnaHRzRGlydHkpcmV0dXJuIGkuX25lZWROb3JtYWxzO2xldCBhPTA7Y29uc3Qgbz17bmVlZE5vcm1hbHM6aS5fbmVlZE5vcm1hbHMsbmVlZFJlYnVpbGQ6ITEsbGlnaHRtYXBNb2RlOiExLHNoYWRvd0VuYWJsZWQ6ITEsc3BlY3VsYXJFbmFibGVkOiExfTtpZihlLmxpZ2h0c0VuYWJsZWQmJiFuKXtmb3IoY29uc3QgbCBvZiB0LmxpZ2h0U291cmNlcylpZih0aGlzLlByZXBhcmVEZWZpbmVzRm9yTGlnaHQoZSx0LGwsYSxpLHMsbyksYSsrLGE9PT1yKWJyZWFrfWkuU1BFQ1VMQVJURVJNPW8uc3BlY3VsYXJFbmFibGVkLGkuU0hBRE9XUz1vLnNoYWRvd0VuYWJsZWQ7Zm9yKGxldCBsPWE7bDxyO2wrKylpWyJMSUdIVCIrbF0hPT12b2lkIDAmJihpWyJMSUdIVCIrbF09ITEsaVsiSEVNSUxJR0hUIitsXT0hMSxpWyJQT0lOVExJR0hUIitsXT0hMSxpWyJESVJMSUdIVCIrbF09ITEsaVsiU1BPVExJR0hUIitsXT0hMSxpWyJTSEFET1ciK2xdPSExLGlbIlNIQURPV0NTTSIrbF09ITEsaVsiU0hBRE9XQ1NNREVCVUciK2xdPSExLGlbIlNIQURPV0NTTU5VTV9DQVNDQURFUyIrbF09ITEsaVsiU0hBRE9XQ1NNVVNFU0hBRE9XTUFYWiIrbF09ITEsaVsiU0hBRE9XQ1NNTk9CTEVORCIrbF09ITEsaVsiU0hBRE9XQ1NNX1JJR0hUSEFOREVEIitsXT0hMSxpWyJTSEFET1dQQ0YiK2xdPSExLGlbIlNIQURPV1BDU1MiK2xdPSExLGlbIlNIQURPV1BPSVNTT04iK2xdPSExLGlbIlNIQURPV0VTTSIrbF09ITEsaVsiU0hBRE9XQ0xPU0VFU00iK2xdPSExLGlbIlNIQURPV0NVQkUiK2xdPSExLGlbIlNIQURPV0xPV1FVQUxJVFkiK2xdPSExLGlbIlNIQURPV01FRElVTVFVQUxJVFkiK2xdPSExKTtjb25zdCBoPWUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpO3JldHVybiBpLlNIQURPV0ZMT0FUPT09dm9pZCAwJiYoby5uZWVkUmVidWlsZD0hMCksaS5TSEFET1dGTE9BVD1vLnNoYWRvd0VuYWJsZWQmJihoLnRleHR1cmVGbG9hdFJlbmRlciYmaC50ZXh0dXJlRmxvYXRMaW5lYXJGaWx0ZXJpbmd8fGgudGV4dHVyZUhhbGZGbG9hdFJlbmRlciYmaC50ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nKSxpLkxJR0hUTUFQRVhDTFVERUQ9by5saWdodG1hcE1vZGUsby5uZWVkUmVidWlsZCYmaS5yZWJ1aWxkKCksby5uZWVkTm9ybWFsc31zdGF0aWMgUHJlcGFyZVVuaWZvcm1zQW5kU2FtcGxlcnNGb3JMaWdodChlLHQsaSxzLHI9bnVsbCxuPSExKXtyJiZyLnB1c2goIkxpZ2h0IitlKSwhbiYmKHQucHVzaCgidkxpZ2h0RGF0YSIrZSwidkxpZ2h0RGlmZnVzZSIrZSwidkxpZ2h0U3BlY3VsYXIiK2UsInZMaWdodERpcmVjdGlvbiIrZSwidkxpZ2h0RmFsbG9mZiIrZSwidkxpZ2h0R3JvdW5kIitlLCJsaWdodE1hdHJpeCIrZSwic2hhZG93c0luZm8iK2UsImRlcHRoVmFsdWVzIitlKSxpLnB1c2goInNoYWRvd1NhbXBsZXIiK2UpLGkucHVzaCgiZGVwdGhTYW1wbGVyIitlKSx0LnB1c2goInZpZXdGcnVzdHVtWiIrZSwiY2FzY2FkZUJsZW5kRmFjdG9yIitlLCJsaWdodFNpemVVVkNvcnJlY3Rpb24iK2UsImRlcHRoQ29ycmVjdGlvbiIrZSwicGVudW1icmFEYXJrbmVzcyIrZSwiZnJ1c3R1bUxlbmd0aHMiK2UpLHMmJihpLnB1c2goInByb2plY3Rpb25MaWdodFNhbXBsZXIiK2UpLHQucHVzaCgidGV4dHVyZVByb2plY3Rpb25NYXRyaXgiK2UpKSl9c3RhdGljIFByZXBhcmVVbmlmb3Jtc0FuZFNhbXBsZXJzTGlzdChlLHQsaSxzPTQpe2xldCByLG49bnVsbDtpZihlLnVuaWZvcm1zTmFtZXMpe2NvbnN0IGE9ZTtyPWEudW5pZm9ybXNOYW1lcyxuPWEudW5pZm9ybUJ1ZmZlcnNOYW1lcyx0PWEuc2FtcGxlcnMsaT1hLmRlZmluZXMscz1hLm1heFNpbXVsdGFuZW91c0xpZ2h0c3x8MH1lbHNlIHI9ZSx0fHwodD1bXSk7Zm9yKGxldCBhPTA7YTxzJiZpWyJMSUdIVCIrYV07YSsrKXRoaXMuUHJlcGFyZVVuaWZvcm1zQW5kU2FtcGxlcnNGb3JMaWdodChhLHIsdCxpWyJQUk9KRUNURURMSUdIVFRFWFRVUkUiK2FdLG4pO2kuTlVNX01PUlBIX0lORkxVRU5DRVJTJiZyLnB1c2goIm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyIpLGkuQkFLRURfVkVSVEVYX0FOSU1BVElPTl9URVhUVVJFJiYoci5wdXNoKCJiYWtlZFZlcnRleEFuaW1hdGlvblNldHRpbmdzIiksci5wdXNoKCJiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmVTaXplSW52ZXJ0ZWQiKSxyLnB1c2goImJha2VkVmVydGV4QW5pbWF0aW9uVGltZSIpLHQucHVzaCgiYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlIikpfXN0YXRpYyBIYW5kbGVGYWxsYmFja3NGb3JTaGFkb3dzKGUsdCxpPTQscz0wKXtsZXQgcj0wO2ZvcihsZXQgbj0wO248aSYmZVsiTElHSFQiK25dO24rKyluPjAmJihyPXMrbix0LmFkZEZhbGxiYWNrKHIsIkxJR0hUIituKSksZS5TSEFET1dTfHwoZVsiU0hBRE9XIituXSYmdC5hZGRGYWxsYmFjayhzLCJTSEFET1ciK24pLGVbIlNIQURPV1BDRiIrbl0mJnQuYWRkRmFsbGJhY2socywiU0hBRE9XUENGIituKSxlWyJTSEFET1dQQ1NTIituXSYmdC5hZGRGYWxsYmFjayhzLCJTSEFET1dQQ1NTIituKSxlWyJTSEFET1dQT0lTU09OIituXSYmdC5hZGRGYWxsYmFjayhzLCJTSEFET1dQT0lTU09OIituKSxlWyJTSEFET1dFU00iK25dJiZ0LmFkZEZhbGxiYWNrKHMsIlNIQURPV0VTTSIrbiksZVsiU0hBRE9XQ0xPU0VFU00iK25dJiZ0LmFkZEZhbGxiYWNrKHMsIlNIQURPV0NMT1NFRVNNIituKSk7cmV0dXJuIHIrK31zdGF0aWMgUHJlcGFyZUF0dHJpYnV0ZXNGb3JNb3JwaFRhcmdldHNJbmZsdWVuY2VycyhlLHQsaSl7dGhpcy5fVG1wTW9ycGhJbmZsdWVuY2Vycy5OVU1fTU9SUEhfSU5GTFVFTkNFUlM9aSx0aGlzLlByZXBhcmVBdHRyaWJ1dGVzRm9yTW9ycGhUYXJnZXRzKGUsdCx0aGlzLl9UbXBNb3JwaEluZmx1ZW5jZXJzKX1zdGF0aWMgUHJlcGFyZUF0dHJpYnV0ZXNGb3JNb3JwaFRhcmdldHMoZSx0LGkpe2NvbnN0IHM9aS5OVU1fTU9SUEhfSU5GTFVFTkNFUlM7aWYocz4wJiZmZS5MYXN0Q3JlYXRlZEVuZ2luZSl7Y29uc3Qgcj1mZS5MYXN0Q3JlYXRlZEVuZ2luZS5nZXRDYXBzKCkubWF4VmVydGV4QXR0cmlicyxuPXQubW9ycGhUYXJnZXRNYW5hZ2VyO2lmKG4hPW51bGwmJm4uaXNVc2luZ1RleHR1cmVGb3JUYXJnZXRzKXJldHVybjtjb25zdCBhPW4mJm4uc3VwcG9ydHNOb3JtYWxzJiZpLk5PUk1BTCxvPW4mJm4uc3VwcG9ydHNUYW5nZW50cyYmaS5UQU5HRU5ULGg9biYmbi5zdXBwb3J0c1VWcyYmaS5VVjE7Zm9yKGxldCBsPTA7bDxzO2wrKyllLnB1c2goZy5Qb3NpdGlvbktpbmQrbCksYSYmZS5wdXNoKGcuTm9ybWFsS2luZCtsKSxvJiZlLnB1c2goZy5UYW5nZW50S2luZCtsKSxoJiZlLnB1c2goZy5VVktpbmQrIl8iK2wpLGUubGVuZ3RoPnImJk8uRXJyb3IoIkNhbm5vdCBhZGQgbW9yZSB2ZXJ0ZXggYXR0cmlidXRlcyBmb3IgbWVzaCAiK3QubmFtZSl9fXN0YXRpYyBQcmVwYXJlQXR0cmlidXRlc0ZvckJha2VkVmVydGV4QW5pbWF0aW9uKGUsdCxpKXtpLkJBS0VEX1ZFUlRFWF9BTklNQVRJT05fVEVYVFVSRSYmaS5JTlNUQU5DRVMmJmUucHVzaCgiYmFrZWRWZXJ0ZXhBbmltYXRpb25TZXR0aW5nc0luc3RhbmNlZCIpfXN0YXRpYyBQcmVwYXJlQXR0cmlidXRlc0ZvckJvbmVzKGUsdCxpLHMpe2kuTlVNX0JPTkVfSU5GTFVFTkNFUlM+MCYmKHMuYWRkQ1BVU2tpbm5pbmdGYWxsYmFjaygwLHQpLGUucHVzaChnLk1hdHJpY2VzSW5kaWNlc0tpbmQpLGUucHVzaChnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpLGkuTlVNX0JPTkVfSU5GTFVFTkNFUlM+NCYmKGUucHVzaChnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCksZS5wdXNoKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSkpfXN0YXRpYyBQcmVwYXJlQXR0cmlidXRlc0Zvckluc3RhbmNlcyhlLHQpeyh0LklOU1RBTkNFU3x8dC5USElOX0lOU1RBTkNFUykmJnRoaXMuUHVzaEF0dHJpYnV0ZXNGb3JJbnN0YW5jZXMoZSwhIXQuUFJFUEFTU19WRUxPQ0lUWSksdC5JTlNUQU5DRVNDT0xPUiYmZS5wdXNoKGcuQ29sb3JJbnN0YW5jZUtpbmQpfXN0YXRpYyBQdXNoQXR0cmlidXRlc0Zvckluc3RhbmNlcyhlLHQ9ITEpe2UucHVzaCgid29ybGQwIiksZS5wdXNoKCJ3b3JsZDEiKSxlLnB1c2goIndvcmxkMiIpLGUucHVzaCgid29ybGQzIiksdCYmKGUucHVzaCgicHJldmlvdXNXb3JsZDAiKSxlLnB1c2goInByZXZpb3VzV29ybGQxIiksZS5wdXNoKCJwcmV2aW91c1dvcmxkMiIpLGUucHVzaCgicHJldmlvdXNXb3JsZDMiKSl9c3RhdGljIEJpbmRMaWdodFByb3BlcnRpZXMoZSx0LGkpe2UudHJhbnNmZXJUb0VmZmVjdCh0LGkrIiIpfXN0YXRpYyBCaW5kTGlnaHQoZSx0LGkscyxyLG49ITApe2UuX2JpbmRMaWdodCh0LGkscyxyLG4pfXN0YXRpYyBCaW5kTGlnaHRzKGUsdCxpLHMscj00KXtjb25zdCBuPU1hdGgubWluKHQubGlnaHRTb3VyY2VzLmxlbmd0aCxyKTtmb3IobGV0IGE9MDthPG47YSsrKXtjb25zdCBvPXQubGlnaHRTb3VyY2VzW2FdO3RoaXMuQmluZExpZ2h0KG8sYSxlLGksdHlwZW9mIHM9PSJib29sZWFuIj9zOnMuU1BFQ1VMQVJURVJNLHQucmVjZWl2ZVNoYWRvd3MpfX1zdGF0aWMgQmluZEZvZ1BhcmFtZXRlcnMoZSx0LGkscz0hMSl7ZS5mb2dFbmFibGVkJiZ0LmFwcGx5Rm9nJiZlLmZvZ01vZGUhPT1uZS5GT0dNT0RFX05PTkUmJihpLnNldEZsb2F0NCgidkZvZ0luZm9zIixlLmZvZ01vZGUsZS5mb2dTdGFydCxlLmZvZ0VuZCxlLmZvZ0RlbnNpdHkpLHM/KGUuZm9nQ29sb3IudG9MaW5lYXJTcGFjZVRvUmVmKHRoaXMuX1RlbXBGb2dDb2xvciksaS5zZXRDb2xvcjMoInZGb2dDb2xvciIsdGhpcy5fVGVtcEZvZ0NvbG9yKSk6aS5zZXRDb2xvcjMoInZGb2dDb2xvciIsZS5mb2dDb2xvcikpfXN0YXRpYyBCaW5kQm9uZXNQYXJhbWV0ZXJzKGUsdCxpKXtpZighKCF0fHwhZSkmJihlLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmdC5fYm9uZXNDb21wdXRhdGlvbkZvcmNlZFRvQ1BVJiYoZS5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM9ITEpLGUudXNlQm9uZXMmJmUuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzJiZlLnNrZWxldG9uKSl7Y29uc3Qgcz1lLnNrZWxldG9uO2lmKHMuaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcyYmdC5nZXRVbmlmb3JtSW5kZXgoImJvbmVUZXh0dXJlV2lkdGgiKT4tMSl7Y29uc3Qgcj1zLmdldFRyYW5zZm9ybU1hdHJpeFRleHR1cmUoZSk7dC5zZXRUZXh0dXJlKCJib25lU2FtcGxlciIsciksdC5zZXRGbG9hdCgiYm9uZVRleHR1cmVXaWR0aCIsNCoocy5ib25lcy5sZW5ndGgrMSkpfWVsc2V7Y29uc3Qgcj1zLmdldFRyYW5zZm9ybU1hdHJpY2VzKGUpO3ImJih0LnNldE1hdHJpY2VzKCJtQm9uZXMiLHIpLGkmJmUuZ2V0U2NlbmUoKS5wcmVQYXNzUmVuZGVyZXImJmUuZ2V0U2NlbmUoKS5wcmVQYXNzUmVuZGVyZXIuZ2V0SW5kZXgoMikmJihpLnByZXZpb3VzQm9uZXNbZS51bmlxdWVJZF18fChpLnByZXZpb3VzQm9uZXNbZS51bmlxdWVJZF09ci5zbGljZSgpKSx0LnNldE1hdHJpY2VzKCJtUHJldmlvdXNCb25lcyIsaS5wcmV2aW91c0JvbmVzW2UudW5pcXVlSWRdKSxpZS5fQ29weUJvbmVzVHJhbnNmb3JtYXRpb25NYXRyaWNlcyhyLGkucHJldmlvdXNCb25lc1tlLnVuaXF1ZUlkXSkpKX19fXN0YXRpYyBfQ29weUJvbmVzVHJhbnNmb3JtYXRpb25NYXRyaWNlcyhlLHQpe3JldHVybiB0LnNldChlKSx0fXN0YXRpYyBCaW5kTW9ycGhUYXJnZXRQYXJhbWV0ZXJzKGUsdCl7Y29uc3QgaT1lLm1vcnBoVGFyZ2V0TWFuYWdlcjshZXx8IWl8fHQuc2V0RmxvYXRBcnJheSgibW9ycGhUYXJnZXRJbmZsdWVuY2VzIixpLmluZmx1ZW5jZXMpfXN0YXRpYyBCaW5kTG9nRGVwdGgoZSx0LGkpe2lmKCFlfHxlLkxPR0FSSVRITUlDREVQVEh8fGUuaW5kZXhPZiYmZS5pbmRleE9mKCJMT0dBUklUSE1JQ0RFUFRIIik+PTApe2NvbnN0IHM9aS5hY3RpdmVDYW1lcmE7cy5tb2RlPT09ai5PUlRIT0dSQVBISUNfQ0FNRVJBJiZPLkVycm9yKCJMb2dhcml0aG1pYyBkZXB0aCBpcyBub3QgY29tcGF0aWJsZSB3aXRoIG9ydGhvZ3JhcGhpYyBjYW1lcmFzISIsMjApLHQuc2V0RmxvYXQoImxvZ2FyaXRobWljRGVwdGhDb25zdGFudCIsMi8oTWF0aC5sb2cocy5tYXhaKzEpL01hdGguTE4yKSl9fX1pZS5fVG1wTW9ycGhJbmZsdWVuY2Vycz17TlVNX01PUlBIX0lORkxVRU5DRVJTOjB9LGllLl9UZW1wRm9nQ29sb3I9cmUuQmxhY2soKTtjbGFzcyBXdHtjb25zdHJ1Y3Rvcigpe3RoaXMucmVzZXQoKX1yZXNldCgpe3RoaXMuZW5hYmxlZD0hMSx0aGlzLm1hc2s9MjU1LHRoaXMuZnVuYz01MTksdGhpcy5mdW5jUmVmPTEsdGhpcy5mdW5jTWFzaz0yNTUsdGhpcy5vcFN0ZW5jaWxGYWlsPTc2ODAsdGhpcy5vcERlcHRoRmFpbD03NjgwLHRoaXMub3BTdGVuY2lsRGVwdGhQYXNzPTc2ODF9Z2V0IGZ1bmMoKXtyZXR1cm4gdGhpcy5fZnVuY31zZXQgZnVuYyhlKXt0aGlzLl9mdW5jPWV9Z2V0IGZ1bmNSZWYoKXtyZXR1cm4gdGhpcy5fZnVuY1JlZn1zZXQgZnVuY1JlZihlKXt0aGlzLl9mdW5jUmVmPWV9Z2V0IGZ1bmNNYXNrKCl7cmV0dXJuIHRoaXMuX2Z1bmNNYXNrfXNldCBmdW5jTWFzayhlKXt0aGlzLl9mdW5jTWFzaz1lfWdldCBvcFN0ZW5jaWxGYWlsKCl7cmV0dXJuIHRoaXMuX29wU3RlbmNpbEZhaWx9c2V0IG9wU3RlbmNpbEZhaWwoZSl7dGhpcy5fb3BTdGVuY2lsRmFpbD1lfWdldCBvcERlcHRoRmFpbCgpe3JldHVybiB0aGlzLl9vcERlcHRoRmFpbH1zZXQgb3BEZXB0aEZhaWwoZSl7dGhpcy5fb3BEZXB0aEZhaWw9ZX1nZXQgb3BTdGVuY2lsRGVwdGhQYXNzKCl7cmV0dXJuIHRoaXMuX29wU3RlbmNpbERlcHRoUGFzc31zZXQgb3BTdGVuY2lsRGVwdGhQYXNzKGUpe3RoaXMuX29wU3RlbmNpbERlcHRoUGFzcz1lfWdldCBtYXNrKCl7cmV0dXJuIHRoaXMuX21hc2t9c2V0IG1hc2soZSl7dGhpcy5fbWFzaz1lfWdldCBlbmFibGVkKCl7cmV0dXJuIHRoaXMuX2VuYWJsZWR9c2V0IGVuYWJsZWQoZSl7dGhpcy5fZW5hYmxlZD1lfWdldENsYXNzTmFtZSgpe3JldHVybiJNYXRlcmlhbFN0ZW5jaWxTdGF0ZSJ9Y29weVRvKGUpe2FlLkNsb25lKCgpPT5lLHRoaXMpfXNlcmlhbGl6ZSgpe3JldHVybiBhZS5TZXJpYWxpemUodGhpcyl9cGFyc2UoZSx0LGkpe2FlLlBhcnNlKCgpPT50aGlzLGUsdCxpKX19VChbUigpXSxXdC5wcm90b3R5cGUsImZ1bmMiLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJmdW5jUmVmIixudWxsKSxUKFtSKCldLFd0LnByb3RvdHlwZSwiZnVuY01hc2siLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJvcFN0ZW5jaWxGYWlsIixudWxsKSxUKFtSKCldLFd0LnByb3RvdHlwZSwib3BEZXB0aEZhaWwiLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJvcFN0ZW5jaWxEZXB0aFBhc3MiLG51bGwpLFQoW1IoKV0sV3QucHJvdG90eXBlLCJtYXNrIixudWxsKSxUKFtSKCldLFd0LnByb3RvdHlwZSwiZW5hYmxlZCIsbnVsbCk7dmFyIFFlOyhmdW5jdGlvbihjKXtjW2MuQ3JlYXRlZD0xXT0iQ3JlYXRlZCIsY1tjLkRpc3Bvc2VkPTJdPSJEaXNwb3NlZCIsY1tjLkdldERlZmluZU5hbWVzPTRdPSJHZXREZWZpbmVOYW1lcyIsY1tjLlByZXBhcmVVbmlmb3JtQnVmZmVyPThdPSJQcmVwYXJlVW5pZm9ybUJ1ZmZlciIsY1tjLklzUmVhZHlGb3JTdWJNZXNoPTE2XT0iSXNSZWFkeUZvclN1Yk1lc2giLGNbYy5QcmVwYXJlRGVmaW5lcz0zMl09IlByZXBhcmVEZWZpbmVzIixjW2MuQmluZEZvclN1Yk1lc2g9NjRdPSJCaW5kRm9yU3ViTWVzaCIsY1tjLlByZXBhcmVFZmZlY3Q9MTI4XT0iUHJlcGFyZUVmZmVjdCIsY1tjLkdldEFuaW1hdGFibGVzPTI1Nl09IkdldEFuaW1hdGFibGVzIixjW2MuR2V0QWN0aXZlVGV4dHVyZXM9NTEyXT0iR2V0QWN0aXZlVGV4dHVyZXMiLGNbYy5IYXNUZXh0dXJlPTEwMjRdPSJIYXNUZXh0dXJlIixjW2MuRmlsbFJlbmRlclRhcmdldFRleHR1cmVzPTIwNDhdPSJGaWxsUmVuZGVyVGFyZ2V0VGV4dHVyZXMiLGNbYy5IYXNSZW5kZXJUYXJnZXRUZXh0dXJlcz00MDk2XT0iSGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXMiLGNbYy5IYXJkQmluZEZvclN1Yk1lc2g9ODE5Ml09IkhhcmRCaW5kRm9yU3ViTWVzaCJ9KShRZXx8KFFlPXt9KSk7Y2xhc3MgUHtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5zaGFkb3dEZXB0aFdyYXBwZXI9bnVsbCx0aGlzLmFsbG93U2hhZGVySG90U3dhcHBpbmc9ITAsdGhpcy5tZXRhZGF0YT1udWxsLHRoaXMucmVzZXJ2ZWREYXRhU3RvcmU9bnVsbCx0aGlzLmNoZWNrUmVhZHlPbkV2ZXJ5Q2FsbD0hMSx0aGlzLmNoZWNrUmVhZHlPbmx5T25jZT0hMSx0aGlzLnN0YXRlPSIiLHRoaXMuX2FscGhhPTEsdGhpcy5fYmFja0ZhY2VDdWxsaW5nPSEwLHRoaXMuX2N1bGxCYWNrRmFjZXM9ITAsdGhpcy5fYmxvY2tEaXJ0eU1lY2hhbmlzbT0hMSx0aGlzLm9uQ29tcGlsZWQ9bnVsbCx0aGlzLm9uRXJyb3I9bnVsbCx0aGlzLmdldFJlbmRlclRhcmdldFRleHR1cmVzPW51bGwsdGhpcy5kb05vdFNlcmlhbGl6ZT0hMSx0aGlzLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzPSExLHRoaXMuYW5pbWF0aW9ucz1udWxsLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj1udWxsLHRoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZT1udWxsLHRoaXMuX29uQmluZE9ic2VydmVyPW51bGwsdGhpcy5fYWxwaGFNb2RlPTIsdGhpcy5fbmVlZERlcHRoUHJlUGFzcz0hMSx0aGlzLmRpc2FibGVEZXB0aFdyaXRlPSExLHRoaXMuZGlzYWJsZUNvbG9yV3JpdGU9ITEsdGhpcy5mb3JjZURlcHRoV3JpdGU9ITEsdGhpcy5kZXB0aEZ1bmN0aW9uPTAsdGhpcy5zZXBhcmF0ZUN1bGxpbmdQYXNzPSExLHRoaXMuX2ZvZ0VuYWJsZWQ9ITAsdGhpcy5wb2ludFNpemU9MSx0aGlzLnpPZmZzZXQ9MCx0aGlzLnpPZmZzZXRVbml0cz0wLHRoaXMuc3RlbmNpbD1uZXcgV3QsdGhpcy5fdXNlVUJPPSExLHRoaXMuX2ZpbGxNb2RlPVAuVHJpYW5nbGVGaWxsTW9kZSx0aGlzLl9jYWNoZWREZXB0aFdyaXRlU3RhdGU9ITEsdGhpcy5fY2FjaGVkQ29sb3JXcml0ZVN0YXRlPSExLHRoaXMuX2NhY2hlZERlcHRoRnVuY3Rpb25TdGF0ZT0wLHRoaXMuX2luZGV4SW5TY2VuZU1hdGVyaWFsQXJyYXk9LTEsdGhpcy5tZXNoTWFwPW51bGwsdGhpcy5fcGFyZW50Q29udGFpbmVyPW51bGwsdGhpcy5fdW5pZm9ybUJ1ZmZlckxheW91dEJ1aWx0PSExLHRoaXMuX2V2ZW50SW5mbz17fSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50R2VuZXJpYz0oKT0+e30sdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudElzUmVhZHlGb3JTdWJNZXNoPSgpPT57fSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50UHJlcGFyZURlZmluZXM9KCk9Pnt9LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRQcmVwYXJlRGVmaW5lc0JlZm9yZUF0dHJpYnV0ZXM9KCk9Pnt9LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRIYXJkQmluZEZvclN1Yk1lc2g9KCk9Pnt9LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRCaW5kRm9yU3ViTWVzaD0oKT0+e30sdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEhhc1JlbmRlclRhcmdldFRleHR1cmVzPSgpPT57fSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50RmlsbFJlbmRlclRhcmdldFRleHR1cmVzPSgpPT57fSx0aGlzLl9mb3JjZUFscGhhVGVzdD0hMSx0aGlzLl90cmFuc3BhcmVuY3lNb2RlPW51bGwsdGhpcy5uYW1lPWU7Y29uc3Qgcz10fHxmZS5MYXN0Q3JlYXRlZFNjZW5lO3MmJih0aGlzLl9zY2VuZT1zLHRoaXMuX2RpcnR5Q2FsbGJhY2tzPXt9LHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzFdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkuYmluZCh0aGlzKSx0aGlzLl9kaXJ0eUNhbGxiYWNrc1syXT10aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNMaWdodHNEaXJ0eS5iaW5kKHRoaXMpLHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzRdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxEaXJ0eS5iaW5kKHRoaXMpLHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzhdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0F0dHJpYnV0ZXNEaXJ0eS5iaW5kKHRoaXMpLHRoaXMuX2RpcnR5Q2FsbGJhY2tzWzE2XT10aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNNaXNjRGlydHkuYmluZCh0aGlzKSx0aGlzLl9kaXJ0eUNhbGxiYWNrc1szMl09dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzUHJlUGFzc0RpcnR5LmJpbmQodGhpcyksdGhpcy5fZGlydHlDYWxsYmFja3NbNjNdPXRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0FsbERpcnR5LmJpbmQodGhpcyksdGhpcy5pZD1lfHxILlJhbmRvbUlkKCksdGhpcy51bmlxdWVJZD10aGlzLl9zY2VuZS5nZXRVbmlxdWVJZCgpLHRoaXMuX21hdGVyaWFsQ29udGV4dD10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5jcmVhdGVNYXRlcmlhbENvbnRleHQoKSx0aGlzLl9kcmF3V3JhcHBlcj1uZXcgbWkodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksITEpLHRoaXMuX2RyYXdXcmFwcGVyLm1hdGVyaWFsQ29udGV4dD10aGlzLl9tYXRlcmlhbENvbnRleHQsdGhpcy5fc2NlbmUudXNlUmlnaHRIYW5kZWRTeXN0ZW0/dGhpcy5zaWRlT3JpZW50YXRpb249UC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb246dGhpcy5zaWRlT3JpZW50YXRpb249UC5Db3VudGVyQ2xvY2tXaXNlU2lkZU9yaWVudGF0aW9uLHRoaXMuX3VuaWZvcm1CdWZmZXI9bmV3IFYodGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksdm9pZCAwLHZvaWQgMCxlKSx0aGlzLl91c2VVQk89dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMsaXx8dGhpcy5fc2NlbmUuYWRkTWF0ZXJpYWwodGhpcyksdGhpcy5fc2NlbmUudXNlTWF0ZXJpYWxNZXNoTWFwJiYodGhpcy5tZXNoTWFwPXt9KSxQLk9uRXZlbnRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLFFlLkNyZWF0ZWQpKX1nZXQgY2FuUmVuZGVyVG9NUlQoKXtyZXR1cm4hMX1zZXQgYWxwaGEoZSl7aWYodGhpcy5fYWxwaGE9PT1lKXJldHVybjtjb25zdCB0PXRoaXMuX2FscGhhO3RoaXMuX2FscGhhPWUsKHQ9PT0xfHxlPT09MSkmJnRoaXMubWFya0FzRGlydHkoUC5NaXNjRGlydHlGbGFnKX1nZXQgYWxwaGEoKXtyZXR1cm4gdGhpcy5fYWxwaGF9c2V0IGJhY2tGYWNlQ3VsbGluZyhlKXt0aGlzLl9iYWNrRmFjZUN1bGxpbmchPT1lJiYodGhpcy5fYmFja0ZhY2VDdWxsaW5nPWUsdGhpcy5tYXJrQXNEaXJ0eShQLlRleHR1cmVEaXJ0eUZsYWcpKX1nZXQgYmFja0ZhY2VDdWxsaW5nKCl7cmV0dXJuIHRoaXMuX2JhY2tGYWNlQ3VsbGluZ31zZXQgY3VsbEJhY2tGYWNlcyhlKXt0aGlzLl9jdWxsQmFja0ZhY2VzIT09ZSYmKHRoaXMuX2N1bGxCYWNrRmFjZXM9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuVGV4dHVyZURpcnR5RmxhZykpfWdldCBjdWxsQmFja0ZhY2VzKCl7cmV0dXJuIHRoaXMuX2N1bGxCYWNrRmFjZXN9Z2V0IGJsb2NrRGlydHlNZWNoYW5pc20oKXtyZXR1cm4gdGhpcy5fYmxvY2tEaXJ0eU1lY2hhbmlzbX1zZXQgYmxvY2tEaXJ0eU1lY2hhbmlzbShlKXt0aGlzLl9ibG9ja0RpcnR5TWVjaGFuaXNtIT09ZSYmKHRoaXMuX2Jsb2NrRGlydHlNZWNoYW5pc209ZSxlfHx0aGlzLm1hcmtEaXJ0eSgpKX1hdG9taWNNYXRlcmlhbHNVcGRhdGUoZSl7dGhpcy5ibG9ja0RpcnR5TWVjaGFuaXNtPSEwO3RyeXtlKHRoaXMpfWZpbmFsbHl7dGhpcy5ibG9ja0RpcnR5TWVjaGFuaXNtPSExfX1nZXQgaGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXMoKXtyZXR1cm4gdGhpcy5fZXZlbnRJbmZvLmhhc1JlbmRlclRhcmdldFRleHR1cmVzPSExLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRIYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyh0aGlzLl9ldmVudEluZm8pLHRoaXMuX2V2ZW50SW5mby5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlc31zZXQgb25EaXNwb3NlKGUpe3RoaXMuX29uRGlzcG9zZU9ic2VydmVyJiZ0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uRGlzcG9zZU9ic2VydmVyKSx0aGlzLl9vbkRpc3Bvc2VPYnNlcnZlcj10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUuYWRkKGUpfWdldCBvbkJpbmRPYnNlcnZhYmxlKCl7cmV0dXJuIHRoaXMuX29uQmluZE9ic2VydmFibGV8fCh0aGlzLl9vbkJpbmRPYnNlcnZhYmxlPW5ldyBGKSx0aGlzLl9vbkJpbmRPYnNlcnZhYmxlfXNldCBvbkJpbmQoZSl7dGhpcy5fb25CaW5kT2JzZXJ2ZXImJnRoaXMub25CaW5kT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQmluZE9ic2VydmVyPXRoaXMub25CaW5kT2JzZXJ2YWJsZS5hZGQoZSl9Z2V0IG9uVW5CaW5kT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9vblVuQmluZE9ic2VydmFibGV8fCh0aGlzLl9vblVuQmluZE9ic2VydmFibGU9bmV3IEYpLHRoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZX1nZXQgb25FZmZlY3RDcmVhdGVkT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9vbkVmZmVjdENyZWF0ZWRPYnNlcnZhYmxlfHwodGhpcy5fb25FZmZlY3RDcmVhdGVkT2JzZXJ2YWJsZT1uZXcgRiksdGhpcy5fb25FZmZlY3RDcmVhdGVkT2JzZXJ2YWJsZX1zZXQgYWxwaGFNb2RlKGUpe3RoaXMuX2FscGhhTW9kZSE9PWUmJih0aGlzLl9hbHBoYU1vZGU9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuVGV4dHVyZURpcnR5RmxhZykpfWdldCBhbHBoYU1vZGUoKXtyZXR1cm4gdGhpcy5fYWxwaGFNb2RlfXNldCBuZWVkRGVwdGhQcmVQYXNzKGUpe3RoaXMuX25lZWREZXB0aFByZVBhc3MhPT1lJiYodGhpcy5fbmVlZERlcHRoUHJlUGFzcz1lLHRoaXMuX25lZWREZXB0aFByZVBhc3MmJih0aGlzLmNoZWNrUmVhZHlPbkV2ZXJ5Q2FsbD0hMCkpfWdldCBuZWVkRGVwdGhQcmVQYXNzKCl7cmV0dXJuIHRoaXMuX25lZWREZXB0aFByZVBhc3N9Z2V0IGlzUHJlUGFzc0NhcGFibGUoKXtyZXR1cm4hMX1zZXQgZm9nRW5hYmxlZChlKXt0aGlzLl9mb2dFbmFibGVkIT09ZSYmKHRoaXMuX2ZvZ0VuYWJsZWQ9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuTWlzY0RpcnR5RmxhZykpfWdldCBmb2dFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2ZvZ0VuYWJsZWR9Z2V0IHdpcmVmcmFtZSgpe3N3aXRjaCh0aGlzLl9maWxsTW9kZSl7Y2FzZSBQLldpcmVGcmFtZUZpbGxNb2RlOmNhc2UgUC5MaW5lTGlzdERyYXdNb2RlOmNhc2UgUC5MaW5lTG9vcERyYXdNb2RlOmNhc2UgUC5MaW5lU3RyaXBEcmF3TW9kZTpyZXR1cm4hMH1yZXR1cm4gdGhpcy5fc2NlbmUuZm9yY2VXaXJlZnJhbWV9c2V0IHdpcmVmcmFtZShlKXt0aGlzLmZpbGxNb2RlPWU/UC5XaXJlRnJhbWVGaWxsTW9kZTpQLlRyaWFuZ2xlRmlsbE1vZGV9Z2V0IHBvaW50c0Nsb3VkKCl7c3dpdGNoKHRoaXMuX2ZpbGxNb2RlKXtjYXNlIFAuUG9pbnRGaWxsTW9kZTpjYXNlIFAuUG9pbnRMaXN0RHJhd01vZGU6cmV0dXJuITB9cmV0dXJuIHRoaXMuX3NjZW5lLmZvcmNlUG9pbnRzQ2xvdWR9c2V0IHBvaW50c0Nsb3VkKGUpe3RoaXMuZmlsbE1vZGU9ZT9QLlBvaW50RmlsbE1vZGU6UC5UcmlhbmdsZUZpbGxNb2RlfWdldCBmaWxsTW9kZSgpe3JldHVybiB0aGlzLl9maWxsTW9kZX1zZXQgZmlsbE1vZGUoZSl7dGhpcy5fZmlsbE1vZGUhPT1lJiYodGhpcy5fZmlsbE1vZGU9ZSx0aGlzLm1hcmtBc0RpcnR5KFAuTWlzY0RpcnR5RmxhZykpfV9nZXREcmF3V3JhcHBlcigpe3JldHVybiB0aGlzLl9kcmF3V3JhcHBlcn1fc2V0RHJhd1dyYXBwZXIoZSl7dGhpcy5fZHJhd1dyYXBwZXI9ZX10b1N0cmluZyhlKXtyZXR1cm4iTmFtZTogIit0aGlzLm5hbWV9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIk1hdGVyaWFsIn1nZXQgX2lzTWF0ZXJpYWwoKXtyZXR1cm4hMH1nZXQgaXNGcm96ZW4oKXtyZXR1cm4gdGhpcy5jaGVja1JlYWR5T25seU9uY2V9ZnJlZXplKCl7dGhpcy5tYXJrRGlydHkoKSx0aGlzLmNoZWNrUmVhZHlPbmx5T25jZT0hMH11bmZyZWV6ZSgpe3RoaXMubWFya0RpcnR5KCksdGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITF9aXNSZWFkeShlLHQpe3JldHVybiEwfWlzUmVhZHlGb3JTdWJNZXNoKGUsdCxpKXtjb25zdCBzPXQubWF0ZXJpYWxEZWZpbmVzO3JldHVybiBzPyh0aGlzLl9ldmVudEluZm8uaXNSZWFkeUZvclN1Yk1lc2g9ITAsdGhpcy5fZXZlbnRJbmZvLmRlZmluZXM9cyx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50SXNSZWFkeUZvclN1Yk1lc2godGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9ldmVudEluZm8uaXNSZWFkeUZvclN1Yk1lc2gpOiExfWdldEVmZmVjdCgpe3JldHVybiB0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3R9Z2V0U2NlbmUoKXtyZXR1cm4gdGhpcy5fc2NlbmV9Z2V0IHRyYW5zcGFyZW5jeU1vZGUoKXtyZXR1cm4gdGhpcy5fdHJhbnNwYXJlbmN5TW9kZX1zZXQgdHJhbnNwYXJlbmN5TW9kZShlKXt0aGlzLl90cmFuc3BhcmVuY3lNb2RlIT09ZSYmKHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9ZSx0aGlzLl9mb3JjZUFscGhhVGVzdD1lPT09UC5NQVRFUklBTF9BTFBIQVRFU1RBTkRCTEVORCx0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSgpKX1nZXQgX2Rpc2FibGVBbHBoYUJsZW5kaW5nKCl7cmV0dXJuIHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9PT1QLk1BVEVSSUFMX09QQVFVRXx8dGhpcy5fdHJhbnNwYXJlbmN5TW9kZT09PVAuTUFURVJJQUxfQUxQSEFURVNUfW5lZWRBbHBoYUJsZW5kaW5nKCl7cmV0dXJuIHRoaXMuX2Rpc2FibGVBbHBoYUJsZW5kaW5nPyExOnRoaXMuYWxwaGE8MX1uZWVkQWxwaGFCbGVuZGluZ0Zvck1lc2goZSl7cmV0dXJuIGUudmlzaWJpbGl0eTwxPyEwOnRoaXMuX2Rpc2FibGVBbHBoYUJsZW5kaW5nPyExOmUuaGFzVmVydGV4QWxwaGF8fHRoaXMubmVlZEFscGhhQmxlbmRpbmcoKX1uZWVkQWxwaGFUZXN0aW5nKCl7cmV0dXJuISF0aGlzLl9mb3JjZUFscGhhVGVzdH1fc2hvdWxkVHVybkFscGhhVGVzdE9uKGUpe3JldHVybiF0aGlzLm5lZWRBbHBoYUJsZW5kaW5nRm9yTWVzaChlKSYmdGhpcy5uZWVkQWxwaGFUZXN0aW5nKCl9Z2V0QWxwaGFUZXN0VGV4dHVyZSgpe3JldHVybiBudWxsfW1hcmtEaXJ0eShlPSExKXtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXM7Zm9yKGNvbnN0IGkgb2YgdClpZihpLnN1Yk1lc2hlcylmb3IoY29uc3QgcyBvZiBpLnN1Yk1lc2hlcylzLmdldE1hdGVyaWFsKCk9PT10aGlzJiZzLmVmZmVjdCYmKHMuZWZmZWN0Ll93YXNQcmV2aW91c2x5UmVhZHk9ITEscy5lZmZlY3QuX3dhc1ByZXZpb3VzbHlVc2luZ0luc3RhbmNlcz1udWxsLHMuZWZmZWN0Ll9mb3JjZVJlYmluZE9uTmV4dENhbGw9ZSk7ZSYmdGhpcy5tYXJrQXNEaXJ0eShQLkFsbERpcnR5RmxhZyl9X3ByZUJpbmQoZSx0PW51bGwpe2NvbnN0IGk9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkscj0odD8/dGhpcy5zaWRlT3JpZW50YXRpb24pPT09UC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb247cmV0dXJuIGkuZW5hYmxlRWZmZWN0KGV8fHRoaXMuX2dldERyYXdXcmFwcGVyKCkpLGkuc2V0U3RhdGUodGhpcy5iYWNrRmFjZUN1bGxpbmcsdGhpcy56T2Zmc2V0LCExLHIsdGhpcy5fc2NlbmUuX21pcnJvcmVkQ2FtZXJhUG9zaXRpb24/IXRoaXMuY3VsbEJhY2tGYWNlczp0aGlzLmN1bGxCYWNrRmFjZXMsdGhpcy5zdGVuY2lsLHRoaXMuek9mZnNldFVuaXRzKSxyfWJpbmQoZSx0KXt9YnVpbGRVbmlmb3JtTGF5b3V0KCl7Y29uc3QgZT10aGlzLl91bmlmb3JtQnVmZmVyO3RoaXMuX2V2ZW50SW5mby51Ym89ZSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50R2VuZXJpYyhRZS5QcmVwYXJlVW5pZm9ybUJ1ZmZlcix0aGlzLl9ldmVudEluZm8pLGUuY3JlYXRlKCksdGhpcy5fdW5pZm9ybUJ1ZmZlckxheW91dEJ1aWx0PSEwfWJpbmRGb3JTdWJNZXNoKGUsdCxpKXtjb25zdCBzPWkuZWZmZWN0O3MmJih0aGlzLl9ldmVudEluZm8uc3ViTWVzaD1pLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRCaW5kRm9yU3ViTWVzaCh0aGlzLl9ldmVudEluZm8pLHMuX2ZvcmNlUmViaW5kT25OZXh0Q2FsbD0hMSl9YmluZE9ubHlXb3JsZE1hdHJpeChlKXt9YmluZFZpZXcoZSl7dGhpcy5fdXNlVUJPP3RoaXMuX25lZWRUb0JpbmRTY2VuZVVibz0hMDplLnNldE1hdHJpeCgidmlldyIsdGhpcy5nZXRTY2VuZSgpLmdldFZpZXdNYXRyaXgoKSl9YmluZFZpZXdQcm9qZWN0aW9uKGUpe3RoaXMuX3VzZVVCTz90aGlzLl9uZWVkVG9CaW5kU2NlbmVVYm89ITA6KGUuc2V0TWF0cml4KCJ2aWV3UHJvamVjdGlvbiIsdGhpcy5nZXRTY2VuZSgpLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxlLnNldE1hdHJpeCgicHJvamVjdGlvbiIsdGhpcy5nZXRTY2VuZSgpLmdldFByb2plY3Rpb25NYXRyaXgoKSkpfWJpbmRFeWVQb3NpdGlvbihlLHQpe3RoaXMuX3VzZVVCTz90aGlzLl9uZWVkVG9CaW5kU2NlbmVVYm89ITA6dGhpcy5fc2NlbmUuYmluZEV5ZVBvc2l0aW9uKGUsdCl9X2FmdGVyQmluZChlLHQ9bnVsbCl7aWYodGhpcy5fc2NlbmUuX2NhY2hlZE1hdGVyaWFsPXRoaXMsdGhpcy5fbmVlZFRvQmluZFNjZW5lVWJvJiZ0JiYodGhpcy5fbmVlZFRvQmluZFNjZW5lVWJvPSExLGllLkJpbmRTY2VuZVVuaWZvcm1CdWZmZXIodCx0aGlzLmdldFNjZW5lKCkuZ2V0U2NlbmVVbmlmb3JtQnVmZmVyKCkpLHRoaXMuX3NjZW5lLmZpbmFsaXplU2NlbmVVYm8oKSksZT90aGlzLl9zY2VuZS5fY2FjaGVkVmlzaWJpbGl0eT1lLnZpc2liaWxpdHk6dGhpcy5fc2NlbmUuX2NhY2hlZFZpc2liaWxpdHk9MSx0aGlzLl9vbkJpbmRPYnNlcnZhYmxlJiZlJiZ0aGlzLl9vbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0aGlzLmRpc2FibGVEZXB0aFdyaXRlKXtjb25zdCBpPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3RoaXMuX2NhY2hlZERlcHRoV3JpdGVTdGF0ZT1pLmdldERlcHRoV3JpdGUoKSxpLnNldERlcHRoV3JpdGUoITEpfWlmKHRoaXMuZGlzYWJsZUNvbG9yV3JpdGUpe2NvbnN0IGk9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7dGhpcy5fY2FjaGVkQ29sb3JXcml0ZVN0YXRlPWkuZ2V0Q29sb3JXcml0ZSgpLGkuc2V0Q29sb3JXcml0ZSghMSl9aWYodGhpcy5kZXB0aEZ1bmN0aW9uIT09MCl7Y29uc3QgaT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTt0aGlzLl9jYWNoZWREZXB0aEZ1bmN0aW9uU3RhdGU9aS5nZXREZXB0aEZ1bmN0aW9uKCl8fDAsaS5zZXREZXB0aEZ1bmN0aW9uKHRoaXMuZGVwdGhGdW5jdGlvbil9fXVuYmluZCgpe3RoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZSYmdGhpcy5fb25VbkJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSx0aGlzLmRlcHRoRnVuY3Rpb24hPT0wJiZ0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5zZXREZXB0aEZ1bmN0aW9uKHRoaXMuX2NhY2hlZERlcHRoRnVuY3Rpb25TdGF0ZSksdGhpcy5kaXNhYmxlRGVwdGhXcml0ZSYmdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuc2V0RGVwdGhXcml0ZSh0aGlzLl9jYWNoZWREZXB0aFdyaXRlU3RhdGUpLHRoaXMuZGlzYWJsZUNvbG9yV3JpdGUmJnRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLnNldENvbG9yV3JpdGUodGhpcy5fY2FjaGVkQ29sb3JXcml0ZVN0YXRlKX1nZXRBbmltYXRhYmxlcygpe3JldHVybiB0aGlzLl9ldmVudEluZm8uYW5pbWF0YWJsZXM9W10sdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEdlbmVyaWMoUWUuR2V0QW5pbWF0YWJsZXMsdGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9ldmVudEluZm8uYW5pbWF0YWJsZXN9Z2V0QWN0aXZlVGV4dHVyZXMoKXtyZXR1cm4gdGhpcy5fZXZlbnRJbmZvLmFjdGl2ZVRleHR1cmVzPVtdLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLkdldEFjdGl2ZVRleHR1cmVzLHRoaXMuX2V2ZW50SW5mbyksdGhpcy5fZXZlbnRJbmZvLmFjdGl2ZVRleHR1cmVzfWhhc1RleHR1cmUoZSl7cmV0dXJuIHRoaXMuX2V2ZW50SW5mby5oYXNUZXh0dXJlPSExLHRoaXMuX2V2ZW50SW5mby50ZXh0dXJlPWUsdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEdlbmVyaWMoUWUuSGFzVGV4dHVyZSx0aGlzLl9ldmVudEluZm8pLHRoaXMuX2V2ZW50SW5mby5oYXNUZXh0dXJlfWNsb25lKGUpe3JldHVybiBudWxsfWdldEJpbmRlZE1lc2hlcygpe2lmKHRoaXMubWVzaE1hcCl7Y29uc3QgZT1uZXcgQXJyYXk7Zm9yKGNvbnN0IHQgaW4gdGhpcy5tZXNoTWFwKXtjb25zdCBpPXRoaXMubWVzaE1hcFt0XTtpJiZlLnB1c2goaSl9cmV0dXJuIGV9ZWxzZSByZXR1cm4gdGhpcy5fc2NlbmUubWVzaGVzLmZpbHRlcih0PT50Lm1hdGVyaWFsPT09dGhpcyl9Zm9yY2VDb21waWxhdGlvbihlLHQsaSxzKXtjb25zdCByPXtjbGlwUGxhbmU6ITEsdXNlSW5zdGFuY2VzOiExLC4uLml9LG49dGhpcy5nZXRTY2VuZSgpLGE9dGhpcy5hbGxvd1NoYWRlckhvdFN3YXBwaW5nO3RoaXMuYWxsb3dTaGFkZXJIb3RTd2FwcGluZz0hMTtjb25zdCBvPSgpPT57aWYoIXRoaXMuX3NjZW5lfHwhdGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkpcmV0dXJuO2NvbnN0IGg9bi5jbGlwUGxhbmU7aWYoci5jbGlwUGxhbmUmJihuLmNsaXBQbGFuZT1uZXcgeHQoMCwwLDAsMSkpLHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXMpe2xldCBsPSEwLHU9bnVsbDtpZihlLnN1Yk1lc2hlcyl7Y29uc3QgZD1uZXcgdnQoMCwwLDAsMCwwLGUsdm9pZCAwLCExLCExKTtkLm1hdGVyaWFsRGVmaW5lcyYmKGQubWF0ZXJpYWxEZWZpbmVzLl9yZW5kZXJJZD0tMSksdGhpcy5pc1JlYWR5Rm9yU3ViTWVzaChlLGQsci51c2VJbnN0YW5jZXMpfHwoZC5lZmZlY3QmJmQuZWZmZWN0LmdldENvbXBpbGF0aW9uRXJyb3IoKSYmZC5lZmZlY3QuYWxsRmFsbGJhY2tzUHJvY2Vzc2VkKCk/dT1kLmVmZmVjdC5nZXRDb21waWxhdGlvbkVycm9yKCk6KGw9ITEsc2V0VGltZW91dChvLDE2KSkpfWwmJih0aGlzLmFsbG93U2hhZGVySG90U3dhcHBpbmc9YSx1JiZzJiZzKHUpLHQmJnQodGhpcykpfWVsc2UgdGhpcy5pc1JlYWR5KCk/KHRoaXMuYWxsb3dTaGFkZXJIb3RTd2FwcGluZz1hLHQmJnQodGhpcykpOnNldFRpbWVvdXQobywxNik7ci5jbGlwUGxhbmUmJihuLmNsaXBQbGFuZT1oKX07bygpfWZvcmNlQ29tcGlsYXRpb25Bc3luYyhlLHQpe3JldHVybiBuZXcgUHJvbWlzZSgoaSxzKT0+e3RoaXMuZm9yY2VDb21waWxhdGlvbihlLCgpPT57aSgpfSx0LHI9PntzKHIpfSl9KX1tYXJrQXNEaXJ0eShlKXt0aGlzLmdldFNjZW5lKCkuYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtfHx0aGlzLl9ibG9ja0RpcnR5TWVjaGFuaXNtfHwoUC5fRGlydHlDYWxsYmFja0FycmF5Lmxlbmd0aD0wLGUmUC5UZXh0dXJlRGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9UZXh0dXJlRGlydHlDYWxsQmFjayksZSZQLkxpZ2h0RGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9MaWdodHNEaXJ0eUNhbGxCYWNrKSxlJlAuRnJlc25lbERpcnR5RmxhZyYmUC5fRGlydHlDYWxsYmFja0FycmF5LnB1c2goUC5fRnJlc25lbERpcnR5Q2FsbEJhY2spLGUmUC5BdHRyaWJ1dGVzRGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9BdHRyaWJ1dGVEaXJ0eUNhbGxCYWNrKSxlJlAuTWlzY0RpcnR5RmxhZyYmUC5fRGlydHlDYWxsYmFja0FycmF5LnB1c2goUC5fTWlzY0RpcnR5Q2FsbEJhY2spLGUmUC5QcmVQYXNzRGlydHlGbGFnJiZQLl9EaXJ0eUNhbGxiYWNrQXJyYXkucHVzaChQLl9QcmVQYXNzRGlydHlDYWxsQmFjayksUC5fRGlydHlDYWxsYmFja0FycmF5Lmxlbmd0aCYmdGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fUnVuRGlydHlDYWxsQmFja3MpLHRoaXMuZ2V0U2NlbmUoKS5yZXNldENhY2hlZE1hdGVyaWFsKCkpfXJlc2V0RHJhd0NhY2hlKCl7Y29uc3QgZT10aGlzLmdldFNjZW5lKCkubWVzaGVzO2Zvcihjb25zdCB0IG9mIGUpaWYodC5zdWJNZXNoZXMpZm9yKGNvbnN0IGkgb2YgdC5zdWJNZXNoZXMpaS5nZXRNYXRlcmlhbCgpPT09dGhpcyYmaS5yZXNldERyYXdDYWNoZSgpfV9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShlKXtpZih0aGlzLmdldFNjZW5lKCkuYmxvY2tNYXRlcmlhbERpcnR5TWVjaGFuaXNtfHx0aGlzLl9ibG9ja0RpcnR5TWVjaGFuaXNtKXJldHVybjtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXM7Zm9yKGNvbnN0IGkgb2YgdClpZihpLnN1Yk1lc2hlcyl7Zm9yKGNvbnN0IHMgb2YgaS5zdWJNZXNoZXMpaWYocy5nZXRNYXRlcmlhbCghMSk9PT10aGlzKWZvcihjb25zdCByIG9mIHMuX2RyYXdXcmFwcGVycykhcnx8IXIuZGVmaW5lc3x8IXIuZGVmaW5lcy5tYXJrQWxsQXNEaXJ0eXx8dGhpcy5fbWF0ZXJpYWxDb250ZXh0PT09ci5tYXRlcmlhbENvbnRleHQmJmUoci5kZWZpbmVzKX19X21hcmtTY2VuZVByZVBhc3NEaXJ0eSgpe2lmKHRoaXMuZ2V0U2NlbmUoKS5ibG9ja01hdGVyaWFsRGlydHlNZWNoYW5pc218fHRoaXMuX2Jsb2NrRGlydHlNZWNoYW5pc20pcmV0dXJuO2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpLmVuYWJsZVByZVBhc3NSZW5kZXJlcigpO2UmJmUubWFya0FzRGlydHkoKX1fbWFya0FsbFN1Yk1lc2hlc0FzQWxsRGlydHkoKXt0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShQLl9BbGxEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzSW1hZ2VQcm9jZXNzaW5nRGlydHkoKXt0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShQLl9JbWFnZVByb2Nlc3NpbmdEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpe3RoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0RpcnR5KFAuX1RleHR1cmVEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fRnJlc25lbERpcnR5Q2FsbEJhY2spfV9tYXJrQWxsU3ViTWVzaGVzQXNGcmVzbmVsQW5kTWlzY0RpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fRnJlc25lbEFuZE1pc2NEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzTGlnaHRzRGlydHkoKXt0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNEaXJ0eShQLl9MaWdodHNEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fQXR0cmlidXRlRGlydHlDYWxsQmFjayl9X21hcmtBbGxTdWJNZXNoZXNBc01pc2NEaXJ0eSgpe3RoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0RpcnR5KFAuX01pc2NEaXJ0eUNhbGxCYWNrKX1fbWFya0FsbFN1Yk1lc2hlc0FzUHJlUGFzc0RpcnR5KCl7dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzRGlydHkoUC5fTWlzY0RpcnR5Q2FsbEJhY2spfV9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSgpe3RoaXMuX21hcmtBbGxTdWJNZXNoZXNBc0RpcnR5KFAuX1RleHR1cmVBbmRNaXNjRGlydHlDYWxsQmFjayl9c2V0UHJlUGFzc1JlbmRlcmVyKGUpe3JldHVybiExfWRpc3Bvc2UoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpO2lmKHMuc3RvcEFuaW1hdGlvbih0aGlzKSxzLmZyZWVQcm9jZXNzZWRNYXRlcmlhbHMoKSxzLnJlbW92ZU1hdGVyaWFsKHRoaXMpLHRoaXMuX2V2ZW50SW5mby5mb3JjZURpc3Bvc2VUZXh0dXJlcz10LHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLkRpc3Bvc2VkLHRoaXMuX2V2ZW50SW5mbyksdGhpcy5fcGFyZW50Q29udGFpbmVyKXtjb25zdCByPXRoaXMuX3BhcmVudENvbnRhaW5lci5tYXRlcmlhbHMuaW5kZXhPZih0aGlzKTtyPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIubWF0ZXJpYWxzLnNwbGljZShyLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKGkhPT0hMClpZih0aGlzLm1lc2hNYXApZm9yKGNvbnN0IHIgaW4gdGhpcy5tZXNoTWFwKXtjb25zdCBuPXRoaXMubWVzaE1hcFtyXTtuJiYobi5tYXRlcmlhbD1udWxsLHRoaXMucmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KG4sZSkpfWVsc2V7Y29uc3Qgcj1zLm1lc2hlcztmb3IoY29uc3QgbiBvZiByKW4ubWF0ZXJpYWw9PT10aGlzJiYhbi5zb3VyY2VNZXNoJiYobi5tYXRlcmlhbD1udWxsLHRoaXMucmVsZWFzZVZlcnRleEFycmF5T2JqZWN0KG4sZSkpfXRoaXMuX3VuaWZvcm1CdWZmZXIuZGlzcG9zZSgpLGUmJnRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdCYmKHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXN8fHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdC5kaXNwb3NlKCksdGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0PW51bGwpLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX29uQmluZE9ic2VydmFibGUmJnRoaXMuX29uQmluZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9vblVuQmluZE9ic2VydmFibGUmJnRoaXMuX29uVW5CaW5kT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX29uRWZmZWN0Q3JlYXRlZE9ic2VydmFibGUmJnRoaXMuX29uRWZmZWN0Q3JlYXRlZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9ldmVudEluZm8mJih0aGlzLl9ldmVudEluZm89e30pfXJlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdChlLHQpe2lmKGUuZ2VvbWV0cnkpe2NvbnN0IGk9ZS5nZW9tZXRyeTtpZih0aGlzLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzKWZvcihjb25zdCBzIG9mIGUuc3ViTWVzaGVzKWkuX3JlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdChzLmVmZmVjdCksdCYmcy5lZmZlY3QmJnMuZWZmZWN0LmRpc3Bvc2UoKTtlbHNlIGkuX3JlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdCh0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3QpfX1zZXJpYWxpemUoKXtjb25zdCBlPWFlLlNlcmlhbGl6ZSh0aGlzKTtyZXR1cm4gZS5zdGVuY2lsPXRoaXMuc3RlbmNpbC5zZXJpYWxpemUoKSxlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZX1zdGF0aWMgUGFyc2UoZSx0LGkpe2lmKCFlLmN1c3RvbVR5cGUpZS5jdXN0b21UeXBlPSJCQUJZTE9OLlN0YW5kYXJkTWF0ZXJpYWwiO2Vsc2UgaWYoZS5jdXN0b21UeXBlPT09IkJBQllMT04uUEJSTWF0ZXJpYWwiJiZlLm92ZXJsb2FkZWRBbGJlZG8mJihlLmN1c3RvbVR5cGU9IkJBQllMT04uTGVnYWN5UEJSTWF0ZXJpYWwiLCFCQUJZTE9OLkxlZ2FjeVBCUk1hdGVyaWFsKSlyZXR1cm4gTy5FcnJvcigiWW91ciBzY2VuZSBpcyB0cnlpbmcgdG8gbG9hZCBhIGxlZ2FjeSB2ZXJzaW9uIG9mIHRoZSBQQlJNYXRlcmlhbCwgcGxlYXNlLCBpbmNsdWRlIGl0IGZyb20gdGhlIG1hdGVyaWFscyBsaWJyYXJ5LiIpLG51bGw7Y29uc3Qgcj1ILkluc3RhbnRpYXRlKGUuY3VzdG9tVHlwZSkuUGFyc2UoZSx0LGkpO3JldHVybiByLl9sb2FkZWRVbmlxdWVJZD1lLnVuaXF1ZUlkLHJ9fVAuVHJpYW5nbGVGaWxsTW9kZT0wLFAuV2lyZUZyYW1lRmlsbE1vZGU9MSxQLlBvaW50RmlsbE1vZGU9MixQLlBvaW50TGlzdERyYXdNb2RlPTMsUC5MaW5lTGlzdERyYXdNb2RlPTQsUC5MaW5lTG9vcERyYXdNb2RlPTUsUC5MaW5lU3RyaXBEcmF3TW9kZT02LFAuVHJpYW5nbGVTdHJpcERyYXdNb2RlPTcsUC5UcmlhbmdsZUZhbkRyYXdNb2RlPTgsUC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb249MCxQLkNvdW50ZXJDbG9ja1dpc2VTaWRlT3JpZW50YXRpb249MSxQLlRleHR1cmVEaXJ0eUZsYWc9MSxQLkxpZ2h0RGlydHlGbGFnPTIsUC5GcmVzbmVsRGlydHlGbGFnPTQsUC5BdHRyaWJ1dGVzRGlydHlGbGFnPTgsUC5NaXNjRGlydHlGbGFnPTE2LFAuUHJlUGFzc0RpcnR5RmxhZz0zMixQLkFsbERpcnR5RmxhZz02MyxQLk1BVEVSSUFMX09QQVFVRT0wLFAuTUFURVJJQUxfQUxQSEFURVNUPTEsUC5NQVRFUklBTF9BTFBIQUJMRU5EPTIsUC5NQVRFUklBTF9BTFBIQVRFU1RBTkRCTEVORD0zLFAuTUFURVJJQUxfTk9STUFMQkxFTkRNRVRIT0RfV0hJVEVPVVQ9MCxQLk1BVEVSSUFMX05PUk1BTEJMRU5ETUVUSE9EX1JOTT0xLFAuT25FdmVudE9ic2VydmFibGU9bmV3IEYsUC5fQWxsRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBbGxBc0RpcnR5KCksUC5fSW1hZ2VQcm9jZXNzaW5nRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBc0ltYWdlUHJvY2Vzc2luZ0RpcnR5KCksUC5fVGV4dHVyZURpcnR5Q2FsbEJhY2s9Yz0+Yy5tYXJrQXNUZXh0dXJlc0RpcnR5KCksUC5fRnJlc25lbERpcnR5Q2FsbEJhY2s9Yz0+Yy5tYXJrQXNGcmVzbmVsRGlydHkoKSxQLl9NaXNjRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBc01pc2NEaXJ0eSgpLFAuX1ByZVBhc3NEaXJ0eUNhbGxCYWNrPWM9PmMubWFya0FzUHJlUGFzc0RpcnR5KCksUC5fTGlnaHRzRGlydHlDYWxsQmFjaz1jPT5jLm1hcmtBc0xpZ2h0RGlydHkoKSxQLl9BdHRyaWJ1dGVEaXJ0eUNhbGxCYWNrPWM9PmMubWFya0FzQXR0cmlidXRlc0RpcnR5KCksUC5fRnJlc25lbEFuZE1pc2NEaXJ0eUNhbGxCYWNrPWM9PntQLl9GcmVzbmVsRGlydHlDYWxsQmFjayhjKSxQLl9NaXNjRGlydHlDYWxsQmFjayhjKX0sUC5fVGV4dHVyZUFuZE1pc2NEaXJ0eUNhbGxCYWNrPWM9PntQLl9UZXh0dXJlRGlydHlDYWxsQmFjayhjKSxQLl9NaXNjRGlydHlDYWxsQmFjayhjKX0sUC5fRGlydHlDYWxsYmFja0FycmF5PVtdLFAuX1J1bkRpcnR5Q2FsbEJhY2tzPWM9Pntmb3IoY29uc3QgZSBvZiBQLl9EaXJ0eUNhbGxiYWNrQXJyYXkpZShjKX0sVChbUigpXSxQLnByb3RvdHlwZSwiaWQiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwidW5pcXVlSWQiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwibmFtZSIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJtZXRhZGF0YSIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJjaGVja1JlYWR5T25FdmVyeUNhbGwiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiY2hlY2tSZWFkeU9ubHlPbmNlIix2b2lkIDApLFQoW1IoKV0sUC5wcm90b3R5cGUsInN0YXRlIix2b2lkIDApLFQoW1IoImFscGhhIildLFAucHJvdG90eXBlLCJfYWxwaGEiLHZvaWQgMCksVChbUigiYmFja0ZhY2VDdWxsaW5nIildLFAucHJvdG90eXBlLCJfYmFja0ZhY2VDdWxsaW5nIix2b2lkIDApLFQoW1IoImN1bGxCYWNrRmFjZXMiKV0sUC5wcm90b3R5cGUsIl9jdWxsQmFja0ZhY2VzIix2b2lkIDApLFQoW1IoKV0sUC5wcm90b3R5cGUsInNpZGVPcmllbnRhdGlvbiIsdm9pZCAwKSxUKFtSKCJhbHBoYU1vZGUiKV0sUC5wcm90b3R5cGUsIl9hbHBoYU1vZGUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiX25lZWREZXB0aFByZVBhc3MiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiZGlzYWJsZURlcHRoV3JpdGUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiZGlzYWJsZUNvbG9yV3JpdGUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiZm9yY2VEZXB0aFdyaXRlIix2b2lkIDApLFQoW1IoKV0sUC5wcm90b3R5cGUsImRlcHRoRnVuY3Rpb24iLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwic2VwYXJhdGVDdWxsaW5nUGFzcyIsdm9pZCAwKSxUKFtSKCJmb2dFbmFibGVkIildLFAucHJvdG90eXBlLCJfZm9nRW5hYmxlZCIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJwb2ludFNpemUiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwiek9mZnNldCIsdm9pZCAwKSxUKFtSKCldLFAucHJvdG90eXBlLCJ6T2Zmc2V0VW5pdHMiLHZvaWQgMCksVChbUigpXSxQLnByb3RvdHlwZSwicG9pbnRzQ2xvdWQiLG51bGwpLFQoW1IoKV0sUC5wcm90b3R5cGUsImZpbGxNb2RlIixudWxsKSxUKFtSKCldLFAucHJvdG90eXBlLCJ0cmFuc3BhcmVuY3lNb2RlIixudWxsKTtjbGFzcyBTaSBleHRlbmRzIFB7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQsITApLHRoaXMuX3dhaXRpbmdTdWJNYXRlcmlhbHNVbmlxdWVJZHM9W10sdGhpcy5nZXRTY2VuZSgpLm11bHRpTWF0ZXJpYWxzLnB1c2godGhpcyksdGhpcy5zdWJNYXRlcmlhbHM9bmV3IEFycmF5LHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXM9ITB9Z2V0IHN1Yk1hdGVyaWFscygpe3JldHVybiB0aGlzLl9zdWJNYXRlcmlhbHN9c2V0IHN1Yk1hdGVyaWFscyhlKXt0aGlzLl9zdWJNYXRlcmlhbHM9ZSx0aGlzLl9ob29rQXJyYXkoZSl9Z2V0Q2hpbGRyZW4oKXtyZXR1cm4gdGhpcy5zdWJNYXRlcmlhbHN9X2hvb2tBcnJheShlKXtjb25zdCB0PWUucHVzaDtlLnB1c2g9KC4uLnMpPT57Y29uc3Qgcj10LmFwcGx5KGUscyk7cmV0dXJuIHRoaXMuX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkoKSxyfTtjb25zdCBpPWUuc3BsaWNlO2Uuc3BsaWNlPShzLHIpPT57Y29uc3Qgbj1pLmFwcGx5KGUsW3Mscl0pO3JldHVybiB0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5KCksbn19Z2V0U3ViTWF0ZXJpYWwoZSl7cmV0dXJuIGU8MHx8ZT49dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoP3RoaXMuZ2V0U2NlbmUoKS5kZWZhdWx0TWF0ZXJpYWw6dGhpcy5zdWJNYXRlcmlhbHNbZV19Z2V0QWN0aXZlVGV4dHVyZXMoKXtyZXR1cm4gc3VwZXIuZ2V0QWN0aXZlVGV4dHVyZXMoKS5jb25jYXQoLi4udGhpcy5zdWJNYXRlcmlhbHMubWFwKGU9PmU/ZS5nZXRBY3RpdmVUZXh0dXJlcygpOltdKSl9aGFzVGV4dHVyZShlKXt2YXIgdDtpZihzdXBlci5oYXNUZXh0dXJlKGUpKXJldHVybiEwO2ZvcihsZXQgaT0wO2k8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO2krKylpZighKCh0PXRoaXMuc3ViTWF0ZXJpYWxzW2ldKT09PW51bGx8fHQ9PT12b2lkIDApJiZ0Lmhhc1RleHR1cmUoZSkpcmV0dXJuITA7cmV0dXJuITF9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIk11bHRpTWF0ZXJpYWwifWlzUmVhZHlGb3JTdWJNZXNoKGUsdCxpKXtmb3IobGV0IHM9MDtzPHRoaXMuc3ViTWF0ZXJpYWxzLmxlbmd0aDtzKyspe2NvbnN0IHI9dGhpcy5zdWJNYXRlcmlhbHNbc107aWYocil7aWYoci5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyl7aWYoIXIuaXNSZWFkeUZvclN1Yk1lc2goZSx0LGkpKXJldHVybiExO2NvbnRpbnVlfWlmKCFyLmlzUmVhZHkoZSkpcmV0dXJuITF9fXJldHVybiEwfWNsb25lKGUsdCl7Y29uc3QgaT1uZXcgU2koZSx0aGlzLmdldFNjZW5lKCkpO2ZvcihsZXQgcz0wO3M8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO3MrKyl7bGV0IHI9bnVsbDtjb25zdCBuPXRoaXMuc3ViTWF0ZXJpYWxzW3NdO3QmJm4/cj1uLmNsb25lKGUrIi0iK24ubmFtZSk6cj10aGlzLnN1Yk1hdGVyaWFsc1tzXSxpLnN1Yk1hdGVyaWFscy5wdXNoKHIpfXJldHVybiBpfXNlcmlhbGl6ZSgpe2NvbnN0IGU9e307ZS5uYW1lPXRoaXMubmFtZSxlLmlkPXRoaXMuaWQsZS51bmlxdWVJZD10aGlzLnVuaXF1ZUlkLGdlJiYoZS50YWdzPWdlLkdldFRhZ3ModGhpcykpLGUubWF0ZXJpYWxzVW5pcXVlSWRzPVtdLGUubWF0ZXJpYWxzPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO3QrKyl7Y29uc3QgaT10aGlzLnN1Yk1hdGVyaWFsc1t0XTtpPyhlLm1hdGVyaWFsc1VuaXF1ZUlkcy5wdXNoKGkudW5pcXVlSWQpLGUubWF0ZXJpYWxzLnB1c2goaS5pZCkpOihlLm1hdGVyaWFsc1VuaXF1ZUlkcy5wdXNoKG51bGwpLGUubWF0ZXJpYWxzLnB1c2gobnVsbCkpfXJldHVybiBlfWRpc3Bvc2UoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpO2lmKCFzKXJldHVybjtpZihpKWZvcihsZXQgbj0wO248dGhpcy5zdWJNYXRlcmlhbHMubGVuZ3RoO24rKyl7Y29uc3QgYT10aGlzLnN1Yk1hdGVyaWFsc1tuXTthJiZhLmRpc3Bvc2UoZSx0KX1jb25zdCByPXMubXVsdGlNYXRlcmlhbHMuaW5kZXhPZih0aGlzKTtyPj0wJiZzLm11bHRpTWF0ZXJpYWxzLnNwbGljZShyLDEpLHN1cGVyLmRpc3Bvc2UoZSx0KX1zdGF0aWMgUGFyc2VNdWx0aU1hdGVyaWFsKGUsdCl7Y29uc3QgaT1uZXcgU2koZS5uYW1lLHQpO3JldHVybiBpLmlkPWUuaWQsaS5fbG9hZGVkVW5pcXVlSWQ9ZS51bmlxdWVJZCxnZSYmZ2UuQWRkVGFnc1RvKGksZS50YWdzKSxlLm1hdGVyaWFsc1VuaXF1ZUlkcz9pLl93YWl0aW5nU3ViTWF0ZXJpYWxzVW5pcXVlSWRzPWUubWF0ZXJpYWxzVW5pcXVlSWRzOmUubWF0ZXJpYWxzLmZvckVhY2gocz0+aS5zdWJNYXRlcmlhbHMucHVzaCh0LmdldExhc3RNYXRlcmlhbEJ5SWQocykpKSxpfX1pdCgiQkFCWUxPTi5NdWx0aU1hdGVyaWFsIixTaSk7Y2xhc3MgV257Y29uc3RydWN0b3IoZSx0KXt0aGlzLmRpc3RhbmNlT3JTY3JlZW5Db3ZlcmFnZT1lLHRoaXMubWVzaD10fX1jbGFzcyB6bntjb25zdHJ1Y3Rvcigpe3RoaXMudmlzaWJsZUluc3RhbmNlcz17fSx0aGlzLmJhdGNoQ2FjaGU9bmV3IElyLHRoaXMuYmF0Y2hDYWNoZVJlcGxhY2VtZW50TW9kZUluRnJvemVuTW9kZT1uZXcgSXIsdGhpcy5pbnN0YW5jZXNCdWZmZXJTaXplPTMyKjE2KjR9fWNsYXNzIElye2NvbnN0cnVjdG9yKCl7dGhpcy5tdXN0UmV0dXJuPSExLHRoaXMudmlzaWJsZUluc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5yZW5kZXJTZWxmPW5ldyBBcnJheSx0aGlzLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nPW5ldyBBcnJheX19Y2xhc3MgR257Y29uc3RydWN0b3IoKXt0aGlzLmluc3RhbmNlc0NvdW50PTAsdGhpcy5tYXRyaXhCdWZmZXI9bnVsbCx0aGlzLnByZXZpb3VzTWF0cml4QnVmZmVyPW51bGwsdGhpcy5tYXRyaXhCdWZmZXJTaXplPTMyKjE2LHRoaXMubWF0cml4RGF0YT1udWxsLHRoaXMuYm91bmRpbmdWZWN0b3JzPVtdLHRoaXMud29ybGRNYXRyaWNlcz1udWxsfX1jbGFzcyBYbntjb25zdHJ1Y3Rvcigpe3RoaXMuX2FyZU5vcm1hbHNGcm96ZW49ITEsdGhpcy5fc291cmNlPW51bGwsdGhpcy5tZXNoTWFwPW51bGwsdGhpcy5fcHJlQWN0aXZhdGVJZD0tMSx0aGlzLl9MT0RMZXZlbHM9bmV3IEFycmF5LHRoaXMuX3VzZUxPRFNjcmVlbkNvdmVyYWdlPSExLHRoaXMuX2VmZmVjdGl2ZU1hdGVyaWFsPW51bGwsdGhpcy5fZm9yY2VkSW5zdGFuY2VDb3VudD0wfX1jbGFzcyBXIGV4dGVuZHMgb3R7Y29uc3RydWN0b3IoZSx0PW51bGwsaT1udWxsLHM9bnVsbCxyLG49ITApe2lmKHN1cGVyKGUsdCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm89bmV3IFhuLHRoaXMuZGVsYXlMb2FkU3RhdGU9MCx0aGlzLmluc3RhbmNlcz1uZXcgQXJyYXksdGhpcy5fY3JlYXRpb25EYXRhU3RvcmFnZT1udWxsLHRoaXMuX2dlb21ldHJ5PW51bGwsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZT1uZXcgem4sdGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2U9bmV3IEduLHRoaXMuX3Nob3VsZEdlbmVyYXRlRmxhdFNoYWRpbmc9ITEsdGhpcy5fb3JpZ2luYWxCdWlsZGVyU2lkZU9yaWVudGF0aW9uPVcuREVGQVVMVFNJREUsdGhpcy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPW51bGwsdGhpcy5pZ25vcmVDYW1lcmFNYXhaPSExLHQ9dGhpcy5nZXRTY2VuZSgpLHRoaXMuX29uQmVmb3JlRHJhdz0oYSxvLGgpPT57YSYmaCYmKHRoaXMuX3VuaWZvcm1CdWZmZXI/dGhpcy50cmFuc2ZlclRvRWZmZWN0KG8pOmguYmluZE9ubHlXb3JsZE1hdHJpeChvKSl9LHMpe2lmKHMuX2dlb21ldHJ5JiZzLl9nZW9tZXRyeS5hcHBseVRvTWVzaCh0aGlzKSx2cy5EZWVwQ29weShzLHRoaXMsWyJuYW1lIiwibWF0ZXJpYWwiLCJza2VsZXRvbiIsImluc3RhbmNlcyIsInBhcmVudCIsInVuaXF1ZUlkIiwic291cmNlIiwibWV0YWRhdGEiLCJtb3JwaFRhcmdldE1hbmFnZXIiLCJoYXNJbnN0YW5jZXMiLCJ3b3JsZE1hdHJpeEluc3RhbmNlZEJ1ZmZlciIsInByZXZpb3VzV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIiLCJoYXNMT0RMZXZlbHMiLCJnZW9tZXRyeSIsImlzQmxvY2tlZCIsImFyZU5vcm1hbHNGcm96ZW4iLCJmYWNldE5iIiwiaXNGYWNldERhdGFFbmFibGVkIiwibGlnaHRTb3VyY2VzIiwidXNlQm9uZXMiLCJpc0FuSW5zdGFuY2UiLCJjb2xsaWRlciIsImVkZ2VzUmVuZGVyZXIiLCJmb3J3YXJkIiwidXAiLCJyaWdodCIsImFic29sdXRlUG9zaXRpb24iLCJhYnNvbHV0ZVNjYWxpbmciLCJhYnNvbHV0ZVJvdGF0aW9uUXVhdGVybmlvbiIsImlzV29ybGRNYXRyaXhGcm96ZW4iLCJub25Vbmlmb3JtU2NhbGluZyIsImJlaGF2aW9ycyIsIndvcmxkTWF0cml4RnJvbUNhY2hlIiwiaGFzVGhpbkluc3RhbmNlcyIsImNsb25lTWVzaE1hcCIsImhhc0JvdW5kaW5nSW5mbyJdLFsiX3Bvc2VNYXRyaXgiXSksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZT1zLHQudXNlQ2xvbmVkTWVzaE1hcCYmKHMuX2ludGVybmFsTWVzaERhdGFJbmZvLm1lc2hNYXB8fChzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5tZXNoTWFwPXt9KSxzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5tZXNoTWFwW3RoaXMudW5pcXVlSWRdPXRoaXMpLHRoaXMuX29yaWdpbmFsQnVpbGRlclNpZGVPcmllbnRhdGlvbj1zLl9vcmlnaW5hbEJ1aWxkZXJTaWRlT3JpZW50YXRpb24sdGhpcy5fY3JlYXRpb25EYXRhU3RvcmFnZT1zLl9jcmVhdGlvbkRhdGFTdG9yYWdlLHMuX3Jhbmdlcyl7Y29uc3QgYT1zLl9yYW5nZXM7Zm9yKGNvbnN0IG8gaW4gYSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxvKSYmYVtvXSYmdGhpcy5jcmVhdGVBbmltYXRpb25SYW5nZShvLGFbb10uZnJvbSxhW29dLnRvKX1pZihzLm1ldGFkYXRhJiZzLm1ldGFkYXRhLmNsb25lP3RoaXMubWV0YWRhdGE9cy5tZXRhZGF0YS5jbG9uZSgpOnRoaXMubWV0YWRhdGE9cy5tZXRhZGF0YSxnZSYmZ2UuSGFzVGFncyhzKSYmZ2UuQWRkVGFnc1RvKHRoaXMsZ2UuR2V0VGFncyhzLCEwKSksdGhpcy5zZXRFbmFibGVkKHMuaXNFbmFibGVkKCExKSksdGhpcy5wYXJlbnQ9cy5wYXJlbnQsdGhpcy5zZXRQaXZvdE1hdHJpeChzLmdldFBpdm90TWF0cml4KCkpLHRoaXMuaWQ9ZSsiLiIrcy5pZCx0aGlzLm1hdGVyaWFsPXMubWF0ZXJpYWwsIXIpe2NvbnN0IGE9cy5nZXREZXNjZW5kYW50cyghMCk7Zm9yKGxldCBvPTA7bzxhLmxlbmd0aDtvKyspe2NvbnN0IGg9YVtvXTtoLmNsb25lJiZoLmNsb25lKGUrIi4iK2gubmFtZSx0aGlzKX19aWYocy5tb3JwaFRhcmdldE1hbmFnZXImJih0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcj1zLm1vcnBoVGFyZ2V0TWFuYWdlciksdC5nZXRQaHlzaWNzRW5naW5lKXtjb25zdCBhPXQuZ2V0UGh5c2ljc0VuZ2luZSgpO2lmKG4mJmEmJmEuZ2V0UGx1Z2luVmVyc2lvbigpPT09MSl7Y29uc3Qgbz1hLmdldEltcG9zdG9yRm9yUGh5c2ljc09iamVjdChzKTtvJiYodGhpcy5waHlzaWNzSW1wb3N0b3I9by5jbG9uZSh0aGlzKSl9fWZvcihsZXQgYT0wO2E8dC5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoO2ErKyl7Y29uc3Qgbz10LnBhcnRpY2xlU3lzdGVtc1thXTtvLmVtaXR0ZXI9PT1zJiZvLmNsb25lKG8ubmFtZSx0aGlzKX10aGlzLnNrZWxldG9uPXMuc2tlbGV0b24sdGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCEwLCEwKSx0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCghMCl9aSE9PW51bGwmJih0aGlzLnBhcmVudD1pKSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nPXRoaXMuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cyx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25NZXNoUmVhZHlPYnNlcnZlckFkZGVkPWE9PnthLnVucmVnaXN0ZXJPbk5leHRDYWxsPSEwLHRoaXMuaXNSZWFkeSghMCk/dGhpcy5vbk1lc2hSZWFkeU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpOnRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9jaGVja1JlYWRpbmVzc09ic2VydmVyfHwodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2NoZWNrUmVhZGluZXNzT2JzZXJ2ZXI9dGhpcy5fc2NlbmUub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuaXNSZWFkeSghMCkmJih0aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9jaGVja1JlYWRpbmVzc09ic2VydmVyKSx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fY2hlY2tSZWFkaW5lc3NPYnNlcnZlcj1udWxsLHRoaXMub25NZXNoUmVhZHlPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSl9KSl9LHRoaXMub25NZXNoUmVhZHlPYnNlcnZhYmxlPW5ldyBGKHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbk1lc2hSZWFkeU9ic2VydmVyQWRkZWQpLHMmJnMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKX1zdGF0aWMgX0dldERlZmF1bHRTaWRlT3JpZW50YXRpb24oZSl7cmV0dXJuIGV8fFcuRlJPTlRTSURFfWdldCB1c2VMT0RTY3JlZW5Db3ZlcmFnZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fdXNlTE9EU2NyZWVuQ292ZXJhZ2V9c2V0IHVzZUxPRFNjcmVlbkNvdmVyYWdlKGUpe3RoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl91c2VMT0RTY3JlZW5Db3ZlcmFnZT1lLHRoaXMuX3NvcnRMT0RMZXZlbHMoKX1nZXQgY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVyc31zZXQgY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzKGUpe3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVycyE9PWUmJihlJiZ0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlUG9zaXRpb25zJiYodGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZVBvc2l0aW9ucywhMCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZU5vcm1hbHMmJnRoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlTm9ybWFscywhMCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZVBvc2l0aW9ucz1udWxsLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9zb3VyY2VOb3JtYWxzPW51bGwpLHRoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2NvbXB1dGVCb25lc1VzaW5nU2hhZGVycz1lLHRoaXMuX21hcmtTdWJNZXNoZXNBc0F0dHJpYnV0ZXNEaXJ0eSgpKX1nZXQgb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZVJlbmRlck9ic2VydmFibGV8fCh0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlPW5ldyBGKSx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlfWdldCBvbkJlZm9yZUJpbmRPYnNlcnZhYmxlKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZUJpbmRPYnNlcnZhYmxlfHwodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlQmluZE9ic2VydmFibGU9bmV3IEYpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZUJpbmRPYnNlcnZhYmxlfWdldCBvbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25BZnRlclJlbmRlck9ic2VydmFibGV8fCh0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25BZnRlclJlbmRlck9ic2VydmFibGU9bmV3IEYpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZX1nZXQgb25CZXR3ZWVuUGFzc09ic2VydmFibGUoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlfHwodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlPW5ldyBGKSx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZXR3ZWVuUGFzc09ic2VydmFibGV9Z2V0IG9uQmVmb3JlRHJhd09ic2VydmFibGUoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlRHJhd09ic2VydmFibGV8fCh0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVEcmF3T2JzZXJ2YWJsZT1uZXcgRiksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlRHJhd09ic2VydmFibGV9c2V0IG9uQmVmb3JlRHJhdyhlKXt0aGlzLl9vbkJlZm9yZURyYXdPYnNlcnZlciYmdGhpcy5vbkJlZm9yZURyYXdPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkJlZm9yZURyYXdPYnNlcnZlciksdGhpcy5fb25CZWZvcmVEcmF3T2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZURyYXdPYnNlcnZhYmxlLmFkZChlKX1nZXQgaGFzSW5zdGFuY2VzKCl7cmV0dXJuIHRoaXMuaW5zdGFuY2VzLmxlbmd0aD4wfWdldCBoYXNUaGluSW5zdGFuY2VzKCl7dmFyIGU7cmV0dXJuKChlPXRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0NvdW50KSE9PW51bGwmJmUhPT12b2lkIDA/ZTowKT4wfWdldCBmb3JjZWRJbnN0YW5jZUNvdW50KCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9mb3JjZWRJbnN0YW5jZUNvdW50fXNldCBmb3JjZWRJbnN0YW5jZUNvdW50KGUpe3RoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9mb3JjZWRJbnN0YW5jZUNvdW50PWV9Z2V0IHNvdXJjZSgpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlfWdldCBjbG9uZU1lc2hNYXAoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8ubWVzaE1hcH1nZXQgaXNVbkluZGV4ZWQoKXtyZXR1cm4gdGhpcy5fdW5JbmRleGVkfXNldCBpc1VuSW5kZXhlZChlKXt0aGlzLl91bkluZGV4ZWQhPT1lJiYodGhpcy5fdW5JbmRleGVkPWUsdGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCkpfWdldCB3b3JsZE1hdHJpeEluc3RhbmNlZEJ1ZmZlcigpe3JldHVybiB0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0RhdGF9Z2V0IHByZXZpb3VzV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pbnN0YW5jZXNQcmV2aW91c0RhdGF9Z2V0IG1hbnVhbFVwZGF0ZU9mV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5tYW51YWxVcGRhdGV9c2V0IG1hbnVhbFVwZGF0ZU9mV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXIoZSl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5tYW51YWxVcGRhdGU9ZX1nZXQgbWFudWFsVXBkYXRlT2ZQcmV2aW91c1dvcmxkTWF0cml4SW5zdGFuY2VkQnVmZmVyKCl7cmV0dXJuIHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYW51YWxVcGRhdGV9c2V0IG1hbnVhbFVwZGF0ZU9mUHJldmlvdXNXb3JsZE1hdHJpeEluc3RhbmNlZEJ1ZmZlcihlKXt0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzTWFudWFsVXBkYXRlPWV9Z2V0IGZvcmNlV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXJVcGRhdGUoKXtyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5mb3JjZU1hdHJpeFVwZGF0ZXN9c2V0IGZvcmNlV29ybGRNYXRyaXhJbnN0YW5jZWRCdWZmZXJVcGRhdGUoZSl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5mb3JjZU1hdHJpeFVwZGF0ZXM9ZX1pbnN0YW50aWF0ZUhpZXJhcmNoeShlPW51bGwsdCxpKXtjb25zdCBzPXRoaXMuZ2V0VG90YWxWZXJ0aWNlcygpPT09MHx8dCYmdC5kb05vdEluc3RhbnRpYXRlJiYodC5kb05vdEluc3RhbnRpYXRlPT09ITB8fHQuZG9Ob3RJbnN0YW50aWF0ZSh0aGlzKSk/dGhpcy5jbG9uZSgiQ2xvbmUgb2YgIisodGhpcy5uYW1lfHx0aGlzLmlkKSxlfHx0aGlzLnBhcmVudCwhMCk6dGhpcy5jcmVhdGVJbnN0YW5jZSgiaW5zdGFuY2Ugb2YgIisodGhpcy5uYW1lfHx0aGlzLmlkKSk7cy5wYXJlbnQ9ZXx8dGhpcy5wYXJlbnQscy5wb3NpdGlvbj10aGlzLnBvc2l0aW9uLmNsb25lKCkscy5zY2FsaW5nPXRoaXMuc2NhbGluZy5jbG9uZSgpLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP3Mucm90YXRpb25RdWF0ZXJuaW9uPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uLmNsb25lKCk6cy5yb3RhdGlvbj10aGlzLnJvdGF0aW9uLmNsb25lKCksaSYmaSh0aGlzLHMpO2Zvcihjb25zdCByIG9mIHRoaXMuZ2V0Q2hpbGRUcmFuc2Zvcm1Ob2RlcyghMCkpci5nZXRDbGFzc05hbWUoKT09PSJJbnN0YW5jZWRNZXNoIiYmcy5nZXRDbGFzc05hbWUoKT09PSJNZXNoIj9yLmluc3RhbnRpYXRlSGllcmFyY2h5KHMse2RvTm90SW5zdGFudGlhdGU6dCYmdC5kb05vdEluc3RhbnRpYXRlfHwhMSxuZXdTb3VyY2VkTWVzaDpzfSxpKTpyLmluc3RhbnRpYXRlSGllcmFyY2h5KHMsdCxpKTtyZXR1cm4gc31nZXRDbGFzc05hbWUoKXtyZXR1cm4iTWVzaCJ9Z2V0IF9pc01lc2goKXtyZXR1cm4hMH10b1N0cmluZyhlKXtsZXQgdD1zdXBlci50b1N0cmluZyhlKTtpZih0Kz0iLCBuIHZlcnRpY2VzOiAiK3RoaXMuZ2V0VG90YWxWZXJ0aWNlcygpLHQrPSIsIHBhcmVudDogIisodGhpcy5fd2FpdGluZ1BhcmVudElkP3RoaXMuX3dhaXRpbmdQYXJlbnRJZDp0aGlzLnBhcmVudD90aGlzLnBhcmVudC5uYW1lOiJOT05FIiksdGhpcy5hbmltYXRpb25zKWZvcihsZXQgaT0wO2k8dGhpcy5hbmltYXRpb25zLmxlbmd0aDtpKyspdCs9IiwgYW5pbWF0aW9uWzBdOiAiK3RoaXMuYW5pbWF0aW9uc1tpXS50b1N0cmluZyhlKTtpZihlKWlmKHRoaXMuX2dlb21ldHJ5KXtjb25zdCBpPXRoaXMuZ2V0SW5kaWNlcygpLHM9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpO3MmJmkmJih0Kz0iLCBmbGF0IHNoYWRpbmc6ICIrKHMubGVuZ3RoLzM9PT1pLmxlbmd0aD8iWUVTIjoiTk8iKSl9ZWxzZSB0Kz0iLCBmbGF0IHNoYWRpbmc6IFVOS05PV04iO3JldHVybiB0fV91bkJpbmRFZmZlY3QoKXtzdXBlci5fdW5CaW5kRWZmZWN0KCk7Zm9yKGNvbnN0IGUgb2YgdGhpcy5pbnN0YW5jZXMpZS5fdW5CaW5kRWZmZWN0KCl9Z2V0IGhhc0xPRExldmVscygpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fTE9ETGV2ZWxzLmxlbmd0aD4wfWdldExPRExldmVscygpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fTE9ETGV2ZWxzfV9zb3J0TE9ETGV2ZWxzKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fdXNlTE9EU2NyZWVuQ292ZXJhZ2U/LTE6MTt0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fTE9ETGV2ZWxzLnNvcnQoKHQsaSk9PnQuZGlzdGFuY2VPclNjcmVlbkNvdmVyYWdlPGkuZGlzdGFuY2VPclNjcmVlbkNvdmVyYWdlP2U6dC5kaXN0YW5jZU9yU2NyZWVuQ292ZXJhZ2U+aS5kaXN0YW5jZU9yU2NyZWVuQ292ZXJhZ2U/LWU6MCl9YWRkTE9ETGV2ZWwoZSx0KXtpZih0JiZ0Ll9tYXN0ZXJNZXNoKXJldHVybiBPLldhcm4oIllvdSBjYW5ub3QgdXNlIGEgbWVzaCBhcyBMT0QgbGV2ZWwgdHdpY2UiKSx0aGlzO2NvbnN0IGk9bmV3IFduKGUsdCk7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9MT0RMZXZlbHMucHVzaChpKSx0JiYodC5fbWFzdGVyTWVzaD10aGlzKSx0aGlzLl9zb3J0TE9ETGV2ZWxzKCksdGhpc31nZXRMT0RMZXZlbEF0RGlzdGFuY2UoZSl7Y29uc3QgdD10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbztmb3IobGV0IGk9MDtpPHQuX0xPRExldmVscy5sZW5ndGg7aSsrKXtjb25zdCBzPXQuX0xPRExldmVsc1tpXTtpZihzLmRpc3RhbmNlT3JTY3JlZW5Db3ZlcmFnZT09PWUpcmV0dXJuIHMubWVzaH1yZXR1cm4gbnVsbH1yZW1vdmVMT0RMZXZlbChlKXtjb25zdCB0PXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvO2ZvcihsZXQgaT0wO2k8dC5fTE9ETGV2ZWxzLmxlbmd0aDtpKyspdC5fTE9ETGV2ZWxzW2ldLm1lc2g9PT1lJiYodC5fTE9ETGV2ZWxzLnNwbGljZShpLDEpLGUmJihlLl9tYXN0ZXJNZXNoPW51bGwpKTtyZXR1cm4gdGhpcy5fc29ydExPRExldmVscygpLHRoaXN9Z2V0TE9EKGUsdCl7Y29uc3QgaT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbztpZighaS5fTE9ETGV2ZWxzfHxpLl9MT0RMZXZlbHMubGVuZ3RoPT09MClyZXR1cm4gdGhpcztjb25zdCBzPXR8fHRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUscj1lLm1vZGU9PT1qLk9SVEhPR1JBUEhJQ19DQU1FUkE/ZS5taW5aOnMuY2VudGVyV29ybGQuc3VidHJhY3QoZS5nbG9iYWxQb3NpdGlvbikubGVuZ3RoKCk7bGV0IG49cixhPTE7aWYoaS5fdXNlTE9EU2NyZWVuQ292ZXJhZ2Upe2NvbnN0IG89ZS5zY3JlZW5BcmVhO2xldCBoPXMucmFkaXVzV29ybGQqZS5taW5aL3I7aD1oKmgqTWF0aC5QSSxuPWgvbyxhPS0xfWlmKGEqaS5fTE9ETGV2ZWxzW2kuX0xPRExldmVscy5sZW5ndGgtMV0uZGlzdGFuY2VPclNjcmVlbkNvdmVyYWdlPmEqbilyZXR1cm4gdGhpcy5vbkxPRExldmVsU2VsZWN0aW9uJiZ0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24obix0aGlzLHRoaXMpLHRoaXM7Zm9yKGxldCBvPTA7bzxpLl9MT0RMZXZlbHMubGVuZ3RoO28rKyl7Y29uc3QgaD1pLl9MT0RMZXZlbHNbb107aWYoYSpoLmRpc3RhbmNlT3JTY3JlZW5Db3ZlcmFnZTxhKm4pe2lmKGgubWVzaCl7aWYoaC5tZXNoLmRlbGF5TG9hZFN0YXRlPT09NClyZXR1cm4gaC5tZXNoLl9jaGVja0RlbGF5U3RhdGUoKSx0aGlzO2lmKGgubWVzaC5kZWxheUxvYWRTdGF0ZT09PTIpcmV0dXJuIHRoaXM7aC5tZXNoLl9wcmVBY3RpdmF0ZSgpLGgubWVzaC5fdXBkYXRlU3ViTWVzaGVzQm91bmRpbmdJbmZvKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpfXJldHVybiB0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24mJnRoaXMub25MT0RMZXZlbFNlbGVjdGlvbihuLHRoaXMsaC5tZXNoKSxoLm1lc2h9fXJldHVybiB0aGlzLm9uTE9ETGV2ZWxTZWxlY3Rpb24mJnRoaXMub25MT0RMZXZlbFNlbGVjdGlvbihuLHRoaXMsdGhpcyksdGhpc31nZXQgZ2VvbWV0cnkoKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnl9Z2V0VG90YWxWZXJ0aWNlcygpe3JldHVybiB0aGlzLl9nZW9tZXRyeT09PW51bGx8fHRoaXMuX2dlb21ldHJ5PT09dm9pZCAwPzA6dGhpcy5fZ2VvbWV0cnkuZ2V0VG90YWxWZXJ0aWNlcygpfWdldFZlcnRpY2VzRGF0YShlLHQsaSl7dmFyIHMscjtpZighdGhpcy5fZ2VvbWV0cnkpcmV0dXJuIG51bGw7bGV0IG49KHI9KHM9dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlKT09PW51bGx8fHM9PT12b2lkIDA/dm9pZCAwOnMudmVydGV4QnVmZmVyc1tlXSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLmdldEZsb2F0RGF0YSh0aGlzLl9nZW9tZXRyeS5nZXRUb3RhbFZlcnRpY2VzKCksaXx8dCYmdGhpcy5fZ2VvbWV0cnkubWVzaGVzLmxlbmd0aCE9PTEpO3JldHVybiBufHwobj10aGlzLl9nZW9tZXRyeS5nZXRWZXJ0aWNlc0RhdGEoZSx0LGkpKSxufWdldFZlcnRleEJ1ZmZlcihlKXt2YXIgdCxpO3JldHVybiB0aGlzLl9nZW9tZXRyeT8oaT0odD10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC52ZXJ0ZXhCdWZmZXJzW2VdKSE9PW51bGwmJmkhPT12b2lkIDA/aTp0aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXhCdWZmZXIoZSk6bnVsbH1pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZSl7dmFyIHQ7cmV0dXJuIHRoaXMuX2dlb21ldHJ5PygodD10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC52ZXJ0ZXhCdWZmZXJzW2VdKSE9PXZvaWQgMHx8dGhpcy5fZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpOnRoaXMuX2RlbGF5SW5mbz90aGlzLl9kZWxheUluZm8uaW5kZXhPZihlKSE9PS0xOiExfWlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGUpe3ZhciB0LGk7cmV0dXJuIHRoaXMuX2dlb21ldHJ5PygoaT0odD10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpPT09bnVsbHx8dD09PXZvaWQgMD92b2lkIDA6dC52ZXJ0ZXhCdWZmZXJzW2VdKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmkuaXNVcGRhdGFibGUoKSl8fHRoaXMuX2dlb21ldHJ5LmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGUpOnRoaXMuX2RlbGF5SW5mbz90aGlzLl9kZWxheUluZm8uaW5kZXhPZihlKSE9PS0xOiExfWdldFZlcnRpY2VzRGF0YUtpbmRzKCl7aWYoIXRoaXMuX2dlb21ldHJ5KXtjb25zdCB0PW5ldyBBcnJheTtyZXR1cm4gdGhpcy5fZGVsYXlJbmZvJiZ0aGlzLl9kZWxheUluZm8uZm9yRWFjaChmdW5jdGlvbihpKXt0LnB1c2goaSl9KSx0fWNvbnN0IGU9dGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGljZXNEYXRhS2luZHMoKTtpZih0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UpZm9yKGNvbnN0IHQgaW4gdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMpZS5wdXNoKHQpO3JldHVybiBlfWdldFRvdGFsSW5kaWNlcygpe3JldHVybiB0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5nZXRUb3RhbEluZGljZXMoKTowfWdldEluZGljZXMoZSx0KXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuZ2V0SW5kaWNlcyhlLHQpOltdfWdldCBpc0Jsb2NrZWQoKXtyZXR1cm4gdGhpcy5fbWFzdGVyTWVzaCE9PW51bGwmJnRoaXMuX21hc3Rlck1lc2ghPT12b2lkIDB9aXNSZWFkeShlPSExLHQ9ITEpe3ZhciBpLHMscixuLGEsbztpZih0aGlzLmRlbGF5TG9hZFN0YXRlPT09Mnx8IXN1cGVyLmlzUmVhZHkoZSkpcmV0dXJuITE7aWYoIXRoaXMuc3ViTWVzaGVzfHx0aGlzLnN1Yk1lc2hlcy5sZW5ndGg9PT0wfHwhZSlyZXR1cm4hMDtjb25zdCBoPXRoaXMuZ2V0RW5naW5lKCksbD10aGlzLmdldFNjZW5lKCksdT10fHxoLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMmJih0aGlzLmluc3RhbmNlcy5sZW5ndGg+MHx8dGhpcy5oYXNUaGluSW5zdGFuY2VzKTt0aGlzLmNvbXB1dGVXb3JsZE1hdHJpeCgpO2NvbnN0IGQ9dGhpcy5tYXRlcmlhbHx8bC5kZWZhdWx0TWF0ZXJpYWw7aWYoZCl7aWYoZC5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcylmb3IoY29uc3QgXyBvZiB0aGlzLnN1Yk1lc2hlcyl7Y29uc3QgRT1fLmdldE1hdGVyaWFsKCk7aWYoRSl7aWYoRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyl7aWYoIUUuaXNSZWFkeUZvclN1Yk1lc2godGhpcyxfLHUpKXJldHVybiExfWVsc2UgaWYoIUUuaXNSZWFkeSh0aGlzLHUpKXJldHVybiExfX1lbHNlIGlmKCFkLmlzUmVhZHkodGhpcyx1KSlyZXR1cm4hMX1jb25zdCBmPWguY3VycmVudFJlbmRlclBhc3NJZDtmb3IoY29uc3QgXyBvZiB0aGlzLmxpZ2h0U291cmNlcyl7Y29uc3QgRT1fLmdldFNoYWRvd0dlbmVyYXRvcnMoKTtpZighRSljb250aW51ZTtjb25zdCBtPUUudmFsdWVzKCk7Zm9yKGxldCB2PW0ubmV4dCgpO3YuZG9uZSE9PSEwO3Y9bS5uZXh0KCkpe2NvbnN0IFM9di52YWx1ZTtpZihTJiYoISghKChpPVMuZ2V0U2hhZG93TWFwKCkpPT09bnVsbHx8aT09PXZvaWQgMCkmJmkucmVuZGVyTGlzdCl8fCEoKHM9Uy5nZXRTaGFkb3dNYXAoKSk9PT1udWxsfHxzPT09dm9pZCAwKSYmcy5yZW5kZXJMaXN0JiYoKG49KHI9Uy5nZXRTaGFkb3dNYXAoKSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLnJlbmRlckxpc3QpPT09bnVsbHx8bj09PXZvaWQgMD92b2lkIDA6bi5pbmRleE9mKHRoaXMpKSE9PS0xKSl7Uy5nZXRTaGFkb3dNYXAoKSYmKGguY3VycmVudFJlbmRlclBhc3NJZD1TLmdldFNoYWRvd01hcCgpLnJlbmRlclBhc3NJZCk7Zm9yKGNvbnN0IHkgb2YgdGhpcy5zdWJNZXNoZXMpaWYoIVMuaXNSZWFkeSh5LHUsKG89KGE9eS5nZXRNYXRlcmlhbCgpKT09PW51bGx8fGE9PT12b2lkIDA/dm9pZCAwOmEubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKHRoaXMpKSE9PW51bGwmJm8hPT12b2lkIDA/bzohMSkpcmV0dXJuIGguY3VycmVudFJlbmRlclBhc3NJZD1mLCExO2guY3VycmVudFJlbmRlclBhc3NJZD1mfX19Zm9yKGNvbnN0IF8gb2YgdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX0xPRExldmVscylpZihfLm1lc2gmJiFfLm1lc2guaXNSZWFkeSh1KSlyZXR1cm4hMTtyZXR1cm4hMH1nZXQgYXJlTm9ybWFsc0Zyb3plbigpe3JldHVybiB0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fYXJlTm9ybWFsc0Zyb3plbn1mcmVlemVOb3JtYWxzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9hcmVOb3JtYWxzRnJvemVuPSEwLHRoaXN9dW5mcmVlemVOb3JtYWxzKCl7cmV0dXJuIHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9hcmVOb3JtYWxzRnJvemVuPSExLHRoaXN9c2V0IG92ZXJyaWRlbkluc3RhbmNlQ291bnQoZSl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5vdmVycmlkZW5JbnN0YW5jZUNvdW50PWV9X3ByZUFjdGl2YXRlKCl7Y29uc3QgZT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbyx0PXRoaXMuZ2V0U2NlbmUoKS5nZXRSZW5kZXJJZCgpO3JldHVybiBlLl9wcmVBY3RpdmF0ZUlkPT09dD90aGlzOihlLl9wcmVBY3RpdmF0ZUlkPXQsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS52aXNpYmxlSW5zdGFuY2VzPW51bGwsdGhpcyl9X3ByZUFjdGl2YXRlRm9ySW50ZXJtZWRpYXRlUmVuZGVyaW5nKGUpe3JldHVybiB0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXMmJih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXMuaW50ZXJtZWRpYXRlRGVmYXVsdFJlbmRlcklkPWUpLHRoaXN9X3JlZ2lzdGVySW5zdGFuY2VGb3JSZW5kZXJJZChlLHQpe3JldHVybiB0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXN8fCh0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXM9e2RlZmF1bHRSZW5kZXJJZDp0LHNlbGZEZWZhdWx0UmVuZGVySWQ6dGhpcy5fcmVuZGVySWR9KSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdF18fCh0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzUmVuZGVySWQhPT12b2lkIDAmJnRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuaXNGcm96ZW4mJih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5wcmV2aW91c1JlbmRlcklkXT1udWxsKSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzUmVuZGVySWQ9dCx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdF09bmV3IEFycmF5KSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnZpc2libGVJbnN0YW5jZXNbdF0ucHVzaChlKSx0aGlzfV9hZnRlckNvbXB1dGVXb3JsZE1hdHJpeCgpe3N1cGVyLl9hZnRlckNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMuaGFzVGhpbkluc3RhbmNlcyYmKHRoaXMuZG9Ob3RTeW5jQm91bmRpbmdJbmZvfHx0aGlzLnRoaW5JbnN0YW5jZVJlZnJlc2hCb3VuZGluZ0luZm8oITEpKX1fcG9zdEFjdGl2YXRlKCl7dGhpcy5lZGdlc1NoYXJlV2l0aEluc3RhbmNlcyYmdGhpcy5lZGdlc1JlbmRlcmVyJiZ0aGlzLmVkZ2VzUmVuZGVyZXIuaXNFbmFibGVkJiZ0aGlzLl9yZW5kZXJpbmdHcm91cCYmKHRoaXMuX3JlbmRlcmluZ0dyb3VwLl9lZGdlc1JlbmRlcmVycy5wdXNoTm9EdXBsaWNhdGUodGhpcy5lZGdlc1JlbmRlcmVyKSx0aGlzLmVkZ2VzUmVuZGVyZXIuY3VzdG9tSW5zdGFuY2VzLnB1c2godGhpcy5nZXRXb3JsZE1hdHJpeCgpKSl9cmVmcmVzaEJvdW5kaW5nSW5mbyhlPSExLHQ9ITEpe2lmKHRoaXMuaGFzQm91bmRpbmdJbmZvJiZ0aGlzLmdldEJvdW5kaW5nSW5mbygpLmlzTG9ja2VkKXJldHVybiB0aGlzO2NvbnN0IGk9dGhpcy5nZW9tZXRyeT90aGlzLmdlb21ldHJ5LmJvdW5kaW5nQmlhczpudWxsO3JldHVybiB0aGlzLl9yZWZyZXNoQm91bmRpbmdJbmZvKHRoaXMuX2dldFBvc2l0aW9uRGF0YShlLHQpLGkpLHRoaXN9X2NyZWF0ZUdsb2JhbFN1Yk1lc2goZSl7Y29uc3QgdD10aGlzLmdldFRvdGFsVmVydGljZXMoKTtpZighdHx8IXRoaXMuZ2V0SW5kaWNlcygpKXJldHVybiBudWxsO2lmKHRoaXMuc3ViTWVzaGVzJiZ0aGlzLnN1Yk1lc2hlcy5sZW5ndGg+MCl7Y29uc3QgaT10aGlzLmdldEluZGljZXMoKTtpZighaSlyZXR1cm4gbnVsbDtjb25zdCBzPWkubGVuZ3RoO2xldCByPSExO2lmKGUpcj0hMDtlbHNlIGZvcihjb25zdCBuIG9mIHRoaXMuc3ViTWVzaGVzKXtpZihuLmluZGV4U3RhcnQrbi5pbmRleENvdW50PnMpe3I9ITA7YnJlYWt9aWYobi52ZXJ0aWNlc1N0YXJ0K24udmVydGljZXNDb3VudD50KXtyPSEwO2JyZWFrfX1pZighcilyZXR1cm4gdGhpcy5zdWJNZXNoZXNbMF19cmV0dXJuIHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLG5ldyB2dCgwLDAsdCwwLHRoaXMuZ2V0VG90YWxJbmRpY2VzKCksdGhpcyl9c3ViZGl2aWRlKGUpe2lmKGU8MSlyZXR1cm47Y29uc3QgdD10aGlzLmdldFRvdGFsSW5kaWNlcygpO2xldCBpPXQvZXwwLHM9MDtmb3IoO2klMyE9PTA7KWkrKzt0aGlzLnJlbGVhc2VTdWJNZXNoZXMoKTtmb3IobGV0IHI9MDtyPGUmJiEocz49dCk7cisrKXZ0LkNyZWF0ZUZyb21JbmRpY2VzKDAscyxyPT09ZS0xP3QtczppLHRoaXMpLHMrPWk7dGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpfXNldFZlcnRpY2VzRGF0YShlLHQsaT0hMSxzKXtpZih0aGlzLl9nZW9tZXRyeSl0aGlzLl9nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZSx0LGkscyk7ZWxzZXtjb25zdCByPW5ldyBlZTtyLnNldCh0LGUpO2NvbnN0IG49dGhpcy5nZXRTY2VuZSgpO25ldyBhdChhdC5SYW5kb21JZCgpLG4scixpLHRoaXMpfXJldHVybiB0aGlzfXJlbW92ZVZlcnRpY2VzRGF0YShlKXt0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGUpfW1hcmtWZXJ0aWNlc0RhdGFBc1VwZGF0YWJsZShlLHQ9ITApe2NvbnN0IGk9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIoZSk7IWl8fGkuaXNVcGRhdGFibGUoKT09PXR8fHRoaXMuc2V0VmVydGljZXNEYXRhKGUsdGhpcy5nZXRWZXJ0aWNlc0RhdGEoZSksdCl9c2V0VmVydGljZXNCdWZmZXIoZSx0PSEwKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnl8fCh0aGlzLl9nZW9tZXRyeT1hdC5DcmVhdGVHZW9tZXRyeUZvck1lc2godGhpcykpLHRoaXMuX2dlb21ldHJ5LnNldFZlcnRpY2VzQnVmZmVyKGUsbnVsbCx0KSx0aGlzfXVwZGF0ZVZlcnRpY2VzRGF0YShlLHQsaSxzKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/KHM/KHRoaXMubWFrZUdlb21ldHJ5VW5pcXVlKCksdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGksITEpKTp0aGlzLl9nZW9tZXRyeS51cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGkpLHRoaXMpOnRoaXN9dXBkYXRlTWVzaFBvc2l0aW9ucyhlLHQ9ITApe2NvbnN0IGk9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQpO2lmKCFpKXJldHVybiB0aGlzO2lmKGUoaSksdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsaSwhMSwhMSksdCl7Y29uc3Qgcz10aGlzLmdldEluZGljZXMoKSxyPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCk7aWYoIXIpcmV0dXJuIHRoaXM7ZWUuQ29tcHV0ZU5vcm1hbHMoaSxzLHIpLHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxyLCExLCExKX1yZXR1cm4gdGhpc31tYWtlR2VvbWV0cnlVbmlxdWUoKXtpZighdGhpcy5fZ2VvbWV0cnkpcmV0dXJuIHRoaXM7aWYodGhpcy5fZ2VvbWV0cnkubWVzaGVzLmxlbmd0aD09PTEpcmV0dXJuIHRoaXM7Y29uc3QgZT10aGlzLl9nZW9tZXRyeSx0PXRoaXMuX2dlb21ldHJ5LmNvcHkoYXQuUmFuZG9tSWQoKSk7cmV0dXJuIGUucmVsZWFzZUZvck1lc2godGhpcywhMCksdC5hcHBseVRvTWVzaCh0aGlzKSx0aGlzfXNldEluZGljZXMoZSx0PW51bGwsaT0hMSl7aWYodGhpcy5fZ2VvbWV0cnkpdGhpcy5fZ2VvbWV0cnkuc2V0SW5kaWNlcyhlLHQsaSk7ZWxzZXtjb25zdCBzPW5ldyBlZTtzLmluZGljZXM9ZTtjb25zdCByPXRoaXMuZ2V0U2NlbmUoKTtuZXcgYXQoYXQuUmFuZG9tSWQoKSxyLHMsaSx0aGlzKX1yZXR1cm4gdGhpc311cGRhdGVJbmRpY2VzKGUsdCxpPSExKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/KHRoaXMuX2dlb21ldHJ5LnVwZGF0ZUluZGljZXMoZSx0LGkpLHRoaXMpOnRoaXN9dG9MZWZ0SGFuZGVkKCl7cmV0dXJuIHRoaXMuX2dlb21ldHJ5Pyh0aGlzLl9nZW9tZXRyeS50b0xlZnRIYW5kZWQoKSx0aGlzKTp0aGlzfV9iaW5kKGUsdCxpKXtpZighdGhpcy5fZ2VvbWV0cnkpcmV0dXJuIHRoaXM7Y29uc3Qgcz10aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCk7dGhpcy5tb3JwaFRhcmdldE1hbmFnZXImJnRoaXMubW9ycGhUYXJnZXRNYW5hZ2VyLmlzVXNpbmdUZXh0dXJlRm9yVGFyZ2V0cyYmdGhpcy5tb3JwaFRhcmdldE1hbmFnZXIuX2JpbmQodCk7bGV0IHI7aWYodGhpcy5fdW5JbmRleGVkKXI9bnVsbDtlbHNlIHN3aXRjaChpKXtjYXNlIFAuUG9pbnRGaWxsTW9kZTpyPW51bGw7YnJlYWs7Y2FzZSBQLldpcmVGcmFtZUZpbGxNb2RlOnI9ZS5fZ2V0TGluZXNJbmRleEJ1ZmZlcih0aGlzLmdldEluZGljZXMoKSxzKTticmVhaztkZWZhdWx0OmNhc2UgUC5UcmlhbmdsZUZpbGxNb2RlOnI9dGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKTticmVha31yZXR1cm4hdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlfHx0aGlzLmhhc1RoaW5JbnN0YW5jZXM/dGhpcy5fZ2VvbWV0cnkuX2JpbmQodCxyKTp0aGlzLl9nZW9tZXRyeS5fYmluZCh0LHIsdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMsdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEFycmF5T2JqZWN0cyksdGhpc31fZHJhdyhlLHQsaSl7aWYoIXRoaXMuX2dlb21ldHJ5fHwhdGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGV4QnVmZmVycygpfHwhdGhpcy5fdW5JbmRleGVkJiYhdGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKSlyZXR1cm4gdGhpczt0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVEcmF3T2JzZXJ2YWJsZSYmdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlRHJhd09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO3JldHVybiB0aGlzLl91bkluZGV4ZWR8fHQ9PVAuUG9pbnRGaWxsTW9kZT9yLmRyYXdBcnJheXNUeXBlKHQsZS52ZXJ0aWNlc1N0YXJ0LGUudmVydGljZXNDb3VudCx0aGlzLmZvcmNlZEluc3RhbmNlQ291bnR8fGkpOnQ9PVAuV2lyZUZyYW1lRmlsbE1vZGU/ci5kcmF3RWxlbWVudHNUeXBlKHQsMCxlLl9saW5lc0luZGV4Q291bnQsdGhpcy5mb3JjZWRJbnN0YW5jZUNvdW50fHxpKTpyLmRyYXdFbGVtZW50c1R5cGUodCxlLmluZGV4U3RhcnQsZS5pbmRleENvdW50LHRoaXMuZm9yY2VkSW5zdGFuY2VDb3VudHx8aSksdGhpc31yZWdpc3RlckJlZm9yZVJlbmRlcihlKXtyZXR1cm4gdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpLHRoaXN9dW5yZWdpc3RlckJlZm9yZVJlbmRlcihlKXtyZXR1cm4gdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlQ2FsbGJhY2soZSksdGhpc31yZWdpc3RlckFmdGVyUmVuZGVyKGUpe3JldHVybiB0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKSx0aGlzfXVucmVnaXN0ZXJBZnRlclJlbmRlcihlKXtyZXR1cm4gdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmVDYWxsYmFjayhlKSx0aGlzfV9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KGUsdD0hMSl7aWYodGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbil7aWYodClyZXR1cm4gdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5iYXRjaENhY2hlUmVwbGFjZW1lbnRNb2RlSW5Gcm96ZW5Nb2RlLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nW2VdPSExLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuYmF0Y2hDYWNoZVJlcGxhY2VtZW50TW9kZUluRnJvemVuTW9kZS5yZW5kZXJTZWxmW2VdPSEwLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuYmF0Y2hDYWNoZVJlcGxhY2VtZW50TW9kZUluRnJvemVuTW9kZTtpZih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzQmF0Y2gpcmV0dXJuIHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNCYXRjaH1jb25zdCBpPXRoaXMuZ2V0U2NlbmUoKSxzPWkuX2lzSW5JbnRlcm1lZGlhdGVSZW5kZXJpbmcoKSxyPXM/dGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fb25seUZvckluc3RhbmNlc0ludGVybWVkaWF0ZTp0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9vbmx5Rm9ySW5zdGFuY2VzLG49dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5iYXRjaENhY2hlO2lmKG4ubXVzdFJldHVybj0hMSxuLnJlbmRlclNlbGZbZV09dHx8IXImJnRoaXMuaXNFbmFibGVkKCkmJnRoaXMuaXNWaXNpYmxlLG4udmlzaWJsZUluc3RhbmNlc1tlXT1udWxsLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UudmlzaWJsZUluc3RhbmNlcyYmIXQpe2NvbnN0IGE9dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS52aXNpYmxlSW5zdGFuY2VzLG89aS5nZXRSZW5kZXJJZCgpLGg9cz9hLmludGVybWVkaWF0ZURlZmF1bHRSZW5kZXJJZDphLmRlZmF1bHRSZW5kZXJJZDtuLnZpc2libGVJbnN0YW5jZXNbZV09YVtvXSwhbi52aXNpYmxlSW5zdGFuY2VzW2VdJiZoJiYobi52aXNpYmxlSW5zdGFuY2VzW2VdPWFbaF0pfXJldHVybiBuLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nW2VdPSF0JiZ0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nJiZuLnZpc2libGVJbnN0YW5jZXNbZV0hPT1udWxsJiZuLnZpc2libGVJbnN0YW5jZXNbZV0hPT12b2lkIDAsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5wcmV2aW91c0JhdGNoPW4sbn1fcmVuZGVyV2l0aEluc3RhbmNlcyhlLHQsaSxzLHIpe3ZhciBuO2NvbnN0IGE9aS52aXNpYmxlSW5zdGFuY2VzW2UuX2lkXSxvPWE/YS5sZW5ndGg6MCxoPXRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UsbD1oLmluc3RhbmNlc0J1ZmZlclNpemU7bGV0IHU9aC5pbnN0YW5jZXNCdWZmZXIsZD1oLmluc3RhbmNlc1ByZXZpb3VzQnVmZmVyO2NvbnN0IF89KG8rMSkqMTYqNDtmb3IoO2guaW5zdGFuY2VzQnVmZmVyU2l6ZTxfOyloLmluc3RhbmNlc0J1ZmZlclNpemUqPTI7KCFoLmluc3RhbmNlc0RhdGF8fGwhPWguaW5zdGFuY2VzQnVmZmVyU2l6ZSkmJihoLmluc3RhbmNlc0RhdGE9bmV3IEZsb2F0MzJBcnJheShoLmluc3RhbmNlc0J1ZmZlclNpemUvNCkpLCh0aGlzLl9zY2VuZS5uZWVkc1ByZXZpb3VzV29ybGRNYXRyaWNlcyYmIWguaW5zdGFuY2VzUHJldmlvdXNEYXRhfHxsIT1oLmluc3RhbmNlc0J1ZmZlclNpemUpJiYoaC5pbnN0YW5jZXNQcmV2aW91c0RhdGE9bmV3IEZsb2F0MzJBcnJheShoLmluc3RhbmNlc0J1ZmZlclNpemUvNCkpO2xldCBFPTAsbT0wO2NvbnN0IHY9aS5yZW5kZXJTZWxmW2UuX2lkXSxTPSF1fHxsIT09aC5pbnN0YW5jZXNCdWZmZXJTaXplfHx0aGlzLl9zY2VuZS5uZWVkc1ByZXZpb3VzV29ybGRNYXRyaWNlcyYmIWguaW5zdGFuY2VzUHJldmlvdXNCdWZmZXI7aWYoIXRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UubWFudWFsVXBkYXRlJiYoIWguaXNGcm96ZW58fFMpKXtjb25zdCB5PXRoaXMuZ2V0V29ybGRNYXRyaXgoKTtpZih2JiYodGhpcy5fc2NlbmUubmVlZHNQcmV2aW91c1dvcmxkTWF0cmljZXMmJihoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4PyhoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4LmNvcHlUb0FycmF5KGguaW5zdGFuY2VzUHJldmlvdXNEYXRhLEUpLGgubWFzdGVyTWVzaFByZXZpb3VzV29ybGRNYXRyaXguY29weUZyb20oeSkpOihoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4PXkuY2xvbmUoKSxoLm1hc3Rlck1lc2hQcmV2aW91c1dvcmxkTWF0cml4LmNvcHlUb0FycmF5KGguaW5zdGFuY2VzUHJldmlvdXNEYXRhLEUpKSkseS5jb3B5VG9BcnJheShoLmluc3RhbmNlc0RhdGEsRSksRSs9MTYsbSsrKSxhKXtpZihXLklOU1RBTkNFRE1FU0hfU09SVF9UUkFOU1BBUkVOVCYmdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhJiYoISgobj1lLmdldE1hdGVyaWFsKCkpPT09bnVsbHx8bj09PXZvaWQgMCkmJm4ubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKGUuZ2V0UmVuZGVyaW5nTWVzaCgpKSkpe2NvbnN0IEE9dGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhLmdsb2JhbFBvc2l0aW9uO2ZvcihsZXQgQz0wO0M8YS5sZW5ndGg7QysrKXtjb25zdCBiPWFbQ107Yi5fZGlzdGFuY2VUb0NhbWVyYT1wLkRpc3RhbmNlKGIuZ2V0Qm91bmRpbmdJbmZvKCkuYm91bmRpbmdTcGhlcmUuY2VudGVyV29ybGQsQSl9YS5zb3J0KChDLGIpPT5DLl9kaXN0YW5jZVRvQ2FtZXJhPmIuX2Rpc3RhbmNlVG9DYW1lcmE/LTE6Qy5fZGlzdGFuY2VUb0NhbWVyYTxiLl9kaXN0YW5jZVRvQ2FtZXJhPzE6MCl9Zm9yKGxldCBBPTA7QTxhLmxlbmd0aDtBKyspe2NvbnN0IEM9YVtBXSxiPUMuZ2V0V29ybGRNYXRyaXgoKTtiLmNvcHlUb0FycmF5KGguaW5zdGFuY2VzRGF0YSxFKSx0aGlzLl9zY2VuZS5uZWVkc1ByZXZpb3VzV29ybGRNYXRyaWNlcyYmKEMuX3ByZXZpb3VzV29ybGRNYXRyaXg/KEMuX3ByZXZpb3VzV29ybGRNYXRyaXguY29weVRvQXJyYXkoaC5pbnN0YW5jZXNQcmV2aW91c0RhdGEsRSksQy5fcHJldmlvdXNXb3JsZE1hdHJpeC5jb3B5RnJvbShiKSk6KEMuX3ByZXZpb3VzV29ybGRNYXRyaXg9Yi5jbG9uZSgpLEMuX3ByZXZpb3VzV29ybGRNYXRyaXguY29weVRvQXJyYXkoaC5pbnN0YW5jZXNQcmV2aW91c0RhdGEsRSkpKSxFKz0xNixtKyt9fX1lbHNlIG09KHY/MTowKStvO3JldHVybiBTPyh1JiZ1LmRpc3Bvc2UoKSxkJiZkLmRpc3Bvc2UoKSx1PW5ldyAkaShyLGguaW5zdGFuY2VzRGF0YSwhMCwxNiwhMSwhMCksaC5pbnN0YW5jZXNCdWZmZXI9dSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2V8fCh0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2U9e2RhdGE6e30sdmVydGV4QnVmZmVyczp7fSxzdHJpZGVzOnt9LHNpemVzOnt9LHZlcnRleEFycmF5T2JqZWN0czp0aGlzLmdldEVuZ2luZSgpLmdldENhcHMoKS52ZXJ0ZXhBcnJheU9iamVjdD97fTp2b2lkIDB9KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDA9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMCIsMCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDE9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMSIsNCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDI9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMiIsOCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy53b3JsZDM9dS5jcmVhdGVWZXJ0ZXhCdWZmZXIoIndvcmxkMyIsMTIsNCksdGhpcy5fc2NlbmUubmVlZHNQcmV2aW91c1dvcmxkTWF0cmljZXMmJihkPW5ldyAkaShyLGguaW5zdGFuY2VzUHJldmlvdXNEYXRhLCEwLDE2LCExLCEwKSxoLmluc3RhbmNlc1ByZXZpb3VzQnVmZmVyPWQsdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMucHJldmlvdXNXb3JsZDA9ZC5jcmVhdGVWZXJ0ZXhCdWZmZXIoInByZXZpb3VzV29ybGQwIiwwLDQpLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhCdWZmZXJzLnByZXZpb3VzV29ybGQxPWQuY3JlYXRlVmVydGV4QnVmZmVyKCJwcmV2aW91c1dvcmxkMSIsNCw0KSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycy5wcmV2aW91c1dvcmxkMj1kLmNyZWF0ZVZlcnRleEJ1ZmZlcigicHJldmlvdXNXb3JsZDIiLDgsNCksdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnMucHJldmlvdXNXb3JsZDM9ZC5jcmVhdGVWZXJ0ZXhCdWZmZXIoInByZXZpb3VzV29ybGQzIiwxMiw0KSksdGhpcy5faW52YWxpZGF0ZUluc3RhbmNlVmVydGV4QXJyYXlPYmplY3QoKSk6KCF0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmlzRnJvemVufHx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmZvcmNlTWF0cml4VXBkYXRlcykmJih1LnVwZGF0ZURpcmVjdGx5KGguaW5zdGFuY2VzRGF0YSwwLG0pLHRoaXMuX3NjZW5lLm5lZWRzUHJldmlvdXNXb3JsZE1hdHJpY2VzJiYoIXRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UubWFudWFsVXBkYXRlfHx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzTWFudWFsVXBkYXRlKSYmZC51cGRhdGVEaXJlY3RseShoLmluc3RhbmNlc1ByZXZpb3VzRGF0YSwwLG0pKSx0aGlzLl9wcm9jZXNzSW5zdGFuY2VkQnVmZmVycyhhLHYpLHRoaXMuZ2V0U2NlbmUoKS5fYWN0aXZlSW5kaWNlcy5hZGRDb3VudChlLmluZGV4Q291bnQqbSwhMSksci5fY3VycmVudERyYXdDb250ZXh0JiYoci5fY3VycmVudERyYXdDb250ZXh0LnVzZUluc3RhbmNpbmc9ITApLHRoaXMuX2JpbmQoZSxzLHQpLHRoaXMuX2RyYXcoZSx0LG0pLHRoaXMuX3NjZW5lLm5lZWRzUHJldmlvdXNXb3JsZE1hdHJpY2VzJiYhUyYmdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5tYW51YWxVcGRhdGUmJighdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbnx8dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5mb3JjZU1hdHJpeFVwZGF0ZXMpJiYhdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5wcmV2aW91c01hbnVhbFVwZGF0ZSYmZC51cGRhdGVEaXJlY3RseShoLmluc3RhbmNlc0RhdGEsMCxtKSxyLnVuYmluZEluc3RhbmNlQXR0cmlidXRlcygpLHRoaXN9X3JlbmRlcldpdGhUaGluSW5zdGFuY2VzKGUsdCxpLHMpe3ZhciByLG47Y29uc3QgYT0obj0ocj10aGlzLl90aGluSW5zdGFuY2VEYXRhU3RvcmFnZSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLmluc3RhbmNlc0NvdW50KSE9PW51bGwmJm4hPT12b2lkIDA/bjowO3RoaXMuZ2V0U2NlbmUoKS5fYWN0aXZlSW5kaWNlcy5hZGRDb3VudChlLmluZGV4Q291bnQqYSwhMSkscy5fY3VycmVudERyYXdDb250ZXh0JiYocy5fY3VycmVudERyYXdDb250ZXh0LnVzZUluc3RhbmNpbmc9ITApLHRoaXMuX2JpbmQoZSxpLHQpLHRoaXMuX2RyYXcoZSx0LGEpLHRoaXMuX3NjZW5lLm5lZWRzUHJldmlvdXNXb3JsZE1hdHJpY2VzJiYhdGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYXRyaXhEYXRhJiZ0aGlzLl90aGluSW5zdGFuY2VEYXRhU3RvcmFnZS5tYXRyaXhEYXRhJiYodGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYXRyaXhCdWZmZXI/dGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UucHJldmlvdXNNYXRyaXhCdWZmZXIudXBkYXRlRGlyZWN0bHkodGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UubWF0cml4RGF0YSwwLGEpOnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzTWF0cml4QnVmZmVyPXRoaXMuX3RoaW5JbnN0YW5jZUNyZWF0ZU1hdHJpeEJ1ZmZlcigicHJldmlvdXNXb3JsZCIsdGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UubWF0cml4RGF0YSwhMSkpLHMudW5iaW5kSW5zdGFuY2VBdHRyaWJ1dGVzKCl9X3Byb2Nlc3NJbnN0YW5jZWRCdWZmZXJzKGUsdCl7fV9wcm9jZXNzUmVuZGVyaW5nKGUsdCxpLHMscixuLGEsbyl7Y29uc3QgaD10aGlzLmdldFNjZW5lKCksbD1oLmdldEVuZ2luZSgpO2lmKG4mJnQuZ2V0UmVuZGVyaW5nTWVzaCgpLmhhc1RoaW5JbnN0YW5jZXMpcmV0dXJuIHRoaXMuX3JlbmRlcldpdGhUaGluSW5zdGFuY2VzKHQscyxpLGwpLHRoaXM7aWYobil0aGlzLl9yZW5kZXJXaXRoSW5zdGFuY2VzKHQscyxyLGksbCk7ZWxzZXtsLl9jdXJyZW50RHJhd0NvbnRleHQmJihsLl9jdXJyZW50RHJhd0NvbnRleHQudXNlSW5zdGFuY2luZz0hMSk7bGV0IHU9MDtyLnJlbmRlclNlbGZbdC5faWRdJiYoYSYmYSghMSxlLmdldFdvcmxkTWF0cml4KCksbyksdSsrLHRoaXMuX2RyYXcodCxzLHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2Uub3ZlcnJpZGVuSW5zdGFuY2VDb3VudCkpO2NvbnN0IGQ9ci52aXNpYmxlSW5zdGFuY2VzW3QuX2lkXTtpZihkKXtjb25zdCBmPWQubGVuZ3RoO3UrPWY7Zm9yKGxldCBfPTA7XzxmO18rKyl7Y29uc3QgbT1kW19dLmdldFdvcmxkTWF0cml4KCk7YSYmYSghMCxtLG8pLHRoaXMuX2RyYXcodCxzKX19aC5fYWN0aXZlSW5kaWNlcy5hZGRDb3VudCh0LmluZGV4Q291bnQqdSwhMSl9cmV0dXJuIHRoaXN9X3JlYnVpbGQoZT0hMSl7aWYodGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pbnN0YW5jZXNCdWZmZXImJihlJiZ0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0J1ZmZlci5kaXNwb3NlKCksdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pbnN0YW5jZXNCdWZmZXI9bnVsbCksdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlKXtmb3IoY29uc3QgdCBpbiB0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVycyl7Y29uc3QgaT10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1t0XTtpJiYoZSYmaS5kaXNwb3NlKCksdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbdF09bnVsbCl9dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEFycmF5T2JqZWN0cyYmKHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhBcnJheU9iamVjdHM9e30pfXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbD1udWxsLHN1cGVyLl9yZWJ1aWxkKGUpfV9mcmVlemUoKXtpZih0aGlzLnN1Yk1lc2hlcyl7Zm9yKGxldCBlPTA7ZTx0aGlzLnN1Yk1lc2hlcy5sZW5ndGg7ZSsrKXRoaXMuX2dldEluc3RhbmNlc1JlbmRlckxpc3QoZSk7dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsPW51bGwsdGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbj0hMH19X3VuRnJlZXplKCl7dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZS5pc0Zyb3plbj0hMSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLnByZXZpb3VzQmF0Y2g9bnVsbH1yZW5kZXIoZSx0LGkpe3ZhciBzLHIsbjtjb25zdCBhPXRoaXMuZ2V0U2NlbmUoKTtpZih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZUludGVybWVkaWF0ZT90aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZUludGVybWVkaWF0ZT0hMTp0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZT0hMSx0aGlzLl9jaGVja09jY2x1c2lvblF1ZXJ5KCkmJiF0aGlzLl9vY2NsdXNpb25EYXRhU3RvcmFnZS5mb3JjZVJlbmRlcmluZ1doZW5PY2NsdWRlZClyZXR1cm4gdGhpcztjb25zdCBvPXRoaXMuX2dldEluc3RhbmNlc1JlbmRlckxpc3QoZS5faWQsISFpKTtpZihvLm11c3RSZXR1cm4pcmV0dXJuIHRoaXM7aWYoIXRoaXMuX2dlb21ldHJ5fHwhdGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGV4QnVmZmVycygpfHwhdGhpcy5fdW5JbmRleGVkJiYhdGhpcy5fZ2VvbWV0cnkuZ2V0SW5kZXhCdWZmZXIoKSlyZXR1cm4gdGhpcztjb25zdCBoPWEuZ2V0RW5naW5lKCk7bGV0IGw9MCx1PW51bGw7dGhpcy5pZ25vcmVDYW1lcmFNYXhaJiZhLmFjdGl2ZUNhbWVyYSYmIWEuX2lzSW5JbnRlcm1lZGlhdGVSZW5kZXJpbmcoKSYmKGw9YS5hY3RpdmVDYW1lcmEubWF4Wix1PWEuYWN0aXZlQ2FtZXJhLGEuYWN0aXZlQ2FtZXJhLm1heFo9MCxhLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCkpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZVJlbmRlck9ic2VydmFibGUmJnRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9vbkJlZm9yZVJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO2NvbnN0IGQ9ZS5nZXRSZW5kZXJpbmdNZXNoKCksZj1vLmhhcmR3YXJlSW5zdGFuY2VkUmVuZGVyaW5nW2UuX2lkXXx8ZC5oYXNUaGluSW5zdGFuY2VzfHwhIXRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZSYmIWUuZ2V0TWVzaCgpLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoLF89dGhpcy5faW5zdGFuY2VEYXRhU3RvcmFnZSxFPWUuZ2V0TWF0ZXJpYWwoKTtpZighRSlyZXR1cm4gdSYmKHUubWF4Wj1sLGEudXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKSksdGhpcztpZighXy5pc0Zyb3plbnx8IXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbHx8dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsIT09RSl7aWYoRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyl7aWYoIUUuaXNSZWFkeUZvclN1Yk1lc2godGhpcyxlLGYpKXJldHVybiB1JiYodS5tYXhaPWwsYS51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoITApKSx0aGlzfWVsc2UgaWYoIUUuaXNSZWFkeSh0aGlzLGYpKXJldHVybiB1JiYodS5tYXhaPWwsYS51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoITApKSx0aGlzO3RoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbD1FfWVsc2UgaWYoRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyYmISghKChzPWUuZWZmZWN0KT09PW51bGx8fHM9PT12b2lkIDApJiZzLl93YXNQcmV2aW91c2x5UmVhZHkpfHwhRS5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcyYmISghKChyPUUuZ2V0RWZmZWN0KCkpPT09bnVsbHx8cj09PXZvaWQgMCkmJnIuX3dhc1ByZXZpb3VzbHlSZWFkeSkpcmV0dXJuIHUmJih1Lm1heFo9bCxhLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCkpLHRoaXM7dCYmaC5zZXRBbHBoYU1vZGUodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLmFscGhhTW9kZSk7bGV0IG07dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzP209ZS5fZHJhd1dyYXBwZXI6bT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwuX2dldERyYXdXcmFwcGVyKCk7Y29uc3Qgdj0obj1tPT1udWxsP3ZvaWQgMDptLmVmZmVjdCkhPT1udWxsJiZuIT09dm9pZCAwP246bnVsbDtmb3IoY29uc3QgTCBvZiBhLl9iZWZvcmVSZW5kZXJpbmdNZXNoU3RhZ2UpTC5hY3Rpb24odGhpcyxlLG8sdik7aWYoIW18fCF2KXJldHVybiB1JiYodS5tYXhaPWwsYS51cGRhdGVUcmFuc2Zvcm1NYXRyaXgoITApKSx0aGlzO2NvbnN0IFM9aXx8dGhpcztsZXQgeTtpZighXy5pc0Zyb3plbiYmKHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbC5iYWNrRmFjZUN1bGxpbmd8fHRoaXMub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbiE9PW51bGwpKXtjb25zdCBMPVMuX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKTt5PXRoaXMub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbix5PT1udWxsJiYoeT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwuc2lkZU9yaWVudGF0aW9uKSxMPDAmJih5PXk9PT1QLkNsb2NrV2lzZVNpZGVPcmllbnRhdGlvbj9QLkNvdW50ZXJDbG9ja1dpc2VTaWRlT3JpZW50YXRpb246UC5DbG9ja1dpc2VTaWRlT3JpZW50YXRpb24pLF8uc2lkZU9yaWVudGF0aW9uPXl9ZWxzZSB5PV8uc2lkZU9yaWVudGF0aW9uO2NvbnN0IEE9dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLl9wcmVCaW5kKG0seSk7dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLmZvcmNlRGVwdGhXcml0ZSYmaC5zZXREZXB0aFdyaXRlKCEwKTtjb25zdCBDPWEuZm9yY2VQb2ludHNDbG91ZD9QLlBvaW50RmlsbE1vZGU6YS5mb3JjZVdpcmVmcmFtZT9QLldpcmVGcmFtZUZpbGxNb2RlOnRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbC5maWxsTW9kZTt0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZWZvcmVCaW5kT2JzZXJ2YWJsZSYmdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmVmb3JlQmluZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLGZ8fHRoaXMuX2JpbmQoZSx2LEMpO2NvbnN0IGI9dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2VmZmVjdGl2ZU1hdGVyaWFsLE09Uy5nZXRXb3JsZE1hdHJpeCgpO2IuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXM/Yi5iaW5kRm9yU3ViTWVzaChNLHRoaXMsZSk6Yi5iaW5kKE0sdGhpcyksIWIuYmFja0ZhY2VDdWxsaW5nJiZiLnNlcGFyYXRlQ3VsbGluZ1Bhc3MmJihoLnNldFN0YXRlKCEwLGIuek9mZnNldCwhMSwhQSxiLmN1bGxCYWNrRmFjZXMsYi5zdGVuY2lsLGIuek9mZnNldFVuaXRzKSx0aGlzLl9wcm9jZXNzUmVuZGVyaW5nKHRoaXMsZSx2LEMsbyxmLHRoaXMuX29uQmVmb3JlRHJhdyx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwpLGguc2V0U3RhdGUoITAsYi56T2Zmc2V0LCExLEEsYi5jdWxsQmFja0ZhY2VzLGIuc3RlbmNpbCxiLnpPZmZzZXRVbml0cyksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlJiZ0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25CZXR3ZWVuUGFzc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGUpKSx0aGlzLl9wcm9jZXNzUmVuZGVyaW5nKHRoaXMsZSx2LEMsbyxmLHRoaXMuX29uQmVmb3JlRHJhdyx0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fZWZmZWN0aXZlTWF0ZXJpYWwpLHRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvLl9lZmZlY3RpdmVNYXRlcmlhbC51bmJpbmQoKTtmb3IoY29uc3QgTCBvZiBhLl9hZnRlclJlbmRlcmluZ01lc2hTdGFnZSlMLmFjdGlvbih0aGlzLGUsbyx2KTtyZXR1cm4gdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX29uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlJiZ0aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fb25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHUmJih1Lm1heFo9bCxhLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCkpLGEucGVyZm9ybWFuY2VQcmlvcml0eT09PUN0LkFnZ3Jlc3NpdmUmJiFfLmlzRnJvemVuJiZ0aGlzLl9mcmVlemUoKSx0aGlzfWNsZWFuTWF0cml4V2VpZ2h0cygpe3RoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTWF0cmljZXNXZWlnaHRzS2luZCkmJih0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCk/dGhpcy5fbm9ybWFsaXplU2tpbldlaWdodHNBbmRFeHRyYSgpOnRoaXMuX25vcm1hbGl6ZVNraW5Gb3VyV2VpZ2h0cygpKX1fbm9ybWFsaXplU2tpbkZvdXJXZWlnaHRzKCl7Y29uc3QgZT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpLHQ9ZS5sZW5ndGg7Zm9yKGxldCBpPTA7aTx0O2krPTQpe2NvbnN0IHM9ZVtpXStlW2krMV0rZVtpKzJdK2VbaSszXTtpZihzPT09MCllW2ldPTE7ZWxzZXtjb25zdCByPTEvcztlW2ldKj1yLGVbaSsxXSo9cixlW2krMl0qPXIsZVtpKzNdKj1yfX10aGlzLnNldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQsZSl9X25vcm1hbGl6ZVNraW5XZWlnaHRzQW5kRXh0cmEoKXtjb25zdCBlPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSx0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCksaT10Lmxlbmd0aDtmb3IobGV0IHM9MDtzPGk7cys9NCl7bGV0IHI9dFtzXSt0W3MrMV0rdFtzKzJdK3RbcyszXTtpZihyKz1lW3NdK2VbcysxXStlW3MrMl0rZVtzKzNdLHI9PT0wKXRbc109MTtlbHNle2NvbnN0IG49MS9yO3Rbc10qPW4sdFtzKzFdKj1uLHRbcysyXSo9bix0W3MrM10qPW4sZVtzXSo9bixlW3MrMV0qPW4sZVtzKzJdKj1uLGVbcyszXSo9bn19dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc1dlaWdodHNLaW5kLHQpLHRoaXMuc2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNXZWlnaHRzS2luZCxlKX12YWxpZGF0ZVNraW5uaW5nKCl7Y29uc3QgZT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCksdD10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpO2lmKHQ9PT1udWxsfHx0aGlzLnNrZWxldG9uPT1udWxsKXJldHVybntza2lubmVkOiExLHZhbGlkOiEwLHJlcG9ydDoibm90IHNraW5uZWQifTtjb25zdCBpPXQubGVuZ3RoO2xldCBzPTAscj0wLG49MCxhPTA7Y29uc3Qgbz1lPT09bnVsbD80OjgsaD1uZXcgQXJyYXk7Zm9yKGxldCBtPTA7bTw9bzttKyspaFttXT0wO2NvbnN0IGw9LjAwMTtmb3IobGV0IG09MDttPGk7bSs9NCl7bGV0IHY9dFttXSxTPXYseT1TPT09MD8wOjE7Zm9yKGxldCBBPTE7QTxvO0ErKyl7Y29uc3QgQz1BPDQ/dFttK0FdOmVbbStBLTRdO0M+diYmcysrLEMhPT0wJiZ5KyssUys9Qyx2PUN9aWYoaFt5XSsrLHk+biYmKG49eSksUz09PTApcisrO2Vsc2V7Y29uc3QgQT0xL1M7bGV0IEM9MDtmb3IobGV0IGI9MDtiPG87YisrKWI8ND9DKz1NYXRoLmFicyh0W20rYl0tdFttK2JdKkEpOkMrPU1hdGguYWJzKGVbbStiLTRdLWVbbStiLTRdKkEpO0M+bCYmYSsrfX1jb25zdCB1PXRoaXMuc2tlbGV0b24uYm9uZXMubGVuZ3RoLGQ9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5NYXRyaWNlc0luZGljZXNLaW5kKSxmPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKTtsZXQgXz0wO2ZvcihsZXQgbT0wO208aTttKz00KWZvcihsZXQgdj0wO3Y8bzt2Kyspe2NvbnN0IFM9djw0P2RbbSt2XTpmW20rdi00XTsoUz49dXx8UzwwKSYmXysrfWNvbnN0IEU9Ik51bWJlciBvZiBXZWlnaHRzID0gIitpLzQrYApNYXhpbXVtIGluZmx1ZW5jZXMgPSBgK24rYApNaXNzaW5nIFdlaWdodHMgPSBgK3IrYApOb3QgU29ydGVkID0gYCtzK2AKTm90IE5vcm1hbGl6ZWQgPSBgK2ErYApXZWlnaHRDb3VudHMgPSBbYCtoK2BdCk51bWJlciBvZiBib25lcyA9IGArdStgCkJhZCBCb25lIEluZGljZXMgPSBgK187cmV0dXJue3NraW5uZWQ6ITAsdmFsaWQ6cj09PTAmJmE9PT0wJiZfPT09MCxyZXBvcnQ6RX19X2NoZWNrRGVsYXlTdGF0ZSgpe2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpO3JldHVybiB0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5sb2FkKGUpOnRoaXMuZGVsYXlMb2FkU3RhdGU9PT00JiYodGhpcy5kZWxheUxvYWRTdGF0ZT0yLHRoaXMuX3F1ZXVlTG9hZChlKSksdGhpc31fcXVldWVMb2FkKGUpe2UuYWRkUGVuZGluZ0RhdGEodGhpcyk7Y29uc3QgdD10aGlzLmRlbGF5TG9hZGluZ0ZpbGUuaW5kZXhPZigiLmJhYnlsb25iaW5hcnltZXNoZGF0YSIpIT09LTE7cmV0dXJuIEguTG9hZEZpbGUodGhpcy5kZWxheUxvYWRpbmdGaWxlLGk9PntpIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/dGhpcy5fZGVsYXlMb2FkaW5nRnVuY3Rpb24oaSx0aGlzKTp0aGlzLl9kZWxheUxvYWRpbmdGdW5jdGlvbihKU09OLnBhcnNlKGkpLHRoaXMpLHRoaXMuaW5zdGFuY2VzLmZvckVhY2gocz0+e3MucmVmcmVzaEJvdW5kaW5nSW5mbygpLHMuX3N5bmNTdWJNZXNoZXMoKX0pLHRoaXMuZGVsYXlMb2FkU3RhdGU9MSxlLnJlbW92ZVBlbmRpbmdEYXRhKHRoaXMpfSwoKT0+e30sZS5vZmZsaW5lUHJvdmlkZXIsdCksdGhpc31pc0luRnJ1c3R1bShlKXtyZXR1cm4gdGhpcy5kZWxheUxvYWRTdGF0ZT09PTJ8fCFzdXBlci5pc0luRnJ1c3R1bShlKT8hMToodGhpcy5fY2hlY2tEZWxheVN0YXRlKCksITApfXNldE1hdGVyaWFsQnlJZChlKXtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKS5tYXRlcmlhbHM7bGV0IGk7Zm9yKGk9dC5sZW5ndGgtMTtpPi0xO2ktLSlpZih0W2ldLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbD10W2ldLHRoaXM7Y29uc3Qgcz10aGlzLmdldFNjZW5lKCkubXVsdGlNYXRlcmlhbHM7Zm9yKGk9cy5sZW5ndGgtMTtpPi0xO2ktLSlpZihzW2ldLmlkPT09ZSlyZXR1cm4gdGhpcy5tYXRlcmlhbD1zW2ldLHRoaXM7cmV0dXJuIHRoaXN9Z2V0QW5pbWF0YWJsZXMoKXtjb25zdCBlPW5ldyBBcnJheTtyZXR1cm4gdGhpcy5tYXRlcmlhbCYmZS5wdXNoKHRoaXMubWF0ZXJpYWwpLHRoaXMuc2tlbGV0b24mJmUucHVzaCh0aGlzLnNrZWxldG9uKSxlfWJha2VUcmFuc2Zvcm1JbnRvVmVydGljZXMoZSl7aWYoIXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuUG9zaXRpb25LaW5kKSlyZXR1cm4gdGhpcztjb25zdCB0PXRoaXMuc3ViTWVzaGVzLnNwbGljZSgwKTt0aGlzLl9yZXNldFBvaW50c0FycmF5Q2FjaGUoKTtsZXQgaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7Y29uc3Qgcz1wLlplcm8oKTtsZXQgcjtmb3Iocj0wO3I8aS5sZW5ndGg7cis9MylwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGlbcl0saVtyKzFdLGlbcisyXSxlLHMpLnRvQXJyYXkoaSxyKTtpZih0aGlzLnNldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCxpLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGcuUG9zaXRpb25LaW5kKS5pc1VwZGF0YWJsZSgpKSx0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpKXtmb3IoaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk5vcm1hbEtpbmQpLHI9MDtyPGkubGVuZ3RoO3IrPTMpcC5UcmFuc2Zvcm1Ob3JtYWxGcm9tRmxvYXRzVG9SZWYoaVtyXSxpW3IrMV0saVtyKzJdLGUscykubm9ybWFsaXplKCkudG9BcnJheShpLHIpO3RoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxpLHRoaXMuZ2V0VmVydGV4QnVmZmVyKGcuTm9ybWFsS2luZCkuaXNVcGRhdGFibGUoKSl9cmV0dXJuIGUuZGV0ZXJtaW5hbnQoKTwwJiZ0aGlzLmZsaXBGYWNlcygpLHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLHRoaXMuc3ViTWVzaGVzPXQsdGhpc31iYWtlQ3VycmVudFRyYW5zZm9ybUludG9WZXJ0aWNlcyhlPSEwKXtyZXR1cm4gdGhpcy5iYWtlVHJhbnNmb3JtSW50b1ZlcnRpY2VzKHRoaXMuY29tcHV0ZVdvcmxkTWF0cml4KCEwKSksdGhpcy5yZXNldExvY2FsTWF0cml4KGUpLHRoaXN9Z2V0IF9wb3NpdGlvbnMoKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fcG9zaXRpb25zP3RoaXMuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX3Bvc2l0aW9uczp0aGlzLl9nZW9tZXRyeT90aGlzLl9nZW9tZXRyeS5fcG9zaXRpb25zOm51bGx9X3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpe3JldHVybiB0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkuX3Jlc2V0UG9pbnRzQXJyYXlDYWNoZSgpLHRoaXN9X2dlbmVyYXRlUG9pbnRzQXJyYXkoKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnk/dGhpcy5fZ2VvbWV0cnkuX2dlbmVyYXRlUG9pbnRzQXJyYXkoKTohMX1jbG9uZShlPSIiLHQ9bnVsbCxpLHM9ITApe3JldHVybiBuZXcgVyhlLHRoaXMuZ2V0U2NlbmUoKSx0LHRoaXMsaSxzKX1kaXNwb3NlKGUsdD0hMSl7dGhpcy5tb3JwaFRhcmdldE1hbmFnZXI9bnVsbCx0aGlzLl9nZW9tZXRyeSYmdGhpcy5fZ2VvbWV0cnkucmVsZWFzZUZvck1lc2godGhpcywhMCk7Y29uc3QgaT10aGlzLl9pbnRlcm5hbE1lc2hEYXRhSW5mbztpZihpLl9vbkJlZm9yZURyYXdPYnNlcnZhYmxlJiZpLl9vbkJlZm9yZURyYXdPYnNlcnZhYmxlLmNsZWFyKCksaS5fb25CZWZvcmVCaW5kT2JzZXJ2YWJsZSYmaS5fb25CZWZvcmVCaW5kT2JzZXJ2YWJsZS5jbGVhcigpLGkuX29uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZSYmaS5fb25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksaS5fb25BZnRlclJlbmRlck9ic2VydmFibGUmJmkuX29uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmNsZWFyKCksaS5fb25CZXR3ZWVuUGFzc09ic2VydmFibGUmJmkuX29uQmV0d2VlblBhc3NPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fc2NlbmUudXNlQ2xvbmVkTWVzaE1hcCl7aWYoaS5tZXNoTWFwKWZvcihjb25zdCBzIGluIGkubWVzaE1hcCl7Y29uc3Qgcj1pLm1lc2hNYXBbc107ciYmKHIuX2ludGVybmFsTWVzaERhdGFJbmZvLl9zb3VyY2U9bnVsbCxpLm1lc2hNYXBbc109dm9pZCAwKX1pLl9zb3VyY2UmJmkuX3NvdXJjZS5faW50ZXJuYWxNZXNoRGF0YUluZm8ubWVzaE1hcCYmKGkuX3NvdXJjZS5faW50ZXJuYWxNZXNoRGF0YUluZm8ubWVzaE1hcFt0aGlzLnVuaXF1ZUlkXT12b2lkIDApfWVsc2V7Y29uc3Qgcz10aGlzLmdldFNjZW5lKCkubWVzaGVzO2Zvcihjb25zdCByIG9mIHMpe2NvbnN0IG49cjtuLl9pbnRlcm5hbE1lc2hEYXRhSW5mbyYmbi5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZSYmbi5faW50ZXJuYWxNZXNoRGF0YUluZm8uX3NvdXJjZT09PXRoaXMmJihuLl9pbnRlcm5hbE1lc2hEYXRhSW5mby5fc291cmNlPW51bGwpfX1pLl9zb3VyY2U9bnVsbCx0aGlzLl9kaXNwb3NlSW5zdGFuY2VTcGVjaWZpY0RhdGEoKSx0aGlzLl9kaXNwb3NlVGhpbkluc3RhbmNlU3BlY2lmaWNEYXRhKCksdGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2NoZWNrUmVhZGluZXNzT2JzZXJ2ZXImJnRoaXMuX3NjZW5lLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm8uX2NoZWNrUmVhZGluZXNzT2JzZXJ2ZXIpLHN1cGVyLmRpc3Bvc2UoZSx0KX1fZGlzcG9zZUluc3RhbmNlU3BlY2lmaWNEYXRhKCl7fV9kaXNwb3NlVGhpbkluc3RhbmNlU3BlY2lmaWNEYXRhKCl7fV9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpe31hcHBseURpc3BsYWNlbWVudE1hcChlLHQsaSxzLHIsbixhPSExKXtjb25zdCBvPXRoaXMuZ2V0U2NlbmUoKSxoPWw9Pntjb25zdCB1PWwud2lkdGgsZD1sLmhlaWdodCxfPXRoaXMuZ2V0RW5naW5lKCkuY3JlYXRlQ2FudmFzKHUsZCkuZ2V0Q29udGV4dCgiMmQiKTtfLmRyYXdJbWFnZShsLDAsMCk7Y29uc3QgRT1fLmdldEltYWdlRGF0YSgwLDAsdSxkKS5kYXRhO3RoaXMuYXBwbHlEaXNwbGFjZW1lbnRNYXBGcm9tQnVmZmVyKEUsdSxkLHQsaSxyLG4sYSkscyYmcyh0aGlzKX07cmV0dXJuIEguTG9hZEltYWdlKGUsaCwoKT0+e30sby5vZmZsaW5lUHJvdmlkZXIpLHRoaXN9YXBwbHlEaXNwbGFjZW1lbnRNYXBGcm9tQnVmZmVyKGUsdCxpLHMscixuLGEsbz0hMSl7aWYoIXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuUG9zaXRpb25LaW5kKXx8IXRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCl8fCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWS2luZCkpcmV0dXJuIE8uV2FybigiQ2Fubm90IGNhbGwgYXBwbHlEaXNwbGFjZW1lbnRNYXA6IEdpdmVuIG1lc2ggaXMgbm90IGNvbXBsZXRlLiBQb3NpdGlvbiwgTm9ybWFsIG9yIFVWIGFyZSBtaXNzaW5nIiksdGhpcztjb25zdCBoPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLCEwLCEwKSxsPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCksdT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlVWS2luZCk7bGV0IGQ9cC5aZXJvKCk7Y29uc3QgZj1wLlplcm8oKSxfPXZlLlplcm8oKTtuPW58fHZlLlplcm8oKSxhPWF8fG5ldyB2ZSgxLDEpO2ZvcihsZXQgRT0wO0U8aC5sZW5ndGg7RSs9Myl7cC5Gcm9tQXJyYXlUb1JlZihoLEUsZCkscC5Gcm9tQXJyYXlUb1JlZihsLEUsZiksdmUuRnJvbUFycmF5VG9SZWYodSxFLzMqMixfKTtjb25zdCBtPU1hdGguYWJzKF8ueCphLngrbi54JTEpKih0LTEpJXR8MCx2PU1hdGguYWJzKF8ueSphLnkrbi55JTEpKihpLTEpJWl8MCxTPShtK3YqdCkqNCx5PWVbU10vMjU1LEE9ZVtTKzFdLzI1NSxDPWVbUysyXS8yNTUsYj15Ki4zK0EqLjU5K0MqLjExO2Yubm9ybWFsaXplKCksZi5zY2FsZUluUGxhY2Uocysoci1zKSpiKSxkPWQuYWRkKGYpLGQudG9BcnJheShoLEUpfXJldHVybiBlZS5Db21wdXRlTm9ybWFscyhoLHRoaXMuZ2V0SW5kaWNlcygpLGwpLG8/KHRoaXMuc2V0VmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLGgpLHRoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxsKSx0aGlzLnNldFZlcnRpY2VzRGF0YShnLlVWS2luZCx1KSk6KHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kLGgpLHRoaXMudXBkYXRlVmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxsKSksdGhpc31jb252ZXJ0VG9GbGF0U2hhZGVkTWVzaCgpe2NvbnN0IGU9dGhpcy5nZXRWZXJ0aWNlc0RhdGFLaW5kcygpLHQ9e30saT17fSxzPXt9O2xldCByPSExLG4sYTtmb3Iobj0wO248ZS5sZW5ndGg7bisrKXthPWVbbl07Y29uc3QgbT10aGlzLmdldFZlcnRleEJ1ZmZlcihhKSx2PW0uZ2V0RGF0YSgpO2lmKCEoKHYgaW5zdGFuY2VvZiBBcnJheXx8diBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSkmJnYubGVuZ3RoPT09MCkpe2lmKGE9PT1nLk5vcm1hbEtpbmQpe3I9bS5pc1VwZGF0YWJsZSgpLGUuc3BsaWNlKG4sMSksbi0tO2NvbnRpbnVlfXRbYV09bSxpW2FdPXRoaXMuZ2V0VmVydGljZXNEYXRhKGEpLHNbYV09W119fWNvbnN0IG89dGhpcy5zdWJNZXNoZXMuc2xpY2UoMCksaD10aGlzLmdldEluZGljZXMoKSxsPXRoaXMuZ2V0VG90YWxJbmRpY2VzKCk7bGV0IHU7Zm9yKHU9MDt1PGw7dSsrKXtjb25zdCBtPWhbdV07Zm9yKG49MDtuPGUubGVuZ3RoO24rKyl7aWYoYT1lW25dLCF0W2FdKWNvbnRpbnVlO2NvbnN0IHY9dFthXS5nZXRTdHJpZGVTaXplKCk7Zm9yKGxldCBTPTA7Uzx2O1MrKylzW2FdLnB1c2goaVthXVttKnYrU10pfX1jb25zdCBkPVtdLGY9c1tnLlBvc2l0aW9uS2luZF0sXz10aGlzLmdldFNjZW5lKCkudXNlUmlnaHRIYW5kZWRTeXN0ZW07bGV0IEU7Zm9yKF8/RT10aGlzLm92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb249PT0xOkU9dGhpcy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPT09MCx1PTA7dTxsO3UrPTMpe2hbdV09dSxoW3UrMV09dSsxLGhbdSsyXT11KzI7Y29uc3QgbT1wLkZyb21BcnJheShmLHUqMyksdj1wLkZyb21BcnJheShmLCh1KzEpKjMpLFM9cC5Gcm9tQXJyYXkoZiwodSsyKSozKSx5PW0uc3VidHJhY3QodiksQT1TLnN1YnRyYWN0KHYpLEM9cC5Ob3JtYWxpemUocC5Dcm9zcyh5LEEpKTtFJiZDLnNjYWxlSW5QbGFjZSgtMSk7Zm9yKGxldCBiPTA7YjwzO2IrKylkLnB1c2goQy54KSxkLnB1c2goQy55KSxkLnB1c2goQy56KX1mb3IodGhpcy5zZXRJbmRpY2VzKGgpLHRoaXMuc2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCxkLHIpLG49MDtuPGUubGVuZ3RoO24rKylhPWVbbl0sc1thXSYmdGhpcy5zZXRWZXJ0aWNlc0RhdGEoYSxzW2FdLHRbYV0uaXNVcGRhdGFibGUoKSk7dGhpcy5yZWxlYXNlU3ViTWVzaGVzKCk7Zm9yKGxldCBtPTA7bTxvLmxlbmd0aDttKyspe2NvbnN0IHY9b1ttXTt2dC5BZGRUb01lc2godi5tYXRlcmlhbEluZGV4LHYuaW5kZXhTdGFydCx2LmluZGV4Q291bnQsdi5pbmRleFN0YXJ0LHYuaW5kZXhDb3VudCx0aGlzKX1yZXR1cm4gdGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpLHRoaXN9Y29udmVydFRvVW5JbmRleGVkTWVzaCgpe2NvbnN0IGU9dGhpcy5nZXRWZXJ0aWNlc0RhdGFLaW5kcygpLHQ9e30saT17fSxzPXt9O2xldCByLG47Zm9yKHI9MDtyPGUubGVuZ3RoO3IrKyl7bj1lW3JdO2NvbnN0IHU9dGhpcy5nZXRWZXJ0ZXhCdWZmZXIobik7dFtuXT11LGlbbl09dFtuXS5nZXREYXRhKCksc1tuXT1bXX1jb25zdCBhPXRoaXMuc3ViTWVzaGVzLnNsaWNlKDApLG89dGhpcy5nZXRJbmRpY2VzKCksaD10aGlzLmdldFRvdGFsSW5kaWNlcygpO2xldCBsO2ZvcihsPTA7bDxoO2wrKyl7Y29uc3QgdT1vW2xdO2ZvcihyPTA7cjxlLmxlbmd0aDtyKyspe249ZVtyXTtjb25zdCBkPXRbbl0uZ2V0U3RyaWRlU2l6ZSgpO2ZvcihsZXQgZj0wO2Y8ZDtmKyspc1tuXS5wdXNoKGlbbl1bdSpkK2ZdKX19Zm9yKGw9MDtsPGg7bCs9MylvW2xdPWwsb1tsKzFdPWwrMSxvW2wrMl09bCsyO2Zvcih0aGlzLnNldEluZGljZXMobykscj0wO3I8ZS5sZW5ndGg7cisrKW49ZVtyXSx0aGlzLnNldFZlcnRpY2VzRGF0YShuLHNbbl0sdFtuXS5pc1VwZGF0YWJsZSgpLHRbbl0uZ2V0U3RyaWRlU2l6ZSgpKTt0aGlzLnJlbGVhc2VTdWJNZXNoZXMoKTtmb3IobGV0IHU9MDt1PGEubGVuZ3RoO3UrKyl7Y29uc3QgZD1hW3VdO3Z0LkFkZFRvTWVzaChkLm1hdGVyaWFsSW5kZXgsZC5pbmRleFN0YXJ0LGQuaW5kZXhDb3VudCxkLmluZGV4U3RhcnQsZC5pbmRleENvdW50LHRoaXMpfXJldHVybiB0aGlzLl91bkluZGV4ZWQ9ITAsdGhpcy5zeW5jaHJvbml6ZUluc3RhbmNlcygpLHRoaXN9ZmxpcEZhY2VzKGU9ITEpe2NvbnN0IHQ9ZWUuRXh0cmFjdEZyb21NZXNoKHRoaXMpO2xldCBpO2lmKGUmJnRoaXMuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCkmJnQubm9ybWFscylmb3IoaT0wO2k8dC5ub3JtYWxzLmxlbmd0aDtpKyspdC5ub3JtYWxzW2ldKj0tMTtpZih0LmluZGljZXMpe2xldCBzO2ZvcihpPTA7aTx0LmluZGljZXMubGVuZ3RoO2krPTMpcz10LmluZGljZXNbaSsxXSx0LmluZGljZXNbaSsxXT10LmluZGljZXNbaSsyXSx0LmluZGljZXNbaSsyXT1zfXJldHVybiB0LmFwcGx5VG9NZXNoKHRoaXMsdGhpcy5pc1ZlcnRleEJ1ZmZlclVwZGF0YWJsZShnLlBvc2l0aW9uS2luZCkpLHRoaXN9aW5jcmVhc2VWZXJ0aWNlcyhlPTEpe2NvbnN0IHQ9ZWUuRXh0cmFjdEZyb21NZXNoKHRoaXMpLGk9dC5pbmRpY2VzJiYhQXJyYXkuaXNBcnJheSh0LmluZGljZXMpJiZBcnJheS5mcm9tP0FycmF5LmZyb20odC5pbmRpY2VzKTp0LmluZGljZXMscz10LnBvc2l0aW9ucyYmIUFycmF5LmlzQXJyYXkodC5wb3NpdGlvbnMpJiZBcnJheS5mcm9tP0FycmF5LmZyb20odC5wb3NpdGlvbnMpOnQucG9zaXRpb25zLHI9dC51dnMmJiFBcnJheS5pc0FycmF5KHQudXZzKSYmQXJyYXkuZnJvbT9BcnJheS5mcm9tKHQudXZzKTp0LnV2cyxuPXQubm9ybWFscyYmIUFycmF5LmlzQXJyYXkodC5ub3JtYWxzKSYmQXJyYXkuZnJvbT9BcnJheS5mcm9tKHQubm9ybWFscyk6dC5ub3JtYWxzO2lmKCFpfHwhcylPLldhcm4oIkNvdWxkbid0IGluY3JlYXNlIG51bWJlciBvZiB2ZXJ0aWNlcyA6IFZlcnRleERhdGEgbXVzdCBjb250YWluIGF0IGxlYXN0IGluZGljZXMgYW5kIHBvc2l0aW9ucyIpO2Vsc2V7dC5pbmRpY2VzPWksdC5wb3NpdGlvbnM9cyxyJiYodC51dnM9ciksbiYmKHQubm9ybWFscz1uKTtjb25zdCBhPWUrMSxvPW5ldyBBcnJheTtmb3IobGV0IEM9MDtDPGErMTtDKyspb1tDXT1uZXcgQXJyYXk7bGV0IGgsbDtjb25zdCB1PW5ldyBwKDAsMCwwKSxkPW5ldyBwKDAsMCwwKSxmPW5ldyB2ZSgwLDApLF89bmV3IEFycmF5LEU9bmV3IEFycmF5LG09bmV3IEFycmF5O2xldCB2LFM9cy5sZW5ndGgseTtyJiYoeT1yLmxlbmd0aCk7bGV0IEE7biYmKEE9bi5sZW5ndGgpO2ZvcihsZXQgQz0wO0M8aS5sZW5ndGg7Qys9Myl7RVswXT1pW0NdLEVbMV09aVtDKzFdLEVbMl09aVtDKzJdO2ZvcihsZXQgYj0wO2I8MztiKyspaWYoaD1FW2JdLGw9RVsoYisxKSUzXSxtW2hdPT09dm9pZCAwJiZtW2xdPT09dm9pZCAwPyhtW2hdPW5ldyBBcnJheSxtW2xdPW5ldyBBcnJheSk6KG1baF09PT12b2lkIDAmJihtW2hdPW5ldyBBcnJheSksbVtsXT09PXZvaWQgMCYmKG1bbF09bmV3IEFycmF5KSksbVtoXVtsXT09PXZvaWQgMCYmbVtsXVtoXT09PXZvaWQgMCl7bVtoXVtsXT1bXSx1Lng9KHNbMypsXS1zWzMqaF0pL2EsdS55PShzWzMqbCsxXS1zWzMqaCsxXSkvYSx1Lno9KHNbMypsKzJdLXNbMypoKzJdKS9hLG4mJihkLng9KG5bMypsXS1uWzMqaF0pL2EsZC55PShuWzMqbCsxXS1uWzMqaCsxXSkvYSxkLno9KG5bMypsKzJdLW5bMypoKzJdKS9hKSxyJiYoZi54PShyWzIqbF0tclsyKmhdKS9hLGYueT0oclsyKmwrMV0tclsyKmgrMV0pL2EpLG1baF1bbF0ucHVzaChoKTtmb3IobGV0IE09MTtNPGE7TSsrKW1baF1bbF0ucHVzaChzLmxlbmd0aC8zKSxzW1MrK109c1szKmhdK00qdS54LHNbUysrXT1zWzMqaCsxXStNKnUueSxzW1MrK109c1szKmgrMl0rTSp1LnosbiYmKG5bQSsrXT1uWzMqaF0rTSpkLngsbltBKytdPW5bMypoKzFdK00qZC55LG5bQSsrXT1uWzMqaCsyXStNKmQueiksciYmKHJbeSsrXT1yWzIqaF0rTSpmLngsclt5KytdPXJbMipoKzFdK00qZi55KTttW2hdW2xdLnB1c2gobCksbVtsXVtoXT1uZXcgQXJyYXksdj1tW2hdW2xdLmxlbmd0aDtmb3IobGV0IE09MDtNPHY7TSsrKW1bbF1baF1bTV09bVtoXVtsXVt2LTEtTV19b1swXVswXT1pW0NdLG9bMV1bMF09bVtpW0NdXVtpW0MrMV1dWzFdLG9bMV1bMV09bVtpW0NdXVtpW0MrMl1dWzFdO2ZvcihsZXQgYj0yO2I8YTtiKyspe29bYl1bMF09bVtpW0NdXVtpW0MrMV1dW2JdLG9bYl1bYl09bVtpW0NdXVtpW0MrMl1dW2JdLHUueD0oc1szKm9bYl1bYl1dLXNbMypvW2JdWzBdXSkvYix1Lnk9KHNbMypvW2JdW2JdKzFdLXNbMypvW2JdWzBdKzFdKS9iLHUuej0oc1szKm9bYl1bYl0rMl0tc1szKm9bYl1bMF0rMl0pL2IsbiYmKGQueD0oblszKm9bYl1bYl1dLW5bMypvW2JdWzBdXSkvYixkLnk9KG5bMypvW2JdW2JdKzFdLW5bMypvW2JdWzBdKzFdKS9iLGQuej0oblszKm9bYl1bYl0rMl0tblszKm9bYl1bMF0rMl0pL2IpLHImJihmLng9KHJbMipvW2JdW2JdXS1yWzIqb1tiXVswXV0pL2IsZi55PShyWzIqb1tiXVtiXSsxXS1yWzIqb1tiXVswXSsxXSkvYik7Zm9yKGxldCBNPTE7TTxiO00rKylvW2JdW01dPXMubGVuZ3RoLzMsc1tTKytdPXNbMypvW2JdWzBdXStNKnUueCxzW1MrK109c1szKm9bYl1bMF0rMV0rTSp1Lnksc1tTKytdPXNbMypvW2JdWzBdKzJdK00qdS56LG4mJihuW0ErK109blszKm9bYl1bMF1dK00qZC54LG5bQSsrXT1uWzMqb1tiXVswXSsxXStNKmQueSxuW0ErK109blszKm9bYl1bMF0rMl0rTSpkLnopLHImJihyW3krK109clsyKm9bYl1bMF1dK00qZi54LHJbeSsrXT1yWzIqb1tiXVswXSsxXStNKmYueSl9b1thXT1tW2lbQysxXV1baVtDKzJdXSxfLnB1c2gob1swXVswXSxvWzFdWzBdLG9bMV1bMV0pO2ZvcihsZXQgYj0xO2I8YTtiKyspe2xldCBNO2ZvcihNPTA7TTxiO00rKylfLnB1c2gob1tiXVtNXSxvW2IrMV1bTV0sb1tiKzFdW00rMV0pLF8ucHVzaChvW2JdW01dLG9bYisxXVtNKzFdLG9bYl1bTSsxXSk7Xy5wdXNoKG9bYl1bTV0sb1tiKzFdW01dLG9bYisxXVtNKzFdKX19dC5pbmRpY2VzPV8sdC5hcHBseVRvTWVzaCh0aGlzLHRoaXMuaXNWZXJ0ZXhCdWZmZXJVcGRhdGFibGUoZy5Qb3NpdGlvbktpbmQpKX19Zm9yY2VTaGFyZWRWZXJ0aWNlcygpe2NvbnN0IGU9ZWUuRXh0cmFjdEZyb21NZXNoKHRoaXMpLHQ9ZS51dnMsaT1lLmluZGljZXMscz1lLnBvc2l0aW9ucyxyPWUuY29sb3JzLG49ZS5tYXRyaWNlc0luZGljZXMsYT1lLm1hdHJpY2VzV2VpZ2h0cyxvPWUubWF0cmljZXNJbmRpY2VzRXh0cmEsaD1lLm1hdHJpY2VzV2VpZ2h0c0V4dHJhO2lmKGk9PT12b2lkIDB8fHM9PT12b2lkIDB8fGk9PT1udWxsfHxzPT09bnVsbClPLldhcm4oIlZlcnRleERhdGEgY29udGFpbnMgZW1wdHkgZW50cmllcyIpO2Vsc2V7Y29uc3QgbD1uZXcgQXJyYXksdT1uZXcgQXJyYXksZD1uZXcgQXJyYXksZj1uZXcgQXJyYXksXz1uZXcgQXJyYXksRT1uZXcgQXJyYXksbT1uZXcgQXJyYXksdj1uZXcgQXJyYXk7bGV0IFM9bmV3IEFycmF5LHk9MDtjb25zdCBBPXt9O2xldCBDLGI7Zm9yKGxldCBMPTA7TDxpLmxlbmd0aDtMKz0zKXtiPVtpW0xdLGlbTCsxXSxpW0wrMl1dLFM9bmV3IEFycmF5O2ZvcihsZXQgaz0wO2s8MztrKyspe1Nba109IiI7Zm9yKGxldCB3PTA7dzwzO3crKylNYXRoLmFicyhzWzMqYltrXSt3XSk8MWUtOCYmKHNbMypiW2tdK3ddPTApLFNba10rPXNbMypiW2tdK3ddKyJ8In1pZighKFNbMF09PVNbMV18fFNbMF09PVNbMl18fFNbMV09PVNbMl0pKWZvcihsZXQgaz0wO2s8MztrKyspe2lmKEM9QVtTW2tdXSxDPT09dm9pZCAwKXtBW1Nba11dPXksQz15Kys7Zm9yKGxldCB3PTA7dzwzO3crKylsLnB1c2goc1szKmJba10rd10pO2lmKHIhPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKylmLnB1c2gocls0KmJba10rd10pO2lmKHQhPW51bGwpZm9yKGxldCB3PTA7dzwyO3crKylkLnB1c2godFsyKmJba10rd10pO2lmKG4hPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKylfLnB1c2gobls0KmJba10rd10pO2lmKGEhPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKylFLnB1c2goYVs0KmJba10rd10pO2lmKG8hPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKyltLnB1c2gob1s0KmJba10rd10pO2lmKGghPW51bGwpZm9yKGxldCB3PTA7dzw0O3crKyl2LnB1c2goaFs0KmJba10rd10pfXUucHVzaChDKX19Y29uc3QgTT1uZXcgQXJyYXk7ZWUuQ29tcHV0ZU5vcm1hbHMobCx1LE0pLGUucG9zaXRpb25zPWwsZS5pbmRpY2VzPXUsZS5ub3JtYWxzPU0sdCE9bnVsbCYmKGUudXZzPWQpLHIhPW51bGwmJihlLmNvbG9ycz1mKSxuIT1udWxsJiYoZS5tYXRyaWNlc0luZGljZXM9XyksYSE9bnVsbCYmKGUubWF0cmljZXNXZWlnaHRzPUUpLG8hPW51bGwmJihlLm1hdHJpY2VzSW5kaWNlc0V4dHJhPW0pLGEhPW51bGwmJihlLm1hdHJpY2VzV2VpZ2h0c0V4dHJhPXYpLGUuYXBwbHlUb01lc2godGhpcyx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuUG9zaXRpb25LaW5kKSl9fXN0YXRpYyBfaW5zdGFuY2VkTWVzaEZhY3RvcnkoZSx0KXt0aHJvdyAkKCJJbnN0YW5jZWRNZXNoIil9c3RhdGljIF9QaHlzaWNzSW1wb3N0b3JQYXJzZXIoZSx0LGkpe3Rocm93ICQoIlBoeXNpY3NJbXBvc3RvciIpfWNyZWF0ZUluc3RhbmNlKGUpe3JldHVybiBXLl9pbnN0YW5jZWRNZXNoRmFjdG9yeShlLHRoaXMpfXN5bmNocm9uaXplSW5zdGFuY2VzKCl7Zm9yKGxldCBlPTA7ZTx0aGlzLmluc3RhbmNlcy5sZW5ndGg7ZSsrKXRoaXMuaW5zdGFuY2VzW2VdLl9zeW5jU3ViTWVzaGVzKCk7cmV0dXJuIHRoaXN9b3B0aW1pemVJbmRpY2VzKGUpe2NvbnN0IHQ9dGhpcy5nZXRJbmRpY2VzKCksaT10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7aWYoIWl8fCF0KXJldHVybiB0aGlzO2NvbnN0IHM9bmV3IEFycmF5O2ZvcihsZXQgbj0wO248aS5sZW5ndGg7bj1uKzMpcy5wdXNoKHAuRnJvbUFycmF5KGksbikpO2NvbnN0IHI9bmV3IEFycmF5O3JldHVybiBZaS5TeW5jQXN5bmNGb3JMb29wKHMubGVuZ3RoLDQwLG49Pntjb25zdCBhPXMubGVuZ3RoLTEtbixvPXNbYV07Zm9yKGxldCBoPTA7aDxhOysraCl7Y29uc3QgbD1zW2hdO2lmKG8uZXF1YWxzKGwpKXtyW2FdPWg7YnJlYWt9fX0sKCk9Pntmb3IobGV0IGE9MDthPHQubGVuZ3RoOysrYSl0W2FdPXJbdFthXV18fHRbYV07Y29uc3Qgbj10aGlzLnN1Yk1lc2hlcy5zbGljZSgwKTt0aGlzLnNldEluZGljZXModCksdGhpcy5zdWJNZXNoZXM9bixlJiZlKHRoaXMpfSksdGhpc31zZXJpYWxpemUoZT17fSl7ZS5uYW1lPXRoaXMubmFtZSxlLmlkPXRoaXMuaWQsZS51bmlxdWVJZD10aGlzLnVuaXF1ZUlkLGUudHlwZT10aGlzLmdldENsYXNzTmFtZSgpLGdlJiZnZS5IYXNUYWdzKHRoaXMpJiYoZS50YWdzPWdlLkdldFRhZ3ModGhpcykpLGUucG9zaXRpb249dGhpcy5wb3NpdGlvbi5hc0FycmF5KCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24/ZS5yb3RhdGlvblF1YXRlcm5pb249dGhpcy5yb3RhdGlvblF1YXRlcm5pb24uYXNBcnJheSgpOnRoaXMucm90YXRpb24mJihlLnJvdGF0aW9uPXRoaXMucm90YXRpb24uYXNBcnJheSgpKSxlLnNjYWxpbmc9dGhpcy5zY2FsaW5nLmFzQXJyYXkoKSx0aGlzLl9wb3N0TXVsdGlwbHlQaXZvdE1hdHJpeD9lLnBpdm90TWF0cml4PXRoaXMuZ2V0UGl2b3RNYXRyaXgoKS5hc0FycmF5KCk6ZS5sb2NhbE1hdHJpeD10aGlzLmdldFBpdm90TWF0cml4KCkuYXNBcnJheSgpLGUuaXNFbmFibGVkPXRoaXMuaXNFbmFibGVkKCExKSxlLmlzVmlzaWJsZT10aGlzLmlzVmlzaWJsZSxlLmluZmluaXRlRGlzdGFuY2U9dGhpcy5pbmZpbml0ZURpc3RhbmNlLGUucGlja2FibGU9dGhpcy5pc1BpY2thYmxlLGUucmVjZWl2ZVNoYWRvd3M9dGhpcy5yZWNlaXZlU2hhZG93cyxlLmJpbGxib2FyZE1vZGU9dGhpcy5iaWxsYm9hcmRNb2RlLGUudmlzaWJpbGl0eT10aGlzLnZpc2liaWxpdHksZS5jaGVja0NvbGxpc2lvbnM9dGhpcy5jaGVja0NvbGxpc2lvbnMsZS5pc0Jsb2NrZXI9dGhpcy5pc0Jsb2NrZXIsZS5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPXRoaXMub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbix0aGlzLnBhcmVudCYmdGhpcy5wYXJlbnQuX3NlcmlhbGl6ZUFzUGFyZW50KGUpLGUuaXNVbkluZGV4ZWQ9dGhpcy5pc1VuSW5kZXhlZDtjb25zdCB0PXRoaXMuX2dlb21ldHJ5O2lmKHQmJnRoaXMuc3ViTWVzaGVzKXtlLmdlb21ldHJ5VW5pcXVlSWQ9dC51bmlxdWVJZCxlLmdlb21ldHJ5SWQ9dC5pZCxlLnN1Yk1lc2hlcz1bXTtmb3IobGV0IGk9MDtpPHRoaXMuc3ViTWVzaGVzLmxlbmd0aDtpKyspe2NvbnN0IHM9dGhpcy5zdWJNZXNoZXNbaV07ZS5zdWJNZXNoZXMucHVzaCh7bWF0ZXJpYWxJbmRleDpzLm1hdGVyaWFsSW5kZXgsdmVydGljZXNTdGFydDpzLnZlcnRpY2VzU3RhcnQsdmVydGljZXNDb3VudDpzLnZlcnRpY2VzQ291bnQsaW5kZXhTdGFydDpzLmluZGV4U3RhcnQsaW5kZXhDb3VudDpzLmluZGV4Q291bnR9KX19aWYodGhpcy5tYXRlcmlhbD90aGlzLm1hdGVyaWFsLmRvTm90U2VyaWFsaXplfHwoZS5tYXRlcmlhbFVuaXF1ZUlkPXRoaXMubWF0ZXJpYWwudW5pcXVlSWQsZS5tYXRlcmlhbElkPXRoaXMubWF0ZXJpYWwuaWQpOih0aGlzLm1hdGVyaWFsPW51bGwsZS5tYXRlcmlhbFVuaXF1ZUlkPXRoaXMuX3NjZW5lLmRlZmF1bHRNYXRlcmlhbC51bmlxdWVJZCxlLm1hdGVyaWFsSWQ9dGhpcy5fc2NlbmUuZGVmYXVsdE1hdGVyaWFsLmlkKSx0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlciYmKGUubW9ycGhUYXJnZXRNYW5hZ2VySWQ9dGhpcy5tb3JwaFRhcmdldE1hbmFnZXIudW5pcXVlSWQpLHRoaXMuc2tlbGV0b24mJihlLnNrZWxldG9uSWQ9dGhpcy5za2VsZXRvbi5pZCxlLm51bUJvbmVJbmZsdWVuY2Vycz10aGlzLm51bUJvbmVJbmZsdWVuY2VycyksdGhpcy5nZXRTY2VuZSgpLl9nZXRDb21wb25lbnQocS5OQU1FX1BIWVNJQ1NFTkdJTkUpKXtjb25zdCBpPXRoaXMuZ2V0UGh5c2ljc0ltcG9zdG9yKCk7aSYmKGUucGh5c2ljc01hc3M9aS5nZXRQYXJhbSgibWFzcyIpLGUucGh5c2ljc0ZyaWN0aW9uPWkuZ2V0UGFyYW0oImZyaWN0aW9uIiksZS5waHlzaWNzUmVzdGl0dXRpb249aS5nZXRQYXJhbSgibWFzcyIpLGUucGh5c2ljc0ltcG9zdG9yPWkudHlwZSl9dGhpcy5tZXRhZGF0YSYmKGUubWV0YWRhdGE9dGhpcy5tZXRhZGF0YSksZS5pbnN0YW5jZXM9W107Zm9yKGxldCBpPTA7aTx0aGlzLmluc3RhbmNlcy5sZW5ndGg7aSsrKXtjb25zdCBzPXRoaXMuaW5zdGFuY2VzW2ldO2lmKHMuZG9Ob3RTZXJpYWxpemUpY29udGludWU7Y29uc3Qgcj17bmFtZTpzLm5hbWUsaWQ6cy5pZCxpc0VuYWJsZWQ6cy5pc0VuYWJsZWQoITEpLGlzVmlzaWJsZTpzLmlzVmlzaWJsZSxpc1BpY2thYmxlOnMuaXNQaWNrYWJsZSxjaGVja0NvbGxpc2lvbnM6cy5jaGVja0NvbGxpc2lvbnMscG9zaXRpb246cy5wb3NpdGlvbi5hc0FycmF5KCksc2NhbGluZzpzLnNjYWxpbmcuYXNBcnJheSgpfTtpZihzLnBhcmVudCYmcy5wYXJlbnQuX3NlcmlhbGl6ZUFzUGFyZW50KHIpLHMucm90YXRpb25RdWF0ZXJuaW9uP3Iucm90YXRpb25RdWF0ZXJuaW9uPXMucm90YXRpb25RdWF0ZXJuaW9uLmFzQXJyYXkoKTpzLnJvdGF0aW9uJiYoci5yb3RhdGlvbj1zLnJvdGF0aW9uLmFzQXJyYXkoKSksdGhpcy5nZXRTY2VuZSgpLl9nZXRDb21wb25lbnQocS5OQU1FX1BIWVNJQ1NFTkdJTkUpKXtjb25zdCBuPXMuZ2V0UGh5c2ljc0ltcG9zdG9yKCk7biYmKHIucGh5c2ljc01hc3M9bi5nZXRQYXJhbSgibWFzcyIpLHIucGh5c2ljc0ZyaWN0aW9uPW4uZ2V0UGFyYW0oImZyaWN0aW9uIiksci5waHlzaWNzUmVzdGl0dXRpb249bi5nZXRQYXJhbSgibWFzcyIpLHIucGh5c2ljc0ltcG9zdG9yPW4udHlwZSl9cy5tZXRhZGF0YSYmKHIubWV0YWRhdGE9cy5tZXRhZGF0YSksZS5pbnN0YW5jZXMucHVzaChyKSxhZS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyhzLHIpLHIucmFuZ2VzPXMuc2VyaWFsaXplQW5pbWF0aW9uUmFuZ2VzKCl9aWYodGhpcy5fdGhpbkluc3RhbmNlRGF0YVN0b3JhZ2UuaW5zdGFuY2VzQ291bnQmJnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeERhdGEmJihlLnRoaW5JbnN0YW5jZXM9e2luc3RhbmNlc0NvdW50OnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0NvdW50LG1hdHJpeERhdGE6QXJyYXkuZnJvbSh0aGlzLl90aGluSW5zdGFuY2VEYXRhU3RvcmFnZS5tYXRyaXhEYXRhKSxtYXRyaXhCdWZmZXJTaXplOnRoaXMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeEJ1ZmZlclNpemUsZW5hYmxlUGlja2luZzp0aGlzLnRoaW5JbnN0YW5jZUVuYWJsZVBpY2tpbmd9LHRoaXMuX3VzZXJUaGluSW5zdGFuY2VCdWZmZXJzU3RvcmFnZSkpe2NvbnN0IGk9e2RhdGE6e30sc2l6ZXM6e30sc3RyaWRlczp7fX07Zm9yKGNvbnN0IHMgaW4gdGhpcy5fdXNlclRoaW5JbnN0YW5jZUJ1ZmZlcnNTdG9yYWdlLmRhdGEpaS5kYXRhW3NdPUFycmF5LmZyb20odGhpcy5fdXNlclRoaW5JbnN0YW5jZUJ1ZmZlcnNTdG9yYWdlLmRhdGFbc10pLGkuc2l6ZXNbc109dGhpcy5fdXNlclRoaW5JbnN0YW5jZUJ1ZmZlcnNTdG9yYWdlLnNpemVzW3NdLGkuc3RyaWRlc1tzXT10aGlzLl91c2VyVGhpbkluc3RhbmNlQnVmZmVyc1N0b3JhZ2Uuc3RyaWRlc1tzXTtlLnRoaW5JbnN0YW5jZXMudXNlclRoaW5JbnN0YW5jZT1pfXJldHVybiBhZS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyh0aGlzLGUpLGUucmFuZ2VzPXRoaXMuc2VyaWFsaXplQW5pbWF0aW9uUmFuZ2VzKCksZS5sYXllck1hc2s9dGhpcy5sYXllck1hc2ssZS5hbHBoYUluZGV4PXRoaXMuYWxwaGFJbmRleCxlLmhhc1ZlcnRleEFscGhhPXRoaXMuaGFzVmVydGV4QWxwaGEsZS5vdmVybGF5QWxwaGE9dGhpcy5vdmVybGF5QWxwaGEsZS5vdmVybGF5Q29sb3I9dGhpcy5vdmVybGF5Q29sb3IuYXNBcnJheSgpLGUucmVuZGVyT3ZlcmxheT10aGlzLnJlbmRlck92ZXJsYXksZS5hcHBseUZvZz10aGlzLmFwcGx5Rm9nLHRoaXMuYWN0aW9uTWFuYWdlciYmKGUuYWN0aW9ucz10aGlzLmFjdGlvbk1hbmFnZXIuc2VyaWFsaXplKHRoaXMubmFtZSkpLGV9X3N5bmNHZW9tZXRyeVdpdGhNb3JwaFRhcmdldE1hbmFnZXIoKXtpZighdGhpcy5nZW9tZXRyeSlyZXR1cm47dGhpcy5fbWFya1N1Yk1lc2hlc0FzQXR0cmlidXRlc0RpcnR5KCk7Y29uc3QgZT10aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9tb3JwaFRhcmdldE1hbmFnZXI7aWYoZSYmZS52ZXJ0ZXhDb3VudCl7aWYoZS52ZXJ0ZXhDb3VudCE9PXRoaXMuZ2V0VG90YWxWZXJ0aWNlcygpKXtPLkVycm9yKCJNZXNoIGlzIGluY29tcGF0aWJsZSB3aXRoIG1vcnBoIHRhcmdldHMuIFRhcmdldHMgYW5kIG1lc2ggbXVzdCBhbGwgaGF2ZSB0aGUgc2FtZSB2ZXJ0aWNlcyBjb3VudC4iKSx0aGlzLm1vcnBoVGFyZ2V0TWFuYWdlcj1udWxsO3JldHVybn1pZihlLmlzVXNpbmdUZXh0dXJlRm9yVGFyZ2V0cylyZXR1cm47Zm9yKGxldCB0PTA7dDxlLm51bUluZmx1ZW5jZXJzO3QrKyl7Y29uc3QgaT1lLmdldEFjdGl2ZVRhcmdldCh0KSxzPWkuZ2V0UG9zaXRpb25zKCk7aWYoIXMpe08uRXJyb3IoIkludmFsaWQgbW9ycGggdGFyZ2V0LiBUYXJnZXQgbXVzdCBoYXZlIHBvc2l0aW9ucy4iKTtyZXR1cm59dGhpcy5nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQrdCxzLCExLDMpO2NvbnN0IHI9aS5nZXROb3JtYWxzKCk7ciYmdGhpcy5nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kK3QsciwhMSwzKTtjb25zdCBuPWkuZ2V0VGFuZ2VudHMoKTtuJiZ0aGlzLmdlb21ldHJ5LnNldFZlcnRpY2VzRGF0YShnLlRhbmdlbnRLaW5kK3QsbiwhMSwzKTtjb25zdCBhPWkuZ2V0VVZzKCk7YSYmdGhpcy5nZW9tZXRyeS5zZXRWZXJ0aWNlc0RhdGEoZy5VVktpbmQrIl8iK3QsYSwhMSwyKX19ZWxzZXtsZXQgdD0wO2Zvcig7dGhpcy5nZW9tZXRyeS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Qb3NpdGlvbktpbmQrdCk7KXRoaXMuZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGcuUG9zaXRpb25LaW5kK3QpLHRoaXMuZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuTm9ybWFsS2luZCt0KSYmdGhpcy5nZW9tZXRyeS5yZW1vdmVWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kK3QpLHRoaXMuZ2VvbWV0cnkuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVGFuZ2VudEtpbmQrdCkmJnRoaXMuZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGcuVGFuZ2VudEtpbmQrdCksdGhpcy5nZW9tZXRyeS5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5VVktpbmQrdCkmJnRoaXMuZ2VvbWV0cnkucmVtb3ZlVmVydGljZXNEYXRhKGcuVVZLaW5kKyJfIit0KSx0Kyt9fXN0YXRpYyBQYXJzZShlLHQsaSl7bGV0IHM7aWYoZS50eXBlJiZlLnR5cGU9PT0iTGluZXNNZXNoIj9zPVcuX0xpbmVzTWVzaFBhcnNlcihlLHQpOmUudHlwZSYmZS50eXBlPT09Ikdyb3VuZE1lc2giP3M9Vy5fR3JvdW5kTWVzaFBhcnNlcihlLHQpOmUudHlwZSYmZS50eXBlPT09IkdvbGRiZXJnTWVzaCI/cz1XLl9Hb2xkYmVyZ01lc2hQYXJzZXIoZSx0KTpzPW5ldyBXKGUubmFtZSx0KSxzLmlkPWUuaWQscy5fd2FpdGluZ1BhcnNlZFVuaXF1ZUlkPWUudW5pcXVlSWQsZ2UmJmdlLkFkZFRhZ3NUbyhzLGUudGFncykscy5wb3NpdGlvbj1wLkZyb21BcnJheShlLnBvc2l0aW9uKSxlLm1ldGFkYXRhIT09dm9pZCAwJiYocy5tZXRhZGF0YT1lLm1ldGFkYXRhKSxlLnJvdGF0aW9uUXVhdGVybmlvbj9zLnJvdGF0aW9uUXVhdGVybmlvbj1aLkZyb21BcnJheShlLnJvdGF0aW9uUXVhdGVybmlvbik6ZS5yb3RhdGlvbiYmKHMucm90YXRpb249cC5Gcm9tQXJyYXkoZS5yb3RhdGlvbikpLHMuc2NhbGluZz1wLkZyb21BcnJheShlLnNjYWxpbmcpLGUubG9jYWxNYXRyaXg/cy5zZXRQcmVUcmFuc2Zvcm1NYXRyaXgoeC5Gcm9tQXJyYXkoZS5sb2NhbE1hdHJpeCkpOmUucGl2b3RNYXRyaXgmJnMuc2V0UGl2b3RNYXRyaXgoeC5Gcm9tQXJyYXkoZS5waXZvdE1hdHJpeCkpLHMuc2V0RW5hYmxlZChlLmlzRW5hYmxlZCkscy5pc1Zpc2libGU9ZS5pc1Zpc2libGUscy5pbmZpbml0ZURpc3RhbmNlPWUuaW5maW5pdGVEaXN0YW5jZSxzLnNob3dCb3VuZGluZ0JveD1lLnNob3dCb3VuZGluZ0JveCxzLnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveD1lLnNob3dTdWJNZXNoZXNCb3VuZGluZ0JveCxlLmFwcGx5Rm9nIT09dm9pZCAwJiYocy5hcHBseUZvZz1lLmFwcGx5Rm9nKSxlLnBpY2thYmxlIT09dm9pZCAwJiYocy5pc1BpY2thYmxlPWUucGlja2FibGUpLGUuYWxwaGFJbmRleCE9PXZvaWQgMCYmKHMuYWxwaGFJbmRleD1lLmFscGhhSW5kZXgpLHMucmVjZWl2ZVNoYWRvd3M9ZS5yZWNlaXZlU2hhZG93cyxlLmJpbGxib2FyZE1vZGUhPT12b2lkIDAmJihzLmJpbGxib2FyZE1vZGU9ZS5iaWxsYm9hcmRNb2RlKSxlLnZpc2liaWxpdHkhPT12b2lkIDAmJihzLnZpc2liaWxpdHk9ZS52aXNpYmlsaXR5KSxzLmNoZWNrQ29sbGlzaW9ucz1lLmNoZWNrQ29sbGlzaW9ucyxzLm92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb249ZS5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uLGUuaXNCbG9ja2VyIT09dm9pZCAwJiYocy5pc0Jsb2NrZXI9ZS5pc0Jsb2NrZXIpLHMuX3Nob3VsZEdlbmVyYXRlRmxhdFNoYWRpbmc9ZS51c2VGbGF0U2hhZGluZyxlLmZyZWV6ZVdvcmxkTWF0cml4JiYocy5fd2FpdGluZ0RhdGEuZnJlZXplV29ybGRNYXRyaXg9ZS5mcmVlemVXb3JsZE1hdHJpeCksZS5wYXJlbnRJZCE9PXZvaWQgMCYmKHMuX3dhaXRpbmdQYXJlbnRJZD1lLnBhcmVudElkKSxlLnBhcmVudEluc3RhbmNlSW5kZXghPT12b2lkIDAmJihzLl93YWl0aW5nUGFyZW50SW5zdGFuY2VJbmRleD1lLnBhcmVudEluc3RhbmNlSW5kZXgpLGUuYWN0aW9ucyE9PXZvaWQgMCYmKHMuX3dhaXRpbmdEYXRhLmFjdGlvbnM9ZS5hY3Rpb25zKSxlLm92ZXJsYXlBbHBoYSE9PXZvaWQgMCYmKHMub3ZlcmxheUFscGhhPWUub3ZlcmxheUFscGhhKSxlLm92ZXJsYXlDb2xvciE9PXZvaWQgMCYmKHMub3ZlcmxheUNvbG9yPXJlLkZyb21BcnJheShlLm92ZXJsYXlDb2xvcikpLGUucmVuZGVyT3ZlcmxheSE9PXZvaWQgMCYmKHMucmVuZGVyT3ZlcmxheT1lLnJlbmRlck92ZXJsYXkpLHMuaXNVbkluZGV4ZWQ9ISFlLmlzVW5JbmRleGVkLHMuaGFzVmVydGV4QWxwaGE9ZS5oYXNWZXJ0ZXhBbHBoYSxlLmRlbGF5TG9hZGluZ0ZpbGU/KHMuZGVsYXlMb2FkU3RhdGU9NCxzLmRlbGF5TG9hZGluZ0ZpbGU9aStlLmRlbGF5TG9hZGluZ0ZpbGUscy5idWlsZEJvdW5kaW5nSW5mbyhwLkZyb21BcnJheShlLmJvdW5kaW5nQm94TWluaW11bSkscC5Gcm9tQXJyYXkoZS5ib3VuZGluZ0JveE1heGltdW0pKSxlLl9iaW5hcnlJbmZvJiYocy5fYmluYXJ5SW5mbz1lLl9iaW5hcnlJbmZvKSxzLl9kZWxheUluZm89W10sZS5oYXNVVnMmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVZLaW5kKSxlLmhhc1VWczImJnMuX2RlbGF5SW5mby5wdXNoKGcuVVYyS2luZCksZS5oYXNVVnMzJiZzLl9kZWxheUluZm8ucHVzaChnLlVWM0tpbmQpLGUuaGFzVVZzNCYmcy5fZGVsYXlJbmZvLnB1c2goZy5VVjRLaW5kKSxlLmhhc1VWczUmJnMuX2RlbGF5SW5mby5wdXNoKGcuVVY1S2luZCksZS5oYXNVVnM2JiZzLl9kZWxheUluZm8ucHVzaChnLlVWNktpbmQpLGUuaGFzQ29sb3JzJiZzLl9kZWxheUluZm8ucHVzaChnLkNvbG9yS2luZCksZS5oYXNNYXRyaWNlc0luZGljZXMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNJbmRpY2VzS2luZCksZS5oYXNNYXRyaWNlc1dlaWdodHMmJnMuX2RlbGF5SW5mby5wdXNoKGcuTWF0cmljZXNXZWlnaHRzS2luZCkscy5fZGVsYXlMb2FkaW5nRnVuY3Rpb249YXQuX0ltcG9ydEdlb21ldHJ5LE9lLkZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsJiZzLl9jaGVja0RlbGF5U3RhdGUoKSk6YXQuX0ltcG9ydEdlb21ldHJ5KGUscyksZS5tYXRlcmlhbFVuaXF1ZUlkP3MuX3dhaXRpbmdNYXRlcmlhbElkPWUubWF0ZXJpYWxVbmlxdWVJZDplLm1hdGVyaWFsSWQmJihzLl93YWl0aW5nTWF0ZXJpYWxJZD1lLm1hdGVyaWFsSWQpLGUubW9ycGhUYXJnZXRNYW5hZ2VySWQ+LTEmJihzLm1vcnBoVGFyZ2V0TWFuYWdlcj10LmdldE1vcnBoVGFyZ2V0TWFuYWdlckJ5SWQoZS5tb3JwaFRhcmdldE1hbmFnZXJJZCkpLGUuc2tlbGV0b25JZCE9PXZvaWQgMCYmZS5za2VsZXRvbklkIT09bnVsbCYmKHMuc2tlbGV0b249dC5nZXRMYXN0U2tlbGV0b25CeUlkKGUuc2tlbGV0b25JZCksZS5udW1Cb25lSW5mbHVlbmNlcnMmJihzLm51bUJvbmVJbmZsdWVuY2Vycz1lLm51bUJvbmVJbmZsdWVuY2VycykpLGUuYW5pbWF0aW9ucyl7Zm9yKGxldCByPTA7cjxlLmFuaW1hdGlvbnMubGVuZ3RoO3IrKyl7Y29uc3Qgbj1lLmFuaW1hdGlvbnNbcl0sYT1yaSgiQkFCWUxPTi5BbmltYXRpb24iKTthJiZzLmFuaW1hdGlvbnMucHVzaChhLlBhcnNlKG4pKX16ZS5QYXJzZUFuaW1hdGlvblJhbmdlcyhzLGUsdCl9aWYoZS5hdXRvQW5pbWF0ZSYmdC5iZWdpbkFuaW1hdGlvbihzLGUuYXV0b0FuaW1hdGVGcm9tLGUuYXV0b0FuaW1hdGVUbyxlLmF1dG9BbmltYXRlTG9vcCxlLmF1dG9BbmltYXRlU3BlZWR8fDEpLGUubGF5ZXJNYXNrJiYhaXNOYU4oZS5sYXllck1hc2spP3MubGF5ZXJNYXNrPU1hdGguYWJzKHBhcnNlSW50KGUubGF5ZXJNYXNrKSk6cy5sYXllck1hc2s9MjY4NDM1NDU1LGUucGh5c2ljc0ltcG9zdG9yJiZXLl9QaHlzaWNzSW1wb3N0b3JQYXJzZXIodCxzLGUpLGUubG9kTWVzaElkcyYmKHMuX3dhaXRpbmdEYXRhLmxvZHM9e2lkczplLmxvZE1lc2hJZHMsZGlzdGFuY2VzOmUubG9kRGlzdGFuY2VzP2UubG9kRGlzdGFuY2VzOm51bGwsY292ZXJhZ2VzOmUubG9kQ292ZXJhZ2VzP2UubG9kQ292ZXJhZ2VzOm51bGx9KSxlLmluc3RhbmNlcylmb3IobGV0IHI9MDtyPGUuaW5zdGFuY2VzLmxlbmd0aDtyKyspe2NvbnN0IG49ZS5pbnN0YW5jZXNbcl0sYT1zLmNyZWF0ZUluc3RhbmNlKG4ubmFtZSk7aWYobi5pZCYmKGEuaWQ9bi5pZCksZ2UmJihuLnRhZ3M/Z2UuQWRkVGFnc1RvKGEsbi50YWdzKTpnZS5BZGRUYWdzVG8oYSxlLnRhZ3MpKSxhLnBvc2l0aW9uPXAuRnJvbUFycmF5KG4ucG9zaXRpb24pLG4ubWV0YWRhdGEhPT12b2lkIDAmJihhLm1ldGFkYXRhPW4ubWV0YWRhdGEpLG4ucGFyZW50SWQhPT12b2lkIDAmJihhLl93YWl0aW5nUGFyZW50SWQ9bi5wYXJlbnRJZCksbi5wYXJlbnRJbnN0YW5jZUluZGV4IT09dm9pZCAwJiYoYS5fd2FpdGluZ1BhcmVudEluc3RhbmNlSW5kZXg9bi5wYXJlbnRJbnN0YW5jZUluZGV4KSxuLmlzRW5hYmxlZCE9PXZvaWQgMCYmbi5pc0VuYWJsZWQhPT1udWxsJiZhLnNldEVuYWJsZWQobi5pc0VuYWJsZWQpLG4uaXNWaXNpYmxlIT09dm9pZCAwJiZuLmlzVmlzaWJsZSE9PW51bGwmJihhLmlzVmlzaWJsZT1uLmlzVmlzaWJsZSksbi5pc1BpY2thYmxlIT09dm9pZCAwJiZuLmlzUGlja2FibGUhPT1udWxsJiYoYS5pc1BpY2thYmxlPW4uaXNQaWNrYWJsZSksbi5yb3RhdGlvblF1YXRlcm5pb24/YS5yb3RhdGlvblF1YXRlcm5pb249Wi5Gcm9tQXJyYXkobi5yb3RhdGlvblF1YXRlcm5pb24pOm4ucm90YXRpb24mJihhLnJvdGF0aW9uPXAuRnJvbUFycmF5KG4ucm90YXRpb24pKSxhLnNjYWxpbmc9cC5Gcm9tQXJyYXkobi5zY2FsaW5nKSxuLmNoZWNrQ29sbGlzaW9ucyE9bnVsbCYmbi5jaGVja0NvbGxpc2lvbnMhPW51bGwmJihhLmNoZWNrQ29sbGlzaW9ucz1uLmNoZWNrQ29sbGlzaW9ucyksbi5waWNrYWJsZSE9bnVsbCYmbi5waWNrYWJsZSE9bnVsbCYmKGEuaXNQaWNrYWJsZT1uLnBpY2thYmxlKSxuLnNob3dCb3VuZGluZ0JveCE9bnVsbCYmbi5zaG93Qm91bmRpbmdCb3ghPW51bGwmJihhLnNob3dCb3VuZGluZ0JveD1uLnNob3dCb3VuZGluZ0JveCksbi5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3ghPW51bGwmJm4uc2hvd1N1Yk1lc2hlc0JvdW5kaW5nQm94IT1udWxsJiYoYS5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3g9bi5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3gpLG4uYWxwaGFJbmRleCE9bnVsbCYmbi5zaG93U3ViTWVzaGVzQm91bmRpbmdCb3ghPW51bGwmJihhLmFscGhhSW5kZXg9bi5hbHBoYUluZGV4KSxuLnBoeXNpY3NJbXBvc3RvciYmVy5fUGh5c2ljc0ltcG9zdG9yUGFyc2VyKHQsYSxuKSxuLmFuaW1hdGlvbnMpe2ZvcihsZXQgbz0wO288bi5hbmltYXRpb25zLmxlbmd0aDtvKyspe2NvbnN0IGg9bi5hbmltYXRpb25zW29dLGw9cmkoIkJBQllMT04uQW5pbWF0aW9uIik7bCYmYS5hbmltYXRpb25zLnB1c2gobC5QYXJzZShoKSl9emUuUGFyc2VBbmltYXRpb25SYW5nZXMoYSxuLHQpLG4uYXV0b0FuaW1hdGUmJnQuYmVnaW5BbmltYXRpb24oYSxuLmF1dG9BbmltYXRlRnJvbSxuLmF1dG9BbmltYXRlVG8sbi5hdXRvQW5pbWF0ZUxvb3Asbi5hdXRvQW5pbWF0ZVNwZWVkfHwxKX19aWYoZS50aGluSW5zdGFuY2VzKXtjb25zdCByPWUudGhpbkluc3RhbmNlcztpZihzLnRoaW5JbnN0YW5jZUVuYWJsZVBpY2tpbmc9ISFyLmVuYWJsZVBpY2tpbmcsci5tYXRyaXhEYXRhPyhzLnRoaW5JbnN0YW5jZVNldEJ1ZmZlcigibWF0cml4IixuZXcgRmxvYXQzMkFycmF5KHIubWF0cml4RGF0YSksMTYsITEpLHMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeEJ1ZmZlclNpemU9ci5tYXRyaXhCdWZmZXJTaXplLHMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0NvdW50PXIuaW5zdGFuY2VzQ291bnQpOnMuX3RoaW5JbnN0YW5jZURhdGFTdG9yYWdlLm1hdHJpeEJ1ZmZlclNpemU9ci5tYXRyaXhCdWZmZXJTaXplLGUudGhpbkluc3RhbmNlcy51c2VyVGhpbkluc3RhbmNlKXtjb25zdCBuPWUudGhpbkluc3RhbmNlcy51c2VyVGhpbkluc3RhbmNlO2Zvcihjb25zdCBhIGluIG4uZGF0YSlzLnRoaW5JbnN0YW5jZVNldEJ1ZmZlcihhLG5ldyBGbG9hdDMyQXJyYXkobi5kYXRhW2FdKSxuLnN0cmlkZXNbYV0sITEpLHMuX3VzZXJUaGluSW5zdGFuY2VCdWZmZXJzU3RvcmFnZS5zaXplc1thXT1uLnNpemVzW2FdfX1yZXR1cm4gc31zZXRQb3NpdGlvbnNGb3JDUFVTa2lubmluZygpe2NvbnN0IGU9dGhpcy5faW50ZXJuYWxNZXNoRGF0YUluZm87aWYoIWUuX3NvdXJjZVBvc2l0aW9ucyl7Y29uc3QgdD10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7aWYoIXQpcmV0dXJuIGUuX3NvdXJjZVBvc2l0aW9ucztlLl9zb3VyY2VQb3NpdGlvbnM9bmV3IEZsb2F0MzJBcnJheSh0KSx0aGlzLmlzVmVydGV4QnVmZmVyVXBkYXRhYmxlKGcuUG9zaXRpb25LaW5kKXx8dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQsdCwhMCl9cmV0dXJuIGUuX3NvdXJjZVBvc2l0aW9uc31zZXROb3JtYWxzRm9yQ1BVU2tpbm5pbmcoKXtjb25zdCBlPXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvO2lmKCFlLl9zb3VyY2VOb3JtYWxzKXtjb25zdCB0PXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTm9ybWFsS2luZCk7aWYoIXQpcmV0dXJuIGUuX3NvdXJjZU5vcm1hbHM7ZS5fc291cmNlTm9ybWFscz1uZXcgRmxvYXQzMkFycmF5KHQpLHRoaXMuaXNWZXJ0ZXhCdWZmZXJVcGRhdGFibGUoZy5Ob3JtYWxLaW5kKXx8dGhpcy5zZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLHQsITApfXJldHVybiBlLl9zb3VyY2VOb3JtYWxzfWFwcGx5U2tlbGV0b24oZSl7aWYoIXRoaXMuZ2VvbWV0cnkpcmV0dXJuIHRoaXM7aWYodGhpcy5nZW9tZXRyeS5fc29mdHdhcmVTa2lubmluZ0ZyYW1lSWQ9PXRoaXMuZ2V0U2NlbmUoKS5nZXRGcmFtZUlkKCkpcmV0dXJuIHRoaXM7aWYodGhpcy5nZW9tZXRyeS5fc29mdHdhcmVTa2lubmluZ0ZyYW1lSWQ9dGhpcy5nZXRTY2VuZSgpLmdldEZyYW1lSWQoKSwhdGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Qb3NpdGlvbktpbmQpKXJldHVybiB0aGlzO2lmKCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzSW5kaWNlc0tpbmQpKXJldHVybiB0aGlzO2lmKCF0aGlzLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpKXJldHVybiB0aGlzO2NvbnN0IHQ9dGhpcy5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Ob3JtYWxLaW5kKSxpPXRoaXMuX2ludGVybmFsTWVzaERhdGFJbmZvO2lmKCFpLl9zb3VyY2VQb3NpdGlvbnMpe2NvbnN0IHY9dGhpcy5zdWJNZXNoZXMuc2xpY2UoKTt0aGlzLnNldFBvc2l0aW9uc0ZvckNQVVNraW5uaW5nKCksdGhpcy5zdWJNZXNoZXM9dn10JiYhaS5fc291cmNlTm9ybWFscyYmdGhpcy5zZXROb3JtYWxzRm9yQ1BVU2tpbm5pbmcoKTtsZXQgcz10aGlzLmdldFZlcnRpY2VzRGF0YShnLlBvc2l0aW9uS2luZCk7aWYoIXMpcmV0dXJuIHRoaXM7cyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheXx8KHM9bmV3IEZsb2F0MzJBcnJheShzKSk7bGV0IHI9dGhpcy5nZXRWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kKTtpZih0KXtpZighcilyZXR1cm4gdGhpcztyIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHwocj1uZXcgRmxvYXQzMkFycmF5KHIpKX1jb25zdCBuPXRoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzS2luZCksYT10aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0tpbmQpO2lmKCFhfHwhbilyZXR1cm4gdGhpcztjb25zdCBvPXRoaXMubnVtQm9uZUluZmx1ZW5jZXJzPjQsaD1vP3RoaXMuZ2V0VmVydGljZXNEYXRhKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKTpudWxsLGw9bz90aGlzLmdldFZlcnRpY2VzRGF0YShnLk1hdHJpY2VzV2VpZ2h0c0V4dHJhS2luZCk6bnVsbCx1PWUuZ2V0VHJhbnNmb3JtTWF0cmljZXModGhpcyksZD1wLlplcm8oKSxmPW5ldyB4LF89bmV3IHg7bGV0IEU9MCxtO2ZvcihsZXQgdj0wO3Y8cy5sZW5ndGg7dis9MyxFKz00KXtsZXQgUztmb3IobT0wO208NDttKyspUz1hW0UrbV0sUz4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQodSxNYXRoLmZsb29yKG5bRSttXSoxNiksUyxfKSxmLmFkZFRvU2VsZihfKSk7aWYobylmb3IobT0wO208NDttKyspUz1sW0UrbV0sUz4wJiYoeC5Gcm9tRmxvYXQzMkFycmF5VG9SZWZTY2FsZWQodSxNYXRoLmZsb29yKGhbRSttXSoxNiksUyxfKSxmLmFkZFRvU2VsZihfKSk7cC5UcmFuc2Zvcm1Db29yZGluYXRlc0Zyb21GbG9hdHNUb1JlZihpLl9zb3VyY2VQb3NpdGlvbnNbdl0saS5fc291cmNlUG9zaXRpb25zW3YrMV0saS5fc291cmNlUG9zaXRpb25zW3YrMl0sZixkKSxkLnRvQXJyYXkocyx2KSx0JiYocC5UcmFuc2Zvcm1Ob3JtYWxGcm9tRmxvYXRzVG9SZWYoaS5fc291cmNlTm9ybWFsc1t2XSxpLl9zb3VyY2VOb3JtYWxzW3YrMV0saS5fc291cmNlTm9ybWFsc1t2KzJdLGYsZCksZC50b0FycmF5KHIsdikpLGYucmVzZXQoKX1yZXR1cm4gdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Qb3NpdGlvbktpbmQscyksdCYmdGhpcy51cGRhdGVWZXJ0aWNlc0RhdGEoZy5Ob3JtYWxLaW5kLHIpLHRoaXN9c3RhdGljIE1pbk1heChlKXtsZXQgdD1udWxsLGk9bnVsbDtyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uKHMpe2NvbnN0IG49cy5nZXRCb3VuZGluZ0luZm8oKS5ib3VuZGluZ0JveDshdHx8IWk/KHQ9bi5taW5pbXVtV29ybGQsaT1uLm1heGltdW1Xb3JsZCk6KHQubWluaW1pemVJblBsYWNlKG4ubWluaW11bVdvcmxkKSxpLm1heGltaXplSW5QbGFjZShuLm1heGltdW1Xb3JsZCkpfSksIXR8fCFpP3ttaW46cC5aZXJvKCksbWF4OnAuWmVybygpfTp7bWluOnQsbWF4Oml9fXN0YXRpYyBDZW50ZXIoZSl7Y29uc3QgdD1lIGluc3RhbmNlb2YgQXJyYXk/Vy5NaW5NYXgoZSk6ZTtyZXR1cm4gcC5DZW50ZXIodC5taW4sdC5tYXgpfXN0YXRpYyBNZXJnZU1lc2hlcyhlLHQ9ITAsaSxzLHIsbil7cmV0dXJuIFBzKFcuX01lcmdlTWVzaGVzQ29yb3V0aW5lKGUsdCxpLHMscixuLCExKSl9c3RhdGljIE1lcmdlTWVzaGVzQXN5bmMoZSx0PSEwLGkscyxyLG4pe3JldHVybiBPbihXLl9NZXJnZU1lc2hlc0Nvcm91dGluZShlLHQsaSxzLHIsbiwhMCksd24oKSl9c3RhdGljKl9NZXJnZU1lc2hlc0Nvcm91dGluZShlLHQ9ITAsaSxzLHIsbixhKXtpZihlPWUuZmlsdGVyKEJvb2xlYW4pLGUubGVuZ3RoPT09MClyZXR1cm4gbnVsbDtsZXQgbztpZighaSl7bGV0IE09MDtmb3Iobz0wO288ZS5sZW5ndGg7bysrKWlmKE0rPWVbb10uZ2V0VG90YWxWZXJ0aWNlcygpLE0+PTY1NTM2KXJldHVybiBPLldhcm4oIkNhbm5vdCBtZXJnZSBtZXNoZXMgYmVjYXVzZSByZXN1bHRpbmcgbWVzaCB3aWxsIGhhdmUgbW9yZSB0aGFuIDY1NTM2IHZlcnRpY2VzLiBQbGVhc2UgdXNlIGFsbG93MzJCaXRzSW5kaWNlcyA9IHRydWUgdG8gdXNlIDMyIGJpdHMgaW5kaWNlcyIpLG51bGx9biYmKHI9ITEpO2NvbnN0IGg9bmV3IEFycmF5LGw9bmV3IEFycmF5LHU9bmV3IEFycmF5LGQ9ZVswXS5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uO2ZvcihvPTA7bzxlLmxlbmd0aDtvKyspe2NvbnN0IE09ZVtvXTtpZihNLmlzQW5JbnN0YW5jZSlyZXR1cm4gTy5XYXJuKCJDYW5ub3QgbWVyZ2UgaW5zdGFuY2UgbWVzaGVzLiIpLG51bGw7aWYoZCE9PU0ub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbilyZXR1cm4gTy5XYXJuKCJDYW5ub3QgbWVyZ2UgbWVzaGVzIHdpdGggZGlmZmVyZW50IG92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb24gdmFsdWVzLiIpLG51bGw7aWYociYmdS5wdXNoKE0uZ2V0VG90YWxJbmRpY2VzKCkpLG4paWYoTS5tYXRlcmlhbCl7Y29uc3QgTD1NLm1hdGVyaWFsO2lmKEwgaW5zdGFuY2VvZiBTaSl7Zm9yKGxldCBrPTA7azxMLnN1Yk1hdGVyaWFscy5sZW5ndGg7aysrKWguaW5kZXhPZihMLnN1Yk1hdGVyaWFsc1trXSk8MCYmaC5wdXNoKEwuc3ViTWF0ZXJpYWxzW2tdKTtmb3IobGV0IGs9MDtrPE0uc3ViTWVzaGVzLmxlbmd0aDtrKyspbC5wdXNoKGguaW5kZXhPZihMLnN1Yk1hdGVyaWFsc1tNLnN1Yk1lc2hlc1trXS5tYXRlcmlhbEluZGV4XSkpLHUucHVzaChNLnN1Yk1lc2hlc1trXS5pbmRleENvdW50KX1lbHNle2guaW5kZXhPZihMKTwwJiZoLnB1c2goTCk7Zm9yKGxldCBrPTA7azxNLnN1Yk1lc2hlcy5sZW5ndGg7aysrKWwucHVzaChoLmluZGV4T2YoTCkpLHUucHVzaChNLnN1Yk1lc2hlc1trXS5pbmRleENvdW50KX19ZWxzZSBmb3IobGV0IEw9MDtMPE0uc3ViTWVzaGVzLmxlbmd0aDtMKyspbC5wdXNoKDApLHUucHVzaChNLnN1Yk1lc2hlc1tMXS5pbmRleENvdW50KX1jb25zdCBmPWVbMF0sXz1NPT57Y29uc3QgTD1NLmNvbXB1dGVXb3JsZE1hdHJpeCghMCk7cmV0dXJuW2VlLkV4dHJhY3RGcm9tTWVzaChNLCExLCExKSxMXX0sW0UsbV09XyhmKTthJiYoeWllbGQpO2NvbnN0IHY9bmV3IEFycmF5KGUubGVuZ3RoLTEpO2ZvcihsZXQgTT0xO008ZS5sZW5ndGg7TSsrKXZbTS0xXT1fKGVbTV0pLGEmJih5aWVsZCk7Y29uc3QgUz1FLl9tZXJnZUNvcm91dGluZShtLHYsaSxhLCF0KTtsZXQgeT1TLm5leHQoKTtmb3IoOyF5LmRvbmU7KWEmJih5aWVsZCkseT1TLm5leHQoKTtjb25zdCBBPXkudmFsdWU7c3x8KHM9bmV3IFcoZi5uYW1lKyJfbWVyZ2VkIixmLmdldFNjZW5lKCkpKTtjb25zdCBDPUEuX2FwcGx5VG9Db3JvdXRpbmUocyx2b2lkIDAsYSk7bGV0IGI9Qy5uZXh0KCk7Zm9yKDshYi5kb25lOylhJiYoeWllbGQpLGI9Qy5uZXh0KCk7aWYocy5jaGVja0NvbGxpc2lvbnM9Zi5jaGVja0NvbGxpc2lvbnMscy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPWYub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbix0KWZvcihvPTA7bzxlLmxlbmd0aDtvKyspZVtvXS5kaXNwb3NlKCk7aWYocnx8bil7cy5yZWxlYXNlU3ViTWVzaGVzKCksbz0wO2xldCBNPTA7Zm9yKDtvPHUubGVuZ3RoOyl2dC5DcmVhdGVGcm9tSW5kaWNlcygwLE0sdVtvXSxzLHZvaWQgMCwhMSksTSs9dVtvXSxvKys7Zm9yKGNvbnN0IEwgb2Ygcy5zdWJNZXNoZXMpTC5yZWZyZXNoQm91bmRpbmdJbmZvKCk7cy5jb21wdXRlV29ybGRNYXRyaXgoITApfWlmKG4pe2NvbnN0IE09bmV3IFNpKGYubmFtZSsiX21lcmdlZCIsZi5nZXRTY2VuZSgpKTtNLnN1Yk1hdGVyaWFscz1oO2ZvcihsZXQgTD0wO0w8cy5zdWJNZXNoZXMubGVuZ3RoO0wrKylzLnN1Yk1lc2hlc1tMXS5tYXRlcmlhbEluZGV4PWxbTF07cy5tYXRlcmlhbD1NfWVsc2Ugcy5tYXRlcmlhbD1mLm1hdGVyaWFsO3JldHVybiBzfWFkZEluc3RhbmNlKGUpe2UuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheT10aGlzLmluc3RhbmNlcy5sZW5ndGgsdGhpcy5pbnN0YW5jZXMucHVzaChlKX1yZW1vdmVJbnN0YW5jZShlKXtjb25zdCB0PWUuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheTtpZih0IT0tMSl7aWYodCE9PXRoaXMuaW5zdGFuY2VzLmxlbmd0aC0xKXtjb25zdCBpPXRoaXMuaW5zdGFuY2VzW3RoaXMuaW5zdGFuY2VzLmxlbmd0aC0xXTt0aGlzLmluc3RhbmNlc1t0XT1pLGkuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheT10fWUuX2luZGV4SW5Tb3VyY2VNZXNoSW5zdGFuY2VBcnJheT0tMSx0aGlzLmluc3RhbmNlcy5wb3AoKX19X3Nob3VsZENvbnZlcnRSSFMoKXtyZXR1cm4gdGhpcy5vdmVycmlkZU1hdGVyaWFsU2lkZU9yaWVudGF0aW9uPT09UC5Db3VudGVyQ2xvY2tXaXNlU2lkZU9yaWVudGF0aW9ufX1XLkZST05UU0lERT1lZS5GUk9OVFNJREUsVy5CQUNLU0lERT1lZS5CQUNLU0lERSxXLkRPVUJMRVNJREU9ZWUuRE9VQkxFU0lERSxXLkRFRkFVTFRTSURFPWVlLkRFRkFVTFRTSURFLFcuTk9fQ0FQPTAsVy5DQVBfU1RBUlQ9MSxXLkNBUF9FTkQ9MixXLkNBUF9BTEw9MyxXLk5PX0ZMSVA9MCxXLkZMSVBfVElMRT0xLFcuUk9UQVRFX1RJTEU9MixXLkZMSVBfUk9XPTMsVy5ST1RBVEVfUk9XPTQsVy5GTElQX05fUk9UQVRFX1RJTEU9NSxXLkZMSVBfTl9ST1RBVEVfUk9XPTYsVy5DRU5URVI9MCxXLkxFRlQ9MSxXLlJJR0hUPTIsVy5UT1A9MyxXLkJPVFRPTT00LFcuSU5TVEFOQ0VETUVTSF9TT1JUX1RSQU5TUEFSRU5UPSExLFcuX0dyb3VuZE1lc2hQYXJzZXI9KGMsZSk9Pnt0aHJvdyAkKCJHcm91bmRNZXNoIil9LFcuX0dvbGRiZXJnTWVzaFBhcnNlcj0oYyxlKT0+e3Rocm93ICQoIkdvbGRiZXJnTWVzaCIpfSxXLl9MaW5lc01lc2hQYXJzZXI9KGMsZSk9Pnt0aHJvdyAkKCJMaW5lc01lc2giKX0saXQoIkJBQllMT04uTWVzaCIsVyksVy5wcm90b3R5cGUuc2V0TWF0ZXJpYWxCeUlEPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLnNldE1hdGVyaWFsQnlJZChjKX0sVy5DcmVhdGVEaXNjPVcuQ3JlYXRlRGlzY3x8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVCb3g9Vy5DcmVhdGVCb3h8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlU3BoZXJlPVcuQ3JlYXRlU3BoZXJlfHwoKCk9Pnt0aHJvdyBuZXcgRXJyb3IoIkltcG9ydCBNZXNoQnVpbGRlciB0byBwb3B1bGF0ZSB0aGlzIGZ1bmN0aW9uIil9KSxXLkNyZWF0ZUN5bGluZGVyPVcuQ3JlYXRlQ3lsaW5kZXJ8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlVG9ydXNLbm90PVcuQ3JlYXRlVG9ydXNLbm90fHwoKCk9Pnt0aHJvdyBuZXcgRXJyb3IoIkltcG9ydCBNZXNoQnVpbGRlciB0byBwb3B1bGF0ZSB0aGlzIGZ1bmN0aW9uIil9KSxXLkNyZWF0ZVRvcnVzPVcuQ3JlYXRlVG9ydXN8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlUGxhbmU9Vy5DcmVhdGVQbGFuZXx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVHcm91bmQ9Vy5DcmVhdGVHcm91bmR8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlVGlsZWRHcm91bmQ9Vy5DcmVhdGVUaWxlZEdyb3VuZHx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVHcm91bmRGcm9tSGVpZ2h0TWFwPVcuQ3JlYXRlR3JvdW5kRnJvbUhlaWdodE1hcHx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVUdWJlPVcuQ3JlYXRlVHViZXx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVQb2x5aGVkcm9uPVcuQ3JlYXRlUG9seWhlZHJvbnx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVJY29TcGhlcmU9Vy5DcmVhdGVJY29TcGhlcmV8fCgoKT0+e3Rocm93IG5ldyBFcnJvcigiSW1wb3J0IE1lc2hCdWlsZGVyIHRvIHBvcHVsYXRlIHRoaXMgZnVuY3Rpb24iKX0pLFcuQ3JlYXRlRGVjYWw9Vy5DcmVhdGVEZWNhbHx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5DcmVhdGVDYXBzdWxlPVcuQ3JlYXRlQ2Fwc3VsZXx8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSksVy5FeHRlbmRUb0dvbGRiZXJnPVcuRXh0ZW5kVG9Hb2xkYmVyZ3x8KCgpPT57dGhyb3cgbmV3IEVycm9yKCJJbXBvcnQgTWVzaEJ1aWxkZXIgdG8gcG9wdWxhdGUgdGhpcyBmdW5jdGlvbiIpfSk7Y2xhc3MgenR7Y29uc3RydWN0b3IoZT0wKXt0aGlzLnByaW9yaXR5PWV9Z2V0RGVzY3JpcHRpb24oKXtyZXR1cm4iIn1hcHBseShlLHQpe3JldHVybiEwfX1jbGFzcyBMcyBleHRlbmRzIHp0e2NvbnN0cnVjdG9yKGU9MCx0PTEwMjQsaT0uNSl7c3VwZXIoZSksdGhpcy5wcmlvcml0eT1lLHRoaXMubWF4aW11bVNpemU9dCx0aGlzLnN0ZXA9aX1nZXREZXNjcmlwdGlvbigpe3JldHVybiJSZWR1Y2luZyByZW5kZXIgdGFyZ2V0IHRleHR1cmUgc2l6ZSB0byAiK3RoaXMubWF4aW11bVNpemV9YXBwbHkoZSx0KXtsZXQgaT0hMDtmb3IobGV0IHM9MDtzPGUudGV4dHVyZXMubGVuZ3RoO3MrKyl7Y29uc3Qgcj1lLnRleHR1cmVzW3NdO2lmKCFyLmNhblJlc2NhbGV8fHIuZ2V0Q29udGV4dCljb250aW51ZTtjb25zdCBuPXIuZ2V0U2l6ZSgpO01hdGgubWF4KG4ud2lkdGgsbi5oZWlnaHQpPnRoaXMubWF4aW11bVNpemUmJihyLnNjYWxlKHRoaXMuc3RlcCksaT0hMSl9cmV0dXJuIGl9fWNsYXNzIFByIGV4dGVuZHMgenR7Y29uc3RydWN0b3IoZT0wLHQ9MixpPS4yNSl7c3VwZXIoZSksdGhpcy5wcmlvcml0eT1lLHRoaXMubWF4aW11bVNjYWxlPXQsdGhpcy5zdGVwPWksdGhpcy5fY3VycmVudFNjYWxlPS0xLHRoaXMuX2RpcmVjdGlvbk9mZnNldD0xfWdldERlc2NyaXB0aW9uKCl7cmV0dXJuIlNldHRpbmcgaGFyZHdhcmUgc2NhbGluZyBsZXZlbCB0byAiK3RoaXMuX2N1cnJlbnRTY2FsZX1hcHBseShlLHQpe3JldHVybiB0aGlzLl9jdXJyZW50U2NhbGU9PT0tMSYmKHRoaXMuX2N1cnJlbnRTY2FsZT1lLmdldEVuZ2luZSgpLmdldEhhcmR3YXJlU2NhbGluZ0xldmVsKCksdGhpcy5fY3VycmVudFNjYWxlPnRoaXMubWF4aW11bVNjYWxlJiYodGhpcy5fZGlyZWN0aW9uT2Zmc2V0PS0xKSksdGhpcy5fY3VycmVudFNjYWxlKz10aGlzLl9kaXJlY3Rpb25PZmZzZXQqdGhpcy5zdGVwLGUuZ2V0RW5naW5lKCkuc2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwodGhpcy5fY3VycmVudFNjYWxlKSx0aGlzLl9kaXJlY3Rpb25PZmZzZXQ9PT0xP3RoaXMuX2N1cnJlbnRTY2FsZT49dGhpcy5tYXhpbXVtU2NhbGU6dGhpcy5fY3VycmVudFNjYWxlPD10aGlzLm1heGltdW1TY2FsZX19Y2xhc3MgTnMgZXh0ZW5kcyB6dHtnZXREZXNjcmlwdGlvbigpe3JldHVybiJUdXJuaW5nIHNoYWRvd3Mgb24vb2ZmIn1hcHBseShlLHQpe3JldHVybiBlLnNoYWRvd3NFbmFibGVkPXQuaXNJbkltcHJvdmVtZW50TW9kZSwhMH19Y2xhc3MgQnMgZXh0ZW5kcyB6dHtnZXREZXNjcmlwdGlvbigpe3JldHVybiJUdXJuaW5nIHBvc3QtcHJvY2Vzc2VzIG9uL29mZiJ9YXBwbHkoZSx0KXtyZXR1cm4gZS5wb3N0UHJvY2Vzc2VzRW5hYmxlZD10LmlzSW5JbXByb3ZlbWVudE1vZGUsITB9fWNsYXNzIFVzIGV4dGVuZHMgenR7Z2V0RGVzY3JpcHRpb24oKXtyZXR1cm4iVHVybmluZyBsZW5zIGZsYXJlcyBvbi9vZmYifWFwcGx5KGUsdCl7cmV0dXJuIGUubGVuc0ZsYXJlc0VuYWJsZWQ9dC5pc0luSW1wcm92ZW1lbnRNb2RlLCEwfX1jbGFzcyBIbiBleHRlbmRzIHp0e2dldERlc2NyaXB0aW9uKCl7cmV0dXJuIHRoaXMub25HZXREZXNjcmlwdGlvbj90aGlzLm9uR2V0RGVzY3JpcHRpb24oKToiUnVubmluZyB1c2VyIGRlZmluZWQgY2FsbGJhY2sifWFwcGx5KGUsdCl7cmV0dXJuIHRoaXMub25BcHBseT90aGlzLm9uQXBwbHkoZSx0KTohMH19Y2xhc3Mga3MgZXh0ZW5kcyB6dHtnZXREZXNjcmlwdGlvbigpe3JldHVybiJUdXJuaW5nIHBhcnRpY2xlcyBvbi9vZmYifWFwcGx5KGUsdCl7cmV0dXJuIGUucGFydGljbGVzRW5hYmxlZD10LmlzSW5JbXByb3ZlbWVudE1vZGUsITB9fWNsYXNzIERyIGV4dGVuZHMgenR7Z2V0RGVzY3JpcHRpb24oKXtyZXR1cm4iVHVybmluZyByZW5kZXIgdGFyZ2V0cyBvZmYifWFwcGx5KGUsdCl7cmV0dXJuIGUucmVuZGVyVGFyZ2V0c0VuYWJsZWQ9dC5pc0luSW1wcm92ZW1lbnRNb2RlLCEwfX1jbGFzcyBRdCBleHRlbmRzIHp0e2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLl9jYW5CZU1lcmdlZD1lPT57aWYoIShlIGluc3RhbmNlb2YgVykpcmV0dXJuITE7Y29uc3QgdD1lO3JldHVybiEodC5pc0Rpc3Bvc2VkKCl8fCF0LmlzVmlzaWJsZXx8IXQuaXNFbmFibGVkKCl8fHQuaW5zdGFuY2VzLmxlbmd0aD4wfHx0LnNrZWxldG9ufHx0Lmhhc0xPRExldmVscyl9fXN0YXRpYyBnZXQgVXBkYXRlU2VsZWN0aW9uVHJlZSgpe3JldHVybiBRdC5fVXBkYXRlU2VsZWN0aW9uVHJlZX1zdGF0aWMgc2V0IFVwZGF0ZVNlbGVjdGlvblRyZWUoZSl7UXQuX1VwZGF0ZVNlbGVjdGlvblRyZWU9ZX1nZXREZXNjcmlwdGlvbigpe3JldHVybiJNZXJnaW5nIHNpbWlsYXIgbWVzaGVzIHRvZ2V0aGVyIn1hcHBseShlLHQsaSl7Y29uc3Qgcz1lLm1lc2hlcy5zbGljZSgwKTtsZXQgcj1zLmxlbmd0aDtmb3IobGV0IGE9MDthPHI7YSsrKXtjb25zdCBvPW5ldyBBcnJheSxoPXNbYV07aWYodGhpcy5fY2FuQmVNZXJnZWQoaCkpe28ucHVzaChoKTtmb3IobGV0IGw9YSsxO2w8cjtsKyspe2NvbnN0IHU9c1tsXTt0aGlzLl9jYW5CZU1lcmdlZCh1KSYmdS5tYXRlcmlhbD09PWgubWF0ZXJpYWwmJnUuY2hlY2tDb2xsaXNpb25zPT09aC5jaGVja0NvbGxpc2lvbnMmJihvLnB1c2godSksci0tLHMuc3BsaWNlKGwsMSksbC0tKX1vLmxlbmd0aDwyfHxXLk1lcmdlTWVzaGVzKG8sdm9pZCAwLCEwKX19Y29uc3Qgbj1lO3JldHVybiBuLmNyZWF0ZU9yVXBkYXRlU2VsZWN0aW9uT2N0cmVlJiYoaSE9bnVsbD9pJiZuLmNyZWF0ZU9yVXBkYXRlU2VsZWN0aW9uT2N0cmVlKCk6UXQuVXBkYXRlU2VsZWN0aW9uVHJlZSYmbi5jcmVhdGVPclVwZGF0ZVNlbGVjdGlvbk9jdHJlZSgpKSwhMH19UXQuX1VwZGF0ZVNlbGVjdGlvblRyZWU9ITE7Y2xhc3MgZ2l7Y29uc3RydWN0b3IoZT02MCx0PTJlMyl7dGhpcy50YXJnZXRGcmFtZVJhdGU9ZSx0aGlzLnRyYWNrZXJEdXJhdGlvbj10LHRoaXMub3B0aW1pemF0aW9ucz1uZXcgQXJyYXl9YWRkT3B0aW1pemF0aW9uKGUpe3JldHVybiB0aGlzLm9wdGltaXphdGlvbnMucHVzaChlKSx0aGlzfWFkZEN1c3RvbU9wdGltaXphdGlvbihlLHQsaT0wKXtjb25zdCBzPW5ldyBIbihpKTtyZXR1cm4gcy5vbkFwcGx5PWUscy5vbkdldERlc2NyaXB0aW9uPXQsdGhpcy5vcHRpbWl6YXRpb25zLnB1c2gocyksdGhpc31zdGF0aWMgTG93RGVncmFkYXRpb25BbGxvd2VkKGUpe2NvbnN0IHQ9bmV3IGdpKGUpO2xldCBpPTA7cmV0dXJuIHQuYWRkT3B0aW1pemF0aW9uKG5ldyBRdChpKSksdC5hZGRPcHRpbWl6YXRpb24obmV3IE5zKGkpKSx0LmFkZE9wdGltaXphdGlvbihuZXcgVXMoaSkpLGkrKyx0LmFkZE9wdGltaXphdGlvbihuZXcgQnMoaSkpLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBrcyhpKSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBMcyhpLDEwMjQpKSx0fXN0YXRpYyBNb2RlcmF0ZURlZ3JhZGF0aW9uQWxsb3dlZChlKXtjb25zdCB0PW5ldyBnaShlKTtsZXQgaT0wO3JldHVybiB0LmFkZE9wdGltaXphdGlvbihuZXcgUXQoaSkpLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBOcyhpKSksdC5hZGRPcHRpbWl6YXRpb24obmV3IFVzKGkpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IEJzKGkpKSx0LmFkZE9wdGltaXphdGlvbihuZXcga3MoaSkpLGkrKyx0LmFkZE9wdGltaXphdGlvbihuZXcgTHMoaSw1MTIpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IERyKGkpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IFByKGksMikpLHR9c3RhdGljIEhpZ2hEZWdyYWRhdGlvbkFsbG93ZWQoZSl7Y29uc3QgdD1uZXcgZ2koZSk7bGV0IGk9MDtyZXR1cm4gdC5hZGRPcHRpbWl6YXRpb24obmV3IFF0KGkpKSx0LmFkZE9wdGltaXphdGlvbihuZXcgTnMoaSkpLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBVcyhpKSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBCcyhpKSksdC5hZGRPcHRpbWl6YXRpb24obmV3IGtzKGkpKSxpKyssdC5hZGRPcHRpbWl6YXRpb24obmV3IExzKGksMjU2KSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBEcihpKSksaSsrLHQuYWRkT3B0aW1pemF0aW9uKG5ldyBQcihpLDQpKSx0fX1jbGFzcyBWc3tjb25zdHJ1Y3RvcihlLHQsaT0hMCxzPSExKXtpZih0aGlzLl9pc1J1bm5pbmc9ITEsdGhpcy5fY3VycmVudFByaW9yaXR5TGV2ZWw9MCx0aGlzLl90YXJnZXRGcmFtZVJhdGU9NjAsdGhpcy5fdHJhY2tlckR1cmF0aW9uPTJlMyx0aGlzLl9jdXJyZW50RnJhbWVSYXRlPTAsdGhpcy5faW1wcm92ZW1lbnRNb2RlPSExLHRoaXMub25TdWNjZXNzT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uTmV3T3B0aW1pemF0aW9uQXBwbGllZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkZhaWx1cmVPYnNlcnZhYmxlPW5ldyBGLHQ/dGhpcy5fb3B0aW9ucz10OnRoaXMuX29wdGlvbnM9bmV3IGdpLHRoaXMuX29wdGlvbnMudGFyZ2V0RnJhbWVSYXRlJiYodGhpcy5fdGFyZ2V0RnJhbWVSYXRlPXRoaXMuX29wdGlvbnMudGFyZ2V0RnJhbWVSYXRlKSx0aGlzLl9vcHRpb25zLnRyYWNrZXJEdXJhdGlvbiYmKHRoaXMuX3RyYWNrZXJEdXJhdGlvbj10aGlzLl9vcHRpb25zLnRyYWNrZXJEdXJhdGlvbiksaSl7bGV0IHI9MDtmb3IoY29uc3QgbiBvZiB0aGlzLl9vcHRpb25zLm9wdGltaXphdGlvbnMpbi5wcmlvcml0eT1yKyt9dGhpcy5faW1wcm92ZW1lbnRNb2RlPXMsdGhpcy5fc2NlbmU9ZXx8ZmUuTGFzdENyZWF0ZWRTY2VuZSx0aGlzLl9zY2VuZURpc3Bvc2VPYnNlcnZlcj10aGlzLl9zY2VuZS5vbkRpc3Bvc2VPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuX3NjZW5lRGlzcG9zZU9ic2VydmVyPW51bGwsdGhpcy5kaXNwb3NlKCl9KX1nZXQgaXNJbkltcHJvdmVtZW50TW9kZSgpe3JldHVybiB0aGlzLl9pbXByb3ZlbWVudE1vZGV9c2V0IGlzSW5JbXByb3ZlbWVudE1vZGUoZSl7dGhpcy5faW1wcm92ZW1lbnRNb2RlPWV9Z2V0IGN1cnJlbnRQcmlvcml0eUxldmVsKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRQcmlvcml0eUxldmVsfWdldCBjdXJyZW50RnJhbWVSYXRlKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRGcmFtZVJhdGV9Z2V0IHRhcmdldEZyYW1lUmF0ZSgpe3JldHVybiB0aGlzLl90YXJnZXRGcmFtZVJhdGV9c2V0IHRhcmdldEZyYW1lUmF0ZShlKXt0aGlzLl90YXJnZXRGcmFtZVJhdGU9ZX1nZXQgdHJhY2tlckR1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX3RyYWNrZXJEdXJhdGlvbn1zZXQgdHJhY2tlckR1cmF0aW9uKGUpe3RoaXMuX3RyYWNrZXJEdXJhdGlvbj1lfWdldCBvcHRpbWl6YXRpb25zKCl7cmV0dXJuIHRoaXMuX29wdGlvbnMub3B0aW1pemF0aW9uc31zdG9wKCl7dGhpcy5faXNSdW5uaW5nPSExfXJlc2V0KCl7dGhpcy5fY3VycmVudFByaW9yaXR5TGV2ZWw9MH1zdGFydCgpe3RoaXMuX2lzUnVubmluZ3x8KHRoaXMuX2lzUnVubmluZz0hMCx0aGlzLl9zY2VuZS5leGVjdXRlV2hlblJlYWR5KCgpPT57c2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrQ3VycmVudFN0YXRlKCl9LHRoaXMuX3RyYWNrZXJEdXJhdGlvbil9KSl9X2NoZWNrQ3VycmVudFN0YXRlKCl7aWYoIXRoaXMuX2lzUnVubmluZylyZXR1cm47Y29uc3QgZT10aGlzLl9zY2VuZSx0PXRoaXMuX29wdGlvbnM7aWYodGhpcy5fY3VycmVudEZyYW1lUmF0ZT1NYXRoLnJvdW5kKGUuZ2V0RW5naW5lKCkuZ2V0RnBzKCkpLHRoaXMuX2ltcHJvdmVtZW50TW9kZSYmdGhpcy5fY3VycmVudEZyYW1lUmF0ZTw9dGhpcy5fdGFyZ2V0RnJhbWVSYXRlfHwhdGhpcy5faW1wcm92ZW1lbnRNb2RlJiZ0aGlzLl9jdXJyZW50RnJhbWVSYXRlPj10aGlzLl90YXJnZXRGcmFtZVJhdGUpe3RoaXMuX2lzUnVubmluZz0hMSx0aGlzLm9uU3VjY2Vzc09ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpO3JldHVybn1sZXQgaT0hMCxzPSEwO2ZvcihsZXQgcj0wO3I8dC5vcHRpbWl6YXRpb25zLmxlbmd0aDtyKyspe2NvbnN0IG49dC5vcHRpbWl6YXRpb25zW3JdO24ucHJpb3JpdHk9PT10aGlzLl9jdXJyZW50UHJpb3JpdHlMZXZlbCYmKHM9ITEsaT1pJiZuLmFwcGx5KGUsdGhpcyksdGhpcy5vbk5ld09wdGltaXphdGlvbkFwcGxpZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhuKSl9aWYocyl7dGhpcy5faXNSdW5uaW5nPSExLHRoaXMub25GYWlsdXJlT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7cmV0dXJufWkmJnRoaXMuX2N1cnJlbnRQcmlvcml0eUxldmVsKyssZS5leGVjdXRlV2hlblJlYWR5KCgpPT57c2V0VGltZW91dCgoKT0+e3RoaXMuX2NoZWNrQ3VycmVudFN0YXRlKCl9LHRoaXMuX3RyYWNrZXJEdXJhdGlvbil9KX1kaXNwb3NlKCl7dGhpcy5zdG9wKCksdGhpcy5vblN1Y2Nlc3NPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkZhaWx1cmVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbk5ld09wdGltaXphdGlvbkFwcGxpZWRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fc2NlbmVEaXNwb3NlT2JzZXJ2ZXImJnRoaXMuX3NjZW5lLm9uRGlzcG9zZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX3NjZW5lRGlzcG9zZU9ic2VydmVyKX1zdGF0aWMgT3B0aW1pemVBc3luYyhlLHQsaSxzKXtjb25zdCByPW5ldyBWcyhlLHR8fGdpLk1vZGVyYXRlRGVncmFkYXRpb25BbGxvd2VkKCksITEpO3JldHVybiBpJiZyLm9uU3VjY2Vzc09ic2VydmFibGUuYWRkKCgpPT57aSgpfSkscyYmci5vbkZhaWx1cmVPYnNlcnZhYmxlLmFkZCgoKT0+e3MoKX0pLHIuc3RhcnQoKSxyfX1mdW5jdGlvbiBLbihjKXtjb25zdHtlbmdpbmU6ZX09Yyx0PW5ldyBuZShlKTt0LmNsZWFyQ29sb3I9bmV3IG1lKDAsMCwwLDApLHQucG9pbnRlck1vdmVQcmVkaWNhdGU9KCk9PiExLHQucG9pbnRlckRvd25QcmVkaWNhdGU9KCk9PiExLHQucG9pbnRlclVwUHJlZGljYXRlPSgpPT4hMSx0LmNsZWFyQ2FjaGVkVmVydGV4RGF0YSgpLHQudGhlbWVEYXRhPXt9O2NvbnN0IGk9Z2kuTG93RGVncmFkYXRpb25BbGxvd2VkKCk7cmV0dXJuIGkub3B0aW1pemF0aW9ucz1pLm9wdGltaXphdGlvbnMuc3BsaWNlKDEpLGkudGFyZ2V0RnJhbWVSYXRlPTYwLFZzLk9wdGltaXplQXN5bmModCxpKSx0fWNsYXNzIEdlIGV4dGVuZHMgantjb25zdHJ1Y3RvcihlLHQsaSxzPSEwKXtzdXBlcihlLHQsaSxzKSx0aGlzLl90bXBVcFZlY3Rvcj1wLlplcm8oKSx0aGlzLl90bXBUYXJnZXRWZWN0b3I9cC5aZXJvKCksdGhpcy5jYW1lcmFEaXJlY3Rpb249bmV3IHAoMCwwLDApLHRoaXMuY2FtZXJhUm90YXRpb249bmV3IHZlKDAsMCksdGhpcy5pZ25vcmVQYXJlbnRTY2FsaW5nPSExLHRoaXMudXBkYXRlVXBWZWN0b3JGcm9tUm90YXRpb249ITEsdGhpcy5fdG1wUXVhdGVybmlvbj1uZXcgWix0aGlzLnJvdGF0aW9uPW5ldyBwKDAsMCwwKSx0aGlzLnNwZWVkPTIsdGhpcy5ub1JvdGF0aW9uQ29uc3RyYWludD0hMSx0aGlzLmludmVydFJvdGF0aW9uPSExLHRoaXMuaW52ZXJzZVJvdGF0aW9uU3BlZWQ9LjIsdGhpcy5sb2NrZWRUYXJnZXQ9bnVsbCx0aGlzLl9jdXJyZW50VGFyZ2V0PXAuWmVybygpLHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlPTEsdGhpcy5fdmlld01hdHJpeD14Llplcm8oKSx0aGlzLl9jYW1NYXRyaXg9eC5aZXJvKCksdGhpcy5fY2FtZXJhVHJhbnNmb3JtTWF0cml4PXguWmVybygpLHRoaXMuX2NhbWVyYVJvdGF0aW9uTWF0cml4PXguWmVybygpLHRoaXMuX3JlZmVyZW5jZVBvaW50PW5ldyBwKDAsMCwxKSx0aGlzLl90cmFuc2Zvcm1lZFJlZmVyZW5jZVBvaW50PXAuWmVybygpLHRoaXMuX2RlZmF1bHRVcD1wLlVwKCksdGhpcy5fY2FjaGVkUm90YXRpb25aPTAsdGhpcy5fY2FjaGVkUXVhdGVybmlvblJvdGF0aW9uWj0wfWdldEZyb250UG9zaXRpb24oZSl7dGhpcy5nZXRXb3JsZE1hdHJpeCgpO2NvbnN0IHQ9dGhpcy5nZXRUYXJnZXQoKS5zdWJ0cmFjdCh0aGlzLnBvc2l0aW9uKTtyZXR1cm4gdC5ub3JtYWxpemUoKSx0LnNjYWxlSW5QbGFjZShlKSx0aGlzLmdsb2JhbFBvc2l0aW9uLmFkZCh0KX1fZ2V0TG9ja2VkVGFyZ2V0UG9zaXRpb24oKXtyZXR1cm4gdGhpcy5sb2NrZWRUYXJnZXQ/KHRoaXMubG9ja2VkVGFyZ2V0LmFic29sdXRlUG9zaXRpb24mJnRoaXMubG9ja2VkVGFyZ2V0LmNvbXB1dGVXb3JsZE1hdHJpeCgpLHRoaXMubG9ja2VkVGFyZ2V0LmFic29sdXRlUG9zaXRpb258fHRoaXMubG9ja2VkVGFyZ2V0KTpudWxsfXN0b3JlU3RhdGUoKXtyZXR1cm4gdGhpcy5fc3RvcmVkUG9zaXRpb249dGhpcy5wb3NpdGlvbi5jbG9uZSgpLHRoaXMuX3N0b3JlZFJvdGF0aW9uPXRoaXMucm90YXRpb24uY2xvbmUoKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiYmKHRoaXMuX3N0b3JlZFJvdGF0aW9uUXVhdGVybmlvbj10aGlzLnJvdGF0aW9uUXVhdGVybmlvbi5jbG9uZSgpKSxzdXBlci5zdG9yZVN0YXRlKCl9X3Jlc3RvcmVTdGF0ZVZhbHVlcygpe3JldHVybiBzdXBlci5fcmVzdG9yZVN0YXRlVmFsdWVzKCk/KHRoaXMucG9zaXRpb249dGhpcy5fc3RvcmVkUG9zaXRpb24uY2xvbmUoKSx0aGlzLnJvdGF0aW9uPXRoaXMuX3N0b3JlZFJvdGF0aW9uLmNsb25lKCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJih0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj10aGlzLl9zdG9yZWRSb3RhdGlvblF1YXRlcm5pb24uY2xvbmUoKSksdGhpcy5jYW1lcmFEaXJlY3Rpb24uY29weUZyb21GbG9hdHMoMCwwLDApLHRoaXMuY2FtZXJhUm90YXRpb24uY29weUZyb21GbG9hdHMoMCwwKSwhMCk6ITF9X2luaXRDYWNoZSgpe3N1cGVyLl9pbml0Q2FjaGUoKSx0aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQ9bmV3IHAoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlLnJvdGF0aW9uPW5ldyBwKE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFKSx0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb249bmV3IFooTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSl9X3VwZGF0ZUNhY2hlKGUpe2V8fHN1cGVyLl91cGRhdGVDYWNoZSgpO2NvbnN0IHQ9dGhpcy5fZ2V0TG9ja2VkVGFyZ2V0UG9zaXRpb24oKTt0P3RoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD90aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQuY29weUZyb20odCk6dGhpcy5fY2FjaGUubG9ja2VkVGFyZ2V0PXQuY2xvbmUoKTp0aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQ9bnVsbCx0aGlzLl9jYWNoZS5yb3RhdGlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uKSx0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiYmdGhpcy5fY2FjaGUucm90YXRpb25RdWF0ZXJuaW9uLmNvcHlGcm9tKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uKX1faXNTeW5jaHJvbml6ZWRWaWV3TWF0cml4KCl7aWYoIXN1cGVyLl9pc1N5bmNocm9uaXplZFZpZXdNYXRyaXgoKSlyZXR1cm4hMTtjb25zdCBlPXRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCk7cmV0dXJuKHRoaXMuX2NhY2hlLmxvY2tlZFRhcmdldD90aGlzLl9jYWNoZS5sb2NrZWRUYXJnZXQuZXF1YWxzKGUpOiFlKSYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLmVxdWFscyh0aGlzLl9jYWNoZS5yb3RhdGlvblF1YXRlcm5pb24pOnRoaXMuX2NhY2hlLnJvdGF0aW9uLmVxdWFscyh0aGlzLnJvdGF0aW9uKSl9X2NvbXB1dGVMb2NhbENhbWVyYVNwZWVkKCl7Y29uc3QgZT10aGlzLmdldEVuZ2luZSgpO3JldHVybiB0aGlzLnNwZWVkKk1hdGguc3FydChlLmdldERlbHRhVGltZSgpLyhlLmdldEZwcygpKjEwMCkpfXNldFRhcmdldChlKXt0aGlzLnVwVmVjdG9yLm5vcm1hbGl6ZSgpLHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlPWUuc3VidHJhY3QodGhpcy5wb3NpdGlvbikubGVuZ3RoKCksdGhpcy5wb3NpdGlvbi56PT09ZS56JiYodGhpcy5wb3NpdGlvbi56Kz14ZSksdGhpcy5fcmVmZXJlbmNlUG9pbnQubm9ybWFsaXplKCkuc2NhbGVJblBsYWNlKHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlKSx4Lkxvb2tBdExIVG9SZWYodGhpcy5wb3NpdGlvbixlLHRoaXMuX2RlZmF1bHRVcCx0aGlzLl9jYW1NYXRyaXgpLHRoaXMuX2NhbU1hdHJpeC5pbnZlcnQoKSx0aGlzLnJvdGF0aW9uLng9TWF0aC5hdGFuKHRoaXMuX2NhbU1hdHJpeC5tWzZdL3RoaXMuX2NhbU1hdHJpeC5tWzEwXSk7Y29uc3QgdD1lLnN1YnRyYWN0KHRoaXMucG9zaXRpb24pO3QueD49MD90aGlzLnJvdGF0aW9uLnk9LU1hdGguYXRhbih0LnovdC54KStNYXRoLlBJLzI6dGhpcy5yb3RhdGlvbi55PS1NYXRoLmF0YW4odC56L3QueCktTWF0aC5QSS8yLHRoaXMucm90YXRpb24uej0wLGlzTmFOKHRoaXMucm90YXRpb24ueCkmJih0aGlzLnJvdGF0aW9uLng9MCksaXNOYU4odGhpcy5yb3RhdGlvbi55KSYmKHRoaXMucm90YXRpb24ueT0wKSxpc05hTih0aGlzLnJvdGF0aW9uLnopJiYodGhpcy5yb3RhdGlvbi56PTApLHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnosdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pfWdldCB0YXJnZXQoKXtyZXR1cm4gdGhpcy5nZXRUYXJnZXQoKX1zZXQgdGFyZ2V0KGUpe3RoaXMuc2V0VGFyZ2V0KGUpfWdldFRhcmdldCgpe3JldHVybiB0aGlzLl9jdXJyZW50VGFyZ2V0fV9kZWNpZGVJZk5lZWRzVG9Nb3ZlKCl7cmV0dXJuIE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLngpPjB8fE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnkpPjB8fE1hdGguYWJzKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnopPjB9X3VwZGF0ZVBvc2l0aW9uKCl7aWYodGhpcy5wYXJlbnQpe3RoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCkuaW52ZXJ0VG9SZWYoRC5NYXRyaXhbMF0pLHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYodGhpcy5jYW1lcmFEaXJlY3Rpb24sRC5NYXRyaXhbMF0sRC5WZWN0b3IzWzBdKSx0aGlzLnBvc2l0aW9uLmFkZEluUGxhY2UoRC5WZWN0b3IzWzBdKTtyZXR1cm59dGhpcy5wb3NpdGlvbi5hZGRJblBsYWNlKHRoaXMuY2FtZXJhRGlyZWN0aW9uKX1fY2hlY2tJbnB1dHMoKXtjb25zdCBlPXRoaXMuaW52ZXJ0Um90YXRpb24/LXRoaXMuaW52ZXJzZVJvdGF0aW9uU3BlZWQ6MSx0PXRoaXMuX2RlY2lkZUlmTmVlZHNUb01vdmUoKSxpPU1hdGguYWJzKHRoaXMuY2FtZXJhUm90YXRpb24ueCk+MHx8TWF0aC5hYnModGhpcy5jYW1lcmFSb3RhdGlvbi55KT4wO3QmJnRoaXMuX3VwZGF0ZVBvc2l0aW9uKCksaSYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uJiZ0aGlzLnJvdGF0aW9uUXVhdGVybmlvbi50b0V1bGVyQW5nbGVzVG9SZWYodGhpcy5yb3RhdGlvbiksdGhpcy5yb3RhdGlvbi54Kz10aGlzLmNhbWVyYVJvdGF0aW9uLngqZSx0aGlzLnJvdGF0aW9uLnkrPXRoaXMuY2FtZXJhUm90YXRpb24ueSplLHRoaXMubm9Sb3RhdGlvbkNvbnN0cmFpbnR8fCh0aGlzLnJvdGF0aW9uLng+MS41NzA3OTYmJih0aGlzLnJvdGF0aW9uLng9MS41NzA3OTYpLHRoaXMucm90YXRpb24ueDwtMS41NzA3OTYmJih0aGlzLnJvdGF0aW9uLng9LTEuNTcwNzk2KSksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJnRoaXMucm90YXRpb24ubGVuZ3RoU3F1YXJlZCgpJiZaLlJvdGF0aW9uWWF3UGl0Y2hSb2xsVG9SZWYodGhpcy5yb3RhdGlvbi55LHRoaXMucm90YXRpb24ueCx0aGlzLnJvdGF0aW9uLnosdGhpcy5yb3RhdGlvblF1YXRlcm5pb24pKSx0JiYoTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueCk8dGhpcy5zcGVlZCp4ZSYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLng9MCksTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueSk8dGhpcy5zcGVlZCp4ZSYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLnk9MCksTWF0aC5hYnModGhpcy5jYW1lcmFEaXJlY3Rpb24ueik8dGhpcy5zcGVlZCp4ZSYmKHRoaXMuY2FtZXJhRGlyZWN0aW9uLno9MCksdGhpcy5jYW1lcmFEaXJlY3Rpb24uc2NhbGVJblBsYWNlKHRoaXMuaW5lcnRpYSkpLGkmJihNYXRoLmFicyh0aGlzLmNhbWVyYVJvdGF0aW9uLngpPHRoaXMuc3BlZWQqeGUmJih0aGlzLmNhbWVyYVJvdGF0aW9uLng9MCksTWF0aC5hYnModGhpcy5jYW1lcmFSb3RhdGlvbi55KTx0aGlzLnNwZWVkKnhlJiYodGhpcy5jYW1lcmFSb3RhdGlvbi55PTApLHRoaXMuY2FtZXJhUm90YXRpb24uc2NhbGVJblBsYWNlKHRoaXMuaW5lcnRpYSkpLHN1cGVyLl9jaGVja0lucHV0cygpfV91cGRhdGVDYW1lcmFSb3RhdGlvbk1hdHJpeCgpe3RoaXMucm90YXRpb25RdWF0ZXJuaW9uP3RoaXMucm90YXRpb25RdWF0ZXJuaW9uLnRvUm90YXRpb25NYXRyaXgodGhpcy5fY2FtZXJhUm90YXRpb25NYXRyaXgpOnguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0aGlzLnJvdGF0aW9uLnksdGhpcy5yb3RhdGlvbi54LHRoaXMucm90YXRpb24ueix0aGlzLl9jYW1lcmFSb3RhdGlvbk1hdHJpeCl9X3JvdGF0ZVVwVmVjdG9yV2l0aENhbWVyYVJvdGF0aW9uTWF0cml4KCl7cmV0dXJuIHAuVHJhbnNmb3JtTm9ybWFsVG9SZWYodGhpcy5fZGVmYXVsdFVwLHRoaXMuX2NhbWVyYVJvdGF0aW9uTWF0cml4LHRoaXMudXBWZWN0b3IpLHRoaXN9X2dldFZpZXdNYXRyaXgoKXtyZXR1cm4gdGhpcy5sb2NrZWRUYXJnZXQmJnRoaXMuc2V0VGFyZ2V0KHRoaXMuX2dldExvY2tlZFRhcmdldFBvc2l0aW9uKCkpLHRoaXMuX3VwZGF0ZUNhbWVyYVJvdGF0aW9uTWF0cml4KCksdGhpcy5yb3RhdGlvblF1YXRlcm5pb24mJnRoaXMuX2NhY2hlZFF1YXRlcm5pb25Sb3RhdGlvblohPXRoaXMucm90YXRpb25RdWF0ZXJuaW9uLno/KHRoaXMuX3JvdGF0ZVVwVmVjdG9yV2l0aENhbWVyYVJvdGF0aW9uTWF0cml4KCksdGhpcy5fY2FjaGVkUXVhdGVybmlvblJvdGF0aW9uWj10aGlzLnJvdGF0aW9uUXVhdGVybmlvbi56KTp0aGlzLl9jYWNoZWRSb3RhdGlvblohPT10aGlzLnJvdGF0aW9uLnomJih0aGlzLl9yb3RhdGVVcFZlY3RvcldpdGhDYW1lcmFSb3RhdGlvbk1hdHJpeCgpLHRoaXMuX2NhY2hlZFJvdGF0aW9uWj10aGlzLnJvdGF0aW9uLnopLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLl9yZWZlcmVuY2VQb2ludCx0aGlzLl9jYW1lcmFSb3RhdGlvbk1hdHJpeCx0aGlzLl90cmFuc2Zvcm1lZFJlZmVyZW5jZVBvaW50KSx0aGlzLnBvc2l0aW9uLmFkZFRvUmVmKHRoaXMuX3RyYW5zZm9ybWVkUmVmZXJlbmNlUG9pbnQsdGhpcy5fY3VycmVudFRhcmdldCksdGhpcy51cGRhdGVVcFZlY3RvckZyb21Sb3RhdGlvbiYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uP19pLlkucm90YXRlQnlRdWF0ZXJuaW9uVG9SZWYodGhpcy5yb3RhdGlvblF1YXRlcm5pb24sdGhpcy51cFZlY3Rvcik6KFouRnJvbUV1bGVyVmVjdG9yVG9SZWYodGhpcy5yb3RhdGlvbix0aGlzLl90bXBRdWF0ZXJuaW9uKSxfaS5ZLnJvdGF0ZUJ5UXVhdGVybmlvblRvUmVmKHRoaXMuX3RtcFF1YXRlcm5pb24sdGhpcy51cFZlY3RvcikpKSx0aGlzLl9jb21wdXRlVmlld01hdHJpeCh0aGlzLnBvc2l0aW9uLHRoaXMuX2N1cnJlbnRUYXJnZXQsdGhpcy51cFZlY3RvciksdGhpcy5fdmlld01hdHJpeH1fY29tcHV0ZVZpZXdNYXRyaXgoZSx0LGkpe2lmKHRoaXMuaWdub3JlUGFyZW50U2NhbGluZyl7aWYodGhpcy5wYXJlbnQpe2NvbnN0IHM9dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKTtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZSxzLHRoaXMuX2dsb2JhbFBvc2l0aW9uKSxwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodCxzLHRoaXMuX3RtcFRhcmdldFZlY3RvcikscC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihpLHMsdGhpcy5fdG1wVXBWZWN0b3IpLHRoaXMuX21hcmtTeW5jZWRXaXRoUGFyZW50KCl9ZWxzZSB0aGlzLl9nbG9iYWxQb3NpdGlvbi5jb3B5RnJvbShlKSx0aGlzLl90bXBUYXJnZXRWZWN0b3IuY29weUZyb20odCksdGhpcy5fdG1wVXBWZWN0b3IuY29weUZyb20oaSk7dGhpcy5nZXRTY2VuZSgpLnVzZVJpZ2h0SGFuZGVkU3lzdGVtP3guTG9va0F0UkhUb1JlZih0aGlzLl9nbG9iYWxQb3NpdGlvbix0aGlzLl90bXBUYXJnZXRWZWN0b3IsdGhpcy5fdG1wVXBWZWN0b3IsdGhpcy5fdmlld01hdHJpeCk6eC5Mb29rQXRMSFRvUmVmKHRoaXMuX2dsb2JhbFBvc2l0aW9uLHRoaXMuX3RtcFRhcmdldFZlY3Rvcix0aGlzLl90bXBVcFZlY3Rvcix0aGlzLl92aWV3TWF0cml4KTtyZXR1cm59aWYodGhpcy5nZXRTY2VuZSgpLnVzZVJpZ2h0SGFuZGVkU3lzdGVtP3guTG9va0F0UkhUb1JlZihlLHQsaSx0aGlzLl92aWV3TWF0cml4KTp4Lkxvb2tBdExIVG9SZWYoZSx0LGksdGhpcy5fdmlld01hdHJpeCksdGhpcy5wYXJlbnQpe2NvbnN0IHM9dGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgoKTt0aGlzLl92aWV3TWF0cml4LmludmVydCgpLHRoaXMuX3ZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZihzLHRoaXMuX3ZpZXdNYXRyaXgpLHRoaXMuX3ZpZXdNYXRyaXguZ2V0VHJhbnNsYXRpb25Ub1JlZih0aGlzLl9nbG9iYWxQb3NpdGlvbiksdGhpcy5fdmlld01hdHJpeC5pbnZlcnQoKSx0aGlzLl9tYXJrU3luY2VkV2l0aFBhcmVudCgpfWVsc2UgdGhpcy5fZ2xvYmFsUG9zaXRpb24uY29weUZyb20oZSl9Y3JlYXRlUmlnQ2FtZXJhKGUsdCl7aWYodGhpcy5jYW1lcmFSaWdNb2RlIT09ai5SSUdfTU9ERV9OT05FKXtjb25zdCBpPW5ldyBHZShlLHRoaXMucG9zaXRpb24uY2xvbmUoKSx0aGlzLmdldFNjZW5lKCkpO3JldHVybiBpLmlzUmlnQ2FtZXJhPSEwLGkucmlnUGFyZW50PXRoaXMsKHRoaXMuY2FtZXJhUmlnTW9kZT09PWouUklHX01PREVfVlJ8fHRoaXMuY2FtZXJhUmlnTW9kZT09PWouUklHX01PREVfV0VCVlIpJiYodGhpcy5yb3RhdGlvblF1YXRlcm5pb258fCh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbj1uZXcgWiksaS5fY2FtZXJhUmlnUGFyYW1zPXt9LGkucm90YXRpb25RdWF0ZXJuaW9uPW5ldyBaKSxpLm1vZGU9dGhpcy5tb2RlLGkub3J0aG9MZWZ0PXRoaXMub3J0aG9MZWZ0LGkub3J0aG9SaWdodD10aGlzLm9ydGhvUmlnaHQsaS5vcnRob1RvcD10aGlzLm9ydGhvVG9wLGkub3J0aG9Cb3R0b209dGhpcy5vcnRob0JvdHRvbSxpfXJldHVybiBudWxsfV91cGRhdGVSaWdDYW1lcmFzKCl7Y29uc3QgZT10aGlzLl9yaWdDYW1lcmFzWzBdLHQ9dGhpcy5fcmlnQ2FtZXJhc1sxXTtzd2l0Y2godGhpcy5jb21wdXRlV29ybGRNYXRyaXgoKSx0aGlzLmNhbWVyYVJpZ01vZGUpe2Nhc2Ugai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfQU5BR0xZUEg6Y2FzZSBqLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX1BBUkFMTEVMOmNhc2Ugai5SSUdfTU9ERV9TVEVSRU9TQ09QSUNfU0lERUJZU0lERV9DUk9TU0VZRUQ6Y2FzZSBqLlJJR19NT0RFX1NURVJFT1NDT1BJQ19PVkVSVU5ERVI6Y2FzZSBqLlJJR19NT0RFX1NURVJFT1NDT1BJQ19JTlRFUkxBQ0VEOntjb25zdCBpPXRoaXMuY2FtZXJhUmlnTW9kZT09PWouUklHX01PREVfU1RFUkVPU0NPUElDX1NJREVCWVNJREVfQ1JPU1NFWUVEPzE6LTEscz10aGlzLmNhbWVyYVJpZ01vZGU9PT1qLlJJR19NT0RFX1NURVJFT1NDT1BJQ19TSURFQllTSURFX0NST1NTRVlFRD8tMToxO3RoaXMuX2dldFJpZ0NhbVBvc2l0aW9uQW5kVGFyZ2V0KHRoaXMuX2NhbWVyYVJpZ1BhcmFtcy5zdGVyZW9IYWxmQW5nbGUqaSxlKSx0aGlzLl9nZXRSaWdDYW1Qb3NpdGlvbkFuZFRhcmdldCh0aGlzLl9jYW1lcmFSaWdQYXJhbXMuc3RlcmVvSGFsZkFuZ2xlKnMsdCk7YnJlYWt9Y2FzZSBqLlJJR19NT0RFX1ZSOmUucm90YXRpb25RdWF0ZXJuaW9uPyhlLnJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uUXVhdGVybmlvbiksdC5yb3RhdGlvblF1YXRlcm5pb24uY29weUZyb20odGhpcy5yb3RhdGlvblF1YXRlcm5pb24pKTooZS5yb3RhdGlvbi5jb3B5RnJvbSh0aGlzLnJvdGF0aW9uKSx0LnJvdGF0aW9uLmNvcHlGcm9tKHRoaXMucm90YXRpb24pKSxlLnBvc2l0aW9uLmNvcHlGcm9tKHRoaXMucG9zaXRpb24pLHQucG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbik7YnJlYWt9c3VwZXIuX3VwZGF0ZVJpZ0NhbWVyYXMoKX1fZ2V0UmlnQ2FtUG9zaXRpb25BbmRUYXJnZXQoZSx0KXt0aGlzLmdldFRhcmdldCgpLnN1YnRyYWN0VG9SZWYodGhpcy5wb3NpdGlvbixHZS5fVGFyZ2V0Rm9jYWxQb2ludCksR2UuX1RhcmdldEZvY2FsUG9pbnQubm9ybWFsaXplKCkuc2NhbGVJblBsYWNlKHRoaXMuX2luaXRpYWxGb2NhbERpc3RhbmNlKTtjb25zdCBzPUdlLl9UYXJnZXRGb2NhbFBvaW50LmFkZEluUGxhY2UodGhpcy5wb3NpdGlvbik7eC5UcmFuc2xhdGlvblRvUmVmKC1zLngsLXMueSwtcy56LEdlLl9UYXJnZXRUcmFuc2Zvcm1NYXRyaXgpLEdlLl9UYXJnZXRUcmFuc2Zvcm1NYXRyaXgubXVsdGlwbHlUb1JlZih4LlJvdGF0aW9uQXhpcyh0LnVwVmVjdG9yLGUpLEdlLl9SaWdDYW1UcmFuc2Zvcm1NYXRyaXgpLHguVHJhbnNsYXRpb25Ub1JlZihzLngscy55LHMueixHZS5fVGFyZ2V0VHJhbnNmb3JtTWF0cml4KSxHZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4Lm11bHRpcGx5VG9SZWYoR2UuX1RhcmdldFRyYW5zZm9ybU1hdHJpeCxHZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4KSxwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYodGhpcy5wb3NpdGlvbixHZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4LHQucG9zaXRpb24pLHQuc2V0VGFyZ2V0KHMpfWdldENsYXNzTmFtZSgpe3JldHVybiJUYXJnZXRDYW1lcmEifX1HZS5fUmlnQ2FtVHJhbnNmb3JtTWF0cml4PW5ldyB4LEdlLl9UYXJnZXRUcmFuc2Zvcm1NYXRyaXg9bmV3IHgsR2UuX1RhcmdldEZvY2FsUG9pbnQ9bmV3IHAsVChbQnQoKV0sR2UucHJvdG90eXBlLCJyb3RhdGlvbiIsdm9pZCAwKSxUKFtSKCldLEdlLnByb3RvdHlwZSwic3BlZWQiLHZvaWQgMCksVChbTW4oImxvY2tlZFRhcmdldElkIildLEdlLnByb3RvdHlwZSwibG9ja2VkVGFyZ2V0Iix2b2lkIDApO2Z1bmN0aW9uIFluKGMpe2NvbnN0e3NjZW5lOmV9PWM7bGV0IHQ7Y29uc3QgaT0zNi41O3JldHVybiB0PW5ldyBHZSgiVGFyZ2V0Q2FtZXJhMSIsbmV3IHAoMCxpLDApLGUpLHQuZm92PS4yNSx0Lm1pblo9NSx0Lm1heFo9aSsxLHQuc2V0VGFyZ2V0KHAuWmVybygpKSx0fWNsYXNzIGhlIGV4dGVuZHMgemV7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQpLHRoaXMuZGlmZnVzZT1uZXcgcmUoMSwxLDEpLHRoaXMuc3BlY3VsYXI9bmV3IHJlKDEsMSwxKSx0aGlzLmZhbGxvZmZUeXBlPWhlLkZBTExPRkZfREVGQVVMVCx0aGlzLmludGVuc2l0eT0xLHRoaXMuX3JhbmdlPU51bWJlci5NQVhfVkFMVUUsdGhpcy5faW52ZXJzZVNxdWFyZWRSYW5nZT0wLHRoaXMuX3Bob3RvbWV0cmljU2NhbGU9MSx0aGlzLl9pbnRlbnNpdHlNb2RlPWhlLklOVEVOU0lUWU1PREVfQVVUT01BVElDLHRoaXMuX3JhZGl1cz0xZS01LHRoaXMucmVuZGVyUHJpb3JpdHk9MCx0aGlzLl9zaGFkb3dFbmFibGVkPSEwLHRoaXMuX2V4Y2x1ZGVXaXRoTGF5ZXJNYXNrPTAsdGhpcy5faW5jbHVkZU9ubHlXaXRoTGF5ZXJNYXNrPTAsdGhpcy5fbGlnaHRtYXBNb2RlPTAsdGhpcy5fc2hhZG93R2VuZXJhdG9ycz1udWxsLHRoaXMuX2V4Y2x1ZGVkTWVzaGVzSWRzPW5ldyBBcnJheSx0aGlzLl9pbmNsdWRlZE9ubHlNZXNoZXNJZHM9bmV3IEFycmF5LHRoaXMuX2lzTGlnaHQ9ITAsdGhpcy5nZXRTY2VuZSgpLmFkZExpZ2h0KHRoaXMpLHRoaXMuX3VuaWZvcm1CdWZmZXI9bmV3IFYodGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLHZvaWQgMCx2b2lkIDAsZSksdGhpcy5fYnVpbGRVbmlmb3JtTGF5b3V0KCksdGhpcy5pbmNsdWRlZE9ubHlNZXNoZXM9bmV3IEFycmF5LHRoaXMuZXhjbHVkZWRNZXNoZXM9bmV3IEFycmF5LHRoaXMuX3Jlc3luY01lc2hlcygpfWdldCByYW5nZSgpe3JldHVybiB0aGlzLl9yYW5nZX1zZXQgcmFuZ2UoZSl7dGhpcy5fcmFuZ2U9ZSx0aGlzLl9pbnZlcnNlU3F1YXJlZFJhbmdlPTEvKHRoaXMucmFuZ2UqdGhpcy5yYW5nZSl9Z2V0IGludGVuc2l0eU1vZGUoKXtyZXR1cm4gdGhpcy5faW50ZW5zaXR5TW9kZX1zZXQgaW50ZW5zaXR5TW9kZShlKXt0aGlzLl9pbnRlbnNpdHlNb2RlPWUsdGhpcy5fY29tcHV0ZVBob3RvbWV0cmljU2NhbGUoKX1nZXQgcmFkaXVzKCl7cmV0dXJuIHRoaXMuX3JhZGl1c31zZXQgcmFkaXVzKGUpe3RoaXMuX3JhZGl1cz1lLHRoaXMuX2NvbXB1dGVQaG90b21ldHJpY1NjYWxlKCl9Z2V0IHNoYWRvd0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5fc2hhZG93RW5hYmxlZH1zZXQgc2hhZG93RW5hYmxlZChlKXt0aGlzLl9zaGFkb3dFbmFibGVkIT09ZSYmKHRoaXMuX3NoYWRvd0VuYWJsZWQ9ZSx0aGlzLl9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCkpfWdldCBpbmNsdWRlZE9ubHlNZXNoZXMoKXtyZXR1cm4gdGhpcy5faW5jbHVkZWRPbmx5TWVzaGVzfXNldCBpbmNsdWRlZE9ubHlNZXNoZXMoZSl7dGhpcy5faW5jbHVkZWRPbmx5TWVzaGVzPWUsdGhpcy5faG9va0FycmF5Rm9ySW5jbHVkZWRPbmx5KGUpfWdldCBleGNsdWRlZE1lc2hlcygpe3JldHVybiB0aGlzLl9leGNsdWRlZE1lc2hlc31zZXQgZXhjbHVkZWRNZXNoZXMoZSl7dGhpcy5fZXhjbHVkZWRNZXNoZXM9ZSx0aGlzLl9ob29rQXJyYXlGb3JFeGNsdWRlZChlKX1nZXQgZXhjbHVkZVdpdGhMYXllck1hc2soKXtyZXR1cm4gdGhpcy5fZXhjbHVkZVdpdGhMYXllck1hc2t9c2V0IGV4Y2x1ZGVXaXRoTGF5ZXJNYXNrKGUpe3RoaXMuX2V4Y2x1ZGVXaXRoTGF5ZXJNYXNrPWUsdGhpcy5fcmVzeW5jTWVzaGVzKCl9Z2V0IGluY2x1ZGVPbmx5V2l0aExheWVyTWFzaygpe3JldHVybiB0aGlzLl9pbmNsdWRlT25seVdpdGhMYXllck1hc2t9c2V0IGluY2x1ZGVPbmx5V2l0aExheWVyTWFzayhlKXt0aGlzLl9pbmNsdWRlT25seVdpdGhMYXllck1hc2s9ZSx0aGlzLl9yZXN5bmNNZXNoZXMoKX1nZXQgbGlnaHRtYXBNb2RlKCl7cmV0dXJuIHRoaXMuX2xpZ2h0bWFwTW9kZX1zZXQgbGlnaHRtYXBNb2RlKGUpe3RoaXMuX2xpZ2h0bWFwTW9kZSE9PWUmJih0aGlzLl9saWdodG1hcE1vZGU9ZSx0aGlzLl9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCkpfXRyYW5zZmVyVGV4dHVyZXNUb0VmZmVjdChlLHQpe3JldHVybiB0aGlzfV9iaW5kTGlnaHQoZSx0LGkscyxyPSEwKXt2YXIgbjtjb25zdCBhPWUudG9TdHJpbmcoKTtsZXQgbz0hMTtpZih0aGlzLl91bmlmb3JtQnVmZmVyLmJpbmRUb0VmZmVjdChpLCJMaWdodCIrYSksdGhpcy5fcmVuZGVySWQhPT10LmdldFJlbmRlcklkKCl8fHRoaXMuX2xhc3RVc2VTcGVjdWxhciE9PXN8fCF0aGlzLl91bmlmb3JtQnVmZmVyLnVzZVVibyl7dGhpcy5fcmVuZGVySWQ9dC5nZXRSZW5kZXJJZCgpLHRoaXMuX2xhc3RVc2VTcGVjdWxhcj1zO2NvbnN0IGg9dGhpcy5nZXRTY2FsZWRJbnRlbnNpdHkoKTt0aGlzLnRyYW5zZmVyVG9FZmZlY3QoaSxhKSx0aGlzLmRpZmZ1c2Uuc2NhbGVUb1JlZihoLEVpLkNvbG9yM1swXSksdGhpcy5fdW5pZm9ybUJ1ZmZlci51cGRhdGVDb2xvcjQoInZMaWdodERpZmZ1c2UiLEVpLkNvbG9yM1swXSx0aGlzLnJhbmdlLGEpLHMmJih0aGlzLnNwZWN1bGFyLnNjYWxlVG9SZWYoaCxFaS5Db2xvcjNbMV0pLHRoaXMuX3VuaWZvcm1CdWZmZXIudXBkYXRlQ29sb3I0KCJ2TGlnaHRTcGVjdWxhciIsRWkuQ29sb3IzWzFdLHRoaXMucmFkaXVzLGEpKSxvPSEwfWlmKHRoaXMudHJhbnNmZXJUZXh0dXJlc1RvRWZmZWN0KGksYSksdC5zaGFkb3dzRW5hYmxlZCYmdGhpcy5zaGFkb3dFbmFibGVkJiZyKXtjb25zdCBoPShuPXRoaXMuZ2V0U2hhZG93R2VuZXJhdG9yKHQuYWN0aXZlQ2FtZXJhKSkhPT1udWxsJiZuIT09dm9pZCAwP246dGhpcy5nZXRTaGFkb3dHZW5lcmF0b3IoKTtoJiYoaC5iaW5kU2hhZG93TGlnaHQoYSxpKSxvPSEwKX1vP3RoaXMuX3VuaWZvcm1CdWZmZXIudXBkYXRlKCk6dGhpcy5fdW5pZm9ybUJ1ZmZlci5iaW5kVW5pZm9ybUJ1ZmZlcigpfWdldENsYXNzTmFtZSgpe3JldHVybiJMaWdodCJ9dG9TdHJpbmcoZSl7bGV0IHQ9Ik5hbWU6ICIrdGhpcy5uYW1lO2lmKHQrPSIsIHR5cGU6ICIrWyJQb2ludCIsIkRpcmVjdGlvbmFsIiwiU3BvdCIsIkhlbWlzcGhlcmljIl1bdGhpcy5nZXRUeXBlSUQoKV0sdGhpcy5hbmltYXRpb25zKWZvcihsZXQgaT0wO2k8dGhpcy5hbmltYXRpb25zLmxlbmd0aDtpKyspdCs9IiwgYW5pbWF0aW9uWzBdOiAiK3RoaXMuYW5pbWF0aW9uc1tpXS50b1N0cmluZyhlKTtyZXR1cm4gdH1fc3luY1BhcmVudEVuYWJsZWRTdGF0ZSgpe3N1cGVyLl9zeW5jUGFyZW50RW5hYmxlZFN0YXRlKCksdGhpcy5pc0Rpc3Bvc2VkKCl8fHRoaXMuX3Jlc3luY01lc2hlcygpfXNldEVuYWJsZWQoZSl7c3VwZXIuc2V0RW5hYmxlZChlKSx0aGlzLl9yZXN5bmNNZXNoZXMoKX1nZXRTaGFkb3dHZW5lcmF0b3IoZT1udWxsKXt2YXIgdDtyZXR1cm4gdGhpcy5fc2hhZG93R2VuZXJhdG9ycz09PW51bGw/bnVsbDoodD10aGlzLl9zaGFkb3dHZW5lcmF0b3JzLmdldChlKSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6bnVsbH1nZXRTaGFkb3dHZW5lcmF0b3JzKCl7cmV0dXJuIHRoaXMuX3NoYWRvd0dlbmVyYXRvcnN9Z2V0QWJzb2x1dGVQb3NpdGlvbigpe3JldHVybiBwLlplcm8oKX1jYW5BZmZlY3RNZXNoKGUpe3JldHVybiBlPyEodGhpcy5pbmNsdWRlZE9ubHlNZXNoZXMmJnRoaXMuaW5jbHVkZWRPbmx5TWVzaGVzLmxlbmd0aD4wJiZ0aGlzLmluY2x1ZGVkT25seU1lc2hlcy5pbmRleE9mKGUpPT09LTF8fHRoaXMuZXhjbHVkZWRNZXNoZXMmJnRoaXMuZXhjbHVkZWRNZXNoZXMubGVuZ3RoPjAmJnRoaXMuZXhjbHVkZWRNZXNoZXMuaW5kZXhPZihlKSE9PS0xfHx0aGlzLmluY2x1ZGVPbmx5V2l0aExheWVyTWFzayE9PTAmJiEodGhpcy5pbmNsdWRlT25seVdpdGhMYXllck1hc2smZS5sYXllck1hc2spfHx0aGlzLmV4Y2x1ZGVXaXRoTGF5ZXJNYXNrIT09MCYmdGhpcy5leGNsdWRlV2l0aExheWVyTWFzayZlLmxheWVyTWFzayk6ITB9ZGlzcG9zZShlLHQ9ITEpe2lmKHRoaXMuX3NoYWRvd0dlbmVyYXRvcnMpe2NvbnN0IGk9dGhpcy5fc2hhZG93R2VuZXJhdG9ycy52YWx1ZXMoKTtmb3IobGV0IHM9aS5uZXh0KCk7cy5kb25lIT09ITA7cz1pLm5leHQoKSlzLnZhbHVlLmRpc3Bvc2UoKTt0aGlzLl9zaGFkb3dHZW5lcmF0b3JzPW51bGx9aWYodGhpcy5nZXRTY2VuZSgpLnN0b3BBbmltYXRpb24odGhpcyksdGhpcy5fcGFyZW50Q29udGFpbmVyKXtjb25zdCBpPXRoaXMuX3BhcmVudENvbnRhaW5lci5saWdodHMuaW5kZXhPZih0aGlzKTtpPi0xJiZ0aGlzLl9wYXJlbnRDb250YWluZXIubGlnaHRzLnNwbGljZShpLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWZvcihjb25zdCBpIG9mIHRoaXMuZ2V0U2NlbmUoKS5tZXNoZXMpaS5fcmVtb3ZlTGlnaHRTb3VyY2UodGhpcywhMCk7dGhpcy5fdW5pZm9ybUJ1ZmZlci5kaXNwb3NlKCksdGhpcy5nZXRTY2VuZSgpLnJlbW92ZUxpZ2h0KHRoaXMpLHN1cGVyLmRpc3Bvc2UoZSx0KX1nZXRUeXBlSUQoKXtyZXR1cm4gMH1nZXRTY2FsZWRJbnRlbnNpdHkoKXtyZXR1cm4gdGhpcy5fcGhvdG9tZXRyaWNTY2FsZSp0aGlzLmludGVuc2l0eX1jbG9uZShlLHQ9bnVsbCl7Y29uc3QgaT1oZS5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKHRoaXMuZ2V0VHlwZUlEKCksZSx0aGlzLmdldFNjZW5lKCkpO2lmKCFpKXJldHVybiBudWxsO2NvbnN0IHM9YWUuQ2xvbmUoaSx0aGlzKTtyZXR1cm4gZSYmKHMubmFtZT1lKSx0JiYocy5wYXJlbnQ9dCkscy5zZXRFbmFibGVkKHRoaXMuaXNFbmFibGVkKCkpLHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhzKSxzfXNlcmlhbGl6ZSgpe2NvbnN0IGU9YWUuU2VyaWFsaXplKHRoaXMpO3JldHVybiBlLnVuaXF1ZUlkPXRoaXMudW5pcXVlSWQsZS50eXBlPXRoaXMuZ2V0VHlwZUlEKCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50Ll9zZXJpYWxpemVBc1BhcmVudChlKSx0aGlzLmV4Y2x1ZGVkTWVzaGVzLmxlbmd0aD4wJiYoZS5leGNsdWRlZE1lc2hlc0lkcz1bXSx0aGlzLmV4Y2x1ZGVkTWVzaGVzLmZvckVhY2godD0+e2UuZXhjbHVkZWRNZXNoZXNJZHMucHVzaCh0LmlkKX0pKSx0aGlzLmluY2x1ZGVkT25seU1lc2hlcy5sZW5ndGg+MCYmKGUuaW5jbHVkZWRPbmx5TWVzaGVzSWRzPVtdLHRoaXMuaW5jbHVkZWRPbmx5TWVzaGVzLmZvckVhY2godD0+e2UuaW5jbHVkZWRPbmx5TWVzaGVzSWRzLnB1c2godC5pZCl9KSksYWUuQXBwZW5kU2VyaWFsaXplZEFuaW1hdGlvbnModGhpcyxlKSxlLnJhbmdlcz10aGlzLnNlcmlhbGl6ZUFuaW1hdGlvblJhbmdlcygpLGUuaXNFbmFibGVkPXRoaXMuaXNFbmFibGVkKCksZX1zdGF0aWMgR2V0Q29uc3RydWN0b3JGcm9tTmFtZShlLHQsaSl7Y29uc3Qgcz16ZS5Db25zdHJ1Y3QoIkxpZ2h0X1R5cGVfIitlLHQsaSk7cmV0dXJuIHN8fG51bGx9c3RhdGljIFBhcnNlKGUsdCl7Y29uc3QgaT1oZS5HZXRDb25zdHJ1Y3RvckZyb21OYW1lKGUudHlwZSxlLm5hbWUsdCk7aWYoIWkpcmV0dXJuIG51bGw7Y29uc3Qgcz1hZS5QYXJzZShpLGUsdCk7aWYoZS5leGNsdWRlZE1lc2hlc0lkcyYmKHMuX2V4Y2x1ZGVkTWVzaGVzSWRzPWUuZXhjbHVkZWRNZXNoZXNJZHMpLGUuaW5jbHVkZWRPbmx5TWVzaGVzSWRzJiYocy5faW5jbHVkZWRPbmx5TWVzaGVzSWRzPWUuaW5jbHVkZWRPbmx5TWVzaGVzSWRzKSxlLnBhcmVudElkIT09dm9pZCAwJiYocy5fd2FpdGluZ1BhcmVudElkPWUucGFyZW50SWQpLGUucGFyZW50SW5zdGFuY2VJbmRleCE9PXZvaWQgMCYmKHMuX3dhaXRpbmdQYXJlbnRJbnN0YW5jZUluZGV4PWUucGFyZW50SW5zdGFuY2VJbmRleCksZS5mYWxsb2ZmVHlwZSE9PXZvaWQgMCYmKHMuZmFsbG9mZlR5cGU9ZS5mYWxsb2ZmVHlwZSksZS5saWdodG1hcE1vZGUhPT12b2lkIDAmJihzLmxpZ2h0bWFwTW9kZT1lLmxpZ2h0bWFwTW9kZSksZS5hbmltYXRpb25zKXtmb3IobGV0IHI9MDtyPGUuYW5pbWF0aW9ucy5sZW5ndGg7cisrKXtjb25zdCBuPWUuYW5pbWF0aW9uc1tyXSxhPXJpKCJCQUJZTE9OLkFuaW1hdGlvbiIpO2EmJnMuYW5pbWF0aW9ucy5wdXNoKGEuUGFyc2UobikpfXplLlBhcnNlQW5pbWF0aW9uUmFuZ2VzKHMsZSx0KX1yZXR1cm4gZS5hdXRvQW5pbWF0ZSYmdC5iZWdpbkFuaW1hdGlvbihzLGUuYXV0b0FuaW1hdGVGcm9tLGUuYXV0b0FuaW1hdGVUbyxlLmF1dG9BbmltYXRlTG9vcCxlLmF1dG9BbmltYXRlU3BlZWR8fDEpLGUuaXNFbmFibGVkIT09dm9pZCAwJiZzLnNldEVuYWJsZWQoZS5pc0VuYWJsZWQpLHN9X2hvb2tBcnJheUZvckV4Y2x1ZGVkKGUpe2NvbnN0IHQ9ZS5wdXNoO2UucHVzaD0oLi4ucyk9Pntjb25zdCByPXQuYXBwbHkoZSxzKTtmb3IoY29uc3QgbiBvZiBzKW4uX3Jlc3luY0xpZ2h0U291cmNlKHRoaXMpO3JldHVybiByfTtjb25zdCBpPWUuc3BsaWNlO2Uuc3BsaWNlPShzLHIpPT57Y29uc3Qgbj1pLmFwcGx5KGUsW3Mscl0pO2Zvcihjb25zdCBhIG9mIG4pYS5fcmVzeW5jTGlnaHRTb3VyY2UodGhpcyk7cmV0dXJuIG59O2Zvcihjb25zdCBzIG9mIGUpcy5fcmVzeW5jTGlnaHRTb3VyY2UodGhpcyl9X2hvb2tBcnJheUZvckluY2x1ZGVkT25seShlKXtjb25zdCB0PWUucHVzaDtlLnB1c2g9KC4uLnMpPT57Y29uc3Qgcj10LmFwcGx5KGUscyk7cmV0dXJuIHRoaXMuX3Jlc3luY01lc2hlcygpLHJ9O2NvbnN0IGk9ZS5zcGxpY2U7ZS5zcGxpY2U9KHMscik9Pntjb25zdCBuPWkuYXBwbHkoZSxbcyxyXSk7cmV0dXJuIHRoaXMuX3Jlc3luY01lc2hlcygpLG59LHRoaXMuX3Jlc3luY01lc2hlcygpfV9yZXN5bmNNZXNoZXMoKXtmb3IoY29uc3QgZSBvZiB0aGlzLmdldFNjZW5lKCkubWVzaGVzKWUuX3Jlc3luY0xpZ2h0U291cmNlKHRoaXMpfV9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5nZXRTY2VuZSgpLm1lc2hlcyllLmxpZ2h0U291cmNlcy5pbmRleE9mKHRoaXMpIT09LTEmJmUuX21hcmtTdWJNZXNoZXNBc0xpZ2h0RGlydHkoKX1fY29tcHV0ZVBob3RvbWV0cmljU2NhbGUoKXt0aGlzLl9waG90b21ldHJpY1NjYWxlPXRoaXMuX2dldFBob3RvbWV0cmljU2NhbGUoKSx0aGlzLmdldFNjZW5lKCkucmVzZXRDYWNoZWRNYXRlcmlhbCgpfV9nZXRQaG90b21ldHJpY1NjYWxlKCl7bGV0IGU9MDtjb25zdCB0PXRoaXMuZ2V0VHlwZUlEKCk7bGV0IGk9dGhpcy5pbnRlbnNpdHlNb2RlO3N3aXRjaChpPT09aGUuSU5URU5TSVRZTU9ERV9BVVRPTUFUSUMmJih0PT09aGUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD9pPWhlLklOVEVOU0lUWU1PREVfSUxMVU1JTkFOQ0U6aT1oZS5JTlRFTlNJVFlNT0RFX0xVTUlOT1VTSU5URU5TSVRZKSx0KXtjYXNlIGhlLkxJR0hUVFlQRUlEX1BPSU5UTElHSFQ6Y2FzZSBoZS5MSUdIVFRZUEVJRF9TUE9UTElHSFQ6c3dpdGNoKGkpe2Nhc2UgaGUuSU5URU5TSVRZTU9ERV9MVU1JTk9VU1BPV0VSOmU9MS8oNCpNYXRoLlBJKTticmVhaztjYXNlIGhlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNJTlRFTlNJVFk6ZT0xO2JyZWFrO2Nhc2UgaGUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0U6ZT10aGlzLnJhZGl1cyp0aGlzLnJhZGl1czticmVha31icmVhaztjYXNlIGhlLkxJR0hUVFlQRUlEX0RJUkVDVElPTkFMTElHSFQ6c3dpdGNoKGkpe2Nhc2UgaGUuSU5URU5TSVRZTU9ERV9JTExVTUlOQU5DRTplPTE7YnJlYWs7Y2FzZSBoZS5JTlRFTlNJVFlNT0RFX0xVTUlOQU5DRTp7bGV0IHM9dGhpcy5yYWRpdXM7cz1NYXRoLm1heChzLC4wMDEpLGU9MipNYXRoLlBJKigxLU1hdGguY29zKHMpKTticmVha319YnJlYWs7Y2FzZSBoZS5MSUdIVFRZUEVJRF9IRU1JU1BIRVJJQ0xJR0hUOmU9MTticmVha31yZXR1cm4gZX1fcmVvcmRlckxpZ2h0c0luU2NlbmUoKXtjb25zdCBlPXRoaXMuZ2V0U2NlbmUoKTt0aGlzLl9yZW5kZXJQcmlvcml0eSE9MCYmKGUucmVxdWlyZUxpZ2h0U29ydGluZz0hMCksdGhpcy5nZXRTY2VuZSgpLnNvcnRMaWdodHNCeVByaW9yaXR5KCl9fWhlLkZBTExPRkZfREVGQVVMVD1FZS5GQUxMT0ZGX0RFRkFVTFQsaGUuRkFMTE9GRl9QSFlTSUNBTD1FZS5GQUxMT0ZGX1BIWVNJQ0FMLGhlLkZBTExPRkZfR0xURj1FZS5GQUxMT0ZGX0dMVEYsaGUuRkFMTE9GRl9TVEFOREFSRD1FZS5GQUxMT0ZGX1NUQU5EQVJELGhlLkxJR0hUTUFQX0RFRkFVTFQ9RWUuTElHSFRNQVBfREVGQVVMVCxoZS5MSUdIVE1BUF9TUEVDVUxBUj1FZS5MSUdIVE1BUF9TUEVDVUxBUixoZS5MSUdIVE1BUF9TSEFET1dTT05MWT1FZS5MSUdIVE1BUF9TSEFET1dTT05MWSxoZS5JTlRFTlNJVFlNT0RFX0FVVE9NQVRJQz1FZS5JTlRFTlNJVFlNT0RFX0FVVE9NQVRJQyxoZS5JTlRFTlNJVFlNT0RFX0xVTUlOT1VTUE9XRVI9RWUuSU5URU5TSVRZTU9ERV9MVU1JTk9VU1BPV0VSLGhlLklOVEVOU0lUWU1PREVfTFVNSU5PVVNJTlRFTlNJVFk9RWUuSU5URU5TSVRZTU9ERV9MVU1JTk9VU0lOVEVOU0lUWSxoZS5JTlRFTlNJVFlNT0RFX0lMTFVNSU5BTkNFPUVlLklOVEVOU0lUWU1PREVfSUxMVU1JTkFOQ0UsaGUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0U9RWUuSU5URU5TSVRZTU9ERV9MVU1JTkFOQ0UsaGUuTElHSFRUWVBFSURfUE9JTlRMSUdIVD1FZS5MSUdIVFRZUEVJRF9QT0lOVExJR0hULGhlLkxJR0hUVFlQRUlEX0RJUkVDVElPTkFMTElHSFQ9RWUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVCxoZS5MSUdIVFRZUEVJRF9TUE9UTElHSFQ9RWUuTElHSFRUWVBFSURfU1BPVExJR0hULGhlLkxJR0hUVFlQRUlEX0hFTUlTUEhFUklDTElHSFQ9RWUuTElHSFRUWVBFSURfSEVNSVNQSEVSSUNMSUdIVCxUKFtjaSgpXSxoZS5wcm90b3R5cGUsImRpZmZ1c2UiLHZvaWQgMCksVChbY2koKV0saGUucHJvdG90eXBlLCJzcGVjdWxhciIsdm9pZCAwKSxUKFtSKCldLGhlLnByb3RvdHlwZSwiZmFsbG9mZlR5cGUiLHZvaWQgMCksVChbUigpXSxoZS5wcm90b3R5cGUsImludGVuc2l0eSIsdm9pZCAwKSxUKFtSKCldLGhlLnByb3RvdHlwZSwicmFuZ2UiLG51bGwpLFQoW1IoKV0saGUucHJvdG90eXBlLCJpbnRlbnNpdHlNb2RlIixudWxsKSxUKFtSKCldLGhlLnByb3RvdHlwZSwicmFkaXVzIixudWxsKSxUKFtSKCldLGhlLnByb3RvdHlwZSwiX3JlbmRlclByaW9yaXR5Iix2b2lkIDApLFQoW2JlKCJfcmVvcmRlckxpZ2h0c0luU2NlbmUiKV0saGUucHJvdG90eXBlLCJyZW5kZXJQcmlvcml0eSIsdm9pZCAwKSxUKFtSKCJzaGFkb3dFbmFibGVkIildLGhlLnByb3RvdHlwZSwiX3NoYWRvd0VuYWJsZWQiLHZvaWQgMCksVChbUigiZXhjbHVkZVdpdGhMYXllck1hc2siKV0saGUucHJvdG90eXBlLCJfZXhjbHVkZVdpdGhMYXllck1hc2siLHZvaWQgMCksVChbUigiaW5jbHVkZU9ubHlXaXRoTGF5ZXJNYXNrIildLGhlLnByb3RvdHlwZSwiX2luY2x1ZGVPbmx5V2l0aExheWVyTWFzayIsdm9pZCAwKSxUKFtSKCJsaWdodG1hcE1vZGUiKV0saGUucHJvdG90eXBlLCJfbGlnaHRtYXBNb2RlIix2b2lkIDApO2NsYXNzIFVpIGV4dGVuZHMgaGV7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMuX25lZWRQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZT0hMH1fc2V0UG9zaXRpb24oZSl7dGhpcy5fcG9zaXRpb249ZX1nZXQgcG9zaXRpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb259c2V0IHBvc2l0aW9uKGUpe3RoaXMuX3NldFBvc2l0aW9uKGUpfV9zZXREaXJlY3Rpb24oZSl7dGhpcy5fZGlyZWN0aW9uPWV9Z2V0IGRpcmVjdGlvbigpe3JldHVybiB0aGlzLl9kaXJlY3Rpb259c2V0IGRpcmVjdGlvbihlKXt0aGlzLl9zZXREaXJlY3Rpb24oZSl9Z2V0IHNoYWRvd01pblooKXtyZXR1cm4gdGhpcy5fc2hhZG93TWluWn1zZXQgc2hhZG93TWluWihlKXt0aGlzLl9zaGFkb3dNaW5aPWUsdGhpcy5mb3JjZVByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl9Z2V0IHNoYWRvd01heFooKXtyZXR1cm4gdGhpcy5fc2hhZG93TWF4Wn1zZXQgc2hhZG93TWF4WihlKXt0aGlzLl9zaGFkb3dNYXhaPWUsdGhpcy5mb3JjZVByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl9Y29tcHV0ZVRyYW5zZm9ybWVkSW5mb3JtYXRpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4Pyh0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb258fCh0aGlzLnRyYW5zZm9ybWVkUG9zaXRpb249cC5aZXJvKCkpLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLnBvc2l0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uKSx0aGlzLmRpcmVjdGlvbiYmKHRoaXMudHJhbnNmb3JtZWREaXJlY3Rpb258fCh0aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uPXAuWmVybygpKSxwLlRyYW5zZm9ybU5vcm1hbFRvUmVmKHRoaXMuZGlyZWN0aW9uLHRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4KCksdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbikpLCEwKTohMX1nZXREZXB0aFNjYWxlKCl7cmV0dXJuIDUwfWdldFNoYWRvd0RpcmVjdGlvbihlKXtyZXR1cm4gdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbj90aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uOnRoaXMuZGlyZWN0aW9ufWdldEFic29sdXRlUG9zaXRpb24oKXtyZXR1cm4gdGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uP3RoaXMudHJhbnNmb3JtZWRQb3NpdGlvbjp0aGlzLnBvc2l0aW9ufXNldERpcmVjdGlvblRvVGFyZ2V0KGUpe3JldHVybiB0aGlzLmRpcmVjdGlvbj1wLk5vcm1hbGl6ZShlLnN1YnRyYWN0KHRoaXMucG9zaXRpb24pKSx0aGlzLmRpcmVjdGlvbn1nZXRSb3RhdGlvbigpe3RoaXMuZGlyZWN0aW9uLm5vcm1hbGl6ZSgpO2NvbnN0IGU9cC5Dcm9zcyh0aGlzLmRpcmVjdGlvbixfaS5ZKSx0PXAuQ3Jvc3MoZSx0aGlzLmRpcmVjdGlvbik7cmV0dXJuIHAuUm90YXRpb25Gcm9tQXhpcyhlLHQsdGhpcy5kaXJlY3Rpb24pfW5lZWRDdWJlKCl7cmV0dXJuITF9bmVlZFByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl7cmV0dXJuIHRoaXMuX25lZWRQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZX1mb3JjZVByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl7dGhpcy5fbmVlZFByb2plY3Rpb25NYXRyaXhDb21wdXRlPSEwfV9pbml0Q2FjaGUoKXtzdXBlci5faW5pdENhY2hlKCksdGhpcy5fY2FjaGUucG9zaXRpb249cC5aZXJvKCl9X2lzU3luY2hyb25pemVkKCl7cmV0dXJuISF0aGlzLl9jYWNoZS5wb3NpdGlvbi5lcXVhbHModGhpcy5wb3NpdGlvbil9Y29tcHV0ZVdvcmxkTWF0cml4KGUpe3JldHVybiFlJiZ0aGlzLmlzU3luY2hyb25pemVkKCk/KHRoaXMuX2N1cnJlbnRSZW5kZXJJZD10aGlzLmdldFNjZW5lKCkuZ2V0UmVuZGVySWQoKSx0aGlzLl93b3JsZE1hdHJpeCk6KHRoaXMuX3VwZGF0ZUNhY2hlKCksdGhpcy5fY2FjaGUucG9zaXRpb24uY29weUZyb20odGhpcy5wb3NpdGlvbiksdGhpcy5fd29ybGRNYXRyaXh8fCh0aGlzLl93b3JsZE1hdHJpeD14LklkZW50aXR5KCkpLHguVHJhbnNsYXRpb25Ub1JlZih0aGlzLnBvc2l0aW9uLngsdGhpcy5wb3NpdGlvbi55LHRoaXMucG9zaXRpb24ueix0aGlzLl93b3JsZE1hdHJpeCksdGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmdldFdvcmxkTWF0cml4JiYodGhpcy5fd29ybGRNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLnBhcmVudC5nZXRXb3JsZE1hdHJpeCgpLHRoaXMuX3dvcmxkTWF0cml4KSx0aGlzLl9tYXJrU3luY2VkV2l0aFBhcmVudCgpKSx0aGlzLl93b3JsZE1hdHJpeERldGVybWluYW50SXNEaXJ0eT0hMCx0aGlzLl93b3JsZE1hdHJpeCl9Z2V0RGVwdGhNaW5aKGUpe3JldHVybiB0aGlzLnNoYWRvd01pblohPT12b2lkIDA/dGhpcy5zaGFkb3dNaW5aOmUubWluWn1nZXREZXB0aE1heFooZSl7cmV0dXJuIHRoaXMuc2hhZG93TWF4WiE9PXZvaWQgMD90aGlzLnNoYWRvd01heFo6ZS5tYXhafXNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSx0LGkpe3JldHVybiB0aGlzLmN1c3RvbVByb2plY3Rpb25NYXRyaXhCdWlsZGVyP3RoaXMuY3VzdG9tUHJvamVjdGlvbk1hdHJpeEJ1aWxkZXIodCxpLGUpOnRoaXMuX3NldERlZmF1bHRTaGFkb3dQcm9qZWN0aW9uTWF0cml4KGUsdCxpKSx0aGlzfV9zeW5jUGFyZW50RW5hYmxlZFN0YXRlKCl7c3VwZXIuX3N5bmNQYXJlbnRFbmFibGVkU3RhdGUoKSwoIXRoaXMucGFyZW50fHwhdGhpcy5wYXJlbnQuZ2V0V29ybGRNYXRyaXgpJiYodGhpcy50cmFuc2Zvcm1lZFBvc2l0aW9uPW51bGwsdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbj1udWxsKX19VChbQnQoKV0sVWkucHJvdG90eXBlLCJwb3NpdGlvbiIsbnVsbCksVChbQnQoKV0sVWkucHJvdG90eXBlLCJkaXJlY3Rpb24iLG51bGwpLFQoW1IoKV0sVWkucHJvdG90eXBlLCJzaGFkb3dNaW5aIixudWxsKSxUKFtSKCldLFVpLnByb3RvdHlwZSwic2hhZG93TWF4WiIsbnVsbCksemUuQWRkTm9kZUNvbnN0cnVjdG9yKCJMaWdodF9UeXBlXzEiLChjLGUpPT4oKT0+bmV3IEl0KGMscC5aZXJvKCksZSkpO2NsYXNzIEl0IGV4dGVuZHMgVWl7Y29uc3RydWN0b3IoZSx0LGkpe3N1cGVyKGUsaSksdGhpcy5fc2hhZG93RnJ1c3R1bVNpemU9MCx0aGlzLl9zaGFkb3dPcnRob1NjYWxlPS4xLHRoaXMuYXV0b1VwZGF0ZUV4dGVuZHM9ITAsdGhpcy5hdXRvQ2FsY1NoYWRvd1pCb3VuZHM9ITEsdGhpcy5fb3J0aG9MZWZ0PU51bWJlci5NQVhfVkFMVUUsdGhpcy5fb3J0aG9SaWdodD1OdW1iZXIuTUlOX1ZBTFVFLHRoaXMuX29ydGhvVG9wPU51bWJlci5NSU5fVkFMVUUsdGhpcy5fb3J0aG9Cb3R0b209TnVtYmVyLk1BWF9WQUxVRSx0aGlzLnBvc2l0aW9uPXQuc2NhbGUoLTEpLHRoaXMuZGlyZWN0aW9uPXR9Z2V0IHNoYWRvd0ZydXN0dW1TaXplKCl7cmV0dXJuIHRoaXMuX3NoYWRvd0ZydXN0dW1TaXplfXNldCBzaGFkb3dGcnVzdHVtU2l6ZShlKXt0aGlzLl9zaGFkb3dGcnVzdHVtU2l6ZT1lLHRoaXMuZm9yY2VQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZSgpfWdldCBzaGFkb3dPcnRob1NjYWxlKCl7cmV0dXJuIHRoaXMuX3NoYWRvd09ydGhvU2NhbGV9c2V0IHNoYWRvd09ydGhvU2NhbGUoZSl7dGhpcy5fc2hhZG93T3J0aG9TY2FsZT1lLHRoaXMuZm9yY2VQcm9qZWN0aW9uTWF0cml4Q29tcHV0ZSgpfWdldCBvcnRob0xlZnQoKXtyZXR1cm4gdGhpcy5fb3J0aG9MZWZ0fXNldCBvcnRob0xlZnQoZSl7dGhpcy5fb3J0aG9MZWZ0PWV9Z2V0IG9ydGhvUmlnaHQoKXtyZXR1cm4gdGhpcy5fb3J0aG9SaWdodH1zZXQgb3J0aG9SaWdodChlKXt0aGlzLl9vcnRob1JpZ2h0PWV9Z2V0IG9ydGhvVG9wKCl7cmV0dXJuIHRoaXMuX29ydGhvVG9wfXNldCBvcnRob1RvcChlKXt0aGlzLl9vcnRob1RvcD1lfWdldCBvcnRob0JvdHRvbSgpe3JldHVybiB0aGlzLl9vcnRob0JvdHRvbX1zZXQgb3J0aG9Cb3R0b20oZSl7dGhpcy5fb3J0aG9Cb3R0b209ZX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iRGlyZWN0aW9uYWxMaWdodCJ9Z2V0VHlwZUlEKCl7cmV0dXJuIGhlLkxJR0hUVFlQRUlEX0RJUkVDVElPTkFMTElHSFR9X3NldERlZmF1bHRTaGFkb3dQcm9qZWN0aW9uTWF0cml4KGUsdCxpKXt0aGlzLnNoYWRvd0ZydXN0dW1TaXplPjA/dGhpcy5fc2V0RGVmYXVsdEZpeGVkRnJ1c3R1bVNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSk6dGhpcy5fc2V0RGVmYXVsdEF1dG9FeHRlbmRTaGFkb3dQcm9qZWN0aW9uTWF0cml4KGUsdCxpKX1fc2V0RGVmYXVsdEZpeGVkRnJ1c3R1bVNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSl7Y29uc3QgdD10aGlzLmdldFNjZW5lKCkuYWN0aXZlQ2FtZXJhO3QmJnguT3J0aG9MSFRvUmVmKHRoaXMuc2hhZG93RnJ1c3R1bVNpemUsdGhpcy5zaGFkb3dGcnVzdHVtU2l6ZSx0aGlzLnNoYWRvd01pblohPT12b2lkIDA/dGhpcy5zaGFkb3dNaW5aOnQubWluWix0aGlzLnNoYWRvd01heFohPT12b2lkIDA/dGhpcy5zaGFkb3dNYXhaOnQubWF4WixlLHRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5pc05EQ0hhbGZaUmFuZ2UpfV9zZXREZWZhdWx0QXV0b0V4dGVuZFNoYWRvd1Byb2plY3Rpb25NYXRyaXgoZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpLmFjdGl2ZUNhbWVyYTtpZighcylyZXR1cm47aWYodGhpcy5hdXRvVXBkYXRlRXh0ZW5kc3x8dGhpcy5fb3J0aG9MZWZ0PT09TnVtYmVyLk1BWF9WQUxVRSl7Y29uc3QgbD1wLlplcm8oKTt0aGlzLl9vcnRob0xlZnQ9TnVtYmVyLk1BWF9WQUxVRSx0aGlzLl9vcnRob1JpZ2h0PU51bWJlci5NSU5fVkFMVUUsdGhpcy5fb3J0aG9Ub3A9TnVtYmVyLk1JTl9WQUxVRSx0aGlzLl9vcnRob0JvdHRvbT1OdW1iZXIuTUFYX1ZBTFVFO2xldCB1PU51bWJlci5NQVhfVkFMVUUsZD1OdW1iZXIuTUlOX1ZBTFVFO2ZvcihsZXQgZj0wO2Y8aS5sZW5ndGg7ZisrKXtjb25zdCBfPWlbZl07aWYoIV8pY29udGludWU7Y29uc3QgbT1fLmdldEJvdW5kaW5nSW5mbygpLmJvdW5kaW5nQm94O2ZvcihsZXQgdj0wO3Y8bS52ZWN0b3JzV29ybGQubGVuZ3RoO3YrKylwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYobS52ZWN0b3JzV29ybGRbdl0sdCxsKSxsLng8dGhpcy5fb3J0aG9MZWZ0JiYodGhpcy5fb3J0aG9MZWZ0PWwueCksbC55PHRoaXMuX29ydGhvQm90dG9tJiYodGhpcy5fb3J0aG9Cb3R0b209bC55KSxsLng+dGhpcy5fb3J0aG9SaWdodCYmKHRoaXMuX29ydGhvUmlnaHQ9bC54KSxsLnk+dGhpcy5fb3J0aG9Ub3AmJih0aGlzLl9vcnRob1RvcD1sLnkpLHRoaXMuYXV0b0NhbGNTaGFkb3daQm91bmRzJiYobC56PHUmJih1PWwueiksbC56PmQmJihkPWwueikpfXRoaXMuYXV0b0NhbGNTaGFkb3daQm91bmRzJiYodGhpcy5fc2hhZG93TWluWj11LHRoaXMuX3NoYWRvd01heFo9ZCl9Y29uc3Qgcj10aGlzLl9vcnRob1JpZ2h0LXRoaXMuX29ydGhvTGVmdCxuPXRoaXMuX29ydGhvVG9wLXRoaXMuX29ydGhvQm90dG9tLGE9dGhpcy5zaGFkb3dNaW5aIT09dm9pZCAwP3RoaXMuc2hhZG93TWluWjpzLm1pblosbz10aGlzLnNoYWRvd01heFohPT12b2lkIDA/dGhpcy5zaGFkb3dNYXhaOnMubWF4WixoPXRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS51c2VSZXZlcnNlRGVwdGhCdWZmZXI7eC5PcnRob09mZkNlbnRlckxIVG9SZWYodGhpcy5fb3J0aG9MZWZ0LXIqdGhpcy5zaGFkb3dPcnRob1NjYWxlLHRoaXMuX29ydGhvUmlnaHQrcip0aGlzLnNoYWRvd09ydGhvU2NhbGUsdGhpcy5fb3J0aG9Cb3R0b20tbip0aGlzLnNoYWRvd09ydGhvU2NhbGUsdGhpcy5fb3J0aG9Ub3Arbip0aGlzLnNoYWRvd09ydGhvU2NhbGUsaD9vOmEsaD9hOm8sZSx0aGlzLmdldFNjZW5lKCkuZ2V0RW5naW5lKCkuaXNORENIYWxmWlJhbmdlKX1fYnVpbGRVbmlmb3JtTGF5b3V0KCl7dGhpcy5fdW5pZm9ybUJ1ZmZlci5hZGRVbmlmb3JtKCJ2TGlnaHREYXRhIiw0KSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oInZMaWdodERpZmZ1c2UiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgidkxpZ2h0U3BlY3VsYXIiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgic2hhZG93c0luZm8iLDMpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgiZGVwdGhWYWx1ZXMiLDIpLHRoaXMuX3VuaWZvcm1CdWZmZXIuY3JlYXRlKCl9dHJhbnNmZXJUb0VmZmVjdChlLHQpe3JldHVybiB0aGlzLmNvbXB1dGVUcmFuc2Zvcm1lZEluZm9ybWF0aW9uKCk/KHRoaXMuX3VuaWZvcm1CdWZmZXIudXBkYXRlRmxvYXQ0KCJ2TGlnaHREYXRhIix0aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uLngsdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbi55LHRoaXMudHJhbnNmb3JtZWREaXJlY3Rpb24ueiwxLHQpLHRoaXMpOih0aGlzLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgidkxpZ2h0RGF0YSIsdGhpcy5kaXJlY3Rpb24ueCx0aGlzLmRpcmVjdGlvbi55LHRoaXMuZGlyZWN0aW9uLnosMSx0KSx0aGlzKX10cmFuc2ZlclRvTm9kZU1hdGVyaWFsRWZmZWN0KGUsdCl7cmV0dXJuIHRoaXMuY29tcHV0ZVRyYW5zZm9ybWVkSW5mb3JtYXRpb24oKT8oZS5zZXRGbG9hdDModCx0aGlzLnRyYW5zZm9ybWVkRGlyZWN0aW9uLngsdGhpcy50cmFuc2Zvcm1lZERpcmVjdGlvbi55LHRoaXMudHJhbnNmb3JtZWREaXJlY3Rpb24ueiksdGhpcyk6KGUuc2V0RmxvYXQzKHQsdGhpcy5kaXJlY3Rpb24ueCx0aGlzLmRpcmVjdGlvbi55LHRoaXMuZGlyZWN0aW9uLnopLHRoaXMpfWdldERlcHRoTWluWihlKXtjb25zdCB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3JldHVybiF0LnVzZVJldmVyc2VEZXB0aEJ1ZmZlciYmdC5pc05EQ0hhbGZaUmFuZ2U/MDoxfWdldERlcHRoTWF4WihlKXtjb25zdCB0PXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3JldHVybiB0LnVzZVJldmVyc2VEZXB0aEJ1ZmZlciYmdC5pc05EQ0hhbGZaUmFuZ2U/MDoxfXByZXBhcmVMaWdodFNwZWNpZmljRGVmaW5lcyhlLHQpe2VbIkRJUkxJR0hUIit0XT0hMH19VChbUigpXSxJdC5wcm90b3R5cGUsInNoYWRvd0ZydXN0dW1TaXplIixudWxsKSxUKFtSKCldLEl0LnByb3RvdHlwZSwic2hhZG93T3J0aG9TY2FsZSIsbnVsbCksVChbUigpXSxJdC5wcm90b3R5cGUsImF1dG9VcGRhdGVFeHRlbmRzIix2b2lkIDApLFQoW1IoKV0sSXQucHJvdG90eXBlLCJhdXRvQ2FsY1NoYWRvd1pCb3VuZHMiLHZvaWQgMCksVChbUigib3J0aG9MZWZ0IildLEl0LnByb3RvdHlwZSwiX29ydGhvTGVmdCIsdm9pZCAwKSxUKFtSKCJvcnRob1JpZ2h0IildLEl0LnByb3RvdHlwZSwiX29ydGhvUmlnaHQiLHZvaWQgMCksVChbUigib3J0aG9Ub3AiKV0sSXQucHJvdG90eXBlLCJfb3J0aG9Ub3AiLHZvaWQgMCksVChbUigib3J0aG9Cb3R0b20iKV0sSXQucHJvdG90eXBlLCJfb3J0aG9Cb3R0b20iLHZvaWQgMCksemUuQWRkTm9kZUNvbnN0cnVjdG9yKCJMaWdodF9UeXBlXzMiLChjLGUpPT4oKT0+bmV3IG5zKGMscC5aZXJvKCksZSkpO2NsYXNzIG5zIGV4dGVuZHMgaGV7Y29uc3RydWN0b3IoZSx0LGkpe3N1cGVyKGUsaSksdGhpcy5ncm91bmRDb2xvcj1uZXcgcmUoMCwwLDApLHRoaXMuZGlyZWN0aW9uPXR8fHAuVXAoKX1fYnVpbGRVbmlmb3JtTGF5b3V0KCl7dGhpcy5fdW5pZm9ybUJ1ZmZlci5hZGRVbmlmb3JtKCJ2TGlnaHREYXRhIiw0KSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oInZMaWdodERpZmZ1c2UiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgidkxpZ2h0U3BlY3VsYXIiLDQpLHRoaXMuX3VuaWZvcm1CdWZmZXIuYWRkVW5pZm9ybSgidkxpZ2h0R3JvdW5kIiwzKSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oInNoYWRvd3NJbmZvIiwzKSx0aGlzLl91bmlmb3JtQnVmZmVyLmFkZFVuaWZvcm0oImRlcHRoVmFsdWVzIiwyKSx0aGlzLl91bmlmb3JtQnVmZmVyLmNyZWF0ZSgpfWdldENsYXNzTmFtZSgpe3JldHVybiJIZW1pc3BoZXJpY0xpZ2h0In1zZXREaXJlY3Rpb25Ub1RhcmdldChlKXtyZXR1cm4gdGhpcy5kaXJlY3Rpb249cC5Ob3JtYWxpemUoZS5zdWJ0cmFjdChwLlplcm8oKSkpLHRoaXMuZGlyZWN0aW9ufWdldFNoYWRvd0dlbmVyYXRvcigpe3JldHVybiBudWxsfXRyYW5zZmVyVG9FZmZlY3QoZSx0KXtjb25zdCBpPXAuTm9ybWFsaXplKHRoaXMuZGlyZWN0aW9uKTtyZXR1cm4gdGhpcy5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInZMaWdodERhdGEiLGkueCxpLnksaS56LDAsdCksdGhpcy5fdW5pZm9ybUJ1ZmZlci51cGRhdGVDb2xvcjMoInZMaWdodEdyb3VuZCIsdGhpcy5ncm91bmRDb2xvci5zY2FsZSh0aGlzLmludGVuc2l0eSksdCksdGhpc310cmFuc2ZlclRvTm9kZU1hdGVyaWFsRWZmZWN0KGUsdCl7Y29uc3QgaT1wLk5vcm1hbGl6ZSh0aGlzLmRpcmVjdGlvbik7cmV0dXJuIGUuc2V0RmxvYXQzKHQsaS54LGkueSxpLnopLHRoaXN9Y29tcHV0ZVdvcmxkTWF0cml4KCl7cmV0dXJuIHRoaXMuX3dvcmxkTWF0cml4fHwodGhpcy5fd29ybGRNYXRyaXg9eC5JZGVudGl0eSgpKSx0aGlzLl93b3JsZE1hdHJpeH1nZXRUeXBlSUQoKXtyZXR1cm4gaGUuTElHSFRUWVBFSURfSEVNSVNQSEVSSUNMSUdIVH1wcmVwYXJlTGlnaHRTcGVjaWZpY0RlZmluZXMoZSx0KXtlWyJIRU1JTElHSFQiK3RdPSEwfX1UKFtjaSgpXSxucy5wcm90b3R5cGUsImdyb3VuZENvbG9yIix2b2lkIDApLFQoW0J0KCldLG5zLnByb3RvdHlwZSwiZGlyZWN0aW9uIix2b2lkIDApO2NsYXNzIEd0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PXR9dG9TdHJpbmcoKXtyZXR1cm5ge1c6ICR7dGhpcy53aWR0aH0sIEg6ICR7dGhpcy5oZWlnaHR9fWB9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlNpemUifWdldEhhc2hDb2RlKCl7bGV0IGU9dGhpcy53aWR0aHwwO3JldHVybiBlPWUqMzk3Xih0aGlzLmhlaWdodHwwKSxlfWNvcHlGcm9tKGUpe3RoaXMud2lkdGg9ZS53aWR0aCx0aGlzLmhlaWdodD1lLmhlaWdodH1jb3B5RnJvbUZsb2F0cyhlLHQpe3JldHVybiB0aGlzLndpZHRoPWUsdGhpcy5oZWlnaHQ9dCx0aGlzfXNldChlLHQpe3JldHVybiB0aGlzLmNvcHlGcm9tRmxvYXRzKGUsdCl9bXVsdGlwbHlCeUZsb2F0cyhlLHQpe3JldHVybiBuZXcgR3QodGhpcy53aWR0aCplLHRoaXMuaGVpZ2h0KnQpfWNsb25lKCl7cmV0dXJuIG5ldyBHdCh0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KX1lcXVhbHMoZSl7cmV0dXJuIGU/dGhpcy53aWR0aD09PWUud2lkdGgmJnRoaXMuaGVpZ2h0PT09ZS5oZWlnaHQ6ITF9Z2V0IHN1cmZhY2UoKXtyZXR1cm4gdGhpcy53aWR0aCp0aGlzLmhlaWdodH1zdGF0aWMgWmVybygpe3JldHVybiBuZXcgR3QoMCwwKX1hZGQoZSl7cmV0dXJuIG5ldyBHdCh0aGlzLndpZHRoK2Uud2lkdGgsdGhpcy5oZWlnaHQrZS5oZWlnaHQpfXN1YnRyYWN0KGUpe3JldHVybiBuZXcgR3QodGhpcy53aWR0aC1lLndpZHRoLHRoaXMuaGVpZ2h0LWUuaGVpZ2h0KX1zdGF0aWMgTGVycChlLHQsaSl7Y29uc3Qgcz1lLndpZHRoKyh0LndpZHRoLWUud2lkdGgpKmkscj1lLmhlaWdodCsodC5oZWlnaHQtZS5oZWlnaHQpKmk7cmV0dXJuIG5ldyBHdChzLHIpfX1jbGFzcyBabntjb25zdHJ1Y3RvcihlKXt0aGlzLl93cmFwVT0xLHRoaXMuX3dyYXBWPTEsdGhpcy53cmFwUj0xLHRoaXMuYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD00LHRoaXMuZGVsYXlMb2FkU3RhdGU9MCx0aGlzLl90ZXh0dXJlPW51bGwsdGhpcy5fZW5naW5lPW51bGwsdGhpcy5fY2FjaGVkU2l6ZT1HdC5aZXJvKCksdGhpcy5fY2FjaGVkQmFzZVNpemU9R3QuWmVybygpLHRoaXMuX2luaXRpYWxTYW1wbGluZ01vZGU9Mix0aGlzLl90ZXh0dXJlPWUsdGhpcy5fdGV4dHVyZSYmKHRoaXMuX2VuZ2luZT10aGlzLl90ZXh0dXJlLmdldEVuZ2luZSgpKX1nZXQgd3JhcFUoKXtyZXR1cm4gdGhpcy5fd3JhcFV9c2V0IHdyYXBVKGUpe3RoaXMuX3dyYXBVPWV9Z2V0IHdyYXBWKCl7cmV0dXJuIHRoaXMuX3dyYXBWfXNldCB3cmFwVihlKXt0aGlzLl93cmFwVj1lfWdldCBjb29yZGluYXRlc01vZGUoKXtyZXR1cm4gMH1nZXQgaXNDdWJlKCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5pc0N1YmU6ITF9c2V0IGlzQ3ViZShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5pc0N1YmU9ZSl9Z2V0IGlzM0QoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLmlzM0Q6ITF9c2V0IGlzM0QoZSl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuaXMzRD1lKX1nZXQgaXMyREFycmF5KCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5pczJEQXJyYXk6ITF9c2V0IGlzMkRBcnJheShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5pczJEQXJyYXk9ZSl9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIlRoaW5UZXh0dXJlIn1pc1JlYWR5KCl7cmV0dXJuIHRoaXMuZGVsYXlMb2FkU3RhdGU9PT00Pyh0aGlzLmRlbGF5TG9hZCgpLCExKTp0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuaXNSZWFkeTohMX1kZWxheUxvYWQoKXt9Z2V0SW50ZXJuYWxUZXh0dXJlKCl7cmV0dXJuIHRoaXMuX3RleHR1cmV9Z2V0U2l6ZSgpe2lmKHRoaXMuX3RleHR1cmUpe2lmKHRoaXMuX3RleHR1cmUud2lkdGgpcmV0dXJuIHRoaXMuX2NhY2hlZFNpemUud2lkdGg9dGhpcy5fdGV4dHVyZS53aWR0aCx0aGlzLl9jYWNoZWRTaXplLmhlaWdodD10aGlzLl90ZXh0dXJlLmhlaWdodCx0aGlzLl9jYWNoZWRTaXplO2lmKHRoaXMuX3RleHR1cmUuX3NpemUpcmV0dXJuIHRoaXMuX2NhY2hlZFNpemUud2lkdGg9dGhpcy5fdGV4dHVyZS5fc2l6ZSx0aGlzLl9jYWNoZWRTaXplLmhlaWdodD10aGlzLl90ZXh0dXJlLl9zaXplLHRoaXMuX2NhY2hlZFNpemV9cmV0dXJuIHRoaXMuX2NhY2hlZFNpemV9Z2V0QmFzZVNpemUoKXtyZXR1cm4hdGhpcy5pc1JlYWR5KCl8fCF0aGlzLl90ZXh0dXJlPyh0aGlzLl9jYWNoZWRCYXNlU2l6ZS53aWR0aD0wLHRoaXMuX2NhY2hlZEJhc2VTaXplLmhlaWdodD0wLHRoaXMuX2NhY2hlZEJhc2VTaXplKTp0aGlzLl90ZXh0dXJlLl9zaXplPyh0aGlzLl9jYWNoZWRCYXNlU2l6ZS53aWR0aD10aGlzLl90ZXh0dXJlLl9zaXplLHRoaXMuX2NhY2hlZEJhc2VTaXplLmhlaWdodD10aGlzLl90ZXh0dXJlLl9zaXplLHRoaXMuX2NhY2hlZEJhc2VTaXplKToodGhpcy5fY2FjaGVkQmFzZVNpemUud2lkdGg9dGhpcy5fdGV4dHVyZS5iYXNlV2lkdGgsdGhpcy5fY2FjaGVkQmFzZVNpemUuaGVpZ2h0PXRoaXMuX3RleHR1cmUuYmFzZUhlaWdodCx0aGlzLl9jYWNoZWRCYXNlU2l6ZSl9Z2V0IHNhbXBsaW5nTW9kZSgpe3JldHVybiB0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuc2FtcGxpbmdNb2RlOnRoaXMuX2luaXRpYWxTYW1wbGluZ01vZGV9dXBkYXRlU2FtcGxpbmdNb2RlKGUpe3RoaXMuX3RleHR1cmUmJnRoaXMuX2VuZ2luZSYmdGhpcy5fZW5naW5lLnVwZGF0ZVRleHR1cmVTYW1wbGluZ01vZGUoZSx0aGlzLl90ZXh0dXJlKX1yZWxlYXNlSW50ZXJuYWxUZXh0dXJlKCl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuZGlzcG9zZSgpLHRoaXMuX3RleHR1cmU9bnVsbCl9ZGlzcG9zZSgpe3RoaXMuX3RleHR1cmUmJih0aGlzLnJlbGVhc2VJbnRlcm5hbFRleHR1cmUoKSx0aGlzLl9lbmdpbmU9bnVsbCl9fWNsYXNzIFJlIGV4dGVuZHMgWm57Y29uc3RydWN0b3IoZSx0PW51bGwpe3N1cGVyKG51bGwpLHRoaXMubWV0YWRhdGE9bnVsbCx0aGlzLnJlc2VydmVkRGF0YVN0b3JlPW51bGwsdGhpcy5faGFzQWxwaGE9ITEsdGhpcy5fZ2V0QWxwaGFGcm9tUkdCPSExLHRoaXMubGV2ZWw9MSx0aGlzLl9jb29yZGluYXRlc0luZGV4PTAsdGhpcy5vcHRpbWl6ZVVWQWxsb2NhdGlvbj0hMCx0aGlzLl9jb29yZGluYXRlc01vZGU9MCx0aGlzLndyYXBSPTEsdGhpcy5hbmlzb3Ryb3BpY0ZpbHRlcmluZ0xldmVsPVJlLkRFRkFVTFRfQU5JU09UUk9QSUNfRklMVEVSSU5HX0xFVkVMLHRoaXMuX2lzQ3ViZT0hMSx0aGlzLl9nYW1tYVNwYWNlPSEwLHRoaXMuaW52ZXJ0Wj0hMSx0aGlzLmxvZExldmVsSW5BbHBoYT0hMSx0aGlzLmlzUmVuZGVyVGFyZ2V0PSExLHRoaXMuX3ByZWZpbHRlcmVkPSExLHRoaXMuX2ZvcmNlU2VyaWFsaXplPSExLHRoaXMuYW5pbWF0aW9ucz1uZXcgQXJyYXksdGhpcy5vbkRpc3Bvc2VPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPW51bGwsdGhpcy5fc2NlbmU9bnVsbCx0aGlzLl91aWQ9bnVsbCx0aGlzLl9wYXJlbnRDb250YWluZXI9bnVsbCx0aGlzLl9sb2FkaW5nRXJyb3I9ITEsZT9SZS5fSXNTY2VuZShlKT90aGlzLl9zY2VuZT1lOnRoaXMuX2VuZ2luZT1lOnRoaXMuX3NjZW5lPWZlLkxhc3RDcmVhdGVkU2NlbmUsdGhpcy5fc2NlbmUmJih0aGlzLnVuaXF1ZUlkPXRoaXMuX3NjZW5lLmdldFVuaXF1ZUlkKCksdGhpcy5fc2NlbmUuYWRkVGV4dHVyZSh0aGlzKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkpLHRoaXMuX3RleHR1cmU9dCx0aGlzLl91aWQ9bnVsbH1zZXQgaGFzQWxwaGEoZSl7dGhpcy5faGFzQWxwaGEhPT1lJiYodGhpcy5faGFzQWxwaGE9ZSx0aGlzLl9zY2VuZSYmdGhpcy5fc2NlbmUubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSx0PT50Lmhhc1RleHR1cmUodGhpcykpKX1nZXQgaGFzQWxwaGEoKXtyZXR1cm4gdGhpcy5faGFzQWxwaGF9c2V0IGdldEFscGhhRnJvbVJHQihlKXt0aGlzLl9nZXRBbHBoYUZyb21SR0IhPT1lJiYodGhpcy5fZ2V0QWxwaGFGcm9tUkdCPWUsdGhpcy5fc2NlbmUmJnRoaXMuX3NjZW5lLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEsdD0+dC5oYXNUZXh0dXJlKHRoaXMpKSl9Z2V0IGdldEFscGhhRnJvbVJHQigpe3JldHVybiB0aGlzLl9nZXRBbHBoYUZyb21SR0J9c2V0IGNvb3JkaW5hdGVzSW5kZXgoZSl7dGhpcy5fY29vcmRpbmF0ZXNJbmRleCE9PWUmJih0aGlzLl9jb29yZGluYXRlc0luZGV4PWUsdGhpcy5fc2NlbmUmJnRoaXMuX3NjZW5lLm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEsdD0+dC5oYXNUZXh0dXJlKHRoaXMpKSl9Z2V0IGNvb3JkaW5hdGVzSW5kZXgoKXtyZXR1cm4gdGhpcy5fY29vcmRpbmF0ZXNJbmRleH1zZXQgY29vcmRpbmF0ZXNNb2RlKGUpe3RoaXMuX2Nvb3JkaW5hdGVzTW9kZSE9PWUmJih0aGlzLl9jb29yZGluYXRlc01vZGU9ZSx0aGlzLl9zY2VuZSYmdGhpcy5fc2NlbmUubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSx0PT50Lmhhc1RleHR1cmUodGhpcykpKX1nZXQgY29vcmRpbmF0ZXNNb2RlKCl7cmV0dXJuIHRoaXMuX2Nvb3JkaW5hdGVzTW9kZX1nZXQgd3JhcFUoKXtyZXR1cm4gdGhpcy5fd3JhcFV9c2V0IHdyYXBVKGUpe3RoaXMuX3dyYXBVPWV9Z2V0IHdyYXBWKCl7cmV0dXJuIHRoaXMuX3dyYXBWfXNldCB3cmFwVihlKXt0aGlzLl93cmFwVj1lfWdldCBpc0N1YmUoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLmlzQ3ViZTp0aGlzLl9pc0N1YmV9c2V0IGlzQ3ViZShlKXt0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuaXNDdWJlPWU6dGhpcy5faXNDdWJlPWV9Z2V0IGlzM0QoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLmlzM0Q6ITF9c2V0IGlzM0QoZSl7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuaXMzRD1lKX1nZXQgaXMyREFycmF5KCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5pczJEQXJyYXk6ITF9c2V0IGlzMkRBcnJheShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5pczJEQXJyYXk9ZSl9Z2V0IGdhbW1hU3BhY2UoKXtpZih0aGlzLl90ZXh0dXJlKXRoaXMuX3RleHR1cmUuX2dhbW1hU3BhY2U9PT1udWxsJiYodGhpcy5fdGV4dHVyZS5fZ2FtbWFTcGFjZT10aGlzLl9nYW1tYVNwYWNlKTtlbHNlIHJldHVybiB0aGlzLl9nYW1tYVNwYWNlO3JldHVybiB0aGlzLl90ZXh0dXJlLl9nYW1tYVNwYWNlJiYhdGhpcy5fdGV4dHVyZS5fdXNlU1JHQkJ1ZmZlcn1zZXQgZ2FtbWFTcGFjZShlKXtpZih0aGlzLl90ZXh0dXJlKXtpZih0aGlzLl90ZXh0dXJlLl9nYW1tYVNwYWNlPT09ZSlyZXR1cm47dGhpcy5fdGV4dHVyZS5fZ2FtbWFTcGFjZT1lfWVsc2V7aWYodGhpcy5fZ2FtbWFTcGFjZT09PWUpcmV0dXJuO3RoaXMuX2dhbW1hU3BhY2U9ZX10aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5KCl9Z2V0IGlzUkdCRCgpe3JldHVybiB0aGlzLl90ZXh0dXJlIT1udWxsJiZ0aGlzLl90ZXh0dXJlLl9pc1JHQkR9c2V0IGlzUkdCRChlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5faXNSR0JEPWUpfWdldCBub01pcG1hcCgpe3JldHVybiExfWdldCBsb2RHZW5lcmF0aW9uT2Zmc2V0KCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5fbG9kR2VuZXJhdGlvbk9mZnNldDowfXNldCBsb2RHZW5lcmF0aW9uT2Zmc2V0KGUpe3RoaXMuX3RleHR1cmUmJih0aGlzLl90ZXh0dXJlLl9sb2RHZW5lcmF0aW9uT2Zmc2V0PWUpfWdldCBsb2RHZW5lcmF0aW9uU2NhbGUoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9sb2RHZW5lcmF0aW9uU2NhbGU6MH1zZXQgbG9kR2VuZXJhdGlvblNjYWxlKGUpe3RoaXMuX3RleHR1cmUmJih0aGlzLl90ZXh0dXJlLl9sb2RHZW5lcmF0aW9uU2NhbGU9ZSl9Z2V0IGxpbmVhclNwZWN1bGFyTE9EKCl7cmV0dXJuIHRoaXMuX3RleHR1cmU/dGhpcy5fdGV4dHVyZS5fbGluZWFyU3BlY3VsYXJMT0Q6ITF9c2V0IGxpbmVhclNwZWN1bGFyTE9EKGUpe3RoaXMuX3RleHR1cmUmJih0aGlzLl90ZXh0dXJlLl9saW5lYXJTcGVjdWxhckxPRD1lKX1nZXQgaXJyYWRpYW5jZVRleHR1cmUoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9pcnJhZGlhbmNlVGV4dHVyZTpudWxsfXNldCBpcnJhZGlhbmNlVGV4dHVyZShlKXt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5faXJyYWRpYW5jZVRleHR1cmU9ZSl9Z2V0IHVpZCgpe3JldHVybiB0aGlzLl91aWR8fCh0aGlzLl91aWQ9bHIoKSksdGhpcy5fdWlkfXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMubmFtZX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQmFzZVRleHR1cmUifXNldCBvbkRpc3Bvc2UoZSl7dGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXImJnRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25EaXNwb3NlT2JzZXJ2ZXIpLHRoaXMuX29uRGlzcG9zZU9ic2VydmVyPXRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5hZGQoZSl9Z2V0IGlzQmxvY2tpbmcoKXtyZXR1cm4hMH1nZXQgbG9hZGluZ0Vycm9yKCl7cmV0dXJuIHRoaXMuX2xvYWRpbmdFcnJvcn1nZXQgZXJyb3JPYmplY3QoKXtyZXR1cm4gdGhpcy5fZXJyb3JPYmplY3R9Z2V0U2NlbmUoKXtyZXR1cm4gdGhpcy5fc2NlbmV9X2dldEVuZ2luZSgpe3JldHVybiB0aGlzLl9lbmdpbmV9Y2hlY2tUcmFuc2Zvcm1zQXJlSWRlbnRpY2FsKGUpe3JldHVybiBlIT09bnVsbH1nZXRUZXh0dXJlTWF0cml4KCl7cmV0dXJuIHguSWRlbnRpdHlSZWFkT25seX1nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpe3JldHVybiB4LklkZW50aXR5UmVhZE9ubHl9aXNSZWFkeU9yTm90QmxvY2tpbmcoKXtyZXR1cm4hdGhpcy5pc0Jsb2NraW5nfHx0aGlzLmlzUmVhZHkoKXx8dGhpcy5sb2FkaW5nRXJyb3J9c2NhbGUoZSl7fWdldCBjYW5SZXNjYWxlKCl7cmV0dXJuITF9X2dldEZyb21DYWNoZShlLHQsaSxzLHIsbil7Y29uc3QgYT10aGlzLl9nZXRFbmdpbmUoKTtpZighYSlyZXR1cm4gbnVsbDtjb25zdCBvPWEuX2dldFVzZVNSR0JCdWZmZXIoISFyLHQpLGg9YS5nZXRMb2FkZWRUZXh0dXJlc0NhY2hlKCk7Zm9yKGxldCBsPTA7bDxoLmxlbmd0aDtsKyspe2NvbnN0IHU9aFtsXTtpZigocj09PXZvaWQgMHx8bz09PXUuX3VzZVNSR0JCdWZmZXIpJiYocz09PXZvaWQgMHx8cz09PXUuaW52ZXJ0WSkmJnUudXJsPT09ZSYmdS5nZW5lcmF0ZU1pcE1hcHM9PT0hdCYmKCFpfHxpPT09dS5zYW1wbGluZ01vZGUpJiYobj09PXZvaWQgMHx8bj09PXUuaXNDdWJlKSlyZXR1cm4gdS5pbmNyZW1lbnRSZWZlcmVuY2VzKCksdX1yZXR1cm4gbnVsbH1fcmVidWlsZCgpe31jbG9uZSgpe3JldHVybiBudWxsfWdldCB0ZXh0dXJlVHlwZSgpe3JldHVybiB0aGlzLl90ZXh0dXJlJiZ0aGlzLl90ZXh0dXJlLnR5cGUhPT12b2lkIDA/dGhpcy5fdGV4dHVyZS50eXBlOjB9Z2V0IHRleHR1cmVGb3JtYXQoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZSYmdGhpcy5fdGV4dHVyZS5mb3JtYXQhPT12b2lkIDA/dGhpcy5fdGV4dHVyZS5mb3JtYXQ6NX1fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpe2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpO2UmJmUubWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSl9cmVhZFBpeGVscyhlPTAsdD0wLGk9bnVsbCxzPSEwLHI9ITEsbj0wLGE9MCxvPU51bWJlci5NQVhfVkFMVUUsaD1OdW1iZXIuTUFYX1ZBTFVFKXtpZighdGhpcy5fdGV4dHVyZSlyZXR1cm4gbnVsbDtjb25zdCBsPXRoaXMuX2dldEVuZ2luZSgpO2lmKCFsKXJldHVybiBudWxsO2NvbnN0IHU9dGhpcy5nZXRTaXplKCk7bGV0IGQ9dS53aWR0aCxmPXUuaGVpZ2h0O3QhPT0wJiYoZD1kL01hdGgucG93KDIsdCksZj1mL01hdGgucG93KDIsdCksZD1NYXRoLnJvdW5kKGQpLGY9TWF0aC5yb3VuZChmKSksbz1NYXRoLm1pbihkLG8pLGg9TWF0aC5taW4oZixoKTt0cnl7cmV0dXJuIHRoaXMuX3RleHR1cmUuaXNDdWJlP2wuX3JlYWRUZXh0dXJlUGl4ZWxzKHRoaXMuX3RleHR1cmUsbyxoLGUsdCxpLHMscixuLGEpOmwuX3JlYWRUZXh0dXJlUGl4ZWxzKHRoaXMuX3RleHR1cmUsbyxoLC0xLHQsaSxzLHIsbixhKX1jYXRjaHtyZXR1cm4gbnVsbH19X3JlYWRQaXhlbHNTeW5jKGU9MCx0PTAsaT1udWxsLHM9ITAscj0hMSl7aWYoIXRoaXMuX3RleHR1cmUpcmV0dXJuIG51bGw7Y29uc3Qgbj10aGlzLmdldFNpemUoKTtsZXQgYT1uLndpZHRoLG89bi5oZWlnaHQ7Y29uc3QgaD10aGlzLl9nZXRFbmdpbmUoKTtpZighaClyZXR1cm4gbnVsbDt0IT0wJiYoYT1hL01hdGgucG93KDIsdCksbz1vL01hdGgucG93KDIsdCksYT1NYXRoLnJvdW5kKGEpLG89TWF0aC5yb3VuZChvKSk7dHJ5e3JldHVybiB0aGlzLl90ZXh0dXJlLmlzQ3ViZT9oLl9yZWFkVGV4dHVyZVBpeGVsc1N5bmModGhpcy5fdGV4dHVyZSxhLG8sZSx0LGkscyxyKTpoLl9yZWFkVGV4dHVyZVBpeGVsc1N5bmModGhpcy5fdGV4dHVyZSxhLG8sLTEsdCxpLHMscil9Y2F0Y2h7cmV0dXJuIG51bGx9fWdldCBfbG9kVGV4dHVyZUhpZ2goKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9sb2RUZXh0dXJlSGlnaDpudWxsfWdldCBfbG9kVGV4dHVyZU1pZCgpe3JldHVybiB0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuX2xvZFRleHR1cmVNaWQ6bnVsbH1nZXQgX2xvZFRleHR1cmVMb3coKXtyZXR1cm4gdGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLl9sb2RUZXh0dXJlTG93Om51bGx9ZGlzcG9zZSgpe2lmKHRoaXMuX3NjZW5lKXt0aGlzLl9zY2VuZS5zdG9wQW5pbWF0aW9uJiZ0aGlzLl9zY2VuZS5zdG9wQW5pbWF0aW9uKHRoaXMpLHRoaXMuX3NjZW5lLnJlbW92ZVBlbmRpbmdEYXRhKHRoaXMpO2NvbnN0IGU9dGhpcy5fc2NlbmUudGV4dHVyZXMuaW5kZXhPZih0aGlzKTtpZihlPj0wJiZ0aGlzLl9zY2VuZS50ZXh0dXJlcy5zcGxpY2UoZSwxKSx0aGlzLl9zY2VuZS5vblRleHR1cmVSZW1vdmVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyksdGhpcy5fc2NlbmU9bnVsbCx0aGlzLl9wYXJlbnRDb250YWluZXIpe2NvbnN0IHQ9dGhpcy5fcGFyZW50Q29udGFpbmVyLnRleHR1cmVzLmluZGV4T2YodGhpcyk7dD4tMSYmdGhpcy5fcGFyZW50Q29udGFpbmVyLnRleHR1cmVzLnNwbGljZSh0LDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfX10aGlzLm9uRGlzcG9zZU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHRoaXMpLHRoaXMub25EaXNwb3NlT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMubWV0YWRhdGE9bnVsbCxzdXBlci5kaXNwb3NlKCl9c2VyaWFsaXplKGU9ITEpe2lmKCF0aGlzLm5hbWUmJiFlKXJldHVybiBudWxsO2NvbnN0IHQ9YWUuU2VyaWFsaXplKHRoaXMpO3JldHVybiBhZS5BcHBlbmRTZXJpYWxpemVkQW5pbWF0aW9ucyh0aGlzLHQpLHR9c3RhdGljIFdoZW5BbGxSZWFkeShlLHQpe2xldCBpPWUubGVuZ3RoO2lmKGk9PT0wKXt0KCk7cmV0dXJufWZvcihsZXQgcz0wO3M8ZS5sZW5ndGg7cysrKXtjb25zdCByPWVbc107aWYoci5pc1JlYWR5KCkpLS1pPT09MCYmdCgpO2Vsc2V7Y29uc3Qgbj1yLm9uTG9hZE9ic2VydmFibGU7bj9uLmFkZE9uY2UoKCk9PnstLWk9PT0wJiZ0KCl9KTotLWk9PT0wJiZ0KCl9fX1zdGF0aWMgX0lzU2NlbmUoZSl7cmV0dXJuIGUuZ2V0Q2xhc3NOYW1lKCk9PT0iU2NlbmUifX1SZS5ERUZBVUxUX0FOSVNPVFJPUElDX0ZJTFRFUklOR19MRVZFTD00LFQoW1IoKV0sUmUucHJvdG90eXBlLCJ1bmlxdWVJZCIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibmFtZSIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibWV0YWRhdGEiLHZvaWQgMCksVChbUigiaGFzQWxwaGEiKV0sUmUucHJvdG90eXBlLCJfaGFzQWxwaGEiLHZvaWQgMCksVChbUigiZ2V0QWxwaGFGcm9tUkdCIildLFJlLnByb3RvdHlwZSwiX2dldEFscGhhRnJvbVJHQiIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibGV2ZWwiLHZvaWQgMCksVChbUigiY29vcmRpbmF0ZXNJbmRleCIpXSxSZS5wcm90b3R5cGUsIl9jb29yZGluYXRlc0luZGV4Iix2b2lkIDApLFQoW1IoKV0sUmUucHJvdG90eXBlLCJvcHRpbWl6ZVVWQWxsb2NhdGlvbiIsdm9pZCAwKSxUKFtSKCJjb29yZGluYXRlc01vZGUiKV0sUmUucHJvdG90eXBlLCJfY29vcmRpbmF0ZXNNb2RlIix2b2lkIDApLFQoW1IoKV0sUmUucHJvdG90eXBlLCJ3cmFwVSIsbnVsbCksVChbUigpXSxSZS5wcm90b3R5cGUsIndyYXBWIixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwid3JhcFIiLHZvaWQgMCksVChbUigpXSxSZS5wcm90b3R5cGUsImFuaXNvdHJvcGljRmlsdGVyaW5nTGV2ZWwiLHZvaWQgMCksVChbUigpXSxSZS5wcm90b3R5cGUsImlzQ3ViZSIsbnVsbCksVChbUigpXSxSZS5wcm90b3R5cGUsImlzM0QiLG51bGwpLFQoW1IoKV0sUmUucHJvdG90eXBlLCJpczJEQXJyYXkiLG51bGwpLFQoW1IoKV0sUmUucHJvdG90eXBlLCJnYW1tYVNwYWNlIixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwiaW52ZXJ0WiIsdm9pZCAwKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibG9kTGV2ZWxJbkFscGhhIix2b2lkIDApLFQoW1IoKV0sUmUucHJvdG90eXBlLCJsb2RHZW5lcmF0aW9uT2Zmc2V0IixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibG9kR2VuZXJhdGlvblNjYWxlIixudWxsKSxUKFtSKCldLFJlLnByb3RvdHlwZSwibGluZWFyU3BlY3VsYXJMT0QiLG51bGwpLFQoW210KCldLFJlLnByb3RvdHlwZSwiaXJyYWRpYW5jZVRleHR1cmUiLG51bGwpLFQoW1IoKV0sUmUucHJvdG90eXBlLCJpc1JlbmRlclRhcmdldCIsdm9pZCAwKTtmdW5jdGlvbiBGcihjLGUsdD0hMSl7Y29uc3QgaT1lLndpZHRoLHM9ZS5oZWlnaHQ7aWYoYyBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSl7bGV0IGg9Yy5ieXRlTGVuZ3RoL2MuQllURVNfUEVSX0VMRU1FTlQ7Y29uc3QgbD1uZXcgVWludDhBcnJheShoKTtmb3IoOy0taD49MDspe2xldCB1PWNbaF07dTwwP3U9MDp1PjEmJih1PTEpLGxbaF09dSoyNTV9Yz1sfWNvbnN0IHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7ci53aWR0aD1pLHIuaGVpZ2h0PXM7Y29uc3Qgbj1yLmdldENvbnRleHQoIjJkIik7aWYoIW4pcmV0dXJuIG51bGw7Y29uc3QgYT1uLmNyZWF0ZUltYWdlRGF0YShpLHMpO2lmKGEuZGF0YS5zZXQoYyksbi5wdXRJbWFnZURhdGEoYSwwLDApLHQpe2NvbnN0IGg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7aC53aWR0aD1pLGguaGVpZ2h0PXM7Y29uc3QgbD1oLmdldENvbnRleHQoIjJkIik7cmV0dXJuIGw/KGwudHJhbnNsYXRlKDAscyksbC5zY2FsZSgxLC0xKSxsLmRyYXdJbWFnZShyLDAsMCksaC50b0RhdGFVUkwoImltYWdlL3BuZyIpKTpudWxsfXJldHVybiByLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIil9ZnVuY3Rpb24gcW4oYyxlPTAsdD0wKXtjb25zdCBpPWMuZ2V0SW50ZXJuYWxUZXh0dXJlKCk7aWYoIWkpcmV0dXJuIG51bGw7Y29uc3Qgcz1jLl9yZWFkUGl4ZWxzU3luYyhlLHQpO3JldHVybiBzP0ZyKHMsYy5nZXRTaXplKCksaS5pbnZlcnRZKTpudWxsfWFzeW5jIGZ1bmN0aW9uIGpuKGMsZT0wLHQ9MCl7Y29uc3QgaT1jLmdldEludGVybmFsVGV4dHVyZSgpO2lmKCFpKXJldHVybiBudWxsO2NvbnN0IHM9YXdhaXQgYy5yZWFkUGl4ZWxzKGUsdCk7cmV0dXJuIHM/RnIocyxjLmdldFNpemUoKSxpLmludmVydFkpOm51bGx9Y2xhc3MgTiBleHRlbmRzIFJle2NvbnN0cnVjdG9yKGUsdCxpLHMscj1OLlRSSUxJTkVBUl9TQU1QTElOR01PREUsbj1udWxsLGE9bnVsbCxvPW51bGwsaD0hMSxsLHUsZCxmLF8pe3ZhciBFLG0sdixTLHksQSxDLGIsTTtzdXBlcih0KSx0aGlzLnVybD1udWxsLHRoaXMudU9mZnNldD0wLHRoaXMudk9mZnNldD0wLHRoaXMudVNjYWxlPTEsdGhpcy52U2NhbGU9MSx0aGlzLnVBbmc9MCx0aGlzLnZBbmc9MCx0aGlzLndBbmc9MCx0aGlzLnVSb3RhdGlvbkNlbnRlcj0uNSx0aGlzLnZSb3RhdGlvbkNlbnRlcj0uNSx0aGlzLndSb3RhdGlvbkNlbnRlcj0uNSx0aGlzLmhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPSExLHRoaXMuaW5zcGVjdGFibGVDdXN0b21Qcm9wZXJ0aWVzPW51bGwsdGhpcy5fbm9NaXBtYXA9ITEsdGhpcy5faW52ZXJ0WT0hMSx0aGlzLl9yb3dHZW5lcmF0aW9uTWF0cml4PW51bGwsdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeD1udWxsLHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4PW51bGwsdGhpcy5fdDA9bnVsbCx0aGlzLl90MT1udWxsLHRoaXMuX3QyPW51bGwsdGhpcy5fY2FjaGVkVU9mZnNldD0tMSx0aGlzLl9jYWNoZWRWT2Zmc2V0PS0xLHRoaXMuX2NhY2hlZFVTY2FsZT0wLHRoaXMuX2NhY2hlZFZTY2FsZT0wLHRoaXMuX2NhY2hlZFVBbmc9LTEsdGhpcy5fY2FjaGVkVkFuZz0tMSx0aGlzLl9jYWNoZWRXQW5nPS0xLHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25Qcm9qZWN0aW9uTWF0cml4SWQ9LTEsdGhpcy5fY2FjaGVkVVJvdGF0aW9uQ2VudGVyPS0xLHRoaXMuX2NhY2hlZFZSb3RhdGlvbkNlbnRlcj0tMSx0aGlzLl9jYWNoZWRXUm90YXRpb25DZW50ZXI9LTEsdGhpcy5fY2FjaGVkSG9tb2dlbmVvdXNSb3RhdGlvbkluVVZUcmFuc2Zvcm09ITEsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXg9bnVsbCx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVU9mZnNldD0tMSx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVk9mZnNldD0tMSx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVVNjYWxlPTAsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblZTY2FsZT0wLHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25Db29yZGluYXRlc01vZGU9LTEsdGhpcy5fYnVmZmVyPW51bGwsdGhpcy5fZGVsZXRlQnVmZmVyPSExLHRoaXMuX2Zvcm1hdD1udWxsLHRoaXMuX2RlbGF5ZWRPbkxvYWQ9bnVsbCx0aGlzLl9kZWxheWVkT25FcnJvcj1udWxsLHRoaXMub25Mb2FkT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9pc0Jsb2NraW5nPSEwLHRoaXMubmFtZT1lfHwiIix0aGlzLnVybD1lO2xldCBMLGs9ITEsdz1udWxsO3R5cGVvZiBpPT0ib2JqZWN0IiYmaSE9PW51bGw/KEw9KEU9aS5ub01pcG1hcCkhPT1udWxsJiZFIT09dm9pZCAwP0U6ITEscz0obT1pLmludmVydFkpIT09bnVsbCYmbSE9PXZvaWQgMD9tOiFmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWLHI9KHY9aS5zYW1wbGluZ01vZGUpIT09bnVsbCYmdiE9PXZvaWQgMD92Ok4uVFJJTElORUFSX1NBTVBMSU5HTU9ERSxuPShTPWkub25Mb2FkKSE9PW51bGwmJlMhPT12b2lkIDA/UzpudWxsLGE9KHk9aS5vbkVycm9yKSE9PW51bGwmJnkhPT12b2lkIDA/eTpudWxsLG89KEE9aS5idWZmZXIpIT09bnVsbCYmQSE9PXZvaWQgMD9BOm51bGwsaD0oQz1pLmRlbGV0ZUJ1ZmZlcikhPT1udWxsJiZDIT09dm9pZCAwP0M6ITEsbD1pLmZvcm1hdCx1PWkubWltZVR5cGUsZD1pLmxvYWRlck9wdGlvbnMsZj1pLmNyZWF0aW9uRmxhZ3Msaz0oYj1pLnVzZVNSR0JCdWZmZXIpIT09bnVsbCYmYiE9PXZvaWQgMD9iOiExLHc9KE09aS5pbnRlcm5hbFRleHR1cmUpIT09bnVsbCYmTSE9PXZvaWQgMD9NOm51bGwpOkw9ISFpLHRoaXMuX25vTWlwbWFwPUwsdGhpcy5faW52ZXJ0WT1zPT09dm9pZCAwPyFmdC5Vc2VPcGVuR0xPcmllbnRhdGlvbkZvclVWOnMsdGhpcy5faW5pdGlhbFNhbXBsaW5nTW9kZT1yLHRoaXMuX2J1ZmZlcj1vLHRoaXMuX2RlbGV0ZUJ1ZmZlcj1oLHRoaXMuX21pbWVUeXBlPXUsdGhpcy5fbG9hZGVyT3B0aW9ucz1kLHRoaXMuX2NyZWF0aW9uRmxhZ3M9Zix0aGlzLl91c2VTUkdCQnVmZmVyPWssdGhpcy5fZm9yY2VkRXh0ZW5zaW9uPV8sbCYmKHRoaXMuX2Zvcm1hdD1sKTtjb25zdCBkZT10aGlzLmdldFNjZW5lKCksY2U9dGhpcy5fZ2V0RW5naW5lKCk7aWYoIWNlKXJldHVybjtjZS5vbkJlZm9yZVRleHR1cmVJbml0T2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyk7Y29uc3Qgc2U9KCk9Pnt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5faW52ZXJ0VlNjYWxlJiYodGhpcy52U2NhbGUqPS0xLHRoaXMudk9mZnNldCs9MSksdGhpcy5fdGV4dHVyZS5fY2FjaGVkV3JhcFUhPT1udWxsJiYodGhpcy53cmFwVT10aGlzLl90ZXh0dXJlLl9jYWNoZWRXcmFwVSx0aGlzLl90ZXh0dXJlLl9jYWNoZWRXcmFwVT1udWxsKSx0aGlzLl90ZXh0dXJlLl9jYWNoZWRXcmFwViE9PW51bGwmJih0aGlzLndyYXBWPXRoaXMuX3RleHR1cmUuX2NhY2hlZFdyYXBWLHRoaXMuX3RleHR1cmUuX2NhY2hlZFdyYXBWPW51bGwpLHRoaXMuX3RleHR1cmUuX2NhY2hlZFdyYXBSIT09bnVsbCYmKHRoaXMud3JhcFI9dGhpcy5fdGV4dHVyZS5fY2FjaGVkV3JhcFIsdGhpcy5fdGV4dHVyZS5fY2FjaGVkV3JhcFI9bnVsbCkpLHRoaXMub25Mb2FkT2JzZXJ2YWJsZS5oYXNPYnNlcnZlcnMoKSYmdGhpcy5vbkxvYWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSxuJiZuKCksIXRoaXMuaXNCbG9ja2luZyYmZGUmJmRlLnJlc2V0Q2FjaGVkTWF0ZXJpYWwoKX0sdGU9KEZlLHdlKT0+e3RoaXMuX2xvYWRpbmdFcnJvcj0hMCx0aGlzLl9lcnJvck9iamVjdD17bWVzc2FnZTpGZSxleGNlcHRpb246d2V9LGEmJmEoRmUsd2UpLE4uT25UZXh0dXJlTG9hZEVycm9yT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9O2lmKCF0aGlzLnVybCYmIXcpe3RoaXMuX2RlbGF5ZWRPbkxvYWQ9c2UsdGhpcy5fZGVsYXllZE9uRXJyb3I9dGU7cmV0dXJufWlmKHRoaXMuX3RleHR1cmU9dz8/dGhpcy5fZ2V0RnJvbUNhY2hlKHRoaXMudXJsLEwscix0aGlzLl9pbnZlcnRZLGspLHRoaXMuX3RleHR1cmUpaWYodGhpcy5fdGV4dHVyZS5pc1JlYWR5KVhpLlNldEltbWVkaWF0ZSgoKT0+c2UoKSk7ZWxzZXtjb25zdCBGZT10aGlzLl90ZXh0dXJlLm9uTG9hZGVkT2JzZXJ2YWJsZS5hZGQoc2UpO3RoaXMuX3RleHR1cmUub25FcnJvck9ic2VydmFibGUuYWRkKHdlPT57dmFyIEhlO3RlKHdlLm1lc3NhZ2Usd2UuZXhjZXB0aW9uKSwoSGU9dGhpcy5fdGV4dHVyZSk9PT1udWxsfHxIZT09PXZvaWQgMHx8SGUub25Mb2FkZWRPYnNlcnZhYmxlLnJlbW92ZShGZSl9KX1lbHNlIGlmKCFkZXx8IWRlLnVzZURlbGF5ZWRUZXh0dXJlTG9hZGluZyl7dHJ5e3RoaXMuX3RleHR1cmU9Y2UuY3JlYXRlVGV4dHVyZSh0aGlzLnVybCxMLHRoaXMuX2ludmVydFksZGUscixzZSx0ZSx0aGlzLl9idWZmZXIsdm9pZCAwLHRoaXMuX2Zvcm1hdCx0aGlzLl9mb3JjZWRFeHRlbnNpb24sdSxkLGYsayl9Y2F0Y2goRmUpe3Rocm93IHRlKCJlcnJvciBsb2FkaW5nIixGZSksRmV9aCYmKHRoaXMuX2J1ZmZlcj1udWxsKX1lbHNlIHRoaXMuZGVsYXlMb2FkU3RhdGU9NCx0aGlzLl9kZWxheWVkT25Mb2FkPXNlLHRoaXMuX2RlbGF5ZWRPbkVycm9yPXRlfWdldCBub01pcG1hcCgpe3JldHVybiB0aGlzLl9ub01pcG1hcH1nZXQgbWltZVR5cGUoKXtyZXR1cm4gdGhpcy5fbWltZVR5cGV9c2V0IGlzQmxvY2tpbmcoZSl7dGhpcy5faXNCbG9ja2luZz1lfWdldCBpc0Jsb2NraW5nKCl7cmV0dXJuIHRoaXMuX2lzQmxvY2tpbmd9Z2V0IGludmVydFkoKXtyZXR1cm4gdGhpcy5faW52ZXJ0WX11cGRhdGVVUkwoZSx0PW51bGwsaSxzKXt0aGlzLnVybCYmKHRoaXMucmVsZWFzZUludGVybmFsVGV4dHVyZSgpLHRoaXMuZ2V0U2NlbmUoKS5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSksKCF0aGlzLm5hbWV8fHRoaXMubmFtZS5zdGFydHNXaXRoKCJkYXRhOiIpKSYmKHRoaXMubmFtZT1lKSx0aGlzLnVybD1lLHRoaXMuX2J1ZmZlcj10LHRoaXMuX2ZvcmNlZEV4dGVuc2lvbj1zLHRoaXMuZGVsYXlMb2FkU3RhdGU9NCxpJiYodGhpcy5fZGVsYXllZE9uTG9hZD1pKSx0aGlzLmRlbGF5TG9hZCgpfWRlbGF5TG9hZCgpe2lmKHRoaXMuZGVsYXlMb2FkU3RhdGUhPT00KXJldHVybjtjb25zdCBlPXRoaXMuZ2V0U2NlbmUoKTtlJiYodGhpcy5kZWxheUxvYWRTdGF0ZT0xLHRoaXMuX3RleHR1cmU9dGhpcy5fZ2V0RnJvbUNhY2hlKHRoaXMudXJsLHRoaXMuX25vTWlwbWFwLHRoaXMuc2FtcGxpbmdNb2RlLHRoaXMuX2ludmVydFksdGhpcy5fdXNlU1JHQkJ1ZmZlciksdGhpcy5fdGV4dHVyZT90aGlzLl9kZWxheWVkT25Mb2FkJiYodGhpcy5fdGV4dHVyZS5pc1JlYWR5P1hpLlNldEltbWVkaWF0ZSh0aGlzLl9kZWxheWVkT25Mb2FkKTp0aGlzLl90ZXh0dXJlLm9uTG9hZGVkT2JzZXJ2YWJsZS5hZGQodGhpcy5fZGVsYXllZE9uTG9hZCkpOih0aGlzLl90ZXh0dXJlPWUuZ2V0RW5naW5lKCkuY3JlYXRlVGV4dHVyZSh0aGlzLnVybCx0aGlzLl9ub01pcG1hcCx0aGlzLl9pbnZlcnRZLGUsdGhpcy5zYW1wbGluZ01vZGUsdGhpcy5fZGVsYXllZE9uTG9hZCx0aGlzLl9kZWxheWVkT25FcnJvcix0aGlzLl9idWZmZXIsbnVsbCx0aGlzLl9mb3JtYXQsdGhpcy5fZm9yY2VkRXh0ZW5zaW9uLHRoaXMuX21pbWVUeXBlLHRoaXMuX2xvYWRlck9wdGlvbnMsdGhpcy5fY3JlYXRpb25GbGFncyx0aGlzLl91c2VTUkdCQnVmZmVyKSx0aGlzLl9kZWxldGVCdWZmZXImJih0aGlzLl9idWZmZXI9bnVsbCkpLHRoaXMuX2RlbGF5ZWRPbkxvYWQ9bnVsbCx0aGlzLl9kZWxheWVkT25FcnJvcj1udWxsKX1fcHJlcGFyZVJvd0ZvclRleHR1cmVHZW5lcmF0aW9uKGUsdCxpLHMpe2UqPXRoaXMuX2NhY2hlZFVTY2FsZSx0Kj10aGlzLl9jYWNoZWRWU2NhbGUsZS09dGhpcy51Um90YXRpb25DZW50ZXIqdGhpcy5fY2FjaGVkVVNjYWxlLHQtPXRoaXMudlJvdGF0aW9uQ2VudGVyKnRoaXMuX2NhY2hlZFZTY2FsZSxpLT10aGlzLndSb3RhdGlvbkNlbnRlcixwLlRyYW5zZm9ybUNvb3JkaW5hdGVzRnJvbUZsb2F0c1RvUmVmKGUsdCxpLHRoaXMuX3Jvd0dlbmVyYXRpb25NYXRyaXgscykscy54Kz10aGlzLnVSb3RhdGlvbkNlbnRlcip0aGlzLl9jYWNoZWRVU2NhbGUrdGhpcy5fY2FjaGVkVU9mZnNldCxzLnkrPXRoaXMudlJvdGF0aW9uQ2VudGVyKnRoaXMuX2NhY2hlZFZTY2FsZSt0aGlzLl9jYWNoZWRWT2Zmc2V0LHMueis9dGhpcy53Um90YXRpb25DZW50ZXJ9Y2hlY2tUcmFuc2Zvcm1zQXJlSWRlbnRpY2FsKGUpe3JldHVybiBlIT09bnVsbCYmdGhpcy51T2Zmc2V0PT09ZS51T2Zmc2V0JiZ0aGlzLnZPZmZzZXQ9PT1lLnZPZmZzZXQmJnRoaXMudVNjYWxlPT09ZS51U2NhbGUmJnRoaXMudlNjYWxlPT09ZS52U2NhbGUmJnRoaXMudUFuZz09PWUudUFuZyYmdGhpcy52QW5nPT09ZS52QW5nJiZ0aGlzLndBbmc9PT1lLndBbmd9Z2V0VGV4dHVyZU1hdHJpeChlPTEpe2lmKHRoaXMudU9mZnNldD09PXRoaXMuX2NhY2hlZFVPZmZzZXQmJnRoaXMudk9mZnNldD09PXRoaXMuX2NhY2hlZFZPZmZzZXQmJnRoaXMudVNjYWxlKmU9PT10aGlzLl9jYWNoZWRVU2NhbGUmJnRoaXMudlNjYWxlPT09dGhpcy5fY2FjaGVkVlNjYWxlJiZ0aGlzLnVBbmc9PT10aGlzLl9jYWNoZWRVQW5nJiZ0aGlzLnZBbmc9PT10aGlzLl9jYWNoZWRWQW5nJiZ0aGlzLndBbmc9PT10aGlzLl9jYWNoZWRXQW5nJiZ0aGlzLnVSb3RhdGlvbkNlbnRlcj09PXRoaXMuX2NhY2hlZFVSb3RhdGlvbkNlbnRlciYmdGhpcy52Um90YXRpb25DZW50ZXI9PT10aGlzLl9jYWNoZWRWUm90YXRpb25DZW50ZXImJnRoaXMud1JvdGF0aW9uQ2VudGVyPT09dGhpcy5fY2FjaGVkV1JvdGF0aW9uQ2VudGVyJiZ0aGlzLmhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPT09dGhpcy5fY2FjaGVkSG9tb2dlbmVvdXNSb3RhdGlvbkluVVZUcmFuc2Zvcm0pcmV0dXJuIHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXg7dGhpcy5fY2FjaGVkVU9mZnNldD10aGlzLnVPZmZzZXQsdGhpcy5fY2FjaGVkVk9mZnNldD10aGlzLnZPZmZzZXQsdGhpcy5fY2FjaGVkVVNjYWxlPXRoaXMudVNjYWxlKmUsdGhpcy5fY2FjaGVkVlNjYWxlPXRoaXMudlNjYWxlLHRoaXMuX2NhY2hlZFVBbmc9dGhpcy51QW5nLHRoaXMuX2NhY2hlZFZBbmc9dGhpcy52QW5nLHRoaXMuX2NhY2hlZFdBbmc9dGhpcy53QW5nLHRoaXMuX2NhY2hlZFVSb3RhdGlvbkNlbnRlcj10aGlzLnVSb3RhdGlvbkNlbnRlcix0aGlzLl9jYWNoZWRWUm90YXRpb25DZW50ZXI9dGhpcy52Um90YXRpb25DZW50ZXIsdGhpcy5fY2FjaGVkV1JvdGF0aW9uQ2VudGVyPXRoaXMud1JvdGF0aW9uQ2VudGVyLHRoaXMuX2NhY2hlZEhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPXRoaXMuaG9tb2dlbmVvdXNSb3RhdGlvbkluVVZUcmFuc2Zvcm0sKCF0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4fHwhdGhpcy5fcm93R2VuZXJhdGlvbk1hdHJpeCkmJih0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4PXguWmVybygpLHRoaXMuX3Jvd0dlbmVyYXRpb25NYXRyaXg9bmV3IHgsdGhpcy5fdDA9cC5aZXJvKCksdGhpcy5fdDE9cC5aZXJvKCksdGhpcy5fdDI9cC5aZXJvKCkpLHguUm90YXRpb25ZYXdQaXRjaFJvbGxUb1JlZih0aGlzLnZBbmcsdGhpcy51QW5nLHRoaXMud0FuZyx0aGlzLl9yb3dHZW5lcmF0aW9uTWF0cml4KSx0aGlzLmhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtPyh4LlRyYW5zbGF0aW9uVG9SZWYoLXRoaXMuX2NhY2hlZFVSb3RhdGlvbkNlbnRlciwtdGhpcy5fY2FjaGVkVlJvdGF0aW9uQ2VudGVyLC10aGlzLl9jYWNoZWRXUm90YXRpb25DZW50ZXIsRC5NYXRyaXhbMF0pLHguVHJhbnNsYXRpb25Ub1JlZih0aGlzLl9jYWNoZWRVUm90YXRpb25DZW50ZXIsdGhpcy5fY2FjaGVkVlJvdGF0aW9uQ2VudGVyLHRoaXMuX2NhY2hlZFdSb3RhdGlvbkNlbnRlcixELk1hdHJpeFsxXSkseC5TY2FsaW5nVG9SZWYodGhpcy5fY2FjaGVkVVNjYWxlLHRoaXMuX2NhY2hlZFZTY2FsZSwwLEQuTWF0cml4WzJdKSx4LlRyYW5zbGF0aW9uVG9SZWYodGhpcy5fY2FjaGVkVU9mZnNldCx0aGlzLl9jYWNoZWRWT2Zmc2V0LDAsRC5NYXRyaXhbM10pLEQuTWF0cml4WzBdLm11bHRpcGx5VG9SZWYodGhpcy5fcm93R2VuZXJhdGlvbk1hdHJpeCx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4KSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4Lm11bHRpcGx5VG9SZWYoRC5NYXRyaXhbMV0sdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeCksdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeC5tdWx0aXBseVRvUmVmKEQuTWF0cml4WzJdLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubXVsdGlwbHlUb1JlZihELk1hdHJpeFszXSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4KSx0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4LnNldFJvd0Zyb21GbG9hdHMoMix0aGlzLl9jYWNoZWRUZXh0dXJlTWF0cml4Lm1bMTJdLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgubVsxM10sdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeC5tWzE0XSwxKSk6KHRoaXMuX3ByZXBhcmVSb3dGb3JUZXh0dXJlR2VuZXJhdGlvbigwLDAsMCx0aGlzLl90MCksdGhpcy5fcHJlcGFyZVJvd0ZvclRleHR1cmVHZW5lcmF0aW9uKDEsMCwwLHRoaXMuX3QxKSx0aGlzLl9wcmVwYXJlUm93Rm9yVGV4dHVyZUdlbmVyYXRpb24oMCwxLDAsdGhpcy5fdDIpLHRoaXMuX3QxLnN1YnRyYWN0SW5QbGFjZSh0aGlzLl90MCksdGhpcy5fdDIuc3VidHJhY3RJblBsYWNlKHRoaXMuX3QwKSx4LkZyb21WYWx1ZXNUb1JlZih0aGlzLl90MS54LHRoaXMuX3QxLnksdGhpcy5fdDEueiwwLHRoaXMuX3QyLngsdGhpcy5fdDIueSx0aGlzLl90Mi56LDAsdGhpcy5fdDAueCx0aGlzLl90MC55LHRoaXMuX3QwLnosMCwwLDAsMCwxLHRoaXMuX2NhY2hlZFRleHR1cmVNYXRyaXgpKTtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKTtyZXR1cm4gdD8odGhpcy5vcHRpbWl6ZVVWQWxsb2NhdGlvbiYmdC5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxLGk9PmkuaGFzVGV4dHVyZSh0aGlzKSksdGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeCk6dGhpcy5fY2FjaGVkVGV4dHVyZU1hdHJpeH1nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpe2NvbnN0IGU9dGhpcy5nZXRTY2VuZSgpO2lmKCFlKXJldHVybiB0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeDtpZih0aGlzLnVPZmZzZXQ9PT10aGlzLl9jYWNoZWRSZWZsZWN0aW9uVU9mZnNldCYmdGhpcy52T2Zmc2V0PT09dGhpcy5fY2FjaGVkUmVmbGVjdGlvblZPZmZzZXQmJnRoaXMudVNjYWxlPT09dGhpcy5fY2FjaGVkUmVmbGVjdGlvblVTY2FsZSYmdGhpcy52U2NhbGU9PT10aGlzLl9jYWNoZWRSZWZsZWN0aW9uVlNjYWxlJiZ0aGlzLmNvb3JkaW5hdGVzTW9kZT09PXRoaXMuX2NhY2hlZFJlZmxlY3Rpb25Db29yZGluYXRlc01vZGUpaWYodGhpcy5jb29yZGluYXRlc01vZGU9PT1OLlBST0pFQ1RJT05fTU9ERSl7aWYodGhpcy5fY2FjaGVkUmVmbGVjdGlvblByb2plY3Rpb25NYXRyaXhJZD09PWUuZ2V0UHJvamVjdGlvbk1hdHJpeCgpLnVwZGF0ZUZsYWcpcmV0dXJuIHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4fWVsc2UgcmV0dXJuIHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4O3RoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4fHwodGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXg9eC5aZXJvKCkpLHRoaXMuX3Byb2plY3Rpb25Nb2RlTWF0cml4fHwodGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXg9eC5aZXJvKCkpO2NvbnN0IHQ9dGhpcy5fY2FjaGVkUmVmbGVjdGlvbkNvb3JkaW5hdGVzTW9kZSE9PXRoaXMuY29vcmRpbmF0ZXNNb2RlO3N3aXRjaCh0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVU9mZnNldD10aGlzLnVPZmZzZXQsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblZPZmZzZXQ9dGhpcy52T2Zmc2V0LHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25VU2NhbGU9dGhpcy51U2NhbGUsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblZTY2FsZT10aGlzLnZTY2FsZSx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uQ29vcmRpbmF0ZXNNb2RlPXRoaXMuY29vcmRpbmF0ZXNNb2RlLHRoaXMuY29vcmRpbmF0ZXNNb2RlKXtjYXNlIE4uUExBTkFSX01PREU6e3guSWRlbnRpdHlUb1JlZih0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCksdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXhbMF09dGhpcy51U2NhbGUsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXhbNV09dGhpcy52U2NhbGUsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXhbMTJdPXRoaXMudU9mZnNldCx0aGlzLl9jYWNoZWRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeFsxM109dGhpcy52T2Zmc2V0O2JyZWFrfWNhc2UgTi5QUk9KRUNUSU9OX01PREU6e3guRnJvbVZhbHVlc1RvUmVmKC41LDAsMCwwLDAsLS41LDAsMCwwLDAsMCwwLC41LC41LDEsMSx0aGlzLl9wcm9qZWN0aW9uTW9kZU1hdHJpeCk7Y29uc3QgaT1lLmdldFByb2plY3Rpb25NYXRyaXgoKTt0aGlzLl9jYWNoZWRSZWZsZWN0aW9uUHJvamVjdGlvbk1hdHJpeElkPWkudXBkYXRlRmxhZyxpLm11bHRpcGx5VG9SZWYodGhpcy5fcHJvamVjdGlvbk1vZGVNYXRyaXgsdGhpcy5fY2FjaGVkUmVmbGVjdGlvblRleHR1cmVNYXRyaXgpO2JyZWFrfWRlZmF1bHQ6eC5JZGVudGl0eVRvUmVmKHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4KTticmVha31yZXR1cm4gdCYmZS5tYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxLGk9PmkuZ2V0QWN0aXZlVGV4dHVyZXMoKS5pbmRleE9mKHRoaXMpIT09LTEpLHRoaXMuX2NhY2hlZFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4fWNsb25lKCl7Y29uc3QgZT17bm9NaXBtYXA6dGhpcy5fbm9NaXBtYXAsaW52ZXJ0WTp0aGlzLl9pbnZlcnRZLHNhbXBsaW5nTW9kZTp0aGlzLnNhbXBsaW5nTW9kZSxvbkxvYWQ6dm9pZCAwLG9uRXJyb3I6dm9pZCAwLGJ1ZmZlcjp0aGlzLl90ZXh0dXJlP3RoaXMuX3RleHR1cmUuX2J1ZmZlcjp2b2lkIDAsZGVsZXRlQnVmZmVyOnRoaXMuX2RlbGV0ZUJ1ZmZlcixmb3JtYXQ6dGhpcy50ZXh0dXJlRm9ybWF0LG1pbWVUeXBlOnRoaXMubWltZVR5cGUsbG9hZGVyT3B0aW9uczp0aGlzLl9sb2FkZXJPcHRpb25zLGNyZWF0aW9uRmxhZ3M6dGhpcy5fY3JlYXRpb25GbGFncyx1c2VTUkdCQnVmZmVyOnRoaXMuX3VzZVNSR0JCdWZmZXJ9O3JldHVybiBhZS5DbG9uZSgoKT0+bmV3IE4odGhpcy5fdGV4dHVyZT90aGlzLl90ZXh0dXJlLnVybDpudWxsLHRoaXMuZ2V0U2NlbmUoKSxlKSx0aGlzKX1zZXJpYWxpemUoKXt2YXIgZSx0O2NvbnN0IGk9dGhpcy5uYW1lO04uU2VyaWFsaXplQnVmZmVyc3x8dGhpcy5uYW1lLnN0YXJ0c1dpdGgoImRhdGE6IikmJih0aGlzLm5hbWU9IiIpLHRoaXMubmFtZS5zdGFydHNXaXRoKCJkYXRhOiIpJiZ0aGlzLnVybD09PXRoaXMubmFtZSYmKHRoaXMudXJsPSIiKTtjb25zdCBzPXN1cGVyLnNlcmlhbGl6ZShOLl9TZXJpYWxpemVJbnRlcm5hbFRleHR1cmVVbmlxdWVJZCk7cmV0dXJuIHM/KChOLlNlcmlhbGl6ZUJ1ZmZlcnN8fE4uRm9yY2VTZXJpYWxpemVCdWZmZXJzKSYmKHR5cGVvZiB0aGlzLl9idWZmZXI9PSJzdHJpbmciJiZ0aGlzLl9idWZmZXIuc3Vic3RyKDAsNSk9PT0iZGF0YToiPyhzLmJhc2U2NFN0cmluZz10aGlzLl9idWZmZXIscy5uYW1lPXMubmFtZS5yZXBsYWNlKCJkYXRhOiIsIiIpKTp0aGlzLnVybCYmdGhpcy51cmwuc3RhcnRzV2l0aCgiZGF0YToiKSYmdGhpcy5fYnVmZmVyIGluc3RhbmNlb2YgVWludDhBcnJheT9zLmJhc2U2NFN0cmluZz0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LCIrc3IodGhpcy5fYnVmZmVyKTooTi5Gb3JjZVNlcmlhbGl6ZUJ1ZmZlcnN8fHRoaXMudXJsJiZ0aGlzLnVybC5zdGFydHNXaXRoKCJibG9iOiIpfHx0aGlzLl9mb3JjZVNlcmlhbGl6ZSkmJihzLmJhc2U2NFN0cmluZz0hdGhpcy5fZW5naW5lfHx0aGlzLl9lbmdpbmUuX2ZlYXR1cmVzLnN1cHBvcnRTeW5jVGV4dHVyZVJlYWQ/cW4odGhpcyk6am4odGhpcykpKSxzLmludmVydFk9dGhpcy5faW52ZXJ0WSxzLnNhbXBsaW5nTW9kZT10aGlzLnNhbXBsaW5nTW9kZSxzLl9jcmVhdGlvbkZsYWdzPXRoaXMuX2NyZWF0aW9uRmxhZ3Mscy5fdXNlU1JHQkJ1ZmZlcj10aGlzLl91c2VTUkdCQnVmZmVyLE4uX1NlcmlhbGl6ZUludGVybmFsVGV4dHVyZVVuaXF1ZUlkJiYocy5pbnRlcm5hbFRleHR1cmVVbmlxdWVJZD0odD0oZT10aGlzLl90ZXh0dXJlKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUudW5pcXVlSWQpIT09bnVsbCYmdCE9PXZvaWQgMD90OnZvaWQgMCksdGhpcy5uYW1lPWkscyk6bnVsbH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iVGV4dHVyZSJ9ZGlzcG9zZSgpe3N1cGVyLmRpc3Bvc2UoKSx0aGlzLm9uTG9hZE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9kZWxheWVkT25Mb2FkPW51bGwsdGhpcy5fZGVsYXllZE9uRXJyb3I9bnVsbCx0aGlzLl9idWZmZXI9bnVsbH1zdGF0aWMgUGFyc2UoZSx0LGkpe2lmKGUuY3VzdG9tVHlwZSl7Y29uc3QgaD1MaS5JbnN0YW50aWF0ZShlLmN1c3RvbVR5cGUpLlBhcnNlKGUsdCxpKTtyZXR1cm4gZS5zYW1wbGluZ01vZGUmJmgudXBkYXRlU2FtcGxpbmdNb2RlJiZoLl9zYW1wbGluZ01vZGUmJmguX3NhbXBsaW5nTW9kZSE9PWUuc2FtcGxpbmdNb2RlJiZoLnVwZGF0ZVNhbXBsaW5nTW9kZShlLnNhbXBsaW5nTW9kZSksaH1pZihlLmlzQ3ViZSYmIWUuaXNSZW5kZXJUYXJnZXQpcmV0dXJuIE4uX0N1YmVUZXh0dXJlUGFyc2VyKGUsdCxpKTtjb25zdCBzPWUuaW50ZXJuYWxUZXh0dXJlVW5pcXVlSWQhPT12b2lkIDA7aWYoIWUubmFtZSYmIWUuaXNSZW5kZXJUYXJnZXQmJiFzKXJldHVybiBudWxsO2xldCByO2lmKHMpe2NvbnN0IG89dC5nZXRFbmdpbmUoKS5nZXRMb2FkZWRUZXh0dXJlc0NhY2hlKCk7Zm9yKGNvbnN0IGggb2YgbylpZihoLnVuaXF1ZUlkPT09ZS5pbnRlcm5hbFRleHR1cmVVbmlxdWVJZCl7cj1oO2JyZWFrfX1jb25zdCBuPW89Pnt2YXIgaDtpZihvJiZvLl90ZXh0dXJlJiYoby5fdGV4dHVyZS5fY2FjaGVkV3JhcFU9bnVsbCxvLl90ZXh0dXJlLl9jYWNoZWRXcmFwVj1udWxsLG8uX3RleHR1cmUuX2NhY2hlZFdyYXBSPW51bGwpLGUuc2FtcGxpbmdNb2RlKXtjb25zdCBsPWUuc2FtcGxpbmdNb2RlO28mJm8uc2FtcGxpbmdNb2RlIT09bCYmby51cGRhdGVTYW1wbGluZ01vZGUobCl9aWYobyYmZS5hbmltYXRpb25zKWZvcihsZXQgbD0wO2w8ZS5hbmltYXRpb25zLmxlbmd0aDtsKyspe2NvbnN0IHU9ZS5hbmltYXRpb25zW2xdLGQ9cmkoIkJBQllMT04uQW5pbWF0aW9uIik7ZCYmby5hbmltYXRpb25zLnB1c2goZC5QYXJzZSh1KSl9cyYmIXImJigoaD1vPT1udWxsP3ZvaWQgMDpvLl90ZXh0dXJlKT09PW51bGx8fGg9PT12b2lkIDB8fGguX3NldFVuaXF1ZUlkKGUuaW50ZXJuYWxUZXh0dXJlVW5pcXVlSWQpKX07cmV0dXJuIGFlLlBhcnNlKCgpPT57dmFyIG8saCxsO2xldCB1PSEwO2lmKGUubm9NaXBtYXAmJih1PSExKSxlLm1pcnJvclBsYW5lKXtjb25zdCBkPU4uX0NyZWF0ZU1pcnJvcihlLm5hbWUsZS5yZW5kZXJUYXJnZXRTaXplLHQsdSk7cmV0dXJuIGQuX3dhaXRpbmdSZW5kZXJMaXN0PWUucmVuZGVyTGlzdCxkLm1pcnJvclBsYW5lPXh0LkZyb21BcnJheShlLm1pcnJvclBsYW5lKSxuKGQpLGR9ZWxzZSBpZihlLmlzUmVuZGVyVGFyZ2V0KXtsZXQgZD1udWxsO2lmKGUuaXNDdWJlKXtpZih0LnJlZmxlY3Rpb25Qcm9iZXMpZm9yKGxldCBmPTA7Zjx0LnJlZmxlY3Rpb25Qcm9iZXMubGVuZ3RoO2YrKyl7Y29uc3QgXz10LnJlZmxlY3Rpb25Qcm9iZXNbZl07aWYoXy5uYW1lPT09ZS5uYW1lKXJldHVybiBfLmN1YmVUZXh0dXJlfX1lbHNlIGQ9Ti5fQ3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShlLm5hbWUsZS5yZW5kZXJUYXJnZXRTaXplLHQsdSwobz1lLl9jcmVhdGlvbkZsYWdzKSE9PW51bGwmJm8hPT12b2lkIDA/bzowKSxkLl93YWl0aW5nUmVuZGVyTGlzdD1lLnJlbmRlckxpc3Q7cmV0dXJuIG4oZCksZH1lbHNle2xldCBkO2lmKGUuYmFzZTY0U3RyaW5nJiYhcilkPU4uQ3JlYXRlRnJvbUJhc2U2NFN0cmluZyhlLmJhc2U2NFN0cmluZyxlLmJhc2U2NFN0cmluZyx0LCF1LGUuaW52ZXJ0WSxlLnNhbXBsaW5nTW9kZSwoKT0+e24oZCl9LChoPWUuX2NyZWF0aW9uRmxhZ3MpIT09bnVsbCYmaCE9PXZvaWQgMD9oOjAsKGw9ZS5fdXNlU1JHQkJ1ZmZlcikhPT1udWxsJiZsIT09dm9pZCAwP2w6ITEpLGQubmFtZT1lLm5hbWU7ZWxzZXtsZXQgZjtlLm5hbWUmJmUubmFtZS5pbmRleE9mKCI6Ly8iKT4wP2Y9ZS5uYW1lOmY9aStlLm5hbWUsZS51cmwmJihlLnVybC5zdGFydHNXaXRoKCJkYXRhOiIpfHxOLlVzZVNlcmlhbGl6ZWRVcmxJZkFueSkmJihmPWUudXJsKTtjb25zdCBfPXtub01pcG1hcDohdSxpbnZlcnRZOmUuaW52ZXJ0WSxzYW1wbGluZ01vZGU6ZS5zYW1wbGluZ01vZGUsb25Mb2FkOigpPT57bihkKX0saW50ZXJuYWxUZXh0dXJlOnJ9O2Q9bmV3IE4oZix0LF8pfXJldHVybiBkfX0sZSx0KX1zdGF0aWMgQ3JlYXRlRnJvbUJhc2U2NFN0cmluZyhlLHQsaSxzLHIsbj1OLlRSSUxJTkVBUl9TQU1QTElOR01PREUsYT1udWxsLG89bnVsbCxoPTUsbCl7cmV0dXJuIG5ldyBOKCJkYXRhOiIrdCxpLHMscixuLGEsbyxlLCExLGgsdm9pZCAwLHZvaWQgMCxsKX1zdGF0aWMgTG9hZEZyb21EYXRhU3RyaW5nKGUsdCxpLHM9ITEscixuPSEwLGE9Ti5UUklMSU5FQVJfU0FNUExJTkdNT0RFLG89bnVsbCxoPW51bGwsbD01LHUpe3JldHVybiBlLnN1YnN0cigwLDUpIT09ImRhdGE6IiYmKGU9ImRhdGE6IitlKSxuZXcgTihlLGkscixuLGEsbyxoLHQscyxsLHZvaWQgMCx2b2lkIDAsdSl9fU4uU2VyaWFsaXplQnVmZmVycz0hMCxOLkZvcmNlU2VyaWFsaXplQnVmZmVycz0hMSxOLk9uVGV4dHVyZUxvYWRFcnJvck9ic2VydmFibGU9bmV3IEYsTi5fU2VyaWFsaXplSW50ZXJuYWxUZXh0dXJlVW5pcXVlSWQ9ITEsTi5fQ3ViZVRleHR1cmVQYXJzZXI9KGMsZSx0KT0+e3Rocm93ICQoIkN1YmVUZXh0dXJlIil9LE4uX0NyZWF0ZU1pcnJvcj0oYyxlLHQsaSk9Pnt0aHJvdyAkKCJNaXJyb3JUZXh0dXJlIil9LE4uX0NyZWF0ZVJlbmRlclRhcmdldFRleHR1cmU9KGMsZSx0LGkscyk9Pnt0aHJvdyAkKCJSZW5kZXJUYXJnZXRUZXh0dXJlIil9LE4uTkVBUkVTVF9TQU1QTElOR01PREU9MSxOLk5FQVJFU1RfTkVBUkVTVF9NSVBMSU5FQVI9OCxOLkJJTElORUFSX1NBTVBMSU5HTU9ERT0yLE4uTElORUFSX0xJTkVBUl9NSVBORUFSRVNUPTExLE4uVFJJTElORUFSX1NBTVBMSU5HTU9ERT0zLE4uTElORUFSX0xJTkVBUl9NSVBMSU5FQVI9MyxOLk5FQVJFU1RfTkVBUkVTVF9NSVBORUFSRVNUPTQsTi5ORUFSRVNUX0xJTkVBUl9NSVBORUFSRVNUPTUsTi5ORUFSRVNUX0xJTkVBUl9NSVBMSU5FQVI9NixOLk5FQVJFU1RfTElORUFSPTcsTi5ORUFSRVNUX05FQVJFU1Q9MSxOLkxJTkVBUl9ORUFSRVNUX01JUE5FQVJFU1Q9OSxOLkxJTkVBUl9ORUFSRVNUX01JUExJTkVBUj0xMCxOLkxJTkVBUl9MSU5FQVI9MixOLkxJTkVBUl9ORUFSRVNUPTEyLE4uRVhQTElDSVRfTU9ERT0wLE4uU1BIRVJJQ0FMX01PREU9MSxOLlBMQU5BUl9NT0RFPTIsTi5DVUJJQ19NT0RFPTMsTi5QUk9KRUNUSU9OX01PREU9NCxOLlNLWUJPWF9NT0RFPTUsTi5JTlZDVUJJQ19NT0RFPTYsTi5FUVVJUkVDVEFOR1VMQVJfTU9ERT03LE4uRklYRURfRVFVSVJFQ1RBTkdVTEFSX01PREU9OCxOLkZJWEVEX0VRVUlSRUNUQU5HVUxBUl9NSVJST1JFRF9NT0RFPTksTi5DTEFNUF9BRERSRVNTTU9ERT0wLE4uV1JBUF9BRERSRVNTTU9ERT0xLE4uTUlSUk9SX0FERFJFU1NNT0RFPTIsTi5Vc2VTZXJpYWxpemVkVXJsSWZBbnk9ITEsVChbUigpXSxOLnByb3RvdHlwZSwidXJsIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsInVPZmZzZXQiLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwidk9mZnNldCIsdm9pZCAwKSxUKFtSKCldLE4ucHJvdG90eXBlLCJ1U2NhbGUiLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwidlNjYWxlIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsInVBbmciLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwidkFuZyIsdm9pZCAwKSxUKFtSKCldLE4ucHJvdG90eXBlLCJ3QW5nIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsInVSb3RhdGlvbkNlbnRlciIsdm9pZCAwKSxUKFtSKCldLE4ucHJvdG90eXBlLCJ2Um90YXRpb25DZW50ZXIiLHZvaWQgMCksVChbUigpXSxOLnByb3RvdHlwZSwid1JvdGF0aW9uQ2VudGVyIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsImhvbW9nZW5lb3VzUm90YXRpb25JblVWVHJhbnNmb3JtIix2b2lkIDApLFQoW1IoKV0sTi5wcm90b3R5cGUsImlzQmxvY2tpbmciLG51bGwpLGl0KCJCQUJZTE9OLlRleHR1cmUiLE4pLGFlLl9UZXh0dXJlUGFyc2VyPU4uUGFyc2U7Y2xhc3MgJG57Y29uc3RydWN0b3IoZSx0LGkscyl7dGhpcy5fdGV4dHVyZXM9bnVsbCx0aGlzLl9zYW1wbGVzPTEsdGhpcy5fYXR0YWNobWVudHM9bnVsbCx0aGlzLl9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXI9ITEsdGhpcy5fZ2VuZXJhdGVEZXB0aEJ1ZmZlcj0hMSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw9ITEsdGhpcy5faXNNdWx0aT1lLHRoaXMuX2lzQ3ViZT10LHRoaXMuX3NpemU9aSx0aGlzLl9lbmdpbmU9cyx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlPW51bGx9Z2V0IGRlcHRoU3RlbmNpbFRleHR1cmUoKXtyZXR1cm4gdGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZX1nZXQgZGVwdGhTdGVuY2lsVGV4dHVyZVdpdGhTdGVuY2lsKCl7cmV0dXJuIHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVXaXRoU3RlbmNpbH1nZXQgaXNDdWJlKCl7cmV0dXJuIHRoaXMuX2lzQ3ViZX1nZXQgaXNNdWx0aSgpe3JldHVybiB0aGlzLl9pc011bHRpfWdldCBpczJEQXJyYXkoKXtyZXR1cm4gdGhpcy5sYXllcnM+MH1nZXQgc2l6ZSgpe3JldHVybiB0aGlzLndpZHRofWdldCB3aWR0aCgpe3JldHVybiB0aGlzLl9zaXplLndpZHRofHx0aGlzLl9zaXplfWdldCBoZWlnaHQoKXtyZXR1cm4gdGhpcy5fc2l6ZS5oZWlnaHR8fHRoaXMuX3NpemV9Z2V0IGxheWVycygpe3JldHVybiB0aGlzLl9zaXplLmxheWVyc3x8MH1nZXQgdGV4dHVyZSgpe3ZhciBlLHQ7cmV0dXJuKHQ9KGU9dGhpcy5fdGV4dHVyZXMpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZVswXSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6bnVsbH1nZXQgdGV4dHVyZXMoKXtyZXR1cm4gdGhpcy5fdGV4dHVyZXN9Z2V0IHNhbXBsZXMoKXtyZXR1cm4gdGhpcy5fc2FtcGxlc31zZXRTYW1wbGVzKGUsdD0hMCxpPSExKXtpZih0aGlzLnNhbXBsZXM9PT1lJiYhaSlyZXR1cm4gZTtjb25zdCBzPXRoaXMuX2lzTXVsdGk/dGhpcy5fZW5naW5lLnVwZGF0ZU11bHRpcGxlUmVuZGVyVGFyZ2V0VGV4dHVyZVNhbXBsZUNvdW50KHRoaXMsZSx0KTp0aGlzLl9lbmdpbmUudXBkYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZVNhbXBsZUNvdW50KHRoaXMsZSk7cmV0dXJuIHRoaXMuX3NhbXBsZXM9ZSxzfXNldFRleHR1cmVzKGUpe0FycmF5LmlzQXJyYXkoZSk/dGhpcy5fdGV4dHVyZXM9ZTplP3RoaXMuX3RleHR1cmVzPVtlXTp0aGlzLl90ZXh0dXJlcz1udWxsfXNldFRleHR1cmUoZSx0PTAsaT0hMCl7dGhpcy5fdGV4dHVyZXN8fCh0aGlzLl90ZXh0dXJlcz1bXSksdGhpcy5fdGV4dHVyZXNbdF0mJmkmJnRoaXMuX3RleHR1cmVzW3RdLmRpc3Bvc2UoKSx0aGlzLl90ZXh0dXJlc1t0XT1lfWNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZT0wLHQ9ITAsaT0hMSxzPTEscj0xNCl7dmFyIG47cmV0dXJuKG49dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZSk9PT1udWxsfHxuPT09dm9pZCAwfHxuLmRpc3Bvc2UoKSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw9aSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlPXRoaXMuX2VuZ2luZS5jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlKHRoaXMuX3NpemUse2JpbGluZWFyRmlsdGVyaW5nOnQsY29tcGFyaXNvbkZ1bmN0aW9uOmUsZ2VuZXJhdGVTdGVuY2lsOmksaXNDdWJlOnRoaXMuX2lzQ3ViZSxzYW1wbGVzOnMsZGVwdGhUZXh0dXJlRm9ybWF0OnJ9LHRoaXMpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmV9X3NoYXJlRGVwdGgoZSl7dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZSYmKGUuX2RlcHRoU3RlbmNpbFRleHR1cmUmJmUuX2RlcHRoU3RlbmNpbFRleHR1cmUuZGlzcG9zZSgpLGUuX2RlcHRoU3RlbmNpbFRleHR1cmU9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZSx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlLmluY3JlbWVudFJlZmVyZW5jZXMoKSl9X3N3YXBBbmREaWUoZSl7dGhpcy50ZXh0dXJlJiZ0aGlzLnRleHR1cmUuX3N3YXBBbmREaWUoZSksdGhpcy5fdGV4dHVyZXM9bnVsbCx0aGlzLmRpc3Bvc2UoITApfV9jbG9uZVJlbmRlclRhcmdldFdyYXBwZXIoKXt2YXIgZSx0LGkscyxyLG47bGV0IGE9bnVsbDtpZih0aGlzLl9pc011bHRpKXtjb25zdCBvPXRoaXMudGV4dHVyZXM7aWYobyYmby5sZW5ndGg+MCl7bGV0IGg9ITEsbD1vLmxlbmd0aDtjb25zdCB1PW9bby5sZW5ndGgtMV0uX3NvdXJjZTsodT09PU5lLkRlcHRofHx1PT09TmUuRGVwdGhTdGVuY2lsKSYmKGg9ITAsbC0tKTtjb25zdCBkPVtdLGY9W107Zm9yKGxldCBtPTA7bTxsOysrbSl7Y29uc3Qgdj1vW21dO2QucHVzaCh2LnNhbXBsaW5nTW9kZSksZi5wdXNoKHYudHlwZSl9Y29uc3QgXz17c2FtcGxpbmdNb2RlczpkLGdlbmVyYXRlTWlwTWFwczpvWzBdLmdlbmVyYXRlTWlwTWFwcyxnZW5lcmF0ZURlcHRoQnVmZmVyOnRoaXMuX2dlbmVyYXRlRGVwdGhCdWZmZXIsZ2VuZXJhdGVTdGVuY2lsQnVmZmVyOnRoaXMuX2dlbmVyYXRlU3RlbmNpbEJ1ZmZlcixnZW5lcmF0ZURlcHRoVGV4dHVyZTpoLHR5cGVzOmYsdGV4dHVyZUNvdW50Omx9LEU9e3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fTthPXRoaXMuX2VuZ2luZS5jcmVhdGVNdWx0aXBsZVJlbmRlclRhcmdldChFLF8pfX1lbHNle2NvbnN0IG89e307aWYoby5nZW5lcmF0ZURlcHRoQnVmZmVyPXRoaXMuX2dlbmVyYXRlRGVwdGhCdWZmZXIsby5nZW5lcmF0ZU1pcE1hcHM9KHQ9KGU9dGhpcy50ZXh0dXJlKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuZ2VuZXJhdGVNaXBNYXBzKSE9PW51bGwmJnQhPT12b2lkIDA/dDohMSxvLmdlbmVyYXRlU3RlbmNpbEJ1ZmZlcj10aGlzLl9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXIsby5zYW1wbGluZ01vZGU9KGk9dGhpcy50ZXh0dXJlKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmkuc2FtcGxpbmdNb2RlLG8udHlwZT0ocz10aGlzLnRleHR1cmUpPT09bnVsbHx8cz09PXZvaWQgMD92b2lkIDA6cy50eXBlLG8uZm9ybWF0PShyPXRoaXMudGV4dHVyZSk9PT1udWxsfHxyPT09dm9pZCAwP3ZvaWQgMDpyLmZvcm1hdCx0aGlzLmlzQ3ViZSlhPXRoaXMuX2VuZ2luZS5jcmVhdGVSZW5kZXJUYXJnZXRDdWJlVGV4dHVyZSh0aGlzLndpZHRoLG8pO2Vsc2V7Y29uc3QgaD17d2lkdGg6dGhpcy53aWR0aCxoZWlnaHQ6dGhpcy5oZWlnaHQsbGF5ZXJzOnRoaXMuaXMyREFycmF5PyhuPXRoaXMudGV4dHVyZSk9PT1udWxsfHxuPT09dm9pZCAwP3ZvaWQgMDpuLmRlcHRoOnZvaWQgMH07YT10aGlzLl9lbmdpbmUuY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShoLG8pfWEudGV4dHVyZS5pc1JlYWR5PSEwfXJldHVybiBhfV9zd2FwUmVuZGVyVGFyZ2V0V3JhcHBlcihlKXtpZih0aGlzLl90ZXh0dXJlcyYmZS5fdGV4dHVyZXMpZm9yKGxldCB0PTA7dDx0aGlzLl90ZXh0dXJlcy5sZW5ndGg7Kyt0KXRoaXMuX3RleHR1cmVzW3RdLl9zd2FwQW5kRGllKGUuX3RleHR1cmVzW3RdLCExKSxlLl90ZXh0dXJlc1t0XS5pc1JlYWR5PSEwO3RoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUmJmUuX2RlcHRoU3RlbmNpbFRleHR1cmUmJih0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlLl9zd2FwQW5kRGllKGUuX2RlcHRoU3RlbmNpbFRleHR1cmUpLGUuX2RlcHRoU3RlbmNpbFRleHR1cmUuaXNSZWFkeT0hMCksdGhpcy5fdGV4dHVyZXM9bnVsbCx0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlPW51bGx9X3JlYnVpbGQoKXtjb25zdCBlPXRoaXMuX2Nsb25lUmVuZGVyVGFyZ2V0V3JhcHBlcigpO2lmKGUpe2lmKHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUpe2NvbnN0IHQ9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZS5zYW1wbGluZ01vZGUsaT10PT09Mnx8dD09PTN8fHQ9PT0xMTtlLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUodGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZS5fY29tcGFyaXNvbkZ1bmN0aW9uLGksdGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZVdpdGhTdGVuY2lsLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmUuc2FtcGxlcyl9dGhpcy5zYW1wbGVzPjEmJmUuc2V0U2FtcGxlcyh0aGlzLnNhbXBsZXMpLGUuX3N3YXBSZW5kZXJUYXJnZXRXcmFwcGVyKHRoaXMpLGUuZGlzcG9zZSgpfX1yZWxlYXNlVGV4dHVyZXMoKXt2YXIgZSx0O2lmKHRoaXMuX3RleHR1cmVzKWZvcihsZXQgaT0wOyh0PWk8KChlPXRoaXMuX3RleHR1cmVzKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUubGVuZ3RoKSkhPT1udWxsJiZ0IT09dm9pZCAwJiZ0OysraSl0aGlzLl90ZXh0dXJlc1tpXS5kaXNwb3NlKCk7dGhpcy5fdGV4dHVyZXM9bnVsbH1kaXNwb3NlKGU9ITEpe3ZhciB0O2V8fCgodD10aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuZGlzcG9zZSgpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmU9bnVsbCx0aGlzLnJlbGVhc2VUZXh0dXJlcygpKSx0aGlzLl9lbmdpbmUuX3JlbGVhc2VSZW5kZXJUYXJnZXRXcmFwcGVyKHRoaXMpfX1jbGFzcyBRbiBleHRlbmRzICRue2NvbnN0cnVjdG9yKGUsdCxpLHMscil7c3VwZXIoZSx0LGkscyksdGhpcy5fZnJhbWVidWZmZXI9bnVsbCx0aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXI9bnVsbCx0aGlzLl9NU0FBRnJhbWVidWZmZXI9bnVsbCx0aGlzLl9jb2xvclRleHR1cmVBcnJheT1udWxsLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheT1udWxsLHRoaXMuX2NvbnRleHQ9cn1fY2xvbmVSZW5kZXJUYXJnZXRXcmFwcGVyKCl7bGV0IGU9bnVsbDtyZXR1cm4gdGhpcy5fY29sb3JUZXh0dXJlQXJyYXkmJnRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheT8oZT10aGlzLl9lbmdpbmUuY3JlYXRlTXVsdGl2aWV3UmVuZGVyVGFyZ2V0VGV4dHVyZSh0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSxlLnRleHR1cmUuaXNSZWFkeT0hMCk6ZT1zdXBlci5fY2xvbmVSZW5kZXJUYXJnZXRXcmFwcGVyKCksZX1fc3dhcFJlbmRlclRhcmdldFdyYXBwZXIoZSl7c3VwZXIuX3N3YXBSZW5kZXJUYXJnZXRXcmFwcGVyKGUpLGUuX2ZyYW1lYnVmZmVyPXRoaXMuX2ZyYW1lYnVmZmVyLGUuX2RlcHRoU3RlbmNpbEJ1ZmZlcj10aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXIsZS5fTVNBQUZyYW1lYnVmZmVyPXRoaXMuX01TQUFGcmFtZWJ1ZmZlcixlLl9jb2xvclRleHR1cmVBcnJheT10aGlzLl9jb2xvclRleHR1cmVBcnJheSxlLl9kZXB0aFN0ZW5jaWxUZXh0dXJlQXJyYXk9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZUFycmF5LHRoaXMuX2ZyYW1lYnVmZmVyPXRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlcj10aGlzLl9NU0FBRnJhbWVidWZmZXI9dGhpcy5fY29sb3JUZXh0dXJlQXJyYXk9dGhpcy5fZGVwdGhTdGVuY2lsVGV4dHVyZUFycmF5PW51bGx9X3NoYXJlRGVwdGgoZSl7c3VwZXIuX3NoYXJlRGVwdGgoZSk7Y29uc3QgdD10aGlzLl9jb250ZXh0LGk9dGhpcy5fZGVwdGhTdGVuY2lsQnVmZmVyLHM9ZS5fTVNBQUZyYW1lYnVmZmVyfHxlLl9mcmFtZWJ1ZmZlcjtlLl9kZXB0aFN0ZW5jaWxCdWZmZXImJnQuZGVsZXRlUmVuZGVyYnVmZmVyKGUuX2RlcHRoU3RlbmNpbEJ1ZmZlciksZS5fZGVwdGhTdGVuY2lsQnVmZmVyPXRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlcix0aGlzLl9lbmdpbmUuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIocyksdC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcih0LkZSQU1FQlVGRkVSLHQuREVQVEhfQVRUQUNITUVOVCx0LlJFTkRFUkJVRkZFUixpKSx0aGlzLl9lbmdpbmUuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCl9X2JpbmRUZXh0dXJlUmVuZGVyVGFyZ2V0KGUsdD0wLGk9LTEscz0wKXtpZighZS5faGFyZHdhcmVUZXh0dXJlKXJldHVybjtjb25zdCByPXRoaXMuX2NvbnRleHQsbj10aGlzLl9mcmFtZWJ1ZmZlcixhPXRoaXMuX2VuZ2luZS5fY3VycmVudEZyYW1lYnVmZmVyO3RoaXMuX2VuZ2luZS5fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihuKTtjb25zdCBvPXJbdGhpcy5fZW5naW5lLndlYkdMVmVyc2lvbj4xPyJDT0xPUl9BVFRBQ0hNRU5UIit0OiJDT0xPUl9BVFRBQ0hNRU5UIit0KyJfV0VCR0wiXSxoPWkhPT0tMT9yLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtpOnIuVEVYVFVSRV8yRDtyLmZyYW1lYnVmZmVyVGV4dHVyZTJEKHIuRlJBTUVCVUZGRVIsbyxoLGUuX2hhcmR3YXJlVGV4dHVyZS51bmRlcmx5aW5nUmVzb3VyY2UscyksdGhpcy5fZW5naW5lLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGEpfXNldFRleHR1cmUoZSx0PTAsaT0hMCl7c3VwZXIuc2V0VGV4dHVyZShlLHQsaSksdGhpcy5fYmluZFRleHR1cmVSZW5kZXJUYXJnZXQoZSx0KX1kaXNwb3NlKGU9ITEpe2NvbnN0IHQ9dGhpcy5fY29udGV4dDtlfHwodGhpcy5fY29sb3JUZXh0dXJlQXJyYXkmJih0aGlzLl9jb250ZXh0LmRlbGV0ZVRleHR1cmUodGhpcy5fY29sb3JUZXh0dXJlQXJyYXkpLHRoaXMuX2NvbG9yVGV4dHVyZUFycmF5PW51bGwpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheSYmKHRoaXMuX2NvbnRleHQuZGVsZXRlVGV4dHVyZSh0aGlzLl9kZXB0aFN0ZW5jaWxUZXh0dXJlQXJyYXkpLHRoaXMuX2RlcHRoU3RlbmNpbFRleHR1cmVBcnJheT1udWxsKSksdGhpcy5fZnJhbWVidWZmZXImJih0LmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuX2ZyYW1lYnVmZmVyKSx0aGlzLl9mcmFtZWJ1ZmZlcj1udWxsKSx0aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXImJih0LmRlbGV0ZVJlbmRlcmJ1ZmZlcih0aGlzLl9kZXB0aFN0ZW5jaWxCdWZmZXIpLHRoaXMuX2RlcHRoU3RlbmNpbEJ1ZmZlcj1udWxsKSx0aGlzLl9NU0FBRnJhbWVidWZmZXImJih0LmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuX01TQUFGcmFtZWJ1ZmZlciksdGhpcy5fTVNBQUZyYW1lYnVmZmVyPW51bGwpLHN1cGVyLmRpc3Bvc2UoZSl9fW9lLnByb3RvdHlwZS5fY3JlYXRlSGFyZHdhcmVSZW5kZXJUYXJnZXRXcmFwcGVyPWZ1bmN0aW9uKGMsZSx0KXtjb25zdCBpPW5ldyBRbihjLGUsdCx0aGlzLHRoaXMuX2dsKTtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0V3JhcHBlckNhY2hlLnB1c2goaSksaX0sb2UucHJvdG90eXBlLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmU9ZnVuY3Rpb24oYyxlKXt2YXIgdCxpO2NvbnN0IHM9dGhpcy5fY3JlYXRlSGFyZHdhcmVSZW5kZXJUYXJnZXRXcmFwcGVyKCExLCExLGMpO2xldCByPSEwLG49ITEsYT0hMSxvLGg9MTtlIT09dm9pZCAwJiZ0eXBlb2YgZT09Im9iamVjdCImJihyPSh0PWUuZ2VuZXJhdGVEZXB0aEJ1ZmZlcikhPT1udWxsJiZ0IT09dm9pZCAwP3Q6ITAsbj0hIWUuZ2VuZXJhdGVTdGVuY2lsQnVmZmVyLGE9ISFlLm5vQ29sb3JBdHRhY2htZW50LG89ZS5jb2xvckF0dGFjaG1lbnQsaD0oaT1lLnNhbXBsZXMpIT09bnVsbCYmaSE9PXZvaWQgMD9pOjEpO2NvbnN0IGw9b3x8KGE/bnVsbDp0aGlzLl9jcmVhdGVJbnRlcm5hbFRleHR1cmUoYyxlLCEwLE5lLlJlbmRlclRhcmdldCkpLHU9Yy53aWR0aHx8YyxkPWMuaGVpZ2h0fHxjLGY9dGhpcy5fY3VycmVudEZyYW1lYnVmZmVyLF89dGhpcy5fZ2wsRT1fLmNyZWF0ZUZyYW1lYnVmZmVyKCk7cmV0dXJuIHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIoRSkscy5fZGVwdGhTdGVuY2lsQnVmZmVyPXRoaXMuX3NldHVwRnJhbWVidWZmZXJEZXB0aEF0dGFjaG1lbnRzKG4scix1LGQpLGwmJiFsLmlzMkRBcnJheSYmXy5mcmFtZWJ1ZmZlclRleHR1cmUyRChfLkZSQU1FQlVGRkVSLF8uQ09MT1JfQVRUQUNITUVOVDAsXy5URVhUVVJFXzJELGwuX2hhcmR3YXJlVGV4dHVyZS51bmRlcmx5aW5nUmVzb3VyY2UsMCksdGhpcy5fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihmKSxzLl9mcmFtZWJ1ZmZlcj1FLHMuX2dlbmVyYXRlRGVwdGhCdWZmZXI9cixzLl9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXI9bixzLnNldFRleHR1cmVzKGwpLHRoaXMudXBkYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZVNhbXBsZUNvdW50KHMsaCksc30sb2UucHJvdG90eXBlLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmU9ZnVuY3Rpb24oYyxlLHQpe2lmKGUuaXNDdWJlKXtjb25zdCBpPWMud2lkdGh8fGM7cmV0dXJuIHRoaXMuX2NyZWF0ZURlcHRoU3RlbmNpbEN1YmVUZXh0dXJlKGksZSx0KX1lbHNlIHJldHVybiB0aGlzLl9jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlKGMsZSx0KX0sb2UucHJvdG90eXBlLl9jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlPWZ1bmN0aW9uKGMsZSx0KXtjb25zdCBpPXRoaXMuX2dsLHM9Yy5sYXllcnN8fDAscj1zIT09MD9pLlRFWFRVUkVfMkRfQVJSQVk6aS5URVhUVVJFXzJELG49bmV3IE90KHRoaXMsTmUuRGVwdGhTdGVuY2lsKTtpZighdGhpcy5fY2Fwcy5kZXB0aFRleHR1cmVFeHRlbnNpb24pcmV0dXJuIE8uRXJyb3IoIkRlcHRoIHRleHR1cmUgaXMgbm90IHN1cHBvcnRlZCBieSB5b3VyIGJyb3dzZXIgb3IgaGFyZHdhcmUuIiksbjtjb25zdCBhPXtiaWxpbmVhckZpbHRlcmluZzohMSxjb21wYXJpc29uRnVuY3Rpb246MCxnZW5lcmF0ZVN0ZW5jaWw6ITEsLi4uZX07aWYodGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShyLG4sITApLHRoaXMuX3NldHVwRGVwdGhTdGVuY2lsVGV4dHVyZShuLGMsYS5nZW5lcmF0ZVN0ZW5jaWwsYS5jb21wYXJpc29uRnVuY3Rpb249PT0wPyExOmEuYmlsaW5lYXJGaWx0ZXJpbmcsYS5jb21wYXJpc29uRnVuY3Rpb24sYS5zYW1wbGVzKSxhLmRlcHRoVGV4dHVyZUZvcm1hdCE9PXZvaWQgMCl7aWYoYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNSYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNiYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNyYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xMyYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xNCYmYS5kZXB0aFRleHR1cmVGb3JtYXQhPT0xOClyZXR1cm4gTy5FcnJvcigiRGVwdGggdGV4dHVyZSBmb3JtYXQgaXMgbm90IHN1cHBvcnRlZC4iKSxuO24uZm9ybWF0PWEuZGVwdGhUZXh0dXJlRm9ybWF0fWVsc2Ugbi5mb3JtYXQ9YS5nZW5lcmF0ZVN0ZW5jaWw/MTM6MTY7Y29uc3Qgbz1uLmZvcm1hdD09PTE3fHxuLmZvcm1hdD09PTEzfHxuLmZvcm1hdD09PTE4O3QuX2RlcHRoU3RlbmNpbFRleHR1cmU9bix0Ll9kZXB0aFN0ZW5jaWxUZXh0dXJlV2l0aFN0ZW5jaWw9bztsZXQgaD1pLlVOU0lHTkVEX0lOVDtuLmZvcm1hdD09PTE1P2g9aS5VTlNJR05FRF9TSE9SVDpuLmZvcm1hdD09PTE3fHxuLmZvcm1hdD09PTEzP2g9aS5VTlNJR05FRF9JTlRfMjRfODpuLmZvcm1hdD09PTE0P2g9aS5GTE9BVDpuLmZvcm1hdD09PTE4JiYoaD1pLkZMT0FUXzMyX1VOU0lHTkVEX0lOVF8yNF84X1JFVik7Y29uc3QgbD1vP2kuREVQVEhfU1RFTkNJTDppLkRFUFRIX0NPTVBPTkVOVDtsZXQgdT1sO3RoaXMud2ViR0xWZXJzaW9uPjEmJihuLmZvcm1hdD09PTE1P3U9aS5ERVBUSF9DT01QT05FTlQxNjpuLmZvcm1hdD09PTE2P3U9aS5ERVBUSF9DT01QT05FTlQyNDpuLmZvcm1hdD09PTE3fHxuLmZvcm1hdD09PTEzP3U9aS5ERVBUSDI0X1NURU5DSUw4Om4uZm9ybWF0PT09MTQ/dT1pLkRFUFRIX0NPTVBPTkVOVDMyRjpuLmZvcm1hdD09PTE4JiYodT1pLkRFUFRIMzJGX1NURU5DSUw4KSksbi5pczJEQXJyYXk/aS50ZXhJbWFnZTNEKHIsMCx1LG4ud2lkdGgsbi5oZWlnaHQscywwLGwsaCxudWxsKTppLnRleEltYWdlMkQociwwLHUsbi53aWR0aCxuLmhlaWdodCwwLGwsaCxudWxsKSx0aGlzLl9iaW5kVGV4dHVyZURpcmVjdGx5KHIsbnVsbCksdGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnB1c2gobik7Y29uc3QgZD10O2lmKGQuX2RlcHRoU3RlbmNpbEJ1ZmZlcil7Y29uc3QgZj10aGlzLl9jdXJyZW50RnJhbWVidWZmZXI7dGhpcy5fYmluZFVuYm91bmRGcmFtZWJ1ZmZlcihkLl9mcmFtZWJ1ZmZlciksaS5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihpLkZSQU1FQlVGRkVSLGkuREVQVEhfU1RFTkNJTF9BVFRBQ0hNRU5ULGkuUkVOREVSQlVGRkVSLG51bGwpLGkuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoaS5GUkFNRUJVRkZFUixpLkRFUFRIX0FUVEFDSE1FTlQsaS5SRU5ERVJCVUZGRVIsbnVsbCksaS5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcihpLkZSQU1FQlVGRkVSLGkuU1RFTkNJTF9BVFRBQ0hNRU5ULGkuUkVOREVSQlVGRkVSLG51bGwpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIoZiksaS5kZWxldGVSZW5kZXJidWZmZXIoZC5fZGVwdGhTdGVuY2lsQnVmZmVyKSxkLl9kZXB0aFN0ZW5jaWxCdWZmZXI9bnVsbH1yZXR1cm4gbn0sb2UucHJvdG90eXBlLnVwZGF0ZVJlbmRlclRhcmdldFRleHR1cmVTYW1wbGVDb3VudD1mdW5jdGlvbihjLGUpe2lmKHRoaXMud2ViR0xWZXJzaW9uPDJ8fCFjfHwhYy50ZXh0dXJlKXJldHVybiAxO2lmKGMuc2FtcGxlcz09PWUpcmV0dXJuIGU7Y29uc3QgdD10aGlzLl9nbDtlPU1hdGgubWluKGUsdGhpcy5nZXRDYXBzKCkubWF4TVNBQVNhbXBsZXMpLGMuX2RlcHRoU3RlbmNpbEJ1ZmZlciYmKHQuZGVsZXRlUmVuZGVyYnVmZmVyKGMuX2RlcHRoU3RlbmNpbEJ1ZmZlciksYy5fZGVwdGhTdGVuY2lsQnVmZmVyPW51bGwpLGMuX01TQUFGcmFtZWJ1ZmZlciYmKHQuZGVsZXRlRnJhbWVidWZmZXIoYy5fTVNBQUZyYW1lYnVmZmVyKSxjLl9NU0FBRnJhbWVidWZmZXI9bnVsbCk7Y29uc3QgaT1jLnRleHR1cmUuX2hhcmR3YXJlVGV4dHVyZTtpZihpLl9NU0FBUmVuZGVyQnVmZmVyJiYodC5kZWxldGVSZW5kZXJidWZmZXIoaS5fTVNBQVJlbmRlckJ1ZmZlciksaS5fTVNBQVJlbmRlckJ1ZmZlcj1udWxsKSxlPjEmJnQucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKXtjb25zdCBzPXQuY3JlYXRlRnJhbWVidWZmZXIoKTtpZighcyl0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjcmVhdGUgbXVsdGkgc2FtcGxlZCBmcmFtZWJ1ZmZlciIpO2MuX01TQUFGcmFtZWJ1ZmZlcj1zLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIoYy5fTVNBQUZyYW1lYnVmZmVyKTtjb25zdCByPXRoaXMuX2NyZWF0ZVJlbmRlckJ1ZmZlcihjLnRleHR1cmUud2lkdGgsYy50ZXh0dXJlLmhlaWdodCxlLC0xLHRoaXMuX2dldFJHQkFNdWx0aVNhbXBsZUJ1ZmZlckZvcm1hdChjLnRleHR1cmUudHlwZSksdC5DT0xPUl9BVFRBQ0hNRU5UMCwhMSk7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gY3JlYXRlIG11bHRpIHNhbXBsZWQgZnJhbWVidWZmZXIiKTtpLl9NU0FBUmVuZGVyQnVmZmVyPXJ9ZWxzZSB0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGMuX2ZyYW1lYnVmZmVyKTtyZXR1cm4gYy50ZXh0dXJlLnNhbXBsZXM9ZSxjLl9zYW1wbGVzPWUsYy5fZGVwdGhTdGVuY2lsQnVmZmVyPXRoaXMuX3NldHVwRnJhbWVidWZmZXJEZXB0aEF0dGFjaG1lbnRzKGMuX2dlbmVyYXRlU3RlbmNpbEJ1ZmZlcixjLl9nZW5lcmF0ZURlcHRoQnVmZmVyLGMudGV4dHVyZS53aWR0aCxjLnRleHR1cmUuaGVpZ2h0LGUpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCksZX0sb2UucHJvdG90eXBlLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlPWZ1bmN0aW9uKGMsZSl7Y29uc3QgdD10aGlzLl9jcmVhdGVIYXJkd2FyZVJlbmRlclRhcmdldFdyYXBwZXIoITEsITAsYyksaT17Z2VuZXJhdGVNaXBNYXBzOiEwLGdlbmVyYXRlRGVwdGhCdWZmZXI6ITAsZ2VuZXJhdGVTdGVuY2lsQnVmZmVyOiExLHR5cGU6MCxzYW1wbGluZ01vZGU6Myxmb3JtYXQ6NSwuLi5lfTtpLmdlbmVyYXRlU3RlbmNpbEJ1ZmZlcj1pLmdlbmVyYXRlRGVwdGhCdWZmZXImJmkuZ2VuZXJhdGVTdGVuY2lsQnVmZmVyLChpLnR5cGU9PT0xJiYhdGhpcy5fY2Fwcy50ZXh0dXJlRmxvYXRMaW5lYXJGaWx0ZXJpbmd8fGkudHlwZT09PTImJiF0aGlzLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmcpJiYoaS5zYW1wbGluZ01vZGU9MSk7Y29uc3Qgcz10aGlzLl9nbCxyPW5ldyBPdCh0aGlzLE5lLlJlbmRlclRhcmdldCk7dGhpcy5fYmluZFRleHR1cmVEaXJlY3RseShzLlRFWFRVUkVfQ1VCRV9NQVAsciwhMCk7Y29uc3Qgbj10aGlzLl9nZXRTYW1wbGluZ1BhcmFtZXRlcnMoaS5zYW1wbGluZ01vZGUsaS5nZW5lcmF0ZU1pcE1hcHMpO2kudHlwZT09PTEmJiF0aGlzLl9jYXBzLnRleHR1cmVGbG9hdCYmKGkudHlwZT0wLE8uV2FybigiRmxvYXQgdGV4dHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQuIEN1YmUgcmVuZGVyIHRhcmdldCBmb3JjZWQgdG8gVEVYVFVSRVRZUEVfVU5FU0lHTkVEX0JZVEUgdHlwZSIpKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9NQUdfRklMVEVSLG4ubWFnKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9NSU5fRklMVEVSLG4ubWluKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9XUkFQX1Mscy5DTEFNUF9UT19FREdFKSxzLnRleFBhcmFtZXRlcmkocy5URVhUVVJFX0NVQkVfTUFQLHMuVEVYVFVSRV9XUkFQX1Qscy5DTEFNUF9UT19FREdFKTtmb3IobGV0IG89MDtvPDY7bysrKXMudGV4SW1hZ2UyRChzLlRFWFRVUkVfQ1VCRV9NQVBfUE9TSVRJVkVfWCtvLDAsdGhpcy5fZ2V0UkdCQUJ1ZmZlckludGVybmFsU2l6ZWRGb3JtYXQoaS50eXBlLGkuZm9ybWF0KSxjLGMsMCx0aGlzLl9nZXRJbnRlcm5hbEZvcm1hdChpLmZvcm1hdCksdGhpcy5fZ2V0V2ViR0xUZXh0dXJlVHlwZShpLnR5cGUpLG51bGwpO2NvbnN0IGE9cy5jcmVhdGVGcmFtZWJ1ZmZlcigpO3JldHVybiB0aGlzLl9iaW5kVW5ib3VuZEZyYW1lYnVmZmVyKGEpLHQuX2RlcHRoU3RlbmNpbEJ1ZmZlcj10aGlzLl9zZXR1cEZyYW1lYnVmZmVyRGVwdGhBdHRhY2htZW50cyhpLmdlbmVyYXRlU3RlbmNpbEJ1ZmZlcixpLmdlbmVyYXRlRGVwdGhCdWZmZXIsYyxjKSxpLmdlbmVyYXRlTWlwTWFwcyYmcy5nZW5lcmF0ZU1pcG1hcChzLlRFWFRVUkVfQ1VCRV9NQVApLHRoaXMuX2JpbmRUZXh0dXJlRGlyZWN0bHkocy5URVhUVVJFX0NVQkVfTUFQLG51bGwpLHRoaXMuX2JpbmRVbmJvdW5kRnJhbWVidWZmZXIobnVsbCksdC5fZnJhbWVidWZmZXI9YSx0Ll9nZW5lcmF0ZURlcHRoQnVmZmVyPWkuZ2VuZXJhdGVEZXB0aEJ1ZmZlcix0Ll9nZW5lcmF0ZVN0ZW5jaWxCdWZmZXI9aS5nZW5lcmF0ZVN0ZW5jaWxCdWZmZXIsci53aWR0aD1jLHIuaGVpZ2h0PWMsci5pc1JlYWR5PSEwLHIuaXNDdWJlPSEwLHIuc2FtcGxlcz0xLHIuZ2VuZXJhdGVNaXBNYXBzPWkuZ2VuZXJhdGVNaXBNYXBzLHIuc2FtcGxpbmdNb2RlPWkuc2FtcGxpbmdNb2RlLHIudHlwZT1pLnR5cGUsci5mb3JtYXQ9aS5mb3JtYXQsdGhpcy5faW50ZXJuYWxUZXh0dXJlc0NhY2hlLnB1c2gociksdC5zZXRUZXh0dXJlcyhyKSx0fTtjb25zdCBKbj0icG9zdHByb2Nlc3NWZXJ0ZXhTaGFkZXIiLGVhPWBhdHRyaWJ1dGUgdmVjMiBwb3NpdGlvbjsKdW5pZm9ybSB2ZWMyIHNjYWxlOwp2YXJ5aW5nIHZlYzIgdlVWOwpjb25zdCB2ZWMyIG1hZGQ9dmVjMigwLjUsMC41KTsKI2RlZmluZSBDVVNUT01fVkVSVEVYX0RFRklOSVRJT05TCnZvaWQgbWFpbih2b2lkKSB7CiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9NQUlOX0JFR0lOCnZVVj0ocG9zaXRpb24qbWFkZCttYWRkKSpzY2FsZTsKZ2xfUG9zaXRpb249dmVjNChwb3NpdGlvbiwwLjAsMS4wKTsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fRU5ECn1gO1UuU2hhZGVyc1N0b3JlW0puXT1lYTtjb25zdCBXcz17cG9zaXRpb25zOlsxLDEsLTEsMSwtMSwtMSwxLC0xXSxpbmRpY2VzOlswLDEsMiwwLDIsM119O2NsYXNzIHRhe2NvbnN0cnVjdG9yKGUsdD1Xcyl7dmFyIGksczt0aGlzLl9mdWxsc2NyZWVuVmlld3BvcnQ9bmV3IEJpKDAsMCwxLDEpO2NvbnN0IHI9KGk9dC5wb3NpdGlvbnMpIT09bnVsbCYmaSE9PXZvaWQgMD9pOldzLnBvc2l0aW9ucyxuPShzPXQuaW5kaWNlcykhPT1udWxsJiZzIT09dm9pZCAwP3M6V3MuaW5kaWNlczt0aGlzLmVuZ2luZT1lLHRoaXMuX3ZlcnRleEJ1ZmZlcnM9e1tnLlBvc2l0aW9uS2luZF06bmV3IGcoZSxyLGcuUG9zaXRpb25LaW5kLCExLCExLDIpfSx0aGlzLl9pbmRleEJ1ZmZlcj1lLmNyZWF0ZUluZGV4QnVmZmVyKG4pLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9ZS5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUuYWRkKCgpPT57dGhpcy5faW5kZXhCdWZmZXI9ZS5jcmVhdGVJbmRleEJ1ZmZlcihuKTtmb3IoY29uc3QgYSBpbiB0aGlzLl92ZXJ0ZXhCdWZmZXJzKXRoaXMuX3ZlcnRleEJ1ZmZlcnNbYV0uX3JlYnVpbGQoKX0pfXNldFZpZXdwb3J0KGU9dGhpcy5fZnVsbHNjcmVlblZpZXdwb3J0KXt0aGlzLmVuZ2luZS5zZXRWaWV3cG9ydChlKX1iaW5kQnVmZmVycyhlKXt0aGlzLmVuZ2luZS5iaW5kQnVmZmVycyh0aGlzLl92ZXJ0ZXhCdWZmZXJzLHRoaXMuX2luZGV4QnVmZmVyLGUpfWFwcGx5RWZmZWN0V3JhcHBlcihlKXt0aGlzLmVuZ2luZS5zZXRTdGF0ZSghMCksdGhpcy5lbmdpbmUuZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0PSExLHRoaXMuZW5naW5lLnN0ZW5jaWxTdGF0ZS5zdGVuY2lsVGVzdD0hMSx0aGlzLmVuZ2luZS5lbmFibGVFZmZlY3QoZS5fZHJhd1dyYXBwZXIpLHRoaXMuYmluZEJ1ZmZlcnMoZS5lZmZlY3QpLGUub25BcHBseU9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHt9KX1yZXN0b3JlU3RhdGVzKCl7dGhpcy5lbmdpbmUuZGVwdGhDdWxsaW5nU3RhdGUuZGVwdGhUZXN0PSEwLHRoaXMuZW5naW5lLnN0ZW5jaWxTdGF0ZS5zdGVuY2lsVGVzdD0hMH1kcmF3KCl7dGhpcy5lbmdpbmUuZHJhd0VsZW1lbnRzVHlwZSgwLDAsNil9X2lzUmVuZGVyVGFyZ2V0VGV4dHVyZShlKXtyZXR1cm4gZS5yZW5kZXJUYXJnZXQhPT12b2lkIDB9cmVuZGVyKGUsdD1udWxsKXtpZighZS5lZmZlY3QuaXNSZWFkeSgpKXJldHVybjt0aGlzLnNldFZpZXdwb3J0KCk7Y29uc3QgaT10PT09bnVsbD9udWxsOnRoaXMuX2lzUmVuZGVyVGFyZ2V0VGV4dHVyZSh0KT90LnJlbmRlclRhcmdldDp0O2kmJnRoaXMuZW5naW5lLmJpbmRGcmFtZWJ1ZmZlcihpKSx0aGlzLmFwcGx5RWZmZWN0V3JhcHBlcihlKSx0aGlzLmRyYXcoKSxpJiZ0aGlzLmVuZ2luZS51bkJpbmRGcmFtZWJ1ZmZlcihpKSx0aGlzLnJlc3RvcmVTdGF0ZXMoKX1kaXNwb3NlKCl7Y29uc3QgZT10aGlzLl92ZXJ0ZXhCdWZmZXJzW2cuUG9zaXRpb25LaW5kXTtlJiYoZS5kaXNwb3NlKCksZGVsZXRlIHRoaXMuX3ZlcnRleEJ1ZmZlcnNbZy5Qb3NpdGlvbktpbmRdKSx0aGlzLl9pbmRleEJ1ZmZlciYmdGhpcy5lbmdpbmUuX3JlbGVhc2VCdWZmZXIodGhpcy5faW5kZXhCdWZmZXIpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXImJih0aGlzLmVuZ2luZS5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXIpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9bnVsbCl9fWNsYXNzIGlhe2NvbnN0cnVjdG9yKGUpe3RoaXMub25BcHBseU9ic2VydmFibGU9bmV3IEY7bGV0IHQ7Y29uc3QgaT1lLnVuaWZvcm1OYW1lc3x8W107ZS52ZXJ0ZXhTaGFkZXI/dD17ZnJhZ21lbnRTb3VyY2U6ZS5mcmFnbWVudFNoYWRlcix2ZXJ0ZXhTb3VyY2U6ZS52ZXJ0ZXhTaGFkZXIsc3BlY3Rvck5hbWU6ZS5uYW1lfHwiZWZmZWN0V3JhcHBlciJ9OihpLnB1c2goInNjYWxlIiksdD17ZnJhZ21lbnRTb3VyY2U6ZS5mcmFnbWVudFNoYWRlcix2ZXJ0ZXg6InBvc3Rwcm9jZXNzIixzcGVjdG9yTmFtZTplLm5hbWV8fCJlZmZlY3RXcmFwcGVyIn0sdGhpcy5vbkFwcGx5T2JzZXJ2YWJsZS5hZGQoKCk9Pnt0aGlzLmVmZmVjdC5zZXRGbG9hdDIoInNjYWxlIiwxLDEpfSkpO2NvbnN0IHM9ZS5kZWZpbmVzP2UuZGVmaW5lcy5qb2luKGAKYCk6IiI7dGhpcy5fZHJhd1dyYXBwZXI9bmV3IG1pKGUuZW5naW5lKSxlLnVzZVNoYWRlclN0b3JlPyh0LmZyYWdtZW50PXQuZnJhZ21lbnRTb3VyY2UsdC52ZXJ0ZXh8fCh0LnZlcnRleD10LnZlcnRleFNvdXJjZSksZGVsZXRlIHQuZnJhZ21lbnRTb3VyY2UsZGVsZXRlIHQudmVydGV4U291cmNlLHRoaXMuZWZmZWN0PWUuZW5naW5lLmNyZWF0ZUVmZmVjdCh0LGUuYXR0cmlidXRlTmFtZXN8fFsicG9zaXRpb24iXSxpLGUuc2FtcGxlck5hbWVzLHMsdm9pZCAwLGUub25Db21waWxlZCx2b2lkIDAsdm9pZCAwLGUuc2hhZGVyTGFuZ3VhZ2UpKToodGhpcy5lZmZlY3Q9bmV3IFBlKHQsZS5hdHRyaWJ1dGVOYW1lc3x8WyJwb3NpdGlvbiJdLGksZS5zYW1wbGVyTmFtZXMsZS5lbmdpbmUscyx2b2lkIDAsZS5vbkNvbXBpbGVkLHZvaWQgMCx2b2lkIDAsdm9pZCAwLGUuc2hhZGVyTGFuZ3VhZ2UpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9ZS5lbmdpbmUub25Db250ZXh0UmVzdG9yZWRPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuZWZmZWN0Ll9waXBlbGluZUNvbnRleHQ9bnVsbCx0aGlzLmVmZmVjdC5fd2FzUHJldmlvdXNseVJlYWR5PSExLHRoaXMuZWZmZWN0Ll9wcmVwYXJlRWZmZWN0KCl9KSl9Z2V0IGVmZmVjdCgpe3JldHVybiB0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3R9c2V0IGVmZmVjdChlKXt0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3Q9ZX1kaXNwb3NlKCl7dGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlciYmKHRoaXMuZWZmZWN0LmdldEVuZ2luZSgpLm9uQ29udGV4dFJlc3RvcmVkT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlciksdGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlcj1udWxsKSx0aGlzLmVmZmVjdC5kaXNwb3NlKCl9fWNvbnN0IHdyPSJwYXNzUGl4ZWxTaGFkZXIiLE9yPWB2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIAp7CmdsX0ZyYWdDb2xvcj10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsdlVWKTsKfWA7VS5TaGFkZXJzU3RvcmVbd3JdPU9yO2NvbnN0IExyPXtuYW1lOndyLHNoYWRlcjpPcn07Y2xhc3MgdHR7c3RhdGljIF9DcmVhdGVEdW1wUmVuZGVyZXIoKXtpZighdHQuX0R1bXBUb29sc0VuZ2luZSl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKSx0PW5ldyBvZShlLCExLHtwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6ITAsZGVwdGg6ITEsc3RlbmNpbDohMSxhbHBoYTohMCxwcmVtdWx0aXBsaWVkQWxwaGE6ITEsYW50aWFsaWFzOiExLGZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQ6ITF9KTt0LmdldENhcHMoKS5wYXJhbGxlbFNoYWRlckNvbXBpbGU9dm9pZCAwO2NvbnN0IGk9bmV3IHRhKHQpLHM9bmV3IGlhKHtlbmdpbmU6dCxuYW1lOkxyLm5hbWUsZnJhZ21lbnRTaGFkZXI6THIuc2hhZGVyLHNhbXBsZXJOYW1lczpbInRleHR1cmVTYW1wbGVyIl19KTt0dC5fRHVtcFRvb2xzRW5naW5lPXtjYW52YXM6ZSxlbmdpbmU6dCxyZW5kZXJlcjppLHdyYXBwZXI6c319cmV0dXJuIHR0Ll9EdW1wVG9vbHNFbmdpbmV9c3RhdGljIGFzeW5jIER1bXBGcmFtZWJ1ZmZlcihlLHQsaSxzLHI9ImltYWdlL3BuZyIsbil7Y29uc3QgYT1hd2FpdCBpLnJlYWRQaXhlbHMoMCwwLGUsdCksbz1uZXcgVWludDhBcnJheShhLmJ1ZmZlcik7dHQuRHVtcERhdGEoZSx0LG8scyxyLG4sITApfXN0YXRpYyBEdW1wRGF0YUFzeW5jKGUsdCxpLHM9ImltYWdlL3BuZyIscixuPSExLGE9ITEsbyl7cmV0dXJuIG5ldyBQcm9taXNlKGg9Pnt0dC5EdW1wRGF0YShlLHQsaSxsPT5oKGwpLHMscixuLGEsbyl9KX1zdGF0aWMgRHVtcERhdGEoZSx0LGkscyxyPSJpbWFnZS9wbmciLG4sYT0hMSxvPSExLGgpe2NvbnN0IGw9dHQuX0NyZWF0ZUR1bXBSZW5kZXJlcigpO2lmKGwuZW5naW5lLnNldFNpemUoZSx0LCEwKSxpIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXtjb25zdCBkPW5ldyBVaW50OEFycmF5KGkubGVuZ3RoKTtsZXQgZj1pLmxlbmd0aDtmb3IoO2YtLTspe2NvbnN0IF89aVtmXTtkW2ZdPV88MD8wOl8+MT8xOk1hdGgucm91bmQoXyoyNTUpfWk9ZH1jb25zdCB1PWwuZW5naW5lLmNyZWF0ZVJhd1RleHR1cmUoaSxlLHQsNSwhMSwhYSwxKTtsLnJlbmRlcmVyLnNldFZpZXdwb3J0KCksbC5yZW5kZXJlci5hcHBseUVmZmVjdFdyYXBwZXIobC53cmFwcGVyKSxsLndyYXBwZXIuZWZmZWN0Ll9iaW5kVGV4dHVyZSgidGV4dHVyZVNhbXBsZXIiLHUpLGwucmVuZGVyZXIuZHJhdygpLG8/SC5Ub0Jsb2IobC5jYW52YXMsZD0+e2NvbnN0IGY9bmV3IEZpbGVSZWFkZXI7Zi5vbmxvYWQ9Xz0+e2NvbnN0IEU9Xy50YXJnZXQucmVzdWx0O3MmJnMoRSl9LGYucmVhZEFzQXJyYXlCdWZmZXIoZCl9LHIsaCk6SC5FbmNvZGVTY3JlZW5zaG90Q2FudmFzRGF0YShsLmNhbnZhcyxzLHIsbixoKSx1LmRpc3Bvc2UoKX1zdGF0aWMgRGlzcG9zZSgpe3R0Ll9EdW1wVG9vbHNFbmdpbmUmJih0dC5fRHVtcFRvb2xzRW5naW5lLndyYXBwZXIuZGlzcG9zZSgpLHR0Ll9EdW1wVG9vbHNFbmdpbmUucmVuZGVyZXIuZGlzcG9zZSgpLHR0Ll9EdW1wVG9vbHNFbmdpbmUuZW5naW5lLmRpc3Bvc2UoKSksdHQuX0R1bXBUb29sc0VuZ2luZT1udWxsfX0oKCk9PntILkR1bXBEYXRhPXR0LkR1bXBEYXRhLEguRHVtcERhdGFBc3luYz10dC5EdW1wRGF0YUFzeW5jLEguRHVtcEZyYW1lYnVmZmVyPXR0LkR1bXBGcmFtZWJ1ZmZlcn0pKCk7Y2xhc3MgX3QgZXh0ZW5kcyBOe2NvbnN0cnVjdG9yKGUsdCxpLHM9ITEscj0hMCxuPTAsYT0hMSxvPU4uVFJJTElORUFSX1NBTVBMSU5HTU9ERSxoPSEwLGw9ITEsdT0hMSxkPTUsZj0hMSxfLEUsbT0hMSx2PSExKXt2YXIgUyx5LEEsQyxiLE07bGV0IEw7aWYodHlwZW9mIHM9PSJvYmplY3QiKXtjb25zdCB3PXM7cz0hIXcuZ2VuZXJhdGVNaXBNYXBzLHI9KFM9dy5kb05vdENoYW5nZUFzcGVjdFJhdGlvKSE9PW51bGwmJlMhPT12b2lkIDA/UzohMCxuPSh5PXcudHlwZSkhPT1udWxsJiZ5IT09dm9pZCAwP3k6MCxhPSEhdy5pc0N1YmUsbz0oQT13LnNhbXBsaW5nTW9kZSkhPT1udWxsJiZBIT09dm9pZCAwP0E6Ti5UUklMSU5FQVJfU0FNUExJTkdNT0RFLGg9KEM9dy5nZW5lcmF0ZURlcHRoQnVmZmVyKSE9PW51bGwmJkMhPT12b2lkIDA/QzohMCxsPSEhdy5nZW5lcmF0ZVN0ZW5jaWxCdWZmZXIsdT0hIXcuaXNNdWx0aSxkPShiPXcuZm9ybWF0KSE9PW51bGwmJmIhPT12b2lkIDA/Yjo1LGY9ISF3LmRlbGF5QWxsb2NhdGlvbixfPXcuc2FtcGxlcyxFPXcuY3JlYXRpb25GbGFncyxtPSEhdy5ub0NvbG9yQXR0YWNobWVudCx2PSEhdy51c2VTUkdCQnVmZmVyLEw9dy5jb2xvckF0dGFjaG1lbnR9aWYoc3VwZXIobnVsbCxpLCFzLHZvaWQgMCxvLHZvaWQgMCx2b2lkIDAsdm9pZCAwLHZvaWQgMCxkKSx0aGlzLl91bk9ic2VydmVSZW5kZXJMaXN0PW51bGwsdGhpcy5fcmVuZGVyTGlzdEhhc0NoYW5nZWQ9KHcsZGUpPT57dmFyIGNlO2NvbnN0IHNlPXRoaXMuX3JlbmRlckxpc3Q/dGhpcy5fcmVuZGVyTGlzdC5sZW5ndGg6MDsoZGU9PT0wJiZzZT4wfHxzZT09PTApJiYoKGNlPXRoaXMuZ2V0U2NlbmUoKSk9PT1udWxsfHxjZT09PXZvaWQgMHx8Y2UubWVzaGVzLmZvckVhY2godGU9Pnt0ZS5fbWFya1N1Yk1lc2hlc0FzTGlnaHREaXJ0eSgpfSkpfSx0aGlzLnJlbmRlclBhcnRpY2xlcz0hMCx0aGlzLnJlbmRlclNwcml0ZXM9ITEsdGhpcy5mb3JjZUxheWVyTWFza0NoZWNrPSExLHRoaXMuaWdub3JlQ2FtZXJhVmlld3BvcnQ9ITEsdGhpcy5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BZnRlclVuYmluZE9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQ2xlYXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25SZXNpemVPYnNlcnZhYmxlPW5ldyBGLHRoaXMuX2NsZWFyZWQ9ITEsdGhpcy5za2lwSW5pdGlhbENsZWFyPSExLHRoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTEsdGhpcy5fcmVmcmVzaFJhdGU9MSx0aGlzLl9zYW1wbGVzPTEsdGhpcy5fY2FuUmVzY2FsZT0hMCx0aGlzLl9yZW5kZXJUYXJnZXQ9bnVsbCx0aGlzLmJvdW5kaW5nQm94UG9zaXRpb249cC5aZXJvKCksaT10aGlzLmdldFNjZW5lKCksIWkpcmV0dXJuO2NvbnN0IGs9dGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpO3RoaXMuX2Nvb3JkaW5hdGVzTW9kZT1OLlBST0pFQ1RJT05fTU9ERSx0aGlzLnJlbmRlckxpc3Q9bmV3IEFycmF5LHRoaXMubmFtZT1lLHRoaXMuaXNSZW5kZXJUYXJnZXQ9ITAsdGhpcy5faW5pdGlhbFNpemVQYXJhbWV0ZXI9dCx0aGlzLl9yZW5kZXJQYXNzSWRzPVtdLHRoaXMuX2lzQ3ViZURhdGE9YSx0aGlzLl9wcm9jZXNzU2l6ZVBhcmFtZXRlcih0KSx0aGlzLnJlbmRlclBhc3NJZD10aGlzLl9yZW5kZXJQYXNzSWRzWzBdLHRoaXMuX3Jlc2l6ZU9ic2VydmVyPWsub25SZXNpemVPYnNlcnZhYmxlLmFkZCgoKT0+e30pLHRoaXMuX2dlbmVyYXRlTWlwTWFwcz0hIXMsdGhpcy5fZG9Ob3RDaGFuZ2VBc3BlY3RSYXRpbz1yLHRoaXMuX3JlbmRlcmluZ01hbmFnZXI9bmV3IFdlKGkpLHRoaXMuX3JlbmRlcmluZ01hbmFnZXIuX3VzZVNjZW5lQXV0b0NsZWFyU2V0dXA9ITAsIXUmJih0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zPXtnZW5lcmF0ZU1pcE1hcHM6cyx0eXBlOm4sZm9ybWF0OihNPXRoaXMuX2Zvcm1hdCkhPT1udWxsJiZNIT09dm9pZCAwP006dm9pZCAwLHNhbXBsaW5nTW9kZTp0aGlzLnNhbXBsaW5nTW9kZSxnZW5lcmF0ZURlcHRoQnVmZmVyOmgsZ2VuZXJhdGVTdGVuY2lsQnVmZmVyOmwsc2FtcGxlczpfLGNyZWF0aW9uRmxhZ3M6RSxub0NvbG9yQXR0YWNobWVudDptLHVzZVNSR0JCdWZmZXI6dixjb2xvckF0dGFjaG1lbnQ6TH0sdGhpcy5zYW1wbGluZ01vZGU9PT1OLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYodGhpcy53cmFwVT1OLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMud3JhcFY9Ti5DTEFNUF9BRERSRVNTTU9ERSksZnx8KGE/KHRoaXMuX3JlbmRlclRhcmdldD1pLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlKHRoaXMuZ2V0UmVuZGVyU2l6ZSgpLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMpLHRoaXMuY29vcmRpbmF0ZXNNb2RlPU4uSU5WQ1VCSUNfTU9ERSx0aGlzLl90ZXh0dXJlTWF0cml4PXguSWRlbnRpdHkoKSk6dGhpcy5fcmVuZGVyVGFyZ2V0PWkuZ2V0RW5naW5lKCkuY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZSh0aGlzLl9zaXplLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMpLHRoaXMuX3RleHR1cmU9dGhpcy5fcmVuZGVyVGFyZ2V0LnRleHR1cmUsXyE9PXZvaWQgMCYmKHRoaXMuc2FtcGxlcz1fKSkpfWdldCByZW5kZXJMaXN0KCl7cmV0dXJuIHRoaXMuX3JlbmRlckxpc3R9c2V0IHJlbmRlckxpc3QoZSl7dGhpcy5fdW5PYnNlcnZlUmVuZGVyTGlzdCYmKHRoaXMuX3VuT2JzZXJ2ZVJlbmRlckxpc3QoKSx0aGlzLl91bk9ic2VydmVSZW5kZXJMaXN0PW51bGwpLGUmJih0aGlzLl91bk9ic2VydmVSZW5kZXJMaXN0PSRzKGUsdGhpcy5fcmVuZGVyTGlzdEhhc0NoYW5nZWQpKSx0aGlzLl9yZW5kZXJMaXN0PWV9Z2V0IHBvc3RQcm9jZXNzZXMoKXtyZXR1cm4gdGhpcy5fcG9zdFByb2Nlc3Nlc31nZXQgX3ByZVBhc3NFbmFibGVkKCl7cmV0dXJuISF0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0JiZ0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0LmVuYWJsZWR9c2V0IG9uQWZ0ZXJVbmJpbmQoZSl7dGhpcy5fb25BZnRlclVuYmluZE9ic2VydmVyJiZ0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyVW5iaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcj10aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmFkZChlKX1zZXQgb25CZWZvcmVSZW5kZXIoZSl7dGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQmVmb3JlUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKGUpfXNldCBvbkFmdGVyUmVuZGVyKGUpe3RoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlciYmdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyKSx0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXI9dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IG9uQ2xlYXIoZSl7dGhpcy5fb25DbGVhck9ic2VydmVyJiZ0aGlzLm9uQ2xlYXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkNsZWFyT2JzZXJ2ZXIpLHRoaXMuX29uQ2xlYXJPYnNlcnZlcj10aGlzLm9uQ2xlYXJPYnNlcnZhYmxlLmFkZChlKX1nZXQgcmVuZGVyUGFzc0lkcygpe3JldHVybiB0aGlzLl9yZW5kZXJQYXNzSWRzfWdldCBjdXJyZW50UmVmcmVzaElkKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRSZWZyZXNoSWR9c2V0TWF0ZXJpYWxGb3JSZW5kZXJpbmcoZSx0KXtsZXQgaTtBcnJheS5pc0FycmF5KGUpP2k9ZTppPVtlXTtmb3IobGV0IHM9MDtzPGkubGVuZ3RoOysrcylmb3IobGV0IHI9MDtyPHRoaXMuX3JlbmRlclBhc3NJZHMubGVuZ3RoOysrcilpW3NdLnNldE1hdGVyaWFsRm9yUmVuZGVyUGFzcyh0aGlzLl9yZW5kZXJQYXNzSWRzW3JdLHQhPT12b2lkIDA/QXJyYXkuaXNBcnJheSh0KT90W3JdOnQ6dm9pZCAwKX1nZXQgcmVuZGVyVGFyZ2V0T3B0aW9ucygpe3JldHVybiB0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zfWdldCByZW5kZXJUYXJnZXQoKXtyZXR1cm4gdGhpcy5fcmVuZGVyVGFyZ2V0fV9vblJhdGlvUmVzY2FsZSgpe3RoaXMuX3NpemVSYXRpbyYmdGhpcy5yZXNpemUodGhpcy5faW5pdGlhbFNpemVQYXJhbWV0ZXIpfXNldCBib3VuZGluZ0JveFNpemUoZSl7aWYodGhpcy5fYm91bmRpbmdCb3hTaXplJiZ0aGlzLl9ib3VuZGluZ0JveFNpemUuZXF1YWxzKGUpKXJldHVybjt0aGlzLl9ib3VuZGluZ0JveFNpemU9ZTtjb25zdCB0PXRoaXMuZ2V0U2NlbmUoKTt0JiZ0Lm1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpfWdldCBib3VuZGluZ0JveFNpemUoKXtyZXR1cm4gdGhpcy5fYm91bmRpbmdCb3hTaXplfWdldCBkZXB0aFN0ZW5jaWxUZXh0dXJlKCl7dmFyIGUsdDtyZXR1cm4odD0oZT10aGlzLl9yZW5kZXJUYXJnZXQpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5fZGVwdGhTdGVuY2lsVGV4dHVyZSkhPT1udWxsJiZ0IT09dm9pZCAwP3Q6bnVsbH1jcmVhdGVEZXB0aFN0ZW5jaWxUZXh0dXJlKGU9MCx0PSEwLGk9ITEscz0xLHI9MTQpe3ZhciBuOyhuPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxuPT09dm9pZCAwfHxuLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZSx0LGkscyxyKX1fcmVsZWFzZVJlbmRlclBhc3NJZCgpe2lmKHRoaXMuX3NjZW5lKXtjb25zdCBlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO2ZvcihsZXQgdD0wO3Q8dGhpcy5fcmVuZGVyUGFzc0lkcy5sZW5ndGg7Kyt0KWUucmVsZWFzZVJlbmRlclBhc3NJZCh0aGlzLl9yZW5kZXJQYXNzSWRzW3RdKX10aGlzLl9yZW5kZXJQYXNzSWRzPVtdfV9jcmVhdGVSZW5kZXJQYXNzSWQoKXt0aGlzLl9yZWxlYXNlUmVuZGVyUGFzc0lkKCk7Y29uc3QgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSx0PXRoaXMuX2lzQ3ViZURhdGE/Njp0aGlzLmdldFJlbmRlckxheWVycygpfHwxO2ZvcihsZXQgaT0wO2k8dDsrK2kpdGhpcy5fcmVuZGVyUGFzc0lkc1tpXT1lLmNyZWF0ZVJlbmRlclBhc3NJZChgUmVuZGVyVGFyZ2V0VGV4dHVyZSAtICR7dGhpcy5uYW1lfSMke2l9YCl9X3Byb2Nlc3NTaXplUGFyYW1ldGVyKGUpe2lmKGUucmF0aW8pe3RoaXMuX3NpemVSYXRpbz1lLnJhdGlvO2NvbnN0IHQ9dGhpcy5fZ2V0RW5naW5lKCk7dGhpcy5fc2l6ZT17d2lkdGg6dGhpcy5fYmVzdFJlZmxlY3Rpb25SZW5kZXJUYXJnZXREaW1lbnNpb24odC5nZXRSZW5kZXJXaWR0aCgpLHRoaXMuX3NpemVSYXRpbyksaGVpZ2h0OnRoaXMuX2Jlc3RSZWZsZWN0aW9uUmVuZGVyVGFyZ2V0RGltZW5zaW9uKHQuZ2V0UmVuZGVySGVpZ2h0KCksdGhpcy5fc2l6ZVJhdGlvKX19ZWxzZSB0aGlzLl9zaXplPWU7dGhpcy5fY3JlYXRlUmVuZGVyUGFzc0lkKCl9Z2V0IHNhbXBsZXMoKXt2YXIgZSx0O3JldHVybih0PShlPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxlPT09dm9pZCAwP3ZvaWQgMDplLnNhbXBsZXMpIT09bnVsbCYmdCE9PXZvaWQgMD90OnRoaXMuX3NhbXBsZXN9c2V0IHNhbXBsZXMoZSl7dGhpcy5fcmVuZGVyVGFyZ2V0JiYodGhpcy5fc2FtcGxlcz10aGlzLl9yZW5kZXJUYXJnZXQuc2V0U2FtcGxlcyhlKSl9cmVzZXRSZWZyZXNoQ291bnRlcigpe3RoaXMuX2N1cnJlbnRSZWZyZXNoSWQ9LTF9Z2V0IHJlZnJlc2hSYXRlKCl7cmV0dXJuIHRoaXMuX3JlZnJlc2hSYXRlfXNldCByZWZyZXNoUmF0ZShlKXt0aGlzLl9yZWZyZXNoUmF0ZT1lLHRoaXMucmVzZXRSZWZyZXNoQ291bnRlcigpfWFkZFBvc3RQcm9jZXNzKGUpe2lmKCF0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIpe2NvbnN0IHQ9dGhpcy5nZXRTY2VuZSgpO2lmKCF0KXJldHVybjt0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXI9bmV3IFFpKHQpLHRoaXMuX3Bvc3RQcm9jZXNzZXM9bmV3IEFycmF5fXRoaXMuX3Bvc3RQcm9jZXNzZXMucHVzaChlKSx0aGlzLl9wb3N0UHJvY2Vzc2VzWzBdLmF1dG9DbGVhcj0hMX1jbGVhclBvc3RQcm9jZXNzZXMoZT0hMSl7aWYodGhpcy5fcG9zdFByb2Nlc3Nlcyl7aWYoZSlmb3IoY29uc3QgdCBvZiB0aGlzLl9wb3N0UHJvY2Vzc2VzKXQuZGlzcG9zZSgpO3RoaXMuX3Bvc3RQcm9jZXNzZXM9W119fXJlbW92ZVBvc3RQcm9jZXNzKGUpe2lmKCF0aGlzLl9wb3N0UHJvY2Vzc2VzKXJldHVybjtjb25zdCB0PXRoaXMuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZihlKTt0IT09LTEmJih0aGlzLl9wb3N0UHJvY2Vzc2VzLnNwbGljZSh0LDEpLHRoaXMuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoPjAmJih0aGlzLl9wb3N0UHJvY2Vzc2VzWzBdLmF1dG9DbGVhcj0hMSkpfV9zaG91bGRSZW5kZXIoKXtyZXR1cm4gdGhpcy5fY3VycmVudFJlZnJlc2hJZD09PS0xPyh0aGlzLl9jdXJyZW50UmVmcmVzaElkPTEsITApOnRoaXMucmVmcmVzaFJhdGU9PT10aGlzLl9jdXJyZW50UmVmcmVzaElkPyh0aGlzLl9jdXJyZW50UmVmcmVzaElkPTEsITApOih0aGlzLl9jdXJyZW50UmVmcmVzaElkKyssITEpfWdldFJlbmRlclNpemUoKXtyZXR1cm4gdGhpcy5nZXRSZW5kZXJXaWR0aCgpfWdldFJlbmRlcldpZHRoKCl7cmV0dXJuIHRoaXMuX3NpemUud2lkdGg/dGhpcy5fc2l6ZS53aWR0aDp0aGlzLl9zaXplfWdldFJlbmRlckhlaWdodCgpe3JldHVybiB0aGlzLl9zaXplLndpZHRoP3RoaXMuX3NpemUuaGVpZ2h0OnRoaXMuX3NpemV9Z2V0UmVuZGVyTGF5ZXJzKCl7Y29uc3QgZT10aGlzLl9zaXplLmxheWVycztyZXR1cm4gZXx8MH1kaXNhYmxlUmVzY2FsaW5nKCl7dGhpcy5fY2FuUmVzY2FsZT0hMX1nZXQgY2FuUmVzY2FsZSgpe3JldHVybiB0aGlzLl9jYW5SZXNjYWxlfXNjYWxlKGUpe2NvbnN0IHQ9TWF0aC5tYXgoMSx0aGlzLmdldFJlbmRlclNpemUoKSplKTt0aGlzLnJlc2l6ZSh0KX1nZXRSZWZsZWN0aW9uVGV4dHVyZU1hdHJpeCgpe3JldHVybiB0aGlzLmlzQ3ViZT90aGlzLl90ZXh0dXJlTWF0cml4OnN1cGVyLmdldFJlZmxlY3Rpb25UZXh0dXJlTWF0cml4KCl9cmVzaXplKGUpe3ZhciB0O2NvbnN0IGk9dGhpcy5pc0N1YmU7KHQ9dGhpcy5fcmVuZGVyVGFyZ2V0KT09PW51bGx8fHQ9PT12b2lkIDB8fHQuZGlzcG9zZSgpLHRoaXMuX3JlbmRlclRhcmdldD1udWxsO2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpO3MmJih0aGlzLl9wcm9jZXNzU2l6ZVBhcmFtZXRlcihlKSxpP3RoaXMuX3JlbmRlclRhcmdldD1zLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldEN1YmVUZXh0dXJlKHRoaXMuZ2V0UmVuZGVyU2l6ZSgpLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMpOnRoaXMuX3JlbmRlclRhcmdldD1zLmdldEVuZ2luZSgpLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUodGhpcy5fc2l6ZSx0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zKSx0aGlzLl90ZXh0dXJlPXRoaXMuX3JlbmRlclRhcmdldC50ZXh0dXJlLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMuc2FtcGxlcyE9PXZvaWQgMCYmKHRoaXMuc2FtcGxlcz10aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zLnNhbXBsZXMpLHRoaXMub25SZXNpemVPYnNlcnZhYmxlLmhhc09ic2VydmVycygpJiZ0aGlzLm9uUmVzaXplT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcykpfXJlbmRlcihlPSExLHQ9ITEpe3RoaXMuX3JlbmRlcihlLHQpfWlzUmVhZHlGb3JSZW5kZXJpbmcoKXtyZXR1cm4gdGhpcy5fcmVuZGVyKCExLCExLCEwKX1fcmVuZGVyKGU9ITEsdD0hMSxpPSExKXt2YXIgcztjb25zdCByPXRoaXMuZ2V0U2NlbmUoKTtpZighcilyZXR1cm4gaTtjb25zdCBuPXIuZ2V0RW5naW5lKCk7aWYodGhpcy51c2VDYW1lcmFQb3N0UHJvY2Vzc2VzIT09dm9pZCAwJiYoZT10aGlzLnVzZUNhbWVyYVBvc3RQcm9jZXNzZXMpLHRoaXMuX3dhaXRpbmdSZW5kZXJMaXN0KXt0aGlzLnJlbmRlckxpc3Q9W107Zm9yKGxldCB1PTA7dTx0aGlzLl93YWl0aW5nUmVuZGVyTGlzdC5sZW5ndGg7dSsrKXtjb25zdCBkPXRoaXMuX3dhaXRpbmdSZW5kZXJMaXN0W3VdLGY9ci5nZXRNZXNoQnlJZChkKTtmJiZ0aGlzLnJlbmRlckxpc3QucHVzaChmKX10aGlzLl93YWl0aW5nUmVuZGVyTGlzdD12b2lkIDB9aWYodGhpcy5yZW5kZXJMaXN0UHJlZGljYXRlKXt0aGlzLnJlbmRlckxpc3Q/dGhpcy5yZW5kZXJMaXN0Lmxlbmd0aD0wOnRoaXMucmVuZGVyTGlzdD1bXTtjb25zdCB1PXRoaXMuZ2V0U2NlbmUoKTtpZighdSlyZXR1cm4gaTtjb25zdCBkPXUubWVzaGVzO2ZvcihsZXQgZj0wO2Y8ZC5sZW5ndGg7ZisrKXtjb25zdCBfPWRbZl07dGhpcy5yZW5kZXJMaXN0UHJlZGljYXRlKF8pJiZ0aGlzLnJlbmRlckxpc3QucHVzaChfKX19Y29uc3QgYT1uLmN1cnJlbnRSZW5kZXJQYXNzSWQ7dGhpcy5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKTtjb25zdCBvPShzPXRoaXMuYWN0aXZlQ2FtZXJhKSE9PW51bGwmJnMhPT12b2lkIDA/czpyLmFjdGl2ZUNhbWVyYSxoPXIuYWN0aXZlQ2FtZXJhO28mJihvIT09ci5hY3RpdmVDYW1lcmEmJihyLnNldFRyYW5zZm9ybU1hdHJpeChvLmdldFZpZXdNYXRyaXgoKSxvLmdldFByb2plY3Rpb25NYXRyaXgoITApKSxyLmFjdGl2ZUNhbWVyYT1vKSxuLnNldFZpZXdwb3J0KG8udmlld3BvcnQsdGhpcy5nZXRSZW5kZXJXaWR0aCgpLHRoaXMuZ2V0UmVuZGVySGVpZ2h0KCkpKSx0aGlzLl9kZWZhdWx0UmVuZGVyTGlzdFByZXBhcmVkPSExO2xldCBsPWk7aWYoaSl7ci5nZXRWaWV3TWF0cml4KCl8fHIudXBkYXRlVHJhbnNmb3JtTWF0cml4KCk7Y29uc3QgdT10aGlzLmlzMkRBcnJheT90aGlzLmdldFJlbmRlckxheWVycygpOnRoaXMuaXNDdWJlPzY6MTtmb3IobGV0IGQ9MDtkPHUmJmw7ZCsrKXtsZXQgZj1udWxsO2NvbnN0IF89dGhpcy5yZW5kZXJMaXN0P3RoaXMucmVuZGVyTGlzdDpyLmdldEFjdGl2ZU1lc2hlcygpLmRhdGEsRT10aGlzLnJlbmRlckxpc3Q/dGhpcy5yZW5kZXJMaXN0Lmxlbmd0aDpyLmdldEFjdGl2ZU1lc2hlcygpLmxlbmd0aDtuLmN1cnJlbnRSZW5kZXJQYXNzSWQ9dGhpcy5fcmVuZGVyUGFzc0lkc1tkXSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZCksdGhpcy5nZXRDdXN0b21SZW5kZXJMaXN0JiYoZj10aGlzLmdldEN1c3RvbVJlbmRlckxpc3QoZCxfLEUpKSxmfHwoZj1fKSx0aGlzLl9kb05vdENoYW5nZUFzcGVjdFJhdGlvfHxyLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCk7Zm9yKGxldCBtPTA7bTxmLmxlbmd0aCYmbDsrK20pe2NvbnN0IHY9ZlttXTtpZighKCF2LmlzRW5hYmxlZCgpfHx2LmlzQmxvY2tlZHx8IXYuaXNWaXNpYmxlfHwhdi5zdWJNZXNoZXMpKXtpZih0aGlzLmN1c3RvbUlzUmVhZHlGdW5jdGlvbil7aWYoIXRoaXMuY3VzdG9tSXNSZWFkeUZ1bmN0aW9uKHYsdGhpcy5yZWZyZXNoUmF0ZSxpKSl7bD0hMTtjb250aW51ZX19ZWxzZSBpZighdi5pc1JlYWR5KCEwKSl7bD0hMTtjb250aW51ZX19fXRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKGQpLCh0aGlzLmlzMkRBcnJheXx8dGhpcy5pc0N1YmUpJiYoci5pbmNyZW1lbnRSZW5kZXJJZCgpLHIucmVzZXRDYWNoZWRNYXRlcmlhbCgpKX19ZWxzZSBpZih0aGlzLmlzMkRBcnJheSlmb3IobGV0IHU9MDt1PHRoaXMuZ2V0UmVuZGVyTGF5ZXJzKCk7dSsrKXRoaXMuX3JlbmRlclRvVGFyZ2V0KDAsZSx0LHUsbyksci5pbmNyZW1lbnRSZW5kZXJJZCgpLHIucmVzZXRDYWNoZWRNYXRlcmlhbCgpO2Vsc2UgaWYodGhpcy5pc0N1YmUpZm9yKGxldCB1PTA7dTw2O3UrKyl0aGlzLl9yZW5kZXJUb1RhcmdldCh1LGUsdCx2b2lkIDAsbyksci5pbmNyZW1lbnRSZW5kZXJJZCgpLHIucmVzZXRDYWNoZWRNYXRlcmlhbCgpO2Vsc2UgdGhpcy5fcmVuZGVyVG9UYXJnZXQoMCxlLHQsdm9pZCAwLG8pO3JldHVybiB0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzKSxuLmN1cnJlbnRSZW5kZXJQYXNzSWQ9YSxoJiYoci5hY3RpdmVDYW1lcmE9aCwoci5nZXRFbmdpbmUoKS5zY2VuZXMubGVuZ3RoPjF8fHRoaXMuYWN0aXZlQ2FtZXJhJiZ0aGlzLmFjdGl2ZUNhbWVyYSE9PXIuYWN0aXZlQ2FtZXJhKSYmci5zZXRUcmFuc2Zvcm1NYXRyaXgoci5hY3RpdmVDYW1lcmEuZ2V0Vmlld01hdHJpeCgpLHIuYWN0aXZlQ2FtZXJhLmdldFByb2plY3Rpb25NYXRyaXgoITApKSxuLnNldFZpZXdwb3J0KHIuYWN0aXZlQ2FtZXJhLnZpZXdwb3J0KSksci5yZXNldENhY2hlZE1hdGVyaWFsKCksbH1fYmVzdFJlZmxlY3Rpb25SZW5kZXJUYXJnZXREaW1lbnNpb24oZSx0KXtjb25zdCBzPWUqdCxyPUkuTmVhcmVzdFBPVChzKzEyOCoxMjgvKDEyOCtzKSk7cmV0dXJuIE1hdGgubWluKEkuRmxvb3JQT1QoZSkscil9X3ByZXBhcmVSZW5kZXJpbmdNYW5hZ2VyKGUsdCxpLHMpe2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpO2lmKCFyKXJldHVybjt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlc2V0KCk7Y29uc3Qgbj1yLmdldFJlbmRlcklkKCk7Zm9yKGxldCBhPTA7YTx0O2ErKyl7Y29uc3Qgbz1lW2FdO2lmKG8mJiFvLmlzQmxvY2tlZCl7aWYodGhpcy5jdXN0b21Jc1JlYWR5RnVuY3Rpb24pe2lmKCF0aGlzLmN1c3RvbUlzUmVhZHlGdW5jdGlvbihvLHRoaXMucmVmcmVzaFJhdGUsITEpKXt0aGlzLnJlc2V0UmVmcmVzaENvdW50ZXIoKTtjb250aW51ZX19ZWxzZSBpZighby5pc1JlYWR5KHRoaXMucmVmcmVzaFJhdGU9PT0wKSl7dGhpcy5yZXNldFJlZnJlc2hDb3VudGVyKCk7Y29udGludWV9aWYoIW8uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0RJc1VwVG9EYXRlJiZyLmFjdGl2ZUNhbWVyYSYmKG8uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0Q9ci5jdXN0b21MT0RTZWxlY3Rvcj9yLmN1c3RvbUxPRFNlbGVjdG9yKG8sdGhpcy5hY3RpdmVDYW1lcmF8fHIuYWN0aXZlQ2FtZXJhKTpvLmdldExPRCh0aGlzLmFjdGl2ZUNhbWVyYXx8ci5hY3RpdmVDYW1lcmEpLG8uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2N1cnJlbnRMT0RJc1VwVG9EYXRlPSEwKSwhby5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fY3VycmVudExPRCljb250aW51ZTtsZXQgaD1vLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9jdXJyZW50TE9EO2guX3ByZUFjdGl2YXRlRm9ySW50ZXJtZWRpYXRlUmVuZGVyaW5nKG4pO2xldCBsO2lmKHMmJmk/bD0oby5sYXllck1hc2smaS5sYXllck1hc2spPT09MDpsPSExLG8uaXNFbmFibGVkKCkmJm8uaXNWaXNpYmxlJiZvLnN1Yk1lc2hlcyYmIWwmJihoIT09byYmaC5fYWN0aXZhdGUobiwhMCksby5fYWN0aXZhdGUobiwhMCkmJm8uc3ViTWVzaGVzLmxlbmd0aCkpe28uaXNBbkluc3RhbmNlP28uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2FjdEFzUmVndWxhck1lc2gmJihoPW8pOmguX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX29ubHlGb3JJbnN0YW5jZXNJbnRlcm1lZGlhdGU9ITEsaC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faXNBY3RpdmVJbnRlcm1lZGlhdGU9ITA7Zm9yKGxldCB1PTA7dTxoLnN1Yk1lc2hlcy5sZW5ndGg7dSsrKXtjb25zdCBkPWguc3ViTWVzaGVzW3VdO3RoaXMuX3JlbmRlcmluZ01hbmFnZXIuZGlzcGF0Y2goZCxoKX19fX1mb3IobGV0IGE9MDthPHIucGFydGljbGVTeXN0ZW1zLmxlbmd0aDthKyspe2NvbnN0IG89ci5wYXJ0aWNsZVN5c3RlbXNbYV0saD1vLmVtaXR0ZXI7IW8uaXNTdGFydGVkKCl8fCFofHwhaC5wb3NpdGlvbnx8IWguaXNFbmFibGVkKCl8fGUuaW5kZXhPZihoKT49MCYmdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5kaXNwYXRjaFBhcnRpY2xlcyhvKX19X2JpbmRGcmFtZUJ1ZmZlcihlPTAsdD0wKXtjb25zdCBpPXRoaXMuZ2V0U2NlbmUoKTtpZighaSlyZXR1cm47Y29uc3Qgcz1pLmdldEVuZ2luZSgpO3RoaXMuX3JlbmRlclRhcmdldCYmcy5iaW5kRnJhbWVidWZmZXIodGhpcy5fcmVuZGVyVGFyZ2V0LHRoaXMuaXNDdWJlP2U6dm9pZCAwLHZvaWQgMCx2b2lkIDAsdGhpcy5pZ25vcmVDYW1lcmFWaWV3cG9ydCwwLHQpfV91bmJpbmRGcmFtZUJ1ZmZlcihlLHQpe3RoaXMuX3JlbmRlclRhcmdldCYmZS51bkJpbmRGcmFtZWJ1ZmZlcih0aGlzLl9yZW5kZXJUYXJnZXQsdGhpcy5pc0N1YmUsKCk9Pnt0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0KX0pfV9wcmVwYXJlRnJhbWUoZSx0LGkscyl7dGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyP3RoaXMuX3ByZVBhc3NFbmFibGVkfHx0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuX3ByZXBhcmVGcmFtZSh0aGlzLl90ZXh0dXJlLHRoaXMuX3Bvc3RQcm9jZXNzZXMpOighc3x8IWUucG9zdFByb2Nlc3NNYW5hZ2VyLl9wcmVwYXJlRnJhbWUodGhpcy5fdGV4dHVyZSkpJiZ0aGlzLl9iaW5kRnJhbWVCdWZmZXIodCxpKX1fcmVuZGVyVG9UYXJnZXQoZSx0LGkscz0wLHI9bnVsbCl7dmFyIG4sYSxvLGgsbCx1O2NvbnN0IGQ9dGhpcy5nZXRTY2VuZSgpO2lmKCFkKXJldHVybjtjb25zdCBmPWQuZ2V0RW5naW5lKCk7aWYoKG49Zi5fZGVidWdQdXNoR3JvdXApPT09bnVsbHx8bj09PXZvaWQgMHx8bi5jYWxsKGYsYHJlbmRlciB0byBmYWNlICMke2V9IGxheWVyICMke3N9YCwxKSx0aGlzLl9wcmVwYXJlRnJhbWUoZCxlLHMsdCksdGhpcy5pczJEQXJyYXk/KGYuY3VycmVudFJlbmRlclBhc3NJZD10aGlzLl9yZW5kZXJQYXNzSWRzW3NdLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhzKSk6KGYuY3VycmVudFJlbmRlclBhc3NJZD10aGlzLl9yZW5kZXJQYXNzSWRzW2VdLHRoaXMub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSksZi5zbmFwc2hvdFJlbmRlcmluZyYmZi5zbmFwc2hvdFJlbmRlcmluZ01vZGU9PT0xKXRoaXMub25DbGVhck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCk/dGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZik6dGhpcy5za2lwSW5pdGlhbENsZWFyfHxmLmNsZWFyKHRoaXMuY2xlYXJDb2xvcnx8ZC5jbGVhckNvbG9yLCEwLCEwLCEwKTtlbHNle2xldCBFPW51bGw7Y29uc3QgbT10aGlzLnJlbmRlckxpc3Q/dGhpcy5yZW5kZXJMaXN0OmQuZ2V0QWN0aXZlTWVzaGVzKCkuZGF0YSx2PXRoaXMucmVuZGVyTGlzdD90aGlzLnJlbmRlckxpc3QubGVuZ3RoOmQuZ2V0QWN0aXZlTWVzaGVzKCkubGVuZ3RoO3RoaXMuZ2V0Q3VzdG9tUmVuZGVyTGlzdCYmKEU9dGhpcy5nZXRDdXN0b21SZW5kZXJMaXN0KHRoaXMuaXMyREFycmF5P3M6ZSxtLHYpKSxFP3RoaXMuX3ByZXBhcmVSZW5kZXJpbmdNYW5hZ2VyKEUsRS5sZW5ndGgscix0aGlzLmZvcmNlTGF5ZXJNYXNrQ2hlY2spOih0aGlzLl9kZWZhdWx0UmVuZGVyTGlzdFByZXBhcmVkfHwodGhpcy5fcHJlcGFyZVJlbmRlcmluZ01hbmFnZXIobSx2LHIsIXRoaXMucmVuZGVyTGlzdHx8dGhpcy5mb3JjZUxheWVyTWFza0NoZWNrKSx0aGlzLl9kZWZhdWx0UmVuZGVyTGlzdFByZXBhcmVkPSEwKSxFPW0pO2Zvcihjb25zdCB5IG9mIGQuX2JlZm9yZVJlbmRlclRhcmdldENsZWFyU3RhZ2UpeS5hY3Rpb24odGhpcyxlLHMpO3RoaXMub25DbGVhck9ic2VydmFibGUuaGFzT2JzZXJ2ZXJzKCk/dGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMoZik6dGhpcy5za2lwSW5pdGlhbENsZWFyfHxmLmNsZWFyKHRoaXMuY2xlYXJDb2xvcnx8ZC5jbGVhckNvbG9yLCEwLCEwLCEwKSx0aGlzLl9kb05vdENoYW5nZUFzcGVjdFJhdGlvfHxkLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCghMCk7Zm9yKGNvbnN0IHkgb2YgZC5fYmVmb3JlUmVuZGVyVGFyZ2V0RHJhd1N0YWdlKXkuYWN0aW9uKHRoaXMsZSxzKTt0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLnJlbmRlcih0aGlzLmN1c3RvbVJlbmRlckZ1bmN0aW9uLEUsdGhpcy5yZW5kZXJQYXJ0aWNsZXMsdGhpcy5yZW5kZXJTcHJpdGVzKTtmb3IoY29uc3QgeSBvZiBkLl9hZnRlclJlbmRlclRhcmdldERyYXdTdGFnZSl5LmFjdGlvbih0aGlzLGUscyk7Y29uc3QgUz0obz0oYT10aGlzLl90ZXh0dXJlKT09PW51bGx8fGE9PT12b2lkIDA/dm9pZCAwOmEuZ2VuZXJhdGVNaXBNYXBzKSE9PW51bGwmJm8hPT12b2lkIDA/bzohMTt0aGlzLl90ZXh0dXJlJiYodGhpcy5fdGV4dHVyZS5nZW5lcmF0ZU1pcE1hcHM9ITEpLHRoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlcj90aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuX2ZpbmFsaXplRnJhbWUoITEsKGg9dGhpcy5fcmVuZGVyVGFyZ2V0KSE9PW51bGwmJmghPT12b2lkIDA/aDp2b2lkIDAsZSx0aGlzLl9wb3N0UHJvY2Vzc2VzLHRoaXMuaWdub3JlQ2FtZXJhVmlld3BvcnQpOnQmJmQucG9zdFByb2Nlc3NNYW5hZ2VyLl9maW5hbGl6ZUZyYW1lKCExLChsPXRoaXMuX3JlbmRlclRhcmdldCkhPT1udWxsJiZsIT09dm9pZCAwP2w6dm9pZCAwLGUpO2Zvcihjb25zdCB5IG9mIGQuX2FmdGVyUmVuZGVyVGFyZ2V0UG9zdFByb2Nlc3NTdGFnZSl5LmFjdGlvbih0aGlzLGUscyk7dGhpcy5fdGV4dHVyZSYmKHRoaXMuX3RleHR1cmUuZ2VuZXJhdGVNaXBNYXBzPVMpLHRoaXMuX2RvTm90Q2hhbmdlQXNwZWN0UmF0aW98fGQudXBkYXRlVHJhbnNmb3JtTWF0cml4KCEwKSxpJiZ0dC5EdW1wRnJhbWVidWZmZXIodGhpcy5nZXRSZW5kZXJXaWR0aCgpLHRoaXMuZ2V0UmVuZGVySGVpZ2h0KCksZil9dGhpcy5fdW5iaW5kRnJhbWVCdWZmZXIoZixlKSx0aGlzLl90ZXh0dXJlJiZ0aGlzLmlzQ3ViZSYmZT09PTUmJmYuZ2VuZXJhdGVNaXBNYXBzRm9yQ3ViZW1hcCh0aGlzLl90ZXh0dXJlKSwodT1mLl9kZWJ1Z1BvcEdyb3VwKT09PW51bGx8fHU9PT12b2lkIDB8fHUuY2FsbChmLDEpfXNldFJlbmRlcmluZ09yZGVyKGUsdD1udWxsLGk9bnVsbCxzPW51bGwpe3RoaXMuX3JlbmRlcmluZ01hbmFnZXIuc2V0UmVuZGVyaW5nT3JkZXIoZSx0LGkscyl9c2V0UmVuZGVyaW5nQXV0b0NsZWFyRGVwdGhTdGVuY2lsKGUsdCl7dGhpcy5fcmVuZGVyaW5nTWFuYWdlci5zZXRSZW5kZXJpbmdBdXRvQ2xlYXJEZXB0aFN0ZW5jaWwoZSx0KSx0aGlzLl9yZW5kZXJpbmdNYW5hZ2VyLl91c2VTY2VuZUF1dG9DbGVhclNldHVwPSExfWNsb25lKCl7Y29uc3QgZT10aGlzLmdldFNpemUoKSx0PW5ldyBfdCh0aGlzLm5hbWUsZSx0aGlzLmdldFNjZW5lKCksdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5nZW5lcmF0ZU1pcE1hcHMsdGhpcy5fZG9Ob3RDaGFuZ2VBc3BlY3RSYXRpbyx0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zLnR5cGUsdGhpcy5pc0N1YmUsdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5zYW1wbGluZ01vZGUsdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5nZW5lcmF0ZURlcHRoQnVmZmVyLHRoaXMuX3JlbmRlclRhcmdldE9wdGlvbnMuZ2VuZXJhdGVTdGVuY2lsQnVmZmVyLHZvaWQgMCx0aGlzLl9yZW5kZXJUYXJnZXRPcHRpb25zLmZvcm1hdCx2b2lkIDAsdGhpcy5fcmVuZGVyVGFyZ2V0T3B0aW9ucy5zYW1wbGVzKTtyZXR1cm4gdC5oYXNBbHBoYT10aGlzLmhhc0FscGhhLHQubGV2ZWw9dGhpcy5sZXZlbCx0LmNvb3JkaW5hdGVzTW9kZT10aGlzLmNvb3JkaW5hdGVzTW9kZSx0aGlzLnJlbmRlckxpc3QmJih0LnJlbmRlckxpc3Q9dGhpcy5yZW5kZXJMaXN0LnNsaWNlKDApKSx0fXNlcmlhbGl6ZSgpe2lmKCF0aGlzLm5hbWUpcmV0dXJuIG51bGw7Y29uc3QgZT1zdXBlci5zZXJpYWxpemUoKTtpZihlLnJlbmRlclRhcmdldFNpemU9dGhpcy5nZXRSZW5kZXJTaXplKCksZS5yZW5kZXJMaXN0PVtdLHRoaXMucmVuZGVyTGlzdClmb3IobGV0IHQ9MDt0PHRoaXMucmVuZGVyTGlzdC5sZW5ndGg7dCsrKWUucmVuZGVyTGlzdC5wdXNoKHRoaXMucmVuZGVyTGlzdFt0XS5pZCk7cmV0dXJuIGV9ZGlzcG9zZUZyYW1lYnVmZmVyT2JqZWN0cygpe3ZhciBlOyhlPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmRpc3Bvc2UoITApfXJlbGVhc2VJbnRlcm5hbFRleHR1cmUoKXt2YXIgZTsoZT10aGlzLl9yZW5kZXJUYXJnZXQpPT09bnVsbHx8ZT09PXZvaWQgMHx8ZS5yZWxlYXNlVGV4dHVyZXMoKSx0aGlzLl90ZXh0dXJlPW51bGx9ZGlzcG9zZSgpe3ZhciBlO3RoaXMub25SZXNpemVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkNsZWFyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclJlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuY2xlYXIoKSx0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXImJih0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlcj1udWxsKSx0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0JiZ0aGlzLl9wcmVQYXNzUmVuZGVyVGFyZ2V0LmRpc3Bvc2UoKSx0aGlzLl9yZWxlYXNlUmVuZGVyUGFzc0lkKCksdGhpcy5jbGVhclBvc3RQcm9jZXNzZXMoITApLHRoaXMuX3Jlc2l6ZU9ic2VydmVyJiYodGhpcy5nZXRTY2VuZSgpLmdldEVuZ2luZSgpLm9uUmVzaXplT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fcmVzaXplT2JzZXJ2ZXIpLHRoaXMuX3Jlc2l6ZU9ic2VydmVyPW51bGwpLHRoaXMucmVuZGVyTGlzdD1udWxsO2NvbnN0IHQ9dGhpcy5nZXRTY2VuZSgpO2lmKCF0KXJldHVybjtsZXQgaT10LmN1c3RvbVJlbmRlclRhcmdldHMuaW5kZXhPZih0aGlzKTtpPj0wJiZ0LmN1c3RvbVJlbmRlclRhcmdldHMuc3BsaWNlKGksMSk7Zm9yKGNvbnN0IHMgb2YgdC5jYW1lcmFzKWk9cy5jdXN0b21SZW5kZXJUYXJnZXRzLmluZGV4T2YodGhpcyksaT49MCYmcy5jdXN0b21SZW5kZXJUYXJnZXRzLnNwbGljZShpLDEpOyhlPXRoaXMuX3JlbmRlclRhcmdldCk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmRpc3Bvc2UoKSx0aGlzLl9yZW5kZXJUYXJnZXQ9bnVsbCx0aGlzLl90ZXh0dXJlPW51bGwsc3VwZXIuZGlzcG9zZSgpfV9yZWJ1aWxkKCl7dGhpcy5yZWZyZXNoUmF0ZT09PV90LlJFRlJFU0hSQVRFX1JFTkRFUl9PTkNFJiYodGhpcy5yZWZyZXNoUmF0ZT1fdC5SRUZSRVNIUkFURV9SRU5ERVJfT05DRSksdGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyJiZ0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuX3JlYnVpbGQoKX1mcmVlUmVuZGVyaW5nR3JvdXBzKCl7dGhpcy5fcmVuZGVyaW5nTWFuYWdlciYmdGhpcy5fcmVuZGVyaW5nTWFuYWdlci5mcmVlUmVuZGVyaW5nR3JvdXBzKCl9Z2V0Vmlld0NvdW50KCl7cmV0dXJuIDF9fV90LlJFRlJFU0hSQVRFX1JFTkRFUl9PTkNFPTAsX3QuUkVGUkVTSFJBVEVfUkVOREVSX09ORVZFUllGUkFNRT0xLF90LlJFRlJFU0hSQVRFX1JFTkRFUl9PTkVWRVJZVFdPRlJBTUVTPTIsTi5fQ3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZT0oYyxlLHQsaSxzKT0+bmV3IF90KGMsZSx0LGkpO2NsYXNzIE1le2NvbnN0cnVjdG9yKGUsdCxpLHMscixuLGE9MSxvLGgsbD1udWxsLHU9MCxkPSJwb3N0cHJvY2VzcyIsZixfPSExLEU9NSxtPVplLkdMU0wpe3RoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsLHRoaXMud2lkdGg9LTEsdGhpcy5oZWlnaHQ9LTEsdGhpcy5ub2RlTWF0ZXJpYWxTb3VyY2U9bnVsbCx0aGlzLl9vdXRwdXRUZXh0dXJlPW51bGwsdGhpcy5hdXRvQ2xlYXI9ITAsdGhpcy5hbHBoYU1vZGU9MCx0aGlzLmFuaW1hdGlvbnM9bmV3IEFycmF5LHRoaXMuZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZT0hMSx0aGlzLmZvcmNlRnVsbHNjcmVlblZpZXdwb3J0PSEwLHRoaXMuc2NhbGVNb2RlPTEsdGhpcy5hbHdheXNGb3JjZVBPVD0hMSx0aGlzLl9zYW1wbGVzPTEsdGhpcy5hZGFwdFNjYWxlVG9DdXJyZW50Vmlld3BvcnQ9ITEsdGhpcy5fcmV1c2FibGU9ITEsdGhpcy5fcmVuZGVySWQ9MCx0aGlzLmV4dGVybmFsVGV4dHVyZVNhbXBsZXJCaW5kaW5nPSExLHRoaXMuX3RleHR1cmVzPW5ldyAkZSgyKSx0aGlzLl90ZXh0dXJlQ2FjaGU9W10sdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmQ9MCx0aGlzLl9zY2FsZVJhdGlvPW5ldyB2ZSgxLDEpLHRoaXMuX3RleGVsU2l6ZT12ZS5aZXJvKCksdGhpcy5vbkFjdGl2YXRlT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25BcHBseU9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkJlZm9yZVJlbmRlck9ic2VydmFibGU9bmV3IEYsdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm5hbWU9ZSxuIT1udWxsPyh0aGlzLl9jYW1lcmE9bix0aGlzLl9zY2VuZT1uLmdldFNjZW5lKCksbi5hdHRhY2hQb3N0UHJvY2Vzcyh0aGlzKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCksdGhpcy5fc2NlbmUucG9zdFByb2Nlc3Nlcy5wdXNoKHRoaXMpLHRoaXMudW5pcXVlSWQ9dGhpcy5fc2NlbmUuZ2V0VW5pcXVlSWQoKSk6byYmKHRoaXMuX2VuZ2luZT1vLHRoaXMuX2VuZ2luZS5wb3N0UHJvY2Vzc2VzLnB1c2godGhpcykpLHRoaXMuX29wdGlvbnM9cix0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZT1hfHwxLHRoaXMuX3JldXNhYmxlPWh8fCExLHRoaXMuX3RleHR1cmVUeXBlPXUsdGhpcy5fdGV4dHVyZUZvcm1hdD1FLHRoaXMuX3NoYWRlckxhbmd1YWdlPW0sdGhpcy5fc2FtcGxlcnM9c3x8W10sdGhpcy5fc2FtcGxlcnMucHVzaCgidGV4dHVyZVNhbXBsZXIiKSx0aGlzLl9mcmFnbWVudFVybD10LHRoaXMuX3ZlcnRleFVybD1kLHRoaXMuX3BhcmFtZXRlcnM9aXx8W10sdGhpcy5fcGFyYW1ldGVycy5wdXNoKCJzY2FsZSIpLHRoaXMuX2luZGV4UGFyYW1ldGVycz1mLHRoaXMuX2RyYXdXcmFwcGVyPW5ldyBtaSh0aGlzLl9lbmdpbmUpLF98fHRoaXMudXBkYXRlRWZmZWN0KGwpfXN0YXRpYyBSZWdpc3RlclNoYWRlckNvZGVQcm9jZXNzaW5nKGUsdCl7aWYoIXQpe2RlbGV0ZSBNZS5fQ3VzdG9tU2hhZGVyQ29kZVByb2Nlc3NpbmdbZT8/IiJdO3JldHVybn1NZS5fQ3VzdG9tU2hhZGVyQ29kZVByb2Nlc3NpbmdbZT8/IiJdPXR9c3RhdGljIF9HZXRTaGFkZXJDb2RlUHJvY2Vzc2luZyhlKXt2YXIgdDtyZXR1cm4odD1NZS5fQ3VzdG9tU2hhZGVyQ29kZVByb2Nlc3NpbmdbZV0pIT09bnVsbCYmdCE9PXZvaWQgMD90Ok1lLl9DdXN0b21TaGFkZXJDb2RlUHJvY2Vzc2luZ1siIl19Z2V0IHNhbXBsZXMoKXtyZXR1cm4gdGhpcy5fc2FtcGxlc31zZXQgc2FtcGxlcyhlKXt0aGlzLl9zYW1wbGVzPU1hdGgubWluKGUsdGhpcy5fZW5naW5lLmdldENhcHMoKS5tYXhNU0FBU2FtcGxlcyksdGhpcy5fdGV4dHVyZXMuZm9yRWFjaCh0PT57dC5zZXRTYW1wbGVzKHRoaXMuX3NhbXBsZXMpfSl9Z2V0RWZmZWN0TmFtZSgpe3JldHVybiB0aGlzLl9mcmFnbWVudFVybH1zZXQgb25BY3RpdmF0ZShlKXt0aGlzLl9vbkFjdGl2YXRlT2JzZXJ2ZXImJnRoaXMub25BY3RpdmF0ZU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQWN0aXZhdGVPYnNlcnZlciksZSYmKHRoaXMuX29uQWN0aXZhdGVPYnNlcnZlcj10aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLmFkZChlKSl9c2V0IG9uU2l6ZUNoYW5nZWQoZSl7dGhpcy5fb25TaXplQ2hhbmdlZE9ic2VydmVyJiZ0aGlzLm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vblNpemVDaGFuZ2VkT2JzZXJ2ZXIpLHRoaXMuX29uU2l6ZUNoYW5nZWRPYnNlcnZlcj10aGlzLm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlLmFkZChlKX1zZXQgb25BcHBseShlKXt0aGlzLl9vbkFwcGx5T2JzZXJ2ZXImJnRoaXMub25BcHBseU9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQXBwbHlPYnNlcnZlciksdGhpcy5fb25BcHBseU9ic2VydmVyPXRoaXMub25BcHBseU9ic2VydmFibGUuYWRkKGUpfXNldCBvbkJlZm9yZVJlbmRlcihlKXt0aGlzLl9vbkJlZm9yZVJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5yZW1vdmUodGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlciksdGhpcy5fb25CZWZvcmVSZW5kZXJPYnNlcnZlcj10aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQoZSl9c2V0IG9uQWZ0ZXJSZW5kZXIoZSl7dGhpcy5fb25BZnRlclJlbmRlck9ic2VydmVyJiZ0aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyUmVuZGVyT2JzZXJ2ZXIpLHRoaXMuX29uQWZ0ZXJSZW5kZXJPYnNlcnZlcj10aGlzLm9uQWZ0ZXJSZW5kZXJPYnNlcnZhYmxlLmFkZChlKX1nZXQgaW5wdXRUZXh0dXJlKCl7cmV0dXJuIHRoaXMuX3RleHR1cmVzLmRhdGFbdGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmRdfXNldCBpbnB1dFRleHR1cmUoZSl7dGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZT1lfXJlc3RvcmVEZWZhdWx0SW5wdXRUZXh0dXJlKCl7dGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSYmKHRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmU9bnVsbCx0aGlzLm1hcmtUZXh0dXJlRGlydHkoKSl9Z2V0Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX2NhbWVyYX1nZXQgdGV4ZWxTaXplKCl7cmV0dXJuIHRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzP3RoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzLnRleGVsU2l6ZToodGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSYmdGhpcy5fdGV4ZWxTaXplLmNvcHlGcm9tRmxvYXRzKDEvdGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZS53aWR0aCwxL3RoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUuaGVpZ2h0KSx0aGlzLl90ZXhlbFNpemUpfWdldENsYXNzTmFtZSgpe3JldHVybiJQb3N0UHJvY2VzcyJ9Z2V0RW5naW5lKCl7cmV0dXJuIHRoaXMuX2VuZ2luZX1nZXRFZmZlY3QoKXtyZXR1cm4gdGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0fXNoYXJlT3V0cHV0V2l0aChlKXtyZXR1cm4gdGhpcy5fZGlzcG9zZVRleHR1cmVzKCksdGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3M9ZSx0aGlzfXVzZU93bk91dHB1dCgpe3RoaXMuX3RleHR1cmVzLmxlbmd0aD09MCYmKHRoaXMuX3RleHR1cmVzPW5ldyAkZSgyKSksdGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3M9bnVsbH11cGRhdGVFZmZlY3QoZT1udWxsLHQ9bnVsbCxpPW51bGwscyxyLG4sYSxvKXt2YXIgaCxsO2NvbnN0IHU9TWUuX0dldFNoYWRlckNvZGVQcm9jZXNzaW5nKHRoaXMubmFtZSk7aWYodSE9bnVsbCYmdS5kZWZpbmVDdXN0b21CaW5kaW5ncyl7Y29uc3QgZD0oaD10PT1udWxsP3ZvaWQgMDp0LnNsaWNlKCkpIT09bnVsbCYmaCE9PXZvaWQgMD9oOltdO2QucHVzaCguLi50aGlzLl9wYXJhbWV0ZXJzKTtjb25zdCBmPShsPWk9PW51bGw/dm9pZCAwOmkuc2xpY2UoKSkhPT1udWxsJiZsIT09dm9pZCAwP2w6W107Zi5wdXNoKC4uLnRoaXMuX3NhbXBsZXJzKSxlPXUuZGVmaW5lQ3VzdG9tQmluZGluZ3ModGhpcy5uYW1lLGUsZCxmKSx0PWQsaT1mfXRoaXMuX3Bvc3RQcm9jZXNzRGVmaW5lcz1lLHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdD10aGlzLl9lbmdpbmUuY3JlYXRlRWZmZWN0KHt2ZXJ0ZXg6YT8/dGhpcy5fdmVydGV4VXJsLGZyYWdtZW50Om8/P3RoaXMuX2ZyYWdtZW50VXJsfSx7YXR0cmlidXRlczpbInBvc2l0aW9uIl0sdW5pZm9ybXNOYW1lczp0fHx0aGlzLl9wYXJhbWV0ZXJzLHVuaWZvcm1CdWZmZXJzTmFtZXM6W10sc2FtcGxlcnM6aXx8dGhpcy5fc2FtcGxlcnMsZGVmaW5lczplIT09bnVsbD9lOiIiLGZhbGxiYWNrczpudWxsLG9uQ29tcGlsZWQ6cj8/bnVsbCxvbkVycm9yOm4/P251bGwsaW5kZXhQYXJhbWV0ZXJzOnN8fHRoaXMuX2luZGV4UGFyYW1ldGVycyxwcm9jZXNzQ29kZUFmdGVySW5jbHVkZXM6dSE9bnVsbCYmdS5wcm9jZXNzQ29kZUFmdGVySW5jbHVkZXM/KGQsZik9PnUucHJvY2Vzc0NvZGVBZnRlckluY2x1ZGVzKHRoaXMubmFtZSxkLGYpOm51bGwscHJvY2Vzc0ZpbmFsQ29kZTp1IT1udWxsJiZ1LnByb2Nlc3NGaW5hbENvZGU/KGQsZik9PnUucHJvY2Vzc0ZpbmFsQ29kZSh0aGlzLm5hbWUsZCxmKTpudWxsLHNoYWRlckxhbmd1YWdlOnRoaXMuX3NoYWRlckxhbmd1YWdlfSx0aGlzLl9lbmdpbmUpfWlzUmV1c2FibGUoKXtyZXR1cm4gdGhpcy5fcmV1c2FibGV9bWFya1RleHR1cmVEaXJ0eSgpe3RoaXMud2lkdGg9LTF9X2NyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoZSx0LGk9MCl7Zm9yKGxldCByPTA7cjx0aGlzLl90ZXh0dXJlQ2FjaGUubGVuZ3RoO3IrKylpZih0aGlzLl90ZXh0dXJlQ2FjaGVbcl0udGV4dHVyZS53aWR0aD09PWUud2lkdGgmJnRoaXMuX3RleHR1cmVDYWNoZVtyXS50ZXh0dXJlLmhlaWdodD09PWUuaGVpZ2h0JiZ0aGlzLl90ZXh0dXJlQ2FjaGVbcl0ucG9zdFByb2Nlc3NDaGFubmVsPT09aSYmdGhpcy5fdGV4dHVyZUNhY2hlW3JdLnRleHR1cmUuX2dlbmVyYXRlRGVwdGhCdWZmZXI9PT10LmdlbmVyYXRlRGVwdGhCdWZmZXImJnRoaXMuX3RleHR1cmVDYWNoZVtyXS50ZXh0dXJlLnNhbXBsZXM9PT10LnNhbXBsZXMpcmV0dXJuIHRoaXMuX3RleHR1cmVDYWNoZVtyXS50ZXh0dXJlO2NvbnN0IHM9dGhpcy5fZW5naW5lLmNyZWF0ZVJlbmRlclRhcmdldFRleHR1cmUoZSx0KTtyZXR1cm4gdGhpcy5fdGV4dHVyZUNhY2hlLnB1c2goe3RleHR1cmU6cyxwb3N0UHJvY2Vzc0NoYW5uZWw6aSxsYXN0VXNlZFJlbmRlcklkOi0xfSksc31fZmx1c2hUZXh0dXJlQ2FjaGUoKXtjb25zdCBlPXRoaXMuX3JlbmRlcklkO2ZvcihsZXQgdD10aGlzLl90ZXh0dXJlQ2FjaGUubGVuZ3RoLTE7dD49MDt0LS0paWYoZS10aGlzLl90ZXh0dXJlQ2FjaGVbdF0ubGFzdFVzZWRSZW5kZXJJZD4xMDApe2xldCBpPSExO2ZvcihsZXQgcz0wO3M8dGhpcy5fdGV4dHVyZXMubGVuZ3RoO3MrKylpZih0aGlzLl90ZXh0dXJlcy5kYXRhW3NdPT09dGhpcy5fdGV4dHVyZUNhY2hlW3RdLnRleHR1cmUpe2k9ITA7YnJlYWt9aXx8KHRoaXMuX3RleHR1cmVDYWNoZVt0XS50ZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLl90ZXh0dXJlQ2FjaGUuc3BsaWNlKHQsMSkpfX1fcmVzaXplKGUsdCxpLHMscil7dGhpcy5fdGV4dHVyZXMubGVuZ3RoPjAmJnRoaXMuX3RleHR1cmVzLnJlc2V0KCksdGhpcy53aWR0aD1lLHRoaXMuaGVpZ2h0PXQ7bGV0IG49bnVsbDtmb3IobGV0IGg9MDtoPGkuX3Bvc3RQcm9jZXNzZXMubGVuZ3RoO2grKylpZihpLl9wb3N0UHJvY2Vzc2VzW2hdIT09bnVsbCl7bj1pLl9wb3N0UHJvY2Vzc2VzW2hdO2JyZWFrfWNvbnN0IGE9e3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fSxvPXtnZW5lcmF0ZU1pcE1hcHM6cyxnZW5lcmF0ZURlcHRoQnVmZmVyOnJ8fG49PT10aGlzLGdlbmVyYXRlU3RlbmNpbEJ1ZmZlcjoocnx8bj09PXRoaXMpJiZ0aGlzLl9lbmdpbmUuaXNTdGVuY2lsRW5hYmxlLHNhbXBsaW5nTW9kZTp0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSx0eXBlOnRoaXMuX3RleHR1cmVUeXBlLGZvcm1hdDp0aGlzLl90ZXh0dXJlRm9ybWF0LHNhbXBsZXM6dGhpcy5fc2FtcGxlc307dGhpcy5fdGV4dHVyZXMucHVzaCh0aGlzLl9jcmVhdGVSZW5kZXJUYXJnZXRUZXh0dXJlKGEsbywwKSksdGhpcy5fcmV1c2FibGUmJnRoaXMuX3RleHR1cmVzLnB1c2godGhpcy5fY3JlYXRlUmVuZGVyVGFyZ2V0VGV4dHVyZShhLG8sMSkpLHRoaXMuX3RleGVsU2l6ZS5jb3B5RnJvbUZsb2F0cygxL3RoaXMud2lkdGgsMS90aGlzLmhlaWdodCksdGhpcy5vblNpemVDaGFuZ2VkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnModGhpcyl9YWN0aXZhdGUoZSx0PW51bGwsaSl7dmFyIHMscjtlPWV8fHRoaXMuX2NhbWVyYTtjb25zdCBuPWUuZ2V0U2NlbmUoKSxhPW4uZ2V0RW5naW5lKCksbz1hLmdldENhcHMoKS5tYXhUZXh0dXJlU2l6ZTtsZXQgaD0odD90LndpZHRoOnRoaXMuX2VuZ2luZS5nZXRSZW5kZXJXaWR0aCghMCkpKnRoaXMuX29wdGlvbnN8MDtjb25zdCBsPSh0P3QuaGVpZ2h0OnRoaXMuX2VuZ2luZS5nZXRSZW5kZXJIZWlnaHQoITApKSp0aGlzLl9vcHRpb25zfDAsdT1lLnBhcmVudDt1JiYodS5sZWZ0Q2FtZXJhPT1lfHx1LnJpZ2h0Q2FtZXJhPT1lKSYmKGgvPTIpO2xldCBkPXRoaXMuX29wdGlvbnMud2lkdGh8fGgsZj10aGlzLl9vcHRpb25zLmhlaWdodHx8bDtjb25zdCBfPXRoaXMucmVuZGVyVGFyZ2V0U2FtcGxpbmdNb2RlIT09NyYmdGhpcy5yZW5kZXJUYXJnZXRTYW1wbGluZ01vZGUhPT0xJiZ0aGlzLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSE9PTI7aWYoIXRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzJiYhdGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSl7aWYodGhpcy5hZGFwdFNjYWxlVG9DdXJyZW50Vmlld3BvcnQpe2NvbnN0IG09YS5jdXJyZW50Vmlld3BvcnQ7bSYmKGQqPW0ud2lkdGgsZio9bS5oZWlnaHQpfShffHx0aGlzLmFsd2F5c0ZvcmNlUE9UKSYmKHRoaXMuX29wdGlvbnMud2lkdGh8fChkPWEubmVlZFBPVFRleHR1cmVzP0kuR2V0RXhwb25lbnRPZlR3byhkLG8sdGhpcy5zY2FsZU1vZGUpOmQpLHRoaXMuX29wdGlvbnMuaGVpZ2h0fHwoZj1hLm5lZWRQT1RUZXh0dXJlcz9JLkdldEV4cG9uZW50T2ZUd28oZixvLHRoaXMuc2NhbGVNb2RlKTpmKSksKHRoaXMud2lkdGghPT1kfHx0aGlzLmhlaWdodCE9PWYpJiZ0aGlzLl9yZXNpemUoZCxmLGUsXyxpKSx0aGlzLl90ZXh0dXJlcy5mb3JFYWNoKG09PnttLnNhbXBsZXMhPT10aGlzLnNhbXBsZXMmJnRoaXMuX2VuZ2luZS51cGRhdGVSZW5kZXJUYXJnZXRUZXh0dXJlU2FtcGxlQ291bnQobSx0aGlzLnNhbXBsZXMpfSksdGhpcy5fZmx1c2hUZXh0dXJlQ2FjaGUoKSx0aGlzLl9yZW5kZXJJZCsrfWxldCBFO2lmKHRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzKUU9dGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3MuaW5wdXRUZXh0dXJlO2Vsc2UgaWYodGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZSlFPXRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUsdGhpcy53aWR0aD10aGlzLl9mb3JjZWRPdXRwdXRUZXh0dXJlLndpZHRoLHRoaXMuaGVpZ2h0PXRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUuaGVpZ2h0O2Vsc2V7RT10aGlzLmlucHV0VGV4dHVyZTtsZXQgbTtmb3IobGV0IHY9MDt2PHRoaXMuX3RleHR1cmVDYWNoZS5sZW5ndGg7disrKWlmKHRoaXMuX3RleHR1cmVDYWNoZVt2XS50ZXh0dXJlPT09RSl7bT10aGlzLl90ZXh0dXJlQ2FjaGVbdl07YnJlYWt9bSYmKG0ubGFzdFVzZWRSZW5kZXJJZD10aGlzLl9yZW5kZXJJZCl9cmV0dXJuIHRoaXMuZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZT8odGhpcy5fc2NhbGVSYXRpby5jb3B5RnJvbUZsb2F0cyhoL2QsbC9mKSx0aGlzLl9lbmdpbmUuYmluZEZyYW1lYnVmZmVyKEUsMCxoLGwsdGhpcy5mb3JjZUZ1bGxzY3JlZW5WaWV3cG9ydCkpOih0aGlzLl9zY2FsZVJhdGlvLmNvcHlGcm9tRmxvYXRzKDEsMSksdGhpcy5fZW5naW5lLmJpbmRGcmFtZWJ1ZmZlcihFLDAsdm9pZCAwLHZvaWQgMCx0aGlzLmZvcmNlRnVsbHNjcmVlblZpZXdwb3J0KSksKHI9KHM9dGhpcy5fZW5naW5lKS5fZGVidWdJbnNlcnRNYXJrZXIpPT09bnVsbHx8cj09PXZvaWQgMHx8ci5jYWxsKHMsYHBvc3QgcHJvY2VzcyAke3RoaXMubmFtZX0gaW5wdXRgKSx0aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhlKSx0aGlzLmF1dG9DbGVhciYmdGhpcy5hbHBoYU1vZGU9PT0wJiZ0aGlzLl9lbmdpbmUuY2xlYXIodGhpcy5jbGVhckNvbG9yP3RoaXMuY2xlYXJDb2xvcjpuLmNsZWFyQ29sb3Isbi5fYWxsb3dQb3N0UHJvY2Vzc0NsZWFyQ29sb3IsITAsITApLHRoaXMuX3JldXNhYmxlJiYodGhpcy5fY3VycmVudFJlbmRlclRleHR1cmVJbmQ9KHRoaXMuX2N1cnJlbnRSZW5kZXJUZXh0dXJlSW5kKzEpJTIpLEV9Z2V0IGlzU3VwcG9ydGVkKCl7cmV0dXJuIHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdC5pc1N1cHBvcnRlZH1nZXQgYXNwZWN0UmF0aW8oKXtyZXR1cm4gdGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3M/dGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3MuYXNwZWN0UmF0aW86dGhpcy5fZm9yY2VkT3V0cHV0VGV4dHVyZT90aGlzLl9mb3JjZWRPdXRwdXRUZXh0dXJlLndpZHRoL3RoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUuaGVpZ2h0OnRoaXMud2lkdGgvdGhpcy5oZWlnaHR9aXNSZWFkeSgpe3ZhciBlLHQ7cmV0dXJuKHQ9KGU9dGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0KT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuaXNSZWFkeSgpKSE9PW51bGwmJnQhPT12b2lkIDA/dDohMX1hcHBseSgpe3ZhciBlLHQsaTtpZighKCEoKGU9dGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0KT09PW51bGx8fGU9PT12b2lkIDApJiZlLmlzUmVhZHkoKSkpcmV0dXJuIG51bGw7dGhpcy5fZW5naW5lLmVuYWJsZUVmZmVjdCh0aGlzLl9kcmF3V3JhcHBlciksdGhpcy5fZW5naW5lLnNldFN0YXRlKCExKSx0aGlzLl9lbmdpbmUuc2V0RGVwdGhCdWZmZXIoITEpLHRoaXMuX2VuZ2luZS5zZXREZXB0aFdyaXRlKCExKSx0aGlzLl9lbmdpbmUuc2V0QWxwaGFNb2RlKHRoaXMuYWxwaGFNb2RlKSx0aGlzLmFscGhhQ29uc3RhbnRzJiZ0aGlzLmdldEVuZ2luZSgpLnNldEFscGhhQ29uc3RhbnRzKHRoaXMuYWxwaGFDb25zdGFudHMucix0aGlzLmFscGhhQ29uc3RhbnRzLmcsdGhpcy5hbHBoYUNvbnN0YW50cy5iLHRoaXMuYWxwaGFDb25zdGFudHMuYSk7bGV0IHM7cmV0dXJuIHRoaXMuX3NoYXJlT3V0cHV0V2l0aFBvc3RQcm9jZXNzP3M9dGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3MuaW5wdXRUZXh0dXJlOnRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmU/cz10aGlzLl9mb3JjZWRPdXRwdXRUZXh0dXJlOnM9dGhpcy5pbnB1dFRleHR1cmUsdGhpcy5leHRlcm5hbFRleHR1cmVTYW1wbGVyQmluZGluZ3x8dGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0Ll9iaW5kVGV4dHVyZSgidGV4dHVyZVNhbXBsZXIiLHM9PW51bGw/dm9pZCAwOnMudGV4dHVyZSksdGhpcy5fZHJhd1dyYXBwZXIuZWZmZWN0LnNldFZlY3RvcjIoInNjYWxlIix0aGlzLl9zY2FsZVJhdGlvKSx0aGlzLm9uQXBwbHlPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyh0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3QpLChpPSh0PU1lLl9HZXRTaGFkZXJDb2RlUHJvY2Vzc2luZyh0aGlzLm5hbWUpKT09PW51bGx8fHQ9PT12b2lkIDA/dm9pZCAwOnQuYmluZEN1c3RvbUJpbmRpbmdzKT09PW51bGx8fGk9PT12b2lkIDB8fGkuY2FsbCh0LHRoaXMubmFtZSx0aGlzLl9kcmF3V3JhcHBlci5lZmZlY3QpLHRoaXMuX2RyYXdXcmFwcGVyLmVmZmVjdH1fZGlzcG9zZVRleHR1cmVzKCl7aWYodGhpcy5fc2hhcmVPdXRwdXRXaXRoUG9zdFByb2Nlc3N8fHRoaXMuX2ZvcmNlZE91dHB1dFRleHR1cmUpe3RoaXMuX2Rpc3Bvc2VUZXh0dXJlQ2FjaGUoKTtyZXR1cm59dGhpcy5fZGlzcG9zZVRleHR1cmVDYWNoZSgpLHRoaXMuX3RleHR1cmVzLmRpc3Bvc2UoKX1fZGlzcG9zZVRleHR1cmVDYWNoZSgpe2ZvcihsZXQgZT10aGlzLl90ZXh0dXJlQ2FjaGUubGVuZ3RoLTE7ZT49MDtlLS0pdGhpcy5fdGV4dHVyZUNhY2hlW2VdLnRleHR1cmUuZGlzcG9zZSgpO3RoaXMuX3RleHR1cmVDYWNoZS5sZW5ndGg9MH1zZXRQcmVQYXNzUmVuZGVyZXIoZSl7cmV0dXJuIHRoaXMuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uPyh0aGlzLl9wcmVQYXNzRWZmZWN0Q29uZmlndXJhdGlvbj1lLmFkZEVmZmVjdENvbmZpZ3VyYXRpb24odGhpcy5fcHJlUGFzc0VmZmVjdENvbmZpZ3VyYXRpb24pLHRoaXMuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uLmVuYWJsZWQ9ITAsITApOiExfWRpc3Bvc2UoZSl7ZT1lfHx0aGlzLl9jYW1lcmEsdGhpcy5fZGlzcG9zZVRleHR1cmVzKCk7bGV0IHQ7aWYodGhpcy5fc2NlbmUmJih0PXRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSx0IT09LTEmJnRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzZXMuc3BsaWNlKHQsMSkpLHRoaXMuX3BhcmVudENvbnRhaW5lcil7Y29uc3QgaT10aGlzLl9wYXJlbnRDb250YWluZXIucG9zdFByb2Nlc3Nlcy5pbmRleE9mKHRoaXMpO2k+LTEmJnRoaXMuX3BhcmVudENvbnRhaW5lci5wb3N0UHJvY2Vzc2VzLnNwbGljZShpLDEpLHRoaXMuX3BhcmVudENvbnRhaW5lcj1udWxsfWlmKHQ9dGhpcy5fZW5naW5lLnBvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSx0IT09LTEmJnRoaXMuX2VuZ2luZS5wb3N0UHJvY2Vzc2VzLnNwbGljZSh0LDEpLCEhZSl7aWYoZS5kZXRhY2hQb3N0UHJvY2Vzcyh0aGlzKSx0PWUuX3Bvc3RQcm9jZXNzZXMuaW5kZXhPZih0aGlzKSx0PT09MCYmZS5fcG9zdFByb2Nlc3Nlcy5sZW5ndGg+MCl7Y29uc3QgaT10aGlzLl9jYW1lcmEuX2dldEZpcnN0UG9zdFByb2Nlc3MoKTtpJiZpLm1hcmtUZXh0dXJlRGlydHkoKX10aGlzLm9uQWN0aXZhdGVPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BcHBseU9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuY2xlYXIoKX19c2VyaWFsaXplKCl7Y29uc3QgZT1hZS5TZXJpYWxpemUodGhpcyksdD10aGlzLmdldENhbWVyYSgpfHx0aGlzLl9zY2VuZSYmdGhpcy5fc2NlbmUuYWN0aXZlQ2FtZXJhO3JldHVybiBlLmN1c3RvbVR5cGU9IkJBQllMT04uIit0aGlzLmdldENsYXNzTmFtZSgpLGUuY2FtZXJhSWQ9dD90LmlkOm51bGwsZS5yZXVzYWJsZT10aGlzLl9yZXVzYWJsZSxlLnRleHR1cmVUeXBlPXRoaXMuX3RleHR1cmVUeXBlLGUuZnJhZ21lbnRVcmw9dGhpcy5fZnJhZ21lbnRVcmwsZS5wYXJhbWV0ZXJzPXRoaXMuX3BhcmFtZXRlcnMsZS5zYW1wbGVycz10aGlzLl9zYW1wbGVycyxlLm9wdGlvbnM9dGhpcy5fb3B0aW9ucyxlLmRlZmluZXM9dGhpcy5fcG9zdFByb2Nlc3NEZWZpbmVzLGUudGV4dHVyZUZvcm1hdD10aGlzLl90ZXh0dXJlRm9ybWF0LGUudmVydGV4VXJsPXRoaXMuX3ZlcnRleFVybCxlLmluZGV4UGFyYW1ldGVycz10aGlzLl9pbmRleFBhcmFtZXRlcnMsZX1jbG9uZSgpe2NvbnN0IGU9dGhpcy5zZXJpYWxpemUoKTtlLl9lbmdpbmU9dGhpcy5fZW5naW5lLGUuY2FtZXJhSWQ9bnVsbDtjb25zdCB0PU1lLlBhcnNlKGUsdGhpcy5fc2NlbmUsIiIpO3JldHVybiB0Pyh0Lm9uQWN0aXZhdGVPYnNlcnZhYmxlPXRoaXMub25BY3RpdmF0ZU9ic2VydmFibGUuY2xvbmUoKSx0Lm9uU2l6ZUNoYW5nZWRPYnNlcnZhYmxlPXRoaXMub25TaXplQ2hhbmdlZE9ic2VydmFibGUuY2xvbmUoKSx0Lm9uQXBwbHlPYnNlcnZhYmxlPXRoaXMub25BcHBseU9ic2VydmFibGUuY2xvbmUoKSx0Lm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZT10aGlzLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbG9uZSgpLHQub25BZnRlclJlbmRlck9ic2VydmFibGU9dGhpcy5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5jbG9uZSgpLHQuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uPXRoaXMuX3ByZVBhc3NFZmZlY3RDb25maWd1cmF0aW9uLHQpOm51bGx9c3RhdGljIFBhcnNlKGUsdCxpKXtjb25zdCBzPXJpKGUuY3VzdG9tVHlwZSk7aWYoIXN8fCFzLl9QYXJzZSlyZXR1cm4gbnVsbDtjb25zdCByPXQ/dC5nZXRDYW1lcmFCeUlkKGUuY2FtZXJhSWQpOm51bGw7cmV0dXJuIHMuX1BhcnNlKGUscix0LGkpfXN0YXRpYyBfUGFyc2UoZSx0LGkscyl7cmV0dXJuIGFlLlBhcnNlKCgpPT5uZXcgTWUoZS5uYW1lLGUuZnJhZ21lbnRVcmwsZS5wYXJhbWV0ZXJzLGUuc2FtcGxlcnMsZS5vcHRpb25zLHQsZS5yZW5kZXJUYXJnZXRTYW1wbGluZ01vZGUsZS5fZW5naW5lLGUucmV1c2FibGUsZS5kZWZpbmVzLGUudGV4dHVyZVR5cGUsZS52ZXJ0ZXhVcmwsZS5pbmRleFBhcmFtZXRlcnMsITEsZS50ZXh0dXJlRm9ybWF0KSxlLGkscyl9fU1lLl9DdXN0b21TaGFkZXJDb2RlUHJvY2Vzc2luZz17fSxUKFtSKCldLE1lLnByb3RvdHlwZSwidW5pcXVlSWQiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsIm5hbWUiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsIndpZHRoIix2b2lkIDApLFQoW1IoKV0sTWUucHJvdG90eXBlLCJoZWlnaHQiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsInJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSIsdm9pZCAwKSxUKFtkcigpXSxNZS5wcm90b3R5cGUsImNsZWFyQ29sb3IiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsImF1dG9DbGVhciIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiYWxwaGFNb2RlIix2b2lkIDApLFQoW1IoKV0sTWUucHJvdG90eXBlLCJhbHBoYUNvbnN0YW50cyIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiZW5hYmxlUGl4ZWxQZXJmZWN0TW9kZSIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQiLHZvaWQgMCksVChbUigpXSxNZS5wcm90b3R5cGUsInNjYWxlTW9kZSIsdm9pZCAwKSxUKFtSKCldLE1lLnByb3RvdHlwZSwiYWx3YXlzRm9yY2VQT1QiLHZvaWQgMCksVChbUigic2FtcGxlcyIpXSxNZS5wcm90b3R5cGUsIl9zYW1wbGVzIix2b2lkIDApLFQoW1IoKV0sTWUucHJvdG90eXBlLCJhZGFwdFNjYWxlVG9DdXJyZW50Vmlld3BvcnQiLHZvaWQgMCksaXQoIkJBQllMT04uUG9zdFByb2Nlc3MiLE1lKTtjb25zdCBzYT0ia2VybmVsQmx1clZhcnlpbmdEZWNsYXJhdGlvbiIscmE9InZhcnlpbmcgdmVjMiBzYW1wbGVDb29yZHtYfTsiO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbc2FdPXJhO2NvbnN0IG5hPSJwYWNraW5nRnVuY3Rpb25zIixhYT1gdmVjNCBwYWNrKGZsb2F0IGRlcHRoKQp7CmNvbnN0IHZlYzQgYml0X3NoaWZ0PXZlYzQoMjU1LjAqMjU1LjAqMjU1LjAsMjU1LjAqMjU1LjAsMjU1LjAsMS4wKTsKY29uc3QgdmVjNCBiaXRfbWFzaz12ZWM0KDAuMCwxLjAvMjU1LjAsMS4wLzI1NS4wLDEuMC8yNTUuMCk7CnZlYzQgcmVzPWZyYWN0KGRlcHRoKmJpdF9zaGlmdCk7CnJlcy09cmVzLnh4eXoqYml0X21hc2s7CnJldHVybiByZXM7Cn0KZmxvYXQgdW5wYWNrKHZlYzQgY29sb3IpCnsKY29uc3QgdmVjNCBiaXRfc2hpZnQ9dmVjNCgxLjAvKDI1NS4wKjI1NS4wKjI1NS4wKSwxLjAvKDI1NS4wKjI1NS4wKSwxLjAvMjU1LjAsMS4wKTsKcmV0dXJuIGRvdChjb2xvcixiaXRfc2hpZnQpOwp9YDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW25hXT1hYTtjb25zdCBvYT0ia2VybmVsQmx1ckZyYWdtZW50IixoYT1gI2lmZGVmIERPRgpmYWN0b3I9c2FtcGxlQ29DKHNhbXBsZUNvb3Jke1h9KTsgCmNvbXB1dGVkV2VpZ2h0PUtFUk5FTF9XRUlHSFR7WH0qZmFjdG9yOwpzdW1PZldlaWdodHMrPWNvbXB1dGVkV2VpZ2h0OwojZWxzZQpjb21wdXRlZFdlaWdodD1LRVJORUxfV0VJR0hUe1h9OwojZW5kaWYKI2lmZGVmIFBBQ0tFREZMT0FUCmJsZW5kKz11bnBhY2sodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHNhbXBsZUNvb3Jke1h9KSkqY29tcHV0ZWRXZWlnaHQ7CiNlbHNlCmJsZW5kKz10ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsc2FtcGxlQ29vcmR7WH0pKmNvbXB1dGVkV2VpZ2h0OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW29hXT1oYTtjb25zdCBsYT0ia2VybmVsQmx1ckZyYWdtZW50MiIsY2E9YCNpZmRlZiBET0YKZmFjdG9yPXNhbXBsZUNvQyhzYW1wbGVDZW50ZXIrZGVsdGEqS0VSTkVMX0RFUF9PRkZTRVR7WH0pOwpjb21wdXRlZFdlaWdodD1LRVJORUxfREVQX1dFSUdIVHtYfSpmYWN0b3I7CnN1bU9mV2VpZ2h0cys9Y29tcHV0ZWRXZWlnaHQ7CiNlbHNlCmNvbXB1dGVkV2VpZ2h0PUtFUk5FTF9ERVBfV0VJR0hUe1h9OwojZW5kaWYKI2lmZGVmIFBBQ0tFREZMT0FUCmJsZW5kKz11bnBhY2sodGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHNhbXBsZUNlbnRlcitkZWx0YSpLRVJORUxfREVQX09GRlNFVHtYfSkpKmNvbXB1dGVkV2VpZ2h0OwojZWxzZQpibGVuZCs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHNhbXBsZUNlbnRlcitkZWx0YSpLRVJORUxfREVQX09GRlNFVHtYfSkqY29tcHV0ZWRXZWlnaHQ7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbGFdPWNhO2NvbnN0IHVhPSJrZXJuZWxCbHVyUGl4ZWxTaGFkZXIiLGRhPWB1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsKdW5pZm9ybSB2ZWMyIGRlbHRhOwp2YXJ5aW5nIHZlYzIgc2FtcGxlQ2VudGVyOwojaWZkZWYgRE9GCnVuaWZvcm0gc2FtcGxlcjJEIGNpcmNsZU9mQ29uZnVzaW9uU2FtcGxlcjsKZmxvYXQgc2FtcGxlQ29DKGluIHZlYzIgb2Zmc2V0KSB7CmZsb2F0IGNvYz10ZXh0dXJlMkQoY2lyY2xlT2ZDb25mdXNpb25TYW1wbGVyLG9mZnNldCkucjsKcmV0dXJuIGNvYzsgCn0KI2VuZGlmCiNpbmNsdWRlPGtlcm5lbEJsdXJWYXJ5aW5nRGVjbGFyYXRpb24+WzAuLnZhcnlpbmdDb3VudF0KI2lmZGVmIFBBQ0tFREZMT0FUCiNpbmNsdWRlPHBhY2tpbmdGdW5jdGlvbnM+CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkKewpmbG9hdCBjb21wdXRlZFdlaWdodD0wLjA7CiNpZmRlZiBQQUNLRURGTE9BVApmbG9hdCBibGVuZD0wLjsKI2Vsc2UKdmVjNCBibGVuZD12ZWM0KDAuKTsKI2VuZGlmCiNpZmRlZiBET0YKZmxvYXQgc3VtT2ZXZWlnaHRzPUNFTlRFUl9XRUlHSFQ7IApmbG9hdCBmYWN0b3I9MC4wOwojaWZkZWYgUEFDS0VERkxPQVQKYmxlbmQrPXVucGFjayh0ZXh0dXJlMkQodGV4dHVyZVNhbXBsZXIsc2FtcGxlQ2VudGVyKSkqQ0VOVEVSX1dFSUdIVDsKI2Vsc2UKYmxlbmQrPXRleHR1cmUyRCh0ZXh0dXJlU2FtcGxlcixzYW1wbGVDZW50ZXIpKkNFTlRFUl9XRUlHSFQ7CiNlbmRpZgojZW5kaWYKI2luY2x1ZGU8a2VybmVsQmx1ckZyYWdtZW50PlswLi52YXJ5aW5nQ291bnRdCiNpbmNsdWRlPGtlcm5lbEJsdXJGcmFnbWVudDI+WzAuLmRlcENvdW50XQojaWZkZWYgUEFDS0VERkxPQVQKZ2xfRnJhZ0NvbG9yPXBhY2soYmxlbmQpOwojZWxzZQpnbF9GcmFnQ29sb3I9YmxlbmQ7CiNlbmRpZgojaWZkZWYgRE9GCmdsX0ZyYWdDb2xvci89c3VtT2ZXZWlnaHRzOwojZW5kaWYKfWA7VS5TaGFkZXJzU3RvcmVbdWFdPWRhO2NvbnN0IGZhPSJrZXJuZWxCbHVyVmVydGV4IixfYT0ic2FtcGxlQ29vcmR7WH09c2FtcGxlQ2VudGVyK2RlbHRhKktFUk5FTF9PRkZTRVR7WH07IjtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2ZhXT1fYTtjb25zdCBnYT0ia2VybmVsQmx1clZlcnRleFNoYWRlciIscGE9YGF0dHJpYnV0ZSB2ZWMyIHBvc2l0aW9uOwp1bmlmb3JtIHZlYzIgZGVsdGE7CnZhcnlpbmcgdmVjMiBzYW1wbGVDZW50ZXI7CiNpbmNsdWRlPGtlcm5lbEJsdXJWYXJ5aW5nRGVjbGFyYXRpb24+WzAuLnZhcnlpbmdDb3VudF0KY29uc3QgdmVjMiBtYWRkPXZlYzIoMC41LDAuNSk7CiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkgewojZGVmaW5lIENVU1RPTV9WRVJURVhfTUFJTl9CRUdJTgpzYW1wbGVDZW50ZXI9KHBvc2l0aW9uKm1hZGQrbWFkZCk7CiNpbmNsdWRlPGtlcm5lbEJsdXJWZXJ0ZXg+WzAuLnZhcnlpbmdDb3VudF0KZ2xfUG9zaXRpb249dmVjNChwb3NpdGlvbiwwLjAsMS4wKTsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fRU5ECn1gO1UuU2hhZGVyc1N0b3JlW2dhXT1wYTtjbGFzcyBKdCBleHRlbmRzIE1le2NvbnN0cnVjdG9yKGUsdCxpLHMscixuPU4uQklMSU5FQVJfU0FNUExJTkdNT0RFLGEsbyxoPTAsbD0iIix1PSExLGQ9NSl7c3VwZXIoZSwia2VybmVsQmx1ciIsWyJkZWx0YSIsImRpcmVjdGlvbiJdLFsiY2lyY2xlT2ZDb25mdXNpb25TYW1wbGVyIl0scyxyLG4sYSxvLG51bGwsaCwia2VybmVsQmx1ciIse3ZhcnlpbmdDb3VudDowLGRlcENvdW50OjB9LCEwLGQpLHRoaXMuX2Jsb2NrQ29tcGlsYXRpb249dSx0aGlzLl9wYWNrZWRGbG9hdD0hMSx0aGlzLl9zdGF0aWNEZWZpbmVzPSIiLHRoaXMuX3N0YXRpY0RlZmluZXM9bCx0aGlzLmRpcmVjdGlvbj10LHRoaXMub25BcHBseU9ic2VydmFibGUuYWRkKGY9Pnt0aGlzLl9vdXRwdXRUZXh0dXJlP2Yuc2V0RmxvYXQyKCJkZWx0YSIsMS90aGlzLl9vdXRwdXRUZXh0dXJlLndpZHRoKnRoaXMuZGlyZWN0aW9uLngsMS90aGlzLl9vdXRwdXRUZXh0dXJlLmhlaWdodCp0aGlzLmRpcmVjdGlvbi55KTpmLnNldEZsb2F0MigiZGVsdGEiLDEvdGhpcy53aWR0aCp0aGlzLmRpcmVjdGlvbi54LDEvdGhpcy5oZWlnaHQqdGhpcy5kaXJlY3Rpb24ueSl9KSx0aGlzLmtlcm5lbD1pfXNldCBrZXJuZWwoZSl7dGhpcy5faWRlYWxLZXJuZWwhPT1lJiYoZT1NYXRoLm1heChlLDEpLHRoaXMuX2lkZWFsS2VybmVsPWUsdGhpcy5fa2VybmVsPXRoaXMuX25lYXJlc3RCZXN0S2VybmVsKGUpLHRoaXMuX2Jsb2NrQ29tcGlsYXRpb258fHRoaXMuX3VwZGF0ZVBhcmFtZXRlcnMoKSl9Z2V0IGtlcm5lbCgpe3JldHVybiB0aGlzLl9pZGVhbEtlcm5lbH1zZXQgcGFja2VkRmxvYXQoZSl7dGhpcy5fcGFja2VkRmxvYXQhPT1lJiYodGhpcy5fcGFja2VkRmxvYXQ9ZSx0aGlzLl9ibG9ja0NvbXBpbGF0aW9ufHx0aGlzLl91cGRhdGVQYXJhbWV0ZXJzKCkpfWdldCBwYWNrZWRGbG9hdCgpe3JldHVybiB0aGlzLl9wYWNrZWRGbG9hdH1nZXRDbGFzc05hbWUoKXtyZXR1cm4iQmx1clBvc3RQcm9jZXNzIn11cGRhdGVFZmZlY3QoZT1udWxsLHQ9bnVsbCxpPW51bGwscyxyLG4pe3RoaXMuX3VwZGF0ZVBhcmFtZXRlcnMocixuKX1fdXBkYXRlUGFyYW1ldGVycyhlLHQpe2NvbnN0IGk9dGhpcy5fa2VybmVsLHM9KGktMSkvMjtsZXQgcj1bXSxuPVtdLGE9MDtmb3IobGV0IG09MDttPGk7bSsrKXtjb25zdCB2PW0vKGktMSksUz10aGlzLl9nYXVzc2lhbldlaWdodCh2KjItMSk7clttXT1tLXMsblttXT1TLGErPVN9Zm9yKGxldCBtPTA7bTxuLmxlbmd0aDttKyspblttXS89YTtjb25zdCBvPVtdLGg9W10sbD1bXTtmb3IobGV0IG09MDttPD1zO20rPTIpe2NvbnN0IHY9TWF0aC5taW4obSsxLE1hdGguZmxvb3IocykpO2lmKG09PT12KWwucHVzaCh7bzpyW21dLHc6blttXX0pO2Vsc2V7Y29uc3QgeT12PT09cyxBPW5bbV0rblt2XSooeT8uNToxKSxDPXJbbV0rMS8oMStuW21dL25bdl0pO0M9PT0wPyhsLnB1c2goe286clttXSx3Om5bbV19KSxsLnB1c2goe286clttKzFdLHc6blttKzFdfSkpOihsLnB1c2goe286Qyx3OkF9KSxsLnB1c2goe286LUMsdzpBfSkpfX1mb3IobGV0IG09MDttPGwubGVuZ3RoO20rKyloW21dPWxbbV0ubyxvW21dPWxbbV0udztyPWgsbj1vO2NvbnN0IHU9dGhpcy5nZXRFbmdpbmUoKS5nZXRDYXBzKCkubWF4VmFyeWluZ1ZlY3RvcnMsZD1NYXRoLm1heCh1LDApLTE7bGV0IGY9TWF0aC5taW4oci5sZW5ndGgsZCksXz0iIjtfKz10aGlzLl9zdGF0aWNEZWZpbmVzLHRoaXMuX3N0YXRpY0RlZmluZXMuaW5kZXhPZigiRE9GIikhPS0xJiYoXys9YCNkZWZpbmUgQ0VOVEVSX1dFSUdIVCAke3RoaXMuX2dsc2xGbG9hdChuW2YtMV0pfVxyCmAsZi0tKTtmb3IobGV0IG09MDttPGY7bSsrKV8rPWAjZGVmaW5lIEtFUk5FTF9PRkZTRVQke219ICR7dGhpcy5fZ2xzbEZsb2F0KHJbbV0pfVxyCmAsXys9YCNkZWZpbmUgS0VSTkVMX1dFSUdIVCR7bX0gJHt0aGlzLl9nbHNsRmxvYXQoblttXSl9XHIKYDtsZXQgRT0wO2ZvcihsZXQgbT1kO208ci5sZW5ndGg7bSsrKV8rPWAjZGVmaW5lIEtFUk5FTF9ERVBfT0ZGU0VUJHtFfSAke3RoaXMuX2dsc2xGbG9hdChyW21dKX1ccgpgLF8rPWAjZGVmaW5lIEtFUk5FTF9ERVBfV0VJR0hUJHtFfSAke3RoaXMuX2dsc2xGbG9hdChuW21dKX1ccgpgLEUrKzt0aGlzLnBhY2tlZEZsb2F0JiYoXys9IiNkZWZpbmUgUEFDS0VERkxPQVQgMSIpLHRoaXMuX2Jsb2NrQ29tcGlsYXRpb249ITEsc3VwZXIudXBkYXRlRWZmZWN0KF8sbnVsbCxudWxsLHt2YXJ5aW5nQ291bnQ6ZixkZXBDb3VudDpFfSxlLHQpfV9uZWFyZXN0QmVzdEtlcm5lbChlKXtjb25zdCB0PU1hdGgucm91bmQoZSk7Zm9yKGNvbnN0IGkgb2ZbdCx0LTEsdCsxLHQtMix0KzJdKWlmKGklMiE9PTAmJk1hdGguZmxvb3IoaS8yKSUyPT09MCYmaT4wKXJldHVybiBNYXRoLm1heChpLDMpO3JldHVybiBNYXRoLm1heCh0LDMpfV9nYXVzc2lhbldlaWdodChlKXtjb25zdCB0PS4zMzMzMzMzMzMzMzMzMzMzLGk9TWF0aC5zcXJ0KDIqTWF0aC5QSSkqdCxzPS0oZSplLygyKnQqdCkpO3JldHVybiAxL2kqTWF0aC5leHAocyl9X2dsc2xGbG9hdChlLHQ9OCl7cmV0dXJuIGUudG9GaXhlZCh0KS5yZXBsYWNlKC8wKyQvLCIiKX1zdGF0aWMgX1BhcnNlKGUsdCxpLHMpe3JldHVybiBhZS5QYXJzZSgoKT0+bmV3IEp0KGUubmFtZSxlLmRpcmVjdGlvbixlLmtlcm5lbCxlLm9wdGlvbnMsdCxlLnJlbmRlclRhcmdldFNhbXBsaW5nTW9kZSxpLmdldEVuZ2luZSgpLGUucmV1c2FibGUsZS50ZXh0dXJlVHlwZSx2b2lkIDAsITEpLGUsaSxzKX19VChbUigia2VybmVsIildLEp0LnByb3RvdHlwZSwiX2tlcm5lbCIsdm9pZCAwKSxUKFtSKCJwYWNrZWRGbG9hdCIpXSxKdC5wcm90b3R5cGUsIl9wYWNrZWRGbG9hdCIsdm9pZCAwKSxUKFt4bigpXSxKdC5wcm90b3R5cGUsImRpcmVjdGlvbiIsdm9pZCAwKSxpdCgiQkFCWUxPTi5CbHVyUG9zdFByb2Nlc3MiLEp0KTtjbGFzcyB6c3tjb25zdHJ1Y3Rvcigpe3RoaXMuX2RlZmluZXM9e30sdGhpcy5fY3VycmVudFJhbms9MzIsdGhpcy5fbWF4UmFuaz0tMSx0aGlzLl9tZXNoPW51bGx9dW5CaW5kTWVzaCgpe3RoaXMuX21lc2g9bnVsbH1hZGRGYWxsYmFjayhlLHQpe3RoaXMuX2RlZmluZXNbZV18fChlPHRoaXMuX2N1cnJlbnRSYW5rJiYodGhpcy5fY3VycmVudFJhbms9ZSksZT50aGlzLl9tYXhSYW5rJiYodGhpcy5fbWF4UmFuaz1lKSx0aGlzLl9kZWZpbmVzW2VdPW5ldyBBcnJheSksdGhpcy5fZGVmaW5lc1tlXS5wdXNoKHQpfWFkZENQVVNraW5uaW5nRmFsbGJhY2soZSx0KXt0aGlzLl9tZXNoPXQsZTx0aGlzLl9jdXJyZW50UmFuayYmKHRoaXMuX2N1cnJlbnRSYW5rPWUpLGU+dGhpcy5fbWF4UmFuayYmKHRoaXMuX21heFJhbms9ZSl9Z2V0IGhhc01vcmVGYWxsYmFja3MoKXtyZXR1cm4gdGhpcy5fY3VycmVudFJhbms8PXRoaXMuX21heFJhbmt9cmVkdWNlKGUsdCl7aWYodGhpcy5fbWVzaCYmdGhpcy5fbWVzaC5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnRoaXMuX21lc2gubnVtQm9uZUluZmx1ZW5jZXJzPjApe3RoaXMuX21lc2guY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzPSExLGU9ZS5yZXBsYWNlKCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTICIrdGhpcy5fbWVzaC5udW1Cb25lSW5mbHVlbmNlcnMsIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMCIpLHQuX2JvbmVzQ29tcHV0YXRpb25Gb3JjZWRUb0NQVT0hMDtjb25zdCBpPXRoaXMuX21lc2guZ2V0U2NlbmUoKTtmb3IobGV0IHM9MDtzPGkubWVzaGVzLmxlbmd0aDtzKyspe2NvbnN0IHI9aS5tZXNoZXNbc107aWYoIXIubWF0ZXJpYWwpeyF0aGlzLl9tZXNoLm1hdGVyaWFsJiZyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmci5udW1Cb25lSW5mbHVlbmNlcnM+MCYmKHIuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzPSExKTtjb250aW51ZX1pZighKCFyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVyc3x8ci5udW1Cb25lSW5mbHVlbmNlcnM9PT0wKSl7aWYoci5tYXRlcmlhbC5nZXRFZmZlY3QoKT09PXQpci5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnM9ITE7ZWxzZSBpZihyLnN1Yk1lc2hlcyl7Zm9yKGNvbnN0IG4gb2Ygci5zdWJNZXNoZXMpaWYobi5lZmZlY3Q9PT10KXtyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycz0hMTticmVha319fX19ZWxzZXtjb25zdCBpPXRoaXMuX2RlZmluZXNbdGhpcy5fY3VycmVudFJhbmtdO2lmKGkpZm9yKGxldCBzPTA7czxpLmxlbmd0aDtzKyspZT1lLnJlcGxhY2UoIiNkZWZpbmUgIitpW3NdLCIiKTt0aGlzLl9jdXJyZW50UmFuaysrfXJldHVybiBlfX1jb25zdCBtYT0iYmF5ZXJEaXRoZXJGdW5jdGlvbnMiLEVhPWBmbG9hdCBiYXllckRpdGhlcjIodmVjMiBfUCkgewpyZXR1cm4gbW9kKDIuMCpfUC55K19QLngrMS4wLDQuMCk7Cn0KZmxvYXQgYmF5ZXJEaXRoZXI0KHZlYzIgX1ApIHsKdmVjMiBQMT1tb2QoX1AsMi4wKTsgCnZlYzIgUDI9Zmxvb3IoMC41Km1vZChfUCw0LjApKTsgCnJldHVybiA0LjAqYmF5ZXJEaXRoZXIyKFAxKStiYXllckRpdGhlcjIoUDIpOwp9CmZsb2F0IGJheWVyRGl0aGVyOCh2ZWMyIF9QKSB7CnZlYzIgUDE9bW9kKF9QLDIuMCk7IAp2ZWMyIFAyPWZsb29yKDAuNSAqbW9kKF9QLDQuMCkpOyAKdmVjMiBQND1mbG9vcigwLjI1Km1vZChfUCw4LjApKTsgCnJldHVybiA0LjAqKDQuMCpiYXllckRpdGhlcjIoUDEpK2JheWVyRGl0aGVyMihQMikpK2JheWVyRGl0aGVyMihQNCk7Cn0KYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW21hXT1FYTtjb25zdCB2YT0ic2hhZG93TWFwRnJhZ21lbnRFeHRyYURlY2xhcmF0aW9uIixUYT1gI2lmIFNNX0ZMT0FUPT0wCiNpbmNsdWRlPHBhY2tpbmdGdW5jdGlvbnM+CiNlbmRpZgojaWYgU01fU09GVFRSQU5TUEFSRU5UU0hBRE9XPT0xCiNpbmNsdWRlPGJheWVyRGl0aGVyRnVuY3Rpb25zPgp1bmlmb3JtIGZsb2F0IHNvZnRUcmFuc3BhcmVudFNoYWRvd1NNOwojZW5kaWYKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWNTTTsKI2lmIFNNX1VTRURJU1RBTkNFPT0xCnVuaWZvcm0gdmVjMyBsaWdodERhdGFTTTsKdmFyeWluZyB2ZWMzIHZQb3NpdGlvbldTTTsKI2VuZGlmCnVuaWZvcm0gdmVjMyBiaWFzQW5kU2NhbGVTTTsKdW5pZm9ybSB2ZWMyIGRlcHRoVmFsdWVzU007CiNpZiBkZWZpbmVkKFNNX0RFUFRIQ0xBTVApICYmIFNNX0RFUFRIQ0xBTVA9PTEKdmFyeWluZyBmbG9hdCB6U007CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbdmFdPVRhO2NvbnN0IGJhPSJjbGlwUGxhbmVGcmFnbWVudERlY2xhcmF0aW9uIixTYT1gI2lmZGVmIENMSVBQTEFORQp2YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2U7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FMgp2YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2UyOwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTMKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlMzsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CnZhcnlpbmcgZmxvYXQgZkNsaXBEaXN0YW5jZTQ7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FNQp2YXJ5aW5nIGZsb2F0IGZDbGlwRGlzdGFuY2U1OwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTYKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNjsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtiYV09U2E7Y29uc3QgeGE9ImNsaXBQbGFuZUZyYWdtZW50IixNYT1gI2lmIGRlZmluZWQoQ0xJUFBMQU5FKSB8fCBkZWZpbmVkKENMSVBQTEFORTIpIHx8IGRlZmluZWQoQ0xJUFBMQU5FMykgfHwgZGVmaW5lZChDTElQUExBTkU0KSB8fCBkZWZpbmVkKENMSVBQTEFORTUpIHx8IGRlZmluZWQoQ0xJUFBMQU5FNikKaWYgKGZhbHNlKSB7fQojZW5kaWYKI2lmZGVmIENMSVBQTEFORQplbHNlIGlmIChmQ2xpcERpc3RhbmNlPjAuMCkKewpkaXNjYXJkOwp9CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FMgplbHNlIGlmIChmQ2xpcERpc3RhbmNlMj4wLjApCnsKZGlzY2FyZDsKfQojZW5kaWYKI2lmZGVmIENMSVBQTEFORTMKZWxzZSBpZiAoZkNsaXBEaXN0YW5jZTM+MC4wKQp7CmRpc2NhcmQ7Cn0KI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CmVsc2UgaWYgKGZDbGlwRGlzdGFuY2U0PjAuMCkKewpkaXNjYXJkOwp9CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FNQplbHNlIGlmIChmQ2xpcERpc3RhbmNlNT4wLjApCnsKZGlzY2FyZDsKfQojZW5kaWYKI2lmZGVmIENMSVBQTEFORTYKZWxzZSBpZiAoZkNsaXBEaXN0YW5jZTY+MC4wKQp7CmRpc2NhcmQ7Cn0KI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt4YV09TWE7Y29uc3QgQWE9InNoYWRvd01hcEZyYWdtZW50IixSYT1gZmxvYXQgZGVwdGhTTT12RGVwdGhNZXRyaWNTTTsKI2lmIGRlZmluZWQoU01fREVQVEhDTEFNUCkgJiYgU01fREVQVEhDTEFNUD09MQojaWYgU01fVVNFRElTVEFOQ0U9PTEKZGVwdGhTTT0obGVuZ3RoKHZQb3NpdGlvbldTTS1saWdodERhdGFTTSkrZGVwdGhWYWx1ZXNTTS54KS9kZXB0aFZhbHVlc1NNLnkrYmlhc0FuZFNjYWxlU00ueDsKI2Vsc2UKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCmRlcHRoU009KC16U00rZGVwdGhWYWx1ZXNTTS54KS9kZXB0aFZhbHVlc1NNLnkrYmlhc0FuZFNjYWxlU00ueDsKI2Vsc2UKZGVwdGhTTT0oelNNK2RlcHRoVmFsdWVzU00ueCkvZGVwdGhWYWx1ZXNTTS55K2JpYXNBbmRTY2FsZVNNLng7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCmdsX0ZyYWdEZXB0aD1jbGFtcCgxLjAtZGVwdGhTTSwwLjAsMS4wKTsKI2Vsc2UKZ2xfRnJhZ0RlcHRoPWNsYW1wKGRlcHRoU00sMC4wLDEuMCk7IAojZW5kaWYKI2VsaWYgU01fVVNFRElTVEFOQ0U9PTEKZGVwdGhTTT0obGVuZ3RoKHZQb3NpdGlvbldTTS1saWdodERhdGFTTSkrZGVwdGhWYWx1ZXNTTS54KS9kZXB0aFZhbHVlc1NNLnkrYmlhc0FuZFNjYWxlU00ueDsKI2VuZGlmCiNpZiBTTV9FU009PTEKZGVwdGhTTT1jbGFtcChleHAoLW1pbig4Ny4sYmlhc0FuZFNjYWxlU00ueipkZXB0aFNNKSksMC4sMS4pOwojZW5kaWYKI2lmIFNNX0ZMT0FUPT0xCmdsX0ZyYWdDb2xvcj12ZWM0KGRlcHRoU00sMS4wLDEuMCwxLjApOwojZWxzZQpnbF9GcmFnQ29sb3I9cGFjayhkZXB0aFNNKTsKI2VuZGlmCnJldHVybjtgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbQWFdPVJhO2NvbnN0IHlhPSJzaGFkb3dNYXBQaXhlbFNoYWRlciIsQ2E9YCNpbmNsdWRlPHNoYWRvd01hcEZyYWdtZW50RXh0cmFEZWNsYXJhdGlvbj4KI2lmZGVmIEFMUEhBVEVYVFVSRQp2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjsKI2VuZGlmCiNpbmNsdWRlPGNsaXBQbGFuZUZyYWdtZW50RGVjbGFyYXRpb24+CiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0RFRklOSVRJT05TCnZvaWQgbWFpbih2b2lkKQp7CiNpbmNsdWRlPGNsaXBQbGFuZUZyYWdtZW50PgojaWZkZWYgQUxQSEFURVhUVVJFCmZsb2F0IGFscGhhRnJvbUFscGhhVGV4dHVyZT10ZXh0dXJlMkQoZGlmZnVzZVNhbXBsZXIsdlVWKS5hOwojaWZkZWYgQUxQSEFURVNUVkFMVUUKaWYgKGFscGhhRnJvbUFscGhhVGV4dHVyZTxBTFBIQVRFU1RWQUxVRSkKZGlzY2FyZDsKI2VuZGlmCiNlbmRpZgojaWYgU01fU09GVFRSQU5TUEFSRU5UU0hBRE9XPT0xCiNpZmRlZiBBTFBIQVRFWFRVUkUKaWYgKChiYXllckRpdGhlcjgoZmxvb3IobW9kKGdsX0ZyYWdDb29yZC54eSw4LjApKSkpLzY0LjA+PXNvZnRUcmFuc3BhcmVudFNoYWRvd1NNKmFscGhhRnJvbUFscGhhVGV4dHVyZSkgZGlzY2FyZDsKI2Vsc2UKaWYgKChiYXllckRpdGhlcjgoZmxvb3IobW9kKGdsX0ZyYWdDb29yZC54eSw4LjApKSkpLzY0LjA+PXNvZnRUcmFuc3BhcmVudFNoYWRvd1NNKSBkaXNjYXJkOwojZW5kaWYKI2VuZGlmCiNpbmNsdWRlPHNoYWRvd01hcEZyYWdtZW50Pgp9YDtVLlNoYWRlcnNTdG9yZVt5YV09Q2E7Y29uc3QgSWE9ImJvbmVzRGVjbGFyYXRpb24iLFBhPWAjaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MAphdHRyaWJ1dGUgdmVjNCBtYXRyaWNlc0luZGljZXM7CmF0dHJpYnV0ZSB2ZWM0IG1hdHJpY2VzV2VpZ2h0czsKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjQKYXR0cmlidXRlIHZlYzQgbWF0cmljZXNJbmRpY2VzRXh0cmE7CmF0dHJpYnV0ZSB2ZWM0IG1hdHJpY2VzV2VpZ2h0c0V4dHJhOwojZW5kaWYKI2lmbmRlZiBCQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkUKI2lmZGVmIEJPTkVURVhUVVJFCnVuaWZvcm0gc2FtcGxlcjJEIGJvbmVTYW1wbGVyOwp1bmlmb3JtIGZsb2F0IGJvbmVUZXh0dXJlV2lkdGg7CiNlbHNlCnVuaWZvcm0gbWF0NCBtQm9uZXNbQm9uZXNQZXJNZXNoXTsKI2lmZGVmIEJPTkVTX1ZFTE9DSVRZX0VOQUJMRUQKdW5pZm9ybSBtYXQ0IG1QcmV2aW91c0JvbmVzW0JvbmVzUGVyTWVzaF07CiNlbmRpZgojZW5kaWYKI2lmZGVmIEJPTkVURVhUVVJFCiNkZWZpbmUgaW5saW5lCm1hdDQgcmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyKHNhbXBsZXIyRCBzbXAsZmxvYXQgaW5kZXgpCnsKZmxvYXQgb2Zmc2V0PWluZGV4ICo0LjA7CmZsb2F0IGR4PTEuMC9ib25lVGV4dHVyZVdpZHRoOwp2ZWM0IG0wPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzAuNSksMC4pKTsKdmVjNCBtMT10ZXh0dXJlMkQoc21wLHZlYzIoZHgqKG9mZnNldCsxLjUpLDAuKSk7CnZlYzQgbTI9dGV4dHVyZTJEKHNtcCx2ZWMyKGR4KihvZmZzZXQrMi41KSwwLikpOwp2ZWM0IG0zPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzMuNSksMC4pKTsKcmV0dXJuIG1hdDQobTAsbTEsbTIsbTMpOwp9CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtJYV09UGE7Y29uc3QgRGE9ImJha2VkVmVydGV4QW5pbWF0aW9uRGVjbGFyYXRpb24iLEZhPWAjaWZkZWYgQkFLRURfVkVSVEVYX0FOSU1BVElPTl9URVhUVVJFCnVuaWZvcm0gZmxvYXQgYmFrZWRWZXJ0ZXhBbmltYXRpb25UaW1lOwp1bmlmb3JtIHZlYzIgYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlU2l6ZUludmVydGVkOwp1bmlmb3JtIHZlYzQgYmFrZWRWZXJ0ZXhBbmltYXRpb25TZXR0aW5nczsKdW5pZm9ybSBzYW1wbGVyMkQgYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlOwojaWZkZWYgSU5TVEFOQ0VTCmF0dHJpYnV0ZSB2ZWM0IGJha2VkVmVydGV4QW5pbWF0aW9uU2V0dGluZ3NJbnN0YW5jZWQ7CiNlbmRpZgojZGVmaW5lIGlubGluZQptYXQ0IHJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChzYW1wbGVyMkQgc21wLGZsb2F0IGluZGV4LGZsb2F0IGZyYW1lKQp7CmZsb2F0IG9mZnNldD1pbmRleCo0LjA7CmZsb2F0IGZyYW1lVVY9KGZyYW1lKzAuNSkqYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlU2l6ZUludmVydGVkLnk7CmZsb2F0IGR4PWJha2VkVmVydGV4QW5pbWF0aW9uVGV4dHVyZVNpemVJbnZlcnRlZC54Owp2ZWM0IG0wPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzAuNSksZnJhbWVVVikpOwp2ZWM0IG0xPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzEuNSksZnJhbWVVVikpOwp2ZWM0IG0yPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzIuNSksZnJhbWVVVikpOwp2ZWM0IG0zPXRleHR1cmUyRChzbXAsdmVjMihkeCoob2Zmc2V0KzMuNSksZnJhbWVVVikpOwpyZXR1cm4gbWF0NChtMCxtMSxtMixtMyk7Cn0KI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtEYV09RmE7Y29uc3Qgd2E9Im1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbERlY2xhcmF0aW9uIixPYT1gI2lmZGVmIE1PUlBIVEFSR0VUUwp1bmlmb3JtIGZsb2F0IG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1tOVU1fTU9SUEhfSU5GTFVFTkNFUlNdOwojaWZkZWYgTU9SUEhUQVJHRVRTX1RFWFRVUkUgCnByZWNpc2lvbiBtZWRpdW1wIHNhbXBsZXIyREFycmF5OyAKdW5pZm9ybSBmbG9hdCBtb3JwaFRhcmdldFRleHR1cmVJbmRpY2VzW05VTV9NT1JQSF9JTkZMVUVOQ0VSU107CnVuaWZvcm0gdmVjMyBtb3JwaFRhcmdldFRleHR1cmVJbmZvOwp1bmlmb3JtIHNhbXBsZXIyREFycmF5IG1vcnBoVGFyZ2V0czsKdmVjMyByZWFkVmVjdG9yM0Zyb21SYXdTYW1wbGVyKGludCB0YXJnZXRJbmRleCxmbG9hdCB2ZXJ0ZXhJbmRleCkKeyAKZmxvYXQgeT1mbG9vcih2ZXJ0ZXhJbmRleC9tb3JwaFRhcmdldFRleHR1cmVJbmZvLnkpOwpmbG9hdCB4PXZlcnRleEluZGV4LXkqbW9ycGhUYXJnZXRUZXh0dXJlSW5mby55Owp2ZWMzIHRleHR1cmVVVj12ZWMzKCh4KzAuNSkvbW9ycGhUYXJnZXRUZXh0dXJlSW5mby55LCh5KzAuNSkvbW9ycGhUYXJnZXRUZXh0dXJlSW5mby56LG1vcnBoVGFyZ2V0VGV4dHVyZUluZGljZXNbdGFyZ2V0SW5kZXhdKTsKcmV0dXJuIHRleHR1cmUobW9ycGhUYXJnZXRzLHRleHR1cmVVVikueHl6Owp9CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3dhXT1PYTtjb25zdCBMYT0ibW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24iLE5hPWAjaWZkZWYgTU9SUEhUQVJHRVRTCiNpZm5kZWYgTU9SUEhUQVJHRVRTX1RFWFRVUkUKYXR0cmlidXRlIHZlYzMgcG9zaXRpb257WH07CiNpZmRlZiBNT1JQSFRBUkdFVFNfTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbHtYfTsKI2VuZGlmCiNpZmRlZiBNT1JQSFRBUkdFVFNfVEFOR0VOVAphdHRyaWJ1dGUgdmVjMyB0YW5nZW50e1h9OwojZW5kaWYKI2lmZGVmIE1PUlBIVEFSR0VUU19VVgphdHRyaWJ1dGUgdmVjMiB1dl97WH07CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtMYV09TmE7Y29uc3QgQmE9ImhlbHBlckZ1bmN0aW9ucyIsVWE9YGNvbnN0IGZsb2F0IFBJPTMuMTQxNTkyNjUzNTg5NzkzMjM4NDYyNjQzMzgzMjc5NTsKY29uc3QgZmxvYXQgSEFMRl9NSU49NS45NjA0NjQ0OGUtMDg7IApjb25zdCBmbG9hdCBMaW5lYXJFbmNvZGVQb3dlckFwcHJveD0yLjI7CmNvbnN0IGZsb2F0IEdhbW1hRW5jb2RlUG93ZXJBcHByb3g9MS4wL0xpbmVhckVuY29kZVBvd2VyQXBwcm94Owpjb25zdCB2ZWMzIEx1bWluYW5jZUVuY29kZUFwcHJveD12ZWMzKDAuMjEyNiwwLjcxNTIsMC4wNzIyKTsKY29uc3QgZmxvYXQgRXBzaWxvbj0wLjAwMDAwMDE7CiNkZWZpbmUgc2F0dXJhdGUoeCkgY2xhbXAoeCwwLjAsMS4wKQojZGVmaW5lIGFic0Vwcyh4KSBhYnMoeCkrRXBzaWxvbgojZGVmaW5lIG1heEVwcyh4KSBtYXgoeCxFcHNpbG9uKQojZGVmaW5lIHNhdHVyYXRlRXBzKHgpIGNsYW1wKHgsRXBzaWxvbiwxLjApCm1hdDMgdHJhbnNwb3NlTWF0MyhtYXQzIGluTWF0cml4KSB7CnZlYzMgaTA9aW5NYXRyaXhbMF07CnZlYzMgaTE9aW5NYXRyaXhbMV07CnZlYzMgaTI9aW5NYXRyaXhbMl07Cm1hdDMgb3V0TWF0cml4PW1hdDMoCnZlYzMoaTAueCxpMS54LGkyLngpLAp2ZWMzKGkwLnksaTEueSxpMi55KSwKdmVjMyhpMC56LGkxLnosaTIueikKKTsKcmV0dXJuIG91dE1hdHJpeDsKfQptYXQzIGludmVyc2VNYXQzKG1hdDMgaW5NYXRyaXgpIHsKZmxvYXQgYTAwPWluTWF0cml4WzBdWzBdLGEwMT1pbk1hdHJpeFswXVsxXSxhMDI9aW5NYXRyaXhbMF1bMl07CmZsb2F0IGExMD1pbk1hdHJpeFsxXVswXSxhMTE9aW5NYXRyaXhbMV1bMV0sYTEyPWluTWF0cml4WzFdWzJdOwpmbG9hdCBhMjA9aW5NYXRyaXhbMl1bMF0sYTIxPWluTWF0cml4WzJdWzFdLGEyMj1pbk1hdHJpeFsyXVsyXTsKZmxvYXQgYjAxPWEyMiphMTEtYTEyKmEyMTsKZmxvYXQgYjExPS1hMjIqYTEwK2ExMiphMjA7CmZsb2F0IGIyMT1hMjEqYTEwLWExMSphMjA7CmZsb2F0IGRldD1hMDAqYjAxK2EwMSpiMTErYTAyKmIyMTsKcmV0dXJuIG1hdDMoYjAxLCgtYTIyKmEwMSthMDIqYTIxKSwoYTEyKmEwMS1hMDIqYTExKSwKYjExLChhMjIqYTAwLWEwMiphMjApLCgtYTEyKmEwMCthMDIqYTEwKSwKYjIxLCgtYTIxKmEwMCthMDEqYTIwKSwoYTExKmEwMC1hMDEqYTEwKSkvZGV0Owp9CiNpZiBVU0VfRVhBQ1RfU1JHQl9DT05WRVJTSU9OUwp2ZWMzIHRvTGluZWFyU3BhY2VFeGFjdCh2ZWMzIGNvbG9yKQp7CnZlYzMgbmVhclplcm9TZWN0aW9uPTAuMDc3Mzk5MzgwOCpjb2xvcjsKdmVjMyByZW1haW5pbmdTZWN0aW9uPXBvdygwLjk0Nzg2NzI5OSooY29sb3IrdmVjMygwLjA1NSkpLHZlYzMoMi40KSk7CiNpZiBkZWZpbmVkKFdFQkdMMikgfHwgZGVmaW5lZChXRUJHUFUpIHx8IGRlZmluZWQoTkFUSVZFKQpyZXR1cm4gbWl4KHJlbWFpbmluZ1NlY3Rpb24sbmVhclplcm9TZWN0aW9uLGxlc3NUaGFuRXF1YWwoY29sb3IsdmVjMygwLjA0MDQ1KSkpOwojZWxzZQpyZXR1cm4KdmVjMygKY29sb3Iucjw9MC4wNDA0NSA/IG5lYXJaZXJvU2VjdGlvbi5yIDogcmVtYWluaW5nU2VjdGlvbi5yLApjb2xvci5nPD0wLjA0MDQ1ID8gbmVhclplcm9TZWN0aW9uLmcgOiByZW1haW5pbmdTZWN0aW9uLmcsCmNvbG9yLmI8PTAuMDQwNDUgPyBuZWFyWmVyb1NlY3Rpb24uYiA6IHJlbWFpbmluZ1NlY3Rpb24uYik7CiNlbmRpZgp9CnZlYzMgdG9HYW1tYVNwYWNlRXhhY3QodmVjMyBjb2xvcikKewp2ZWMzIG5lYXJaZXJvU2VjdGlvbj0xMi45Mipjb2xvcjsKdmVjMyByZW1haW5pbmdTZWN0aW9uPTEuMDU1KnBvdyhjb2xvcix2ZWMzKDAuNDE2NjYpKS12ZWMzKDAuMDU1KTsKI2lmIGRlZmluZWQoV0VCR0wyKSB8fCBkZWZpbmVkKFdFQkdQVSkgfHwgZGVmaW5lZChOQVRJVkUpCnJldHVybiBtaXgocmVtYWluaW5nU2VjdGlvbixuZWFyWmVyb1NlY3Rpb24sbGVzc1RoYW5FcXVhbChjb2xvcix2ZWMzKDAuMDAzMTMwOCkpKTsKI2Vsc2UKcmV0dXJuCnZlYzMoCmNvbG9yLnI8PTAuMDAzMTMwOCA/IG5lYXJaZXJvU2VjdGlvbi5yIDogcmVtYWluaW5nU2VjdGlvbi5yLApjb2xvci5nPD0wLjAwMzEzMDggPyBuZWFyWmVyb1NlY3Rpb24uZyA6IHJlbWFpbmluZ1NlY3Rpb24uZywKY29sb3IuYjw9MC4wMDMxMzA4ID8gbmVhclplcm9TZWN0aW9uLmIgOiByZW1haW5pbmdTZWN0aW9uLmIpOwojZW5kaWYKfQojZW5kaWYKZmxvYXQgdG9MaW5lYXJTcGFjZShmbG9hdCBjb2xvcikKewojaWYgVVNFX0VYQUNUX1NSR0JfQ09OVkVSU0lPTlMKZmxvYXQgbmVhclplcm9TZWN0aW9uPTAuMDc3Mzk5MzgwOCpjb2xvcjsKZmxvYXQgcmVtYWluaW5nU2VjdGlvbj1wb3coMC45NDc4NjcyOTkqKGNvbG9yKzAuMDU1KSwyLjQpOwpyZXR1cm4gY29sb3I8PTAuMDQwNDUgPyBuZWFyWmVyb1NlY3Rpb24gOiByZW1haW5pbmdTZWN0aW9uOwojZWxzZQpyZXR1cm4gcG93KGNvbG9yLExpbmVhckVuY29kZVBvd2VyQXBwcm94KTsKI2VuZGlmCn0KdmVjMyB0b0xpbmVhclNwYWNlKHZlYzMgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB0b0xpbmVhclNwYWNlRXhhY3QoY29sb3IpOwojZWxzZQpyZXR1cm4gcG93KGNvbG9yLHZlYzMoTGluZWFyRW5jb2RlUG93ZXJBcHByb3gpKTsKI2VuZGlmCn0KdmVjNCB0b0xpbmVhclNwYWNlKHZlYzQgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB2ZWM0KHRvTGluZWFyU3BhY2VFeGFjdChjb2xvci5yZ2IpLGNvbG9yLmEpOwojZWxzZQpyZXR1cm4gdmVjNChwb3coY29sb3IucmdiLHZlYzMoTGluZWFyRW5jb2RlUG93ZXJBcHByb3gpKSxjb2xvci5hKTsKI2VuZGlmCn0KZmxvYXQgdG9HYW1tYVNwYWNlKGZsb2F0IGNvbG9yKQp7CiNpZiBVU0VfRVhBQ1RfU1JHQl9DT05WRVJTSU9OUwpmbG9hdCBuZWFyWmVyb1NlY3Rpb249MTIuOTIqY29sb3I7CmZsb2F0IHJlbWFpbmluZ1NlY3Rpb249MS4wNTUqcG93KGNvbG9yLDAuNDE2NjYpLTAuMDU1OwpyZXR1cm4gY29sb3I8PTAuMDAzMTMwOCA/IG5lYXJaZXJvU2VjdGlvbiA6IHJlbWFpbmluZ1NlY3Rpb247CiNlbHNlCnJldHVybiBwb3coY29sb3IsR2FtbWFFbmNvZGVQb3dlckFwcHJveCk7CiNlbmRpZgp9CnZlYzMgdG9HYW1tYVNwYWNlKHZlYzMgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB0b0dhbW1hU3BhY2VFeGFjdChjb2xvcik7CiNlbHNlCnJldHVybiBwb3coY29sb3IsdmVjMyhHYW1tYUVuY29kZVBvd2VyQXBwcm94KSk7CiNlbmRpZgp9CnZlYzQgdG9HYW1tYVNwYWNlKHZlYzQgY29sb3IpCnsKI2lmIFVTRV9FWEFDVF9TUkdCX0NPTlZFUlNJT05TCnJldHVybiB2ZWM0KHRvR2FtbWFTcGFjZUV4YWN0KGNvbG9yLnJnYiksY29sb3IuYSk7CiNlbHNlCnJldHVybiB2ZWM0KHBvdyhjb2xvci5yZ2IsdmVjMyhHYW1tYUVuY29kZVBvd2VyQXBwcm94KSksY29sb3IuYSk7CiNlbmRpZgp9CmZsb2F0IHNxdWFyZShmbG9hdCB2YWx1ZSkKewpyZXR1cm4gdmFsdWUqdmFsdWU7Cn0KdmVjMyBzcXVhcmUodmVjMyB2YWx1ZSkKewpyZXR1cm4gdmFsdWUqdmFsdWU7Cn0KZmxvYXQgcG93NShmbG9hdCB2YWx1ZSkgewpmbG9hdCBzcT12YWx1ZSp2YWx1ZTsKcmV0dXJuIHNxKnNxKnZhbHVlOwp9CmZsb2F0IGdldEx1bWluYW5jZSh2ZWMzIGNvbG9yKQp7CnJldHVybiBjbGFtcChkb3QoY29sb3IsTHVtaW5hbmNlRW5jb2RlQXBwcm94KSwwLiwxLik7Cn0KZmxvYXQgZ2V0UmFuZCh2ZWMyIHNlZWQpIHsKcmV0dXJuIGZyYWN0KHNpbihkb3Qoc2VlZC54eSAsdmVjMigxMi45ODk4LDc4LjIzMykpKSo0Mzc1OC41NDUzKTsKfQpmbG9hdCBkaXRoZXIodmVjMiBzZWVkLGZsb2F0IHZhcmlhbmNlQW1vdW50KSB7CmZsb2F0IHJhbmQ9Z2V0UmFuZChzZWVkKTsKZmxvYXQgbm9ybVZhcmlhbmNlPXZhcmlhbmNlQW1vdW50LzI1NS4wOwpmbG9hdCBkaXRoZXI9bWl4KC1ub3JtVmFyaWFuY2Usbm9ybVZhcmlhbmNlLHJhbmQpOwpyZXR1cm4gZGl0aGVyOwp9CmNvbnN0IGZsb2F0IHJnYmRNYXhSYW5nZT0yNTUuMDsKdmVjNCB0b1JHQkQodmVjMyBjb2xvcikgewpmbG9hdCBtYXhSR0I9bWF4RXBzKG1heChjb2xvci5yLG1heChjb2xvci5nLGNvbG9yLmIpKSk7CmZsb2F0IEQgPW1heChyZ2JkTWF4UmFuZ2UvbWF4UkdCLDEuKTsKRCA9Y2xhbXAoZmxvb3IoRCkvMjU1LjAsMC4sMS4pOwp2ZWMzIHJnYj1jb2xvci5yZ2IqRDsKcmdiPXRvR2FtbWFTcGFjZShyZ2IpOwpyZXR1cm4gdmVjNChjbGFtcChyZ2IsMC4sMS4pLEQpOyAKfQp2ZWMzIGZyb21SR0JEKHZlYzQgcmdiZCkgewpyZ2JkLnJnYj10b0xpbmVhclNwYWNlKHJnYmQucmdiKTsKcmV0dXJuIHJnYmQucmdiL3JnYmQuYTsKfQp2ZWMzIHBhcmFsbGF4Q29ycmVjdE5vcm1hbCggdmVjMyB2ZXJ0ZXhQb3MsdmVjMyBvcmlnVmVjLHZlYzMgY3ViZVNpemUsdmVjMyBjdWJlUG9zICkgewp2ZWMzIGludk9yaWdWZWM9dmVjMygxLjAsMS4wLDEuMCkvb3JpZ1ZlYzsKdmVjMyBoYWxmU2l6ZT1jdWJlU2l6ZSowLjU7CnZlYzMgaW50ZXJzZWNBdE1heFBsYW5lPShjdWJlUG9zK2hhbGZTaXplLXZlcnRleFBvcykqaW52T3JpZ1ZlYzsKdmVjMyBpbnRlcnNlY0F0TWluUGxhbmU9KGN1YmVQb3MtaGFsZlNpemUtdmVydGV4UG9zKSppbnZPcmlnVmVjOwp2ZWMzIGxhcmdlc3RJbnRlcnNlYz1tYXgoaW50ZXJzZWNBdE1heFBsYW5lLGludGVyc2VjQXRNaW5QbGFuZSk7CmZsb2F0IGRpc3RhbmNlPW1pbihtaW4obGFyZ2VzdEludGVyc2VjLngsbGFyZ2VzdEludGVyc2VjLnkpLGxhcmdlc3RJbnRlcnNlYy56KTsKdmVjMyBpbnRlcnNlY3RQb3NpdGlvbldTPXZlcnRleFBvcytvcmlnVmVjKmRpc3RhbmNlOwpyZXR1cm4gaW50ZXJzZWN0UG9zaXRpb25XUy1jdWJlUG9zOwp9CmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtCYV09VWE7Y29uc3Qga2E9InNjZW5lVmVydGV4RGVjbGFyYXRpb24iLFZhPWB1bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247CiNpZmRlZiBNVUxUSVZJRVcKdW5pZm9ybSBtYXQ0IHZpZXdQcm9qZWN0aW9uUjsKI2VuZGlmCnVuaWZvcm0gbWF0NCB2aWV3Owp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbjsKdW5pZm9ybSB2ZWM0IHZFeWVQb3NpdGlvbjsKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2thXT1WYTtjb25zdCBXYT0ibWVzaFZlcnRleERlY2xhcmF0aW9uIix6YT1gdW5pZm9ybSBtYXQ0IHdvcmxkOwp1bmlmb3JtIGZsb2F0IHZpc2liaWxpdHk7CmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtXYV09emE7Y29uc3QgR2E9InNoYWRvd01hcFZlcnRleERlY2xhcmF0aW9uIixYYT1gI2luY2x1ZGU8c2NlbmVWZXJ0ZXhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8bWVzaFZlcnRleERlY2xhcmF0aW9uPgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbR2FdPVhhO2NvbnN0IEhhPSJzY2VuZVVib0RlY2xhcmF0aW9uIixLYT1gbGF5b3V0KHN0ZDE0MCxjb2x1bW5fbWFqb3IpIHVuaWZvcm07CnVuaWZvcm0gU2NlbmUgewptYXQ0IHZpZXdQcm9qZWN0aW9uOwojaWZkZWYgTVVMVElWSUVXCm1hdDQgdmlld1Byb2plY3Rpb25SOwojZW5kaWYgCm1hdDQgdmlldzsKbWF0NCBwcm9qZWN0aW9uOwp2ZWM0IHZFeWVQb3NpdGlvbjsKfTsKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0hhXT1LYTtjb25zdCBZYT0ibWVzaFVib0RlY2xhcmF0aW9uIixaYT1gI2lmZGVmIFdFQkdMMgp1bmlmb3JtIG1hdDQgd29ybGQ7CnVuaWZvcm0gZmxvYXQgdmlzaWJpbGl0eTsKI2Vsc2UKbGF5b3V0KHN0ZDE0MCxjb2x1bW5fbWFqb3IpIHVuaWZvcm07CnVuaWZvcm0gTWVzaAp7Cm1hdDQgd29ybGQ7CmZsb2F0IHZpc2liaWxpdHk7Cn07CiNlbmRpZgojZGVmaW5lIFdPUkxEX1VCTwpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbWWFdPVphO2NvbnN0IHFhPSJzaGFkb3dNYXBVYm9EZWNsYXJhdGlvbiIsamE9YGxheW91dChzdGQxNDAsY29sdW1uX21ham9yKSB1bmlmb3JtOwojaW5jbHVkZTxzY2VuZVVib0RlY2xhcmF0aW9uPgojaW5jbHVkZTxtZXNoVWJvRGVjbGFyYXRpb24+CmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtxYV09amE7Y29uc3QgJGE9InNoYWRvd01hcFZlcnRleEV4dHJhRGVjbGFyYXRpb24iLFFhPWAjaWYgU01fTk9STUFMQklBUz09MQp1bmlmb3JtIHZlYzMgbGlnaHREYXRhU007CiNlbmRpZgp1bmlmb3JtIHZlYzMgYmlhc0FuZFNjYWxlU007CnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlc1NNOwp2YXJ5aW5nIGZsb2F0IHZEZXB0aE1ldHJpY1NNOwojaWYgU01fVVNFRElTVEFOQ0U9PTEKdmFyeWluZyB2ZWMzIHZQb3NpdGlvbldTTTsKI2VuZGlmCiNpZiBkZWZpbmVkKFNNX0RFUFRIQ0xBTVApICYmIFNNX0RFUFRIQ0xBTVA9PTEKdmFyeWluZyBmbG9hdCB6U007CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbJGFdPVFhO2NvbnN0IEphPSJjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbiIsZW89YCNpZmRlZiBDTElQUExBTkUKdW5pZm9ybSB2ZWM0IHZDbGlwUGxhbmU7CnZhcnlpbmcgZmxvYXQgZkNsaXBEaXN0YW5jZTsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkUyCnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lMjsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlMjsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkUzCnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lMzsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlMzsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lNDsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNDsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU1CnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lNTsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNTsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU2CnVuaWZvcm0gdmVjNCB2Q2xpcFBsYW5lNjsKdmFyeWluZyBmbG9hdCBmQ2xpcERpc3RhbmNlNjsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtKYV09ZW87Y29uc3QgdG89Im1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbCIsaW89YCNpZmRlZiBNT1JQSFRBUkdFVFMKI2lmZGVmIE1PUlBIVEFSR0VUU19URVhUVVJFCmZsb2F0IHZlcnRleElEOwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt0b109aW87Y29uc3Qgc289Im1vcnBoVGFyZ2V0c1ZlcnRleCIscm89YCNpZmRlZiBNT1JQSFRBUkdFVFMKI2lmZGVmIE1PUlBIVEFSR0VUU19URVhUVVJFIAp2ZXJ0ZXhJRD1mbG9hdChnbF9WZXJ0ZXhJRCkqbW9ycGhUYXJnZXRUZXh0dXJlSW5mby54Owpwb3NpdGlvblVwZGF0ZWQrPShyZWFkVmVjdG9yM0Zyb21SYXdTYW1wbGVyKHtYfSx2ZXJ0ZXhJRCktcG9zaXRpb24pKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwp2ZXJ0ZXhJRCs9MS4wOwojaWZkZWYgTU9SUEhUQVJHRVRTX05PUk1BTApub3JtYWxVcGRhdGVkKz0ocmVhZFZlY3RvcjNGcm9tUmF3U2FtcGxlcih7WH0sdmVydGV4SUQpIC1ub3JtYWwpKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwp2ZXJ0ZXhJRCs9MS4wOwojZW5kaWYKI2lmZGVmIE1PUlBIVEFSR0VUU19VVgp1dlVwZGF0ZWQrPShyZWFkVmVjdG9yM0Zyb21SYXdTYW1wbGVyKHtYfSx2ZXJ0ZXhJRCkueHktdXYpKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwp2ZXJ0ZXhJRCs9MS4wOwojZW5kaWYKI2lmZGVmIE1PUlBIVEFSR0VUU19UQU5HRU5UCnRhbmdlbnRVcGRhdGVkLnh5eis9KHJlYWRWZWN0b3IzRnJvbVJhd1NhbXBsZXIoe1h9LHZlcnRleElEKSAtdGFuZ2VudC54eXopKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwojZW5kaWYKI2Vsc2UKcG9zaXRpb25VcGRhdGVkKz0ocG9zaXRpb257WH0tcG9zaXRpb24pKm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1t7WH1dOwojaWZkZWYgTU9SUEhUQVJHRVRTX05PUk1BTApub3JtYWxVcGRhdGVkKz0obm9ybWFse1h9LW5vcm1hbCkqbW9ycGhUYXJnZXRJbmZsdWVuY2VzW3tYfV07CiNlbmRpZgojaWZkZWYgTU9SUEhUQVJHRVRTX1RBTkdFTlQKdGFuZ2VudFVwZGF0ZWQueHl6Kz0odGFuZ2VudHtYfS10YW5nZW50Lnh5eikqbW9ycGhUYXJnZXRJbmZsdWVuY2VzW3tYfV07CiNlbmRpZgojaWZkZWYgTU9SUEhUQVJHRVRTX1VWCnV2VXBkYXRlZCs9KHV2X3tYfS11dikqbW9ycGhUYXJnZXRJbmZsdWVuY2VzW3tYfV07CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtzb109cm87Y29uc3Qgbm89Imluc3RhbmNlc1ZlcnRleCIsYW89YCNpZmRlZiBJTlNUQU5DRVMKbWF0NCBmaW5hbFdvcmxkPW1hdDQod29ybGQwLHdvcmxkMSx3b3JsZDIsd29ybGQzKTsKI2lmIGRlZmluZWQoUFJFUEFTU19WRUxPQ0lUWSkgfHwgZGVmaW5lZChWRUxPQ0lUWSkKbWF0NCBmaW5hbFByZXZpb3VzV29ybGQ9bWF0NChwcmV2aW91c1dvcmxkMCxwcmV2aW91c1dvcmxkMSxwcmV2aW91c1dvcmxkMixwcmV2aW91c1dvcmxkMyk7CiNlbmRpZgojaWZkZWYgVEhJTl9JTlNUQU5DRVMKZmluYWxXb3JsZD13b3JsZCpmaW5hbFdvcmxkOwojaWYgZGVmaW5lZChQUkVQQVNTX1ZFTE9DSVRZKSB8fCBkZWZpbmVkKFZFTE9DSVRZKQpmaW5hbFByZXZpb3VzV29ybGQ9cHJldmlvdXNXb3JsZCpmaW5hbFByZXZpb3VzV29ybGQ7CiNlbmRpZgojZW5kaWYKI2Vsc2UKbWF0NCBmaW5hbFdvcmxkPXdvcmxkOwojaWYgZGVmaW5lZChQUkVQQVNTX1ZFTE9DSVRZKSB8fCBkZWZpbmVkKFZFTE9DSVRZKQptYXQ0IGZpbmFsUHJldmlvdXNXb3JsZD1wcmV2aW91c1dvcmxkOwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtub109YW87Y29uc3Qgb289ImJvbmVzVmVydGV4Iixobz1gI2lmbmRlZiBCQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkUKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjAKbWF0NCBpbmZsdWVuY2U7CiNpZmRlZiBCT05FVEVYVFVSRQppbmZsdWVuY2U9cmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyKGJvbmVTYW1wbGVyLG1hdHJpY2VzSW5kaWNlc1swXSkqbWF0cmljZXNXZWlnaHRzWzBdOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MQppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNbMV0pKm1hdHJpY2VzV2VpZ2h0c1sxXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz4yCmluZmx1ZW5jZSs9cmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyKGJvbmVTYW1wbGVyLG1hdHJpY2VzSW5kaWNlc1syXSkqbWF0cmljZXNXZWlnaHRzWzJdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjMKaW5mbHVlbmNlKz1yZWFkTWF0cml4RnJvbVJhd1NhbXBsZXIoYm9uZVNhbXBsZXIsbWF0cmljZXNJbmRpY2VzWzNdKSptYXRyaWNlc1dlaWdodHNbM107CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NAppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVswXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMF07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NQppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVsxXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NgppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVsyXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMl07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NwppbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlcihib25lU2FtcGxlcixtYXRyaWNlc0luZGljZXNFeHRyYVszXSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbM107CiNlbmRpZgojZWxzZQppbmZsdWVuY2U9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNbMF0pXSptYXRyaWNlc1dlaWdodHNbMF07CiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz4xCmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNbMV0pXSptYXRyaWNlc1dlaWdodHNbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MgppbmZsdWVuY2UrPW1Cb25lc1tpbnQobWF0cmljZXNJbmRpY2VzWzJdKV0qbWF0cmljZXNXZWlnaHRzWzJdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjMKaW5mbHVlbmNlKz1tQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1szXSldKm1hdHJpY2VzV2VpZ2h0c1szXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz40CmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVswXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzBdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjUKaW5mbHVlbmNlKz1tQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc0V4dHJhWzFdKV0qbWF0cmljZXNXZWlnaHRzRXh0cmFbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NgppbmZsdWVuY2UrPW1Cb25lc1tpbnQobWF0cmljZXNJbmRpY2VzRXh0cmFbMl0pXSptYXRyaWNlc1dlaWdodHNFeHRyYVsyXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz43CmluZmx1ZW5jZSs9bUJvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVszXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzNdOwojZW5kaWYKI2VuZGlmCmZpbmFsV29ybGQ9ZmluYWxXb3JsZCppbmZsdWVuY2U7CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW29vXT1obztjb25zdCBsbz0iYmFrZWRWZXJ0ZXhBbmltYXRpb24iLGNvPWAjaWZkZWYgQkFLRURfVkVSVEVYX0FOSU1BVElPTl9URVhUVVJFCnsKI2lmZGVmIElOU1RBTkNFUwojZGVmaW5lIEJWQVNOQU1FIGJha2VkVmVydGV4QW5pbWF0aW9uU2V0dGluZ3NJbnN0YW5jZWQKI2Vsc2UKI2RlZmluZSBCVkFTTkFNRSBiYWtlZFZlcnRleEFuaW1hdGlvblNldHRpbmdzCiNlbmRpZgpmbG9hdCBWQVRTdGFydEZyYW1lPUJWQVNOQU1FLng7CmZsb2F0IFZBVEVuZEZyYW1lPUJWQVNOQU1FLnk7CmZsb2F0IFZBVE9mZnNldEZyYW1lPUJWQVNOQU1FLno7CmZsb2F0IFZBVFNwZWVkPUJWQVNOQU1FLnc7CmZsb2F0IHRvdGFsRnJhbWVzPVZBVEVuZEZyYW1lLVZBVFN0YXJ0RnJhbWUrMS4wOwpmbG9hdCB0aW1lPWJha2VkVmVydGV4QW5pbWF0aW9uVGltZSpWQVRTcGVlZC90b3RhbEZyYW1lczsKZmxvYXQgZnJhbWVDb3JyZWN0aW9uPXRpbWU8MS4wID8gMC4wIDogMS4wOwpmbG9hdCBudW1PZkZyYW1lcz10b3RhbEZyYW1lcy1mcmFtZUNvcnJlY3Rpb247CmZsb2F0IFZBVEZyYW1lTnVtPWZyYWN0KHRpbWUpKm51bU9mRnJhbWVzOwpWQVRGcmFtZU51bT1tb2QoVkFURnJhbWVOdW0rVkFUT2Zmc2V0RnJhbWUsbnVtT2ZGcmFtZXMpOwpWQVRGcmFtZU51bT1mbG9vcihWQVRGcmFtZU51bSk7ClZBVEZyYW1lTnVtKz1WQVRTdGFydEZyYW1lK2ZyYW1lQ29ycmVjdGlvbjsKbWF0NCBWQVRJbmZsdWVuY2U7ClZBVEluZmx1ZW5jZT1yZWFkTWF0cml4RnJvbVJhd1NhbXBsZXJWQVQoYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlLG1hdHJpY2VzSW5kaWNlc1swXSxWQVRGcmFtZU51bSkqbWF0cmljZXNXZWlnaHRzWzBdOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MQpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzWzFdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNbMV07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MgpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzWzJdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNbMl07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MwpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzWzNdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNbM107CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NApWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzRXh0cmFbMF0sVkFURnJhbWVOdW0pKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzBdOwojZW5kaWYKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjUKVkFUSW5mbHVlbmNlKz1yZWFkTWF0cml4RnJvbVJhd1NhbXBsZXJWQVQoYmFrZWRWZXJ0ZXhBbmltYXRpb25UZXh0dXJlLG1hdHJpY2VzSW5kaWNlc0V4dHJhWzFdLFZBVEZyYW1lTnVtKSptYXRyaWNlc1dlaWdodHNFeHRyYVsxXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz42ClZBVEluZmx1ZW5jZSs9cmVhZE1hdHJpeEZyb21SYXdTYW1wbGVyVkFUKGJha2VkVmVydGV4QW5pbWF0aW9uVGV4dHVyZSxtYXRyaWNlc0luZGljZXNFeHRyYVsyXSxWQVRGcmFtZU51bSkqbWF0cmljZXNXZWlnaHRzRXh0cmFbMl07CiNlbmRpZgojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NwpWQVRJbmZsdWVuY2UrPXJlYWRNYXRyaXhGcm9tUmF3U2FtcGxlclZBVChiYWtlZFZlcnRleEFuaW1hdGlvblRleHR1cmUsbWF0cmljZXNJbmRpY2VzRXh0cmFbM10sVkFURnJhbWVOdW0pKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzNdOwojZW5kaWYKZmluYWxXb3JsZD1maW5hbFdvcmxkKlZBVEluZmx1ZW5jZTsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2xvXT1jbztjb25zdCB1bz0ic2hhZG93TWFwVmVydGV4Tm9ybWFsQmlhcyIsZm89YCNpZiBTTV9OT1JNQUxCSUFTPT0xCiNpZiBTTV9ESVJFQ1RJT05JTkxJR0hUREFUQT09MQp2ZWMzIHdvcmxkTGlnaHREaXJTTT1ub3JtYWxpemUoLWxpZ2h0RGF0YVNNLnh5eik7CiNlbHNlCnZlYzMgZGlyZWN0aW9uVG9MaWdodFNNPWxpZ2h0RGF0YVNNLnh5ei13b3JsZFBvcy54eXo7CnZlYzMgd29ybGRMaWdodERpclNNPW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0U00pOwojZW5kaWYKZmxvYXQgbmRsU009ZG90KHZOb3JtYWxXLHdvcmxkTGlnaHREaXJTTSk7CmZsb2F0IHNpbk5MU009c3FydCgxLjAtbmRsU00qbmRsU00pOwpmbG9hdCBub3JtYWxCaWFzU009Ymlhc0FuZFNjYWxlU00ueSpzaW5OTFNNOwp3b3JsZFBvcy54eXotPXZOb3JtYWxXKm5vcm1hbEJpYXNTTTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt1b109Zm87Y29uc3QgX289InNoYWRvd01hcFZlcnRleE1ldHJpYyIsZ289YCNpZiBTTV9VU0VESVNUQU5DRT09MQp2UG9zaXRpb25XU009d29ybGRQb3MueHl6OwojZW5kaWYKI2lmIFNNX0RFUFRIVEVYVFVSRT09MQojaWZkZWYgSVNfTkRDX0hBTEZfWlJBTkdFCiNkZWZpbmUgQklBU0ZBQ1RPUiAwLjUKI2Vsc2UKI2RlZmluZSBCSUFTRkFDVE9SIDEuMAojZW5kaWYKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCmdsX1Bvc2l0aW9uLnotPWJpYXNBbmRTY2FsZVNNLngqZ2xfUG9zaXRpb24udypCSUFTRkFDVE9SOwojZWxzZQpnbF9Qb3NpdGlvbi56Kz1iaWFzQW5kU2NhbGVTTS54KmdsX1Bvc2l0aW9uLncqQklBU0ZBQ1RPUjsKI2VuZGlmCiNlbmRpZgojaWYgZGVmaW5lZChTTV9ERVBUSENMQU1QKSAmJiBTTV9ERVBUSENMQU1QPT0xCnpTTT1nbF9Qb3NpdGlvbi56OwpnbF9Qb3NpdGlvbi56PTAuMDsKI2VsaWYgU01fVVNFRElTVEFOQ0U9PTAKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCnZEZXB0aE1ldHJpY1NNPSgtZ2xfUG9zaXRpb24ueitkZXB0aFZhbHVlc1NNLngpL2RlcHRoVmFsdWVzU00ueStiaWFzQW5kU2NhbGVTTS54OwojZWxzZQp2RGVwdGhNZXRyaWNTTT0oZ2xfUG9zaXRpb24ueitkZXB0aFZhbHVlc1NNLngpL2RlcHRoVmFsdWVzU00ueStiaWFzQW5kU2NhbGVTTS54OwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtfb109Z287Y29uc3QgcG89ImNsaXBQbGFuZVZlcnRleCIsbW89YCNpZmRlZiBDTElQUExBTkUKZkNsaXBEaXN0YW5jZT1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZSk7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FMgpmQ2xpcERpc3RhbmNlMj1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZTIpOwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTMKZkNsaXBEaXN0YW5jZTM9ZG90KHdvcmxkUG9zLHZDbGlwUGxhbmUzKTsKI2VuZGlmCiNpZmRlZiBDTElQUExBTkU0CmZDbGlwRGlzdGFuY2U0PWRvdCh3b3JsZFBvcyx2Q2xpcFBsYW5lNCk7CiNlbmRpZgojaWZkZWYgQ0xJUFBMQU5FNQpmQ2xpcERpc3RhbmNlNT1kb3Qod29ybGRQb3MsdkNsaXBQbGFuZTUpOwojZW5kaWYKI2lmZGVmIENMSVBQTEFORTYKZkNsaXBEaXN0YW5jZTY9ZG90KHdvcmxkUG9zLHZDbGlwUGxhbmU2KTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtwb109bW87Y29uc3QgRW89InNoYWRvd01hcFZlcnRleFNoYWRlciIsdm89YGF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaWZkZWYgTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsKI2VuZGlmCiNpbmNsdWRlPGJvbmVzRGVjbGFyYXRpb24+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uRGVjbGFyYXRpb24+CiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbERlY2xhcmF0aW9uPgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhEZWNsYXJhdGlvbj5bMC4ubWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzXQojaWZkZWYgSU5TVEFOQ0VTCmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMDsKYXR0cmlidXRlIHZlYzQgd29ybGQxOwphdHRyaWJ1dGUgdmVjNCB3b3JsZDI7CmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMzsKI2VuZGlmCiNpbmNsdWRlPGhlbHBlckZ1bmN0aW9ucz4KI2luY2x1ZGU8X19kZWNsX19zaGFkb3dNYXBWZXJ0ZXg+CiNpZmRlZiBBTFBIQVRFWFRVUkUKdmFyeWluZyB2ZWMyIHZVVjsKdW5pZm9ybSBtYXQ0IGRpZmZ1c2VNYXRyaXg7CiNpZmRlZiBVVjEKYXR0cmlidXRlIHZlYzIgdXY7CiNlbmRpZgojaWZkZWYgVVYyCmF0dHJpYnV0ZSB2ZWMyIHV2MjsKI2VuZGlmCiNlbmRpZgojaW5jbHVkZTxzaGFkb3dNYXBWZXJ0ZXhFeHRyYURlY2xhcmF0aW9uPgojaW5jbHVkZTxjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbj4KI2RlZmluZSBDVVNUT01fVkVSVEVYX0RFRklOSVRJT05TCnZvaWQgbWFpbih2b2lkKQp7CnZlYzMgcG9zaXRpb25VcGRhdGVkPXBvc2l0aW9uOwojaWZkZWYgVVYxCnZlYzIgdXZVcGRhdGVkPXV2OwojZW5kaWYKI2lmZGVmIE5PUk1BTAp2ZWMzIG5vcm1hbFVwZGF0ZWQ9bm9ybWFsOwojZW5kaWYKI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4R2xvYmFsPgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXg+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10KI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PgojaW5jbHVkZTxib25lc1ZlcnRleD4KI2luY2x1ZGU8YmFrZWRWZXJ0ZXhBbmltYXRpb24+CnZlYzQgd29ybGRQb3M9ZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uVXBkYXRlZCwxLjApOwojaWZkZWYgTk9STUFMCm1hdDMgbm9ybVdvcmxkU009bWF0MyhmaW5hbFdvcmxkKTsKI2lmIGRlZmluZWQoSU5TVEFOQ0VTKSAmJiBkZWZpbmVkKFRISU5fSU5TVEFOQ0VTKQp2ZWMzIHZOb3JtYWxXPW5vcm1hbFVwZGF0ZWQvdmVjMyhkb3Qobm9ybVdvcmxkU01bMF0sbm9ybVdvcmxkU01bMF0pLGRvdChub3JtV29ybGRTTVsxXSxub3JtV29ybGRTTVsxXSksZG90KG5vcm1Xb3JsZFNNWzJdLG5vcm1Xb3JsZFNNWzJdKSk7CnZOb3JtYWxXPW5vcm1hbGl6ZShub3JtV29ybGRTTSp2Tm9ybWFsVyk7CiNlbHNlCiNpZmRlZiBOT05VTklGT1JNU0NBTElORwpub3JtV29ybGRTTT10cmFuc3Bvc2VNYXQzKGludmVyc2VNYXQzKG5vcm1Xb3JsZFNNKSk7CiNlbmRpZgp2ZWMzIHZOb3JtYWxXPW5vcm1hbGl6ZShub3JtV29ybGRTTSpub3JtYWxVcGRhdGVkKTsKI2VuZGlmCiNlbmRpZgojaW5jbHVkZTxzaGFkb3dNYXBWZXJ0ZXhOb3JtYWxCaWFzPgpnbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbip3b3JsZFBvczsKI2luY2x1ZGU8c2hhZG93TWFwVmVydGV4TWV0cmljPgojaWZkZWYgQUxQSEFURVhUVVJFCiNpZmRlZiBVVjEKdlVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2VXBkYXRlZCwxLjAsMC4wKSk7CiNlbmRpZgojaWZkZWYgVVYyCnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpOwojZW5kaWYKI2VuZGlmCiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD4KfWA7VS5TaGFkZXJzU3RvcmVbRW9dPXZvO2NvbnN0IFRvPSJkZXB0aEJveEJsdXJQaXhlbFNoYWRlciIsYm89YHZhcnlpbmcgdmVjMiB2VVY7CnVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyOwp1bmlmb3JtIHZlYzIgc2NyZWVuU2l6ZTsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpCnsKdmVjNCBjb2xvckRlcHRoPXZlYzQoMC4wKTsKZm9yIChpbnQgeD0tT0ZGU0VUOyB4PD1PRkZTRVQ7IHgrKykKZm9yIChpbnQgeT0tT0ZGU0VUOyB5PD1PRkZTRVQ7IHkrKykKY29sb3JEZXB0aCs9dGV4dHVyZTJEKHRleHR1cmVTYW1wbGVyLHZVVit2ZWMyKHgseSkvc2NyZWVuU2l6ZSk7CmdsX0ZyYWdDb2xvcj0oY29sb3JEZXB0aC9mbG9hdCgoT0ZGU0VUKjIrMSkqKE9GRlNFVCoyKzEpKSk7Cn1gO1UuU2hhZGVyc1N0b3JlW1RvXT1ibztjb25zdCBTbz0ic2hhZG93TWFwRnJhZ21lbnRTb2Z0VHJhbnNwYXJlbnRTaGFkb3ciLHhvPWAjaWYgU01fU09GVFRSQU5TUEFSRU5UU0hBRE9XPT0xCmlmICgoYmF5ZXJEaXRoZXI4KGZsb29yKG1vZChnbF9GcmFnQ29vcmQueHksOC4wKSkpKS82NC4wPj1zb2Z0VHJhbnNwYXJlbnRTaGFkb3dTTSphbHBoYSkgZGlzY2FyZDsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtTb109eG87Y2xhc3MgR3tjb25zdHJ1Y3RvcihlLHQsaSxzKXt0aGlzLm9uQmVmb3JlU2hhZG93TWFwUmVuZGVyT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJTaGFkb3dNYXBSZW5kZXJPYnNlcnZhYmxlPW5ldyBGLHRoaXMub25CZWZvcmVTaGFkb3dNYXBSZW5kZXJNZXNoT2JzZXJ2YWJsZT1uZXcgRix0aGlzLm9uQWZ0ZXJTaGFkb3dNYXBSZW5kZXJNZXNoT2JzZXJ2YWJsZT1uZXcgRix0aGlzLl9iaWFzPTVlLTUsdGhpcy5fbm9ybWFsQmlhcz0wLHRoaXMuX2JsdXJCb3hPZmZzZXQ9MSx0aGlzLl9ibHVyU2NhbGU9Mix0aGlzLl9ibHVyS2VybmVsPTEsdGhpcy5fdXNlS2VybmVsQmx1cj0hMSx0aGlzLl9maWx0ZXI9Ry5GSUxURVJfTk9ORSx0aGlzLl9maWx0ZXJpbmdRdWFsaXR5PUcuUVVBTElUWV9ISUdILHRoaXMuX2NvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvPS4xLHRoaXMuX2RhcmtuZXNzPTAsdGhpcy5fdHJhbnNwYXJlbmN5U2hhZG93PSExLHRoaXMuZW5hYmxlU29mdFRyYW5zcGFyZW50U2hhZG93PSExLHRoaXMudXNlT3BhY2l0eVRleHR1cmVGb3JUcmFuc3BhcmVudFNoYWRvdz0hMSx0aGlzLmZydXN0dW1FZGdlRmFsbG9mZj0wLHRoaXMuZm9yY2VCYWNrRmFjZXNPbmx5PSExLHRoaXMuX2xpZ2h0RGlyZWN0aW9uPXAuWmVybygpLHRoaXMuX3ZpZXdNYXRyaXg9eC5aZXJvKCksdGhpcy5fcHJvamVjdGlvbk1hdHJpeD14Llplcm8oKSx0aGlzLl90cmFuc2Zvcm1NYXRyaXg9eC5aZXJvKCksdGhpcy5fY2FjaGVkUG9zaXRpb249bmV3IHAoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2NhY2hlZERpcmVjdGlvbj1uZXcgcChOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksdGhpcy5fY3VycmVudEZhY2VJbmRleD0wLHRoaXMuX2N1cnJlbnRGYWNlSW5kZXhDYWNoZT0wLHRoaXMuX2RlZmF1bHRUZXh0dXJlTWF0cml4PXguSWRlbnRpdHkoKSx0aGlzLl9tYXBTaXplPWUsdGhpcy5fbGlnaHQ9dCx0aGlzLl9zY2VuZT10LmdldFNjZW5lKCksdGhpcy5fY2FtZXJhPXM/P251bGw7bGV0IHI9dC5fc2hhZG93R2VuZXJhdG9ycztyfHwocj10Ll9zaGFkb3dHZW5lcmF0b3JzPW5ldyBNYXApLHIuc2V0KHRoaXMuX2NhbWVyYSx0aGlzKSx0aGlzLmlkPXQuaWQsdGhpcy5fdXNlVUJPPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLnN1cHBvcnRzVW5pZm9ybUJ1ZmZlcnMsdGhpcy5fdXNlVUJPJiYodGhpcy5fc2NlbmVVQk9zPVtdLHRoaXMuX3NjZW5lVUJPcy5wdXNoKHRoaXMuX3NjZW5lLmNyZWF0ZVNjZW5lVW5pZm9ybUJ1ZmZlcihgU2NlbmUgZm9yIFNoYWRvdyBHZW5lcmF0b3IgKGxpZ2h0ICIke3RoaXMuX2xpZ2h0Lm5hbWV9IilgKSkpLEcuX1NjZW5lQ29tcG9uZW50SW5pdGlhbGl6YXRpb24odGhpcy5fc2NlbmUpO2NvbnN0IG49dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpO2k/bi50ZXh0dXJlRmxvYXRSZW5kZXImJm4udGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nP3RoaXMuX3RleHR1cmVUeXBlPTE6bi50ZXh0dXJlSGFsZkZsb2F0UmVuZGVyJiZuLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmc/dGhpcy5fdGV4dHVyZVR5cGU9Mjp0aGlzLl90ZXh0dXJlVHlwZT0wOm4udGV4dHVyZUhhbGZGbG9hdFJlbmRlciYmbi50ZXh0dXJlSGFsZkZsb2F0TGluZWFyRmlsdGVyaW5nP3RoaXMuX3RleHR1cmVUeXBlPTI6bi50ZXh0dXJlRmxvYXRSZW5kZXImJm4udGV4dHVyZUZsb2F0TGluZWFyRmlsdGVyaW5nP3RoaXMuX3RleHR1cmVUeXBlPTE6dGhpcy5fdGV4dHVyZVR5cGU9MCx0aGlzLl9pbml0aWFsaXplR2VuZXJhdG9yKCksdGhpcy5fYXBwbHlGaWx0ZXJWYWx1ZXMoKX1nZXQgYmlhcygpe3JldHVybiB0aGlzLl9iaWFzfXNldCBiaWFzKGUpe3RoaXMuX2JpYXM9ZX1nZXQgbm9ybWFsQmlhcygpe3JldHVybiB0aGlzLl9ub3JtYWxCaWFzfXNldCBub3JtYWxCaWFzKGUpe3RoaXMuX25vcm1hbEJpYXM9ZX1nZXQgYmx1ckJveE9mZnNldCgpe3JldHVybiB0aGlzLl9ibHVyQm94T2Zmc2V0fXNldCBibHVyQm94T2Zmc2V0KGUpe3RoaXMuX2JsdXJCb3hPZmZzZXQhPT1lJiYodGhpcy5fYmx1ckJveE9mZnNldD1lLHRoaXMuX2Rpc3Bvc2VCbHVyUG9zdFByb2Nlc3NlcygpKX1nZXQgYmx1clNjYWxlKCl7cmV0dXJuIHRoaXMuX2JsdXJTY2FsZX1zZXQgYmx1clNjYWxlKGUpe3RoaXMuX2JsdXJTY2FsZSE9PWUmJih0aGlzLl9ibHVyU2NhbGU9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSl9Z2V0IGJsdXJLZXJuZWwoKXtyZXR1cm4gdGhpcy5fYmx1cktlcm5lbH1zZXQgYmx1cktlcm5lbChlKXt0aGlzLl9ibHVyS2VybmVsIT09ZSYmKHRoaXMuX2JsdXJLZXJuZWw9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSl9Z2V0IHVzZUtlcm5lbEJsdXIoKXtyZXR1cm4gdGhpcy5fdXNlS2VybmVsQmx1cn1zZXQgdXNlS2VybmVsQmx1cihlKXt0aGlzLl91c2VLZXJuZWxCbHVyIT09ZSYmKHRoaXMuX3VzZUtlcm5lbEJsdXI9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSl9Z2V0IGRlcHRoU2NhbGUoKXtyZXR1cm4gdGhpcy5fZGVwdGhTY2FsZSE9PXZvaWQgMD90aGlzLl9kZXB0aFNjYWxlOnRoaXMuX2xpZ2h0LmdldERlcHRoU2NhbGUoKX1zZXQgZGVwdGhTY2FsZShlKXt0aGlzLl9kZXB0aFNjYWxlPWV9X3ZhbGlkYXRlRmlsdGVyKGUpe3JldHVybiBlfWdldCBmaWx0ZXIoKXtyZXR1cm4gdGhpcy5fZmlsdGVyfXNldCBmaWx0ZXIoZSl7aWYoZT10aGlzLl92YWxpZGF0ZUZpbHRlcihlKSx0aGlzLl9saWdodC5uZWVkQ3ViZSgpKXtpZihlPT09Ry5GSUxURVJfQkxVUkVYUE9ORU5USUFMU0hBRE9XTUFQKXt0aGlzLnVzZUV4cG9uZW50aWFsU2hhZG93TWFwPSEwO3JldHVybn1lbHNlIGlmKGU9PT1HLkZJTFRFUl9CTFVSQ0xPU0VFWFBPTkVOVElBTFNIQURPV01BUCl7dGhpcy51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwPSEwO3JldHVybn1lbHNlIGlmKGU9PT1HLkZJTFRFUl9QQ0Z8fGU9PT1HLkZJTFRFUl9QQ1NTKXt0aGlzLnVzZVBvaXNzb25TYW1wbGluZz0hMDtyZXR1cm59fWlmKChlPT09Ry5GSUxURVJfUENGfHxlPT09Ry5GSUxURVJfUENTUykmJiF0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS5fZmVhdHVyZXMuc3VwcG9ydFNoYWRvd1NhbXBsZXJzKXt0aGlzLnVzZVBvaXNzb25TYW1wbGluZz0hMDtyZXR1cm59dGhpcy5fZmlsdGVyIT09ZSYmKHRoaXMuX2ZpbHRlcj1lLHRoaXMuX2Rpc3Bvc2VCbHVyUG9zdFByb2Nlc3NlcygpLHRoaXMuX2FwcGx5RmlsdGVyVmFsdWVzKCksdGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKSl9Z2V0IHVzZVBvaXNzb25TYW1wbGluZygpe3JldHVybiB0aGlzLmZpbHRlcj09PUcuRklMVEVSX1BPSVNTT05TQU1QTElOR31zZXQgdXNlUG9pc3NvblNhbXBsaW5nKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfUE9JU1NPTlNBTVBMSU5HKTshZSYmdGhpcy5maWx0ZXIhPT1HLkZJTFRFUl9QT0lTU09OU0FNUExJTkd8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IHVzZUV4cG9uZW50aWFsU2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfRVhQT05FTlRJQUxTSEFET1dNQVB9c2V0IHVzZUV4cG9uZW50aWFsU2hhZG93TWFwKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfRVhQT05FTlRJQUxTSEFET1dNQVApOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX0VYUE9ORU5USUFMU0hBRE9XTUFQfHwodGhpcy5maWx0ZXI9ZT90OkcuRklMVEVSX05PTkUpfWdldCB1c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAoKXtyZXR1cm4gdGhpcy5maWx0ZXI9PT1HLkZJTFRFUl9CTFVSRVhQT05FTlRJQUxTSEFET1dNQVB9c2V0IHVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcChlKXtjb25zdCB0PXRoaXMuX3ZhbGlkYXRlRmlsdGVyKEcuRklMVEVSX0JMVVJFWFBPTkVOVElBTFNIQURPV01BUCk7IWUmJnRoaXMuZmlsdGVyIT09Ry5GSUxURVJfQkxVUkVYUE9ORU5USUFMU0hBRE9XTUFQfHwodGhpcy5maWx0ZXI9ZT90OkcuRklMVEVSX05PTkUpfWdldCB1c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfQ0xPU0VFWFBPTkVOVElBTFNIQURPV01BUH1zZXQgdXNlQ2xvc2VFeHBvbmVudGlhbFNoYWRvd01hcChlKXtjb25zdCB0PXRoaXMuX3ZhbGlkYXRlRmlsdGVyKEcuRklMVEVSX0NMT1NFRVhQT05FTlRJQUxTSEFET1dNQVApOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX0NMT1NFRVhQT05FTlRJQUxTSEFET1dNQVB8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IHVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfQkxVUkNMT1NFRVhQT05FTlRJQUxTSEFET1dNQVB9c2V0IHVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfQkxVUkNMT1NFRVhQT05FTlRJQUxTSEFET1dNQVApOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX0JMVVJDTE9TRUVYUE9ORU5USUFMU0hBRE9XTUFQfHwodGhpcy5maWx0ZXI9ZT90OkcuRklMVEVSX05PTkUpfWdldCB1c2VQZXJjZW50YWdlQ2xvc2VyRmlsdGVyaW5nKCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENGfXNldCB1c2VQZXJjZW50YWdlQ2xvc2VyRmlsdGVyaW5nKGUpe2NvbnN0IHQ9dGhpcy5fdmFsaWRhdGVGaWx0ZXIoRy5GSUxURVJfUENGKTshZSYmdGhpcy5maWx0ZXIhPT1HLkZJTFRFUl9QQ0Z8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IGZpbHRlcmluZ1F1YWxpdHkoKXtyZXR1cm4gdGhpcy5fZmlsdGVyaW5nUXVhbGl0eX1zZXQgZmlsdGVyaW5nUXVhbGl0eShlKXt0aGlzLl9maWx0ZXJpbmdRdWFsaXR5IT09ZSYmKHRoaXMuX2ZpbHRlcmluZ1F1YWxpdHk9ZSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKSx0aGlzLl9hcHBseUZpbHRlclZhbHVlcygpLHRoaXMuX2xpZ2h0Ll9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCkpfWdldCB1c2VDb250YWN0SGFyZGVuaW5nU2hhZG93KCl7cmV0dXJuIHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENTU31zZXQgdXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdyhlKXtjb25zdCB0PXRoaXMuX3ZhbGlkYXRlRmlsdGVyKEcuRklMVEVSX1BDU1MpOyFlJiZ0aGlzLmZpbHRlciE9PUcuRklMVEVSX1BDU1N8fCh0aGlzLmZpbHRlcj1lP3Q6Ry5GSUxURVJfTk9ORSl9Z2V0IGNvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvKCl7cmV0dXJuIHRoaXMuX2NvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvfXNldCBjb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbyhlKXt0aGlzLl9jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbz1lfWdldCBkYXJrbmVzcygpe3JldHVybiB0aGlzLl9kYXJrbmVzc31zZXQgZGFya25lc3MoZSl7dGhpcy5zZXREYXJrbmVzcyhlKX1nZXREYXJrbmVzcygpe3JldHVybiB0aGlzLl9kYXJrbmVzc31zZXREYXJrbmVzcyhlKXtyZXR1cm4gZT49MT90aGlzLl9kYXJrbmVzcz0xOmU8PTA/dGhpcy5fZGFya25lc3M9MDp0aGlzLl9kYXJrbmVzcz1lLHRoaXN9Z2V0IHRyYW5zcGFyZW5jeVNoYWRvdygpe3JldHVybiB0aGlzLl90cmFuc3BhcmVuY3lTaGFkb3d9c2V0IHRyYW5zcGFyZW5jeVNoYWRvdyhlKXt0aGlzLnNldFRyYW5zcGFyZW5jeVNoYWRvdyhlKX1zZXRUcmFuc3BhcmVuY3lTaGFkb3coZSl7cmV0dXJuIHRoaXMuX3RyYW5zcGFyZW5jeVNoYWRvdz1lLHRoaXN9Z2V0U2hhZG93TWFwKCl7cmV0dXJuIHRoaXMuX3NoYWRvd01hcH1nZXRTaGFkb3dNYXBGb3JSZW5kZXJpbmcoKXtyZXR1cm4gdGhpcy5fc2hhZG93TWFwMj90aGlzLl9zaGFkb3dNYXAyOnRoaXMuX3NoYWRvd01hcH1nZXRDbGFzc05hbWUoKXtyZXR1cm4gRy5DTEFTU05BTUV9YWRkU2hhZG93Q2FzdGVyKGUsdD0hMCl7aWYoIXRoaXMuX3NoYWRvd01hcClyZXR1cm4gdGhpcztpZih0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdHx8KHRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0PVtdKSx0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdC5pbmRleE9mKGUpPT09LTEmJnRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0LnB1c2goZSksdClmb3IoY29uc3QgaSBvZiBlLmdldENoaWxkTWVzaGVzKCkpdGhpcy5fc2hhZG93TWFwLnJlbmRlckxpc3QuaW5kZXhPZihpKT09PS0xJiZ0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdC5wdXNoKGkpO3JldHVybiB0aGlzfXJlbW92ZVNoYWRvd0Nhc3RlcihlLHQ9ITApe2lmKCF0aGlzLl9zaGFkb3dNYXB8fCF0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdClyZXR1cm4gdGhpcztjb25zdCBpPXRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0LmluZGV4T2YoZSk7aWYoaSE9PS0xJiZ0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdC5zcGxpY2UoaSwxKSx0KWZvcihjb25zdCBzIG9mIGUuZ2V0Q2hpbGRyZW4oKSl0aGlzLnJlbW92ZVNoYWRvd0Nhc3RlcihzKTtyZXR1cm4gdGhpc31nZXRMaWdodCgpe3JldHVybiB0aGlzLl9saWdodH1fZ2V0Q2FtZXJhKCl7dmFyIGU7cmV0dXJuKGU9dGhpcy5fY2FtZXJhKSE9PW51bGwmJmUhPT12b2lkIDA/ZTp0aGlzLl9zY2VuZS5hY3RpdmVDYW1lcmF9Z2V0IG1hcFNpemUoKXtyZXR1cm4gdGhpcy5fbWFwU2l6ZX1zZXQgbWFwU2l6ZShlKXt0aGlzLl9tYXBTaXplPWUsdGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKSx0aGlzLnJlY3JlYXRlU2hhZG93TWFwKCl9X2luaXRpYWxpemVHZW5lcmF0b3IoKXt0aGlzLl9saWdodC5fbWFya01lc2hlc0FzTGlnaHREaXJ0eSgpLHRoaXMuX2luaXRpYWxpemVTaGFkb3dNYXAoKX1fY3JlYXRlVGFyZ2V0UmVuZGVyVGV4dHVyZSgpe2NvbnN0IGU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7ZS5fZmVhdHVyZXMuc3VwcG9ydERlcHRoU3RlbmNpbFRleHR1cmU/KHRoaXMuX3NoYWRvd01hcD1uZXcgX3QodGhpcy5fbGlnaHQubmFtZSsiX3NoYWRvd01hcCIsdGhpcy5fbWFwU2l6ZSx0aGlzLl9zY2VuZSwhMSwhMCx0aGlzLl90ZXh0dXJlVHlwZSx0aGlzLl9saWdodC5uZWVkQ3ViZSgpLHZvaWQgMCwhMSwhMSksdGhpcy5fc2hhZG93TWFwLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZS51c2VSZXZlcnNlRGVwdGhCdWZmZXI/NTE2OjUxMywhMCkpOnRoaXMuX3NoYWRvd01hcD1uZXcgX3QodGhpcy5fbGlnaHQubmFtZSsiX3NoYWRvd01hcCIsdGhpcy5fbWFwU2l6ZSx0aGlzLl9zY2VuZSwhMSwhMCx0aGlzLl90ZXh0dXJlVHlwZSx0aGlzLl9saWdodC5uZWVkQ3ViZSgpKX1faW5pdGlhbGl6ZVNoYWRvd01hcCgpe2lmKHRoaXMuX2NyZWF0ZVRhcmdldFJlbmRlclRleHR1cmUoKSx0aGlzLl9zaGFkb3dNYXA9PT1udWxsKXJldHVybjt0aGlzLl9zaGFkb3dNYXAud3JhcFU9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAud3JhcFY9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAuYW5pc290cm9waWNGaWx0ZXJpbmdMZXZlbD0xLHRoaXMuX3NoYWRvd01hcC51cGRhdGVTYW1wbGluZ01vZGUoTi5CSUxJTkVBUl9TQU1QTElOR01PREUpLHRoaXMuX3NoYWRvd01hcC5yZW5kZXJQYXJ0aWNsZXM9ITEsdGhpcy5fc2hhZG93TWFwLmlnbm9yZUNhbWVyYVZpZXdwb3J0PSEwLHRoaXMuX3N0b3JlZFVuaXF1ZUlkJiYodGhpcy5fc2hhZG93TWFwLnVuaXF1ZUlkPXRoaXMuX3N0b3JlZFVuaXF1ZUlkKSx0aGlzLl9zaGFkb3dNYXAuY3VzdG9tUmVuZGVyRnVuY3Rpb249dGhpcy5fcmVuZGVyRm9yU2hhZG93TWFwLmJpbmQodGhpcyksdGhpcy5fc2hhZG93TWFwLmN1c3RvbUlzUmVhZHlGdW5jdGlvbj0oKT0+ITA7Y29uc3QgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKTt0aGlzLl9zaGFkb3dNYXAub25CZWZvcmVCaW5kT2JzZXJ2YWJsZS5hZGQoKCk9Pnt2YXIgczt0aGlzLl9jdXJyZW50U2NlbmVVQk89dGhpcy5fc2NlbmUuZ2V0U2NlbmVVbmlmb3JtQnVmZmVyKCksKHM9ZS5fZGVidWdQdXNoR3JvdXApPT09bnVsbHx8cz09PXZvaWQgMHx8cy5jYWxsKGUsYHNoYWRvdyBtYXAgZ2VuZXJhdGlvbiBmb3IgcGFzcyBpZCAke2UuY3VycmVudFJlbmRlclBhc3NJZH1gLDEpfSksdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQocz0+e3RoaXMuX3NjZW5lVUJPcyYmdGhpcy5fc2NlbmUuc2V0U2NlbmVVbmlmb3JtQnVmZmVyKHRoaXMuX3NjZW5lVUJPc1swXSksdGhpcy5fY3VycmVudEZhY2VJbmRleD1zLHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDRiYmZS5zZXRDb2xvcldyaXRlKCExKSx0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCgpLHRoaXMuX3NjZW5lLnNldFRyYW5zZm9ybU1hdHJpeCh0aGlzLl92aWV3TWF0cml4LHRoaXMuX3Byb2plY3Rpb25NYXRyaXgpLHRoaXMuX3VzZVVCTyYmKHRoaXMuX3NjZW5lLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLnVuYmluZEVmZmVjdCgpLHRoaXMuX3NjZW5lLmZpbmFsaXplU2NlbmVVYm8oKSl9KSx0aGlzLl9zaGFkb3dNYXAub25BZnRlclVuYmluZE9ic2VydmFibGUuYWRkKCgpPT57dmFyIHMscjtpZih0aGlzLl9zY2VuZVVCT3MmJnRoaXMuX3NjZW5lLnNldFNjZW5lVW5pZm9ybUJ1ZmZlcih0aGlzLl9jdXJyZW50U2NlbmVVQk8pLHRoaXMuX3NjZW5lLnVwZGF0ZVRyYW5zZm9ybU1hdHJpeCgpLHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDRiYmZS5zZXRDb2xvcldyaXRlKCEwKSwhdGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAmJiF0aGlzLnVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKXsocz1lLl9kZWJ1Z1BvcEdyb3VwKT09PW51bGx8fHM9PT12b2lkIDB8fHMuY2FsbChlLDEpO3JldHVybn1jb25zdCBuPXRoaXMuZ2V0U2hhZG93TWFwRm9yUmVuZGVyaW5nKCk7biYmKHRoaXMuX3NjZW5lLnBvc3RQcm9jZXNzTWFuYWdlci5kaXJlY3RSZW5kZXIodGhpcy5fYmx1clBvc3RQcm9jZXNzZXMsbi5yZW5kZXJUYXJnZXQsITApLGUudW5CaW5kRnJhbWVidWZmZXIobi5yZW5kZXJUYXJnZXQsITApLChyPWUuX2RlYnVnUG9wR3JvdXApPT09bnVsbHx8cj09PXZvaWQgMHx8ci5jYWxsKGUsMSkpfSk7Y29uc3QgdD1uZXcgbWUoMCwwLDAsMCksaT1uZXcgbWUoMSwxLDEsMSk7dGhpcy5fc2hhZG93TWFwLm9uQ2xlYXJPYnNlcnZhYmxlLmFkZChzPT57dGhpcy5fZmlsdGVyPT09Ry5GSUxURVJfUENGP3MuY2xlYXIoaSwhMSwhMCwhMSk6dGhpcy51c2VFeHBvbmVudGlhbFNoYWRvd01hcHx8dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXA/cy5jbGVhcih0LCEwLCEwLCExKTpzLmNsZWFyKGksITAsITAsITEpfSksdGhpcy5fc2hhZG93TWFwLm9uUmVzaXplT2JzZXJ2YWJsZS5hZGQocz0+e3RoaXMuX3N0b3JlZFVuaXF1ZUlkPXRoaXMuX3NoYWRvd01hcC51bmlxdWVJZCx0aGlzLl9tYXBTaXplPXMuZ2V0UmVuZGVyU2l6ZSgpLHRoaXMuX2xpZ2h0Ll9tYXJrTWVzaGVzQXNMaWdodERpcnR5KCksdGhpcy5yZWNyZWF0ZVNoYWRvd01hcCgpfSk7Zm9yKGxldCBzPVdlLk1JTl9SRU5ERVJJTkdHUk9VUFM7czxXZS5NQVhfUkVOREVSSU5HR1JPVVBTO3MrKyl0aGlzLl9zaGFkb3dNYXAuc2V0UmVuZGVyaW5nQXV0b0NsZWFyRGVwdGhTdGVuY2lsKHMsITEpfV9pbml0aWFsaXplQmx1clJUVEFuZFBvc3RQcm9jZXNzZXMoKXtjb25zdCBlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLHQ9dGhpcy5fbWFwU2l6ZS90aGlzLmJsdXJTY2FsZTsoIXRoaXMudXNlS2VybmVsQmx1cnx8dGhpcy5ibHVyU2NhbGUhPT0xKSYmKHRoaXMuX3NoYWRvd01hcDI9bmV3IF90KHRoaXMuX2xpZ2h0Lm5hbWUrIl9zaGFkb3dNYXAyIix0LHRoaXMuX3NjZW5lLCExLCEwLHRoaXMuX3RleHR1cmVUeXBlLHZvaWQgMCx2b2lkIDAsITEpLHRoaXMuX3NoYWRvd01hcDIud3JhcFU9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9zaGFkb3dNYXAyLndyYXBWPU4uQ0xBTVBfQUREUkVTU01PREUsdGhpcy5fc2hhZG93TWFwMi51cGRhdGVTYW1wbGluZ01vZGUoTi5CSUxJTkVBUl9TQU1QTElOR01PREUpKSx0aGlzLnVzZUtlcm5lbEJsdXI/KHRoaXMuX2tlcm5lbEJsdXJYUG9zdHByb2Nlc3M9bmV3IEp0KHRoaXMuX2xpZ2h0Lm5hbWUrIktlcm5lbEJsdXJYIixuZXcgdmUoMSwwKSx0aGlzLmJsdXJLZXJuZWwsMSxudWxsLE4uQklMSU5FQVJfU0FNUExJTkdNT0RFLGUsITEsdGhpcy5fdGV4dHVyZVR5cGUpLHRoaXMuX2tlcm5lbEJsdXJYUG9zdHByb2Nlc3Mud2lkdGg9dCx0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLmhlaWdodD10LHRoaXMuX2tlcm5lbEJsdXJYUG9zdHByb2Nlc3MuZXh0ZXJuYWxUZXh0dXJlU2FtcGxlckJpbmRpbmc9ITAsdGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcy5vbkFwcGx5T2JzZXJ2YWJsZS5hZGQoaT0+e2kuc2V0VGV4dHVyZSgidGV4dHVyZVNhbXBsZXIiLHRoaXMuX3NoYWRvd01hcCl9KSx0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzPW5ldyBKdCh0aGlzLl9saWdodC5uYW1lKyJLZXJuZWxCbHVyWSIsbmV3IHZlKDAsMSksdGhpcy5ibHVyS2VybmVsLDEsbnVsbCxOLkJJTElORUFSX1NBTVBMSU5HTU9ERSxlLCExLHRoaXMuX3RleHR1cmVUeXBlKSx0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLmF1dG9DbGVhcj0hMSx0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzLmF1dG9DbGVhcj0hMSx0aGlzLl90ZXh0dXJlVHlwZT09PTAmJih0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLnBhY2tlZEZsb2F0PSEwLHRoaXMuX2tlcm5lbEJsdXJZUG9zdHByb2Nlc3MucGFja2VkRmxvYXQ9ITApLHRoaXMuX2JsdXJQb3N0UHJvY2Vzc2VzPVt0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzLHRoaXMuX2tlcm5lbEJsdXJZUG9zdHByb2Nlc3NdKToodGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzPW5ldyBNZSh0aGlzLl9saWdodC5uYW1lKyJEZXB0aEJveEJsdXIiLCJkZXB0aEJveEJsdXIiLFsic2NyZWVuU2l6ZSIsImJveE9mZnNldCJdLFtdLDEsbnVsbCxOLkJJTElORUFSX1NBTVBMSU5HTU9ERSxlLCExLCIjZGVmaW5lIE9GRlNFVCAiK3RoaXMuX2JsdXJCb3hPZmZzZXQsdGhpcy5fdGV4dHVyZVR5cGUpLHRoaXMuX2JveEJsdXJQb3N0cHJvY2Vzcy5leHRlcm5hbFRleHR1cmVTYW1wbGVyQmluZGluZz0hMCx0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3Mub25BcHBseU9ic2VydmFibGUuYWRkKGk9PntpLnNldEZsb2F0Migic2NyZWVuU2l6ZSIsdCx0KSxpLnNldFRleHR1cmUoInRleHR1cmVTYW1wbGVyIix0aGlzLl9zaGFkb3dNYXApfSksdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzLmF1dG9DbGVhcj0hMSx0aGlzLl9ibHVyUG9zdFByb2Nlc3Nlcz1bdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzXSl9X3JlbmRlckZvclNoYWRvd01hcChlLHQsaSxzKXtsZXQgcjtpZihzLmxlbmd0aClmb3Iocj0wO3I8cy5sZW5ndGg7cisrKXRoaXMuX3JlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAocy5kYXRhW3JdKTtmb3Iocj0wO3I8ZS5sZW5ndGg7cisrKXRoaXMuX3JlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAoZS5kYXRhW3JdKTtmb3Iocj0wO3I8dC5sZW5ndGg7cisrKXRoaXMuX3JlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAodC5kYXRhW3JdKTtpZih0aGlzLl90cmFuc3BhcmVuY3lTaGFkb3cpZm9yKHI9MDtyPGkubGVuZ3RoO3IrKyl0aGlzLl9yZW5kZXJTdWJNZXNoRm9yU2hhZG93TWFwKGkuZGF0YVtyXSwhMCk7ZWxzZSBmb3Iocj0wO3I8aS5sZW5ndGg7cisrKWkuZGF0YVtyXS5nZXRFZmZlY3RpdmVNZXNoKCkuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlSW50ZXJtZWRpYXRlPSExfV9iaW5kQ3VzdG9tRWZmZWN0Rm9yUmVuZGVyU3ViTWVzaEZvclNoYWRvd01hcChlLHQsaSl7dC5zZXRNYXRyaXgoInZpZXdQcm9qZWN0aW9uIix0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCgpKX1fcmVuZGVyU3ViTWVzaEZvclNoYWRvd01hcChlLHQ9ITEpe3ZhciBpLHM7Y29uc3Qgcj1lLmdldFJlbmRlcmluZ01lc2goKSxuPWUuZ2V0RWZmZWN0aXZlTWVzaCgpLGE9dGhpcy5fc2NlbmUsbz1hLmdldEVuZ2luZSgpLGg9ZS5nZXRNYXRlcmlhbCgpO2lmKG4uX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlSW50ZXJtZWRpYXRlPSExLCFofHxlLnZlcnRpY2VzQ291bnQ9PT0wfHxlLl9yZW5kZXJJZD09PWEuZ2V0UmVuZGVySWQoKSlyZXR1cm47Y29uc3QgbD1uLl9nZXRXb3JsZE1hdHJpeERldGVybWluYW50KCk8MDtsZXQgdT0oaT1yLm92ZXJyaWRlTWF0ZXJpYWxTaWRlT3JpZW50YXRpb24pIT09bnVsbCYmaSE9PXZvaWQgMD9pOmguc2lkZU9yaWVudGF0aW9uO2wmJih1PXU9PT0wPzE6MCk7Y29uc3QgZD11PT09MDtvLnNldFN0YXRlKGguYmFja0ZhY2VDdWxsaW5nLHZvaWQgMCx2b2lkIDAsZCxoLmN1bGxCYWNrRmFjZXMpO2NvbnN0IGY9ci5fZ2V0SW5zdGFuY2VzUmVuZGVyTGlzdChlLl9pZCwhIWUuZ2V0UmVwbGFjZW1lbnRNZXNoKCkpO2lmKGYubXVzdFJldHVybilyZXR1cm47Y29uc3QgXz1vLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMmJihmLnZpc2libGVJbnN0YW5jZXNbZS5faWRdIT09bnVsbCYmZi52aXNpYmxlSW5zdGFuY2VzW2UuX2lkXSE9PXZvaWQgMHx8ci5oYXNUaGluSW5zdGFuY2VzKTtpZighKHRoaXMuY3VzdG9tQWxsb3dSZW5kZXJpbmcmJiF0aGlzLmN1c3RvbUFsbG93UmVuZGVyaW5nKGUpKSlpZih0aGlzLmlzUmVhZHkoZSxfLHQpKXtlLl9yZW5kZXJJZD1hLmdldFJlbmRlcklkKCk7Y29uc3QgRT1oLnNoYWRvd0RlcHRoV3JhcHBlcixtPShzPUU9PW51bGw/dm9pZCAwOkUuZ2V0RWZmZWN0KGUsdGhpcyxvLmN1cnJlbnRSZW5kZXJQYXNzSWQpKSE9PW51bGwmJnMhPT12b2lkIDA/czplLl9nZXREcmF3V3JhcHBlcigpLHY9bWkuR2V0RWZmZWN0KG0pO28uZW5hYmxlRWZmZWN0KG0pLF98fHIuX2JpbmQoZSx2LGguZmlsbE1vZGUpLHRoaXMuZ2V0VHJhbnNmb3JtTWF0cml4KCksdi5zZXRGbG9hdDMoImJpYXNBbmRTY2FsZVNNIix0aGlzLmJpYXMsdGhpcy5ub3JtYWxCaWFzLHRoaXMuZGVwdGhTY2FsZSksdGhpcy5nZXRMaWdodCgpLmdldFR5cGVJRCgpPT09aGUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD92LnNldFZlY3RvcjMoImxpZ2h0RGF0YVNNIix0aGlzLl9jYWNoZWREaXJlY3Rpb24pOnYuc2V0VmVjdG9yMygibGlnaHREYXRhU00iLHRoaXMuX2NhY2hlZFBvc2l0aW9uKTtjb25zdCBTPXRoaXMuX2dldENhbWVyYSgpO2lmKFMmJnYuc2V0RmxvYXQyKCJkZXB0aFZhbHVlc1NNIix0aGlzLmdldExpZ2h0KCkuZ2V0RGVwdGhNaW5aKFMpLHRoaXMuZ2V0TGlnaHQoKS5nZXREZXB0aE1pblooUykrdGhpcy5nZXRMaWdodCgpLmdldERlcHRoTWF4WihTKSksdCYmdGhpcy5lbmFibGVTb2Z0VHJhbnNwYXJlbnRTaGFkb3cmJnYuc2V0RmxvYXQoInNvZnRUcmFuc3BhcmVudFNoYWRvd1NNIixuLnZpc2liaWxpdHkqaC5hbHBoYSksRSllLl9zZXRNYWluRHJhd1dyYXBwZXJPdmVycmlkZShtKSxFLnN0YW5kYWxvbmU/RS5iYXNlTWF0ZXJpYWwuYmluZEZvclN1Yk1lc2gobi5nZXRXb3JsZE1hdHJpeCgpLHIsZSk6aC5iaW5kRm9yU3ViTWVzaChuLmdldFdvcmxkTWF0cml4KCkscixlKSxlLl9zZXRNYWluRHJhd1dyYXBwZXJPdmVycmlkZShudWxsKTtlbHNle2lmKHRoaXMudXNlT3BhY2l0eVRleHR1cmVGb3JUcmFuc3BhcmVudFNoYWRvdyl7Y29uc3QgQT1oLm9wYWNpdHlUZXh0dXJlO0EmJih2LnNldFRleHR1cmUoImRpZmZ1c2VTYW1wbGVyIixBKSx2LnNldE1hdHJpeCgiZGlmZnVzZU1hdHJpeCIsQS5nZXRUZXh0dXJlTWF0cml4KCl8fHRoaXMuX2RlZmF1bHRUZXh0dXJlTWF0cml4KSl9ZWxzZSBpZihoLm5lZWRBbHBoYVRlc3RpbmcoKXx8aC5uZWVkQWxwaGFCbGVuZGluZygpKXtjb25zdCBBPWguZ2V0QWxwaGFUZXN0VGV4dHVyZSgpO0EmJih2LnNldFRleHR1cmUoImRpZmZ1c2VTYW1wbGVyIixBKSx2LnNldE1hdHJpeCgiZGlmZnVzZU1hdHJpeCIsQS5nZXRUZXh0dXJlTWF0cml4KCl8fHRoaXMuX2RlZmF1bHRUZXh0dXJlTWF0cml4KSl9aWYoci51c2VCb25lcyYmci5jb21wdXRlQm9uZXNVc2luZ1NoYWRlcnMmJnIuc2tlbGV0b24pe2NvbnN0IEE9ci5za2VsZXRvbjtpZihBLmlzVXNpbmdUZXh0dXJlRm9yTWF0cmljZXMpe2NvbnN0IEM9QS5nZXRUcmFuc2Zvcm1NYXRyaXhUZXh0dXJlKHIpO2lmKCFDKXJldHVybjt2LnNldFRleHR1cmUoImJvbmVTYW1wbGVyIixDKSx2LnNldEZsb2F0KCJib25lVGV4dHVyZVdpZHRoIiw0KihBLmJvbmVzLmxlbmd0aCsxKSl9ZWxzZSB2LnNldE1hdHJpY2VzKCJtQm9uZXMiLEEuZ2V0VHJhbnNmb3JtTWF0cmljZXMocikpfWllLkJpbmRNb3JwaFRhcmdldFBhcmFtZXRlcnMocix2KSxyLm1vcnBoVGFyZ2V0TWFuYWdlciYmci5tb3JwaFRhcmdldE1hbmFnZXIuaXNVc2luZ1RleHR1cmVGb3JUYXJnZXRzJiZyLm1vcnBoVGFyZ2V0TWFuYWdlci5fYmluZCh2KSxycyh2LGgsYSl9IXRoaXMuX3VzZVVCTyYmIUUmJnRoaXMuX2JpbmRDdXN0b21FZmZlY3RGb3JSZW5kZXJTdWJNZXNoRm9yU2hhZG93TWFwKGUsdixuKSxpZS5CaW5kU2NlbmVVbmlmb3JtQnVmZmVyKHYsdGhpcy5fc2NlbmUuZ2V0U2NlbmVVbmlmb3JtQnVmZmVyKCkpLHRoaXMuX3NjZW5lLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLmJpbmRVbmlmb3JtQnVmZmVyKCk7Y29uc3QgeT1uLmdldFdvcmxkTWF0cml4KCk7XyYmKG4uZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QodiwiTWVzaCIpLG4udHJhbnNmZXJUb0VmZmVjdCh5KSksdGhpcy5mb3JjZUJhY2tGYWNlc09ubHkmJm8uc2V0U3RhdGUoITAsMCwhMSwhMCxoLmN1bGxCYWNrRmFjZXMpLHRoaXMub25CZWZvcmVTaGFkb3dNYXBSZW5kZXJNZXNoT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMociksdGhpcy5vbkJlZm9yZVNoYWRvd01hcFJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHYpLHIuX3Byb2Nlc3NSZW5kZXJpbmcobixlLHYsaC5maWxsTW9kZSxmLF8sKEEsQyk9PntuIT09ciYmIUE/KHIuZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QodiwiTWVzaCIpLHIudHJhbnNmZXJUb0VmZmVjdChDKSk6KG4uZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QodiwiTWVzaCIpLG4udHJhbnNmZXJUb0VmZmVjdChBP0M6eSkpfSksdGhpcy5mb3JjZUJhY2tGYWNlc09ubHkmJm8uc2V0U3RhdGUoITAsMCwhMSwhMSxoLmN1bGxCYWNrRmFjZXMpLHRoaXMub25BZnRlclNoYWRvd01hcFJlbmRlck9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKHYpLHRoaXMub25BZnRlclNoYWRvd01hcFJlbmRlck1lc2hPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKX1lbHNlIHRoaXMuX3NoYWRvd01hcCYmdGhpcy5fc2hhZG93TWFwLnJlc2V0UmVmcmVzaENvdW50ZXIoKX1fYXBwbHlGaWx0ZXJWYWx1ZXMoKXt0aGlzLl9zaGFkb3dNYXAmJih0aGlzLmZpbHRlcj09PUcuRklMVEVSX05PTkV8fHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENTUz90aGlzLl9zaGFkb3dNYXAudXBkYXRlU2FtcGxpbmdNb2RlKE4uTkVBUkVTVF9TQU1QTElOR01PREUpOnRoaXMuX3NoYWRvd01hcC51cGRhdGVTYW1wbGluZ01vZGUoTi5CSUxJTkVBUl9TQU1QTElOR01PREUpKX1mb3JjZUNvbXBpbGF0aW9uKGUsdCl7Y29uc3QgaT17dXNlSW5zdGFuY2VzOiExLC4uLnR9LHM9dGhpcy5nZXRTaGFkb3dNYXAoKTtpZighcyl7ZSYmZSh0aGlzKTtyZXR1cm59Y29uc3Qgcj1zLnJlbmRlckxpc3Q7aWYoIXIpe2UmJmUodGhpcyk7cmV0dXJufWNvbnN0IG49bmV3IEFycmF5O2Zvcihjb25zdCBoIG9mIHIpbi5wdXNoKC4uLmguc3ViTWVzaGVzKTtpZihuLmxlbmd0aD09PTApe2UmJmUodGhpcyk7cmV0dXJufWxldCBhPTA7Y29uc3Qgbz0oKT0+e3ZhciBoLGw7aWYoISghdGhpcy5fc2NlbmV8fCF0aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSkpe2Zvcig7dGhpcy5pc1JlYWR5KG5bYV0saS51c2VJbnN0YW5jZXMsKGw9KGg9blthXS5nZXRNYXRlcmlhbCgpKT09PW51bGx8fGg9PT12b2lkIDA/dm9pZCAwOmgubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKG5bYV0uZ2V0TWVzaCgpKSkhPT1udWxsJiZsIT09dm9pZCAwP2w6ITEpOylpZihhKyssYT49bi5sZW5ndGgpe2UmJmUodGhpcyk7cmV0dXJufXNldFRpbWVvdXQobywxNil9fTtvKCl9Zm9yY2VDb21waWxhdGlvbkFzeW5jKGUpe3JldHVybiBuZXcgUHJvbWlzZSh0PT57dGhpcy5mb3JjZUNvbXBpbGF0aW9uKCgpPT57dCgpfSxlKX0pfV9pc1JlYWR5Q3VzdG9tRGVmaW5lcyhlLHQsaSl7fV9wcmVwYXJlU2hhZG93RGVmaW5lcyhlLHQsaSxzKXtpLnB1c2goIiNkZWZpbmUgU01fTElHSFRUWVBFXyIrdGhpcy5fbGlnaHQuZ2V0Q2xhc3NOYW1lKCkudG9VcHBlckNhc2UoKSksaS5wdXNoKCIjZGVmaW5lIFNNX0ZMT0FUICIrKHRoaXMuX3RleHR1cmVUeXBlIT09MD8iMSI6IjAiKSksaS5wdXNoKCIjZGVmaW5lIFNNX0VTTSAiKyh0aGlzLnVzZUV4cG9uZW50aWFsU2hhZG93TWFwfHx0aGlzLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD8iMSI6IjAiKSksaS5wdXNoKCIjZGVmaW5lIFNNX0RFUFRIVEVYVFVSRSAiKyh0aGlzLnVzZVBlcmNlbnRhZ2VDbG9zZXJGaWx0ZXJpbmd8fHRoaXMudXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdz8iMSI6IjAiKSk7Y29uc3Qgcj1lLmdldE1lc2goKTtyZXR1cm4gaS5wdXNoKCIjZGVmaW5lIFNNX05PUk1BTEJJQVMgIisodGhpcy5ub3JtYWxCaWFzJiZyLmlzVmVydGljZXNEYXRhUHJlc2VudChnLk5vcm1hbEtpbmQpPyIxIjoiMCIpKSxpLnB1c2goIiNkZWZpbmUgU01fRElSRUNUSU9OSU5MSUdIVERBVEEgIisodGhpcy5nZXRMaWdodCgpLmdldFR5cGVJRCgpPT09aGUuTElHSFRUWVBFSURfRElSRUNUSU9OQUxMSUdIVD8iMSI6IjAiKSksaS5wdXNoKCIjZGVmaW5lIFNNX1VTRURJU1RBTkNFICIrKHRoaXMuX2xpZ2h0Lm5lZWRDdWJlKCk/IjEiOiIwIikpLGkucHVzaCgiI2RlZmluZSBTTV9TT0ZUVFJBTlNQQVJFTlRTSEFET1cgIisodGhpcy5lbmFibGVTb2Z0VHJhbnNwYXJlbnRTaGFkb3cmJnM/IjEiOiIwIikpLHRoaXMuX2lzUmVhZHlDdXN0b21EZWZpbmVzKGksZSx0KSxpfWlzUmVhZHkoZSx0LGkpe3ZhciBzO2NvbnN0IHI9ZS5nZXRNYXRlcmlhbCgpLG49cj09bnVsbD92b2lkIDA6ci5zaGFkb3dEZXB0aFdyYXBwZXI7aWYoIXIpcmV0dXJuITE7Y29uc3QgYT1bXTtpZih0aGlzLl9wcmVwYXJlU2hhZG93RGVmaW5lcyhlLHQsYSxpKSxuKXtpZighbi5pc1JlYWR5Rm9yU3ViTWVzaChlLGEsdGhpcyx0LHRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmN1cnJlbnRSZW5kZXJQYXNzSWQpKXJldHVybiExfWVsc2V7Y29uc3Qgbz1lLl9nZXREcmF3V3JhcHBlcih2b2lkIDAsITApO2xldCBoPW8uZWZmZWN0LGw9by5kZWZpbmVzO2NvbnN0IHU9W2cuUG9zaXRpb25LaW5kXSxkPWUuZ2V0TWVzaCgpO3RoaXMubm9ybWFsQmlhcyYmZC5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5Ob3JtYWxLaW5kKSYmKHUucHVzaChnLk5vcm1hbEtpbmQpLGEucHVzaCgiI2RlZmluZSBOT1JNQUwiKSxkLm5vblVuaWZvcm1TY2FsaW5nJiZhLnB1c2goIiNkZWZpbmUgTk9OVU5JRk9STVNDQUxJTkciKSk7Y29uc3QgZj1yPT1udWxsP3ZvaWQgMDpyLm5lZWRBbHBoYVRlc3RpbmcoKSxfPXI9PW51bGw/dm9pZCAwOnIubmVlZEFscGhhQmxlbmRpbmcoKTtpZihyJiYoZnx8Xykpe2xldCB5PW51bGw7aWYodGhpcy51c2VPcGFjaXR5VGV4dHVyZUZvclRyYW5zcGFyZW50U2hhZG93P3k9ci5vcGFjaXR5VGV4dHVyZTp5PXIuZ2V0QWxwaGFUZXN0VGV4dHVyZSgpLHkpe2lmKCF5LmlzUmVhZHkoKSlyZXR1cm4hMTtjb25zdCBBPShzPXIuYWxwaGFDdXRPZmYpIT09bnVsbCYmcyE9PXZvaWQgMD9zOkcuREVGQVVMVF9BTFBIQV9DVVRPRkY7YS5wdXNoKCIjZGVmaW5lIEFMUEhBVEVYVFVSRSIpLGYmJmEucHVzaChgI2RlZmluZSBBTFBIQVRFU1RWQUxVRSAke0F9JHtBJTE9PT0wPyIuIjoiIn1gKSxkLmlzVmVydGljZXNEYXRhUHJlc2VudChnLlVWS2luZCkmJih1LnB1c2goZy5VVktpbmQpLGEucHVzaCgiI2RlZmluZSBVVjEiKSksZC5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5VVjJLaW5kKSYmeS5jb29yZGluYXRlc0luZGV4PT09MSYmKHUucHVzaChnLlVWMktpbmQpLGEucHVzaCgiI2RlZmluZSBVVjIiKSl9fWNvbnN0IEU9bmV3IHpzO2lmKGQudXNlQm9uZXMmJmQuY29tcHV0ZUJvbmVzVXNpbmdTaGFkZXJzJiZkLnNrZWxldG9uKXt1LnB1c2goZy5NYXRyaWNlc0luZGljZXNLaW5kKSx1LnB1c2goZy5NYXRyaWNlc1dlaWdodHNLaW5kKSxkLm51bUJvbmVJbmZsdWVuY2Vycz40JiYodS5wdXNoKGcuTWF0cmljZXNJbmRpY2VzRXh0cmFLaW5kKSx1LnB1c2goZy5NYXRyaWNlc1dlaWdodHNFeHRyYUtpbmQpKTtjb25zdCB5PWQuc2tlbGV0b247YS5wdXNoKCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTICIrZC5udW1Cb25lSW5mbHVlbmNlcnMpLGQubnVtQm9uZUluZmx1ZW5jZXJzPjAmJkUuYWRkQ1BVU2tpbm5pbmdGYWxsYmFjaygwLGQpLHkuaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcz9hLnB1c2goIiNkZWZpbmUgQk9ORVRFWFRVUkUiKTphLnB1c2goIiNkZWZpbmUgQm9uZXNQZXJNZXNoICIrKHkuYm9uZXMubGVuZ3RoKzEpKX1lbHNlIGEucHVzaCgiI2RlZmluZSBOVU1fQk9ORV9JTkZMVUVOQ0VSUyAwIik7Y29uc3QgbT1kLm1vcnBoVGFyZ2V0TWFuYWdlcjtsZXQgdj0wO2lmKG0mJm0ubnVtSW5mbHVlbmNlcnM+MCYmKGEucHVzaCgiI2RlZmluZSBNT1JQSFRBUkdFVFMiKSx2PW0ubnVtSW5mbHVlbmNlcnMsYS5wdXNoKCIjZGVmaW5lIE5VTV9NT1JQSF9JTkZMVUVOQ0VSUyAiK3YpLG0uaXNVc2luZ1RleHR1cmVGb3JUYXJnZXRzJiZhLnB1c2goIiNkZWZpbmUgTU9SUEhUQVJHRVRTX1RFWFRVUkUiKSxpZS5QcmVwYXJlQXR0cmlidXRlc0Zvck1vcnBoVGFyZ2V0c0luZmx1ZW5jZXJzKHUsZCx2KSksT3Mocix0aGlzLl9zY2VuZSxhKSx0JiYoYS5wdXNoKCIjZGVmaW5lIElOU1RBTkNFUyIpLGllLlB1c2hBdHRyaWJ1dGVzRm9ySW5zdGFuY2VzKHUpLGUuZ2V0UmVuZGVyaW5nTWVzaCgpLmhhc1RoaW5JbnN0YW5jZXMmJmEucHVzaCgiI2RlZmluZSBUSElOX0lOU1RBTkNFUyIpKSx0aGlzLmN1c3RvbVNoYWRlck9wdGlvbnMmJnRoaXMuY3VzdG9tU2hhZGVyT3B0aW9ucy5kZWZpbmVzKWZvcihjb25zdCB5IG9mIHRoaXMuY3VzdG9tU2hhZGVyT3B0aW9ucy5kZWZpbmVzKWEuaW5kZXhPZih5KT09PS0xJiZhLnB1c2goeSk7Y29uc3QgUz1hLmpvaW4oYApgKTtpZihsIT09Uyl7bD1TO2xldCB5PSJzaGFkb3dNYXAiO2NvbnN0IEE9WyJ3b3JsZCIsIm1Cb25lcyIsInZpZXdQcm9qZWN0aW9uIiwiZGlmZnVzZU1hdHJpeCIsImxpZ2h0RGF0YVNNIiwiZGVwdGhWYWx1ZXNTTSIsImJpYXNBbmRTY2FsZVNNIiwibW9ycGhUYXJnZXRJbmZsdWVuY2VzIiwiYm9uZVRleHR1cmVXaWR0aCIsInNvZnRUcmFuc3BhcmVudFNoYWRvd1NNIiwibW9ycGhUYXJnZXRUZXh0dXJlSW5mbyIsIm1vcnBoVGFyZ2V0VGV4dHVyZUluZGljZXMiXSxDPVsiZGlmZnVzZVNhbXBsZXIiLCJib25lU2FtcGxlciIsIm1vcnBoVGFyZ2V0cyJdLGI9WyJTY2VuZSIsIk1lc2giXTtpZihzcyhBKSx0aGlzLmN1c3RvbVNoYWRlck9wdGlvbnMpe2lmKHk9dGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLnNoYWRlck5hbWUsdGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLmF0dHJpYnV0ZXMpZm9yKGNvbnN0IEwgb2YgdGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLmF0dHJpYnV0ZXMpdS5pbmRleE9mKEwpPT09LTEmJnUucHVzaChMKTtpZih0aGlzLmN1c3RvbVNoYWRlck9wdGlvbnMudW5pZm9ybXMpZm9yKGNvbnN0IEwgb2YgdGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLnVuaWZvcm1zKUEuaW5kZXhPZihMKT09PS0xJiZBLnB1c2goTCk7aWYodGhpcy5jdXN0b21TaGFkZXJPcHRpb25zLnNhbXBsZXJzKWZvcihjb25zdCBMIG9mIHRoaXMuY3VzdG9tU2hhZGVyT3B0aW9ucy5zYW1wbGVycylDLmluZGV4T2YoTCk9PT0tMSYmQy5wdXNoKEwpfWNvbnN0IE09dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCk7aD1NLmNyZWF0ZUVmZmVjdCh5LHthdHRyaWJ1dGVzOnUsdW5pZm9ybXNOYW1lczpBLHVuaWZvcm1CdWZmZXJzTmFtZXM6YixzYW1wbGVyczpDLGRlZmluZXM6UyxmYWxsYmFja3M6RSxvbkNvbXBpbGVkOm51bGwsb25FcnJvcjpudWxsLGluZGV4UGFyYW1ldGVyczp7bWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzOnZ9fSxNKSxvLnNldEVmZmVjdChoLGwpfWlmKCFoLmlzUmVhZHkoKSlyZXR1cm4hMX1yZXR1cm4odGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXB8fHRoaXMudXNlQmx1ckNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXApJiYoIXRoaXMuX2JsdXJQb3N0UHJvY2Vzc2VzfHwhdGhpcy5fYmx1clBvc3RQcm9jZXNzZXMubGVuZ3RoKSYmdGhpcy5faW5pdGlhbGl6ZUJsdXJSVFRBbmRQb3N0UHJvY2Vzc2VzKCksISh0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzJiYhdGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcy5pc1JlYWR5KCl8fHRoaXMuX2tlcm5lbEJsdXJZUG9zdHByb2Nlc3MmJiF0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzLmlzUmVhZHkoKXx8dGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzJiYhdGhpcy5fYm94Qmx1clBvc3Rwcm9jZXNzLmlzUmVhZHkoKSl9cHJlcGFyZURlZmluZXMoZSx0KXtjb25zdCBpPXRoaXMuX3NjZW5lLHM9dGhpcy5fbGlnaHQ7IWkuc2hhZG93c0VuYWJsZWR8fCFzLnNoYWRvd0VuYWJsZWR8fChlWyJTSEFET1ciK3RdPSEwLHRoaXMudXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdz8oZVsiU0hBRE9XUENTUyIrdF09ITAsdGhpcy5fZmlsdGVyaW5nUXVhbGl0eT09PUcuUVVBTElUWV9MT1c/ZVsiU0hBRE9XTE9XUVVBTElUWSIrdF09ITA6dGhpcy5fZmlsdGVyaW5nUXVhbGl0eT09PUcuUVVBTElUWV9NRURJVU0mJihlWyJTSEFET1dNRURJVU1RVUFMSVRZIit0XT0hMCkpOnRoaXMudXNlUGVyY2VudGFnZUNsb3NlckZpbHRlcmluZz8oZVsiU0hBRE9XUENGIit0XT0hMCx0aGlzLl9maWx0ZXJpbmdRdWFsaXR5PT09Ry5RVUFMSVRZX0xPVz9lWyJTSEFET1dMT1dRVUFMSVRZIit0XT0hMDp0aGlzLl9maWx0ZXJpbmdRdWFsaXR5PT09Ry5RVUFMSVRZX01FRElVTSYmKGVbIlNIQURPV01FRElVTVFVQUxJVFkiK3RdPSEwKSk6dGhpcy51c2VQb2lzc29uU2FtcGxpbmc/ZVsiU0hBRE9XUE9JU1NPTiIrdF09ITA6dGhpcy51c2VFeHBvbmVudGlhbFNoYWRvd01hcHx8dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXA/ZVsiU0hBRE9XRVNNIit0XT0hMDoodGhpcy51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwfHx0aGlzLnVzZUJsdXJDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwKSYmKGVbIlNIQURPV0NMT1NFRVNNIit0XT0hMCkscy5uZWVkQ3ViZSgpJiYoZVsiU0hBRE9XQ1VCRSIrdF09ITApKX1iaW5kU2hhZG93TGlnaHQoZSx0KXtjb25zdCBpPXRoaXMuX2xpZ2h0O2lmKCF0aGlzLl9zY2VuZS5zaGFkb3dzRW5hYmxlZHx8IWkuc2hhZG93RW5hYmxlZClyZXR1cm47Y29uc3Qgcj10aGlzLl9nZXRDYW1lcmEoKTtpZighcilyZXR1cm47Y29uc3Qgbj10aGlzLmdldFNoYWRvd01hcCgpO24mJihpLm5lZWRDdWJlKCl8fHQuc2V0TWF0cml4KCJsaWdodE1hdHJpeCIrZSx0aGlzLmdldFRyYW5zZm9ybU1hdHJpeCgpKSx0aGlzLl9maWx0ZXI9PT1HLkZJTFRFUl9QQ0Y/KHQuc2V0RGVwdGhTdGVuY2lsVGV4dHVyZSgic2hhZG93U2FtcGxlciIrZSx0aGlzLmdldFNoYWRvd01hcEZvclJlbmRlcmluZygpKSxpLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgic2hhZG93c0luZm8iLHRoaXMuZ2V0RGFya25lc3MoKSxuLmdldFNpemUoKS53aWR0aCwxL24uZ2V0U2l6ZSgpLndpZHRoLHRoaXMuZnJ1c3R1bUVkZ2VGYWxsb2ZmLGUpKTp0aGlzLl9maWx0ZXI9PT1HLkZJTFRFUl9QQ1NTPyh0LnNldERlcHRoU3RlbmNpbFRleHR1cmUoInNoYWRvd1NhbXBsZXIiK2UsdGhpcy5nZXRTaGFkb3dNYXBGb3JSZW5kZXJpbmcoKSksdC5zZXRUZXh0dXJlKCJkZXB0aFNhbXBsZXIiK2UsdGhpcy5nZXRTaGFkb3dNYXBGb3JSZW5kZXJpbmcoKSksaS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInNoYWRvd3NJbmZvIix0aGlzLmdldERhcmtuZXNzKCksMS9uLmdldFNpemUoKS53aWR0aCx0aGlzLl9jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbypuLmdldFNpemUoKS53aWR0aCx0aGlzLmZydXN0dW1FZGdlRmFsbG9mZixlKSk6KHQuc2V0VGV4dHVyZSgic2hhZG93U2FtcGxlciIrZSx0aGlzLmdldFNoYWRvd01hcEZvclJlbmRlcmluZygpKSxpLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgic2hhZG93c0luZm8iLHRoaXMuZ2V0RGFya25lc3MoKSx0aGlzLmJsdXJTY2FsZS9uLmdldFNpemUoKS53aWR0aCx0aGlzLmRlcHRoU2NhbGUsdGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsZSkpLGkuX3VuaWZvcm1CdWZmZXIudXBkYXRlRmxvYXQyKCJkZXB0aFZhbHVlcyIsdGhpcy5nZXRMaWdodCgpLmdldERlcHRoTWluWihyKSx0aGlzLmdldExpZ2h0KCkuZ2V0RGVwdGhNaW5aKHIpK3RoaXMuZ2V0TGlnaHQoKS5nZXREZXB0aE1heFoociksZSkpfWdldFRyYW5zZm9ybU1hdHJpeCgpe2NvbnN0IGU9dGhpcy5fc2NlbmU7aWYodGhpcy5fY3VycmVudFJlbmRlcklkPT09ZS5nZXRSZW5kZXJJZCgpJiZ0aGlzLl9jdXJyZW50RmFjZUluZGV4Q2FjaGU9PT10aGlzLl9jdXJyZW50RmFjZUluZGV4KXJldHVybiB0aGlzLl90cmFuc2Zvcm1NYXRyaXg7dGhpcy5fY3VycmVudFJlbmRlcklkPWUuZ2V0UmVuZGVySWQoKSx0aGlzLl9jdXJyZW50RmFjZUluZGV4Q2FjaGU9dGhpcy5fY3VycmVudEZhY2VJbmRleDtsZXQgdD10aGlzLl9saWdodC5wb3NpdGlvbjtpZih0aGlzLl9saWdodC5jb21wdXRlVHJhbnNmb3JtZWRJbmZvcm1hdGlvbigpJiYodD10aGlzLl9saWdodC50cmFuc2Zvcm1lZFBvc2l0aW9uKSxwLk5vcm1hbGl6ZVRvUmVmKHRoaXMuX2xpZ2h0LmdldFNoYWRvd0RpcmVjdGlvbih0aGlzLl9jdXJyZW50RmFjZUluZGV4KSx0aGlzLl9saWdodERpcmVjdGlvbiksTWF0aC5hYnMocC5Eb3QodGhpcy5fbGlnaHREaXJlY3Rpb24scC5VcCgpKSk9PT0xJiYodGhpcy5fbGlnaHREaXJlY3Rpb24uej0xZS0xMyksdGhpcy5fbGlnaHQubmVlZFByb2plY3Rpb25NYXRyaXhDb21wdXRlKCl8fCF0aGlzLl9jYWNoZWRQb3NpdGlvbnx8IXRoaXMuX2NhY2hlZERpcmVjdGlvbnx8IXQuZXF1YWxzKHRoaXMuX2NhY2hlZFBvc2l0aW9uKXx8IXRoaXMuX2xpZ2h0RGlyZWN0aW9uLmVxdWFscyh0aGlzLl9jYWNoZWREaXJlY3Rpb24pKXt0aGlzLl9jYWNoZWRQb3NpdGlvbi5jb3B5RnJvbSh0KSx0aGlzLl9jYWNoZWREaXJlY3Rpb24uY29weUZyb20odGhpcy5fbGlnaHREaXJlY3Rpb24pLHguTG9va0F0TEhUb1JlZih0LHQuYWRkKHRoaXMuX2xpZ2h0RGlyZWN0aW9uKSxwLlVwKCksdGhpcy5fdmlld01hdHJpeCk7Y29uc3QgaT10aGlzLmdldFNoYWRvd01hcCgpO2lmKGkpe2NvbnN0IHM9aS5yZW5kZXJMaXN0O3MmJnRoaXMuX2xpZ2h0LnNldFNoYWRvd1Byb2plY3Rpb25NYXRyaXgodGhpcy5fcHJvamVjdGlvbk1hdHJpeCx0aGlzLl92aWV3TWF0cml4LHMpfXRoaXMuX3ZpZXdNYXRyaXgubXVsdGlwbHlUb1JlZih0aGlzLl9wcm9qZWN0aW9uTWF0cml4LHRoaXMuX3RyYW5zZm9ybU1hdHJpeCl9cmV0dXJuIHRoaXMuX3RyYW5zZm9ybU1hdHJpeH1yZWNyZWF0ZVNoYWRvd01hcCgpe2NvbnN0IGU9dGhpcy5fc2hhZG93TWFwO2lmKCFlKXJldHVybjtjb25zdCB0PWUucmVuZGVyTGlzdDtpZih0aGlzLl9kaXNwb3NlUlRUYW5kUG9zdFByb2Nlc3NlcygpLHRoaXMuX2luaXRpYWxpemVHZW5lcmF0b3IoKSx0aGlzLmZpbHRlcj10aGlzLl9maWx0ZXIsdGhpcy5fYXBwbHlGaWx0ZXJWYWx1ZXMoKSx0KXt0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdHx8KHRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0PVtdKTtmb3IoY29uc3QgaSBvZiB0KXRoaXMuX3NoYWRvd01hcC5yZW5kZXJMaXN0LnB1c2goaSl9ZWxzZSB0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdD1udWxsfV9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKXt0aGlzLl9zaGFkb3dNYXAyJiYodGhpcy5fc2hhZG93TWFwMi5kaXNwb3NlKCksdGhpcy5fc2hhZG93TWFwMj1udWxsKSx0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3MmJih0aGlzLl9ib3hCbHVyUG9zdHByb2Nlc3MuZGlzcG9zZSgpLHRoaXMuX2JveEJsdXJQb3N0cHJvY2Vzcz1udWxsKSx0aGlzLl9rZXJuZWxCbHVyWFBvc3Rwcm9jZXNzJiYodGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcy5kaXNwb3NlKCksdGhpcy5fa2VybmVsQmx1clhQb3N0cHJvY2Vzcz1udWxsKSx0aGlzLl9rZXJuZWxCbHVyWVBvc3Rwcm9jZXNzJiYodGhpcy5fa2VybmVsQmx1cllQb3N0cHJvY2Vzcy5kaXNwb3NlKCksdGhpcy5fa2VybmVsQmx1cllQb3N0cHJvY2Vzcz1udWxsKSx0aGlzLl9ibHVyUG9zdFByb2Nlc3Nlcz1bXX1fZGlzcG9zZVJUVGFuZFBvc3RQcm9jZXNzZXMoKXt0aGlzLl9zaGFkb3dNYXAmJih0aGlzLl9zaGFkb3dNYXAuZGlzcG9zZSgpLHRoaXMuX3NoYWRvd01hcD1udWxsKSx0aGlzLl9kaXNwb3NlQmx1clBvc3RQcm9jZXNzZXMoKX1fZGlzcG9zZVNjZW5lVUJPcygpe2lmKHRoaXMuX3NjZW5lVUJPcyl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5fc2NlbmVVQk9zKWUuZGlzcG9zZSgpO3RoaXMuX3NjZW5lVUJPcz1bXX19ZGlzcG9zZSgpe2lmKHRoaXMuX2Rpc3Bvc2VSVFRhbmRQb3N0UHJvY2Vzc2VzKCksdGhpcy5fZGlzcG9zZVNjZW5lVUJPcygpLHRoaXMuX2xpZ2h0KXtpZih0aGlzLl9saWdodC5fc2hhZG93R2VuZXJhdG9ycyl7Y29uc3QgZT10aGlzLl9saWdodC5fc2hhZG93R2VuZXJhdG9ycy5lbnRyaWVzKCk7Zm9yKGxldCB0PWUubmV4dCgpO3QuZG9uZSE9PSEwO3Q9ZS5uZXh0KCkpe2NvbnN0W2ksc109dC52YWx1ZTtzPT09dGhpcyYmdGhpcy5fbGlnaHQuX3NoYWRvd0dlbmVyYXRvcnMuZGVsZXRlKGkpfXRoaXMuX2xpZ2h0Ll9zaGFkb3dHZW5lcmF0b3JzLnNpemU9PT0wJiYodGhpcy5fbGlnaHQuX3NoYWRvd0dlbmVyYXRvcnM9bnVsbCl9dGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKX10aGlzLm9uQmVmb3JlU2hhZG93TWFwUmVuZGVyTWVzaE9ic2VydmFibGUuY2xlYXIoKSx0aGlzLm9uQmVmb3JlU2hhZG93TWFwUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMub25BZnRlclNoYWRvd01hcFJlbmRlck1lc2hPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5vbkFmdGVyU2hhZG93TWFwUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpfXNlcmlhbGl6ZSgpe3ZhciBlO2NvbnN0IHQ9e30saT10aGlzLmdldFNoYWRvd01hcCgpO2lmKCFpKXJldHVybiB0O2lmKHQuY2xhc3NOYW1lPXRoaXMuZ2V0Q2xhc3NOYW1lKCksdC5saWdodElkPXRoaXMuX2xpZ2h0LmlkLHQuY2FtZXJhSWQ9KGU9dGhpcy5fY2FtZXJhKT09PW51bGx8fGU9PT12b2lkIDA/dm9pZCAwOmUuaWQsdC5pZD10aGlzLmlkLHQubWFwU2l6ZT1pLmdldFJlbmRlclNpemUoKSx0LmZvcmNlQmFja0ZhY2VzT25seT10aGlzLmZvcmNlQmFja0ZhY2VzT25seSx0LmRhcmtuZXNzPXRoaXMuZ2V0RGFya25lc3MoKSx0LnRyYW5zcGFyZW5jeVNoYWRvdz10aGlzLl90cmFuc3BhcmVuY3lTaGFkb3csdC5mcnVzdHVtRWRnZUZhbGxvZmY9dGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsdC5iaWFzPXRoaXMuYmlhcyx0Lm5vcm1hbEJpYXM9dGhpcy5ub3JtYWxCaWFzLHQudXNlUGVyY2VudGFnZUNsb3NlckZpbHRlcmluZz10aGlzLnVzZVBlcmNlbnRhZ2VDbG9zZXJGaWx0ZXJpbmcsdC51c2VDb250YWN0SGFyZGVuaW5nU2hhZG93PXRoaXMudXNlQ29udGFjdEhhcmRlbmluZ1NoYWRvdyx0LmNvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvPXRoaXMuY29udGFjdEhhcmRlbmluZ0xpZ2h0U2l6ZVVWUmF0aW8sdC5maWx0ZXJpbmdRdWFsaXR5PXRoaXMuZmlsdGVyaW5nUXVhbGl0eSx0LnVzZUV4cG9uZW50aWFsU2hhZG93TWFwPXRoaXMudXNlRXhwb25lbnRpYWxTaGFkb3dNYXAsdC51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXA9dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAsdC51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwPXRoaXMudXNlQmx1ckV4cG9uZW50aWFsU2hhZG93TWFwLHQudXNlQmx1ckNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXA9dGhpcy51c2VCbHVyRXhwb25lbnRpYWxTaGFkb3dNYXAsdC51c2VQb2lzc29uU2FtcGxpbmc9dGhpcy51c2VQb2lzc29uU2FtcGxpbmcsdC5kZXB0aFNjYWxlPXRoaXMuZGVwdGhTY2FsZSx0LmJsdXJCb3hPZmZzZXQ9dGhpcy5ibHVyQm94T2Zmc2V0LHQuYmx1cktlcm5lbD10aGlzLmJsdXJLZXJuZWwsdC5ibHVyU2NhbGU9dGhpcy5ibHVyU2NhbGUsdC51c2VLZXJuZWxCbHVyPXRoaXMudXNlS2VybmVsQmx1cix0LnJlbmRlckxpc3Q9W10saS5yZW5kZXJMaXN0KWZvcihsZXQgcz0wO3M8aS5yZW5kZXJMaXN0Lmxlbmd0aDtzKyspe2NvbnN0IHI9aS5yZW5kZXJMaXN0W3NdO3QucmVuZGVyTGlzdC5wdXNoKHIuaWQpfXJldHVybiB0fXN0YXRpYyBQYXJzZShlLHQsaSl7Y29uc3Qgcz10LmdldExpZ2h0QnlJZChlLmxpZ2h0SWQpLHI9ZS5jYW1lcmFJZCE9PXZvaWQgMD90LmdldENhbWVyYUJ5SWQoZS5jYW1lcmFJZCk6bnVsbCxuPWk/aShlLm1hcFNpemUscyxyKTpuZXcgRyhlLm1hcFNpemUscyx2b2lkIDAsciksYT1uLmdldFNoYWRvd01hcCgpO2ZvcihsZXQgbz0wO288ZS5yZW5kZXJMaXN0Lmxlbmd0aDtvKyspdC5nZXRNZXNoZXNCeUlkKGUucmVuZGVyTGlzdFtvXSkuZm9yRWFjaChmdW5jdGlvbihsKXthJiYoYS5yZW5kZXJMaXN0fHwoYS5yZW5kZXJMaXN0PVtdKSxhLnJlbmRlckxpc3QucHVzaChsKSl9KTtyZXR1cm4gZS5pZCE9PXZvaWQgMCYmKG4uaWQ9ZS5pZCksbi5mb3JjZUJhY2tGYWNlc09ubHk9ISFlLmZvcmNlQmFja0ZhY2VzT25seSxlLmRhcmtuZXNzIT09dm9pZCAwJiZuLnNldERhcmtuZXNzKGUuZGFya25lc3MpLGUudHJhbnNwYXJlbmN5U2hhZG93JiZuLnNldFRyYW5zcGFyZW5jeVNoYWRvdyghMCksZS5mcnVzdHVtRWRnZUZhbGxvZmYhPT12b2lkIDAmJihuLmZydXN0dW1FZGdlRmFsbG9mZj1lLmZydXN0dW1FZGdlRmFsbG9mZiksZS5iaWFzIT09dm9pZCAwJiYobi5iaWFzPWUuYmlhcyksZS5ub3JtYWxCaWFzIT09dm9pZCAwJiYobi5ub3JtYWxCaWFzPWUubm9ybWFsQmlhcyksZS51c2VQZXJjZW50YWdlQ2xvc2VyRmlsdGVyaW5nP24udXNlUGVyY2VudGFnZUNsb3NlckZpbHRlcmluZz0hMDplLnVzZUNvbnRhY3RIYXJkZW5pbmdTaGFkb3c/bi51c2VDb250YWN0SGFyZGVuaW5nU2hhZG93PSEwOmUudXNlUG9pc3NvblNhbXBsaW5nP24udXNlUG9pc3NvblNhbXBsaW5nPSEwOmUudXNlRXhwb25lbnRpYWxTaGFkb3dNYXA/bi51c2VFeHBvbmVudGlhbFNoYWRvd01hcD0hMDplLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD9uLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD0hMDplLnVzZUNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXA/bi51c2VDbG9zZUV4cG9uZW50aWFsU2hhZG93TWFwPSEwOmUudXNlQmx1ckNsb3NlRXhwb25lbnRpYWxTaGFkb3dNYXA/bi51c2VCbHVyQ2xvc2VFeHBvbmVudGlhbFNoYWRvd01hcD0hMDplLnVzZVZhcmlhbmNlU2hhZG93TWFwP24udXNlRXhwb25lbnRpYWxTaGFkb3dNYXA9ITA6ZS51c2VCbHVyVmFyaWFuY2VTaGFkb3dNYXAmJihuLnVzZUJsdXJFeHBvbmVudGlhbFNoYWRvd01hcD0hMCksZS5jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbyE9PXZvaWQgMCYmKG4uY29udGFjdEhhcmRlbmluZ0xpZ2h0U2l6ZVVWUmF0aW89ZS5jb250YWN0SGFyZGVuaW5nTGlnaHRTaXplVVZSYXRpbyksZS5maWx0ZXJpbmdRdWFsaXR5IT09dm9pZCAwJiYobi5maWx0ZXJpbmdRdWFsaXR5PWUuZmlsdGVyaW5nUXVhbGl0eSksZS5kZXB0aFNjYWxlJiYobi5kZXB0aFNjYWxlPWUuZGVwdGhTY2FsZSksZS5ibHVyU2NhbGUmJihuLmJsdXJTY2FsZT1lLmJsdXJTY2FsZSksZS5ibHVyQm94T2Zmc2V0JiYobi5ibHVyQm94T2Zmc2V0PWUuYmx1ckJveE9mZnNldCksZS51c2VLZXJuZWxCbHVyJiYobi51c2VLZXJuZWxCbHVyPWUudXNlS2VybmVsQmx1ciksZS5ibHVyS2VybmVsJiYobi5ibHVyS2VybmVsPWUuYmx1cktlcm5lbCksbn19Ry5DTEFTU05BTUU9IlNoYWRvd0dlbmVyYXRvciIsRy5GSUxURVJfTk9ORT0wLEcuRklMVEVSX0VYUE9ORU5USUFMU0hBRE9XTUFQPTEsRy5GSUxURVJfUE9JU1NPTlNBTVBMSU5HPTIsRy5GSUxURVJfQkxVUkVYUE9ORU5USUFMU0hBRE9XTUFQPTMsRy5GSUxURVJfQ0xPU0VFWFBPTkVOVElBTFNIQURPV01BUD00LEcuRklMVEVSX0JMVVJDTE9TRUVYUE9ORU5USUFMU0hBRE9XTUFQPTUsRy5GSUxURVJfUENGPTYsRy5GSUxURVJfUENTUz03LEcuUVVBTElUWV9ISUdIPTAsRy5RVUFMSVRZX01FRElVTT0xLEcuUVVBTElUWV9MT1c9MixHLkRFRkFVTFRfQUxQSEFfQ1VUT0ZGPS41LEcuX1NjZW5lQ29tcG9uZW50SW5pdGlhbGl6YXRpb249Yz0+e3Rocm93ICQoIlNoYWRvd0dlbmVyYXRvclNjZW5lQ29tcG9uZW50Iil9O2NvbnN0IE1vPSJkZXB0aFBpeGVsU2hhZGVyIixBbz1gI2lmZGVmIEFMUEhBVEVTVAp2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCBkaWZmdXNlU2FtcGxlcjsKI2VuZGlmCiNpbmNsdWRlPGNsaXBQbGFuZUZyYWdtZW50RGVjbGFyYXRpb24+CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmljOwojaWZkZWYgUEFDS0VECiNpbmNsdWRlPHBhY2tpbmdGdW5jdGlvbnM+CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkKewojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD4KI2lmZGVmIEFMUEhBVEVTVAppZiAodGV4dHVyZTJEKGRpZmZ1c2VTYW1wbGVyLHZVVikuYTwwLjQpCmRpc2NhcmQ7CiNlbmRpZgojaWZkZWYgTk9OTElORUFSREVQVEgKI2lmZGVmIFBBQ0tFRApnbF9GcmFnQ29sb3I9cGFjayhnbF9GcmFnQ29vcmQueik7CiNlbHNlCmdsX0ZyYWdDb2xvcj12ZWM0KGdsX0ZyYWdDb29yZC56LDAuMCwwLjAsMC4wKTsKI2VuZGlmCiNlbHNlCiNpZmRlZiBQQUNLRUQKZ2xfRnJhZ0NvbG9yPXBhY2sodkRlcHRoTWV0cmljKTsKI2Vsc2UKZ2xfRnJhZ0NvbG9yPXZlYzQodkRlcHRoTWV0cmljLDAuMCwwLjAsMS4wKTsKI2VuZGlmCiNlbmRpZgp9YDtVLlNoYWRlcnNTdG9yZVtNb109QW87Y29uc3QgUm89Imluc3RhbmNlc0RlY2xhcmF0aW9uIix5bz1gI2lmZGVmIElOU1RBTkNFUwphdHRyaWJ1dGUgdmVjNCB3b3JsZDA7CmF0dHJpYnV0ZSB2ZWM0IHdvcmxkMTsKYXR0cmlidXRlIHZlYzQgd29ybGQyOwphdHRyaWJ1dGUgdmVjNCB3b3JsZDM7CiNpZmRlZiBJTlNUQU5DRVNDT0xPUgphdHRyaWJ1dGUgdmVjNCBpbnN0YW5jZUNvbG9yOwojZW5kaWYKI2lmIGRlZmluZWQoVEhJTl9JTlNUQU5DRVMpICYmICFkZWZpbmVkKFdPUkxEX1VCTykKdW5pZm9ybSBtYXQ0IHdvcmxkOwojZW5kaWYKI2lmIGRlZmluZWQoVkVMT0NJVFkpIHx8IGRlZmluZWQoUFJFUEFTU19WRUxPQ0lUWSkKYXR0cmlidXRlIHZlYzQgcHJldmlvdXNXb3JsZDA7CmF0dHJpYnV0ZSB2ZWM0IHByZXZpb3VzV29ybGQxOwphdHRyaWJ1dGUgdmVjNCBwcmV2aW91c1dvcmxkMjsKYXR0cmlidXRlIHZlYzQgcHJldmlvdXNXb3JsZDM7CiNpZmRlZiBUSElOX0lOU1RBTkNFUwp1bmlmb3JtIG1hdDQgcHJldmlvdXNXb3JsZDsKI2VuZGlmCiNlbmRpZgojZWxzZQojaWYgIWRlZmluZWQoV09STERfVUJPKQp1bmlmb3JtIG1hdDQgd29ybGQ7CiNlbmRpZgojaWYgZGVmaW5lZChWRUxPQ0lUWSkgfHwgZGVmaW5lZChQUkVQQVNTX1ZFTE9DSVRZKQp1bmlmb3JtIG1hdDQgcHJldmlvdXNXb3JsZDsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbUm9dPXlvO2NvbnN0IENvPSJkZXB0aFZlcnRleFNoYWRlciIsSW89YGF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaW5jbHVkZTxib25lc0RlY2xhcmF0aW9uPgojaW5jbHVkZTxiYWtlZFZlcnRleEFuaW1hdGlvbkRlY2xhcmF0aW9uPgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhHbG9iYWxEZWNsYXJhdGlvbj4KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10KI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4RGVjbGFyYXRpb24+CiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPgp1bmlmb3JtIG1hdDQgdmlld1Byb2plY3Rpb247CnVuaWZvcm0gdmVjMiBkZXB0aFZhbHVlczsKI2lmIGRlZmluZWQoQUxQSEFURVNUKSB8fCBkZWZpbmVkKE5FRURfVVYpCnZhcnlpbmcgdmVjMiB2VVY7CnVuaWZvcm0gbWF0NCBkaWZmdXNlTWF0cml4OwojaWZkZWYgVVYxCmF0dHJpYnV0ZSB2ZWMyIHV2OwojZW5kaWYKI2lmZGVmIFVWMgphdHRyaWJ1dGUgdmVjMiB1djI7CiNlbmRpZgojZW5kaWYKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWM7CiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9ERUZJTklUSU9OUwp2b2lkIG1haW4odm9pZCkKewp2ZWMzIHBvc2l0aW9uVXBkYXRlZD1wb3NpdGlvbjsKI2lmZGVmIFVWMQp2ZWMyIHV2VXBkYXRlZD11djsKI2VuZGlmCiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleEdsb2JhbD4KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4PlswLi5tYXhTaW11bHRhbmVvdXNNb3JwaFRhcmdldHNdCiNpbmNsdWRlPGluc3RhbmNlc1ZlcnRleD4KI2luY2x1ZGU8Ym9uZXNWZXJ0ZXg+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uPgp2ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvblVwZGF0ZWQsMS4wKTsKI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4PgpnbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvbip3b3JsZFBvczsKI2lmZGVmIFVTRV9SRVZFUlNFX0RFUFRIQlVGRkVSCnZEZXB0aE1ldHJpYz0oKC1nbF9Qb3NpdGlvbi56K2RlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55KSk7CiNlbHNlCnZEZXB0aE1ldHJpYz0oKGdsX1Bvc2l0aW9uLnorZGVwdGhWYWx1ZXMueCkvKGRlcHRoVmFsdWVzLnkpKTsKI2VuZGlmCiNpZiBkZWZpbmVkKEFMUEhBVEVTVCkgfHwgZGVmaW5lZChCQVNJQ19SRU5ERVIpCiNpZmRlZiBVVjEKdlVWPXZlYzIoZGlmZnVzZU1hdHJpeCp2ZWM0KHV2VXBkYXRlZCwxLjAsMC4wKSk7CiNlbmRpZgojaWZkZWYgVVYyCnZVVj12ZWMyKGRpZmZ1c2VNYXRyaXgqdmVjNCh1djIsMS4wLDAuMCkpOwojZW5kaWYKI2VuZGlmCn0KYDtVLlNoYWRlcnNTdG9yZVtDb109SW87Y2xhc3MgYXN7Y29uc3RydWN0b3IoZSx0PTEsaT1udWxsLHM9ITEscj1OLlRSSUxJTkVBUl9TQU1QTElOR01PREUpe3RoaXMuZW5hYmxlZD0hMCx0aGlzLmZvcmNlRGVwdGhXcml0ZVRyYW5zcGFyZW50TWVzaGVzPSExLHRoaXMudXNlT25seUluQWN0aXZlQ2FtZXJhPSExLHRoaXMuX3NjZW5lPWUsdGhpcy5fc3RvcmVOb25MaW5lYXJEZXB0aD1zLHRoaXMuaXNQYWNrZWQ9dD09PTAsdGhpcy5pc1BhY2tlZD90aGlzLl9jbGVhckNvbG9yPW5ldyBtZSgxLDEsMSwxKTp0aGlzLl9jbGVhckNvbG9yPW5ldyBtZSgxLDAsMCwxKSxhcy5fU2NlbmVDb21wb25lbnRJbml0aWFsaXphdGlvbih0aGlzLl9zY2VuZSk7Y29uc3Qgbj1lLmdldEVuZ2luZSgpO3RoaXMuX2NhbWVyYT1pLHIhPT1OLk5FQVJFU1RfU0FNUExJTkdNT0RFJiYodD09PTEmJiFuLl9jYXBzLnRleHR1cmVGbG9hdExpbmVhckZpbHRlcmluZyYmKHI9Ti5ORUFSRVNUX1NBTVBMSU5HTU9ERSksdD09PTImJiFuLl9jYXBzLnRleHR1cmVIYWxmRmxvYXRMaW5lYXJGaWx0ZXJpbmcmJihyPU4uTkVBUkVTVF9TQU1QTElOR01PREUpKTtjb25zdCBhPXRoaXMuaXNQYWNrZWR8fCFuLl9mZWF0dXJlcy5zdXBwb3J0RXh0ZW5kZWRUZXh0dXJlRm9ybWF0cz81OjY7dGhpcy5fZGVwdGhNYXA9bmV3IF90KCJEZXB0aFJlbmRlcmVyIix7d2lkdGg6bi5nZXRSZW5kZXJXaWR0aCgpLGhlaWdodDpuLmdldFJlbmRlckhlaWdodCgpfSx0aGlzLl9zY2VuZSwhMSwhMCx0LCExLHIsdm9pZCAwLHZvaWQgMCx2b2lkIDAsYSksdGhpcy5fZGVwdGhNYXAud3JhcFU9Ti5DTEFNUF9BRERSRVNTTU9ERSx0aGlzLl9kZXB0aE1hcC53cmFwVj1OLkNMQU1QX0FERFJFU1NNT0RFLHRoaXMuX2RlcHRoTWFwLnJlZnJlc2hSYXRlPTEsdGhpcy5fZGVwdGhNYXAucmVuZGVyUGFydGljbGVzPSExLHRoaXMuX2RlcHRoTWFwLnJlbmRlckxpc3Q9bnVsbCx0aGlzLl9kZXB0aE1hcC5hY3RpdmVDYW1lcmE9dGhpcy5fY2FtZXJhLHRoaXMuX2RlcHRoTWFwLmlnbm9yZUNhbWVyYVZpZXdwb3J0PSEwLHRoaXMuX2RlcHRoTWFwLnVzZUNhbWVyYVBvc3RQcm9jZXNzZXM9ITEsdGhpcy5fZGVwdGhNYXAub25DbGVhck9ic2VydmFibGUuYWRkKGg9PntoLmNsZWFyKHRoaXMuX2NsZWFyQ29sb3IsITAsITAsITApfSksdGhpcy5fZGVwdGhNYXAub25CZWZvcmVCaW5kT2JzZXJ2YWJsZS5hZGQoKCk9Pnt2YXIgaDsoaD1uLl9kZWJ1Z1B1c2hHcm91cCk9PT1udWxsfHxoPT09dm9pZCAwfHxoLmNhbGwobiwiZGVwdGggcmVuZGVyZXIiLDEpfSksdGhpcy5fZGVwdGhNYXAub25BZnRlclVuYmluZE9ic2VydmFibGUuYWRkKCgpPT57dmFyIGg7KGg9bi5fZGVidWdQb3BHcm91cCk9PT1udWxsfHxoPT09dm9pZCAwfHxoLmNhbGwobiwxKX0pLHRoaXMuX2RlcHRoTWFwLmN1c3RvbUlzUmVhZHlGdW5jdGlvbj0oaCxsLHUpPT57aWYoKHV8fGw9PT0wKSYmaC5zdWJNZXNoZXMpZm9yKGxldCBkPTA7ZDxoLnN1Yk1lc2hlcy5sZW5ndGg7KytkKXtjb25zdCBmPWguc3ViTWVzaGVzW2RdLF89Zi5nZXRSZW5kZXJpbmdNZXNoKCksRT1fLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KGYuX2lkLCEhZi5nZXRSZXBsYWNlbWVudE1lc2goKSksbT1uLmdldENhcHMoKS5pbnN0YW5jZWRBcnJheXMmJihFLnZpc2libGVJbnN0YW5jZXNbZi5faWRdIT09bnVsbCYmRS52aXNpYmxlSW5zdGFuY2VzW2YuX2lkXSE9PXZvaWQgMHx8Xy5oYXNUaGluSW5zdGFuY2VzKTtpZighdGhpcy5pc1JlYWR5KGYsbSkpcmV0dXJuITF9cmV0dXJuITB9O2NvbnN0IG89aD0+e3ZhciBsLHU7Y29uc3QgZD1oLmdldFJlbmRlcmluZ01lc2goKSxmPWguZ2V0RWZmZWN0aXZlTWVzaCgpLF89dGhpcy5fc2NlbmUsRT1fLmdldEVuZ2luZSgpLG09aC5nZXRNYXRlcmlhbCgpO2lmKGYuX2ludGVybmFsQWJzdHJhY3RNZXNoRGF0YUluZm8uX2lzQWN0aXZlSW50ZXJtZWRpYXRlPSExLCFtfHxmLmluZmluaXRlRGlzdGFuY2V8fG0uZGlzYWJsZURlcHRoV3JpdGV8fGgudmVydGljZXNDb3VudD09PTB8fGguX3JlbmRlcklkPT09Xy5nZXRSZW5kZXJJZCgpKXJldHVybjtjb25zdCB2PWYuX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKTwwO2xldCBTPShsPWQub3ZlcnJpZGVNYXRlcmlhbFNpZGVPcmllbnRhdGlvbikhPT1udWxsJiZsIT09dm9pZCAwP2w6bS5zaWRlT3JpZW50YXRpb247diYmKFM9Uz09PTA/MTowKTtjb25zdCB5PVM9PT0wO0Uuc2V0U3RhdGUobS5iYWNrRmFjZUN1bGxpbmcsMCwhMSx5LG0uY3VsbEJhY2tGYWNlcyk7Y29uc3QgQT1kLl9nZXRJbnN0YW5jZXNSZW5kZXJMaXN0KGguX2lkLCEhaC5nZXRSZXBsYWNlbWVudE1lc2goKSk7aWYoQS5tdXN0UmV0dXJuKXJldHVybjtjb25zdCBDPUUuZ2V0Q2FwcygpLmluc3RhbmNlZEFycmF5cyYmKEEudmlzaWJsZUluc3RhbmNlc1toLl9pZF0hPT1udWxsJiZBLnZpc2libGVJbnN0YW5jZXNbaC5faWRdIT09dm9pZCAwfHxkLmhhc1RoaW5JbnN0YW5jZXMpLGI9dGhpcy5fY2FtZXJhfHxfLmFjdGl2ZUNhbWVyYTtpZih0aGlzLmlzUmVhZHkoaCxDKSYmYil7aC5fcmVuZGVySWQ9Xy5nZXRSZW5kZXJJZCgpO2NvbnN0IE09KHU9Zi5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWxGb3JSZW5kZXJQYXNzKT09PW51bGx8fHU9PT12b2lkIDA/dm9pZCAwOnVbRS5jdXJyZW50UmVuZGVyUGFzc0lkXTtsZXQgTD1oLl9nZXREcmF3V3JhcHBlcigpOyFMJiZNJiYoTD1NLl9nZXREcmF3V3JhcHBlcigpKTtjb25zdCBrPWIubW9kZT09PWouT1JUSE9HUkFQSElDX0NBTUVSQTtpZighTClyZXR1cm47Y29uc3Qgdz1MLmVmZmVjdDtFLmVuYWJsZUVmZmVjdChMKSxDfHxkLl9iaW5kKGgsdyxtLmZpbGxNb2RlKSxNP00uYmluZEZvclN1Yk1lc2goZi5nZXRXb3JsZE1hdHJpeCgpLGYsaCk6KHcuc2V0TWF0cml4KCJ2aWV3UHJvamVjdGlvbiIsXy5nZXRUcmFuc2Zvcm1NYXRyaXgoKSksdy5zZXRNYXRyaXgoIndvcmxkIixmLmdldFdvcmxkTWF0cml4KCkpKTtsZXQgZGUsY2U7aWYoaz8oZGU9IUUudXNlUmV2ZXJzZURlcHRoQnVmZmVyJiZFLmlzTkRDSGFsZlpSYW5nZT8wOjEsY2U9RS51c2VSZXZlcnNlRGVwdGhCdWZmZXImJkUuaXNORENIYWxmWlJhbmdlPzA6MSk6KGRlPUUudXNlUmV2ZXJzZURlcHRoQnVmZmVyJiZFLmlzTkRDSGFsZlpSYW5nZT9iLm1pblo6RS5pc05EQ0hhbGZaUmFuZ2U/MDpiLm1pblosY2U9RS51c2VSZXZlcnNlRGVwdGhCdWZmZXImJkUuaXNORENIYWxmWlJhbmdlPzA6Yi5tYXhaKSx3LnNldEZsb2F0MigiZGVwdGhWYWx1ZXMiLGRlLGRlK2NlKSwhTSl7aWYobS5uZWVkQWxwaGFUZXN0aW5nKCkpe2NvbnN0IHNlPW0uZ2V0QWxwaGFUZXN0VGV4dHVyZSgpO3NlJiYody5zZXRUZXh0dXJlKCJkaWZmdXNlU2FtcGxlciIsc2UpLHcuc2V0TWF0cml4KCJkaWZmdXNlTWF0cml4IixzZS5nZXRUZXh0dXJlTWF0cml4KCkpKX1pZihkLnVzZUJvbmVzJiZkLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyYmZC5za2VsZXRvbil7Y29uc3Qgc2U9ZC5za2VsZXRvbjtpZihzZS5pc1VzaW5nVGV4dHVyZUZvck1hdHJpY2VzKXtjb25zdCB0ZT1zZS5nZXRUcmFuc2Zvcm1NYXRyaXhUZXh0dXJlKGQpO2lmKCF0ZSlyZXR1cm47dy5zZXRUZXh0dXJlKCJib25lU2FtcGxlciIsdGUpLHcuc2V0RmxvYXQoImJvbmVUZXh0dXJlV2lkdGgiLDQqKHNlLmJvbmVzLmxlbmd0aCsxKSl9ZWxzZSB3LnNldE1hdHJpY2VzKCJtQm9uZXMiLHNlLmdldFRyYW5zZm9ybU1hdHJpY2VzKGQpKX1ycyh3LG0sXyksaWUuQmluZE1vcnBoVGFyZ2V0UGFyYW1ldGVycyhkLHcpLGQubW9ycGhUYXJnZXRNYW5hZ2VyJiZkLm1vcnBoVGFyZ2V0TWFuYWdlci5pc1VzaW5nVGV4dHVyZUZvclRhcmdldHMmJmQubW9ycGhUYXJnZXRNYW5hZ2VyLl9iaW5kKHcpfWQuX3Byb2Nlc3NSZW5kZXJpbmcoZixoLHcsbS5maWxsTW9kZSxBLEMsKHNlLHRlKT0+dy5zZXRNYXRyaXgoIndvcmxkIix0ZSkpfX07dGhpcy5fZGVwdGhNYXAuY3VzdG9tUmVuZGVyRnVuY3Rpb249KGgsbCx1LGQpPT57bGV0IGY7aWYoZC5sZW5ndGgpZm9yKGY9MDtmPGQubGVuZ3RoO2YrKylvKGQuZGF0YVtmXSk7Zm9yKGY9MDtmPGgubGVuZ3RoO2YrKylvKGguZGF0YVtmXSk7Zm9yKGY9MDtmPGwubGVuZ3RoO2YrKylvKGwuZGF0YVtmXSk7aWYodGhpcy5mb3JjZURlcHRoV3JpdGVUcmFuc3BhcmVudE1lc2hlcylmb3IoZj0wO2Y8dS5sZW5ndGg7ZisrKW8odS5kYXRhW2ZdKTtlbHNlIGZvcihmPTA7Zjx1Lmxlbmd0aDtmKyspdS5kYXRhW2ZdLmdldEVmZmVjdGl2ZU1lc2goKS5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5faXNBY3RpdmVJbnRlcm1lZGlhdGU9ITF9fXNldE1hdGVyaWFsRm9yUmVuZGVyaW5nKGUsdCl7dGhpcy5fZGVwdGhNYXAuc2V0TWF0ZXJpYWxGb3JSZW5kZXJpbmcoZSx0KX1pc1JlYWR5KGUsdCl7dmFyIGk7Y29uc3Qgcz10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSxyPWUuZ2V0TWVzaCgpLG49ci5nZXRTY2VuZSgpLGE9KGk9ci5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fbWF0ZXJpYWxGb3JSZW5kZXJQYXNzKT09PW51bGx8fGk9PT12b2lkIDA/dm9pZCAwOmlbcy5jdXJyZW50UmVuZGVyUGFzc0lkXTtpZihhKXJldHVybiBhLmlzUmVhZHlGb3JTdWJNZXNoKHIsZSx0KTtjb25zdCBvPWUuZ2V0TWF0ZXJpYWwoKTtpZighb3x8by5kaXNhYmxlRGVwdGhXcml0ZSlyZXR1cm4hMTtjb25zdCBoPVtdLGw9W2cuUG9zaXRpb25LaW5kXTtpZihvJiZvLm5lZWRBbHBoYVRlc3RpbmcoKSYmby5nZXRBbHBoYVRlc3RUZXh0dXJlKCkmJihoLnB1c2goIiNkZWZpbmUgQUxQSEFURVNUIiksci5pc1ZlcnRpY2VzRGF0YVByZXNlbnQoZy5VVktpbmQpJiYobC5wdXNoKGcuVVZLaW5kKSxoLnB1c2goIiNkZWZpbmUgVVYxIikpLHIuaXNWZXJ0aWNlc0RhdGFQcmVzZW50KGcuVVYyS2luZCkmJihsLnB1c2goZy5VVjJLaW5kKSxoLnB1c2goIiNkZWZpbmUgVVYyIikpKSxyLnVzZUJvbmVzJiZyLmNvbXB1dGVCb25lc1VzaW5nU2hhZGVycyl7bC5wdXNoKGcuTWF0cmljZXNJbmRpY2VzS2luZCksbC5wdXNoKGcuTWF0cmljZXNXZWlnaHRzS2luZCksci5udW1Cb25lSW5mbHVlbmNlcnM+NCYmKGwucHVzaChnLk1hdHJpY2VzSW5kaWNlc0V4dHJhS2luZCksbC5wdXNoKGcuTWF0cmljZXNXZWlnaHRzRXh0cmFLaW5kKSksaC5wdXNoKCIjZGVmaW5lIE5VTV9CT05FX0lORkxVRU5DRVJTICIrci5udW1Cb25lSW5mbHVlbmNlcnMpLGgucHVzaCgiI2RlZmluZSBCb25lc1Blck1lc2ggIisoci5za2VsZXRvbj9yLnNrZWxldG9uLmJvbmVzLmxlbmd0aCsxOjApKTtjb25zdCBtPWUuZ2V0UmVuZGVyaW5nTWVzaCgpLnNrZWxldG9uO20hPW51bGwmJm0uaXNVc2luZ1RleHR1cmVGb3JNYXRyaWNlcyYmaC5wdXNoKCIjZGVmaW5lIEJPTkVURVhUVVJFIil9ZWxzZSBoLnB1c2goIiNkZWZpbmUgTlVNX0JPTkVfSU5GTFVFTkNFUlMgMCIpO2NvbnN0IHU9ci5tb3JwaFRhcmdldE1hbmFnZXI7bGV0IGQ9MDt1JiZ1Lm51bUluZmx1ZW5jZXJzPjAmJihkPXUubnVtSW5mbHVlbmNlcnMsaC5wdXNoKCIjZGVmaW5lIE1PUlBIVEFSR0VUUyIpLGgucHVzaCgiI2RlZmluZSBOVU1fTU9SUEhfSU5GTFVFTkNFUlMgIitkKSx1LmlzVXNpbmdUZXh0dXJlRm9yVGFyZ2V0cyYmaC5wdXNoKCIjZGVmaW5lIE1PUlBIVEFSR0VUU19URVhUVVJFIiksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JNb3JwaFRhcmdldHNJbmZsdWVuY2VycyhsLHIsZCkpLHQmJihoLnB1c2goIiNkZWZpbmUgSU5TVEFOQ0VTIiksaWUuUHVzaEF0dHJpYnV0ZXNGb3JJbnN0YW5jZXMobCksZS5nZXRSZW5kZXJpbmdNZXNoKCkuaGFzVGhpbkluc3RhbmNlcyYmaC5wdXNoKCIjZGVmaW5lIFRISU5fSU5TVEFOQ0VTIikpLHRoaXMuX3N0b3JlTm9uTGluZWFyRGVwdGgmJmgucHVzaCgiI2RlZmluZSBOT05MSU5FQVJERVBUSCIpLHRoaXMuaXNQYWNrZWQmJmgucHVzaCgiI2RlZmluZSBQQUNLRUQiKSxPcyhvLG4saCk7Y29uc3QgZj1lLl9nZXREcmF3V3JhcHBlcih2b2lkIDAsITApLF89Zi5kZWZpbmVzLEU9aC5qb2luKGAKYCk7aWYoXyE9PUUpe2NvbnN0IG09WyJ3b3JsZCIsIm1Cb25lcyIsImJvbmVUZXh0dXJlV2lkdGgiLCJ2aWV3UHJvamVjdGlvbiIsImRpZmZ1c2VNYXRyaXgiLCJkZXB0aFZhbHVlcyIsIm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyIsIm1vcnBoVGFyZ2V0VGV4dHVyZUluZm8iLCJtb3JwaFRhcmdldFRleHR1cmVJbmRpY2VzIl07c3MobSksZi5zZXRFZmZlY3Qocy5jcmVhdGVFZmZlY3QoImRlcHRoIixsLG0sWyJkaWZmdXNlU2FtcGxlciIsIm1vcnBoVGFyZ2V0cyIsImJvbmVTYW1wbGVyIl0sRSx2b2lkIDAsdm9pZCAwLHZvaWQgMCx7bWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzOmR9KSxFKX1yZXR1cm4gZi5lZmZlY3QuaXNSZWFkeSgpfWdldERlcHRoTWFwKCl7cmV0dXJuIHRoaXMuX2RlcHRoTWFwfWRpc3Bvc2UoKXtjb25zdCBlPVtdO2Zvcihjb25zdCB0IGluIHRoaXMuX3NjZW5lLl9kZXB0aFJlbmRlcmVyKXRoaXMuX3NjZW5lLl9kZXB0aFJlbmRlcmVyW3RdPT09dGhpcyYmZS5wdXNoKHQpO2lmKGUubGVuZ3RoPjApe3RoaXMuX2RlcHRoTWFwLmRpc3Bvc2UoKTtmb3IoY29uc3QgdCBvZiBlKWRlbGV0ZSB0aGlzLl9zY2VuZS5fZGVwdGhSZW5kZXJlclt0XX19fWFzLl9TY2VuZUNvbXBvbmVudEluaXRpYWxpemF0aW9uPWM9Pnt0aHJvdyAkKCJEZXB0aFJlbmRlcmVyU2NlbmVDb21wb25lbnQiKX07Y29uc3QgUG89Im1pbm1heFJlZHV4UGl4ZWxTaGFkZXIiLERvPWB2YXJ5aW5nIHZlYzIgdlVWOwp1bmlmb3JtIHNhbXBsZXIyRCB0ZXh0dXJlU2FtcGxlcjsKI2lmIGRlZmluZWQoSU5JVElBTCkKdW5pZm9ybSBzYW1wbGVyMkQgc291cmNlVGV4dHVyZTsKdW5pZm9ybSB2ZWMyIHRleFNpemU7CnZvaWQgbWFpbih2b2lkKQp7Cml2ZWMyIGNvb3JkPWl2ZWMyKHZVVioodGV4U2l6ZS0xLjApKTsKZmxvYXQgZjE9dGV4ZWxGZXRjaChzb3VyY2VUZXh0dXJlLGNvb3JkLDApLnI7CmZsb2F0IGYyPXRleGVsRmV0Y2goc291cmNlVGV4dHVyZSxjb29yZCtpdmVjMigxLDApLDApLnI7CmZsb2F0IGYzPXRleGVsRmV0Y2goc291cmNlVGV4dHVyZSxjb29yZCtpdmVjMigxLDEpLDApLnI7CmZsb2F0IGY0PXRleGVsRmV0Y2goc291cmNlVGV4dHVyZSxjb29yZCtpdmVjMigwLDEpLDApLnI7CmZsb2F0IG1pbno9bWluKG1pbihtaW4oZjEsZjIpLGYzKSxmNCk7CiNpZmRlZiBERVBUSF9SRURVWApmbG9hdCBtYXh6PW1heChtYXgobWF4KHNpZ24oMS4wLWYxKSpmMSxzaWduKDEuMC1mMikqZjIpLHNpZ24oMS4wLWYzKSpmMyksc2lnbigxLjAtZjQpKmY0KTsKI2Vsc2UKZmxvYXQgbWF4ej1tYXgobWF4KG1heChmMSxmMiksZjMpLGY0KTsKI2VuZGlmCmdsRnJhZ0NvbG9yPXZlYzQobWlueixtYXh6LDAuLDAuKTsKfQojZWxpZiBkZWZpbmVkKE1BSU4pCnVuaWZvcm0gdmVjMiB0ZXhTaXplOwp2b2lkIG1haW4odm9pZCkKewppdmVjMiBjb29yZD1pdmVjMih2VVYqKHRleFNpemUtMS4wKSk7CnZlYzIgZjE9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlcixjb29yZCwwKS5yZzsKdmVjMiBmMj10ZXhlbEZldGNoKHRleHR1cmVTYW1wbGVyLGNvb3JkK2l2ZWMyKDEsMCksMCkucmc7CnZlYzIgZjM9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlcixjb29yZCtpdmVjMigxLDEpLDApLnJnOwp2ZWMyIGY0PXRleGVsRmV0Y2godGV4dHVyZVNhbXBsZXIsY29vcmQraXZlYzIoMCwxKSwwKS5yZzsKZmxvYXQgbWluej1taW4obWluKG1pbihmMS54LGYyLngpLGYzLngpLGY0LngpOwpmbG9hdCBtYXh6PW1heChtYXgobWF4KGYxLnksZjIueSksZjMueSksZjQueSk7CmdsRnJhZ0NvbG9yPXZlYzQobWlueixtYXh6LDAuLDAuKTsKfQojZWxpZiBkZWZpbmVkKE9ORUJFRk9SRUxBU1QpCnVuaWZvcm0gaXZlYzIgdGV4U2l6ZTsKdm9pZCBtYWluKHZvaWQpCnsKaXZlYzIgY29vcmQ9aXZlYzIodlVWKnZlYzIodGV4U2l6ZS0xKSk7CnZlYzIgZjE9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlcixjb29yZCAlIHRleFNpemUsMCkucmc7CnZlYzIgZjI9dGV4ZWxGZXRjaCh0ZXh0dXJlU2FtcGxlciwoY29vcmQraXZlYzIoMSwwKSkgJSB0ZXhTaXplLDApLnJnOwp2ZWMyIGYzPXRleGVsRmV0Y2godGV4dHVyZVNhbXBsZXIsKGNvb3JkK2l2ZWMyKDEsMSkpICUgdGV4U2l6ZSwwKS5yZzsKdmVjMiBmND10ZXhlbEZldGNoKHRleHR1cmVTYW1wbGVyLChjb29yZCtpdmVjMigwLDEpKSAlIHRleFNpemUsMCkucmc7CmZsb2F0IG1pbno9bWluKGYxLngsZjIueCk7CmZsb2F0IG1heHo9bWF4KGYxLnksZjIueSk7CmdsRnJhZ0NvbG9yPXZlYzQobWlueixtYXh6LDAuLDAuKTsKfQojZWxpZiBkZWZpbmVkKExBU1QpCnZvaWQgbWFpbih2b2lkKQp7CmdsRnJhZ0NvbG9yPXZlYzQoMC4pOwppZiAodHJ1ZSkgeyAKZGlzY2FyZDsKfQp9CiNlbmRpZgpgO1UuU2hhZGVyc1N0b3JlW1BvXT1EbztjbGFzcyBGb3tjb25zdHJ1Y3RvcihlKXt0aGlzLm9uQWZ0ZXJSZWR1Y3Rpb25QZXJmb3JtZWQ9bmV3IEYsdGhpcy5fZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQ9ITAsdGhpcy5fYWN0aXZhdGVkPSExLHRoaXMuX2NhbWVyYT1lLHRoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlcj1uZXcgUWkoZS5nZXRTY2VuZSgpKSx0aGlzLl9vbkNvbnRleHRSZXN0b3JlZE9ic2VydmVyPWUuZ2V0RW5naW5lKCkub25Db250ZXh0UmVzdG9yZWRPYnNlcnZhYmxlLmFkZCgoKT0+e3RoaXMuX3Bvc3RQcm9jZXNzTWFuYWdlci5fcmVidWlsZCgpfSl9Z2V0IHNvdXJjZVRleHR1cmUoKXtyZXR1cm4gdGhpcy5fc291cmNlVGV4dHVyZX1zZXRTb3VyY2VUZXh0dXJlKGUsdCxpPTIscz0hMCl7aWYoZT09PXRoaXMuX3NvdXJjZVRleHR1cmUpcmV0dXJuO3RoaXMuZGlzcG9zZSghMSksdGhpcy5fc291cmNlVGV4dHVyZT1lLHRoaXMuX3JlZHVjdGlvblN0ZXBzPVtdLHRoaXMuX2ZvcmNlRnVsbHNjcmVlblZpZXdwb3J0PXM7Y29uc3Qgcj10aGlzLl9jYW1lcmEuZ2V0U2NlbmUoKSxuPW5ldyBNZSgiSW5pdGlhbCByZWR1Y3Rpb24gcGhhc2UiLCJtaW5tYXhSZWR1eCIsWyJ0ZXhTaXplIl0sWyJzb3VyY2VUZXh0dXJlIl0sMSxudWxsLDEsci5nZXRFbmdpbmUoKSwhMSwiI2RlZmluZSBJTklUSUFMIisodD9gCiNkZWZpbmUgREVQVEhfUkVEVVhgOiIiKSxpLHZvaWQgMCx2b2lkIDAsdm9pZCAwLDcpO24uYXV0b0NsZWFyPSExLG4uZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQ9cztsZXQgYT10aGlzLl9zb3VyY2VUZXh0dXJlLmdldFJlbmRlcldpZHRoKCksbz10aGlzLl9zb3VyY2VUZXh0dXJlLmdldFJlbmRlckhlaWdodCgpO24ub25BcHBseT0oKGwsdSk9PmQ9PntkLnNldFRleHR1cmUoInNvdXJjZVRleHR1cmUiLHRoaXMuX3NvdXJjZVRleHR1cmUpLGQuc2V0RmxvYXQyKCJ0ZXhTaXplIixsLHUpfSkoYSxvKSx0aGlzLl9yZWR1Y3Rpb25TdGVwcy5wdXNoKG4pO2xldCBoPTE7Zm9yKDthPjF8fG8+MTspe2E9TWF0aC5tYXgoTWF0aC5yb3VuZChhLzIpLDEpLG89TWF0aC5tYXgoTWF0aC5yb3VuZChvLzIpLDEpO2NvbnN0IGw9bmV3IE1lKCJSZWR1Y3Rpb24gcGhhc2UgIitoLCJtaW5tYXhSZWR1eCIsWyJ0ZXhTaXplIl0sbnVsbCx7d2lkdGg6YSxoZWlnaHQ6b30sbnVsbCwxLHIuZ2V0RW5naW5lKCksITEsIiNkZWZpbmUgIisoYT09MSYmbz09MT8iTEFTVCI6YT09MXx8bz09MT8iT05FQkVGT1JFTEFTVCI6Ik1BSU4iKSxpLHZvaWQgMCx2b2lkIDAsdm9pZCAwLDcpO2lmKGwuYXV0b0NsZWFyPSExLGwuZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQ9cyxsLm9uQXBwbHk9KCh1LGQpPT5mPT57dT09MXx8ZD09MT9mLnNldEludDIoInRleFNpemUiLHUsZCk6Zi5zZXRGbG9hdDIoInRleFNpemUiLHUsZCl9KShhLG8pLHRoaXMuX3JlZHVjdGlvblN0ZXBzLnB1c2gobCksaCsrLGE9PTEmJm89PTEpe2NvbnN0IHU9KGQsZixfKT0+e2NvbnN0IEU9bmV3IEZsb2F0MzJBcnJheSg0KmQqZiksbT17bWluOjAsbWF4OjB9O3JldHVybigpPT57ci5nZXRFbmdpbmUoKS5fcmVhZFRleHR1cmVQaXhlbHMoXy5pbnB1dFRleHR1cmUudGV4dHVyZSxkLGYsLTEsMCxFLCExKSxtLm1pbj1FWzBdLG0ubWF4PUVbMV0sdGhpcy5vbkFmdGVyUmVkdWN0aW9uUGVyZm9ybWVkLm5vdGlmeU9ic2VydmVycyhtKX19O2wub25BZnRlclJlbmRlck9ic2VydmFibGUuYWRkKHUoYSxvLGwpKX19fWdldCByZWZyZXNoUmF0ZSgpe3JldHVybiB0aGlzLl9zb3VyY2VUZXh0dXJlP3RoaXMuX3NvdXJjZVRleHR1cmUucmVmcmVzaFJhdGU6LTF9c2V0IHJlZnJlc2hSYXRlKGUpe3RoaXMuX3NvdXJjZVRleHR1cmUmJih0aGlzLl9zb3VyY2VUZXh0dXJlLnJlZnJlc2hSYXRlPWUpfWdldCBhY3RpdmF0ZWQoKXtyZXR1cm4gdGhpcy5fYWN0aXZhdGVkfWFjdGl2YXRlKCl7dGhpcy5fb25BZnRlclVuYmluZE9ic2VydmVyfHwhdGhpcy5fc291cmNlVGV4dHVyZXx8KHRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcj10aGlzLl9zb3VyY2VUZXh0dXJlLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLmFkZCgoKT0+e3ZhciBlLHQ7Y29uc3QgaT10aGlzLl9jYW1lcmEuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKTsoZT1pLl9kZWJ1Z1B1c2hHcm91cCk9PT1udWxsfHxlPT09dm9pZCAwfHxlLmNhbGwoaSwibWluIG1heCByZWR1Y3Rpb24iLDEpLHRoaXMuX3JlZHVjdGlvblN0ZXBzWzBdLmFjdGl2YXRlKHRoaXMuX2NhbWVyYSksdGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyLmRpcmVjdFJlbmRlcih0aGlzLl9yZWR1Y3Rpb25TdGVwcyx0aGlzLl9yZWR1Y3Rpb25TdGVwc1swXS5pbnB1dFRleHR1cmUsdGhpcy5fZm9yY2VGdWxsc2NyZWVuVmlld3BvcnQpLGkudW5CaW5kRnJhbWVidWZmZXIodGhpcy5fcmVkdWN0aW9uU3RlcHNbMF0uaW5wdXRUZXh0dXJlLCExKSwodD1pLl9kZWJ1Z1BvcEdyb3VwKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuY2FsbChpLDEpfSksdGhpcy5fYWN0aXZhdGVkPSEwKX1kZWFjdGl2YXRlKCl7IXRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcnx8IXRoaXMuX3NvdXJjZVRleHR1cmV8fCh0aGlzLl9zb3VyY2VUZXh0dXJlLm9uQWZ0ZXJVbmJpbmRPYnNlcnZhYmxlLnJlbW92ZSh0aGlzLl9vbkFmdGVyVW5iaW5kT2JzZXJ2ZXIpLHRoaXMuX29uQWZ0ZXJVbmJpbmRPYnNlcnZlcj1udWxsLHRoaXMuX2FjdGl2YXRlZD0hMSl9ZGlzcG9zZShlPSEwKXtpZihlJiYodGhpcy5vbkFmdGVyUmVkdWN0aW9uUGVyZm9ybWVkLmNsZWFyKCksdGhpcy5fb25Db250ZXh0UmVzdG9yZWRPYnNlcnZlciYmKHRoaXMuX2NhbWVyYS5nZXRFbmdpbmUoKS5vbkNvbnRleHRSZXN0b3JlZE9ic2VydmFibGUucmVtb3ZlKHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXIpLHRoaXMuX29uQ29udGV4dFJlc3RvcmVkT2JzZXJ2ZXI9bnVsbCkpLHRoaXMuZGVhY3RpdmF0ZSgpLHRoaXMuX3JlZHVjdGlvblN0ZXBzKXtmb3IobGV0IHQ9MDt0PHRoaXMuX3JlZHVjdGlvblN0ZXBzLmxlbmd0aDsrK3QpdGhpcy5fcmVkdWN0aW9uU3RlcHNbdF0uZGlzcG9zZSgpO3RoaXMuX3JlZHVjdGlvblN0ZXBzPW51bGx9dGhpcy5fcG9zdFByb2Nlc3NNYW5hZ2VyJiZlJiZ0aGlzLl9wb3N0UHJvY2Vzc01hbmFnZXIuZGlzcG9zZSgpLHRoaXMuX3NvdXJjZVRleHR1cmU9bnVsbH19Y2xhc3Mgd28gZXh0ZW5kcyBGb3tjb25zdHJ1Y3RvcihlKXtzdXBlcihlKX1nZXQgZGVwdGhSZW5kZXJlcigpe3JldHVybiB0aGlzLl9kZXB0aFJlbmRlcmVyfXNldERlcHRoUmVuZGVyZXIoZT1udWxsLHQ9MixpPSEwKXtjb25zdCBzPXRoaXMuX2NhbWVyYS5nZXRTY2VuZSgpO3RoaXMuX2RlcHRoUmVuZGVyZXImJihkZWxldGUgcy5fZGVwdGhSZW5kZXJlclt0aGlzLl9kZXB0aFJlbmRlcmVySWRdLHRoaXMuX2RlcHRoUmVuZGVyZXIuZGlzcG9zZSgpLHRoaXMuX2RlcHRoUmVuZGVyZXI9bnVsbCksZT09PW51bGwmJihzLl9kZXB0aFJlbmRlcmVyfHwocy5fZGVwdGhSZW5kZXJlcj17fSksZT10aGlzLl9kZXB0aFJlbmRlcmVyPW5ldyBhcyhzLHQsdGhpcy5fY2FtZXJhLCExLDEpLGUuZW5hYmxlZD0hMSx0aGlzLl9kZXB0aFJlbmRlcmVySWQ9Im1pbm1heCIrdGhpcy5fY2FtZXJhLmlkLHMuX2RlcHRoUmVuZGVyZXJbdGhpcy5fZGVwdGhSZW5kZXJlcklkXT1lKSxzdXBlci5zZXRTb3VyY2VUZXh0dXJlKGUuZ2V0RGVwdGhNYXAoKSwhMCx0LGkpfXNldFNvdXJjZVRleHR1cmUoZSx0LGk9MixzPSEwKXtzdXBlci5zZXRTb3VyY2VUZXh0dXJlKGUsdCxpLHMpfWFjdGl2YXRlKCl7dGhpcy5fZGVwdGhSZW5kZXJlciYmKHRoaXMuX2RlcHRoUmVuZGVyZXIuZW5hYmxlZD0hMCksc3VwZXIuYWN0aXZhdGUoKX1kZWFjdGl2YXRlKCl7c3VwZXIuZGVhY3RpdmF0ZSgpLHRoaXMuX2RlcHRoUmVuZGVyZXImJih0aGlzLl9kZXB0aFJlbmRlcmVyLmVuYWJsZWQ9ITEpfWRpc3Bvc2UoZT0hMCl7aWYoc3VwZXIuZGlzcG9zZShlKSx0aGlzLl9kZXB0aFJlbmRlcmVyJiZlKXtjb25zdCB0PXRoaXMuX2RlcHRoUmVuZGVyZXIuZ2V0RGVwdGhNYXAoKS5nZXRTY2VuZSgpO3QmJmRlbGV0ZSB0Ll9kZXB0aFJlbmRlcmVyW3RoaXMuX2RlcHRoUmVuZGVyZXJJZF0sdGhpcy5fZGVwdGhSZW5kZXJlci5kaXNwb3NlKCksdGhpcy5fZGVwdGhSZW5kZXJlcj1udWxsfX19Y29uc3QgTnI9cC5VcCgpLE9vPXAuWmVybygpLExlPW5ldyBwLHhpPW5ldyBwLG9zPW5ldyB4O2NsYXNzIGtlIGV4dGVuZHMgR3tjb25zdHJ1Y3RvcihlLHQsaSxzKXtpZigha2UuSXNTdXBwb3J0ZWQpe08uRXJyb3IoIkNhc2NhZGVkU2hhZG93TWFwIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIGN1cnJlbnQgZW5naW5lLiIpO3JldHVybn1zdXBlcihlLHQsaSxzKSx0aGlzLnVzZVBlcmNlbnRhZ2VDbG9zZXJGaWx0ZXJpbmc9ITB9X3ZhbGlkYXRlRmlsdGVyKGUpe3JldHVybiBlPT09Ry5GSUxURVJfTk9ORXx8ZT09PUcuRklMVEVSX1BDRnx8ZT09PUcuRklMVEVSX1BDU1M/ZTooY29uc29sZS5lcnJvcignVW5zdXBwb3J0ZWQgZmlsdGVyICInK2UrJyIhJyksRy5GSUxURVJfTk9ORSl9Z2V0IG51bUNhc2NhZGVzKCl7cmV0dXJuIHRoaXMuX251bUNhc2NhZGVzfXNldCBudW1DYXNjYWRlcyhlKXtlPU1hdGgubWluKE1hdGgubWF4KGUsa2UuTUlOX0NBU0NBREVTX0NPVU5UKSxrZS5NQVhfQ0FTQ0FERVNfQ09VTlQpLGUhPT10aGlzLl9udW1DYXNjYWRlcyYmKHRoaXMuX251bUNhc2NhZGVzPWUsdGhpcy5yZWNyZWF0ZVNoYWRvd01hcCgpLHRoaXMuX3JlY3JlYXRlU2NlbmVVQk9zKCkpfWdldCBmcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKCl7cmV0dXJuIHRoaXMuX2ZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm99c2V0IGZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm8oZSl7dGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUmJmUmJih0aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm9PYnNlcnZhYmxlKSx0aGlzLl9mcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvT2JzZXJ2YWJsZT1udWxsKSwhdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUmJiFlJiYodGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGU9dGhpcy5fc2NlbmUub25CZWZvcmVSZW5kZXJPYnNlcnZhYmxlLmFkZCh0aGlzLl9jb21wdXRlU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mby5iaW5kKHRoaXMpKSksdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbz1lLGUmJnRoaXMuX2NvbXB1dGVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKCl9X2NvbXB1dGVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKCl7aWYodGhpcy5fc2NiaU1pbi5jb3B5RnJvbUZsb2F0cyhOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsTnVtYmVyLk1BWF9WQUxVRSksdGhpcy5fc2NiaU1heC5jb3B5RnJvbUZsb2F0cyhOdW1iZXIuTUlOX1ZBTFVFLE51bWJlci5NSU5fVkFMVUUsTnVtYmVyLk1JTl9WQUxVRSksdGhpcy5fc2hhZG93TWFwJiZ0aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdCl7Y29uc3QgZT10aGlzLl9zaGFkb3dNYXAucmVuZGVyTGlzdDtmb3IobGV0IGk9MDtpPGUubGVuZ3RoO2krKyl7Y29uc3Qgcz1lW2ldO2lmKCFzKWNvbnRpbnVlO2NvbnN0IHI9cy5nZXRCb3VuZGluZ0luZm8oKSxuPXIuYm91bmRpbmdCb3g7dGhpcy5fc2NiaU1pbi5taW5pbWl6ZUluUGxhY2Uobi5taW5pbXVtV29ybGQpLHRoaXMuX3NjYmlNYXgubWF4aW1pemVJblBsYWNlKG4ubWF4aW11bVdvcmxkKX1jb25zdCB0PXRoaXMuX3NjZW5lLm1lc2hlcztmb3IobGV0IGk9MDtpPHQubGVuZ3RoO2krKyl7Y29uc3Qgcz10W2ldO2lmKCFzfHwhcy5pc1Zpc2libGV8fCFzLmlzRW5hYmxlZHx8IXMucmVjZWl2ZVNoYWRvd3MpY29udGludWU7Y29uc3Qgcj1zLmdldEJvdW5kaW5nSW5mbygpLG49ci5ib3VuZGluZ0JveDt0aGlzLl9zY2JpTWluLm1pbmltaXplSW5QbGFjZShuLm1pbmltdW1Xb3JsZCksdGhpcy5fc2NiaU1heC5tYXhpbWl6ZUluUGxhY2Uobi5tYXhpbXVtV29ybGQpfX10aGlzLl9zaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvLnJlQ29uc3RydWN0KHRoaXMuX3NjYmlNaW4sdGhpcy5fc2NiaU1heCl9Z2V0IHNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm8oKXtyZXR1cm4gdGhpcy5fc2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb31zZXQgc2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbyhlKXt0aGlzLl9zaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvPWV9c2V0TWluTWF4RGlzdGFuY2UoZSx0KXt0aGlzLl9taW5EaXN0YW5jZT09PWUmJnRoaXMuX21heERpc3RhbmNlPT09dHx8KGU+dCYmKGU9MCx0PTEpLGU8MCYmKGU9MCksdD4xJiYodD0xKSx0aGlzLl9taW5EaXN0YW5jZT1lLHRoaXMuX21heERpc3RhbmNlPXQsdGhpcy5fYnJlYWtzQXJlRGlydHk9ITApfWdldCBtaW5EaXN0YW5jZSgpe3JldHVybiB0aGlzLl9taW5EaXN0YW5jZX1nZXQgbWF4RGlzdGFuY2UoKXtyZXR1cm4gdGhpcy5fbWF4RGlzdGFuY2V9Z2V0Q2xhc3NOYW1lKCl7cmV0dXJuIGtlLkNMQVNTTkFNRX1nZXRDYXNjYWRlTWluRXh0ZW50cyhlKXtyZXR1cm4gZT49MCYmZTx0aGlzLl9udW1DYXNjYWRlcz90aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tlXTpudWxsfWdldENhc2NhZGVNYXhFeHRlbnRzKGUpe3JldHVybiBlPj0wJiZlPHRoaXMuX251bUNhc2NhZGVzP3RoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW2VdOm51bGx9Z2V0IHNoYWRvd01heFooKXtyZXR1cm4gdGhpcy5fZ2V0Q2FtZXJhKCk/dGhpcy5fc2hhZG93TWF4WjowfXNldCBzaGFkb3dNYXhaKGUpe2NvbnN0IHQ9dGhpcy5fZ2V0Q2FtZXJhKCk7aWYoIXQpe3RoaXMuX3NoYWRvd01heFo9ZTtyZXR1cm59dGhpcy5fc2hhZG93TWF4Wj09PWV8fGU8dC5taW5afHxlPnQubWF4Wnx8KHRoaXMuX3NoYWRvd01heFo9ZSx0aGlzLl9saWdodC5fbWFya01lc2hlc0FzTGlnaHREaXJ0eSgpLHRoaXMuX2JyZWFrc0FyZURpcnR5PSEwKX1nZXQgZGVidWcoKXtyZXR1cm4gdGhpcy5fZGVidWd9c2V0IGRlYnVnKGUpe3RoaXMuX2RlYnVnPWUsdGhpcy5fbGlnaHQuX21hcmtNZXNoZXNBc0xpZ2h0RGlydHkoKX1nZXQgZGVwdGhDbGFtcCgpe3JldHVybiB0aGlzLl9kZXB0aENsYW1wfXNldCBkZXB0aENsYW1wKGUpe3RoaXMuX2RlcHRoQ2xhbXA9ZX1nZXQgY2FzY2FkZUJsZW5kUGVyY2VudGFnZSgpe3JldHVybiB0aGlzLl9jYXNjYWRlQmxlbmRQZXJjZW50YWdlfXNldCBjYXNjYWRlQmxlbmRQZXJjZW50YWdlKGUpe3RoaXMuX2Nhc2NhZGVCbGVuZFBlcmNlbnRhZ2U9ZSx0aGlzLl9saWdodC5fbWFya01lc2hlc0FzTGlnaHREaXJ0eSgpfWdldCBsYW1iZGEoKXtyZXR1cm4gdGhpcy5fbGFtYmRhfXNldCBsYW1iZGEoZSl7Y29uc3QgdD1NYXRoLm1pbihNYXRoLm1heChlLDApLDEpO3RoaXMuX2xhbWJkYSE9dCYmKHRoaXMuX2xhbWJkYT10LHRoaXMuX2JyZWFrc0FyZURpcnR5PSEwKX1nZXRDYXNjYWRlVmlld01hdHJpeChlKXtyZXR1cm4gZT49MCYmZTx0aGlzLl9udW1DYXNjYWRlcz90aGlzLl92aWV3TWF0cmljZXNbZV06bnVsbH1nZXRDYXNjYWRlUHJvamVjdGlvbk1hdHJpeChlKXtyZXR1cm4gZT49MCYmZTx0aGlzLl9udW1DYXNjYWRlcz90aGlzLl9wcm9qZWN0aW9uTWF0cmljZXNbZV06bnVsbH1nZXRDYXNjYWRlVHJhbnNmb3JtTWF0cml4KGUpe3JldHVybiBlPj0wJiZlPHRoaXMuX251bUNhc2NhZGVzP3RoaXMuX3RyYW5zZm9ybU1hdHJpY2VzW2VdOm51bGx9c2V0RGVwdGhSZW5kZXJlcihlKXt0aGlzLl9kZXB0aFJlbmRlcmVyPWUsdGhpcy5fZGVwdGhSZWR1Y2VyJiZ0aGlzLl9kZXB0aFJlZHVjZXIuc2V0RGVwdGhSZW5kZXJlcih0aGlzLl9kZXB0aFJlbmRlcmVyKX1nZXQgYXV0b0NhbGNEZXB0aEJvdW5kcygpe3JldHVybiB0aGlzLl9hdXRvQ2FsY0RlcHRoQm91bmRzfXNldCBhdXRvQ2FsY0RlcHRoQm91bmRzKGUpe2NvbnN0IHQ9dGhpcy5fZ2V0Q2FtZXJhKCk7aWYodCl7aWYodGhpcy5fYXV0b0NhbGNEZXB0aEJvdW5kcz1lLCFlKXt0aGlzLl9kZXB0aFJlZHVjZXImJnRoaXMuX2RlcHRoUmVkdWNlci5kZWFjdGl2YXRlKCksdGhpcy5zZXRNaW5NYXhEaXN0YW5jZSgwLDEpO3JldHVybn10aGlzLl9kZXB0aFJlZHVjZXJ8fCh0aGlzLl9kZXB0aFJlZHVjZXI9bmV3IHdvKHQpLHRoaXMuX2RlcHRoUmVkdWNlci5vbkFmdGVyUmVkdWN0aW9uUGVyZm9ybWVkLmFkZChpPT57bGV0IHM9aS5taW4scj1pLm1heDtzPj1yJiYocz0wLHI9MSksKHMhPXRoaXMuX21pbkRpc3RhbmNlfHxyIT10aGlzLl9tYXhEaXN0YW5jZSkmJnRoaXMuc2V0TWluTWF4RGlzdGFuY2UocyxyKX0pLHRoaXMuX2RlcHRoUmVkdWNlci5zZXREZXB0aFJlbmRlcmVyKHRoaXMuX2RlcHRoUmVuZGVyZXIpKSx0aGlzLl9kZXB0aFJlZHVjZXIuYWN0aXZhdGUoKX19Z2V0IGF1dG9DYWxjRGVwdGhCb3VuZHNSZWZyZXNoUmF0ZSgpe3ZhciBlLHQsaTtyZXR1cm4oaT0odD0oZT10aGlzLl9kZXB0aFJlZHVjZXIpPT09bnVsbHx8ZT09PXZvaWQgMD92b2lkIDA6ZS5kZXB0aFJlbmRlcmVyKT09PW51bGx8fHQ9PT12b2lkIDA/dm9pZCAwOnQuZ2V0RGVwdGhNYXAoKS5yZWZyZXNoUmF0ZSkhPT1udWxsJiZpIT09dm9pZCAwP2k6LTF9c2V0IGF1dG9DYWxjRGVwdGhCb3VuZHNSZWZyZXNoUmF0ZShlKXt2YXIgdDshKCh0PXRoaXMuX2RlcHRoUmVkdWNlcik9PT1udWxsfHx0PT09dm9pZCAwKSYmdC5kZXB0aFJlbmRlcmVyJiYodGhpcy5fZGVwdGhSZWR1Y2VyLmRlcHRoUmVuZGVyZXIuZ2V0RGVwdGhNYXAoKS5yZWZyZXNoUmF0ZT1lKX1zcGxpdEZydXN0dW0oKXt0aGlzLl9icmVha3NBcmVEaXJ0eT0hMH1fc3BsaXRGcnVzdHVtKCl7Y29uc3QgZT10aGlzLl9nZXRDYW1lcmEoKTtpZighZSlyZXR1cm47Y29uc3QgdD1lLm1pblosaT1lLm1heFoscz1pLXQscj10aGlzLl9taW5EaXN0YW5jZSxuPXRoaXMuX3NoYWRvd01heFo8aSYmdGhpcy5fc2hhZG93TWF4Wj49dD9NYXRoLm1pbigodGhpcy5fc2hhZG93TWF4Wi10KS8oaS10KSx0aGlzLl9tYXhEaXN0YW5jZSk6dGhpcy5fbWF4RGlzdGFuY2UsYT10K3IqcyxvPXQrbipzLGg9by1hLGw9by9hO2ZvcihsZXQgdT0wO3U8dGhpcy5fY2FzY2FkZXMubGVuZ3RoOysrdSl7Y29uc3QgZD0odSsxKS90aGlzLl9udW1DYXNjYWRlcyxmPWEqbCoqZCxfPWEraCpkLEU9dGhpcy5fbGFtYmRhKihmLV8pK187dGhpcy5fY2FzY2FkZXNbdV0ucHJldkJyZWFrRGlzdGFuY2U9dT09PTA/cjp0aGlzLl9jYXNjYWRlc1t1LTFdLmJyZWFrRGlzdGFuY2UsdGhpcy5fY2FzY2FkZXNbdV0uYnJlYWtEaXN0YW5jZT0oRS10KS9zLHRoaXMuX3ZpZXdTcGFjZUZydXN0dW1zWlt1XT1FLHRoaXMuX2ZydXN0dW1MZW5ndGhzW3VdPSh0aGlzLl9jYXNjYWRlc1t1XS5icmVha0Rpc3RhbmNlLXRoaXMuX2Nhc2NhZGVzW3VdLnByZXZCcmVha0Rpc3RhbmNlKSpzfXRoaXMuX2JyZWFrc0FyZURpcnR5PSExfV9jb21wdXRlTWF0cmljZXMoKXtjb25zdCBlPXRoaXMuX3NjZW5lO2lmKCF0aGlzLl9nZXRDYW1lcmEoKSlyZXR1cm47cC5Ob3JtYWxpemVUb1JlZih0aGlzLl9saWdodC5nZXRTaGFkb3dEaXJlY3Rpb24oMCksdGhpcy5fbGlnaHREaXJlY3Rpb24pLE1hdGguYWJzKHAuRG90KHRoaXMuX2xpZ2h0RGlyZWN0aW9uLHAuVXAoKSkpPT09MSYmKHRoaXMuX2xpZ2h0RGlyZWN0aW9uLno9MWUtMTMpLHRoaXMuX2NhY2hlZERpcmVjdGlvbi5jb3B5RnJvbSh0aGlzLl9saWdodERpcmVjdGlvbik7Y29uc3QgaT1lLmdldEVuZ2luZSgpLnVzZVJldmVyc2VEZXB0aEJ1ZmZlcjtmb3IobGV0IHM9MDtzPHRoaXMuX251bUNhc2NhZGVzOysrcyl7dGhpcy5fY29tcHV0ZUZydXN0dW1JbldvcmxkU3BhY2UocyksdGhpcy5fY29tcHV0ZUNhc2NhZGVGcnVzdHVtKHMpLHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW3NdLnN1YnRyYWN0VG9SZWYodGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbc10sTGUpLHRoaXMuX2ZydXN0dW1DZW50ZXJbc10uYWRkVG9SZWYodGhpcy5fbGlnaHREaXJlY3Rpb24uc2NhbGUodGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbc10ueiksdGhpcy5fc2hhZG93Q2FtZXJhUG9zW3NdKSx4Lkxvb2tBdExIVG9SZWYodGhpcy5fc2hhZG93Q2FtZXJhUG9zW3NdLHRoaXMuX2ZydXN0dW1DZW50ZXJbc10sTnIsdGhpcy5fdmlld01hdHJpY2VzW3NdKTtsZXQgcj0wLG49TGUuejtjb25zdCBhPXRoaXMuX3NoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm87YS51cGRhdGUodGhpcy5fdmlld01hdHJpY2VzW3NdKSxuPU1hdGgubWluKG4sYS5ib3VuZGluZ0JveC5tYXhpbXVtV29ybGQueiksIXRoaXMuX2RlcHRoQ2xhbXB8fHRoaXMuZmlsdGVyPT09Ry5GSUxURVJfUENTUz9yPU1hdGgubWluKHIsYS5ib3VuZGluZ0JveC5taW5pbXVtV29ybGQueik6cj1NYXRoLm1heChyLGEuYm91bmRpbmdCb3gubWluaW11bVdvcmxkLnopLHguT3J0aG9PZmZDZW50ZXJMSFRvUmVmKHRoaXMuX2Nhc2NhZGVNaW5FeHRlbnRzW3NdLngsdGhpcy5fY2FzY2FkZU1heEV4dGVudHNbc10ueCx0aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tzXS55LHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW3NdLnksaT9uOnIsaT9yOm4sdGhpcy5fcHJvamVjdGlvbk1hdHJpY2VzW3NdLGUuZ2V0RW5naW5lKCkuaXNORENIYWxmWlJhbmdlKSx0aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tzXS56PXIsdGhpcy5fY2FzY2FkZU1heEV4dGVudHNbc10uej1uLHRoaXMuX3ZpZXdNYXRyaWNlc1tzXS5tdWx0aXBseVRvUmVmKHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1tzXSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc1tzXSkscC5UcmFuc2Zvcm1Db29yZGluYXRlc1RvUmVmKE9vLHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzW3NdLExlKSxMZS5zY2FsZUluUGxhY2UodGhpcy5fbWFwU2l6ZS8yKSx4aS5jb3B5RnJvbUZsb2F0cyhNYXRoLnJvdW5kKExlLngpLE1hdGgucm91bmQoTGUueSksTWF0aC5yb3VuZChMZS56KSkseGkuc3VidHJhY3RJblBsYWNlKExlKS5zY2FsZUluUGxhY2UoMi90aGlzLl9tYXBTaXplKSx4LlRyYW5zbGF0aW9uVG9SZWYoeGkueCx4aS55LDAsb3MpLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1tzXS5tdWx0aXBseVRvUmVmKG9zLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1tzXSksdGhpcy5fdmlld01hdHJpY2VzW3NdLm11bHRpcGx5VG9SZWYodGhpcy5fcHJvamVjdGlvbk1hdHJpY2VzW3NdLHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzW3NdKSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc1tzXS5jb3B5VG9BcnJheSh0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc0FzQXJyYXkscyoxNil9fV9jb21wdXRlRnJ1c3R1bUluV29ybGRTcGFjZShlKXtjb25zdCB0PXRoaXMuX2dldENhbWVyYSgpO2lmKCF0KXJldHVybjtjb25zdCBpPXRoaXMuX2Nhc2NhZGVzW2VdLnByZXZCcmVha0Rpc3RhbmNlLHM9dGhpcy5fY2FzY2FkZXNbZV0uYnJlYWtEaXN0YW5jZSxyPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpLmlzTkRDSGFsZlpSYW5nZTt0LmdldFZpZXdNYXRyaXgoKTtjb25zdCBuPXguSW52ZXJ0KHQuZ2V0VHJhbnNmb3JtYXRpb25NYXRyaXgoKSksYT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKS51c2VSZXZlcnNlRGVwdGhCdWZmZXI/NDowO2ZvcihsZXQgbz0wO288a2UuX0ZydXN0dW1Db3JuZXJzTkRDU3BhY2UubGVuZ3RoOysrbylMZS5jb3B5RnJvbShrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZVsobythKSVrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZS5sZW5ndGhdKSxyJiZMZS56PT09LTEmJihMZS56PTApLHAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZihMZSxuLHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXVtvXSk7Zm9yKGxldCBvPTA7bzxrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZS5sZW5ndGgvMjsrK28pTGUuY29weUZyb20odGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdW28rNF0pLnN1YnRyYWN0SW5QbGFjZSh0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1bb10pLHhpLmNvcHlGcm9tKExlKS5zY2FsZUluUGxhY2UoaSksTGUuc2NhbGVJblBsYWNlKHMpLExlLmFkZEluUGxhY2UodGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdW29dKSx0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1bbys0XS5jb3B5RnJvbShMZSksdGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdW29dLmFkZEluUGxhY2UoeGkpfV9jb21wdXRlQ2FzY2FkZUZydXN0dW0oZSl7aWYodGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbZV0uY29weUZyb21GbG9hdHMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUpLHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW2VdLmNvcHlGcm9tRmxvYXRzKE51bWJlci5NSU5fVkFMVUUsTnVtYmVyLk1JTl9WQUxVRSxOdW1iZXIuTUlOX1ZBTFVFKSx0aGlzLl9mcnVzdHVtQ2VudGVyW2VdLmNvcHlGcm9tRmxvYXRzKDAsMCwwKSwhIXRoaXMuX2dldENhbWVyYSgpKXtmb3IobGV0IGk9MDtpPHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXS5sZW5ndGg7KytpKXRoaXMuX2ZydXN0dW1DZW50ZXJbZV0uYWRkSW5QbGFjZSh0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1baV0pO2lmKHRoaXMuX2ZydXN0dW1DZW50ZXJbZV0uc2NhbGVJblBsYWNlKDEvdGhpcy5fZnJ1c3R1bUNvcm5lcnNXb3JsZFNwYWNlW2VdLmxlbmd0aCksdGhpcy5zdGFiaWxpemVDYXNjYWRlcyl7bGV0IGk9MDtmb3IobGV0IHM9MDtzPHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXS5sZW5ndGg7KytzKXtjb25zdCByPXRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXVtzXS5zdWJ0cmFjdFRvUmVmKHRoaXMuX2ZydXN0dW1DZW50ZXJbZV0sTGUpLmxlbmd0aCgpO2k9TWF0aC5tYXgoaSxyKX1pPU1hdGguY2VpbChpKjE2KS8xNix0aGlzLl9jYXNjYWRlTWF4RXh0ZW50c1tlXS5jb3B5RnJvbUZsb2F0cyhpLGksaSksdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbZV0uY29weUZyb21GbG9hdHMoLWksLWksLWkpfWVsc2V7Y29uc3QgaT10aGlzLl9mcnVzdHVtQ2VudGVyW2VdO3RoaXMuX2ZydXN0dW1DZW50ZXJbZV0uYWRkVG9SZWYodGhpcy5fbGlnaHREaXJlY3Rpb24sTGUpLHguTG9va0F0TEhUb1JlZihpLExlLE5yLG9zKTtmb3IobGV0IHM9MDtzPHRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVtlXS5sZW5ndGg7KytzKXAuVHJhbnNmb3JtQ29vcmRpbmF0ZXNUb1JlZih0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbZV1bc10sb3MsTGUpLHRoaXMuX2Nhc2NhZGVNaW5FeHRlbnRzW2VdLm1pbmltaXplSW5QbGFjZShMZSksdGhpcy5fY2FzY2FkZU1heEV4dGVudHNbZV0ubWF4aW1pemVJblBsYWNlKExlKX19fV9yZWNyZWF0ZVNjZW5lVUJPcygpe2lmKHRoaXMuX2Rpc3Bvc2VTY2VuZVVCT3MoKSx0aGlzLl9zY2VuZVVCT3MpZm9yKGxldCBlPTA7ZTx0aGlzLl9udW1DYXNjYWRlczsrK2UpdGhpcy5fc2NlbmVVQk9zLnB1c2godGhpcy5fc2NlbmUuY3JlYXRlU2NlbmVVbmlmb3JtQnVmZmVyKGBTY2VuZSBmb3IgQ1NNIFNoYWRvdyBHZW5lcmF0b3IgKGxpZ2h0ICIke3RoaXMuX2xpZ2h0Lm5hbWV9IiBjYXNjYWRlICMke2V9KWApKX1zdGF0aWMgZ2V0IElzU3VwcG9ydGVkKCl7Y29uc3QgZT1mZS5MYXN0Q3JlYXRlZEVuZ2luZTtyZXR1cm4gZT9lLl9mZWF0dXJlcy5zdXBwb3J0Q1NNOiExfV9pbml0aWFsaXplR2VuZXJhdG9yKCl7dmFyIGUsdCxpLHMscixuLGEsbyxoLGwsdSxkLGYsXyxFLG0sdixTLHksQTt0aGlzLnBlbnVtYnJhRGFya25lc3M9KGU9dGhpcy5wZW51bWJyYURhcmtuZXNzKSE9PW51bGwmJmUhPT12b2lkIDA/ZToxLHRoaXMuX251bUNhc2NhZGVzPSh0PXRoaXMuX251bUNhc2NhZGVzKSE9PW51bGwmJnQhPT12b2lkIDA/dDprZS5ERUZBVUxUX0NBU0NBREVTX0NPVU5ULHRoaXMuc3RhYmlsaXplQ2FzY2FkZXM9KGk9dGhpcy5zdGFiaWxpemVDYXNjYWRlcykhPT1udWxsJiZpIT09dm9pZCAwP2k6ITEsdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGU9KHM9dGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUpIT09bnVsbCYmcyE9PXZvaWQgMD9zOm51bGwsdGhpcy5mcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvPShyPXRoaXMuZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbykhPT1udWxsJiZyIT09dm9pZCAwP3I6ITEsdGhpcy5fc2NiaU1pbj0obj10aGlzLl9zY2JpTWluKSE9PW51bGwmJm4hPT12b2lkIDA/bjpuZXcgcCgwLDAsMCksdGhpcy5fc2NiaU1heD0oYT10aGlzLl9zY2JpTWF4KSE9PW51bGwmJmEhPT12b2lkIDA/YTpuZXcgcCgwLDAsMCksdGhpcy5fc2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbz0obz10aGlzLl9zaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvKSE9PW51bGwmJm8hPT12b2lkIDA/bzpuZXcgZHQobmV3IHAoMCwwLDApLG5ldyBwKDAsMCwwKSksdGhpcy5fYnJlYWtzQXJlRGlydHk9KGg9dGhpcy5fYnJlYWtzQXJlRGlydHkpIT09bnVsbCYmaCE9PXZvaWQgMD9oOiEwLHRoaXMuX21pbkRpc3RhbmNlPShsPXRoaXMuX21pbkRpc3RhbmNlKSE9PW51bGwmJmwhPT12b2lkIDA/bDowLHRoaXMuX21heERpc3RhbmNlPSh1PXRoaXMuX21heERpc3RhbmNlKSE9PW51bGwmJnUhPT12b2lkIDA/dToxLHRoaXMuX2N1cnJlbnRMYXllcj0oZD10aGlzLl9jdXJyZW50TGF5ZXIpIT09bnVsbCYmZCE9PXZvaWQgMD9kOjAsdGhpcy5fc2hhZG93TWF4Wj0oRT0oZj10aGlzLl9zaGFkb3dNYXhaKSE9PW51bGwmJmYhPT12b2lkIDA/ZjooXz10aGlzLl9nZXRDYW1lcmEoKSk9PT1udWxsfHxfPT09dm9pZCAwP3ZvaWQgMDpfLm1heFopIT09bnVsbCYmRSE9PXZvaWQgMD9FOjFlNCx0aGlzLl9kZWJ1Zz0obT10aGlzLl9kZWJ1ZykhPT1udWxsJiZtIT09dm9pZCAwP206ITEsdGhpcy5fZGVwdGhDbGFtcD0odj10aGlzLl9kZXB0aENsYW1wKSE9PW51bGwmJnYhPT12b2lkIDA/djohMCx0aGlzLl9jYXNjYWRlQmxlbmRQZXJjZW50YWdlPShTPXRoaXMuX2Nhc2NhZGVCbGVuZFBlcmNlbnRhZ2UpIT09bnVsbCYmUyE9PXZvaWQgMD9TOi4xLHRoaXMuX2xhbWJkYT0oeT10aGlzLl9sYW1iZGEpIT09bnVsbCYmeSE9PXZvaWQgMD95Oi41LHRoaXMuX2F1dG9DYWxjRGVwdGhCb3VuZHM9KEE9dGhpcy5fYXV0b0NhbGNEZXB0aEJvdW5kcykhPT1udWxsJiZBIT09dm9pZCAwP0E6ITEsdGhpcy5fcmVjcmVhdGVTY2VuZVVCT3MoKSxzdXBlci5faW5pdGlhbGl6ZUdlbmVyYXRvcigpfV9jcmVhdGVUYXJnZXRSZW5kZXJUZXh0dXJlKCl7Y29uc3QgZT10aGlzLl9zY2VuZS5nZXRFbmdpbmUoKSx0PXt3aWR0aDp0aGlzLl9tYXBTaXplLGhlaWdodDp0aGlzLl9tYXBTaXplLGxheWVyczp0aGlzLm51bUNhc2NhZGVzfTt0aGlzLl9zaGFkb3dNYXA9bmV3IF90KHRoaXMuX2xpZ2h0Lm5hbWUrIl9DU01TaGFkb3dNYXAiLHQsdGhpcy5fc2NlbmUsITEsITAsdGhpcy5fdGV4dHVyZVR5cGUsITEsdm9pZCAwLCExLCExLHZvaWQgMCksdGhpcy5fc2hhZG93TWFwLmNyZWF0ZURlcHRoU3RlbmNpbFRleHR1cmUoZS51c2VSZXZlcnNlRGVwdGhCdWZmZXI/NTE2OjUxMywhMCl9X2luaXRpYWxpemVTaGFkb3dNYXAoKXtpZihzdXBlci5faW5pdGlhbGl6ZVNoYWRvd01hcCgpLHRoaXMuX3NoYWRvd01hcD09PW51bGwpcmV0dXJuO3RoaXMuX3RyYW5zZm9ybU1hdHJpY2VzQXNBcnJheT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuX251bUNhc2NhZGVzKjE2KSx0aGlzLl92aWV3U3BhY2VGcnVzdHVtc1o9bmV3IEFycmF5KHRoaXMuX251bUNhc2NhZGVzKSx0aGlzLl9mcnVzdHVtTGVuZ3Rocz1uZXcgQXJyYXkodGhpcy5fbnVtQ2FzY2FkZXMpLHRoaXMuX2xpZ2h0U2l6ZVVWQ29ycmVjdGlvbj1uZXcgQXJyYXkodGhpcy5fbnVtQ2FzY2FkZXMqMiksdGhpcy5fZGVwdGhDb3JyZWN0aW9uPW5ldyBBcnJheSh0aGlzLl9udW1DYXNjYWRlcyksdGhpcy5fY2FzY2FkZXM9W10sdGhpcy5fdmlld01hdHJpY2VzPVtdLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlcz1bXSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlcz1bXSx0aGlzLl9jYXNjYWRlTWluRXh0ZW50cz1bXSx0aGlzLl9jYXNjYWRlTWF4RXh0ZW50cz1bXSx0aGlzLl9mcnVzdHVtQ2VudGVyPVtdLHRoaXMuX3NoYWRvd0NhbWVyYVBvcz1bXSx0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2U9W107Zm9yKGxldCB0PTA7dDx0aGlzLl9udW1DYXNjYWRlczsrK3Qpe3RoaXMuX2Nhc2NhZGVzW3RdPXtwcmV2QnJlYWtEaXN0YW5jZTowLGJyZWFrRGlzdGFuY2U6MH0sdGhpcy5fdmlld01hdHJpY2VzW3RdPXguWmVybygpLHRoaXMuX3Byb2plY3Rpb25NYXRyaWNlc1t0XT14Llplcm8oKSx0aGlzLl90cmFuc2Zvcm1NYXRyaWNlc1t0XT14Llplcm8oKSx0aGlzLl9jYXNjYWRlTWluRXh0ZW50c1t0XT1uZXcgcCx0aGlzLl9jYXNjYWRlTWF4RXh0ZW50c1t0XT1uZXcgcCx0aGlzLl9mcnVzdHVtQ2VudGVyW3RdPW5ldyBwLHRoaXMuX3NoYWRvd0NhbWVyYVBvc1t0XT1uZXcgcCx0aGlzLl9mcnVzdHVtQ29ybmVyc1dvcmxkU3BhY2VbdF09bmV3IEFycmF5KGtlLl9GcnVzdHVtQ29ybmVyc05EQ1NwYWNlLmxlbmd0aCk7Zm9yKGxldCBpPTA7aTxrZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZS5sZW5ndGg7KytpKXRoaXMuX2ZydXN0dW1Db3JuZXJzV29ybGRTcGFjZVt0XVtpXT1uZXcgcH1jb25zdCBlPXRoaXMuX3NjZW5lLmdldEVuZ2luZSgpO3RoaXMuX3NoYWRvd01hcC5vbkJlZm9yZUJpbmRPYnNlcnZhYmxlLmNsZWFyKCksdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5jbGVhcigpLHRoaXMuX3NoYWRvd01hcC5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkKHQ9Pnt0aGlzLl9zY2VuZVVCT3MmJnRoaXMuX3NjZW5lLnNldFNjZW5lVW5pZm9ybUJ1ZmZlcih0aGlzLl9zY2VuZVVCT3NbdF0pLHRoaXMuX2N1cnJlbnRMYXllcj10LHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDRiYmZS5zZXRDb2xvcldyaXRlKCExKSx0aGlzLl9zY2VuZS5zZXRUcmFuc2Zvcm1NYXRyaXgodGhpcy5nZXRDYXNjYWRlVmlld01hdHJpeCh0KSx0aGlzLmdldENhc2NhZGVQcm9qZWN0aW9uTWF0cml4KHQpKSx0aGlzLl91c2VVQk8mJih0aGlzLl9zY2VuZS5nZXRTY2VuZVVuaWZvcm1CdWZmZXIoKS51bmJpbmRFZmZlY3QoKSx0aGlzLl9zY2VuZS5maW5hbGl6ZVNjZW5lVWJvKCkpfSksdGhpcy5fc2hhZG93TWFwLm9uQmVmb3JlQmluZE9ic2VydmFibGUuYWRkKCgpPT57dmFyIHQ7dGhpcy5fY3VycmVudFNjZW5lVUJPPXRoaXMuX3NjZW5lLmdldFNjZW5lVW5pZm9ybUJ1ZmZlcigpLCh0PWUuX2RlYnVnUHVzaEdyb3VwKT09PW51bGx8fHQ9PT12b2lkIDB8fHQuY2FsbChlLGBjYXNjYWRlZCBzaGFkb3cgbWFwIGdlbmVyYXRpb24gZm9yIHBhc3MgaWQgJHtlLmN1cnJlbnRSZW5kZXJQYXNzSWR9YCwxKSx0aGlzLl9icmVha3NBcmVEaXJ0eSYmdGhpcy5fc3BsaXRGcnVzdHVtKCksdGhpcy5fY29tcHV0ZU1hdHJpY2VzKCl9KSx0aGlzLl9zcGxpdEZydXN0dW0oKX1fYmluZEN1c3RvbUVmZmVjdEZvclJlbmRlclN1Yk1lc2hGb3JTaGFkb3dNYXAoZSx0KXt0LnNldE1hdHJpeCgidmlld1Byb2plY3Rpb24iLHRoaXMuZ2V0Q2FzY2FkZVRyYW5zZm9ybU1hdHJpeCh0aGlzLl9jdXJyZW50TGF5ZXIpKX1faXNSZWFkeUN1c3RvbURlZmluZXMoZSl7ZS5wdXNoKCIjZGVmaW5lIFNNX0RFUFRIQ0xBTVAgIisodGhpcy5fZGVwdGhDbGFtcCYmdGhpcy5fZmlsdGVyIT09Ry5GSUxURVJfUENTUz8iMSI6IjAiKSl9cHJlcGFyZURlZmluZXMoZSx0KXtzdXBlci5wcmVwYXJlRGVmaW5lcyhlLHQpO2NvbnN0IGk9dGhpcy5fc2NlbmUscz10aGlzLl9saWdodDtpZighaS5zaGFkb3dzRW5hYmxlZHx8IXMuc2hhZG93RW5hYmxlZClyZXR1cm47ZVsiU0hBRE9XQ1NNIit0XT0hMCxlWyJTSEFET1dDU01ERUJVRyIrdF09dGhpcy5kZWJ1ZyxlWyJTSEFET1dDU01OVU1fQ0FTQ0FERVMiK3RdPXRoaXMubnVtQ2FzY2FkZXMsZVsiU0hBRE9XQ1NNX1JJR0hUSEFOREVEIit0XT1pLnVzZVJpZ2h0SGFuZGVkU3lzdGVtO2NvbnN0IHI9dGhpcy5fZ2V0Q2FtZXJhKCk7ciYmdGhpcy5fc2hhZG93TWF4WjxyLm1heFomJihlWyJTSEFET1dDU01VU0VTSEFET1dNQVhaIit0XT0hMCksdGhpcy5jYXNjYWRlQmxlbmRQZXJjZW50YWdlPT09MCYmKGVbIlNIQURPV0NTTU5PQkxFTkQiK3RdPSEwKX1iaW5kU2hhZG93TGlnaHQoZSx0KXtjb25zdCBpPXRoaXMuX2xpZ2h0O2lmKCF0aGlzLl9zY2VuZS5zaGFkb3dzRW5hYmxlZHx8IWkuc2hhZG93RW5hYmxlZClyZXR1cm47Y29uc3Qgcj10aGlzLl9nZXRDYW1lcmEoKTtpZighcilyZXR1cm47Y29uc3Qgbj10aGlzLmdldFNoYWRvd01hcCgpO2lmKCFuKXJldHVybjtjb25zdCBhPW4uZ2V0U2l6ZSgpLndpZHRoO2lmKHQuc2V0TWF0cmljZXMoImxpZ2h0TWF0cml4IitlLHRoaXMuX3RyYW5zZm9ybU1hdHJpY2VzQXNBcnJheSksdC5zZXRBcnJheSgidmlld0ZydXN0dW1aIitlLHRoaXMuX3ZpZXdTcGFjZUZydXN0dW1zWiksdC5zZXRGbG9hdCgiY2FzY2FkZUJsZW5kRmFjdG9yIitlLHRoaXMuY2FzY2FkZUJsZW5kUGVyY2VudGFnZT09PTA/MWU0OjEvdGhpcy5jYXNjYWRlQmxlbmRQZXJjZW50YWdlKSx0LnNldEFycmF5KCJmcnVzdHVtTGVuZ3RocyIrZSx0aGlzLl9mcnVzdHVtTGVuZ3RocyksdGhpcy5fZmlsdGVyPT09Ry5GSUxURVJfUENGKXQuc2V0RGVwdGhTdGVuY2lsVGV4dHVyZSgic2hhZG93U2FtcGxlciIrZSxuKSxpLl91bmlmb3JtQnVmZmVyLnVwZGF0ZUZsb2F0NCgic2hhZG93c0luZm8iLHRoaXMuZ2V0RGFya25lc3MoKSxhLDEvYSx0aGlzLmZydXN0dW1FZGdlRmFsbG9mZixlKTtlbHNlIGlmKHRoaXMuX2ZpbHRlcj09PUcuRklMVEVSX1BDU1Mpe2ZvcihsZXQgbz0wO288dGhpcy5fbnVtQ2FzY2FkZXM7KytvKXRoaXMuX2xpZ2h0U2l6ZVVWQ29ycmVjdGlvbltvKjIrMF09bz09PTA/MToodGhpcy5fY2FzY2FkZU1heEV4dGVudHNbMF0ueC10aGlzLl9jYXNjYWRlTWluRXh0ZW50c1swXS54KS8odGhpcy5fY2FzY2FkZU1heEV4dGVudHNbb10ueC10aGlzLl9jYXNjYWRlTWluRXh0ZW50c1tvXS54KSx0aGlzLl9saWdodFNpemVVVkNvcnJlY3Rpb25bbyoyKzFdPW89PT0wPzE6KHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzWzBdLnktdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbMF0ueSkvKHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW29dLnktdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbb10ueSksdGhpcy5fZGVwdGhDb3JyZWN0aW9uW29dPW89PT0wPzE6KHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzW29dLnotdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbb10ueikvKHRoaXMuX2Nhc2NhZGVNYXhFeHRlbnRzWzBdLnotdGhpcy5fY2FzY2FkZU1pbkV4dGVudHNbMF0ueik7dC5zZXREZXB0aFN0ZW5jaWxUZXh0dXJlKCJzaGFkb3dTYW1wbGVyIitlLG4pLHQuc2V0VGV4dHVyZSgiZGVwdGhTYW1wbGVyIitlLG4pLHQuc2V0QXJyYXkyKCJsaWdodFNpemVVVkNvcnJlY3Rpb24iK2UsdGhpcy5fbGlnaHRTaXplVVZDb3JyZWN0aW9uKSx0LnNldEFycmF5KCJkZXB0aENvcnJlY3Rpb24iK2UsdGhpcy5fZGVwdGhDb3JyZWN0aW9uKSx0LnNldEZsb2F0KCJwZW51bWJyYURhcmtuZXNzIitlLHRoaXMucGVudW1icmFEYXJrbmVzcyksaS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInNoYWRvd3NJbmZvIix0aGlzLmdldERhcmtuZXNzKCksMS9hLHRoaXMuX2NvbnRhY3RIYXJkZW5pbmdMaWdodFNpemVVVlJhdGlvKmEsdGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsZSl9ZWxzZSB0LnNldFRleHR1cmUoInNoYWRvd1NhbXBsZXIiK2UsbiksaS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDQoInNoYWRvd3NJbmZvIix0aGlzLmdldERhcmtuZXNzKCksYSwxL2EsdGhpcy5mcnVzdHVtRWRnZUZhbGxvZmYsZSk7aS5fdW5pZm9ybUJ1ZmZlci51cGRhdGVGbG9hdDIoImRlcHRoVmFsdWVzIix0aGlzLmdldExpZ2h0KCkuZ2V0RGVwdGhNaW5aKHIpLHRoaXMuZ2V0TGlnaHQoKS5nZXREZXB0aE1pbloocikrdGhpcy5nZXRMaWdodCgpLmdldERlcHRoTWF4WihyKSxlKX1nZXRUcmFuc2Zvcm1NYXRyaXgoKXtyZXR1cm4gdGhpcy5nZXRDYXNjYWRlVHJhbnNmb3JtTWF0cml4KDApfWRpc3Bvc2UoKXtzdXBlci5kaXNwb3NlKCksdGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mb09ic2VydmFibGUmJih0aGlzLl9zY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUucmVtb3ZlKHRoaXMuX2ZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm9PYnNlcnZhYmxlKSx0aGlzLl9mcmVlemVTaGFkb3dDYXN0ZXJzQm91bmRpbmdJbmZvT2JzZXJ2YWJsZT1udWxsKSx0aGlzLl9kZXB0aFJlZHVjZXImJih0aGlzLl9kZXB0aFJlZHVjZXIuZGlzcG9zZSgpLHRoaXMuX2RlcHRoUmVkdWNlcj1udWxsKX1zZXJpYWxpemUoKXtjb25zdCBlPXN1cGVyLnNlcmlhbGl6ZSgpLHQ9dGhpcy5nZXRTaGFkb3dNYXAoKTtpZighdClyZXR1cm4gZTtpZihlLm51bUNhc2NhZGVzPXRoaXMuX251bUNhc2NhZGVzLGUuZGVidWc9dGhpcy5fZGVidWcsZS5zdGFiaWxpemVDYXNjYWRlcz10aGlzLnN0YWJpbGl6ZUNhc2NhZGVzLGUubGFtYmRhPXRoaXMuX2xhbWJkYSxlLmNhc2NhZGVCbGVuZFBlcmNlbnRhZ2U9dGhpcy5jYXNjYWRlQmxlbmRQZXJjZW50YWdlLGUuZGVwdGhDbGFtcD10aGlzLl9kZXB0aENsYW1wLGUuYXV0b0NhbGNEZXB0aEJvdW5kcz10aGlzLmF1dG9DYWxjRGVwdGhCb3VuZHMsZS5zaGFkb3dNYXhaPXRoaXMuX3NoYWRvd01heFosZS5wZW51bWJyYURhcmtuZXNzPXRoaXMucGVudW1icmFEYXJrbmVzcyxlLmZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm89dGhpcy5fZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbyxlLm1pbkRpc3RhbmNlPXRoaXMubWluRGlzdGFuY2UsZS5tYXhEaXN0YW5jZT10aGlzLm1heERpc3RhbmNlLGUucmVuZGVyTGlzdD1bXSx0LnJlbmRlckxpc3QpZm9yKGxldCBpPTA7aTx0LnJlbmRlckxpc3QubGVuZ3RoO2krKyl7Y29uc3Qgcz10LnJlbmRlckxpc3RbaV07ZS5yZW5kZXJMaXN0LnB1c2gocy5pZCl9cmV0dXJuIGV9c3RhdGljIFBhcnNlKGUsdCl7Y29uc3QgaT1HLlBhcnNlKGUsdCwocyxyLG4pPT5uZXcga2UocyxyLHZvaWQgMCxuKSk7cmV0dXJuIGUubnVtQ2FzY2FkZXMhPT12b2lkIDAmJihpLm51bUNhc2NhZGVzPWUubnVtQ2FzY2FkZXMpLGUuZGVidWchPT12b2lkIDAmJihpLmRlYnVnPWUuZGVidWcpLGUuc3RhYmlsaXplQ2FzY2FkZXMhPT12b2lkIDAmJihpLnN0YWJpbGl6ZUNhc2NhZGVzPWUuc3RhYmlsaXplQ2FzY2FkZXMpLGUubGFtYmRhIT09dm9pZCAwJiYoaS5sYW1iZGE9ZS5sYW1iZGEpLGUuY2FzY2FkZUJsZW5kUGVyY2VudGFnZSE9PXZvaWQgMCYmKGkuY2FzY2FkZUJsZW5kUGVyY2VudGFnZT1lLmNhc2NhZGVCbGVuZFBlcmNlbnRhZ2UpLGUuZGVwdGhDbGFtcCE9PXZvaWQgMCYmKGkuZGVwdGhDbGFtcD1lLmRlcHRoQ2xhbXApLGUuYXV0b0NhbGNEZXB0aEJvdW5kcyE9PXZvaWQgMCYmKGkuYXV0b0NhbGNEZXB0aEJvdW5kcz1lLmF1dG9DYWxjRGVwdGhCb3VuZHMpLGUuc2hhZG93TWF4WiE9PXZvaWQgMCYmKGkuc2hhZG93TWF4Wj1lLnNoYWRvd01heFopLGUucGVudW1icmFEYXJrbmVzcyE9PXZvaWQgMCYmKGkucGVudW1icmFEYXJrbmVzcz1lLnBlbnVtYnJhRGFya25lc3MpLGUuZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbyE9PXZvaWQgMCYmKGkuZnJlZXplU2hhZG93Q2FzdGVyc0JvdW5kaW5nSW5mbz1lLmZyZWV6ZVNoYWRvd0Nhc3RlcnNCb3VuZGluZ0luZm8pLGUubWluRGlzdGFuY2UhPT12b2lkIDAmJmUubWF4RGlzdGFuY2UhPT12b2lkIDAmJmkuc2V0TWluTWF4RGlzdGFuY2UoZS5taW5EaXN0YW5jZSxlLm1heERpc3RhbmNlKSxpfX1rZS5fRnJ1c3R1bUNvcm5lcnNORENTcGFjZT1bbmV3IHAoLTEsMSwtMSksbmV3IHAoMSwxLC0xKSxuZXcgcCgxLC0xLC0xKSxuZXcgcCgtMSwtMSwtMSksbmV3IHAoLTEsMSwxKSxuZXcgcCgxLDEsMSksbmV3IHAoMSwtMSwxKSxuZXcgcCgtMSwtMSwxKV0sa2UuQ0xBU1NOQU1FPSJDYXNjYWRlZFNoYWRvd0dlbmVyYXRvciIsa2UuREVGQVVMVF9DQVNDQURFU19DT1VOVD00LGtlLk1JTl9DQVNDQURFU19DT1VOVD0yLGtlLk1BWF9DQVNDQURFU19DT1VOVD00LGtlLl9TY2VuZUNvbXBvbmVudEluaXRpYWxpemF0aW9uPWM9Pnt0aHJvdyAkKCJTaGFkb3dHZW5lcmF0b3JTY2VuZUNvbXBvbmVudCIpfSxaaS5BZGRQYXJzZXIocS5OQU1FX1NIQURPV0dFTkVSQVRPUiwoYyxlKT0+e2lmKGMuc2hhZG93R2VuZXJhdG9ycyE9PXZvaWQgMCYmYy5zaGFkb3dHZW5lcmF0b3JzIT09bnVsbClmb3IobGV0IHQ9MCxpPWMuc2hhZG93R2VuZXJhdG9ycy5sZW5ndGg7dDxpO3QrKyl7Y29uc3Qgcz1jLnNoYWRvd0dlbmVyYXRvcnNbdF07cy5jbGFzc05hbWU9PT1rZS5DTEFTU05BTUU/a2UuUGFyc2UocyxlKTpHLlBhcnNlKHMsZSl9fSk7Y2xhc3MgTG97Y29uc3RydWN0b3IoZSl7dGhpcy5uYW1lPXEuTkFNRV9TSEFET1dHRU5FUkFUT1IsdGhpcy5zY2VuZT1lfXJlZ2lzdGVyKCl7dGhpcy5zY2VuZS5fZ2F0aGVyUmVuZGVyVGFyZ2V0c1N0YWdlLnJlZ2lzdGVyU3RlcChxLlNURVBfR0FUSEVSUkVOREVSVEFSR0VUU19TSEFET1dHRU5FUkFUT1IsdGhpcyx0aGlzLl9nYXRoZXJSZW5kZXJUYXJnZXRzKX1yZWJ1aWxkKCl7fXNlcmlhbGl6ZShlKXtlLnNoYWRvd0dlbmVyYXRvcnM9W107Y29uc3QgdD10aGlzLnNjZW5lLmxpZ2h0cztmb3IoY29uc3QgaSBvZiB0KXtjb25zdCBzPWkuZ2V0U2hhZG93R2VuZXJhdG9ycygpO2lmKHMpe2NvbnN0IHI9cy52YWx1ZXMoKTtmb3IobGV0IG49ci5uZXh0KCk7bi5kb25lIT09ITA7bj1yLm5leHQoKSl7Y29uc3QgYT1uLnZhbHVlO2Uuc2hhZG93R2VuZXJhdG9ycy5wdXNoKGEuc2VyaWFsaXplKCkpfX19fWFkZEZyb21Db250YWluZXIoZSl7fXJlbW92ZUZyb21Db250YWluZXIoZSx0KXt9ZGlzcG9zZSgpe31fZ2F0aGVyUmVuZGVyVGFyZ2V0cyhlKXtjb25zdCB0PXRoaXMuc2NlbmU7aWYodGhpcy5zY2VuZS5zaGFkb3dzRW5hYmxlZClmb3IobGV0IGk9MDtpPHQubGlnaHRzLmxlbmd0aDtpKyspe2NvbnN0IHM9dC5saWdodHNbaV0scj1zLmdldFNoYWRvd0dlbmVyYXRvcnMoKTtpZihzLmlzRW5hYmxlZCgpJiZzLnNoYWRvd0VuYWJsZWQmJnIpe2NvbnN0IG49ci52YWx1ZXMoKTtmb3IobGV0IGE9bi5uZXh0KCk7YS5kb25lIT09ITA7YT1uLm5leHQoKSl7Y29uc3QgaD1hLnZhbHVlLmdldFNoYWRvd01hcCgpO3QudGV4dHVyZXMuaW5kZXhPZihoKSE9PS0xJiZlLnB1c2goaCl9fX19fUcuX1NjZW5lQ29tcG9uZW50SW5pdGlhbGl6YXRpb249Yz0+e2xldCBlPWMuX2dldENvbXBvbmVudChxLk5BTUVfU0hBRE9XR0VORVJBVE9SKTtlfHwoZT1uZXcgTG8oYyksYy5fYWRkQ29tcG9uZW50KGUpKX07Y29uc3QgTm89e2VuYWJsZVNoYWRvd3M6ITB9O2Z1bmN0aW9uIEJyKGM9Tm8pe2NvbnN0e2VuYWJsZVNoYWRvd3M6ZSxzaGFkb3dUcmFuc3BhcmVuY3k6dCxpbnRlbnNpdHk6aSxzY2VuZTpzfT1jLHI9bmV3IEl0KCJEaXJlY3Rpb25hbExpZ2h0IixuZXcgcCgtLjMsLTEsLjQpLHMpO3IucG9zaXRpb249bmV3IHAoLTUwLDY1LC01MCksci5pbnRlbnNpdHk9LjY1Kmk7Y29uc3Qgbj1uZXcgbnMoIkhlbWlzcGhlcmljTGlnaHQiLG5ldyBwKDEsMSwwKSxzKTtyZXR1cm4gbi5pbnRlbnNpdHk9LjQqaSxlJiYoci5zaGFkb3dNaW5aPTEsci5zaGFkb3dNYXhaPTcwLHIuc2hhZG93R2VuZXJhdG9yPW5ldyBHKDIwNDgsciksci5zaGFkb3dHZW5lcmF0b3IudXNlQ2xvc2VFeHBvbmVudGlhbFNoYWRvd01hcD0hMCxyLnNoYWRvd0dlbmVyYXRvci5kYXJrbmVzcz10KSx7ZGlyZWN0aW9uYWw6cixoZW1pc3BoZXJpYzpufX1mdW5jdGlvbiBVcihjKXtsZXQgdD1bMCwxLDIsMCwyLDMsNCw1LDYsNCw2LDcsOCw5LDEwLDgsMTAsMTEsMTIsMTMsMTQsMTIsMTQsMTUsMTYsMTcsMTgsMTYsMTgsMTksMjAsMjEsMjIsMjAsMjIsMjNdO2NvbnN0IGk9WzAsMCwxLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwtMSwwLDAsLTEsMCwwLC0xLDAsMCwtMSwxLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwtMSwwLDAsLTEsMCwwLC0xLDAsMCwtMSwwLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwxLDAsMCwtMSwwLDAsLTEsMCwwLC0xLDAsMCwtMSwwXSxzPVtdO2xldCByPVtdO2NvbnN0IG49Yy53aWR0aHx8Yy5zaXplfHwxLGE9Yy5oZWlnaHR8fGMuc2l6ZXx8MSxvPWMuZGVwdGh8fGMuc2l6ZXx8MSxoPWMud3JhcHx8ITE7bGV0IGw9Yy50b3BCYXNlQXQ9PT12b2lkIDA/MTpjLnRvcEJhc2VBdCx1PWMuYm90dG9tQmFzZUF0PT09dm9pZCAwPzA6Yy5ib3R0b21CYXNlQXQ7bD0obCs0KSU0LHU9KHUrNCklNDtjb25zdCBkPVsyLDAsMywxXSxmPVsyLDAsMSwzXTtsZXQgXz1kW2xdLEU9Zlt1XSxtPVsxLC0xLDEsLTEsLTEsMSwtMSwxLDEsMSwxLDEsMSwxLC0xLC0xLDEsLTEsLTEsLTEsLTEsMSwtMSwtMSwxLDEsLTEsMSwtMSwtMSwxLC0xLDEsMSwxLDEsLTEsMSwxLC0xLC0xLDEsLTEsLTEsLTEsLTEsMSwtMSwtMSwxLDEsLTEsMSwtMSwxLDEsLTEsMSwxLDEsMSwtMSwxLDEsLTEsLTEsLTEsLTEsLTEsLTEsLTEsMV07aWYoaCl7dD1bMiwzLDAsMiwwLDEsNCw1LDYsNCw2LDcsOSwxMCwxMSw5LDExLDgsMTIsMTQsMTUsMTIsMTMsMTRdLG09Wy0xLDEsMSwxLDEsMSwxLC0xLDEsLTEsLTEsMSwxLDEsLTEsLTEsMSwtMSwtMSwtMSwtMSwxLC0xLC0xLDEsMSwxLDEsMSwtMSwxLC0xLC0xLDEsLTEsMSwtMSwxLC0xLC0xLDEsMSwtMSwtMSwxLC0xLC0xLC0xXTtsZXQgTT1bWzEsMSwxXSxbLTEsMSwxXSxbLTEsMSwtMV0sWzEsMSwtMV1dLEw9W1stMSwtMSwxXSxbMSwtMSwxXSxbMSwtMSwtMV0sWy0xLC0xLC0xXV07Y29uc3Qgaz1bMTcsMTgsMTksMTZdLHc9WzIyLDIzLDIwLDIxXTtmb3IoO18+MDspTS51bnNoaWZ0KE0ucG9wKCkpLGsudW5zaGlmdChrLnBvcCgpKSxfLS07Zm9yKDtFPjA7KUwudW5zaGlmdChMLnBvcCgpKSx3LnVuc2hpZnQody5wb3AoKSksRS0tO009TS5mbGF0KCksTD1MLmZsYXQoKSxtPW0uY29uY2F0KE0pLmNvbmNhdChMKSx0LnB1c2goa1swXSxrWzJdLGtbM10sa1swXSxrWzFdLGtbMl0pLHQucHVzaCh3WzBdLHdbMl0sd1szXSx3WzBdLHdbMV0sd1syXSl9Y29uc3Qgdj1bbi8yLGEvMixvLzJdO3I9bS5yZWR1Y2UoKE0sTCxrKT0+TS5jb25jYXQoTCp2W2slM10pLFtdKTtjb25zdCBTPWMuc2lkZU9yaWVudGF0aW9uPT09MD8wOmMuc2lkZU9yaWVudGF0aW9ufHxlZS5ERUZBVUxUU0lERSx5PWMuZmFjZVVWfHxuZXcgQXJyYXkoNiksQT1jLmZhY2VDb2xvcnMsQz1bXTtmb3IobGV0IE09MDtNPDY7TSsrKXlbTV09PT12b2lkIDAmJih5W01dPW5ldyBDZSgwLDAsMSwxKSksQSYmQVtNXT09PXZvaWQgMCYmKEFbTV09bmV3IG1lKDEsMSwxLDEpKTtmb3IobGV0IE09MDtNPDY7TSsrKWlmKHMucHVzaCh5W01dLnosZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0udzp5W01dLncpLHMucHVzaCh5W01dLngsZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0udzp5W01dLncpLHMucHVzaCh5W01dLngsZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0ueTp5W01dLnkpLHMucHVzaCh5W01dLnosZnQuVXNlT3BlbkdMT3JpZW50YXRpb25Gb3JVVj8xLXlbTV0ueTp5W01dLnkpLEEpZm9yKGxldCBMPTA7TDw0O0wrKylDLnB1c2goQVtNXS5yLEFbTV0uZyxBW01dLmIsQVtNXS5hKTtlZS5fQ29tcHV0ZVNpZGVzKFMscix0LGkscyxjLmZyb250VVZzLGMuYmFja1VWcyk7Y29uc3QgYj1uZXcgZWU7aWYoYi5pbmRpY2VzPXQsYi5wb3NpdGlvbnM9cixiLm5vcm1hbHM9aSxiLnV2cz1zLEEpe2NvbnN0IE09Uz09PWVlLkRPVUJMRVNJREU/Qy5jb25jYXQoQyk6QztiLmNvbG9ycz1NfXJldHVybiBifWZ1bmN0aW9uIE1pKGMsZT17fSx0PW51bGwpe2NvbnN0IGk9bmV3IFcoYyx0KTtyZXR1cm4gZS5zaWRlT3JpZW50YXRpb249Vy5fR2V0RGVmYXVsdFNpZGVPcmllbnRhdGlvbihlLnNpZGVPcmllbnRhdGlvbiksaS5fb3JpZ2luYWxCdWlsZGVyU2lkZU9yaWVudGF0aW9uPWUuc2lkZU9yaWVudGF0aW9uLFVyKGUpLmFwcGx5VG9NZXNoKGksZS51cGRhdGFibGUpLGl9ZWUuQ3JlYXRlQm94PVVyLFcuQ3JlYXRlQm94PShjLGUsdD1udWxsLGkscyk9Pk1pKGMse3NpemU6ZSxzaWRlT3JpZW50YXRpb246cyx1cGRhdGFibGU6aX0sdCk7Y2xhc3Mga3J7Y29uc3RydWN0b3IoKXt0aGlzLnByZXZpb3VzV29ybGRNYXRyaWNlcz17fSx0aGlzLnByZXZpb3VzQm9uZXM9e319c3RhdGljIEFkZFVuaWZvcm1zKGUpe2UucHVzaCgicHJldmlvdXNXb3JsZCIsInByZXZpb3VzVmlld1Byb2plY3Rpb24iLCJtUHJldmlvdXNCb25lcyIpfXN0YXRpYyBBZGRTYW1wbGVycyhlKXt9YmluZEZvclN1Yk1lc2goZSx0LGkscyxyKXtpZih0LnByZVBhc3NSZW5kZXJlciYmdC5wcmVQYXNzUmVuZGVyZXIuZW5hYmxlZCYmdC5wcmVQYXNzUmVuZGVyZXIuY3VycmVudFJUaXNTY2VuZVJUJiZ0LnByZVBhc3NSZW5kZXJlci5nZXRJbmRleCgyKSE9PS0xKXt0aGlzLnByZXZpb3VzV29ybGRNYXRyaWNlc1tpLnVuaXF1ZUlkXXx8KHRoaXMucHJldmlvdXNXb3JsZE1hdHJpY2VzW2kudW5pcXVlSWRdPXMuY2xvbmUoKSksdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9ufHwodGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uPXQuZ2V0VHJhbnNmb3JtTWF0cml4KCkuY2xvbmUoKSx0aGlzLmN1cnJlbnRWaWV3UHJvamVjdGlvbj10LmdldFRyYW5zZm9ybU1hdHJpeCgpLmNsb25lKCkpO2NvbnN0IG49dC5nZXRFbmdpbmUoKTt0aGlzLmN1cnJlbnRWaWV3UHJvamVjdGlvbi51cGRhdGVGbGFnIT09dC5nZXRUcmFuc2Zvcm1NYXRyaXgoKS51cGRhdGVGbGFnPyh0aGlzLl9sYXN0VXBkYXRlRnJhbWVJZD1uLmZyYW1lSWQsdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uLmNvcHlGcm9tKHRoaXMuY3VycmVudFZpZXdQcm9qZWN0aW9uKSx0aGlzLmN1cnJlbnRWaWV3UHJvamVjdGlvbi5jb3B5RnJvbSh0LmdldFRyYW5zZm9ybU1hdHJpeCgpKSk6dGhpcy5fbGFzdFVwZGF0ZUZyYW1lSWQhPT1uLmZyYW1lSWQmJih0aGlzLl9sYXN0VXBkYXRlRnJhbWVJZD1uLmZyYW1lSWQsdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uLmNvcHlGcm9tKHRoaXMuY3VycmVudFZpZXdQcm9qZWN0aW9uKSksZS5zZXRNYXRyaXgoInByZXZpb3VzV29ybGQiLHRoaXMucHJldmlvdXNXb3JsZE1hdHJpY2VzW2kudW5pcXVlSWRdKSxlLnNldE1hdHJpeCgicHJldmlvdXNWaWV3UHJvamVjdGlvbiIsdGhpcy5wcmV2aW91c1ZpZXdQcm9qZWN0aW9uKSx0aGlzLnByZXZpb3VzV29ybGRNYXRyaWNlc1tpLnVuaXF1ZUlkXT1zLmNsb25lKCl9fX1jbGFzcyBWciBleHRlbmRzIFB7Y29uc3RydWN0b3IoZSx0LGk9ITApe3N1cGVyKGUsdCksdGhpcy5fbm9ybWFsTWF0cml4PW5ldyB4LHRoaXMuX3N0b3JlRWZmZWN0T25TdWJNZXNoZXM9aX1nZXRFZmZlY3QoKXtyZXR1cm4gdGhpcy5fc3RvcmVFZmZlY3RPblN1Yk1lc2hlcz90aGlzLl9hY3RpdmVFZmZlY3Q6c3VwZXIuZ2V0RWZmZWN0KCl9aXNSZWFkeShlLHQpe3JldHVybiBlPyF0aGlzLl9zdG9yZUVmZmVjdE9uU3ViTWVzaGVzfHwhZS5zdWJNZXNoZXN8fGUuc3ViTWVzaGVzLmxlbmd0aD09PTA/ITA6dGhpcy5pc1JlYWR5Rm9yU3ViTWVzaChlLGUuc3ViTWVzaGVzWzBdLHQpOiExfV9pc1JlYWR5Rm9yU3ViTWVzaChlKXtjb25zdCB0PWUubWF0ZXJpYWxEZWZpbmVzO3JldHVybiEhKCF0aGlzLmNoZWNrUmVhZHlPbkV2ZXJ5Q2FsbCYmZS5lZmZlY3QmJnQmJnQuX3JlbmRlcklkPT09dGhpcy5nZXRTY2VuZSgpLmdldFJlbmRlcklkKCkpfWJpbmRPbmx5V29ybGRNYXRyaXgoZSl7dGhpcy5fYWN0aXZlRWZmZWN0LnNldE1hdHJpeCgid29ybGQiLGUpfWJpbmRPbmx5Tm9ybWFsTWF0cml4KGUpe3RoaXMuX2FjdGl2ZUVmZmVjdC5zZXRNYXRyaXgoIm5vcm1hbE1hdHJpeCIsZSl9YmluZChlLHQpe3QmJnRoaXMuYmluZEZvclN1Yk1lc2goZSx0LHQuc3ViTWVzaGVzWzBdKX1fYWZ0ZXJCaW5kKGUsdD1udWxsKXtzdXBlci5fYWZ0ZXJCaW5kKGUsdCksdGhpcy5nZXRTY2VuZSgpLl9jYWNoZWRFZmZlY3Q9dCx0JiYodC5fZm9yY2VSZWJpbmRPbk5leHRDYWxsPSExKX1fbXVzdFJlYmluZChlLHQsaT0xKXtyZXR1cm4gZS5pc0NhY2hlZE1hdGVyaWFsSW52YWxpZCh0aGlzLHQsaSl9fWNsYXNzIHVle3N0YXRpYyBnZXQgRGlmZnVzZVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0RpZmZ1c2VUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IERpZmZ1c2VUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9EaWZmdXNlVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fRGlmZnVzZVRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBEZXRhaWxUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9EZXRhaWxUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IERldGFpbFRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0RldGFpbFRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX0RldGFpbFRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBBbWJpZW50VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQW1iaWVudFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQW1iaWVudFRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0FtYmllbnRUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9BbWJpZW50VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IE9wYWNpdHlUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9PcGFjaXR5VGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBPcGFjaXR5VGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fT3BhY2l0eVRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX09wYWNpdHlUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgUmVmbGVjdGlvblRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX1JlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0VtaXNzaXZlVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0VtaXNzaXZlVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fRW1pc3NpdmVUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgU3BlY3VsYXJUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9TcGVjdWxhclRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgU3BlY3VsYXJUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9TcGVjdWxhclRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX1NwZWN1bGFyVGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IEJ1bXBUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9CdW1wVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBCdW1wVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fQnVtcFRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX0J1bXBUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgTGlnaHRtYXBUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9MaWdodG1hcFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgTGlnaHRtYXBUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9MaWdodG1hcFRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX0xpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IFJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCgpe3JldHVybiB0aGlzLl9SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBSZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fUmVmcmFjdGlvblRleHR1cmVFbmFibGVkIT09ZSYmKHRoaXMuX1JlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBDb2xvckdyYWRpbmdUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9Db2xvckdyYWRpbmdUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9Db2xvckdyYWRpbmdUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgRnJlc25lbEVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fRnJlc25lbEVuYWJsZWR9c3RhdGljIHNldCBGcmVzbmVsRW5hYmxlZChlKXt0aGlzLl9GcmVzbmVsRW5hYmxlZCE9PWUmJih0aGlzLl9GcmVzbmVsRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoNCkpfXN0YXRpYyBnZXQgQ2xlYXJDb2F0VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQ2xlYXJDb2F0VGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBDbGVhckNvYXRUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9DbGVhckNvYXRUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9DbGVhckNvYXRUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgQ2xlYXJDb2F0QnVtcFRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0NsZWFyQ29hdEJ1bXBUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IENsZWFyQ29hdEJ1bXBUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9DbGVhckNvYXRCdW1wVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fQ2xlYXJDb2F0QnVtcFRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBDbGVhckNvYXRUaW50VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fQ2xlYXJDb2F0VGludFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQ2xlYXJDb2F0VGludFRleHR1cmVFbmFibGVkKGUpe3RoaXMuX0NsZWFyQ29hdFRpbnRUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9DbGVhckNvYXRUaW50VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IFNoZWVuVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fU2hlZW5UZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFNoZWVuVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fU2hlZW5UZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9TaGVlblRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9c3RhdGljIGdldCBBbmlzb3Ryb3BpY1RleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX0FuaXNvdHJvcGljVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBBbmlzb3Ryb3BpY1RleHR1cmVFbmFibGVkKGUpe3RoaXMuX0FuaXNvdHJvcGljVGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fQW5pc290cm9waWNUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgVGhpY2tuZXNzVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fVGhpY2tuZXNzVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBUaGlja25lc3NUZXh0dXJlRW5hYmxlZChlKXt0aGlzLl9UaGlja25lc3NUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9UaGlja25lc3NUZXh0dXJlRW5hYmxlZD1lLEkuTWFya0FsbE1hdGVyaWFsc0FzRGlydHkoMSkpfXN0YXRpYyBnZXQgUmVmcmFjdGlvbkludGVuc2l0eVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX1RoaWNrbmVzc1RleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgUmVmcmFjdGlvbkludGVuc2l0eVRleHR1cmVFbmFibGVkKGUpe3RoaXMuX1JlZnJhY3Rpb25JbnRlbnNpdHlUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9SZWZyYWN0aW9uSW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IFRyYW5zbHVjZW5jeUludGVuc2l0eVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHRoaXMuX1RoaWNrbmVzc1RleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgVHJhbnNsdWNlbmN5SW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fVHJhbnNsdWNlbmN5SW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQhPT1lJiYodGhpcy5fVHJhbnNsdWNlbmN5SW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQ9ZSxJLk1hcmtBbGxNYXRlcmlhbHNBc0RpcnR5KDEpKX1zdGF0aWMgZ2V0IElyaWRlc2NlbmNlVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdGhpcy5fSXJpZGVzY2VuY2VUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IElyaWRlc2NlbmNlVGV4dHVyZUVuYWJsZWQoZSl7dGhpcy5fSXJpZGVzY2VuY2VUZXh0dXJlRW5hYmxlZCE9PWUmJih0aGlzLl9JcmlkZXNjZW5jZVRleHR1cmVFbmFibGVkPWUsSS5NYXJrQWxsTWF0ZXJpYWxzQXNEaXJ0eSgxKSl9fXVlLl9EaWZmdXNlVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0RldGFpbFRleHR1cmVFbmFibGVkPSEwLHVlLl9BbWJpZW50VGV4dHVyZUVuYWJsZWQ9ITAsdWUuX09wYWNpdHlUZXh0dXJlRW5hYmxlZD0hMCx1ZS5fUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPSEwLHVlLl9FbWlzc2l2ZVRleHR1cmVFbmFibGVkPSEwLHVlLl9TcGVjdWxhclRleHR1cmVFbmFibGVkPSEwLHVlLl9CdW1wVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0xpZ2h0bWFwVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1JlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZD0hMCx1ZS5fQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0ZyZXNuZWxFbmFibGVkPSEwLHVlLl9DbGVhckNvYXRUZXh0dXJlRW5hYmxlZD0hMCx1ZS5fQ2xlYXJDb2F0QnVtcFRleHR1cmVFbmFibGVkPSEwLHVlLl9DbGVhckNvYXRUaW50VGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1NoZWVuVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX0FuaXNvdHJvcGljVGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1RoaWNrbmVzc1RleHR1cmVFbmFibGVkPSEwLHVlLl9SZWZyYWN0aW9uSW50ZW5zaXR5VGV4dHVyZUVuYWJsZWQ9ITAsdWUuX1RyYW5zbHVjZW5jeUludGVuc2l0eVRleHR1cmVFbmFibGVkPSEwLHVlLl9JcmlkZXNjZW5jZVRleHR1cmVFbmFibGVkPSEwO2NvbnN0IEJvPSJkZWZhdWx0RnJhZ21lbnREZWNsYXJhdGlvbiIsVW89YHVuaWZvcm0gdmVjNCB2RXllUG9zaXRpb247CnVuaWZvcm0gdmVjNCB2RGlmZnVzZUNvbG9yOwojaWZkZWYgU1BFQ1VMQVJURVJNCnVuaWZvcm0gdmVjNCB2U3BlY3VsYXJDb2xvcjsKI2VuZGlmCnVuaWZvcm0gdmVjMyB2RW1pc3NpdmVDb2xvcjsKdW5pZm9ybSB2ZWMzIHZBbWJpZW50Q29sb3I7CnVuaWZvcm0gZmxvYXQgdmlzaWJpbGl0eTsKI2lmZGVmIERJRkZVU0UKdW5pZm9ybSB2ZWMyIHZEaWZmdXNlSW5mb3M7CiNlbmRpZgojaWZkZWYgQU1CSUVOVAp1bmlmb3JtIHZlYzIgdkFtYmllbnRJbmZvczsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZIAp1bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvczsKI2VuZGlmCiNpZmRlZiBFTUlTU0lWRQp1bmlmb3JtIHZlYzIgdkVtaXNzaXZlSW5mb3M7CiNlbmRpZgojaWZkZWYgTElHSFRNQVAKdW5pZm9ybSB2ZWMyIHZMaWdodG1hcEluZm9zOwojZW5kaWYKI2lmZGVmIEJVTVAKdW5pZm9ybSB2ZWMzIHZCdW1wSW5mb3M7CnVuaWZvcm0gdmVjMiB2VGFuZ2VudFNwYWNlUGFyYW1zOwojZW5kaWYKI2lmZGVmIEFMUEhBVEVTVAp1bmlmb3JtIGZsb2F0IGFscGhhQ3V0T2ZmOwojZW5kaWYKI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9TUEhFUklDQUwpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OKSB8fCBkZWZpbmVkKFJFRlJBQ1RJT04pIHx8IGRlZmluZWQoUFJFUEFTUykKdW5pZm9ybSBtYXQ0IHZpZXc7CiNlbmRpZgojaWZkZWYgUkVGUkFDVElPTgp1bmlmb3JtIHZlYzQgdlJlZnJhY3Rpb25JbmZvczsKI2lmbmRlZiBSRUZSQUNUSU9OTUFQXzNECnVuaWZvcm0gbWF0NCByZWZyYWN0aW9uTWF0cml4OwojZW5kaWYKI2lmZGVmIFJFRlJBQ1RJT05GUkVTTkVMCnVuaWZvcm0gdmVjNCByZWZyYWN0aW9uTGVmdENvbG9yOwp1bmlmb3JtIHZlYzQgcmVmcmFjdGlvblJpZ2h0Q29sb3I7CiNlbmRpZgojaWYgZGVmaW5lZChVU0VfTE9DQUxfUkVGUkFDVElPTk1BUF9DVUJJQykgJiYgZGVmaW5lZChSRUZSQUNUSU9OTUFQXzNEKQp1bmlmb3JtIHZlYzMgdlJlZnJhY3Rpb25Qb3NpdGlvbjsKdW5pZm9ybSB2ZWMzIHZSZWZyYWN0aW9uU2l6ZTsgCiNlbmRpZgojZW5kaWYKI2lmIGRlZmluZWQoU1BFQ1VMQVIpICYmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQp1bmlmb3JtIHZlYzIgdlNwZWN1bGFySW5mb3M7CiNlbmRpZgojaWZkZWYgRElGRlVTRUZSRVNORUwKdW5pZm9ybSB2ZWM0IGRpZmZ1c2VMZWZ0Q29sb3I7CnVuaWZvcm0gdmVjNCBkaWZmdXNlUmlnaHRDb2xvcjsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZRlJFU05FTAp1bmlmb3JtIHZlYzQgb3BhY2l0eVBhcnRzOwojZW5kaWYKI2lmZGVmIEVNSVNTSVZFRlJFU05FTAp1bmlmb3JtIHZlYzQgZW1pc3NpdmVMZWZ0Q29sb3I7CnVuaWZvcm0gdmVjNCBlbWlzc2l2ZVJpZ2h0Q29sb3I7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTgp1bmlmb3JtIHZlYzIgdlJlZmxlY3Rpb25JbmZvczsKI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9QTEFOQVIpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9DVUJJQykgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX1BST0pFQ1RJT04pIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVIpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9TUEhFUklDQUwpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9TS1lCT1gpCnVuaWZvcm0gbWF0NCByZWZsZWN0aW9uTWF0cml4OwojZW5kaWYKI2lmbmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWAojaWYgZGVmaW5lZChVU0VfTE9DQUxfUkVGTEVDVElPTk1BUF9DVUJJQykgJiYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0NVQklDKQp1bmlmb3JtIHZlYzMgdlJlZmxlY3Rpb25Qb3NpdGlvbjsKdW5pZm9ybSB2ZWMzIHZSZWZsZWN0aW9uU2l6ZTsgCiNlbmRpZgojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMCnVuaWZvcm0gdmVjNCByZWZsZWN0aW9uTGVmdENvbG9yOwp1bmlmb3JtIHZlYzQgcmVmbGVjdGlvblJpZ2h0Q29sb3I7CiNlbmRpZgojZW5kaWYKI2lmZGVmIERFVEFJTAp1bmlmb3JtIHZlYzQgdkRldGFpbEluZm9zOwojZW5kaWYKI2RlZmluZSBBRERJVElPTkFMX0ZSQUdNRU5UX0RFQ0xBUkFUSU9OCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtCb109VW87Y29uc3Qga289ImRlZmF1bHRVYm9EZWNsYXJhdGlvbiIsVm89YGxheW91dChzdGQxNDAsY29sdW1uX21ham9yKSB1bmlmb3JtOwp1bmlmb3JtIE1hdGVyaWFsCnsKdmVjNCBkaWZmdXNlTGVmdENvbG9yOwp2ZWM0IGRpZmZ1c2VSaWdodENvbG9yOwp2ZWM0IG9wYWNpdHlQYXJ0czsKdmVjNCByZWZsZWN0aW9uTGVmdENvbG9yOwp2ZWM0IHJlZmxlY3Rpb25SaWdodENvbG9yOwp2ZWM0IHJlZnJhY3Rpb25MZWZ0Q29sb3I7CnZlYzQgcmVmcmFjdGlvblJpZ2h0Q29sb3I7CnZlYzQgZW1pc3NpdmVMZWZ0Q29sb3I7CnZlYzQgZW1pc3NpdmVSaWdodENvbG9yOwp2ZWMyIHZEaWZmdXNlSW5mb3M7CnZlYzIgdkFtYmllbnRJbmZvczsKdmVjMiB2T3BhY2l0eUluZm9zOwp2ZWMyIHZSZWZsZWN0aW9uSW5mb3M7CnZlYzMgdlJlZmxlY3Rpb25Qb3NpdGlvbjsKdmVjMyB2UmVmbGVjdGlvblNpemU7CnZlYzIgdkVtaXNzaXZlSW5mb3M7CnZlYzIgdkxpZ2h0bWFwSW5mb3M7CnZlYzIgdlNwZWN1bGFySW5mb3M7CnZlYzMgdkJ1bXBJbmZvczsKbWF0NCBkaWZmdXNlTWF0cml4OwptYXQ0IGFtYmllbnRNYXRyaXg7Cm1hdDQgb3BhY2l0eU1hdHJpeDsKbWF0NCByZWZsZWN0aW9uTWF0cml4OwptYXQ0IGVtaXNzaXZlTWF0cml4OwptYXQ0IGxpZ2h0bWFwTWF0cml4OwptYXQ0IHNwZWN1bGFyTWF0cml4OwptYXQ0IGJ1bXBNYXRyaXg7CnZlYzIgdlRhbmdlbnRTcGFjZVBhcmFtczsKZmxvYXQgcG9pbnRTaXplOwpmbG9hdCBhbHBoYUN1dE9mZjsKbWF0NCByZWZyYWN0aW9uTWF0cml4Owp2ZWM0IHZSZWZyYWN0aW9uSW5mb3M7CnZlYzMgdlJlZnJhY3Rpb25Qb3NpdGlvbjsKdmVjMyB2UmVmcmFjdGlvblNpemU7CnZlYzQgdlNwZWN1bGFyQ29sb3I7CnZlYzMgdkVtaXNzaXZlQ29sb3I7CnZlYzQgdkRpZmZ1c2VDb2xvcjsKdmVjMyB2QW1iaWVudENvbG9yOwojZGVmaW5lIEFERElUSU9OQUxfVUJPX0RFQ0xBUkFUSU9OCn07CiNpbmNsdWRlPHNjZW5lVWJvRGVjbGFyYXRpb24+CiNpbmNsdWRlPG1lc2hVYm9EZWNsYXJhdGlvbj4KYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2tvXT1Wbztjb25zdCBXbz0icHJlUGFzc0RlY2xhcmF0aW9uIix6bz1gI2lmZGVmIFBSRVBBU1MKI2V4dGVuc2lvbiBHTF9FWFRfZHJhd19idWZmZXJzIDogcmVxdWlyZQpsYXlvdXQobG9jYXRpb249MCkgb3V0IGhpZ2hwIHZlYzQgZ2xGcmFnRGF0YVt7WH1dO2hpZ2hwIHZlYzQgZ2xfRnJhZ0NvbG9yOwojaWZkZWYgUFJFUEFTU19ERVBUSAp2YXJ5aW5nIGhpZ2hwIHZlYzMgdlZpZXdQb3M7CiNlbmRpZgojaWZkZWYgUFJFUEFTU19WRUxPQ0lUWQp2YXJ5aW5nIGhpZ2hwIHZlYzQgdkN1cnJlbnRQb3NpdGlvbjt2YXJ5aW5nIGhpZ2hwIHZlYzQgdlByZXZpb3VzUG9zaXRpb247CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW1dvXT16bztjb25zdCBHbz0ib2l0RGVjbGFyYXRpb24iLFhvPWAjaWZkZWYgT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZCiNleHRlbnNpb24gR0xfRVhUX2RyYXdfYnVmZmVycyA6IHJlcXVpcmUKbGF5b3V0KGxvY2F0aW9uPTApIG91dCB2ZWMyIGRlcHRoOyAKbGF5b3V0KGxvY2F0aW9uPTEpIG91dCB2ZWM0IGZyb250Q29sb3I7CmxheW91dChsb2NhdGlvbj0yKSBvdXQgdmVjNCBiYWNrQ29sb3I7CiNkZWZpbmUgTUFYX0RFUFRIIDk5OTk5LjAKaGlnaHAgdmVjNCBnbF9GcmFnQ29sb3I7CnVuaWZvcm0gc2FtcGxlcjJEIG9pdERlcHRoU2FtcGxlcjsKdW5pZm9ybSBzYW1wbGVyMkQgb2l0RnJvbnRDb2xvclNhbXBsZXI7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbR29dPVhvO2NvbnN0IEhvPSJtYWluVVZWYXJ5aW5nRGVjbGFyYXRpb24iLEtvPWAjaWZkZWYgTUFJTlVWe1h9CnZhcnlpbmcgdmVjMiB2TWFpblVWe1h9OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0hvXT1Lbztjb25zdCBZbz0ibGlnaHRGcmFnbWVudERlY2xhcmF0aW9uIixabz1gI2lmZGVmIExJR0hUe1h9CnVuaWZvcm0gdmVjNCB2TGlnaHREYXRhe1h9Owp1bmlmb3JtIHZlYzQgdkxpZ2h0RGlmZnVzZXtYfTsKI2lmZGVmIFNQRUNVTEFSVEVSTQp1bmlmb3JtIHZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH07CiNlbHNlCnZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH09dmVjNCgwLik7CiNlbmRpZgojaWZkZWYgU0hBRE9Xe1h9CiNpZmRlZiBTSEFET1dDU017WH0KdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnVuaWZvcm0gZmxvYXQgdmlld0ZydXN0dW1ae1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnVuaWZvcm0gZmxvYXQgZnJ1c3R1bUxlbmd0aHN7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBjYXNjYWRlQmxlbmRGYWN0b3J7WH07CnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWN7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21DYW1lcmF7WH07CiNpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcntYfTsKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkRBcnJheSBkZXB0aFNhbXBsZXJ7WH07CnVuaWZvcm0gdmVjMiBsaWdodFNpemVVVkNvcnJlY3Rpb257WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBkZXB0aENvcnJlY3Rpb257WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBwZW51bWJyYURhcmtuZXNze1h9OwojZWxpZiBkZWZpbmVkKFNIQURPV1BDRntYfSkKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkRBcnJheVNoYWRvdyBzaGFkb3dTYW1wbGVye1h9OwojZWxzZQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyREFycmF5IHNoYWRvd1NhbXBsZXJ7WH07CiNlbmRpZgojaWZkZWYgU0hBRE9XQ1NNREVCVUd7WH0KY29uc3QgdmVjMyB2Q2FzY2FkZUNvbG9yc011bHRpcGxpZXJ7WH1bOF09dmVjM1s4XQooCnZlYzMgKCAxLjUsMC4wLDAuMCApLAp2ZWMzICggMC4wLDEuNSwwLjAgKSwKdmVjMyAoIDAuMCwwLjAsNS41ICksCnZlYzMgKCAxLjUsMC4wLDUuNSApLAp2ZWMzICggMS41LDEuNSwwLjAgKSwKdmVjMyAoIDEuMCwxLjAsMS4wICksCnZlYzMgKCAwLjAsMS4wLDUuNSApLAp2ZWMzICggMC41LDMuNSwwLjc1ICkKKTsKdmVjMyBzaGFkb3dEZWJ1Z3tYfTsKI2VuZGlmCiNpZmRlZiBTSEFET1dDU01VU0VTSEFET1dNQVhae1h9CmludCBpbmRleHtYfT0tMTsKI2Vsc2UKaW50IGluZGV4e1h9PVNIQURPV0NTTU5VTV9DQVNDQURFU3tYfS0xOwojZW5kaWYKZmxvYXQgZGlmZntYfT0wLjsKI2VsaWYgZGVmaW5lZChTSEFET1dDVUJFe1h9KQp1bmlmb3JtIHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXJ7WH07CiNlbHNlCnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9OwojaWYgZGVmaW5lZChTSEFET1dQQ1NTe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9Owp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBkZXB0aFNhbXBsZXJ7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9OwojZWxzZQp1bmlmb3JtIHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVye1h9OwojZW5kaWYKdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9OwojZW5kaWYKdW5pZm9ybSB2ZWM0IHNoYWRvd3NJbmZve1h9Owp1bmlmb3JtIHZlYzIgZGVwdGhWYWx1ZXN7WH07CiNlbmRpZgojaWZkZWYgU1BPVExJR0hUe1h9CnVuaWZvcm0gdmVjNCB2TGlnaHREaXJlY3Rpb257WH07CnVuaWZvcm0gdmVjNCB2TGlnaHRGYWxsb2Zme1h9OwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pCnVuaWZvcm0gdmVjNCB2TGlnaHRGYWxsb2Zme1h9OwojZWxpZiBkZWZpbmVkKEhFTUlMSUdIVHtYfSkKdW5pZm9ybSB2ZWMzIHZMaWdodEdyb3VuZHtYfTsKI2VuZGlmCiNpZmRlZiBQUk9KRUNURURMSUdIVFRFWFRVUkV7WH0KdW5pZm9ybSBtYXQ0IHRleHR1cmVQcm9qZWN0aW9uTWF0cml4e1h9Owp1bmlmb3JtIHNhbXBsZXIyRCBwcm9qZWN0aW9uTGlnaHRTYW1wbGVye1h9OwojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtZb109Wm87Y29uc3QgcW89ImxpZ2h0VWJvRGVjbGFyYXRpb24iLGpvPWAjaWZkZWYgTElHSFR7WH0KdW5pZm9ybSBMaWdodHtYfQp7CnZlYzQgdkxpZ2h0RGF0YTsKdmVjNCB2TGlnaHREaWZmdXNlOwp2ZWM0IHZMaWdodFNwZWN1bGFyOwojaWZkZWYgU1BPVExJR0hUe1h9CnZlYzQgdkxpZ2h0RGlyZWN0aW9uOwp2ZWM0IHZMaWdodEZhbGxvZmY7CiNlbGlmIGRlZmluZWQoUE9JTlRMSUdIVHtYfSkKdmVjNCB2TGlnaHRGYWxsb2ZmOwojZWxpZiBkZWZpbmVkKEhFTUlMSUdIVHtYfSkKdmVjMyB2TGlnaHRHcm91bmQ7CiNlbmRpZgp2ZWM0IHNoYWRvd3NJbmZvOwp2ZWMyIGRlcHRoVmFsdWVzOwp9IGxpZ2h0e1h9OwojaWZkZWYgUFJPSkVDVEVETElHSFRURVhUVVJFe1h9CnVuaWZvcm0gbWF0NCB0ZXh0dXJlUHJvamVjdGlvbk1hdHJpeHtYfTsKdW5pZm9ybSBzYW1wbGVyMkQgcHJvamVjdGlvbkxpZ2h0U2FtcGxlcntYfTsKI2VuZGlmCiNpZmRlZiBTSEFET1d7WH0KI2lmZGVmIFNIQURPV0NTTXtYfQp1bmlmb3JtIG1hdDQgbGlnaHRNYXRyaXh7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCB2aWV3RnJ1c3R1bVp7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdW5pZm9ybSBmbG9hdCBmcnVzdHVtTGVuZ3Roc3tYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp1bmlmb3JtIGZsb2F0IGNhc2NhZGVCbGVuZEZhY3RvcntYfTsKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21MaWdodHtYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp2YXJ5aW5nIGZsb2F0IHZEZXB0aE1ldHJpY3tYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp2YXJ5aW5nIHZlYzQgdlBvc2l0aW9uRnJvbUNhbWVyYXtYfTsKI2lmIGRlZmluZWQoU0hBRE9XUENTU3tYfSkKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkRBcnJheVNoYWRvdyBzaGFkb3dTYW1wbGVye1h9Owp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyREFycmF5IGRlcHRoU2FtcGxlcntYfTsKdW5pZm9ybSB2ZWMyIGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp1bmlmb3JtIGZsb2F0IGRlcHRoQ29ycmVjdGlvbntYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp1bmlmb3JtIGZsb2F0IHBlbnVtYnJhRGFya25lc3N7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyREFycmF5U2hhZG93IHNoYWRvd1NhbXBsZXJ7WH07CiNlbHNlCnVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEQXJyYXkgc2hhZG93U2FtcGxlcntYfTsKI2VuZGlmCiNpZmRlZiBTSEFET1dDU01ERUJVR3tYfQpjb25zdCB2ZWMzIHZDYXNjYWRlQ29sb3JzTXVsdGlwbGllcntYfVs4XT12ZWMzWzhdCigKdmVjMyAoIDEuNSwwLjAsMC4wICksCnZlYzMgKCAwLjAsMS41LDAuMCApLAp2ZWMzICggMC4wLDAuMCw1LjUgKSwKdmVjMyAoIDEuNSwwLjAsNS41ICksCnZlYzMgKCAxLjUsMS41LDAuMCApLAp2ZWMzICggMS4wLDEuMCwxLjAgKSwKdmVjMyAoIDAuMCwxLjAsNS41ICksCnZlYzMgKCAwLjUsMy41LDAuNzUgKQopOwp2ZWMzIHNoYWRvd0RlYnVne1h9OwojZW5kaWYKI2lmZGVmIFNIQURPV0NTTVVTRVNIQURPV01BWFp7WH0KaW50IGluZGV4e1h9PS0xOwojZWxzZQppbnQgaW5kZXh7WH09U0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9LTE7CiNlbmRpZgpmbG9hdCBkaWZme1h9PTAuOwojZWxpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCnVuaWZvcm0gc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcntYfTsgCiNlbHNlCnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9OwojaWYgZGVmaW5lZChTSEFET1dQQ1NTe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9Owp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRCBkZXB0aFNhbXBsZXJ7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQp1bmlmb3JtIGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVye1h9OwojZWxzZQp1bmlmb3JtIHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVye1h9OwojZW5kaWYKdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9OwojZW5kaWYKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbcW9dPWpvO2NvbnN0ICRvPSJsaWdodHNGcmFnbWVudEZ1bmN0aW9ucyIsUW89YHN0cnVjdCBsaWdodGluZ0luZm8Kewp2ZWMzIGRpZmZ1c2U7CiNpZmRlZiBTUEVDVUxBUlRFUk0KdmVjMyBzcGVjdWxhcjsKI2VuZGlmCiNpZmRlZiBORE9UTApmbG9hdCBuZGw7CiNlbmRpZgp9OwpsaWdodGluZ0luZm8gY29tcHV0ZUxpZ2h0aW5nKHZlYzMgdmlld0RpcmVjdGlvblcsdmVjMyB2Tm9ybWFsLHZlYzQgbGlnaHREYXRhLHZlYzMgZGlmZnVzZUNvbG9yLHZlYzMgc3BlY3VsYXJDb2xvcixmbG9hdCByYW5nZSxmbG9hdCBnbG9zc2luZXNzKSB7CmxpZ2h0aW5nSW5mbyByZXN1bHQ7CnZlYzMgbGlnaHRWZWN0b3JXOwpmbG9hdCBhdHRlbnVhdGlvbj0xLjA7CmlmIChsaWdodERhdGEudz09MC4pCnsKdmVjMyBkaXJlY3Rpb249bGlnaHREYXRhLnh5ei12UG9zaXRpb25XOwphdHRlbnVhdGlvbj1tYXgoMC4sMS4wLWxlbmd0aChkaXJlY3Rpb24pL3JhbmdlKTsKbGlnaHRWZWN0b3JXPW5vcm1hbGl6ZShkaXJlY3Rpb24pOwp9CmVsc2UKewpsaWdodFZlY3Rvclc9bm9ybWFsaXplKC1saWdodERhdGEueHl6KTsKfQpmbG9hdCBuZGw9bWF4KDAuLGRvdCh2Tm9ybWFsLGxpZ2h0VmVjdG9yVykpOwojaWZkZWYgTkRPVEwKcmVzdWx0Lm5kbD1uZGw7CiNlbmRpZgpyZXN1bHQuZGlmZnVzZT1uZGwqZGlmZnVzZUNvbG9yKmF0dGVudWF0aW9uOwojaWZkZWYgU1BFQ1VMQVJURVJNCnZlYzMgYW5nbGVXPW5vcm1hbGl6ZSh2aWV3RGlyZWN0aW9uVytsaWdodFZlY3RvclcpOwpmbG9hdCBzcGVjQ29tcD1tYXgoMC4sZG90KHZOb3JtYWwsYW5nbGVXKSk7CnNwZWNDb21wPXBvdyhzcGVjQ29tcCxtYXgoMS4sZ2xvc3NpbmVzcykpOwpyZXN1bHQuc3BlY3VsYXI9c3BlY0NvbXAqc3BlY3VsYXJDb2xvciphdHRlbnVhdGlvbjsKI2VuZGlmCnJldHVybiByZXN1bHQ7Cn0KbGlnaHRpbmdJbmZvIGNvbXB1dGVTcG90TGlnaHRpbmcodmVjMyB2aWV3RGlyZWN0aW9uVyx2ZWMzIHZOb3JtYWwsdmVjNCBsaWdodERhdGEsdmVjNCBsaWdodERpcmVjdGlvbix2ZWMzIGRpZmZ1c2VDb2xvcix2ZWMzIHNwZWN1bGFyQ29sb3IsZmxvYXQgcmFuZ2UsZmxvYXQgZ2xvc3NpbmVzcykgewpsaWdodGluZ0luZm8gcmVzdWx0Owp2ZWMzIGRpcmVjdGlvbj1saWdodERhdGEueHl6LXZQb3NpdGlvblc7CnZlYzMgbGlnaHRWZWN0b3JXPW5vcm1hbGl6ZShkaXJlY3Rpb24pOwpmbG9hdCBhdHRlbnVhdGlvbj1tYXgoMC4sMS4wLWxlbmd0aChkaXJlY3Rpb24pL3JhbmdlKTsKZmxvYXQgY29zQW5nbGU9bWF4KDAuLGRvdChsaWdodERpcmVjdGlvbi54eXosLWxpZ2h0VmVjdG9yVykpOwppZiAoY29zQW5nbGU+PWxpZ2h0RGlyZWN0aW9uLncpCnsKY29zQW5nbGU9bWF4KDAuLHBvdyhjb3NBbmdsZSxsaWdodERhdGEudykpOwphdHRlbnVhdGlvbio9Y29zQW5nbGU7CmZsb2F0IG5kbD1tYXgoMC4sZG90KHZOb3JtYWwsbGlnaHRWZWN0b3JXKSk7CiNpZmRlZiBORE9UTApyZXN1bHQubmRsPW5kbDsKI2VuZGlmCnJlc3VsdC5kaWZmdXNlPW5kbCpkaWZmdXNlQ29sb3IqYXR0ZW51YXRpb247CiNpZmRlZiBTUEVDVUxBUlRFUk0KdmVjMyBhbmdsZVc9bm9ybWFsaXplKHZpZXdEaXJlY3Rpb25XK2xpZ2h0VmVjdG9yVyk7CmZsb2F0IHNwZWNDb21wPW1heCgwLixkb3Qodk5vcm1hbCxhbmdsZVcpKTsKc3BlY0NvbXA9cG93KHNwZWNDb21wLG1heCgxLixnbG9zc2luZXNzKSk7CnJlc3VsdC5zcGVjdWxhcj1zcGVjQ29tcCpzcGVjdWxhckNvbG9yKmF0dGVudWF0aW9uOwojZW5kaWYKcmV0dXJuIHJlc3VsdDsKfQpyZXN1bHQuZGlmZnVzZT12ZWMzKDAuKTsKI2lmZGVmIFNQRUNVTEFSVEVSTQpyZXN1bHQuc3BlY3VsYXI9dmVjMygwLik7CiNlbmRpZgojaWZkZWYgTkRPVEwKcmVzdWx0Lm5kbD0wLjsKI2VuZGlmCnJldHVybiByZXN1bHQ7Cn0KbGlnaHRpbmdJbmZvIGNvbXB1dGVIZW1pc3BoZXJpY0xpZ2h0aW5nKHZlYzMgdmlld0RpcmVjdGlvblcsdmVjMyB2Tm9ybWFsLHZlYzQgbGlnaHREYXRhLHZlYzMgZGlmZnVzZUNvbG9yLHZlYzMgc3BlY3VsYXJDb2xvcix2ZWMzIGdyb3VuZENvbG9yLGZsb2F0IGdsb3NzaW5lc3MpIHsKbGlnaHRpbmdJbmZvIHJlc3VsdDsKZmxvYXQgbmRsPWRvdCh2Tm9ybWFsLGxpZ2h0RGF0YS54eXopKjAuNSswLjU7CiNpZmRlZiBORE9UTApyZXN1bHQubmRsPW5kbDsKI2VuZGlmCnJlc3VsdC5kaWZmdXNlPW1peChncm91bmRDb2xvcixkaWZmdXNlQ29sb3IsbmRsKTsKI2lmZGVmIFNQRUNVTEFSVEVSTQp2ZWMzIGFuZ2xlVz1ub3JtYWxpemUodmlld0RpcmVjdGlvblcrbGlnaHREYXRhLnh5eik7CmZsb2F0IHNwZWNDb21wPW1heCgwLixkb3Qodk5vcm1hbCxhbmdsZVcpKTsKc3BlY0NvbXA9cG93KHNwZWNDb21wLG1heCgxLixnbG9zc2luZXNzKSk7CnJlc3VsdC5zcGVjdWxhcj1zcGVjQ29tcCpzcGVjdWxhckNvbG9yOwojZW5kaWYKcmV0dXJuIHJlc3VsdDsKfQojZGVmaW5lIGlubGluZQp2ZWMzIGNvbXB1dGVQcm9qZWN0aW9uVGV4dHVyZURpZmZ1c2VMaWdodGluZyhzYW1wbGVyMkQgcHJvamVjdGlvbkxpZ2h0U2FtcGxlcixtYXQ0IHRleHR1cmVQcm9qZWN0aW9uTWF0cml4KXsKdmVjNCBzdHJxPXRleHR1cmVQcm9qZWN0aW9uTWF0cml4KnZlYzQodlBvc2l0aW9uVywxLjApOwpzdHJxLz1zdHJxLnc7CnZlYzMgdGV4dHVyZUNvbG9yPXRleHR1cmUyRChwcm9qZWN0aW9uTGlnaHRTYW1wbGVyLHN0cnEueHkpLnJnYjsKcmV0dXJuIHRleHR1cmVDb2xvcjsKfWA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVskb109UW87Y29uc3QgSm89InNoYWRvd3NGcmFnbWVudEZ1bmN0aW9ucyIsZWg9YCNpZmRlZiBTSEFET1dTCiNpZiBkZWZpbmVkKFdFQkdMMikgfHwgZGVmaW5lZChXRUJHUFUpIHx8IGRlZmluZWQoTkFUSVZFKQojZGVmaW5lIFRFWFRVUkVGVU5DKHMsYyxsKSB0ZXh0dXJlMkRMb2RFWFQocyxjLGwpCiNlbHNlCiNkZWZpbmUgVEVYVFVSRUZVTkMocyxjLGIpIHRleHR1cmUyRChzLGMsYikKI2VuZGlmCiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgdW5wYWNrKHZlYzQgY29sb3IpCnsKY29uc3QgdmVjNCBiaXRfc2hpZnQ9dmVjNCgxLjAvKDI1NS4wKjI1NS4wKjI1NS4wKSwxLjAvKDI1NS4wKjI1NS4wKSwxLjAvMjU1LjAsMS4wKTsKcmV0dXJuIGRvdChjb2xvcixiaXRfc2hpZnQpOwp9CiNlbmRpZgpmbG9hdCBjb21wdXRlRmFsbE9mZihmbG9hdCB2YWx1ZSx2ZWMyIGNsaXBTcGFjZSxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKZmxvYXQgbWFzaz1zbW9vdGhzdGVwKDEuMC1mcnVzdHVtRWRnZUZhbGxvZmYsMS4wMDAwMDAxMixjbGFtcChkb3QoY2xpcFNwYWNlLGNsaXBTcGFjZSksMC4sMS4pKTsKcmV0dXJuIG1peCh2YWx1ZSwxLjAsbWFzayk7Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd0N1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsdmVjMiBkZXB0aFZhbHVlcykKewp2ZWMzIGRpcmVjdGlvblRvTGlnaHQ9dlBvc2l0aW9uVy1saWdodFBvc2l0aW9uOwpmbG9hdCBkZXB0aD1sZW5ndGgoZGlyZWN0aW9uVG9MaWdodCk7CmRlcHRoPShkZXB0aCtkZXB0aFZhbHVlcy54KS8oZGVwdGhWYWx1ZXMueSk7CmRlcHRoPWNsYW1wKGRlcHRoLDAuLDEuMCk7CmRpcmVjdGlvblRvTGlnaHQ9bm9ybWFsaXplKGRpcmVjdGlvblRvTGlnaHQpOwpkaXJlY3Rpb25Ub0xpZ2h0Lnk9LWRpcmVjdGlvblRvTGlnaHQueTsKI2lmbmRlZiBTSEFET1dGTE9BVApmbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkpOwojZWxzZQpmbG9hdCBzaGFkb3c9dGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0KS54OwojZW5kaWYKcmV0dXJuIGRlcHRoPnNoYWRvdyA/IGRhcmtuZXNzIDogMS4wOwp9CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoUG9pc3NvblNhbXBsaW5nQ3ViZSh2ZWMzIGxpZ2h0UG9zaXRpb24sc2FtcGxlckN1YmUgc2hhZG93U2FtcGxlcixmbG9hdCBtYXBTaXplLGZsb2F0IGRhcmtuZXNzLHZlYzIgZGVwdGhWYWx1ZXMpCnsKdmVjMyBkaXJlY3Rpb25Ub0xpZ2h0PXZQb3NpdGlvblctbGlnaHRQb3NpdGlvbjsKZmxvYXQgZGVwdGg9bGVuZ3RoKGRpcmVjdGlvblRvTGlnaHQpOwpkZXB0aD0oZGVwdGgrZGVwdGhWYWx1ZXMueCkvKGRlcHRoVmFsdWVzLnkpOwpkZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApOwpkaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTsKZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7CmZsb2F0IHZpc2liaWxpdHk9MS47CnZlYzMgcG9pc3NvbkRpc2tbNF07CnBvaXNzb25EaXNrWzBdPXZlYzMoLTEuMCwxLjAsLTEuMCk7CnBvaXNzb25EaXNrWzFdPXZlYzMoMS4wLC0xLjAsLTEuMCk7CnBvaXNzb25EaXNrWzJdPXZlYzMoLTEuMCwtMS4wLC0xLjApOwpwb2lzc29uRGlza1szXT12ZWMzKDEuMCwtMS4wLDEuMCk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKaWYgKHVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbMF0qbWFwU2l6ZSkpPGRlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAodW5wYWNrKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1sxXSptYXBTaXplKSk8ZGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmICh1bnBhY2sodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzJdKm1hcFNpemUpKTxkZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKHVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbM10qbWFwU2l6ZSkpPGRlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwojZWxzZQppZiAodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzBdKm1hcFNpemUpLng8ZGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmICh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQrcG9pc3NvbkRpc2tbMV0qbWFwU2l6ZSkueDxkZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKHRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCtwb2lzc29uRGlza1syXSptYXBTaXplKS54PGRlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAodGV4dHVyZUN1YmUoc2hhZG93U2FtcGxlcixkaXJlY3Rpb25Ub0xpZ2h0K3BvaXNzb25EaXNrWzNdKm1hcFNpemUpLng8ZGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CiNlbmRpZgpyZXR1cm4gbWluKDEuMCx2aXNpYmlsaXR5K2RhcmtuZXNzKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aEVTTUN1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZGVwdGhTY2FsZSx2ZWMyIGRlcHRoVmFsdWVzKQp7CnZlYzMgZGlyZWN0aW9uVG9MaWdodD12UG9zaXRpb25XLWxpZ2h0UG9zaXRpb247CmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTsKZGVwdGg9KGRlcHRoK2RlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55KTsKZmxvYXQgc2hhZG93UGl4ZWxEZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApOwpkaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTsKZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQpKTsKI2Vsc2UKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkueDsKI2VuZGlmCmZsb2F0IGVzbT0xLjAtY2xhbXAoZXhwKG1pbig4Ny4sZGVwdGhTY2FsZSpzaGFkb3dQaXhlbERlcHRoKSkqc2hhZG93TWFwU2FtcGxlLDAuLDEuLWRhcmtuZXNzKTsgCnJldHVybiBlc207Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDbG9zZUVTTUN1YmUodmVjMyBsaWdodFBvc2l0aW9uLHNhbXBsZXJDdWJlIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZGVwdGhTY2FsZSx2ZWMyIGRlcHRoVmFsdWVzKQp7CnZlYzMgZGlyZWN0aW9uVG9MaWdodD12UG9zaXRpb25XLWxpZ2h0UG9zaXRpb247CmZsb2F0IGRlcHRoPWxlbmd0aChkaXJlY3Rpb25Ub0xpZ2h0KTsKZGVwdGg9KGRlcHRoK2RlcHRoVmFsdWVzLngpLyhkZXB0aFZhbHVlcy55KTsKZmxvYXQgc2hhZG93UGl4ZWxEZXB0aD1jbGFtcChkZXB0aCwwLiwxLjApOwpkaXJlY3Rpb25Ub0xpZ2h0PW5vcm1hbGl6ZShkaXJlY3Rpb25Ub0xpZ2h0KTsKZGlyZWN0aW9uVG9MaWdodC55PS1kaXJlY3Rpb25Ub0xpZ2h0Lnk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayh0ZXh0dXJlQ3ViZShzaGFkb3dTYW1wbGVyLGRpcmVjdGlvblRvTGlnaHQpKTsKI2Vsc2UKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXRleHR1cmVDdWJlKHNoYWRvd1NhbXBsZXIsZGlyZWN0aW9uVG9MaWdodCkueDsKI2VuZGlmCmZsb2F0IGVzbT1jbGFtcChleHAobWluKDg3LiwtZGVwdGhTY2FsZSooc2hhZG93UGl4ZWxEZXB0aC1zaGFkb3dNYXBTYW1wbGUpKSksZGFya25lc3MsMS4pOwpyZXR1cm4gZXNtOwp9CiNpZiBkZWZpbmVkKFdFQkdMMikgfHwgZGVmaW5lZChXRUJHUFUpIHx8IGRlZmluZWQoTkFUSVZFKQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93Q1NNKGZsb2F0IGxheWVyLHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyREFycmF5IHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzIgdXY9MC41KmNsaXBTcGFjZS54eSt2ZWMyKDAuNSk7CnZlYzMgdXZMYXllcj12ZWMzKHV2LngsdXYueSxsYXllcik7CmZsb2F0IHNoYWRvd1BpeGVsRGVwdGg9Y2xhbXAoZGVwdGhNZXRyaWMsMC4sMS4wKTsKI2lmbmRlZiBTSEFET1dGTE9BVApmbG9hdCBzaGFkb3c9dW5wYWNrKHRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2TGF5ZXIpKTsKI2Vsc2UKZmxvYXQgc2hhZG93PXRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2TGF5ZXIpLng7CiNlbmRpZgpyZXR1cm4gc2hhZG93UGl4ZWxEZXB0aD5zaGFkb3cgPyBjb21wdXRlRmFsbE9mZihkYXJrbmVzcyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKSA6IDEuOwp9CiNlbmRpZgojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93KHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLHNhbXBsZXIyRCBzaGFkb3dTYW1wbGVyLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMyIHV2PTAuNSpjbGlwU3BhY2UueHkrdmVjMigwLjUpOwppZiAodXYueDwwLiB8fCB1di54PjEuMCB8fCB1di55PDAuIHx8IHV2Lnk+MS4wKQp7CnJldHVybiAxLjA7Cn0KZWxzZQp7CmZsb2F0IHNoYWRvd1BpeGVsRGVwdGg9Y2xhbXAoZGVwdGhNZXRyaWMsMC4sMS4wKTsKI2lmbmRlZiBTSEFET1dGTE9BVApmbG9hdCBzaGFkb3c9dW5wYWNrKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYsMC4pKTsKI2Vsc2UKZmxvYXQgc2hhZG93PVRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYsMC4pLng7CiNlbmRpZgpyZXR1cm4gc2hhZG93UGl4ZWxEZXB0aD5zaGFkb3cgPyBjb21wdXRlRmFsbE9mZihkYXJrbmVzcyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKSA6IDEuOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQb2lzc29uU2FtcGxpbmcodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsc2FtcGxlcjJEIHNoYWRvd1NhbXBsZXIsZmxvYXQgbWFwU2l6ZSxmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMiB1dj0wLjUqY2xpcFNwYWNlLnh5K3ZlYzIoMC41KTsKaWYgKHV2Lng8MC4gfHwgdXYueD4xLjAgfHwgdXYueTwwLiB8fCB1di55PjEuMCkKewpyZXR1cm4gMS4wOwp9CmVsc2UKewpmbG9hdCBzaGFkb3dQaXhlbERlcHRoPWNsYW1wKGRlcHRoTWV0cmljLDAuLDEuMCk7CmZsb2F0IHZpc2liaWxpdHk9MS47CnZlYzIgcG9pc3NvbkRpc2tbNF07CnBvaXNzb25EaXNrWzBdPXZlYzIoLTAuOTQyMDE2MjQsLTAuMzk5MDYyMTYpOwpwb2lzc29uRGlza1sxXT12ZWMyKDAuOTQ1NTg2MDksLTAuNzY4OTA3MjUpOwpwb2lzc29uRGlza1syXT12ZWMyKC0wLjA5NDE4NDEwMSwtMC45MjkzODg3MCk7CnBvaXNzb25EaXNrWzNdPXZlYzIoMC4zNDQ5NTkzOCwwLjI5Mzg3NzYwKTsKI2lmbmRlZiBTSEFET1dGTE9BVAppZiAodW5wYWNrKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMF0qbWFwU2l6ZSwwLikpPHNoYWRvd1BpeGVsRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmICh1bnBhY2soVEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1ditwb2lzc29uRGlza1sxXSptYXBTaXplLDAuKSk8c2hhZG93UGl4ZWxEZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKHVucGFjayhURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzJdKm1hcFNpemUsMC4pKTxzaGFkb3dQaXhlbERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAodW5wYWNrKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbM10qbWFwU2l6ZSwwLikpPHNoYWRvd1BpeGVsRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CiNlbHNlCmlmIChURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzBdKm1hcFNpemUsMC4pLng8c2hhZG93UGl4ZWxEZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKaWYgKFRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdXYrcG9pc3NvbkRpc2tbMV0qbWFwU2l6ZSwwLikueDxzaGFkb3dQaXhlbERlcHRoKSB2aXNpYmlsaXR5LT0wLjI1OwppZiAoVEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1ditwb2lzc29uRGlza1syXSptYXBTaXplLDAuKS54PHNoYWRvd1BpeGVsRGVwdGgpIHZpc2liaWxpdHktPTAuMjU7CmlmIChURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2K3BvaXNzb25EaXNrWzNdKm1hcFNpemUsMC4pLng8c2hhZG93UGl4ZWxEZXB0aCkgdmlzaWJpbGl0eS09MC4yNTsKI2VuZGlmCnJldHVybiBjb21wdXRlRmFsbE9mZihtaW4oMS4wLHZpc2liaWxpdHkrZGFya25lc3MpLGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhFU00odmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsc2FtcGxlcjJEIHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZGVwdGhTY2FsZSxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMiB1dj0wLjUqY2xpcFNwYWNlLnh5K3ZlYzIoMC41KTsKaWYgKHV2Lng8MC4gfHwgdXYueD4xLjAgfHwgdXYueTwwLiB8fCB1di55PjEuMCkKewpyZXR1cm4gMS4wOwp9CmVsc2UKewpmbG9hdCBzaGFkb3dQaXhlbERlcHRoPWNsYW1wKGRlcHRoTWV0cmljLDAuLDEuMCk7CiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayhURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKSk7CiNlbHNlCmZsb2F0IHNoYWRvd01hcFNhbXBsZT1URVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKS54OwojZW5kaWYKZmxvYXQgZXNtPTEuMC1jbGFtcChleHAobWluKDg3LixkZXB0aFNjYWxlKnNoYWRvd1BpeGVsRGVwdGgpKSpzaGFkb3dNYXBTYW1wbGUsMC4sMS4tZGFya25lc3MpOwpyZXR1cm4gY29tcHV0ZUZhbGxPZmYoZXNtLGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDbG9zZUVTTSh2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxzYW1wbGVyMkQgc2hhZG93U2FtcGxlcixmbG9hdCBkYXJrbmVzcyxmbG9hdCBkZXB0aFNjYWxlLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMyIHV2PTAuNSpjbGlwU3BhY2UueHkrdmVjMigwLjUpOwppZiAodXYueDwwLiB8fCB1di54PjEuMCB8fCB1di55PDAuIHx8IHV2Lnk+MS4wKQp7CnJldHVybiAxLjA7Cn0KZWxzZQp7CmZsb2F0IHNoYWRvd1BpeGVsRGVwdGg9Y2xhbXAoZGVwdGhNZXRyaWMsMC4sMS4wKTsgCiNpZm5kZWYgU0hBRE9XRkxPQVQKZmxvYXQgc2hhZG93TWFwU2FtcGxlPXVucGFjayhURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKSk7CiNlbHNlCmZsb2F0IHNoYWRvd01hcFNhbXBsZT1URVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHV2LDAuKS54OwojZW5kaWYKZmxvYXQgZXNtPWNsYW1wKGV4cChtaW4oODcuLC1kZXB0aFNjYWxlKihzaGFkb3dQaXhlbERlcHRoLXNoYWRvd01hcFNhbXBsZSkpKSxkYXJrbmVzcywxLik7CnJldHVybiBjb21wdXRlRmFsbE9mZihlc20sY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQojaWZkZWYgSVNfTkRDX0hBTEZfWlJBTkdFCiNkZWZpbmUgWklOQ0xJUCBjbGlwU3BhY2UuegojZWxzZQojZGVmaW5lIFpJTkNMSVAgdXZEZXB0aC56CiNlbmRpZgojaWYgZGVmaW5lZChXRUJHTDIpIHx8IGRlZmluZWQoV0VCR1BVKSB8fCBkZWZpbmVkKE5BVElWRSkKI2RlZmluZSBHUkVBVEVTVF9MRVNTX1RIQU5fT05FIDAuOTk5OTk5OTQKI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDU01QQ0YxKGZsb2F0IGxheWVyLHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyREFycmF5U2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1jbGFtcChaSU5DTElQLDAuLEdSRUFURVNUX0xFU1NfVEhBTl9PTkUpOwp2ZWM0IHV2RGVwdGhMYXllcj12ZWM0KHV2RGVwdGgueCx1dkRlcHRoLnksbGF5ZXIsdXZEZXB0aC56KTsKZmxvYXQgc2hhZG93PXRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHV2RGVwdGhMYXllcik7CnNoYWRvdz1taXgoZGFya25lc3MsMS4sc2hhZG93KTsKcmV0dXJuIGNvbXB1dGVGYWxsT2ZmKHNoYWRvdyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aENTTVBDRjMoZmxvYXQgbGF5ZXIsdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcix2ZWMyIHNoYWRvd01hcFNpemVBbmRJbnZlcnNlLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMzIHV2RGVwdGg9dmVjMygwLjUqY2xpcFNwYWNlLnh5eit2ZWMzKDAuNSkpOwp1dkRlcHRoLno9Y2xhbXAoWklOQ0xJUCwwLixHUkVBVEVTVF9MRVNTX1RIQU5fT05FKTsKdmVjMiB1dj11dkRlcHRoLnh5KnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLng7IAp1dis9MC41OyAKdmVjMiBzdD1mcmFjdCh1dik7IAp2ZWMyIGJhc2VfdXY9Zmxvb3IodXYpLTAuNTsgCmJhc2VfdXYqPXNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7IAp2ZWMyIHV2dzA9My4tMi4qc3Q7CnZlYzIgdXZ3MT0xLisyLipzdDsKdmVjMiB1PXZlYzIoKDIuLXN0LngpL3V2dzAueC0xLixzdC54L3V2dzEueCsxLikqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsKdmVjMiB2PXZlYzIoKDIuLXN0LnkpL3V2dzAueS0xLixzdC55L3V2dzEueSsxLikqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsKZmxvYXQgc2hhZG93PTAuOwpzaGFkb3crPXV2dzAueCp1dncwLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzBdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3MC55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlswXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3MC54KnV2dzEueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzBdLHZbMV0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3crPXV2dzEueCp1dncxLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzFdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93PXNoYWRvdy8xNi47CnNoYWRvdz1taXgoZGFya25lc3MsMS4sc2hhZG93KTsKcmV0dXJuIGNvbXB1dGVGYWxsT2ZmKHNoYWRvdyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aENTTVBDRjUoZmxvYXQgbGF5ZXIsdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcix2ZWMyIHNoYWRvd01hcFNpemVBbmRJbnZlcnNlLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewp2ZWMzIGNsaXBTcGFjZT12UG9zaXRpb25Gcm9tTGlnaHQueHl6L3ZQb3NpdGlvbkZyb21MaWdodC53Owp2ZWMzIHV2RGVwdGg9dmVjMygwLjUqY2xpcFNwYWNlLnh5eit2ZWMzKDAuNSkpOwp1dkRlcHRoLno9Y2xhbXAoWklOQ0xJUCwwLixHUkVBVEVTVF9MRVNTX1RIQU5fT05FKTsKdmVjMiB1dj11dkRlcHRoLnh5KnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLng7IAp1dis9MC41OyAKdmVjMiBzdD1mcmFjdCh1dik7IAp2ZWMyIGJhc2VfdXY9Zmxvb3IodXYpLTAuNTsgCmJhc2VfdXYqPXNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7IAp2ZWMyIHV2dzA9NC4tMy4qc3Q7CnZlYzIgdXZ3MT12ZWMyKDcuKTsKdmVjMiB1dncyPTEuKzMuKnN0Owp2ZWMzIHU9dmVjMygoMy4tMi4qc3QueCkvdXZ3MC54LTIuLCgzLitzdC54KS91dncxLngsc3QueC91dncyLngrMi4pKnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7CnZlYzMgdj12ZWMzKCgzLi0yLipzdC55KS91dncwLnktMi4sKDMuK3N0LnkpL3V2dzEueSxzdC55L3V2dzIueSsyLikqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsKZmxvYXQgc2hhZG93PTAuOwpzaGFkb3crPXV2dzAueCp1dncwLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzBdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3MC55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlswXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3Mi54KnV2dzAueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzJdLHZbMF0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3crPXV2dzAueCp1dncxLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzFdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3MS55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlsxXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3Mi54KnV2dzEueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzJdLHZbMV0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3crPXV2dzAueCp1dncyLnkqdGV4dHVyZTJEKHNoYWRvd1NhbXBsZXIsdmVjNChiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzJdKSxsYXllcix1dkRlcHRoLnopKTsKc2hhZG93Kz11dncxLngqdXZ3Mi55KnRleHR1cmUyRChzaGFkb3dTYW1wbGVyLHZlYzQoYmFzZV91di54eSt2ZWMyKHVbMV0sdlsyXSksbGF5ZXIsdXZEZXB0aC56KSk7CnNoYWRvdys9dXZ3Mi54KnV2dzIueSp0ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix2ZWM0KGJhc2VfdXYueHkrdmVjMih1WzJdLHZbMl0pLGxheWVyLHV2RGVwdGgueikpOwpzaGFkb3c9c2hhZG93LzE0NC47CnNoYWRvdz1taXgoZGFya25lc3MsMS4sc2hhZG93KTsKcmV0dXJuIGNvbXB1dGVGYWxsT2ZmKHNoYWRvdyxjbGlwU3BhY2UueHksZnJ1c3R1bUVkZ2VGYWxsb2ZmKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDRjEodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CmlmIChkZXB0aE1ldHJpYz4xLjAgfHwgZGVwdGhNZXRyaWM8MC4wKSB7CnJldHVybiAxLjA7Cn0KZWxzZQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1aSU5DTElQOwpmbG9hdCBzaGFkb3c9VEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1dkRlcHRoLDAuKTsKc2hhZG93PW1peChkYXJrbmVzcywxLixzaGFkb3cpOwpyZXR1cm4gY29tcHV0ZUZhbGxPZmYoc2hhZG93LGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ0YzKHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVyLHZlYzIgc2hhZG93TWFwU2l6ZUFuZEludmVyc2UsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CmlmIChkZXB0aE1ldHJpYz4xLjAgfHwgZGVwdGhNZXRyaWM8MC4wKSB7CnJldHVybiAxLjA7Cn0KZWxzZQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1aSU5DTElQOwp2ZWMyIHV2PXV2RGVwdGgueHkqc2hhZG93TWFwU2l6ZUFuZEludmVyc2UueDsgCnV2Kz0wLjU7IAp2ZWMyIHN0PWZyYWN0KHV2KTsgCnZlYzIgYmFzZV91dj1mbG9vcih1diktMC41OyAKYmFzZV91dio9c2hhZG93TWFwU2l6ZUFuZEludmVyc2UueTsgCnZlYzIgdXZ3MD0zLi0yLipzdDsKdmVjMiB1dncxPTEuKzIuKnN0Owp2ZWMyIHU9dmVjMigoMi4tc3QueCkvdXZ3MC54LTEuLHN0LngvdXZ3MS54KzEuKSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55Owp2ZWMyIHY9dmVjMigoMi4tc3QueSkvdXZ3MC55LTEuLHN0LnkvdXZ3MS55KzEuKSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55OwpmbG9hdCBzaGFkb3c9MC47CnNoYWRvdys9dXZ3MC54KnV2dzAueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMF0sdlswXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdys9dXZ3MS54KnV2dzAueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMV0sdlswXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdys9dXZ3MC54KnV2dzEueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMF0sdlsxXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdys9dXZ3MS54KnV2dzEueSpURVhUVVJFRlVOQyhzaGFkb3dTYW1wbGVyLHZlYzMoYmFzZV91di54eSt2ZWMyKHVbMV0sdlsxXSksdXZEZXB0aC56KSwwLik7CnNoYWRvdz1zaGFkb3cvMTYuOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CnJldHVybiBjb21wdXRlRmFsbE9mZihzaGFkb3csY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDRjUodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsdmVjMiBzaGFkb3dNYXBTaXplQW5kSW52ZXJzZSxmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKaWYgKGRlcHRoTWV0cmljPjEuMCB8fCBkZXB0aE1ldHJpYzwwLjApIHsKcmV0dXJuIDEuMDsKfQplbHNlCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMyB1dkRlcHRoPXZlYzMoMC41KmNsaXBTcGFjZS54eXordmVjMygwLjUpKTsKdXZEZXB0aC56PVpJTkNMSVA7CnZlYzIgdXY9dXZEZXB0aC54eSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS54OyAKdXYrPTAuNTsgCnZlYzIgc3Q9ZnJhY3QodXYpOyAKdmVjMiBiYXNlX3V2PWZsb29yKHV2KS0wLjU7IApiYXNlX3V2Kj1zaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55OyAKdmVjMiB1dncwPTQuLTMuKnN0Owp2ZWMyIHV2dzE9dmVjMig3Lik7CnZlYzIgdXZ3Mj0xLiszLipzdDsKdmVjMyB1PXZlYzMoKDMuLTIuKnN0LngpL3V2dzAueC0yLiwoMy4rc3QueCkvdXZ3MS54LHN0LngvdXZ3Mi54KzIuKSpzaGFkb3dNYXBTaXplQW5kSW52ZXJzZS55Owp2ZWMzIHY9dmVjMygoMy4tMi4qc3QueSkvdXZ3MC55LTIuLCgzLitzdC55KS91dncxLnksc3QueS91dncyLnkrMi4pKnNoYWRvd01hcFNpemVBbmRJbnZlcnNlLnk7CmZsb2F0IHNoYWRvdz0wLjsKc2hhZG93Kz11dncwLngqdXZ3MC55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzBdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncxLngqdXZ3MC55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzBdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncyLngqdXZ3MC55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsyXSx2WzBdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncwLngqdXZ3MS55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzFdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncxLngqdXZ3MS55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzFdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncyLngqdXZ3MS55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsyXSx2WzFdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncwLngqdXZ3Mi55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVswXSx2WzJdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncxLngqdXZ3Mi55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsxXSx2WzJdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93Kz11dncyLngqdXZ3Mi55KlRFWFRVUkVGVU5DKHNoYWRvd1NhbXBsZXIsdmVjMyhiYXNlX3V2Lnh5K3ZlYzIodVsyXSx2WzJdKSx1dkRlcHRoLnopLDAuKTsKc2hhZG93PXNoYWRvdy8xNDQuOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CnJldHVybiBjb21wdXRlRmFsbE9mZihzaGFkb3csY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQpjb25zdCB2ZWMzIFBvaXNzb25TYW1wbGVyczMyWzY0XT12ZWMzWzY0XSgKdmVjMygwLjA2NDA3MDEzLDAuMDU0MDk5MjcsMC4pLAp2ZWMzKDAuNzM2NjU3NywwLjU3ODkzOTQsMC4pLAp2ZWMzKC0wLjYyNzA1NDIsLTAuNTMyMDI3OCwwLiksCnZlYzMoLTAuNDA5NjEwNywwLjg0MTEwOTUsMC4pLAp2ZWMzKDAuNjg0OTU2NCwtMC40OTkwODE4LDAuKSwKdmVjMygtMC44NzQxODEsLTAuMDQ1Nzk3MzUsMC4pLAp2ZWMzKDAuOTk4OTk5OCwwLjAwMDk4ODAwNjYsMC4pLAp2ZWMzKC0wLjAwNDkyMDU3OCwtMC45MTUxNjQ5LDAuKSwKdmVjMygwLjE4MDU3NjMsMC45NzQ3NDgzLDAuKSwKdmVjMygtMC4yMTM4NDUxLDAuMjYzNTgxOCwwLiksCnZlYzMoMC4xMDk4NDUsMC4zODg0Nzg1LDAuKSwKdmVjMygwLjA2ODc2NzU1LC0wLjM1ODEwNzQsMC4pLAp2ZWMzKDAuMzc0MDczLC0wLjc2NjEyNjYsMC4pLAp2ZWMzKDAuMzA3OTEzMiwtMC4xMjE2NzYzLDAuKSwKdmVjMygtMC4zNzk0MzM1LC0wLjgyNzE1ODMsMC4pLAp2ZWMzKC0wLjIwMzg3OCwtMC4wNzcxNTAzNCwwLiksCnZlYzMoMC41OTEyNjk3LDAuMTQ2OTc5OSwwLiksCnZlYzMoLTAuODgwNjksMC4zMDMxNzg0LDAuKSwKdmVjMygwLjUwNDAxMDgsMC44MjgzNzIyLDAuKSwKdmVjMygtMC41ODQ0MTI0LDAuNTQ5NDg3NywwLiksCnZlYzMoMC42MDE3Nzk5LC0wLjE3MjY2NTQsMC4pLAp2ZWMzKC0wLjU1NTQ5ODEsMC4xNTU5OTk3LDAuKSwKdmVjMygtMC4zMDE2MzY5LC0wLjM5MDA5MjgsMC4pLAp2ZWMzKC0wLjU1NTA2MzIsLTAuMTcyMzc2MiwwLiksCnZlYzMoMC45MjUwMjksMC4yOTk1MDQxLDAuKSwKdmVjMygtMC4yNDczMTM3LDAuNTUzODUwNSwwLiksCnZlYzMoMC45MTgzMDM3LC0wLjI4NjIzOTIsMC4pLAp2ZWMzKDAuMjQ2OTQyMSwwLjY3MTg3MTIsMC4pLAp2ZWMzKDAuMzkxNjM5NywtMC40MzI4MjA5LDAuKSwKdmVjMygtMC4wMzU3NjkyNywtMC42MjIwMDMyLDAuKSwKdmVjMygtMC4wNDY2MTI1NSwwLjc5OTUyMDEsMC4pLAp2ZWMzKDAuNDQwMjkyNCwwLjM2NDAzMTIsMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLiksCnZlYzMoMC4sMC4sMC4pLAp2ZWMzKDAuLDAuLDAuKSwKdmVjMygwLiwwLiwwLikKKTsKY29uc3QgdmVjMyBQb2lzc29uU2FtcGxlcnM2NFs2NF09dmVjM1s2NF0oCnZlYzMoLTAuNjEzMzkyLDAuNjE3NDgxLDAuKSwKdmVjMygwLjE3MDAxOSwtMC4wNDAyNTQsMC4pLAp2ZWMzKC0wLjI5OTQxNywwLjc5MTkyNSwwLiksCnZlYzMoMC42NDU2ODAsMC40OTMyMTAsMC4pLAp2ZWMzKC0wLjY1MTc4NCwwLjcxNzg4NywwLiksCnZlYzMoMC40MjEwMDMsMC4wMjcwNzAsMC4pLAp2ZWMzKC0wLjgxNzE5NCwtMC4yNzEwOTYsMC4pLAp2ZWMzKC0wLjcwNTM3NCwtMC42NjgyMDMsMC4pLAp2ZWMzKDAuOTc3MDUwLC0wLjEwODYxNSwwLiksCnZlYzMoMC4wNjMzMjYsMC4xNDIzNjksMC4pLAp2ZWMzKDAuMjAzNTI4LDAuMjE0MzMxLDAuKSwKdmVjMygtMC42Njc1MzEsMC4zMjYwOTAsMC4pLAp2ZWMzKC0wLjA5ODQyMiwtMC4yOTU3NTUsMC4pLAp2ZWMzKC0wLjg4NTkyMiwwLjIxNTM2OSwwLiksCnZlYzMoMC41NjY2MzcsMC42MDUyMTMsMC4pLAp2ZWMzKDAuMDM5NzY2LC0wLjM5NjEwMCwwLiksCnZlYzMoMC43NTE5NDYsMC40NTMzNTIsMC4pLAp2ZWMzKDAuMDc4NzA3LC0wLjcxNTMyMywwLiksCnZlYzMoLTAuMDc1ODM4LC0wLjUyOTM0NCwwLiksCnZlYzMoMC43MjQ0NzksLTAuNTgwNzk4LDAuKSwKdmVjMygwLjIyMjk5OSwtMC4yMTUxMjUsMC4pLAp2ZWMzKC0wLjQ2NzU3NCwtMC40MDU0MzgsMC4pLAp2ZWMzKC0wLjI0ODI2OCwtMC44MTQ3NTMsMC4pLAp2ZWMzKDAuMzU0NDExLC0wLjg4NzU3MCwwLiksCnZlYzMoMC4xNzU4MTcsMC4zODIzNjYsMC4pLAp2ZWMzKDAuNDg3NDcyLC0wLjA2MzA4MiwwLiksCnZlYzMoLTAuMDg0MDc4LDAuODk4MzEyLDAuKSwKdmVjMygwLjQ4ODg3NiwtMC43ODM0NDEsMC4pLAp2ZWMzKDAuNDcwMDE2LDAuMjE3OTMzLDAuKSwKdmVjMygtMC42OTY4OTAsLTAuNTQ5NzkxLDAuKSwKdmVjMygtMC4xNDk2OTMsMC42MDU3NjIsMC4pLAp2ZWMzKDAuMDM0MjExLDAuOTc5OTgwLDAuKSwKdmVjMygwLjUwMzA5OCwtMC4zMDg4NzgsMC4pLAp2ZWMzKC0wLjAxNjIwNSwtMC44NzI5MjEsMC4pLAp2ZWMzKDAuMzg1Nzg0LC0wLjM5MzkwMiwwLiksCnZlYzMoLTAuMTQ2ODg2LC0wLjg1OTI0OSwwLiksCnZlYzMoMC42NDMzNjEsMC4xNjQwOTgsMC4pLAp2ZWMzKDAuNjM0Mzg4LC0wLjA0OTQ3MSwwLiksCnZlYzMoLTAuNjg4ODk0LDAuMDA3ODQzLDAuKSwKdmVjMygwLjQ2NDAzNCwtMC4xODg4MTgsMC4pLAp2ZWMzKC0wLjQ0MDg0MCwwLjEzNzQ4NiwwLiksCnZlYzMoMC4zNjQ0ODMsMC41MTE3MDQsMC4pLAp2ZWMzKDAuMDM0MDI4LDAuMzI1OTY4LDAuKSwKdmVjMygwLjA5OTA5NCwtMC4zMDgwMjMsMC4pLAp2ZWMzKDAuNjkzOTYwLC0wLjM2NjI1MywwLiksCnZlYzMoMC42Nzg4ODQsLTAuMjA0Njg4LDAuKSwKdmVjMygwLjAwMTgwMSwwLjc4MDMyOCwwLiksCnZlYzMoMC4xNDUxNzcsLTAuODk4OTg0LDAuKSwKdmVjMygwLjA2MjY1NSwtMC42MTE4NjYsMC4pLAp2ZWMzKDAuMzE1MjI2LC0wLjYwNDI5NywwLiksCnZlYzMoLTAuNzgwMTQ1LDAuNDg2MjUxLDAuKSwKdmVjMygtMC4zNzE4NjgsMC44ODIxMzgsMC4pLAp2ZWMzKDAuMjAwNDc2LDAuNDk0NDMwLDAuKSwKdmVjMygtMC40OTQ1NTIsLTAuNzExMDUxLDAuKSwKdmVjMygwLjYxMjQ3NiwwLjcwNTI1MiwwLiksCnZlYzMoLTAuNTc4ODQ1LC0wLjc2ODc5MiwwLiksCnZlYzMoLTAuNzcyNDU0LC0wLjA5MDk3NiwwLiksCnZlYzMoMC41MDQ0NDAsMC4zNzIyOTUsMC4pLAp2ZWMzKDAuMTU1NzM2LDAuMDY1MTU3LDAuKSwKdmVjMygwLjM5MTUyMiwwLjg0OTYwNSwwLiksCnZlYzMoLTAuNjIwMTA2LC0wLjMyODEwNCwwLiksCnZlYzMoMC43ODkyMzksLTAuNDE5OTY1LDAuKSwKdmVjMygtMC41NDUzOTYsMC41MzgxMzMsMC4pLAp2ZWMzKC0wLjE3ODU2NCwtMC41OTYwNTcsMC4pCik7CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUyhmbG9hdCBsYXllcix2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxoaWdocCBzYW1wbGVyMkRBcnJheSBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcixmbG9hdCBzaGFkb3dNYXBTaXplSW52ZXJzZSxmbG9hdCBsaWdodFNpemVVVixmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYsaW50IHNlYXJjaFRhcENvdW50LGludCBwY2ZUYXBDb3VudCx2ZWMzWzY0XSBwb2lzc29uU2FtcGxlcnMsdmVjMiBsaWdodFNpemVVVkNvcnJlY3Rpb24sZmxvYXQgZGVwdGhDb3JyZWN0aW9uLGZsb2F0IHBlbnVtYnJhRGFya25lc3MpCnsKdmVjMyBjbGlwU3BhY2U9dlBvc2l0aW9uRnJvbUxpZ2h0Lnh5ei92UG9zaXRpb25Gcm9tTGlnaHQudzsKdmVjMyB1dkRlcHRoPXZlYzMoMC41KmNsaXBTcGFjZS54eXordmVjMygwLjUpKTsKdXZEZXB0aC56PWNsYW1wKFpJTkNMSVAsMC4sR1JFQVRFU1RfTEVTU19USEFOX09ORSk7CnZlYzQgdXZEZXB0aExheWVyPXZlYzQodXZEZXB0aC54LHV2RGVwdGgueSxsYXllcix1dkRlcHRoLnopOwpmbG9hdCBibG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBzdW1CbG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBudW1CbG9ja2VyPTAuMDsKZm9yIChpbnQgaT0wOyBpPHNlYXJjaFRhcENvdW50OyBpICsrKSB7CmJsb2NrZXJEZXB0aD10ZXh0dXJlMkQoZGVwdGhTYW1wbGVyLHZlYzModXZEZXB0aC54eSsobGlnaHRTaXplVVYqbGlnaHRTaXplVVZDb3JyZWN0aW9uKnNoYWRvd01hcFNpemVJbnZlcnNlKlBvaXNzb25TYW1wbGVyczMyW2ldLnh5KSxsYXllcikpLnI7CmlmIChibG9ja2VyRGVwdGg8ZGVwdGhNZXRyaWMpIHsKc3VtQmxvY2tlckRlcHRoKz1ibG9ja2VyRGVwdGg7Cm51bUJsb2NrZXIrKzsKfQp9CmZsb2F0IGF2Z0Jsb2NrZXJEZXB0aD1zdW1CbG9ja2VyRGVwdGgvbnVtQmxvY2tlcjsKZmxvYXQgQUFPZmZzZXQ9c2hhZG93TWFwU2l6ZUludmVyc2UqMTAuOwpmbG9hdCBwZW51bWJyYVJhdGlvPSgoZGVwdGhNZXRyaWMtYXZnQmxvY2tlckRlcHRoKSpkZXB0aENvcnJlY3Rpb24rQUFPZmZzZXQpOwp2ZWM0IGZpbHRlclJhZGl1cz12ZWM0KHBlbnVtYnJhUmF0aW8qbGlnaHRTaXplVVYqbGlnaHRTaXplVVZDb3JyZWN0aW9uKnNoYWRvd01hcFNpemVJbnZlcnNlLDAuLDAuKTsKZmxvYXQgcmFuZG9tPWdldFJhbmQodlBvc2l0aW9uRnJvbUxpZ2h0Lnh5KTsKZmxvYXQgcm90YXRpb25BbmdsZT1yYW5kb20qMy4xNDE1OTI2Owp2ZWMyIHJvdGF0aW9uVmVjdG9yPXZlYzIoY29zKHJvdGF0aW9uQW5nbGUpLHNpbihyb3RhdGlvbkFuZ2xlKSk7CmZsb2F0IHNoYWRvdz0wLjsKZm9yIChpbnQgaT0wOyBpPHBjZlRhcENvdW50OyBpKyspIHsKdmVjNCBvZmZzZXQ9dmVjNChwb2lzc29uU2FtcGxlcnNbaV0sMC4pOwpvZmZzZXQ9dmVjNChvZmZzZXQueCpyb3RhdGlvblZlY3Rvci54LW9mZnNldC55KnJvdGF0aW9uVmVjdG9yLnksb2Zmc2V0Lnkqcm90YXRpb25WZWN0b3IueCtvZmZzZXQueCpyb3RhdGlvblZlY3Rvci55LDAuLDAuKTsKc2hhZG93Kz10ZXh0dXJlMkQoc2hhZG93U2FtcGxlcix1dkRlcHRoTGF5ZXIrb2Zmc2V0KmZpbHRlclJhZGl1cyk7Cn0Kc2hhZG93Lz1mbG9hdChwY2ZUYXBDb3VudCk7CnNoYWRvdz1taXgoc2hhZG93LDEuLG1pbigoZGVwdGhNZXRyaWMtYXZnQmxvY2tlckRlcHRoKSpkZXB0aENvcnJlY3Rpb24qcGVudW1icmFEYXJrbmVzcywxLikpOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CmlmIChudW1CbG9ja2VyPDEuMCkgewpyZXR1cm4gMS4wOwp9CmVsc2UKewpyZXR1cm4gY29tcHV0ZUZhbGxPZmYoc2hhZG93LGNsaXBTcGFjZS54eSxmcnVzdHVtRWRnZUZhbGxvZmYpOwp9Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ1NTKHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLHNhbXBsZXIyRCBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgc2hhZG93TWFwU2l6ZUludmVyc2UsZmxvYXQgbGlnaHRTaXplVVYsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmLGludCBzZWFyY2hUYXBDb3VudCxpbnQgcGNmVGFwQ291bnQsdmVjM1s2NF0gcG9pc3NvblNhbXBsZXJzKQp7CmlmIChkZXB0aE1ldHJpYz4xLjAgfHwgZGVwdGhNZXRyaWM8MC4wKSB7CnJldHVybiAxLjA7Cn0KZWxzZQp7CnZlYzMgY2xpcFNwYWNlPXZQb3NpdGlvbkZyb21MaWdodC54eXovdlBvc2l0aW9uRnJvbUxpZ2h0Lnc7CnZlYzMgdXZEZXB0aD12ZWMzKDAuNSpjbGlwU3BhY2UueHl6K3ZlYzMoMC41KSk7CnV2RGVwdGguej1aSU5DTElQOwpmbG9hdCBibG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBzdW1CbG9ja2VyRGVwdGg9MC4wOwpmbG9hdCBudW1CbG9ja2VyPTAuMDsKZm9yIChpbnQgaT0wOyBpPHNlYXJjaFRhcENvdW50OyBpICsrKSB7CmJsb2NrZXJEZXB0aD1URVhUVVJFRlVOQyhkZXB0aFNhbXBsZXIsdXZEZXB0aC54eSsobGlnaHRTaXplVVYqc2hhZG93TWFwU2l6ZUludmVyc2UqUG9pc3NvblNhbXBsZXJzMzJbaV0ueHkpLDAuKS5yOwppZiAoYmxvY2tlckRlcHRoPGRlcHRoTWV0cmljKSB7CnN1bUJsb2NrZXJEZXB0aCs9YmxvY2tlckRlcHRoOwpudW1CbG9ja2VyKys7Cn0KfQppZiAobnVtQmxvY2tlcjwxLjApIHsKcmV0dXJuIDEuMDsKfQplbHNlCnsKZmxvYXQgYXZnQmxvY2tlckRlcHRoPXN1bUJsb2NrZXJEZXB0aC9udW1CbG9ja2VyOwpmbG9hdCBBQU9mZnNldD1zaGFkb3dNYXBTaXplSW52ZXJzZSoxMC47CmZsb2F0IHBlbnVtYnJhUmF0aW89KChkZXB0aE1ldHJpYy1hdmdCbG9ja2VyRGVwdGgpK0FBT2Zmc2V0KTsKZmxvYXQgZmlsdGVyUmFkaXVzPXBlbnVtYnJhUmF0aW8qbGlnaHRTaXplVVYqc2hhZG93TWFwU2l6ZUludmVyc2U7CmZsb2F0IHJhbmRvbT1nZXRSYW5kKHZQb3NpdGlvbkZyb21MaWdodC54eSk7CmZsb2F0IHJvdGF0aW9uQW5nbGU9cmFuZG9tKjMuMTQxNTkyNjsKdmVjMiByb3RhdGlvblZlY3Rvcj12ZWMyKGNvcyhyb3RhdGlvbkFuZ2xlKSxzaW4ocm90YXRpb25BbmdsZSkpOwpmbG9hdCBzaGFkb3c9MC47CmZvciAoaW50IGk9MDsgaTxwY2ZUYXBDb3VudDsgaSsrKSB7CnZlYzMgb2Zmc2V0PXBvaXNzb25TYW1wbGVyc1tpXTsKb2Zmc2V0PXZlYzMob2Zmc2V0Lngqcm90YXRpb25WZWN0b3IueC1vZmZzZXQueSpyb3RhdGlvblZlY3Rvci55LG9mZnNldC55KnJvdGF0aW9uVmVjdG9yLngrb2Zmc2V0Lngqcm90YXRpb25WZWN0b3IueSwwLik7CnNoYWRvdys9VEVYVFVSRUZVTkMoc2hhZG93U2FtcGxlcix1dkRlcHRoK29mZnNldCpmaWx0ZXJSYWRpdXMsMC4pOwp9CnNoYWRvdy89ZmxvYXQocGNmVGFwQ291bnQpOwpzaGFkb3c9bWl4KHNoYWRvdywxLixkZXB0aE1ldHJpYy1hdmdCbG9ja2VyRGVwdGgpOwpzaGFkb3c9bWl4KGRhcmtuZXNzLDEuLHNoYWRvdyk7CnJldHVybiBjb21wdXRlRmFsbE9mZihzaGFkb3csY2xpcFNwYWNlLnh5LGZydXN0dW1FZGdlRmFsbG9mZik7Cn0KfQp9CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoUENTUzE2KHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLHNhbXBsZXIyRCBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEU2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgc2hhZG93TWFwU2l6ZUludmVyc2UsZmxvYXQgbGlnaHRTaXplVVYsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmKQp7CnJldHVybiBjb21wdXRlU2hhZG93V2l0aFBDU1ModlBvc2l0aW9uRnJvbUxpZ2h0LGRlcHRoTWV0cmljLGRlcHRoU2FtcGxlcixzaGFkb3dTYW1wbGVyLHNoYWRvd01hcFNpemVJbnZlcnNlLGxpZ2h0U2l6ZVVWLGRhcmtuZXNzLGZydXN0dW1FZGdlRmFsbG9mZiwxNiwxNixQb2lzc29uU2FtcGxlcnMzMik7Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhQQ1NTMzIodmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsc2FtcGxlcjJEIGRlcHRoU2FtcGxlcixoaWdocCBzYW1wbGVyMkRTaGFkb3cgc2hhZG93U2FtcGxlcixmbG9hdCBzaGFkb3dNYXBTaXplSW52ZXJzZSxmbG9hdCBsaWdodFNpemVVVixmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYpCnsKcmV0dXJuIGNvbXB1dGVTaGFkb3dXaXRoUENTUyh2UG9zaXRpb25Gcm9tTGlnaHQsZGVwdGhNZXRyaWMsZGVwdGhTYW1wbGVyLHNoYWRvd1NhbXBsZXIsc2hhZG93TWFwU2l6ZUludmVyc2UsbGlnaHRTaXplVVYsZGFya25lc3MsZnJ1c3R1bUVkZ2VGYWxsb2ZmLDE2LDMyLFBvaXNzb25TYW1wbGVyczMyKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aFBDU1M2NCh2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxzYW1wbGVyMkQgZGVwdGhTYW1wbGVyLGhpZ2hwIHNhbXBsZXIyRFNoYWRvdyBzaGFkb3dTYW1wbGVyLGZsb2F0IHNoYWRvd01hcFNpemVJbnZlcnNlLGZsb2F0IGxpZ2h0U2l6ZVVWLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZikKewpyZXR1cm4gY29tcHV0ZVNoYWRvd1dpdGhQQ1NTKHZQb3NpdGlvbkZyb21MaWdodCxkZXB0aE1ldHJpYyxkZXB0aFNhbXBsZXIsc2hhZG93U2FtcGxlcixzaGFkb3dNYXBTaXplSW52ZXJzZSxsaWdodFNpemVVVixkYXJrbmVzcyxmcnVzdHVtRWRnZUZhbGxvZmYsMzIsNjQsUG9pc3NvblNhbXBsZXJzNjQpOwp9CiNkZWZpbmUgaW5saW5lCmZsb2F0IGNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUzE2KGZsb2F0IGxheWVyLHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0LGZsb2F0IGRlcHRoTWV0cmljLGhpZ2hwIHNhbXBsZXIyREFycmF5IGRlcHRoU2FtcGxlcixoaWdocCBzYW1wbGVyMkRBcnJheVNoYWRvdyBzaGFkb3dTYW1wbGVyLGZsb2F0IHNoYWRvd01hcFNpemVJbnZlcnNlLGZsb2F0IGxpZ2h0U2l6ZVVWLGZsb2F0IGRhcmtuZXNzLGZsb2F0IGZydXN0dW1FZGdlRmFsbG9mZix2ZWMyIGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbixmbG9hdCBkZXB0aENvcnJlY3Rpb24sZmxvYXQgcGVudW1icmFEYXJrbmVzcykKewpyZXR1cm4gY29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTKGxheWVyLHZQb3NpdGlvbkZyb21MaWdodCxkZXB0aE1ldHJpYyxkZXB0aFNhbXBsZXIsc2hhZG93U2FtcGxlcixzaGFkb3dNYXBTaXplSW52ZXJzZSxsaWdodFNpemVVVixkYXJrbmVzcyxmcnVzdHVtRWRnZUZhbGxvZmYsMTYsMTYsUG9pc3NvblNhbXBsZXJzMzIsbGlnaHRTaXplVVZDb3JyZWN0aW9uLGRlcHRoQ29ycmVjdGlvbixwZW51bWJyYURhcmtuZXNzKTsKfQojZGVmaW5lIGlubGluZQpmbG9hdCBjb21wdXRlU2hhZG93V2l0aENTTVBDU1MzMihmbG9hdCBsYXllcix2ZWM0IHZQb3NpdGlvbkZyb21MaWdodCxmbG9hdCBkZXB0aE1ldHJpYyxoaWdocCBzYW1wbGVyMkRBcnJheSBkZXB0aFNhbXBsZXIsaGlnaHAgc2FtcGxlcjJEQXJyYXlTaGFkb3cgc2hhZG93U2FtcGxlcixmbG9hdCBzaGFkb3dNYXBTaXplSW52ZXJzZSxmbG9hdCBsaWdodFNpemVVVixmbG9hdCBkYXJrbmVzcyxmbG9hdCBmcnVzdHVtRWRnZUZhbGxvZmYsdmVjMiBsaWdodFNpemVVVkNvcnJlY3Rpb24sZmxvYXQgZGVwdGhDb3JyZWN0aW9uLGZsb2F0IHBlbnVtYnJhRGFya25lc3MpCnsKcmV0dXJuIGNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUyhsYXllcix2UG9zaXRpb25Gcm9tTGlnaHQsZGVwdGhNZXRyaWMsZGVwdGhTYW1wbGVyLHNoYWRvd1NhbXBsZXIsc2hhZG93TWFwU2l6ZUludmVyc2UsbGlnaHRTaXplVVYsZGFya25lc3MsZnJ1c3R1bUVkZ2VGYWxsb2ZmLDE2LDMyLFBvaXNzb25TYW1wbGVyczMyLGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbixkZXB0aENvcnJlY3Rpb24scGVudW1icmFEYXJrbmVzcyk7Cn0KI2RlZmluZSBpbmxpbmUKZmxvYXQgY29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTNjQoZmxvYXQgbGF5ZXIsdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHQsZmxvYXQgZGVwdGhNZXRyaWMsaGlnaHAgc2FtcGxlcjJEQXJyYXkgZGVwdGhTYW1wbGVyLGhpZ2hwIHNhbXBsZXIyREFycmF5U2hhZG93IHNoYWRvd1NhbXBsZXIsZmxvYXQgc2hhZG93TWFwU2l6ZUludmVyc2UsZmxvYXQgbGlnaHRTaXplVVYsZmxvYXQgZGFya25lc3MsZmxvYXQgZnJ1c3R1bUVkZ2VGYWxsb2ZmLHZlYzIgbGlnaHRTaXplVVZDb3JyZWN0aW9uLGZsb2F0IGRlcHRoQ29ycmVjdGlvbixmbG9hdCBwZW51bWJyYURhcmtuZXNzKQp7CnJldHVybiBjb21wdXRlU2hhZG93V2l0aENTTVBDU1MobGF5ZXIsdlBvc2l0aW9uRnJvbUxpZ2h0LGRlcHRoTWV0cmljLGRlcHRoU2FtcGxlcixzaGFkb3dTYW1wbGVyLHNoYWRvd01hcFNpemVJbnZlcnNlLGxpZ2h0U2l6ZVVWLGRhcmtuZXNzLGZydXN0dW1FZGdlRmFsbG9mZiwzMiw2NCxQb2lzc29uU2FtcGxlcnM2NCxsaWdodFNpemVVVkNvcnJlY3Rpb24sZGVwdGhDb3JyZWN0aW9uLHBlbnVtYnJhRGFya25lc3MpOwp9CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0pvXT1laDtjb25zdCB0aD0ic2FtcGxlckZyYWdtZW50RGVjbGFyYXRpb24iLGloPWAjaWZkZWYgX0RFRklORU5BTUVfCiNpZiBfREVGSU5FTkFNRV9ESVJFQ1RVVj09MQojZGVmaW5lIHZfVkFSWUlOR05BTUVfVVYgdk1haW5VVjEKI2VsaWYgX0RFRklORU5BTUVfRElSRUNUVVY9PTIKI2RlZmluZSB2X1ZBUllJTkdOQU1FX1VWIHZNYWluVVYyCiNlbGlmIF9ERUZJTkVOQU1FX0RJUkVDVFVWPT0zCiNkZWZpbmUgdl9WQVJZSU5HTkFNRV9VViB2TWFpblVWMwojZWxpZiBfREVGSU5FTkFNRV9ESVJFQ1RVVj09NAojZGVmaW5lIHZfVkFSWUlOR05BTUVfVVYgdk1haW5VVjQKI2VsaWYgX0RFRklORU5BTUVfRElSRUNUVVY9PTUKI2RlZmluZSB2X1ZBUllJTkdOQU1FX1VWIHZNYWluVVY1CiNlbGlmIF9ERUZJTkVOQU1FX0RJUkVDVFVWPT02CiNkZWZpbmUgdl9WQVJZSU5HTkFNRV9VViB2TWFpblVWNgojZWxzZQp2YXJ5aW5nIHZlYzIgdl9WQVJZSU5HTkFNRV9VVjsKI2VuZGlmCnVuaWZvcm0gc2FtcGxlcjJEIF9TQU1QTEVSTkFNRV9TYW1wbGVyOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3RoXT1paDtjb25zdCBzaD0iZnJlc25lbEZ1bmN0aW9uIixyaD1gI2lmZGVmIEZSRVNORUwKZmxvYXQgY29tcHV0ZUZyZXNuZWxUZXJtKHZlYzMgdmlld0RpcmVjdGlvbix2ZWMzIHdvcmxkTm9ybWFsLGZsb2F0IGJpYXMsZmxvYXQgcG93ZXIpCnsKZmxvYXQgZnJlc25lbFRlcm09cG93KGJpYXMrYWJzKGRvdCh2aWV3RGlyZWN0aW9uLHdvcmxkTm9ybWFsKSkscG93ZXIpOwpyZXR1cm4gY2xhbXAoZnJlc25lbFRlcm0sMC4sMS4pOwp9CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbc2hdPXJoO2NvbnN0IG5oPSJyZWZsZWN0aW9uRnVuY3Rpb24iLGFoPWB2ZWMzIGNvbXB1dGVGaXhlZEVxdWlyZWN0YW5ndWxhckNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBkaXJlY3Rpb24pCnsKZmxvYXQgbG9uPWF0YW4oZGlyZWN0aW9uLnosZGlyZWN0aW9uLngpOwpmbG9hdCBsYXQ9YWNvcyhkaXJlY3Rpb24ueSk7CnZlYzIgc3BoZXJlQ29vcmRzPXZlYzIobG9uLGxhdCkqUkVDSVBST0NBTF9QSTIqMi4wOwpmbG9hdCBzPXNwaGVyZUNvb3Jkcy54KjAuNSswLjU7CmZsb2F0IHQ9c3BoZXJlQ29vcmRzLnk7CnJldHVybiB2ZWMzKHMsdCwwKTsgCn0KdmVjMyBjb21wdXRlTWlycm9yZWRGaXhlZEVxdWlyZWN0YW5ndWxhckNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBkaXJlY3Rpb24pCnsKZmxvYXQgbG9uPWF0YW4oZGlyZWN0aW9uLnosZGlyZWN0aW9uLngpOwpmbG9hdCBsYXQ9YWNvcyhkaXJlY3Rpb24ueSk7CnZlYzIgc3BoZXJlQ29vcmRzPXZlYzIobG9uLGxhdCkqUkVDSVBST0NBTF9QSTIqMi4wOwpmbG9hdCBzPXNwaGVyZUNvb3Jkcy54KjAuNSswLjU7CmZsb2F0IHQ9c3BoZXJlQ29vcmRzLnk7CnJldHVybiB2ZWMzKDEuMC1zLHQsMCk7IAp9CnZlYzMgY29tcHV0ZUVxdWlyZWN0YW5ndWxhckNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBleWVQb3NpdGlvbixtYXQ0IHJlZmxlY3Rpb25NYXRyaXgpCnsKdmVjMyBjYW1lcmFUb1ZlcnRleD1ub3JtYWxpemUod29ybGRQb3MueHl6LWV5ZVBvc2l0aW9uKTsKdmVjMyByPW5vcm1hbGl6ZShyZWZsZWN0KGNhbWVyYVRvVmVydGV4LHdvcmxkTm9ybWFsKSk7CnI9dmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQociwwKSk7CmZsb2F0IGxvbj1hdGFuKHIueixyLngpOwpmbG9hdCBsYXQ9YWNvcyhyLnkpOwp2ZWMyIHNwaGVyZUNvb3Jkcz12ZWMyKGxvbixsYXQpKlJFQ0lQUk9DQUxfUEkyKjIuMDsKZmxvYXQgcz1zcGhlcmVDb29yZHMueCowLjUrMC41OwpmbG9hdCB0PXNwaGVyZUNvb3Jkcy55OwpyZXR1cm4gdmVjMyhzLHQsMCk7Cn0KdmVjMyBjb21wdXRlU3BoZXJpY2FsQ29vcmRzKHZlYzQgd29ybGRQb3MsdmVjMyB3b3JsZE5vcm1hbCxtYXQ0IHZpZXcsbWF0NCByZWZsZWN0aW9uTWF0cml4KQp7CnZlYzMgdmlld0Rpcj1ub3JtYWxpemUodmVjMyh2aWV3KndvcmxkUG9zKSk7CnZlYzMgdmlld05vcm1hbD1ub3JtYWxpemUodmVjMyh2aWV3KnZlYzQod29ybGROb3JtYWwsMC4wKSkpOwp2ZWMzIHI9cmVmbGVjdCh2aWV3RGlyLHZpZXdOb3JtYWwpOwpyPXZlYzMocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KHIsMCkpOwpyLno9ci56LTEuMDsKZmxvYXQgbT0yLjAqbGVuZ3RoKHIpOwpyZXR1cm4gdmVjMyhyLngvbSswLjUsMS4wLXIueS9tLTAuNSwwKTsKfQp2ZWMzIGNvbXB1dGVQbGFuYXJDb29yZHModmVjNCB3b3JsZFBvcyx2ZWMzIHdvcmxkTm9ybWFsLHZlYzMgZXllUG9zaXRpb24sbWF0NCByZWZsZWN0aW9uTWF0cml4KQp7CnZlYzMgdmlld0Rpcj13b3JsZFBvcy54eXotZXllUG9zaXRpb247CnZlYzMgY29vcmRzPW5vcm1hbGl6ZShyZWZsZWN0KHZpZXdEaXIsd29ybGROb3JtYWwpKTsKcmV0dXJuIHZlYzMocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KGNvb3JkcywxKSk7Cn0KdmVjMyBjb21wdXRlQ3ViaWNDb29yZHModmVjNCB3b3JsZFBvcyx2ZWMzIHdvcmxkTm9ybWFsLHZlYzMgZXllUG9zaXRpb24sbWF0NCByZWZsZWN0aW9uTWF0cml4KQp7CnZlYzMgdmlld0Rpcj1ub3JtYWxpemUod29ybGRQb3MueHl6LWV5ZVBvc2l0aW9uKTsKdmVjMyBjb29yZHM9cmVmbGVjdCh2aWV3RGlyLHdvcmxkTm9ybWFsKTsKY29vcmRzPXZlYzMocmVmbGVjdGlvbk1hdHJpeCp2ZWM0KGNvb3JkcywwKSk7CiNpZmRlZiBJTlZFUlRDVUJJQ01BUApjb29yZHMueSo9LTEuMDsKI2VuZGlmCnJldHVybiBjb29yZHM7Cn0KdmVjMyBjb21wdXRlQ3ViaWNMb2NhbENvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwsdmVjMyBleWVQb3NpdGlvbixtYXQ0IHJlZmxlY3Rpb25NYXRyaXgsdmVjMyByZWZsZWN0aW9uU2l6ZSx2ZWMzIHJlZmxlY3Rpb25Qb3NpdGlvbikKewp2ZWMzIHZpZXdEaXI9bm9ybWFsaXplKHdvcmxkUG9zLnh5ei1leWVQb3NpdGlvbik7CnZlYzMgY29vcmRzPXJlZmxlY3Qodmlld0Rpcix3b3JsZE5vcm1hbCk7CmNvb3Jkcz1wYXJhbGxheENvcnJlY3ROb3JtYWwod29ybGRQb3MueHl6LGNvb3JkcyxyZWZsZWN0aW9uU2l6ZSxyZWZsZWN0aW9uUG9zaXRpb24pOwpjb29yZHM9dmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQoY29vcmRzLDApKTsKI2lmZGVmIElOVkVSVENVQklDTUFQCmNvb3Jkcy55Kj0tMS4wOwojZW5kaWYKcmV0dXJuIGNvb3JkczsKfQp2ZWMzIGNvbXB1dGVQcm9qZWN0aW9uQ29vcmRzKHZlYzQgd29ybGRQb3MsbWF0NCB2aWV3LG1hdDQgcmVmbGVjdGlvbk1hdHJpeCkKewpyZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4Kih2aWV3KndvcmxkUG9zKSk7Cn0KdmVjMyBjb21wdXRlU2t5Qm94Q29vcmRzKHZlYzMgcG9zaXRpb25XLG1hdDQgcmVmbGVjdGlvbk1hdHJpeCkKewpyZXR1cm4gdmVjMyhyZWZsZWN0aW9uTWF0cml4KnZlYzQocG9zaXRpb25XLDEuKSk7Cn0KI2lmZGVmIFJFRkxFQ1RJT04KdmVjMyBjb21wdXRlUmVmbGVjdGlvbkNvb3Jkcyh2ZWM0IHdvcmxkUG9zLHZlYzMgd29ybGROb3JtYWwpCnsKI2lmZGVmIFJFRkxFQ1RJT05NQVBfTUlSUk9SRURFUVVJUkVDVEFOR1VMQVJfRklYRUQKdmVjMyBkaXJlY3Rpb249bm9ybWFsaXplKHZEaXJlY3Rpb25XKTsKcmV0dXJuIGNvbXB1dGVNaXJyb3JlZEZpeGVkRXF1aXJlY3Rhbmd1bGFyQ29vcmRzKHdvcmxkUG9zLHdvcmxkTm9ybWFsLGRpcmVjdGlvbik7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRUQKdmVjMyBkaXJlY3Rpb249bm9ybWFsaXplKHZEaXJlY3Rpb25XKTsKcmV0dXJuIGNvbXB1dGVGaXhlZEVxdWlyZWN0YW5ndWxhckNvb3Jkcyh3b3JsZFBvcyx3b3JsZE5vcm1hbCxkaXJlY3Rpb24pOwojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSCnJldHVybiBjb21wdXRlRXF1aXJlY3Rhbmd1bGFyQ29vcmRzKHdvcmxkUG9zLHdvcmxkTm9ybWFsLHZFeWVQb3NpdGlvbi54eXoscmVmbGVjdGlvbk1hdHJpeCk7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9TUEhFUklDQUwKcmV0dXJuIGNvbXB1dGVTcGhlcmljYWxDb29yZHMod29ybGRQb3Msd29ybGROb3JtYWwsdmlldyxyZWZsZWN0aW9uTWF0cml4KTsKI2VuZGlmCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1BMQU5BUgpyZXR1cm4gY29tcHV0ZVBsYW5hckNvb3Jkcyh3b3JsZFBvcyx3b3JsZE5vcm1hbCx2RXllUG9zaXRpb24ueHl6LHJlZmxlY3Rpb25NYXRyaXgpOwojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05NQVBfQ1VCSUMKI2lmZGVmIFVTRV9MT0NBTF9SRUZMRUNUSU9OTUFQX0NVQklDCnJldHVybiBjb21wdXRlQ3ViaWNMb2NhbENvb3Jkcyh3b3JsZFBvcyx3b3JsZE5vcm1hbCx2RXllUG9zaXRpb24ueHl6LHJlZmxlY3Rpb25NYXRyaXgsdlJlZmxlY3Rpb25TaXplLHZSZWZsZWN0aW9uUG9zaXRpb24pOwojZWxzZQpyZXR1cm4gY29tcHV0ZUN1YmljQ29vcmRzKHdvcmxkUG9zLHdvcmxkTm9ybWFsLHZFeWVQb3NpdGlvbi54eXoscmVmbGVjdGlvbk1hdHJpeCk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTgpyZXR1cm4gY29tcHV0ZVByb2plY3Rpb25Db29yZHMod29ybGRQb3MsdmlldyxyZWZsZWN0aW9uTWF0cml4KTsKI2VuZGlmCiNpZmRlZiBSRUZMRUNUSU9OTUFQX1NLWUJPWApyZXR1cm4gY29tcHV0ZVNreUJveENvb3Jkcyh2UG9zaXRpb25VVlcscmVmbGVjdGlvbk1hdHJpeCk7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9FWFBMSUNJVApyZXR1cm4gdmVjMygwLDAsMCk7CiNlbmRpZgp9CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbmhdPWFoO2NvbnN0IG9oPSJpbWFnZVByb2Nlc3NpbmdEZWNsYXJhdGlvbiIsaGg9YCNpZmRlZiBFWFBPU1VSRQp1bmlmb3JtIGZsb2F0IGV4cG9zdXJlTGluZWFyOwojZW5kaWYKI2lmZGVmIENPTlRSQVNUCnVuaWZvcm0gZmxvYXQgY29udHJhc3Q7CiNlbmRpZgojaWYgZGVmaW5lZChWSUdORVRURSkgfHwgZGVmaW5lZChESVRIRVIpCnVuaWZvcm0gdmVjMiB2SW52ZXJzZVNjcmVlblNpemU7CiNlbmRpZgojaWZkZWYgVklHTkVUVEUKdW5pZm9ybSB2ZWM0IHZpZ25ldHRlU2V0dGluZ3MxOwp1bmlmb3JtIHZlYzQgdmlnbmV0dGVTZXR0aW5nczI7CiNlbmRpZgojaWZkZWYgQ09MT1JDVVJWRVMKdW5pZm9ybSB2ZWM0IHZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmU7CnVuaWZvcm0gdmVjNCB2Q2FtZXJhQ29sb3JDdXJ2ZU5ldXRyYWw7CnVuaWZvcm0gdmVjNCB2Q2FtZXJhQ29sb3JDdXJ2ZVBvc2l0aXZlOwojZW5kaWYKI2lmZGVmIENPTE9SR1JBRElORwojaWZkZWYgQ09MT1JHUkFESU5HM0QKdW5pZm9ybSBoaWdocCBzYW1wbGVyM0QgdHhDb2xvclRyYW5zZm9ybTsKI2Vsc2UKdW5pZm9ybSBzYW1wbGVyMkQgdHhDb2xvclRyYW5zZm9ybTsKI2VuZGlmCnVuaWZvcm0gdmVjNCBjb2xvclRyYW5zZm9ybVNldHRpbmdzOwojZW5kaWYKI2lmZGVmIERJVEhFUgp1bmlmb3JtIGZsb2F0IGRpdGhlckludGVuc2l0eTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtvaF09aGg7Y29uc3QgbGg9ImltYWdlUHJvY2Vzc2luZ0Z1bmN0aW9ucyIsY2g9YCNpZiBkZWZpbmVkKENPTE9SR1JBRElORykgJiYgIWRlZmluZWQoQ09MT1JHUkFESU5HM0QpCi8qKiAKKiBQb2x5ZmlsbCBmb3IgU0FNUExFX1RFWFRVUkVfM0Qsd2hpY2ggaXMgdW5zdXBwb3J0ZWQgaW4gV2ViR0wuCiogc2FtcGxlcjNkU2V0dGluZy54PXRleHR1cmVPZmZzZXQgKDAuNS90ZXh0dXJlU2l6ZSkuCiogc2FtcGxlcjNkU2V0dGluZy55PXRleHR1cmVTaXplLgoqLwojZGVmaW5lIGlubGluZQp2ZWMzIHNhbXBsZVRleHR1cmUzRChzYW1wbGVyMkQgY29sb3JUcmFuc2Zvcm0sdmVjMyBjb2xvcix2ZWMyIHNhbXBsZXIzZFNldHRpbmcpCnsKZmxvYXQgc2xpY2VTaXplPTIuMCpzYW1wbGVyM2RTZXR0aW5nLng7IAojaWZkZWYgU0FNUExFUjNER1JFRU5ERVBUSApmbG9hdCBzbGljZUNvbnRpbnVvdXM9KGNvbG9yLmctc2FtcGxlcjNkU2V0dGluZy54KSpzYW1wbGVyM2RTZXR0aW5nLnk7CiNlbHNlCmZsb2F0IHNsaWNlQ29udGludW91cz0oY29sb3IuYi1zYW1wbGVyM2RTZXR0aW5nLngpKnNhbXBsZXIzZFNldHRpbmcueTsKI2VuZGlmCmZsb2F0IHNsaWNlSW50ZWdlcj1mbG9vcihzbGljZUNvbnRpbnVvdXMpOwpmbG9hdCBzbGljZUZyYWN0aW9uPXNsaWNlQ29udGludW91cy1zbGljZUludGVnZXI7CiNpZmRlZiBTQU1QTEVSM0RHUkVFTkRFUFRICnZlYzIgc2xpY2VVVj1jb2xvci5yYjsKI2Vsc2UKdmVjMiBzbGljZVVWPWNvbG9yLnJnOwojZW5kaWYKc2xpY2VVVi54Kj1zbGljZVNpemU7CnNsaWNlVVYueCs9c2xpY2VJbnRlZ2VyKnNsaWNlU2l6ZTsKc2xpY2VVVj1zYXR1cmF0ZShzbGljZVVWKTsKdmVjNCBzbGljZTBDb2xvcj10ZXh0dXJlMkQoY29sb3JUcmFuc2Zvcm0sc2xpY2VVVik7CnNsaWNlVVYueCs9c2xpY2VTaXplOwpzbGljZVVWPXNhdHVyYXRlKHNsaWNlVVYpOwp2ZWM0IHNsaWNlMUNvbG9yPXRleHR1cmUyRChjb2xvclRyYW5zZm9ybSxzbGljZVVWKTsKdmVjMyByZXN1bHQ9bWl4KHNsaWNlMENvbG9yLnJnYixzbGljZTFDb2xvci5yZ2Isc2xpY2VGcmFjdGlvbik7CiNpZmRlZiBTQU1QTEVSM0RCR1JNQVAKY29sb3IucmdiPXJlc3VsdC5yZ2I7CiNlbHNlCmNvbG9yLnJnYj1yZXN1bHQuYmdyOwojZW5kaWYKcmV0dXJuIGNvbG9yOwp9CiNlbmRpZgojaWZkZWYgVE9ORU1BUFBJTkdfQUNFUwpjb25zdCBtYXQzIEFDRVNJbnB1dE1hdD1tYXQzKAp2ZWMzKDAuNTk3MTksMC4wNzYwMCwwLjAyODQwKSwKdmVjMygwLjM1NDU4LDAuOTA4MzQsMC4xMzM4MyksCnZlYzMoMC4wNDgyMywwLjAxNTY2LDAuODM3NzcpCik7CmNvbnN0IG1hdDMgQUNFU091dHB1dE1hdD1tYXQzKAp2ZWMzKCAxLjYwNDc1LC0wLjEwMjA4LC0wLjAwMzI3KSwKdmVjMygtMC41MzEwOCwgMS4xMDgxMywtMC4wNzI3NiksCnZlYzMoLTAuMDczNjcsLTAuMDA2MDUsIDEuMDc2MDIpCik7CnZlYzMgUlJUQW5kT0RURml0KHZlYzMgdikKewp2ZWMzIGE9dioodiswLjAyNDU3ODYpLTAuMDAwMDkwNTM3Owp2ZWMzIGI9diooMC45ODM3MjkqdiswLjQzMjk1MTApKzAuMjM4MDgxOwpyZXR1cm4gYS9iOwp9CnZlYzMgQUNFU0ZpdHRlZCh2ZWMzIGNvbG9yKQp7CmNvbG9yPUFDRVNJbnB1dE1hdCpjb2xvcjsKY29sb3I9UlJUQW5kT0RURml0KGNvbG9yKTsKY29sb3I9QUNFU091dHB1dE1hdCpjb2xvcjsKY29sb3I9c2F0dXJhdGUoY29sb3IpOwpyZXR1cm4gY29sb3I7Cn0KI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0lNQUdFUFJPQ0VTU0lOR0ZVTkNUSU9OU19ERUZJTklUSU9OUwp2ZWM0IGFwcGx5SW1hZ2VQcm9jZXNzaW5nKHZlYzQgcmVzdWx0KSB7CiNkZWZpbmUgQ1VTVE9NX0lNQUdFUFJPQ0VTU0lOR0ZVTkNUSU9OU19VUERBVEVSRVNVTFRfQVRTVEFSVAojaWZkZWYgRVhQT1NVUkUKcmVzdWx0LnJnYio9ZXhwb3N1cmVMaW5lYXI7CiNlbmRpZgojaWZkZWYgVklHTkVUVEUKdmVjMiB2aWV3cG9ydFhZPWdsX0ZyYWdDb29yZC54eSp2SW52ZXJzZVNjcmVlblNpemU7CnZpZXdwb3J0WFk9dmlld3BvcnRYWSoyLjAtMS4wOwp2ZWMzIHZpZ25ldHRlWFkxPXZlYzModmlld3BvcnRYWSp2aWduZXR0ZVNldHRpbmdzMS54eSt2aWduZXR0ZVNldHRpbmdzMS56dywxLjApOwpmbG9hdCB2aWduZXR0ZVRlcm09ZG90KHZpZ25ldHRlWFkxLHZpZ25ldHRlWFkxKTsKZmxvYXQgdmlnbmV0dGU9cG93KHZpZ25ldHRlVGVybSx2aWduZXR0ZVNldHRpbmdzMi53KTsKdmVjMyB2aWduZXR0ZUNvbG9yPXZpZ25ldHRlU2V0dGluZ3MyLnJnYjsKI2lmZGVmIFZJR05FVFRFQkxFTkRNT0RFTVVMVElQTFkKdmVjMyB2aWduZXR0ZUNvbG9yTXVsdGlwbGllcj1taXgodmlnbmV0dGVDb2xvcix2ZWMzKDEsMSwxKSx2aWduZXR0ZSk7CnJlc3VsdC5yZ2IqPXZpZ25ldHRlQ29sb3JNdWx0aXBsaWVyOwojZW5kaWYKI2lmZGVmIFZJR05FVFRFQkxFTkRNT0RFT1BBUVVFCnJlc3VsdC5yZ2I9bWl4KHZpZ25ldHRlQ29sb3IscmVzdWx0LnJnYix2aWduZXR0ZSk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFRPTkVNQVBQSU5HCiNpZmRlZiBUT05FTUFQUElOR19BQ0VTCnJlc3VsdC5yZ2I9QUNFU0ZpdHRlZChyZXN1bHQucmdiKTsKI2Vsc2UKY29uc3QgZmxvYXQgdG9uZW1hcHBpbmdDYWxpYnJhdGlvbj0xLjU5MDU3OTsKcmVzdWx0LnJnYj0xLjAtZXhwMigtdG9uZW1hcHBpbmdDYWxpYnJhdGlvbipyZXN1bHQucmdiKTsKI2VuZGlmCiNlbmRpZgpyZXN1bHQucmdiPXRvR2FtbWFTcGFjZShyZXN1bHQucmdiKTsKcmVzdWx0LnJnYj1zYXR1cmF0ZShyZXN1bHQucmdiKTsKI2lmZGVmIENPTlRSQVNUCnZlYzMgcmVzdWx0SGlnaENvbnRyYXN0PXJlc3VsdC5yZ2IqcmVzdWx0LnJnYiooMy4wLTIuMCpyZXN1bHQucmdiKTsKaWYgKGNvbnRyYXN0PDEuMCkgewpyZXN1bHQucmdiPW1peCh2ZWMzKDAuNSwwLjUsMC41KSxyZXN1bHQucmdiLGNvbnRyYXN0KTsKfSBlbHNlIHsKcmVzdWx0LnJnYj1taXgocmVzdWx0LnJnYixyZXN1bHRIaWdoQ29udHJhc3QsY29udHJhc3QtMS4wKTsKfQojZW5kaWYKI2lmZGVmIENPTE9SR1JBRElORwp2ZWMzIGNvbG9yVHJhbnNmb3JtSW5wdXQ9cmVzdWx0LnJnYipjb2xvclRyYW5zZm9ybVNldHRpbmdzLnh4eCtjb2xvclRyYW5zZm9ybVNldHRpbmdzLnl5eTsKI2lmZGVmIENPTE9SR1JBRElORzNECnZlYzMgY29sb3JUcmFuc2Zvcm1PdXRwdXQ9dGV4dHVyZSh0eENvbG9yVHJhbnNmb3JtLGNvbG9yVHJhbnNmb3JtSW5wdXQpLnJnYjsKI2Vsc2UKdmVjMyBjb2xvclRyYW5zZm9ybU91dHB1dD1zYW1wbGVUZXh0dXJlM0QodHhDb2xvclRyYW5zZm9ybSxjb2xvclRyYW5zZm9ybUlucHV0LGNvbG9yVHJhbnNmb3JtU2V0dGluZ3MueXopLnJnYjsKI2VuZGlmCnJlc3VsdC5yZ2I9bWl4KHJlc3VsdC5yZ2IsY29sb3JUcmFuc2Zvcm1PdXRwdXQsY29sb3JUcmFuc2Zvcm1TZXR0aW5ncy53d3cpOwojZW5kaWYKI2lmZGVmIENPTE9SQ1VSVkVTCmZsb2F0IGx1bWE9Z2V0THVtaW5hbmNlKHJlc3VsdC5yZ2IpOwp2ZWMyIGN1cnZlTWl4PWNsYW1wKHZlYzIobHVtYSozLjAtMS41LGx1bWEqLTMuMCsxLjUpLHZlYzIoMC4wKSx2ZWMyKDEuMCkpOwp2ZWM0IGNvbG9yQ3VydmU9dkNhbWVyYUNvbG9yQ3VydmVOZXV0cmFsK2N1cnZlTWl4LngqdkNhbWVyYUNvbG9yQ3VydmVQb3NpdGl2ZS1jdXJ2ZU1peC55KnZDYW1lcmFDb2xvckN1cnZlTmVnYXRpdmU7CnJlc3VsdC5yZ2IqPWNvbG9yQ3VydmUucmdiOwpyZXN1bHQucmdiPW1peCh2ZWMzKGx1bWEpLHJlc3VsdC5yZ2IsY29sb3JDdXJ2ZS5hKTsKI2VuZGlmCiNpZmRlZiBESVRIRVIKZmxvYXQgcmFuZD1nZXRSYW5kKGdsX0ZyYWdDb29yZC54eSp2SW52ZXJzZVNjcmVlblNpemUpOwpmbG9hdCBkaXRoZXI9bWl4KC1kaXRoZXJJbnRlbnNpdHksZGl0aGVySW50ZW5zaXR5LHJhbmQpOwpyZXN1bHQucmdiPXNhdHVyYXRlKHJlc3VsdC5yZ2IrdmVjMyhkaXRoZXIpKTsKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0lNQUdFUFJPQ0VTU0lOR0ZVTkNUSU9OU19VUERBVEVSRVNVTFRfQVRFTkQKcmV0dXJuIHJlc3VsdDsKfWA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtsaF09Y2g7Y29uc3QgdWg9ImJ1bXBGcmFnbWVudE1haW5GdW5jdGlvbnMiLGRoPWAjaWYgZGVmaW5lZChCVU1QKSB8fCBkZWZpbmVkKENMRUFSQ09BVF9CVU1QKSB8fCBkZWZpbmVkKEFOSVNPVFJPUElDKSB8fCBkZWZpbmVkKERFVEFJTCkKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpIAp2YXJ5aW5nIG1hdDMgdlRCTjsKI2VuZGlmCiNpZmRlZiBPQkpFQ1RTUEFDRV9OT1JNQUxNQVAKdW5pZm9ybSBtYXQ0IG5vcm1hbE1hdHJpeDsKI2VuZGlmCnZlYzMgcGVydHVyYk5vcm1hbEJhc2UobWF0MyBjb3RhbmdlbnRGcmFtZSx2ZWMzIG5vcm1hbCxmbG9hdCBzY2FsZSkKewojaWZkZWYgTk9STUFMWFlTQ0FMRQpub3JtYWw9bm9ybWFsaXplKG5vcm1hbCp2ZWMzKHNjYWxlLHNjYWxlLDEuMCkpOwojZW5kaWYKcmV0dXJuIG5vcm1hbGl6ZShjb3RhbmdlbnRGcmFtZSpub3JtYWwpOwp9CnZlYzMgcGVydHVyYk5vcm1hbChtYXQzIGNvdGFuZ2VudEZyYW1lLHZlYzMgdGV4dHVyZVNhbXBsZSxmbG9hdCBzY2FsZSkKewpyZXR1cm4gcGVydHVyYk5vcm1hbEJhc2UoY290YW5nZW50RnJhbWUsdGV4dHVyZVNhbXBsZSoyLjAtMS4wLHNjYWxlKTsKfQptYXQzIGNvdGFuZ2VudF9mcmFtZSh2ZWMzIG5vcm1hbCx2ZWMzIHAsdmVjMiB1dix2ZWMyIHRhbmdlbnRTcGFjZVBhcmFtcykKewp2ZWMzIGRwMT1kRmR4KHApOwp2ZWMzIGRwMj1kRmR5KHApOwp2ZWMyIGR1djE9ZEZkeCh1dik7CnZlYzIgZHV2Mj1kRmR5KHV2KTsKdmVjMyBkcDJwZXJwPWNyb3NzKGRwMixub3JtYWwpOwp2ZWMzIGRwMXBlcnA9Y3Jvc3Mobm9ybWFsLGRwMSk7CnZlYzMgdGFuZ2VudD1kcDJwZXJwKmR1djEueCtkcDFwZXJwKmR1djIueDsKdmVjMyBiaXRhbmdlbnQ9ZHAycGVycCpkdXYxLnkrZHAxcGVycCpkdXYyLnk7CnRhbmdlbnQqPXRhbmdlbnRTcGFjZVBhcmFtcy54OwpiaXRhbmdlbnQqPXRhbmdlbnRTcGFjZVBhcmFtcy55OwpmbG9hdCBkZXQ9bWF4KGRvdCh0YW5nZW50LHRhbmdlbnQpLGRvdChiaXRhbmdlbnQsYml0YW5nZW50KSk7CmZsb2F0IGludm1heD1kZXQ9PTAuMCA/IDAuMCA6IGludmVyc2VzcXJ0KGRldCk7CnJldHVybiBtYXQzKHRhbmdlbnQqaW52bWF4LGJpdGFuZ2VudCppbnZtYXgsbm9ybWFsKTsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3VoXT1kaDtjb25zdCBmaD0iYnVtcEZyYWdtZW50RnVuY3Rpb25zIixfaD1gI2lmIGRlZmluZWQoQlVNUCkKI2luY2x1ZGU8c2FtcGxlckZyYWdtZW50RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxCVU1QLF9WQVJZSU5HTkFNRV8sQnVtcCxfU0FNUExFUk5BTUVfLGJ1bXApCiNlbmRpZgojaWYgZGVmaW5lZChERVRBSUwpCiNpbmNsdWRlPHNhbXBsZXJGcmFnbWVudERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sREVUQUlMLF9WQVJZSU5HTkFNRV8sRGV0YWlsLF9TQU1QTEVSTkFNRV8sZGV0YWlsKQojZW5kaWYKI2lmIGRlZmluZWQoQlVNUCkgJiYgZGVmaW5lZChQQVJBTExBWCkKY29uc3QgZmxvYXQgbWluU2FtcGxlcz00LjsKY29uc3QgZmxvYXQgbWF4U2FtcGxlcz0xNS47CmNvbnN0IGludCBpTWF4U2FtcGxlcz0xNTsKdmVjMiBwYXJhbGxheE9jY2x1c2lvbih2ZWMzIHZWaWV3RGlyQ29ULHZlYzMgdk5vcm1hbENvVCx2ZWMyIHRleENvb3JkLGZsb2F0IHBhcmFsbGF4U2NhbGUpIHsKZmxvYXQgcGFyYWxsYXhMaW1pdD1sZW5ndGgodlZpZXdEaXJDb1QueHkpL3ZWaWV3RGlyQ29ULno7CnBhcmFsbGF4TGltaXQqPXBhcmFsbGF4U2NhbGU7CnZlYzIgdk9mZnNldERpcj1ub3JtYWxpemUodlZpZXdEaXJDb1QueHkpOwp2ZWMyIHZNYXhPZmZzZXQ9dk9mZnNldERpcipwYXJhbGxheExpbWl0OwpmbG9hdCBudW1TYW1wbGVzPW1heFNhbXBsZXMrKGRvdCh2Vmlld0RpckNvVCx2Tm9ybWFsQ29UKSoobWluU2FtcGxlcy1tYXhTYW1wbGVzKSk7CmZsb2F0IHN0ZXBTaXplPTEuMC9udW1TYW1wbGVzOwpmbG9hdCBjdXJyUmF5SGVpZ2h0PTEuMDsKdmVjMiB2Q3Vyck9mZnNldD12ZWMyKDAsMCk7CnZlYzIgdkxhc3RPZmZzZXQ9dmVjMigwLDApOwpmbG9hdCBsYXN0U2FtcGxlZEhlaWdodD0xLjA7CmZsb2F0IGN1cnJTYW1wbGVkSGVpZ2h0PTEuMDsKYm9vbCBrZWVwV29ya2luZz10cnVlOwpmb3IgKGludCBpPTA7IGk8aU1heFNhbXBsZXM7IGkrKykKewpjdXJyU2FtcGxlZEhlaWdodD10ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdGV4Q29vcmQrdkN1cnJPZmZzZXQpLnc7CmlmICgha2VlcFdvcmtpbmcpCnsKfQplbHNlIGlmIChjdXJyU2FtcGxlZEhlaWdodD5jdXJyUmF5SGVpZ2h0KQp7CmZsb2F0IGRlbHRhMT1jdXJyU2FtcGxlZEhlaWdodC1jdXJyUmF5SGVpZ2h0OwpmbG9hdCBkZWx0YTI9KGN1cnJSYXlIZWlnaHQrc3RlcFNpemUpLWxhc3RTYW1wbGVkSGVpZ2h0OwpmbG9hdCByYXRpbz1kZWx0YTEvKGRlbHRhMStkZWx0YTIpOwp2Q3Vyck9mZnNldD0ocmF0aW8pKiB2TGFzdE9mZnNldCsoMS4wLXJhdGlvKSp2Q3Vyck9mZnNldDsKa2VlcFdvcmtpbmc9ZmFsc2U7Cn0KZWxzZQp7CmN1cnJSYXlIZWlnaHQtPXN0ZXBTaXplOwp2TGFzdE9mZnNldD12Q3Vyck9mZnNldDsKdkN1cnJPZmZzZXQrPXN0ZXBTaXplKnZNYXhPZmZzZXQ7Cmxhc3RTYW1wbGVkSGVpZ2h0PWN1cnJTYW1wbGVkSGVpZ2h0Owp9Cn0KcmV0dXJuIHZDdXJyT2Zmc2V0Owp9CnZlYzIgcGFyYWxsYXhPZmZzZXQodmVjMyB2aWV3RGlyLGZsb2F0IGhlaWdodFNjYWxlKQp7CmZsb2F0IGhlaWdodD10ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdkJ1bXBVVikudzsKdmVjMiB0ZXhDb29yZE9mZnNldD1oZWlnaHRTY2FsZSp2aWV3RGlyLnh5KmhlaWdodDsKcmV0dXJuIC10ZXhDb29yZE9mZnNldDsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2ZoXT1faDtjb25zdCBnaD0ibG9nRGVwdGhEZWNsYXJhdGlvbiIscGg9YCNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICnVuaWZvcm0gZmxvYXQgbG9nYXJpdGhtaWNEZXB0aENvbnN0YW50Owp2YXJ5aW5nIGZsb2F0IHZGcmFnbWVudERlcHRoOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2doXT1waDtjb25zdCBtaD0iZm9nRnJhZ21lbnREZWNsYXJhdGlvbiIsRWg9YCNpZmRlZiBGT0cKI2RlZmluZSBGT0dNT0RFX05PTkUgMC4KI2RlZmluZSBGT0dNT0RFX0VYUCAxLgojZGVmaW5lIEZPR01PREVfRVhQMiAyLgojZGVmaW5lIEZPR01PREVfTElORUFSIDMuCiNkZWZpbmUgRSAyLjcxODI4CnVuaWZvcm0gdmVjNCB2Rm9nSW5mb3M7CnVuaWZvcm0gdmVjMyB2Rm9nQ29sb3I7CnZhcnlpbmcgdmVjMyB2Rm9nRGlzdGFuY2U7CmZsb2F0IENhbGNGb2dGYWN0b3IoKQp7CmZsb2F0IGZvZ0NvZWZmPTEuMDsKZmxvYXQgZm9nU3RhcnQ9dkZvZ0luZm9zLnk7CmZsb2F0IGZvZ0VuZD12Rm9nSW5mb3MuejsKZmxvYXQgZm9nRGVuc2l0eT12Rm9nSW5mb3MudzsKZmxvYXQgZm9nRGlzdGFuY2U9bGVuZ3RoKHZGb2dEaXN0YW5jZSk7CmlmIChGT0dNT0RFX0xJTkVBUj09dkZvZ0luZm9zLngpCnsKZm9nQ29lZmY9KGZvZ0VuZC1mb2dEaXN0YW5jZSkvKGZvZ0VuZC1mb2dTdGFydCk7Cn0KZWxzZSBpZiAoRk9HTU9ERV9FWFA9PXZGb2dJbmZvcy54KQp7CmZvZ0NvZWZmPTEuMC9wb3coRSxmb2dEaXN0YW5jZSpmb2dEZW5zaXR5KTsKfQplbHNlIGlmIChGT0dNT0RFX0VYUDI9PXZGb2dJbmZvcy54KQp7CmZvZ0NvZWZmPTEuMC9wb3coRSxmb2dEaXN0YW5jZSpmb2dEaXN0YW5jZSpmb2dEZW5zaXR5KmZvZ0RlbnNpdHkpOwp9CnJldHVybiBjbGFtcChmb2dDb2VmZiwwLjAsMS4wKTsKfQojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW21oXT1FaDtjb25zdCB2aD0iYnVtcEZyYWdtZW50IixUaD1gdmVjMiB1dk9mZnNldD12ZWMyKDAuMCwwLjApOwojaWYgZGVmaW5lZChCVU1QKSB8fCBkZWZpbmVkKFBBUkFMTEFYKSB8fCBkZWZpbmVkKERFVEFJTCkKI2lmZGVmIE5PUk1BTFhZU0NBTEUKZmxvYXQgbm9ybWFsU2NhbGU9MS4wOwojZWxpZiBkZWZpbmVkKEJVTVApCmZsb2F0IG5vcm1hbFNjYWxlPXZCdW1wSW5mb3MueTsKI2Vsc2UKZmxvYXQgbm9ybWFsU2NhbGU9MS4wOwojZW5kaWYKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpCm1hdDMgVEJOPXZUQk47CiNlbGlmIGRlZmluZWQoQlVNUCkKdmVjMiBUQk5VVj1nbF9Gcm9udEZhY2luZyA/IHZCdW1wVVYgOiAtdkJ1bXBVVjsKbWF0MyBUQk49Y290YW5nZW50X2ZyYW1lKG5vcm1hbFcqbm9ybWFsU2NhbGUsdlBvc2l0aW9uVyxUQk5VVix2VGFuZ2VudFNwYWNlUGFyYW1zKTsKI2Vsc2UKdmVjMiBUQk5VVj1nbF9Gcm9udEZhY2luZyA/IHZEZXRhaWxVViA6IC12RGV0YWlsVVY7Cm1hdDMgVEJOPWNvdGFuZ2VudF9mcmFtZShub3JtYWxXKm5vcm1hbFNjYWxlLHZQb3NpdGlvblcsVEJOVVYsdmVjMigxLiwxLikpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChBTklTT1RST1BJQykKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpCm1hdDMgVEJOPXZUQk47CiNlbHNlCnZlYzIgVEJOVVY9Z2xfRnJvbnRGYWNpbmcgPyB2TWFpblVWMSA6IC12TWFpblVWMTsKbWF0MyBUQk49Y290YW5nZW50X2ZyYW1lKG5vcm1hbFcsdlBvc2l0aW9uVyxUQk5VVix2ZWMyKDEuLDEuKSk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFBBUkFMTEFYCm1hdDMgaW52VEJOPXRyYW5zcG9zZU1hdDMoVEJOKTsKI2lmZGVmIFBBUkFMTEFYT0NDTFVTSU9OCnV2T2Zmc2V0PXBhcmFsbGF4T2NjbHVzaW9uKGludlRCTiotdmlld0RpcmVjdGlvblcsaW52VEJOKm5vcm1hbFcsdkJ1bXBVVix2QnVtcEluZm9zLnopOwojZWxzZQp1dk9mZnNldD1wYXJhbGxheE9mZnNldChpbnZUQk4qdmlld0RpcmVjdGlvblcsdkJ1bXBJbmZvcy56KTsKI2VuZGlmCiNlbmRpZgojaWZkZWYgREVUQUlMCnZlYzQgZGV0YWlsQ29sb3I9dGV4dHVyZTJEKGRldGFpbFNhbXBsZXIsdkRldGFpbFVWK3V2T2Zmc2V0KTsKdmVjMiBkZXRhaWxOb3JtYWxSRz1kZXRhaWxDb2xvci53eSoyLjAtMS4wOwpmbG9hdCBkZXRhaWxOb3JtYWxCPXNxcnQoMS4tc2F0dXJhdGUoZG90KGRldGFpbE5vcm1hbFJHLGRldGFpbE5vcm1hbFJHKSkpOwp2ZWMzIGRldGFpbE5vcm1hbD12ZWMzKGRldGFpbE5vcm1hbFJHLGRldGFpbE5vcm1hbEIpOwojZW5kaWYKI2lmZGVmIEJVTVAKI2lmZGVmIE9CSkVDVFNQQUNFX05PUk1BTE1BUApub3JtYWxXPW5vcm1hbGl6ZSh0ZXh0dXJlMkQoYnVtcFNhbXBsZXIsdkJ1bXBVVikueHl6ICoyLjAtMS4wKTsKbm9ybWFsVz1ub3JtYWxpemUobWF0Myhub3JtYWxNYXRyaXgpKm5vcm1hbFcpOwojZWxpZiAhZGVmaW5lZChERVRBSUwpCm5vcm1hbFc9cGVydHVyYk5vcm1hbChUQk4sdGV4dHVyZTJEKGJ1bXBTYW1wbGVyLHZCdW1wVVYrdXZPZmZzZXQpLnh5eix2QnVtcEluZm9zLnkpOwojZWxzZQp2ZWMzIGJ1bXBOb3JtYWw9dGV4dHVyZTJEKGJ1bXBTYW1wbGVyLHZCdW1wVVYrdXZPZmZzZXQpLnh5eioyLjAtMS4wOwojaWYgREVUQUlMX05PUk1BTEJMRU5ETUVUSE9EPT0wIApkZXRhaWxOb3JtYWwueHkqPXZEZXRhaWxJbmZvcy56Owp2ZWMzIGJsZW5kZWROb3JtYWw9bm9ybWFsaXplKHZlYzMoYnVtcE5vcm1hbC54eStkZXRhaWxOb3JtYWwueHksYnVtcE5vcm1hbC56KmRldGFpbE5vcm1hbC56KSk7CiNlbGlmIERFVEFJTF9OT1JNQUxCTEVORE1FVEhPRD09MSAKZGV0YWlsTm9ybWFsLnh5Kj12RGV0YWlsSW5mb3MuejsKYnVtcE5vcm1hbCs9dmVjMygwLjAsMC4wLDEuMCk7CmRldGFpbE5vcm1hbCo9dmVjMygtMS4wLC0xLjAsMS4wKTsKdmVjMyBibGVuZGVkTm9ybWFsPWJ1bXBOb3JtYWwqZG90KGJ1bXBOb3JtYWwsZGV0YWlsTm9ybWFsKS9idW1wTm9ybWFsLnotZGV0YWlsTm9ybWFsOwojZW5kaWYKbm9ybWFsVz1wZXJ0dXJiTm9ybWFsQmFzZShUQk4sYmxlbmRlZE5vcm1hbCx2QnVtcEluZm9zLnkpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChERVRBSUwpCmRldGFpbE5vcm1hbC54eSo9dkRldGFpbEluZm9zLno7Cm5vcm1hbFc9cGVydHVyYk5vcm1hbEJhc2UoVEJOLGRldGFpbE5vcm1hbCx2RGV0YWlsSW5mb3Mueik7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbdmhdPVRoO2NvbnN0IGJoPSJkZXB0aFByZVBhc3MiLFNoPWAjaWZkZWYgREVQVEhQUkVQQVNTCmdsX0ZyYWdDb2xvcj12ZWM0KDAuLDAuLDAuLDEuMCk7CnJldHVybjsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtiaF09U2g7Y29uc3QgeGg9ImxpZ2h0RnJhZ21lbnQiLE1oPWAjaWZkZWYgTElHSFR7WH0KI2lmIGRlZmluZWQoU0hBRE9XT05MWSkgfHwgZGVmaW5lZChMSUdIVE1BUCkgJiYgZGVmaW5lZChMSUdIVE1BUEVYQ0xVREVEe1h9KSAmJiBkZWZpbmVkKExJR0hUTUFQTk9TUEVDVUxBUntYfSkKI2Vsc2UKI2lmZGVmIFBCUgojaWZkZWYgU1BPVExJR0hUe1h9CnByZUluZm89Y29tcHV0ZVBvaW50QW5kU3BvdFByZUxpZ2h0aW5nSW5mbyhsaWdodHtYfS52TGlnaHREYXRhLHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcpOwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pCnByZUluZm89Y29tcHV0ZVBvaW50QW5kU3BvdFByZUxpZ2h0aW5nSW5mbyhsaWdodHtYfS52TGlnaHREYXRhLHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcpOwojZWxpZiBkZWZpbmVkKEhFTUlMSUdIVHtYfSkKcHJlSW5mbz1jb21wdXRlSGVtaXNwaGVyaWNQcmVMaWdodGluZ0luZm8obGlnaHR7WH0udkxpZ2h0RGF0YSx2aWV3RGlyZWN0aW9uVyxub3JtYWxXKTsKI2VsaWYgZGVmaW5lZChESVJMSUdIVHtYfSkKcHJlSW5mbz1jb21wdXRlRGlyZWN0aW9uYWxQcmVMaWdodGluZ0luZm8obGlnaHR7WH0udkxpZ2h0RGF0YSx2aWV3RGlyZWN0aW9uVyxub3JtYWxXKTsKI2VuZGlmCnByZUluZm8uTmRvdFY9TmRvdFY7CiNpZmRlZiBTUE9UTElHSFR7WH0KI2lmZGVmIExJR0hUX0ZBTExPRkZfR0xURntYfQpwcmVJbmZvLmF0dGVudWF0aW9uPWNvbXB1dGVEaXN0YW5jZUxpZ2h0RmFsbG9mZl9HTFRGKHByZUluZm8ubGlnaHREaXN0YW5jZVNxdWFyZWQsbGlnaHR7WH0udkxpZ2h0RmFsbG9mZi55KTsKcHJlSW5mby5hdHRlbnVhdGlvbio9Y29tcHV0ZURpcmVjdGlvbmFsTGlnaHRGYWxsb2ZmX0dMVEYobGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLnh5eixwcmVJbmZvLkwsbGlnaHR7WH0udkxpZ2h0RmFsbG9mZi56LGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYudyk7CiNlbGlmIGRlZmluZWQoTElHSFRfRkFMTE9GRl9QSFlTSUNBTHtYfSkKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmZfUGh5c2ljYWwocHJlSW5mby5saWdodERpc3RhbmNlU3F1YXJlZCk7CnByZUluZm8uYXR0ZW51YXRpb24qPWNvbXB1dGVEaXJlY3Rpb25hbExpZ2h0RmFsbG9mZl9QaHlzaWNhbChsaWdodHtYfS52TGlnaHREaXJlY3Rpb24ueHl6LHByZUluZm8uTCxsaWdodHtYfS52TGlnaHREaXJlY3Rpb24udyk7CiNlbGlmIGRlZmluZWQoTElHSFRfRkFMTE9GRl9TVEFOREFSRHtYfSkKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmZfU3RhbmRhcmQocHJlSW5mby5saWdodE9mZnNldCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLngpOwpwcmVJbmZvLmF0dGVudWF0aW9uKj1jb21wdXRlRGlyZWN0aW9uYWxMaWdodEZhbGxvZmZfU3RhbmRhcmQobGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLnh5eixwcmVJbmZvLkwsbGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLncsbGlnaHR7WH0udkxpZ2h0RGF0YS53KTsKI2Vsc2UKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmYocHJlSW5mby5saWdodE9mZnNldCxwcmVJbmZvLmxpZ2h0RGlzdGFuY2VTcXVhcmVkLGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYueCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLnkpOwpwcmVJbmZvLmF0dGVudWF0aW9uKj1jb21wdXRlRGlyZWN0aW9uYWxMaWdodEZhbGxvZmYobGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLnh5eixwcmVJbmZvLkwsbGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLncsbGlnaHR7WH0udkxpZ2h0RGF0YS53LGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYueixsaWdodHtYfS52TGlnaHRGYWxsb2ZmLncpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChQT0lOVExJR0hUe1h9KQojaWZkZWYgTElHSFRfRkFMTE9GRl9HTFRGe1h9CnByZUluZm8uYXR0ZW51YXRpb249Y29tcHV0ZURpc3RhbmNlTGlnaHRGYWxsb2ZmX0dMVEYocHJlSW5mby5saWdodERpc3RhbmNlU3F1YXJlZCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLnkpOwojZWxpZiBkZWZpbmVkKExJR0hUX0ZBTExPRkZfUEhZU0lDQUx7WH0pCnByZUluZm8uYXR0ZW51YXRpb249Y29tcHV0ZURpc3RhbmNlTGlnaHRGYWxsb2ZmX1BoeXNpY2FsKHByZUluZm8ubGlnaHREaXN0YW5jZVNxdWFyZWQpOwojZWxpZiBkZWZpbmVkKExJR0hUX0ZBTExPRkZfU1RBTkRBUkR7WH0pCnByZUluZm8uYXR0ZW51YXRpb249Y29tcHV0ZURpc3RhbmNlTGlnaHRGYWxsb2ZmX1N0YW5kYXJkKHByZUluZm8ubGlnaHRPZmZzZXQsbGlnaHR7WH0udkxpZ2h0RmFsbG9mZi54KTsKI2Vsc2UKcHJlSW5mby5hdHRlbnVhdGlvbj1jb21wdXRlRGlzdGFuY2VMaWdodEZhbGxvZmYocHJlSW5mby5saWdodE9mZnNldCxwcmVJbmZvLmxpZ2h0RGlzdGFuY2VTcXVhcmVkLGxpZ2h0e1h9LnZMaWdodEZhbGxvZmYueCxsaWdodHtYfS52TGlnaHRGYWxsb2ZmLnkpOwojZW5kaWYKI2Vsc2UKcHJlSW5mby5hdHRlbnVhdGlvbj0xLjA7CiNlbmRpZgojaWZkZWYgSEVNSUxJR0hUe1h9CnByZUluZm8ucm91Z2huZXNzPXJvdWdobmVzczsKI2Vsc2UKcHJlSW5mby5yb3VnaG5lc3M9YWRqdXN0Um91Z2huZXNzRnJvbUxpZ2h0UHJvcGVydGllcyhyb3VnaG5lc3MsbGlnaHR7WH0udkxpZ2h0U3BlY3VsYXIuYSxwcmVJbmZvLmxpZ2h0RGlzdGFuY2UpOwojZW5kaWYKI2lmZGVmIElSSURFU0NFTkNFCnByZUluZm8uaXJpZGVzY2VuY2VJbnRlbnNpdHk9aXJpZGVzY2VuY2VJbnRlbnNpdHk7CiNlbmRpZgojaWZkZWYgSEVNSUxJR0hUe1h9CmluZm8uZGlmZnVzZT1jb21wdXRlSGVtaXNwaGVyaWNEaWZmdXNlTGlnaHRpbmcocHJlSW5mbyxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYixsaWdodHtYfS52TGlnaHRHcm91bmQpOwojZWxpZiBkZWZpbmVkKFNTX1RSQU5TTFVDRU5DWSkKaW5mby5kaWZmdXNlPWNvbXB1dGVEaWZmdXNlQW5kVHJhbnNtaXR0ZWRMaWdodGluZyhwcmVJbmZvLGxpZ2h0e1h9LnZMaWdodERpZmZ1c2UucmdiLHN1YlN1cmZhY2VPdXQudHJhbnNtaXR0YW5jZSk7CiNlbHNlCmluZm8uZGlmZnVzZT1jb21wdXRlRGlmZnVzZUxpZ2h0aW5nKHByZUluZm8sbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5yZ2IpOwojZW5kaWYKI2lmZGVmIFNQRUNVTEFSVEVSTQojaWZkZWYgQU5JU09UUk9QSUMKaW5mby5zcGVjdWxhcj1jb21wdXRlQW5pc290cm9waWNTcGVjdWxhckxpZ2h0aW5nKHByZUluZm8sdmlld0RpcmVjdGlvblcsbm9ybWFsVyxhbmlzb3Ryb3BpY091dC5hbmlzb3Ryb3BpY1RhbmdlbnQsYW5pc290cm9waWNPdXQuYW5pc290cm9waWNCaXRhbmdlbnQsYW5pc290cm9waWNPdXQuYW5pc290cm9weSxjbGVhcmNvYXRPdXQuc3BlY3VsYXJFbnZpcm9ubWVudFIwLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsQUFSb3VnaG5lc3NGYWN0b3JzLngsbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5yZ2IpOwojZWxzZQppbmZvLnNwZWN1bGFyPWNvbXB1dGVTcGVjdWxhckxpZ2h0aW5nKHByZUluZm8sbm9ybWFsVyxjbGVhcmNvYXRPdXQuc3BlY3VsYXJFbnZpcm9ubWVudFIwLHNwZWN1bGFyRW52aXJvbm1lbnRSOTAsQUFSb3VnaG5lc3NGYWN0b3JzLngsbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5yZ2IpOwojZW5kaWYKI2VuZGlmCiNpZmRlZiBTSEVFTgojaWZkZWYgU0hFRU5fTElOS1dJVEhBTEJFRE8KcHJlSW5mby5yb3VnaG5lc3M9c2hlZW5PdXQuc2hlZW5JbnRlbnNpdHk7CiNlbHNlCiNpZmRlZiBIRU1JTElHSFR7WH0KcHJlSW5mby5yb3VnaG5lc3M9c2hlZW5PdXQuc2hlZW5Sb3VnaG5lc3M7CiNlbHNlCnByZUluZm8ucm91Z2huZXNzPWFkanVzdFJvdWdobmVzc0Zyb21MaWdodFByb3BlcnRpZXMoc2hlZW5PdXQuc2hlZW5Sb3VnaG5lc3MsbGlnaHR7WH0udkxpZ2h0U3BlY3VsYXIuYSxwcmVJbmZvLmxpZ2h0RGlzdGFuY2UpOwojZW5kaWYKI2VuZGlmCmluZm8uc2hlZW49Y29tcHV0ZVNoZWVuTGlnaHRpbmcocHJlSW5mbyxub3JtYWxXLHNoZWVuT3V0LnNoZWVuQ29sb3Isc3BlY3VsYXJFbnZpcm9ubWVudFI5MCxBQVJvdWdobmVzc0ZhY3RvcnMueCxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYik7CiNlbmRpZgojaWZkZWYgQ0xFQVJDT0FUCiNpZmRlZiBIRU1JTElHSFR7WH0KcHJlSW5mby5yb3VnaG5lc3M9Y2xlYXJjb2F0T3V0LmNsZWFyQ29hdFJvdWdobmVzczsKI2Vsc2UKcHJlSW5mby5yb3VnaG5lc3M9YWRqdXN0Um91Z2huZXNzRnJvbUxpZ2h0UHJvcGVydGllcyhjbGVhcmNvYXRPdXQuY2xlYXJDb2F0Um91Z2huZXNzLGxpZ2h0e1h9LnZMaWdodFNwZWN1bGFyLmEscHJlSW5mby5saWdodERpc3RhbmNlKTsKI2VuZGlmCmluZm8uY2xlYXJDb2F0PWNvbXB1dGVDbGVhckNvYXRMaWdodGluZyhwcmVJbmZvLGNsZWFyY29hdE91dC5jbGVhckNvYXROb3JtYWxXLGNsZWFyY29hdE91dC5jbGVhckNvYXRBQVJvdWdobmVzc0ZhY3RvcnMueCxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0SW50ZW5zaXR5LGxpZ2h0e1h9LnZMaWdodERpZmZ1c2UucmdiKTsKI2lmZGVmIENMRUFSQ09BVF9USU5UCmFic29ycHRpb249Y29tcHV0ZUNsZWFyQ29hdExpZ2h0aW5nQWJzb3JwdGlvbihjbGVhcmNvYXRPdXQuY2xlYXJDb2F0TmRvdFZSZWZyYWN0LHByZUluZm8uTCxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0Tm9ybWFsVyxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0Q29sb3IsY2xlYXJjb2F0T3V0LmNsZWFyQ29hdFRoaWNrbmVzcyxjbGVhcmNvYXRPdXQuY2xlYXJDb2F0SW50ZW5zaXR5KTsKaW5mby5kaWZmdXNlKj1hYnNvcnB0aW9uOwojaWZkZWYgU1BFQ1VMQVJURVJNCmluZm8uc3BlY3VsYXIqPWFic29ycHRpb247CiNlbmRpZgojZW5kaWYKaW5mby5kaWZmdXNlKj1pbmZvLmNsZWFyQ29hdC53OwojaWZkZWYgU1BFQ1VMQVJURVJNCmluZm8uc3BlY3VsYXIqPWluZm8uY2xlYXJDb2F0Lnc7CiNlbmRpZgojaWZkZWYgU0hFRU4KaW5mby5zaGVlbio9aW5mby5jbGVhckNvYXQudzsKI2VuZGlmCiNlbmRpZgojZWxzZQojaWZkZWYgU1BPVExJR0hUe1h9CmluZm89Y29tcHV0ZVNwb3RMaWdodGluZyh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLGxpZ2h0e1h9LnZMaWdodERhdGEsbGlnaHR7WH0udkxpZ2h0RGlyZWN0aW9uLGxpZ2h0e1h9LnZMaWdodERpZmZ1c2UucmdiLGxpZ2h0e1h9LnZMaWdodFNwZWN1bGFyLnJnYixsaWdodHtYfS52TGlnaHREaWZmdXNlLmEsZ2xvc3NpbmVzcyk7CiNlbGlmIGRlZmluZWQoSEVNSUxJR0hUe1h9KQppbmZvPWNvbXB1dGVIZW1pc3BoZXJpY0xpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsbGlnaHR7WH0udkxpZ2h0RGF0YSxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYixsaWdodHtYfS52TGlnaHRTcGVjdWxhci5yZ2IsbGlnaHR7WH0udkxpZ2h0R3JvdW5kLGdsb3NzaW5lc3MpOwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pIHx8IGRlZmluZWQoRElSTElHSFR7WH0pCmluZm89Y29tcHV0ZUxpZ2h0aW5nKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsbGlnaHR7WH0udkxpZ2h0RGF0YSxsaWdodHtYfS52TGlnaHREaWZmdXNlLnJnYixsaWdodHtYfS52TGlnaHRTcGVjdWxhci5yZ2IsbGlnaHR7WH0udkxpZ2h0RGlmZnVzZS5hLGdsb3NzaW5lc3MpOwojZW5kaWYKI2VuZGlmCiNpZmRlZiBQUk9KRUNURURMSUdIVFRFWFRVUkV7WH0KaW5mby5kaWZmdXNlKj1jb21wdXRlUHJvamVjdGlvblRleHR1cmVEaWZmdXNlTGlnaHRpbmcocHJvamVjdGlvbkxpZ2h0U2FtcGxlcntYfSx0ZXh0dXJlUHJvamVjdGlvbk1hdHJpeHtYfSk7CiNlbmRpZgojZW5kaWYKI2lmZGVmIFNIQURPV3tYfQojaWZkZWYgU0hBRE9XQ1NNe1h9CmZvciAoaW50IGk9MDsgaTxTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH07IGkrKykgCnsKI2lmZGVmIFNIQURPV0NTTV9SSUdIVEhBTkRFRHtYfQpkaWZme1h9PXZpZXdGcnVzdHVtWntYfVtpXSt2UG9zaXRpb25Gcm9tQ2FtZXJhe1h9Lno7CiNlbHNlCmRpZmZ7WH09dmlld0ZydXN0dW1ae1h9W2ldLXZQb3NpdGlvbkZyb21DYW1lcmF7WH0uejsKI2VuZGlmCmlmIChkaWZme1h9Pj0wLikgewppbmRleHtYfT1pOwpicmVhazsKfQp9CiNpZmRlZiBTSEFET1dDU01VU0VTSEFET1dNQVhae1h9CmlmIChpbmRleHtYfT49MCkKI2VuZGlmCnsKI2lmIGRlZmluZWQoU0hBRE9XUENGe1h9KQojaWYgZGVmaW5lZChTSEFET1dMT1dRVUFMSVRZe1h9KQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ0YxKGZsb2F0KGluZGV4e1h9KSx2UG9zaXRpb25Gcm9tTGlnaHR7WH1baW5kZXh7WH1dLHZEZXB0aE1ldHJpY3tYfVtpbmRleHtYfV0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDRjMoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbHNlCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDRjUoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCiNpZiBkZWZpbmVkKFNIQURPV0xPV1FVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDU1MxNihmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncsbGlnaHRTaXplVVZDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxkZXB0aENvcnJlY3Rpb257WH1baW5kZXh7WH1dLHBlbnVtYnJhRGFya25lc3N7WH0pOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDU1MzMihmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncsbGlnaHRTaXplVVZDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxkZXB0aENvcnJlY3Rpb257WH1baW5kZXh7WH1dLHBlbnVtYnJhRGFya25lc3N7WH0pOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTNjQoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53LGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtpbmRleHtYfV0sZGVwdGhDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxwZW51bWJyYURhcmtuZXNze1h9KTsKI2VuZGlmCiNlbHNlCnNoYWRvdz1jb21wdXRlU2hhZG93Q1NNKGZsb2F0KGluZGV4e1h9KSx2UG9zaXRpb25Gcm9tTGlnaHR7WH1baW5kZXh7WH1dLHZEZXB0aE1ldHJpY3tYfVtpbmRleHtYfV0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZW5kaWYKI2lmZGVmIFNIQURPV0NTTURFQlVHe1h9CnNoYWRvd0RlYnVne1h9PXZlYzMoc2hhZG93KSp2Q2FzY2FkZUNvbG9yc011bHRpcGxpZXJ7WH1baW5kZXh7WH1dOwojZW5kaWYKI2lmbmRlZiBTSEFET1dDU01OT0JMRU5Ee1h9CmZsb2F0IGZydXN0dW1MZW5ndGg9ZnJ1c3R1bUxlbmd0aHN7WH1baW5kZXh7WH1dOwpmbG9hdCBkaWZmUmF0aW89Y2xhbXAoZGlmZntYfS9mcnVzdHVtTGVuZ3RoLDAuLDEuKSpjYXNjYWRlQmxlbmRGYWN0b3J7WH07CmlmIChpbmRleHtYfTwoU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9LTEpICYmIGRpZmZSYXRpbzwxLikKewppbmRleHtYfSs9MTsKZmxvYXQgbmV4dFNoYWRvdz0wLjsKI2lmIGRlZmluZWQoU0hBRE9XUENGe1h9KQojaWYgZGVmaW5lZChTSEFET1dMT1dRVUFMSVRZe1h9KQpuZXh0U2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ1NNUENGMShmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VsaWYgZGVmaW5lZChTSEFET1dNRURJVU1RVUFMSVRZe1h9KQpuZXh0U2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ1NNUENGMyhmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueXosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2Vsc2UKbmV4dFNoYWRvdz1jb21wdXRlU2hhZG93V2l0aENTTVBDRjUoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCiNpZiBkZWZpbmVkKFNIQURPV0xPV1FVQUxJVFl7WH0pCm5leHRTaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTMTYoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53LGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtpbmRleHtYfV0sZGVwdGhDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxwZW51bWJyYURhcmtuZXNze1h9KTsKI2VsaWYgZGVmaW5lZChTSEFET1dNRURJVU1RVUFMSVRZe1h9KQpuZXh0U2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ1NNUENTUzMyKGZsb2F0KGluZGV4e1h9KSx2UG9zaXRpb25Gcm9tTGlnaHR7WH1baW5kZXh7WH1dLHZEZXB0aE1ldHJpY3tYfVtpbmRleHtYfV0sZGVwdGhTYW1wbGVye1h9LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueSxsaWdodHtYfS5zaGFkb3dzSW5mby56LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyxsaWdodFNpemVVVkNvcnJlY3Rpb257WH1baW5kZXh7WH1dLGRlcHRoQ29ycmVjdGlvbntYfVtpbmRleHtYfV0scGVudW1icmFEYXJrbmVzc3tYfSk7CiNlbHNlCm5leHRTaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhDU01QQ1NTNjQoZmxvYXQoaW5kZXh7WH0pLHZQb3NpdGlvbkZyb21MaWdodHtYfVtpbmRleHtYfV0sdkRlcHRoTWV0cmlje1h9W2luZGV4e1h9XSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53LGxpZ2h0U2l6ZVVWQ29ycmVjdGlvbntYfVtpbmRleHtYfV0sZGVwdGhDb3JyZWN0aW9ue1h9W2luZGV4e1h9XSxwZW51bWJyYURhcmtuZXNze1h9KTsKI2VuZGlmCiNlbHNlCm5leHRTaGFkb3c9Y29tcHV0ZVNoYWRvd0NTTShmbG9hdChpbmRleHtYfSksdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2luZGV4e1h9XSx2RGVwdGhNZXRyaWN7WH1baW5kZXh7WH1dLHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCnNoYWRvdz1taXgobmV4dFNoYWRvdyxzaGFkb3csZGlmZlJhdGlvKTsKI2lmZGVmIFNIQURPV0NTTURFQlVHe1h9CnNoYWRvd0RlYnVne1h9PW1peCh2ZWMzKG5leHRTaGFkb3cpKnZDYXNjYWRlQ29sb3JzTXVsdGlwbGllcntYfVtpbmRleHtYfV0sc2hhZG93RGVidWd7WH0sZGlmZlJhdGlvKTsKI2VuZGlmCn0KI2VuZGlmCn0KI2VsaWYgZGVmaW5lZChTSEFET1dDTE9TRUVTTXtYfSkKI2lmIGRlZmluZWQoU0hBRE9XQ1VCRXtYfSkKc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ2xvc2VFU01DdWJlKGxpZ2h0e1h9LnZMaWdodERhdGEueHl6LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby56LGxpZ2h0e1h9LmRlcHRoVmFsdWVzKTsKI2Vsc2UKc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoQ2xvc2VFU00odlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbGlmIGRlZmluZWQoU0hBRE9XRVNNe1h9KQojaWYgZGVmaW5lZChTSEFET1dDVUJFe1h9KQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhFU01DdWJlKGxpZ2h0e1h9LnZMaWdodERhdGEueHl6LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby56LGxpZ2h0e1h9LmRlcHRoVmFsdWVzKTsKI2Vsc2UKc2hhZG93PWNvbXB1dGVTaGFkb3dXaXRoRVNNKHZQb3NpdGlvbkZyb21MaWdodHtYfSx2RGVwdGhNZXRyaWN7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BPSVNTT057WH0pCiNpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBvaXNzb25TYW1wbGluZ0N1YmUobGlnaHR7WH0udkxpZ2h0RGF0YS54eXosc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uZGVwdGhWYWx1ZXMpOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQb2lzc29uU2FtcGxpbmcodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbGlmIGRlZmluZWQoU0hBRE9XUENGe1h9KQojaWYgZGVmaW5lZChTSEFET1dMT1dRVUFMSVRZe1h9KQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQQ0YxKHZQb3NpdGlvbkZyb21MaWdodHtYfSx2RGVwdGhNZXRyaWN7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDRjModlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbHNlCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDRjUodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnl6LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uc2hhZG93c0luZm8udyk7CiNlbmRpZgojZWxpZiBkZWZpbmVkKFNIQURPV1BDU1N7WH0pCiNpZiBkZWZpbmVkKFNIQURPV0xPV1FVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDU1MxNih2UG9zaXRpb25Gcm9tTGlnaHR7WH0sdkRlcHRoTWV0cmlje1h9LGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxpZiBkZWZpbmVkKFNIQURPV01FRElVTVFVQUxJVFl7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93V2l0aFBDU1MzMih2UG9zaXRpb25Gcm9tTGlnaHR7WH0sdkRlcHRoTWV0cmlje1h9LGRlcHRoU2FtcGxlcntYfSxzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnksbGlnaHR7WH0uc2hhZG93c0luZm8ueixsaWdodHtYfS5zaGFkb3dzSW5mby54LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLncpOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvd1dpdGhQQ1NTNjQodlBvc2l0aW9uRnJvbUxpZ2h0e1h9LHZEZXB0aE1ldHJpY3tYfSxkZXB0aFNhbXBsZXJ7WH0sc2hhZG93U2FtcGxlcntYfSxsaWdodHtYfS5zaGFkb3dzSW5mby55LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLnosbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbHNlCiNpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCnNoYWRvdz1jb21wdXRlU2hhZG93Q3ViZShsaWdodHtYfS52TGlnaHREYXRhLnh5eixzaGFkb3dTYW1wbGVye1h9LGxpZ2h0e1h9LnNoYWRvd3NJbmZvLngsbGlnaHR7WH0uZGVwdGhWYWx1ZXMpOwojZWxzZQpzaGFkb3c9Y29tcHV0ZVNoYWRvdyh2UG9zaXRpb25Gcm9tTGlnaHR7WH0sdkRlcHRoTWV0cmlje1h9LHNoYWRvd1NhbXBsZXJ7WH0sbGlnaHR7WH0uc2hhZG93c0luZm8ueCxsaWdodHtYfS5zaGFkb3dzSW5mby53KTsKI2VuZGlmCiNlbmRpZgojaWZkZWYgU0hBRE9XT05MWQojaWZuZGVmIFNIQURPV0lOVVNFCiNkZWZpbmUgU0hBRE9XSU5VU0UKI2VuZGlmCmdsb2JhbFNoYWRvdys9c2hhZG93OwpzaGFkb3dMaWdodENvdW50Kz0xLjA7CiNlbmRpZgojZWxzZQpzaGFkb3c9MS47CiNlbmRpZgojaWZuZGVmIFNIQURPV09OTFkKI2lmZGVmIENVU1RPTVVTRVJMSUdIVElORwpkaWZmdXNlQmFzZSs9Y29tcHV0ZUN1c3RvbURpZmZ1c2VMaWdodGluZyhpbmZvLGRpZmZ1c2VCYXNlLHNoYWRvdyk7CiNpZmRlZiBTUEVDVUxBUlRFUk0Kc3BlY3VsYXJCYXNlKz1jb21wdXRlQ3VzdG9tU3BlY3VsYXJMaWdodGluZyhpbmZvLHNwZWN1bGFyQmFzZSxzaGFkb3cpOwojZW5kaWYKI2VsaWYgZGVmaW5lZChMSUdIVE1BUCkgJiYgZGVmaW5lZChMSUdIVE1BUEVYQ0xVREVEe1h9KQpkaWZmdXNlQmFzZSs9bGlnaHRtYXBDb2xvci5yZ2Iqc2hhZG93OwojaWZkZWYgU1BFQ1VMQVJURVJNCiNpZm5kZWYgTElHSFRNQVBOT1NQRUNVTEFSe1h9CnNwZWN1bGFyQmFzZSs9aW5mby5zcGVjdWxhcipzaGFkb3cqbGlnaHRtYXBDb2xvci5yZ2I7CiNlbmRpZgojZW5kaWYKI2lmZGVmIENMRUFSQ09BVAojaWZuZGVmIExJR0hUTUFQTk9TUEVDVUxBUntYfQpjbGVhckNvYXRCYXNlKz1pbmZvLmNsZWFyQ29hdC5yZ2Iqc2hhZG93KmxpZ2h0bWFwQ29sb3IucmdiOwojZW5kaWYKI2VuZGlmCiNpZmRlZiBTSEVFTgojaWZuZGVmIExJR0hUTUFQTk9TUEVDVUxBUntYfQpzaGVlbkJhc2UrPWluZm8uc2hlZW4ucmdiKnNoYWRvdzsKI2VuZGlmCiNlbmRpZgojZWxzZQojaWZkZWYgU0hBRE9XQ1NNREVCVUd7WH0KZGlmZnVzZUJhc2UrPWluZm8uZGlmZnVzZSpzaGFkb3dEZWJ1Z3tYfTsKI2Vsc2UgCmRpZmZ1c2VCYXNlKz1pbmZvLmRpZmZ1c2Uqc2hhZG93OwojZW5kaWYKI2lmZGVmIFNQRUNVTEFSVEVSTQpzcGVjdWxhckJhc2UrPWluZm8uc3BlY3VsYXIqc2hhZG93OwojZW5kaWYKI2lmZGVmIENMRUFSQ09BVApjbGVhckNvYXRCYXNlKz1pbmZvLmNsZWFyQ29hdC5yZ2Iqc2hhZG93OwojZW5kaWYKI2lmZGVmIFNIRUVOCnNoZWVuQmFzZSs9aW5mby5zaGVlbi5yZ2Iqc2hhZG93OwojZW5kaWYKI2VuZGlmCiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3hoXT1NaDtjb25zdCBBaD0ibG9nRGVwdGhGcmFnbWVudCIsUmg9YCNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICmdsX0ZyYWdEZXB0aEVYVD1sb2cyKHZGcmFnbWVudERlcHRoKSpsb2dhcml0aG1pY0RlcHRoQ29uc3RhbnQqMC41OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0FoXT1SaDtjb25zdCB5aD0iZm9nRnJhZ21lbnQiLENoPWAjaWZkZWYgRk9HCmZsb2F0IGZvZz1DYWxjRm9nRmFjdG9yKCk7CiNpZmRlZiBQQlIKZm9nPXRvTGluZWFyU3BhY2UoZm9nKTsKI2VuZGlmCmNvbG9yLnJnYj1taXgodkZvZ0NvbG9yLGNvbG9yLnJnYixmb2cpOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3loXT1DaDtjb25zdCBJaD0ib2l0RnJhZ21lbnQiLFBoPWAjaWZkZWYgT1JERVJfSU5ERVBFTkRFTlRfVFJBTlNQQVJFTkNZCmZsb2F0IGZyYWdEZXB0aD1nbF9GcmFnQ29vcmQuejsgCiNpZmRlZiBPUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1lfMTZCSVRTCnVpbnQgaGFsZkZsb2F0PXBhY2tIYWxmMngxNih2ZWMyKGZyYWdEZXB0aCkpOwp2ZWMyIGZ1bGw9dW5wYWNrSGFsZjJ4MTYoaGFsZkZsb2F0KTsKZnJhZ0RlcHRoPWZ1bGwueDsKI2VuZGlmCml2ZWMyIGZyYWdDb29yZD1pdmVjMihnbF9GcmFnQ29vcmQueHkpOwp2ZWMyIGxhc3REZXB0aD10ZXhlbEZldGNoKG9pdERlcHRoU2FtcGxlcixmcmFnQ29vcmQsMCkucmc7CnZlYzQgbGFzdEZyb250Q29sb3I9dGV4ZWxGZXRjaChvaXRGcm9udENvbG9yU2FtcGxlcixmcmFnQ29vcmQsMCk7CmRlcHRoLnJnPXZlYzIoLU1BWF9ERVBUSCk7CmZyb250Q29sb3I9bGFzdEZyb250Q29sb3I7CmJhY2tDb2xvcj12ZWM0KDAuMCk7CiNpZmRlZiBVU0VfUkVWRVJTRV9ERVBUSEJVRkZFUgpmbG9hdCBmdXJ0aGVzdERlcHRoPS1sYXN0RGVwdGgueDsKZmxvYXQgbmVhcmVzdERlcHRoPWxhc3REZXB0aC55OwojZWxzZQpmbG9hdCBuZWFyZXN0RGVwdGg9LWxhc3REZXB0aC54OwpmbG9hdCBmdXJ0aGVzdERlcHRoPWxhc3REZXB0aC55OwojZW5kaWYKZmxvYXQgYWxwaGFNdWx0aXBsaWVyPTEuMC1sYXN0RnJvbnRDb2xvci5hOwojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKaWYgKGZyYWdEZXB0aD5uZWFyZXN0RGVwdGggfHwgZnJhZ0RlcHRoPGZ1cnRoZXN0RGVwdGgpIHsKI2Vsc2UKaWYgKGZyYWdEZXB0aDxuZWFyZXN0RGVwdGggfHwgZnJhZ0RlcHRoPmZ1cnRoZXN0RGVwdGgpIHsKI2VuZGlmCnJldHVybjsKfQojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKaWYgKGZyYWdEZXB0aDxuZWFyZXN0RGVwdGggJiYgZnJhZ0RlcHRoPmZ1cnRoZXN0RGVwdGgpIHsKI2Vsc2UKaWYgKGZyYWdEZXB0aD5uZWFyZXN0RGVwdGggJiYgZnJhZ0RlcHRoPGZ1cnRoZXN0RGVwdGgpIHsKI2VuZGlmCmRlcHRoLnJnPXZlYzIoLWZyYWdEZXB0aCxmcmFnRGVwdGgpOwpyZXR1cm47Cn0KI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtJaF09UGg7Y29uc3QgRGg9ImRlZmF1bHRQaXhlbFNoYWRlciIsRmg9YCNpbmNsdWRlPF9fZGVjbF9fZGVmYXVsdEZyYWdtZW50PgojaWYgZGVmaW5lZChCVU1QKSB8fCAhZGVmaW5lZChOT1JNQUwpCiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlCiNlbmRpZgojaW5jbHVkZTxwcmVQYXNzRGVjbGFyYXRpb24+W1NDRU5FX01SVF9DT1VOVF0KI2luY2x1ZGU8b2l0RGVjbGFyYXRpb24+CiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFR0lOCiNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICiNleHRlbnNpb24gR0xfRVhUX2ZyYWdfZGVwdGggOiBlbmFibGUKI2VuZGlmCiNkZWZpbmUgUkVDSVBST0NBTF9QSTIgMC4xNTkxNTQ5NAp2YXJ5aW5nIHZlYzMgdlBvc2l0aW9uVzsKI2lmZGVmIE5PUk1BTAp2YXJ5aW5nIHZlYzMgdk5vcm1hbFc7CiNlbmRpZgojaWYgZGVmaW5lZChWRVJURVhDT0xPUikgfHwgZGVmaW5lZChJTlNUQU5DRVNDT0xPUikgJiYgZGVmaW5lZChJTlNUQU5DRVMpCnZhcnlpbmcgdmVjNCB2Q29sb3I7CiNlbmRpZgojaW5jbHVkZTxtYWluVVZWYXJ5aW5nRGVjbGFyYXRpb24+WzEuLjddCiNpbmNsdWRlPGhlbHBlckZ1bmN0aW9ucz4KI2luY2x1ZGU8X19kZWNsX19saWdodEZyYWdtZW50PlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdCiNpbmNsdWRlPGxpZ2h0c0ZyYWdtZW50RnVuY3Rpb25zPgojaW5jbHVkZTxzaGFkb3dzRnJhZ21lbnRGdW5jdGlvbnM+CiNpbmNsdWRlPHNhbXBsZXJGcmFnbWVudERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sRElGRlVTRSxfVkFSWUlOR05BTUVfLERpZmZ1c2UsX1NBTVBMRVJOQU1FXyxkaWZmdXNlKQojaW5jbHVkZTxzYW1wbGVyRnJhZ21lbnREZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLEFNQklFTlQsX1ZBUllJTkdOQU1FXyxBbWJpZW50LF9TQU1QTEVSTkFNRV8sYW1iaWVudCkKI2luY2x1ZGU8c2FtcGxlckZyYWdtZW50RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxPUEFDSVRZLF9WQVJZSU5HTkFNRV8sT3BhY2l0eSxfU0FNUExFUk5BTUVfLG9wYWNpdHkpCiNpbmNsdWRlPHNhbXBsZXJGcmFnbWVudERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sRU1JU1NJVkUsX1ZBUllJTkdOQU1FXyxFbWlzc2l2ZSxfU0FNUExFUk5BTUVfLGVtaXNzaXZlKQojaW5jbHVkZTxzYW1wbGVyRnJhZ21lbnREZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLExJR0hUTUFQLF9WQVJZSU5HTkFNRV8sTGlnaHRtYXAsX1NBTVBMRVJOQU1FXyxsaWdodG1hcCkKI2lmZGVmIFJFRlJBQ1RJT04KI2lmZGVmIFJFRlJBQ1RJT05NQVBfM0QKdW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZyYWN0aW9uQ3ViZVNhbXBsZXI7CiNlbHNlCnVuaWZvcm0gc2FtcGxlcjJEIHJlZnJhY3Rpb24yRFNhbXBsZXI7CiNlbmRpZgojZW5kaWYKI2lmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQojaW5jbHVkZTxzYW1wbGVyRnJhZ21lbnREZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLFNQRUNVTEFSLF9WQVJZSU5HTkFNRV8sU3BlY3VsYXIsX1NBTVBMRVJOQU1FXyxzcGVjdWxhcikKI2VuZGlmCiNpbmNsdWRlPGZyZXNuZWxGdW5jdGlvbj4KI2lmZGVmIFJFRkxFQ1RJT04KI2lmZGVmIFJFRkxFQ1RJT05NQVBfM0QKdW5pZm9ybSBzYW1wbGVyQ3ViZSByZWZsZWN0aW9uQ3ViZVNhbXBsZXI7CiNlbHNlCnVuaWZvcm0gc2FtcGxlcjJEIHJlZmxlY3Rpb24yRFNhbXBsZXI7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1gKdmFyeWluZyB2ZWMzIHZQb3NpdGlvblVWVzsKI2Vsc2UKI2lmIGRlZmluZWQoUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRUQpIHx8IGRlZmluZWQoUkVGTEVDVElPTk1BUF9NSVJST1JFREVRVUlSRUNUQU5HVUxBUl9GSVhFRCkKdmFyeWluZyB2ZWMzIHZEaXJlY3Rpb25XOwojZW5kaWYKI2VuZGlmCiNpbmNsdWRlPHJlZmxlY3Rpb25GdW5jdGlvbj4KI2VuZGlmCiNpbmNsdWRlPGltYWdlUHJvY2Vzc2luZ0RlY2xhcmF0aW9uPgojaW5jbHVkZTxpbWFnZVByb2Nlc3NpbmdGdW5jdGlvbnM+CiNpbmNsdWRlPGJ1bXBGcmFnbWVudE1haW5GdW5jdGlvbnM+CiNpbmNsdWRlPGJ1bXBGcmFnbWVudEZ1bmN0aW9ucz4KI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnREZWNsYXJhdGlvbj4KI2luY2x1ZGU8bG9nRGVwdGhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8Zm9nRnJhZ21lbnREZWNsYXJhdGlvbj4KI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfTUFJTl9CRUdJTgojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD4KdmVjMyB2aWV3RGlyZWN0aW9uVz1ub3JtYWxpemUodkV5ZVBvc2l0aW9uLnh5ei12UG9zaXRpb25XKTsKdmVjNCBiYXNlQ29sb3I9dmVjNCgxLiwxLiwxLiwxLik7CnZlYzMgZGlmZnVzZUNvbG9yPXZEaWZmdXNlQ29sb3IucmdiOwpmbG9hdCBhbHBoYT12RGlmZnVzZUNvbG9yLmE7CiNpZmRlZiBOT1JNQUwKdmVjMyBub3JtYWxXPW5vcm1hbGl6ZSh2Tm9ybWFsVyk7CiNlbHNlCnZlYzMgbm9ybWFsVz1ub3JtYWxpemUoLWNyb3NzKGRGZHgodlBvc2l0aW9uVyksZEZkeSh2UG9zaXRpb25XKSkpOwojZW5kaWYKI2luY2x1ZGU8YnVtcEZyYWdtZW50PgojaWZkZWYgVFdPU0lERURMSUdIVElORwpub3JtYWxXPWdsX0Zyb250RmFjaW5nID8gbm9ybWFsVyA6IC1ub3JtYWxXOwojZW5kaWYKI2lmZGVmIERJRkZVU0UKYmFzZUNvbG9yPXRleHR1cmUyRChkaWZmdXNlU2FtcGxlcix2RGlmZnVzZVVWK3V2T2Zmc2V0KTsKI2lmIGRlZmluZWQoQUxQSEFURVNUKSAmJiAhZGVmaW5lZChBTFBIQVRFU1RfQUZURVJBTExBTFBIQUNPTVBVVEFUSU9OUykKaWYgKGJhc2VDb2xvci5hPGFscGhhQ3V0T2ZmKQpkaXNjYXJkOwojZW5kaWYKI2lmZGVmIEFMUEhBRlJPTURJRkZVU0UKYWxwaGEqPWJhc2VDb2xvci5hOwojZW5kaWYKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfVVBEQVRFX0FMUEhBCmJhc2VDb2xvci5yZ2IqPXZEaWZmdXNlSW5mb3MueTsKI2VuZGlmCiNpbmNsdWRlPGRlcHRoUHJlUGFzcz4KI2lmIGRlZmluZWQoVkVSVEVYQ09MT1IpIHx8IGRlZmluZWQoSU5TVEFOQ0VTQ09MT1IpICYmIGRlZmluZWQoSU5TVEFOQ0VTKQpiYXNlQ29sb3IucmdiKj12Q29sb3IucmdiOwojZW5kaWYKI2lmZGVmIERFVEFJTApiYXNlQ29sb3IucmdiPWJhc2VDb2xvci5yZ2IqMi4wKm1peCgwLjUsZGV0YWlsQ29sb3Iucix2RGV0YWlsSW5mb3MueSk7CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9VUERBVEVfRElGRlVTRQp2ZWMzIGJhc2VBbWJpZW50Q29sb3I9dmVjMygxLiwxLiwxLik7CiNpZmRlZiBBTUJJRU5UCmJhc2VBbWJpZW50Q29sb3I9dGV4dHVyZTJEKGFtYmllbnRTYW1wbGVyLHZBbWJpZW50VVYrdXZPZmZzZXQpLnJnYip2QW1iaWVudEluZm9zLnk7CiNlbmRpZgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9CRUZPUkVfTElHSFRTCiNpZmRlZiBTUEVDVUxBUlRFUk0KZmxvYXQgZ2xvc3NpbmVzcz12U3BlY3VsYXJDb2xvci5hOwp2ZWMzIHNwZWN1bGFyQ29sb3I9dlNwZWN1bGFyQ29sb3IucmdiOwojaWZkZWYgU1BFQ1VMQVIKdmVjNCBzcGVjdWxhck1hcENvbG9yPXRleHR1cmUyRChzcGVjdWxhclNhbXBsZXIsdlNwZWN1bGFyVVYrdXZPZmZzZXQpOwpzcGVjdWxhckNvbG9yPXNwZWN1bGFyTWFwQ29sb3IucmdiOwojaWZkZWYgR0xPU1NJTkVTUwpnbG9zc2luZXNzPWdsb3NzaW5lc3Mqc3BlY3VsYXJNYXBDb2xvci5hOwojZW5kaWYKI2VuZGlmCiNlbHNlCmZsb2F0IGdsb3NzaW5lc3M9MC47CiNlbmRpZgp2ZWMzIGRpZmZ1c2VCYXNlPXZlYzMoMC4sMC4sMC4pOwpsaWdodGluZ0luZm8gaW5mbzsKI2lmZGVmIFNQRUNVTEFSVEVSTQp2ZWMzIHNwZWN1bGFyQmFzZT12ZWMzKDAuLDAuLDAuKTsKI2VuZGlmCmZsb2F0IHNoYWRvdz0xLjsKI2lmZGVmIExJR0hUTUFQCnZlYzQgbGlnaHRtYXBDb2xvcj10ZXh0dXJlMkQobGlnaHRtYXBTYW1wbGVyLHZMaWdodG1hcFVWK3V2T2Zmc2V0KTsKI2lmZGVmIFJHQkRMSUdIVE1BUApsaWdodG1hcENvbG9yLnJnYj1mcm9tUkdCRChsaWdodG1hcENvbG9yKTsKI2VuZGlmCmxpZ2h0bWFwQ29sb3IucmdiKj12TGlnaHRtYXBJbmZvcy55OwojZW5kaWYKI2luY2x1ZGU8bGlnaHRGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQp2ZWM0IHJlZnJhY3Rpb25Db2xvcj12ZWM0KDAuLDAuLDAuLDEuKTsKI2lmZGVmIFJFRlJBQ1RJT04KdmVjMyByZWZyYWN0aW9uVmVjdG9yPW5vcm1hbGl6ZShyZWZyYWN0KC12aWV3RGlyZWN0aW9uVyxub3JtYWxXLHZSZWZyYWN0aW9uSW5mb3MueSkpOwojaWZkZWYgUkVGUkFDVElPTk1BUF8zRAojaWZkZWYgVVNFX0xPQ0FMX1JFRlJBQ1RJT05NQVBfQ1VCSUMKcmVmcmFjdGlvblZlY3Rvcj1wYXJhbGxheENvcnJlY3ROb3JtYWwodlBvc2l0aW9uVyxyZWZyYWN0aW9uVmVjdG9yLHZSZWZyYWN0aW9uU2l6ZSx2UmVmcmFjdGlvblBvc2l0aW9uKTsKI2VuZGlmCnJlZnJhY3Rpb25WZWN0b3IueT1yZWZyYWN0aW9uVmVjdG9yLnkqdlJlZnJhY3Rpb25JbmZvcy53OwppZiAoZG90KHJlZnJhY3Rpb25WZWN0b3Isdmlld0RpcmVjdGlvblcpPDEuMCkgewpyZWZyYWN0aW9uQ29sb3I9dGV4dHVyZUN1YmUocmVmcmFjdGlvbkN1YmVTYW1wbGVyLHJlZnJhY3Rpb25WZWN0b3IpOwp9CiNlbHNlCnZlYzMgdlJlZnJhY3Rpb25VVlc9dmVjMyhyZWZyYWN0aW9uTWF0cml4Kih2aWV3KnZlYzQodlBvc2l0aW9uVytyZWZyYWN0aW9uVmVjdG9yKnZSZWZyYWN0aW9uSW5mb3MueiwxLjApKSk7CnZlYzIgcmVmcmFjdGlvbkNvb3Jkcz12UmVmcmFjdGlvblVWVy54eS92UmVmcmFjdGlvblVWVy56OwpyZWZyYWN0aW9uQ29vcmRzLnk9MS4wLXJlZnJhY3Rpb25Db29yZHMueTsKcmVmcmFjdGlvbkNvbG9yPXRleHR1cmUyRChyZWZyYWN0aW9uMkRTYW1wbGVyLHJlZnJhY3Rpb25Db29yZHMpOwojZW5kaWYKI2lmZGVmIFJHQkRSRUZSQUNUSU9OCnJlZnJhY3Rpb25Db2xvci5yZ2I9ZnJvbVJHQkQocmVmcmFjdGlvbkNvbG9yKTsKI2VuZGlmCiNpZmRlZiBJU19SRUZSQUNUSU9OX0xJTkVBUgpyZWZyYWN0aW9uQ29sb3IucmdiPXRvR2FtbWFTcGFjZShyZWZyYWN0aW9uQ29sb3IucmdiKTsKI2VuZGlmCnJlZnJhY3Rpb25Db2xvci5yZ2IqPXZSZWZyYWN0aW9uSW5mb3MueDsKI2VuZGlmCnZlYzQgcmVmbGVjdGlvbkNvbG9yPXZlYzQoMC4sMC4sMC4sMS4pOwojaWZkZWYgUkVGTEVDVElPTgp2ZWMzIHZSZWZsZWN0aW9uVVZXPWNvbXB1dGVSZWZsZWN0aW9uQ29vcmRzKHZlYzQodlBvc2l0aW9uVywxLjApLG5vcm1hbFcpOwojaWZkZWYgUkVGTEVDVElPTk1BUF9PUFBPU0lURVoKdlJlZmxlY3Rpb25VVlcueio9LTEuMDsKI2VuZGlmCiNpZmRlZiBSRUZMRUNUSU9OTUFQXzNECiNpZmRlZiBST1VHSE5FU1MKZmxvYXQgYmlhcz12UmVmbGVjdGlvbkluZm9zLnk7CiNpZmRlZiBTUEVDVUxBUlRFUk0KI2lmZGVmIFNQRUNVTEFSCiNpZmRlZiBHTE9TU0lORVNTCmJpYXMqPSgxLjAtc3BlY3VsYXJNYXBDb2xvci5hKTsKI2VuZGlmCiNlbmRpZgojZW5kaWYKcmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVyxiaWFzKTsKI2Vsc2UKcmVmbGVjdGlvbkNvbG9yPXRleHR1cmVDdWJlKHJlZmxlY3Rpb25DdWJlU2FtcGxlcix2UmVmbGVjdGlvblVWVyk7CiNlbmRpZgojZWxzZQp2ZWMyIGNvb3Jkcz12UmVmbGVjdGlvblVWVy54eTsKI2lmZGVmIFJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTgpjb29yZHMvPXZSZWZsZWN0aW9uVVZXLno7CiNlbmRpZgpjb29yZHMueT0xLjAtY29vcmRzLnk7CnJlZmxlY3Rpb25Db2xvcj10ZXh0dXJlMkQocmVmbGVjdGlvbjJEU2FtcGxlcixjb29yZHMpOwojZW5kaWYKI2lmZGVmIFJHQkRSRUZMRUNUSU9OCnJlZmxlY3Rpb25Db2xvci5yZ2I9ZnJvbVJHQkQocmVmbGVjdGlvbkNvbG9yKTsKI2VuZGlmCiNpZmRlZiBJU19SRUZMRUNUSU9OX0xJTkVBUgpyZWZsZWN0aW9uQ29sb3IucmdiPXRvR2FtbWFTcGFjZShyZWZsZWN0aW9uQ29sb3IucmdiKTsKI2VuZGlmCnJlZmxlY3Rpb25Db2xvci5yZ2IqPXZSZWZsZWN0aW9uSW5mb3MueDsKI2lmZGVmIFJFRkxFQ1RJT05GUkVTTkVMCmZsb2F0IHJlZmxlY3Rpb25GcmVzbmVsVGVybT1jb21wdXRlRnJlc25lbFRlcm0odmlld0RpcmVjdGlvblcsbm9ybWFsVyxyZWZsZWN0aW9uUmlnaHRDb2xvci5hLHJlZmxlY3Rpb25MZWZ0Q29sb3IuYSk7CiNpZmRlZiBSRUZMRUNUSU9ORlJFU05FTEZST01TUEVDVUxBUgojaWZkZWYgU1BFQ1VMQVJURVJNCnJlZmxlY3Rpb25Db2xvci5yZ2IqPXNwZWN1bGFyQ29sb3IucmdiKigxLjAtcmVmbGVjdGlvbkZyZXNuZWxUZXJtKStyZWZsZWN0aW9uRnJlc25lbFRlcm0qcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiOwojZWxzZQpyZWZsZWN0aW9uQ29sb3IucmdiKj1yZWZsZWN0aW9uTGVmdENvbG9yLnJnYiooMS4wLXJlZmxlY3Rpb25GcmVzbmVsVGVybSkrcmVmbGVjdGlvbkZyZXNuZWxUZXJtKnJlZmxlY3Rpb25SaWdodENvbG9yLnJnYjsKI2VuZGlmCiNlbHNlCnJlZmxlY3Rpb25Db2xvci5yZ2IqPXJlZmxlY3Rpb25MZWZ0Q29sb3IucmdiKigxLjAtcmVmbGVjdGlvbkZyZXNuZWxUZXJtKStyZWZsZWN0aW9uRnJlc25lbFRlcm0qcmVmbGVjdGlvblJpZ2h0Q29sb3IucmdiOwojZW5kaWYKI2VuZGlmCiNlbmRpZgojaWZkZWYgUkVGUkFDVElPTkZSRVNORUwKZmxvYXQgcmVmcmFjdGlvbkZyZXNuZWxUZXJtPWNvbXB1dGVGcmVzbmVsVGVybSh2aWV3RGlyZWN0aW9uVyxub3JtYWxXLHJlZnJhY3Rpb25SaWdodENvbG9yLmEscmVmcmFjdGlvbkxlZnRDb2xvci5hKTsKcmVmcmFjdGlvbkNvbG9yLnJnYio9cmVmcmFjdGlvbkxlZnRDb2xvci5yZ2IqKDEuMC1yZWZyYWN0aW9uRnJlc25lbFRlcm0pK3JlZnJhY3Rpb25GcmVzbmVsVGVybSpyZWZyYWN0aW9uUmlnaHRDb2xvci5yZ2I7CiNlbmRpZgojaWZkZWYgT1BBQ0lUWQp2ZWM0IG9wYWNpdHlNYXA9dGV4dHVyZTJEKG9wYWNpdHlTYW1wbGVyLHZPcGFjaXR5VVYrdXZPZmZzZXQpOwojaWZkZWYgT1BBQ0lUWVJHQgpvcGFjaXR5TWFwLnJnYj1vcGFjaXR5TWFwLnJnYip2ZWMzKDAuMywwLjU5LDAuMTEpOwphbHBoYSo9KG9wYWNpdHlNYXAueCtvcGFjaXR5TWFwLnkrb3BhY2l0eU1hcC56KSogdk9wYWNpdHlJbmZvcy55OwojZWxzZQphbHBoYSo9b3BhY2l0eU1hcC5hKnZPcGFjaXR5SW5mb3MueTsKI2VuZGlmCiNlbmRpZgojaWYgZGVmaW5lZChWRVJURVhBTFBIQSkgfHwgZGVmaW5lZChJTlNUQU5DRVNDT0xPUikgJiYgZGVmaW5lZChJTlNUQU5DRVMpCmFscGhhKj12Q29sb3IuYTsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZRlJFU05FTApmbG9hdCBvcGFjaXR5RnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsb3BhY2l0eVBhcnRzLnosb3BhY2l0eVBhcnRzLncpOwphbHBoYSs9b3BhY2l0eVBhcnRzLngqKDEuMC1vcGFjaXR5RnJlc25lbFRlcm0pK29wYWNpdHlGcmVzbmVsVGVybSpvcGFjaXR5UGFydHMueTsKI2VuZGlmCiNpZmRlZiBBTFBIQVRFU1QKI2lmZGVmIEFMUEhBVEVTVF9BRlRFUkFMTEFMUEhBQ09NUFVUQVRJT05TCmlmIChhbHBoYTxhbHBoYUN1dE9mZikKZGlzY2FyZDsKI2VuZGlmCiNpZm5kZWYgQUxQSEFCTEVORAphbHBoYT0xLjA7CiNlbmRpZgojZW5kaWYKdmVjMyBlbWlzc2l2ZUNvbG9yPXZFbWlzc2l2ZUNvbG9yOwojaWZkZWYgRU1JU1NJVkUKZW1pc3NpdmVDb2xvcis9dGV4dHVyZTJEKGVtaXNzaXZlU2FtcGxlcix2RW1pc3NpdmVVVit1dk9mZnNldCkucmdiKnZFbWlzc2l2ZUluZm9zLnk7CiNlbmRpZgojaWZkZWYgRU1JU1NJVkVGUkVTTkVMCmZsb2F0IGVtaXNzaXZlRnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsZW1pc3NpdmVSaWdodENvbG9yLmEsZW1pc3NpdmVMZWZ0Q29sb3IuYSk7CmVtaXNzaXZlQ29sb3IqPWVtaXNzaXZlTGVmdENvbG9yLnJnYiooMS4wLWVtaXNzaXZlRnJlc25lbFRlcm0pK2VtaXNzaXZlRnJlc25lbFRlcm0qZW1pc3NpdmVSaWdodENvbG9yLnJnYjsKI2VuZGlmCiNpZmRlZiBESUZGVVNFRlJFU05FTApmbG9hdCBkaWZmdXNlRnJlc25lbFRlcm09Y29tcHV0ZUZyZXNuZWxUZXJtKHZpZXdEaXJlY3Rpb25XLG5vcm1hbFcsZGlmZnVzZVJpZ2h0Q29sb3IuYSxkaWZmdXNlTGVmdENvbG9yLmEpOwpkaWZmdXNlQmFzZSo9ZGlmZnVzZUxlZnRDb2xvci5yZ2IqKDEuMC1kaWZmdXNlRnJlc25lbFRlcm0pK2RpZmZ1c2VGcmVzbmVsVGVybSpkaWZmdXNlUmlnaHRDb2xvci5yZ2I7CiNlbmRpZgojaWZkZWYgRU1JU1NJVkVBU0lMTFVNSU5BVElPTgp2ZWMzIGZpbmFsRGlmZnVzZT1jbGFtcChkaWZmdXNlQmFzZSpkaWZmdXNlQ29sb3IrdkFtYmllbnRDb2xvciwwLjAsMS4wKSpiYXNlQ29sb3IucmdiOwojZWxzZQojaWZkZWYgTElOS0VNSVNTSVZFV0lUSERJRkZVU0UKdmVjMyBmaW5hbERpZmZ1c2U9Y2xhbXAoKGRpZmZ1c2VCYXNlK2VtaXNzaXZlQ29sb3IpKmRpZmZ1c2VDb2xvcit2QW1iaWVudENvbG9yLDAuMCwxLjApKmJhc2VDb2xvci5yZ2I7CiNlbHNlCnZlYzMgZmluYWxEaWZmdXNlPWNsYW1wKGRpZmZ1c2VCYXNlKmRpZmZ1c2VDb2xvcitlbWlzc2l2ZUNvbG9yK3ZBbWJpZW50Q29sb3IsMC4wLDEuMCkqYmFzZUNvbG9yLnJnYjsKI2VuZGlmCiNlbmRpZgojaWZkZWYgU1BFQ1VMQVJURVJNCnZlYzMgZmluYWxTcGVjdWxhcj1zcGVjdWxhckJhc2Uqc3BlY3VsYXJDb2xvcjsKI2lmZGVmIFNQRUNVTEFST1ZFUkFMUEhBCmFscGhhPWNsYW1wKGFscGhhK2RvdChmaW5hbFNwZWN1bGFyLHZlYzMoMC4zLDAuNTksMC4xMSkpLDAuLDEuKTsKI2VuZGlmCiNlbHNlCnZlYzMgZmluYWxTcGVjdWxhcj12ZWMzKDAuMCk7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTk9WRVJBTFBIQQphbHBoYT1jbGFtcChhbHBoYStkb3QocmVmbGVjdGlvbkNvbG9yLnJnYix2ZWMzKDAuMywwLjU5LDAuMTEpKSwwLiwxLik7CiNlbmRpZgojaWZkZWYgRU1JU1NJVkVBU0lMTFVNSU5BVElPTgp2ZWM0IGNvbG9yPXZlYzQoY2xhbXAoZmluYWxEaWZmdXNlKmJhc2VBbWJpZW50Q29sb3IrZmluYWxTcGVjdWxhcityZWZsZWN0aW9uQ29sb3IucmdiK2VtaXNzaXZlQ29sb3IrcmVmcmFjdGlvbkNvbG9yLnJnYiwwLjAsMS4wKSxhbHBoYSk7CiNlbHNlCnZlYzQgY29sb3I9dmVjNChmaW5hbERpZmZ1c2UqYmFzZUFtYmllbnRDb2xvcitmaW5hbFNwZWN1bGFyK3JlZmxlY3Rpb25Db2xvci5yZ2IrcmVmcmFjdGlvbkNvbG9yLnJnYixhbHBoYSk7CiNlbmRpZgojaWZkZWYgTElHSFRNQVAKI2lmbmRlZiBMSUdIVE1BUEVYQ0xVREVECiNpZmRlZiBVU0VMSUdIVE1BUEFTU0hBRE9XTUFQCmNvbG9yLnJnYio9bGlnaHRtYXBDb2xvci5yZ2I7CiNlbHNlCmNvbG9yLnJnYis9bGlnaHRtYXBDb2xvci5yZ2I7CiNlbmRpZgojZW5kaWYKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9GT0cKY29sb3IucmdiPW1heChjb2xvci5yZ2IsMC4pOwojaW5jbHVkZTxsb2dEZXB0aEZyYWdtZW50PgojaW5jbHVkZTxmb2dGcmFnbWVudD4KI2lmZGVmIElNQUdFUFJPQ0VTU0lOR1BPU1RQUk9DRVNTCmNvbG9yLnJnYj10b0xpbmVhclNwYWNlKGNvbG9yLnJnYik7CiNlbHNlCiNpZmRlZiBJTUFHRVBST0NFU1NJTkcKY29sb3IucmdiPXRvTGluZWFyU3BhY2UoY29sb3IucmdiKTsKY29sb3I9YXBwbHlJbWFnZVByb2Nlc3NpbmcoY29sb3IpOwojZW5kaWYKI2VuZGlmCmNvbG9yLmEqPXZpc2liaWxpdHk7CiNpZmRlZiBQUkVNVUxUSVBMWUFMUEhBCmNvbG9yLnJnYio9Y29sb3IuYTsKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9GUkFHQ09MT1IKI2lmZGVmIFBSRVBBU1MKZmxvYXQgd3JpdGVHZW9tZXRyeUluZm89Y29sb3IuYT4wLjQgPyAxLjAgOiAwLjA7CmdsX0ZyYWdEYXRhWzBdPWNvbG9yOyAKI2lmZGVmIFBSRVBBU1NfUE9TSVRJT04KZ2xfRnJhZ0RhdGFbUFJFUEFTU19QT1NJVElPTl9JTkRFWF09dmVjNCh2UG9zaXRpb25XLHdyaXRlR2VvbWV0cnlJbmZvKTsKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX1ZFTE9DSVRZCnZlYzIgYT0odkN1cnJlbnRQb3NpdGlvbi54eS92Q3VycmVudFBvc2l0aW9uLncpKjAuNSswLjU7CnZlYzIgYj0odlByZXZpb3VzUG9zaXRpb24ueHkvdlByZXZpb3VzUG9zaXRpb24udykqMC41KzAuNTsKdmVjMiB2ZWxvY2l0eT1hYnMoYS1iKTsKdmVsb2NpdHk9dmVjMihwb3codmVsb2NpdHkueCwxLjAvMy4wKSxwb3codmVsb2NpdHkueSwxLjAvMy4wKSkqc2lnbihhLWIpKjAuNSswLjU7CmdsX0ZyYWdEYXRhW1BSRVBBU1NfVkVMT0NJVFlfSU5ERVhdPXZlYzQodmVsb2NpdHksMC4wLHdyaXRlR2VvbWV0cnlJbmZvKTsKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX0lSUkFESUFOQ0UKZ2xfRnJhZ0RhdGFbUFJFUEFTU19JUlJBRElBTkNFX0lOREVYXT12ZWM0KDAuMCwwLjAsMC4wLHdyaXRlR2VvbWV0cnlJbmZvKTsgCiNlbmRpZgojaWZkZWYgUFJFUEFTU19ERVBUSApnbF9GcmFnRGF0YVtQUkVQQVNTX0RFUFRIX0lOREVYXT12ZWM0KHZWaWV3UG9zLnosMC4wLDAuMCx3cml0ZUdlb21ldHJ5SW5mbyk7IAojZW5kaWYKI2lmZGVmIFBSRVBBU1NfTk9STUFMCmdsX0ZyYWdEYXRhW1BSRVBBU1NfTk9STUFMX0lOREVYXT12ZWM0KCh2aWV3KnZlYzQobm9ybWFsVywwLjApKS5yZ2Isd3JpdGVHZW9tZXRyeUluZm8pOyAKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX0FMQkVET19TUVJUCmdsX0ZyYWdEYXRhW1BSRVBBU1NfQUxCRURPX1NRUlRfSU5ERVhdPXZlYzQoMC4wLDAuMCwwLjAsd3JpdGVHZW9tZXRyeUluZm8pOyAKI2VuZGlmCiNpZmRlZiBQUkVQQVNTX1JFRkxFQ1RJVklUWQojaWYgZGVmaW5lZChTUEVDVUxBUlRFUk0pCiNpZiBkZWZpbmVkKFNQRUNVTEFSKQpnbF9GcmFnRGF0YVtQUkVQQVNTX1JFRkxFQ1RJVklUWV9JTkRFWF09dmVjNChzcGVjdWxhck1hcENvbG9yKSp3cml0ZUdlb21ldHJ5SW5mbzsgCiNlbHNlCmdsX0ZyYWdEYXRhW1BSRVBBU1NfUkVGTEVDVElWSVRZX0lOREVYXT12ZWM0KHNwZWN1bGFyQ29sb3IsMS4wKSp3cml0ZUdlb21ldHJ5SW5mbzsKI2VuZGlmCiNlbHNlCmdsX0ZyYWdEYXRhW1BSRVBBU1NfUkVGTEVDVElWSVRZX0lOREVYXT12ZWM0KDAuMCwwLjAsMC4wLDEuMCkqd3JpdGVHZW9tZXRyeUluZm87CiNlbmRpZgojZW5kaWYKI2VuZGlmCiNpZiAhZGVmaW5lZChQUkVQQVNTKSB8fCBkZWZpbmVkKFdFQkdMMikKZ2xfRnJhZ0NvbG9yPWNvbG9yOwojZW5kaWYKI2luY2x1ZGU8b2l0RnJhZ21lbnQ+CiNpZiBPUkRFUl9JTkRFUEVOREVOVF9UUkFOU1BBUkVOQ1kKaWYgKGZyYWdEZXB0aD09bmVhcmVzdERlcHRoKSB7CmZyb250Q29sb3IucmdiKz1jb2xvci5yZ2IqY29sb3IuYSphbHBoYU11bHRpcGxpZXI7CmZyb250Q29sb3IuYT0xLjAtYWxwaGFNdWx0aXBsaWVyKigxLjAtY29sb3IuYSk7Cn0gZWxzZSB7CmJhY2tDb2xvcis9Y29sb3I7Cn0KI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX01BSU5fRU5ECn0KYDtVLlNoYWRlcnNTdG9yZVtEaF09Rmg7Y29uc3Qgd2g9ImRlZmF1bHRWZXJ0ZXhEZWNsYXJhdGlvbiIsT2g9YHVuaWZvcm0gbWF0NCB2aWV3UHJvamVjdGlvbjsKdW5pZm9ybSBtYXQ0IHZpZXc7CiNpZmRlZiBESUZGVVNFCnVuaWZvcm0gbWF0NCBkaWZmdXNlTWF0cml4Owp1bmlmb3JtIHZlYzIgdkRpZmZ1c2VJbmZvczsKI2VuZGlmCiNpZmRlZiBBTUJJRU5UCnVuaWZvcm0gbWF0NCBhbWJpZW50TWF0cml4Owp1bmlmb3JtIHZlYzIgdkFtYmllbnRJbmZvczsKI2VuZGlmCiNpZmRlZiBPUEFDSVRZCnVuaWZvcm0gbWF0NCBvcGFjaXR5TWF0cml4Owp1bmlmb3JtIHZlYzIgdk9wYWNpdHlJbmZvczsKI2VuZGlmCiNpZmRlZiBFTUlTU0lWRQp1bmlmb3JtIHZlYzIgdkVtaXNzaXZlSW5mb3M7CnVuaWZvcm0gbWF0NCBlbWlzc2l2ZU1hdHJpeDsKI2VuZGlmCiNpZmRlZiBMSUdIVE1BUAp1bmlmb3JtIHZlYzIgdkxpZ2h0bWFwSW5mb3M7CnVuaWZvcm0gbWF0NCBsaWdodG1hcE1hdHJpeDsKI2VuZGlmCiNpZiBkZWZpbmVkKFNQRUNVTEFSKSAmJiBkZWZpbmVkKFNQRUNVTEFSVEVSTSkKdW5pZm9ybSB2ZWMyIHZTcGVjdWxhckluZm9zOwp1bmlmb3JtIG1hdDQgc3BlY3VsYXJNYXRyaXg7CiNlbmRpZgojaWZkZWYgQlVNUAp1bmlmb3JtIHZlYzMgdkJ1bXBJbmZvczsKdW5pZm9ybSBtYXQ0IGJ1bXBNYXRyaXg7CiNlbmRpZgojaWZkZWYgUkVGTEVDVElPTgp1bmlmb3JtIG1hdDQgcmVmbGVjdGlvbk1hdHJpeDsKI2VuZGlmCiNpZmRlZiBQT0lOVFNJWkUKdW5pZm9ybSBmbG9hdCBwb2ludFNpemU7CiNlbmRpZgojaWZkZWYgREVUQUlMCnVuaWZvcm0gdmVjNCB2RGV0YWlsSW5mb3M7CnVuaWZvcm0gbWF0NCBkZXRhaWxNYXRyaXg7CiNlbmRpZgojZGVmaW5lIEFERElUSU9OQUxfVkVSVEVYX0RFQ0xBUkFUSU9OCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVt3aF09T2g7Y29uc3QgTGg9InV2QXR0cmlidXRlRGVjbGFyYXRpb24iLE5oPWAjaWZkZWYgVVZ7WH0KYXR0cmlidXRlIHZlYzIgdXZ7WH07CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbTGhdPU5oO2NvbnN0IEJoPSJwcmVQYXNzVmVydGV4RGVjbGFyYXRpb24iLFVoPWAjaWZkZWYgUFJFUEFTUwojaWZkZWYgUFJFUEFTU19ERVBUSAp2YXJ5aW5nIHZlYzMgdlZpZXdQb3M7CiNlbmRpZgojaWZkZWYgUFJFUEFTU19WRUxPQ0lUWQp1bmlmb3JtIG1hdDQgcHJldmlvdXNWaWV3UHJvamVjdGlvbjsKdmFyeWluZyB2ZWM0IHZDdXJyZW50UG9zaXRpb247CnZhcnlpbmcgdmVjNCB2UHJldmlvdXNQb3NpdGlvbjsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbQmhdPVVoO2NvbnN0IGtoPSJzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24iLFZoPWAjaWYgZGVmaW5lZChfREVGSU5FTkFNRV8pICYmIF9ERUZJTkVOQU1FX0RJUkVDVFVWPT0wCnZhcnlpbmcgdmVjMiB2X1ZBUllJTkdOQU1FX1VWOwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW2toXT1WaDtjb25zdCBXaD0iYnVtcFZlcnRleERlY2xhcmF0aW9uIix6aD1gI2lmIGRlZmluZWQoQlVNUCkgfHwgZGVmaW5lZChQQVJBTExBWCkgfHwgZGVmaW5lZChDTEVBUkNPQVRfQlVNUCkgfHwgZGVmaW5lZChBTklTT1RST1BJQykKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpIAp2YXJ5aW5nIG1hdDMgdlRCTjsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbV2hdPXpoO2NvbnN0IEdoPSJmb2dWZXJ0ZXhEZWNsYXJhdGlvbiIsWGg9YCNpZmRlZiBGT0cKdmFyeWluZyB2ZWMzIHZGb2dEaXN0YW5jZTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtHaF09WGg7Y29uc3QgSGg9ImxpZ2h0VnhGcmFnbWVudERlY2xhcmF0aW9uIixLaD1gI2lmZGVmIExJR0hUe1h9CnVuaWZvcm0gdmVjNCB2TGlnaHREYXRhe1h9Owp1bmlmb3JtIHZlYzQgdkxpZ2h0RGlmZnVzZXtYfTsKI2lmZGVmIFNQRUNVTEFSVEVSTQp1bmlmb3JtIHZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH07CiNlbHNlCnZlYzQgdkxpZ2h0U3BlY3VsYXJ7WH09dmVjNCgwLik7CiNlbmRpZgojaWZkZWYgU0hBRE9Xe1h9CiNpZmRlZiBTSEFET1dDU017WH0KdW5pZm9ybSBtYXQ0IGxpZ2h0TWF0cml4e1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWN7WH1bU0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9XTsKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21DYW1lcmF7WH07CiNlbGlmIGRlZmluZWQoU0hBRE9XQ1VCRXtYfSkKI2Vsc2UKdmFyeWluZyB2ZWM0IHZQb3NpdGlvbkZyb21MaWdodHtYfTsKdmFyeWluZyBmbG9hdCB2RGVwdGhNZXRyaWN7WH07CnVuaWZvcm0gbWF0NCBsaWdodE1hdHJpeHtYfTsKI2VuZGlmCnVuaWZvcm0gdmVjNCBzaGFkb3dzSW5mb3tYfTsKdW5pZm9ybSB2ZWMyIGRlcHRoVmFsdWVze1h9OwojZW5kaWYKI2lmZGVmIFNQT1RMSUdIVHtYfQp1bmlmb3JtIHZlYzQgdkxpZ2h0RGlyZWN0aW9ue1h9Owp1bmlmb3JtIHZlYzQgdkxpZ2h0RmFsbG9mZntYfTsKI2VsaWYgZGVmaW5lZChQT0lOVExJR0hUe1h9KQp1bmlmb3JtIHZlYzQgdkxpZ2h0RmFsbG9mZntYfTsKI2VsaWYgZGVmaW5lZChIRU1JTElHSFR7WH0pCnVuaWZvcm0gdmVjMyB2TGlnaHRHcm91bmR7WH07CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW0hoXT1LaDtjb25zdCBZaD0ibGlnaHRWeFVib0RlY2xhcmF0aW9uIixaaD1gI2lmZGVmIExJR0hUe1h9CnVuaWZvcm0gTGlnaHR7WH0Kewp2ZWM0IHZMaWdodERhdGE7CnZlYzQgdkxpZ2h0RGlmZnVzZTsKdmVjNCB2TGlnaHRTcGVjdWxhcjsKI2lmZGVmIFNQT1RMSUdIVHtYfQp2ZWM0IHZMaWdodERpcmVjdGlvbjsKdmVjNCB2TGlnaHRGYWxsb2ZmOwojZWxpZiBkZWZpbmVkKFBPSU5UTElHSFR7WH0pCnZlYzQgdkxpZ2h0RmFsbG9mZjsKI2VsaWYgZGVmaW5lZChIRU1JTElHSFR7WH0pCnZlYzMgdkxpZ2h0R3JvdW5kOwojZW5kaWYKdmVjNCBzaGFkb3dzSW5mbzsKdmVjMiBkZXB0aFZhbHVlczsKfSBsaWdodHtYfTsKI2lmZGVmIFNIQURPV3tYfQojaWZkZWYgU0hBRE9XQ1NNe1h9CnVuaWZvcm0gbWF0NCBsaWdodE1hdHJpeHtYfVtTSEFET1dDU01OVU1fQ0FTQ0FERVN7WH1dOwp2YXJ5aW5nIHZlYzQgdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9W1NIQURPV0NTTU5VTV9DQVNDQURFU3tYfV07CnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tQ2FtZXJhe1h9OwojZWxpZiBkZWZpbmVkKFNIQURPV0NVQkV7WH0pCiNlbHNlCnZhcnlpbmcgdmVjNCB2UG9zaXRpb25Gcm9tTGlnaHR7WH07CnZhcnlpbmcgZmxvYXQgdkRlcHRoTWV0cmlje1h9Owp1bmlmb3JtIG1hdDQgbGlnaHRNYXRyaXh7WH07CiNlbmRpZgojZW5kaWYKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVtZaF09Wmg7Y29uc3QgcWg9InByZVBhc3NWZXJ0ZXgiLGpoPWAjaWZkZWYgUFJFUEFTU19ERVBUSAp2Vmlld1Bvcz0odmlldyp3b3JsZFBvcykucmdiOwojZW5kaWYKI2lmIGRlZmluZWQoUFJFUEFTU19WRUxPQ0lUWSkgJiYgZGVmaW5lZChCT05FU19WRUxPQ0lUWV9FTkFCTEVEKQp2Q3VycmVudFBvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKndvcmxkUG9zOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MAptYXQ0IHByZXZpb3VzSW5mbHVlbmNlOwpwcmV2aW91c0luZmx1ZW5jZT1tUHJldmlvdXNCb25lc1tpbnQobWF0cmljZXNJbmRpY2VzWzBdKV0qbWF0cmljZXNXZWlnaHRzWzBdOwojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MQpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1sxXSldKm1hdHJpY2VzV2VpZ2h0c1sxXTsKI2VuZGlmIAojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MgpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1syXSldKm1hdHJpY2VzV2VpZ2h0c1syXTsKI2VuZGlmIAojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+MwpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc1szXSldKm1hdHJpY2VzV2VpZ2h0c1szXTsKI2VuZGlmCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz40CnByZXZpb3VzSW5mbHVlbmNlKz1tUHJldmlvdXNCb25lc1tpbnQobWF0cmljZXNJbmRpY2VzRXh0cmFbMF0pXSptYXRyaWNlc1dlaWdodHNFeHRyYVswXTsKI2VuZGlmIAojaWYgTlVNX0JPTkVfSU5GTFVFTkNFUlM+NQpwcmV2aW91c0luZmx1ZW5jZSs9bVByZXZpb3VzQm9uZXNbaW50KG1hdHJpY2VzSW5kaWNlc0V4dHJhWzFdKV0qbWF0cmljZXNXZWlnaHRzRXh0cmFbMV07CiNlbmRpZiAKI2lmIE5VTV9CT05FX0lORkxVRU5DRVJTPjYKcHJldmlvdXNJbmZsdWVuY2UrPW1QcmV2aW91c0JvbmVzW2ludChtYXRyaWNlc0luZGljZXNFeHRyYVsyXSldKm1hdHJpY2VzV2VpZ2h0c0V4dHJhWzJdOwojZW5kaWYgCiNpZiBOVU1fQk9ORV9JTkZMVUVOQ0VSUz43CnByZXZpb3VzSW5mbHVlbmNlKz1tUHJldmlvdXNCb25lc1tpbnQobWF0cmljZXNJbmRpY2VzRXh0cmFbM10pXSptYXRyaWNlc1dlaWdodHNFeHRyYVszXTsKI2VuZGlmCnZQcmV2aW91c1Bvc2l0aW9uPXByZXZpb3VzVmlld1Byb2plY3Rpb24qZmluYWxQcmV2aW91c1dvcmxkKnByZXZpb3VzSW5mbHVlbmNlKnZlYzQocG9zaXRpb25VcGRhdGVkLDEuMCk7CiNlbHNlCnZQcmV2aW91c1Bvc2l0aW9uPXByZXZpb3VzVmlld1Byb2plY3Rpb24qZmluYWxQcmV2aW91c1dvcmxkKnZlYzQocG9zaXRpb25VcGRhdGVkLDEuMCk7CiNlbmRpZgojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3FoXT1qaDtjb25zdCAkaD0idXZWYXJpYWJsZURlY2xhcmF0aW9uIixRaD1gI2lmICFkZWZpbmVkKFVWe1h9KSAmJiBkZWZpbmVkKE1BSU5VVntYfSkKdmVjMiB1dntYfT12ZWMyKDAuLDAuKTsKI2VuZGlmCiNpZmRlZiBNQUlOVVZ7WH0Kdk1haW5VVntYfT11dntYfTsKI2VuZGlmCmA7VS5JbmNsdWRlc1NoYWRlcnNTdG9yZVskaF09UWg7Y29uc3QgSmg9InNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbiIsZWw9YCNpZiBkZWZpbmVkKF9ERUZJTkVOQU1FXykgJiYgX0RFRklORU5BTUVfRElSRUNUVVY9PTAKaWYgKHZfSU5GT05BTUVfPT0wLikKewp2X1ZBUllJTkdOQU1FX1VWPXZlYzIoX01BVFJJWE5BTUVfTWF0cml4KnZlYzQodXZVcGRhdGVkLDEuMCwwLjApKTsKfQojaWZkZWYgVVYyCmVsc2UgaWYgKHZfSU5GT05BTUVfPT0xLikKewp2X1ZBUllJTkdOQU1FX1VWPXZlYzIoX01BVFJJWE5BTUVfTWF0cml4KnZlYzQodXYyLDEuMCwwLjApKTsKfQojZW5kaWYKI2lmZGVmIFVWMwplbHNlIGlmICh2X0lORk9OQU1FXz09Mi4pCnsKdl9WQVJZSU5HTkFNRV9VVj12ZWMyKF9NQVRSSVhOQU1FX01hdHJpeCp2ZWM0KHV2MywxLjAsMC4wKSk7Cn0KI2VuZGlmCiNpZmRlZiBVVjQKZWxzZSBpZiAodl9JTkZPTkFNRV89PTMuKQp7CnZfVkFSWUlOR05BTUVfVVY9dmVjMihfTUFUUklYTkFNRV9NYXRyaXgqdmVjNCh1djQsMS4wLDAuMCkpOwp9CiNlbmRpZgojaWZkZWYgVVY1CmVsc2UgaWYgKHZfSU5GT05BTUVfPT00LikKewp2X1ZBUllJTkdOQU1FX1VWPXZlYzIoX01BVFJJWE5BTUVfTWF0cml4KnZlYzQodXY1LDEuMCwwLjApKTsKfQojZW5kaWYKI2lmZGVmIFVWNgplbHNlIGlmICh2X0lORk9OQU1FXz09NS4pCnsKdl9WQVJZSU5HTkFNRV9VVj12ZWMyKF9NQVRSSVhOQU1FX01hdHJpeCp2ZWM0KHV2NiwxLjAsMC4wKSk7Cn0KI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbSmhdPWVsO2NvbnN0IHRsPSJidW1wVmVydGV4IixpbD1gI2lmIGRlZmluZWQoQlVNUCkgfHwgZGVmaW5lZChQQVJBTExBWCkgfHwgZGVmaW5lZChDTEVBUkNPQVRfQlVNUCkgfHwgZGVmaW5lZChBTklTT1RST1BJQykKI2lmIGRlZmluZWQoVEFOR0VOVCkgJiYgZGVmaW5lZChOT1JNQUwpCnZlYzMgdGJuTm9ybWFsPW5vcm1hbGl6ZShub3JtYWxVcGRhdGVkKTsKdmVjMyB0Ym5UYW5nZW50PW5vcm1hbGl6ZSh0YW5nZW50VXBkYXRlZC54eXopOwp2ZWMzIHRibkJpdGFuZ2VudD1jcm9zcyh0Ym5Ob3JtYWwsdGJuVGFuZ2VudCkqdGFuZ2VudFVwZGF0ZWQudzsKdlRCTj1tYXQzKGZpbmFsV29ybGQpKm1hdDModGJuVGFuZ2VudCx0Ym5CaXRhbmdlbnQsdGJuTm9ybWFsKTsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbdGxdPWlsO2NvbnN0IHNsPSJmb2dWZXJ0ZXgiLHJsPWAjaWZkZWYgRk9HCnZGb2dEaXN0YW5jZT0odmlldyp3b3JsZFBvcykueHl6OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3NsXT1ybDtjb25zdCBubD0ic2hhZG93c1ZlcnRleCIsYWw9YCNpZmRlZiBTSEFET1dTCiNpZiBkZWZpbmVkKFNIQURPV0NTTXtYfSkKdlBvc2l0aW9uRnJvbUNhbWVyYXtYfT12aWV3KndvcmxkUG9zOwpmb3IgKGludCBpPTA7IGk8U0hBRE9XQ1NNTlVNX0NBU0NBREVTe1h9OyBpKyspIHsKdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2ldPWxpZ2h0TWF0cml4e1h9W2ldKndvcmxkUG9zOwojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKdkRlcHRoTWV0cmlje1h9W2ldPSgtdlBvc2l0aW9uRnJvbUxpZ2h0e1h9W2ldLnorbGlnaHR7WH0uZGVwdGhWYWx1ZXMueCkvbGlnaHR7WH0uZGVwdGhWYWx1ZXMueTsKI2Vsc2UKdkRlcHRoTWV0cmlje1h9W2ldPSh2UG9zaXRpb25Gcm9tTGlnaHR7WH1baV0ueitsaWdodHtYfS5kZXB0aFZhbHVlcy54KS9saWdodHtYfS5kZXB0aFZhbHVlcy55OwojZW5kaWYKfQojZWxpZiBkZWZpbmVkKFNIQURPV3tYfSkgJiYgIWRlZmluZWQoU0hBRE9XQ1VCRXtYfSkKdlBvc2l0aW9uRnJvbUxpZ2h0e1h9PWxpZ2h0TWF0cml4e1h9KndvcmxkUG9zOwojaWZkZWYgVVNFX1JFVkVSU0VfREVQVEhCVUZGRVIKdkRlcHRoTWV0cmlje1h9PSgtdlBvc2l0aW9uRnJvbUxpZ2h0e1h9LnorbGlnaHR7WH0uZGVwdGhWYWx1ZXMueCkvbGlnaHR7WH0uZGVwdGhWYWx1ZXMueTsKI2Vsc2UKdkRlcHRoTWV0cmlje1h9PSh2UG9zaXRpb25Gcm9tTGlnaHR7WH0ueitsaWdodHtYfS5kZXB0aFZhbHVlcy54KS9saWdodHtYfS5kZXB0aFZhbHVlcy55OwojZW5kaWYKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbmxdPWFsO2NvbnN0IG9sPSJ2ZXJ0ZXhDb2xvck1peGluZyIsaGw9YCNpZiBkZWZpbmVkKFZFUlRFWENPTE9SKSB8fCBkZWZpbmVkKElOU1RBTkNFU0NPTE9SKSAmJiBkZWZpbmVkKElOU1RBTkNFUykKdkNvbG9yPXZlYzQoMS4wKTsKI2lmZGVmIFZFUlRFWENPTE9SCiNpZmRlZiBWRVJURVhBTFBIQQp2Q29sb3IqPWNvbG9yOwojZWxzZQp2Q29sb3IucmdiKj1jb2xvci5yZ2I7CiNlbmRpZgojZW5kaWYKI2lmZGVmIElOU1RBTkNFU0NPTE9SCnZDb2xvcio9aW5zdGFuY2VDb2xvcjsKI2VuZGlmCiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbb2xdPWhsO2NvbnN0IGxsPSJwb2ludENsb3VkVmVydGV4IixjbD1gI2lmIGRlZmluZWQoUE9JTlRTSVpFKSAmJiAhZGVmaW5lZChXRUJHUFUpCmdsX1BvaW50U2l6ZT1wb2ludFNpemU7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbbGxdPWNsO2NvbnN0IHVsPSJsb2dEZXB0aFZlcnRleCIsZGw9YCNpZmRlZiBMT0dBUklUSE1JQ0RFUFRICnZGcmFnbWVudERlcHRoPTEuMCtnbF9Qb3NpdGlvbi53OwpnbF9Qb3NpdGlvbi56PWxvZzIobWF4KDAuMDAwMDAxLHZGcmFnbWVudERlcHRoKSkqbG9nYXJpdGhtaWNEZXB0aENvbnN0YW50OwojZW5kaWYKYDtVLkluY2x1ZGVzU2hhZGVyc1N0b3JlW3VsXT1kbDtjb25zdCBmbD0iZGVmYXVsdFZlcnRleFNoYWRlciIsX2w9YCNpbmNsdWRlPF9fZGVjbF9fZGVmYXVsdFZlcnRleD4KI2RlZmluZSBDVVNUT01fVkVSVEVYX0JFR0lOCmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaWZkZWYgTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsKI2VuZGlmCiNpZmRlZiBUQU5HRU5UCmF0dHJpYnV0ZSB2ZWM0IHRhbmdlbnQ7CiNlbmRpZgojaWZkZWYgVVYxCmF0dHJpYnV0ZSB2ZWMyIHV2OwojZW5kaWYKI2luY2x1ZGU8dXZBdHRyaWJ1dGVEZWNsYXJhdGlvbj5bMi4uN10KI2lmZGVmIFZFUlRFWENPTE9SCmF0dHJpYnV0ZSB2ZWM0IGNvbG9yOwojZW5kaWYKI2luY2x1ZGU8aGVscGVyRnVuY3Rpb25zPgojaW5jbHVkZTxib25lc0RlY2xhcmF0aW9uPgojaW5jbHVkZTxiYWtlZFZlcnRleEFuaW1hdGlvbkRlY2xhcmF0aW9uPgojaW5jbHVkZTxpbnN0YW5jZXNEZWNsYXJhdGlvbj4KI2luY2x1ZGU8cHJlUGFzc1ZlcnRleERlY2xhcmF0aW9uPgojaW5jbHVkZTxtYWluVVZWYXJ5aW5nRGVjbGFyYXRpb24+WzEuLjddCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhEZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLERJRkZVU0UsX1ZBUllJTkdOQU1FXyxEaWZmdXNlKQojaW5jbHVkZTxzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxERVRBSUwsX1ZBUllJTkdOQU1FXyxEZXRhaWwpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhEZWNsYXJhdGlvbj4oX0RFRklORU5BTUVfLEFNQklFTlQsX1ZBUllJTkdOQU1FXyxBbWJpZW50KQojaW5jbHVkZTxzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxPUEFDSVRZLF9WQVJZSU5HTkFNRV8sT3BhY2l0eSkKI2luY2x1ZGU8c2FtcGxlclZlcnRleERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sRU1JU1NJVkUsX1ZBUllJTkdOQU1FXyxFbWlzc2l2ZSkKI2luY2x1ZGU8c2FtcGxlclZlcnRleERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sTElHSFRNQVAsX1ZBUllJTkdOQU1FXyxMaWdodG1hcCkKI2lmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQojaW5jbHVkZTxzYW1wbGVyVmVydGV4RGVjbGFyYXRpb24+KF9ERUZJTkVOQU1FXyxTUEVDVUxBUixfVkFSWUlOR05BTUVfLFNwZWN1bGFyKQojZW5kaWYKI2luY2x1ZGU8c2FtcGxlclZlcnRleERlY2xhcmF0aW9uPihfREVGSU5FTkFNRV8sQlVNUCxfVkFSWUlOR05BTUVfLEJ1bXApCnZhcnlpbmcgdmVjMyB2UG9zaXRpb25XOwojaWZkZWYgTk9STUFMCnZhcnlpbmcgdmVjMyB2Tm9ybWFsVzsKI2VuZGlmCiNpZiBkZWZpbmVkKFZFUlRFWENPTE9SKSB8fCBkZWZpbmVkKElOU1RBTkNFU0NPTE9SKSAmJiBkZWZpbmVkKElOU1RBTkNFUykKdmFyeWluZyB2ZWM0IHZDb2xvcjsKI2VuZGlmCiNpbmNsdWRlPGJ1bXBWZXJ0ZXhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4RGVjbGFyYXRpb24+CiNpbmNsdWRlPGZvZ1ZlcnRleERlY2xhcmF0aW9uPgojaW5jbHVkZTxfX2RlY2xfX2xpZ2h0VnhGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhHbG9iYWxEZWNsYXJhdGlvbj4KI2luY2x1ZGU8bW9ycGhUYXJnZXRzVmVydGV4RGVjbGFyYXRpb24+WzAuLm1heFNpbXVsdGFuZW91c01vcnBoVGFyZ2V0c10KI2lmZGVmIFJFRkxFQ1RJT05NQVBfU0tZQk9YCnZhcnlpbmcgdmVjMyB2UG9zaXRpb25VVlc7CiNlbmRpZgojaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKQp2YXJ5aW5nIHZlYzMgdkRpcmVjdGlvblc7CiNlbmRpZgojaW5jbHVkZTxsb2dEZXB0aERlY2xhcmF0aW9uPgojZGVmaW5lIENVU1RPTV9WRVJURVhfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fQkVHSU4KdmVjMyBwb3NpdGlvblVwZGF0ZWQ9cG9zaXRpb247CiNpZmRlZiBOT1JNQUwKdmVjMyBub3JtYWxVcGRhdGVkPW5vcm1hbDsKI2VuZGlmCiNpZmRlZiBUQU5HRU5UCnZlYzQgdGFuZ2VudFVwZGF0ZWQ9dGFuZ2VudDsKI2VuZGlmCiNpZmRlZiBVVjEKdmVjMiB1dlVwZGF0ZWQ9dXY7CiNlbmRpZgojaW5jbHVkZTxtb3JwaFRhcmdldHNWZXJ0ZXhHbG9iYWw+CiNpbmNsdWRlPG1vcnBoVGFyZ2V0c1ZlcnRleD5bMC4ubWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzXQojaWZkZWYgUkVGTEVDVElPTk1BUF9TS1lCT1gKdlBvc2l0aW9uVVZXPXBvc2l0aW9uVXBkYXRlZDsKI2VuZGlmCiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9VUERBVEVfUE9TSVRJT04KI2RlZmluZSBDVVNUT01fVkVSVEVYX1VQREFURV9OT1JNQUwKI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PgojaWYgZGVmaW5lZChQUkVQQVNTKSAmJiBkZWZpbmVkKFBSRVBBU1NfVkVMT0NJVFkpICYmICFkZWZpbmVkKEJPTkVTX1ZFTE9DSVRZX0VOQUJMRUQpCnZDdXJyZW50UG9zaXRpb249dmlld1Byb2plY3Rpb24qZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uVXBkYXRlZCwxLjApOwp2UHJldmlvdXNQb3NpdGlvbj1wcmV2aW91c1ZpZXdQcm9qZWN0aW9uKmZpbmFsUHJldmlvdXNXb3JsZCp2ZWM0KHBvc2l0aW9uVXBkYXRlZCwxLjApOwojZW5kaWYKI2luY2x1ZGU8Ym9uZXNWZXJ0ZXg+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uPgp2ZWM0IHdvcmxkUG9zPWZpbmFsV29ybGQqdmVjNChwb3NpdGlvblVwZGF0ZWQsMS4wKTsKI2lmZGVmIE5PUk1BTAptYXQzIG5vcm1hbFdvcmxkPW1hdDMoZmluYWxXb3JsZCk7CiNpZiBkZWZpbmVkKElOU1RBTkNFUykgJiYgZGVmaW5lZChUSElOX0lOU1RBTkNFUykKdk5vcm1hbFc9bm9ybWFsVXBkYXRlZC92ZWMzKGRvdChub3JtYWxXb3JsZFswXSxub3JtYWxXb3JsZFswXSksZG90KG5vcm1hbFdvcmxkWzFdLG5vcm1hbFdvcmxkWzFdKSxkb3Qobm9ybWFsV29ybGRbMl0sbm9ybWFsV29ybGRbMl0pKTsKdk5vcm1hbFc9bm9ybWFsaXplKG5vcm1hbFdvcmxkKnZOb3JtYWxXKTsKI2Vsc2UKI2lmZGVmIE5PTlVOSUZPUk1TQ0FMSU5HCm5vcm1hbFdvcmxkPXRyYW5zcG9zZU1hdDMoaW52ZXJzZU1hdDMobm9ybWFsV29ybGQpKTsKI2VuZGlmCnZOb3JtYWxXPW5vcm1hbGl6ZShub3JtYWxXb3JsZCpub3JtYWxVcGRhdGVkKTsKI2VuZGlmCiNlbmRpZgojZGVmaW5lIENVU1RPTV9WRVJURVhfVVBEQVRFX1dPUkxEUE9TCiNpZmRlZiBNVUxUSVZJRVcKaWYgKGdsX1ZpZXdJRF9PVlI9PTB1KSB7CmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKndvcmxkUG9zOwp9IGVsc2UgewpnbF9Qb3NpdGlvbj12aWV3UHJvamVjdGlvblIqd29ybGRQb3M7Cn0KI2Vsc2UKZ2xfUG9zaXRpb249dmlld1Byb2plY3Rpb24qd29ybGRQb3M7CiNlbmRpZgp2UG9zaXRpb25XPXZlYzMod29ybGRQb3MpOwojaW5jbHVkZTxwcmVQYXNzVmVydGV4PgojaWYgZGVmaW5lZChSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCkgfHwgZGVmaW5lZChSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEKQp2RGlyZWN0aW9uVz1ub3JtYWxpemUodmVjMyhmaW5hbFdvcmxkKnZlYzQocG9zaXRpb25VcGRhdGVkLDAuMCkpKTsKI2VuZGlmCiNpZm5kZWYgVVYxCnZlYzIgdXZVcGRhdGVkPXZlYzIoMC4sMC4pOwojZW5kaWYKI2lmZGVmIE1BSU5VVjEKdk1haW5VVjE9dXZVcGRhdGVkOwojZW5kaWYKI2luY2x1ZGU8dXZWYXJpYWJsZURlY2xhcmF0aW9uPlsyLi43XQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxESUZGVVNFLF9WQVJZSU5HTkFNRV8sRGlmZnVzZSxfTUFUUklYTkFNRV8sZGlmZnVzZSxfSU5GT05BTUVfLERpZmZ1c2VJbmZvcy54KQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxERVRBSUwsX1ZBUllJTkdOQU1FXyxEZXRhaWwsX01BVFJJWE5BTUVfLGRldGFpbCxfSU5GT05BTUVfLERldGFpbEluZm9zLngpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLEFNQklFTlQsX1ZBUllJTkdOQU1FXyxBbWJpZW50LF9NQVRSSVhOQU1FXyxhbWJpZW50LF9JTkZPTkFNRV8sQW1iaWVudEluZm9zLngpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLE9QQUNJVFksX1ZBUllJTkdOQU1FXyxPcGFjaXR5LF9NQVRSSVhOQU1FXyxvcGFjaXR5LF9JTkZPTkFNRV8sT3BhY2l0eUluZm9zLngpCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLEVNSVNTSVZFLF9WQVJZSU5HTkFNRV8sRW1pc3NpdmUsX01BVFJJWE5BTUVfLGVtaXNzaXZlLF9JTkZPTkFNRV8sRW1pc3NpdmVJbmZvcy54KQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxMSUdIVE1BUCxfVkFSWUlOR05BTUVfLExpZ2h0bWFwLF9NQVRSSVhOQU1FXyxsaWdodG1hcCxfSU5GT05BTUVfLExpZ2h0bWFwSW5mb3MueCkKI2lmIGRlZmluZWQoU1BFQ1VMQVJURVJNKQojaW5jbHVkZTxzYW1wbGVyVmVydGV4SW1wbGVtZW50YXRpb24+KF9ERUZJTkVOQU1FXyxTUEVDVUxBUixfVkFSWUlOR05BTUVfLFNwZWN1bGFyLF9NQVRSSVhOQU1FXyxzcGVjdWxhcixfSU5GT05BTUVfLFNwZWN1bGFySW5mb3MueCkKI2VuZGlmCiNpbmNsdWRlPHNhbXBsZXJWZXJ0ZXhJbXBsZW1lbnRhdGlvbj4oX0RFRklORU5BTUVfLEJVTVAsX1ZBUllJTkdOQU1FXyxCdW1wLF9NQVRSSVhOQU1FXyxidW1wLF9JTkZPTkFNRV8sQnVtcEluZm9zLngpCiNpbmNsdWRlPGJ1bXBWZXJ0ZXg+CiNpbmNsdWRlPGNsaXBQbGFuZVZlcnRleD4KI2luY2x1ZGU8Zm9nVmVydGV4PgojaW5jbHVkZTxzaGFkb3dzVmVydGV4PlswLi5tYXhTaW11bHRhbmVvdXNMaWdodHNdCiNpbmNsdWRlPHZlcnRleENvbG9yTWl4aW5nPgojaW5jbHVkZTxwb2ludENsb3VkVmVydGV4PgojaW5jbHVkZTxsb2dEZXB0aFZlcnRleD4KI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fRU5ECn0KYDtVLlNoYWRlcnNTdG9yZVtmbF09X2w7Y29uc3QgZ2w9bmV3IFJlZ0V4cCgiXihbZ2ltdXNdKykhIik7Y2xhc3MgZWl7Y29uc3RydWN0b3IoZSl7dGhpcy5fcGx1Z2lucz1bXSx0aGlzLl9hY3RpdmVQbHVnaW5zPVtdLHRoaXMuX2FjdGl2ZVBsdWdpbnNGb3JFeHRyYUV2ZW50cz1bXSx0aGlzLl9tYXRlcmlhbD1lLHRoaXMuX3NjZW5lPWUuZ2V0U2NlbmUoKSx0aGlzLl9lbmdpbmU9dGhpcy5fc2NlbmUuZ2V0RW5naW5lKCl9X2FkZFBsdWdpbihlKXtmb3IobGV0IHM9MDtzPHRoaXMuX3BsdWdpbnMubGVuZ3RoOysrcylpZih0aGlzLl9wbHVnaW5zW3NdLm5hbWU9PT1lLm5hbWUpdGhyb3dgUGx1Z2luICIke2UubmFtZX0iIGFscmVhZHkgYWRkZWQgdG8gdGhlIG1hdGVyaWFsICIke3RoaXMuX21hdGVyaWFsLm5hbWV9IiFgO2lmKHRoaXMuX21hdGVyaWFsLl91bmlmb3JtQnVmZmVyTGF5b3V0QnVpbHQpdGhyb3dgVGhlIHBsdWdpbiAiJHtlLm5hbWV9IiBjYW4ndCBiZSBhZGRlZCB0byB0aGUgbWF0ZXJpYWwgIiR7dGhpcy5fbWF0ZXJpYWwubmFtZX0iIGJlY2F1c2UgdGhpcyBtYXRlcmlhbCBoYXMgYWxyZWFkeSBiZWVuIHVzZWQgZm9yIHJlbmRlcmluZyEgUGxlYXNlIGFkZCBwbHVnaW5zIHRvIG1hdGVyaWFscyBiZWZvcmUgYW55IHJlbmRlcmluZyB3aXRoIHRoaXMgbWF0ZXJpYWwgb2NjdXJzLmA7Y29uc3QgdD1lLmdldENsYXNzTmFtZSgpO2VpLl9NYXRlcmlhbFBsdWdpbkNsYXNzVG9NYWluRGVmaW5lW3RdfHwoZWkuX01hdGVyaWFsUGx1Z2luQ2xhc3NUb01haW5EZWZpbmVbdF09Ik1BVEVSSUFMUExVR0lOXyIrICsrZWkuX01hdGVyaWFsUGx1Z2luQ291bnRlciksdGhpcy5fbWF0ZXJpYWwuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50LmJpbmQodGhpcyksdGhpcy5fcGx1Z2lucy5wdXNoKGUpLHRoaXMuX3BsdWdpbnMuc29ydCgocyxyKT0+cy5wcmlvcml0eS1yLnByaW9yaXR5KSx0aGlzLl9jb2RlSW5qZWN0aW9uUG9pbnRzPXt9O2NvbnN0IGk9e307aVtlaS5fTWF0ZXJpYWxQbHVnaW5DbGFzc1RvTWFpbkRlZmluZVt0XV09e3R5cGU6ImJvb2xlYW4iLGRlZmF1bHQ6ITB9O2Zvcihjb25zdCBzIG9mIHRoaXMuX3BsdWdpbnMpcy5jb2xsZWN0RGVmaW5lcyhpKSx0aGlzLl9jb2xsZWN0UG9pbnROYW1lcygidmVydGV4IixzLmdldEN1c3RvbUNvZGUoInZlcnRleCIpKSx0aGlzLl9jb2xsZWN0UG9pbnROYW1lcygiZnJhZ21lbnQiLHMuZ2V0Q3VzdG9tQ29kZSgiZnJhZ21lbnQiKSk7dGhpcy5fZGVmaW5lTmFtZXNGcm9tUGx1Z2lucz1pfV9hY3RpdmF0ZVBsdWdpbihlKXt0aGlzLl9hY3RpdmVQbHVnaW5zLmluZGV4T2YoZSk9PT0tMSYmKHRoaXMuX2FjdGl2ZVBsdWdpbnMucHVzaChlKSx0aGlzLl9hY3RpdmVQbHVnaW5zLnNvcnQoKHQsaSk9PnQucHJpb3JpdHktaS5wcmlvcml0eSksdGhpcy5fbWF0ZXJpYWwuX2NhbGxiYWNrUGx1Z2luRXZlbnRJc1JlYWR5Rm9yU3ViTWVzaD10aGlzLl9oYW5kbGVQbHVnaW5FdmVudElzUmVhZHlGb3JTdWJNZXNoLmJpbmQodGhpcyksdGhpcy5fbWF0ZXJpYWwuX2NhbGxiYWNrUGx1Z2luRXZlbnRQcmVwYXJlRGVmaW5lc0JlZm9yZUF0dHJpYnV0ZXM9dGhpcy5faGFuZGxlUGx1Z2luRXZlbnRQcmVwYXJlRGVmaW5lc0JlZm9yZUF0dHJpYnV0ZXMuYmluZCh0aGlzKSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50UHJlcGFyZURlZmluZXMuYmluZCh0aGlzKSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudEJpbmRGb3JTdWJNZXNoPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50QmluZEZvclN1Yk1lc2guYmluZCh0aGlzKSxlLnJlZ2lzdGVyRm9yRXh0cmFFdmVudHMmJih0aGlzLl9hY3RpdmVQbHVnaW5zRm9yRXh0cmFFdmVudHMucHVzaChlKSx0aGlzLl9hY3RpdmVQbHVnaW5zRm9yRXh0cmFFdmVudHMuc29ydCgodCxpKT0+dC5wcmlvcml0eS1pLnByaW9yaXR5KSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudEhhc1JlbmRlclRhcmdldFRleHR1cmVzPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50SGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXMuYmluZCh0aGlzKSx0aGlzLl9tYXRlcmlhbC5fY2FsbGJhY2tQbHVnaW5FdmVudEZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcz10aGlzLl9oYW5kbGVQbHVnaW5FdmVudEZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcy5iaW5kKHRoaXMpLHRoaXMuX21hdGVyaWFsLl9jYWxsYmFja1BsdWdpbkV2ZW50SGFyZEJpbmRGb3JTdWJNZXNoPXRoaXMuX2hhbmRsZVBsdWdpbkV2ZW50SGFyZEJpbmRGb3JTdWJNZXNoLmJpbmQodGhpcykpKX1nZXRQbHVnaW4oZSl7Zm9yKGxldCB0PTA7dDx0aGlzLl9wbHVnaW5zLmxlbmd0aDsrK3QpaWYodGhpcy5fcGx1Z2luc1t0XS5uYW1lPT09ZSlyZXR1cm4gdGhpcy5fcGx1Z2luc1t0XTtyZXR1cm4gbnVsbH1faGFuZGxlUGx1Z2luRXZlbnRJc1JlYWR5Rm9yU3ViTWVzaChlKXtsZXQgdD0hMDtmb3IoY29uc3QgaSBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXQ9dCYmaS5pc1JlYWR5Rm9yU3ViTWVzaChlLmRlZmluZXMsdGhpcy5fc2NlbmUsdGhpcy5fZW5naW5lLGUuc3ViTWVzaCk7ZS5pc1JlYWR5Rm9yU3ViTWVzaD10fV9oYW5kbGVQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzQmVmb3JlQXR0cmlidXRlcyhlKXtmb3IoY29uc3QgdCBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXQucHJlcGFyZURlZmluZXNCZWZvcmVBdHRyaWJ1dGVzKGUuZGVmaW5lcyx0aGlzLl9zY2VuZSxlLm1lc2gpfV9oYW5kbGVQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2FjdGl2ZVBsdWdpbnMpdC5wcmVwYXJlRGVmaW5lcyhlLmRlZmluZXMsdGhpcy5fc2NlbmUsZS5tZXNoKX1faGFuZGxlUGx1Z2luRXZlbnRIYXJkQmluZEZvclN1Yk1lc2goZSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fYWN0aXZlUGx1Z2luc0ZvckV4dHJhRXZlbnRzKXQuaGFyZEJpbmRGb3JTdWJNZXNoKHRoaXMuX21hdGVyaWFsLl91bmlmb3JtQnVmZmVyLHRoaXMuX3NjZW5lLHRoaXMuX2VuZ2luZSxlLnN1Yk1lc2gpfV9oYW5kbGVQbHVnaW5FdmVudEJpbmRGb3JTdWJNZXNoKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2FjdGl2ZVBsdWdpbnMpdC5iaW5kRm9yU3ViTWVzaCh0aGlzLl9tYXRlcmlhbC5fdW5pZm9ybUJ1ZmZlcix0aGlzLl9zY2VuZSx0aGlzLl9lbmdpbmUsZS5zdWJNZXNoKX1faGFuZGxlUGx1Z2luRXZlbnRIYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyhlKXtsZXQgdD0hMTtmb3IoY29uc3QgaSBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zRm9yRXh0cmFFdmVudHMpaWYodD1pLmhhc1JlbmRlclRhcmdldFRleHR1cmVzKCksdClicmVhaztlLmhhc1JlbmRlclRhcmdldFRleHR1cmVzPXR9X2hhbmRsZVBsdWdpbkV2ZW50RmlsbFJlbmRlclRhcmdldFRleHR1cmVzKGUpe2Zvcihjb25zdCB0IG9mIHRoaXMuX2FjdGl2ZVBsdWdpbnNGb3JFeHRyYUV2ZW50cyl0LmZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcyhlLnJlbmRlclRhcmdldHMpfV9oYW5kbGVQbHVnaW5FdmVudChlLHQpe3N3aXRjaChlKXtjYXNlIFFlLkdldEFjdGl2ZVRleHR1cmVzOntjb25zdCBpPXQ7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fYWN0aXZlUGx1Z2lucylzLmdldEFjdGl2ZVRleHR1cmVzKGkuYWN0aXZlVGV4dHVyZXMpO2JyZWFrfWNhc2UgUWUuR2V0QW5pbWF0YWJsZXM6e2NvbnN0IGk9dDtmb3IoY29uc3QgcyBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXMuZ2V0QW5pbWF0YWJsZXMoaS5hbmltYXRhYmxlcyk7YnJlYWt9Y2FzZSBRZS5IYXNUZXh0dXJlOntjb25zdCBpPXQ7bGV0IHM9ITE7Zm9yKGNvbnN0IHIgb2YgdGhpcy5fYWN0aXZlUGx1Z2lucylpZihzPXIuaGFzVGV4dHVyZShpLnRleHR1cmUpLHMpYnJlYWs7aS5oYXNUZXh0dXJlPXM7YnJlYWt9Y2FzZSBRZS5EaXNwb3NlZDp7Y29uc3QgaT10O2Zvcihjb25zdCBzIG9mIHRoaXMuX3BsdWdpbnMpcy5kaXNwb3NlKGkuZm9yY2VEaXNwb3NlVGV4dHVyZXMpO2JyZWFrfWNhc2UgUWUuR2V0RGVmaW5lTmFtZXM6e2NvbnN0IGk9dDtpLmRlZmluZU5hbWVzPXRoaXMuX2RlZmluZU5hbWVzRnJvbVBsdWdpbnM7YnJlYWt9Y2FzZSBRZS5QcmVwYXJlRWZmZWN0Ontjb25zdCBpPXQ7Zm9yKGNvbnN0IHMgb2YgdGhpcy5fYWN0aXZlUGx1Z2lucylpLmZhbGxiYWNrUmFuaz1zLmFkZEZhbGxiYWNrcyhpLmRlZmluZXMsaS5mYWxsYmFja3MsaS5mYWxsYmFja1JhbmspLHMuZ2V0QXR0cmlidXRlcyhpLmF0dHJpYnV0ZXMsdGhpcy5fc2NlbmUsaS5tZXNoKTt0aGlzLl91bmlmb3JtTGlzdC5sZW5ndGg+MCYmaS51bmlmb3Jtcy5wdXNoKC4uLnRoaXMuX3VuaWZvcm1MaXN0KSx0aGlzLl9zYW1wbGVyTGlzdC5sZW5ndGg+MCYmaS5zYW1wbGVycy5wdXNoKC4uLnRoaXMuX3NhbXBsZXJMaXN0KSx0aGlzLl91Ym9MaXN0Lmxlbmd0aD4wJiZpLnVuaWZvcm1CdWZmZXJzTmFtZXMucHVzaCguLi50aGlzLl91Ym9MaXN0KSxpLmN1c3RvbUNvZGU9dGhpcy5faW5qZWN0Q3VzdG9tQ29kZShpLmN1c3RvbUNvZGUpO2JyZWFrfWNhc2UgUWUuUHJlcGFyZVVuaWZvcm1CdWZmZXI6e2NvbnN0IGk9dDt0aGlzLl91Ym9EZWNsYXJhdGlvbj0iIix0aGlzLl92ZXJ0ZXhEZWNsYXJhdGlvbj0iIix0aGlzLl9mcmFnbWVudERlY2xhcmF0aW9uPSIiLHRoaXMuX3VuaWZvcm1MaXN0PVtdLHRoaXMuX3NhbXBsZXJMaXN0PVtdLHRoaXMuX3Vib0xpc3Q9W107Zm9yKGNvbnN0IHMgb2YgdGhpcy5fcGx1Z2lucyl7Y29uc3Qgcj1zLmdldFVuaWZvcm1zKCk7aWYocil7aWYoci51Ym8pZm9yKGNvbnN0IG4gb2Ygci51Ym8paS51Ym8uYWRkVW5pZm9ybShuLm5hbWUsbi5zaXplKSx0aGlzLl91Ym9EZWNsYXJhdGlvbis9YCR7bi50eXBlfSAke24ubmFtZX07XHIKYCx0aGlzLl91bmlmb3JtTGlzdC5wdXNoKG4ubmFtZSk7ci52ZXJ0ZXgmJih0aGlzLl92ZXJ0ZXhEZWNsYXJhdGlvbis9ci52ZXJ0ZXgrYFxyCmApLHIuZnJhZ21lbnQmJih0aGlzLl9mcmFnbWVudERlY2xhcmF0aW9uKz1yLmZyYWdtZW50K2BccgpgKX1zLmdldFNhbXBsZXJzKHRoaXMuX3NhbXBsZXJMaXN0KSxzLmdldFVuaWZvcm1CdWZmZXJzTmFtZXModGhpcy5fdWJvTGlzdCl9YnJlYWt9fX1fY29sbGVjdFBvaW50TmFtZXMoZSx0KXtpZih0KWZvcihjb25zdCBpIGluIHQpdGhpcy5fY29kZUluamVjdGlvblBvaW50c1tlXXx8KHRoaXMuX2NvZGVJbmplY3Rpb25Qb2ludHNbZV09e30pLHRoaXMuX2NvZGVJbmplY3Rpb25Qb2ludHNbZV1baV09ITB9X2luamVjdEN1c3RvbUNvZGUoZSl7cmV0dXJuKHQsaSk9Pnt2YXIgcztlJiYoaT1lKHQsaSkpLHRoaXMuX3Vib0RlY2xhcmF0aW9uJiYoaT1pLnJlcGxhY2UoIiNkZWZpbmUgQURESVRJT05BTF9VQk9fREVDTEFSQVRJT04iLHRoaXMuX3Vib0RlY2xhcmF0aW9uKSksdGhpcy5fdmVydGV4RGVjbGFyYXRpb24mJihpPWkucmVwbGFjZSgiI2RlZmluZSBBRERJVElPTkFMX1ZFUlRFWF9ERUNMQVJBVElPTiIsdGhpcy5fdmVydGV4RGVjbGFyYXRpb24pKSx0aGlzLl9mcmFnbWVudERlY2xhcmF0aW9uJiYoaT1pLnJlcGxhY2UoIiNkZWZpbmUgQURESVRJT05BTF9GUkFHTUVOVF9ERUNMQVJBVElPTiIsdGhpcy5fZnJhZ21lbnREZWNsYXJhdGlvbikpO2NvbnN0IHI9KHM9dGhpcy5fY29kZUluamVjdGlvblBvaW50cyk9PT1udWxsfHxzPT09dm9pZCAwP3ZvaWQgMDpzW3RdO2lmKCFyKXJldHVybiBpO2ZvcihsZXQgbiBpbiByKXtsZXQgYT0iIjtmb3IoY29uc3QgbyBvZiB0aGlzLl9hY3RpdmVQbHVnaW5zKXtjb25zdCBoPW8uZ2V0Q3VzdG9tQ29kZSh0KTtoIT1udWxsJiZoW25dJiYoYSs9aFtuXStgXHIKYCl9aWYoYS5sZW5ndGg+MClpZihuLmNoYXJBdCgwKT09PSIhIil7bj1uLnN1YnN0cmluZygxKTtsZXQgbz0iZyI7aWYobi5jaGFyQXQoMCk9PT0iISIpbz0iIixuPW4uc3Vic3RyaW5nKDEpO2Vsc2V7Y29uc3QgZD1nbC5leGVjKG4pO2QmJmQubGVuZ3RoPj0yJiYobz1kWzFdLG49bi5zdWJzdHJpbmcoby5sZW5ndGgrMSkpfW8uaW5kZXhPZigiZyIpPDAmJihvKz0iZyIpO2NvbnN0IGg9aSxsPW5ldyBSZWdFeHAobixvKTtsZXQgdT1sLmV4ZWMoaCk7Zm9yKDt1IT09bnVsbDspe2xldCBkPWE7Zm9yKGxldCBmPTA7Zjx1Lmxlbmd0aDsrK2YpZD1kLnJlcGxhY2UoIiQiK2YsdVtmXSk7aT1pLnJlcGxhY2UodVswXSxkKSx1PWwuZXhlYyhoKX19ZWxzZXtjb25zdCBvPSIjZGVmaW5lICIrbjtpPWkucmVwbGFjZShvLGBccgpgK2ErYFxyCmArbyl9fXJldHVybiBpfX19ZWkuX01hdGVyaWFsUGx1Z2luQ2xhc3NUb01haW5EZWZpbmU9e30sZWkuX01hdGVyaWFsUGx1Z2luQ291bnRlcj0wO2NsYXNzIGhze2NvbnN0cnVjdG9yKGUsdCxpLHMscj0hMCxuPSExKXt0aGlzLnByaW9yaXR5PTUwMCx0aGlzLnJlZ2lzdGVyRm9yRXh0cmFFdmVudHM9ITEsdGhpcy5fbWF0ZXJpYWw9ZSx0aGlzLm5hbWU9dCx0aGlzLnByaW9yaXR5PWksZS5wbHVnaW5NYW5hZ2VyfHwoZS5wbHVnaW5NYW5hZ2VyPW5ldyBlaShlKSksdGhpcy5fcGx1Z2luRGVmaW5lTmFtZXM9cyx0aGlzLl9wbHVnaW5NYW5hZ2VyPWUucGx1Z2luTWFuYWdlcixyJiZ0aGlzLl9wbHVnaW5NYW5hZ2VyLl9hZGRQbHVnaW4odGhpcyksbiYmdGhpcy5fZW5hYmxlKCEwKSx0aGlzLm1hcmtBbGxEZWZpbmVzQXNEaXJ0eT1lLl9kaXJ0eUNhbGxiYWNrc1s2M119X2VuYWJsZShlKXtlJiZ0aGlzLl9wbHVnaW5NYW5hZ2VyLl9hY3RpdmF0ZVBsdWdpbih0aGlzKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iTWF0ZXJpYWxQbHVnaW5CYXNlIn1pc1JlYWR5Rm9yU3ViTWVzaChlLHQsaSxzKXtyZXR1cm4hMH1oYXJkQmluZEZvclN1Yk1lc2goZSx0LGkscyl7fWJpbmRGb3JTdWJNZXNoKGUsdCxpLHMpe31kaXNwb3NlKGUpe31nZXRDdXN0b21Db2RlKGUpe3JldHVybiBudWxsfWNvbGxlY3REZWZpbmVzKGUpe2lmKHRoaXMuX3BsdWdpbkRlZmluZU5hbWVzKWZvcihjb25zdCB0IG9mIE9iamVjdC5rZXlzKHRoaXMuX3BsdWdpbkRlZmluZU5hbWVzKSl7aWYodFswXT09PSJfIiljb250aW51ZTtjb25zdCBpPXR5cGVvZiB0aGlzLl9wbHVnaW5EZWZpbmVOYW1lc1t0XTtlW3RdPXt0eXBlOmk9PT0ibnVtYmVyIj8ibnVtYmVyIjppPT09InN0cmluZyI/InN0cmluZyI6aT09PSJib29sZWFuIj8iYm9vbGVhbiI6Im9iamVjdCIsZGVmYXVsdDp0aGlzLl9wbHVnaW5EZWZpbmVOYW1lc1t0XX19fXByZXBhcmVEZWZpbmVzQmVmb3JlQXR0cmlidXRlcyhlLHQsaSl7fXByZXBhcmVEZWZpbmVzKGUsdCxpKXt9aGFzVGV4dHVyZShlKXtyZXR1cm4hMX1oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcygpe3JldHVybiExfWZpbGxSZW5kZXJUYXJnZXRUZXh0dXJlcyhlKXt9Z2V0QWN0aXZlVGV4dHVyZXMoZSl7fWdldEFuaW1hdGFibGVzKGUpe31hZGRGYWxsYmFja3MoZSx0LGkpe3JldHVybiBpfWdldFNhbXBsZXJzKGUpe31nZXRBdHRyaWJ1dGVzKGUsdCxpKXt9Z2V0VW5pZm9ybUJ1ZmZlcnNOYW1lcyhlKXt9Z2V0VW5pZm9ybXMoKXtyZXR1cm57fX1jb3B5VG8oZSl7YWUuQ2xvbmUoKCk9PmUsdGhpcyl9c2VyaWFsaXplKCl7cmV0dXJuIGFlLlNlcmlhbGl6ZSh0aGlzKX1wYXJzZShlLHQsaSl7YWUuUGFyc2UoKCk9PnRoaXMsZSx0LGkpfX1UKFtSKCldLGhzLnByb3RvdHlwZSwibmFtZSIsdm9pZCAwKSxUKFtSKCldLGhzLnByb3RvdHlwZSwicHJpb3JpdHkiLHZvaWQgMCksVChbUigpXSxocy5wcm90b3R5cGUsInJlZ2lzdGVyRm9yRXh0cmFFdmVudHMiLHZvaWQgMCk7Y2xhc3MgcGwgZXh0ZW5kcyB5c3tjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5ERVRBSUw9ITEsdGhpcy5ERVRBSUxESVJFQ1RVVj0wLHRoaXMuREVUQUlMX05PUk1BTEJMRU5ETUVUSE9EPTB9fWNsYXNzIHBpIGV4dGVuZHMgaHN7Y29uc3RydWN0b3IoZSx0PSEwKXtzdXBlcihlLCJEZXRhaWxNYXAiLDE0MCxuZXcgcGwsdCksdGhpcy5fdGV4dHVyZT1udWxsLHRoaXMuZGlmZnVzZUJsZW5kTGV2ZWw9MSx0aGlzLnJvdWdobmVzc0JsZW5kTGV2ZWw9MSx0aGlzLmJ1bXBMZXZlbD0xLHRoaXMuX25vcm1hbEJsZW5kTWV0aG9kPVAuTUFURVJJQUxfTk9STUFMQkxFTkRNRVRIT0RfV0hJVEVPVVQsdGhpcy5faXNFbmFibGVkPSExLHRoaXMuaXNFbmFibGVkPSExLHRoaXMuX2ludGVybmFsTWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eT1lLl9kaXJ0eUNhbGxiYWNrc1sxXX1fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpe3RoaXMuX2VuYWJsZSh0aGlzLl9pc0VuYWJsZWQpLHRoaXMuX2ludGVybmFsTWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpfWlzUmVhZHlGb3JTdWJNZXNoKGUsdCxpKXtyZXR1cm4gdGhpcy5faXNFbmFibGVkPyEoZS5fYXJlVGV4dHVyZXNEaXJ0eSYmdC50ZXh0dXJlc0VuYWJsZWQmJmkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuX3RleHR1cmUmJnVlLkRldGFpbFRleHR1cmVFbmFibGVkJiYhdGhpcy5fdGV4dHVyZS5pc1JlYWR5KCkpOiEwfXByZXBhcmVEZWZpbmVzKGUsdCl7aWYodGhpcy5faXNFbmFibGVkKXtlLkRFVEFJTF9OT1JNQUxCTEVORE1FVEhPRD10aGlzLl9ub3JtYWxCbGVuZE1ldGhvZDtjb25zdCBpPXQuZ2V0RW5naW5lKCk7ZS5fYXJlVGV4dHVyZXNEaXJ0eSYmKGkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuX3RleHR1cmUmJnVlLkRldGFpbFRleHR1cmVFbmFibGVkJiZ0aGlzLl9pc0VuYWJsZWQ/KGllLlByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYodGhpcy5fdGV4dHVyZSxlLCJERVRBSUwiKSxlLkRFVEFJTF9OT1JNQUxCTEVORE1FVEhPRD10aGlzLl9ub3JtYWxCbGVuZE1ldGhvZCk6ZS5ERVRBSUw9ITEpfWVsc2UgZS5ERVRBSUw9ITF9YmluZEZvclN1Yk1lc2goZSx0KXtpZighdGhpcy5faXNFbmFibGVkKXJldHVybjtjb25zdCBpPXRoaXMuX21hdGVyaWFsLmlzRnJvemVuOyghZS51c2VVYm98fCFpfHwhZS5pc1N5bmMpJiZ0aGlzLl90ZXh0dXJlJiZ1ZS5EZXRhaWxUZXh0dXJlRW5hYmxlZCYmKGUudXBkYXRlRmxvYXQ0KCJ2RGV0YWlsSW5mb3MiLHRoaXMuX3RleHR1cmUuY29vcmRpbmF0ZXNJbmRleCx0aGlzLmRpZmZ1c2VCbGVuZExldmVsLHRoaXMuYnVtcExldmVsLHRoaXMucm91Z2huZXNzQmxlbmRMZXZlbCksaWUuQmluZFRleHR1cmVNYXRyaXgodGhpcy5fdGV4dHVyZSxlLCJkZXRhaWwiKSksdC50ZXh0dXJlc0VuYWJsZWQmJnRoaXMuX3RleHR1cmUmJnVlLkRldGFpbFRleHR1cmVFbmFibGVkJiZlLnNldFRleHR1cmUoImRldGFpbFNhbXBsZXIiLHRoaXMuX3RleHR1cmUpfWhhc1RleHR1cmUoZSl7cmV0dXJuIHRoaXMuX3RleHR1cmU9PT1lfWdldEFjdGl2ZVRleHR1cmVzKGUpe3RoaXMuX3RleHR1cmUmJmUucHVzaCh0aGlzLl90ZXh0dXJlKX1nZXRBbmltYXRhYmxlcyhlKXt0aGlzLl90ZXh0dXJlJiZ0aGlzLl90ZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuX3RleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMuX3RleHR1cmUpfWRpc3Bvc2UoZSl7dmFyIHQ7ZSYmKCh0PXRoaXMuX3RleHR1cmUpPT09bnVsbHx8dD09PXZvaWQgMHx8dC5kaXNwb3NlKCkpfWdldENsYXNzTmFtZSgpe3JldHVybiJEZXRhaWxNYXBDb25maWd1cmF0aW9uIn1nZXRTYW1wbGVycyhlKXtlLnB1c2goImRldGFpbFNhbXBsZXIiKX1nZXRVbmlmb3Jtcygpe3JldHVybnt1Ym86W3tuYW1lOiJ2RGV0YWlsSW5mb3MiLHNpemU6NCx0eXBlOiJ2ZWM0In0se25hbWU6ImRldGFpbE1hdHJpeCIsc2l6ZToxNix0eXBlOiJtYXQ0In1dfX19VChbbXQoImRldGFpbFRleHR1cmUiKSxiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0scGkucHJvdG90eXBlLCJ0ZXh0dXJlIix2b2lkIDApLFQoW1IoKV0scGkucHJvdG90eXBlLCJkaWZmdXNlQmxlbmRMZXZlbCIsdm9pZCAwKSxUKFtSKCldLHBpLnByb3RvdHlwZSwicm91Z2huZXNzQmxlbmRMZXZlbCIsdm9pZCAwKSxUKFtSKCldLHBpLnByb3RvdHlwZSwiYnVtcExldmVsIix2b2lkIDApLFQoW1IoKSxiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0scGkucHJvdG90eXBlLCJub3JtYWxCbGVuZE1ldGhvZCIsdm9pZCAwKSxUKFtSKCksYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLHBpLnByb3RvdHlwZSwiaXNFbmFibGVkIix2b2lkIDApO2NvbnN0IEdzPXtlZmZlY3Q6bnVsbCxzdWJNZXNoOm51bGx9O2NsYXNzIG1sIGV4dGVuZHMgeXN7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSksdGhpcy5NQUlOVVYxPSExLHRoaXMuTUFJTlVWMj0hMSx0aGlzLk1BSU5VVjM9ITEsdGhpcy5NQUlOVVY0PSExLHRoaXMuTUFJTlVWNT0hMSx0aGlzLk1BSU5VVjY9ITEsdGhpcy5ESUZGVVNFPSExLHRoaXMuRElGRlVTRURJUkVDVFVWPTAsdGhpcy5CQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkU9ITEsdGhpcy5BTUJJRU5UPSExLHRoaXMuQU1CSUVOVERJUkVDVFVWPTAsdGhpcy5PUEFDSVRZPSExLHRoaXMuT1BBQ0lUWURJUkVDVFVWPTAsdGhpcy5PUEFDSVRZUkdCPSExLHRoaXMuUkVGTEVDVElPTj0hMSx0aGlzLkVNSVNTSVZFPSExLHRoaXMuRU1JU1NJVkVESVJFQ1RVVj0wLHRoaXMuU1BFQ1VMQVI9ITEsdGhpcy5TUEVDVUxBUkRJUkVDVFVWPTAsdGhpcy5CVU1QPSExLHRoaXMuQlVNUERJUkVDVFVWPTAsdGhpcy5QQVJBTExBWD0hMSx0aGlzLlBBUkFMTEFYT0NDTFVTSU9OPSExLHRoaXMuU1BFQ1VMQVJPVkVSQUxQSEE9ITEsdGhpcy5DTElQUExBTkU9ITEsdGhpcy5DTElQUExBTkUyPSExLHRoaXMuQ0xJUFBMQU5FMz0hMSx0aGlzLkNMSVBQTEFORTQ9ITEsdGhpcy5DTElQUExBTkU1PSExLHRoaXMuQ0xJUFBMQU5FNj0hMSx0aGlzLkFMUEhBVEVTVD0hMSx0aGlzLkRFUFRIUFJFUEFTUz0hMSx0aGlzLkFMUEhBRlJPTURJRkZVU0U9ITEsdGhpcy5QT0lOVFNJWkU9ITEsdGhpcy5GT0c9ITEsdGhpcy5TUEVDVUxBUlRFUk09ITEsdGhpcy5ESUZGVVNFRlJFU05FTD0hMSx0aGlzLk9QQUNJVFlGUkVTTkVMPSExLHRoaXMuUkVGTEVDVElPTkZSRVNORUw9ITEsdGhpcy5SRUZSQUNUSU9ORlJFU05FTD0hMSx0aGlzLkVNSVNTSVZFRlJFU05FTD0hMSx0aGlzLkZSRVNORUw9ITEsdGhpcy5OT1JNQUw9ITEsdGhpcy5UQU5HRU5UPSExLHRoaXMuVVYxPSExLHRoaXMuVVYyPSExLHRoaXMuVVYzPSExLHRoaXMuVVY0PSExLHRoaXMuVVY1PSExLHRoaXMuVVY2PSExLHRoaXMuVkVSVEVYQ09MT1I9ITEsdGhpcy5WRVJURVhBTFBIQT0hMSx0aGlzLk5VTV9CT05FX0lORkxVRU5DRVJTPTAsdGhpcy5Cb25lc1Blck1lc2g9MCx0aGlzLkJPTkVURVhUVVJFPSExLHRoaXMuQk9ORVNfVkVMT0NJVFlfRU5BQkxFRD0hMSx0aGlzLklOU1RBTkNFUz0hMSx0aGlzLlRISU5fSU5TVEFOQ0VTPSExLHRoaXMuSU5TVEFOQ0VTQ09MT1I9ITEsdGhpcy5HTE9TU0lORVNTPSExLHRoaXMuUk9VR0hORVNTPSExLHRoaXMuRU1JU1NJVkVBU0lMTFVNSU5BVElPTj0hMSx0aGlzLkxJTktFTUlTU0lWRVdJVEhESUZGVVNFPSExLHRoaXMuUkVGTEVDVElPTkZSRVNORUxGUk9NU1BFQ1VMQVI9ITEsdGhpcy5MSUdIVE1BUD0hMSx0aGlzLkxJR0hUTUFQRElSRUNUVVY9MCx0aGlzLk9CSkVDVFNQQUNFX05PUk1BTE1BUD0hMSx0aGlzLlVTRUxJR0hUTUFQQVNTSEFET1dNQVA9ITEsdGhpcy5SRUZMRUNUSU9OTUFQXzNEPSExLHRoaXMuUkVGTEVDVElPTk1BUF9TUEhFUklDQUw9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX1BMQU5BUj0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfQ1VCSUM9ITEsdGhpcy5VU0VfTE9DQUxfUkVGTEVDVElPTk1BUF9DVUJJQz0hMSx0aGlzLlVTRV9MT0NBTF9SRUZSQUNUSU9OTUFQX0NVQklDPSExLHRoaXMuUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OPSExLHRoaXMuUkVGTEVDVElPTk1BUF9TS1lCT1g9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VYUExJQ0lUPSExLHRoaXMuUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVI9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRD0hMSx0aGlzLlJFRkxFQ1RJT05NQVBfTUlSUk9SRURFUVVJUkVDVEFOR1VMQVJfRklYRUQ9ITEsdGhpcy5SRUZMRUNUSU9OTUFQX09QUE9TSVRFWj0hMSx0aGlzLklOVkVSVENVQklDTUFQPSExLHRoaXMuTE9HQVJJVEhNSUNERVBUSD0hMSx0aGlzLlJFRlJBQ1RJT049ITEsdGhpcy5SRUZSQUNUSU9OTUFQXzNEPSExLHRoaXMuUkVGTEVDVElPTk9WRVJBTFBIQT0hMSx0aGlzLlRXT1NJREVETElHSFRJTkc9ITEsdGhpcy5TSEFET1dGTE9BVD0hMSx0aGlzLk1PUlBIVEFSR0VUUz0hMSx0aGlzLk1PUlBIVEFSR0VUU19OT1JNQUw9ITEsdGhpcy5NT1JQSFRBUkdFVFNfVEFOR0VOVD0hMSx0aGlzLk1PUlBIVEFSR0VUU19VVj0hMSx0aGlzLk5VTV9NT1JQSF9JTkZMVUVOQ0VSUz0wLHRoaXMuTU9SUEhUQVJHRVRTX1RFWFRVUkU9ITEsdGhpcy5OT05VTklGT1JNU0NBTElORz0hMSx0aGlzLlBSRU1VTFRJUExZQUxQSEE9ITEsdGhpcy5BTFBIQVRFU1RfQUZURVJBTExBTFBIQUNPTVBVVEFUSU9OUz0hMSx0aGlzLkFMUEhBQkxFTkQ9ITAsdGhpcy5QUkVQQVNTPSExLHRoaXMuUFJFUEFTU19JUlJBRElBTkNFPSExLHRoaXMuUFJFUEFTU19JUlJBRElBTkNFX0lOREVYPS0xLHRoaXMuUFJFUEFTU19BTEJFRE9fU1FSVD0hMSx0aGlzLlBSRVBBU1NfQUxCRURPX1NRUlRfSU5ERVg9LTEsdGhpcy5QUkVQQVNTX0RFUFRIPSExLHRoaXMuUFJFUEFTU19ERVBUSF9JTkRFWD0tMSx0aGlzLlBSRVBBU1NfTk9STUFMPSExLHRoaXMuUFJFUEFTU19OT1JNQUxfSU5ERVg9LTEsdGhpcy5QUkVQQVNTX1BPU0lUSU9OPSExLHRoaXMuUFJFUEFTU19QT1NJVElPTl9JTkRFWD0tMSx0aGlzLlBSRVBBU1NfVkVMT0NJVFk9ITEsdGhpcy5QUkVQQVNTX1ZFTE9DSVRZX0lOREVYPS0xLHRoaXMuUFJFUEFTU19SRUZMRUNUSVZJVFk9ITEsdGhpcy5QUkVQQVNTX1JFRkxFQ1RJVklUWV9JTkRFWD0tMSx0aGlzLlNDRU5FX01SVF9DT1VOVD0wLHRoaXMuUkdCRExJR0hUTUFQPSExLHRoaXMuUkdCRFJFRkxFQ1RJT049ITEsdGhpcy5SR0JEUkVGUkFDVElPTj0hMSx0aGlzLklNQUdFUFJPQ0VTU0lORz0hMSx0aGlzLlZJR05FVFRFPSExLHRoaXMuVklHTkVUVEVCTEVORE1PREVNVUxUSVBMWT0hMSx0aGlzLlZJR05FVFRFQkxFTkRNT0RFT1BBUVVFPSExLHRoaXMuVE9ORU1BUFBJTkc9ITEsdGhpcy5UT05FTUFQUElOR19BQ0VTPSExLHRoaXMuQ09OVFJBU1Q9ITEsdGhpcy5DT0xPUkNVUlZFUz0hMSx0aGlzLkNPTE9SR1JBRElORz0hMSx0aGlzLkNPTE9SR1JBRElORzNEPSExLHRoaXMuU0FNUExFUjNER1JFRU5ERVBUSD0hMSx0aGlzLlNBTVBMRVIzREJHUk1BUD0hMSx0aGlzLkRJVEhFUj0hMSx0aGlzLklNQUdFUFJPQ0VTU0lOR1BPU1RQUk9DRVNTPSExLHRoaXMuU0tJUEZJTkFMQ09MT1JDTEFNUD0hMSx0aGlzLk1VTFRJVklFVz0hMSx0aGlzLk9SREVSX0lOREVQRU5ERU5UX1RSQU5TUEFSRU5DWT0hMSx0aGlzLk9SREVSX0lOREVQRU5ERU5UX1RSQU5TUEFSRU5DWV8xNkJJVFM9ITEsdGhpcy5DQU1FUkFfT1JUSE9HUkFQSElDPSExLHRoaXMuQ0FNRVJBX1BFUlNQRUNUSVZFPSExLHRoaXMuSVNfUkVGTEVDVElPTl9MSU5FQVI9ITEsdGhpcy5JU19SRUZSQUNUSU9OX0xJTkVBUj0hMSx0aGlzLkVYUE9TVVJFPSExLHRoaXMucmVidWlsZCgpfXNldFJlZmxlY3Rpb25Nb2RlKGUpe2NvbnN0IHQ9WyJSRUZMRUNUSU9OTUFQX0NVQklDIiwiUkVGTEVDVElPTk1BUF9FWFBMSUNJVCIsIlJFRkxFQ1RJT05NQVBfUExBTkFSIiwiUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OIiwiUkVGTEVDVElPTk1BUF9QUk9KRUNUSU9OIiwiUkVGTEVDVElPTk1BUF9TS1lCT1giLCJSRUZMRUNUSU9OTUFQX1NQSEVSSUNBTCIsIlJFRkxFQ1RJT05NQVBfRVFVSVJFQ1RBTkdVTEFSIiwiUkVGTEVDVElPTk1BUF9FUVVJUkVDVEFOR1VMQVJfRklYRUQiLCJSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEIl07Zm9yKGNvbnN0IGkgb2YgdCl0aGlzW2ldPWk9PT1lfX1jbGFzcyBCIGV4dGVuZHMgVnJ7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQpLHRoaXMuX2RpZmZ1c2VUZXh0dXJlPW51bGwsdGhpcy5fYW1iaWVudFRleHR1cmU9bnVsbCx0aGlzLl9vcGFjaXR5VGV4dHVyZT1udWxsLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlPW51bGwsdGhpcy5fZW1pc3NpdmVUZXh0dXJlPW51bGwsdGhpcy5fc3BlY3VsYXJUZXh0dXJlPW51bGwsdGhpcy5fYnVtcFRleHR1cmU9bnVsbCx0aGlzLl9saWdodG1hcFRleHR1cmU9bnVsbCx0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZT1udWxsLHRoaXMuYW1iaWVudENvbG9yPW5ldyByZSgwLDAsMCksdGhpcy5kaWZmdXNlQ29sb3I9bmV3IHJlKDEsMSwxKSx0aGlzLnNwZWN1bGFyQ29sb3I9bmV3IHJlKDEsMSwxKSx0aGlzLmVtaXNzaXZlQ29sb3I9bmV3IHJlKDAsMCwwKSx0aGlzLnNwZWN1bGFyUG93ZXI9NjQsdGhpcy5fdXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmU9ITEsdGhpcy5fdXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbj0hMSx0aGlzLl9saW5rRW1pc3NpdmVXaXRoRGlmZnVzZT0hMSx0aGlzLl91c2VTcGVjdWxhck92ZXJBbHBoYT0hMSx0aGlzLl91c2VSZWZsZWN0aW9uT3ZlckFscGhhPSExLHRoaXMuX2Rpc2FibGVMaWdodGluZz0hMSx0aGlzLl91c2VPYmplY3RTcGFjZU5vcm1hbE1hcD0hMSx0aGlzLl91c2VQYXJhbGxheD0hMSx0aGlzLl91c2VQYXJhbGxheE9jY2x1c2lvbj0hMSx0aGlzLnBhcmFsbGF4U2NhbGVCaWFzPS4wNSx0aGlzLl9yb3VnaG5lc3M9MCx0aGlzLmluZGV4T2ZSZWZyYWN0aW9uPS45OCx0aGlzLmludmVydFJlZnJhY3Rpb25ZPSEwLHRoaXMuYWxwaGFDdXRPZmY9LjQsdGhpcy5fdXNlTGlnaHRtYXBBc1NoYWRvd21hcD0hMSx0aGlzLl91c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhcj0hMSx0aGlzLl91c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGE9ITEsdGhpcy5fbWF4U2ltdWx0YW5lb3VzTGlnaHRzPTQsdGhpcy5faW52ZXJ0Tm9ybWFsTWFwWD0hMSx0aGlzLl9pbnZlcnROb3JtYWxNYXBZPSExLHRoaXMuX3R3b1NpZGVkTGlnaHRpbmc9ITEsdGhpcy5fcmVuZGVyVGFyZ2V0cz1uZXcgJGUoMTYpLHRoaXMuX3dvcmxkVmlld1Byb2plY3Rpb25NYXRyaXg9eC5aZXJvKCksdGhpcy5fZ2xvYmFsQW1iaWVudENvbG9yPW5ldyByZSgwLDAsMCksdGhpcy5fY2FjaGVIYXNSZW5kZXJUYXJnZXRUZXh0dXJlcz0hMSx0aGlzLmRldGFpbE1hcD1uZXcgcGkodGhpcyksdGhpcy5fYXR0YWNoSW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbihudWxsKSx0aGlzLnByZVBhc3NDb25maWd1cmF0aW9uPW5ldyBrcix0aGlzLmdldFJlbmRlclRhcmdldFRleHR1cmVzPSgpPT4odGhpcy5fcmVuZGVyVGFyZ2V0cy5yZXNldCgpLEIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSYmdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXQmJnRoaXMuX3JlbmRlclRhcmdldHMucHVzaCh0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSksQi5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQmJnRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5pc1JlbmRlclRhcmdldCYmdGhpcy5fcmVuZGVyVGFyZ2V0cy5wdXNoKHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlKSx0aGlzLl9ldmVudEluZm8ucmVuZGVyVGFyZ2V0cz10aGlzLl9yZW5kZXJUYXJnZXRzLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRGaWxsUmVuZGVyVGFyZ2V0VGV4dHVyZXModGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9yZW5kZXJUYXJnZXRzKX1nZXQgaW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbigpe3JldHVybiB0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9ufXNldCBpbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uKGUpe3RoaXMuX2F0dGFjaEltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24oZSksdGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSgpfV9hdHRhY2hJbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uKGUpe2UhPT10aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uJiYodGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiYmdGhpcy5faW1hZ2VQcm9jZXNzaW5nT2JzZXJ2ZXImJnRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24ub25VcGRhdGVQYXJhbWV0ZXJzLnJlbW92ZSh0aGlzLl9pbWFnZVByb2Nlc3NpbmdPYnNlcnZlciksZT90aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uPWU6dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbj10aGlzLmdldFNjZW5lKCkuaW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbix0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uJiYodGhpcy5faW1hZ2VQcm9jZXNzaW5nT2JzZXJ2ZXI9dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5vblVwZGF0ZVBhcmFtZXRlcnMuYWRkKCgpPT57dGhpcy5fbWFya0FsbFN1Yk1lc2hlc0FzSW1hZ2VQcm9jZXNzaW5nRGlydHkoKX0pKSl9Z2V0IGlzUHJlUGFzc0NhcGFibGUoKXtyZXR1cm4hdGhpcy5kaXNhYmxlRGVwdGhXcml0ZX1nZXQgY2FtZXJhQ29sb3JDdXJ2ZXNFbmFibGVkKCl7cmV0dXJuIHRoaXMuaW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5jb2xvckN1cnZlc0VuYWJsZWR9c2V0IGNhbWVyYUNvbG9yQ3VydmVzRW5hYmxlZChlKXt0aGlzLmltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uY29sb3JDdXJ2ZXNFbmFibGVkPWV9Z2V0IGNhbWVyYUNvbG9yR3JhZGluZ0VuYWJsZWQoKXtyZXR1cm4gdGhpcy5pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yR3JhZGluZ0VuYWJsZWR9c2V0IGNhbWVyYUNvbG9yR3JhZGluZ0VuYWJsZWQoZSl7dGhpcy5pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yR3JhZGluZ0VuYWJsZWQ9ZX1nZXQgY2FtZXJhVG9uZU1hcHBpbmdFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24udG9uZU1hcHBpbmdFbmFibGVkfXNldCBjYW1lcmFUb25lTWFwcGluZ0VuYWJsZWQoZSl7dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi50b25lTWFwcGluZ0VuYWJsZWQ9ZX1nZXQgY2FtZXJhRXhwb3N1cmUoKXtyZXR1cm4gdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5leHBvc3VyZX1zZXQgY2FtZXJhRXhwb3N1cmUoZSl7dGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5leHBvc3VyZT1lfWdldCBjYW1lcmFDb250cmFzdCgpe3JldHVybiB0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbnRyYXN0fXNldCBjYW1lcmFDb250cmFzdChlKXt0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbnRyYXN0PWV9Z2V0IGNhbWVyYUNvbG9yR3JhZGluZ1RleHR1cmUoKXtyZXR1cm4gdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5jb2xvckdyYWRpbmdUZXh0dXJlfXNldCBjYW1lcmFDb2xvckdyYWRpbmdUZXh0dXJlKGUpe3RoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uY29sb3JHcmFkaW5nVGV4dHVyZT1lfWdldCBjYW1lcmFDb2xvckN1cnZlcygpe3JldHVybiB0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yQ3VydmVzfXNldCBjYW1lcmFDb2xvckN1cnZlcyhlKXt0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uLmNvbG9yQ3VydmVzPWV9Z2V0IGNhblJlbmRlclRvTVJUKCl7cmV0dXJuITB9Z2V0IGhhc1JlbmRlclRhcmdldFRleHR1cmVzKCl7cmV0dXJuIEIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSYmdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXR8fEIuUmVmcmFjdGlvblRleHR1cmVFbmFibGVkJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZSYmdGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNSZW5kZXJUYXJnZXQ/ITA6dGhpcy5fY2FjaGVIYXNSZW5kZXJUYXJnZXRUZXh0dXJlc31nZXRDbGFzc05hbWUoKXtyZXR1cm4iU3RhbmRhcmRNYXRlcmlhbCJ9Z2V0IHVzZUxvZ2FyaXRobWljRGVwdGgoKXtyZXR1cm4gdGhpcy5fdXNlTG9nYXJpdGhtaWNEZXB0aH1zZXQgdXNlTG9nYXJpdGhtaWNEZXB0aChlKXt0aGlzLl91c2VMb2dhcml0aG1pY0RlcHRoPWUmJnRoaXMuZ2V0U2NlbmUoKS5nZXRFbmdpbmUoKS5nZXRDYXBzKCkuZnJhZ21lbnREZXB0aFN1cHBvcnRlZCx0aGlzLl9tYXJrQWxsU3ViTWVzaGVzQXNNaXNjRGlydHkoKX1uZWVkQWxwaGFCbGVuZGluZygpe3JldHVybiB0aGlzLl9kaXNhYmxlQWxwaGFCbGVuZGluZz8hMTp0aGlzLmFscGhhPDF8fHRoaXMuX29wYWNpdHlUZXh0dXJlIT1udWxsfHx0aGlzLl9zaG91bGRVc2VBbHBoYUZyb21EaWZmdXNlVGV4dHVyZSgpfHx0aGlzLl9vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWR9bmVlZEFscGhhVGVzdGluZygpe3JldHVybiB0aGlzLl9mb3JjZUFscGhhVGVzdD8hMDp0aGlzLl9oYXNBbHBoYUNoYW5uZWwoKSYmKHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9PW51bGx8fHRoaXMuX3RyYW5zcGFyZW5jeU1vZGU9PT1QLk1BVEVSSUFMX0FMUEhBVEVTVCl9X3Nob3VsZFVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlKCl7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlIT1udWxsJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5oYXNBbHBoYSYmdGhpcy5fdXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUmJnRoaXMuX3RyYW5zcGFyZW5jeU1vZGUhPT1QLk1BVEVSSUFMX09QQVFVRX1faGFzQWxwaGFDaGFubmVsKCl7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlIT1udWxsJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5oYXNBbHBoYXx8dGhpcy5fb3BhY2l0eVRleHR1cmUhPW51bGx9Z2V0QWxwaGFUZXN0VGV4dHVyZSgpe3JldHVybiB0aGlzLl9kaWZmdXNlVGV4dHVyZX1pc1JlYWR5Rm9yU3ViTWVzaChlLHQsaT0hMSl7aWYodGhpcy5fdW5pZm9ybUJ1ZmZlckxheW91dEJ1aWx0fHx0aGlzLmJ1aWxkVW5pZm9ybUxheW91dCgpLHQuZWZmZWN0JiZ0aGlzLmlzRnJvemVuJiZ0LmVmZmVjdC5fd2FzUHJldmlvdXNseVJlYWR5JiZ0LmVmZmVjdC5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPT09aSlyZXR1cm4hMDt0Lm1hdGVyaWFsRGVmaW5lc3x8KHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLkdldERlZmluZU5hbWVzLHRoaXMuX2V2ZW50SW5mbyksdC5tYXRlcmlhbERlZmluZXM9bmV3IG1sKHRoaXMuX2V2ZW50SW5mby5kZWZpbmVOYW1lcykpO2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpLHI9dC5tYXRlcmlhbERlZmluZXM7aWYodGhpcy5faXNSZWFkeUZvclN1Yk1lc2godCkpcmV0dXJuITA7Y29uc3Qgbj1zLmdldEVuZ2luZSgpO3IuX25lZWROb3JtYWxzPWllLlByZXBhcmVEZWZpbmVzRm9yTGlnaHRzKHMsZSxyLCEwLHRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0cyx0aGlzLl9kaXNhYmxlTGlnaHRpbmcpLGllLlByZXBhcmVEZWZpbmVzRm9yTXVsdGl2aWV3KHMscik7Y29uc3QgYT10aGlzLm5lZWRBbHBoYUJsZW5kaW5nRm9yTWVzaChlKSYmdGhpcy5nZXRTY2VuZSgpLnVzZU9yZGVySW5kZXBlbmRlbnRUcmFuc3BhcmVuY3k7aWYoaWUuUHJlcGFyZURlZmluZXNGb3JQcmVQYXNzKHMscix0aGlzLmNhblJlbmRlclRvTVJUJiYhYSksaWUuUHJlcGFyZURlZmluZXNGb3JPSVQocyxyLGEpLHIuX2FyZVRleHR1cmVzRGlydHkpe3RoaXMuX2V2ZW50SW5mby5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcz0hMSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50SGFzUmVuZGVyVGFyZ2V0VGV4dHVyZXModGhpcy5fZXZlbnRJbmZvKSx0aGlzLl9jYWNoZUhhc1JlbmRlclRhcmdldFRleHR1cmVzPXRoaXMuX2V2ZW50SW5mby5oYXNSZW5kZXJUYXJnZXRUZXh0dXJlcyxyLl9uZWVkVVZzPSExO2ZvcihsZXQgaD0xO2g8PTY7KytoKXJbIk1BSU5VViIraF09ITE7aWYocy50ZXh0dXJlc0VuYWJsZWQpe2lmKHIuRElGRlVTRURJUkVDVFVWPTAsci5CVU1QRElSRUNUVVY9MCxyLkFNQklFTlRESVJFQ1RVVj0wLHIuT1BBQ0lUWURJUkVDVFVWPTAsci5FTUlTU0lWRURJUkVDVFVWPTAsci5TUEVDVUxBUkRJUkVDVFVWPTAsci5MSUdIVE1BUERJUkVDVFVWPTAsdGhpcy5fZGlmZnVzZVRleHR1cmUmJkIuRGlmZnVzZVRleHR1cmVFbmFibGVkKWlmKHRoaXMuX2RpZmZ1c2VUZXh0dXJlLmlzUmVhZHlPck5vdEJsb2NraW5nKCkpaWUuUHJlcGFyZURlZmluZXNGb3JNZXJnZWRVVih0aGlzLl9kaWZmdXNlVGV4dHVyZSxyLCJESUZGVVNFIik7ZWxzZSByZXR1cm4hMTtlbHNlIHIuRElGRlVTRT0hMTtpZih0aGlzLl9hbWJpZW50VGV4dHVyZSYmQi5BbWJpZW50VGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fYW1iaWVudFRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSlpZS5QcmVwYXJlRGVmaW5lc0Zvck1lcmdlZFVWKHRoaXMuX2FtYmllbnRUZXh0dXJlLHIsIkFNQklFTlQiKTtlbHNlIHJldHVybiExO2Vsc2Ugci5BTUJJRU5UPSExO2lmKHRoaXMuX29wYWNpdHlUZXh0dXJlJiZCLk9wYWNpdHlUZXh0dXJlRW5hYmxlZClpZih0aGlzLl9vcGFjaXR5VGV4dHVyZS5pc1JlYWR5T3JOb3RCbG9ja2luZygpKWllLlByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYodGhpcy5fb3BhY2l0eVRleHR1cmUsciwiT1BBQ0lUWSIpLHIuT1BBQ0lUWVJHQj10aGlzLl9vcGFjaXR5VGV4dHVyZS5nZXRBbHBoYUZyb21SR0I7ZWxzZSByZXR1cm4hMTtlbHNlIHIuT1BBQ0lUWT0hMTtpZih0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSYmQi5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSl7c3dpdGNoKHIuX25lZWROb3JtYWxzPSEwLHIuUkVGTEVDVElPTj0hMCxyLlJPVUdITkVTUz10aGlzLl9yb3VnaG5lc3M+MCxyLlJFRkxFQ1RJT05PVkVSQUxQSEE9dGhpcy5fdXNlUmVmbGVjdGlvbk92ZXJBbHBoYSxyLklOVkVSVENVQklDTUFQPXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmNvb3JkaW5hdGVzTW9kZT09PU4uSU5WQ1VCSUNfTU9ERSxyLlJFRkxFQ1RJT05NQVBfM0Q9dGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNDdWJlLHIuUkVGTEVDVElPTk1BUF9PUFBPU0lURVo9ci5SRUZMRUNUSU9OTUFQXzNEJiZ0aGlzLmdldFNjZW5lKCkudXNlUmlnaHRIYW5kZWRTeXN0ZW0/IXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmludmVydFo6dGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaW52ZXJ0WixyLlJHQkRSRUZMRUNUSU9OPXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmlzUkdCRCx0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZS5jb29yZGluYXRlc01vZGUpe2Nhc2UgTi5FWFBMSUNJVF9NT0RFOnIuc2V0UmVmbGVjdGlvbk1vZGUoIlJFRkxFQ1RJT05NQVBfRVhQTElDSVQiKTticmVhaztjYXNlIE4uUExBTkFSX01PREU6ci5zZXRSZWZsZWN0aW9uTW9kZSgiUkVGTEVDVElPTk1BUF9QTEFOQVIiKTticmVhaztjYXNlIE4uUFJPSkVDVElPTl9NT0RFOnIuc2V0UmVmbGVjdGlvbk1vZGUoIlJFRkxFQ1RJT05NQVBfUFJPSkVDVElPTiIpO2JyZWFrO2Nhc2UgTi5TS1lCT1hfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX1NLWUJPWCIpO2JyZWFrO2Nhc2UgTi5TUEhFUklDQUxfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX1NQSEVSSUNBTCIpO2JyZWFrO2Nhc2UgTi5FUVVJUkVDVEFOR1VMQVJfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUiIpO2JyZWFrO2Nhc2UgTi5GSVhFRF9FUVVJUkVDVEFOR1VMQVJfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX0VRVUlSRUNUQU5HVUxBUl9GSVhFRCIpO2JyZWFrO2Nhc2UgTi5GSVhFRF9FUVVJUkVDVEFOR1VMQVJfTUlSUk9SRURfTU9ERTpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX01JUlJPUkVERVFVSVJFQ1RBTkdVTEFSX0ZJWEVEIik7YnJlYWs7Y2FzZSBOLkNVQklDX01PREU6Y2FzZSBOLklOVkNVQklDX01PREU6ZGVmYXVsdDpyLnNldFJlZmxlY3Rpb25Nb2RlKCJSRUZMRUNUSU9OTUFQX0NVQklDIik7YnJlYWt9ci5VU0VfTE9DQUxfUkVGTEVDVElPTk1BUF9DVUJJQz0hIXRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmJvdW5kaW5nQm94U2l6ZX1lbHNlIHJldHVybiExO2Vsc2Ugci5SRUZMRUNUSU9OPSExLHIuUkVGTEVDVElPTk1BUF9PUFBPU0lURVo9ITE7aWYodGhpcy5fZW1pc3NpdmVUZXh0dXJlJiZCLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fZW1pc3NpdmVUZXh0dXJlLmlzUmVhZHlPck5vdEJsb2NraW5nKCkpaWUuUHJlcGFyZURlZmluZXNGb3JNZXJnZWRVVih0aGlzLl9lbWlzc2l2ZVRleHR1cmUsciwiRU1JU1NJVkUiKTtlbHNlIHJldHVybiExO2Vsc2Ugci5FTUlTU0lWRT0hMTtpZih0aGlzLl9saWdodG1hcFRleHR1cmUmJkIuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZClpZih0aGlzLl9saWdodG1hcFRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSlpZS5QcmVwYXJlRGVmaW5lc0Zvck1lcmdlZFVWKHRoaXMuX2xpZ2h0bWFwVGV4dHVyZSxyLCJMSUdIVE1BUCIpLHIuVVNFTElHSFRNQVBBU1NIQURPV01BUD10aGlzLl91c2VMaWdodG1hcEFzU2hhZG93bWFwLHIuUkdCRExJR0hUTUFQPXRoaXMuX2xpZ2h0bWFwVGV4dHVyZS5pc1JHQkQ7ZWxzZSByZXR1cm4hMTtlbHNlIHIuTElHSFRNQVA9ITE7aWYodGhpcy5fc3BlY3VsYXJUZXh0dXJlJiZCLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fc3BlY3VsYXJUZXh0dXJlLmlzUmVhZHlPck5vdEJsb2NraW5nKCkpaWUuUHJlcGFyZURlZmluZXNGb3JNZXJnZWRVVih0aGlzLl9zcGVjdWxhclRleHR1cmUsciwiU1BFQ1VMQVIiKSxyLkdMT1NTSU5FU1M9dGhpcy5fdXNlR2xvc3NpbmVzc0Zyb21TcGVjdWxhck1hcEFscGhhO2Vsc2UgcmV0dXJuITE7ZWxzZSByLlNQRUNVTEFSPSExO2lmKHMuZ2V0RW5naW5lKCkuZ2V0Q2FwcygpLnN0YW5kYXJkRGVyaXZhdGl2ZXMmJnRoaXMuX2J1bXBUZXh0dXJlJiZCLkJ1bXBUZXh0dXJlRW5hYmxlZCl7aWYodGhpcy5fYnVtcFRleHR1cmUuaXNSZWFkeSgpKWllLlByZXBhcmVEZWZpbmVzRm9yTWVyZ2VkVVYodGhpcy5fYnVtcFRleHR1cmUsciwiQlVNUCIpLHIuUEFSQUxMQVg9dGhpcy5fdXNlUGFyYWxsYXgsci5QQVJBTExBWE9DQ0xVU0lPTj10aGlzLl91c2VQYXJhbGxheE9jY2x1c2lvbjtlbHNlIHJldHVybiExO3IuT0JKRUNUU1BBQ0VfTk9STUFMTUFQPXRoaXMuX3VzZU9iamVjdFNwYWNlTm9ybWFsTWFwfWVsc2Ugci5CVU1QPSExLHIuUEFSQUxMQVg9ITEsci5QQVJBTExBWE9DQ0xVU0lPTj0hMTtpZih0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZSYmQi5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQpaWYodGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNSZWFkeU9yTm90QmxvY2tpbmcoKSlyLl9uZWVkVVZzPSEwLHIuUkVGUkFDVElPTj0hMCxyLlJFRlJBQ1RJT05NQVBfM0Q9dGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNDdWJlLHIuUkdCRFJFRlJBQ1RJT049dGhpcy5fcmVmcmFjdGlvblRleHR1cmUuaXNSR0JELHIuVVNFX0xPQ0FMX1JFRlJBQ1RJT05NQVBfQ1VCSUM9ISF0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5ib3VuZGluZ0JveFNpemU7ZWxzZSByZXR1cm4hMTtlbHNlIHIuUkVGUkFDVElPTj0hMTtyLlRXT1NJREVETElHSFRJTkc9IXRoaXMuX2JhY2tGYWNlQ3VsbGluZyYmdGhpcy5fdHdvU2lkZWRMaWdodGluZ31lbHNlIHIuRElGRlVTRT0hMSxyLkFNQklFTlQ9ITEsci5PUEFDSVRZPSExLHIuUkVGTEVDVElPTj0hMSxyLkVNSVNTSVZFPSExLHIuTElHSFRNQVA9ITEsci5CVU1QPSExLHIuUkVGUkFDVElPTj0hMTtyLkFMUEhBRlJPTURJRkZVU0U9dGhpcy5fc2hvdWxkVXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUoKSxyLkVNSVNTSVZFQVNJTExVTUlOQVRJT049dGhpcy5fdXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbixyLkxJTktFTUlTU0lWRVdJVEhESUZGVVNFPXRoaXMuX2xpbmtFbWlzc2l2ZVdpdGhEaWZmdXNlLHIuU1BFQ1VMQVJPVkVSQUxQSEE9dGhpcy5fdXNlU3BlY3VsYXJPdmVyQWxwaGEsci5QUkVNVUxUSVBMWUFMUEhBPXRoaXMuYWxwaGFNb2RlPT09N3x8dGhpcy5hbHBoYU1vZGU9PT04LHIuQUxQSEFURVNUX0FGVEVSQUxMQUxQSEFDT01QVVRBVElPTlM9dGhpcy50cmFuc3BhcmVuY3lNb2RlIT09bnVsbCxyLkFMUEhBQkxFTkQ9dGhpcy50cmFuc3BhcmVuY3lNb2RlPT09bnVsbHx8dGhpcy5uZWVkQWxwaGFCbGVuZGluZ0Zvck1lc2goZSl9aWYodGhpcy5fZXZlbnRJbmZvLmlzUmVhZHlGb3JTdWJNZXNoPSEwLHRoaXMuX2V2ZW50SW5mby5kZWZpbmVzPXIsdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudElzUmVhZHlGb3JTdWJNZXNoKHRoaXMuX2V2ZW50SW5mbyksIXRoaXMuX2V2ZW50SW5mby5pc1JlYWR5Rm9yU3ViTWVzaClyZXR1cm4hMTtpZihyLl9hcmVJbWFnZVByb2Nlc3NpbmdEaXJ0eSYmdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbil7aWYoIXRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uaXNSZWFkeSgpKXJldHVybiExO3RoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24ucHJlcGFyZURlZmluZXMociksci5JU19SRUZMRUNUSU9OX0xJTkVBUj10aGlzLnJlZmxlY3Rpb25UZXh0dXJlIT1udWxsJiYhdGhpcy5yZWZsZWN0aW9uVGV4dHVyZS5nYW1tYVNwYWNlLHIuSVNfUkVGUkFDVElPTl9MSU5FQVI9dGhpcy5yZWZyYWN0aW9uVGV4dHVyZSE9bnVsbCYmIXRoaXMucmVmcmFjdGlvblRleHR1cmUuZ2FtbWFTcGFjZX1yLl9hcmVGcmVzbmVsRGlydHkmJihCLkZyZXNuZWxFbmFibGVkPyh0aGlzLl9kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnN8fHRoaXMuX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVyc3x8dGhpcy5fZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVyc3x8dGhpcy5fcmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzfHx0aGlzLl9yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMpJiYoci5ESUZGVVNFRlJFU05FTD10aGlzLl9kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX2RpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQsci5PUEFDSVRZRlJFU05FTD10aGlzLl9vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQsci5SRUZMRUNUSU9ORlJFU05FTD10aGlzLl9yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuX3JlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5pc0VuYWJsZWQsci5SRUZMRUNUSU9ORlJFU05FTEZST01TUEVDVUxBUj10aGlzLl91c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhcixyLlJFRlJBQ1RJT05GUkVTTkVMPXRoaXMuX3JlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyYmdGhpcy5fcmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCxyLkVNSVNTSVZFRlJFU05FTD10aGlzLl9lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLl9lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCxyLl9uZWVkTm9ybWFscz0hMCxyLkZSRVNORUw9ITApOnIuRlJFU05FTD0hMSksaWUuUHJlcGFyZURlZmluZXNGb3JNaXNjKGUscyx0aGlzLl91c2VMb2dhcml0aG1pY0RlcHRoLHRoaXMucG9pbnRzQ2xvdWQsdGhpcy5mb2dFbmFibGVkLHRoaXMuX3Nob3VsZFR1cm5BbHBoYVRlc3RPbihlKXx8dGhpcy5fZm9yY2VBbHBoYVRlc3QsciksaWUuUHJlcGFyZURlZmluZXNGb3JGcmFtZUJvdW5kVmFsdWVzKHMsbix0aGlzLHIsaSxudWxsLHQuZ2V0UmVuZGVyaW5nTWVzaCgpLmhhc1RoaW5JbnN0YW5jZXMpLHRoaXMuX2V2ZW50SW5mby5kZWZpbmVzPXIsdGhpcy5fZXZlbnRJbmZvLm1lc2g9ZSx0aGlzLl9jYWxsYmFja1BsdWdpbkV2ZW50UHJlcGFyZURlZmluZXNCZWZvcmVBdHRyaWJ1dGVzKHRoaXMuX2V2ZW50SW5mbyksaWUuUHJlcGFyZURlZmluZXNGb3JBdHRyaWJ1dGVzKGUsciwhMCwhMCwhMCksdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudFByZXBhcmVEZWZpbmVzKHRoaXMuX2V2ZW50SW5mbyk7bGV0IG89ITE7aWYoci5pc0RpcnR5KXtjb25zdCBoPXIuX2FyZUxpZ2h0c0Rpc3Bvc2VkO3IubWFya0FzUHJvY2Vzc2VkKCk7Y29uc3QgbD1uZXcgenM7ci5SRUZMRUNUSU9OJiZsLmFkZEZhbGxiYWNrKDAsIlJFRkxFQ1RJT04iKSxyLlNQRUNVTEFSJiZsLmFkZEZhbGxiYWNrKDAsIlNQRUNVTEFSIiksci5CVU1QJiZsLmFkZEZhbGxiYWNrKDAsIkJVTVAiKSxyLlBBUkFMTEFYJiZsLmFkZEZhbGxiYWNrKDEsIlBBUkFMTEFYIiksci5QQVJBTExBWE9DQ0xVU0lPTiYmbC5hZGRGYWxsYmFjaygwLCJQQVJBTExBWE9DQ0xVU0lPTiIpLHIuU1BFQ1VMQVJPVkVSQUxQSEEmJmwuYWRkRmFsbGJhY2soMCwiU1BFQ1VMQVJPVkVSQUxQSEEiKSxyLkZPRyYmbC5hZGRGYWxsYmFjaygxLCJGT0ciKSxyLlBPSU5UU0laRSYmbC5hZGRGYWxsYmFjaygwLCJQT0lOVFNJWkUiKSxyLkxPR0FSSVRITUlDREVQVEgmJmwuYWRkRmFsbGJhY2soMCwiTE9HQVJJVEhNSUNERVBUSCIpLGllLkhhbmRsZUZhbGxiYWNrc0ZvclNoYWRvd3MocixsLHRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0cyksci5TUEVDVUxBUlRFUk0mJmwuYWRkRmFsbGJhY2soMCwiU1BFQ1VMQVJURVJNIiksci5ESUZGVVNFRlJFU05FTCYmbC5hZGRGYWxsYmFjaygxLCJESUZGVVNFRlJFU05FTCIpLHIuT1BBQ0lUWUZSRVNORUwmJmwuYWRkRmFsbGJhY2soMiwiT1BBQ0lUWUZSRVNORUwiKSxyLlJFRkxFQ1RJT05GUkVTTkVMJiZsLmFkZEZhbGxiYWNrKDMsIlJFRkxFQ1RJT05GUkVTTkVMIiksci5FTUlTU0lWRUZSRVNORUwmJmwuYWRkRmFsbGJhY2soNCwiRU1JU1NJVkVGUkVTTkVMIiksci5GUkVTTkVMJiZsLmFkZEZhbGxiYWNrKDQsIkZSRVNORUwiKSxyLk1VTFRJVklFVyYmbC5hZGRGYWxsYmFjaygwLCJNVUxUSVZJRVciKTtjb25zdCB1PVtnLlBvc2l0aW9uS2luZF07ci5OT1JNQUwmJnUucHVzaChnLk5vcm1hbEtpbmQpLHIuVEFOR0VOVCYmdS5wdXNoKGcuVGFuZ2VudEtpbmQpO2ZvcihsZXQgQT0xO0E8PTY7KytBKXJbIlVWIitBXSYmdS5wdXNoKGB1diR7QT09PTE/IiI6QX1gKTtyLlZFUlRFWENPTE9SJiZ1LnB1c2goZy5Db2xvcktpbmQpLGllLlByZXBhcmVBdHRyaWJ1dGVzRm9yQm9uZXModSxlLHIsbCksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JJbnN0YW5jZXModSxyKSxpZS5QcmVwYXJlQXR0cmlidXRlc0Zvck1vcnBoVGFyZ2V0cyh1LGUsciksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JCYWtlZFZlcnRleEFuaW1hdGlvbih1LGUscik7bGV0IGQ9ImRlZmF1bHQiO2NvbnN0IGY9WyJ3b3JsZCIsInZpZXciLCJ2aWV3UHJvamVjdGlvbiIsInZFeWVQb3NpdGlvbiIsInZMaWdodHNUeXBlIiwidkFtYmllbnRDb2xvciIsInZEaWZmdXNlQ29sb3IiLCJ2U3BlY3VsYXJDb2xvciIsInZFbWlzc2l2ZUNvbG9yIiwidmlzaWJpbGl0eSIsInZGb2dJbmZvcyIsInZGb2dDb2xvciIsInBvaW50U2l6ZSIsInZEaWZmdXNlSW5mb3MiLCJ2QW1iaWVudEluZm9zIiwidk9wYWNpdHlJbmZvcyIsInZSZWZsZWN0aW9uSW5mb3MiLCJ2RW1pc3NpdmVJbmZvcyIsInZTcGVjdWxhckluZm9zIiwidkJ1bXBJbmZvcyIsInZMaWdodG1hcEluZm9zIiwidlJlZnJhY3Rpb25JbmZvcyIsIm1Cb25lcyIsImRpZmZ1c2VNYXRyaXgiLCJhbWJpZW50TWF0cml4Iiwib3BhY2l0eU1hdHJpeCIsInJlZmxlY3Rpb25NYXRyaXgiLCJlbWlzc2l2ZU1hdHJpeCIsInNwZWN1bGFyTWF0cml4IiwiYnVtcE1hdHJpeCIsIm5vcm1hbE1hdHJpeCIsImxpZ2h0bWFwTWF0cml4IiwicmVmcmFjdGlvbk1hdHJpeCIsImRpZmZ1c2VMZWZ0Q29sb3IiLCJkaWZmdXNlUmlnaHRDb2xvciIsIm9wYWNpdHlQYXJ0cyIsInJlZmxlY3Rpb25MZWZ0Q29sb3IiLCJyZWZsZWN0aW9uUmlnaHRDb2xvciIsImVtaXNzaXZlTGVmdENvbG9yIiwiZW1pc3NpdmVSaWdodENvbG9yIiwicmVmcmFjdGlvbkxlZnRDb2xvciIsInJlZnJhY3Rpb25SaWdodENvbG9yIiwidlJlZmxlY3Rpb25Qb3NpdGlvbiIsInZSZWZsZWN0aW9uU2l6ZSIsInZSZWZyYWN0aW9uUG9zaXRpb24iLCJ2UmVmcmFjdGlvblNpemUiLCJsb2dhcml0aG1pY0RlcHRoQ29uc3RhbnQiLCJ2VGFuZ2VudFNwYWNlUGFyYW1zIiwiYWxwaGFDdXRPZmYiLCJib25lVGV4dHVyZVdpZHRoIiwibW9ycGhUYXJnZXRUZXh0dXJlSW5mbyIsIm1vcnBoVGFyZ2V0VGV4dHVyZUluZGljZXMiXSxfPVsiZGlmZnVzZVNhbXBsZXIiLCJhbWJpZW50U2FtcGxlciIsIm9wYWNpdHlTYW1wbGVyIiwicmVmbGVjdGlvbkN1YmVTYW1wbGVyIiwicmVmbGVjdGlvbjJEU2FtcGxlciIsImVtaXNzaXZlU2FtcGxlciIsInNwZWN1bGFyU2FtcGxlciIsImJ1bXBTYW1wbGVyIiwibGlnaHRtYXBTYW1wbGVyIiwicmVmcmFjdGlvbkN1YmVTYW1wbGVyIiwicmVmcmFjdGlvbjJEU2FtcGxlciIsImJvbmVTYW1wbGVyIiwibW9ycGhUYXJnZXRzIiwib2l0RGVwdGhTYW1wbGVyIiwib2l0RnJvbnRDb2xvclNhbXBsZXIiXSxFPVsiTWF0ZXJpYWwiLCJTY2VuZSIsIk1lc2giXTt0aGlzLl9ldmVudEluZm8uZmFsbGJhY2tzPWwsdGhpcy5fZXZlbnRJbmZvLmZhbGxiYWNrUmFuaz0wLHRoaXMuX2V2ZW50SW5mby5kZWZpbmVzPXIsdGhpcy5fZXZlbnRJbmZvLnVuaWZvcm1zPWYsdGhpcy5fZXZlbnRJbmZvLmF0dHJpYnV0ZXM9dSx0aGlzLl9ldmVudEluZm8uc2FtcGxlcnM9Xyx0aGlzLl9ldmVudEluZm8udW5pZm9ybUJ1ZmZlcnNOYW1lcz1FLHRoaXMuX2V2ZW50SW5mby5jdXN0b21Db2RlPXZvaWQgMCx0aGlzLl9ldmVudEluZm8ubWVzaD1lLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRHZW5lcmljKFFlLlByZXBhcmVFZmZlY3QsdGhpcy5fZXZlbnRJbmZvKSxrci5BZGRVbmlmb3JtcyhmKSxwZSYmKHBlLlByZXBhcmVVbmlmb3JtcyhmLHIpLHBlLlByZXBhcmVTYW1wbGVycyhfLHIpKSxpZS5QcmVwYXJlVW5pZm9ybXNBbmRTYW1wbGVyc0xpc3Qoe3VuaWZvcm1zTmFtZXM6Zix1bmlmb3JtQnVmZmVyc05hbWVzOkUsc2FtcGxlcnM6XyxkZWZpbmVzOnIsbWF4U2ltdWx0YW5lb3VzTGlnaHRzOnRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0c30pLHNzKGYpO2NvbnN0IG09e307dGhpcy5jdXN0b21TaGFkZXJOYW1lUmVzb2x2ZSYmKGQ9dGhpcy5jdXN0b21TaGFkZXJOYW1lUmVzb2x2ZShkLGYsRSxfLHIsdSxtKSk7Y29uc3Qgdj1yLnRvU3RyaW5nKCksUz10LmVmZmVjdDtsZXQgeT1zLmdldEVuZ2luZSgpLmNyZWF0ZUVmZmVjdChkLHthdHRyaWJ1dGVzOnUsdW5pZm9ybXNOYW1lczpmLHVuaWZvcm1CdWZmZXJzTmFtZXM6RSxzYW1wbGVyczpfLGRlZmluZXM6dixmYWxsYmFja3M6bCxvbkNvbXBpbGVkOnRoaXMub25Db21waWxlZCxvbkVycm9yOnRoaXMub25FcnJvcixpbmRleFBhcmFtZXRlcnM6e21heFNpbXVsdGFuZW91c0xpZ2h0czp0aGlzLl9tYXhTaW11bHRhbmVvdXNMaWdodHMsbWF4U2ltdWx0YW5lb3VzTW9ycGhUYXJnZXRzOnIuTlVNX01PUlBIX0lORkxVRU5DRVJTfSxwcm9jZXNzRmluYWxDb2RlOm0ucHJvY2Vzc0ZpbmFsQ29kZSxwcm9jZXNzQ29kZUFmdGVySW5jbHVkZXM6dGhpcy5fZXZlbnRJbmZvLmN1c3RvbUNvZGUsbXVsdGlUYXJnZXQ6ci5QUkVQQVNTfSxuKTtpZih0aGlzLl9ldmVudEluZm8uY3VzdG9tQ29kZT12b2lkIDAseSlpZih0aGlzLl9vbkVmZmVjdENyZWF0ZWRPYnNlcnZhYmxlJiYoR3MuZWZmZWN0PXksR3Muc3ViTWVzaD10LHRoaXMuX29uRWZmZWN0Q3JlYXRlZE9ic2VydmFibGUubm90aWZ5T2JzZXJ2ZXJzKEdzKSksdGhpcy5hbGxvd1NoYWRlckhvdFN3YXBwaW5nJiZTJiYheS5pc1JlYWR5KCkpe2lmKHk9UyxyLm1hcmtBc1VucHJvY2Vzc2VkKCksbz10aGlzLmlzRnJvemVuLGgpcmV0dXJuIHIuX2FyZUxpZ2h0c0Rpc3Bvc2VkPSEwLCExfWVsc2Ugcy5yZXNldENhY2hlZE1hdGVyaWFsKCksdC5zZXRFZmZlY3QoeSxyLHRoaXMuX21hdGVyaWFsQ29udGV4dCl9cmV0dXJuIXQuZWZmZWN0fHwhdC5lZmZlY3QuaXNSZWFkeSgpPyExOihyLl9yZW5kZXJJZD1zLmdldFJlbmRlcklkKCksdC5lZmZlY3QuX3dhc1ByZXZpb3VzbHlSZWFkeT0hbyx0LmVmZmVjdC5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPWkscy5wZXJmb3JtYW5jZVByaW9yaXR5IT09Q3QuQmFja3dhcmRDb21wYXRpYmxlJiYodGhpcy5jaGVja1JlYWR5T25seU9uY2U9ITApLCEwKX1idWlsZFVuaWZvcm1MYXlvdXQoKXtjb25zdCBlPXRoaXMuX3VuaWZvcm1CdWZmZXI7ZS5hZGRVbmlmb3JtKCJkaWZmdXNlTGVmdENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oImRpZmZ1c2VSaWdodENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oIm9wYWNpdHlQYXJ0cyIsNCksZS5hZGRVbmlmb3JtKCJyZWZsZWN0aW9uTGVmdENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInJlZmxlY3Rpb25SaWdodENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInJlZnJhY3Rpb25MZWZ0Q29sb3IiLDQpLGUuYWRkVW5pZm9ybSgicmVmcmFjdGlvblJpZ2h0Q29sb3IiLDQpLGUuYWRkVW5pZm9ybSgiZW1pc3NpdmVMZWZ0Q29sb3IiLDQpLGUuYWRkVW5pZm9ybSgiZW1pc3NpdmVSaWdodENvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInZEaWZmdXNlSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidkFtYmllbnRJbmZvcyIsMiksZS5hZGRVbmlmb3JtKCJ2T3BhY2l0eUluZm9zIiwyKSxlLmFkZFVuaWZvcm0oInZSZWZsZWN0aW9uSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidlJlZmxlY3Rpb25Qb3NpdGlvbiIsMyksZS5hZGRVbmlmb3JtKCJ2UmVmbGVjdGlvblNpemUiLDMpLGUuYWRkVW5pZm9ybSgidkVtaXNzaXZlSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidkxpZ2h0bWFwSW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidlNwZWN1bGFySW5mb3MiLDIpLGUuYWRkVW5pZm9ybSgidkJ1bXBJbmZvcyIsMyksZS5hZGRVbmlmb3JtKCJkaWZmdXNlTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJhbWJpZW50TWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJvcGFjaXR5TWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJyZWZsZWN0aW9uTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJlbWlzc2l2ZU1hdHJpeCIsMTYpLGUuYWRkVW5pZm9ybSgibGlnaHRtYXBNYXRyaXgiLDE2KSxlLmFkZFVuaWZvcm0oInNwZWN1bGFyTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJidW1wTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJ2VGFuZ2VudFNwYWNlUGFyYW1zIiwyKSxlLmFkZFVuaWZvcm0oInBvaW50U2l6ZSIsMSksZS5hZGRVbmlmb3JtKCJhbHBoYUN1dE9mZiIsMSksZS5hZGRVbmlmb3JtKCJyZWZyYWN0aW9uTWF0cml4IiwxNiksZS5hZGRVbmlmb3JtKCJ2UmVmcmFjdGlvbkluZm9zIiw0KSxlLmFkZFVuaWZvcm0oInZSZWZyYWN0aW9uUG9zaXRpb24iLDMpLGUuYWRkVW5pZm9ybSgidlJlZnJhY3Rpb25TaXplIiwzKSxlLmFkZFVuaWZvcm0oInZTcGVjdWxhckNvbG9yIiw0KSxlLmFkZFVuaWZvcm0oInZFbWlzc2l2ZUNvbG9yIiwzKSxlLmFkZFVuaWZvcm0oInZEaWZmdXNlQ29sb3IiLDQpLGUuYWRkVW5pZm9ybSgidkFtYmllbnRDb2xvciIsMyksc3VwZXIuYnVpbGRVbmlmb3JtTGF5b3V0KCl9YmluZEZvclN1Yk1lc2goZSx0LGkpe3ZhciBzO2NvbnN0IHI9dGhpcy5nZXRTY2VuZSgpLG49aS5tYXRlcmlhbERlZmluZXM7aWYoIW4pcmV0dXJuO2NvbnN0IGE9aS5lZmZlY3Q7aWYoIWEpcmV0dXJuO3RoaXMuX2FjdGl2ZUVmZmVjdD1hLHQuZ2V0TWVzaFVuaWZvcm1CdWZmZXIoKS5iaW5kVG9FZmZlY3QoYSwiTWVzaCIpLHQudHJhbnNmZXJUb0VmZmVjdChlKSx0aGlzLl91bmlmb3JtQnVmZmVyLmJpbmRUb0VmZmVjdChhLCJNYXRlcmlhbCIpLHRoaXMucHJlUGFzc0NvbmZpZ3VyYXRpb24uYmluZEZvclN1Yk1lc2godGhpcy5fYWN0aXZlRWZmZWN0LHIsdCxlLHRoaXMuaXNGcm96ZW4pLHRoaXMuX2V2ZW50SW5mby5zdWJNZXNoPWksdGhpcy5fY2FsbGJhY2tQbHVnaW5FdmVudEhhcmRCaW5kRm9yU3ViTWVzaCh0aGlzLl9ldmVudEluZm8pLG4uT0JKRUNUU1BBQ0VfTk9STUFMTUFQJiYoZS50b05vcm1hbE1hdHJpeCh0aGlzLl9ub3JtYWxNYXRyaXgpLHRoaXMuYmluZE9ubHlOb3JtYWxNYXRyaXgodGhpcy5fbm9ybWFsTWF0cml4KSk7Y29uc3Qgbz1hLl9mb3JjZVJlYmluZE9uTmV4dENhbGx8fHRoaXMuX211c3RSZWJpbmQocixhLHQudmlzaWJpbGl0eSk7aWUuQmluZEJvbmVzUGFyYW1ldGVycyh0LGEpO2NvbnN0IGg9dGhpcy5fdW5pZm9ybUJ1ZmZlcjtpZihvKXtpZih0aGlzLmJpbmRWaWV3UHJvamVjdGlvbihhKSwhaC51c2VVYm98fCF0aGlzLmlzRnJvemVufHwhaC5pc1N5bmN8fGEuX2ZvcmNlUmViaW5kT25OZXh0Q2FsbCl7aWYoQi5GcmVzbmVsRW5hYmxlZCYmbi5GUkVTTkVMJiYodGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMuZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKGgudXBkYXRlQ29sb3I0KCJkaWZmdXNlTGVmdENvbG9yIix0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLGgudXBkYXRlQ29sb3I0KCJkaWZmdXNlUmlnaHRDb2xvciIsdGhpcy5kaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLmRpZmZ1c2VGcmVzbmVsUGFyYW1ldGVycy5iaWFzKSksdGhpcy5vcGFjaXR5RnJlc25lbFBhcmFtZXRlcnMmJnRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmaC51cGRhdGVDb2xvcjQoIm9wYWNpdHlQYXJ0cyIsbmV3IHJlKHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLmxlZnRDb2xvci50b0x1bWluYW5jZSgpLHRoaXMub3BhY2l0eUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IudG9MdW1pbmFuY2UoKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5iaWFzKSx0aGlzLm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycy5wb3dlciksdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKGgudXBkYXRlQ29sb3I0KCJyZWZsZWN0aW9uTGVmdENvbG9yIix0aGlzLnJlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLGgudXBkYXRlQ29sb3I0KCJyZWZsZWN0aW9uUmlnaHRDb2xvciIsdGhpcy5yZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLnJlZmxlY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5iaWFzKSksdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMmJnRoaXMucmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzLmlzRW5hYmxlZCYmKGgudXBkYXRlQ29sb3I0KCJyZWZyYWN0aW9uTGVmdENvbG9yIix0aGlzLnJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5sZWZ0Q29sb3IsdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucG93ZXIpLGgudXBkYXRlQ29sb3I0KCJyZWZyYWN0aW9uUmlnaHRDb2xvciIsdGhpcy5yZWZyYWN0aW9uRnJlc25lbFBhcmFtZXRlcnMucmlnaHRDb2xvcix0aGlzLnJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycy5iaWFzKSksdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzJiZ0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMuaXNFbmFibGVkJiYoaC51cGRhdGVDb2xvcjQoImVtaXNzaXZlTGVmdENvbG9yIix0aGlzLmVtaXNzaXZlRnJlc25lbFBhcmFtZXRlcnMubGVmdENvbG9yLHRoaXMuZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycy5wb3dlciksaC51cGRhdGVDb2xvcjQoImVtaXNzaXZlUmlnaHRDb2xvciIsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLnJpZ2h0Q29sb3IsdGhpcy5lbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzLmJpYXMpKSksci50ZXh0dXJlc0VuYWJsZWQpe2lmKHRoaXMuX2RpZmZ1c2VUZXh0dXJlJiZCLkRpZmZ1c2VUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2RGlmZnVzZUluZm9zIix0aGlzLl9kaWZmdXNlVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX2RpZmZ1c2VUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9kaWZmdXNlVGV4dHVyZSxoLCJkaWZmdXNlIikpLHRoaXMuX2FtYmllbnRUZXh0dXJlJiZCLkFtYmllbnRUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2QW1iaWVudEluZm9zIix0aGlzLl9hbWJpZW50VGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX2FtYmllbnRUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9hbWJpZW50VGV4dHVyZSxoLCJhbWJpZW50IikpLHRoaXMuX29wYWNpdHlUZXh0dXJlJiZCLk9wYWNpdHlUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2T3BhY2l0eUluZm9zIix0aGlzLl9vcGFjaXR5VGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX29wYWNpdHlUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9vcGFjaXR5VGV4dHVyZSxoLCJvcGFjaXR5IikpLHRoaXMuX2hhc0FscGhhQ2hhbm5lbCgpJiZoLnVwZGF0ZUZsb2F0KCJhbHBoYUN1dE9mZiIsdGhpcy5hbHBoYUN1dE9mZiksdGhpcy5fcmVmbGVjdGlvblRleHR1cmUmJkIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiYoaC51cGRhdGVGbG9hdDIoInZSZWZsZWN0aW9uSW5mb3MiLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlLmxldmVsLHRoaXMucm91Z2huZXNzKSxoLnVwZGF0ZU1hdHJpeCgicmVmbGVjdGlvbk1hdHJpeCIsdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXgoKSksdGhpcy5fcmVmbGVjdGlvblRleHR1cmUuYm91bmRpbmdCb3hTaXplKSl7Y29uc3QgbD10aGlzLl9yZWZsZWN0aW9uVGV4dHVyZTtoLnVwZGF0ZVZlY3RvcjMoInZSZWZsZWN0aW9uUG9zaXRpb24iLGwuYm91bmRpbmdCb3hQb3NpdGlvbiksaC51cGRhdGVWZWN0b3IzKCJ2UmVmbGVjdGlvblNpemUiLGwuYm91bmRpbmdCb3hTaXplKX1pZih0aGlzLl9lbWlzc2l2ZVRleHR1cmUmJkIuRW1pc3NpdmVUZXh0dXJlRW5hYmxlZCYmKGgudXBkYXRlRmxvYXQyKCJ2RW1pc3NpdmVJbmZvcyIsdGhpcy5fZW1pc3NpdmVUZXh0dXJlLmNvb3JkaW5hdGVzSW5kZXgsdGhpcy5fZW1pc3NpdmVUZXh0dXJlLmxldmVsKSxpZS5CaW5kVGV4dHVyZU1hdHJpeCh0aGlzLl9lbWlzc2l2ZVRleHR1cmUsaCwiZW1pc3NpdmUiKSksdGhpcy5fbGlnaHRtYXBUZXh0dXJlJiZCLkxpZ2h0bWFwVGV4dHVyZUVuYWJsZWQmJihoLnVwZGF0ZUZsb2F0MigidkxpZ2h0bWFwSW5mb3MiLHRoaXMuX2xpZ2h0bWFwVGV4dHVyZS5jb29yZGluYXRlc0luZGV4LHRoaXMuX2xpZ2h0bWFwVGV4dHVyZS5sZXZlbCksaWUuQmluZFRleHR1cmVNYXRyaXgodGhpcy5fbGlnaHRtYXBUZXh0dXJlLGgsImxpZ2h0bWFwIikpLHRoaXMuX3NwZWN1bGFyVGV4dHVyZSYmQi5TcGVjdWxhclRleHR1cmVFbmFibGVkJiYoaC51cGRhdGVGbG9hdDIoInZTcGVjdWxhckluZm9zIix0aGlzLl9zcGVjdWxhclRleHR1cmUuY29vcmRpbmF0ZXNJbmRleCx0aGlzLl9zcGVjdWxhclRleHR1cmUubGV2ZWwpLGllLkJpbmRUZXh0dXJlTWF0cml4KHRoaXMuX3NwZWN1bGFyVGV4dHVyZSxoLCJzcGVjdWxhciIpKSx0aGlzLl9idW1wVGV4dHVyZSYmci5nZXRFbmdpbmUoKS5nZXRDYXBzKCkuc3RhbmRhcmREZXJpdmF0aXZlcyYmQi5CdW1wVGV4dHVyZUVuYWJsZWQmJihoLnVwZGF0ZUZsb2F0MygidkJ1bXBJbmZvcyIsdGhpcy5fYnVtcFRleHR1cmUuY29vcmRpbmF0ZXNJbmRleCwxL3RoaXMuX2J1bXBUZXh0dXJlLmxldmVsLHRoaXMucGFyYWxsYXhTY2FsZUJpYXMpLGllLkJpbmRUZXh0dXJlTWF0cml4KHRoaXMuX2J1bXBUZXh0dXJlLGgsImJ1bXAiKSxyLl9taXJyb3JlZENhbWVyYVBvc2l0aW9uP2gudXBkYXRlRmxvYXQyKCJ2VGFuZ2VudFNwYWNlUGFyYW1zIix0aGlzLl9pbnZlcnROb3JtYWxNYXBYPzE6LTEsdGhpcy5faW52ZXJ0Tm9ybWFsTWFwWT8xOi0xKTpoLnVwZGF0ZUZsb2F0MigidlRhbmdlbnRTcGFjZVBhcmFtcyIsdGhpcy5faW52ZXJ0Tm9ybWFsTWFwWD8tMToxLHRoaXMuX2ludmVydE5vcm1hbE1hcFk/LTE6MSkpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZCLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCl7bGV0IGw9MTtpZih0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5pc0N1YmV8fChoLnVwZGF0ZU1hdHJpeCgicmVmcmFjdGlvbk1hdHJpeCIsdGhpcy5fcmVmcmFjdGlvblRleHR1cmUuZ2V0UmVmbGVjdGlvblRleHR1cmVNYXRyaXgoKSksdGhpcy5fcmVmcmFjdGlvblRleHR1cmUuZGVwdGgmJihsPXRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmRlcHRoKSksaC51cGRhdGVGbG9hdDQoInZSZWZyYWN0aW9uSW5mb3MiLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmxldmVsLHRoaXMuaW5kZXhPZlJlZnJhY3Rpb24sbCx0aGlzLmludmVydFJlZnJhY3Rpb25ZPy0xOjEpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmJvdW5kaW5nQm94U2l6ZSl7Y29uc3QgdT10aGlzLl9yZWZyYWN0aW9uVGV4dHVyZTtoLnVwZGF0ZVZlY3RvcjMoInZSZWZyYWN0aW9uUG9zaXRpb24iLHUuYm91bmRpbmdCb3hQb3NpdGlvbiksaC51cGRhdGVWZWN0b3IzKCJ2UmVmcmFjdGlvblNpemUiLHUuYm91bmRpbmdCb3hTaXplKX19fXRoaXMucG9pbnRzQ2xvdWQmJmgudXBkYXRlRmxvYXQoInBvaW50U2l6ZSIsdGhpcy5wb2ludFNpemUpLG4uU1BFQ1VMQVJURVJNJiZoLnVwZGF0ZUNvbG9yNCgidlNwZWN1bGFyQ29sb3IiLHRoaXMuc3BlY3VsYXJDb2xvcix0aGlzLnNwZWN1bGFyUG93ZXIpLGgudXBkYXRlQ29sb3IzKCJ2RW1pc3NpdmVDb2xvciIsQi5FbWlzc2l2ZVRleHR1cmVFbmFibGVkP3RoaXMuZW1pc3NpdmVDb2xvcjpyZS5CbGFja1JlYWRPbmx5KSxoLnVwZGF0ZUNvbG9yNCgidkRpZmZ1c2VDb2xvciIsdGhpcy5kaWZmdXNlQ29sb3IsdGhpcy5hbHBoYSksci5hbWJpZW50Q29sb3IubXVsdGlwbHlUb1JlZih0aGlzLmFtYmllbnRDb2xvcix0aGlzLl9nbG9iYWxBbWJpZW50Q29sb3IpLGgudXBkYXRlQ29sb3IzKCJ2QW1iaWVudENvbG9yIix0aGlzLl9nbG9iYWxBbWJpZW50Q29sb3IpfXIudGV4dHVyZXNFbmFibGVkJiYodGhpcy5fZGlmZnVzZVRleHR1cmUmJkIuRGlmZnVzZVRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoImRpZmZ1c2VTYW1wbGVyIix0aGlzLl9kaWZmdXNlVGV4dHVyZSksdGhpcy5fYW1iaWVudFRleHR1cmUmJkIuQW1iaWVudFRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoImFtYmllbnRTYW1wbGVyIix0aGlzLl9hbWJpZW50VGV4dHVyZSksdGhpcy5fb3BhY2l0eVRleHR1cmUmJkIuT3BhY2l0eVRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoIm9wYWNpdHlTYW1wbGVyIix0aGlzLl9vcGFjaXR5VGV4dHVyZSksdGhpcy5fcmVmbGVjdGlvblRleHR1cmUmJkIuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkJiYodGhpcy5fcmVmbGVjdGlvblRleHR1cmUuaXNDdWJlP2Euc2V0VGV4dHVyZSgicmVmbGVjdGlvbkN1YmVTYW1wbGVyIix0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSk6YS5zZXRUZXh0dXJlKCJyZWZsZWN0aW9uMkRTYW1wbGVyIix0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSkpLHRoaXMuX2VtaXNzaXZlVGV4dHVyZSYmQi5FbWlzc2l2ZVRleHR1cmVFbmFibGVkJiZhLnNldFRleHR1cmUoImVtaXNzaXZlU2FtcGxlciIsdGhpcy5fZW1pc3NpdmVUZXh0dXJlKSx0aGlzLl9saWdodG1hcFRleHR1cmUmJkIuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZCYmYS5zZXRUZXh0dXJlKCJsaWdodG1hcFNhbXBsZXIiLHRoaXMuX2xpZ2h0bWFwVGV4dHVyZSksdGhpcy5fc3BlY3VsYXJUZXh0dXJlJiZCLlNwZWN1bGFyVGV4dHVyZUVuYWJsZWQmJmEuc2V0VGV4dHVyZSgic3BlY3VsYXJTYW1wbGVyIix0aGlzLl9zcGVjdWxhclRleHR1cmUpLHRoaXMuX2J1bXBUZXh0dXJlJiZyLmdldEVuZ2luZSgpLmdldENhcHMoKS5zdGFuZGFyZERlcml2YXRpdmVzJiZCLkJ1bXBUZXh0dXJlRW5hYmxlZCYmYS5zZXRUZXh0dXJlKCJidW1wU2FtcGxlciIsdGhpcy5fYnVtcFRleHR1cmUpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZCLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZCYmKHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlLmlzQ3ViZT9hLnNldFRleHR1cmUoInJlZnJhY3Rpb25DdWJlU2FtcGxlciIsdGhpcy5fcmVmcmFjdGlvblRleHR1cmUpOmEuc2V0VGV4dHVyZSgicmVmcmFjdGlvbjJEU2FtcGxlciIsdGhpcy5fcmVmcmFjdGlvblRleHR1cmUpKSksdGhpcy5nZXRTY2VuZSgpLnVzZU9yZGVySW5kZXBlbmRlbnRUcmFuc3BhcmVuY3kmJnRoaXMubmVlZEFscGhhQmxlbmRpbmdGb3JNZXNoKHQpJiZ0aGlzLmdldFNjZW5lKCkuZGVwdGhQZWVsaW5nUmVuZGVyZXIuYmluZChhKSx0aGlzLl9ldmVudEluZm8uc3ViTWVzaD1pLHRoaXMuX2NhbGxiYWNrUGx1Z2luRXZlbnRCaW5kRm9yU3ViTWVzaCh0aGlzLl9ldmVudEluZm8pLHJzKGEsdGhpcyxyKSx0aGlzLmJpbmRFeWVQb3NpdGlvbihhKX1lbHNlIHIuZ2V0RW5naW5lKCkuX2ZlYXR1cmVzLm5lZWRUb0Fsd2F5c0JpbmRVbmlmb3JtQnVmZmVycyYmKHRoaXMuX25lZWRUb0JpbmRTY2VuZVVibz0hMCk7KG98fCF0aGlzLmlzRnJvemVuKSYmKHIubGlnaHRzRW5hYmxlZCYmIXRoaXMuX2Rpc2FibGVMaWdodGluZyYmaWUuQmluZExpZ2h0cyhyLHQsYSxuLHRoaXMuX21heFNpbXVsdGFuZW91c0xpZ2h0cyksKHIuZm9nRW5hYmxlZCYmdC5hcHBseUZvZyYmci5mb2dNb2RlIT09bmUuRk9HTU9ERV9OT05FfHx0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZXx8dGhpcy5fcmVmcmFjdGlvblRleHR1cmV8fHQucmVjZWl2ZVNoYWRvd3N8fG4uUFJFUEFTUykmJnRoaXMuYmluZFZpZXcoYSksaWUuQmluZEZvZ1BhcmFtZXRlcnMocix0LGEpLG4uTlVNX01PUlBIX0lORkxVRU5DRVJTJiZpZS5CaW5kTW9ycGhUYXJnZXRQYXJhbWV0ZXJzKHQsYSksbi5CQUtFRF9WRVJURVhfQU5JTUFUSU9OX1RFWFRVUkUmJigocz10LmJha2VkVmVydGV4QW5pbWF0aW9uTWFuYWdlcik9PT1udWxsfHxzPT09dm9pZCAwfHxzLmJpbmQoYSxuLklOU1RBTkNFUykpLHRoaXMudXNlTG9nYXJpdGhtaWNEZXB0aCYmaWUuQmluZExvZ0RlcHRoKG4sYSxyKSx0aGlzLl9pbWFnZVByb2Nlc3NpbmdDb25maWd1cmF0aW9uJiYhdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbi5hcHBseUJ5UG9zdFByb2Nlc3MmJnRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uYmluZCh0aGlzLl9hY3RpdmVFZmZlY3QpKSx0aGlzLl9hZnRlckJpbmQodCx0aGlzLl9hY3RpdmVFZmZlY3QpLGgudXBkYXRlKCl9Z2V0QW5pbWF0YWJsZXMoKXtjb25zdCBlPXN1cGVyLmdldEFuaW1hdGFibGVzKCk7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9kaWZmdXNlVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fZGlmZnVzZVRleHR1cmUpLHRoaXMuX2FtYmllbnRUZXh0dXJlJiZ0aGlzLl9hbWJpZW50VGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9hbWJpZW50VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fYW1iaWVudFRleHR1cmUpLHRoaXMuX29wYWNpdHlUZXh0dXJlJiZ0aGlzLl9vcGFjaXR5VGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9vcGFjaXR5VGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fb3BhY2l0eVRleHR1cmUpLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fcmVmbGVjdGlvblRleHR1cmUpLHRoaXMuX2VtaXNzaXZlVGV4dHVyZSYmdGhpcy5fZW1pc3NpdmVUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuX2VtaXNzaXZlVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fZW1pc3NpdmVUZXh0dXJlKSx0aGlzLl9zcGVjdWxhclRleHR1cmUmJnRoaXMuX3NwZWN1bGFyVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9zcGVjdWxhclRleHR1cmUuYW5pbWF0aW9ucy5sZW5ndGg+MCYmZS5wdXNoKHRoaXMuX3NwZWN1bGFyVGV4dHVyZSksdGhpcy5fYnVtcFRleHR1cmUmJnRoaXMuX2J1bXBUZXh0dXJlLmFuaW1hdGlvbnMmJnRoaXMuX2J1bXBUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLl9idW1wVGV4dHVyZSksdGhpcy5fbGlnaHRtYXBUZXh0dXJlJiZ0aGlzLl9saWdodG1hcFRleHR1cmUuYW5pbWF0aW9ucyYmdGhpcy5fbGlnaHRtYXBUZXh0dXJlLmFuaW1hdGlvbnMubGVuZ3RoPjAmJmUucHVzaCh0aGlzLl9saWdodG1hcFRleHR1cmUpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5hbmltYXRpb25zJiZ0aGlzLl9yZWZyYWN0aW9uVGV4dHVyZS5hbmltYXRpb25zLmxlbmd0aD4wJiZlLnB1c2godGhpcy5fcmVmcmFjdGlvblRleHR1cmUpLGV9Z2V0QWN0aXZlVGV4dHVyZXMoKXtjb25zdCBlPXN1cGVyLmdldEFjdGl2ZVRleHR1cmVzKCk7cmV0dXJuIHRoaXMuX2RpZmZ1c2VUZXh0dXJlJiZlLnB1c2godGhpcy5fZGlmZnVzZVRleHR1cmUpLHRoaXMuX2FtYmllbnRUZXh0dXJlJiZlLnB1c2godGhpcy5fYW1iaWVudFRleHR1cmUpLHRoaXMuX29wYWNpdHlUZXh0dXJlJiZlLnB1c2godGhpcy5fb3BhY2l0eVRleHR1cmUpLHRoaXMuX3JlZmxlY3Rpb25UZXh0dXJlJiZlLnB1c2godGhpcy5fcmVmbGVjdGlvblRleHR1cmUpLHRoaXMuX2VtaXNzaXZlVGV4dHVyZSYmZS5wdXNoKHRoaXMuX2VtaXNzaXZlVGV4dHVyZSksdGhpcy5fc3BlY3VsYXJUZXh0dXJlJiZlLnB1c2godGhpcy5fc3BlY3VsYXJUZXh0dXJlKSx0aGlzLl9idW1wVGV4dHVyZSYmZS5wdXNoKHRoaXMuX2J1bXBUZXh0dXJlKSx0aGlzLl9saWdodG1hcFRleHR1cmUmJmUucHVzaCh0aGlzLl9saWdodG1hcFRleHR1cmUpLHRoaXMuX3JlZnJhY3Rpb25UZXh0dXJlJiZlLnB1c2godGhpcy5fcmVmcmFjdGlvblRleHR1cmUpLGV9aGFzVGV4dHVyZShlKXtyZXR1cm4hIShzdXBlci5oYXNUZXh0dXJlKGUpfHx0aGlzLl9kaWZmdXNlVGV4dHVyZT09PWV8fHRoaXMuX2FtYmllbnRUZXh0dXJlPT09ZXx8dGhpcy5fb3BhY2l0eVRleHR1cmU9PT1lfHx0aGlzLl9yZWZsZWN0aW9uVGV4dHVyZT09PWV8fHRoaXMuX2VtaXNzaXZlVGV4dHVyZT09PWV8fHRoaXMuX3NwZWN1bGFyVGV4dHVyZT09PWV8fHRoaXMuX2J1bXBUZXh0dXJlPT09ZXx8dGhpcy5fbGlnaHRtYXBUZXh0dXJlPT09ZXx8dGhpcy5fcmVmcmFjdGlvblRleHR1cmU9PT1lKX1kaXNwb3NlKGUsdCl7dmFyIGkscyxyLG4sYSxvLGgsbCx1O3QmJigoaT10aGlzLl9kaWZmdXNlVGV4dHVyZSk9PT1udWxsfHxpPT09dm9pZCAwfHxpLmRpc3Bvc2UoKSwocz10aGlzLl9hbWJpZW50VGV4dHVyZSk9PT1udWxsfHxzPT09dm9pZCAwfHxzLmRpc3Bvc2UoKSwocj10aGlzLl9vcGFjaXR5VGV4dHVyZSk9PT1udWxsfHxyPT09dm9pZCAwfHxyLmRpc3Bvc2UoKSwobj10aGlzLl9yZWZsZWN0aW9uVGV4dHVyZSk9PT1udWxsfHxuPT09dm9pZCAwfHxuLmRpc3Bvc2UoKSwoYT10aGlzLl9lbWlzc2l2ZVRleHR1cmUpPT09bnVsbHx8YT09PXZvaWQgMHx8YS5kaXNwb3NlKCksKG89dGhpcy5fc3BlY3VsYXJUZXh0dXJlKT09PW51bGx8fG89PT12b2lkIDB8fG8uZGlzcG9zZSgpLChoPXRoaXMuX2J1bXBUZXh0dXJlKT09PW51bGx8fGg9PT12b2lkIDB8fGguZGlzcG9zZSgpLChsPXRoaXMuX2xpZ2h0bWFwVGV4dHVyZSk9PT1udWxsfHxsPT09dm9pZCAwfHxsLmRpc3Bvc2UoKSwodT10aGlzLl9yZWZyYWN0aW9uVGV4dHVyZSk9PT1udWxsfHx1PT09dm9pZCAwfHx1LmRpc3Bvc2UoKSksdGhpcy5faW1hZ2VQcm9jZXNzaW5nQ29uZmlndXJhdGlvbiYmdGhpcy5faW1hZ2VQcm9jZXNzaW5nT2JzZXJ2ZXImJnRoaXMuX2ltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24ub25VcGRhdGVQYXJhbWV0ZXJzLnJlbW92ZSh0aGlzLl9pbWFnZVByb2Nlc3NpbmdPYnNlcnZlciksc3VwZXIuZGlzcG9zZShlLHQpfWNsb25lKGUpe2NvbnN0IHQ9YWUuQ2xvbmUoKCk9Pm5ldyBCKGUsdGhpcy5nZXRTY2VuZSgpKSx0aGlzKTtyZXR1cm4gdC5uYW1lPWUsdC5pZD1lLHRoaXMuc3RlbmNpbC5jb3B5VG8odC5zdGVuY2lsKSx0fXN0YXRpYyBQYXJzZShlLHQsaSl7Y29uc3Qgcz1hZS5QYXJzZSgoKT0+bmV3IEIoZS5uYW1lLHQpLGUsdCxpKTtyZXR1cm4gZS5zdGVuY2lsJiZzLnN0ZW5jaWwucGFyc2UoZS5zdGVuY2lsLHQsaSksc31zdGF0aWMgZ2V0IERpZmZ1c2VUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB1ZS5EaWZmdXNlVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBEaWZmdXNlVGV4dHVyZUVuYWJsZWQoZSl7dWUuRGlmZnVzZVRleHR1cmVFbmFibGVkPWV9c3RhdGljIGdldCBEZXRhaWxUZXh0dXJlRW5hYmxlZCgpe3JldHVybiB1ZS5EZXRhaWxUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IERldGFpbFRleHR1cmVFbmFibGVkKGUpe3VlLkRldGFpbFRleHR1cmVFbmFibGVkPWV9c3RhdGljIGdldCBBbWJpZW50VGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdWUuQW1iaWVudFRleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQW1iaWVudFRleHR1cmVFbmFibGVkKGUpe3VlLkFtYmllbnRUZXh0dXJlRW5hYmxlZD1lfXN0YXRpYyBnZXQgT3BhY2l0eVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLk9wYWNpdHlUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IE9wYWNpdHlUZXh0dXJlRW5hYmxlZChlKXt1ZS5PcGFjaXR5VGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IFJlZmxlY3Rpb25UZXh0dXJlRW5hYmxlZCgpe3JldHVybiB1ZS5SZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBSZWZsZWN0aW9uVGV4dHVyZUVuYWJsZWQoZSl7dWUuUmVmbGVjdGlvblRleHR1cmVFbmFibGVkPWV9c3RhdGljIGdldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWR9c3RhdGljIHNldCBFbWlzc2l2ZVRleHR1cmVFbmFibGVkKGUpe3VlLkVtaXNzaXZlVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IFNwZWN1bGFyVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdWUuU3BlY3VsYXJUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFNwZWN1bGFyVGV4dHVyZUVuYWJsZWQoZSl7dWUuU3BlY3VsYXJUZXh0dXJlRW5hYmxlZD1lfXN0YXRpYyBnZXQgQnVtcFRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLkJ1bXBUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IEJ1bXBUZXh0dXJlRW5hYmxlZChlKXt1ZS5CdW1wVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IExpZ2h0bWFwVGV4dHVyZUVuYWJsZWQoKXtyZXR1cm4gdWUuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IExpZ2h0bWFwVGV4dHVyZUVuYWJsZWQoZSl7dWUuTGlnaHRtYXBUZXh0dXJlRW5hYmxlZD1lfXN0YXRpYyBnZXQgUmVmcmFjdGlvblRleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLlJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZH1zdGF0aWMgc2V0IFJlZnJhY3Rpb25UZXh0dXJlRW5hYmxlZChlKXt1ZS5SZWZyYWN0aW9uVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IENvbG9yR3JhZGluZ1RleHR1cmVFbmFibGVkKCl7cmV0dXJuIHVlLkNvbG9yR3JhZGluZ1RleHR1cmVFbmFibGVkfXN0YXRpYyBzZXQgQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQoZSl7dWUuQ29sb3JHcmFkaW5nVGV4dHVyZUVuYWJsZWQ9ZX1zdGF0aWMgZ2V0IEZyZXNuZWxFbmFibGVkKCl7cmV0dXJuIHVlLkZyZXNuZWxFbmFibGVkfXN0YXRpYyBzZXQgRnJlc25lbEVuYWJsZWQoZSl7dWUuRnJlc25lbEVuYWJsZWQ9ZX19VChbbXQoImRpZmZ1c2VUZXh0dXJlIildLEIucHJvdG90eXBlLCJfZGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSIpXSxCLnByb3RvdHlwZSwiZGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbbXQoImFtYmllbnRUZXh0dXJlIildLEIucHJvdG90eXBlLCJfYW1iaWVudFRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJhbWJpZW50VGV4dHVyZSIsdm9pZCAwKSxUKFttdCgib3BhY2l0eVRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9vcGFjaXR5VGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzQW5kTWlzY0RpcnR5IildLEIucHJvdG90eXBlLCJvcGFjaXR5VGV4dHVyZSIsdm9pZCAwKSxUKFttdCgicmVmbGVjdGlvblRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9yZWZsZWN0aW9uVGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsInJlZmxlY3Rpb25UZXh0dXJlIix2b2lkIDApLFQoW210KCJlbWlzc2l2ZVRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9lbWlzc2l2ZVRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJlbWlzc2l2ZVRleHR1cmUiLHZvaWQgMCksVChbbXQoInNwZWN1bGFyVGV4dHVyZSIpXSxCLnByb3RvdHlwZSwiX3NwZWN1bGFyVGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsInNwZWN1bGFyVGV4dHVyZSIsdm9pZCAwKSxUKFttdCgiYnVtcFRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9idW1wVGV4dHVyZSIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsImJ1bXBUZXh0dXJlIix2b2lkIDApLFQoW210KCJsaWdodG1hcFRleHR1cmUiKV0sQi5wcm90b3R5cGUsIl9saWdodG1hcFRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJsaWdodG1hcFRleHR1cmUiLHZvaWQgMCksVChbbXQoInJlZnJhY3Rpb25UZXh0dXJlIildLEIucHJvdG90eXBlLCJfcmVmcmFjdGlvblRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJyZWZyYWN0aW9uVGV4dHVyZSIsdm9pZCAwKSxUKFtjaSgiYW1iaWVudCIpXSxCLnByb3RvdHlwZSwiYW1iaWVudENvbG9yIix2b2lkIDApLFQoW2NpKCJkaWZmdXNlIildLEIucHJvdG90eXBlLCJkaWZmdXNlQ29sb3IiLHZvaWQgMCksVChbY2koInNwZWN1bGFyIildLEIucHJvdG90eXBlLCJzcGVjdWxhckNvbG9yIix2b2lkIDApLFQoW2NpKCJlbWlzc2l2ZSIpXSxCLnByb3RvdHlwZSwiZW1pc3NpdmVDb2xvciIsdm9pZCAwKSxUKFtSKCldLEIucHJvdG90eXBlLCJzcGVjdWxhclBvd2VyIix2b2lkIDApLFQoW1IoInVzZUFscGhhRnJvbURpZmZ1c2VUZXh0dXJlIildLEIucHJvdG90eXBlLCJfdXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0FuZE1pc2NEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlQWxwaGFGcm9tRGlmZnVzZVRleHR1cmUiLHZvaWQgMCksVChbUigidXNlRW1pc3NpdmVBc0lsbHVtaW5hdGlvbiIpXSxCLnByb3RvdHlwZSwiX3VzZUVtaXNzaXZlQXNJbGx1bWluYXRpb24iLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VFbWlzc2l2ZUFzSWxsdW1pbmF0aW9uIix2b2lkIDApLFQoW1IoImxpbmtFbWlzc2l2ZVdpdGhEaWZmdXNlIildLEIucHJvdG90eXBlLCJfbGlua0VtaXNzaXZlV2l0aERpZmZ1c2UiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJsaW5rRW1pc3NpdmVXaXRoRGlmZnVzZSIsdm9pZCAwKSxUKFtSKCJ1c2VTcGVjdWxhck92ZXJBbHBoYSIpXSxCLnByb3RvdHlwZSwiX3VzZVNwZWN1bGFyT3ZlckFscGhhIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlU3BlY3VsYXJPdmVyQWxwaGEiLHZvaWQgMCksVChbUigidXNlUmVmbGVjdGlvbk92ZXJBbHBoYSIpXSxCLnByb3RvdHlwZSwiX3VzZVJlZmxlY3Rpb25PdmVyQWxwaGEiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VSZWZsZWN0aW9uT3ZlckFscGhhIix2b2lkIDApLFQoW1IoImRpc2FibGVMaWdodGluZyIpXSxCLnByb3RvdHlwZSwiX2Rpc2FibGVMaWdodGluZyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0xpZ2h0c0RpcnR5IildLEIucHJvdG90eXBlLCJkaXNhYmxlTGlnaHRpbmciLHZvaWQgMCksVChbUigidXNlT2JqZWN0U3BhY2VOb3JtYWxNYXAiKV0sQi5wcm90b3R5cGUsIl91c2VPYmplY3RTcGFjZU5vcm1hbE1hcCIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsInVzZU9iamVjdFNwYWNlTm9ybWFsTWFwIix2b2lkIDApLFQoW1IoInVzZVBhcmFsbGF4IildLEIucHJvdG90eXBlLCJfdXNlUGFyYWxsYXgiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VQYXJhbGxheCIsdm9pZCAwKSxUKFtSKCJ1c2VQYXJhbGxheE9jY2x1c2lvbiIpXSxCLnByb3RvdHlwZSwiX3VzZVBhcmFsbGF4T2NjbHVzaW9uIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlUGFyYWxsYXhPY2NsdXNpb24iLHZvaWQgMCksVChbUigpXSxCLnByb3RvdHlwZSwicGFyYWxsYXhTY2FsZUJpYXMiLHZvaWQgMCksVChbUigicm91Z2huZXNzIildLEIucHJvdG90eXBlLCJfcm91Z2huZXNzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwicm91Z2huZXNzIix2b2lkIDApLFQoW1IoKV0sQi5wcm90b3R5cGUsImluZGV4T2ZSZWZyYWN0aW9uIix2b2lkIDApLFQoW1IoKV0sQi5wcm90b3R5cGUsImludmVydFJlZnJhY3Rpb25ZIix2b2lkIDApLFQoW1IoKV0sQi5wcm90b3R5cGUsImFscGhhQ3V0T2ZmIix2b2lkIDApLFQoW1IoInVzZUxpZ2h0bWFwQXNTaGFkb3dtYXAiKV0sQi5wcm90b3R5cGUsIl91c2VMaWdodG1hcEFzU2hhZG93bWFwIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidXNlTGlnaHRtYXBBc1NoYWRvd21hcCIsdm9pZCAwKSxUKFtOaSgiZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzIildLEIucHJvdG90eXBlLCJfZGlmZnVzZUZyZXNuZWxQYXJhbWV0ZXJzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5IildLEIucHJvdG90eXBlLCJkaWZmdXNlRnJlc25lbFBhcmFtZXRlcnMiLHZvaWQgMCksVChbTmkoIm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyIpXSxCLnByb3RvdHlwZSwiX29wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxBbmRNaXNjRGlydHkiKV0sQi5wcm90b3R5cGUsIm9wYWNpdHlGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtOaSgicmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzIildLEIucHJvdG90eXBlLCJfcmVmbGVjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5IildLEIucHJvdG90eXBlLCJyZWZsZWN0aW9uRnJlc25lbFBhcmFtZXRlcnMiLHZvaWQgMCksVChbTmkoInJlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyIpXSxCLnByb3RvdHlwZSwiX3JlZnJhY3Rpb25GcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxEaXJ0eSIpXSxCLnByb3RvdHlwZSwicmVmcmFjdGlvbkZyZXNuZWxQYXJhbWV0ZXJzIix2b2lkIDApLFQoW05pKCJlbWlzc2l2ZUZyZXNuZWxQYXJhbWV0ZXJzIildLEIucHJvdG90eXBlLCJfZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc0ZyZXNuZWxEaXJ0eSIpXSxCLnByb3RvdHlwZSwiZW1pc3NpdmVGcmVzbmVsUGFyYW1ldGVycyIsdm9pZCAwKSxUKFtSKCJ1c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhciIpXSxCLnByb3RvdHlwZSwiX3VzZVJlZmxlY3Rpb25GcmVzbmVsRnJvbVNwZWN1bGFyIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzRnJlc25lbERpcnR5IildLEIucHJvdG90eXBlLCJ1c2VSZWZsZWN0aW9uRnJlc25lbEZyb21TcGVjdWxhciIsdm9pZCAwKSxUKFtSKCJ1c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGEiKV0sQi5wcm90b3R5cGUsIl91c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGEiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJ1c2VHbG9zc2luZXNzRnJvbVNwZWN1bGFyTWFwQWxwaGEiLHZvaWQgMCksVChbUigibWF4U2ltdWx0YW5lb3VzTGlnaHRzIildLEIucHJvdG90eXBlLCJfbWF4U2ltdWx0YW5lb3VzTGlnaHRzIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzTGlnaHRzRGlydHkiKV0sQi5wcm90b3R5cGUsIm1heFNpbXVsdGFuZW91c0xpZ2h0cyIsdm9pZCAwKSxUKFtSKCJpbnZlcnROb3JtYWxNYXBYIildLEIucHJvdG90eXBlLCJfaW52ZXJ0Tm9ybWFsTWFwWCIsdm9pZCAwKSxUKFtiZSgiX21hcmtBbGxTdWJNZXNoZXNBc1RleHR1cmVzRGlydHkiKV0sQi5wcm90b3R5cGUsImludmVydE5vcm1hbE1hcFgiLHZvaWQgMCksVChbUigiaW52ZXJ0Tm9ybWFsTWFwWSIpXSxCLnByb3RvdHlwZSwiX2ludmVydE5vcm1hbE1hcFkiLHZvaWQgMCksVChbYmUoIl9tYXJrQWxsU3ViTWVzaGVzQXNUZXh0dXJlc0RpcnR5IildLEIucHJvdG90eXBlLCJpbnZlcnROb3JtYWxNYXBZIix2b2lkIDApLFQoW1IoInR3b1NpZGVkTGlnaHRpbmciKV0sQi5wcm90b3R5cGUsIl90d29TaWRlZExpZ2h0aW5nIix2b2lkIDApLFQoW2JlKCJfbWFya0FsbFN1Yk1lc2hlc0FzVGV4dHVyZXNEaXJ0eSIpXSxCLnByb3RvdHlwZSwidHdvU2lkZWRMaWdodGluZyIsdm9pZCAwKSxUKFtSKCldLEIucHJvdG90eXBlLCJ1c2VMb2dhcml0aG1pY0RlcHRoIixudWxsKSxpdCgiQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsIixCKSxuZS5EZWZhdWx0TWF0ZXJpYWxGYWN0b3J5PWM9Pm5ldyBCKCJkZWZhdWx0IG1hdGVyaWFsIixjKTtjb25zdCBFbD0iaW1hZ2VQcm9jZXNzaW5nQ29tcGF0aWJpbGl0eSIsdmw9YCNpZmRlZiBJTUFHRVBST0NFU1NJTkdQT1NUUFJPQ0VTUwpnbF9GcmFnQ29sb3IucmdiPXBvdyhnbF9GcmFnQ29sb3IucmdiLHZlYzMoMi4yKSk7CiNlbmRpZgpgO1UuSW5jbHVkZXNTaGFkZXJzU3RvcmVbRWxdPXZsO2NvbnN0IFRsPSJzaGFkb3dPbmx5UGl4ZWxTaGFkZXIiLGJsPWBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CnVuaWZvcm0gdmVjNCB2RXllUG9zaXRpb247CnVuaWZvcm0gZmxvYXQgYWxwaGE7CnVuaWZvcm0gdmVjMyBzaGFkb3dDb2xvcjsKdmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7CiNpZmRlZiBOT1JNQUwKdmFyeWluZyB2ZWMzIHZOb3JtYWxXOwojZW5kaWYKI2luY2x1ZGU8aGVscGVyRnVuY3Rpb25zPgojaW5jbHVkZTxfX2RlY2xfX2xpZ2h0RnJhZ21lbnQ+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c10KI2luY2x1ZGU8bGlnaHRzRnJhZ21lbnRGdW5jdGlvbnM+CiNpbmNsdWRlPHNoYWRvd3NGcmFnbWVudEZ1bmN0aW9ucz4KI2luY2x1ZGU8Y2xpcFBsYW5lRnJhZ21lbnREZWNsYXJhdGlvbj4KI2luY2x1ZGU8Zm9nRnJhZ21lbnREZWNsYXJhdGlvbj4KI2RlZmluZSBDVVNUT01fRlJBR01FTlRfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fRlJBR01FTlRfTUFJTl9CRUdJTgojaW5jbHVkZTxjbGlwUGxhbmVGcmFnbWVudD4KdmVjMyB2aWV3RGlyZWN0aW9uVz1ub3JtYWxpemUodkV5ZVBvc2l0aW9uLnh5ei12UG9zaXRpb25XKTsKI2lmZGVmIE5PUk1BTAp2ZWMzIG5vcm1hbFc9bm9ybWFsaXplKHZOb3JtYWxXKTsKI2Vsc2UKdmVjMyBub3JtYWxXPXZlYzMoMS4wLDEuMCwxLjApOwojZW5kaWYKdmVjMyBkaWZmdXNlQmFzZT12ZWMzKDAuLDAuLDAuKTsKbGlnaHRpbmdJbmZvIGluZm87CmZsb2F0IHNoYWRvdz0xLjsKZmxvYXQgZ2xvc3NpbmVzcz0wLjsKI2luY2x1ZGU8bGlnaHRGcmFnbWVudD5bMC4uMV0KdmVjNCBjb2xvcj12ZWM0KHNoYWRvd0NvbG9yLCgxLjAtY2xhbXAoc2hhZG93LDAuLDEuKSkqYWxwaGEpOwojaW5jbHVkZTxmb2dGcmFnbWVudD4KZ2xfRnJhZ0NvbG9yPWNvbG9yOwojaW5jbHVkZTxpbWFnZVByb2Nlc3NpbmdDb21wYXRpYmlsaXR5PgojZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9NQUlOX0VORAp9YDtVLlNoYWRlcnNTdG9yZVtUbF09Ymw7Y29uc3QgU2w9InNoYWRvd09ubHlWZXJ0ZXhTaGFkZXIiLHhsPWBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CmF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uOwojaWZkZWYgTk9STUFMCmF0dHJpYnV0ZSB2ZWMzIG5vcm1hbDsKI2VuZGlmCiNpbmNsdWRlPGJvbmVzRGVjbGFyYXRpb24+CiNpbmNsdWRlPGJha2VkVmVydGV4QW5pbWF0aW9uRGVjbGFyYXRpb24+CiNpbmNsdWRlPGluc3RhbmNlc0RlY2xhcmF0aW9uPgp1bmlmb3JtIG1hdDQgdmlldzsKdW5pZm9ybSBtYXQ0IHZpZXdQcm9qZWN0aW9uOwojaWZkZWYgUE9JTlRTSVpFCnVuaWZvcm0gZmxvYXQgcG9pbnRTaXplOwojZW5kaWYKdmFyeWluZyB2ZWMzIHZQb3NpdGlvblc7CiNpZmRlZiBOT1JNQUwKdmFyeWluZyB2ZWMzIHZOb3JtYWxXOwojZW5kaWYKI2lmZGVmIFZFUlRFWENPTE9SCnZhcnlpbmcgdmVjNCB2Q29sb3I7CiNlbmRpZgojaW5jbHVkZTxjbGlwUGxhbmVWZXJ0ZXhEZWNsYXJhdGlvbj4KI2luY2x1ZGU8Zm9nVmVydGV4RGVjbGFyYXRpb24+CiNpbmNsdWRlPF9fZGVjbF9fbGlnaHRGcmFnbWVudD5bMC4ubWF4U2ltdWx0YW5lb3VzTGlnaHRzXQojZGVmaW5lIENVU1RPTV9WRVJURVhfREVGSU5JVElPTlMKdm9pZCBtYWluKHZvaWQpIHsKI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fQkVHSU4KI2luY2x1ZGU8aW5zdGFuY2VzVmVydGV4PgojaW5jbHVkZTxib25lc1ZlcnRleD4KI2luY2x1ZGU8YmFrZWRWZXJ0ZXhBbmltYXRpb24+CnZlYzQgd29ybGRQb3M9ZmluYWxXb3JsZCp2ZWM0KHBvc2l0aW9uLDEuMCk7CmdsX1Bvc2l0aW9uPXZpZXdQcm9qZWN0aW9uKndvcmxkUG9zOwp2UG9zaXRpb25XPXZlYzMod29ybGRQb3MpOwojaWZkZWYgTk9STUFMCnZOb3JtYWxXPW5vcm1hbGl6ZSh2ZWMzKGZpbmFsV29ybGQqdmVjNChub3JtYWwsMC4wKSkpOwojZW5kaWYKI2luY2x1ZGU8Y2xpcFBsYW5lVmVydGV4PgojaW5jbHVkZTxmb2dWZXJ0ZXg+CiNpbmNsdWRlPHNoYWRvd3NWZXJ0ZXg+WzAuLm1heFNpbXVsdGFuZW91c0xpZ2h0c10KI2lmIGRlZmluZWQoUE9JTlRTSVpFKSAmJiAhZGVmaW5lZChXRUJHUFUpCmdsX1BvaW50U2l6ZT1wb2ludFNpemU7CiNlbmRpZgojZGVmaW5lIENVU1RPTV9WRVJURVhfTUFJTl9FTkQKfQpgO1UuU2hhZGVyc1N0b3JlW1NsXT14bDtjbGFzcyBNbCBleHRlbmRzIHlze2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLkNMSVBQTEFORT0hMSx0aGlzLkNMSVBQTEFORTI9ITEsdGhpcy5DTElQUExBTkUzPSExLHRoaXMuQ0xJUFBMQU5FND0hMSx0aGlzLkNMSVBQTEFORTU9ITEsdGhpcy5DTElQUExBTkU2PSExLHRoaXMuUE9JTlRTSVpFPSExLHRoaXMuRk9HPSExLHRoaXMuTk9STUFMPSExLHRoaXMuTlVNX0JPTkVfSU5GTFVFTkNFUlM9MCx0aGlzLkJvbmVzUGVyTWVzaD0wLHRoaXMuSU5TVEFOQ0VTPSExLHRoaXMuSU1BR0VQUk9DRVNTSU5HUE9TVFBST0NFU1M9ITEsdGhpcy5TS0lQRklOQUxDT0xPUkNMQU1QPSExLHRoaXMucmVidWlsZCgpfX1jbGFzcyBraSBleHRlbmRzIFZye2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIoZSx0KSx0aGlzLl9uZWVkQWxwaGFCbGVuZGluZz0hMCx0aGlzLnNoYWRvd0NvbG9yPXJlLkJsYWNrKCl9bmVlZEFscGhhQmxlbmRpbmcoKXtyZXR1cm4gdGhpcy5fbmVlZEFscGhhQmxlbmRpbmd9bmVlZEFscGhhVGVzdGluZygpe3JldHVybiExfWdldEFscGhhVGVzdFRleHR1cmUoKXtyZXR1cm4gbnVsbH1nZXQgYWN0aXZlTGlnaHQoKXtyZXR1cm4gdGhpcy5fYWN0aXZlTGlnaHR9c2V0IGFjdGl2ZUxpZ2h0KGUpe3RoaXMuX2FjdGl2ZUxpZ2h0PWV9X2dldEZpcnN0U2hhZG93TGlnaHRGb3JNZXNoKGUpe2Zvcihjb25zdCB0IG9mIGUubGlnaHRTb3VyY2VzKWlmKHQuc2hhZG93RW5hYmxlZClyZXR1cm4gdDtyZXR1cm4gbnVsbH1pc1JlYWR5Rm9yU3ViTWVzaChlLHQsaSl7dmFyIHM7aWYodGhpcy5pc0Zyb3plbiYmdC5lZmZlY3QmJnQuZWZmZWN0Ll93YXNQcmV2aW91c2x5UmVhZHkmJnQuZWZmZWN0Ll93YXNQcmV2aW91c2x5VXNpbmdJbnN0YW5jZXM9PT1pKXJldHVybiEwO3QubWF0ZXJpYWxEZWZpbmVzfHwodC5tYXRlcmlhbERlZmluZXM9bmV3IE1sKTtjb25zdCByPXQubWF0ZXJpYWxEZWZpbmVzLG49dGhpcy5nZXRTY2VuZSgpO2lmKHRoaXMuX2lzUmVhZHlGb3JTdWJNZXNoKHQpKXJldHVybiEwO2NvbnN0IGE9bi5nZXRFbmdpbmUoKTtpZih0aGlzLl9hY3RpdmVMaWdodCl7Zm9yKGNvbnN0IGggb2YgZS5saWdodFNvdXJjZXMpaWYoaC5zaGFkb3dFbmFibGVkKXtpZih0aGlzLl9hY3RpdmVMaWdodD09PWgpYnJlYWs7Y29uc3QgbD1lLmxpZ2h0U291cmNlcy5pbmRleE9mKHRoaXMuX2FjdGl2ZUxpZ2h0KTtsIT09LTEmJihlLmxpZ2h0U291cmNlcy5zcGxpY2UobCwxKSxlLmxpZ2h0U291cmNlcy5zcGxpY2UoMCwwLHRoaXMuX2FjdGl2ZUxpZ2h0KSk7YnJlYWt9fWllLlByZXBhcmVEZWZpbmVzRm9yRnJhbWVCb3VuZFZhbHVlcyhuLGEsdGhpcyxyLCEhaSksaWUuUHJlcGFyZURlZmluZXNGb3JNaXNjKGUsbiwhMSx0aGlzLnBvaW50c0Nsb3VkLHRoaXMuZm9nRW5hYmxlZCx0aGlzLl9zaG91bGRUdXJuQWxwaGFUZXN0T24oZSksciksci5fbmVlZE5vcm1hbHM9aWUuUHJlcGFyZURlZmluZXNGb3JMaWdodHMobixlLHIsITEsMSk7Y29uc3Qgbz0ocz10aGlzLl9nZXRGaXJzdFNoYWRvd0xpZ2h0Rm9yTWVzaChlKSk9PT1udWxsfHxzPT09dm9pZCAwP3ZvaWQgMDpzLmdldFNoYWRvd0dlbmVyYXRvcigpO2lmKHRoaXMuX25lZWRBbHBoYUJsZW5kaW5nPSEwLG8mJm8uZ2V0Q2xhc3NOYW1lJiZvLmdldENsYXNzTmFtZSgpPT09IkNhc2NhZGVkU2hhZG93R2VuZXJhdG9yIil7Y29uc3QgaD1vO3RoaXMuX25lZWRBbHBoYUJsZW5kaW5nPSFoLmF1dG9DYWxjRGVwdGhCb3VuZHN9aWYoaWUuUHJlcGFyZURlZmluZXNGb3JBdHRyaWJ1dGVzKGUsciwhMSwhMCksci5pc0RpcnR5KXtyLm1hcmtBc1Byb2Nlc3NlZCgpLG4ucmVzZXRDYWNoZWRNYXRlcmlhbCgpO2NvbnN0IGg9bmV3IHpzO3IuRk9HJiZoLmFkZEZhbGxiYWNrKDEsIkZPRyIpLGllLkhhbmRsZUZhbGxiYWNrc0ZvclNoYWRvd3MocixoLDEpLHIuTlVNX0JPTkVfSU5GTFVFTkNFUlM+MCYmaC5hZGRDUFVTa2lubmluZ0ZhbGxiYWNrKDAsZSksci5JTUFHRVBST0NFU1NJTkdQT1NUUFJPQ0VTUz1uLmltYWdlUHJvY2Vzc2luZ0NvbmZpZ3VyYXRpb24uYXBwbHlCeVBvc3RQcm9jZXNzO2NvbnN0IGw9W2cuUG9zaXRpb25LaW5kXTtyLk5PUk1BTCYmbC5wdXNoKGcuTm9ybWFsS2luZCksaWUuUHJlcGFyZUF0dHJpYnV0ZXNGb3JCb25lcyhsLGUscixoKSxpZS5QcmVwYXJlQXR0cmlidXRlc0Zvckluc3RhbmNlcyhsLHIpO2NvbnN0IHU9InNoYWRvd09ubHkiLGQ9ci50b1N0cmluZygpLGY9WyJ3b3JsZCIsInZpZXciLCJ2aWV3UHJvamVjdGlvbiIsInZFeWVQb3NpdGlvbiIsInZMaWdodHNUeXBlIiwidkZvZ0luZm9zIiwidkZvZ0NvbG9yIiwicG9pbnRTaXplIiwiYWxwaGEiLCJzaGFkb3dDb2xvciIsIm1Cb25lcyJdLF89bmV3IEFycmF5LEU9bmV3IEFycmF5O3NzKGYpLGllLlByZXBhcmVVbmlmb3Jtc0FuZFNhbXBsZXJzTGlzdCh7dW5pZm9ybXNOYW1lczpmLHVuaWZvcm1CdWZmZXJzTmFtZXM6RSxzYW1wbGVyczpfLGRlZmluZXM6cixtYXhTaW11bHRhbmVvdXNMaWdodHM6MX0pLHQuc2V0RWZmZWN0KG4uZ2V0RW5naW5lKCkuY3JlYXRlRWZmZWN0KHUse2F0dHJpYnV0ZXM6bCx1bmlmb3Jtc05hbWVzOmYsdW5pZm9ybUJ1ZmZlcnNOYW1lczpFLHNhbXBsZXJzOl8sZGVmaW5lczpkLGZhbGxiYWNrczpoLG9uQ29tcGlsZWQ6dGhpcy5vbkNvbXBpbGVkLG9uRXJyb3I6dGhpcy5vbkVycm9yLGluZGV4UGFyYW1ldGVyczp7bWF4U2ltdWx0YW5lb3VzTGlnaHRzOjF9fSxhKSxyLHRoaXMuX21hdGVyaWFsQ29udGV4dCl9cmV0dXJuIXQuZWZmZWN0fHwhdC5lZmZlY3QuaXNSZWFkeSgpPyExOihyLl9yZW5kZXJJZD1uLmdldFJlbmRlcklkKCksdC5lZmZlY3QuX3dhc1ByZXZpb3VzbHlSZWFkeT0hMCx0LmVmZmVjdC5fd2FzUHJldmlvdXNseVVzaW5nSW5zdGFuY2VzPSEhaSwhMCl9YmluZEZvclN1Yk1lc2goZSx0LGkpe2NvbnN0IHM9dGhpcy5nZXRTY2VuZSgpLHI9aS5tYXRlcmlhbERlZmluZXM7aWYoIXIpcmV0dXJuO2NvbnN0IG49aS5lZmZlY3Q7aWYobil7aWYodGhpcy5fYWN0aXZlRWZmZWN0PW4sdGhpcy5iaW5kT25seVdvcmxkTWF0cml4KGUpLHRoaXMuX2FjdGl2ZUVmZmVjdC5zZXRNYXRyaXgoInZpZXdQcm9qZWN0aW9uIixzLmdldFRyYW5zZm9ybU1hdHJpeCgpKSxpZS5CaW5kQm9uZXNQYXJhbWV0ZXJzKHQsdGhpcy5fYWN0aXZlRWZmZWN0KSx0aGlzLl9tdXN0UmViaW5kKHMsbikmJihycyhuLHRoaXMscyksdGhpcy5wb2ludHNDbG91ZCYmdGhpcy5fYWN0aXZlRWZmZWN0LnNldEZsb2F0KCJwb2ludFNpemUiLHRoaXMucG9pbnRTaXplKSx0aGlzLl9hY3RpdmVFZmZlY3Quc2V0RmxvYXQoImFscGhhIix0aGlzLmFscGhhKSx0aGlzLl9hY3RpdmVFZmZlY3Quc2V0Q29sb3IzKCJzaGFkb3dDb2xvciIsdGhpcy5zaGFkb3dDb2xvcikscy5iaW5kRXllUG9zaXRpb24obikpLHMubGlnaHRzRW5hYmxlZCl7aWUuQmluZExpZ2h0cyhzLHQsdGhpcy5fYWN0aXZlRWZmZWN0LHIsMSk7Y29uc3QgYT10aGlzLl9nZXRGaXJzdFNoYWRvd0xpZ2h0Rm9yTWVzaCh0KTthJiYoYS5fcmVuZGVySWQ9LTEpfShzLmZvZ0VuYWJsZWQmJnQuYXBwbHlGb2cmJnMuZm9nTW9kZSE9PW5lLkZPR01PREVfTk9ORXx8ci5TSEFET1dDU00wKSYmdGhpcy5fYWN0aXZlRWZmZWN0LnNldE1hdHJpeCgidmlldyIscy5nZXRWaWV3TWF0cml4KCkpLGllLkJpbmRGb2dQYXJhbWV0ZXJzKHMsdCx0aGlzLl9hY3RpdmVFZmZlY3QpLHRoaXMuX2FmdGVyQmluZCh0LHRoaXMuX2FjdGl2ZUVmZmVjdCl9fWNsb25lKGUpe3JldHVybiBhZS5DbG9uZSgoKT0+bmV3IGtpKGUsdGhpcy5nZXRTY2VuZSgpKSx0aGlzKX1zZXJpYWxpemUoKXtjb25zdCBlPXN1cGVyLnNlcmlhbGl6ZSgpO3JldHVybiBlLmN1c3RvbVR5cGU9IkJBQllMT04uU2hhZG93T25seU1hdGVyaWFsIixlfWdldENsYXNzTmFtZSgpe3JldHVybiJTaGFkb3dPbmx5TWF0ZXJpYWwifXN0YXRpYyBQYXJzZShlLHQsaSl7cmV0dXJuIGFlLlBhcnNlKCgpPT5uZXcga2koZS5uYW1lLHQpLGUsdCxpKX19aXQoIkJBQllMT04uU2hhZG93T25seU1hdGVyaWFsIixraSk7Y29uc3QgQWw9e2FzcGVjdDozMDAvMTUwLGVuYWJsZURlYnVnZ2luZzohMSxlbmFibGVTaGFkb3dzOiEwfTtjbGFzcyBSbHtjb25zdHJ1Y3RvcihlKXtidCh0aGlzLCJzaXplIiw5LjUpO3RoaXMuY29uZmlnPXsuLi5BbCwuLi5lfSx0aGlzLmNyZWF0ZSgpfWNyZWF0ZShlKXt0aGlzLmRlc3Ryb3koKSxPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLGUpO2NvbnN0e2FzcGVjdDp0LGVuYWJsZURlYnVnZ2luZzppPSEwLGVuYWJsZVNoYWRvd3M6c309dGhpcy5jb25maWcscj0zMDtsZXQgbjt0aGlzLmJveD1uZXcgSigiZGljZUJveCIpLGk/KG49bmV3IEIoImRpY2VCb3hfbWF0ZXJpYWwiKSxuLmFscGhhPS43LG4uZGlmZnVzZUNvbG9yPW5ldyByZSgxLDEsMCkpOnMmJihuPW5ldyBraSgic2hhZG93T25seSIsdGhpcy5jb25maWcuc2NlbmUpKTtjb25zdCBhPU1pKCJncm91bmQiLHt3aWR0aDp0aGlzLnNpemUqMixoZWlnaHQ6MSxkZXB0aDp0aGlzLnNpemUqMn0sdGhpcy5jb25maWcuc2NlbmUpO2lmKGEuc2NhbGluZz1uZXcgcCh0LDEsMSksYS5tYXRlcmlhbD1uLGEucmVjZWl2ZVNoYWRvd3M9ITAsYS5zZXRQYXJlbnQodGhpcy5ib3gpLGkpe2NvbnN0IG89TWkoIndhbGxUb3AiLHt3aWR0aDp0aGlzLnNpemUsaGVpZ2h0OnIsZGVwdGg6MX0sdGhpcy5jb25maWcuc2NlbmUpO28ucG9zaXRpb24ueT1yLzIsby5wb3NpdGlvbi56PXRoaXMuc2l6ZS8tMixvLnNjYWxpbmc9bmV3IHAodCwxLDEpLG8ubWF0ZXJpYWw9bixvLnNldFBhcmVudCh0aGlzLmJveCk7Y29uc3QgaD1NaSgid2FsbFJpZ2h0Iix7d2lkdGg6MSxoZWlnaHQ6cixkZXB0aDp0aGlzLnNpemV9LHRoaXMuY29uZmlnLnNjZW5lKTtoLnBvc2l0aW9uLng9dGhpcy5zaXplKnQvMixoLnBvc2l0aW9uLnk9ci8yLGgubWF0ZXJpYWw9bixoLnNldFBhcmVudCh0aGlzLmJveCk7Y29uc3QgbD1NaSgid2FsbEJvdHRvbSIse3dpZHRoOnRoaXMuc2l6ZSxoZWlnaHQ6cixkZXB0aDoxfSx0aGlzLmNvbmZpZy5zY2VuZSk7bC5wb3NpdGlvbi55PXIvMixsLnBvc2l0aW9uLno9dGhpcy5zaXplLzIsbC5zY2FsaW5nPW5ldyBwKHQsMSwxKSxsLm1hdGVyaWFsPW4sbC5zZXRQYXJlbnQodGhpcy5ib3gpO2NvbnN0IHU9TWkoIndhbGxMZWZ0Iix7d2lkdGg6MSxoZWlnaHQ6cixkZXB0aDp0aGlzLnNpemV9LHRoaXMuY29uZmlnLnNjZW5lKTt1LnBvc2l0aW9uLng9dGhpcy5zaXplKnQvLTIsdS5wb3NpdGlvbi55PXIvMix1Lm1hdGVyaWFsPW4sdS5zZXRQYXJlbnQodGhpcy5ib3gpfX1kZXN0cm95KCl7dGhpcy5ib3gmJnRoaXMuYm94LmRpc3Bvc2UoKX19dmFyIHRpOyhmdW5jdGlvbihjKXtjW2MuQ2xlYW49MF09IkNsZWFuIixjW2MuU3RvcD0xXT0iU3RvcCIsY1tjLlN5bmM9Ml09IlN5bmMiLGNbYy5Ob1N5bmM9M109Ik5vU3luYyJ9KSh0aXx8KHRpPXt9KSk7Y2xhc3MgbGV7c3RhdGljIGdldCBGb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbCgpe3JldHVybiBPZS5Gb3JjZUZ1bGxTY2VuZUxvYWRpbmdGb3JJbmNyZW1lbnRhbH1zdGF0aWMgc2V0IEZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsKGUpe09lLkZvcmNlRnVsbFNjZW5lTG9hZGluZ0ZvckluY3JlbWVudGFsPWV9c3RhdGljIGdldCBTaG93TG9hZGluZ1NjcmVlbigpe3JldHVybiBPZS5TaG93TG9hZGluZ1NjcmVlbn1zdGF0aWMgc2V0IFNob3dMb2FkaW5nU2NyZWVuKGUpe09lLlNob3dMb2FkaW5nU2NyZWVuPWV9c3RhdGljIGdldCBsb2dnaW5nTGV2ZWwoKXtyZXR1cm4gT2UubG9nZ2luZ0xldmVsfXN0YXRpYyBzZXQgbG9nZ2luZ0xldmVsKGUpe09lLmxvZ2dpbmdMZXZlbD1lfXN0YXRpYyBnZXQgQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cygpe3JldHVybiBPZS5DbGVhbkJvbmVNYXRyaXhXZWlnaHRzfXN0YXRpYyBzZXQgQ2xlYW5Cb25lTWF0cml4V2VpZ2h0cyhlKXtPZS5DbGVhbkJvbmVNYXRyaXhXZWlnaHRzPWV9c3RhdGljIEdldERlZmF1bHRQbHVnaW4oKXtyZXR1cm4gbGUuX1JlZ2lzdGVyZWRQbHVnaW5zWyIuYmFieWxvbiJdfXN0YXRpYyBfR2V0UGx1Z2luRm9yRXh0ZW5zaW9uKGUpe2NvbnN0IHQ9bGUuX1JlZ2lzdGVyZWRQbHVnaW5zW2VdO3JldHVybiB0fHwoTy5XYXJuKCJVbmFibGUgdG8gZmluZCBhIHBsdWdpbiB0byBsb2FkICIrZSsiIGZpbGVzLiBUcnlpbmcgdG8gdXNlIC5iYWJ5bG9uIGRlZmF1bHQgcGx1Z2luLiBUbyBsb2FkIGZyb20gYSBzcGVjaWZpYyBmaWxldHlwZSAoZWcuIGdsdGYpIHNlZTogaHR0cHM6Ly9kb2MuYmFieWxvbmpzLmNvbS9mZWF0dXJlcy9mZWF0dXJlc0RlZXBEaXZlL2ltcG9ydGVycy9sb2FkaW5nRmlsZVR5cGVzIiksbGUuR2V0RGVmYXVsdFBsdWdpbigpKX1zdGF0aWMgX0dldFBsdWdpbkZvckRpcmVjdExvYWQoZSl7Zm9yKGNvbnN0IHQgaW4gbGUuX1JlZ2lzdGVyZWRQbHVnaW5zKXtjb25zdCBpPWxlLl9SZWdpc3RlcmVkUGx1Z2luc1t0XS5wbHVnaW47aWYoaS5jYW5EaXJlY3RMb2FkJiZpLmNhbkRpcmVjdExvYWQoZSkpcmV0dXJuIGxlLl9SZWdpc3RlcmVkUGx1Z2luc1t0XX1yZXR1cm4gbGUuR2V0RGVmYXVsdFBsdWdpbigpfXN0YXRpYyBfR2V0UGx1Z2luRm9yRmlsZW5hbWUoZSl7Y29uc3QgdD1lLmluZGV4T2YoIj8iKTt0IT09LTEmJihlPWUuc3Vic3RyaW5nKDAsdCkpO2NvbnN0IGk9ZS5sYXN0SW5kZXhPZigiLiIpLHM9ZS5zdWJzdHJpbmcoaSxlLmxlbmd0aCkudG9Mb3dlckNhc2UoKTtyZXR1cm4gbGUuX0dldFBsdWdpbkZvckV4dGVuc2lvbihzKX1zdGF0aWMgX0dldERpcmVjdExvYWQoZSl7cmV0dXJuIGUuc3Vic3RyKDAsNSk9PT0iZGF0YToiP2Uuc3Vic3RyKDUpOm51bGx9c3RhdGljIF9Gb3JtYXRFcnJvck1lc3NhZ2UoZSx0LGkpe2xldCBzPSJVbmFibGUgdG8gbG9hZCBmcm9tICIrZS51cmw7cmV0dXJuIHQ/cys9YDogJHt0fWA6aSYmKHMrPWA6ICR7aX1gKSxzfXN0YXRpYyBfTG9hZERhdGEoZSx0LGkscyxyLG4sYSl7Y29uc3Qgbz1sZS5fR2V0RGlyZWN0TG9hZChlLnVybCksaD1hP2xlLl9HZXRQbHVnaW5Gb3JFeHRlbnNpb24oYSk6bz9sZS5fR2V0UGx1Z2luRm9yRGlyZWN0TG9hZChlLnVybCk6bGUuX0dldFBsdWdpbkZvckZpbGVuYW1lKGUudXJsKTtsZXQgbDtpZihoLnBsdWdpbi5jcmVhdGVQbHVnaW4hPT12b2lkIDA/bD1oLnBsdWdpbi5jcmVhdGVQbHVnaW4oKTpsPWgucGx1Z2luLCFsKXRocm93IlRoZSBsb2FkZXIgcGx1Z2luIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGZpbGUgdHlwZSB5b3UgYXJlIHRyeWluZyB0byBsb2FkIGhhcyBub3QgYmVlbiBmb3VuZC4gSWYgdXNpbmcgZXM2LCBwbGVhc2UgaW1wb3J0IHRoZSBwbHVnaW4geW91IHdpc2ggdG8gdXNlIGJlZm9yZS4iO2lmKGxlLk9uUGx1Z2luQWN0aXZhdGVkT2JzZXJ2YWJsZS5ub3RpZnlPYnNlcnZlcnMobCksbyYmKGwuY2FuRGlyZWN0TG9hZCYmbC5jYW5EaXJlY3RMb2FkKGUudXJsKXx8IU1zKGUudXJsKSkpe2lmKGwuZGlyZWN0TG9hZCl7Y29uc3QgeT1sLmRpcmVjdExvYWQodCxvKTt5LnRoZW4/eS50aGVuKEE9PntpKGwsQSl9KS5jYXRjaChBPT57cigiRXJyb3IgaW4gZGlyZWN0TG9hZCBvZiBfbG9hZERhdGE6ICIrQSxBKX0pOmkobCx5KX1lbHNlIGkobCxvKTtyZXR1cm4gbH1jb25zdCB1PWguaXNCaW5hcnksZD0oeSxBKT0+e2lmKHQuaXNEaXNwb3NlZCl7cigiU2NlbmUgaGFzIGJlZW4gZGlzcG9zZWQiKTtyZXR1cm59aShsLHksQSl9O2xldCBmPW51bGwsXz0hMTtjb25zdCBFPWwub25EaXNwb3NlT2JzZXJ2YWJsZTtFJiZFLmFkZCgoKT0+e189ITAsZiYmKGYuYWJvcnQoKSxmPW51bGwpLG4oKX0pO2NvbnN0IG09KCk9PntpZihfKXJldHVybjtjb25zdCB5PShDLGIpPT57cihDPT1udWxsP3ZvaWQgMDpDLnN0YXR1c1RleHQsYil9LEE9ZS5maWxlfHxlLnVybDtmPWwubG9hZEZpbGU/bC5sb2FkRmlsZSh0LEEsZCxzLHUseSk6dC5fbG9hZEZpbGUoQSxkLHMsITAsdSx5KX0sdj10LmdldEVuZ2luZSgpO2xldCBTPXYuZW5hYmxlT2ZmbGluZVN1cHBvcnQ7aWYoUyl7bGV0IHk9ITE7Zm9yKGNvbnN0IEEgb2YgdC5kaXNhYmxlT2ZmbGluZVN1cHBvcnRFeGNlcHRpb25SdWxlcylpZihBLnRlc3QoZS51cmwpKXt5PSEwO2JyZWFrfVM9IXl9cmV0dXJuIFMmJkkuT2ZmbGluZVByb3ZpZGVyRmFjdG9yeT90Lm9mZmxpbmVQcm92aWRlcj1JLk9mZmxpbmVQcm92aWRlckZhY3RvcnkoZS51cmwsbSx2LmRpc2FibGVNYW5pZmVzdENoZWNrKTptKCksbH1zdGF0aWMgX0dldEZpbGVJbmZvKGUsdCl7bGV0IGkscyxyPW51bGw7aWYoIXQpaT1lLHM9SC5HZXRGaWxlbmFtZShlKSxlPUguR2V0Rm9sZGVyUGF0aChlKTtlbHNlIGlmKHQubmFtZSl7Y29uc3Qgbj10O2k9YGZpbGU6JHtuLm5hbWV9YCxzPW4ubmFtZSxyPW59ZWxzZSBpZih0eXBlb2YgdD09InN0cmluZyImJnQuc3RhcnRzV2l0aCgiZGF0YToiKSlpPXQscz0iIjtlbHNle2NvbnN0IG49dDtpZihuLnN1YnN0cigwLDEpPT09Ii8iKXJldHVybiBILkVycm9yKCJXcm9uZyBzY2VuZUZpbGVuYW1lIHBhcmFtZXRlciIpLG51bGw7aT1lK24scz1ufXJldHVybnt1cmw6aSxyb290VXJsOmUsbmFtZTpzLGZpbGU6cn19c3RhdGljIEdldFBsdWdpbkZvckV4dGVuc2lvbihlKXtyZXR1cm4gbGUuX0dldFBsdWdpbkZvckV4dGVuc2lvbihlKS5wbHVnaW59c3RhdGljIElzUGx1Z2luRm9yRXh0ZW5zaW9uQXZhaWxhYmxlKGUpe3JldHVybiEhbGUuX1JlZ2lzdGVyZWRQbHVnaW5zW2VdfXN0YXRpYyBSZWdpc3RlclBsdWdpbihlKXtpZih0eXBlb2YgZS5leHRlbnNpb25zPT0ic3RyaW5nIil7Y29uc3QgdD1lLmV4dGVuc2lvbnM7bGUuX1JlZ2lzdGVyZWRQbHVnaW5zW3QudG9Mb3dlckNhc2UoKV09e3BsdWdpbjplLGlzQmluYXJ5OiExfX1lbHNle2NvbnN0IHQ9ZS5leHRlbnNpb25zO09iamVjdC5rZXlzKHQpLmZvckVhY2goaT0+e2xlLl9SZWdpc3RlcmVkUGx1Z2luc1tpLnRvTG93ZXJDYXNlKCldPXtwbHVnaW46ZSxpc0JpbmFyeTp0W2ldLmlzQmluYXJ5fX0pfX1zdGF0aWMgSW1wb3J0TWVzaChlLHQsaT0iIixzPWZlLkxhc3RDcmVhdGVkU2NlbmUscj1udWxsLG49bnVsbCxhPW51bGwsbz1udWxsKXtpZighcylyZXR1cm4gTy5FcnJvcigiTm8gc2NlbmUgYXZhaWxhYmxlIHRvIGltcG9ydCBtZXNoIHRvIiksbnVsbDtjb25zdCBoPWxlLl9HZXRGaWxlSW5mbyh0LGkpO2lmKCFoKXJldHVybiBudWxsO2NvbnN0IGw9e307cy5hZGRQZW5kaW5nRGF0YShsKTtjb25zdCB1PSgpPT57cy5yZW1vdmVQZW5kaW5nRGF0YShsKX0sZD0oRSxtKT0+e2NvbnN0IHY9bGUuX0Zvcm1hdEVycm9yTWVzc2FnZShoLEUsbSk7YT9hKHMsdixuZXcgTnQodixvaS5TY2VuZUxvYWRlckVycm9yLG0pKTpPLkVycm9yKHYpLHUoKX0sZj1uP0U9Pnt0cnl7bihFKX1jYXRjaChtKXtkKCJFcnJvciBpbiBvblByb2dyZXNzIGNhbGxiYWNrOiAiK20sbSl9fTp2b2lkIDAsXz0oRSxtLHYsUyx5LEEsQyk9PntpZihzLmltcG9ydGVkTWVzaGVzRmlsZXMucHVzaChoLnVybCkscil0cnl7cihFLG0sdixTLHksQSxDKX1jYXRjaChiKXtkKCJFcnJvciBpbiBvblN1Y2Nlc3MgY2FsbGJhY2s6ICIrYixiKX1zLnJlbW92ZVBlbmRpbmdEYXRhKGwpfTtyZXR1cm4gbGUuX0xvYWREYXRhKGgscywoRSxtLHYpPT57aWYoRS5yZXdyaXRlUm9vdFVSTCYmKGgucm9vdFVybD1FLnJld3JpdGVSb290VVJMKGgucm9vdFVybCx2KSksRS5pbXBvcnRNZXNoKXtjb25zdCBTPUUseT1uZXcgQXJyYXksQT1uZXcgQXJyYXksQz1uZXcgQXJyYXk7aWYoIVMuaW1wb3J0TWVzaChlLHMsbSxoLnJvb3RVcmwseSxBLEMsZCkpcmV0dXJuO3MubG9hZGluZ1BsdWdpbk5hbWU9RS5uYW1lLF8oeSxBLEMsW10sW10sW10sW10pfWVsc2UgRS5pbXBvcnRNZXNoQXN5bmMoZSxzLG0saC5yb290VXJsLGYsaC5uYW1lKS50aGVuKHk9PntzLmxvYWRpbmdQbHVnaW5OYW1lPUUubmFtZSxfKHkubWVzaGVzLHkucGFydGljbGVTeXN0ZW1zLHkuc2tlbGV0b25zLHkuYW5pbWF0aW9uR3JvdXBzLHkudHJhbnNmb3JtTm9kZXMseS5nZW9tZXRyaWVzLHkubGlnaHRzKX0pLmNhdGNoKHk9PntkKHkubWVzc2FnZSx5KX0pfSxmLGQsdSxvKX1zdGF0aWMgSW1wb3J0TWVzaEFzeW5jKGUsdCxpPSIiLHM9ZmUuTGFzdENyZWF0ZWRTY2VuZSxyPW51bGwsbj1udWxsKXtyZXR1cm4gbmV3IFByb21pc2UoKGEsbyk9PntsZS5JbXBvcnRNZXNoKGUsdCxpLHMsKGgsbCx1LGQsZixfLEUpPT57YSh7bWVzaGVzOmgscGFydGljbGVTeXN0ZW1zOmwsc2tlbGV0b25zOnUsYW5pbWF0aW9uR3JvdXBzOmQsdHJhbnNmb3JtTm9kZXM6ZixnZW9tZXRyaWVzOl8sbGlnaHRzOkV9KX0sciwoaCxsLHUpPT57byh1fHxuZXcgRXJyb3IobCkpfSxuKX0pfXN0YXRpYyBMb2FkKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkRW5naW5lLHM9bnVsbCxyPW51bGwsbj1udWxsLGE9bnVsbCl7cmV0dXJuIGk/bGUuQXBwZW5kKGUsdCxuZXcgbmUoaSkscyxyLG4sYSk6KEguRXJyb3IoIk5vIGVuZ2luZSBhdmFpbGFibGUiKSxudWxsKX1zdGF0aWMgTG9hZEFzeW5jKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkRW5naW5lLHM9bnVsbCxyPW51bGwpe3JldHVybiBuZXcgUHJvbWlzZSgobixhKT0+e2xlLkxvYWQoZSx0LGksbz0+e24obyl9LHMsKG8saCxsKT0+e2EobHx8bmV3IEVycm9yKGgpKX0scil9KX1zdGF0aWMgQXBwZW5kKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz1udWxsLHI9bnVsbCxuPW51bGwsYT1udWxsKXtpZighaSlyZXR1cm4gTy5FcnJvcigiTm8gc2NlbmUgYXZhaWxhYmxlIHRvIGFwcGVuZCB0byIpLG51bGw7Y29uc3Qgbz1sZS5fR2V0RmlsZUluZm8oZSx0KTtpZighbylyZXR1cm4gbnVsbDtjb25zdCBoPXt9O2kuYWRkUGVuZGluZ0RhdGEoaCk7Y29uc3QgbD0oKT0+e2kucmVtb3ZlUGVuZGluZ0RhdGEoaCl9O2xlLlNob3dMb2FkaW5nU2NyZWVuJiYhdGhpcy5fU2hvd2luZ0xvYWRpbmdTY3JlZW4mJih0aGlzLl9TaG93aW5nTG9hZGluZ1NjcmVlbj0hMCxpLmdldEVuZ2luZSgpLmRpc3BsYXlMb2FkaW5nVUkoKSxpLmV4ZWN1dGVXaGVuUmVhZHkoKCk9PntpLmdldEVuZ2luZSgpLmhpZGVMb2FkaW5nVUkoKSx0aGlzLl9TaG93aW5nTG9hZGluZ1NjcmVlbj0hMX0pKTtjb25zdCB1PShfLEUpPT57Y29uc3QgbT1sZS5fRm9ybWF0RXJyb3JNZXNzYWdlKG8sXyxFKTtuP24oaSxtLG5ldyBOdChtLG9pLlNjZW5lTG9hZGVyRXJyb3IsRSkpOk8uRXJyb3IobSksbCgpfSxkPXI/Xz0+e3RyeXtyKF8pfWNhdGNoKEUpe3UoIkVycm9yIGluIG9uUHJvZ3Jlc3MgY2FsbGJhY2siLEUpfX06dm9pZCAwLGY9KCk9PntpZihzKXRyeXtzKGkpfWNhdGNoKF8pe3UoIkVycm9yIGluIG9uU3VjY2VzcyBjYWxsYmFjayIsXyl9aS5yZW1vdmVQZW5kaW5nRGF0YShoKX07cmV0dXJuIGxlLl9Mb2FkRGF0YShvLGksKF8sRSk9PntpZihfLmxvYWQpe2lmKCFfLmxvYWQoaSxFLG8ucm9vdFVybCx1KSlyZXR1cm47aS5sb2FkaW5nUGx1Z2luTmFtZT1fLm5hbWUsZigpfWVsc2UgXy5sb2FkQXN5bmMoaSxFLG8ucm9vdFVybCxkLG8ubmFtZSkudGhlbigoKT0+e2kubG9hZGluZ1BsdWdpbk5hbWU9Xy5uYW1lLGYoKX0pLmNhdGNoKHY9Pnt1KHYubWVzc2FnZSx2KX0pfSxkLHUsbCxhKX1zdGF0aWMgQXBwZW5kQXN5bmMoZSx0PSIiLGk9ZmUuTGFzdENyZWF0ZWRTY2VuZSxzPW51bGwscj1udWxsKXtyZXR1cm4gbmV3IFByb21pc2UoKG4sYSk9PntsZS5BcHBlbmQoZSx0LGksbz0+e24obyl9LHMsKG8saCxsKT0+e2EobHx8bmV3IEVycm9yKGgpKX0scil9KX1zdGF0aWMgTG9hZEFzc2V0Q29udGFpbmVyKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz1udWxsLHI9bnVsbCxuPW51bGwsYT1udWxsKXtpZighaSlyZXR1cm4gTy5FcnJvcigiTm8gc2NlbmUgYXZhaWxhYmxlIHRvIGxvYWQgYXNzZXQgY29udGFpbmVyIHRvIiksbnVsbDtjb25zdCBvPWxlLl9HZXRGaWxlSW5mbyhlLHQpO2lmKCFvKXJldHVybiBudWxsO2NvbnN0IGg9e307aS5hZGRQZW5kaW5nRGF0YShoKTtjb25zdCBsPSgpPT57aS5yZW1vdmVQZW5kaW5nRGF0YShoKX0sdT0oXyxFKT0+e2NvbnN0IG09bGUuX0Zvcm1hdEVycm9yTWVzc2FnZShvLF8sRSk7bj9uKGksbSxuZXcgTnQobSxvaS5TY2VuZUxvYWRlckVycm9yLEUpKTpPLkVycm9yKG0pLGwoKX0sZD1yP189Pnt0cnl7cihfKX1jYXRjaChFKXt1KCJFcnJvciBpbiBvblByb2dyZXNzIGNhbGxiYWNrIixFKX19OnZvaWQgMCxmPV89PntpZihzKXRyeXtzKF8pfWNhdGNoKEUpe3UoIkVycm9yIGluIG9uU3VjY2VzcyBjYWxsYmFjayIsRSl9aS5yZW1vdmVQZW5kaW5nRGF0YShoKX07cmV0dXJuIGxlLl9Mb2FkRGF0YShvLGksKF8sRSk9PntpZihfLmxvYWRBc3NldENvbnRhaW5lcil7Y29uc3Qgdj1fLmxvYWRBc3NldENvbnRhaW5lcihpLEUsby5yb290VXJsLHUpO2lmKCF2KXJldHVybjtpLmxvYWRpbmdQbHVnaW5OYW1lPV8ubmFtZSxmKHYpfWVsc2UgXy5sb2FkQXNzZXRDb250YWluZXJBc3luYz9fLmxvYWRBc3NldENvbnRhaW5lckFzeW5jKGksRSxvLnJvb3RVcmwsZCxvLm5hbWUpLnRoZW4odj0+e2kubG9hZGluZ1BsdWdpbk5hbWU9Xy5uYW1lLGYodil9KS5jYXRjaCh2PT57dSh2Lm1lc3NhZ2Usdil9KTp1KCJMb2FkQXNzZXRDb250YWluZXIgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIHBsdWdpbi4gUGx1Z2luIGRpZCBub3QgcHJvdmlkZSBhIGxvYWRBc3NldENvbnRhaW5lciBvciBsb2FkQXNzZXRDb250YWluZXJBc3luYyBtZXRob2QuIil9LGQsdSxsLGEpfXN0YXRpYyBMb2FkQXNzZXRDb250YWluZXJBc3luYyhlLHQ9IiIsaT1mZS5MYXN0Q3JlYXRlZFNjZW5lLHM9bnVsbCxyPW51bGwpe3JldHVybiBuZXcgUHJvbWlzZSgobixhKT0+e2xlLkxvYWRBc3NldENvbnRhaW5lcihlLHQsaSxvPT57bihvKX0scywobyxoLGwpPT57YShsfHxuZXcgRXJyb3IoaCkpfSxyKX0pfXN0YXRpYyBJbXBvcnRBbmltYXRpb25zKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz0hMCxyPXRpLkNsZWFuLG49bnVsbCxhPW51bGwsbz1udWxsLGg9bnVsbCxsPW51bGwpe2lmKCFpKXtPLkVycm9yKCJObyBzY2VuZSBhdmFpbGFibGUgdG8gbG9hZCBhbmltYXRpb25zIHRvIik7cmV0dXJufWlmKHMpe2Zvcihjb25zdCBfIG9mIGkuYW5pbWF0YWJsZXMpXy5yZXNldCgpO2kuc3RvcEFsbEFuaW1hdGlvbnMoKSxpLmFuaW1hdGlvbkdyb3Vwcy5zbGljZSgpLmZvckVhY2goXz0+e18uZGlzcG9zZSgpfSksaS5nZXROb2RlcygpLmZvckVhY2goXz0+e18uYW5pbWF0aW9ucyYmKF8uYW5pbWF0aW9ucz1bXSl9KX1lbHNlIHN3aXRjaChyKXtjYXNlIHRpLkNsZWFuOmkuYW5pbWF0aW9uR3JvdXBzLnNsaWNlKCkuZm9yRWFjaChmPT57Zi5kaXNwb3NlKCl9KTticmVhaztjYXNlIHRpLlN0b3A6aS5hbmltYXRpb25Hcm91cHMuZm9yRWFjaChmPT57Zi5zdG9wKCl9KTticmVhaztjYXNlIHRpLlN5bmM6aS5hbmltYXRpb25Hcm91cHMuZm9yRWFjaChmPT57Zi5yZXNldCgpLGYucmVzdGFydCgpfSk7YnJlYWs7Y2FzZSB0aS5Ob1N5bmM6YnJlYWs7ZGVmYXVsdDpPLkVycm9yKCJVbmtub3duIGFuaW1hdGlvbiBncm91cCBsb2FkaW5nIG1vZGUgdmFsdWUgJyIrcisiJyIpO3JldHVybn1jb25zdCB1PWkuYW5pbWF0YWJsZXMubGVuZ3RoLGQ9Zj0+e2YubWVyZ2VBbmltYXRpb25zVG8oaSxpLmFuaW1hdGFibGVzLnNsaWNlKHUpLG4pLGYuZGlzcG9zZSgpLGkub25BbmltYXRpb25GaWxlSW1wb3J0ZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhpKSxhJiZhKGkpfTt0aGlzLkxvYWRBc3NldENvbnRhaW5lcihlLHQsaSxkLG8saCxsKX1zdGF0aWMgSW1wb3J0QW5pbWF0aW9uc0FzeW5jKGUsdD0iIixpPWZlLkxhc3RDcmVhdGVkU2NlbmUscz0hMCxyPXRpLkNsZWFuLG49bnVsbCxhPW51bGwsbz1udWxsLGg9bnVsbCxsPW51bGwpe3JldHVybiBuZXcgUHJvbWlzZSgodSxkKT0+e2xlLkltcG9ydEFuaW1hdGlvbnMoZSx0LGkscyxyLG4sZj0+e3UoZil9LG8sKGYsXyxFKT0+e2QoRXx8bmV3IEVycm9yKF8pKX0sbCl9KX19bGUuTk9fTE9HR0lORz0wLGxlLk1JTklNQUxfTE9HR0lORz0xLGxlLlNVTU1BUllfTE9HR0lORz0yLGxlLkRFVEFJTEVEX0xPR0dJTkc9MyxsZS5PblBsdWdpbkFjdGl2YXRlZE9ic2VydmFibGU9bmV3IEYsbGUuX1JlZ2lzdGVyZWRQbHVnaW5zPXt9LGxlLl9TaG93aW5nTG9hZGluZ1NjcmVlbj0hMTtjbGFzcyBfZXtjb25zdHJ1Y3RvcihlLHQsaT1OdW1iZXIuTUFYX1ZBTFVFKXt0aGlzLm9yaWdpbj1lLHRoaXMuZGlyZWN0aW9uPXQsdGhpcy5sZW5ndGg9aX1jbG9uZSgpe3JldHVybiBuZXcgX2UodGhpcy5vcmlnaW4uY2xvbmUoKSx0aGlzLmRpcmVjdGlvbi5jbG9uZSgpLHRoaXMubGVuZ3RoKX1pbnRlcnNlY3RzQm94TWluTWF4KGUsdCxpPTApe2NvbnN0IHM9X2UuX1RtcFZlY3RvcjNbMF0uY29weUZyb21GbG9hdHMoZS54LWksZS55LWksZS56LWkpLHI9X2UuX1RtcFZlY3RvcjNbMV0uY29weUZyb21GbG9hdHModC54K2ksdC55K2ksdC56K2kpO2xldCBuPTAsYT1OdW1iZXIuTUFYX1ZBTFVFLG8saCxsLHU7aWYoTWF0aC5hYnModGhpcy5kaXJlY3Rpb24ueCk8MWUtNyl7aWYodGhpcy5vcmlnaW4ueDxzLnh8fHRoaXMub3JpZ2luLng+ci54KXJldHVybiExfWVsc2UgaWYobz0xL3RoaXMuZGlyZWN0aW9uLngsaD0ocy54LXRoaXMub3JpZ2luLngpKm8sbD0oci54LXRoaXMub3JpZ2luLngpKm8sbD09PS0xLzAmJihsPTEvMCksaD5sJiYodT1oLGg9bCxsPXUpLG49TWF0aC5tYXgoaCxuKSxhPU1hdGgubWluKGwsYSksbj5hKXJldHVybiExO2lmKE1hdGguYWJzKHRoaXMuZGlyZWN0aW9uLnkpPDFlLTcpe2lmKHRoaXMub3JpZ2luLnk8cy55fHx0aGlzLm9yaWdpbi55PnIueSlyZXR1cm4hMX1lbHNlIGlmKG89MS90aGlzLmRpcmVjdGlvbi55LGg9KHMueS10aGlzLm9yaWdpbi55KSpvLGw9KHIueS10aGlzLm9yaWdpbi55KSpvLGw9PT0tMS8wJiYobD0xLzApLGg+bCYmKHU9aCxoPWwsbD11KSxuPU1hdGgubWF4KGgsbiksYT1NYXRoLm1pbihsLGEpLG4+YSlyZXR1cm4hMTtpZihNYXRoLmFicyh0aGlzLmRpcmVjdGlvbi56KTwxZS03KXtpZih0aGlzLm9yaWdpbi56PHMuenx8dGhpcy5vcmlnaW4uej5yLnopcmV0dXJuITF9ZWxzZSBpZihvPTEvdGhpcy5kaXJlY3Rpb24ueixoPShzLnotdGhpcy5vcmlnaW4ueikqbyxsPShyLnotdGhpcy5vcmlnaW4ueikqbyxsPT09LTEvMCYmKGw9MS8wKSxoPmwmJih1PWgsaD1sLGw9dSksbj1NYXRoLm1heChoLG4pLGE9TWF0aC5taW4obCxhKSxuPmEpcmV0dXJuITE7cmV0dXJuITB9aW50ZXJzZWN0c0JveChlLHQ9MCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c0JveE1pbk1heChlLm1pbmltdW0sZS5tYXhpbXVtLHQpfWludGVyc2VjdHNTcGhlcmUoZSx0PTApe2NvbnN0IGk9ZS5jZW50ZXIueC10aGlzLm9yaWdpbi54LHM9ZS5jZW50ZXIueS10aGlzLm9yaWdpbi55LHI9ZS5jZW50ZXIuei10aGlzLm9yaWdpbi56LG49aSppK3MqcytyKnIsYT1lLnJhZGl1cyt0LG89YSphO2lmKG48PW8pcmV0dXJuITA7Y29uc3QgaD1pKnRoaXMuZGlyZWN0aW9uLngrcyp0aGlzLmRpcmVjdGlvbi55K3IqdGhpcy5kaXJlY3Rpb24uejtyZXR1cm4gaDwwPyExOm4taCpoPD1vfWludGVyc2VjdHNUcmlhbmdsZShlLHQsaSl7Y29uc3Qgcz1fZS5fVG1wVmVjdG9yM1swXSxyPV9lLl9UbXBWZWN0b3IzWzFdLG49X2UuX1RtcFZlY3RvcjNbMl0sYT1fZS5fVG1wVmVjdG9yM1szXSxvPV9lLl9UbXBWZWN0b3IzWzRdO3Quc3VidHJhY3RUb1JlZihlLHMpLGkuc3VidHJhY3RUb1JlZihlLHIpLHAuQ3Jvc3NUb1JlZih0aGlzLmRpcmVjdGlvbixyLG4pO2NvbnN0IGg9cC5Eb3QocyxuKTtpZihoPT09MClyZXR1cm4gbnVsbDtjb25zdCBsPTEvaDt0aGlzLm9yaWdpbi5zdWJ0cmFjdFRvUmVmKGUsYSk7Y29uc3QgdT1wLkRvdChhLG4pKmw7aWYodTwwfHx1PjEpcmV0dXJuIG51bGw7cC5Dcm9zc1RvUmVmKGEscyxvKTtjb25zdCBkPXAuRG90KHRoaXMuZGlyZWN0aW9uLG8pKmw7aWYoZDwwfHx1K2Q+MSlyZXR1cm4gbnVsbDtjb25zdCBmPXAuRG90KHIsbykqbDtyZXR1cm4gZj50aGlzLmxlbmd0aD9udWxsOm5ldyBEcygxLXUtZCx1LGYpfWludGVyc2VjdHNQbGFuZShlKXtsZXQgdDtjb25zdCBpPXAuRG90KGUubm9ybWFsLHRoaXMuZGlyZWN0aW9uKTtpZihNYXRoLmFicyhpKTw5OTk5OTk5OTc0NzUyNDNlLTIxKXJldHVybiBudWxsO3tjb25zdCBzPXAuRG90KGUubm9ybWFsLHRoaXMub3JpZ2luKTtyZXR1cm4gdD0oLWUuZC1zKS9pLHQ8MD90PC05OTk5OTk5OTc0NzUyNDNlLTIxP251bGw6MDp0fX1pbnRlcnNlY3RzQXhpcyhlLHQ9MCl7c3dpdGNoKGUpe2Nhc2UieSI6e2NvbnN0IGk9KHRoaXMub3JpZ2luLnktdCkvdGhpcy5kaXJlY3Rpb24ueTtyZXR1cm4gaT4wP251bGw6bmV3IHAodGhpcy5vcmlnaW4ueCt0aGlzLmRpcmVjdGlvbi54Ki1pLHQsdGhpcy5vcmlnaW4ueit0aGlzLmRpcmVjdGlvbi56Ki1pKX1jYXNlIngiOntjb25zdCBpPSh0aGlzLm9yaWdpbi54LXQpL3RoaXMuZGlyZWN0aW9uLng7cmV0dXJuIGk+MD9udWxsOm5ldyBwKHQsdGhpcy5vcmlnaW4ueSt0aGlzLmRpcmVjdGlvbi55Ki1pLHRoaXMub3JpZ2luLnordGhpcy5kaXJlY3Rpb24ueiotaSl9Y2FzZSJ6Ijp7Y29uc3QgaT0odGhpcy5vcmlnaW4uei10KS90aGlzLmRpcmVjdGlvbi56O3JldHVybiBpPjA/bnVsbDpuZXcgcCh0aGlzLm9yaWdpbi54K3RoaXMuZGlyZWN0aW9uLngqLWksdGhpcy5vcmlnaW4ueSt0aGlzLmRpcmVjdGlvbi55Ki1pLHQpfWRlZmF1bHQ6cmV0dXJuIG51bGx9fWludGVyc2VjdHNNZXNoKGUsdCl7Y29uc3QgaT1ELk1hdHJpeFswXTtyZXR1cm4gZS5nZXRXb3JsZE1hdHJpeCgpLmludmVydFRvUmVmKGkpLHRoaXMuX3RtcFJheT9fZS5UcmFuc2Zvcm1Ub1JlZih0aGlzLGksdGhpcy5fdG1wUmF5KTp0aGlzLl90bXBSYXk9X2UuVHJhbnNmb3JtKHRoaXMsaSksZS5pbnRlcnNlY3RzKHRoaXMuX3RtcFJheSx0KX1pbnRlcnNlY3RzTWVzaGVzKGUsdCxpKXtpP2kubGVuZ3RoPTA6aT1bXTtmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKyl7Y29uc3Qgcj10aGlzLmludGVyc2VjdHNNZXNoKGVbc10sdCk7ci5oaXQmJmkucHVzaChyKX1yZXR1cm4gaS5zb3J0KHRoaXMuX2NvbXBhcmVQaWNraW5nSW5mbyksaX1fY29tcGFyZVBpY2tpbmdJbmZvKGUsdCl7cmV0dXJuIGUuZGlzdGFuY2U8dC5kaXN0YW5jZT8tMTplLmRpc3RhbmNlPnQuZGlzdGFuY2U/MTowfWludGVyc2VjdGlvblNlZ21lbnQoZSx0LGkpe2NvbnN0IHM9dGhpcy5vcmlnaW4scj1ELlZlY3RvcjNbMF0sbj1ELlZlY3RvcjNbMV0sYT1ELlZlY3RvcjNbMl0sbz1ELlZlY3RvcjNbM107dC5zdWJ0cmFjdFRvUmVmKGUsciksdGhpcy5kaXJlY3Rpb24uc2NhbGVUb1JlZihfZS5fUmF5bCxhKSxzLmFkZFRvUmVmKGEsbiksZS5zdWJ0cmFjdFRvUmVmKHMsbyk7Y29uc3QgaD1wLkRvdChyLHIpLGw9cC5Eb3QocixhKSx1PXAuRG90KGEsYSksZD1wLkRvdChyLG8pLGY9cC5Eb3QoYSxvKSxfPWgqdS1sKmw7bGV0IEUsbT1fLHYsUz1fO188X2UuX1NtYWxsbnVtPyhFPTAsbT0xLHY9ZixTPXUpOihFPWwqZi11KmQsdj1oKmYtbCpkLEU8MD8oRT0wLHY9ZixTPXUpOkU+bSYmKEU9bSx2PWYrbCxTPXUpKSx2PDA/KHY9MCwtZDwwP0U9MDotZD5oP0U9bTooRT0tZCxtPWgpKTp2PlMmJih2PVMsLWQrbDwwP0U9MDotZCtsPmg/RT1tOihFPS1kK2wsbT1oKSk7Y29uc3QgeT1NYXRoLmFicyhFKTxfZS5fU21hbGxudW0/MDpFL20sQT1NYXRoLmFicyh2KTxfZS5fU21hbGxudW0/MDp2L1MsQz1ELlZlY3RvcjNbNF07YS5zY2FsZVRvUmVmKEEsQyk7Y29uc3QgYj1ELlZlY3RvcjNbNV07ci5zY2FsZVRvUmVmKHksYiksYi5hZGRJblBsYWNlKG8pO2NvbnN0IE09RC5WZWN0b3IzWzZdO3JldHVybiBiLnN1YnRyYWN0VG9SZWYoQyxNKSxBPjAmJkE8PXRoaXMubGVuZ3RoJiZNLmxlbmd0aFNxdWFyZWQoKTxpKmk/Yi5sZW5ndGgoKTotMX11cGRhdGUoZSx0LGkscyxyLG4sYSxvPSExKXtpZihvKXtfZS5fUmF5RGlzdGFudHx8KF9lLl9SYXlEaXN0YW50PV9lLlplcm8oKSksX2UuX1JheURpc3RhbnQudW5wcm9qZWN0UmF5VG9SZWYoZSx0LGkscyx4LklkZW50aXR5UmVhZE9ubHksbixhKTtjb25zdCBoPUQuTWF0cml4WzBdO3IuaW52ZXJ0VG9SZWYoaCksX2UuVHJhbnNmb3JtVG9SZWYoX2UuX1JheURpc3RhbnQsaCx0aGlzKX1lbHNlIHRoaXMudW5wcm9qZWN0UmF5VG9SZWYoZSx0LGkscyxyLG4sYSk7cmV0dXJuIHRoaXN9c3RhdGljIFplcm8oKXtyZXR1cm4gbmV3IF9lKHAuWmVybygpLHAuWmVybygpKX1zdGF0aWMgQ3JlYXRlTmV3KGUsdCxpLHMscixuLGEpe3JldHVybiBfZS5aZXJvKCkudXBkYXRlKGUsdCxpLHMscixuLGEpfXN0YXRpYyBDcmVhdGVOZXdGcm9tVG8oZSx0LGk9eC5JZGVudGl0eVJlYWRPbmx5KXtjb25zdCBzPXQuc3VidHJhY3QoZSkscj1NYXRoLnNxcnQocy54KnMueCtzLnkqcy55K3MueipzLnopO3JldHVybiBzLm5vcm1hbGl6ZSgpLF9lLlRyYW5zZm9ybShuZXcgX2UoZSxzLHIpLGkpfXN0YXRpYyBUcmFuc2Zvcm0oZSx0KXtjb25zdCBpPW5ldyBfZShuZXcgcCgwLDAsMCksbmV3IHAoMCwwLDApKTtyZXR1cm4gX2UuVHJhbnNmb3JtVG9SZWYoZSx0LGkpLGl9c3RhdGljIFRyYW5zZm9ybVRvUmVmKGUsdCxpKXtwLlRyYW5zZm9ybUNvb3JkaW5hdGVzVG9SZWYoZS5vcmlnaW4sdCxpLm9yaWdpbikscC5UcmFuc2Zvcm1Ob3JtYWxUb1JlZihlLmRpcmVjdGlvbix0LGkuZGlyZWN0aW9uKSxpLmxlbmd0aD1lLmxlbmd0aDtjb25zdCBzPWkuZGlyZWN0aW9uLHI9cy5sZW5ndGgoKTtpZighKHI9PT0wfHxyPT09MSkpe2NvbnN0IG49MS9yO3MueCo9bixzLnkqPW4scy56Kj1uLGkubGVuZ3RoKj1yfX11bnByb2plY3RSYXlUb1JlZihlLHQsaSxzLHIsbixhKXt2YXIgbztjb25zdCBoPUQuTWF0cml4WzBdO3IubXVsdGlwbHlUb1JlZihuLGgpLGgubXVsdGlwbHlUb1JlZihhLGgpLGguaW52ZXJ0KCk7Y29uc3QgbD1ELlZlY3RvcjNbMF07bC54PWUvaSoyLTEsbC55PS0odC9zKjItMSksbC56PSEoKG89ZmUuTGFzdENyZWF0ZWRFbmdpbmUpPT09bnVsbHx8bz09PXZvaWQgMCkmJm8uaXNORENIYWxmWlJhbmdlPzA6LTE7Y29uc3QgdT1ELlZlY3RvcjNbMV0uY29weUZyb21GbG9hdHMobC54LGwueSwxLTFlLTgpLGQ9RC5WZWN0b3IzWzJdLGY9RC5WZWN0b3IzWzNdO3AuX1VucHJvamVjdEZyb21JbnZlcnRlZE1hdHJpeFRvUmVmKGwsaCxkKSxwLl9VbnByb2plY3RGcm9tSW52ZXJ0ZWRNYXRyaXhUb1JlZih1LGgsZiksdGhpcy5vcmlnaW4uY29weUZyb20oZCksZi5zdWJ0cmFjdFRvUmVmKGQsdGhpcy5kaXJlY3Rpb24pLHRoaXMuZGlyZWN0aW9uLm5vcm1hbGl6ZSgpfX1fZS5fVG1wVmVjdG9yMz1CZS5CdWlsZEFycmF5KDYscC5aZXJvKSxfZS5fUmF5RGlzdGFudD1fZS5aZXJvKCksX2UuX1NtYWxsbnVtPTFlLTgsX2UuX1JheWw9MWU5LG5lLnByb3RvdHlwZS5jcmVhdGVQaWNraW5nUmF5PWZ1bmN0aW9uKGMsZSx0LGkscz0hMSl7Y29uc3Qgcj1fZS5aZXJvKCk7cmV0dXJuIHRoaXMuY3JlYXRlUGlja2luZ1JheVRvUmVmKGMsZSx0LHIsaSxzKSxyfSxuZS5wcm90b3R5cGUuY3JlYXRlUGlja2luZ1JheVRvUmVmPWZ1bmN0aW9uKGMsZSx0LGkscyxyPSExLG49ITEpe2NvbnN0IGE9dGhpcy5nZXRFbmdpbmUoKTtpZighcyl7aWYoIXRoaXMuYWN0aXZlQ2FtZXJhKXJldHVybiB0aGlzO3M9dGhpcy5hY3RpdmVDYW1lcmF9Y29uc3QgaD1zLnZpZXdwb3J0LnRvR2xvYmFsKGEuZ2V0UmVuZGVyV2lkdGgoKSxhLmdldFJlbmRlckhlaWdodCgpKTtyZXR1cm4gYz1jL2EuZ2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKS1oLngsZT1lL2EuZ2V0SGFyZHdhcmVTY2FsaW5nTGV2ZWwoKS0oYS5nZXRSZW5kZXJIZWlnaHQoKS1oLnktaC5oZWlnaHQpLGkudXBkYXRlKGMsZSxoLndpZHRoLGguaGVpZ2h0LHR8fHguSWRlbnRpdHlSZWFkT25seSxyP3guSWRlbnRpdHlSZWFkT25seTpzLmdldFZpZXdNYXRyaXgoKSxzLmdldFByb2plY3Rpb25NYXRyaXgoKSxuKSx0aGlzfSxuZS5wcm90b3R5cGUuY3JlYXRlUGlja2luZ1JheUluQ2FtZXJhU3BhY2U9ZnVuY3Rpb24oYyxlLHQpe2NvbnN0IGk9X2UuWmVybygpO3JldHVybiB0aGlzLmNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlVG9SZWYoYyxlLGksdCksaX0sbmUucHJvdG90eXBlLmNyZWF0ZVBpY2tpbmdSYXlJbkNhbWVyYVNwYWNlVG9SZWY9ZnVuY3Rpb24oYyxlLHQsaSl7aWYoIVV0KXJldHVybiB0aGlzO2NvbnN0IHM9dGhpcy5nZXRFbmdpbmUoKTtpZighaSl7aWYoIXRoaXMuYWN0aXZlQ2FtZXJhKXRocm93IG5ldyBFcnJvcigiQWN0aXZlIGNhbWVyYSBub3Qgc2V0Iik7aT10aGlzLmFjdGl2ZUNhbWVyYX1jb25zdCBuPWkudmlld3BvcnQudG9HbG9iYWwocy5nZXRSZW5kZXJXaWR0aCgpLHMuZ2V0UmVuZGVySGVpZ2h0KCkpLGE9eC5JZGVudGl0eSgpO3JldHVybiBjPWMvcy5nZXRIYXJkd2FyZVNjYWxpbmdMZXZlbCgpLW4ueCxlPWUvcy5nZXRIYXJkd2FyZVNjYWxpbmdMZXZlbCgpLShzLmdldFJlbmRlckhlaWdodCgpLW4ueS1uLmhlaWdodCksdC51cGRhdGUoYyxlLG4ud2lkdGgsbi5oZWlnaHQsYSxhLGkuZ2V0UHJvamVjdGlvbk1hdHJpeCgpKSx0aGlzfSxuZS5wcm90b3R5cGUuX2ludGVybmFsUGlja0Zvck1lc2g9ZnVuY3Rpb24oYyxlLHQsaSxzLHIsbixhKXtjb25zdCBvPWUoaSx0LmVuYWJsZURpc3RhbnRQaWNraW5nKSxoPXQuaW50ZXJzZWN0cyhvLHMsbixyLGksYSk7cmV0dXJuIWh8fCFoLmhpdHx8IXMmJmMhPW51bGwmJmguZGlzdGFuY2U+PWMuZGlzdGFuY2U/bnVsbDpofSxuZS5wcm90b3R5cGUuX2ludGVybmFsUGljaz1mdW5jdGlvbihjLGUsdCxpLHMpe2xldCByPW51bGw7Zm9yKGxldCBuPTA7bjx0aGlzLm1lc2hlcy5sZW5ndGg7bisrKXtjb25zdCBhPXRoaXMubWVzaGVzW25dO2lmKGUpe2lmKCFlKGEpKWNvbnRpbnVlfWVsc2UgaWYoIWEuaXNFbmFibGVkKCl8fCFhLmlzVmlzaWJsZXx8IWEuaXNQaWNrYWJsZSljb250aW51ZTtjb25zdCBvPWEuZ2V0V29ybGRNYXRyaXgoKTtpZihhLmhhc1RoaW5JbnN0YW5jZXMmJmEudGhpbkluc3RhbmNlRW5hYmxlUGlja2luZyl7Y29uc3QgaD10aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKHIsYyxhLG8sITAsITAscyk7aWYoaCl7aWYoaSlyZXR1cm4gaDtjb25zdCBsPUQuTWF0cml4WzFdLHU9YS50aGluSW5zdGFuY2VHZXRXb3JsZE1hdHJpY2VzKCk7Zm9yKGxldCBkPTA7ZDx1Lmxlbmd0aDtkKyspe3VbZF0ubXVsdGlwbHlUb1JlZihvLGwpO2NvbnN0IF89dGhpcy5faW50ZXJuYWxQaWNrRm9yTWVzaChyLGMsYSxsLHQsaSxzLCEwKTtpZihfJiYocj1fLHIudGhpbkluc3RhbmNlSW5kZXg9ZCx0KSlyZXR1cm4gcn19fWVsc2V7Y29uc3QgaD10aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKHIsYyxhLG8sdCxpLHMpO2lmKGgmJihyPWgsdCkpcmV0dXJuIHJ9fXJldHVybiByfHxuZXcgVXR9LG5lLnByb3RvdHlwZS5faW50ZXJuYWxNdWx0aVBpY2s9ZnVuY3Rpb24oYyxlLHQpe2lmKCFVdClyZXR1cm4gbnVsbDtjb25zdCBpPW5ldyBBcnJheTtmb3IobGV0IHM9MDtzPHRoaXMubWVzaGVzLmxlbmd0aDtzKyspe2NvbnN0IHI9dGhpcy5tZXNoZXNbc107aWYoZSl7aWYoIWUocikpY29udGludWV9ZWxzZSBpZighci5pc0VuYWJsZWQoKXx8IXIuaXNWaXNpYmxlfHwhci5pc1BpY2thYmxlKWNvbnRpbnVlO2NvbnN0IG49ci5nZXRXb3JsZE1hdHJpeCgpO2lmKHIuaGFzVGhpbkluc3RhbmNlcyYmci50aGluSW5zdGFuY2VFbmFibGVQaWNraW5nKXtpZih0aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKG51bGwsYyxyLG4sITAsITAsdCkpe2NvbnN0IG89RC5NYXRyaXhbMV0saD1yLnRoaW5JbnN0YW5jZUdldFdvcmxkTWF0cmljZXMoKTtmb3IobGV0IGw9MDtsPGgubGVuZ3RoO2wrKyl7aFtsXS5tdWx0aXBseVRvUmVmKG4sbyk7Y29uc3QgZD10aGlzLl9pbnRlcm5hbFBpY2tGb3JNZXNoKG51bGwsYyxyLG8sITEsITEsdCwhMCk7ZCYmKGQudGhpbkluc3RhbmNlSW5kZXg9bCxpLnB1c2goZCkpfX19ZWxzZXtjb25zdCBhPXRoaXMuX2ludGVybmFsUGlja0Zvck1lc2gobnVsbCxjLHIsbiwhMSwhMSx0KTthJiZpLnB1c2goYSl9fXJldHVybiBpfSxuZS5wcm90b3R5cGUucGlja1dpdGhCb3VuZGluZ0luZm89ZnVuY3Rpb24oYyxlLHQsaSxzKXtpZighVXQpcmV0dXJuIG51bGw7Y29uc3Qgcj10aGlzLl9pbnRlcm5hbFBpY2sobj0+KHRoaXMuX3RlbXBQaWNraW5nUmF5fHwodGhpcy5fdGVtcFBpY2tpbmdSYXk9X2UuWmVybygpKSx0aGlzLmNyZWF0ZVBpY2tpbmdSYXlUb1JlZihjLGUsbix0aGlzLl90ZW1wUGlja2luZ1JheSxzfHxudWxsKSx0aGlzLl90ZW1wUGlja2luZ1JheSksdCxpLCEwKTtyZXR1cm4gciYmKHIucmF5PXRoaXMuY3JlYXRlUGlja2luZ1JheShjLGUseC5JZGVudGl0eSgpLHN8fG51bGwpKSxyfSxPYmplY3QuZGVmaW5lUHJvcGVydHkobmUucHJvdG90eXBlLCJfcGlja2luZ0F2YWlsYWJsZSIse2dldDooKT0+ITAsZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITF9KSxuZS5wcm90b3R5cGUucGljaz1mdW5jdGlvbihjLGUsdCxpLHMscixuPSExKXtjb25zdCBhPXRoaXMuX2ludGVybmFsUGljaygobyxoKT0+KHRoaXMuX3RlbXBQaWNraW5nUmF5fHwodGhpcy5fdGVtcFBpY2tpbmdSYXk9X2UuWmVybygpKSx0aGlzLmNyZWF0ZVBpY2tpbmdSYXlUb1JlZihjLGUsbyx0aGlzLl90ZW1wUGlja2luZ1JheSxzfHxudWxsLCExLGgpLHRoaXMuX3RlbXBQaWNraW5nUmF5KSx0LGksITEscik7cmV0dXJuIGEmJihhLnJheT10aGlzLmNyZWF0ZVBpY2tpbmdSYXkoYyxlLHguSWRlbnRpdHkoKSxzfHxudWxsKSksYX0sbmUucHJvdG90eXBlLnBpY2tXaXRoUmF5PWZ1bmN0aW9uKGMsZSx0LGkpe2NvbnN0IHM9dGhpcy5faW50ZXJuYWxQaWNrKHI9Pih0aGlzLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXh8fCh0aGlzLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXg9eC5JZGVudGl0eSgpKSxyLmludmVydFRvUmVmKHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeCksdGhpcy5fY2FjaGVkUmF5Rm9yVHJhbnNmb3JtfHwodGhpcy5fY2FjaGVkUmF5Rm9yVHJhbnNmb3JtPV9lLlplcm8oKSksX2UuVHJhbnNmb3JtVG9SZWYoYyx0aGlzLl9waWNrV2l0aFJheUludmVyc2VNYXRyaXgsdGhpcy5fY2FjaGVkUmF5Rm9yVHJhbnNmb3JtKSx0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm0pLGUsdCwhMSxpKTtyZXR1cm4gcyYmKHMucmF5PWMpLHN9LG5lLnByb3RvdHlwZS5tdWx0aVBpY2s9ZnVuY3Rpb24oYyxlLHQsaSxzKXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNdWx0aVBpY2socj0+dGhpcy5jcmVhdGVQaWNraW5nUmF5KGMsZSxyLGl8fG51bGwpLHQscyl9LG5lLnByb3RvdHlwZS5tdWx0aVBpY2tXaXRoUmF5PWZ1bmN0aW9uKGMsZSx0KXtyZXR1cm4gdGhpcy5faW50ZXJuYWxNdWx0aVBpY2soaT0+KHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeHx8KHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeD14LklkZW50aXR5KCkpLGkuaW52ZXJ0VG9SZWYodGhpcy5fcGlja1dpdGhSYXlJbnZlcnNlTWF0cml4KSx0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm18fCh0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm09X2UuWmVybygpKSxfZS5UcmFuc2Zvcm1Ub1JlZihjLHRoaXMuX3BpY2tXaXRoUmF5SW52ZXJzZU1hdHJpeCx0aGlzLl9jYWNoZWRSYXlGb3JUcmFuc2Zvcm0pLHRoaXMuX2NhY2hlZFJheUZvclRyYW5zZm9ybSksZSx0KX0sai5wcm90b3R5cGUuZ2V0Rm9yd2FyZFJheT1mdW5jdGlvbihjPTEwMCxlLHQpe3JldHVybiB0aGlzLmdldEZvcndhcmRSYXlUb1JlZihuZXcgX2UocC5aZXJvKCkscC5aZXJvKCksYyksYyxlLHQpfSxqLnByb3RvdHlwZS5nZXRGb3J3YXJkUmF5VG9SZWY9ZnVuY3Rpb24oYyxlPTEwMCx0LGkpe3JldHVybiB0fHwodD10aGlzLmdldFdvcmxkTWF0cml4KCkpLGMubGVuZ3RoPWUsaT9jLm9yaWdpbi5jb3B5RnJvbShpKTpjLm9yaWdpbi5jb3B5RnJvbSh0aGlzLnBvc2l0aW9uKSxELlZlY3RvcjNbMl0uc2V0KDAsMCx0aGlzLl9zY2VuZS51c2VSaWdodEhhbmRlZFN5c3RlbT8tMToxKSxwLlRyYW5zZm9ybU5vcm1hbFRvUmVmKEQuVmVjdG9yM1syXSx0LEQuVmVjdG9yM1szXSkscC5Ob3JtYWxpemVUb1JlZihELlZlY3RvcjNbM10sYy5kaXJlY3Rpb24pLGN9O3ZhciB5bD1mdW5jdGlvbihjLGUsdCl7Zm9yKHZhciBpIGluIGUpaWYoYy5uYW1lPT09ZVtpXSlyZXR1cm4gdC5wdXNoKGMuaWQpLCEwO3JldHVybiBjLnBhcmVudElkJiZ0LmluZGV4T2YoYy5wYXJlbnRJZCkhPT0tMT8odC5wdXNoKGMuaWQpLCEwKTohMX0sbHM9ZnVuY3Rpb24oYyxlKXtyZXR1cm4gYysiIG9mICIrKGU/ZS5maWxlKyIgZnJvbSAiK2UubmFtZSsiIHZlcnNpb246ICIrZS52ZXJzaW9uKyIsIGV4cG9ydGVyIHZlcnNpb246ICIrZS5leHBvcnRlcl92ZXJzaW9uOiJ1bmtub3duIil9O2xlLlJlZ2lzdGVyUGx1Z2luKHtuYW1lOiJiYWJ5bG9uLmpzIixleHRlbnNpb25zOiIuanNvbiIsY2FuRGlyZWN0TG9hZDpmdW5jdGlvbihjKXtyZXR1cm4gYy5pbmRleE9mKCJqc29uIikhPT0tMSwhMH0saW1wb3J0TWVzaDpmdW5jdGlvbihjLGUsdCxpLHMscixuLGEpe3ZhciBvPSJpbXBvcnRNZXNoIGhhcyBmYWlsZWQgSlNPTiBwYXJzZSI7dHJ5e3ZhciBoPUpTT04ucGFyc2UodCk7aC5waHlzaWNzRW5hYmxlZD0hMSxoPT1udWxsfHxoLm1lc2hlcy5tYXAoUz0+ZGVsZXRlIFMucGh5c2ljc0ltcG9zdG9yKSxvPSIiO3ZhciBsPWxlLmxvZ2dpbmdMZXZlbD09PWxlLkRFVEFJTEVEX0xPR0dJTkc7Yz9BcnJheS5pc0FycmF5KGMpfHwoYz1bY10pOmM9bnVsbDt2YXIgdT1uZXcgQXJyYXk7aWYoaC5tZXNoZXMhPT12b2lkIDAmJmgubWVzaGVzIT09bnVsbCl7dmFyIGQsZjtmb3IoZD0wLGY9aC5tZXNoZXMubGVuZ3RoO2Q8ZjtkKyspe3ZhciBfPWgubWVzaGVzW2RdO2lmKGM9PT1udWxsfHx5bChfLGMsdSkpe2MhPT1udWxsJiZkZWxldGUgY1tjLmluZGV4T2YoXy5uYW1lKV07dmFyIEU9Vy5QYXJzZShfLGUsaSk7cy5wdXNoKEUpLG8rPWAKCU1lc2ggYCtFLnRvU3RyaW5nKGwpfX12YXIgbTtmb3IoZD0wLGY9ZS5tZXNoZXMubGVuZ3RoO2Q8ZjtkKyspbT1lLm1lc2hlc1tkXSxtLl93YWl0aW5nUGFyZW50SWQmJihtLnBhcmVudD1lLmdldExhc3RFbnRyeUJ5SUQobS5fd2FpdGluZ1BhcmVudElkKSxtLl93YWl0aW5nUGFyZW50SWQ9bnVsbCksbS5jb21wdXRlV29ybGRNYXRyaXgoITApfXJldHVybiEwfWNhdGNoKFMpe3ZhciB2PWxzKCJpbXBvcnRNZXNoIixoP2gucHJvZHVjZXI6IlVua25vd24iKStvO2lmKGEpYSh2LFMpO2Vsc2UgdGhyb3cgTy5Mb2codiksU31maW5hbGx5e28hPT1udWxsJiZsZS5sb2dnaW5nTGV2ZWwhPT1sZS5OT19MT0dHSU5HJiZPLkxvZyhscygiaW1wb3J0TWVzaCIsaD9oLnByb2R1Y2VyOiJVbmtub3duIikrKGxlLmxvZ2dpbmdMZXZlbCE9PWxlLk1JTklNQUxfTE9HR0lORz9vOiIiKSl9cmV0dXJuITF9LGxvYWQ6ZnVuY3Rpb24oYyxlLHQsaSl7dmFyIHM9ImltcG9ydFNjZW5lIGhhcyBmYWlsZWQgSlNPTiBwYXJzZSI7dHJ5e3ZhciByPUpTT04ucGFyc2UoZSk7cz0iIixyLmNsZWFyQ29sb3IhPT12b2lkIDAmJnIuY2xlYXJDb2xvciE9PW51bGwmJihjLmNsZWFyQ29sb3I9Q29sb3I0LkZyb21BcnJheShyLmNsZWFyQ29sb3IpKTt2YXIgbj1sb2FkQXNzZXRDb250YWluZXIoYyxlLHQsaSwhMCk7cmV0dXJuISFufWNhdGNoKG8pe3ZhciBhPWxzKCJpbXBvcnRTY2VuZSIscj9yLnByb2R1Y2VyOiJVbmtub3duIikrcztpZihpKWkoYSxvKTtlbHNlIHRocm93IE8uTG9nKGEpLG99ZmluYWxseXtzIT09bnVsbCYmbGUubG9nZ2luZ0xldmVsIT09bGUuTk9fTE9HR0lORyYmTy5Mb2cobHMoImltcG9ydFNjZW5lIixyP3IucHJvZHVjZXI6IlVua25vd24iKSsobGUubG9nZ2luZ0xldmVsIT09bGUuTUlOSU1BTF9MT0dHSU5HP3M6IiIpKX1yZXR1cm4hMX0sbG9hZEFzc2V0Q29udGFpbmVyOmZ1bmN0aW9uKGMsZSx0LGkpe3ZhciBzPWxvYWRBc3NldENvbnRhaW5lcihjLGUsdCxpKTtyZXR1cm4gc319KSxXLl9pbnN0YW5jZWRNZXNoRmFjdG9yeT0oYyxlKT0+e2NvbnN0IHQ9bmV3IENsKGMsZSk7aWYoZS5pbnN0YW5jZWRCdWZmZXJzKXt0Lmluc3RhbmNlZEJ1ZmZlcnM9e307Zm9yKGNvbnN0IGkgaW4gZS5pbnN0YW5jZWRCdWZmZXJzKXQuaW5zdGFuY2VkQnVmZmVyc1tpXT1lLmluc3RhbmNlZEJ1ZmZlcnNbaV19cmV0dXJuIHR9O2NsYXNzIENsIGV4dGVuZHMgb3R7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQuZ2V0U2NlbmUoKSksdGhpcy5faW5kZXhJblNvdXJjZU1lc2hJbnN0YW5jZUFycmF5PS0xLHRoaXMuX2Rpc3RhbmNlVG9DYW1lcmE9MCx0LmFkZEluc3RhbmNlKHRoaXMpLHRoaXMuX3NvdXJjZU1lc2g9dCx0aGlzLl91bkluZGV4ZWQ9dC5fdW5JbmRleGVkLHRoaXMucG9zaXRpb24uY29weUZyb20odC5wb3NpdGlvbiksdGhpcy5yb3RhdGlvbi5jb3B5RnJvbSh0LnJvdGF0aW9uKSx0aGlzLnNjYWxpbmcuY29weUZyb20odC5zY2FsaW5nKSx0LnJvdGF0aW9uUXVhdGVybmlvbiYmKHRoaXMucm90YXRpb25RdWF0ZXJuaW9uPXQucm90YXRpb25RdWF0ZXJuaW9uLmNsb25lKCkpLHRoaXMuYW5pbWF0aW9ucz10LmFuaW1hdGlvbnMuc2xpY2UoKTtmb3IoY29uc3QgaSBvZiB0LmdldEFuaW1hdGlvblJhbmdlcygpKWkhPW51bGwmJnRoaXMuY3JlYXRlQW5pbWF0aW9uUmFuZ2UoaS5uYW1lLGkuZnJvbSxpLnRvKTt0aGlzLmluZmluaXRlRGlzdGFuY2U9dC5pbmZpbml0ZURpc3RhbmNlLHRoaXMuc2V0UGl2b3RNYXRyaXgodC5nZXRQaXZvdE1hdHJpeCgpKSx0aGlzLnJlZnJlc2hCb3VuZGluZ0luZm8oITAsITApLHRoaXMuX3N5bmNTdWJNZXNoZXMoKX1nZXRDbGFzc05hbWUoKXtyZXR1cm4iSW5zdGFuY2VkTWVzaCJ9Z2V0IGxpZ2h0U291cmNlcygpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLl9saWdodFNvdXJjZXN9X3Jlc3luY0xpZ2h0U291cmNlcygpe31fcmVzeW5jTGlnaHRTb3VyY2UoKXt9X3JlbW92ZUxpZ2h0U291cmNlKCl7fWdldCByZWNlaXZlU2hhZG93cygpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLnJlY2VpdmVTaGFkb3dzfWdldCBtYXRlcmlhbCgpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLm1hdGVyaWFsfWdldCB2aXNpYmlsaXR5KCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2gudmlzaWJpbGl0eX1nZXQgc2tlbGV0b24oKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5za2VsZXRvbn1nZXQgcmVuZGVyaW5nR3JvdXBJZCgpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLnJlbmRlcmluZ0dyb3VwSWR9c2V0IHJlbmRlcmluZ0dyb3VwSWQoZSl7IXRoaXMuX3NvdXJjZU1lc2h8fGU9PT10aGlzLl9zb3VyY2VNZXNoLnJlbmRlcmluZ0dyb3VwSWR8fE8uV2FybigiTm90ZSAtIHNldHRpbmcgcmVuZGVyaW5nR3JvdXBJZCBvZiBhbiBpbnN0YW5jZWQgbWVzaCBoYXMgbm8gZWZmZWN0IG9uIHRoZSBzY2VuZSIpfWdldFRvdGFsVmVydGljZXMoKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaD90aGlzLl9zb3VyY2VNZXNoLmdldFRvdGFsVmVydGljZXMoKTowfWdldFRvdGFsSW5kaWNlcygpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLmdldFRvdGFsSW5kaWNlcygpfWdldCBzb3VyY2VNZXNoKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2h9Y3JlYXRlSW5zdGFuY2UoZSl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guY3JlYXRlSW5zdGFuY2UoZSl9aXNSZWFkeShlPSExKXtyZXR1cm4gdGhpcy5fc291cmNlTWVzaC5pc1JlYWR5KGUsITApfWdldFZlcnRpY2VzRGF0YShlLHQpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLmdldFZlcnRpY2VzRGF0YShlLHQpfXNldFZlcnRpY2VzRGF0YShlLHQsaSxzKXtyZXR1cm4gdGhpcy5zb3VyY2VNZXNoJiZ0aGlzLnNvdXJjZU1lc2guc2V0VmVydGljZXNEYXRhKGUsdCxpLHMpLHRoaXMuc291cmNlTWVzaH11cGRhdGVWZXJ0aWNlc0RhdGEoZSx0LGkscyl7cmV0dXJuIHRoaXMuc291cmNlTWVzaCYmdGhpcy5zb3VyY2VNZXNoLnVwZGF0ZVZlcnRpY2VzRGF0YShlLHQsaSxzKSx0aGlzLnNvdXJjZU1lc2h9c2V0SW5kaWNlcyhlLHQ9bnVsbCl7cmV0dXJuIHRoaXMuc291cmNlTWVzaCYmdGhpcy5zb3VyY2VNZXNoLnNldEluZGljZXMoZSx0KSx0aGlzLnNvdXJjZU1lc2h9aXNWZXJ0aWNlc0RhdGFQcmVzZW50KGUpe3JldHVybiB0aGlzLl9zb3VyY2VNZXNoLmlzVmVydGljZXNEYXRhUHJlc2VudChlKX1nZXRJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guZ2V0SW5kaWNlcygpfWdldCBfcG9zaXRpb25zKCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guX3Bvc2l0aW9uc31yZWZyZXNoQm91bmRpbmdJbmZvKGU9ITEsdD0hMSl7aWYodGhpcy5oYXNCb3VuZGluZ0luZm8mJnRoaXMuZ2V0Qm91bmRpbmdJbmZvKCkuaXNMb2NrZWQpcmV0dXJuIHRoaXM7Y29uc3QgaT10aGlzLl9zb3VyY2VNZXNoLmdlb21ldHJ5P3RoaXMuX3NvdXJjZU1lc2guZ2VvbWV0cnkuYm91bmRpbmdCaWFzOm51bGw7cmV0dXJuIHRoaXMuX3JlZnJlc2hCb3VuZGluZ0luZm8odGhpcy5fc291cmNlTWVzaC5fZ2V0UG9zaXRpb25EYXRhKGUsdCksaSksdGhpc31fcHJlQWN0aXZhdGUoKXtyZXR1cm4gdGhpcy5fY3VycmVudExPRCYmdGhpcy5fY3VycmVudExPRC5fcHJlQWN0aXZhdGUoKSx0aGlzfV9hY3RpdmF0ZShlLHQpe2lmKHN1cGVyLl9hY3RpdmF0ZShlLHQpLHRoaXMuX3NvdXJjZU1lc2guc3ViTWVzaGVzfHxPLldhcm4oIkluc3RhbmNlcyBzaG91bGQgb25seSBiZSBjcmVhdGVkIGZvciBtZXNoZXMgd2l0aCBnZW9tZXRyeS4iKSx0aGlzLl9jdXJyZW50TE9EKXtpZih0aGlzLl9jdXJyZW50TE9ELl9nZXRXb3JsZE1hdHJpeERldGVybWluYW50KCk+PTAhPXRoaXMuX2dldFdvcmxkTWF0cml4RGV0ZXJtaW5hbnQoKT49MClyZXR1cm4gdGhpcy5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fYWN0QXNSZWd1bGFyTWVzaD0hMCwhMDtpZih0aGlzLl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9hY3RBc1JlZ3VsYXJNZXNoPSExLHRoaXMuX2N1cnJlbnRMT0QuX3JlZ2lzdGVySW5zdGFuY2VGb3JSZW5kZXJJZCh0aGlzLGUpLHQpe2lmKCF0aGlzLl9jdXJyZW50TE9ELl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZUludGVybWVkaWF0ZSlyZXR1cm4gdGhpcy5fY3VycmVudExPRC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fb25seUZvckluc3RhbmNlc0ludGVybWVkaWF0ZT0hMCwhMH1lbHNlIGlmKCF0aGlzLl9jdXJyZW50TE9ELl9pbnRlcm5hbEFic3RyYWN0TWVzaERhdGFJbmZvLl9pc0FjdGl2ZSlyZXR1cm4gdGhpcy5fY3VycmVudExPRC5faW50ZXJuYWxBYnN0cmFjdE1lc2hEYXRhSW5mby5fb25seUZvckluc3RhbmNlcz0hMCwhMH1yZXR1cm4hMX1fcG9zdEFjdGl2YXRlKCl7dGhpcy5fc291cmNlTWVzaC5lZGdlc1NoYXJlV2l0aEluc3RhbmNlcyYmdGhpcy5fc291cmNlTWVzaC5fZWRnZXNSZW5kZXJlciYmdGhpcy5fc291cmNlTWVzaC5fZWRnZXNSZW5kZXJlci5pc0VuYWJsZWQmJnRoaXMuX3NvdXJjZU1lc2guX3JlbmRlcmluZ0dyb3VwPyh0aGlzLl9zb3VyY2VNZXNoLl9yZW5kZXJpbmdHcm91cC5fZWRnZXNSZW5kZXJlcnMucHVzaE5vRHVwbGljYXRlKHRoaXMuX3NvdXJjZU1lc2guX2VkZ2VzUmVuZGVyZXIpLHRoaXMuX3NvdXJjZU1lc2guX2VkZ2VzUmVuZGVyZXIuY3VzdG9tSW5zdGFuY2VzLnB1c2godGhpcy5nZXRXb3JsZE1hdHJpeCgpKSk6dGhpcy5fZWRnZXNSZW5kZXJlciYmdGhpcy5fZWRnZXNSZW5kZXJlci5pc0VuYWJsZWQmJnRoaXMuX3NvdXJjZU1lc2guX3JlbmRlcmluZ0dyb3VwJiZ0aGlzLl9zb3VyY2VNZXNoLl9yZW5kZXJpbmdHcm91cC5fZWRnZXNSZW5kZXJlcnMucHVzaCh0aGlzLl9lZGdlc1JlbmRlcmVyKX1nZXRXb3JsZE1hdHJpeCgpe2lmKHRoaXMuX2N1cnJlbnRMT0QmJnRoaXMuX2N1cnJlbnRMT0QuYmlsbGJvYXJkTW9kZSE9PUouQklMTEJPQVJETU9ERV9OT05FJiZ0aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoIT09dGhpcyl7dGhpcy5fYmlsbGJvYXJkV29ybGRNYXRyaXh8fCh0aGlzLl9iaWxsYm9hcmRXb3JsZE1hdHJpeD1uZXcgeCk7Y29uc3QgZT10aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoO3JldHVybiB0aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoPXRoaXMsRC5WZWN0b3IzWzddLmNvcHlGcm9tKHRoaXMuX2N1cnJlbnRMT0QucG9zaXRpb24pLHRoaXMuX2N1cnJlbnRMT0QucG9zaXRpb24uc2V0KDAsMCwwKSx0aGlzLl9iaWxsYm9hcmRXb3JsZE1hdHJpeC5jb3B5RnJvbSh0aGlzLl9jdXJyZW50TE9ELmNvbXB1dGVXb3JsZE1hdHJpeCghMCkpLHRoaXMuX2N1cnJlbnRMT0QucG9zaXRpb24uY29weUZyb20oRC5WZWN0b3IzWzddKSx0aGlzLl9jdXJyZW50TE9ELl9tYXN0ZXJNZXNoPWUsdGhpcy5fYmlsbGJvYXJkV29ybGRNYXRyaXh9cmV0dXJuIHN1cGVyLmdldFdvcmxkTWF0cml4KCl9Z2V0IGlzQW5JbnN0YW5jZSgpe3JldHVybiEwfWdldExPRChlKXtpZighZSlyZXR1cm4gdGhpcztjb25zdCB0PXRoaXMuc291cmNlTWVzaC5nZXRMT0RMZXZlbHMoKTtpZighdHx8dC5sZW5ndGg9PT0wKXRoaXMuX2N1cnJlbnRMT0Q9dGhpcy5zb3VyY2VNZXNoO2Vsc2V7Y29uc3QgaT10aGlzLmdldEJvdW5kaW5nSW5mbygpO3RoaXMuX2N1cnJlbnRMT0Q9dGhpcy5zb3VyY2VNZXNoLmdldExPRChlLGkuYm91bmRpbmdTcGhlcmUpfXJldHVybiB0aGlzLl9jdXJyZW50TE9EfV9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZyhlKXtyZXR1cm4gdGhpcy5zb3VyY2VNZXNoLl9wcmVBY3RpdmF0ZUZvckludGVybWVkaWF0ZVJlbmRlcmluZyhlKX1fc3luY1N1Yk1lc2hlcygpe2lmKHRoaXMucmVsZWFzZVN1Yk1lc2hlcygpLHRoaXMuX3NvdXJjZU1lc2guc3ViTWVzaGVzKWZvcihsZXQgZT0wO2U8dGhpcy5fc291cmNlTWVzaC5zdWJNZXNoZXMubGVuZ3RoO2UrKyl0aGlzLl9zb3VyY2VNZXNoLnN1Yk1lc2hlc1tlXS5jbG9uZSh0aGlzLHRoaXMuX3NvdXJjZU1lc2gpO3JldHVybiB0aGlzfV9nZW5lcmF0ZVBvaW50c0FycmF5KCl7cmV0dXJuIHRoaXMuX3NvdXJjZU1lc2guX2dlbmVyYXRlUG9pbnRzQXJyYXkoKX1fdXBkYXRlQm91bmRpbmdJbmZvKCl7cmV0dXJuIHRoaXMuaGFzQm91bmRpbmdJbmZvP3RoaXMuZ2V0Qm91bmRpbmdJbmZvKCkudXBkYXRlKHRoaXMud29ybGRNYXRyaXhGcm9tQ2FjaGUpOnRoaXMuYnVpbGRCb3VuZGluZ0luZm8odGhpcy5hYnNvbHV0ZVBvc2l0aW9uLHRoaXMuYWJzb2x1dGVQb3NpdGlvbix0aGlzLndvcmxkTWF0cml4RnJvbUNhY2hlKSx0aGlzLl91cGRhdGVTdWJNZXNoZXNCb3VuZGluZ0luZm8odGhpcy53b3JsZE1hdHJpeEZyb21DYWNoZSksdGhpc31jbG9uZShlLHQ9bnVsbCxpLHMpe2NvbnN0IHI9KHN8fHRoaXMuX3NvdXJjZU1lc2gpLmNyZWF0ZUluc3RhbmNlKGUpO2lmKHZzLkRlZXBDb3B5KHRoaXMscixbIm5hbWUiLCJzdWJNZXNoZXMiLCJ1bmlxdWVJZCIsInBhcmVudCIsImxpZ2h0U291cmNlcyIsInJlY2VpdmVTaGFkb3dzIiwibWF0ZXJpYWwiLCJ2aXNpYmlsaXR5Iiwic2tlbGV0b24iLCJzb3VyY2VNZXNoIiwiaXNBbkluc3RhbmNlIiwiZmFjZXROYiIsImlzRmFjZXREYXRhRW5hYmxlZCIsImlzQmxvY2tlZCIsInVzZUJvbmVzIiwiaGFzSW5zdGFuY2VzIiwiY29sbGlkZXIiLCJlZGdlc1JlbmRlcmVyIiwiZm9yd2FyZCIsInVwIiwicmlnaHQiLCJhYnNvbHV0ZVBvc2l0aW9uIiwiYWJzb2x1dGVTY2FsaW5nIiwiYWJzb2x1dGVSb3RhdGlvblF1YXRlcm5pb24iLCJpc1dvcmxkTWF0cml4RnJvemVuIiwibm9uVW5pZm9ybVNjYWxpbmciLCJiZWhhdmlvcnMiLCJ3b3JsZE1hdHJpeEZyb21DYWNoZSIsImhhc1RoaW5JbnN0YW5jZXMiLCJoYXNCb3VuZGluZ0luZm8iXSxbXSksdGhpcy5yZWZyZXNoQm91bmRpbmdJbmZvKCksdCYmKHIucGFyZW50PXQpLCFpKWZvcihsZXQgbj0wO248dGhpcy5nZXRTY2VuZSgpLm1lc2hlcy5sZW5ndGg7bisrKXtjb25zdCBhPXRoaXMuZ2V0U2NlbmUoKS5tZXNoZXNbbl07YS5wYXJlbnQ9PT10aGlzJiZhLmNsb25lKGEubmFtZSxyKX1yZXR1cm4gci5jb21wdXRlV29ybGRNYXRyaXgoITApLHRoaXMub25DbG9uZWRPYnNlcnZhYmxlLm5vdGlmeU9ic2VydmVycyhyKSxyfWRpc3Bvc2UoZSx0PSExKXt0aGlzLl9zb3VyY2VNZXNoLnJlbW92ZUluc3RhbmNlKHRoaXMpLHN1cGVyLmRpc3Bvc2UoZSx0KX1fc2VyaWFsaXplQXNQYXJlbnQoZSl7c3VwZXIuX3NlcmlhbGl6ZUFzUGFyZW50KGUpLGUucGFyZW50SWQ9dGhpcy5fc291cmNlTWVzaC51bmlxdWVJZCxlLnBhcmVudEluc3RhbmNlSW5kZXg9dGhpcy5faW5kZXhJblNvdXJjZU1lc2hJbnN0YW5jZUFycmF5fWluc3RhbnRpYXRlSGllcmFyY2h5KGU9bnVsbCx0LGkpe2NvbnN0IHM9dGhpcy5jbG9uZSgiQ2xvbmUgb2YgIisodGhpcy5uYW1lfHx0aGlzLmlkKSxlfHx0aGlzLnBhcmVudCwhMCx0JiZ0Lm5ld1NvdXJjZWRNZXNoKTtzJiZpJiZpKHRoaXMscyk7Zm9yKGNvbnN0IHIgb2YgdGhpcy5nZXRDaGlsZFRyYW5zZm9ybU5vZGVzKCEwKSlyLmluc3RhbnRpYXRlSGllcmFyY2h5KHMsdCxpKTtyZXR1cm4gc319Vy5wcm90b3R5cGUucmVnaXN0ZXJJbnN0YW5jZWRCdWZmZXI9ZnVuY3Rpb24oYyxlKXt2YXIgdCxpO2lmKChpPSh0PXRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZSk9PT1udWxsfHx0PT09dm9pZCAwP3ZvaWQgMDp0LnZlcnRleEJ1ZmZlcnNbY10pPT09bnVsbHx8aT09PXZvaWQgMHx8aS5kaXNwb3NlKCksIXRoaXMuaW5zdGFuY2VkQnVmZmVycyl7dGhpcy5pbnN0YW5jZWRCdWZmZXJzPXt9O2Zvcihjb25zdCBzIG9mIHRoaXMuaW5zdGFuY2VzKXMuaW5zdGFuY2VkQnVmZmVycz17fTt0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2V8fCh0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2U9e2RhdGE6e30sdmVydGV4QnVmZmVyczp7fSxzdHJpZGVzOnt9LHNpemVzOnt9LHZlcnRleEFycmF5T2JqZWN0czp0aGlzLmdldEVuZ2luZSgpLmdldENhcHMoKS52ZXJ0ZXhBcnJheU9iamVjdD97fTp2b2lkIDB9KX10aGlzLmluc3RhbmNlZEJ1ZmZlcnNbY109bnVsbCx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc3RyaWRlc1tjXT1lLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS5zaXplc1tjXT1lKjMyLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS5kYXRhW2NdPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnNpemVzW2NdKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1tjXT1uZXcgZyh0aGlzLmdldEVuZ2luZSgpLHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS5kYXRhW2NdLGMsITAsITEsZSwhMCk7Zm9yKGNvbnN0IHMgb2YgdGhpcy5pbnN0YW5jZXMpcy5pbnN0YW5jZWRCdWZmZXJzW2NdPW51bGw7dGhpcy5faW52YWxpZGF0ZUluc3RhbmNlVmVydGV4QXJyYXlPYmplY3QoKSx0aGlzLl9tYXJrU3ViTWVzaGVzQXNBdHRyaWJ1dGVzRGlydHkoKX0sVy5wcm90b3R5cGUuX3Byb2Nlc3NJbnN0YW5jZWRCdWZmZXJzPWZ1bmN0aW9uKGMsZSl7Y29uc3QgdD1jP2MubGVuZ3RoOjA7Zm9yKGNvbnN0IGkgaW4gdGhpcy5pbnN0YW5jZWRCdWZmZXJzKXtsZXQgcz10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc2l6ZXNbaV07Y29uc3Qgcj10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc3RyaWRlc1tpXSxuPSh0KzEpKnI7Zm9yKDtzPG47KXMqPTI7dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLmRhdGFbaV0ubGVuZ3RoIT1zJiYodGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLmRhdGFbaV09bmV3IEZsb2F0MzJBcnJheShzKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2Uuc2l6ZXNbaV09cyx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1tpXSYmKHRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhCdWZmZXJzW2ldLmRpc3Bvc2UoKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QnVmZmVyc1tpXT1udWxsKSk7Y29uc3QgYT10aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UuZGF0YVtpXTtsZXQgbz0wO2lmKGUpe2NvbnN0IGg9dGhpcy5pbnN0YW5jZWRCdWZmZXJzW2ldO2gudG9BcnJheT9oLnRvQXJyYXkoYSxvKTpoLmNvcHlUb0FycmF5P2guY29weVRvQXJyYXkoYSxvKTphW29dPWgsbys9cn1mb3IobGV0IGg9MDtoPHQ7aCsrKXtjb25zdCB1PWNbaF0uaW5zdGFuY2VkQnVmZmVyc1tpXTt1LnRvQXJyYXk/dS50b0FycmF5KGEsbyk6dS5jb3B5VG9BcnJheT91LmNvcHlUb0FycmF5KGEsbyk6YVtvXT11LG8rPXJ9dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbaV0/dGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbaV0udXBkYXRlRGlyZWN0bHkoYSwwKToodGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbaV09bmV3IGcodGhpcy5nZXRFbmdpbmUoKSx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UuZGF0YVtpXSxpLCEwLCExLHIsITApLHRoaXMuX2ludmFsaWRhdGVJbnN0YW5jZVZlcnRleEFycmF5T2JqZWN0KCkpfX0sVy5wcm90b3R5cGUuX2ludmFsaWRhdGVJbnN0YW5jZVZlcnRleEFycmF5T2JqZWN0PWZ1bmN0aW9uKCl7aWYoISghdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlfHx0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QXJyYXlPYmplY3RzPT09dm9pZCAwKSl7Zm9yKGNvbnN0IGMgaW4gdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEFycmF5T2JqZWN0cyl0aGlzLmdldEVuZ2luZSgpLnJlbGVhc2VWZXJ0ZXhBcnJheU9iamVjdCh0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QXJyYXlPYmplY3RzW2NdKTt0aGlzLl91c2VySW5zdGFuY2VkQnVmZmVyc1N0b3JhZ2UudmVydGV4QXJyYXlPYmplY3RzPXt9fX0sVy5wcm90b3R5cGUuX2Rpc3Bvc2VJbnN0YW5jZVNwZWNpZmljRGF0YT1mdW5jdGlvbigpe2Zvcih0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0J1ZmZlciYmKHRoaXMuX2luc3RhbmNlRGF0YVN0b3JhZ2UuaW5zdGFuY2VzQnVmZmVyLmRpc3Bvc2UoKSx0aGlzLl9pbnN0YW5jZURhdGFTdG9yYWdlLmluc3RhbmNlc0J1ZmZlcj1udWxsKTt0aGlzLmluc3RhbmNlcy5sZW5ndGg7KXRoaXMuaW5zdGFuY2VzWzBdLmRpc3Bvc2UoKTtmb3IoY29uc3QgYyBpbiB0aGlzLmluc3RhbmNlZEJ1ZmZlcnMpdGhpcy5fdXNlckluc3RhbmNlZEJ1ZmZlcnNTdG9yYWdlLnZlcnRleEJ1ZmZlcnNbY10mJnRoaXMuX3VzZXJJbnN0YW5jZWRCdWZmZXJzU3RvcmFnZS52ZXJ0ZXhCdWZmZXJzW2NdLmRpc3Bvc2UoKTt0aGlzLl9pbnZhbGlkYXRlSW5zdGFuY2VWZXJ0ZXhBcnJheU9iamVjdCgpLHRoaXMuaW5zdGFuY2VkQnVmZmVycz17fX07Y29uc3QgV3I9Yz0+SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjKSksSWw9e2Fzc2V0UGF0aDoiIixlbmFibGVTaGFkb3dzOiExLGdyb3VwSWQ6bnVsbCxpZDpudWxsLGxpZ2h0czpbXSxyb2xsSWQ6bnVsbCxzY2VuZTpudWxsfSxYdD1jbGFzc3tjb25zdHJ1Y3RvcihlLHQpe2J0KHRoaXMsInZhbHVlIiwwKTtidCh0aGlzLCJhc2xlZXAiLCExKTt0aGlzLmNvbmZpZz17Li4uSWwsLi4uZX0sdGhpcy5pZD10aGlzLmNvbmZpZy5pZCE9PXZvaWQgMD90aGlzLmNvbmZpZy5pZDpEYXRlLm5vdygpLHRoaXMuc2lkZXM9dGhpcy5jb25maWcuc2lkZXMsdGhpcy5kaWVUeXBlPXRoaXMuY29uZmlnLmRpZVR5cGUsdGhpcy5jb21ib0tleT1gJHt0aGlzLmNvbmZpZy50aGVtZX1fJHt0aGlzLmNvbmZpZy5kaWVUeXBlfWAsdGhpcy5zY2VuZT10LHRoaXMuY3JlYXRlSW5zdGFuY2UoKX1jcmVhdGVJbnN0YW5jZSgpe2NvbnN0IGU9YCR7dGhpcy5jb25maWcubWVzaE5hbWV9XyR7dGhpcy5kaWVUeXBlfV8ke3RoaXMuY29uZmlnLnRoZW1lfSR7dGhpcy5jb25maWcuY29sb3JTdWZmaXh9YCx0PWAke2V9LWluc3RhbmNlLSR7dGhpcy5pZH1gLGk9dGhpcy5zY2VuZS5nZXRNZXNoQnlOYW1lKGUpLmNyZWF0ZUluc3RhbmNlKHQpO2lmKHRoaXMuY29uZmlnLmNvbG9yU3VmZml4Lmxlbmd0aD4wKXtjb25zdCBzPXJlLkZyb21IZXhTdHJpbmcodGhpcy5jb25maWcudGhlbWVDb2xvcik7aS5pbnN0YW5jZWRCdWZmZXJzLmN1c3RvbUNvbG9yPXN9aS5wb3NpdGlvbi55PS0xMDAsaS5zY2FsaW5nPW5ldyBwKGkuc2NhbGluZy54KnRoaXMuY29uZmlnLnNjYWxlLGkuc2NhbGluZy55KnRoaXMuY29uZmlnLnNjYWxlLGkuc2NhbGluZy56KnRoaXMuY29uZmlnLnNjYWxlKSx0aGlzLmNvbmZpZy5lbmFibGVTaGFkb3dzJiZ0aGlzLmNvbmZpZy5saWdodHMuZGlyZWN0aW9uYWwuc2hhZG93R2VuZXJhdG9yLmFkZFNoYWRvd0Nhc3RlcihpKSx0aGlzLm1lc2g9aX1zdGF0aWMgYXN5bmMgbG9hZERpZShlLHQpe2NvbnN0e3NpZGVzOmksdGhlbWU6cz0iZGVmYXVsdCIsbWVzaE5hbWU6cixjb2xvclN1ZmZpeDpufT1lO2UuZGllVHlwZXx8KGUuZGllVHlwZT1OdW1iZXIuaXNJbnRlZ2VyKGkpP2BkJHtpfWA6aSk7Y29uc3QgYT1yKyJfIitlLmRpZVR5cGUsbz1hKyJfIitzK247bGV0IGg9dC5nZXRNZXNoQnlOYW1lKG8pO3JldHVybiBofHwoaD10LmdldE1lc2hCeU5hbWUoYSkuY2xvbmUobykpLGgubWF0ZXJpYWx8fChoLm1hdGVyaWFsPXQuZ2V0TWF0ZXJpYWxCeU5hbWUocytuKSxuLmxlbmd0aD4wJiZoLnJlZ2lzdGVySW5zdGFuY2VkQnVmZmVyKCJjdXN0b21Db2xvciIsMykpLGV9c3RhdGljIGFzeW5jIGxvYWRNb2RlbHMoZSx0KXtjb25zdHttZXNoRmlsZVBhdGg6aSxtZXNoTmFtZTpzLHNjYWxlOnIsZDRGYWNlRG93bjpuPSEwfT1lO2xldCBhPSExLG89ITE7Y29uc3QgaD1hd2FpdCBmZXRjaChgJHtpfWApLnRoZW4obD0+e2lmKGwub2spe2NvbnN0IHU9bC5oZWFkZXJzLmdldCgiY29udGVudC10eXBlIik7aWYodSYmdS5pbmRleE9mKCJhcHBsaWNhdGlvbi9qc29uIikhPT0tMSlyZXR1cm4gbC5qc29uKCk7aWYobC50eXBlJiZsLnR5cGU9PT0iYmFzaWMiKXJldHVybiBsLmpzb24oKTt0aHJvdyBuZXcgRXJyb3IoYEluY29ycmVjdCBjb250ZW50VHlwZTogJHt1fS4gRXhwZWN0ZWQgImFwcGxpY2F0aW9uL2pzb24iIG9yICJiYXNpYyJgKX1lbHNlIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIGxvYWQgM0QgbWVzaCBmaWxlOiAnJHtpfScuIFJlcXVlc3QgcmVqZWN0ZWQgd2l0aCBzdGF0dXMgJHtsLnN0YXR1c306ICR7bC5zdGF0dXNUZXh0fWApfSkuY2F0Y2gobD0+Y29uc29sZS5lcnJvcihsKSk7aWYoaClyZXR1cm4gbGUuSW1wb3J0TWVzaEFzeW5jKG51bGwsbnVsbCwiZGF0YToiK0pTT04uc3RyaW5naWZ5KGgpLHQpLnRoZW4obD0+e2lmKGwubWVzaGVzLmZvckVhY2godT0+e3UubmFtZT09PSJfX3Jvb3RfXyImJnUuZGlzcG9zZSgpLHUubmFtZS5pbmNsdWRlcygiY29sbGlkZXIiKSYmKHUuc2NhbGluZz1uZXcgcCh1LnNjYWxpbmcueCouOSx1LnNjYWxpbmcueSouOSx1LnNjYWxpbmcueiouOSkpLGF8fChhPXUubmFtZT09PSJkMTAwIiksb3x8KG89dS5uYW1lPT09ImQxMCIpLHUuc2V0RW5hYmxlZCghMSksdS5mcmVlemVOb3JtYWxzKCksdS5mcmVlemVXb3JsZE1hdHJpeCgpLHUuaXNQaWNrYWJsZT0hMSx1LmRvTm90U3luY0JvdW5kaW5nSW5mbz0hMCx1Lm5hbWU9cysiXyIrdS5uYW1lfSksIWEmJm8mJih0LmdldE1lc2hCeU5hbWUocysiX2QxMCIpLmNsb25lKHMrIl9kMTAwIiksdC5nZXRNZXNoQnlOYW1lKHMrIl9kMTBfY29sbGlkZXIiKS5jbG9uZShzKyJfZDEwMF9jb2xsaWRlciIpLGguY29sbGlkZXJGYWNlTWFwJiYoaC5jb2xsaWRlckZhY2VNYXAuZDEwMD1XcihoLmNvbGxpZGVyRmFjZU1hcC5kMTApLE9iamVjdC52YWx1ZXMoaC5jb2xsaWRlckZhY2VNYXAuZDEwMCkuZm9yRWFjaCgodSxkKT0+e2guY29sbGlkZXJGYWNlTWFwLmQxMDBbZF09dSoodT09PTEwPzA6MTApfSkpKSwhaC5jb2xsaWRlckZhY2VNYXApdGhyb3cgbmV3IEVycm9yKGAnY29sbGlkZXJGYWNlTWFwJyBkYXRhIG5vdCBmb3VuZCBpbiAke2l9LiBXaXRob3V0IHRoZSBjb2xsaWRlckZhY2VNYXAgZGF0YSBkaWNlIHZhbHVlcyBjYW4gbm90IGJlIHJlc29sdmVkLmApO3QudGhlbWVEYXRhW3NdPXt9LHQudGhlbWVEYXRhW3NdLmNvbGxpZGVyRmFjZU1hcD1oLmNvbGxpZGVyRmFjZU1hcCx0LnRoZW1lRGF0YVtzXS5kNEZhY2VEb3duPW59KS5jYXRjaChsPT5jb25zb2xlLmVycm9yKGwpKSxoLm1lc2hlcy5maWx0ZXIobD0+bC5uYW1lLmluY2x1ZGVzKCJjb2xsaWRlciIpKX11cGRhdGVDb25maWcoZSl7dGhpcy5jb25maWc9ey4uLnRoaXMuY29uZmlnLC4uLmV9fXN0YXRpYyBzZXRWZWN0b3IzKGUsdCxpKXtyZXR1cm4gWHQudmVjdG9yMy5zZXQoZSx0LGkpfXN0YXRpYyBnZXRWZWN0b3IzKCl7cmV0dXJuIFh0LnZlY3RvcjN9c3RhdGljIGFzeW5jIGdldFJvbGxSZXN1bHQoZSx0KXtjb25zdCBpPShzPWUpPT5uZXcgUHJvbWlzZSgocixuKT0+e2NvbnN0IGE9ZS5jb25maWcucGFyZW50TWVzaHx8ZS5jb25maWcubWVzaE5hbWUsbz10LnRoZW1lRGF0YVthXS5jb2xsaWRlckZhY2VNYXAsaD10LnRoZW1lRGF0YVthXS5kNEZhY2VEb3duO2lmKCFvW3MuZGllVHlwZV0pdGhyb3cgbmV3IEVycm9yKGBObyBjb2xsaWRlckZhY2VNYXAgZGF0YSBmb3IgJHtzLmRpZVR5cGV9YCk7Y29uc3QgbD10LmdldE1lc2hCeU5hbWUoYCR7YX1fJHtzLmRpZVR5cGV9X2NvbGxpZGVyYCkuY3JlYXRlSW5zdGFuY2UoYCR7YX1fJHtzLmRpZVR5cGV9LWhpdGJveC0ke3MuaWR9YCk7bC5pc1BpY2thYmxlPSEwLGwuaXNWaXNpYmxlPSEwLGwuc2V0RW5hYmxlZCghMCksbC5wb3NpdGlvbj1zLm1lc2gucG9zaXRpb24sbC5yb3RhdGlvblF1YXRlcm5pb249cy5tZXNoLnJvdGF0aW9uUXVhdGVybmlvbjtsZXQgdT1YdC5zZXRWZWN0b3IzKDAsMSwwKTtzLmRpZVR5cGU9PT0iZDQiJiZoJiYodT1YdC5zZXRWZWN0b3IzKDAsLTEsMCkpLFh0LnJheS5kaXJlY3Rpb249dSxYdC5yYXkub3JpZ2luPWUubWVzaC5wb3NpdGlvbjtjb25zdCBkPXQucGlja1dpdGhSYXkoWHQucmF5KTtpZihsLmRpc3Bvc2UoKSxzLnZhbHVlPW9bcy5kaWVUeXBlXVtkLmZhY2VJZF0scy52YWx1ZT09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoYGNvbGxpZGVyRmFjZU1hcCBFcnJvcjogTm8gdmFsdWUgZm91bmQgZm9yICR7cy5kaWVUeXBlfSBtZXNoIGZhY2UgJHtkLmZhY2VJZH1gKTtyZXR1cm4gcihzLnZhbHVlKX0pLmNhdGNoKHI9PmNvbnNvbGUuZXJyb3IocikpO3JldHVybiBlLm1lc2g/YXdhaXQgaSgpOmUudmFsdWV9fTtsZXQgUHQ9WHQ7YnQoUHQsInJheSIsbmV3IF9lKHAuWmVybygpLHAuWmVybygpLDEpKSxidChQdCwidmVjdG9yMyIscC5aZXJvKCkpO2NsYXNzIFBse2NvbnN0cnVjdG9yKCl7fX1jbGFzcyBpaSBleHRlbmRzIEJ7Y29uc3RydWN0b3IoZSx0KXtzdXBlcihlLHQpLHRoaXMuQ3VzdG9tUGFydHM9bmV3IFBsLHRoaXMuY3VzdG9tU2hhZGVyTmFtZVJlc29sdmU9dGhpcy5CdWlsZGVyLHRoaXMuRnJhZ21lbnRTaGFkZXI9UGUuU2hhZGVyc1N0b3JlLmRlZmF1bHRQaXhlbFNoYWRlcix0aGlzLlZlcnRleFNoYWRlcj1QZS5TaGFkZXJzU3RvcmUuZGVmYXVsdFZlcnRleFNoYWRlcn1BdHRhY2hBZnRlckJpbmQoZSx0KXtpZih0aGlzLl9uZXdVbmlmb3JtSW5zdGFuY2VzKWZvcihjb25zdCBpIGluIHRoaXMuX25ld1VuaWZvcm1JbnN0YW5jZXMpe2NvbnN0IHM9aS50b1N0cmluZygpLnNwbGl0KCItIik7c1swXT09InZlYzIiP3Quc2V0VmVjdG9yMihzWzFdLHRoaXMuX25ld1VuaWZvcm1JbnN0YW5jZXNbaV0pOnNbMF09PSJ2ZWMzIj90LnNldFZlY3RvcjMoc1sxXSx0aGlzLl9uZXdVbmlmb3JtSW5zdGFuY2VzW2ldKTpzWzBdPT0idmVjNCI/dC5zZXRWZWN0b3I0KHNbMV0sdGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlc1tpXSk6c1swXT09Im1hdDQiP3Quc2V0TWF0cml4KHNbMV0sdGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlc1tpXSk6c1swXT09ImZsb2F0IiYmdC5zZXRGbG9hdChzWzFdLHRoaXMuX25ld1VuaWZvcm1JbnN0YW5jZXNbaV0pfWlmKHRoaXMuX25ld1NhbXBsZXJJbnN0YW5jZXMpZm9yKGNvbnN0IGkgaW4gdGhpcy5fbmV3U2FtcGxlckluc3RhbmNlcyl7Y29uc3Qgcz1pLnRvU3RyaW5nKCkuc3BsaXQoIi0iKTtzWzBdPT0ic2FtcGxlcjJEIiYmdGhpcy5fbmV3U2FtcGxlckluc3RhbmNlc1tpXS5pc1JlYWR5JiZ0aGlzLl9uZXdTYW1wbGVySW5zdGFuY2VzW2ldLmlzUmVhZHkoKSYmdC5zZXRUZXh0dXJlKHNbMV0sdGhpcy5fbmV3U2FtcGxlckluc3RhbmNlc1tpXSl9fVJldmlld1VuaWZvcm0oZSx0KXtpZihlPT0idW5pZm9ybSImJnRoaXMuX25ld1VuaWZvcm1zKWZvcihsZXQgaT0wO2k8dGhpcy5fbmV3VW5pZm9ybXMubGVuZ3RoO2krKyl0aGlzLl9jdXN0b21Vbmlmb3JtW2ldLmluZGV4T2YoInNhbXBsZXIiKT09LTEmJnQucHVzaCh0aGlzLl9uZXdVbmlmb3Jtc1tpXSk7aWYoZT09InNhbXBsZXIiJiZ0aGlzLl9uZXdVbmlmb3Jtcylmb3IobGV0IGk9MDtpPHRoaXMuX25ld1VuaWZvcm1zLmxlbmd0aDtpKyspdGhpcy5fY3VzdG9tVW5pZm9ybVtpXS5pbmRleE9mKCJzYW1wbGVyIikhPS0xJiZ0LnB1c2godGhpcy5fbmV3VW5pZm9ybXNbaV0pO3JldHVybiB0fUJ1aWxkZXIoZSx0LGkscyxyLG4pe2lmKG4mJnRoaXMuX2N1c3RvbUF0dHJpYnV0ZXMmJnRoaXMuX2N1c3RvbUF0dHJpYnV0ZXMubGVuZ3RoPjAmJm4ucHVzaCguLi50aGlzLl9jdXN0b21BdHRyaWJ1dGVzKSx0aGlzLlJldmlld1VuaWZvcm0oInVuaWZvcm0iLHQpLHRoaXMuUmV2aWV3VW5pZm9ybSgic2FtcGxlciIscyksdGhpcy5faXNDcmVhdGVkU2hhZGVyKXJldHVybiB0aGlzLl9jcmVhdGVkU2hhZGVyTmFtZTt0aGlzLl9pc0NyZWF0ZWRTaGFkZXI9ITEsaWkuU2hhZGVySW5kZXhlcisrO2NvbnN0IGE9ImN1c3RvbV8iK2lpLlNoYWRlckluZGV4ZXIsbz10aGlzLl9hZnRlckJpbmQuYmluZCh0aGlzKTtyZXR1cm4gdGhpcy5fYWZ0ZXJCaW5kPShoLGwpPT57aWYobCl7dGhpcy5BdHRhY2hBZnRlckJpbmQoaCxsKTt0cnl7byhoLGwpfWNhdGNoe319fSxQZS5TaGFkZXJzU3RvcmVbYSsiVmVydGV4U2hhZGVyIl09dGhpcy5WZXJ0ZXhTaGFkZXIucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX0JFR0lOIix0aGlzLkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbj90aGlzLkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbjoiIikucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX0RFRklOSVRJT05TIiwodGhpcy5fY3VzdG9tVW5pZm9ybT90aGlzLl9jdXN0b21Vbmlmb3JtLmpvaW4oYApgKToiIikrKHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0RlZmluaXRpb25zP3RoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0RlZmluaXRpb25zOiIiKSkucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX01BSU5fQkVHSU4iLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5CZWdpbj90aGlzLkN1c3RvbVBhcnRzLlZlcnRleF9NYWluQmVnaW46IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX1ZFUlRFWF9VUERBVEVfUE9TSVRJT04iLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQ/dGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVmb3JlX1Bvc2l0aW9uVXBkYXRlZDoiIikucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX1VQREFURV9OT1JNQUwiLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Ob3JtYWxVcGRhdGVkP3RoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Ob3JtYWxVcGRhdGVkOiIiKS5yZXBsYWNlKCIjZGVmaW5lIENVU1RPTV9WRVJURVhfTUFJTl9FTkQiLHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5FbmQ/dGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfTWFpbkVuZDoiIiksdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZCYmKFBlLlNoYWRlcnNTdG9yZVthKyJWZXJ0ZXhTaGFkZXIiXT1QZS5TaGFkZXJzU3RvcmVbYSsiVmVydGV4U2hhZGVyIl0ucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fVkVSVEVYX1VQREFURV9XT1JMRFBPUyIsdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZCkpLFBlLlNoYWRlcnNTdG9yZVthKyJQaXhlbFNoYWRlciJdPXRoaXMuRnJhZ21lbnRTaGFkZXIucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fRlJBR01FTlRfQkVHSU4iLHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVnaW4/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWdpbjoiIikucmVwbGFjZSgiI2RlZmluZSBDVVNUT01fRlJBR01FTlRfTUFJTl9CRUdJTiIsdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluQmVnaW4/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluQmVnaW46IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0RFRklOSVRJT05TIiwodGhpcy5fY3VzdG9tVW5pZm9ybT90aGlzLl9jdXN0b21Vbmlmb3JtLmpvaW4oYApgKToiIikrKHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfRGVmaW5pdGlvbnM/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9EZWZpbml0aW9uczoiIikpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX1VQREFURV9ESUZGVVNFIix0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0N1c3RvbV9EaWZmdXNlP3RoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQ3VzdG9tX0RpZmZ1c2U6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX1VQREFURV9BTFBIQSIsdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGE/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGE6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9MSUdIVFMiLHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0xpZ2h0cz90aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9MaWdodHM6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX0JFRk9SRV9GUkFHQ09MT1IiLHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZyYWdDb2xvcj90aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9GcmFnQ29sb3I6IiIpLnJlcGxhY2UoIiNkZWZpbmUgQ1VTVE9NX0ZSQUdNRU5UX01BSU5fRU5EIix0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X01haW5FbmQ/dGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluRW5kOiIiKSx0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9Gb2cmJihQZS5TaGFkZXJzU3RvcmVbYSsiUGl4ZWxTaGFkZXIiXT1QZS5TaGFkZXJzU3RvcmVbYSsiUGl4ZWxTaGFkZXIiXS5yZXBsYWNlKCIjZGVmaW5lIENVU1RPTV9GUkFHTUVOVF9CRUZPUkVfRk9HIix0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9Gb2cpKSx0aGlzLl9pc0NyZWF0ZWRTaGFkZXI9ITAsdGhpcy5fY3JlYXRlZFNoYWRlck5hbWU9YSxhfUFkZFVuaWZvcm0oZSx0LGkpe3JldHVybiB0aGlzLl9jdXN0b21Vbmlmb3JtfHwodGhpcy5fY3VzdG9tVW5pZm9ybT1uZXcgQXJyYXksdGhpcy5fbmV3VW5pZm9ybXM9bmV3IEFycmF5LHRoaXMuX25ld1NhbXBsZXJJbnN0YW5jZXM9e30sdGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlcz17fSksaSYmKHQuaW5kZXhPZigic2FtcGxlciIpIT0tMT90aGlzLl9uZXdTYW1wbGVySW5zdGFuY2VzW3QrIi0iK2VdPWk6dGhpcy5fbmV3VW5pZm9ybUluc3RhbmNlc1t0KyItIitlXT1pKSx0aGlzLl9jdXN0b21Vbmlmb3JtLnB1c2goInVuaWZvcm0gIit0KyIgIitlKyI7IiksdGhpcy5fbmV3VW5pZm9ybXMucHVzaChlKSx0aGlzfUFkZEF0dHJpYnV0ZShlKXtyZXR1cm4gdGhpcy5fY3VzdG9tQXR0cmlidXRlc3x8KHRoaXMuX2N1c3RvbUF0dHJpYnV0ZXM9W10pLHRoaXMuX2N1c3RvbUF0dHJpYnV0ZXMucHVzaChlKSx0aGlzfUZyYWdtZW50X0JlZ2luKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZ2luPWUsdGhpc31GcmFnbWVudF9EZWZpbml0aW9ucyhlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9EZWZpbml0aW9ucz1lLHRoaXN9RnJhZ21lbnRfTWFpbkJlZ2luKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X01haW5CZWdpbj1lLHRoaXN9RnJhZ21lbnRfTWFpbkVuZChlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9NYWluRW5kPWUsdGhpc31GcmFnbWVudF9DdXN0b21fRGlmZnVzZShlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fRGlmZnVzZT1lLnJlcGxhY2UoInJlc3VsdCIsImRpZmZ1c2VDb2xvciIpLHRoaXN9RnJhZ21lbnRfQ3VzdG9tX0FscGhhKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0N1c3RvbV9BbHBoYT1lLnJlcGxhY2UoInJlc3VsdCIsImFscGhhIiksdGhpc31GcmFnbWVudF9CZWZvcmVfTGlnaHRzKGUpe3JldHVybiB0aGlzLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9MaWdodHM9ZSx0aGlzfUZyYWdtZW50X0JlZm9yZV9Gb2coZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZvZz1lLHRoaXN9RnJhZ21lbnRfQmVmb3JlX0ZyYWdDb2xvcihlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWZvcmVfRnJhZ0NvbG9yPWUucmVwbGFjZSgicmVzdWx0IiwiY29sb3IiKSx0aGlzfVZlcnRleF9CZWdpbihlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVnaW49ZSx0aGlzfVZlcnRleF9EZWZpbml0aW9ucyhlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfRGVmaW5pdGlvbnM9ZSx0aGlzfVZlcnRleF9NYWluQmVnaW4oZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5CZWdpbj1lLHRoaXN9VmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQoZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQ9ZS5yZXBsYWNlKCJyZXN1bHQiLCJwb3NpdGlvblVwZGF0ZWQiKSx0aGlzfVZlcnRleF9CZWZvcmVfTm9ybWFsVXBkYXRlZChlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVmb3JlX05vcm1hbFVwZGF0ZWQ9ZS5yZXBsYWNlKCJyZXN1bHQiLCJub3JtYWxVcGRhdGVkIiksdGhpc31WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZChlKXtyZXR1cm4gdGhpcy5DdXN0b21QYXJ0cy5WZXJ0ZXhfQWZ0ZXJfV29ybGRQb3NDb21wdXRlZD1lLHRoaXN9VmVydGV4X01haW5FbmQoZSl7cmV0dXJuIHRoaXMuQ3VzdG9tUGFydHMuVmVydGV4X01haW5FbmQ9ZSx0aGlzfX1paS5TaGFkZXJJbmRleGVyPTEsaXQoIkJBQllMT04uQ3VzdG9tTWF0ZXJpYWwiLGlpKSxpaS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oYyl7Y29uc3QgZT10aGlzLHQ9YWUuQ2xvbmUoKCk9Pm5ldyBpaShjLHRoaXMuZ2V0U2NlbmUoKSksdGhpcyk7cmV0dXJuIHQubmFtZT1jLHQuaWQ9Yyx0LkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZ2luPWUuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVnaW4sdC5DdXN0b21QYXJ0cy5GcmFnbWVudF9EZWZpbml0aW9ucz1lLkN1c3RvbVBhcnRzLkZyYWdtZW50X0RlZmluaXRpb25zLHQuQ3VzdG9tUGFydHMuRnJhZ21lbnRfTWFpbkJlZ2luPWUuQ3VzdG9tUGFydHMuRnJhZ21lbnRfTWFpbkJlZ2luLHQuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQ3VzdG9tX0RpZmZ1c2U9ZS5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fRGlmZnVzZSx0LkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9MaWdodHM9ZS5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWZvcmVfTGlnaHRzLHQuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZvZz1lLkN1c3RvbVBhcnRzLkZyYWdtZW50X0JlZm9yZV9Gb2csdC5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGE9ZS5DdXN0b21QYXJ0cy5GcmFnbWVudF9DdXN0b21fQWxwaGEsdC5DdXN0b21QYXJ0cy5GcmFnbWVudF9CZWZvcmVfRnJhZ0NvbG9yPWUuQ3VzdG9tUGFydHMuRnJhZ21lbnRfQmVmb3JlX0ZyYWdDb2xvcix0LkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbj1lLkN1c3RvbVBhcnRzLlZlcnRleF9CZWdpbix0LkN1c3RvbVBhcnRzLlZlcnRleF9EZWZpbml0aW9ucz1lLkN1c3RvbVBhcnRzLlZlcnRleF9EZWZpbml0aW9ucyx0LkN1c3RvbVBhcnRzLlZlcnRleF9NYWluQmVnaW49ZS5DdXN0b21QYXJ0cy5WZXJ0ZXhfTWFpbkJlZ2luLHQuQ3VzdG9tUGFydHMuVmVydGV4X0JlZm9yZV9Qb3NpdGlvblVwZGF0ZWQ9ZS5DdXN0b21QYXJ0cy5WZXJ0ZXhfQmVmb3JlX1Bvc2l0aW9uVXBkYXRlZCx0LkN1c3RvbVBhcnRzLlZlcnRleF9CZWZvcmVfTm9ybWFsVXBkYXRlZD1lLkN1c3RvbVBhcnRzLlZlcnRleF9CZWZvcmVfTm9ybWFsVXBkYXRlZCx0LkN1c3RvbVBhcnRzLlZlcnRleF9BZnRlcl9Xb3JsZFBvc0NvbXB1dGVkPWUuQ3VzdG9tUGFydHMuVmVydGV4X0FmdGVyX1dvcmxkUG9zQ29tcHV0ZWQsdC5DdXN0b21QYXJ0cy5WZXJ0ZXhfTWFpbkVuZD1lLkN1c3RvbVBhcnRzLlZlcnRleF9NYWluRW5kLHR9O2NsYXNzIERse2NvbnN0cnVjdG9yKGUpe2J0KHRoaXMsImxvYWRlZFRoZW1lcyIse30pO2J0KHRoaXMsInRoZW1lRGF0YSIse30pO3RoaXMuc2NlbmU9ZS5zY2VuZX1hc3luYyBsb2FkU3RhbmRhcmRNYXRlcmlhbChlKXtjb25zdHt0aGVtZTp0LG1hdGVyaWFsOml9PWUscz1uZXcgQih0LHRoaXMuc2NlbmUpO2kuZGlmZnVzZVRleHR1cmUmJihzLmRpZmZ1c2VUZXh0dXJlPWF3YWl0IHRoaXMuZ2V0VGV4dHVyZSgiZGlmZnVzZSIsZSkpLGkuYnVtcFRleHR1cmUmJihzLmJ1bXBUZXh0dXJlPWF3YWl0IHRoaXMuZ2V0VGV4dHVyZSgiYnVtcCIsZSkpLGkuc3BlY3VsYXJUZXh0dXJlJiYocy5zcGVjdWxhclRleHR1cmU9YXdhaXQgdGhpcy5nZXRUZXh0dXJlKCJzcGVjdWxhciIsZSkpLHMuYWxsb3dTaGFkZXJIb3RTd2FwcGluZz0hMX1hc3luYyBsb2FkQ29sb3JNYXRlcmlhbChlKXtjb25zdHt0aGVtZTp0LG1hdGVyaWFsOml9PWUscz1uZXcgaWkodCsiX2xpZ2h0Iix0aGlzLnNjZW5lKSxyPVdyKGUpO2kuZGlmZnVzZVRleHR1cmUmJmkuZGlmZnVzZVRleHR1cmUubGlnaHQmJihyLm1hdGVyaWFsLmRpZmZ1c2VUZXh0dXJlPWUubWF0ZXJpYWwuZGlmZnVzZVRleHR1cmUubGlnaHQscy5kaWZmdXNlVGV4dHVyZT1hd2FpdCB0aGlzLmdldFRleHR1cmUoImRpZmZ1c2UiLHIpKSxpLmJ1bXBUZXh0dXJlJiYocy5idW1wVGV4dHVyZT1hd2FpdCB0aGlzLmdldFRleHR1cmUoImJ1bXAiLGUpKSxpLnNwZWN1bGFyVGV4dHVyZSYmKHMuc3BlY3VsYXJUZXh0dXJlPWF3YWl0IHRoaXMuZ2V0VGV4dHVyZSgic3BlY3VsYXIiLGUpKSxzLmFsbG93U2hhZGVySG90U3dhcHBpbmc9ITEscy5WZXJ0ZXhfRGVmaW5pdGlvbnMoYAogICAgICBhdHRyaWJ1dGUgdmVjMyBjdXN0b21Db2xvcjsKICAgICAgdmFyeWluZyB2ZWMzIHZDb2xvcjsKICAgIGApLlZlcnRleF9NYWluRW5kKGAKICAgICAgdkNvbG9yID0gY3VzdG9tQ29sb3I7CiAgICBgKS5GcmFnbWVudF9EZWZpbml0aW9ucyhgCiAgICAgIHZhcnlpbmcgdmVjMyB2Q29sb3I7CiAgICBgKS5GcmFnbWVudF9DdXN0b21fRGlmZnVzZShgCiAgICAgIGJhc2VDb2xvci5yZ2IgPSBtaXgodkNvbG9yLnJnYiwgYmFzZUNvbG9yLnJnYiwgYmFzZUNvbG9yLmEpOwogICAgYCkscy5BZGRBdHRyaWJ1dGUoImN1c3RvbUNvbG9yIik7Y29uc3Qgbj1zLmNsb25lKHQrIl9kYXJrIik7aS5kaWZmdXNlVGV4dHVyZSYmaS5kaWZmdXNlVGV4dHVyZS5kYXJrJiYoci5tYXRlcmlhbC5kaWZmdXNlVGV4dHVyZT1lLm1hdGVyaWFsLmRpZmZ1c2VUZXh0dXJlLmRhcmssbi5kaWZmdXNlVGV4dHVyZT1hd2FpdCB0aGlzLmdldFRleHR1cmUoImRpZmZ1c2UiLHIpKSxuLkFkZEF0dHJpYnV0ZSgiY3VzdG9tQ29sb3IiKX1hc3luYyBnZXRUZXh0dXJlKGUsdCl7Y29uc3R7YmFzZVBhdGg6aSxtYXRlcmlhbDpzLHRoZW1lOnJ9PXQ7bGV0IG47Y29uc3QgYT1lKyJMZXZlbCIsbz1lKyJUZXh0dXJlIjt0cnl7c3dpdGNoKGUpe2Nhc2UiZGlmZnVzZSI6bj1hd2FpdCB0aGlzLmltcG9ydFRleHR1cmVBc3luYyhgJHtpfS8ke3Nbb119YCxyKSxzW2FdJiYobi5sZXZlbD1zW2FdKTticmVhaztjYXNlImJ1bXAiOm49YXdhaXQgdGhpcy5pbXBvcnRUZXh0dXJlQXN5bmMoYCR7aX0vJHtzW29dfWAsciksc1thXSYmKG4ubGV2ZWw9c1thXSk7YnJlYWs7Y2FzZSJzcGVjdWxhciI6bj1hd2FpdCB0aGlzLmltcG9ydFRleHR1cmVBc3luYyhgJHtpfS8ke3Nbb119YCxyKSxzLnNwZWN1bGFyUG93ZXImJihuLnNwZWN1bGFyUG93ZXI9cy5zcGVjdWxhclBvd2VyKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgVGV4dHVyZSB0eXBlOiAke2V9IGlzIG5vdCBzdXBwb3J0ZWRgKX19Y2F0Y2goaCl7Y29uc29sZS5lcnJvcihoKX1yZXR1cm4gbn1hc3luYyBpbXBvcnRUZXh0dXJlQXN5bmMoZSx0KXtyZXR1cm4gbmV3IFByb21pc2UoKGkscyk9PntsZXQgcj1lLm1hdGNoKC9eKC4qXC8pKC4qKSQvKSxuPW5ldyBOKGUsdGhpcy5zY2VuZSx2b2lkIDAsITAsdm9pZCAwLCgpPT5pKG4pLCgpPT5zKGBVbmFibGUgdG8gbG9hZCB0ZXh0dXJlICcke3JbMl19JyBmb3IgdGhlbWU6ICcke3R9Jy4gQ2hlY2sgdGhhdCB5b3VyIGFzc2V0UGF0aCBpcyBjb25maWd1cmVkIGNvcnJlY3RseSBhbmQgdGhhdCB0aGUgZmlsZXMgZXhpc3QgYXQgcGF0aDogJyR7clsxXX0nYCkpfSkuY2F0Y2goaT0+Y29uc29sZS5lcnJvcihpKSl9YXN5bmMgbG9hZChlKXtjb25zdHttYXRlcmlhbDp0fT1lO3QudHlwZT09PSJjb2xvciI/YXdhaXQgdGhpcy5sb2FkQ29sb3JNYXRlcmlhbChlKTp0LnR5cGU9PT0ic3RhbmRhcmQiP2F3YWl0IHRoaXMubG9hZFN0YW5kYXJkTWF0ZXJpYWwoZSk6Y29uc29sZS5lcnJvcihgTWF0ZXJpYWwgdHlwZTogJHt0LnR5cGV9IG5vdCBzdXBwb3J0ZWRgKX19Y2xhc3MgRmx7Y29uc3RydWN0b3IoZSl7bnQodGhpcyx1cyk7YnQodGhpcywiY29uZmlnIik7YnQodGhpcywiaW5pdGlhbGl6ZWQiLCExKTtudCh0aGlzLFhlLHt9KTtudCh0aGlzLEFpLDApO250KHRoaXMsRnQsMCk7bnQodGhpcyxSaSxbXSk7bnQodGhpcyxNdCx2b2lkIDApO250KHRoaXMsVHQsdm9pZCAwKTtudCh0aGlzLEplLHZvaWQgMCk7bnQodGhpcyxjcyx2b2lkIDApO250KHRoaXMsQXQsdm9pZCAwKTtudCh0aGlzLFZpLHZvaWQgMCk7bnQodGhpcyxXaSx2b2lkIDApO250KHRoaXMsZ3Qsdm9pZCAwKTtudCh0aGlzLHppLHt9KTtidCh0aGlzLCJub29wIiwoKT0+e30pO2J0KHRoaXMsImRpY2VCdWZmZXJWaWV3IixuZXcgRmxvYXQzMkFycmF5KDhlMykpO3RoaXMub25Jbml0Q29tcGxldGU9ZS5vbkluaXRDb21wbGV0ZXx8dGhpcy5ub29wLHRoaXMub25UaGVtZUxvYWRlZD1lLm9uVGhlbWVMb2FkZWR8fHRoaXMubm9vcCx0aGlzLm9uUm9sbFJlc3VsdD1lLm9uUm9sbFJlc3VsdHx8dGhpcy5ub29wLHRoaXMub25Sb2xsQ29tcGxldGU9ZS5vblJvbGxDb21wbGV0ZXx8dGhpcy5ub29wLHRoaXMub25EaWVSZW1vdmVkPWUub25EaWVSZW1vdmVkfHx0aGlzLm5vb3AsdGhpcy5pbml0aWFsaXplZD10aGlzLmluaXRTY2VuZShlKX1hc3luYyBpbml0U2NlbmUoZSl7bHQodGhpcyxNdCxlLmNhbnZhcyksWSh0aGlzLE10KS53aWR0aD1lLndpZHRoLFkodGhpcyxNdCkuaGVpZ2h0PWUuaGVpZ2h0LHRoaXMuY29uZmlnPWUub3B0aW9ucyxsdCh0aGlzLFR0LGduKFkodGhpcyxNdCkpKSxsdCh0aGlzLEplLEtuKHtlbmdpbmU6WSh0aGlzLFR0KX0pKSxsdCh0aGlzLGNzLFluKHtlbmdpbmU6WSh0aGlzLFR0KSxzY2VuZTpZKHRoaXMsSmUpfSkpLGx0KHRoaXMsQXQsQnIoe2VuYWJsZVNoYWRvd3M6dGhpcy5jb25maWcuZW5hYmxlU2hhZG93cyxzaGFkb3dUcmFuc3BhcmVuY3k6dGhpcy5jb25maWcuc2hhZG93VHJhbnNwYXJlbmN5LGludGVuc2l0eTp0aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSxzY2VuZTpZKHRoaXMsSmUpfSkpLGx0KHRoaXMsVmksbmV3IFJsKHtlbmFibGVTaGFkb3dzOnRoaXMuY29uZmlnLmVuYWJsZVNoYWRvd3MsYXNwZWN0OlkodGhpcyxNdCkud2lkdGgvWSh0aGlzLE10KS5oZWlnaHQsbGlnaHRzOlkodGhpcyxBdCksc2NlbmU6WSh0aGlzLEplKX0pKSxsdCh0aGlzLFdpLG5ldyBEbCh7c2NlbmU6WSh0aGlzLEplKX0pKSx0aGlzLm9uSW5pdENvbXBsZXRlKCl9Y29ubmVjdChlKXtsdCh0aGlzLGd0LGUpLFkodGhpcyxndCkucG9zdE1lc3NhZ2Uoe2FjdGlvbjoiaW5pdEJ1ZmZlciIsZGljZUJ1ZmZlcjp0aGlzLmRpY2VCdWZmZXJWaWV3LmJ1ZmZlcn0sW3RoaXMuZGljZUJ1ZmZlclZpZXcuYnVmZmVyXSksWSh0aGlzLGd0KS5vbm1lc3NhZ2U9dD0+e3N3aXRjaCh0LmRhdGEuYWN0aW9uKXtjYXNlInVwZGF0ZXMiOnRoaXMudXBkYXRlc0Zyb21QaHlzaWNzKHQuZGF0YS5kaWNlQnVmZmVyKTticmVhaztkZWZhdWx0OmNvbnNvbGUuZXJyb3IoImFjdGlvbiBmcm9tIHBoeXNpY3NXb3JrZXIgbm90IGZvdW5kIGluIG9mZnNjcmVlbiB3b3JrZXIiKTticmVha319fXVwZGF0ZUNvbmZpZyhlKXtjb25zdCB0PXRoaXMuY29uZmlnO3RoaXMuY29uZmlnPWUsdC5lbmFibGVTaGFkb3dzIT09dGhpcy5jb25maWcuZW5hYmxlU2hhZG93cyYmKE9iamVjdC52YWx1ZXMoWSh0aGlzLEF0KSkuZm9yRWFjaChpPT5pLmRpc3Bvc2UoKSksbHQodGhpcyxBdCxCcih7ZW5hYmxlU2hhZG93czp0aGlzLmNvbmZpZy5lbmFibGVTaGFkb3dzfSkpKSx0LnNjYWxlIT09dGhpcy5jb25maWcuc2NhbGUmJk9iamVjdC52YWx1ZXMoWSh0aGlzLFhlKSkuZm9yRWFjaCgoe21lc2g6aX0pPT57aSYmKGkuc2NhbGluZz1uZXcgcCh0aGlzLmNvbmZpZy5zY2FsZSx0aGlzLmNvbmZpZy5zY2FsZSx0aGlzLmNvbmZpZy5zY2FsZSkpfSksdC5zaGFkb3dUcmFuc3BhcmVuY3khPT10aGlzLmNvbmZpZy5zaGFkb3dUcmFuc3BhcmVuY3kmJihZKHRoaXMsQXQpLmRpcmVjdGlvbmFsLnNoYWRvd0dlbmVyYXRvci5kYXJrbmVzcz10aGlzLmNvbmZpZy5zaGFkb3dUcmFuc3BhcmVuY3kpLHQubGlnaHRJbnRlbnNpdHkhPT10aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSYmKFkodGhpcyxBdCkuZGlyZWN0aW9uYWwuaW50ZW5zaXR5PS42NSp0aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSxZKHRoaXMsQXQpLmhlbWlzcGhlcmljLmludGVuc2l0eT0uNCp0aGlzLmNvbmZpZy5saWdodEludGVuc2l0eSl9cmVuZGVyKGUpe1kodGhpcyxUdCkucnVuUmVuZGVyTG9vcCh0aGlzLnJlbmRlckxvb3AuYmluZCh0aGlzKSksWSh0aGlzLGd0KS5wb3N0TWVzc2FnZSh7YWN0aW9uOiJyZXN1bWVTaW11bGF0aW9uIixuZXdTdGFydFBvaW50OmV9KX1yZW5kZXJMb29wKCl7WSh0aGlzLEZ0KSYmWSh0aGlzLEZ0KT09PU9iamVjdC5rZXlzKFkodGhpcyxYZSkpLmxlbmd0aD8oWSh0aGlzLFR0KS5zdG9wUmVuZGVyTG9vcCgpLFkodGhpcyxndCkucG9zdE1lc3NhZ2Uoe2FjdGlvbjoic3RvcFNpbXVsYXRpb24ifSksdGhpcy5vblJvbGxDb21wbGV0ZSgpKTpZKHRoaXMsSmUpLnJlbmRlcigpfWFzeW5jIGxvYWRUaGVtZShlKXtjb25zdHt0aGVtZTp0LGJhc2VQYXRoOmksbWF0ZXJpYWw6cyxtZXNoRmlsZVBhdGg6cixtZXNoTmFtZTpufT1lO2lmKGF3YWl0IFkodGhpcyxXaSkubG9hZCh7dGhlbWU6dCxiYXNlUGF0aDppLG1hdGVyaWFsOnN9KSwhT2JqZWN0LmtleXMoWSh0aGlzLHppKSkuaW5jbHVkZXMobikpe1kodGhpcyx6aSlbbl09cjtjb25zdCBhPWF3YWl0IFB0LmxvYWRNb2RlbHMoe21lc2hGaWxlUGF0aDpyLG1lc2hOYW1lOm59LFkodGhpcyxKZSkpO2lmKCFhKXRocm93IG5ldyBFcnJvcigiTm8gY29sbGlkZXJzIHJldHVybmVkIGZyb20gdGhlIDNEIG1lc2ggZmlsZS4gTG93IHBvbHkgY29sbGlkZXJzIGFyZSBleHBlY3RlZCB0byBiZSBpbiB0aGUgc2FtZSBmaWxlIGFzIHRoZSBoaWdoIHBvbHkgZGljZSBhbmQgdGhlIG1lc2ggbmFtZSBjb250YWlucyB0aGUgd29yZCAnY29sbGlkZXInIik7WSh0aGlzLGd0KS5wb3N0TWVzc2FnZSh7YWN0aW9uOiJsb2FkTW9kZWxzIixvcHRpb25zOntjb2xsaWRlcnM6YSxtZXNoTmFtZTpufX0pfXRoaXMub25UaGVtZUxvYWRlZCh7aWQ6dH0pfWNsZWFyKCl7IU9iamVjdC5rZXlzKFkodGhpcyxYZSkpLmxlbmd0aCYmIVkodGhpcyxGdCl8fCh0aGlzLmRpY2VCdWZmZXJWaWV3LmJ5dGVMZW5ndGgmJnRoaXMuZGljZUJ1ZmZlclZpZXcuZmlsbCgwKSxZKHRoaXMsUmkpLmZvckVhY2goZT0+Y2xlYXJUaW1lb3V0KGUpKSxZKHRoaXMsVHQpLnN0b3BSZW5kZXJMb29wKCksT2JqZWN0LnZhbHVlcyhZKHRoaXMsWGUpKS5mb3JFYWNoKGU9PntlLm1lc2gmJmUubWVzaC5kaXNwb3NlKCl9KSxsdCh0aGlzLFhlLHt9KSxsdCh0aGlzLEFpLDApLGx0KHRoaXMsRnQsMCksWSh0aGlzLEplKS5yZW5kZXIoKSl9YWRkKGUpe1B0LmxvYWREaWUoZSxZKHRoaXMsSmUpKS50aGVuKHQ9PntZKHRoaXMsUmkpLnB1c2goc2V0VGltZW91dCgoKT0+e3pyKHRoaXMsdXMsR3IpLmNhbGwodGhpcyx0KX0seWkodGhpcyxBaSkuXysrKnRoaXMuY29uZmlnLmRlbGF5KSl9KX1hZGROb25EaWUoZSl7WSh0aGlzLFR0KS5hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg9PT0wJiZ0aGlzLnJlbmRlcighMSk7Y29uc3R7aWQ6dCx2YWx1ZTppLC4uLnN9PWUscj17aWQ6dCx2YWx1ZTppLGNvbmZpZzpzfTtZKHRoaXMsWGUpW3RdPXIsc2V0VGltZW91dCgoKT0+e1kodGhpcyxSaSkucHVzaChzZXRUaW1lb3V0KCgpPT57dGhpcy5oYW5kbGVBc2xlZXAocil9LHlpKHRoaXMsQWkpLl8rKyp0aGlzLmNvbmZpZy5kZWxheSkpfSwxMCl9cmVtb3ZlKGUpe2NvbnN0IHQ9WSh0aGlzLFhlKVtlLmlkXTt0Lmhhc093blByb3BlcnR5KCJkMTBJbnN0YW5jZSIpJiYoWSh0aGlzLFhlKVt0LmQxMEluc3RhbmNlLmlkXS5tZXNoJiYoWSh0aGlzLFhlKVt0LmQxMEluc3RhbmNlLmlkXS5tZXNoLmRpc3Bvc2UoKSxZKHRoaXMsZ3QpLnBvc3RNZXNzYWdlKHthY3Rpb246InJlbW92ZURpZSIsaWQ6dC5kMTBJbnN0YW5jZS5pZH0pKSxkZWxldGUgWSh0aGlzLFhlKVt0LmQxMEluc3RhbmNlLmlkXSx5aSh0aGlzLEZ0KS5fLS0pLFkodGhpcyxYZSlbZS5pZF0ubWVzaCYmWSh0aGlzLFhlKVtlLmlkXS5tZXNoLmRpc3Bvc2UoKSxkZWxldGUgWSh0aGlzLFhlKVtlLmlkXSx5aSh0aGlzLEZ0KS5fLS0sWSh0aGlzLEplKS5yZW5kZXIoKSx0aGlzLm9uRGllUmVtb3ZlZChlLnJvbGxJZCl9dXBkYXRlc0Zyb21QaHlzaWNzKGUpe3RoaXMuZGljZUJ1ZmZlclZpZXc9bmV3IEZsb2F0MzJBcnJheShlKTtsZXQgdD0xO2ZvcihsZXQgaT0wLHM9dGhpcy5kaWNlQnVmZmVyVmlld1swXTtpPHM7aSsrKXtpZighT2JqZWN0LmtleXMoWSh0aGlzLFhlKSkubGVuZ3RoKWNvbnRpbnVlO2NvbnN0IHI9WSh0aGlzLFhlKVtgJHt0aGlzLmRpY2VCdWZmZXJWaWV3W3RdfWBdO2lmKCFyKXtjb25zb2xlLmxvZygiRXJyb3I6IGRpZSBub3QgYXZhaWxhYmxlIGluIHNjZW5lIHRvIGFuaW1hdGUiKTticmVha31pZih0aGlzLmRpY2VCdWZmZXJWaWV3W3QrMV09PT0tMSl0aGlzLmhhbmRsZUFzbGVlcChyKTtlbHNle2NvbnN0IG49dGhpcy5kaWNlQnVmZmVyVmlld1t0KzFdLGE9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzJdLG89dGhpcy5kaWNlQnVmZmVyVmlld1t0KzNdLGg9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzRdLGw9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzVdLHU9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzZdLGQ9dGhpcy5kaWNlQnVmZmVyVmlld1t0KzddO3IubWVzaC5wb3NpdGlvbi5zZXQobixhLG8pLHIubWVzaC5yb3RhdGlvblF1YXRlcm5pb24uc2V0KGgsbCx1LGQpfXQ9dCs4fXJlcXVlc3RBbmltYXRpb25GcmFtZSgoKT0+e1kodGhpcyxndCkucG9zdE1lc3NhZ2Uoe2FjdGlvbjoic3RlcFNpbXVsYXRpb24iLGRpY2VCdWZmZXI6dGhpcy5kaWNlQnVmZmVyVmlldy5idWZmZXJ9LFt0aGlzLmRpY2VCdWZmZXJWaWV3LmJ1ZmZlcl0pfSl9YXN5bmMgaGFuZGxlQXNsZWVwKGUpe3ZhciB0LGk7aWYoZS5hc2xlZXA9ITAsYXdhaXQgUHQuZ2V0Um9sbFJlc3VsdChlLFkodGhpcyxKZSkpLGUuZDEwSW5zdGFuY2V8fGUuZGllUGFyZW50KXtpZigodD1lPT1udWxsP3ZvaWQgMDplLmQxMEluc3RhbmNlKSE9bnVsbCYmdC5hc2xlZXB8fChpPWU9PW51bGw/dm9pZCAwOmUuZGllUGFyZW50KSE9bnVsbCYmaS5hc2xlZXApe2NvbnN0IHM9ZS5jb25maWcuc2lkZXM9PT0xMDA/ZTplLmRpZVBhcmVudCxyPWUuY29uZmlnLnNpZGVzPT09MTA/ZTplLmQxMEluc3RhbmNlO3IudmFsdWU9PT0wJiZzLnZhbHVlPT09MD9zLnZhbHVlPTEwMDpzLnZhbHVlPXMudmFsdWUrci52YWx1ZSx0aGlzLm9uUm9sbFJlc3VsdCh7cm9sbElkOnMuY29uZmlnLnJvbGxJZCx2YWx1ZTpzLnZhbHVlfSl9fWVsc2UgZS5jb25maWcuc2lkZXM9PT0xMCYmZS52YWx1ZT09PTAmJihlLnZhbHVlPTEwKSx0aGlzLm9uUm9sbFJlc3VsdCh7cm9sbElkOmUuY29uZmlnLnJvbGxJZCx2YWx1ZTplLnZhbHVlfSk7eWkodGhpcyxGdCkuXysrfXJlc2l6ZShlKXtjb25zdCB0PVkodGhpcyxNdCkud2lkdGg9ZS53aWR0aCxpPVkodGhpcyxNdCkuaGVpZ2h0PWUuaGVpZ2h0O1kodGhpcyxWaSkuY3JlYXRlKHthc3BlY3Q6dC9pfSksWSh0aGlzLFR0KS5yZXNpemUoKX19WGU9bmV3IFdlYWtNYXAsQWk9bmV3IFdlYWtNYXAsRnQ9bmV3IFdlYWtNYXAsUmk9bmV3IFdlYWtNYXAsTXQ9bmV3IFdlYWtNYXAsVHQ9bmV3IFdlYWtNYXAsSmU9bmV3IFdlYWtNYXAsY3M9bmV3IFdlYWtNYXAsQXQ9bmV3IFdlYWtNYXAsVmk9bmV3IFdlYWtNYXAsV2k9bmV3IFdlYWtNYXAsZ3Q9bmV3IFdlYWtNYXAsemk9bmV3IFdlYWtNYXAsdXM9bmV3IFdlYWtTZXQsR3I9YXN5bmMgZnVuY3Rpb24oZSl7WSh0aGlzLFR0KS5hY3RpdmVSZW5kZXJMb29wcy5sZW5ndGg9PT0wJiZ0aGlzLnJlbmRlcihlLm5ld1N0YXJ0UG9pbnQpO2NvbnN0IHQ9ey4uLmUsYXNzZXRQYXRoOnRoaXMuY29uZmlnLmFzc2V0UGF0aCxlbmFibGVTaGFkb3dzOnRoaXMuY29uZmlnLmVuYWJsZVNoYWRvd3Msc2NhbGU6dGhpcy5jb25maWcuc2NhbGUsbGlnaHRzOlkodGhpcyxBdCl9LGk9bmV3IFB0KHQsWSh0aGlzLEplKSk7cmV0dXJuIFkodGhpcyxYZSlbaS5pZF09aSxZKHRoaXMsZ3QpLnBvc3RNZXNzYWdlKHthY3Rpb246ImFkZERpZSIsb3B0aW9uczp7c2lkZXM6ZS5zaWRlcyxzY2FsZTp0aGlzLmNvbmZpZy5zY2FsZSxpZDppLmlkLG5ld1N0YXJ0UG9pbnQ6ZS5uZXdTdGFydFBvaW50LHRoZW1lOmUudGhlbWUsbWVzaE5hbWU6ZS5tZXNoTmFtZX19KSxlLnNpZGVzPT09MTAwJiZlLmRhdGEhPT0ic2luZ2xlIiYmKGkuZDEwSW5zdGFuY2U9YXdhaXQgUHQubG9hZERpZSh7Li4udCxkaWVUeXBlOiJkMTAiLHNpZGVzOjEwLGlkOmkuaWQrMWU0fSxZKHRoaXMsSmUpKS50aGVuKHM9Pntjb25zdCByPW5ldyBQdChzLFkodGhpcyxKZSkpO3JldHVybiByLmRpZVBhcmVudD1pLHJ9KSxZKHRoaXMsWGUpW2Ake2kuZDEwSW5zdGFuY2UuaWR9YF09aS5kMTBJbnN0YW5jZSxZKHRoaXMsZ3QpLnBvc3RNZXNzYWdlKHthY3Rpb246ImFkZERpZSIsb3B0aW9uczp7c2lkZXM6MTAsc2NhbGU6dGhpcy5jb25maWcuc2NhbGUsaWQ6aS5kMTBJbnN0YW5jZS5pZCx0aGVtZTplLnRoZW1lLG1lc2hOYW1lOmUubWVzaE5hbWV9fSkpLGl9O2xldCBEdDtzZWxmLm9ubWVzc2FnZT1hc3luYyBjPT57c3dpdGNoKGMuZGF0YS5hY3Rpb24pe2Nhc2Uicm9sbERpZSI6RHQucGh5c2ljc1dvcmtlclBvcnQucG9zdE1lc3NhZ2Uoe2FjdGlvbjoicm9sbCJ9KTticmVhaztjYXNlImFkZERpZSI6RHQuYWRkKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImFkZE5vbkRpZSI6RHQuYWRkTm9uRGllKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImxvYWRUaGVtZSI6YXdhaXQgRHQubG9hZFRoZW1lKGMuZGF0YS5vcHRpb25zKS5jYXRjaChlPT5jb25zb2xlLmVycm9yKGUpKTticmVhaztjYXNlImNsZWFyRGljZSI6RHQuY2xlYXIoKTticmVhaztjYXNlInJlbW92ZURpZSI6RHQucmVtb3ZlKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlInJlc2l6ZSI6RHQucmVzaXplKGMuZGF0YS5vcHRpb25zKTticmVhaztjYXNlImluaXQiOkR0PW5ldyBGbCh7Li4uYy5kYXRhLG9uSW5pdENvbXBsZXRlOigpPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJpbml0LWNvbXBsZXRlIn0pfSxvblRoZW1lTG9hZGVkOih7aWQ6ZX0pPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJ0aGVtZS1sb2FkZWQiLGlkOmV9KX0sb25Sb2xsUmVzdWx0Oih7cm9sbElkOmUsdmFsdWU6dH0pPT57c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJyb2xsLXJlc3VsdCIsZGllOntyb2xsSWQ6ZSx2YWx1ZTp0fX0pfSxvblJvbGxDb21wbGV0ZTooKT0+e3NlbGYucG9zdE1lc3NhZ2Uoe2FjdGlvbjoicm9sbC1jb21wbGV0ZSJ9KX0sb25EaWVSZW1vdmVkOmU9PntzZWxmLnBvc3RNZXNzYWdlKHthY3Rpb246ImRpZS1yZW1vdmVkIixyb2xsSWQ6ZX0pfX0pO2JyZWFrO2Nhc2UidXBkYXRlQ29uZmlnIjpEdC51cGRhdGVDb25maWcoYy5kYXRhLm9wdGlvbnMpO2JyZWFrO2Nhc2UiY29ubmVjdCI6RHQuY29ubmVjdChjLmRhdGEucG9ydCksc2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOiJjb25uZWN0LWNvbXBsZXRlIn0pO2JyZWFrO2RlZmF1bHQ6Y29uc29sZS5lcnJvcigiYWN0aW9uIG5vdCBmb3VuZCBpbiBvZmZzY3JlZW4gd29ya2VyIil9fX0pKCk7Cg==",y$$module$libs$world_offscreen=
"u">typeof window&&window.Blob&&new Blob([atob(p$$module$libs$world_offscreen)],{type:"text/javascript;charset=utf-8"});function N$$module$libs$world_offscreen(){const a=y$$module$libs$world_offscreen&&(window.URL||window.webkitURL).createObjectURL(y$$module$libs$world_offscreen);try{return a?new Worker(a):new Worker("data:application/javascript;base64,"+p$$module$libs$world_offscreen)}finally{a&&(window.URL||window.webkitURL).revokeObjectURL(a)}}
var b$$module$libs$world_offscreen,G$$module$libs$world_offscreen,W$$module$libs$world_offscreen,Y$$module$libs$world_offscreen;
class L$$module$libs$world_offscreen{constructor(a){m$$module$libs$world_offscreen(this,W$$module$libs$world_offscreen);d$$module$libs$world_offscreen(this,"initialized",!1);d$$module$libs$world_offscreen(this,"offscreenWorkerInit",!1);d$$module$libs$world_offscreen(this,"themeLoadedInit",!1);d$$module$libs$world_offscreen(this,"pendingThemePromises",{});m$$module$libs$world_offscreen(this,b$$module$libs$world_offscreen,void 0);m$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen,void 0);
d$$module$libs$world_offscreen(this,"onRollResult",()=>{});d$$module$libs$world_offscreen(this,"onRollComplete",()=>{});this.onInitComplete=a.onInitComplete;h$$module$libs$world_offscreen(this,b$$module$libs$world_offscreen,a.canvas.transferControlToOffscreen());h$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen,new N$$module$libs$world_offscreen);V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).init=new Promise((b,c)=>{this.offscreenWorkerInit=b});this.initialized=
a$$module$libs$world_offscreen(this,W$$module$libs$world_offscreen,Y$$module$libs$world_offscreen).call(this,a)}connect(a){V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"connect",port:a},[a])}updateConfig(a){V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"updateConfig",options:a})}resize(a){V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"resize",options:a})}async loadTheme(a){return(new Promise((b,
c)=>{if(Object.keys(this.pendingThemePromises).includes(a.theme))return b();this.pendingThemePromises[a.theme]=b;V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"loadTheme",options:a})})).catch(b=>console.error(b))}clear(){V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"clearDice"})}add(a){V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"addDie",options:a})}addNonDie(a){V$$module$libs$world_offscreen(this,
G$$module$libs$world_offscreen).postMessage({action:"addNonDie",options:a})}remove(a){V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"removeDie",options:a})}}b$$module$libs$world_offscreen=new WeakMap;G$$module$libs$world_offscreen=new WeakMap;W$$module$libs$world_offscreen=new WeakSet;
Y$$module$libs$world_offscreen=async function(a){return V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).postMessage({action:"init",canvas:V$$module$libs$world_offscreen(this,b$$module$libs$world_offscreen),width:a.canvas.clientWidth,height:a.canvas.clientHeight,options:a.options},[V$$module$libs$world_offscreen(this,b$$module$libs$world_offscreen)]),V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).onmessage=b=>{switch(b.data.action){case "init-complete":this.offscreenWorkerInit();
break;case "theme-loaded":b.data.id&&this.pendingThemePromises[b.data.id](b.data.id);break;case "roll-result":this.onRollResult(b.data.die);break;case "roll-complete":this.onRollComplete();break;case "die-removed":this.onDieRemoved(b.data.rollId)}},await V$$module$libs$world_offscreen(this,G$$module$libs$world_offscreen).init,this.onInitComplete(!0),!0};var module$libs$world_offscreen={};module$libs$world_offscreen.default=L$$module$libs$world_offscreen;var Hr$$module$libs$world_onscreen=Object.defineProperty,Kr$$module$libs$world_onscreen=(a,b,c)=>b in a?Hr$$module$libs$world_onscreen(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,gt$$module$libs$world_onscreen=(a,b,c)=>(Kr$$module$libs$world_onscreen(a,"symbol"!=typeof b?b+"":b,c),c),Ts$$module$libs$world_onscreen=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c);},K$$module$libs$world_onscreen=(a,b,c)=>(Ts$$module$libs$world_onscreen(a,b,"read from private field"),c?c.call(a):
b.get(a)),et$$module$libs$world_onscreen=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},nt$$module$libs$world_onscreen=(a,b,c,d)=>(Ts$$module$libs$world_onscreen(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c),_i$$module$libs$world_onscreen=(a,b,c,d)=>({set _(e){nt$$module$libs$world_onscreen(a,b,e,c)},get _(){return K$$module$libs$world_onscreen(a,b,d)}}),js$$module$libs$world_onscreen=(a,b,c)=>(Ts$$module$libs$world_onscreen(a,
b,"access private method"),c);
class ne$$module$libs$world_onscreen{static WithinEpsilon(a,b,c=1.401298E-45){return Math.abs(a-b)<=c}static ToHex(a){const b=a.toString(16);return 15>=a?("0"+b).toUpperCase():b.toUpperCase()}static Sign(a){return a=+a,0===a||isNaN(a)?a:0<a?1:-1}static Clamp(a,b=0,c=1){return Math.min(c,Math.max(b,a))}static Log2(a){return Math.log(a)*Math.LOG2E}static ILog2(a){if(Math.log2)return Math.floor(Math.log2(a));if(0>a)return NaN;if(0===a)return-1/0;let b=0;if(1>a){for(;1>a;)b++,a*=2;b=-b}else if(1<a)for(;1<
a;)b++,a=Math.floor(a/2);return b}static Repeat(a,b){return a-Math.floor(a/b)*b}static Normalize(a,b,c){return(a-b)/(c-b)}static Denormalize(a,b,c){return a*(c-b)+b}static DeltaAngle(a,b){a=ne$$module$libs$world_onscreen.Repeat(b-a,360);return 180<a&&(a-=360),a}static PingPong(a,b){a=ne$$module$libs$world_onscreen.Repeat(a,2*b);return b-Math.abs(a-b)}static SmoothStep(a,b,c){c=ne$$module$libs$world_onscreen.Clamp(c);return c=-2*c*c*c+3*c*c,b*c+a*(1-c)}static MoveTowards(a,b,c){let d=0;return Math.abs(b-
a)<=c?d=b:d=a+ne$$module$libs$world_onscreen.Sign(b-a)*c,d}static MoveTowardsAngle(a,b,c){const d=ne$$module$libs$world_onscreen.DeltaAngle(a,b);let e=0;return-c<d&&d<c?e=b:(b=a+d,e=ne$$module$libs$world_onscreen.MoveTowards(a,b,c)),e}static Lerp(a,b,c){return a+(b-a)*c}static LerpAngle(a,b,c){b=ne$$module$libs$world_onscreen.Repeat(b-a,360);return 180<b&&(b-=360),a+b*ne$$module$libs$world_onscreen.Clamp(c)}static InverseLerp(a,b,c){let d=0;return a!=b?d=ne$$module$libs$world_onscreen.Clamp((c-a)/
(b-a)):d=0,d}static Hermite(a,b,c,d,e){const g=e*e,n=e*g;return a*(2*n-3*g+1)+c*(-2*n+3*g)+b*(n-2*g+e)+d*(n-g)}static Hermite1stDerivative(a,b,c,d,e){const g=e*e;return 6*(g-e)*a+(3*g-4*e+1)*b+6*(-g+e)*c+(3*g-2*e)*d}static RandomRange(a,b){return a===b?a:Math.random()*(b-a)+a}static RangeToPercent(a,b,c){return(a-b)/(c-b)}static PercentToRange(a,b,c){return(c-b)*a+b}static NormalizeRadians(a){return a-=ne$$module$libs$world_onscreen.TwoPi*Math.floor((a+Math.PI)/ne$$module$libs$world_onscreen.TwoPi),
a}static HCF(a,b){a%=b;return 0===a?b:ne$$module$libs$world_onscreen.HCF(b,a)}}ne$$module$libs$world_onscreen.TwoPi=2*Math.PI;const Ti$$module$libs$world_onscreen=1/2.2,bi$$module$libs$world_onscreen=2.2,Re$$module$libs$world_onscreen=.001;class Ye$$module$libs$world_onscreen{static BuildArray(a,b){const c=[];for(let d=0;d<a;++d)c.push(b());return c}static BuildTuple(a,b){return Ye$$module$libs$world_onscreen.BuildArray(a,b)}}
function Yr$$module$libs$world_onscreen(a,b,c){const d=a[b];if("function"!=typeof d)return null;const e=function(){const g=a.length,n=e.previous.apply(a,arguments);return c(b,g),n};return d.next=e,e.previous=d,a[b]=e,()=>{const g=e.previous;if(g){var n=e.next;n?(g.next=n,n.previous=g):(g.next=void 0,a[b]=g);e.next=void 0;e.previous=void 0}}}const Zr$$module$libs$world_onscreen=["push","splice","pop","shift","unshift"];
function br$$module$libs$world_onscreen(a,b){const c=Zr$$module$libs$world_onscreen.map(d=>Yr$$module$libs$world_onscreen(a,d,b));return()=>{c.forEach(d=>{null==d||d()})}}const Sr$$module$libs$world_onscreen={};function st$$module$libs$world_onscreen(a,b){Sr$$module$libs$world_onscreen[a]=b}function ci$$module$libs$world_onscreen(a){return Sr$$module$libs$world_onscreen[a]}
class Ne$$module$libs$world_onscreen{static SetMatrixPrecision(a){if(Ne$$module$libs$world_onscreen.MatrixTrackPrecisionChange=!1,a&&!Ne$$module$libs$world_onscreen.MatrixUse64Bits&&Ne$$module$libs$world_onscreen.MatrixTrackedMatrices)for(let b=0;b<Ne$$module$libs$world_onscreen.MatrixTrackedMatrices.length;++b){const c=Ne$$module$libs$world_onscreen.MatrixTrackedMatrices[b],d=c._m;c._m=Array(16);for(let e=0;16>e;++e)c._m[e]=d[e]}Ne$$module$libs$world_onscreen.MatrixUse64Bits=a;Ne$$module$libs$world_onscreen.MatrixCurrentType=
Ne$$module$libs$world_onscreen.MatrixUse64Bits?Array:Float32Array;Ne$$module$libs$world_onscreen.MatrixTrackedMatrices=null}}Ne$$module$libs$world_onscreen.MatrixUse64Bits=!1;Ne$$module$libs$world_onscreen.MatrixTrackPrecisionChange=!0;Ne$$module$libs$world_onscreen.MatrixCurrentType=Float32Array;Ne$$module$libs$world_onscreen.MatrixTrackedMatrices=[];
class fe$$module$libs$world_onscreen{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}fe$$module$libs$world_onscreen.Instances=[];fe$$module$libs$world_onscreen._LastCreatedScene=null;fe$$module$libs$world_onscreen.UseFallbackTexture=!0;fe$$module$libs$world_onscreen.FallbackTexture="";const it$$module$libs$world_onscreen=a=>parseInt(a.toString().replace(/\W/g,""));
class Te$$module$libs$world_onscreen{constructor(a=0,b=0){this.x=a;this.y=b}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){var a=it$$module$libs$world_onscreen(this.x);const b=it$$module$libs$world_onscreen(this.y);return a=397*a^b,a}toArray(a,b=0){return a[b]=this.x,a[b+1]=this.y,this}fromArray(a,b=0){return Te$$module$libs$world_onscreen.FromArrayToRef(a,b,this),this}asArray(){const a=[];return this.toArray(a,0),a}copyFrom(a){return this.x=a.x,this.y=
a.y,this}copyFromFloats(a,b){return this.x=a,this.y=b,this}set(a,b){return this.copyFromFloats(a,b)}add(a){return new this.constructor(this.x+a.x,this.y+a.y)}addToRef(a,b){return b.x=this.x+a.x,b.y=this.y+a.y,b}addInPlace(a){return this.x+=a.x,this.y+=a.y,this}addVector3(a){return new this.constructor(this.x+a.x,this.y+a.y)}subtract(a){return new this.constructor(this.x-a.x,this.y-a.y)}subtractToRef(a,b){return b.x=this.x-a.x,b.y=this.y-a.y,b}subtractInPlace(a){return this.x-=a.x,this.y-=a.y,this}multiplyInPlace(a){return this.x*=
a.x,this.y*=a.y,this}multiply(a){return new this.constructor(this.x*a.x,this.y*a.y)}multiplyToRef(a,b){return b.x=this.x*a.x,b.y=this.y*a.y,b}multiplyByFloats(a,b){return new this.constructor(this.x*a,this.y*b)}divide(a){return new this.constructor(this.x/a.x,this.y/a.y)}divideToRef(a,b){return b.x=this.x/a.x,b.y=this.y/a.y,b}divideInPlace(a){return this.divideToRef(a,this)}negate(){return new this.constructor(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(a){return a.copyFromFloats(-1*
this.x,-1*this.y)}scaleInPlace(a){return this.x*=a,this.y*=a,this}scale(a){const b=new this.constructor(0,0);return this.scaleToRef(a,b),b}scaleToRef(a,b){return b.x=this.x*a,b.y=this.y*a,b}scaleAndAddToRef(a,b){return b.x+=this.x*a,b.y+=this.y*a,b}equals(a){return a&&this.x===a.x&&this.y===a.y}equalsWithEpsilon(a,b=Re$$module$libs$world_onscreen){return a&&ne$$module$libs$world_onscreen.WithinEpsilon(this.x,a.x,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this.y,a.y,b)}floor(){return new this.constructor(Math.floor(this.x),
Math.floor(this.y))}fract(){return new this.constructor(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotateToRef(a,b){const c=Math.cos(a);a=Math.sin(a);return b.x=c*this.x-a*this.y,b.y=a*this.x+c*this.y,b}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Te$$module$libs$world_onscreen.NormalizeToRef(this,this),this}clone(){return new this.constructor(this.x,this.y)}static Zero(){return new Te$$module$libs$world_onscreen(0,
0)}static One(){return new Te$$module$libs$world_onscreen(1,1)}static get ZeroReadOnly(){return Te$$module$libs$world_onscreen._ZeroReadOnly}static FromArray(a,b=0){return new Te$$module$libs$world_onscreen(a[b],a[b+1])}static FromArrayToRef(a,b,c){return c.x=a[b],c.y=a[b+1],c}static CatmullRom(a,b,c,d,e){const g=e*e,n=e*g;return new a.constructor(.5*(2*b.x+(-a.x+c.x)*e+(2*a.x-5*b.x+4*c.x-d.x)*g+(-a.x+3*b.x-3*c.x+d.x)*n),.5*(2*b.y+(-a.y+c.y)*e+(2*a.y-5*b.y+4*c.y-d.y)*g+(-a.y+3*b.y-3*c.y+d.y)*n))}static Clamp(a,
b,c){let d=a.x;d=d>c.x?c.x:d;d=d<b.x?b.x:d;let e=a.y;return e=e>c.y?c.y:e,e=e<b.y?b.y:e,new a.constructor(d,e)}static Hermite(a,b,c,d,e){var g=e*e;const n=e*g,t=2*n-3*g+1,w=-2*n+3*g;e=n-2*g+e;g=n-g;return new a.constructor(a.x*t+c.x*w+b.x*e+d.x*g,a.y*t+c.y*w+b.y*e+d.y*g)}static Hermite1stDerivative(a,b,c,d,e){const g=new a.constructor;return this.Hermite1stDerivativeToRef(a,b,c,d,e,g),g}static Hermite1stDerivativeToRef(a,b,c,d,e,g){const n=e*e;return g.x=6*(n-e)*a.x+(3*n-4*e+1)*b.x+6*(-n+e)*c.x+(3*
n-2*e)*d.x,g.y=6*(n-e)*a.y+(3*n-4*e+1)*b.y+6*(-n+e)*c.y+(3*n-2*e)*d.y,g}static Lerp(a,b,c){return new a.constructor(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c)}static Dot(a,b){return a.x*b.x+a.y*b.y}static Normalize(a){const b=new a.constructor;return this.NormalizeToRef(a,b),b}static NormalizeToRef(a,b){const c=a.length();return 0===c||(b.x=a.x/c,b.y=a.y/c),b}static Minimize(a,b){return new a.constructor(a.x<b.x?a.x:b.x,a.y<b.y?a.y:b.y)}static Maximize(a,b){return new a.constructor(a.x>b.x?a.x:b.x,a.y>b.y?
a.y:b.y)}static Transform(a,b){const c=new a.constructor;return Te$$module$libs$world_onscreen.TransformToRef(a,b,c),c}static TransformToRef(a,b,c){b=b.m;const d=a.x*b[1]+a.y*b[5]+b[13];return c.x=a.x*b[0]+a.y*b[4]+b[12],c.y=d,c}static PointInTriangle(a,b,c,d){const e=.5*(-c.y*d.x+b.y*(-c.x+d.x)+b.x*(c.y-d.y)+c.x*d.y),g=0>e?-1:1;d=(b.y*d.x-b.x*d.y+(d.y-b.y)*a.x+(b.x-d.x)*a.y)*g;a=(b.x*c.y-b.y*c.x+(b.y-c.y)*a.x+(c.x-b.x)*a.y)*g;return 0<d&&0<a&&d+a<2*e*g}static Distance(a,b){return Math.sqrt(Te$$module$libs$world_onscreen.DistanceSquared(a,
b))}static DistanceSquared(a,b){const c=a.x-b.x;a=a.y-b.y;return c*c+a*a}static Center(a,b){const c=new a.constructor;return Te$$module$libs$world_onscreen.CenterToRef(a,b,c)}static CenterToRef(a,b,c){return c.copyFromFloats((a.x+b.x)/2,(a.y+b.y)/2)}static DistanceOfPointFromSegment(a,b,c){var d=Te$$module$libs$world_onscreen.DistanceSquared(b,c);if(0===d)return Te$$module$libs$world_onscreen.Distance(a,b);c=c.subtract(b);d=Math.max(0,Math.min(1,Te$$module$libs$world_onscreen.Dot(a.subtract(b),c)/
d));b=b.add(c.multiplyByFloats(d,d));return Te$$module$libs$world_onscreen.Distance(a,b)}}Te$$module$libs$world_onscreen._ZeroReadOnly=Te$$module$libs$world_onscreen.Zero();
class p$$module$libs$world_onscreen{constructor(a=0,b=0,c=0){this._isDirty=!0;this._x=a;this._y=b;this._z=c}get x(){return this._x}set x(a){this._x=a;this._isDirty=!0}get y(){return this._y}set y(a){this._y=a;this._isDirty=!0}get z(){return this._z}set z(a){this._z=a;this._isDirty=!0}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z}}`}getClassName(){return"Vector3"}getHashCode(){var a=it$$module$libs$world_onscreen(this._x);const b=it$$module$libs$world_onscreen(this._y),c=it$$module$libs$world_onscreen(this._z);
return a=397*a^b,a=397*a^c,a}asArray(){const a=[];return this.toArray(a,0),a}toArray(a,b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,this}fromArray(a,b=0){return p$$module$libs$world_onscreen.FromArrayToRef(a,b,this),this}toQuaternion(){return Y$$module$libs$world_onscreen.RotationYawPitchRoll(this._y,this._x,this._z)}addInPlace(a){return this.addInPlaceFromFloats(a._x,a._y,a._z)}addInPlaceFromFloats(a,b,c){return this.x+=a,this.y+=b,this.z+=c,this}add(a){return new this.constructor(this._x+
a._x,this._y+a._y,this._z+a._z)}addToRef(a,b){return b.copyFromFloats(this._x+a._x,this._y+a._y,this._z+a._z)}subtractInPlace(a){return this.x-=a._x,this.y-=a._y,this.z-=a._z,this}subtract(a){return new this.constructor(this._x-a._x,this._y-a._y,this._z-a._z)}subtractToRef(a,b){return this.subtractFromFloatsToRef(a._x,a._y,a._z,b)}subtractFromFloats(a,b,c){return new this.constructor(this._x-a,this._y-b,this._z-c)}subtractFromFloatsToRef(a,b,c,d){return d.copyFromFloats(this._x-a,this._y-b,this._z-
c)}negate(){return new this.constructor(-this._x,-this._y,-this._z)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}negateToRef(a){return a.copyFromFloats(-1*this._x,-1*this._y,-1*this._z)}scaleInPlace(a){return this.x*=a,this.y*=a,this.z*=a,this}scale(a){return new this.constructor(this._x*a,this._y*a,this._z*a)}scaleToRef(a,b){return b.copyFromFloats(this._x*a,this._y*a,this._z*a)}getNormalToRef(a){const b=this.length();let c=Math.acos(this.y/b);const d=Math.atan2(this.z,this.x);c>
Math.PI/2?c-=Math.PI/2:c+=Math.PI/2;return a.set(b*Math.sin(c)*Math.cos(d),b*Math.cos(c),b*Math.sin(c)*Math.sin(d)),a}applyRotationQuaternionToRef(a,b){const c=a.w*this.x+a.y*this.z-a.z*this.y,d=a.w*this.y+a.z*this.x-a.x*this.z,e=a.w*this.z+a.x*this.y-a.y*this.x,g=-a.x*this.x-a.y*this.y-a.z*this.z;return b.x=c*a.w+g*-a.x+d*-a.z-e*-a.y,b.y=d*a.w+g*-a.y+e*-a.x-c*-a.z,b.z=e*a.w+g*-a.z+c*-a.y-d*-a.x,b}applyRotationQuaternionInPlace(a){return this.applyRotationQuaternionToRef(a,this)}applyRotationQuaternion(a){return this.applyRotationQuaternionToRef(a,
new this.constructor)}scaleAndAddToRef(a,b){return b.addInPlaceFromFloats(this._x*a,this._y*a,this._z*a)}projectOnPlane(a,b){const c=new this.constructor;return this.projectOnPlaneToRef(a,b,c),c}projectOnPlaneToRef(a,b,c){var d=a.normal;const e=a.d;a=H$$module$libs$world_onscreen.Vector3[0];this.subtractToRef(b,a);a.normalize();const g=p$$module$libs$world_onscreen.Dot(a,d);Math.abs(g)<Math.pow(10,-10)?c.setAll(1/0):(d=-(p$$module$libs$world_onscreen.Dot(b,d)+e)/g,d=a.scaleInPlace(d),b.addToRef(d,
c));return c}equals(a){return a&&this._x===a._x&&this._y===a._y&&this._z===a._z}equalsWithEpsilon(a,b=Re$$module$libs$world_onscreen){return a&&ne$$module$libs$world_onscreen.WithinEpsilon(this._x,a._x,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this._y,a._y,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this._z,a._z,b)}equalsToFloats(a,b,c){return this._x===a&&this._y===b&&this._z===c}multiplyInPlace(a){return this.x*=a._x,this.y*=a._y,this.z*=a._z,this}multiply(a){return this.multiplyByFloats(a._x,
a._y,a._z)}multiplyToRef(a,b){return b.copyFromFloats(this._x*a._x,this._y*a._y,this._z*a._z)}multiplyByFloats(a,b,c){return new this.constructor(this._x*a,this._y*b,this._z*c)}divide(a){return new this.constructor(this._x/a._x,this._y/a._y,this._z/a._z)}divideToRef(a,b){return b.copyFromFloats(this._x/a._x,this._y/a._y,this._z/a._z)}divideInPlace(a){return this.divideToRef(a,this)}minimizeInPlace(a){return this.minimizeInPlaceFromFloats(a._x,a._y,a._z)}maximizeInPlace(a){return this.maximizeInPlaceFromFloats(a._x,
a._y,a._z)}minimizeInPlaceFromFloats(a,b,c){return a<this._x&&(this.x=a),b<this._y&&(this.y=b),c<this._z&&(this.z=c),this}maximizeInPlaceFromFloats(a,b,c){return a>this._x&&(this.x=a),b>this._y&&(this.y=b),c>this._z&&(this.z=c),this}isNonUniformWithinEpsilon(a){const b=Math.abs(this._x),c=Math.abs(this._y);if(!ne$$module$libs$world_onscreen.WithinEpsilon(b,c,a))return!0;const d=Math.abs(this._z);return!ne$$module$libs$world_onscreen.WithinEpsilon(b,d,a)||!ne$$module$libs$world_onscreen.WithinEpsilon(c,
d,a)}get isNonUniform(){const a=Math.abs(this._x);return a!==Math.abs(this._y)?!0:a!==Math.abs(this._z)}floor(){return new this.constructor(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))}fract(){return new this.constructor(this._x-Math.floor(this._x),this._y-Math.floor(this._y),this._z-Math.floor(this._z))}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z}get hasAZeroComponent(){return 0===
this._x*this._y*this._z}normalize(){return this.normalizeFromLength(this.length())}reorderInPlace(a){return a=a.toLowerCase(),"xyz"===a?this:(H$$module$libs$world_onscreen.Vector3[0].copyFrom(this),["x","y","z"].forEach((b,c)=>{this[b]=H$$module$libs$world_onscreen.Vector3[0][a[c]]}),this)}rotateByQuaternionToRef(a,b){return a.toRotationMatrix(H$$module$libs$world_onscreen.Matrix[0]),p$$module$libs$world_onscreen.TransformCoordinatesToRef(this,H$$module$libs$world_onscreen.Matrix[0],b),b}rotateByQuaternionAroundPointToRef(a,
b,c){return this.subtractToRef(b,H$$module$libs$world_onscreen.Vector3[0]),H$$module$libs$world_onscreen.Vector3[0].rotateByQuaternionToRef(a,H$$module$libs$world_onscreen.Vector3[0]),b.addToRef(H$$module$libs$world_onscreen.Vector3[0],c),c}cross(a){const b=new this.constructor;return p$$module$libs$world_onscreen.CrossToRef(this,a,b)}normalizeFromLength(a){return 0===a||1===a?this:this.scaleInPlace(1/a)}normalizeToNew(){const a=new this.constructor(0,0,0);return this.normalizeToRef(a),a}normalizeToRef(a){const b=
this.length();return 0===b||1===b?a.copyFromFloats(this._x,this._y,this._z):this.scaleToRef(1/b,a)}clone(){return new this.constructor(this._x,this._y,this._z)}copyFrom(a){return this.copyFromFloats(a._x,a._y,a._z)}copyFromFloats(a,b,c){return this.x=a,this.y=b,this.z=c,this}set(a,b,c){return this.copyFromFloats(a,b,c)}setAll(a){return this.x=this.y=this.z=a,this}static GetClipFactor(a,b,c,d){a=p$$module$libs$world_onscreen.Dot(a,c)-d;b=p$$module$libs$world_onscreen.Dot(b,c)-d;return a/(a-b)}static GetAngleBetweenVectors(a,
b,c){a=a.normalizeToRef(H$$module$libs$world_onscreen.Vector3[1]);b=b.normalizeToRef(H$$module$libs$world_onscreen.Vector3[2]);let d=p$$module$libs$world_onscreen.Dot(a,b);d=ne$$module$libs$world_onscreen.Clamp(d,-1,1);const e=Math.acos(d),g=H$$module$libs$world_onscreen.Vector3[3];return p$$module$libs$world_onscreen.CrossToRef(a,b,g),0<p$$module$libs$world_onscreen.Dot(g,c)?isNaN(e)?0:e:isNaN(e)?-Math.PI:-Math.acos(d)}static GetAngleBetweenVectorsOnPlane(a,b,c){H$$module$libs$world_onscreen.Vector3[0].copyFrom(a);
a=H$$module$libs$world_onscreen.Vector3[0];H$$module$libs$world_onscreen.Vector3[1].copyFrom(b);b=H$$module$libs$world_onscreen.Vector3[1];H$$module$libs$world_onscreen.Vector3[2].copyFrom(c);c=H$$module$libs$world_onscreen.Vector3[2];const d=H$$module$libs$world_onscreen.Vector3[3],e=H$$module$libs$world_onscreen.Vector3[4];a.normalize();b.normalize();c.normalize();p$$module$libs$world_onscreen.CrossToRef(c,a,d);p$$module$libs$world_onscreen.CrossToRef(d,c,e);a=Math.atan2(p$$module$libs$world_onscreen.Dot(b,
d),p$$module$libs$world_onscreen.Dot(b,e));return ne$$module$libs$world_onscreen.NormalizeRadians(a)}static PitchYawRollToMoveBetweenPointsToRef(a,b,c){const d=D$$module$libs$world_onscreen.Vector3[0];return b.subtractToRef(a,d),c.y=Math.atan2(d.x,d.z)||0,c.x=Math.atan2(Math.sqrt(d.x**2+d.z**2),d.y)||0,c.z=0,c}static PitchYawRollToMoveBetweenPoints(a,b){const c=p$$module$libs$world_onscreen.Zero();return p$$module$libs$world_onscreen.PitchYawRollToMoveBetweenPointsToRef(a,b,c)}static SlerpToRef(a,
b,c,d){c=ne$$module$libs$world_onscreen.Clamp(c,0,1);const e=H$$module$libs$world_onscreen.Vector3[0],g=H$$module$libs$world_onscreen.Vector3[1];e.copyFrom(a);a=e.length();e.normalizeFromLength(a);g.copyFrom(b);b=g.length();g.normalizeFromLength(b);var n=p$$module$libs$world_onscreen.Dot(e,g);if(n<1-Re$$module$libs$world_onscreen){var t=Math.acos(n);const w=1/Math.sin(t);n=Math.sin((1-c)*t)*w;t=Math.sin(c*t)*w}else n=1-c,t=c;return e.scaleInPlace(n),g.scaleInPlace(t),d.copyFrom(e).addInPlace(g),d.scaleInPlace(ne$$module$libs$world_onscreen.Lerp(a,
b,c)),d}static SmoothToRef(a,b,c,d,e){return p$$module$libs$world_onscreen.SlerpToRef(a,b,0===d?1:c/d,e),e}static FromArray(a,b=0){return new p$$module$libs$world_onscreen(a[b],a[b+1],a[b+2])}static FromFloatArray(a,b){return p$$module$libs$world_onscreen.FromArray(a,b)}static FromArrayToRef(a,b,c){return c.x=a[b],c.y=a[b+1],c.z=a[b+2],c}static FromFloatArrayToRef(a,b,c){return p$$module$libs$world_onscreen.FromArrayToRef(a,b,c)}static FromFloatsToRef(a,b,c,d){return d.copyFromFloats(a,b,c),d}static Zero(){return new p$$module$libs$world_onscreen(0,
0,0)}static One(){return new p$$module$libs$world_onscreen(1,1,1)}static Up(){return new p$$module$libs$world_onscreen(0,1,0)}static get UpReadOnly(){return p$$module$libs$world_onscreen._UpReadOnly}static get DownReadOnly(){return p$$module$libs$world_onscreen._DownReadOnly}static get RightReadOnly(){return p$$module$libs$world_onscreen._RightReadOnly}static get LeftReadOnly(){return p$$module$libs$world_onscreen._LeftReadOnly}static get LeftHandedForwardReadOnly(){return p$$module$libs$world_onscreen._LeftHandedForwardReadOnly}static get RightHandedForwardReadOnly(){return p$$module$libs$world_onscreen._RightHandedForwardReadOnly}static get ZeroReadOnly(){return p$$module$libs$world_onscreen._ZeroReadOnly}static Down(){return new p$$module$libs$world_onscreen(0,
-1,0)}static Forward(a=!1){return new p$$module$libs$world_onscreen(0,0,a?-1:1)}static Backward(a=!1){return new p$$module$libs$world_onscreen(0,0,a?1:-1)}static Right(){return new p$$module$libs$world_onscreen(1,0,0)}static Left(){return new p$$module$libs$world_onscreen(-1,0,0)}static TransformCoordinates(a,b){const c=p$$module$libs$world_onscreen.Zero();return p$$module$libs$world_onscreen.TransformCoordinatesToRef(a,b,c),c}static TransformCoordinatesToRef(a,b,c){return p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(a._x,
a._y,a._z,b,c),c}static TransformCoordinatesFromFloatsToRef(a,b,c,d,e){d=d.m;const g=a*d[1]+b*d[5]+c*d[9]+d[13],n=a*d[2]+b*d[6]+c*d[10]+d[14],t=1/(a*d[3]+b*d[7]+c*d[11]+d[15]);return e.x=(a*d[0]+b*d[4]+c*d[8]+d[12])*t,e.y=g*t,e.z=n*t,e}static TransformNormal(a,b){const c=p$$module$libs$world_onscreen.Zero();return p$$module$libs$world_onscreen.TransformNormalToRef(a,b,c),c}static TransformNormalToRef(a,b,c){return this.TransformNormalFromFloatsToRef(a._x,a._y,a._z,b,c),c}static TransformNormalFromFloatsToRef(a,
b,c,d,e){d=d.m;return e.x=a*d[0]+b*d[4]+c*d[8],e.y=a*d[1]+b*d[5]+c*d[9],e.z=a*d[2]+b*d[6]+c*d[10],e}static CatmullRom(a,b,c,d,e){const g=e*e,n=e*g;return new a.constructor(.5*(2*b._x+(-a._x+c._x)*e+(2*a._x-5*b._x+4*c._x-d._x)*g+(-a._x+3*b._x-3*c._x+d._x)*n),.5*(2*b._y+(-a._y+c._y)*e+(2*a._y-5*b._y+4*c._y-d._y)*g+(-a._y+3*b._y-3*c._y+d._y)*n),.5*(2*b._z+(-a._z+c._z)*e+(2*a._z-5*b._z+4*c._z-d._z)*g+(-a._z+3*b._z-3*c._z+d._z)*n))}static Clamp(a,b,c){const d=new a.constructor;return p$$module$libs$world_onscreen.ClampToRef(a,
b,c,d),d}static ClampToRef(a,b,c,d){let e=a._x;e=e>c._x?c._x:e;e=e<b._x?b._x:e;let g=a._y;g=g>c._y?c._y:g;g=g<b._y?b._y:g;a=a._z;return a=a>c._z?c._z:a,a=a<b._z?b._z:a,d.copyFromFloats(e,g,a),d}static CheckExtends(a,b,c){b.minimizeInPlace(a);c.maximizeInPlace(a)}static Hermite(a,b,c,d,e){var g=e*e;const n=e*g,t=2*n-3*g+1,w=-2*n+3*g;e=n-2*g+e;g=n-g;return new a.constructor(a._x*t+c._x*w+b._x*e+d._x*g,a._y*t+c._y*w+b._y*e+d._y*g,a._z*t+c._z*w+b._z*e+d._z*g)}static Hermite1stDerivative(a,b,c,d,e){const g=
new a.constructor;return this.Hermite1stDerivativeToRef(a,b,c,d,e,g),g}static Hermite1stDerivativeToRef(a,b,c,d,e,g){const n=e*e;return g.x=6*(n-e)*a.x+(3*n-4*e+1)*b.x+6*(-n+e)*c.x+(3*n-2*e)*d.x,g.y=6*(n-e)*a.y+(3*n-4*e+1)*b.y+6*(-n+e)*c.y+(3*n-2*e)*d.y,g.z=6*(n-e)*a.z+(3*n-4*e+1)*b.z+6*(-n+e)*c.z+(3*n-2*e)*d.z,g}static Lerp(a,b,c){const d=new a.constructor(0,0,0);return p$$module$libs$world_onscreen.LerpToRef(a,b,c,d),d}static LerpToRef(a,b,c,d){return d.x=a._x+(b._x-a._x)*c,d.y=a._y+(b._y-a._y)*
c,d.z=a._z+(b._z-a._z)*c,d}static Dot(a,b){return a._x*b._x+a._y*b._y+a._z*b._z}static Cross(a,b){const c=new a.constructor;return p$$module$libs$world_onscreen.CrossToRef(a,b,c),c}static CrossToRef(a,b,c){return c.copyFromFloats(a._y*b._z-a._z*b._y,a._z*b._x-a._x*b._z,a._x*b._y-a._y*b._x),c}static Normalize(a){const b=p$$module$libs$world_onscreen.Zero();return p$$module$libs$world_onscreen.NormalizeToRef(a,b),b}static NormalizeToRef(a,b){return a.normalizeToRef(b),b}static Project(a,b,c,d){const e=
new a.constructor;return p$$module$libs$world_onscreen.ProjectToRef(a,b,c,d,e),e}static ProjectToRef(a,b,c,d,e){const g=d.width,n=d.height,t=H$$module$libs$world_onscreen.Matrix[1];x$$module$libs$world_onscreen.FromValuesToRef(g/2,0,0,0,0,-n/2,0,0,0,0,.5,0,d.x+g/2,n/2+d.y,.5,1,t);d=H$$module$libs$world_onscreen.Matrix[0];return b.multiplyToRef(c,d),d.multiplyToRef(t,d),p$$module$libs$world_onscreen.TransformCoordinatesToRef(a,d,e),e}static Reflect(a,b){return this.ReflectToRef(a,b,new p$$module$libs$world_onscreen)}static ReflectToRef(a,
b,c){const d=D$$module$libs$world_onscreen.Vector3[0];return d.copyFrom(b).scaleInPlace(2*p$$module$libs$world_onscreen.Dot(a,b)),c.copyFrom(a).subtractInPlace(d)}static _UnprojectFromInvertedMatrixToRef(a,b,c){p$$module$libs$world_onscreen.TransformCoordinatesToRef(a,b,c);b=b.m;a=a._x*b[3]+a._y*b[7]+a._z*b[11]+b[15];return ne$$module$libs$world_onscreen.WithinEpsilon(a,1)&&c.scaleInPlace(1/a),c}static UnprojectFromTransform(a,b,c,d,e){return this.Unproject(a,b,c,d,e,x$$module$libs$world_onscreen.IdentityReadOnly)}static Unproject(a,
b,c,d,e,g){const n=new a.constructor;return p$$module$libs$world_onscreen.UnprojectToRef(a,b,c,d,e,g,n),n}static UnprojectToRef(a,b,c,d,e,g,n){return p$$module$libs$world_onscreen.UnprojectFloatsToRef(a._x,a._y,a._z,b,c,d,e,g,n),n}static UnprojectFloatsToRef(a,b,c,d,e,g,n,t,w){var z;const C=H$$module$libs$world_onscreen.Matrix[0];g.multiplyToRef(n,C);C.multiplyToRef(t,C);C.invert();g=H$$module$libs$world_onscreen.Vector3[0];return g.x=a/d*2-1,g.y=-(b/e*2-1),null!==(z=fe$$module$libs$world_onscreen.LastCreatedEngine)&&
void 0!==z&&z.isNDCHalfZRange?g.z=c:g.z=2*c-1,p$$module$libs$world_onscreen._UnprojectFromInvertedMatrixToRef(g,C,w),w}static Minimize(a,b){const c=new a.constructor;return c.copyFrom(a),c.minimizeInPlace(b),c}static Maximize(a,b){const c=new a.constructor;return c.copyFrom(a),c.maximizeInPlace(b),c}static Distance(a,b){return Math.sqrt(p$$module$libs$world_onscreen.DistanceSquared(a,b))}static DistanceSquared(a,b){const c=a._x-b._x,d=a._y-b._y;a=a._z-b._z;return c*c+d*d+a*a}static ProjectOnTriangleToRef(a,
b,c,d,e){const g=H$$module$libs$world_onscreen.Vector3[0],n=H$$module$libs$world_onscreen.Vector3[1],t=H$$module$libs$world_onscreen.Vector3[2];var w=H$$module$libs$world_onscreen.Vector3[3],z=H$$module$libs$world_onscreen.Vector3[4];c.subtractToRef(b,g);d.subtractToRef(b,n);d.subtractToRef(c,t);var C=g.length(),H=n.length(),M=t.length();if(C<Re$$module$libs$world_onscreen||H<Re$$module$libs$world_onscreen||M<Re$$module$libs$world_onscreen)return e.copyFrom(b),p$$module$libs$world_onscreen.Distance(a,
b);a.subtractToRef(b,z);p$$module$libs$world_onscreen.CrossToRef(g,n,w);var L=w.length();if(L<Re$$module$libs$world_onscreen)return e.copyFrom(b),p$$module$libs$world_onscreen.Distance(a,b);w.normalizeFromLength(L);var O=z.length();if(O<Re$$module$libs$world_onscreen)return e.copyFrom(b),0;z.normalizeFromLength(O);const S=p$$module$libs$world_onscreen.Dot(w,z);L=H$$module$libs$world_onscreen.Vector3[5];z=H$$module$libs$world_onscreen.Vector3[6];L.copyFrom(w).scaleInPlace(-O*S);z.copyFrom(a).addInPlace(L);
var T=H$$module$libs$world_onscreen.Vector3[4];const P=H$$module$libs$world_onscreen.Vector3[5];var W=H$$module$libs$world_onscreen.Vector3[7];L=H$$module$libs$world_onscreen.Vector3[8];T.copyFrom(g).scaleInPlace(1/C);L.copyFrom(n).scaleInPlace(1/H);T.addInPlace(L).scaleInPlace(-1);P.copyFrom(g).scaleInPlace(-1/C);L.copyFrom(t).scaleInPlace(1/M);P.addInPlace(L).scaleInPlace(-1);W.copyFrom(t).scaleInPlace(-1/M);L.copyFrom(n).scaleInPlace(-1/H);W.addInPlace(L).scaleInPlace(-1);H=H$$module$libs$world_onscreen.Vector3[9];
H.copyFrom(z).subtractInPlace(b);p$$module$libs$world_onscreen.CrossToRef(T,H,L);C=T=p$$module$libs$world_onscreen.Dot(L,w);H.copyFrom(z).subtractInPlace(c);p$$module$libs$world_onscreen.CrossToRef(P,H,L);M=T=p$$module$libs$world_onscreen.Dot(L,w);H.copyFrom(z).subtractInPlace(d);p$$module$libs$world_onscreen.CrossToRef(W,H,L);H=T=p$$module$libs$world_onscreen.Dot(L,w);W=H$$module$libs$world_onscreen.Vector3[10];let Z;var ca;0<C&&0>M?(W.copyFrom(g),Z=b,ca=c):0<M&&0>H?(W.copyFrom(t),Z=c,ca=d):(W.copyFrom(n).scaleInPlace(-1),
Z=d,ca=b);c=H$$module$libs$world_onscreen.Vector3[9];b=H$$module$libs$world_onscreen.Vector3[4];if(Z.subtractToRef(z,L),ca.subtractToRef(z,c),p$$module$libs$world_onscreen.CrossToRef(L,c,b),!(0>p$$module$libs$world_onscreen.Dot(b,w)))return e.copyFrom(z),Math.abs(O*S);O=H$$module$libs$world_onscreen.Vector3[5];p$$module$libs$world_onscreen.CrossToRef(W,b,O);O.normalize();w=H$$module$libs$world_onscreen.Vector3[9];w.copyFrom(Z).subtractInPlace(z);ca=w.length();if(ca<Re$$module$libs$world_onscreen)return e.copyFrom(Z),
p$$module$libs$world_onscreen.Distance(a,Z);w.normalizeFromLength(ca);b=p$$module$libs$world_onscreen.Dot(O,w);w=H$$module$libs$world_onscreen.Vector3[7];w.copyFrom(z).addInPlace(O.scaleInPlace(ca*b));L.copyFrom(w).subtractInPlace(Z);O=W.length();W.normalizeFromLength(O);z=p$$module$libs$world_onscreen.Dot(L,W)/Math.max(O,Re$$module$libs$world_onscreen);return z=ne$$module$libs$world_onscreen.Clamp(z,0,1),w.copyFrom(Z).addInPlace(W.scaleInPlace(z*O)),e.copyFrom(w),p$$module$libs$world_onscreen.Distance(a,
w)}static Center(a,b){return p$$module$libs$world_onscreen.CenterToRef(a,b,p$$module$libs$world_onscreen.Zero())}static CenterToRef(a,b,c){return c.copyFromFloats((a._x+b._x)/2,(a._y+b._y)/2,(a._z+b._z)/2)}static RotationFromAxis(a,b,c){const d=new a.constructor;return p$$module$libs$world_onscreen.RotationFromAxisToRef(a,b,c,d),d}static RotationFromAxisToRef(a,b,c,d){const e=H$$module$libs$world_onscreen.Quaternion[0];return Y$$module$libs$world_onscreen.RotationQuaternionFromAxisToRef(a,b,c,e),
e.toEulerAnglesToRef(d),d}}p$$module$libs$world_onscreen._UpReadOnly=p$$module$libs$world_onscreen.Up();p$$module$libs$world_onscreen._DownReadOnly=p$$module$libs$world_onscreen.Down();p$$module$libs$world_onscreen._LeftHandedForwardReadOnly=p$$module$libs$world_onscreen.Forward(!1);p$$module$libs$world_onscreen._RightHandedForwardReadOnly=p$$module$libs$world_onscreen.Forward(!0);p$$module$libs$world_onscreen._RightReadOnly=p$$module$libs$world_onscreen.Right();
p$$module$libs$world_onscreen._LeftReadOnly=p$$module$libs$world_onscreen.Left();p$$module$libs$world_onscreen._ZeroReadOnly=p$$module$libs$world_onscreen.Zero();
class Ae$$module$libs$world_onscreen{constructor(a=0,b=0,c=0,d=0){this.x=a;this.y=b;this.z=c;this.w=d}toString(){return`{X: ${this.x} Y: ${this.y} Z: ${this.z} W: ${this.w}}`}getClassName(){return"Vector4"}getHashCode(){var a=it$$module$libs$world_onscreen(this.x);const b=it$$module$libs$world_onscreen(this.y),c=it$$module$libs$world_onscreen(this.z),d=it$$module$libs$world_onscreen(this.w);return a=397*a^b,a=397*a^c,a=397*a^d,a}asArray(){const a=[];return this.toArray(a,0),a}toArray(a,b){return void 0===
b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,this}fromArray(a,b=0){return Ae$$module$libs$world_onscreen.FromArrayToRef(a,b,this),this}addInPlace(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}add(a){return new this.constructor(this.x+a.x,this.y+a.y,this.z+a.z,this.w+a.w)}addToRef(a,b){return b.x=this.x+a.x,b.y=this.y+a.y,b.z=this.z+a.z,b.w=this.w+a.w,b}subtractInPlace(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subtract(a){return new this.constructor(this.x-
a.x,this.y-a.y,this.z-a.z,this.w-a.w)}subtractToRef(a,b){return b.x=this.x-a.x,b.y=this.y-a.y,b.z=this.z-a.z,b.w=this.w-a.w,b}subtractFromFloats(a,b,c,d){return new this.constructor(this.x-a,this.y-b,this.z-c,this.w-d)}subtractFromFloatsToRef(a,b,c,d,e){return e.x=this.x-a,e.y=this.y-b,e.z=this.z-c,e.w=this.w-d,e}negate(){return new this.constructor(-this.x,-this.y,-this.z,-this.w)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this}negateToRef(a){return a.copyFromFloats(-1*this.x,
-1*this.y,-1*this.z,-1*this.w)}scaleInPlace(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}scale(a){return new this.constructor(this.x*a,this.y*a,this.z*a,this.w*a)}scaleToRef(a,b){return b.x=this.x*a,b.y=this.y*a,b.z=this.z*a,b.w=this.w*a,b}scaleAndAddToRef(a,b){return b.x+=this.x*a,b.y+=this.y*a,b.z+=this.z*a,b.w+=this.w*a,b}equals(a){return a&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w}equalsWithEpsilon(a,b=Re$$module$libs$world_onscreen){return a&&ne$$module$libs$world_onscreen.WithinEpsilon(this.x,
a.x,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this.y,a.y,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this.z,a.z,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this.w,a.w,b)}equalsToFloats(a,b,c,d){return this.x===a&&this.y===b&&this.z===c&&this.w===d}multiplyInPlace(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiply(a){return new this.constructor(this.x*a.x,this.y*a.y,this.z*a.z,this.w*a.w)}multiplyToRef(a,b){return b.x=this.x*a.x,b.y=this.y*a.y,b.z=this.z*a.z,b.w=
this.w*a.w,b}multiplyByFloats(a,b,c,d){return new this.constructor(this.x*a,this.y*b,this.z*c,this.w*d)}divide(a){return new this.constructor(this.x/a.x,this.y/a.y,this.z/a.z,this.w/a.w)}divideToRef(a,b){return b.x=this.x/a.x,b.y=this.y/a.y,b.z=this.z/a.z,b.w=this.w/a.w,b}divideInPlace(a){return this.divideToRef(a,this)}minimizeInPlace(a){return a.x<this.x&&(this.x=a.x),a.y<this.y&&(this.y=a.y),a.z<this.z&&(this.z=a.z),a.w<this.w&&(this.w=a.w),this}maximizeInPlace(a){return a.x>this.x&&(this.x=a.x),
a.y>this.y&&(this.y=a.y),a.z>this.z&&(this.z=a.z),a.w>this.w&&(this.w=a.w),this}floor(){return new this.constructor(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new this.constructor(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const a=
this.length();return 0===a?this:this.scaleInPlace(1/a)}toVector3(){return new p$$module$libs$world_onscreen(this.x,this.y,this.z)}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copyFrom(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this}copyFromFloats(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this}set(a,b,c,d){return this.copyFromFloats(a,b,c,d)}setAll(a){return this.x=this.y=this.z=this.w=a,this}static FromArray(a,b){return b||=0,new Ae$$module$libs$world_onscreen(a[b],
a[b+1],a[b+2],a[b+3])}static FromArrayToRef(a,b,c){return c.x=a[b],c.y=a[b+1],c.z=a[b+2],c.w=a[b+3],c}static FromFloatArrayToRef(a,b,c){return Ae$$module$libs$world_onscreen.FromArrayToRef(a,b,c),c}static FromFloatsToRef(a,b,c,d,e){return e.x=a,e.y=b,e.z=c,e.w=d,e}static Zero(){return new Ae$$module$libs$world_onscreen(0,0,0,0)}static One(){return new Ae$$module$libs$world_onscreen(1,1,1,1)}static get ZeroReadOnly(){return Ae$$module$libs$world_onscreen._ZeroReadOnly}static Normalize(a){const b=Ae$$module$libs$world_onscreen.Zero();
return Ae$$module$libs$world_onscreen.NormalizeToRef(a,b),b}static NormalizeToRef(a,b){return b.copyFrom(a),b.normalize(),b}static Minimize(a,b){const c=new a.constructor;return c.copyFrom(a),c.minimizeInPlace(b),c}static Maximize(a,b){const c=new a.constructor;return c.copyFrom(a),c.maximizeInPlace(b),c}static Distance(a,b){return Math.sqrt(Ae$$module$libs$world_onscreen.DistanceSquared(a,b))}static DistanceSquared(a,b){const c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;a=a.w-b.w;return c*c+d*d+e*e+a*a}static Center(a,
b){return Ae$$module$libs$world_onscreen.CenterToRef(a,b,Ae$$module$libs$world_onscreen.Zero())}static CenterToRef(a,b,c){return c.copyFromFloats((a.x+b.x)/2,(a.y+b.y)/2,(a.z+b.z)/2,(a.w+b.w)/2)}static TransformCoordinates(a,b){const c=Ae$$module$libs$world_onscreen.Zero();return Ae$$module$libs$world_onscreen.TransformCoordinatesToRef(a,b,c),c}static TransformCoordinatesToRef(a,b,c){return Ae$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(a._x,a._y,a._z,b,c),c}static TransformCoordinatesFromFloatsToRef(a,
b,c,d,e){d=d.m;const g=a*d[1]+b*d[5]+c*d[9]+d[13],n=a*d[2]+b*d[6]+c*d[10]+d[14],t=a*d[3]+b*d[7]+c*d[11]+d[15];return e.x=a*d[0]+b*d[4]+c*d[8]+d[12],e.y=g,e.z=n,e.w=t,e}static TransformNormal(a,b){const c=new a.constructor;return Ae$$module$libs$world_onscreen.TransformNormalToRef(a,b,c),c}static TransformNormalToRef(a,b,c){b=b.m;const d=a.x*b[1]+a.y*b[5]+a.z*b[9],e=a.x*b[2]+a.y*b[6]+a.z*b[10];return c.x=a.x*b[0]+a.y*b[4]+a.z*b[8],c.y=d,c.z=e,c.w=a.w,c}static TransformNormalFromFloatsToRef(a,b,c,d,
e,g){e=e.m;return g.x=a*e[0]+b*e[4]+c*e[8],g.y=a*e[1]+b*e[5]+c*e[9],g.z=a*e[2]+b*e[6]+c*e[10],g.w=d,g}static FromVector3(a,b=0){return new Ae$$module$libs$world_onscreen(a._x,a._y,a._z,b)}}Ae$$module$libs$world_onscreen._ZeroReadOnly=Ae$$module$libs$world_onscreen.Zero();
class Y$$module$libs$world_onscreen{constructor(a=0,b=0,c=0,d=1){this._isDirty=!0;this._x=a;this._y=b;this._z=c;this._w=d}get x(){return this._x}set x(a){this._x=a;this._isDirty=!0}get y(){return this._y}set y(a){this._y=a;this._isDirty=!0}get z(){return this._z}set z(a){this._z=a;this._isDirty=!0}get w(){return this._w}set w(a){this._w=a;this._isDirty=!0}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z} W: ${this._w}}`}getClassName(){return"Quaternion"}getHashCode(){var a=it$$module$libs$world_onscreen(this._x);
const b=it$$module$libs$world_onscreen(this._y),c=it$$module$libs$world_onscreen(this._z),d=it$$module$libs$world_onscreen(this._w);return a=397*a^b,a=397*a^c,a=397*a^d,a}asArray(){return[this._x,this._y,this._z,this._w]}toArray(a,b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,this}equals(a){return a&&this._x===a._x&&this._y===a._y&&this._z===a._z&&this._w===a._w}equalsWithEpsilon(a,b=Re$$module$libs$world_onscreen){return a&&ne$$module$libs$world_onscreen.WithinEpsilon(this._x,
a._x,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this._y,a._y,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this._z,a._z,b)&&ne$$module$libs$world_onscreen.WithinEpsilon(this._w,a._w,b)}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copyFrom(a){return this.x=a._x,this.y=a._y,this.z=a._z,this.w=a._w,this}copyFromFloats(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this}set(a,b,c,d){return this.copyFromFloats(a,b,c,d)}add(a){return new this.constructor(this._x+a._x,
this._y+a._y,this._z+a._z,this._w+a._w)}addInPlace(a){return this._x+=a._x,this._y+=a._y,this._z+=a._z,this._w+=a._w,this}subtract(a){return new this.constructor(this._x-a._x,this._y-a._y,this._z-a._z,this._w-a._w)}subtractInPlace(a){return this._x-=a._x,this._y-=a._y,this._z-=a._z,this._w-=a._w,this}scale(a){return new this.constructor(this._x*a,this._y*a,this._z*a,this._w*a)}scaleToRef(a,b){return b.x=this._x*a,b.y=this._y*a,b.z=this._z*a,b.w=this._w*a,b}scaleInPlace(a){return this.x*=a,this.y*=
a,this.z*=a,this.w*=a,this}scaleAndAddToRef(a,b){return b.x+=this._x*a,b.y+=this._y*a,b.z+=this._z*a,b.w+=this._w*a,b}multiply(a){const b=new this.constructor(0,0,0,1);return this.multiplyToRef(a,b),b}multiplyToRef(a,b){return b.copyFromFloats(this._x*a._w+this._y*a._z-this._z*a._y+this._w*a._x,-this._x*a._z+this._y*a._w+this._z*a._x+this._w*a._y,this._x*a._y-this._y*a._x+this._z*a._w+this._w*a._z,-this._x*a._x-this._y*a._y-this._z*a._z+this._w*a._w),b}multiplyInPlace(a){return this.multiplyToRef(a,
this),this}conjugateToRef(a){return a.copyFromFloats(-this._x,-this._y,-this._z,this._w),a}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new this.constructor(-this._x,-this._y,-this._z,this._w)}invert(){const a=this.conjugate(),b=this.lengthSquared();return 0==b||1==b||a.scaleInPlace(1/b),a}invertInPlace(){this.conjugateInPlace();const a=this.lengthSquared();return 0==a||1==a?this:(this.scaleInPlace(1/a),this)}lengthSquared(){return this._x*this._x+this._y*this._y+
this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSquared())}normalize(){const a=this.length();return 0===a?this:(this.scaleInPlace(1/a),this)}normalizeToNew(){const a=this.length();return 0===a?this.clone():this.scale(1/a)}toEulerAngles(){const a=p$$module$libs$world_onscreen.Zero();return this.toEulerAnglesToRef(a),a}toEulerAnglesToRef(a){const b=this._z,c=this._x,d=this._y,e=this._w,g=d*b-c*e;if(-.4999999>g)a.y=2*Math.atan2(d,e),a.x=Math.PI/2,a.z=0;else if(.4999999<g)a.y=2*Math.atan2(d,
e),a.x=-Math.PI/2,a.z=0;else{const n=e*e,t=b*b,w=c*c,z=d*d;a.z=Math.atan2(2*(c*d+b*e),-t-w+z+n);a.x=Math.asin(-2*g);a.y=Math.atan2(2*(b*c+d*e),t-w-z+n)}return a}toRotationMatrix(a){return x$$module$libs$world_onscreen.FromQuaternionToRef(this,a),a}fromRotationMatrix(a){return Y$$module$libs$world_onscreen.FromRotationMatrixToRef(a,this),this}static FromRotationMatrix(a){const b=new Y$$module$libs$world_onscreen;return Y$$module$libs$world_onscreen.FromRotationMatrixToRef(a,b),b}static FromRotationMatrixToRef(a,
b){var c=a.m;a=c[0];const d=c[4],e=c[8],g=c[1],n=c[5],t=c[9],w=c[2],z=c[6];c=c[10];const C=a+n+c;let H;return 0<C?(H=.5/Math.sqrt(C+1),b.w=.25/H,b.x=(z-t)*H,b.y=(e-w)*H,b.z=(g-d)*H):a>n&&a>c?(H=2*Math.sqrt(1+a-n-c),b.w=(z-t)/H,b.x=.25*H,b.y=(d+g)/H,b.z=(e+w)/H):n>c?(H=2*Math.sqrt(1+n-a-c),b.w=(e-w)/H,b.x=(d+g)/H,b.y=.25*H,b.z=(t+z)/H):(H=2*Math.sqrt(1+c-a-n),b.w=(g-d)/H,b.x=(e+w)/H,b.y=(t+z)/H,b.z=.25*H),b}static Dot(a,b){return a._x*b._x+a._y*b._y+a._z*b._z+a._w*b._w}static AreClose(a,b,c=.1){a=
Y$$module$libs$world_onscreen.Dot(a,b);return 1-a*a<=c}static SmoothToRef(a,b,c,d,e){c=0===d?1:c/d;return c=ne$$module$libs$world_onscreen.Clamp(c,0,1),Y$$module$libs$world_onscreen.SlerpToRef(a,b,c,e),e}static Zero(){return new Y$$module$libs$world_onscreen(0,0,0,0)}static Inverse(a){return new a.constructor(-a._x,-a._y,-a._z,a._w)}static InverseToRef(a,b){return b.set(-a._x,-a._y,-a._z,a._w),b}static Identity(){return new Y$$module$libs$world_onscreen(0,0,0,1)}static IsIdentity(a){return a&&0===
a._x&&0===a._y&&0===a._z&&1===a._w}static RotationAxis(a,b){return Y$$module$libs$world_onscreen.RotationAxisToRef(a,b,new Y$$module$libs$world_onscreen)}static RotationAxisToRef(a,b,c){const d=Math.sin(b/2);return a.normalize(),c.w=Math.cos(b/2),c.x=a._x*d,c.y=a._y*d,c.z=a._z*d,c}static FromArray(a,b){return b||=0,new Y$$module$libs$world_onscreen(a[b],a[b+1],a[b+2],a[b+3])}static FromArrayToRef(a,b,c){return c.x=a[b],c.y=a[b+1],c.z=a[b+2],c.w=a[b+3],c}static FromEulerAngles(a,b,c){const d=new Y$$module$libs$world_onscreen;
return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(b,a,c,d),d}static FromEulerAnglesToRef(a,b,c,d){return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(b,a,c,d),d}static FromEulerVector(a){const b=new Y$$module$libs$world_onscreen;return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(a._y,a._x,a._z,b),b}static FromEulerVectorToRef(a,b){return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(a._y,a._x,a._z,b),b}static FromUnitVectorsToRef(a,b,c){const d=p$$module$libs$world_onscreen.Dot(a,
b)+1;return d<Re$$module$libs$world_onscreen?Math.abs(a.x)>Math.abs(a.z)?c.set(-a.y,a.x,0,0):c.set(0,-a.z,a.y,0):(p$$module$libs$world_onscreen.CrossToRef(a,b,D$$module$libs$world_onscreen.Vector3[0]),c.set(D$$module$libs$world_onscreen.Vector3[0].x,D$$module$libs$world_onscreen.Vector3[0].y,D$$module$libs$world_onscreen.Vector3[0].z,d)),c.normalize()}static RotationYawPitchRoll(a,b,c){const d=new Y$$module$libs$world_onscreen;return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(a,b,c,d),
d}static RotationYawPitchRollToRef(a,b,c,d){c*=.5;var e=.5*b;b=.5*a;a=Math.sin(c);c=Math.cos(c);const g=Math.sin(e);e=Math.cos(e);const n=Math.sin(b);b=Math.cos(b);return d.x=b*g*c+n*e*a,d.y=n*e*c-b*g*a,d.z=b*e*a-n*g*c,d.w=b*e*c+n*g*a,d}static RotationAlphaBetaGamma(a,b,c){const d=new Y$$module$libs$world_onscreen;return Y$$module$libs$world_onscreen.RotationAlphaBetaGammaToRef(a,b,c,d),d}static RotationAlphaBetaGammaToRef(a,b,c,d){const e=.5*(c+a);a=.5*(c-a);b*=.5;return d.x=Math.cos(a)*Math.sin(b),
d.y=Math.sin(a)*Math.sin(b),d.z=Math.sin(e)*Math.cos(b),d.w=Math.cos(e)*Math.cos(b),d}static RotationQuaternionFromAxis(a,b,c){const d=new Y$$module$libs$world_onscreen(0,0,0,0);return Y$$module$libs$world_onscreen.RotationQuaternionFromAxisToRef(a,b,c,d),d}static RotationQuaternionFromAxisToRef(a,b,c,d){const e=H$$module$libs$world_onscreen.Matrix[0];return x$$module$libs$world_onscreen.FromXYZAxesToRef(a.normalize(),b.normalize(),c.normalize(),e),Y$$module$libs$world_onscreen.FromRotationMatrixToRef(e,
d),d}static FromLookDirectionLH(a,b){const c=new Y$$module$libs$world_onscreen;return Y$$module$libs$world_onscreen.FromLookDirectionLHToRef(a,b,c),c}static FromLookDirectionLHToRef(a,b,c){const d=H$$module$libs$world_onscreen.Matrix[0];return x$$module$libs$world_onscreen.LookDirectionLHToRef(a,b,d),Y$$module$libs$world_onscreen.FromRotationMatrixToRef(d,c),c}static FromLookDirectionRH(a,b){const c=new Y$$module$libs$world_onscreen;return Y$$module$libs$world_onscreen.FromLookDirectionRHToRef(a,
b,c),c}static FromLookDirectionRHToRef(a,b,c){const d=H$$module$libs$world_onscreen.Matrix[0];return x$$module$libs$world_onscreen.LookDirectionRHToRef(a,b,d),Y$$module$libs$world_onscreen.FromRotationMatrixToRef(d,c)}static Slerp(a,b,c){const d=Y$$module$libs$world_onscreen.Identity();return Y$$module$libs$world_onscreen.SlerpToRef(a,b,c,d),d}static SlerpToRef(a,b,c,d){var e=a._x*b._x+a._y*b._y+a._z*b._z+a._w*b._w;let g=!1;if(0>e&&(g=!0,e=-e),.999999<e)e=1-c,c=g?-c:c;else{const n=Math.acos(e),t=
1/Math.sin(n);e=Math.sin((1-c)*n)*t;c=g?-Math.sin(c*n)*t:Math.sin(c*n)*t}return d.x=e*a._x+c*b._x,d.y=e*a._y+c*b._y,d.z=e*a._z+c*b._z,d.w=e*a._w+c*b._w,d}static Hermite(a,b,c,d,e){var g=e*e;const n=e*g,t=2*n-3*g+1,w=-2*n+3*g;e=n-2*g+e;g=n-g;return new a.constructor(a._x*t+c._x*w+b._x*e+d._x*g,a._y*t+c._y*w+b._y*e+d._y*g,a._z*t+c._z*w+b._z*e+d._z*g,a._w*t+c._w*w+b._w*e+d._w*g)}static Hermite1stDerivative(a,b,c,d,e){const g=new a.constructor;return this.Hermite1stDerivativeToRef(a,b,c,d,e,g),g}static Hermite1stDerivativeToRef(a,
b,c,d,e,g){const n=e*e;return g.x=6*(n-e)*a.x+(3*n-4*e+1)*b.x+6*(-n+e)*c.x+(3*n-2*e)*d.x,g.y=6*(n-e)*a.y+(3*n-4*e+1)*b.y+6*(-n+e)*c.y+(3*n-2*e)*d.y,g.z=6*(n-e)*a.z+(3*n-4*e+1)*b.z+6*(-n+e)*c.z+(3*n-2*e)*d.z,g.w=6*(n-e)*a.w+(3*n-4*e+1)*b.w+6*(-n+e)*c.w+(3*n-2*e)*d.w,g}}
class x$$module$libs$world_onscreen{constructor(){this._isIdentity=!1;this._isIdentity3x2Dirty=this._isIdentity3x2=this._isIdentityDirty=!0;this.updateFlag=-1;Ne$$module$libs$world_onscreen.MatrixTrackPrecisionChange&&Ne$$module$libs$world_onscreen.MatrixTrackedMatrices.push(this);this._m=new Ne$$module$libs$world_onscreen.MatrixCurrentType(16);this.markAsUpdated()}static get Use64Bits(){return Ne$$module$libs$world_onscreen.MatrixUse64Bits}get m(){return this._m}markAsUpdated(){this.updateFlag=x$$module$libs$world_onscreen._UpdateFlagSeed++;
this._isIdentity3x2=this._isIdentity=!1;this._isIdentity3x2Dirty=this._isIdentityDirty=!0}_updateIdentityStatus(a,b=!1,c=!1,d=!0){this._isIdentity3x2=(this._isIdentity=a)||c;this._isIdentityDirty=this._isIdentity?!1:b;this._isIdentity3x2Dirty=this._isIdentity3x2?!1:d}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const a=this._m;this._isIdentity=1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&0===a[12]&&0===
a[13]&&0===a[14]&&1===a[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]?this._isIdentity3x2=!1:0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===
this._isIdentity)return 1;const a=this._m,b=a[4],c=a[5],d=a[6],e=a[7];var g=a[8];const n=a[9];var t=a[10],w=a[11];const z=a[12],C=a[13],H=a[14],M=a[15],L=t*M-H*w,O=n*M-C*w,S=n*H-C*t;w=g*M-z*w;t=g*H-t*z;g=g*C-z*n;return a[0]*+(c*L-d*O+e*S)+a[1]*-(b*L-d*w+e*t)+a[2]*+(b*O-c*w+e*g)+a[3]*-(b*S-c*t+d*g)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return x$$module$libs$world_onscreen.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),
this}add(a){const b=new this.constructor;return this.addToRef(a,b),b}addToRef(a,b){const c=this._m,d=b._m;a=a.m;for(let e=0;16>e;e++)d[e]=c[e]+a[e];return b.markAsUpdated(),b}addToSelf(a){const b=this._m;a=a.m;for(let c=0;16>c;c++)b[c]+=a[c];return this.markAsUpdated(),this}invertToRef(a){if(!0===this._isIdentity)return x$$module$libs$world_onscreen.IdentityToRef(a),a;var b=this._m;const c=b[0],d=b[1],e=b[2],g=b[3];var n=b[4];const t=b[5];var w=b[6],z=b[7];const C=b[8],H=b[9],M=b[10],L=b[11];var O=
b[12],S=b[13],T=b[14],P=b[15];b=M*P-T*L;const W=H*P-S*L,Z=H*T-S*M,ca=C*P-O*L,ba=C*T-M*O,la=C*S-O*H,ea=+(t*b-w*W+z*Z),oa=-(n*b-w*ca+z*ba),sa=+(n*W-t*ca+z*la),xa=-(n*Z-t*ba+w*la);var ya=c*ea+d*oa+e*sa+g*xa;if(0===ya)return a.copyFrom(this),a;ya=1/ya;const Ya=w*P-T*z,Ja=t*P-S*z,ac=t*T-S*w;P=n*P-O*z;T=n*T-O*w;O=n*S-O*t;S=w*L-M*z;const Ia=t*L-H*z,Ma=t*M-H*w;z=n*L-C*z;w=n*M-C*w;n=n*H-C*t;return x$$module$libs$world_onscreen.FromValuesToRef(ea*ya,-(d*b-e*W+g*Z)*ya,+(d*Ya-e*Ja+g*ac)*ya,-(d*S-e*Ia+g*Ma)*ya,
oa*ya,+(c*b-e*ca+g*ba)*ya,-(c*Ya-e*P+g*T)*ya,+(c*S-e*z+g*w)*ya,sa*ya,-(c*W-d*ca+g*la)*ya,+(c*Ja-d*P+g*O)*ya,-(c*Ia-d*z+g*n)*ya,xa*ya,+(c*Z-d*ba+e*la)*ya,-(c*ac-d*T+e*O)*ya,+(c*Ma-d*w+e*n)*ya,a),a}addAtIndex(a,b){return this._m[a]+=b,this.markAsUpdated(),this}multiplyAtIndex(a,b){return this._m[a]*=b,this.markAsUpdated(),this}setTranslationFromFloats(a,b,c){return this._m[12]=a,this._m[13]=b,this._m[14]=c,this.markAsUpdated(),this}addTranslationFromFloats(a,b,c){return this._m[12]+=a,this._m[13]+=
b,this._m[14]+=c,this.markAsUpdated(),this}setTranslation(a){return this.setTranslationFromFloats(a._x,a._y,a._z)}getTranslation(){return new p$$module$libs$world_onscreen(this._m[12],this._m[13],this._m[14])}getTranslationToRef(a){return a.x=this._m[12],a.y=this._m[13],a.z=this._m[14],a}removeRotationAndScaling(){const a=this.m;return x$$module$libs$world_onscreen.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,a[12],a[13],a[14],a[15],this),this._updateIdentityStatus(0===a[12]&&0===a[13]&&0===a[14]&&1===
a[15]),this}multiply(a){const b=new this.constructor;return this.multiplyToRef(a,b),b}copyFrom(a){a.copyToArray(this._m);return this.updateFlag=a.updateFlag,this._updateIdentityStatus(a._isIdentity,a._isIdentityDirty,a._isIdentity3x2,a._isIdentity3x2Dirty),this}copyToArray(a,b=0){const c=this._m;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],
this}multiplyToRef(a,b){return this._isIdentity?(b.copyFrom(a),b):a._isIdentity?(b.copyFrom(this),b):(this.multiplyToArray(a,b._m,0),b.markAsUpdated(),b)}multiplyToArray(a,b,c){var d=this._m,e=a.m;a=d[0];const g=d[1],n=d[2],t=d[3],w=d[4],z=d[5],C=d[6],H=d[7],M=d[8],L=d[9],O=d[10],S=d[11],T=d[12],P=d[13],W=d[14];d=d[15];const Z=e[0],ca=e[1],ba=e[2],la=e[3],ea=e[4],oa=e[5],sa=e[6],xa=e[7],ya=e[8],Ya=e[9],Ja=e[10],ac=e[11],Ia=e[12],Ma=e[13],Nb=e[14];e=e[15];return b[c]=a*Z+g*ea+n*ya+t*Ia,b[c+1]=a*ca+
g*oa+n*Ya+t*Ma,b[c+2]=a*ba+g*sa+n*Ja+t*Nb,b[c+3]=a*la+g*xa+n*ac+t*e,b[c+4]=w*Z+z*ea+C*ya+H*Ia,b[c+5]=w*ca+z*oa+C*Ya+H*Ma,b[c+6]=w*ba+z*sa+C*Ja+H*Nb,b[c+7]=w*la+z*xa+C*ac+H*e,b[c+8]=M*Z+L*ea+O*ya+S*Ia,b[c+9]=M*ca+L*oa+O*Ya+S*Ma,b[c+10]=M*ba+L*sa+O*Ja+S*Nb,b[c+11]=M*la+L*xa+O*ac+S*e,b[c+12]=T*Z+P*ea+W*ya+d*Ia,b[c+13]=T*ca+P*oa+W*Ya+d*Ma,b[c+14]=T*ba+P*sa+W*Ja+d*Nb,b[c+15]=T*la+P*xa+W*ac+d*e,this}equals(a){if(!a)return!1;if((this._isIdentity||a._isIdentity)&&!this._isIdentityDirty&&!a._isIdentityDirty)return this._isIdentity&&
a._isIdentity;const b=this.m;a=a.m;return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===a[8]&&b[9]===a[9]&&b[10]===a[10]&&b[11]===a[11]&&b[12]===a[12]&&b[13]===a[13]&&b[14]===a[14]&&b[15]===a[15]}clone(){const a=new this.constructor;return a.copyFrom(this),a}getClassName(){return"Matrix"}getHashCode(){let a=it$$module$libs$world_onscreen(this._m[0]);for(let b=1;16>b;b++)a=397*a^it$$module$libs$world_onscreen(this._m[b]);return a}decomposeToTransformNode(a){return a.rotationQuaternion=
a.rotationQuaternion||new Y$$module$libs$world_onscreen,this.decompose(a.scaling,a.rotationQuaternion,a.position)}decompose(a,b,c,d){if(this._isIdentity)return c&&c.setAll(0),a&&a.setAll(1),b&&b.copyFromFloats(0,0,0,1),!0;const e=this._m;if(c&&c.copyFromFloats(e[12],e[13],e[14]),a=a||H$$module$libs$world_onscreen.Vector3[0],a.x=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),a.y=Math.sqrt(e[4]*e[4]+e[5]*e[5]+e[6]*e[6]),a.z=Math.sqrt(e[8]*e[8]+e[9]*e[9]+e[10]*e[10]),d){c=0>d.scaling.y?-1:1;const g=0>d.scaling.z?
-1:1;a.x*=0>d.scaling.x?-1:1;a.y*=c;a.z*=g}else 0>=this.determinant()&&(a.y*=-1);if(0===a._x||0===a._y||0===a._z)return b&&b.copyFromFloats(0,0,0,1),!1;b&&(d=1/a._x,c=1/a._y,a=1/a._z,x$$module$libs$world_onscreen.FromValuesToRef(e[0]*d,e[1]*d,e[2]*d,0,e[4]*c,e[5]*c,e[6]*c,0,e[8]*a,e[9]*a,e[10]*a,0,0,0,0,1,H$$module$libs$world_onscreen.Matrix[0]),Y$$module$libs$world_onscreen.FromRotationMatrixToRef(H$$module$libs$world_onscreen.Matrix[0],b));return!0}getRow(a){if(0>a||3<a)return null;a*=4;return new Ae$$module$libs$world_onscreen(this._m[a+
0],this._m[a+1],this._m[a+2],this._m[a+3])}getRowToRef(a,b){0<=a&&3>a&&(a*=4,b.x=this._m[a+0],b.y=this._m[a+1],b.z=this._m[a+2],b.w=this._m[a+3]);return b}setRow(a,b){return this.setRowFromFloats(a,b.x,b.y,b.z,b.w)}transpose(){const a=new this.constructor;return x$$module$libs$world_onscreen.TransposeToRef(this,a),a}transposeToRef(a){return x$$module$libs$world_onscreen.TransposeToRef(this,a),a}setRowFromFloats(a,b,c,d,e){if(0>a||3<a)return this;a*=4;return this._m[a+0]=b,this._m[a+1]=c,this._m[a+
2]=d,this._m[a+3]=e,this.markAsUpdated(),this}scale(a){const b=new this.constructor;return this.scaleToRef(a,b),b}scaleToRef(a,b){for(let c=0;16>c;c++)b._m[c]=this._m[c]*a;return b.markAsUpdated(),b}scaleAndAddToRef(a,b){for(let c=0;16>c;c++)b._m[c]+=this._m[c]*a;return b.markAsUpdated(),b}toNormalMatrix(a){var b=H$$module$libs$world_onscreen.Matrix[0];this.invertToRef(b);b.transposeToRef(a);b=a._m;return x$$module$libs$world_onscreen.FromValuesToRef(b[0],b[1],b[2],0,b[4],b[5],b[6],0,b[8],b[9],b[10],
0,0,0,0,1,a),a}getRotationMatrix(){const a=new this.constructor;return this.getRotationMatrixToRef(a),a}getRotationMatrixToRef(a){var b=H$$module$libs$world_onscreen.Vector3[0];if(!this.decompose(b))return x$$module$libs$world_onscreen.IdentityToRef(a),a;const c=this._m,d=1/b._x,e=1/b._y;b=1/b._z;return x$$module$libs$world_onscreen.FromValuesToRef(c[0]*d,c[1]*d,c[2]*d,0,c[4]*e,c[5]*e,c[6]*e,0,c[8]*b,c[9]*b,c[10]*b,0,0,0,0,1,a),a}toggleModelMatrixHandInPlace(){const a=this._m;return a[2]*=-1,a[6]*=
-1,a[8]*=-1,a[9]*=-1,a[14]*=-1,this.markAsUpdated(),this}toggleProjectionMatrixHandInPlace(){const a=this._m;return a[8]*=-1,a[9]*=-1,a[10]*=-1,a[11]*=-1,this.markAsUpdated(),this}static FromArray(a,b=0){const c=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.FromArrayToRef(a,b,c),c}static FromArrayToRef(a,b,c){for(let d=0;16>d;d++)c._m[d]=a[d+b];return c.markAsUpdated(),c}static FromFloat32ArrayToRefScaled(a,b,c,d){for(let e=0;16>e;e++)d._m[e]=a[e+b]*c;return d.markAsUpdated(),
d}static get IdentityReadOnly(){return x$$module$libs$world_onscreen._IdentityReadOnly}static FromValuesToRef(a,b,c,d,e,g,n,t,w,z,C,H,M,L,O,S,T){const P=T._m;P[0]=a;P[1]=b;P[2]=c;P[3]=d;P[4]=e;P[5]=g;P[6]=n;P[7]=t;P[8]=w;P[9]=z;P[10]=C;P[11]=H;P[12]=M;P[13]=L;P[14]=O;P[15]=S;T.markAsUpdated()}static FromValues(a,b,c,d,e,g,n,t,w,z,C,H,M,L,O,S){const T=new x$$module$libs$world_onscreen,P=T._m;return P[0]=a,P[1]=b,P[2]=c,P[3]=d,P[4]=e,P[5]=g,P[6]=n,P[7]=t,P[8]=w,P[9]=z,P[10]=C,P[11]=H,P[12]=M,P[13]=
L,P[14]=O,P[15]=S,T.markAsUpdated(),T}static Compose(a,b,c){const d=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.ComposeToRef(a,b,c,d),d}static ComposeToRef(a,b,c,d){const e=d._m;var g=b._x,n=b._y,t=b._z,w=b._w,z=g+g,C=n+n,H=t+t;b=g*z;const M=g*C;g*=H;const L=n*C;n*=H;t*=H;z*=w;C*=w;w*=H;H=a._x;const O=a._y;a=a._z;return e[0]=(1-(L+t))*H,e[1]=(M+w)*H,e[2]=(g-C)*H,e[3]=0,e[4]=(M-w)*O,e[5]=(1-(b+t))*O,e[6]=(n+z)*O,e[7]=0,e[8]=(g+C)*a,e[9]=(n-z)*a,e[10]=(1-(b+L))*a,e[11]=0,
e[12]=c._x,e[13]=c._y,e[14]=c._z,e[15]=1,d.markAsUpdated(),d}static Identity(){const a=x$$module$libs$world_onscreen.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return a._updateIdentityStatus(!0),a}static IdentityToRef(a){return x$$module$libs$world_onscreen.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,a),a._updateIdentityStatus(!0),a}static Zero(){const a=x$$module$libs$world_onscreen.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return a._updateIdentityStatus(!1),a}static RotationX(a){const b=
new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.RotationXToRef(a,b),b}static Invert(a){const b=new a.constructor;return a.invertToRef(b),b}static RotationXToRef(a,b){const c=Math.sin(a);a=Math.cos(a);return x$$module$libs$world_onscreen.FromValuesToRef(1,0,0,0,0,a,c,0,0,-c,a,0,0,0,0,1,b),b._updateIdentityStatus(1===a&&0===c),b}static RotationY(a){const b=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.RotationYToRef(a,b),b}static RotationYToRef(a,b){const c=
Math.sin(a);a=Math.cos(a);return x$$module$libs$world_onscreen.FromValuesToRef(a,0,-c,0,0,1,0,0,c,0,a,0,0,0,0,1,b),b._updateIdentityStatus(1===a&&0===c),b}static RotationZ(a){const b=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.RotationZToRef(a,b),b}static RotationZToRef(a,b){const c=Math.sin(a);a=Math.cos(a);return x$$module$libs$world_onscreen.FromValuesToRef(a,c,0,0,-c,a,0,0,0,0,1,0,0,0,0,1,b),b._updateIdentityStatus(1===a&&0===c),b}static RotationAxis(a,b){const c=new x$$module$libs$world_onscreen;
return x$$module$libs$world_onscreen.RotationAxisToRef(a,b,c),c}static RotationAxisToRef(a,b,c){const d=Math.sin(-b);b=Math.cos(-b);const e=1-b;a.normalize();const g=c._m;return g[0]=a._x*a._x*e+b,g[1]=a._x*a._y*e-a._z*d,g[2]=a._x*a._z*e+a._y*d,g[3]=0,g[4]=a._y*a._x*e+a._z*d,g[5]=a._y*a._y*e+b,g[6]=a._y*a._z*e-a._x*d,g[7]=0,g[8]=a._z*a._x*e-a._y*d,g[9]=a._z*a._y*e+a._x*d,g[10]=a._z*a._z*e+b,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,c.markAsUpdated(),c}static RotationAlignToRef(a,b,c){const d=p$$module$libs$world_onscreen.Dot(b,
a),e=c._m;d<-1+Re$$module$libs$world_onscreen?(e[0]=-1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1):(a=p$$module$libs$world_onscreen.Cross(b,a),b=1/(1+d),e[0]=a._x*a._x*b+d,e[1]=a._y*a._x*b-a._z,e[2]=a._z*a._x*b+a._y,e[3]=0,e[4]=a._x*a._y*b+a._z,e[5]=a._y*a._y*b+d,e[6]=a._z*a._y*b-a._x,e[7]=0,e[8]=a._x*a._z*b-a._y,e[9]=a._y*a._z*b+a._x,e[10]=a._z*a._z*b+d);e[11]=0;return e[12]=0,e[13]=0,e[14]=0,e[15]=1,c.markAsUpdated(),c}static RotationYawPitchRoll(a,b,c){const d=new x$$module$libs$world_onscreen;
return x$$module$libs$world_onscreen.RotationYawPitchRollToRef(a,b,c,d),d}static RotationYawPitchRollToRef(a,b,c,d){return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(a,b,c,H$$module$libs$world_onscreen.Quaternion[0]),H$$module$libs$world_onscreen.Quaternion[0].toRotationMatrix(d),d}static Scaling(a,b,c){const d=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.ScalingToRef(a,b,c,d),d}static ScalingToRef(a,b,c,d){return x$$module$libs$world_onscreen.FromValuesToRef(a,
0,0,0,0,b,0,0,0,0,c,0,0,0,0,1,d),d._updateIdentityStatus(1===a&&1===b&&1===c),d}static Translation(a,b,c){const d=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.TranslationToRef(a,b,c,d),d}static TranslationToRef(a,b,c,d){return x$$module$libs$world_onscreen.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1,d),d._updateIdentityStatus(0===a&&0===b&&0===c),d}static Lerp(a,b,c){const d=new a.constructor;return x$$module$libs$world_onscreen.LerpToRef(a,b,c,d),d}static LerpToRef(a,
b,c,d){const e=d._m;a=a.m;b=b.m;for(let g=0;16>g;g++)e[g]=a[g]*(1-c)+b[g]*c;return d.markAsUpdated(),d}static DecomposeLerp(a,b,c){const d=new a.constructor;return x$$module$libs$world_onscreen.DecomposeLerpToRef(a,b,c,d),d}static DecomposeLerpToRef(a,b,c,d){var e=H$$module$libs$world_onscreen.Vector3[0],g=H$$module$libs$world_onscreen.Quaternion[0];const n=H$$module$libs$world_onscreen.Vector3[1];a.decompose(e,g,n);const t=H$$module$libs$world_onscreen.Vector3[2],w=H$$module$libs$world_onscreen.Quaternion[1];
a=H$$module$libs$world_onscreen.Vector3[3];b.decompose(t,w,a);b=H$$module$libs$world_onscreen.Vector3[4];p$$module$libs$world_onscreen.LerpToRef(e,t,c,b);e=H$$module$libs$world_onscreen.Quaternion[2];Y$$module$libs$world_onscreen.SlerpToRef(g,w,c,e);g=H$$module$libs$world_onscreen.Vector3[5];return p$$module$libs$world_onscreen.LerpToRef(n,a,c,g),x$$module$libs$world_onscreen.ComposeToRef(b,e,g,d),d}static LookAtLH(a,b,c){const d=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.LookAtLHToRef(a,
b,c,d),d}static LookAtLHToRef(a,b,c,d){const e=H$$module$libs$world_onscreen.Vector3[0],g=H$$module$libs$world_onscreen.Vector3[1],n=H$$module$libs$world_onscreen.Vector3[2];b.subtractToRef(a,n);n.normalize();p$$module$libs$world_onscreen.CrossToRef(c,n,e);b=e.lengthSquared();0===b?e.x=1:e.normalizeFromLength(Math.sqrt(b));p$$module$libs$world_onscreen.CrossToRef(n,e,g);g.normalize();b=-p$$module$libs$world_onscreen.Dot(e,a);c=-p$$module$libs$world_onscreen.Dot(g,a);a=-p$$module$libs$world_onscreen.Dot(n,
a);x$$module$libs$world_onscreen.FromValuesToRef(e._x,g._x,n._x,0,e._y,g._y,n._y,0,e._z,g._z,n._z,0,b,c,a,1,d)}static LookAtRH(a,b,c){const d=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.LookAtRHToRef(a,b,c,d),d}static LookAtRHToRef(a,b,c,d){const e=H$$module$libs$world_onscreen.Vector3[0],g=H$$module$libs$world_onscreen.Vector3[1],n=H$$module$libs$world_onscreen.Vector3[2];a.subtractToRef(b,n);n.normalize();p$$module$libs$world_onscreen.CrossToRef(c,n,e);b=e.lengthSquared();
0===b?e.x=1:e.normalizeFromLength(Math.sqrt(b));p$$module$libs$world_onscreen.CrossToRef(n,e,g);g.normalize();b=-p$$module$libs$world_onscreen.Dot(e,a);c=-p$$module$libs$world_onscreen.Dot(g,a);a=-p$$module$libs$world_onscreen.Dot(n,a);return x$$module$libs$world_onscreen.FromValuesToRef(e._x,g._x,n._x,0,e._y,g._y,n._y,0,e._z,g._z,n._z,0,b,c,a,1,d),d}static LookDirectionLH(a,b){const c=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.LookDirectionLHToRef(a,b,c),c}static LookDirectionLHToRef(a,
b,c){const d=H$$module$libs$world_onscreen.Vector3[0];d.copyFrom(a);d.scaleInPlace(-1);a=H$$module$libs$world_onscreen.Vector3[1];return p$$module$libs$world_onscreen.CrossToRef(b,d,a),x$$module$libs$world_onscreen.FromValuesToRef(a._x,a._y,a._z,0,b._x,b._y,b._z,0,d._x,d._y,d._z,0,0,0,0,1,c),c}static LookDirectionRH(a,b){const c=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.LookDirectionRHToRef(a,b,c),c}static LookDirectionRHToRef(a,b,c){const d=H$$module$libs$world_onscreen.Vector3[2];
return p$$module$libs$world_onscreen.CrossToRef(b,a,d),x$$module$libs$world_onscreen.FromValuesToRef(d._x,d._y,d._z,0,b._x,b._y,b._z,0,a._x,a._y,a._z,0,0,0,0,1,c),c}static OrthoLH(a,b,c,d,e){const g=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.OrthoLHToRef(a,b,c,d,g,e),g}static OrthoLHToRef(a,b,c,d,e,g){a=2/a;b=2/b;const n=2/(d-c);c=-(d+c)/(d-c);return x$$module$libs$world_onscreen.FromValuesToRef(a,0,0,0,0,b,0,0,0,0,n,0,0,0,c,1,e),g&&e.multiplyToRef(Yt$$module$libs$world_onscreen,
e),e._updateIdentityStatus(1===a&&1===b&&1===n&&0===c),e}static OrthoOffCenterLH(a,b,c,d,e,g,n){const t=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.OrthoOffCenterLHToRef(a,b,c,d,e,g,t,n),t}static OrthoOffCenterLHToRef(a,b,c,d,e,g,n,t){return x$$module$libs$world_onscreen.FromValuesToRef(2/(b-a),0,0,0,0,2/(d-c),0,0,0,0,2/(g-e),0,(a+b)/(a-b),(d+c)/(c-d),-(g+e)/(g-e),1,n),t&&n.multiplyToRef(Yt$$module$libs$world_onscreen,n),n.markAsUpdated(),n}static OrthoOffCenterRH(a,b,c,
d,e,g,n){const t=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.OrthoOffCenterRHToRef(a,b,c,d,e,g,t,n),t}static OrthoOffCenterRHToRef(a,b,c,d,e,g,n,t){return x$$module$libs$world_onscreen.OrthoOffCenterLHToRef(a,b,c,d,e,g,n,t),n._m[10]*=-1,n}static PerspectiveLH(a,b,c,d,e,g=0){const n=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.FromValuesToRef(2*c/a,0,0,0,0,2*c/b,0,Math.tan(g),0,0,(d+c)/(d-c),1,0,0,-2*d*c/(d-c),0,n),e&&n.multiplyToRef(Yt$$module$libs$world_onscreen,
n),n._updateIdentityStatus(!1),n}static PerspectiveFovLH(a,b,c,d,e,g=0,n=!1){const t=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.PerspectiveFovLHToRef(a,b,c,d,t,!0,e,g,n),t}static PerspectiveFovLHToRef(a,b,c,d,e,g=!0,n,t=0,w=!1){a=1/Math.tan(.5*a);return x$$module$libs$world_onscreen.FromValuesToRef(g?a/b:a,0,0,0,0,g?a:a*b,0,Math.tan(t),0,0,w&&0===c?-1:0!==d?(d+c)/(d-c):1,1,0,0,w&&0===c?2*d:0!==d?-2*d*c/(d-c):-2*c,0,e),n&&e.multiplyToRef(Yt$$module$libs$world_onscreen,e),
e._updateIdentityStatus(!1),e}static PerspectiveFovReverseLHToRef(a,b,c,d,e,g=!0,n,t=0){a=1/Math.tan(.5*a);return x$$module$libs$world_onscreen.FromValuesToRef(g?a/b:a,0,0,0,0,g?a:a*b,0,Math.tan(t),0,0,-c,1,0,0,1,0,e),n&&e.multiplyToRef(Yt$$module$libs$world_onscreen,e),e._updateIdentityStatus(!1),e}static PerspectiveFovRH(a,b,c,d,e,g=0,n=!1){const t=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.PerspectiveFovRHToRef(a,b,c,d,t,!0,e,g,n),t}static PerspectiveFovRHToRef(a,b,
c,d,e,g=!0,n,t=0,w=!1){a=1/Math.tan(.5*a);return x$$module$libs$world_onscreen.FromValuesToRef(g?a/b:a,0,0,0,0,g?a:a*b,0,Math.tan(t),0,0,w&&0===c?1:0!==d?-(d+c)/(d-c):-1,-1,0,0,w&&0===c?2*d:0!==d?-2*d*c/(d-c):-2*c,0,e),n&&e.multiplyToRef(Yt$$module$libs$world_onscreen,e),e._updateIdentityStatus(!1),e}static PerspectiveFovReverseRHToRef(a,b,c,d,e,g=!0,n,t=0){a=1/Math.tan(.5*a);return x$$module$libs$world_onscreen.FromValuesToRef(g?a/b:a,0,0,0,0,g?a:a*b,0,Math.tan(t),0,0,-c,-1,0,0,-1,0,e),n&&e.multiplyToRef(Yt$$module$libs$world_onscreen,
e),e._updateIdentityStatus(!1),e}static PerspectiveFovWebVRToRef(a,b,c,d,e=!1,g,n=0){const t=Math.tan(a.upDegrees*Math.PI/180),w=Math.tan(a.downDegrees*Math.PI/180),z=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);const C=2/(z+a),H=2/(t+w);n=Math.tan(n);const M=d._m;return M[0]=C,M[1]=M[2]=M[3]=M[4]=0,M[5]=H,M[6]=0,M[7]=n,M[8]=(z-a)*C*.5,M[9]=-((t-w)*H*.5),M[10]=-c/(b-c),M[11]=e?-1:1,M[12]=M[13]=M[15]=0,M[14]=-(2*c*b)/(c-b),g&&d.multiplyToRef(Yt$$module$libs$world_onscreen,
d),d.markAsUpdated(),d}static GetFinalMatrix(a,b,c,d,e,g){const n=a.width,t=a.height;a=x$$module$libs$world_onscreen.FromValues(n/2,0,0,0,0,-t/2,0,0,0,0,g-e,0,a.x+n/2,t/2+a.y,e,1);e=new b.constructor;return b.multiplyToRef(c,e),e.multiplyToRef(d,e),e.multiplyToRef(a,e)}static GetAsMatrix2x2(a){a=a.m;a=[a[0],a[1],a[4],a[5]];return Ne$$module$libs$world_onscreen.MatrixUse64Bits?a:new Float32Array(a)}static GetAsMatrix3x3(a){a=a.m;a=[a[0],a[1],a[2],a[4],a[5],a[6],a[8],a[9],a[10]];return Ne$$module$libs$world_onscreen.MatrixUse64Bits?
a:new Float32Array(a)}static Transpose(a){const b=new a.constructor;return x$$module$libs$world_onscreen.TransposeToRef(a,b),b}static TransposeToRef(a,b){const c=b._m,d=a.m;return c[0]=d[0],c[1]=d[4],c[2]=d[8],c[3]=d[12],c[4]=d[1],c[5]=d[5],c[6]=d[9],c[7]=d[13],c[8]=d[2],c[9]=d[6],c[10]=d[10],c[11]=d[14],c[12]=d[3],c[13]=d[7],c[14]=d[11],c[15]=d[15],b.markAsUpdated(),b._updateIdentityStatus(a._isIdentity,a._isIdentityDirty),b}static Reflection(a){const b=new x$$module$libs$world_onscreen;return x$$module$libs$world_onscreen.ReflectionToRef(a,
b),b}static ReflectionToRef(a,b){a.normalize();const c=a.normal.x,d=a.normal.y,e=a.normal.z,g=-2*c,n=-2*d,t=-2*e;return x$$module$libs$world_onscreen.FromValuesToRef(g*c+1,n*c,t*c,0,g*d,n*d+1,t*d,0,g*e,n*e,t*e+1,0,g*a.d,n*a.d,t*a.d,1,b),b}static FromXYZAxesToRef(a,b,c,d){return x$$module$libs$world_onscreen.FromValuesToRef(a._x,a._y,a._z,0,b._x,b._y,b._z,0,c._x,c._y,c._z,0,0,0,0,1,d),d}static FromQuaternionToRef(a,b){const c=a._x*a._x,d=a._y*a._y,e=a._z*a._z,g=a._x*a._y,n=a._z*a._w,t=a._z*a._x,w=
a._y*a._w,z=a._y*a._z;a=a._x*a._w;return b._m[0]=1-2*(d+e),b._m[1]=2*(g+n),b._m[2]=2*(t-w),b._m[3]=0,b._m[4]=2*(g-n),b._m[5]=1-2*(e+c),b._m[6]=2*(z+a),b._m[7]=0,b._m[8]=2*(t+w),b._m[9]=2*(z-a),b._m[10]=1-2*(d+c),b._m[11]=0,b._m[12]=0,b._m[13]=0,b._m[14]=0,b._m[15]=1,b.markAsUpdated(),b}}x$$module$libs$world_onscreen._UpdateFlagSeed=0;x$$module$libs$world_onscreen._IdentityReadOnly=x$$module$libs$world_onscreen.Identity();class H$$module$libs$world_onscreen{}
H$$module$libs$world_onscreen.Vector3=Ye$$module$libs$world_onscreen.BuildTuple(11,p$$module$libs$world_onscreen.Zero);H$$module$libs$world_onscreen.Matrix=Ye$$module$libs$world_onscreen.BuildTuple(2,x$$module$libs$world_onscreen.Identity);H$$module$libs$world_onscreen.Quaternion=Ye$$module$libs$world_onscreen.BuildTuple(3,Y$$module$libs$world_onscreen.Zero);class D$$module$libs$world_onscreen{}D$$module$libs$world_onscreen.Vector2=Ye$$module$libs$world_onscreen.BuildTuple(3,Te$$module$libs$world_onscreen.Zero);
D$$module$libs$world_onscreen.Vector3=Ye$$module$libs$world_onscreen.BuildTuple(13,p$$module$libs$world_onscreen.Zero);D$$module$libs$world_onscreen.Vector4=Ye$$module$libs$world_onscreen.BuildTuple(3,Ae$$module$libs$world_onscreen.Zero);D$$module$libs$world_onscreen.Quaternion=Ye$$module$libs$world_onscreen.BuildTuple(2,Y$$module$libs$world_onscreen.Zero);D$$module$libs$world_onscreen.Matrix=Ye$$module$libs$world_onscreen.BuildTuple(8,x$$module$libs$world_onscreen.Identity);
st$$module$libs$world_onscreen("BABYLON.Vector2",Te$$module$libs$world_onscreen);st$$module$libs$world_onscreen("BABYLON.Vector3",p$$module$libs$world_onscreen);st$$module$libs$world_onscreen("BABYLON.Vector4",Ae$$module$libs$world_onscreen);st$$module$libs$world_onscreen("BABYLON.Matrix",x$$module$libs$world_onscreen);const Yt$$module$libs$world_onscreen=x$$module$libs$world_onscreen.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);
class qr$$module$libs$world_onscreen{constructor(a,b=!1,c,d){this.initialize(a,b,c,d)}initialize(a,b=!1,c,d){return this.mask=a,this.skipNextObservers=b,this.target=c,this.currentTarget=d,this}}class jr$$module$libs$world_onscreen{constructor(a,b,c=null){this.callback=a;this.mask=b;this.scope=c;this.unregisterOnNextCall=this._willBeUnregistered=!1}}
class w$$module$libs$world_onscreen{constructor(a){this._observers=[];this._numObserversMarkedAsDeleted=0;this._eventState=new qr$$module$libs$world_onscreen(0);a&&(this._onObserverAdded=a)}static FromPromise(a,b){const c=new w$$module$libs$world_onscreen;return a.then(d=>{c.notifyObservers(d)}).catch(d=>{if(b)b.notifyObservers(d);else throw d;}),c}get observers(){return this._observers}add(a,b=-1,c=!1,d=null,e=!1){if(!a)return null;a=new jr$$module$libs$world_onscreen(a,b,d);return a.unregisterOnNextCall=
e,c?this._observers.unshift(a):this._observers.push(a),this._onObserverAdded&&this._onObserverAdded(a),a}addOnce(a){return this.add(a,void 0,void 0,void 0,!0)}remove(a){return a&&-1!==this._observers.indexOf(a)?(this._deferUnregister(a),!0):!1}removeCallback(a,b){for(let c=0;c<this._observers.length;c++){const d=this._observers[c];if(!(d._willBeUnregistered||d.callback!==a||b&&b!==d.scope))return this._deferUnregister(d),!0}return!1}_deferUnregister(a){this._numObserversMarkedAsDeleted++;a.unregisterOnNextCall=
!1;a._willBeUnregistered=!0;setTimeout(()=>{this._remove(a)},0)}_remove(a){if(!a)return!1;a=this._observers.indexOf(a);return-1!==a?(this._numObserversMarkedAsDeleted--,this._observers.splice(a,1),!0):!1}makeObserverTopPriority(a){this._remove(a);this._observers.unshift(a)}makeObserverBottomPriority(a){this._remove(a);this._observers.push(a)}notifyObservers(a,b=-1,c,d,e){if(!this._observers.length)return!0;const g=this._eventState;g.mask=b;g.target=c;g.currentTarget=d;g.skipNextObservers=!1;g.lastReturnValue=
a;g.userInfo=e;for(const n of this._observers)if(!n._willBeUnregistered&&(n.mask&b&&(n.unregisterOnNextCall&&this._deferUnregister(n),n.scope?g.lastReturnValue=n.callback.apply(n.scope,[a,g]):g.lastReturnValue=n.callback(a,g)),g.skipNextObservers))return!1;return!0}notifyObserver(a,b,c=-1){if(!a._willBeUnregistered){var d=this._eventState;d.mask=c;d.skipNextObservers=!1;a.unregisterOnNextCall&&this._deferUnregister(a);a.callback(b,d)}}hasObservers(){return 0<this._observers.length-this._numObserversMarkedAsDeleted}clear(){this._observers=
[];this._onObserverAdded=null}clone(){const a=new w$$module$libs$world_onscreen;return a._observers=this._observers.slice(0),a}hasSpecificMask(a=-1){for(const b of this._observers)if(b.mask&a||b.mask===a)return!0;return!1}}
class $r$$module$libs$world_onscreen{constructor(){this.samplingMode=-1;this._useMipMaps=!0;this._cachedAnisotropicFilteringLevel=this._cachedWrapR=this._cachedWrapV=this._cachedWrapU=null;this._comparisonFunction=0}get wrapU(){return this._cachedWrapU}set wrapU(a){this._cachedWrapU=a}get wrapV(){return this._cachedWrapV}set wrapV(a){this._cachedWrapV=a}get wrapR(){return this._cachedWrapR}set wrapR(a){this._cachedWrapR=a}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(a){this._cachedAnisotropicFilteringLevel=
a}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(a){this._comparisonFunction=a}get useMipMaps(){return this._useMipMaps}set useMipMaps(a){this._useMipMaps=a}setParameters(a=1,b=1,c=1,d=1,e=2,g=0){return this._cachedWrapU=a,this._cachedWrapV=b,this._cachedWrapR=c,this._cachedAnisotropicFilteringLevel=d,this.samplingMode=e,this._comparisonFunction=g,this}compareSampler(a){return this._cachedWrapU===a._cachedWrapU&&this._cachedWrapV===a._cachedWrapV&&this._cachedWrapR===
a._cachedWrapR&&this._cachedAnisotropicFilteringLevel===a._cachedAnisotropicFilteringLevel&&this.samplingMode===a.samplingMode&&this._comparisonFunction===a._comparisonFunction&&this._useMipMaps===a._useMipMaps}}var Oe$$module$libs$world_onscreen;
(function(a){a[a.Unknown=0]="Unknown";a[a.Url=1]="Url";a[a.Temp=2]="Temp";a[a.Raw=3]="Raw";a[a.Dynamic=4]="Dynamic";a[a.RenderTarget=5]="RenderTarget";a[a.MultiRenderTarget=6]="MultiRenderTarget";a[a.Cube=7]="Cube";a[a.CubeRaw=8]="CubeRaw";a[a.CubePrefiltered=9]="CubePrefiltered";a[a.Raw3D=10]="Raw3D";a[a.Raw2DArray=11]="Raw2DArray";a[a.DepthStencil=12]="DepthStencil";a[a.CubeRawRGBD=13]="CubeRawRGBD";a[a.Depth=14]="Depth"})(Oe$$module$libs$world_onscreen||={});
class Vt$$module$libs$world_onscreen extends $r$$module$libs$world_onscreen{constructor(a,b,c=!1){super();this.isMultiview=this.is2DArray=this.is3D=this.isCube=this.isReady=!1;this.url="";this.generateMipMaps=!1;this.samples=0;this.format=this.type=-1;this.onLoadedObservable=new w$$module$libs$world_onscreen;this.onErrorObservable=new w$$module$libs$world_onscreen;this.onRebuildCallback=null;this.baseDepth=this.baseHeight=this.baseWidth=this.depth=this.height=this.width=0;this._invertVScale=this.invertY=
!1;this._associatedChannel=-1;this._source=Oe$$module$libs$world_onscreen.Unknown;this._bufferViewArrayArray=this._bufferViewArray=this._bufferView=this._buffer=null;this._size=0;this._extension="";this._cachedCoordinatesMode=this._workingContext=this._workingCanvas=this._files=null;this._isDisabled=!1;this._sphericalPolynomialPromise=this._sphericalPolynomial=this._compression=null;this._sphericalPolynomialComputed=!1;this._lodGenerationOffset=this._lodGenerationScale=0;this._useSRGBBuffer=!1;this._lodTextureLow=
this._lodTextureMid=this._lodTextureHigh=null;this._linearSpecularLOD=this._isRGBD=!1;this._maxLodLevel=this._hardwareTexture=this._irradianceTexture=null;this._references=1;this._gammaSpace=null;this._engine=a;this._source=b;this._uniqueId=Vt$$module$libs$world_onscreen._Counter++;c||(this._hardwareTexture=a._createHardwareTexture())}get useMipMaps(){return this.generateMipMaps}set useMipMaps(a){this.generateMipMaps=a}get uniqueId(){return this._uniqueId}_setUniqueId(a){this._uniqueId=a}getEngine(){return this._engine}get source(){return this._source}incrementReferences(){this._references++}updateSize(a,
b,c=1){this._engine.updateTextureDimensions(this,a,b,c);this.width=a;this.height=b;this.depth=c;this.baseWidth=a;this.baseHeight=b;this.baseDepth=c;this._size=a*b*c}_rebuild(){if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const c=this.onRebuildCallback(this);var a=d=>{d._swapAndDie(this,!1);this.isReady=c.isReady};c.isAsync?c.proxy.then(a):a(c.proxy)}else switch(this.source){case Oe$$module$libs$world_onscreen.Url:var b=
this._engine.createTexture(null!==(a=this._originalUrl)&&void 0!==a?a:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,c=>{c._swapAndDie(this,!1);this.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer);break;case Oe$$module$libs$world_onscreen.Raw:b=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,void 0,
this._useSRGBBuffer);b._swapAndDie(this,!1);this.isReady=!0;break;case Oe$$module$libs$world_onscreen.Raw3D:b=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type);b._swapAndDie(this,!1);this.isReady=!0;break;case Oe$$module$libs$world_onscreen.Raw2DArray:b=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,
this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type);b._swapAndDie(this,!1);this.isReady=!0;break;case Oe$$module$libs$world_onscreen.Dynamic:b=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode);b._swapAndDie(this,!1);this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case Oe$$module$libs$world_onscreen.Cube:b=this._engine.createCubeTexture(this.url,null,this._files,
!this.generateMipMaps,()=>{b._swapAndDie(this,!1);this.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer);break;case Oe$$module$libs$world_onscreen.CubeRaw:b=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression);b._swapAndDie(this,!1);this.isReady=!0;break;case Oe$$module$libs$world_onscreen.CubePrefiltered:b=this._engine.createPrefilteredCubeTexture(this.url,
null,this._lodGenerationScale,this._lodGenerationOffset,c=>{c&&c._swapAndDie(this,!1);this.isReady=!0},null,this.format,this._extension),b._sphericalPolynomial=this._sphericalPolynomial}}_swapAndDie(a,b=!0){var c;null===(c=this._hardwareTexture)||void 0===c||c.setUsage(a._source,this.generateMipMaps,this.isCube,this.width,this.height);a._hardwareTexture=this._hardwareTexture;b&&(a._isRGBD=this._isRGBD);this._lodTextureHigh&&(a._lodTextureHigh&&a._lodTextureHigh.dispose(),a._lodTextureHigh=this._lodTextureHigh);
this._lodTextureMid&&(a._lodTextureMid&&a._lodTextureMid.dispose(),a._lodTextureMid=this._lodTextureMid);this._lodTextureLow&&(a._lodTextureLow&&a._lodTextureLow.dispose(),a._lodTextureLow=this._lodTextureLow);this._irradianceTexture&&(a._irradianceTexture&&a._irradianceTexture.dispose(),a._irradianceTexture=this._irradianceTexture);b=this._engine.getLoadedTexturesCache();c=b.indexOf(this);-1!==c&&b.splice(c,1);c=b.indexOf(a);-1===c&&b.push(a)}dispose(){this._references--;this.onLoadedObservable.clear();
this.onErrorObservable.clear();0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null)}}Vt$$module$libs$world_onscreen._Counter=0;function Ze$$module$libs$world_onscreen(){return"u">typeof window}function xr$$module$libs$world_onscreen(){return"u">typeof navigator}function Di$$module$libs$world_onscreen(){return"u">typeof document}function Bs$$module$libs$world_onscreen(a){let b="";for(a=a.firstChild;a;)3===a.nodeType&&(b+=a.textContent),a=a.nextSibling;return b}
const Fs$$module$libs$world_onscreen={IsWindowObjectExist:Ze$$module$libs$world_onscreen,IsNavigatorAvailable:xr$$module$libs$world_onscreen,IsDocumentAvailable:Di$$module$libs$world_onscreen,GetDOMTextContent:Bs$$module$libs$world_onscreen};function $$$module$libs$world_onscreen(a){return`${a} needs to be imported before as it contains a side-effect required by your code.`}
class O$$module$libs$world_onscreen{static _CheckLimit(a,b){let c=O$$module$libs$world_onscreen._LogLimitOutputs[a];return c?c.current++:(c={limit:b,current:1},O$$module$libs$world_onscreen._LogLimitOutputs[a]=c),c.current<=c.limit}static _GenerateLimitMessage(a,b=1){var c;(a=O$$module$libs$world_onscreen._LogLimitOutputs[a])&&O$$module$libs$world_onscreen.MessageLimitReached&&(b=this._Levels[b],a.current===a.limit&&O$$module$libs$world_onscreen[b.name](O$$module$libs$world_onscreen.MessageLimitReached.replace(/%LIMIT%/g,
""+a.limit).replace(/%TYPE%/g,null!==(c=b.name)&&void 0!==c?c:"")))}static _AddLogEntry(a){O$$module$libs$world_onscreen._LogCache=a+O$$module$libs$world_onscreen._LogCache;O$$module$libs$world_onscreen.OnNewCacheEntry&&O$$module$libs$world_onscreen.OnNewCacheEntry(a)}static _FormatMessage(a){const b=d=>10>d?"0"+d:""+d,c=new Date;return"["+b(c.getHours())+":"+b(c.getMinutes())+":"+b(c.getSeconds())+"]: "+a}static _LogDisabled(a,b){}static _LogEnabled(a=1,b,c){if(void 0===c||O$$module$libs$world_onscreen._CheckLimit(b,
c)){c=O$$module$libs$world_onscreen._FormatMessage(b);var d=this._Levels[a];d.logFunc&&d.logFunc("BJS - "+c);O$$module$libs$world_onscreen._AddLogEntry(`<div style='color:${d.color}'>${c}</div><br>`);O$$module$libs$world_onscreen._GenerateLimitMessage(b,a)}}static get LogCache(){return O$$module$libs$world_onscreen._LogCache}static ClearLogCache(){O$$module$libs$world_onscreen._LogCache="";O$$module$libs$world_onscreen._LogLimitOutputs={};O$$module$libs$world_onscreen.errorsCount=0}static set LogLevels(a){O$$module$libs$world_onscreen.Log=
O$$module$libs$world_onscreen._LogDisabled;O$$module$libs$world_onscreen.Warn=O$$module$libs$world_onscreen._LogDisabled;O$$module$libs$world_onscreen.Error=O$$module$libs$world_onscreen._LogDisabled;[O$$module$libs$world_onscreen.MessageLogLevel,O$$module$libs$world_onscreen.WarningLogLevel,O$$module$libs$world_onscreen.ErrorLogLevel].forEach(b=>{(a&b)===b&&(O$$module$libs$world_onscreen[this._Levels[b].name]=O$$module$libs$world_onscreen._LogEnabled.bind(O$$module$libs$world_onscreen,b))})}}
O$$module$libs$world_onscreen.NoneLogLevel=0;O$$module$libs$world_onscreen.MessageLogLevel=1;O$$module$libs$world_onscreen.WarningLogLevel=2;O$$module$libs$world_onscreen.ErrorLogLevel=4;O$$module$libs$world_onscreen.AllLogLevel=7;O$$module$libs$world_onscreen.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.";O$$module$libs$world_onscreen._LogCache="";O$$module$libs$world_onscreen._LogLimitOutputs={};
O$$module$libs$world_onscreen._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}];O$$module$libs$world_onscreen.errorsCount=0;O$$module$libs$world_onscreen.Log=O$$module$libs$world_onscreen._LogEnabled.bind(O$$module$libs$world_onscreen,O$$module$libs$world_onscreen.MessageLogLevel);
O$$module$libs$world_onscreen.Warn=O$$module$libs$world_onscreen._LogEnabled.bind(O$$module$libs$world_onscreen,O$$module$libs$world_onscreen.WarningLogLevel);O$$module$libs$world_onscreen.Error=O$$module$libs$world_onscreen._LogEnabled.bind(O$$module$libs$world_onscreen,O$$module$libs$world_onscreen.ErrorLogLevel);const Qr$$module$libs$world_onscreen="attribute",Jr$$module$libs$world_onscreen="varying";
class Ci$$module$libs$world_onscreen{constructor(){this.children=[]}isValid(a){return!0}process(a,b){var c,d,e,g,n,t;let w="";if(this.line){let z=this.line;const C=b.processor;if(C){C.lineProcessor&&(z=C.lineProcessor(z,b.isFragment,b.processingContext));const H=null!==(d=null===(c=b.processor)||void 0===c?void 0:c.attributeKeywordName)&&void 0!==d?d:Qr$$module$libs$world_onscreen;c=b.isFragment&&null!==(e=b.processor)&&void 0!==e&&e.varyingFragmentKeywordName?null===(g=b.processor)||void 0===g?void 0:
g.varyingFragmentKeywordName:!b.isFragment&&null!==(n=b.processor)&&void 0!==n&&n.varyingVertexKeywordName?null===(t=b.processor)||void 0===t?void 0:t.varyingVertexKeywordName:Jr$$module$libs$world_onscreen;!b.isFragment&&C.attributeProcessor&&this.line.startsWith(H)?z=C.attributeProcessor(this.line,a,b.processingContext):C.varyingProcessor&&this.line.startsWith(c)?z=C.varyingProcessor(this.line,b.isFragment,a,b.processingContext):C.uniformProcessor&&C.uniformRegexp&&C.uniformRegexp.test(this.line)?
b.lookForClosingBracketForUniformBuffer||(z=C.uniformProcessor(this.line,b.isFragment,a,b.processingContext)):C.uniformBufferProcessor&&C.uniformBufferRegexp&&C.uniformBufferRegexp.test(this.line)?b.lookForClosingBracketForUniformBuffer||(z=C.uniformBufferProcessor(this.line,b.isFragment,b.processingContext),b.lookForClosingBracketForUniformBuffer=!0):C.textureProcessor&&C.textureRegexp&&C.textureRegexp.test(this.line)?z=C.textureProcessor(this.line,b.isFragment,a,b.processingContext):(C.uniformProcessor||
C.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!b.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?C.uniformProcessor&&(z=C.uniformProcessor(this.line,b.isFragment,a,b.processingContext)):C.uniformBufferProcessor&&(z=C.uniformBufferProcessor(this.line,b.isFragment,b.processingContext),b.lookForClosingBracketForUniformBuffer=!0));b.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(b.lookForClosingBracketForUniformBuffer=
!1,C.endOfUniformBufferProcessor&&(z=C.endOfUniformBufferProcessor(this.line,b.isFragment,b.processingContext)))}w+=z+"\r\n"}return this.children.forEach(z=>{w+=z.process(a,b)}),this.additionalDefineKey&&(a[this.additionalDefineKey]=this.additionalDefineValue||"true"),w}}
class en$$module$libs$world_onscreen{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(a){this._lines.length=0;for(const b of a)if("#"===b[0])this._lines.push(b);else if(b.trim().startsWith("//"))this._lines.push(b);else{a=b.split(";");for(let c=0;c<a.length;c++){let d=a[c];(d=d.trim())&&this._lines.push(d+(c!==a.length-1?";":""))}}}}
class bs$$module$libs$world_onscreen extends Ci$$module$libs$world_onscreen{process(a,b){for(let c=0;c<this.children.length;c++){const d=this.children[c];if(d.isValid(a))return d.process(a,b)}return""}}class tn$$module$libs$world_onscreen extends Ci$$module$libs$world_onscreen{isValid(a){return this.testExpression.isTrue(a)}}
class Je$$module$libs$world_onscreen{isTrue(a){return!0}static postfixToInfix(a){const b=[];for(const c of a)if(void 0===Je$$module$libs$world_onscreen._OperatorPriority[c])b.push(c);else{a=b[b.length-1];const d=b[b.length-2];b.length-=2;b.push(`(${d}${c}${a})`)}return b[b.length-1]}static infixToPostfix(a){const b=[];let c=-1;const d=()=>{t=t.trim();""!==t&&(b.push(t),t="")},e=w=>{c<Je$$module$libs$world_onscreen._Stack.length-1&&(Je$$module$libs$world_onscreen._Stack[++c]=w)},g=()=>-1===c?"!!INVALID EXPRESSION!!":
Je$$module$libs$world_onscreen._Stack[c--];let n=0,t="";for(;n<a.length;){const w=a.charAt(n),z=n<a.length-1?a.substr(n,2):"";if("("===w)t="",e(w);else if(")"===w){for(d();-1!==c&&"("!==Je$$module$libs$world_onscreen._Stack[c];)b.push(g());g()}else if(1<Je$$module$libs$world_onscreen._OperatorPriority[z]){for(d();-1!==c&&Je$$module$libs$world_onscreen._OperatorPriority[Je$$module$libs$world_onscreen._Stack[c]]>=Je$$module$libs$world_onscreen._OperatorPriority[z];)b.push(g());e(z);n++}else t+=w;n++}for(d();-1!==
c;)"("===Je$$module$libs$world_onscreen._Stack[c]?g():b.push(g());return b}}Je$$module$libs$world_onscreen._OperatorPriority={")":0,"(":1,"||":2,"&&":3};Je$$module$libs$world_onscreen._Stack="                   ".split(" ");class Hi$$module$libs$world_onscreen extends Je$$module$libs$world_onscreen{constructor(a,b=!1){super();this.define=a;this.not=b}isTrue(a){a=void 0!==a[this.define];return this.not&&(a=!a),a}}
class sn$$module$libs$world_onscreen extends Je$$module$libs$world_onscreen{isTrue(a){return this.leftOperand.isTrue(a)||this.rightOperand.isTrue(a)}}class rn$$module$libs$world_onscreen extends Je$$module$libs$world_onscreen{isTrue(a){return this.leftOperand.isTrue(a)&&this.rightOperand.isTrue(a)}}
class nn$$module$libs$world_onscreen extends Je$$module$libs$world_onscreen{constructor(a,b,c){super();this.define=a;this.operand=b;this.testValue=c}isTrue(a){var b=a[this.define];void 0===b&&(b=this.define);a=!1;b=parseInt(b);const c=parseInt(this.testValue);switch(this.operand){case ">":a=b>c;break;case "<":a=b<c;break;case "<=":a=b<=c;break;case ">=":a=b>=c;break;case "==":a=b===c}return a}}var Ke$$module$libs$world_onscreen;
(function(a){a[a.GLSL=0]="GLSL";a[a.WGSL=1]="WGSL"})(Ke$$module$libs$world_onscreen||={});const an$$module$libs$world_onscreen=/defined\s*?\((.+?)\)/g,Ss$$module$libs$world_onscreen=/defined\s*?\[(.+?)\]/g,$s$$module$libs$world_onscreen=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g;
class ni$$module$libs$world_onscreen{static Initialize(a){a.processor&&a.processor.initializeShaders&&a.processor.initializeShaders(a.processingContext)}static Process(a,b,c,d){var e;null!==(e=b.processor)&&void 0!==e&&e.preProcessShaderCode&&(a=b.processor.preProcessShaderCode(a,b.isFragment));this._ProcessIncludes(a,b,g=>{b.processCodeAfterIncludes&&(g=b.processCodeAfterIncludes(b.isFragment?"fragment":"vertex",g));const n=this._ProcessShaderConversion(g,b,d);c(n,g)})}static PreProcess(a,b,c,d){var e;
null!==(e=b.processor)&&void 0!==e&&e.preProcessShaderCode&&(a=b.processor.preProcessShaderCode(a,b.isFragment));this._ProcessIncludes(a,b,g=>{b.processCodeAfterIncludes&&(g=b.processCodeAfterIncludes(b.isFragment?"fragment":"vertex",g));const n=this._ApplyPreProcessing(g,b,d);c(n,g)})}static Finalize(a,b,c){return c.processor&&c.processor.finalizeShaders?c.processor.finalizeShaders(a,b,c.processingContext):{vertexCode:a,fragmentCode:b}}static _ProcessPrecision(a,b){var c;if(null!==(c=b.processor)&&
void 0!==c&&c.noPrecision)return a;b=b.shouldUseHighPrecisionShader;return-1===a.indexOf("precision highp float")?b?a="precision highp float;\n"+a:a="precision mediump float;\n"+a:b||(a=a.replace("precision highp float","precision mediump float")),a}static _ExtractOperation(a){var b=/defined\((.+)\)/.exec(a);if(b&&b.length)return new Hi$$module$libs$world_onscreen(b[1].trim(),"!"===a[0]);var c=["==",">=","<=","<",">"];b="";let d=0;for(b of c)if(d=a.indexOf(b),-1<d)break;if(-1===d)return new Hi$$module$libs$world_onscreen(a);
c=a.substring(0,d).trim();a=a.substring(d+b.length).trim();return new nn$$module$libs$world_onscreen(c,b,a)}static _BuildSubExpression(a){a=a.replace(an$$module$libs$world_onscreen,"defined[$1]");var b=Je$$module$libs$world_onscreen.infixToPostfix(a);a=[];for(var c of b)if("||"!==c&&"&&"!==c)a.push(c);else if(2<=a.length){b=a[a.length-1];let d=a[a.length-2];a.length-=2;const e="&&"==c?new rn$$module$libs$world_onscreen:new sn$$module$libs$world_onscreen;"string"==typeof b&&(b=b.replace(Ss$$module$libs$world_onscreen,
"defined($1)"));"string"==typeof d&&(d=d.replace(Ss$$module$libs$world_onscreen,"defined($1)"));e.leftOperand="string"==typeof d?this._ExtractOperation(d):d;e.rightOperand="string"==typeof b?this._ExtractOperation(b):b;a.push(e)}c=a[a.length-1];return"string"==typeof c&&(c=c.replace(Ss$$module$libs$world_onscreen,"defined($1)")),"string"==typeof c?this._ExtractOperation(c):c}static _BuildExpression(a,b){const c=new tn$$module$libs$world_onscreen,d=a.substring(0,b);a=a.substring(b);return a=a.substring(0,
(a.indexOf("//")+1||a.length+1)-1).trim(),"#ifdef"===d?c.testExpression=new Hi$$module$libs$world_onscreen(a):"#ifndef"===d?c.testExpression=new Hi$$module$libs$world_onscreen(a,!0):c.testExpression=this._BuildSubExpression(a),c}static _MoveCursorWithinIf(a,b,c){let d;for(;this._MoveCursor(a,c);){d=a.currentLine;const e=d.substring(0,5).toLowerCase();if("#else"===e){c=new Ci$$module$libs$world_onscreen;b.children.push(c);this._MoveCursor(a,c);break}else"#elif"===e&&(c=this._BuildExpression(d,5),b.children.push(c))}}static _MoveCursor(a,
b){for(;a.canRead;){a.lineIndex++;var c=a.currentLine,d=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(c);if(d&&d.length)switch(d[0]){case "#ifdef":d=new bs$$module$libs$world_onscreen;b.children.push(d);c=this._BuildExpression(c,6);d.children.push(c);this._MoveCursorWithinIf(a,d,c);break;case "#else":case "#elif":return!0;case "#endif":return!1;case "#ifndef":d=new bs$$module$libs$world_onscreen;b.children.push(d);c=this._BuildExpression(c,7);d.children.push(c);this._MoveCursorWithinIf(a,
d,c);break;case "#if":d=new bs$$module$libs$world_onscreen,c=this._BuildExpression(c,3),b.children.push(d),d.children.push(c),this._MoveCursorWithinIf(a,d,c)}else if(d=new Ci$$module$libs$world_onscreen,d.line=c,b.children.push(d),"#"===c[0]&&"d"===c[1])c=c.replace(";","").split(" "),d.additionalDefineKey=c[1],3===c.length&&(d.additionalDefineValue=c[2])}return!1}static _EvaluatePreProcessors(a,b,c){const d=new Ci$$module$libs$world_onscreen,e=new en$$module$libs$world_onscreen;return e.lineIndex=
-1,e.lines=a.split("\n"),this._MoveCursor(e,d),d.process(b,c)}static _PreparePreProcessors(a,b){var c,d=a.defines;const e={};for(const g of d)d=g.replace("#define","").replace(";","").trim().split(" "),e[d[0]]=1<d.length?d[1]:"";return(null===(c=a.processor)||void 0===c?void 0:c.shaderLanguage)===Ke$$module$libs$world_onscreen.GLSL&&(e.GL_ES="true"),e.__VERSION__=a.version,e[a.platformName]="true",b._getGlobalDefines(e),e}static _ProcessShaderConversion(a,b,c){a=this._ProcessPrecision(a,b);if(!b.processor||
b.processor.shaderLanguage===Ke$$module$libs$world_onscreen.GLSL&&-1!==a.indexOf("#version 3")&&(a=a.replace("#version 300 es",""),!b.processor.parseGLES3))return a;const d=b.defines,e=this._PreparePreProcessors(b,c);return b.processor.preProcessor&&(a=b.processor.preProcessor(a,d,b.isFragment,b.processingContext)),a=this._EvaluatePreProcessors(a,e,b),b.processor.postProcessor&&(a=b.processor.postProcessor(a,d,b.isFragment,b.processingContext,c)),c._features.needShaderCodeInlining&&(a=c.inlineShaderCode(a)),
a}static _ApplyPreProcessing(a,b,c){var d,e;const g=b.defines,n=this._PreparePreProcessors(b,c);return!(null===(d=b.processor)||void 0===d)&&d.preProcessor&&(a=b.processor.preProcessor(a,g,b.isFragment,b.processingContext)),a=this._EvaluatePreProcessors(a,n,b),!(null===(e=b.processor)||void 0===e)&&e.postProcessor&&(a=b.processor.postProcessor(a,g,b.isFragment,b.processingContext,c)),c._features.needShaderCodeInlining&&(a=c.inlineShaderCode(a)),a}static _ProcessIncludes(a,b,c){let d=$s$$module$libs$world_onscreen.exec(a),
e=new String(a),g=!1;for(;null!=d;){let z=d[1];if(-1!==z.indexOf("__decl__")&&(z=z.replace(/__decl__/,""),b.supportsUniformBuffers&&(z=z.replace(/Vertex/,"Ubo"),z=z.replace(/Fragment/,"Ubo")),z+="Declaration"),b.includesShadersStore[z]){let C=b.includesShadersStore[z];if(d[2]){var n=d[3].split(",");for(var t=0;t<n.length;t+=2)C=C.replace(new RegExp(n[t],"g"),n[t+1])}if(d[4])if(n=d[5],-1!==n.indexOf("..")){var w=n.split("..");const H=parseInt(w[0]);n=parseInt(w[1]);t=C.slice(0);C="";isNaN(n)&&(n=b.indexParameters[w[1]]);
for(w=H;w<n;w++)b.supportsUniformBuffers||(t=t.replace(/light\{X\}.(\w*)/g,(M,L)=>L+"{X}")),C+=t.replace(/\{X\}/g,w.toString())+"\n"}else b.supportsUniformBuffers||(C=C.replace(/light\{X\}.(\w*)/g,(H,M)=>M+"{X}")),C=C.replace(/\{X\}/g,n);e=e.replace(d[0],C);g=g||0<=C.indexOf("#include<")||0<=C.indexOf("#include <")}else{ni$$module$libs$world_onscreen._FileToolsLoadFile(b.shadersRepository+"ShadersInclude/"+z+".fx",C=>{b.includesShadersStore[z]=C;this._ProcessIncludes(e,b,c)});return}d=$s$$module$libs$world_onscreen.exec(a)}g?
this._ProcessIncludes(e.toString(),b,c):c(e)}static _FileToolsLoadFile(a,b,c,d,e,g){throw $$$module$libs$world_onscreen("FileTools");}}
class U$$module$libs$world_onscreen{static GetShadersRepository(a=Ke$$module$libs$world_onscreen.GLSL){return a===Ke$$module$libs$world_onscreen.GLSL?U$$module$libs$world_onscreen.ShadersRepository:U$$module$libs$world_onscreen.ShadersRepositoryWGSL}static GetShadersStore(a=Ke$$module$libs$world_onscreen.GLSL){return a===Ke$$module$libs$world_onscreen.GLSL?U$$module$libs$world_onscreen.ShadersStore:U$$module$libs$world_onscreen.ShadersStoreWGSL}static GetIncludesShadersStore(a=Ke$$module$libs$world_onscreen.GLSL){return a===
Ke$$module$libs$world_onscreen.GLSL?U$$module$libs$world_onscreen.IncludesShadersStore:U$$module$libs$world_onscreen.IncludesShadersStoreWGSL}}U$$module$libs$world_onscreen.ShadersRepository="src/Shaders/";U$$module$libs$world_onscreen.ShadersStore={};U$$module$libs$world_onscreen.IncludesShadersStore={};U$$module$libs$world_onscreen.ShadersRepositoryWGSL="src/ShadersWGSL/";U$$module$libs$world_onscreen.ShadersStoreWGSL={};U$$module$libs$world_onscreen.IncludesShadersStoreWGSL={};
class De$$module$libs$world_onscreen{constructor(a,b,c,d=null,e,g=null,n=null,t=null,w=null,z,C="",H=Ke$$module$libs$world_onscreen.GLSL){var M,L,O;this.name=null;this.defines="";this.onBind=this.onError=this.onCompiled=null;this.uniqueId=0;this.onCompileObservable=new w$$module$libs$world_onscreen;this.onErrorObservable=new w$$module$libs$world_onscreen;this._onBindObservable=null;this._forceRebindOnNextCall=this._wasPreviouslyReady=!1;this._wasPreviouslyUsingInstances=null;this._bonesComputationForcedToCPU=
this._isDisposed=!1;this._uniformBuffersNames={};this._multiTarget=!1;this._samplers={};this._isReady=!1;this._compilationError="";this._allFallbacksProcessed=!1;this._uniforms={};this._key="";this._fallbacks=null;this._fragmentSourceCodeOverride=this._vertexSourceCodeOverride="";this._pipelineContext=this._transformFeedbackVaryings=null;this._rawFragmentSourceCode=this._rawVertexSourceCode=this._fragmentSourceCodeBeforeMigration=this._vertexSourceCodeBeforeMigration=this._fragmentSourceCode=this._vertexSourceCode=
"";this.name=a;this._key=C;var S;let T=null;if(b.attributes){if(this._engine=c,this._attributesNames=b.attributes,this._uniformsNames=b.uniformsNames.concat(b.samplers),this._samplerList=b.samplers.slice(),this.defines=b.defines,this.onError=b.onError,this.onCompiled=b.onCompiled,this._fallbacks=b.fallbacks,this._indexParameters=b.indexParameters,this._transformFeedbackVaryings=b.transformFeedbackVaryings||null,this._multiTarget=!!b.multiTarget,this._shaderLanguage=null!==(M=b.shaderLanguage)&&void 0!==
M?M:Ke$$module$libs$world_onscreen.GLSL,b.uniformBuffersNames)for(this._uniformBuffersNamesList=b.uniformBuffersNames.slice(),S=0;S<b.uniformBuffersNames.length;S++)this._uniformBuffersNames[b.uniformBuffersNames[S]]=S;T=null!==(L=b.processFinalCode)&&void 0!==L?L:null;S=null!==(O=b.processCodeAfterIncludes)&&void 0!==O?O:void 0}else this._engine=e,this.defines=g??"",this._uniformsNames=c.concat(d),this._samplerList=d?d.slice():[],this._attributesNames=b,this._uniformBuffersNamesList=[],this._shaderLanguage=
H,this.onError=w,this.onCompiled=t,this._indexParameters=z,this._fallbacks=n;this._attributeLocationByName={};this.uniqueId=De$$module$libs$world_onscreen._UniqueIdSeed++;let P,W;b=Ze$$module$libs$world_onscreen()?this._engine.getHostDocument():null;a.vertexSource?P="source:"+a.vertexSource:a.vertexElement?(P=b?b.getElementById(a.vertexElement):null,P||=a.vertexElement):P=a.vertex||a;a.fragmentSource?W="source:"+a.fragmentSource:a.fragmentElement?(W=b?b.getElementById(a.fragmentElement):null,W||=
a.fragmentElement):W=a.fragment||a;this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);let Z={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:U$$module$libs$world_onscreen.GetShadersRepository(this._shaderLanguage),
includesShadersStore:U$$module$libs$world_onscreen.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:S};const ca=[void 0,void 0],ba=()=>{if(ca[0]&&ca[1]){Z.isFragment=!0;const [ea,oa]=ca;ni$$module$libs$world_onscreen.Process(oa,Z,(sa,xa)=>{this._fragmentSourceCodeBeforeMigration=
xa;T&&(sa=T("fragment",sa));sa=ni$$module$libs$world_onscreen.Finalize(ea,sa,Z);this._useFinalCode(sa.vertexCode,sa.fragmentCode,a)},this._engine)}};this._loadShader(P,"Vertex","",ea=>{ni$$module$libs$world_onscreen.Initialize(Z);ni$$module$libs$world_onscreen.Process(ea,Z,(oa,sa)=>{this._rawVertexSourceCode=ea;this._vertexSourceCodeBeforeMigration=sa;T&&(oa=T("vertex",oa));ca[0]=oa;ba()},this._engine)});this._loadShader(W,"Fragment","Pixel",ea=>{this._rawFragmentSourceCode=ea;ca[1]=ea;ba()});Z=null;
const la=function(ea){return function(){return this._pipelineContext&&this._pipelineContext[ea].apply(this._pipelineContext,arguments),this}};"Int? UInt? IntArray? UIntArray? Array? Color? Vector? Float? Matrices Matrix Matrix3x3 Matrix2x2 Quaternion DirectColor4".split(" ").forEach(ea=>{const oa=`set${ea}`;oa.endsWith("?")?["",2,3,4].forEach(sa=>{this[oa.slice(0,-1)+sa]=this[oa.slice(0,-1)+sa]||la(oa.slice(0,-1)+sa).bind(this)}):this[oa]=this[oa]||la(oa).bind(this)})}static get ShadersRepository(){return U$$module$libs$world_onscreen.ShadersRepository}static set ShadersRepository(a){U$$module$libs$world_onscreen.ShadersRepository=
a}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new w$$module$libs$world_onscreen),this._onBindObservable}_useFinalCode(a,b,c){if(c){const d=c.fragmentElement||c.fragment||c.spectorName||c;this._vertexSourceCode=(this._shaderLanguage===Ke$$module$libs$world_onscreen.WGSL?"//":"")+"#define SHADER_NAME vertex:"+(c.vertexElement||c.vertex||c.spectorName||c)+"\n"+a;this._fragmentSourceCode=(this._shaderLanguage===Ke$$module$libs$world_onscreen.WGSL?"//":"")+"#define SHADER_NAME fragment:"+
d+"\n"+b}else this._vertexSourceCode=a,this._fragmentSourceCode=b;this._prepareEffect()}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return this._isReady?!0:this._pipelineContext?this._pipelineContext.isReady:!1}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(a){return this._attributes[a]}getAttributeLocationByName(a){return this._attributeLocationByName[a]}getAttributesCount(){return this._attributes.length}getUniformIndex(a){return this._uniformsNames.indexOf(a)}getUniform(a){return this._uniforms[a]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}executeWhenCompiled(a){this.isReady()?
a(this):(this.onCompileObservable.add(b=>{a(b)}),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout(()=>{this._checkIsReady(null)},16))}_checkIsReady(a){try{if(this._isReadyInternal())return}catch(b){this._processCompilationErrors(b,a);return}this._isDisposed||setTimeout(()=>{this._checkIsReady(a)},16)}_loadShader(a,b,c,d){if("u">typeof HTMLElement&&a instanceof HTMLElement)a=Bs$$module$libs$world_onscreen(a),d(a);else if("source:"===a.substr(0,7))d(a.substr(7));else if("base64:"===
a.substr(0,7))a=window.atob(a.substr(7)),d(a);else{var e=U$$module$libs$world_onscreen.GetShadersStore(this._shaderLanguage);if(e[a+b+"Shader"])d(e[a+b+"Shader"]);else if(c&&e[a+c+"Shader"])d(e[a+c+"Shader"]);else{var g;"."===a[0]||"/"===a[0]||-1<a.indexOf("http")?g=a:g=U$$module$libs$world_onscreen.GetShadersRepository(this._shaderLanguage)+a;this._engine._loadFile(g+"."+b.toLowerCase()+".fx",d)}}}get vertexSourceCode(){var a,b;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?
this._vertexSourceCodeOverride:null!==(b=null===(a=this._pipelineContext)||void 0===a?void 0:a._getVertexShaderCode())&&void 0!==b?b:this._vertexSourceCode}get fragmentSourceCode(){var a,b;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(b=null===(a=this._pipelineContext)||void 0===a?void 0:a._getFragmentShaderCode())&&void 0!==b?b:this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}_rebuildProgram(a,
b,c,d){this._isReady=!1;this._vertexSourceCodeOverride=a;this._fragmentSourceCodeOverride=b;this.onError=(e,g)=>{d&&d(g)};this.onCompiled=()=>{const e=this.getEngine().scenes;if(e)for(let g=0;g<e.length;g++)e[g].markAllMaterialsAsDirty(63);this._pipelineContext._handlesSpectorRebuildCallback(c)};this._fallbacks=null;this._prepareEffect()}_prepareEffect(){const a=this._attributesNames,b=this.defines,c=this._pipelineContext;this._isReady=!1;try{const d=this._engine;this._pipelineContext=d.createPipelineContext(this._processingContext);
this._pipelineContext._name=this._key;const e=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?d._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,e,null,this._transformFeedbackVaryings,this._key):d._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,
e,b,this._transformFeedbackVaryings,this._key);d._executeWhenRenderingStateIsCompiled(this._pipelineContext,()=>{if(this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,a,this._attributes),a)for(let g=0;g<a.length;g++)this._attributeLocationByName[a[g]]=this._attributes[g];d.bindSamplers(this);this._compilationError="";this._isReady=!0;this.onCompiled&&this.onCompiled(this);this.onCompileObservable.notifyObservers(this);
this.onCompileObservable.clear();this._fallbacks&&this._fallbacks.unBindMesh();c&&this.getEngine()._deletePipelineContext(c)});this._pipelineContext.isAsync&&this._checkIsReady(c)}catch(d){this._processCompilationErrors(d,c)}}_getShaderCodeAndErrorLine(a,b,c){var d=c?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let e=null;b&&a&&(b=b.match(d))&&2===b.length&&(b=parseInt(b[1]),d=a.split("\n",-1),d.length>=b&&(e=`Offending line [${b}] in ${c?"fragment":"vertex"} code: ${d[b-1]}`));
return[a,e]}_processCompilationErrors(a,b=null){var c,d,e;this._compilationError=a.message;var g=this._attributesNames;a=this._fallbacks;if(O$$module$libs$world_onscreen.Error("Unable to compile effect:"),O$$module$libs$world_onscreen.Error("Uniforms: "+this._uniformsNames.map(function(n){return" "+n})),O$$module$libs$world_onscreen.Error("Attributes: "+g.map(function(n){return" "+n})),O$$module$libs$world_onscreen.Error("Defines:\r\n"+this.defines),De$$module$libs$world_onscreen.LogShaderCodeOnCompilationError){let n=
g=null,t=null;null!==(c=this._pipelineContext)&&void 0!==c&&c._getVertexShaderCode()&&([t,g]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),t&&(O$$module$libs$world_onscreen.Error("Vertex code:"),O$$module$libs$world_onscreen.Error(t)));null!==(d=this._pipelineContext)&&void 0!==d&&d._getFragmentShaderCode()&&([t,n]=this._getShaderCodeAndErrorLine(null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode(),this._compilationError,
!0),t&&(O$$module$libs$world_onscreen.Error("Fragment code:"),O$$module$libs$world_onscreen.Error(t)));g&&O$$module$libs$world_onscreen.Error(g);n&&O$$module$libs$world_onscreen.Error(n)}O$$module$libs$world_onscreen.Error("Error: "+this._compilationError);c=()=>{this.onError&&this.onError(this,this._compilationError);this.onErrorObservable.notifyObservers(this)};b&&(this._pipelineContext=b,this._isReady=!0,c());a?(this._pipelineContext=null,a.hasMoreFallbacks?(this._allFallbacksProcessed=!1,O$$module$libs$world_onscreen.Error("Trying next fallback."),
this.defines=a.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,c(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,b||c())}get isSupported(){return""===this._compilationError}_bindTexture(a,b){this._engine._bindTexture(this._samplers[a],b,a)}setTexture(a,b){this._engine.setTexture(this._samplers[a],this._uniforms[a],b,a)}setDepthStencilTexture(a,b){this._engine.setDepthStencilTexture(this._samplers[a],
this._uniforms[a],b,a)}setTextureArray(a,b){var c=a+"Ex";if(-1===this._samplerList.indexOf(c+"0")){const d=this._samplerList.indexOf(a);for(let e=1;e<b.length;e++)this._samplerList.splice(d+e,0,c+(e-1).toString());c=0;for(const e of this._samplerList)this._samplers[e]=c,c+=1}this._engine.setTextureArray(this._samplers[a],this._uniforms[a],b,a)}setTextureFromPostProcess(a,b){this._engine.setTextureFromPostProcess(this._samplers[a],b,a)}setTextureFromPostProcessOutput(a,b){this._engine.setTextureFromPostProcessOutput(this._samplers[a],
b,a)}bindUniformBuffer(a,b){const c=this._uniformBuffersNames[b];void 0===c||De$$module$libs$world_onscreen._BaseCache[c]===a&&this._engine._features.useUBOBindingCache||(De$$module$libs$world_onscreen._BaseCache[c]=a,this._engine.bindUniformBufferBase(a,c,b))}bindUniformBlock(a,b){this._engine.bindUniformBlock(this._pipelineContext,a,b)}setFloatArray(a,b){return this._pipelineContext.setArray(a,b),this}setFloatArray2(a,b){return this._pipelineContext.setArray2(a,b),this}setFloatArray3(a,b){return this._pipelineContext.setArray3(a,
b),this}setFloatArray4(a,b){return this._pipelineContext.setArray4(a,b),this}setBool(a,b){return this._pipelineContext.setInt(a,b?1:0),this}dispose(){var a;null===(a=this._pipelineContext)||void 0===a||a.dispose();this._engine._releaseEffect(this);this._isDisposed=!0}static RegisterShader(a,b,c,d=Ke$$module$libs$world_onscreen.GLSL){b&&(U$$module$libs$world_onscreen.GetShadersStore(d)[`${a}PixelShader`]=b);c&&(U$$module$libs$world_onscreen.GetShadersStore(d)[`${a}VertexShader`]=c)}static ResetCache(){De$$module$libs$world_onscreen._BaseCache=
{}}}De$$module$libs$world_onscreen.LogShaderCodeOnCompilationError=!0;De$$module$libs$world_onscreen._UniqueIdSeed=0;De$$module$libs$world_onscreen._BaseCache={};De$$module$libs$world_onscreen.ShadersStore=U$$module$libs$world_onscreen.ShadersStore;De$$module$libs$world_onscreen.IncludesShadersStore=U$$module$libs$world_onscreen.IncludesShadersStore;
class on$$module$libs$world_onscreen{constructor(a=!0){this._isFrontFaceDirty=this._isZOffsetDirty=this._isCullDirty=this._isCullFaceDirty=this._isDepthFuncDirty=this._isDepthMaskDirty=this._isDepthTestDirty=!1;a&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(a){this._zOffset!==a&&(this._zOffset=a,this._isZOffsetDirty=
!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(a){this._zOffsetUnits!==a&&(this._zOffsetUnits=a,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(a){this._cullFace!==a&&(this._cullFace=a,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(a){this._cull!==a&&(this._cull=a,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(a){this._depthFunc!==a&&(this._depthFunc=a,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(a){this._depthMask!==
a&&(this._depthMask=a,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(a){this._depthTest!==a&&(this._depthTest=a,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(a){this._frontFace!==a&&(this._frontFace=a,this._isFrontFaceDirty=!0)}reset(){this._depthTest=this._depthMask=!0;this._cull=this._cullFace=this._depthFunc=null;this._zOffsetUnits=this._zOffset=0;this._frontFace=null;this._isDepthMaskDirty=this._isDepthTestDirty=!0;this._isCullDirty=
this._isCullFaceDirty=this._isDepthFuncDirty=!1;this._isZOffsetDirty=!0;this._isFrontFaceDirty=!1}apply(a){this.isDirty&&(this._isCullDirty&&(this.cull?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(a.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(a.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&
(a.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(this.zOffset,this.zOffsetUnits)):a.disable(a.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(a.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}
class kt$$module$libs$world_onscreen{constructor(){this.reset()}reset(){this.enabled=!1;this.mask=255;this.func=kt$$module$libs$world_onscreen.ALWAYS;this.funcRef=1;this.funcMask=255;this.opDepthFail=this.opStencilFail=kt$$module$libs$world_onscreen.KEEP;this.opStencilDepthPass=kt$$module$libs$world_onscreen.REPLACE}get stencilFunc(){return this.func}set stencilFunc(a){this.func=a}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(a){this.funcRef=a}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(a){this.funcMask=
a}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(a){this.opStencilFail=a}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(a){this.opDepthFail=a}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(a){this.opStencilDepthPass=a}get stencilMask(){return this.mask}set stencilMask(a){this.mask=a}get stencilTest(){return this.enabled}set stencilTest(a){this.enabled=a}}kt$$module$libs$world_onscreen.ALWAYS=519;
kt$$module$libs$world_onscreen.KEEP=7680;kt$$module$libs$world_onscreen.REPLACE=7681;
class hn$$module$libs$world_onscreen{constructor(){this._blendFunctionParameters=Array(4);this._blendEquationParameters=Array(2);this._blendConstants=Array(4);this._isBlendEquationParametersDirty=this._isBlendFunctionParametersDirty=this._isAlphaBlendDirty=this._alphaBlend=this._isBlendConstantsDirty=!1;this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(a){this._alphaBlend!==a&&
(this._alphaBlend=a,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(a,b,c,d){this._blendConstants[0]===a&&this._blendConstants[1]===b&&this._blendConstants[2]===c&&this._blendConstants[3]===d||(this._blendConstants[0]=a,this._blendConstants[1]=b,this._blendConstants[2]=c,this._blendConstants[3]=d,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(a,b,c,d){this._blendFunctionParameters[0]===a&&this._blendFunctionParameters[1]===b&&this._blendFunctionParameters[2]===c&&this._blendFunctionParameters[3]===
d||(this._blendFunctionParameters[0]=a,this._blendFunctionParameters[1]=b,this._blendFunctionParameters[2]=c,this._blendFunctionParameters[3]=d,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(a,b){this._blendEquationParameters[0]===a&&this._blendEquationParameters[1]===b||(this._blendEquationParameters[0]=a,this._blendEquationParameters[1]=b,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1;this._blendFunctionParameters[0]=null;this._blendFunctionParameters[1]=
null;this._blendFunctionParameters[2]=null;this._blendFunctionParameters[3]=null;this._blendEquationParameters[0]=null;this._blendEquationParameters[1]=null;this._blendConstants[0]=null;this._blendConstants[1]=null;this._blendConstants[2]=null;this._blendConstants[3]=null;this._isAlphaBlendDirty=!0;this._isBlendConstantsDirty=this._isBlendEquationParametersDirty=this._isBlendFunctionParametersDirty=!1}apply(a){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?a.enable(a.BLEND):a.disable(a.BLEND),
this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(a.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(a.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(a.blendColor(this._blendConstants[0],this._blendConstants[1],
this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}class ln$$module$libs$world_onscreen{constructor(){this.shaderLanguage=Ke$$module$libs$world_onscreen.GLSL}postProcessor(a,b,c,d,e){e.getCaps().drawBuffersExtension||(a=a.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,""));return a}}
class cn$$module$libs$world_onscreen{constructor(){this.shaderLanguage=Ke$$module$libs$world_onscreen.GLSL}attributeProcessor(a){return a.replace("attribute","in")}varyingProcessor(a,b){return a.replace("varying",b?"in":"out")}postProcessor(a,b,c){const d=-1!==a.search(/#extension.+GL_EXT_draw_buffers.+require/);if(a=a.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,""),a=a.replace(/texture2D\s*\(/g,
"texture("),c)a=a.replace(/texture2DLodEXT\s*\(/g,"textureLod("),a=a.replace(/textureCubeLodEXT\s*\(/g,"textureLod("),a=a.replace(/textureCube\s*\(/g,"texture("),a=a.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),a=a.replace(/gl_FragColor/g,"glFragColor"),a=a.replace(/gl_FragData/g,"glFragData"),a=a.replace(/void\s+?main\s*\(/g,(d?"":"layout(location = 0) out vec4 glFragColor;\n")+"void main(");else if(-1!==b.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+
a;return a}}class ki$$module$libs$world_onscreen{constructor(){this.capacity=this.references=0;this.is32Bits=!1;this.uniqueId=ki$$module$libs$world_onscreen._Counter++}get underlyingResource(){return null}}ki$$module$libs$world_onscreen._Counter=0;class Fi$$module$libs$world_onscreen extends ki$$module$libs$world_onscreen{constructor(a){super();this._buffer=a}get underlyingResource(){return this._buffer}}const un$$module$libs$world_onscreen="Int Int2 Int3 Int4 UInt UInt2 UInt3 UInt4 Vector2 Vector3 Vector4 Float2 Float Float3 Float4 Quaternion Color3 Color4 DirectColor4".split(" ");
class dn$$module$libs$world_onscreen{constructor(){this._valueCache={};this.programValidationError=this.programLinkError=this.fragmentCompilationError=this.vertexCompilationError=null;const a=[],b=function(){a.length=0;Array.prototype.push.apply(a,arguments);a[0]=this._uniforms[a[0]]},c=d=>{const e=un$$module$libs$world_onscreen.includes(d.substring(3))&&"FloatN";if(e){const g=this[`_cache${e}`];return function(){const n=this.engine[d];b.apply(this,arguments);g.apply(this,arguments)&&(n.apply(this.engine,
a)||(this._valueCache[arguments[0]]=null))}}return function(){const g=this.engine[d];b.apply(this,arguments);void 0!==arguments[1]&&(this._valueCache[arguments[0]]=null,g.apply(this.engine,a))}};"Int? UInt? IntArray? UIntArray? Array? Float? Matrices Matrix3x3 Matrix2x2".split(" ").forEach(d=>{const e=`set${d}`;this[e]||(e.endsWith("?")?["",2,3,4].forEach(g=>{this[e.slice(0,-1)+g]=this[e.slice(0,-1)+g]||c(e.slice(0,-1)+g).bind(this)}):this[e]=this[e]||c(e).bind(this))})}get isAsync(){return this.isParallelCompiled}get isReady(){return this.program?
this.isParallelCompiled?this.engine._isRenderingStateCompiled(this):!0:!1}_handlesSpectorRebuildCallback(a){a&&this.program&&a(this.program)}_fillEffectInformation(a,b,c,d,e,g,n,t){const w=this.engine;if(w.supportsUniformBuffers)for(const z in b)a.bindUniformBlock(z,b[z]);this.engine.getUniforms(this,c).forEach((z,C)=>{d[c[C]]=z});this._uniforms=d;for(b=0;b<e.length;b++)null==a.getUniform(e[b])&&(e.splice(b,1),b--);e.forEach((z,C)=>{g[z]=C});for(const z of w.getAttributes(this,n))t.push(z)}dispose(){this._uniforms=
{}}_cacheMatrix(a,b){const c=this._valueCache[a];b=b.updateFlag;return void 0!==c&&c===b?!1:(this._valueCache[a]=b,!0)}_cacheFloatN(a,b,c,d,e){let g=this._valueCache[arguments[0]];if(!g||g.length!==arguments.length-1)return g=Array.prototype.slice.call(arguments,1),this._valueCache[arguments[0]]=g,!0;let n=!1;for(let t=0;t<g.length;++t)g[t]!==arguments[t+1]&&(g[t]=arguments[t+1],n=!0);return n}_cacheFloat2(a,b,c){return this._cacheFloatN(a,b,c)}_cacheFloat3(a,b,c,d){return this._cacheFloatN(a,b,c,
d)}_cacheFloat4(a,b,c,d,e){return this._cacheFloatN(a,b,c,d,e)}setMatrix(a,b){this._cacheMatrix(a,b)&&(this.engine.setMatrices(this._uniforms[a],b.toArray())||(this._valueCache[a]=null))}setVector2(a,b){this.setFloat2(a,b.x,b.y)}setVector3(a,b){this.setFloat3(a,b.x,b.y,b.z)}setVector4(a,b){this.setFloat4(a,b.x,b.y,b.z,b.w)}setQuaternion(a,b){this.setFloat4(a,b.x,b.y,b.z,b.w)}setColor3(a,b){this.setFloat3(a,b.r,b.g,b.b)}setColor4(a,b,c){this.setFloat4(a,b.r,b.g,b.b,c)}setDirectColor4(a,b){this.setFloat4(a,
b.r,b.g,b.b,b.a)}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}
class Mr$$module$libs$world_onscreen{constructor(a=null,b){if(this._MSAARenderBuffer=null,this._context=b,!a&&(a=b.createTexture(),!a))throw Error("Unable to create webGL texture");this.set(a)}get underlyingResource(){return this._webGLTexture}setUsage(){}set(a){this._webGLTexture=a}reset(){this._MSAARenderBuffer=this._webGLTexture=null}release(){this._MSAARenderBuffer&&(this._context.deleteRenderbuffer(this._MSAARenderBuffer),this._MSAARenderBuffer=null);this._webGLTexture&&this._context.deleteTexture(this._webGLTexture);
this.reset()}}
class Ri$$module$libs$world_onscreen{constructor(a,b=!0){this.defines=this.effect=null;this.drawContext=a.createDrawContext();b&&(this.materialContext=a.createMaterialContext())}static IsWrapper(a){return void 0===a.getPipelineContext}static GetEffect(a){return void 0===a.getPipelineContext?a.effect:a}setEffect(a,b,c=!0){var d;this.effect=a;void 0!==b&&(this.defines=b);c&&(null===(d=this.drawContext)||void 0===d||d.reset())}dispose(){var a;null===(a=this.drawContext)||void 0===a||a.dispose()}}
class fn$$module$libs$world_onscreen{constructor(a=!0){this.useStencilGlobalOnly=this._isStencilOpDirty=this._isStencilFuncDirty=this._isStencilMaskDirty=this._isStencilTestDirty=!1;a&&this.reset()}get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(a){this._func!==a&&(this._func=a,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(a){this._funcRef!==a&&(this._funcRef=
a,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(a){this._funcMask!==a&&(this._funcMask=a,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(a){this._opStencilFail!==a&&(this._opStencilFail=a,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(a){this._opDepthFail!==a&&(this._opDepthFail=a,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(a){this._opStencilDepthPass!==
a&&(this._opStencilDepthPass=a,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(a){this._mask!==a&&(this._mask=a,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(a){this._enabled!==a&&(this._enabled=a,this._isStencilTestDirty=!0)}reset(){var a;this.stencilMaterial=void 0;null===(a=this.stencilGlobal)||void 0===a||a.reset();this._isStencilOpDirty=this._isStencilFuncDirty=this._isStencilMaskDirty=this._isStencilTestDirty=!0}apply(a){var b;if(a){var c=!this.useStencilGlobalOnly&&
!(null===(b=this.stencilMaterial)||void 0===b||!b.enabled);this.enabled=c?this.stencilMaterial.enabled:this.stencilGlobal.enabled;this.func=c?this.stencilMaterial.func:this.stencilGlobal.func;this.funcRef=c?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef;this.funcMask=c?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask;this.opStencilFail=c?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail;this.opDepthFail=c?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail;
this.opStencilDepthPass=c?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass;this.mask=c?this.stencilMaterial.mask:this.stencilGlobal.mask;this.isDirty&&(this._isStencilTestDirty&&(this.enabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(a.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(a.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&
(a.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}}class ai$$module$libs$world_onscreen{static get Now(){return Fs$$module$libs$world_onscreen.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}class _n$$module$libs$world_onscreen{}
class le$$module$libs$world_onscreen{constructor(a,b,c,d){this._name="WebGL";this.isFullscreen=this.forcePOTTextures=!1;this.cullBackFaces=null;this.renderEvenInBackground=!0;this.isNDCHalfZRange=this._useReverseDepthBuffer=this.validateShaderPrograms=this.preventCacheWipeBetweenFrames=!1;this.hasOriginBottomLeft=!0;this.disableUniformBuffers=!1;this.onDisposeObservable=new w$$module$libs$world_onscreen;this._frameId=0;this._uniformBuffers=[];this._storageBuffers=[];this._webGLVersion=1;this._windowIsBackground=
!1;this._highPrecisionShadersAllowed=!0;this._renderingQueueLaunched=this._badDesktopOS=this._badOS=!1;this._activeRenderLoops=[];this.onContextLostObservable=new w$$module$libs$world_onscreen;this.onContextRestoredObservable=new w$$module$libs$world_onscreen;this.disableVertexArrayObjects=this._doNotHandleContextLost=this._contextWasLost=!1;this._colorWriteChanged=this._colorWrite=!0;this._depthCullingState=new on$$module$libs$world_onscreen;this._stencilStateComposer=new fn$$module$libs$world_onscreen;
this._stencilState=new kt$$module$libs$world_onscreen;this._alphaState=new hn$$module$libs$world_onscreen;this._alphaMode=1;this._alphaEquation=0;this._internalTexturesCache=[];this._renderTargetWrapperCache=[];this._activeChannel=0;this._currentTextureChannel=-1;this._boundTexturesCache={};this._compiledEffects={};this._vertexAttribArraysEnabled=[];this._uintIndicesCurrentlySet=!1;this._currentBoundBuffer=[];this._dummyFramebuffer=this._currentFramebuffer=null;this._currentBufferPointers=[];this._currentInstanceLocations=
[];this._currentInstanceBuffers=[];this._mustWipeVertexAttributes=this._vaoRecordInProgress=!1;this._nextFreeTextureSlots=[];this._maxSimultaneousTextures=0;this._maxMSAASamplesOverride=null;this._activeRequests=[];this.adaptToDeviceRatio=!1;this._lastDevicePixelRatio=1;this._transformTextureUrl=null;this.hostInformation={isMobile:!1};this.premultipliedAlpha=!0;this.onBeforeTextureInitObservable=new w$$module$libs$world_onscreen;this._isWebGPU=!1;this._snapshotRenderingMode=0;this._useExactSrgbConversions=
!1;this._viewportCached={x:0,y:0,z:0,w:0};this._unpackFlipYCached=null;this.enableUnpackFlipYCached=!0;this._boundUniforms={};this.startTime=ai$$module$libs$world_onscreen.Now;var e=null;if(c=c||{},this._creationOptions=c,this.adaptToDeviceRatio=d??!1,this._stencilStateComposer.stencilGlobal=this._stencilState,Ne$$module$libs$world_onscreen.SetMatrixPrecision(!!c.useHighPrecisionMatrix),a){if(d=d||c.adaptToDeviceRatio||!1,a.getContext){if(e=a,this._renderingCanvas=e,void 0!==b&&(c.antialias=b),void 0===
c.deterministicLockstep&&(c.deterministicLockstep=!1),void 0===c.lockstepMaxSteps&&(c.lockstepMaxSteps=4),void 0===c.timeStep&&(c.timeStep=1/60),void 0===c.preserveDrawingBuffer&&(c.preserveDrawingBuffer=!1),void 0===c.audioEngine&&(c.audioEngine=!0),void 0!==c.audioEngineOptions&&void 0!==c.audioEngineOptions.audioContext&&(this._audioContext=c.audioEngineOptions.audioContext),void 0!==c.audioEngineOptions&&void 0!==c.audioEngineOptions.audioDestination&&(this._audioDestination=c.audioEngineOptions.audioDestination),
void 0===c.stencil&&(c.stencil=!0),!1===c.premultipliedAlpha&&(this.premultipliedAlpha=!1),void 0===c.xrCompatible&&(c.xrCompatible=!0),void 0!==c.useExactSrgbConversions&&(this._useExactSrgbConversions=c.useExactSrgbConversions),this._doNotHandleContextLost=!!c.doNotHandleContextLost,navigator&&navigator.userAgent){this._checkForMobile=()=>{const n=navigator.userAgent;this.hostInformation.isMobile=-1!==n.indexOf("Mobile")||-1!==n.indexOf("Mac")&&Di$$module$libs$world_onscreen()&&"ontouchend"in document};
this._checkForMobile();Ze$$module$libs$world_onscreen()&&window.addEventListener("resize",this._checkForMobile);a=navigator.userAgent;for(var g of le$$module$libs$world_onscreen.ExceptionList)if(b=g.targets,(new RegExp(g.key)).test(a)){if(g.capture&&g.captureConstraint){const n=g.captureConstraint,t=(new RegExp(g.capture)).exec(a);if(t&&0<t.length&&parseInt(t[t.length-1])>=n)continue}for(const n of b)switch(n){case "uniformBuffer":this.disableUniformBuffers=!0;break;case "vao":this.disableVertexArrayObjects=
!0;break;case "antialias":c.antialias=!1;break;case "maxMSAASamples":this._maxMSAASamplesOverride=1}}}if(this._doNotHandleContextLost||(this._onContextLost=n=>{n.preventDefault();this._contextWasLost=!0;O$$module$libs$world_onscreen.Warn("WebGL context lost.");this.onContextLostObservable.notifyObservers(this)},this._onContextRestored=()=>{this._restoreEngineAfterContextLost(this._initGLContext.bind(this))},e.addEventListener("webglcontextlost",this._onContextLost,!1),e.addEventListener("webglcontextrestored",
this._onContextRestored,!1),c.powerPreference="high-performance"),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._badDesktopOS&&(c.xrCompatible=!1),!c.disableWebGL2Support)try{(this._gl=e.getContext("webgl2",c)||e.getContext("experimental-webgl2",c))&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch{}if(!this._gl){if(!e)throw Error("The provided canvas is null or undefined.");
try{this._gl=e.getContext("webgl",c)||e.getContext("experimental-webgl",c)}catch{throw Error("WebGL not supported");}}if(!this._gl)throw Error("WebGL not supported");}else this._gl=a,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1",(e=this._gl.getContextAttributes())&&(c.stencil=e.stencil);this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE);void 0!==c.useHighPrecisionFloats&&
(this._highPrecisionShadersAllowed=c.useHighPrecisionFloats);e=Ze$$module$libs$world_onscreen()&&window.devicePixelRatio||1;g=c.limitDeviceRatio||e;this._hardwareScalingLevel=d?1/Math.min(g,e):1;this._lastDevicePixelRatio=e;this.resize();this._isStencilEnable=!!c.stencil;this._initGLContext();this._initFeatures();for(c=0;c<this._caps.maxVertexAttribs;c++)this._currentBufferPointers[c]=new _n$$module$libs$world_onscreen;this._shaderProcessor=1<this.webGLVersion?new cn$$module$libs$world_onscreen:new ln$$module$libs$world_onscreen;
this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);c=`Babylon.js v${le$$module$libs$world_onscreen.Version}`;console.log(c+` - ${this.description}`);this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",c)}}static get NpmPackage(){return"babylonjs@5.43.0"}static get Version(){return"5.43.0"}get description(){let a=this.name+this.webGLVersion;return this._caps.parallelShaderCompile&&(a+=" - Parallel shader compilation"),
a}get name(){return this._name}set name(a){this._name=a}get version(){return this._webGLVersion}static get ShadersRepository(){return De$$module$libs$world_onscreen.ShadersRepository}static set ShadersRepository(a){De$$module$libs$world_onscreen.ShadersRepository=a}_getShaderProcessor(a){return this._shaderProcessor}get useReverseDepthBuffer(){return this._useReverseDepthBuffer}set useReverseDepthBuffer(a){a!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=a,a?this._depthCullingState.depthFunc=
518:this._depthCullingState.depthFunc=515)}get frameId(){return this._frameId}get supportsUniformBuffers(){return 1<this.webGLVersion&&!this.disableUniformBuffers}getCreationOptions(){return this._creationOptions}get _shouldUseHighPrecisionShader(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}get needPOTTextures(){return 2>this._webGLVersion||this.forcePOTTextures}get activeRenderLoops(){return this._activeRenderLoops}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(a){this._doNotHandleContextLost=
a}get _supportsHardwareTextureRescaling(){return!1}set framebufferDimensionsObject(a){this._framebufferDimensionsObject=a}get currentViewport(){return this._cachedViewport}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||
(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const a=new Uint8Array(4);this._emptyCubeTexture=this.createRawCubeTexture([a,a,a,a,a,a],1,5,0,!1,!1,1)}return this._emptyCubeTexture}get isWebGPU(){return this._isWebGPU}get shaderPlatformName(){return this._shaderPlatformName}get snapshotRendering(){return!1}set snapshotRendering(a){}get snapshotRenderingMode(){return this._snapshotRenderingMode}set snapshotRenderingMode(a){this._snapshotRenderingMode=
a}get useExactSrgbConversions(){return this._useExactSrgbConversions}snapshotRenderingReset(){this.snapshotRendering=!1}static _CreateCanvas(a,b){if("u"<typeof document)return new OffscreenCanvas(a,b);const c=document.createElement("canvas");return c.width=a,c.height=b,c}createCanvas(a,b){return le$$module$libs$world_onscreen._CreateCanvas(a,b)}createCanvasImage(){return document.createElement("img")}_restoreEngineAfterContextLost(a){setTimeout(async()=>{var b;this._dummyFramebuffer=null;const c=
this._depthCullingState.depthTest,d=this._depthCullingState.depthFunc,e=this._depthCullingState.depthMask,g=this._stencilState.stencilTest;await a();this.wipeCaches(!0);this._rebuildEffects();null===(b=this._rebuildComputeEffects)||void 0===b||b.call(this);this._rebuildBuffers();this._rebuildInternalTextures();this._rebuildRenderTargetWrappers();this.wipeCaches(!0);this._depthCullingState.depthTest=c;this._depthCullingState.depthFunc=d;this._depthCullingState.depthMask=e;this._stencilState.stencilTest=
g;O$$module$libs$world_onscreen.Warn(this.name+" context successfully restored.");this.onContextRestoredObservable.notifyObservers(this);this._contextWasLost=!1},0)}_sharedInit(a,b,c){this._renderingCanvas=a}_getShaderProcessingContext(a){return null}_rebuildInternalTextures(){const a=this._internalTexturesCache.slice();for(const b of a)b._rebuild()}_rebuildRenderTargetWrappers(){const a=this._renderTargetWrapperCache.slice();for(const b of a)b._rebuild()}_rebuildEffects(){for(const a in this._compiledEffects){const b=
this._compiledEffects[a];b._pipelineContext=null;b._wasPreviouslyReady=!1;b._prepareEffect()}De$$module$libs$world_onscreen.ResetCache()}areAllEffectsReady(){for(const a in this._compiledEffects)if(!this._compiledEffects[a].isReady())return!1;return!0}_rebuildBuffers(){for(const a of this._uniformBuffers)a._rebuild();for(const a of this._storageBuffers)a._rebuild()}_initGLContext(){var a;this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),
maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:1<this._webGLVersion?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),
maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:1<this._webGLVersion||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||
this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||
this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:1<this._webGLVersion||null!==this._gl.getExtension("OES_element_index_uint"),
fragmentDepthSupported:1<this._webGLVersion||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:1<this._webGLVersion,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(1<this._webGLVersion&&this._gl.getExtension("EXT_color_buffer_float")),textureFloat:!!(1<this._webGLVersion||this._gl.getExtension("OES_texture_float")),
textureHalfFloat:!!(1<this._webGLVersion||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(1<this._webGLVersion||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:1<this._webGLVersion,
canUseGLVertexID:1<this._webGLVersion,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:1<this._webGLVersion,textureMaxLevel:1<this._webGLVersion,texture2DArrayMaxLayerCount:1<this._webGLVersion?256:128};this._glVersion=this._gl.getParameter(this._gl.VERSION);var b=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=b&&(this._glRenderer=this._gl.getParameter(b.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(b.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=
this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),
this._caps.canUseTimestampForTimerQuery=0<(null!==(a=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT))&&void 0!==a?a:0)),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||
!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(1<this._webGLVersion||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,
this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),1<this._webGLVersion&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=
this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),1<this._webGLVersion)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=null!==this._maxMSAASamplesOverride?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else if(a=this._gl.getExtension("WEBGL_draw_buffers"),null!==a)for(this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=a.drawBuffersWEBGL.bind(a),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER,b=0;16>b;b++)this._gl["COLOR_ATTACHMENT"+b+"_WEBGL"]=
a["COLOR_ATTACHMENT"+b+"_WEBGL"];1<this._webGLVersion?this._caps.depthTextureExtension=!0:(a=this._gl.getExtension("WEBGL_depth_texture"),null!=a&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=a.UNSIGNED_INT_24_8_WEBGL));this.disableVertexArrayObjects?this._caps.vertexArrayObject=!1:1<this._webGLVersion?this._caps.vertexArrayObject=!0:(a=this._gl.getExtension("OES_vertex_array_object"),null!=a&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=a.createVertexArrayOES.bind(a),
this._gl.bindVertexArray=a.bindVertexArrayOES.bind(a),this._gl.deleteVertexArray=a.deleteVertexArrayOES.bind(a)));1<this._webGLVersion?this._caps.instancedArrays=!0:(a=this._gl.getExtension("ANGLE_instanced_arrays"),null!=a?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=a.drawArraysInstancedANGLE.bind(a),this._gl.drawElementsInstanced=a.drawElementsInstancedANGLE.bind(a),this._gl.vertexAttribDivisor=a.vertexAttribDivisorANGLE.bind(a)):this._caps.instancedArrays=!1);this._gl.getShaderPrecisionFormat&&
(a=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),b=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT),a&&b&&(this._caps.highPrecisionShaderSupported=0!==a.precision&&0!==b.precision));1<this._webGLVersion?this._caps.blendMinMax=!0:(a=this._gl.getExtension("EXT_blend_minmax"),null!=a&&(this._caps.blendMinMax=!0,this._gl.MAX=a.MAX_EXT,this._gl.MIN=a.MIN_EXT));this._caps.supportSRGBBuffers||(1<this._webGLVersion?this._caps.supportSRGBBuffers=
!0:(a=this._gl.getExtension("EXT_sRGB"),null!=a&&(this._caps.supportSRGBBuffers=!0,this._gl.SRGB=a.SRGB_EXT,this._gl.SRGB8=a.SRGB_ALPHA_EXT,this._gl.SRGB8_ALPHA8=a.SRGB_ALPHA_EXT)),this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState));this._depthCullingState.depthTest=!0;this._depthCullingState.depthFunc=this._gl.LEQUAL;this._depthCullingState.depthMask=!0;this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;
for(a=0;a<this._maxSimultaneousTextures;a++)this._nextFreeTextureSlots.push(a)}_initFeatures(){this._features={forceBitmapOverHTMLImageElement:!1,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,
support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,_collectUbosUpdatedInFrame:!1}}get webGLVersion(){return this._webGLVersion}getClassName(){return"ThinEngine"}get isStencilEnable(){return this._isStencilEnable}_prepareWorkingCanvas(){if(!this._workingCanvas){this._workingCanvas=
this.createCanvas(1,1);var a=this._workingCanvas.getContext("2d");a&&(this._workingContext=a)}}resetTextureCache(){for(const a in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,a)&&(this._boundTexturesCache[a]=null);this._currentTextureChannel=-1}getInfo(){return this.getGlInfo()}getGlInfo(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}}setHardwareScalingLevel(a){this._hardwareScalingLevel=a;this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}getLoadedTexturesCache(){return this._internalTexturesCache}getCaps(){return this._caps}stopRenderLoop(a){a?
(a=this._activeRenderLoops.indexOf(a),0<=a&&this._activeRenderLoops.splice(a,1)):this._activeRenderLoops=[]}_renderLoop(){if(!this._contextWasLost){var a=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(a=!1),a){this.beginFrame();for(a=0;a<this._activeRenderLoops.length;a++)(0,this._activeRenderLoops[a])();this.endFrame()}}0<this._activeRenderLoops.length?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}getHostWindow(){return Ze$$module$libs$world_onscreen()?
this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}getRenderWidth(a=!1){return!a&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth}getRenderHeight(a=!1){return!a&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:
this._gl.drawingBufferHeight}_queueNewFrame(a,b){return le$$module$libs$world_onscreen.QueueNewFrame(a,b)}runRenderLoop(a){-1===this._activeRenderLoops.indexOf(a)&&(this._activeRenderLoops.push(a),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}clear(a,b,c,d=!1){var e=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=
!0;this.applyStates();this.stencilStateComposer.useStencilGlobalOnly=e;e=0;b&&a&&(this._gl.clearColor(a.r,a.g,a.b,void 0!==a.a?a.a:1),e|=this._gl.COLOR_BUFFER_BIT);c&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),e|=this._gl.DEPTH_BUFFER_BIT);d&&(this._gl.clearStencil(0),e|=this._gl.STENCIL_BUFFER_BIT);this._gl.clear(e)}_viewport(a,b,c,d){a===this._viewportCached.x&&b===this._viewportCached.y&&c===this._viewportCached.z&&
d===this._viewportCached.w||(this._viewportCached.x=a,this._viewportCached.y=b,this._viewportCached.z=c,this._viewportCached.w=d,this._gl.viewport(a,b,c,d))}setViewport(a,b,c){b=b||this.getRenderWidth();c=c||this.getRenderHeight();const d=a.x||0,e=a.y||0;this._cachedViewport=a;this._viewport(d*b,e*c,b*a.width,c*a.height)}beginFrame(){}endFrame(){this._badOS&&this.flushFramebuffer();this._frameId++}resize(a=!1){let b,c;if(this.adaptToDeviceRatio){const d=Ze$$module$libs$world_onscreen()&&window.devicePixelRatio||
1,e=this._lastDevicePixelRatio/d;this._lastDevicePixelRatio=d;this._hardwareScalingLevel*=e}Ze$$module$libs$world_onscreen()?(b=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,c=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(b=this._renderingCanvas?this._renderingCanvas.width:100,c=this._renderingCanvas?this._renderingCanvas.height:100);this.setSize(b/this._hardwareScalingLevel,c/this._hardwareScalingLevel,
a)}setSize(a,b,c=!1){return this._renderingCanvas&&(a|=0,b|=0,c||this._renderingCanvas.width!==a||this._renderingCanvas.height!==b)?(this._renderingCanvas.width=a,this._renderingCanvas.height=b,!0):!1}bindFramebuffer(a,b=0,c,d,e,g=0,n=0){var t,w,z,C,H;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget);this._currentRenderTarget=a;this._bindUnboundFramebuffer(a._MSAAFramebuffer?a._MSAAFramebuffer:a._framebuffer);const M=this._gl;a.is2DArray?M.framebufferTextureLayer(M.FRAMEBUFFER,
M.COLOR_ATTACHMENT0,null===(t=a.texture._hardwareTexture)||void 0===t?void 0:t.underlyingResource,g,n):a.isCube&&M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+b,null===(w=a.texture._hardwareTexture)||void 0===w?void 0:w.underlyingResource,g);if(t=a._depthStencilTexture)w=a._depthStencilTextureWithStencil?M.DEPTH_STENCIL_ATTACHMENT:M.DEPTH_ATTACHMENT,a.is2DArray?M.framebufferTextureLayer(M.FRAMEBUFFER,w,null===(z=t._hardwareTexture)||void 0===z?void 0:z.underlyingResource,
g,n):a.isCube?M.framebufferTexture2D(M.FRAMEBUFFER,w,M.TEXTURE_CUBE_MAP_POSITIVE_X+b,null===(C=t._hardwareTexture)||void 0===C?void 0:C.underlyingResource,g):M.framebufferTexture2D(M.FRAMEBUFFER,w,M.TEXTURE_2D,null===(H=t._hardwareTexture)||void 0===H?void 0:H.underlyingResource,g);this._cachedViewport&&!e?this.setViewport(this._cachedViewport,c,d):(c||(c=a.width,g&&(c/=Math.pow(2,g))),d||(d=a.height,g&&(d/=Math.pow(2,g))),this._viewport(0,0,c,d));this.wipeCaches()}setState(a,b=0,c,d=!1,e,g,n=0){var t,
w;(this._depthCullingState.cull!==a||c)&&(this._depthCullingState.cull=a);a=null===(w=null!==(t=this.cullBackFaces)&&void 0!==t?t:e)||void 0===w||w?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==a||c)&&(this._depthCullingState.cullFace=a);this.setZOffset(b);this.setZOffsetUnits(n);b=d?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==b||c)&&(this._depthCullingState.frontFace=b);this._stencilStateComposer.stencilMaterial=g}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(a){this._depthCullingState.depthTest=
a}setZOffset(a){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-a:a}getZOffset(){const a=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-a:a}setZOffsetUnits(a){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-a:a}getZOffsetUnits(){const a=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-a:a}_bindUnboundFramebuffer(a){this._currentFramebuffer!==a&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a),this._currentFramebuffer=a)}_currentFrameBufferIsDefaultFrameBuffer(){return null===
this._currentFramebuffer}generateMipmaps(a){this._bindTextureDirectly(this._gl.TEXTURE_2D,a,!0);this._gl.generateMipmap(this._gl.TEXTURE_2D);this._bindTextureDirectly(this._gl.TEXTURE_2D,null)}unBindFramebuffer(a,b=!1,c){var d;this._currentRenderTarget=null;const e=this._gl;if(a._MSAAFramebuffer){if(a.isMulti){this.unBindMultiColorAttachmentFramebuffer(a,b,c);return}e.bindFramebuffer(e.READ_FRAMEBUFFER,a._MSAAFramebuffer);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,a._framebuffer);e.blitFramebuffer(0,0,
a.width,a.height,0,0,a.width,a.height,e.COLOR_BUFFER_BIT,e.NEAREST)}null!==(d=a.texture)&&void 0!==d&&d.generateMipMaps&&!b&&!a.isCube&&this.generateMipmaps(a.texture);c&&(a._MSAAFramebuffer&&this._bindUnboundFramebuffer(a._framebuffer),c());this._bindUnboundFramebuffer(null)}flushFramebuffer(){this._gl.flush()}restoreDefaultFramebuffer(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null);this._cachedViewport&&this.setViewport(this._cachedViewport);
this.wipeCaches()}_resetVertexBufferBinding(){this.bindArrayBuffer(null);this._cachedVertexBuffers=null}createVertexBuffer(a){return this._createVertexBuffer(a,this._gl.STATIC_DRAW)}_createVertexBuffer(a,b){var c=this._gl.createBuffer();if(!c)throw Error("Unable to create vertex buffer");c=new Fi$$module$libs$world_onscreen(c);return this.bindArrayBuffer(c),a instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(a),b):this._gl.bufferData(this._gl.ARRAY_BUFFER,a,b),this._resetVertexBufferBinding(),
c.references=1,c}createDynamicVertexBuffer(a){return this._createVertexBuffer(a,this._gl.DYNAMIC_DRAW)}_resetIndexBufferBinding(){this.bindIndexBuffer(null);this._cachedIndexBuffer=null}createIndexBuffer(a,b){const c=this._gl.createBuffer(),d=new Fi$$module$libs$world_onscreen(c);if(!c)throw Error("Unable to create index buffer");this.bindIndexBuffer(d);a=this._normalizeIndexData(a);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,b?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),
d.references=1,d.is32Bits=4===a.BYTES_PER_ELEMENT,d}_normalizeIndexData(a){if(2===a.BYTES_PER_ELEMENT)return a;if(this._caps.uintIndices){if(a instanceof Uint32Array)return a;for(let b=0;b<a.length;b++)if(65535<=a[b])return new Uint32Array(a)}return new Uint16Array(a)}bindArrayBuffer(a){this._vaoRecordInProgress||this._unbindVertexArrayObject();this._bindBuffer(a,this._gl.ARRAY_BUFFER)}bindUniformBlock(a,b,c){a=a.program;b=this._gl.getUniformBlockIndex(a,b);this._gl.uniformBlockBinding(a,b,c)}bindIndexBuffer(a){this._vaoRecordInProgress||
this._unbindVertexArrayObject();this._bindBuffer(a,this._gl.ELEMENT_ARRAY_BUFFER)}_bindBuffer(a,b){(this._vaoRecordInProgress||this._currentBoundBuffer[b]!==a)&&(this._gl.bindBuffer(b,a?a.underlyingResource:null),this._currentBoundBuffer[b]=a)}updateArrayBuffer(a){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a)}_vertexAttribPointer(a,b,c,d,e,g,n){const t=this._currentBufferPointers[b];if(t){var w=!1;t.active?(t.buffer!==a&&(t.buffer=a,w=!0),t.size!==c&&(t.size=c,w=!0),t.type!==d&&(t.type=d,w=!0),
t.normalized!==e&&(t.normalized=e,w=!0),t.stride!==g&&(t.stride=g,w=!0),t.offset!==n&&(t.offset=n,w=!0)):(w=!0,t.active=!0,t.index=b,t.size=c,t.type=d,t.normalized=e,t.stride=g,t.offset=n,t.buffer=a);(w||this._vaoRecordInProgress)&&(this.bindArrayBuffer(a),d===this._gl.UNSIGNED_INT||d===this._gl.INT?this._gl.vertexAttribIPointer(b,c,d,g,n):this._gl.vertexAttribPointer(b,c,d,e,g,n))}}_bindIndexBufferWithCache(a){null!=a&&this._cachedIndexBuffer!==a&&(this._cachedIndexBuffer=a,this.bindIndexBuffer(a),
this._uintIndicesCurrentlySet=a.is32Bits)}_bindVertexBuffersAttributes(a,b,c){const d=b.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject();this.unbindAllAttributes();for(let g=0;g<d.length;g++){const n=b.getAttributeLocation(g);if(0<=n){var e=d[g];let t=null;if(c&&(t=c[e]),t||=a[e],t)this._gl.enableVertexAttribArray(n),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[n]=!0),(e=t.getBuffer())&&(this._vertexAttribPointer(e,n,t.getSize(),t.type,t.normalized,t.byteStride,
t.byteOffset),t.getIsInstanced()&&(this._gl.vertexAttribDivisor(n,t.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(e))))}}}recordVertexArrayObject(a,b,c,d){const e=this._gl.createVertexArray();if(!e)throw Error("Unable to create VAO");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(e),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(a,c,d),this.bindIndexBuffer(b),this._vaoRecordInProgress=!1,
this._gl.bindVertexArray(null),e}bindVertexArrayObject(a,b){this._cachedVertexArrayObject!==a&&(this._cachedVertexArrayObject=a,this._gl.bindVertexArray(a),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=b&&b.is32Bits,this._mustWipeVertexAttributes=!0)}bindBuffersDirectly(a,b,c,d,e){if(this._cachedVertexBuffers!==a||this._cachedEffectForVertexBuffers!==e){this._cachedVertexBuffers=a;this._cachedEffectForVertexBuffers=e;const g=e.getAttributesCount();
this._unbindVertexArrayObject();this.unbindAllAttributes();let n=0;for(let t=0;t<g;t++)if(t<c.length){const w=e.getAttributeLocation(t);0<=w&&(this._gl.enableVertexAttribArray(w),this._vertexAttribArraysEnabled[w]=!0,this._vertexAttribPointer(a,w,c[t],this._gl.FLOAT,!1,d,n));n+=4*c[t]}}this._bindIndexBufferWithCache(b)}_unbindVertexArrayObject(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))}bindBuffers(a,b,c,d){this._cachedVertexBuffers===a&&this._cachedEffectForVertexBuffers===
c||(this._cachedVertexBuffers=a,this._cachedEffectForVertexBuffers=c,this._bindVertexBuffersAttributes(a,c,d));this._bindIndexBufferWithCache(b)}unbindInstanceAttributes(){let a;for(let b=0,c=this._currentInstanceLocations.length;b<c;b++){const d=this._currentInstanceBuffers[b];a!=d&&d.references&&(a=d,this.bindArrayBuffer(d));this._gl.vertexAttribDivisor(this._currentInstanceLocations[b],0)}this._currentInstanceBuffers.length=0;this._currentInstanceLocations.length=0}releaseVertexArrayObject(a){this._gl.deleteVertexArray(a)}_releaseBuffer(a){return a.references--,
0===a.references?(this._deleteBuffer(a),!0):!1}_deleteBuffer(a){this._gl.deleteBuffer(a.underlyingResource)}updateAndBindInstancesBuffer(a,b,c){if(this.bindArrayBuffer(a),b&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,b),void 0!==c[0].index)this.bindInstancesBuffer(a,c,!0);else for(b=0;4>b;b++){const d=c[b];this._vertexAttribArraysEnabled[d]||(this._gl.enableVertexAttribArray(d),this._vertexAttribArraysEnabled[d]=!0);this._vertexAttribPointer(a,d,4,this._gl.FLOAT,!1,64,16*b);this._gl.vertexAttribDivisor(d,
1);this._currentInstanceLocations.push(d);this._currentInstanceBuffers.push(a)}}bindInstancesBuffer(a,b,c=!0){this.bindArrayBuffer(a);let d=0;if(c)for(c=0;c<b.length;c++)d+=4*b[c].attributeSize;for(c=0;c<b.length;c++){const e=b[c];void 0===e.index&&(e.index=this._currentEffect.getAttributeLocationByName(e.attributeName));0>e.index||(this._vertexAttribArraysEnabled[e.index]||(this._gl.enableVertexAttribArray(e.index),this._vertexAttribArraysEnabled[e.index]=!0),this._vertexAttribPointer(a,e.index,
e.attributeSize,e.attributeType||this._gl.FLOAT,e.normalized||!1,d,e.offset),this._gl.vertexAttribDivisor(e.index,void 0===e.divisor?1:e.divisor),this._currentInstanceLocations.push(e.index),this._currentInstanceBuffers.push(a))}}disableInstanceAttributeByName(a){this._currentEffect&&(a=this._currentEffect.getAttributeLocationByName(a),this.disableInstanceAttribute(a))}disableInstanceAttribute(a){let b=!1,c;for(;-1!==(c=this._currentInstanceLocations.indexOf(a));)this._currentInstanceLocations.splice(c,
1),this._currentInstanceBuffers.splice(c,1),b=!0,this._currentInstanceLocations.indexOf(a);b&&(this._gl.vertexAttribDivisor(a,0),this.disableAttributeByIndex(a))}disableAttributeByIndex(a){this._gl.disableVertexAttribArray(a);this._vertexAttribArraysEnabled[a]=!1;this._currentBufferPointers[a].active=!1}draw(a,b,c,d){this.drawElementsType(a?0:1,b,c,d)}drawPointClouds(a,b,c){this.drawArraysType(2,a,b,c)}drawUnIndexed(a,b,c,d){this.drawArraysType(a?0:1,b,c,d)}drawElementsType(a,b,c,d){this.applyStates();
this._reportDrawCall();a=this._drawMode(a);const e=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,g=this._uintIndicesCurrentlySet?4:2;d?this._gl.drawElementsInstanced(a,c,e,b*g,d):this._gl.drawElements(a,c,e,b*g)}drawArraysType(a,b,c,d){this.applyStates();this._reportDrawCall();a=this._drawMode(a);d?this._gl.drawArraysInstanced(a,b,c,d):this._gl.drawArrays(a,b,c)}_drawMode(a){switch(a){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;
case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}}_reportDrawCall(){}_releaseEffect(a){this._compiledEffects[a._key]&&delete this._compiledEffects[a._key];(a=a.getPipelineContext())&&this._deletePipelineContext(a)}_deletePipelineContext(a){a&&a.program&&(a.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(a.program))}_getGlobalDefines(a){if(a)this.isNDCHalfZRange?
a.IS_NDC_HALF_ZRANGE="":delete a.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?a.USE_REVERSE_DEPTHBUFFER="":delete a.USE_REVERSE_DEPTHBUFFER,this.useExactSrgbConversions?a.USE_EXACT_SRGB_CONVERSIONS="":delete a.USE_EXACT_SRGB_CONVERSIONS;else return a="",this.isNDCHalfZRange&&(a+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(a&&(a+="\n"),a+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(a&&(a+="\n"),a+="#define USE_EXACT_SRGB_CONVERSIONS"),a}createEffect(a,b,c,d,e,
g,n,t,w,z=Ke$$module$libs$world_onscreen.GLSL){var C;const H=a.vertexElement||a.vertex||a.vertexToken||a.vertexSource||a,M=a.fragmentElement||a.fragment||a.fragmentToken||a.fragmentSource||a,L=this._getGlobalDefines();let O=null!==(C=e??b.defines)&&void 0!==C?C:"";L&&(O+=L);C=H+"+"+M+"@"+O;if(this._compiledEffects[C])return a=this._compiledEffects[C],n&&a.isReady()&&n(a),a;n=new De$$module$libs$world_onscreen(a,b,c,d,this,e,g,n,t,w,C,z);return this._compiledEffects[C]=n,n}static _ConcatenateShader(a,
b,c=""){return c+(b?b+"\n":"")+a}_compileShader(a,b,c,d){return this._compileRawShader(le$$module$libs$world_onscreen._ConcatenateShader(a,c,d),b)}_compileRawShader(a,b){const c=this._gl;var d=c.createShader("vertex"===b?c.VERTEX_SHADER:c.FRAGMENT_SHADER);if(!d){for(a=c.NO_ERROR;(d=c.getError())!==c.NO_ERROR;)a=d;throw Error(`Something went wrong while creating a gl ${b} shader object. gl error=${a}, gl isContextLost=${c.isContextLost()}, _contextWasLost=${this._contextWasLost}`);}return c.shaderSource(d,
a),c.compileShader(d),d}_getShaderSource(a){return this._gl.getShaderSource(a)}createRawShaderProgram(a,b,c,d,e=null){d=d||this._gl;b=this._compileRawShader(b,"vertex");c=this._compileRawShader(c,"fragment");return this._createShaderProgram(a,b,c,d,e)}createShaderProgram(a,b,c,d,e,g=null){e=e||this._gl;const n=1<this._webGLVersion?"#version 300 es\n#define WEBGL2 \n":"";b=this._compileShader(b,"vertex",d,n);c=this._compileShader(c,"fragment",d,n);return this._createShaderProgram(a,b,c,e,g)}inlineShaderCode(a){return a}createPipelineContext(a){a=
new dn$$module$libs$world_onscreen;return a.engine=this,this._caps.parallelShaderCompile&&(a.isParallelCompiled=!0),a}createMaterialContext(){}createDrawContext(){}_createShaderProgram(a,b,c,d,e){e=d.createProgram();if(a.program=e,!e)throw Error("Unable to create program");return d.attachShader(e,b),d.attachShader(e,c),d.linkProgram(e),a.context=d,a.vertexShader=b,a.fragmentShader=c,a.isParallelCompiled||this._finalizePipelineContext(a),e}_finalizePipelineContext(a){const b=a.context,c=a.vertexShader,
d=a.fragmentShader;var e=a.program;if(!b.getProgramParameter(e,b.LINK_STATUS)){if(!this._gl.getShaderParameter(c,this._gl.COMPILE_STATUS)){var g=this._gl.getShaderInfoLog(c);if(g)throw a.vertexCompilationError=g,Error("VERTEX SHADER "+g);}if(!this._gl.getShaderParameter(d,this._gl.COMPILE_STATUS)&&(g=this._gl.getShaderInfoLog(d)))throw a.fragmentCompilationError=g,Error("FRAGMENT SHADER "+g);if(g=b.getProgramInfoLog(e))throw a.programLinkError=g,Error(g);}if(this.validateShaderPrograms&&(b.validateProgram(e),
!b.getProgramParameter(e,b.VALIDATE_STATUS))&&(e=b.getProgramInfoLog(e)))throw a.programValidationError=e,Error(e);b.deleteShader(c);b.deleteShader(d);a.vertexShader=void 0;a.fragmentShader=void 0;a.onCompiled&&(a.onCompiled(),a.onCompiled=void 0)}_preparePipelineContext(a,b,c,d,e,g,n,t,w,z){d?a.program=this.createRawShaderProgram(a,b,c,void 0,w):a.program=this.createShaderProgram(a,b,c,t,void 0,w);a.program.__SPECTOR_rebuildProgram=n}_isRenderingStateCompiled(a){return this._gl.getProgramParameter(a.program,
this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)?(this._finalizePipelineContext(a),!0):!1}_executeWhenRenderingStateIsCompiled(a,b){if(a.isParallelCompiled){var c=a.onCompiled;c?a.onCompiled=()=>{c();b()}:a.onCompiled=b}else b()}getUniforms(a,b){const c=[];for(let d=0;d<b.length;d++)c.push(this._gl.getUniformLocation(a.program,b[d]));return c}getAttributes(a,b){const c=[];for(let d=0;d<b.length;d++)try{c.push(this._gl.getAttribLocation(a.program,b[d]))}catch{c.push(-1)}return c}enableEffect(a){(a=
null!==a&&Ri$$module$libs$world_onscreen.IsWrapper(a)?a.effect:a)&&a!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,this.bindSamplers(a),this._currentEffect=a,a.onBind&&a.onBind(a),a._onBindObservable&&a._onBindObservable.notifyObservers(a))}setInt(a,b){return a?(this._gl.uniform1i(a,b),!0):!1}setInt2(a,b,c){return a?(this._gl.uniform2i(a,b,c),!0):!1}setInt3(a,b,c,d){return a?(this._gl.uniform3i(a,b,c,d),!0):!1}setInt4(a,b,c,d,e){return a?(this._gl.uniform4i(a,b,c,d,e),
!0):!1}setIntArray(a,b){return a?(this._gl.uniform1iv(a,b),!0):!1}setIntArray2(a,b){return a&&0===b.length%2?(this._gl.uniform2iv(a,b),!0):!1}setIntArray3(a,b){return a&&0===b.length%3?(this._gl.uniform3iv(a,b),!0):!1}setIntArray4(a,b){return a&&0===b.length%4?(this._gl.uniform4iv(a,b),!0):!1}setUInt(a,b){return a?(this._gl.uniform1ui(a,b),!0):!1}setUInt2(a,b,c){return a?(this._gl.uniform2ui(a,b,c),!0):!1}setUInt3(a,b,c,d){return a?(this._gl.uniform3ui(a,b,c,d),!0):!1}setUInt4(a,b,c,d,e){return a?
(this._gl.uniform4ui(a,b,c,d,e),!0):!1}setUIntArray(a,b){return a?(this._gl.uniform1uiv(a,b),!0):!1}setUIntArray2(a,b){return a&&0===b.length%2?(this._gl.uniform2uiv(a,b),!0):!1}setUIntArray3(a,b){return a&&0===b.length%3?(this._gl.uniform3uiv(a,b),!0):!1}setUIntArray4(a,b){return a&&0===b.length%4?(this._gl.uniform4uiv(a,b),!0):!1}setArray(a,b){return!a||1>b.length?!1:(this._gl.uniform1fv(a,b),!0)}setArray2(a,b){return a&&0===b.length%2?(this._gl.uniform2fv(a,b),!0):!1}setArray3(a,b){return a&&0===
b.length%3?(this._gl.uniform3fv(a,b),!0):!1}setArray4(a,b){return a&&0===b.length%4?(this._gl.uniform4fv(a,b),!0):!1}setMatrices(a,b){return a?(this._gl.uniformMatrix4fv(a,!1,b),!0):!1}setMatrix3x3(a,b){return a?(this._gl.uniformMatrix3fv(a,!1,b),!0):!1}setMatrix2x2(a,b){return a?(this._gl.uniformMatrix2fv(a,!1,b),!0):!1}setFloat(a,b){return a?(this._gl.uniform1f(a,b),!0):!1}setFloat2(a,b,c){return a?(this._gl.uniform2f(a,b,c),!0):!1}setFloat3(a,b,c,d){return a?(this._gl.uniform3f(a,b,c,d),!0):!1}setFloat4(a,
b,c,d,e){return a?(this._gl.uniform4f(a,b,c,d,e),!0):!1}applyStates(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;const a=this._colorWrite;this._gl.colorMask(a,a,a,a)}}setColorWrite(a){a!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=a)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}clearInternalTexturesCache(){this._internalTexturesCache.length=
0}wipeCaches(a){this.preventCacheWipeBetweenFrames&&!a||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),a&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=
null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))}_getSamplingParameters(a,b){const c=this._gl;let d=c.NEAREST,e=c.NEAREST;switch(a){case 11:d=c.LINEAR;b?e=c.LINEAR_MIPMAP_NEAREST:e=c.LINEAR;break;case 3:d=c.LINEAR;
b?e=c.LINEAR_MIPMAP_LINEAR:e=c.LINEAR;break;case 8:d=c.NEAREST;b?e=c.NEAREST_MIPMAP_LINEAR:e=c.NEAREST;break;case 4:d=c.NEAREST;b?e=c.NEAREST_MIPMAP_NEAREST:e=c.NEAREST;break;case 5:d=c.NEAREST;b?e=c.LINEAR_MIPMAP_NEAREST:e=c.LINEAR;break;case 6:d=c.NEAREST;b?e=c.LINEAR_MIPMAP_LINEAR:e=c.LINEAR;break;case 7:d=c.NEAREST;e=c.LINEAR;break;case 1:e=d=c.NEAREST;break;case 9:d=c.LINEAR;b?e=c.NEAREST_MIPMAP_NEAREST:e=c.NEAREST;break;case 10:d=c.LINEAR;b?e=c.NEAREST_MIPMAP_LINEAR:e=c.NEAREST;break;case 2:e=
d=c.LINEAR;break;case 12:d=c.LINEAR,e=c.NEAREST}return{min:e,mag:d}}_createTexture(){const a=this._gl.createTexture();if(!a)throw Error("Unable to create texture");return a}_createHardwareTexture(){return new Mr$$module$libs$world_onscreen(this._createTexture(),this._gl)}_createInternalTexture(a,b,c,d=Oe$$module$libs$world_onscreen.Unknown){var e;c=!1;let g=0,n=3,t=5,w=!1,z=1;void 0!==b&&"object"==typeof b?(c=!!b.generateMipMaps,g=void 0===b.type?0:b.type,n=void 0===b.samplingMode?3:b.samplingMode,
t=void 0===b.format?5:b.format,w=void 0===b.useSRGBBuffer?!1:b.useSRGBBuffer,z=null!==(e=b.samples)&&void 0!==e?e:1):c=!!b;w&&=this._caps.supportSRGBBuffers&&(1<this.webGLVersion||this.isWebGPU);(1===g&&!this._caps.textureFloatLinearFiltering||2===g&&!this._caps.textureHalfFloatLinearFiltering)&&(n=1);1===g&&!this._caps.textureFloat&&(g=0,O$$module$libs$world_onscreen.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));b=this._gl;d=new Vt$$module$libs$world_onscreen(this,
d);e=a.width||a;const C=a.height||a;a=a.layers||0;const H=this._getSamplingParameters(n,c),M=0!==a?b.TEXTURE_2D_ARRAY:b.TEXTURE_2D,L=this._getRGBABufferInternalSizedFormat(g,t,w),O=this._getInternalFormat(t),S=this._getWebGLTextureType(g);return this._bindTextureDirectly(M,d),0!==a?(d.is2DArray=!0,b.texImage3D(M,0,L,e,C,a,0,O,S,null)):b.texImage2D(M,0,L,e,C,0,O,S,null),b.texParameteri(M,b.TEXTURE_MAG_FILTER,H.mag),b.texParameteri(M,b.TEXTURE_MIN_FILTER,H.min),b.texParameteri(M,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),
b.texParameteri(M,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),c&&this._gl.generateMipmap(M),this._bindTextureDirectly(M,null),d._useSRGBBuffer=w,d.baseWidth=e,d.baseHeight=C,d.width=e,d.height=C,d.depth=a,d.isReady=!0,d.samples=z,d.generateMipMaps=c,d.samplingMode=n,d.type=g,d.format=t,this._internalTexturesCache.push(d),d}_getUseSRGBBuffer(a,b){return a&&this._caps.supportSRGBBuffers&&(1<this.webGLVersion||this.isWebGPU||b)}_createTextureBase(a,b,c,d,e=3,g=null,n=null,t,w,z=null,C=null,H=null,M=null,L,O,S){a=
a||"";const T="data:"===a.substr(0,5),P="blob:"===a.substr(0,5),W=T&&-1!==a.indexOf(";base64,"),Z=C||new Vt$$module$libs$world_onscreen(this,Oe$$module$libs$world_onscreen.Url),ca=a;!this._transformTextureUrl||W||C||z||(a=this._transformTextureUrl(a));ca!==a&&(Z._originalUrl=ca);const ba=a.lastIndexOf(".");let la=M||(-1<ba?a.substring(ba).toLowerCase():""),ea=null;-1<la.indexOf("?")&&(la=la.split("?")[0]);for(const xa of le$$module$libs$world_onscreen._TextureLoaders)if(xa.canLoad(la,L)){ea=xa;break}d&&
d.addPendingData(Z);Z.url=a;Z.generateMipMaps=!b;Z.samplingMode=e;Z.invertY=c;Z._useSRGBBuffer=this._getUseSRGBBuffer(!!S,b);this._doNotHandleContextLost||(Z._buffer=z);let oa=null;g&&!C&&(oa=Z.onLoadedObservable.add(g));C||this._internalTexturesCache.push(Z);const sa=(xa,ya)=>{d&&d.removePendingData(Z);a===ca?(oa&&Z.onLoadedObservable.remove(oa),fe$$module$libs$world_onscreen.UseFallbackTexture&&this._createTextureBase(fe$$module$libs$world_onscreen.FallbackTexture,b,Z.invertY,d,e,null,n,t,w,z,Z),
xa=(xa||"Unknown error")+(fe$$module$libs$world_onscreen.UseFallbackTexture?" - Fallback texture was used":""),Z.onErrorObservable.notifyObservers({message:xa,exception:ya}),n&&n(xa,ya)):(O$$module$libs$world_onscreen.Warn(`Failed to load ${a}, falling back to ${ca}`),this._createTextureBase(ca,b,Z.invertY,d,e,g,n,t,w,z,Z,H,M,L,O,S))};if(ea){const xa=ya=>{ea.loadData(ya,Z,(Ya,Ja,ac,Ia,Ma,Nb)=>{Nb?sa("TextureLoader failed to load data"):t(Z,la,d,{width:Ya,height:Ja},Z.invertY,!ac,Ia,()=>(Ma(),!1),
e)},O)};z?z instanceof ArrayBuffer?xa(new Uint8Array(z)):ArrayBuffer.isView(z)?xa(z):n&&n("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(a,ya=>xa(new Uint8Array(ya)),void 0,d?d.offlineProvider:void 0,!0,(ya,Ya)=>{sa("Unable to load "+(ya&&ya.responseURL,Ya))})}else c=xa=>{P&&!this._doNotHandleContextLost&&(Z._buffer=xa);t(Z,la,d,xa,Z.invertY,b,!1,w,e)},!T||W?z&&("string"==typeof z.decoding||z.close)?c(z):le$$module$libs$world_onscreen._FileToolsLoadImage(a,
c,sa,d?d.offlineProvider:null,L,Z.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof z||z instanceof ArrayBuffer||ArrayBuffer.isView(z)||z instanceof Blob?le$$module$libs$world_onscreen._FileToolsLoadImage(z,c,sa,d?d.offlineProvider:null,L,Z.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):z&&c(z);return Z}createTexture(a,b,c,d,e=3,g=null,n=null,t=null,w=null,z=null,C=null,H,M,L,O){return this._createTextureBase(a,b,c,d,
e,g,n,this._prepareWebGLTexture.bind(this),(S,T,P,W,Z,ca)=>{const ba=this._gl;var la=P.width===S&&P.height===T;const ea=z?this._getInternalFormat(z,Z._useSRGBBuffer):".jpg"!==W||Z._useSRGBBuffer?Z._useSRGBBuffer?ba.SRGB8_ALPHA8:ba.RGBA:ba.RGB;W=z?this._getInternalFormat(z):".jpg"!==W||Z._useSRGBBuffer?ba.RGBA:ba.RGB;if(Z._useSRGBBuffer&&1===this.webGLVersion&&(W=ea),la)return ba.texImage2D(ba.TEXTURE_2D,0,ea,W,ba.UNSIGNED_BYTE,P),!1;la=this._caps.maxTextureSize;if(P.width>la||P.height>la||!this._supportsHardwareTextureRescaling)return this._prepareWorkingCanvas(),
!this._workingCanvas||!this._workingContext||(this._workingCanvas.width=S,this._workingCanvas.height=T,this._workingContext.drawImage(P,0,0,P.width,P.height,0,0,S,T),ba.texImage2D(ba.TEXTURE_2D,0,ea,W,ba.UNSIGNED_BYTE,this._workingCanvas),Z.width=S,Z.height=T),!1;const oa=new Vt$$module$libs$world_onscreen(this,Oe$$module$libs$world_onscreen.Temp);this._bindTextureDirectly(ba.TEXTURE_2D,oa,!0);ba.texImage2D(ba.TEXTURE_2D,0,ea,W,ba.UNSIGNED_BYTE,P);this._rescaleTexture(oa,Z,d,ea,()=>{this._releaseTexture(oa);
this._bindTextureDirectly(ba.TEXTURE_2D,Z,!0);ca()});return!0},t,w,z,C,H,M,O)}static _FileToolsLoadImage(a,b,c,d,e,g){throw $$$module$libs$world_onscreen("FileTools");}_rescaleTexture(a,b,c,d,e){}createRawTexture(a,b,c,d,e,g,n,t,w,z,C){throw $$$module$libs$world_onscreen("Engine.RawTexture");}createRawCubeTexture(a,b,c,d,e,g,n,t){throw $$$module$libs$world_onscreen("Engine.RawTexture");}createRawTexture3D(a,b,c,d,e,g,n,t,w,z){throw $$$module$libs$world_onscreen("Engine.RawTexture");}createRawTexture2DArray(a,
b,c,d,e,g,n,t,w,z){throw $$$module$libs$world_onscreen("Engine.RawTexture");}_unpackFlipY(a){this._unpackFlipYCached!==a&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,a?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=a))}_getUnpackAlignement(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)}_getTextureTarget(a){return a.isCube?this._gl.TEXTURE_CUBE_MAP:a.is3D?this._gl.TEXTURE_3D:a.is2DArray||a.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D}updateTextureSamplingMode(a,
b,c=!1){const d=this._getTextureTarget(b),e=this._getSamplingParameters(a,b.generateMipMaps||c);this._setTextureParameterInteger(d,this._gl.TEXTURE_MAG_FILTER,e.mag,b);this._setTextureParameterInteger(d,this._gl.TEXTURE_MIN_FILTER,e.min);c&&(b.generateMipMaps=!0,this._gl.generateMipmap(d));this._bindTextureDirectly(d,null);b.samplingMode=a}updateTextureDimensions(a,b,c,d){}updateTextureWrappingMode(a,b,c=null,d=null){const e=this._getTextureTarget(a);null!==b&&(this._setTextureParameterInteger(e,
this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(b),a),a._cachedWrapU=b);null!==c&&(this._setTextureParameterInteger(e,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(c),a),a._cachedWrapV=c);(a.is2DArray||a.is3D)&&null!==d&&(this._setTextureParameterInteger(e,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(d),a),a._cachedWrapR=d);this._bindTextureDirectly(e,null)}_setupDepthStencilTexture(a,b,c,d,e,g=1){c=b.width||b;const n=b.height||b;b=b.layers||0;a.baseWidth=c;a.baseHeight=n;a.width=c;a.height=
n;a.is2DArray=0<b;a.depth=b;a.isReady=!0;a.samples=g;a.generateMipMaps=!1;a.samplingMode=d?2:1;a.type=0;a._comparisonFunction=e;d=this._gl;g=this._getTextureTarget(a);a=this._getSamplingParameters(a.samplingMode,!1);d.texParameteri(g,d.TEXTURE_MAG_FILTER,a.mag);d.texParameteri(g,d.TEXTURE_MIN_FILTER,a.min);d.texParameteri(g,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(g,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);1<this.webGLVersion&&(0===e?(d.texParameteri(g,d.TEXTURE_COMPARE_FUNC,515),d.texParameteri(g,
d.TEXTURE_COMPARE_MODE,d.NONE)):(d.texParameteri(g,d.TEXTURE_COMPARE_FUNC,e),d.texParameteri(g,d.TEXTURE_COMPARE_MODE,d.COMPARE_REF_TO_TEXTURE)))}_uploadCompressedDataToTextureDirectly(a,b,c,d,e,g=0,n=0){const t=this._gl;let w=t.TEXTURE_2D;if(a.isCube&&(w=t.TEXTURE_CUBE_MAP_POSITIVE_X+g),a._useSRGBBuffer)switch(b){case 37492:case 36196:this._caps.etc2?b=t.COMPRESSED_SRGB8_ETC2:a._useSRGBBuffer=!1;break;case 37496:this._caps.etc2?b=t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a._useSRGBBuffer=!1;break;case 36492:b=
t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:b=t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?b=t.COMPRESSED_SRGB_S3TC_DXT1_EXT:a._useSRGBBuffer=!1;break;case 33777:this._caps.s3tc_srgb?b=t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:a._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?b=t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:a._useSRGBBuffer=!1;break;default:a._useSRGBBuffer=!1}this._gl.compressedTexImage2D(w,n,b,c,d,0,e)}_uploadDataToTextureDirectly(a,b,c=0,
d=0,e,g=!1){const n=this._gl,t=this._getWebGLTextureType(a.type),w=this._getInternalFormat(a.format);e=void 0===e?this._getRGBABufferInternalSizedFormat(a.type,a.format,a._useSRGBBuffer):this._getInternalFormat(e,a._useSRGBBuffer);this._unpackFlipY(a.invertY);let z=n.TEXTURE_2D;a.isCube&&(z=n.TEXTURE_CUBE_MAP_POSITIVE_X+c);c=Math.round(Math.log(a.width)*Math.LOG2E);const C=Math.round(Math.log(a.height)*Math.LOG2E);n.texImage2D(z,d,e,g?a.width:Math.pow(2,Math.max(c-d,0)),g?a.height:Math.pow(2,Math.max(C-
d,0)),0,w,t,b)}updateTextureData(a,b,c,d,e,g,n=0,t=0,w=!1){const z=this._gl,C=this._getWebGLTextureType(a.type),H=this._getInternalFormat(a.format);this._unpackFlipY(a.invertY);let M=z.TEXTURE_2D,L=z.TEXTURE_2D;a.isCube&&(L=z.TEXTURE_CUBE_MAP_POSITIVE_X+n,M=z.TEXTURE_CUBE_MAP);this._bindTextureDirectly(M,a,!0);z.texSubImage2D(L,t,c,d,e,g,H,C,b);w&&this._gl.generateMipmap(L);this._bindTextureDirectly(M,null)}_uploadArrayBufferViewToTexture(a,b,c=0,d=0){var e=this._gl;e=a.isCube?e.TEXTURE_CUBE_MAP:
e.TEXTURE_2D;this._bindTextureDirectly(e,a,!0);this._uploadDataToTextureDirectly(a,b,c,d);this._bindTextureDirectly(e,null,!0)}_prepareWebGLTextureContinuation(a,b,c,d,e){const g=this._gl;g&&(e=this._getSamplingParameters(e,!c),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e.mag),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,e.min),c||d||g.generateMipmap(g.TEXTURE_2D),this._bindTextureDirectly(g.TEXTURE_2D,null),b&&b.removePendingData(a),a.onLoadedObservable.notifyObservers(a),a.onLoadedObservable.clear())}_prepareWebGLTexture(a,
b,c,d,e,g,n,t,w=3){var z=this.getCaps().maxTextureSize;const C=Math.min(z,this.needPOTTextures?le$$module$libs$world_onscreen.GetExponentOfTwo(d.width,z):d.width);z=Math.min(z,this.needPOTTextures?le$$module$libs$world_onscreen.GetExponentOfTwo(d.height,z):d.height);const H=this._gl;H&&(a._hardwareTexture?(this._bindTextureDirectly(H.TEXTURE_2D,a,!0),this._unpackFlipY(void 0===e?!0:!!e),a.baseWidth=d.width,a.baseHeight=d.height,a.width=C,a.height=z,a.isReady=!0,!t(C,z,d,b,a,()=>{this._prepareWebGLTextureContinuation(a,
c,g,n,w)})&&this._prepareWebGLTextureContinuation(a,c,g,n,w)):c&&c.removePendingData(a))}_setupFramebufferDepthAttachments(a,b,c,d,e=1){const g=this._gl;return a&&b?this._createRenderBuffer(c,d,e,g.DEPTH_STENCIL,g.DEPTH24_STENCIL8,g.DEPTH_STENCIL_ATTACHMENT):b?(a=g.DEPTH_COMPONENT16,1<this._webGLVersion&&(a=g.DEPTH_COMPONENT32F),this._createRenderBuffer(c,d,e,a,a,g.DEPTH_ATTACHMENT)):a?this._createRenderBuffer(c,d,e,g.STENCIL_INDEX8,g.STENCIL_INDEX8,g.STENCIL_ATTACHMENT):null}_createRenderBuffer(a,
b,c,d,e,g,n=!0){const t=this._gl.createRenderbuffer();return this._updateRenderBuffer(t,a,b,c,d,e,g,n)}_updateRenderBuffer(a,b,c,d,e,g,n,t=!0){const w=this._gl;return w.bindRenderbuffer(w.RENDERBUFFER,a),1<d&&w.renderbufferStorageMultisample?w.renderbufferStorageMultisample(w.RENDERBUFFER,d,g,b,c):w.renderbufferStorage(w.RENDERBUFFER,e,b,c),w.framebufferRenderbuffer(w.FRAMEBUFFER,n,w.RENDERBUFFER,a),t&&w.bindRenderbuffer(w.RENDERBUFFER,null),a}_releaseTexture(a){var b;this._deleteTexture(null===(b=
a._hardwareTexture)||void 0===b?void 0:b.underlyingResource);this.unbindAllTextures();b=this._internalTexturesCache.indexOf(a);-1!==b&&this._internalTexturesCache.splice(b,1);a._lodTextureHigh&&a._lodTextureHigh.dispose();a._lodTextureMid&&a._lodTextureMid.dispose();a._lodTextureLow&&a._lodTextureLow.dispose();a._irradianceTexture&&a._irradianceTexture.dispose()}_releaseRenderTargetWrapper(a){a=this._renderTargetWrapperCache.indexOf(a);-1!==a&&this._renderTargetWrapperCache.splice(a,1)}_deleteTexture(a){a&&
this._gl.deleteTexture(a)}_setProgram(a){this._currentProgram!==a&&(this._gl.useProgram(a),this._currentProgram=a)}bindSamplers(a){var b=a.getPipelineContext();this._setProgram(b.program);b=a.getSamplers();for(let c=0;c<b.length;c++){const d=a.getUniform(b[c]);d&&(this._boundUniforms[c]=d)}this._currentEffect=null}_activateCurrentTexture(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)}_bindTextureDirectly(a,
b,c=!1,d=!1){var e,g;let n=!1;const t=b&&-1<b._associatedChannel;if(c&&t&&(this._activeChannel=b._associatedChannel),this._boundTexturesCache[this._activeChannel]!==b||d){if(this._activateCurrentTexture(),b&&b.isMultiview)throw console.error(a,b),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(a,null!==(g=null===(e=null==b?void 0:b._hardwareTexture)||void 0===e?void 0:e.underlyingResource)&&void 0!==g?g:null);(this._boundTexturesCache[this._activeChannel]=b)&&(b._associatedChannel=
this._activeChannel)}else c&&(n=!0,this._activateCurrentTexture());return t&&!c&&this._bindSamplerUniformToChannel(b._associatedChannel,this._activeChannel),n}_bindTexture(a,b,c){void 0!==a&&(b&&(b._associatedChannel=a),this._activeChannel=a,a=b?this._getTextureTarget(b):this._gl.TEXTURE_2D,this._bindTextureDirectly(a,b))}unbindAllTextures(){for(let a=0;a<this._maxSimultaneousTextures;a++)this._activeChannel=a,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,
null),1<this.webGLVersion&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))}setTexture(a,b,c,d){void 0!==a&&(b&&(this._boundUniforms[a]=b),this._setTexture(a,c))}_bindSamplerUniformToChannel(a,b){a=this._boundUniforms[a];!a||a._currentState===b||(this._gl.uniform1i(a,b),a._currentState=b)}_getTextureWrapMode(a){switch(a){case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT}_setTexture(a,b,
c=!1,d=!1,e){if(!b)return null!=this._boundTexturesCache[a]&&(this._activeChannel=a,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),1<this.webGLVersion&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(b.video)this._activeChannel=a,b.update();else if(4===b.delayLoadState)return b.delayLoad(),!1;let g;d?g=b.depthStencilTexture:b.isReady()?g=b.getInternalTexture():b.isCube?
g=this.emptyCubeTexture:b.is3D?g=this.emptyTexture3D:b.is2DArray?g=this.emptyTexture2DArray:g=this.emptyTexture;!c&&g&&(g._associatedChannel=a);d=!0;this._boundTexturesCache[a]===g&&(c||this._bindSamplerUniformToChannel(g._associatedChannel,a),d=!1);this._activeChannel=a;a=this._getTextureTarget(g);if(d&&this._bindTextureDirectly(a,g,c),g&&!g.isMultiview)g.isCube&&g._cachedCoordinatesMode!==b.coordinatesMode&&(g._cachedCoordinatesMode=b.coordinatesMode,c=3!==b.coordinatesMode&&5!==b.coordinatesMode?
1:0,b.wrapU=c,b.wrapV=c),g._cachedWrapU!==b.wrapU&&(g._cachedWrapU=b.wrapU,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(b.wrapU),g)),g._cachedWrapV!==b.wrapV&&(g._cachedWrapV=b.wrapV,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(b.wrapV),g)),g.is3D&&g._cachedWrapR!==b.wrapR&&(g._cachedWrapR=b.wrapR,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(b.wrapR),g)),this._setAnisotropicLevel(a,
g,b.anisotropicFilteringLevel);return!0}setTextureArray(a,b,c,d){if(void 0!==a&&b){this._textureUnits&&this._textureUnits.length===c.length||(this._textureUnits=new Int32Array(c.length));for(d=0;d<c.length;d++){const e=c[d].getInternalTexture();e?(this._textureUnits[d]=a+d,e._associatedChannel=a+d):this._textureUnits[d]=-1}this._gl.uniform1iv(b,this._textureUnits);for(a=0;a<c.length;a++)this._setTexture(this._textureUnits[a],c[a],!0)}}_setAnisotropicLevel(a,b,c){const d=this._caps.textureAnisotropicFilterExtension;
11!==b.samplingMode&&3!==b.samplingMode&&2!==b.samplingMode&&(c=1);d&&b._cachedAnisotropicFilteringLevel!==c&&(this._setTextureParameterFloat(a,d.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c,this._caps.maxAnisotropy),b),b._cachedAnisotropicFilteringLevel=c)}_setTextureParameterFloat(a,b,c,d){this._bindTextureDirectly(a,d,!0,!0);this._gl.texParameterf(a,b,c)}_setTextureParameterInteger(a,b,c,d){d&&this._bindTextureDirectly(a,d,!0,!0);this._gl.texParameteri(a,b,c)}unbindAllAttributes(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=
!1;for(let a=0;a<this._caps.maxVertexAttribs;a++)this.disableAttributeByIndex(a)}else for(let a=0,b=this._vertexAttribArraysEnabled.length;a<b;a++)a>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[a]||this.disableAttributeByIndex(a)}releaseEffects(){for(const a in this._compiledEffects){const b=this._compiledEffects[a].getPipelineContext();this._deletePipelineContext(b)}this._compiledEffects={}}dispose(){var a;this.stopRenderLoop();this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();
this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null);this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null);this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer);this.releaseEffects();null===(a=this.releaseComputeEffects)||void 0===a||a.call(this);this.unbindAllAttributes();this._boundUniforms={};Ze$$module$libs$world_onscreen()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",
this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)),window.removeEventListener("resize",this._checkForMobile));this._workingContext=this._workingCanvas=null;this._currentBufferPointers.length=0;this._boundRenderFunction=this._currentProgram=this._renderingCanvas=null;De$$module$libs$world_onscreen.ResetCache();for(const b of this._activeRequests)b.abort();this.onDisposeObservable.notifyObservers(this);this.onDisposeObservable.clear()}attachContextLostEvent(a){this._renderingCanvas&&
this._renderingCanvas.addEventListener("webglcontextlost",a,!1)}attachContextRestoredEvent(a){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",a,!1)}getError(){return this._gl.getError()}_canRenderToFloatFramebuffer(){return 1<this._webGLVersion?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)}_canRenderToHalfFloatFramebuffer(){return 1<this._webGLVersion?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)}_canRenderToFramebuffer(a){const b=this._gl;
for(;b.getError()!==b.NO_ERROR;);let c=!0;const d=b.createTexture();b.bindTexture(b.TEXTURE_2D,d);b.texImage2D(b.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(a),1,1,0,b.RGBA,this._getWebGLTextureType(a),null);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);a=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,a);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,d,0);var e=b.checkFramebufferStatus(b.FRAMEBUFFER);
if(c=c&&e===b.FRAMEBUFFER_COMPLETE,c=c&&b.getError()===b.NO_ERROR,c&&(b.clear(b.COLOR_BUFFER_BIT),c=c&&b.getError()===b.NO_ERROR),c){b.bindFramebuffer(b.FRAMEBUFFER,null);e=b.RGBA;const g=b.UNSIGNED_BYTE,n=new Uint8Array(4);b.readPixels(0,0,1,1,e,g,n);c=c&&b.getError()===b.NO_ERROR}b.deleteTexture(d);b.deleteFramebuffer(a);for(b.bindFramebuffer(b.FRAMEBUFFER,null);!c&&b.getError()!==b.NO_ERROR;);return c}_getWebGLTextureType(a){if(1===this._webGLVersion){switch(a){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;
case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(a){case 3:return this._gl.BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;
case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE}_getInternalFormat(a,b=!1){let c=b?this._gl.SRGB8_ALPHA8:this._gl.RGBA;switch(a){case 0:c=this._gl.ALPHA;break;case 1:c=this._gl.LUMINANCE;break;case 2:c=this._gl.LUMINANCE_ALPHA;break;case 6:c=this._gl.RED;break;case 7:c=
this._gl.RG;break;case 4:c=b?this._gl.SRGB:this._gl.RGB;break;case 5:c=b?this._gl.SRGB8_ALPHA8:this._gl.RGBA}if(1<this._webGLVersion)switch(a){case 8:c=this._gl.RED_INTEGER;break;case 9:c=this._gl.RG_INTEGER;break;case 10:c=this._gl.RGB_INTEGER;break;case 11:c=this._gl.RGBA_INTEGER}return c}_getRGBABufferInternalSizedFormat(a,b,c=!1){if(1===this._webGLVersion){if(void 0!==b)switch(b){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return c?
this._gl.SRGB:this._gl.RGB}return this._gl.RGBA}switch(a){case 3:switch(b){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(b){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return c?this._gl.SRGB8:this._gl.RGB8;case 5:return c?this._gl.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;
case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(b){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:return this._gl.RGBA16I;default:return this._gl.RGBA16I}case 5:switch(b){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:return this._gl.RGBA16UI;
default:return this._gl.RGBA16UI}case 6:switch(b){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:return this._gl.RGBA32I;default:return this._gl.RGBA32I}case 7:switch(b){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:return this._gl.RGBA32UI;default:return this._gl.RGBA32UI}case 1:switch(b){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:return this._gl.RGBA32F;
default:return this._gl.RGBA32F}case 2:switch(b){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:return this._gl.RGBA16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(b){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return c?this._gl.SRGB8_ALPHA8:
this._gl.RGBA8}_getRGBAMultiSampleBufferFormat(a){return 1===a?this._gl.RGBA32F:2===a?this._gl.RGBA16F:this._gl.RGBA8}_loadFile(a,b,c,d,e,g){a=le$$module$libs$world_onscreen._FileToolsLoadFile(a,b,c,d,e,g);return this._activeRequests.push(a),a.onCompleteObservable.add(n=>{this._activeRequests.splice(this._activeRequests.indexOf(n),1)}),a}static _FileToolsLoadFile(a,b,c,d,e,g){throw $$$module$libs$world_onscreen("FileTools");}readPixels(a,b,c,d,e=!0,g=!0){const n=e?this._gl.RGBA:this._gl.RGB;e=new Uint8Array(d*
c*(e?4:3));return g&&this.flushFramebuffer(),this._gl.readPixels(a,b,c,d,n,this._gl.UNSIGNED_BYTE,e),Promise.resolve(e)}static get IsSupportedAsync(){return Promise.resolve(this.isSupported())}static get IsSupported(){return this.isSupported()}static isSupported(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{const a=this._CreateCanvas(1,1);this._IsSupported=null!=(a.getContext("webgl")||a.getContext("experimental-webgl"))&&!!window.WebGLRenderingContext}catch{this._IsSupported=
!1}return this._IsSupported}static get HasMajorPerformanceCaveat(){if(null===this._HasMajorPerformanceCaveat)try{const a=this._CreateCanvas(1,1);this._HasMajorPerformanceCaveat=!(a.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||a.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0}))}catch{this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat}static CeilingPOT(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a++,a}static FloorPOT(a){return a|=a>>1,a|=
a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a-(a>>1)}static NearestPOT(a){const b=le$$module$libs$world_onscreen.CeilingPOT(a),c=le$$module$libs$world_onscreen.FloorPOT(a);return b-a>a-c?c:b}static GetExponentOfTwo(a,b,c=2){switch(c){case 1:a=le$$module$libs$world_onscreen.FloorPOT(a);break;case 2:a=le$$module$libs$world_onscreen.NearestPOT(a);break;default:a=le$$module$libs$world_onscreen.CeilingPOT(a)}return Math.min(a,b)}static QueueNewFrame(a,b){if(Ze$$module$libs$world_onscreen()){const {requestPostAnimationFrame:c,
requestAnimationFrame:d}=b||window;if("function"==typeof c)return c(a);if("function"==typeof d)return d(a)}else if("function"==typeof requestAnimationFrame)return requestAnimationFrame(a);return setTimeout(a,16)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:Di$$module$libs$world_onscreen()?document:null}}
le$$module$libs$world_onscreen.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,
captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}];
le$$module$libs$world_onscreen._TextureLoaders=[];le$$module$libs$world_onscreen.CollisionsEpsilon=.001;le$$module$libs$world_onscreen._IsSupported=null;le$$module$libs$world_onscreen._HasMajorPerformanceCaveat=null;
class gn$$module$libs$world_onscreen{constructor(a=30){this._enabled=!0;this._rollingFrameTime=new pn$$module$libs$world_onscreen(a)}sampleFrame(a=ai$$module$libs$world_onscreen.Now){this._enabled&&(null!=this._lastFrameTimeMs&&this._rollingFrameTime.add(a-this._lastFrameTimeMs),this._lastFrameTimeMs=a)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1E3/
this._rollingFrameTime.average}get instantaneousFPS(){const a=this._rollingFrameTime.history(0);return 0===a?0:1E3/a}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1;this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null;this._rollingFrameTime.reset()}}
class pn$$module$libs$world_onscreen{constructor(a){this._samples=Array(a);this.reset()}add(a){let b;if(this.isSaturated()){const c=this._samples[this._pos];b=c-this.average;this.average-=b/(this._sampleCount-1);this._m2-=b*(c-this.average)}else this._sampleCount++;b=a-this.average;this.average+=b/this._sampleCount;this._m2+=b*(a-this.average);this.variance=this._m2/(this._sampleCount-1);this._samples[this._pos]=a;this._pos++;this._pos%=this._samples.length}history(a){if(a>=this._sampleCount||a>=
this._samples.length)return 0;const b=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(b-a)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this._m2=this._pos=this._sampleCount=this.variance=this.average=0}_wrapPosition(a){const b=this._samples.length;return(a%b+b)%b}}
class yt$$module$libs$world_onscreen{constructor(){this._lastSecValueCount=this._lastSecTime=this._lastSecAccumulated=this._totalAccumulated=this._totalValueCount=this._current=this._lastSecAverage=this._average=this._max=this._min=this._startMonitoringTime=0}get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}fetchNewFrame(){this._totalValueCount++;
this._current=0;this._lastSecValueCount++}addCount(a,b){yt$$module$libs$world_onscreen.Enabled&&(this._current+=a,b&&this._fetchResult())}beginMonitoring(){yt$$module$libs$world_onscreen.Enabled&&(this._startMonitoringTime=ai$$module$libs$world_onscreen.Now)}endMonitoring(a=!0){yt$$module$libs$world_onscreen.Enabled&&(a&&this.fetchNewFrame(),this._current=ai$$module$libs$world_onscreen.Now-this._startMonitoringTime,a&&this._fetchResult())}_fetchResult(){this._totalAccumulated+=this._current;this._lastSecAccumulated+=
this._current;this._min=Math.min(this._min,this._current);this._max=Math.max(this._max,this._current);this._average=this._totalAccumulated/this._totalValueCount;const a=ai$$module$libs$world_onscreen.Now;1E3<a-this._lastSecTime&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=a,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}yt$$module$libs$world_onscreen.Enabled=!0;
le$$module$libs$world_onscreen.prototype.setAlphaConstants=function(a,b,c,d){this._alphaState.setAlphaBlendConstants(a,b,c,d)};
le$$module$libs$world_onscreen.prototype.setAlphaMode=function(a,b=!1){if(this._alphaMode!==a){switch(a){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 8:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,
this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,
this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,
this._gl.ONE_MINUS_CONSTANT_ALPHA);this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,
this._gl.ZERO);this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA);this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,
this._gl.ONE,this._gl.ONE,this._gl.ZERO);this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE);this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0}b||(this.depthCullingState.depthMask=0===a);this._alphaMode=a}};
le$$module$libs$world_onscreen.prototype.getAlphaMode=function(){return this._alphaMode};
le$$module$libs$world_onscreen.prototype.setAlphaEquation=function(a){if(this._alphaEquation!==a){switch(a){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,
32774)}this._alphaEquation=a}};le$$module$libs$world_onscreen.prototype.getAlphaEquation=function(){return this._alphaEquation};
function mn$$module$libs$world_onscreen(a,b,c=!1,d){switch(a){case 3:return a=new Int8Array(b),d&&a.set(new Int8Array(d)),a;case 0:return a=new Uint8Array(b),d&&a.set(new Uint8Array(d)),a;case 4:return a=b instanceof ArrayBuffer?new Int16Array(b):new Int16Array(c?b/2:b),d&&a.set(new Int16Array(d)),a;case 5:case 8:case 9:case 10:case 2:return a=b instanceof ArrayBuffer?new Uint16Array(b):new Uint16Array(c?b/2:b),d&&a.set(new Uint16Array(d)),a;case 6:return a=b instanceof ArrayBuffer?new Int32Array(b):
new Int32Array(c?b/4:b),d&&a.set(new Int32Array(d)),a;case 7:case 11:case 12:case 13:case 14:case 15:return a=b instanceof ArrayBuffer?new Uint32Array(b):new Uint32Array(c?b/4:b),d&&a.set(new Uint32Array(d)),a;case 1:return a=b instanceof ArrayBuffer?new Float32Array(b):new Float32Array(c?b/4:b),d&&a.set(new Float32Array(d)),a}a=new Uint8Array(b);return d&&a.set(new Uint8Array(d)),a}
le$$module$libs$world_onscreen.prototype._readTexturePixelsSync=function(a,b,c,d=-1,e=0,g=null,n=!0,t=!1,w=0,z=0){var C,H;const M=this._gl;if(!M)throw Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){const L=M.createFramebuffer();if(!L)throw Error("Unable to create dummy framebuffer");this._dummyFramebuffer=L}M.bindFramebuffer(M.FRAMEBUFFER,this._dummyFramebuffer);-1<d?M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+d,null===(C=
a._hardwareTexture)||void 0===C?void 0:C.underlyingResource,e):M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,null===(H=a._hardwareTexture)||void 0===H?void 0:H.underlyingResource,e);d=void 0!==a.type?this._getWebGLTextureType(a.type):M.UNSIGNED_BYTE;if(t)g||=mn$$module$libs$world_onscreen(a.type,4*b*c);else switch(d){case M.UNSIGNED_BYTE:g||=new Uint8Array(4*b*c);d=M.UNSIGNED_BYTE;break;default:g||=new Float32Array(4*b*c),d=M.FLOAT}return n&&this.flushFramebuffer(),M.readPixels(w,
z,b,c,M.RGBA,d,g),M.bindFramebuffer(M.FRAMEBUFFER,this._currentFramebuffer),g};le$$module$libs$world_onscreen.prototype._readTexturePixels=function(a,b,c,d=-1,e=0,g=null,n=!0,t=!1,w=0,z=0){return Promise.resolve(this._readTexturePixelsSync(a,b,c,d,e,g,n,t,w,z))};
le$$module$libs$world_onscreen.prototype.updateDynamicIndexBuffer=function(a,b,c){this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null;this.bindIndexBuffer(a);let d;a.is32Bits?d=b instanceof Uint32Array?b:new Uint32Array(b):d=b instanceof Uint16Array?b:new Uint16Array(b);this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,d,this._gl.DYNAMIC_DRAW);this._resetIndexBufferBinding()};
le$$module$libs$world_onscreen.prototype.updateDynamicVertexBuffer=function(a,b,c,d){this.bindArrayBuffer(a);void 0===c&&(c=0);a=b.byteLength||b.length;void 0===d||d>=a&&0===c?b instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,c,new Float32Array(b)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,c,b):b instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,(new Float32Array(b)).subarray(c,c+d)):(b instanceof ArrayBuffer?b=new Uint8Array(b,c,d):b=new Uint8Array(b.buffer,b.byteOffset+
c,d),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,b));this._resetVertexBufferBinding()};
class I$$module$libs$world_onscreen extends le$$module$libs$world_onscreen{constructor(a,b,c,d=!1){if(super(a,b,c,d),this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.scenes=[],this._virtualScenes=[],this.onNewSceneAddedObservable=new w$$module$libs$world_onscreen,this.postProcesses=[],this.isPointerLock=!1,this.onResizeObservable=new w$$module$libs$world_onscreen,this.onCanvasBlurObservable=new w$$module$libs$world_onscreen,this.onCanvasFocusObservable=new w$$module$libs$world_onscreen,
this.onCanvasPointerOutObservable=new w$$module$libs$world_onscreen,this.onBeginFrameObservable=new w$$module$libs$world_onscreen,this.customAnimationFrameRequester=null,this.onEndFrameObservable=new w$$module$libs$world_onscreen,this.onBeforeShaderCompilationObservable=new w$$module$libs$world_onscreen,this.onAfterShaderCompilationObservable=new w$$module$libs$world_onscreen,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this._fps=60,this._deltaTime=0,this._drawCalls=
new yt$$module$libs$world_onscreen,this.canvasTabIndex=1,this.disablePerformanceMonitorInBackground=!1,this._performanceMonitor=new gn$$module$libs$world_onscreen,this._compatibilityMode=!0,this.currentRenderPassId=0,this._renderPassNames=["main"],I$$module$libs$world_onscreen.Instances.push(this),a){if(this._features.supportRenderPasses=!0,c=this._creationOptions,a.getContext)this._sharedInit(a,!!c.doNotHandleTouchAction,c.audioEngine),Di$$module$libs$world_onscreen()&&(this._onFullscreenChange=
()=>{(this.isFullscreen=!!document.fullscreenElement)&&this._pointerLockRequested&&a&&I$$module$libs$world_onscreen._RequestPointerlock(a)},document.addEventListener("fullscreenchange",this._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,!1),this._onPointerLockChange=()=>{this.isPointerLock=document.pointerLockElement===a},document.addEventListener("pointerlockchange",this._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",
this._onPointerLockChange,!1),!I$$module$libs$world_onscreen.audioEngine&&c.audioEngine&&I$$module$libs$world_onscreen.AudioEngineFactory&&(I$$module$libs$world_onscreen.audioEngine=I$$module$libs$world_onscreen.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination()))),this._connectVREvents(),this.enableOfflineSupport=void 0!==I$$module$libs$world_onscreen.OfflineProviderFactory,this._deterministicLockstep=!!c.deterministicLockstep,this._lockstepMaxSteps=c.lockstepMaxSteps||
0,this._timeStep=c.timeStep||1/60;this._prepareVRComponent();c.autoEnableWebVR&&this.initWebVR()}}static get NpmPackage(){return le$$module$libs$world_onscreen.NpmPackage}static get Version(){return le$$module$libs$world_onscreen.Version}static get Instances(){return fe$$module$libs$world_onscreen.Instances}static get LastCreatedEngine(){return fe$$module$libs$world_onscreen.LastCreatedEngine}static get LastCreatedScene(){return fe$$module$libs$world_onscreen.LastCreatedScene}_createImageBitmapFromSource(a,
b){return new Promise((c,d)=>{const e=new Image;e.onload=()=>{e.decode().then(()=>{this.createImageBitmap(e,b).then(g=>{c(g)})})};e.onerror=()=>{d(`Error loading image ${e.src}`)};e.src=a})}createImageBitmap(a,b){return createImageBitmap(a,b)}resizeImageBitmap(a,b,c){const d=this.createCanvas(b,c).getContext("2d");if(!d)throw Error("Unable to get 2d context for resizeImageBitmap");return d.drawImage(a,0,0),d.getImageData(0,0,b,c).data}static MarkAllMaterialsAsDirty(a,b){for(let c=0;c<I$$module$libs$world_onscreen.Instances.length;c++){const d=
I$$module$libs$world_onscreen.Instances[c];for(let e=0;e<d.scenes.length;e++)d.scenes[e].markAllMaterialsAsDirty(a,b)}}static DefaultLoadingScreenFactory(a){throw $$$module$libs$world_onscreen("LoadingScreen");}get _supportsHardwareTextureRescaling(){return!!I$$module$libs$world_onscreen._RescalePostProcessFactory}get performanceMonitor(){return this._performanceMonitor}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(a){this._compatibilityMode=!0}getInputElement(){return this._renderingCanvas}_initGLContext(){super._initGLContext();
this._rescalePostProcess=null}_sharedInit(a,b,c){super._sharedInit(a,b,c);this._onCanvasFocus=()=>{this.onCanvasFocusObservable.notifyObservers(this)};this._onCanvasBlur=()=>{this.onCanvasBlurObservable.notifyObservers(this)};this._onCanvasContextMenu=e=>{this.disableContextMenu&&e.preventDefault()};a.addEventListener("focus",this._onCanvasFocus);a.addEventListener("blur",this._onCanvasBlur);a.addEventListener("contextmenu",this._onCanvasContextMenu);this._onBlur=()=>{this.disablePerformanceMonitorInBackground&&
this._performanceMonitor.disable();this._windowIsBackground=!0};this._onFocus=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.enable();this._windowIsBackground=!1};this._onCanvasPointerOut=e=>{document.elementFromPoint(e.clientX,e.clientY)!==a&&this.onCanvasPointerOutObservable.notifyObservers(e)};const d=this.getHostWindow();d&&"function"==typeof d.addEventListener&&(d.addEventListener("blur",this._onBlur),d.addEventListener("focus",this._onFocus));a.addEventListener("pointerout",
this._onCanvasPointerOut);b||this._disableTouchAction();!I$$module$libs$world_onscreen.audioEngine&&c&&I$$module$libs$world_onscreen.AudioEngineFactory&&(I$$module$libs$world_onscreen.audioEngine=I$$module$libs$world_onscreen.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination()))}getAspectRatio(a,b=!1){a=a.viewport;return this.getRenderWidth(b)*a.width/(this.getRenderHeight(b)*a.height)}getScreenAspectRatio(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)}getRenderingCanvasClientRect(){return this._renderingCanvas?
this._renderingCanvas.getBoundingClientRect():null}getInputElementClientRect(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1E3*this._timeStep}generateMipMapsForCubemap(a,b=!0){if(a.generateMipMaps){const c=this._gl;this._bindTextureDirectly(c.TEXTURE_CUBE_MAP,a,!0);c.generateMipmap(c.TEXTURE_CUBE_MAP);b&&this._bindTextureDirectly(c.TEXTURE_CUBE_MAP,
null)}}getDepthWrite(){return this._depthCullingState.depthMask}setDepthWrite(a){this._depthCullingState.depthMask=a}getStencilBuffer(){return this._stencilState.stencilTest}setStencilBuffer(a){this._stencilState.stencilTest=a}getStencilMask(){return this._stencilState.stencilMask}setStencilMask(a){this._stencilState.stencilMask=a}getStencilFunction(){return this._stencilState.stencilFunc}getStencilFunctionReference(){return this._stencilState.stencilFuncRef}getStencilFunctionMask(){return this._stencilState.stencilFuncMask}setStencilFunction(a){this._stencilState.stencilFunc=
a}setStencilFunctionReference(a){this._stencilState.stencilFuncRef=a}setStencilFunctionMask(a){this._stencilState.stencilFuncMask=a}getStencilOperationFail(){return this._stencilState.stencilOpStencilFail}getStencilOperationDepthFail(){return this._stencilState.stencilOpDepthFail}getStencilOperationPass(){return this._stencilState.stencilOpStencilDepthPass}setStencilOperationFail(a){this._stencilState.stencilOpStencilFail=a}setStencilOperationDepthFail(a){this._stencilState.stencilOpDepthFail=a}setStencilOperationPass(a){this._stencilState.stencilOpStencilDepthPass=
a}setDitheringState(a){a?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)}setRasterizerState(a){a?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)}getDepthFunction(){return this._depthCullingState.depthFunc}setDepthFunction(a){this._depthCullingState.depthFunc=a}setDepthFunctionToGreater(){this.setDepthFunction(516)}setDepthFunctionToGreaterOrEqual(){this.setDepthFunction(518)}setDepthFunctionToLess(){this.setDepthFunction(513)}setDepthFunctionToLessOrEqual(){this.setDepthFunction(515)}cacheStencilState(){this._cachedStencilBuffer=
this.getStencilBuffer();this._cachedStencilFunction=this.getStencilFunction();this._cachedStencilMask=this.getStencilMask();this._cachedStencilOperationPass=this.getStencilOperationPass();this._cachedStencilOperationFail=this.getStencilOperationFail();this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail();this._cachedStencilReference=this.getStencilFunctionReference()}restoreStencilState(){this.setStencilFunction(this._cachedStencilFunction);this.setStencilMask(this._cachedStencilMask);
this.setStencilBuffer(this._cachedStencilBuffer);this.setStencilOperationPass(this._cachedStencilOperationPass);this.setStencilOperationFail(this._cachedStencilOperationFail);this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail);this.setStencilFunctionReference(this._cachedStencilReference)}setDirectViewport(a,b,c,d){const e=this._cachedViewport;return this._cachedViewport=null,this._viewport(a,b,c,d),e}scissorClear(a,b,c,d,e){this.enableScissor(a,b,c,d);this.clear(e,!0,!0,!0);
this.disableScissor()}enableScissor(a,b,c,d){const e=this._gl;e.enable(e.SCISSOR_TEST);e.scissor(a,b,c,d)}disableScissor(){const a=this._gl;a.disable(a.SCISSOR_TEST)}_reportDrawCall(a=1){this._drawCalls.addCount(a,!1)}initWebVR(){throw $$$module$libs$world_onscreen("WebVRCamera");}_prepareVRComponent(){}_connectVREvents(a,b){}_submitVRFrame(){}disableVR(){}isVRPresenting(){return!1}_requestVRFrame(){}_loadFileAsync(a,b,c){return new Promise((d,e)=>{this._loadFile(a,g=>{d(g)},void 0,b,c,(g,n)=>{e(n)})})}getVertexShaderSource(a){return(a=
this._gl.getAttachedShaders(a))?this._gl.getShaderSource(a[0]):null}getFragmentShaderSource(a){return(a=this._gl.getAttachedShaders(a))?this._gl.getShaderSource(a[1]):null}setDepthStencilTexture(a,b,c,d){void 0!==a&&(b&&(this._boundUniforms[a]=b),c&&c.depthStencilTexture?this._setTexture(a,c,!1,!0,d):this._setTexture(a,null,void 0,void 0,d))}setTextureFromPostProcess(a,b,c){var d;let e=null;b&&(b._textures.data[b._currentRenderTextureInd]?e=b._textures.data[b._currentRenderTextureInd]:b._forcedOutputTexture&&
(e=b._forcedOutputTexture));this._bindTexture(a,null!==(d=null==e?void 0:e.texture)&&void 0!==d?d:null,c)}setTextureFromPostProcessOutput(a,b,c){var d,e;this._bindTexture(a,null!==(e=null===(d=null==b?void 0:b._outputTexture)||void 0===d?void 0:d.texture)&&void 0!==e?e:null,c)}_rebuildBuffers(){for(const a of this.scenes)a.resetCachedMaterial(),a._rebuildGeometries(),a._rebuildTextures();for(const a of this._virtualScenes)a.resetCachedMaterial(),a._rebuildGeometries(),a._rebuildTextures();super._rebuildBuffers()}_renderFrame(){for(let a=
0;a<this._activeRenderLoops.length;a++)(0,this._activeRenderLoops[a])()}_renderLoop(){if(!this._contextWasLost){let a=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(a=!1);a&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}0<this._activeRenderLoops.length?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),
this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1}_renderViews(){return!1}switchFullscreen(a){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(a)}enterFullscreen(a){this.isFullscreen||(this._pointerLockRequested=a,this._renderingCanvas&&I$$module$libs$world_onscreen._RequestFullscreen(this._renderingCanvas))}exitFullscreen(){this.isFullscreen&&
I$$module$libs$world_onscreen._ExitFullscreen()}enterPointerlock(){this._renderingCanvas&&I$$module$libs$world_onscreen._RequestPointerlock(this._renderingCanvas)}exitPointerlock(){I$$module$libs$world_onscreen._ExitPointerlock()}beginFrame(){this._measureFps();this.onBeginFrameObservable.notifyObservers(this);super.beginFrame()}endFrame(){super.endFrame();this._submitVRFrame();this.onEndFrameObservable.notifyObservers(this)}resize(a=!1){this.isVRPresenting()||super.resize(a)}setSize(a,b,c=!1){if(!this._renderingCanvas||
!super.setSize(a,b,c))return!1;if(this.scenes){for(a=0;a<this.scenes.length;a++)for(b=this.scenes[a],c=0;c<b.cameras.length;c++)b.cameras[c]._currentRenderId=0;this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}_deletePipelineContext(a){a&&a.program&&a.transformFeedback&&(this.deleteTransformFeedback(a.transformFeedback),a.transformFeedback=null);super._deletePipelineContext(a)}createShaderProgram(a,b,c,d,e,g=null){e=e||this._gl;this.onBeforeShaderCompilationObservable.notifyObservers(this);
a=super.createShaderProgram(a,b,c,d,e,g);return this.onAfterShaderCompilationObservable.notifyObservers(this),a}_createShaderProgram(a,b,c,d,e=null){const g=d.createProgram();if(a.program=g,!g)throw Error("Unable to create program");if(d.attachShader(g,b),d.attachShader(g,c),1<this.webGLVersion&&e){const n=this.createTransformFeedback();this.bindTransformFeedback(n);this.setTranformFeedbackVaryings(g,e);a.transformFeedback=n}return d.linkProgram(g),1<this.webGLVersion&&e&&this.bindTransformFeedback(null),
a.context=d,a.vertexShader=b,a.fragmentShader=c,a.isParallelCompiled||this._finalizePipelineContext(a),g}_releaseTexture(a){super._releaseTexture(a)}_releaseRenderTargetWrapper(a){super._releaseRenderTargetWrapper(a);this.scenes.forEach(b=>{b.postProcesses.forEach(c=>{c._outputTexture===a&&(c._outputTexture=null)});b.cameras.forEach(c=>{c._postProcesses.forEach(d=>{d&&d._outputTexture===a&&(d._outputTexture=null)})})})}getRenderPassNames(){return this._renderPassNames}getCurrentRenderPassName(){return this._renderPassNames[this.currentRenderPassId]}createRenderPassId(a){const b=
++I$$module$libs$world_onscreen._RenderPassIdCounter;return this._renderPassNames[b]=a??"NONAME",b}releaseRenderPassId(a){this._renderPassNames[a]=void 0;for(let b=0;b<this.scenes.length;++b){const c=this.scenes[b];for(let d=0;d<c.meshes.length;++d){const e=c.meshes[d];if(e.subMeshes)for(let g=0;g<e.subMeshes.length;++g)e.subMeshes[g]._removeDrawWrapper(a)}}}_rescaleTexture(a,b,c,d,e){this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR);this._gl.texParameteri(this._gl.TEXTURE_2D,
this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);const g=this.createRenderTargetTexture({width:b.width,height:b.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&I$$module$libs$world_onscreen._RescalePostProcessFactory&&(this._rescalePostProcess=
I$$module$libs$world_onscreen._RescalePostProcessFactory(this));this._rescalePostProcess&&(this._rescalePostProcess.externalTextureSamplerBinding=!0,this._rescalePostProcess.getEffect().executeWhenCompiled(()=>{this._rescalePostProcess.onApply=function(t){t._bindTexture("textureSampler",a)};let n=c;n||=this.scenes[this.scenes.length-1];n.postProcessManager.directRender([this._rescalePostProcess],g,!0);this._bindTextureDirectly(this._gl.TEXTURE_2D,b,!0);this._gl.copyTexImage2D(this._gl.TEXTURE_2D,
0,d,0,0,b.width,b.height,0);this.unBindFramebuffer(g);g.dispose();e&&e()}))}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame();this._fps=this._performanceMonitor.averageFPS;this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}wrapWebGLTexture(a){a=new Mr$$module$libs$world_onscreen(a,this._gl);const b=new Vt$$module$libs$world_onscreen(this,Oe$$module$libs$world_onscreen.Unknown,!0);return b._hardwareTexture=a,b.isReady=
!0,b}_uploadImageToTexture(a,b,c=0,d=0){const e=this._gl,g=this._getWebGLTextureType(a.type),n=this._getInternalFormat(a.format),t=this._getRGBABufferInternalSizedFormat(a.type,n),w=a.isCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D;this._bindTextureDirectly(w,a,!0);this._unpackFlipY(a.invertY);let z=e.TEXTURE_2D;a.isCube&&(z=e.TEXTURE_CUBE_MAP_POSITIVE_X+c);e.texImage2D(z,d,t,n,g,b);this._bindTextureDirectly(w,null,!0)}updateTextureComparisonFunction(a,b){if(1===this.webGLVersion)O$$module$libs$world_onscreen.Error("WebGL 1 does not support texture comparison.");
else{var c=this._gl;a.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,a,!0),0===b?(c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_COMPARE_FUNC,515),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_COMPARE_MODE,c.NONE)):(c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_COMPARE_FUNC,b),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_COMPARE_MODE,c.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,a,!0),0===b?(c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_COMPARE_FUNC,515),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_COMPARE_MODE,c.NONE)):(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_COMPARE_FUNC,b),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_COMPARE_MODE,c.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null));a._comparisonFunction=b}}createInstancesBuffer(a){var b=this._gl.createBuffer();if(!b)throw Error("Unable to create instance buffer");b=new Fi$$module$libs$world_onscreen(b);return b.capacity=a,this.bindArrayBuffer(b),this._gl.bufferData(this._gl.ARRAY_BUFFER,
a,this._gl.DYNAMIC_DRAW),b.references=1,b}deleteInstancesBuffer(a){this._gl.deleteBuffer(a)}_clientWaitAsync(a,b=0,c=10){const d=this._gl;return new Promise((e,g)=>{const n=()=>{const t=d.clientWaitSync(a,b,0);t==d.WAIT_FAILED?g():t==d.TIMEOUT_EXPIRED?setTimeout(n,c):e()};n()})}_readPixelsAsync(a,b,c,d,e,g,n){if(2>this._webGLVersion)throw Error("_readPixelsAsync only work on WebGL2+");const t=this._gl,w=t.createBuffer();t.bindBuffer(t.PIXEL_PACK_BUFFER,w);t.bufferData(t.PIXEL_PACK_BUFFER,n.byteLength,
t.STREAM_READ);t.readPixels(a,b,c,d,e,g,0);t.bindBuffer(t.PIXEL_PACK_BUFFER,null);const z=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0);return z?(t.flush(),this._clientWaitAsync(z,0,10).then(()=>(t.deleteSync(z),t.bindBuffer(t.PIXEL_PACK_BUFFER,w),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,n),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),t.deleteBuffer(w),n))):null}dispose(){this.hideLoadingUI();for(this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&
this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();1===I$$module$libs$world_onscreen.Instances.length&&I$$module$libs$world_onscreen.audioEngine&&(I$$module$libs$world_onscreen.audioEngine.dispose(),I$$module$libs$world_onscreen.audioEngine=null);this.disableVR();var a=this.getHostWindow();a&&"function"==typeof a.removeEventListener&&(a.removeEventListener("blur",this._onBlur),a.removeEventListener("focus",
this._onFocus));this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut),this._renderingCanvas.removeEventListener("contextmenu",this._onCanvasContextMenu));Di$$module$libs$world_onscreen()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",
this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange));super.dispose();
a=I$$module$libs$world_onscreen.Instances.indexOf(this);0<=a&&I$$module$libs$world_onscreen.Instances.splice(a,1);this.onResizeObservable.clear();this.onCanvasBlurObservable.clear();this.onCanvasFocusObservable.clear();this.onCanvasPointerOutObservable.clear();this.onBeginFrameObservable.clear();this.onEndFrameObservable.clear()}_disableTouchAction(){!this._renderingCanvas||!this._renderingCanvas.setAttribute||(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction=
"none",this._renderingCanvas.style.webkitTapHighlightColor="transparent")}displayLoadingUI(){if(Ze$$module$libs$world_onscreen()){var a=this.loadingScreen;a&&a.displayLoadingUI()}}hideLoadingUI(){if(Ze$$module$libs$world_onscreen()){var a=this._loadingScreen;a&&a.hideLoadingUI()}}get loadingScreen(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=I$$module$libs$world_onscreen.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen}set loadingScreen(a){this._loadingScreen=
a}set loadingUIText(a){this.loadingScreen.loadingUIText=a}set loadingUIBackgroundColor(a){this.loadingScreen.loadingUIBackgroundColor=a}createVideoElement(a){return document.createElement("video")}static _RequestPointerlock(a){a.requestPointerLock&&(a.requestPointerLock(),a.focus())}static _ExitPointerlock(){document.exitPointerLock&&document.exitPointerLock()}static _RequestFullscreen(a){const b=a.requestFullscreen||a.webkitRequestFullscreen;b&&b.call(a)}static _ExitFullscreen(){const a=document;
document.exitFullscreen?document.exitFullscreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen()}getFontOffset(a){const b=document.createElement("span");b.innerHTML="Hg";b.setAttribute("style",`font: ${a} !important`);a=document.createElement("div");a.style.display="inline-block";a.style.width="1px";a.style.height="0px";a.style.verticalAlign="bottom";const c=document.createElement("div");c.style.whiteSpace="nowrap";c.appendChild(b);c.appendChild(a);document.body.appendChild(c);let d=0,e=0;try{e=
a.getBoundingClientRect().top-b.getBoundingClientRect().top,a.style.verticalAlign="baseline",d=a.getBoundingClientRect().top-b.getBoundingClientRect().top}finally{document.body.removeChild(c)}return{ascent:d,height:e,descent:e-d}}}I$$module$libs$world_onscreen.ALPHA_DISABLE=0;I$$module$libs$world_onscreen.ALPHA_ADD=1;I$$module$libs$world_onscreen.ALPHA_COMBINE=2;I$$module$libs$world_onscreen.ALPHA_SUBTRACT=3;I$$module$libs$world_onscreen.ALPHA_MULTIPLY=4;
I$$module$libs$world_onscreen.ALPHA_MAXIMIZED=5;I$$module$libs$world_onscreen.ALPHA_ONEONE=6;I$$module$libs$world_onscreen.ALPHA_PREMULTIPLIED=7;I$$module$libs$world_onscreen.ALPHA_PREMULTIPLIED_PORTERDUFF=8;I$$module$libs$world_onscreen.ALPHA_INTERPOLATE=9;I$$module$libs$world_onscreen.ALPHA_SCREENMODE=10;I$$module$libs$world_onscreen.DELAYLOADSTATE_NONE=0;I$$module$libs$world_onscreen.DELAYLOADSTATE_LOADED=1;I$$module$libs$world_onscreen.DELAYLOADSTATE_LOADING=2;
I$$module$libs$world_onscreen.DELAYLOADSTATE_NOTLOADED=4;I$$module$libs$world_onscreen.NEVER=512;I$$module$libs$world_onscreen.ALWAYS=519;I$$module$libs$world_onscreen.LESS=513;I$$module$libs$world_onscreen.EQUAL=514;I$$module$libs$world_onscreen.LEQUAL=515;I$$module$libs$world_onscreen.GREATER=516;I$$module$libs$world_onscreen.GEQUAL=518;I$$module$libs$world_onscreen.NOTEQUAL=517;I$$module$libs$world_onscreen.KEEP=7680;I$$module$libs$world_onscreen.REPLACE=7681;
I$$module$libs$world_onscreen.INCR=7682;I$$module$libs$world_onscreen.DECR=7683;I$$module$libs$world_onscreen.INVERT=5386;I$$module$libs$world_onscreen.INCR_WRAP=34055;I$$module$libs$world_onscreen.DECR_WRAP=34056;I$$module$libs$world_onscreen.TEXTURE_CLAMP_ADDRESSMODE=0;I$$module$libs$world_onscreen.TEXTURE_WRAP_ADDRESSMODE=1;I$$module$libs$world_onscreen.TEXTURE_MIRROR_ADDRESSMODE=2;I$$module$libs$world_onscreen.TEXTUREFORMAT_ALPHA=0;I$$module$libs$world_onscreen.TEXTUREFORMAT_LUMINANCE=1;
I$$module$libs$world_onscreen.TEXTUREFORMAT_LUMINANCE_ALPHA=2;I$$module$libs$world_onscreen.TEXTUREFORMAT_RGB=4;I$$module$libs$world_onscreen.TEXTUREFORMAT_RGBA=5;I$$module$libs$world_onscreen.TEXTUREFORMAT_RED=6;I$$module$libs$world_onscreen.TEXTUREFORMAT_R=6;I$$module$libs$world_onscreen.TEXTUREFORMAT_RG=7;I$$module$libs$world_onscreen.TEXTUREFORMAT_RED_INTEGER=8;I$$module$libs$world_onscreen.TEXTUREFORMAT_R_INTEGER=8;I$$module$libs$world_onscreen.TEXTUREFORMAT_RG_INTEGER=9;
I$$module$libs$world_onscreen.TEXTUREFORMAT_RGB_INTEGER=10;I$$module$libs$world_onscreen.TEXTUREFORMAT_RGBA_INTEGER=11;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_BYTE=0;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_INT=0;I$$module$libs$world_onscreen.TEXTURETYPE_FLOAT=1;I$$module$libs$world_onscreen.TEXTURETYPE_HALF_FLOAT=2;I$$module$libs$world_onscreen.TEXTURETYPE_BYTE=3;I$$module$libs$world_onscreen.TEXTURETYPE_SHORT=4;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_SHORT=5;
I$$module$libs$world_onscreen.TEXTURETYPE_INT=6;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_INTEGER=7;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_INT_24_8=12;
I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13;I$$module$libs$world_onscreen.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14;I$$module$libs$world_onscreen.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15;I$$module$libs$world_onscreen.TEXTURE_NEAREST_SAMPLINGMODE=1;I$$module$libs$world_onscreen.TEXTURE_BILINEAR_SAMPLINGMODE=2;I$$module$libs$world_onscreen.TEXTURE_TRILINEAR_SAMPLINGMODE=3;I$$module$libs$world_onscreen.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8;
I$$module$libs$world_onscreen.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11;I$$module$libs$world_onscreen.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3;I$$module$libs$world_onscreen.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4;I$$module$libs$world_onscreen.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5;I$$module$libs$world_onscreen.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6;I$$module$libs$world_onscreen.TEXTURE_NEAREST_LINEAR=7;I$$module$libs$world_onscreen.TEXTURE_NEAREST_NEAREST=1;
I$$module$libs$world_onscreen.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9;I$$module$libs$world_onscreen.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10;I$$module$libs$world_onscreen.TEXTURE_LINEAR_LINEAR=2;I$$module$libs$world_onscreen.TEXTURE_LINEAR_NEAREST=12;I$$module$libs$world_onscreen.TEXTURE_EXPLICIT_MODE=0;I$$module$libs$world_onscreen.TEXTURE_SPHERICAL_MODE=1;I$$module$libs$world_onscreen.TEXTURE_PLANAR_MODE=2;I$$module$libs$world_onscreen.TEXTURE_CUBIC_MODE=3;
I$$module$libs$world_onscreen.TEXTURE_PROJECTION_MODE=4;I$$module$libs$world_onscreen.TEXTURE_SKYBOX_MODE=5;I$$module$libs$world_onscreen.TEXTURE_INVCUBIC_MODE=6;I$$module$libs$world_onscreen.TEXTURE_EQUIRECTANGULAR_MODE=7;I$$module$libs$world_onscreen.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8;I$$module$libs$world_onscreen.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;I$$module$libs$world_onscreen.SCALEMODE_FLOOR=1;I$$module$libs$world_onscreen.SCALEMODE_NEAREST=2;
I$$module$libs$world_onscreen.SCALEMODE_CEILING=3;I$$module$libs$world_onscreen._RescalePostProcessFactory=null;I$$module$libs$world_onscreen._RenderPassIdCounter=0;le$$module$libs$world_onscreen.prototype._debugPushGroup=function(a,b){};le$$module$libs$world_onscreen.prototype._debugPopGroup=function(a){};le$$module$libs$world_onscreen.prototype._debugInsertMarker=function(a,b){};le$$module$libs$world_onscreen.prototype._debugFlushPendingCommands=function(){};
function En$$module$libs$world_onscreen(a){return new I$$module$libs$world_onscreen(a,!0,{preserveDrawingBuffer:!0,stencil:!0})}
class se$$module$libs$world_onscreen{constructor(a=0,b=0,c=0){this.r=a;this.g=b;this.b=c}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let a=255*this.r|0;return a=397*a^(255*this.g|0),a=397*a^(255*this.b|0),a}toArray(a,b=0){return a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,this}fromArray(a,b=0){return se$$module$libs$world_onscreen.FromArrayToRef(a,b,this),this}toColor4(a=1){return new me$$module$libs$world_onscreen(this.r,this.g,this.b,a)}asArray(){return[this.r,
this.g,this.b]}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(a){return new se$$module$libs$world_onscreen(this.r*a.r,this.g*a.g,this.b*a.b)}multiplyToRef(a,b){return b.r=this.r*a.r,b.g=this.g*a.g,b.b=this.b*a.b,this}equals(a){return a&&this.r===a.r&&this.g===a.g&&this.b===a.b}equalsFloats(a,b,c){return this.r===a&&this.g===b&&this.b===c}scale(a){return new se$$module$libs$world_onscreen(this.r*a,this.g*a,this.b*a)}scaleInPlace(a){return this.r*=a,this.g*=a,this.b*=a,this}scaleToRef(a,
b){return b.r=this.r*a,b.g=this.g*a,b.b=this.b*a,this}scaleAndAddToRef(a,b){return b.r+=this.r*a,b.g+=this.g*a,b.b+=this.b*a,this}clampToRef(a=0,b=1,c){return c.r=ne$$module$libs$world_onscreen.Clamp(this.r,a,b),c.g=ne$$module$libs$world_onscreen.Clamp(this.g,a,b),c.b=ne$$module$libs$world_onscreen.Clamp(this.b,a,b),this}add(a){return new se$$module$libs$world_onscreen(this.r+a.r,this.g+a.g,this.b+a.b)}addToRef(a,b){return b.r=this.r+a.r,b.g=this.g+a.g,b.b=this.b+a.b,this}subtract(a){return new se$$module$libs$world_onscreen(this.r-
a.r,this.g-a.g,this.b-a.b)}subtractToRef(a,b){return b.r=this.r-a.r,b.g=this.g-a.g,b.b=this.b-a.b,this}clone(){return new se$$module$libs$world_onscreen(this.r,this.g,this.b)}copyFrom(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copyFromFloats(a,b,c){return this.r=a,this.g=b,this.b=c,this}set(a,b,c){return this.copyFromFloats(a,b,c)}toHexString(){const a=Math.round(255*this.g),b=Math.round(255*this.b);return"#"+ne$$module$libs$world_onscreen.ToHex(Math.round(255*this.r))+ne$$module$libs$world_onscreen.ToHex(a)+
ne$$module$libs$world_onscreen.ToHex(b)}toLinearSpace(){const a=new se$$module$libs$world_onscreen;return this.toLinearSpaceToRef(a),a}toHSV(){const a=new se$$module$libs$world_onscreen;return this.toHSVToRef(a),a}toHSVToRef(a){const b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),g=Math.min(b,c,d);let n=0,t=0;const w=e-g;0!==e&&(t=w/e);e!=g&&(e==b?(n=(c-d)/w,c<d&&(n+=6)):e==c?n=(d-b)/w+2:e==d&&(n=(b-c)/w+4),n*=60);a.r=n;a.g=t;a.b=e}toLinearSpaceToRef(a){return a.r=Math.pow(this.r,bi$$module$libs$world_onscreen),
a.g=Math.pow(this.g,bi$$module$libs$world_onscreen),a.b=Math.pow(this.b,bi$$module$libs$world_onscreen),this}toGammaSpace(){const a=new se$$module$libs$world_onscreen;return this.toGammaSpaceToRef(a),a}toGammaSpaceToRef(a){return a.r=Math.pow(this.r,Ti$$module$libs$world_onscreen),a.g=Math.pow(this.g,Ti$$module$libs$world_onscreen),a.b=Math.pow(this.b,Ti$$module$libs$world_onscreen),this}static HSVtoRGBToRef(a,b,c,d){b*=c;const e=a/60,g=b*(1-Math.abs(e%2-1));let n=a=0,t=0;0<=e&&1>=e?(a=b,n=g):1<=
e&&2>=e?(a=g,n=b):2<=e&&3>=e?(n=b,t=g):3<=e&&4>=e?(n=g,t=b):4<=e&&5>=e?(a=g,t=b):5<=e&&6>=e&&(a=b,t=g);c-=b;d.set(a+c,n+c,t+c)}static FromHSV(a,b,c){const d=new se$$module$libs$world_onscreen(0,0,0);return se$$module$libs$world_onscreen.HSVtoRGBToRef(a,b,c,d),d}static FromHexString(a){if("#"!==a.substring(0,1)||7!==a.length)return new se$$module$libs$world_onscreen(0,0,0);const b=parseInt(a.substring(1,3),16),c=parseInt(a.substring(3,5),16);a=parseInt(a.substring(5,7),16);return se$$module$libs$world_onscreen.FromInts(b,
c,a)}static FromArray(a,b=0){return new se$$module$libs$world_onscreen(a[b],a[b+1],a[b+2])}static FromArrayToRef(a,b=0,c){c.r=a[b];c.g=a[b+1];c.b=a[b+2]}static FromInts(a,b,c){return new se$$module$libs$world_onscreen(a/255,b/255,c/255)}static Lerp(a,b,c){const d=new se$$module$libs$world_onscreen(0,0,0);return se$$module$libs$world_onscreen.LerpToRef(a,b,c,d),d}static LerpToRef(a,b,c,d){d.r=a.r+(b.r-a.r)*c;d.g=a.g+(b.g-a.g)*c;d.b=a.b+(b.b-a.b)*c}static Hermite(a,b,c,d,e){var g=e*e;const n=e*g,t=
2*n-3*g+1,w=-2*n+3*g;e=n-2*g+e;g=n-g;return new se$$module$libs$world_onscreen(a.r*t+c.r*w+b.r*e+d.r*g,a.g*t+c.g*w+b.g*e+d.g*g,a.b*t+c.b*w+b.b*e+d.b*g)}static Hermite1stDerivative(a,b,c,d,e){const g=se$$module$libs$world_onscreen.Black();return this.Hermite1stDerivativeToRef(a,b,c,d,e,g),g}static Hermite1stDerivativeToRef(a,b,c,d,e,g){const n=e*e;g.r=6*(n-e)*a.r+(3*n-4*e+1)*b.r+6*(-n+e)*c.r+(3*n-2*e)*d.r;g.g=6*(n-e)*a.g+(3*n-4*e+1)*b.g+6*(-n+e)*c.g+(3*n-2*e)*d.g;g.b=6*(n-e)*a.b+(3*n-4*e+1)*b.b+6*
(-n+e)*c.b+(3*n-2*e)*d.b}static Red(){return new se$$module$libs$world_onscreen(1,0,0)}static Green(){return new se$$module$libs$world_onscreen(0,1,0)}static Blue(){return new se$$module$libs$world_onscreen(0,0,1)}static Black(){return new se$$module$libs$world_onscreen(0,0,0)}static get BlackReadOnly(){return se$$module$libs$world_onscreen._BlackReadOnly}static White(){return new se$$module$libs$world_onscreen(1,1,1)}static Purple(){return new se$$module$libs$world_onscreen(.5,0,.5)}static Magenta(){return new se$$module$libs$world_onscreen(1,
0,1)}static Yellow(){return new se$$module$libs$world_onscreen(1,1,0)}static Gray(){return new se$$module$libs$world_onscreen(.5,.5,.5)}static Teal(){return new se$$module$libs$world_onscreen(0,1,1)}static Random(){return new se$$module$libs$world_onscreen(Math.random(),Math.random(),Math.random())}}se$$module$libs$world_onscreen._BlackReadOnly=se$$module$libs$world_onscreen.Black();
let me$$module$libs$world_onscreen=class{constructor(a=0,b=0,c=0,d=1){this.r=a;this.g=b;this.b=c;this.a=d}addInPlace(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this.a+=a.a,this}asArray(){return[this.r,this.g,this.b,this.a]}toArray(a,b=0){return a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a[b+3]=this.a,this}fromArray(a,b=0){return me$$module$libs$world_onscreen.FromArrayToRef(a,b,this),this}equals(a){return a&&this.r===a.r&&this.g===a.g&&this.b===a.b&&this.a===a.a}add(a){return new me$$module$libs$world_onscreen(this.r+
a.r,this.g+a.g,this.b+a.b,this.a+a.a)}subtract(a){return new me$$module$libs$world_onscreen(this.r-a.r,this.g-a.g,this.b-a.b,this.a-a.a)}subtractToRef(a,b){return b.r=this.r-a.r,b.g=this.g-a.g,b.b=this.b-a.b,b.a=this.a-a.a,this}scale(a){return new me$$module$libs$world_onscreen(this.r*a,this.g*a,this.b*a,this.a*a)}scaleInPlace(a){return this.r*=a,this.g*=a,this.b*=a,this.a*=a,this}scaleToRef(a,b){return b.r=this.r*a,b.g=this.g*a,b.b=this.b*a,b.a=this.a*a,this}scaleAndAddToRef(a,b){return b.r+=this.r*
a,b.g+=this.g*a,b.b+=this.b*a,b.a+=this.a*a,this}clampToRef(a=0,b=1,c){return c.r=ne$$module$libs$world_onscreen.Clamp(this.r,a,b),c.g=ne$$module$libs$world_onscreen.Clamp(this.g,a,b),c.b=ne$$module$libs$world_onscreen.Clamp(this.b,a,b),c.a=ne$$module$libs$world_onscreen.Clamp(this.a,a,b),this}multiply(a){return new me$$module$libs$world_onscreen(this.r*a.r,this.g*a.g,this.b*a.b,this.a*a.a)}multiplyToRef(a,b){return b.r=this.r*a.r,b.g=this.g*a.g,b.b=this.b*a.b,b.a=this.a*a.a,b}toString(){return"{R: "+
this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let a=255*this.r|0;return a=397*a^(255*this.g|0),a=397*a^(255*this.b|0),a=397*a^(255*this.a|0),a}clone(){return new me$$module$libs$world_onscreen(this.r,this.g,this.b,this.a)}copyFrom(a){return this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a,this}copyFromFloats(a,b,c,d){return this.r=a,this.g=b,this.b=c,this.a=d,this}set(a,b,c,d){return this.copyFromFloats(a,b,c,d)}toHexString(a=!1){const b=Math.round(255*this.r),
c=Math.round(255*this.g),d=Math.round(255*this.b);if(a)return"#"+ne$$module$libs$world_onscreen.ToHex(b)+ne$$module$libs$world_onscreen.ToHex(c)+ne$$module$libs$world_onscreen.ToHex(d);a=Math.round(255*this.a);return"#"+ne$$module$libs$world_onscreen.ToHex(b)+ne$$module$libs$world_onscreen.ToHex(c)+ne$$module$libs$world_onscreen.ToHex(d)+ne$$module$libs$world_onscreen.ToHex(a)}toLinearSpace(){const a=new me$$module$libs$world_onscreen;return this.toLinearSpaceToRef(a),a}toLinearSpaceToRef(a){return a.r=
Math.pow(this.r,bi$$module$libs$world_onscreen),a.g=Math.pow(this.g,bi$$module$libs$world_onscreen),a.b=Math.pow(this.b,bi$$module$libs$world_onscreen),a.a=this.a,this}toGammaSpace(){const a=new me$$module$libs$world_onscreen;return this.toGammaSpaceToRef(a),a}toGammaSpaceToRef(a){return a.r=Math.pow(this.r,Ti$$module$libs$world_onscreen),a.g=Math.pow(this.g,Ti$$module$libs$world_onscreen),a.b=Math.pow(this.b,Ti$$module$libs$world_onscreen),a.a=this.a,this}static FromHexString(a){if("#"!==a.substring(0,
1)||9!==a.length&&7!==a.length)return new me$$module$libs$world_onscreen(0,0,0,0);const b=parseInt(a.substring(1,3),16),c=parseInt(a.substring(3,5),16),d=parseInt(a.substring(5,7),16);a=9===a.length?parseInt(a.substring(7,9),16):255;return me$$module$libs$world_onscreen.FromInts(b,c,d,a)}static Lerp(a,b,c){const d=new me$$module$libs$world_onscreen(0,0,0,0);return me$$module$libs$world_onscreen.LerpToRef(a,b,c,d),d}static LerpToRef(a,b,c,d){d.r=a.r+(b.r-a.r)*c;d.g=a.g+(b.g-a.g)*c;d.b=a.b+(b.b-a.b)*
c;d.a=a.a+(b.a-a.a)*c}static Hermite(a,b,c,d,e){var g=e*e;const n=e*g,t=2*n-3*g+1,w=-2*n+3*g;e=n-2*g+e;g=n-g;return new me$$module$libs$world_onscreen(a.r*t+c.r*w+b.r*e+d.r*g,a.g*t+c.g*w+b.g*e+d.g*g,a.b*t+c.b*w+b.b*e+d.b*g,a.a*t+c.a*w+b.a*e+d.a*g)}static Hermite1stDerivative(a,b,c,d,e){const g=new me$$module$libs$world_onscreen;return this.Hermite1stDerivativeToRef(a,b,c,d,e,g),g}static Hermite1stDerivativeToRef(a,b,c,d,e,g){const n=e*e;g.r=6*(n-e)*a.r+(3*n-4*e+1)*b.r+6*(-n+e)*c.r+(3*n-2*e)*d.r;g.g=
6*(n-e)*a.g+(3*n-4*e+1)*b.g+6*(-n+e)*c.g+(3*n-2*e)*d.g;g.b=6*(n-e)*a.b+(3*n-4*e+1)*b.b+6*(-n+e)*c.b+(3*n-2*e)*d.b;g.a=6*(n-e)*a.a+(3*n-4*e+1)*b.a+6*(-n+e)*c.a+(3*n-2*e)*d.a}static FromColor3(a,b=1){return new me$$module$libs$world_onscreen(a.r,a.g,a.b,b)}static FromArray(a,b=0){return new me$$module$libs$world_onscreen(a[b],a[b+1],a[b+2],a[b+3])}static FromArrayToRef(a,b=0,c){c.r=a[b];c.g=a[b+1];c.b=a[b+2];c.a=a[b+3]}static FromInts(a,b,c,d){return new me$$module$libs$world_onscreen(a/255,b/255,c/
255,d/255)}static CheckColors4(a,b){if(a.length===3*b){b=[];for(let c=0;c<a.length;c+=3){const d=c/3*4;b[d]=a[c];b[d+1]=a[c+1];b[d+2]=a[c+2];b[d+3]=1}return b}return a}};class vi$$module$libs$world_onscreen{}vi$$module$libs$world_onscreen.Color3=Ye$$module$libs$world_onscreen.BuildArray(3,se$$module$libs$world_onscreen.Black);vi$$module$libs$world_onscreen.Color4=Ye$$module$libs$world_onscreen.BuildArray(3,()=>new me$$module$libs$world_onscreen(0,0,0,0));
st$$module$libs$world_onscreen("BABYLON.Color3",se$$module$libs$world_onscreen);st$$module$libs$world_onscreen("BABYLON.Color4",me$$module$libs$world_onscreen);const Qs$$module$libs$world_onscreen=(a,b)=>!a||a.getClassName&&"Mesh"===a.getClassName()?null:a.getClassName&&"SubMesh"===a.getClassName()?a.clone(b):a.clone?a.clone():null;
function vn$$module$libs$world_onscreen(a){const b=[];do Object.getOwnPropertyNames(a).forEach(function(c){-1===b.indexOf(c)&&b.push(c)});while(a=Object.getPrototypeOf(a));return b}
class Us$$module$libs$world_onscreen{static DeepCopy(a,b,c,d){var e=vn$$module$libs$world_onscreen(a);for(const n of e)if(!("_"===n[0]&&(!d||-1===d.indexOf(n))||n.endsWith("Observable")||c&&-1!==c.indexOf(n))){e=a[n];var g=typeof e;if("function"!==g)try{if("object"===g)if(e instanceof Array){if(b[n]=[],0<e.length)if("object"==typeof e[0])for(g=0;g<e.length;g++){const t=Qs$$module$libs$world_onscreen(e[g],b);-1===b[n].indexOf(t)&&b[n].push(t)}else b[n]=e.slice(0)}else b[n]=Qs$$module$libs$world_onscreen(e,
b);else b[n]=e}catch(t){O$$module$libs$world_onscreen.Warn(t.message)}}}}function Tn$$module$libs$world_onscreen(){return"u">typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}
class dt$$module$libs$world_onscreen{constructor(){this._xhr=Tn$$module$libs$world_onscreen();this._requestURL=""}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const a in dt$$module$libs$world_onscreen.CustomRequestHeaders){const b=dt$$module$libs$world_onscreen.CustomRequestHeaders[a];b&&this._xhr.setRequestHeader(a,b)}}_shouldSkipRequestModifications(a){return dt$$module$libs$world_onscreen.SkipRequestModificationForBabylonCDN&&(a.includes("preview.babylonjs.com")||
a.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(a){this._xhr.onprogress=a}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(a){this._xhr.responseType=a}get timeout(){return this._xhr.timeout}set timeout(a){this._xhr.timeout=
a}addEventListener(a,b,c){this._xhr.addEventListener(a,b,c)}removeEventListener(a,b,c){this._xhr.removeEventListener(a,b,c)}abort(){this._xhr.abort()}send(a){dt$$module$libs$world_onscreen.CustomRequestHeaders&&this._injectCustomRequestHeaders();this._xhr.send(a)}open(a,b){for(const c of dt$$module$libs$world_onscreen.CustomRequestModifiers){if(this._shouldSkipRequestModifications(b))return;c(this._xhr,b)}return b=b.replace("file:http:","http:"),b=b.replace("file:https:","https:"),this._requestURL=
b,this._xhr.open(a,b,!0)}setRequestHeader(a,b){this._xhr.setRequestHeader(a,b)}getResponseHeader(a){return this._xhr.getResponseHeader(a)}}dt$$module$libs$world_onscreen.CustomRequestHeaders={};dt$$module$libs$world_onscreen.CustomRequestModifiers=[];dt$$module$libs$world_onscreen.SkipRequestModificationForBabylonCDN=!0;class Ii$$module$libs$world_onscreen{}Ii$$module$libs$world_onscreen.FilesToLoad={};
class bn$$module$libs$world_onscreen{static ExponentialBackoff(a=3,b=500){return(c,d,e)=>0!==d.status||e>=a||-1!==c.indexOf("file:")?-1:Math.pow(2,e)*b}}class Mi$$module$libs$world_onscreen extends Error{}Mi$$module$libs$world_onscreen._setPrototypeOf=Object.setPrototypeOf||((a,b)=>(a.__proto__=b,a));const oi$$module$libs$world_onscreen={MeshInvalidPositionsError:0,UnsupportedTextureError:1E3,GLTFLoaderUnexpectedMagicError:2E3,SceneLoaderError:3E3,LoadFileError:4E3,RequestFileError:4001,ReadFileError:4002};
class Wt$$module$libs$world_onscreen extends Mi$$module$libs$world_onscreen{constructor(a,b,c){super(a);this.errorCode=b;this.innerError=c;this.name="RuntimeError";Mi$$module$libs$world_onscreen._setPrototypeOf(this,Wt$$module$libs$world_onscreen.prototype)}}
const Ar$$module$libs$world_onscreen=a=>{let b="";let c,d,e,g,n=0;const t=ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a);for(;n<t.length;){var w=t[n++];a=n<t.length?t[n++]:Number.NaN;c=n<t.length?t[n++]:Number.NaN;d=w>>2;w=(w&3)<<4|a>>4;e=(a&15)<<2|c>>6;g=c&63;isNaN(a)?e=g=64:isNaN(c)&&(g=64);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(w)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)}return b},Rr$$module$libs$world_onscreen=a=>atob(a),Sn$$module$libs$world_onscreen=a=>{a=Rr$$module$libs$world_onscreen(a);const b=a.length,c=new Uint8Array(new ArrayBuffer(b));for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c.buffer};class ji$$module$libs$world_onscreen{static SetImmediate(a){Ze$$module$libs$world_onscreen()&&window.setImmediate?window.setImmediate(a):setTimeout(a,1)}}
const yr$$module$libs$world_onscreen=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class $i$$module$libs$world_onscreen extends Wt$$module$libs$world_onscreen{constructor(a,b){super(a,oi$$module$libs$world_onscreen.LoadFileError);this.name="LoadFileError";Mi$$module$libs$world_onscreen._setPrototypeOf(this,$i$$module$libs$world_onscreen.prototype);b instanceof dt$$module$libs$world_onscreen?this.request=b:this.file=b}}
class Qi$$module$libs$world_onscreen extends Wt$$module$libs$world_onscreen{constructor(a,b){super(a,oi$$module$libs$world_onscreen.RequestFileError);this.request=b;this.name="RequestFileError";Mi$$module$libs$world_onscreen._setPrototypeOf(this,Qi$$module$libs$world_onscreen.prototype)}}
class ks$$module$libs$world_onscreen extends Wt$$module$libs$world_onscreen{constructor(a,b){super(a,oi$$module$libs$world_onscreen.ReadFileError);this.file=b;this.name="ReadFileError";Mi$$module$libs$world_onscreen._setPrototypeOf(this,ks$$module$libs$world_onscreen.prototype)}}
const He$$module$libs$world_onscreen={DefaultRetryStrategy:bn$$module$libs$world_onscreen.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:a=>a},Cr$$module$libs$world_onscreen=a=>(a=a.replace(/#/gm,"%23"),a),Vs$$module$libs$world_onscreen=(a,b)=>{a&&0===a.indexOf("data:")||!He$$module$libs$world_onscreen.CorsBehavior||("string"==typeof He$$module$libs$world_onscreen.CorsBehavior||He$$module$libs$world_onscreen.CorsBehavior instanceof String?b.crossOrigin=He$$module$libs$world_onscreen.CorsBehavior:
(a=He$$module$libs$world_onscreen.CorsBehavior(a))&&(b.crossOrigin=a))},Ws$$module$libs$world_onscreen=(a,b,c,d,e="",g)=>{var n;let t,w=!1;a instanceof ArrayBuffer||ArrayBuffer.isView(a)?"u">typeof Blob&&"u">typeof URL?(t=URL.createObjectURL(new Blob([a],{type:e})),w=!0):t=`data:${e};base64,`+Ar$$module$libs$world_onscreen(a):a instanceof Blob?(t=URL.createObjectURL(a),w=!0):(t=Cr$$module$libs$world_onscreen(a),t=He$$module$libs$world_onscreen.PreprocessUrl(a));const z=fe$$module$libs$world_onscreen.LastCreatedEngine,
C=P=>{if(c){const W=t||a.toString();c(`Error while trying to load image: ${0===W.indexOf("http")||128>=W.length?W:W.slice(0,128)+"..."}`,P)}};if("u"<typeof Image||null!==(n=null==z?void 0:z._features.forceBitmapOverHTMLImageElement)&&void 0!==n&&n)return $t$$module$libs$world_onscreen(t,P=>{z.createImageBitmap(new Blob([P],{type:e}),{premultiplyAlpha:"none",...g}).then(W=>{b(W);w&&URL.revokeObjectURL(t)}).catch(W=>{c&&c("Error while trying to load image: "+a,W)})},void 0,d||void 0,!0,(P,W)=>{C(W)}),
null;const H=new Image;Vs$$module$libs$world_onscreen(t,H);const M=[],L=()=>{M.forEach(P=>{P.target.removeEventListener(P.name,P.handler)});M.length=0};M.push({target:H,name:"load",handler:()=>{L();b(H);w&&H.src&&URL.revokeObjectURL(H.src)}});M.push({target:H,name:"error",handler:P=>{L();C(P);w&&H.src&&URL.revokeObjectURL(H.src)}});M.push({target:document,name:"securitypolicyviolation",handler:P=>{L();P=Error(`CSP violation of policy ${P.effectiveDirective} ${P.blockedURI}. Current policy is ${P.originalPolicy}`);
fe$$module$libs$world_onscreen.UseFallbackTexture=!1;C(P);w&&H.src&&URL.revokeObjectURL(H.src);H.src=""}});(()=>{M.forEach(P=>{P.target.addEventListener(P.name,P.handler)})})();const O="blob:"===t.substring(0,5),S="data:"===t.substring(0,5);n=()=>{O||S?H.src=t:$t$$module$libs$world_onscreen(t,(P,W,Z)=>{P=new Blob([P],{type:!e&&Z?Z:e});P=URL.createObjectURL(P);w=!0;H.src=P},void 0,d||void 0,!0,(P,W)=>{C(W)})};var T=()=>{d&&d.loadImage(t,H)};if(!O&&!S&&d&&d.enableTexturesOffline)d.open(T,n);else{if(-1!==
t.indexOf("file:")&&(T=decodeURIComponent(t.substring(5).toLowerCase()),Ii$$module$libs$world_onscreen.FilesToLoad[T]&&"u">typeof URL)){try{let P;try{P=URL.createObjectURL(Ii$$module$libs$world_onscreen.FilesToLoad[T])}catch{P=URL.createObjectURL(Ii$$module$libs$world_onscreen.FilesToLoad[T])}H.src=P;w=!0}catch{H.src=""}return H}n()}return H},wi$$module$libs$world_onscreen=(a,b,c,d,e)=>{const g=new FileReader,n={onCompleteObservable:new w$$module$libs$world_onscreen,abort:()=>g.abort()};return g.onloadend=
()=>n.onCompleteObservable.notifyObservers(n),e&&(g.onerror=()=>{e(new ks$$module$libs$world_onscreen(`Unable to read ${a.name}`,a))}),g.onload=t=>{b(t.target.result)},c&&(g.onprogress=c),d?g.readAsArrayBuffer(a):g.readAsText(a),n},$t$$module$libs$world_onscreen=(a,b,c,d,e,g,n)=>{if(a.name)return wi$$module$libs$world_onscreen(a,b,c,e,g?C=>{g(void 0,C)}:void 0);if(-1!==a.indexOf("file:")){var t=decodeURIComponent(a.substring(5).toLowerCase());0===t.indexOf("./")&&(t=t.substring(2));if(t=Ii$$module$libs$world_onscreen.FilesToLoad[t])return wi$$module$libs$world_onscreen(t,
b,c,e,g?C=>g(void 0,new $i$$module$libs$world_onscreen(C.message,C.file)):void 0)}const {match:w,type:z}=xn$$module$libs$world_onscreen(a);if(w){const C={onCompleteObservable:new w$$module$libs$world_onscreen,abort:()=>()=>{}};try{const H=e?Xs$$module$libs$world_onscreen(a):Pr$$module$libs$world_onscreen(a);b(H,void 0,z)}catch(H){g?g(void 0,H):O$$module$libs$world_onscreen.Error(H.message||"Failed to parse the Data URL")}return ji$$module$libs$world_onscreen.SetImmediate(()=>{C.onCompleteObservable.notifyObservers(C)}),
C}return zs$$module$libs$world_onscreen(a,(C,H)=>{b(C,null==H?void 0:H.responseURL,null==H?void 0:H.getResponseHeader("content-type"))},c,d,e,g?C=>{g(C.request,new $i$$module$libs$world_onscreen(C.message,C.request))}:void 0,n)},zs$$module$libs$world_onscreen=(a,b,c,d,e,g,n)=>{a=Cr$$module$libs$world_onscreen(a);a=He$$module$libs$world_onscreen.PreprocessUrl(a);const t=He$$module$libs$world_onscreen.BaseUrl+a;let w=!1;const z={onCompleteObservable:new w$$module$libs$world_onscreen,abort:()=>w=!0},
C=()=>{let H=new dt$$module$libs$world_onscreen,M=null,L;const O=()=>{H&&(c&&H.removeEventListener("progress",c),L&&H.removeEventListener("readystatechange",L),H.removeEventListener("loadend",S))};let S=()=>{O();z.onCompleteObservable.notifyObservers(z);z.onCompleteObservable.clear();c=void 0;S=L=null;b=n=g=void 0};z.abort=()=>{w=!0;S&&S();H&&H.readyState!==(XMLHttpRequest.DONE||4)&&H.abort();null!==M&&(clearTimeout(M),M=null);H=null};const T=W=>{W=W.message||"Unknown error";g&&H?g(new Qi$$module$libs$world_onscreen(W,
H)):O$$module$libs$world_onscreen.Error(W)},P=W=>{if(H){if(H.open("GET",t),n)try{n(H)}catch(Z){T(Z);return}e&&(H.responseType="arraybuffer");c&&H.addEventListener("progress",c);S&&H.addEventListener("loadend",S);L=()=>{if(!w&&H&&H.readyState===(XMLHttpRequest.DONE||4))if(L&&H.removeEventListener("readystatechange",L),200<=H.status&&300>H.status||0===H.status&&(!Ze$$module$libs$world_onscreen()||Ir$$module$libs$world_onscreen()))try{b&&b(e?H.response:H.responseText,H)}catch(ca){T(ca)}else{var Z=He$$module$libs$world_onscreen.DefaultRetryStrategy;
if(Z&&(Z=Z(t,H,W),-1!==Z)){O();H=new dt$$module$libs$world_onscreen;M=setTimeout(()=>P(W+1),Z);return}Z=new Qi$$module$libs$world_onscreen("Error status: "+H.status+" "+H.statusText+" - Unable to load "+t,H);g&&g(Z)}};H.addEventListener("readystatechange",L);H.send()}};P(0)};if(d&&d.enableSceneOffline){const H=M=>{M&&400<M.status?g&&g(M):C()};d.open(()=>{d&&d.loadFile(He$$module$libs$world_onscreen.BaseUrl+a,M=>{!w&&b&&b(M);z.onCompleteObservable.notifyObservers(z)},c?M=>{!w&&c&&c(M)}:void 0,H,e)},
H)}else C();return z},Ir$$module$libs$world_onscreen=()=>"u">typeof location&&"file:"===location.protocol,Gs$$module$libs$world_onscreen=a=>yr$$module$libs$world_onscreen.test(a),xn$$module$libs$world_onscreen=a=>{a=yr$$module$libs$world_onscreen.exec(a);return null===a||0===a.length?{match:!1,type:""}:{match:!0,type:a[0].replace("data:","").replace("base64,","")}};function Xs$$module$libs$world_onscreen(a){return Sn$$module$libs$world_onscreen(a.split(",")[1])}
const Pr$$module$libs$world_onscreen=a=>Rr$$module$libs$world_onscreen(a.split(",")[1]),Mn$$module$libs$world_onscreen=()=>{le$$module$libs$world_onscreen._FileToolsLoadImage=Ws$$module$libs$world_onscreen;le$$module$libs$world_onscreen._FileToolsLoadFile=$t$$module$libs$world_onscreen;ni$$module$libs$world_onscreen._FileToolsLoadFile=$t$$module$libs$world_onscreen};Mn$$module$libs$world_onscreen();let yi$$module$libs$world_onscreen;
const An$$module$libs$world_onscreen=(a,b,c,d,e,g,n,t,w,z)=>{yi$$module$libs$world_onscreen={DecodeBase64UrlToBinary:a,DecodeBase64UrlToString:b,DefaultRetryStrategy:c.DefaultRetryStrategy,BaseUrl:c.BaseUrl,CorsBehavior:c.CorsBehavior,PreprocessUrl:c.PreprocessUrl,IsBase64DataUrl:d,IsFileURL:e,LoadFile:g,LoadImage:n,ReadFile:t,RequestFile:w,SetCorsBehavior:z};Object.defineProperty(yi$$module$libs$world_onscreen,"DefaultRetryStrategy",{get:function(){return c.DefaultRetryStrategy},set:function(C){c.DefaultRetryStrategy=
C}});Object.defineProperty(yi$$module$libs$world_onscreen,"BaseUrl",{get:function(){return c.BaseUrl},set:function(C){c.BaseUrl=C}});Object.defineProperty(yi$$module$libs$world_onscreen,"PreprocessUrl",{get:function(){return c.PreprocessUrl},set:function(C){c.PreprocessUrl=C}});Object.defineProperty(yi$$module$libs$world_onscreen,"CorsBehavior",{get:function(){return c.CorsBehavior},set:function(C){c.CorsBehavior=C}})};
An$$module$libs$world_onscreen(Xs$$module$libs$world_onscreen,Pr$$module$libs$world_onscreen,He$$module$libs$world_onscreen,Gs$$module$libs$world_onscreen,Ir$$module$libs$world_onscreen,$t$$module$libs$world_onscreen,Ws$$module$libs$world_onscreen,wi$$module$libs$world_onscreen,zs$$module$libs$world_onscreen,Vs$$module$libs$world_onscreen);
class Pi$$module$libs$world_onscreen{static Instantiate(a){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[a])return this.RegisteredExternalClasses[a];var b=ci$$module$libs$world_onscreen(a);if(b)return b;O$$module$libs$world_onscreen.Warn(a+" not found, you may have missed an import.");a=a.split(".");b=window||this;for(let c=0,d=a.length;c<d;c++)b=b[a[c]];return"function"!=typeof b?null:b}}Pi$$module$libs$world_onscreen.RegisteredExternalClasses={};
function Dr$$module$libs$world_onscreen(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const b=16*Math.random()|0;return("x"===a?b:b&3|8).toString(16)})}
class X$$module$libs$world_onscreen{static get BaseUrl(){return He$$module$libs$world_onscreen.BaseUrl}static set BaseUrl(a){He$$module$libs$world_onscreen.BaseUrl=a}static get DefaultRetryStrategy(){return He$$module$libs$world_onscreen.DefaultRetryStrategy}static set DefaultRetryStrategy(a){He$$module$libs$world_onscreen.DefaultRetryStrategy=a}static get CorsBehavior(){return He$$module$libs$world_onscreen.CorsBehavior}static set CorsBehavior(a){He$$module$libs$world_onscreen.CorsBehavior=a}static get UseFallbackTexture(){return fe$$module$libs$world_onscreen.UseFallbackTexture}static set UseFallbackTexture(a){fe$$module$libs$world_onscreen.UseFallbackTexture=
a}static get RegisteredExternalClasses(){return Pi$$module$libs$world_onscreen.RegisteredExternalClasses}static set RegisteredExternalClasses(a){Pi$$module$libs$world_onscreen.RegisteredExternalClasses=a}static get fallbackTexture(){return fe$$module$libs$world_onscreen.FallbackTexture}static set fallbackTexture(a){fe$$module$libs$world_onscreen.FallbackTexture=a}static FetchToRef(a,b,c,d,e,g){a=4*((Math.abs(a)*c%c|0)+(Math.abs(b)*d%d|0)*c);g.r=e[a]/255;g.g=e[a+1]/255;g.b=e[a+2]/255;g.a=e[a+3]/255}static Mix(a,
b,c){return a*(1-c)+b*c}static Instantiate(a){return Pi$$module$libs$world_onscreen.Instantiate(a)}static SetImmediate(a){ji$$module$libs$world_onscreen.SetImmediate(a)}static IsExponentOfTwo(a){let b=1;do b*=2;while(b<a);return b===a}static FloatRound(a){return Math.fround?Math.fround(a):(X$$module$libs$world_onscreen._TmpFloatArray[0]=a,X$$module$libs$world_onscreen._TmpFloatArray[0])}static GetFilename(a){const b=a.lastIndexOf("/");return 0>b?a:a.substring(b+1)}static GetFolderPath(a,b=!1){const c=
a.lastIndexOf("/");return 0>c?b?a:"":a.substring(0,c+1)}static ToDegrees(a){return 180*a/Math.PI}static ToRadians(a){return a*Math.PI/180}static SmoothAngleChange(a,b,c=.9){a=this.ToRadians(a);b=this.ToRadians(b);return this.ToDegrees(Math.atan2((1-c)*Math.sin(b)+c*Math.sin(a),(1-c)*Math.cos(b)+c*Math.cos(a)))}static MakeArray(a,b){return!0===b||void 0!==a&&null!=a?Array.isArray(a)?a:[a]:null}static GetPointerPrefix(a){let b="pointer";return Ze$$module$libs$world_onscreen()&&!window.PointerEvent&&
(b="mouse"),a._badDesktopOS&&!a._badOS&&!(document&&"ontouchend"in document)&&(b="mouse"),b}static SetCorsBehavior(a,b){Vs$$module$libs$world_onscreen(a,b)}static SetReferrerPolicyBehavior(a,b){b.referrerPolicy=a}static CleanUrl(a){return a=a.replace(/#/gm,"%23"),a}static get PreprocessUrl(){return He$$module$libs$world_onscreen.PreprocessUrl}static set PreprocessUrl(a){He$$module$libs$world_onscreen.PreprocessUrl=a}static LoadImage(a,b,c,d,e,g){return Ws$$module$libs$world_onscreen(a,b,c,d,e,g)}static LoadFile(a,
b,c,d,e,g){return $t$$module$libs$world_onscreen(a,b,c,d,e,g)}static LoadFileAsync(a,b=!0){return new Promise((c,d)=>{$t$$module$libs$world_onscreen(a,e=>{c(e)},void 0,void 0,b,(e,g)=>{d(g)})})}static LoadScript(a,b,c,d){if("function"==typeof importScripts)try{importScripts(a),b()}catch(n){null==c||c(`Unable to load script '${a}' in worker`,n)}else if(Ze$$module$libs$world_onscreen()){var e=document.getElementsByTagName("head")[0],g=document.createElement("script");g.setAttribute("type","text/javascript");
g.setAttribute("src",a);d&&(g.id=d);g.onload=()=>{b&&b()};g.onerror=n=>{c&&c(`Unable to load script '${a}'`,n)};e.appendChild(g)}else null==c||c(`Cannot load script '${a}' outside of a window or a worker`)}static LoadScriptAsync(a){return new Promise((b,c)=>{this.LoadScript(a,()=>{b()},(d,e)=>{c(e||Error(d))})})}static ReadFileAsDataURL(a,b,c){const d=new FileReader,e={onCompleteObservable:new w$$module$libs$world_onscreen,abort:()=>d.abort()};return d.onloadend=()=>{e.onCompleteObservable.notifyObservers(e)},
d.onload=g=>{b(g.target.result)},d.onprogress=c,d.readAsDataURL(a),e}static ReadFile(a,b,c,d,e){return wi$$module$libs$world_onscreen(a,b,c,d,e)}static FileAsURL(a){a=new Blob([a]);return window.URL.createObjectURL(a)}static Format(a,b=2){return a.toFixed(b)}static DeepCopy(a,b,c,d){Us$$module$libs$world_onscreen.DeepCopy(a,b,c,d)}static IsEmpty(a){for(const b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}static RegisterTopRootEvents(a,b){for(let c=0;c<b.length;c++){const d=
b[c];a.addEventListener(d.name,d.handler,!1);try{window.parent&&window.parent.addEventListener(d.name,d.handler,!1)}catch{}}}static UnregisterTopRootEvents(a,b){for(let c=0;c<b.length;c++){const d=b[c];a.removeEventListener(d.name,d.handler);try{a.parent&&a.parent.removeEventListener(d.name,d.handler)}catch{}}}static async DumpFramebuffer(a,b,c,d,e,g){throw $$$module$libs$world_onscreen("DumpTools");}static DumpData(a,b,c,d,e,g,n,t,w){throw $$$module$libs$world_onscreen("DumpTools");}static DumpDataAsync(a,
b,c,d,e,g,n,t){throw $$$module$libs$world_onscreen("DumpTools");}static ToBlob(a,b,c="image/png",d){a.toBlob||(a.toBlob=function(e,g,n){setTimeout(()=>{const t=atob(this.toDataURL(g,n).split(",")[1]),w=t.length,z=new Uint8Array(w);for(let C=0;C<w;C++)z[C]=t.charCodeAt(C);e(new Blob([z]))})});a.toBlob(function(e){b(e)},c,d)}static DownloadBlob(a,b){if("download"in document.createElement("a"))b||(b=new Date,b="screenshot_"+((b.getFullYear()+"-"+(b.getMonth()+1)).slice(2)+"-"+b.getDate()+"_"+b.getHours()+
"-"+("0"+b.getMinutes()).slice(-2))+".png"),X$$module$libs$world_onscreen.Download(a,b);else if(a&&"u">typeof URL){const c=URL.createObjectURL(a);if(b=window.open(""))a=b.document.createElement("img"),a.onload=function(){URL.revokeObjectURL(c)},a.src=c,b.document.body.appendChild(a)}}static EncodeScreenshotCanvasData(a,b,c="image/png",d,e){b?(a=a.toDataURL(c,e),b(a)):this.ToBlob(a,function(g){g&&X$$module$libs$world_onscreen.DownloadBlob(g,d)},c,e)}static Download(a,b){if(!("u"<typeof URL)){a=window.URL.createObjectURL(a);
var c=document.createElement("a");document.body.appendChild(c);c.style.display="none";c.href=a;c.download=b;c.addEventListener("click",()=>{c.parentElement&&c.parentElement.removeChild(c)});c.click();window.URL.revokeObjectURL(a)}}static BackCompatCameraNoPreventDefault(a){return"boolean"==typeof a[0]?a[0]:"boolean"==typeof a[1]?a[1]:!1}static CreateScreenshot(a,b,c,d,e){throw $$$module$libs$world_onscreen("ScreenshotTools");}static CreateScreenshotAsync(a,b,c,d){throw $$$module$libs$world_onscreen("ScreenshotTools");
}static CreateScreenshotUsingRenderTarget(a,b,c,d,e,g,n,t){throw $$$module$libs$world_onscreen("ScreenshotTools");}static CreateScreenshotUsingRenderTargetAsync(a,b,c,d,e,g,n){throw $$$module$libs$world_onscreen("ScreenshotTools");}static RandomId(){return Dr$$module$libs$world_onscreen()}static IsBase64(a){return Gs$$module$libs$world_onscreen(a)}static DecodeBase64(a){return Xs$$module$libs$world_onscreen(a)}static get errorsCount(){return O$$module$libs$world_onscreen.errorsCount}static Log(a){O$$module$libs$world_onscreen.Log(a)}static Warn(a){O$$module$libs$world_onscreen.Warn(a)}static Error(a){O$$module$libs$world_onscreen.Error(a)}static get LogCache(){return O$$module$libs$world_onscreen.LogCache}static ClearLogCache(){O$$module$libs$world_onscreen.ClearLogCache()}static set LogLevels(a){O$$module$libs$world_onscreen.LogLevels=
a}static set PerformanceLogLevel(a){(a&X$$module$libs$world_onscreen.PerformanceUserMarkLogLevel)===X$$module$libs$world_onscreen.PerformanceUserMarkLogLevel?(X$$module$libs$world_onscreen.StartPerformanceCounter=X$$module$libs$world_onscreen._StartUserMark,X$$module$libs$world_onscreen.EndPerformanceCounter=X$$module$libs$world_onscreen._EndUserMark):(a&X$$module$libs$world_onscreen.PerformanceConsoleLogLevel)===X$$module$libs$world_onscreen.PerformanceConsoleLogLevel?(X$$module$libs$world_onscreen.StartPerformanceCounter=
X$$module$libs$world_onscreen._StartPerformanceConsole,X$$module$libs$world_onscreen.EndPerformanceCounter=X$$module$libs$world_onscreen._EndPerformanceConsole):(X$$module$libs$world_onscreen.StartPerformanceCounter=X$$module$libs$world_onscreen._StartPerformanceCounterDisabled,X$$module$libs$world_onscreen.EndPerformanceCounter=X$$module$libs$world_onscreen._EndPerformanceCounterDisabled)}static _StartPerformanceCounterDisabled(a,b){}static _EndPerformanceCounterDisabled(a,b){}static _StartUserMark(a,
b=!0){if(!X$$module$libs$world_onscreen._Performance){if(!Ze$$module$libs$world_onscreen())return;X$$module$libs$world_onscreen._Performance=window.performance}b&&X$$module$libs$world_onscreen._Performance.mark&&X$$module$libs$world_onscreen._Performance.mark(a+"-Begin")}static _EndUserMark(a,b=!0){b&&X$$module$libs$world_onscreen._Performance.mark&&(X$$module$libs$world_onscreen._Performance.mark(a+"-End"),X$$module$libs$world_onscreen._Performance.measure(a,a+"-Begin",a+"-End"))}static _StartPerformanceConsole(a,
b=!0){b&&(X$$module$libs$world_onscreen._StartUserMark(a,b),console.time&&console.time(a))}static _EndPerformanceConsole(a,b=!0){b&&(X$$module$libs$world_onscreen._EndUserMark(a,b),console.timeEnd(a))}static get Now(){return ai$$module$libs$world_onscreen.Now}static GetClassName(a,b=!1){let c=null;return!b&&a.getClassName?c=a.getClassName():(a instanceof Object&&(c=(b?a:Object.getPrototypeOf(a)).constructor.__bjsclassName__),c||=typeof a),c}static First(a,b){for(const c of a)if(b(c))return c;return null}static getFullClassName(a,
b=!1){let c=null,d=null;!b&&a.getClassName?c=a.getClassName():(a instanceof Object&&(b=b?a:Object.getPrototypeOf(a),c=b.constructor.__bjsclassName__,d=b.constructor.__bjsmoduleName__),c||=typeof a);return c?(null!=d?d+".":"")+c:null}static DelayAsync(a){return new Promise(b=>{setTimeout(()=>{b()},a)})}static IsSafari(){return xr$$module$libs$world_onscreen()?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}}X$$module$libs$world_onscreen.UseCustomRequestHeaders=!1;
X$$module$libs$world_onscreen.CustomRequestHeaders=dt$$module$libs$world_onscreen.CustomRequestHeaders;X$$module$libs$world_onscreen._TmpFloatArray=new Float32Array(1);X$$module$libs$world_onscreen.GetDOMTextContent=Bs$$module$libs$world_onscreen;
X$$module$libs$world_onscreen.GetAbsoluteUrl="object"==typeof document?a=>{const b=document.createElement("a");return b.href=a,b.href}:"function"==typeof URL&&"object"==typeof location?a=>(new URL(a,location.origin)).href:()=>{throw Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.");};X$$module$libs$world_onscreen.NoneLogLevel=O$$module$libs$world_onscreen.NoneLogLevel;X$$module$libs$world_onscreen.MessageLogLevel=O$$module$libs$world_onscreen.MessageLogLevel;
X$$module$libs$world_onscreen.WarningLogLevel=O$$module$libs$world_onscreen.WarningLogLevel;X$$module$libs$world_onscreen.ErrorLogLevel=O$$module$libs$world_onscreen.ErrorLogLevel;X$$module$libs$world_onscreen.AllLogLevel=O$$module$libs$world_onscreen.AllLogLevel;X$$module$libs$world_onscreen.IsWindowObjectExist=Ze$$module$libs$world_onscreen;X$$module$libs$world_onscreen.PerformanceNoneLogLevel=0;X$$module$libs$world_onscreen.PerformanceUserMarkLogLevel=1;
X$$module$libs$world_onscreen.PerformanceConsoleLogLevel=2;X$$module$libs$world_onscreen.StartPerformanceCounter=X$$module$libs$world_onscreen._StartPerformanceCounterDisabled;X$$module$libs$world_onscreen.EndPerformanceCounter=X$$module$libs$world_onscreen._EndPerformanceCounterDisabled;
class Ji$$module$libs$world_onscreen{constructor(a,b,c,d=0){this.iterations=a;this.index=d-1;this._done=!1;this._fn=b;this._successCallback=c}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0;this._successCallback()}static Run(a,b,c,d=0){a=new Ji$$module$libs$world_onscreen(a,b,c,d);return a.executeNext(),a}static SyncAsyncForLoop(a,b,c,d,e,g=0){return Ji$$module$libs$world_onscreen.Run(Math.ceil(a/b),n=>{e&&e()?n.breakLoop():
setTimeout(()=>{for(let t=0;t<b;++t){const w=n.index*b+t;if(w>=a)break;if(c(w),e&&e()){n.breakLoop();break}}n.executeNext()},g)},d)}}fe$$module$libs$world_onscreen.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z";
class $e$$module$libs$world_onscreen{constructor(a){this.length=0;this.data=Array(a);this._id=$e$$module$libs$world_onscreen._GlobalId++}push(a){this.data[this.length++]=a;this.length>this.data.length&&(this.data.length*=2)}forEach(a){for(let b=0;b<this.length;b++)a(this.data[b])}sort(a){this.data.sort(a)}reset(){this.length=0}dispose(){this.reset();this.data&&(this.data.length=0)}concat(a){if(0!==a.length){this.length+a.length>this.data.length&&(this.data.length=2*(this.length+a.length));for(let b=
0;b<a.length;b++)this.data[this.length++]=(a.data||a)[b]}}indexOf(a){a=this.data.indexOf(a);return a>=this.length?-1:a}contains(a){return-1!==this.indexOf(a)}}$e$$module$libs$world_onscreen._GlobalId=0;
class ii$$module$libs$world_onscreen extends $e$$module$libs$world_onscreen{constructor(){super(...arguments);this._duplicateId=0}push(a){super.push(a);a.__smartArrayFlags||(a.__smartArrayFlags={});a.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(a){return a.__smartArrayFlags&&a.__smartArrayFlags[this._id]===this._duplicateId?!1:(this.push(a),!0)}reset(){super.reset();this._duplicateId++}concatWithNoDuplicate(a){if(0!==a.length){this.length+a.length>this.data.length&&(this.data.length=
2*(this.length+a.length));for(let b=0;b<a.length;b++)this.pushNoDuplicate((a.data||a)[b])}}}
class Js$$module$libs$world_onscreen{constructor(){this._count=0;this._data={}}copyFrom(a){this.clear();a.forEach((b,c)=>this.add(b,c))}get(a){a=this._data[a];if(void 0!==a)return a}getOrAddWithFactory(a,b){let c=this.get(a);return void 0!==c||(c=b(a),c&&this.add(a,c)),c}getOrAdd(a,b){const c=this.get(a);return void 0!==c?c:(this.add(a,b),b)}contains(a){return void 0!==this._data[a]}add(a,b){return void 0!==this._data[a]?!1:(this._data[a]=b,++this._count,!0)}set(a,b){return void 0===this._data[a]?
!1:(this._data[a]=b,!0)}getAndRemove(a){const b=this.get(a);return void 0!==b?(delete this._data[a],--this._count,b):null}remove(a){return this.contains(a)?(delete this._data[a],--this._count,!0):!1}clear(){this._data={};this._count=0}get count(){return this._count}forEach(a){for(const b in this._data)a(b,this._data[b])}first(a){for(const b in this._data){const c=a(b,this._data[b]);if(c)return c}return null}}
class ri$$module$libs$world_onscreen{static Eval(a,b){return a.match(/\([^()]*\)/g)?a=a.replace(/\([^()]*\)/g,c=>(c=c.slice(1,c.length-1),ri$$module$libs$world_onscreen._HandleParenthesisContent(c,b))):a=ri$$module$libs$world_onscreen._HandleParenthesisContent(a,b),"true"===a?!0:"false"===a?!1:ri$$module$libs$world_onscreen.Eval(a,b)}static _HandleParenthesisContent(a,b){b=b||(d=>"true"===d);let c;a=a.split("||");for(const d in a)if(Object.prototype.hasOwnProperty.call(a,d)){let e=ri$$module$libs$world_onscreen._SimplifyNegation(a[d].trim());
const g=e.split("&&");if(1<g.length)for(let n=0;n<g.length;++n){const t=ri$$module$libs$world_onscreen._SimplifyNegation(g[n].trim());if("true"!==t&&"false"!==t?"!"===t[0]?c=!b(t.substring(1)):c=b(t):c="true"===t,!c){e="false";break}}if(c||"true"===e){c=!0;break}"true"!==e&&"false"!==e?"!"===e[0]?c=!b(e.substring(1)):c=b(e):c="true"===e}return c?"true":"false"}static _SimplifyNegation(a){return a=a.replace(/^[\s!]+/,b=>(b=b.replace(/[\s]/g,()=>""),b.length%2?"!":"")),a=a.trim(),"!true"===a?a="false":
"!false"===a&&(a="true"),a}}
class ge$$module$libs$world_onscreen{static EnableFor(a){a._tags=a._tags||{};a.hasTags=()=>ge$$module$libs$world_onscreen.HasTags(a);a.addTags=b=>ge$$module$libs$world_onscreen.AddTagsTo(a,b);a.removeTags=b=>ge$$module$libs$world_onscreen.RemoveTagsFrom(a,b);a.matchesTagsQuery=b=>ge$$module$libs$world_onscreen.MatchesQuery(a,b)}static DisableFor(a){delete a._tags;delete a.hasTags;delete a.addTags;delete a.removeTags;delete a.matchesTagsQuery}static HasTags(a){if(!a._tags)return!1;a=a._tags;for(const b in a)if(Object.prototype.hasOwnProperty.call(a,
b))return!0;return!1}static GetTags(a,b=!0){if(!a._tags)return null;if(b){b=[];for(const c in a._tags)Object.prototype.hasOwnProperty.call(a._tags,c)&&!0===a._tags[c]&&b.push(c);return b.join(" ")}return a._tags}static AddTagsTo(a,b){b&&"string"==typeof b&&b.split(" ").forEach(function(c){ge$$module$libs$world_onscreen._AddTagTo(a,c)})}static _AddTagTo(a,b){b=b.trim();""!==b&&"true"!==b&&"false"!==b&&(b.match(/[\s]/)||b.match(/^([!]|([|]|[&]){2})/)||(ge$$module$libs$world_onscreen.EnableFor(a),a._tags[b]=
!0))}static RemoveTagsFrom(a,b){if(ge$$module$libs$world_onscreen.HasTags(a)){b=b.split(" ");for(const c in b)ge$$module$libs$world_onscreen._RemoveTagFrom(a,b[c])}}static _RemoveTagFrom(a,b){delete a._tags[b]}static MatchesQuery(a,b){return void 0===b?!0:""===b?ge$$module$libs$world_onscreen.HasTags(a):ri$$module$libs$world_onscreen.Eval(b,c=>ge$$module$libs$world_onscreen.HasTags(a)&&a._tags[c])}}
class as$$module$libs$world_onscreen{constructor(){this.rootNodes=[];this.cameras=[];this.lights=[];this.meshes=[];this.skeletons=[];this.particleSystems=[];this.animations=[];this.animationGroups=[];this.multiMaterials=[];this.materials=[];this.morphTargetManagers=[];this.geometries=[];this.transformNodes=[];this.actionManagers=[];this.textures=[];this._environmentTexture=null;this.postProcesses=[]}static AddParser(a,b){this._BabylonFileParsers[a]=b}static GetParser(a){return this._BabylonFileParsers[a]?
this._BabylonFileParsers[a]:null}static AddIndividualParser(a,b){this._IndividualBabylonFileParsers[a]=b}static GetIndividualParser(a){return this._IndividualBabylonFileParsers[a]?this._IndividualBabylonFileParsers[a]:null}static Parse(a,b,c,d){for(const e in this._BabylonFileParsers)Object.prototype.hasOwnProperty.call(this._BabylonFileParsers,e)&&this._BabylonFileParsers[e](a,b,c,d)}get environmentTexture(){return this._environmentTexture}set environmentTexture(a){this._environmentTexture=a}getNodes(){let a=
[];return a=a.concat(this.meshes),a=a.concat(this.lights),a=a.concat(this.cameras),a=a.concat(this.transformNodes),this.skeletons.forEach(b=>a=a.concat(b.bones)),a}}as$$module$libs$world_onscreen._BabylonFileParsers={};as$$module$libs$world_onscreen._IndividualBabylonFileParsers={};
function T$$module$libs$world_onscreen(a,b,c,d){var e=arguments.length,g=3>e?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d,n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var t=a.length-1;0<=t;t--)(n=a[t])&&(g=(3>e?n(g):3<e?n(b,c,g):n(b,c))||g);return 3<e&&g&&Object.defineProperty(b,c,g),g}
const qi$$module$libs$world_onscreen={},Ki$$module$libs$world_onscreen={},er$$module$libs$world_onscreen=function(a,b,c){a=a();ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.AddTagsTo(a,b.tags);const d=ws$$module$libs$world_onscreen(a);for(const e in d){const g=b[e],n=d[e].type;if(null!=g&&("uniqueId"!==e||ae$$module$libs$world_onscreen.AllowLoadingUniqueId))switch(n){case 0:case 6:case 11:a[e]=g;break;case 1:a[e]=c||g.isRenderTarget?g:g.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:a[e]=
c?g:g.clone()}}return a};function Rn$$module$libs$world_onscreen(a){a=a.getClassName();return qi$$module$libs$world_onscreen[a]||(qi$$module$libs$world_onscreen[a]={}),qi$$module$libs$world_onscreen[a]}
function ws$$module$libs$world_onscreen(a){var b=a.getClassName();if(Ki$$module$libs$world_onscreen[b])return Ki$$module$libs$world_onscreen[b];Ki$$module$libs$world_onscreen[b]={};const c=Ki$$module$libs$world_onscreen[b];for(;b;){var d=qi$$module$libs$world_onscreen[b];for(const g in d)c[g]=d[g];let e;d=!1;do{if(e=Object.getPrototypeOf(a),!e.getClassName){d=!0;break}if(e.getClassName()!==b)break;a=e}while(e);if(d)break;b=e.getClassName();a=e}return c}
function It$$module$libs$world_onscreen(a,b){return(c,d)=>{c=Rn$$module$libs$world_onscreen(c);c[d]||(c[d]={type:a,sourceName:b})}}function yn$$module$libs$world_onscreen(a,b=null){return(c,d)=>{const e=b||"_"+d;Object.defineProperty(c,d,{get:function(){return this[e]},set:function(g){"function"==typeof this.equals&&this.equals(g)||this[e]!==g&&(this[e]=g,c[a].apply(this))},enumerable:!0,configurable:!0})}}
function be$$module$libs$world_onscreen(a,b=null){return yn$$module$libs$world_onscreen(a,b)}function R$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(0,a)}function vt$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(1,a)}function di$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(2,a)}function Vi$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(3,a)}
function Cn$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(4,a)}function Gt$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(5,a)}function In$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(6,a)}function Pn$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(7,a)}function Fr$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(8,a)}
function Dn$$module$libs$world_onscreen(a){return It$$module$libs$world_onscreen(10,a)}
class ae$$module$libs$world_onscreen{static AppendSerializedAnimations(a,b){if(a.animations){b.animations=[];for(let c=0;c<a.animations.length;c++)b.animations.push(a.animations[c].serialize())}}static Serialize(a,b){b||={};ge$$module$libs$world_onscreen&&(b.tags=ge$$module$libs$world_onscreen.GetTags(a));const c=ws$$module$libs$world_onscreen(a);for(const e in c){var d=c[e];const g=d.sourceName||e;d=d.type;const n=a[e];if(null!=n&&("uniqueId"!==e||ae$$module$libs$world_onscreen.AllowLoadingUniqueId))switch(d){case 0:b[g]=
n;break;case 1:b[g]=n.serialize();break;case 2:b[g]=n.asArray();break;case 3:b[g]=n.serialize();break;case 4:b[g]=n.asArray();break;case 5:b[g]=n.asArray();break;case 6:b[g]=n.id;break;case 7:b[g]=n.serialize();break;case 8:b[g]=n.asArray();break;case 9:b[g]=n.serialize();break;case 10:b[g]=n.asArray();break;case 11:b[g]=n.id;break;case 12:b[g]=n.asArray()}}return b}static Parse(a,b,c,d=null){a=a();d||="";ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.AddTagsTo(a,b.tags);const e=ws$$module$libs$world_onscreen(a);
for(const n in e){var g=e[n];const t=b[g.sourceName||n];g=g.type;if(null!=t&&("uniqueId"!==n||ae$$module$libs$world_onscreen.AllowLoadingUniqueId)){const w=a;switch(g){case 0:w[n]=t;break;case 1:c&&(w[n]=ae$$module$libs$world_onscreen._TextureParser(t,c,d));break;case 2:w[n]=se$$module$libs$world_onscreen.FromArray(t);break;case 3:w[n]=ae$$module$libs$world_onscreen._FresnelParametersParser(t);break;case 4:w[n]=Te$$module$libs$world_onscreen.FromArray(t);break;case 5:w[n]=p$$module$libs$world_onscreen.FromArray(t);
break;case 6:c&&(w[n]=c.getLastMeshById(t));break;case 7:w[n]=ae$$module$libs$world_onscreen._ColorCurvesParser(t);break;case 8:w[n]=me$$module$libs$world_onscreen.FromArray(t);break;case 9:w[n]=ae$$module$libs$world_onscreen._ImageProcessingConfigurationParser(t);break;case 10:w[n]=Y$$module$libs$world_onscreen.FromArray(t);break;case 11:c&&(w[n]=c.getCameraById(t));break;case 12:w[n]=x$$module$libs$world_onscreen.FromArray(t)}}}return a}static Clone(a,b){return er$$module$libs$world_onscreen(a,
b,!1)}static Instanciate(a,b){return er$$module$libs$world_onscreen(a,b,!0)}}ae$$module$libs$world_onscreen.AllowLoadingUniqueId=!1;ae$$module$libs$world_onscreen._ImageProcessingConfigurationParser=a=>{throw $$$module$libs$world_onscreen("ImageProcessingConfiguration");};ae$$module$libs$world_onscreen._FresnelParametersParser=a=>{throw $$$module$libs$world_onscreen("FresnelParameters");};ae$$module$libs$world_onscreen._ColorCurvesParser=a=>{throw $$$module$libs$world_onscreen("ColorCurves");};
ae$$module$libs$world_onscreen._TextureParser=(a,b,c)=>{throw $$$module$libs$world_onscreen("Texture");};function Qt$$module$libs$world_onscreen(a,b,c,d){const e=c.value;c.value=(...g)=>{let n=e;if("u">typeof _native&&_native[b]){const t=_native[b];d?n=(...w)=>d(...w)?t(...w):e(...w):n=t}return a[b]=n,n(...g)}}Qt$$module$libs$world_onscreen.filter=function(a){return(b,c,d)=>Qt$$module$libs$world_onscreen(b,c,d,a)};
class Hs$$module$libs$world_onscreen{constructor(a){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=a,a)for(const b in a)Object.prototype.hasOwnProperty.call(a,b)&&this._setDefaultValue(b)}get isDirty(){return this._isDirty}markAsProcessed(){this._areImageProcessingDirty=
this._arePrePassDirty=this._areMiscDirty=this._areLightsDisposed=this._areLightsDirty=this._areFresnelDirty=this._areTexturesDirty=this._areAttributesDirty=this._isDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._isDirty=this._areImageProcessingDirty=this._areMiscDirty=this._areFresnelDirty=this._areLightsDirty=this._areAttributesDirty=this._areTexturesDirty=!0}markAsImageProcessingDirty(){this._isDirty=this._areImageProcessingDirty=!0}markAsLightDirty(a=!1){this._areLightsDirty=
!0;this._areLightsDisposed=this._areLightsDisposed||a;this._isDirty=!0}markAsAttributesDirty(){this._isDirty=this._areAttributesDirty=!0}markAsTexturesDirty(){this._isDirty=this._areTexturesDirty=!0}markAsFresnelDirty(){this._isDirty=this._areFresnelDirty=!0}markAsMiscDirty(){this._isDirty=this._areMiscDirty=!0}markAsPrePassDirty(){this._isDirty=this._arePrePassDirty=!0}rebuild(){this._keys.length=0;for(const a of Object.keys(this))"_"!==a[0]&&this._keys.push(a);if(this._externalProperties)for(const a in this._externalProperties)-1===
this._keys.indexOf(a)&&this._keys.push(a)}isEqual(a){if(this._keys.length!==a._keys.length)return!1;for(let b=0;b<this._keys.length;b++){const c=this._keys[b];if(this[c]!==a[c])return!1}return!0}cloneTo(a){this._keys.length!==a._keys.length&&(a._keys=this._keys.slice(0));for(let b=0;b<this._keys.length;b++){const c=this._keys[b];a[c]=this[c]}}reset(){this._keys.forEach(a=>this._setDefaultValue(a))}_setDefaultValue(a){var b,c,d,e,g;const n=null!==(d=null===(c=null===(b=this._externalProperties)||void 0===
b?void 0:b[a])||void 0===c?void 0:c.type)&&void 0!==d?d:typeof this[a];b=null===(g=null===(e=this._externalProperties)||void 0===e?void 0:e[a])||void 0===g?void 0:g.default;switch(n){case "number":this[a]=b??0;break;case "string":this[a]=b??"";break;default:this[a]=b??!1}}toString(){let a="";for(let b=0;b<this._keys.length;b++){const c=this._keys[b],d=this[c];switch(typeof d){case "number":case "string":a+="#define "+c+" "+d+"\n";break;default:d&&(a+="#define "+c+"\n")}}return a}}
class xe$$module$libs$world_onscreen{constructor(){this._dirty=!0;this._tempColor=new me$$module$libs$world_onscreen(0,0,0,0);this._globalCurve=new me$$module$libs$world_onscreen(0,0,0,0);this._highlightsCurve=new me$$module$libs$world_onscreen(0,0,0,0);this._midtonesCurve=new me$$module$libs$world_onscreen(0,0,0,0);this._shadowsCurve=new me$$module$libs$world_onscreen(0,0,0,0);this._positiveCurve=new me$$module$libs$world_onscreen(0,0,0,0);this._negativeCurve=new me$$module$libs$world_onscreen(0,
0,0,0);this._globalHue=30;this._globalExposure=this._globalSaturation=this._globalDensity=0;this._highlightsHue=30;this._highlightsExposure=this._highlightsSaturation=this._highlightsDensity=0;this._midtonesHue=30;this._midtonesExposure=this._midtonesSaturation=this._midtonesDensity=0;this._shadowsHue=30;this._shadowsExposure=this._shadowsSaturation=this._shadowsDensity=0}get globalHue(){return this._globalHue}set globalHue(a){this._globalHue=a;this._dirty=!0}get globalDensity(){return this._globalDensity}set globalDensity(a){this._globalDensity=
a;this._dirty=!0}get globalSaturation(){return this._globalSaturation}set globalSaturation(a){this._globalSaturation=a;this._dirty=!0}get globalExposure(){return this._globalExposure}set globalExposure(a){this._globalExposure=a;this._dirty=!0}get highlightsHue(){return this._highlightsHue}set highlightsHue(a){this._highlightsHue=a;this._dirty=!0}get highlightsDensity(){return this._highlightsDensity}set highlightsDensity(a){this._highlightsDensity=a;this._dirty=!0}get highlightsSaturation(){return this._highlightsSaturation}set highlightsSaturation(a){this._highlightsSaturation=
a;this._dirty=!0}get highlightsExposure(){return this._highlightsExposure}set highlightsExposure(a){this._highlightsExposure=a;this._dirty=!0}get midtonesHue(){return this._midtonesHue}set midtonesHue(a){this._midtonesHue=a;this._dirty=!0}get midtonesDensity(){return this._midtonesDensity}set midtonesDensity(a){this._midtonesDensity=a;this._dirty=!0}get midtonesSaturation(){return this._midtonesSaturation}set midtonesSaturation(a){this._midtonesSaturation=a;this._dirty=!0}get midtonesExposure(){return this._midtonesExposure}set midtonesExposure(a){this._midtonesExposure=
a;this._dirty=!0}get shadowsHue(){return this._shadowsHue}set shadowsHue(a){this._shadowsHue=a;this._dirty=!0}get shadowsDensity(){return this._shadowsDensity}set shadowsDensity(a){this._shadowsDensity=a;this._dirty=!0}get shadowsSaturation(){return this._shadowsSaturation}set shadowsSaturation(a){this._shadowsSaturation=a;this._dirty=!0}get shadowsExposure(){return this._shadowsExposure}set shadowsExposure(a){this._shadowsExposure=a;this._dirty=!0}getClassName(){return"ColorCurves"}static Bind(a,
b,c="vCameraColorCurvePositive",d="vCameraColorCurveNeutral",e="vCameraColorCurveNegative"){a._dirty&&(a._dirty=!1,a._getColorGradingDataToRef(a._globalHue,a._globalDensity,a._globalSaturation,a._globalExposure,a._globalCurve),a._getColorGradingDataToRef(a._highlightsHue,a._highlightsDensity,a._highlightsSaturation,a._highlightsExposure,a._tempColor),a._tempColor.multiplyToRef(a._globalCurve,a._highlightsCurve),a._getColorGradingDataToRef(a._midtonesHue,a._midtonesDensity,a._midtonesSaturation,a._midtonesExposure,
a._tempColor),a._tempColor.multiplyToRef(a._globalCurve,a._midtonesCurve),a._getColorGradingDataToRef(a._shadowsHue,a._shadowsDensity,a._shadowsSaturation,a._shadowsExposure,a._tempColor),a._tempColor.multiplyToRef(a._globalCurve,a._shadowsCurve),a._highlightsCurve.subtractToRef(a._midtonesCurve,a._positiveCurve),a._midtonesCurve.subtractToRef(a._shadowsCurve,a._negativeCurve));b&&(b.setFloat4(c,a._positiveCurve.r,a._positiveCurve.g,a._positiveCurve.b,a._positiveCurve.a),b.setFloat4(d,a._midtonesCurve.r,
a._midtonesCurve.g,a._midtonesCurve.b,a._midtonesCurve.a),b.setFloat4(e,a._negativeCurve.r,a._negativeCurve.g,a._negativeCurve.b,a._negativeCurve.a))}static PrepareUniforms(a){a.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}_getColorGradingDataToRef(a,b,c,d,e){null!=a&&(a=xe$$module$libs$world_onscreen._Clamp(a,0,360),b=xe$$module$libs$world_onscreen._Clamp(b,-100,100),c=xe$$module$libs$world_onscreen._Clamp(c,-100,100),d=xe$$module$libs$world_onscreen._Clamp(d,
-100,100),b=xe$$module$libs$world_onscreen._ApplyColorGradingSliderNonlinear(b),b*=.5,d=xe$$module$libs$world_onscreen._ApplyColorGradingSliderNonlinear(d),0>b&&(b*=-1,a=(a+180)%360),xe$$module$libs$world_onscreen._FromHSBToRef(a,b,50+.25*d,e),e.scaleToRef(2,e),e.a=1+.01*c)}static _ApplyColorGradingSliderNonlinear(a){a/=100;let b=Math.abs(a);return b=Math.pow(b,2),0>a&&(b*=-1),b*=100,b}static _FromHSBToRef(a,b,c,d){var e=xe$$module$libs$world_onscreen._Clamp(a,0,360);b=xe$$module$libs$world_onscreen._Clamp(b/
100,0,1);c=xe$$module$libs$world_onscreen._Clamp(c/100,0,1);if(0===b)d.r=c,d.g=c,d.b=c;else{e/=60;a=Math.floor(e);const g=e-a;e=c*(1-b);const n=c*(1-b*g);b=c*(1-b*(1-g));switch(a){case 0:d.r=c;d.g=b;d.b=e;break;case 1:d.r=n;d.g=c;d.b=e;break;case 2:d.r=e;d.g=c;d.b=b;break;case 3:d.r=e;d.g=n;d.b=c;break;case 4:d.r=b;d.g=e;d.b=c;break;default:d.r=c,d.g=e,d.b=n}}d.a=1}static _Clamp(a,b,c){return Math.min(Math.max(a,b),c)}clone(){return ae$$module$libs$world_onscreen.Clone(()=>new xe$$module$libs$world_onscreen,
this)}serialize(){return ae$$module$libs$world_onscreen.Serialize(this)}static Parse(a){return ae$$module$libs$world_onscreen.Parse(()=>new xe$$module$libs$world_onscreen,a,null,null)}}T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_globalHue",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_globalDensity",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_globalSaturation",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_globalExposure",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_highlightsHue",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_highlightsDensity",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_highlightsSaturation",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_highlightsExposure",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_midtonesHue",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_midtonesDensity",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_midtonesSaturation",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],xe$$module$libs$world_onscreen.prototype,"_midtonesExposure",void 0);ae$$module$libs$world_onscreen._ColorCurvesParser=xe$$module$libs$world_onscreen.Parse;
class pe$$module$libs$world_onscreen{constructor(){this.colorCurves=new xe$$module$libs$world_onscreen;this._colorGradingEnabled=this._colorCurvesEnabled=!1;this._colorGradingBGR=this._colorGradingWithGreenDepth=!0;this._exposure=1;this._toneMappingEnabled=!1;this._toneMappingType=pe$$module$libs$world_onscreen.TONEMAPPING_STANDARD;this._contrast=1;this.vignetteCenterY=this.vignetteCenterX=this.vignetteStretch=0;this.vignetteWeight=1.5;this.vignetteColor=new me$$module$libs$world_onscreen(0,0,0,0);
this.vignetteCameraFov=.5;this._vignetteBlendMode=pe$$module$libs$world_onscreen.VIGNETTEMODE_MULTIPLY;this._ditheringEnabled=this._vignetteEnabled=!1;this._ditheringIntensity=1/255;this._applyByPostProcess=this._skipFinalColorClamp=!1;this._isEnabled=!0;this.onUpdateParameters=new w$$module$libs$world_onscreen}get colorCurvesEnabled(){return this._colorCurvesEnabled}set colorCurvesEnabled(a){this._colorCurvesEnabled!==a&&(this._colorCurvesEnabled=a,this._updateParameters())}get colorGradingTexture(){return this._colorGradingTexture}set colorGradingTexture(a){this._colorGradingTexture!==
a&&(this._colorGradingTexture=a,this._updateParameters())}get colorGradingEnabled(){return this._colorGradingEnabled}set colorGradingEnabled(a){this._colorGradingEnabled!==a&&(this._colorGradingEnabled=a,this._updateParameters())}get colorGradingWithGreenDepth(){return this._colorGradingWithGreenDepth}set colorGradingWithGreenDepth(a){this._colorGradingWithGreenDepth!==a&&(this._colorGradingWithGreenDepth=a,this._updateParameters())}get colorGradingBGR(){return this._colorGradingBGR}set colorGradingBGR(a){this._colorGradingBGR!==
a&&(this._colorGradingBGR=a,this._updateParameters())}get exposure(){return this._exposure}set exposure(a){this._exposure!==a&&(this._exposure=a,this._updateParameters())}get toneMappingEnabled(){return this._toneMappingEnabled}set toneMappingEnabled(a){this._toneMappingEnabled!==a&&(this._toneMappingEnabled=a,this._updateParameters())}get toneMappingType(){return this._toneMappingType}set toneMappingType(a){this._toneMappingType!==a&&(this._toneMappingType=a,this._updateParameters())}get contrast(){return this._contrast}set contrast(a){this._contrast!==
a&&(this._contrast=a,this._updateParameters())}get vignetteCentreY(){return this.vignetteCenterY}set vignetteCentreY(a){this.vignetteCenterY=a}get vignetteCentreX(){return this.vignetteCenterX}set vignetteCentreX(a){this.vignetteCenterX=a}get vignetteBlendMode(){return this._vignetteBlendMode}set vignetteBlendMode(a){this._vignetteBlendMode!==a&&(this._vignetteBlendMode=a,this._updateParameters())}get vignetteEnabled(){return this._vignetteEnabled}set vignetteEnabled(a){this._vignetteEnabled!==a&&
(this._vignetteEnabled=a,this._updateParameters())}get ditheringEnabled(){return this._ditheringEnabled}set ditheringEnabled(a){this._ditheringEnabled!==a&&(this._ditheringEnabled=a,this._updateParameters())}get ditheringIntensity(){return this._ditheringIntensity}set ditheringIntensity(a){this._ditheringIntensity!==a&&(this._ditheringIntensity=a,this._updateParameters())}get skipFinalColorClamp(){return this._skipFinalColorClamp}set skipFinalColorClamp(a){this._skipFinalColorClamp!==a&&(this._skipFinalColorClamp=
a,this._updateParameters())}get applyByPostProcess(){return this._applyByPostProcess}set applyByPostProcess(a){this._applyByPostProcess!==a&&(this._applyByPostProcess=a,this._updateParameters())}get isEnabled(){return this._isEnabled}set isEnabled(a){this._isEnabled!==a&&(this._isEnabled=a,this._updateParameters())}_updateParameters(){this.onUpdateParameters.notifyObservers(this)}getClassName(){return"ImageProcessingConfiguration"}static PrepareUniforms(a,b){b.EXPOSURE&&a.push("exposureLinear");b.CONTRAST&&
a.push("contrast");b.COLORGRADING&&a.push("colorTransformSettings");(b.VIGNETTE||b.DITHER)&&a.push("vInverseScreenSize");b.VIGNETTE&&(a.push("vignetteSettings1"),a.push("vignetteSettings2"));b.COLORCURVES&&xe$$module$libs$world_onscreen.PrepareUniforms(a);b.DITHER&&a.push("ditherIntensity")}static PrepareSamplers(a,b){b.COLORGRADING&&a.push("txColorTransform")}prepareDefines(a,b=!1){if(b===this.applyByPostProcess&&this._isEnabled){switch(a.VIGNETTE=this.vignetteEnabled,a.VIGNETTEBLENDMODEMULTIPLY=
this.vignetteBlendMode===pe$$module$libs$world_onscreen._VIGNETTEMODE_MULTIPLY,a.VIGNETTEBLENDMODEOPAQUE=!a.VIGNETTEBLENDMODEMULTIPLY,a.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType){case pe$$module$libs$world_onscreen.TONEMAPPING_ACES:a.TONEMAPPING_ACES=!0;break;default:a.TONEMAPPING_ACES=!1}a.CONTRAST=1!==this.contrast;a.EXPOSURE=1!==this.exposure;a.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves;a.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture;a.COLORGRADING?
a.COLORGRADING3D=this.colorGradingTexture.is3D:a.COLORGRADING3D=!1;a.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth;a.SAMPLER3DBGRMAP=this.colorGradingBGR;a.DITHER=this._ditheringEnabled;a.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess;a.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp;a.IMAGEPROCESSING=a.VIGNETTE||a.TONEMAPPING||a.CONTRAST||a.EXPOSURE||a.COLORCURVES||a.COLORGRADING||a.DITHER}else a.VIGNETTE=!1,a.TONEMAPPING=!1,a.TONEMAPPING_ACES=!1,a.CONTRAST=!1,a.EXPOSURE=!1,a.COLORCURVES=
!1,a.COLORGRADING=!1,a.COLORGRADING3D=!1,a.DITHER=!1,a.IMAGEPROCESSING=!1,a.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,a.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled}isReady(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()}bind(a,b){if(this._colorCurvesEnabled&&this.colorCurves&&xe$$module$libs$world_onscreen.Bind(this.colorCurves,a),this._vignetteEnabled||this._ditheringEnabled){var c=1/a.getEngine().getRenderWidth();const e=
1/a.getEngine().getRenderHeight();if(a.setFloat2("vInverseScreenSize",c,e),this._ditheringEnabled&&a.setFloat("ditherIntensity",.5*this._ditheringIntensity),this._vignetteEnabled){var d=Math.tan(.5*this.vignetteCameraFov);b=d*(b??e/c);c=Math.sqrt(b*d);b=X$$module$libs$world_onscreen.Mix(b,c,this.vignetteStretch);d=X$$module$libs$world_onscreen.Mix(d,c,this.vignetteStretch);a.setFloat4("vignetteSettings1",b,d,-b*this.vignetteCenterX,-d*this.vignetteCenterY);a.setFloat4("vignetteSettings2",this.vignetteColor.r,
this.vignetteColor.g,this.vignetteColor.b,-2*this.vignetteWeight)}}if(a.setFloat("exposureLinear",this.exposure),a.setFloat("contrast",this.contrast),this.colorGradingTexture)a.setTexture("txColorTransform",this.colorGradingTexture),d=this.colorGradingTexture.getSize().height,a.setFloat4("colorTransformSettings",(d-1)/d,.5/d,d,this.colorGradingTexture.level)}clone(){return ae$$module$libs$world_onscreen.Clone(()=>new pe$$module$libs$world_onscreen,this)}serialize(){return ae$$module$libs$world_onscreen.Serialize(this)}static Parse(a){const b=
ae$$module$libs$world_onscreen.Parse(()=>new pe$$module$libs$world_onscreen,a,null,null);return void 0!==a.vignetteCentreX&&(b.vignetteCenterX=a.vignetteCentreX),void 0!==a.vignetteCentreY&&(b.vignetteCenterY=a.vignetteCentreY),b}static get VIGNETTEMODE_MULTIPLY(){return this._VIGNETTEMODE_MULTIPLY}static get VIGNETTEMODE_OPAQUE(){return this._VIGNETTEMODE_OPAQUE}}pe$$module$libs$world_onscreen.TONEMAPPING_STANDARD=0;pe$$module$libs$world_onscreen.TONEMAPPING_ACES=1;
pe$$module$libs$world_onscreen._VIGNETTEMODE_MULTIPLY=0;pe$$module$libs$world_onscreen._VIGNETTEMODE_OPAQUE=1;T$$module$libs$world_onscreen([Pn$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"colorCurves",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_colorCurvesEnabled",void 0);
T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("colorGradingTexture")],pe$$module$libs$world_onscreen.prototype,"_colorGradingTexture",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_colorGradingEnabled",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_colorGradingWithGreenDepth",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_colorGradingBGR",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_exposure",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_toneMappingEnabled",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_toneMappingType",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_contrast",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"vignetteStretch",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"vignetteCenterX",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"vignetteCenterY",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"vignetteWeight",void 0);
T$$module$libs$world_onscreen([Fr$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"vignetteColor",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"vignetteCameraFov",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_vignetteBlendMode",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_vignetteEnabled",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_ditheringEnabled",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_ditheringIntensity",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_skipFinalColorClamp",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_applyByPostProcess",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],pe$$module$libs$world_onscreen.prototype,"_isEnabled",void 0);ae$$module$libs$world_onscreen._ImageProcessingConfigurationParser=pe$$module$libs$world_onscreen.Parse;
le$$module$libs$world_onscreen.prototype.createUniformBuffer=function(a){var b=this._gl.createBuffer();if(!b)throw Error("Unable to create uniform buffer");b=new Fi$$module$libs$world_onscreen(b);return this.bindUniformBuffer(b),a instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,a,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(a),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),b.references=1,b};
le$$module$libs$world_onscreen.prototype.createDynamicUniformBuffer=function(a){var b=this._gl.createBuffer();if(!b)throw Error("Unable to create dynamic uniform buffer");b=new Fi$$module$libs$world_onscreen(b);return this.bindUniformBuffer(b),a instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,a,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(a),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),b.references=1,b};
le$$module$libs$world_onscreen.prototype.updateUniformBuffer=function(a,b,c,d){this.bindUniformBuffer(a);void 0===c&&(c=0);void 0===d?b instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,c,b):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,c,new Float32Array(b)):b instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,b.subarray(c,c+d)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,(new Float32Array(b)).subarray(c,c+d));this.bindUniformBuffer(null)};
le$$module$libs$world_onscreen.prototype.bindUniformBuffer=function(a){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,a?a.underlyingResource:null)};le$$module$libs$world_onscreen.prototype.bindUniformBufferBase=function(a,b,c){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,b,a?a.underlyingResource:null)};le$$module$libs$world_onscreen.prototype.bindUniformBlock=function(a,b,c){a=a.program;b=this._gl.getUniformBlockIndex(a,b);4294967295!==b&&this._gl.uniformBlockBinding(a,b,c)};
class V$$module$libs$world_onscreen{constructor(a,b,c,d,e=!1){this._valueCache={};this._engine=a;this._noUBO=!a.supportsUniformBuffers||e;this._dynamic=c;this._name=d??"no-name";this._data=b||[];this._uniformLocations={};this._uniformSizes={};this._uniformArraySizes={};this._uniformLocationPointer=0;this._needSync=!1;this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0);this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,
this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateUIntArray=this._updateUIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,
this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect,this.updateUInt=this._updateUIntForEffect,this.updateUInt2=this._updateUInt2ForEffect,this.updateUInt3=
this._updateUInt3ForEffect,this.updateUInt4=this._updateUInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,
this.updateIntArray=this._updateIntArrayForUniform,this.updateUIntArray=this._updateUIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=
this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform,this.updateUInt=this._updateUIntForUniform,this.updateUInt2=this._updateUInt2ForUniform,this.updateUInt3=this._updateUInt3ForUniform,this.updateUInt4=this._updateUInt4ForUniform)}get useUbo(){return!this._noUBO}get isSync(){return!this._needSync}isDynamic(){return void 0!==this._dynamic}getData(){return this._bufferData}getBuffer(){return this._buffer}_fillAlignment(a){var b;if(2>=a?b=
a:b=4,0!==this._uniformLocationPointer%b)for(a=this._uniformLocationPointer,this._uniformLocationPointer+=b-this._uniformLocationPointer%b,b=this._uniformLocationPointer-a,a=0;a<b;a++)this._data.push(0)}addUniform(a,b,c=0){if(!this._noUBO&&void 0===this._uniformLocations[a]){if(0<c){if(b instanceof Array)throw"addUniform should not be use with Array in UBO: "+a;b=(this._fillAlignment(4),this._uniformArraySizes[a]={strideSize:b,arraySize:c},16==b)?b*c:b*c+(4-b)*c;c=[];for(var d=0;d<b;d++)c.push(0)}else{if(b instanceof
Array)c=b,b=c.length;else for(c=[],d=0;d<b;d++)c.push(0);this._fillAlignment(b)}this._uniformSizes[a]=b;this._uniformLocations[a]=this._uniformLocationPointer;this._uniformLocationPointer+=b;for(a=0;a<b;a++)this._data.push(c[a]);this._needSync=!0}}addMatrix(a,b){this.addUniform(a,Array.prototype.slice.call(b.toArray()))}addFloat2(a,b,c){this.addUniform(a,[b,c])}addFloat3(a,b,c,d){this.addUniform(a,[b,c,d])}addColor3(a,b){this.addUniform(a,[b.r,b.g,b.b])}addColor4(a,b,c){this.addUniform(a,[b.r,b.g,
b.b,c])}addVector3(a,b){this.addUniform(a,[b.x,b.y,b.z])}addMatrix3x3(a){this.addUniform(a,12)}addMatrix2x2(a){this.addUniform(a,8)}create(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)}_rebuild(){this._noUBO||!this._bufferData||(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData),this._engine._features.trackUbosInFrame&&
(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))}get _numBuffers(){return this._buffers.length}get _indexBuffer(){return this._bufferIndex}get name(){return this._name}_buffersEqual(a,b){for(let c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}_copyBuffer(a,b){for(let c=0;c<a.length;++c)b[c]=a[c]}update(){if(!this._noUBO)if(this.bindUniformBuffer(),this._buffer){if(this._dynamic||
this._needSync){if(this._buffers&&1<this._buffers.length&&this._buffers[this._bufferIndex][1]){if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1])){this._needSync=!1;this._createBufferOnWrite=this._engine._features.trackUbosInFrame;return}this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1])}this._engine.updateUniformBuffer(this._buffer,this._bufferData);this._engine._features._collectUbosUpdatedInFrame&&(V$$module$libs$world_onscreen._UpdatedUbosInFrame[this._name]||
(V$$module$libs$world_onscreen._UpdatedUbosInFrame[this._name]=0),V$$module$libs$world_onscreen._UpdatedUbosInFrame[this._name]++);this._needSync=!1}this._createBufferOnWrite=this._engine._features.trackUbosInFrame}else this.create()}_createNewBuffer(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()}_checkNewFrame(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==
this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&0<this._buffers.length?(this._needSync=0!==this._bufferIndex,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)}updateUniform(a,b,c){this._checkNewFrame();let d=this._uniformLocations[a];if(void 0===d){if(this._buffer){O$$module$libs$world_onscreen.Error("Cannot add an uniform after UBO has been created.");return}this.addUniform(a,c);d=this._uniformLocations[a]}if(this._buffer||
this.create(),this._dynamic)for(a=0;a<c;a++)this._bufferData[d+a]=b[a];else{a=!1;for(let e=0;e<c;e++)(16===c&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[d+e]!==X$$module$libs$world_onscreen.FloatRound(b[e]))&&(a=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[d+e]=b[e]);this._needSync=this._needSync||a}}updateUniformArray(a,b,c){this._checkNewFrame();const d=this._uniformLocations[a];if(void 0===d)O$$module$libs$world_onscreen.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform and make sure that uniform buffers are supported by the current engine.");
else if(this._buffer||this.create(),a=this._uniformArraySizes[a],this._dynamic)for(a=0;a<c;a++)this._bufferData[d+a]=b[a];else{let e=!1,g=0,n=0;for(let t=0;t<c;t++)if(this._bufferData[d+4*n+g]!==X$$module$libs$world_onscreen.FloatRound(b[t])&&(e=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[d+4*n+g]=b[t]),g++,g===a.strideSize){for(;4>g;g++)this._bufferData[d+4*n+g]=0;g=0;n++}this._needSync=this._needSync||e}}_cacheMatrix(a,b){this._checkNewFrame();const c=this._valueCache[a];
b=b.updateFlag;return void 0!==c&&c===b?!1:(this._valueCache[a]=b,!0)}_updateMatrix3x3ForUniform(a,b){for(let c=0;3>c;c++)V$$module$libs$world_onscreen._TempBuffer[4*c]=b[3*c],V$$module$libs$world_onscreen._TempBuffer[4*c+1]=b[3*c+1],V$$module$libs$world_onscreen._TempBuffer[4*c+2]=b[3*c+2],V$$module$libs$world_onscreen._TempBuffer[4*c+3]=0;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,12)}_updateMatrix3x3ForEffect(a,b){this._currentEffect.setMatrix3x3(a,b)}_updateMatrix2x2ForEffect(a,
b){this._currentEffect.setMatrix2x2(a,b)}_updateMatrix2x2ForUniform(a,b){for(let c=0;2>c;c++)V$$module$libs$world_onscreen._TempBuffer[4*c]=b[2*c],V$$module$libs$world_onscreen._TempBuffer[4*c+1]=b[2*c+1],V$$module$libs$world_onscreen._TempBuffer[4*c+2]=0,V$$module$libs$world_onscreen._TempBuffer[4*c+3]=0;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,8)}_updateFloatForEffect(a,b){this._currentEffect.setFloat(a,b)}_updateFloatForUniform(a,b){V$$module$libs$world_onscreen._TempBuffer[0]=
b;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,1)}_updateFloat2ForEffect(a,b,c,d=""){this._currentEffect.setFloat2(a+d,b,c)}_updateFloat2ForUniform(a,b,c){V$$module$libs$world_onscreen._TempBuffer[0]=b;V$$module$libs$world_onscreen._TempBuffer[1]=c;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,2)}_updateFloat3ForEffect(a,b,c,d,e=""){this._currentEffect.setFloat3(a+e,b,c,d)}_updateFloat3ForUniform(a,b,c,d){V$$module$libs$world_onscreen._TempBuffer[0]=b;V$$module$libs$world_onscreen._TempBuffer[1]=
c;V$$module$libs$world_onscreen._TempBuffer[2]=d;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,3)}_updateFloat4ForEffect(a,b,c,d,e,g=""){this._currentEffect.setFloat4(a+g,b,c,d,e)}_updateFloat4ForUniform(a,b,c,d,e){V$$module$libs$world_onscreen._TempBuffer[0]=b;V$$module$libs$world_onscreen._TempBuffer[1]=c;V$$module$libs$world_onscreen._TempBuffer[2]=d;V$$module$libs$world_onscreen._TempBuffer[3]=e;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,4)}_updateFloatArrayForEffect(a,
b){this._currentEffect.setFloatArray(a,b)}_updateFloatArrayForUniform(a,b){this.updateUniformArray(a,b,b.length)}_updateArrayForEffect(a,b){this._currentEffect.setArray(a,b)}_updateArrayForUniform(a,b){this.updateUniformArray(a,b,b.length)}_updateIntArrayForEffect(a,b){this._currentEffect.setIntArray(a,b)}_updateIntArrayForUniform(a,b){V$$module$libs$world_onscreen._TempBufferInt32View.set(b);this.updateUniformArray(a,V$$module$libs$world_onscreen._TempBuffer,b.length)}_updateUIntArrayForEffect(a,
b){this._currentEffect.setUIntArray(a,b)}_updateUIntArrayForUniform(a,b){V$$module$libs$world_onscreen._TempBufferUInt32View.set(b);this.updateUniformArray(a,V$$module$libs$world_onscreen._TempBuffer,b.length)}_updateMatrixForEffect(a,b){this._currentEffect.setMatrix(a,b)}_updateMatrixForUniform(a,b){this._cacheMatrix(a,b)&&this.updateUniform(a,b.toArray(),16)}_updateMatricesForEffect(a,b){this._currentEffect.setMatrices(a,b)}_updateMatricesForUniform(a,b){this.updateUniform(a,b,b.length)}_updateVector3ForEffect(a,
b){this._currentEffect.setVector3(a,b)}_updateVector3ForUniform(a,b){V$$module$libs$world_onscreen._TempBuffer[0]=b.x;V$$module$libs$world_onscreen._TempBuffer[1]=b.y;V$$module$libs$world_onscreen._TempBuffer[2]=b.z;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,3)}_updateVector4ForEffect(a,b){this._currentEffect.setVector4(a,b)}_updateVector4ForUniform(a,b){V$$module$libs$world_onscreen._TempBuffer[0]=b.x;V$$module$libs$world_onscreen._TempBuffer[1]=b.y;V$$module$libs$world_onscreen._TempBuffer[2]=
b.z;V$$module$libs$world_onscreen._TempBuffer[3]=b.w;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,4)}_updateColor3ForEffect(a,b,c=""){this._currentEffect.setColor3(a+c,b)}_updateColor3ForUniform(a,b){V$$module$libs$world_onscreen._TempBuffer[0]=b.r;V$$module$libs$world_onscreen._TempBuffer[1]=b.g;V$$module$libs$world_onscreen._TempBuffer[2]=b.b;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,3)}_updateColor4ForEffect(a,b,c,d=""){this._currentEffect.setColor4(a+d,b,
c)}_updateDirectColor4ForEffect(a,b,c=""){this._currentEffect.setDirectColor4(a+c,b)}_updateColor4ForUniform(a,b,c){V$$module$libs$world_onscreen._TempBuffer[0]=b.r;V$$module$libs$world_onscreen._TempBuffer[1]=b.g;V$$module$libs$world_onscreen._TempBuffer[2]=b.b;V$$module$libs$world_onscreen._TempBuffer[3]=c;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,4)}_updateDirectColor4ForUniform(a,b){V$$module$libs$world_onscreen._TempBuffer[0]=b.r;V$$module$libs$world_onscreen._TempBuffer[1]=
b.g;V$$module$libs$world_onscreen._TempBuffer[2]=b.b;V$$module$libs$world_onscreen._TempBuffer[3]=b.a;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,4)}_updateIntForEffect(a,b,c=""){this._currentEffect.setInt(a+c,b)}_updateIntForUniform(a,b){V$$module$libs$world_onscreen._TempBufferInt32View[0]=b;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,1)}_updateInt2ForEffect(a,b,c,d=""){this._currentEffect.setInt2(a+d,b,c)}_updateInt2ForUniform(a,b,c){V$$module$libs$world_onscreen._TempBufferInt32View[0]=
b;V$$module$libs$world_onscreen._TempBufferInt32View[1]=c;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,2)}_updateInt3ForEffect(a,b,c,d,e=""){this._currentEffect.setInt3(a+e,b,c,d)}_updateInt3ForUniform(a,b,c,d){V$$module$libs$world_onscreen._TempBufferInt32View[0]=b;V$$module$libs$world_onscreen._TempBufferInt32View[1]=c;V$$module$libs$world_onscreen._TempBufferInt32View[2]=d;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,3)}_updateInt4ForEffect(a,b,c,d,e,g=""){this._currentEffect.setInt4(a+
g,b,c,d,e)}_updateInt4ForUniform(a,b,c,d,e){V$$module$libs$world_onscreen._TempBufferInt32View[0]=b;V$$module$libs$world_onscreen._TempBufferInt32View[1]=c;V$$module$libs$world_onscreen._TempBufferInt32View[2]=d;V$$module$libs$world_onscreen._TempBufferInt32View[3]=e;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,4)}_updateUIntForEffect(a,b,c=""){this._currentEffect.setUInt(a+c,b)}_updateUIntForUniform(a,b){V$$module$libs$world_onscreen._TempBufferUInt32View[0]=b;this.updateUniform(a,
V$$module$libs$world_onscreen._TempBuffer,1)}_updateUInt2ForEffect(a,b,c,d=""){this._currentEffect.setUInt2(a+d,b,c)}_updateUInt2ForUniform(a,b,c){V$$module$libs$world_onscreen._TempBufferUInt32View[0]=b;V$$module$libs$world_onscreen._TempBufferUInt32View[1]=c;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,2)}_updateUInt3ForEffect(a,b,c,d,e=""){this._currentEffect.setUInt3(a+e,b,c,d)}_updateUInt3ForUniform(a,b,c,d){V$$module$libs$world_onscreen._TempBufferUInt32View[0]=b;V$$module$libs$world_onscreen._TempBufferUInt32View[1]=
c;V$$module$libs$world_onscreen._TempBufferUInt32View[2]=d;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,3)}_updateUInt4ForEffect(a,b,c,d,e,g=""){this._currentEffect.setUInt4(a+g,b,c,d,e)}_updateUInt4ForUniform(a,b,c,d,e){V$$module$libs$world_onscreen._TempBufferUInt32View[0]=b;V$$module$libs$world_onscreen._TempBufferUInt32View[1]=c;V$$module$libs$world_onscreen._TempBufferUInt32View[2]=d;V$$module$libs$world_onscreen._TempBufferUInt32View[3]=e;this.updateUniform(a,V$$module$libs$world_onscreen._TempBuffer,
4)}setTexture(a,b){this._currentEffect.setTexture(a,b)}updateUniformDirectly(a,b){this.updateUniform(a,b,b.length);this.update()}bindToEffect(a,b){this._currentEffect=a;this._currentEffectName=b}bindUniformBuffer(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)}unbindEffect(){this._currentEffectName=this._currentEffect=void 0}setDataBuffer(a){if(!this._buffers)return this._buffer===a;for(let b=0;b<this._buffers.length;++b)if(this._buffers[b][0]===
a)return this._bufferIndex=b,this._buffer=a,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0;return!1}dispose(){if(!this._noUBO){var a=this._engine._uniformBuffers,b=a.indexOf(this);if(-1!==b&&(a[b]=a[a.length-1],a.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(a=0;a<this._buffers.length;++a)this._engine._releaseBuffer(this._buffers[a][0]);else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}}}
V$$module$libs$world_onscreen._UpdatedUbosInFrame={};V$$module$libs$world_onscreen._MAX_UNIFORM_SIZE=256;V$$module$libs$world_onscreen._TempBuffer=new Float32Array(V$$module$libs$world_onscreen._MAX_UNIFORM_SIZE);V$$module$libs$world_onscreen._TempBufferInt32View=new Int32Array(V$$module$libs$world_onscreen._TempBuffer.buffer);V$$module$libs$world_onscreen._TempBufferUInt32View=new Uint32Array(V$$module$libs$world_onscreen._TempBuffer.buffer);
class es$$module$libs$world_onscreen{constructor(a,b,c,d=0,e=!1,g=!1,n=!1,t){this._isAlreadyOwned=!1;a.getScene?this._engine=a.getScene().getEngine():this._engine=a;this._updatable=c;this._instanced=g;this._divisor=t||1;b instanceof ki$$module$libs$world_onscreen?(this._data=null,this._buffer=b):(this._data=b,this._buffer=null);this.byteStride=n?d:d*Float32Array.BYTES_PER_ELEMENT;e||this.create()}createVertexBuffer(a,b,c,d,e,g=!1,n){return new g$$module$libs$world_onscreen(this._engine,this,a,this._updatable,
!0,d?g?d:d*Float32Array.BYTES_PER_ELEMENT:this.byteStride,void 0===e?this._instanced:e,g?b:b*Float32Array.BYTES_PER_ELEMENT,c,void 0,void 0,!0,this._divisor||n)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(a=null){!a&&this._buffer||(a=a||this._data,a&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,a),this._data=a):this._updatable?(this._buffer=
this._engine.createDynamicVertexBuffer(a),this._data=a):this._buffer=this._engine.createVertexBuffer(a)))}_rebuild(){this._buffer=null;this.create(this._data)}update(a){this.create(a)}updateDirectly(a,b,c,d=!1){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,a,d?b:b*Float32Array.BYTES_PER_ELEMENT,c?c*this.byteStride:void 0),0===b&&void 0===c?this._data=a:this._data=null)}_increaseReferences(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=
!0)}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)}}
class g$$module$libs$world_onscreen{constructor(a,b,c,d,e,g,n,t,w,z,C=!1,H=!1,M=1,L=!1){(b instanceof es$$module$libs$world_onscreen?(this._buffer=b,this._ownsBuffer=L):(this._buffer=new es$$module$libs$world_onscreen(a,b,d,g,e,n,H),this._ownsBuffer=!0),this.uniqueId=g$$module$libs$world_onscreen._Counter++,this._kind=c,null==z)?(a=this.getData(),this.type=g$$module$libs$world_onscreen.FLOAT,a instanceof Int8Array?this.type=g$$module$libs$world_onscreen.BYTE:a instanceof Uint8Array?this.type=g$$module$libs$world_onscreen.UNSIGNED_BYTE:
a instanceof Int16Array?this.type=g$$module$libs$world_onscreen.SHORT:a instanceof Uint16Array?this.type=g$$module$libs$world_onscreen.UNSIGNED_SHORT:a instanceof Int32Array?this.type=g$$module$libs$world_onscreen.INT:a instanceof Uint32Array&&(this.type=g$$module$libs$world_onscreen.UNSIGNED_INT)):this.type=z;a=g$$module$libs$world_onscreen.GetTypeByteLength(this.type);H?(this._size=w||(g?g/a:g$$module$libs$world_onscreen.DeduceStride(c)),this.byteStride=g||this._buffer.byteStride||this._size*a,
this.byteOffset=t||0):(this._size=w||g||g$$module$libs$world_onscreen.DeduceStride(c),this.byteStride=g?g*a:this._buffer.byteStride||this._size*a,this.byteOffset=(t||0)*a);this.normalized=C;this._instanced=void 0!==n?n:!1;this._instanceDivisor=n?M:0;this._computeHashCode()}get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(a){const b=0!=a;this._instanceDivisor=a;b!==this._instanced&&(this._instanced=b,this._computeHashCode())}_computeHashCode(){this.hashCode=(this.type-5120<<0)+
((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){this._buffer&&this._buffer._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(a,b){var c=this.getData();if(!c)return null;var d=this.getSize()*g$$module$libs$world_onscreen.GetTypeByteLength(this.type);a*=this.getSize();if(this.type!==g$$module$libs$world_onscreen.FLOAT||this.byteStride!==d){const e=new Float32Array(a);
return this.forEach(a,(g,n)=>e[n]=g),e}if(!(c instanceof Array||c instanceof Float32Array)||0!==this.byteOffset||c.length!==a){if(c instanceof Array)return b=this.byteOffset/4,c.slice(b,b+a);if(c instanceof ArrayBuffer)return new Float32Array(c,this.byteOffset,a);d=c.byteOffset+this.byteOffset;if(b)return b=new Float32Array(a),c=new Float32Array(c.buffer,d,a),b.set(c),b;b=d%4;return b&&(d=Math.max(0,d-b)),new Float32Array(c.buffer,d,a)}return b?c.slice():c}getBuffer(){return this._buffer.getBuffer()}getStrideSize(){return this.byteStride/
g$$module$libs$world_onscreen.GetTypeByteLength(this.type)}getOffset(){return this.byteOffset/g$$module$libs$world_onscreen.GetTypeByteLength(this.type)}getSize(a=!1){return a?this._size*g$$module$libs$world_onscreen.GetTypeByteLength(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(a){this._buffer.create(a)}update(a){this._buffer.update(a)}updateDirectly(a,b,c=!1){this._buffer.updateDirectly(a,b,void 0,c)}dispose(){this._ownsBuffer&&
this._buffer.dispose()}forEach(a,b){g$$module$libs$world_onscreen.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,a,this.normalized,b)}static DeduceStride(a){switch(a){case g$$module$libs$world_onscreen.UVKind:case g$$module$libs$world_onscreen.UV2Kind:case g$$module$libs$world_onscreen.UV3Kind:case g$$module$libs$world_onscreen.UV4Kind:case g$$module$libs$world_onscreen.UV5Kind:case g$$module$libs$world_onscreen.UV6Kind:return 2;case g$$module$libs$world_onscreen.NormalKind:case g$$module$libs$world_onscreen.PositionKind:return 3;
case g$$module$libs$world_onscreen.ColorKind:case g$$module$libs$world_onscreen.MatricesIndicesKind:case g$$module$libs$world_onscreen.MatricesIndicesExtraKind:case g$$module$libs$world_onscreen.MatricesWeightsKind:case g$$module$libs$world_onscreen.MatricesWeightsExtraKind:case g$$module$libs$world_onscreen.TangentKind:return 4;default:throw Error("Invalid kind '"+a+"'");}}static GetTypeByteLength(a){switch(a){case g$$module$libs$world_onscreen.BYTE:case g$$module$libs$world_onscreen.UNSIGNED_BYTE:return 1;
case g$$module$libs$world_onscreen.SHORT:case g$$module$libs$world_onscreen.UNSIGNED_SHORT:return 2;case g$$module$libs$world_onscreen.INT:case g$$module$libs$world_onscreen.UNSIGNED_INT:case g$$module$libs$world_onscreen.FLOAT:return 4;default:throw Error(`Invalid type '${a}'`);}}static ForEach(a,b,c,d,e,g,n,t){if(a instanceof Array)for(b/=4,c/=4,e=0;e<g;e+=d){for(n=0;n<d;n++)t(a[b+n],e+n);b+=c}else{a=a instanceof ArrayBuffer?new DataView(a):new DataView(a.buffer,a.byteOffset,a.byteLength);const w=
g$$module$libs$world_onscreen.GetTypeByteLength(e);for(let z=0;z<g;z+=d){let C=b;for(let H=0;H<d;H++){const M=g$$module$libs$world_onscreen._GetFloatValue(a,e,C,n);t(M,z+H);C+=w}b+=c}}}static _GetFloatValue(a,b,c,d){switch(b){case g$$module$libs$world_onscreen.BYTE:return a=a.getInt8(c),d&&(a=Math.max(a/127,-1)),a;case g$$module$libs$world_onscreen.UNSIGNED_BYTE:return a=a.getUint8(c),d&&(a/=255),a;case g$$module$libs$world_onscreen.SHORT:return a=a.getInt16(c,!0),d&&(a=Math.max(a/32767,-1)),a;case g$$module$libs$world_onscreen.UNSIGNED_SHORT:return a=
a.getUint16(c,!0),d&&(a/=65535),a;case g$$module$libs$world_onscreen.INT:return a.getInt32(c,!0);case g$$module$libs$world_onscreen.UNSIGNED_INT:return a.getUint32(c,!0);case g$$module$libs$world_onscreen.FLOAT:return a.getFloat32(c,!0);default:throw Error(`Invalid component type ${b}`);}}}g$$module$libs$world_onscreen._Counter=0;g$$module$libs$world_onscreen.BYTE=5120;g$$module$libs$world_onscreen.UNSIGNED_BYTE=5121;g$$module$libs$world_onscreen.SHORT=5122;
g$$module$libs$world_onscreen.UNSIGNED_SHORT=5123;g$$module$libs$world_onscreen.INT=5124;g$$module$libs$world_onscreen.UNSIGNED_INT=5125;g$$module$libs$world_onscreen.FLOAT=5126;g$$module$libs$world_onscreen.PositionKind="position";g$$module$libs$world_onscreen.NormalKind="normal";g$$module$libs$world_onscreen.TangentKind="tangent";g$$module$libs$world_onscreen.UVKind="uv";g$$module$libs$world_onscreen.UV2Kind="uv2";g$$module$libs$world_onscreen.UV3Kind="uv3";
g$$module$libs$world_onscreen.UV4Kind="uv4";g$$module$libs$world_onscreen.UV5Kind="uv5";g$$module$libs$world_onscreen.UV6Kind="uv6";g$$module$libs$world_onscreen.ColorKind="color";g$$module$libs$world_onscreen.ColorInstanceKind="instanceColor";g$$module$libs$world_onscreen.MatricesIndicesKind="matricesIndices";g$$module$libs$world_onscreen.MatricesWeightsKind="matricesWeights";g$$module$libs$world_onscreen.MatricesIndicesExtraKind="matricesIndicesExtra";
g$$module$libs$world_onscreen.MatricesWeightsExtraKind="matricesWeightsExtra";
class zt$$module$libs$world_onscreen{constructor(){this.hit=!1;this.distance=0;this.pickedMesh=this.pickedPoint=null;this.bv=this.bu=0;this.subMeshFaceId=this.faceId=-1;this.subMeshId=0;this.pickedSprite=null;this.thinInstanceIndex=-1;this.gripTransform=this.aimTransform=this.originMesh=this.ray=null}getNormal(a=!1,b=!0){if(!this.pickedMesh||b&&!this.pickedMesh.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind))return null;var c=this.pickedMesh.getIndices();if(!c)return null;if(b){var d=
this.pickedMesh.getVerticesData(g$$module$libs$world_onscreen.NormalKind);b=p$$module$libs$world_onscreen.FromArray(d,3*c[3*this.faceId]);var e=p$$module$libs$world_onscreen.FromArray(d,3*c[3*this.faceId+1]);c=p$$module$libs$world_onscreen.FromArray(d,3*c[3*this.faceId+2]);b=b.scale(this.bu);e=e.scale(this.bv);c=c.scale(1-this.bu-this.bv);c=new p$$module$libs$world_onscreen(b.x+e.x+c.x,b.y+e.y+c.y,b.z+e.z+c.z)}else d=this.pickedMesh.getVerticesData(g$$module$libs$world_onscreen.PositionKind),e=p$$module$libs$world_onscreen.FromArray(d,
3*c[3*this.faceId]),b=p$$module$libs$world_onscreen.FromArray(d,3*c[3*this.faceId+1]),c=p$$module$libs$world_onscreen.FromArray(d,3*c[3*this.faceId+2]),e=e.subtract(b),c=c.subtract(b),c=p$$module$libs$world_onscreen.Cross(e,c);b=(g,n)=>{let t=g.getWorldMatrix();g.nonUniformScaling&&(D$$module$libs$world_onscreen.Matrix[0].copyFrom(t),t=D$$module$libs$world_onscreen.Matrix[0],t.setTranslationFromFloats(0,0,0),t.invert(),t.transposeToRef(D$$module$libs$world_onscreen.Matrix[1]),t=D$$module$libs$world_onscreen.Matrix[1]);
p$$module$libs$world_onscreen.TransformNormalToRef(n,t,n)};if(a&&b(this.pickedMesh,c),this.ray)e=D$$module$libs$world_onscreen.Vector3[0].copyFrom(c),a||b(this.pickedMesh,e),0<p$$module$libs$world_onscreen.Dot(e,this.ray.direction)&&c.negateInPlace();return c.normalize(),c}getTextureCoordinates(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind))return null;var a=this.pickedMesh.getIndices();if(!a)return null;const b=this.pickedMesh.getVerticesData(g$$module$libs$world_onscreen.UVKind);
if(!b)return null;let c=Te$$module$libs$world_onscreen.FromArray(b,2*a[3*this.faceId]),d=Te$$module$libs$world_onscreen.FromArray(b,2*a[3*this.faceId+1]);a=Te$$module$libs$world_onscreen.FromArray(b,2*a[3*this.faceId+2]);return c=c.scale(this.bu),d=d.scale(this.bv),a=a.scale(1-this.bu-this.bv),new Te$$module$libs$world_onscreen(c.x+d.x+a.x,c.y+d.y+a.y)}}
class We$$module$libs$world_onscreen{constructor(a,b,c,d,e,g){this.source=a;this.pointerX=b;this.pointerY=c;this.meshUnderPointer=d;this.sourceEvent=e;this.additionalData=g}static CreateNew(a,b,c){const d=a.getScene();return new We$$module$libs$world_onscreen(a,d.pointerX,d.pointerY,d.meshUnderPointer||a,b,c)}static CreateNewFromSprite(a,b,c,d){return new We$$module$libs$world_onscreen(a,b.pointerX,b.pointerY,b.meshUnderPointer,c,d)}static CreateNewFromScene(a,b){return new We$$module$libs$world_onscreen(null,
a.pointerX,a.pointerY,a.meshUnderPointer,b)}static CreateNewFromPrimitive(a,b,c,d){return new We$$module$libs$world_onscreen(a,b.x,b.y,null,c,d)}}
class ts$$module$libs$world_onscreen{constructor(a){this._vertexBuffers={};this._scene=a}_prepareBuffers(){if(!this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind]){var a=[];a.push(1,1);a.push(-1,1);a.push(-1,-1);a.push(1,-1);this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind]=new g$$module$libs$world_onscreen(this._scene.getEngine(),a,g$$module$libs$world_onscreen.PositionKind,!1,!1,2);this._buildIndexBuffer()}}_buildIndexBuffer(){const a=[];a.push(0);a.push(1);a.push(2);a.push(0);
a.push(2);a.push(3);this._indexBuffer=this._scene.getEngine().createIndexBuffer(a)}_rebuild(){const a=this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind];a&&(a._rebuild(),this._buildIndexBuffer())}_prepareFrame(a=null,b=null){const c=this._scene.activeCamera;return c&&(b=b||c._postProcesses.filter(d=>null!=d),b&&0!==b.length&&this._scene.postProcessesEnabled)?(b[0].activate(c,a,null!=b),!0):!1}directRender(a,b=null,c=!1,d=0,e=0,g=!1){var n;const t=this._scene.getEngine();for(let w=0;w<
a.length;w++){w<a.length-1?a[w+1].activate(this._scene.activeCamera,null==b?void 0:b.texture):(b?t.bindFramebuffer(b,d,void 0,void 0,c,e):g||t.restoreDefaultFramebuffer(),null===(n=t._debugInsertMarker)||void 0===n||n.call(t,`post process ${a[w].name} output`));const z=a[w],C=z.apply();C&&(z.onBeforeRenderObservable.notifyObservers(C),this._prepareBuffers(),t.bindBuffers(this._vertexBuffers,this._indexBuffer,C),t.drawElementsType(0,0,6),z.onAfterRenderObservable.notifyObservers(C))}t.setDepthBuffer(!0);
t.setDepthWrite(!0)}_finalizeFrame(a,b,c,d,e=!1){var g;const n=this._scene.activeCamera;if(n&&(d=d||n._postProcesses.filter(w=>null!=w),0!==d.length&&this._scene.postProcessesEnabled)){var t=this._scene.getEngine();for(let w=0,z=d.length;w<z;w++){const C=d[w];if(w<z-1?C._outputTexture=d[w+1].activate(n,null==b?void 0:b.texture):(b?(t.bindFramebuffer(b,c,void 0,void 0,e),C._outputTexture=b):(t.restoreDefaultFramebuffer(),C._outputTexture=null),null===(g=t._debugInsertMarker)||void 0===g||g.call(t,
`post process ${d[w].name} output`)),a)break;const H=C.apply();H&&(C.onBeforeRenderObservable.notifyObservers(H),this._prepareBuffers(),t.bindBuffers(this._vertexBuffers,this._indexBuffer,H),t.drawElementsType(0,0,6),C.onAfterRenderObservable.notifyObservers(H))}t.setDepthBuffer(!0);t.setDepthWrite(!0);t.setAlphaMode(0)}}dispose(){const a=this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind];a&&(a.dispose(),this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind]=null);this._indexBuffer&&
(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}
class Tt$$module$libs$world_onscreen{constructor(a,b,c=null,d=null,e=null){this.index=a;this._opaqueSubMeshes=new $e$$module$libs$world_onscreen(256);this._transparentSubMeshes=new $e$$module$libs$world_onscreen(256);this._alphaTestSubMeshes=new $e$$module$libs$world_onscreen(256);this._depthOnlySubMeshes=new $e$$module$libs$world_onscreen(256);this._particleSystems=new $e$$module$libs$world_onscreen(256);this._spriteManagers=new $e$$module$libs$world_onscreen(256);this._empty=!0;this._edgesRenderers=
new ii$$module$libs$world_onscreen(16);this._scene=b;this.opaqueSortCompareFn=c;this.alphaTestSortCompareFn=d;this.transparentSortCompareFn=e}set opaqueSortCompareFn(a){a?this._opaqueSortCompareFn=a:this._opaqueSortCompareFn=Tt$$module$libs$world_onscreen.PainterSortCompare;this._renderOpaque=this._renderOpaqueSorted}set alphaTestSortCompareFn(a){a?this._alphaTestSortCompareFn=a:this._alphaTestSortCompareFn=Tt$$module$libs$world_onscreen.PainterSortCompare;this._renderAlphaTest=this._renderAlphaTestSorted}set transparentSortCompareFn(a){a?
this._transparentSortCompareFn=a:this._transparentSortCompareFn=Tt$$module$libs$world_onscreen.defaultTransparentSortCompare;this._renderTransparent=this._renderTransparentSorted}render(a,b,c,d){if(a)a(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);else{a=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(a.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),a.setColorWrite(!0));0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes);
0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);var e=a.getStencilBuffer();if(a.setStencilBuffer(!1),b&&this._renderSprites(),c&&this._renderParticles(d),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length||this._scene.useOrderIndependentTransparency)(a.setStencilBuffer(e),this._scene.useOrderIndependentTransparency)?(b=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes),b.length&&this._renderTransparent(b)):
this._renderTransparent(this._transparentSubMeshes),a.setAlphaMode(0);if(a.setStencilBuffer(!1),this._edgesRenderers.length){for(b=0;b<this._edgesRenderers.length;b++)this._edgesRenderers.data[b].render();a.setAlphaMode(0)}a.setStencilBuffer(e)}}_renderOpaqueSorted(a){return Tt$$module$libs$world_onscreen._RenderSorted(a,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}_renderAlphaTestSorted(a){return Tt$$module$libs$world_onscreen._RenderSorted(a,this._alphaTestSortCompareFn,this._scene.activeCamera,
!1)}_renderTransparentSorted(a){return Tt$$module$libs$world_onscreen._RenderSorted(a,this._transparentSortCompareFn,this._scene.activeCamera,!0)}static _RenderSorted(a,b,c,d){let e=0,g;c=c?c.globalPosition:Tt$$module$libs$world_onscreen._ZeroVector;if(d)for(;e<a.length;e++)g=a.data[e],g._alphaIndex=g.getMesh().alphaIndex,g._distanceToCamera=p$$module$libs$world_onscreen.Distance(g.getBoundingInfo().boundingSphere.centerWorld,c);a=a.length===a.data.length?a.data:a.data.slice(0,a.length);b&&a.sort(b);
b=a[0].getMesh().getScene();for(e=0;e<a.length;e++)if(g=a[e],!b._activeMeshesFrozenButKeepClipping||g.isInFrustum(b._frustumPlanes))d&&(c=g.getMaterial())&&c.needDepthPrePass&&(c=c.getScene().getEngine(),c.setColorWrite(!1),c.setAlphaMode(0),g.render(!1),c.setColorWrite(!0)),g.render(d)}static defaultTransparentSortCompare(a,b){return a._alphaIndex>b._alphaIndex?1:a._alphaIndex<b._alphaIndex?-1:Tt$$module$libs$world_onscreen.backToFrontSortCompare(a,b)}static backToFrontSortCompare(a,b){return a._distanceToCamera<
b._distanceToCamera?1:a._distanceToCamera>b._distanceToCamera?-1:0}static frontToBackSortCompare(a,b){return a._distanceToCamera<b._distanceToCamera?-1:a._distanceToCamera>b._distanceToCamera?1:0}static PainterSortCompare(a,b){a=a.getMesh();b=b.getMesh();return a.material&&b.material?a.material.uniqueId-b.material.uniqueId:a.uniqueId-b.uniqueId}prepare(){this._opaqueSubMeshes.reset();this._transparentSubMeshes.reset();this._alphaTestSubMeshes.reset();this._depthOnlySubMeshes.reset();this._particleSystems.reset();
this.prepareSprites();this._edgesRenderers.reset();this._empty=!0}prepareSprites(){this._spriteManagers.reset()}dispose(){this._opaqueSubMeshes.dispose();this._transparentSubMeshes.dispose();this._alphaTestSubMeshes.dispose();this._depthOnlySubMeshes.dispose();this._particleSystems.dispose();this._spriteManagers.dispose();this._edgesRenderers.dispose()}dispatch(a,b,c){void 0===b&&(b=a.getMesh());void 0===c&&(c=a.getMaterial());null!=c&&(c.needAlphaBlendingForMesh(b)?this._transparentSubMeshes.push(a):
c.needAlphaTesting()?(c.needDepthPrePass&&this._depthOnlySubMeshes.push(a),this._alphaTestSubMeshes.push(a)):(c.needDepthPrePass&&this._depthOnlySubMeshes.push(a),this._opaqueSubMeshes.push(a)),b._renderingGroup=this,b._edgesRenderer&&b._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(b._edgesRenderer),this._empty=!1)}dispatchSprites(a){this._spriteManagers.push(a);this._empty=!1}dispatchParticles(a){this._particleSystems.push(a);this._empty=!1}_renderParticles(a){if(0!==this._particleSystems.length){var b=
this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(let c=0;c<this._particleSystems.length;c++){const d=this._particleSystems.data[c];if(0===(b&&b.layerMask&d.layerMask))continue;const e=d.emitter;e.position&&a&&-1===a.indexOf(e)||this._scene._activeParticles.addCount(d.render(),!1)}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}}_renderSprites(){if(this._scene.spritesEnabled&&0!==this._spriteManagers.length){var a=
this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(let b=0;b<this._spriteManagers.length;b++){const c=this._spriteManagers.data[b];0!==(a&&a.layerMask&c.layerMask)&&c.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}}Tt$$module$libs$world_onscreen._ZeroVector=p$$module$libs$world_onscreen.Zero();class Fn$$module$libs$world_onscreen{}
class ze$$module$libs$world_onscreen{constructor(a){this._useSceneAutoClearSetup=!1;this._renderingGroups=[];this._autoClearDepthStencil={};this._customOpaqueSortCompareFn={};this._customAlphaTestSortCompareFn={};this._customTransparentSortCompareFn={};this._renderingGroupInfo=new Fn$$module$libs$world_onscreen;this._maintainStateBetweenFrames=!1;this._scene=a;for(a=ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;a<ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS;a++)this._autoClearDepthStencil[a]=
{autoClear:!0,depth:!0,stencil:!0}}get maintainStateBetweenFrames(){return this._maintainStateBetweenFrames}set maintainStateBetweenFrames(a){if(a!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=a,!this._maintainStateBetweenFrames)){for(const b of this._scene.meshes)if(b.subMeshes)for(const c of b.subMeshes)c._wasDispatched=!1;for(const b of this._scene.spriteManagers)b._wasDispatched=!1;for(const b of this._scene.particleSystems)b._wasDispatched=!1}}getRenderingGroup(a){a=a||
0;return this._prepareRenderingGroup(a),this._renderingGroups[a]}_clearDepthStencilBuffer(a=!0,b=!0){this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,a,b),this._depthStencilBufferAlreadyCleaned=!0)}render(a,b,c,d){const e=this._renderingGroupInfo;if(e.scene=this._scene,e.camera=this._scene.activeCamera,this._scene.spriteManagers&&d)for(var g=0;g<this._scene.spriteManagers.length;g++)this.dispatchSprites(this._scene.spriteManagers[g]);for(g=ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;g<
ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS;g++){this._depthStencilBufferAlreadyCleaned=g===ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;const n=this._renderingGroups[g];if(!n||n._empty)continue;const t=Math.pow(2,g);if(e.renderingGroupId=g,this._scene.onBeforeRenderingGroupObservable.notifyObservers(e,t),ze$$module$libs$world_onscreen.AUTOCLEAR){const w=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(g):this._autoClearDepthStencil[g];w&&w.autoClear&&this._clearDepthStencilBuffer(w.depth,
w.stencil)}for(const w of this._scene._beforeRenderingGroupDrawStage)w.action(g);n.render(a,d,c,b);for(const w of this._scene._afterRenderingGroupDrawStage)w.action(g);this._scene.onAfterRenderingGroupObservable.notifyObservers(e,t)}}reset(){if(!this.maintainStateBetweenFrames)for(let a=ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;a<ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS;a++){const b=this._renderingGroups[a];b&&b.prepare()}}resetSprites(){if(!this.maintainStateBetweenFrames)for(let a=
ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;a<ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS;a++){const b=this._renderingGroups[a];b&&b.prepareSprites()}}dispose(){this.freeRenderingGroups();this._renderingGroups.length=0;this._renderingGroupInfo=null}freeRenderingGroups(){for(let a=ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;a<ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS;a++){const b=this._renderingGroups[a];b&&b.dispose()}}_prepareRenderingGroup(a){void 0===this._renderingGroups[a]&&
(this._renderingGroups[a]=new Tt$$module$libs$world_onscreen(a,this._scene,this._customOpaqueSortCompareFn[a],this._customAlphaTestSortCompareFn[a],this._customTransparentSortCompareFn[a]))}dispatchSprites(a){this.maintainStateBetweenFrames&&a._wasDispatched||(a._wasDispatched=!0,this.getRenderingGroup(a.renderingGroupId).dispatchSprites(a))}dispatchParticles(a){this.maintainStateBetweenFrames&&a._wasDispatched||(a._wasDispatched=!0,this.getRenderingGroup(a.renderingGroupId).dispatchParticles(a))}dispatch(a,
b,c){void 0===b&&(b=a.getMesh());this.maintainStateBetweenFrames&&a._wasDispatched||(a._wasDispatched=!0,this.getRenderingGroup(b.renderingGroupId).dispatch(a,b,c))}setRenderingOrder(a,b=null,c=null,d=null){if(this._customOpaqueSortCompareFn[a]=b,this._customAlphaTestSortCompareFn[a]=c,this._customTransparentSortCompareFn[a]=d,this._renderingGroups[a])b=this._renderingGroups[a],b.opaqueSortCompareFn=this._customOpaqueSortCompareFn[a],b.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[a],
b.transparentSortCompareFn=this._customTransparentSortCompareFn[a]}setRenderingAutoClearDepthStencil(a,b,c=!0,d=!0){this._autoClearDepthStencil[a]={autoClear:b,depth:c,stencil:d}}getAutoClearDepthStencilSetup(a){return this._autoClearDepthStencil[a]}}ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS=4;ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS=0;ze$$module$libs$world_onscreen.AUTOCLEAR=!0;class Z$$module$libs$world_onscreen{}Z$$module$libs$world_onscreen.NAME_EFFECTLAYER="EffectLayer";
Z$$module$libs$world_onscreen.NAME_LAYER="Layer";Z$$module$libs$world_onscreen.NAME_LENSFLARESYSTEM="LensFlareSystem";Z$$module$libs$world_onscreen.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer";Z$$module$libs$world_onscreen.NAME_PARTICLESYSTEM="ParticleSystem";Z$$module$libs$world_onscreen.NAME_GAMEPAD="Gamepad";Z$$module$libs$world_onscreen.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue";Z$$module$libs$world_onscreen.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer";
Z$$module$libs$world_onscreen.NAME_PREPASSRENDERER="PrePassRenderer";Z$$module$libs$world_onscreen.NAME_DEPTHRENDERER="DepthRenderer";Z$$module$libs$world_onscreen.NAME_DEPTHPEELINGRENDERER="DepthPeelingRenderer";Z$$module$libs$world_onscreen.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager";Z$$module$libs$world_onscreen.NAME_SPRITE="Sprite";Z$$module$libs$world_onscreen.NAME_SUBSURFACE="SubSurface";Z$$module$libs$world_onscreen.NAME_OUTLINERENDERER="Outline";
Z$$module$libs$world_onscreen.NAME_PROCEDURALTEXTURE="ProceduralTexture";Z$$module$libs$world_onscreen.NAME_SHADOWGENERATOR="ShadowGenerator";Z$$module$libs$world_onscreen.NAME_OCTREE="Octree";Z$$module$libs$world_onscreen.NAME_PHYSICSENGINE="PhysicsEngine";Z$$module$libs$world_onscreen.NAME_AUDIO="Audio";Z$$module$libs$world_onscreen.NAME_FLUIDRENDERER="FluidRenderer";Z$$module$libs$world_onscreen.STEP_ISREADYFORMESH_EFFECTLAYER=0;
Z$$module$libs$world_onscreen.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0;Z$$module$libs$world_onscreen.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0;Z$$module$libs$world_onscreen.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0;Z$$module$libs$world_onscreen.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1;Z$$module$libs$world_onscreen.STEP_BEFORECAMERADRAW_PREPASS=0;Z$$module$libs$world_onscreen.STEP_BEFORECAMERADRAW_EFFECTLAYER=1;Z$$module$libs$world_onscreen.STEP_BEFORECAMERADRAW_LAYER=2;
Z$$module$libs$world_onscreen.STEP_BEFORERENDERTARGETDRAW_PREPASS=0;Z$$module$libs$world_onscreen.STEP_BEFORERENDERTARGETDRAW_LAYER=1;Z$$module$libs$world_onscreen.STEP_BEFORERENDERINGMESH_PREPASS=0;Z$$module$libs$world_onscreen.STEP_BEFORERENDERINGMESH_OUTLINE=1;Z$$module$libs$world_onscreen.STEP_AFTERRENDERINGMESH_PREPASS=0;Z$$module$libs$world_onscreen.STEP_AFTERRENDERINGMESH_OUTLINE=1;Z$$module$libs$world_onscreen.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0;
Z$$module$libs$world_onscreen.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1;Z$$module$libs$world_onscreen.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0;Z$$module$libs$world_onscreen.STEP_BEFORECAMERAUPDATE_GAMEPAD=1;Z$$module$libs$world_onscreen.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0;Z$$module$libs$world_onscreen.STEP_BEFORECLEAR_PREPASS=1;Z$$module$libs$world_onscreen.STEP_BEFORERENDERTARGETCLEAR_PREPASS=0;Z$$module$libs$world_onscreen.STEP_AFTERRENDERTARGETDRAW_PREPASS=0;
Z$$module$libs$world_onscreen.STEP_AFTERRENDERTARGETDRAW_LAYER=1;Z$$module$libs$world_onscreen.STEP_AFTERCAMERADRAW_PREPASS=0;Z$$module$libs$world_onscreen.STEP_AFTERCAMERADRAW_EFFECTLAYER=1;Z$$module$libs$world_onscreen.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=2;Z$$module$libs$world_onscreen.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=3;Z$$module$libs$world_onscreen.STEP_AFTERCAMERADRAW_LAYER=4;Z$$module$libs$world_onscreen.STEP_AFTERCAMERADRAW_FLUIDRENDERER=5;
Z$$module$libs$world_onscreen.STEP_AFTERCAMERAPOSTPROCESS_LAYER=0;Z$$module$libs$world_onscreen.STEP_AFTERRENDERTARGETPOSTPROCESS_LAYER=0;Z$$module$libs$world_onscreen.STEP_AFTERRENDER_AUDIO=0;Z$$module$libs$world_onscreen.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0;Z$$module$libs$world_onscreen.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1;Z$$module$libs$world_onscreen.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2;
Z$$module$libs$world_onscreen.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3;Z$$module$libs$world_onscreen.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0;Z$$module$libs$world_onscreen.STEP_GATHERACTIVECAMERARENDERTARGETS_FLUIDRENDERER=1;Z$$module$libs$world_onscreen.STEP_POINTERMOVE_SPRITE=0;Z$$module$libs$world_onscreen.STEP_POINTERDOWN_SPRITE=0;Z$$module$libs$world_onscreen.STEP_POINTERUP_SPRITE=0;
class ye$$module$libs$world_onscreen extends Array{constructor(a){super(...a)}static Create(){return Object.create(ye$$module$libs$world_onscreen.prototype)}registerStep(a,b,c){let d=0,e=Number.MAX_VALUE;for(;d<this.length&&(e=this[d].index,!(a<e));d++);this.splice(d,0,{index:a,component:b,action:c.bind(b)})}clear(){this.length=0}}class ve$$module$libs$world_onscreen{}ve$$module$libs$world_onscreen.POINTERDOWN=1;ve$$module$libs$world_onscreen.POINTERUP=2;
ve$$module$libs$world_onscreen.POINTERMOVE=4;ve$$module$libs$world_onscreen.POINTERWHEEL=8;ve$$module$libs$world_onscreen.POINTERPICK=16;ve$$module$libs$world_onscreen.POINTERTAP=32;ve$$module$libs$world_onscreen.POINTERDOUBLETAP=64;class wr$$module$libs$world_onscreen{constructor(a,b){this.type=a;this.event=b}}
class wn$$module$libs$world_onscreen extends wr$$module$libs$world_onscreen{constructor(a,b,c,d){super(a,b);this.originalPickingInfo=this.ray=null;this.skipOnPointerObservable=!1;this.localPosition=new Te$$module$libs$world_onscreen(c,d)}}
class ti$$module$libs$world_onscreen extends wr$$module$libs$world_onscreen{constructor(a,b,c,d=null){super(a,b);this._pickInfo=c;this._inputManager=d}get pickInfo(){return this._pickInfo||this._generatePickInfo(),this._pickInfo}_generatePickInfo(){this._inputManager&&(this._pickInfo=this._inputManager._pickMove(this.event.pointerId),this._inputManager._setRayOnPointerInfo(this._pickInfo,this.event),this._inputManager=null)}}
class ct$$module$libs$world_onscreen{constructor(){this.hoverCursor="";this.actions=[];this.isRecursive=!1}static get HasTriggers(){for(const a in ct$$module$libs$world_onscreen.Triggers)if(Object.prototype.hasOwnProperty.call(ct$$module$libs$world_onscreen.Triggers,a))return!0;return!1}static get HasPickTriggers(){for(const a in ct$$module$libs$world_onscreen.Triggers)if(Object.prototype.hasOwnProperty.call(ct$$module$libs$world_onscreen.Triggers,a)){const b=parseInt(a);if(1<=b&&7>=b)return!0}return!1}static HasSpecificTrigger(a){for(const b in ct$$module$libs$world_onscreen.Triggers)if(Object.prototype.hasOwnProperty.call(ct$$module$libs$world_onscreen.Triggers,
b)&&parseInt(b)===a)return!0;return!1}}ct$$module$libs$world_onscreen.Triggers={};class is$$module$libs$world_onscreen{}is$$module$libs$world_onscreen.KEYDOWN=1;is$$module$libs$world_onscreen.KEYUP=2;class Os$$module$libs$world_onscreen{constructor(a,b){this.type=a;this.event=b}}
class tr$$module$libs$world_onscreen extends Os$$module$libs$world_onscreen{constructor(a,b){super(a,b);this.type=a;this.event=b;this.skipOnKeyboardObservable=!1}get skipOnPointerObservable(){return this.skipOnKeyboardObservable}set skipOnPointerObservable(a){this.skipOnKeyboardObservable=a}}var z$$module$libs$world_onscreen;
(function(a){a[a.Generic=0]="Generic";a[a.Keyboard=1]="Keyboard";a[a.Mouse=2]="Mouse";a[a.Touch=3]="Touch";a[a.DualShock=4]="DualShock";a[a.Xbox=5]="Xbox";a[a.Switch=6]="Switch";a[a.DualSense=7]="DualSense"})(z$$module$libs$world_onscreen||={});var j$$module$libs$world_onscreen;
(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]="Vertical";a[a.LeftClick=2]="LeftClick";a[a.MiddleClick=3]="MiddleClick";a[a.RightClick=4]="RightClick";a[a.BrowserBack=5]="BrowserBack";a[a.BrowserForward=6]="BrowserForward";a[a.MouseWheelX=7]="MouseWheelX";a[a.MouseWheelY=8]="MouseWheelY";a[a.MouseWheelZ=9]="MouseWheelZ";a[a.Move=12]="Move"})(j$$module$libs$world_onscreen||={});var ss$$module$libs$world_onscreen;
(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]="Vertical";a[a.LeftClick=2]="LeftClick";a[a.MiddleClick=3]="MiddleClick";a[a.RightClick=4]="RightClick";a[a.BrowserBack=5]="BrowserBack";a[a.BrowserForward=6]="BrowserForward";a[a.MouseWheelX=7]="MouseWheelX";a[a.MouseWheelY=8]="MouseWheelY";a[a.MouseWheelZ=9]="MouseWheelZ";a[a.DeltaHorizontal=10]="DeltaHorizontal";a[a.DeltaVertical=11]="DeltaVertical"})(ss$$module$libs$world_onscreen||={});var ir$$module$libs$world_onscreen;
(function(a){a[a.Cross=0]="Cross";a[a.Circle=1]="Circle";a[a.Square=2]="Square";a[a.Triangle=3]="Triangle";a[a.L1=4]="L1";a[a.R1=5]="R1";a[a.L2=6]="L2";a[a.R2=7]="R2";a[a.Share=8]="Share";a[a.Options=9]="Options";a[a.L3=10]="L3";a[a.R3=11]="R3";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.TouchPad=17]="TouchPad";a[a.LStickXAxis=18]="LStickXAxis";a[a.LStickYAxis=19]="LStickYAxis";a[a.RStickXAxis=20]="RStickXAxis";
a[a.RStickYAxis=21]="RStickYAxis"})(ir$$module$libs$world_onscreen||={});var sr$$module$libs$world_onscreen;
(function(a){a[a.Cross=0]="Cross";a[a.Circle=1]="Circle";a[a.Square=2]="Square";a[a.Triangle=3]="Triangle";a[a.L1=4]="L1";a[a.R1=5]="R1";a[a.L2=6]="L2";a[a.R2=7]="R2";a[a.Create=8]="Create";a[a.Options=9]="Options";a[a.L3=10]="L3";a[a.R3=11]="R3";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.TouchPad=17]="TouchPad";a[a.LStickXAxis=18]="LStickXAxis";a[a.LStickYAxis=19]="LStickYAxis";a[a.RStickXAxis=20]="RStickXAxis";
a[a.RStickYAxis=21]="RStickYAxis"})(sr$$module$libs$world_onscreen||={});var rr$$module$libs$world_onscreen;
(function(a){a[a.A=0]="A";a[a.B=1]="B";a[a.X=2]="X";a[a.Y=3]="Y";a[a.LB=4]="LB";a[a.RB=5]="RB";a[a.LT=6]="LT";a[a.RT=7]="RT";a[a.Back=8]="Back";a[a.Start=9]="Start";a[a.LS=10]="LS";a[a.RS=11]="RS";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.LStickXAxis=17]="LStickXAxis";a[a.LStickYAxis=18]="LStickYAxis";a[a.RStickXAxis=19]="RStickXAxis";a[a.RStickYAxis=20]="RStickYAxis"})(rr$$module$libs$world_onscreen||={});
var nr$$module$libs$world_onscreen;
(function(a){a[a.B=0]="B";a[a.A=1]="A";a[a.Y=2]="Y";a[a.X=3]="X";a[a.L=4]="L";a[a.R=5]="R";a[a.ZL=6]="ZL";a[a.ZR=7]="ZR";a[a.Minus=8]="Minus";a[a.Plus=9]="Plus";a[a.LS=10]="LS";a[a.RS=11]="RS";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.Capture=17]="Capture";a[a.LStickXAxis=18]="LStickXAxis";a[a.LStickYAxis=19]="LStickYAxis";a[a.RStickXAxis=20]="RStickXAxis";a[a.RStickYAxis=21]="RStickYAxis"})(nr$$module$libs$world_onscreen||=
{});var ar$$module$libs$world_onscreen;(function(a){a[a.PointerMove=0]="PointerMove";a[a.PointerDown=1]="PointerDown";a[a.PointerUp=2]="PointerUp"})(ar$$module$libs$world_onscreen||={});class os$$module$libs$world_onscreen{}os$$module$libs$world_onscreen.DOM_DELTA_PIXEL=0;os$$module$libs$world_onscreen.DOM_DELTA_LINE=1;os$$module$libs$world_onscreen.DOM_DELTA_PAGE=2;
class si$$module$libs$world_onscreen{static CreateDeviceEvent(a,b,c,d,e,g){switch(a){case z$$module$libs$world_onscreen.Keyboard:return this._CreateKeyboardEvent(c,d,e,g);case z$$module$libs$world_onscreen.Mouse:if(c===j$$module$libs$world_onscreen.MouseWheelX||c===j$$module$libs$world_onscreen.MouseWheelY||c===j$$module$libs$world_onscreen.MouseWheelZ)return this._CreateWheelEvent(a,b,c,d,e,g);case z$$module$libs$world_onscreen.Touch:return this._CreatePointerEvent(a,b,c,d,e,g);default:throw`Unable to generate event for device ${z$$module$libs$world_onscreen[a]}`;
}}static _CreatePointerEvent(a,b,c,d,e,g){e=this._CreateMouseEvent(a,b,c,d,e,g);return a===z$$module$libs$world_onscreen.Mouse?(e.deviceType=z$$module$libs$world_onscreen.Mouse,e.pointerId=1,e.pointerType="mouse"):(e.deviceType=z$$module$libs$world_onscreen.Touch,e.pointerId=b,e.pointerType="touch"),c===j$$module$libs$world_onscreen.Move?e.type="pointermove":c>=j$$module$libs$world_onscreen.LeftClick&&c<=j$$module$libs$world_onscreen.RightClick&&(e.type=1===d?"pointerdown":"pointerup",e.button=c-
2),e}static _CreateWheelEvent(a,b,c,d,e,g){a=this._CreateMouseEvent(a,b,c,d,e,g);switch(a.type="wheel",a.deltaMode=os$$module$libs$world_onscreen.DOM_DELTA_PIXEL,a.deltaX=0,a.deltaY=0,a.deltaZ=0,c){case j$$module$libs$world_onscreen.MouseWheelX:a.deltaX=d;break;case j$$module$libs$world_onscreen.MouseWheelY:a.deltaY=d;break;case j$$module$libs$world_onscreen.MouseWheelZ:a.deltaZ=d}return a}static _CreateMouseEvent(a,b,c,d,e,g){d=this._CreateEvent(g);const n=e.pollInput(a,b,j$$module$libs$world_onscreen.Horizontal),
t=e.pollInput(a,b,j$$module$libs$world_onscreen.Vertical);return g?(d.movementX=0,d.movementY=0,d.offsetX=d.movementX-g.getBoundingClientRect().x,d.offsetY=d.movementY-g.getBoundingClientRect().y):(d.movementX=e.pollInput(a,b,ss$$module$libs$world_onscreen.DeltaHorizontal),d.movementY=e.pollInput(a,b,ss$$module$libs$world_onscreen.DeltaVertical),d.offsetX=0,d.offsetY=0),this._CheckNonCharacterKeys(d,e),d.clientX=n,d.clientY=t,d.x=n,d.y=t,d.deviceType=a,d.deviceSlot=b,d.inputIndex=c,d}static _CreateKeyboardEvent(a,
b,c,d){d=this._CreateEvent(d);return this._CheckNonCharacterKeys(d,c),d.deviceType=z$$module$libs$world_onscreen.Keyboard,d.deviceSlot=0,d.inputIndex=a,d.type=1===b?"keydown":"keyup",d.key=String.fromCharCode(a),d.keyCode=a,d}static _CheckNonCharacterKeys(a,b){const c=b.isDeviceAvailable(z$$module$libs$world_onscreen.Keyboard),d=c&&1===b.pollInput(z$$module$libs$world_onscreen.Keyboard,0,18),e=c&&1===b.pollInput(z$$module$libs$world_onscreen.Keyboard,0,17),g=c&&(1===b.pollInput(z$$module$libs$world_onscreen.Keyboard,
0,91)||1===b.pollInput(z$$module$libs$world_onscreen.Keyboard,0,92)||1===b.pollInput(z$$module$libs$world_onscreen.Keyboard,0,93));b=c&&1===b.pollInput(z$$module$libs$world_onscreen.Keyboard,0,16);a.altKey=d;a.ctrlKey=e;a.metaKey=g;a.shiftKey=b}static _CreateEvent(a){const b={};return b.preventDefault=()=>{},b.target=a,b}}
class On$$module$libs$world_onscreen{constructor(a,b,c){this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(a,b,(d,e,g,n)=>{g=si$$module$libs$world_onscreen.CreateDeviceEvent(d,e,g,n,this);c(d,e,g)}):this._createDummyNativeInput()}pollInput(a,b,c){return this._nativeInput.pollInput(a,b,c)}isDeviceAvailable(a){return a===z$$module$libs$world_onscreen.Mouse||a===z$$module$libs$world_onscreen.Touch}dispose(){this._nativeInput.dispose()}_createDummyNativeInput(){return{pollInput:()=>
0,isDeviceAvailable:()=>!1,dispose:()=>{}}}}const or$$module$libs$world_onscreen=255,hr$$module$libs$world_onscreen=Object.keys(j$$module$libs$world_onscreen).length/2;
class Ln$$module$libs$world_onscreen{constructor(a,b,c,d){this._inputs=[];this._pointerActive=this._keyboardActive=!1;this._usingSafari=X$$module$libs$world_onscreen.IsSafari();this._usingMacOS=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);this._keyboardDownEvent=e=>{};this._keyboardUpEvent=e=>{};this._keyboardBlurEvent=e=>{};this._pointerMoveEvent=e=>{};this._pointerDownEvent=e=>{};this._pointerUpEvent=e=>{};this._pointerCancelEvent=e=>{};this._pointerWheelEvent=e=>{};this._pointerBlurEvent=
e=>{};this._eventsAttached=!1;this._mouseId=-1;this._isUsingFirefox=Fs$$module$libs$world_onscreen.IsNavigatorAvailable()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Firefox");this._maxTouchPoints=0;this._pointerInputClearObserver=null;this._gamepadConnectedEvent=e=>{};this._gamepadDisconnectedEvent=e=>{};this._eventPrefix=X$$module$libs$world_onscreen.GetPointerPrefix(a);this._engine=a;this._onDeviceConnected=b;this._onDeviceDisconnected=c;this._onInputChanged=d;this._enableEvents();
this._usingMacOS&&(this._metaKeys=[]);this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=()=>{this._enableEvents()})}pollInput(a,b,c){var d=this._inputs[a][b];if(!d)throw`Unable to find device ${z$$module$libs$world_onscreen[a]}`;a>=z$$module$libs$world_onscreen.DualShock&&a<=z$$module$libs$world_onscreen.DualSense&&this._updateDevice(a,b,c);d=d[c];if(void 0===d)throw`Unable to find input ${c} for device ${z$$module$libs$world_onscreen[a]} in slot ${b}`;return c===j$$module$libs$world_onscreen.Move&&
X$$module$libs$world_onscreen.Warn("Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data."),d}isDeviceAvailable(a){return void 0!==this._inputs[a]}dispose(){this._onDeviceConnected=()=>{};this._onDeviceDisconnected=()=>{};this._onInputChanged=()=>{};delete this._engine._onEngineViewChanged;this._elementToAttachTo&&this._disableEvents()}_enableEvents(){const a=null===this||void 0===this?void 0:this._engine.getInputElement();
if(a&&(!this._eventsAttached||this._elementToAttachTo!==a)){if(this._disableEvents(),this._inputs)for(const b of this._inputs)if(b)for(const c in b){const d=b[+c];if(d)for(let e=0;e<d.length;e++)d[e]=0}this._elementToAttachTo=a;this._elementToAttachTo.tabIndex=-1!==this._elementToAttachTo.tabIndex?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex;this._handleKeyActions();this._handlePointerActions();this._handleGamepadActions();this._eventsAttached=!0;this._checkForConnectedDevices()}}_disableEvents(){this._elementToAttachTo&&
(this._elementToAttachTo.removeEventListener("blur",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+
"up",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent));this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver);this._eventsAttached=!1}_checkForConnectedDevices(){if(navigator.getGamepads){const a=
navigator.getGamepads();for(const b of a)b&&this._addGamePad(b)}"function"==typeof matchMedia&&matchMedia("(pointer:fine)").matches&&this._addPointerDevice(z$$module$libs$world_onscreen.Mouse,0,0,0)}_addGamePad(a){const b=this._getGamepadDeviceType(a.id),c=a.index;this._gamepads=this._gamepads||Array(a.index+1);this._registerDevice(b,c,a.buttons.length+a.axes.length);this._gamepads[c]=b}_addPointerDevice(a,b,c,d){this._pointerActive||(this._pointerActive=!0);this._registerDevice(a,b,hr$$module$libs$world_onscreen);
a=this._inputs[a][b];a[0]=c;a[1]=d}_registerDevice(a,b,c){if(void 0===b)throw`Unable to register device ${z$$module$libs$world_onscreen[a]} to undefined slot.`;(this._inputs[a]||(this._inputs[a]={}),this._inputs[a][b])||(c=Array(c),c.fill(0),this._inputs[a][b]=c,this._onDeviceConnected(a,b))}_unregisterDevice(a,b){this._inputs[a][b]&&(delete this._inputs[a][b],this._onDeviceDisconnected(a,b))}_handleKeyActions(){this._keyboardDownEvent=a=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(z$$module$libs$world_onscreen.Keyboard,
0,or$$module$libs$world_onscreen));const b=this._inputs[z$$module$libs$world_onscreen.Keyboard][0];b&&(b[a.keyCode]=1,a.inputIndex=a.keyCode,this._usingMacOS&&a.metaKey&&"Meta"!==a.key&&(this._metaKeys.includes(a.keyCode)||this._metaKeys.push(a.keyCode)),this._onInputChanged(z$$module$libs$world_onscreen.Keyboard,0,a))};this._keyboardUpEvent=a=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(z$$module$libs$world_onscreen.Keyboard,0,or$$module$libs$world_onscreen));const b=this._inputs[z$$module$libs$world_onscreen.Keyboard][0];
if(b){b[a.keyCode]=0;if(a.inputIndex=a.keyCode,this._usingMacOS&&"Meta"===a.key&&0<this._metaKeys.length){for(const c of this._metaKeys){const d=si$$module$libs$world_onscreen.CreateDeviceEvent(z$$module$libs$world_onscreen.Keyboard,0,c,0,this,this._elementToAttachTo);b[c]=0;this._onInputChanged(z$$module$libs$world_onscreen.Keyboard,0,d)}this._metaKeys.splice(0,this._metaKeys.length)}this._onInputChanged(z$$module$libs$world_onscreen.Keyboard,0,a)}};this._keyboardBlurEvent=()=>{if(this._keyboardActive){const a=
this._inputs[z$$module$libs$world_onscreen.Keyboard][0];for(let b=0;b<a.length;b++)if(0!==a[b]){a[b]=0;const c=si$$module$libs$world_onscreen.CreateDeviceEvent(z$$module$libs$world_onscreen.Keyboard,0,b,0,this,this._elementToAttachTo);this._onInputChanged(z$$module$libs$world_onscreen.Keyboard,0,c)}this._usingMacOS&&this._metaKeys.splice(0,this._metaKeys.length)}};this._elementToAttachTo.addEventListener("keydown",this._keyboardDownEvent);this._elementToAttachTo.addEventListener("keyup",this._keyboardUpEvent);
this._elementToAttachTo.addEventListener("blur",this._keyboardBlurEvent)}_handlePointerActions(){this._maxTouchPoints=Fs$$module$libs$world_onscreen.IsNavigatorAvailable()&&navigator.maxTouchPoints||2;this._activeTouchIds||(this._activeTouchIds=Array(this._maxTouchPoints));for(var a=0;a<this._maxTouchPoints;a++)this._activeTouchIds[a]=-1;this._pointerMoveEvent=c=>{const d=this._getPointerType(c),e=d===z$$module$libs$world_onscreen.Mouse?0:this._activeTouchIds.indexOf(c.pointerId);this._inputs[d]||
(this._inputs[d]={});this._inputs[d][e]||this._addPointerDevice(d,e,c.clientX,c.clientY);const g=this._inputs[d][e];g&&(c.inputIndex=j$$module$libs$world_onscreen.Move,g[j$$module$libs$world_onscreen.Horizontal]=c.clientX,g[j$$module$libs$world_onscreen.Vertical]=c.clientY,this._onInputChanged(d,e,c),!this._usingSafari&&-1!==c.button&&(c.inputIndex=c.button+2,g[c.button+2]=g[c.button+2]?0:1,this._onInputChanged(d,e,c)))};this._pointerDownEvent=c=>{const d=this._getPointerType(c);let e=d===z$$module$libs$world_onscreen.Mouse?
0:c.pointerId;if(d===z$$module$libs$world_onscreen.Touch){var g=this._activeTouchIds.indexOf(-1);if(0<=g)e=g,this._activeTouchIds[g]=c.pointerId;else{X$$module$libs$world_onscreen.Warn(`Max number of touches exceeded.  Ignoring touches in excess of ${this._maxTouchPoints}`);return}}this._inputs[d]||(this._inputs[d]={});this._inputs[d][e]?d===z$$module$libs$world_onscreen.Touch&&this._onDeviceConnected(d,e):this._addPointerDevice(d,e,c.clientX,c.clientY);if(g=this._inputs[d][e]){const n=g[j$$module$libs$world_onscreen.Horizontal],
t=g[j$$module$libs$world_onscreen.Vertical];if(d===z$$module$libs$world_onscreen.Mouse){if(-1===this._mouseId&&(void 0===c.pointerId?this._mouseId=this._isUsingFirefox?0:1:this._mouseId=c.pointerId),!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(this._mouseId)}catch{}}else if(c.pointerId&&!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(c.pointerId)}catch{}g[j$$module$libs$world_onscreen.Horizontal]=c.clientX;g[j$$module$libs$world_onscreen.Vertical]=
c.clientY;g[c.button+2]=1;c.inputIndex=c.button+2;this._onInputChanged(d,e,c);n===c.clientX&&t===c.clientY||(c.inputIndex=j$$module$libs$world_onscreen.Move,this._onInputChanged(d,e,c))}};this._pointerUpEvent=c=>{var d,e,g,n,t;const w=this._getPointerType(c),z=w===z$$module$libs$world_onscreen.Mouse?0:this._activeTouchIds.indexOf(c.pointerId);if(w===z$$module$libs$world_onscreen.Touch){if(-1===z)return;this._activeTouchIds[z]=-1}const C=null===(d=this._inputs[w])||void 0===d?void 0:d[z];if(C&&0!==
C[c.button+2]){d=C[j$$module$libs$world_onscreen.Horizontal];const H=C[j$$module$libs$world_onscreen.Vertical];C[j$$module$libs$world_onscreen.Horizontal]=c.clientX;C[j$$module$libs$world_onscreen.Vertical]=c.clientY;C[c.button+2]=0;d===c.clientX&&H===c.clientY||(c.inputIndex=j$$module$libs$world_onscreen.Move,this._onInputChanged(w,z,c));c.inputIndex=c.button+2;w===z$$module$libs$world_onscreen.Mouse&&0<=this._mouseId&&null!==(g=(e=this._elementToAttachTo).hasPointerCapture)&&void 0!==g&&g.call(e,
this._mouseId)?this._elementToAttachTo.releasePointerCapture(this._mouseId):c.pointerId&&null!==(t=(n=this._elementToAttachTo).hasPointerCapture)&&void 0!==t&&t.call(n,c.pointerId)&&this._elementToAttachTo.releasePointerCapture(c.pointerId);this._onInputChanged(w,z,c);w===z$$module$libs$world_onscreen.Touch&&this._onDeviceDisconnected(w,z)}};this._pointerCancelEvent=c=>{var d,e,g,n;if("mouse"===c.pointerType)for(c=this._inputs[z$$module$libs$world_onscreen.Mouse][0],0<=this._mouseId&&null!==(e=(d=
this._elementToAttachTo).hasPointerCapture)&&void 0!==e&&e.call(d,this._mouseId)&&this._elementToAttachTo.releasePointerCapture(this._mouseId),d=j$$module$libs$world_onscreen.LeftClick;d<=j$$module$libs$world_onscreen.BrowserForward;d++)1===c[d]&&(c[d]=0,e=si$$module$libs$world_onscreen.CreateDeviceEvent(z$$module$libs$world_onscreen.Mouse,0,d,0,this,this._elementToAttachTo),this._onInputChanged(z$$module$libs$world_onscreen.Mouse,0,e));else d=this._activeTouchIds.indexOf(c.pointerId),null!==(n=(g=
this._elementToAttachTo).hasPointerCapture)&&void 0!==n&&n.call(g,c.pointerId)&&this._elementToAttachTo.releasePointerCapture(c.pointerId),this._inputs[z$$module$libs$world_onscreen.Touch][d][j$$module$libs$world_onscreen.LeftClick]=0,c=si$$module$libs$world_onscreen.CreateDeviceEvent(z$$module$libs$world_onscreen.Touch,d,j$$module$libs$world_onscreen.LeftClick,0,this,this._elementToAttachTo),this._onInputChanged(z$$module$libs$world_onscreen.Touch,d,c),this._activeTouchIds[d]=-1,this._onDeviceDisconnected(z$$module$libs$world_onscreen.Touch,
d)};this._wheelEventName="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";let b=!1;a=function(){};try{const c=Object.defineProperty({},"passive",{get:function(){b=!0}});this._elementToAttachTo.addEventListener("test",a,c);this._elementToAttachTo.removeEventListener("test",a,c)}catch{}this._pointerBlurEvent=()=>{var c,d,e,g,n;if(this.isDeviceAvailable(z$$module$libs$world_onscreen.Mouse)){var t=this._inputs[z$$module$libs$world_onscreen.Mouse][0];
0<=this._mouseId&&null!==(d=(c=this._elementToAttachTo).hasPointerCapture)&&void 0!==d&&d.call(c,this._mouseId)&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(c=j$$module$libs$world_onscreen.LeftClick;c<=j$$module$libs$world_onscreen.BrowserForward;c++)1===t[c]&&(t[c]=0,d=si$$module$libs$world_onscreen.CreateDeviceEvent(z$$module$libs$world_onscreen.Mouse,0,c,0,this,this._elementToAttachTo),this._onInputChanged(z$$module$libs$world_onscreen.Mouse,0,d))}if(this.isDeviceAvailable(z$$module$libs$world_onscreen.Touch))for(t=
this._inputs[z$$module$libs$world_onscreen.Touch],c=0;c<this._activeTouchIds.length;c++)if(d=this._activeTouchIds[c],!(null===(g=(e=this._elementToAttachTo).hasPointerCapture)||void 0===g)&&g.call(e,d)&&this._elementToAttachTo.releasePointerCapture(d),-1!==d&&1===(null===(n=t[c])||void 0===n?void 0:n[j$$module$libs$world_onscreen.LeftClick]))t[c][j$$module$libs$world_onscreen.LeftClick]=0,d=si$$module$libs$world_onscreen.CreateDeviceEvent(z$$module$libs$world_onscreen.Touch,c,j$$module$libs$world_onscreen.LeftClick,
0,this,this._elementToAttachTo),this._onInputChanged(z$$module$libs$world_onscreen.Touch,c,d),this._activeTouchIds[c]=-1,this._onDeviceDisconnected(z$$module$libs$world_onscreen.Touch,c)};this._pointerWheelEvent=c=>{const d=z$$module$libs$world_onscreen.Mouse;this._inputs[d]||(this._inputs[d]=[]);this._inputs[d][0]||(this._pointerActive=!0,this._registerDevice(d,0,hr$$module$libs$world_onscreen));const e=this._inputs[d][0];e&&(e[j$$module$libs$world_onscreen.MouseWheelX]=c.deltaX||0,e[j$$module$libs$world_onscreen.MouseWheelY]=
c.deltaY||c.wheelDelta||0,e[j$$module$libs$world_onscreen.MouseWheelZ]=c.deltaZ||0,0!==e[j$$module$libs$world_onscreen.MouseWheelX]&&(c.inputIndex=j$$module$libs$world_onscreen.MouseWheelX,this._onInputChanged(d,0,c)),0!==e[j$$module$libs$world_onscreen.MouseWheelY]&&(c.inputIndex=j$$module$libs$world_onscreen.MouseWheelY,this._onInputChanged(d,0,c)),0!==e[j$$module$libs$world_onscreen.MouseWheelZ]&&(c.inputIndex=j$$module$libs$world_onscreen.MouseWheelZ,this._onInputChanged(d,0,c)))};this._elementToAttachTo.addEventListener(this._eventPrefix+
"move",this._pointerMoveEvent);this._elementToAttachTo.addEventListener(this._eventPrefix+"down",this._pointerDownEvent);this._elementToAttachTo.addEventListener(this._eventPrefix+"up",this._pointerUpEvent);this._elementToAttachTo.addEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent);this._elementToAttachTo.addEventListener("blur",this._pointerBlurEvent);this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,b?{passive:!1}:!1);this._pointerInputClearObserver=
this._engine.onEndFrameObservable.add(()=>{if(this.isDeviceAvailable(z$$module$libs$world_onscreen.Mouse)){const c=this._inputs[z$$module$libs$world_onscreen.Mouse][0];c[j$$module$libs$world_onscreen.MouseWheelX]=0;c[j$$module$libs$world_onscreen.MouseWheelY]=0;c[j$$module$libs$world_onscreen.MouseWheelZ]=0}})}_handleGamepadActions(){this._gamepadConnectedEvent=a=>{this._addGamePad(a.gamepad)};this._gamepadDisconnectedEvent=a=>{if(this._gamepads){const b=this._getGamepadDeviceType(a.gamepad.id);a=
a.gamepad.index;this._unregisterDevice(b,a);delete this._gamepads[a]}};window.addEventListener("gamepadconnected",this._gamepadConnectedEvent);window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)}_updateDevice(a,b,c){const d=navigator.getGamepads()[b];d&&a===this._gamepads[b]&&(a=this._inputs[a][b],c>=d.buttons.length?a[c]=d.axes[c-d.buttons.length].valueOf():a[c]=d.buttons[c].value)}_getGamepadDeviceType(a){return-1!==a.indexOf("054c")?-1!==a.indexOf("0ce6")?z$$module$libs$world_onscreen.DualSense:
z$$module$libs$world_onscreen.DualShock:-1!==a.indexOf("Xbox One")||-1!==a.search("Xbox 360")||-1!==a.search("xinput")?z$$module$libs$world_onscreen.Xbox:-1!==a.indexOf("057e")?z$$module$libs$world_onscreen.Switch:z$$module$libs$world_onscreen.Generic}_getPointerType(a){let b=z$$module$libs$world_onscreen.Mouse;return("touch"===a.pointerType||"pen"===a.pointerType||a.touches)&&(b=z$$module$libs$world_onscreen.Touch),b}}
class lr$$module$libs$world_onscreen{constructor(a,b,c=0){this.deviceType=b;this.deviceSlot=c;this.onInputChangedObservable=new w$$module$libs$world_onscreen;this._deviceInputSystem=a}getInput(a){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,a)}}
class Nn$$module$libs$world_onscreen{constructor(a){this._registeredManagers=[];this._refCount=0;this.registerManager=e=>{for(let g=0;g<this._devices.length;g++){const n=this._devices[g];for(const t in n)e._addDevice(new lr$$module$libs$world_onscreen(this._deviceInputSystem,g,+t))}this._registeredManagers.push(e)};this.unregisterManager=e=>{e=this._registeredManagers.indexOf(e);-1<e&&this._registeredManagers.splice(e,1)};var b=Object.keys(z$$module$libs$world_onscreen).length/2;this._devices=Array(b);
b=(e,g)=>{this._devices[e]||(this._devices[e]=[]);this._devices[e][g]||(this._devices[e][g]=g);for(const n of this._registeredManagers){const t=new lr$$module$libs$world_onscreen(this._deviceInputSystem,e,g);n._addDevice(t)}};const c=(e,g)=>{var n;null!==(n=this._devices[e])&&void 0!==n&&n[g]&&delete this._devices[e][g];for(const t of this._registeredManagers)t._removeDevice(e,g)},d=(e,g,n)=>{if(n)for(const t of this._registeredManagers)t._onInputChanged(e,g,n)};"u">typeof _native?this._deviceInputSystem=
new On$$module$libs$world_onscreen(b,c,d):this._deviceInputSystem=new Ln$$module$libs$world_onscreen(a,b,c,d)}dispose(){this._deviceInputSystem.dispose()}}
class Bn$$module$libs$world_onscreen{constructor(a){const b=Object.keys(z$$module$libs$world_onscreen).length/2;this._devices=Array(b);this._firstDevice=Array(b);this._engine=a;this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new Nn$$module$libs$world_onscreen(a));this._engine._deviceSourceManager._refCount++;this.onDeviceConnectedObservable=new w$$module$libs$world_onscreen(c=>{for(const d of this._devices)if(d)for(const e of d)e&&this.onDeviceConnectedObservable.notifyObserver(c,
e)});this.onDeviceDisconnectedObservable=new w$$module$libs$world_onscreen;this._engine._deviceSourceManager.registerManager(this);this._onDisposeObserver=a.onDisposeObservable.add(()=>{this.dispose()})}getDeviceSource(a,b){if(void 0===b){if(void 0===this._firstDevice[a])return null;b=this._firstDevice[a]}return this._devices[a]&&void 0!==this._devices[a][b]?this._devices[a][b]:null}getDeviceSources(a){return this._devices[a]?this._devices[a].filter(b=>!!b):[]}dispose(){this.onDeviceConnectedObservable.clear();
this.onDeviceDisconnectedObservable.clear();this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),1>--this._engine._deviceSourceManager._refCount&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager));this._engine.onDisposeObservable.remove(this._onDisposeObserver)}_addDevice(a){this._devices[a.deviceType]||(this._devices[a.deviceType]=[]);this._devices[a.deviceType][a.deviceSlot]||(this._devices[a.deviceType][a.deviceSlot]=
a,this._updateFirstDevices(a.deviceType));this.onDeviceConnectedObservable.notifyObservers(a)}_removeDevice(a,b){var c,d;const e=null===(c=this._devices[a])||void 0===c?void 0:c[b];this.onDeviceDisconnectedObservable.notifyObservers(e);null!==(d=this._devices[a])&&void 0!==d&&d[b]&&delete this._devices[a][b];this._updateFirstDevices(a)}_onInputChanged(a,b,c){var d,e;null===(e=null===(d=this._devices[a])||void 0===d?void 0:d[b])||void 0===e||e.onInputChangedObservable.notifyObservers(c)}_updateFirstDevices(a){switch(a){case z$$module$libs$world_onscreen.Keyboard:case z$$module$libs$world_onscreen.Mouse:this._firstDevice[a]=
0;break;case z$$module$libs$world_onscreen.Touch:case z$$module$libs$world_onscreen.DualSense:case z$$module$libs$world_onscreen.DualShock:case z$$module$libs$world_onscreen.Xbox:case z$$module$libs$world_onscreen.Switch:case z$$module$libs$world_onscreen.Generic:delete this._firstDevice[a];const b=this._devices[a];if(b)for(let c=0;c<b.length;c++)if(b[c]){this._firstDevice[a]=c;break}}}}
class cr$$module$libs$world_onscreen{constructor(){this._ignore=this._hasSwiped=this._doubleClick=this._singleClick=!1}get singleClick(){return this._singleClick}get doubleClick(){return this._doubleClick}get hasSwiped(){return this._hasSwiped}get ignore(){return this._ignore}set singleClick(a){this._singleClick=a}set doubleClick(a){this._doubleClick=a}set hasSwiped(a){this._hasSwiped=a}set ignore(a){this._ignore=a}}
class Pe$$module$libs$world_onscreen{constructor(a){this._meshPickProceed=this._alreadyAttached=!1;this._previousPickResult=this._currentPickResult=null;this._totalPointersPressed=0;this._isSwiping=this._doubleClickOccured=!1;this._swipeButtonPressed=-1;this._skipPointerTap=!1;this._pointerY=this._pointerX=0;this._startingPointerPosition=new Te$$module$libs$world_onscreen(0,0);this._previousStartingPointerPosition=new Te$$module$libs$world_onscreen(0,0);this._previousStartingPointerTime=this._startingPointerTime=
0;this._pointerCaptures={};this._meshUnderPointerId={};this._movePointerInfo=null;this._cameraObserverCount=0;this._deviceSourceManager=null;this._scene=a||fe$$module$libs$world_onscreen.LastCreatedScene;this._scene}get meshUnderPointer(){return this._movePointerInfo&&(this._movePointerInfo._generatePickInfo(),this._movePointerInfo=null),this._pointerOverMesh}getMeshUnderPointerByPointerId(a){return this._meshUnderPointerId[a]||null}get unTranslatedPointer(){return new Te$$module$libs$world_onscreen(this._unTranslatedPointerX,
this._unTranslatedPointerY)}get pointerX(){return this._pointerX}set pointerX(a){this._pointerX=a}get pointerY(){return this._pointerY}set pointerY(a){this._pointerY=a}_updatePointerPosition(a){const b=this._scene.getEngine().getInputElementClientRect();b&&(this._pointerX=a.clientX-b.left,this._pointerY=a.clientY-b.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)}_processPointerMove(a,b){const c=this._scene;var d=c.getEngine();const e=d.getInputElement();e&&
(e.tabIndex=d.canvasTabIndex,c.doNotHandleCursors||(e.style.cursor=c.defaultCursor));this._setCursorAndPointerOverMesh(a,b.pointerId,c);for(const n of c._pointerMoveStage)a=n.action(this._unTranslatedPointerX,this._unTranslatedPointerY,a,!(null==a||!a.pickedMesh),e);d=b.inputIndex>=j$$module$libs$world_onscreen.MouseWheelX&&b.inputIndex<=j$$module$libs$world_onscreen.MouseWheelZ?ve$$module$libs$world_onscreen.POINTERWHEEL:ve$$module$libs$world_onscreen.POINTERMOVE;c.onPointerMove&&(a=a||this._pickMove(b.pointerId),
c.onPointerMove(b,a,d));let g;a?(g=new ti$$module$libs$world_onscreen(d,b,a),this._setRayOnPointerInfo(a,b)):(g=new ti$$module$libs$world_onscreen(d,b,null,this),this._movePointerInfo=g);c.onPointerObservable.hasObservers()&&c.onPointerObservable.notifyObservers(g,d)}_setRayOnPointerInfo(a,b){const c=this._scene;a&&c._pickingAvailable&&(a.ray||(a.ray=c.createPickingRay(b.offsetX,b.offsetY,x$$module$libs$world_onscreen.Identity(),c.activeCamera)))}_addCameraPointerObserver(a,b){return this._cameraObserverCount++,
this._scene.onPointerObservable.add(a,b)}_removeCameraPointerObserver(a){return this._cameraObserverCount--,this._scene.onPointerObservable.remove(a)}_checkForPicking(){return!!(this._scene.onPointerObservable.observers.length>this._cameraObserverCount||this._scene.onPointerPick)}_checkPrePointerObservable(a,b,c){const d=this._scene;b=new wn$$module$libs$world_onscreen(c,b,this._unTranslatedPointerX,this._unTranslatedPointerY);return a&&(b.originalPickingInfo=a,b.ray=a.ray,a.originMesh&&(b.nearInteractionPickingInfo=
a)),d.onPrePointerObservable.notifyObservers(b,c),!!b.skipOnPointerObservable}_pickMove(a){const b=this._scene,c=b.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,b.pointerMovePredicate,!1,b.cameraToUseForPointers,b.pointerMoveTrianglePredicate);return this._setCursorAndPointerOverMesh(c,a,b),c}_setCursorAndPointerOverMesh(a,b,c){const d=c.getEngine().getInputElement();null!=a&&a.pickedMesh?(this.setPointerOverMesh(a.pickedMesh,b,a),!c.doNotHandleCursors&&d&&this._pointerOverMesh)&&(a=
this._pointerOverMesh._getActionManagerForTrigger())&&a.hasPointerTriggers&&(d.style.cursor=a.hoverCursor||c.hoverCursor):this.setPointerOverMesh(null,b,a)}simulatePointerMove(a,b){b=new PointerEvent("pointermove",b);b.inputIndex=j$$module$libs$world_onscreen.Move;!this._checkPrePointerObservable(a,b,ve$$module$libs$world_onscreen.POINTERMOVE)&&this._processPointerMove(a,b)}simulatePointerDown(a,b){b=new PointerEvent("pointerdown",b);b.inputIndex=b.button+2;!this._checkPrePointerObservable(a,b,ve$$module$libs$world_onscreen.POINTERDOWN)&&
this._processPointerDown(a,b)}_processPointerDown(a,b){const c=this._scene;if(null!=a&&a.pickedMesh){this._pickedDownMesh=a.pickedMesh;const g=a.pickedMesh._getActionManagerForTrigger();if(g){if(g.hasPickTriggers)switch(g.processTrigger(5,We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,b)),b.button){case 0:g.processTrigger(2,We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,b));break;case 1:g.processTrigger(4,We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,b));break;case 2:g.processTrigger(3,
We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,b))}g.hasSpecificTrigger(8)&&window.setTimeout(()=>{const n=c.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,t=>t.isPickable&&t.isVisible&&t.isReady()&&t.actionManager&&t.actionManager.hasSpecificTrigger(8)&&t===this._pickedDownMesh,!1,c.cameraToUseForPointers);null!=n&&n.pickedMesh&&g&&0!==this._totalPointersPressed&&Date.now()-this._startingPointerTime>Pe$$module$libs$world_onscreen.LongPressDelay&&!this._isPointerSwiping()&&(this._startingPointerTime=
0,g.processTrigger(8,We$$module$libs$world_onscreen.CreateNew(n.pickedMesh,b)))},Pe$$module$libs$world_onscreen.LongPressDelay)}}else for(var d of c._pointerDownStage)a=d.action(this._unTranslatedPointerX,this._unTranslatedPointerY,a,b,!1);let e;d=ve$$module$libs$world_onscreen.POINTERDOWN;a?(c.onPointerDown&&c.onPointerDown(b,a,d),e=new ti$$module$libs$world_onscreen(d,b,a),this._setRayOnPointerInfo(a,b)):e=new ti$$module$libs$world_onscreen(d,b,null,this);c.onPointerObservable.hasObservers()&&c.onPointerObservable.notifyObservers(e,
d)}_isPointerSwiping(){return this._isSwiping}simulatePointerUp(a,b,c){b=new PointerEvent("pointerup",b);b.inputIndex=j$$module$libs$world_onscreen.Move;const d=new cr$$module$libs$world_onscreen;c?d.doubleClick=!0:d.singleClick=!0;!this._checkPrePointerObservable(a,b,ve$$module$libs$world_onscreen.POINTERUP)&&this._processPointerUp(a,b,d)}_processPointerUp(a,b,c){const d=this._scene;if(null!=a&&a.pickedMesh){if(this._pickedUpMesh=a.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(d.onPointerPick&&
d.onPointerPick(b,a),c.singleClick&&!c.ignore&&d.onPointerObservable.observers.length>this._cameraObserverCount)){var e=ve$$module$libs$world_onscreen.POINTERPICK;const g=new ti$$module$libs$world_onscreen(e,b,a);this._setRayOnPointerInfo(a,b);d.onPointerObservable.notifyObservers(g,e)}(e=a.pickedMesh._getActionManagerForTrigger())&&!c.ignore&&(e.processTrigger(7,We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,b,a)),!c.hasSwiped&&c.singleClick&&e.processTrigger(1,We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,
b,a)),e=a.pickedMesh._getActionManagerForTrigger(6),c.doubleClick&&e&&e.processTrigger(6,We$$module$libs$world_onscreen.CreateNew(a.pickedMesh,b,a)))}else if(!c.ignore)for(e of d._pointerUpStage)a=e.action(this._unTranslatedPointerX,this._unTranslatedPointerY,a,b,c.doubleClick);this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh&&(e=this._pickedDownMesh._getActionManagerForTrigger(16))&&e.processTrigger(16,We$$module$libs$world_onscreen.CreateNew(this._pickedDownMesh,b));c.ignore||(e=
new ti$$module$libs$world_onscreen(ve$$module$libs$world_onscreen.POINTERUP,b,a),this._setRayOnPointerInfo(a,b),d.onPointerObservable.notifyObservers(e,ve$$module$libs$world_onscreen.POINTERUP),d.onPointerUp&&d.onPointerUp(b,a,ve$$module$libs$world_onscreen.POINTERUP),c.hasSwiped||this._skipPointerTap)||(e=0,c.singleClick?e=ve$$module$libs$world_onscreen.POINTERTAP:c.doubleClick&&(e=ve$$module$libs$world_onscreen.POINTERDOUBLETAP),!e)||(a=new ti$$module$libs$world_onscreen(e,b,a),d.onPointerObservable.hasObservers()&&
d.onPointerObservable.hasSpecificMask(e)&&d.onPointerObservable.notifyObservers(a,e))}isPointerCaptured(a=0){return this._pointerCaptures[a]}attachControl(a=!0,b=!0,c=!0,d=null){const e=this._scene,g=e.getEngine();d||=g.getInputElement();this._alreadyAttached&&this.detachControl();d&&(this._alreadyAttachedTo=d);this._deviceSourceManager=new Bn$$module$libs$world_onscreen(g);this._initActionManager=n=>{if(!this._meshPickProceed){const t=e.skipPointerUpPicking||0===e._registeredActions&&!this._checkForPicking()&&
!e.onPointerUp?null:e.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,e.pointerUpPredicate,!1,e.cameraToUseForPointers);(this._currentPickResult=t)&&(n=t.hit&&t.pickedMesh?t.pickedMesh._getActionManagerForTrigger():null);this._meshPickProceed=!0}return n};this._delayedSimpleClick=(n,t,w)=>{(Date.now()-this._previousStartingPointerTime>Pe$$module$libs$world_onscreen.DoubleClickDelay&&!this._doubleClickOccured||n!==this._previousButtonPressed)&&(this._doubleClickOccured=!1,t.singleClick=
!0,t.ignore=!1,w(t,this._currentPickResult))};this._initClickEvent=(n,t,w,z)=>{const C=new cr$$module$libs$world_onscreen;let H=this._currentPickResult=null;var M=n.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERPICK)||t.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERPICK)||n.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERTAP)||t.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERTAP)||n.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP)||t.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP);
!M&&ct$$module$libs$world_onscreen&&(H=this._initActionManager(H,C),H&&(M=H.hasPickTriggers));let L=!1;M&&(w=w.button,(C.hasSwiped=this._isPointerSwiping(),C.hasSwiped)||((M=!Pe$$module$libs$world_onscreen.ExclusiveDoubleClickMode)||(M=!n.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP)&&!t.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP),M&&!ct$$module$libs$world_onscreen.HasSpecificTrigger(6)&&(H=this._initActionManager(H,C),H&&(M=!H.hasSpecificTrigger(6)))),M?(Date.now()-
this._previousStartingPointerTime>Pe$$module$libs$world_onscreen.DoubleClickDelay||w!==this._previousButtonPressed)&&(C.singleClick=!0,z(C,this._currentPickResult),L=!0):(this._previousDelayedSimpleClickTimeout=this._delayedSimpleClickTimeout,this._delayedSimpleClickTimeout=window.setTimeout(this._delayedSimpleClick.bind(this,w,C,z),Pe$$module$libs$world_onscreen.DoubleClickDelay)),n=n.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP)||t.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP),
!n&&ct$$module$libs$world_onscreen.HasSpecificTrigger(6)&&(H=this._initActionManager(H,C),H&&(n=H.hasSpecificTrigger(6))),n&&(w===this._previousButtonPressed&&Date.now()-this._previousStartingPointerTime<Pe$$module$libs$world_onscreen.DoubleClickDelay&&!this._doubleClickOccured?(C.hasSwiped||this._isPointerSwiping()?(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=
this._startingPointerPosition.y,this._previousButtonPressed=w,Pe$$module$libs$world_onscreen.ExclusiveDoubleClickMode?(this._previousDelayedSimpleClickTimeout&&clearTimeout(this._previousDelayedSimpleClickTimeout),this._previousDelayedSimpleClickTimeout=this._delayedSimpleClickTimeout,z(C,this._previousPickResult)):z(C,this._currentPickResult)):(this._previousStartingPointerTime=0,this._doubleClickOccured=!0,C.doubleClick=!0,C.ignore=!1,Pe$$module$libs$world_onscreen.ExclusiveDoubleClickMode&&this._previousDelayedSimpleClickTimeout&&
clearTimeout(this._previousDelayedSimpleClickTimeout),this._previousDelayedSimpleClickTimeout=this._delayedSimpleClickTimeout,z(C,this._currentPickResult)),L=!0):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=w))));L||z(C,this._currentPickResult)};this._onPointerMove=n=>{if(void 0===n.pointerId&&
(n.pointerId=0),this._updatePointerPosition(n),!this._isSwiping&&-1!==this._swipeButtonPressed&&(this._isSwiping=Math.abs(this._startingPointerPosition.x-this._pointerX)>Pe$$module$libs$world_onscreen.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>Pe$$module$libs$world_onscreen.DragMovementThreshold),!this._checkPrePointerObservable(null,n,n.inputIndex>=j$$module$libs$world_onscreen.MouseWheelX&&n.inputIndex<=j$$module$libs$world_onscreen.MouseWheelZ?ve$$module$libs$world_onscreen.POINTERWHEEL:
ve$$module$libs$world_onscreen.POINTERMOVE)&&(e.cameraToUseForPointers||e.activeCamera))if(e.skipPointerMovePicking)this._processPointerMove(new zt$$module$libs$world_onscreen,n);else{e.pointerMovePredicate||(e.pointerMovePredicate=w=>w.isPickable&&w.isVisible&&w.isReady()&&w.isEnabled()&&(w.enablePointerMoveEvents||e.constantlyUpdateMeshUnderPointer||null!==w._getActionManagerForTrigger())&&(!e.cameraToUseForPointers||0!==(e.cameraToUseForPointers.layerMask&w.layerMask)));var t=0<e._registeredActions?
this._pickMove(n.pointerId):null;this._processPointerMove(t,n)}};this._onPointerDown=n=>{if(this._totalPointersPressed++,this._pickedDownMesh=null,this._meshPickProceed=!1,void 0===n.pointerId&&(n.pointerId=0),this._updatePointerPosition(n),-1===this._swipeButtonPressed&&(this._swipeButtonPressed=n.button),e.preventDefaultOnPointerDown&&d&&(n.preventDefault(),d.focus()),this._startingPointerPosition.x=this._pointerX,this._startingPointerPosition.y=this._pointerY,this._startingPointerTime=Date.now(),
!this._checkPrePointerObservable(null,n,ve$$module$libs$world_onscreen.POINTERDOWN)&&(e.cameraToUseForPointers||e.activeCamera)){this._pointerCaptures[n.pointerId]=!0;e.pointerDownPredicate||(e.pointerDownPredicate=w=>w.isPickable&&w.isVisible&&w.isReady()&&w.isEnabled()&&(!e.cameraToUseForPointers||0!==(e.cameraToUseForPointers.layerMask&w.layerMask)));this._pickedDownMesh=null;var t;e.skipPointerDownPicking||0===e._registeredActions&&!this._checkForPicking()&&!e.onPointerDown?t=new zt$$module$libs$world_onscreen:
t=e.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,e.pointerDownPredicate,!1,e.cameraToUseForPointers);this._processPointerDown(t,n)}};this._onPointerUp=n=>{0!==this._totalPointersPressed&&(this._totalPointersPressed--,this._pickedUpMesh=null,this._meshPickProceed=!1,void 0===n.pointerId&&(n.pointerId=0),this._updatePointerPosition(n),e.preventDefaultOnPointerUp&&d&&(n.preventDefault(),d.focus()),this._initClickEvent(e.onPrePointerObservable,e.onPointerObservable,n,(t,w)=>{if(e.onPrePointerObservable.hasObservers()&&
(this._skipPointerTap=!1,!t.ignore)){if(this._checkPrePointerObservable(null,n,ve$$module$libs$world_onscreen.POINTERUP)){this._swipeButtonPressed===n.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1);return}t.hasSwiped||(t.singleClick&&e.onPrePointerObservable.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERTAP)&&this._checkPrePointerObservable(null,n,ve$$module$libs$world_onscreen.POINTERTAP)&&(this._skipPointerTap=!0),t.doubleClick&&e.onPrePointerObservable.hasSpecificMask(ve$$module$libs$world_onscreen.POINTERDOUBLETAP)&&
this._checkPrePointerObservable(null,n,ve$$module$libs$world_onscreen.POINTERDOUBLETAP)&&(this._skipPointerTap=!0))}this._pointerCaptures[n.pointerId]=!1;(e.cameraToUseForPointers||e.activeCamera)&&(e.pointerUpPredicate||(e.pointerUpPredicate=z=>z.isPickable&&z.isVisible&&z.isReady()&&z.isEnabled()&&(!e.cameraToUseForPointers||0!==(e.cameraToUseForPointers.layerMask&z.layerMask))),!this._meshPickProceed&&(ct$$module$libs$world_onscreen&&ct$$module$libs$world_onscreen.HasTriggers||this._checkForPicking()||
e.onPointerUp)&&this._initActionManager(null,t),w||=this._currentPickResult,this._processPointerUp(w,n,t),this._previousPickResult=this._currentPickResult,this._swipeButtonPressed===n.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1))}))};this._onKeyDown=n=>{const t=is$$module$libs$world_onscreen.KEYDOWN;if(e.onPreKeyboardObservable.hasObservers()){var w=new tr$$module$libs$world_onscreen(t,n);if(e.onPreKeyboardObservable.notifyObservers(w,t),w.skipOnKeyboardObservable)return}e.onKeyboardObservable.hasObservers()&&
(w=new Os$$module$libs$world_onscreen(t,n),e.onKeyboardObservable.notifyObservers(w,t));e.actionManager&&e.actionManager.processTrigger(14,We$$module$libs$world_onscreen.CreateNewFromScene(e,n))};this._onKeyUp=n=>{const t=is$$module$libs$world_onscreen.KEYUP;if(e.onPreKeyboardObservable.hasObservers()){var w=new tr$$module$libs$world_onscreen(t,n);if(e.onPreKeyboardObservable.notifyObservers(w,t),w.skipOnKeyboardObservable)return}e.onKeyboardObservable.hasObservers()&&(w=new Os$$module$libs$world_onscreen(t,
n),e.onKeyboardObservable.notifyObservers(w,t));e.actionManager&&e.actionManager.processTrigger(15,We$$module$libs$world_onscreen.CreateNewFromScene(e,n))};this._deviceSourceManager.onDeviceConnectedObservable.add(n=>{n.deviceType===z$$module$libs$world_onscreen.Mouse?n.onInputChangedObservable.add(t=>{t.inputIndex===j$$module$libs$world_onscreen.LeftClick||t.inputIndex===j$$module$libs$world_onscreen.MiddleClick||t.inputIndex===j$$module$libs$world_onscreen.RightClick||t.inputIndex===j$$module$libs$world_onscreen.BrowserBack||
t.inputIndex===j$$module$libs$world_onscreen.BrowserForward?b&&1===n.getInput(t.inputIndex)?this._onPointerDown(t):a&&0===n.getInput(t.inputIndex)&&this._onPointerUp(t):c&&(t.inputIndex===j$$module$libs$world_onscreen.Move?this._onPointerMove(t):(t.inputIndex===j$$module$libs$world_onscreen.MouseWheelX||t.inputIndex===j$$module$libs$world_onscreen.MouseWheelY||t.inputIndex===j$$module$libs$world_onscreen.MouseWheelZ)&&this._onPointerMove(t))}):n.deviceType===z$$module$libs$world_onscreen.Touch?n.onInputChangedObservable.add(t=>
{t.inputIndex===j$$module$libs$world_onscreen.LeftClick&&(b&&1===n.getInput(t.inputIndex)?this._onPointerDown(t):a&&0===n.getInput(t.inputIndex)&&this._onPointerUp(t));c&&t.inputIndex===j$$module$libs$world_onscreen.Move&&this._onPointerMove(t)}):n.deviceType===z$$module$libs$world_onscreen.Keyboard&&n.onInputChangedObservable.add(t=>{"keydown"===t.type?this._onKeyDown(t):"keyup"===t.type&&this._onKeyUp(t)})});this._alreadyAttached=!0}detachControl(){this._alreadyAttached&&(this._deviceSourceManager.dispose(),
this._deviceSourceManager=null,this._alreadyAttachedTo&&!this._scene.doNotHandleCursors&&(this._alreadyAttachedTo.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1,this._alreadyAttachedTo=null)}setPointerOverMesh(a,b=0,c){if(this._meshUnderPointerId[b]!==a||a&&a._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting){var d=this._meshUnderPointerId[b],e;d&&(e=d._getActionManagerForTrigger(10),e&&e.processTrigger(10,We$$module$libs$world_onscreen.CreateNew(d,void 0,{pointerId:b})));
a?(this._meshUnderPointerId[b]=a,this._pointerOverMesh=a,e=a._getActionManagerForTrigger(9),e&&e.processTrigger(9,We$$module$libs$world_onscreen.CreateNew(a,void 0,{pointerId:b,pickResult:c}))):(delete this._meshUnderPointerId[b],this._pointerOverMesh=null)}}getPointerOverMesh(){return this.meshUnderPointer}_invalidateMesh(a){this._pointerOverMesh===a&&(this._pointerOverMesh=null);this._pickedDownMesh===a&&(this._pickedDownMesh=null);this._pickedUpMesh===a&&(this._pickedUpMesh=null);for(const b in this._meshUnderPointerId)this._meshUnderPointerId[b]===
a&&delete this._meshUnderPointerId[b]}}Pe$$module$libs$world_onscreen.DragMovementThreshold=10;Pe$$module$libs$world_onscreen.LongPressDelay=500;Pe$$module$libs$world_onscreen.DoubleClickDelay=300;Pe$$module$libs$world_onscreen.ExclusiveDoubleClickMode=!1;
class xt$$module$libs$world_onscreen{constructor(a,b,c,d){this.normal=new p$$module$libs$world_onscreen(a,b,c);this.d=d}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new xt$$module$libs$world_onscreen(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let a=this.normal.getHashCode();return a=397*a^(this.d|0),a}normalize(){const a=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);
let b=0;return 0!==a&&(b=1/a),this.normal.x*=b,this.normal.y*=b,this.normal.z*=b,this.d*=b,this}transform(a){var b=xt$$module$libs$world_onscreen._TmpMatrix;a.invertToRef(b);a=b.m;b=this.normal.x;const c=this.normal.y,d=this.normal.z,e=this.d;return new xt$$module$libs$world_onscreen(b*a[0]+c*a[1]+d*a[2]+e*a[3],b*a[4]+c*a[5]+d*a[6]+e*a[7],b*a[8]+c*a[9]+d*a[10]+e*a[11],b*a[12]+c*a[13]+d*a[14]+e*a[15])}dotCoordinate(a){return this.normal.x*a.x+this.normal.y*a.y+this.normal.z*a.z+this.d}copyFromPoints(a,
b,c){var d=b.x-a.x,e=b.y-a.y,g=b.z-a.z;b=c.x-a.x;const n=c.y-a.y,t=c.z-a.z;c=e*t-g*n;g=g*b-d*t;d=d*n-e*b;e=Math.sqrt(c*c+g*g+d*d);let w;return 0!==e?w=1/e:w=0,this.normal.x=c*w,this.normal.y=g*w,this.normal.z=d*w,this.d=-(this.normal.x*a.x+this.normal.y*a.y+this.normal.z*a.z),this}isFrontFacingTo(a,b){return p$$module$libs$world_onscreen.Dot(this.normal,a)<=b}signedDistanceTo(a){return p$$module$libs$world_onscreen.Dot(a,this.normal)+this.d}static FromArray(a){return new xt$$module$libs$world_onscreen(a[0],
a[1],a[2],a[3])}static FromPoints(a,b,c){const d=new xt$$module$libs$world_onscreen(0,0,0,0);return d.copyFromPoints(a,b,c),d}static FromPositionAndNormal(a,b){const c=new xt$$module$libs$world_onscreen(0,0,0,0);return b.normalize(),c.normal=b,c.d=-(b.x*a.x+b.y*a.y+b.z*a.z),c}static SignedDistanceToPlaneFromPositionAndNormal(a,b,c){a=-(b.x*a.x+b.y*a.y+b.z*a.z);return p$$module$libs$world_onscreen.Dot(c,b)+a}}xt$$module$libs$world_onscreen._TmpMatrix=x$$module$libs$world_onscreen.Identity();
class mt$$module$libs$world_onscreen{static GetPlanes(a){const b=[];for(let c=0;6>c;c++)b.push(new xt$$module$libs$world_onscreen(0,0,0,0));return mt$$module$libs$world_onscreen.GetPlanesToRef(a,b),b}static GetNearPlaneToRef(a,b){a=a.m;b.normal.x=a[3]+a[2];b.normal.y=a[7]+a[6];b.normal.z=a[11]+a[10];b.d=a[15]+a[14];b.normalize()}static GetFarPlaneToRef(a,b){a=a.m;b.normal.x=a[3]-a[2];b.normal.y=a[7]-a[6];b.normal.z=a[11]-a[10];b.d=a[15]-a[14];b.normalize()}static GetLeftPlaneToRef(a,b){a=a.m;b.normal.x=
a[3]+a[0];b.normal.y=a[7]+a[4];b.normal.z=a[11]+a[8];b.d=a[15]+a[12];b.normalize()}static GetRightPlaneToRef(a,b){a=a.m;b.normal.x=a[3]-a[0];b.normal.y=a[7]-a[4];b.normal.z=a[11]-a[8];b.d=a[15]-a[12];b.normalize()}static GetTopPlaneToRef(a,b){a=a.m;b.normal.x=a[3]-a[1];b.normal.y=a[7]-a[5];b.normal.z=a[11]-a[9];b.d=a[15]-a[13];b.normalize()}static GetBottomPlaneToRef(a,b){a=a.m;b.normal.x=a[3]+a[1];b.normal.y=a[7]+a[5];b.normal.z=a[11]+a[9];b.d=a[15]+a[13];b.normalize()}static GetPlanesToRef(a,b){mt$$module$libs$world_onscreen.GetNearPlaneToRef(a,
b[0]);mt$$module$libs$world_onscreen.GetFarPlaneToRef(a,b[1]);mt$$module$libs$world_onscreen.GetLeftPlaneToRef(a,b[2]);mt$$module$libs$world_onscreen.GetRightPlaneToRef(a,b[3]);mt$$module$libs$world_onscreen.GetTopPlaneToRef(a,b[4]);mt$$module$libs$world_onscreen.GetBottomPlaneToRef(a,b[5])}}class Or$$module$libs$world_onscreen{static get UniqueId(){const a=this._UniqueIdCounter;return this._UniqueIdCounter++,a}}Or$$module$libs$world_onscreen._UniqueIdCounter=1;
class Ee$$module$libs$world_onscreen{static CompareLightsPriority(a,b){return a.shadowEnabled!==b.shadowEnabled?(b.shadowEnabled?1:0)-(a.shadowEnabled?1:0):b.renderPriority-a.renderPriority}}Ee$$module$libs$world_onscreen.FALLOFF_DEFAULT=0;Ee$$module$libs$world_onscreen.FALLOFF_PHYSICAL=1;Ee$$module$libs$world_onscreen.FALLOFF_GLTF=2;Ee$$module$libs$world_onscreen.FALLOFF_STANDARD=3;Ee$$module$libs$world_onscreen.LIGHTMAP_DEFAULT=0;Ee$$module$libs$world_onscreen.LIGHTMAP_SPECULAR=1;
Ee$$module$libs$world_onscreen.LIGHTMAP_SHADOWSONLY=2;Ee$$module$libs$world_onscreen.INTENSITYMODE_AUTOMATIC=0;Ee$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSPOWER=1;Ee$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSINTENSITY=2;Ee$$module$libs$world_onscreen.INTENSITYMODE_ILLUMINANCE=3;Ee$$module$libs$world_onscreen.INTENSITYMODE_LUMINANCE=4;Ee$$module$libs$world_onscreen.LIGHTTYPEID_POINTLIGHT=0;Ee$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT=1;
Ee$$module$libs$world_onscreen.LIGHTTYPEID_SPOTLIGHT=2;Ee$$module$libs$world_onscreen.LIGHTTYPEID_HEMISPHERICLIGHT=3;var Ct$$module$libs$world_onscreen;(function(a){a[a.BackwardCompatible=0]="BackwardCompatible";a[a.Intermediate=1]="Intermediate";a[a.Aggressive=2]="Aggressive"})(Ct$$module$libs$world_onscreen||={});
class re$$module$libs$world_onscreen extends as$$module$libs$world_onscreen{constructor(a,b){super();this._inputManager=new Pe$$module$libs$world_onscreen(this);this.cameraToUseForPointers=null;this._isScene=!0;this._blockEntityCollection=!1;this.autoClearDepthAndStencil=this.autoClear=!0;this.clearColor=new me$$module$libs$world_onscreen(.2,.2,.3,1);this.ambientColor=new se$$module$libs$world_onscreen(0,0,0);this.environmentIntensity=1;this._performancePriority=Ct$$module$libs$world_onscreen.BackwardCompatible;
this._forcePointsCloud=this._skipFrustumClipping=this._forceWireframe=!1;this.animationsEnabled=!0;this._animationPropertiesOverride=null;this.constantlyUpdateMeshUnderPointer=this.useConstantAnimationDeltaTime=!1;this.hoverCursor="pointer";this.defaultCursor="";this.doNotHandleCursors=!1;this.preventDefaultOnPointerUp=this.preventDefaultOnPointerDown=!0;this.reservedDataStore=this.metadata=null;this.disableOfflineSupportExceptionRules=[];this.onDisposeObservable=new w$$module$libs$world_onscreen;
this._onDisposeObserver=null;this.onBeforeRenderObservable=new w$$module$libs$world_onscreen;this._onBeforeRenderObserver=null;this.onAfterRenderObservable=new w$$module$libs$world_onscreen;this.onAfterRenderCameraObservable=new w$$module$libs$world_onscreen;this._onAfterRenderObserver=null;this.onBeforeAnimationsObservable=new w$$module$libs$world_onscreen;this.onAfterAnimationsObservable=new w$$module$libs$world_onscreen;this.onBeforeDrawPhaseObservable=new w$$module$libs$world_onscreen;this.onAfterDrawPhaseObservable=
new w$$module$libs$world_onscreen;this.onReadyObservable=new w$$module$libs$world_onscreen;this.onBeforeCameraRenderObservable=new w$$module$libs$world_onscreen;this._onBeforeCameraRenderObserver=null;this.onAfterCameraRenderObservable=new w$$module$libs$world_onscreen;this._onAfterCameraRenderObserver=null;this.onBeforeActiveMeshesEvaluationObservable=new w$$module$libs$world_onscreen;this.onAfterActiveMeshesEvaluationObservable=new w$$module$libs$world_onscreen;this.onBeforeParticlesRenderingObservable=
new w$$module$libs$world_onscreen;this.onAfterParticlesRenderingObservable=new w$$module$libs$world_onscreen;this.onDataLoadedObservable=new w$$module$libs$world_onscreen;this.onNewCameraAddedObservable=new w$$module$libs$world_onscreen;this.onCameraRemovedObservable=new w$$module$libs$world_onscreen;this.onNewLightAddedObservable=new w$$module$libs$world_onscreen;this.onLightRemovedObservable=new w$$module$libs$world_onscreen;this.onNewGeometryAddedObservable=new w$$module$libs$world_onscreen;this.onGeometryRemovedObservable=
new w$$module$libs$world_onscreen;this.onNewTransformNodeAddedObservable=new w$$module$libs$world_onscreen;this.onTransformNodeRemovedObservable=new w$$module$libs$world_onscreen;this.onNewMeshAddedObservable=new w$$module$libs$world_onscreen;this.onMeshRemovedObservable=new w$$module$libs$world_onscreen;this.onNewSkeletonAddedObservable=new w$$module$libs$world_onscreen;this.onSkeletonRemovedObservable=new w$$module$libs$world_onscreen;this.onNewMaterialAddedObservable=new w$$module$libs$world_onscreen;
this.onNewMultiMaterialAddedObservable=new w$$module$libs$world_onscreen;this.onMaterialRemovedObservable=new w$$module$libs$world_onscreen;this.onMultiMaterialRemovedObservable=new w$$module$libs$world_onscreen;this.onNewTextureAddedObservable=new w$$module$libs$world_onscreen;this.onTextureRemovedObservable=new w$$module$libs$world_onscreen;this.onBeforeRenderTargetsRenderObservable=new w$$module$libs$world_onscreen;this.onAfterRenderTargetsRenderObservable=new w$$module$libs$world_onscreen;this.onBeforeStepObservable=
new w$$module$libs$world_onscreen;this.onAfterStepObservable=new w$$module$libs$world_onscreen;this.onActiveCameraChanged=new w$$module$libs$world_onscreen;this.onActiveCamerasChanged=new w$$module$libs$world_onscreen;this.onBeforeRenderingGroupObservable=new w$$module$libs$world_onscreen;this.onAfterRenderingGroupObservable=new w$$module$libs$world_onscreen;this.onMeshImportedObservable=new w$$module$libs$world_onscreen;this.onAnimationFileImportedObservable=new w$$module$libs$world_onscreen;this._registeredForLateAnimationBindings=
new ii$$module$libs$world_onscreen(256);this.skipPointerUpPicking=this.skipPointerDownPicking=this.skipPointerMovePicking=!1;this.onPrePointerObservable=new w$$module$libs$world_onscreen;this.onPointerObservable=new w$$module$libs$world_onscreen;this.onPreKeyboardObservable=new w$$module$libs$world_onscreen;this.onKeyboardObservable=new w$$module$libs$world_onscreen;this._useRightHandedSystem=!1;this._currentInternalStep=this._currentStepId=this._timeAccumulator=0;this._fogEnabled=!0;this._fogMode=
re$$module$libs$world_onscreen.FOGMODE_NONE;this.fogColor=new se$$module$libs$world_onscreen(.2,.2,.3);this.fogDensity=.1;this.fogStart=0;this.fogEnd=1E3;this.needsPreviousWorldMatrices=!1;this._lightsEnabled=this._shadowsEnabled=!0;this._unObserveActiveCameras=null;this.collisionsEnabled=this.lensFlaresEnabled=this._skeletonsEnabled=this.spritesEnabled=this.particlesEnabled=this.physicsEnabled=this._texturesEnabled=!0;this.gravity=new p$$module$libs$world_onscreen(0,-9.807,0);this.renderTargetsEnabled=
this.postProcessesEnabled=!0;this.dumpNextRenderTargets=!1;this.customRenderTargets=[];this.importedMeshesFiles=[];this.probesEnabled=!0;this._meshesForIntersections=new ii$$module$libs$world_onscreen(256);this.proceduralTexturesEnabled=!0;this._totalVertices=new yt$$module$libs$world_onscreen;this._activeIndices=new yt$$module$libs$world_onscreen;this._activeParticles=new yt$$module$libs$world_onscreen;this._activeBones=new yt$$module$libs$world_onscreen;this._animationTime=0;this.animationTimeScale=
1;this._frameId=this._renderId=0;this._executeWhenReadyTimeoutId=null;this._defaultFrameBufferCleared=this._intermediateRendering=!1;this._projectionUpdateFlag=this._viewUpdateFlag=-1;this._toBeDisposed=Array(256);this._activeRequests=[];this._pendingData=[];this.dispatchAllSubMeshesOfActiveMeshes=this._isDisposed=!1;this._activeMeshes=new $e$$module$libs$world_onscreen(256);this._processedMaterials=new $e$$module$libs$world_onscreen(256);this._renderTargets=new ii$$module$libs$world_onscreen(256);
this._materialsRenderTargets=new ii$$module$libs$world_onscreen(256);this._activeParticleSystems=new $e$$module$libs$world_onscreen(256);this._activeSkeletons=new ii$$module$libs$world_onscreen(32);this._softwareSkinnedMeshes=new ii$$module$libs$world_onscreen(32);this._activeAnimatables=[];this._transformMatrix=x$$module$libs$world_onscreen.Zero();this.requireLightSorting=!1;this._components=[];this._serializableComponents=[];this._transientComponents=[];this._beforeCameraUpdateStage=ye$$module$libs$world_onscreen.Create();
this._beforeClearStage=ye$$module$libs$world_onscreen.Create();this._beforeRenderTargetClearStage=ye$$module$libs$world_onscreen.Create();this._gatherRenderTargetsStage=ye$$module$libs$world_onscreen.Create();this._gatherActiveCameraRenderTargetsStage=ye$$module$libs$world_onscreen.Create();this._isReadyForMeshStage=ye$$module$libs$world_onscreen.Create();this._beforeEvaluateActiveMeshStage=ye$$module$libs$world_onscreen.Create();this._evaluateSubMeshStage=ye$$module$libs$world_onscreen.Create();
this._preActiveMeshStage=ye$$module$libs$world_onscreen.Create();this._cameraDrawRenderTargetStage=ye$$module$libs$world_onscreen.Create();this._beforeCameraDrawStage=ye$$module$libs$world_onscreen.Create();this._beforeRenderTargetDrawStage=ye$$module$libs$world_onscreen.Create();this._beforeRenderingGroupDrawStage=ye$$module$libs$world_onscreen.Create();this._beforeRenderingMeshStage=ye$$module$libs$world_onscreen.Create();this._afterRenderingMeshStage=ye$$module$libs$world_onscreen.Create();this._afterRenderingGroupDrawStage=
ye$$module$libs$world_onscreen.Create();this._afterCameraDrawStage=ye$$module$libs$world_onscreen.Create();this._afterCameraPostProcessStage=ye$$module$libs$world_onscreen.Create();this._afterRenderTargetDrawStage=ye$$module$libs$world_onscreen.Create();this._afterRenderTargetPostProcessStage=ye$$module$libs$world_onscreen.Create();this._afterRenderStage=ye$$module$libs$world_onscreen.Create();this._pointerMoveStage=ye$$module$libs$world_onscreen.Create();this._pointerDownStage=ye$$module$libs$world_onscreen.Create();
this._pointerUpStage=ye$$module$libs$world_onscreen.Create();this._geometriesByUniqueId=null;this._defaultMeshCandidates={data:[],length:0};this._defaultSubMeshCandidates={data:[],length:0};this._skipEvaluateActiveMeshesCompletely=this._activeMeshesFrozenButKeepClipping=this._activeMeshesFrozen=this._preventFreeActiveMeshesAndRenderingGroups=!1;this._allowPostProcessClearColor=!0;this.getDeterministicFrameTime=()=>this._engine.getTimeStep();this._registeredActions=0;this._blockMaterialDirtyMechanism=
!1;this._perfCollector=null;this.activeCameras=[];const c={useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1,...b};this._engine=a||fe$$module$libs$world_onscreen.LastCreatedEngine;c.virtual?this._engine._virtualScenes.push(this):(fe$$module$libs$world_onscreen._LastCreatedScene=this,this._engine.scenes.push(this));this._uid=null;this._renderingManager=new ze$$module$libs$world_onscreen(this);ts$$module$libs$world_onscreen&&(this.postProcessManager=new ts$$module$libs$world_onscreen(this));
Ze$$module$libs$world_onscreen()&&this.attachControl();this._createUbo();pe$$module$libs$world_onscreen&&(this._imageProcessingConfiguration=new pe$$module$libs$world_onscreen);this.setDefaultCandidateProviders();c.useGeometryUniqueIdsMap&&(this._geometriesByUniqueId={});this.useMaterialMeshMap=c.useMaterialMeshMap;this.useClonedMeshMap=c.useClonedMeshMap;b&&b.virtual||this._engine.onNewSceneAddedObservable.notifyObservers(this)}static DefaultMaterialFactory(a){throw $$$module$libs$world_onscreen("StandardMaterial");
}static CollisionCoordinatorFactory(){throw $$$module$libs$world_onscreen("DefaultCollisionCoordinator");}get environmentTexture(){return this._environmentTexture}set environmentTexture(a){this._environmentTexture!==a&&(this._environmentTexture=a,this.markAllMaterialsAsDirty(1))}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}get performancePriority(){return this._performancePriority}set performancePriority(a){if(a!==this._performancePriority)switch(this._performancePriority=
a,a){case Ct$$module$libs$world_onscreen.BackwardCompatible:this.skipFrustumClipping=!1;this.skipPointerMovePicking=this._renderingManager.maintainStateBetweenFrames=!1;this.autoClear=!0;break;case Ct$$module$libs$world_onscreen.Intermediate:this.skipFrustumClipping=!1;this._renderingManager.maintainStateBetweenFrames=!1;this.skipPointerMovePicking=!0;this.autoClear=!1;break;case Ct$$module$libs$world_onscreen.Aggressive:this.skipFrustumClipping=!0,this.skipPointerMovePicking=this._renderingManager.maintainStateBetweenFrames=
!0,this.autoClear=!1}}set forceWireframe(a){this._forceWireframe!==a&&(this._forceWireframe=a,this.markAllMaterialsAsDirty(16))}get forceWireframe(){return this._forceWireframe}set skipFrustumClipping(a){this._skipFrustumClipping!==a&&(this._skipFrustumClipping=a)}get skipFrustumClipping(){return this._skipFrustumClipping}set forcePointsCloud(a){this._forcePointsCloud!==a&&(this._forcePointsCloud=a,this.markAllMaterialsAsDirty(16))}get forcePointsCloud(){return this._forcePointsCloud}get animationPropertiesOverride(){return this._animationPropertiesOverride}set animationPropertiesOverride(a){this._animationPropertiesOverride=
a}set onDispose(a){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver);this._onDisposeObserver=this.onDisposeObservable.add(a)}set beforeRender(a){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver);a&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(a))}set afterRender(a){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver);a&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(a))}set beforeCameraRender(a){this._onBeforeCameraRenderObserver&&
this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver);this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(a)}set afterCameraRender(a){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver);this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(a)}get unTranslatedPointer(){return this._inputManager.unTranslatedPointer}static get DragMovementThreshold(){return Pe$$module$libs$world_onscreen.DragMovementThreshold}static set DragMovementThreshold(a){Pe$$module$libs$world_onscreen.DragMovementThreshold=
a}static get LongPressDelay(){return Pe$$module$libs$world_onscreen.LongPressDelay}static set LongPressDelay(a){Pe$$module$libs$world_onscreen.LongPressDelay=a}static get DoubleClickDelay(){return Pe$$module$libs$world_onscreen.DoubleClickDelay}static set DoubleClickDelay(a){Pe$$module$libs$world_onscreen.DoubleClickDelay=a}static get ExclusiveDoubleClickMode(){return Pe$$module$libs$world_onscreen.ExclusiveDoubleClickMode}static set ExclusiveDoubleClickMode(a){Pe$$module$libs$world_onscreen.ExclusiveDoubleClickMode=
a}bindEyePosition(a,b="vEyePosition",c=!1){var d;const e=this._forcedViewPosition?this._forcedViewPosition:this._mirroredCameraPosition?this._mirroredCameraPosition:null!==(d=this.activeCamera.globalPosition)&&void 0!==d?d:this.activeCamera.devicePosition;return D$$module$libs$world_onscreen.Vector4[0].set(e.x,e.y,e.z,this.useRightHandedSystem===(null!=this._mirroredCameraPosition)?-1:1),a&&(c?a.setFloat3(b,D$$module$libs$world_onscreen.Vector4[0].x,D$$module$libs$world_onscreen.Vector4[0].y,D$$module$libs$world_onscreen.Vector4[0].z):
a.setVector4(b,D$$module$libs$world_onscreen.Vector4[0])),D$$module$libs$world_onscreen.Vector4[0]}finalizeSceneUbo(){const a=this.getSceneUniformBuffer(),b=this.bindEyePosition(null);return a.updateFloat4("vEyePosition",b.x,b.y,b.z,b.w),a.update(),a}set useRightHandedSystem(a){this._useRightHandedSystem!==a&&(this._useRightHandedSystem=a,this.markAllMaterialsAsDirty(16))}get useRightHandedSystem(){return this._useRightHandedSystem}setStepId(a){this._currentStepId=a}getStepId(){return this._currentStepId}getInternalStep(){return this._currentInternalStep}set fogEnabled(a){this._fogEnabled!==
a&&(this._fogEnabled=a,this.markAllMaterialsAsDirty(16))}get fogEnabled(){return this._fogEnabled}set fogMode(a){this._fogMode!==a&&(this._fogMode=a,this.markAllMaterialsAsDirty(16))}get fogMode(){return this._fogMode}get prePass(){return!!this.prePassRenderer&&this.prePassRenderer.defaultRT.enabled}set shadowsEnabled(a){this._shadowsEnabled!==a&&(this._shadowsEnabled=a,this.markAllMaterialsAsDirty(2))}get shadowsEnabled(){return this._shadowsEnabled}set lightsEnabled(a){this._lightsEnabled!==a&&
(this._lightsEnabled=a,this.markAllMaterialsAsDirty(2))}get lightsEnabled(){return this._lightsEnabled}get activeCameras(){return this._activeCameras}set activeCameras(a){this._unObserveActiveCameras&&(this._unObserveActiveCameras(),this._unObserveActiveCameras=null);a&&(this._unObserveActiveCameras=br$$module$libs$world_onscreen(a,()=>{this.onActiveCamerasChanged.notifyObservers(this)}));this._activeCameras=a}get activeCamera(){return this._activeCamera}set activeCamera(a){a!==this._activeCamera&&
(this._activeCamera=a,this.onActiveCameraChanged.notifyObservers(this))}get defaultMaterial(){return this._defaultMaterial||(this._defaultMaterial=re$$module$libs$world_onscreen.DefaultMaterialFactory(this)),this._defaultMaterial}set defaultMaterial(a){this._defaultMaterial=a}set texturesEnabled(a){this._texturesEnabled!==a&&(this._texturesEnabled=a,this.markAllMaterialsAsDirty(1))}get texturesEnabled(){return this._texturesEnabled}set skeletonsEnabled(a){this._skeletonsEnabled!==a&&(this._skeletonsEnabled=
a,this.markAllMaterialsAsDirty(8))}get skeletonsEnabled(){return this._skeletonsEnabled}get collisionCoordinator(){return this._collisionCoordinator||(this._collisionCoordinator=re$$module$libs$world_onscreen.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator}get renderingManager(){return this._renderingManager}get frustumPlanes(){return this._frustumPlanes}_registerTransientComponents(){if(0<this._transientComponents.length){for(const a of this._transientComponents)a.register();
this._transientComponents.length=0}}_addComponent(a){this._components.push(a);this._transientComponents.push(a);a.addFromContainer&&a.serialize&&this._serializableComponents.push(a)}_getComponent(a){for(const b of this._components)if(b.name===a)return b;return null}getClassName(){return"Scene"}_getDefaultMeshCandidates(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates}_getDefaultSubMeshCandidates(a){return this._defaultSubMeshCandidates.data=
a.subMeshes,this._defaultSubMeshCandidates.length=a.subMeshes.length,this._defaultSubMeshCandidates}setDefaultCandidateProviders(){this.getActiveMeshCandidates=this._getDefaultMeshCandidates.bind(this);this.getActiveSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this);this.getIntersectingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this);this.getCollidingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this)}get meshUnderPointer(){return this._inputManager.meshUnderPointer}get pointerX(){return this._inputManager.pointerX}set pointerX(a){this._inputManager.pointerX=
a}get pointerY(){return this._inputManager.pointerY}set pointerY(a){this._inputManager.pointerY=a}getCachedMaterial(){return this._cachedMaterial}getCachedEffect(){return this._cachedEffect}getCachedVisibility(){return this._cachedVisibility}isCachedMaterialInvalid(a,b,c=1){return this._cachedEffect!==b||this._cachedMaterial!==a||this._cachedVisibility!==c}getEngine(){return this._engine}getTotalVertices(){return this._totalVertices.current}get totalVerticesPerfCounter(){return this._totalVertices}getActiveIndices(){return this._activeIndices.current}get totalActiveIndicesPerfCounter(){return this._activeIndices}getActiveParticles(){return this._activeParticles.current}get activeParticlesPerfCounter(){return this._activeParticles}getActiveBones(){return this._activeBones.current}get activeBonesPerfCounter(){return this._activeBones}getActiveMeshes(){return this._activeMeshes}getAnimationRatio(){return void 0!==
this._animationRatio?this._animationRatio:1}getRenderId(){return this._renderId}getFrameId(){return this._frameId}incrementRenderId(){this._renderId++}_createUbo(){this.setSceneUniformBuffer(this.createSceneUniformBuffer())}simulatePointerMove(a,b){return this._inputManager.simulatePointerMove(a,b),this}simulatePointerDown(a,b){return this._inputManager.simulatePointerDown(a,b),this}simulatePointerUp(a,b,c){return this._inputManager.simulatePointerUp(a,b,c),this}isPointerCaptured(a=0){return this._inputManager.isPointerCaptured(a)}attachControl(a=
!0,b=!0,c=!0){this._inputManager.attachControl(a,b,c)}detachControl(){this._inputManager.detachControl()}isReady(a=!0){if(this._isDisposed)return!1;let b;const c=this.getEngine();let d=!0;0<this._pendingData.length&&(d=!1);a&&(this._processedMaterials.reset(),this._materialsRenderTargets.reset());for(b=0;b<this.meshes.length;b++){var e=this.meshes[b];if(e.subMeshes&&0!==e.subMeshes.length)if(e.isReady(!0)){var g=e.hasThinInstances||"InstancedMesh"===e.getClassName()||"InstancedLinesMesh"===e.getClassName()||
c.getCaps().instancedArrays&&0<e.instances.length;for(const n of this._isReadyForMeshStage)n.action(e,g)||(d=!1);if(a&&(g=e.material||this.defaultMaterial))if(g._storeEffectOnSubMeshes)for(const n of e.subMeshes)(e=n.getMaterial())&&e.hasRenderTargetTextures&&null!=e.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(e)&&(this._processedMaterials.push(e),this._materialsRenderTargets.concatWithNoDuplicate(e.getRenderTargetTextures()));else g.hasRenderTargetTextures&&null!=g.getRenderTargetTextures&&
-1===this._processedMaterials.indexOf(g)&&(this._processedMaterials.push(g),this._materialsRenderTargets.concatWithNoDuplicate(g.getRenderTargetTextures()))}else d=!1}if(!d||!c.areAllEffectsReady())return!1;if(a)for(b=0;b<this._materialsRenderTargets.length;++b)if(!this._materialsRenderTargets.data[b].isReadyForRendering())return!1;for(b=0;b<this.geometries.length;b++)if(2===this.geometries[b].delayLoadState)return!1;if(this.activeCameras&&0<this.activeCameras.length)for(const n of this.activeCameras){if(!n.isReady(!0))return!1}else if(this.activeCamera&&
!this.activeCamera.isReady(!0))return!1;for(const n of this.particleSystems)if(!n.isReady())return!1;return!0}resetCachedMaterial(){this._cachedVisibility=this._cachedEffect=this._cachedMaterial=null}registerBeforeRender(a){this.onBeforeRenderObservable.add(a)}unregisterBeforeRender(a){this.onBeforeRenderObservable.removeCallback(a)}registerAfterRender(a){this.onAfterRenderObservable.add(a)}unregisterAfterRender(a){this.onAfterRenderObservable.removeCallback(a)}_executeOnceBeforeRender(a){const b=
()=>{a();setTimeout(()=>{this.unregisterBeforeRender(b)})};this.registerBeforeRender(b)}executeOnceBeforeRender(a,b){void 0!==b?setTimeout(()=>{this._executeOnceBeforeRender(a)},b):this._executeOnceBeforeRender(a)}addPendingData(a){this._pendingData.push(a)}removePendingData(a){const b=this.isLoading;a=this._pendingData.indexOf(a);-1!==a&&this._pendingData.splice(a,1);b&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)}getWaitingItemsCount(){return this._pendingData.length}get isLoading(){return 0<
this._pendingData.length}executeWhenReady(a,b=!1){this.onReadyObservable.addOnce(a);null===this._executeWhenReadyTimeoutId&&this._checkIsReady(b)}whenReadyAsync(a=!1){return new Promise(b=>{this.executeWhenReady(()=>{b()},a)})}_checkIsReady(a=!1){(this._registerTransientComponents(),this.isReady(a))?(this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null):this._isDisposed?(this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null):
this._executeWhenReadyTimeoutId=setTimeout(()=>{this.incrementRenderId();this._checkIsReady(a)},100)}get animatables(){return this._activeAnimatables}resetLastAnimationTimeFrame(){this._animationTimeLast=ai$$module$libs$world_onscreen.Now}getViewMatrix(){return this._viewMatrix}getProjectionMatrix(){return this._projectionMatrix}getTransformMatrix(){return this._transformMatrix}setTransformMatrix(a,b,c,d){!c&&!d&&this._multiviewSceneUbo&&(this._multiviewSceneUbo.dispose(),this._multiviewSceneUbo=
null);(this._viewUpdateFlag!==a.updateFlag||this._projectionUpdateFlag!==b.updateFlag)&&(this._viewUpdateFlag=a.updateFlag,this._projectionUpdateFlag=b.updateFlag,this._viewMatrix=a,this._projectionMatrix=b,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?mt$$module$libs$world_onscreen.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=mt$$module$libs$world_onscreen.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&
this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(c,d):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.updateMatrix("projection",this._projectionMatrix)))}getSceneUniformBuffer(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo}createSceneUniformBuffer(a){a=new V$$module$libs$world_onscreen(this._engine,void 0,!1,a??"scene");return a.addUniform("viewProjection",
16),a.addUniform("view",16),a.addUniform("projection",16),a.addUniform("vEyePosition",4),a}setSceneUniformBuffer(a){this._sceneUbo=a;this._projectionUpdateFlag=this._viewUpdateFlag=-1}getUniqueId(){return Or$$module$libs$world_onscreen.UniqueId}addMesh(a,b=!1){this._blockEntityCollection||(this.meshes.push(a),a._resyncLightSources(),a.parent||a._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(a),b&&a.getChildMeshes().forEach(c=>{this.addMesh(c)}))}removeMesh(a,b=!1){const c=this.meshes.indexOf(a);
return-1!==c&&(this.meshes[c]=this.meshes[this.meshes.length-1],this.meshes.pop(),a.parent||a._removeFromSceneRootNodes()),this._inputManager._invalidateMesh(a),this.onMeshRemovedObservable.notifyObservers(a),b&&a.getChildMeshes().forEach(d=>{this.removeMesh(d)}),c}addTransformNode(a){this._blockEntityCollection||a.getScene()===this&&-1!==a._indexInSceneTransformNodesArray||(a._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(a),a.parent||a._addToSceneRootNodes(),
this.onNewTransformNodeAddedObservable.notifyObservers(a))}removeTransformNode(a){const b=a._indexInSceneTransformNodesArray;if(-1!==b){if(b!==this.transformNodes.length-1){const c=this.transformNodes[this.transformNodes.length-1];this.transformNodes[b]=c;c._indexInSceneTransformNodesArray=b}a._indexInSceneTransformNodesArray=-1;this.transformNodes.pop();a.parent||a._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(a),b}removeSkeleton(a){const b=this.skeletons.indexOf(a);
return-1!==b&&(this.skeletons.splice(b,1),this.onSkeletonRemovedObservable.notifyObservers(a),this._executeActiveContainerCleanup(this._activeSkeletons)),b}removeMorphTargetManager(a){a=this.morphTargetManagers.indexOf(a);return-1!==a&&this.morphTargetManagers.splice(a,1),a}removeLight(a){const b=this.lights.indexOf(a);if(-1!==b){for(const c of this.meshes)c._removeLightSource(a,!1);this.lights.splice(b,1);this.sortLightsByPriority();a.parent||a._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(a),
b}removeCamera(a){const b=this.cameras.indexOf(a);if(-1!==b&&(this.cameras.splice(b,1),a.parent||a._removeFromSceneRootNodes()),this.activeCameras){const c=this.activeCameras.indexOf(a);-1!==c&&this.activeCameras.splice(c,1)}return this.activeCamera===a&&(0<this.cameras.length?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(a),b}removeParticleSystem(a){a=this.particleSystems.indexOf(a);return-1!==a&&(this.particleSystems.splice(a,1),this._executeActiveContainerCleanup(this._activeParticleSystems)),
a}removeAnimation(a){a=this.animations.indexOf(a);return-1!==a&&this.animations.splice(a,1),a}stopAnimation(a,b,c){}removeAnimationGroup(a){a=this.animationGroups.indexOf(a);return-1!==a&&this.animationGroups.splice(a,1),a}removeMultiMaterial(a){const b=this.multiMaterials.indexOf(a);return-1!==b&&this.multiMaterials.splice(b,1),this.onMultiMaterialRemovedObservable.notifyObservers(a),b}removeMaterial(a){const b=a._indexInSceneMaterialArray;if(-1!==b&&b<this.materials.length){if(b!==this.materials.length-
1){const c=this.materials[this.materials.length-1];this.materials[b]=c;c._indexInSceneMaterialArray=b}a._indexInSceneMaterialArray=-1;this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(a),b}removeActionManager(a){a=this.actionManagers.indexOf(a);return-1!==a&&this.actionManagers.splice(a,1),a}removeTexture(a){const b=this.textures.indexOf(a);return-1!==b&&this.textures.splice(b,1),this.onTextureRemovedObservable.notifyObservers(a),b}addLight(a){if(!this._blockEntityCollection){this.lights.push(a);
this.sortLightsByPriority();a.parent||a._addToSceneRootNodes();for(const b of this.meshes)-1===b.lightSources.indexOf(a)&&(b.lightSources.push(a),b._resyncLightSources());this.onNewLightAddedObservable.notifyObservers(a)}}sortLightsByPriority(){this.requireLightSorting&&this.lights.sort(Ee$$module$libs$world_onscreen.CompareLightsPriority)}addCamera(a){this._blockEntityCollection||(this.cameras.push(a),this.onNewCameraAddedObservable.notifyObservers(a),a.parent||a._addToSceneRootNodes())}addSkeleton(a){this._blockEntityCollection||
(this.skeletons.push(a),this.onNewSkeletonAddedObservable.notifyObservers(a))}addParticleSystem(a){this._blockEntityCollection||this.particleSystems.push(a)}addAnimation(a){this._blockEntityCollection||this.animations.push(a)}addAnimationGroup(a){this._blockEntityCollection||this.animationGroups.push(a)}addMultiMaterial(a){this._blockEntityCollection||(this.multiMaterials.push(a),this.onNewMultiMaterialAddedObservable.notifyObservers(a))}addMaterial(a){this._blockEntityCollection||a.getScene()===
this&&-1!==a._indexInSceneMaterialArray||(a._indexInSceneMaterialArray=this.materials.length,this.materials.push(a),this.onNewMaterialAddedObservable.notifyObservers(a))}addMorphTargetManager(a){this._blockEntityCollection||this.morphTargetManagers.push(a)}addGeometry(a){this._blockEntityCollection||(this._geometriesByUniqueId&&(this._geometriesByUniqueId[a.uniqueId]=this.geometries.length),this.geometries.push(a))}addActionManager(a){this.actionManagers.push(a)}addTexture(a){this._blockEntityCollection||
(this.textures.push(a),this.onNewTextureAddedObservable.notifyObservers(a))}switchActiveCamera(a,b=!0){this._engine.getInputElement()&&(this.activeCamera&&this.activeCamera.detachControl(),this.activeCamera=a,b&&a.attachControl())}setActiveCameraById(a){return(a=this.getCameraById(a))?(this.activeCamera=a,a):null}setActiveCameraByName(a){return(a=this.getCameraByName(a))?(this.activeCamera=a,a):null}getAnimationGroupByName(a){for(let b=0;b<this.animationGroups.length;b++)if(this.animationGroups[b].name===
a)return this.animationGroups[b];return null}_getMaterial(a,b){for(var c=0;c<this.materials.length;c++){const d=this.materials[c];if(b(d))return d}if(a)for(a=0;a<this.multiMaterials.length;a++)if(c=this.multiMaterials[a],b(c))return c;return null}getMaterialByUniqueID(a,b=!1){return this._getMaterial(b,c=>c.uniqueId===a)}getMaterialById(a,b=!1){return this._getMaterial(b,c=>c.id===a)}getMaterialByName(a,b=!1){return this._getMaterial(b,c=>c.name===a)}getLastMaterialById(a,b=!1){for(let c=this.materials.length-
1;0<=c;c--)if(this.materials[c].id===a)return this.materials[c];if(b)for(b=this.multiMaterials.length-1;0<=b;b--)if(this.multiMaterials[b].id===a)return this.multiMaterials[b];return null}getTextureByUniqueId(a){for(let b=0;b<this.textures.length;b++)if(this.textures[b].uniqueId===a)return this.textures[b];return null}getTextureByName(a){for(let b=0;b<this.textures.length;b++)if(this.textures[b].name===a)return this.textures[b];return null}getCameraById(a){for(let b=0;b<this.cameras.length;b++)if(this.cameras[b].id===
a)return this.cameras[b];return null}getCameraByUniqueId(a){for(let b=0;b<this.cameras.length;b++)if(this.cameras[b].uniqueId===a)return this.cameras[b];return null}getCameraByName(a){for(let b=0;b<this.cameras.length;b++)if(this.cameras[b].name===a)return this.cameras[b];return null}getBoneById(a){for(let b=0;b<this.skeletons.length;b++){const c=this.skeletons[b];for(let d=0;d<c.bones.length;d++)if(c.bones[d].id===a)return c.bones[d]}return null}getBoneByName(a){for(let b=0;b<this.skeletons.length;b++){const c=
this.skeletons[b];for(let d=0;d<c.bones.length;d++)if(c.bones[d].name===a)return c.bones[d]}return null}getLightByName(a){for(let b=0;b<this.lights.length;b++)if(this.lights[b].name===a)return this.lights[b];return null}getLightById(a){for(let b=0;b<this.lights.length;b++)if(this.lights[b].id===a)return this.lights[b];return null}getLightByUniqueId(a){for(let b=0;b<this.lights.length;b++)if(this.lights[b].uniqueId===a)return this.lights[b];return null}getParticleSystemById(a){for(let b=0;b<this.particleSystems.length;b++)if(this.particleSystems[b].id===
a)return this.particleSystems[b];return null}getGeometryById(a){for(let b=0;b<this.geometries.length;b++)if(this.geometries[b].id===a)return this.geometries[b];return null}_getGeometryByUniqueId(a){if(this._geometriesByUniqueId){if(a=this._geometriesByUniqueId[a],void 0!==a)return this.geometries[a]}else for(let b=0;b<this.geometries.length;b++)if(this.geometries[b].uniqueId===a)return this.geometries[b];return null}pushGeometry(a,b){return!b&&this._getGeometryByUniqueId(a.uniqueId)?!1:(this.addGeometry(a),
this.onNewGeometryAddedObservable.notifyObservers(a),!0)}removeGeometry(a){let b;if(this._geometriesByUniqueId){if(b=this._geometriesByUniqueId[a.uniqueId],void 0===b)return!1}else if(b=this.geometries.indexOf(a),0>b)return!1;if(b!==this.geometries.length-1){const c=this.geometries[this.geometries.length-1];c&&(this.geometries[b]=c,this._geometriesByUniqueId&&(this._geometriesByUniqueId[c.uniqueId]=b))}return this._geometriesByUniqueId&&(this._geometriesByUniqueId[a.uniqueId]=void 0),this.geometries.pop(),
this.onGeometryRemovedObservable.notifyObservers(a),!0}getGeometries(){return this.geometries}getMeshById(a){for(let b=0;b<this.meshes.length;b++)if(this.meshes[b].id===a)return this.meshes[b];return null}getMeshesById(a){return this.meshes.filter(function(b){return b.id===a})}getTransformNodeById(a){for(let b=0;b<this.transformNodes.length;b++)if(this.transformNodes[b].id===a)return this.transformNodes[b];return null}getTransformNodeByUniqueId(a){for(let b=0;b<this.transformNodes.length;b++)if(this.transformNodes[b].uniqueId===
a)return this.transformNodes[b];return null}getTransformNodesById(a){return this.transformNodes.filter(function(b){return b.id===a})}getMeshByUniqueId(a){for(let b=0;b<this.meshes.length;b++)if(this.meshes[b].uniqueId===a)return this.meshes[b];return null}getLastMeshById(a){for(let b=this.meshes.length-1;0<=b;b--)if(this.meshes[b].id===a)return this.meshes[b];return null}getLastEntryById(a){let b;for(b=this.meshes.length-1;0<=b;b--)if(this.meshes[b].id===a)return this.meshes[b];for(b=this.transformNodes.length-
1;0<=b;b--)if(this.transformNodes[b].id===a)return this.transformNodes[b];for(b=this.cameras.length-1;0<=b;b--)if(this.cameras[b].id===a)return this.cameras[b];for(b=this.lights.length-1;0<=b;b--)if(this.lights[b].id===a)return this.lights[b];return null}getNodeById(a){var b=this.getMeshById(a);return b||(b=this.getTransformNodeById(a))||(b=this.getLightById(a))?b:(b=this.getCameraById(a))?b:this.getBoneById(a)||null}getNodeByName(a){var b=this.getMeshByName(a);return b||(b=this.getTransformNodeByName(a))||
(b=this.getLightByName(a))?b:(b=this.getCameraByName(a))?b:this.getBoneByName(a)||null}getMeshByName(a){for(let b=0;b<this.meshes.length;b++)if(this.meshes[b].name===a)return this.meshes[b];return null}getTransformNodeByName(a){for(let b=0;b<this.transformNodes.length;b++)if(this.transformNodes[b].name===a)return this.transformNodes[b];return null}getLastSkeletonById(a){for(let b=this.skeletons.length-1;0<=b;b--)if(this.skeletons[b].id===a)return this.skeletons[b];return null}getSkeletonByUniqueId(a){for(let b=
0;b<this.skeletons.length;b++)if(this.skeletons[b].uniqueId===a)return this.skeletons[b];return null}getSkeletonById(a){for(let b=0;b<this.skeletons.length;b++)if(this.skeletons[b].id===a)return this.skeletons[b];return null}getSkeletonByName(a){for(let b=0;b<this.skeletons.length;b++)if(this.skeletons[b].name===a)return this.skeletons[b];return null}getMorphTargetManagerById(a){for(let b=0;b<this.morphTargetManagers.length;b++)if(this.morphTargetManagers[b].uniqueId===a)return this.morphTargetManagers[b];
return null}getMorphTargetById(a){for(let b=0;b<this.morphTargetManagers.length;++b){const c=this.morphTargetManagers[b];for(let d=0;d<c.numTargets;++d){const e=c.getTarget(d);if(e.id===a)return e}}return null}getMorphTargetByName(a){for(let b=0;b<this.morphTargetManagers.length;++b){const c=this.morphTargetManagers[b];for(let d=0;d<c.numTargets;++d){const e=c.getTarget(d);if(e.name===a)return e}}return null}getPostProcessByName(a){for(let b=0;b<this.postProcesses.length;++b){const c=this.postProcesses[b];
if(c.name===a)return c}return null}isActiveMesh(a){return-1!==this._activeMeshes.indexOf(a)}get uid(){return this._uid||(this._uid=X$$module$libs$world_onscreen.RandomId()),this._uid}addExternalData(a,b){return this._externalData||(this._externalData=new Js$$module$libs$world_onscreen),this._externalData.add(a,b)}getExternalData(a){return this._externalData?this._externalData.get(a):null}getOrAddExternalDataWithFactory(a,b){return this._externalData||(this._externalData=new Js$$module$libs$world_onscreen),
this._externalData.getOrAddWithFactory(a,b)}removeExternalData(a){return this._externalData.remove(a)}_evaluateSubMesh(a,b,c,d){if(d||a.isInFrustum(this._frustumPlanes)){for(const e of this._evaluateSubMeshStage)e.action(b,a);c=a.getMaterial();null!=c&&(c.hasRenderTargetTextures&&null!=c.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(c)&&(this._processedMaterials.push(c),this._materialsRenderTargets.concatWithNoDuplicate(c.getRenderTargetTextures())),this._renderingManager.dispatch(a,
b,c))}}freeProcessedMaterials(){this._processedMaterials.dispose()}get blockfreeActiveMeshesAndRenderingGroups(){return this._preventFreeActiveMeshesAndRenderingGroups}set blockfreeActiveMeshesAndRenderingGroups(a){this._preventFreeActiveMeshesAndRenderingGroups!==a&&(a&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=a)}freeActiveMeshes(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&
this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(let a=0;a<this.activeCameras.length;a++){const b=this.activeCameras[a];b&&b._activeMeshes&&b._activeMeshes.dispose()}}freeRenderingGroups(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(let a=0;a<this.textures.length;a++){const b=this.textures[a];b&&b.renderList&&b.freeRenderingGroups()}}_isInIntermediateRendering(){return this._intermediateRendering}freezeActiveMeshes(a=
!1,b,c,d=!0,e=!1){return this.executeWhenReady(()=>{if(this.activeCamera){if(this._frustumPlanes||this.updateTransformMatrix(),this._evaluateActiveMeshes(),this._activeMeshesFrozen=!0,this._activeMeshesFrozenButKeepClipping=e,this._skipEvaluateActiveMeshesCompletely=a,d)for(let g=0;g<this._activeMeshes.length;g++)this._activeMeshes.data[g]._freeze();b&&b()}else c&&c("No active camera found")}),this}unfreezeActiveMeshes(){for(var a=0;a<this.meshes.length;a++){const b=this.meshes[a];b._internalAbstractMeshDataInfo&&
(b._internalAbstractMeshDataInfo._isActive=!1)}for(a=0;a<this._activeMeshes.length;a++)this._activeMeshes.data[a]._unFreeze();return this._activeMeshesFrozen=!1,this}_executeActiveContainerCleanup(a){(!this._engine.snapshotRendering||1!==this._engine.snapshotRenderingMode)&&this._activeMeshesFrozen&&this._activeMeshes.length||this.onBeforeRenderObservable.addOnce(()=>a.dispose())}_evaluateActiveMeshes(){var a;if(this._engine.snapshotRendering&&1===this._engine.snapshotRenderingMode)0<this._activeMeshes.length&&
(null===(a=this.activeCamera)||void 0===a||a._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset());else if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely){var b=this._activeMeshes.length;for(a=0;a<b;a++)this._activeMeshes.data[a].computeWorldMatrix()}if(this._activeParticleSystems)for(b=
this._activeParticleSystems.length,a=0;a<b;a++)this._activeParticleSystems.data[a].animate();this._renderingManager.resetSprites()}else if(this.activeCamera){this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this);this.activeCamera._activeMeshes.reset();this._activeMeshes.reset();this._renderingManager.reset();this._processedMaterials.reset();this._activeParticleSystems.reset();this._activeSkeletons.reset();this._softwareSkinnedMeshes.reset();this._materialsRenderTargets.reset();for(var c of this._beforeEvaluateActiveMeshStage)c.action();
a=this.getActiveMeshCandidates();c=a.length;for(let d=0;d<c;d++){const e=a.data[d];if(e._internalAbstractMeshDataInfo._currentLODIsUpToDate=!1,e.isBlocked||(this._totalVertices.addCount(e.getTotalVertices(),!1),!e.isReady()||!e.isEnabled()||e.scaling.hasAZeroComponent))continue;e.computeWorldMatrix();e.actionManager&&e.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(e);let g=this.customLODSelector?this.customLODSelector(e,this.activeCamera):e.getLOD(this.activeCamera);
if(e._internalAbstractMeshDataInfo._currentLOD=g,e._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0,null!=g&&(g!==e&&0!==g.billboardMode&&g.computeWorldMatrix(),e._preActivate(),e.isVisible&&0<e.visibility&&e.layerMask&this.activeCamera.layerMask&&(this._skipFrustumClipping||e.alwaysSelectAsActiveMesh||e.isInFrustum(this._frustumPlanes)))){this._activeMeshes.push(e);this.activeCamera._activeMeshes.push(e);g!==e&&g._activate(this._renderId,!1);for(b of this._preActiveMeshStage)b.action(e);e._activate(this._renderId,
!1)&&(e.isAnInstance?e._internalAbstractMeshDataInfo._actAsRegularMesh&&(g=e):g._internalAbstractMeshDataInfo._onlyForInstances=!1,g._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(e,g));e._postActivate()}}if(this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(b=0;b<this.particleSystems.length;b++)a=this.particleSystems[b],a.isStarted()&&a.emitter&&(c=a.emitter,c.position&&!c.isEnabled()||(this._activeParticleSystems.push(a),a.animate(),this._renderingManager.dispatchParticles(a)));
this.onAfterParticlesRenderingObservable.notifyObservers(this)}}}_activeMesh(a,b){this._skeletonsEnabled&&null!==b.skeleton&&void 0!==b.skeleton&&(this._activeSkeletons.pushNoDuplicate(b.skeleton)&&(b.skeleton.prepare(),this._activeBones.addCount(b.skeleton.bones.length,!1)),b.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(b));let c=a.hasInstances||a.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||b.alwaysSelectAsActiveMesh;if(b&&b.subMeshes&&
0<b.subMeshes.length){const d=this.getActiveSubMeshCandidates(b),e=d.length;c=c||1===e;for(let g=0;g<e;g++)this._evaluateSubMesh(d.data[g],b,a,c)}}updateTransformMatrix(a){if(this.activeCamera)if(this.activeCamera._renderingMultiview){const b=this.activeCamera._rigCameras[0],c=this.activeCamera._rigCameras[1];this.setTransformMatrix(b.getViewMatrix(),b.getProjectionMatrix(a),c.getViewMatrix(),c.getProjectionMatrix(a))}else this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(a))}_bindFrameBuffer(a,
b=!0){a&&a._multiviewTexture?a._multiviewTexture._bindFrameBuffer():a&&a.outputRenderTarget?a.outputRenderTarget._bindFrameBuffer():this._engine._currentFrameBufferIsDefaultFrameBuffer()||this._engine.restoreDefaultFramebuffer();b&&this._clearFrameBuffer(a)}_clearFrameBuffer(a){a&&a._multiviewTexture||(a&&a.outputRenderTarget&&!a._renderingMultiview?(a=a.outputRenderTarget,a.onClearObservable.hasObservers()?a.onClearObservable.notifyObservers(this._engine):a.skipInitialClear||(this.autoClear&&this._engine.clear(a.clearColor||
this.clearColor,!a._cleared,!0,!0),a._cleared=!0)):this._defaultFrameBufferCleared?this._engine.clear(null,!1,!0,!0):(this._defaultFrameBufferCleared=!0,this._clear()))}_renderForCamera(a,b,c=!0){var d,e,g;if(!a||!a._skipRendering){var n=this._engine;if(this._activeCamera=a,!this.activeCamera)throw Error("Active camera not set");if(n.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,!this.prePass&&c)c=!0,a._renderingMultiview&&a.outputRenderTarget&&(c=a.outputRenderTarget.skipInitialClear,
this.autoClear&&(a.outputRenderTarget.skipInitialClear=!1)),this._bindFrameBuffer(this._activeCamera),a._renderingMultiview&&a.outputRenderTarget&&(a.outputRenderTarget.skipInitialClear=c);this.updateTransformMatrix();this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera);this._evaluateActiveMeshes();for(c=0;c<this._softwareSkinnedMeshes.length;c++){const w=this._softwareSkinnedMeshes.data[c];w.applySkeleton(w.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);
this._renderTargets.concatWithNoDuplicate(this._materialsRenderTargets);a.customRenderTargets&&0<a.customRenderTargets.length&&this._renderTargets.concatWithNoDuplicate(a.customRenderTargets);b&&b.customRenderTargets&&0<b.customRenderTargets.length&&this._renderTargets.concatWithNoDuplicate(b.customRenderTargets);this.environmentTexture&&this.environmentTexture.isRenderTarget&&this._renderTargets.pushNoDuplicate(this.environmentTexture);for(var t of this._gatherActiveCameraRenderTargetsStage)t.action(this._renderTargets);
b=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,0<this._renderTargets.length){X$$module$libs$world_onscreen.StartPerformanceCounter("Render targets",0<this._renderTargets.length);for(t=0;t<this._renderTargets.length;t++)c=this._renderTargets.data[t],c._shouldRender()&&(this._renderId++,c.render(c.activeCamera&&c.activeCamera!==this.activeCamera,this.dumpNextRenderTargets),b=!0);X$$module$libs$world_onscreen.EndPerformanceCounter("Render targets",0<this._renderTargets.length);
this._renderId++}for(const w of this._cameraDrawRenderTargetStage)b=w.action(this.activeCamera)||b;this._intermediateRendering=!1}this._engine.currentRenderPassId=null!==(g=null!==(e=null===(d=a.outputRenderTarget)||void 0===d?void 0:d.renderPassId)&&void 0!==e?e:a.renderPassId)&&void 0!==g?g:0;b&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1);this.onAfterRenderTargetsRenderObservable.notifyObservers(this);this.postProcessManager&&!a._multiviewTexture&&!this.prePass&&this.postProcessManager._prepareFrame();
for(const w of this._beforeCameraDrawStage)w.action(this.activeCamera);this.onBeforeDrawPhaseObservable.notifyObservers(this);n.snapshotRendering&&1===n.snapshotRenderingMode&&this.finalizeSceneUbo();this._renderingManager.render(null,null,!0,!0);this.onAfterDrawPhaseObservable.notifyObservers(this);for(const w of this._afterCameraDrawStage)w.action(this.activeCamera);this.postProcessManager&&!a._multiviewTexture&&this.postProcessManager._finalizeFrame(a.isIntermediate,a.outputRenderTarget?a.outputRenderTarget.renderTarget:
void 0);for(const w of this._afterCameraPostProcessStage)w.action(this.activeCamera);this._renderTargets.reset();this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}}_processSubCameras(a,b=!0){if(0===a.cameraRigMode||a._renderingMultiview)a._renderingMultiview&&!this._multiviewSceneUbo&&this._createMultiviewUbo(),this._renderForCamera(a,void 0,b);else{if(a._useMultiviewToSingleView)this._renderMultiviewToSingleView(a);else for(this.onBeforeCameraRenderObservable.notifyObservers(a),
b=0;b<a._rigCameras.length;b++)this._renderForCamera(a._rigCameras[b],a);this._activeCamera=a;this.updateTransformMatrix()}this.onAfterRenderCameraObservable.notifyObservers(a)}_checkIntersections(){for(let b=0;b<this._meshesForIntersections.length;b++){const c=this._meshesForIntersections.data[b];if(c.actionManager)for(let d=0;c.actionManager&&d<c.actionManager.actions.length;d++){const e=c.actionManager.actions[d];if(12===e.trigger||13===e.trigger){var a=e.getTriggerParameter();const g=a.mesh?a.mesh:
a;a=g.intersectsMesh(c,a.usePreciseIntersection);const n=c._intersectionsInProgress.indexOf(g);a&&-1===n?12===e.trigger?(e._executeCurrent(We$$module$libs$world_onscreen.CreateNew(c,void 0,g)),c._intersectionsInProgress.push(g)):13===e.trigger&&c._intersectionsInProgress.push(g):!a&&-1<n&&(13===e.trigger&&e._executeCurrent(We$$module$libs$world_onscreen.CreateNew(c,void 0,g)),(!c.actionManager.hasSpecificTrigger(13,t=>g===(t.mesh?t.mesh:t))||13===e.trigger)&&c._intersectionsInProgress.splice(n,1))}}}}_advancePhysicsEngineStep(a){}_animate(){}animate(){if(this._engine.isDeterministicLockStep()){var a=
Math.max(re$$module$libs$world_onscreen.MinDeltaTime,Math.min(this._engine.getDeltaTime(),re$$module$libs$world_onscreen.MaxDeltaTime))+this._timeAccumulator;const b=this._engine.getTimeStep(),c=1E3/b/1E3;let d=0;const e=this._engine.getLockstepMaxSteps();let g=Math.floor(a/b);for(g=Math.min(g,e);0<a&&d<g;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=b*c,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(b),
this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,d++,a-=b;this._timeAccumulator=0>a?0:a}else a=this.useConstantAnimationDeltaTime?16:Math.max(re$$module$libs$world_onscreen.MinDeltaTime,Math.min(this._engine.getDeltaTime(),re$$module$libs$world_onscreen.MaxDeltaTime)),this._animationRatio=.06*a,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(a)}_clear(){(this.autoClearDepthAndStencil||this.autoClear)&&
this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil)}_checkCameraRenderTarget(a){var b;if(null!=a&&a.outputRenderTarget&&!(null!=a&&a.isRigCamera)&&(a.outputRenderTarget._cleared=!1),null!==(b=null==a?void 0:a.rigCameras)&&void 0!==b&&b.length)for(b=0;b<a.rigCameras.length;++b){const c=a.rigCameras[b].outputRenderTarget;c&&(c._cleared=!1)}}resetDrawCache(a){if(this.meshes)for(const b of this.meshes)b.resetDrawCache(a)}render(a=
!0,b=!1){var c,d,e;if(!this.isDisposed){this.onReadyObservable.hasObservers()&&null===this._executeWhenReadyTimeoutId&&this._checkIsReady();this._frameId++;this._defaultFrameBufferCleared=!1;this._checkCameraRenderTarget(this.activeCamera);null!==(c=this.activeCameras)&&void 0!==c&&c.length&&this.activeCameras.forEach(this._checkCameraRenderTarget);this._registerTransientComponents();this._activeParticles.fetchNewFrame();this._totalVertices.fetchNewFrame();this._activeIndices.fetchNewFrame();this._activeBones.fetchNewFrame();
this._meshesForIntersections.reset();this.resetCachedMaterial();this.onBeforeAnimationsObservable.notifyObservers(this);this.actionManager&&this.actionManager.processTrigger(11);b||this.animate();for(const n of this._beforeCameraUpdateStage)n.action();if(a)if(this.activeCameras&&0<this.activeCameras.length)for(a=0;a<this.activeCameras.length;a++){if(b=this.activeCameras[a],b.update(),0!==b.cameraRigMode)for(c=0;c<b._rigCameras.length;c++)b._rigCameras[c].update()}else if(this.activeCamera&&(this.activeCamera.update(),
0!==this.activeCamera.cameraRigMode))for(a=0;a<this.activeCamera._rigCameras.length;a++)this.activeCamera._rigCameras[a].update();this.onBeforeRenderObservable.notifyObservers(this);a=this.getEngine();this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);b=null!==(d=this.activeCameras)&&void 0!==d&&d.length?this.activeCameras[0]:this.activeCamera;if(this.renderTargetsEnabled){X$$module$libs$world_onscreen.StartPerformanceCounter("Custom render targets",0<this.customRenderTargets.length);
this._intermediateRendering=!0;for(d=0;d<this.customRenderTargets.length;d++)if(c=this.customRenderTargets[d],c._shouldRender()){if(this._renderId++,this.activeCamera=c.activeCamera||this.activeCamera,!this.activeCamera)throw Error("Active camera not set");a.setViewport(this.activeCamera.viewport);this.updateTransformMatrix();c.render(b!==this.activeCamera,this.dumpNextRenderTargets)}X$$module$libs$world_onscreen.EndPerformanceCounter("Custom render targets",0<this.customRenderTargets.length);this._intermediateRendering=
!1;this._renderId++}this._engine.currentRenderPassId=null!==(e=null==b?void 0:b.renderPassId)&&void 0!==e?e:0;this.activeCamera=b;this._activeCamera&&22!==this._activeCamera.cameraRigMode&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1);this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(const n of this._beforeClearStage)n.action();this._clearFrameBuffer(this.activeCamera);for(const n of this._gatherRenderTargetsStage)n.action(this._renderTargets);if(this.activeCameras&&
0<this.activeCameras.length)for(e=0;e<this.activeCameras.length;e++)this._processSubCameras(this.activeCameras[e],0<e);else{if(!this.activeCamera)throw Error("No camera defined");this._processSubCameras(this.activeCamera,!!this.activeCamera.outputRenderTarget)}this._checkIntersections();for(var g of this._afterRenderStage)g.action();if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(g=0;g<this._toBeDisposed.length;g++)(e=this._toBeDisposed[g])&&
e.dispose();this._toBeDisposed.length=0}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1);this._activeBones.addCount(0,!0);this._activeIndices.addCount(0,!0);this._activeParticles.addCount(0,!0);this._engine.restoreDefaultFramebuffer()}}freezeMaterials(){for(let a=0;a<this.materials.length;a++)this.materials[a].freeze()}unfreezeMaterials(){for(let a=0;a<this.materials.length;a++)this.materials[a].unfreeze()}dispose(){if(!this.isDisposed){this.metadata=this.afterRender=this.beforeRender=
null;this.skeletons.length=0;this.morphTargetManagers.length=0;this._transientComponents.length=0;this._isReadyForMeshStage.clear();this._beforeEvaluateActiveMeshStage.clear();this._evaluateSubMeshStage.clear();this._preActiveMeshStage.clear();this._cameraDrawRenderTargetStage.clear();this._beforeCameraDrawStage.clear();this._beforeRenderTargetDrawStage.clear();this._beforeRenderingGroupDrawStage.clear();this._beforeRenderingMeshStage.clear();this._afterRenderingMeshStage.clear();this._afterRenderingGroupDrawStage.clear();
this._afterCameraDrawStage.clear();this._afterRenderTargetDrawStage.clear();this._afterRenderStage.clear();this._beforeCameraUpdateStage.clear();this._beforeClearStage.clear();this._gatherRenderTargetsStage.clear();this._gatherActiveCameraRenderTargetsStage.clear();this._pointerMoveStage.clear();this._pointerDownStage.clear();this._pointerUpStage.clear();this.importedMeshesFiles=[];this.stopAllAnimations&&this.stopAllAnimations();this.resetCachedMaterial();this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),
this.activeCamera=null);this.activeCameras=null;this._activeMeshes.dispose();this._renderingManager.dispose();this._processedMaterials.dispose();this._activeParticleSystems.dispose();this._activeSkeletons.dispose();this._softwareSkinnedMeshes.dispose();this._renderTargets.dispose();this._materialsRenderTargets.dispose();this._registeredForLateAnimationBindings.dispose();this._meshesForIntersections.dispose();this._toBeDisposed.length=0;var a=this._activeRequests.slice();for(const b of a)b.abort();
this._activeRequests.length=0;try{this.onDisposeObservable.notifyObservers(this)}catch(b){console.error("An error occurred while calling onDisposeObservable!",b)}if(this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),
this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),
this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),
this.onNewMaterialAddedObservable.clear(),this.onNewMultiMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onMultiMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.detachControl(),this._engine.getInputElement())for(a=0;a<this.cameras.length;a++)this.cameras[a].detachControl();
this._disposeList(this.animationGroups);this._disposeList(this.lights);this._disposeList(this.meshes,b=>b.dispose(!0));this._disposeList(this.transformNodes,b=>b.dispose(!0));this._disposeList(this.cameras);this._defaultMaterial&&this._defaultMaterial.dispose();this._disposeList(this.multiMaterials);this._disposeList(this.materials);this._disposeList(this.particleSystems);this._disposeList(this.postProcesses);this._disposeList(this.textures);this._disposeList(this.morphTargetManagers);this._sceneUbo.dispose();
this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose();this.postProcessManager.dispose();this._disposeList(this._components);a=this._engine.scenes.indexOf(this);-1<a&&this._engine.scenes.splice(a,1);fe$$module$libs$world_onscreen._LastCreatedScene===this&&(0<this._engine.scenes.length?fe$$module$libs$world_onscreen._LastCreatedScene=this._engine.scenes[this._engine.scenes.length-1]:fe$$module$libs$world_onscreen._LastCreatedScene=null);a=this._engine._virtualScenes.indexOf(this);-1<a&&this._engine._virtualScenes.splice(a,
1);this._engine.wipeCaches(!0);this._isDisposed=!0}}_disposeList(a,b){const c=a.slice(0);b=b??(d=>d.dispose());for(const d of c)b(d);a.length=0}get isDisposed(){return this._isDisposed}clearCachedVertexData(){for(let a=0;a<this.meshes.length;a++){const b=this.meshes[a].geometry;b&&b.clearCachedData()}}cleanCachedTextureBuffer(){for(const a of this.textures)a._buffer&&(a._buffer=null)}getWorldExtends(a){const b=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),c=
new p$$module$libs$world_onscreen(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return a=a||(()=>!0),this.meshes.filter(a).forEach(d=>{if(d.computeWorldMatrix(!0),d.subMeshes&&0!==d.subMeshes.length&&!d.infiniteDistance){d=d.getBoundingInfo();var e=d.boundingBox.maximumWorld;p$$module$libs$world_onscreen.CheckExtends(d.boundingBox.minimumWorld,b,c);p$$module$libs$world_onscreen.CheckExtends(e,b,c)}}),{min:b,max:c}}createPickingRay(a,b,c,d,e){throw $$$module$libs$world_onscreen("Ray");}createPickingRayToRef(a,
b,c,d,e,g,n){throw $$$module$libs$world_onscreen("Ray");}createPickingRayInCameraSpace(a,b,c){throw $$$module$libs$world_onscreen("Ray");}createPickingRayInCameraSpaceToRef(a,b,c,d){throw $$$module$libs$world_onscreen("Ray");}get _pickingAvailable(){return!1}pick(a,b,c,d,e,g){return new zt$$module$libs$world_onscreen}pickWithBoundingInfo(a,b,c,d,e){return new zt$$module$libs$world_onscreen}pickWithRay(a,b,c,d){throw $$$module$libs$world_onscreen("Ray");}multiPick(a,b,c,d,e){throw $$$module$libs$world_onscreen("Ray");
}multiPickWithRay(a,b,c){throw $$$module$libs$world_onscreen("Ray");}setPointerOverMesh(a,b,c){this._inputManager.setPointerOverMesh(a,b,c)}getPointerOverMesh(){return this._inputManager.getPointerOverMesh()}_rebuildGeometries(){for(const a of this.geometries)a._rebuild();for(const a of this.meshes)a._rebuild();this.postProcessManager&&this.postProcessManager._rebuild();for(const a of this._components)a.rebuild();for(const a of this.particleSystems)a.rebuild();if(this.spriteManagers)for(const a of this.spriteManagers)a.rebuild()}_rebuildTextures(){for(const a of this.textures)a._rebuild();
this.markAllMaterialsAsDirty(1)}_getByTags(a,b,c){if(void 0===b)return a;const d=[];c=c||(e=>{});for(const e in a){const g=a[e];ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.MatchesQuery(g,b)&&(d.push(g),c(g))}return d}getMeshesByTags(a,b){return this._getByTags(this.meshes,a,b)}getCamerasByTags(a,b){return this._getByTags(this.cameras,a,b)}getLightsByTags(a,b){return this._getByTags(this.lights,a,b)}getMaterialByTags(a,b){return this._getByTags(this.materials,a,b).concat(this._getByTags(this.multiMaterials,
a,b))}getTransformNodesByTags(a,b){return this._getByTags(this.transformNodes,a,b)}setRenderingOrder(a,b=null,c=null,d=null){this._renderingManager.setRenderingOrder(a,b,c,d)}setRenderingAutoClearDepthStencil(a,b,c=!0,d=!0){this._renderingManager.setRenderingAutoClearDepthStencil(a,b,c,d)}getAutoClearDepthStencilSetup(a){return this._renderingManager.getAutoClearDepthStencilSetup(a)}get blockMaterialDirtyMechanism(){return this._blockMaterialDirtyMechanism}set blockMaterialDirtyMechanism(a){this._blockMaterialDirtyMechanism!==
a&&(this._blockMaterialDirtyMechanism=a,a||this.markAllMaterialsAsDirty(63))}markAllMaterialsAsDirty(a,b){if(!this._blockMaterialDirtyMechanism)for(const c of this.materials)b&&!b(c)||c.markAsDirty(a)}_loadFile(a,b,c,d,e,g,n){a=$t$$module$libs$world_onscreen(a,b,c,d?this.offlineProvider:void 0,e,g,n);return this._activeRequests.push(a),a.onCompleteObservable.add(t=>{this._activeRequests.splice(this._activeRequests.indexOf(t),1)}),a}_loadFileAsync(a,b,c,d,e){return new Promise((g,n)=>{this._loadFile(a,
t=>{g(t)},b,c,d,(t,w)=>{n(w)},e)})}_requestFile(a,b,c,d,e,g,n){a=zs$$module$libs$world_onscreen(a,b,c,d?this.offlineProvider:void 0,e,g,n);return this._activeRequests.push(a),a.onCompleteObservable.add(t=>{this._activeRequests.splice(this._activeRequests.indexOf(t),1)}),a}_requestFileAsync(a,b,c,d,e){return new Promise((g,n)=>{this._requestFile(a,t=>{g(t)},b,c,d,t=>{n(t)},e)})}_readFile(a,b,c,d,e){a=wi$$module$libs$world_onscreen(a,b,c,d,e);return this._activeRequests.push(a),a.onCompleteObservable.add(g=>
{this._activeRequests.splice(this._activeRequests.indexOf(g),1)}),a}_readFileAsync(a,b,c){return new Promise((d,e)=>{this._readFile(a,g=>{d(g)},b,c,g=>{e(g)})})}getPerfCollector(){throw $$$module$libs$world_onscreen("performanceViewerSceneExtension");}}re$$module$libs$world_onscreen.FOGMODE_NONE=0;re$$module$libs$world_onscreen.FOGMODE_EXP=1;re$$module$libs$world_onscreen.FOGMODE_EXP2=2;re$$module$libs$world_onscreen.FOGMODE_LINEAR=3;re$$module$libs$world_onscreen.MinDeltaTime=1;
re$$module$libs$world_onscreen.MaxDeltaTime=1E3;re$$module$libs$world_onscreen.prototype.setActiveCameraByID=function(a){return this.setActiveCameraById(a)};re$$module$libs$world_onscreen.prototype.getLastMaterialByID=function(a){return this.getLastMaterialById(a)};re$$module$libs$world_onscreen.prototype.getMaterialByID=function(a){return this.getMaterialById(a)};re$$module$libs$world_onscreen.prototype.getTextureByUniqueID=function(a){return this.getTextureByUniqueId(a)};
re$$module$libs$world_onscreen.prototype.getCameraByID=function(a){return this.getCameraById(a)};re$$module$libs$world_onscreen.prototype.getCameraByUniqueID=function(a){return this.getCameraByUniqueId(a)};re$$module$libs$world_onscreen.prototype.getBoneByID=function(a){return this.getBoneById(a)};re$$module$libs$world_onscreen.prototype.getLightByID=function(a){return this.getLightById(a)};re$$module$libs$world_onscreen.prototype.getLightByUniqueID=function(a){return this.getLightByUniqueId(a)};
re$$module$libs$world_onscreen.prototype.getParticleSystemByID=function(a){return this.getParticleSystemById(a)};re$$module$libs$world_onscreen.prototype.getGeometryByID=function(a){return this.getGeometryById(a)};re$$module$libs$world_onscreen.prototype.getMeshByID=function(a){return this.getMeshById(a)};re$$module$libs$world_onscreen.prototype.getMeshesByID=function(a){return this.getMeshesById(a)};re$$module$libs$world_onscreen.prototype.getTransformNodeByID=function(a){return this.getTransformNodeById(a)};
re$$module$libs$world_onscreen.prototype.getTransformNodeByUniqueID=function(a){return this.getTransformNodeByUniqueId(a)};re$$module$libs$world_onscreen.prototype.getTransformNodesByID=function(a){return this.getTransformNodesById(a)};re$$module$libs$world_onscreen.prototype.getMeshByUniqueID=function(a){return this.getMeshByUniqueId(a)};re$$module$libs$world_onscreen.prototype.getLastMeshByID=function(a){return this.getLastMeshById(a)};re$$module$libs$world_onscreen.prototype.getLastEntryByID=function(a){return this.getLastEntryById(a)};
re$$module$libs$world_onscreen.prototype.getNodeByID=function(a){return this.getNodeById(a)};re$$module$libs$world_onscreen.prototype.getLastSkeletonByID=function(a){return this.getLastSkeletonById(a)};function Ls$$module$libs$world_onscreen(a,b,c){try{const d=a.next();d.done?b(d):d.value?d.value.then(()=>{d.value=void 0;b(d)},c):b(d)}catch(d){c(d)}}
function Un$$module$libs$world_onscreen(a=25){let b;return(c,d,e)=>{const g=performance.now();void 0===b||g-b>a?(b=g,setTimeout(()=>{Ls$$module$libs$world_onscreen(c,d,e)},0)):Ls$$module$libs$world_onscreen(c,d,e)}}function Lr$$module$libs$world_onscreen(a,b,c,d,e){const g=()=>{let n;const t=w=>{w.done?c(w.value):void 0===n?n=!0:g()};do n=void 0,e&&e.aborted?d(Error("Aborted")):b(a,t,d),void 0===n&&(n=!1);while(n)};g()}
function Ks$$module$libs$world_onscreen(a,b){let c;return Lr$$module$libs$world_onscreen(a,Ls$$module$libs$world_onscreen,d=>c=d,d=>{throw d;},b),c}function kn$$module$libs$world_onscreen(a,b,c){return new Promise((d,e)=>{Lr$$module$libs$world_onscreen(a,b,d,e,c)})}function Vn$$module$libs$world_onscreen(a,b){return(...c)=>Ks$$module$libs$world_onscreen(a(...c),b)}
class Wn$$module$libs$world_onscreen{constructor(){this._isDisposed=this._doNotSerialize=!1;this._sceneRootNodesIndex=-1;this._isReady=this._isParentEnabled=this._isEnabled=!0;this._onEnabledStateChangedObservable=new w$$module$libs$world_onscreen;this._onClonedObservable=new w$$module$libs$world_onscreen}}
class Xe$$module$libs$world_onscreen{constructor(a,b=null){this._isDirty=!1;this._nodeDataStorage=new Wn$$module$libs$world_onscreen;this.state="";this._accessibilityTag=this.reservedDataStore=this.metadata=null;this.onAccessibilityTagChangedObservable=new w$$module$libs$world_onscreen;this._parentContainer=null;this.animations=[];this._ranges={};this.onReady=null;this._childUpdateId=this._parentUpdateId=this._currentRenderId=-1;this._waitingParsedUniqueId=this._waitingParentInstanceIndex=this._waitingParentId=
null;this._cache={};this._children=this._parentNode=null;this._worldMatrix=x$$module$libs$world_onscreen.Identity();this._worldMatrixDeterminant=0;this._worldMatrixDeterminantIsDirty=!0;this._animationPropertiesOverride=null;this._isNode=!0;this.onDisposeObservable=new w$$module$libs$world_onscreen;this._onDisposeObserver=null;this._behaviors=[];this.id=this.name=a;this._scene=b||fe$$module$libs$world_onscreen.LastCreatedScene;this.uniqueId=this._scene.getUniqueId();this._initCache()}static AddNodeConstructor(a,
b){this._NodeConstructors[a]=b}static Construct(a,b,c,d){return(a=this._NodeConstructors[a])?a(b,c,d):null}set accessibilityTag(a){this._accessibilityTag=a;this.onAccessibilityTagChangedObservable.notifyObservers(a)}get accessibilityTag(){return this._accessibilityTag}get doNotSerialize(){return this._nodeDataStorage._doNotSerialize?!0:this._parentNode?this._parentNode.doNotSerialize:!1}set doNotSerialize(a){this._nodeDataStorage._doNotSerialize=a}isDisposed(){return this._nodeDataStorage._isDisposed}set parent(a){if(this._parentNode!==
a){var b=this._parentNode;if(this._parentNode&&void 0!==this._parentNode._children&&null!==this._parentNode._children){const c=this._parentNode._children.indexOf(this);-1!==c&&this._parentNode._children.splice(c,1);a||this._nodeDataStorage._isDisposed||this._addToSceneRootNodes()}(this._parentNode=a)&&((void 0===this._parentNode._children||null===this._parentNode._children)&&(this._parentNode._children=[]),this._parentNode._children.push(this),b||this._removeFromSceneRootNodes());this._syncParentEnabledState()}}get parent(){return this._parentNode}_serializeAsParent(a){a.parentId=
this.uniqueId}_addToSceneRootNodes(){-1===this._nodeDataStorage._sceneRootNodesIndex&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}_removeFromSceneRootNodes(){if(-1!==this._nodeDataStorage._sceneRootNodesIndex){const a=this._scene.rootNodes;a[this._nodeDataStorage._sceneRootNodesIndex]=a[a.length-1];a[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex;this._scene.rootNodes.pop();
this._nodeDataStorage._sceneRootNodesIndex=-1}}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(a){this._animationPropertiesOverride=a}getClassName(){return"Node"}set onDispose(a){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver);this._onDisposeObserver=this.onDisposeObservable.add(a)}get onEnabledStateChangedObservable(){return this._nodeDataStorage._onEnabledStateChangedObservable}get onClonedObservable(){return this._nodeDataStorage._onClonedObservable}getScene(){return this._scene}getEngine(){return this._scene.getEngine()}addBehavior(a,
b=!1){return-1!==this._behaviors.indexOf(a)?this:(a.init(),this._scene.isLoading&&!b?this._scene.onDataLoadedObservable.addOnce(()=>{a.attach(this)}):a.attach(this),this._behaviors.push(a),this)}removeBehavior(a){a=this._behaviors.indexOf(a);return-1===a?this:(this._behaviors[a].detach(),this._behaviors.splice(a,1),this)}get behaviors(){return this._behaviors}getBehaviorByName(a){for(const b of this._behaviors)if(b.name===a)return b;return null}getWorldMatrix(){return this._currentRenderId!==this._scene.getRenderId()&&
this.computeWorldMatrix(),this._worldMatrix}_getWorldMatrixDeterminant(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}get worldMatrixFromCache(){return this._worldMatrix}_initCache(){this._cache={};this._cache.parent=void 0}updateCache(a){!a&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())}_getActionManagerForTrigger(a,b){return this.parent?
this.parent._getActionManagerForTrigger(a,!1):null}_updateCache(a){}_isSynchronized(){return!0}_markSyncedWithParent(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}isSynchronizedWithParent(){return this._parentNode?this._parentNode._isDirty||this._parentUpdateId!==this._parentNode._childUpdateId?!1:this._parentNode.isSynchronized():!0}isSynchronized(){return this._cache.parent!==this._parentNode?(this._cache.parent=this._parentNode,!1):this._parentNode&&!this.isSynchronizedWithParent()?
!1:this._isSynchronized()}isReady(a){return this._nodeDataStorage._isReady}markAsDirty(a){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}isEnabled(a=!0){return!1===a?this._nodeDataStorage._isEnabled:this._nodeDataStorage._isEnabled?this._nodeDataStorage._isParentEnabled:!1}_syncParentEnabledState(){this._nodeDataStorage._isParentEnabled=this._parentNode?this._parentNode.isEnabled():!0;this._children&&this._children.forEach(a=>{a._syncParentEnabledState()})}setEnabled(a){this._nodeDataStorage._isEnabled!==
a&&(this._nodeDataStorage._isEnabled=a,this._syncParentEnabledState(),this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(a))}isDescendantOf(a){return this.parent?this.parent===a?!0:this.parent.isDescendantOf(a):!1}_getDescendants(a,b=!1,c){if(this._children)for(let d=0;d<this._children.length;d++){const e=this._children[d];c&&!c(e)||a.push(e);b||e._getDescendants(a,!1,c)}}getDescendants(a,b){const c=[];return this._getDescendants(c,a,b),c}getChildMeshes(a,b){const c=[];return this._getDescendants(c,
a,d=>(!b||b(d))&&void 0!==d.cullingStrategy),c}getChildren(a,b=!0){return this.getDescendants(b,a)}_setReady(a){a!==this._nodeDataStorage._isReady&&(a?(this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0):this._nodeDataStorage._isReady=!1)}getAnimationByName(a){for(let b=0;b<this.animations.length;b++){const c=this.animations[b];if(c.name===a)return c}return null}createAnimationRange(a,b,c){if(!this._ranges[a]){this._ranges[a]=Xe$$module$libs$world_onscreen._AnimationRangeFactory(a,
b,c);for(let d=0,e=this.animations.length;d<e;d++)this.animations[d]&&this.animations[d].createRange(a,b,c)}}deleteAnimationRange(a,b=!0){for(let c=0,d=this.animations.length;c<d;c++)this.animations[c]&&this.animations[c].deleteRange(a,b);this._ranges[a]=null}getAnimationRange(a){return this._ranges[a]||null}getAnimationRanges(){const a=[];let b;for(b in this._ranges)a.push(this._ranges[b]);return a}beginAnimation(a,b,c,d){return(a=this.getAnimationRange(a))?this._scene.beginAnimation(this,a.from,
a.to,b,c,d):null}serializeAnimationRanges(){const a=[];for(const b in this._ranges){const c=this._ranges[b];if(!c)continue;const d={};d.name=b;d.from=c.from;d.to=c.to;a.push(d)}return a}computeWorldMatrix(a){return this._worldMatrix||(this._worldMatrix=x$$module$libs$world_onscreen.Identity()),this._worldMatrix}dispose(a,b=!1){if(this._nodeDataStorage._isDisposed=!0,!a){const c=this.getDescendants(!0);for(const d of c)d.dispose(a,b)}this.parent?this.parent=null:this._removeFromSceneRootNodes();this.onDisposeObservable.notifyObservers(this);
this.onDisposeObservable.clear();this.onEnabledStateChangedObservable.clear();this.onClonedObservable.clear();for(const c of this._behaviors)c.detach();this._behaviors.length=0;this.metadata=null}static ParseAnimationRanges(a,b,c){if(b.ranges)for(c=0;c<b.ranges.length;c++){const d=b.ranges[c];a.createAnimationRange(d.name,d.from,d.to)}}getHierarchyBoundingVectors(a=!0,b=null){this.getScene().incrementRenderId();this.computeWorldMatrix(!0);let c;if(this.getBoundingInfo&&this.subMeshes){var d=this.getBoundingInfo();
c=d.boundingBox.minimumWorld.clone();d=d.boundingBox.maximumWorld.clone()}else c=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),d=new p$$module$libs$world_onscreen(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(a){a=this.getDescendants(!1);for(const e of a){a=e;if(a.computeWorldMatrix(!0),b&&!b(a)||!a.getBoundingInfo||0===a.getTotalVertices())continue;a=a.getBoundingInfo().boundingBox;const g=a.maximumWorld;p$$module$libs$world_onscreen.CheckExtends(a.minimumWorld,
c,d);p$$module$libs$world_onscreen.CheckExtends(g,c,d)}}return{min:c,max:d}}}Xe$$module$libs$world_onscreen._AnimationRangeFactory=(a,b,c)=>{throw $$$module$libs$world_onscreen("AnimationRange");};Xe$$module$libs$world_onscreen._NodeConstructors={};T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xe$$module$libs$world_onscreen.prototype,"name",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xe$$module$libs$world_onscreen.prototype,"id",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xe$$module$libs$world_onscreen.prototype,"uniqueId",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xe$$module$libs$world_onscreen.prototype,"state",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xe$$module$libs$world_onscreen.prototype,"metadata",void 0);
class Oi$$module$libs$world_onscreen{constructor(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d}toGlobal(a,b){return new Oi$$module$libs$world_onscreen(this.x*a,this.y*b,this.width*a,this.height*b)}toGlobalToRef(a,b,c){return c.x=this.x*a,c.y=this.y*b,c.width=this.width*a,c.height=this.height*b,this}clone(){return new Oi$$module$libs$world_onscreen(this.x,this.y,this.width,this.height)}}
class q$$module$libs$world_onscreen extends Xe$$module$libs$world_onscreen{constructor(a,b,c,d=!0){super(a,c);this._position=p$$module$libs$world_onscreen.Zero();this._upVector=p$$module$libs$world_onscreen.Up();this._orthoTop=this._orthoBottom=this._orthoRight=this._orthoLeft=null;this.fov=.8;this.projectionPlaneTilt=0;this.minZ=1;this.maxZ=1E4;this.inertia=.9;this._mode=q$$module$libs$world_onscreen.PERSPECTIVE_CAMERA;this.isIntermediate=!1;this.viewport=new Oi$$module$libs$world_onscreen(0,0,1,
1);this.layerMask=268435455;this.fovMode=q$$module$libs$world_onscreen.FOVMODE_VERTICAL_FIXED;this.cameraRigMode=q$$module$libs$world_onscreen.RIG_MODE_NONE;this.customRenderTargets=[];this.outputRenderTarget=null;this.onViewMatrixChangedObservable=new w$$module$libs$world_onscreen;this.onProjectionMatrixChangedObservable=new w$$module$libs$world_onscreen;this.onAfterCheckInputsObservable=new w$$module$libs$world_onscreen;this.onRestoreStateObservable=new w$$module$libs$world_onscreen;this.isRigCamera=
!1;this._rigCameras=[];this._webvrViewMatrix=x$$module$libs$world_onscreen.Identity();this._skipRendering=!1;this._projectionMatrix=new x$$module$libs$world_onscreen;this._postProcesses=[];this._activeMeshes=new $e$$module$libs$world_onscreen(256);this._globalPosition=p$$module$libs$world_onscreen.Zero();this._computedViewMatrix=x$$module$libs$world_onscreen.Identity();this._doNotComputeProjectionMatrix=!1;this._transformMatrix=x$$module$libs$world_onscreen.Zero();this._refreshFrustumPlanes=!0;this._absoluteRotation=
Y$$module$libs$world_onscreen.Identity();this._isCamera=!0;this._isRightCamera=this._isLeftCamera=!1;this.getScene().addCamera(this);d&&!this.getScene().activeCamera&&(this.getScene().activeCamera=this);this.position=b;this.renderPassId=this.getScene().getEngine().createRenderPassId(`Camera ${a}`)}get position(){return this._position}set position(a){this._position=a}set upVector(a){this._upVector=a}get upVector(){return this._upVector}get screenArea(){var a,b,c,d;let e=0;var g=0;if(this.mode===q$$module$libs$world_onscreen.PERSPECTIVE_CAMERA)this.fovMode===
q$$module$libs$world_onscreen.FOVMODE_VERTICAL_FIXED?(g=2*this.minZ*Math.tan(this.fov/2),e=this.getEngine().getAspectRatio(this)*g):(e=2*this.minZ*Math.tan(this.fov/2),g=e/this.getEngine().getAspectRatio(this));else{g=this.getEngine().getRenderWidth()/2;const n=this.getEngine().getRenderHeight()/2;e=(null!==(a=this.orthoRight)&&void 0!==a?a:g)-(null!==(b=this.orthoLeft)&&void 0!==b?b:-g);g=(null!==(c=this.orthoTop)&&void 0!==c?c:n)-(null!==(d=this.orthoBottom)&&void 0!==d?d:-n)}return e*g}set orthoLeft(a){this._orthoLeft=
a;for(const b of this._rigCameras)b.orthoLeft=a}get orthoLeft(){return this._orthoLeft}set orthoRight(a){this._orthoRight=a;for(const b of this._rigCameras)b.orthoRight=a}get orthoRight(){return this._orthoRight}set orthoBottom(a){this._orthoBottom=a;for(const b of this._rigCameras)b.orthoBottom=a}get orthoBottom(){return this._orthoBottom}set orthoTop(a){this._orthoTop=a;for(const b of this._rigCameras)b.orthoTop=a}get orthoTop(){return this._orthoTop}set mode(a){this._mode=a;for(const b of this._rigCameras)b.mode=
a}get mode(){return this._mode}storeState(){return this._stateStored=!0,this._storedFov=this.fov,this}_restoreStateValues(){return this._stateStored?(this.fov=this._storedFov,!0):!1}restoreState(){return this._restoreStateValues()?(this.onRestoreStateObservable.notifyObservers(this),!0):!1}getClassName(){return"Camera"}toString(a){let b="Name: "+this.name;if(b+=", type: "+this.getClassName(),this.animations)for(let c=0;c<this.animations.length;c++)b+=", animation[0]: "+this.animations[c].toString(a);
return b}applyVerticalCorrection(){const a=this.absoluteRotation.toEulerAngles();this.projectionPlaneTilt=this._scene.useRightHandedSystem?-a.x:a.x}get globalPosition(){return this._globalPosition}getActiveMeshes(){return this._activeMeshes}isActiveMesh(a){return-1!==this._activeMeshes.indexOf(a)}isReady(a=!1){if(a)for(const b of this._postProcesses)if(b&&!b.isReady())return!1;return super.isReady(a)}_initCache(){super._initCache();this._cache.position=new p$$module$libs$world_onscreen(Number.MAX_VALUE,
Number.MAX_VALUE,Number.MAX_VALUE);this._cache.upVector=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.mode=void 0;this._cache.minZ=void 0;this._cache.maxZ=void 0;this._cache.fov=void 0;this._cache.fovMode=void 0;this._cache.aspectRatio=void 0;this._cache.orthoLeft=void 0;this._cache.orthoRight=void 0;this._cache.orthoBottom=void 0;this._cache.orthoTop=void 0;this._cache.renderWidth=void 0;this._cache.renderHeight=void 0}_updateCache(a){a||super._updateCache();
this._cache.position.copyFrom(this.position);this._cache.upVector.copyFrom(this.upVector)}_isSynchronized(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()}_isSynchronizedViewMatrix(){return super._isSynchronized()?this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent():!1}_isSynchronizedProjectionMatrix(){let a=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!a)return!1;
const b=this.getEngine();return this.mode===q$$module$libs$world_onscreen.PERSPECTIVE_CAMERA?a=this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===b.getAspectRatio(this)&&this._cache.projectionPlaneTilt===this.projectionPlaneTilt:a=this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===b.getRenderWidth()&&this._cache.renderHeight===
b.getRenderHeight(),a}attachControl(a,b){}detachControl(a){}update(){this._checkInputs();this.cameraRigMode!==q$$module$libs$world_onscreen.RIG_MODE_NONE&&this._updateRigCameras()}_checkInputs(){this.onAfterCheckInputsObservable.notifyObservers(this)}get rigCameras(){return this._rigCameras}get rigPostProcess(){return this._rigPostProcess}_getFirstPostProcess(){for(let a=0;a<this._postProcesses.length;a++)if(null!==this._postProcesses[a])return this._postProcesses[a];return null}_cascadePostProcessesToRigCams(){var a=
this._getFirstPostProcess();a&&a.markTextureDirty();for(let b=0,c=this._rigCameras.length;b<c;b++){a=this._rigCameras[b];const d=a._rigPostProcess;d?("pass"===d.getEffectName()&&(a.isIntermediate=0===this._postProcesses.length),a._postProcesses=this._postProcesses.slice(0).concat(d),d.markTextureDirty()):a._postProcesses=this._postProcesses.slice(0)}}attachPostProcess(a,b=null){return!a.isReusable()&&-1<this._postProcesses.indexOf(a)?(O$$module$libs$world_onscreen.Error("You're trying to reuse a post process not defined as reusable."),
0):(null==b||0>b?this._postProcesses.push(a):null===this._postProcesses[b]?this._postProcesses[b]=a:this._postProcesses.splice(b,0,a),this._cascadePostProcessesToRigCams(),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._postProcesses.indexOf(a))}detachPostProcess(a){a=this._postProcesses.indexOf(a);-1!==a&&(this._postProcesses[a]=null);this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty();this._cascadePostProcessesToRigCams()}getWorldMatrix(){return this._isSynchronizedViewMatrix()?
this._worldMatrix:(this.getViewMatrix(),this._worldMatrix)}_getViewMatrix(){return x$$module$libs$world_onscreen.Identity()}getViewMatrix(a){return!a&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,
this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix),this._computedViewMatrix)}freezeProjectionMatrix(a){this._doNotComputeProjectionMatrix=!0;void 0!==a&&(this._projectionMatrix=a)}unfreezeProjectionMatrix(){this._doNotComputeProjectionMatrix=!1}getProjectionMatrix(a){var b,c,d,e,g,n,t,
w;if(this._doNotComputeProjectionMatrix||!a&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode;this._cache.minZ=this.minZ;this._cache.maxZ=this.maxZ;this._refreshFrustumPlanes=!0;a=this.getEngine();const z=this.getScene(),C=a.useReverseDepthBuffer;if(this.mode===q$$module$libs$world_onscreen.PERSPECTIVE_CAMERA){this._cache.fov=this.fov;this._cache.fovMode=this.fovMode;this._cache.aspectRatio=a.getAspectRatio(this);this._cache.projectionPlaneTilt=this.projectionPlaneTilt;
0>=this.minZ&&(this.minZ=.1);var H;z.useRightHandedSystem?H=x$$module$libs$world_onscreen.PerspectiveFovRHToRef:H=x$$module$libs$world_onscreen.PerspectiveFovLHToRef;H(this.fov,a.getAspectRatio(this),C?this.maxZ:this.minZ,C?this.minZ:this.maxZ,this._projectionMatrix,this.fovMode===q$$module$libs$world_onscreen.FOVMODE_VERTICAL_FIXED,a.isNDCHalfZRange,this.projectionPlaneTilt,C)}else{H=a.getRenderWidth()/2;const M=a.getRenderHeight()/2;z.useRightHandedSystem?x$$module$libs$world_onscreen.OrthoOffCenterRHToRef(null!==
(b=this.orthoLeft)&&void 0!==b?b:-H,null!==(c=this.orthoRight)&&void 0!==c?c:H,null!==(d=this.orthoBottom)&&void 0!==d?d:-M,null!==(e=this.orthoTop)&&void 0!==e?e:M,C?this.maxZ:this.minZ,C?this.minZ:this.maxZ,this._projectionMatrix,a.isNDCHalfZRange):x$$module$libs$world_onscreen.OrthoOffCenterLHToRef(null!==(g=this.orthoLeft)&&void 0!==g?g:-H,null!==(n=this.orthoRight)&&void 0!==n?n:H,null!==(t=this.orthoBottom)&&void 0!==t?t:-M,null!==(w=this.orthoTop)&&void 0!==w?w:M,C?this.maxZ:this.minZ,C?this.minZ:
this.maxZ,this._projectionMatrix,a.isNDCHalfZRange);this._cache.orthoLeft=this.orthoLeft;this._cache.orthoRight=this.orthoRight;this._cache.orthoBottom=this.orthoBottom;this._cache.orthoTop=this.orthoTop;this._cache.renderWidth=a.getRenderWidth();this._cache.renderHeight=a.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix}getTransformationMatrix(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),
this._transformMatrix}_updateFrustumPlanes(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?mt$$module$libs$world_onscreen.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=mt$$module$libs$world_onscreen.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)}isInFrustum(a,b=!1){if(this._updateFrustumPlanes(),b&&0<this.rigCameras.length){let c=!1;return this.rigCameras.forEach(d=>{d._updateFrustumPlanes();c=c||a.isInFrustum(d._frustumPlanes)}),
c}return a.isInFrustum(this._frustumPlanes)}isCompletelyInFrustum(a){return this._updateFrustumPlanes(),a.isCompletelyInFrustum(this._frustumPlanes)}getForwardRay(a,b,c){throw $$$module$libs$world_onscreen("Ray");}getForwardRayToRef(a,b,c,d){throw $$$module$libs$world_onscreen("Ray");}dispose(a,b=!1){this.onViewMatrixChangedObservable.clear();this.onProjectionMatrixChangedObservable.clear();this.onAfterCheckInputsObservable.clear();this.onRestoreStateObservable.clear();this.inputs&&this.inputs.clear();
this.getScene().stopAnimation(this);for(this.getScene().removeCamera(this);0<this._rigCameras.length;){var c=this._rigCameras.pop();c&&c.dispose()}this._parentContainer&&(c=this._parentContainer.cameras.indexOf(this),-1<c&&this._parentContainer.cameras.splice(c,1),this._parentContainer=null);if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses.length=0;else if(this.cameraRigMode!==q$$module$libs$world_onscreen.RIG_MODE_NONE)this._rigPostProcess=
null,this._postProcesses.length=0;else for(c=this._postProcesses.length;0<=--c;){const d=this._postProcesses[c];d&&d.dispose(this)}for(c=this.customRenderTargets.length;0<=--c;)this.customRenderTargets[c].dispose();this.customRenderTargets.length=0;this._activeMeshes.dispose();this.getScene().getEngine().releaseRenderPassId(this.renderPassId);super.dispose(a,b)}get isLeftCamera(){return this._isLeftCamera}get isRightCamera(){return this._isRightCamera}get leftCamera(){return 1>this._rigCameras.length?
null:this._rigCameras[0]}get rightCamera(){return 2>this._rigCameras.length?null:this._rigCameras[1]}getLeftTarget(){return 1>this._rigCameras.length?null:this._rigCameras[0].getTarget()}getRightTarget(){return 2>this._rigCameras.length?null:this._rigCameras[1].getTarget()}setCameraRigMode(a,b){if(this.cameraRigMode!==a){for(;0<this._rigCameras.length;){var c=this._rigCameras.pop();c&&c.dispose()}if(this.cameraRigMode=a,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=b.interaxialDistance||
.0637,this._cameraRigParams.stereoHalfAngle=X$$module$libs$world_onscreen.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==q$$module$libs$world_onscreen.RIG_MODE_NONE)(a=this.createRigCamera(this.name+"_L",0))&&(a._isLeftCamera=!0),(c=this.createRigCamera(this.name+"_R",1))&&(c._isRightCamera=!0),a&&c&&(this._rigCameras.push(a),this._rigCameras.push(c));this._setRigMode(b);this._cascadePostProcessesToRigCams();this.update()}}_setRigMode(a){}_getVRProjectionMatrix(){return x$$module$libs$world_onscreen.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,
this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix,!0,this.getEngine().isNDCHalfZRange),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix}_updateCameraRotationMatrix(){}_updateWebVRCameraRotationMatrix(){}_getWebVRProjectionMatrix(){return x$$module$libs$world_onscreen.Identity()}_getWebVRViewMatrix(){return x$$module$libs$world_onscreen.Identity()}setCameraRigParameter(a,
b){this._cameraRigParams||(this._cameraRigParams={});this._cameraRigParams[a]=b;"interaxialDistance"===a&&(this._cameraRigParams.stereoHalfAngle=X$$module$libs$world_onscreen.ToRadians(b/.0637))}createRigCamera(a,b){return null}_updateRigCameras(){for(let a=0;a<this._rigCameras.length;a++)this._rigCameras[a].minZ=this.minZ,this._rigCameras[a].maxZ=this.maxZ,this._rigCameras[a].fov=this.fov,this._rigCameras[a].upVector.copyFrom(this.upVector);this.cameraRigMode===q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&
(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)}_setupInputs(){}serialize(){const a=ae$$module$libs$world_onscreen.Serialize(this);return a.uniqueId=this.uniqueId,a.type=this.getClassName(),this.parent&&this.parent._serializeAsParent(a),this.inputs&&this.inputs.serialize(a),ae$$module$libs$world_onscreen.AppendSerializedAnimations(this,a),a.ranges=this.serializeAnimationRanges(),a.isEnabled=this.isEnabled(),a}clone(a,b=null){const c=ae$$module$libs$world_onscreen.Clone(q$$module$libs$world_onscreen.GetConstructorFromName(this.getClassName(),
a,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this);return c.name=a,c.parent=b,this.onClonedObservable.notifyObservers(c),c}getDirection(a){const b=p$$module$libs$world_onscreen.Zero();return this.getDirectionToRef(a,b),b}get absoluteRotation(){return this.getWorldMatrix().decompose(void 0,this._absoluteRotation),this._absoluteRotation}getDirectionToRef(a,b){p$$module$libs$world_onscreen.TransformNormalToRef(a,this.getWorldMatrix(),b)}static GetConstructorFromName(a,b,c,
d=0,e=!0){return Xe$$module$libs$world_onscreen.Construct(a,b,c,{interaxial_distance:d,isStereoscopicSideBySide:e})||(()=>q$$module$libs$world_onscreen._CreateDefaultParsedCamera(b,c))}computeWorldMatrix(){return this.getWorldMatrix()}static Parse(a,b){var c=q$$module$libs$world_onscreen.GetConstructorFromName(a.type,a.name,b,a.interaxial_distance,a.isStereoscopicSideBySide);c=ae$$module$libs$world_onscreen.Parse(c,a,b);(void 0!==a.parentId&&(c._waitingParentId=a.parentId),void 0!==a.parentInstanceIndex&&
(c._waitingParentInstanceIndex=a.parentInstanceIndex),c.inputs&&(c.inputs.parse(a),c._setupInputs()),a.upVector&&(c.upVector=p$$module$libs$world_onscreen.FromArray(a.upVector)),c.setPosition&&(c.position.copyFromFloats(0,0,0),c.setPosition(p$$module$libs$world_onscreen.FromArray(a.position))),a.target&&c.setTarget&&c.setTarget(p$$module$libs$world_onscreen.FromArray(a.target)),a.cameraRigMode)&&c.setCameraRigMode(a.cameraRigMode,a.interaxial_distance?{interaxialDistance:a.interaxial_distance}:{});
if(a.animations){for(let d=0;d<a.animations.length;d++){const e=a.animations[d],g=ci$$module$libs$world_onscreen("BABYLON.Animation");g&&c.animations.push(g.Parse(e))}Xe$$module$libs$world_onscreen.ParseAnimationRanges(c,a,b)}return a.autoAnimate&&b.beginAnimation(c,a.autoAnimateFrom,a.autoAnimateTo,a.autoAnimateLoop,a.autoAnimateSpeed||1),void 0!==a.isEnabled&&c.setEnabled(a.isEnabled),c}}
q$$module$libs$world_onscreen._CreateDefaultParsedCamera=(a,b)=>{throw $$$module$libs$world_onscreen("UniversalCamera");};q$$module$libs$world_onscreen.PERSPECTIVE_CAMERA=0;q$$module$libs$world_onscreen.ORTHOGRAPHIC_CAMERA=1;q$$module$libs$world_onscreen.FOVMODE_VERTICAL_FIXED=0;q$$module$libs$world_onscreen.FOVMODE_HORIZONTAL_FIXED=1;q$$module$libs$world_onscreen.RIG_MODE_NONE=0;q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10;
q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11;q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12;q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_OVERUNDER=13;q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_INTERLACED=14;q$$module$libs$world_onscreen.RIG_MODE_VR=20;q$$module$libs$world_onscreen.RIG_MODE_WEBVR=21;q$$module$libs$world_onscreen.RIG_MODE_CUSTOM=22;q$$module$libs$world_onscreen.ForceAttachControlToAlwaysPreventDefault=!1;
T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen("position")],q$$module$libs$world_onscreen.prototype,"_position",void 0);T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen("upVector")],q$$module$libs$world_onscreen.prototype,"_upVector",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"orthoLeft",null);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"orthoRight",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"orthoBottom",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"orthoTop",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"fov",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"projectionPlaneTilt",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"minZ",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"maxZ",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"inertia",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"mode",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"layerMask",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"fovMode",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"cameraRigMode",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"interaxialDistance",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],q$$module$libs$world_onscreen.prototype,"isStereoscopicSideBySide",void 0);
class J$$module$libs$world_onscreen{constructor(){this._applyTo=Vn$$module$libs$world_onscreen(this._applyToCoroutine.bind(this))}set(a,b){switch(a.length||O$$module$libs$world_onscreen.Warn(`Setting vertex data kind '${b}' with an empty array`),b){case g$$module$libs$world_onscreen.PositionKind:this.positions=a;break;case g$$module$libs$world_onscreen.NormalKind:this.normals=a;break;case g$$module$libs$world_onscreen.TangentKind:this.tangents=a;break;case g$$module$libs$world_onscreen.UVKind:this.uvs=
a;break;case g$$module$libs$world_onscreen.UV2Kind:this.uvs2=a;break;case g$$module$libs$world_onscreen.UV3Kind:this.uvs3=a;break;case g$$module$libs$world_onscreen.UV4Kind:this.uvs4=a;break;case g$$module$libs$world_onscreen.UV5Kind:this.uvs5=a;break;case g$$module$libs$world_onscreen.UV6Kind:this.uvs6=a;break;case g$$module$libs$world_onscreen.ColorKind:this.colors=a;break;case g$$module$libs$world_onscreen.MatricesIndicesKind:this.matricesIndices=a;break;case g$$module$libs$world_onscreen.MatricesWeightsKind:this.matricesWeights=
a;break;case g$$module$libs$world_onscreen.MatricesIndicesExtraKind:this.matricesIndicesExtra=a;break;case g$$module$libs$world_onscreen.MatricesWeightsExtraKind:this.matricesWeightsExtra=a}}applyToMesh(a,b){return this._applyTo(a,b,!1),this}applyToGeometry(a,b){return this._applyTo(a,b,!1),this}updateMesh(a){return this._update(a),this}updateGeometry(a){return this._update(a),this}*_applyToCoroutine(a,b=!1,c){return this.positions&&(a.setVerticesData(g$$module$libs$world_onscreen.PositionKind,this.positions,
b),c&&(yield)),this.normals&&(a.setVerticesData(g$$module$libs$world_onscreen.NormalKind,this.normals,b),c&&(yield)),this.tangents&&(a.setVerticesData(g$$module$libs$world_onscreen.TangentKind,this.tangents,b),c&&(yield)),this.uvs&&(a.setVerticesData(g$$module$libs$world_onscreen.UVKind,this.uvs,b),c&&(yield)),this.uvs2&&(a.setVerticesData(g$$module$libs$world_onscreen.UV2Kind,this.uvs2,b),c&&(yield)),this.uvs3&&(a.setVerticesData(g$$module$libs$world_onscreen.UV3Kind,this.uvs3,b),c&&(yield)),this.uvs4&&
(a.setVerticesData(g$$module$libs$world_onscreen.UV4Kind,this.uvs4,b),c&&(yield)),this.uvs5&&(a.setVerticesData(g$$module$libs$world_onscreen.UV5Kind,this.uvs5,b),c&&(yield)),this.uvs6&&(a.setVerticesData(g$$module$libs$world_onscreen.UV6Kind,this.uvs6,b),c&&(yield)),this.colors&&(a.setVerticesData(g$$module$libs$world_onscreen.ColorKind,this.colors,b),c&&(yield)),this.matricesIndices&&(a.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,this.matricesIndices,b),c&&(yield)),this.matricesWeights&&
(a.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,this.matricesWeights,b),c&&(yield)),this.matricesIndicesExtra&&(a.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,this.matricesIndicesExtra,b),c&&(yield)),this.matricesWeightsExtra&&(a.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind,this.matricesWeightsExtra,b),c&&(yield)),this.indices?(a.setIndices(this.indices,null,b),c&&(yield)):a.setIndices([],null),this}_update(a,b,c){return this.positions&&
a.updateVerticesData(g$$module$libs$world_onscreen.PositionKind,this.positions,b,c),this.normals&&a.updateVerticesData(g$$module$libs$world_onscreen.NormalKind,this.normals,b,c),this.tangents&&a.updateVerticesData(g$$module$libs$world_onscreen.TangentKind,this.tangents,b,c),this.uvs&&a.updateVerticesData(g$$module$libs$world_onscreen.UVKind,this.uvs,b,c),this.uvs2&&a.updateVerticesData(g$$module$libs$world_onscreen.UV2Kind,this.uvs2,b,c),this.uvs3&&a.updateVerticesData(g$$module$libs$world_onscreen.UV3Kind,
this.uvs3,b,c),this.uvs4&&a.updateVerticesData(g$$module$libs$world_onscreen.UV4Kind,this.uvs4,b,c),this.uvs5&&a.updateVerticesData(g$$module$libs$world_onscreen.UV5Kind,this.uvs5,b,c),this.uvs6&&a.updateVerticesData(g$$module$libs$world_onscreen.UV6Kind,this.uvs6,b,c),this.colors&&a.updateVerticesData(g$$module$libs$world_onscreen.ColorKind,this.colors,b,c),this.matricesIndices&&a.updateVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,this.matricesIndices,b,c),this.matricesWeights&&
a.updateVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,this.matricesWeights,b,c),this.matricesIndicesExtra&&a.updateVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,this.matricesIndicesExtra,b,c),this.matricesWeightsExtra&&a.updateVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind,this.matricesWeightsExtra,b,c),this.indices&&a.setIndices(this.indices,null),this}static _TransformVector3Coordinates(a,b,c=0,d=a.length){const e=D$$module$libs$world_onscreen.Vector3[0],
g=D$$module$libs$world_onscreen.Vector3[1];for(let n=c;n<c+d;n+=3)p$$module$libs$world_onscreen.FromArrayToRef(a,n,e),p$$module$libs$world_onscreen.TransformCoordinatesToRef(e,b,g),a[n]=g.x,a[n+1]=g.y,a[n+2]=g.z}static _TransformVector3Normals(a,b,c=0,d=a.length){const e=D$$module$libs$world_onscreen.Vector3[0],g=D$$module$libs$world_onscreen.Vector3[1];for(let n=c;n<c+d;n+=3)p$$module$libs$world_onscreen.FromArrayToRef(a,n,e),p$$module$libs$world_onscreen.TransformNormalToRef(e,b,g),a[n]=g.x,a[n+
1]=g.y,a[n+2]=g.z}static _TransformVector4Normals(a,b,c=0,d=a.length){const e=D$$module$libs$world_onscreen.Vector4[0],g=D$$module$libs$world_onscreen.Vector4[1];for(let n=c;n<c+d;n+=4)Ae$$module$libs$world_onscreen.FromArrayToRef(a,n,e),Ae$$module$libs$world_onscreen.TransformNormalToRef(e,b,g),a[n]=g.x,a[n+1]=g.y,a[n+2]=g.z,a[n+3]=g.w}static _FlipFaces(a,b=0,c=a.length){for(let d=b;d<b+c;d+=3){const e=a[d+1];a[d+1]=a[d+2];a[d+2]=e}}transform(a){const b=0>a.determinant();return this.positions&&J$$module$libs$world_onscreen._TransformVector3Coordinates(this.positions,
a),this.normals&&J$$module$libs$world_onscreen._TransformVector3Normals(this.normals,a),this.tangents&&J$$module$libs$world_onscreen._TransformVector4Normals(this.tangents,a),b&&this.indices&&J$$module$libs$world_onscreen._FlipFaces(this.indices),this}merge(a,b=!1,c=!1){a=Array.isArray(a)?a.map(d=>[d,void 0]):[[a,void 0]];return Ks$$module$libs$world_onscreen(this._mergeCoroutine(void 0,a,b,!1,c))}*_mergeCoroutine(a,b,c=!1,d,e){var g,n,t,w;this._validate();const z=b.map(H=>H[0]);for(var C of z)if(C._validate(),
!this.normals!=!C.normals||!this.tangents!=!C.tangents||!this.uvs!=!C.uvs||!this.uvs2!=!C.uvs2||!this.uvs3!=!C.uvs3||!this.uvs4!=!C.uvs4||!this.uvs5!=!C.uvs5||!this.uvs6!=!C.uvs6||!this.colors!=!C.colors||!this.matricesIndices!=!C.matricesIndices||!this.matricesWeights!=!C.matricesWeights||!this.matricesIndicesExtra!=!C.matricesIndicesExtra||!this.matricesWeightsExtra!=!C.matricesWeightsExtra)throw Error("Cannot merge vertex data that do not have the same set of attributes");C=z.reduce((H,M)=>{var L,
O;return H+(null!==(O=null===(L=M.indices)||void 0===L?void 0:L.length)&&void 0!==O?O:0)},null!==(n=null===(g=this.indices)||void 0===g?void 0:g.length)&&void 0!==n?n:0);e=e||z.some(H=>H.indices===this.indices)?null===(t=this.indices)||void 0===t?void 0:t.slice():this.indices;if(0<C){t=null!==(w=null==e?void 0:e.length)&&void 0!==w?w:0;if(e||=Array(C),e.length!==C)Array.isArray(e)?e.length=C:(c=c||e instanceof Uint32Array?new Uint32Array(C):new Uint16Array(C),c.set(e),e=c),a&&0>a.determinant()&&J$$module$libs$world_onscreen._FlipFaces(e,
0,t);c=this.positions?this.positions.length/3:0;for(const [H,M]of b)if(H.indices){for(w=0;w<H.indices.length;w++)e[t+w]=H.indices[w]+c;M&&0>M.determinant()&&J$$module$libs$world_onscreen._FlipFaces(e,t,H.indices.length);c+=H.positions.length/3;t+=H.indices.length;d&&(yield)}}return this.indices=e,this.positions=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.PositionKind,this.positions,a,b.map(H=>[H[0].positions,H[1]])),d&&(yield),this.normals=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.NormalKind,
this.normals,a,b.map(H=>[H[0].normals,H[1]])),d&&(yield),this.tangents=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.TangentKind,this.tangents,a,b.map(H=>[H[0].tangents,H[1]])),d&&(yield),this.uvs=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.UVKind,this.uvs,a,b.map(H=>[H[0].uvs,H[1]])),d&&(yield),this.uvs2=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.UV2Kind,this.uvs2,a,b.map(H=>[H[0].uvs2,H[1]])),d&&(yield),this.uvs3=
J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.UV3Kind,this.uvs3,a,b.map(H=>[H[0].uvs3,H[1]])),d&&(yield),this.uvs4=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.UV4Kind,this.uvs4,a,b.map(H=>[H[0].uvs4,H[1]])),d&&(yield),this.uvs5=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.UV5Kind,this.uvs5,a,b.map(H=>[H[0].uvs5,H[1]])),d&&(yield),this.uvs6=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.UV6Kind,
this.uvs6,a,b.map(H=>[H[0].uvs6,H[1]])),d&&(yield),this.colors=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.ColorKind,this.colors,a,b.map(H=>[H[0].colors,H[1]])),d&&(yield),this.matricesIndices=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.MatricesIndicesKind,this.matricesIndices,a,b.map(H=>[H[0].matricesIndices,H[1]])),d&&(yield),this.matricesWeights=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.MatricesWeightsKind,
this.matricesWeights,a,b.map(H=>[H[0].matricesWeights,H[1]])),d&&(yield),this.matricesIndicesExtra=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,this.matricesIndicesExtra,a,b.map(H=>[H[0].matricesIndicesExtra,H[1]])),d&&(yield),this.matricesWeightsExtra=J$$module$libs$world_onscreen._MergeElement(g$$module$libs$world_onscreen.MatricesWeightsExtraKind,this.matricesWeightsExtra,a,b.map(H=>[H[0].matricesWeightsExtra,H[1]])),this}static _MergeElement(a,
b,c,d){d=d.filter(g=>null!==g[0]&&void 0!==g[0]);if(!b&&0==d.length)return b;if(!b)return this._MergeElement(a,d[0][0],d[0][1],d.slice(1));var e=d.reduce((g,n)=>g+n[0].length,b.length);a=a===g$$module$libs$world_onscreen.PositionKind?J$$module$libs$world_onscreen._TransformVector3Coordinates:a===g$$module$libs$world_onscreen.NormalKind?J$$module$libs$world_onscreen._TransformVector3Normals:a===g$$module$libs$world_onscreen.TangentKind?J$$module$libs$world_onscreen._TransformVector4Normals:()=>{};
if(b instanceof Float32Array){e=new Float32Array(e);e.set(b);c&&a(e,c,0,b.length);b=b.length;for(const [g,n]of d)e.set(g,b),n&&a(e,n,b,g.length),b+=g.length;return e}e=Array(e);for(let g=0;g<b.length;g++)e[g]=b[g];c&&a(e,c,0,b.length);b=b.length;for(const [g,n]of d){for(d=0;d<g.length;d++)e[b+d]=g[d];n&&a(e,n,b,g.length);b+=g.length}return e}_validate(){if(!this.positions)throw new Wt$$module$libs$world_onscreen("Positions are required",oi$$module$libs$world_onscreen.MeshInvalidPositionsError);const a=
(d,e)=>{const g=g$$module$libs$world_onscreen.DeduceStride(d);if(0!==e.length%g)throw Error("The "+d+"s array count must be a multiple of "+g);return e.length/g},b=a(g$$module$libs$world_onscreen.PositionKind,this.positions),c=(d,e)=>{e=a(d,e);if(e!==b)throw Error("The "+d+"s element count ("+e+") does not match the positions count ("+b+")");};this.normals&&c(g$$module$libs$world_onscreen.NormalKind,this.normals);this.tangents&&c(g$$module$libs$world_onscreen.TangentKind,this.tangents);this.uvs&&
c(g$$module$libs$world_onscreen.UVKind,this.uvs);this.uvs2&&c(g$$module$libs$world_onscreen.UV2Kind,this.uvs2);this.uvs3&&c(g$$module$libs$world_onscreen.UV3Kind,this.uvs3);this.uvs4&&c(g$$module$libs$world_onscreen.UV4Kind,this.uvs4);this.uvs5&&c(g$$module$libs$world_onscreen.UV5Kind,this.uvs5);this.uvs6&&c(g$$module$libs$world_onscreen.UV6Kind,this.uvs6);this.colors&&c(g$$module$libs$world_onscreen.ColorKind,this.colors);this.matricesIndices&&c(g$$module$libs$world_onscreen.MatricesIndicesKind,
this.matricesIndices);this.matricesWeights&&c(g$$module$libs$world_onscreen.MatricesWeightsKind,this.matricesWeights);this.matricesIndicesExtra&&c(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,this.matricesIndicesExtra);this.matricesWeightsExtra&&c(g$$module$libs$world_onscreen.MatricesWeightsExtraKind,this.matricesWeightsExtra)}serialize(){const a={};return this.positions&&(a.positions=this.positions),this.normals&&(a.normals=this.normals),this.tangents&&(a.tangents=this.tangents),this.uvs&&
(a.uvs=this.uvs),this.uvs2&&(a.uvs2=this.uvs2),this.uvs3&&(a.uvs3=this.uvs3),this.uvs4&&(a.uvs4=this.uvs4),this.uvs5&&(a.uvs5=this.uvs5),this.uvs6&&(a.uvs6=this.uvs6),this.colors&&(a.colors=this.colors),this.matricesIndices&&(a.matricesIndices=this.matricesIndices,a.matricesIndices._isExpanded=!0),this.matricesWeights&&(a.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(a.matricesIndicesExtra=this.matricesIndicesExtra,a.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&
(a.matricesWeightsExtra=this.matricesWeightsExtra),a.indices=this.indices,a}static ExtractFromMesh(a,b,c){return J$$module$libs$world_onscreen._ExtractFrom(a,b,c)}static ExtractFromGeometry(a,b,c){return J$$module$libs$world_onscreen._ExtractFrom(a,b,c)}static _ExtractFrom(a,b,c){const d=new J$$module$libs$world_onscreen;return a.isVerticesDataPresent(g$$module$libs$world_onscreen.PositionKind)&&(d.positions=a.getVerticesData(g$$module$libs$world_onscreen.PositionKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)&&
(d.normals=a.getVerticesData(g$$module$libs$world_onscreen.NormalKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.TangentKind)&&(d.tangents=a.getVerticesData(g$$module$libs$world_onscreen.TangentKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind)&&(d.uvs=a.getVerticesData(g$$module$libs$world_onscreen.UVKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.UV2Kind)&&(d.uvs2=a.getVerticesData(g$$module$libs$world_onscreen.UV2Kind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.UV3Kind)&&
(d.uvs3=a.getVerticesData(g$$module$libs$world_onscreen.UV3Kind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.UV4Kind)&&(d.uvs4=a.getVerticesData(g$$module$libs$world_onscreen.UV4Kind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.UV5Kind)&&(d.uvs5=a.getVerticesData(g$$module$libs$world_onscreen.UV5Kind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.UV6Kind)&&(d.uvs6=a.getVerticesData(g$$module$libs$world_onscreen.UV6Kind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.ColorKind)&&
(d.colors=a.getVerticesData(g$$module$libs$world_onscreen.ColorKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesIndicesKind)&&(d.matricesIndices=a.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsKind)&&(d.matricesWeights=a.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesIndicesExtraKind)&&(d.matricesIndicesExtra=
a.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,b,c)),a.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsExtraKind)&&(d.matricesWeightsExtra=a.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind,b,c)),d.indices=a.getIndices(b,c),d}static CreateRibbon(a){throw $$$module$libs$world_onscreen("ribbonBuilder");}static CreateBox(a){throw $$$module$libs$world_onscreen("boxBuilder");}static CreateTiledBox(a){throw $$$module$libs$world_onscreen("tiledBoxBuilder");
}static CreateTiledPlane(a){throw $$$module$libs$world_onscreen("tiledPlaneBuilder");}static CreateSphere(a){throw $$$module$libs$world_onscreen("sphereBuilder");}static CreateCylinder(a){throw $$$module$libs$world_onscreen("cylinderBuilder");}static CreateTorus(a){throw $$$module$libs$world_onscreen("torusBuilder");}static CreateLineSystem(a){throw $$$module$libs$world_onscreen("linesBuilder");}static CreateDashedLines(a){throw $$$module$libs$world_onscreen("linesBuilder");}static CreateGround(a){throw $$$module$libs$world_onscreen("groundBuilder");
}static CreateTiledGround(a){throw $$$module$libs$world_onscreen("groundBuilder");}static CreateGroundFromHeightMap(a){throw $$$module$libs$world_onscreen("groundBuilder");}static CreatePlane(a){throw $$$module$libs$world_onscreen("planeBuilder");}static CreateDisc(a){throw $$$module$libs$world_onscreen("discBuilder");}static CreatePolygon(a,b,c,d,e,g,n){throw $$$module$libs$world_onscreen("polygonBuilder");}static CreateIcoSphere(a){throw $$$module$libs$world_onscreen("icoSphereBuilder");}static CreatePolyhedron(a){throw $$$module$libs$world_onscreen("polyhedronBuilder");
}static CreateCapsule(a={orientation:p$$module$libs$world_onscreen.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){throw $$$module$libs$world_onscreen("capsuleBuilder");}static CreateTorusKnot(a){throw $$$module$libs$world_onscreen("torusKnotBuilder");}static ComputeNormals(a,b,c,d){let e,g=0,n=0,t=0,w=0,z=0,C=0,H=0,M=0,L=0,O=0,S=0,T=0,P=0,W=0,Z=0,ca=0,ba=0,la=0,ea=0,oa=!1,sa=!1,xa=!1,ya=!1,Ya=1,Ja=0,ac=null;d&&(oa=!!d.facetNormals,sa=!!d.facetPositions,xa=!!d.facetPartitioning,
Ya=!0===d.useRightHandedSystem?-1:1,Ja=d.ratio||0,ya=!!d.depthSort,ac=d.distanceTo,ya&&void 0===ac&&(ac=p$$module$libs$world_onscreen.Zero()));let Ia=0,Ma=0,Nb=0,Qb=0;xa&&d&&d.bbSize&&(Ia=d.subDiv.X*Ja/d.bbSize.x,Ma=d.subDiv.Y*Ja/d.bbSize.y,Nb=d.subDiv.Z*Ja/d.bbSize.z,Qb=d.subDiv.max*d.subDiv.max,d.facetPartitioning.length=0);for(e=0;e<a.length;e++)c[e]=0;const dd=b.length/3|0;for(e=0;e<dd;e++){if(S=3*b[3*e],T=S+1,P=S+2,W=3*b[3*e+1],Z=W+1,ca=W+2,ba=3*b[3*e+2],la=ba+1,ea=ba+2,g=a[S]-a[W],n=a[T]-a[Z],
t=a[P]-a[ca],w=a[ba]-a[W],z=a[la]-a[Z],C=a[ea]-a[ca],H=Ya*(n*C-t*z),M=Ya*(t*w-g*C),L=Ya*(g*z-n*w),O=Math.sqrt(H*H+M*M+L*L),O=0===O?1:O,H/=O,M/=O,L/=O,oa&&d&&(d.facetNormals[e].x=H,d.facetNormals[e].y=M,d.facetNormals[e].z=L),sa&&d&&(d.facetPositions[e].x=(a[S]+a[W]+a[ba])/3,d.facetPositions[e].y=(a[T]+a[Z]+a[la])/3,d.facetPositions[e].z=(a[P]+a[ca]+a[ea])/3),xa&&d){var eb=Math.floor((a[S]-d.bInfo.minimum.x*Ja)*Ia)+d.subDiv.max*Math.floor((a[T]-d.bInfo.minimum.y*Ja)*Ma)+Qb*Math.floor((a[P]-d.bInfo.minimum.z*
Ja)*Nb);const Vc=Math.floor((a[W]-d.bInfo.minimum.x*Ja)*Ia)+d.subDiv.max*Math.floor((a[Z]-d.bInfo.minimum.y*Ja)*Ma)+Qb*Math.floor((a[ca]-d.bInfo.minimum.z*Ja)*Nb),Q=Math.floor((a[ba]-d.bInfo.minimum.x*Ja)*Ia)+d.subDiv.max*Math.floor((a[la]-d.bInfo.minimum.y*Ja)*Ma)+Qb*Math.floor((a[ea]-d.bInfo.minimum.z*Ja)*Nb),R=Math.floor((d.facetPositions[e].x-d.bInfo.minimum.x*Ja)*Ia)+d.subDiv.max*Math.floor((d.facetPositions[e].y-d.bInfo.minimum.y*Ja)*Ma)+Qb*Math.floor((d.facetPositions[e].z-d.bInfo.minimum.z*
Ja)*Nb);d.facetPartitioning[R]=d.facetPartitioning[R]?d.facetPartitioning[R]:[];d.facetPartitioning[eb]=d.facetPartitioning[eb]?d.facetPartitioning[eb]:[];d.facetPartitioning[Vc]=d.facetPartitioning[Vc]?d.facetPartitioning[Vc]:[];d.facetPartitioning[Q]=d.facetPartitioning[Q]?d.facetPartitioning[Q]:[];d.facetPartitioning[eb].push(e);Vc!=eb&&d.facetPartitioning[Vc].push(e);Q==Vc||Q==eb||d.facetPartitioning[Q].push(e);R==eb||R==Vc||R==Q||d.facetPartitioning[R].push(e)}ya&&d&&d.facetPositions&&(eb=d.depthSortedFacets[e],
eb.ind=3*e,eb.sqDistance=p$$module$libs$world_onscreen.DistanceSquared(d.facetPositions[e],ac));c[S]+=H;c[T]+=M;c[P]+=L;c[W]+=H;c[Z]+=M;c[ca]+=L;c[ba]+=H;c[la]+=M;c[ea]+=L}for(e=0;e<c.length/3;e++)H=c[3*e],M=c[3*e+1],L=c[3*e+2],O=Math.sqrt(H*H+M*M+L*L),O=0===O?1:O,H/=O,M/=O,L/=O,c[3*e]=H,c[3*e+1]=M,c[3*e+2]=L}static _ComputeSides(a,b,c,d,e,g,n){const t=c.length;var w=d.length;switch(a=a||J$$module$libs$world_onscreen.DEFAULTSIDE,a){case J$$module$libs$world_onscreen.BACKSIDE:for(b=0;b<t;b+=3)e=c[b],
c[b]=c[b+2],c[b+2]=e;for(c=0;c<w;c++)d[c]=-d[c];break;case J$$module$libs$world_onscreen.DOUBLESIDE:const z=b.length;a=z/3;for(let C=0;C<z;C++)b[z+C]=b[C];for(b=0;b<t;b+=3)c[b+t]=c[b+2]+a,c[b+1+t]=c[b+1]+a,c[b+2+t]=c[b]+a;for(c=0;c<w;c++)d[w+c]=-d[c];d=e.length;for(w=0;w<d;w++)e[w+d]=e[w];g=g||new Ae$$module$libs$world_onscreen(0,0,1,1);n=n||new Ae$$module$libs$world_onscreen(0,0,1,1);for(b=w=0;b<d/2;b++)e[w]=g.x+(g.z-g.x)*e[w],e[w+1]=g.y+(g.w-g.y)*e[w+1],e[w+d]=n.x+(n.z-n.x)*e[w+d],e[w+d+1]=n.y+
(n.w-n.y)*e[w+d+1],w+=2}}static ImportVertexData(a,b){const c=new J$$module$libs$world_onscreen;var d=a.positions;d&&c.set(d,g$$module$libs$world_onscreen.PositionKind);var e=a.normals;e&&c.set(e,g$$module$libs$world_onscreen.NormalKind);(e=a.tangents)&&c.set(e,g$$module$libs$world_onscreen.TangentKind);(e=a.uvs)&&c.set(e,g$$module$libs$world_onscreen.UVKind);(e=a.uv2s)&&c.set(e,g$$module$libs$world_onscreen.UV2Kind);(e=a.uv3s)&&c.set(e,g$$module$libs$world_onscreen.UV3Kind);(e=a.uv4s)&&c.set(e,g$$module$libs$world_onscreen.UV4Kind);
(e=a.uv5s)&&c.set(e,g$$module$libs$world_onscreen.UV5Kind);(e=a.uv6s)&&c.set(e,g$$module$libs$world_onscreen.UV6Kind);(e=a.colors)&&c.set(me$$module$libs$world_onscreen.CheckColors4(e,d.length/3),g$$module$libs$world_onscreen.ColorKind);(d=a.matricesIndices)&&c.set(d,g$$module$libs$world_onscreen.MatricesIndicesKind);(d=a.matricesWeights)&&c.set(d,g$$module$libs$world_onscreen.MatricesWeightsKind);(d=a.indices)&&(c.indices=d);b.setAllVerticesData(c,a.updatable)}}
J$$module$libs$world_onscreen.FRONTSIDE=0;J$$module$libs$world_onscreen.BACKSIDE=1;J$$module$libs$world_onscreen.DOUBLESIDE=2;J$$module$libs$world_onscreen.DEFAULTSIDE=0;T$$module$libs$world_onscreen([Qt$$module$libs$world_onscreen.filter((...[a])=>!Array.isArray(a))],J$$module$libs$world_onscreen,"_TransformVector3Coordinates",null);T$$module$libs$world_onscreen([Qt$$module$libs$world_onscreen.filter((...[a])=>!Array.isArray(a))],J$$module$libs$world_onscreen,"_TransformVector3Normals",null);
T$$module$libs$world_onscreen([Qt$$module$libs$world_onscreen.filter((...[a])=>!Array.isArray(a))],J$$module$libs$world_onscreen,"_TransformVector4Normals",null);T$$module$libs$world_onscreen([Qt$$module$libs$world_onscreen.filter((...[a])=>!Array.isArray(a))],J$$module$libs$world_onscreen,"_FlipFaces",null);class Ns$$module$libs$world_onscreen{constructor(a,b,c){this.bu=a;this.bv=b;this.distance=c;this.subMeshId=this.faceId=0}}
class Ut$$module$libs$world_onscreen{constructor(a,b,c){this.vectors=Ye$$module$libs$world_onscreen.BuildArray(8,p$$module$libs$world_onscreen.Zero);this.center=p$$module$libs$world_onscreen.Zero();this.centerWorld=p$$module$libs$world_onscreen.Zero();this.extendSize=p$$module$libs$world_onscreen.Zero();this.extendSizeWorld=p$$module$libs$world_onscreen.Zero();this.directions=Ye$$module$libs$world_onscreen.BuildArray(3,p$$module$libs$world_onscreen.Zero);this.vectorsWorld=Ye$$module$libs$world_onscreen.BuildArray(8,
p$$module$libs$world_onscreen.Zero);this.minimumWorld=p$$module$libs$world_onscreen.Zero();this.maximumWorld=p$$module$libs$world_onscreen.Zero();this.minimum=p$$module$libs$world_onscreen.Zero();this.maximum=p$$module$libs$world_onscreen.Zero();this._drawWrapperBack=this._drawWrapperFront=null;this.reConstruct(a,b,c)}reConstruct(a,b,c){const d=a.x,e=a.y,g=a.z,n=b.x,t=b.y,w=b.z,z=this.vectors;this.minimum.copyFromFloats(d,e,g);this.maximum.copyFromFloats(n,t,w);z[0].copyFromFloats(d,e,g);z[1].copyFromFloats(n,
t,w);z[2].copyFromFloats(n,e,g);z[3].copyFromFloats(d,t,g);z[4].copyFromFloats(d,e,w);z[5].copyFromFloats(n,t,g);z[6].copyFromFloats(d,t,w);z[7].copyFromFloats(n,e,w);b.addToRef(a,this.center).scaleInPlace(.5);b.subtractToRef(a,this.extendSize).scaleInPlace(.5);this._worldMatrix=c||x$$module$libs$world_onscreen.IdentityReadOnly;this._update(this._worldMatrix)}scale(a){var b=Ut$$module$libs$world_onscreen._TmpVector3,c=this.maximum.subtractToRef(this.minimum,b[0]);const d=c.length();c.normalizeFromLength(d);
c=c.scaleInPlace(d*a*.5);a=this.center.subtractToRef(c,b[1]);b=this.center.addToRef(c,b[2]);return this.reConstruct(a,b,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(a){var b=this.minimumWorld;const c=this.maximumWorld,d=this.directions,e=this.vectorsWorld,g=this.vectors;if(a.isIdentity()){b.copyFrom(this.minimum);c.copyFrom(this.maximum);for(b=0;8>b;++b)e[b].copyFrom(g[b]);this.extendSizeWorld.copyFrom(this.extendSize);this.centerWorld.copyFrom(this.center)}else{b.setAll(Number.MAX_VALUE);
c.setAll(-Number.MAX_VALUE);for(let n=0;8>n;++n){const t=e[n];p$$module$libs$world_onscreen.TransformCoordinatesToRef(g[n],a,t);b.minimizeInPlace(t);c.maximizeInPlace(t)}c.subtractToRef(b,this.extendSizeWorld).scaleInPlace(.5);c.addToRef(b,this.centerWorld).scaleInPlace(.5)}p$$module$libs$world_onscreen.FromArrayToRef(a.m,0,d[0]);p$$module$libs$world_onscreen.FromArrayToRef(a.m,4,d[1]);p$$module$libs$world_onscreen.FromArrayToRef(a.m,8,d[2]);this._worldMatrix=a}isInFrustum(a){return Ut$$module$libs$world_onscreen.IsInFrustum(this.vectorsWorld,
a)}isCompletelyInFrustum(a){return Ut$$module$libs$world_onscreen.IsCompletelyInFrustum(this.vectorsWorld,a)}intersectsPoint(a){var b=this.minimumWorld;const c=this.maximumWorld,d=b.x,e=b.y;b=b.z;const g=c.y,n=c.z,t=a.x,w=a.y;a=a.z;const z=-Re$$module$libs$world_onscreen;return!(c.x-t<z||z>t-d||g-w<z||z>w-e||n-a<z||z>a-b)}intersectsSphere(a){return Ut$$module$libs$world_onscreen.IntersectsSphere(this.minimumWorld,this.maximumWorld,a.centerWorld,a.radiusWorld)}intersectsMinMax(a,b){var c=this.minimumWorld;
const d=this.maximumWorld,e=c.x,g=c.y;c=c.z;const n=d.y,t=d.z,w=a.y,z=a.z,C=b.x,H=b.y;b=b.z;return!(d.x<a.x||e>C||n<w||g>H||t<z||c>b)}dispose(){var a,b;null===(a=this._drawWrapperFront)||void 0===a||a.dispose();null===(b=this._drawWrapperBack)||void 0===b||b.dispose()}static Intersects(a,b){return a.intersectsMinMax(b.minimumWorld,b.maximumWorld)}static IntersectsSphere(a,b,c,d){const e=Ut$$module$libs$world_onscreen._TmpVector3[0];return p$$module$libs$world_onscreen.ClampToRef(c,a,b,e),p$$module$libs$world_onscreen.DistanceSquared(c,
e)<=d*d}static IsCompletelyInFrustum(a,b){for(let c=0;6>c;++c){const d=b[c];for(let e=0;8>e;++e)if(0>d.dotCoordinate(a[e]))return!1}return!0}static IsInFrustum(a,b){for(let c=0;6>c;++c){let d=!0;const e=b[c];for(let g=0;8>g;++g)if(0<=e.dotCoordinate(a[g])){d=!1;break}if(d)return!1}return!0}}Ut$$module$libs$world_onscreen._TmpVector3=Ye$$module$libs$world_onscreen.BuildArray(3,p$$module$libs$world_onscreen.Zero);
class hi$$module$libs$world_onscreen{constructor(a,b,c){this.center=p$$module$libs$world_onscreen.Zero();this.centerWorld=p$$module$libs$world_onscreen.Zero();this.minimum=p$$module$libs$world_onscreen.Zero();this.maximum=p$$module$libs$world_onscreen.Zero();this.reConstruct(a,b,c)}reConstruct(a,b,c){this.minimum.copyFrom(a);this.maximum.copyFrom(b);const d=p$$module$libs$world_onscreen.Distance(a,b);b.addToRef(a,this.center).scaleInPlace(.5);this.radius=.5*d;this._update(c||x$$module$libs$world_onscreen.IdentityReadOnly)}scale(a){var b=
hi$$module$libs$world_onscreen._TmpVector3;const c=b[0].setAll(this.radius*a);a=this.center.subtractToRef(c,b[1]);b=this.center.addToRef(c,b[2]);return this.reConstruct(a,b,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(a){if(a.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{p$$module$libs$world_onscreen.TransformCoordinatesToRef(this.center,a,this.centerWorld);const b=hi$$module$libs$world_onscreen._TmpVector3[0];p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(1,
1,1,a,b);this.radiusWorld=Math.max(Math.abs(b.x),Math.abs(b.y),Math.abs(b.z))*this.radius}}isInFrustum(a){const b=this.centerWorld,c=this.radiusWorld;for(let d=0;6>d;d++)if(a[d].dotCoordinate(b)<=-c)return!1;return!0}isCenterInFrustum(a){const b=this.centerWorld;for(let c=0;6>c;c++)if(0>a[c].dotCoordinate(b))return!1;return!0}intersectsPoint(a){a=p$$module$libs$world_onscreen.DistanceSquared(this.centerWorld,a);return!(this.radiusWorld*this.radiusWorld<a)}static Intersects(a,b){const c=p$$module$libs$world_onscreen.DistanceSquared(a.centerWorld,
b.centerWorld);a=a.radiusWorld+b.radiusWorld;return!(a*a<c)}static CreateFromCenterAndRadius(a,b,c){this._TmpVector3[0].copyFrom(a);this._TmpVector3[1].copyFromFloats(0,0,b);this._TmpVector3[2].copyFrom(a);this._TmpVector3[0].addInPlace(this._TmpVector3[1]);this._TmpVector3[2].subtractInPlace(this._TmpVector3[1]);a=new hi$$module$libs$world_onscreen(this._TmpVector3[0],this._TmpVector3[2]);return c?a._worldMatrix=c:a._worldMatrix=x$$module$libs$world_onscreen.Identity(),a}}
hi$$module$libs$world_onscreen._TmpVector3=Ye$$module$libs$world_onscreen.BuildArray(3,p$$module$libs$world_onscreen.Zero);
const xs$$module$libs$world_onscreen={min:0,max:0},Ms$$module$libs$world_onscreen={min:0,max:0},ur$$module$libs$world_onscreen=(a,b,c)=>{const d=p$$module$libs$world_onscreen.Dot(b.centerWorld,a);var e=Math.abs(p$$module$libs$world_onscreen.Dot(b.directions[0],a))*b.extendSize.x;const g=Math.abs(p$$module$libs$world_onscreen.Dot(b.directions[1],a))*b.extendSize.y;a=Math.abs(p$$module$libs$world_onscreen.Dot(b.directions[2],a))*b.extendSize.z;e=e+g+a;c.min=d-e;c.max=d+e},tt$$module$libs$world_onscreen=
(a,b,c)=>(ur$$module$libs$world_onscreen(a,b,xs$$module$libs$world_onscreen),ur$$module$libs$world_onscreen(a,c,Ms$$module$libs$world_onscreen),!(xs$$module$libs$world_onscreen.min>Ms$$module$libs$world_onscreen.max||Ms$$module$libs$world_onscreen.min>xs$$module$libs$world_onscreen.max));
class ft$$module$libs$world_onscreen{constructor(a,b,c){this._isLocked=!1;this.boundingBox=new Ut$$module$libs$world_onscreen(a,b,c);this.boundingSphere=new hi$$module$libs$world_onscreen(a,b,c)}reConstruct(a,b,c){this.boundingBox.reConstruct(a,b,c);this.boundingSphere.reConstruct(a,b,c)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(a){this._isLocked=a}update(a){this._isLocked||(this.boundingBox._update(a),
this.boundingSphere._update(a))}centerOn(a,b){const c=ft$$module$libs$world_onscreen._TmpVector3[0].copyFrom(a).subtractInPlace(b);a=ft$$module$libs$world_onscreen._TmpVector3[1].copyFrom(a).addInPlace(b);return this.boundingBox.reConstruct(c,a,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(c,a,this.boundingBox.getWorldMatrix()),this}encapsulate(a){const b=p$$module$libs$world_onscreen.Minimize(this.minimum,a);a=p$$module$libs$world_onscreen.Maximize(this.maximum,a);return this.reConstruct(b,
a,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(a){return this.encapsulate(a.boundingBox.centerWorld.subtract(a.boundingBox.extendSizeWorld)),this.encapsulate(a.boundingBox.centerWorld.add(a.boundingBox.extendSizeWorld)),this}scale(a){return this.boundingBox.scale(a),this.boundingSphere.scale(a),this}isInFrustum(a,b=0){return 2!==b&&3!==b||!this.boundingSphere.isCenterInFrustum(a)?this.boundingSphere.isInFrustum(a)?1===b||3===b?!0:this.boundingBox.isInFrustum(a):!1:!0}get diagonalLength(){const a=
this.boundingBox;return a.maximumWorld.subtractToRef(a.minimumWorld,ft$$module$libs$world_onscreen._TmpVector3[0]).length()}isCompletelyInFrustum(a){return this.boundingBox.isCompletelyInFrustum(a)}_checkCollision(a){return a._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(a){return!(!this.boundingSphere.centerWorld||!this.boundingSphere.intersectsPoint(a)||!this.boundingBox.intersectsPoint(a))}intersects(a,
b){if(!hi$$module$libs$world_onscreen.Intersects(this.boundingSphere,a.boundingSphere)||!Ut$$module$libs$world_onscreen.Intersects(this.boundingBox,a.boundingBox))return!1;if(!b)return!0;b=this.boundingBox;a=a.boundingBox;return!!(tt$$module$libs$world_onscreen(b.directions[0],b,a)&&tt$$module$libs$world_onscreen(b.directions[1],b,a)&&tt$$module$libs$world_onscreen(b.directions[2],b,a)&&tt$$module$libs$world_onscreen(a.directions[0],b,a)&&tt$$module$libs$world_onscreen(a.directions[1],b,a)&&tt$$module$libs$world_onscreen(a.directions[2],
b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[0],a.directions[0]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[0],a.directions[1]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[0],a.directions[2]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[1],a.directions[0]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[1],
a.directions[1]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[1],a.directions[2]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[2],a.directions[0]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[2],a.directions[1]),b,a)&&tt$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Cross(b.directions[2],a.directions[2]),b,a))}}
ft$$module$libs$world_onscreen._TmpVector3=Ye$$module$libs$world_onscreen.BuildArray(2,p$$module$libs$world_onscreen.Zero);
class hs$$module$libs$world_onscreen{static extractMinAndMaxIndexed(a,b,c,d,e,g){for(let t=c;t<c+d;t++){var n=3*b[t];const w=a[n],z=a[n+1];n=a[n+2];e.minimizeInPlaceFromFloats(w,z,n);g.maximizeInPlaceFromFloats(w,z,n)}}static extractMinAndMax(a,b,c,d,e,g){for(let n=b,t=b*d;n<b+c;n++,t+=d){const w=a[t],z=a[t+1],C=a[t+2];e.minimizeInPlaceFromFloats(w,z,C);g.maximizeInPlaceFromFloats(w,z,C)}}}
T$$module$libs$world_onscreen([Qt$$module$libs$world_onscreen.filter((...[a,b])=>!Array.isArray(a)&&!Array.isArray(b))],hs$$module$libs$world_onscreen,"extractMinAndMaxIndexed",null);T$$module$libs$world_onscreen([Qt$$module$libs$world_onscreen.filter((...[a])=>!Array.isArray(a))],hs$$module$libs$world_onscreen,"extractMinAndMax",null);
function zn$$module$libs$world_onscreen(a,b,c,d,e=null){const g=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=new p$$module$libs$world_onscreen(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return hs$$module$libs$world_onscreen.extractMinAndMaxIndexed(a,b,c,d,g,n),e&&(g.x-=g.x*e.x+e.y,g.y-=g.y*e.x+e.y,g.z-=g.z*e.x+e.y,n.x+=n.x*e.x+e.y,n.y+=n.y*e.x+e.y,n.z+=n.z*e.x+e.y),{minimum:g,maximum:n}}
function Nr$$module$libs$world_onscreen(a,b,c,d=null,e){const g=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=new p$$module$libs$world_onscreen(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return e||=3,hs$$module$libs$world_onscreen.extractMinAndMax(a,b,c,e,g,n),d&&(g.x-=g.x*d.x+d.y,g.y-=g.y*d.x+d.y,g.z-=g.z*d.x+d.y,n.x+=n.x*d.x+d.y,n.y+=n.y*d.x+d.y,n.z+=n.z*d.x+d.y),{minimum:g,maximum:n}}
class Et$$module$libs$world_onscreen{constructor(a,b,c,d,e,g,n,t=!0,w=!0){this.materialIndex=a;this.verticesStart=b;this.verticesCount=c;this.indexStart=d;this.indexCount=e;this._mainDrawWrapperOverride=null;this._linesIndexCount=0;this._lastColliderTransformMatrix=this._lastColliderWorldVertices=this._linesIndexBuffer=null;this._wasDispatched=!1;this._distanceToCamera=this._alphaIndex=this._renderId=0;this._currentMaterial=null;this._mesh=g;this._renderingMesh=n||g;w&&g.subMeshes.push(this);this._engine=
this._mesh.getScene().getEngine();this.resetDrawCache();this._trianglePlanes=[];this._id=g.subMeshes.length-1;t&&(this.refreshBoundingInfo(),g.computeWorldMatrix(!0))}get materialDefines(){var a;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(a=this._getDrawWrapper())||void 0===a?void 0:a.defines}set materialDefines(a){var b;(null!==(b=this._mainDrawWrapperOverride)&&void 0!==b?b:this._getDrawWrapper(void 0,!0)).defines=a}_getDrawWrapper(a,b=!1){a=a??this._engine.currentRenderPassId;
let c=this._drawWrappers[a];return!c&&b&&(this._drawWrappers[a]=c=new Ri$$module$libs$world_onscreen(this._mesh.getScene().getEngine())),c}_removeDrawWrapper(a,b=!0){var c;b&&(null===(c=this._drawWrappers[a])||void 0===c||c.dispose());this._drawWrappers[a]=void 0}get effect(){var a,b;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:null!==(b=null===(a=this._getDrawWrapper())||void 0===a?void 0:a.effect)&&void 0!==b?b:null}get _drawWrapper(){var a;return null!==(a=this._mainDrawWrapperOverride)&&
void 0!==a?a:this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(a){this._mainDrawWrapperOverride=a}setEffect(a,b=null,c,d=!0){const e=this._drawWrapper;e.setEffect(a,b,d);void 0!==c&&(e.materialContext=c);a||(e.defines=null,e.materialContext=void 0)}resetDrawCache(a){if(this._drawWrappers){if(void 0!==a){this._removeDrawWrapper(a);return}for(const b of this._drawWrappers)null==b||b.dispose()}this._drawWrappers=[]}static AddToMesh(a,
b,c,d,e,g,n,t=!0){return new Et$$module$libs$world_onscreen(a,b,c,d,e,g,n,t)}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(a){return this._boundingInfo=a,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?
this._mesh:null}getEffectiveMesh(){return(this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null)||this._renderingMesh}getMaterial(a=!0){var b;const c=null!==(b=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId))&&void 0!==b?b:this._renderingMesh.material;if(c){if(this._isMultiMaterial(c))return a=c.getSubMaterial(this.materialIndex),this._currentMaterial!==a&&(this._currentMaterial=a,this.resetDrawCache()),a}else return a?this._mesh.getScene().defaultMaterial:
null;return c}_isMultiMaterial(a){return void 0!==a.getSubMaterial}refreshBoundingInfo(a=null){if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(a||=this._renderingMesh.getVerticesData(g$$module$libs$world_onscreen.PositionKind),!a)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const b=this._renderingMesh.getIndices();0===this.indexStart&&this.indexCount===b.length?(a=this._renderingMesh.getBoundingInfo(),a={minimum:a.minimum.clone(),
maximum:a.maximum.clone()}):a=zn$$module$libs$world_onscreen(a,b,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(a.minimum,a.maximum):this._boundingInfo=new ft$$module$libs$world_onscreen(a.minimum,a.maximum),this}_checkCollision(a){return this.getBoundingInfo()._checkCollision(a)}updateBoundingInfo(a){let b=this.getBoundingInfo();return b||(this.refreshBoundingInfo(),b=this.getBoundingInfo()),b&&b.update(a),this}isInFrustum(a){const b=
this.getBoundingInfo();return b?b.isInFrustum(a,this._mesh.cullingStrategy):!1}isCompletelyInFrustum(a){const b=this.getBoundingInfo();return b?b.isCompletelyInFrustum(a):!1}render(a){return this._renderingMesh.render(this,a,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(a,b){if(!this._linesIndexBuffer){const c=[];for(let d=this.indexStart;d<this.indexStart+this.indexCount;d+=3)c.push(a[d],a[d+1],a[d+1],a[d+2],a[d+2],a[d]);this._linesIndexBuffer=
b.createIndexBuffer(c);this._linesIndexCount=c.length}return this._linesIndexBuffer}canIntersects(a){const b=this.getBoundingInfo();return b?a.intersectsBox(b.boundingBox):!1}intersects(a,b,c,d,e){const g=this.getMaterial();if(!g)return null;let n=3,t=!1;switch(g.fillMode){case 3:case 5:case 6:case 8:return null;case 7:n=1,t=!0}return 4===g.fillMode?c.length?this._intersectLines(a,b,c,this._mesh.intersectionThreshold,d):this._intersectUnIndexedLines(a,b,c,this._mesh.intersectionThreshold,d):!c.length&&
this._mesh._unIndexed?this._intersectUnIndexedTriangles(a,b,c,d,e):this._intersectTriangles(a,b,c,n,t,d,e)}_intersectLines(a,b,c,d,e){let g=null;for(let n=this.indexStart;n<this.indexStart+this.indexCount;n+=2){const t=a.intersectionSegment(b[c[n]],b[c[n+1]],d);if(!(0>t)&&(e||!g||t<g.distance)&&(g=new Ns$$module$libs$world_onscreen(null,null,t),g.faceId=n/2,e))break}return g}_intersectUnIndexedLines(a,b,c,d,e){c=null;for(let g=this.verticesStart;g<this.verticesStart+this.verticesCount;g+=2){const n=
a.intersectionSegment(b[g],b[g+1],d);if(!(0>n)&&(e||!c||n<c.distance)&&(c=new Ns$$module$libs$world_onscreen(null,null,n),c.faceId=g/2,e))break}return c}_intersectTriangles(a,b,c,d,e,g,n){let t=null,w=-1;for(let C=this.indexStart;C<this.indexStart+this.indexCount-(3-d);C+=d){w++;var z=c[C];const H=c[C+1],M=c[C+2];if(e&&4294967295===M){C+=2;continue}const L=b[z],O=b[H],S=b[M];if(L&&O&&S&&(!n||n(L,O,S,a,z,H,M))&&(z=a.intersectsTriangle(L,O,S))&&!(0>z.distance)&&(g||!t||z.distance<t.distance)&&(t=z,
t.faceId=w,g))break}return t}_intersectUnIndexedTriangles(a,b,c,d,e){c=null;for(let n=this.verticesStart;n<this.verticesStart+this.verticesCount;n+=3){var g=b[n];const t=b[n+1],w=b[n+2];if(!(e&&!e(g,t,w,a,-1,-1,-1)||!(g=a.intersectsTriangle(g,t,w))||0>g.distance)&&(d||!c||g.distance<c.distance)&&(c=g,c.faceId=n/3,d))break}return c}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(a,b){a=new Et$$module$libs$world_onscreen(this.materialIndex,this.verticesStart,this.verticesCount,
this.indexStart,this.indexCount,a,b,!1);if(!this.IsGlobal){b=this.getBoundingInfo();if(!b)return a;a._boundingInfo=new ft$$module$libs$world_onscreen(b.minimum,b.maximum)}return a}dispose(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const a=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(a,1);this.resetDrawCache()}getClassName(){return"SubMesh"}static CreateFromIndices(a,b,c,d,e,g=!0){let n=Number.MAX_VALUE,
t=-Number.MAX_VALUE;const w=(e||d).getIndices();for(let z=b;z<b+c;z++){const C=w[z];C<n&&(n=C);C>t&&(t=C)}return new Et$$module$libs$world_onscreen(a,n,t-n+1,b,c,d,e,g)}}
class we$$module$libs$world_onscreen{static get ForceFullSceneLoadingForIncremental(){return we$$module$libs$world_onscreen._ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(a){we$$module$libs$world_onscreen._ForceFullSceneLoadingForIncremental=a}static get ShowLoadingScreen(){return we$$module$libs$world_onscreen._ShowLoadingScreen}static set ShowLoadingScreen(a){we$$module$libs$world_onscreen._ShowLoadingScreen=a}static get loggingLevel(){return we$$module$libs$world_onscreen._LoggingLevel}static set loggingLevel(a){we$$module$libs$world_onscreen._LoggingLevel=
a}static get CleanBoneMatrixWeights(){return we$$module$libs$world_onscreen._CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(a){we$$module$libs$world_onscreen._CleanBoneMatrixWeights=a}}we$$module$libs$world_onscreen._ForceFullSceneLoadingForIncremental=!1;we$$module$libs$world_onscreen._ShowLoadingScreen=!0;we$$module$libs$world_onscreen._CleanBoneMatrixWeights=!1;we$$module$libs$world_onscreen._LoggingLevel=0;class ut$$module$libs$world_onscreen{}
ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV=!1;
class at$$module$libs$world_onscreen{constructor(a,b,c,d=!1,e=null){this._totalVertices=this.delayLoadState=0;this._indexBufferIsUpdatable=this._isDisposed=!1;this._positionsCache=[];this._parentContainer=null;this.useBoundingInfoFromGeometry=!1;(this._scene=b||fe$$module$libs$world_onscreen.LastCreatedScene)&&(this.id=a,this.uniqueId=this._scene.getUniqueId(),this._engine=this._scene.getEngine(),this._meshes=[],this._vertexBuffers={},this._indices=[],this._updatable=d,c?this.setAllVerticesData(c,
d):this._totalVertices=0,this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),e&&(this.applyToMesh(e),e.computeWorldMatrix(!0)))}get boundingBias(){return this._boundingBias}set boundingBias(a){this._boundingBias?this._boundingBias.copyFrom(a):this._boundingBias=a.clone();this._updateBoundingInfo(!0,null)}static CreateGeometryForMesh(a){const b=new at$$module$libs$world_onscreen(at$$module$libs$world_onscreen.RandomId(),a.getScene());return b.applyToMesh(a),b}get meshes(){return this._meshes}get extend(){return this._extend}getScene(){return this._scene}getEngine(){return this._engine}isReady(){return 1===
this.delayLoadState||0===this.delayLoadState}get doNotSerialize(){for(let a=0;a<this._meshes.length;a++)if(!this._meshes[a].doNotSerialize)return!1;return!0}_rebuild(){this._vertexArrayObjects&&(this._vertexArrayObjects={});0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable));for(const a in this._vertexBuffers)this._vertexBuffers[a]._rebuild()}setAllVerticesData(a,b){a.applyToGeometry(this,b);this._notifyUpdate()}setVerticesData(a,
b,c=!1,d){c&&Array.isArray(b)&&(b=new Float32Array(b));a=new g$$module$libs$world_onscreen(this._engine,b,a,c,0===this._meshes.length,d);this.setVerticesBuffer(a)}removeVerticesData(a){this._vertexBuffers[a]&&(this._vertexBuffers[a].dispose(),delete this._vertexBuffers[a]);this._vertexArrayObjects&&this._disposeVertexArrayObjects()}setVerticesBuffer(a,b=null,c=!0){const d=a.getKind();this._vertexBuffers[d]&&c&&this._vertexBuffers[d].dispose();a._buffer&&a._buffer._increaseReferences();this._vertexBuffers[d]=
a;c=this._meshes;const e=c.length;if(d===g$$module$libs$world_onscreen.PositionKind){const g=a.getData();null!=b?this._totalVertices=b:null!=g&&(this._totalVertices=g.length/(a.type===g$$module$libs$world_onscreen.BYTE?a.byteStride:a.byteStride/4));this._updateExtend(g);this._resetPointsArrayCache();for(a=0;a<e;a++)b=c[a],b.buildBoundingInfo(this._extend.minimum,this._extend.maximum),b._createGlobalSubMesh(b.isUnIndexed),b.computeWorldMatrix(!0),b.synchronizeInstances()}this._notifyUpdate(d)}updateVerticesDataDirectly(a,
b,c,d=!1){const e=this.getVertexBuffer(a);e&&(e.updateDirectly(b,c,d),this._notifyUpdate(a))}updateVerticesData(a,b,c=!1){const d=this.getVertexBuffer(a);d&&(d.update(b),a===g$$module$libs$world_onscreen.PositionKind&&this._updateBoundingInfo(c,b),this._notifyUpdate(a))}_updateBoundingInfo(a,b){if(a&&this._updateExtend(b),this._resetPointsArrayCache(),a){a=this._meshes;for(const c of a){c.hasBoundingInfo?c.getBoundingInfo().reConstruct(this._extend.minimum,this._extend.maximum):c.buildBoundingInfo(this._extend.minimum,
this._extend.maximum);a=c.subMeshes;for(const d of a)d.refreshBoundingInfo()}}}_bind(a,b,c,d){if(a){void 0===b&&(b=this._indexBuffer);var e=this.getVertexBuffers();e&&(b!=this._indexBuffer||!this._vertexArrayObjects&&!d?this._engine.bindBuffers(e,b,a,c):(d=d||this._vertexArrayObjects,d[a.key]||(d[a.key]=this._engine.recordVertexArrayObject(e,b,a,c)),this._engine.bindVertexArrayObject(d[a.key],b)))}}getTotalVertices(){return this.isReady()?this._totalVertices:0}getVerticesData(a,b,c){return(a=this.getVertexBuffer(a))?
a.getFloatData(this._totalVertices,c||b&&1!==this._meshes.length):null}isVertexBufferUpdatable(a){return(a=this._vertexBuffers[a])?a.isUpdatable():!1}getVertexBuffer(a){return this.isReady()?this._vertexBuffers[a]:null}getVertexBuffers(){return this.isReady()?this._vertexBuffers:null}isVerticesDataPresent(a){return this._vertexBuffers?void 0!==this._vertexBuffers[a]:this._delayInfo?-1!==this._delayInfo.indexOf(a):!1}getVerticesDataKinds(){const a=[];let b;if(!this._vertexBuffers&&this._delayInfo)for(b in this._delayInfo)a.push(b);
else for(b in this._vertexBuffers)a.push(b);return a}updateIndices(a,b,c=!1){if(this._indexBuffer)if(this._indexBufferIsUpdatable){const d=a.length!==this._indices.length;if(c||(this._indices=a.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,a,b),d)for(const e of this._meshes)e._createGlobalSubMesh(!0)}else this.setIndices(a,null,!0)}setIndices(a,b=null,c=!1){this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer);this._indices=a;this._indexBufferIsUpdatable=c;0!==this._meshes.length&&
this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,c));null!=b&&(this._totalVertices=b);for(const d of this._meshes)d._createGlobalSubMesh(!0),d.synchronizeInstances();this._notifyUpdate()}getTotalIndices(){return this.isReady()?this._indices.length:0}getIndices(a,b){if(!this.isReady())return null;const c=this._indices;return b||a&&1!==this._meshes.length?c.slice():c}getIndexBuffer(){return this.isReady()?this._indexBuffer:null}_releaseVertexArrayObject(a=null){!a||!this._vertexArrayObjects||
this._vertexArrayObjects[a.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[a.key]),delete this._vertexArrayObjects[a.key])}releaseForMesh(a,b){const c=this._meshes,d=c.indexOf(a);-1!==d&&(c.splice(d,1),this._vertexArrayObjects&&a._invalidateInstanceVertexArrayObject(),a._geometry=null,0===c.length&&b&&this.dispose())}applyToMesh(a){if(a._geometry!==this){var b=a._geometry;b&&b.releaseForMesh(a);this._vertexArrayObjects&&a._invalidateInstanceVertexArrayObject();b=this._meshes;
a._geometry=this;a._internalAbstractMeshDataInfo._positions=null;this._scene.pushGeometry(this);b.push(a);this.isReady()?this._applyToMesh(a):this._boundingInfo&&a.setBoundingInfo(this._boundingInfo)}}_updateExtend(a=null){if(this.useBoundingInfoFromGeometry&&this._boundingInfo)this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()};else if(a||(a=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind),a))this._extend=Nr$$module$libs$world_onscreen(a,
0,this._totalVertices,this.boundingBias,3)}_applyToMesh(a){const b=this._meshes.length;for(const c in this._vertexBuffers)1===b&&this._vertexBuffers[c].create(),c===g$$module$libs$world_onscreen.PositionKind&&(this._extend||this._updateExtend(),a.buildBoundingInfo(this._extend.minimum,this._extend.maximum),a._createGlobalSubMesh(a.isUnIndexed),a._updateBoundingInfo());1===b&&this._indices&&0<this._indices.length&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable));a._syncGeometryWithMorphTargetManager();
a.synchronizeInstances()}_notifyUpdate(a){this.onGeometryUpdated&&this.onGeometryUpdated(this,a);this._vertexArrayObjects&&this._disposeVertexArrayObjects();for(const b of this._meshes)b._markSubMeshesAsAttributesDirty()}load(a,b){2!==this.delayLoadState&&(this.isReady()?b&&b():(this.delayLoadState=2,this._queueLoad(a,b)))}_queueLoad(a,b){this.delayLoadingFile&&(a.addPendingData(this),a._loadFile(this.delayLoadingFile,c=>{if(this._delayLoadingFunction){this._delayLoadingFunction(JSON.parse(c),this);
this.delayLoadState=1;this._delayInfo=[];a.removePendingData(this);c=this._meshes;var d=c.length;for(let e=0;e<d;e++)this._applyToMesh(c[e]);b&&b()}},void 0,!0))}toLeftHanded(){var a=this.getIndices(!1);if(null!=a&&0<a.length){for(var b=0;b<a.length;b+=3){const c=a[b+0];a[b+0]=a[b+2];a[b+2]=c}this.setIndices(a)}a=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind,!1);if(null!=a&&0<a.length){for(b=0;b<a.length;b+=3)a[b+2]=-a[b+2];this.setVerticesData(g$$module$libs$world_onscreen.PositionKind,
a,!1)}a=this.getVerticesData(g$$module$libs$world_onscreen.NormalKind,!1);if(null!=a&&0<a.length){for(b=0;b<a.length;b+=3)a[b+2]=-a[b+2];this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,a,!1)}}_resetPointsArrayCache(){this._positions=null}_generatePointsArray(){if(this._positions)return!0;const a=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);if(!a||0===a.length)return!1;for(let b=3*this._positionsCache.length,c=this._positionsCache.length;b<a.length;b+=3,++c)this._positionsCache[c]=
p$$module$libs$world_onscreen.FromArray(a,b);for(let b=0,c=0;b<a.length;b+=3,++c)this._positionsCache[c].set(a[0+b],a[1+b],a[2+b]);return this._positionsCache.length=a.length/3,this._positions=this._positionsCache,!0}isDisposed(){return this._isDisposed}_disposeVertexArrayObjects(){if(this._vertexArrayObjects){for(var a in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[a]);this._vertexArrayObjects={};a=this._meshes;const b=a.length;for(let c=0;c<b;c++)a[c]._invalidateInstanceVertexArrayObject()}}dispose(){var a=
this._meshes;const b=a.length;let c;for(c=0;c<b;c++)this.releaseForMesh(a[c]);this._meshes.length=0;this._disposeVertexArrayObjects();for(const d in this._vertexBuffers)this._vertexBuffers[d].dispose();if(this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),
this._parentContainer)a=this._parentContainer.geometries.indexOf(this),-1<a&&this._parentContainer.geometries.splice(a,1),this._parentContainer=null;this._isDisposed=!0}copy(a){const b=new J$$module$libs$world_onscreen;b.indices=[];var c=this.getIndices();if(c)for(var d=0;d<c.length;d++)b.indices.push(c[d]);d=c=!1;let e;for(e in this._vertexBuffers){var g=this.getVerticesData(e);g&&(g instanceof Float32Array?b.set(new Float32Array(g),e):b.set(g.slice(0),e),!d)&&(g=this.getVertexBuffer(e))&&(c=g.isUpdatable(),
d=!c)}a=new at$$module$libs$world_onscreen(a,this._scene,b,c);a.delayLoadState=this.delayLoadState;a.delayLoadingFile=this.delayLoadingFile;a._delayLoadingFunction=this._delayLoadingFunction;for(e in this._delayInfo)a._delayInfo=a._delayInfo||[],a._delayInfo.push(e);return a._boundingInfo=new ft$$module$libs$world_onscreen(this._extend.minimum,this._extend.maximum),a}serialize(){const a={};return a.id=this.id,a.uniqueId=this.uniqueId,a.updatable=this._updatable,ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.HasTags(this)&&
(a.tags=ge$$module$libs$world_onscreen.GetTags(this)),a}_toNumberArray(a){return Array.isArray(a)?a:Array.prototype.slice.call(a)}clearCachedData(){this._indices=[];this._resetPointsArrayCache();for(const a in this._vertexBuffers)Object.prototype.hasOwnProperty.call(this._vertexBuffers,a)&&(this._vertexBuffers[a]._buffer._data=null)}serializeVerticeData(){const a=this.serialize();return this.isVerticesDataPresent(g$$module$libs$world_onscreen.PositionKind)&&(a.positions=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.PositionKind)),
this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.PositionKind)&&(a.positions._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)&&(a.normals=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.NormalKind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.NormalKind)&&(a.normals._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.TangentKind)&&(a.tangents=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.TangentKind)),
this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.TangentKind)&&(a.tangents._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind)&&(a.uvs=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.UVKind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.UVKind)&&(a.uvs._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.UV2Kind)&&(a.uv2s=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.UV2Kind)),
this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.UV2Kind)&&(a.uv2s._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.UV3Kind)&&(a.uv3s=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.UV3Kind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.UV3Kind)&&(a.uv3s._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.UV4Kind)&&(a.uv4s=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.UV4Kind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.UV4Kind)&&
(a.uv4s._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.UV5Kind)&&(a.uv5s=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.UV5Kind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.UV5Kind)&&(a.uv5s._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.UV6Kind)&&(a.uv6s=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.UV6Kind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.UV6Kind)&&(a.uv6s._updatable=
!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.ColorKind)&&(a.colors=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.ColorKind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.ColorKind)&&(a.colors._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesIndicesKind)&&(a.matricesIndices=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind)),a.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.MatricesIndicesKind)&&
(a.matricesIndices._updatable=!0)),this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsKind)&&(a.matricesWeights=this._toNumberArray(this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind)),this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.MatricesWeightsKind)&&(a.matricesWeights._updatable=!0)),a.indices=this._toNumberArray(this.getIndices()),a}static ExtractFromMesh(a,b){return(a=a._geometry)?a.copy(b):null}static RandomId(){return X$$module$libs$world_onscreen.RandomId()}static _GetGeometryByLoadedUniqueId(a,
b){for(let c=0;c<b.geometries.length;c++)if(b.geometries[c]._loadedUniqueId===a)return b.geometries[c];return null}static _ImportGeometry(a,b){const c=b.getScene();var d=a.geometryUniqueId,e=a.geometryId;if(d||e)(d=d?this._GetGeometryByLoadedUniqueId(d,c):c.getGeometryById(e))&&d.applyToMesh(b);else if(a instanceof ArrayBuffer){d=b._binaryInfo;d.positionsAttrDesc&&0<d.positionsAttrDesc.count&&(e=new Float32Array(a,d.positionsAttrDesc.offset,d.positionsAttrDesc.count),b.setVerticesData(g$$module$libs$world_onscreen.PositionKind,
e,!1));d.normalsAttrDesc&&0<d.normalsAttrDesc.count&&(e=new Float32Array(a,d.normalsAttrDesc.offset,d.normalsAttrDesc.count),b.setVerticesData(g$$module$libs$world_onscreen.NormalKind,e,!1));d.tangetsAttrDesc&&0<d.tangetsAttrDesc.count&&(e=new Float32Array(a,d.tangetsAttrDesc.offset,d.tangetsAttrDesc.count),b.setVerticesData(g$$module$libs$world_onscreen.TangentKind,e,!1));if(d.uvsAttrDesc&&0<d.uvsAttrDesc.count){e=new Float32Array(a,d.uvsAttrDesc.offset,d.uvsAttrDesc.count);if(ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV)for(var g=
1;g<e.length;g+=2)e[g]=1-e[g];b.setVerticesData(g$$module$libs$world_onscreen.UVKind,e,!1)}if(d.uvs2AttrDesc&&0<d.uvs2AttrDesc.count){e=new Float32Array(a,d.uvs2AttrDesc.offset,d.uvs2AttrDesc.count);if(ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV)for(g=1;g<e.length;g+=2)e[g]=1-e[g];b.setVerticesData(g$$module$libs$world_onscreen.UV2Kind,e,!1)}if(d.uvs3AttrDesc&&0<d.uvs3AttrDesc.count){e=new Float32Array(a,d.uvs3AttrDesc.offset,d.uvs3AttrDesc.count);if(ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV)for(g=
1;g<e.length;g+=2)e[g]=1-e[g];b.setVerticesData(g$$module$libs$world_onscreen.UV3Kind,e,!1)}if(d.uvs4AttrDesc&&0<d.uvs4AttrDesc.count){e=new Float32Array(a,d.uvs4AttrDesc.offset,d.uvs4AttrDesc.count);if(ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV)for(g=1;g<e.length;g+=2)e[g]=1-e[g];b.setVerticesData(g$$module$libs$world_onscreen.UV4Kind,e,!1)}if(d.uvs5AttrDesc&&0<d.uvs5AttrDesc.count){e=new Float32Array(a,d.uvs5AttrDesc.offset,d.uvs5AttrDesc.count);if(ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV)for(g=
1;g<e.length;g+=2)e[g]=1-e[g];b.setVerticesData(g$$module$libs$world_onscreen.UV5Kind,e,!1)}if(d.uvs6AttrDesc&&0<d.uvs6AttrDesc.count){e=new Float32Array(a,d.uvs6AttrDesc.offset,d.uvs6AttrDesc.count);if(ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV)for(g=1;g<e.length;g+=2)e[g]=1-e[g];b.setVerticesData(g$$module$libs$world_onscreen.UV6Kind,e,!1)}d.colorsAttrDesc&&0<d.colorsAttrDesc.count&&(e=new Float32Array(a,d.colorsAttrDesc.offset,d.colorsAttrDesc.count),b.setVerticesData(g$$module$libs$world_onscreen.ColorKind,
e,!1,d.colorsAttrDesc.stride));if(d.matricesIndicesAttrDesc&&0<d.matricesIndicesAttrDesc.count){e=new Int32Array(a,d.matricesIndicesAttrDesc.offset,d.matricesIndicesAttrDesc.count);g=[];for(var n=0;n<e.length;n++){var t=e[n];g.push(t&255);g.push((t&65280)>>8);g.push((t&16711680)>>16);g.push(t>>24&255)}b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,g,!1)}if(d.matricesIndicesExtraAttrDesc&&0<d.matricesIndicesExtraAttrDesc.count){e=new Int32Array(a,d.matricesIndicesExtraAttrDesc.offset,
d.matricesIndicesExtraAttrDesc.count);g=[];for(n=0;n<e.length;n++)t=e[n],g.push(t&255),g.push((t&65280)>>8),g.push((t&16711680)>>16),g.push(t>>24&255);b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,g,!1)}d.matricesWeightsAttrDesc&&0<d.matricesWeightsAttrDesc.count&&(e=new Float32Array(a,d.matricesWeightsAttrDesc.offset,d.matricesWeightsAttrDesc.count),b.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,e,!1));d.indicesAttrDesc&&0<d.indicesAttrDesc.count&&
(e=new Int32Array(a,d.indicesAttrDesc.offset,d.indicesAttrDesc.count),b.setIndices(e,null));if(d.subMeshesAttrDesc&&0<d.subMeshesAttrDesc.count)for(e=new Int32Array(a,d.subMeshesAttrDesc.offset,5*d.subMeshesAttrDesc.count),b.subMeshes=[],g=0;g<d.subMeshesAttrDesc.count;g++)Et$$module$libs$world_onscreen.AddToMesh(e[5*g],e[5*g+1],e[5*g+2],e[5*g+3],e[5*g+4],b)}else if(a.positions&&a.normals&&a.indices){if(b.setVerticesData(g$$module$libs$world_onscreen.PositionKind,a.positions,a.positions._updatable),
b.setVerticesData(g$$module$libs$world_onscreen.NormalKind,a.normals,a.normals._updatable),a.tangents&&b.setVerticesData(g$$module$libs$world_onscreen.TangentKind,a.tangents,a.tangents._updatable),a.uvs&&b.setVerticesData(g$$module$libs$world_onscreen.UVKind,a.uvs,a.uvs._updatable),a.uvs2&&b.setVerticesData(g$$module$libs$world_onscreen.UV2Kind,a.uvs2,a.uvs2._updatable),a.uvs3&&b.setVerticesData(g$$module$libs$world_onscreen.UV3Kind,a.uvs3,a.uvs3._updatable),a.uvs4&&b.setVerticesData(g$$module$libs$world_onscreen.UV4Kind,
a.uvs4,a.uvs4._updatable),a.uvs5&&b.setVerticesData(g$$module$libs$world_onscreen.UV5Kind,a.uvs5,a.uvs5._updatable),a.uvs6&&b.setVerticesData(g$$module$libs$world_onscreen.UV6Kind,a.uvs6,a.uvs6._updatable),a.colors&&b.setVerticesData(g$$module$libs$world_onscreen.ColorKind,me$$module$libs$world_onscreen.CheckColors4(a.colors,a.positions.length/3),a.colors._updatable),a.matricesIndices)if(a.matricesIndices._isExpanded)delete a.matricesIndices._isExpanded,b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,
a.matricesIndices,a.matricesIndices._updatable);else{d=[];for(e=0;e<a.matricesIndices.length;e++)g=a.matricesIndices[e],d.push(g&255),d.push((g&65280)>>8),d.push((g&16711680)>>16),d.push(g>>24&255);b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,d,a.matricesIndices._updatable)}if(a.matricesIndicesExtra)if(a.matricesIndicesExtra._isExpanded)delete a.matricesIndices._isExpanded,b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,a.matricesIndicesExtra,a.matricesIndicesExtra._updatable);
else{d=[];for(e=0;e<a.matricesIndicesExtra.length;e++)g=a.matricesIndicesExtra[e],d.push(g&255),d.push((g&65280)>>8),d.push((g&16711680)>>16),d.push(g>>24&255);b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,d,a.matricesIndicesExtra._updatable)}a.matricesWeights&&(at$$module$libs$world_onscreen._CleanMatricesWeights(a,b),b.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,a.matricesWeights,a.matricesWeights._updatable));a.matricesWeightsExtra&&b.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind,
a.matricesWeightsExtra,a.matricesWeights._updatable);b.setIndices(a.indices,null)}if(a.subMeshes)for(b.subMeshes=[],d=0;d<a.subMeshes.length;d++)e=a.subMeshes[d],Et$$module$libs$world_onscreen.AddToMesh(e.materialIndex,e.verticesStart,e.verticesCount,e.indexStart,e.indexCount,b);b._shouldGenerateFlatShading&&(b.convertToFlatShadedMesh(),b._shouldGenerateFlatShading=!1);b.computeWorldMatrix(!0);c.onMeshImportedObservable.notifyObservers(b)}static _CleanMatricesWeights(a,b){if(we$$module$libs$world_onscreen.CleanBoneMatrixWeights){var c;
if(-1<a.skeletonId&&(c=b.getScene().getLastSkeletonById(a.skeletonId))){c=c.bones.length;var d=b.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind),e=b.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind),g=a.matricesWeights,n=a.matricesWeightsExtra,t=a.numBoneInfluencer,w=g.length;for(let L=0;L<w;L+=4){var z=0,C=-1;for(var H=0;4>H;H++){var M=g[L+H];z+=M;.001>M&&0>C&&(C=H)}if(n)for(H=0;4>H;H++)M=n[L+H],z+=M,.001>M&&0>C&&(C=H+4);if((0>C||C>t-1)&&(C=t-1),.001<z){z=
1/z;for(C=0;4>C;C++)g[L+C]*=z;if(n)for(C=0;4>C;C++)n[L+C]*=z}else 4<=C?(n[L+C-4]=1-z,e[L+C-4]=c):(g[L+C]=1-z,d[L+C]=c)}b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind,d);a.matricesWeightsExtra&&b.setVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind,e)}}}static Parse(a,b,c){const d=new at$$module$libs$world_onscreen(a.id,b,void 0,a.updatable);return d._loadedUniqueId=a.uniqueId,ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.AddTagsTo(d,a.tags),
a.delayLoadingFile?(d.delayLoadState=4,d.delayLoadingFile=c+a.delayLoadingFile,d._boundingInfo=new ft$$module$libs$world_onscreen(p$$module$libs$world_onscreen.FromArray(a.boundingBoxMinimum),p$$module$libs$world_onscreen.FromArray(a.boundingBoxMaximum)),d._delayInfo=[],a.hasUVs&&d._delayInfo.push(g$$module$libs$world_onscreen.UVKind),a.hasUVs2&&d._delayInfo.push(g$$module$libs$world_onscreen.UV2Kind),a.hasUVs3&&d._delayInfo.push(g$$module$libs$world_onscreen.UV3Kind),a.hasUVs4&&d._delayInfo.push(g$$module$libs$world_onscreen.UV4Kind),
a.hasUVs5&&d._delayInfo.push(g$$module$libs$world_onscreen.UV5Kind),a.hasUVs6&&d._delayInfo.push(g$$module$libs$world_onscreen.UV6Kind),a.hasColors&&d._delayInfo.push(g$$module$libs$world_onscreen.ColorKind),a.hasMatricesIndices&&d._delayInfo.push(g$$module$libs$world_onscreen.MatricesIndicesKind),a.hasMatricesWeights&&d._delayInfo.push(g$$module$libs$world_onscreen.MatricesWeightsKind),d._delayLoadingFunction=J$$module$libs$world_onscreen.ImportVertexData):J$$module$libs$world_onscreen.ImportVertexData(a,
d),b.pushGeometry(d,!0),d}}var Lt$$module$libs$world_onscreen;(function(a){a[a.LOCAL=0]="LOCAL";a[a.WORLD=1]="WORLD";a[a.BONE=2]="BONE"})(Lt$$module$libs$world_onscreen||={});class ui$$module$libs$world_onscreen{}ui$$module$libs$world_onscreen.X=new p$$module$libs$world_onscreen(1,0,0);ui$$module$libs$world_onscreen.Y=new p$$module$libs$world_onscreen(0,1,0);ui$$module$libs$world_onscreen.Z=new p$$module$libs$world_onscreen(0,0,1);var dr$$module$libs$world_onscreen;
(function(a){a[a.X=0]="X";a[a.Y=1]="Y";a[a.Z=2]="Z"})(dr$$module$libs$world_onscreen||={});
class Q$$module$libs$world_onscreen extends Xe$$module$libs$world_onscreen{constructor(a,b=null,c=!0){super(a,b);this._forward=new p$$module$libs$world_onscreen(0,0,1);this._up=new p$$module$libs$world_onscreen(0,1,0);this._right=new p$$module$libs$world_onscreen(1,0,0);this._position=p$$module$libs$world_onscreen.Zero();this._rotation=p$$module$libs$world_onscreen.Zero();this._rotationQuaternion=null;this._scaling=p$$module$libs$world_onscreen.One();this._transformToBoneReferal=null;this._isAbsoluteSynced=
!1;this._billboardMode=Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE;this._preserveParentRotationForBillboard=!1;this.scalingDeterminant=1;this.reIntegrateRotationIntoRotationQuaternion=this.ignoreNonUniformScaling=this._infiniteDistance=!1;this._poseMatrix=null;this._localMatrix=x$$module$libs$world_onscreen.Zero();this._usePivotMatrix=!1;this._absolutePosition=p$$module$libs$world_onscreen.Zero();this._absoluteScaling=p$$module$libs$world_onscreen.Zero();this._absoluteRotationQuaternion=Y$$module$libs$world_onscreen.Identity();
this._pivotMatrix=x$$module$libs$world_onscreen.Identity();this._isWorldMatrixFrozen=this._postMultiplyPivotMatrix=!1;this._indexInSceneTransformNodesArray=-1;this.onAfterWorldMatrixUpdateObservable=new w$$module$libs$world_onscreen;this._nonUniformScaling=!1;c&&this.getScene().addTransformNode(this)}get billboardMode(){return this._billboardMode}set billboardMode(a){this._billboardMode!==a&&(this._billboardMode=a)}get preserveParentRotationForBillboard(){return this._preserveParentRotationForBillboard}set preserveParentRotationForBillboard(a){a!==
this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=a)}get infiniteDistance(){return this._infiniteDistance}set infiniteDistance(a){this._infiniteDistance!==a&&(this._infiniteDistance=a)}getClassName(){return"TransformNode"}get position(){return this._position}set position(a){this._position=a;this._isDirty=!0}isUsingPivotMatrix(){return this._usePivotMatrix}get rotation(){return this._rotation}set rotation(a){this._rotation=a;this._rotationQuaternion=null;this._isDirty=
!0}get scaling(){return this._scaling}set scaling(a){this._scaling=a;this._isDirty=!0}get rotationQuaternion(){return this._rotationQuaternion}set rotationQuaternion(a){(this._rotationQuaternion=a)&&this._rotation.setAll(0);this._isDirty=!0}get forward(){return p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(0,0,this.getScene().useRightHandedSystem?-1:1,this.getWorldMatrix(),this._forward),this._forward.normalize()}get up(){return p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(0,
1,0,this.getWorldMatrix(),this._up),this._up.normalize()}get right(){return p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(this.getScene().useRightHandedSystem?-1:1,0,0,this.getWorldMatrix(),this._right),this._right.normalize()}updatePoseMatrix(a){return this._poseMatrix?(this._poseMatrix.copyFrom(a),this):(this._poseMatrix=a.clone(),this)}getPoseMatrix(){return this._poseMatrix||(this._poseMatrix=x$$module$libs$world_onscreen.Identity()),this._poseMatrix}_isSynchronized(){const a=this._cache;
return!(this._billboardMode!==a.billboardMode||this._billboardMode!==Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE||a.pivotMatrixUpdated||this._infiniteDistance||this._position._isDirty||this._scaling._isDirty||this._rotationQuaternion&&this._rotationQuaternion._isDirty||this._rotation._isDirty)}_initCache(){super._initCache();const a=this._cache;a.localMatrixUpdated=!1;a.billboardMode=-1;a.infiniteDistance=!1}get absolutePosition(){return this.getAbsolutePosition()}get absoluteScaling(){return this._syncAbsoluteScalingAndRotation(),
this._absoluteScaling}get absoluteRotationQuaternion(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion}setPreTransformMatrix(a){return this.setPivotMatrix(a,!1)}setPivotMatrix(a,b=!0){return this._pivotMatrix.copyFrom(a),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=b,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=
x$$module$libs$world_onscreen.Invert(this._pivotMatrix)),this}getPivotMatrix(){return this._pivotMatrix}instantiateHierarchy(a=null,b,c){(a=this.clone("Clone of "+(this.name||this.id),a||this.parent,!0))&&c&&c(this,a);for(const d of this.getChildTransformNodes(!0))d.instantiateHierarchy(a,b,c);return a}freezeWorldMatrix(a=null,b=!1){return a?b?(this._rotation.setAll(0),this._rotationQuaternion=this._rotationQuaternion||Y$$module$libs$world_onscreen.Identity(),a.decompose(this._scaling,this._rotationQuaternion,
this._position),this.computeWorldMatrix(!0)):(this._worldMatrix=a,this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._afterComputeWorldMatrix()):(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this}unfreezeWorldMatrix(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this}get isWorldMatrixFrozen(){return this._isWorldMatrixFrozen}getAbsolutePosition(){return this.computeWorldMatrix(),
this._absolutePosition}setAbsolutePosition(a){if(!a)return this;let b,c,d;if(void 0===a.x){if(3>arguments.length)return this;b=arguments[0];c=arguments[1];d=arguments[2]}else b=a.x,c=a.y,d=a.z;if(this.parent){const e=D$$module$libs$world_onscreen.Matrix[0];this.parent.getWorldMatrix().invertToRef(e);p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(b,c,d,e,this.position)}else this.position.x=b,this.position.y=c,this.position.z=d;return this._absolutePosition.copyFrom(a),this}setPositionWithLocalVector(a){return this.computeWorldMatrix(),
this.position=p$$module$libs$world_onscreen.TransformNormal(a,this._localMatrix),this}getPositionExpressedInLocalSpace(){this.computeWorldMatrix();const a=D$$module$libs$world_onscreen.Matrix[0];return this._localMatrix.invertToRef(a),p$$module$libs$world_onscreen.TransformNormal(this.position,a)}locallyTranslate(a){return this.computeWorldMatrix(!0),this.position=p$$module$libs$world_onscreen.TransformCoordinates(a,this._localMatrix),this}lookAt(a,b=0,c=0,d=0,e=Lt$$module$libs$world_onscreen.LOCAL){const g=
Q$$module$libs$world_onscreen._LookAtVectorCache,n=e===Lt$$module$libs$world_onscreen.LOCAL?this.position:this.getAbsolutePosition();if(a.subtractToRef(n,g),this.setDirection(g,b,c,d),e===Lt$$module$libs$world_onscreen.WORLD&&this.parent)this.rotationQuaternion?(a=D$$module$libs$world_onscreen.Matrix[0],this.rotationQuaternion.toRotationMatrix(a),b=D$$module$libs$world_onscreen.Matrix[1],this.parent.getWorldMatrix().getRotationMatrixToRef(b),b.invert(),a.multiplyToRef(b,a),this.rotationQuaternion.fromRotationMatrix(a)):
(a=D$$module$libs$world_onscreen.Quaternion[0],Y$$module$libs$world_onscreen.FromEulerVectorToRef(this.rotation,a),b=D$$module$libs$world_onscreen.Matrix[0],a.toRotationMatrix(b),c=D$$module$libs$world_onscreen.Matrix[1],this.parent.getWorldMatrix().getRotationMatrixToRef(c),c.invert(),b.multiplyToRef(c,b),a.fromRotationMatrix(b),a.toEulerAnglesToRef(this.rotation));return this}getDirection(a){const b=p$$module$libs$world_onscreen.Zero();return this.getDirectionToRef(a,b),b}getDirectionToRef(a,b){return p$$module$libs$world_onscreen.TransformNormalToRef(a,
this.getWorldMatrix(),b),this}setDirection(a,b=0,c=0,d=0){const e=-Math.atan2(a.z,a.x)+Math.PI/2;a=-Math.atan2(a.y,Math.sqrt(a.x*a.x+a.z*a.z));return this.rotationQuaternion?Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(e+b,a+c,d,this.rotationQuaternion):(this.rotation.x=a+c,this.rotation.y=e+b,this.rotation.z=d),this}setPivotPoint(a,b=Lt$$module$libs$world_onscreen.LOCAL){0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);const c=this.getWorldMatrix();b==Lt$$module$libs$world_onscreen.WORLD&&
(b=D$$module$libs$world_onscreen.Matrix[0],c.invertToRef(b),a=p$$module$libs$world_onscreen.TransformCoordinates(a,b));return this.setPivotMatrix(x$$module$libs$world_onscreen.Translation(-a.x,-a.y,-a.z),!0)}getPivotPoint(){const a=p$$module$libs$world_onscreen.Zero();return this.getPivotPointToRef(a),a}getPivotPointToRef(a){return a.x=-this._pivotMatrix.m[12],a.y=-this._pivotMatrix.m[13],a.z=-this._pivotMatrix.m[14],this}getAbsolutePivotPoint(){const a=p$$module$libs$world_onscreen.Zero();return this.getAbsolutePivotPointToRef(a),
a}getAbsolutePivotPointToRef(a){return this.getPivotPointToRef(a),p$$module$libs$world_onscreen.TransformCoordinatesToRef(a,this.getWorldMatrix(),a),this}markAsDirty(a){if(this._isDirty)return this;if(this._children)for(const b of this._children)b.markAsDirty(a);return super.markAsDirty(a)}setParent(a,b=!1,c=!1){if(!a&&!this.parent)return this;const d=D$$module$libs$world_onscreen.Quaternion[0],e=D$$module$libs$world_onscreen.Vector3[0],g=D$$module$libs$world_onscreen.Vector3[1],n=D$$module$libs$world_onscreen.Matrix[1];
x$$module$libs$world_onscreen.IdentityToRef(n);const t=D$$module$libs$world_onscreen.Matrix[0];this.computeWorldMatrix(!0);let w=this.rotationQuaternion;return w||(w=Q$$module$libs$world_onscreen._TmpRotation,Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,w)),x$$module$libs$world_onscreen.ComposeToRef(this.scaling,w,this.position,t),this.parent&&t.multiplyToRef(this.parent.computeWorldMatrix(!0),t),a&&(a.computeWorldMatrix(!0).invertToRef(n),
t.multiplyToRef(n,t)),t.decompose(g,d,e,b?this:void 0),this.rotationQuaternion?this.rotationQuaternion.copyFrom(d):d.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(g),this.position.copyFrom(e),this.parent=a,c&&this.setPivotMatrix(x$$module$libs$world_onscreen.Identity()),this}get nonUniformScaling(){return this._nonUniformScaling}_updateNonUniformScalingState(a){return this._nonUniformScaling===a?!1:(this._nonUniformScaling=a,!0)}attachToBone(a,b){return this._currentParentWhenAttachingToBone=
this.parent,this._transformToBoneReferal=b,this.parent=a,a.getSkeleton().prepare(),0>a.getWorldMatrix().determinant()&&(this.scalingDeterminant*=-1),this}detachFromBone(a=!1){return this.parent?(0>this.parent.getWorldMatrix().determinant()&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,a?this.parent=this._currentParentWhenAttachingToBone:this.parent=null,this):(a&&(this.parent=this._currentParentWhenAttachingToBone),this)}rotate(a,b,c){a.normalize();this.rotationQuaternion||(this.rotationQuaternion=
this.rotation.toQuaternion(),this.rotation.setAll(0));c&&c!==Lt$$module$libs$world_onscreen.LOCAL?(this.parent&&(c=D$$module$libs$world_onscreen.Matrix[0],this.parent.getWorldMatrix().invertToRef(c),a=p$$module$libs$world_onscreen.TransformNormal(a,c)),a=Y$$module$libs$world_onscreen.RotationAxisToRef(a,b,Q$$module$libs$world_onscreen._RotationAxisCache),a.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)):(a=Y$$module$libs$world_onscreen.RotationAxisToRef(a,b,Q$$module$libs$world_onscreen._RotationAxisCache),
this.rotationQuaternion.multiplyToRef(a,this.rotationQuaternion));return this}rotateAround(a,b,c){b.normalize();this.rotationQuaternion||(this.rotationQuaternion=Y$$module$libs$world_onscreen.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));const d=D$$module$libs$world_onscreen.Vector3[0],e=D$$module$libs$world_onscreen.Vector3[1],g=D$$module$libs$world_onscreen.Vector3[2],n=D$$module$libs$world_onscreen.Quaternion[0],t=D$$module$libs$world_onscreen.Matrix[0],
w=D$$module$libs$world_onscreen.Matrix[1],z=D$$module$libs$world_onscreen.Matrix[2],C=D$$module$libs$world_onscreen.Matrix[3];return a.subtractToRef(this.position,d),x$$module$libs$world_onscreen.TranslationToRef(d.x,d.y,d.z,t),x$$module$libs$world_onscreen.TranslationToRef(-d.x,-d.y,-d.z,w),x$$module$libs$world_onscreen.RotationAxisToRef(b,c,z),w.multiplyToRef(z,C),C.multiplyToRef(t,C),C.decompose(e,n,g),this.position.addInPlace(g),n.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),
this}translate(a,b,c){a=a.scale(b);c&&c!==Lt$$module$libs$world_onscreen.LOCAL?this.setAbsolutePosition(this.getAbsolutePosition().add(a)):(c=this.getPositionExpressedInLocalSpace().add(a),this.setPositionWithLocalVector(c));return this}addRotation(a,b,c){let d;this.rotationQuaternion?d=this.rotationQuaternion:(d=D$$module$libs$world_onscreen.Quaternion[1],Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,d));const e=D$$module$libs$world_onscreen.Quaternion[0];
return Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(b,a,c,e),d.multiplyInPlace(e),this.rotationQuaternion||d.toEulerAnglesToRef(this.rotation),this}_getEffectiveParent(){return this.parent}computeWorldMatrix(a){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;var b=this.getScene().getRenderId();if(!this._isDirty&&!a&&(this._currentRenderId===b||this.isSynchronized()))return this._currentRenderId=b,this._worldMatrix;var c=this.getScene().activeCamera,d=0!==(this._billboardMode&
Q$$module$libs$world_onscreen.BILLBOARDMODE_USE_POSITION);const e=this._billboardMode!==Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard;this._updateCache();var g=this._cache;g.pivotMatrixUpdated=!1;g.billboardMode=this.billboardMode;g.infiniteDistance=this.infiniteDistance;g.parent=this._parentNode;this._currentRenderId=b;this._childUpdateId+=1;this._isDirty=!1;this._position._isDirty=!1;this._rotation._isDirty=!1;this._scaling._isDirty=!1;b=this._getEffectiveParent();
g=Q$$module$libs$world_onscreen._TmpScaling;var n=this._position;if(this._infiniteDistance&&!this.parent&&c){n=c.getWorldMatrix();var t=new p$$module$libs$world_onscreen(n.m[12],n.m[13],n.m[14]);n=Q$$module$libs$world_onscreen._TmpTranslation;n.copyFromFloats(this._position.x+t.x,this._position.y+t.y,this._position.z+t.z)}g.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant);var w;(this._rotationQuaternion?(this._rotationQuaternion._isDirty=
!1,w=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(Y$$module$libs$world_onscreen.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(w=Q$$module$libs$world_onscreen._TmpRotation,Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,w)),this._usePivotMatrix)?(t=D$$module$libs$world_onscreen.Matrix[1],
x$$module$libs$world_onscreen.ScalingToRef(g.x,g.y,g.z,t),g=D$$module$libs$world_onscreen.Matrix[0],w.toRotationMatrix(g),this._pivotMatrix.multiplyToRef(t,D$$module$libs$world_onscreen.Matrix[4]),D$$module$libs$world_onscreen.Matrix[4].multiplyToRef(g,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(n.x,n.y,n.z)):x$$module$libs$world_onscreen.ComposeToRef(g,w,n,this._localMatrix);
b&&b.getWorldMatrix?((a&&b.computeWorldMatrix(a),e)?(this._transformToBoneReferal?b.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),D$$module$libs$world_onscreen.Matrix[7]):D$$module$libs$world_onscreen.Matrix[7].copyFrom(b.getWorldMatrix()),a=D$$module$libs$world_onscreen.Vector3[5],w=D$$module$libs$world_onscreen.Vector3[6],g=D$$module$libs$world_onscreen.Quaternion[0],D$$module$libs$world_onscreen.Matrix[7].decompose(w,g,a),x$$module$libs$world_onscreen.ScalingToRef(w.x,
w.y,w.z,D$$module$libs$world_onscreen.Matrix[7]),D$$module$libs$world_onscreen.Matrix[7].setTranslation(a),Q$$module$libs$world_onscreen.BillboardUseParentOrientation&&(this._position.applyRotationQuaternionToRef(g,a),this._localMatrix.setTranslation(a)),this._localMatrix.multiplyToRef(D$$module$libs$world_onscreen.Matrix[7],this._worldMatrix)):this._transformToBoneReferal?(this._localMatrix.multiplyToRef(b.getWorldMatrix(),D$$module$libs$world_onscreen.Matrix[6]),D$$module$libs$world_onscreen.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),
this._worldMatrix)):this._localMatrix.multiplyToRef(b.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()):this._worldMatrix.copyFrom(this._localMatrix);if(e&&c&&this.billboardMode&&!d){if(this._worldMatrix.getTranslationToRef(D$$module$libs$world_onscreen.Vector3[0]),D$$module$libs$world_onscreen.Matrix[1].copyFrom(c.getViewMatrix()),D$$module$libs$world_onscreen.Matrix[1].setTranslationFromFloats(0,0,0),D$$module$libs$world_onscreen.Matrix[1].invertToRef(D$$module$libs$world_onscreen.Matrix[0]),
(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_ALL)!==Q$$module$libs$world_onscreen.BILLBOARDMODE_ALL)D$$module$libs$world_onscreen.Matrix[0].decompose(void 0,D$$module$libs$world_onscreen.Quaternion[0],void 0),c=D$$module$libs$world_onscreen.Vector3[1],D$$module$libs$world_onscreen.Quaternion[0].toEulerAnglesToRef(c),(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_X)!==Q$$module$libs$world_onscreen.BILLBOARDMODE_X&&(c.x=0),(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_Y)!==
Q$$module$libs$world_onscreen.BILLBOARDMODE_Y&&(c.y=0),(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_Z)!==Q$$module$libs$world_onscreen.BILLBOARDMODE_Z&&(c.z=0),x$$module$libs$world_onscreen.RotationYawPitchRollToRef(c.y,c.x,c.z,D$$module$libs$world_onscreen.Matrix[0]);this._worldMatrix.setTranslationFromFloats(0,0,0);this._worldMatrix.multiplyToRef(D$$module$libs$world_onscreen.Matrix[0],this._worldMatrix);this._worldMatrix.setTranslation(D$$module$libs$world_onscreen.Vector3[0])}else e&&
c&&this.billboardMode&&d&&(this._worldMatrix.getTranslationToRef(D$$module$libs$world_onscreen.Vector3[0]),c=c.globalPosition,this._worldMatrix.invertToRef(D$$module$libs$world_onscreen.Matrix[1]),d=D$$module$libs$world_onscreen.Vector3[1],p$$module$libs$world_onscreen.TransformCoordinatesToRef(c,D$$module$libs$world_onscreen.Matrix[1],d),d.normalize(),(Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(-Math.atan2(d.z,d.x)+Math.PI/2,-Math.atan2(d.y,Math.sqrt(d.x*d.x+d.z*d.z)),0,D$$module$libs$world_onscreen.Quaternion[0]),
(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_ALL)!==Q$$module$libs$world_onscreen.BILLBOARDMODE_ALL)?(c=D$$module$libs$world_onscreen.Vector3[1],D$$module$libs$world_onscreen.Quaternion[0].toEulerAnglesToRef(c),(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_X)!==Q$$module$libs$world_onscreen.BILLBOARDMODE_X&&(c.x=0),(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_Y)!==Q$$module$libs$world_onscreen.BILLBOARDMODE_Y&&(c.y=0),(this.billboardMode&Q$$module$libs$world_onscreen.BILLBOARDMODE_Z)!==
Q$$module$libs$world_onscreen.BILLBOARDMODE_Z&&(c.z=0),x$$module$libs$world_onscreen.RotationYawPitchRollToRef(c.y,c.x,c.z,D$$module$libs$world_onscreen.Matrix[0])):x$$module$libs$world_onscreen.FromQuaternionToRef(D$$module$libs$world_onscreen.Quaternion[0],D$$module$libs$world_onscreen.Matrix[0]),this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(D$$module$libs$world_onscreen.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(D$$module$libs$world_onscreen.Vector3[0]));
return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1E-6)?this._updateNonUniformScalingState(!0):b&&b._nonUniformScaling?this._updateNonUniformScalingState(b._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),
this._poseMatrix||(this._poseMatrix=x$$module$libs$world_onscreen.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix}resetLocalMatrix(a=!0){if(this.computeWorldMatrix(),a){a=this.getChildren();for(let b=0;b<a.length;++b){const c=a[b];if(c){c.computeWorldMatrix();const d=D$$module$libs$world_onscreen.Matrix[0];c._localMatrix.multiplyToRef(this._localMatrix,d);const e=D$$module$libs$world_onscreen.Quaternion[0];d.decompose(c.scaling,e,c.position);c.rotationQuaternion?
c.rotationQuaternion.copyFrom(e):e.toEulerAnglesToRef(c.rotation)}}}this.scaling.copyFromFloats(1,1,1);this.position.copyFromFloats(0,0,0);this.rotation.copyFromFloats(0,0,0);this.rotationQuaternion&&(this.rotationQuaternion=Y$$module$libs$world_onscreen.Identity());this._worldMatrix=x$$module$libs$world_onscreen.Identity()}_afterComputeWorldMatrix(){}registerAfterWorldMatrixUpdate(a){return this.onAfterWorldMatrixUpdateObservable.add(a),this}unregisterAfterWorldMatrixUpdate(a){return this.onAfterWorldMatrixUpdateObservable.removeCallback(a),
this}getPositionInCameraSpace(a=null){return a||=this.getScene().activeCamera,p$$module$libs$world_onscreen.TransformCoordinates(this.getAbsolutePosition(),a.getViewMatrix())}getDistanceToCamera(a=null){return a||=this.getScene().activeCamera,this.getAbsolutePosition().subtract(a.globalPosition).length()}clone(a,b,c){const d=ae$$module$libs$world_onscreen.Clone(()=>new Q$$module$libs$world_onscreen(a,this.getScene()),this);if(d.name=a,d.id=a,b&&(d.parent=b),!c)for(b=this.getDescendants(!0),c=0;c<
b.length;c++){const e=b[c];e.clone&&e.clone(a+"."+e.name,d)}return d}serialize(a){a=ae$$module$libs$world_onscreen.Serialize(this,a);return a.type=this.getClassName(),a.uniqueId=this.uniqueId,this.parent&&this.parent._serializeAsParent(a),a.localMatrix=this.getPivotMatrix().asArray(),a.isEnabled=this.isEnabled(),a}static Parse(a,b,c){c=ae$$module$libs$world_onscreen.Parse(()=>new Q$$module$libs$world_onscreen(a.name,b),a,b,c);return a.localMatrix?c.setPreTransformMatrix(x$$module$libs$world_onscreen.FromArray(a.localMatrix)):
a.pivotMatrix&&c.setPivotMatrix(x$$module$libs$world_onscreen.FromArray(a.pivotMatrix)),c.setEnabled(a.isEnabled),c._waitingParsedUniqueId=a.uniqueId,void 0!==a.parentId&&(c._waitingParentId=a.parentId),void 0!==a.parentInstanceIndex&&(c._waitingParentInstanceIndex=a.parentInstanceIndex),c}getChildTransformNodes(a,b){const c=[];return this._getDescendants(c,a,d=>(!b||b(d))&&d instanceof Q$$module$libs$world_onscreen),c}dispose(a,b=!1){if(this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),
this._parentContainer){var c=this._parentContainer.transformNodes.indexOf(this);-1<c&&this._parentContainer.transformNodes.splice(c,1);this._parentContainer=null}if(this.onAfterWorldMatrixUpdateObservable.clear(),a){c=this.getChildTransformNodes(!0);for(const d of c)d.parent=null,d.computeWorldMatrix(!0)}super.dispose(a,b)}normalizeToUnitCube(a=!0,b=!1,c){let d=null,e=null;b&&(this.rotationQuaternion?(e=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&
(d=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));a=this.getHierarchyBoundingVectors(a,c);a=a.max.subtract(a.min);a=Math.max(a.x,a.y,a.z);return 0===a?this:(this.scaling.scaleInPlace(1/a),b&&(this.rotationQuaternion&&e?this.rotationQuaternion.copyFrom(e):this.rotation&&d&&this.rotation.copyFrom(d)),this)}_syncAbsoluteScalingAndRotation(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)}}
Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE=0;Q$$module$libs$world_onscreen.BILLBOARDMODE_X=1;Q$$module$libs$world_onscreen.BILLBOARDMODE_Y=2;Q$$module$libs$world_onscreen.BILLBOARDMODE_Z=4;Q$$module$libs$world_onscreen.BILLBOARDMODE_ALL=7;Q$$module$libs$world_onscreen.BILLBOARDMODE_USE_POSITION=128;Q$$module$libs$world_onscreen.BillboardUseParentOrientation=!1;Q$$module$libs$world_onscreen._TmpRotation=Y$$module$libs$world_onscreen.Zero();Q$$module$libs$world_onscreen._TmpScaling=p$$module$libs$world_onscreen.Zero();
Q$$module$libs$world_onscreen._TmpTranslation=p$$module$libs$world_onscreen.Zero();Q$$module$libs$world_onscreen._LookAtVectorCache=new p$$module$libs$world_onscreen(0,0,0);Q$$module$libs$world_onscreen._RotationAxisCache=new Y$$module$libs$world_onscreen;T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen("position")],Q$$module$libs$world_onscreen.prototype,"_position",void 0);
T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen("rotation")],Q$$module$libs$world_onscreen.prototype,"_rotation",void 0);T$$module$libs$world_onscreen([Dn$$module$libs$world_onscreen("rotationQuaternion")],Q$$module$libs$world_onscreen.prototype,"_rotationQuaternion",void 0);T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen("scaling")],Q$$module$libs$world_onscreen.prototype,"_scaling",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("billboardMode")],Q$$module$libs$world_onscreen.prototype,"_billboardMode",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Q$$module$libs$world_onscreen.prototype,"scalingDeterminant",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("infiniteDistance")],Q$$module$libs$world_onscreen.prototype,"_infiniteDistance",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Q$$module$libs$world_onscreen.prototype,"ignoreNonUniformScaling",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Q$$module$libs$world_onscreen.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0);
class Gn$$module$libs$world_onscreen{constructor(){this._checkCollisions=!1;this._collisionGroup=this._collisionMask=-1;this._collider=this._surroundingMeshes=null;this._oldPositionForCollisions=new p$$module$libs$world_onscreen(0,0,0);this._diffPositionForCollisions=new p$$module$libs$world_onscreen(0,0,0);this._collisionResponse=!0}}
class Xn$$module$libs$world_onscreen{constructor(){this.facetNb=0;this.partitioningSubdivisions=10;this.partitioningBBoxRatio=1.01;this.facetDataEnabled=!1;this.facetParameters={};this.bbSize=p$$module$libs$world_onscreen.Zero();this.subDiv={max:1,X:1,Y:1,Z:1};this.facetDepthSortEnabled=this.facetDepthSort=!1}}
class Hn$$module$libs$world_onscreen{constructor(){this._hasVertexAlpha=!1;this._useVertexColors=!0;this._numBoneInfluencers=4;this._applyFog=!0;this._receiveShadows=!1;this._facetData=new Xn$$module$libs$world_onscreen;this._visibility=1;this._skeleton=null;this._layerMask=268435455;this._computeBonesUsingShaders=!0;this._actAsRegularMesh=this._onlyForInstancesIntermediate=this._isActiveIntermediate=this._onlyForInstances=this._isActive=!1;this._currentLOD=null;this._currentLODIsUpToDate=!1;this._collisionRetryCount=
3;this._morphTargetManager=null;this._renderingGroupId=0;this._positions=this._material=this._bakedVertexAnimationManager=null;this._pointerOverDisableMeshTesting=!1;this._meshCollisionData=new Gn$$module$libs$world_onscreen;this._enableDistantPicking=!1}}
class ot$$module$libs$world_onscreen extends Q$$module$libs$world_onscreen{constructor(a,b=null){switch(super(a,b,!1),this._internalAbstractMeshDataInfo=new Hn$$module$libs$world_onscreen,this._waitingMaterialId=null,this.cullingStrategy=ot$$module$libs$world_onscreen.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,this.onCollideObservable=new w$$module$libs$world_onscreen,this.onCollisionPositionChangeObservable=new w$$module$libs$world_onscreen,this.onMaterialChangedObservable=new w$$module$libs$world_onscreen,
this.definedFacingForward=!0,this._occlusionQuery=null,this._renderingGroup=null,this.alphaIndex=Number.MAX_VALUE,this.isVisible=!0,this.isPickable=!0,this.isNearPickable=!1,this.isNearGrabbable=!1,this.showSubMeshesBoundingBox=!1,this.isBlocker=!1,this.enablePointerMoveEvents=!1,this.outlineColor=se$$module$libs$world_onscreen.Red(),this.outlineWidth=.02,this.overlayColor=se$$module$libs$world_onscreen.Red(),this.overlayAlpha=.5,this.useOctreeForRenderingSelection=!0,this.useOctreeForPicking=!0,
this.useOctreeForCollisions=!0,this.alwaysSelectAsActiveMesh=!1,this.doNotSyncBoundingInfo=!1,this.actionManager=null,this.ellipsoid=new p$$module$libs$world_onscreen(.5,1,.5),this.ellipsoidOffset=new p$$module$libs$world_onscreen(0,0,0),this.edgesWidth=1,this.edgesColor=new me$$module$libs$world_onscreen(1,0,0,1),this._edgesRenderer=null,this._masterMesh=null,this._boundingInfo=null,this._boundingInfoIsDirty=!0,this._renderId=0,this._intersectionsInProgress=[],this._unIndexed=!1,this._lightSources=
[],this._waitingData={lods:null,actions:null,freezeWorldMatrix:null},this._bonesTransformMatrices=null,this._transformMatrixTexture=null,this.onRebuildObservable=new w$$module$libs$world_onscreen,this._onCollisionPositionChange=(c,d,e=null)=>{d.subtractToRef(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions);this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions.length()>
I$$module$libs$world_onscreen.CollisionsEpsilon&&this.position.addInPlace(this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions);e&&this.onCollideObservable.notifyObservers(e);this.onCollisionPositionChangeObservable.notifyObservers(this.position)},b=this.getScene(),b.addMesh(this),this._resyncLightSources(),this._uniformBuffer=new V$$module$libs$world_onscreen(this.getScene().getEngine(),void 0,void 0,a,!this.getScene().getEngine().isWebGPU),this._buildUniformLayout(),
b.performancePriority){case Ct$$module$libs$world_onscreen.Aggressive:this.doNotSyncBoundingInfo=!0;case Ct$$module$libs$world_onscreen.Intermediate:this.alwaysSelectAsActiveMesh=!0,this.isPickable=!1}}static get BILLBOARDMODE_NONE(){return Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE}static get BILLBOARDMODE_X(){return Q$$module$libs$world_onscreen.BILLBOARDMODE_X}static get BILLBOARDMODE_Y(){return Q$$module$libs$world_onscreen.BILLBOARDMODE_Y}static get BILLBOARDMODE_Z(){return Q$$module$libs$world_onscreen.BILLBOARDMODE_Z}static get BILLBOARDMODE_ALL(){return Q$$module$libs$world_onscreen.BILLBOARDMODE_ALL}static get BILLBOARDMODE_USE_POSITION(){return Q$$module$libs$world_onscreen.BILLBOARDMODE_USE_POSITION}get facetNb(){return this._internalAbstractMeshDataInfo._facetData.facetNb}get partitioningSubdivisions(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions}set partitioningSubdivisions(a){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=
a}get partitioningBBoxRatio(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio}set partitioningBBoxRatio(a){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=a}get mustDepthSortFacets(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort}set mustDepthSortFacets(a){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=a}get facetDepthSortFrom(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom}set facetDepthSortFrom(a){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=
a}get collisionRetryCount(){return this._internalAbstractMeshDataInfo._collisionRetryCount}set collisionRetryCount(a){this._internalAbstractMeshDataInfo._collisionRetryCount=a}get isFacetDataEnabled(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled}get morphTargetManager(){return this._internalAbstractMeshDataInfo._morphTargetManager}set morphTargetManager(a){this._internalAbstractMeshDataInfo._morphTargetManager!==a&&(this._internalAbstractMeshDataInfo._morphTargetManager=a,
this._syncGeometryWithMorphTargetManager())}get bakedVertexAnimationManager(){return this._internalAbstractMeshDataInfo._bakedVertexAnimationManager}set bakedVertexAnimationManager(a){this._internalAbstractMeshDataInfo._bakedVertexAnimationManager!==a&&(this._internalAbstractMeshDataInfo._bakedVertexAnimationManager=a,this._markSubMeshesAsAttributesDirty())}_syncGeometryWithMorphTargetManager(){}_updateNonUniformScalingState(a){return super._updateNonUniformScalingState(a)?(this._markSubMeshesAsMiscDirty(),
!0):!1}set onCollide(a){this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver);this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver=this.onCollideObservable.add(a)}set onCollisionPositionChange(a){this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver);
this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(a)}get visibility(){return this._internalAbstractMeshDataInfo._visibility}set visibility(a){if(this._internalAbstractMeshDataInfo._visibility!==a){var b=this._internalAbstractMeshDataInfo._visibility;this._internalAbstractMeshDataInfo._visibility=a;(1===b&&1!==a||1!==b&&1===a)&&this._markSubMeshesAsMiscDirty()}}get pointerOverDisableMeshTesting(){return this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting}set pointerOverDisableMeshTesting(a){this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting=
a}get renderingGroupId(){return this._internalAbstractMeshDataInfo._renderingGroupId}set renderingGroupId(a){this._internalAbstractMeshDataInfo._renderingGroupId=a}get material(){return this._internalAbstractMeshDataInfo._material}set material(a){this._internalAbstractMeshDataInfo._material!==a&&(this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this._internalAbstractMeshDataInfo._material=
a,a&&a.meshMap&&(a.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&(this.resetDrawCache(),this._unBindEffect()))}getMaterialForRenderPass(a){var b;return null===(b=this._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===b?void 0:b[a]}setMaterialForRenderPass(a,b){this.resetDrawCache(a);this._internalAbstractMeshDataInfo._materialForRenderPass||(this._internalAbstractMeshDataInfo._materialForRenderPass=
[]);this._internalAbstractMeshDataInfo._materialForRenderPass[a]=b}get receiveShadows(){return this._internalAbstractMeshDataInfo._receiveShadows}set receiveShadows(a){this._internalAbstractMeshDataInfo._receiveShadows!==a&&(this._internalAbstractMeshDataInfo._receiveShadows=a,this._markSubMeshesAsLightDirty())}get hasVertexAlpha(){return this._internalAbstractMeshDataInfo._hasVertexAlpha}set hasVertexAlpha(a){this._internalAbstractMeshDataInfo._hasVertexAlpha!==a&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=
a,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())}get useVertexColors(){return this._internalAbstractMeshDataInfo._useVertexColors}set useVertexColors(a){this._internalAbstractMeshDataInfo._useVertexColors!==a&&(this._internalAbstractMeshDataInfo._useVertexColors=a,this._markSubMeshesAsAttributesDirty())}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(a){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==
a&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=a,this._markSubMeshesAsAttributesDirty())}get numBoneInfluencers(){return this._internalAbstractMeshDataInfo._numBoneInfluencers}set numBoneInfluencers(a){this._internalAbstractMeshDataInfo._numBoneInfluencers!==a&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=a,this._markSubMeshesAsAttributesDirty())}get applyFog(){return this._internalAbstractMeshDataInfo._applyFog}set applyFog(a){this._internalAbstractMeshDataInfo._applyFog!==
a&&(this._internalAbstractMeshDataInfo._applyFog=a,this._markSubMeshesAsMiscDirty())}get enableDistantPicking(){return this._internalAbstractMeshDataInfo._enableDistantPicking}set enableDistantPicking(a){this._internalAbstractMeshDataInfo._enableDistantPicking=a}get layerMask(){return this._internalAbstractMeshDataInfo._layerMask}set layerMask(a){a!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=a,this._resyncLightSources())}get collisionMask(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask}set collisionMask(a){this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask=
isNaN(a)?-1:a}get collisionResponse(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse}set collisionResponse(a){this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse=a}get collisionGroup(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup}set collisionGroup(a){this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup=isNaN(a)?-1:a}get surroundingMeshes(){return this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes}set surroundingMeshes(a){this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes=
a}get lightSources(){return this._lightSources}get _positions(){return null}set skeleton(a){const b=this._internalAbstractMeshDataInfo._skeleton;b&&b.needInitialSkinMatrix&&b._unregisterMeshWithPoseMatrix(this);a&&a.needInitialSkinMatrix&&a._registerMeshWithPoseMatrix(this);this._internalAbstractMeshDataInfo._skeleton=a;this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null);this._markSubMeshesAsAttributesDirty()}get skeleton(){return this._internalAbstractMeshDataInfo._skeleton}_buildUniformLayout(){this._uniformBuffer.addUniform("world",
16);this._uniformBuffer.addUniform("visibility",1);this._uniformBuffer.create()}transferToEffect(a){const b=this._uniformBuffer;b.updateMatrix("world",a);b.updateFloat("visibility",this._internalAbstractMeshDataInfo._visibility);b.update()}getMeshUniformBuffer(){return this._uniformBuffer}getClassName(){return"AbstractMesh"}toString(a){let b="Name: "+this.name+", isInstance: "+("InstancedMesh"!==this.getClassName()?"YES":"NO");b+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);const c=
this._internalAbstractMeshDataInfo._skeleton;return c&&(b+=", skeleton: "+c.name),a&&(b+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],b+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),b}_getEffectiveParent(){return this._masterMesh&&this.billboardMode!==Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE?this._masterMesh:super._getEffectiveParent()}_getActionManagerForTrigger(a,b=!0){if(this.actionManager&&(b||
this.actionManager.isRecursive))if(a){if(this.actionManager.hasSpecificTrigger(a))return this.actionManager}else return this.actionManager;return this.parent?this.parent._getActionManagerForTrigger(a,!1):null}_rebuild(a){if(this.onRebuildObservable.notifyObservers(this),null!==this._occlusionQuery&&(this._occlusionQuery=null),this.subMeshes)for(const b of this.subMeshes)b._rebuild()}_resyncLightSources(){this._lightSources.length=0;for(const a of this.getScene().lights)a.isEnabled()&&a.canAffectMesh(this)&&
this._lightSources.push(a);this._markSubMeshesAsLightDirty()}_resyncLightSource(a){const b=a.isEnabled()&&a.canAffectMesh(this),c=this._lightSources.indexOf(a);let d=!1;if(-1===c){if(!b)return;this._lightSources.push(a)}else{if(b)return;d=!0;this._lightSources.splice(c,1)}this._markSubMeshesAsLightDirty(d)}_unBindEffect(){for(const a of this.subMeshes)a.setEffect(null)}_removeLightSource(a,b){a=this._lightSources.indexOf(a);-1!==a&&(this._lightSources.splice(a,1),this._markSubMeshesAsLightDirty(b))}_markSubMeshesAsDirty(a){if(this.subMeshes)for(const b of this.subMeshes)for(let c=
0;c<b._drawWrappers.length;++c){const d=b._drawWrappers[c];d&&d.defines&&d.defines.markAllAsDirty&&a(d.defines)}}_markSubMeshesAsLightDirty(a=!1){this._markSubMeshesAsDirty(b=>b.markAsLightDirty(a))}_markSubMeshesAsAttributesDirty(){this._markSubMeshesAsDirty(a=>a.markAsAttributesDirty())}_markSubMeshesAsMiscDirty(){this._markSubMeshesAsDirty(a=>a.markAsMiscDirty())}markAsDirty(a){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}resetDrawCache(a){if(this.subMeshes)for(const b of this.subMeshes)b.resetDrawCache(a)}get isBlocked(){return!1}getLOD(a){return this}getTotalVertices(){return 0}getTotalIndices(){return 0}getIndices(){return null}getVerticesData(a){return null}setVerticesData(a,
b,c,d){return this}updateVerticesData(a,b,c,d){return this}setIndices(a,b){return this}isVerticesDataPresent(a){return!1}getBoundingInfo(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfoIsDirty&&(this._boundingInfoIsDirty=!1,this._updateBoundingInfo()),this._boundingInfo)}setBoundingInfo(a){return this._boundingInfo=a,this}get hasBoundingInfo(){return null!==this._boundingInfo}buildBoundingInfo(a,b,c){return this._boundingInfo=new ft$$module$libs$world_onscreen(a,b,
c),this._boundingInfo}normalizeToUnitCube(a=!0,b=!1,c){return super.normalizeToUnitCube(a,b,c)}get useBones(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesIndicesKind)&&this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsKind)}_preActivate(){}_preActivateForIntermediateRendering(a){}_activate(a,b){return this._renderId=a,!0}_postActivate(){}_freeze(){}_unFreeze(){}getWorldMatrix(){return this._masterMesh&&
this.billboardMode===Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():super.getWorldMatrix()}_getWorldMatrixDeterminant(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():super._getWorldMatrixDeterminant()}get isAnInstance(){return!1}get hasInstances(){return!1}get hasThinInstances(){return!1}movePOV(a,b,c){return this.position.addInPlace(this.calcMovePOV(a,b,c)),this}calcMovePOV(a,b,c){const d=new x$$module$libs$world_onscreen;(this.rotationQuaternion?
this.rotationQuaternion:Y$$module$libs$world_onscreen.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(d);const e=p$$module$libs$world_onscreen.Zero(),g=this.definedFacingForward?-1:1;return p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(a*g,b,c*g,d,e),e}rotatePOV(a,b,c){return this.rotation.addInPlace(this.calcRotatePOV(a,b,c)),this}calcRotatePOV(a,b,c){const d=this.definedFacingForward?1:-1;return new p$$module$libs$world_onscreen(a*d,b,
c*d)}refreshBoundingInfo(a=!1,b=!1){return this._boundingInfo&&this._boundingInfo.isLocked?this:(this._refreshBoundingInfo(this._getPositionData(a,b),null),this)}_refreshBoundingInfo(a,b){a&&(b=Nr$$module$libs$world_onscreen(a,0,this.getTotalVertices(),b),this._boundingInfo?this._boundingInfo.reConstruct(b.minimum,b.maximum):this._boundingInfo=new ft$$module$libs$world_onscreen(b.minimum,b.maximum));if(this.subMeshes)for(b=0;b<this.subMeshes.length;b++)this.subMeshes[b].refreshBoundingInfo(a);this._updateBoundingInfo()}_getData(a=
!1,b=!1,c,d=g$$module$libs$world_onscreen.PositionKind){if(c=c??this.getVerticesData(d).slice(),c&&b&&this.morphTargetManager){var e=b=0;for(var g=0;g<c.length;g++){for(var n=0;n<this.morphTargetManager.numTargets;n++){var t=this.morphTargetManager.getTarget(n),w=t.influence;0<w&&(t=t.getPositions())&&(c[g]+=(t[g]-c[g])*w)}if(b++,d===g$$module$libs$world_onscreen.PositionKind&&this._positions&&3===b)b=0,n=3*e,this._positions[e++].copyFromFloats(c[n],c[n+1],c[n+2])}}if(c&&a&&this.skeleton&&(a=this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind),
(b=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind))&&a)){g=(e=4<this.numBoneInfluencers)?this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind):null;n=e?this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind):null;w=this.skeleton.getTransformMatrices(this);t=D$$module$libs$world_onscreen.Vector3[0];const z=D$$module$libs$world_onscreen.Matrix[0],C=D$$module$libs$world_onscreen.Matrix[1];let H=0;for(let M=0;M<c.length;M+=3,H+=4){z.reset();
let L,O;for(L=0;4>L;L++)O=b[H+L],0<O&&(x$$module$libs$world_onscreen.FromFloat32ArrayToRefScaled(w,Math.floor(16*a[H+L]),O,C),z.addToSelf(C));if(e)for(L=0;4>L;L++)O=n[H+L],0<O&&(x$$module$libs$world_onscreen.FromFloat32ArrayToRefScaled(w,Math.floor(16*g[H+L]),O,C),z.addToSelf(C));d===g$$module$libs$world_onscreen.NormalKind?p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(c[M],c[M+1],c[M+2],z,t):p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(c[M],c[M+1],c[M+2],z,t);
t.toArray(c,M);d===g$$module$libs$world_onscreen.PositionKind&&this._positions&&this._positions[M/3].copyFrom(t)}}return c}getNormalsData(a=!1,b=!1){return this._getData(a,b,null,g$$module$libs$world_onscreen.NormalKind)}getPositionData(a=!1,b=!1,c){return this._getData(a,b,c,g$$module$libs$world_onscreen.PositionKind)}_getPositionData(a,b){var c;let d=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);if(this._internalAbstractMeshDataInfo._positions&&(this._internalAbstractMeshDataInfo._positions=
null),d&&(a&&this.skeleton||b&&this.morphTargetManager)){if(d=d.slice(),this._generatePointsArray(),this._positions){const e=this._positions;this._internalAbstractMeshDataInfo._positions=Array(e.length);for(let g=0;g<e.length;g++)this._internalAbstractMeshDataInfo._positions[g]=(null===(c=e[g])||void 0===c?void 0:c.clone())||new p$$module$libs$world_onscreen}return this.getPositionData(a,b,d)}return d}_updateBoundingInfo(){return this._boundingInfo?this._boundingInfo.update(this.worldMatrixFromCache):
this._boundingInfo=new ft$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Zero(),p$$module$libs$world_onscreen.Zero(),this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}_updateSubMeshesBoundingInfo(a){if(!this.subMeshes)return this;const b=this.subMeshes.length;for(let c=0;c<b;c++){const d=this.subMeshes[c];(1<b||!d.IsGlobal)&&d.updateBoundingInfo(a)}return this}_afterComputeWorldMatrix(){this.doNotSyncBoundingInfo||(this._boundingInfoIsDirty=!0)}isInFrustum(a){return this.getBoundingInfo().isInFrustum(a,
this.cullingStrategy)}isCompletelyInFrustum(a){return this.getBoundingInfo().isCompletelyInFrustum(a)}intersectsMesh(a,b=!1,c){const d=this.getBoundingInfo(),e=a.getBoundingInfo();if(d.intersects(e,b))return!0;if(c)for(const g of this.getChildMeshes())if(g.intersectsMesh(a,b,!0))return!0;return!1}intersectsPoint(a){return this.getBoundingInfo().intersectsPoint(a)}get checkCollisions(){return this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions}set checkCollisions(a){this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions=
a}get collider(){return this._internalAbstractMeshDataInfo._meshCollisionData._collider}moveWithCollisions(a){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions);const b=this.getScene().collisionCoordinator;return this._internalAbstractMeshDataInfo._meshCollisionData._collider||(this._internalAbstractMeshDataInfo._meshCollisionData._collider=b.createCollider()),this._internalAbstractMeshDataInfo._meshCollisionData._collider._radius=
this.ellipsoid,b.getNewPosition(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,a,this._internalAbstractMeshDataInfo._meshCollisionData._collider,this.collisionRetryCount,this,this._onCollisionPositionChange,this.uniqueId),this}_collideForSubMesh(a,b,c){var d;if(this._generatePointsArray(),!this._positions)return this;if(!a._lastColliderWorldVertices||!a._lastColliderTransformMatrix.equals(b)){a._lastColliderTransformMatrix=b.clone();a._lastColliderWorldVertices=[];
a._trianglePlanes=[];var e=a.verticesStart;const g=a.verticesStart+a.verticesCount;for(;e<g;e++)a._lastColliderWorldVertices.push(p$$module$libs$world_onscreen.TransformCoordinates(this._positions[e],b))}return c._collide(a._trianglePlanes,a._lastColliderWorldVertices,this.getIndices(),a.indexStart,a.indexStart+a.indexCount,a.verticesStart,!!a.getMaterial(),this,this._shouldConvertRHS(),7===(null===(d=a.getMaterial())||void 0===d?void 0:d.fillMode)),this}_processCollisionsForSubMeshes(a,b){const c=
this._scene.getCollidingSubMeshCandidates(this,a),d=c.length;for(let e=0;e<d;e++){const g=c.data[e];1<d&&!g._checkCollision(a)||this._collideForSubMesh(g,b,a)}return this}_shouldConvertRHS(){return!1}_checkCollision(a){if(!this.getBoundingInfo()._checkCollision(a))return this;const b=D$$module$libs$world_onscreen.Matrix[0],c=D$$module$libs$world_onscreen.Matrix[1];return x$$module$libs$world_onscreen.ScalingToRef(1/a._radius.x,1/a._radius.y,1/a._radius.z,b),this.worldMatrixFromCache.multiplyToRef(b,
c),this._processCollisionsForSubMeshes(a,c),this}_generatePointsArray(){return!1}intersects(a,b,c,d=!1,e,g=!1){const n=new zt$$module$libs$world_onscreen;var t="InstancedLinesMesh"===this.getClassName()||"LinesMesh"===this.getClassName()?this.intersectionThreshold:0,w=this.getBoundingInfo();if(!this.subMeshes||!(g||a.intersectsSphere(w.boundingSphere,t)&&a.intersectsBox(w.boundingBox,t)))return n;if(d)return n.hit=!g,n.pickedMesh=g?null:this,n.distance=g?0:p$$module$libs$world_onscreen.Distance(a.origin,
w.boundingSphere.center),n.subMeshId=0,n;if(!this._generatePointsArray())return n;d=null;g=this._scene.getIntersectingSubMeshCandidates(this,a);t=g.length;var z=!1;for(let C=0;C<t;C++){const H=g.data[C].getMaterial();if(H&&(7==H.fillMode||0==H.fillMode||1==H.fillMode||2==H.fillMode||4==H.fillMode)){z=!0;break}}if(!z)return n.hit=!0,n.pickedMesh=this,n.distance=p$$module$libs$world_onscreen.Distance(a.origin,w.boundingSphere.center),n.subMeshId=-1,n;for(w=0;w<t&&(z=g.data[w],1<t&&!z.canIntersects(a)||
!((z=z.intersects(a,this._positions,this.getIndices(),b,c))&&(b||!d||z.distance<d.distance)&&(d=z,d.subMeshId=w,b)));w++);return d?(c=e??this.getWorldMatrix(),b=D$$module$libs$world_onscreen.Vector3[0],e=D$$module$libs$world_onscreen.Vector3[1],p$$module$libs$world_onscreen.TransformCoordinatesToRef(a.origin,c,b),a.direction.scaleToRef(d.distance,e),a=p$$module$libs$world_onscreen.TransformNormal(e,c).addInPlace(b),n.hit=!0,n.distance=p$$module$libs$world_onscreen.Distance(b,a),n.pickedPoint=a,n.pickedMesh=
this,n.bu=d.bu||0,n.bv=d.bv||0,n.subMeshFaceId=d.faceId,n.faceId=d.faceId+g.data[d.subMeshId].indexStart/(-1!==this.getClassName().indexOf("LinesMesh")?2:3),n.subMeshId=d.subMeshId,n):n}clone(a,b,c){return null}releaseSubMeshes(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=[];return this}dispose(a,b=!1){var c;this._scene.useMaterialMeshMap&&this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=
void 0);this.getScene().freeActiveMeshes();this.getScene().freeRenderingGroups();void 0!==this.actionManager&&null!==this.actionManager&&(this.actionManager.dispose(),this.actionManager=null);this._internalAbstractMeshDataInfo._skeleton=null;this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null);for(c=0;c<this._intersectionsInProgress.length;c++){const d=this._intersectionsInProgress[c],e=d._intersectionsInProgress.indexOf(this);d._intersectionsInProgress.splice(e,
1)}this._intersectionsInProgress.length=0;this.getScene().lights.forEach(d=>{let e=d.includedOnlyMeshes.indexOf(this);-1!==e&&d.includedOnlyMeshes.splice(e,1);e=d.excludedMeshes.indexOf(this);-1!==e&&d.excludedMeshes.splice(e,1);if(d=d.getShadowGenerators()){d=d.values();for(var g=d.next();!0!==g.done;g=d.next())(g=g.value.getShadowMap())&&g.renderList&&(e=g.renderList.indexOf(this),-1!==e&&g.renderList.splice(e,1))}});"InstancedMesh"===this.getClassName()&&"InstancedLinesMesh"===this.getClassName()||
this.releaseSubMeshes();c=this.getScene().getEngine();if(null!==this._occlusionQuery&&(this.isOcclusionQueryInProgress=!1,c.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),c.wipeCaches(),this.getScene().removeMesh(this),this._parentContainer)c=this._parentContainer.meshes.indexOf(this),-1<c&&this._parentContainer.meshes.splice(c,1),this._parentContainer=null;if(b&&this.material&&("MultiMaterial"===this.material.getClassName()?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),
!a)for(c=0;c<this.getScene().particleSystems.length;c++)this.getScene().particleSystems[c].emitter===this&&(this.getScene().particleSystems[c].dispose(),c--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData();this._uniformBuffer.dispose();this.onAfterWorldMatrixUpdateObservable.clear();this.onCollideObservable.clear();this.onCollisionPositionChangeObservable.clear();this.onRebuildObservable.clear();super.dispose(a,b)}addChild(a,b=!1){return a.setParent(this,b),
this}removeChild(a,b=!1){return a.setParent(null,b),this}_initFacetData(){const a=this._internalAbstractMeshDataInfo._facetData;a.facetNormals||(a.facetNormals=[]);a.facetPositions||(a.facetPositions=[]);a.facetPartitioning||(a.facetPartitioning=[]);a.facetNb=this.getIndices().length/3|0;a.partitioningSubdivisions=a.partitioningSubdivisions?a.partitioningSubdivisions:10;a.partitioningBBoxRatio=a.partitioningBBoxRatio?a.partitioningBBoxRatio:1.01;for(let b=0;b<a.facetNb;b++)a.facetNormals[b]=p$$module$libs$world_onscreen.Zero(),
a.facetPositions[b]=p$$module$libs$world_onscreen.Zero();return a.facetDataEnabled=!0,this}updateFacetData(){const a=this._internalAbstractMeshDataInfo._facetData;a.facetDataEnabled||this._initFacetData();var b=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);const c=this.getIndices();var d=this.getVerticesData(g$$module$libs$world_onscreen.NormalKind),e=this.getBoundingInfo();if(a.facetDepthSort&&!a.facetDepthSortEnabled){if(a.facetDepthSortEnabled=!0,c instanceof Uint16Array)a.depthSortedIndices=
new Uint16Array(c);else if(c instanceof Uint32Array)a.depthSortedIndices=new Uint32Array(c);else{var g=!1;for(let n=0;n<c.length;n++)if(65535<c[n]){g=!0;break}g?a.depthSortedIndices=new Uint32Array(c):a.depthSortedIndices=new Uint16Array(c)}(a.facetDepthSortFunction=function(n,t){return t.sqDistance-n.sqDistance},a.facetDepthSortFrom)||(g=this.getScene().activeCamera,a.facetDepthSortFrom=g?g.position:p$$module$libs$world_onscreen.Zero());a.depthSortedFacets=[];for(g=0;g<a.facetNb;g++)a.depthSortedFacets.push({ind:3*
g,sqDistance:0});a.invertedMatrix=x$$module$libs$world_onscreen.Identity();a.facetDepthSortOrigin=p$$module$libs$world_onscreen.Zero()}a.bbSize.x=e.maximum.x-e.minimum.x>Re$$module$libs$world_onscreen?e.maximum.x-e.minimum.x:Re$$module$libs$world_onscreen;a.bbSize.y=e.maximum.y-e.minimum.y>Re$$module$libs$world_onscreen?e.maximum.y-e.minimum.y:Re$$module$libs$world_onscreen;a.bbSize.z=e.maximum.z-e.minimum.z>Re$$module$libs$world_onscreen?e.maximum.z-e.minimum.z:Re$$module$libs$world_onscreen;g=a.bbSize.x>
a.bbSize.y?a.bbSize.x:a.bbSize.y;if(g=g>a.bbSize.z?g:a.bbSize.z,a.subDiv.max=a.partitioningSubdivisions,a.subDiv.X=Math.floor(a.subDiv.max*a.bbSize.x/g),a.subDiv.Y=Math.floor(a.subDiv.max*a.bbSize.y/g),a.subDiv.Z=Math.floor(a.subDiv.max*a.bbSize.z/g),a.subDiv.X=1>a.subDiv.X?1:a.subDiv.X,a.subDiv.Y=1>a.subDiv.Y?1:a.subDiv.Y,a.subDiv.Z=1>a.subDiv.Z?1:a.subDiv.Z,a.facetParameters.facetNormals=this.getFacetLocalNormals(),a.facetParameters.facetPositions=this.getFacetLocalPositions(),a.facetParameters.facetPartitioning=
this.getFacetLocalPartitioning(),a.facetParameters.bInfo=e,a.facetParameters.bbSize=a.bbSize,a.facetParameters.subDiv=a.subDiv,a.facetParameters.ratio=this.partitioningBBoxRatio,a.facetParameters.depthSort=a.facetDepthSort,a.facetDepthSort&&a.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(a.invertedMatrix),p$$module$libs$world_onscreen.TransformCoordinatesToRef(a.facetDepthSortFrom,a.invertedMatrix,a.facetDepthSortOrigin),a.facetParameters.distanceTo=a.facetDepthSortOrigin),
a.facetParameters.depthSortedFacets=a.depthSortedFacets,d&&J$$module$libs$world_onscreen.ComputeNormals(b,c,d,a.facetParameters),a.facetDepthSort&&a.facetDepthSortEnabled){a.depthSortedFacets.sort(a.facetDepthSortFunction);b=a.depthSortedIndices.length/3|0;for(d=0;d<b;d++)e=a.depthSortedFacets[d].ind,a.depthSortedIndices[3*d]=c[e],a.depthSortedIndices[3*d+1]=c[e+1],a.depthSortedIndices[3*d+2]=c[e+2];this.updateIndices(a.depthSortedIndices,void 0,!0)}return this}getFacetLocalNormals(){const a=this._internalAbstractMeshDataInfo._facetData;
return a.facetNormals||this.updateFacetData(),a.facetNormals}getFacetLocalPositions(){const a=this._internalAbstractMeshDataInfo._facetData;return a.facetPositions||this.updateFacetData(),a.facetPositions}getFacetLocalPartitioning(){const a=this._internalAbstractMeshDataInfo._facetData;return a.facetPartitioning||this.updateFacetData(),a.facetPartitioning}getFacetPosition(a){const b=p$$module$libs$world_onscreen.Zero();return this.getFacetPositionToRef(a,b),b}getFacetPositionToRef(a,b){a=this.getFacetLocalPositions()[a];
const c=this.getWorldMatrix();return p$$module$libs$world_onscreen.TransformCoordinatesToRef(a,c,b),this}getFacetNormal(a){const b=p$$module$libs$world_onscreen.Zero();return this.getFacetNormalToRef(a,b),b}getFacetNormalToRef(a,b){a=this.getFacetLocalNormals()[a];return p$$module$libs$world_onscreen.TransformNormalToRef(a,this.getWorldMatrix(),b),this}getFacetsAtLocalCoordinates(a,b,c){const d=this.getBoundingInfo(),e=this._internalAbstractMeshDataInfo._facetData;a=Math.floor((a-d.minimum.x*e.partitioningBBoxRatio)*
e.subDiv.X*e.partitioningBBoxRatio/e.bbSize.x);b=Math.floor((b-d.minimum.y*e.partitioningBBoxRatio)*e.subDiv.Y*e.partitioningBBoxRatio/e.bbSize.y);c=Math.floor((c-d.minimum.z*e.partitioningBBoxRatio)*e.subDiv.Z*e.partitioningBBoxRatio/e.bbSize.z);return 0>a||a>e.subDiv.max||0>b||b>e.subDiv.max||0>c||c>e.subDiv.max?null:e.facetPartitioning[a+e.subDiv.max*b+e.subDiv.max*e.subDiv.max*c]}getClosestFacetAtCoordinates(a,b,c,d,e=!1,g=!0){const n=this.getWorldMatrix(),t=D$$module$libs$world_onscreen.Matrix[5];
n.invertToRef(t);const w=D$$module$libs$world_onscreen.Vector3[8];p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(a,b,c,t,w);a=this.getClosestFacetAtLocalCoordinates(w.x,w.y,w.z,d,e,g);return d&&p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(d.x,d.y,d.z,n,d),a}getClosestFacetAtLocalCoordinates(a,b,c,d,e=!1,g=!0){let n=null,t=0,w=0,z=0,C,H=0,M=0,L=0,O=0;const S=this.getFacetLocalPositions(),T=this.getFacetLocalNormals(),P=this.getFacetsAtLocalCoordinates(a,b,c);
if(!P)return null;let W=Number.MAX_VALUE,Z=W,ca,ba,la;for(let ea=0;ea<P.length;ea++)ca=P[ea],ba=T[ca],la=S[ca],C=(a-la.x)*ba.x+(b-la.y)*ba.y+(c-la.z)*ba.z,(!e||e&&g&&0<=C||e&&!g&&0>=C)&&(C=ba.x*la.x+ba.y*la.y+ba.z*la.z,H=-(ba.x*a+ba.y*b+ba.z*c-C)/(ba.x*ba.x+ba.y*ba.y+ba.z*ba.z),M=a+ba.x*H,L=b+ba.y*H,O=c+ba.z*H,t=M-a,w=L-b,z=O-c,Z=t*t+w*w+z*z,Z<W&&(W=Z,n=ca,d&&(d.x=M,d.y=L,d.z=O)));return n}getFacetDataParameters(){return this._internalAbstractMeshDataInfo._facetData.facetParameters}disableFacetData(){const a=
this._internalAbstractMeshDataInfo._facetData;return a.facetDataEnabled&&(a.facetDataEnabled=!1,a.facetPositions=[],a.facetNormals=[],a.facetPartitioning=[],a.facetParameters=null,a.depthSortedIndices=new Uint32Array(0)),this}updateIndices(a,b,c){return this}createNormals(a){const b=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind),c=this.getIndices();let d;return this.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)?d=this.getVerticesData(g$$module$libs$world_onscreen.NormalKind):
d=[],J$$module$libs$world_onscreen.ComputeNormals(b,c,d,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,d,a),this}alignWithNormal(a,b){b||=ui$$module$libs$world_onscreen.Y;const c=D$$module$libs$world_onscreen.Vector3[0],d=D$$module$libs$world_onscreen.Vector3[1];return p$$module$libs$world_onscreen.CrossToRef(b,a,d),p$$module$libs$world_onscreen.CrossToRef(a,d,c),this.rotationQuaternion?Y$$module$libs$world_onscreen.RotationQuaternionFromAxisToRef(c,
a,d,this.rotationQuaternion):p$$module$libs$world_onscreen.RotationFromAxisToRef(c,a,d,this.rotation),this}_checkOcclusionQuery(){return!1}disableEdgesRendering(){throw $$$module$libs$world_onscreen("EdgesRenderer");}enableEdgesRendering(a,b,c){throw $$$module$libs$world_onscreen("EdgesRenderer");}getConnectedParticleSystems(){return this._scene.particleSystems.filter(a=>a.emitter===this)}}ot$$module$libs$world_onscreen.OCCLUSION_TYPE_NONE=0;
ot$$module$libs$world_onscreen.OCCLUSION_TYPE_OPTIMISTIC=1;ot$$module$libs$world_onscreen.OCCLUSION_TYPE_STRICT=2;ot$$module$libs$world_onscreen.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0;ot$$module$libs$world_onscreen.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1;ot$$module$libs$world_onscreen.CULLINGSTRATEGY_STANDARD=0;ot$$module$libs$world_onscreen.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1;ot$$module$libs$world_onscreen.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2;
ot$$module$libs$world_onscreen.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3;st$$module$libs$world_onscreen("BABYLON.AbstractMesh",ot$$module$libs$world_onscreen);
function ls$$module$libs$world_onscreen(a){-1===a.indexOf("vClipPlane")&&a.push("vClipPlane");-1===a.indexOf("vClipPlane2")&&a.push("vClipPlane2");-1===a.indexOf("vClipPlane3")&&a.push("vClipPlane3");-1===a.indexOf("vClipPlane4")&&a.push("vClipPlane4");-1===a.indexOf("vClipPlane5")&&a.push("vClipPlane5");-1===a.indexOf("vClipPlane6")&&a.push("vClipPlane6")}
function Ys$$module$libs$world_onscreen(a,b,c){var d,e,g,n,t,w;let z=!1,C=null!==(d=a.clipPlane)&&void 0!==d?d:b.clipPlane;return z=pi$$module$libs$world_onscreen(C,c,"CLIPPLANE")||z,C=null!==(e=a.clipPlane2)&&void 0!==e?e:b.clipPlane2,z=pi$$module$libs$world_onscreen(C,c,"CLIPPLANE2")||z,C=null!==(g=a.clipPlane3)&&void 0!==g?g:b.clipPlane3,z=pi$$module$libs$world_onscreen(C,c,"CLIPPLANE3")||z,C=null!==(n=a.clipPlane4)&&void 0!==n?n:b.clipPlane4,z=pi$$module$libs$world_onscreen(C,c,"CLIPPLANE4")||
z,C=null!==(t=a.clipPlane5)&&void 0!==t?t:b.clipPlane5,z=pi$$module$libs$world_onscreen(C,c,"CLIPPLANE5")||z,C=null!==(w=a.clipPlane6)&&void 0!==w?w:b.clipPlane6,z=pi$$module$libs$world_onscreen(C,c,"CLIPPLANE6")||z,z}
function cs$$module$libs$world_onscreen(a,b,c){var d,e,g,n,t,w;let z=null!==(d=b.clipPlane)&&void 0!==d?d:c.clipPlane;gi$$module$libs$world_onscreen(a,"vClipPlane",z);z=null!==(e=b.clipPlane2)&&void 0!==e?e:c.clipPlane2;gi$$module$libs$world_onscreen(a,"vClipPlane2",z);z=null!==(g=b.clipPlane3)&&void 0!==g?g:c.clipPlane3;gi$$module$libs$world_onscreen(a,"vClipPlane3",z);z=null!==(n=b.clipPlane4)&&void 0!==n?n:c.clipPlane4;gi$$module$libs$world_onscreen(a,"vClipPlane4",z);z=null!==(t=b.clipPlane5)&&
void 0!==t?t:c.clipPlane5;gi$$module$libs$world_onscreen(a,"vClipPlane5",z);z=null!==(w=b.clipPlane6)&&void 0!==w?w:c.clipPlane6;gi$$module$libs$world_onscreen(a,"vClipPlane6",z)}function gi$$module$libs$world_onscreen(a,b,c){c&&a.setFloat4(b,c.normal.x,c.normal.y,c.normal.z,c.d)}function pi$$module$libs$world_onscreen(a,b,c){let d=!0;a&&(Array.isArray(b)?(a="#define "+c,(d=-1!==b.indexOf(a))||b.push(a)):(d=b[c],b[c]=!0));return!d}
class te$$module$libs$world_onscreen{static BindSceneUniformBuffer(a,b){b.bindToEffect(a,"Scene")}static PrepareDefinesForMergedUV(a,b,c){b._needUVs=!0;b[c]=!0;a.optimizeUVAllocation&&a.getTextureMatrix().isIdentityAs3x2()?(b[c+"DIRECTUV"]=a.coordinatesIndex+1,b["MAINUV"+(a.coordinatesIndex+1)]=!0):b[c+"DIRECTUV"]=0}static BindTextureMatrix(a,b,c){a=a.getTextureMatrix();b.updateMatrix(c+"Matrix",a)}static GetFogState(a,b){return b.fogEnabled&&a.applyFog&&b.fogMode!==re$$module$libs$world_onscreen.FOGMODE_NONE}static PrepareDefinesForMisc(a,
b,c,d,e,g,n){n._areMiscDirty&&(n.LOGARITHMICDEPTH=c,n.POINTSIZE=d,n.FOG=e&&this.GetFogState(a,b),n.NONUNIFORMSCALING=a.nonUniformScaling,n.ALPHATEST=g)}static PrepareDefinesForCamera(a,b){let c=!1;if(a.activeCamera){const d=b.CAMERA_PERSPECTIVE?1:0,e=a.activeCamera.mode===q$$module$libs$world_onscreen.ORTHOGRAPHIC_CAMERA?1:0;a=a.activeCamera.mode===q$$module$libs$world_onscreen.PERSPECTIVE_CAMERA?1:0;((b.CAMERA_ORTHOGRAPHIC?1:0)^e||d^a)&&(b.CAMERA_ORTHOGRAPHIC=1===e,b.CAMERA_PERSPECTIVE=1===a,c=!0)}return c}static PrepareDefinesForFrameBoundValues(a,
b,c,d,e,g=null,n=!1){let t=te$$module$libs$world_onscreen.PrepareDefinesForCamera(a,d);!1!==g&&(t=Ys$$module$libs$world_onscreen(c,a,d));d.DEPTHPREPASS!==!b.getColorWrite()&&(d.DEPTHPREPASS=!d.DEPTHPREPASS,t=!0);d.INSTANCES!==e&&(d.INSTANCES=e,t=!0);d.THIN_INSTANCES!==n&&(d.THIN_INSTANCES=n,t=!0);t&&d.markAsUnprocessed()}static PrepareDefinesForBones(a,b){if(a.useBones&&a.computeBonesUsingShaders&&a.skeleton){b.NUM_BONE_INFLUENCERS=a.numBoneInfluencers;var c=void 0!==b.BONETEXTURE;a.skeleton.isUsingTextureForMatrices&&
c?b.BONETEXTURE=!0:(b.BonesPerMesh=a.skeleton.bones.length+1,b.BONETEXTURE=c?!1:void 0,(c=a.getScene().prePassRenderer)&&c.enabled&&(a=-1===c.excludedSkinnedMesh.indexOf(a),b.BONES_VELOCITY_ENABLED=a))}else b.NUM_BONE_INFLUENCERS=0,b.BonesPerMesh=0,void 0!==b.BONETEXTURE&&(b.BONETEXTURE=!1)}static PrepareDefinesForMorphTargets(a,b){(a=a.morphTargetManager)?(b.MORPHTARGETS_UV=a.supportsUVs&&b.UV1,b.MORPHTARGETS_TANGENT=a.supportsTangents&&b.TANGENT,b.MORPHTARGETS_NORMAL=a.supportsNormals&&b.NORMAL,
b.MORPHTARGETS=0<a.numInfluencers,b.NUM_MORPH_INFLUENCERS=a.numInfluencers,b.MORPHTARGETS_TEXTURE=a.isUsingTextureForTargets):(b.MORPHTARGETS_UV=!1,b.MORPHTARGETS_TANGENT=!1,b.MORPHTARGETS_NORMAL=!1,b.MORPHTARGETS=!1,b.NUM_MORPH_INFLUENCERS=0)}static PrepareDefinesForBakedVertexAnimation(a,b){a=a.bakedVertexAnimationManager;b.BAKED_VERTEX_ANIMATION_TEXTURE=!(!a||!a.isEnabled)}static PrepareDefinesForAttributes(a,b,c,d,e=!1,g=!0,n=!0){if(!b._areAttributesDirty&&b._needNormals===b._normals&&b._needUVs===
b._uvs)return!1;b._normals=b._needNormals;b._uvs=b._needUVs;b.NORMAL=b._needNormals&&a.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind);b._needNormals&&a.isVerticesDataPresent(g$$module$libs$world_onscreen.TangentKind)&&(b.TANGENT=!0);for(let t=1;6>=t;++t)b["UV"+t]=b._needUVs?a.isVerticesDataPresent(`uv${1===t?"":t}`):!1;c&&(c=a.useVertexColors&&a.isVerticesDataPresent(g$$module$libs$world_onscreen.ColorKind),b.VERTEXCOLOR=c,b.VERTEXALPHA=a.hasVertexAlpha&&c&&g);return a.isVerticesDataPresent(g$$module$libs$world_onscreen.ColorInstanceKind)&&
(a.hasInstances||a.hasThinInstances)&&(b.INSTANCESCOLOR=!0),d&&this.PrepareDefinesForBones(a,b),e&&this.PrepareDefinesForMorphTargets(a,b),n&&this.PrepareDefinesForBakedVertexAnimation(a,b),!0}static PrepareDefinesForMultiview(a,b){if(a.activeCamera){const c=b.MULTIVIEW;b.MULTIVIEW=null!==a.activeCamera.outputRenderTarget&&1<a.activeCamera.outputRenderTarget.getViewCount();b.MULTIVIEW!=c&&b.markAsUnprocessed()}}static PrepareDefinesForOIT(a,b,c){const d=b.ORDER_INDEPENDENT_TRANSPARENCY,e=b.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;
b.ORDER_INDEPENDENT_TRANSPARENCY=a.useOrderIndependentTransparency&&c;b.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!a.getEngine().getCaps().textureFloatLinearFiltering;d===b.ORDER_INDEPENDENT_TRANSPARENCY&&e===b.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||b.markAsUnprocessed()}static PrepareDefinesForPrePass(a,b,c){const d=b.PREPASS;if(b._arePrePassDirty){var e=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",
index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"}];if(a.prePassRenderer&&a.prePassRenderer.enabled&&c)for(b.PREPASS=!0,b.SCENE_MRT_COUNT=a.prePassRenderer.mrtCount,c=0;c<e.length;c++){const g=a.prePassRenderer.getIndex(e[c].type);-1!==g?(b[e[c].define]=
!0,b[e[c].index]=g):b[e[c].define]=!1}else for(b.PREPASS=!1,a=0;a<e.length;a++)b[e[a].define]=!1;b.PREPASS!=d&&(b.markAsUnprocessed(),b.markAsImageProcessingDirty())}}static PrepareDefinesForLight(a,b,c,d,e,g,n){var t;switch(n.needNormals=!0,void 0===e["LIGHT"+d]&&(n.needRebuild=!0),e["LIGHT"+d]=!0,e["SPOTLIGHT"+d]=!1,e["HEMILIGHT"+d]=!1,e["POINTLIGHT"+d]=!1,e["DIRLIGHT"+d]=!1,c.prepareLightSpecificDefines(e,d),e["LIGHT_FALLOFF_PHYSICAL"+d]=!1,e["LIGHT_FALLOFF_GLTF"+d]=!1,e["LIGHT_FALLOFF_STANDARD"+
d]=!1,c.falloffType){case Ee$$module$libs$world_onscreen.FALLOFF_GLTF:e["LIGHT_FALLOFF_GLTF"+d]=!0;break;case Ee$$module$libs$world_onscreen.FALLOFF_PHYSICAL:e["LIGHT_FALLOFF_PHYSICAL"+d]=!0;break;case Ee$$module$libs$world_onscreen.FALLOFF_STANDARD:e["LIGHT_FALLOFF_STANDARD"+d]=!0}(g&&!c.specular.equalsFloats(0,0,0)&&(n.specularEnabled=!0),e["SHADOW"+d]=!1,e["SHADOWCSM"+d]=!1,e["SHADOWCSMDEBUG"+d]=!1,e["SHADOWCSMNUM_CASCADES"+d]=!1,e["SHADOWCSMUSESHADOWMAXZ"+d]=!1,e["SHADOWCSMNOBLEND"+d]=!1,e["SHADOWCSM_RIGHTHANDED"+
d]=!1,e["SHADOWPCF"+d]=!1,e["SHADOWPCSS"+d]=!1,e["SHADOWPOISSON"+d]=!1,e["SHADOWESM"+d]=!1,e["SHADOWCLOSEESM"+d]=!1,e["SHADOWCUBE"+d]=!1,e["SHADOWLOWQUALITY"+d]=!1,e["SHADOWMEDIUMQUALITY"+d]=!1,b&&b.receiveShadows&&a.shadowsEnabled&&c.shadowEnabled)&&(a=null!==(t=c.getShadowGenerator(a.activeCamera))&&void 0!==t?t:c.getShadowGenerator())&&(t=a.getShadowMap())&&t.renderList&&0<t.renderList.length&&(n.shadowEnabled=!0,a.prepareDefines(e,d));c.lightmapMode!=Ee$$module$libs$world_onscreen.LIGHTMAP_DEFAULT?
(n.lightmapMode=!0,e["LIGHTMAPEXCLUDED"+d]=!0,e["LIGHTMAPNOSPECULAR"+d]=c.lightmapMode==Ee$$module$libs$world_onscreen.LIGHTMAP_SHADOWSONLY):(e["LIGHTMAPEXCLUDED"+d]=!1,e["LIGHTMAPNOSPECULAR"+d]=!1)}static PrepareDefinesForLights(a,b,c,d,e=4,g=!1){if(!c._areLightsDirty)return c._needNormals;let n=0;const t={needNormals:c._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(a.lightsEnabled&&!g)for(const w of b.lightSources)if(this.PrepareDefinesForLight(a,b,w,n,c,d,t),
n++,n===e)break;c.SPECULARTERM=t.specularEnabled;c.SHADOWS=t.shadowEnabled;for(b=n;b<e;b++)void 0!==c["LIGHT"+b]&&(c["LIGHT"+b]=!1,c["HEMILIGHT"+b]=!1,c["POINTLIGHT"+b]=!1,c["DIRLIGHT"+b]=!1,c["SPOTLIGHT"+b]=!1,c["SHADOW"+b]=!1,c["SHADOWCSM"+b]=!1,c["SHADOWCSMDEBUG"+b]=!1,c["SHADOWCSMNUM_CASCADES"+b]=!1,c["SHADOWCSMUSESHADOWMAXZ"+b]=!1,c["SHADOWCSMNOBLEND"+b]=!1,c["SHADOWCSM_RIGHTHANDED"+b]=!1,c["SHADOWPCF"+b]=!1,c["SHADOWPCSS"+b]=!1,c["SHADOWPOISSON"+b]=!1,c["SHADOWESM"+b]=!1,c["SHADOWCLOSEESM"+
b]=!1,c["SHADOWCUBE"+b]=!1,c["SHADOWLOWQUALITY"+b]=!1,c["SHADOWMEDIUMQUALITY"+b]=!1);a=a.getEngine().getCaps();return void 0===c.SHADOWFLOAT&&(t.needRebuild=!0),c.SHADOWFLOAT=t.shadowEnabled&&(a.textureFloatRender&&a.textureFloatLinearFiltering||a.textureHalfFloatRender&&a.textureHalfFloatLinearFiltering),c.LIGHTMAPEXCLUDED=t.lightmapMode,t.needRebuild&&c.rebuild(),t.needNormals}static PrepareUniformsAndSamplersForLight(a,b,c,d,e=null,g=!1){e&&e.push("Light"+a);!g&&(b.push("vLightData"+a,"vLightDiffuse"+
a,"vLightSpecular"+a,"vLightDirection"+a,"vLightFalloff"+a,"vLightGround"+a,"lightMatrix"+a,"shadowsInfo"+a,"depthValues"+a),c.push("shadowSampler"+a),c.push("depthSampler"+a),b.push("viewFrustumZ"+a,"cascadeBlendFactor"+a,"lightSizeUVCorrection"+a,"depthCorrection"+a,"penumbraDarkness"+a,"frustumLengths"+a),d&&(c.push("projectionLightSampler"+a),b.push("textureProjectionMatrix"+a)))}static PrepareUniformsAndSamplersList(a,b,c,d=4){let e,g=null;a.uniformsNames?(e=a.uniformsNames,g=a.uniformBuffersNames,
b=a.samplers,c=a.defines,d=a.maxSimultaneousLights||0):(e=a,b||=[]);for(a=0;a<d&&c["LIGHT"+a];a++)this.PrepareUniformsAndSamplersForLight(a,e,b,c["PROJECTEDLIGHTTEXTURE"+a],g);c.NUM_MORPH_INFLUENCERS&&e.push("morphTargetInfluences");c.BAKED_VERTEX_ANIMATION_TEXTURE&&(e.push("bakedVertexAnimationSettings"),e.push("bakedVertexAnimationTextureSizeInverted"),e.push("bakedVertexAnimationTime"),b.push("bakedVertexAnimationTexture"))}static HandleFallbacksForShadows(a,b,c=4,d=0){let e=0;for(let g=0;g<c&&
a["LIGHT"+g];g++)0<g&&(e=d+g,b.addFallback(e,"LIGHT"+g)),a.SHADOWS||(a["SHADOW"+g]&&b.addFallback(d,"SHADOW"+g),a["SHADOWPCF"+g]&&b.addFallback(d,"SHADOWPCF"+g),a["SHADOWPCSS"+g]&&b.addFallback(d,"SHADOWPCSS"+g),a["SHADOWPOISSON"+g]&&b.addFallback(d,"SHADOWPOISSON"+g),a["SHADOWESM"+g]&&b.addFallback(d,"SHADOWESM"+g),a["SHADOWCLOSEESM"+g]&&b.addFallback(d,"SHADOWCLOSEESM"+g));return e++}static PrepareAttributesForMorphTargetsInfluencers(a,b,c){this._TmpMorphInfluencers.NUM_MORPH_INFLUENCERS=c;this.PrepareAttributesForMorphTargets(a,
b,this._TmpMorphInfluencers)}static PrepareAttributesForMorphTargets(a,b,c){const d=c.NUM_MORPH_INFLUENCERS;if(0<d&&fe$$module$libs$world_onscreen.LastCreatedEngine){const t=fe$$module$libs$world_onscreen.LastCreatedEngine.getCaps().maxVertexAttribs;var e=b.morphTargetManager;if(null==e||!e.isUsingTextureForTargets){var g=e&&e.supportsNormals&&c.NORMAL,n=e&&e.supportsTangents&&c.TANGENT;c=e&&e.supportsUVs&&c.UV1;for(e=0;e<d;e++)a.push(g$$module$libs$world_onscreen.PositionKind+e),g&&a.push(g$$module$libs$world_onscreen.NormalKind+
e),n&&a.push(g$$module$libs$world_onscreen.TangentKind+e),c&&a.push(g$$module$libs$world_onscreen.UVKind+"_"+e),a.length>t&&O$$module$libs$world_onscreen.Error("Cannot add more vertex attributes for mesh "+b.name)}}}static PrepareAttributesForBakedVertexAnimation(a,b,c){c.BAKED_VERTEX_ANIMATION_TEXTURE&&c.INSTANCES&&a.push("bakedVertexAnimationSettingsInstanced")}static PrepareAttributesForBones(a,b,c,d){0<c.NUM_BONE_INFLUENCERS&&(d.addCPUSkinningFallback(0,b),a.push(g$$module$libs$world_onscreen.MatricesIndicesKind),
a.push(g$$module$libs$world_onscreen.MatricesWeightsKind),4<c.NUM_BONE_INFLUENCERS&&(a.push(g$$module$libs$world_onscreen.MatricesIndicesExtraKind),a.push(g$$module$libs$world_onscreen.MatricesWeightsExtraKind)))}static PrepareAttributesForInstances(a,b){(b.INSTANCES||b.THIN_INSTANCES)&&this.PushAttributesForInstances(a,!!b.PREPASS_VELOCITY);b.INSTANCESCOLOR&&a.push(g$$module$libs$world_onscreen.ColorInstanceKind)}static PushAttributesForInstances(a,b=!1){a.push("world0");a.push("world1");a.push("world2");
a.push("world3");b&&(a.push("previousWorld0"),a.push("previousWorld1"),a.push("previousWorld2"),a.push("previousWorld3"))}static BindLightProperties(a,b,c){a.transferToEffect(b,c+"")}static BindLight(a,b,c,d,e,g=!0){a._bindLight(b,c,d,e,g)}static BindLights(a,b,c,d,e=4){e=Math.min(b.lightSources.length,e);for(let g=0;g<e;g++)this.BindLight(b.lightSources[g],g,a,c,"boolean"==typeof d?d:d.SPECULARTERM,b.receiveShadows)}static BindFogParameters(a,b,c,d=!1){a.fogEnabled&&b.applyFog&&a.fogMode!==re$$module$libs$world_onscreen.FOGMODE_NONE&&
(c.setFloat4("vFogInfos",a.fogMode,a.fogStart,a.fogEnd,a.fogDensity),d?(a.fogColor.toLinearSpaceToRef(this._TempFogColor),c.setColor3("vFogColor",this._TempFogColor)):c.setColor3("vFogColor",a.fogColor))}static BindBonesParameters(a,b,c){if(b&&a&&(a.computeBonesUsingShaders&&b._bonesComputationForcedToCPU&&(a.computeBonesUsingShaders=!1),a.useBones&&a.computeBonesUsingShaders&&a.skeleton)){var d=a.skeleton;d.isUsingTextureForMatrices&&-1<b.getUniformIndex("boneTextureWidth")?(a=d.getTransformMatrixTexture(a),
b.setTexture("boneSampler",a),b.setFloat("boneTextureWidth",4*(d.bones.length+1))):(d=d.getTransformMatrices(a))&&(b.setMatrices("mBones",d),c&&a.getScene().prePassRenderer&&a.getScene().prePassRenderer.getIndex(2)&&(c.previousBones[a.uniqueId]||(c.previousBones[a.uniqueId]=d.slice()),b.setMatrices("mPreviousBones",c.previousBones[a.uniqueId]),te$$module$libs$world_onscreen._CopyBonesTransformationMatrices(d,c.previousBones[a.uniqueId])))}}static _CopyBonesTransformationMatrices(a,b){return b.set(a),
b}static BindMorphTargetParameters(a,b){const c=a.morphTargetManager;a&&c&&b.setFloatArray("morphTargetInfluences",c.influences)}static BindLogDepth(a,b,c){if(!a||a.LOGARITHMICDEPTH||a.indexOf&&0<=a.indexOf("LOGARITHMICDEPTH"))a=c.activeCamera,a.mode===q$$module$libs$world_onscreen.ORTHOGRAPHIC_CAMERA&&O$$module$libs$world_onscreen.Error("Logarithmic depth is not compatible with orthographic cameras!",20),b.setFloat("logarithmicDepthConstant",2/(Math.log(a.maxZ+1)/Math.LN2))}}
te$$module$libs$world_onscreen._TmpMorphInfluencers={NUM_MORPH_INFLUENCERS:0};te$$module$libs$world_onscreen._TempFogColor=se$$module$libs$world_onscreen.Black();
class Xt$$module$libs$world_onscreen{constructor(){this.reset()}reset(){this.enabled=!1;this.mask=255;this.func=519;this.funcRef=1;this.funcMask=255;this.opDepthFail=this.opStencilFail=7680;this.opStencilDepthPass=7681}get func(){return this._func}set func(a){this._func=a}get funcRef(){return this._funcRef}set funcRef(a){this._funcRef=a}get funcMask(){return this._funcMask}set funcMask(a){this._funcMask=a}get opStencilFail(){return this._opStencilFail}set opStencilFail(a){this._opStencilFail=a}get opDepthFail(){return this._opDepthFail}set opDepthFail(a){this._opDepthFail=
a}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(a){this._opStencilDepthPass=a}get mask(){return this._mask}set mask(a){this._mask=a}get enabled(){return this._enabled}set enabled(a){this._enabled=a}getClassName(){return"MaterialStencilState"}copyTo(a){ae$$module$libs$world_onscreen.Clone(()=>a,this)}serialize(){return ae$$module$libs$world_onscreen.Serialize(this)}parse(a,b,c){ae$$module$libs$world_onscreen.Parse(()=>this,a,b,c)}}
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"func",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"funcRef",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"funcMask",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"opStencilFail",null);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"opDepthFail",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"opStencilDepthPass",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"mask",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Xt$$module$libs$world_onscreen.prototype,"enabled",null);var je$$module$libs$world_onscreen;
(function(a){a[a.Created=1]="Created";a[a.Disposed=2]="Disposed";a[a.GetDefineNames=4]="GetDefineNames";a[a.PrepareUniformBuffer=8]="PrepareUniformBuffer";a[a.IsReadyForSubMesh=16]="IsReadyForSubMesh";a[a.PrepareDefines=32]="PrepareDefines";a[a.BindForSubMesh=64]="BindForSubMesh";a[a.PrepareEffect=128]="PrepareEffect";a[a.GetAnimatables=256]="GetAnimatables";a[a.GetActiveTextures=512]="GetActiveTextures";a[a.HasTexture=1024]="HasTexture";a[a.FillRenderTargetTextures=2048]="FillRenderTargetTextures";
a[a.HasRenderTargetTextures=4096]="HasRenderTargetTextures";a[a.HardBindForSubMesh=8192]="HardBindForSubMesh"})(je$$module$libs$world_onscreen||={});
class P$$module$libs$world_onscreen{constructor(a,b,c){this.shadowDepthWrapper=null;this.allowShaderHotSwapping=!0;this.reservedDataStore=this.metadata=null;this.checkReadyOnlyOnce=this.checkReadyOnEveryCall=!1;this.state="";this._alpha=1;this._cullBackFaces=this._backFaceCulling=!0;this._blockDirtyMechanism=!1;this.getRenderTargetTextures=this.onError=this.onCompiled=null;this._storeEffectOnSubMeshes=this.doNotSerialize=!1;this.animations=null;this.onDisposeObservable=new w$$module$libs$world_onscreen;
this._onBindObserver=this._onUnBindObservable=this._onDisposeObserver=null;this._alphaMode=2;this.forceDepthWrite=this.disableColorWrite=this.disableDepthWrite=this._needDepthPrePass=!1;this.depthFunction=0;this.separateCullingPass=!1;this._fogEnabled=!0;this.pointSize=1;this.zOffsetUnits=this.zOffset=0;this.stencil=new Xt$$module$libs$world_onscreen;this._useUBO=!1;this._fillMode=P$$module$libs$world_onscreen.TriangleFillMode;this._cachedColorWriteState=this._cachedDepthWriteState=!1;this._cachedDepthFunctionState=
0;this._indexInSceneMaterialArray=-1;this._parentContainer=this.meshMap=null;this._uniformBufferLayoutBuilt=!1;this._eventInfo={};this._callbackPluginEventGeneric=()=>{};this._callbackPluginEventIsReadyForSubMesh=()=>{};this._callbackPluginEventPrepareDefines=()=>{};this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{};this._callbackPluginEventHardBindForSubMesh=()=>{};this._callbackPluginEventBindForSubMesh=()=>{};this._callbackPluginEventHasRenderTargetTextures=()=>{};this._callbackPluginEventFillRenderTargetTextures=
()=>{};this._forceAlphaTest=!1;this._transparencyMode=null;this.name=a;(b=b||fe$$module$libs$world_onscreen.LastCreatedScene)&&(this._scene=b,this._dirtyCallbacks={},this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),
this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[63]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=a||X$$module$libs$world_onscreen.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new Ri$$module$libs$world_onscreen(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._scene.useRightHandedSystem?this.sideOrientation=P$$module$libs$world_onscreen.ClockWiseSideOrientation:
this.sideOrientation=P$$module$libs$world_onscreen.CounterClockWiseSideOrientation,this._uniformBuffer=new V$$module$libs$world_onscreen(this._scene.getEngine(),void 0,void 0,a),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,c||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),P$$module$libs$world_onscreen.OnEventObservable.notifyObservers(this,je$$module$libs$world_onscreen.Created))}get canRenderToMRT(){return!1}set alpha(a){if(this._alpha!==a){var b=
this._alpha;this._alpha=a;1!==b&&1!==a||this.markAsDirty(P$$module$libs$world_onscreen.MiscDirtyFlag)}}get alpha(){return this._alpha}set backFaceCulling(a){this._backFaceCulling!==a&&(this._backFaceCulling=a,this.markAsDirty(P$$module$libs$world_onscreen.TextureDirtyFlag))}get backFaceCulling(){return this._backFaceCulling}set cullBackFaces(a){this._cullBackFaces!==a&&(this._cullBackFaces=a,this.markAsDirty(P$$module$libs$world_onscreen.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(a){this._blockDirtyMechanism!==
a&&(this._blockDirtyMechanism=a,a||this.markDirty())}atomicMaterialsUpdate(a){this.blockDirtyMechanism=!0;try{a(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(a){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver);this._onDisposeObserver=this.onDisposeObservable.add(a)}get onBindObservable(){return this._onBindObservable||
(this._onBindObservable=new w$$module$libs$world_onscreen),this._onBindObservable}set onBind(a){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver);this._onBindObserver=this.onBindObservable.add(a)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new w$$module$libs$world_onscreen),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new w$$module$libs$world_onscreen),
this._onEffectCreatedObservable}set alphaMode(a){this._alphaMode!==a&&(this._alphaMode=a,this.markAsDirty(P$$module$libs$world_onscreen.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(a){this._needDepthPrePass!==a&&(this._needDepthPrePass=a,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(a){this._fogEnabled!==a&&(this._fogEnabled=a,this.markAsDirty(P$$module$libs$world_onscreen.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case P$$module$libs$world_onscreen.WireFrameFillMode:case P$$module$libs$world_onscreen.LineListDrawMode:case P$$module$libs$world_onscreen.LineLoopDrawMode:case P$$module$libs$world_onscreen.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(a){this.fillMode=
a?P$$module$libs$world_onscreen.WireFrameFillMode:P$$module$libs$world_onscreen.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case P$$module$libs$world_onscreen.PointFillMode:case P$$module$libs$world_onscreen.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(a){this.fillMode=a?P$$module$libs$world_onscreen.PointFillMode:P$$module$libs$world_onscreen.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(a){this._fillMode!==a&&(this._fillMode=a,
this.markAsDirty(P$$module$libs$world_onscreen.MiscDirtyFlag))}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(a){this._drawWrapper=a}toString(a){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.markDirty();this.checkReadyOnlyOnce=!0}unfreeze(){this.markDirty();this.checkReadyOnlyOnce=!1}isReady(a,b){return!0}isReadyForSubMesh(a,b,c){return(a=b.materialDefines)?(this._eventInfo.isReadyForSubMesh=
!0,this._eventInfo.defines=a,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh):!1}getEffect(){return this._drawWrapper.effect}getScene(){return this._scene}get transparencyMode(){return this._transparencyMode}set transparencyMode(a){this._transparencyMode!==a&&(this._transparencyMode=a,this._forceAlphaTest=a===P$$module$libs$world_onscreen.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _disableAlphaBlending(){return this._transparencyMode===
P$$module$libs$world_onscreen.MATERIAL_OPAQUE||this._transparencyMode===P$$module$libs$world_onscreen.MATERIAL_ALPHATEST}needAlphaBlending(){return this._disableAlphaBlending?!1:1>this.alpha}needAlphaBlendingForMesh(a){return 1>a.visibility?!0:this._disableAlphaBlending?!1:a.hasVertexAlpha||this.needAlphaBlending()}needAlphaTesting(){return!!this._forceAlphaTest}_shouldTurnAlphaTestOn(a){return!this.needAlphaBlendingForMesh(a)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}markDirty(a=
!1){const b=this.getScene().meshes;for(const c of b)if(c.subMeshes)for(const d of c.subMeshes)d.getMaterial()===this&&d.effect&&(d.effect._wasPreviouslyReady=!1,d.effect._wasPreviouslyUsingInstances=null,d.effect._forceRebindOnNextCall=a);a&&this.markAsDirty(P$$module$libs$world_onscreen.AllDirtyFlag)}_preBind(a,b=null){const c=this._scene.getEngine();b=(b??this.sideOrientation)===P$$module$libs$world_onscreen.ClockWiseSideOrientation;return c.enableEffect(a||this._getDrawWrapper()),c.setState(this.backFaceCulling,
this.zOffset,!1,b,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),b}bind(a,b){}buildUniformLayout(){const a=this._uniformBuffer;this._eventInfo.ubo=a;this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.PrepareUniformBuffer,this._eventInfo);a.create();this._uniformBufferLayoutBuilt=!0}bindForSubMesh(a,b,c){(a=c.effect)&&(this._eventInfo.subMesh=c,this._callbackPluginEventBindForSubMesh(this._eventInfo),a._forceRebindOnNextCall=
!1)}bindOnlyWorldMatrix(a){}bindView(a){this._useUBO?this._needToBindSceneUbo=!0:a.setMatrix("view",this.getScene().getViewMatrix())}bindViewProjection(a){this._useUBO?this._needToBindSceneUbo=!0:(a.setMatrix("viewProjection",this.getScene().getTransformMatrix()),a.setMatrix("projection",this.getScene().getProjectionMatrix()))}bindEyePosition(a,b){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(a,b)}_afterBind(a,b=null){if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&
b&&(this._needToBindSceneUbo=!1,te$$module$libs$world_onscreen.BindSceneUniformBuffer(b,this.getScene().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),a?this._scene._cachedVisibility=a.visibility:this._scene._cachedVisibility=1,this._onBindObservable&&a&&this._onBindObservable.notifyObservers(a),this.disableDepthWrite)a=this._scene.getEngine(),this._cachedDepthWriteState=a.getDepthWrite(),a.setDepthWrite(!1);this.disableColorWrite&&(a=this._scene.getEngine(),this._cachedColorWriteState=
a.getColorWrite(),a.setColorWrite(!1));0!==this.depthFunction&&(a=this._scene.getEngine(),this._cachedDepthFunctionState=a.getDepthFunction()||0,a.setDepthFunction(this.depthFunction))}unbind(){this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this);0!==this.depthFunction&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState);this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState);this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}getAnimatables(){return this._eventInfo.animatables=
[],this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.GetAnimatables,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.GetActiveTextures,this._eventInfo),this._eventInfo.activeTextures}hasTexture(a){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=a,this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.HasTexture,this._eventInfo),this._eventInfo.hasTexture}clone(a){return null}getBindedMeshes(){if(this.meshMap){const a=
[];for(const b in this.meshMap){const c=this.meshMap[b];c&&a.push(c)}return a}return this._scene.meshes.filter(a=>a.material===this)}forceCompilation(a,b,c,d){const e={clipPlane:!1,useInstances:!1,...c},g=this.getScene(),n=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const t=()=>{if(this._scene&&this._scene.getEngine()){var w=g.clipPlane;if(e.clipPlane&&(g.clipPlane=new xt$$module$libs$world_onscreen(0,0,0,1)),this._storeEffectOnSubMeshes){let z=!0,C=null;if(a.subMeshes){const H=new Et$$module$libs$world_onscreen(0,
0,0,0,0,a,void 0,!1,!1);H.materialDefines&&(H.materialDefines._renderId=-1);this.isReadyForSubMesh(a,H,e.useInstances)||(H.effect&&H.effect.getCompilationError()&&H.effect.allFallbacksProcessed()?C=H.effect.getCompilationError():(z=!1,setTimeout(t,16)))}z&&(this.allowShaderHotSwapping=n,C&&d&&d(C),b&&b(this))}else this.isReady()?(this.allowShaderHotSwapping=n,b&&b(this)):setTimeout(t,16);e.clipPlane&&(g.clipPlane=w)}};t()}forceCompilationAsync(a,b){return new Promise((c,d)=>{this.forceCompilation(a,
()=>{c()},b,e=>{d(e)})})}markAsDirty(a){this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(P$$module$libs$world_onscreen._DirtyCallbackArray.length=0,a&P$$module$libs$world_onscreen.TextureDirtyFlag&&P$$module$libs$world_onscreen._DirtyCallbackArray.push(P$$module$libs$world_onscreen._TextureDirtyCallBack),a&P$$module$libs$world_onscreen.LightDirtyFlag&&P$$module$libs$world_onscreen._DirtyCallbackArray.push(P$$module$libs$world_onscreen._LightsDirtyCallBack),a&P$$module$libs$world_onscreen.FresnelDirtyFlag&&
P$$module$libs$world_onscreen._DirtyCallbackArray.push(P$$module$libs$world_onscreen._FresnelDirtyCallBack),a&P$$module$libs$world_onscreen.AttributesDirtyFlag&&P$$module$libs$world_onscreen._DirtyCallbackArray.push(P$$module$libs$world_onscreen._AttributeDirtyCallBack),a&P$$module$libs$world_onscreen.MiscDirtyFlag&&P$$module$libs$world_onscreen._DirtyCallbackArray.push(P$$module$libs$world_onscreen._MiscDirtyCallBack),a&P$$module$libs$world_onscreen.PrePassDirtyFlag&&P$$module$libs$world_onscreen._DirtyCallbackArray.push(P$$module$libs$world_onscreen._PrePassDirtyCallBack),
P$$module$libs$world_onscreen._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._RunDirtyCallBacks),this.getScene().resetCachedMaterial())}resetDrawCache(){const a=this.getScene().meshes;for(const b of a)if(b.subMeshes)for(const c of b.subMeshes)c.getMaterial()===this&&c.resetDrawCache()}_markAllSubMeshesAsDirty(a){if(!this.getScene().blockMaterialDirtyMechanism&&!this._blockDirtyMechanism){var b=this.getScene().meshes;for(const c of b)if(c.subMeshes)for(const d of c.subMeshes)if(d.getMaterial(!1)===
this)for(const e of d._drawWrappers)!e||!e.defines||!e.defines.markAllAsDirty||this._materialContext===e.materialContext&&a(e.defines)}}_markScenePrePassDirty(){if(!this.getScene().blockMaterialDirtyMechanism&&!this._blockDirtyMechanism){var a=this.getScene().enablePrePassRenderer();a&&a.markAsDirty()}}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._MiscDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(P$$module$libs$world_onscreen._TextureAndMiscDirtyCallBack)}setPrePassRenderer(a){return!1}dispose(a,
b,c){const d=this.getScene();if(d.stopAnimation(this),d.freeProcessedMaterials(),d.removeMaterial(this),this._eventInfo.forceDisposeTextures=b,this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.Disposed,this._eventInfo),this._parentContainer)b=this._parentContainer.materials.indexOf(this),-1<b&&this._parentContainer.materials.splice(b,1),this._parentContainer=null;if(!0!==c)if(this.meshMap)for(var e in this.meshMap){var g=this.meshMap[e];g&&(g.material=null,this.releaseVertexArrayObject(g,
a))}else{e=d.meshes;for(g of e)g.material===this&&!g.sourceMesh&&(g.material=null,this.releaseVertexArrayObject(g,a))}this._uniformBuffer.dispose();a&&this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null);this.metadata=null;this.onDisposeObservable.notifyObservers(this);this.onDisposeObservable.clear();this._onBindObservable&&this._onBindObservable.clear();this._onUnBindObservable&&this._onUnBindObservable.clear();this._onEffectCreatedObservable&&
this._onEffectCreatedObservable.clear();this._eventInfo&&(this._eventInfo={})}releaseVertexArrayObject(a,b){if(a.geometry){const c=a.geometry;if(this._storeEffectOnSubMeshes)for(const d of a.subMeshes)c._releaseVertexArrayObject(d.effect),b&&d.effect&&d.effect.dispose();else c._releaseVertexArrayObject(this._drawWrapper.effect)}}serialize(){const a=ae$$module$libs$world_onscreen.Serialize(this);return a.stencil=this.stencil.serialize(),a.uniqueId=this.uniqueId,a}static Parse(a,b,c){if(!a.customType)a.customType=
"BABYLON.StandardMaterial";else if("BABYLON.PBRMaterial"===a.customType&&a.overloadedAlbedo&&(a.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return O$$module$libs$world_onscreen.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null;b=X$$module$libs$world_onscreen.Instantiate(a.customType).Parse(a,b,c);return b._loadedUniqueId=a.uniqueId,b}}P$$module$libs$world_onscreen.TriangleFillMode=0;
P$$module$libs$world_onscreen.WireFrameFillMode=1;P$$module$libs$world_onscreen.PointFillMode=2;P$$module$libs$world_onscreen.PointListDrawMode=3;P$$module$libs$world_onscreen.LineListDrawMode=4;P$$module$libs$world_onscreen.LineLoopDrawMode=5;P$$module$libs$world_onscreen.LineStripDrawMode=6;P$$module$libs$world_onscreen.TriangleStripDrawMode=7;P$$module$libs$world_onscreen.TriangleFanDrawMode=8;P$$module$libs$world_onscreen.ClockWiseSideOrientation=0;
P$$module$libs$world_onscreen.CounterClockWiseSideOrientation=1;P$$module$libs$world_onscreen.TextureDirtyFlag=1;P$$module$libs$world_onscreen.LightDirtyFlag=2;P$$module$libs$world_onscreen.FresnelDirtyFlag=4;P$$module$libs$world_onscreen.AttributesDirtyFlag=8;P$$module$libs$world_onscreen.MiscDirtyFlag=16;P$$module$libs$world_onscreen.PrePassDirtyFlag=32;P$$module$libs$world_onscreen.AllDirtyFlag=63;P$$module$libs$world_onscreen.MATERIAL_OPAQUE=0;
P$$module$libs$world_onscreen.MATERIAL_ALPHATEST=1;P$$module$libs$world_onscreen.MATERIAL_ALPHABLEND=2;P$$module$libs$world_onscreen.MATERIAL_ALPHATESTANDBLEND=3;P$$module$libs$world_onscreen.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0;P$$module$libs$world_onscreen.MATERIAL_NORMALBLENDMETHOD_RNM=1;P$$module$libs$world_onscreen.OnEventObservable=new w$$module$libs$world_onscreen;P$$module$libs$world_onscreen._AllDirtyCallBack=a=>a.markAllAsDirty();
P$$module$libs$world_onscreen._ImageProcessingDirtyCallBack=a=>a.markAsImageProcessingDirty();P$$module$libs$world_onscreen._TextureDirtyCallBack=a=>a.markAsTexturesDirty();P$$module$libs$world_onscreen._FresnelDirtyCallBack=a=>a.markAsFresnelDirty();P$$module$libs$world_onscreen._MiscDirtyCallBack=a=>a.markAsMiscDirty();P$$module$libs$world_onscreen._PrePassDirtyCallBack=a=>a.markAsPrePassDirty();P$$module$libs$world_onscreen._LightsDirtyCallBack=a=>a.markAsLightDirty();
P$$module$libs$world_onscreen._AttributeDirtyCallBack=a=>a.markAsAttributesDirty();P$$module$libs$world_onscreen._FresnelAndMiscDirtyCallBack=a=>{P$$module$libs$world_onscreen._FresnelDirtyCallBack(a);P$$module$libs$world_onscreen._MiscDirtyCallBack(a)};P$$module$libs$world_onscreen._TextureAndMiscDirtyCallBack=a=>{P$$module$libs$world_onscreen._TextureDirtyCallBack(a);P$$module$libs$world_onscreen._MiscDirtyCallBack(a)};P$$module$libs$world_onscreen._DirtyCallbackArray=[];
P$$module$libs$world_onscreen._RunDirtyCallBacks=a=>{for(const b of P$$module$libs$world_onscreen._DirtyCallbackArray)b(a)};T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"id",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"uniqueId",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"name",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"metadata",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"checkReadyOnEveryCall",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"checkReadyOnlyOnce",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"state",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("alpha")],P$$module$libs$world_onscreen.prototype,"_alpha",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("backFaceCulling")],P$$module$libs$world_onscreen.prototype,"_backFaceCulling",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("cullBackFaces")],P$$module$libs$world_onscreen.prototype,"_cullBackFaces",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"sideOrientation",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("alphaMode")],P$$module$libs$world_onscreen.prototype,"_alphaMode",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"_needDepthPrePass",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"disableDepthWrite",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"disableColorWrite",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"forceDepthWrite",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"depthFunction",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"separateCullingPass",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("fogEnabled")],P$$module$libs$world_onscreen.prototype,"_fogEnabled",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"pointSize",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"zOffset",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"zOffsetUnits",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"pointsCloud",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"fillMode",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],P$$module$libs$world_onscreen.prototype,"transparencyMode",null);
class Ai$$module$libs$world_onscreen extends P$$module$libs$world_onscreen{constructor(a,b){super(a,b,!0);this._waitingSubMaterialsUniqueIds=[];this.getScene().multiMaterials.push(this);this.subMaterials=[];this._storeEffectOnSubMeshes=!0}get subMaterials(){return this._subMaterials}set subMaterials(a){this._subMaterials=a;this._hookArray(a)}getChildren(){return this.subMaterials}_hookArray(a){const b=a.push;a.push=(...d)=>{d=b.apply(a,d);return this._markAllSubMeshesAsTexturesDirty(),d};const c=
a.splice;a.splice=(d,e)=>{d=c.apply(a,[d,e]);return this._markAllSubMeshesAsTexturesDirty(),d}}getSubMaterial(a){return 0>a||a>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[a]}getActiveTextures(){return super.getActiveTextures().concat(...this.subMaterials.map(a=>a?a.getActiveTextures():[]))}hasTexture(a){var b;if(super.hasTexture(a))return!0;for(let c=0;c<this.subMaterials.length;c++)if(null!==(b=this.subMaterials[c])&&void 0!==b&&b.hasTexture(a))return!0;return!1}getClassName(){return"MultiMaterial"}isReadyForSubMesh(a,
b,c){for(let d=0;d<this.subMaterials.length;d++){const e=this.subMaterials[d];if(e)if(e._storeEffectOnSubMeshes){if(!e.isReadyForSubMesh(a,b,c))return!1}else if(!e.isReady(a))return!1}return!0}clone(a,b){const c=new Ai$$module$libs$world_onscreen(a,this.getScene());for(let d=0;d<this.subMaterials.length;d++){let e=null;const g=this.subMaterials[d];b&&g?e=g.clone(a+"-"+g.name):e=this.subMaterials[d];c.subMaterials.push(e)}return c}serialize(){const a={};a.name=this.name;a.id=this.id;a.uniqueId=this.uniqueId;
ge$$module$libs$world_onscreen&&(a.tags=ge$$module$libs$world_onscreen.GetTags(this));a.materialsUniqueIds=[];a.materials=[];for(let b=0;b<this.subMaterials.length;b++){const c=this.subMaterials[b];c?(a.materialsUniqueIds.push(c.uniqueId),a.materials.push(c.id)):(a.materialsUniqueIds.push(null),a.materials.push(null))}return a}dispose(a,b,c){const d=this.getScene();if(d){if(c)for(c=0;c<this.subMaterials.length;c++){const e=this.subMaterials[c];e&&e.dispose(a,b)}c=d.multiMaterials.indexOf(this);0<=
c&&d.multiMaterials.splice(c,1);super.dispose(a,b)}}static ParseMultiMaterial(a,b){const c=new Ai$$module$libs$world_onscreen(a.name,b);return c.id=a.id,c._loadedUniqueId=a.uniqueId,ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.AddTagsTo(c,a.tags),a.materialsUniqueIds?c._waitingSubMaterialsUniqueIds=a.materialsUniqueIds:a.materials.forEach(d=>c.subMaterials.push(b.getLastMaterialById(d))),c}}st$$module$libs$world_onscreen("BABYLON.MultiMaterial",Ai$$module$libs$world_onscreen);
class Kn$$module$libs$world_onscreen{constructor(a,b){this.distanceOrScreenCoverage=a;this.mesh=b}}class Yn$$module$libs$world_onscreen{constructor(){this.visibleInstances={};this.batchCache=new fr$$module$libs$world_onscreen;this.batchCacheReplacementModeInFrozenMode=new fr$$module$libs$world_onscreen;this.instancesBufferSize=2048}}class fr$$module$libs$world_onscreen{constructor(){this.mustReturn=!1;this.visibleInstances=[];this.renderSelf=[];this.hardwareInstancedRendering=[]}}
class Zn$$module$libs$world_onscreen{constructor(){this.instancesCount=0;this.previousMatrixBuffer=this.matrixBuffer=null;this.matrixBufferSize=512;this.matrixData=null;this.boundingVectors=[];this.worldMatrices=null}}class qn$$module$libs$world_onscreen{constructor(){this._areNormalsFrozen=!1;this.meshMap=this._source=null;this._preActivateId=-1;this._LODLevels=[];this._useLODScreenCoverage=!1;this._effectiveMaterial=null;this._forcedInstanceCount=0}}
class W$$module$libs$world_onscreen extends ot$$module$libs$world_onscreen{constructor(a,b=null,c=null,d=null,e,g=!0){if(super(a,b),this._internalMeshDataInfo=new qn$$module$libs$world_onscreen,this.delayLoadState=0,this.instances=[],this._creationDataStorage=null,this._geometry=null,this._instanceDataStorage=new Yn$$module$libs$world_onscreen,this._thinInstanceDataStorage=new Zn$$module$libs$world_onscreen,this._shouldGenerateFlatShading=!1,this._originalBuilderSideOrientation=W$$module$libs$world_onscreen.DEFAULTSIDE,
this.overrideMaterialSideOrientation=null,this.ignoreCameraMaxZ=!1,b=this.getScene(),this._onBeforeDraw=(w,z,C)=>{w&&C&&(this._uniformBuffer?this.transferToEffect(z):C.bindOnlyWorldMatrix(z))},d){if(d._geometry&&d._geometry.applyToMesh(this),Us$$module$libs$world_onscreen.DeepCopy(d,this,"name material skeleton instances parent uniqueId source metadata morphTargetManager hasInstances worldMatrixInstancedBuffer previousWorldMatrixInstancedBuffer hasLODLevels geometry isBlocked areNormalsFrozen facetNb isFacetDataEnabled lightSources useBones isAnInstance collider edgesRenderer forward up right absolutePosition absoluteScaling absoluteRotationQuaternion isWorldMatrixFrozen nonUniformScaling behaviors worldMatrixFromCache hasThinInstances cloneMeshMap hasBoundingInfo".split(" "),
["_poseMatrix"]),this._internalMeshDataInfo._source=d,b.useClonedMeshMap&&(d._internalMeshDataInfo.meshMap||(d._internalMeshDataInfo.meshMap={}),d._internalMeshDataInfo.meshMap[this.uniqueId]=this),this._originalBuilderSideOrientation=d._originalBuilderSideOrientation,this._creationDataStorage=d._creationDataStorage,d._ranges){var n=d._ranges;for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&n[t]&&this.createAnimationRange(t,n[t].from,n[t].to)}if(d.metadata&&d.metadata.clone?this.metadata=
d.metadata.clone():this.metadata=d.metadata,ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.HasTags(d)&&ge$$module$libs$world_onscreen.AddTagsTo(this,ge$$module$libs$world_onscreen.GetTags(d,!0)),this.setEnabled(d.isEnabled(!1)),this.parent=d.parent,this.setPivotMatrix(d.getPivotMatrix()),this.id=a+"."+d.id,this.material=d.material,!e)for(e=d.getDescendants(!0),n=0;n<e.length;n++)t=e[n],t.clone&&t.clone(a+"."+t.name,this);if(d.morphTargetManager&&(this.morphTargetManager=d.morphTargetManager),
b.getPhysicsEngine)a=b.getPhysicsEngine(),g&&a&&1===a.getPluginVersion()&&(g=a.getImpostorForPhysicsObject(d))&&(this.physicsImpostor=g.clone(this));for(g=0;g<b.particleSystems.length;g++)a=b.particleSystems[g],a.emitter===d&&a.clone(a.name,this);this.skeleton=d.skeleton;this.refreshBoundingInfo(!0,!0);this.computeWorldMatrix(!0)}null!==c&&(this.parent=c);this._instanceDataStorage.hardwareInstancedRendering=this.getEngine().getCaps().instancedArrays;this._internalMeshDataInfo._onMeshReadyObserverAdded=
w=>{w.unregisterOnNextCall=!0;this.isReady(!0)?this.onMeshReadyObservable.notifyObservers(this):this._internalMeshDataInfo._checkReadinessObserver||(this._internalMeshDataInfo._checkReadinessObserver=this._scene.onBeforeRenderObservable.add(()=>{this.isReady(!0)&&(this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),this._internalMeshDataInfo._checkReadinessObserver=null,this.onMeshReadyObservable.notifyObservers(this))}))};this.onMeshReadyObservable=new w$$module$libs$world_onscreen(this._internalMeshDataInfo._onMeshReadyObserverAdded);
d&&d.onClonedObservable.notifyObservers(this)}static _GetDefaultSideOrientation(a){return a||W$$module$libs$world_onscreen.FRONTSIDE}get useLODScreenCoverage(){return this._internalMeshDataInfo._useLODScreenCoverage}set useLODScreenCoverage(a){this._internalMeshDataInfo._useLODScreenCoverage=a;this._sortLODLevels()}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(a){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==
a&&(a&&this._internalMeshDataInfo._sourcePositions&&(this.setVerticesData(g$$module$libs$world_onscreen.PositionKind,this._internalMeshDataInfo._sourcePositions,!0),this._internalMeshDataInfo._sourceNormals&&this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,this._internalMeshDataInfo._sourceNormals,!0),this._internalMeshDataInfo._sourcePositions=null,this._internalMeshDataInfo._sourceNormals=null),this._internalAbstractMeshDataInfo._computeBonesUsingShaders=a,this._markSubMeshesAsAttributesDirty())}get onBeforeRenderObservable(){return this._internalMeshDataInfo._onBeforeRenderObservable||
(this._internalMeshDataInfo._onBeforeRenderObservable=new w$$module$libs$world_onscreen),this._internalMeshDataInfo._onBeforeRenderObservable}get onBeforeBindObservable(){return this._internalMeshDataInfo._onBeforeBindObservable||(this._internalMeshDataInfo._onBeforeBindObservable=new w$$module$libs$world_onscreen),this._internalMeshDataInfo._onBeforeBindObservable}get onAfterRenderObservable(){return this._internalMeshDataInfo._onAfterRenderObservable||(this._internalMeshDataInfo._onAfterRenderObservable=
new w$$module$libs$world_onscreen),this._internalMeshDataInfo._onAfterRenderObservable}get onBetweenPassObservable(){return this._internalMeshDataInfo._onBetweenPassObservable||(this._internalMeshDataInfo._onBetweenPassObservable=new w$$module$libs$world_onscreen),this._internalMeshDataInfo._onBetweenPassObservable}get onBeforeDrawObservable(){return this._internalMeshDataInfo._onBeforeDrawObservable||(this._internalMeshDataInfo._onBeforeDrawObservable=new w$$module$libs$world_onscreen),this._internalMeshDataInfo._onBeforeDrawObservable}set onBeforeDraw(a){this._onBeforeDrawObserver&&
this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver);this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(a)}get hasInstances(){return 0<this.instances.length}get hasThinInstances(){var a;return 0<(null!==(a=this._thinInstanceDataStorage.instancesCount)&&void 0!==a?a:0)}get forcedInstanceCount(){return this._internalMeshDataInfo._forcedInstanceCount}set forcedInstanceCount(a){this._internalMeshDataInfo._forcedInstanceCount=a}get source(){return this._internalMeshDataInfo._source}get cloneMeshMap(){return this._internalMeshDataInfo.meshMap}get isUnIndexed(){return this._unIndexed}set isUnIndexed(a){this._unIndexed!==
a&&(this._unIndexed=a,this._markSubMeshesAsAttributesDirty())}get worldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesData}get previousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesPreviousData}get manualUpdateOfWorldMatrixInstancedBuffer(){return this._instanceDataStorage.manualUpdate}set manualUpdateOfWorldMatrixInstancedBuffer(a){this._instanceDataStorage.manualUpdate=a}get manualUpdateOfPreviousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.previousManualUpdate}set manualUpdateOfPreviousWorldMatrixInstancedBuffer(a){this._instanceDataStorage.previousManualUpdate=
a}get forceWorldMatrixInstancedBufferUpdate(){return this._instanceDataStorage.forceMatrixUpdates}set forceWorldMatrixInstancedBufferUpdate(a){this._instanceDataStorage.forceMatrixUpdates=a}instantiateHierarchy(a=null,b,c){const d=0===this.getTotalVertices()||b&&b.doNotInstantiate&&(!0===b.doNotInstantiate||b.doNotInstantiate(this))?this.clone("Clone of "+(this.name||this.id),a||this.parent,!0):this.createInstance("instance of "+(this.name||this.id));d.parent=a||this.parent;d.position=this.position.clone();
d.scaling=this.scaling.clone();this.rotationQuaternion?d.rotationQuaternion=this.rotationQuaternion.clone():d.rotation=this.rotation.clone();c&&c(this,d);for(const e of this.getChildTransformNodes(!0))"InstancedMesh"===e.getClassName()&&"Mesh"===d.getClassName()?e.instantiateHierarchy(d,{doNotInstantiate:b&&b.doNotInstantiate||!1,newSourcedMesh:d},c):e.instantiateHierarchy(d,b,c);return d}getClassName(){return"Mesh"}get _isMesh(){return!0}toString(a){let b=super.toString(a);if(b+=", n vertices: "+
this.getTotalVertices(),b+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(var c=0;c<this.animations.length;c++)b+=", animation[0]: "+this.animations[c].toString(a);a&&(this._geometry?(a=this.getIndices(),(c=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind))&&a&&(b+=", flat shading: "+(c.length/3===a.length?"YES":"NO"))):b+=", flat shading: UNKNOWN");return b}_unBindEffect(){super._unBindEffect();for(const a of this.instances)a._unBindEffect()}get hasLODLevels(){return 0<
this._internalMeshDataInfo._LODLevels.length}getLODLevels(){return this._internalMeshDataInfo._LODLevels}_sortLODLevels(){const a=this._internalMeshDataInfo._useLODScreenCoverage?-1:1;this._internalMeshDataInfo._LODLevels.sort((b,c)=>b.distanceOrScreenCoverage<c.distanceOrScreenCoverage?a:b.distanceOrScreenCoverage>c.distanceOrScreenCoverage?-a:0)}addLODLevel(a,b){if(b&&b._masterMesh)return O$$module$libs$world_onscreen.Warn("You cannot use a mesh as LOD level twice"),this;a=new Kn$$module$libs$world_onscreen(a,
b);return this._internalMeshDataInfo._LODLevels.push(a),b&&(b._masterMesh=this),this._sortLODLevels(),this}getLODLevelAtDistance(a){const b=this._internalMeshDataInfo;for(let c=0;c<b._LODLevels.length;c++){const d=b._LODLevels[c];if(d.distanceOrScreenCoverage===a)return d.mesh}return null}removeLODLevel(a){const b=this._internalMeshDataInfo;for(let c=0;c<b._LODLevels.length;c++)b._LODLevels[c].mesh===a&&(b._LODLevels.splice(c,1),a&&(a._masterMesh=null));return this._sortLODLevels(),this}getLOD(a,
b){const c=this._internalMeshDataInfo;if(!c._LODLevels||0===c._LODLevels.length)return this;var d=b||this.getBoundingInfo().boundingSphere;const e=a.mode===q$$module$libs$world_onscreen.ORTHOGRAPHIC_CAMERA?a.minZ:d.centerWorld.subtract(a.globalPosition).length();b=e;let g=1;c._useLODScreenCoverage&&(b=a.screenArea,a=d.radiusWorld*a.minZ/e,a=a*a*Math.PI,b=a/b,g=-1);if(g*c._LODLevels[c._LODLevels.length-1].distanceOrScreenCoverage>g*b)return this.onLODLevelSelection&&this.onLODLevelSelection(b,this,
this),this;for(a=0;a<c._LODLevels.length;a++)if(d=c._LODLevels[a],g*d.distanceOrScreenCoverage<g*b){if(d.mesh){if(4===d.mesh.delayLoadState)return d.mesh._checkDelayState(),this;if(2===d.mesh.delayLoadState)return this;d.mesh._preActivate();d.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)}return this.onLODLevelSelection&&this.onLODLevelSelection(b,this,d.mesh),d.mesh}return this.onLODLevelSelection&&this.onLODLevelSelection(b,this,this),this}get geometry(){return this._geometry}getTotalVertices(){return null===
this._geometry||void 0===this._geometry?0:this._geometry.getTotalVertices()}getVerticesData(a,b,c){var d,e;if(!this._geometry)return null;let g=null===(e=null===(d=this._userInstancedBuffersStorage)||void 0===d?void 0:d.vertexBuffers[a])||void 0===e?void 0:e.getFloatData(this._geometry.getTotalVertices(),c||b&&1!==this._geometry.meshes.length);return g||=this._geometry.getVerticesData(a,b,c),g}getVertexBuffer(a){var b,c;return this._geometry?null!==(c=null===(b=this._userInstancedBuffersStorage)||
void 0===b?void 0:b.vertexBuffers[a])&&void 0!==c?c:this._geometry.getVertexBuffer(a):null}isVerticesDataPresent(a){var b;return this._geometry?void 0!==(null===(b=this._userInstancedBuffersStorage)||void 0===b?void 0:b.vertexBuffers[a])||this._geometry.isVerticesDataPresent(a):this._delayInfo?-1!==this._delayInfo.indexOf(a):!1}isVertexBufferUpdatable(a){var b,c;return this._geometry?(null===(c=null===(b=this._userInstancedBuffersStorage)||void 0===b?void 0:b.vertexBuffers[a])||void 0===c?void 0:
c.isUpdatable())||this._geometry.isVertexBufferUpdatable(a):this._delayInfo?-1!==this._delayInfo.indexOf(a):!1}getVerticesDataKinds(){if(!this._geometry){const b=[];return this._delayInfo&&this._delayInfo.forEach(function(c){b.push(c)}),b}const a=this._geometry.getVerticesDataKinds();if(this._userInstancedBuffersStorage)for(const b in this._userInstancedBuffersStorage.vertexBuffers)a.push(b);return a}getTotalIndices(){return this._geometry?this._geometry.getTotalIndices():0}getIndices(a,b){return this._geometry?
this._geometry.getIndices(a,b):[]}get isBlocked(){return null!==this._masterMesh&&void 0!==this._masterMesh}isReady(a=!1,b=!1){var c,d,e,g,n,t;if(2===this.delayLoadState||!super.isReady(a))return!1;if(!this.subMeshes||0===this.subMeshes.length||!a)return!0;a=this.getEngine();var w=this.getScene();b=b||a.getCaps().instancedArrays&&(0<this.instances.length||this.hasThinInstances);this.computeWorldMatrix();if(w=this.material||w.defaultMaterial)if(w._storeEffectOnSubMeshes)for(var z of this.subMeshes){if(w=
z.getMaterial())if(w._storeEffectOnSubMeshes){if(!w.isReadyForSubMesh(this,z,b))return!1}else if(!w.isReady(this,b))return!1}else if(!w.isReady(this,b))return!1;z=a.currentRenderPassId;for(const H of this.lightSources)if(w=H.getShadowGenerators()){w=w.values();for(var C=w.next();!0!==C.done;C=w.next())if((C=C.value)&&(null===(c=C.getShadowMap())||void 0===c||!c.renderList||null!==(d=C.getShadowMap())&&void 0!==d&&d.renderList&&-1!==(null===(g=null===(e=C.getShadowMap())||void 0===e?void 0:e.renderList)||
void 0===g?void 0:g.indexOf(this)))){C.getShadowMap()&&(a.currentRenderPassId=C.getShadowMap().renderPassId);for(const M of this.subMeshes)if(!C.isReady(M,b,null!==(t=null===(n=M.getMaterial())||void 0===n?void 0:n.needAlphaBlendingForMesh(this))&&void 0!==t?t:!1))return a.currentRenderPassId=z,!1;a.currentRenderPassId=z}}for(const H of this._internalMeshDataInfo._LODLevels)if(H.mesh&&!H.mesh.isReady(b))return!1;return!0}get areNormalsFrozen(){return this._internalMeshDataInfo._areNormalsFrozen}freezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=
!0,this}unfreezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!1,this}set overridenInstanceCount(a){this._instanceDataStorage.overridenInstanceCount=a}_preActivate(){const a=this._internalMeshDataInfo,b=this.getScene().getRenderId();return a._preActivateId===b?this:(a._preActivateId=b,this._instanceDataStorage.visibleInstances=null,this)}_preActivateForIntermediateRendering(a){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=
a),this}_registerInstanceForRenderId(a,b){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:b,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[b]||(void 0!==this._instanceDataStorage.previousRenderId&&this._instanceDataStorage.isFrozen&&(this._instanceDataStorage.visibleInstances[this._instanceDataStorage.previousRenderId]=null),this._instanceDataStorage.previousRenderId=b,this._instanceDataStorage.visibleInstances[b]=
[]),this._instanceDataStorage.visibleInstances[b].push(a),this}_afterComputeWorldMatrix(){super._afterComputeWorldMatrix();this.hasThinInstances&&(this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1))}_postActivate(){this.edgesShareWithInstances&&this.edgesRenderer&&this.edgesRenderer.isEnabled&&this._renderingGroup&&(this._renderingGroup._edgesRenderers.pushNoDuplicate(this.edgesRenderer),this.edgesRenderer.customInstances.push(this.getWorldMatrix()))}refreshBoundingInfo(a=!1,b=!1){if(this.hasBoundingInfo&&
this.getBoundingInfo().isLocked)return this;const c=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getPositionData(a,b),c),this}_createGlobalSubMesh(a){const b=this.getTotalVertices();if(!b||!this.getIndices())return null;if(this.subMeshes&&0<this.subMeshes.length){var c=this.getIndices();if(!c)return null;c=c.length;let d=!1;if(a)d=!0;else for(const e of this.subMeshes){if(e.indexStart+e.indexCount>c){d=!0;break}if(e.verticesStart+e.verticesCount>b){d=!0;break}}if(!d)return this.subMeshes[0]}return this.releaseSubMeshes(),
new Et$$module$libs$world_onscreen(0,0,b,0,this.getTotalIndices(),this)}subdivide(a){if(!(1>a)){for(var b=this.getTotalIndices(),c=b/a|0,d=0;0!==c%3;)c++;this.releaseSubMeshes();for(let e=0;e<a&&!(d>=b);e++)Et$$module$libs$world_onscreen.CreateFromIndices(0,d,e===a-1?b-d:c,this),d+=c;this.synchronizeInstances()}}setVerticesData(a,b,c=!1,d){this._geometry?this._geometry.setVerticesData(a,b,c,d):(d=new J$$module$libs$world_onscreen,d.set(b,a),a=this.getScene(),new at$$module$libs$world_onscreen(at$$module$libs$world_onscreen.RandomId(),
a,d,c,this));return this}removeVerticesData(a){this._geometry&&this._geometry.removeVerticesData(a)}markVerticesDataAsUpdatable(a,b=!0){const c=this.getVertexBuffer(a);!c||c.isUpdatable()===b||this.setVerticesData(a,this.getVerticesData(a),b)}setVerticesBuffer(a,b=!0){return this._geometry||(this._geometry=at$$module$libs$world_onscreen.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(a,null,b),this}updateVerticesData(a,b,c,d){return this._geometry?(d?(this.makeGeometryUnique(),this.updateVerticesData(a,
b,c,!1)):this._geometry.updateVerticesData(a,b,c),this):this}updateMeshPositions(a,b=!0){const c=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);if(!c)return this;if(a(c),this.updateVerticesData(g$$module$libs$world_onscreen.PositionKind,c,!1,!1),b){a=this.getIndices();b=this.getVerticesData(g$$module$libs$world_onscreen.NormalKind);if(!b)return this;J$$module$libs$world_onscreen.ComputeNormals(c,a,b);this.updateVerticesData(g$$module$libs$world_onscreen.NormalKind,b,!1,!1)}return this}makeGeometryUnique(){if(!this._geometry||
1===this._geometry.meshes.length)return this;const a=this._geometry,b=this._geometry.copy(at$$module$libs$world_onscreen.RandomId());return a.releaseForMesh(this,!0),b.applyToMesh(this),this}setIndices(a,b=null,c=!1){this._geometry?this._geometry.setIndices(a,b,c):(b=new J$$module$libs$world_onscreen,b.indices=a,a=this.getScene(),new at$$module$libs$world_onscreen(at$$module$libs$world_onscreen.RandomId(),a,b,c,this));return this}updateIndices(a,b,c=!1){return this._geometry?(this._geometry.updateIndices(a,
b,c),this):this}toLeftHanded(){return this._geometry?(this._geometry.toLeftHanded(),this):this}_bind(a,b,c){if(!this._geometry)return this;const d=this.getScene().getEngine();this.morphTargetManager&&this.morphTargetManager.isUsingTextureForTargets&&this.morphTargetManager._bind(b);if(this._unIndexed)a=null;else switch(c){case P$$module$libs$world_onscreen.PointFillMode:a=null;break;case P$$module$libs$world_onscreen.WireFrameFillMode:a=a._getLinesIndexBuffer(this.getIndices(),d);break;default:case P$$module$libs$world_onscreen.TriangleFillMode:a=
this._geometry.getIndexBuffer()}return!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(b,a):this._geometry._bind(b,a,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),this}_draw(a,b,c){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeDrawObservable&&this._internalMeshDataInfo._onBeforeDrawObservable.notifyObservers(this);
const d=this.getScene().getEngine();return this._unIndexed||b==P$$module$libs$world_onscreen.PointFillMode?d.drawArraysType(b,a.verticesStart,a.verticesCount,this.forcedInstanceCount||c):b==P$$module$libs$world_onscreen.WireFrameFillMode?d.drawElementsType(b,0,a._linesIndexCount,this.forcedInstanceCount||c):d.drawElementsType(b,a.indexStart,a.indexCount,this.forcedInstanceCount||c),this}registerBeforeRender(a){return this.onBeforeRenderObservable.add(a),this}unregisterBeforeRender(a){return this.onBeforeRenderObservable.removeCallback(a),
this}registerAfterRender(a){return this.onAfterRenderObservable.add(a),this}unregisterAfterRender(a){return this.onAfterRenderObservable.removeCallback(a),this}_getInstancesRenderList(a,b=!1){if(this._instanceDataStorage.isFrozen){if(b)return this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.hardwareInstancedRendering[a]=!1,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.renderSelf[a]=!0,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode;if(this._instanceDataStorage.previousBatch)return this._instanceDataStorage.previousBatch}var c=
this.getScene(),d=c._isInIntermediateRendering(),e=d?this._internalAbstractMeshDataInfo._onlyForInstancesIntermediate:this._internalAbstractMeshDataInfo._onlyForInstances;const g=this._instanceDataStorage.batchCache;if(g.mustReturn=!1,g.renderSelf[a]=b||!e&&this.isEnabled()&&this.isVisible,g.visibleInstances[a]=null,this._instanceDataStorage.visibleInstances&&!b)e=this._instanceDataStorage.visibleInstances,c=c.getRenderId(),d=d?e.intermediateDefaultRenderId:e.defaultRenderId,g.visibleInstances[a]=
e[c],!g.visibleInstances[a]&&d&&(g.visibleInstances[a]=e[d]);return g.hardwareInstancedRendering[a]=!b&&this._instanceDataStorage.hardwareInstancedRendering&&null!==g.visibleInstances[a]&&void 0!==g.visibleInstances[a],this._instanceDataStorage.previousBatch=g,g}_renderWithInstances(a,b,c,d,e){var g;const n=c.visibleInstances[a._id];var t=n?n.length:0;const w=this._instanceDataStorage;var z=w.instancesBufferSize;let C=w.instancesBuffer,H=w.instancesPreviousBuffer;for(var M=64*(t+1);w.instancesBufferSize<
M;)w.instancesBufferSize*=2;w.instancesData&&z==w.instancesBufferSize||(w.instancesData=new Float32Array(w.instancesBufferSize/4));(this._scene.needsPreviousWorldMatrices&&!w.instancesPreviousData||z!=w.instancesBufferSize)&&(w.instancesPreviousData=new Float32Array(w.instancesBufferSize/4));let L=M=0;c=c.renderSelf[a._id];z=!C||z!==w.instancesBufferSize||this._scene.needsPreviousWorldMatrices&&!w.instancesPreviousBuffer;if(this._instanceDataStorage.manualUpdate||w.isFrozen&&!z)L=(c?1:0)+t;else if(t=
this.getWorldMatrix(),c&&(this._scene.needsPreviousWorldMatrices&&(w.masterMeshPreviousWorldMatrix?(w.masterMeshPreviousWorldMatrix.copyToArray(w.instancesPreviousData,M),w.masterMeshPreviousWorldMatrix.copyFrom(t)):(w.masterMeshPreviousWorldMatrix=t.clone(),w.masterMeshPreviousWorldMatrix.copyToArray(w.instancesPreviousData,M))),t.copyToArray(w.instancesData,M),M+=16,L++),n){if(W$$module$libs$world_onscreen.INSTANCEDMESH_SORT_TRANSPARENT&&this._scene.activeCamera&&null!==(g=a.getMaterial())&&void 0!==
g&&g.needAlphaBlendingForMesh(a.getRenderingMesh())){g=this._scene.activeCamera.globalPosition;for(t=0;t<n.length;t++){var O=n[t];O._distanceToCamera=p$$module$libs$world_onscreen.Distance(O.getBoundingInfo().boundingSphere.centerWorld,g)}n.sort((S,T)=>S._distanceToCamera>T._distanceToCamera?-1:S._distanceToCamera<T._distanceToCamera?1:0)}for(g=0;g<n.length;g++)t=n[g],O=t.getWorldMatrix(),O.copyToArray(w.instancesData,M),this._scene.needsPreviousWorldMatrices&&(t._previousWorldMatrix?(t._previousWorldMatrix.copyToArray(w.instancesPreviousData,
M),t._previousWorldMatrix.copyFrom(O)):(t._previousWorldMatrix=O.clone(),t._previousWorldMatrix.copyToArray(w.instancesPreviousData,M))),M+=16,L++}return z?(C&&C.dispose(),H&&H.dispose(),C=new es$$module$libs$world_onscreen(e,w.instancesData,!0,16,!1,!0),w.instancesBuffer=C,this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this._userInstancedBuffersStorage.vertexBuffers.world0=
C.createVertexBuffer("world0",0,4),this._userInstancedBuffersStorage.vertexBuffers.world1=C.createVertexBuffer("world1",4,4),this._userInstancedBuffersStorage.vertexBuffers.world2=C.createVertexBuffer("world2",8,4),this._userInstancedBuffersStorage.vertexBuffers.world3=C.createVertexBuffer("world3",12,4),this._scene.needsPreviousWorldMatrices&&(H=new es$$module$libs$world_onscreen(e,w.instancesPreviousData,!0,16,!1,!0),w.instancesPreviousBuffer=H,this._userInstancedBuffersStorage.vertexBuffers.previousWorld0=
H.createVertexBuffer("previousWorld0",0,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld1=H.createVertexBuffer("previousWorld1",4,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld2=H.createVertexBuffer("previousWorld2",8,4),this._userInstancedBuffersStorage.vertexBuffers.previousWorld3=H.createVertexBuffer("previousWorld3",12,4)),this._invalidateInstanceVertexArrayObject()):(!this._instanceDataStorage.isFrozen||this._instanceDataStorage.forceMatrixUpdates)&&(C.updateDirectly(w.instancesData,
0,L),this._scene.needsPreviousWorldMatrices&&(!this._instanceDataStorage.manualUpdate||this._instanceDataStorage.previousManualUpdate)&&H.updateDirectly(w.instancesPreviousData,0,L)),this._processInstancedBuffers(n,c),this.getScene()._activeIndices.addCount(a.indexCount*L,!1),e._currentDrawContext&&(e._currentDrawContext.useInstancing=!0),this._bind(a,d,b),this._draw(a,b,L),this._scene.needsPreviousWorldMatrices&&!z&&this._instanceDataStorage.manualUpdate&&(!this._instanceDataStorage.isFrozen||this._instanceDataStorage.forceMatrixUpdates)&&
!this._instanceDataStorage.previousManualUpdate&&H.updateDirectly(w.instancesData,0,L),e.unbindInstanceAttributes(),this}_renderWithThinInstances(a,b,c,d){var e,g;const n=null!==(g=null===(e=this._thinInstanceDataStorage)||void 0===e?void 0:e.instancesCount)&&void 0!==g?g:0;this.getScene()._activeIndices.addCount(a.indexCount*n,!1);d._currentDrawContext&&(d._currentDrawContext.useInstancing=!0);this._bind(a,c,b);this._draw(a,b,n);this._scene.needsPreviousWorldMatrices&&!this._thinInstanceDataStorage.previousMatrixData&&
this._thinInstanceDataStorage.matrixData&&(this._thinInstanceDataStorage.previousMatrixBuffer?this._thinInstanceDataStorage.previousMatrixBuffer.updateDirectly(this._thinInstanceDataStorage.matrixData,0,n):this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",this._thinInstanceDataStorage.matrixData,!1));d.unbindInstanceAttributes()}_processInstancedBuffers(a,b){}_processRendering(a,b,c,d,e,g,n,t){const w=this.getScene();var z=w.getEngine();if(g&&
b.getRenderingMesh().hasThinInstances)return this._renderWithThinInstances(b,d,c,z),this;if(g)this._renderWithInstances(b,d,e,c,z);else{z._currentDrawContext&&(z._currentDrawContext.useInstancing=!1);c=0;e.renderSelf[b._id]&&(n&&n(!1,a.getWorldMatrix(),t),c++,this._draw(b,d,this._instanceDataStorage.overridenInstanceCount));if(a=e.visibleInstances[b._id])for(e=a.length,c+=e,g=0;g<e;g++)z=a[g].getWorldMatrix(),n&&n(!0,z,t),this._draw(b,d);w._activeIndices.addCount(b.indexCount*c,!1)}return this}_rebuild(a=
!1){if(this._instanceDataStorage.instancesBuffer&&(a&&this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null),this._userInstancedBuffersStorage){for(const b in this._userInstancedBuffersStorage.vertexBuffers){const c=this._userInstancedBuffersStorage.vertexBuffers[b];c&&(a&&c.dispose(),this._userInstancedBuffersStorage.vertexBuffers[b]=null)}this._userInstancedBuffersStorage.vertexArrayObjects&&(this._userInstancedBuffersStorage.vertexArrayObjects={})}this._internalMeshDataInfo._effectiveMaterial=
null;super._rebuild(a)}_freeze(){if(this.subMeshes){for(let a=0;a<this.subMeshes.length;a++)this._getInstancesRenderList(a);this._internalMeshDataInfo._effectiveMaterial=null;this._instanceDataStorage.isFrozen=!0}}_unFreeze(){this._instanceDataStorage.isFrozen=!1;this._instanceDataStorage.previousBatch=null}render(a,b,c){var d,e,g;const n=this.getScene();if(this._internalAbstractMeshDataInfo._isActiveIntermediate?this._internalAbstractMeshDataInfo._isActiveIntermediate=!1:this._internalAbstractMeshDataInfo._isActive=
!1,this._checkOcclusionQuery()&&!this._occlusionDataStorage.forceRenderingWhenOccluded)return this;const t=this._getInstancesRenderList(a._id,!!c);if(t.mustReturn||!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const w=n.getEngine();let z=0,C=null;this.ignoreCameraMaxZ&&n.activeCamera&&!n._isInIntermediateRendering()&&(z=n.activeCamera.maxZ,C=n.activeCamera,n.activeCamera.maxZ=0,n.updateTransformMatrix(!0));this._internalMeshDataInfo._onBeforeRenderObservable&&
this._internalMeshDataInfo._onBeforeRenderObservable.notifyObservers(this);var H=a.getRenderingMesh();H=t.hardwareInstancedRendering[a._id]||H.hasThinInstances||!!this._userInstancedBuffersStorage&&!a.getMesh()._internalAbstractMeshDataInfo._actAsRegularMesh;const M=this._instanceDataStorage,L=a.getMaterial();if(!L)return C&&(C.maxZ=z,n.updateTransformMatrix(!0)),this;if(!M.isFrozen||!this._internalMeshDataInfo._effectiveMaterial||this._internalMeshDataInfo._effectiveMaterial!==L){if(L._storeEffectOnSubMeshes){if(!L.isReadyForSubMesh(this,
a,H))return C&&(C.maxZ=z,n.updateTransformMatrix(!0)),this}else if(!L.isReady(this,H))return C&&(C.maxZ=z,n.updateTransformMatrix(!0)),this;this._internalMeshDataInfo._effectiveMaterial=L}else if(L._storeEffectOnSubMeshes&&(null===(d=a.effect)||void 0===d||!d._wasPreviouslyReady)||!(L._storeEffectOnSubMeshes||null!==(e=L.getEffect())&&void 0!==e&&e._wasPreviouslyReady))return C&&(C.maxZ=z,n.updateTransformMatrix(!0)),this;b&&w.setAlphaMode(this._internalMeshDataInfo._effectiveMaterial.alphaMode);
var O;this._internalMeshDataInfo._effectiveMaterial._storeEffectOnSubMeshes?O=a._drawWrapper:O=this._internalMeshDataInfo._effectiveMaterial._getDrawWrapper();b=null!==(g=null==O?void 0:O.effect)&&void 0!==g?g:null;for(var S of n._beforeRenderingMeshStage)S.action(this,a,t,b);if(!O||!b)return C&&(C.maxZ=z,n.updateTransformMatrix(!0)),this;c=c||this;M.isFrozen||!this._internalMeshDataInfo._effectiveMaterial.backFaceCulling&&null===this.overrideMaterialSideOrientation?g=M.sideOrientation:(S=c._getWorldMatrixDeterminant(),
g=this.overrideMaterialSideOrientation,null==g&&(g=this._internalMeshDataInfo._effectiveMaterial.sideOrientation),0>S&&(g=g===P$$module$libs$world_onscreen.ClockWiseSideOrientation?P$$module$libs$world_onscreen.CounterClockWiseSideOrientation:P$$module$libs$world_onscreen.ClockWiseSideOrientation),M.sideOrientation=g);O=this._internalMeshDataInfo._effectiveMaterial._preBind(O,g);this._internalMeshDataInfo._effectiveMaterial.forceDepthWrite&&w.setDepthWrite(!0);g=n.forcePointsCloud?P$$module$libs$world_onscreen.PointFillMode:
n.forceWireframe?P$$module$libs$world_onscreen.WireFrameFillMode:this._internalMeshDataInfo._effectiveMaterial.fillMode;this._internalMeshDataInfo._onBeforeBindObservable&&this._internalMeshDataInfo._onBeforeBindObservable.notifyObservers(this);H||this._bind(a,b,g);S=this._internalMeshDataInfo._effectiveMaterial;c=c.getWorldMatrix();S._storeEffectOnSubMeshes?S.bindForSubMesh(c,this,a):S.bind(c,this);!S.backFaceCulling&&S.separateCullingPass&&(w.setState(!0,S.zOffset,!1,!O,S.cullBackFaces,S.stencil,
S.zOffsetUnits),this._processRendering(this,a,b,g,t,H,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),w.setState(!0,S.zOffset,!1,O,S.cullBackFaces,S.stencil,S.zOffsetUnits),this._internalMeshDataInfo._onBetweenPassObservable&&this._internalMeshDataInfo._onBetweenPassObservable.notifyObservers(a));this._processRendering(this,a,b,g,t,H,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial);this._internalMeshDataInfo._effectiveMaterial.unbind();for(const T of n._afterRenderingMeshStage)T.action(this,
a,t,b);return this._internalMeshDataInfo._onAfterRenderObservable&&this._internalMeshDataInfo._onAfterRenderObservable.notifyObservers(this),C&&(C.maxZ=z,n.updateTransformMatrix(!0)),n.performancePriority===Ct$$module$libs$world_onscreen.Aggressive&&!M.isFrozen&&this._freeze(),this}cleanMatrixWeights(){this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsKind)&&(this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsExtraKind)?this._normalizeSkinWeightsAndExtra():
this._normalizeSkinFourWeights())}_normalizeSkinFourWeights(){const a=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind),b=a.length;for(let d=0;d<b;d+=4){var c=a[d]+a[d+1]+a[d+2]+a[d+3];0===c?a[d]=1:(c=1/c,a[d]*=c,a[d+1]*=c,a[d+2]*=c,a[d+3]*=c)}this.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,a)}_normalizeSkinWeightsAndExtra(){const a=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind),b=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind),
c=b.length;for(let e=0;e<c;e+=4){var d=b[e]+b[e+1]+b[e+2]+b[e+3];(d+=a[e]+a[e+1]+a[e+2]+a[e+3],0===d)?b[e]=1:(d=1/d,b[e]*=d,b[e+1]*=d,b[e+2]*=d,b[e+3]*=d,a[e]*=d,a[e+1]*=d,a[e+2]*=d,a[e+3]*=d)}this.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,b);this.setVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind,a)}validateSkinning(){var a=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind),b=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind);
if(null===b||null==this.skeleton)return{skinned:!1,valid:!0,report:"not skinned"};const c=b.length;let d=0,e=0,g=0,n=0;const t=null===a?4:8,w=[];for(var z=0;z<=t;z++)w[z]=0;for(z=0;z<c;z+=4){var C=b[z],H=C,M=0===H?0:1;for(var L=1;L<t;L++){const O=4>L?b[z+L]:a[z+L-4];O>C&&d++;0!==O&&M++;H+=O;C=O}if(w[M]++,M>g&&(g=M),0===H)e++;else{C=1/H;H=0;for(M=0;M<t;M++)4>M?H+=Math.abs(b[z+M]-b[z+M]*C):H+=Math.abs(a[z+M-4]-a[z+M-4]*C);.001<H&&n++}}a=this.skeleton.bones.length;b=this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind);
z=this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind);C=0;for(H=0;H<c;H+=4)for(M=0;M<t;M++)L=4>M?b[H+M]:z[H+M-4],(L>=a||0>L)&&C++;return{skinned:!0,valid:0===e&&0===n&&0===C,report:"Number of Weights = "+c/4+"\nMaximum influences = "+g+"\nMissing Weights = "+e+"\nNot Sorted = "+d+"\nNot Normalized = "+n+"\nWeightCounts = ["+w+"]\nNumber of bones = "+a+"\nBad Bone Indices = "+C}}_checkDelayState(){const a=this.getScene();return this._geometry?this._geometry.load(a):4===this.delayLoadState&&
(this.delayLoadState=2,this._queueLoad(a)),this}_queueLoad(a){a.addPendingData(this);const b=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata");return X$$module$libs$world_onscreen.LoadFile(this.delayLoadingFile,c=>{c instanceof ArrayBuffer?this._delayLoadingFunction(c,this):this._delayLoadingFunction(JSON.parse(c),this);this.instances.forEach(d=>{d.refreshBoundingInfo();d._syncSubMeshes()});this.delayLoadState=1;a.removePendingData(this)},()=>{},a.offlineProvider,b),this}isInFrustum(a){return 2!==
this.delayLoadState&&super.isInFrustum(a)?(this._checkDelayState(),!0):!1}setMaterialById(a){var b=this.getScene().materials;let c;for(c=b.length-1;-1<c;c--)if(b[c].id===a)return this.material=b[c],this;b=this.getScene().multiMaterials;for(c=b.length-1;-1<c;c--)if(b[c].id===a)return this.material=b[c],this;return this}getAnimatables(){const a=[];return this.material&&a.push(this.material),this.skeleton&&a.push(this.skeleton),a}bakeTransformIntoVertices(a){if(!this.isVerticesDataPresent(g$$module$libs$world_onscreen.PositionKind))return this;
const b=this.subMeshes.splice(0);this._resetPointsArrayCache();let c=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);const d=p$$module$libs$world_onscreen.Zero();let e;for(e=0;e<c.length;e+=3)p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(c[e],c[e+1],c[e+2],a,d).toArray(c,e);if(this.setVerticesData(g$$module$libs$world_onscreen.PositionKind,c,this.getVertexBuffer(g$$module$libs$world_onscreen.PositionKind).isUpdatable()),this.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)){c=
this.getVerticesData(g$$module$libs$world_onscreen.NormalKind);for(e=0;e<c.length;e+=3)p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(c[e],c[e+1],c[e+2],a,d).normalize().toArray(c,e);this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,c,this.getVertexBuffer(g$$module$libs$world_onscreen.NormalKind).isUpdatable())}return 0>a.determinant()&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=b,this}bakeCurrentTransformIntoVertices(a=!0){return this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),
this.resetLocalMatrix(a),this}get _positions(){return this._internalAbstractMeshDataInfo._positions?this._internalAbstractMeshDataInfo._positions:this._geometry?this._geometry._positions:null}_resetPointsArrayCache(){return this._geometry&&this._geometry._resetPointsArrayCache(),this}_generatePointsArray(){return this._geometry?this._geometry._generatePointsArray():!1}clone(a="",b=null,c,d=!0){return new W$$module$libs$world_onscreen(a,this.getScene(),b,this,c,d)}dispose(a,b=!1){this.morphTargetManager=
null;this._geometry&&this._geometry.releaseForMesh(this,!0);const c=this._internalMeshDataInfo;if(c._onBeforeDrawObservable&&c._onBeforeDrawObservable.clear(),c._onBeforeBindObservable&&c._onBeforeBindObservable.clear(),c._onBeforeRenderObservable&&c._onBeforeRenderObservable.clear(),c._onAfterRenderObservable&&c._onAfterRenderObservable.clear(),c._onBetweenPassObservable&&c._onBetweenPassObservable.clear(),this._scene.useClonedMeshMap){if(c.meshMap)for(var d in c.meshMap){var e=c.meshMap[d];e&&(e._internalMeshDataInfo._source=
null,c.meshMap[d]=void 0)}c._source&&c._source._internalMeshDataInfo.meshMap&&(c._source._internalMeshDataInfo.meshMap[this.uniqueId]=void 0)}else{d=this.getScene().meshes;for(e of d)d=e,d._internalMeshDataInfo&&d._internalMeshDataInfo._source&&d._internalMeshDataInfo._source===this&&(d._internalMeshDataInfo._source=null)}c._source=null;this._disposeInstanceSpecificData();this._disposeThinInstanceSpecificData();this._internalMeshDataInfo._checkReadinessObserver&&this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver);
super.dispose(a,b)}_disposeInstanceSpecificData(){}_disposeThinInstanceSpecificData(){}_invalidateInstanceVertexArrayObject(){}applyDisplacementMap(a,b,c,d,e,g,n=!1){const t=this.getScene();return X$$module$libs$world_onscreen.LoadImage(a,w=>{const z=w.width,C=w.height,H=this.getEngine().createCanvas(z,C).getContext("2d");H.drawImage(w,0,0);w=H.getImageData(0,0,z,C).data;this.applyDisplacementMapFromBuffer(w,z,C,b,c,e,g,n);d&&d(this)},()=>{},t.offlineProvider),this}applyDisplacementMapFromBuffer(a,
b,c,d,e,g,n,t=!1){if(!this.isVerticesDataPresent(g$$module$libs$world_onscreen.PositionKind)||!this.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)||!this.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind))return O$$module$libs$world_onscreen.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;const w=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind,!0,!0),z=this.getVerticesData(g$$module$libs$world_onscreen.NormalKind),
C=this.getVerticesData(g$$module$libs$world_onscreen.UVKind);let H=p$$module$libs$world_onscreen.Zero();const M=p$$module$libs$world_onscreen.Zero(),L=Te$$module$libs$world_onscreen.Zero();g=g||Te$$module$libs$world_onscreen.Zero();n=n||new Te$$module$libs$world_onscreen(1,1);for(let S=0;S<w.length;S+=3){p$$module$libs$world_onscreen.FromArrayToRef(w,S,H);p$$module$libs$world_onscreen.FromArrayToRef(z,S,M);Te$$module$libs$world_onscreen.FromArrayToRef(C,S/3*2,L);var O=4*((Math.abs(L.x*n.x+g.x%1)*
(b-1)%b|0)+(Math.abs(L.y*n.y+g.y%1)*(c-1)%c|0)*b);O=a[O]/255*.3+a[O+1]/255*.59+a[O+2]/255*.11;M.normalize();M.scaleInPlace(d+(e-d)*O);H=H.add(M);H.toArray(w,S)}return J$$module$libs$world_onscreen.ComputeNormals(w,this.getIndices(),z),t?(this.setVerticesData(g$$module$libs$world_onscreen.PositionKind,w),this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,z),this.setVerticesData(g$$module$libs$world_onscreen.UVKind,C)):(this.updateVerticesData(g$$module$libs$world_onscreen.PositionKind,w),
this.updateVerticesData(g$$module$libs$world_onscreen.NormalKind,z)),this}convertToFlatShadedMesh(){var a=this.getVerticesDataKinds(),b={},c={};const d={};let e=!1;var g;for(g=0;g<a.length;g++){var n=a[g];var t=this.getVertexBuffer(n),w=t.getData();(w instanceof Array||w instanceof Float32Array)&&0===w.length||(n===g$$module$libs$world_onscreen.NormalKind?(e=t.isUpdatable(),a.splice(g,1),g--):(b[n]=t,c[n]=this.getVerticesData(n),d[n]=[]))}t=this.subMeshes.slice(0);w=this.getIndices();const z=this.getTotalIndices();
let C;for(C=0;C<z;C++){var H=w[C];for(g=0;g<a.length;g++)if(n=a[g],b[n]){var M=b[n].getStrideSize();for(let O=0;O<M;O++)d[n].push(c[n][H*M+O])}}c=[];g=d[g$$module$libs$world_onscreen.PositionKind];let L;this.getScene().useRightHandedSystem?L=1===this.overrideMaterialSideOrientation:L=0===this.overrideMaterialSideOrientation;for(C=0;C<z;C+=3)for(w[C]=C,w[C+1]=C+1,w[C+2]=C+2,M=p$$module$libs$world_onscreen.FromArray(g,3*C),n=p$$module$libs$world_onscreen.FromArray(g,3*(C+1)),H=p$$module$libs$world_onscreen.FromArray(g,
3*(C+2)),M=M.subtract(n),n=H.subtract(n),n=p$$module$libs$world_onscreen.Normalize(p$$module$libs$world_onscreen.Cross(M,n)),L&&n.scaleInPlace(-1),H=0;3>H;H++)c.push(n.x),c.push(n.y),c.push(n.z);this.setIndices(w);this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,c,e);for(g=0;g<a.length;g++)n=a[g],d[n]&&this.setVerticesData(n,d[n],b[n].isUpdatable());this.releaseSubMeshes();for(a=0;a<t.length;a++)b=t[a],Et$$module$libs$world_onscreen.AddToMesh(b.materialIndex,b.indexStart,b.indexCount,
b.indexStart,b.indexCount,this);return this.synchronizeInstances(),this}convertToUnIndexedMesh(){var a=this.getVerticesDataKinds(),b={};const c={},d={};let e,g;for(e=0;e<a.length;e++){g=a[e];var n=this.getVertexBuffer(g);b[g]=n;c[g]=b[g].getData();d[g]=[]}n=this.subMeshes.slice(0);const t=this.getIndices(),w=this.getTotalIndices();let z;for(z=0;z<w;z++){const C=t[z];for(e=0;e<a.length;e++){g=a[e];const H=b[g].getStrideSize();for(let M=0;M<H;M++)d[g].push(c[g][C*H+M])}}for(z=0;z<w;z+=3)t[z]=z,t[z+
1]=z+1,t[z+2]=z+2;this.setIndices(t);for(e=0;e<a.length;e++)g=a[e],this.setVerticesData(g,d[g],b[g].isUpdatable(),b[g].getStrideSize());this.releaseSubMeshes();for(a=0;a<n.length;a++)b=n[a],Et$$module$libs$world_onscreen.AddToMesh(b.materialIndex,b.indexStart,b.indexCount,b.indexStart,b.indexCount,this);return this._unIndexed=!0,this.synchronizeInstances(),this}flipFaces(a=!1){const b=J$$module$libs$world_onscreen.ExtractFromMesh(this);if(a&&this.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)&&
b.normals)for(a=0;a<b.normals.length;a++)b.normals[a]*=-1;if(b.indices){let c;for(a=0;a<b.indices.length;a+=3)c=b.indices[a+1],b.indices[a+1]=b.indices[a+2],b.indices[a+2]=c}return b.applyToMesh(this,this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.PositionKind)),this}increaseVertices(a=1){const b=J$$module$libs$world_onscreen.ExtractFromMesh(this),c=b.indices&&!Array.isArray(b.indices)&&Array.from?Array.from(b.indices):b.indices,d=b.positions&&!Array.isArray(b.positions)&&Array.from?Array.from(b.positions):
b.positions,e=b.uvs&&!Array.isArray(b.uvs)&&Array.from?Array.from(b.uvs):b.uvs,g=b.normals&&!Array.isArray(b.normals)&&Array.from?Array.from(b.normals):b.normals;if(c&&d){b.indices=c;b.positions=d;e&&(b.uvs=e);g&&(b.normals=g);a+=1;const z=[];for(var n=0;n<a+1;n++)z[n]=[];let C,H;n=new p$$module$libs$world_onscreen(0,0,0);const M=new p$$module$libs$world_onscreen(0,0,0),L=new Te$$module$libs$world_onscreen(0,0),O=[],S=[],T=[];var t;let P=d.length,W;e&&(W=e.length);let Z;g&&(Z=g.length);for(let ca=
0;ca<c.length;ca+=3){S[0]=c[ca];S[1]=c[ca+1];S[2]=c[ca+2];for(var w=0;3>w;w++)if(C=S[w],H=S[(w+1)%3],void 0===T[C]&&void 0===T[H]?(T[C]=[],T[H]=[]):(void 0===T[C]&&(T[C]=[]),void 0===T[H]&&(T[H]=[])),void 0===T[C][H]&&void 0===T[H][C]){T[C][H]=[];n.x=(d[3*H]-d[3*C])/a;n.y=(d[3*H+1]-d[3*C+1])/a;n.z=(d[3*H+2]-d[3*C+2])/a;g&&(M.x=(g[3*H]-g[3*C])/a,M.y=(g[3*H+1]-g[3*C+1])/a,M.z=(g[3*H+2]-g[3*C+2])/a);e&&(L.x=(e[2*H]-e[2*C])/a,L.y=(e[2*H+1]-e[2*C+1])/a);T[C][H].push(C);for(t=1;t<a;t++)T[C][H].push(d.length/
3),d[P++]=d[3*C]+t*n.x,d[P++]=d[3*C+1]+t*n.y,d[P++]=d[3*C+2]+t*n.z,g&&(g[Z++]=g[3*C]+t*M.x,g[Z++]=g[3*C+1]+t*M.y,g[Z++]=g[3*C+2]+t*M.z),e&&(e[W++]=e[2*C]+t*L.x,e[W++]=e[2*C+1]+t*L.y);T[C][H].push(H);T[H][C]=[];t=T[C][H].length;for(let ba=0;ba<t;ba++)T[H][C][ba]=T[C][H][t-1-ba]}z[0][0]=c[ca];z[1][0]=T[c[ca]][c[ca+1]][1];z[1][1]=T[c[ca]][c[ca+2]][1];for(w=2;w<a;w++)for(z[w][0]=T[c[ca]][c[ca+1]][w],z[w][w]=T[c[ca]][c[ca+2]][w],n.x=(d[3*z[w][w]]-d[3*z[w][0]])/w,n.y=(d[3*z[w][w]+1]-d[3*z[w][0]+1])/w,n.z=
(d[3*z[w][w]+2]-d[3*z[w][0]+2])/w,g&&(M.x=(g[3*z[w][w]]-g[3*z[w][0]])/w,M.y=(g[3*z[w][w]+1]-g[3*z[w][0]+1])/w,M.z=(g[3*z[w][w]+2]-g[3*z[w][0]+2])/w),e&&(L.x=(e[2*z[w][w]]-e[2*z[w][0]])/w,L.y=(e[2*z[w][w]+1]-e[2*z[w][0]+1])/w),t=1;t<w;t++)z[w][t]=d.length/3,d[P++]=d[3*z[w][0]]+t*n.x,d[P++]=d[3*z[w][0]+1]+t*n.y,d[P++]=d[3*z[w][0]+2]+t*n.z,g&&(g[Z++]=g[3*z[w][0]]+t*M.x,g[Z++]=g[3*z[w][0]+1]+t*M.y,g[Z++]=g[3*z[w][0]+2]+t*M.z),e&&(e[W++]=e[2*z[w][0]]+t*L.x,e[W++]=e[2*z[w][0]+1]+t*L.y);z[a]=T[c[ca+1]][c[ca+
2]];O.push(z[0][0],z[1][0],z[1][1]);for(w=1;w<a;w++){for(t=0;t<w;t++)O.push(z[w][t],z[w+1][t],z[w+1][t+1]),O.push(z[w][t],z[w+1][t+1],z[w][t+1]);O.push(z[w][t],z[w+1][t],z[w+1][t+1])}}b.indices=O;b.applyToMesh(this,this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.PositionKind))}else O$$module$libs$world_onscreen.Warn("Couldn't increase number of vertices : VertexData must contain at least indices and positions")}forceSharedVertices(){const a=J$$module$libs$world_onscreen.ExtractFromMesh(this),
b=a.uvs;var c=a.indices;const d=a.positions,e=a.colors,g=a.matricesIndices,n=a.matricesWeights,t=a.matricesIndicesExtra,w=a.matricesWeightsExtra;if(void 0===c||void 0===d||null===c||null===d)O$$module$libs$world_onscreen.Warn("VertexData contains empty entries");else{const H=[],M=[],L=[],O=[],S=[],T=[],P=[],W=[];let Z,ca=0;const ba={};let la,ea;for(let oa=0;oa<c.length;oa+=3){ea=[c[oa],c[oa+1],c[oa+2]];Z=[];for(var z=0;3>z;z++){Z[z]="";for(var C=0;3>C;C++)1E-8>Math.abs(d[3*ea[z]+C])&&(d[3*ea[z]+C]=
0),Z[z]+=d[3*ea[z]+C]+"|"}if(Z[0]!=Z[1]&&Z[0]!=Z[2]&&Z[1]!=Z[2])for(z=0;3>z;z++){if(la=ba[Z[z]],void 0===la){ba[Z[z]]=ca;la=ca++;for(C=0;3>C;C++)H.push(d[3*ea[z]+C]);if(null!=e)for(C=0;4>C;C++)O.push(e[4*ea[z]+C]);if(null!=b)for(C=0;2>C;C++)L.push(b[2*ea[z]+C]);if(null!=g)for(C=0;4>C;C++)S.push(g[4*ea[z]+C]);if(null!=n)for(C=0;4>C;C++)T.push(n[4*ea[z]+C]);if(null!=t)for(C=0;4>C;C++)P.push(t[4*ea[z]+C]);if(null!=w)for(C=0;4>C;C++)W.push(w[4*ea[z]+C])}M.push(la)}}c=[];J$$module$libs$world_onscreen.ComputeNormals(H,
M,c);a.positions=H;a.indices=M;a.normals=c;null!=b&&(a.uvs=L);null!=e&&(a.colors=O);null!=g&&(a.matricesIndices=S);null!=n&&(a.matricesWeights=T);null!=t&&(a.matricesIndicesExtra=P);null!=n&&(a.matricesWeightsExtra=W);a.applyToMesh(this,this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.PositionKind))}}static _instancedMeshFactory(a,b){throw $$$module$libs$world_onscreen("InstancedMesh");}static _PhysicsImpostorParser(a,b,c){throw $$$module$libs$world_onscreen("PhysicsImpostor");}createInstance(a){return W$$module$libs$world_onscreen._instancedMeshFactory(a,
this)}synchronizeInstances(){for(let a=0;a<this.instances.length;a++)this.instances[a]._syncSubMeshes();return this}optimizeIndices(a){const b=this.getIndices(),c=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);if(!c||!b)return this;const d=[];for(let g=0;g<c.length;g+=3)d.push(p$$module$libs$world_onscreen.FromArray(c,g));const e=[];return Ji$$module$libs$world_onscreen.SyncAsyncForLoop(d.length,40,g=>{g=d.length-1-g;const n=d[g];for(let t=0;t<g;++t)if(n.equals(d[t])){e[g]=t;break}},
()=>{for(var g=0;g<b.length;++g)b[g]=e[b[g]]||b[g];g=this.subMeshes.slice(0);this.setIndices(b);this.subMeshes=g;a&&a(this)}),this}serialize(a={}){a.name=this.name;a.id=this.id;a.uniqueId=this.uniqueId;a.type=this.getClassName();ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.HasTags(this)&&(a.tags=ge$$module$libs$world_onscreen.GetTags(this));a.position=this.position.asArray();this.rotationQuaternion?a.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(a.rotation=
this.rotation.asArray());a.scaling=this.scaling.asArray();this._postMultiplyPivotMatrix?a.pivotMatrix=this.getPivotMatrix().asArray():a.localMatrix=this.getPivotMatrix().asArray();a.isEnabled=this.isEnabled(!1);a.isVisible=this.isVisible;a.infiniteDistance=this.infiniteDistance;a.pickable=this.isPickable;a.receiveShadows=this.receiveShadows;a.billboardMode=this.billboardMode;a.visibility=this.visibility;a.checkCollisions=this.checkCollisions;a.isBlocker=this.isBlocker;a.overrideMaterialSideOrientation=
this.overrideMaterialSideOrientation;this.parent&&this.parent._serializeAsParent(a);a.isUnIndexed=this.isUnIndexed;var b=this._geometry;if(b&&this.subMeshes)for(a.geometryUniqueId=b.uniqueId,a.geometryId=b.id,a.subMeshes=[],b=0;b<this.subMeshes.length;b++){var c=this.subMeshes[b];a.subMeshes.push({materialIndex:c.materialIndex,verticesStart:c.verticesStart,verticesCount:c.verticesCount,indexStart:c.indexStart,indexCount:c.indexCount})}(this.material?this.material.doNotSerialize||(a.materialUniqueId=
this.material.uniqueId,a.materialId=this.material.id):(this.material=null,a.materialUniqueId=this._scene.defaultMaterial.uniqueId,a.materialId=this._scene.defaultMaterial.id),this.morphTargetManager&&(a.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(a.skeletonId=this.skeleton.id,a.numBoneInfluencers=this.numBoneInfluencers),this.getScene()._getComponent(Z$$module$libs$world_onscreen.NAME_PHYSICSENGINE))&&(b=this.getPhysicsImpostor())&&(a.physicsMass=b.getParam("mass"),a.physicsFriction=
b.getParam("friction"),a.physicsRestitution=b.getParam("mass"),a.physicsImpostor=b.type);this.metadata&&(a.metadata=this.metadata);a.instances=[];for(b=0;b<this.instances.length;b++){c=this.instances[b];if(c.doNotSerialize)continue;const d={name:c.name,id:c.id,isEnabled:c.isEnabled(!1),isVisible:c.isVisible,isPickable:c.isPickable,checkCollisions:c.checkCollisions,position:c.position.asArray(),scaling:c.scaling.asArray()};if(c.parent&&c.parent._serializeAsParent(d),c.rotationQuaternion?d.rotationQuaternion=
c.rotationQuaternion.asArray():c.rotation&&(d.rotation=c.rotation.asArray()),this.getScene()._getComponent(Z$$module$libs$world_onscreen.NAME_PHYSICSENGINE)){const e=c.getPhysicsImpostor();e&&(d.physicsMass=e.getParam("mass"),d.physicsFriction=e.getParam("friction"),d.physicsRestitution=e.getParam("mass"),d.physicsImpostor=e.type)}c.metadata&&(d.metadata=c.metadata);a.instances.push(d);ae$$module$libs$world_onscreen.AppendSerializedAnimations(c,d);d.ranges=c.serializeAnimationRanges()}if(this._thinInstanceDataStorage.instancesCount&&
this._thinInstanceDataStorage.matrixData&&(a.thinInstances={instancesCount:this._thinInstanceDataStorage.instancesCount,matrixData:Array.from(this._thinInstanceDataStorage.matrixData),matrixBufferSize:this._thinInstanceDataStorage.matrixBufferSize,enablePicking:this.thinInstanceEnablePicking},this._userThinInstanceBuffersStorage)){b={data:{},sizes:{},strides:{}};for(const d in this._userThinInstanceBuffersStorage.data)b.data[d]=Array.from(this._userThinInstanceBuffersStorage.data[d]),b.sizes[d]=this._userThinInstanceBuffersStorage.sizes[d],
b.strides[d]=this._userThinInstanceBuffersStorage.strides[d];a.thinInstances.userThinInstance=b}return ae$$module$libs$world_onscreen.AppendSerializedAnimations(this,a),a.ranges=this.serializeAnimationRanges(),a.layerMask=this.layerMask,a.alphaIndex=this.alphaIndex,a.hasVertexAlpha=this.hasVertexAlpha,a.overlayAlpha=this.overlayAlpha,a.overlayColor=this.overlayColor.asArray(),a.renderOverlay=this.renderOverlay,a.applyFog=this.applyFog,this.actionManager&&(a.actions=this.actionManager.serialize(this.name)),
a}_syncGeometryWithMorphTargetManager(){if(this.geometry){this._markSubMeshesAsAttributesDirty();var a=this._internalAbstractMeshDataInfo._morphTargetManager;if(a&&a.vertexCount)if(a.vertexCount!==this.getTotalVertices())O$$module$libs$world_onscreen.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),this.morphTargetManager=null;else{if(!a.isUsingTextureForTargets)for(let d=0;d<a.numInfluencers;d++){var b=a.getActiveTarget(d),c=b.getPositions();
if(!c){O$$module$libs$world_onscreen.Error("Invalid morph target. Target must have positions.");break}this.geometry.setVerticesData(g$$module$libs$world_onscreen.PositionKind+d,c,!1,3);(c=b.getNormals())&&this.geometry.setVerticesData(g$$module$libs$world_onscreen.NormalKind+d,c,!1,3);(c=b.getTangents())&&this.geometry.setVerticesData(g$$module$libs$world_onscreen.TangentKind+d,c,!1,3);(b=b.getUVs())&&this.geometry.setVerticesData(g$$module$libs$world_onscreen.UVKind+"_"+d,b,!1,2)}}else for(a=0;this.geometry.isVerticesDataPresent(g$$module$libs$world_onscreen.PositionKind+
a);)this.geometry.removeVerticesData(g$$module$libs$world_onscreen.PositionKind+a),this.geometry.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind+a)&&this.geometry.removeVerticesData(g$$module$libs$world_onscreen.NormalKind+a),this.geometry.isVerticesDataPresent(g$$module$libs$world_onscreen.TangentKind+a)&&this.geometry.removeVerticesData(g$$module$libs$world_onscreen.TangentKind+a),this.geometry.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind+a)&&this.geometry.removeVerticesData(g$$module$libs$world_onscreen.UVKind+
"_"+a),a++}}static Parse(a,b,c){let d;if(a.type&&"LinesMesh"===a.type?d=W$$module$libs$world_onscreen._LinesMeshParser(a,b):a.type&&"GroundMesh"===a.type?d=W$$module$libs$world_onscreen._GroundMeshParser(a,b):a.type&&"GoldbergMesh"===a.type?d=W$$module$libs$world_onscreen._GoldbergMeshParser(a,b):d=new W$$module$libs$world_onscreen(a.name,b),d.id=a.id,d._waitingParsedUniqueId=a.uniqueId,ge$$module$libs$world_onscreen&&ge$$module$libs$world_onscreen.AddTagsTo(d,a.tags),d.position=p$$module$libs$world_onscreen.FromArray(a.position),
void 0!==a.metadata&&(d.metadata=a.metadata),a.rotationQuaternion?d.rotationQuaternion=Y$$module$libs$world_onscreen.FromArray(a.rotationQuaternion):a.rotation&&(d.rotation=p$$module$libs$world_onscreen.FromArray(a.rotation)),d.scaling=p$$module$libs$world_onscreen.FromArray(a.scaling),a.localMatrix?d.setPreTransformMatrix(x$$module$libs$world_onscreen.FromArray(a.localMatrix)):a.pivotMatrix&&d.setPivotMatrix(x$$module$libs$world_onscreen.FromArray(a.pivotMatrix)),d.setEnabled(a.isEnabled),d.isVisible=
a.isVisible,d.infiniteDistance=a.infiniteDistance,d.showBoundingBox=a.showBoundingBox,d.showSubMeshesBoundingBox=a.showSubMeshesBoundingBox,void 0!==a.applyFog&&(d.applyFog=a.applyFog),void 0!==a.pickable&&(d.isPickable=a.pickable),void 0!==a.alphaIndex&&(d.alphaIndex=a.alphaIndex),d.receiveShadows=a.receiveShadows,void 0!==a.billboardMode&&(d.billboardMode=a.billboardMode),void 0!==a.visibility&&(d.visibility=a.visibility),d.checkCollisions=a.checkCollisions,d.overrideMaterialSideOrientation=a.overrideMaterialSideOrientation,
void 0!==a.isBlocker&&(d.isBlocker=a.isBlocker),d._shouldGenerateFlatShading=a.useFlatShading,a.freezeWorldMatrix&&(d._waitingData.freezeWorldMatrix=a.freezeWorldMatrix),void 0!==a.parentId&&(d._waitingParentId=a.parentId),void 0!==a.parentInstanceIndex&&(d._waitingParentInstanceIndex=a.parentInstanceIndex),void 0!==a.actions&&(d._waitingData.actions=a.actions),void 0!==a.overlayAlpha&&(d.overlayAlpha=a.overlayAlpha),void 0!==a.overlayColor&&(d.overlayColor=se$$module$libs$world_onscreen.FromArray(a.overlayColor)),
void 0!==a.renderOverlay&&(d.renderOverlay=a.renderOverlay),d.isUnIndexed=!!a.isUnIndexed,d.hasVertexAlpha=a.hasVertexAlpha,a.delayLoadingFile?(d.delayLoadState=4,d.delayLoadingFile=c+a.delayLoadingFile,d.buildBoundingInfo(p$$module$libs$world_onscreen.FromArray(a.boundingBoxMinimum),p$$module$libs$world_onscreen.FromArray(a.boundingBoxMaximum)),a._binaryInfo&&(d._binaryInfo=a._binaryInfo),d._delayInfo=[],a.hasUVs&&d._delayInfo.push(g$$module$libs$world_onscreen.UVKind),a.hasUVs2&&d._delayInfo.push(g$$module$libs$world_onscreen.UV2Kind),
a.hasUVs3&&d._delayInfo.push(g$$module$libs$world_onscreen.UV3Kind),a.hasUVs4&&d._delayInfo.push(g$$module$libs$world_onscreen.UV4Kind),a.hasUVs5&&d._delayInfo.push(g$$module$libs$world_onscreen.UV5Kind),a.hasUVs6&&d._delayInfo.push(g$$module$libs$world_onscreen.UV6Kind),a.hasColors&&d._delayInfo.push(g$$module$libs$world_onscreen.ColorKind),a.hasMatricesIndices&&d._delayInfo.push(g$$module$libs$world_onscreen.MatricesIndicesKind),a.hasMatricesWeights&&d._delayInfo.push(g$$module$libs$world_onscreen.MatricesWeightsKind),
d._delayLoadingFunction=at$$module$libs$world_onscreen._ImportGeometry,we$$module$libs$world_onscreen.ForceFullSceneLoadingForIncremental&&d._checkDelayState()):at$$module$libs$world_onscreen._ImportGeometry(a,d),a.materialUniqueId?d._waitingMaterialId=a.materialUniqueId:a.materialId&&(d._waitingMaterialId=a.materialId),-1<a.morphTargetManagerId&&(d.morphTargetManager=b.getMorphTargetManagerById(a.morphTargetManagerId)),void 0!==a.skeletonId&&null!==a.skeletonId&&(d.skeleton=b.getLastSkeletonById(a.skeletonId),
a.numBoneInfluencers&&(d.numBoneInfluencers=a.numBoneInfluencers)),a.animations){for(c=0;c<a.animations.length;c++){var e=a.animations[c],g=ci$$module$libs$world_onscreen("BABYLON.Animation");g&&d.animations.push(g.Parse(e))}Xe$$module$libs$world_onscreen.ParseAnimationRanges(d,a,b)}if(a.autoAnimate&&b.beginAnimation(d,a.autoAnimateFrom,a.autoAnimateTo,a.autoAnimateLoop,a.autoAnimateSpeed||1),a.layerMask&&!isNaN(a.layerMask)?d.layerMask=Math.abs(parseInt(a.layerMask)):d.layerMask=268435455,a.physicsImpostor&&
W$$module$libs$world_onscreen._PhysicsImpostorParser(b,d,a),a.lodMeshIds&&(d._waitingData.lods={ids:a.lodMeshIds,distances:a.lodDistances?a.lodDistances:null,coverages:a.lodCoverages?a.lodCoverages:null}),a.instances)for(c=0;c<a.instances.length;c++)if(e=a.instances[c],g=d.createInstance(e.name),e.id&&(g.id=e.id),ge$$module$libs$world_onscreen&&(e.tags?ge$$module$libs$world_onscreen.AddTagsTo(g,e.tags):ge$$module$libs$world_onscreen.AddTagsTo(g,a.tags)),g.position=p$$module$libs$world_onscreen.FromArray(e.position),
void 0!==e.metadata&&(g.metadata=e.metadata),void 0!==e.parentId&&(g._waitingParentId=e.parentId),void 0!==e.parentInstanceIndex&&(g._waitingParentInstanceIndex=e.parentInstanceIndex),void 0!==e.isEnabled&&null!==e.isEnabled&&g.setEnabled(e.isEnabled),void 0!==e.isVisible&&null!==e.isVisible&&(g.isVisible=e.isVisible),void 0!==e.isPickable&&null!==e.isPickable&&(g.isPickable=e.isPickable),e.rotationQuaternion?g.rotationQuaternion=Y$$module$libs$world_onscreen.FromArray(e.rotationQuaternion):e.rotation&&
(g.rotation=p$$module$libs$world_onscreen.FromArray(e.rotation)),g.scaling=p$$module$libs$world_onscreen.FromArray(e.scaling),null!=e.checkCollisions&&null!=e.checkCollisions&&(g.checkCollisions=e.checkCollisions),null!=e.pickable&&null!=e.pickable&&(g.isPickable=e.pickable),null!=e.showBoundingBox&&null!=e.showBoundingBox&&(g.showBoundingBox=e.showBoundingBox),null!=e.showSubMeshesBoundingBox&&null!=e.showSubMeshesBoundingBox&&(g.showSubMeshesBoundingBox=e.showSubMeshesBoundingBox),null!=e.alphaIndex&&
null!=e.showSubMeshesBoundingBox&&(g.alphaIndex=e.alphaIndex),e.physicsImpostor&&W$$module$libs$world_onscreen._PhysicsImpostorParser(b,g,e),e.animations){for(let n=0;n<e.animations.length;n++){const t=e.animations[n],w=ci$$module$libs$world_onscreen("BABYLON.Animation");w&&g.animations.push(w.Parse(t))}Xe$$module$libs$world_onscreen.ParseAnimationRanges(g,e,b);e.autoAnimate&&b.beginAnimation(g,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1)}if(a.thinInstances&&(b=a.thinInstances,
d.thinInstanceEnablePicking=!!b.enablePicking,b.matrixData?(d.thinInstanceSetBuffer("matrix",new Float32Array(b.matrixData),16,!1),d._thinInstanceDataStorage.matrixBufferSize=b.matrixBufferSize,d._thinInstanceDataStorage.instancesCount=b.instancesCount):d._thinInstanceDataStorage.matrixBufferSize=b.matrixBufferSize,a.thinInstances.userThinInstance)){a=a.thinInstances.userThinInstance;for(const n in a.data)d.thinInstanceSetBuffer(n,new Float32Array(a.data[n]),a.strides[n],!1),d._userThinInstanceBuffersStorage.sizes[n]=
a.sizes[n]}return d}setPositionsForCPUSkinning(){const a=this._internalMeshDataInfo;if(!a._sourcePositions){const b=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);if(!b)return a._sourcePositions;a._sourcePositions=new Float32Array(b);this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.PositionKind)||this.setVerticesData(g$$module$libs$world_onscreen.PositionKind,b,!0)}return a._sourcePositions}setNormalsForCPUSkinning(){const a=this._internalMeshDataInfo;if(!a._sourceNormals){const b=
this.getVerticesData(g$$module$libs$world_onscreen.NormalKind);if(!b)return a._sourceNormals;a._sourceNormals=new Float32Array(b);this.isVertexBufferUpdatable(g$$module$libs$world_onscreen.NormalKind)||this.setVerticesData(g$$module$libs$world_onscreen.NormalKind,b,!0)}return a._sourceNormals}applySkeleton(a){if(!(this.geometry&&this.geometry._softwareSkinningFrameId!=this.getScene().getFrameId()&&(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),this.isVerticesDataPresent(g$$module$libs$world_onscreen.PositionKind))&&
this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesIndicesKind)&&this.isVerticesDataPresent(g$$module$libs$world_onscreen.MatricesWeightsKind)))return this;const b=this.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind),c=this._internalMeshDataInfo;if(!c._sourcePositions){var d=this.subMeshes.slice();this.setPositionsForCPUSkinning();this.subMeshes=d}b&&!c._sourceNormals&&this.setNormalsForCPUSkinning();d=this.getVerticesData(g$$module$libs$world_onscreen.PositionKind);
if(!d)return this;d instanceof Float32Array||(d=new Float32Array(d));let e=this.getVerticesData(g$$module$libs$world_onscreen.NormalKind);if(b){if(!e)return this;e instanceof Float32Array||(e=new Float32Array(e))}const g=this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesKind),n=this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsKind);if(!n||!g)return this;const t=4<this.numBoneInfluencers,w=t?this.getVerticesData(g$$module$libs$world_onscreen.MatricesIndicesExtraKind):
null,z=t?this.getVerticesData(g$$module$libs$world_onscreen.MatricesWeightsExtraKind):null;a=a.getTransformMatrices(this);const C=p$$module$libs$world_onscreen.Zero(),H=new x$$module$libs$world_onscreen,M=new x$$module$libs$world_onscreen;let L=0,O;for(let S=0;S<d.length;S+=3,L+=4){let T;for(O=0;4>O;O++)T=n[L+O],0<T&&(x$$module$libs$world_onscreen.FromFloat32ArrayToRefScaled(a,Math.floor(16*g[L+O]),T,M),H.addToSelf(M));if(t)for(O=0;4>O;O++)T=z[L+O],0<T&&(x$$module$libs$world_onscreen.FromFloat32ArrayToRefScaled(a,
Math.floor(16*w[L+O]),T,M),H.addToSelf(M));p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(c._sourcePositions[S],c._sourcePositions[S+1],c._sourcePositions[S+2],H,C);C.toArray(d,S);b&&(p$$module$libs$world_onscreen.TransformNormalFromFloatsToRef(c._sourceNormals[S],c._sourceNormals[S+1],c._sourceNormals[S+2],H,C),C.toArray(e,S));H.reset()}return this.updateVerticesData(g$$module$libs$world_onscreen.PositionKind,d),b&&this.updateVerticesData(g$$module$libs$world_onscreen.NormalKind,
e),this}static MinMax(a){let b=null,c=null;return a.forEach(function(d){d=d.getBoundingInfo().boundingBox;b&&c?(b.minimizeInPlace(d.minimumWorld),c.maximizeInPlace(d.maximumWorld)):(b=d.minimumWorld,c=d.maximumWorld)}),b&&c?{min:b,max:c}:{min:p$$module$libs$world_onscreen.Zero(),max:p$$module$libs$world_onscreen.Zero()}}static Center(a){a=a instanceof Array?W$$module$libs$world_onscreen.MinMax(a):a;return p$$module$libs$world_onscreen.Center(a.min,a.max)}static MergeMeshes(a,b=!0,c,d,e,g){return Ks$$module$libs$world_onscreen(W$$module$libs$world_onscreen._MergeMeshesCoroutine(a,
b,c,d,e,g,!1))}static MergeMeshesAsync(a,b=!0,c,d,e,g){return kn$$module$libs$world_onscreen(W$$module$libs$world_onscreen._MergeMeshesCoroutine(a,b,c,d,e,g,!0),Un$$module$libs$world_onscreen())}static *_MergeMeshesCoroutine(a,b=!0,c,d,e,g,n){if(a=a.filter(Boolean),0===a.length)return null;var t;if(!c){var w=0;for(t=0;t<a.length;t++)if(w+=a[t].getTotalVertices(),65536<=w)return O$$module$libs$world_onscreen.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),
null}g&&(e=!1);var z=[];w=[];const C=[];var H=a[0].overrideMaterialSideOrientation;for(t=0;t<a.length;t++){var M=a[t];if(M.isAnInstance)return O$$module$libs$world_onscreen.Warn("Cannot merge instance meshes."),null;if(H!==M.overrideMaterialSideOrientation)return O$$module$libs$world_onscreen.Warn("Cannot merge meshes with different overrideMaterialSideOrientation values."),null;if(e&&C.push(M.getTotalIndices()),g)if(M.material){var L=M.material;if(L instanceof Ai$$module$libs$world_onscreen){for(var O=
0;O<L.subMaterials.length;O++)0>z.indexOf(L.subMaterials[O])&&z.push(L.subMaterials[O]);for(O=0;O<M.subMeshes.length;O++)w.push(z.indexOf(L.subMaterials[M.subMeshes[O].materialIndex])),C.push(M.subMeshes[O].indexCount)}else for(0>z.indexOf(L)&&z.push(L),O=0;O<M.subMeshes.length;O++)w.push(z.indexOf(L)),C.push(M.subMeshes[O].indexCount)}else for(L=0;L<M.subMeshes.length;L++)w.push(0),C.push(M.subMeshes[L].indexCount)}H=a[0];t=P=>{const W=P.computeWorldMatrix(!0);return[J$$module$libs$world_onscreen.ExtractFromMesh(P,
!1,!1),W]};const [S,T]=t(H);n&&(yield);M=Array(a.length-1);for(L=1;L<a.length;L++)M[L-1]=t(a[L]),n&&(yield);c=S._mergeCoroutine(T,M,c,n,!b);for(t=c.next();!t.done;)n&&(yield),t=c.next();c=t.value;d||=new W$$module$libs$world_onscreen(H.name+"_merged",H.getScene());c=c._applyToCoroutine(d,void 0,n);for(t=c.next();!t.done;)n&&(yield),t=c.next();if(d.checkCollisions=H.checkCollisions,d.overrideMaterialSideOrientation=H.overrideMaterialSideOrientation,b)for(t=0;t<a.length;t++)a[t].dispose();if(e||g){d.releaseSubMeshes();
for(a=t=0;t<C.length;)Et$$module$libs$world_onscreen.CreateFromIndices(0,a,C[t],d,void 0,!1),a+=C[t],t++;for(const P of d.subMeshes)P.refreshBoundingInfo();d.computeWorldMatrix(!0)}if(g){g=new Ai$$module$libs$world_onscreen(H.name+"_merged",H.getScene());g.subMaterials=z;for(z=0;z<d.subMeshes.length;z++)d.subMeshes[z].materialIndex=w[z];d.material=g}else d.material=H.material;return d}addInstance(a){a._indexInSourceMeshInstanceArray=this.instances.length;this.instances.push(a)}removeInstance(a){const b=
a._indexInSourceMeshInstanceArray;if(-1!=b){if(b!==this.instances.length-1){const c=this.instances[this.instances.length-1];this.instances[b]=c;c._indexInSourceMeshInstanceArray=b}a._indexInSourceMeshInstanceArray=-1;this.instances.pop()}}_shouldConvertRHS(){return this.overrideMaterialSideOrientation===P$$module$libs$world_onscreen.CounterClockWiseSideOrientation}}W$$module$libs$world_onscreen.FRONTSIDE=J$$module$libs$world_onscreen.FRONTSIDE;W$$module$libs$world_onscreen.BACKSIDE=J$$module$libs$world_onscreen.BACKSIDE;
W$$module$libs$world_onscreen.DOUBLESIDE=J$$module$libs$world_onscreen.DOUBLESIDE;W$$module$libs$world_onscreen.DEFAULTSIDE=J$$module$libs$world_onscreen.DEFAULTSIDE;W$$module$libs$world_onscreen.NO_CAP=0;W$$module$libs$world_onscreen.CAP_START=1;W$$module$libs$world_onscreen.CAP_END=2;W$$module$libs$world_onscreen.CAP_ALL=3;W$$module$libs$world_onscreen.NO_FLIP=0;W$$module$libs$world_onscreen.FLIP_TILE=1;W$$module$libs$world_onscreen.ROTATE_TILE=2;W$$module$libs$world_onscreen.FLIP_ROW=3;
W$$module$libs$world_onscreen.ROTATE_ROW=4;W$$module$libs$world_onscreen.FLIP_N_ROTATE_TILE=5;W$$module$libs$world_onscreen.FLIP_N_ROTATE_ROW=6;W$$module$libs$world_onscreen.CENTER=0;W$$module$libs$world_onscreen.LEFT=1;W$$module$libs$world_onscreen.RIGHT=2;W$$module$libs$world_onscreen.TOP=3;W$$module$libs$world_onscreen.BOTTOM=4;W$$module$libs$world_onscreen.INSTANCEDMESH_SORT_TRANSPARENT=!1;
W$$module$libs$world_onscreen._GroundMeshParser=(a,b)=>{throw $$$module$libs$world_onscreen("GroundMesh");};W$$module$libs$world_onscreen._GoldbergMeshParser=(a,b)=>{throw $$$module$libs$world_onscreen("GoldbergMesh");};W$$module$libs$world_onscreen._LinesMeshParser=(a,b)=>{throw $$$module$libs$world_onscreen("LinesMesh");};st$$module$libs$world_onscreen("BABYLON.Mesh",W$$module$libs$world_onscreen);W$$module$libs$world_onscreen.prototype.setMaterialByID=function(a){return this.setMaterialById(a)};
W$$module$libs$world_onscreen.CreateDisc=W$$module$libs$world_onscreen.CreateDisc||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateBox=W$$module$libs$world_onscreen.CreateBox||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateSphere=W$$module$libs$world_onscreen.CreateSphere||(()=>{throw Error("Import MeshBuilder to populate this function");});
W$$module$libs$world_onscreen.CreateCylinder=W$$module$libs$world_onscreen.CreateCylinder||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateTorusKnot=W$$module$libs$world_onscreen.CreateTorusKnot||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateTorus=W$$module$libs$world_onscreen.CreateTorus||(()=>{throw Error("Import MeshBuilder to populate this function");});
W$$module$libs$world_onscreen.CreatePlane=W$$module$libs$world_onscreen.CreatePlane||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateGround=W$$module$libs$world_onscreen.CreateGround||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateTiledGround=W$$module$libs$world_onscreen.CreateTiledGround||(()=>{throw Error("Import MeshBuilder to populate this function");});
W$$module$libs$world_onscreen.CreateGroundFromHeightMap=W$$module$libs$world_onscreen.CreateGroundFromHeightMap||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateTube=W$$module$libs$world_onscreen.CreateTube||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreatePolyhedron=W$$module$libs$world_onscreen.CreatePolyhedron||(()=>{throw Error("Import MeshBuilder to populate this function");});
W$$module$libs$world_onscreen.CreateIcoSphere=W$$module$libs$world_onscreen.CreateIcoSphere||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateDecal=W$$module$libs$world_onscreen.CreateDecal||(()=>{throw Error("Import MeshBuilder to populate this function");});W$$module$libs$world_onscreen.CreateCapsule=W$$module$libs$world_onscreen.CreateCapsule||(()=>{throw Error("Import MeshBuilder to populate this function");});
W$$module$libs$world_onscreen.ExtendToGoldberg=W$$module$libs$world_onscreen.ExtendToGoldberg||(()=>{throw Error("Import MeshBuilder to populate this function");});class Ht$$module$libs$world_onscreen{constructor(a=0){this.priority=a}getDescription(){return""}apply(a,b){return!0}}
class As$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{constructor(a=0,b=1024,c=.5){super(a);this.priority=a;this.maximumSize=b;this.step=c}getDescription(){return"Reducing render target texture size to "+this.maximumSize}apply(a,b){b=!0;for(let c=0;c<a.textures.length;c++){const d=a.textures[c];if(!d.canRescale||d.getContext)continue;const e=d.getSize();Math.max(e.width,e.height)>this.maximumSize&&(d.scale(this.step),b=!1)}return b}}
class _r$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{constructor(a=0,b=2,c=.25){super(a);this.priority=a;this.maximumScale=b;this.step=c;this._currentScale=-1;this._directionOffset=1}getDescription(){return"Setting hardware scaling level to "+this._currentScale}apply(a,b){return-1===this._currentScale&&(this._currentScale=a.getEngine().getHardwareScalingLevel(),this._currentScale>this.maximumScale&&(this._directionOffset=-1)),this._currentScale+=this._directionOffset*this.step,
a.getEngine().setHardwareScalingLevel(this._currentScale),1===this._directionOffset?this._currentScale>=this.maximumScale:this._currentScale<=this.maximumScale}}class Rs$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{getDescription(){return"Turning shadows on/off"}apply(a,b){return a.shadowsEnabled=b.isInImprovementMode,!0}}
class ys$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{getDescription(){return"Turning post-processes on/off"}apply(a,b){return a.postProcessesEnabled=b.isInImprovementMode,!0}}class Cs$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{getDescription(){return"Turning lens flares on/off"}apply(a,b){return a.lensFlaresEnabled=b.isInImprovementMode,!0}}
class jn$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{getDescription(){return this.onGetDescription?this.onGetDescription():"Running user defined callback"}apply(a,b){return this.onApply?this.onApply(a,b):!0}}class Is$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{getDescription(){return"Turning particles on/off"}apply(a,b){return a.particlesEnabled=b.isInImprovementMode,!0}}
class gr$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{getDescription(){return"Turning render targets off"}apply(a,b){return a.renderTargetsEnabled=b.isInImprovementMode,!0}}
class jt$$module$libs$world_onscreen extends Ht$$module$libs$world_onscreen{constructor(){super(...arguments);this._canBeMerged=a=>a instanceof W$$module$libs$world_onscreen?!(a.isDisposed()||!a.isVisible||!a.isEnabled()||0<a.instances.length||a.skeleton||a.hasLODLevels):!1}static get UpdateSelectionTree(){return jt$$module$libs$world_onscreen._UpdateSelectionTree}static set UpdateSelectionTree(a){jt$$module$libs$world_onscreen._UpdateSelectionTree=a}getDescription(){return"Merging similar meshes together"}apply(a,
b,c){b=a.meshes.slice(0);let d=b.length;for(let e=0;e<d;e++){const g=[],n=b[e];if(this._canBeMerged(n)){g.push(n);for(let t=e+1;t<d;t++){const w=b[t];this._canBeMerged(w)&&w.material===n.material&&w.checkCollisions===n.checkCollisions&&(g.push(w),d--,b.splice(t,1),t--)}2>g.length||W$$module$libs$world_onscreen.MergeMeshes(g,void 0,!0)}}return a.createOrUpdateSelectionOctree&&(null!=c?c&&a.createOrUpdateSelectionOctree():jt$$module$libs$world_onscreen.UpdateSelectionTree&&a.createOrUpdateSelectionOctree()),
!0}}jt$$module$libs$world_onscreen._UpdateSelectionTree=!1;
class li$$module$libs$world_onscreen{constructor(a=60,b=2E3){this.targetFrameRate=a;this.trackerDuration=b;this.optimizations=[]}addOptimization(a){return this.optimizations.push(a),this}addCustomOptimization(a,b,c=0){c=new jn$$module$libs$world_onscreen(c);return c.onApply=a,c.onGetDescription=b,this.optimizations.push(c),this}static LowDegradationAllowed(a){a=new li$$module$libs$world_onscreen(a);let b=0;return a.addOptimization(new jt$$module$libs$world_onscreen(b)),a.addOptimization(new Rs$$module$libs$world_onscreen(b)),
a.addOptimization(new Cs$$module$libs$world_onscreen(b)),b++,a.addOptimization(new ys$$module$libs$world_onscreen(b)),a.addOptimization(new Is$$module$libs$world_onscreen(b)),b++,a.addOptimization(new As$$module$libs$world_onscreen(b,1024)),a}static ModerateDegradationAllowed(a){a=new li$$module$libs$world_onscreen(a);let b=0;return a.addOptimization(new jt$$module$libs$world_onscreen(b)),a.addOptimization(new Rs$$module$libs$world_onscreen(b)),a.addOptimization(new Cs$$module$libs$world_onscreen(b)),
b++,a.addOptimization(new ys$$module$libs$world_onscreen(b)),a.addOptimization(new Is$$module$libs$world_onscreen(b)),b++,a.addOptimization(new As$$module$libs$world_onscreen(b,512)),b++,a.addOptimization(new gr$$module$libs$world_onscreen(b)),b++,a.addOptimization(new _r$$module$libs$world_onscreen(b,2)),a}static HighDegradationAllowed(a){a=new li$$module$libs$world_onscreen(a);let b=0;return a.addOptimization(new jt$$module$libs$world_onscreen(b)),a.addOptimization(new Rs$$module$libs$world_onscreen(b)),
a.addOptimization(new Cs$$module$libs$world_onscreen(b)),b++,a.addOptimization(new ys$$module$libs$world_onscreen(b)),a.addOptimization(new Is$$module$libs$world_onscreen(b)),b++,a.addOptimization(new As$$module$libs$world_onscreen(b,256)),b++,a.addOptimization(new gr$$module$libs$world_onscreen(b)),b++,a.addOptimization(new _r$$module$libs$world_onscreen(b,4)),a}}
class Zs$$module$libs$world_onscreen{constructor(a,b,c=!0,d=!1){if(this._isRunning=!1,this._currentPriorityLevel=0,this._targetFrameRate=60,this._trackerDuration=2E3,this._currentFrameRate=0,this._improvementMode=!1,this.onSuccessObservable=new w$$module$libs$world_onscreen,this.onNewOptimizationAppliedObservable=new w$$module$libs$world_onscreen,this.onFailureObservable=new w$$module$libs$world_onscreen,b?this._options=b:this._options=new li$$module$libs$world_onscreen,this._options.targetFrameRate&&
(this._targetFrameRate=this._options.targetFrameRate),this._options.trackerDuration&&(this._trackerDuration=this._options.trackerDuration),c){b=0;for(const e of this._options.optimizations)e.priority=b++}this._improvementMode=d;this._scene=a||fe$$module$libs$world_onscreen.LastCreatedScene;this._sceneDisposeObserver=this._scene.onDisposeObservable.add(()=>{this._sceneDisposeObserver=null;this.dispose()})}get isInImprovementMode(){return this._improvementMode}set isInImprovementMode(a){this._improvementMode=
a}get currentPriorityLevel(){return this._currentPriorityLevel}get currentFrameRate(){return this._currentFrameRate}get targetFrameRate(){return this._targetFrameRate}set targetFrameRate(a){this._targetFrameRate=a}get trackerDuration(){return this._trackerDuration}set trackerDuration(a){this._trackerDuration=a}get optimizations(){return this._options.optimizations}stop(){this._isRunning=!1}reset(){this._currentPriorityLevel=0}start(){this._isRunning||(this._isRunning=!0,this._scene.executeWhenReady(()=>
{setTimeout(()=>{this._checkCurrentState()},this._trackerDuration)}))}_checkCurrentState(){if(this._isRunning){var a=this._scene,b=this._options;if(this._currentFrameRate=Math.round(a.getEngine().getFps()),this._improvementMode&&this._currentFrameRate<=this._targetFrameRate||!this._improvementMode&&this._currentFrameRate>=this._targetFrameRate)this._isRunning=!1,this.onSuccessObservable.notifyObservers(this);else{var c=!0,d=!0;for(let e=0;e<b.optimizations.length;e++){const g=b.optimizations[e];g.priority===
this._currentPriorityLevel&&(d=!1,c=c&&g.apply(a,this),this.onNewOptimizationAppliedObservable.notifyObservers(g))}d?(this._isRunning=!1,this.onFailureObservable.notifyObservers(this)):(c&&this._currentPriorityLevel++,a.executeWhenReady(()=>{setTimeout(()=>{this._checkCurrentState()},this._trackerDuration)}))}}}dispose(){this.stop();this.onSuccessObservable.clear();this.onFailureObservable.clear();this.onNewOptimizationAppliedObservable.clear();this._sceneDisposeObserver&&this._scene.onDisposeObservable.remove(this._sceneDisposeObserver)}static OptimizeAsync(a,
b,c,d){a=new Zs$$module$libs$world_onscreen(a,b||li$$module$libs$world_onscreen.ModerateDegradationAllowed(),!1);return c&&a.onSuccessObservable.add(()=>{c()}),d&&a.onFailureObservable.add(()=>{d()}),a.start(),a}}
function $n$$module$libs$world_onscreen(a){({engine:a}=a);a=new re$$module$libs$world_onscreen(a);a.clearColor=new me$$module$libs$world_onscreen(0,0,0,0);a.pointerMovePredicate=()=>!1;a.pointerDownPredicate=()=>!1;a.pointerUpPredicate=()=>!1;a.clearCachedVertexData();a.themeData={};const b=li$$module$libs$world_onscreen.LowDegradationAllowed();return b.optimizations=b.optimizations.splice(1),b.targetFrameRate=60,Zs$$module$libs$world_onscreen.OptimizeAsync(a,b),a}
class Ge$$module$libs$world_onscreen extends q$$module$libs$world_onscreen{constructor(a,b,c,d=!0){super(a,b,c,d);this._tmpUpVector=p$$module$libs$world_onscreen.Zero();this._tmpTargetVector=p$$module$libs$world_onscreen.Zero();this.cameraDirection=new p$$module$libs$world_onscreen(0,0,0);this.cameraRotation=new Te$$module$libs$world_onscreen(0,0);this.updateUpVectorFromRotation=this.ignoreParentScaling=!1;this._tmpQuaternion=new Y$$module$libs$world_onscreen;this.rotation=new p$$module$libs$world_onscreen(0,
0,0);this.speed=2;this.invertRotation=this.noRotationConstraint=!1;this.inverseRotationSpeed=.2;this.lockedTarget=null;this._currentTarget=p$$module$libs$world_onscreen.Zero();this._initialFocalDistance=1;this._viewMatrix=x$$module$libs$world_onscreen.Zero();this._camMatrix=x$$module$libs$world_onscreen.Zero();this._cameraTransformMatrix=x$$module$libs$world_onscreen.Zero();this._cameraRotationMatrix=x$$module$libs$world_onscreen.Zero();this._referencePoint=new p$$module$libs$world_onscreen(0,0,1);
this._transformedReferencePoint=p$$module$libs$world_onscreen.Zero();this._defaultUp=p$$module$libs$world_onscreen.Up();this._cachedQuaternionRotationZ=this._cachedRotationZ=0}getFrontPosition(a){this.getWorldMatrix();const b=this.getTarget().subtract(this.position);return b.normalize(),b.scaleInPlace(a),this.globalPosition.add(b)}_getLockedTargetPosition(){return this.lockedTarget?(this.lockedTarget.absolutePosition&&this.lockedTarget.computeWorldMatrix(),this.lockedTarget.absolutePosition||this.lockedTarget):
null}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return super._restoreStateValues()?(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,
0),!0):!1}_initCache(){super._initCache();this._cache.lockedTarget=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.rotation=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.rotationQuaternion=new Y$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(a){a||super._updateCache();(a=this._getLockedTargetPosition())?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(a):
this._cache.lockedTarget=a.clone():this._cache.lockedTarget=null;this._cache.rotation.copyFrom(this.rotation);this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const a=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(a):!a)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const a=
this.getEngine();return this.speed*Math.sqrt(a.getDeltaTime()/(100*a.getFps()))}setTarget(a){this.upVector.normalize();this._initialFocalDistance=a.subtract(this.position).length();this.position.z===a.z&&(this.position.z+=Re$$module$libs$world_onscreen);this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance);x$$module$libs$world_onscreen.LookAtLHToRef(this.position,a,this._defaultUp,this._camMatrix);this._camMatrix.invert();this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);
a=a.subtract(this.position);0<=a.x?this.rotation.y=-Math.atan(a.z/a.x)+Math.PI/2:this.rotation.y=-Math.atan(a.z/a.x)-Math.PI/2;this.rotation.z=0;isNaN(this.rotation.x)&&(this.rotation.x=0);isNaN(this.rotation.y)&&(this.rotation.y=0);isNaN(this.rotation.z)&&(this.rotation.z=0);this.rotationQuaternion&&Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}get target(){return this.getTarget()}set target(a){this.setTarget(a)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return 0<
Math.abs(this.cameraDirection.x)||0<Math.abs(this.cameraDirection.y)||0<Math.abs(this.cameraDirection.z)}_updatePosition(){this.parent?(this.parent.getWorldMatrix().invertToRef(D$$module$libs$world_onscreen.Matrix[0]),p$$module$libs$world_onscreen.TransformNormalToRef(this.cameraDirection,D$$module$libs$world_onscreen.Matrix[0],D$$module$libs$world_onscreen.Vector3[0]),this.position.addInPlace(D$$module$libs$world_onscreen.Vector3[0])):this.position.addInPlace(this.cameraDirection)}_checkInputs(){const a=
this.invertRotation?-this.inverseRotationSpeed:1,b=this._decideIfNeedsToMove(),c=0<Math.abs(this.cameraRotation.x)||0<Math.abs(this.cameraRotation.y);b&&this._updatePosition();c&&(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this.rotation),this.rotation.x+=this.cameraRotation.x*a,this.rotation.y+=this.cameraRotation.y*a,this.noRotationConstraint||(1.570796<this.rotation.x&&(this.rotation.x=1.570796),-1.570796>this.rotation.x&&(this.rotation.x=-1.570796)),this.rotationQuaternion&&
this.rotation.lengthSquared()&&Y$$module$libs$world_onscreen.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion));b&&(Math.abs(this.cameraDirection.x)<this.speed*Re$$module$libs$world_onscreen&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*Re$$module$libs$world_onscreen&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*Re$$module$libs$world_onscreen&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia));
c&&(Math.abs(this.cameraRotation.x)<this.speed*Re$$module$libs$world_onscreen&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*Re$$module$libs$world_onscreen&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia));super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):x$$module$libs$world_onscreen.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,
this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return p$$module$libs$world_onscreen.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):
this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),p$$module$libs$world_onscreen.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?ui$$module$libs$world_onscreen.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(Y$$module$libs$world_onscreen.FromEulerVectorToRef(this.rotation,
this._tmpQuaternion),ui$$module$libs$world_onscreen.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(a,b,c){if(this.ignoreParentScaling){if(this.parent){const d=this.parent.getWorldMatrix();p$$module$libs$world_onscreen.TransformCoordinatesToRef(a,d,this._globalPosition);p$$module$libs$world_onscreen.TransformCoordinatesToRef(b,d,this._tmpTargetVector);p$$module$libs$world_onscreen.TransformNormalToRef(c,
d,this._tmpUpVector);this._markSyncedWithParent()}else this._globalPosition.copyFrom(a),this._tmpTargetVector.copyFrom(b),this._tmpUpVector.copyFrom(c);this.getScene().useRightHandedSystem?x$$module$libs$world_onscreen.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):x$$module$libs$world_onscreen.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix)}else(this.getScene().useRightHandedSystem?x$$module$libs$world_onscreen.LookAtRHToRef(a,
b,c,this._viewMatrix):x$$module$libs$world_onscreen.LookAtLHToRef(a,b,c,this._viewMatrix),this.parent)?(a=this.parent.getWorldMatrix(),this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(a,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()):this._globalPosition.copyFrom(a)}createRigCamera(a,b){return this.cameraRigMode!==q$$module$libs$world_onscreen.RIG_MODE_NONE?(a=new Ge$$module$libs$world_onscreen(a,this.position.clone(),
this.getScene()),a.isRigCamera=!0,a.rigParent=this,(this.cameraRigMode===q$$module$libs$world_onscreen.RIG_MODE_VR||this.cameraRigMode===q$$module$libs$world_onscreen.RIG_MODE_WEBVR)&&(this.rotationQuaternion||(this.rotationQuaternion=new Y$$module$libs$world_onscreen),a._cameraRigParams={},a.rotationQuaternion=new Y$$module$libs$world_onscreen),a.mode=this.mode,a.orthoLeft=this.orthoLeft,a.orthoRight=this.orthoRight,a.orthoTop=this.orthoTop,a.orthoBottom=this.orthoBottom,a):null}_updateRigCameras(){const a=
this._rigCameras[0],b=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_OVERUNDER:case q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_INTERLACED:const c=this.cameraRigMode===q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?
-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*(this.cameraRigMode===q$$module$libs$world_onscreen.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1),a);this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*c,b);break;case q$$module$libs$world_onscreen.RIG_MODE_VR:a.rotationQuaternion?(a.rotationQuaternion.copyFrom(this.rotationQuaternion),b.rotationQuaternion.copyFrom(this.rotationQuaternion)):(a.rotation.copyFrom(this.rotation),b.rotation.copyFrom(this.rotation)),
a.position.copyFrom(this.position),b.position.copyFrom(this.position)}super._updateRigCameras()}_getRigCamPositionAndTarget(a,b){this.getTarget().subtractToRef(this.position,Ge$$module$libs$world_onscreen._TargetFocalPoint);Ge$$module$libs$world_onscreen._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const c=Ge$$module$libs$world_onscreen._TargetFocalPoint.addInPlace(this.position);x$$module$libs$world_onscreen.TranslationToRef(-c.x,-c.y,-c.z,Ge$$module$libs$world_onscreen._TargetTransformMatrix);
Ge$$module$libs$world_onscreen._TargetTransformMatrix.multiplyToRef(x$$module$libs$world_onscreen.RotationAxis(b.upVector,a),Ge$$module$libs$world_onscreen._RigCamTransformMatrix);x$$module$libs$world_onscreen.TranslationToRef(c.x,c.y,c.z,Ge$$module$libs$world_onscreen._TargetTransformMatrix);Ge$$module$libs$world_onscreen._RigCamTransformMatrix.multiplyToRef(Ge$$module$libs$world_onscreen._TargetTransformMatrix,Ge$$module$libs$world_onscreen._RigCamTransformMatrix);p$$module$libs$world_onscreen.TransformCoordinatesToRef(this.position,
Ge$$module$libs$world_onscreen._RigCamTransformMatrix,b.position);b.setTarget(c)}getClassName(){return"TargetCamera"}}Ge$$module$libs$world_onscreen._RigCamTransformMatrix=new x$$module$libs$world_onscreen;Ge$$module$libs$world_onscreen._TargetTransformMatrix=new x$$module$libs$world_onscreen;Ge$$module$libs$world_onscreen._TargetFocalPoint=new p$$module$libs$world_onscreen;T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen()],Ge$$module$libs$world_onscreen.prototype,"rotation",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Ge$$module$libs$world_onscreen.prototype,"speed",void 0);T$$module$libs$world_onscreen([In$$module$libs$world_onscreen("lockedTargetId")],Ge$$module$libs$world_onscreen.prototype,"lockedTarget",void 0);
function Qn$$module$libs$world_onscreen(a){({scene:a}=a);let b;return b=new Ge$$module$libs$world_onscreen("TargetCamera1",new p$$module$libs$world_onscreen(0,36.5,0),a),b.fov=.25,b.minZ=5,b.maxZ=37.5,b.setTarget(p$$module$libs$world_onscreen.Zero()),b}
class he$$module$libs$world_onscreen extends Xe$$module$libs$world_onscreen{constructor(a,b){super(a,b);this.diffuse=new se$$module$libs$world_onscreen(1,1,1);this.specular=new se$$module$libs$world_onscreen(1,1,1);this.falloffType=he$$module$libs$world_onscreen.FALLOFF_DEFAULT;this.intensity=1;this._range=Number.MAX_VALUE;this._inverseSquaredRange=0;this._photometricScale=1;this._intensityMode=he$$module$libs$world_onscreen.INTENSITYMODE_AUTOMATIC;this._radius=1E-5;this.renderPriority=0;this._shadowEnabled=
!0;this._lightmapMode=this._includeOnlyWithLayerMask=this._excludeWithLayerMask=0;this._shadowGenerators=null;this._excludedMeshesIds=[];this._includedOnlyMeshesIds=[];this._isLight=!0;this.getScene().addLight(this);this._uniformBuffer=new V$$module$libs$world_onscreen(this.getScene().getEngine(),void 0,void 0,a);this._buildUniformLayout();this.includedOnlyMeshes=[];this.excludedMeshes=[];this._resyncMeshes()}get range(){return this._range}set range(a){this._range=a;this._inverseSquaredRange=1/(this.range*
this.range)}get intensityMode(){return this._intensityMode}set intensityMode(a){this._intensityMode=a;this._computePhotometricScale()}get radius(){return this._radius}set radius(a){this._radius=a;this._computePhotometricScale()}get shadowEnabled(){return this._shadowEnabled}set shadowEnabled(a){this._shadowEnabled!==a&&(this._shadowEnabled=a,this._markMeshesAsLightDirty())}get includedOnlyMeshes(){return this._includedOnlyMeshes}set includedOnlyMeshes(a){this._includedOnlyMeshes=a;this._hookArrayForIncludedOnly(a)}get excludedMeshes(){return this._excludedMeshes}set excludedMeshes(a){this._excludedMeshes=
a;this._hookArrayForExcluded(a)}get excludeWithLayerMask(){return this._excludeWithLayerMask}set excludeWithLayerMask(a){this._excludeWithLayerMask=a;this._resyncMeshes()}get includeOnlyWithLayerMask(){return this._includeOnlyWithLayerMask}set includeOnlyWithLayerMask(a){this._includeOnlyWithLayerMask=a;this._resyncMeshes()}get lightmapMode(){return this._lightmapMode}set lightmapMode(a){this._lightmapMode!==a&&(this._lightmapMode=a,this._markMeshesAsLightDirty())}transferTexturesToEffect(a,b){return this}_bindLight(a,
b,c,d,e=!0){var g;a=a.toString();var n=!1;(this._uniformBuffer.bindToEffect(c,"Light"+a),this._renderId===b.getRenderId()&&this._lastUseSpecular===d&&this._uniformBuffer.useUbo)||(this._renderId=b.getRenderId(),this._lastUseSpecular=d,n=this.getScaledIntensity(),this.transferToEffect(c,a),this.diffuse.scaleToRef(n,vi$$module$libs$world_onscreen.Color3[0]),this._uniformBuffer.updateColor4("vLightDiffuse",vi$$module$libs$world_onscreen.Color3[0],this.range,a),d&&(this.specular.scaleToRef(n,vi$$module$libs$world_onscreen.Color3[1]),
this._uniformBuffer.updateColor4("vLightSpecular",vi$$module$libs$world_onscreen.Color3[1],this.radius,a)),n=!0);(this.transferTexturesToEffect(c,a),b.shadowsEnabled&&this.shadowEnabled&&e)&&(b=null!==(g=this.getShadowGenerator(b.activeCamera))&&void 0!==g?g:this.getShadowGenerator())&&(b.bindShadowLight(a,c),n=!0);n?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}getClassName(){return"Light"}toString(a){let b="Name: "+this.name;if(b+=", type: "+["Point","Directional","Spot",
"Hemispheric"][this.getTypeID()],this.animations)for(let c=0;c<this.animations.length;c++)b+=", animation[0]: "+this.animations[c].toString(a);return b}_syncParentEnabledState(){super._syncParentEnabledState();this.isDisposed()||this._resyncMeshes()}setEnabled(a){super.setEnabled(a);this._resyncMeshes()}getShadowGenerator(a=null){var b;return null===this._shadowGenerators?null:null!==(b=this._shadowGenerators.get(a))&&void 0!==b?b:null}getShadowGenerators(){return this._shadowGenerators}getAbsolutePosition(){return p$$module$libs$world_onscreen.Zero()}canAffectMesh(a){return a?
!(this.includedOnlyMeshes&&0<this.includedOnlyMeshes.length&&-1===this.includedOnlyMeshes.indexOf(a)||this.excludedMeshes&&0<this.excludedMeshes.length&&-1!==this.excludedMeshes.indexOf(a)||0!==this.includeOnlyWithLayerMask&&!(this.includeOnlyWithLayerMask&a.layerMask)||0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&a.layerMask):!0}dispose(a,b=!1){if(this._shadowGenerators){var c=this._shadowGenerators.values();for(let d=c.next();!0!==d.done;d=c.next())d.value.dispose();this._shadowGenerators=
null}if(this.getScene().stopAnimation(this),this._parentContainer)c=this._parentContainer.lights.indexOf(this),-1<c&&this._parentContainer.lights.splice(c,1),this._parentContainer=null;for(const d of this.getScene().meshes)d._removeLightSource(this,!0);this._uniformBuffer.dispose();this.getScene().removeLight(this);super.dispose(a,b)}getTypeID(){return 0}getScaledIntensity(){return this._photometricScale*this.intensity}clone(a,b=null){var c=he$$module$libs$world_onscreen.GetConstructorFromName(this.getTypeID(),
a,this.getScene());if(!c)return null;c=ae$$module$libs$world_onscreen.Clone(c,this);return a&&(c.name=a),b&&(c.parent=b),c.setEnabled(this.isEnabled()),this.onClonedObservable.notifyObservers(c),c}serialize(){const a=ae$$module$libs$world_onscreen.Serialize(this);return a.uniqueId=this.uniqueId,a.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(a),0<this.excludedMeshes.length&&(a.excludedMeshesIds=[],this.excludedMeshes.forEach(b=>{a.excludedMeshesIds.push(b.id)})),0<this.includedOnlyMeshes.length&&
(a.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach(b=>{a.includedOnlyMeshesIds.push(b.id)})),ae$$module$libs$world_onscreen.AppendSerializedAnimations(this,a),a.ranges=this.serializeAnimationRanges(),a.isEnabled=this.isEnabled(),a}static GetConstructorFromName(a,b,c){return Xe$$module$libs$world_onscreen.Construct("Light_Type_"+a,b,c)||null}static Parse(a,b){var c=he$$module$libs$world_onscreen.GetConstructorFromName(a.type,a.name,b);if(!c)return null;c=ae$$module$libs$world_onscreen.Parse(c,
a,b);if(a.excludedMeshesIds&&(c._excludedMeshesIds=a.excludedMeshesIds),a.includedOnlyMeshesIds&&(c._includedOnlyMeshesIds=a.includedOnlyMeshesIds),void 0!==a.parentId&&(c._waitingParentId=a.parentId),void 0!==a.parentInstanceIndex&&(c._waitingParentInstanceIndex=a.parentInstanceIndex),void 0!==a.falloffType&&(c.falloffType=a.falloffType),void 0!==a.lightmapMode&&(c.lightmapMode=a.lightmapMode),a.animations){for(let d=0;d<a.animations.length;d++){const e=a.animations[d],g=ci$$module$libs$world_onscreen("BABYLON.Animation");
g&&c.animations.push(g.Parse(e))}Xe$$module$libs$world_onscreen.ParseAnimationRanges(c,a,b)}return a.autoAnimate&&b.beginAnimation(c,a.autoAnimateFrom,a.autoAnimateTo,a.autoAnimateLoop,a.autoAnimateSpeed||1),void 0!==a.isEnabled&&c.setEnabled(a.isEnabled),c}_hookArrayForExcluded(a){const b=a.push;a.push=(...d)=>{const e=b.apply(a,d);for(const g of d)g._resyncLightSource(this);return e};const c=a.splice;a.splice=(d,e)=>{d=c.apply(a,[d,e]);for(const g of d)g._resyncLightSource(this);return d};for(const d of a)d._resyncLightSource(this)}_hookArrayForIncludedOnly(a){const b=
a.push;a.push=(...d)=>{d=b.apply(a,d);return this._resyncMeshes(),d};const c=a.splice;a.splice=(d,e)=>{d=c.apply(a,[d,e]);return this._resyncMeshes(),d};this._resyncMeshes()}_resyncMeshes(){for(const a of this.getScene().meshes)a._resyncLightSource(this)}_markMeshesAsLightDirty(){for(const a of this.getScene().meshes)-1!==a.lightSources.indexOf(this)&&a._markSubMeshesAsLightDirty()}_computePhotometricScale(){this._photometricScale=this._getPhotometricScale();this.getScene().resetCachedMaterial()}_getPhotometricScale(){var a=
0;const b=this.getTypeID();let c=this.intensityMode;switch(c===he$$module$libs$world_onscreen.INTENSITYMODE_AUTOMATIC&&(b===he$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT?c=he$$module$libs$world_onscreen.INTENSITYMODE_ILLUMINANCE:c=he$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSINTENSITY),b){case he$$module$libs$world_onscreen.LIGHTTYPEID_POINTLIGHT:case he$$module$libs$world_onscreen.LIGHTTYPEID_SPOTLIGHT:switch(c){case he$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSPOWER:a=
1/(4*Math.PI);break;case he$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSINTENSITY:a=1;break;case he$$module$libs$world_onscreen.INTENSITYMODE_LUMINANCE:a=this.radius*this.radius}break;case he$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT:switch(c){case he$$module$libs$world_onscreen.INTENSITYMODE_ILLUMINANCE:a=1;break;case he$$module$libs$world_onscreen.INTENSITYMODE_LUMINANCE:a=this.radius,a=Math.max(a,.001),a=2*Math.PI*(1-Math.cos(a))}break;case he$$module$libs$world_onscreen.LIGHTTYPEID_HEMISPHERICLIGHT:a=
1}return a}_reorderLightsInScene(){const a=this.getScene();0!=this._renderPriority&&(a.requireLightSorting=!0);this.getScene().sortLightsByPriority()}}he$$module$libs$world_onscreen.FALLOFF_DEFAULT=Ee$$module$libs$world_onscreen.FALLOFF_DEFAULT;he$$module$libs$world_onscreen.FALLOFF_PHYSICAL=Ee$$module$libs$world_onscreen.FALLOFF_PHYSICAL;he$$module$libs$world_onscreen.FALLOFF_GLTF=Ee$$module$libs$world_onscreen.FALLOFF_GLTF;he$$module$libs$world_onscreen.FALLOFF_STANDARD=Ee$$module$libs$world_onscreen.FALLOFF_STANDARD;
he$$module$libs$world_onscreen.LIGHTMAP_DEFAULT=Ee$$module$libs$world_onscreen.LIGHTMAP_DEFAULT;he$$module$libs$world_onscreen.LIGHTMAP_SPECULAR=Ee$$module$libs$world_onscreen.LIGHTMAP_SPECULAR;he$$module$libs$world_onscreen.LIGHTMAP_SHADOWSONLY=Ee$$module$libs$world_onscreen.LIGHTMAP_SHADOWSONLY;he$$module$libs$world_onscreen.INTENSITYMODE_AUTOMATIC=Ee$$module$libs$world_onscreen.INTENSITYMODE_AUTOMATIC;he$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSPOWER=Ee$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSPOWER;
he$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSINTENSITY=Ee$$module$libs$world_onscreen.INTENSITYMODE_LUMINOUSINTENSITY;he$$module$libs$world_onscreen.INTENSITYMODE_ILLUMINANCE=Ee$$module$libs$world_onscreen.INTENSITYMODE_ILLUMINANCE;he$$module$libs$world_onscreen.INTENSITYMODE_LUMINANCE=Ee$$module$libs$world_onscreen.INTENSITYMODE_LUMINANCE;he$$module$libs$world_onscreen.LIGHTTYPEID_POINTLIGHT=Ee$$module$libs$world_onscreen.LIGHTTYPEID_POINTLIGHT;
he$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT=Ee$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT;he$$module$libs$world_onscreen.LIGHTTYPEID_SPOTLIGHT=Ee$$module$libs$world_onscreen.LIGHTTYPEID_SPOTLIGHT;he$$module$libs$world_onscreen.LIGHTTYPEID_HEMISPHERICLIGHT=Ee$$module$libs$world_onscreen.LIGHTTYPEID_HEMISPHERICLIGHT;T$$module$libs$world_onscreen([di$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"diffuse",void 0);
T$$module$libs$world_onscreen([di$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"specular",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"falloffType",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"intensity",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"range",null);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"intensityMode",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"radius",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],he$$module$libs$world_onscreen.prototype,"_renderPriority",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_reorderLightsInScene")],he$$module$libs$world_onscreen.prototype,"renderPriority",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("shadowEnabled")],he$$module$libs$world_onscreen.prototype,"_shadowEnabled",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("excludeWithLayerMask")],he$$module$libs$world_onscreen.prototype,"_excludeWithLayerMask",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("includeOnlyWithLayerMask")],he$$module$libs$world_onscreen.prototype,"_includeOnlyWithLayerMask",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("lightmapMode")],he$$module$libs$world_onscreen.prototype,"_lightmapMode",void 0);
class Wi$$module$libs$world_onscreen extends he$$module$libs$world_onscreen{constructor(){super(...arguments);this._needProjectionMatrixCompute=!0}_setPosition(a){this._position=a}get position(){return this._position}set position(a){this._setPosition(a)}_setDirection(a){this._direction=a}get direction(){return this._direction}set direction(a){this._setDirection(a)}get shadowMinZ(){return this._shadowMinZ}set shadowMinZ(a){this._shadowMinZ=a;this.forceProjectionMatrixCompute()}get shadowMaxZ(){return this._shadowMaxZ}set shadowMaxZ(a){this._shadowMaxZ=
a;this.forceProjectionMatrixCompute()}computeTransformedInformation(){return this.parent&&this.parent.getWorldMatrix?(this.transformedPosition||(this.transformedPosition=p$$module$libs$world_onscreen.Zero()),p$$module$libs$world_onscreen.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=p$$module$libs$world_onscreen.Zero()),p$$module$libs$world_onscreen.TransformNormalToRef(this.direction,
this.parent.getWorldMatrix(),this.transformedDirection)),!0):!1}getDepthScale(){return 50}getShadowDirection(a){return this.transformedDirection?this.transformedDirection:this.direction}getAbsolutePosition(){return this.transformedPosition?this.transformedPosition:this.position}setDirectionToTarget(a){return this.direction=p$$module$libs$world_onscreen.Normalize(a.subtract(this.position)),this.direction}getRotation(){this.direction.normalize();const a=p$$module$libs$world_onscreen.Cross(this.direction,
ui$$module$libs$world_onscreen.Y),b=p$$module$libs$world_onscreen.Cross(a,this.direction);return p$$module$libs$world_onscreen.RotationFromAxis(a,b,this.direction)}needCube(){return!1}needProjectionMatrixCompute(){return this._needProjectionMatrixCompute}forceProjectionMatrixCompute(){this._needProjectionMatrixCompute=!0}_initCache(){super._initCache();this._cache.position=p$$module$libs$world_onscreen.Zero()}_isSynchronized(){return!!this._cache.position.equals(this.position)}computeWorldMatrix(a){return!a&&
this.isSynchronized()?(this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.copyFrom(this.position),this._worldMatrix||(this._worldMatrix=x$$module$libs$world_onscreen.Identity()),x$$module$libs$world_onscreen.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),
this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}getDepthMinZ(a){return void 0!==this.shadowMinZ?this.shadowMinZ:a.minZ}getDepthMaxZ(a){return void 0!==this.shadowMaxZ?this.shadowMaxZ:a.maxZ}setShadowProjectionMatrix(a,b,c){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(b,c,a):this._setDefaultShadowProjectionMatrix(a,b,c),this}_syncParentEnabledState(){super._syncParentEnabledState();this.parent&&this.parent.getWorldMatrix||(this.transformedPosition=null,this.transformedDirection=
null)}}T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen()],Wi$$module$libs$world_onscreen.prototype,"position",null);T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen()],Wi$$module$libs$world_onscreen.prototype,"direction",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Wi$$module$libs$world_onscreen.prototype,"shadowMinZ",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Wi$$module$libs$world_onscreen.prototype,"shadowMaxZ",null);
Xe$$module$libs$world_onscreen.AddNodeConstructor("Light_Type_1",(a,b)=>()=>new Pt$$module$libs$world_onscreen(a,p$$module$libs$world_onscreen.Zero(),b));
class Pt$$module$libs$world_onscreen extends Wi$$module$libs$world_onscreen{constructor(a,b,c){super(a,c);this._shadowFrustumSize=0;this._shadowOrthoScale=.1;this.autoUpdateExtends=!0;this.autoCalcShadowZBounds=!1;this._orthoLeft=Number.MAX_VALUE;this._orthoTop=this._orthoRight=Number.MIN_VALUE;this._orthoBottom=Number.MAX_VALUE;this.position=b.scale(-1);this.direction=b}get shadowFrustumSize(){return this._shadowFrustumSize}set shadowFrustumSize(a){this._shadowFrustumSize=a;this.forceProjectionMatrixCompute()}get shadowOrthoScale(){return this._shadowOrthoScale}set shadowOrthoScale(a){this._shadowOrthoScale=
a;this.forceProjectionMatrixCompute()}get orthoLeft(){return this._orthoLeft}set orthoLeft(a){this._orthoLeft=a}get orthoRight(){return this._orthoRight}set orthoRight(a){this._orthoRight=a}get orthoTop(){return this._orthoTop}set orthoTop(a){this._orthoTop=a}get orthoBottom(){return this._orthoBottom}set orthoBottom(a){this._orthoBottom=a}getClassName(){return"DirectionalLight"}getTypeID(){return he$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT}_setDefaultShadowProjectionMatrix(a,b,c){0<
this.shadowFrustumSize?this._setDefaultFixedFrustumShadowProjectionMatrix(a):this._setDefaultAutoExtendShadowProjectionMatrix(a,b,c)}_setDefaultFixedFrustumShadowProjectionMatrix(a){const b=this.getScene().activeCamera;b&&x$$module$libs$world_onscreen.OrthoLHToRef(this.shadowFrustumSize,this.shadowFrustumSize,void 0!==this.shadowMinZ?this.shadowMinZ:b.minZ,void 0!==this.shadowMaxZ?this.shadowMaxZ:b.maxZ,a,this.getScene().getEngine().isNDCHalfZRange)}_setDefaultAutoExtendShadowProjectionMatrix(a,b,
c){var d=this.getScene().activeCamera;if(d){if(this.autoUpdateExtends||this._orthoLeft===Number.MAX_VALUE){var e=p$$module$libs$world_onscreen.Zero();this._orthoLeft=Number.MAX_VALUE;this._orthoTop=this._orthoRight=Number.MIN_VALUE;var g=this._orthoBottom=Number.MAX_VALUE;let t=Number.MIN_VALUE;for(let w=0;w<c.length;w++){var n=c[w];if(n){n=n.getBoundingInfo().boundingBox;for(let z=0;z<n.vectorsWorld.length;z++)p$$module$libs$world_onscreen.TransformCoordinatesToRef(n.vectorsWorld[z],b,e),e.x<this._orthoLeft&&
(this._orthoLeft=e.x),e.y<this._orthoBottom&&(this._orthoBottom=e.y),e.x>this._orthoRight&&(this._orthoRight=e.x),e.y>this._orthoTop&&(this._orthoTop=e.y),this.autoCalcShadowZBounds&&(e.z<g&&(g=e.z),e.z>t&&(t=e.z))}}this.autoCalcShadowZBounds&&(this._shadowMinZ=g,this._shadowMaxZ=t)}b=this._orthoRight-this._orthoLeft;c=this._orthoTop-this._orthoBottom;e=void 0!==this.shadowMinZ?this.shadowMinZ:d.minZ;d=void 0!==this.shadowMaxZ?this.shadowMaxZ:d.maxZ;g=this.getScene().getEngine().useReverseDepthBuffer;
x$$module$libs$world_onscreen.OrthoOffCenterLHToRef(this._orthoLeft-b*this.shadowOrthoScale,this._orthoRight+b*this.shadowOrthoScale,this._orthoBottom-c*this.shadowOrthoScale,this._orthoTop+c*this.shadowOrthoScale,g?d:e,g?e:d,a,this.getScene().getEngine().isNDCHalfZRange)}}_buildUniformLayout(){this._uniformBuffer.addUniform("vLightData",4);this._uniformBuffer.addUniform("vLightDiffuse",4);this._uniformBuffer.addUniform("vLightSpecular",4);this._uniformBuffer.addUniform("shadowsInfo",3);this._uniformBuffer.addUniform("depthValues",
2);this._uniformBuffer.create()}transferToEffect(a,b){return this.computeTransformedInformation()?(this._uniformBuffer.updateFloat4("vLightData",this.transformedDirection.x,this.transformedDirection.y,this.transformedDirection.z,1,b),this):(this._uniformBuffer.updateFloat4("vLightData",this.direction.x,this.direction.y,this.direction.z,1,b),this)}transferToNodeMaterialEffect(a,b){return this.computeTransformedInformation()?(a.setFloat3(b,this.transformedDirection.x,this.transformedDirection.y,this.transformedDirection.z),
this):(a.setFloat3(b,this.direction.x,this.direction.y,this.direction.z),this)}getDepthMinZ(a){a=this._scene.getEngine();return!a.useReverseDepthBuffer&&a.isNDCHalfZRange?0:1}getDepthMaxZ(a){a=this._scene.getEngine();return a.useReverseDepthBuffer&&a.isNDCHalfZRange?0:1}prepareLightSpecificDefines(a,b){a["DIRLIGHT"+b]=!0}}T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Pt$$module$libs$world_onscreen.prototype,"shadowFrustumSize",null);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Pt$$module$libs$world_onscreen.prototype,"shadowOrthoScale",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Pt$$module$libs$world_onscreen.prototype,"autoUpdateExtends",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Pt$$module$libs$world_onscreen.prototype,"autoCalcShadowZBounds",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("orthoLeft")],Pt$$module$libs$world_onscreen.prototype,"_orthoLeft",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("orthoRight")],Pt$$module$libs$world_onscreen.prototype,"_orthoRight",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("orthoTop")],Pt$$module$libs$world_onscreen.prototype,"_orthoTop",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("orthoBottom")],Pt$$module$libs$world_onscreen.prototype,"_orthoBottom",void 0);Xe$$module$libs$world_onscreen.AddNodeConstructor("Light_Type_3",(a,b)=>()=>new us$$module$libs$world_onscreen(a,p$$module$libs$world_onscreen.Zero(),b));
class us$$module$libs$world_onscreen extends he$$module$libs$world_onscreen{constructor(a,b,c){super(a,c);this.groundColor=new se$$module$libs$world_onscreen(0,0,0);this.direction=b||p$$module$libs$world_onscreen.Up()}_buildUniformLayout(){this._uniformBuffer.addUniform("vLightData",4);this._uniformBuffer.addUniform("vLightDiffuse",4);this._uniformBuffer.addUniform("vLightSpecular",4);this._uniformBuffer.addUniform("vLightGround",3);this._uniformBuffer.addUniform("shadowsInfo",3);this._uniformBuffer.addUniform("depthValues",
2);this._uniformBuffer.create()}getClassName(){return"HemisphericLight"}setDirectionToTarget(a){return this.direction=p$$module$libs$world_onscreen.Normalize(a.subtract(p$$module$libs$world_onscreen.Zero())),this.direction}getShadowGenerator(){return null}transferToEffect(a,b){a=p$$module$libs$world_onscreen.Normalize(this.direction);return this._uniformBuffer.updateFloat4("vLightData",a.x,a.y,a.z,0,b),this._uniformBuffer.updateColor3("vLightGround",this.groundColor.scale(this.intensity),b),this}transferToNodeMaterialEffect(a,
b){const c=p$$module$libs$world_onscreen.Normalize(this.direction);return a.setFloat3(b,c.x,c.y,c.z),this}computeWorldMatrix(){return this._worldMatrix||(this._worldMatrix=x$$module$libs$world_onscreen.Identity()),this._worldMatrix}getTypeID(){return he$$module$libs$world_onscreen.LIGHTTYPEID_HEMISPHERICLIGHT}prepareLightSpecificDefines(a,b){a["HEMILIGHT"+b]=!0}}T$$module$libs$world_onscreen([di$$module$libs$world_onscreen()],us$$module$libs$world_onscreen.prototype,"groundColor",void 0);
T$$module$libs$world_onscreen([Gt$$module$libs$world_onscreen()],us$$module$libs$world_onscreen.prototype,"direction",void 0);
class Bt$$module$libs$world_onscreen{constructor(a,b){this.width=a;this.height=b}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let a=this.width|0;return a=397*a^(this.height|0),a}copyFrom(a){this.width=a.width;this.height=a.height}copyFromFloats(a,b){return this.width=a,this.height=b,this}set(a,b){return this.copyFromFloats(a,b)}multiplyByFloats(a,b){return new Bt$$module$libs$world_onscreen(this.width*a,this.height*b)}clone(){return new Bt$$module$libs$world_onscreen(this.width,
this.height)}equals(a){return a?this.width===a.width&&this.height===a.height:!1}get surface(){return this.width*this.height}static Zero(){return new Bt$$module$libs$world_onscreen(0,0)}add(a){return new Bt$$module$libs$world_onscreen(this.width+a.width,this.height+a.height)}subtract(a){return new Bt$$module$libs$world_onscreen(this.width-a.width,this.height-a.height)}static Lerp(a,b,c){return new Bt$$module$libs$world_onscreen(a.width+(b.width-a.width)*c,a.height+(b.height-a.height)*c)}}
class Jn$$module$libs$world_onscreen{constructor(a){this.wrapR=this._wrapV=this._wrapU=1;this.anisotropicFilteringLevel=4;this.delayLoadState=0;this._engine=this._texture=null;this._cachedSize=Bt$$module$libs$world_onscreen.Zero();this._cachedBaseSize=Bt$$module$libs$world_onscreen.Zero();this._initialSamplingMode=2;(this._texture=a)&&(this._engine=this._texture.getEngine())}get wrapU(){return this._wrapU}set wrapU(a){this._wrapU=a}get wrapV(){return this._wrapV}set wrapV(a){this._wrapV=a}get coordinatesMode(){return 0}get isCube(){return this._texture?
this._texture.isCube:!1}set isCube(a){this._texture&&(this._texture.isCube=a)}get is3D(){return this._texture?this._texture.is3D:!1}set is3D(a){this._texture&&(this._texture.is3D=a)}get is2DArray(){return this._texture?this._texture.is2DArray:!1}set is2DArray(a){this._texture&&(this._texture.is2DArray=a)}getClassName(){return"ThinTexture"}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):this._texture?this._texture.isReady:!1}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=
this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=
this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(a){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(a,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}
class Me$$module$libs$world_onscreen extends Jn$$module$libs$world_onscreen{constructor(a,b=null){super(null);this.reservedDataStore=this.metadata=null;this._getAlphaFromRGB=this._hasAlpha=!1;this.level=1;this._coordinatesIndex=0;this.optimizeUVAllocation=!0;this._coordinatesMode=0;this.wrapR=1;this.anisotropicFilteringLevel=Me$$module$libs$world_onscreen.DEFAULT_ANISOTROPIC_FILTERING_LEVEL;this._isCube=!1;this._gammaSpace=!0;this._forceSerialize=this._prefiltered=this.isRenderTarget=this.lodLevelInAlpha=
this.invertZ=!1;this.animations=[];this.onDisposeObservable=new w$$module$libs$world_onscreen;this._parentContainer=this._uid=this._scene=this._onDisposeObserver=null;this._loadingError=!1;a?Me$$module$libs$world_onscreen._IsScene(a)?this._scene=a:this._engine=a:this._scene=fe$$module$libs$world_onscreen.LastCreatedScene;this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine());this._texture=b;this._uid=null}set hasAlpha(a){this._hasAlpha!==
a&&(this._hasAlpha=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,b=>b.hasTexture(this)))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(a){this._getAlphaFromRGB!==a&&(this._getAlphaFromRGB=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,b=>b.hasTexture(this)))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(a){this._coordinatesIndex!==a&&(this._coordinatesIndex=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,b=>b.hasTexture(this)))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(a){this._coordinatesMode!==
a&&(this._coordinatesMode=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,b=>b.hasTexture(this)))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(a){this._wrapU=a}get wrapV(){return this._wrapV}set wrapV(a){this._wrapV=a}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(a){this._texture?this._texture.isCube=a:this._isCube=a}get is3D(){return this._texture?this._texture.is3D:!1}set is3D(a){this._texture&&(this._texture.is3D=
a)}get is2DArray(){return this._texture?this._texture.is2DArray:!1}set is2DArray(a){this._texture&&(this._texture.is2DArray=a)}get gammaSpace(){if(this._texture)null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace);else return this._gammaSpace;return this._texture._gammaSpace&&!this._texture._useSRGBBuffer}set gammaSpace(a){if(this._texture){if(this._texture._gammaSpace===a)return;this._texture._gammaSpace=a}else{if(this._gammaSpace===a)return;this._gammaSpace=a}this._markAllSubMeshesAsTexturesDirty()}get isRGBD(){return null!=
this._texture&&this._texture._isRGBD}set isRGBD(a){this._texture&&(this._texture._isRGBD=a)}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(a){this._texture&&(this._texture._lodGenerationOffset=a)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(a){this._texture&&(this._texture._lodGenerationScale=a)}get linearSpecularLOD(){return this._texture?this._texture._linearSpecularLOD:
!1}set linearSpecularLOD(a){this._texture&&(this._texture._linearSpecularLOD=a)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(a){this._texture&&(this._texture._irradianceTexture=a)}get uid(){return this._uid||(this._uid=Dr$$module$libs$world_onscreen()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(a){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver);this._onDisposeObserver=
this.onDisposeObservable.add(a)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}getScene(){return this._scene}_getEngine(){return this._engine}checkTransformsAreIdentical(a){return null!==a}getTextureMatrix(){return x$$module$libs$world_onscreen.IdentityReadOnly}getReflectionTextureMatrix(){return x$$module$libs$world_onscreen.IdentityReadOnly}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(a){}get canRescale(){return!1}_getFromCache(a,
b,c,d,e,g){var n=this._getEngine();if(!n)return null;const t=n._getUseSRGBBuffer(!!e,b);n=n.getLoadedTexturesCache();for(let w=0;w<n.length;w++){const z=n[w];if(!(void 0!==e&&t!==z._useSRGBBuffer||void 0!==d&&d!==z.invertY||z.url!==a||z.generateMipMaps!==!b||c&&c!==z.samplingMode||void 0!==g&&g!==z.isCube))return z.incrementReferences(),z}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&
void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const a=this.getScene();a&&a.markAllMaterialsAsDirty(1)}readPixels(a=0,b=0,c=null,d=!0,e=!1,g=0,n=0,t=Number.MAX_VALUE,w=Number.MAX_VALUE){if(!this._texture)return null;const z=this._getEngine();if(!z)return null;var C=this.getSize();let H=C.width;C=C.height;0!==b&&(H/=Math.pow(2,b),C/=Math.pow(2,b),H=Math.round(H),C=Math.round(C));t=Math.min(H,t);w=Math.min(C,w);try{return this._texture.isCube?z._readTexturePixels(this._texture,
t,w,a,b,c,d,e,g,n):z._readTexturePixels(this._texture,t,w,-1,b,c,d,e,g,n)}catch{return null}}_readPixelsSync(a=0,b=0,c=null,d=!0,e=!1){if(!this._texture)return null;var g=this.getSize();let n=g.width;g=g.height;const t=this._getEngine();if(!t)return null;0!=b&&(n/=Math.pow(2,b),g/=Math.pow(2,b),n=Math.round(n),g=Math.round(g));try{return this._texture.isCube?t._readTexturePixelsSync(this._texture,n,g,a,b,c,d,e):t._readTexturePixelsSync(this._texture,n,g,-1,b,c,d,e)}catch{return null}}get _lodTextureHigh(){return this._texture?
this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this);this._scene.removePendingData(this);var a=this._scene.textures.indexOf(this);if(0<=a&&this._scene.textures.splice(a,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer)a=this._parentContainer.textures.indexOf(this),
-1<a&&this._parentContainer.textures.splice(a,1),this._parentContainer=null}this.onDisposeObservable.notifyObservers(this);this.onDisposeObservable.clear();this.metadata=null;super.dispose()}serialize(a=!1){if(!this.name&&!a)return null;a=ae$$module$libs$world_onscreen.Serialize(this);return ae$$module$libs$world_onscreen.AppendSerializedAnimations(this,a),a}static WhenAllReady(a,b){let c=a.length;if(0===c)b();else for(let e=0;e<a.length;e++){var d=a[e];d.isReady()?0===--c&&b():(d=d.onLoadObservable)?
d.addOnce(()=>{0===--c&&b()}):0===--c&&b()}}static _IsScene(a){return"Scene"===a.getClassName()}}Me$$module$libs$world_onscreen.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4;T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"uniqueId",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"name",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"metadata",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("hasAlpha")],Me$$module$libs$world_onscreen.prototype,"_hasAlpha",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("getAlphaFromRGB")],Me$$module$libs$world_onscreen.prototype,"_getAlphaFromRGB",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"level",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("coordinatesIndex")],Me$$module$libs$world_onscreen.prototype,"_coordinatesIndex",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"optimizeUVAllocation",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("coordinatesMode")],Me$$module$libs$world_onscreen.prototype,"_coordinatesMode",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"wrapU",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"wrapV",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"wrapR",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"anisotropicFilteringLevel",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"isCube",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"is3D",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"is2DArray",null);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"gammaSpace",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"invertZ",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"lodLevelInAlpha",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"lodGenerationOffset",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"lodGenerationScale",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"linearSpecularLOD",null);
T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"irradianceTexture",null);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Me$$module$libs$world_onscreen.prototype,"isRenderTarget",void 0);
function Br$$module$libs$world_onscreen(a,b,c=!1){var d=b.width;b=b.height;if(a instanceof Float32Array){for(var e=a.byteLength/a.BYTES_PER_ELEMENT,g=new Uint8Array(e);0<=--e;){var n=a[e];0>n?n=0:1<n&&(n=1);g[e]=255*n}a=g}e=document.createElement("canvas");e.width=d;e.height=b;g=e.getContext("2d");if(!g)return null;n=g.createImageData(d,b);return(n.data.set(a),g.putImageData(n,0,0),c)?(a=document.createElement("canvas"),a.width=d,a.height=b,(d=a.getContext("2d"))?(d.translate(0,b),d.scale(1,-1),d.drawImage(e,
0,0),a.toDataURL("image/png")):null):e.toDataURL("image/png")}function ea$$module$libs$world_onscreen(a,b=0,c=0){const d=a.getInternalTexture();return d?(b=a._readPixelsSync(b,c))?Br$$module$libs$world_onscreen(b,a.getSize(),d.invertY):null:null}async function ta$$module$libs$world_onscreen(a,b=0,c=0){const d=a.getInternalTexture();return d?(b=await a.readPixels(b,c))?Br$$module$libs$world_onscreen(b,a.getSize(),d.invertY):null:null}
class B$$module$libs$world_onscreen extends Me$$module$libs$world_onscreen{constructor(a,b,c,d,e=B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE,g=null,n=null,t=null,w=!1,z,C,H,M,L){var O,S,T,P,W,Z,ca,ba,la;super(b);this.url=null;this.vOffset=this.uOffset=0;this.vScale=this.uScale=1;this.wAng=this.vAng=this.uAng=0;this.wRotationCenter=this.vRotationCenter=this.uRotationCenter=.5;this.homogeneousRotationInUVTransform=!1;this.inspectableCustomProperties=null;this._invertY=this._noMipmap=!1;this._t2=
this._t1=this._t0=this._projectionModeMatrix=this._cachedTextureMatrix=this._rowGenerationMatrix=null;this._cachedVOffset=this._cachedUOffset=-1;this._cachedVScale=this._cachedUScale=0;this._cachedWRotationCenter=this._cachedVRotationCenter=this._cachedURotationCenter=this._cachedReflectionProjectionMatrixId=this._cachedWAng=this._cachedVAng=this._cachedUAng=-1;this._cachedHomogeneousRotationInUVTransform=!1;this._cachedReflectionTextureMatrix=null;this._cachedReflectionVOffset=this._cachedReflectionUOffset=
-1;this._cachedReflectionVScale=this._cachedReflectionUScale=0;this._cachedReflectionCoordinatesMode=-1;this._buffer=null;this._deleteBuffer=!1;this._delayedOnError=this._delayedOnLoad=this._format=null;this.onLoadObservable=new w$$module$libs$world_onscreen;this._isBlocking=!0;this.name=a||"";this.url=a;let ea;a=!1;b=null;"object"==typeof c&&null!==c?(ea=null!==(O=c.noMipmap)&&void 0!==O?O:!1,d=null!==(S=c.invertY)&&void 0!==S?S:!ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV,e=null!==
(T=c.samplingMode)&&void 0!==T?T:B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE,g=null!==(P=c.onLoad)&&void 0!==P?P:null,n=null!==(W=c.onError)&&void 0!==W?W:null,t=null!==(Z=c.buffer)&&void 0!==Z?Z:null,w=null!==(ca=c.deleteBuffer)&&void 0!==ca?ca:!1,z=c.format,C=c.mimeType,H=c.loaderOptions,M=c.creationFlags,a=null!==(ba=c.useSRGBBuffer)&&void 0!==ba?ba:!1,b=null!==(la=c.internalTexture)&&void 0!==la?la:null):ea=!!c;this._noMipmap=ea;this._invertY=void 0===d?!ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV:
d;this._initialSamplingMode=e;this._buffer=t;this._deleteBuffer=w;this._mimeType=C;this._loaderOptions=H;this._creationFlags=M;this._useSRGBBuffer=a;this._forcedExtension=L;z&&(this._format=z);const oa=this.getScene();if(c=this._getEngine()){c.onBeforeTextureInitObservable.notifyObservers(this);var sa=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==
this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null));this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this);g&&g();!this.isBlocking&&oa&&oa.resetCachedMaterial()},xa=(ya,Ya)=>{this._loadingError=!0;this._errorObject={message:ya,exception:Ya};n&&n(ya,Ya);B$$module$libs$world_onscreen.OnTextureLoadErrorObservable.notifyObservers(this)};
if(this.url||b)if(this._texture=b??this._getFromCache(this.url,ea,e,this._invertY,a),this._texture)if(this._texture.isReady)ji$$module$libs$world_onscreen.SetImmediate(()=>sa());else{const ya=this._texture.onLoadedObservable.add(sa);this._texture.onErrorObservable.add(Ya=>{var Ja;xa(Ya.message,Ya.exception);null===(Ja=this._texture)||void 0===Ja||Ja.onLoadedObservable.remove(ya)})}else if(oa&&oa.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=sa,this._delayedOnError=xa;else{try{this._texture=
c.createTexture(this.url,ea,this._invertY,oa,e,sa,xa,this._buffer,void 0,this._format,this._forcedExtension,C,H,M,a)}catch(ya){throw xa("error loading",ya),ya;}w&&(this._buffer=null)}else this._delayedOnLoad=sa,this._delayedOnError=xa}}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(a){this._isBlocking=a}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}updateURL(a,b=null,c,d){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1));
this.name&&!this.name.startsWith("data:")||(this.name=a);this.url=a;this._buffer=b;this._forcedExtension=d;this.delayLoadState=4;c&&(this._delayedOnLoad=c);this.delayLoad()}delayLoad(){if(4===this.delayLoadState){var a=this.getScene();a&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer),this._texture?this._delayedOnLoad&&(this._texture.isReady?ji$$module$libs$world_onscreen.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):
(this._texture=a.getEngine().createTexture(this.url,this._noMipmap,this._invertY,a,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}}_prepareRowForTextureGeneration(a,b,c,d){a*=this._cachedUScale;b*=this._cachedVScale;a-=this.uRotationCenter*this._cachedUScale;b-=this.vRotationCenter*
this._cachedVScale;c-=this.wRotationCenter;p$$module$libs$world_onscreen.TransformCoordinatesFromFloatsToRef(a,b,c,this._rowGenerationMatrix,d);d.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset;d.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset;d.z+=this.wRotationCenter}checkTransformsAreIdentical(a){return null!==a&&this.uOffset===a.uOffset&&this.vOffset===a.vOffset&&this.uScale===a.uScale&&this.vScale===a.vScale&&this.uAng===a.uAng&&this.vAng===a.vAng&&this.wAng===a.wAng}getTextureMatrix(a=
1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*a===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;
this._cachedUOffset=this.uOffset;this._cachedVOffset=this.vOffset;this._cachedUScale=this.uScale*a;this._cachedVScale=this.vScale;this._cachedUAng=this.uAng;this._cachedVAng=this.vAng;this._cachedWAng=this.wAng;this._cachedURotationCenter=this.uRotationCenter;this._cachedVRotationCenter=this.vRotationCenter;this._cachedWRotationCenter=this.wRotationCenter;this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform;this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=
x$$module$libs$world_onscreen.Zero(),this._rowGenerationMatrix=new x$$module$libs$world_onscreen,this._t0=p$$module$libs$world_onscreen.Zero(),this._t1=p$$module$libs$world_onscreen.Zero(),this._t2=p$$module$libs$world_onscreen.Zero());x$$module$libs$world_onscreen.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix);this.homogeneousRotationInUVTransform?(x$$module$libs$world_onscreen.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,
D$$module$libs$world_onscreen.Matrix[0]),x$$module$libs$world_onscreen.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,D$$module$libs$world_onscreen.Matrix[1]),x$$module$libs$world_onscreen.ScalingToRef(this._cachedUScale,this._cachedVScale,0,D$$module$libs$world_onscreen.Matrix[2]),x$$module$libs$world_onscreen.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,D$$module$libs$world_onscreen.Matrix[3]),D$$module$libs$world_onscreen.Matrix[0].multiplyToRef(this._rowGenerationMatrix,
this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(D$$module$libs$world_onscreen.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(D$$module$libs$world_onscreen.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(D$$module$libs$world_onscreen.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,
0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),x$$module$libs$world_onscreen.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));return(a=this.getScene())?(this.optimizeUVAllocation&&a.markAllMaterialsAsDirty(1,b=>b.hasTexture(this)),this._cachedTextureMatrix):
this._cachedTextureMatrix}getReflectionTextureMatrix(){const a=this.getScene();if(!a)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode)if(this.coordinatesMode===B$$module$libs$world_onscreen.PROJECTION_MODE){if(this._cachedReflectionProjectionMatrixId===a.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}else return this._cachedReflectionTextureMatrix;
this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=x$$module$libs$world_onscreen.Zero());this._projectionModeMatrix||(this._projectionModeMatrix=x$$module$libs$world_onscreen.Zero());const b=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,
this.coordinatesMode){case B$$module$libs$world_onscreen.PLANAR_MODE:x$$module$libs$world_onscreen.IdentityToRef(this._cachedReflectionTextureMatrix);this._cachedReflectionTextureMatrix[0]=this.uScale;this._cachedReflectionTextureMatrix[5]=this.vScale;this._cachedReflectionTextureMatrix[12]=this.uOffset;this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case B$$module$libs$world_onscreen.PROJECTION_MODE:x$$module$libs$world_onscreen.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);
const c=a.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=c.updateFlag;c.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break;default:x$$module$libs$world_onscreen.IdentityToRef(this._cachedReflectionTextureMatrix)}return b&&a.markAllMaterialsAsDirty(1,c=>-1!==c.getActiveTextures().indexOf(this)),this._cachedReflectionTextureMatrix}clone(){const a={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,
buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return ae$$module$libs$world_onscreen.Clone(()=>new B$$module$libs$world_onscreen(this._texture?this._texture.url:null,this.getScene(),a),this)}serialize(){var a,b;const c=this.name;B$$module$libs$world_onscreen.SerializeBuffers||this.name.startsWith("data:")&&(this.name=
"");this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const d=super.serialize(B$$module$libs$world_onscreen._SerializeInternalTextureUniqueId);return d?((B$$module$libs$world_onscreen.SerializeBuffers||B$$module$libs$world_onscreen.ForceSerializeBuffers)&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(d.base64String=this._buffer,d.name=d.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?d.base64String="data:image/png;base64,"+
Ar$$module$libs$world_onscreen(this._buffer):(B$$module$libs$world_onscreen.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(d.base64String=!this._engine||this._engine._features.supportSyncTextureRead?ea$$module$libs$world_onscreen(this):ta$$module$libs$world_onscreen(this))),d.invertY=this._invertY,d.samplingMode=this.samplingMode,d._creationFlags=this._creationFlags,d._useSRGBBuffer=this._useSRGBBuffer,B$$module$libs$world_onscreen._SerializeInternalTextureUniqueId&&
(d.internalTextureUniqueId=null!==(b=null===(a=this._texture)||void 0===a?void 0:a.uniqueId)&&void 0!==b?b:void 0),this.name=c,d):null}getClassName(){return"Texture"}dispose(){super.dispose();this.onLoadObservable.clear();this._buffer=this._delayedOnError=this._delayedOnLoad=null}static Parse(a,b,c){if(a.customType){var d=Pi$$module$libs$world_onscreen.Instantiate(a.customType).Parse(a,b,c);return a.samplingMode&&d.updateSamplingMode&&d._samplingMode&&d._samplingMode!==a.samplingMode&&d.updateSamplingMode(a.samplingMode),
d}if(a.isCube&&!a.isRenderTarget)return B$$module$libs$world_onscreen._CubeTextureParser(a,b,c);const e=void 0!==a.internalTextureUniqueId;if(!a.name&&!a.isRenderTarget&&!e)return null;let g;if(e){d=b.getEngine().getLoadedTexturesCache();for(const t of d)if(t.uniqueId===a.internalTextureUniqueId){g=t;break}}const n=t=>{var w;if(t&&t._texture&&(t._texture._cachedWrapU=null,t._texture._cachedWrapV=null,t._texture._cachedWrapR=null),a.samplingMode){var z=a.samplingMode;t&&t.samplingMode!==z&&t.updateSamplingMode(z)}if(t&&
a.animations)for(z=0;z<a.animations.length;z++){const C=a.animations[z],H=ci$$module$libs$world_onscreen("BABYLON.Animation");H&&t.animations.push(H.Parse(C))}!e||g||null!==(w=null==t?void 0:t._texture)&&void 0!==w&&w._setUniqueId(a.internalTextureUniqueId)};return ae$$module$libs$world_onscreen.Parse(()=>{var t,w=!0;if(a.noMipmap&&(w=!1),a.mirrorPlane){var z=B$$module$libs$world_onscreen._CreateMirror(a.name,a.renderTargetSize,b,w);return z._waitingRenderList=a.renderList,z.mirrorPlane=xt$$module$libs$world_onscreen.FromArray(a.mirrorPlane),
n(z),z}if(a.isRenderTarget){var C=null;if(a.isCube){if(b.reflectionProbes)for(z=0;z<b.reflectionProbes.length;z++)if(w=b.reflectionProbes[z],w.name===a.name)return w.cubeTexture}else C=B$$module$libs$world_onscreen._CreateRenderTargetTexture(a.name,a.renderTargetSize,b,w,null!==(z=a._creationFlags)&&void 0!==z?z:0),C._waitingRenderList=a.renderList;return n(C),C}let H;if(a.base64String&&!g)H=B$$module$libs$world_onscreen.CreateFromBase64String(a.base64String,a.base64String,b,!w,a.invertY,a.samplingMode,
()=>{n(H)},null!==(C=a._creationFlags)&&void 0!==C?C:0,null!==(t=a._useSRGBBuffer)&&void 0!==t?t:!1),H.name=a.name;else{let M;a.name&&0<a.name.indexOf("://")?M=a.name:M=c+a.name;a.url&&(a.url.startsWith("data:")||B$$module$libs$world_onscreen.UseSerializedUrlIfAny)&&(M=a.url);H=new B$$module$libs$world_onscreen(M,b,{noMipmap:!w,invertY:a.invertY,samplingMode:a.samplingMode,onLoad:()=>{n(H)},internalTexture:g})}return H},a,b)}static CreateFromBase64String(a,b,c,d,e,g=B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE,
n=null,t=null,w=5,z){return new B$$module$libs$world_onscreen("data:"+b,c,d,e,g,n,t,a,!1,w,void 0,void 0,z)}static LoadFromDataString(a,b,c,d=!1,e,g=!0,n=B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE,t=null,w=null,z=5,C){return"data:"!==a.substr(0,5)&&(a="data:"+a),new B$$module$libs$world_onscreen(a,c,e,g,n,t,w,b,d,z,void 0,void 0,C)}}B$$module$libs$world_onscreen.SerializeBuffers=!0;B$$module$libs$world_onscreen.ForceSerializeBuffers=!1;
B$$module$libs$world_onscreen.OnTextureLoadErrorObservable=new w$$module$libs$world_onscreen;B$$module$libs$world_onscreen._SerializeInternalTextureUniqueId=!1;B$$module$libs$world_onscreen._CubeTextureParser=(a,b,c)=>{throw $$$module$libs$world_onscreen("CubeTexture");};B$$module$libs$world_onscreen._CreateMirror=(a,b,c,d)=>{throw $$$module$libs$world_onscreen("MirrorTexture");};
B$$module$libs$world_onscreen._CreateRenderTargetTexture=(a,b,c,d,e)=>{throw $$$module$libs$world_onscreen("RenderTargetTexture");};B$$module$libs$world_onscreen.NEAREST_SAMPLINGMODE=1;B$$module$libs$world_onscreen.NEAREST_NEAREST_MIPLINEAR=8;B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE=2;B$$module$libs$world_onscreen.LINEAR_LINEAR_MIPNEAREST=11;B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE=3;B$$module$libs$world_onscreen.LINEAR_LINEAR_MIPLINEAR=3;
B$$module$libs$world_onscreen.NEAREST_NEAREST_MIPNEAREST=4;B$$module$libs$world_onscreen.NEAREST_LINEAR_MIPNEAREST=5;B$$module$libs$world_onscreen.NEAREST_LINEAR_MIPLINEAR=6;B$$module$libs$world_onscreen.NEAREST_LINEAR=7;B$$module$libs$world_onscreen.NEAREST_NEAREST=1;B$$module$libs$world_onscreen.LINEAR_NEAREST_MIPNEAREST=9;B$$module$libs$world_onscreen.LINEAR_NEAREST_MIPLINEAR=10;B$$module$libs$world_onscreen.LINEAR_LINEAR=2;B$$module$libs$world_onscreen.LINEAR_NEAREST=12;
B$$module$libs$world_onscreen.EXPLICIT_MODE=0;B$$module$libs$world_onscreen.SPHERICAL_MODE=1;B$$module$libs$world_onscreen.PLANAR_MODE=2;B$$module$libs$world_onscreen.CUBIC_MODE=3;B$$module$libs$world_onscreen.PROJECTION_MODE=4;B$$module$libs$world_onscreen.SKYBOX_MODE=5;B$$module$libs$world_onscreen.INVCUBIC_MODE=6;B$$module$libs$world_onscreen.EQUIRECTANGULAR_MODE=7;B$$module$libs$world_onscreen.FIXED_EQUIRECTANGULAR_MODE=8;B$$module$libs$world_onscreen.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;
B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE=0;B$$module$libs$world_onscreen.WRAP_ADDRESSMODE=1;B$$module$libs$world_onscreen.MIRROR_ADDRESSMODE=2;B$$module$libs$world_onscreen.UseSerializedUrlIfAny=!1;T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"url",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"uOffset",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"vOffset",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"uScale",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"vScale",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"uAng",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"vAng",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"wAng",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"uRotationCenter",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"vRotationCenter",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"wRotationCenter",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"homogeneousRotationInUVTransform",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],B$$module$libs$world_onscreen.prototype,"isBlocking",null);st$$module$libs$world_onscreen("BABYLON.Texture",B$$module$libs$world_onscreen);
ae$$module$libs$world_onscreen._TextureParser=B$$module$libs$world_onscreen.Parse;
class ia$$module$libs$world_onscreen{constructor(a,b,c,d){this._textures=null;this._samples=1;this._attachments=null;this._depthStencilTextureWithStencil=this._generateDepthBuffer=this._generateStencilBuffer=!1;this._isMulti=a;this._isCube=b;this._size=c;this._engine=d;this._depthStencilTexture=null}get depthStencilTexture(){return this._depthStencilTexture}get depthStencilTextureWithStencil(){return this._depthStencilTextureWithStencil}get isCube(){return this._isCube}get isMulti(){return this._isMulti}get is2DArray(){return 0<this.layers}get size(){return this.width}get width(){return this._size.width||
this._size}get height(){return this._size.height||this._size}get layers(){return this._size.layers||0}get texture(){var a,b;return null!==(b=null===(a=this._textures)||void 0===a?void 0:a[0])&&void 0!==b?b:null}get textures(){return this._textures}get samples(){return this._samples}setSamples(a,b=!0,c=!1){if(this.samples===a&&!c)return a;b=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,a,b):this._engine.updateRenderTargetTextureSampleCount(this,a);return this._samples=
a,b}setTextures(a){Array.isArray(a)?this._textures=a:a?this._textures=[a]:this._textures=null}setTexture(a,b=0,c=!0){this._textures||(this._textures=[]);this._textures[b]&&c&&this._textures[b].dispose();this._textures[b]=a}createDepthStencilTexture(a=0,b=!0,c=!1,d=1,e=14){var g;return null===(g=this._depthStencilTexture)||void 0===g||g.dispose(),this._depthStencilTextureWithStencil=c,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:b,comparisonFunction:a,
generateStencil:c,isCube:this._isCube,samples:d,depthTextureFormat:e},this),this._depthStencilTexture}_shareDepth(a){this._depthStencilTexture&&(a._depthStencilTexture&&a._depthStencilTexture.dispose(),a._depthStencilTexture=this._depthStencilTexture,this._depthStencilTexture.incrementReferences())}_swapAndDie(a){this.texture&&this.texture._swapAndDie(a);this._textures=null;this.dispose(!0)}_cloneRenderTargetWrapper(){var a,b,c=null;if(this._isMulti){if((b=this.textures)&&0<b.length){var d=!1;var e=
b.length;var g=b[b.length-1]._source;g!==Oe$$module$libs$world_onscreen.Depth&&g!==Oe$$module$libs$world_onscreen.DepthStencil||(d=!0,e--);g=[];var n=[];for(a=0;a<e;++a)c=b[a],g.push(c.samplingMode),n.push(c.type);c=this._engine.createMultipleRenderTarget({width:this.width,height:this.height},{samplingModes:g,generateMipMaps:b[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:d,types:n,textureCount:e})}}else c={},
(c.generateDepthBuffer=this._generateDepthBuffer,c.generateMipMaps=null!==(e=null===(d=this.texture)||void 0===d?void 0:d.generateMipMaps)&&void 0!==e?e:!1,c.generateStencilBuffer=this._generateStencilBuffer,c.samplingMode=null===(g=this.texture)||void 0===g?void 0:g.samplingMode,c.type=null===(n=this.texture)||void 0===n?void 0:n.type,c.format=null===(a=this.texture)||void 0===a?void 0:a.format,this.isCube)?c=this._engine.createRenderTargetCubeTexture(this.width,c):(d={width:this.width,height:this.height,
layers:this.is2DArray?null===(b=this.texture)||void 0===b?void 0:b.depth:void 0},c=this._engine.createRenderTargetTexture(d,c)),c.texture.isReady=!0;return c}_swapRenderTargetWrapper(a){if(this._textures&&a._textures)for(let b=0;b<this._textures.length;++b)this._textures[b]._swapAndDie(a._textures[b],!1),a._textures[b].isReady=!0;this._depthStencilTexture&&a._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(a._depthStencilTexture),a._depthStencilTexture.isReady=!0);this._depthStencilTexture=
this._textures=null}_rebuild(){const a=this._cloneRenderTargetWrapper();if(a){if(this._depthStencilTexture){const b=this._depthStencilTexture.samplingMode;a.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,2===b||3===b||11===b,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples)}1<this.samples&&a.setSamples(this.samples);a._swapRenderTargetWrapper(this);a.dispose()}}releaseTextures(){var a,b;if(this._textures)for(let c=0;null!==(b=c<(null===(a=this._textures)||
void 0===a?void 0:a.length))&&void 0!==b&&b;++c)this._textures[c].dispose();this._textures=null}dispose(a=!1){var b;a||(null===(b=this._depthStencilTexture)||void 0===b||b.dispose(),this._depthStencilTexture=null,this.releaseTextures());this._engine._releaseRenderTargetWrapper(this)}}
class sa$$module$libs$world_onscreen extends ia$$module$libs$world_onscreen{constructor(a,b,c,d,e){super(a,b,c,d);this._depthStencilTextureArray=this._colorTextureArray=this._MSAAFramebuffer=this._depthStencilBuffer=this._framebuffer=null;this._context=e}_cloneRenderTargetWrapper(){let a=null;return this._colorTextureArray&&this._depthStencilTextureArray?(a=this._engine.createMultiviewRenderTargetTexture(this.width,this.height),a.texture.isReady=!0):a=super._cloneRenderTargetWrapper(),a}_swapRenderTargetWrapper(a){super._swapRenderTargetWrapper(a);
a._framebuffer=this._framebuffer;a._depthStencilBuffer=this._depthStencilBuffer;a._MSAAFramebuffer=this._MSAAFramebuffer;a._colorTextureArray=this._colorTextureArray;a._depthStencilTextureArray=this._depthStencilTextureArray;this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null}_shareDepth(a){super._shareDepth(a);const b=this._context,c=this._depthStencilBuffer,d=a._MSAAFramebuffer||a._framebuffer;a._depthStencilBuffer&&b.deleteRenderbuffer(a._depthStencilBuffer);
a._depthStencilBuffer=this._depthStencilBuffer;this._engine._bindUnboundFramebuffer(d);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,c);this._engine._bindUnboundFramebuffer(null)}_bindTextureRenderTarget(a,b=0,c=-1,d=0){if(a._hardwareTexture){var e=this._context,g=this._engine._currentFramebuffer;this._engine._bindUnboundFramebuffer(this._framebuffer);e.framebufferTexture2D(e.FRAMEBUFFER,e[1<this._engine.webGLVersion?"COLOR_ATTACHMENT"+b:"COLOR_ATTACHMENT"+b+"_WEBGL"],
-1!==c?e.TEXTURE_CUBE_MAP_POSITIVE_X+c:e.TEXTURE_2D,a._hardwareTexture.underlyingResource,d);this._engine._bindUnboundFramebuffer(g)}}setTexture(a,b=0,c=!0){super.setTexture(a,b,c);this._bindTextureRenderTarget(a,b)}dispose(a=!1){const b=this._context;a||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null));this._framebuffer&&
(b.deleteFramebuffer(this._framebuffer),this._framebuffer=null);this._depthStencilBuffer&&(b.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null);this._MSAAFramebuffer&&(b.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null);super.dispose(a)}}le$$module$libs$world_onscreen.prototype._createHardwareRenderTargetWrapper=function(a,b,c){a=new sa$$module$libs$world_onscreen(a,b,c,this,this._gl);return this._renderTargetWrapperCache.push(a),a};
le$$module$libs$world_onscreen.prototype.createRenderTargetTexture=function(a,b){var c,d;const e=this._createHardwareRenderTargetWrapper(!1,!1,a);let g=!0,n=!1;var t=!1,w;let z=1;void 0!==b&&"object"==typeof b&&(g=null!==(c=b.generateDepthBuffer)&&void 0!==c?c:!0,n=!!b.generateStencilBuffer,t=!!b.noColorAttachment,w=b.colorAttachment,z=null!==(d=b.samples)&&void 0!==d?d:1);b=w||(t?null:this._createInternalTexture(a,b,!0,Oe$$module$libs$world_onscreen.RenderTarget));c=a.width||a;a=a.height||a;d=this._currentFramebuffer;
t=this._gl;w=t.createFramebuffer();return this._bindUnboundFramebuffer(w),e._depthStencilBuffer=this._setupFramebufferDepthAttachments(n,g,c,a),b&&!b.is2DArray&&t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,b._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(d),e._framebuffer=w,e._generateDepthBuffer=g,e._generateStencilBuffer=n,e.setTextures(b),this.updateRenderTargetTextureSampleCount(e,z),e};
le$$module$libs$world_onscreen.prototype.createDepthStencilTexture=function(a,b,c){return b.isCube?this._createDepthStencilCubeTexture(a.width||a,b,c):this._createDepthStencilTexture(a,b,c)};
le$$module$libs$world_onscreen.prototype._createDepthStencilTexture=function(a,b,c){const d=this._gl;var e=a.layers||0;const g=0!==e?d.TEXTURE_2D_ARRAY:d.TEXTURE_2D,n=new Vt$$module$libs$world_onscreen(this,Oe$$module$libs$world_onscreen.DepthStencil);if(!this._caps.depthTextureExtension)return O$$module$libs$world_onscreen.Error("Depth texture is not supported by your browser or hardware."),n;b={bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1,...b};if(this._bindTextureDirectly(g,n,!0),
this._setupDepthStencilTexture(n,a,b.generateStencil,0===b.comparisonFunction?!1:b.bilinearFiltering,b.comparisonFunction,b.samples),void 0!==b.depthTextureFormat){if(15!==b.depthTextureFormat&&16!==b.depthTextureFormat&&17!==b.depthTextureFormat&&13!==b.depthTextureFormat&&14!==b.depthTextureFormat&&18!==b.depthTextureFormat)return O$$module$libs$world_onscreen.Error("Depth texture format is not supported."),n;n.format=b.depthTextureFormat}else n.format=b.generateStencil?13:16;b=17===n.format||13===
n.format||18===n.format;c._depthStencilTexture=n;c._depthStencilTextureWithStencil=b;a=d.UNSIGNED_INT;15===n.format?a=d.UNSIGNED_SHORT:17===n.format||13===n.format?a=d.UNSIGNED_INT_24_8:14===n.format?a=d.FLOAT:18===n.format&&(a=d.FLOAT_32_UNSIGNED_INT_24_8_REV);let t=b=b?d.DEPTH_STENCIL:d.DEPTH_COMPONENT;1<this.webGLVersion&&(15===n.format?t=d.DEPTH_COMPONENT16:16===n.format?t=d.DEPTH_COMPONENT24:17===n.format||13===n.format?t=d.DEPTH24_STENCIL8:14===n.format?t=d.DEPTH_COMPONENT32F:18===n.format&&
(t=d.DEPTH32F_STENCIL8));n.is2DArray?d.texImage3D(g,0,t,n.width,n.height,e,0,b,a,null):d.texImage2D(g,0,t,n.width,n.height,0,b,a,null);this._bindTextureDirectly(g,null);this._internalTexturesCache.push(n);c._depthStencilBuffer&&(e=this._currentFramebuffer,this._bindUnboundFramebuffer(c._framebuffer),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,null),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,null),d.framebufferRenderbuffer(d.FRAMEBUFFER,
d.STENCIL_ATTACHMENT,d.RENDERBUFFER,null),this._bindUnboundFramebuffer(e),d.deleteRenderbuffer(c._depthStencilBuffer),c._depthStencilBuffer=null);return n};
le$$module$libs$world_onscreen.prototype.updateRenderTargetTextureSampleCount=function(a,b){if(2>this.webGLVersion||!a||!a.texture)return 1;if(a.samples===b)return b;var c=this._gl;b=Math.min(b,this.getCaps().maxMSAASamples);a._depthStencilBuffer&&(c.deleteRenderbuffer(a._depthStencilBuffer),a._depthStencilBuffer=null);a._MSAAFramebuffer&&(c.deleteFramebuffer(a._MSAAFramebuffer),a._MSAAFramebuffer=null);const d=a.texture._hardwareTexture;if(d._MSAARenderBuffer&&(c.deleteRenderbuffer(d._MSAARenderBuffer),
d._MSAARenderBuffer=null),1<b&&c.renderbufferStorageMultisample){const e=c.createFramebuffer();if(!e)throw Error("Unable to create multi sampled framebuffer");a._MSAAFramebuffer=e;this._bindUnboundFramebuffer(a._MSAAFramebuffer);c=this._createRenderBuffer(a.texture.width,a.texture.height,b,-1,this._getRGBAMultiSampleBufferFormat(a.texture.type),c.COLOR_ATTACHMENT0,!1);if(!c)throw Error("Unable to create multi sampled framebuffer");d._MSAARenderBuffer=c}else this._bindUnboundFramebuffer(a._framebuffer);
return a.texture.samples=b,a._samples=b,a._depthStencilBuffer=this._setupFramebufferDepthAttachments(a._generateStencilBuffer,a._generateDepthBuffer,a.texture.width,a.texture.height,b),this._bindUnboundFramebuffer(null),b};
le$$module$libs$world_onscreen.prototype.createRenderTargetCubeTexture=function(a,b){const c=this._createHardwareRenderTargetWrapper(!1,!0,a);b={generateMipMaps:!0,generateDepthBuffer:!0,generateStencilBuffer:!1,type:0,samplingMode:3,format:5,...b};b.generateStencilBuffer=b.generateDepthBuffer&&b.generateStencilBuffer;(1===b.type&&!this._caps.textureFloatLinearFiltering||2===b.type&&!this._caps.textureHalfFloatLinearFiltering)&&(b.samplingMode=1);const d=this._gl,e=new Vt$$module$libs$world_onscreen(this,
Oe$$module$libs$world_onscreen.RenderTarget);this._bindTextureDirectly(d.TEXTURE_CUBE_MAP,e,!0);var g=this._getSamplingParameters(b.samplingMode,b.generateMipMaps);1===b.type&&!this._caps.textureFloat&&(b.type=0,O$$module$libs$world_onscreen.Warn("Float textures are not supported. Cube render target forced to TEXTURETYPE_UNESIGNED_BYTE type"));d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,g.mag);d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,g.min);d.texParameteri(d.TEXTURE_CUBE_MAP,
d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);for(g=0;6>g;g++)d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,this._getRGBABufferInternalSizedFormat(b.type,b.format),a,a,0,this._getInternalFormat(b.format),this._getWebGLTextureType(b.type),null);g=d.createFramebuffer();return this._bindUnboundFramebuffer(g),c._depthStencilBuffer=this._setupFramebufferDepthAttachments(b.generateStencilBuffer,b.generateDepthBuffer,a,a),b.generateMipMaps&&d.generateMipmap(d.TEXTURE_CUBE_MAP),
this._bindTextureDirectly(d.TEXTURE_CUBE_MAP,null),this._bindUnboundFramebuffer(null),c._framebuffer=g,c._generateDepthBuffer=b.generateDepthBuffer,c._generateStencilBuffer=b.generateStencilBuffer,e.width=a,e.height=a,e.isReady=!0,e.isCube=!0,e.samples=1,e.generateMipMaps=b.generateMipMaps,e.samplingMode=b.samplingMode,e.type=b.type,e.format=b.format,this._internalTexturesCache.push(e),c.setTextures(e),c};
const ra$$module$libs$world_onscreen="postprocessVertexShader",na$$module$libs$world_onscreen="attribute vec2 position;\nuniform vec2 scale;\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvUV=(position*madd+madd)*scale;\ngl_Position=vec4(position,0.0,1.0);\n#define CUSTOM_VERTEX_MAIN_END\n}";U$$module$libs$world_onscreen.ShadersStore[ra$$module$libs$world_onscreen]=na$$module$libs$world_onscreen;
const Ps$$module$libs$world_onscreen={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]};
class aa$$module$libs$world_onscreen{constructor(a,b=Ps$$module$libs$world_onscreen){var c,d;this._fullscreenViewport=new Oi$$module$libs$world_onscreen(0,0,1,1);const e=null!==(c=b.positions)&&void 0!==c?c:Ps$$module$libs$world_onscreen.positions,g=null!==(d=b.indices)&&void 0!==d?d:Ps$$module$libs$world_onscreen.indices;this.engine=a;this._vertexBuffers={[g$$module$libs$world_onscreen.PositionKind]:new g$$module$libs$world_onscreen(a,e,g$$module$libs$world_onscreen.PositionKind,!1,!1,2)};this._indexBuffer=
a.createIndexBuffer(g);this._onContextRestoredObserver=a.onContextRestoredObservable.add(()=>{this._indexBuffer=a.createIndexBuffer(g);for(const n in this._vertexBuffers)this._vertexBuffers[n]._rebuild()})}setViewport(a=this._fullscreenViewport){this.engine.setViewport(a)}bindBuffers(a){this.engine.bindBuffers(this._vertexBuffers,this._indexBuffer,a)}applyEffectWrapper(a){this.engine.setState(!0);this.engine.depthCullingState.depthTest=!1;this.engine.stencilState.stencilTest=!1;this.engine.enableEffect(a._drawWrapper);
this.bindBuffers(a.effect);a.onApplyObservable.notifyObservers({})}restoreStates(){this.engine.depthCullingState.depthTest=!0;this.engine.stencilState.stencilTest=!0}draw(){this.engine.drawElementsType(0,0,6)}_isRenderTargetTexture(a){return void 0!==a.renderTarget}render(a,b=null){a.effect.isReady()&&(this.setViewport(),(b=null===b?null:this._isRenderTargetTexture(b)?b.renderTarget:b)&&this.engine.bindFramebuffer(b),this.applyEffectWrapper(a),this.draw(),b&&this.engine.unBindFramebuffer(b),this.restoreStates())}dispose(){const a=
this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind];a&&(a.dispose(),delete this._vertexBuffers[g$$module$libs$world_onscreen.PositionKind]);this._indexBuffer&&this.engine._releaseBuffer(this._indexBuffer);this._onContextRestoredObserver&&(this.engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)}}
class oa$$module$libs$world_onscreen{constructor(a){this.onApplyObservable=new w$$module$libs$world_onscreen;let b;const c=a.uniformNames||[];a.vertexShader?b={fragmentSource:a.fragmentShader,vertexSource:a.vertexShader,spectorName:a.name||"effectWrapper"}:(c.push("scale"),b={fragmentSource:a.fragmentShader,vertex:"postprocess",spectorName:a.name||"effectWrapper"},this.onApplyObservable.add(()=>{this.effect.setFloat2("scale",1,1)}));const d=a.defines?a.defines.join("\n"):"";this._drawWrapper=new Ri$$module$libs$world_onscreen(a.engine);
a.useShaderStore?(b.fragment=b.fragmentSource,b.vertex||(b.vertex=b.vertexSource),delete b.fragmentSource,delete b.vertexSource,this.effect=a.engine.createEffect(b,a.attributeNames||["position"],c,a.samplerNames,d,void 0,a.onCompiled,void 0,void 0,a.shaderLanguage)):(this.effect=new De$$module$libs$world_onscreen(b,a.attributeNames||["position"],c,a.samplerNames,a.engine,d,void 0,a.onCompiled,void 0,void 0,void 0,a.shaderLanguage),this._onContextRestoredObserver=a.engine.onContextRestoredObservable.add(()=>
{this.effect._pipelineContext=null;this.effect._wasPreviouslyReady=!1;this.effect._prepareEffect()}))}get effect(){return this._drawWrapper.effect}set effect(a){this._drawWrapper.effect=a}dispose(){this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null);this.effect.dispose()}}const Ur$$module$libs$world_onscreen="passPixelShader",kr$$module$libs$world_onscreen="varying vec2 vUV;\nuniform sampler2D textureSampler;\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void) \n{\ngl_FragColor=texture2D(textureSampler,vUV);\n}";
U$$module$libs$world_onscreen.ShadersStore[Ur$$module$libs$world_onscreen]=kr$$module$libs$world_onscreen;const pr$$module$libs$world_onscreen={name:Ur$$module$libs$world_onscreen,shader:kr$$module$libs$world_onscreen};
class Qe$$module$libs$world_onscreen{static _CreateDumpRenderer(){if(!Qe$$module$libs$world_onscreen._DumpToolsEngine){const a=document.createElement("canvas"),b=new le$$module$libs$world_onscreen(a,!1,{preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1});b.getCaps().parallelShaderCompile=void 0;const c=new aa$$module$libs$world_onscreen(b),d=new oa$$module$libs$world_onscreen({engine:b,name:pr$$module$libs$world_onscreen.name,
fragmentShader:pr$$module$libs$world_onscreen.shader,samplerNames:["textureSampler"]});Qe$$module$libs$world_onscreen._DumpToolsEngine={canvas:a,engine:b,renderer:c,wrapper:d}}return Qe$$module$libs$world_onscreen._DumpToolsEngine}static async DumpFramebuffer(a,b,c,d,e="image/png",g){c=await c.readPixels(0,0,a,b);c=new Uint8Array(c.buffer);Qe$$module$libs$world_onscreen.DumpData(a,b,c,d,e,g,!0)}static DumpDataAsync(a,b,c,d="image/png",e,g=!1,n=!1,t){return new Promise(w=>{Qe$$module$libs$world_onscreen.DumpData(a,
b,c,z=>w(z),d,e,g,n,t)})}static DumpData(a,b,c,d,e="image/png",g,n=!1,t=!1,w){const z=Qe$$module$libs$world_onscreen._CreateDumpRenderer();if(z.engine.setSize(a,b,!0),c instanceof Float32Array){const C=new Uint8Array(c.length);let H=c.length;for(;H--;){const M=c[H];C[H]=0>M?0:1<M?1:Math.round(255*M)}c=C}a=z.engine.createRawTexture(c,a,b,5,!1,!n,1);z.renderer.setViewport();z.renderer.applyEffectWrapper(z.wrapper);z.wrapper.effect._bindTexture("textureSampler",a);z.renderer.draw();t?X$$module$libs$world_onscreen.ToBlob(z.canvas,
C=>{const H=new FileReader;H.onload=M=>{M=M.target.result;d&&d(M)};H.readAsArrayBuffer(C)},e,w):X$$module$libs$world_onscreen.EncodeScreenshotCanvasData(z.canvas,d,e,g,w);a.dispose()}static Dispose(){Qe$$module$libs$world_onscreen._DumpToolsEngine&&(Qe$$module$libs$world_onscreen._DumpToolsEngine.wrapper.dispose(),Qe$$module$libs$world_onscreen._DumpToolsEngine.renderer.dispose(),Qe$$module$libs$world_onscreen._DumpToolsEngine.engine.dispose());Qe$$module$libs$world_onscreen._DumpToolsEngine=null}}
const ha$$module$libs$world_onscreen=()=>{X$$module$libs$world_onscreen.DumpData=Qe$$module$libs$world_onscreen.DumpData;X$$module$libs$world_onscreen.DumpDataAsync=Qe$$module$libs$world_onscreen.DumpDataAsync;X$$module$libs$world_onscreen.DumpFramebuffer=Qe$$module$libs$world_onscreen.DumpFramebuffer};ha$$module$libs$world_onscreen();
class _t$$module$libs$world_onscreen extends B$$module$libs$world_onscreen{constructor(a,b,c,d=!1,e=!0,g=0,n=!1,t=B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE,w=!0,z=!1,C=!1,H=5,M=!1,L,O,S=!1,T=!1){var P,W,Z,ca,ba,la;if("object"==typeof d){var ea=d;d=!!ea.generateMipMaps;e=null!==(P=ea.doNotChangeAspectRatio)&&void 0!==P?P:!0;g=null!==(W=ea.type)&&void 0!==W?W:0;n=!!ea.isCube;t=null!==(Z=ea.samplingMode)&&void 0!==Z?Z:B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE;w=null!==(ca=ea.generateDepthBuffer)&&
void 0!==ca?ca:!0;z=!!ea.generateStencilBuffer;C=!!ea.isMulti;H=null!==(ba=ea.format)&&void 0!==ba?ba:5;M=!!ea.delayAllocation;L=ea.samples;O=ea.creationFlags;S=!!ea.noColorAttachment;T=!!ea.useSRGBBuffer;ea=ea.colorAttachment}if(super(null,c,!d,void 0,t,void 0,void 0,void 0,void 0,H),this._unObserveRenderList=null,this._renderListHasChanged=(oa,sa)=>{var xa;oa=this._renderList?this._renderList.length:0;(0===sa&&0<oa||0===oa)&&(null===(xa=this.getScene())||void 0===xa||xa.meshes.forEach(ya=>{ya._markSubMeshesAsLightDirty()}))},
this.renderParticles=!0,this.renderSprites=!1,this.forceLayerMaskCheck=!1,this.ignoreCameraViewport=!1,this.onBeforeBindObservable=new w$$module$libs$world_onscreen,this.onAfterUnbindObservable=new w$$module$libs$world_onscreen,this.onBeforeRenderObservable=new w$$module$libs$world_onscreen,this.onAfterRenderObservable=new w$$module$libs$world_onscreen,this.onClearObservable=new w$$module$libs$world_onscreen,this.onResizeObservable=new w$$module$libs$world_onscreen,this._cleared=!1,this.skipInitialClear=
!1,this._currentRefreshId=-1,this._refreshRate=1,this._samples=1,this._canRescale=!0,this._renderTarget=null,this.boundingBoxPosition=p$$module$libs$world_onscreen.Zero(),c=this.getScene(),c)t=this.getScene().getEngine(),this._coordinatesMode=B$$module$libs$world_onscreen.PROJECTION_MODE,this.renderList=[],this.name=a,this.isRenderTarget=!0,this._initialSizeParameter=b,this._renderPassIds=[],this._isCubeData=n,this._processSizeParameter(b),this.renderPassId=this._renderPassIds[0],this._resizeObserver=
t.onResizeObservable.add(()=>{}),this._generateMipMaps=!!d,this._doNotChangeAspectRatio=e,this._renderingManager=new ze$$module$libs$world_onscreen(c),this._renderingManager._useSceneAutoClearSetup=!0,!C&&(this._renderTargetOptions={generateMipMaps:d,type:g,format:null!==(la=this._format)&&void 0!==la?la:void 0,samplingMode:this.samplingMode,generateDepthBuffer:w,generateStencilBuffer:z,samples:L,creationFlags:O,noColorAttachment:S,useSRGBBuffer:T,colorAttachment:ea},this.samplingMode===B$$module$libs$world_onscreen.NEAREST_SAMPLINGMODE&&
(this.wrapU=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE,this.wrapV=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE),M||(n?(this._renderTarget=c.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions),this.coordinatesMode=B$$module$libs$world_onscreen.INVCUBIC_MODE,this._textureMatrix=x$$module$libs$world_onscreen.Identity()):this._renderTarget=c.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,
void 0!==L&&(this.samples=L)))}get renderList(){return this._renderList}set renderList(a){this._unObserveRenderList&&(this._unObserveRenderList(),this._unObserveRenderList=null);a&&(this._unObserveRenderList=br$$module$libs$world_onscreen(a,this._renderListHasChanged));this._renderList=a}get postProcesses(){return this._postProcesses}get _prePassEnabled(){return!!this._prePassRenderTarget&&this._prePassRenderTarget.enabled}set onAfterUnbind(a){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver);
this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(a)}set onBeforeRender(a){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver);this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(a)}set onAfterRender(a){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver);this._onAfterRenderObserver=this.onAfterRenderObservable.add(a)}set onClear(a){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver);
this._onClearObserver=this.onClearObservable.add(a)}get renderPassIds(){return this._renderPassIds}get currentRefreshId(){return this._currentRefreshId}setMaterialForRendering(a,b){let c;Array.isArray(a)?c=a:c=[a];for(a=0;a<c.length;++a)for(let d=0;d<this._renderPassIds.length;++d)c[a].setMaterialForRenderPass(this._renderPassIds[d],void 0!==b?Array.isArray(b)?b[d]:b:void 0)}get renderTargetOptions(){return this._renderTargetOptions}get renderTarget(){return this._renderTarget}_onRatioRescale(){this._sizeRatio&&
this.resize(this._initialSizeParameter)}set boundingBoxSize(a){this._boundingBoxSize&&this._boundingBoxSize.equals(a)||(this._boundingBoxSize=a,(a=this.getScene())&&a.markAllMaterialsAsDirty(1))}get boundingBoxSize(){return this._boundingBoxSize}get depthStencilTexture(){var a,b;return null!==(b=null===(a=this._renderTarget)||void 0===a?void 0:a._depthStencilTexture)&&void 0!==b?b:null}createDepthStencilTexture(a=0,b=!0,c=!1,d=1,e=14){var g;null===(g=this._renderTarget)||void 0===g||g.createDepthStencilTexture(a,
b,c,d,e)}_releaseRenderPassId(){if(this._scene){const a=this._scene.getEngine();for(let b=0;b<this._renderPassIds.length;++b)a.releaseRenderPassId(this._renderPassIds[b])}this._renderPassIds=[]}_createRenderPassId(){this._releaseRenderPassId();const a=this._scene.getEngine(),b=this._isCubeData?6:this.getRenderLayers()||1;for(let c=0;c<b;++c)this._renderPassIds[c]=a.createRenderPassId(`RenderTargetTexture - ${this.name}#${c}`)}_processSizeParameter(a){a.ratio?(this._sizeRatio=a.ratio,a=this._getEngine(),
this._size={width:this._bestReflectionRenderTargetDimension(a.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(a.getRenderHeight(),this._sizeRatio)}):this._size=a;this._createRenderPassId()}get samples(){var a,b;return null!==(b=null===(a=this._renderTarget)||void 0===a?void 0:a.samples)&&void 0!==b?b:this._samples}set samples(a){this._renderTarget&&(this._samples=this._renderTarget.setSamples(a))}resetRefreshCounter(){this._currentRefreshId=-1}get refreshRate(){return this._refreshRate}set refreshRate(a){this._refreshRate=
a;this.resetRefreshCounter()}addPostProcess(a){if(!this._postProcessManager){const b=this.getScene();if(!b)return;this._postProcessManager=new ts$$module$libs$world_onscreen(b);this._postProcesses=[]}this._postProcesses.push(a);this._postProcesses[0].autoClear=!1}clearPostProcesses(a=!1){if(this._postProcesses){if(a)for(const b of this._postProcesses)b.dispose();this._postProcesses=[]}}removePostProcess(a){this._postProcesses&&(a=this._postProcesses.indexOf(a),-1!==a&&(this._postProcesses.splice(a,
1),0<this._postProcesses.length&&(this._postProcesses[0].autoClear=!1)))}_shouldRender(){return-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)}getRenderSize(){return this.getRenderWidth()}getRenderWidth(){return this._size.width?this._size.width:this._size}getRenderHeight(){return this._size.width?this._size.height:this._size}getRenderLayers(){return this._size.layers||0}disableRescaling(){this._canRescale=
!1}get canRescale(){return this._canRescale}scale(a){a=Math.max(1,this.getRenderSize()*a);this.resize(a)}getReflectionTextureMatrix(){return this.isCube?this._textureMatrix:super.getReflectionTextureMatrix()}resize(a){var b;const c=this.isCube;null===(b=this._renderTarget)||void 0===b||b.dispose();this._renderTarget=null;(b=this.getScene())&&(this._processSizeParameter(a),c?this._renderTarget=b.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):this._renderTarget=
b.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,void 0!==this._renderTargetOptions.samples&&(this.samples=this._renderTargetOptions.samples),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))}render(a=!1,b=!1){this._render(a,b)}isReadyForRendering(){return this._render(!1,!1,!0)}_render(a=!1,b=!1,c=!1){var d;const e=this.getScene();if(!e)return c;const g=e.getEngine();if(void 0!==this.useCameraPostProcesses&&
(a=this.useCameraPostProcesses),this._waitingRenderList){this.renderList=[];for(var n=0;n<this._waitingRenderList.length;n++){var t=e.getMeshById(this._waitingRenderList[n]);t&&this.renderList.push(t)}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];n=this.getScene();if(!n)return c;n=n.meshes;for(t=0;t<n.length;t++){var w=n[t];this.renderListPredicate(w)&&this.renderList.push(w)}}n=g.currentRenderPassId;this.onBeforeBindObservable.notifyObservers(this);
w=null!==(d=this.activeCamera)&&void 0!==d?d:e.activeCamera;d=e.activeCamera;w&&(w!==e.activeCamera&&(e.setTransformMatrix(w.getViewMatrix(),w.getProjectionMatrix(!0)),e.activeCamera=w),g.setViewport(w.viewport,this.getRenderWidth(),this.getRenderHeight()));this._defaultRenderListPrepared=!1;if(t=c)for(e.getViewMatrix()||e.updateTransformMatrix(),a=this.is2DArray?this.getRenderLayers():this.isCube?6:1,b=0;b<a&&t;b++){w=null;var z=this.renderList?this.renderList:e.getActiveMeshes().data,C=this.renderList?
this.renderList.length:e.getActiveMeshes().length;g.currentRenderPassId=this._renderPassIds[b];this.onBeforeRenderObservable.notifyObservers(b);this.getCustomRenderList&&(w=this.getCustomRenderList(b,z,C));w||=z;this._doNotChangeAspectRatio||e.updateTransformMatrix(!0);for(z=0;z<w.length&&t;++z)C=w[z],C.isEnabled()&&!C.isBlocked&&C.isVisible&&C.subMeshes&&(this.customIsReadyFunction?this.customIsReadyFunction(C,this.refreshRate,c)||(t=!1):C.isReady(!0)||(t=!1));this.onAfterRenderObservable.notifyObservers(b);
(this.is2DArray||this.isCube)&&(e.incrementRenderId(),e.resetCachedMaterial())}else if(this.is2DArray)for(c=0;c<this.getRenderLayers();c++)this._renderToTarget(0,a,b,c,w),e.incrementRenderId(),e.resetCachedMaterial();else if(this.isCube)for(c=0;6>c;c++)this._renderToTarget(c,a,b,void 0,w),e.incrementRenderId(),e.resetCachedMaterial();else this._renderToTarget(0,a,b,void 0,w);return this.onAfterUnbindObservable.notifyObservers(this),g.currentRenderPassId=n,d&&(e.activeCamera=d,(1<e.getEngine().scenes.length||
this.activeCamera&&this.activeCamera!==e.activeCamera)&&e.setTransformMatrix(e.activeCamera.getViewMatrix(),e.activeCamera.getProjectionMatrix(!0)),g.setViewport(e.activeCamera.viewport)),e.resetCachedMaterial(),t}_bestReflectionRenderTargetDimension(a,b){b*=a;b=I$$module$libs$world_onscreen.NearestPOT(b+16384/(128+b));return Math.min(I$$module$libs$world_onscreen.FloorPOT(a),b)}_prepareRenderingManager(a,b,c,d){const e=this.getScene();if(e){this._renderingManager.reset();var g=e.getRenderId();for(let t=
0;t<b;t++){var n=a[t];if(n&&!n.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(n,this.refreshRate,!1)){this.resetRefreshCounter();continue}}else if(!n.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}if(!n._internalAbstractMeshDataInfo._currentLODIsUpToDate&&e.activeCamera&&(n._internalAbstractMeshDataInfo._currentLOD=e.customLODSelector?e.customLODSelector(n,this.activeCamera||e.activeCamera):n.getLOD(this.activeCamera||e.activeCamera),n._internalAbstractMeshDataInfo._currentLODIsUpToDate=
!0),!n._internalAbstractMeshDataInfo._currentLOD)continue;let w=n._internalAbstractMeshDataInfo._currentLOD;w._preActivateForIntermediateRendering(g);let z;if(d&&c?z=0===(n.layerMask&c.layerMask):z=!1,n.isEnabled()&&n.isVisible&&n.subMeshes&&!z&&(w!==n&&w._activate(g,!0),n._activate(g,!0)&&n.subMeshes.length))for(n.isAnInstance?n._internalAbstractMeshDataInfo._actAsRegularMesh&&(w=n):w._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,w._internalAbstractMeshDataInfo._isActiveIntermediate=
!0,n=0;n<w.subMeshes.length;n++)this._renderingManager.dispatch(w.subMeshes[n],w)}}for(b=0;b<e.particleSystems.length;b++)c=e.particleSystems[b],d=c.emitter,!(c.isStarted()&&d&&d.position&&d.isEnabled())||0<=a.indexOf(d)&&this._renderingManager.dispatchParticles(c)}}_bindFrameBuffer(a=0,b=0){var c=this.getScene();c&&(c=c.getEngine(),this._renderTarget&&c.bindFramebuffer(this._renderTarget,this.isCube?a:void 0,void 0,void 0,this.ignoreCameraViewport,0,b))}_unbindFrameBuffer(a,b){this._renderTarget&&
a.unBindFramebuffer(this._renderTarget,this.isCube,()=>{this.onAfterRenderObservable.notifyObservers(b)})}_prepareFrame(a,b,c,d){this._postProcessManager?!this._prePassEnabled&&this._postProcessManager._prepareFrame(this._texture,this._postProcesses):d&&a.postProcessManager._prepareFrame(this._texture)||this._bindFrameBuffer(b,c)}_renderToTarget(a,b,c,d=0,e=null){var g,n,t,w,z,C;const H=this.getScene();if(H){var M=H.getEngine();if(null===(g=M._debugPushGroup)||void 0===g||g.call(M,`render to face #${a} layer #${d}`,
1),this._prepareFrame(H,a,d,b),this.is2DArray?(M.currentRenderPassId=this._renderPassIds[d],this.onBeforeRenderObservable.notifyObservers(d)):(M.currentRenderPassId=this._renderPassIds[a],this.onBeforeRenderObservable.notifyObservers(a)),M.snapshotRendering&&1===M.snapshotRenderingMode)this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(M):this.skipInitialClear||M.clear(this.clearColor||H.clearColor,!0,!0,!0);else{g=null;const L=this.renderList?this.renderList:H.getActiveMeshes().data,
O=this.renderList?this.renderList.length:H.getActiveMeshes().length;this.getCustomRenderList&&(g=this.getCustomRenderList(this.is2DArray?d:a,L,O));g?this._prepareRenderingManager(g,g.length,e,this.forceLayerMaskCheck):(this._defaultRenderListPrepared||(this._prepareRenderingManager(L,O,e,!this.renderList||this.forceLayerMaskCheck),this._defaultRenderListPrepared=!0),g=L);for(const S of H._beforeRenderTargetClearStage)S.action(this,a,d);this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(M):
this.skipInitialClear||M.clear(this.clearColor||H.clearColor,!0,!0,!0);this._doNotChangeAspectRatio||H.updateTransformMatrix(!0);for(const S of H._beforeRenderTargetDrawStage)S.action(this,a,d);this._renderingManager.render(this.customRenderFunction,g,this.renderParticles,this.renderSprites);for(const S of H._afterRenderTargetDrawStage)S.action(this,a,d);e=null!==(t=null===(n=this._texture)||void 0===n?void 0:n.generateMipMaps)&&void 0!==t?t:!1;this._texture&&(this._texture.generateMipMaps=!1);this._postProcessManager?
this._postProcessManager._finalizeFrame(!1,null!==(w=this._renderTarget)&&void 0!==w?w:void 0,a,this._postProcesses,this.ignoreCameraViewport):b&&H.postProcessManager._finalizeFrame(!1,null!==(z=this._renderTarget)&&void 0!==z?z:void 0,a);for(const S of H._afterRenderTargetPostProcessStage)S.action(this,a,d);this._texture&&(this._texture.generateMipMaps=e);this._doNotChangeAspectRatio||H.updateTransformMatrix(!0);c&&Qe$$module$libs$world_onscreen.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),
M)}this._unbindFrameBuffer(M,a);this._texture&&this.isCube&&5===a&&M.generateMipMapsForCubemap(this._texture);null===(C=M._debugPopGroup)||void 0===C||C.call(M,1)}}setRenderingOrder(a,b=null,c=null,d=null){this._renderingManager.setRenderingOrder(a,b,c,d)}setRenderingAutoClearDepthStencil(a,b){this._renderingManager.setRenderingAutoClearDepthStencil(a,b);this._renderingManager._useSceneAutoClearSetup=!1}clone(){var a=this.getSize();a=new _t$$module$libs$world_onscreen(this.name,a,this.getScene(),
this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer,void 0,this._renderTargetOptions.format,void 0,this._renderTargetOptions.samples);return a.hasAlpha=this.hasAlpha,a.level=this.level,a.coordinatesMode=this.coordinatesMode,this.renderList&&(a.renderList=this.renderList.slice(0)),a}serialize(){if(!this.name)return null;
const a=super.serialize();if(a.renderTargetSize=this.getRenderSize(),a.renderList=[],this.renderList)for(let b=0;b<this.renderList.length;b++)a.renderList.push(this.renderList[b].id);return a}disposeFramebufferObjects(){var a;null===(a=this._renderTarget)||void 0===a||a.dispose(!0)}releaseInternalTexture(){var a;null===(a=this._renderTarget)||void 0===a||a.releaseTextures();this._texture=null}dispose(){var a;this.onResizeObservable.clear();this.onClearObservable.clear();this.onAfterRenderObservable.clear();
this.onAfterUnbindObservable.clear();this.onBeforeBindObservable.clear();this.onBeforeRenderObservable.clear();this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null);this._prePassRenderTarget&&this._prePassRenderTarget.dispose();this._releaseRenderPassId();this.clearPostProcesses(!0);this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null);this.renderList=null;const b=this.getScene();if(b){var c=
b.customRenderTargets.indexOf(this);0<=c&&b.customRenderTargets.splice(c,1);for(const d of b.cameras)c=d.customRenderTargets.indexOf(this),0<=c&&d.customRenderTargets.splice(c,1);null===(a=this._renderTarget)||void 0===a||a.dispose();this._texture=this._renderTarget=null;super.dispose()}}_rebuild(){this.refreshRate===_t$$module$libs$world_onscreen.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=_t$$module$libs$world_onscreen.REFRESHRATE_RENDER_ONCE);this._postProcessManager&&this._postProcessManager._rebuild()}freeRenderingGroups(){this._renderingManager&&
this._renderingManager.freeRenderingGroups()}getViewCount(){return 1}}_t$$module$libs$world_onscreen.REFRESHRATE_RENDER_ONCE=0;_t$$module$libs$world_onscreen.REFRESHRATE_RENDER_ONEVERYFRAME=1;_t$$module$libs$world_onscreen.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2;B$$module$libs$world_onscreen._CreateRenderTargetTexture=(a,b,c,d,e)=>new _t$$module$libs$world_onscreen(a,b,c,d);
class Se$$module$libs$world_onscreen{constructor(a,b,c,d,e,g,n=1,t,w,z=null,C=0,H="postprocess",M,L=!1,O=5,S=Ke$$module$libs$world_onscreen.GLSL){this._parentContainer=null;this.height=this.width=-1;this._outputTexture=this.nodeMaterialSource=null;this.autoClear=!0;this.alphaMode=0;this.animations=[];this.enablePixelPerfectMode=!1;this.forceFullscreenViewport=!0;this.scaleMode=1;this.alwaysForcePOT=!1;this._samples=1;this._reusable=this.adaptScaleToCurrentViewport=!1;this._renderId=0;this.externalTextureSamplerBinding=
!1;this._textures=new $e$$module$libs$world_onscreen(2);this._textureCache=[];this._currentRenderTextureInd=0;this._scaleRatio=new Te$$module$libs$world_onscreen(1,1);this._texelSize=Te$$module$libs$world_onscreen.Zero();this.onActivateObservable=new w$$module$libs$world_onscreen;this.onSizeChangedObservable=new w$$module$libs$world_onscreen;this.onApplyObservable=new w$$module$libs$world_onscreen;this.onBeforeRenderObservable=new w$$module$libs$world_onscreen;this.onAfterRenderObservable=new w$$module$libs$world_onscreen;
this.name=a;null!=g?(this._camera=g,this._scene=g.getScene(),g.attachPostProcess(this),this._engine=this._scene.getEngine(),this._scene.postProcesses.push(this),this.uniqueId=this._scene.getUniqueId()):t&&(this._engine=t,this._engine.postProcesses.push(this));this._options=e;this.renderTargetSamplingMode=n||1;this._reusable=w||!1;this._textureType=C;this._textureFormat=O;this._shaderLanguage=S;this._samplers=d||[];this._samplers.push("textureSampler");this._fragmentUrl=b;this._vertexUrl=H;this._parameters=
c||[];this._parameters.push("scale");this._indexParameters=M;this._drawWrapper=new Ri$$module$libs$world_onscreen(this._engine);L||this.updateEffect(z)}static RegisterShaderCodeProcessing(a,b){b?Se$$module$libs$world_onscreen._CustomShaderCodeProcessing[a??""]=b:delete Se$$module$libs$world_onscreen._CustomShaderCodeProcessing[a??""]}static _GetShaderCodeProcessing(a){var b;return null!==(b=Se$$module$libs$world_onscreen._CustomShaderCodeProcessing[a])&&void 0!==b?b:Se$$module$libs$world_onscreen._CustomShaderCodeProcessing[""]}get samples(){return this._samples}set samples(a){this._samples=
Math.min(a,this._engine.getCaps().maxMSAASamples);this._textures.forEach(b=>{b.setSamples(this._samples)})}getEffectName(){return this._fragmentUrl}set onActivate(a){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver);a&&(this._onActivateObserver=this.onActivateObservable.add(a))}set onSizeChanged(a){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver);this._onSizeChangedObserver=this.onSizeChangedObservable.add(a)}set onApply(a){this._onApplyObserver&&
this.onApplyObservable.remove(this._onApplyObserver);this._onApplyObserver=this.onApplyObservable.add(a)}set onBeforeRender(a){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver);this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(a)}set onAfterRender(a){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver);this._onAfterRenderObserver=this.onAfterRenderObservable.add(a)}get inputTexture(){return this._textures.data[this._currentRenderTextureInd]}set inputTexture(a){this._forcedOutputTexture=
a}restoreDefaultInputTexture(){this._forcedOutputTexture&&(this._forcedOutputTexture=null,this.markTextureDirty())}getCamera(){return this._camera}get texelSize(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.texelSize:(this._forcedOutputTexture&&this._texelSize.copyFromFloats(1/this._forcedOutputTexture.width,1/this._forcedOutputTexture.height),this._texelSize)}getClassName(){return"PostProcess"}getEngine(){return this._engine}getEffect(){return this._drawWrapper.effect}shareOutputWith(a){return this._disposeTextures(),
this._shareOutputWithPostProcess=a,this}useOwnOutput(){0==this._textures.length&&(this._textures=new $e$$module$libs$world_onscreen(2));this._shareOutputWithPostProcess=null}updateEffect(a=null,b=null,c=null,d,e,g,n,t){var w,z;const C=Se$$module$libs$world_onscreen._GetShaderCodeProcessing(this.name);null!=C&&C.defineCustomBindings&&(b=null!==(w=null==b?void 0:b.slice())&&void 0!==w?w:[],b.push(...this._parameters),c=null!==(z=null==c?void 0:c.slice())&&void 0!==z?z:[],c.push(...this._samplers),a=
C.defineCustomBindings(this.name,a,b,c));this._postProcessDefines=a;this._drawWrapper.effect=this._engine.createEffect({vertex:n??this._vertexUrl,fragment:t??this._fragmentUrl},{attributes:["position"],uniformsNames:b||this._parameters,uniformBuffersNames:[],samplers:c||this._samplers,defines:null!==a?a:"",fallbacks:null,onCompiled:e??null,onError:g??null,indexParameters:d||this._indexParameters,processCodeAfterIncludes:null!=C&&C.processCodeAfterIncludes?(H,M)=>C.processCodeAfterIncludes(this.name,
H,M):null,processFinalCode:null!=C&&C.processFinalCode?(H,M)=>C.processFinalCode(this.name,H,M):null,shaderLanguage:this._shaderLanguage},this._engine)}isReusable(){return this._reusable}markTextureDirty(){this.width=-1}_createRenderTargetTexture(a,b,c=0){for(let d=0;d<this._textureCache.length;d++)if(this._textureCache[d].texture.width===a.width&&this._textureCache[d].texture.height===a.height&&this._textureCache[d].postProcessChannel===c&&this._textureCache[d].texture._generateDepthBuffer===b.generateDepthBuffer&&
this._textureCache[d].texture.samples===b.samples)return this._textureCache[d].texture;a=this._engine.createRenderTargetTexture(a,b);return this._textureCache.push({texture:a,postProcessChannel:c,lastUsedRenderId:-1}),a}_flushTextureCache(){const a=this._renderId;for(let b=this._textureCache.length-1;0<=b;b--)if(100<a-this._textureCache[b].lastUsedRenderId){let c=!1;for(let d=0;d<this._textures.length;d++)if(this._textures.data[d]===this._textureCache[b].texture){c=!0;break}c||(this._textureCache[b].texture.dispose(),
this._textureCache.splice(b,1))}}_resize(a,b,c,d,e){0<this._textures.length&&this._textures.reset();this.width=a;this.height=b;a=null;for(b=0;b<c._postProcesses.length;b++)if(null!==c._postProcesses[b]){a=c._postProcesses[b];break}c={width:this.width,height:this.height};d={generateMipMaps:d,generateDepthBuffer:e||a===this,generateStencilBuffer:(e||a===this)&&this._engine.isStencilEnable,samplingMode:this.renderTargetSamplingMode,type:this._textureType,format:this._textureFormat,samples:this._samples};
this._textures.push(this._createRenderTargetTexture(c,d,0));this._reusable&&this._textures.push(this._createRenderTargetTexture(c,d,1));this._texelSize.copyFromFloats(1/this.width,1/this.height);this.onSizeChangedObservable.notifyObservers(this)}activate(a,b=null,c){var d,e;a=a||this._camera;const g=a.getScene();var n=g.getEngine();const t=n.getCaps().maxTextureSize;let w=(b?b.width:this._engine.getRenderWidth(!0))*this._options|0;b=(b?b.height:this._engine.getRenderHeight(!0))*this._options|0;var z=
a.parent;z&&(z.leftCamera==a||z.rightCamera==a)&&(w/=2);z=this._options.width||w;let C=this._options.height||b;const H=7!==this.renderTargetSamplingMode&&1!==this.renderTargetSamplingMode&&2!==this.renderTargetSamplingMode;if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this.adaptScaleToCurrentViewport){const M=n.currentViewport;M&&(z*=M.width,C*=M.height)}(H||this.alwaysForcePOT)&&(this._options.width||(z=n.needPOTTextures?I$$module$libs$world_onscreen.GetExponentOfTwo(z,t,this.scaleMode):
z),this._options.height||(C=n.needPOTTextures?I$$module$libs$world_onscreen.GetExponentOfTwo(C,t,this.scaleMode):C));this.width===z&&this.height===C||this._resize(z,C,a,H,c);this._textures.forEach(M=>{M.samples!==this.samples&&this._engine.updateRenderTargetTextureSampleCount(M,this.samples)});this._flushTextureCache();this._renderId++}if(this._shareOutputWithPostProcess)c=this._shareOutputWithPostProcess.inputTexture;else if(this._forcedOutputTexture)c=this._forcedOutputTexture,this.width=this._forcedOutputTexture.width,
this.height=this._forcedOutputTexture.height;else{c=this.inputTexture;let M;for(n=0;n<this._textureCache.length;n++)if(this._textureCache[n].texture===c){M=this._textureCache[n];break}M&&(M.lastUsedRenderId=this._renderId)}return this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(w/z,b/C),this._engine.bindFramebuffer(c,0,w,b,this.forceFullscreenViewport)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(c,0,void 0,void 0,this.forceFullscreenViewport)),null===(e=(d=this._engine)._debugInsertMarker)||
void 0===e||e.call(d,`post process ${this.name} input`),this.onActivateObservable.notifyObservers(a),this.autoClear&&0===this.alphaMode&&this._engine.clear(this.clearColor?this.clearColor:g.clearColor,g._allowPostProcessClearColor,!0,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2),c}get isSupported(){return this._drawWrapper.effect.isSupported}get aspectRatio(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.aspectRatio:this._forcedOutputTexture?
this._forcedOutputTexture.width/this._forcedOutputTexture.height:this.width/this.height}isReady(){var a,b;return null!==(b=null===(a=this._drawWrapper.effect)||void 0===a?void 0:a.isReady())&&void 0!==b?b:!1}apply(){var a,b,c;if(null===(a=this._drawWrapper.effect)||void 0===a||!a.isReady())return null;this._engine.enableEffect(this._drawWrapper);this._engine.setState(!1);this._engine.setDepthBuffer(!1);this._engine.setDepthWrite(!1);this._engine.setAlphaMode(this.alphaMode);this.alphaConstants&&this.getEngine().setAlphaConstants(this.alphaConstants.r,
this.alphaConstants.g,this.alphaConstants.b,this.alphaConstants.a);let d;return this._shareOutputWithPostProcess?d=this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?d=this._forcedOutputTexture:d=this.inputTexture,this.externalTextureSamplerBinding||this._drawWrapper.effect._bindTexture("textureSampler",null==d?void 0:d.texture),this._drawWrapper.effect.setVector2("scale",this._scaleRatio),this.onApplyObservable.notifyObservers(this._drawWrapper.effect),null===(c=null===(b=Se$$module$libs$world_onscreen._GetShaderCodeProcessing(this.name))||
void 0===b?void 0:b.bindCustomBindings)||void 0===c||c.call(b,this.name,this._drawWrapper.effect),this._drawWrapper.effect}_disposeTextures(){this._shareOutputWithPostProcess||this._forcedOutputTexture?this._disposeTextureCache():(this._disposeTextureCache(),this._textures.dispose())}_disposeTextureCache(){for(let a=this._textureCache.length-1;0<=a;a--)this._textureCache[a].texture.dispose();this._textureCache.length=0}setPrePassRenderer(a){return this._prePassEffectConfiguration?(this._prePassEffectConfiguration=
a.addEffectConfiguration(this._prePassEffectConfiguration),this._prePassEffectConfiguration.enabled=!0,!0):!1}dispose(a){a=a||this._camera;this._disposeTextures();let b;if(this._scene&&(b=this._scene.postProcesses.indexOf(this),-1!==b&&this._scene.postProcesses.splice(b,1)),this._parentContainer){const c=this._parentContainer.postProcesses.indexOf(this);-1<c&&this._parentContainer.postProcesses.splice(c,1);this._parentContainer=null}if(b=this._engine.postProcesses.indexOf(this),-1!==b&&this._engine.postProcesses.splice(b,
1),a)(a.detachPostProcess(this),b=a._postProcesses.indexOf(this),0===b&&0<a._postProcesses.length)&&(a=this._camera._getFirstPostProcess())&&a.markTextureDirty(),this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear()}serialize(){const a=ae$$module$libs$world_onscreen.Serialize(this),b=this.getCamera()||this._scene&&this._scene.activeCamera;return a.customType="BABYLON."+this.getClassName(),
a.cameraId=b?b.id:null,a.reusable=this._reusable,a.textureType=this._textureType,a.fragmentUrl=this._fragmentUrl,a.parameters=this._parameters,a.samplers=this._samplers,a.options=this._options,a.defines=this._postProcessDefines,a.textureFormat=this._textureFormat,a.vertexUrl=this._vertexUrl,a.indexParameters=this._indexParameters,a}clone(){var a=this.serialize();a._engine=this._engine;a.cameraId=null;return(a=Se$$module$libs$world_onscreen.Parse(a,this._scene,""))?(a.onActivateObservable=this.onActivateObservable.clone(),
a.onSizeChangedObservable=this.onSizeChangedObservable.clone(),a.onApplyObservable=this.onApplyObservable.clone(),a.onBeforeRenderObservable=this.onBeforeRenderObservable.clone(),a.onAfterRenderObservable=this.onAfterRenderObservable.clone(),a._prePassEffectConfiguration=this._prePassEffectConfiguration,a):null}static Parse(a,b,c){const d=ci$$module$libs$world_onscreen(a.customType);if(!d||!d._Parse)return null;const e=b?b.getCameraById(a.cameraId):null;return d._Parse(a,e,b,c)}static _Parse(a,b,
c,d){return ae$$module$libs$world_onscreen.Parse(()=>new Se$$module$libs$world_onscreen(a.name,a.fragmentUrl,a.parameters,a.samplers,a.options,b,a.renderTargetSamplingMode,a._engine,a.reusable,a.defines,a.textureType,a.vertexUrl,a.indexParameters,!1,a.textureFormat),a,c,d)}}Se$$module$libs$world_onscreen._CustomShaderCodeProcessing={};T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"uniqueId",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"name",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"width",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"height",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"renderTargetSamplingMode",void 0);
T$$module$libs$world_onscreen([Fr$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"clearColor",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"autoClear",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"alphaMode",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"alphaConstants",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"enablePixelPerfectMode",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"forceFullscreenViewport",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"scaleMode",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"alwaysForcePOT",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("samples")],Se$$module$libs$world_onscreen.prototype,"_samples",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],Se$$module$libs$world_onscreen.prototype,"adaptScaleToCurrentViewport",void 0);st$$module$libs$world_onscreen("BABYLON.PostProcess",Se$$module$libs$world_onscreen);
const la$$module$libs$world_onscreen="kernelBlurVaryingDeclaration",ca$$module$libs$world_onscreen="varying vec2 sampleCoord{X};";U$$module$libs$world_onscreen.IncludesShadersStore[la$$module$libs$world_onscreen]=ca$$module$libs$world_onscreen;const ua$$module$libs$world_onscreen="packingFunctions",da$$module$libs$world_onscreen="vec4 pack(float depth)\n{\nconst vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);\nconst vec4 bit_mask=vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);\nvec4 res=fract(depth*bit_shift);\nres-=res.xxyz*bit_mask;\nreturn res;\n}\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);\nreturn dot(color,bit_shift);\n}";
U$$module$libs$world_onscreen.IncludesShadersStore[ua$$module$libs$world_onscreen]=da$$module$libs$world_onscreen;const fa$$module$libs$world_onscreen="kernelBlurFragment",_a$$module$libs$world_onscreen="#ifdef DOF\nfactor=sampleCoC(sampleCoord{X}); \ncomputedWeight=KERNEL_WEIGHT{X}*factor;\nsumOfWeights+=computedWeight;\n#else\ncomputedWeight=KERNEL_WEIGHT{X};\n#endif\n#ifdef PACKEDFLOAT\nblend+=unpack(texture2D(textureSampler,sampleCoord{X}))*computedWeight;\n#else\nblend+=texture2D(textureSampler,sampleCoord{X})*computedWeight;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[fa$$module$libs$world_onscreen]=_a$$module$libs$world_onscreen;const ga$$module$libs$world_onscreen="kernelBlurFragment2",pa$$module$libs$world_onscreen="#ifdef DOF\nfactor=sampleCoC(sampleCenter+delta*KERNEL_DEP_OFFSET{X});\ncomputedWeight=KERNEL_DEP_WEIGHT{X}*factor;\nsumOfWeights+=computedWeight;\n#else\ncomputedWeight=KERNEL_DEP_WEIGHT{X};\n#endif\n#ifdef PACKEDFLOAT\nblend+=unpack(texture2D(textureSampler,sampleCenter+delta*KERNEL_DEP_OFFSET{X}))*computedWeight;\n#else\nblend+=texture2D(textureSampler,sampleCenter+delta*KERNEL_DEP_OFFSET{X})*computedWeight;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[ga$$module$libs$world_onscreen]=pa$$module$libs$world_onscreen;const ma$$module$libs$world_onscreen="kernelBlurPixelShader",Ea$$module$libs$world_onscreen="uniform sampler2D textureSampler;\nuniform vec2 delta;\nvarying vec2 sampleCenter;\n#ifdef DOF\nuniform sampler2D circleOfConfusionSampler;\nfloat sampleCoC(in vec2 offset) {\nfloat coc=texture2D(circleOfConfusionSampler,offset).r;\nreturn coc; \n}\n#endif\n#include<kernelBlurVaryingDeclaration>[0..varyingCount]\n#ifdef PACKEDFLOAT\n#include<packingFunctions>\n#endif\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void)\n{\nfloat computedWeight=0.0;\n#ifdef PACKEDFLOAT\nfloat blend=0.;\n#else\nvec4 blend=vec4(0.);\n#endif\n#ifdef DOF\nfloat sumOfWeights=CENTER_WEIGHT; \nfloat factor=0.0;\n#ifdef PACKEDFLOAT\nblend+=unpack(texture2D(textureSampler,sampleCenter))*CENTER_WEIGHT;\n#else\nblend+=texture2D(textureSampler,sampleCenter)*CENTER_WEIGHT;\n#endif\n#endif\n#include<kernelBlurFragment>[0..varyingCount]\n#include<kernelBlurFragment2>[0..depCount]\n#ifdef PACKEDFLOAT\ngl_FragColor=pack(blend);\n#else\ngl_FragColor=blend;\n#endif\n#ifdef DOF\ngl_FragColor/=sumOfWeights;\n#endif\n}";
U$$module$libs$world_onscreen.ShadersStore[ma$$module$libs$world_onscreen]=Ea$$module$libs$world_onscreen;const va$$module$libs$world_onscreen="kernelBlurVertex",Ta$$module$libs$world_onscreen="sampleCoord{X}=sampleCenter+delta*KERNEL_OFFSET{X};";U$$module$libs$world_onscreen.IncludesShadersStore[va$$module$libs$world_onscreen]=Ta$$module$libs$world_onscreen;const ba$$module$libs$world_onscreen="kernelBlurVertexShader",Sa$$module$libs$world_onscreen="attribute vec2 position;\nuniform vec2 delta;\nvarying vec2 sampleCenter;\n#include<kernelBlurVaryingDeclaration>[0..varyingCount]\nconst vec2 madd=vec2(0.5,0.5);\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nsampleCenter=(position*madd+madd);\n#include<kernelBlurVertex>[0..varyingCount]\ngl_Position=vec4(position,0.0,1.0);\n#define CUSTOM_VERTEX_MAIN_END\n}";
U$$module$libs$world_onscreen.ShadersStore[ba$$module$libs$world_onscreen]=Sa$$module$libs$world_onscreen;
class Jt$$module$libs$world_onscreen extends Se$$module$libs$world_onscreen{constructor(a,b,c,d,e,g=B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE,n,t,w=0,z="",C=!1,H=5){super(a,"kernelBlur",["delta","direction"],["circleOfConfusionSampler"],d,e,g,n,t,null,w,"kernelBlur",{varyingCount:0,depCount:0},!0,H);this._blockCompilation=C;this._packedFloat=!1;this._staticDefines="";this._staticDefines=z;this.direction=b;this.onApplyObservable.add(M=>{this._outputTexture?M.setFloat2("delta",1/this._outputTexture.width*
this.direction.x,1/this._outputTexture.height*this.direction.y):M.setFloat2("delta",1/this.width*this.direction.x,1/this.height*this.direction.y)});this.kernel=c}set kernel(a){this._idealKernel!==a&&(a=Math.max(a,1),this._idealKernel=a,this._kernel=this._nearestBestKernel(a),this._blockCompilation||this._updateParameters())}get kernel(){return this._idealKernel}set packedFloat(a){this._packedFloat!==a&&(this._packedFloat=a,this._blockCompilation||this._updateParameters())}get packedFloat(){return this._packedFloat}getClassName(){return"BlurPostProcess"}updateEffect(a,
b,c,d,e,g){this._updateParameters(e,g)}_updateParameters(a,b){var c=this._kernel,d=(c-1)/2,e=[];let g=[];var n=0;for(var t=0;t<c;t++){var w=this._gaussianWeight(t/(c-1)*2-1);e[t]=t-d;g[t]=w;n+=w}for(c=0;c<g.length;c++)g[c]/=n;n=[];c=[];t=[];for(w=0;w<=d;w+=2){var z=Math.min(w+1,Math.floor(d));if(w===z)t.push({o:e[w],w:g[w]});else{const C=g[w]+g[z]*(z===d?.5:1);z=e[w]+1/(1+g[w]/g[z]);0===z?(t.push({o:e[w],w:g[w]}),t.push({o:e[w+1],w:g[w+1]})):(t.push({o:z,w:C}),t.push({o:-z,w:C}))}}for(e=0;e<t.length;e++)c[e]=
t[e].o,n[e]=t[e].w;e=c;g=n;d=this.getEngine().getCaps().maxVaryingVectors;c=Math.max(d,0)-1;d=Math.min(e.length,c);n=""+this._staticDefines;-1!=this._staticDefines.indexOf("DOF")&&(n+=`#define CENTER_WEIGHT ${this._glslFloat(g[d-1])}\r
`,d--);for(t=0;t<d;t++)n+=`#define KERNEL_OFFSET${t} ${this._glslFloat(e[t])}\r
`,n+=`#define KERNEL_WEIGHT${t} ${this._glslFloat(g[t])}\r
`;for(t=0;c<e.length;c++)n+=`#define KERNEL_DEP_OFFSET${t} ${this._glslFloat(e[c])}\r
`,n+=`#define KERNEL_DEP_WEIGHT${t} ${this._glslFloat(g[c])}\r
`,t++;this.packedFloat&&(n+="#define PACKEDFLOAT 1");this._blockCompilation=!1;super.updateEffect(n,null,null,{varyingCount:d,depCount:t},a,b)}_nearestBestKernel(a){a=Math.round(a);for(const b of[a,a-1,a+1,a-2,a+2])if(0!==b%2&&0===Math.floor(b/2)%2&&0<b)return Math.max(b,3);return Math.max(a,3)}_gaussianWeight(a){return 1/(.3333333333333333*Math.sqrt(2*Math.PI))*Math.exp(-(a*a/.2222222222222222))}_glslFloat(a,b=8){return a.toFixed(b).replace(/0+$/,"")}static _Parse(a,b,c,d){return ae$$module$libs$world_onscreen.Parse(()=>
new Jt$$module$libs$world_onscreen(a.name,a.direction,a.kernel,a.options,b,a.renderTargetSamplingMode,c.getEngine(),a.reusable,a.textureType,void 0,!1),a,c,d)}}T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("kernel")],Jt$$module$libs$world_onscreen.prototype,"_kernel",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("packedFloat")],Jt$$module$libs$world_onscreen.prototype,"_packedFloat",void 0);
T$$module$libs$world_onscreen([Cn$$module$libs$world_onscreen()],Jt$$module$libs$world_onscreen.prototype,"direction",void 0);st$$module$libs$world_onscreen("BABYLON.BlurPostProcess",Jt$$module$libs$world_onscreen);
class qs$$module$libs$world_onscreen{constructor(){this._defines={};this._currentRank=32;this._maxRank=-1;this._mesh=null}unBindMesh(){this._mesh=null}addFallback(a,b){this._defines[a]||(a<this._currentRank&&(this._currentRank=a),a>this._maxRank&&(this._maxRank=a),this._defines[a]=[]);this._defines[a].push(b)}addCPUSkinningFallback(a,b){this._mesh=b;a<this._currentRank&&(this._currentRank=a);a>this._maxRank&&(this._maxRank=a)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(a,
b){if(this._mesh&&this._mesh.computeBonesUsingShaders&&0<this._mesh.numBoneInfluencers){this._mesh.computeBonesUsingShaders=!1;a=a.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0");b._bonesComputationForcedToCPU=!0;var c=this._mesh.getScene();for(let d=0;d<c.meshes.length;d++){const e=c.meshes[d];if(!e.material)!this._mesh.material&&e.computeBonesUsingShaders&&0<e.numBoneInfluencers&&(e.computeBonesUsingShaders=!1);else if(e.computeBonesUsingShaders&&
0!==e.numBoneInfluencers)if(e.material.getEffect()===b)e.computeBonesUsingShaders=!1;else if(e.subMeshes)for(const g of e.subMeshes)if(g.effect===b){e.computeBonesUsingShaders=!1;break}}}else{if(b=this._defines[this._currentRank])for(c=0;c<b.length;c++)a=a.replace("#define "+b[c],"");this._currentRank++}return a}}const xa$$module$libs$world_onscreen="bayerDitherFunctions",Ma$$module$libs$world_onscreen="float bayerDither2(vec2 _P) {\nreturn mod(2.0*_P.y+_P.x+1.0,4.0);\n}\nfloat bayerDither4(vec2 _P) {\nvec2 P1=mod(_P,2.0); \nvec2 P2=floor(0.5*mod(_P,4.0)); \nreturn 4.0*bayerDither2(P1)+bayerDither2(P2);\n}\nfloat bayerDither8(vec2 _P) {\nvec2 P1=mod(_P,2.0); \nvec2 P2=floor(0.5 *mod(_P,4.0)); \nvec2 P4=floor(0.25*mod(_P,8.0)); \nreturn 4.0*(4.0*bayerDither2(P1)+bayerDither2(P2))+bayerDither2(P4);\n}\n";
U$$module$libs$world_onscreen.IncludesShadersStore[xa$$module$libs$world_onscreen]=Ma$$module$libs$world_onscreen;const Aa$$module$libs$world_onscreen="shadowMapFragmentExtraDeclaration",Ra$$module$libs$world_onscreen="#if SM_FLOAT==0\n#include<packingFunctions>\n#endif\n#if SM_SOFTTRANSPARENTSHADOW==1\n#include<bayerDitherFunctions>\nuniform float softTransparentShadowSM;\n#endif\nvarying float vDepthMetricSM;\n#if SM_USEDISTANCE==1\nuniform vec3 lightDataSM;\nvarying vec3 vPositionWSM;\n#endif\nuniform vec3 biasAndScaleSM;\nuniform vec2 depthValuesSM;\n#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1\nvarying float zSM;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Aa$$module$libs$world_onscreen]=Ra$$module$libs$world_onscreen;const ya$$module$libs$world_onscreen="clipPlaneFragmentDeclaration",Ca$$module$libs$world_onscreen="#ifdef CLIPPLANE\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nvarying float fClipDistance6;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[ya$$module$libs$world_onscreen]=Ca$$module$libs$world_onscreen;const Ia$$module$libs$world_onscreen="clipPlaneFragment",Pa$$module$libs$world_onscreen="#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)\nif (false) {}\n#endif\n#ifdef CLIPPLANE\nelse if (fClipDistance>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE2\nelse if (fClipDistance2>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE3\nelse if (fClipDistance3>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE4\nelse if (fClipDistance4>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE5\nelse if (fClipDistance5>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE6\nelse if (fClipDistance6>0.0)\n{\ndiscard;\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Ia$$module$libs$world_onscreen]=Pa$$module$libs$world_onscreen;const Da$$module$libs$world_onscreen="shadowMapFragment",Fa$$module$libs$world_onscreen="float depthSM=vDepthMetricSM;\n#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1\n#if SM_USEDISTANCE==1\ndepthSM=(length(vPositionWSM-lightDataSM)+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\n#else\n#ifdef USE_REVERSE_DEPTHBUFFER\ndepthSM=(-zSM+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\n#else\ndepthSM=(zSM+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\n#endif\n#endif\n#ifdef USE_REVERSE_DEPTHBUFFER\ngl_FragDepth=clamp(1.0-depthSM,0.0,1.0);\n#else\ngl_FragDepth=clamp(depthSM,0.0,1.0); \n#endif\n#elif SM_USEDISTANCE==1\ndepthSM=(length(vPositionWSM-lightDataSM)+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\n#endif\n#if SM_ESM==1\ndepthSM=clamp(exp(-min(87.,biasAndScaleSM.z*depthSM)),0.,1.);\n#endif\n#if SM_FLOAT==1\ngl_FragColor=vec4(depthSM,1.0,1.0,1.0);\n#else\ngl_FragColor=pack(depthSM);\n#endif\nreturn;";
U$$module$libs$world_onscreen.IncludesShadersStore[Da$$module$libs$world_onscreen]=Fa$$module$libs$world_onscreen;const wa$$module$libs$world_onscreen="shadowMapPixelShader",Oa$$module$libs$world_onscreen="#include<shadowMapFragmentExtraDeclaration>\n#ifdef ALPHATEXTURE\nvarying vec2 vUV;\nuniform sampler2D diffuseSampler;\n#endif\n#include<clipPlaneFragmentDeclaration>\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void)\n{\n#include<clipPlaneFragment>\n#ifdef ALPHATEXTURE\nfloat alphaFromAlphaTexture=texture2D(diffuseSampler,vUV).a;\n#ifdef ALPHATESTVALUE\nif (alphaFromAlphaTexture<ALPHATESTVALUE)\ndiscard;\n#endif\n#endif\n#if SM_SOFTTRANSPARENTSHADOW==1\n#ifdef ALPHATEXTURE\nif ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM*alphaFromAlphaTexture) discard;\n#else\nif ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM) discard;\n#endif\n#endif\n#include<shadowMapFragment>\n}";
U$$module$libs$world_onscreen.ShadersStore[wa$$module$libs$world_onscreen]=Oa$$module$libs$world_onscreen;const La$$module$libs$world_onscreen="bonesDeclaration",Na$$module$libs$world_onscreen="#if NUM_BONE_INFLUENCERS>0\nattribute vec4 matricesIndices;\nattribute vec4 matricesWeights;\n#if NUM_BONE_INFLUENCERS>4\nattribute vec4 matricesIndicesExtra;\nattribute vec4 matricesWeightsExtra;\n#endif\n#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#ifdef BONETEXTURE\nuniform sampler2D boneSampler;\nuniform float boneTextureWidth;\n#else\nuniform mat4 mBones[BonesPerMesh];\n#ifdef BONES_VELOCITY_ENABLED\nuniform mat4 mPreviousBones[BonesPerMesh];\n#endif\n#endif\n#ifdef BONETEXTURE\n#define inline\nmat4 readMatrixFromRawSampler(sampler2D smp,float index)\n{\nfloat offset=index *4.0;\nfloat dx=1.0/boneTextureWidth;\nvec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));\nvec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));\nvec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));\nvec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));\nreturn mat4(m0,m1,m2,m3);\n}\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[La$$module$libs$world_onscreen]=Na$$module$libs$world_onscreen;const Ba$$module$libs$world_onscreen="bakedVertexAnimationDeclaration",Ua$$module$libs$world_onscreen="#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\nuniform float bakedVertexAnimationTime;\nuniform vec2 bakedVertexAnimationTextureSizeInverted;\nuniform vec4 bakedVertexAnimationSettings;\nuniform sampler2D bakedVertexAnimationTexture;\n#ifdef INSTANCES\nattribute vec4 bakedVertexAnimationSettingsInstanced;\n#endif\n#define inline\nmat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)\n{\nfloat offset=index*4.0;\nfloat frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;\nfloat dx=bakedVertexAnimationTextureSizeInverted.x;\nvec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));\nvec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));\nvec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));\nvec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));\nreturn mat4(m0,m1,m2,m3);\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Ba$$module$libs$world_onscreen]=Ua$$module$libs$world_onscreen;const ka$$module$libs$world_onscreen="morphTargetsVertexGlobalDeclaration",Va$$module$libs$world_onscreen="#ifdef MORPHTARGETS\nuniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];\n#ifdef MORPHTARGETS_TEXTURE \nprecision mediump sampler2DArray; \nuniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];\nuniform vec3 morphTargetTextureInfo;\nuniform sampler2DArray morphTargets;\nvec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)\n{ \nfloat y=floor(vertexIndex/morphTargetTextureInfo.y);\nfloat x=vertexIndex-y*morphTargetTextureInfo.y;\nvec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);\nreturn texture(morphTargets,textureUV).xyz;\n}\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[ka$$module$libs$world_onscreen]=Va$$module$libs$world_onscreen;const Wa$$module$libs$world_onscreen="morphTargetsVertexDeclaration",za$$module$libs$world_onscreen="#ifdef MORPHTARGETS\n#ifndef MORPHTARGETS_TEXTURE\nattribute vec3 position{X};\n#ifdef MORPHTARGETS_NORMAL\nattribute vec3 normal{X};\n#endif\n#ifdef MORPHTARGETS_TANGENT\nattribute vec3 tangent{X};\n#endif\n#ifdef MORPHTARGETS_UV\nattribute vec2 uv_{X};\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Wa$$module$libs$world_onscreen]=za$$module$libs$world_onscreen;const Ga$$module$libs$world_onscreen="helperFunctions",Xa$$module$libs$world_onscreen="const float PI=3.1415926535897932384626433832795;\nconst float HALF_MIN=5.96046448e-08; \nconst float LinearEncodePowerApprox=2.2;\nconst float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;\nconst vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);\nconst float Epsilon=0.0000001;\n#define saturate(x) clamp(x,0.0,1.0)\n#define absEps(x) abs(x)+Epsilon\n#define maxEps(x) max(x,Epsilon)\n#define saturateEps(x) clamp(x,Epsilon,1.0)\nmat3 transposeMat3(mat3 inMatrix) {\nvec3 i0=inMatrix[0];\nvec3 i1=inMatrix[1];\nvec3 i2=inMatrix[2];\nmat3 outMatrix=mat3(\nvec3(i0.x,i1.x,i2.x),\nvec3(i0.y,i1.y,i2.y),\nvec3(i0.z,i1.z,i2.z)\n);\nreturn outMatrix;\n}\nmat3 inverseMat3(mat3 inMatrix) {\nfloat a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];\nfloat a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];\nfloat a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];\nfloat b01=a22*a11-a12*a21;\nfloat b11=-a22*a10+a12*a20;\nfloat b21=a21*a10-a11*a20;\nfloat det=a00*b01+a01*b11+a02*b21;\nreturn mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),\nb11,(a22*a00-a02*a20),(-a12*a00+a02*a10),\nb21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;\n}\n#if USE_EXACT_SRGB_CONVERSIONS\nvec3 toLinearSpaceExact(vec3 color)\n{\nvec3 nearZeroSection=0.0773993808*color;\nvec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));\n#else\nreturn\nvec3(\ncolor.r<=0.04045 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.04045 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.04045 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\nvec3 toGammaSpaceExact(vec3 color)\n{\nvec3 nearZeroSection=12.92*color;\nvec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));\n#else\nreturn\nvec3(\ncolor.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\n#endif\nfloat toLinearSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=0.0773993808*color;\nfloat remainingSection=pow(0.947867299*(color+0.055),2.4);\nreturn color<=0.04045 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,LinearEncodePowerApprox);\n#endif\n}\nvec3 toLinearSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toLinearSpaceExact(color);\n#else\nreturn pow(color,vec3(LinearEncodePowerApprox));\n#endif\n}\nvec4 toLinearSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toLinearSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);\n#endif\n}\nfloat toGammaSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=12.92*color;\nfloat remainingSection=1.055*pow(color,0.41666)-0.055;\nreturn color<=0.0031308 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,GammaEncodePowerApprox);\n#endif\n}\nvec3 toGammaSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toGammaSpaceExact(color);\n#else\nreturn pow(color,vec3(GammaEncodePowerApprox));\n#endif\n}\nvec4 toGammaSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toGammaSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);\n#endif\n}\nfloat square(float value)\n{\nreturn value*value;\n}\nvec3 square(vec3 value)\n{\nreturn value*value;\n}\nfloat pow5(float value) {\nfloat sq=value*value;\nreturn sq*sq*value;\n}\nfloat getLuminance(vec3 color)\n{\nreturn clamp(dot(color,LuminanceEncodeApprox),0.,1.);\n}\nfloat getRand(vec2 seed) {\nreturn fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);\n}\nfloat dither(vec2 seed,float varianceAmount) {\nfloat rand=getRand(seed);\nfloat normVariance=varianceAmount/255.0;\nfloat dither=mix(-normVariance,normVariance,rand);\nreturn dither;\n}\nconst float rgbdMaxRange=255.0;\nvec4 toRGBD(vec3 color) {\nfloat maxRGB=maxEps(max(color.r,max(color.g,color.b)));\nfloat D =max(rgbdMaxRange/maxRGB,1.);\nD =clamp(floor(D)/255.0,0.,1.);\nvec3 rgb=color.rgb*D;\nrgb=toGammaSpace(rgb);\nreturn vec4(clamp(rgb,0.,1.),D); \n}\nvec3 fromRGBD(vec4 rgbd) {\nrgbd.rgb=toLinearSpace(rgbd.rgb);\nreturn rgbd.rgb/rgbd.a;\n}\nvec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {\nvec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;\nvec3 halfSize=cubeSize*0.5;\nvec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;\nvec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;\nvec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);\nfloat distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);\nvec3 intersectPositionWS=vertexPos+origVec*distance;\nreturn intersectPositionWS-cubePos;\n}\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Ga$$module$libs$world_onscreen]=Xa$$module$libs$world_onscreen;const Ha$$module$libs$world_onscreen="sceneVertexDeclaration",Ka$$module$libs$world_onscreen="uniform mat4 viewProjection;\n#ifdef MULTIVIEW\nuniform mat4 viewProjectionR;\n#endif\nuniform mat4 view;\nuniform mat4 projection;\nuniform vec4 vEyePosition;\n";U$$module$libs$world_onscreen.IncludesShadersStore[Ha$$module$libs$world_onscreen]=Ka$$module$libs$world_onscreen;
const Ya$$module$libs$world_onscreen="meshVertexDeclaration",Za$$module$libs$world_onscreen="uniform mat4 world;\nuniform float visibility;\n";U$$module$libs$world_onscreen.IncludesShadersStore[Ya$$module$libs$world_onscreen]=Za$$module$libs$world_onscreen;const qa$$module$libs$world_onscreen="shadowMapVertexDeclaration",ja$$module$libs$world_onscreen="#include<sceneVertexDeclaration>\n#include<meshVertexDeclaration>\n";
U$$module$libs$world_onscreen.IncludesShadersStore[qa$$module$libs$world_onscreen]=ja$$module$libs$world_onscreen;const $a$$module$libs$world_onscreen="sceneUboDeclaration",Qa$$module$libs$world_onscreen="layout(std140,column_major) uniform;\nuniform Scene {\nmat4 viewProjection;\n#ifdef MULTIVIEW\nmat4 viewProjectionR;\n#endif \nmat4 view;\nmat4 projection;\nvec4 vEyePosition;\n};\n";U$$module$libs$world_onscreen.IncludesShadersStore[$a$$module$libs$world_onscreen]=Qa$$module$libs$world_onscreen;
const Ja$$module$libs$world_onscreen="meshUboDeclaration",eo$$module$libs$world_onscreen="#ifdef WEBGL2\nuniform mat4 world;\nuniform float visibility;\n#else\nlayout(std140,column_major) uniform;\nuniform Mesh\n{\nmat4 world;\nfloat visibility;\n};\n#endif\n#define WORLD_UBO\n";U$$module$libs$world_onscreen.IncludesShadersStore[Ja$$module$libs$world_onscreen]=eo$$module$libs$world_onscreen;const to$$module$libs$world_onscreen="shadowMapUboDeclaration",io$$module$libs$world_onscreen="layout(std140,column_major) uniform;\n#include<sceneUboDeclaration>\n#include<meshUboDeclaration>\n";
U$$module$libs$world_onscreen.IncludesShadersStore[to$$module$libs$world_onscreen]=io$$module$libs$world_onscreen;const so$$module$libs$world_onscreen="shadowMapVertexExtraDeclaration",ro$$module$libs$world_onscreen="#if SM_NORMALBIAS==1\nuniform vec3 lightDataSM;\n#endif\nuniform vec3 biasAndScaleSM;\nuniform vec2 depthValuesSM;\nvarying float vDepthMetricSM;\n#if SM_USEDISTANCE==1\nvarying vec3 vPositionWSM;\n#endif\n#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1\nvarying float zSM;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[so$$module$libs$world_onscreen]=ro$$module$libs$world_onscreen;const no$$module$libs$world_onscreen="clipPlaneVertexDeclaration",ao$$module$libs$world_onscreen="#ifdef CLIPPLANE\nuniform vec4 vClipPlane;\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nuniform vec4 vClipPlane2;\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nuniform vec4 vClipPlane3;\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nuniform vec4 vClipPlane4;\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nuniform vec4 vClipPlane5;\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nuniform vec4 vClipPlane6;\nvarying float fClipDistance6;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[no$$module$libs$world_onscreen]=ao$$module$libs$world_onscreen;const oo$$module$libs$world_onscreen="morphTargetsVertexGlobal",ho$$module$libs$world_onscreen="#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE\nfloat vertexID;\n#endif\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[oo$$module$libs$world_onscreen]=ho$$module$libs$world_onscreen;const lo$$module$libs$world_onscreen="morphTargetsVertex",co$$module$libs$world_onscreen="#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE \nvertexID=float(gl_VertexID)*morphTargetTextureInfo.x;\npositionUpdated+=(readVector3FromRawSampler({X},vertexID)-position)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(readVector3FromRawSampler({X},vertexID) -normal)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(readVector3FromRawSampler({X},vertexID).xy-uv)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(readVector3FromRawSampler({X},vertexID) -tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#else\npositionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[lo$$module$libs$world_onscreen]=co$$module$libs$world_onscreen;const uo$$module$libs$world_onscreen="instancesVertex",fo$$module$libs$world_onscreen="#ifdef INSTANCES\nmat4 finalWorld=mat4(world0,world1,world2,world3);\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nmat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,previousWorld2,previousWorld3);\n#endif\n#ifdef THIN_INSTANCES\nfinalWorld=world*finalWorld;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nfinalPreviousWorld=previousWorld*finalPreviousWorld;\n#endif\n#endif\n#else\nmat4 finalWorld=world;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nmat4 finalPreviousWorld=previousWorld;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[uo$$module$libs$world_onscreen]=fo$$module$libs$world_onscreen;const _o$$module$libs$world_onscreen="bonesVertex",go$$module$libs$world_onscreen="#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#if NUM_BONE_INFLUENCERS>0\nmat4 influence;\n#ifdef BONETEXTURE\ninfluence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];\n#endif\n#else\ninfluence=mBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=mBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=mBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=mBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\n#endif\nfinalWorld=finalWorld*influence;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[_o$$module$libs$world_onscreen]=go$$module$libs$world_onscreen;const po$$module$libs$world_onscreen="bakedVertexAnimation",mo$$module$libs$world_onscreen="#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\n{\n#ifdef INSTANCES\n#define BVASNAME bakedVertexAnimationSettingsInstanced\n#else\n#define BVASNAME bakedVertexAnimationSettings\n#endif\nfloat VATStartFrame=BVASNAME.x;\nfloat VATEndFrame=BVASNAME.y;\nfloat VATOffsetFrame=BVASNAME.z;\nfloat VATSpeed=BVASNAME.w;\nfloat totalFrames=VATEndFrame-VATStartFrame+1.0;\nfloat time=bakedVertexAnimationTime*VATSpeed/totalFrames;\nfloat frameCorrection=time<1.0 ? 0.0 : 1.0;\nfloat numOfFrames=totalFrames-frameCorrection;\nfloat VATFrameNum=fract(time)*numOfFrames;\nVATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);\nVATFrameNum=floor(VATFrameNum);\nVATFrameNum+=VATStartFrame+frameCorrection;\nmat4 VATInfluence;\nVATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];\n#endif\nfinalWorld=finalWorld*VATInfluence;\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[po$$module$libs$world_onscreen]=mo$$module$libs$world_onscreen;const Eo$$module$libs$world_onscreen="shadowMapVertexNormalBias",vo$$module$libs$world_onscreen="#if SM_NORMALBIAS==1\n#if SM_DIRECTIONINLIGHTDATA==1\nvec3 worldLightDirSM=normalize(-lightDataSM.xyz);\n#else\nvec3 directionToLightSM=lightDataSM.xyz-worldPos.xyz;\nvec3 worldLightDirSM=normalize(directionToLightSM);\n#endif\nfloat ndlSM=dot(vNormalW,worldLightDirSM);\nfloat sinNLSM=sqrt(1.0-ndlSM*ndlSM);\nfloat normalBiasSM=biasAndScaleSM.y*sinNLSM;\nworldPos.xyz-=vNormalW*normalBiasSM;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Eo$$module$libs$world_onscreen]=vo$$module$libs$world_onscreen;const To$$module$libs$world_onscreen="shadowMapVertexMetric",bo$$module$libs$world_onscreen="#if SM_USEDISTANCE==1\nvPositionWSM=worldPos.xyz;\n#endif\n#if SM_DEPTHTEXTURE==1\n#ifdef IS_NDC_HALF_ZRANGE\n#define BIASFACTOR 0.5\n#else\n#define BIASFACTOR 1.0\n#endif\n#ifdef USE_REVERSE_DEPTHBUFFER\ngl_Position.z-=biasAndScaleSM.x*gl_Position.w*BIASFACTOR;\n#else\ngl_Position.z+=biasAndScaleSM.x*gl_Position.w*BIASFACTOR;\n#endif\n#endif\n#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1\nzSM=gl_Position.z;\ngl_Position.z=0.0;\n#elif SM_USEDISTANCE==0\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetricSM=(-gl_Position.z+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\n#else\nvDepthMetricSM=(gl_Position.z+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[To$$module$libs$world_onscreen]=bo$$module$libs$world_onscreen;const So$$module$libs$world_onscreen="clipPlaneVertex",xo$$module$libs$world_onscreen="#ifdef CLIPPLANE\nfClipDistance=dot(worldPos,vClipPlane);\n#endif\n#ifdef CLIPPLANE2\nfClipDistance2=dot(worldPos,vClipPlane2);\n#endif\n#ifdef CLIPPLANE3\nfClipDistance3=dot(worldPos,vClipPlane3);\n#endif\n#ifdef CLIPPLANE4\nfClipDistance4=dot(worldPos,vClipPlane4);\n#endif\n#ifdef CLIPPLANE5\nfClipDistance5=dot(worldPos,vClipPlane5);\n#endif\n#ifdef CLIPPLANE6\nfClipDistance6=dot(worldPos,vClipPlane6);\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[So$$module$libs$world_onscreen]=xo$$module$libs$world_onscreen;const Mo$$module$libs$world_onscreen="shadowMapVertexShader",Ao$$module$libs$world_onscreen="attribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<morphTargetsVertexGlobalDeclaration>\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\n#ifdef INSTANCES\nattribute vec4 world0;\nattribute vec4 world1;\nattribute vec4 world2;\nattribute vec4 world3;\n#endif\n#include<helperFunctions>\n#include<__decl__shadowMapVertex>\n#ifdef ALPHATEXTURE\nvarying vec2 vUV;\nuniform mat4 diffuseMatrix;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#endif\n#include<shadowMapVertexExtraDeclaration>\n#include<clipPlaneVertexDeclaration>\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void)\n{\nvec3 positionUpdated=position;\n#ifdef UV1\nvec2 uvUpdated=uv;\n#endif\n#ifdef NORMAL\nvec3 normalUpdated=normal;\n#endif\n#include<morphTargetsVertexGlobal>\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\n#include<instancesVertex>\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);\n#ifdef NORMAL\nmat3 normWorldSM=mat3(finalWorld);\n#if defined(INSTANCES) && defined(THIN_INSTANCES)\nvec3 vNormalW=normalUpdated/vec3(dot(normWorldSM[0],normWorldSM[0]),dot(normWorldSM[1],normWorldSM[1]),dot(normWorldSM[2],normWorldSM[2]));\nvNormalW=normalize(normWorldSM*vNormalW);\n#else\n#ifdef NONUNIFORMSCALING\nnormWorldSM=transposeMat3(inverseMat3(normWorldSM));\n#endif\nvec3 vNormalW=normalize(normWorldSM*normalUpdated);\n#endif\n#endif\n#include<shadowMapVertexNormalBias>\ngl_Position=viewProjection*worldPos;\n#include<shadowMapVertexMetric>\n#ifdef ALPHATEXTURE\n#ifdef UV1\nvUV=vec2(diffuseMatrix*vec4(uvUpdated,1.0,0.0));\n#endif\n#ifdef UV2\nvUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n#endif\n#endif\n#include<clipPlaneVertex>\n}";
U$$module$libs$world_onscreen.ShadersStore[Mo$$module$libs$world_onscreen]=Ao$$module$libs$world_onscreen;const Ro$$module$libs$world_onscreen="depthBoxBlurPixelShader",yo$$module$libs$world_onscreen="varying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform vec2 screenSize;\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void)\n{\nvec4 colorDepth=vec4(0.0);\nfor (int x=-OFFSET; x<=OFFSET; x++)\nfor (int y=-OFFSET; y<=OFFSET; y++)\ncolorDepth+=texture2D(textureSampler,vUV+vec2(x,y)/screenSize);\ngl_FragColor=(colorDepth/float((OFFSET*2+1)*(OFFSET*2+1)));\n}";
U$$module$libs$world_onscreen.ShadersStore[Ro$$module$libs$world_onscreen]=yo$$module$libs$world_onscreen;const Co$$module$libs$world_onscreen="shadowMapFragmentSoftTransparentShadow",Io$$module$libs$world_onscreen="#if SM_SOFTTRANSPARENTSHADOW==1\nif ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM*alpha) discard;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[Co$$module$libs$world_onscreen]=Io$$module$libs$world_onscreen;
class G$$module$libs$world_onscreen{constructor(a,b,c,d){this.onBeforeShadowMapRenderObservable=new w$$module$libs$world_onscreen;this.onAfterShadowMapRenderObservable=new w$$module$libs$world_onscreen;this.onBeforeShadowMapRenderMeshObservable=new w$$module$libs$world_onscreen;this.onAfterShadowMapRenderMeshObservable=new w$$module$libs$world_onscreen;this._bias=5E-5;this._normalBias=0;this._blurBoxOffset=1;this._blurScale=2;this._blurKernel=1;this._useKernelBlur=!1;this._filter=G$$module$libs$world_onscreen.FILTER_NONE;
this._filteringQuality=G$$module$libs$world_onscreen.QUALITY_HIGH;this._contactHardeningLightSizeUVRatio=.1;this._darkness=0;this.useOpacityTextureForTransparentShadow=this.enableSoftTransparentShadow=this._transparencyShadow=!1;this.frustumEdgeFalloff=0;this.forceBackFacesOnly=!1;this._lightDirection=p$$module$libs$world_onscreen.Zero();this._viewMatrix=x$$module$libs$world_onscreen.Zero();this._projectionMatrix=x$$module$libs$world_onscreen.Zero();this._transformMatrix=x$$module$libs$world_onscreen.Zero();
this._cachedPosition=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cachedDirection=new p$$module$libs$world_onscreen(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._currentFaceIndexCache=this._currentFaceIndex=0;this._defaultTextureMatrix=x$$module$libs$world_onscreen.Identity();this._mapSize=a;this._light=b;this._scene=b.getScene();this._camera=d??null;(a=b._shadowGenerators)||(a=b._shadowGenerators=new Map);a.set(this._camera,this);this.id=
b.id;(this._useUBO=this._scene.getEngine().supportsUniformBuffers)&&(this._sceneUBOs=[],this._sceneUBOs.push(this._scene.createSceneUniformBuffer(`Scene for Shadow Generator (light "${this._light.name}")`)));G$$module$libs$world_onscreen._SceneComponentInitialization(this._scene);b=this._scene.getEngine().getCaps();c?b.textureFloatRender&&b.textureFloatLinearFiltering?this._textureType=1:b.textureHalfFloatRender&&b.textureHalfFloatLinearFiltering?this._textureType=2:this._textureType=0:b.textureHalfFloatRender&&
b.textureHalfFloatLinearFiltering?this._textureType=2:b.textureFloatRender&&b.textureFloatLinearFiltering?this._textureType=1:this._textureType=0;this._initializeGenerator();this._applyFilterValues()}get bias(){return this._bias}set bias(a){this._bias=a}get normalBias(){return this._normalBias}set normalBias(a){this._normalBias=a}get blurBoxOffset(){return this._blurBoxOffset}set blurBoxOffset(a){this._blurBoxOffset!==a&&(this._blurBoxOffset=a,this._disposeBlurPostProcesses())}get blurScale(){return this._blurScale}set blurScale(a){this._blurScale!==
a&&(this._blurScale=a,this._disposeBlurPostProcesses())}get blurKernel(){return this._blurKernel}set blurKernel(a){this._blurKernel!==a&&(this._blurKernel=a,this._disposeBlurPostProcesses())}get useKernelBlur(){return this._useKernelBlur}set useKernelBlur(a){this._useKernelBlur!==a&&(this._useKernelBlur=a,this._disposeBlurPostProcesses())}get depthScale(){return void 0!==this._depthScale?this._depthScale:this._light.getDepthScale()}set depthScale(a){this._depthScale=a}_validateFilter(a){return a}get filter(){return this._filter}set filter(a){if(a=
this._validateFilter(a),this._light.needCube()){if(a===G$$module$libs$world_onscreen.FILTER_BLUREXPONENTIALSHADOWMAP){this.useExponentialShadowMap=!0;return}if(a===G$$module$libs$world_onscreen.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP){this.useCloseExponentialShadowMap=!0;return}if(a===G$$module$libs$world_onscreen.FILTER_PCF||a===G$$module$libs$world_onscreen.FILTER_PCSS){this.usePoissonSampling=!0;return}}a!==G$$module$libs$world_onscreen.FILTER_PCF&&a!==G$$module$libs$world_onscreen.FILTER_PCSS||this._scene.getEngine()._features.supportShadowSamplers?
this._filter!==a&&(this._filter=a,this._disposeBlurPostProcesses(),this._applyFilterValues(),this._light._markMeshesAsLightDirty()):this.usePoissonSampling=!0}get usePoissonSampling(){return this.filter===G$$module$libs$world_onscreen.FILTER_POISSONSAMPLING}set usePoissonSampling(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_POISSONSAMPLING);!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_POISSONSAMPLING||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get useExponentialShadowMap(){return this.filter===
G$$module$libs$world_onscreen.FILTER_EXPONENTIALSHADOWMAP}set useExponentialShadowMap(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_EXPONENTIALSHADOWMAP);!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_EXPONENTIALSHADOWMAP||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get useBlurExponentialShadowMap(){return this.filter===G$$module$libs$world_onscreen.FILTER_BLUREXPONENTIALSHADOWMAP}set useBlurExponentialShadowMap(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_BLUREXPONENTIALSHADOWMAP);
!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_BLUREXPONENTIALSHADOWMAP||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get useCloseExponentialShadowMap(){return this.filter===G$$module$libs$world_onscreen.FILTER_CLOSEEXPONENTIALSHADOWMAP}set useCloseExponentialShadowMap(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_CLOSEEXPONENTIALSHADOWMAP);!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_CLOSEEXPONENTIALSHADOWMAP||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get useBlurCloseExponentialShadowMap(){return this.filter===
G$$module$libs$world_onscreen.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP}set useBlurCloseExponentialShadowMap(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP);!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get usePercentageCloserFiltering(){return this.filter===G$$module$libs$world_onscreen.FILTER_PCF}set usePercentageCloserFiltering(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_PCF);
!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_PCF||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get filteringQuality(){return this._filteringQuality}set filteringQuality(a){this._filteringQuality!==a&&(this._filteringQuality=a,this._disposeBlurPostProcesses(),this._applyFilterValues(),this._light._markMeshesAsLightDirty())}get useContactHardeningShadow(){return this.filter===G$$module$libs$world_onscreen.FILTER_PCSS}set useContactHardeningShadow(a){const b=this._validateFilter(G$$module$libs$world_onscreen.FILTER_PCSS);
!a&&this.filter!==G$$module$libs$world_onscreen.FILTER_PCSS||(this.filter=a?b:G$$module$libs$world_onscreen.FILTER_NONE)}get contactHardeningLightSizeUVRatio(){return this._contactHardeningLightSizeUVRatio}set contactHardeningLightSizeUVRatio(a){this._contactHardeningLightSizeUVRatio=a}get darkness(){return this._darkness}set darkness(a){this.setDarkness(a)}getDarkness(){return this._darkness}setDarkness(a){return 1<=a?this._darkness=1:0>=a?this._darkness=0:this._darkness=a,this}get transparencyShadow(){return this._transparencyShadow}set transparencyShadow(a){this.setTransparencyShadow(a)}setTransparencyShadow(a){return this._transparencyShadow=
a,this}getShadowMap(){return this._shadowMap}getShadowMapForRendering(){return this._shadowMap2?this._shadowMap2:this._shadowMap}getClassName(){return G$$module$libs$world_onscreen.CLASSNAME}addShadowCaster(a,b=!0){if(!this._shadowMap)return this;if(this._shadowMap.renderList||(this._shadowMap.renderList=[]),-1===this._shadowMap.renderList.indexOf(a)&&this._shadowMap.renderList.push(a),b)for(const c of a.getChildMeshes())-1===this._shadowMap.renderList.indexOf(c)&&this._shadowMap.renderList.push(c);
return this}removeShadowCaster(a,b=!0){if(!this._shadowMap||!this._shadowMap.renderList)return this;const c=this._shadowMap.renderList.indexOf(a);if(-1!==c&&this._shadowMap.renderList.splice(c,1),b)for(const d of a.getChildren())this.removeShadowCaster(d);return this}getLight(){return this._light}_getCamera(){var a;return null!==(a=this._camera)&&void 0!==a?a:this._scene.activeCamera}get mapSize(){return this._mapSize}set mapSize(a){this._mapSize=a;this._light._markMeshesAsLightDirty();this.recreateShadowMap()}_initializeGenerator(){this._light._markMeshesAsLightDirty();
this._initializeShadowMap()}_createTargetRenderTexture(){const a=this._scene.getEngine();a._features.supportDepthStencilTexture?(this._shadowMap=new _t$$module$libs$world_onscreen(this._light.name+"_shadowMap",this._mapSize,this._scene,!1,!0,this._textureType,this._light.needCube(),void 0,!1,!1),this._shadowMap.createDepthStencilTexture(a.useReverseDepthBuffer?516:513,!0)):this._shadowMap=new _t$$module$libs$world_onscreen(this._light.name+"_shadowMap",this._mapSize,this._scene,!1,!0,this._textureType,
this._light.needCube())}_initializeShadowMap(){if(this._createTargetRenderTexture(),null!==this._shadowMap){this._shadowMap.wrapU=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE;this._shadowMap.wrapV=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE;this._shadowMap.anisotropicFilteringLevel=1;this._shadowMap.updateSamplingMode(B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE);this._shadowMap.renderParticles=!1;this._shadowMap.ignoreCameraViewport=!0;this._storedUniqueId&&(this._shadowMap.uniqueId=
this._storedUniqueId);this._shadowMap.customRenderFunction=this._renderForShadowMap.bind(this);this._shadowMap.customIsReadyFunction=()=>!0;var a=this._scene.getEngine();this._shadowMap.onBeforeBindObservable.add(()=>{var d;this._currentSceneUBO=this._scene.getSceneUniformBuffer();null===(d=a._debugPushGroup)||void 0===d||d.call(a,`shadow map generation for pass id ${a.currentRenderPassId}`,1)});this._shadowMap.onBeforeRenderObservable.add(d=>{this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._sceneUBOs[0]);
this._currentFaceIndex=d;this._filter===G$$module$libs$world_onscreen.FILTER_PCF&&a.setColorWrite(!1);this.getTransformMatrix();this._scene.setTransformMatrix(this._viewMatrix,this._projectionMatrix);this._useUBO&&(this._scene.getSceneUniformBuffer().unbindEffect(),this._scene.finalizeSceneUbo())});this._shadowMap.onAfterUnbindObservable.add(()=>{var d,e;(this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._currentSceneUBO),this._scene.updateTransformMatrix(),this._filter===G$$module$libs$world_onscreen.FILTER_PCF&&
a.setColorWrite(!0),this.useBlurExponentialShadowMap||this.useBlurCloseExponentialShadowMap)?(d=this.getShadowMapForRendering())&&(this._scene.postProcessManager.directRender(this._blurPostProcesses,d.renderTarget,!0),a.unBindFramebuffer(d.renderTarget,!0),null===(e=a._debugPopGroup)||void 0===e||e.call(a,1)):null===(d=a._debugPopGroup)||void 0===d||d.call(a,1)});var b=new me$$module$libs$world_onscreen(0,0,0,0),c=new me$$module$libs$world_onscreen(1,1,1,1);this._shadowMap.onClearObservable.add(d=>
{this._filter===G$$module$libs$world_onscreen.FILTER_PCF?d.clear(c,!1,!0,!1):this.useExponentialShadowMap||this.useBlurExponentialShadowMap?d.clear(b,!0,!0,!1):d.clear(c,!0,!0,!1)});this._shadowMap.onResizeObservable.add(d=>{this._storedUniqueId=this._shadowMap.uniqueId;this._mapSize=d.getRenderSize();this._light._markMeshesAsLightDirty();this.recreateShadowMap()});for(let d=ze$$module$libs$world_onscreen.MIN_RENDERINGGROUPS;d<ze$$module$libs$world_onscreen.MAX_RENDERINGGROUPS;d++)this._shadowMap.setRenderingAutoClearDepthStencil(d,
!1)}}_initializeBlurRTTAndPostProcesses(){const a=this._scene.getEngine(),b=this._mapSize/this.blurScale;this.useKernelBlur&&1===this.blurScale||(this._shadowMap2=new _t$$module$libs$world_onscreen(this._light.name+"_shadowMap2",b,this._scene,!1,!0,this._textureType,void 0,void 0,!1),this._shadowMap2.wrapU=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE,this._shadowMap2.wrapV=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE,this._shadowMap2.updateSamplingMode(B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE));
this.useKernelBlur?(this._kernelBlurXPostprocess=new Jt$$module$libs$world_onscreen(this._light.name+"KernelBlurX",new Te$$module$libs$world_onscreen(1,0),this.blurKernel,1,null,B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE,a,!1,this._textureType),this._kernelBlurXPostprocess.width=b,this._kernelBlurXPostprocess.height=b,this._kernelBlurXPostprocess.externalTextureSamplerBinding=!0,this._kernelBlurXPostprocess.onApplyObservable.add(c=>{c.setTexture("textureSampler",this._shadowMap)}),this._kernelBlurYPostprocess=
new Jt$$module$libs$world_onscreen(this._light.name+"KernelBlurY",new Te$$module$libs$world_onscreen(0,1),this.blurKernel,1,null,B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE,a,!1,this._textureType),this._kernelBlurXPostprocess.autoClear=!1,this._kernelBlurYPostprocess.autoClear=!1,0===this._textureType&&(this._kernelBlurXPostprocess.packedFloat=!0,this._kernelBlurYPostprocess.packedFloat=!0),this._blurPostProcesses=[this._kernelBlurXPostprocess,this._kernelBlurYPostprocess]):(this._boxBlurPostprocess=
new Se$$module$libs$world_onscreen(this._light.name+"DepthBoxBlur","depthBoxBlur",["screenSize","boxOffset"],[],1,null,B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE,a,!1,"#define OFFSET "+this._blurBoxOffset,this._textureType),this._boxBlurPostprocess.externalTextureSamplerBinding=!0,this._boxBlurPostprocess.onApplyObservable.add(c=>{c.setFloat2("screenSize",b,b);c.setTexture("textureSampler",this._shadowMap)}),this._boxBlurPostprocess.autoClear=!1,this._blurPostProcesses=[this._boxBlurPostprocess])}_renderForShadowMap(a,
b,c,d){let e;if(d.length)for(e=0;e<d.length;e++)this._renderSubMeshForShadowMap(d.data[e]);for(e=0;e<a.length;e++)this._renderSubMeshForShadowMap(a.data[e]);for(e=0;e<b.length;e++)this._renderSubMeshForShadowMap(b.data[e]);if(this._transparencyShadow)for(e=0;e<c.length;e++)this._renderSubMeshForShadowMap(c.data[e],!0);else for(e=0;e<c.length;e++)c.data[e].getEffectiveMesh()._internalAbstractMeshDataInfo._isActiveIntermediate=!1}_bindCustomEffectForRenderSubMeshForShadowMap(a,b,c){b.setMatrix("viewProjection",
this.getTransformMatrix())}_renderSubMeshForShadowMap(a,b=!1){var c,d;const e=a.getRenderingMesh(),g=a.getEffectiveMesh(),n=this._scene,t=n.getEngine(),w=a.getMaterial();if(g._internalAbstractMeshDataInfo._isActiveIntermediate=!1,w&&0!==a.verticesCount&&a._renderId!==n.getRenderId()){var z=0>g._getWorldMatrixDeterminant(),C=null!==(c=e.overrideMaterialSideOrientation)&&void 0!==c?c:w.sideOrientation;z&&(C=0===C?1:0);t.setState(w.backFaceCulling,void 0,void 0,0===C,w.cullBackFaces);c=e._getInstancesRenderList(a._id,
!!a.getReplacementMesh());if(!c.mustReturn&&(z=t.getCaps().instancedArrays&&(null!==c.visibleInstances[a._id]&&void 0!==c.visibleInstances[a._id]||e.hasThinInstances),!this.customAllowRendering||this.customAllowRendering(a)))if(this.isReady(a,z,b)){a._renderId=n.getRenderId();C=w.shadowDepthWrapper;const H=null!==(d=null==C?void 0:C.getEffect(a,this,t.currentRenderPassId))&&void 0!==d?d:a._getDrawWrapper(),M=Ri$$module$libs$world_onscreen.GetEffect(H);t.enableEffect(H);z||e._bind(a,M,w.fillMode);
this.getTransformMatrix();M.setFloat3("biasAndScaleSM",this.bias,this.normalBias,this.depthScale);this.getLight().getTypeID()===he$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT?M.setVector3("lightDataSM",this._cachedDirection):M.setVector3("lightDataSM",this._cachedPosition);d=this._getCamera();if(d&&M.setFloat2("depthValuesSM",this.getLight().getDepthMinZ(d),this.getLight().getDepthMinZ(d)+this.getLight().getDepthMaxZ(d)),b&&this.enableSoftTransparentShadow&&M.setFloat("softTransparentShadowSM",
g.visibility*w.alpha),C)a._setMainDrawWrapperOverride(H),C.standalone?C.baseMaterial.bindForSubMesh(g.getWorldMatrix(),e,a):w.bindForSubMesh(g.getWorldMatrix(),e,a),a._setMainDrawWrapperOverride(null);else{this.useOpacityTextureForTransparentShadow?(b=w.opacityTexture)&&(M.setTexture("diffuseSampler",b),M.setMatrix("diffuseMatrix",b.getTextureMatrix()||this._defaultTextureMatrix)):(w.needAlphaTesting()||w.needAlphaBlending())&&(b=w.getAlphaTestTexture())&&(M.setTexture("diffuseSampler",b),M.setMatrix("diffuseMatrix",
b.getTextureMatrix()||this._defaultTextureMatrix));if(e.useBones&&e.computeBonesUsingShaders&&e.skeleton)if(b=e.skeleton,b.isUsingTextureForMatrices){d=b.getTransformMatrixTexture(e);if(!d)return;M.setTexture("boneSampler",d);M.setFloat("boneTextureWidth",4*(b.bones.length+1))}else M.setMatrices("mBones",b.getTransformMatrices(e));te$$module$libs$world_onscreen.BindMorphTargetParameters(e,M);e.morphTargetManager&&e.morphTargetManager.isUsingTextureForTargets&&e.morphTargetManager._bind(M);cs$$module$libs$world_onscreen(M,
w,n)}this._useUBO||C||this._bindCustomEffectForRenderSubMeshForShadowMap(a,M,g);te$$module$libs$world_onscreen.BindSceneUniformBuffer(M,this._scene.getSceneUniformBuffer());this._scene.getSceneUniformBuffer().bindUniformBuffer();const L=g.getWorldMatrix();z&&(g.getMeshUniformBuffer().bindToEffect(M,"Mesh"),g.transferToEffect(L));this.forceBackFacesOnly&&t.setState(!0,0,!1,!0,w.cullBackFaces);this.onBeforeShadowMapRenderMeshObservable.notifyObservers(e);this.onBeforeShadowMapRenderObservable.notifyObservers(M);
e._processRendering(g,a,M,w.fillMode,c,z,(O,S)=>{g===e||O?(g.getMeshUniformBuffer().bindToEffect(M,"Mesh"),g.transferToEffect(O?S:L)):(e.getMeshUniformBuffer().bindToEffect(M,"Mesh"),e.transferToEffect(S))});this.forceBackFacesOnly&&t.setState(!0,0,!1,!1,w.cullBackFaces);this.onAfterShadowMapRenderObservable.notifyObservers(M);this.onAfterShadowMapRenderMeshObservable.notifyObservers(e)}else this._shadowMap&&this._shadowMap.resetRefreshCounter()}}_applyFilterValues(){this._shadowMap&&(this.filter===
G$$module$libs$world_onscreen.FILTER_NONE||this.filter===G$$module$libs$world_onscreen.FILTER_PCSS?this._shadowMap.updateSamplingMode(B$$module$libs$world_onscreen.NEAREST_SAMPLINGMODE):this._shadowMap.updateSamplingMode(B$$module$libs$world_onscreen.BILINEAR_SAMPLINGMODE))}forceCompilation(a,b){const c={useInstances:!1,...b};if(b=this.getShadowMap())if(b=b.renderList){var d=[];for(const n of b)d.push(...n.subMeshes);if(0===d.length)a&&a(this);else{var e=0,g=()=>{var n,t;if(this._scene&&this._scene.getEngine()){for(;this.isReady(d[e],
c.useInstances,null!==(t=null===(n=d[e].getMaterial())||void 0===n?void 0:n.needAlphaBlendingForMesh(d[e].getMesh()))&&void 0!==t?t:!1);)if(e++,e>=d.length){a&&a(this);return}setTimeout(g,16)}};g()}}else a&&a(this);else a&&a(this)}forceCompilationAsync(a){return new Promise(b=>{this.forceCompilation(()=>{b()},a)})}_isReadyCustomDefines(a,b,c){}_prepareShadowDefines(a,b,c,d){c.push("#define SM_LIGHTTYPE_"+this._light.getClassName().toUpperCase());c.push("#define SM_FLOAT "+(0!==this._textureType?"1":
"0"));c.push("#define SM_ESM "+(this.useExponentialShadowMap||this.useBlurExponentialShadowMap?"1":"0"));c.push("#define SM_DEPTHTEXTURE "+(this.usePercentageCloserFiltering||this.useContactHardeningShadow?"1":"0"));const e=a.getMesh();return c.push("#define SM_NORMALBIAS "+(this.normalBias&&e.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)?"1":"0")),c.push("#define SM_DIRECTIONINLIGHTDATA "+(this.getLight().getTypeID()===he$$module$libs$world_onscreen.LIGHTTYPEID_DIRECTIONALLIGHT?
"1":"0")),c.push("#define SM_USEDISTANCE "+(this._light.needCube()?"1":"0")),c.push("#define SM_SOFTTRANSPARENTSHADOW "+(this.enableSoftTransparentShadow&&d?"1":"0")),this._isReadyCustomDefines(c,a,b),c}isReady(a,b,c){var d,e=a.getMaterial(),g=null==e?void 0:e.shadowDepthWrapper;if(!e)return!1;var n=[];if(this._prepareShadowDefines(a,b,n,c),g){if(!g.isReadyForSubMesh(a,n,this,b,this._scene.getEngine().currentRenderPassId))return!1}else{c=a._getDrawWrapper(void 0,!0);let C=c.effect;g=c.defines;const H=
[g$$module$libs$world_onscreen.PositionKind],M=a.getMesh();this.normalBias&&M.isVerticesDataPresent(g$$module$libs$world_onscreen.NormalKind)&&(H.push(g$$module$libs$world_onscreen.NormalKind),n.push("#define NORMAL"),M.nonUniformScaling&&n.push("#define NONUNIFORMSCALING"));var t=null==e?void 0:e.needAlphaTesting(),w=null==e?void 0:e.needAlphaBlending();if(e&&(t||w)&&(w=null,this.useOpacityTextureForTransparentShadow?w=e.opacityTexture:w=e.getAlphaTestTexture(),w)){if(!w.isReady())return!1;const L=
null!==(d=e.alphaCutOff)&&void 0!==d?d:G$$module$libs$world_onscreen.DEFAULT_ALPHA_CUTOFF;n.push("#define ALPHATEXTURE");t&&n.push(`#define ALPHATESTVALUE ${L}${0===L%1?".":""}`);M.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind)&&(H.push(g$$module$libs$world_onscreen.UVKind),n.push("#define UV1"));M.isVerticesDataPresent(g$$module$libs$world_onscreen.UV2Kind)&&1===w.coordinatesIndex&&(H.push(g$$module$libs$world_onscreen.UV2Kind),n.push("#define UV2"))}d=new qs$$module$libs$world_onscreen;
M.useBones&&M.computeBonesUsingShaders&&M.skeleton?(H.push(g$$module$libs$world_onscreen.MatricesIndicesKind),H.push(g$$module$libs$world_onscreen.MatricesWeightsKind),4<M.numBoneInfluencers&&(H.push(g$$module$libs$world_onscreen.MatricesIndicesExtraKind),H.push(g$$module$libs$world_onscreen.MatricesWeightsExtraKind)),t=M.skeleton,n.push("#define NUM_BONE_INFLUENCERS "+M.numBoneInfluencers),0<M.numBoneInfluencers&&d.addCPUSkinningFallback(0,M),t.isUsingTextureForMatrices?n.push("#define BONETEXTURE"):
n.push("#define BonesPerMesh "+(t.bones.length+1))):n.push("#define NUM_BONE_INFLUENCERS 0");w=M.morphTargetManager;t=0;if(w&&0<w.numInfluencers&&(n.push("#define MORPHTARGETS"),t=w.numInfluencers,n.push("#define NUM_MORPH_INFLUENCERS "+t),w.isUsingTextureForTargets&&n.push("#define MORPHTARGETS_TEXTURE"),te$$module$libs$world_onscreen.PrepareAttributesForMorphTargetsInfluencers(H,M,t)),Ys$$module$libs$world_onscreen(e,this._scene,n),b&&(n.push("#define INSTANCES"),te$$module$libs$world_onscreen.PushAttributesForInstances(H),
a.getRenderingMesh().hasThinInstances&&n.push("#define THIN_INSTANCES")),this.customShaderOptions&&this.customShaderOptions.defines)for(const L of this.customShaderOptions.defines)-1===n.indexOf(L)&&n.push(L);a=n.join("\n");if(g!==a){g=a;b="shadowMap";e="world mBones viewProjection diffuseMatrix lightDataSM depthValuesSM biasAndScaleSM morphTargetInfluences boneTextureWidth softTransparentShadowSM morphTargetTextureInfo morphTargetTextureIndices".split(" ");n=["diffuseSampler","boneSampler","morphTargets"];
if(ls$$module$libs$world_onscreen(e),this.customShaderOptions){if(b=this.customShaderOptions.shaderName,this.customShaderOptions.attributes)for(var z of this.customShaderOptions.attributes)-1===H.indexOf(z)&&H.push(z);if(this.customShaderOptions.uniforms)for(const L of this.customShaderOptions.uniforms)-1===e.indexOf(L)&&e.push(L);if(this.customShaderOptions.samplers)for(const L of this.customShaderOptions.samplers)-1===n.indexOf(L)&&n.push(L)}z=this._scene.getEngine();C=z.createEffect(b,{attributes:H,
uniformsNames:e,uniformBuffersNames:["Scene","Mesh"],samplers:n,defines:a,fallbacks:d,onCompiled:null,onError:null,indexParameters:{maxSimultaneousMorphTargets:t}},z);c.setEffect(C,g)}if(!C.isReady())return!1}return(this.useBlurExponentialShadowMap||this.useBlurCloseExponentialShadowMap)&&(!this._blurPostProcesses||!this._blurPostProcesses.length)&&this._initializeBlurRTTAndPostProcesses(),!(this._kernelBlurXPostprocess&&!this._kernelBlurXPostprocess.isReady()||this._kernelBlurYPostprocess&&!this._kernelBlurYPostprocess.isReady()||
this._boxBlurPostprocess&&!this._boxBlurPostprocess.isReady())}prepareDefines(a,b){const c=this._light;!this._scene.shadowsEnabled||!c.shadowEnabled||(a["SHADOW"+b]=!0,this.useContactHardeningShadow?(a["SHADOWPCSS"+b]=!0,this._filteringQuality===G$$module$libs$world_onscreen.QUALITY_LOW?a["SHADOWLOWQUALITY"+b]=!0:this._filteringQuality===G$$module$libs$world_onscreen.QUALITY_MEDIUM&&(a["SHADOWMEDIUMQUALITY"+b]=!0)):this.usePercentageCloserFiltering?(a["SHADOWPCF"+b]=!0,this._filteringQuality===G$$module$libs$world_onscreen.QUALITY_LOW?
a["SHADOWLOWQUALITY"+b]=!0:this._filteringQuality===G$$module$libs$world_onscreen.QUALITY_MEDIUM&&(a["SHADOWMEDIUMQUALITY"+b]=!0)):this.usePoissonSampling?a["SHADOWPOISSON"+b]=!0:this.useExponentialShadowMap||this.useBlurExponentialShadowMap?a["SHADOWESM"+b]=!0:(this.useCloseExponentialShadowMap||this.useBlurCloseExponentialShadowMap)&&(a["SHADOWCLOSEESM"+b]=!0),c.needCube()&&(a["SHADOWCUBE"+b]=!0))}bindShadowLight(a,b){const c=this._light;if(this._scene.shadowsEnabled&&c.shadowEnabled){var d=this._getCamera();
if(d){var e=this.getShadowMap();e&&(c.needCube()||b.setMatrix("lightMatrix"+a,this.getTransformMatrix()),this._filter===G$$module$libs$world_onscreen.FILTER_PCF?(b.setDepthStencilTexture("shadowSampler"+a,this.getShadowMapForRendering()),c._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),e.getSize().width,1/e.getSize().width,this.frustumEdgeFalloff,a)):this._filter===G$$module$libs$world_onscreen.FILTER_PCSS?(b.setDepthStencilTexture("shadowSampler"+a,this.getShadowMapForRendering()),
b.setTexture("depthSampler"+a,this.getShadowMapForRendering()),c._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),1/e.getSize().width,this._contactHardeningLightSizeUVRatio*e.getSize().width,this.frustumEdgeFalloff,a)):(b.setTexture("shadowSampler"+a,this.getShadowMapForRendering()),c._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),this.blurScale/e.getSize().width,this.depthScale,this.frustumEdgeFalloff,a)),c._uniformBuffer.updateFloat2("depthValues",this.getLight().getDepthMinZ(d),
this.getLight().getDepthMinZ(d)+this.getLight().getDepthMaxZ(d),a))}}}getTransformMatrix(){var a=this._scene;if(this._currentRenderId===a.getRenderId()&&this._currentFaceIndexCache===this._currentFaceIndex)return this._transformMatrix;this._currentRenderId=a.getRenderId();this._currentFaceIndexCache=this._currentFaceIndex;a=this._light.position;(this._light.computeTransformedInformation()&&(a=this._light.transformedPosition),p$$module$libs$world_onscreen.NormalizeToRef(this._light.getShadowDirection(this._currentFaceIndex),
this._lightDirection),1===Math.abs(p$$module$libs$world_onscreen.Dot(this._lightDirection,p$$module$libs$world_onscreen.Up()))&&(this._lightDirection.z=1E-13),!this._light.needProjectionMatrixCompute()&&this._cachedPosition&&this._cachedDirection&&a.equals(this._cachedPosition)&&this._lightDirection.equals(this._cachedDirection))||(this._cachedPosition.copyFrom(a),this._cachedDirection.copyFrom(this._lightDirection),x$$module$libs$world_onscreen.LookAtLHToRef(a,a.add(this._lightDirection),p$$module$libs$world_onscreen.Up(),
this._viewMatrix),(a=this.getShadowMap())&&(a=a.renderList)&&this._light.setShadowProjectionMatrix(this._projectionMatrix,this._viewMatrix,a),this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix));return this._transformMatrix}recreateShadowMap(){var a=this._shadowMap;if(a)if(a=a.renderList,this._disposeRTTandPostProcesses(),this._initializeGenerator(),this.filter=this._filter,this._applyFilterValues(),a){this._shadowMap.renderList||(this._shadowMap.renderList=[]);for(const b of a)this._shadowMap.renderList.push(b)}else this._shadowMap.renderList=
null}_disposeBlurPostProcesses(){this._shadowMap2&&(this._shadowMap2.dispose(),this._shadowMap2=null);this._boxBlurPostprocess&&(this._boxBlurPostprocess.dispose(),this._boxBlurPostprocess=null);this._kernelBlurXPostprocess&&(this._kernelBlurXPostprocess.dispose(),this._kernelBlurXPostprocess=null);this._kernelBlurYPostprocess&&(this._kernelBlurYPostprocess.dispose(),this._kernelBlurYPostprocess=null);this._blurPostProcesses=[]}_disposeRTTandPostProcesses(){this._shadowMap&&(this._shadowMap.dispose(),
this._shadowMap=null);this._disposeBlurPostProcesses()}_disposeSceneUBOs(){if(this._sceneUBOs){for(const a of this._sceneUBOs)a.dispose();this._sceneUBOs=[]}}dispose(){if(this._disposeRTTandPostProcesses(),this._disposeSceneUBOs(),this._light){if(this._light._shadowGenerators){const a=this._light._shadowGenerators.entries();for(let b=a.next();!0!==b.done;b=a.next()){const [c,d]=b.value;d===this&&this._light._shadowGenerators.delete(c)}0===this._light._shadowGenerators.size&&(this._light._shadowGenerators=
null)}this._light._markMeshesAsLightDirty()}this.onBeforeShadowMapRenderMeshObservable.clear();this.onBeforeShadowMapRenderObservable.clear();this.onAfterShadowMapRenderMeshObservable.clear();this.onAfterShadowMapRenderObservable.clear()}serialize(){var a;const b={},c=this.getShadowMap();if(!c)return b;if(b.className=this.getClassName(),b.lightId=this._light.id,b.cameraId=null===(a=this._camera)||void 0===a?void 0:a.id,b.id=this.id,b.mapSize=c.getRenderSize(),b.forceBackFacesOnly=this.forceBackFacesOnly,
b.darkness=this.getDarkness(),b.transparencyShadow=this._transparencyShadow,b.frustumEdgeFalloff=this.frustumEdgeFalloff,b.bias=this.bias,b.normalBias=this.normalBias,b.usePercentageCloserFiltering=this.usePercentageCloserFiltering,b.useContactHardeningShadow=this.useContactHardeningShadow,b.contactHardeningLightSizeUVRatio=this.contactHardeningLightSizeUVRatio,b.filteringQuality=this.filteringQuality,b.useExponentialShadowMap=this.useExponentialShadowMap,b.useBlurExponentialShadowMap=this.useBlurExponentialShadowMap,
b.useCloseExponentialShadowMap=this.useBlurExponentialShadowMap,b.useBlurCloseExponentialShadowMap=this.useBlurExponentialShadowMap,b.usePoissonSampling=this.usePoissonSampling,b.depthScale=this.depthScale,b.blurBoxOffset=this.blurBoxOffset,b.blurKernel=this.blurKernel,b.blurScale=this.blurScale,b.useKernelBlur=this.useKernelBlur,b.renderList=[],c.renderList)for(a=0;a<c.renderList.length;a++)b.renderList.push(c.renderList[a].id);return b}static Parse(a,b,c){var d=b.getLightById(a.lightId);const e=
void 0!==a.cameraId?b.getCameraById(a.cameraId):null;c=c?c(a.mapSize,d,e):new G$$module$libs$world_onscreen(a.mapSize,d,void 0,e);const g=c.getShadowMap();for(d=0;d<a.renderList.length;d++)b.getMeshesById(a.renderList[d]).forEach(function(n){g&&(g.renderList||(g.renderList=[]),g.renderList.push(n))});return void 0!==a.id&&(c.id=a.id),c.forceBackFacesOnly=!!a.forceBackFacesOnly,void 0!==a.darkness&&c.setDarkness(a.darkness),a.transparencyShadow&&c.setTransparencyShadow(!0),void 0!==a.frustumEdgeFalloff&&
(c.frustumEdgeFalloff=a.frustumEdgeFalloff),void 0!==a.bias&&(c.bias=a.bias),void 0!==a.normalBias&&(c.normalBias=a.normalBias),a.usePercentageCloserFiltering?c.usePercentageCloserFiltering=!0:a.useContactHardeningShadow?c.useContactHardeningShadow=!0:a.usePoissonSampling?c.usePoissonSampling=!0:a.useExponentialShadowMap?c.useExponentialShadowMap=!0:a.useBlurExponentialShadowMap?c.useBlurExponentialShadowMap=!0:a.useCloseExponentialShadowMap?c.useCloseExponentialShadowMap=!0:a.useBlurCloseExponentialShadowMap?
c.useBlurCloseExponentialShadowMap=!0:a.useVarianceShadowMap?c.useExponentialShadowMap=!0:a.useBlurVarianceShadowMap&&(c.useBlurExponentialShadowMap=!0),void 0!==a.contactHardeningLightSizeUVRatio&&(c.contactHardeningLightSizeUVRatio=a.contactHardeningLightSizeUVRatio),void 0!==a.filteringQuality&&(c.filteringQuality=a.filteringQuality),a.depthScale&&(c.depthScale=a.depthScale),a.blurScale&&(c.blurScale=a.blurScale),a.blurBoxOffset&&(c.blurBoxOffset=a.blurBoxOffset),a.useKernelBlur&&(c.useKernelBlur=
a.useKernelBlur),a.blurKernel&&(c.blurKernel=a.blurKernel),c}}G$$module$libs$world_onscreen.CLASSNAME="ShadowGenerator";G$$module$libs$world_onscreen.FILTER_NONE=0;G$$module$libs$world_onscreen.FILTER_EXPONENTIALSHADOWMAP=1;G$$module$libs$world_onscreen.FILTER_POISSONSAMPLING=2;G$$module$libs$world_onscreen.FILTER_BLUREXPONENTIALSHADOWMAP=3;G$$module$libs$world_onscreen.FILTER_CLOSEEXPONENTIALSHADOWMAP=4;G$$module$libs$world_onscreen.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP=5;
G$$module$libs$world_onscreen.FILTER_PCF=6;G$$module$libs$world_onscreen.FILTER_PCSS=7;G$$module$libs$world_onscreen.QUALITY_HIGH=0;G$$module$libs$world_onscreen.QUALITY_MEDIUM=1;G$$module$libs$world_onscreen.QUALITY_LOW=2;G$$module$libs$world_onscreen.DEFAULT_ALPHA_CUTOFF=.5;G$$module$libs$world_onscreen._SceneComponentInitialization=a=>{throw $$$module$libs$world_onscreen("ShadowGeneratorSceneComponent");};const Po$$module$libs$world_onscreen="depthPixelShader",Do$$module$libs$world_onscreen="#ifdef ALPHATEST\nvarying vec2 vUV;\nuniform sampler2D diffuseSampler;\n#endif\n#include<clipPlaneFragmentDeclaration>\nvarying float vDepthMetric;\n#ifdef PACKED\n#include<packingFunctions>\n#endif\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void)\n{\n#include<clipPlaneFragment>\n#ifdef ALPHATEST\nif (texture2D(diffuseSampler,vUV).a<0.4)\ndiscard;\n#endif\n#ifdef NONLINEARDEPTH\n#ifdef PACKED\ngl_FragColor=pack(gl_FragCoord.z);\n#else\ngl_FragColor=vec4(gl_FragCoord.z,0.0,0.0,0.0);\n#endif\n#else\n#ifdef PACKED\ngl_FragColor=pack(vDepthMetric);\n#else\ngl_FragColor=vec4(vDepthMetric,0.0,0.0,1.0);\n#endif\n#endif\n}";
U$$module$libs$world_onscreen.ShadersStore[Po$$module$libs$world_onscreen]=Do$$module$libs$world_onscreen;const Fo$$module$libs$world_onscreen="instancesDeclaration",wo$$module$libs$world_onscreen="#ifdef INSTANCES\nattribute vec4 world0;\nattribute vec4 world1;\nattribute vec4 world2;\nattribute vec4 world3;\n#ifdef INSTANCESCOLOR\nattribute vec4 instanceColor;\n#endif\n#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY)\nattribute vec4 previousWorld0;\nattribute vec4 previousWorld1;\nattribute vec4 previousWorld2;\nattribute vec4 previousWorld3;\n#ifdef THIN_INSTANCES\nuniform mat4 previousWorld;\n#endif\n#endif\n#else\n#if !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY)\nuniform mat4 previousWorld;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Fo$$module$libs$world_onscreen]=wo$$module$libs$world_onscreen;const Oo$$module$libs$world_onscreen="depthVertexShader",Lo$$module$libs$world_onscreen="attribute vec3 position;\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<morphTargetsVertexGlobalDeclaration>\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\n#include<clipPlaneVertexDeclaration>\n#include<instancesDeclaration>\nuniform mat4 viewProjection;\nuniform vec2 depthValues;\n#if defined(ALPHATEST) || defined(NEED_UV)\nvarying vec2 vUV;\nuniform mat4 diffuseMatrix;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#endif\nvarying float vDepthMetric;\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void)\n{\nvec3 positionUpdated=position;\n#ifdef UV1\nvec2 uvUpdated=uv;\n#endif\n#include<morphTargetsVertexGlobal>\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\n#include<instancesVertex>\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);\n#include<clipPlaneVertex>\ngl_Position=viewProjection*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric=((-gl_Position.z+depthValues.x)/(depthValues.y));\n#else\nvDepthMetric=((gl_Position.z+depthValues.x)/(depthValues.y));\n#endif\n#if defined(ALPHATEST) || defined(BASIC_RENDER)\n#ifdef UV1\nvUV=vec2(diffuseMatrix*vec4(uvUpdated,1.0,0.0));\n#endif\n#ifdef UV2\nvUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n#endif\n#endif\n}\n";
U$$module$libs$world_onscreen.ShadersStore[Oo$$module$libs$world_onscreen]=Lo$$module$libs$world_onscreen;
class ds$$module$libs$world_onscreen{constructor(a,b=1,c=null,d=!1,e=B$$module$libs$world_onscreen.TRILINEAR_SAMPLINGMODE){this.enabled=!0;this.useOnlyInActiveCamera=this.forceDepthWriteTransparentMeshes=!1;this._scene=a;this._storeNonLinearDepth=d;(this.isPacked=0===b)?this._clearColor=new me$$module$libs$world_onscreen(1,1,1,1):this._clearColor=new me$$module$libs$world_onscreen(1,0,0,1);ds$$module$libs$world_onscreen._SceneComponentInitialization(this._scene);const g=a.getEngine();this._camera=
c;e!==B$$module$libs$world_onscreen.NEAREST_SAMPLINGMODE&&(1===b&&!g._caps.textureFloatLinearFiltering&&(e=B$$module$libs$world_onscreen.NEAREST_SAMPLINGMODE),2===b&&!g._caps.textureHalfFloatLinearFiltering&&(e=B$$module$libs$world_onscreen.NEAREST_SAMPLINGMODE));a=this.isPacked||!g._features.supportExtendedTextureFormats?5:6;this._depthMap=new _t$$module$libs$world_onscreen("DepthRenderer",{width:g.getRenderWidth(),height:g.getRenderHeight()},this._scene,!1,!0,b,!1,e,void 0,void 0,void 0,a);this._depthMap.wrapU=
B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE;this._depthMap.wrapV=B$$module$libs$world_onscreen.CLAMP_ADDRESSMODE;this._depthMap.refreshRate=1;this._depthMap.renderParticles=!1;this._depthMap.renderList=null;this._depthMap.activeCamera=this._camera;this._depthMap.ignoreCameraViewport=!0;this._depthMap.useCameraPostProcesses=!1;this._depthMap.onClearObservable.add(t=>{t.clear(this._clearColor,!0,!0,!0)});this._depthMap.onBeforeBindObservable.add(()=>{var t;null===(t=g._debugPushGroup)||void 0===
t||t.call(g,"depth renderer",1)});this._depthMap.onAfterUnbindObservable.add(()=>{var t;null===(t=g._debugPopGroup)||void 0===t||t.call(g,1)});this._depthMap.customIsReadyFunction=(t,w,z)=>{if((z||0===w)&&t.subMeshes)for(w=0;w<t.subMeshes.length;++w){z=t.subMeshes[w];var C=z.getRenderingMesh();const H=C._getInstancesRenderList(z._id,!!z.getReplacementMesh());C=g.getCaps().instancedArrays&&(null!==H.visibleInstances[z._id]&&void 0!==H.visibleInstances[z._id]||C.hasThinInstances);if(!this.isReady(z,
C))return!1}return!0};const n=t=>{var w,z;const C=t.getRenderingMesh(),H=t.getEffectiveMesh(),M=this._scene;var L=M.getEngine();const O=t.getMaterial();if(H._internalAbstractMeshDataInfo._isActiveIntermediate=!1,O&&!H.infiniteDistance&&!O.disableDepthWrite&&0!==t.verticesCount&&t._renderId!==M.getRenderId()){var S=0>H._getWorldMatrixDeterminant(),T=null!==(w=C.overrideMaterialSideOrientation)&&void 0!==w?w:O.sideOrientation;S&&(T=0===T?1:0);L.setState(O.backFaceCulling,0,!1,0===T,O.cullBackFaces);
w=C._getInstancesRenderList(t._id,!!t.getReplacementMesh());if(!w.mustReturn&&(S=L.getCaps().instancedArrays&&(null!==w.visibleInstances[t._id]&&void 0!==w.visibleInstances[t._id]||C.hasThinInstances),T=this._camera||M.activeCamera,this.isReady(t,S)&&T)){t._renderId=M.getRenderId();const ca=null===(z=H._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===z?void 0:z[L.currentRenderPassId];z=t._getDrawWrapper();!z&&ca&&(z=ca._getDrawWrapper());const ba=T.mode===q$$module$libs$world_onscreen.ORTHOGRAPHIC_CAMERA;
if(z){var P=z.effect;L.enableEffect(z);S||C._bind(t,P,O.fillMode);ca?ca.bindForSubMesh(H.getWorldMatrix(),H,t):(P.setMatrix("viewProjection",M.getTransformMatrix()),P.setMatrix("world",H.getWorldMatrix()));var W,Z;if(ba?(W=!L.useReverseDepthBuffer&&L.isNDCHalfZRange?0:1,Z=L.useReverseDepthBuffer&&L.isNDCHalfZRange?0:1):(W=L.useReverseDepthBuffer&&L.isNDCHalfZRange?T.minZ:L.isNDCHalfZRange?0:T.minZ,Z=L.useReverseDepthBuffer&&L.isNDCHalfZRange?0:T.maxZ),P.setFloat2("depthValues",W,W+Z),!ca){O.needAlphaTesting()&&
(L=O.getAlphaTestTexture())&&(P.setTexture("diffuseSampler",L),P.setMatrix("diffuseMatrix",L.getTextureMatrix()));if(C.useBones&&C.computeBonesUsingShaders&&C.skeleton)if(L=C.skeleton,L.isUsingTextureForMatrices){W=L.getTransformMatrixTexture(C);if(!W)return;P.setTexture("boneSampler",W);P.setFloat("boneTextureWidth",4*(L.bones.length+1))}else P.setMatrices("mBones",L.getTransformMatrices(C));cs$$module$libs$world_onscreen(P,O,M);te$$module$libs$world_onscreen.BindMorphTargetParameters(C,P);C.morphTargetManager&&
C.morphTargetManager.isUsingTextureForTargets&&C.morphTargetManager._bind(P)}C._processRendering(H,t,P,O.fillMode,w,S,(la,ea)=>P.setMatrix("world",ea))}}}};this._depthMap.customRenderFunction=(t,w,z,C)=>{let H;if(C.length)for(H=0;H<C.length;H++)n(C.data[H]);for(H=0;H<t.length;H++)n(t.data[H]);for(H=0;H<w.length;H++)n(w.data[H]);if(this.forceDepthWriteTransparentMeshes)for(H=0;H<z.length;H++)n(z.data[H]);else for(H=0;H<z.length;H++)z.data[H].getEffectiveMesh()._internalAbstractMeshDataInfo._isActiveIntermediate=
!1}}setMaterialForRendering(a,b){this._depthMap.setMaterialForRendering(a,b)}isReady(a,b){var c;const d=this._scene.getEngine();var e=a.getMesh();const g=e.getScene();var n=null===(c=e._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===c?void 0:c[d.currentRenderPassId];if(n)return n.isReadyForSubMesh(e,a,b);const t=a.getMaterial();if(!t||t.disableDepthWrite)return!1;const w=[];c=[g$$module$libs$world_onscreen.PositionKind];(t&&t.needAlphaTesting()&&t.getAlphaTestTexture()&&(w.push("#define ALPHATEST"),
e.isVerticesDataPresent(g$$module$libs$world_onscreen.UVKind)&&(c.push(g$$module$libs$world_onscreen.UVKind),w.push("#define UV1")),e.isVerticesDataPresent(g$$module$libs$world_onscreen.UV2Kind)&&(c.push(g$$module$libs$world_onscreen.UV2Kind),w.push("#define UV2"))),e.useBones&&e.computeBonesUsingShaders)?(c.push(g$$module$libs$world_onscreen.MatricesIndicesKind),c.push(g$$module$libs$world_onscreen.MatricesWeightsKind),4<e.numBoneInfluencers&&(c.push(g$$module$libs$world_onscreen.MatricesIndicesExtraKind),
c.push(g$$module$libs$world_onscreen.MatricesWeightsExtraKind)),w.push("#define NUM_BONE_INFLUENCERS "+e.numBoneInfluencers),w.push("#define BonesPerMesh "+(e.skeleton?e.skeleton.bones.length+1:0)),n=a.getRenderingMesh().skeleton,null!=n&&n.isUsingTextureForMatrices&&w.push("#define BONETEXTURE")):w.push("#define NUM_BONE_INFLUENCERS 0");const z=e.morphTargetManager;n=0;z&&0<z.numInfluencers&&(n=z.numInfluencers,w.push("#define MORPHTARGETS"),w.push("#define NUM_MORPH_INFLUENCERS "+n),z.isUsingTextureForTargets&&
w.push("#define MORPHTARGETS_TEXTURE"),te$$module$libs$world_onscreen.PrepareAttributesForMorphTargetsInfluencers(c,e,n));b&&(w.push("#define INSTANCES"),te$$module$libs$world_onscreen.PushAttributesForInstances(c),a.getRenderingMesh().hasThinInstances&&w.push("#define THIN_INSTANCES"));this._storeNonLinearDepth&&w.push("#define NONLINEARDEPTH");this.isPacked&&w.push("#define PACKED");Ys$$module$libs$world_onscreen(t,g,w);a=a._getDrawWrapper(void 0,!0);b=a.defines;e=w.join("\n");b!==e&&(b="world mBones boneTextureWidth viewProjection diffuseMatrix depthValues morphTargetInfluences morphTargetTextureInfo morphTargetTextureIndices".split(" "),
ls$$module$libs$world_onscreen(b),a.setEffect(d.createEffect("depth",c,b,["diffuseSampler","morphTargets","boneSampler"],e,void 0,void 0,void 0,{maxSimultaneousMorphTargets:n}),e));return a.effect.isReady()}getDepthMap(){return this._depthMap}dispose(){const a=[];for(const b in this._scene._depthRenderer)this._scene._depthRenderer[b]===this&&a.push(b);if(0<a.length){this._depthMap.dispose();for(const b of a)delete this._scene._depthRenderer[b]}}}
ds$$module$libs$world_onscreen._SceneComponentInitialization=a=>{throw $$$module$libs$world_onscreen("DepthRendererSceneComponent");};const No$$module$libs$world_onscreen="minmaxReduxPixelShader",Bo$$module$libs$world_onscreen="varying vec2 vUV;\nuniform sampler2D textureSampler;\n#if defined(INITIAL)\nuniform sampler2D sourceTexture;\nuniform vec2 texSize;\nvoid main(void)\n{\nivec2 coord=ivec2(vUV*(texSize-1.0));\nfloat f1=texelFetch(sourceTexture,coord,0).r;\nfloat f2=texelFetch(sourceTexture,coord+ivec2(1,0),0).r;\nfloat f3=texelFetch(sourceTexture,coord+ivec2(1,1),0).r;\nfloat f4=texelFetch(sourceTexture,coord+ivec2(0,1),0).r;\nfloat minz=min(min(min(f1,f2),f3),f4);\n#ifdef DEPTH_REDUX\nfloat maxz=max(max(max(sign(1.0-f1)*f1,sign(1.0-f2)*f2),sign(1.0-f3)*f3),sign(1.0-f4)*f4);\n#else\nfloat maxz=max(max(max(f1,f2),f3),f4);\n#endif\nglFragColor=vec4(minz,maxz,0.,0.);\n}\n#elif defined(MAIN)\nuniform vec2 texSize;\nvoid main(void)\n{\nivec2 coord=ivec2(vUV*(texSize-1.0));\nvec2 f1=texelFetch(textureSampler,coord,0).rg;\nvec2 f2=texelFetch(textureSampler,coord+ivec2(1,0),0).rg;\nvec2 f3=texelFetch(textureSampler,coord+ivec2(1,1),0).rg;\nvec2 f4=texelFetch(textureSampler,coord+ivec2(0,1),0).rg;\nfloat minz=min(min(min(f1.x,f2.x),f3.x),f4.x);\nfloat maxz=max(max(max(f1.y,f2.y),f3.y),f4.y);\nglFragColor=vec4(minz,maxz,0.,0.);\n}\n#elif defined(ONEBEFORELAST)\nuniform ivec2 texSize;\nvoid main(void)\n{\nivec2 coord=ivec2(vUV*vec2(texSize-1));\nvec2 f1=texelFetch(textureSampler,coord % texSize,0).rg;\nvec2 f2=texelFetch(textureSampler,(coord+ivec2(1,0)) % texSize,0).rg;\nvec2 f3=texelFetch(textureSampler,(coord+ivec2(1,1)) % texSize,0).rg;\nvec2 f4=texelFetch(textureSampler,(coord+ivec2(0,1)) % texSize,0).rg;\nfloat minz=min(f1.x,f2.x);\nfloat maxz=max(f1.y,f2.y);\nglFragColor=vec4(minz,maxz,0.,0.);\n}\n#elif defined(LAST)\nvoid main(void)\n{\nglFragColor=vec4(0.);\nif (true) { \ndiscard;\n}\n}\n#endif\n";
U$$module$libs$world_onscreen.ShadersStore[No$$module$libs$world_onscreen]=Bo$$module$libs$world_onscreen;
class Uo$$module$libs$world_onscreen{constructor(a){this.onAfterReductionPerformed=new w$$module$libs$world_onscreen;this._forceFullscreenViewport=!0;this._activated=!1;this._camera=a;this._postProcessManager=new ts$$module$libs$world_onscreen(a.getScene());this._onContextRestoredObserver=a.getEngine().onContextRestoredObservable.add(()=>{this._postProcessManager._rebuild()})}get sourceTexture(){return this._sourceTexture}setSourceTexture(a,b,c=2,d=!0){if(a!==this._sourceTexture){this.dispose(!1);
this._sourceTexture=a;this._reductionSteps=[];this._forceFullscreenViewport=d;var e=this._camera.getScene(),g=new Se$$module$libs$world_onscreen("Initial reduction phase","minmaxRedux",["texSize"],["sourceTexture"],1,null,1,e.getEngine(),!1,"#define INITIAL"+(b?"\n#define DEPTH_REDUX":""),c,void 0,void 0,void 0,7);g.autoClear=!1;g.forceFullscreenViewport=d;a=this._sourceTexture.getRenderWidth();b=this._sourceTexture.getRenderHeight();g.onApply=((n,t)=>w=>{w.setTexture("sourceTexture",this._sourceTexture);
w.setFloat2("texSize",n,t)})(a,b);this._reductionSteps.push(g);for(g=1;1<a||1<b;){a=Math.max(Math.round(a/2),1);b=Math.max(Math.round(b/2),1);const n=new Se$$module$libs$world_onscreen("Reduction phase "+g,"minmaxRedux",["texSize"],null,{width:a,height:b},null,1,e.getEngine(),!1,"#define "+(1==a&&1==b?"LAST":1==a||1==b?"ONEBEFORELAST":"MAIN"),c,void 0,void 0,void 0,7);(n.autoClear=!1,n.forceFullscreenViewport=d,n.onApply=((t,w)=>z=>{1==t||1==w?z.setInt2("texSize",t,w):z.setFloat2("texSize",t,w)})(a,
b),this._reductionSteps.push(n),g++,1==a&&1==b)&&n.onAfterRenderObservable.add(((t,w,z)=>{const C=new Float32Array(4*t*w),H={min:0,max:0};return()=>{e.getEngine()._readTexturePixels(z.inputTexture.texture,t,w,-1,0,C,!1);H.min=C[0];H.max=C[1];this.onAfterReductionPerformed.notifyObservers(H)}})(a,b,n))}}}get refreshRate(){return this._sourceTexture?this._sourceTexture.refreshRate:-1}set refreshRate(a){this._sourceTexture&&(this._sourceTexture.refreshRate=a)}get activated(){return this._activated}activate(){this._onAfterUnbindObserver||
!this._sourceTexture||(this._onAfterUnbindObserver=this._sourceTexture.onAfterUnbindObservable.add(()=>{var a,b;const c=this._camera.getScene().getEngine();null===(a=c._debugPushGroup)||void 0===a||a.call(c,"min max reduction",1);this._reductionSteps[0].activate(this._camera);this._postProcessManager.directRender(this._reductionSteps,this._reductionSteps[0].inputTexture,this._forceFullscreenViewport);c.unBindFramebuffer(this._reductionSteps[0].inputTexture,!1);null===(b=c._debugPopGroup)||void 0===
b||b.call(c,1)}),this._activated=!0)}deactivate(){!this._onAfterUnbindObserver||!this._sourceTexture||(this._sourceTexture.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=null,this._activated=!1)}dispose(a=!0){if(a&&(this.onAfterReductionPerformed.clear(),this._onContextRestoredObserver&&(this._camera.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)),this.deactivate(),this._reductionSteps){for(let b=
0;b<this._reductionSteps.length;++b)this._reductionSteps[b].dispose();this._reductionSteps=null}this._postProcessManager&&a&&this._postProcessManager.dispose();this._sourceTexture=null}}
class ko$$module$libs$world_onscreen extends Uo$$module$libs$world_onscreen{constructor(a){super(a)}get depthRenderer(){return this._depthRenderer}setDepthRenderer(a=null,b=2,c=!0){const d=this._camera.getScene();this._depthRenderer&&(delete d._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null);null===a&&(d._depthRenderer||(d._depthRenderer={}),a=this._depthRenderer=new ds$$module$libs$world_onscreen(d,b,this._camera,!1,1),a.enabled=!1,this._depthRendererId=
"minmax"+this._camera.id,d._depthRenderer[this._depthRendererId]=a);super.setSourceTexture(a.getDepthMap(),!0,b,c)}setSourceTexture(a,b,c=2,d=!0){super.setSourceTexture(a,b,c,d)}activate(){this._depthRenderer&&(this._depthRenderer.enabled=!0);super.activate()}deactivate(){super.deactivate();this._depthRenderer&&(this._depthRenderer.enabled=!1)}dispose(a=!0){if(super.dispose(a),this._depthRenderer&&a)(a=this._depthRenderer.getDepthMap().getScene())&&delete a._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),
this._depthRenderer=null}}const mr$$module$libs$world_onscreen=p$$module$libs$world_onscreen.Up(),Vo$$module$libs$world_onscreen=p$$module$libs$world_onscreen.Zero(),Fe$$module$libs$world_onscreen=new p$$module$libs$world_onscreen,mi$$module$libs$world_onscreen=new p$$module$libs$world_onscreen,Yi$$module$libs$world_onscreen=new x$$module$libs$world_onscreen;
class Le$$module$libs$world_onscreen extends G$$module$libs$world_onscreen{constructor(a,b,c,d){Le$$module$libs$world_onscreen.IsSupported?(super(a,b,c,d),this.usePercentageCloserFiltering=!0):O$$module$libs$world_onscreen.Error("CascadedShadowMap is not supported by the current engine.")}_validateFilter(a){return a===G$$module$libs$world_onscreen.FILTER_NONE||a===G$$module$libs$world_onscreen.FILTER_PCF||a===G$$module$libs$world_onscreen.FILTER_PCSS?a:(console.error('Unsupported filter "'+a+'"!'),
G$$module$libs$world_onscreen.FILTER_NONE)}get numCascades(){return this._numCascades}set numCascades(a){a=Math.min(Math.max(a,Le$$module$libs$world_onscreen.MIN_CASCADES_COUNT),Le$$module$libs$world_onscreen.MAX_CASCADES_COUNT);a!==this._numCascades&&(this._numCascades=a,this.recreateShadowMap(),this._recreateSceneUBOs())}get freezeShadowCastersBoundingInfo(){return this._freezeShadowCastersBoundingInfo}set freezeShadowCastersBoundingInfo(a){this._freezeShadowCastersBoundingInfoObservable&&a&&(this._scene.onBeforeRenderObservable.remove(this._freezeShadowCastersBoundingInfoObservable),
this._freezeShadowCastersBoundingInfoObservable=null);this._freezeShadowCastersBoundingInfoObservable||a||(this._freezeShadowCastersBoundingInfoObservable=this._scene.onBeforeRenderObservable.add(this._computeShadowCastersBoundingInfo.bind(this)));(this._freezeShadowCastersBoundingInfo=a)&&this._computeShadowCastersBoundingInfo()}_computeShadowCastersBoundingInfo(){if(this._scbiMin.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._scbiMax.copyFromFloats(Number.MIN_VALUE,Number.MIN_VALUE,
Number.MIN_VALUE),this._shadowMap&&this._shadowMap.renderList){var a=this._shadowMap.renderList;for(var b=0;b<a.length;b++){var c=a[b];c&&(c=c.getBoundingInfo().boundingBox,this._scbiMin.minimizeInPlace(c.minimumWorld),this._scbiMax.maximizeInPlace(c.maximumWorld))}a=this._scene.meshes;for(b=0;b<a.length;b++)(c=a[b])&&c.isVisible&&c.isEnabled&&c.receiveShadows&&(c=c.getBoundingInfo().boundingBox,this._scbiMin.minimizeInPlace(c.minimumWorld),this._scbiMax.maximizeInPlace(c.maximumWorld))}this._shadowCastersBoundingInfo.reConstruct(this._scbiMin,
this._scbiMax)}get shadowCastersBoundingInfo(){return this._shadowCastersBoundingInfo}set shadowCastersBoundingInfo(a){this._shadowCastersBoundingInfo=a}setMinMaxDistance(a,b){this._minDistance===a&&this._maxDistance===b||(a>b&&(a=0,b=1),0>a&&(a=0),1<b&&(b=1),this._minDistance=a,this._maxDistance=b,this._breaksAreDirty=!0)}get minDistance(){return this._minDistance}get maxDistance(){return this._maxDistance}getClassName(){return Le$$module$libs$world_onscreen.CLASSNAME}getCascadeMinExtents(a){return 0<=
a&&a<this._numCascades?this._cascadeMinExtents[a]:null}getCascadeMaxExtents(a){return 0<=a&&a<this._numCascades?this._cascadeMaxExtents[a]:null}get shadowMaxZ(){return this._getCamera()?this._shadowMaxZ:0}set shadowMaxZ(a){const b=this._getCamera();b?this._shadowMaxZ===a||a<b.minZ||a>b.maxZ||(this._shadowMaxZ=a,this._light._markMeshesAsLightDirty(),this._breaksAreDirty=!0):this._shadowMaxZ=a}get debug(){return this._debug}set debug(a){this._debug=a;this._light._markMeshesAsLightDirty()}get depthClamp(){return this._depthClamp}set depthClamp(a){this._depthClamp=
a}get cascadeBlendPercentage(){return this._cascadeBlendPercentage}set cascadeBlendPercentage(a){this._cascadeBlendPercentage=a;this._light._markMeshesAsLightDirty()}get lambda(){return this._lambda}set lambda(a){a=Math.min(Math.max(a,0),1);this._lambda!=a&&(this._lambda=a,this._breaksAreDirty=!0)}getCascadeViewMatrix(a){return 0<=a&&a<this._numCascades?this._viewMatrices[a]:null}getCascadeProjectionMatrix(a){return 0<=a&&a<this._numCascades?this._projectionMatrices[a]:null}getCascadeTransformMatrix(a){return 0<=
a&&a<this._numCascades?this._transformMatrices[a]:null}setDepthRenderer(a){this._depthRenderer=a;this._depthReducer&&this._depthReducer.setDepthRenderer(this._depthRenderer)}get autoCalcDepthBounds(){return this._autoCalcDepthBounds}set autoCalcDepthBounds(a){const b=this._getCamera();b&&((this._autoCalcDepthBounds=a,a)?(this._depthReducer||(this._depthReducer=new ko$$module$libs$world_onscreen(b),this._depthReducer.onAfterReductionPerformed.add(c=>{let d=c.min;c=c.max;d>=c&&(d=0,c=1);d==this._minDistance&&
c==this._maxDistance||this.setMinMaxDistance(d,c)}),this._depthReducer.setDepthRenderer(this._depthRenderer)),this._depthReducer.activate()):(this._depthReducer&&this._depthReducer.deactivate(),this.setMinMaxDistance(0,1)))}get autoCalcDepthBoundsRefreshRate(){var a,b,c;return null!==(c=null===(b=null===(a=this._depthReducer)||void 0===a?void 0:a.depthRenderer)||void 0===b?void 0:b.getDepthMap().refreshRate)&&void 0!==c?c:-1}set autoCalcDepthBoundsRefreshRate(a){var b;null!==(b=this._depthReducer)&&
void 0!==b&&b.depthRenderer&&(this._depthReducer.depthRenderer.getDepthMap().refreshRate=a)}splitFrustum(){this._breaksAreDirty=!0}_splitFrustum(){var a=this._getCamera();if(a){var b=a.minZ,c=a.maxZ;a=c-b;var d=this._minDistance,e=b+d*a,g=b+(this._shadowMaxZ<c&&this._shadowMaxZ>=b?Math.min((this._shadowMaxZ-b)/(c-b),this._maxDistance):this._maxDistance)*a;c=g-e;g/=e;for(let t=0;t<this._cascades.length;++t){var n=(t+1)/this._numCascades;const w=e+c*n;n=this._lambda*(e*g**n-w)+w;this._cascades[t].prevBreakDistance=
0===t?d:this._cascades[t-1].breakDistance;this._cascades[t].breakDistance=(n-b)/a;this._viewSpaceFrustumsZ[t]=n;this._frustumLengths[t]=(this._cascades[t].breakDistance-this._cascades[t].prevBreakDistance)*a}this._breaksAreDirty=!1}}_computeMatrices(){const a=this._scene;if(this._getCamera()){p$$module$libs$world_onscreen.NormalizeToRef(this._light.getShadowDirection(0),this._lightDirection);1===Math.abs(p$$module$libs$world_onscreen.Dot(this._lightDirection,p$$module$libs$world_onscreen.Up()))&&
(this._lightDirection.z=1E-13);this._cachedDirection.copyFrom(this._lightDirection);var b=a.getEngine().useReverseDepthBuffer;for(let c=0;c<this._numCascades;++c){this._computeFrustumInWorldSpace(c);this._computeCascadeFrustum(c);this._cascadeMaxExtents[c].subtractToRef(this._cascadeMinExtents[c],Fe$$module$libs$world_onscreen);this._frustumCenter[c].addToRef(this._lightDirection.scale(this._cascadeMinExtents[c].z),this._shadowCameraPos[c]);x$$module$libs$world_onscreen.LookAtLHToRef(this._shadowCameraPos[c],
this._frustumCenter[c],mr$$module$libs$world_onscreen,this._viewMatrices[c]);let d=0,e=Fe$$module$libs$world_onscreen.z;const g=this._shadowCastersBoundingInfo;g.update(this._viewMatrices[c]);e=Math.min(e,g.boundingBox.maximumWorld.z);this._depthClamp&&this.filter!==G$$module$libs$world_onscreen.FILTER_PCSS?d=Math.max(d,g.boundingBox.minimumWorld.z):d=Math.min(d,g.boundingBox.minimumWorld.z);x$$module$libs$world_onscreen.OrthoOffCenterLHToRef(this._cascadeMinExtents[c].x,this._cascadeMaxExtents[c].x,
this._cascadeMinExtents[c].y,this._cascadeMaxExtents[c].y,b?e:d,b?d:e,this._projectionMatrices[c],a.getEngine().isNDCHalfZRange);this._cascadeMinExtents[c].z=d;this._cascadeMaxExtents[c].z=e;this._viewMatrices[c].multiplyToRef(this._projectionMatrices[c],this._transformMatrices[c]);p$$module$libs$world_onscreen.TransformCoordinatesToRef(Vo$$module$libs$world_onscreen,this._transformMatrices[c],Fe$$module$libs$world_onscreen);Fe$$module$libs$world_onscreen.scaleInPlace(this._mapSize/2);mi$$module$libs$world_onscreen.copyFromFloats(Math.round(Fe$$module$libs$world_onscreen.x),
Math.round(Fe$$module$libs$world_onscreen.y),Math.round(Fe$$module$libs$world_onscreen.z));mi$$module$libs$world_onscreen.subtractInPlace(Fe$$module$libs$world_onscreen).scaleInPlace(2/this._mapSize);x$$module$libs$world_onscreen.TranslationToRef(mi$$module$libs$world_onscreen.x,mi$$module$libs$world_onscreen.y,0,Yi$$module$libs$world_onscreen);this._projectionMatrices[c].multiplyToRef(Yi$$module$libs$world_onscreen,this._projectionMatrices[c]);this._viewMatrices[c].multiplyToRef(this._projectionMatrices[c],
this._transformMatrices[c]);this._transformMatrices[c].copyToArray(this._transformMatricesAsArray,16*c)}}}_computeFrustumInWorldSpace(a){var b=this._getCamera();if(b){var c=this._cascades[a].prevBreakDistance,d=this._cascades[a].breakDistance,e=this._scene.getEngine().isNDCHalfZRange;b.getViewMatrix();b=x$$module$libs$world_onscreen.Invert(b.getTransformationMatrix());var g=this._scene.getEngine().useReverseDepthBuffer?4:0;for(let n=0;n<Le$$module$libs$world_onscreen._FrustumCornersNDCSpace.length;++n)Fe$$module$libs$world_onscreen.copyFrom(Le$$module$libs$world_onscreen._FrustumCornersNDCSpace[(n+
g)%Le$$module$libs$world_onscreen._FrustumCornersNDCSpace.length]),e&&-1===Fe$$module$libs$world_onscreen.z&&(Fe$$module$libs$world_onscreen.z=0),p$$module$libs$world_onscreen.TransformCoordinatesToRef(Fe$$module$libs$world_onscreen,b,this._frustumCornersWorldSpace[a][n]);for(e=0;e<Le$$module$libs$world_onscreen._FrustumCornersNDCSpace.length/2;++e)Fe$$module$libs$world_onscreen.copyFrom(this._frustumCornersWorldSpace[a][e+4]).subtractInPlace(this._frustumCornersWorldSpace[a][e]),mi$$module$libs$world_onscreen.copyFrom(Fe$$module$libs$world_onscreen).scaleInPlace(c),
Fe$$module$libs$world_onscreen.scaleInPlace(d),Fe$$module$libs$world_onscreen.addInPlace(this._frustumCornersWorldSpace[a][e]),this._frustumCornersWorldSpace[a][e+4].copyFrom(Fe$$module$libs$world_onscreen),this._frustumCornersWorldSpace[a][e].addInPlace(mi$$module$libs$world_onscreen)}}_computeCascadeFrustum(a){if(this._cascadeMinExtents[a].copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cascadeMaxExtents[a].copyFromFloats(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),
this._frustumCenter[a].copyFromFloats(0,0,0),this._getCamera()){for(var b=0;b<this._frustumCornersWorldSpace[a].length;++b)this._frustumCenter[a].addInPlace(this._frustumCornersWorldSpace[a][b]);if(this._frustumCenter[a].scaleInPlace(1/this._frustumCornersWorldSpace[a].length),this.stabilizeCascades){b=0;for(let c=0;c<this._frustumCornersWorldSpace[a].length;++c){const d=this._frustumCornersWorldSpace[a][c].subtractToRef(this._frustumCenter[a],Fe$$module$libs$world_onscreen).length();b=Math.max(b,
d)}b=Math.ceil(16*b)/16;this._cascadeMaxExtents[a].copyFromFloats(b,b,b);this._cascadeMinExtents[a].copyFromFloats(-b,-b,-b)}else for(b=this._frustumCenter[a],this._frustumCenter[a].addToRef(this._lightDirection,Fe$$module$libs$world_onscreen),x$$module$libs$world_onscreen.LookAtLHToRef(b,Fe$$module$libs$world_onscreen,mr$$module$libs$world_onscreen,Yi$$module$libs$world_onscreen),b=0;b<this._frustumCornersWorldSpace[a].length;++b)p$$module$libs$world_onscreen.TransformCoordinatesToRef(this._frustumCornersWorldSpace[a][b],
Yi$$module$libs$world_onscreen,Fe$$module$libs$world_onscreen),this._cascadeMinExtents[a].minimizeInPlace(Fe$$module$libs$world_onscreen),this._cascadeMaxExtents[a].maximizeInPlace(Fe$$module$libs$world_onscreen)}}_recreateSceneUBOs(){if(this._disposeSceneUBOs(),this._sceneUBOs)for(let a=0;a<this._numCascades;++a)this._sceneUBOs.push(this._scene.createSceneUniformBuffer(`Scene for CSM Shadow Generator (light "${this._light.name}" cascade #${a})`))}static get IsSupported(){const a=fe$$module$libs$world_onscreen.LastCreatedEngine;
return a?a._features.supportCSM:!1}_initializeGenerator(){var a,b,c,d,e,g,n,t,w,z,C,H,M,L,O,S,T,P,W,Z;this.penumbraDarkness=null!==(a=this.penumbraDarkness)&&void 0!==a?a:1;this._numCascades=null!==(b=this._numCascades)&&void 0!==b?b:Le$$module$libs$world_onscreen.DEFAULT_CASCADES_COUNT;this.stabilizeCascades=null!==(c=this.stabilizeCascades)&&void 0!==c?c:!1;this._freezeShadowCastersBoundingInfoObservable=null!==(d=this._freezeShadowCastersBoundingInfoObservable)&&void 0!==d?d:null;this.freezeShadowCastersBoundingInfo=
null!==(e=this.freezeShadowCastersBoundingInfo)&&void 0!==e?e:!1;this._scbiMin=null!==(g=this._scbiMin)&&void 0!==g?g:new p$$module$libs$world_onscreen(0,0,0);this._scbiMax=null!==(n=this._scbiMax)&&void 0!==n?n:new p$$module$libs$world_onscreen(0,0,0);this._shadowCastersBoundingInfo=null!==(t=this._shadowCastersBoundingInfo)&&void 0!==t?t:new ft$$module$libs$world_onscreen(new p$$module$libs$world_onscreen(0,0,0),new p$$module$libs$world_onscreen(0,0,0));this._breaksAreDirty=null!==(w=this._breaksAreDirty)&&
void 0!==w?w:!0;this._minDistance=null!==(z=this._minDistance)&&void 0!==z?z:0;this._maxDistance=null!==(C=this._maxDistance)&&void 0!==C?C:1;this._currentLayer=null!==(H=this._currentLayer)&&void 0!==H?H:0;this._shadowMaxZ=null!==(O=null!==(M=this._shadowMaxZ)&&void 0!==M?M:null===(L=this._getCamera())||void 0===L?void 0:L.maxZ)&&void 0!==O?O:1E4;this._debug=null!==(S=this._debug)&&void 0!==S?S:!1;this._depthClamp=null!==(T=this._depthClamp)&&void 0!==T?T:!0;this._cascadeBlendPercentage=null!==(P=
this._cascadeBlendPercentage)&&void 0!==P?P:.1;this._lambda=null!==(W=this._lambda)&&void 0!==W?W:.5;this._autoCalcDepthBounds=null!==(Z=this._autoCalcDepthBounds)&&void 0!==Z?Z:!1;this._recreateSceneUBOs();super._initializeGenerator()}_createTargetRenderTexture(){const a=this._scene.getEngine();this._shadowMap=new _t$$module$libs$world_onscreen(this._light.name+"_CSMShadowMap",{width:this._mapSize,height:this._mapSize,layers:this.numCascades},this._scene,!1,!0,this._textureType,!1,void 0,!1,!1,void 0);
this._shadowMap.createDepthStencilTexture(a.useReverseDepthBuffer?516:513,!0)}_initializeShadowMap(){if(super._initializeShadowMap(),null!==this._shadowMap){this._transformMatricesAsArray=new Float32Array(16*this._numCascades);this._viewSpaceFrustumsZ=Array(this._numCascades);this._frustumLengths=Array(this._numCascades);this._lightSizeUVCorrection=Array(2*this._numCascades);this._depthCorrection=Array(this._numCascades);this._cascades=[];this._viewMatrices=[];this._projectionMatrices=[];this._transformMatrices=
[];this._cascadeMinExtents=[];this._cascadeMaxExtents=[];this._frustumCenter=[];this._shadowCameraPos=[];this._frustumCornersWorldSpace=[];for(let b=0;b<this._numCascades;++b){this._cascades[b]={prevBreakDistance:0,breakDistance:0};this._viewMatrices[b]=x$$module$libs$world_onscreen.Zero();this._projectionMatrices[b]=x$$module$libs$world_onscreen.Zero();this._transformMatrices[b]=x$$module$libs$world_onscreen.Zero();this._cascadeMinExtents[b]=new p$$module$libs$world_onscreen;this._cascadeMaxExtents[b]=
new p$$module$libs$world_onscreen;this._frustumCenter[b]=new p$$module$libs$world_onscreen;this._shadowCameraPos[b]=new p$$module$libs$world_onscreen;this._frustumCornersWorldSpace[b]=Array(Le$$module$libs$world_onscreen._FrustumCornersNDCSpace.length);for(let c=0;c<Le$$module$libs$world_onscreen._FrustumCornersNDCSpace.length;++c)this._frustumCornersWorldSpace[b][c]=new p$$module$libs$world_onscreen}var a=this._scene.getEngine();this._shadowMap.onBeforeBindObservable.clear();this._shadowMap.onBeforeRenderObservable.clear();
this._shadowMap.onBeforeRenderObservable.add(b=>{this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._sceneUBOs[b]);this._currentLayer=b;this._filter===G$$module$libs$world_onscreen.FILTER_PCF&&a.setColorWrite(!1);this._scene.setTransformMatrix(this.getCascadeViewMatrix(b),this.getCascadeProjectionMatrix(b));this._useUBO&&(this._scene.getSceneUniformBuffer().unbindEffect(),this._scene.finalizeSceneUbo())});this._shadowMap.onBeforeBindObservable.add(()=>{var b;this._currentSceneUBO=this._scene.getSceneUniformBuffer();
null===(b=a._debugPushGroup)||void 0===b||b.call(a,`cascaded shadow map generation for pass id ${a.currentRenderPassId}`,1);this._breaksAreDirty&&this._splitFrustum();this._computeMatrices()});this._splitFrustum()}}_bindCustomEffectForRenderSubMeshForShadowMap(a,b){b.setMatrix("viewProjection",this.getCascadeTransformMatrix(this._currentLayer))}_isReadyCustomDefines(a){a.push("#define SM_DEPTHCLAMP "+(this._depthClamp&&this._filter!==G$$module$libs$world_onscreen.FILTER_PCSS?"1":"0"))}prepareDefines(a,
b){super.prepareDefines(a,b);var c=this._scene;const d=this._light;c.shadowsEnabled&&d.shadowEnabled&&(a["SHADOWCSM"+b]=!0,a["SHADOWCSMDEBUG"+b]=this.debug,a["SHADOWCSMNUM_CASCADES"+b]=this.numCascades,a["SHADOWCSM_RIGHTHANDED"+b]=c.useRightHandedSystem,(c=this._getCamera())&&this._shadowMaxZ<c.maxZ&&(a["SHADOWCSMUSESHADOWMAXZ"+b]=!0),0===this.cascadeBlendPercentage&&(a["SHADOWCSMNOBLEND"+b]=!0))}bindShadowLight(a,b){const c=this._light;if(this._scene.shadowsEnabled&&c.shadowEnabled){var d=this._getCamera();
if(d){var e=this.getShadowMap();if(e){var g=e.getSize().width;if(b.setMatrices("lightMatrix"+a,this._transformMatricesAsArray),b.setArray("viewFrustumZ"+a,this._viewSpaceFrustumsZ),b.setFloat("cascadeBlendFactor"+a,0===this.cascadeBlendPercentage?1E4:1/this.cascadeBlendPercentage),b.setArray("frustumLengths"+a,this._frustumLengths),this._filter===G$$module$libs$world_onscreen.FILTER_PCF)b.setDepthStencilTexture("shadowSampler"+a,e),c._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),g,
1/g,this.frustumEdgeFalloff,a);else if(this._filter===G$$module$libs$world_onscreen.FILTER_PCSS){for(let n=0;n<this._numCascades;++n)this._lightSizeUVCorrection[2*n]=0===n?1:(this._cascadeMaxExtents[0].x-this._cascadeMinExtents[0].x)/(this._cascadeMaxExtents[n].x-this._cascadeMinExtents[n].x),this._lightSizeUVCorrection[2*n+1]=0===n?1:(this._cascadeMaxExtents[0].y-this._cascadeMinExtents[0].y)/(this._cascadeMaxExtents[n].y-this._cascadeMinExtents[n].y),this._depthCorrection[n]=0===n?1:(this._cascadeMaxExtents[n].z-
this._cascadeMinExtents[n].z)/(this._cascadeMaxExtents[0].z-this._cascadeMinExtents[0].z);b.setDepthStencilTexture("shadowSampler"+a,e);b.setTexture("depthSampler"+a,e);b.setArray2("lightSizeUVCorrection"+a,this._lightSizeUVCorrection);b.setArray("depthCorrection"+a,this._depthCorrection);b.setFloat("penumbraDarkness"+a,this.penumbraDarkness);c._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),1/g,this._contactHardeningLightSizeUVRatio*g,this.frustumEdgeFalloff,a)}else b.setTexture("shadowSampler"+
a,e),c._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),g,1/g,this.frustumEdgeFalloff,a);c._uniformBuffer.updateFloat2("depthValues",this.getLight().getDepthMinZ(d),this.getLight().getDepthMinZ(d)+this.getLight().getDepthMaxZ(d),a)}}}}getTransformMatrix(){return this.getCascadeTransformMatrix(0)}dispose(){super.dispose();this._freezeShadowCastersBoundingInfoObservable&&(this._scene.onBeforeRenderObservable.remove(this._freezeShadowCastersBoundingInfoObservable),this._freezeShadowCastersBoundingInfoObservable=
null);this._depthReducer&&(this._depthReducer.dispose(),this._depthReducer=null)}serialize(){const a=super.serialize(),b=this.getShadowMap();if(!b)return a;if(a.numCascades=this._numCascades,a.debug=this._debug,a.stabilizeCascades=this.stabilizeCascades,a.lambda=this._lambda,a.cascadeBlendPercentage=this.cascadeBlendPercentage,a.depthClamp=this._depthClamp,a.autoCalcDepthBounds=this.autoCalcDepthBounds,a.shadowMaxZ=this._shadowMaxZ,a.penumbraDarkness=this.penumbraDarkness,a.freezeShadowCastersBoundingInfo=
this._freezeShadowCastersBoundingInfo,a.minDistance=this.minDistance,a.maxDistance=this.maxDistance,a.renderList=[],b.renderList)for(let c=0;c<b.renderList.length;c++)a.renderList.push(b.renderList[c].id);return a}static Parse(a,b){b=G$$module$libs$world_onscreen.Parse(a,b,(c,d,e)=>new Le$$module$libs$world_onscreen(c,d,void 0,e));return void 0!==a.numCascades&&(b.numCascades=a.numCascades),void 0!==a.debug&&(b.debug=a.debug),void 0!==a.stabilizeCascades&&(b.stabilizeCascades=a.stabilizeCascades),
void 0!==a.lambda&&(b.lambda=a.lambda),void 0!==a.cascadeBlendPercentage&&(b.cascadeBlendPercentage=a.cascadeBlendPercentage),void 0!==a.depthClamp&&(b.depthClamp=a.depthClamp),void 0!==a.autoCalcDepthBounds&&(b.autoCalcDepthBounds=a.autoCalcDepthBounds),void 0!==a.shadowMaxZ&&(b.shadowMaxZ=a.shadowMaxZ),void 0!==a.penumbraDarkness&&(b.penumbraDarkness=a.penumbraDarkness),void 0!==a.freezeShadowCastersBoundingInfo&&(b.freezeShadowCastersBoundingInfo=a.freezeShadowCastersBoundingInfo),void 0!==a.minDistance&&
void 0!==a.maxDistance&&b.setMinMaxDistance(a.minDistance,a.maxDistance),b}}Le$$module$libs$world_onscreen._FrustumCornersNDCSpace=[new p$$module$libs$world_onscreen(-1,1,-1),new p$$module$libs$world_onscreen(1,1,-1),new p$$module$libs$world_onscreen(1,-1,-1),new p$$module$libs$world_onscreen(-1,-1,-1),new p$$module$libs$world_onscreen(-1,1,1),new p$$module$libs$world_onscreen(1,1,1),new p$$module$libs$world_onscreen(1,-1,1),new p$$module$libs$world_onscreen(-1,-1,1)];
Le$$module$libs$world_onscreen.CLASSNAME="CascadedShadowGenerator";Le$$module$libs$world_onscreen.DEFAULT_CASCADES_COUNT=4;Le$$module$libs$world_onscreen.MIN_CASCADES_COUNT=2;Le$$module$libs$world_onscreen.MAX_CASCADES_COUNT=4;Le$$module$libs$world_onscreen._SceneComponentInitialization=a=>{throw $$$module$libs$world_onscreen("ShadowGeneratorSceneComponent");};
as$$module$libs$world_onscreen.AddParser(Z$$module$libs$world_onscreen.NAME_SHADOWGENERATOR,(a,b)=>{if(void 0!==a.shadowGenerators&&null!==a.shadowGenerators)for(let c=0,d=a.shadowGenerators.length;c<d;c++){const e=a.shadowGenerators[c];e.className===Le$$module$libs$world_onscreen.CLASSNAME?Le$$module$libs$world_onscreen.Parse(e,b):G$$module$libs$world_onscreen.Parse(e,b)}});
class Wo$$module$libs$world_onscreen{constructor(a){this.name=Z$$module$libs$world_onscreen.NAME_SHADOWGENERATOR;this.scene=a}register(){this.scene._gatherRenderTargetsStage.registerStep(Z$$module$libs$world_onscreen.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR,this,this._gatherRenderTargets)}rebuild(){}serialize(a){a.shadowGenerators=[];var b=this.scene.lights;for(const c of b)if(b=c.getShadowGenerators()){b=b.values();for(let d=b.next();!0!==d.done;d=b.next())a.shadowGenerators.push(d.value.serialize())}}addFromContainer(a){}removeFromContainer(a,
b){}dispose(){}_gatherRenderTargets(a){const b=this.scene;if(this.scene.shadowsEnabled)for(let e=0;e<b.lights.length;e++){var c=b.lights[e],d=c.getShadowGenerators();if(c.isEnabled()&&c.shadowEnabled&&d)for(c=d.values(),d=c.next();!0!==d.done;d=c.next())d=d.value.getShadowMap(),-1!==b.textures.indexOf(d)&&a.push(d)}}}
G$$module$libs$world_onscreen._SceneComponentInitialization=a=>{let b=a._getComponent(Z$$module$libs$world_onscreen.NAME_SHADOWGENERATOR);b||(b=new Wo$$module$libs$world_onscreen(a),a._addComponent(b))};const zo$$module$libs$world_onscreen={enableShadows:!0};
function Er$$module$libs$world_onscreen(a=zo$$module$libs$world_onscreen){const {enableShadows:b,shadowTransparency:c,intensity:d,scene:e}=a;a=new Pt$$module$libs$world_onscreen("DirectionalLight",new p$$module$libs$world_onscreen(-.3,-1,.4),e);a.position=new p$$module$libs$world_onscreen(-50,65,-50);a.intensity=.65*d;const g=new us$$module$libs$world_onscreen("HemisphericLight",new p$$module$libs$world_onscreen(1,1,0),e);return g.intensity=.4*d,b&&(a.shadowMinZ=1,a.shadowMaxZ=70,a.shadowGenerator=
new G$$module$libs$world_onscreen(2048,a),a.shadowGenerator.useCloseExponentialShadowMap=!0,a.shadowGenerator.darkness=c),{directional:a,hemispheric:g}}
function Vr$$module$libs$world_onscreen(a){var b=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];const c=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],d=[];var e=[];e=a.width||a.size||1;var g=a.height||a.size||1,n=a.depth||a.size||1,t=a.wrap||!1,w=void 0===a.topBaseAt?1:a.topBaseAt,z=void 0===a.bottomBaseAt?0:a.bottomBaseAt;w=[2,0,3,1][(w+4)%
4];z=[2,0,1,3][(z+4)%4];var C=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1];if(t){b=[2,3,0,2,0,1,4,5,6,4,6,7,9,10,11,9,11,8,12,14,15,12,13,14];C=[-1,1,1,1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1];t=[[1,1,1],[-1,1,1],[-1,1,-1],[1,1,-1]];let M=[[-1,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1]];const L=[17,
18,19,16],O=[22,23,20,21];for(;0<w;)t.unshift(t.pop()),L.unshift(L.pop()),w--;for(;0<z;)M.unshift(M.pop()),O.unshift(O.pop()),z--;t=t.flat();M=M.flat();C=C.concat(t).concat(M);b.push(L[0],L[2],L[3],L[0],L[1],L[2]);b.push(O[0],O[2],O[3],O[0],O[1],O[2])}const H=[e/2,g/2,n/2];e=C.reduce((M,L,O)=>M.concat(L*H[O%3]),[]);g=0===a.sideOrientation?0:a.sideOrientation||J$$module$libs$world_onscreen.DEFAULTSIDE;z=a.faceUV||Array(6);n=a.faceColors;w=[];for(C=0;6>C;C++)void 0===z[C]&&(z[C]=new Ae$$module$libs$world_onscreen(0,
0,1,1)),n&&void 0===n[C]&&(n[C]=new me$$module$libs$world_onscreen(1,1,1,1));for(C=0;6>C;C++)if(d.push(z[C].z,ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV?1-z[C].w:z[C].w),d.push(z[C].x,ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV?1-z[C].w:z[C].w),d.push(z[C].x,ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV?1-z[C].y:z[C].y),d.push(z[C].z,ut$$module$libs$world_onscreen.UseOpenGLOrientationForUV?1-z[C].y:z[C].y),n)for(t=0;4>t;t++)w.push(n[C].r,n[C].g,n[C].b,n[C].a);
J$$module$libs$world_onscreen._ComputeSides(g,e,b,c,d,a.frontUVs,a.backUVs);a=new J$$module$libs$world_onscreen;if(a.indices=b,a.positions=e,a.normals=c,a.uvs=d,n)b=g===J$$module$libs$world_onscreen.DOUBLESIDE?w.concat(w):w,a.colors=b;return a}
function Ei$$module$libs$world_onscreen(a,b={},c=null){a=new W$$module$libs$world_onscreen(a,c);return b.sideOrientation=W$$module$libs$world_onscreen._GetDefaultSideOrientation(b.sideOrientation),a._originalBuilderSideOrientation=b.sideOrientation,Vr$$module$libs$world_onscreen(b).applyToMesh(a,b.updatable),a}J$$module$libs$world_onscreen.CreateBox=Vr$$module$libs$world_onscreen;
W$$module$libs$world_onscreen.CreateBox=(a,b,c=null,d,e)=>Ei$$module$libs$world_onscreen(a,{size:b,sideOrientation:e,updatable:d},c);
class vr$$module$libs$world_onscreen{constructor(){this.previousWorldMatrices={};this.previousBones={}}static AddUniforms(a){a.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(a){}bindForSubMesh(a,b,c,d,e){b.prePassRenderer&&b.prePassRenderer.enabled&&b.prePassRenderer.currentRTisSceneRT&&-1!==b.prePassRenderer.getIndex(2)&&(this.previousWorldMatrices[c.uniqueId]||(this.previousWorldMatrices[c.uniqueId]=d.clone()),this.previousViewProjection||(this.previousViewProjection=
b.getTransformMatrix().clone(),this.currentViewProjection=b.getTransformMatrix().clone()),e=b.getEngine(),this.currentViewProjection.updateFlag!==b.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=e.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection),this.currentViewProjection.copyFrom(b.getTransformMatrix())):this._lastUpdateFrameId!==e.frameId&&(this._lastUpdateFrameId=e.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection)),a.setMatrix("previousWorld",
this.previousWorldMatrices[c.uniqueId]),a.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[c.uniqueId]=d.clone())}}
class Wr$$module$libs$world_onscreen extends P$$module$libs$world_onscreen{constructor(a,b,c=!0){super(a,b);this._normalMatrix=new x$$module$libs$world_onscreen;this._storeEffectOnSubMeshes=c}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(a,b){return a?this._storeEffectOnSubMeshes&&a.subMeshes&&0!==a.subMeshes.length?this.isReadyForSubMesh(a,a.subMeshes[0],b):!0:!1}_isReadyForSubMesh(a){const b=a.materialDefines;return!(this.checkReadyOnEveryCall||!a.effect||
!b||b._renderId!==this.getScene().getRenderId())}bindOnlyWorldMatrix(a){this._activeEffect.setMatrix("world",a)}bindOnlyNormalMatrix(a){this._activeEffect.setMatrix("normalMatrix",a)}bind(a,b){b&&this.bindForSubMesh(a,b,b.subMeshes[0])}_afterBind(a,b=null){super._afterBind(a,b);(this.getScene()._cachedEffect=b)&&(b._forceRebindOnNextCall=!1)}_mustRebind(a,b,c=1){return a.isCachedMaterialInvalid(this,b,c)}}
class de$$module$libs$world_onscreen{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(a){this._DiffuseTextureEnabled!==a&&(this._DiffuseTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(a){this._DetailTextureEnabled!==a&&(this._DetailTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(a){this._AmbientTextureEnabled!==
a&&(this._AmbientTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(a){this._OpacityTextureEnabled!==a&&(this._OpacityTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(a){this._ReflectionTextureEnabled!==a&&(this._ReflectionTextureEnabled=
a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(a){this._EmissiveTextureEnabled!==a&&(this._EmissiveTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(a){this._SpecularTextureEnabled!==a&&(this._SpecularTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(a){this._BumpTextureEnabled!==
a&&(this._BumpTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(a){this._LightmapTextureEnabled!==a&&(this._LightmapTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(a){this._RefractionTextureEnabled!==a&&(this._RefractionTextureEnabled=
a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(a){this._ColorGradingTextureEnabled!==a&&(this._ColorGradingTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(a){this._FresnelEnabled!==a&&(this._FresnelEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(a){this._ClearCoatTextureEnabled!==
a&&(this._ClearCoatTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(a){this._ClearCoatBumpTextureEnabled!==a&&(this._ClearCoatBumpTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(a){this._ClearCoatTintTextureEnabled!==
a&&(this._ClearCoatTintTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(a){this._SheenTextureEnabled!==a&&(this._SheenTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(a){this._AnisotropicTextureEnabled!==a&&(this._AnisotropicTextureEnabled=
a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(a){this._ThicknessTextureEnabled!==a&&(this._ThicknessTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(a){this._RefractionIntensityTextureEnabled!==a&&(this._RefractionIntensityTextureEnabled=
a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set TranslucencyIntensityTextureEnabled(a){this._TranslucencyIntensityTextureEnabled!==a&&(this._TranslucencyIntensityTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(a){this._IridescenceTextureEnabled!==a&&
(this._IridescenceTextureEnabled=a,I$$module$libs$world_onscreen.MarkAllMaterialsAsDirty(1))}}de$$module$libs$world_onscreen._DiffuseTextureEnabled=!0;de$$module$libs$world_onscreen._DetailTextureEnabled=!0;de$$module$libs$world_onscreen._AmbientTextureEnabled=!0;de$$module$libs$world_onscreen._OpacityTextureEnabled=!0;de$$module$libs$world_onscreen._ReflectionTextureEnabled=!0;de$$module$libs$world_onscreen._EmissiveTextureEnabled=!0;de$$module$libs$world_onscreen._SpecularTextureEnabled=!0;
de$$module$libs$world_onscreen._BumpTextureEnabled=!0;de$$module$libs$world_onscreen._LightmapTextureEnabled=!0;de$$module$libs$world_onscreen._RefractionTextureEnabled=!0;de$$module$libs$world_onscreen._ColorGradingTextureEnabled=!0;de$$module$libs$world_onscreen._FresnelEnabled=!0;de$$module$libs$world_onscreen._ClearCoatTextureEnabled=!0;de$$module$libs$world_onscreen._ClearCoatBumpTextureEnabled=!0;de$$module$libs$world_onscreen._ClearCoatTintTextureEnabled=!0;
de$$module$libs$world_onscreen._SheenTextureEnabled=!0;de$$module$libs$world_onscreen._AnisotropicTextureEnabled=!0;de$$module$libs$world_onscreen._ThicknessTextureEnabled=!0;de$$module$libs$world_onscreen._RefractionIntensityTextureEnabled=!0;de$$module$libs$world_onscreen._TranslucencyIntensityTextureEnabled=!0;de$$module$libs$world_onscreen._IridescenceTextureEnabled=!0;const Go$$module$libs$world_onscreen="defaultFragmentDeclaration",Xo$$module$libs$world_onscreen="uniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\nuniform vec3 vEmissiveColor;\nuniform vec3 vAmbientColor;\nuniform float visibility;\n#ifdef DIFFUSE\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos;\n#endif\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos;\n#endif\n#ifdef BUMP\nuniform vec3 vBumpInfos;\nuniform vec2 vTangentSpaceParams;\n#endif\n#ifdef ALPHATEST\nuniform float alphaCutOff;\n#endif\n#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION) || defined(PREPASS)\nuniform mat4 view;\n#endif\n#ifdef REFRACTION\nuniform vec4 vRefractionInfos;\n#ifndef REFRACTIONMAP_3D\nuniform mat4 refractionMatrix;\n#endif\n#ifdef REFRACTIONFRESNEL\nuniform vec4 refractionLeftColor;\nuniform vec4 refractionRightColor;\n#endif\n#if defined(USE_LOCAL_REFRACTIONMAP_CUBIC) && defined(REFRACTIONMAP_3D)\nuniform vec3 vRefractionPosition;\nuniform vec3 vRefractionSize; \n#endif\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nuniform vec2 vSpecularInfos;\n#endif\n#ifdef DIFFUSEFRESNEL\nuniform vec4 diffuseLeftColor;\nuniform vec4 diffuseRightColor;\n#endif\n#ifdef OPACITYFRESNEL\nuniform vec4 opacityParts;\n#endif\n#ifdef EMISSIVEFRESNEL\nuniform vec4 emissiveLeftColor;\nuniform vec4 emissiveRightColor;\n#endif\n#ifdef REFLECTION\nuniform vec2 vReflectionInfos;\n#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION) || defined(REFLECTIONMAP_EQUIRECTANGULAR) || defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_SKYBOX)\nuniform mat4 reflectionMatrix;\n#endif\n#ifndef REFLECTIONMAP_SKYBOX\n#if defined(USE_LOCAL_REFLECTIONMAP_CUBIC) && defined(REFLECTIONMAP_CUBIC)\nuniform vec3 vReflectionPosition;\nuniform vec3 vReflectionSize; \n#endif\n#endif\n#ifdef REFLECTIONFRESNEL\nuniform vec4 reflectionLeftColor;\nuniform vec4 reflectionRightColor;\n#endif\n#endif\n#ifdef DETAIL\nuniform vec4 vDetailInfos;\n#endif\n#define ADDITIONAL_FRAGMENT_DECLARATION\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Go$$module$libs$world_onscreen]=Xo$$module$libs$world_onscreen;const Ho$$module$libs$world_onscreen="defaultUboDeclaration",Ko$$module$libs$world_onscreen="layout(std140,column_major) uniform;\nuniform Material\n{\nvec4 diffuseLeftColor;\nvec4 diffuseRightColor;\nvec4 opacityParts;\nvec4 reflectionLeftColor;\nvec4 reflectionRightColor;\nvec4 refractionLeftColor;\nvec4 refractionRightColor;\nvec4 emissiveLeftColor;\nvec4 emissiveRightColor;\nvec2 vDiffuseInfos;\nvec2 vAmbientInfos;\nvec2 vOpacityInfos;\nvec2 vReflectionInfos;\nvec3 vReflectionPosition;\nvec3 vReflectionSize;\nvec2 vEmissiveInfos;\nvec2 vLightmapInfos;\nvec2 vSpecularInfos;\nvec3 vBumpInfos;\nmat4 diffuseMatrix;\nmat4 ambientMatrix;\nmat4 opacityMatrix;\nmat4 reflectionMatrix;\nmat4 emissiveMatrix;\nmat4 lightmapMatrix;\nmat4 specularMatrix;\nmat4 bumpMatrix;\nvec2 vTangentSpaceParams;\nfloat pointSize;\nfloat alphaCutOff;\nmat4 refractionMatrix;\nvec4 vRefractionInfos;\nvec3 vRefractionPosition;\nvec3 vRefractionSize;\nvec4 vSpecularColor;\nvec3 vEmissiveColor;\nvec4 vDiffuseColor;\nvec3 vAmbientColor;\n#define ADDITIONAL_UBO_DECLARATION\n};\n#include<sceneUboDeclaration>\n#include<meshUboDeclaration>\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Ho$$module$libs$world_onscreen]=Ko$$module$libs$world_onscreen;const Yo$$module$libs$world_onscreen="prePassDeclaration",Zo$$module$libs$world_onscreen="#ifdef PREPASS\n#extension GL_EXT_draw_buffers : require\nlayout(location=0) out highp vec4 glFragData[{X}];highp vec4 gl_FragColor;\n#ifdef PREPASS_DEPTH\nvarying highp vec3 vViewPos;\n#endif\n#ifdef PREPASS_VELOCITY\nvarying highp vec4 vCurrentPosition;varying highp vec4 vPreviousPosition;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Yo$$module$libs$world_onscreen]=Zo$$module$libs$world_onscreen;const qo$$module$libs$world_onscreen="oitDeclaration",jo$$module$libs$world_onscreen="#ifdef ORDER_INDEPENDENT_TRANSPARENCY\n#extension GL_EXT_draw_buffers : require\nlayout(location=0) out vec2 depth; \nlayout(location=1) out vec4 frontColor;\nlayout(location=2) out vec4 backColor;\n#define MAX_DEPTH 99999.0\nhighp vec4 gl_FragColor;\nuniform sampler2D oitDepthSampler;\nuniform sampler2D oitFrontColorSampler;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[qo$$module$libs$world_onscreen]=jo$$module$libs$world_onscreen;const $o$$module$libs$world_onscreen="mainUVVaryingDeclaration",Qo$$module$libs$world_onscreen="#ifdef MAINUV{X}\nvarying vec2 vMainUV{X};\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[$o$$module$libs$world_onscreen]=Qo$$module$libs$world_onscreen;const Jo$$module$libs$world_onscreen="lightFragmentDeclaration",eh$$module$libs$world_onscreen="#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec4 vLightSpecular{X};\n#else\nvec4 vLightSpecular{X}=vec4(0.);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float cascadeBlendFactor{X};\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\nuniform highp sampler2DArray depthSampler{X};\nuniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float penumbraDarkness{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\n#else\nuniform highp sampler2DArray shadowSampler{X};\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\n(\nvec3 ( 1.5,0.0,0.0 ),\nvec3 ( 0.0,1.5,0.0 ),\nvec3 ( 0.0,0.0,5.5 ),\nvec3 ( 1.5,0.0,5.5 ),\nvec3 ( 1.5,1.5,0.0 ),\nvec3 ( 1.0,1.0,1.0 ),\nvec3 ( 0.0,1.0,5.5 ),\nvec3 ( 0.5,3.5,0.75 )\n);\nvec3 shadowDebug{X};\n#endif\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nint index{X}=-1;\n#else\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\n#endif\nfloat diff{X}=0.;\n#elif defined(SHADOWCUBE{X})\nuniform samplerCube shadowSampler{X};\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DShadow shadowSampler{X};\nuniform highp sampler2D depthSampler{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DShadow shadowSampler{X};\n#else\nuniform sampler2D shadowSampler{X};\n#endif\nuniform mat4 lightMatrix{X};\n#endif\nuniform vec4 shadowsInfo{X};\nuniform vec2 depthValues{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\nuniform vec4 vLightFalloff{X};\n#elif defined(POINTLIGHT{X})\nuniform vec4 vLightFalloff{X};\n#elif defined(HEMILIGHT{X})\nuniform vec3 vLightGround{X};\n#endif\n#ifdef PROJECTEDLIGHTTEXTURE{X}\nuniform mat4 textureProjectionMatrix{X};\nuniform sampler2D projectionLightSampler{X};\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Jo$$module$libs$world_onscreen]=eh$$module$libs$world_onscreen;const th$$module$libs$world_onscreen="lightUboDeclaration",ih$$module$libs$world_onscreen="#ifdef LIGHT{X}\nuniform Light{X}\n{\nvec4 vLightData;\nvec4 vLightDiffuse;\nvec4 vLightSpecular;\n#ifdef SPOTLIGHT{X}\nvec4 vLightDirection;\nvec4 vLightFalloff;\n#elif defined(POINTLIGHT{X})\nvec4 vLightFalloff;\n#elif defined(HEMILIGHT{X})\nvec3 vLightGround;\n#endif\nvec4 shadowsInfo;\nvec2 depthValues;\n} light{X};\n#ifdef PROJECTEDLIGHTTEXTURE{X}\nuniform mat4 textureProjectionMatrix{X};\nuniform sampler2D projectionLightSampler{X};\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float cascadeBlendFactor{X};\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\nuniform highp sampler2DArray depthSampler{X};\nuniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float penumbraDarkness{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\n#else\nuniform highp sampler2DArray shadowSampler{X};\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\n(\nvec3 ( 1.5,0.0,0.0 ),\nvec3 ( 0.0,1.5,0.0 ),\nvec3 ( 0.0,0.0,5.5 ),\nvec3 ( 1.5,0.0,5.5 ),\nvec3 ( 1.5,1.5,0.0 ),\nvec3 ( 1.0,1.0,1.0 ),\nvec3 ( 0.0,1.0,5.5 ),\nvec3 ( 0.5,3.5,0.75 )\n);\nvec3 shadowDebug{X};\n#endif\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nint index{X}=-1;\n#else\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\n#endif\nfloat diff{X}=0.;\n#elif defined(SHADOWCUBE{X})\nuniform samplerCube shadowSampler{X}; \n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DShadow shadowSampler{X};\nuniform highp sampler2D depthSampler{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DShadow shadowSampler{X};\n#else\nuniform sampler2D shadowSampler{X};\n#endif\nuniform mat4 lightMatrix{X};\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[th$$module$libs$world_onscreen]=ih$$module$libs$world_onscreen;const sh$$module$libs$world_onscreen="lightsFragmentFunctions",rh$$module$libs$world_onscreen="struct lightingInfo\n{\nvec3 diffuse;\n#ifdef SPECULARTERM\nvec3 specular;\n#endif\n#ifdef NDOTL\nfloat ndl;\n#endif\n};\nlightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 lightVectorW;\nfloat attenuation=1.0;\nif (lightData.w==0.)\n{\nvec3 direction=lightData.xyz-vPositionW;\nattenuation=max(0.,1.0-length(direction)/range);\nlightVectorW=normalize(direction);\n}\nelse\n{\nlightVectorW=normalize(-lightData.xyz);\n}\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nlightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 direction=lightData.xyz-vPositionW;\nvec3 lightVectorW=normalize(direction);\nfloat attenuation=max(0.,1.0-length(direction)/range);\nfloat cosAngle=max(0.,dot(lightDirection.xyz,-lightVectorW));\nif (cosAngle>=lightDirection.w)\n{\ncosAngle=max(0.,pow(cosAngle,lightData.w));\nattenuation*=cosAngle;\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nresult.diffuse=vec3(0.);\n#ifdef SPECULARTERM\nresult.specular=vec3(0.);\n#endif\n#ifdef NDOTL\nresult.ndl=0.;\n#endif\nreturn result;\n}\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {\nlightingInfo result;\nfloat ndl=dot(vNormal,lightData.xyz)*0.5+0.5;\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=mix(groundColor,diffuseColor,ndl);\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightData.xyz);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor;\n#endif\nreturn result;\n}\n#define inline\nvec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix){\nvec4 strq=textureProjectionMatrix*vec4(vPositionW,1.0);\nstrq/=strq.w;\nvec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;\nreturn textureColor;\n}";
U$$module$libs$world_onscreen.IncludesShadersStore[sh$$module$libs$world_onscreen]=rh$$module$libs$world_onscreen;const nh$$module$libs$world_onscreen="shadowsFragmentFunctions",ah$$module$libs$world_onscreen="#ifdef SHADOWS\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\n#define TEXTUREFUNC(s,c,l) texture2DLodEXT(s,c,l)\n#else\n#define TEXTUREFUNC(s,c,b) texture2D(s,c,b)\n#endif\n#ifndef SHADOWFLOAT\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);\nreturn dot(color,bit_shift);\n}\n#endif\nfloat computeFallOff(float value,vec2 clipSpace,float frustumEdgeFalloff)\n{\nfloat mask=smoothstep(1.0-frustumEdgeFalloff,1.00000012,clamp(dot(clipSpace,clipSpace),0.,1.));\nreturn mix(value,1.0,mask);\n}\n#define inline\nfloat computeShadowCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadow=textureCube(shadowSampler,directionToLight).x;\n#endif\nreturn depth>shadow ? darkness : 1.0;\n}\n#define inline\nfloat computeShadowWithPoissonSamplingCube(vec3 lightPosition,samplerCube shadowSampler,float mapSize,float darkness,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\nfloat visibility=1.;\nvec3 poissonDisk[4];\npoissonDisk[0]=vec3(-1.0,1.0,-1.0);\npoissonDisk[1]=vec3(1.0,-1.0,-1.0);\npoissonDisk[2]=vec3(-1.0,-1.0,-1.0);\npoissonDisk[3]=vec3(1.0,-1.0,1.0);\n#ifndef SHADOWFLOAT\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<depth) visibility-=0.25;\n#else\nif (textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize).x<depth) visibility-=0.25;\n#endif\nreturn min(1.0,visibility+darkness);\n}\n#define inline\nfloat computeShadowWithESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\nfloat shadowPixelDepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\n#endif\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness); \nreturn esm;\n}\n#define inline\nfloat computeShadowWithCloseESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\nfloat shadowPixelDepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\n#endif\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);\nreturn esm;\n}\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\n#define inline\nfloat computeShadowCSM(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nvec3 uvLayer=vec3(uv.x,uv.y,layer);\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(texture2D(shadowSampler,uvLayer));\n#else\nfloat shadow=texture2D(shadowSampler,uvLayer).x;\n#endif\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;\n}\n#endif\n#define inline\nfloat computeShadow(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\n#else\nfloat shadow=TEXTUREFUNC(shadowSampler,uv,0.).x;\n#endif\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;\n}\n}\n#define inline\nfloat computeShadowWithPoissonSampling(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float mapSize,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\nfloat visibility=1.;\nvec2 poissonDisk[4];\npoissonDisk[0]=vec2(-0.94201624,-0.39906216);\npoissonDisk[1]=vec2(0.94558609,-0.76890725);\npoissonDisk[2]=vec2(-0.094184101,-0.92938870);\npoissonDisk[3]=vec2(0.34495938,0.29387760);\n#ifndef SHADOWFLOAT\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\n#else\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\n#endif\nreturn computeFallOff(min(1.0,visibility+darkness),clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\n#else\nfloat shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;\n#endif\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);\nreturn computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithCloseESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0); \n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\n#else\nfloat shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;\n#endif\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);\nreturn computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#ifdef IS_NDC_HALF_ZRANGE\n#define ZINCLIP clipSpace.z\n#else\n#define ZINCLIP uvDepth.z\n#endif\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\n#define GREATEST_LESS_THAN_ONE 0.99999994\n#define inline\nfloat computeShadowWithCSMPCF1(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);\nfloat shadow=texture2D(shadowSampler,uvDepthLayer);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithCSMPCF3(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=3.-2.*st;\nvec2 uvw1=1.+2.*st;\nvec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;\nvec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));\nshadow=shadow/16.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithCSMPCF5(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=4.-3.*st;\nvec2 uvw1=vec2(7.);\nvec2 uvw2=1.+3.*st;\nvec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;\nvec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[0]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[1]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[2]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[2]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[2]),layer,uvDepth.z));\nshadow=shadow/144.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithPCF1(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nfloat shadow=TEXTUREFUNC(shadowSampler,uvDepth,0.);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCF3(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=3.-2.*st;\nvec2 uvw1=1.+2.*st;\nvec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;\nvec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);\nshadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);\nshadow=shadow/16.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCF5(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=4.-3.*st;\nvec2 uvw1=vec2(7.);\nvec2 uvw2=1.+3.*st;\nvec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;\nvec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);\nshadow+=uvw2.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[0]),uvDepth.z),0.);\nshadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);\nshadow+=uvw2.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[1]),uvDepth.z),0.);\nshadow+=uvw0.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[2]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[2]),uvDepth.z),0.);\nshadow+=uvw2.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[2]),uvDepth.z),0.);\nshadow=shadow/144.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\nconst vec3 PoissonSamplers32[64]=vec3[64](\nvec3(0.06407013,0.05409927,0.),\nvec3(0.7366577,0.5789394,0.),\nvec3(-0.6270542,-0.5320278,0.),\nvec3(-0.4096107,0.8411095,0.),\nvec3(0.6849564,-0.4990818,0.),\nvec3(-0.874181,-0.04579735,0.),\nvec3(0.9989998,0.0009880066,0.),\nvec3(-0.004920578,-0.9151649,0.),\nvec3(0.1805763,0.9747483,0.),\nvec3(-0.2138451,0.2635818,0.),\nvec3(0.109845,0.3884785,0.),\nvec3(0.06876755,-0.3581074,0.),\nvec3(0.374073,-0.7661266,0.),\nvec3(0.3079132,-0.1216763,0.),\nvec3(-0.3794335,-0.8271583,0.),\nvec3(-0.203878,-0.07715034,0.),\nvec3(0.5912697,0.1469799,0.),\nvec3(-0.88069,0.3031784,0.),\nvec3(0.5040108,0.8283722,0.),\nvec3(-0.5844124,0.5494877,0.),\nvec3(0.6017799,-0.1726654,0.),\nvec3(-0.5554981,0.1559997,0.),\nvec3(-0.3016369,-0.3900928,0.),\nvec3(-0.5550632,-0.1723762,0.),\nvec3(0.925029,0.2995041,0.),\nvec3(-0.2473137,0.5538505,0.),\nvec3(0.9183037,-0.2862392,0.),\nvec3(0.2469421,0.6718712,0.),\nvec3(0.3916397,-0.4328209,0.),\nvec3(-0.03576927,-0.6220032,0.),\nvec3(-0.04661255,0.7995201,0.),\nvec3(0.4402924,0.3640312,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.)\n);\nconst vec3 PoissonSamplers64[64]=vec3[64](\nvec3(-0.613392,0.617481,0.),\nvec3(0.170019,-0.040254,0.),\nvec3(-0.299417,0.791925,0.),\nvec3(0.645680,0.493210,0.),\nvec3(-0.651784,0.717887,0.),\nvec3(0.421003,0.027070,0.),\nvec3(-0.817194,-0.271096,0.),\nvec3(-0.705374,-0.668203,0.),\nvec3(0.977050,-0.108615,0.),\nvec3(0.063326,0.142369,0.),\nvec3(0.203528,0.214331,0.),\nvec3(-0.667531,0.326090,0.),\nvec3(-0.098422,-0.295755,0.),\nvec3(-0.885922,0.215369,0.),\nvec3(0.566637,0.605213,0.),\nvec3(0.039766,-0.396100,0.),\nvec3(0.751946,0.453352,0.),\nvec3(0.078707,-0.715323,0.),\nvec3(-0.075838,-0.529344,0.),\nvec3(0.724479,-0.580798,0.),\nvec3(0.222999,-0.215125,0.),\nvec3(-0.467574,-0.405438,0.),\nvec3(-0.248268,-0.814753,0.),\nvec3(0.354411,-0.887570,0.),\nvec3(0.175817,0.382366,0.),\nvec3(0.487472,-0.063082,0.),\nvec3(-0.084078,0.898312,0.),\nvec3(0.488876,-0.783441,0.),\nvec3(0.470016,0.217933,0.),\nvec3(-0.696890,-0.549791,0.),\nvec3(-0.149693,0.605762,0.),\nvec3(0.034211,0.979980,0.),\nvec3(0.503098,-0.308878,0.),\nvec3(-0.016205,-0.872921,0.),\nvec3(0.385784,-0.393902,0.),\nvec3(-0.146886,-0.859249,0.),\nvec3(0.643361,0.164098,0.),\nvec3(0.634388,-0.049471,0.),\nvec3(-0.688894,0.007843,0.),\nvec3(0.464034,-0.188818,0.),\nvec3(-0.440840,0.137486,0.),\nvec3(0.364483,0.511704,0.),\nvec3(0.034028,0.325968,0.),\nvec3(0.099094,-0.308023,0.),\nvec3(0.693960,-0.366253,0.),\nvec3(0.678884,-0.204688,0.),\nvec3(0.001801,0.780328,0.),\nvec3(0.145177,-0.898984,0.),\nvec3(0.062655,-0.611866,0.),\nvec3(0.315226,-0.604297,0.),\nvec3(-0.780145,0.486251,0.),\nvec3(-0.371868,0.882138,0.),\nvec3(0.200476,0.494430,0.),\nvec3(-0.494552,-0.711051,0.),\nvec3(0.612476,0.705252,0.),\nvec3(-0.578845,-0.768792,0.),\nvec3(-0.772454,-0.090976,0.),\nvec3(0.504440,0.372295,0.),\nvec3(0.155736,0.065157,0.),\nvec3(0.391522,0.849605,0.),\nvec3(-0.620106,-0.328104,0.),\nvec3(0.789239,-0.419965,0.),\nvec3(-0.545396,0.538133,0.),\nvec3(-0.178564,-0.596057,0.)\n);\n#define inline\nfloat computeShadowWithCSMPCSS(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);\nfloat blockerDepth=0.0;\nfloat sumBlockerDepth=0.0;\nfloat numBlocker=0.0;\nfor (int i=0; i<searchTapCount; i ++) {\nblockerDepth=texture2D(depthSampler,vec3(uvDepth.xy+(lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse*PoissonSamplers32[i].xy),layer)).r;\nif (blockerDepth<depthMetric) {\nsumBlockerDepth+=blockerDepth;\nnumBlocker++;\n}\n}\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;\nfloat AAOffset=shadowMapSizeInverse*10.;\nfloat penumbraRatio=((depthMetric-avgBlockerDepth)*depthCorrection+AAOffset);\nvec4 filterRadius=vec4(penumbraRatio*lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse,0.,0.);\nfloat random=getRand(vPositionFromLight.xy);\nfloat rotationAngle=random*3.1415926;\nvec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));\nfloat shadow=0.;\nfor (int i=0; i<pcfTapCount; i++) {\nvec4 offset=vec4(poissonSamplers[i],0.);\noffset=vec4(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.,0.);\nshadow+=texture2D(shadowSampler,uvDepthLayer+offset*filterRadius);\n}\nshadow/=float(pcfTapCount);\nshadow=mix(shadow,1.,min((depthMetric-avgBlockerDepth)*depthCorrection*penumbraDarkness,1.));\nshadow=mix(darkness,1.,shadow);\nif (numBlocker<1.0) {\nreturn 1.0;\n}\nelse\n{\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCSS(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nfloat blockerDepth=0.0;\nfloat sumBlockerDepth=0.0;\nfloat numBlocker=0.0;\nfor (int i=0; i<searchTapCount; i ++) {\nblockerDepth=TEXTUREFUNC(depthSampler,uvDepth.xy+(lightSizeUV*shadowMapSizeInverse*PoissonSamplers32[i].xy),0.).r;\nif (blockerDepth<depthMetric) {\nsumBlockerDepth+=blockerDepth;\nnumBlocker++;\n}\n}\nif (numBlocker<1.0) {\nreturn 1.0;\n}\nelse\n{\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;\nfloat AAOffset=shadowMapSizeInverse*10.;\nfloat penumbraRatio=((depthMetric-avgBlockerDepth)+AAOffset);\nfloat filterRadius=penumbraRatio*lightSizeUV*shadowMapSizeInverse;\nfloat random=getRand(vPositionFromLight.xy);\nfloat rotationAngle=random*3.1415926;\nvec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));\nfloat shadow=0.;\nfor (int i=0; i<pcfTapCount; i++) {\nvec3 offset=poissonSamplers[i];\noffset=vec3(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.);\nshadow+=TEXTUREFUNC(shadowSampler,uvDepth+offset*filterRadius,0.);\n}\nshadow/=float(pcfTapCount);\nshadow=mix(shadow,1.,depthMetric-avgBlockerDepth);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n}\n#define inline\nfloat computeShadowWithPCSS16(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32);\n}\n#define inline\nfloat computeShadowWithPCSS32(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32);\n}\n#define inline\nfloat computeShadowWithPCSS64(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64);\n}\n#define inline\nfloat computeShadowWithCSMPCSS16(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#define inline\nfloat computeShadowWithCSMPCSS32(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#define inline\nfloat computeShadowWithCSMPCSS64(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[nh$$module$libs$world_onscreen]=ah$$module$libs$world_onscreen;const oh$$module$libs$world_onscreen="samplerFragmentDeclaration",hh$$module$libs$world_onscreen="#ifdef _DEFINENAME_\n#if _DEFINENAME_DIRECTUV==1\n#define v_VARYINGNAME_UV vMainUV1\n#elif _DEFINENAME_DIRECTUV==2\n#define v_VARYINGNAME_UV vMainUV2\n#elif _DEFINENAME_DIRECTUV==3\n#define v_VARYINGNAME_UV vMainUV3\n#elif _DEFINENAME_DIRECTUV==4\n#define v_VARYINGNAME_UV vMainUV4\n#elif _DEFINENAME_DIRECTUV==5\n#define v_VARYINGNAME_UV vMainUV5\n#elif _DEFINENAME_DIRECTUV==6\n#define v_VARYINGNAME_UV vMainUV6\n#else\nvarying vec2 v_VARYINGNAME_UV;\n#endif\nuniform sampler2D _SAMPLERNAME_Sampler;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[oh$$module$libs$world_onscreen]=hh$$module$libs$world_onscreen;const lh$$module$libs$world_onscreen="fresnelFunction",ch$$module$libs$world_onscreen="#ifdef FRESNEL\nfloat computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)\n{\nfloat fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);\nreturn clamp(fresnelTerm,0.,1.);\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[lh$$module$libs$world_onscreen]=ch$$module$libs$world_onscreen;const uh$$module$libs$world_onscreen="reflectionFunction",dh$$module$libs$world_onscreen="vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0); \n}\nvec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(1.0-s,t,0); \n}\nvec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);\nvec3 r=normalize(reflect(cameraToVertex,worldNormal));\nr=vec3(reflectionMatrix*vec4(r,0));\nfloat lon=atan(r.z,r.x);\nfloat lat=acos(r.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0);\n}\nvec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(vec3(view*worldPos));\nvec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));\nvec3 r=reflect(viewDir,viewNormal);\nr=vec3(reflectionMatrix*vec4(r,0));\nr.z=r.z-1.0;\nfloat m=2.0*length(r);\nreturn vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);\n}\nvec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=worldPos.xyz-eyePosition;\nvec3 coords=normalize(reflect(viewDir,worldNormal));\nreturn vec3(reflectionMatrix*vec4(coords,1));\n}\nvec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*(view*worldPos));\n}\nvec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*vec4(positionW,1.));\n}\n#ifdef REFLECTION\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\n{\n#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\nreturn computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SPHERICAL\nreturn computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_PLANAR\nreturn computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_CUBIC\n#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC\nreturn computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);\n#else\nreturn computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn computeProjectionCoords(worldPos,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn computeSkyBoxCoords(vPositionUVW,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\n#endif\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[uh$$module$libs$world_onscreen]=dh$$module$libs$world_onscreen;const fh$$module$libs$world_onscreen="imageProcessingDeclaration",_h$$module$libs$world_onscreen="#ifdef EXPOSURE\nuniform float exposureLinear;\n#endif\n#ifdef CONTRAST\nuniform float contrast;\n#endif\n#if defined(VIGNETTE) || defined(DITHER)\nuniform vec2 vInverseScreenSize;\n#endif\n#ifdef VIGNETTE\nuniform vec4 vignetteSettings1;\nuniform vec4 vignetteSettings2;\n#endif\n#ifdef COLORCURVES\nuniform vec4 vCameraColorCurveNegative;\nuniform vec4 vCameraColorCurveNeutral;\nuniform vec4 vCameraColorCurvePositive;\n#endif\n#ifdef COLORGRADING\n#ifdef COLORGRADING3D\nuniform highp sampler3D txColorTransform;\n#else\nuniform sampler2D txColorTransform;\n#endif\nuniform vec4 colorTransformSettings;\n#endif\n#ifdef DITHER\nuniform float ditherIntensity;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[fh$$module$libs$world_onscreen]=_h$$module$libs$world_onscreen;const gh$$module$libs$world_onscreen="imageProcessingFunctions",ph$$module$libs$world_onscreen="#if defined(COLORGRADING) && !defined(COLORGRADING3D)\n/** \n* Polyfill for SAMPLE_TEXTURE_3D,which is unsupported in WebGL.\n* sampler3dSetting.x=textureOffset (0.5/textureSize).\n* sampler3dSetting.y=textureSize.\n*/\n#define inline\nvec3 sampleTexture3D(sampler2D colorTransform,vec3 color,vec2 sampler3dSetting)\n{\nfloat sliceSize=2.0*sampler3dSetting.x; \n#ifdef SAMPLER3DGREENDEPTH\nfloat sliceContinuous=(color.g-sampler3dSetting.x)*sampler3dSetting.y;\n#else\nfloat sliceContinuous=(color.b-sampler3dSetting.x)*sampler3dSetting.y;\n#endif\nfloat sliceInteger=floor(sliceContinuous);\nfloat sliceFraction=sliceContinuous-sliceInteger;\n#ifdef SAMPLER3DGREENDEPTH\nvec2 sliceUV=color.rb;\n#else\nvec2 sliceUV=color.rg;\n#endif\nsliceUV.x*=sliceSize;\nsliceUV.x+=sliceInteger*sliceSize;\nsliceUV=saturate(sliceUV);\nvec4 slice0Color=texture2D(colorTransform,sliceUV);\nsliceUV.x+=sliceSize;\nsliceUV=saturate(sliceUV);\nvec4 slice1Color=texture2D(colorTransform,sliceUV);\nvec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);\n#ifdef SAMPLER3DBGRMAP\ncolor.rgb=result.rgb;\n#else\ncolor.rgb=result.bgr;\n#endif\nreturn color;\n}\n#endif\n#ifdef TONEMAPPING_ACES\nconst mat3 ACESInputMat=mat3(\nvec3(0.59719,0.07600,0.02840),\nvec3(0.35458,0.90834,0.13383),\nvec3(0.04823,0.01566,0.83777)\n);\nconst mat3 ACESOutputMat=mat3(\nvec3( 1.60475,-0.10208,-0.00327),\nvec3(-0.53108, 1.10813,-0.07276),\nvec3(-0.07367,-0.00605, 1.07602)\n);\nvec3 RRTAndODTFit(vec3 v)\n{\nvec3 a=v*(v+0.0245786)-0.000090537;\nvec3 b=v*(0.983729*v+0.4329510)+0.238081;\nreturn a/b;\n}\nvec3 ACESFitted(vec3 color)\n{\ncolor=ACESInputMat*color;\ncolor=RRTAndODTFit(color);\ncolor=ACESOutputMat*color;\ncolor=saturate(color);\nreturn color;\n}\n#endif\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_DEFINITIONS\nvec4 applyImageProcessing(vec4 result) {\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATSTART\n#ifdef EXPOSURE\nresult.rgb*=exposureLinear;\n#endif\n#ifdef VIGNETTE\nvec2 viewportXY=gl_FragCoord.xy*vInverseScreenSize;\nviewportXY=viewportXY*2.0-1.0;\nvec3 vignetteXY1=vec3(viewportXY*vignetteSettings1.xy+vignetteSettings1.zw,1.0);\nfloat vignetteTerm=dot(vignetteXY1,vignetteXY1);\nfloat vignette=pow(vignetteTerm,vignetteSettings2.w);\nvec3 vignetteColor=vignetteSettings2.rgb;\n#ifdef VIGNETTEBLENDMODEMULTIPLY\nvec3 vignetteColorMultiplier=mix(vignetteColor,vec3(1,1,1),vignette);\nresult.rgb*=vignetteColorMultiplier;\n#endif\n#ifdef VIGNETTEBLENDMODEOPAQUE\nresult.rgb=mix(vignetteColor,result.rgb,vignette);\n#endif\n#endif\n#ifdef TONEMAPPING\n#ifdef TONEMAPPING_ACES\nresult.rgb=ACESFitted(result.rgb);\n#else\nconst float tonemappingCalibration=1.590579;\nresult.rgb=1.0-exp2(-tonemappingCalibration*result.rgb);\n#endif\n#endif\nresult.rgb=toGammaSpace(result.rgb);\nresult.rgb=saturate(result.rgb);\n#ifdef CONTRAST\nvec3 resultHighContrast=result.rgb*result.rgb*(3.0-2.0*result.rgb);\nif (contrast<1.0) {\nresult.rgb=mix(vec3(0.5,0.5,0.5),result.rgb,contrast);\n} else {\nresult.rgb=mix(result.rgb,resultHighContrast,contrast-1.0);\n}\n#endif\n#ifdef COLORGRADING\nvec3 colorTransformInput=result.rgb*colorTransformSettings.xxx+colorTransformSettings.yyy;\n#ifdef COLORGRADING3D\nvec3 colorTransformOutput=texture(txColorTransform,colorTransformInput).rgb;\n#else\nvec3 colorTransformOutput=sampleTexture3D(txColorTransform,colorTransformInput,colorTransformSettings.yz).rgb;\n#endif\nresult.rgb=mix(result.rgb,colorTransformOutput,colorTransformSettings.www);\n#endif\n#ifdef COLORCURVES\nfloat luma=getLuminance(result.rgb);\nvec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0),vec2(1.0));\nvec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;\nresult.rgb*=colorCurve.rgb;\nresult.rgb=mix(vec3(luma),result.rgb,colorCurve.a);\n#endif\n#ifdef DITHER\nfloat rand=getRand(gl_FragCoord.xy*vInverseScreenSize);\nfloat dither=mix(-ditherIntensity,ditherIntensity,rand);\nresult.rgb=saturate(result.rgb+vec3(dither));\n#endif\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATEND\nreturn result;\n}";
U$$module$libs$world_onscreen.IncludesShadersStore[gh$$module$libs$world_onscreen]=ph$$module$libs$world_onscreen;const mh$$module$libs$world_onscreen="bumpFragmentMainFunctions",Eh$$module$libs$world_onscreen="#if defined(BUMP) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC) || defined(DETAIL)\n#if defined(TANGENT) && defined(NORMAL) \nvarying mat3 vTBN;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\nuniform mat4 normalMatrix;\n#endif\nvec3 perturbNormalBase(mat3 cotangentFrame,vec3 normal,float scale)\n{\n#ifdef NORMALXYSCALE\nnormal=normalize(normal*vec3(scale,scale,1.0));\n#endif\nreturn normalize(cotangentFrame*normal);\n}\nvec3 perturbNormal(mat3 cotangentFrame,vec3 textureSample,float scale)\n{\nreturn perturbNormalBase(cotangentFrame,textureSample*2.0-1.0,scale);\n}\nmat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv,vec2 tangentSpaceParams)\n{\nvec3 dp1=dFdx(p);\nvec3 dp2=dFdy(p);\nvec2 duv1=dFdx(uv);\nvec2 duv2=dFdy(uv);\nvec3 dp2perp=cross(dp2,normal);\nvec3 dp1perp=cross(normal,dp1);\nvec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;\nvec3 bitangent=dp2perp*duv1.y+dp1perp*duv2.y;\ntangent*=tangentSpaceParams.x;\nbitangent*=tangentSpaceParams.y;\nfloat det=max(dot(tangent,tangent),dot(bitangent,bitangent));\nfloat invmax=det==0.0 ? 0.0 : inversesqrt(det);\nreturn mat3(tangent*invmax,bitangent*invmax,normal);\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[mh$$module$libs$world_onscreen]=Eh$$module$libs$world_onscreen;const vh$$module$libs$world_onscreen="bumpFragmentFunctions",Th$$module$libs$world_onscreen="#if defined(BUMP)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_SAMPLERNAME_,bump)\n#endif\n#if defined(DETAIL)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_SAMPLERNAME_,detail)\n#endif\n#if defined(BUMP) && defined(PARALLAX)\nconst float minSamples=4.;\nconst float maxSamples=15.;\nconst int iMaxSamples=15;\nvec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {\nfloat parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;\nparallaxLimit*=parallaxScale;\nvec2 vOffsetDir=normalize(vViewDirCoT.xy);\nvec2 vMaxOffset=vOffsetDir*parallaxLimit;\nfloat numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));\nfloat stepSize=1.0/numSamples;\nfloat currRayHeight=1.0;\nvec2 vCurrOffset=vec2(0,0);\nvec2 vLastOffset=vec2(0,0);\nfloat lastSampledHeight=1.0;\nfloat currSampledHeight=1.0;\nbool keepWorking=true;\nfor (int i=0; i<iMaxSamples; i++)\n{\ncurrSampledHeight=texture2D(bumpSampler,texCoord+vCurrOffset).w;\nif (!keepWorking)\n{\n}\nelse if (currSampledHeight>currRayHeight)\n{\nfloat delta1=currSampledHeight-currRayHeight;\nfloat delta2=(currRayHeight+stepSize)-lastSampledHeight;\nfloat ratio=delta1/(delta1+delta2);\nvCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;\nkeepWorking=false;\n}\nelse\n{\ncurrRayHeight-=stepSize;\nvLastOffset=vCurrOffset;\nvCurrOffset+=stepSize*vMaxOffset;\nlastSampledHeight=currSampledHeight;\n}\n}\nreturn vCurrOffset;\n}\nvec2 parallaxOffset(vec3 viewDir,float heightScale)\n{\nfloat height=texture2D(bumpSampler,vBumpUV).w;\nvec2 texCoordOffset=heightScale*viewDir.xy*height;\nreturn -texCoordOffset;\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[vh$$module$libs$world_onscreen]=Th$$module$libs$world_onscreen;const bh$$module$libs$world_onscreen="logDepthDeclaration",Sh$$module$libs$world_onscreen="#ifdef LOGARITHMICDEPTH\nuniform float logarithmicDepthConstant;\nvarying float vFragmentDepth;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[bh$$module$libs$world_onscreen]=Sh$$module$libs$world_onscreen;
const xh$$module$libs$world_onscreen="fogFragmentDeclaration",Mh$$module$libs$world_onscreen="#ifdef FOG\n#define FOGMODE_NONE 0.\n#define FOGMODE_EXP 1.\n#define FOGMODE_EXP2 2.\n#define FOGMODE_LINEAR 3.\n#define E 2.71828\nuniform vec4 vFogInfos;\nuniform vec3 vFogColor;\nvarying vec3 vFogDistance;\nfloat CalcFogFactor()\n{\nfloat fogCoeff=1.0;\nfloat fogStart=vFogInfos.y;\nfloat fogEnd=vFogInfos.z;\nfloat fogDensity=vFogInfos.w;\nfloat fogDistance=length(vFogDistance);\nif (FOGMODE_LINEAR==vFogInfos.x)\n{\nfogCoeff=(fogEnd-fogDistance)/(fogEnd-fogStart);\n}\nelse if (FOGMODE_EXP==vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fogDistance*fogDensity);\n}\nelse if (FOGMODE_EXP2==vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fogDistance*fogDistance*fogDensity*fogDensity);\n}\nreturn clamp(fogCoeff,0.0,1.0);\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[xh$$module$libs$world_onscreen]=Mh$$module$libs$world_onscreen;const Ah$$module$libs$world_onscreen="bumpFragment",Rh$$module$libs$world_onscreen="vec2 uvOffset=vec2(0.0,0.0);\n#if defined(BUMP) || defined(PARALLAX) || defined(DETAIL)\n#ifdef NORMALXYSCALE\nfloat normalScale=1.0;\n#elif defined(BUMP)\nfloat normalScale=vBumpInfos.y;\n#else\nfloat normalScale=1.0;\n#endif\n#if defined(TANGENT) && defined(NORMAL)\nmat3 TBN=vTBN;\n#elif defined(BUMP)\nvec2 TBNUV=gl_FrontFacing ? vBumpUV : -vBumpUV;\nmat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vTangentSpaceParams);\n#else\nvec2 TBNUV=gl_FrontFacing ? vDetailUV : -vDetailUV;\nmat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vec2(1.,1.));\n#endif\n#elif defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL)\nmat3 TBN=vTBN;\n#else\nvec2 TBNUV=gl_FrontFacing ? vMainUV1 : -vMainUV1;\nmat3 TBN=cotangent_frame(normalW,vPositionW,TBNUV,vec2(1.,1.));\n#endif\n#endif\n#ifdef PARALLAX\nmat3 invTBN=transposeMat3(TBN);\n#ifdef PARALLAXOCCLUSION\nuvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,vBumpUV,vBumpInfos.z);\n#else\nuvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);\n#endif\n#endif\n#ifdef DETAIL\nvec4 detailColor=texture2D(detailSampler,vDetailUV+uvOffset);\nvec2 detailNormalRG=detailColor.wy*2.0-1.0;\nfloat detailNormalB=sqrt(1.-saturate(dot(detailNormalRG,detailNormalRG)));\nvec3 detailNormal=vec3(detailNormalRG,detailNormalB);\n#endif\n#ifdef BUMP\n#ifdef OBJECTSPACE_NORMALMAP\nnormalW=normalize(texture2D(bumpSampler,vBumpUV).xyz *2.0-1.0);\nnormalW=normalize(mat3(normalMatrix)*normalW);\n#elif !defined(DETAIL)\nnormalW=perturbNormal(TBN,texture2D(bumpSampler,vBumpUV+uvOffset).xyz,vBumpInfos.y);\n#else\nvec3 bumpNormal=texture2D(bumpSampler,vBumpUV+uvOffset).xyz*2.0-1.0;\n#if DETAIL_NORMALBLENDMETHOD==0 \ndetailNormal.xy*=vDetailInfos.z;\nvec3 blendedNormal=normalize(vec3(bumpNormal.xy+detailNormal.xy,bumpNormal.z*detailNormal.z));\n#elif DETAIL_NORMALBLENDMETHOD==1 \ndetailNormal.xy*=vDetailInfos.z;\nbumpNormal+=vec3(0.0,0.0,1.0);\ndetailNormal*=vec3(-1.0,-1.0,1.0);\nvec3 blendedNormal=bumpNormal*dot(bumpNormal,detailNormal)/bumpNormal.z-detailNormal;\n#endif\nnormalW=perturbNormalBase(TBN,blendedNormal,vBumpInfos.y);\n#endif\n#elif defined(DETAIL)\ndetailNormal.xy*=vDetailInfos.z;\nnormalW=perturbNormalBase(TBN,detailNormal,vDetailInfos.z);\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Ah$$module$libs$world_onscreen]=Rh$$module$libs$world_onscreen;const yh$$module$libs$world_onscreen="depthPrePass",Ch$$module$libs$world_onscreen="#ifdef DEPTHPREPASS\ngl_FragColor=vec4(0.,0.,0.,1.0);\nreturn;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[yh$$module$libs$world_onscreen]=Ch$$module$libs$world_onscreen;const Ih$$module$libs$world_onscreen="lightFragment",Ph$$module$libs$world_onscreen="#ifdef LIGHT{X}\n#if defined(SHADOWONLY) || defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X}) && defined(LIGHTMAPNOSPECULAR{X})\n#else\n#ifdef PBR\n#ifdef SPOTLIGHT{X}\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(POINTLIGHT{X})\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(HEMILIGHT{X})\npreInfo=computeHemisphericPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(DIRLIGHT{X})\npreInfo=computeDirectionalPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#endif\npreInfo.NdotV=NdotV;\n#ifdef SPOTLIGHT{X}\n#ifdef LIGHT_FALLOFF_GLTF{X}\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\npreInfo.attenuation*=computeDirectionalLightFalloff_GLTF(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\npreInfo.attenuation*=computeDirectionalLightFalloff_Physical(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w);\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\npreInfo.attenuation*=computeDirectionalLightFalloff_Standard(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w);\n#else\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\npreInfo.attenuation*=computeDirectionalLightFalloff(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\n#endif\n#elif defined(POINTLIGHT{X})\n#ifdef LIGHT_FALLOFF_GLTF{X}\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\n#else\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\n#endif\n#else\npreInfo.attenuation=1.0;\n#endif\n#ifdef HEMILIGHT{X}\npreInfo.roughness=roughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(roughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\n#ifdef IRIDESCENCE\npreInfo.iridescenceIntensity=iridescenceIntensity;\n#endif\n#ifdef HEMILIGHT{X}\ninfo.diffuse=computeHemisphericDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb,light{X}.vLightGround);\n#elif defined(SS_TRANSLUCENCY)\ninfo.diffuse=computeDiffuseAndTransmittedLighting(preInfo,light{X}.vLightDiffuse.rgb,subSurfaceOut.transmittance);\n#else\ninfo.diffuse=computeDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb);\n#endif\n#ifdef SPECULARTERM\n#ifdef ANISOTROPIC\ninfo.specular=computeAnisotropicSpecularLighting(preInfo,viewDirectionW,normalW,anisotropicOut.anisotropicTangent,anisotropicOut.anisotropicBitangent,anisotropicOut.anisotropy,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#else\ninfo.specular=computeSpecularLighting(preInfo,normalW,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#endif\n#endif\n#ifdef SHEEN\n#ifdef SHEEN_LINKWITHALBEDO\npreInfo.roughness=sheenOut.sheenIntensity;\n#else\n#ifdef HEMILIGHT{X}\npreInfo.roughness=sheenOut.sheenRoughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(sheenOut.sheenRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\n#endif\ninfo.sheen=computeSheenLighting(preInfo,normalW,sheenOut.sheenColor,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#endif\n#ifdef CLEARCOAT\n#ifdef HEMILIGHT{X}\npreInfo.roughness=clearcoatOut.clearCoatRoughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(clearcoatOut.clearCoatRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\ninfo.clearCoat=computeClearCoatLighting(preInfo,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatAARoughnessFactors.x,clearcoatOut.clearCoatIntensity,light{X}.vLightDiffuse.rgb);\n#ifdef CLEARCOAT_TINT\nabsorption=computeClearCoatLightingAbsorption(clearcoatOut.clearCoatNdotVRefract,preInfo.L,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatColor,clearcoatOut.clearCoatThickness,clearcoatOut.clearCoatIntensity);\ninfo.diffuse*=absorption;\n#ifdef SPECULARTERM\ninfo.specular*=absorption;\n#endif\n#endif\ninfo.diffuse*=info.clearCoat.w;\n#ifdef SPECULARTERM\ninfo.specular*=info.clearCoat.w;\n#endif\n#ifdef SHEEN\ninfo.sheen*=info.clearCoat.w;\n#endif\n#endif\n#else\n#ifdef SPOTLIGHT{X}\ninfo=computeSpotLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDirection,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);\n#elif defined(HEMILIGHT{X})\ninfo=computeHemisphericLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightGround,glossiness);\n#elif defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})\ninfo=computeLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);\n#endif\n#endif\n#ifdef PROJECTEDLIGHTTEXTURE{X}\ninfo.diffuse*=computeProjectionTextureDiffuseLighting(projectionLightSampler{X},textureProjectionMatrix{X});\n#endif\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) \n{\n#ifdef SHADOWCSM_RIGHTHANDED{X}\ndiff{X}=viewFrustumZ{X}[i]+vPositionFromCamera{X}.z;\n#else\ndiff{X}=viewFrustumZ{X}[i]-vPositionFromCamera{X}.z;\n#endif\nif (diff{X}>=0.) {\nindex{X}=i;\nbreak;\n}\n}\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nif (index{X}>=0)\n#endif\n{\n#if defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#else\nshadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#endif\n#else\nshadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nshadowDebug{X}=vec3(shadow)*vCascadeColorsMultiplier{X}[index{X}];\n#endif\n#ifndef SHADOWCSMNOBLEND{X}\nfloat frustumLength=frustumLengths{X}[index{X}];\nfloat diffRatio=clamp(diff{X}/frustumLength,0.,1.)*cascadeBlendFactor{X};\nif (index{X}<(SHADOWCSMNUM_CASCADES{X}-1) && diffRatio<1.)\n{\nindex{X}+=1;\nfloat nextShadow=0.;\n#if defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nnextShadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nnextShadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nnextShadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nnextShadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#elif defined(SHADOWMEDIUMQUALITY{X})\nnextShadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#else\nnextShadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#endif\n#else\nnextShadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\nshadow=mix(nextShadow,shadow,diffRatio);\n#ifdef SHADOWCSMDEBUG{X}\nshadowDebug{X}=mix(vec3(nextShadow)*vCascadeColorsMultiplier{X}[index{X}],shadowDebug{X},diffRatio);\n#endif\n}\n#endif\n}\n#elif defined(SHADOWCLOSEESM{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithCloseESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\n#else\nshadow=computeShadowWithCloseESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWESM{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\n#else\nshadow=computeShadowWithESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPOISSON{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithPoissonSamplingCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.depthValues);\n#else\nshadow=computeShadowWithPoissonSampling(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithPCF1(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithPCF3(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithPCF5(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithPCSS16(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithPCSS32(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithPCSS64(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#else\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.depthValues);\n#else\nshadow=computeShadow(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#endif\n#ifdef SHADOWONLY\n#ifndef SHADOWINUSE\n#define SHADOWINUSE\n#endif\nglobalShadow+=shadow;\nshadowLightCount+=1.0;\n#endif\n#else\nshadow=1.;\n#endif\n#ifndef SHADOWONLY\n#ifdef CUSTOMUSERLIGHTING\ndiffuseBase+=computeCustomDiffuseLighting(info,diffuseBase,shadow);\n#ifdef SPECULARTERM\nspecularBase+=computeCustomSpecularLighting(info,specularBase,shadow);\n#endif\n#elif defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X})\ndiffuseBase+=lightmapColor.rgb*shadow;\n#ifdef SPECULARTERM\n#ifndef LIGHTMAPNOSPECULAR{X}\nspecularBase+=info.specular*shadow*lightmapColor.rgb;\n#endif\n#endif\n#ifdef CLEARCOAT\n#ifndef LIGHTMAPNOSPECULAR{X}\nclearCoatBase+=info.clearCoat.rgb*shadow*lightmapColor.rgb;\n#endif\n#endif\n#ifdef SHEEN\n#ifndef LIGHTMAPNOSPECULAR{X}\nsheenBase+=info.sheen.rgb*shadow;\n#endif\n#endif\n#else\n#ifdef SHADOWCSMDEBUG{X}\ndiffuseBase+=info.diffuse*shadowDebug{X};\n#else \ndiffuseBase+=info.diffuse*shadow;\n#endif\n#ifdef SPECULARTERM\nspecularBase+=info.specular*shadow;\n#endif\n#ifdef CLEARCOAT\nclearCoatBase+=info.clearCoat.rgb*shadow;\n#endif\n#ifdef SHEEN\nsheenBase+=info.sheen.rgb*shadow;\n#endif\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Ih$$module$libs$world_onscreen]=Ph$$module$libs$world_onscreen;const Dh$$module$libs$world_onscreen="logDepthFragment",Fh$$module$libs$world_onscreen="#ifdef LOGARITHMICDEPTH\ngl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[Dh$$module$libs$world_onscreen]=Fh$$module$libs$world_onscreen;
const wh$$module$libs$world_onscreen="fogFragment",Oh$$module$libs$world_onscreen="#ifdef FOG\nfloat fog=CalcFogFactor();\n#ifdef PBR\nfog=toLinearSpace(fog);\n#endif\ncolor.rgb=mix(vFogColor,color.rgb,fog);\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[wh$$module$libs$world_onscreen]=Oh$$module$libs$world_onscreen;const Lh$$module$libs$world_onscreen="oitFragment",Nh$$module$libs$world_onscreen="#ifdef ORDER_INDEPENDENT_TRANSPARENCY\nfloat fragDepth=gl_FragCoord.z; \n#ifdef ORDER_INDEPENDENT_TRANSPARENCY_16BITS\nuint halfFloat=packHalf2x16(vec2(fragDepth));\nvec2 full=unpackHalf2x16(halfFloat);\nfragDepth=full.x;\n#endif\nivec2 fragCoord=ivec2(gl_FragCoord.xy);\nvec2 lastDepth=texelFetch(oitDepthSampler,fragCoord,0).rg;\nvec4 lastFrontColor=texelFetch(oitFrontColorSampler,fragCoord,0);\ndepth.rg=vec2(-MAX_DEPTH);\nfrontColor=lastFrontColor;\nbackColor=vec4(0.0);\n#ifdef USE_REVERSE_DEPTHBUFFER\nfloat furthestDepth=-lastDepth.x;\nfloat nearestDepth=lastDepth.y;\n#else\nfloat nearestDepth=-lastDepth.x;\nfloat furthestDepth=lastDepth.y;\n#endif\nfloat alphaMultiplier=1.0-lastFrontColor.a;\n#ifdef USE_REVERSE_DEPTHBUFFER\nif (fragDepth>nearestDepth || fragDepth<furthestDepth) {\n#else\nif (fragDepth<nearestDepth || fragDepth>furthestDepth) {\n#endif\nreturn;\n}\n#ifdef USE_REVERSE_DEPTHBUFFER\nif (fragDepth<nearestDepth && fragDepth>furthestDepth) {\n#else\nif (fragDepth>nearestDepth && fragDepth<furthestDepth) {\n#endif\ndepth.rg=vec2(-fragDepth,fragDepth);\nreturn;\n}\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Lh$$module$libs$world_onscreen]=Nh$$module$libs$world_onscreen;const Bh$$module$libs$world_onscreen="defaultPixelShader",Uh$$module$libs$world_onscreen="#include<__decl__defaultFragment>\n#if defined(BUMP) || !defined(NORMAL)\n#extension GL_OES_standard_derivatives : enable\n#endif\n#include<prePassDeclaration>[SCENE_MRT_COUNT]\n#include<oitDeclaration>\n#define CUSTOM_FRAGMENT_BEGIN\n#ifdef LOGARITHMICDEPTH\n#extension GL_EXT_frag_depth : enable\n#endif\n#define RECIPROCAL_PI2 0.15915494\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nvarying vec4 vColor;\n#endif\n#include<mainUVVaryingDeclaration>[1..7]\n#include<helperFunctions>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_SAMPLERNAME_,diffuse)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_SAMPLERNAME_,ambient)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_SAMPLERNAME_,opacity)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_SAMPLERNAME_,emissive)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_SAMPLERNAME_,lightmap)\n#ifdef REFRACTION\n#ifdef REFRACTIONMAP_3D\nuniform samplerCube refractionCubeSampler;\n#else\nuniform sampler2D refraction2DSampler;\n#endif\n#endif\n#if defined(SPECULARTERM)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_SAMPLERNAME_,specular)\n#endif\n#include<fresnelFunction>\n#ifdef REFLECTION\n#ifdef REFLECTIONMAP_3D\nuniform samplerCube reflectionCubeSampler;\n#else\nuniform sampler2D reflection2DSampler;\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#else\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvarying vec3 vDirectionW;\n#endif\n#endif\n#include<reflectionFunction>\n#endif\n#include<imageProcessingDeclaration>\n#include<imageProcessingFunctions>\n#include<bumpFragmentMainFunctions>\n#include<bumpFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<logDepthDeclaration>\n#include<fogFragmentDeclaration>\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_FRAGMENT_MAIN_BEGIN\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\nfloat alpha=vDiffuseColor.a;\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=normalize(-cross(dFdx(vPositionW),dFdy(vPositionW)));\n#endif\n#include<bumpFragment>\n#ifdef TWOSIDEDLIGHTING\nnormalW=gl_FrontFacing ? normalW : -normalW;\n#endif\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV+uvOffset);\n#if defined(ALPHATEST) && !defined(ALPHATEST_AFTERALLALPHACOMPUTATIONS)\nif (baseColor.a<alphaCutOff)\ndiscard;\n#endif\n#ifdef ALPHAFROMDIFFUSE\nalpha*=baseColor.a;\n#endif\n#define CUSTOM_FRAGMENT_UPDATE_ALPHA\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#include<depthPrePass>\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nbaseColor.rgb*=vColor.rgb;\n#endif\n#ifdef DETAIL\nbaseColor.rgb=baseColor.rgb*2.0*mix(0.5,detailColor.r,vDetailInfos.y);\n#endif\n#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE\nvec3 baseAmbientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nbaseAmbientColor=texture2D(ambientSampler,vAmbientUV+uvOffset).rgb*vAmbientInfos.y;\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_LIGHTS\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularColor=vSpecularColor.rgb;\n#ifdef SPECULAR\nvec4 specularMapColor=texture2D(specularSampler,vSpecularUV+uvOffset);\nspecularColor=specularMapColor.rgb;\n#ifdef GLOSSINESS\nglossiness=glossiness*specularMapColor.a;\n#endif\n#endif\n#else\nfloat glossiness=0.;\n#endif\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\nfloat shadow=1.;\n#ifdef LIGHTMAP\nvec4 lightmapColor=texture2D(lightmapSampler,vLightmapUV+uvOffset);\n#ifdef RGBDLIGHTMAP\nlightmapColor.rgb=fromRGBD(lightmapColor);\n#endif\nlightmapColor.rgb*=vLightmapInfos.y;\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\nvec4 refractionColor=vec4(0.,0.,0.,1.);\n#ifdef REFRACTION\nvec3 refractionVector=normalize(refract(-viewDirectionW,normalW,vRefractionInfos.y));\n#ifdef REFRACTIONMAP_3D\n#ifdef USE_LOCAL_REFRACTIONMAP_CUBIC\nrefractionVector=parallaxCorrectNormal(vPositionW,refractionVector,vRefractionSize,vRefractionPosition);\n#endif\nrefractionVector.y=refractionVector.y*vRefractionInfos.w;\nif (dot(refractionVector,viewDirectionW)<1.0) {\nrefractionColor=textureCube(refractionCubeSampler,refractionVector);\n}\n#else\nvec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));\nvec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;\nrefractionCoords.y=1.0-refractionCoords.y;\nrefractionColor=texture2D(refraction2DSampler,refractionCoords);\n#endif\n#ifdef RGBDREFRACTION\nrefractionColor.rgb=fromRGBD(refractionColor);\n#endif\n#ifdef IS_REFRACTION_LINEAR\nrefractionColor.rgb=toGammaSpace(refractionColor.rgb);\n#endif\nrefractionColor.rgb*=vRefractionInfos.x;\n#endif\nvec4 reflectionColor=vec4(0.,0.,0.,1.);\n#ifdef REFLECTION\nvec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);\n#ifdef REFLECTIONMAP_OPPOSITEZ\nvReflectionUVW.z*=-1.0;\n#endif\n#ifdef REFLECTIONMAP_3D\n#ifdef ROUGHNESS\nfloat bias=vReflectionInfos.y;\n#ifdef SPECULARTERM\n#ifdef SPECULAR\n#ifdef GLOSSINESS\nbias*=(1.0-specularMapColor.a);\n#endif\n#endif\n#endif\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW,bias);\n#else\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW);\n#endif\n#else\nvec2 coords=vReflectionUVW.xy;\n#ifdef REFLECTIONMAP_PROJECTION\ncoords/=vReflectionUVW.z;\n#endif\ncoords.y=1.0-coords.y;\nreflectionColor=texture2D(reflection2DSampler,coords);\n#endif\n#ifdef RGBDREFLECTION\nreflectionColor.rgb=fromRGBD(reflectionColor);\n#endif\n#ifdef IS_REFLECTION_LINEAR\nreflectionColor.rgb=toGammaSpace(reflectionColor.rgb);\n#endif\nreflectionColor.rgb*=vReflectionInfos.x;\n#ifdef REFLECTIONFRESNEL\nfloat reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);\n#ifdef REFLECTIONFRESNELFROMSPECULAR\n#ifdef SPECULARTERM\nreflectionColor.rgb*=specularColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#else\nreflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#else\nreflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#endif\n#endif\n#ifdef REFRACTIONFRESNEL\nfloat refractionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,refractionRightColor.a,refractionLeftColor.a);\nrefractionColor.rgb*=refractionLeftColor.rgb*(1.0-refractionFresnelTerm)+refractionFresnelTerm*refractionRightColor.rgb;\n#endif\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV+uvOffset);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#if defined(VERTEXALPHA) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nalpha*=vColor.a;\n#endif\n#ifdef OPACITYFRESNEL\nfloat opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);\nalpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;\n#endif\n#ifdef ALPHATEST\n#ifdef ALPHATEST_AFTERALLALPHACOMPUTATIONS\nif (alpha<alphaCutOff)\ndiscard;\n#endif\n#ifndef ALPHABLEND\nalpha=1.0;\n#endif\n#endif\nvec3 emissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nemissiveColor+=texture2D(emissiveSampler,vEmissiveUV+uvOffset).rgb*vEmissiveInfos.y;\n#endif\n#ifdef EMISSIVEFRESNEL\nfloat emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);\nemissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;\n#endif\n#ifdef DIFFUSEFRESNEL\nfloat diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);\ndiffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;\n#endif\n#ifdef EMISSIVEASILLUMINATION\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\n#ifdef LINKEMISSIVEWITHDIFFUSE\nvec3 finalDiffuse=clamp((diffuseBase+emissiveColor)*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#endif\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#ifdef SPECULAROVERALPHA\nalpha=clamp(alpha+dot(finalSpecular,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#ifdef REFLECTIONOVERALPHA\nalpha=clamp(alpha+dot(reflectionColor.rgb,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#ifdef EMISSIVEASILLUMINATION\nvec4 color=vec4(clamp(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+emissiveColor+refractionColor.rgb,0.0,1.0),alpha);\n#else\nvec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+refractionColor.rgb,alpha);\n#endif\n#ifdef LIGHTMAP\n#ifndef LIGHTMAPEXCLUDED\n#ifdef USELIGHTMAPASSHADOWMAP\ncolor.rgb*=lightmapColor.rgb;\n#else\ncolor.rgb+=lightmapColor.rgb;\n#endif\n#endif\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_FOG\ncolor.rgb=max(color.rgb,0.);\n#include<logDepthFragment>\n#include<fogFragment>\n#ifdef IMAGEPROCESSINGPOSTPROCESS\ncolor.rgb=toLinearSpace(color.rgb);\n#else\n#ifdef IMAGEPROCESSING\ncolor.rgb=toLinearSpace(color.rgb);\ncolor=applyImageProcessing(color);\n#endif\n#endif\ncolor.a*=visibility;\n#ifdef PREMULTIPLYALPHA\ncolor.rgb*=color.a;\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR\n#ifdef PREPASS\nfloat writeGeometryInfo=color.a>0.4 ? 1.0 : 0.0;\ngl_FragData[0]=color; \n#ifdef PREPASS_POSITION\ngl_FragData[PREPASS_POSITION_INDEX]=vec4(vPositionW,writeGeometryInfo);\n#endif\n#ifdef PREPASS_VELOCITY\nvec2 a=(vCurrentPosition.xy/vCurrentPosition.w)*0.5+0.5;\nvec2 b=(vPreviousPosition.xy/vPreviousPosition.w)*0.5+0.5;\nvec2 velocity=abs(a-b);\nvelocity=vec2(pow(velocity.x,1.0/3.0),pow(velocity.y,1.0/3.0))*sign(a-b)*0.5+0.5;\ngl_FragData[PREPASS_VELOCITY_INDEX]=vec4(velocity,0.0,writeGeometryInfo);\n#endif\n#ifdef PREPASS_IRRADIANCE\ngl_FragData[PREPASS_IRRADIANCE_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_DEPTH\ngl_FragData[PREPASS_DEPTH_INDEX]=vec4(vViewPos.z,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_NORMAL\ngl_FragData[PREPASS_NORMAL_INDEX]=vec4((view*vec4(normalW,0.0)).rgb,writeGeometryInfo); \n#endif\n#ifdef PREPASS_ALBEDO_SQRT\ngl_FragData[PREPASS_ALBEDO_SQRT_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_REFLECTIVITY\n#if defined(SPECULARTERM)\n#if defined(SPECULAR)\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularMapColor)*writeGeometryInfo; \n#else\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularColor,1.0)*writeGeometryInfo;\n#endif\n#else\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(0.0,0.0,0.0,1.0)*writeGeometryInfo;\n#endif\n#endif\n#endif\n#if !defined(PREPASS) || defined(WEBGL2)\ngl_FragColor=color;\n#endif\n#include<oitFragment>\n#if ORDER_INDEPENDENT_TRANSPARENCY\nif (fragDepth==nearestDepth) {\nfrontColor.rgb+=color.rgb*color.a*alphaMultiplier;\nfrontColor.a=1.0-alphaMultiplier*(1.0-color.a);\n} else {\nbackColor+=color;\n}\n#endif\n#define CUSTOM_FRAGMENT_MAIN_END\n}\n";
U$$module$libs$world_onscreen.ShadersStore[Bh$$module$libs$world_onscreen]=Uh$$module$libs$world_onscreen;const kh$$module$libs$world_onscreen="defaultVertexDeclaration",Vh$$module$libs$world_onscreen="uniform mat4 viewProjection;\nuniform mat4 view;\n#ifdef DIFFUSE\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos;\nuniform mat4 lightmapMatrix;\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nuniform vec2 vSpecularInfos;\nuniform mat4 specularMatrix;\n#endif\n#ifdef BUMP\nuniform vec3 vBumpInfos;\nuniform mat4 bumpMatrix;\n#endif\n#ifdef REFLECTION\nuniform mat4 reflectionMatrix;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n#ifdef DETAIL\nuniform vec4 vDetailInfos;\nuniform mat4 detailMatrix;\n#endif\n#define ADDITIONAL_VERTEX_DECLARATION\n";
U$$module$libs$world_onscreen.IncludesShadersStore[kh$$module$libs$world_onscreen]=Vh$$module$libs$world_onscreen;const Wh$$module$libs$world_onscreen="uvAttributeDeclaration",zh$$module$libs$world_onscreen="#ifdef UV{X}\nattribute vec2 uv{X};\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[Wh$$module$libs$world_onscreen]=zh$$module$libs$world_onscreen;const Gh$$module$libs$world_onscreen="prePassVertexDeclaration",Xh$$module$libs$world_onscreen="#ifdef PREPASS\n#ifdef PREPASS_DEPTH\nvarying vec3 vViewPos;\n#endif\n#ifdef PREPASS_VELOCITY\nuniform mat4 previousViewProjection;\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Gh$$module$libs$world_onscreen]=Xh$$module$libs$world_onscreen;const Hh$$module$libs$world_onscreen="samplerVertexDeclaration",Kh$$module$libs$world_onscreen="#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\nvarying vec2 v_VARYINGNAME_UV;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[Hh$$module$libs$world_onscreen]=Kh$$module$libs$world_onscreen;
const Yh$$module$libs$world_onscreen="bumpVertexDeclaration",Zh$$module$libs$world_onscreen="#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL) \nvarying mat3 vTBN;\n#endif\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[Yh$$module$libs$world_onscreen]=Zh$$module$libs$world_onscreen;const qh$$module$libs$world_onscreen="fogVertexDeclaration",jh$$module$libs$world_onscreen="#ifdef FOG\nvarying vec3 vFogDistance;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[qh$$module$libs$world_onscreen]=jh$$module$libs$world_onscreen;const $h$$module$libs$world_onscreen="lightVxFragmentDeclaration",Qh$$module$libs$world_onscreen="#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec4 vLightSpecular{X};\n#else\nvec4 vLightSpecular{X}=vec4(0.);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#elif defined(SHADOWCUBE{X})\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\nuniform mat4 lightMatrix{X};\n#endif\nuniform vec4 shadowsInfo{X};\nuniform vec2 depthValues{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\nuniform vec4 vLightFalloff{X};\n#elif defined(POINTLIGHT{X})\nuniform vec4 vLightFalloff{X};\n#elif defined(HEMILIGHT{X})\nuniform vec3 vLightGround{X};\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[$h$$module$libs$world_onscreen]=Qh$$module$libs$world_onscreen;const Jh$$module$libs$world_onscreen="lightVxUboDeclaration",el$$module$libs$world_onscreen="#ifdef LIGHT{X}\nuniform Light{X}\n{\nvec4 vLightData;\nvec4 vLightDiffuse;\nvec4 vLightSpecular;\n#ifdef SPOTLIGHT{X}\nvec4 vLightDirection;\nvec4 vLightFalloff;\n#elif defined(POINTLIGHT{X})\nvec4 vLightFalloff;\n#elif defined(HEMILIGHT{X})\nvec3 vLightGround;\n#endif\nvec4 shadowsInfo;\nvec2 depthValues;\n} light{X};\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#elif defined(SHADOWCUBE{X})\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\nuniform mat4 lightMatrix{X};\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[Jh$$module$libs$world_onscreen]=el$$module$libs$world_onscreen;const tl$$module$libs$world_onscreen="prePassVertex",il$$module$libs$world_onscreen="#ifdef PREPASS_DEPTH\nvViewPos=(view*worldPos).rgb;\n#endif\n#if defined(PREPASS_VELOCITY) && defined(BONES_VELOCITY_ENABLED)\nvCurrentPosition=viewProjection*worldPos;\n#if NUM_BONE_INFLUENCERS>0\nmat4 previousInfluence;\npreviousInfluence=mPreviousBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\npreviousInfluence+=mPreviousBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif \n#if NUM_BONE_INFLUENCERS>2\npreviousInfluence+=mPreviousBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif \n#if NUM_BONE_INFLUENCERS>3\npreviousInfluence+=mPreviousBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif \n#if NUM_BONE_INFLUENCERS>5\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif \n#if NUM_BONE_INFLUENCERS>6\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif \n#if NUM_BONE_INFLUENCERS>7\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\nvPreviousPosition=previousViewProjection*finalPreviousWorld*previousInfluence*vec4(positionUpdated,1.0);\n#else\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[tl$$module$libs$world_onscreen]=il$$module$libs$world_onscreen;const sl$$module$libs$world_onscreen="uvVariableDeclaration",rl$$module$libs$world_onscreen="#if !defined(UV{X}) && defined(MAINUV{X})\nvec2 uv{X}=vec2(0.,0.);\n#endif\n#ifdef MAINUV{X}\nvMainUV{X}=uv{X};\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[sl$$module$libs$world_onscreen]=rl$$module$libs$world_onscreen;
const nl$$module$libs$world_onscreen="samplerVertexImplementation",al$$module$libs$world_onscreen="#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\nif (v_INFONAME_==0.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uvUpdated,1.0,0.0));\n}\n#ifdef UV2\nelse if (v_INFONAME_==1.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef UV3\nelse if (v_INFONAME_==2.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv3,1.0,0.0));\n}\n#endif\n#ifdef UV4\nelse if (v_INFONAME_==3.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv4,1.0,0.0));\n}\n#endif\n#ifdef UV5\nelse if (v_INFONAME_==4.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv5,1.0,0.0));\n}\n#endif\n#ifdef UV6\nelse if (v_INFONAME_==5.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv6,1.0,0.0));\n}\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[nl$$module$libs$world_onscreen]=al$$module$libs$world_onscreen;const ol$$module$libs$world_onscreen="bumpVertex",hl$$module$libs$world_onscreen="#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL)\nvec3 tbnNormal=normalize(normalUpdated);\nvec3 tbnTangent=normalize(tangentUpdated.xyz);\nvec3 tbnBitangent=cross(tbnNormal,tbnTangent)*tangentUpdated.w;\nvTBN=mat3(finalWorld)*mat3(tbnTangent,tbnBitangent,tbnNormal);\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[ol$$module$libs$world_onscreen]=hl$$module$libs$world_onscreen;const ll$$module$libs$world_onscreen="fogVertex",cl$$module$libs$world_onscreen="#ifdef FOG\nvFogDistance=(view*worldPos).xyz;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[ll$$module$libs$world_onscreen]=cl$$module$libs$world_onscreen;const ul$$module$libs$world_onscreen="shadowsVertex",dl$$module$libs$world_onscreen="#ifdef SHADOWS\n#if defined(SHADOWCSM{X})\nvPositionFromCamera{X}=view*worldPos;\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) {\nvPositionFromLight{X}[i]=lightMatrix{X}[i]*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric{X}[i]=(-vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#else\nvDepthMetric{X}[i]=(vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#endif\n}\n#elif defined(SHADOW{X}) && !defined(SHADOWCUBE{X})\nvPositionFromLight{X}=lightMatrix{X}*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric{X}=(-vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#else\nvDepthMetric{X}=(vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#endif\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[ul$$module$libs$world_onscreen]=dl$$module$libs$world_onscreen;const fl$$module$libs$world_onscreen="vertexColorMixing",_l$$module$libs$world_onscreen="#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nvColor=vec4(1.0);\n#ifdef VERTEXCOLOR\n#ifdef VERTEXALPHA\nvColor*=color;\n#else\nvColor.rgb*=color.rgb;\n#endif\n#endif\n#ifdef INSTANCESCOLOR\nvColor*=instanceColor;\n#endif\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[fl$$module$libs$world_onscreen]=_l$$module$libs$world_onscreen;const gl$$module$libs$world_onscreen="pointCloudVertex",pl$$module$libs$world_onscreen="#if defined(POINTSIZE) && !defined(WEBGPU)\ngl_PointSize=pointSize;\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[gl$$module$libs$world_onscreen]=pl$$module$libs$world_onscreen;const ml$$module$libs$world_onscreen="logDepthVertex",El$$module$libs$world_onscreen="#ifdef LOGARITHMICDEPTH\nvFragmentDepth=1.0+gl_Position.w;\ngl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;\n#endif\n";
U$$module$libs$world_onscreen.IncludesShadersStore[ml$$module$libs$world_onscreen]=El$$module$libs$world_onscreen;const vl$$module$libs$world_onscreen="defaultVertexShader",Tl$$module$libs$world_onscreen="#include<__decl__defaultVertex>\n#define CUSTOM_VERTEX_BEGIN\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef TANGENT\nattribute vec4 tangent;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#include<uvAttributeDeclaration>[2..7]\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<helperFunctions>\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<instancesDeclaration>\n#include<prePassVertexDeclaration>\n#include<mainUVVaryingDeclaration>[1..7]\n#include<samplerVertexDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse)\n#include<samplerVertexDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail)\n#include<samplerVertexDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient)\n#include<samplerVertexDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity)\n#include<samplerVertexDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive)\n#include<samplerVertexDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap)\n#if defined(SPECULARTERM)\n#include<samplerVertexDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular)\n#endif\n#include<samplerVertexDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump)\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nvarying vec4 vColor;\n#endif\n#include<bumpVertexDeclaration>\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightVxFragment>[0..maxSimultaneousLights]\n#include<morphTargetsVertexGlobalDeclaration>\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#endif\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvarying vec3 vDirectionW;\n#endif\n#include<logDepthDeclaration>\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvec3 positionUpdated=position;\n#ifdef NORMAL\nvec3 normalUpdated=normal;\n#endif\n#ifdef TANGENT\nvec4 tangentUpdated=tangent;\n#endif\n#ifdef UV1\nvec2 uvUpdated=uv;\n#endif\n#include<morphTargetsVertexGlobal>\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\n#ifdef REFLECTIONMAP_SKYBOX\nvPositionUVW=positionUpdated;\n#endif\n#define CUSTOM_VERTEX_UPDATE_POSITION\n#define CUSTOM_VERTEX_UPDATE_NORMAL\n#include<instancesVertex>\n#if defined(PREPASS) && defined(PREPASS_VELOCITY) && !defined(BONES_VELOCITY_ENABLED)\nvCurrentPosition=viewProjection*finalWorld*vec4(positionUpdated,1.0);\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\n#endif\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);\n#ifdef NORMAL\nmat3 normalWorld=mat3(finalWorld);\n#if defined(INSTANCES) && defined(THIN_INSTANCES)\nvNormalW=normalUpdated/vec3(dot(normalWorld[0],normalWorld[0]),dot(normalWorld[1],normalWorld[1]),dot(normalWorld[2],normalWorld[2]));\nvNormalW=normalize(normalWorld*vNormalW);\n#else\n#ifdef NONUNIFORMSCALING\nnormalWorld=transposeMat3(inverseMat3(normalWorld));\n#endif\nvNormalW=normalize(normalWorld*normalUpdated);\n#endif\n#endif\n#define CUSTOM_VERTEX_UPDATE_WORLDPOS\n#ifdef MULTIVIEW\nif (gl_ViewID_OVR==0u) {\ngl_Position=viewProjection*worldPos;\n} else {\ngl_Position=viewProjectionR*worldPos;\n}\n#else\ngl_Position=viewProjection*worldPos;\n#endif\nvPositionW=vec3(worldPos);\n#include<prePassVertex>\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvDirectionW=normalize(vec3(finalWorld*vec4(positionUpdated,0.0)));\n#endif\n#ifndef UV1\nvec2 uvUpdated=vec2(0.,0.);\n#endif\n#ifdef MAINUV1\nvMainUV1=uvUpdated;\n#endif\n#include<uvVariableDeclaration>[2..7]\n#include<samplerVertexImplementation>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_MATRIXNAME_,diffuse,_INFONAME_,DiffuseInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_MATRIXNAME_,detail,_INFONAME_,DetailInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_MATRIXNAME_,ambient,_INFONAME_,AmbientInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_MATRIXNAME_,opacity,_INFONAME_,OpacityInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_MATRIXNAME_,emissive,_INFONAME_,EmissiveInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_MATRIXNAME_,lightmap,_INFONAME_,LightmapInfos.x)\n#if defined(SPECULARTERM)\n#include<samplerVertexImplementation>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_MATRIXNAME_,specular,_INFONAME_,SpecularInfos.x)\n#endif\n#include<samplerVertexImplementation>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_MATRIXNAME_,bump,_INFONAME_,BumpInfos.x)\n#include<bumpVertex>\n#include<clipPlaneVertex>\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n#include<vertexColorMixing>\n#include<pointCloudVertex>\n#include<logDepthVertex>\n#define CUSTOM_VERTEX_MAIN_END\n}\n";
U$$module$libs$world_onscreen.ShadersStore[vl$$module$libs$world_onscreen]=Tl$$module$libs$world_onscreen;const bl$$module$libs$world_onscreen=RegExp("^([gimus]+)!");
class qt$$module$libs$world_onscreen{constructor(a){this._plugins=[];this._activePlugins=[];this._activePluginsForExtraEvents=[];this._material=a;this._scene=a.getScene();this._engine=this._scene.getEngine()}_addPlugin(a){for(var b=0;b<this._plugins.length;++b)if(this._plugins[b].name===a.name)throw`Plugin "${a.name}" already added to the material "${this._material.name}"!`;if(this._material._uniformBufferLayoutBuilt)throw`The plugin "${a.name}" can't be added to the material "${this._material.name}" because this material has already been used for rendering! Please add plugins to materials before any rendering with this material occurs.`;
b=a.getClassName();qt$$module$libs$world_onscreen._MaterialPluginClassToMainDefine[b]||(qt$$module$libs$world_onscreen._MaterialPluginClassToMainDefine[b]="MATERIALPLUGIN_"+ ++qt$$module$libs$world_onscreen._MaterialPluginCounter);this._material._callbackPluginEventGeneric=this._handlePluginEvent.bind(this);this._plugins.push(a);this._plugins.sort((c,d)=>c.priority-d.priority);this._codeInjectionPoints={};a={};a[qt$$module$libs$world_onscreen._MaterialPluginClassToMainDefine[b]]={type:"boolean",default:!0};
for(const c of this._plugins)c.collectDefines(a),this._collectPointNames("vertex",c.getCustomCode("vertex")),this._collectPointNames("fragment",c.getCustomCode("fragment"));this._defineNamesFromPlugins=a}_activatePlugin(a){-1===this._activePlugins.indexOf(a)&&(this._activePlugins.push(a),this._activePlugins.sort((b,c)=>b.priority-c.priority),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=
this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),a.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(a),this._activePluginsForExtraEvents.sort((b,c)=>b.priority-c.priority),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),
this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(a){for(let b=0;b<this._plugins.length;++b)if(this._plugins[b].name===a)return this._plugins[b];return null}_handlePluginEventIsReadyForSubMesh(a){let b=!0;for(const c of this._activePlugins)b=b&&c.isReadyForSubMesh(a.defines,this._scene,this._engine,a.subMesh);a.isReadyForSubMesh=
b}_handlePluginEventPrepareDefinesBeforeAttributes(a){for(const b of this._activePlugins)b.prepareDefinesBeforeAttributes(a.defines,this._scene,a.mesh)}_handlePluginEventPrepareDefines(a){for(const b of this._activePlugins)b.prepareDefines(a.defines,this._scene,a.mesh)}_handlePluginEventHardBindForSubMesh(a){for(const b of this._activePluginsForExtraEvents)b.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,a.subMesh)}_handlePluginEventBindForSubMesh(a){for(const b of this._activePlugins)b.bindForSubMesh(this._material._uniformBuffer,
this._scene,this._engine,a.subMesh)}_handlePluginEventHasRenderTargetTextures(a){let b=!1;for(const c of this._activePluginsForExtraEvents)if(b=c.hasRenderTargetTextures(),b)break;a.hasRenderTargetTextures=b}_handlePluginEventFillRenderTargetTextures(a){for(const b of this._activePluginsForExtraEvents)b.fillRenderTargetTextures(a.renderTargets)}_handlePluginEvent(a,b){switch(a){case je$$module$libs$world_onscreen.GetActiveTextures:for(const e of this._activePlugins)e.getActiveTextures(b.activeTextures);
break;case je$$module$libs$world_onscreen.GetAnimatables:for(const e of this._activePlugins)e.getAnimatables(b.animatables);break;case je$$module$libs$world_onscreen.HasTexture:var c=!1;for(var d of this._activePlugins)if(c=d.hasTexture(b.texture),c)break;b.hasTexture=c;break;case je$$module$libs$world_onscreen.Disposed:for(const e of this._plugins)e.dispose(b.forceDisposeTextures);break;case je$$module$libs$world_onscreen.GetDefineNames:b.defineNames=this._defineNamesFromPlugins;break;case je$$module$libs$world_onscreen.PrepareEffect:for(const e of this._activePlugins)b.fallbackRank=
e.addFallbacks(b.defines,b.fallbacks,b.fallbackRank),e.getAttributes(b.attributes,this._scene,b.mesh);0<this._uniformList.length&&b.uniforms.push(...this._uniformList);0<this._samplerList.length&&b.samplers.push(...this._samplerList);0<this._uboList.length&&b.uniformBuffersNames.push(...this._uboList);b.customCode=this._injectCustomCode(b.customCode);break;case je$$module$libs$world_onscreen.PrepareUniformBuffer:this._fragmentDeclaration=this._vertexDeclaration=this._uboDeclaration="";this._uniformList=
[];this._samplerList=[];this._uboList=[];for(c of this._plugins){if(d=c.getUniforms()){if(d.ubo)for(const e of d.ubo)b.ubo.addUniform(e.name,e.size),this._uboDeclaration+=`${e.type} ${e.name};\r
`,this._uniformList.push(e.name);d.vertex&&(this._vertexDeclaration+=d.vertex+"\r\n");d.fragment&&(this._fragmentDeclaration+=d.fragment+"\r\n")}c.getSamplers(this._samplerList);c.getUniformBuffersNames(this._uboList)}}}_collectPointNames(a,b){if(b)for(const c in b)this._codeInjectionPoints[a]||(this._codeInjectionPoints[a]={}),this._codeInjectionPoints[a][c]=!0}_injectCustomCode(a){return(b,c)=>{var d;a&&(c=a(b,c));this._uboDeclaration&&(c=c.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration));
this._vertexDeclaration&&(c=c.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration));this._fragmentDeclaration&&(c=c.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));var e=null===(d=this._codeInjectionPoints)||void 0===d?void 0:d[b];if(!e)return c;for(let n in e){d="";for(const t of this._activePlugins)e=t.getCustomCode(b),null!=e&&e[n]&&(d+=e[n]+"\r\n");if(0<d.length)if("!"===n.charAt(0)){n=n.substring(1);var g="g";"!"===n.charAt(0)?(g="",n=n.substring(1)):
(e=bl$$module$libs$world_onscreen.exec(n))&&2<=e.length&&(g=e[1],n=n.substring(g.length+1));0>g.indexOf("g")&&(g+="g");e=c;g=new RegExp(n,g);let t=g.exec(e);for(;null!==t;){let w=d;for(let z=0;z<t.length;++z)w=w.replace("$"+z,t[z]);c=c.replace(t[0],w);t=g.exec(e)}}else e="#define "+n,c=c.replace(e,"\r\n"+d+"\r\n"+e)}return c}}}qt$$module$libs$world_onscreen._MaterialPluginClassToMainDefine={};qt$$module$libs$world_onscreen._MaterialPluginCounter=0;
class fs$$module$libs$world_onscreen{constructor(a,b,c,d,e=!0,g=!1){this.priority=500;this.registerForExtraEvents=!1;this._material=a;this.name=b;this.priority=c;a.pluginManager||(a.pluginManager=new qt$$module$libs$world_onscreen(a));this._pluginDefineNames=d;this._pluginManager=a.pluginManager;e&&this._pluginManager._addPlugin(this);g&&this._enable(!0);this.markAllDefinesAsDirty=a._dirtyCallbacks[63]}_enable(a){a&&this._pluginManager._activatePlugin(this)}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(a,
b,c,d){return!0}hardBindForSubMesh(a,b,c,d){}bindForSubMesh(a,b,c,d){}dispose(a){}getCustomCode(a){return null}collectDefines(a){if(this._pluginDefineNames)for(const b of Object.keys(this._pluginDefineNames)){if("_"===b[0])continue;const c=typeof this._pluginDefineNames[b];a[b]={type:"number"===c?"number":"string"===c?"string":"boolean"===c?"boolean":"object",default:this._pluginDefineNames[b]}}}prepareDefinesBeforeAttributes(a,b,c){}prepareDefines(a,b,c){}hasTexture(a){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(a){}getActiveTextures(a){}getAnimatables(a){}addFallbacks(a,
b,c){return c}getSamplers(a){}getAttributes(a,b,c){}getUniformBuffersNames(a){}getUniforms(){return{}}copyTo(a){ae$$module$libs$world_onscreen.Clone(()=>a,this)}serialize(){return ae$$module$libs$world_onscreen.Serialize(this)}parse(a,b,c){ae$$module$libs$world_onscreen.Parse(()=>this,a,b,c)}}T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],fs$$module$libs$world_onscreen.prototype,"name",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],fs$$module$libs$world_onscreen.prototype,"priority",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],fs$$module$libs$world_onscreen.prototype,"registerForExtraEvents",void 0);class Sl$$module$libs$world_onscreen extends Hs$$module$libs$world_onscreen{constructor(){super(...arguments);this.DETAIL=!1;this.DETAIL_NORMALBLENDMETHOD=this.DETAILDIRECTUV=0}}
class fi$$module$libs$world_onscreen extends fs$$module$libs$world_onscreen{constructor(a,b=!0){super(a,"DetailMap",140,new Sl$$module$libs$world_onscreen,b);this._texture=null;this.bumpLevel=this.roughnessBlendLevel=this.diffuseBlendLevel=1;this._normalBlendMethod=P$$module$libs$world_onscreen.MATERIAL_NORMALBLENDMETHOD_WHITEOUT;this.isEnabled=this._isEnabled=!1;this._internalMarkAllSubMeshesAsTexturesDirty=a._dirtyCallbacks[1]}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled);this._internalMarkAllSubMeshesAsTexturesDirty()}isReadyForSubMesh(a,
b,c){return this._isEnabled?!(a._areTexturesDirty&&b.texturesEnabled&&c.getCaps().standardDerivatives&&this._texture&&de$$module$libs$world_onscreen.DetailTextureEnabled&&!this._texture.isReady()):!0}prepareDefines(a,b){this._isEnabled?(a.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod,b=b.getEngine(),a._areTexturesDirty&&(b.getCaps().standardDerivatives&&this._texture&&de$$module$libs$world_onscreen.DetailTextureEnabled&&this._isEnabled?(te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._texture,
a,"DETAIL"),a.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):a.DETAIL=!1)):a.DETAIL=!1}bindForSubMesh(a,b){if(this._isEnabled){var c=this._material.isFrozen;a.useUbo&&c&&a.isSync||!this._texture||!de$$module$libs$world_onscreen.DetailTextureEnabled||(a.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),te$$module$libs$world_onscreen.BindTextureMatrix(this._texture,a,"detail"));b.texturesEnabled&&this._texture&&de$$module$libs$world_onscreen.DetailTextureEnabled&&
a.setTexture("detailSampler",this._texture)}}hasTexture(a){return this._texture===a}getActiveTextures(a){this._texture&&a.push(this._texture)}getAnimatables(a){this._texture&&this._texture.animations&&0<this._texture.animations.length&&a.push(this._texture)}dispose(a){var b;a&&(null===(b=this._texture)||void 0===b||b.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(a){a.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",
size:16,type:"mat4"}]}}}T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("detailTexture"),be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],fi$$module$libs$world_onscreen.prototype,"texture",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],fi$$module$libs$world_onscreen.prototype,"diffuseBlendLevel",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],fi$$module$libs$world_onscreen.prototype,"roughnessBlendLevel",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],fi$$module$libs$world_onscreen.prototype,"bumpLevel",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen(),be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],fi$$module$libs$world_onscreen.prototype,"normalBlendMethod",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen(),be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],fi$$module$libs$world_onscreen.prototype,"isEnabled",void 0);const Ds$$module$libs$world_onscreen={effect:null,subMesh:null};
class xl$$module$libs$world_onscreen extends Hs$$module$libs$world_onscreen{constructor(a){super(a);this.DIFFUSE=this.MAINUV6=this.MAINUV5=this.MAINUV4=this.MAINUV3=this.MAINUV2=this.MAINUV1=!1;this.DIFFUSEDIRECTUV=0;this.AMBIENT=this.BAKED_VERTEX_ANIMATION_TEXTURE=!1;this.AMBIENTDIRECTUV=0;this.OPACITY=!1;this.OPACITYDIRECTUV=0;this.EMISSIVE=this.REFLECTION=this.OPACITYRGB=!1;this.EMISSIVEDIRECTUV=0;this.SPECULAR=!1;this.SPECULARDIRECTUV=0;this.BUMP=!1;this.BUMPDIRECTUV=0;this.VERTEXALPHA=this.VERTEXCOLOR=
this.UV6=this.UV5=this.UV4=this.UV3=this.UV2=this.UV1=this.TANGENT=this.NORMAL=this.FRESNEL=this.EMISSIVEFRESNEL=this.REFRACTIONFRESNEL=this.REFLECTIONFRESNEL=this.OPACITYFRESNEL=this.DIFFUSEFRESNEL=this.SPECULARTERM=this.FOG=this.POINTSIZE=this.ALPHAFROMDIFFUSE=this.DEPTHPREPASS=this.ALPHATEST=this.CLIPPLANE6=this.CLIPPLANE5=this.CLIPPLANE4=this.CLIPPLANE3=this.CLIPPLANE2=this.CLIPPLANE=this.SPECULAROVERALPHA=this.PARALLAXOCCLUSION=this.PARALLAX=!1;this.BonesPerMesh=this.NUM_BONE_INFLUENCERS=0;this.LIGHTMAP=
this.REFLECTIONFRESNELFROMSPECULAR=this.LINKEMISSIVEWITHDIFFUSE=this.EMISSIVEASILLUMINATION=this.ROUGHNESS=this.GLOSSINESS=this.INSTANCESCOLOR=this.THIN_INSTANCES=this.INSTANCES=this.BONES_VELOCITY_ENABLED=this.BONETEXTURE=!1;this.LIGHTMAPDIRECTUV=0;this.MORPHTARGETS_UV=this.MORPHTARGETS_TANGENT=this.MORPHTARGETS_NORMAL=this.MORPHTARGETS=this.SHADOWFLOAT=this.TWOSIDEDLIGHTING=this.REFLECTIONOVERALPHA=this.REFRACTIONMAP_3D=this.REFRACTION=this.LOGARITHMICDEPTH=this.INVERTCUBICMAP=this.REFLECTIONMAP_OPPOSITEZ=
this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=this.REFLECTIONMAP_EQUIRECTANGULAR=this.REFLECTIONMAP_EXPLICIT=this.REFLECTIONMAP_SKYBOX=this.REFLECTIONMAP_PROJECTION=this.USE_LOCAL_REFRACTIONMAP_CUBIC=this.USE_LOCAL_REFLECTIONMAP_CUBIC=this.REFLECTIONMAP_CUBIC=this.REFLECTIONMAP_PLANAR=this.REFLECTIONMAP_SPHERICAL=this.REFLECTIONMAP_3D=this.USELIGHTMAPASSHADOWMAP=this.OBJECTSPACE_NORMALMAP=!1;this.NUM_MORPH_INFLUENCERS=0;this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=
this.PREMULTIPLYALPHA=this.NONUNIFORMSCALING=this.MORPHTARGETS_TEXTURE=!1;this.ALPHABLEND=!0;this.PREPASS_IRRADIANCE=this.PREPASS=!1;this.PREPASS_IRRADIANCE_INDEX=-1;this.PREPASS_ALBEDO_SQRT=!1;this.PREPASS_ALBEDO_SQRT_INDEX=-1;this.PREPASS_DEPTH=!1;this.PREPASS_DEPTH_INDEX=-1;this.PREPASS_NORMAL=!1;this.PREPASS_NORMAL_INDEX=-1;this.PREPASS_POSITION=!1;this.PREPASS_POSITION_INDEX=-1;this.PREPASS_VELOCITY=!1;this.PREPASS_VELOCITY_INDEX=-1;this.PREPASS_REFLECTIVITY=!1;this.PREPASS_REFLECTIVITY_INDEX=
-1;this.SCENE_MRT_COUNT=0;this.EXPOSURE=this.IS_REFRACTION_LINEAR=this.IS_REFLECTION_LINEAR=this.CAMERA_PERSPECTIVE=this.CAMERA_ORTHOGRAPHIC=this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=this.ORDER_INDEPENDENT_TRANSPARENCY=this.MULTIVIEW=this.SKIPFINALCOLORCLAMP=this.IMAGEPROCESSINGPOSTPROCESS=this.DITHER=this.SAMPLER3DBGRMAP=this.SAMPLER3DGREENDEPTH=this.COLORGRADING3D=this.COLORGRADING=this.COLORCURVES=this.CONTRAST=this.TONEMAPPING_ACES=this.TONEMAPPING=this.VIGNETTEBLENDMODEOPAQUE=this.VIGNETTEBLENDMODEMULTIPLY=
this.VIGNETTE=this.IMAGEPROCESSING=this.RGBDREFRACTION=this.RGBDREFLECTION=this.RGBDLIGHTMAP=!1;this.rebuild()}setReflectionMode(a){const b="REFLECTIONMAP_CUBIC REFLECTIONMAP_EXPLICIT REFLECTIONMAP_PLANAR REFLECTIONMAP_PROJECTION REFLECTIONMAP_PROJECTION REFLECTIONMAP_SKYBOX REFLECTIONMAP_SPHERICAL REFLECTIONMAP_EQUIRECTANGULAR REFLECTIONMAP_EQUIRECTANGULAR_FIXED REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED".split(" ");for(const c of b)this[c]=c===a}}
class N$$module$libs$world_onscreen extends Wr$$module$libs$world_onscreen{constructor(a,b){super(a,b);this._refractionTexture=this._lightmapTexture=this._bumpTexture=this._specularTexture=this._emissiveTexture=this._reflectionTexture=this._opacityTexture=this._ambientTexture=this._diffuseTexture=null;this.ambientColor=new se$$module$libs$world_onscreen(0,0,0);this.diffuseColor=new se$$module$libs$world_onscreen(1,1,1);this.specularColor=new se$$module$libs$world_onscreen(1,1,1);this.emissiveColor=
new se$$module$libs$world_onscreen(0,0,0);this.specularPower=64;this._useParallaxOcclusion=this._useParallax=this._useObjectSpaceNormalMap=this._disableLighting=this._useReflectionOverAlpha=this._useSpecularOverAlpha=this._linkEmissiveWithDiffuse=this._useEmissiveAsIllumination=this._useAlphaFromDiffuseTexture=!1;this.parallaxScaleBias=.05;this._roughness=0;this.indexOfRefraction=.98;this.invertRefractionY=!0;this.alphaCutOff=.4;this._useGlossinessFromSpecularMapAlpha=this._useReflectionFresnelFromSpecular=
this._useLightmapAsShadowmap=!1;this._maxSimultaneousLights=4;this._twoSidedLighting=this._invertNormalMapY=this._invertNormalMapX=!1;this._renderTargets=new $e$$module$libs$world_onscreen(16);this._worldViewProjectionMatrix=x$$module$libs$world_onscreen.Zero();this._globalAmbientColor=new se$$module$libs$world_onscreen(0,0,0);this._cacheHasRenderTargetTextures=!1;this.detailMap=new fi$$module$libs$world_onscreen(this);this._attachImageProcessingConfiguration(null);this.prePassConfiguration=new vr$$module$libs$world_onscreen;
this.getRenderTargetTextures=()=>(this._renderTargets.reset(),N$$module$libs$world_onscreen.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),N$$module$libs$world_onscreen.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),
this._renderTargets)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(a){this._attachImageProcessingConfiguration(a);this._markAllSubMeshesAsTexturesDirty()}_attachImageProcessingConfiguration(a){a!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),a?this._imageProcessingConfiguration=a:this._imageProcessingConfiguration=
this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(()=>{this._markAllSubMeshesAsImageProcessingDirty()})))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(a){this.imageProcessingConfiguration.colorCurvesEnabled=a}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(a){this.imageProcessingConfiguration.colorGradingEnabled=
a}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(a){this._imageProcessingConfiguration.toneMappingEnabled=a}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(a){this._imageProcessingConfiguration.exposure=a}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(a){this._imageProcessingConfiguration.contrast=a}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(a){this._imageProcessingConfiguration.colorGradingTexture=
a}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(a){this._imageProcessingConfiguration.colorCurves=a}get canRenderToMRT(){return!0}get hasRenderTargetTextures(){return N$$module$libs$world_onscreen.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget||N$$module$libs$world_onscreen.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget?!0:this._cacheHasRenderTargetTextures}getClassName(){return"StandardMaterial"}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(a){this._useLogarithmicDepth=
a&&this.getScene().getEngine().getCaps().fragmentDepthSupported;this._markAllSubMeshesAsMiscDirty()}needAlphaBlending(){return this._disableAlphaBlending?!1:1>this.alpha||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled}needAlphaTesting(){return this._forceAlphaTest?!0:this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===P$$module$libs$world_onscreen.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return null!=
this._diffuseTexture&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==P$$module$libs$world_onscreen.MATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha||null!=this._opacityTexture}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(a,b,c=!1){if(this._uniformBufferLayoutBuilt||this.buildUniformLayout(),b.effect&&this.isFrozen&&b.effect._wasPreviouslyReady&&b.effect._wasPreviouslyUsingInstances===
c)return!0;b.materialDefines||(this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.GetDefineNames,this._eventInfo),b.materialDefines=new xl$$module$libs$world_onscreen(this._eventInfo.defineNames));const d=this.getScene(),e=b.materialDefines;if(this._isReadyForSubMesh(b))return!0;var g=d.getEngine();e._needNormals=te$$module$libs$world_onscreen.PrepareDefinesForLights(d,a,e,!0,this._maxSimultaneousLights,this._disableLighting);te$$module$libs$world_onscreen.PrepareDefinesForMultiview(d,
e);var n=this.needAlphaBlendingForMesh(a)&&this.getScene().useOrderIndependentTransparency;if(te$$module$libs$world_onscreen.PrepareDefinesForPrePass(d,e,this.canRenderToMRT&&!n),te$$module$libs$world_onscreen.PrepareDefinesForOIT(d,e,n),e._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1;this._callbackPluginEventHasRenderTargetTextures(this._eventInfo);this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures;e._needUVs=!1;for(n=1;6>=n;++n)e["MAINUV"+n]=!1;if(d.texturesEnabled){if(e.DIFFUSEDIRECTUV=
0,e.BUMPDIRECTUV=0,e.AMBIENTDIRECTUV=0,e.OPACITYDIRECTUV=0,e.EMISSIVEDIRECTUV=0,e.SPECULARDIRECTUV=0,e.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&N$$module$libs$world_onscreen.DiffuseTextureEnabled)if(this._diffuseTexture.isReadyOrNotBlocking())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._diffuseTexture,e,"DIFFUSE");else return!1;else e.DIFFUSE=!1;if(this._ambientTexture&&N$$module$libs$world_onscreen.AmbientTextureEnabled)if(this._ambientTexture.isReadyOrNotBlocking())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._ambientTexture,
e,"AMBIENT");else return!1;else e.AMBIENT=!1;if(this._opacityTexture&&N$$module$libs$world_onscreen.OpacityTextureEnabled)if(this._opacityTexture.isReadyOrNotBlocking())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._opacityTexture,e,"OPACITY"),e.OPACITYRGB=this._opacityTexture.getAlphaFromRGB;else return!1;else e.OPACITY=!1;if(this._reflectionTexture&&N$$module$libs$world_onscreen.ReflectionTextureEnabled)if(this._reflectionTexture.isReadyOrNotBlocking()){switch(e._needNormals=!0,
e.REFLECTION=!0,e.ROUGHNESS=0<this._roughness,e.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,e.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===B$$module$libs$world_onscreen.INVCUBIC_MODE,e.REFLECTIONMAP_3D=this._reflectionTexture.isCube,e.REFLECTIONMAP_OPPOSITEZ=e.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,e.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case B$$module$libs$world_onscreen.EXPLICIT_MODE:e.setReflectionMode("REFLECTIONMAP_EXPLICIT");
break;case B$$module$libs$world_onscreen.PLANAR_MODE:e.setReflectionMode("REFLECTIONMAP_PLANAR");break;case B$$module$libs$world_onscreen.PROJECTION_MODE:e.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case B$$module$libs$world_onscreen.SKYBOX_MODE:e.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case B$$module$libs$world_onscreen.SPHERICAL_MODE:e.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case B$$module$libs$world_onscreen.EQUIRECTANGULAR_MODE:e.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");
break;case B$$module$libs$world_onscreen.FIXED_EQUIRECTANGULAR_MODE:e.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case B$$module$libs$world_onscreen.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:e.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;default:e.setReflectionMode("REFLECTIONMAP_CUBIC")}e.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else return!1;else e.REFLECTION=!1,e.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&N$$module$libs$world_onscreen.EmissiveTextureEnabled)if(this._emissiveTexture.isReadyOrNotBlocking())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._emissiveTexture,
e,"EMISSIVE");else return!1;else e.EMISSIVE=!1;if(this._lightmapTexture&&N$$module$libs$world_onscreen.LightmapTextureEnabled)if(this._lightmapTexture.isReadyOrNotBlocking())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._lightmapTexture,e,"LIGHTMAP"),e.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,e.RGBDLIGHTMAP=this._lightmapTexture.isRGBD;else return!1;else e.LIGHTMAP=!1;if(this._specularTexture&&N$$module$libs$world_onscreen.SpecularTextureEnabled)if(this._specularTexture.isReadyOrNotBlocking())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._specularTexture,
e,"SPECULAR"),e.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha;else return!1;else e.SPECULAR=!1;if(d.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&N$$module$libs$world_onscreen.BumpTextureEnabled){if(this._bumpTexture.isReady())te$$module$libs$world_onscreen.PrepareDefinesForMergedUV(this._bumpTexture,e,"BUMP"),e.PARALLAX=this._useParallax,e.PARALLAXOCCLUSION=this._useParallaxOcclusion;else return!1;e.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else e.BUMP=!1,e.PARALLAX=
!1,e.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&N$$module$libs$world_onscreen.RefractionTextureEnabled)if(this._refractionTexture.isReadyOrNotBlocking())e._needUVs=!0,e.REFRACTION=!0,e.REFRACTIONMAP_3D=this._refractionTexture.isCube,e.RGBDREFRACTION=this._refractionTexture.isRGBD,e.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize;else return!1;else e.REFRACTION=!1;e.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else e.DIFFUSE=!1,e.AMBIENT=!1,e.OPACITY=
!1,e.REFLECTION=!1,e.EMISSIVE=!1,e.LIGHTMAP=!1,e.BUMP=!1,e.REFRACTION=!1;e.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture();e.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination;e.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse;e.SPECULAROVERALPHA=this._useSpecularOverAlpha;e.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode;e.ALPHATEST_AFTERALLALPHACOMPUTATIONS=null!==this.transparencyMode;e.ALPHABLEND=null===this.transparencyMode||this.needAlphaBlendingForMesh(a)}if(this._eventInfo.isReadyForSubMesh=
!0,this._eventInfo.defines=e,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(e._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(e);e.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace;e.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}e._areFresnelDirty&&
(N$$module$libs$world_onscreen.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(e.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,e.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,e.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,e.REFLECTIONFRESNELFROMSPECULAR=
this._useReflectionFresnelFromSpecular,e.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,e.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,e._needNormals=!0,e.FRESNEL=!0):e.FRESNEL=!1);te$$module$libs$world_onscreen.PrepareDefinesForMisc(a,d,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(a)||this._forceAlphaTest,e);te$$module$libs$world_onscreen.PrepareDefinesForFrameBoundValues(d,
g,this,e,c,null,b.getRenderingMesh().hasThinInstances);this._eventInfo.defines=e;this._eventInfo.mesh=a;this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo);te$$module$libs$world_onscreen.PrepareDefinesForAttributes(a,e,!0,!0,!0);this._callbackPluginEventPrepareDefines(this._eventInfo);n=!1;if(e.isDirty){const w=e._areLightsDisposed;e.markAsProcessed();const z=new qs$$module$libs$world_onscreen;e.REFLECTION&&z.addFallback(0,"REFLECTION");e.SPECULAR&&z.addFallback(0,"SPECULAR");
e.BUMP&&z.addFallback(0,"BUMP");e.PARALLAX&&z.addFallback(1,"PARALLAX");e.PARALLAXOCCLUSION&&z.addFallback(0,"PARALLAXOCCLUSION");e.SPECULAROVERALPHA&&z.addFallback(0,"SPECULAROVERALPHA");e.FOG&&z.addFallback(1,"FOG");e.POINTSIZE&&z.addFallback(0,"POINTSIZE");e.LOGARITHMICDEPTH&&z.addFallback(0,"LOGARITHMICDEPTH");te$$module$libs$world_onscreen.HandleFallbacksForShadows(e,z,this._maxSimultaneousLights);e.SPECULARTERM&&z.addFallback(0,"SPECULARTERM");e.DIFFUSEFRESNEL&&z.addFallback(1,"DIFFUSEFRESNEL");
e.OPACITYFRESNEL&&z.addFallback(2,"OPACITYFRESNEL");e.REFLECTIONFRESNEL&&z.addFallback(3,"REFLECTIONFRESNEL");e.EMISSIVEFRESNEL&&z.addFallback(4,"EMISSIVEFRESNEL");e.FRESNEL&&z.addFallback(4,"FRESNEL");e.MULTIVIEW&&z.addFallback(0,"MULTIVIEW");const C=[g$$module$libs$world_onscreen.PositionKind];e.NORMAL&&C.push(g$$module$libs$world_onscreen.NormalKind);e.TANGENT&&C.push(g$$module$libs$world_onscreen.TangentKind);for(var t=1;6>=t;++t)e["UV"+t]&&C.push(`uv${1===t?"":t}`);e.VERTEXCOLOR&&C.push(g$$module$libs$world_onscreen.ColorKind);
te$$module$libs$world_onscreen.PrepareAttributesForBones(C,a,e,z);te$$module$libs$world_onscreen.PrepareAttributesForInstances(C,e);te$$module$libs$world_onscreen.PrepareAttributesForMorphTargets(C,a,e);te$$module$libs$world_onscreen.PrepareAttributesForBakedVertexAnimation(C,a,e);t="default";const H="world view viewProjection vEyePosition vLightsType vAmbientColor vDiffuseColor vSpecularColor vEmissiveColor visibility vFogInfos vFogColor pointSize vDiffuseInfos vAmbientInfos vOpacityInfos vReflectionInfos vEmissiveInfos vSpecularInfos vBumpInfos vLightmapInfos vRefractionInfos mBones diffuseMatrix ambientMatrix opacityMatrix reflectionMatrix emissiveMatrix specularMatrix bumpMatrix normalMatrix lightmapMatrix refractionMatrix diffuseLeftColor diffuseRightColor opacityParts reflectionLeftColor reflectionRightColor emissiveLeftColor emissiveRightColor refractionLeftColor refractionRightColor vReflectionPosition vReflectionSize vRefractionPosition vRefractionSize logarithmicDepthConstant vTangentSpaceParams alphaCutOff boneTextureWidth morphTargetTextureInfo morphTargetTextureIndices".split(" "),
M="diffuseSampler ambientSampler opacitySampler reflectionCubeSampler reflection2DSampler emissiveSampler specularSampler bumpSampler lightmapSampler refractionCubeSampler refraction2DSampler boneSampler morphTargets oitDepthSampler oitFrontColorSampler".split(" "),L=["Material","Scene","Mesh"];this._eventInfo.fallbacks=z;this._eventInfo.fallbackRank=0;this._eventInfo.defines=e;this._eventInfo.uniforms=H;this._eventInfo.attributes=C;this._eventInfo.samplers=M;this._eventInfo.uniformBuffersNames=L;
this._eventInfo.customCode=void 0;this._eventInfo.mesh=a;this._callbackPluginEventGeneric(je$$module$libs$world_onscreen.PrepareEffect,this._eventInfo);vr$$module$libs$world_onscreen.AddUniforms(H);pe$$module$libs$world_onscreen&&(pe$$module$libs$world_onscreen.PrepareUniforms(H,e),pe$$module$libs$world_onscreen.PrepareSamplers(M,e));te$$module$libs$world_onscreen.PrepareUniformsAndSamplersList({uniformsNames:H,uniformBuffersNames:L,samplers:M,defines:e,maxSimultaneousLights:this._maxSimultaneousLights});
ls$$module$libs$world_onscreen(H);const O={};this.customShaderNameResolve&&(t=this.customShaderNameResolve(t,H,L,M,e,C,O));const S=e.toString();a=b.effect;g=d.getEngine().createEffect(t,{attributes:C,uniformsNames:H,uniformBuffersNames:L,samplers:M,defines:S,fallbacks:z,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:e.NUM_MORPH_INFLUENCERS},processFinalCode:O.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,
multiTarget:e.PREPASS},g);if(this._eventInfo.customCode=void 0,g)if(this._onEffectCreatedObservable&&(Ds$$module$libs$world_onscreen.effect=g,Ds$$module$libs$world_onscreen.subMesh=b,this._onEffectCreatedObservable.notifyObservers(Ds$$module$libs$world_onscreen)),this.allowShaderHotSwapping&&a&&!g.isReady()){if(e.markAsUnprocessed(),n=this.isFrozen,w)return e._areLightsDisposed=!0,!1}else d.resetCachedMaterial(),b.setEffect(g,e,this._materialContext)}return b.effect&&b.effect.isReady()?(e._renderId=
d.getRenderId(),b.effect._wasPreviouslyReady=!n,b.effect._wasPreviouslyUsingInstances=c,d.performancePriority!==Ct$$module$libs$world_onscreen.BackwardCompatible&&(this.checkReadyOnlyOnce=!0),!0):!1}buildUniformLayout(){const a=this._uniformBuffer;a.addUniform("diffuseLeftColor",4);a.addUniform("diffuseRightColor",4);a.addUniform("opacityParts",4);a.addUniform("reflectionLeftColor",4);a.addUniform("reflectionRightColor",4);a.addUniform("refractionLeftColor",4);a.addUniform("refractionRightColor",
4);a.addUniform("emissiveLeftColor",4);a.addUniform("emissiveRightColor",4);a.addUniform("vDiffuseInfos",2);a.addUniform("vAmbientInfos",2);a.addUniform("vOpacityInfos",2);a.addUniform("vReflectionInfos",2);a.addUniform("vReflectionPosition",3);a.addUniform("vReflectionSize",3);a.addUniform("vEmissiveInfos",2);a.addUniform("vLightmapInfos",2);a.addUniform("vSpecularInfos",2);a.addUniform("vBumpInfos",3);a.addUniform("diffuseMatrix",16);a.addUniform("ambientMatrix",16);a.addUniform("opacityMatrix",
16);a.addUniform("reflectionMatrix",16);a.addUniform("emissiveMatrix",16);a.addUniform("lightmapMatrix",16);a.addUniform("specularMatrix",16);a.addUniform("bumpMatrix",16);a.addUniform("vTangentSpaceParams",2);a.addUniform("pointSize",1);a.addUniform("alphaCutOff",1);a.addUniform("refractionMatrix",16);a.addUniform("vRefractionInfos",4);a.addUniform("vRefractionPosition",3);a.addUniform("vRefractionSize",3);a.addUniform("vSpecularColor",4);a.addUniform("vEmissiveColor",3);a.addUniform("vDiffuseColor",
4);a.addUniform("vAmbientColor",3);super.buildUniformLayout()}bindForSubMesh(a,b,c){var d;const e=this.getScene(),g=c.materialDefines;if(g){var n=c.effect;if(n){this._activeEffect=n;b.getMeshUniformBuffer().bindToEffect(n,"Mesh");b.transferToEffect(a);this._uniformBuffer.bindToEffect(n,"Material");this.prePassConfiguration.bindForSubMesh(this._activeEffect,e,b,a,this.isFrozen);this._eventInfo.subMesh=c;this._callbackPluginEventHardBindForSubMesh(this._eventInfo);g.OBJECTSPACE_NORMALMAP&&(a.toNormalMatrix(this._normalMatrix),
this.bindOnlyNormalMatrix(this._normalMatrix));a=n._forceRebindOnNextCall||this._mustRebind(e,n,b.visibility);te$$module$libs$world_onscreen.BindBonesParameters(b,n);var t=this._uniformBuffer;if(a){if(this.bindViewProjection(n),!t.useUbo||!this.isFrozen||!t.isSync||n._forceRebindOnNextCall){if(N$$module$libs$world_onscreen.FresnelEnabled&&g.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(t.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),
t.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&t.updateColor4("opacityParts",new se$$module$libs$world_onscreen(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&
(t.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),t.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(t.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),t.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,
this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(t.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),t.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),e.texturesEnabled){if(this._diffuseTexture&&N$$module$libs$world_onscreen.DiffuseTextureEnabled&&(t.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,
this._diffuseTexture.level),te$$module$libs$world_onscreen.BindTextureMatrix(this._diffuseTexture,t,"diffuse")),this._ambientTexture&&N$$module$libs$world_onscreen.AmbientTextureEnabled&&(t.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),te$$module$libs$world_onscreen.BindTextureMatrix(this._ambientTexture,t,"ambient")),this._opacityTexture&&N$$module$libs$world_onscreen.OpacityTextureEnabled&&(t.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,
this._opacityTexture.level),te$$module$libs$world_onscreen.BindTextureMatrix(this._opacityTexture,t,"opacity")),this._hasAlphaChannel()&&t.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&N$$module$libs$world_onscreen.ReflectionTextureEnabled&&(t.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),t.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){var w=this._reflectionTexture;
t.updateVector3("vReflectionPosition",w.boundingBoxPosition);t.updateVector3("vReflectionSize",w.boundingBoxSize)}if(this._emissiveTexture&&N$$module$libs$world_onscreen.EmissiveTextureEnabled&&(t.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),te$$module$libs$world_onscreen.BindTextureMatrix(this._emissiveTexture,t,"emissive")),this._lightmapTexture&&N$$module$libs$world_onscreen.LightmapTextureEnabled&&(t.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,
this._lightmapTexture.level),te$$module$libs$world_onscreen.BindTextureMatrix(this._lightmapTexture,t,"lightmap")),this._specularTexture&&N$$module$libs$world_onscreen.SpecularTextureEnabled&&(t.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),te$$module$libs$world_onscreen.BindTextureMatrix(this._specularTexture,t,"specular")),this._bumpTexture&&e.getEngine().getCaps().standardDerivatives&&N$$module$libs$world_onscreen.BumpTextureEnabled&&(t.updateFloat3("vBumpInfos",
this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),te$$module$libs$world_onscreen.BindTextureMatrix(this._bumpTexture,t,"bump"),e._mirroredCameraPosition?t.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):t.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&N$$module$libs$world_onscreen.RefractionTextureEnabled)if(w=1,this._refractionTexture.isCube||(t.updateMatrix("refractionMatrix",
this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(w=this._refractionTexture.depth)),t.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,w,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize)w=this._refractionTexture,t.updateVector3("vRefractionPosition",w.boundingBoxPosition),t.updateVector3("vRefractionSize",w.boundingBoxSize)}this.pointsCloud&&t.updateFloat("pointSize",this.pointSize);g.SPECULARTERM&&t.updateColor4("vSpecularColor",
this.specularColor,this.specularPower);t.updateColor3("vEmissiveColor",N$$module$libs$world_onscreen.EmissiveTextureEnabled?this.emissiveColor:se$$module$libs$world_onscreen.BlackReadOnly);t.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha);e.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor);t.updateColor3("vAmbientColor",this._globalAmbientColor)}e.texturesEnabled&&(this._diffuseTexture&&N$$module$libs$world_onscreen.DiffuseTextureEnabled&&n.setTexture("diffuseSampler",
this._diffuseTexture),this._ambientTexture&&N$$module$libs$world_onscreen.AmbientTextureEnabled&&n.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&N$$module$libs$world_onscreen.OpacityTextureEnabled&&n.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&N$$module$libs$world_onscreen.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?n.setTexture("reflectionCubeSampler",this._reflectionTexture):n.setTexture("reflection2DSampler",this._reflectionTexture)),
this._emissiveTexture&&N$$module$libs$world_onscreen.EmissiveTextureEnabled&&n.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&N$$module$libs$world_onscreen.LightmapTextureEnabled&&n.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&N$$module$libs$world_onscreen.SpecularTextureEnabled&&n.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&e.getEngine().getCaps().standardDerivatives&&N$$module$libs$world_onscreen.BumpTextureEnabled&&
n.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&N$$module$libs$world_onscreen.RefractionTextureEnabled&&(this._refractionTexture.isCube?n.setTexture("refractionCubeSampler",this._refractionTexture):n.setTexture("refraction2DSampler",this._refractionTexture)));this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(b)&&this.getScene().depthPeelingRenderer.bind(n);this._eventInfo.subMesh=c;this._callbackPluginEventBindForSubMesh(this._eventInfo);cs$$module$libs$world_onscreen(n,
this,e);this.bindEyePosition(n)}else e.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);!a&&this.isFrozen||(e.lightsEnabled&&!this._disableLighting&&te$$module$libs$world_onscreen.BindLights(e,b,n,g,this._maxSimultaneousLights),(e.fogEnabled&&b.applyFog&&e.fogMode!==re$$module$libs$world_onscreen.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||b.receiveShadows||g.PREPASS)&&this.bindView(n),te$$module$libs$world_onscreen.BindFogParameters(e,b,n),g.NUM_MORPH_INFLUENCERS&&
te$$module$libs$world_onscreen.BindMorphTargetParameters(b,n),g.BAKED_VERTEX_ANIMATION_TEXTURE&&(null===(d=b.bakedVertexAnimationManager)||void 0===d||d.bind(n,g.INSTANCES)),this.useLogarithmicDepth&&te$$module$libs$world_onscreen.BindLogDepth(g,n,e),!this._imageProcessingConfiguration||this._imageProcessingConfiguration.applyByPostProcess||this._imageProcessingConfiguration.bind(this._activeEffect));this._afterBind(b,this._activeEffect);t.update()}}}getAnimatables(){const a=super.getAnimatables();
return this._diffuseTexture&&this._diffuseTexture.animations&&0<this._diffuseTexture.animations.length&&a.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&0<this._ambientTexture.animations.length&&a.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&0<this._opacityTexture.animations.length&&a.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&0<this._reflectionTexture.animations.length&&a.push(this._reflectionTexture),
this._emissiveTexture&&this._emissiveTexture.animations&&0<this._emissiveTexture.animations.length&&a.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&0<this._specularTexture.animations.length&&a.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&0<this._bumpTexture.animations.length&&a.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&0<this._lightmapTexture.animations.length&&a.push(this._lightmapTexture),
this._refractionTexture&&this._refractionTexture.animations&&0<this._refractionTexture.animations.length&&a.push(this._refractionTexture),a}getActiveTextures(){const a=super.getActiveTextures();return this._diffuseTexture&&a.push(this._diffuseTexture),this._ambientTexture&&a.push(this._ambientTexture),this._opacityTexture&&a.push(this._opacityTexture),this._reflectionTexture&&a.push(this._reflectionTexture),this._emissiveTexture&&a.push(this._emissiveTexture),this._specularTexture&&a.push(this._specularTexture),
this._bumpTexture&&a.push(this._bumpTexture),this._lightmapTexture&&a.push(this._lightmapTexture),this._refractionTexture&&a.push(this._refractionTexture),a}hasTexture(a){return!(!super.hasTexture(a)&&this._diffuseTexture!==a&&this._ambientTexture!==a&&this._opacityTexture!==a&&this._reflectionTexture!==a&&this._emissiveTexture!==a&&this._specularTexture!==a&&this._bumpTexture!==a&&this._lightmapTexture!==a&&this._refractionTexture!==a)}dispose(a,b){var c,d,e,g,n,t,w,z,C;b&&(null===(c=this._diffuseTexture)||
void 0===c||c.dispose(),null===(d=this._ambientTexture)||void 0===d||d.dispose(),null===(e=this._opacityTexture)||void 0===e||e.dispose(),null===(g=this._reflectionTexture)||void 0===g||g.dispose(),null===(n=this._emissiveTexture)||void 0===n||n.dispose(),null===(t=this._specularTexture)||void 0===t||t.dispose(),null===(w=this._bumpTexture)||void 0===w||w.dispose(),null===(z=this._lightmapTexture)||void 0===z||z.dispose(),null===(C=this._refractionTexture)||void 0===C||C.dispose());this._imageProcessingConfiguration&&
this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver);super.dispose(a,b)}clone(a){const b=ae$$module$libs$world_onscreen.Clone(()=>new N$$module$libs$world_onscreen(a,this.getScene()),this);return b.name=a,b.id=a,this.stencil.copyTo(b.stencil),b}static Parse(a,b,c){const d=ae$$module$libs$world_onscreen.Parse(()=>new N$$module$libs$world_onscreen(a.name,b),a,b,c);return a.stencil&&d.stencil.parse(a.stencil,b,c),d}static get DiffuseTextureEnabled(){return de$$module$libs$world_onscreen.DiffuseTextureEnabled}static set DiffuseTextureEnabled(a){de$$module$libs$world_onscreen.DiffuseTextureEnabled=
a}static get DetailTextureEnabled(){return de$$module$libs$world_onscreen.DetailTextureEnabled}static set DetailTextureEnabled(a){de$$module$libs$world_onscreen.DetailTextureEnabled=a}static get AmbientTextureEnabled(){return de$$module$libs$world_onscreen.AmbientTextureEnabled}static set AmbientTextureEnabled(a){de$$module$libs$world_onscreen.AmbientTextureEnabled=a}static get OpacityTextureEnabled(){return de$$module$libs$world_onscreen.OpacityTextureEnabled}static set OpacityTextureEnabled(a){de$$module$libs$world_onscreen.OpacityTextureEnabled=
a}static get ReflectionTextureEnabled(){return de$$module$libs$world_onscreen.ReflectionTextureEnabled}static set ReflectionTextureEnabled(a){de$$module$libs$world_onscreen.ReflectionTextureEnabled=a}static get EmissiveTextureEnabled(){return de$$module$libs$world_onscreen.EmissiveTextureEnabled}static set EmissiveTextureEnabled(a){de$$module$libs$world_onscreen.EmissiveTextureEnabled=a}static get SpecularTextureEnabled(){return de$$module$libs$world_onscreen.SpecularTextureEnabled}static set SpecularTextureEnabled(a){de$$module$libs$world_onscreen.SpecularTextureEnabled=
a}static get BumpTextureEnabled(){return de$$module$libs$world_onscreen.BumpTextureEnabled}static set BumpTextureEnabled(a){de$$module$libs$world_onscreen.BumpTextureEnabled=a}static get LightmapTextureEnabled(){return de$$module$libs$world_onscreen.LightmapTextureEnabled}static set LightmapTextureEnabled(a){de$$module$libs$world_onscreen.LightmapTextureEnabled=a}static get RefractionTextureEnabled(){return de$$module$libs$world_onscreen.RefractionTextureEnabled}static set RefractionTextureEnabled(a){de$$module$libs$world_onscreen.RefractionTextureEnabled=
a}static get ColorGradingTextureEnabled(){return de$$module$libs$world_onscreen.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(a){de$$module$libs$world_onscreen.ColorGradingTextureEnabled=a}static get FresnelEnabled(){return de$$module$libs$world_onscreen.FresnelEnabled}static set FresnelEnabled(a){de$$module$libs$world_onscreen.FresnelEnabled=a}}
T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("diffuseTexture")],N$$module$libs$world_onscreen.prototype,"_diffuseTexture",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesAndMiscDirty")],N$$module$libs$world_onscreen.prototype,"diffuseTexture",void 0);T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("ambientTexture")],N$$module$libs$world_onscreen.prototype,"_ambientTexture",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"ambientTexture",void 0);T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("opacityTexture")],N$$module$libs$world_onscreen.prototype,"_opacityTexture",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesAndMiscDirty")],N$$module$libs$world_onscreen.prototype,"opacityTexture",void 0);
T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("reflectionTexture")],N$$module$libs$world_onscreen.prototype,"_reflectionTexture",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"reflectionTexture",void 0);T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("emissiveTexture")],N$$module$libs$world_onscreen.prototype,"_emissiveTexture",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"emissiveTexture",void 0);T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("specularTexture")],N$$module$libs$world_onscreen.prototype,"_specularTexture",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"specularTexture",void 0);
T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("bumpTexture")],N$$module$libs$world_onscreen.prototype,"_bumpTexture",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"bumpTexture",void 0);T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("lightmapTexture")],N$$module$libs$world_onscreen.prototype,"_lightmapTexture",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"lightmapTexture",void 0);T$$module$libs$world_onscreen([vt$$module$libs$world_onscreen("refractionTexture")],N$$module$libs$world_onscreen.prototype,"_refractionTexture",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"refractionTexture",void 0);
T$$module$libs$world_onscreen([di$$module$libs$world_onscreen("ambient")],N$$module$libs$world_onscreen.prototype,"ambientColor",void 0);T$$module$libs$world_onscreen([di$$module$libs$world_onscreen("diffuse")],N$$module$libs$world_onscreen.prototype,"diffuseColor",void 0);T$$module$libs$world_onscreen([di$$module$libs$world_onscreen("specular")],N$$module$libs$world_onscreen.prototype,"specularColor",void 0);
T$$module$libs$world_onscreen([di$$module$libs$world_onscreen("emissive")],N$$module$libs$world_onscreen.prototype,"emissiveColor",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],N$$module$libs$world_onscreen.prototype,"specularPower",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useAlphaFromDiffuseTexture")],N$$module$libs$world_onscreen.prototype,"_useAlphaFromDiffuseTexture",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesAndMiscDirty")],N$$module$libs$world_onscreen.prototype,"useAlphaFromDiffuseTexture",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useEmissiveAsIllumination")],N$$module$libs$world_onscreen.prototype,"_useEmissiveAsIllumination",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useEmissiveAsIllumination",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("linkEmissiveWithDiffuse")],N$$module$libs$world_onscreen.prototype,"_linkEmissiveWithDiffuse",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"linkEmissiveWithDiffuse",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useSpecularOverAlpha")],N$$module$libs$world_onscreen.prototype,"_useSpecularOverAlpha",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useSpecularOverAlpha",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useReflectionOverAlpha")],N$$module$libs$world_onscreen.prototype,"_useReflectionOverAlpha",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useReflectionOverAlpha",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("disableLighting")],N$$module$libs$world_onscreen.prototype,"_disableLighting",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsLightsDirty")],N$$module$libs$world_onscreen.prototype,"disableLighting",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useObjectSpaceNormalMap")],N$$module$libs$world_onscreen.prototype,"_useObjectSpaceNormalMap",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useObjectSpaceNormalMap",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useParallax")],N$$module$libs$world_onscreen.prototype,"_useParallax",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useParallax",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useParallaxOcclusion")],N$$module$libs$world_onscreen.prototype,"_useParallaxOcclusion",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useParallaxOcclusion",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],N$$module$libs$world_onscreen.prototype,"parallaxScaleBias",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("roughness")],N$$module$libs$world_onscreen.prototype,"_roughness",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"roughness",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],N$$module$libs$world_onscreen.prototype,"indexOfRefraction",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],N$$module$libs$world_onscreen.prototype,"invertRefractionY",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],N$$module$libs$world_onscreen.prototype,"alphaCutOff",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useLightmapAsShadowmap")],N$$module$libs$world_onscreen.prototype,"_useLightmapAsShadowmap",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useLightmapAsShadowmap",void 0);
T$$module$libs$world_onscreen([Vi$$module$libs$world_onscreen("diffuseFresnelParameters")],N$$module$libs$world_onscreen.prototype,"_diffuseFresnelParameters",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsFresnelDirty")],N$$module$libs$world_onscreen.prototype,"diffuseFresnelParameters",void 0);T$$module$libs$world_onscreen([Vi$$module$libs$world_onscreen("opacityFresnelParameters")],N$$module$libs$world_onscreen.prototype,"_opacityFresnelParameters",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsFresnelAndMiscDirty")],N$$module$libs$world_onscreen.prototype,"opacityFresnelParameters",void 0);T$$module$libs$world_onscreen([Vi$$module$libs$world_onscreen("reflectionFresnelParameters")],N$$module$libs$world_onscreen.prototype,"_reflectionFresnelParameters",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsFresnelDirty")],N$$module$libs$world_onscreen.prototype,"reflectionFresnelParameters",void 0);T$$module$libs$world_onscreen([Vi$$module$libs$world_onscreen("refractionFresnelParameters")],N$$module$libs$world_onscreen.prototype,"_refractionFresnelParameters",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsFresnelDirty")],N$$module$libs$world_onscreen.prototype,"refractionFresnelParameters",void 0);T$$module$libs$world_onscreen([Vi$$module$libs$world_onscreen("emissiveFresnelParameters")],N$$module$libs$world_onscreen.prototype,"_emissiveFresnelParameters",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsFresnelDirty")],N$$module$libs$world_onscreen.prototype,"emissiveFresnelParameters",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useReflectionFresnelFromSpecular")],N$$module$libs$world_onscreen.prototype,"_useReflectionFresnelFromSpecular",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsFresnelDirty")],N$$module$libs$world_onscreen.prototype,"useReflectionFresnelFromSpecular",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("useGlossinessFromSpecularMapAlpha")],N$$module$libs$world_onscreen.prototype,"_useGlossinessFromSpecularMapAlpha",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"useGlossinessFromSpecularMapAlpha",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("maxSimultaneousLights")],N$$module$libs$world_onscreen.prototype,"_maxSimultaneousLights",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsLightsDirty")],N$$module$libs$world_onscreen.prototype,"maxSimultaneousLights",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("invertNormalMapX")],N$$module$libs$world_onscreen.prototype,"_invertNormalMapX",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"invertNormalMapX",void 0);
T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("invertNormalMapY")],N$$module$libs$world_onscreen.prototype,"_invertNormalMapY",void 0);T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"invertNormalMapY",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen("twoSidedLighting")],N$$module$libs$world_onscreen.prototype,"_twoSidedLighting",void 0);
T$$module$libs$world_onscreen([be$$module$libs$world_onscreen("_markAllSubMeshesAsTexturesDirty")],N$$module$libs$world_onscreen.prototype,"twoSidedLighting",void 0);T$$module$libs$world_onscreen([R$$module$libs$world_onscreen()],N$$module$libs$world_onscreen.prototype,"useLogarithmicDepth",null);st$$module$libs$world_onscreen("BABYLON.StandardMaterial",N$$module$libs$world_onscreen);re$$module$libs$world_onscreen.DefaultMaterialFactory=a=>new N$$module$libs$world_onscreen("default material",a);
const Ml$$module$libs$world_onscreen="imageProcessingCompatibility",Al$$module$libs$world_onscreen="#ifdef IMAGEPROCESSINGPOSTPROCESS\ngl_FragColor.rgb=pow(gl_FragColor.rgb,vec3(2.2));\n#endif\n";U$$module$libs$world_onscreen.IncludesShadersStore[Ml$$module$libs$world_onscreen]=Al$$module$libs$world_onscreen;const Rl$$module$libs$world_onscreen="shadowOnlyPixelShader",yl$$module$libs$world_onscreen="precision highp float;\nuniform vec4 vEyePosition;\nuniform float alpha;\nuniform vec3 shadowColor;\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#include<helperFunctions>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<fogFragmentDeclaration>\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_FRAGMENT_MAIN_BEGIN\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=vec3(1.0,1.0,1.0);\n#endif\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\nfloat shadow=1.;\nfloat glossiness=0.;\n#include<lightFragment>[0..1]\nvec4 color=vec4(shadowColor,(1.0-clamp(shadow,0.,1.))*alpha);\n#include<fogFragment>\ngl_FragColor=color;\n#include<imageProcessingCompatibility>\n#define CUSTOM_FRAGMENT_MAIN_END\n}";
U$$module$libs$world_onscreen.ShadersStore[Rl$$module$libs$world_onscreen]=yl$$module$libs$world_onscreen;const Cl$$module$libs$world_onscreen="shadowOnlyVertexShader",Il$$module$libs$world_onscreen="precision highp float;\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<instancesDeclaration>\nuniform mat4 view;\nuniform mat4 viewProjection;\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#ifdef VERTEXCOLOR\nvarying vec4 vColor;\n#endif\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\n#include<instancesVertex>\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(position,1.0);\ngl_Position=viewProjection*worldPos;\nvPositionW=vec3(worldPos);\n#ifdef NORMAL\nvNormalW=normalize(vec3(finalWorld*vec4(normal,0.0)));\n#endif\n#include<clipPlaneVertex>\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n#if defined(POINTSIZE) && !defined(WEBGPU)\ngl_PointSize=pointSize;\n#endif\n#define CUSTOM_VERTEX_MAIN_END\n}\n";
U$$module$libs$world_onscreen.ShadersStore[Cl$$module$libs$world_onscreen]=Il$$module$libs$world_onscreen;class Pl$$module$libs$world_onscreen extends Hs$$module$libs$world_onscreen{constructor(){super();this.NORMAL=this.FOG=this.POINTSIZE=this.CLIPPLANE6=this.CLIPPLANE5=this.CLIPPLANE4=this.CLIPPLANE3=this.CLIPPLANE2=this.CLIPPLANE=!1;this.BonesPerMesh=this.NUM_BONE_INFLUENCERS=0;this.SKIPFINALCOLORCLAMP=this.IMAGEPROCESSINGPOSTPROCESS=this.INSTANCES=!1;this.rebuild()}}
class Li$$module$libs$world_onscreen extends Wr$$module$libs$world_onscreen{constructor(a,b){super(a,b);this._needAlphaBlending=!0;this.shadowColor=se$$module$libs$world_onscreen.Black()}needAlphaBlending(){return this._needAlphaBlending}needAlphaTesting(){return!1}getAlphaTestTexture(){return null}get activeLight(){return this._activeLight}set activeLight(a){this._activeLight=a}_getFirstShadowLightForMesh(a){for(const b of a.lightSources)if(b.shadowEnabled)return b;return null}isReadyForSubMesh(a,
b,c){var d;if(this.isFrozen&&b.effect&&b.effect._wasPreviouslyReady&&b.effect._wasPreviouslyUsingInstances===c)return!0;b.materialDefines||(b.materialDefines=new Pl$$module$libs$world_onscreen);const e=b.materialDefines,g=this.getScene();if(this._isReadyForSubMesh(b))return!0;const n=g.getEngine();if(this._activeLight)for(var t of a.lightSources)if(t.shadowEnabled){if(this._activeLight===t)break;t=a.lightSources.indexOf(this._activeLight);-1!==t&&(a.lightSources.splice(t,1),a.lightSources.splice(0,
0,this._activeLight));break}te$$module$libs$world_onscreen.PrepareDefinesForFrameBoundValues(g,n,this,e,!!c);te$$module$libs$world_onscreen.PrepareDefinesForMisc(a,g,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(a),e);e._needNormals=te$$module$libs$world_onscreen.PrepareDefinesForLights(g,a,e,!1,1);t=null===(d=this._getFirstShadowLightForMesh(a))||void 0===d?void 0:d.getShadowGenerator();if(this._needAlphaBlending=!0,t&&t.getClassName&&"CascadedShadowGenerator"===t.getClassName())this._needAlphaBlending=
!t.autoCalcDepthBounds;if(te$$module$libs$world_onscreen.PrepareDefinesForAttributes(a,e,!1,!0),e.isDirty){e.markAsProcessed();g.resetCachedMaterial();d=new qs$$module$libs$world_onscreen;e.FOG&&d.addFallback(1,"FOG");te$$module$libs$world_onscreen.HandleFallbacksForShadows(e,d,1);0<e.NUM_BONE_INFLUENCERS&&d.addCPUSkinningFallback(0,a);e.IMAGEPROCESSINGPOSTPROCESS=g.imageProcessingConfiguration.applyByPostProcess;t=[g$$module$libs$world_onscreen.PositionKind];e.NORMAL&&t.push(g$$module$libs$world_onscreen.NormalKind);
te$$module$libs$world_onscreen.PrepareAttributesForBones(t,a,e,d);te$$module$libs$world_onscreen.PrepareAttributesForInstances(t,e);a=e.toString();const w="world view viewProjection vEyePosition vLightsType vFogInfos vFogColor pointSize alpha shadowColor mBones".split(" "),z=[],C=[];ls$$module$libs$world_onscreen(w);te$$module$libs$world_onscreen.PrepareUniformsAndSamplersList({uniformsNames:w,uniformBuffersNames:C,samplers:z,defines:e,maxSimultaneousLights:1});b.setEffect(g.getEngine().createEffect("shadowOnly",
{attributes:t,uniformsNames:w,uniformBuffersNames:C,samplers:z,defines:a,fallbacks:d,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:1}},n),e,this._materialContext)}return b.effect&&b.effect.isReady()?(e._renderId=g.getRenderId(),b.effect._wasPreviouslyReady=!0,b.effect._wasPreviouslyUsingInstances=!!c,!0):!1}bindForSubMesh(a,b,c){const d=this.getScene(),e=c.materialDefines;if(e&&(c=c.effect)){if(this._activeEffect=c,this.bindOnlyWorldMatrix(a),this._activeEffect.setMatrix("viewProjection",
d.getTransformMatrix()),te$$module$libs$world_onscreen.BindBonesParameters(b,this._activeEffect),this._mustRebind(d,c)&&(cs$$module$libs$world_onscreen(c,this,d),this.pointsCloud&&this._activeEffect.setFloat("pointSize",this.pointSize),this._activeEffect.setFloat("alpha",this.alpha),this._activeEffect.setColor3("shadowColor",this.shadowColor),d.bindEyePosition(c)),d.lightsEnabled)te$$module$libs$world_onscreen.BindLights(d,b,this._activeEffect,e,1),(a=this._getFirstShadowLightForMesh(b))&&(a._renderId=
-1);(d.fogEnabled&&b.applyFog&&d.fogMode!==re$$module$libs$world_onscreen.FOGMODE_NONE||e.SHADOWCSM0)&&this._activeEffect.setMatrix("view",d.getViewMatrix());te$$module$libs$world_onscreen.BindFogParameters(d,b,this._activeEffect);this._afterBind(b,this._activeEffect)}}clone(a){return ae$$module$libs$world_onscreen.Clone(()=>new Li$$module$libs$world_onscreen(a,this.getScene()),this)}serialize(){const a=super.serialize();return a.customType="BABYLON.ShadowOnlyMaterial",a}getClassName(){return"ShadowOnlyMaterial"}static Parse(a,
b,c){return ae$$module$libs$world_onscreen.Parse(()=>new Li$$module$libs$world_onscreen(a.name,b),a,b,c)}}st$$module$libs$world_onscreen("BABYLON.ShadowOnlyMaterial",Li$$module$libs$world_onscreen);const Dl$$module$libs$world_onscreen={aspect:2,enableDebugging:!1,enableShadows:!0};
class Fl$$module$libs$world_onscreen{constructor(a){gt$$module$libs$world_onscreen(this,"size",9.5);this.config={...Dl$$module$libs$world_onscreen,...a};this.create()}create(a){this.destroy();Object.assign(this.config,a);const {aspect:b,enableDebugging:c=!0,enableShadows:d}=this.config;let e;this.box=new Q$$module$libs$world_onscreen("diceBox");c?(e=new N$$module$libs$world_onscreen("diceBox_material"),e.alpha=.7,e.diffuseColor=new se$$module$libs$world_onscreen(1,1,0)):d&&(e=new Li$$module$libs$world_onscreen("shadowOnly",
this.config.scene));a=Ei$$module$libs$world_onscreen("ground",{width:2*this.size,height:1,depth:2*this.size},this.config.scene);if(a.scaling=new p$$module$libs$world_onscreen(b,1,1),a.material=e,a.receiveShadows=!0,a.setParent(this.box),c)a=Ei$$module$libs$world_onscreen("wallTop",{width:this.size,height:30,depth:1},this.config.scene),a.position.y=15,a.position.z=this.size/-2,a.scaling=new p$$module$libs$world_onscreen(b,1,1),a.material=e,a.setParent(this.box),a=Ei$$module$libs$world_onscreen("wallRight",
{width:1,height:30,depth:this.size},this.config.scene),a.position.x=this.size*b/2,a.position.y=15,a.material=e,a.setParent(this.box),a=Ei$$module$libs$world_onscreen("wallBottom",{width:this.size,height:30,depth:1},this.config.scene),a.position.y=15,a.position.z=this.size/2,a.scaling=new p$$module$libs$world_onscreen(b,1,1),a.material=e,a.setParent(this.box),a=Ei$$module$libs$world_onscreen("wallLeft",{width:1,height:30,depth:this.size},this.config.scene),a.position.x=this.size*b/-2,a.position.y=
15,a.material=e,a.setParent(this.box)}destroy(){this.box&&this.box.dispose()}}var Zt$$module$libs$world_onscreen;(function(a){a[a.Clean=0]="Clean";a[a.Stop=1]="Stop";a[a.Sync=2]="Sync";a[a.NoSync=3]="NoSync"})(Zt$$module$libs$world_onscreen||={});
class oe$$module$libs$world_onscreen{static get ForceFullSceneLoadingForIncremental(){return we$$module$libs$world_onscreen.ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(a){we$$module$libs$world_onscreen.ForceFullSceneLoadingForIncremental=a}static get ShowLoadingScreen(){return we$$module$libs$world_onscreen.ShowLoadingScreen}static set ShowLoadingScreen(a){we$$module$libs$world_onscreen.ShowLoadingScreen=a}static get loggingLevel(){return we$$module$libs$world_onscreen.loggingLevel}static set loggingLevel(a){we$$module$libs$world_onscreen.loggingLevel=
a}static get CleanBoneMatrixWeights(){return we$$module$libs$world_onscreen.CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(a){we$$module$libs$world_onscreen.CleanBoneMatrixWeights=a}static GetDefaultPlugin(){return oe$$module$libs$world_onscreen._RegisteredPlugins[".babylon"]}static _GetPluginForExtension(a){return oe$$module$libs$world_onscreen._RegisteredPlugins[a]||(O$$module$libs$world_onscreen.Warn("Unable to find a plugin to load "+a+" files. Trying to use .babylon default plugin. To load from a specific filetype (eg. gltf) see: https://doc.babylonjs.com/features/featuresDeepDive/importers/loadingFileTypes"),
oe$$module$libs$world_onscreen.GetDefaultPlugin())}static _GetPluginForDirectLoad(a){for(const b in oe$$module$libs$world_onscreen._RegisteredPlugins){const c=oe$$module$libs$world_onscreen._RegisteredPlugins[b].plugin;if(c.canDirectLoad&&c.canDirectLoad(a))return oe$$module$libs$world_onscreen._RegisteredPlugins[b]}return oe$$module$libs$world_onscreen.GetDefaultPlugin()}static _GetPluginForFilename(a){var b=a.indexOf("?");-1!==b&&(a=a.substring(0,b));b=a.lastIndexOf(".");a=a.substring(b,a.length).toLowerCase();
return oe$$module$libs$world_onscreen._GetPluginForExtension(a)}static _GetDirectLoad(a){return"data:"===a.substr(0,5)?a.substr(5):null}static _FormatErrorMessage(a,b,c){a="Unable to load from "+a.url;return b?a+=`: ${b}`:c&&(a+=`: ${c}`),a}static _LoadData(a,b,c,d,e,g,n){var t=oe$$module$libs$world_onscreen._GetDirectLoad(a.url);n=n?oe$$module$libs$world_onscreen._GetPluginForExtension(n):t?oe$$module$libs$world_onscreen._GetPluginForDirectLoad(a.url):oe$$module$libs$world_onscreen._GetPluginForFilename(a.url);
let w;if(void 0!==n.plugin.createPlugin?w=n.plugin.createPlugin():w=n.plugin,!w)throw"The loader plugin corresponding to the file type you are trying to load has not been found. If using es6, please import the plugin you wish to use before.";if(oe$$module$libs$world_onscreen.OnPluginActivatedObservable.notifyObservers(w),t&&(w.canDirectLoad&&w.canDirectLoad(a.url)||!Gs$$module$libs$world_onscreen(a.url))){if(w.directLoad){var z=w.directLoad(b,t);z.then?z.then(S=>{c(w,S)}).catch(S=>{e("Error in directLoad of _loadData: "+
S,S)}):c(w,z)}else c(w,t);return w}const C=n.isBinary,H=(S,T)=>{b.isDisposed?e("Scene has been disposed"):c(w,S,T)};let M=null,L=!1;(t=w.onDisposeObservable)&&t.add(()=>{L=!0;M&&(M.abort(),M=null);g()});t=()=>{if(!L){var S=(P,W)=>{e(null==P?void 0:P.statusText,W)},T=a.file||a.url;M=w.loadFile?w.loadFile(b,T,H,d,C,S):b._loadFile(T,H,d,!0,C,S)}};n=b.getEngine();var O=n.enableOfflineSupport;if(O){O=!1;for(z of b.disableOfflineSupportExceptionRules)if(z.test(a.url)){O=!0;break}O=!O}return O&&I$$module$libs$world_onscreen.OfflineProviderFactory?
b.offlineProvider=I$$module$libs$world_onscreen.OfflineProviderFactory(a.url,t,n.disableManifestCheck):t(),w}static _GetFileInfo(a,b){let c,d,e=null;if(b)if(b.name)c=`file:${b.name}`,d=b.name,e=b;else if("string"==typeof b&&b.startsWith("data:"))c=b,d="";else{if("/"===b.substr(0,1))return X$$module$libs$world_onscreen.Error("Wrong sceneFilename parameter"),null;c=a+b;d=b}else c=a,d=X$$module$libs$world_onscreen.GetFilename(a),a=X$$module$libs$world_onscreen.GetFolderPath(a);return{url:c,rootUrl:a,
name:d,file:e}}static GetPluginForExtension(a){return oe$$module$libs$world_onscreen._GetPluginForExtension(a).plugin}static IsPluginForExtensionAvailable(a){return!!oe$$module$libs$world_onscreen._RegisteredPlugins[a]}static RegisterPlugin(a){if("string"==typeof a.extensions)oe$$module$libs$world_onscreen._RegisteredPlugins[a.extensions.toLowerCase()]={plugin:a,isBinary:!1};else{const b=a.extensions;Object.keys(b).forEach(c=>{oe$$module$libs$world_onscreen._RegisteredPlugins[c.toLowerCase()]={plugin:a,
isBinary:b[c].isBinary}})}}static ImportMesh(a,b,c="",d=fe$$module$libs$world_onscreen.LastCreatedScene,e=null,g=null,n=null,t=null){if(!d)return O$$module$libs$world_onscreen.Error("No scene available to import mesh to"),null;const w=oe$$module$libs$world_onscreen._GetFileInfo(b,c);if(!w)return null;const z={};d.addPendingData(z);const C=(L,O)=>{L=oe$$module$libs$world_onscreen._FormatErrorMessage(w,L,O);n?n(d,L,new Wt$$module$libs$world_onscreen(L,oi$$module$libs$world_onscreen.SceneLoaderError,
O)):O$$module$libs$world_onscreen.Error(L);d.removePendingData(z)},H=g?L=>{try{g(L)}catch(O){C("Error in onProgress callback: "+O,O)}}:void 0,M=(L,O,S,T,P,W,Z)=>{if(d.importedMeshesFiles.push(w.url),e)try{e(L,O,S,T,P,W,Z)}catch(ca){C("Error in onSuccess callback: "+ca,ca)}d.removePendingData(z)};return oe$$module$libs$world_onscreen._LoadData(w,d,(L,O,S)=>{if(L.rewriteRootURL&&(w.rootUrl=L.rewriteRootURL(w.rootUrl,S)),L.importMesh){S=[];const T=[],P=[];L.importMesh(a,d,O,w.rootUrl,S,T,P,C)&&(d.loadingPluginName=
L.name,M(S,T,P,[],[],[],[]))}else L.importMeshAsync(a,d,O,w.rootUrl,H,w.name).then(T=>{d.loadingPluginName=L.name;M(T.meshes,T.particleSystems,T.skeletons,T.animationGroups,T.transformNodes,T.geometries,T.lights)}).catch(T=>{C(T.message,T)})},H,C,()=>{d.removePendingData(z)},t)}static ImportMeshAsync(a,b,c="",d=fe$$module$libs$world_onscreen.LastCreatedScene,e=null,g=null){return new Promise((n,t)=>{oe$$module$libs$world_onscreen.ImportMesh(a,b,c,d,(w,z,C,H,M,L,O)=>{n({meshes:w,particleSystems:z,
skeletons:C,animationGroups:H,transformNodes:M,geometries:L,lights:O})},e,(w,z,C)=>{t(C||Error(z))},g)})}static Load(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedEngine,d=null,e=null,g=null,n=null){return c?oe$$module$libs$world_onscreen.Append(a,b,new re$$module$libs$world_onscreen(c),d,e,g,n):(X$$module$libs$world_onscreen.Error("No engine available"),null)}static LoadAsync(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedEngine,d=null,e=null){return new Promise((g,n)=>{oe$$module$libs$world_onscreen.Load(a,
b,c,t=>{g(t)},d,(t,w,z)=>{n(z||Error(w))},e)})}static Append(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedScene,d=null,e=null,g=null,n=null){if(!c)return O$$module$libs$world_onscreen.Error("No scene available to append to"),null;const t=oe$$module$libs$world_onscreen._GetFileInfo(a,b);if(!t)return null;const w={};c.addPendingData(w);oe$$module$libs$world_onscreen.ShowLoadingScreen&&!this._ShowingLoadingScreen&&(this._ShowingLoadingScreen=!0,c.getEngine().displayLoadingUI(),c.executeWhenReady(()=>
{c.getEngine().hideLoadingUI();this._ShowingLoadingScreen=!1}));const z=(M,L)=>{M=oe$$module$libs$world_onscreen._FormatErrorMessage(t,M,L);g?g(c,M,new Wt$$module$libs$world_onscreen(M,oi$$module$libs$world_onscreen.SceneLoaderError,L)):O$$module$libs$world_onscreen.Error(M);c.removePendingData(w)},C=e?M=>{try{e(M)}catch(L){z("Error in onProgress callback",L)}}:void 0,H=()=>{if(d)try{d(c)}catch(M){z("Error in onSuccess callback",M)}c.removePendingData(w)};return oe$$module$libs$world_onscreen._LoadData(t,
c,(M,L)=>{M.load?M.load(c,L,t.rootUrl,z)&&(c.loadingPluginName=M.name,H()):M.loadAsync(c,L,t.rootUrl,C,t.name).then(()=>{c.loadingPluginName=M.name;H()}).catch(O=>{z(O.message,O)})},C,z,()=>{c.removePendingData(w)},n)}static AppendAsync(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedScene,d=null,e=null){return new Promise((g,n)=>{oe$$module$libs$world_onscreen.Append(a,b,c,t=>{g(t)},d,(t,w,z)=>{n(z||Error(w))},e)})}static LoadAssetContainer(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedScene,
d=null,e=null,g=null,n=null){if(!c)return O$$module$libs$world_onscreen.Error("No scene available to load asset container to"),null;const t=oe$$module$libs$world_onscreen._GetFileInfo(a,b);if(!t)return null;const w={};c.addPendingData(w);const z=(M,L)=>{M=oe$$module$libs$world_onscreen._FormatErrorMessage(t,M,L);g?g(c,M,new Wt$$module$libs$world_onscreen(M,oi$$module$libs$world_onscreen.SceneLoaderError,L)):O$$module$libs$world_onscreen.Error(M);c.removePendingData(w)},C=e?M=>{try{e(M)}catch(L){z("Error in onProgress callback",
L)}}:void 0,H=M=>{if(d)try{d(M)}catch(L){z("Error in onSuccess callback",L)}c.removePendingData(w)};return oe$$module$libs$world_onscreen._LoadData(t,c,(M,L)=>{if(M.loadAssetContainer){if(L=M.loadAssetContainer(c,L,t.rootUrl,z))c.loadingPluginName=M.name,H(L)}else M.loadAssetContainerAsync?M.loadAssetContainerAsync(c,L,t.rootUrl,C,t.name).then(O=>{c.loadingPluginName=M.name;H(O)}).catch(O=>{z(O.message,O)}):z("LoadAssetContainer is not supported by this plugin. Plugin did not provide a loadAssetContainer or loadAssetContainerAsync method.")},
C,z,()=>{c.removePendingData(w)},n)}static LoadAssetContainerAsync(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedScene,d=null,e=null){return new Promise((g,n)=>{oe$$module$libs$world_onscreen.LoadAssetContainer(a,b,c,t=>{g(t)},d,(t,w,z)=>{n(z||Error(w))},e)})}static ImportAnimations(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedScene,d=!0,e=Zt$$module$libs$world_onscreen.Clean,g=null,n=null,t=null,w=null,z=null){if(c){if(d){for(const H of c.animatables)H.reset();c.stopAllAnimations();c.animationGroups.slice().forEach(H=>
{H.dispose()});c.getNodes().forEach(H=>{H.animations&&(H.animations=[])})}else switch(e){case Zt$$module$libs$world_onscreen.Clean:c.animationGroups.slice().forEach(H=>{H.dispose()});break;case Zt$$module$libs$world_onscreen.Stop:c.animationGroups.forEach(H=>{H.stop()});break;case Zt$$module$libs$world_onscreen.Sync:c.animationGroups.forEach(H=>{H.reset();H.restart()});break;case Zt$$module$libs$world_onscreen.NoSync:break;default:O$$module$libs$world_onscreen.Error("Unknown animation group loading mode value '"+
e+"'");return}var C=c.animatables.length;this.LoadAssetContainer(a,b,c,H=>{H.mergeAnimationsTo(c,c.animatables.slice(C),g);H.dispose();c.onAnimationFileImportedObservable.notifyObservers(c);n&&n(c)},t,w,z)}else O$$module$libs$world_onscreen.Error("No scene available to load animations to")}static ImportAnimationsAsync(a,b="",c=fe$$module$libs$world_onscreen.LastCreatedScene,d=!0,e=Zt$$module$libs$world_onscreen.Clean,g=null,n,t=null,w,z=null){return new Promise((C,H)=>{oe$$module$libs$world_onscreen.ImportAnimations(a,
b,c,d,e,g,M=>{C(M)},t,(M,L,O)=>{H(O||Error(L))},z)})}}oe$$module$libs$world_onscreen.NO_LOGGING=0;oe$$module$libs$world_onscreen.MINIMAL_LOGGING=1;oe$$module$libs$world_onscreen.SUMMARY_LOGGING=2;oe$$module$libs$world_onscreen.DETAILED_LOGGING=3;oe$$module$libs$world_onscreen.OnPluginActivatedObservable=new w$$module$libs$world_onscreen;oe$$module$libs$world_onscreen._RegisteredPlugins={};oe$$module$libs$world_onscreen._ShowingLoadingScreen=!1;
class _e$$module$libs$world_onscreen{constructor(a,b,c=Number.MAX_VALUE){this.origin=a;this.direction=b;this.length=c}clone(){return new _e$$module$libs$world_onscreen(this.origin.clone(),this.direction.clone(),this.length)}intersectsBoxMinMax(a,b,c=0){a=_e$$module$libs$world_onscreen._TmpVector3[0].copyFromFloats(a.x-c,a.y-c,a.z-c);b=_e$$module$libs$world_onscreen._TmpVector3[1].copyFromFloats(b.x+c,b.y+c,b.z+c);c=0;let d=Number.MAX_VALUE,e,g,n,t;if(1E-7>Math.abs(this.direction.x)){if(this.origin.x<
a.x||this.origin.x>b.x)return!1}else if(e=1/this.direction.x,g=(a.x-this.origin.x)*e,n=(b.x-this.origin.x)*e,n===-1/0&&(n=1/0),g>n&&(t=g,g=n,n=t),c=Math.max(g,c),d=Math.min(n,d),c>d)return!1;if(1E-7>Math.abs(this.direction.y)){if(this.origin.y<a.y||this.origin.y>b.y)return!1}else if(e=1/this.direction.y,g=(a.y-this.origin.y)*e,n=(b.y-this.origin.y)*e,n===-1/0&&(n=1/0),g>n&&(t=g,g=n,n=t),c=Math.max(g,c),d=Math.min(n,d),c>d)return!1;if(1E-7>Math.abs(this.direction.z)){if(this.origin.z<a.z||this.origin.z>
b.z)return!1}else if(e=1/this.direction.z,g=(a.z-this.origin.z)*e,n=(b.z-this.origin.z)*e,n===-1/0&&(n=1/0),g>n&&(t=g,g=n,n=t),c=Math.max(g,c),d=Math.min(n,d),c>d)return!1;return!0}intersectsBox(a,b=0){return this.intersectsBoxMinMax(a.minimum,a.maximum,b)}intersectsSphere(a,b=0){var c=a.center.x-this.origin.x;const d=a.center.y-this.origin.y,e=a.center.z-this.origin.z,g=c*c+d*d+e*e;a=a.radius+b;a*=a;if(g<=a)return!0;c=c*this.direction.x+d*this.direction.y+e*this.direction.z;return 0>c?!1:g-c*c<=
a}intersectsTriangle(a,b,c){var d=_e$$module$libs$world_onscreen._TmpVector3[0],e=_e$$module$libs$world_onscreen._TmpVector3[1];const g=_e$$module$libs$world_onscreen._TmpVector3[2],n=_e$$module$libs$world_onscreen._TmpVector3[3],t=_e$$module$libs$world_onscreen._TmpVector3[4];b.subtractToRef(a,d);c.subtractToRef(a,e);p$$module$libs$world_onscreen.CrossToRef(this.direction,e,g);b=p$$module$libs$world_onscreen.Dot(d,g);if(0===b)return null;b=1/b;this.origin.subtractToRef(a,n);a=p$$module$libs$world_onscreen.Dot(n,
g)*b;if(0>a||1<a)return null;p$$module$libs$world_onscreen.CrossToRef(n,d,t);d=p$$module$libs$world_onscreen.Dot(this.direction,t)*b;if(0>d||1<a+d)return null;e=p$$module$libs$world_onscreen.Dot(e,t)*b;return e>this.length?null:new Ns$$module$libs$world_onscreen(1-a-d,a,e)}intersectsPlane(a){let b;const c=p$$module$libs$world_onscreen.Dot(a.normal,this.direction);if(9.99999997475243E-7>Math.abs(c))return null;const d=p$$module$libs$world_onscreen.Dot(a.normal,this.origin);return b=(-a.d-d)/c,0>b?
-9.99999997475243E-7>b?null:0:b}intersectsAxis(a,b=0){switch(a){case "y":return a=(this.origin.y-b)/this.direction.y,0<a?null:new p$$module$libs$world_onscreen(this.origin.x+this.direction.x*-a,b,this.origin.z+this.direction.z*-a);case "x":return a=(this.origin.x-b)/this.direction.x,0<a?null:new p$$module$libs$world_onscreen(b,this.origin.y+this.direction.y*-a,this.origin.z+this.direction.z*-a);case "z":return a=(this.origin.z-b)/this.direction.z,0<a?null:new p$$module$libs$world_onscreen(this.origin.x+
this.direction.x*-a,this.origin.y+this.direction.y*-a,b);default:return null}}intersectsMesh(a,b){const c=D$$module$libs$world_onscreen.Matrix[0];return a.getWorldMatrix().invertToRef(c),this._tmpRay?_e$$module$libs$world_onscreen.TransformToRef(this,c,this._tmpRay):this._tmpRay=_e$$module$libs$world_onscreen.Transform(this,c),a.intersects(this._tmpRay,b)}intersectsMeshes(a,b,c){c?c.length=0:c=[];for(let d=0;d<a.length;d++){const e=this.intersectsMesh(a[d],b);e.hit&&c.push(e)}return c.sort(this._comparePickingInfo),
c}_comparePickingInfo(a,b){return a.distance<b.distance?-1:a.distance>b.distance?1:0}intersectionSegment(a,b,c){var d=this.origin,e=D$$module$libs$world_onscreen.Vector3[0],g=D$$module$libs$world_onscreen.Vector3[1],n=D$$module$libs$world_onscreen.Vector3[2];const t=D$$module$libs$world_onscreen.Vector3[3];b.subtractToRef(a,e);this.direction.scaleToRef(_e$$module$libs$world_onscreen._Rayl,n);d.addToRef(n,g);a.subtractToRef(d,t);b=p$$module$libs$world_onscreen.Dot(e,e);d=p$$module$libs$world_onscreen.Dot(e,
n);g=p$$module$libs$world_onscreen.Dot(n,n);const w=p$$module$libs$world_onscreen.Dot(e,t),z=p$$module$libs$world_onscreen.Dot(n,t),C=b*g-d*d;var H;let M=C;var L;a=C;C<_e$$module$libs$world_onscreen._Smallnum?(H=0,M=1,L=z,a=g):(H=d*z-g*w,L=b*z-d*w,0>H?(H=0,L=z,a=g):H>M&&(H=M,L=z+d,a=g));0>L?(L=0,0>-w?H=0:-w>b?H=M:(H=-w,M=b)):L>a&&(L=a,0>-w+d?H=0:-w+d>b?H=M:(H=-w+d,M=b));H=Math.abs(H)<_e$$module$libs$world_onscreen._Smallnum?0:H/M;L=Math.abs(L)<_e$$module$libs$world_onscreen._Smallnum?0:L/a;a=D$$module$libs$world_onscreen.Vector3[4];
n.scaleToRef(L,a);n=D$$module$libs$world_onscreen.Vector3[5];e.scaleToRef(H,n);n.addInPlace(t);e=D$$module$libs$world_onscreen.Vector3[6];return n.subtractToRef(a,e),0<L&&L<=this.length&&e.lengthSquared()<c*c?n.length():-1}update(a,b,c,d,e,g,n,t=!1){t?(_e$$module$libs$world_onscreen._RayDistant||(_e$$module$libs$world_onscreen._RayDistant=_e$$module$libs$world_onscreen.Zero()),_e$$module$libs$world_onscreen._RayDistant.unprojectRayToRef(a,b,c,d,x$$module$libs$world_onscreen.IdentityReadOnly,g,n),
a=D$$module$libs$world_onscreen.Matrix[0],e.invertToRef(a),_e$$module$libs$world_onscreen.TransformToRef(_e$$module$libs$world_onscreen._RayDistant,a,this)):this.unprojectRayToRef(a,b,c,d,e,g,n);return this}static Zero(){return new _e$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Zero(),p$$module$libs$world_onscreen.Zero())}static CreateNew(a,b,c,d,e,g,n){return _e$$module$libs$world_onscreen.Zero().update(a,b,c,d,e,g,n)}static CreateNewFromTo(a,b,c=x$$module$libs$world_onscreen.IdentityReadOnly){b=
b.subtract(a);const d=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);return b.normalize(),_e$$module$libs$world_onscreen.Transform(new _e$$module$libs$world_onscreen(a,b,d),c)}static Transform(a,b){const c=new _e$$module$libs$world_onscreen(new p$$module$libs$world_onscreen(0,0,0),new p$$module$libs$world_onscreen(0,0,0));return _e$$module$libs$world_onscreen.TransformToRef(a,b,c),c}static TransformToRef(a,b,c){p$$module$libs$world_onscreen.TransformCoordinatesToRef(a.origin,b,c.origin);p$$module$libs$world_onscreen.TransformNormalToRef(a.direction,
b,c.direction);c.length=a.length;a=c.direction;b=a.length();if(0!==b&&1!==b){const d=1/b;a.x*=d;a.y*=d;a.z*=d;c.length*=b}}unprojectRayToRef(a,b,c,d,e,g,n){var t;const w=D$$module$libs$world_onscreen.Matrix[0];e.multiplyToRef(g,w);w.multiplyToRef(n,w);w.invert();e=D$$module$libs$world_onscreen.Vector3[0];e.x=a/c*2-1;e.y=-(b/d*2-1);e.z=null!==(t=fe$$module$libs$world_onscreen.LastCreatedEngine)&&void 0!==t&&t.isNDCHalfZRange?0:-1;a=D$$module$libs$world_onscreen.Vector3[1].copyFromFloats(e.x,e.y,.99999999);
b=D$$module$libs$world_onscreen.Vector3[2];c=D$$module$libs$world_onscreen.Vector3[3];p$$module$libs$world_onscreen._UnprojectFromInvertedMatrixToRef(e,w,b);p$$module$libs$world_onscreen._UnprojectFromInvertedMatrixToRef(a,w,c);this.origin.copyFrom(b);c.subtractToRef(b,this.direction);this.direction.normalize()}}_e$$module$libs$world_onscreen._TmpVector3=Ye$$module$libs$world_onscreen.BuildArray(6,p$$module$libs$world_onscreen.Zero);_e$$module$libs$world_onscreen._RayDistant=_e$$module$libs$world_onscreen.Zero();
_e$$module$libs$world_onscreen._Smallnum=1E-8;_e$$module$libs$world_onscreen._Rayl=1E9;re$$module$libs$world_onscreen.prototype.createPickingRay=function(a,b,c,d,e=!1){const g=_e$$module$libs$world_onscreen.Zero();return this.createPickingRayToRef(a,b,c,g,d,e),g};
re$$module$libs$world_onscreen.prototype.createPickingRayToRef=function(a,b,c,d,e,g=!1,n=!1){const t=this.getEngine();if(!e){if(!this.activeCamera)return this;e=this.activeCamera}const w=e.viewport.toGlobal(t.getRenderWidth(),t.getRenderHeight());return a=a/t.getHardwareScalingLevel()-w.x,b=b/t.getHardwareScalingLevel()-(t.getRenderHeight()-w.y-w.height),d.update(a,b,w.width,w.height,c||x$$module$libs$world_onscreen.IdentityReadOnly,g?x$$module$libs$world_onscreen.IdentityReadOnly:e.getViewMatrix(),
e.getProjectionMatrix(),n),this};re$$module$libs$world_onscreen.prototype.createPickingRayInCameraSpace=function(a,b,c){const d=_e$$module$libs$world_onscreen.Zero();return this.createPickingRayInCameraSpaceToRef(a,b,d,c),d};
re$$module$libs$world_onscreen.prototype.createPickingRayInCameraSpaceToRef=function(a,b,c,d){if(!zt$$module$libs$world_onscreen)return this;const e=this.getEngine();if(!d){if(!this.activeCamera)throw Error("Active camera not set");d=this.activeCamera}const g=d.viewport.toGlobal(e.getRenderWidth(),e.getRenderHeight()),n=x$$module$libs$world_onscreen.Identity();return a=a/e.getHardwareScalingLevel()-g.x,b=b/e.getHardwareScalingLevel()-(e.getRenderHeight()-g.y-g.height),c.update(a,b,g.width,g.height,
n,n,d.getProjectionMatrix()),this};re$$module$libs$world_onscreen.prototype._internalPickForMesh=function(a,b,c,d,e,g,n,t){b=b(d,c.enableDistantPicking);c=c.intersects(b,e,n,g,d,t);return!c||!c.hit||!e&&null!=a&&c.distance>=a.distance?null:c};
re$$module$libs$world_onscreen.prototype._internalPick=function(a,b,c,d,e){let g=null;for(let w=0;w<this.meshes.length;w++){var n=this.meshes[w];if(b){if(!b(n))continue}else if(!n.isEnabled()||!n.isVisible||!n.isPickable)continue;const z=n.getWorldMatrix();if(n.hasThinInstances&&n.thinInstanceEnablePicking){var t=this._internalPickForMesh(g,a,n,z,!0,!0,e);if(t){if(d)return t;t=D$$module$libs$world_onscreen.Matrix[1];const C=n.thinInstanceGetWorldMatrices();for(let H=0;H<C.length;H++){C[H].multiplyToRef(z,
t);const M=this._internalPickForMesh(g,a,n,t,c,d,e,!0);if(M&&(g=M,g.thinInstanceIndex=H,c))return g}}}else if((n=this._internalPickForMesh(g,a,n,z,c,d,e))&&(g=n,c))return g}return g||new zt$$module$libs$world_onscreen};
re$$module$libs$world_onscreen.prototype._internalMultiPick=function(a,b,c){if(!zt$$module$libs$world_onscreen)return null;const d=[];for(let g=0;g<this.meshes.length;g++){var e=this.meshes[g];if(b){if(!b(e))continue}else if(!e.isEnabled()||!e.isVisible||!e.isPickable)continue;const n=e.getWorldMatrix();if(e.hasThinInstances&&e.thinInstanceEnablePicking){if(this._internalPickForMesh(null,a,e,n,!0,!0,c)){const t=D$$module$libs$world_onscreen.Matrix[1],w=e.thinInstanceGetWorldMatrices();for(let z=0;z<
w.length;z++){w[z].multiplyToRef(n,t);const C=this._internalPickForMesh(null,a,e,t,!1,!1,c,!0);C&&(C.thinInstanceIndex=z,d.push(C))}}}else(e=this._internalPickForMesh(null,a,e,n,!1,!1,c))&&d.push(e)}return d};
re$$module$libs$world_onscreen.prototype.pickWithBoundingInfo=function(a,b,c,d,e){if(!zt$$module$libs$world_onscreen)return null;c=this._internalPick(g=>(this._tempPickingRay||(this._tempPickingRay=_e$$module$libs$world_onscreen.Zero()),this.createPickingRayToRef(a,b,g,this._tempPickingRay,e||null),this._tempPickingRay),c,d,!0);return c&&(c.ray=this.createPickingRay(a,b,x$$module$libs$world_onscreen.Identity(),e||null)),c};
Object.defineProperty(re$$module$libs$world_onscreen.prototype,"_pickingAvailable",{get:()=>!0,enumerable:!1,configurable:!1});
re$$module$libs$world_onscreen.prototype.pick=function(a,b,c,d,e,g,n){c=this._internalPick((t,w)=>(this._tempPickingRay||(this._tempPickingRay=_e$$module$libs$world_onscreen.Zero()),this.createPickingRayToRef(a,b,t,this._tempPickingRay,e||null,!1,w),this._tempPickingRay),c,d,!1,g);return c&&(c.ray=this.createPickingRay(a,b,x$$module$libs$world_onscreen.Identity(),e||null)),c};
re$$module$libs$world_onscreen.prototype.pickWithRay=function(a,b,c,d){b=this._internalPick(e=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=x$$module$libs$world_onscreen.Identity()),e.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=_e$$module$libs$world_onscreen.Zero()),_e$$module$libs$world_onscreen.TransformToRef(a,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform),b,c,!1,d);return b&&
(b.ray=a),b};re$$module$libs$world_onscreen.prototype.multiPick=function(a,b,c,d,e){return this._internalMultiPick(g=>this.createPickingRay(a,b,g,d||null),c,e)};
re$$module$libs$world_onscreen.prototype.multiPickWithRay=function(a,b,c){return this._internalMultiPick(d=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=x$$module$libs$world_onscreen.Identity()),d.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=_e$$module$libs$world_onscreen.Zero()),_e$$module$libs$world_onscreen.TransformToRef(a,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform),b,c)};
q$$module$libs$world_onscreen.prototype.getForwardRay=function(a=100,b,c){return this.getForwardRayToRef(new _e$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Zero(),p$$module$libs$world_onscreen.Zero(),a),a,b,c)};
q$$module$libs$world_onscreen.prototype.getForwardRayToRef=function(a,b=100,c,d){return c||=this.getWorldMatrix(),a.length=b,d?a.origin.copyFrom(d):a.origin.copyFrom(this.position),D$$module$libs$world_onscreen.Vector3[2].set(0,0,this._scene.useRightHandedSystem?-1:1),p$$module$libs$world_onscreen.TransformNormalToRef(D$$module$libs$world_onscreen.Vector3[2],c,D$$module$libs$world_onscreen.Vector3[3]),p$$module$libs$world_onscreen.NormalizeToRef(D$$module$libs$world_onscreen.Vector3[3],a.direction),
a};var wl$$module$libs$world_onscreen=function(a,b,c){for(var d in b)if(a.name===b[d])return c.push(a.id),!0;return a.parentId&&-1!==c.indexOf(a.parentId)?(c.push(a.id),!0):!1},Zi$$module$libs$world_onscreen=function(a,b){return a+" of "+(b?b.file+" from "+b.name+" version: "+b.version+", exporter version: "+b.exporter_version:"unknown")};
oe$$module$libs$world_onscreen.RegisterPlugin({name:"babylon.js",extensions:".json",canDirectLoad:function(a){return-1!==a.indexOf("json"),!0},importMesh:function(a,b,c,d,e,g,n,t){g="importMesh has failed JSON parse";try{var w=JSON.parse(c);w.physicsEnabled=!1;null==w||w.meshes.map(T=>delete T.physicsImpostor);g="";var z=oe$$module$libs$world_onscreen.loggingLevel===oe$$module$libs$world_onscreen.DETAILED_LOGGING;a?Array.isArray(a)||(a=[a]):a=null;c=[];if(void 0!==w.meshes&&null!==w.meshes){var C;
var H=0;for(C=w.meshes.length;H<C;H++){var M=w.meshes[H];if(null===a||wl$$module$libs$world_onscreen(M,a,c)){null!==a&&delete a[a.indexOf(M.name)];var L=W$$module$libs$world_onscreen.Parse(M,b,d);e.push(L);g+="\n\tMesh "+L.toString(z)}}H=0;for(C=b.meshes.length;H<C;H++){var O=b.meshes[H];O._waitingParentId&&(O.parent=b.getLastEntryByID(O._waitingParentId),O._waitingParentId=null);O.computeWorldMatrix(!0)}}return!0}catch(T){var S=Zi$$module$libs$world_onscreen("importMesh",w?w.producer:"Unknown")+
g;if(t)t(S,T);else throw O$$module$libs$world_onscreen.Log(S),T;}finally{null!==g&&oe$$module$libs$world_onscreen.loggingLevel!==oe$$module$libs$world_onscreen.NO_LOGGING&&O$$module$libs$world_onscreen.Log(Zi$$module$libs$world_onscreen("importMesh",w?w.producer:"Unknown")+(oe$$module$libs$world_onscreen.loggingLevel!==oe$$module$libs$world_onscreen.MINIMAL_LOGGING?g:""))}return!1},load:function(a,b,c,d){var e="importScene has failed JSON parse";try{var g=JSON.parse(b);e="";void 0!==g.clearColor&&
null!==g.clearColor&&(a.clearColor=Color4.FromArray(g.clearColor));return!!loadAssetContainer(a,b,c,d,!0)}catch(t){var n=Zi$$module$libs$world_onscreen("importScene",g?g.producer:"Unknown")+e;if(d)d(n,t);else throw O$$module$libs$world_onscreen.Log(n),t;}finally{null!==e&&oe$$module$libs$world_onscreen.loggingLevel!==oe$$module$libs$world_onscreen.NO_LOGGING&&O$$module$libs$world_onscreen.Log(Zi$$module$libs$world_onscreen("importScene",g?g.producer:"Unknown")+(oe$$module$libs$world_onscreen.loggingLevel!==
oe$$module$libs$world_onscreen.MINIMAL_LOGGING?e:""))}return!1},loadAssetContainer:function(a,b,c,d){return loadAssetContainer(a,b,c,d)}});W$$module$libs$world_onscreen._instancedMeshFactory=(a,b)=>{a=new Ol$$module$libs$world_onscreen(a,b);if(b.instancedBuffers){a.instancedBuffers={};for(const c in b.instancedBuffers)a.instancedBuffers[c]=b.instancedBuffers[c]}return a};
class Ol$$module$libs$world_onscreen extends ot$$module$libs$world_onscreen{constructor(a,b){super(a,b.getScene());this._indexInSourceMeshInstanceArray=-1;this._distanceToCamera=0;b.addInstance(this);this._sourceMesh=b;this._unIndexed=b._unIndexed;this.position.copyFrom(b.position);this.rotation.copyFrom(b.rotation);this.scaling.copyFrom(b.scaling);b.rotationQuaternion&&(this.rotationQuaternion=b.rotationQuaternion.clone());this.animations=b.animations.slice();for(const c of b.getAnimationRanges())null!=
c&&this.createAnimationRange(c.name,c.from,c.to);this.infiniteDistance=b.infiniteDistance;this.setPivotMatrix(b.getPivotMatrix());this.refreshBoundingInfo(!0,!0);this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}get material(){return this._sourceMesh.material}get visibility(){return this._sourceMesh.visibility}get skeleton(){return this._sourceMesh.skeleton}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(a){!this._sourceMesh||
a===this._sourceMesh.renderingGroupId||O$$module$libs$world_onscreen.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}createInstance(a){return this._sourceMesh.createInstance(a)}isReady(a=!1){return this._sourceMesh.isReady(a,!0)}getVerticesData(a,b){return this._sourceMesh.getVerticesData(a,
b)}setVerticesData(a,b,c,d){return this.sourceMesh&&this.sourceMesh.setVerticesData(a,b,c,d),this.sourceMesh}updateVerticesData(a,b,c,d){return this.sourceMesh&&this.sourceMesh.updateVerticesData(a,b,c,d),this.sourceMesh}setIndices(a,b=null){return this.sourceMesh&&this.sourceMesh.setIndices(a,b),this.sourceMesh}isVerticesDataPresent(a){return this._sourceMesh.isVerticesDataPresent(a)}getIndices(){return this._sourceMesh.getIndices()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(a=
!1,b=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;const c=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(a,b),c),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(a,b){if(super._activate(a,b),this._sourceMesh.subMeshes||O$$module$libs$world_onscreen.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(0<=
this._currentLOD._getWorldMatrixDeterminant()!=0<=this._getWorldMatrixDeterminant())return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,a),b){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=
!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&
this._currentLOD.billboardMode!==Q$$module$libs$world_onscreen.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new x$$module$libs$world_onscreen);const a=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,D$$module$libs$world_onscreen.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(D$$module$libs$world_onscreen.Vector3[7]),
this._currentLOD._masterMesh=a,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(a){if(!a)return this;var b=this.sourceMesh.getLODLevels();b&&0!==b.length?(b=this.getBoundingInfo(),this._currentLOD=this.sourceMesh.getLOD(a,b.boundingSphere)):this._currentLOD=this.sourceMesh;return this._currentLOD}_preActivateForIntermediateRendering(a){return this.sourceMesh._preActivateForIntermediateRendering(a)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(let a=
0;a<this._sourceMesh.subMeshes.length;a++)this._sourceMesh.subMeshes[a].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}_updateBoundingInfo(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(a,b=null,c,d){a=(d||this._sourceMesh).createInstance(a);
if(Us$$module$libs$world_onscreen.DeepCopy(this,a,"name subMeshes uniqueId parent lightSources receiveShadows material visibility skeleton sourceMesh isAnInstance facetNb isFacetDataEnabled isBlocked useBones hasInstances collider edgesRenderer forward up right absolutePosition absoluteScaling absoluteRotationQuaternion isWorldMatrixFrozen nonUniformScaling behaviors worldMatrixFromCache hasThinInstances hasBoundingInfo".split(" "),[]),this.refreshBoundingInfo(),b&&(a.parent=b),!c)for(b=0;b<this.getScene().meshes.length;b++)c=
this.getScene().meshes[b],c.parent===this&&c.clone(c.name,a);return a.computeWorldMatrix(!0),this.onClonedObservable.notifyObservers(a),a}dispose(a,b=!1){this._sourceMesh.removeInstance(this);super.dispose(a,b)}_serializeAsParent(a){super._serializeAsParent(a);a.parentId=this._sourceMesh.uniqueId;a.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(a=null,b,c){(a=this.clone("Clone of "+(this.name||this.id),a||this.parent,!0,b&&b.newSourcedMesh))&&c&&c(this,a);for(const d of this.getChildTransformNodes(!0))d.instantiateHierarchy(a,
b,c);return a}}
W$$module$libs$world_onscreen.prototype.registerInstancedBuffer=function(a,b){var c,d;if(null===(d=null===(c=this._userInstancedBuffersStorage)||void 0===c?void 0:c.vertexBuffers[a])||void 0===d||d.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const e of this.instances)e.instancedBuffers={};this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0})}this.instancedBuffers[a]=
null;this._userInstancedBuffersStorage.strides[a]=b;this._userInstancedBuffersStorage.sizes[a]=32*b;this._userInstancedBuffersStorage.data[a]=new Float32Array(this._userInstancedBuffersStorage.sizes[a]);this._userInstancedBuffersStorage.vertexBuffers[a]=new g$$module$libs$world_onscreen(this.getEngine(),this._userInstancedBuffersStorage.data[a],a,!0,!1,b,!0);for(const e of this.instances)e.instancedBuffers[a]=null;this._invalidateInstanceVertexArrayObject();this._markSubMeshesAsAttributesDirty()};
W$$module$libs$world_onscreen.prototype._processInstancedBuffers=function(a,b){const c=a?a.length:0;for(const n in this.instancedBuffers){var d=this._userInstancedBuffersStorage.sizes[n];const t=this._userInstancedBuffersStorage.strides[n];for(var e=(c+1)*t;d<e;)d*=2;this._userInstancedBuffersStorage.data[n].length!=d&&(this._userInstancedBuffersStorage.data[n]=new Float32Array(d),this._userInstancedBuffersStorage.sizes[n]=d,this._userInstancedBuffersStorage.vertexBuffers[n]&&(this._userInstancedBuffersStorage.vertexBuffers[n].dispose(),
this._userInstancedBuffersStorage.vertexBuffers[n]=null));d=this._userInstancedBuffersStorage.data[n];e=0;if(b){var g=this.instancedBuffers[n];g.toArray?g.toArray(d,e):g.copyToArray?g.copyToArray(d,e):d[e]=g;e+=t}for(g=0;g<c;g++){const w=a[g].instancedBuffers[n];w.toArray?w.toArray(d,e):w.copyToArray?w.copyToArray(d,e):d[e]=w;e+=t}this._userInstancedBuffersStorage.vertexBuffers[n]?this._userInstancedBuffersStorage.vertexBuffers[n].updateDirectly(d,0):(this._userInstancedBuffersStorage.vertexBuffers[n]=
new g$$module$libs$world_onscreen(this.getEngine(),this._userInstancedBuffersStorage.data[n],n,!0,!1,t,!0),this._invalidateInstanceVertexArrayObject())}};
W$$module$libs$world_onscreen.prototype._invalidateInstanceVertexArrayObject=function(){if(this._userInstancedBuffersStorage&&void 0!==this._userInstancedBuffersStorage.vertexArrayObjects){for(const a in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[a]);this._userInstancedBuffersStorage.vertexArrayObjects={}}};
W$$module$libs$world_onscreen.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const a in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[a]&&this._userInstancedBuffersStorage.vertexBuffers[a].dispose();this._invalidateInstanceVertexArrayObject();this.instancedBuffers={}};
const Ll$$module$libs$world_onscreen={assetPath:"",enableShadows:!1,groupId:null,id:null,lights:[],rollId:null,scene:null},Nt$$module$libs$world_onscreen=class{constructor(a,b){gt$$module$libs$world_onscreen(this,"value",0);gt$$module$libs$world_onscreen(this,"asleep",!1);this.config={...Ll$$module$libs$world_onscreen,...a};this.id=void 0!==this.config.id?this.config.id:Date.now();this.sides=this.config.sides;this.dieType=this.config.dieType;this.comboKey=`${this.config.theme}_${this.config.dieType}`;
this.scene=b;this.createInstance()}createInstance(){var a=`${this.config.meshName}_${this.dieType}_${this.config.theme}${this.config.colorSuffix}`,b=`${a}-instance-${this.id}`;a=this.scene.getMeshByName(a).createInstance(b);0<this.config.colorSuffix.length&&(b=se$$module$libs$world_onscreen.FromHexString(this.config.themeColor),a.instancedBuffers.customColor=b);a.position.y=-100;a.scaling=new p$$module$libs$world_onscreen(a.scaling.x*this.config.scale,a.scaling.y*this.config.scale,a.scaling.z*this.config.scale);
this.config.enableShadows&&this.config.lights.directional.shadowGenerator.addShadowCaster(a);this.mesh=a}static async loadDie(a,b){const {sides:c,theme:d="default",meshName:e,colorSuffix:g}=a;a.dieType||(a.dieType=Number.isInteger(c)?`d${c}`:c);const n=e+"_"+a.dieType,t=n+"_"+d+g;let w=b.getMeshByName(t);return w||=b.getMeshByName(n).clone(t),w.material||(w.material=b.getMaterialByName(d+g),0<g.length&&w.registerInstancedBuffer("customColor",3)),a}static async loadModels(a,b){const {meshFilePath:c,
meshName:d,d4FaceDown:e=!0}=a;let g=!1,n=!1;const t=await fetch(`${c}`).then(w=>{if(w.ok){const z=w.headers.get("content-type");if(z&&-1!==z.indexOf("application/json")||w.type&&"basic"===w.type)return w.json();throw Error(`Incorrect contentType: ${z}. Expected "application/json" or "basic"`);}throw Error(`Unable to load 3D mesh file: '${c}'. Request rejected with status ${w.status}: ${w.statusText}`);}).catch(w=>console.error(w));if(t)return oe$$module$libs$world_onscreen.ImportMeshAsync(null,null,
"data:"+JSON.stringify(t),b).then(w=>{if(w.meshes.forEach(z=>{"__root__"===z.name&&z.dispose();z.name.includes("collider")&&(z.scaling=new p$$module$libs$world_onscreen(.9*z.scaling.x,.9*z.scaling.y,.9*z.scaling.z));g||="d100"===z.name;n||="d10"===z.name;z.setEnabled(!1);z.freezeNormals();z.freezeWorldMatrix();z.isPickable=!1;z.doNotSyncBoundingInfo=!0;z.name=d+"_"+z.name}),!g&&n&&(b.getMeshByName(d+"_d10").clone(d+"_d100"),b.getMeshByName(d+"_d10_collider").clone(d+"_d100_collider"),t.colliderFaceMap&&
(t.colliderFaceMap.d100=Jl$$module$libs$dice_box_es(t.colliderFaceMap.d10),Object.values(t.colliderFaceMap.d100).forEach((z,C)=>{t.colliderFaceMap.d100[C]=z*(10===z?0:10)}))),!t.colliderFaceMap)throw Error(`'colliderFaceMap' data not found in ${c}. Without the colliderFaceMap data dice values can not be resolved.`);b.themeData[d]={};b.themeData[d].colliderFaceMap=t.colliderFaceMap;b.themeData[d].d4FaceDown=e}).catch(w=>console.error(w)),t.meshes.filter(w=>w.name.includes("collider"))}updateConfig(a){this.config=
{...this.config,...a}}static setVector3(a,b,c){return Nt$$module$libs$world_onscreen.vector3.set(a,b,c)}static getVector3(){return Nt$$module$libs$world_onscreen.vector3}static async getRollResult(a,b){const c=(d=a)=>(new Promise((e,g)=>{var n=a.config.parentMesh||a.config.meshName;g=b.themeData[n].colliderFaceMap;var t=b.themeData[n].d4FaceDown;if(!g[d.dieType])throw Error(`No colliderFaceMap data for ${d.dieType}`);n=b.getMeshByName(`${n}_${d.dieType}_collider`).createInstance(`${n}_${d.dieType}-hitbox-${d.id}`);
n.isPickable=!0;n.isVisible=!0;n.setEnabled(!0);n.position=d.mesh.position;n.rotationQuaternion=d.mesh.rotationQuaternion;let w=Nt$$module$libs$world_onscreen.setVector3(0,1,0);"d4"===d.dieType&&t&&(w=Nt$$module$libs$world_onscreen.setVector3(0,-1,0));Nt$$module$libs$world_onscreen.ray.direction=w;Nt$$module$libs$world_onscreen.ray.origin=a.mesh.position;t=b.pickWithRay(Nt$$module$libs$world_onscreen.ray);if(n.dispose(),d.value=g[d.dieType][t.faceId],void 0===d.value)throw Error(`colliderFaceMap Error: No value found for ${d.dieType} mesh face ${t.faceId}`);
return e(d.value)})).catch(e=>console.error(e));return a.mesh?await c():a.value}};let Rt$$module$libs$world_onscreen=Nt$$module$libs$world_onscreen;gt$$module$libs$world_onscreen(Rt$$module$libs$world_onscreen,"ray",new _e$$module$libs$world_onscreen(p$$module$libs$world_onscreen.Zero(),p$$module$libs$world_onscreen.Zero(),1));gt$$module$libs$world_onscreen(Rt$$module$libs$world_onscreen,"vector3",p$$module$libs$world_onscreen.Zero());class Nl$$module$libs$world_onscreen{constructor(){}}
class ei$$module$libs$world_onscreen extends N$$module$libs$world_onscreen{constructor(a,b){super(a,b);this.CustomParts=new Nl$$module$libs$world_onscreen;this.customShaderNameResolve=this.Builder;this.FragmentShader=De$$module$libs$world_onscreen.ShadersStore.defaultPixelShader;this.VertexShader=De$$module$libs$world_onscreen.ShadersStore.defaultVertexShader}AttachAfterBind(a,b){if(this._newUniformInstances)for(var c in this._newUniformInstances)a=c.toString().split("-"),"vec2"==a[0]?b.setVector2(a[1],
this._newUniformInstances[c]):"vec3"==a[0]?b.setVector3(a[1],this._newUniformInstances[c]):"vec4"==a[0]?b.setVector4(a[1],this._newUniformInstances[c]):"mat4"==a[0]?b.setMatrix(a[1],this._newUniformInstances[c]):"float"==a[0]&&b.setFloat(a[1],this._newUniformInstances[c]);if(this._newSamplerInstances)for(const d in this._newSamplerInstances)c=d.toString().split("-"),"sampler2D"==c[0]&&this._newSamplerInstances[d].isReady&&this._newSamplerInstances[d].isReady()&&b.setTexture(c[1],this._newSamplerInstances[d])}ReviewUniform(a,
b){if("uniform"==a&&this._newUniforms)for(let c=0;c<this._newUniforms.length;c++)-1==this._customUniform[c].indexOf("sampler")&&b.push(this._newUniforms[c]);if("sampler"==a&&this._newUniforms)for(a=0;a<this._newUniforms.length;a++)-1!=this._customUniform[a].indexOf("sampler")&&b.push(this._newUniforms[a]);return b}Builder(a,b,c,d,e,g){if(g&&this._customAttributes&&0<this._customAttributes.length&&g.push(...this._customAttributes),this.ReviewUniform("uniform",b),this.ReviewUniform("sampler",d),this._isCreatedShader)return this._createdShaderName;
this._isCreatedShader=!1;ei$$module$libs$world_onscreen.ShaderIndexer++;a="custom_"+ei$$module$libs$world_onscreen.ShaderIndexer;const n=this._afterBind.bind(this);return this._afterBind=(t,w)=>{if(w){this.AttachAfterBind(t,w);try{n(t,w)}catch{}}},De$$module$libs$world_onscreen.ShadersStore[a+"VertexShader"]=this.VertexShader.replace("#define CUSTOM_VERTEX_BEGIN",this.CustomParts.Vertex_Begin?this.CustomParts.Vertex_Begin:"").replace("#define CUSTOM_VERTEX_DEFINITIONS",(this._customUniform?this._customUniform.join("\n"):
"")+(this.CustomParts.Vertex_Definitions?this.CustomParts.Vertex_Definitions:"")).replace("#define CUSTOM_VERTEX_MAIN_BEGIN",this.CustomParts.Vertex_MainBegin?this.CustomParts.Vertex_MainBegin:"").replace("#define CUSTOM_VERTEX_UPDATE_POSITION",this.CustomParts.Vertex_Before_PositionUpdated?this.CustomParts.Vertex_Before_PositionUpdated:"").replace("#define CUSTOM_VERTEX_UPDATE_NORMAL",this.CustomParts.Vertex_Before_NormalUpdated?this.CustomParts.Vertex_Before_NormalUpdated:"").replace("#define CUSTOM_VERTEX_MAIN_END",
this.CustomParts.Vertex_MainEnd?this.CustomParts.Vertex_MainEnd:""),this.CustomParts.Vertex_After_WorldPosComputed&&(De$$module$libs$world_onscreen.ShadersStore[a+"VertexShader"]=De$$module$libs$world_onscreen.ShadersStore[a+"VertexShader"].replace("#define CUSTOM_VERTEX_UPDATE_WORLDPOS",this.CustomParts.Vertex_After_WorldPosComputed)),De$$module$libs$world_onscreen.ShadersStore[a+"PixelShader"]=this.FragmentShader.replace("#define CUSTOM_FRAGMENT_BEGIN",this.CustomParts.Fragment_Begin?this.CustomParts.Fragment_Begin:
"").replace("#define CUSTOM_FRAGMENT_MAIN_BEGIN",this.CustomParts.Fragment_MainBegin?this.CustomParts.Fragment_MainBegin:"").replace("#define CUSTOM_FRAGMENT_DEFINITIONS",(this._customUniform?this._customUniform.join("\n"):"")+(this.CustomParts.Fragment_Definitions?this.CustomParts.Fragment_Definitions:"")).replace("#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE",this.CustomParts.Fragment_Custom_Diffuse?this.CustomParts.Fragment_Custom_Diffuse:"").replace("#define CUSTOM_FRAGMENT_UPDATE_ALPHA",this.CustomParts.Fragment_Custom_Alpha?
this.CustomParts.Fragment_Custom_Alpha:"").replace("#define CUSTOM_FRAGMENT_BEFORE_LIGHTS",this.CustomParts.Fragment_Before_Lights?this.CustomParts.Fragment_Before_Lights:"").replace("#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR",this.CustomParts.Fragment_Before_FragColor?this.CustomParts.Fragment_Before_FragColor:"").replace("#define CUSTOM_FRAGMENT_MAIN_END",this.CustomParts.Fragment_MainEnd?this.CustomParts.Fragment_MainEnd:""),this.CustomParts.Fragment_Before_Fog&&(De$$module$libs$world_onscreen.ShadersStore[a+
"PixelShader"]=De$$module$libs$world_onscreen.ShadersStore[a+"PixelShader"].replace("#define CUSTOM_FRAGMENT_BEFORE_FOG",this.CustomParts.Fragment_Before_Fog)),this._isCreatedShader=!0,this._createdShaderName=a,a}AddUniform(a,b,c){return this._customUniform||(this._customUniform=[],this._newUniforms=[],this._newSamplerInstances={},this._newUniformInstances={}),c&&(-1!=b.indexOf("sampler")?this._newSamplerInstances[b+"-"+a]=c:this._newUniformInstances[b+"-"+a]=c),this._customUniform.push("uniform "+
b+" "+a+";"),this._newUniforms.push(a),this}AddAttribute(a){return this._customAttributes||(this._customAttributes=[]),this._customAttributes.push(a),this}Fragment_Begin(a){return this.CustomParts.Fragment_Begin=a,this}Fragment_Definitions(a){return this.CustomParts.Fragment_Definitions=a,this}Fragment_MainBegin(a){return this.CustomParts.Fragment_MainBegin=a,this}Fragment_MainEnd(a){return this.CustomParts.Fragment_MainEnd=a,this}Fragment_Custom_Diffuse(a){return this.CustomParts.Fragment_Custom_Diffuse=
a.replace("result","diffuseColor"),this}Fragment_Custom_Alpha(a){return this.CustomParts.Fragment_Custom_Alpha=a.replace("result","alpha"),this}Fragment_Before_Lights(a){return this.CustomParts.Fragment_Before_Lights=a,this}Fragment_Before_Fog(a){return this.CustomParts.Fragment_Before_Fog=a,this}Fragment_Before_FragColor(a){return this.CustomParts.Fragment_Before_FragColor=a.replace("result","color"),this}Vertex_Begin(a){return this.CustomParts.Vertex_Begin=a,this}Vertex_Definitions(a){return this.CustomParts.Vertex_Definitions=
a,this}Vertex_MainBegin(a){return this.CustomParts.Vertex_MainBegin=a,this}Vertex_Before_PositionUpdated(a){return this.CustomParts.Vertex_Before_PositionUpdated=a.replace("result","positionUpdated"),this}Vertex_Before_NormalUpdated(a){return this.CustomParts.Vertex_Before_NormalUpdated=a.replace("result","normalUpdated"),this}Vertex_After_WorldPosComputed(a){return this.CustomParts.Vertex_After_WorldPosComputed=a,this}Vertex_MainEnd(a){return this.CustomParts.Vertex_MainEnd=a,this}}
ei$$module$libs$world_onscreen.ShaderIndexer=1;st$$module$libs$world_onscreen("BABYLON.CustomMaterial",ei$$module$libs$world_onscreen);
ei$$module$libs$world_onscreen.prototype.clone=function(a){const b=ae$$module$libs$world_onscreen.Clone(()=>new ei$$module$libs$world_onscreen(a,this.getScene()),this);return b.name=a,b.id=a,b.CustomParts.Fragment_Begin=this.CustomParts.Fragment_Begin,b.CustomParts.Fragment_Definitions=this.CustomParts.Fragment_Definitions,b.CustomParts.Fragment_MainBegin=this.CustomParts.Fragment_MainBegin,b.CustomParts.Fragment_Custom_Diffuse=this.CustomParts.Fragment_Custom_Diffuse,b.CustomParts.Fragment_Before_Lights=
this.CustomParts.Fragment_Before_Lights,b.CustomParts.Fragment_Before_Fog=this.CustomParts.Fragment_Before_Fog,b.CustomParts.Fragment_Custom_Alpha=this.CustomParts.Fragment_Custom_Alpha,b.CustomParts.Fragment_Before_FragColor=this.CustomParts.Fragment_Before_FragColor,b.CustomParts.Vertex_Begin=this.CustomParts.Vertex_Begin,b.CustomParts.Vertex_Definitions=this.CustomParts.Vertex_Definitions,b.CustomParts.Vertex_MainBegin=this.CustomParts.Vertex_MainBegin,b.CustomParts.Vertex_Before_PositionUpdated=
this.CustomParts.Vertex_Before_PositionUpdated,b.CustomParts.Vertex_Before_NormalUpdated=this.CustomParts.Vertex_Before_NormalUpdated,b.CustomParts.Vertex_After_WorldPosComputed=this.CustomParts.Vertex_After_WorldPosComputed,b.CustomParts.Vertex_MainEnd=this.CustomParts.Vertex_MainEnd,b};
class Bl$$module$libs$world_onscreen{constructor(a){gt$$module$libs$world_onscreen(this,"loadedThemes",{});gt$$module$libs$world_onscreen(this,"themeData",{});this.scene=a.scene}async loadStandardMaterial(a){const {theme:b,material:c}=a,d=new N$$module$libs$world_onscreen(b,this.scene);c.diffuseTexture&&(d.diffuseTexture=await this.getTexture("diffuse",a));c.bumpTexture&&(d.bumpTexture=await this.getTexture("bump",a));c.specularTexture&&(d.specularTexture=await this.getTexture("specular",a));d.allowShaderHotSwapping=
!1}async loadColorMaterial(a){const {theme:b,material:c}=a;var d=new ei$$module$libs$world_onscreen(b+"_light",this.scene);const e=Jl$$module$libs$dice_box_es(a);c.diffuseTexture&&c.diffuseTexture.light&&(e.material.diffuseTexture=a.material.diffuseTexture.light,d.diffuseTexture=await this.getTexture("diffuse",e));c.bumpTexture&&(d.bumpTexture=await this.getTexture("bump",a));c.specularTexture&&(d.specularTexture=await this.getTexture("specular",a));d.allowShaderHotSwapping=!1;d.Vertex_Definitions("\n      attribute vec3 customColor;\n      varying vec3 vColor;\n    ").Vertex_MainEnd("\n      vColor = customColor;\n    ").Fragment_Definitions("\n      varying vec3 vColor;\n    ").Fragment_Custom_Diffuse("\n      baseColor.rgb = mix(vColor.rgb, baseColor.rgb, baseColor.a);\n    ");
d.AddAttribute("customColor");d=d.clone(b+"_dark");c.diffuseTexture&&c.diffuseTexture.dark&&(e.material.diffuseTexture=a.material.diffuseTexture.dark,d.diffuseTexture=await this.getTexture("diffuse",e));d.AddAttribute("customColor")}async getTexture(a,b){const {basePath:c,material:d,theme:e}=b;let g;b=a+"Level";const n=a+"Texture";try{switch(a){case "diffuse":g=await this.importTextureAsync(`${c}/${d[n]}`,e);d[b]&&(g.level=d[b]);break;case "bump":g=await this.importTextureAsync(`${c}/${d[n]}`,e);
d[b]&&(g.level=d[b]);break;case "specular":g=await this.importTextureAsync(`${c}/${d[n]}`,e);d.specularPower&&(g.specularPower=d.specularPower);break;default:throw Error(`Texture type: ${a} is not supported`);}}catch(t){console.error(t)}return g}async importTextureAsync(a,b){return(new Promise((c,d)=>{let e=a.match(/^(.*\/)(.*)$/),g=new B$$module$libs$world_onscreen(a,this.scene,void 0,!0,void 0,()=>c(g),()=>d(`Unable to load texture '${e[2]}' for theme: '${b}'. Check that your assetPath is configured correctly and that the files exist at path: '${e[1]}'`))})).catch(c=>
console.error(c))}async load(a){const {material:b}=a;"color"===b.type?await this.loadColorMaterial(a):"standard"===b.type?await this.loadStandardMaterial(a):console.error(`Material type: ${b.type} not supported`)}}
var Ve$$module$libs$world_onscreen,Si$$module$libs$world_onscreen,At$$module$libs$world_onscreen,xi$$module$libs$world_onscreen,bt$$module$libs$world_onscreen,pt$$module$libs$world_onscreen,qe$$module$libs$world_onscreen,rs$$module$libs$world_onscreen,St$$module$libs$world_onscreen,Ni$$module$libs$world_onscreen,Bi$$module$libs$world_onscreen,lt$$module$libs$world_onscreen,Ui$$module$libs$world_onscreen,ns$$module$libs$world_onscreen,zr$$module$libs$world_onscreen;
class Wl$$module$libs$world_onscreen{constructor(a){et$$module$libs$world_onscreen(this,ns$$module$libs$world_onscreen);gt$$module$libs$world_onscreen(this,"config");gt$$module$libs$world_onscreen(this,"initialized",!1);et$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen,{});et$$module$libs$world_onscreen(this,Si$$module$libs$world_onscreen,0);et$$module$libs$world_onscreen(this,At$$module$libs$world_onscreen,0);et$$module$libs$world_onscreen(this,xi$$module$libs$world_onscreen,[]);
et$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,rs$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,Ni$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,Bi$$module$libs$world_onscreen,
void 0);et$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen,void 0);et$$module$libs$world_onscreen(this,Ui$$module$libs$world_onscreen,{});gt$$module$libs$world_onscreen(this,"noop",()=>{});gt$$module$libs$world_onscreen(this,"diceBufferView",new Float32Array(8E3));this.onInitComplete=a.onInitComplete||this.noop;this.onThemeLoaded=a.onThemeLoaded||this.noop;this.onRollResult=a.onRollResult||this.noop;this.onRollComplete=a.onRollComplete||this.noop;this.onDieRemoved=a.onDieRemoved||
this.noop;this.initialized=this.initScene(a)}async initScene(a){nt$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen,a.canvas);K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen).width=a.width;K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen).height=a.height;this.config=a.options;nt$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen,En$$module$libs$world_onscreen(K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen)));nt$$module$libs$world_onscreen(this,
qe$$module$libs$world_onscreen,$n$$module$libs$world_onscreen({engine:K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen)}));nt$$module$libs$world_onscreen(this,rs$$module$libs$world_onscreen,Qn$$module$libs$world_onscreen({engine:K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen),scene:K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)}));nt$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen,Er$$module$libs$world_onscreen({enableShadows:this.config.enableShadows,
shadowTransparency:this.config.shadowTransparency,intensity:this.config.lightIntensity,scene:K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)}));nt$$module$libs$world_onscreen(this,Ni$$module$libs$world_onscreen,new Fl$$module$libs$world_onscreen({enableShadows:this.config.enableShadows,aspect:K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen).width/K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen).height,lights:K$$module$libs$world_onscreen(this,
St$$module$libs$world_onscreen),scene:K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)}));nt$$module$libs$world_onscreen(this,Bi$$module$libs$world_onscreen,new Bl$$module$libs$world_onscreen({scene:K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)}));this.onInitComplete()}connect(a){nt$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen,a);K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"initBuffer",diceBuffer:this.diceBufferView.buffer},
[this.diceBufferView.buffer]);K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).onmessage=b=>{switch(b.data.action){case "updates":this.updatesFromPhysics(b.data.diceBuffer);break;default:console.error("action from physicsWorker not found in offscreen worker")}}}updateConfig(a){const b=this.config;this.config=a;b.enableShadows!==this.config.enableShadows&&(Object.values(K$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen)).forEach(c=>c.dispose()),nt$$module$libs$world_onscreen(this,
St$$module$libs$world_onscreen,Er$$module$libs$world_onscreen({enableShadows:this.config.enableShadows})));b.scale!==this.config.scale&&Object.values(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)).forEach(({mesh:c})=>{c&&(c.scaling=new p$$module$libs$world_onscreen(this.config.scale,this.config.scale,this.config.scale))});b.shadowTransparency!==this.config.shadowTransparency&&(K$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen).directional.shadowGenerator.darkness=
this.config.shadowTransparency);b.lightIntensity!==this.config.lightIntensity&&(K$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen).directional.intensity=.65*this.config.lightIntensity,K$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen).hemispheric.intensity=.4*this.config.lightIntensity)}render(a){K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen).runRenderLoop(this.renderLoop.bind(this));K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"resumeSimulation",
newStartPoint:a})}renderLoop(){K$$module$libs$world_onscreen(this,At$$module$libs$world_onscreen)&&K$$module$libs$world_onscreen(this,At$$module$libs$world_onscreen)===Object.keys(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)).length?(K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen).stopRenderLoop(),K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"stopSimulation"}),this.onRollComplete()):K$$module$libs$world_onscreen(this,
qe$$module$libs$world_onscreen).render()}async loadTheme(a){const {theme:b,basePath:c,material:d,meshFilePath:e,meshName:g}=a;if(await K$$module$libs$world_onscreen(this,Bi$$module$libs$world_onscreen).load({theme:b,basePath:c,material:d}),!Object.keys(K$$module$libs$world_onscreen(this,Ui$$module$libs$world_onscreen)).includes(g)){K$$module$libs$world_onscreen(this,Ui$$module$libs$world_onscreen)[g]=e;a=await Rt$$module$libs$world_onscreen.loadModels({meshFilePath:e,meshName:g},K$$module$libs$world_onscreen(this,
qe$$module$libs$world_onscreen));if(!a)throw Error("No colliders returned from the 3D mesh file. Low poly colliders are expected to be in the same file as the high poly dice and the mesh name contains the word 'collider'");K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"loadModels",options:{colliders:a,meshName:g}})}this.onThemeLoaded({id:b})}clear(){!Object.keys(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)).length&&!K$$module$libs$world_onscreen(this,
At$$module$libs$world_onscreen)||(this.diceBufferView.byteLength&&this.diceBufferView.fill(0),K$$module$libs$world_onscreen(this,xi$$module$libs$world_onscreen).forEach(a=>clearTimeout(a)),K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen).stopRenderLoop(),Object.values(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)).forEach(a=>{a.mesh&&a.mesh.dispose()}),nt$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen,{}),nt$$module$libs$world_onscreen(this,
Si$$module$libs$world_onscreen,0),nt$$module$libs$world_onscreen(this,At$$module$libs$world_onscreen,0),K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen).render())}add(a){Rt$$module$libs$world_onscreen.loadDie(a,K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)).then(b=>{K$$module$libs$world_onscreen(this,xi$$module$libs$world_onscreen).push(setTimeout(()=>{js$$module$libs$world_onscreen(this,ns$$module$libs$world_onscreen,zr$$module$libs$world_onscreen).call(this,
b)},_i$$module$libs$world_onscreen(this,Si$$module$libs$world_onscreen)._++*this.config.delay))})}addNonDie(a){0===K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen).activeRenderLoops.length&&this.render(!1);const {id:b,value:c,...d}=a,e={id:b,value:c,config:d};K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[b]=e;setTimeout(()=>{K$$module$libs$world_onscreen(this,xi$$module$libs$world_onscreen).push(setTimeout(()=>{this.handleAsleep(e)},_i$$module$libs$world_onscreen(this,
Si$$module$libs$world_onscreen)._++*this.config.delay))},10)}remove(a){const b=K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[a.id];b.hasOwnProperty("d10Instance")&&(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[b.d10Instance.id].mesh&&(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[b.d10Instance.id].mesh.dispose(),K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"removeDie",id:b.d10Instance.id})),delete K$$module$libs$world_onscreen(this,
Ve$$module$libs$world_onscreen)[b.d10Instance.id],_i$$module$libs$world_onscreen(this,At$$module$libs$world_onscreen)._--);K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[a.id].mesh&&K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[a.id].mesh.dispose();delete K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[a.id];_i$$module$libs$world_onscreen(this,At$$module$libs$world_onscreen)._--;K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen).render();
this.onDieRemoved(a.rollId)}updatesFromPhysics(a){this.diceBufferView=new Float32Array(a);a=1;for(let b=0,c=this.diceBufferView[0];b<c;b++){if(!Object.keys(K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)).length)continue;const d=K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[`${this.diceBufferView[a]}`];if(!d){console.log("Error: die not available in scene to animate");break}if(-1===this.diceBufferView[a+1])this.handleAsleep(d);else{const e=this.diceBufferView[a+
4],g=this.diceBufferView[a+5],n=this.diceBufferView[a+6],t=this.diceBufferView[a+7];d.mesh.position.set(this.diceBufferView[a+1],this.diceBufferView[a+2],this.diceBufferView[a+3]);d.mesh.rotationQuaternion.set(e,g,n,t)}a+=8}requestAnimationFrame(()=>{K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"stepSimulation",diceBuffer:this.diceBufferView.buffer},[this.diceBufferView.buffer])})}async handleAsleep(a){var b,c;if(a.asleep=!0,await Rt$$module$libs$world_onscreen.getRollResult(a,
K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)),a.d10Instance||a.dieParent){if(null!=(b=null==a?void 0:a.d10Instance)&&b.asleep||null!=(c=null==a?void 0:a.dieParent)&&c.asleep)b=100===a.config.sides?a:a.dieParent,a=10===a.config.sides?a:a.d10Instance,0===a.value&&0===b.value?b.value=100:b.value+=a.value,this.onRollResult({rollId:b.config.rollId,value:b.value})}else 10===a.config.sides&&0===a.value&&(a.value=10),this.onRollResult({rollId:a.config.rollId,value:a.value});_i$$module$libs$world_onscreen(this,
At$$module$libs$world_onscreen)._++}resize(a){const b=K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen).width=a.width;a=K$$module$libs$world_onscreen(this,bt$$module$libs$world_onscreen).height=a.height;K$$module$libs$world_onscreen(this,Ni$$module$libs$world_onscreen).create({aspect:b/a});K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen).resize()}}Ve$$module$libs$world_onscreen=new WeakMap;Si$$module$libs$world_onscreen=new WeakMap;
At$$module$libs$world_onscreen=new WeakMap;xi$$module$libs$world_onscreen=new WeakMap;bt$$module$libs$world_onscreen=new WeakMap;pt$$module$libs$world_onscreen=new WeakMap;qe$$module$libs$world_onscreen=new WeakMap;rs$$module$libs$world_onscreen=new WeakMap;St$$module$libs$world_onscreen=new WeakMap;Ni$$module$libs$world_onscreen=new WeakMap;Bi$$module$libs$world_onscreen=new WeakMap;lt$$module$libs$world_onscreen=new WeakMap;Ui$$module$libs$world_onscreen=new WeakMap;
ns$$module$libs$world_onscreen=new WeakSet;
zr$$module$libs$world_onscreen=async function(a){0===K$$module$libs$world_onscreen(this,pt$$module$libs$world_onscreen).activeRenderLoops.length&&this.render(a.newStartPoint);const b={...a,assetPath:this.config.assetPath,enableShadows:this.config.enableShadows,scale:this.config.scale,lights:K$$module$libs$world_onscreen(this,St$$module$libs$world_onscreen)},c=new Rt$$module$libs$world_onscreen(b,K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen));return K$$module$libs$world_onscreen(this,
Ve$$module$libs$world_onscreen)[c.id]=c,K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"addDie",options:{sides:a.sides,scale:this.config.scale,id:c.id,newStartPoint:a.newStartPoint,theme:a.theme,meshName:a.meshName}}),100===a.sides&&"single"!==a.data&&(c.d10Instance=await Rt$$module$libs$world_onscreen.loadDie({...b,dieType:"d10",sides:10,id:c.id+1E4},K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen)).then(d=>{d=new Rt$$module$libs$world_onscreen(d,
K$$module$libs$world_onscreen(this,qe$$module$libs$world_onscreen));return d.dieParent=c,d}),K$$module$libs$world_onscreen(this,Ve$$module$libs$world_onscreen)[`${c.d10Instance.id}`]=c.d10Instance,K$$module$libs$world_onscreen(this,lt$$module$libs$world_onscreen).postMessage({action:"addDie",options:{sides:10,scale:this.config.scale,id:c.d10Instance.id,theme:a.theme,meshName:a.meshName}})),c};var module$libs$world_onscreen={};module$libs$world_onscreen.default=Wl$$module$libs$world_onscreen;function makeHex$$module$hexpoly(a){const b=20.8*Math.cos(Math.PI/6),c=a[0]-10;a=a[1]-b/2+.16;return[[5+.1/Math.sqrt(3)+c,.1+a],[15-.1/Math.sqrt(3)+c,.1+a],[20-2/Math.sqrt(3)*.1+c,.5*b+a],[15-.1/Math.sqrt(3)+c,b-.1+a],[5+.1/Math.sqrt(3)+c,b-.1+a],[2/Math.sqrt(3)*.1+c,.5*b+a]]}function getOffset$$module$hexpoly(a,b,c=0,d=0){return[30*a+Math.abs(b)%2*15-c,10.4*b*Math.cos(Math.PI/6)-d]}function almostEquals$$module$hexpoly(a,b){return a<=b+1&&a>=b-1?!0:!1}
function doesntContain$$module$hexpoly(a,b){for(let c=0;c<a.length;c++)if(almostEquals$$module$hexpoly(a[c][0],b[0])&&almostEquals$$module$hexpoly(a[c][1],b[1]))return!1;return!0}
function findIntersections$$module$hexpoly(a,b){for(let c=0;c<a.length;c++)for(let d=0;d<a[c].length;d++){const e=a[c][d];let g=0;for(let n=0;n<a.length;n++)for(let t=0;t<a[n].length;t++)almostEquals$$module$hexpoly(a[n][t][0],e[0])&&almostEquals$$module$hexpoly(a[n][t][1],e[1])&&(g+=1);(1==g||2==g)&&doesntContain$$module$hexpoly(b,e)&&b.push(e)}}function areAdjacent$$module$hexpoly(a,b){const c=a[0]-b[0];a=a[1]-b[1];return 150>=c*c+a*a?!0:!1}
function shareOneHex$$module$hexpoly(a,b,c){let d=0;for(let e=0;e<a.length;e++)doesntContain$$module$hexpoly(a[e],c)||doesntContain$$module$hexpoly(a[e],b)||(d+=1);return 1===d?!0:!1}
function getOutlineFromArray$$module$hexpoly(a){var b=[];for(var c=0;c<a.length;c++)b.push(getOffset$$module$hexpoly(a[c][0],a[c][1]));a=[];for(c=0;c<b.length;c++)a.push(makeHex$$module$hexpoly(b[c]));b=[];findIntersections$$module$hexpoly(a,b);c=[];let d=[];const e=b.length;d.push(b[0]);b.splice(0,1);let g,n=d[0];for(let t=1;t<e;t++){g=!1;for(let w=0;w<b.length;w++)if(areAdjacent$$module$hexpoly(b[w],n)&&shareOneHex$$module$hexpoly(a,b[w],n)){d.push(b[w]);n=b[w];b.splice(w,1);g=!0;break}!1===g&&
d.length<e&&(c.push(d),d=[],d.push(b[0]),n=d[0],b.splice(0,1))}c.push(d);return c}var module$hexpoly={};module$hexpoly.getOutlineFromArray=getOutlineFromArray$$module$hexpoly;const html$$module$tokens=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),BACKSPACE$$module$tokens=8,TAB$$module$tokens=9,ENTER$$module$tokens=13,LEFT$$module$tokens=37,RIGHT$$module$tokens=39,DELETE$$module$tokens=46,COMMA$$module$tokens=188,SEPERATOR$$module$tokens=",",COPY_PROPS$$module$tokens="vals placeholder pattern spellcheck autocomplete autocapitalize autofocus accessKey accept lang minLength maxLength required".split(" ");
function tagsInput$$module$tokens(a,b){function c(L,O,S,T){L=document.createElement(L);O&&(L.className=O);S&&(L.textContent=S);for(let P in T)L.setAttribute(`data-${P}`,T[P]);return L}function d(L,O){return!0===O?Array.prototype.slice.call(H.querySelectorAll(L)):H.querySelector(L)}function e(){return d(".tag",!0).map(L=>L.textContent).concat(H.input.value||[]).join(SEPERATOR$$module$tokens)}function g(){a.value=e();a.dispatchEvent(new Event("change"))}function n(L){~L.indexOf(SEPERATOR$$module$tokens)&&
(L=L.split(SEPERATOR$$module$tokens));if(Array.isArray(L))return L.forEach(n);L=L&&L.trim();if(!L||!b.includes(L))return!1;if(!a.getAttribute("duplicates")){let O=d(`[data-tag="${L}"]`);if(O)return O.classList.add("dupe"),setTimeout(()=>O.classList.remove("dupe"),100),!1}H.insertBefore(c("span","tag",L,{tag:L}),H.input)}function t(L){let O=d(".selected");O&&O.classList.remove("selected");L&&L.classList.add("selected")}function w(){let L=d(".tag",!0).pop(),O=H.offsetWidth;O&&(H.input.style.width=Math.max(O-
(L?L.offsetLeft+L.offsetWidth:5)-5,O/4)+"px")}function z(L){"string"===typeof L||Array.isArray(L)||(L=H.input.value);!1!==n(L)&&(H.input.value="",g(),w())}function C(L){L.target.classList.contains("tag")&&t(L.target);if(L.target===H.input)return t();H.input.focus();L.preventDefault();return!1}let H=c("div","tags-input");var M=a.nextSibling;a.parentNode[M?"insertBefore":"appendChild"](H,M);a.style.cssText="position:absolute;left:0;top:-99px;width:1px;height:1px;opacity:0.01;";a.tabIndex=-1;(M=a.getAttribute("type"))&&
"tags"!==M||(M="text");H.input=c("input");H.input.setAttribute("type",M);COPY_PROPS$$module$tokens.forEach(L=>{if(a[L]!==H.input[L]){H.input[L]=a[L];try{delete a[L]}catch(O){}}});H.appendChild(H.input);a.addEventListener("focus",()=>{H.input.focus()});H.input.addEventListener("focus",()=>{H.classList.add("focus");t()});H.input.addEventListener("blur",()=>{H.classList.remove("focus");t();z()});H.input.addEventListener("keydown",L=>{let O=H.input,S=L.keyCode||L.which,T=d(".tag.selected");H.curr_pos=
0;try{var P=0===O.selectionStart&&0===O.selectionEnd}catch(Z){P=""===O.value}let W=d(".tag",!0).pop();w();if(S===ENTER$$module$tokens||S===COMMA$$module$tokens||S===TAB$$module$tokens){if(!O.value&&S!==COMMA$$module$tokens)return;z()}else if(S===DELETE$$module$tokens&&T)T.nextSibling!==H.input&&t(T.nextSibling),H.removeChild(T),w(),g();else if(S===BACKSPACE$$module$tokens)if(T)t(T.previousSibling),H.removeChild(T),w(),g();else if(W&&P)t(W);else{H.input.selectionStart--;return}else if(S===LEFT$$module$tokens)if(T)T.previousSibling&&
t(T.previousSibling);else if(P)t(W);else return;else if(S===RIGHT$$module$tokens){if(!T){H.input.selectionStart--;return}t(T.nextSibling)}else return t();L.preventDefault();return!1});H.input.addEventListener("input",()=>{const L=H.input.selectionStart;if(0<L)for(let O=0;O<b.length;O++){const S=b[O];S.startsWith(H.input.value)&&(H.input.value=S,H.input.setSelectionRange(L,S.length))}a.value=e();a.dispatchEvent(new Event("input"))});H.input.addEventListener("paste",()=>setTimeout(z,0));H.addEventListener("mousedown",
C);H.addEventListener("touchstart",C);H.setValue=function(L){d(".tag",!0).forEach(O=>H.removeChild(O));z(L)};H.getValue=e;z(a.value)}tagsInput$$module$tokens.enhance=tagsInput$$module$tokens.tagsInput=tagsInput$$module$tokens;const CLASS_NAME$$module$tokens="token-input";
class TokenInput$$module$tokens extends k$$module$libs$preact{shouldComponentUpdate(){return!1}componentDidMount(){tagsInput$$module$tokens(this.getInput(),this.props.vals);this.getInput().setValue(this.props.value||"")}getInput(){let {base:a}=this;return a&&(a.lastElementChild||a.lastChild)}setValue(a){let b=this.getInput();b&&(b.setValue?String(a)!==String(b.getValue())&&b.setValue(String(a)):b.value=a)}getValue(){var a=this.getInput();a=a?a.getValue?a.getValue():a.value:this.props.value;return"string"===
typeof a?a.split(","):a}componentWillReceiveProps({value:a}){let b=this.getValue();a!==b&&String(a)!==String(b)&&this.setValue(a)}handleEvent({type:a,target:b}){"change"===a&&this.handleEvent({type:"input",target:b});let c=this.getValue();for(let d in this.props)if(this.props.hasOwnProperty(d)&&d.toLowerCase()===`on${a}`)this.props[d]({type:a,value:c,target:b,currentTarget:this})}render(a,b){let c;b={};let d=this.handleEvent.bind(this);for(let e in a)a.hasOwnProperty(e)&&("class"===e||"className"===
e?c=a[e]:e.match(/^on(input|change)$/i)||(b[e]=a[e]));b.type="tags";c?"string"===typeof c?c+=" "+CLASS_NAME$$module$tokens:"object"===typeof c&&(c[CLASS_NAME$$module$tokens]=!0):c=CLASS_NAME$$module$tokens;return html$$module$tokens`<div class="${c}">
      <input
        ${b}
        onChange=${d}
        onInput=${d}
        placeholder=${a.placeholder}
      />
    </div> `}}
class TokenChooserDialog$$module$tokens extends ModalDialog$$module$utils{onClick(a){this.props.callback(a);this.props.onExit()}render(a,b){const c={barbarian:"barbarian fighter paladin npc pc dungeon".split(" "),thief:"thief assassin rogue ranger npc pc dungeon".split(" "),elf:["elf","ranger","npc","pc","dungeon"],fighter:"fighter barbarian paladin npc pc dungeon".split(" "),cleric:["cleric","npc","pc","dungeon"],magicuser:"magicuser wizard sorcerer npc pc dungeon".split(" "),ranger:["ranger","npc",
"pc","dungeon"],miner:["miner","cleric","npc","pc","dungeon"],sorcerer:"sorcerer magicuser wizard npc pc dungeon".split(" "),spearthrower:"spearthrower fighter barbarian npc pc dungeon".split(" "),body:"body dead remains skeleton props dungeon".split(" "),largechest:"chest treasure box crate props dungeon".split(" "),chest:"chest treasure box crate props dungeon".split(" "),coins:"gold coins treasure loot hoard props dungeon".split(" "),bag:"bad loot treasure trap sack hoard props dungeon".split(" "),
barrel:["barrel","props","dungeon"],altar:["altar","static","props","dungeon"],pit:["pit","trap","props","dungeon"],speartrap:["spears","trap","props","dungeon"],ghoul:["ghoul","undead","monster"],archer:["archer","ranger","npc","pc"],giantsquid:"squid giant ocean water sea monster".split(" "),axewoman:["barbarian","fighter","warrior","pc","npc"],blackwidow:["spider","giant","blackwidow","monster"],tree1:["tree","props","static"],tree2:["tree","props","static"],rubble:["rubble","props","static"],
wagon:["wagon","props","caravan"],ent:["ent","treant","tree","monster"],dwarf:"dwarf fighter barbarian warrior pc npc".split(" "),rogue:["rogue","thief","assassin","pc","npc"],whale:"whale giant ocean sea water monster".split(" "),shark:["shark","ocean","sea","water","monster"],roc:["roc","giant","monster"],horse:["horse","animal"],troll:["troll","ogre","giant","monster"],bridgedchasm:["bridge","chasm","structure","static"],bridgedriver:["bridge","river","structure","static"],towerruins:["tower",
"structure","static"],fcaptive:["captive","hostage","npc","props","dungeon"],mcaptive:["captive","hostage","npc","props","dungeon"],goblin:["goblin","humanoid","monster","dungeon"],cultist:["cultist","humanoid","monster","dungeon"],gnoll:["gnoll","humanoid","monster","dungeon"],kobold:["kobold","humanoid","monster","dungeon"],orc:["orc","humanoid","monster","dungeon"],skeleton_a:["skeleton","undead","monster","dungeon"],skeleton_b:["skeleton","undead","monster","dungeon"],zombie:["zombie","undead",
"humanoid","monster","dungeon"],wight:["wight","undead","humanoid","monster","dungeon"],vampire:"vampire lich undead humanoid monster dungeon".split(" "),shrieker:["shrieker","monster","dungeon"],stirge:["stirge","monster","dungeon"],gargoyle:["gargoyle","statue","monster","dungeon"],displacer:["displacer","warp","beast","monster","dungeon"],snake:["snake","monster","dungeon"],spider:["spider","insect","monster","dungeon"],wolf:["wolf","beast","monster","dungeon"],bigcat:"tiget leopard lion beast monster dungeon".split(" "),
bats:["bat","monster","dungeon"],giantbat:["bat","giant","monster","dungeon"],insects:["insect","swarm","monster","dungeon"],tick:"tick beetle fire giant insect monster dungeon".split(" "),centepide:["centepide","giant","insect","monster","dungeon"],giantrat:["giant","rat","monster","dungeon"],cockatrice:["cockatrice","monster","dungeon"],flailsnail:["flail","snail","monster","dungeon"],bear:["bear","beast","monster","dungeon"],slime:["slime","monster","dungeon"],gcube:["cube","monster","dungeon"],
owlbear:["owlbear","monster","dungeon"],beholder:["ball","eyes","boss","monster","dungeon"],chimera:["chimera","boss","monster","dungeon"],minotaur:["minotaur","monster","dungeon"],gorgon:["gorgon","boss","monster","dungeon"],cyclop:["cyclop","monster","dungeon"],demon:["demon","boss","monster","dungeon"],dragon:["dragon","boss","monster","dungeon"],trex:["dino","trex","boss","monster","dungeon"],purpleworm:"worm purple giant boss monster dungeon".split(" "),biglantern:["lantern","dungeon"]};window.app.tokentags||
(window.app.tokentags="");b=["torch","light"];for(const [,d]of Object.entries(c))for(const e of d)b.includes(e)||b.push(e);return html$$module$tokens` <!-- The Modal -->
      <div id="TokensChooser" class="modal">
        <!-- Modal content -->
        <div
          class="modal-content modal-content-flex"
          style="background: #e1e1e1;max-width:820px;"
        >
          <div class="modal-header">
            <div class="close">
              <a onClick="${a.onExit}"> ${"\u00d7"} </a>
            </div>
            <${TokenInput$$module$tokens}
              placeholder="Token Tags"
              vals=${b}
              value=${window.app.tokentags}
              onChange=${d=>{window.app.tokentags=d.value;this.forceUpdate()}}
            />
          </div>
          <div class="modal-body">
            <div style="display:flex;flex-wrap:wrap;background: #e1e1e1;">
              ${[{id:"barbarian",scale:7,light:30,pc:!0},{id:"thief",scale:7,light:30,pc:!0},{id:"elf",scale:7,light:60,pc:!0},{id:"fighter",scale:7,light:30,pc:!0},{id:"cleric",scale:7,light:30,pc:!0},{id:"magicuser",scale:7,light:30,pc:!0},{id:"ranger",scale:7,light:30,pc:!0},{id:"miner",scale:7,light:60,pc:!0},{id:"sorcerer",scale:7,light:30,pc:!0},{id:"spearthrower",scale:7,light:30,pc:!0},{id:"rogue",scale:7,light:30,pc:!0},{id:"axewoman",scale:7,light:30,pc:!0},{id:"archer",scale:7,light:30,
pc:!0},{id:"dwarf",scale:7,light:30,pc:!0},{id:"barbarian",scale:7,pc:!0},{id:"thief",scale:7,pc:!0},{id:"elf",scale:7,pc:!0},{id:"fighter",scale:7,pc:!0},{id:"cleric",scale:7,pc:!0},{id:"magicuser",scale:7,pc:!0},{id:"ranger",scale:7,pc:!0},{id:"miner",scale:7,pc:!0},{id:"sorcerer",scale:7,pc:!0},{id:"spearthrower",scale:7,pc:!0},{id:"rogue",scale:7,pc:!0},{id:"axewoman",scale:7,pc:!0},{id:"archer",scale:7,pc:!0},{id:"dwarf",scale:7,pc:!0},{id:"body",scale:7},{id:"largechest",scale:8},{id:"chest",
scale:8},{id:"coins",scale:8},{id:"bag",scale:8},{id:"barrel",scale:8},{id:"altar",scale:5},{id:"pit",scale:7},{id:"speartrap",scale:6},{id:"tree1",scale:1},{id:"tree2",scale:2},{id:"rubble",scale:3},{id:"wagon",scale:2},{id:"bridgedchasm",scale:.2,no_base:!0},{id:"bridgedriver",scale:.2,no_base:!0},{id:"towerruins",scale:.75,no_base:!0},{id:"horse",scale:2},{id:"fcaptive",scale:7},{id:"mcaptive",scale:7},{id:"goblin",scale:7},{id:"cultist",scale:7},{id:"gnoll",scale:7},{id:"kobold",scale:7},{id:"orc",
scale:5},{id:"skeleton_a",scale:7},{id:"skeleton_b",scale:7},{id:"zombie",scale:7},{id:"ghoul",scale:7},{id:"wight",scale:7},{id:"vampire",scale:7},{id:"shrieker",scale:5},{id:"stirge",scale:4},{id:"gargoyle",scale:5},{id:"displacer",scale:5},{id:"ent",scale:2},{id:"snake",scale:5},{id:"spider",scale:5},{id:"blackwidow",scale:3},{id:"wolf",scale:5},{id:"bigcat",scale:3},{id:"whale",scale:.5},{id:"shark",scale:1},{id:"giantsquid",scale:1},{id:"bats",scale:4},{id:"giantbat",scale:3},{id:"insects",scale:3},
{id:"tick",scale:5},{id:"centepide",scale:3},{id:"giantrat",scale:5},{id:"cockatrice",scale:5},{id:"flailsnail",scale:3},{id:"bear",scale:4},{id:"slime",scale:8},{id:"gcube",scale:3},{id:"owlbear",scale:3},{id:"troll",scale:2},{id:"beholder",scale:3},{id:"chimera",scale:3},{id:"minotaur",scale:3},{id:"gorgon",scale:3},{id:"cyclop",scale:3},{id:"demon",scale:4},{id:"dragon",scale:2},{id:"trex",scale:1},{id:"roc",scale:.3},{id:"purpleworm",scale:1},{id:"biglantern",scale:4,light:300}].map(d=>{if(c[d.id].some(e=>
window.app.tokentags.includes(e))||["torch","light"].some(e=>window.app.tokentags.includes(e))&&d.light||0==window.app.tokentags.length||1==window.app.tokentags.length&&""===window.app.tokentags[0])return html$$module$tokens`
                    <div style="width:150px">
                      <a onClick=${()=>this.onClick(d)}>
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          xmlns:xlink="http://www.w3.org/1999/xlink"
                          style="background:none; max-width:150px; height:150px;"
                        >
                          <use
                            xlink:href="${window.app.tokens_svg}#${d.id}"
                            transform="translate(75,75) scale(${1.5*d.scale})"
                          />
                          ${d.light&&30>=d.light&&html$$module$tokens`
                            <use
                              fill="#ff0000"
                              xlink:href="${window.app.tokens_svg}#torch"
                              transform="translate(120,75) scale(15)"
                            />
                          `}
                          ${d.light&&30<d.light&&html$$module$tokens`
                            <use
                              fill="#ff0000"
                              xlink:href="${window.app.tokens_svg}#lantern"
                              transform="translate(120,75) scale(15)"
                            />
                          `}
                        </svg>
                      </a>
                    </div>
                  `})}
            </div>
          </div>
        </div>
      </div>`}}var module$tokens={};module$tokens.TokenChooserDialog=TokenChooserDialog$$module$tokens;module$tokens.default=TokenInput$$module$tokens;const html$$module$readme=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class VttDialog$$module$readme extends ModalDialog$$module$utils{render(a,b){return html$$module$readme` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <!-- Modal content -->
        <div class="modal-content modal-content-flex">
          <div class="modal-header">
            <div class="close">
              <a onClick="${a.onExit}"> ${"\u00d7"} </a>
            </div>
            ${window.app.provider&&window.app.provider.connected?html$$module$readme`<h5>Your Virtual Table Top is ready!</h5>`:html$$module$readme` <h5>VTT Disconnected</h5>`}
          </div>
          <div class="modal-body">
            ${window.app.provider&&window.app.provider.connected?html$$module$readme`
                  <p>
                    You are now connected to the sandbox VTT room. Share the
                    following link with your players:
                  </p>
                  <pre>
          https://${window.location.host}/join/${a.instance}
          </pre
                  >
                  <p>
                    To reveal or conceal hexes or dungeon areas, hold down the
                    <span class="key-button">Spacebar</span>
                    key and click any hex or area.
                  </p>
                  <p>
                    To indicate hexes to your players, hold down the
                    <span class="key-button">F</span> key and click any hex you
                    wish to indicate. Release the key to clear any indicated
                    hex.
                  </p>
                  <p>
                    To add tokens to dungeon maps, hold down the
                    <span class="key-button">T</span> key and click the position
                    you would like the token to be added to.
                  </p>
                  <p>
                    To remove tokens, hold down the
                    <span class="key-button">K</span> key and click the token
                    you wish to remove.
                  </p>
                `:html$$module$readme` <p>You are disconnected from the sandbox VTT room.</p> `}
          </div>
        </div>
      </div>`}}class ReadmeDialog$$module$readme extends ModalDialog$$module$utils{render(a,b){return html$$module$readme` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content modal-content-flex">
          <div class="modal-header">
            <div class="close">
              <a onClick="${a.onExit}"> ${"\u00d7"} </a>
            </div>
          </div>
          <div class="modal-body">
            <h5>GREETINGS BRAVE ADVENTURER</h5>
            <p>
              I'm Ithai, and I'm the dad in Pen, Dice & Paper, a family project
              dedicated to tabletop role-playing games.
            </p>
            <p>
              I'm developing HEXROLL out of passion and need, trying to capture
              the essence of gaming the way I remember and experienced it for
              almost 35 years.
            </p>
            <p>
              Working on this 2nd edition was made possible thanks to the
              incredible support of the Pen Dice & Paper
              <strong> Patreon community </strong>. Thank you for traveling side
              by side with me.
            </p>
            <p>
              The support and kind words in the forums, subreddits and online
              groups also keeps me super motivated. Thank you too! folks.
            </p>
            <p>
              My thanks also goes to HEXROLL 1E Github contributors for their
              help extending and tuning the original model.
            </p>
            <p>
              And last, but certainly not least, thank you, so much! Oleg Doyla,
              aka Watabou for your incredible city and village generators,
              powering HEXROLL's settlement generator.
            </p>
            <div style="text-align:center">
              <svg
                width="200px"
                version="1.1"
                viewBox="0 0 116.6 87.38"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g transform="translate(-43.95 -87)">
                  <path
                    transform="matrix(.4033 0 0 .4033 -53.26 4.454)"
                    d="m311.1 327.9q0 0.24 0.04 0.6t0.08 0.76 0.08 0.76q0.04 0.32 0.04 0.48 0 1.72-1.56 1.72-1.28 0-1.8-0.84l-0.36-2.88v-0.32q0-0.28-0.04-0.72t-0.12-0.88q-0.04-0.44-0.08-0.8t-0.04-0.52q0.04-0.28 0.04-0.52 0.04-0.28 0.04-0.56 0-0.44-0.04-0.8-0.04-0.4-0.12-0.8-0.32 0.08-1.36 0.24-1.04 0.12-2.56 0.12-0.68 0-1.28-0.04-0.56-0.04-1.04-0.12-0.48-0.24-3.08-0.24-0.08 0.92-0.12 1.72-0.04 0.76-0.04 1.4 0 1.32 0.2 2 0.16 1.96 0.24 2.96 0.12 1 0.16 1.44t0.04 0.52 0 0.2q0 1.16-1.6 1.16-0.56 0-1-0.24-0.4-0.2-0.68-0.76-0.28-0.52-0.44-1.48t-0.2-2.4q-0.24-1-0.24-2.64 0-0.52 0-0.96 0.04-0.44 0.04-0.76t-0.04-0.52q0-0.24 0-0.4 0 0.08 0-0.52t0.04-1.4q0.08-0.84 0.16-1.64 0.08-0.84 0.24-1.24 0-0.08-0.04-0.16 0-0.12 0-0.24 0-0.88 0.08-1.56t0.16-1.32q0.12-0.64 0.24-1.32 0.16-0.72 0.28-1.68 0.2-1.36 0.48-2t1.28-0.64q0.52 0 1.08 0.36 0.6 0.36 0.6 1.04 0 0.36-0.04 0.96 0 0.56-0.08 1.48-0.08 0.88-0.2 2.16t-0.32 3.04q0.52 0.2 1.44 0.2 0.32 0 0.52 0 0.24-0.04 0.44-0.04 0.56 0 0.76 0.12 0.24 0.08 0.76 0.08 1.08 0 1.64-0.04 0.56-0.08 0.56-0.04h0.6q0.8 0 1.48-0.04 0.72-0.08 0.72-0.52 0-1.08-0.36-2.96v-0.72q0-0.56-0.04-1.08-0.04-0.56-0.16-1 0-1.6 2-1.6 0.92 0 1.28 0.96 0.4 0.92 0.52 2.2 0.16 1.28 0.16 2.64 0.04 1.32 0.28 2.12 0 1.04 0.04 2.48 0.08 1.4 0.24 3.28-0.04 0.2-0.04 0.48t0 0.6q0 0.36 0 0.8 0 0.4 0.04 0.88zm21.48 1.32q1.32 0.68 1.32 1.96 0 0.84-0.44 1.2-0.4 0.36-1.2 0.48-0.76 0.16-1.92 0.16-1.16 0.04-2.6 0.12-0.48-0.16-3.52-0.32-0.44 0.04-0.84 0.04-0.4 0.04-0.76 0.04-2.16 0-2.96-0.64-0.2-1.6-0.32-2.96-0.08-1.36-0.08-2.48 0-1.76 0.12-3.04 0.16-1.32 0.16-2.36 0-1.28-0.12-2l0.24-4.2q0.16-1.52 0.36-2.6 0.24-1.08 0.56-1.64 0.24-0.32 2.4-0.8l2.56-0.56q0.24-0.04 1-0.12t1.56-0.16q0.84-0.08 1.48-0.12t0.6-0.04h0.16q0.44 0 0.88 0.6 0.48 0.6 0.48 1.4 0 0.4-0.04 0.72 0 0.32-0.24 0.56-0.24 0.2-0.8 0.32t-1.64 0.16q-1.76 0.08-2.4 0.36h-0.2q-1.04 0-2.6 0.48-0.16 0.2-0.24 0.72-0.08 0.48-0.12 1.04-0.04 0.52-0.08 0.92 0 0.36 0 0.24-0.04 0.2-0.08 0.4 0 0.2 0 0.52 0 0.28 0 0.64 0.04 0.32 0.08 0.72 1.24-0.12 2-0.24 0.8-0.16 1.24-0.16 0.84 0 1.64-0.04t1.4 0.12q0.64 0.12 1 0.56 0.36 0.4 0.36 1.32 0 1.04-0.68 1.36-0.64 0.32-2.28 0.36-1.92 0.08-2.32 0.16-0.24 0-0.52 0-0.24-0.04-0.56-0.04-0.2 0-0.48 0-0.24-0.04-0.48 0-0.24 0-0.44 0.16-0.16 0.12-0.16 0.48 0 0.24 0 0.64 0.04 0.36 0.04 0.68 0 0.48-0.04 0.96 0 0.48-0.04 1.04 0 0.52-0.04 1.2 0 0.68 0 1.6 0.24 0.04 0.92 0.08 0.72 0.04 1.48 0.08 0.8 0.04 1.52 0.12 0.72 0.04 0.96 0.08 0.04 0 0.56-0.04t1.52-0.12q1.36-0.12 2.16-0.12zm22.6 0.8q0 0.12 0 0.24 0.04 0.12 0.04 0.2 0 0.92-0.48 1.52t-1.2 0.6q-0.8 0-1.52-0.76l-2.4-3.52q-0.6-0.64-1.48-1.6-0.88-1-2.04-2.28l-2.72 3.24q-0.84 1-1.4 1.72-0.52 0.72-0.96 1.36-0.4 0.6-0.8 1.28-0.4 0.64-0.96 1.52-0.52 0.2-1.08 0.2-0.92 0-1.64-0.48-0.68-0.48-0.68-1.36 0-0.24 0.36-0.88 0.4-0.64 0.84-1.32 0.44-0.72 0.84-1.28t0.4-0.6q0.52-0.68 1.04-1.24 0.56-0.56 1.16-1.2 0.64-0.68 1.32-1.56 0.72-0.88 1.6-2.24l-2.64-2.4q-0.12-0.12-0.56-0.48-0.4-0.36-0.92-0.84-0.48-0.48-1-1-0.52-0.56-0.84-1.12 0.64-2.08 2.24-2.08 0.28 0 0.52 0.16 0.28 0.16 0.68 0.56 0.44 0.36 1.12 1.04t1.84 1.72q0.84 0.68 1.2 1t0.84 0.76q0.08-0.12 0.88-1.16 0.84-1.08 1.92-2.32 1.08-1.28 2.12-2.28 1.04-1.04 1.6-1.04 0.28 0 0.64 0.16 0.36 0.12 0.68 0.36 0.36 0.24 0.56 0.56 0.24 0.28 0.24 0.56 0 0.2-0.16 0.52t-0.56 0.88q-0.4 0.52-1.12 1.36-0.68 0.8-1.8 1.96l-2.48 3q1.08 1.24 1.56 1.88 0.52 0.6 0.76 1 0.28 0.36 0.52 0.68 0.28 0.32 0.96 0.96 0.64 0.64 1.36 1.64 0.76 1 1.6 2.4zm21 0.56q0 0.72-0.64 1.36-0.64 0.6-1.28 0.6-0.32 0-0.52-0.2-0.04 0-0.36-0.4t-0.76-1-0.96-1.28-0.96-1.28-0.72-0.96q-0.24-0.4-0.2-0.36-0.08-0.24-0.4-0.76t-0.72-1.08q-0.36-0.6-0.68-1.08-0.32-0.52-0.36-0.64-0.08 0-0.44 0.08-0.36 0.04-0.8 0.12-0.44 0.04-0.92 0.12-0.44 0.04-0.68 0.04h-0.2q-0.12 1.24-0.2 2.04t-0.08 1.2v1.24q0 2.16-0.36 4.68-0.48 0.72-1.4 0.72-0.8 0-1.4-0.44-0.56-0.4-0.56-1.44 0-0.32 0-0.76 0.04-0.48 0.04-0.96 0.04-0.48 0.04-0.84 0.04-0.4 0.04-0.52v-0.2l0.28-6.04q0.04-0.52 0-1.28 0-0.76 0.08-1.76l0.32-2.4q0.24-1.24 0.24-2.12 0-0.28-0.04-0.52 0-0.28-0.04-0.56 0 0 0.12-1.4 0.04-0.96 0.36-1.56t1.52-0.6q0.84 0 1.68 0.28 0.8-0.08 1.4-0.08 0.64 0 1.08 0 0.4 0 0.72 0.04 0.32 0 0.64 0.08 0.32 0.04 0.72 0.16 0.4 0.08 0.96 0.24l1.76 1.2q1.48 1.16 1.96 2.32 0.52 1.16 0.52 2.44 0 0.88-0.08 1.52-0.04 0.6-0.4 1.2t-1.12 1.24-2.16 1.6q0.92 1.16 2.08 3.44 0.72 0.56 2.88 4.56zm-4.92-12.76q0.04-0.16 0.04-0.44 0-0.4-0.08-0.8-0.08-0.44-0.36-0.84-0.28-0.44-0.84-0.84-0.52-0.44-1.48-0.84-0.84-0.32-1.4-0.32-0.16 0.04-0.44 0.08-0.24 0.08-0.6 0.16-0.36 0.04-0.8 0.12 0.04 0.24 0.04 0.48 0 0.2-0.08 0.8-0.04 0.6-0.16 1.72t-0.28 3.12q0.16 0.04 0.32 0.04t0.32 0q0.76 0 1.68-0.2 0.96-0.24 1.8-0.56 0.84-0.36 1.48-0.8t0.84-0.88zm26.76 6.36q-0.52 2.08-2.96 4.8-0.32 0.12-0.84 0.48-0.48 0.36-1.28 0.76-0.76 0.36-1.88 0.64t-2.64 0.28q-3.04 0-5.08-1.6-2.04-1.64-3.16-5.12-0.04-0.28-0.04-0.56t0-0.6q0-2.48 0.52-4.36 0.52-1.92 1.4-3.32t2-2.36q1.16-0.96 2.4-1.56 2.04-0.56 4-0.56 1.4 0 2.76 0.72t2.4 2.04q1.08 1.32 1.72 3.24 0.68 1.88 0.76 4.28zm-3.68-0.12q0.28-1.64 0.28-2.56 0-1.52-0.44-2.8t-1.04-2.2q-0.6-0.96-1.28-1.48-0.64-0.56-1.08-0.56-2.12 0-3.48 0.96-1.32 0.92-2.08 2.24t-1.04 2.76-0.28 2.44q0 0.92 0.28 1.8 0.32 0.84 0.88 1.52 0.6 0.64 1.4 1.04t1.84 0.4q2.44 0 3.84-0.88 1.4-0.92 2.2-2.68zm20.8 3.04q1.16 0.24 1.16 1.8 0 0.84-0.4 1.32t-1.04 0.48q-0.2 0-0.76-0.04-0.56-0.08-1.2-0.12-0.64-0.08-1.24-0.12-0.6-0.08-0.84-0.08t-0.44 0-0.4 0.04q-0.68-0.04-1.6-0.16-0.88-0.16-1.76-0.32-0.84-0.2-1.52-0.4-0.64-0.2-0.76-0.36-0.4-1.2-0.4-3.2 0-0.32 0-0.64 0-0.36 0.04-0.72l0.24-2.84q0.04-0.32 0.04-0.6 0-0.32 0-0.56 0-0.32 0-0.52 0-0.24-0.08-0.44 0.28-1.52 0.4-2.52 0.12-1.04 0.12-1.6v-0.32q0-0.56 0.48-3.56 0.6-1.28 1.84-1.28 0.76 0 1.28 0.6 0.52 0.56 0.52 1.56-0.16 0.56-0.32 1.4-0.12 0.84-0.24 2v0.32q0 0.36-0.08 1.12-0.04 0.72-0.12 1.52-0.08 0.76-0.16 1.4-0.04 0.6-0.04 0.68 0 0.44 0.04 0.56-0.16 1.68-0.24 2.8t-0.08 1.72q0 0.4 0.04 0.52 2.08 0.24 2.76 0.24 0.32 0 0.64 0 0.36-0.04 0.72-0.04 1.52 0 3.4 0.36zm17.88 0q1.16 0.24 1.16 1.8 0 0.84-0.4 1.32t-1.04 0.48q-0.2 0-0.76-0.04-0.56-0.08-1.2-0.12-0.64-0.08-1.24-0.12-0.6-0.08-0.84-0.08t-0.44 0-0.4 0.04q-0.68-0.04-1.6-0.16-0.88-0.16-1.76-0.32-0.84-0.2-1.52-0.4-0.64-0.2-0.76-0.36-0.4-1.2-0.4-3.2 0-0.32 0-0.64 0-0.36 0.04-0.72l0.24-2.84q0.04-0.32 0.04-0.6 0-0.32 0-0.56 0-0.32 0-0.52 0-0.24-0.08-0.44 0.28-1.52 0.4-2.52 0.12-1.04 0.12-1.6v-0.32q0-0.56 0.48-3.56 0.6-1.28 1.84-1.28 0.76 0 1.28 0.6 0.52 0.56 0.52 1.56-0.16 0.56-0.32 1.4-0.12 0.84-0.24 2v0.32q0 0.36-0.08 1.12-0.04 0.72-0.12 1.52-0.08 0.76-0.16 1.4-0.04 0.6-0.04 0.68 0 0.44 0.04 0.56-0.16 1.68-0.24 2.8t-0.08 1.72q0 0.4 0.04 0.52 2.08 0.24 2.76 0.24 0.32 0 0.64 0 0.36-0.04 0.72-0.04 1.52 0 3.4 0.36zm29.12-13.92q0.08 0.32 0.08 0.6 0 1.28-0.76 2.16-1.2 0.48-2.4 0.48-0.76-0.48-1.28-1.08-0.48-0.64-0.48-1.24 0-0.52 1.2-2.56 0.52 0.08 1.08 0.12 0.6 0.04 1.08 0.2 0.52 0.16 0.88 0.48 0.4 0.28 0.6 0.84zm-1.28 6.68v0.52q0 0.2 0 0.44t-0.08 0.44l-0.32 1.8v0.36q0 0.24-0.04 0.64t-0.12 0.8q-0.04 0.4-0.08 0.76t-0.04 0.6q0 0.2 0 0.32 0.04 0.12 0.04 0.32 0 0.36-0.08 0.8-0.08 0.4-0.08 0.92 0 0.48 0.12 1-0.44 1.8-1.84 1.8-1.96 0-1.96-3.68 0-1.24 0.12-2.44 0.12-1.24 0.28-2.28t0.32-1.8q0.2-0.8 0.32-1.24 0.6-0.88 1.68-0.88 1.04 0 1.76 0.8zm17.84 7.56q-0.12 1.24-0.84 2.28-0.68 1-1.4 2.04-0.44 0.36-1.28 0.6-0.8 0.28-1.6 0.44t-1.4 0.24q-0.56 0.08-0.48 0.08-0.4 0-1.04-0.16-0.6-0.12-1.2-0.28-0.56-0.12-0.96-0.28-0.36-0.12-0.32-0.12-0.36-0.04-0.92-0.24-0.56-0.24-1.08-0.52-0.48-0.32-0.84-0.64-0.4-0.36-0.4-0.68t0.16-0.64q0.16-0.36 0.44-0.64 0.28-0.32 0.56-0.48 0.32-0.2 0.64-0.2l2.76 1.04q0.76 0.24 1.48 0.36 0.76 0.08 1.48 0.08 0.68 0 1.2-0.24 0.56-0.28 0.84-0.64l0.6-1.2q-0.08-0.72-0.6-1.12-0.48-0.4-1.24-0.68-0.72-0.28-1.56-0.52t-1.56-0.64l-1.72-1.08q-0.84-1.08-0.88-3.32 0.24-1.4 1.2-2.24 0.04-0.04 0.52-0.36 0.48-0.36 1.48-1 0.16 0 1-0.08 0.88-0.08 2.4-0.24 0.68 0 3.32 0.96 0.52 0.52 0.52 1.44 0 0.72-0.36 1.24-0.32 0.48-0.96 0.48-0.68 0-1.52-0.32-0.8-0.36-1.52-0.36-1 0-1.84 0.2-0.8 0.16-0.8 0.8 0 0.92 0.8 1.12 6.12 1.36 6.92 5.52zm-224.3 40.77q-0.76 1.6-2.48 2.56-1.72 0.92-3.84 0.92-0.28 0-0.92-0.08t-1.44-0.32q-0.76-0.24-1.6-0.64-0.8-0.44-1.48-1.12-0.68-0.72-1.12-1.72t-0.44-2.36q-0.04-1.8 0.48-3.28 0.56-1.48 1.76-3l1.28-1.64q2.24-1.52 5.04-1.52 1.52 0 2.4 0.56 0.92 0.56 0.92 1.6 0 0.8-0.6 1.32-0.56 0.48-1.48 0.48-0.04 0-0.32-0.04-0.24-0.08-0.56-0.16t-0.64-0.12q-0.32-0.08-0.52-0.08-0.92 0-2.12 0.96-1.16 0.96-1.84 3.04-0.28 0.88-0.28 1.44 0 1.12 0.6 1.76 0.64 0.64 1.4 1 0.76 0.32 1.4 0.44 0.64 0.08 0.68 0.08 0.56 0 1.12-0.32t1-0.72q0.48-0.4 0.76-0.68 0.28-0.32 0.24-0.32 0.4-0.36 0.92-0.36 0.64 0 1.16 0.68 0.56 0.64 0.56 1.32 0 0.2-0.04 0.32zm15.12-9.76q0.64 0.4 0.64 1.52 0 0.84-0.44 1.44t-1.2 0.6q-0.48 0-1-0.24-0.48-0.28-1.04-0.28-0.48 0-0.96 0.2-0.44 0.16-1.04 0.76l-1.2 1.2q0 0.28 0 0.56 0.04 0.28 0.04 0.6 0 0.48-0.04 1 0 0.52-0.04 1.12l0.36 3.64q-0.12 1.84-1.88 1.84-0.92 0-1.36-0.56-0.44-0.6-0.6-1.64t-0.16-2.44q0.04-1.4 0-3.08-0.08-2.52-0.12-2.52v0.04q-0.16-0.6-0.24-1.04-0.08-0.48-0.08-0.84 0-0.72 0.52-1.16 0.52-0.48 1.52-0.48 0.64 0 1.52 1 0.92-0.72 1.4-1.08 0.52-0.36 0.84-0.52 0.36-0.16 0.68-0.16 0.32-0.04 0.84-0.04 0.44-0.04 0.8 0.04 0.4 0.08 0.84 0.16zm18.32 12q-1.28 1.28-2.88 2.16-1.6 0.92-3.24 0.92-1.48 0-3.8-0.48-0.8-0.52-1.6-1.24-0.8-0.76-1.44-1.64-0.64-0.92-1.04-1.96-0.4-1.08-0.4-2.2 0-0.32 0.04-0.84 0.04-0.56 0.08-1.08 0.08-0.56 0.12-0.96t0.04-0.4q0.8-1.28 1.68-2.52 0.92-1.28 2.56-2.24 2.6-0.56 3.76-0.56 0.6 0 1.04 0.08 0.44 0.04 0.84 0.24 0.44 0.16 0.84 0.52 0.44 0.36 1 0.92 0.64 0.68 1 0.92 0.4 0.24 0.4 0.44 0 3.68-2.28 5-1 0.36-2.6 0.8-1.6 0.4-4.36 0.76 0.56 1.52 1.48 2.28t2.08 0.76q1.72 0 4.32-2.04 0.4-0.36 1-0.36 0.64 0 1.12 0.48 0.52 0.48 0.52 1.2 0 0.52-0.28 1.04zm-4.52-8.56q-0.76-1.24-1.8-1.24-0.44 0-0.96 0.12t-1.08 0.36q-0.52 0.2-1 0.52-0.44 0.32-0.72 0.76l-0.4 1.2q1.36-0.12 2.4-0.2t1.8-0.24 1.2-0.44 0.56-0.84zm24.12 5.44q0.72 0.48 0.72 1.16 0 0.36-0.2 0.76-0.2 0.36-0.52 0.68-0.32 0.28-0.68 0.48t-0.72 0.2q-0.32-0.12-0.76-0.4-0.44-0.32-0.88-0.68-0.44-0.4-0.84-0.88-0.36-0.48-0.56-0.96l-0.28 0.68q-0.76 1.44-2.4 2.72-2 0.36-2.32 0.36-0.76 0-1.84-0.24l-2.2-1.56q-1.44-1.36-1.44-3.72 0-0.84 0.24-1.84 0.28-1.04 0.76-2.08 0.52-1.04 1.24-2.04t1.68-1.8q1.16-0.44 2.24-0.72 1.08-0.32 1.64-0.4 0.76-0.84 1.8-0.84 0.6 0 1.04 0.6 0.48 0.56 0.8 1.44 0.36 0.88 0.56 1.96 0.2 1.04 0.28 2l0.52 2.12q0.24 1 0.76 1.72 0.56 0.72 1.36 1.28zm-6.08-4.44q-0.08-0.04-0.6-2.52-0.2 0-0.6 0t-0.96 0.24q-0.52 0.2-1.16 0.76-0.6 0.52-1.16 1.6-0.84 1.56-0.84 3.12 0.68 1.32 2.12 2.08 0.44-0.12 0.72-0.28 0.32-0.16 0.56-0.44t0.44-0.68q0.24-0.44 0.52-1.08 0.52-0.92 0.72-1.6 0.24-0.72 0.24-1.2zm20.24-5.92q0.44 0.36 0.44 1.32 0 1.76-1.32 1.76h-0.16q-0.6 0.04-1.4 0.12-0.8 0.04-1.8 0.16-0.08 0.64-0.16 1.72-0.08 1.04-0.08 2.52 0 0.12 0 0.24 0.04 0.12 0.04 0.28v1.84q0 0.64 0.2 1.04 0.24 0.36 0.56 0.52l1.12 0.36q1.32 0.44 1.32 1.6 0 0.68-0.56 1.2-0.52 0.52-1.36 0.52-0.24 0-0.84-0.12-0.56-0.16-1.2-0.4-0.6-0.24-1.16-0.6-0.52-0.36-0.72-0.8-0.44-0.92-0.72-1.92-0.28-1.04-0.28-2.16 0-1.24 0.04-1.76t0.08-0.92 0.08-0.96 0.04-1.84q-0.76 0.08-2.24 0.48-0.88 0-1.52-0.44-0.6-0.48-0.6-1.24 0-0.56 0.32-1.04 0.36-0.48 1.44-0.84 0.36-0.12 0.64-0.16 0.32-0.04 0.6-0.08 0.32-0.04 0.68-0.04 0.36-0.04 0.88-0.12 0.04-1 0.12-2.24 0.12-1.28 0.36-2.36 0.28-1.08 0.76-1.8 0.52-0.76 1.36-0.76 1.44 0 1.76 1.32 0 0.04-0.12 0.56-0.08 0.48-0.2 1.08t-0.24 1.16q-0.08 0.56-0.08 0.72l-0.12 1.96q0.28-0.04 0.52-0.04 0.24-0.04 0.52-0.04h0.36q0.28 0 0.52 0 0.24-0.04 0.44-0.04 1.2 0 1.68 0.24zm17.88 13.48q-1.28 1.28-2.88 2.16-1.6 0.92-3.24 0.92-1.48 0-3.8-0.48-0.8-0.52-1.6-1.24-0.8-0.76-1.44-1.64-0.64-0.92-1.04-1.96-0.4-1.08-0.4-2.2 0-0.32 0.04-0.84 0.04-0.56 0.08-1.08 0.08-0.56 0.12-0.96t0.04-0.4q0.8-1.28 1.68-2.52 0.92-1.28 2.56-2.24 2.6-0.56 3.76-0.56 0.6 0 1.04 0.08 0.44 0.04 0.84 0.24 0.44 0.16 0.84 0.52 0.44 0.36 1 0.92 0.64 0.68 1 0.92 0.4 0.24 0.4 0.44 0 3.68-2.28 5-1 0.36-2.6 0.8-1.6 0.4-4.36 0.76 0.56 1.52 1.48 2.28t2.08 0.76q1.72 0 4.32-2.04 0.4-0.36 1-0.36 0.64 0 1.12 0.48 0.52 0.48 0.52 1.2 0 0.52-0.28 1.04zm-4.52-8.56q-0.76-1.24-1.8-1.24-0.44 0-0.96 0.12t-1.08 0.36q-0.52 0.2-1 0.52-0.44 0.32-0.72 0.76l-0.4 1.2q1.36-0.12 2.4-0.2t1.8-0.24 1.2-0.44 0.56-0.84zm22.92-9.4q-0.12 0.36-0.12 1.4 0 0.6 0 1.52 0.04 0.92 0.04 1.52 0 0.56 0 1t-0.08 0.72q0.04 0.16 0.04 0.36t0 0.44q0 0.56-0.08 1.44-0.08 0.84-0.08 1.16 0 0.08 0 0.16 0.04 0.04 0.04 0.12-0.36 2.16-0.48 3.92-0.08 1.72-0.28 2.96-0.16 1.24-0.6 1.92-0.4 0.64-1.4 0.64-0.84 0-1.48-0.4v-0.28q-1.2 0.52-3.2 0.52-1.32 0-2.44-0.48-1.08-0.48-1.88-1.32-0.8-0.88-1.24-2.04t-0.44-2.52q0-0.76 0.16-1.48 0.2-0.76 0.48-1.4 0.28-0.68 0.6-1.2 0.36-0.56 0.68-0.92 0.8-0.88 2.32-1.6t3.24-0.72q1.16 0 2.36 0.44 0-0.6 0.04-1.44 0.08-0.84 0.16-1.96l-0.16-2.72q0-0.2-0.04-0.32 0-0.16 0-0.32 0-1.32 0.32-2 0.36-0.68 1.4-0.68 0.64 0 1 0.16 0.4 0.16 0.6 0.56 0.24 0.36 0.32 1.08 0.08 0.68 0.2 1.76zm-4.12 9.56q-0.8-0.56-1.96-0.56-0.84 0-1.44 0.12-0.56 0.12-0.96 0.44-0.4 0.28-0.68 0.8-0.28 0.48-0.56 1.2-0.24 0.68-0.24 1.28 0 1.28 0.88 2 0.92 0.72 2.2 0.72 1.12 0 2.16-0.8 0.36-1.64 0.48-2.28 0.16-0.68 0.16-1.16 0-0.44-0.04-0.8-0.04-0.4-0.04-0.68 0-0.08 0-0.12 0.04-0.08 0.04-0.16zm48.92-4.12q-0.24 0.68-0.56 1.76-0.28 1.08-0.6 2.52l-1.28 3.32q0 0.12-0.32 0.84-0.28 0.68-0.68 1.56-0.36 0.84-0.76 1.64-0.36 0.76-0.52 1.04-1.28 1.4-2.76 1.76-1.16-0.6-2.2-2.36-1-1.8-2.04-5.24l-0.76 1.52q-0.36 0.72-1 1.56-0.6 0.84-1.28 1.6-0.68 0.72-1.32 1.24t-1.08 0.56q-0.88-0.52-1.92-1.84-1.04-1.36-1.76-3.52-0.24-0.76-0.44-1.16-0.16-0.4-0.32-0.76-0.16-0.4-0.36-0.88-0.16-0.52-0.4-1.48-0.44-1.76-0.44-2.44 0-0.8 0.48-1.2t1.16-0.4q0.84 0 1.28 0.36 0.44 0.32 0.68 0.92t0.4 1.48q0.2 0.84 0.52 1.84 0.24 0.8 0.6 1.84 0.4 1.04 0.92 2.32 0.24-0.48 0.56-1.08 0.36-0.6 0.8-1.32 0.16-0.12 0.44-0.6 0.32-0.48 0.56-1 0.28-0.52 0.48-0.92t0.16-0.36q1.4-2.04 3.08-2.52 0.12 0.12 0.36 0.6 0.24 0.44 0.48 1 0.24 0.52 0.48 1 0.24 0.44 0.4 0.56 0.2 0.56 0.36 1.08 0.16 0.48 0.32 1.12 0.2 0.6 0.48 1.44 0.32 0.84 0.8 2.08 0.8-1.76 0.88-2.68 0.56-1.6 0.96-2.64 0.44-1.04 0.64-1.48 0.12-0.64 0.28-1.4 0.2-0.8 0.52-1.48t0.76-1.12q0.44-0.48 1.12-0.48 1.28 0 1.84 1.8zm10.28-4.72q0.08 0.32 0.08 0.6 0 1.28-0.76 2.16-1.2 0.48-2.4 0.48-0.76-0.48-1.28-1.08-0.48-0.64-0.48-1.24 0-0.52 1.2-2.56 0.52 0.08 1.08 0.12 0.6 0.04 1.08 0.2 0.52 0.16 0.88 0.48 0.4 0.28 0.6 0.84zm-1.28 6.68v0.52q0 0.2 0 0.44t-0.08 0.44l-0.32 1.8v0.36q0 0.24-0.04 0.64t-0.12 0.8q-0.04 0.4-0.08 0.76t-0.04 0.6q0 0.2 0 0.32 0.04 0.12 0.04 0.32 0 0.36-0.08 0.8-0.08 0.4-0.08 0.92 0 0.48 0.12 1-0.44 1.8-1.84 1.8-1.96 0-1.96-3.68 0-1.24 0.12-2.44 0.12-1.24 0.28-2.28t0.32-1.8q0.2-0.8 0.32-1.24 0.6-0.88 1.68-0.88 1.04 0 1.76 0.8zm17.08-2.92q0.44 0.36 0.44 1.32 0 1.76-1.32 1.76h-0.16q-0.6 0.04-1.4 0.12-0.8 0.04-1.8 0.16-0.08 0.64-0.16 1.72-0.08 1.04-0.08 2.52 0 0.12 0 0.24 0.04 0.12 0.04 0.28v1.84q0 0.64 0.2 1.04 0.24 0.36 0.56 0.52l1.12 0.36q1.32 0.44 1.32 1.6 0 0.68-0.56 1.2-0.52 0.52-1.36 0.52-0.24 0-0.84-0.12-0.56-0.16-1.2-0.4-0.6-0.24-1.16-0.6-0.52-0.36-0.72-0.8-0.44-0.92-0.72-1.92-0.28-1.04-0.28-2.16 0-1.24 0.04-1.76t0.08-0.92 0.08-0.96 0.04-1.84q-0.76 0.08-2.24 0.48-0.88 0-1.52-0.44-0.6-0.48-0.6-1.24 0-0.56 0.32-1.04 0.36-0.48 1.44-0.84 0.36-0.12 0.64-0.16 0.32-0.04 0.6-0.08 0.32-0.04 0.68-0.04 0.36-0.04 0.88-0.12 0.04-1 0.12-2.24 0.12-1.28 0.36-2.36 0.28-1.08 0.76-1.8 0.52-0.76 1.36-0.76 1.44 0 1.76 1.32 0 0.04-0.12 0.56-0.08 0.48-0.2 1.08t-0.24 1.16q-0.08 0.56-0.08 0.72l-0.12 1.96q0.28-0.04 0.52-0.04 0.24-0.04 0.52-0.04h0.36q0.28 0 0.52 0 0.24-0.04 0.44-0.04 1.2 0 1.68 0.24zm17.56 13.36q-0.2 0.56-0.8 1.12t-1.16 0.56q-1.16 0-1.52-1.64t-0.36-4.64v-0.36q0-1.52-0.24-2.2-0.2-0.72-0.28-0.92-0.44-0.96-1.36-0.96-0.56 0-1.16 0.24-0.6 0.2-1.08 0.52-0.48 0.28-0.84 0.56-0.32 0.28-0.4 0.4-0.08 0.28-0.16 0.96-0.04 0.68-0.08 1.56t-0.08 1.8-0.08 1.68q0 0.76 0 1.2t0.04 0.36q-0.12 1.08-1.72 1.08-1.2 0-1.56-0.76-0.32-0.76-0.32-2.6 0-0.48 0-0.56 0.04-0.08 0.08-0.36 0.04-0.32 0.12-1.12t0.2-2.72q0.04-0.8 0.08-1.44 0.04-0.68 0-1.16 0-0.44 0-0.72 0-0.32-0.04-0.52 0.04-0.12 0.08-0.76 0.08-0.64 0.12-1.4 0.08-0.76 0.16-1.44t0.16-0.92q0-0.84 0.04-1.92 0.04-1.12 0.28-2.08t0.72-1.6q0.52-0.68 1.44-0.68 1.56 0 1.56 2 0 1.12-0.44 3.2-0.08 1.08-0.2 1.68-0.08 0.6-0.16 1.04t-0.12 0.84-0.04 1.12q1-0.84 1.92-0.96 0.92-0.16 1.72-0.16 2 0 3.2 1.16t1.8 3.84q0.04 0.96 0.04 1.52 0.04 0.52 0.08 1.2 0.08 0.64 0.16 1.76t0.2 3.2zm28.92-19.32q-0.08 1-0.48 2.28-0.36 1.24-0.52 2.04v0.48q0 0.56-0.08 1.2t-0.16 1.24q-0.08 0.56-0.2 1-0.08 0.44-0.08 0.6-0.04 0.2-0.04 0.96t0 2.04v0.48q0 0.8-0.08 1.4t-0.2 1.08l0.36 3q0.16 0.44 1.08 1.32-0.2 0.72-1.04 1.32-0.84 0.56-1.72 0.56-1.2 0-1.84-1.12-0.6-1.16-0.6-3.84 0-0.44 0.04-0.76 0.08-0.32 0.08-0.8 0-0.96-0.24-2.4 0.2-0.44 0.28-1.12 0.12-0.68 0.16-1.28 0.04-0.64 0.04-1.08t0-0.36q0 0.04 0.08-0.56 0.12-0.6 0.24-1.4 0.12-0.84 0.2-1.72 0.12-0.88 0.12-1.4v-0.32l0.68-3.36q0.52-0.88 1.8-0.88 1.4 0 2.12 1.4zm16.12 20.04q-0.52 0.36-1.68 0.72-1.16 0.32-2.4 0.56l-1.64-0.32q-0.36-0.12-1.2-0.56-0.8-0.44-1.64-1.32-0.84-0.92-1.48-2.32-0.64-1.44-0.64-3.48 0-0.72 0.32-1.68 0.36-1 1.04-1.84 0.68-0.88 1.68-1.48 1.04-0.6 2.4-0.6 2.72 0 4.92 1.76 1.92 2.64 1.92 5.84 0 2.36-1.6 4.72zm-1.96-5.68q-0.2-1.56-1-2.44-0.76-0.92-1.96-0.92-0.8 0-1.52 0.8-0.68 0.76-0.68 2.24 0 0.6 0.16 1.28 0.16 0.64 0.52 1.2 0.36 0.52 0.92 0.88 0.56 0.32 1.36 0.32 1.28 0 1.76-0.76 0.48-0.8 0.48-1.96 0-0.16-0.04-0.28 0-0.16 0-0.36zm22.36-6.8q-0.12 0.88-1.72 3.8l-1.2 2.68q-0.36 0.92-0.64 1.56t-0.52 1.12q-0.2 0.44-0.44 0.8-0.2 0.32-0.44 0.64-0.2 0.48-0.56 1-0.36 0.48-0.84 0.92t-1.04 0.72-1.16 0.28q-1.68 0-2.4-2.12-0.44-0.48-0.84-1.24t-0.72-1.48q-0.28-0.72-0.48-1.24-0.2-0.56-0.24-0.64-0.48-1-0.48-2.36v-0.32q-0.76-1.92-0.76-3.52 0-0.76 0.6-1.12 0.64-0.36 1.44-0.36 0.48 0 0.76 0.24 0.32 0.2 0.48 0.64 0.2 0.4 0.32 1t0.28 1.36q0.28 1.32 0.48 2.2 0.24 0.88 0.48 1.56 0.28 0.68 0.64 1.36 0.36 0.64 0.92 1.52 1-1.12 1.36-2.64 0.28-0.52 0.44-1 0.2-0.52 0.52-1.32t0.92-2.04q0.6-1.28 1.76-3.28 0.44-0.56 1.08-0.56 0.72 0 1.36 0.56t0.64 1.16zm18.2 11.88q-1.28 1.28-2.88 2.16-1.6 0.92-3.24 0.92-1.48 0-3.8-0.48-0.8-0.52-1.6-1.24-0.8-0.76-1.44-1.64-0.64-0.92-1.04-1.96-0.4-1.08-0.4-2.2 0-0.32 0.04-0.84 0.04-0.56 0.08-1.08 0.08-0.56 0.12-0.96t0.04-0.4q0.8-1.28 1.68-2.52 0.92-1.28 2.56-2.24 2.6-0.56 3.76-0.56 0.6 0 1.04 0.08 0.44 0.04 0.84 0.24 0.44 0.16 0.84 0.52 0.44 0.36 1 0.92 0.64 0.68 1 0.92 0.4 0.24 0.4 0.44 0 3.68-2.28 5-1 0.36-2.6 0.8-1.6 0.4-4.36 0.76 0.56 1.52 1.48 2.28t2.08 0.76q1.72 0 4.32-2.04 0.4-0.36 1-0.36 0.64 0 1.12 0.48 0.52 0.48 0.52 1.2 0 0.52-0.28 1.04zm-4.52-8.56q-0.76-1.24-1.8-1.24-0.44 0-0.96 0.12t-1.08 0.36q-0.52 0.2-1 0.52-0.44 0.32-0.72 0.76l-0.4 1.2q1.36-0.12 2.4-0.2t1.8-0.24 1.2-0.44 0.56-0.84zm-212.3 38.65q0.96 1.88 0.96 3.44 0 1.16-0.52 2.36l-0.84 1.92-1.24 1.32q-1.28 1.4-2.52 1.84-1.24 0.4-2 0.4-0.96 0-1.96-0.6-0.52 0.44-1.16 0.44-0.72 0-1.72-0.56 0.04-0.4 0.04-0.88t0-1.04q0-0.32-0.04-0.6t-0.08-0.72q-0.04-0.48-0.08-1.24t-0.08-2q-0.04-1.28-0.16-2-0.12-0.76-0.24-0.96-0.2-1.36-0.36-2.76t-0.32-2.6q-0.16-1.24-0.32-2.2t-0.32-1.44q0-0.92 0.44-1.56t1.2-0.64q0.4 0 0.76 0.12t0.64 0.48q0.32 0.36 0.56 1t0.36 1.68q0.12 1 0.16 1.4 0.08 0.4 0.12 0.8 0.08 0.4 0.16 1.12t0.28 2.36q0.72-0.4 1.24-0.64 0.56-0.28 1.04-0.44t0.96-0.2q0.52-0.04 1.2-0.04 0.76 0 1.36 0.24 0.64 0.24 1.08 0.6 0.48 0.36 0.8 0.8 0.36 0.4 0.6 0.8zm-2.8 4.72q0.2-1.12 0.2-1.48 0-0.2-0.12-0.56-0.12-0.4-0.36-0.76-0.2-0.36-0.52-0.64t-0.76-0.28q-0.68 0-1.56 0.52t-1.76 1.04l0.24 4.24q0.28 1 1.04 1 0.4 0 0.96-0.24t1.08-0.64q0.56-0.44 1-1t0.56-1.2zm22.88-4.96q-0.04 0.88-0.08 1.24t-0.24 0.8q-0.16 0.4-0.56 1.2t-1.12 2.56q-0.32 1.88-1.6 3.72-0.64 1.96-1.44 2.8-0.12 0.36-0.56 1.12t-0.96 1.6q-0.48 0.88-0.96 1.68-0.44 0.84-0.64 1.28-0.08 0.2-0.36 0.68-0.28 0.52-0.68 1.04-0.36 0.52-0.88 0.92-0.48 0.44-0.96 0.44-0.72 0-1.36-0.48-0.6-0.44-0.6-1.08 0-0.32 0.28-0.84 0.28-0.48 0.68-1.08 0.4-0.56 0.84-1.2 0.44-0.6 0.76-1.12 0.12-0.32 0.44-0.96t0.68-1.36q0.4-0.68 0.72-1.32 0.36-0.68 0.48-1.04-0.12-0.08-0.44-0.4-0.32-0.36-0.72-0.72-0.36-0.4-0.76-0.76t-0.72-0.52q-0.44-0.64-0.76-1t-0.6-0.6q-0.24-0.24-0.52-0.48t-0.64-0.68q-0.32-0.44-0.84-1.16-0.48-0.72-1.16-1.92-0.04-0.12-0.04-0.36 0-0.8 0.56-1.44 0.6-0.64 1.24-0.64 0.44 0 1 0.44 0.56 0.4 1.28 1.48 0.76 1.2 1.16 1.76 0.44 0.56 0.72 0.92 0.32 0.32 0.64 0.64 0.36 0.28 1 0.96 0.48 0.24 1.28 1.16l1.44-3.88q0.44-1.04 0.88-2.12 0.48-1.12 0.64-2.12 0.88-0.6 1.76-0.6 1.48 0 1.72 1.44zm35.08 10.04q-0.2 0.56-0.8 1.12t-1.16 0.56q-1.16 0-1.52-1.64t-0.36-4.64v-0.36q0-1.52-0.24-2.2-0.2-0.72-0.28-0.92-0.44-0.96-1.36-0.96-0.56 0-1.16 0.24-0.6 0.2-1.08 0.52-0.48 0.28-0.84 0.56-0.32 0.28-0.4 0.4-0.08 0.28-0.16 0.96-0.04 0.68-0.08 1.56t-0.08 1.8-0.08 1.68q0 0.76 0 1.2t0.04 0.36q-0.12 1.08-1.72 1.08-1.2 0-1.56-0.76-0.32-0.76-0.32-2.6 0-0.48 0-0.56 0.04-0.08 0.08-0.36 0.04-0.32 0.12-1.12t0.2-2.72q0.04-0.8 0.08-1.44 0.04-0.68 0-1.16 0-0.44 0-0.72 0-0.32-0.04-0.52 0.04-0.12 0.08-0.76 0.08-0.64 0.12-1.4 0.08-0.76 0.16-1.44t0.16-0.92q0-0.84 0.04-1.92 0.04-1.12 0.28-2.08t0.72-1.6q0.52-0.68 1.44-0.68 1.56 0 1.56 2 0 1.12-0.44 3.2-0.08 1.08-0.2 1.68-0.08 0.6-0.16 1.04t-0.12 0.84-0.04 1.12q1-0.84 1.92-0.96 0.92-0.16 1.72-0.16 2 0 3.2 1.16t1.8 3.84q0.04 0.96 0.04 1.52 0.04 0.52 0.08 1.2 0.08 0.64 0.16 1.76t0.2 3.2zm19.56-12.64q0.08 0.48 0.08 0.96t0 0.92q0 1.84-0.4 3.32-0.16 1-0.24 2.08-0.08 1.04-0.16 2.2 0 0.08 0.08 0.88 0.12 0.76 0.12 2.28 0 0.68-0.56 1.04-0.52 0.32-1.24 0.32-0.88 0-1.24-0.36-0.36-0.4-0.44-1.84-0.68 0.64-1.32 1-0.64 0.32-1.24 0.48-0.56 0.16-1.08 0.2-0.48 0.04-0.92 0.04-2.28 0-3.44-1.36t-1.16-3.76q0-0.28 0-0.56 0-0.32 0.04-0.72-0.04-0.08-0.04-0.36 0-0.44 0-0.88 0.04-0.48 0.16-1.16t0.36-1.68q0.28-1.04 0.76-2.64 0.52-0.64 1.4-0.64 0.68 0 1.16 0.36 0.52 0.36 0.52 1.12 0 0.2-0.12 0.8t-0.28 1.32-0.28 1.44-0.12 1.12v0.2q-0.08 0.44-0.12 0.88-0.04 0.4-0.04 0.76 0 1.04 0.28 1.72 0.32 0.68 1.32 0.68 0.72 0 1.36-0.32 0.64-0.36 1.16-0.84 0.56-0.52 0.96-1.08 0.4-0.6 0.6-1.12 0.2-1.48 0.72-3.88v-0.4q0-0.68 0.04-1.32 0.08-0.64 0.24-1.12 0.2-0.52 0.56-0.8 0.36-0.32 1-0.32 1.2 0 1.52 1.04zm29.16 12.08q0 0.52-0.6 0.88-0.56 0.32-1.24 0.32-0.8 0-1.2-0.52-0.36-0.52-0.52-1.32-0.16-0.84-0.2-1.84 0-1-0.04-1.92-0.08-0.28-0.2-0.8t-0.2-1.32q-1.08-1.2-2.6-1.2-0.56 0-1.12 0.12-0.56 0.08-1.04 0.44-0.48 0.32-0.88 1t-0.64 1.84q0.04 0.2 0.04 0.72 0 0.44-0.08 1.08-0.04 0.6-0.12 1.4v0.2q0 0.16 0 0.8 0 0.6-0.16 1.28-0.16 0.64-0.6 1.16-0.4 0.52-1.2 0.52-0.72 0-1.28-0.44-0.56-0.4-0.56-1 0-0.08 0.04-0.6 0.08-0.52 0.16-1.16 0.12-0.68 0.16-1.32 0.08-0.68 0.08-1.08 0-0.68-0.12-1.36v-0.52q0-2.04-0.8-3.84-0.6-0.48-1.88-0.64-0.24 0.08-0.6 0.24t-0.72 0.68q-0.36 0.48-0.64 1.4t-0.4 2.48l-0.12 1.64q0.24 1.2 0.24 2.08 0 1.04-0.36 1.68-0.32 0.6-1.48 0.6-0.6 0-1-0.12-0.36-0.16-0.6-0.64-0.2-0.52-0.28-1.48-0.08-1-0.08-2.64 0-1.32 0.16-2.56 0.16-1.28 0.48-3.28-0.12-0.68-0.36-1.24-0.2-0.6-0.2-0.92 0-0.68 0.6-1.2t1.4-0.52q0.6 0 1.08 0.36l0.68 0.88q0.48-0.4 0.84-0.6 0.36-0.24 0.64-0.36t0.56-0.12q0.28-0.04 0.64-0.04 0.52 0 0.8 0 0.32 0 0.64 0.12t0.72 0.4q0.44 0.24 1.2 0.76 0.48 0.32 1.28 2.08l0.24-0.28q0.32-0.28 0.88-0.56t1.2-0.48q0.68-0.24 1.36-0.36 0.72-0.16 1.28-0.16 1.32 0 2.28 0.28 0.96 0.24 1.64 0.76 0.68 0.48 1.2 1.28 0.52 0.76 1 1.76v0.28q0 0.32 0.08 1.16t0.16 1.68 0.16 1.48q0.08 0.6 0.08 0.52 0 0.04 0 0.28 0.04 0.2 0.04 0.52 0.04 0.28 0.04 0.6 0.04 0.28 0.04 0.44zm20.28-2.44q0.72 0.48 0.72 1.16 0 0.36-0.2 0.76-0.2 0.36-0.52 0.68-0.32 0.28-0.68 0.48t-0.72 0.2q-0.32-0.12-0.76-0.4-0.44-0.32-0.88-0.68-0.44-0.4-0.84-0.88-0.36-0.48-0.56-0.96l-0.28 0.68q-0.76 1.44-2.4 2.72-2 0.36-2.32 0.36-0.76 0-1.84-0.24l-2.2-1.56q-1.44-1.36-1.44-3.72 0-0.84 0.24-1.84 0.28-1.04 0.76-2.08 0.52-1.04 1.24-2.04t1.68-1.8q1.16-0.44 2.24-0.72 1.08-0.32 1.64-0.4 0.76-0.84 1.8-0.84 0.6 0 1.04 0.6 0.48 0.56 0.8 1.44 0.36 0.88 0.56 1.96 0.2 1.04 0.28 2l0.52 2.12q0.24 1 0.76 1.72 0.56 0.72 1.36 1.28zm-6.08-4.44q-0.08-0.04-0.6-2.52-0.2 0-0.6 0t-0.96 0.24q-0.52 0.2-1.16 0.76-0.6 0.52-1.16 1.6-0.84 1.56-0.84 3.12 0.68 1.32 2.12 2.08 0.44-0.12 0.72-0.28 0.32-0.16 0.56-0.44t0.44-0.68q0.24-0.44 0.52-1.08 0.52-0.92 0.72-1.6 0.24-0.72 0.24-1.2zm23.4 4.72v0.32q0 0.24 0 0.88 0.04 0.6-0.12 1.24-0.12 0.64-0.52 1.16-0.4 0.48-1.2 0.48-1.56 0-1.84-1.24 0.04-0.24 0.04-0.52 0-0.32 0-0.68 0-0.16 0-1.16 0-1.04-0.08-2.24-0.04-1.2-0.24-2.24-0.2-1.08-0.6-1.36-0.92-0.64-1.64-0.64-0.96 0-1.64 0.6-0.64 0.56-1.08 2.24-0.04 0.56-0.08 1.28-0.04 0.68-0.12 1.56 0 0.68 0.04 1.52 0.04 0.8 0.12 1.84 0 0.76-0.6 1.28-0.6 0.48-1.36 0.48-0.6 0-0.96-0.32t-0.56-0.84q-0.16-0.52-0.24-1.12-0.04-0.6-0.04-1.2 0-0.44 0.04-0.88 0.04-0.48 0.12-0.96l0.32-3.84 0.32-1.92q-0.08-0.48-0.32-1.04t-0.24-0.88q0-0.68 0.52-1.24 0.56-0.56 1.36-0.56 0.56 0 0.84 0.24 0.28 0.2 0.92 1.04 0.8-0.36 1.28-0.44 0.48-0.12 1.12-0.12 2.08 0 3.64 1 1.6 0.96 2 3.24 0.12 0.84 0.2 1.4 0.12 0.56 0.2 1.08t0.16 1.12q0.08 0.56 0.24 1.44zm16.56-0.16q-0.12 1.24-0.84 2.28-0.68 1-1.4 2.04-0.44 0.36-1.28 0.6-0.8 0.28-1.6 0.44t-1.4 0.24q-0.56 0.08-0.48 0.08-0.4 0-1.04-0.16-0.6-0.12-1.2-0.28-0.56-0.12-0.96-0.28-0.36-0.12-0.32-0.12-0.36-0.04-0.92-0.24-0.56-0.24-1.08-0.52-0.48-0.32-0.84-0.64-0.4-0.36-0.4-0.68t0.16-0.64q0.16-0.36 0.44-0.64 0.28-0.32 0.56-0.48 0.32-0.2 0.64-0.2l2.76 1.04q0.76 0.24 1.48 0.36 0.76 0.08 1.48 0.08 0.68 0 1.2-0.24 0.56-0.28 0.84-0.64l0.6-1.2q-0.08-0.72-0.6-1.12-0.48-0.4-1.24-0.68-0.72-0.28-1.56-0.52t-1.56-0.64l-1.72-1.08q-0.84-1.08-0.88-3.32 0.24-1.4 1.2-2.24 0.04-0.04 0.52-0.36 0.48-0.36 1.48-1 0.16 0 1-0.08 0.88-0.08 2.4-0.24 0.68 0 3.32 0.96 0.52 0.52 0.52 1.44 0 0.72-0.36 1.24-0.32 0.48-0.96 0.48-0.68 0-1.52-0.32-0.8-0.36-1.52-0.36-1 0-1.84 0.2-0.8 0.16-0.8 0.8 0 0.92 0.8 1.12 6.12 1.36 6.92 5.52z"
                    fill="currentColor"
                    aria-label="HEXROLL is created with love by humans"
                  />
                  <path
                    d="m108.8 87.78c-0.0852 0.0015-0.1706 0.0055-0.2553 0.01292-2.708 0.2362-3.097 1.359-4.545 2.479-1.449 1.121-3.154-1.748-4.794-2.022-1.64-0.274-3.956 0.03964-5.166 1.558-3.85 5.479 5.227 11.54 7.951 15.77 0.6545 0.8887 9.491-8.198 11.11-12.19 1.194-2.934-1.663-5.662-4.304-5.615zm-25.11 4.345c-0.08909 2.23e-4 -0.1821 0.0056-0.2785 0.01705-1.693 0.4011-2.115 3.981-2.224 5.714-0.1089 1.733 0.02311 2.351-0.03359 4.948-0.05667 2.596 0.5683 8.508 1.307 10.52 1.409 3.54 3.664 7.366 7.934 7.805 1.492-0.1483 6.38 0.4839 8.572-1 2.191-1.484 1.287-4.886 1.04-7.015-0.2469-2.129-2.651-4.54-3.99-5.815-1.339-1.274-2.033-2.118-2.771-2.713-1.34-1.027-2.67-1.032-2.783 0.8563-0.2853 1.646 3.214 4.327 3.163 5.848-0.07254 2.164-3.819 0.8304-5.89-3.102-1.058-2.009-1.933-6.524-1.978-8.961-0.02027-1.862 0.6933-7.106-2.069-7.099zm37.35 0.2294c-2.762-0.0069-2.048 5.237-2.069 7.099-0.0446 2.437-0.9204 6.952-1.978 8.961-2.07 3.932-5.817 5.266-5.89 3.102-0.051-1.52 3.448-4.201 3.163-5.848-0.1128-1.889-1.442-1.884-2.782-0.8563-0.7386 0.5949-1.433 1.438-2.772 2.712s-3.742 3.686-3.989 5.815-1.152 5.531 1.039 7.015c2.191 1.484 7.08 0.8526 8.572 1.001 4.271-0.4391 6.526-4.265 7.935-7.805 0.7391-2.01 1.364-7.921 1.307-10.52-0.0567-2.596 0.0753-3.214-0.0336-4.948-0.1089-1.733-0.5308-5.313-2.224-5.714-0.0965-0.01144-0.1889-0.01735-0.278-0.01757z"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.565"
                  />
                </g>
              </svg>
            </div>
            <h5>Credits</h5>

            <p>
              Core generator backend and frontend developed by Ithai Levi / Pen,
              Dice & Paper \u25fe Settlement maps generator by Oleg Doyla / WATABOU
              \u25fe Extra themes by Cille Rosen\u00f8rn Abildhauge / Penzilla and Andrew
              Sheppard \u25fe Additional content by Alex Gray
            </p>

            <h5>Licenses</h5>

            <h6>Designation of Open Game Content</h6>
            This document contains Open Game Content, subject to the Open Game
            License, released under the <strong>Open Game License</strong>,
            Version 1.0a (reproduced below), as described in Section 1(d) of the
            License. Any generated sandbox content not covered by the OGL is
            licensed under the Creative Commons
            Attribution-NonCommercial-ShareAlike 4.0 International license
            (<strong>CC BY-NC-SA 4.0</strong>)

            <h6>OPEN GAME LICENSE Version 1.0a</h6>

            <p>
              The following text is the property of Wizards of the Coast, Inc.
              and is Copyright 2000 Wizards of the Coast, Inc ("Wizards"). All
              Rights Reserved.
            </p>

            <p>
              1. Definitions: (a)"Contributors" means the copyright and/or
              trademark owners who have contributed Open Game Content;
              (b)"Derivative Material" means copyrighted material including
              derivative works and translations (including into other computer
              languages), potation, modification, correction, addition,
              extension, upgrade, improvement, compilation, abridgment or other
              form in which an existing work may be recast, transformed or
              adapted; (c) "Distribute" means to reproduce, license, rent,
              lease, sell, broadcast, publicly display, transmit or otherwise
              distribute; (d)"Open Game Content" means the game mechanic and
              includes the methods, procedures, processes and routines to the
              extent such content does not embody the Product Identity and is an
              enhancement over the prior art and any additional content clearly
              identified as Open Game Content by the Contributor, and means any
              work covered by this License, including translations and
              derivative works under copyright law, but specifically excludes
              Product Identity. (e) "Product Identity" means product and product
              line names, logos and identifying marks including trade dress;
              artifacts; creatures characters; stories, storylines, plots,
              thematic elements, dialogue, incidents, language, artwork,
              symbols, designs, depictions, likenesses, formats, poses,
              concepts, themes and graphic, photographic and other visual or
              audio representations; names and descriptions of characters,
              spells, enchantments, personalities, teams, personas, likenesses
              and special abilities; places, locations, environments, creatures,
              equipment, magical or supernatural abilities or effects, logos,
              symbols, or graphic designs; and any other trademark or registered
              trademark clearly identified as Product identity by the owner of
              the Product Identity, and which specifically excludes the Open
              Game Content; (f) "Trademark" means the logos, names, mark, sign,
              motto, designs that are used by a Contributor to identify itself
              or its products or the associated products contributed to the Open
              Game License by the Contributor (g) "Use", "Used" or "Using" means
              to use, Distribute, copy, edit, format, modify, translate and
              otherwise create Derivative Material of Open Game Content. (h)
              "You" or "Your" means the licensee in terms of this agreement.
            </p>

            <p>
              2. The License: This License applies to any Open Game Content that
              contains a notice indicating that the Open Game Content may only
              be Used under and in terms of this License. You must affix such a
              notice to any Open Game Content that you Use. No terms may be
              added to or subtracted from this License except as described by
              the License itself. No other terms or conditions may be applied to
              any Open Game Content distributed using this License.
            </p>

            <p>
              3. Offer and Acceptance: By Using the Open Game Content You
              indicate Your acceptance of the terms of this License.
            </p>

            <p>
              4. Grant and Consideration: In consideration for agreeing to use
              this License, the Contributors grant You a perpetual, worldwide,
              royalty-free, non-exclusive license with the exact terms of this
              License to Use, the Open Game Content.
            </p>

            <p>
              5. Representation of Authority to Contribute: If You are
              contributing original material as Open Game Content, You represent
              that Your Contributions are Your original creation and/or You have
              sufficient rights to grant the rights conveyed by this License.
            </p>

            <p>
              6. Notice of License Copyright: You must update the COPYRIGHT
              NOTICE portion of this License to include the exact text of the
              COPYRIGHT NOTICE of any Open Game Content You are copying,
              modifying or distributing, and You must add the title, the
              copyright date, and the copyright holder's name to the COPYRIGHT
              NOTICE of any original Open Game Content you Distribute.
            </p>

            <p>
              7. Use of Product Identity: You agree not to Use any Product
              Identity, including as an indication as to compatibility, except
              as expressly licensed in another, independent Agreement with the
              owner of each element of that Product Identity. You agree not to
              indicate compatibility or co-adaptability with any Trademark or
              Registered Trademark in conjunction with a work containing Open
              Game Content except as expressly licensed in another, independent
              Agreement with the owner of such Trademark or Registered
              Trademark. The use of any Product Identity in Open Game Content
              does not constitute a challenge to the ownership of that Product
              Identity. The owner of any Product Identity used in Open Game
              Content shall retain all rights, title and interest in and to that
              Product Identity.
            </p>

            <p>
              8. Identification: If you distribute Open Game Content You must
              clearly indicate which portions of the work that you are
              distributing are Open Game Content.
            </p>

            <p>
              9. Updating the License: Wizards or its designated Agents may
              publish updated versions of this License. You may use any
              authorized version of this License to copy, modify and distribute
              any Open Game Content originally distributed under any version of
              this License.
            </p>

            <p>
              10. Copy of this License: You MUST include a copy of this License
              with every copy of the Open Game Content You Distribute.
            </p>

            <p>
              11. Use of Contributor Credits: You may not market or advertise
              the Open Game Content using the name of any Contributor unless You
              have written permission from the Contributor to do so.
            </p>

            <p>
              12. Inability to Comply: If it is impossible for You to comply
              with any of the terms of this License with respect to some or all
              of the Open Game Content due to statute, judicial order, or
              governmental regulation then You may not Use any Open Game
              Material so affected.
            </p>

            <p>
              13. Termination: This License will terminate automatically if You
              fail to comply with all terms herein and fail to cure such breach
              within 30 days of becoming aware of the breach. All sublicenses
              shall survive the termination of this License.
            </p>

            <p>
              14. Reformation: If any provision of this License is held to be
              unenforceable, such provision shall be reformed only to the extent
              necessary to make it enforceable.
            </p>

            <p>
              15. COPYRIGHT NOTICE Open Game License v 1.0 Copyright 2000,
              Wizards of the Coast, Inc.
            </p>

            <p>HEXROLL 2E is copyright (c) 2021-2024 pendicepaper.com.</p>
          </div>
        </div>
      </div>`}}class ExpiredDialog$$module$readme extends ModalDialog$$module$utils{render(a,b){return html$$module$readme` <div id="ExpiredModal" class="modal">
      <div class="modal-content">
        <div class="close">
          <a onClick="${a.onExit}"> ${"\u00d7"} </a>
        </div>
        <h5>SANDBOX EXPIRED</h5>
        <p>
          Your ephemeral sandbox expired. Please use this last opportunity to
          <a
            class="detectable"
            href="https://docs.hexroll.app/playing-with-hexroll/using-hexroll-offline"
            target="_blank"
          >
            download a snapshot
          </a>
          of your sandbox before it gets removed from our online storage.
        </p>
        <h6>Why is my sandbox ephemeral?</h6>
        <p>
          When you generate a sandbox, it is stored and managed online. When
          your sandbox is online, you can use all the online editing tools as
          well as the built-in VTT mode.
        </p>
        <p>
          To maintain reasonable performance, we use fast distributed storage to
          manage this data, but it can fill up pretty quickly and it is not
          free. To conserve storage, HEXROLL expires any guest-generated sandbox
          after 30 days and cleans up the data shortly after.
        </p>
        <h6>Patreon 'Brave Adventurer' subscribers</h6>
        <p>
          If you are a Patreon 'Brave Adventurer' subscriber and you want to
          keep this sandbox online, make sure you login to your account and
          visit this page again to claim your sandbox. This will remove the
          expiration and you will be able to continue using this sandbox online
          for the duration of your subscription.
        </p>
        <p>
          <small>
            If you have any questions or concerns, use the feedback tab on the
            right-hand side of the map to contact me. Make sure you specify your
            e-mail if you want me to contact you back.</small
          >
        </p>
      </div>
    </div>`}}
class SoloDialog$$module$readme extends ModalDialog$$module$utils{constructor(){super();this.state={some_points_exist:!1}}componentDidMount(a,b,c){super.componentDidMount(a,b,c);console.log("toc",this.props.instance);api_call_html$$module$api_shim("view",this.props.instance,this.props.instance).then(d=>{var e=document.implementation.createHTMLDocument();e.open();e.write(d);e.close();e.getElementById("toc-settlements-1")&&(this.setState({some_points_exist:!0}),d=e.getElementById("toc-settlements-1").innerHTML,document.getElementById("solo-settlements").innerHTML=
d);e.getElementById("toc-dungeons-1")&&(this.setState({some_points_exist:!0}),e=e.getElementById("toc-dungeons-1").innerHTML,document.getElementById("solo-dungeons").innerHTML=e)})}render(a,b){return html$$module$readme` <div id="ExpiredModal" class="modal">
      <div class="modal-content modal-content-flex">
        <div class="modal-header">
          <div class="close">
            <a onClick="${a.onExit}"> ${"\u00d7"} </a>
          </div>
          <h5>CHOOSE A STARTING POINT</h5>
        </div>
        <div class="modal-body">
          <p>
            Welcome to your solo sandbox. In solo mode, the hex map is revealed
            incrementally - starting with the first hex you visit.
          </p>
          ${b.some_points_exist?html$$module$readme`
                <p>
                  You can choose one of the following locations as your starting
                  point or close this window to search for one using the search
                  bar.
                </p>
              `:html$$module$readme`
                <p>
                  There are no settlements or dungeons in the sandbox. Please
                  close this window and search for a starting point using the
                  search bar.
                </p>
              `}
          <div id="entity-container">
            <div class="toc-section">
              <div class="toc-subsection">
                <div id="solo-settlements" class="toc-column"></div>
                <div id="solo-dungeons" class="toc-column"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>`}}class HelpDialog$$module$readme extends ModalDialog$$module$utils{render(a,b){return html$$module$readme` <div id="myModal" class="modal">
      <div class="modal-content modal-content-flex">
        <div class="modal-header">
          <div class="close">
            <a onClick="${a.onExit}"> ${"\u00d7"} </a>
          </div>
          <h5 style="margin-bottom:0;">Quick Help</h5>
          <small>
            For more help visit
            <a href="https://docs.hexroll.app" target="_blank"
              >docs.hexroll.app</a
            ></small
          >
        </div>
        <div class="modal-body help-tables">
          <h4>Keyboard Shortcuts</h4>
          <h5>General</h5>
          <table>
            <tr>
              <td class="help-key">Search</td>
              <td><span class="key-button"> ${"`"} </span></td>
              <td class="help-key">Toggle Labels</td>
              <td><span class="key-button"> ${"L"} </span></td>
              <td class="help-key">Toggle Dice Box</td>
              <td><span class="key-button"> ${"R"} </span></td>
              <td class="help-key">Show this quick help window</td>
              <td><span class="key-button"> ${"H"} </span></td>
            </tr>
          </table>

          <h5>Crawl Mode</h5>
          <table>
            <tr>
              <td class="help-key">Navigate</td>
              <td>
                <span class="key-button"> ${"W"} </span>
                <span class="key-button"> ${"A"} </span>
                <span class="key-button"> ${"S"} </span>
                <span class="key-button"> ${"D"} </span>
                and
                <span class="key-button"> ${"Q"} </span>
                <span class="key-button"> ${"E"} </span>
              </td>
              <td class="help-key">Drop a Pin</td>
              <td><span class="key-button"> ${"P"} </span></td>
              <td class="help-key">Edit Page</td>
              <td>
                <span class="key-button"> ${"CTRL"} </span> +
                <span class="key-button"> ${"E"} </span>
              </td>
            </tr>
          </table>

          <h5>Vtt</h5>
          <table>
            <tr>
              <td>Toggle Hex Player Visibility</td>
              <td>
                <span class="key-button"> ${"SPACE"} </span>
              </td>
              <td>Roll d20</td>
              <td><span class="key-button"> ${"2"} </span></td>
              <td>Roll d6</td>
              <td><span class="key-button"> ${"6"} </span></td>
            </tr>
            <tr>
              <td>Indicate Hex to Players</td>
              <td><span class="key-button"> ${"F"} </span></td>
              <td>Roll d12</td>
              <td><span class="key-button"> ${"3"} </span></td>
              <td>Roll d4</td>
              <td><span class="key-button"> ${"7"} </span></td>
            </tr>
            <tr>
              <td>Place a token in dungeon or battle maps</td>
              <td><span class="key-button"> ${"T"} </span></td>
              <td>Roll d10</td>
              <td><span class="key-button"> ${"4"} </span></td>
              <td>Roll d7</td>
              <td><span class="key-button"> ${"8"} </span></td>
            </tr>
            <tr>
              <td>Remove a token</td>
              <td><span class="key-button"> ${"K"} </span></td>
              <td>Roll d8</td>
              <td><span class="key-button"> ${"5"} </span></td>
              <td>Roll d100</td>
              <td><span class="key-button"> ${"0"} </span></td>
            </tr>
            <tr>
              <td>Center players on selected hex</td>
              <td><span class="key-button"> ${"J"} </span></td>
              <td></td>
              <td></td>
              <td>Clear Dice</td>
              <td><span class="key-button"> ${"C"} </span></td>
            </tr>
          </table>
        </div>
      </div>
    </div>`}}var module$readme={};module$readme.ExpiredDialog=ExpiredDialog$$module$readme;module$readme.HelpDialog=HelpDialog$$module$readme;module$readme.ReadmeDialog=ReadmeDialog$$module$readme;module$readme.SoloDialog=SoloDialog$$module$readme;module$readme.VttDialog=VttDialog$$module$readme;/*
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource>  queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource>  safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource>  simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
const create$$module$libs$y_webrtc_min=()=>new Map,copy$$module$libs$y_webrtc_min=a=>{const b=create$$module$libs$y_webrtc_min();return a.forEach((c,d)=>{b.set(d,c)}),b},setIfUndefined$$module$libs$y_webrtc_min=(a,b,c)=>{let d=a.get(b);return void 0===d&&a.set(b,d=c()),d},create$1$$module$libs$y_webrtc_min=()=>new Set,last$$module$libs$y_webrtc_min=a=>a[a.length-1],appendTo$$module$libs$y_webrtc_min=(a,b)=>{for(let c=0;c<b.length;c++)a.push(b[c])},from$$module$libs$y_webrtc_min=Array.from,isArray$$module$libs$y_webrtc_min=
Array.isArray;
class Observable$$module$libs$y_webrtc_min{constructor(){this._observers=create$$module$libs$y_webrtc_min()}on(a,b){setIfUndefined$$module$libs$y_webrtc_min(this._observers,a,create$1$$module$libs$y_webrtc_min).add(b)}once(a,b){const c=(...d)=>{this.off(a,c);b(...d)};this.on(a,c)}off(a,b){const c=this._observers.get(a);void 0!==c&&(c.delete(b),0===c.size&&this._observers.delete(a))}emit(a,b){return from$$module$libs$y_webrtc_min((this._observers.get(a)||create$$module$libs$y_webrtc_min()).values()).forEach(c=>c(...b))}destroy(){this._observers=
create$$module$libs$y_webrtc_min()}}
const floor$$module$libs$y_webrtc_min=Math.floor,abs$$module$libs$y_webrtc_min=Math.abs,log10$$module$libs$y_webrtc_min=Math.log10,min$$module$libs$y_webrtc_min=(a,b)=>a<b?a:b,max$$module$libs$y_webrtc_min=(a,b)=>a>b?a:b,isNegativeZero$$module$libs$y_webrtc_min=a=>0!==a?0>a:0>1/a,getUnixTime$$module$libs$y_webrtc_min=Date.now,setupWS$$module$libs$y_webrtc_min=a=>{if(a.shouldConnect&&null===a.ws){const b=new WebSocket(a.url),c=a.binaryType;let d=null;c&&(b.binaryType=c);a.ws=b;a.connecting=!0;a.connected=
!1;b.onmessage=n=>{a.lastMessageReceived=getUnixTime$$module$libs$y_webrtc_min();n=n.data;(n="string"==typeof n?JSON.parse(n):n)&&"pong"===n.type&&(clearTimeout(d),d=setTimeout(g,15E3));a.emit("message",[n,a])};const e=n=>{null!==a.ws&&(a.ws=null,a.connecting=!1,a.connected?(a.connected=!1,a.emit("disconnect",[{type:"disconnect",error:n},a])):a.unsuccessfulReconnects++,setTimeout(setupWS$$module$libs$y_webrtc_min,min$$module$libs$y_webrtc_min(1200*log10$$module$libs$y_webrtc_min(a.unsuccessfulReconnects+
1),2500),a));clearTimeout(d)},g=()=>{a.ws===b&&a.send({type:"ping"})};b.onclose=()=>e(null);b.onerror=n=>e(n);b.onopen=()=>{a.lastMessageReceived=getUnixTime$$module$libs$y_webrtc_min();a.connecting=!1;a.connected=!0;a.unsuccessfulReconnects=0;a.emit("connect",[{type:"connect"},a]);d=setTimeout(g,15E3)}}};
class WebsocketClient$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,{binaryType:b}={}){super();this.url=a;this.ws=null;this.binaryType=b||null;this.connecting=this.connected=!1;this.lastMessageReceived=this.unsuccessfulReconnects=0;this.shouldConnect=!0;this._checkInterval=setInterval(()=>{this.connected&&3E4<getUnixTime$$module$libs$y_webrtc_min()-this.lastMessageReceived&&this.ws.close()},15E3);setupWS$$module$libs$y_webrtc_min(this)}send(a){this.ws&&this.ws.send(JSON.stringify(a))}destroy(){clearInterval(this._checkInterval);
this.disconnect();super.destroy()}disconnect(){this.shouldConnect=!1;null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0;this.connected||null!==this.ws||setupWS$$module$libs$y_webrtc_min(this)}}
const create$2$$module$libs$y_webrtc_min=a=>Error(a),methodUnimplemented$$module$libs$y_webrtc_min=()=>{throw create$2$$module$libs$y_webrtc_min("Method unimplemented");},unexpectedCase$$module$libs$y_webrtc_min=()=>{throw create$2$$module$libs$y_webrtc_min("Unexpected case");},getRandomValues$$module$libs$y_webrtc_min=crypto.getRandomValues.bind(crypto),rand$$module$libs$y_webrtc_min=Math.random,uint32$$module$libs$y_webrtc_min=()=>getRandomValues$$module$libs$y_webrtc_min(new Uint32Array(1))[0],
uuidv4Template$$module$libs$y_webrtc_min="10000000-1000-4000-8000-100000000000",uuidv4$$module$libs$y_webrtc_min=()=>uuidv4Template$$module$libs$y_webrtc_min.replace(/[018]/g,a=>(a^uint32$$module$libs$y_webrtc_min()&15>>a/4).toString(16)),fromCharCode$$module$libs$y_webrtc_min=String.fromCharCode,trimLeftRegex$$module$libs$y_webrtc_min=/^\s*/g,fromCamelCaseRegex$$module$libs$y_webrtc_min=/([A-Z])/g,fromCamelCase$$module$libs$y_webrtc_min=(a,b)=>a.replace(fromCamelCaseRegex$$module$libs$y_webrtc_min,
c=>`${b}${c.toLowerCase()}`).replace(trimLeftRegex$$module$libs$y_webrtc_min,""),utf8TextEncoder$$module$libs$y_webrtc_min="undefined"!=typeof TextEncoder?new TextEncoder:null,encodeUtf8$$module$libs$y_webrtc_min=utf8TextEncoder$$module$libs$y_webrtc_min?a=>utf8TextEncoder$$module$libs$y_webrtc_min.encode(a):a=>{a=unescape(encodeURIComponent(a));const b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.codePointAt(d);return c};
let utf8TextDecoder$$module$libs$y_webrtc_min="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});utf8TextDecoder$$module$libs$y_webrtc_min&&1===utf8TextDecoder$$module$libs$y_webrtc_min.decode(new Uint8Array).length&&(utf8TextDecoder$$module$libs$y_webrtc_min=null);const repeat$$module$libs$y_webrtc_min=(a,b)=>((c,d)=>{const e=Array(c);for(let g=0;g<c;g++)e[g]=d(g,e);return e})(b,()=>a).join(""),undefinedToNull$$module$libs$y_webrtc_min=a=>void 0===a?null:a;
let _localStorage$$module$libs$y_webrtc_min=new class{constructor(){this.map=new Map}setItem(a,b){this.map.set(a,b)}getItem(a){return this.map.get(a)}},usePolyfill$$module$libs$y_webrtc_min=!0;try{"undefined"!=typeof localStorage&&(_localStorage$$module$libs$y_webrtc_min=localStorage,usePolyfill$$module$libs$y_webrtc_min=!1)}catch(a){}
const varStorage$$module$libs$y_webrtc_min=_localStorage$$module$libs$y_webrtc_min,assign$$module$libs$y_webrtc_min=Object.assign,keys$$module$libs$y_webrtc_min=Object.keys,length$$module$libs$y_webrtc_min=a=>keys$$module$libs$y_webrtc_min(a).length,hasProperty$$module$libs$y_webrtc_min=(a,b)=>Object.prototype.hasOwnProperty.call(a,b),callAll$$module$libs$y_webrtc_min=(a,b,c=0)=>{try{for(;c<a.length;c++)a[c](...b)}finally{c<a.length&&callAll$$module$libs$y_webrtc_min(a,b,c+1)}},nop$$module$libs$y_webrtc_min=
()=>{},id$$module$libs$y_webrtc_min=a=>a,equalityDeep$$module$libs$y_webrtc_min=(a,b)=>{if(null==a||null==b)return a===b;if(a.constructor!==b.constructor)return!1;if(a===b)return!0;switch(a.constructor){case ArrayBuffer:a=new Uint8Array(a),b=new Uint8Array(b);case Uint8Array:if(a.byteLength!==b.byteLength)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;break;case Set:if(a.size!==b.size)return!1;for(c of a)if(!b.has(c))return!1;break;case Map:if(a.size!==b.size)return!1;for(const d of a.keys())if(!b.has(d)||
!equalityDeep$$module$libs$y_webrtc_min(a.get(d),b.get(d)))return!1;break;case Object:if(length$$module$libs$y_webrtc_min(a)!==length$$module$libs$y_webrtc_min(b))return!1;for(const d in a)if(!hasProperty$$module$libs$y_webrtc_min(a,d)||!equalityDeep$$module$libs$y_webrtc_min(a[d],b[d]))return!1;break;case Array:if(a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(!equalityDeep$$module$libs$y_webrtc_min(a[c],b[c]))return!1;break;default:return!1}return!0},isNode$$module$libs$y_webrtc_min="undefined"!=
typeof process&&process.release&&/node|io\.js/.test(process.release.name),isBrowser$$module$libs$y_webrtc_min="undefined"!=typeof window&&"undefined"!=typeof document&&!isNode$$module$libs$y_webrtc_min;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let params$$module$libs$y_webrtc_min;
const hasParam$$module$libs$y_webrtc_min=a=>(()=>{if(void 0===params$$module$libs$y_webrtc_min)if(isNode$$module$libs$y_webrtc_min){params$$module$libs$y_webrtc_min=create$$module$libs$y_webrtc_min();const b=process.argv;let c=null;for(let d=0;d<b.length;d++){const e=b[d];"-"===e[0]?(null!==c&&params$$module$libs$y_webrtc_min.set(c,""),c=e):null!==c&&(params$$module$libs$y_webrtc_min.set(c,e),c=null)}null!==c&&params$$module$libs$y_webrtc_min.set(c,"")}else"object"==typeof location?(params$$module$libs$y_webrtc_min=
create$$module$libs$y_webrtc_min(),(location.search||"?").slice(1).split("&").forEach(b=>{if(0!==b.length){const [c,d]=b.split("=");params$$module$libs$y_webrtc_min.set("--"+fromCamelCase$$module$libs$y_webrtc_min(c,"-"),d);params$$module$libs$y_webrtc_min.set("-"+fromCamelCase$$module$libs$y_webrtc_min(c,"-"),d)}})):params$$module$libs$y_webrtc_min=create$$module$libs$y_webrtc_min();return params$$module$libs$y_webrtc_min})().has(a),getVariable$$module$libs$y_webrtc_min=a=>undefinedToNull$$module$libs$y_webrtc_min(isNode$$module$libs$y_webrtc_min?
process.env[a.toUpperCase()]:varStorage$$module$libs$y_webrtc_min.getItem(a));hasParam$$module$libs$y_webrtc_min("--"+(name$$module$libs$y_webrtc_min="production"))||getVariable$$module$libs$y_webrtc_min(name$$module$libs$y_webrtc_min);var name$$module$libs$y_webrtc_min;const forceColor$$module$libs$y_webrtc_min=isNode$$module$libs$y_webrtc_min&&(value$$module$libs$y_webrtc_min=process.env.FORCE_COLOR,["true","1","2"].includes(value$$module$libs$y_webrtc_min));var value$$module$libs$y_webrtc_min;
const supportsColor$$module$libs$y_webrtc_min=!hasParam$$module$libs$y_webrtc_min("no-colors")&&(!isNode$$module$libs$y_webrtc_min||process.stdout.isTTY||forceColor$$module$libs$y_webrtc_min)&&(!isNode$$module$libs$y_webrtc_min||hasParam$$module$libs$y_webrtc_min("color")||forceColor$$module$libs$y_webrtc_min||null!==getVariable$$module$libs$y_webrtc_min("COLORTERM")||(getVariable$$module$libs$y_webrtc_min("TERM")||"").includes("color")),MAX_SAFE_INTEGER$$module$libs$y_webrtc_min=Number.MAX_SAFE_INTEGER,
isInteger$$module$libs$y_webrtc_min=Number.isInteger||(a=>"number"==typeof a&&isFinite(a)&&floor$$module$libs$y_webrtc_min(a)===a),errorUnexpectedEndOfArray$$module$libs$y_webrtc_min=create$2$$module$libs$y_webrtc_min("Unexpected end of array"),errorIntegerOutOfRange$$module$libs$y_webrtc_min=create$2$$module$libs$y_webrtc_min("Integer out of Range");class Decoder$$module$libs$y_webrtc_min{constructor(a){this.arr=a;this.pos=0}}
const createDecoder$$module$libs$y_webrtc_min=a=>new Decoder$$module$libs$y_webrtc_min(a),hasContent$$module$libs$y_webrtc_min=a=>a.pos!==a.arr.length,readVarUint8Array$$module$libs$y_webrtc_min=a=>{var b=readVarUint$$module$libs$y_webrtc_min(a);const c=createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.arr.buffer,a.pos+a.arr.byteOffset,b);return a.pos+=b,c},readUint8$$module$libs$y_webrtc_min=a=>a.arr[a.pos++],readVarUint$$module$libs$y_webrtc_min=a=>{let b=0,c=1;const d=a.arr.length;
for(;a.pos<d;){const e=a.arr[a.pos++];if(b+=(127&e)*c,c*=128,128>e)return b;if(b>MAX_SAFE_INTEGER$$module$libs$y_webrtc_min)throw errorIntegerOutOfRange$$module$libs$y_webrtc_min;}throw errorUnexpectedEndOfArray$$module$libs$y_webrtc_min;},readVarInt$$module$libs$y_webrtc_min=a=>{let b=a.arr[a.pos++],c=63&b,d=64;const e=0<(64&b)?-1:1;if(0==(128&b))return e*c;const g=a.arr.length;for(;a.pos<g;){if(b=a.arr[a.pos++],c+=(127&b)*d,d*=128,128>b)return e*c;if(c>MAX_SAFE_INTEGER$$module$libs$y_webrtc_min)throw errorIntegerOutOfRange$$module$libs$y_webrtc_min;
}throw errorUnexpectedEndOfArray$$module$libs$y_webrtc_min;},readVarString$$module$libs$y_webrtc_min=utf8TextDecoder$$module$libs$y_webrtc_min?a=>utf8TextDecoder$$module$libs$y_webrtc_min.decode(readVarUint8Array$$module$libs$y_webrtc_min(a)):a=>{let b=readVarUint$$module$libs$y_webrtc_min(a);if(0===b)return"";let c=String.fromCodePoint(readUint8$$module$libs$y_webrtc_min(a));if(100>--b)for(;b--;)c+=String.fromCodePoint(readUint8$$module$libs$y_webrtc_min(a));else for(;0<b;){const d=1E4>b?b:1E4,e=
a.arr.subarray(a.pos,a.pos+d);a.pos+=d;c+=String.fromCodePoint.apply(null,e);b-=d}return decodeURIComponent(escape(c))},readFromDataView$$module$libs$y_webrtc_min=(a,b)=>{const c=new DataView(a.arr.buffer,a.arr.byteOffset+a.pos,b);return a.pos+=b,c},readAnyLookupTable$$module$libs$y_webrtc_min=[a=>{},a=>null,readVarInt$$module$libs$y_webrtc_min,a=>readFromDataView$$module$libs$y_webrtc_min(a,4).getFloat32(0,!1),a=>readFromDataView$$module$libs$y_webrtc_min(a,8).getFloat64(0,!1),a=>readFromDataView$$module$libs$y_webrtc_min(a,
8).getBigInt64(0,!1),a=>!1,a=>!0,readVarString$$module$libs$y_webrtc_min,a=>{const b=readVarUint$$module$libs$y_webrtc_min(a),c={};for(let d=0;d<b;d++)c[readVarString$$module$libs$y_webrtc_min(a)]=readAny$$module$libs$y_webrtc_min(a);return c},a=>{const b=readVarUint$$module$libs$y_webrtc_min(a),c=[];for(let d=0;d<b;d++)c.push(readAny$$module$libs$y_webrtc_min(a));return c},readVarUint8Array$$module$libs$y_webrtc_min],readAny$$module$libs$y_webrtc_min=a=>readAnyLookupTable$$module$libs$y_webrtc_min[127-
readUint8$$module$libs$y_webrtc_min(a)](a);class RleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a,b){super(a);this.reader=b;this.s=null;this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),hasContent$$module$libs$y_webrtc_min(this)?this.count=readVarUint$$module$libs$y_webrtc_min(this)+1:this.count=-1),this.count--,this.s}}
class UintOptRleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a){super(a);this.count=this.s=0}read(){if(0===this.count){this.s=readVarInt$$module$libs$y_webrtc_min(this);const a=isNegativeZero$$module$libs$y_webrtc_min(this.s);this.count=1;a&&(this.s=-this.s,this.count=readVarUint$$module$libs$y_webrtc_min(this)+2)}return this.count--,this.s}}
class IntDiffOptRleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a){super(a);this.diff=this.count=this.s=0}read(){if(0===this.count){const a=readVarInt$$module$libs$y_webrtc_min(this),b=1&a;this.diff=floor$$module$libs$y_webrtc_min(a/2);this.count=1;b&&(this.count=readVarUint$$module$libs$y_webrtc_min(this)+2)}return this.s+=this.diff,this.count--,this.s}}
class StringDecoder$$module$libs$y_webrtc_min{constructor(a){this.decoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(a);this.str=readVarString$$module$libs$y_webrtc_min(this.decoder);this.spos=0}read(){const a=this.spos+this.decoder.read(),b=this.str.slice(this.spos,a);return this.spos=a,b}}
const createUint8ArrayFromLen$$module$libs$y_webrtc_min=a=>new Uint8Array(a),createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min=(a,b,c)=>new Uint8Array(a,b,c),toBase64$$module$libs$y_webrtc_min=isBrowser$$module$libs$y_webrtc_min?a=>{let b="";for(let c=0;c<a.byteLength;c++)b+=fromCharCode$$module$libs$y_webrtc_min(a[c]);return btoa(b)}:a=>Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString("base64"),fromBase64$$module$libs$y_webrtc_min=isBrowser$$module$libs$y_webrtc_min?a=>{a=atob(a);
const b=createUint8ArrayFromLen$$module$libs$y_webrtc_min(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}:a=>{a=Buffer.from(a,"base64");return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)};class Encoder$$module$libs$y_webrtc_min{constructor(){this.cpos=0;this.cbuf=new Uint8Array(100);this.bufs=[]}}
const createEncoder$$module$libs$y_webrtc_min=()=>new Encoder$$module$libs$y_webrtc_min,toUint8Array$$module$libs$y_webrtc_min=a=>{var b=Uint8Array,c=a.cpos;for(var d=0;d<a.bufs.length;d++)c+=a.bufs[d].length;b=new b(c);c=0;for(d=0;d<a.bufs.length;d++){const e=a.bufs[d];b.set(e,c);c+=e.length}return b.set(createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.cbuf.buffer,0,a.cpos),c),b},write$$module$libs$y_webrtc_min=(a,b)=>{const c=a.cbuf.length;a.cpos===c&&(a.bufs.push(a.cbuf),a.cbuf=
new Uint8Array(2*c),a.cpos=0);a.cbuf[a.cpos++]=b},writeUint8$$module$libs$y_webrtc_min=write$$module$libs$y_webrtc_min,writeVarUint$$module$libs$y_webrtc_min=(a,b)=>{for(;127<b;)write$$module$libs$y_webrtc_min(a,128|127&b),b=floor$$module$libs$y_webrtc_min(b/128);write$$module$libs$y_webrtc_min(a,127&b)},writeVarInt$$module$libs$y_webrtc_min=(a,b)=>{const c=isNegativeZero$$module$libs$y_webrtc_min(b);c&&(b=-b);write$$module$libs$y_webrtc_min(a,(63<b?128:0)|(c?64:0)|63&b);for(b=floor$$module$libs$y_webrtc_min(b/
64);0<b;)write$$module$libs$y_webrtc_min(a,(127<b?128:0)|127&b),b=floor$$module$libs$y_webrtc_min(b/128)},_strBuffer$$module$libs$y_webrtc_min=new Uint8Array(3E4),_maxStrBSize$$module$libs$y_webrtc_min=_strBuffer$$module$libs$y_webrtc_min.length/3,writeVarString$$module$libs$y_webrtc_min=utf8TextEncoder$$module$libs$y_webrtc_min&&utf8TextEncoder$$module$libs$y_webrtc_min.encodeInto?(a,b)=>{if(b.length<_maxStrBSize$$module$libs$y_webrtc_min){b=utf8TextEncoder$$module$libs$y_webrtc_min.encodeInto(b,
_strBuffer$$module$libs$y_webrtc_min).written||0;writeVarUint$$module$libs$y_webrtc_min(a,b);for(let c=0;c<b;c++)write$$module$libs$y_webrtc_min(a,_strBuffer$$module$libs$y_webrtc_min[c])}else writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeUtf8$$module$libs$y_webrtc_min(b))}:(a,b)=>{b=unescape(encodeURIComponent(b));const c=b.length;writeVarUint$$module$libs$y_webrtc_min(a,c);for(let d=0;d<c;d++)write$$module$libs$y_webrtc_min(a,b.codePointAt(d))},writeUint8Array$$module$libs$y_webrtc_min=(a,
b)=>{const c=a.cbuf.length,d=a.cpos,e=min$$module$libs$y_webrtc_min(c-d,b.length),g=b.length-e;a.cbuf.set(b.subarray(0,e),d);a.cpos+=e;0<g&&(a.bufs.push(a.cbuf),a.cbuf=new Uint8Array(max$$module$libs$y_webrtc_min(2*c,g)),a.cbuf.set(b.subarray(e)),a.cpos=g)},writeVarUint8Array$$module$libs$y_webrtc_min=(a,b)=>{writeVarUint$$module$libs$y_webrtc_min(a,b.byteLength);writeUint8Array$$module$libs$y_webrtc_min(a,b)},writeOnDataView$$module$libs$y_webrtc_min=(a,b)=>{var c=a.cbuf.length;c-a.cpos<b&&(a.bufs.push(createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.cbuf.buffer,
0,a.cpos)),a.cbuf=new Uint8Array(2*max$$module$libs$y_webrtc_min(c,b)),a.cpos=0);c=new DataView(a.cbuf.buffer,a.cpos,b);return a.cpos+=b,c},floatTestBed$$module$libs$y_webrtc_min=new DataView(new ArrayBuffer(4)),writeAny$$module$libs$y_webrtc_min=(a,b)=>{switch(typeof b){case "string":write$$module$libs$y_webrtc_min(a,119);writeVarString$$module$libs$y_webrtc_min(a,b);break;case "number":isInteger$$module$libs$y_webrtc_min(b)&&2147483647>=abs$$module$libs$y_webrtc_min(b)?(write$$module$libs$y_webrtc_min(a,
125),writeVarInt$$module$libs$y_webrtc_min(a,b)):(c=b,floatTestBed$$module$libs$y_webrtc_min.setFloat32(0,c),floatTestBed$$module$libs$y_webrtc_min.getFloat32(0)===c?(write$$module$libs$y_webrtc_min(a,124),((d,e)=>{writeOnDataView$$module$libs$y_webrtc_min(d,4).setFloat32(0,e,!1)})(a,b)):(write$$module$libs$y_webrtc_min(a,123),((d,e)=>{writeOnDataView$$module$libs$y_webrtc_min(d,8).setFloat64(0,e,!1)})(a,b)));break;case "bigint":write$$module$libs$y_webrtc_min(a,122);((d,e)=>{writeOnDataView$$module$libs$y_webrtc_min(d,
8).setBigInt64(0,e,!1)})(a,b);break;case "object":if(null===b)write$$module$libs$y_webrtc_min(a,126);else if(isArray$$module$libs$y_webrtc_min(b))for(write$$module$libs$y_webrtc_min(a,117),writeVarUint$$module$libs$y_webrtc_min(a,b.length),c=0;c<b.length;c++)writeAny$$module$libs$y_webrtc_min(a,b[c]);else if(b instanceof Uint8Array)write$$module$libs$y_webrtc_min(a,116),writeVarUint8Array$$module$libs$y_webrtc_min(a,b);else{write$$module$libs$y_webrtc_min(a,118);c=Object.keys(b);writeVarUint$$module$libs$y_webrtc_min(a,
c.length);for(let d=0;d<c.length;d++){const e=c[d];writeVarString$$module$libs$y_webrtc_min(a,e);writeAny$$module$libs$y_webrtc_min(a,b[e])}}break;case "boolean":write$$module$libs$y_webrtc_min(a,b?120:121);break;default:write$$module$libs$y_webrtc_min(a,127)}var c};
class RleEncoder$$module$libs$y_webrtc_min extends Encoder$$module$libs$y_webrtc_min{constructor(a){super();this.w=a;this.s=null;this.count=0}write(a){this.s===a?this.count++:(0<this.count&&writeVarUint$$module$libs$y_webrtc_min(this,this.count-1),this.count=1,this.w(this,a),this.s=a)}}const flushUintOptRleEncoder$$module$libs$y_webrtc_min=a=>{0<a.count&&(writeVarInt$$module$libs$y_webrtc_min(a.encoder,1===a.count?a.s:-a.s),1<a.count&&writeVarUint$$module$libs$y_webrtc_min(a.encoder,a.count-2))};
class UintOptRleEncoder$$module$libs$y_webrtc_min{constructor(){this.encoder=new Encoder$$module$libs$y_webrtc_min;this.count=this.s=0}write(a){this.s===a?this.count++:(flushUintOptRleEncoder$$module$libs$y_webrtc_min(this),this.count=1,this.s=a)}toUint8Array(){return flushUintOptRleEncoder$$module$libs$y_webrtc_min(this),toUint8Array$$module$libs$y_webrtc_min(this.encoder)}}
const flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min=a=>{0<a.count&&(writeVarInt$$module$libs$y_webrtc_min(a.encoder,2*a.diff+(1===a.count?0:1)),1<a.count&&writeVarUint$$module$libs$y_webrtc_min(a.encoder,a.count-2))};
class IntDiffOptRleEncoder$$module$libs$y_webrtc_min{constructor(){this.encoder=new Encoder$$module$libs$y_webrtc_min;this.diff=this.count=this.s=0}write(a){this.diff===a-this.s?(this.s=a,this.count++):(flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min(this),this.count=1,this.diff=a-this.s,this.s=a)}toUint8Array(){return flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min(this),toUint8Array$$module$libs$y_webrtc_min(this.encoder)}}
class StringEncoder$$module$libs$y_webrtc_min{constructor(){this.sarr=[];this.s="";this.lensE=new UintOptRleEncoder$$module$libs$y_webrtc_min}write(a){this.s+=a;19<this.s.length&&(this.sarr.push(this.s),this.s="");this.lensE.write(a.length)}toUint8Array(){const a=new Encoder$$module$libs$y_webrtc_min;return this.sarr.push(this.s),this.s="",writeVarString$$module$libs$y_webrtc_min(a,this.sarr.join("")),writeUint8Array$$module$libs$y_webrtc_min(a,this.lensE.toUint8Array()),toUint8Array$$module$libs$y_webrtc_min(a)}}
class Pair$$module$libs$y_webrtc_min{constructor(a,b){this.left=a;this.right=b}}
const create$3$$module$libs$y_webrtc_min=(a,b)=>new Pair$$module$libs$y_webrtc_min(a,b),create$4$$module$libs$y_webrtc_min=("undefined"!=typeof DOMParser&&new DOMParser,Symbol),BOLD$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),UNBOLD$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),BLUE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),GREY$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),GREEN$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),
RED$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),PURPLE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),ORANGE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),UNCOLOR$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),loggingColors$$module$libs$y_webrtc_min=[GREEN$$module$libs$y_webrtc_min,PURPLE$$module$libs$y_webrtc_min,ORANGE$$module$libs$y_webrtc_min,BLUE$$module$libs$y_webrtc_min];
let nextColor$$module$libs$y_webrtc_min=0,lastLoggingTime$$module$libs$y_webrtc_min=getUnixTime$$module$libs$y_webrtc_min();
const _browserStyleMap$$module$libs$y_webrtc_min={[BOLD$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("font-weight","bold"),[UNBOLD$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("font-weight","normal"),[BLUE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","blue"),[GREEN$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","green"),[GREY$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","grey"),[RED$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color",
"red"),[PURPLE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","purple"),[ORANGE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","orange"),[UNCOLOR$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","black")},computeLoggingArgs$$module$libs$y_webrtc_min=supportsColor$$module$libs$y_webrtc_min?a=>{var b=[];const c=[],d=create$$module$libs$y_webrtc_min();let e=[],g=0;for(;g<a.length;g++){const t=a[g];var n=_browserStyleMap$$module$libs$y_webrtc_min[t];
if(void 0!==n)d.set(n.left,n.right);else{if(t.constructor!==String&&t.constructor!==Number)break;n=((w,z)=>{const C=[];for(const [H,M]of w)C.push(z(M,H));return C})(d,(w,z)=>`${z}:${w};`).join("");0<g||0<n.length?(b.push("%c"+t),c.push(n)):b.push(t)}}for(0<g&&(e=c,e.unshift(b.join("")));g<a.length;g++)b=a[g],b instanceof Symbol||e.push(b);return e}:a=>{const b=[];let c=0;for(;c<a.length;c++){const d=a[c];d.constructor===String||d.constructor===Number||d.constructor===Object&&b.push(JSON.stringify(d))}return b},
print$$module$libs$y_webrtc_min=(...a)=>{console.log(...computeLoggingArgs$$module$libs$y_webrtc_min(a));vconsoles$$module$libs$y_webrtc_min.forEach(b=>b.print(a))},vconsoles$$module$libs$y_webrtc_min=create$1$$module$libs$y_webrtc_min(),create$5$$module$libs$y_webrtc_min=a=>new Promise(a),resolve$$module$libs$y_webrtc_min=a=>Promise.resolve(a),channels$$module$libs$y_webrtc_min=new Map,BC$$module$libs$y_webrtc_min="undefined"==typeof BroadcastChannel?class{constructor(a){this.room=a;this.onmessage=
null;var b=this._onChange=c=>c.key===a&&null!==this.onmessage&&this.onmessage({data:fromBase64$$module$libs$y_webrtc_min(c.newValue||"")});usePolyfill$$module$libs$y_webrtc_min||addEventListener("storage",b)}postMessage(a){varStorage$$module$libs$y_webrtc_min.setItem(this.room,toBase64$$module$libs$y_webrtc_min(new Uint8Array(a)))}close(){var a=this._onChange;usePolyfill$$module$libs$y_webrtc_min||removeEventListener("storage",a)}}:BroadcastChannel,getChannel$$module$libs$y_webrtc_min=a=>setIfUndefined$$module$libs$y_webrtc_min(channels$$module$libs$y_webrtc_min,
a,()=>{const b=create$1$$module$libs$y_webrtc_min(),c=new BC$$module$libs$y_webrtc_min(a);return c.onmessage=d=>b.forEach(e=>e(d.data,"broadcastchannel")),{bc:c,subs:b}}),createIterator$$module$libs$y_webrtc_min=a=>({[Symbol.iterator](){return this},next:a}),iteratorMap$$module$libs$y_webrtc_min=(a,b)=>createIterator$$module$libs$y_webrtc_min(()=>{const {done:c,value:d}=a.next();return{done:c,value:c?void 0:b(d)}});
class AbstractConnector$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,b){super();this.doc=a;this.awareness=b}}class DeleteItem$$module$libs$y_webrtc_min{constructor(a,b){this.clock=a;this.len=b}}class DeleteSet$$module$libs$y_webrtc_min{constructor(){this.clients=new Map}}
const iterateDeletedStructs$$module$libs$y_webrtc_min=(a,b,c)=>b.clients.forEach((d,e)=>{e=a.doc.store.clients.get(e);for(let g=0;g<d.length;g++){const n=d[g];iterateStructs$$module$libs$y_webrtc_min(a,e,n.clock,n.len,c)}}),isDeleted$$module$libs$y_webrtc_min=(a,b)=>{a=a.clients.get(b.client);var c;if(c=void 0!==a){a:{b=b.clock;c=0;let d=a.length-1;for(;c<=d;){const e=floor$$module$libs$y_webrtc_min((c+d)/2),g=a[e],n=g.clock;if(n<=b){if(b<n+g.len){a=e;break a}c=e+1}else d=e-1}a=null}c=null!==a}return c},
sortAndMergeDeleteSet$$module$libs$y_webrtc_min=a=>{a.clients.forEach(b=>{let c,d;b.sort((e,g)=>e.clock-g.clock);for(d=c=1;c<b.length;c++){const e=b[d-1],g=b[c];e.clock+e.len>=g.clock?e.len=max$$module$libs$y_webrtc_min(e.len,g.clock+g.len-e.clock):(d<c&&(b[d]=g),d++)}b.length=d})},mergeDeleteSets$$module$libs$y_webrtc_min=a=>{const b=new DeleteSet$$module$libs$y_webrtc_min;for(let c=0;c<a.length;c++)a[c].clients.forEach((d,e)=>{if(!b.clients.has(e)){d=d.slice();for(let g=c+1;g<a.length;g++)appendTo$$module$libs$y_webrtc_min(d,
a[g].clients.get(e)||[]);b.clients.set(e,d)}});return sortAndMergeDeleteSet$$module$libs$y_webrtc_min(b),b},addToDeleteSet$$module$libs$y_webrtc_min=(a,b,c,d)=>{setIfUndefined$$module$libs$y_webrtc_min(a.clients,b,()=>[]).push(new DeleteItem$$module$libs$y_webrtc_min(c,d))},createDeleteSet$$module$libs$y_webrtc_min=()=>new DeleteSet$$module$libs$y_webrtc_min,createDeleteSetFromStructStore$$module$libs$y_webrtc_min=a=>{const b=createDeleteSet$$module$libs$y_webrtc_min();return a.clients.forEach((c,
d)=>{const e=[];for(let n=0;n<c.length;n++){var g=c[n];if(g.deleted){const t=g.id.clock;g=g.length;if(n+1<c.length)for(let w=c[n+1];n+1<c.length&&w.deleted;w=c[1+ ++n])g+=w.length;e.push(new DeleteItem$$module$libs$y_webrtc_min(t,g))}}0<e.length&&b.clients.set(d,e)}),b},writeDeleteSet$$module$libs$y_webrtc_min=(a,b)=>{writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,b.clients.size);from$$module$libs$y_webrtc_min(b.clients.entries()).sort((c,d)=>d[0]-c[0]).forEach(([c,d])=>{a.resetDsCurVal();writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,
c);c=d.length;writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,c);for(let e=0;e<c;e++){const g=d[e];a.writeDsClock(g.clock);a.writeDsLen(g.len)}})},readDeleteSet$$module$libs$y_webrtc_min=a=>{const b=new DeleteSet$$module$libs$y_webrtc_min,c=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let e=0;e<c;e++){a.resetDsCurVal();var d=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);const g=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);if(0<g){d=setIfUndefined$$module$libs$y_webrtc_min(b.clients,
d,()=>[]);for(let n=0;n<g;n++)d.push(new DeleteItem$$module$libs$y_webrtc_min(a.readDsClock(),a.readDsLen()))}}return b},readAndApplyDeleteSet$$module$libs$y_webrtc_min=(a,b,c)=>{const d=new DeleteSet$$module$libs$y_webrtc_min,e=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let g=0;g<e;g++){a.resetDsCurVal();const n=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),t=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),w=c.clients.get(n)||[],z=getState$$module$libs$y_webrtc_min(c,n);
for(let C=0;C<t;C++){const H=a.readDsClock(),M=H+a.readDsLen();if(H<z){z<M&&addToDeleteSet$$module$libs$y_webrtc_min(d,n,z,M-z);let L=findIndexSS$$module$libs$y_webrtc_min(w,H),O=w[L];for(!O.deleted&&O.id.clock<H&&(w.splice(L+1,0,splitItem$$module$libs$y_webrtc_min(b,O,H-O.id.clock)),L++);L<w.length&&(O=w[L++],O.id.clock<M);)O.deleted||(M<O.id.clock+O.length&&w.splice(L,0,splitItem$$module$libs$y_webrtc_min(b,O,M-O.id.clock)),O.delete(b))}else addToDeleteSet$$module$libs$y_webrtc_min(d,n,H,M-H)}}return 0<
d.clients.size?(a=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,0),writeDeleteSet$$module$libs$y_webrtc_min(a,d),a.toUint8Array()):null},generateNewClientId$$module$libs$y_webrtc_min=uint32$$module$libs$y_webrtc_min;
class Doc$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor({guid:a=uuidv4$$module$libs$y_webrtc_min(),collectionid:b=null,gc:c=!0,gcFilter:d=()=>!0,meta:e=null,autoLoad:g=!1,shouldLoad:n=!0}={}){super();this.gc=c;this.gcFilter=d;this.clientID=uint32$$module$libs$y_webrtc_min();this.guid=a;this.collectionid=b;this.share=new Map;this.store=new StructStore$$module$libs$y_webrtc_min;this._transaction=null;this._transactionCleanups=[];this.subdocs=new Set;this._item=null;
this.shouldLoad=n;this.autoLoad=g;this.meta=e;this.isSynced=this.isLoaded=!1;this.whenLoaded=create$5$$module$libs$y_webrtc_min(w=>{this.on("load",()=>{this.isLoaded=!0;w(this)})});const t=()=>create$5$$module$libs$y_webrtc_min(w=>{const z=C=>{void 0!==C&&!0!==C||(this.off("sync",z),w())};this.on("sync",z)});this.on("sync",w=>{!1===w&&this.isSynced&&(this.whenSynced=t());this.isSynced=void 0===w||!0===w;this.isLoaded||this.emit("load",[])});this.whenSynced=t()}load(){const a=this._item;null===a||
this.shouldLoad||transact$$module$libs$y_webrtc_min(a.parent.doc,b=>{b.subdocsLoaded.add(this)},null,!0);this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(from$$module$libs$y_webrtc_min(this.subdocs).map(a=>a.guid))}transact(a,b=null){return transact$$module$libs$y_webrtc_min(this,a,b)}get(a,b=AbstractType$$module$libs$y_webrtc_min){const c=setIfUndefined$$module$libs$y_webrtc_min(this.share,a,()=>{const e=new b;return e._integrate(this,null),e});var d=c.constructor;
if(b!==AbstractType$$module$libs$y_webrtc_min&&d!==b){if(d===AbstractType$$module$libs$y_webrtc_min){const e=new b;e._map=c._map;c._map.forEach(g=>{for(;null!==g;g=g.left)g.parent=e});e._start=c._start;for(d=e._start;null!==d;d=d.right)d.parent=e;return e._length=c._length,this.share.set(a,e),e._integrate(this,null),e}throw Error(`Type with the name ${a} has already been defined with a different constructor`);}return c}getArray(a=""){return this.get(a,YArray$$module$libs$y_webrtc_min)}getText(a=""){return this.get(a,
YText$$module$libs$y_webrtc_min)}getMap(a=""){return this.get(a,YMap$$module$libs$y_webrtc_min)}getXmlFragment(a=""){return this.get(a,YXmlFragment$$module$libs$y_webrtc_min)}toJSON(){const a={};return this.share.forEach((b,c)=>{a[c]=b.toJSON()}),a}destroy(){from$$module$libs$y_webrtc_min(this.subdocs).forEach(b=>b.destroy());const a=this._item;if(null!==a){this._item=null;const b=a.content;b.doc=new Doc$$module$libs$y_webrtc_min({guid:this.guid,...b.opts,shouldLoad:!1});b.doc._item=a;transact$$module$libs$y_webrtc_min(a.parent.doc,
c=>{const d=b.doc;a.deleted||c.subdocsAdded.add(d);c.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]);this.emit("destroy",[this]);super.destroy()}on(a,b){super.on(a,b)}off(a,b){super.off(a,b)}}class DSDecoderV1$$module$libs$y_webrtc_min{constructor(a){this.restDecoder=a}resetDsCurVal(){}readDsClock(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readDsLen(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}}
class UpdateDecoderV1$$module$libs$y_webrtc_min extends DSDecoderV1$$module$libs$y_webrtc_min{readLeftID(){return createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(this.restDecoder),readVarUint$$module$libs$y_webrtc_min(this.restDecoder))}readRightID(){return createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(this.restDecoder),readVarUint$$module$libs$y_webrtc_min(this.restDecoder))}readClient(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readInfo(){return readUint8$$module$libs$y_webrtc_min(this.restDecoder)}readString(){return readVarString$$module$libs$y_webrtc_min(this.restDecoder)}readParentInfo(){return 1===
readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readTypeRef(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readLen(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readAny(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readBuf(){var a=readVarUint8Array$$module$libs$y_webrtc_min(this.restDecoder);const b=createUint8ArrayFromLen$$module$libs$y_webrtc_min(a.byteLength);return b.set(a),b}readJSON(){return JSON.parse(readVarString$$module$libs$y_webrtc_min(this.restDecoder))}readKey(){return readVarString$$module$libs$y_webrtc_min(this.restDecoder)}}
class DSDecoderV2$$module$libs$y_webrtc_min{constructor(a){this.dsCurrVal=0;this.restDecoder=a}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=readVarUint$$module$libs$y_webrtc_min(this.restDecoder),this.dsCurrVal}readDsLen(){const a=readVarUint$$module$libs$y_webrtc_min(this.restDecoder)+1;return this.dsCurrVal+=a,a}}
class UpdateDecoderV2$$module$libs$y_webrtc_min extends DSDecoderV2$$module$libs$y_webrtc_min{constructor(a){super(a);this.keys=[];readVarUint$$module$libs$y_webrtc_min(a);this.keyClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.clientDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.leftClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));
this.rightClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.infoDecoder=new RleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a),readUint8$$module$libs$y_webrtc_min);this.stringDecoder=new StringDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.parentInfoDecoder=new RleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a),readUint8$$module$libs$y_webrtc_min);
this.typeRefDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.lenDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a))}readLeftID(){return new ID$$module$libs$y_webrtc_min(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ID$$module$libs$y_webrtc_min(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===
this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readBuf(){return readVarUint8Array$$module$libs$y_webrtc_min(this.restDecoder)}readJSON(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readKey(){var a=this.keyClockDecoder.read();if(a<this.keys.length)return this.keys[a];a=this.stringDecoder.read();return this.keys.push(a),a}}
class DSEncoderV1$$module$libs$y_webrtc_min{constructor(){this.restEncoder=createEncoder$$module$libs$y_webrtc_min()}toUint8Array(){return toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)}resetDsCurVal(){}writeDsClock(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeDsLen(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}}
class UpdateEncoderV1$$module$libs$y_webrtc_min extends DSEncoderV1$$module$libs$y_webrtc_min{writeLeftID(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.client);writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.clock)}writeRightID(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.client);writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.clock)}writeClient(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeInfo(a){write$$module$libs$y_webrtc_min(this.restEncoder,
a)}writeString(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,a)}writeParentInfo(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a?1:0)}writeTypeRef(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeLen(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeAny(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeBuf(a){writeVarUint8Array$$module$libs$y_webrtc_min(this.restEncoder,a)}writeJSON(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,
JSON.stringify(a))}writeKey(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,a)}}
class DSEncoderV2$$module$libs$y_webrtc_min{constructor(){this.restEncoder=createEncoder$$module$libs$y_webrtc_min();this.dsCurrVal=0}toUint8Array(){return toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(a){const b=a-this.dsCurrVal;this.dsCurrVal=a;writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,b)}writeDsLen(a){0===a&&unexpectedCase$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a-1);this.dsCurrVal+=
a}}
class UpdateEncoderV2$$module$libs$y_webrtc_min extends DSEncoderV2$$module$libs$y_webrtc_min{constructor(){super();this.keyMap=new Map;this.keyClock=0;this.keyClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.clientEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min;this.leftClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.rightClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.infoEncoder=new RleEncoder$$module$libs$y_webrtc_min(write$$module$libs$y_webrtc_min);this.stringEncoder=
new StringEncoder$$module$libs$y_webrtc_min;this.parentInfoEncoder=new RleEncoder$$module$libs$y_webrtc_min(write$$module$libs$y_webrtc_min);this.typeRefEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min;this.lenEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min}toUint8Array(){const a=createEncoder$$module$libs$y_webrtc_min();return writeVarUint$$module$libs$y_webrtc_min(a,0),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.keyClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,
this.clientEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.leftClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.rightClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.infoEncoder)),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.stringEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.parentInfoEncoder)),
writeVarUint8Array$$module$libs$y_webrtc_min(a,this.typeRefEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.lenEncoder.toUint8Array()),writeUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)),toUint8Array$$module$libs$y_webrtc_min(a)}writeLeftID(a){this.clientEncoder.write(a.client);this.leftClockEncoder.write(a.clock)}writeRightID(a){this.clientEncoder.write(a.client);this.rightClockEncoder.write(a.clock)}writeClient(a){this.clientEncoder.write(a)}writeInfo(a){this.infoEncoder.write(a)}writeString(a){this.stringEncoder.write(a)}writeParentInfo(a){this.parentInfoEncoder.write(a?
1:0)}writeTypeRef(a){this.typeRefEncoder.write(a)}writeLen(a){this.lenEncoder.write(a)}writeAny(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeBuf(a){writeVarUint8Array$$module$libs$y_webrtc_min(this.restEncoder,a)}writeJSON(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeKey(a){const b=this.keyMap.get(a);void 0===b?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(a)):this.keyClockEncoder.write(b)}}
const writeClientsStructs$$module$libs$y_webrtc_min=(a,b,c)=>{const d=new Map;c.forEach((e,g)=>{getState$$module$libs$y_webrtc_min(b,g)>e&&d.set(g,e)});getStateVector$$module$libs$y_webrtc_min(b).forEach((e,g)=>{c.has(g)||d.set(g,0)});writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,d.size);from$$module$libs$y_webrtc_min(d.entries()).sort((e,g)=>g[0]-e[0]).forEach(([e,g])=>{var n=b.clients.get(e);g=max$$module$libs$y_webrtc_min(g,n[0].id.clock);const t=findIndexSS$$module$libs$y_webrtc_min(n,
g);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,n.length-t);a.writeClient(e);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,g);e=n[t];e.write(a,g-e.id.clock);for(e=t+1;e<n.length;e++)n[e].write(a,0)})},readUpdateV2$$module$libs$y_webrtc_min=(a,b,c,d=new UpdateDecoderV2$$module$libs$y_webrtc_min(a))=>transact$$module$libs$y_webrtc_min(b,e=>{var g=e.local=!1,n=e.doc;const t=n.store;n=((z,C,H)=>{const M=[];let L=from$$module$libs$y_webrtc_min(H.keys()).sort((ea,oa)=>ea-oa);if(0===L.length)return null;
const O=()=>{if(0===L.length)return null;let ea=H.get(L[L.length-1]);for(;ea.refs.length===ea.i;){if(L.pop(),!(0<L.length))return null;ea=H.get(L[L.length-1])}return ea};let S=O();if(null===S&&0===M.length)return null;const T=new StructStore$$module$libs$y_webrtc_min,P=new Map,W=(ea,oa)=>{const sa=P.get(ea);(null==sa||sa>oa)&&P.set(ea,oa)};let Z=S.refs[S.i++];const ca=new Map,ba=()=>{for(const ea of M){const oa=ea.id.client,sa=H.get(oa);sa?(sa.i--,T.clients.set(oa,sa.refs.slice(sa.i)),H.delete(oa),
sa.i=0,sa.refs=[]):T.clients.set(oa,[ea]);L=L.filter(xa=>xa!==oa)}M.length=0};for(;;){if(Z.constructor!==Skip$$module$libs$y_webrtc_min){var la=setIfUndefined$$module$libs$y_webrtc_min(ca,Z.id.client,()=>getState$$module$libs$y_webrtc_min(C,Z.id.client))-Z.id.clock;if(0>la)M.push(Z),W(Z.id.client,Z.id.clock-1),ba();else{const ea=Z.getMissing(z,C);if(null!==ea){M.push(Z);la=H.get(ea)||{refs:[],i:0};if(la.refs.length!==la.i){Z=la.refs[la.i++];continue}W(ea,getState$$module$libs$y_webrtc_min(C,ea));
ba()}else(0===la||la<Z.length)&&(Z.integrate(z,la),ca.set(Z.id.client,Z.id.clock+Z.length))}}if(0<M.length)Z=M.pop();else{if(!(null!==S&&S.i<S.refs.length)&&(S=O(),null===S))break;Z=S.refs[S.i++]}}return 0<T.clients.size?(z=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeClientsStructs$$module$libs$y_webrtc_min(z,T,new Map),writeVarUint$$module$libs$y_webrtc_min(z.restEncoder,0),{missing:P,update:z.toUint8Array()}):null})(e,t,((z,C)=>{const H=create$$module$libs$y_webrtc_min(),M=readVarUint$$module$libs$y_webrtc_min(z.restDecoder);
for(let O=0;O<M;O++){const S=readVarUint$$module$libs$y_webrtc_min(z.restDecoder),T=Array(S),P=z.readClient();let W=readVarUint$$module$libs$y_webrtc_min(z.restDecoder);H.set(P,{i:0,refs:T});for(let Z=0;Z<S;Z++){var L=z.readInfo();switch(31&L){case 0:L=z.readLen();T[Z]=new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(P,W),L);W+=L;break;case 10:L=readVarUint$$module$libs$y_webrtc_min(z.restDecoder);T[Z]=new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(P,W),L);
W+=L;break;default:const ca=0==(192&L);L=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(P,W),null,128==(128&L)?z.readLeftID():null,null,64==(64&L)?z.readRightID():null,ca?z.readParentInfo()?C.get(z.readString()):z.readLeftID():null,ca&&32==(32&L)?z.readString():null,readItemContent$$module$libs$y_webrtc_min(z,L));T[Z]=L;W+=L.length}}}return H})(d,n));var w=t.pendingStructs;if(w){for(const [z,C]of w.missing)if(C<getState$$module$libs$y_webrtc_min(t,z)){g=!0;break}if(n){for(const [z,
C]of n.missing){const H=w.missing.get(z);(null==H||H>C)&&w.missing.set(z,C)}w.update=mergeUpdatesV2$$module$libs$y_webrtc_min([w.update,n.update])}}else t.pendingStructs=n;n=readAndApplyDeleteSet$$module$libs$y_webrtc_min(d,e,t);t.pendingDs?(w=new UpdateDecoderV2$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(t.pendingDs)),readVarUint$$module$libs$y_webrtc_min(w.restDecoder),w=readAndApplyDeleteSet$$module$libs$y_webrtc_min(w,e,t),t.pendingDs=n&&w?mergeUpdatesV2$$module$libs$y_webrtc_min([n,
w]):n||w):t.pendingDs=n;g&&(g=t.pendingStructs.update,t.pendingStructs=null,applyUpdateV2$$module$libs$y_webrtc_min(e.doc,g))},c,!1),readUpdate$$module$libs$y_webrtc_min=(a,b,c)=>readUpdateV2$$module$libs$y_webrtc_min(a,b,c,new UpdateDecoderV1$$module$libs$y_webrtc_min(a)),applyUpdateV2$$module$libs$y_webrtc_min=(a,b,c,d=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{b=createDecoder$$module$libs$y_webrtc_min(b);readUpdateV2$$module$libs$y_webrtc_min(b,a,c,new d(b))},applyUpdate$$module$libs$y_webrtc_min=
(a,b,c)=>applyUpdateV2$$module$libs$y_webrtc_min(a,b,c,UpdateDecoderV1$$module$libs$y_webrtc_min),encodeStateAsUpdateV2$$module$libs$y_webrtc_min=(a,b=new Uint8Array([0]),c=new UpdateEncoderV2$$module$libs$y_webrtc_min)=>{((e,g,n=new Map)=>{writeClientsStructs$$module$libs$y_webrtc_min(e,g.store,n);writeDeleteSet$$module$libs$y_webrtc_min(e,createDeleteSetFromStructStore$$module$libs$y_webrtc_min(g.store))})(c,a,decodeStateVector$$module$libs$y_webrtc_min(b));const d=[c.toUint8Array()];if(a.store.pendingDs&&
d.push(a.store.pendingDs),a.store.pendingStructs&&d.push(diffUpdateV2$$module$libs$y_webrtc_min(a.store.pendingStructs.update,b)),1<d.length){if(c.constructor===UpdateEncoderV1$$module$libs$y_webrtc_min)return mergeUpdates$$module$libs$y_webrtc_min(d.map((e,g)=>0===g?e:convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min(e)));if(c.constructor===UpdateEncoderV2$$module$libs$y_webrtc_min)return mergeUpdatesV2$$module$libs$y_webrtc_min(d)}return d[0]},encodeStateAsUpdate$$module$libs$y_webrtc_min=(a,
b)=>encodeStateAsUpdateV2$$module$libs$y_webrtc_min(a,b,new UpdateEncoderV1$$module$libs$y_webrtc_min),readStateVector$$module$libs$y_webrtc_min=a=>{const b=new Map,c=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let d=0;d<c;d++){const e=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),g=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);b.set(e,g)}return b},decodeStateVector$$module$libs$y_webrtc_min=a=>readStateVector$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a))),
writeStateVector$$module$libs$y_webrtc_min=(a,b)=>(writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,b.size),from$$module$libs$y_webrtc_min(b.entries()).sort((c,d)=>d[0]-c[0]).forEach(([c,d])=>{writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,c);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,d)}),a),encodeStateVectorV2$$module$libs$y_webrtc_min=(a,b=new DSEncoderV2$$module$libs$y_webrtc_min)=>{a instanceof Map?writeStateVector$$module$libs$y_webrtc_min(b,a):writeStateVector$$module$libs$y_webrtc_min(b,
getStateVector$$module$libs$y_webrtc_min(a.store));return b.toUint8Array()},encodeStateVector$$module$libs$y_webrtc_min=a=>encodeStateVectorV2$$module$libs$y_webrtc_min(a,new DSEncoderV1$$module$libs$y_webrtc_min);class EventHandler$$module$libs$y_webrtc_min{constructor(){this.l=[]}}
const createEventHandler$$module$libs$y_webrtc_min=()=>new EventHandler$$module$libs$y_webrtc_min,addEventHandlerListener$$module$libs$y_webrtc_min=(a,b)=>a.l.push(b),removeEventHandlerListener$$module$libs$y_webrtc_min=(a,b)=>{const c=a.l,d=c.length;a.l=c.filter(e=>b!==e);d===a.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},callEventHandlerListeners$$module$libs$y_webrtc_min=(a,b,c)=>callAll$$module$libs$y_webrtc_min(a.l,[b,c]);
class ID$$module$libs$y_webrtc_min{constructor(a,b){this.client=a;this.clock=b}}
const compareIDs$$module$libs$y_webrtc_min=(a,b)=>a===b||null!==a&&null!==b&&a.client===b.client&&a.clock===b.clock,createID$$module$libs$y_webrtc_min=(a,b)=>new ID$$module$libs$y_webrtc_min(a,b),writeID$$module$libs$y_webrtc_min=(a,b)=>{writeVarUint$$module$libs$y_webrtc_min(a,b.client);writeVarUint$$module$libs$y_webrtc_min(a,b.clock)},readID$$module$libs$y_webrtc_min=a=>createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(a),readVarUint$$module$libs$y_webrtc_min(a)),findRootTypeKey$$module$libs$y_webrtc_min=
a=>{for(const [b,c]of a.doc.share.entries())if(c===a)return b;throw unexpectedCase$$module$libs$y_webrtc_min();},isParentOf$$module$libs$y_webrtc_min=(a,b)=>{for(;null!==b;){if(b.parent===a)return!0;b=b.parent._item}return!1},logType$$module$libs$y_webrtc_min=a=>{const b=[];for(a=a._start;a;)b.push(a),a=a.right;console.log("Children: ",b);console.log("Children content: ",b.filter(c=>!c.deleted).map(c=>c.content))};
class PermanentUserData$$module$libs$y_webrtc_min{constructor(a,b=a.getMap("users")){const c=new Map;this.yusers=b;this.doc=a;this.clients=new Map;this.dss=c;const d=(e,g)=>{const n=e.get("ds");e=e.get("ids");const t=w=>this.clients.set(w,g);n.observe(w=>{w.changes.added.forEach(z=>{z.content.getContent().forEach(C=>{C instanceof Uint8Array&&this.dss.set(g,mergeDeleteSets$$module$libs$y_webrtc_min([this.dss.get(g)||createDeleteSet$$module$libs$y_webrtc_min(),readDeleteSet$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(C)))]))})})});
this.dss.set(g,mergeDeleteSets$$module$libs$y_webrtc_min(n.map(w=>readDeleteSet$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(w))))));e.observe(w=>w.changes.added.forEach(z=>z.content.getContent().forEach(t)));e.forEach(t)};b.observe(e=>{e.keysChanged.forEach(g=>d(b.get(g),g))});b.forEach(d)}setUserMapping(a,b,c,{filter:d=()=>!0}={}){const e=this.yusers;let g=e.get(c);g||(g=new YMap$$module$libs$y_webrtc_min,g.set("ids",new YArray$$module$libs$y_webrtc_min),
g.set("ds",new YArray$$module$libs$y_webrtc_min),e.set(c,g));g.get("ids").push([b]);e.observe(n=>{setTimeout(()=>{var t=e.get(c);if(t!==g){g=t;this.clients.forEach((z,C)=>{c===z&&g.get("ids").push([C])});t=new DSEncoderV1$$module$libs$y_webrtc_min;const w=this.dss.get(c);w&&(writeDeleteSet$$module$libs$y_webrtc_min(t,w),g.get("ds").push([t.toUint8Array()]))}},0)});a.on("afterTransaction",n=>{setTimeout(()=>{const t=g.get("ds"),w=n.deleteSet;if(n.local&&0<w.clients.size&&d(n,w)){const z=new DSEncoderV1$$module$libs$y_webrtc_min;
writeDeleteSet$$module$libs$y_webrtc_min(z,w);t.push([z.toUint8Array()])}})})}getUserByClientId(a){return this.clients.get(a)||null}getUserByDeletedId(a){for(const [b,c]of this.dss.entries())if(isDeleted$$module$libs$y_webrtc_min(c,a))return b;return null}}class RelativePosition$$module$libs$y_webrtc_min{constructor(a,b,c,d=0){this.type=a;this.tname=b;this.item=c;this.assoc=d}}
const relativePositionToJSON$$module$libs$y_webrtc_min=a=>{const b={};return a.type&&(b.type=a.type),a.tname&&(b.tname=a.tname),a.item&&(b.item=a.item),null!=a.assoc&&(b.assoc=a.assoc),b},createRelativePositionFromJSON$$module$libs$y_webrtc_min=a=>new RelativePosition$$module$libs$y_webrtc_min(null==a.type?null:createID$$module$libs$y_webrtc_min(a.type.client,a.type.clock),a.tname||null,null==a.item?null:createID$$module$libs$y_webrtc_min(a.item.client,a.item.clock),null==a.assoc?0:a.assoc);
class AbsolutePosition$$module$libs$y_webrtc_min{constructor(a,b,c=0){this.type=a;this.index=b;this.assoc=c}}
const createRelativePosition$$module$libs$y_webrtc_min=(a,b,c)=>{let d=null,e=null;return null===a._item?e=findRootTypeKey$$module$libs$y_webrtc_min(a):d=createID$$module$libs$y_webrtc_min(a._item.id.client,a._item.id.clock),new RelativePosition$$module$libs$y_webrtc_min(d,e,b,c)},createRelativePositionFromTypeIndex$$module$libs$y_webrtc_min=(a,b,c=0)=>{let d=a._start;if(0>c){if(0===b)return createRelativePosition$$module$libs$y_webrtc_min(a,null,c);b--}for(;null!==d;){if(!d.deleted&&d.countable){if(d.length>
b)return createRelativePosition$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(d.id.client,d.id.clock+b),c);b-=d.length}if(null===d.right&&0>c)return createRelativePosition$$module$libs$y_webrtc_min(a,d.lastId,c);d=d.right}return createRelativePosition$$module$libs$y_webrtc_min(a,null,c)},encodeRelativePosition$$module$libs$y_webrtc_min=a=>{const b=createEncoder$$module$libs$y_webrtc_min(),{type:c,tname:d,item:e,assoc:g}=a;if(null!==e)writeVarUint$$module$libs$y_webrtc_min(b,0),writeID$$module$libs$y_webrtc_min(b,
e);else if(null!==d)write$$module$libs$y_webrtc_min(b,1),writeVarString$$module$libs$y_webrtc_min(b,d);else{if(null===c)throw unexpectedCase$$module$libs$y_webrtc_min();write$$module$libs$y_webrtc_min(b,2);writeID$$module$libs$y_webrtc_min(b,c)}writeVarInt$$module$libs$y_webrtc_min(b,g);return toUint8Array$$module$libs$y_webrtc_min(b)},decodeRelativePosition$$module$libs$y_webrtc_min=a=>{var b=createDecoder$$module$libs$y_webrtc_min(a);let c=a=null,d=null;switch(readVarUint$$module$libs$y_webrtc_min(b)){case 0:d=
readID$$module$libs$y_webrtc_min(b);break;case 1:c=readVarString$$module$libs$y_webrtc_min(b);break;case 2:a=readID$$module$libs$y_webrtc_min(b)}b=hasContent$$module$libs$y_webrtc_min(b)?readVarInt$$module$libs$y_webrtc_min(b):0;return new RelativePosition$$module$libs$y_webrtc_min(a,c,d,b)},createAbsolutePositionFromRelativePosition$$module$libs$y_webrtc_min=(a,b)=>{var c=b.store;const d=a.item,e=a.type,g=a.tname;var n=a.assoc,t=null;let w=0;if(null!==d){if(getState$$module$libs$y_webrtc_min(c,d.client)<=
d.clock)return null;b=followRedone$$module$libs$y_webrtc_min(c,d);c=b.item;if(!(c instanceof Item$$module$libs$y_webrtc_min))return null;if(t=c.parent,null===t._item||!t._item.deleted)for(w=c.deleted||!c.countable?0:b.diff+(0<=n?0:1),n=c.left;null!==n;)!n.deleted&&n.countable&&(w+=n.length),n=n.left}else{if(null!==g)t=b.get(g);else{if(null===e)throw unexpectedCase$$module$libs$y_webrtc_min();if(getState$$module$libs$y_webrtc_min(c,e.client)<=e.clock)return null;({item:t}=followRedone$$module$libs$y_webrtc_min(c,
e));if(!(t instanceof Item$$module$libs$y_webrtc_min&&t.content instanceof ContentType$$module$libs$y_webrtc_min))return null;t=t.content.type}w=0<=n?t._length:0}return((z,C,H=0)=>new AbsolutePosition$$module$libs$y_webrtc_min(z,C,H))(t,w,a.assoc)},compareRelativePositions$$module$libs$y_webrtc_min=(a,b)=>a===b||null!==a&&null!==b&&a.tname===b.tname&&compareIDs$$module$libs$y_webrtc_min(a.item,b.item)&&compareIDs$$module$libs$y_webrtc_min(a.type,b.type)&&a.assoc===b.assoc;
class Snapshot$$module$libs$y_webrtc_min{constructor(a,b){this.ds=a;this.sv=b}}
const equalSnapshots$$module$libs$y_webrtc_min=(a,b)=>{var c=a.ds.clients;const d=b.ds.clients;a=a.sv;b=b.sv;if(a.size!==b.size||c.size!==d.size)return!1;for(const [e,g]of a.entries())if(b.get(e)!==g)return!1;for(const [e,g]of c.entries()){c=d.get(e)||[];if(g.length!==c.length)return!1;for(b=0;b<g.length;b++){a=g[b];const n=c[b];if(a.clock!==n.clock||a.len!==n.len)return!1}}return!0},encodeSnapshotV2$$module$libs$y_webrtc_min=(a,b=new DSEncoderV2$$module$libs$y_webrtc_min)=>(writeDeleteSet$$module$libs$y_webrtc_min(b,
a.ds),writeStateVector$$module$libs$y_webrtc_min(b,a.sv),b.toUint8Array()),encodeSnapshot$$module$libs$y_webrtc_min=a=>encodeSnapshotV2$$module$libs$y_webrtc_min(a,new DSEncoderV1$$module$libs$y_webrtc_min),decodeSnapshotV2$$module$libs$y_webrtc_min=(a,b=new DSDecoderV2$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a)))=>new Snapshot$$module$libs$y_webrtc_min(readDeleteSet$$module$libs$y_webrtc_min(b),readStateVector$$module$libs$y_webrtc_min(b)),decodeSnapshot$$module$libs$y_webrtc_min=
a=>decodeSnapshotV2$$module$libs$y_webrtc_min(a,new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a))),createSnapshot$$module$libs$y_webrtc_min=(a,b)=>new Snapshot$$module$libs$y_webrtc_min(a,b),emptySnapshot$$module$libs$y_webrtc_min=createSnapshot$$module$libs$y_webrtc_min(createDeleteSet$$module$libs$y_webrtc_min(),new Map),snapshot$$module$libs$y_webrtc_min=a=>createSnapshot$$module$libs$y_webrtc_min(createDeleteSetFromStructStore$$module$libs$y_webrtc_min(a.store),
getStateVector$$module$libs$y_webrtc_min(a.store)),isVisible$$module$libs$y_webrtc_min=(a,b)=>void 0===b?!a.deleted:b.sv.has(a.id.client)&&(b.sv.get(a.id.client)||0)>a.id.clock&&!isDeleted$$module$libs$y_webrtc_min(b.ds,a.id),splitSnapshotAffectedStructs$$module$libs$y_webrtc_min=(a,b)=>{const c=setIfUndefined$$module$libs$y_webrtc_min(a.meta,splitSnapshotAffectedStructs$$module$libs$y_webrtc_min,create$1$$module$libs$y_webrtc_min),d=a.doc.store;c.has(b)||(b.sv.forEach((e,g)=>{e<getState$$module$libs$y_webrtc_min(d,
g)&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(g,e))}),iterateDeletedStructs$$module$libs$y_webrtc_min(a,b.ds,e=>{}),c.add(b))},createDocFromSnapshot$$module$libs$y_webrtc_min=(a,b,c=new Doc$$module$libs$y_webrtc_min)=>{if(a.gc)throw Error("Garbage-collection must be disabled in `originDoc`!");const {sv:d,ds:e}=b,g=new UpdateEncoderV2$$module$libs$y_webrtc_min;return a.transact(n=>{let t=0;d.forEach(w=>{0<w&&t++});writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,
t);for(const [w,z]of d){if(0===z)continue;z<getState$$module$libs$y_webrtc_min(a.store,w)&&getItemCleanStart$$module$libs$y_webrtc_min(n,createID$$module$libs$y_webrtc_min(w,z));const C=a.store.clients.get(w)||[],H=findIndexSS$$module$libs$y_webrtc_min(C,z-1);writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,H+1);g.writeClient(w);writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,0);for(let M=0;M<=H;M++)C[M].write(g,0)}writeDeleteSet$$module$libs$y_webrtc_min(g,e)}),applyUpdateV2$$module$libs$y_webrtc_min(c,
g.toUint8Array(),"snapshot"),c};class StructStore$$module$libs$y_webrtc_min{constructor(){this.clients=new Map;this.pendingDs=this.pendingStructs=null}}
const getStateVector$$module$libs$y_webrtc_min=a=>{const b=new Map;return a.clients.forEach((c,d)=>{c=c[c.length-1];b.set(d,c.id.clock+c.length)}),b},getState$$module$libs$y_webrtc_min=(a,b)=>{a=a.clients.get(b);if(void 0===a)return 0;a=a[a.length-1];return a.id.clock+a.length},addStruct$$module$libs$y_webrtc_min=(a,b)=>{let c=a.clients.get(b.id.client);if(void 0===c)c=[],a.clients.set(b.id.client,c);else if(a=c[c.length-1],a.id.clock+a.length!==b.id.clock)throw unexpectedCase$$module$libs$y_webrtc_min();
c.push(b)},findIndexSS$$module$libs$y_webrtc_min=(a,b)=>{let c=0,d=a.length-1,e=a[d],g=e.id.clock;if(g===b)return d;let n=floor$$module$libs$y_webrtc_min(b/(g+e.length-1)*d);for(;c<=d;){if(e=a[n],g=e.id.clock,g<=b){if(b<g+e.length)return n;c=n+1}else d=n-1;n=floor$$module$libs$y_webrtc_min((c+d)/2)}throw unexpectedCase$$module$libs$y_webrtc_min();},getItem$$module$libs$y_webrtc_min=(a,b)=>{a=a.clients.get(b.client);return a[findIndexSS$$module$libs$y_webrtc_min(a,b.clock)]},findIndexCleanStart$$module$libs$y_webrtc_min=
(a,b,c)=>{const d=findIndexSS$$module$libs$y_webrtc_min(b,c),e=b[d];return e.id.clock<c&&e instanceof Item$$module$libs$y_webrtc_min?(b.splice(d+1,0,splitItem$$module$libs$y_webrtc_min(a,e,c-e.id.clock)),d+1):d},getItemCleanStart$$module$libs$y_webrtc_min=(a,b)=>{const c=a.doc.store.clients.get(b.client);return c[findIndexCleanStart$$module$libs$y_webrtc_min(a,c,b.clock)]},getItemCleanEnd$$module$libs$y_webrtc_min=(a,b,c)=>{b=b.clients.get(c.client);const d=findIndexSS$$module$libs$y_webrtc_min(b,
c.clock),e=b[d];return c.clock!==e.id.clock+e.length-1&&e.constructor!==GC$$module$libs$y_webrtc_min&&b.splice(d+1,0,splitItem$$module$libs$y_webrtc_min(a,e,c.clock-e.id.clock+1)),e},iterateStructs$$module$libs$y_webrtc_min=(a,b,c,d,e)=>{if(0!==d){d=c+d;var g=findIndexCleanStart$$module$libs$y_webrtc_min(a,b,c);do c=b[g++],d<c.id.clock+c.length&&findIndexCleanStart$$module$libs$y_webrtc_min(a,b,d),e(c);while(g<b.length&&b[g].id.clock<d)}};
class Transaction$$module$libs$y_webrtc_min{constructor(a,b,c){this.doc=a;this.deleteSet=new DeleteSet$$module$libs$y_webrtc_min;this.beforeState=getStateVector$$module$libs$y_webrtc_min(a.store);this.afterState=new Map;this.changed=new Map;this.changedParentTypes=new Map;this._mergeStructs=[];this.origin=b;this.meta=new Map;this.local=c;this.subdocsAdded=new Set;this.subdocsRemoved=new Set;this.subdocsLoaded=new Set}}
const writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min=(a,b)=>{var c;if(c=!(0===b.deleteSet.clients.size&&!((d,e)=>{for(const [g,n]of d)if(e(n,g))return!0;return!1})(b.afterState,(d,e)=>b.beforeState.get(e)!==d)))sortAndMergeDeleteSet$$module$libs$y_webrtc_min(b.deleteSet),writeClientsStructs$$module$libs$y_webrtc_min(a,b.doc.store,b.beforeState),c=(writeDeleteSet$$module$libs$y_webrtc_min(a,b.deleteSet),!0);return c},addChangedTypeToTransaction$$module$libs$y_webrtc_min=(a,b,c)=>{const d=
b._item;(null===d||d.id.clock<(a.beforeState.get(d.id.client)||0)&&!d.deleted)&&setIfUndefined$$module$libs$y_webrtc_min(a.changed,b,create$1$$module$libs$y_webrtc_min).add(c)},tryToMergeWithLeft$$module$libs$y_webrtc_min=(a,b)=>{const c=a[b-1],d=a[b];c.deleted===d.deleted&&c.constructor===d.constructor&&c.mergeWith(d)&&(a.splice(b,1),d instanceof Item$$module$libs$y_webrtc_min&&null!==d.parentSub&&d.parent._map.get(d.parentSub)===d&&d.parent._map.set(d.parentSub,c))},tryGcDeleteSet$$module$libs$y_webrtc_min=
(a,b,c)=>{for(const [d,e]of a.clients.entries()){a=b.clients.get(d);for(let g=e.length-1;0<=g;g--){const n=e[g],t=n.clock+n.len;for(let w=findIndexSS$$module$libs$y_webrtc_min(a,n.clock),z=a[w];w<a.length&&z.id.clock<t;z=a[++w]){const C=a[w];if(n.clock+n.len<=C.id.clock)break;C instanceof Item$$module$libs$y_webrtc_min&&C.deleted&&!C.keep&&c(C)&&C.gc(b,!1)}}}},tryMergeDeleteSet$$module$libs$y_webrtc_min=(a,b)=>{a.clients.forEach((c,d)=>{d=b.clients.get(d);for(let e=c.length-1;0<=e;e--){const g=c[e];
for(let n=min$$module$libs$y_webrtc_min(d.length-1,1+findIndexSS$$module$libs$y_webrtc_min(d,g.clock+g.len-1)),t=d[n];0<n&&t.id.clock>=g.clock;t=d[--n])tryToMergeWithLeft$$module$libs$y_webrtc_min(d,n)}})},tryGc$$module$libs$y_webrtc_min=(a,b,c)=>{tryGcDeleteSet$$module$libs$y_webrtc_min(a,b,c);tryMergeDeleteSet$$module$libs$y_webrtc_min(a,b)},cleanupTransactions$$module$libs$y_webrtc_min=(a,b)=>{if(b<a.length){const e=a[b],g=e.doc,n=g.store;var c=e.deleteSet,d=e._mergeStructs;try{sortAndMergeDeleteSet$$module$libs$y_webrtc_min(c);
e.afterState=getStateVector$$module$libs$y_webrtc_min(e.doc.store);g.emit("beforeObserverCalls",[e,g]);const t=[];e.changed.forEach((w,z)=>t.push(()=>{null!==z._item&&z._item.deleted||z._callObserver(e,w)}));t.push(()=>{e.changedParentTypes.forEach((w,z)=>t.push(()=>{null!==z._item&&z._item.deleted||((w=w.filter(C=>null===C.target._item||!C.target._item.deleted)).forEach(C=>{C.currentTarget=z}),w.sort((C,H)=>C.path.length-H.path.length),callEventHandlerListeners$$module$libs$y_webrtc_min(z._dEH,w,
e))}));t.push(()=>g.emit("afterTransaction",[e,g]))});callAll$$module$libs$y_webrtc_min(t,[])}finally{g.gc&&tryGcDeleteSet$$module$libs$y_webrtc_min(c,n,g.gcFilter);tryMergeDeleteSet$$module$libs$y_webrtc_min(c,n);e.afterState.forEach((C,H)=>{var M=e.beforeState.get(H)||0;if(M!==C)for(C=n.clients.get(H),M=max$$module$libs$y_webrtc_min(findIndexSS$$module$libs$y_webrtc_min(C,M),1),H=C.length-1;H>=M;H--)tryToMergeWithLeft$$module$libs$y_webrtc_min(C,H)});for(c=0;c<d.length;c++){const {client:C,clock:H}=
d[c].id,M=n.clients.get(C),L=findIndexSS$$module$libs$y_webrtc_min(M,H);L+1<M.length&&tryToMergeWithLeft$$module$libs$y_webrtc_min(M,L+1);0<L&&tryToMergeWithLeft$$module$libs$y_webrtc_min(M,L)}if(e.local||e.afterState.get(g.clientID)===e.beforeState.get(g.clientID)||(print$$module$libs$y_webrtc_min(ORANGE$$module$libs$y_webrtc_min,BOLD$$module$libs$y_webrtc_min,"[yjs] ",UNBOLD$$module$libs$y_webrtc_min,RED$$module$libs$y_webrtc_min,"Changed the client-id because another client seems to be using it."),
g.clientID=uint32$$module$libs$y_webrtc_min()),g.emit("afterTransactionCleanup",[e,g]),g._observers.has("update"))d=new UpdateEncoderV1$$module$libs$y_webrtc_min,writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min(d,e)&&g.emit("update",[d.toUint8Array(),e.origin,g,e]);g._observers.has("updateV2")&&(d=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min(d,e)&&g.emit("updateV2",[d.toUint8Array(),e.origin,g,e]));const {subdocsAdded:t,subdocsLoaded:w,
subdocsRemoved:z}=e;(0<t.size||0<z.size||0<w.size)&&(t.forEach(C=>{C.clientID=g.clientID;null==C.collectionid&&(C.collectionid=g.collectionid);g.subdocs.add(C)}),z.forEach(C=>g.subdocs.delete(C)),g.emit("subdocs",[{loaded:w,added:t,removed:z},g,e]),z.forEach(C=>C.destroy()));a.length<=b+1?(g._transactionCleanups=[],g.emit("afterAllTransactions",[g,a])):cleanupTransactions$$module$libs$y_webrtc_min(a,b+1)}}},transact$$module$libs$y_webrtc_min=(a,b,c=null,d=!0)=>{const e=a._transactionCleanups;let g=
!1,n=null;null===a._transaction&&(g=!0,a._transaction=new Transaction$$module$libs$y_webrtc_min(a,c,d),e.push(a._transaction),1===e.length&&a.emit("beforeAllTransactions",[a]),a.emit("beforeTransaction",[a._transaction,a]));try{n=b(a._transaction)}finally{g&&(b=a._transaction===e[0],a._transaction=null,b&&cleanupTransactions$$module$libs$y_webrtc_min(e,0))}return n};class StackItem$$module$libs$y_webrtc_min{constructor(a,b){this.insertions=b;this.deletions=a;this.meta=new Map}}
const clearUndoManagerStackItem$$module$libs$y_webrtc_min=(a,b,c)=>{iterateDeletedStructs$$module$libs$y_webrtc_min(a,c.deletions,d=>{d instanceof Item$$module$libs$y_webrtc_min&&b.scope.some(e=>isParentOf$$module$libs$y_webrtc_min(e,d))&&keepItem$$module$libs$y_webrtc_min(d,!1)})},popStackItem$$module$libs$y_webrtc_min=(a,b,c)=>{let d=null,e=null;const g=a.doc,n=a.scope;(transact$$module$libs$y_webrtc_min(g,t=>{for(;0<b.length&&null===d;){const w=g.store,z=b.pop(),C=new Set,H=[];let M=!1;iterateDeletedStructs$$module$libs$y_webrtc_min(t,
z.insertions,L=>{if(L instanceof Item$$module$libs$y_webrtc_min){if(null!==L.redone){let {item:O,diff:S}=followRedone$$module$libs$y_webrtc_min(w,L.id);0<S&&(O=getItemCleanStart$$module$libs$y_webrtc_min(t,createID$$module$libs$y_webrtc_min(O.id.client,O.id.clock+S)));L=O}!L.deleted&&n.some(O=>isParentOf$$module$libs$y_webrtc_min(O,L))&&H.push(L)}});iterateDeletedStructs$$module$libs$y_webrtc_min(t,z.deletions,L=>{L instanceof Item$$module$libs$y_webrtc_min&&n.some(O=>isParentOf$$module$libs$y_webrtc_min(O,
L))&&!isDeleted$$module$libs$y_webrtc_min(z.insertions,L.id)&&C.add(L)});C.forEach(L=>{M=null!==redoItem$$module$libs$y_webrtc_min(t,L,C,z.insertions,a.ignoreRemoteMapChanges,a)||M});for(let L=H.length-1;0<=L;L--){const O=H[L];a.deleteFilter(O)&&(O.delete(t),M=!0)}d=M?z:null}t.changed.forEach((w,z)=>{w.has(null)&&z._searchMarker&&(z._searchMarker.length=0)});e=t},a),null!=d)&&a.emit("stack-item-popped",[{stackItem:d,type:c,changedParentTypes:e.changedParentTypes},a]);return d};
class UndoManager$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,{captureTimeout:b=500,captureTransaction:c=t=>!0,deleteFilter:d=()=>!0,trackedOrigins:e=new Set([null]),ignoreRemoteMapChanges:g=!1,doc:n=isArray$$module$libs$y_webrtc_min(a)?a[0].doc:a.doc}={}){super();this.scope=[];this.addToScope(a);this.deleteFilter=d;e.add(this);this.trackedOrigins=e;this.captureTransaction=c;this.undoStack=[];this.redoStack=[];this.redoing=this.undoing=!1;this.doc=n;this.lastChange=
0;this.ignoreRemoteMapChanges=g;this.captureTimeout=b;this.afterTransactionHandler=t=>{if(this.captureTransaction(t)&&this.scope.some(O=>t.changedParentTypes.has(O))&&(this.trackedOrigins.has(t.origin)||t.origin&&this.trackedOrigins.has(t.origin.constructor))){var w=this.undoing,z=this.redoing,C=w?this.redoStack:this.undoStack;w?this.stopCapturing():z||this.clear(!1,!0);var H=new DeleteSet$$module$libs$y_webrtc_min;t.afterState.forEach((O,S)=>{const T=t.beforeState.get(S)||0;O-=T;0<O&&addToDeleteSet$$module$libs$y_webrtc_min(H,
S,T,O)});var M=getUnixTime$$module$libs$y_webrtc_min(),L=!1;if(0<this.lastChange&&M-this.lastChange<this.captureTimeout&&0<C.length&&!w&&!z){const O=C[C.length-1];O.deletions=mergeDeleteSets$$module$libs$y_webrtc_min([O.deletions,t.deleteSet]);O.insertions=mergeDeleteSets$$module$libs$y_webrtc_min([O.insertions,H])}else C.push(new StackItem$$module$libs$y_webrtc_min(t.deleteSet,H)),L=!0;w||z||(this.lastChange=M);iterateDeletedStructs$$module$libs$y_webrtc_min(t,t.deleteSet,O=>{O instanceof Item$$module$libs$y_webrtc_min&&
this.scope.some(S=>isParentOf$$module$libs$y_webrtc_min(S,O))&&keepItem$$module$libs$y_webrtc_min(O,!0)});w=[{stackItem:C[C.length-1],origin:t.origin,type:w?"redo":"undo",changedParentTypes:t.changedParentTypes},this];L?this.emit("stack-item-added",w):this.emit("stack-item-updated",w)}};this.doc.on("afterTransaction",this.afterTransactionHandler);this.doc.on("destroy",()=>{this.destroy()})}addToScope(a){(a=isArray$$module$libs$y_webrtc_min(a)?a:[a]).forEach(b=>{this.scope.every(c=>c!==b)&&this.scope.push(b)})}addTrackedOrigin(a){this.trackedOrigins.add(a)}removeTrackedOrigin(a){this.trackedOrigins.delete(a)}clear(a=
!0,b=!0){(a&&this.canUndo()||b&&this.canRedo())&&this.doc.transact(c=>{a&&(this.undoStack.forEach(d=>clearUndoManagerStackItem$$module$libs$y_webrtc_min(c,this,d)),this.undoStack=[]);b&&(this.redoStack.forEach(d=>clearUndoManagerStackItem$$module$libs$y_webrtc_min(c,this,d)),this.redoStack=[]);this.emit("stack-cleared",[{undoStackCleared:a,redoStackCleared:b}])})}stopCapturing(){this.lastChange=0}undo(){let a;this.undoing=!0;try{a=popStackItem$$module$libs$y_webrtc_min(this,this.undoStack,"undo")}finally{this.undoing=
!1}return a}redo(){let a;this.redoing=!0;try{a=popStackItem$$module$libs$y_webrtc_min(this,this.redoStack,"redo")}finally{this.redoing=!1}return a}canUndo(){return 0<this.undoStack.length}canRedo(){return 0<this.redoStack.length}destroy(){this.trackedOrigins.delete(this);this.doc.off("afterTransaction",this.afterTransactionHandler);super.destroy()}}
class LazyStructReader$$module$libs$y_webrtc_min{constructor(a,b){this.gen=function*(c){const d=readVarUint$$module$libs$y_webrtc_min(c.restDecoder);for(let g=0;g<d;g++){const n=readVarUint$$module$libs$y_webrtc_min(c.restDecoder),t=c.readClient();let w=readVarUint$$module$libs$y_webrtc_min(c.restDecoder);for(let z=0;z<n;z++){var e=c.readInfo();if(10===e)e=readVarUint$$module$libs$y_webrtc_min(c.restDecoder),yield new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(t,w),e),w+=e;
else if(0!=(31&e)){const C=0==(192&e);e=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(t,w),null,128==(128&e)?c.readLeftID():null,null,64==(64&e)?c.readRightID():null,C?c.readParentInfo()?c.readString():c.readLeftID():null,C&&32==(32&e)?c.readString():null,readItemContent$$module$libs$y_webrtc_min(c,e));yield e;w+=e.length}else e=c.readLen(),yield new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(t,w),e),w+=e}}}(a);this.curr=null;this.done=!1;this.filterSkips=
b;this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===Skip$$module$libs$y_webrtc_min);return this.curr}}
const logUpdate$$module$libs$y_webrtc_min=a=>logUpdateV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),logUpdateV2$$module$libs$y_webrtc_min=(a,b=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{var c=[];a=new b(createDecoder$$module$libs$y_webrtc_min(a));b=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);for(let d=b.curr;null!==d;d=b.next())c.push(d);print$$module$libs$y_webrtc_min("Structs: ",c);c=readDeleteSet$$module$libs$y_webrtc_min(a);print$$module$libs$y_webrtc_min("DeleteSet: ",
c)},decodeUpdate$$module$libs$y_webrtc_min=a=>decodeUpdateV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),decodeUpdateV2$$module$libs$y_webrtc_min=(a,b=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{const c=[];a=new b(createDecoder$$module$libs$y_webrtc_min(a));b=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);for(let d=b.curr;null!==d;d=b.next())c.push(d);return{structs:c,ds:readDeleteSet$$module$libs$y_webrtc_min(a)}};
class LazyStructWriter$$module$libs$y_webrtc_min{constructor(a){this.written=this.startClock=this.currClient=0;this.encoder=a;this.clientStructs=[]}}
const mergeUpdates$$module$libs$y_webrtc_min=a=>mergeUpdatesV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min),encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min=(a,b=DSEncoderV2$$module$libs$y_webrtc_min,c=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{b=new b;c=new LazyStructReader$$module$libs$y_webrtc_min(new c(createDecoder$$module$libs$y_webrtc_min(a)),!1);let d=c.curr;if(null!==d){a=0;let e=d.id.client,g=0!==d.id.clock,n=g?
0:d.id.clock+d.length;for(;null!==d;d=c.next())e!==d.id.client&&(0!==n&&(a++,writeVarUint$$module$libs$y_webrtc_min(b.restEncoder,e),writeVarUint$$module$libs$y_webrtc_min(b.restEncoder,n)),e=d.id.client,n=0,g=0!==d.id.clock),d.constructor===Skip$$module$libs$y_webrtc_min&&(g=!0),g||(n=d.id.clock+d.length);0!==n&&(a++,writeVarUint$$module$libs$y_webrtc_min(b.restEncoder,e),writeVarUint$$module$libs$y_webrtc_min(b.restEncoder,n));c=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(c,
a);writeUint8Array$$module$libs$y_webrtc_min(c,toUint8Array$$module$libs$y_webrtc_min(b.restEncoder));return b.restEncoder=c,b.toUint8Array()}return writeVarUint$$module$libs$y_webrtc_min(b.restEncoder,0),b.toUint8Array()},encodeStateVectorFromUpdate$$module$libs$y_webrtc_min=a=>encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min(a,DSEncoderV1$$module$libs$y_webrtc_min,UpdateDecoderV1$$module$libs$y_webrtc_min),parseUpdateMetaV2$$module$libs$y_webrtc_min=(a,b=UpdateDecoderV2$$module$libs$y_webrtc_min)=>
{const c=new Map,d=new Map;a=new LazyStructReader$$module$libs$y_webrtc_min(new b(createDecoder$$module$libs$y_webrtc_min(a)),!1);b=a.curr;if(null!==b){let e=b.id.client,g=b.id.clock;for(c.set(e,g);null!==b;b=a.next())e!==b.id.client&&(d.set(e,g),c.set(b.id.client,b.id.clock),e=b.id.client),g=b.id.clock+b.length;d.set(e,g)}return{from:c,to:d}},parseUpdateMeta$$module$libs$y_webrtc_min=a=>parseUpdateMetaV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),sliceStruct$$module$libs$y_webrtc_min=
(a,b)=>{if(a.constructor===GC$$module$libs$y_webrtc_min){const {client:e,clock:g}=a.id;return new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(e,g+b),a.length-b)}if(a.constructor===Skip$$module$libs$y_webrtc_min){const {client:e,clock:g}=a.id;return new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(e,g+b),a.length-b)}const {client:c,clock:d}=a.id;return new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(c,d+b),null,createID$$module$libs$y_webrtc_min(c,
d+b-1),null,a.rightOrigin,a.parent,a.parentSub,a.content.splice(b))},mergeUpdatesV2$$module$libs$y_webrtc_min=(a,b=UpdateDecoderV2$$module$libs$y_webrtc_min,c=UpdateEncoderV2$$module$libs$y_webrtc_min)=>{if(1===a.length)return a[0];a=a.map(w=>new b(createDecoder$$module$libs$y_webrtc_min(w)));let d=a.map(w=>new LazyStructReader$$module$libs$y_webrtc_min(w,!0)),e=null;c=new c;const g=new LazyStructWriter$$module$libs$y_webrtc_min(c);for(;d=d.filter(w=>null!==w.curr),d.sort((w,z)=>{if(w.curr.id.client===
z.curr.id.client){const C=w.curr.id.clock-z.curr.id.clock;return 0===C?w.curr.constructor===z.curr.constructor?0:w.curr.constructor===Skip$$module$libs$y_webrtc_min?1:-1:C}return z.curr.id.client-w.curr.id.client}),0!==d.length;){const w=d[0],z=w.curr.id.client;if(null!==e){for(var n=w.curr,t=!1;null!==n&&n.id.clock+n.length<=e.struct.id.clock+e.struct.length&&n.id.client>=e.struct.id.client;)n=w.next(),t=!0;if(null===n||n.id.client!==z||t&&n.id.clock>e.struct.id.clock+e.struct.length)continue;z!==
e.struct.id.client?(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(g,e.struct,e.offset),e={struct:n,offset:0},w.next()):e.struct.id.clock+e.struct.length<n.id.clock?e.struct.constructor===Skip$$module$libs$y_webrtc_min?e.struct.length=n.id.clock+n.length-e.struct.id.clock:(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(g,e.struct,e.offset),n=n.id.clock-e.struct.id.clock-e.struct.length,e={struct:new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(z,e.struct.id.clock+
e.struct.length),n),offset:0}):(t=e.struct.id.clock+e.struct.length-n.id.clock,0<t&&(e.struct.constructor===Skip$$module$libs$y_webrtc_min?e.struct.length-=t:n=sliceStruct$$module$libs$y_webrtc_min(n,t)),e.struct.mergeWith(n)||(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(g,e.struct,e.offset),e={struct:n,offset:0},w.next()))}else e={struct:w.curr,offset:0},w.next();for(n=w.curr;null!==n&&n.id.client===z&&n.id.clock===e.struct.id.clock+e.struct.length&&n.constructor!==Skip$$module$libs$y_webrtc_min;n=
w.next())writeStructToLazyStructWriter$$module$libs$y_webrtc_min(g,e.struct,e.offset),e={struct:n,offset:0}}null!==e&&(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(g,e.struct,e.offset),e=null);finishLazyStructWriting$$module$libs$y_webrtc_min(g);a=a.map(w=>readDeleteSet$$module$libs$y_webrtc_min(w));a=mergeDeleteSets$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(c,a),c.toUint8Array()},diffUpdateV2$$module$libs$y_webrtc_min=(a,b,c=UpdateDecoderV2$$module$libs$y_webrtc_min,
d=UpdateEncoderV2$$module$libs$y_webrtc_min)=>{b=decodeStateVector$$module$libs$y_webrtc_min(b);d=new d;const e=new LazyStructWriter$$module$libs$y_webrtc_min(d);a=new c(createDecoder$$module$libs$y_webrtc_min(a));for(c=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);c.curr;){const g=c.curr,n=g.id.client,t=b.get(n)||0;if(c.curr.constructor!==Skip$$module$libs$y_webrtc_min)if(g.id.clock+g.length>t)for(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(e,g,max$$module$libs$y_webrtc_min(t-
g.id.clock,0)),c.next();c.curr&&c.curr.id.client===n;)writeStructToLazyStructWriter$$module$libs$y_webrtc_min(e,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===n&&c.curr.id.clock+c.curr.length<=t;)c.next();else c.next()}finishLazyStructWriting$$module$libs$y_webrtc_min(e);b=readDeleteSet$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(d,b),d.toUint8Array()},diffUpdate$$module$libs$y_webrtc_min=(a,b)=>diffUpdateV2$$module$libs$y_webrtc_min(a,b,UpdateDecoderV1$$module$libs$y_webrtc_min,
UpdateEncoderV1$$module$libs$y_webrtc_min),flushLazyStructWriter$$module$libs$y_webrtc_min=a=>{0<a.written&&(a.clientStructs.push({written:a.written,restEncoder:toUint8Array$$module$libs$y_webrtc_min(a.encoder.restEncoder)}),a.encoder.restEncoder=createEncoder$$module$libs$y_webrtc_min(),a.written=0)},writeStructToLazyStructWriter$$module$libs$y_webrtc_min=(a,b,c)=>{0<a.written&&a.currClient!==b.id.client&&flushLazyStructWriter$$module$libs$y_webrtc_min(a);0===a.written&&(a.currClient=b.id.client,
a.encoder.writeClient(b.id.client),writeVarUint$$module$libs$y_webrtc_min(a.encoder.restEncoder,b.id.clock+c));b.write(a.encoder,c);a.written++},finishLazyStructWriting$$module$libs$y_webrtc_min=a=>{flushLazyStructWriter$$module$libs$y_webrtc_min(a);const b=a.encoder.restEncoder;writeVarUint$$module$libs$y_webrtc_min(b,a.clientStructs.length);for(let c=0;c<a.clientStructs.length;c++){const d=a.clientStructs[c];writeVarUint$$module$libs$y_webrtc_min(b,d.written);writeUint8Array$$module$libs$y_webrtc_min(b,
d.restEncoder)}},convertUpdateFormat$$module$libs$y_webrtc_min=(a,b,c,d)=>{a=new c(createDecoder$$module$libs$y_webrtc_min(a));c=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);d=new d;const e=new LazyStructWriter$$module$libs$y_webrtc_min(d);for(let g=c.curr;null!==g;g=c.next())writeStructToLazyStructWriter$$module$libs$y_webrtc_min(e,b(g),0);finishLazyStructWriting$$module$libs$y_webrtc_min(e);b=readDeleteSet$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(d,b),
d.toUint8Array()},createObfuscator$$module$libs$y_webrtc_min=({formatting:a=!0,subdocs:b=!0,yxml:c=!0}={})=>{let d=0;const e=create$$module$libs$y_webrtc_min(),g=create$$module$libs$y_webrtc_min(),n=create$$module$libs$y_webrtc_min(),t=create$$module$libs$y_webrtc_min();return t.set(null,null),w=>{switch(w.constructor){case GC$$module$libs$y_webrtc_min:case Skip$$module$libs$y_webrtc_min:return w;case Item$$module$libs$y_webrtc_min:var z=w.content;switch(z.constructor){case ContentDeleted$$module$libs$y_webrtc_min:break;
case ContentType$$module$libs$y_webrtc_min:c&&(z=z.type,z instanceof YXmlElement$$module$libs$y_webrtc_min&&(z.nodeName=setIfUndefined$$module$libs$y_webrtc_min(g,z.nodeName,()=>"node-"+d)),z instanceof YXmlHook$$module$libs$y_webrtc_min&&(z.hookName=setIfUndefined$$module$libs$y_webrtc_min(g,z.hookName,()=>"hook-"+d)));break;case ContentAny$$module$libs$y_webrtc_min:z.arr=z.arr.map(()=>d);break;case ContentBinary$$module$libs$y_webrtc_min:z.content=new Uint8Array([d]);break;case ContentDoc$$module$libs$y_webrtc_min:b&&
(z.opts={},z.doc.guid=d+"");break;case ContentEmbed$$module$libs$y_webrtc_min:z.embed={};break;case ContentFormat$$module$libs$y_webrtc_min:a&&(z.key=setIfUndefined$$module$libs$y_webrtc_min(n,z.key,()=>d+""),z.value=setIfUndefined$$module$libs$y_webrtc_min(t,z.value,()=>({i:d})));break;case ContentJSON$$module$libs$y_webrtc_min:z.arr=z.arr.map(()=>d);break;case ContentString$$module$libs$y_webrtc_min:z.str=repeat$$module$libs$y_webrtc_min(d%10+"",z.str.length);break;default:unexpectedCase$$module$libs$y_webrtc_min()}return w.parentSub&&
(w.parentSub=setIfUndefined$$module$libs$y_webrtc_min(e,w.parentSub,()=>d+"")),d++,w;default:unexpectedCase$$module$libs$y_webrtc_min()}}},obfuscateUpdate$$module$libs$y_webrtc_min=(a,b)=>convertUpdateFormat$$module$libs$y_webrtc_min(a,createObfuscator$$module$libs$y_webrtc_min(b),UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min),obfuscateUpdateV2$$module$libs$y_webrtc_min=(a,b)=>convertUpdateFormat$$module$libs$y_webrtc_min(a,createObfuscator$$module$libs$y_webrtc_min(b),
UpdateDecoderV2$$module$libs$y_webrtc_min,UpdateEncoderV2$$module$libs$y_webrtc_min),convertUpdateFormatV1ToV2$$module$libs$y_webrtc_min=a=>convertUpdateFormat$$module$libs$y_webrtc_min(a,id$$module$libs$y_webrtc_min,UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV2$$module$libs$y_webrtc_min),convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min=a=>convertUpdateFormat$$module$libs$y_webrtc_min(a,id$$module$libs$y_webrtc_min,UpdateDecoderV2$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min);
class YEvent$$module$libs$y_webrtc_min{constructor(a,b){this.currentTarget=this.target=a;this.transaction=b;this._delta=this._keys=this._changes=null}get path(){return getPathTo$$module$libs$y_webrtc_min(this.currentTarget,this.target)}deletes(a){return isDeleted$$module$libs$y_webrtc_min(this.transaction.deleteSet,a.id)}get keys(){if(null===this._keys){const a=new Map,b=this.target;this.transaction.changed.get(b).forEach(c=>{if(null!==c){const d=b._map.get(c);let e,g;if(this.adds(d)){let n=d.left;
for(;null!==n&&this.adds(n);)n=n.left;if(this.deletes(d)){if(null===n||!this.deletes(n))return;e="delete";g=last$$module$libs$y_webrtc_min(n.content.getContent())}else null!==n&&this.deletes(n)?(e="update",g=last$$module$libs$y_webrtc_min(n.content.getContent())):(e="add",g=void 0)}else{if(!this.deletes(d))return;e="delete";g=last$$module$libs$y_webrtc_min(d.content.getContent())}a.set(c,{action:e,oldValue:g})}});this._keys=a}return this._keys}get delta(){return this.changes.delta}adds(a){return a.id.clock>=
(this.transaction.beforeState.get(a.id.client)||0)}get changes(){let a=this._changes;if(null===a){var b=this.target;const c=create$1$$module$libs$y_webrtc_min(),d=create$1$$module$libs$y_webrtc_min(),e=[];a={added:c,deleted:d,delta:e,keys:this.keys};if(this.transaction.changed.get(b).has(null)){let g=null;for(b=b._start;null!==b;b=b.right)if(b.deleted){if(this.deletes(b)&&!this.adds(b)){if(null===g||void 0===g.delete)g&&e.push(g),g={delete:0};g.delete+=b.length;d.add(b)}}else if(this.adds(b)){if(null===
g||void 0===g.insert)g&&e.push(g),g={insert:[]};g.insert=g.insert.concat(b.content.getContent());c.add(b)}else{if(null===g||void 0===g.retain)g&&e.push(g),g={retain:0};g.retain+=b.length}null!==g&&void 0===g.retain&&g&&e.push(g)}this._changes=a}return a}}
const getPathTo$$module$libs$y_webrtc_min=(a,b)=>{const c=[];for(;null!==b._item&&b!==a;){if(null!==b._item.parentSub)c.unshift(b._item.parentSub);else{let d=0,e=b._item.parent._start;for(;e!==b._item&&null!==e;)e.deleted||d++,e=e.right;c.unshift(d)}b=b._item.parent}return c};let globalSearchMarkerTimestamp$$module$libs$y_webrtc_min=0;
class ArraySearchMarker$$module$libs$y_webrtc_min{constructor(a,b){a.marker=!0;this.p=a;this.index=b;this.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++}}
const overwriteMarker$$module$libs$y_webrtc_min=(a,b,c)=>{a.p.marker=!1;a.p=b;b.marker=!0;a.index=c;a.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++},findMarker$$module$libs$y_webrtc_min=(a,b)=>{if(null===a._start||0===b||null===a._searchMarker)return null;const c=0===a._searchMarker.length?null:a._searchMarker.reduce((g,n)=>abs$$module$libs$y_webrtc_min(b-g.index)<abs$$module$libs$y_webrtc_min(b-n.index)?g:n);let d=a._start,e=0;null!==c&&(d=c.p,e=c.index,c.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++);
for(;null!==d.right&&e<b;){if(!d.deleted&&d.countable){if(b<e+d.length)break;e+=d.length}d=d.right}for(;null!==d.left&&e>b;)d=d.left,!d.deleted&&d.countable&&(e-=d.length);for(;null!==d.left&&d.left.id.client===d.id.client&&d.left.id.clock+d.left.length===d.id.clock;)d=d.left,!d.deleted&&d.countable&&(e-=d.length);return null!==c&&abs$$module$libs$y_webrtc_min(c.index-e)<d.parent.length/80?(overwriteMarker$$module$libs$y_webrtc_min(c,d,e),c):((g,n,t)=>{if(80<=g.length)return g=g.reduce((w,z)=>w.timestamp<
z.timestamp?w:z),overwriteMarker$$module$libs$y_webrtc_min(g,n,t),g;n=new ArraySearchMarker$$module$libs$y_webrtc_min(n,t);return g.push(n),n})(a._searchMarker,d,e)},updateMarkerChanges$$module$libs$y_webrtc_min=(a,b,c)=>{for(let d=a.length-1;0<=d;d--){const e=a[d];if(0<c){let g=e.p;for(g.marker=!1;g&&(g.deleted||!g.countable);)(g=g.left)&&!g.deleted&&g.countable&&(e.index-=g.length);if(null===g||!0===g.marker){a.splice(d,1);continue}e.p=g;g.marker=!0}(b<e.index||0<c&&b===e.index)&&(e.index=max$$module$libs$y_webrtc_min(b,
e.index+c))}},getTypeChildren$$module$libs$y_webrtc_min=a=>{a=a._start;const b=[];for(;a;)b.push(a),a=a.right;return b},callTypeObservers$$module$libs$y_webrtc_min=(a,b,c)=>{const d=a,e=b.changedParentTypes;for(;setIfUndefined$$module$libs$y_webrtc_min(e,a,()=>[]).push(c),null!==a._item;)a=a._item.parent;callEventHandlerListeners$$module$libs$y_webrtc_min(d._eH,c,b)};
class AbstractType$$module$libs$y_webrtc_min{constructor(){this._item=null;this._map=new Map;this.doc=this._start=null;this._length=0;this._eH=createEventHandler$$module$libs$y_webrtc_min();this._dEH=createEventHandler$$module$libs$y_webrtc_min();this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(a,b){this.doc=a;this._item=b}_copy(){throw methodUnimplemented$$module$libs$y_webrtc_min();}clone(){throw methodUnimplemented$$module$libs$y_webrtc_min();}_write(a){}get _first(){let a=
this._start;for(;null!==a&&a.deleted;)a=a.right;return a}_callObserver(a,b){!a.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(a){addEventHandlerListener$$module$libs$y_webrtc_min(this._eH,a)}observeDeep(a){addEventHandlerListener$$module$libs$y_webrtc_min(this._dEH,a)}unobserve(a){removeEventHandlerListener$$module$libs$y_webrtc_min(this._eH,a)}unobserveDeep(a){removeEventHandlerListener$$module$libs$y_webrtc_min(this._dEH,a)}toJSON(){}}
const typeListSlice$$module$libs$y_webrtc_min=(a,b,c)=>{0>b&&(b=a._length+b);0>c&&(c=a._length+c);c-=b;const d=[];for(a=a._start;null!==a&&0<c;){if(a.countable&&!a.deleted){const e=a.content.getContent();if(e.length<=b)b-=e.length;else{for(;b<e.length&&0<c;b++)d.push(e[b]),c--;b=0}}a=a.right}return d},typeListToArray$$module$libs$y_webrtc_min=a=>{const b=[];for(a=a._start;null!==a;){if(a.countable&&!a.deleted){const c=a.content.getContent();for(let d=0;d<c.length;d++)b.push(c[d])}a=a.right}return b},
typeListToArraySnapshot$$module$libs$y_webrtc_min=(a,b)=>{const c=[];for(a=a._start;null!==a;){if(a.countable&&isVisible$$module$libs$y_webrtc_min(a,b)){const d=a.content.getContent();for(let e=0;e<d.length;e++)c.push(d[e])}a=a.right}return c},typeListForEach$$module$libs$y_webrtc_min=(a,b)=>{let c=0,d=a._start;for(;null!==d;){if(d.countable&&!d.deleted){const e=d.content.getContent();for(let g=0;g<e.length;g++)b(e[g],c++,a)}d=d.right}},typeListMap$$module$libs$y_webrtc_min=(a,b)=>{const c=[];return typeListForEach$$module$libs$y_webrtc_min(a,
(d,e)=>{c.push(b(d,e,a))}),c},typeListCreateIterator$$module$libs$y_webrtc_min=a=>{let b=a._start,c=null,d=0;return{[Symbol.iterator](){return this},next:()=>{if(null===c){for(;null!==b&&b.deleted;)b=b.right;if(null===b)return{done:!0,value:void 0};c=b.content.getContent();d=0;b=b.right}const e=c[d++];return c.length<=d&&(c=null),{done:!1,value:e}}}},typeListGet$$module$libs$y_webrtc_min=(a,b)=>{const c=findMarker$$module$libs$y_webrtc_min(a,b);a=a._start;for(null!==c&&(a=c.p,b-=c.index);null!==a;a=
a.right)if(!a.deleted&&a.countable){if(b<a.length)return a.content.getContent()[b];b-=a.length}},typeListInsertGenericsAfter$$module$libs$y_webrtc_min=(a,b,c,d)=>{let e=c;const g=a.doc,n=g.clientID,t=g.store,w=null===c?b._start:c.right;let z=[];const C=()=>{0<z.length&&(e=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,getState$$module$libs$y_webrtc_min(t,n)),e,e&&e.lastId,w,w&&w.id,b,null,new ContentAny$$module$libs$y_webrtc_min(z)),e.integrate(a,0),z=[])};d.forEach(H=>{if(null===
H)z.push(H);else switch(H.constructor){case Number:case Object:case Boolean:case Array:case String:z.push(H);break;default:switch(C(),H.constructor){case Uint8Array:case ArrayBuffer:e=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,getState$$module$libs$y_webrtc_min(t,n)),e,e&&e.lastId,w,w&&w.id,b,null,new ContentBinary$$module$libs$y_webrtc_min(new Uint8Array(H)));e.integrate(a,0);break;case Doc$$module$libs$y_webrtc_min:e=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,
getState$$module$libs$y_webrtc_min(t,n)),e,e&&e.lastId,w,w&&w.id,b,null,new ContentDoc$$module$libs$y_webrtc_min(H));e.integrate(a,0);break;default:if(!(H instanceof AbstractType$$module$libs$y_webrtc_min))throw Error("Unexpected content type in insert operation");e=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,getState$$module$libs$y_webrtc_min(t,n)),e,e&&e.lastId,w,w&&w.id,b,null,new ContentType$$module$libs$y_webrtc_min(H));e.integrate(a,0)}}});C()},lengthExceeded$$module$libs$y_webrtc_min=
create$2$$module$libs$y_webrtc_min("Length exceeded!"),typeListInsertGenerics$$module$libs$y_webrtc_min=(a,b,c,d)=>{if(c>b._length)throw lengthExceeded$$module$libs$y_webrtc_min;if(0===c)return b._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(b._searchMarker,c,d.length),typeListInsertGenericsAfter$$module$libs$y_webrtc_min(a,b,null,d);const e=c,g=findMarker$$module$libs$y_webrtc_min(b,c);let n=b._start;for(null!==g&&(n=g.p,0===(c-=g.index)&&(n=n.prev,c+=n&&n.countable&&!n.deleted?n.length:
0));null!==n;n=n.right)if(!n.deleted&&n.countable){if(c<=n.length){c<n.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(n.id.client,n.id.clock+c));break}c-=n.length}return b._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(b._searchMarker,e,d.length),typeListInsertGenericsAfter$$module$libs$y_webrtc_min(a,b,n,d)},typeListDelete$$module$libs$y_webrtc_min=(a,b,c,d)=>{if(0!==d){var e=c,g=d,n=findMarker$$module$libs$y_webrtc_min(b,c),t=b._start;for(null!==
n&&(t=n.p,c-=n.index);null!==t&&0<c;t=t.right)!t.deleted&&t.countable&&(c<t.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(t.id.client,t.id.clock+c)),c-=t.length);for(;0<d&&null!==t;)t.deleted||(d<t.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(t.id.client,t.id.clock+d)),t.delete(a),d-=t.length),t=t.right;if(0<d)throw lengthExceeded$$module$libs$y_webrtc_min;b._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(b._searchMarker,
e,-g+d)}},typeMapDelete$$module$libs$y_webrtc_min=(a,b,c)=>{b=b._map.get(c);void 0!==b&&b.delete(a)},typeMapSet$$module$libs$y_webrtc_min=(a,b,c,d)=>{const e=b._map.get(c)||null,g=a.doc,n=g.clientID;if(null==d)d=new ContentAny$$module$libs$y_webrtc_min([d]);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:d=new ContentAny$$module$libs$y_webrtc_min([d]);break;case Uint8Array:d=new ContentBinary$$module$libs$y_webrtc_min(d);break;case Doc$$module$libs$y_webrtc_min:d=
new ContentDoc$$module$libs$y_webrtc_min(d);break;default:if(!(d instanceof AbstractType$$module$libs$y_webrtc_min))throw Error("Unexpected content type");d=new ContentType$$module$libs$y_webrtc_min(d)}(new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,getState$$module$libs$y_webrtc_min(g.store,n)),e,e&&e.lastId,null,null,b,c,d)).integrate(a,0)},typeMapGet$$module$libs$y_webrtc_min=(a,b)=>{a=a._map.get(b);return void 0===a||a.deleted?void 0:a.content.getContent()[a.length-1]},
typeMapGetAll$$module$libs$y_webrtc_min=a=>{const b={};return a._map.forEach((c,d)=>{c.deleted||(b[d]=c.content.getContent()[c.length-1])}),b},typeMapHas$$module$libs$y_webrtc_min=(a,b)=>{a=a._map.get(b);return void 0!==a&&!a.deleted},typeMapGetSnapshot$$module$libs$y_webrtc_min=(a,b,c)=>{for(a=a._map.get(b)||null;null!==a&&(!c.sv.has(a.id.client)||a.id.clock>=(c.sv.get(a.id.client)||0));)a=a.left;return null!==a&&isVisible$$module$libs$y_webrtc_min(a,c)?a.content.getContent()[a.length-1]:void 0},
createMapIterator$$module$libs$y_webrtc_min=a=>{return b=a.entries(),c=d=>!d[1].deleted,createIterator$$module$libs$y_webrtc_min(()=>{let d;do d=b.next();while(!d.done&&!c(d.value));return d});var b,c};class YArrayEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,b){super(a,b);this._transaction=b}}
class YArray$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(){super();this._prelimContent=[];this._searchMarker=[]}static from(a){const b=new YArray$$module$libs$y_webrtc_min;return b.push(a),b}_integrate(a,b){super._integrate(a,b);this.insert(0,this._prelimContent);this._prelimContent=null}_copy(){return new YArray$$module$libs$y_webrtc_min}clone(){const a=new YArray$$module$libs$y_webrtc_min;return a.insert(0,this.toArray().map(b=>b instanceof AbstractType$$module$libs$y_webrtc_min?
b.clone():b)),a}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(a,b){super._callObserver(a,b);callTypeObservers$$module$libs$y_webrtc_min(this,a,new YArrayEvent$$module$libs$y_webrtc_min(this,a))}insert(a,b){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,c=>{typeListInsertGenerics$$module$libs$y_webrtc_min(c,this,a,b)}):this._prelimContent.splice(a,0,...b)}push(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,b=>{((c,
d,e)=>{let g=(d._searchMarker||[]).reduce((n,t)=>t.index>n.index?t:n,{index:0,p:d._start}).p;if(g)for(;g.right;)g=g.right;typeListInsertGenericsAfter$$module$libs$y_webrtc_min(c,d,g,e)})(b,this,a)}):this._prelimContent.push(...a)}unshift(a){this.insert(0,a)}delete(a,b=1){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,c=>{typeListDelete$$module$libs$y_webrtc_min(c,this,a,b)}):this._prelimContent.splice(a,b)}get(a){return typeListGet$$module$libs$y_webrtc_min(this,a)}toArray(){return typeListToArray$$module$libs$y_webrtc_min(this)}slice(a=
0,b=this.length){return typeListSlice$$module$libs$y_webrtc_min(this,a,b)}toJSON(){return this.map(a=>a instanceof AbstractType$$module$libs$y_webrtc_min?a.toJSON():a)}map(a){return typeListMap$$module$libs$y_webrtc_min(this,a)}forEach(a){typeListForEach$$module$libs$y_webrtc_min(this,a)}[Symbol.iterator](){return typeListCreateIterator$$module$libs$y_webrtc_min(this)}_write(a){a.writeTypeRef(YArrayRefID$$module$libs$y_webrtc_min)}}
class YMapEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,b,c){super(a,b);this.keysChanged=c}}
class YMap$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(a){super();this._prelimContent=null;this._prelimContent=void 0===a?new Map:new Map(a)}_integrate(a,b){super._integrate(a,b);this._prelimContent.forEach((c,d)=>{this.set(d,c)});this._prelimContent=null}_copy(){return new YMap$$module$libs$y_webrtc_min}clone(){const a=new YMap$$module$libs$y_webrtc_min;return this.forEach((b,c)=>{a.set(c,b instanceof AbstractType$$module$libs$y_webrtc_min?b.clone():b)}),
a}_callObserver(a,b){callTypeObservers$$module$libs$y_webrtc_min(this,a,new YMapEvent$$module$libs$y_webrtc_min(this,a,b))}toJSON(){const a={};return this._map.forEach((b,c)=>{b.deleted||(b=b.content.getContent()[b.length-1],a[c]=b instanceof AbstractType$$module$libs$y_webrtc_min?b.toJSON():b)}),a}get size(){return[...createMapIterator$$module$libs$y_webrtc_min(this._map)].length}keys(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),a=>a[0])}values(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),
a=>a[1].content.getContent()[a[1].length-1])}entries(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),a=>[a[0],a[1].content.getContent()[a[1].length-1]])}forEach(a){this._map.forEach((b,c)=>{b.deleted||a(b.content.getContent()[b.length-1],c,this)})}[Symbol.iterator](){return this.entries()}delete(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,b=>{typeMapDelete$$module$libs$y_webrtc_min(b,this,a)}):this._prelimContent.delete(a)}set(a,
b){return null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,c=>{typeMapSet$$module$libs$y_webrtc_min(c,this,a,b)}):this._prelimContent.set(a,b),b}get(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}has(a){return typeMapHas$$module$libs$y_webrtc_min(this,a)}clear(){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,a=>{this.forEach(function(b,c,d){typeMapDelete$$module$libs$y_webrtc_min(a,d,c)})}):this._prelimContent.clear()}_write(a){a.writeTypeRef(YMapRefID$$module$libs$y_webrtc_min)}}
const equalAttrs$$module$libs$y_webrtc_min=(a,b)=>a===b||"object"==typeof a&&"object"==typeof b&&a&&b&&((c,d)=>c===d||length$$module$libs$y_webrtc_min(c)===length$$module$libs$y_webrtc_min(d)&&((e,g)=>{for(const n in e)if(!g(e[n],n))return!1;return!0})(c,(e,g)=>(void 0!==e||hasProperty$$module$libs$y_webrtc_min(d,g))&&d[g]===e))(a,b);
class ItemTextListPosition$$module$libs$y_webrtc_min{constructor(a,b,c,d){this.left=a;this.right=b;this.index=c;this.currentAttributes=d}forward(){switch(null===this.right&&unexpectedCase$$module$libs$y_webrtc_min(),this.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:this.right.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length)}this.left=this.right;this.right=
this.right.right}}
const findNextPosition$$module$libs$y_webrtc_min=(a,b,c)=>{for(;null!==b.right&&0<c;){switch(b.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:b.right.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(b.currentAttributes,b.right.content);break;default:b.right.deleted||(c<b.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(b.right.id.client,b.right.id.clock+c)),b.index+=b.right.length,c-=b.right.length)}b.left=b.right;b.right=
b.right.right}return b},findPosition$$module$libs$y_webrtc_min=(a,b,c)=>{const d=new Map;var e=findMarker$$module$libs$y_webrtc_min(b,c);if(e)return b=new ItemTextListPosition$$module$libs$y_webrtc_min(e.p.left,e.p,e.index,d),findNextPosition$$module$libs$y_webrtc_min(a,b,c-e.index);e=new ItemTextListPosition$$module$libs$y_webrtc_min(null,b._start,0,d);return findNextPosition$$module$libs$y_webrtc_min(a,e,c)},insertNegatedAttributes$$module$libs$y_webrtc_min=(a,b,c,d)=>{for(;null!==c.right&&(!0===
c.right.deleted||c.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&equalAttrs$$module$libs$y_webrtc_min(d.get(c.right.content.key),c.right.content.value));)c.right.deleted||d.delete(c.right.content.key),c.forward();const e=a.doc,g=e.clientID;d.forEach((n,t)=>{const w=c.left,z=c.right;n=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(g,getState$$module$libs$y_webrtc_min(e.store,g)),w,w&&w.lastId,z,z&&z.id,b,null,new ContentFormat$$module$libs$y_webrtc_min(t,
n));n.integrate(a,0);c.right=n;c.forward()})},updateCurrentAttributes$$module$libs$y_webrtc_min=(a,b)=>{const {key:c,value:d}=b;null===d?a.delete(c):a.set(c,d)},minimizeAttributeChanges$$module$libs$y_webrtc_min=(a,b)=>{for(;null!==a.right&&(a.right.deleted||a.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&equalAttrs$$module$libs$y_webrtc_min(b[a.right.content.key]||null,a.right.content.value));)a.forward()},insertAttributes$$module$libs$y_webrtc_min=(a,b,c,d)=>{const e=a.doc,
g=e.clientID,n=new Map;for(const t in d){const w=d[t],z=c.currentAttributes.get(t)||null;if(!equalAttrs$$module$libs$y_webrtc_min(z,w)){n.set(t,z);const {left:C,right:H}=c;c.right=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(g,getState$$module$libs$y_webrtc_min(e.store,g)),C,C&&C.lastId,H,H&&H.id,b,null,new ContentFormat$$module$libs$y_webrtc_min(t,w));c.right.integrate(a,0);c.forward()}}return n},insertText$$module$libs$y_webrtc_min=(a,b,c,d,e)=>{c.currentAttributes.forEach((H,
M)=>{void 0===e[M]&&(e[M]=null)});const g=a.doc,n=g.clientID;minimizeAttributeChanges$$module$libs$y_webrtc_min(c,e);const t=insertAttributes$$module$libs$y_webrtc_min(a,b,c,e);d=d.constructor===String?new ContentString$$module$libs$y_webrtc_min(d):d instanceof AbstractType$$module$libs$y_webrtc_min?new ContentType$$module$libs$y_webrtc_min(d):new ContentEmbed$$module$libs$y_webrtc_min(d);let {left:w,right:z,index:C}=c;b._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(b._searchMarker,
c.index,d.getLength());z=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,getState$$module$libs$y_webrtc_min(g.store,n)),w,w&&w.lastId,z,z&&z.id,b,null,d);z.integrate(a,0);c.right=z;c.index=C;c.forward();insertNegatedAttributes$$module$libs$y_webrtc_min(a,b,c,t)},formatText$$module$libs$y_webrtc_min=(a,b,c,d,e)=>{const g=a.doc,n=g.clientID;minimizeAttributeChanges$$module$libs$y_webrtc_min(c,e);const t=insertAttributes$$module$libs$y_webrtc_min(a,b,c,e);a:for(;null!==c.right&&
(0<d||0<t.size&&(c.right.deleted||c.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min));){if(!c.right.deleted)switch(c.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:const {key:w,value:z}=c.right.content,C=e[w];if(void 0!==C){if(equalAttrs$$module$libs$y_webrtc_min(C,z))t.delete(w);else{if(0===d)break a;t.set(w,z)}c.right.delete(a)}else c.currentAttributes.set(w,z);break;default:d<c.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(c.right.id.client,
c.right.id.clock+d)),d-=c.right.length}c.forward()}if(0<d){for(e="";0<d;d--)e+="\n";c.right=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(n,getState$$module$libs$y_webrtc_min(g.store,n)),c.left,c.left&&c.left.lastId,c.right,c.right&&c.right.id,b,null,new ContentString$$module$libs$y_webrtc_min(e));c.right.integrate(a,0);c.forward()}insertNegatedAttributes$$module$libs$y_webrtc_min(a,b,c,t)},cleanupFormattingGap$$module$libs$y_webrtc_min=(a,b,c,d,e)=>{let g=b;const n=create$$module$libs$y_webrtc_min();
for(;g&&(!g.countable||g.deleted);){if(!g.deleted&&g.content.constructor===ContentFormat$$module$libs$y_webrtc_min){var t=g.content;n.set(t.key,t)}g=g.right}t=0;let w=!1;for(;b!==g;){if(c===b&&(w=!0),!b.deleted){const z=b.content;switch(z.constructor){case ContentFormat$$module$libs$y_webrtc_min:const {key:C,value:H}=z,M=d.get(C)||null;n.get(C)===z&&M!==H||(b.delete(a),t++,w||(e.get(C)||null)!==H||M===H||(null===M?e.delete(C):e.set(C,M)));w||b.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(e,
z)}}b=b.right}return t},cleanupYTextFormatting$$module$libs$y_webrtc_min=a=>{let b=0;return transact$$module$libs$y_webrtc_min(a.doc,c=>{let d=a._start,e=a._start,g=create$$module$libs$y_webrtc_min();const n=copy$$module$libs$y_webrtc_min(g);for(;e;){if(!1===e.deleted)switch(e.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:updateCurrentAttributes$$module$libs$y_webrtc_min(n,e.content);break;default:b+=cleanupFormattingGap$$module$libs$y_webrtc_min(c,d,e,g,n),g=copy$$module$libs$y_webrtc_min(n),
d=e}e=e.right}}),b},deleteText$$module$libs$y_webrtc_min=(a,b,c)=>{const d=c,e=copy$$module$libs$y_webrtc_min(b.currentAttributes),g=b.right;for(;0<c&&null!==b.right;){if(!1===b.right.deleted)switch(b.right.content.constructor){case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:case ContentString$$module$libs$y_webrtc_min:c<b.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(b.right.id.client,b.right.id.clock+c)),c-=
b.right.length,b.right.delete(a)}b.forward()}g&&cleanupFormattingGap$$module$libs$y_webrtc_min(a,g,b.right,e,b.currentAttributes);a=(b.left||b.right).parent;return a._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(a._searchMarker,b.index,-d+c),b};
class YTextEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,b,c){super(a,b);this.childListChanged=!1;this.keysChanged=new Set;c.forEach(d=>{null===d?this.childListChanged=!0:this.keysChanged.add(d)})}get changes(){null===this._changes&&(this._changes={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set});return this._changes}get delta(){if(null===this._delta){const a=[];transact$$module$libs$y_webrtc_min(this.target.doc,b=>{const c=new Map,d=new Map;
let e=this.target._start,g=null;const n={};let t="",w=0,z=0;const C=()=>{if(null!==g){let M=null;switch(g){case "delete":0<z&&(M={delete:z});z=0;break;case "insert":("object"==typeof t||0<t.length)&&(M={insert:t},0<c.size&&(M.attributes={},c.forEach((L,O)=>{null!==L&&(M.attributes[O]=L)})));t="";break;case "retain":0<w&&(M={retain:w},(L=>{for(const O in L)return!1;return!0})(n)||(M.attributes=assign$$module$libs$y_webrtc_min({},n))),w=0}M&&a.push(M);g=null}};for(;null!==e;){switch(e.content.constructor){case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:this.adds(e)?
this.deletes(e)||(C(),g="insert",t=e.content.getContent()[0],C()):this.deletes(e)?("delete"!==g&&(C(),g="delete"),z+=1):e.deleted||("retain"!==g&&(C(),g="retain"),w+=1);break;case ContentString$$module$libs$y_webrtc_min:this.adds(e)?this.deletes(e)||("insert"!==g&&(C(),g="insert"),t+=e.content.str):this.deletes(e)?("delete"!==g&&(C(),g="delete"),z+=e.length):e.deleted||("retain"!==g&&(C(),g="retain"),w+=e.length);break;case ContentFormat$$module$libs$y_webrtc_min:const {key:M,value:L}=e.content;if(this.adds(e)){if(!this.deletes(e)){var H=
c.get(M)||null;equalAttrs$$module$libs$y_webrtc_min(H,L)?null!==L&&e.delete(b):("retain"===g&&C(),equalAttrs$$module$libs$y_webrtc_min(L,d.get(M)||null)?delete n[M]:n[M]=L)}}else this.deletes(e)?(d.set(M,L),H=c.get(M)||null,equalAttrs$$module$libs$y_webrtc_min(H,L)||("retain"===g&&C(),n[M]=H)):e.deleted||(d.set(M,L),H=n[M],void 0!==H&&(equalAttrs$$module$libs$y_webrtc_min(H,L)?null!==H&&e.delete(b):("retain"===g&&C(),null===L?delete n[M]:n[M]=L)));e.deleted||("insert"===g&&C(),updateCurrentAttributes$$module$libs$y_webrtc_min(c,
e.content))}e=e.right}for(C();0<a.length;){b=a[a.length-1];if(void 0===b.retain||void 0!==b.attributes)break;a.pop()}});this._delta=a}return this._delta}}
class YText$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(a){super();this._pending=void 0!==a?[()=>this.insert(0,a)]:[];this._searchMarker=[]}get length(){return this._length}_integrate(a,b){super._integrate(a,b);try{this._pending.forEach(c=>c())}catch(c){console.error(c)}this._pending=null}_copy(){return new YText$$module$libs$y_webrtc_min}clone(){const a=new YText$$module$libs$y_webrtc_min;return a.applyDelta(this.toDelta()),a}_callObserver(a,b){super._callObserver(a,
b);var c=new YTextEvent$$module$libs$y_webrtc_min(this,a,b);b=a.doc;if(callTypeObservers$$module$libs$y_webrtc_min(this,a,c),!a.local){let d=!1;for(const [e,g]of a.afterState.entries())if(c=a.beforeState.get(e)||0,g!==c&&(iterateStructs$$module$libs$y_webrtc_min(a,b.store.clients.get(e),c,g,n=>{n.deleted||n.content.constructor!==ContentFormat$$module$libs$y_webrtc_min||(d=!0)}),d))break;d||iterateDeletedStructs$$module$libs$y_webrtc_min(a,a.deleteSet,e=>{e instanceof GC$$module$libs$y_webrtc_min||
d||e.parent===this&&e.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&(d=!0)});transact$$module$libs$y_webrtc_min(b,e=>{d?cleanupYTextFormatting$$module$libs$y_webrtc_min(this):iterateDeletedStructs$$module$libs$y_webrtc_min(e,e.deleteSet,g=>{if(!(g instanceof GC$$module$libs$y_webrtc_min)&&g.parent===this){for(;g&&g.right&&(g.right.deleted||!g.right.countable);)g=g.right;const n=new Set;for(;g&&(g.deleted||!g.countable);){if(!g.deleted&&g.content.constructor===ContentFormat$$module$libs$y_webrtc_min){const t=
g.content.key;n.has(t)?g.delete(e):n.add(t)}g=g.left}}})})}}toString(){let a="",b=this._start;for(;null!==b;)!b.deleted&&b.countable&&b.content.constructor===ContentString$$module$libs$y_webrtc_min&&(a+=b.content.str),b=b.right;return a}toJSON(){return this.toString()}applyDelta(a,{sanitize:b=!0}={}){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,c=>{const d=new ItemTextListPosition$$module$libs$y_webrtc_min(null,this._start,0,new Map);for(let e=0;e<a.length;e++){const g=a[e];if(void 0!==
g.insert){const n=b||"string"!=typeof g.insert||e!==a.length-1||null!==d.right||"\n"!==g.insert.slice(-1)?g.insert:g.insert.slice(0,-1);("string"!=typeof n||0<n.length)&&insertText$$module$libs$y_webrtc_min(c,this,d,n,g.attributes||{})}else void 0!==g.retain?formatText$$module$libs$y_webrtc_min(c,this,d,g.retain,g.attributes||{}):void 0!==g.delete&&deleteText$$module$libs$y_webrtc_min(c,d,g.delete)}}):this._pending.push(()=>this.applyDelta(a))}toDelta(a,b,c){function d(){if(0<t.length){const C={};
let H=!1;g.forEach((L,O)=>{H=!0;C[O]=L});const M={insert:t};H&&(M.attributes=C);e.push(M);t=""}}const e=[],g=new Map,n=this.doc;let t="",w=this._start;const z=()=>{for(;null!==w;){if(isVisible$$module$libs$y_webrtc_min(w,a)||void 0!==b&&isVisible$$module$libs$y_webrtc_min(w,b))switch(w.content.constructor){case ContentString$$module$libs$y_webrtc_min:var C=g.get("ychange");void 0===a||isVisible$$module$libs$y_webrtc_min(w,a)?void 0===b||isVisible$$module$libs$y_webrtc_min(w,b)?void 0!==C&&(d(),g.delete("ychange")):
void 0!==C&&C.user===w.id.client&&"added"===C.type||(d(),g.set("ychange",c?c("added",w.id):{type:"added"})):void 0!==C&&C.user===w.id.client&&"removed"===C.type||(d(),g.set("ychange",c?c("removed",w.id):{type:"removed"}));t+=w.content.str;break;case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:d();C={insert:w.content.getContent()[0]};if(0<g.size){const H={};C.attributes=H;g.forEach((M,L)=>{H[L]=M})}e.push(C);break;case ContentFormat$$module$libs$y_webrtc_min:isVisible$$module$libs$y_webrtc_min(w,
a)&&(d(),updateCurrentAttributes$$module$libs$y_webrtc_min(g,w.content))}w=w.right}d()};return a||b?transact$$module$libs$y_webrtc_min(n,C=>{a&&splitSnapshotAffectedStructs$$module$libs$y_webrtc_min(C,a);b&&splitSnapshotAffectedStructs$$module$libs$y_webrtc_min(C,b);z()},"cleanup"):z(),e}insert(a,b,c){if(!(0>=b.length)){var d=this.doc;null!==d?transact$$module$libs$y_webrtc_min(d,e=>{const g=findPosition$$module$libs$y_webrtc_min(e,this,a);c||(c={},g.currentAttributes.forEach((n,t)=>{c[t]=n}));insertText$$module$libs$y_webrtc_min(e,
this,g,b,c)}):this._pending.push(()=>this.insert(a,b,c))}}insertEmbed(a,b,c={}){const d=this.doc;null!==d?transact$$module$libs$y_webrtc_min(d,e=>{const g=findPosition$$module$libs$y_webrtc_min(e,this,a);insertText$$module$libs$y_webrtc_min(e,this,g,b,c)}):this._pending.push(()=>this.insertEmbed(a,b,c))}delete(a,b){if(0!==b){var c=this.doc;null!==c?transact$$module$libs$y_webrtc_min(c,d=>{deleteText$$module$libs$y_webrtc_min(d,findPosition$$module$libs$y_webrtc_min(d,this,a),b)}):this._pending.push(()=>
this.delete(a,b))}}format(a,b,c){if(0!==b){var d=this.doc;null!==d?transact$$module$libs$y_webrtc_min(d,e=>{const g=findPosition$$module$libs$y_webrtc_min(e,this,a);null!==g.right&&formatText$$module$libs$y_webrtc_min(e,this,g,b,c)}):this._pending.push(()=>this.format(a,b,c))}}removeAttribute(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,b=>{typeMapDelete$$module$libs$y_webrtc_min(b,this,a)}):this._pending.push(()=>this.removeAttribute(a))}setAttribute(a,b){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,
c=>{typeMapSet$$module$libs$y_webrtc_min(c,this,a,b)}):this._pending.push(()=>this.setAttribute(a,b))}getAttribute(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}getAttributes(){return typeMapGetAll$$module$libs$y_webrtc_min(this)}_write(a){a.writeTypeRef(YTextRefID$$module$libs$y_webrtc_min)}}
class YXmlTreeWalker$$module$libs$y_webrtc_min{constructor(a,b=()=>!0){this._filter=b;this._root=a;this._currentNode=a._start;this._firstCall=!0}[Symbol.iterator](){return this}next(){let a=this._currentNode,b=a&&a.content&&a.content.type;if(null!==a&&(!this._firstCall||a.deleted||!this._filter(b))){do if(b=a.content.type,a.deleted||b.constructor!==YXmlElement$$module$libs$y_webrtc_min&&b.constructor!==YXmlFragment$$module$libs$y_webrtc_min||null===b._start)for(;null!==a;){if(null!==a.right){a=a.right;
break}a=a.parent===this._root?null:a.parent._item}else a=b._start;while(null!==a&&(a.deleted||!this._filter(a.content.type)))}return this._firstCall=!1,null===a?{value:void 0,done:!0}:(this._currentNode=a,{value:a.content.type,done:!1})}}
class YXmlFragment$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(){super();this._prelimContent=[]}get firstChild(){const a=this._first;return a?a.content.getContent()[0]:null}_integrate(a,b){super._integrate(a,b);this.insert(0,this._prelimContent);this._prelimContent=null}_copy(){return new YXmlFragment$$module$libs$y_webrtc_min}clone(){const a=new YXmlFragment$$module$libs$y_webrtc_min;return a.insert(0,this.toArray().map(b=>b instanceof AbstractType$$module$libs$y_webrtc_min?
b.clone():b)),a}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(a){return new YXmlTreeWalker$$module$libs$y_webrtc_min(this,a)}querySelector(a){a=a.toUpperCase();const b=(new YXmlTreeWalker$$module$libs$y_webrtc_min(this,c=>c.nodeName&&c.nodeName.toUpperCase()===a)).next();return b.done?null:b.value}querySelectorAll(a){return a=a.toUpperCase(),from$$module$libs$y_webrtc_min(new YXmlTreeWalker$$module$libs$y_webrtc_min(this,b=>b.nodeName&&b.nodeName.toUpperCase()===
a))}_callObserver(a,b){callTypeObservers$$module$libs$y_webrtc_min(this,a,new YXmlEvent$$module$libs$y_webrtc_min(this,b,a))}toString(){return typeListMap$$module$libs$y_webrtc_min(this,a=>a.toString()).join("")}toJSON(){return this.toString()}toDOM(a=document,b={},c){const d=a.createDocumentFragment();return void 0!==c&&c._createAssociation(d,this),typeListForEach$$module$libs$y_webrtc_min(this,e=>{d.insertBefore(e.toDOM(a,b,c),null)}),d}insert(a,b){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,
c=>{typeListInsertGenerics$$module$libs$y_webrtc_min(c,this,a,b)}):this._prelimContent.splice(a,0,...b)}insertAfter(a,b){if(null!==this.doc)transact$$module$libs$y_webrtc_min(this.doc,c=>{typeListInsertGenericsAfter$$module$libs$y_webrtc_min(c,this,a&&a instanceof AbstractType$$module$libs$y_webrtc_min?a._item:a,b)});else{const c=this._prelimContent,d=null===a?0:c.findIndex(e=>e===a)+1;if(0===d&&null!==a)throw create$2$$module$libs$y_webrtc_min("Reference item not found");c.splice(d,0,...b)}}delete(a,
b=1){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,c=>{typeListDelete$$module$libs$y_webrtc_min(c,this,a,b)}):this._prelimContent.splice(a,b)}toArray(){return typeListToArray$$module$libs$y_webrtc_min(this)}push(a){this.insert(this.length,a)}unshift(a){this.insert(0,a)}get(a){return typeListGet$$module$libs$y_webrtc_min(this,a)}slice(a=0,b=this.length){return typeListSlice$$module$libs$y_webrtc_min(this,a,b)}forEach(a){typeListForEach$$module$libs$y_webrtc_min(this,a)}_write(a){a.writeTypeRef(YXmlFragmentRefID$$module$libs$y_webrtc_min)}}
class YXmlElement$$module$libs$y_webrtc_min extends YXmlFragment$$module$libs$y_webrtc_min{constructor(a="UNDEFINED"){super();this.nodeName=a;this._prelimAttrs=new Map}get nextSibling(){const a=this._item?this._item.next:null;return a?a.content.type:null}get prevSibling(){const a=this._item?this._item.prev:null;return a?a.content.type:null}_integrate(a,b){super._integrate(a,b);this._prelimAttrs.forEach((c,d)=>{this.setAttribute(d,c)});this._prelimAttrs=null}_copy(){return new YXmlElement$$module$libs$y_webrtc_min(this.nodeName)}clone(){const a=
new YXmlElement$$module$libs$y_webrtc_min(this.nodeName);return((b,c)=>{for(const d in b)c(b[d],d)})(this.getAttributes(),(b,c)=>{"string"==typeof b&&a.setAttribute(c,b)}),a.insert(0,this.toArray().map(b=>b instanceof AbstractType$$module$libs$y_webrtc_min?b.clone():b)),a}toString(){var a=this.getAttributes();const b=[],c=[];for(var d in a)c.push(d);c.sort();d=c.length;for(let e=0;e<d;e++){const g=c[e];b.push(g+'="'+a[g]+'"')}a=this.nodeName.toLocaleLowerCase();return`<${a}${0<b.length?" "+b.join(" "):
""}>${super.toString()}</${a}>`}removeAttribute(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,b=>{typeMapDelete$$module$libs$y_webrtc_min(b,this,a)}):this._prelimAttrs.delete(a)}setAttribute(a,b){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,c=>{typeMapSet$$module$libs$y_webrtc_min(c,this,a,b)}):this._prelimAttrs.set(a,b)}getAttribute(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}hasAttribute(a){return typeMapHas$$module$libs$y_webrtc_min(this,a)}getAttributes(){return typeMapGetAll$$module$libs$y_webrtc_min(this)}toDOM(a=
document,b={},c){const d=a.createElement(this.nodeName),e=this.getAttributes();for(const g in e){const n=e[g];"string"==typeof n&&d.setAttribute(g,n)}return typeListForEach$$module$libs$y_webrtc_min(this,g=>{d.appendChild(g.toDOM(a,b,c))}),void 0!==c&&c._createAssociation(d,this),d}_write(a){a.writeTypeRef(YXmlElementRefID$$module$libs$y_webrtc_min);a.writeKey(this.nodeName)}}
class YXmlEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,b,c){super(a,c);this.childListChanged=!1;this.attributesChanged=new Set;b.forEach(d=>{null===d?this.childListChanged=!0:this.attributesChanged.add(d)})}}
class YXmlHook$$module$libs$y_webrtc_min extends YMap$$module$libs$y_webrtc_min{constructor(a){super();this.hookName=a}_copy(){return new YXmlHook$$module$libs$y_webrtc_min(this.hookName)}clone(){const a=new YXmlHook$$module$libs$y_webrtc_min(this.hookName);return this.forEach((b,c)=>{a.set(c,b)}),a}toDOM(a,b={},c){a=b[this.hookName];let d;return d=void 0!==a?a.createDom(this):document.createElement(this.hookName),d.setAttribute("data-yjs-hook",this.hookName),void 0!==c&&c._createAssociation(d,this),
d}_write(a){a.writeTypeRef(YXmlHookRefID$$module$libs$y_webrtc_min);a.writeKey(this.hookName)}}
class YXmlText$$module$libs$y_webrtc_min extends YText$$module$libs$y_webrtc_min{get nextSibling(){const a=this._item?this._item.next:null;return a?a.content.type:null}get prevSibling(){const a=this._item?this._item.prev:null;return a?a.content.type:null}_copy(){return new YXmlText$$module$libs$y_webrtc_min}clone(){const a=new YXmlText$$module$libs$y_webrtc_min;return a.applyDelta(this.toDelta()),a}toDOM(a=document,b,c){a=a.createTextNode(this.toString());return void 0!==c&&c._createAssociation(a,
this),a}toString(){return this.toDelta().map(a=>{const b=[];for(var c in a.attributes){var d=[];for(var e in a.attributes[c])d.push({key:e,value:a.attributes[c][e]});d.sort((g,n)=>g.key<n.key?-1:1);b.push({nodeName:c,attrs:d})}b.sort((g,n)=>g.nodeName<n.nodeName?-1:1);c="";for(d=0;d<b.length;d++){e=b[d];c+="<"+e.nodeName;for(let g=0;g<e.attrs.length;g++){const n=e.attrs[g];c+=` ${n.key}="${n.value}"`}c+=">"}c+=a.insert;for(a=b.length-1;0<=a;a--)c+=`</${b[a].nodeName}>`;return c}).join("")}toJSON(){return this.toString()}_write(a){a.writeTypeRef(YXmlTextRefID$$module$libs$y_webrtc_min)}}
class AbstractStruct$$module$libs$y_webrtc_min{constructor(a,b){this.id=a;this.length=b}get deleted(){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}write(a,b,c){throw methodUnimplemented$$module$libs$y_webrtc_min();}integrate(a,b){throw methodUnimplemented$$module$libs$y_webrtc_min();}}
class GC$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{get deleted(){return!0}delete(){}mergeWith(a){return this.constructor===a.constructor&&(this.length+=a.length,!0)}integrate(a,b){0<b&&(this.id.clock+=b,this.length-=b);addStruct$$module$libs$y_webrtc_min(a.doc.store,this)}write(a,b){a.writeInfo(0);a.writeLen(this.length-b)}getMissing(a,b){return null}}
class ContentBinary$$module$libs$y_webrtc_min{constructor(a){this.content=a}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ContentBinary$$module$libs$y_webrtc_min(this.content)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,b){}delete(a){}gc(a){}write(a,b){a.writeBuf(this.content)}getRef(){return 3}}
class ContentDeleted$$module$libs$y_webrtc_min{constructor(a){this.len=a}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ContentDeleted$$module$libs$y_webrtc_min(this.len)}splice(a){const b=new ContentDeleted$$module$libs$y_webrtc_min(this.len-a);return this.len=a,b}mergeWith(a){return this.len+=a.len,!0}integrate(a,b){addToDeleteSet$$module$libs$y_webrtc_min(a.deleteSet,b.id.client,b.id.clock,this.len);b.markDeleted()}delete(a){}gc(a){}write(a,b){a.writeLen(this.len-
b)}getRef(){return 1}}const createDocFromOpts$$module$libs$y_webrtc_min=(a,b)=>new Doc$$module$libs$y_webrtc_min({guid:a,...b,shouldLoad:b.shouldLoad||b.autoLoad||!1});
class ContentDoc$$module$libs$y_webrtc_min{constructor(a){a._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid.");this.doc=a;const b={};this.opts=b;a.gc||(b.gc=!1);a.autoLoad&&(b.autoLoad=!0);null!==a.meta&&(b.meta=a.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ContentDoc$$module$libs$y_webrtc_min(createDocFromOpts$$module$libs$y_webrtc_min(this.doc.guid,this.opts))}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();
}mergeWith(a){return!1}integrate(a,b){this.doc._item=b;a.subdocsAdded.add(this.doc);this.doc.shouldLoad&&a.subdocsLoaded.add(this.doc)}delete(a){a.subdocsAdded.has(this.doc)?a.subdocsAdded.delete(this.doc):a.subdocsRemoved.add(this.doc)}gc(a){}write(a,b){a.writeString(this.doc.guid);a.writeAny(this.opts)}getRef(){return 9}}
class ContentEmbed$$module$libs$y_webrtc_min{constructor(a){this.embed=a}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ContentEmbed$$module$libs$y_webrtc_min(this.embed)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,b){}delete(a){}gc(a){}write(a,b){a.writeJSON(this.embed)}getRef(){return 5}}
class ContentFormat$$module$libs$y_webrtc_min{constructor(a,b){this.key=a;this.value=b}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ContentFormat$$module$libs$y_webrtc_min(this.key,this.value)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,b){b.parent._searchMarker=null}delete(a){}gc(a){}write(a,b){a.writeKey(this.key);a.writeJSON(this.value)}getRef(){return 6}}
class ContentJSON$$module$libs$y_webrtc_min{constructor(a){this.arr=a}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentJSON$$module$libs$y_webrtc_min(this.arr)}splice(a){const b=new ContentJSON$$module$libs$y_webrtc_min(this.arr.slice(a));return this.arr=this.arr.slice(0,a),b}mergeWith(a){return this.arr=this.arr.concat(a.arr),!0}integrate(a,b){}delete(a){}gc(a){}write(a,b){const c=this.arr.length;for(a.writeLen(c-b);b<c;b++){const d=
this.arr[b];a.writeString(void 0===d?"undefined":JSON.stringify(d))}}getRef(){return 2}}
class ContentAny$$module$libs$y_webrtc_min{constructor(a){this.arr=a}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentAny$$module$libs$y_webrtc_min(this.arr)}splice(a){const b=new ContentAny$$module$libs$y_webrtc_min(this.arr.slice(a));return this.arr=this.arr.slice(0,a),b}mergeWith(a){return this.arr=this.arr.concat(a.arr),!0}integrate(a,b){}delete(a){}gc(a){}write(a,b){const c=this.arr.length;for(a.writeLen(c-b);b<c;b++)a.writeAny(this.arr[b])}getRef(){return 8}}
class ContentString$$module$libs$y_webrtc_min{constructor(a){this.str=a}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ContentString$$module$libs$y_webrtc_min(this.str)}splice(a){const b=new ContentString$$module$libs$y_webrtc_min(this.str.slice(a));this.str=this.str.slice(0,a);const c=this.str.charCodeAt(a-1);return 55296<=c&&56319>=c&&(this.str=this.str.slice(0,a-1)+"\ufffd",b.str="\ufffd"+b.str.slice(1)),b}mergeWith(a){return this.str+=
a.str,!0}integrate(a,b){}delete(a){}gc(a){}write(a,b){a.writeString(0===b?this.str:this.str.slice(b))}getRef(){return 4}}
const typeRefs$$module$libs$y_webrtc_min=[a=>new YArray$$module$libs$y_webrtc_min,a=>new YMap$$module$libs$y_webrtc_min,a=>new YText$$module$libs$y_webrtc_min,a=>new YXmlElement$$module$libs$y_webrtc_min(a.readKey()),a=>new YXmlFragment$$module$libs$y_webrtc_min,a=>new YXmlHook$$module$libs$y_webrtc_min(a.readKey()),a=>new YXmlText$$module$libs$y_webrtc_min],YArrayRefID$$module$libs$y_webrtc_min=0,YMapRefID$$module$libs$y_webrtc_min=1,YTextRefID$$module$libs$y_webrtc_min=2,YXmlElementRefID$$module$libs$y_webrtc_min=
3,YXmlFragmentRefID$$module$libs$y_webrtc_min=4,YXmlHookRefID$$module$libs$y_webrtc_min=5,YXmlTextRefID$$module$libs$y_webrtc_min=6;
class ContentType$$module$libs$y_webrtc_min{constructor(a){this.type=a}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ContentType$$module$libs$y_webrtc_min(this.type._copy())}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,b){this.type._integrate(a.doc,b)}delete(a){let b=this.type._start;for(;null!==b;)b.deleted?a._mergeStructs.push(b):b.delete(a),b=b.right;this.type._map.forEach(c=>{c.deleted?a._mergeStructs.push(c):
c.delete(a)});a.changed.delete(this.type)}gc(a){let b=this.type._start;for(;null!==b;)b.gc(a,!0),b=b.right;this.type._start=null;this.type._map.forEach(c=>{for(;null!==c;)c.gc(a,!0),c=c.left});this.type._map=new Map}write(a,b){this.type._write(a)}getRef(){return 7}}
const followRedone$$module$libs$y_webrtc_min=(a,b)=>{let c=b,d=0;do 0<d&&(c=createID$$module$libs$y_webrtc_min(c.client,c.clock+d)),b=getItem$$module$libs$y_webrtc_min(a,c),d=c.clock-b.id.clock,c=b.redone;while(null!==c&&b instanceof Item$$module$libs$y_webrtc_min);return{item:b,diff:d}},keepItem$$module$libs$y_webrtc_min=(a,b)=>{for(;null!==a&&a.keep!==b;)a.keep=b,a=a.parent._item},splitItem$$module$libs$y_webrtc_min=(a,b,c)=>{const {client:d,clock:e}=b.id,g=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(d,
e+c),b,createID$$module$libs$y_webrtc_min(d,e+c-1),b.right,b.rightOrigin,b.parent,b.parentSub,b.content.splice(c));return b.deleted&&g.markDeleted(),b.keep&&(g.keep=!0),null!==b.redone&&(g.redone=createID$$module$libs$y_webrtc_min(b.redone.client,b.redone.clock+c)),b.right=g,null!==g.right&&(g.right.left=g),a._mergeStructs.push(g),null!==g.parentSub&&null===g.right&&g.parent._map.set(g.parentSub,g),b.length=c,g},isDeletedByUndoStack$$module$libs$y_webrtc_min=(a,b)=>((c,d)=>{for(let e=0;e<c.length;e++)if(d(c[e],
e,c))return!0;return!1})(a,c=>isDeleted$$module$libs$y_webrtc_min(c.deletions,b)),redoItem$$module$libs$y_webrtc_min=(a,b,c,d,e,g)=>{var n=a.doc,t=n.store;n=n.clientID;var w=b.redone;if(null!==w)return getItemCleanStart$$module$libs$y_webrtc_min(a,w);let z=b.parent._item;if(null!==z&&!0===z.deleted){if(null===z.redone&&(!c.has(z)||null===redoItem$$module$libs$y_webrtc_min(a,z,c,d,e,g)))return null;for(;null!==z.redone;)z=getItemCleanStart$$module$libs$y_webrtc_min(a,z.redone)}w=null===z?b.parent:
z.content.type;if(null===b.parentSub){e=b.left;for(c=b;null!==e;){for(d=e;null!==d&&d.parent._item!==z;)d=null===d.redone?null:getItemCleanStart$$module$libs$y_webrtc_min(a,d.redone);if(null!==d&&d.parent._item===z){e=d;break}e=e.left}for(;null!==c;){for(d=c;null!==d&&d.parent._item!==z;)d=null===d.redone?null:getItemCleanStart$$module$libs$y_webrtc_min(a,d.redone);if(null!==d&&d.parent._item===z){c=d;break}c=c.right}}else if(c=null,b.right&&!e){for(e=b;null!==e&&null!==e.right&&(e.right.redone||
isDeleted$$module$libs$y_webrtc_min(d,e.right.id)||isDeletedByUndoStack$$module$libs$y_webrtc_min(g.undoStack,e.right.id)||isDeletedByUndoStack$$module$libs$y_webrtc_min(g.redoStack,e.right.id));)for(e=e.right;e.redone;)e=getItemCleanStart$$module$libs$y_webrtc_min(a,e.redone);if(e&&null!==e.right)return null}else e=w._map.get(b.parentSub)||null;t=getState$$module$libs$y_webrtc_min(t,n);t=createID$$module$libs$y_webrtc_min(n,t);n=new Item$$module$libs$y_webrtc_min(t,e,e&&e.lastId,c,c&&c.id,w,b.parentSub,
b.content.copy());return b.redone=t,keepItem$$module$libs$y_webrtc_min(n,!0),n.integrate(a,0),n};
class Item$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{constructor(a,b,c,d,e,g,n,t){super(a,t.getLength());this.origin=c;this.left=b;this.right=d;this.rightOrigin=e;this.parent=g;this.parentSub=n;this.redone=null;this.content=t;this.info=this.content.isCountable()?2:0}set marker(a){0<(8&this.info)!==a&&(this.info^=8)}get marker(){return 0<(8&this.info)}get keep(){return 0<(1&this.info)}set keep(a){this.keep!==a&&(this.info^=1)}get countable(){return 0<(2&this.info)}get deleted(){return 0<
(4&this.info)}set deleted(a){this.deleted!==a&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(a,b){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=getState$$module$libs$y_webrtc_min(b,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=getState$$module$libs$y_webrtc_min(b,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ID$$module$libs$y_webrtc_min&&
this.id.client!==this.parent.client&&this.parent.clock>=getState$$module$libs$y_webrtc_min(b,this.parent.client))return this.parent.client;(this.origin&&(this.left=getItemCleanEnd$$module$libs$y_webrtc_min(a,b,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=getItemCleanStart$$module$libs$y_webrtc_min(a,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===GC$$module$libs$y_webrtc_min||this.right&&this.right.constructor===GC$$module$libs$y_webrtc_min)&&
(this.parent=null),this.parent)?this.parent.constructor===ID$$module$libs$y_webrtc_min&&(a=getItem$$module$libs$y_webrtc_min(b,this.parent),a.constructor===GC$$module$libs$y_webrtc_min?this.parent=null:this.parent=a.content.type):(this.left&&this.left.constructor===Item$$module$libs$y_webrtc_min&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Item$$module$libs$y_webrtc_min&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub));
return null}integrate(a,b){if(0<b&&(this.id.clock+=b,this.left=getItemCleanEnd$$module$libs$y_webrtc_min(a,a.doc.store,createID$$module$libs$y_webrtc_min(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(b),this.length-=b),this.parent){if(!(this.left||this.right&&null===this.right.left)||this.left&&this.left.right!==this.right){let c=this.left;if(null!==c)b=c.right;else if(null!==this.parentSub)for(b=this.parent._map.get(this.parentSub)||null;null!==b&&
null!==b.left;)b=b.left;else b=this.parent._start;const d=new Set,e=new Set;for(;null!==b&&b!==this.right;){if(e.add(b),d.add(b),compareIDs$$module$libs$y_webrtc_min(this.origin,b.origin))if(b.id.client<this.id.client)c=b,d.clear();else{if(compareIDs$$module$libs$y_webrtc_min(this.rightOrigin,b.rightOrigin))break}else{if(null===b.origin||!e.has(getItem$$module$libs$y_webrtc_min(a.doc.store,b.origin)))break;d.has(getItem$$module$libs$y_webrtc_min(a.doc.store,b.origin))||(c=b,d.clear())}b=b.right}this.left=
c}if(null!==this.left)this.right=this.left.right,this.left.right=this;else{if(null!==this.parentSub)for(b=this.parent._map.get(this.parentSub)||null;null!==b&&null!==b.left;)b=b.left;else b=this.parent._start,this.parent._start=this;this.right=b}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(a));null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length);addStruct$$module$libs$y_webrtc_min(a.doc.store,
this);this.content.integrate(a,this);addChangedTypeToTransaction$$module$libs$y_webrtc_min(a,this.parent,this.parentSub);(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(a)}else(new GC$$module$libs$y_webrtc_min(this.id,this.length)).integrate(a,0)}get next(){let a=this.right;for(;null!==a&&a.deleted;)a=a.right;return a}get prev(){let a=this.left;for(;null!==a&&a.deleted;)a=a.left;return a}get lastId(){return 1===this.length?this.id:createID$$module$libs$y_webrtc_min(this.id.client,
this.id.clock+this.length-1)}mergeWith(a){if(this.constructor===a.constructor&&compareIDs$$module$libs$y_webrtc_min(a.origin,this.lastId)&&this.right===a&&compareIDs$$module$libs$y_webrtc_min(this.rightOrigin,a.rightOrigin)&&this.id.client===a.id.client&&this.id.clock+this.length===a.id.clock&&this.deleted===a.deleted&&null===this.redone&&null===a.redone&&this.content.constructor===a.content.constructor&&this.content.mergeWith(a.content)){const b=this.parent._searchMarker;return b&&b.forEach(c=>{c.p===
a&&(c.p=this,!this.deleted&&this.countable&&(c.index-=this.length))}),a.keep&&(this.keep=!0),this.right=a.right,null!==this.right&&(this.right.left=this),this.length+=a.length,!0}return!1}delete(a){if(!this.deleted){const b=this.parent;this.countable&&null===this.parentSub&&(b._length-=this.length);this.markDeleted();addToDeleteSet$$module$libs$y_webrtc_min(a.deleteSet,this.id.client,this.id.clock,this.length);addChangedTypeToTransaction$$module$libs$y_webrtc_min(a,b,this.parentSub);this.content.delete(a)}}gc(a,
b){if(!this.deleted)throw unexpectedCase$$module$libs$y_webrtc_min();this.content.gc(a);b?(b=new GC$$module$libs$y_webrtc_min(this.id,this.length),a=a.clients.get(this.id.client),a[findIndexSS$$module$libs$y_webrtc_min(a,this.id.clock)]=b):this.content=new ContentDeleted$$module$libs$y_webrtc_min(this.length)}write(a,b){var c=0<b?createID$$module$libs$y_webrtc_min(this.id.client,this.id.clock+b-1):this.origin,d=this.rightOrigin;const e=this.parentSub,g=31&this.content.getRef()|(null===c?0:128)|(null===
d?0:64)|(null===e?0:32);if(a.writeInfo(g),null!==c&&a.writeLeftID(c),null!==d&&a.writeRightID(d),null===c&&null===d)c=this.parent,void 0!==c._item?(d=c._item,null===d?(c=findRootTypeKey$$module$libs$y_webrtc_min(c),a.writeParentInfo(!0),a.writeString(c)):(a.writeParentInfo(!1),a.writeLeftID(d.id))):c.constructor===String?(a.writeParentInfo(!0),a.writeString(c)):c.constructor===ID$$module$libs$y_webrtc_min?(a.writeParentInfo(!1),a.writeLeftID(c)):unexpectedCase$$module$libs$y_webrtc_min(),null!==e&&
a.writeString(e);this.content.write(a,b)}}
const readItemContent$$module$libs$y_webrtc_min=(a,b)=>contentRefs$$module$libs$y_webrtc_min[31&b](a),contentRefs$$module$libs$y_webrtc_min=[()=>{unexpectedCase$$module$libs$y_webrtc_min()},a=>new ContentDeleted$$module$libs$y_webrtc_min(a.readLen()),a=>{const b=a.readLen(),c=[];for(let d=0;d<b;d++){const e=a.readString();"undefined"===e?c.push(void 0):c.push(JSON.parse(e))}return new ContentJSON$$module$libs$y_webrtc_min(c)},a=>new ContentBinary$$module$libs$y_webrtc_min(a.readBuf()),a=>new ContentString$$module$libs$y_webrtc_min(a.readString()),
a=>new ContentEmbed$$module$libs$y_webrtc_min(a.readJSON()),a=>new ContentFormat$$module$libs$y_webrtc_min(a.readKey(),a.readJSON()),a=>new ContentType$$module$libs$y_webrtc_min(typeRefs$$module$libs$y_webrtc_min[a.readTypeRef()](a)),a=>{const b=a.readLen(),c=[];for(let d=0;d<b;d++)c.push(a.readAny());return new ContentAny$$module$libs$y_webrtc_min(c)},a=>new ContentDoc$$module$libs$y_webrtc_min(createDocFromOpts$$module$libs$y_webrtc_min(a.readString(),a.readAny())),()=>{unexpectedCase$$module$libs$y_webrtc_min()}];
class Skip$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{get deleted(){return!0}delete(){}mergeWith(a){return this.constructor===a.constructor&&(this.length+=a.length,!0)}integrate(a,b){unexpectedCase$$module$libs$y_webrtc_min()}write(a,b){a.writeInfo(10);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,this.length-b)}getMissing(a,b){return null}}
const glo$$module$libs$y_webrtc_min="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};!0===glo$$module$libs$y_webrtc_min["__ $YJS$ __"]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");glo$$module$libs$y_webrtc_min["__ $YJS$ __"]=!0;
var commonjsGlobal$$module$libs$y_webrtc_min="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire$$module$libs$y_webrtc_min(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs");}
var simplepeer_min$$module$libs$y_webrtc_min=function(a,b){return a(b={exports:{}},b.exports),b.exports}(function(a,b){var c,d,e;a.exports=(c=Math.floor,d=Math.abs,e=Math.pow,function z(n,t,w){function C(L,O){if(!t[L]){if(!n[L]){if(!O&&commonjsRequire$$module$libs$y_webrtc_min)return commonjsRequire$$module$libs$y_webrtc_min();if(H)return H(L,!0);O=Error("Cannot find module '"+L+"'");throw O.code="MODULE_NOT_FOUND",O;}O=t[L]={exports:{}};n[L][0].call(O.exports,function(S){return C(n[L][1][S]||S)},
O,O.exports,z,n,t,w)}return t[L].exports}for(var H=commonjsRequire$$module$libs$y_webrtc_min,M=0;M<w.length;M++)C(w[M]);return C}({1:[function(n,t,w){function z(L){var O=L.length;if(0<O%4)throw Error("Invalid string. Length must be a multiple of 4");L=L.indexOf("=");return-1===L&&(L=O),[L,L===O?0:4-L%4]}w.byteLength=function(L){L=z(L);var O=L[1];return 3*(L[0]+O)/4-O};w.toByteArray=function(L){var O=z(L);var S=O[0];O=O[1];var T=new M(3*(S+O)/4-O),P=0,W=0<O?S-4:S;for(S=0;S<W;S+=4){var Z=H[L.charCodeAt(S)]<<
18|H[L.charCodeAt(S+1)]<<12|H[L.charCodeAt(S+2)]<<6|H[L.charCodeAt(S+3)];T[P++]=255&Z>>16;T[P++]=255&Z>>8;T[P++]=255&Z}return 2===O&&(Z=H[L.charCodeAt(S)]<<2|H[L.charCodeAt(S+1)]>>4,T[P++]=255&Z),1===O&&(Z=H[L.charCodeAt(S)]<<10|H[L.charCodeAt(S+1)]<<4|H[L.charCodeAt(S+2)]>>2,T[P++]=255&Z>>8,T[P++]=255&Z),T};w.fromByteArray=function(L){for(var O,S=L.length,T=S%3,P=[],W=0,Z=S-T;W<Z;W+=16383){for(var ca=P,ba=ca.push,la,ea=L,oa=W+16383>Z?Z:W+16383,sa=[],xa=W;xa<oa;xa+=3)la=(16711680&ea[xa]<<16)+(65280&
ea[xa+1]<<8)+(255&ea[xa+2]),sa.push(C[63&la>>18]+C[63&la>>12]+C[63&la>>6]+C[63&la]);la=sa.join("");ba.call(ca,la)}return 1===T?(O=L[S-1],P.push(C[O>>2]+C[63&O<<4]+"==")):2===T&&(O=(L[S-2]<<8)+L[S-1],P.push(C[O>>10]+C[63&O>>4]+C[63&O<<2]+"=")),P.join("")};var C=[],H=[],M="undefined"==typeof Uint8Array?Array:Uint8Array;for(n=0;64>n;++n)C[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n],H["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(n)]=n;H[45]=
62;H[95]=63},{}],2:[function(){},{}],3:[function(n,t,w){(function(){(function(){function z(Q){if(2147483647<Q)throw new RangeError('The value "'+Q+'" is invalid for option "size"');Q=new Uint8Array(Q);return Q.__proto__=C.prototype,Q}function C(Q,R,V){if("number"==typeof Q){if("string"==typeof R)throw new TypeError('The "string" argument must be of type string. Received type number');return L(Q)}return H(Q,R,V)}function H(Q,R,V){if("string"==typeof Q)return function(qa,Ca){if(("string"!=typeof Ca||
""===Ca)&&(Ca="utf8"),!C.isEncoding(Ca))throw new TypeError("Unknown encoding: "+Ca);var Aa=0|T(qa,Ca),ia=z(Aa);qa=ia.write(qa,Ca);return qa!==Aa&&(ia=ia.slice(0,qa)),ia}(Q,R);if(ArrayBuffer.isView(Q))return O(Q);if(null==Q)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Q);if(Ia(Q,ArrayBuffer)||Q&&Ia(Q.buffer,ArrayBuffer))return function(qa,Ca,Aa){if(0>Ca||qa.byteLength<Ca)throw new RangeError('"offset" is outside of buffer bounds');
if(qa.byteLength<Ca+(Aa||0))throw new RangeError('"length" is outside of buffer bounds');var ia;return(ia=void 0===Ca&&void 0===Aa?new Uint8Array(qa):void 0===Aa?new Uint8Array(qa,Ca):new Uint8Array(qa,Ca,Aa)).__proto__=C.prototype,ia}(Q,R,V);if("number"==typeof Q)throw new TypeError('The "value" argument must not be of type number. Received type number');var ja=Q.valueOf&&Q.valueOf();if(null!=ja&&ja!==Q)return C.from(ja,R,V);if(ja=function(qa){if(C.isBuffer(qa)){var Ca=0|S(qa.length),Aa=z(Ca);return 0===
Aa.length||qa.copy(Aa,0,0,Ca),Aa}return void 0===qa.length?"Buffer"===qa.type&&Array.isArray(qa.data)?O(qa.data):void 0:"number"!=typeof qa.length||Ma(qa.length)?z(0):O(qa)}(Q))return ja;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof Q[Symbol.toPrimitive])return C.from(Q[Symbol.toPrimitive]("string"),R,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Q);}function M(Q){if("number"!=
typeof Q)throw new TypeError('"size" argument must be of type number');if(0>Q)throw new RangeError('The value "'+Q+'" is invalid for option "size"');}function L(Q){return M(Q),z(0>Q?0:0|S(Q))}function O(Q){for(var R=0>Q.length?0:0|S(Q.length),V=z(R),ja=0;ja<R;ja+=1)V[ja]=255&Q[ja];return V}function S(Q){if(2147483647<=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(2147483647).toString(16)+" bytes");return 0|Q}function T(Q,R){if(C.isBuffer(Q))return Q.length;if(ArrayBuffer.isView(Q)||
Ia(Q,ArrayBuffer))return Q.byteLength;if("string"!=typeof Q)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Q);var V=Q.length,ja=2<arguments.length&&!0===arguments[2];if(!ja&&0===V)return 0;for(var qa=!1;;)switch(R){case "ascii":case "latin1":case "binary":return V;case "utf8":case "utf-8":return Ya(Q).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*V;case "hex":return V>>>1;case "base64":return Ja(Q).length;
default:if(qa)return ja?-1:Ya(Q).length;R=(""+R).toLowerCase();qa=!0}}function P(Q,R,V){var ja=!1;if(((void 0===R||0>R)&&(R=0),R>this.length)||((void 0===V||V>this.length)&&(V=this.length),0>=V)||(V>>>=0)<=(R>>>=0))return"";for(Q||="utf8";;)switch(Q){case "hex":Q=R;R=this.length;(!Q||0>Q)&&(Q=0);(!V||0>V||V>R)&&(V=R);for(R="";Q<V;++Q)ja=this[Q],ja=16>ja?"0"+ja.toString(16):ja.toString(16),R+=ja;return R;case "utf8":case "utf-8":return la(this,R,V);case "ascii":Q=R;R="";for(V=Qb(this.length,V);Q<V;++Q)R+=
Nb(127&this[Q]);return R;case "latin1":case "binary":Q=R;R="";for(V=Qb(this.length,V);Q<V;++Q)R+=Nb(this[Q]);return R;case "base64":return Q=R,0===Q&&V===this.length?dd.fromByteArray(this):dd.fromByteArray(this.slice(Q,V));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":V=this.slice(R,V);Q="";for(R=0;R<V.length;R+=2)Q+=Nb(V[R]+256*V[R+1]);return Q;default:if(ja)throw new TypeError("Unknown encoding: "+Q);Q=(Q+"").toLowerCase();ja=!0}}function W(Q,R,V){var ja=Q[R];Q[R]=Q[V];Q[V]=ja}function Z(Q,
R,V,ja,qa){if(0===Q.length)return-1;if("string"==typeof V?(ja=V,V=0):2147483647<V?V=2147483647:-2147483648>V&&(V=-2147483648),Ma(V=+V)&&(V=qa?0:Q.length-1),0>V&&(V=Q.length+V),V>=Q.length){if(qa)return-1;V=Q.length-1}else if(0>V){if(!qa)return-1;V=0}if("string"==typeof R&&(R=C.from(R,ja)),C.isBuffer(R))return 0===R.length?-1:ca(Q,R,V,ja,qa);if("number"==typeof R)return R&=255,"function"==typeof Uint8Array.prototype.indexOf?qa?Uint8Array.prototype.indexOf.call(Q,R,V):Uint8Array.prototype.lastIndexOf.call(Q,
R,V):ca(Q,[R],V,ja,qa);throw new TypeError("val must be string, number or Buffer");}function ca(Q,R,V,ja,qa){function Ca(za,Ra){return 1===Aa?za[Ra]:za.readUInt16BE(Ra*Aa)}var Aa=1,ia=Q.length,fa=R.length;if(void 0!==ja&&("ucs2"===(ja=(ja+"").toLowerCase())||"ucs-2"===ja||"utf16le"===ja||"utf-16le"===ja)){if(2>Q.length||2>R.length)return-1;Aa=2;ia/=2;fa/=2;V/=2}if(qa)for(ja=-1;V<ia;V++)if(Ca(Q,V)!==Ca(R,-1===ja?0:V-ja))-1!==ja&&(V-=V-ja),ja=-1;else{if(-1===ja&&(ja=V),V-ja+1===fa)return ja*Aa}else for(V+
fa>ia&&(V=ia-fa);0<=V;V--){ia=!0;for(ja=0;ja<fa;ja++)if(Ca(Q,V+ja)!==Ca(R,ja)){ia=!1;break}if(ia)return V}return-1}function ba(Q,R,V,ja){for(var qa=[],Ca=0;Ca<R.length;++Ca)qa.push(255&R.charCodeAt(Ca));return ac(qa,Q,V,ja)}function la(Q,R,V){V=Qb(Q.length,V);for(var ja=[];R<V;){var qa,Ca,Aa,ia,fa=Q[R],za=null,Ra=239<fa?4:223<fa?3:191<fa?2:1;R+Ra<=V&&(1===Ra?128>fa&&(za=fa):2===Ra?128==(192&(qa=Q[R+1]))&&127<(ia=(31&fa)<<6|63&qa)&&(za=ia):3===Ra?(qa=Q[R+1],Ca=Q[R+2],128==(192&qa)&&128==(192&Ca)&&
2047<(ia=(15&fa)<<12|(63&qa)<<6|63&Ca)&&(55296>ia||57343<ia)&&(za=ia)):4===Ra&&(qa=Q[R+1],Ca=Q[R+2],Aa=Q[R+3],128==(192&qa)&&128==(192&Ca)&&128==(192&Aa)&&65535<(ia=(15&fa)<<18|(63&qa)<<12|(63&Ca)<<6|63&Aa)&&1114112>ia&&(za=ia)));null===za?(za=65533,Ra=1):65535<za&&(za-=65536,ja.push(55296|1023&za>>>10),za=56320|1023&za);ja.push(za);R+=Ra}Q=ja.length;if(4096>=Q)ja=Nb.apply(String,ja);else{V="";for(qa=0;qa<Q;)V+=Nb.apply(String,ja.slice(qa,qa+=4096));ja=V}return ja}function ea(Q,R,V){if(0!=Q%1||0>
Q)throw new RangeError("offset is not uint");if(Q+R>V)throw new RangeError("Trying to access beyond buffer length");}function oa(Q,R,V,ja,qa,Ca){if(!C.isBuffer(Q))throw new TypeError('"buffer" argument must be a Buffer instance');if(R>qa||R<Ca)throw new RangeError('"value" argument is out of bounds');if(V+ja>Q.length)throw new RangeError("Index out of range");}function sa(Q,R,V,ja){if(V+ja>Q.length)throw new RangeError("Index out of range");if(0>V)throw new RangeError("Index out of range");}function xa(Q,
R,V,ja,qa){return R=+R,V>>>=0,qa||sa(Q,0,V,4),eb.write(Q,R,V,ja,23,4),V+4}function ya(Q,R,V,ja,qa){return R=+R,V>>>=0,qa||sa(Q,0,V,8),eb.write(Q,R,V,ja,52,8),V+8}function Ya(Q,R){R=R||1/0;for(var V,ja=Q.length,qa=null,Ca=[],Aa=0;Aa<ja;++Aa){if(55295<(V=Q.charCodeAt(Aa))&&57344>V){if(!qa){if(56319<V){-1<(R-=3)&&Ca.push(239,191,189);continue}if(Aa+1===ja){-1<(R-=3)&&Ca.push(239,191,189);continue}qa=V;continue}if(56320>V){-1<(R-=3)&&Ca.push(239,191,189);qa=V;continue}V=65536+(qa-55296<<10|V-56320)}else qa&&
-1<(R-=3)&&Ca.push(239,191,189);if(qa=null,128>V){if(0>--R)break;Ca.push(V)}else if(2048>V){if(0>(R-=2))break;Ca.push(192|V>>6,128|63&V)}else if(65536>V){if(0>(R-=3))break;Ca.push(224|V>>12,128|63&V>>6,128|63&V)}else{if(!(1114112>V))throw Error("Invalid code point");if(0>(R-=4))break;Ca.push(240|V>>18,128|63&V>>12,128|63&V>>6,128|63&V)}}return Ca}function Ja(Q){var R=dd,V=R.toByteArray;if(2>(Q=(Q=Q.split("=")[0]).trim().replace(Vc,"")).length)Q="";else for(;0!=Q.length%4;)Q+="=";return V.call(R,Q)}
function ac(Q,R,V,ja){for(var qa=0;qa<ja&&!(qa+V>=R.length||qa>=Q.length);++qa)R[qa+V]=Q[qa];return qa}function Ia(Q,R){return Q instanceof R||null!=Q&&null!=Q.constructor&&null!=Q.constructor.name&&Q.constructor.name===R.name}function Ma(Q){return Q!=Q}var Nb=String.fromCharCode,Qb=Math.min,dd=n("base64-js"),eb=n("ieee754");w.Buffer=C;w.SlowBuffer=function(Q){return+Q!=Q&&(Q=0),C.alloc(+Q)};w.INSPECT_MAX_BYTES=50;w.kMaxLength=2147483647;C.TYPED_ARRAY_SUPPORT=function(){try{var Q=new Uint8Array(1);
return Q.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===Q.foo()}catch(R){return!1}}();C.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(C.prototype,"parent",{enumerable:!0,get:function(){return C.isBuffer(this)?this.buffer:void 0}});Object.defineProperty(C.prototype,
"offset",{enumerable:!0,get:function(){return C.isBuffer(this)?this.byteOffset:void 0}});"undefined"!=typeof Symbol&&null!=Symbol.species&&C[Symbol.species]===C&&Object.defineProperty(C,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1});C.poolSize=8192;C.from=function(Q,R,V){return H(Q,R,V)};C.prototype.__proto__=Uint8Array.prototype;C.__proto__=Uint8Array;C.alloc=function(Q,R,V){return M(Q),0>=Q||void 0===R?z(Q):"string"==typeof V?z(Q).fill(R,V):z(Q).fill(R)};C.allocUnsafe=function(Q){return L(Q)};
C.allocUnsafeSlow=function(Q){return L(Q)};C.isBuffer=function(Q){return null!=Q&&!0===Q._isBuffer&&Q!==C.prototype};C.compare=function(Q,R){if(Ia(Q,Uint8Array)&&(Q=C.from(Q,Q.offset,Q.byteLength)),Ia(R,Uint8Array)&&(R=C.from(R,R.offset,R.byteLength)),!C.isBuffer(Q)||!C.isBuffer(R))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Q===R)return 0;for(var V=Q.length,ja=R.length,qa=0,Ca=Qb(V,ja);qa<Ca;++qa)if(Q[qa]!==R[qa]){V=Q[qa];ja=R[qa];break}return V<
ja?-1:ja<V?1:0};C.isEncoding=function(Q){switch((Q+"").toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};C.concat=function(Q,R){if(!Array.isArray(Q))throw new TypeError('"list" argument must be an Array of Buffers');if(0===Q.length)return C.alloc(0);var V;if(void 0===R)for(V=R=0;V<Q.length;++V)R+=Q[V].length;R=C.allocUnsafe(R);var ja=0;for(V=0;V<Q.length;++V){var qa=
Q[V];if(Ia(qa,Uint8Array)&&(qa=C.from(qa)),!C.isBuffer(qa))throw new TypeError('"list" argument must be an Array of Buffers');qa.copy(R,ja);ja+=qa.length}return R};C.byteLength=T;C.prototype._isBuffer=!0;C.prototype.swap16=function(){var Q=this.length;if(0!=Q%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var R=0;R<Q;R+=2)W(this,R,R+1);return this};C.prototype.swap32=function(){var Q=this.length;if(0!=Q%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var R=
0;R<Q;R+=4)W(this,R,R+3),W(this,R+1,R+2);return this};C.prototype.swap64=function(){var Q=this.length;if(0!=Q%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var R=0;R<Q;R+=8)W(this,R,R+7),W(this,R+1,R+6),W(this,R+2,R+5),W(this,R+3,R+4);return this};C.prototype.toString=function(){var Q=this.length;return 0===Q?"":0===arguments.length?la(this,0,Q):P.apply(this,arguments)};C.prototype.toLocaleString=C.prototype.toString;C.prototype.equals=function(Q){if(!C.isBuffer(Q))throw new TypeError("Argument must be a Buffer");
return this===Q||0===C.compare(this,Q)};C.prototype.inspect=function(){var Q="",R=w.INSPECT_MAX_BYTES;return Q=this.toString("hex",0,R).replace(/(.{2})/g,"$1 ").trim(),this.length>R&&(Q+=" ... "),"<Buffer "+Q+">"};C.prototype.compare=function(Q,R,V,ja,qa){if(Ia(Q,Uint8Array)&&(Q=C.from(Q,Q.offset,Q.byteLength)),!C.isBuffer(Q))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Q);if(void 0===R&&(R=0),void 0===V&&(V=Q?Q.length:0),void 0===ja&&
(ja=0),void 0===qa&&(qa=this.length),0>R||V>Q.length||0>ja||qa>this.length)throw new RangeError("out of range index");if(ja>=qa&&R>=V)return 0;if(ja>=qa)return-1;if(R>=V)return 1;if(this===Q)return 0;var Ca=(qa>>>=0)-(ja>>>=0),Aa=(V>>>=0)-(R>>>=0),ia=Qb(Ca,Aa);ja=this.slice(ja,qa);Q=Q.slice(R,V);for(R=0;R<ia;++R)if(ja[R]!==Q[R]){Ca=ja[R];Aa=Q[R];break}return Ca<Aa?-1:Aa<Ca?1:0};C.prototype.includes=function(Q,R,V){return-1!==this.indexOf(Q,R,V)};C.prototype.indexOf=function(Q,R,V){return Z(this,Q,
R,V,!0)};C.prototype.lastIndexOf=function(Q,R,V){return Z(this,Q,R,V,!1)};C.prototype.write=function(Q,R,V,ja){if(void 0===R)ja="utf8",V=this.length,R=0;else if(void 0===V&&"string"==typeof R)ja=R,V=this.length,R=0;else{if(!isFinite(R))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");R>>>=0;isFinite(V)?(V>>>=0,void 0===ja&&(ja="utf8")):(ja=V,V=void 0)}var qa=this.length-R;if((void 0===V||V>qa)&&(V=qa),0<Q.length&&(0>V||0>R)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");
ja||="utf8";for(qa=!1;;)switch(ja){case "hex":a:{R=+R||0;ja=this.length-R;V?(V=+V)>ja&&(V=ja):V=ja;ja=Q.length;V>ja/2&&(V=ja/2);for(qa=0;qa<V;++qa){if(Ma(ja=parseInt(Q.substr(2*qa,2),16))){V=qa;break a}this[R+qa]=ja}V=qa}return V;case "utf8":case "utf-8":return ac(Ya(Q,this.length-R),this,R,V);case "ascii":return ba(this,Q,R,V);case "latin1":case "binary":return ba(this,Q,R,V);case "base64":return ac(Ja(Q),this,R,V);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ja=V;qa=this.length-R;for(var Ca=
[],Aa=0;Aa<Q.length&&!(0>(qa-=2));++Aa){var ia=Q.charCodeAt(Aa);V=ia>>8;ia%=256;Ca.push(ia);Ca.push(V)}return ac(Ca,this,R,ja);default:if(qa)throw new TypeError("Unknown encoding: "+ja);ja=(""+ja).toLowerCase();qa=!0}};C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};C.prototype.slice=function(Q,R){var V=this.length;0>(Q=~~Q)?0>(Q+=V)&&(Q=0):Q>V&&(Q=V);0>(R=void 0===R?V:~~R)?0>(R+=V)&&(R=0):R>V&&(R=V);R<Q&&(R=Q);Q=this.subarray(Q,R);return Q.__proto__=
C.prototype,Q};C.prototype.readUIntLE=function(Q,R,V){Q>>>=0;R>>>=0;V||ea(Q,R,this.length);V=this[Q];for(var ja=1,qa=0;++qa<R&&(ja*=256);)V+=this[Q+qa]*ja;return V};C.prototype.readUIntBE=function(Q,R,V){Q>>>=0;R>>>=0;V||ea(Q,R,this.length);V=this[Q+--R];for(var ja=1;0<R&&(ja*=256);)V+=this[Q+--R]*ja;return V};C.prototype.readUInt8=function(Q,R){return Q>>>=0,R||ea(Q,1,this.length),this[Q]};C.prototype.readUInt16LE=function(Q,R){return Q>>>=0,R||ea(Q,2,this.length),this[Q]|this[Q+1]<<8};C.prototype.readUInt16BE=
function(Q,R){return Q>>>=0,R||ea(Q,2,this.length),this[Q]<<8|this[Q+1]};C.prototype.readUInt32LE=function(Q,R){return Q>>>=0,R||ea(Q,4,this.length),(this[Q]|this[Q+1]<<8|this[Q+2]<<16)+16777216*this[Q+3]};C.prototype.readUInt32BE=function(Q,R){return Q>>>=0,R||ea(Q,4,this.length),16777216*this[Q]+(this[Q+1]<<16|this[Q+2]<<8|this[Q+3])};C.prototype.readIntLE=function(Q,R,V){Q>>>=0;R>>>=0;V||ea(Q,R,this.length);V=this[Q];for(var ja=1,qa=0;++qa<R&&(ja*=256);)V+=this[Q+qa]*ja;return V>=128*ja&&(V-=e(2,
8*R)),V};C.prototype.readIntBE=function(Q,R,V){Q>>>=0;R>>>=0;V||ea(Q,R,this.length);V=R;for(var ja=1,qa=this[Q+--V];0<V&&(ja*=256);)qa+=this[Q+--V]*ja;return qa>=128*ja&&(qa-=e(2,8*R)),qa};C.prototype.readInt8=function(Q,R){return Q>>>=0,R||ea(Q,1,this.length),128&this[Q]?-1*(255-this[Q]+1):this[Q]};C.prototype.readInt16LE=function(Q,R){Q>>>=0;R||ea(Q,2,this.length);Q=this[Q]|this[Q+1]<<8;return 32768&Q?4294901760|Q:Q};C.prototype.readInt16BE=function(Q,R){Q>>>=0;R||ea(Q,2,this.length);Q=this[Q+1]|
this[Q]<<8;return 32768&Q?4294901760|Q:Q};C.prototype.readInt32LE=function(Q,R){return Q>>>=0,R||ea(Q,4,this.length),this[Q]|this[Q+1]<<8|this[Q+2]<<16|this[Q+3]<<24};C.prototype.readInt32BE=function(Q,R){return Q>>>=0,R||ea(Q,4,this.length),this[Q]<<24|this[Q+1]<<16|this[Q+2]<<8|this[Q+3]};C.prototype.readFloatLE=function(Q,R){return Q>>>=0,R||ea(Q,4,this.length),eb.read(this,Q,!0,23,4)};C.prototype.readFloatBE=function(Q,R){return Q>>>=0,R||ea(Q,4,this.length),eb.read(this,Q,!1,23,4)};C.prototype.readDoubleLE=
function(Q,R){return Q>>>=0,R||ea(Q,8,this.length),eb.read(this,Q,!0,52,8)};C.prototype.readDoubleBE=function(Q,R){return Q>>>=0,R||ea(Q,8,this.length),eb.read(this,Q,!1,52,8)};C.prototype.writeUIntLE=function(Q,R,V,ja){Q=+Q;R>>>=0;V>>>=0;ja||oa(this,Q,R,V,e(2,8*V)-1,0);ja=1;var qa=0;for(this[R]=255&Q;++qa<V&&(ja*=256);)this[R+qa]=255&Q/ja;return R+V};C.prototype.writeUIntBE=function(Q,R,V,ja){Q=+Q;R>>>=0;V>>>=0;ja||oa(this,Q,R,V,e(2,8*V)-1,0);ja=V-1;var qa=1;for(this[R+ja]=255&Q;0<=--ja&&(qa*=256);)this[R+
ja]=255&Q/qa;return R+V};C.prototype.writeUInt8=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,1,255,0),this[R]=255&Q,R+1};C.prototype.writeUInt16LE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,2,65535,0),this[R]=255&Q,this[R+1]=Q>>>8,R+2};C.prototype.writeUInt16BE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,2,65535,0),this[R]=Q>>>8,this[R+1]=255&Q,R+2};C.prototype.writeUInt32LE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,4,4294967295,0),this[R+3]=Q>>>24,this[R+2]=Q>>>16,this[R+
1]=Q>>>8,this[R]=255&Q,R+4};C.prototype.writeUInt32BE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,4,4294967295,0),this[R]=Q>>>24,this[R+1]=Q>>>16,this[R+2]=Q>>>8,this[R+3]=255&Q,R+4};C.prototype.writeIntLE=function(Q,R,V,ja){(Q=+Q,R>>>=0,ja)||(ja=e(2,8*V-1),oa(this,Q,R,V,ja-1,-ja));ja=0;var qa=1,Ca=0;for(this[R]=255&Q;++ja<V&&(qa*=256);)0>Q&&0===Ca&&0!==this[R+ja-1]&&(Ca=1),this[R+ja]=255&(Q/qa>>0)-Ca;return R+V};C.prototype.writeIntBE=function(Q,R,V,ja){(Q=+Q,R>>>=0,ja)||(ja=e(2,8*V-1),oa(this,
Q,R,V,ja-1,-ja));ja=V-1;var qa=1,Ca=0;for(this[R+ja]=255&Q;0<=--ja&&(qa*=256);)0>Q&&0===Ca&&0!==this[R+ja+1]&&(Ca=1),this[R+ja]=255&(Q/qa>>0)-Ca;return R+V};C.prototype.writeInt8=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,1,127,-128),0>Q&&(Q=255+Q+1),this[R]=255&Q,R+1};C.prototype.writeInt16LE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,2,32767,-32768),this[R]=255&Q,this[R+1]=Q>>>8,R+2};C.prototype.writeInt16BE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,2,32767,-32768),this[R]=
Q>>>8,this[R+1]=255&Q,R+2};C.prototype.writeInt32LE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,4,2147483647,-2147483648),this[R]=255&Q,this[R+1]=Q>>>8,this[R+2]=Q>>>16,this[R+3]=Q>>>24,R+4};C.prototype.writeInt32BE=function(Q,R,V){return Q=+Q,R>>>=0,V||oa(this,Q,R,4,2147483647,-2147483648),0>Q&&(Q=4294967295+Q+1),this[R]=Q>>>24,this[R+1]=Q>>>16,this[R+2]=Q>>>8,this[R+3]=255&Q,R+4};C.prototype.writeFloatLE=function(Q,R,V){return xa(this,Q,R,!0,V)};C.prototype.writeFloatBE=function(Q,R,V){return xa(this,
Q,R,!1,V)};C.prototype.writeDoubleLE=function(Q,R,V){return ya(this,Q,R,!0,V)};C.prototype.writeDoubleBE=function(Q,R,V){return ya(this,Q,R,!1,V)};C.prototype.copy=function(Q,R,V,ja){if(!C.isBuffer(Q))throw new TypeError("argument should be a Buffer");if((V||=0,ja||0===ja||(ja=this.length),R>=Q.length&&(R=Q.length),R||=0,0<ja&&ja<V&&(ja=V),ja===V)||0===Q.length||0===this.length)return 0;if(0>R)throw new RangeError("targetStart out of bounds");if(0>V||V>=this.length)throw new RangeError("Index out of range");
if(0>ja)throw new RangeError("sourceEnd out of bounds");ja>this.length&&(ja=this.length);Q.length-R<ja-V&&(ja=Q.length-R+V);var qa=ja-V;if(this===Q&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(R,V,ja);else if(this===Q&&V<R&&R<ja)for(ja=qa-1;0<=ja;--ja)Q[ja+R]=this[ja+V];else Uint8Array.prototype.set.call(Q,this.subarray(V,ja),R);return qa};C.prototype.fill=function(Q,R,V,ja){if("string"==typeof Q){if("string"==typeof R?(ja=R,R=0,V=this.length):"string"==typeof V&&(ja=V,V=this.length),
void 0!==ja&&"string"!=typeof ja)throw new TypeError("encoding must be a string");if("string"==typeof ja&&!C.isEncoding(ja))throw new TypeError("Unknown encoding: "+ja);if(1===Q.length){var qa=Q.charCodeAt(0);("utf8"===ja&&128>qa||"latin1"===ja)&&(Q=qa)}}else"number"==typeof Q&&(Q&=255);if(0>R||this.length<R||this.length<V)throw new RangeError("Out of range index");if(V<=R)return this;if(R>>>=0,V=void 0===V?this.length:V>>>0,Q||=0,"number"==typeof Q)for(ja=R;ja<V;++ja)this[ja]=Q;else{qa=C.isBuffer(Q)?
Q:C.from(Q,ja);var Ca=qa.length;if(0===Ca)throw new TypeError('The value "'+Q+'" is invalid for argument "value"');for(ja=0;ja<V-R;++ja)this[ja+R]=qa[ja%Ca]}return this};var Vc=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,n("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(n,t,w){(function(z){(function(){w.formatArgs=function(H){if(H[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+H[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),this.useColors){var M=
"color: "+this.color;H.splice(1,0,M,"color: inherit");var L=0,O=0;H[0].replace(/%[a-zA-Z%]/g,S=>{"%%"===S||(L++,"%c"===S&&(O=L))});H.splice(O,0,M)}};w.save=function(H){try{H?w.storage.setItem("debug",H):w.storage.removeItem("debug")}catch(M){}};w.load=function(){let H;try{H=w.storage.getItem("debug")}catch(M){}return!H&&void 0!==z&&"env"in z&&(H=z.env.DEBUG),H};w.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||!("undefined"!=
typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||
"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};a:{try{var C=localStorage;break a}catch(H){}C=void 0}w.storage=C;w.destroy=(()=>{let H=!1;return()=>{H||(H=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();w.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
w.log=console.debug||console.log||(()=>{});t.exports=n("./common")(w);({formatters:C}=t.exports);C.j=function(H){try{return JSON.stringify(H)}catch(M){return"[UnexpectedJSONParseError]: "+M.message}}}).call(this)}).call(this,n("_process"))},{"./common":5,_process:12}],5:[function(n,t){t.exports=function(w){function z(M){function L(...T){if(L.enabled){var P=+new Date;L.diff=P-(O||P);L.prev=O;O=L.curr=P;T[0]=z.coerce(T[0]);"string"!=typeof T[0]&&T.unshift("%O");var W=0;T[0]=T[0].replace(/%([a-zA-Z%])/g,
(Z,ca)=>{if("%%"===Z)return"%";W++;ca=z.formatters[ca];"function"==typeof ca&&(Z=ca.call(L,T[W]),T.splice(W,1),W--);return Z});z.formatArgs.call(L,T);(L.log||z.log).apply(L,T)}}let O,S=null;return L.namespace=M,L.useColors=z.useColors(),L.color=z.selectColor(M),L.extend=C,L.destroy=z.destroy,Object.defineProperty(L,"enabled",{enumerable:!0,configurable:!1,get:()=>null===S?z.enabled(M):S,set:T=>{S=T}}),"function"==typeof z.init&&z.init(L),L}function C(M,L){M=z(this.namespace+(void 0===L?":":L)+M);
return M.log=this.log,M}function H(M){return M.toString().substring(2,M.toString().length-2).replace(/\.\*\?$/,"*")}return z.debug=z,z.default=z,z.coerce=function(M){return M instanceof Error?M.stack||M.message:M},z.disable=function(){const M=[...z.names.map(H),...z.skips.map(H).map(L=>"-"+L)].join();return z.enable(""),M},z.enable=function(M){let L;z.save(M);z.names=[];z.skips=[];const O=("string"==typeof M?M:"").split(/[\s,]+/),S=O.length;for(L=0;L<S;L++)O[L]&&("-"===(M=O[L].replace(/\*/g,".*?"))[0]?
z.skips.push(new RegExp("^"+M.substr(1)+"$")):z.names.push(new RegExp("^"+M+"$")))},z.enabled=function(M){if("*"===M[M.length-1])return!0;let L,O;L=0;for(O=z.skips.length;L<O;L++)if(z.skips[L].test(M))return!1;L=0;for(O=z.names.length;L<O;L++)if(z.names[L].test(M))return!0;return!1},z.humanize=n("ms"),z.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(w).forEach(M=>
{z[M]=w[M]}),z.names=[],z.skips=[],z.formatters={},z.selectColor=function(M){let L=0;for(let O=0;O<M.length;O++)L=(L<<5)-L+M.charCodeAt(O),L|=0;return z.colors[d(L)%z.colors.length]},z.enable(z.load()),z}},{ms:11}],6:[function(n,t){function w(z,C){for(const H in C)Object.defineProperty(z,H,{value:C[H],enumerable:!0,configurable:!0});return z}t.exports=function(z,C,H){if(!z||"string"==typeof z)throw new TypeError("Please pass an Error to err-code");H||={};"object"==typeof C&&(H=C,C="");C&&(H.code=
C);try{return w(z,H)}catch(M){return H.message=z.message,H.stack=z.stack,C=function(){},C.prototype=Object.create(Object.getPrototypeOf(z)),w(new C,H)}}},{}],7:[function(n,t){function w(){w.init.call(this)}function z(ba){if("function"!=typeof ba)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ba);}function C(ba,la,ea,oa){var sa,xa,ya;if(z(ea),void 0===(xa=ba._events)?(xa=ba._events=Object.create(null),ba._eventsCount=0):(void 0!==xa.newListener&&(ba.emit("newListener",
la,ea.listener?ea.listener:ea),xa=ba._events),ya=xa[la]),void 0===ya)xa[la]=ea,++ba._eventsCount;else if("function"==typeof ya?ya=xa[la]=oa?[ea,ya]:[ya,ea]:oa?ya.unshift(ea):ya.push(ea),0<(sa=void 0===ba._maxListeners?w.defaultMaxListeners:ba._maxListeners)&&ya.length>sa&&!ya.warned)ya.warned=!0,ea=Error("Possible EventEmitter memory leak detected. "+ya.length+" "+la+" listeners added. Use emitter.setMaxListeners() to increase limit"),ea.name="MaxListenersExceededWarning",ea.emitter=ba,ea.type=la,
ea.count=ya.length,console&&console.warn&&console.warn(ea);return ba}function H(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function M(ba,la,ea){ba={fired:!1,wrapFn:void 0,target:ba,type:la,listener:ea};la=H.bind(ba);return la.listener=ea,ba.wrapFn=la,la}function L(ba,la,ea){ba=ba._events;if(void 0===ba)return[];la=ba[la];if(void 0===la)ea=[];else if("function"==
typeof la)ea=ea?[la.listener||la]:[la];else if(ea)for(ea=Array(la.length),ba=0;ba<ea.length;++ba)ea[ba]=la[ba].listener||la[ba];else ea=S(la,la.length);return ea}function O(ba){var la=this._events;if(void 0!==la){ba=la[ba];if("function"==typeof ba)return 1;if(void 0!==ba)return ba.length}return 0}function S(ba,la){for(var ea=Array(la),oa=0;oa<la;++oa)ea[oa]=ba[oa];return ea}function T(ba,la,ea,oa){if("function"==typeof ba.on)oa.once?ba.once(la,ea):ba.on(la,ea);else{if("function"!=typeof ba.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+
typeof ba);ba.addEventListener(la,function ya(xa){oa.once&&ba.removeEventListener(la,ya);ea(xa)})}}var P=(n="object"==typeof Reflect?Reflect:null)&&"function"==typeof n.apply?n.apply:function(ba,la,ea){return Function.prototype.apply.call(ba,la,ea)};var W=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(ba){return Object.getOwnPropertyNames(ba).concat(Object.getOwnPropertySymbols(ba))}:function(ba){return Object.getOwnPropertyNames(ba)};var Z=Number.isNaN||function(ba){return ba!=
ba};t.exports=w;t.exports.once=function(ba,la){return new Promise(function(ea,oa){function sa(ya){ba.removeListener(la,xa);oa(ya)}function xa(){"function"==typeof ba.removeListener&&ba.removeListener("error",sa);ea([].slice.call(arguments))}T(ba,la,xa,{once:!0});"error"!==la&&function(ya,Ya,Ja){"function"==typeof ya.on&&T(ya,"error",Ya,Ja)}(ba,sa,{once:!0})})};w.EventEmitter=w;w.prototype._events=void 0;w.prototype._eventsCount=0;w.prototype._maxListeners=void 0;var ca=10;Object.defineProperty(w,
"defaultMaxListeners",{enumerable:!0,get:function(){return ca},set:function(ba){if("number"!=typeof ba||0>ba||Z(ba))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ba+".");ca=ba}});w.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0);this._maxListeners=this._maxListeners||void 0};w.prototype.setMaxListeners=function(ba){if("number"!=
typeof ba||0>ba||Z(ba))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ba+".");return this._maxListeners=ba,this};w.prototype.getMaxListeners=function(){return void 0===this._maxListeners?w.defaultMaxListeners:this._maxListeners};w.prototype.emit=function(ba){for(var la=[],ea=1;ea<arguments.length;ea++)la.push(arguments[ea]);ea="error"===ba;var oa=this._events;if(void 0!==oa)ea=ea&&void 0===oa.error;else if(!ea)return!1;if(ea){var sa;if(0<la.length&&
(sa=la[0]),sa instanceof Error)throw sa;la=Error("Unhandled error."+(sa?" ("+sa.message+")":""));throw la.context=sa,la;}ea=oa[ba];if(void 0===ea)return!1;if("function"==typeof ea)P(ea,this,la);else for(sa=ea.length,oa=S(ea,sa),ea=0;ea<sa;++ea)P(oa[ea],this,la);return!0};w.prototype.addListener=function(ba,la){return C(this,ba,la,!1)};w.prototype.on=w.prototype.addListener;w.prototype.prependListener=function(ba,la){return C(this,ba,la,!0)};w.prototype.once=function(ba,la){return z(la),this.on(ba,
M(this,ba,la)),this};w.prototype.prependOnceListener=function(ba,la){return z(la),this.prependListener(ba,M(this,ba,la)),this};w.prototype.removeListener=function(ba,la){var ea,oa,sa;if((z(la),void 0===(oa=this._events))||void 0===(ea=oa[ba]))return this;if(ea===la||ea.listener===la)0==--this._eventsCount?this._events=Object.create(null):(delete oa[ba],oa.removeListener&&this.emit("removeListener",ba,ea.listener||la));else if("function"!=typeof ea){var xa=-1;for(sa=ea.length-1;0<=sa;sa--)if(ea[sa]===
la||ea[sa].listener===la){var ya=ea[sa].listener;xa=sa;break}if(0>xa)return this;if(0===xa)ea.shift();else{for(;xa+1<ea.length;xa++)ea[xa]=ea[xa+1];ea.pop()}1===ea.length&&(oa[ba]=ea[0]);void 0!==oa.removeListener&&this.emit("removeListener",ba,ya||la)}return this};w.prototype.off=w.prototype.removeListener;w.prototype.removeAllListeners=function(ba){var la,ea;if(void 0===(ea=this._events))return this;if(void 0===ea.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=
0):void 0!==ea[ba]&&(0==--this._eventsCount?this._events=Object.create(null):delete ea[ba]),this;if(0===arguments.length){var oa=Object.keys(ea);for(ea=0;ea<oa.length;++ea)"removeListener"!==(la=oa[ea])&&this.removeAllListeners(la);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(la=ea[ba]))this.removeListener(ba,la);else if(void 0!==la)for(ea=la.length-1;0<=ea;ea--)this.removeListener(ba,la[ea]);return this};w.prototype.listeners=
function(ba){return L(this,ba,!0)};w.prototype.rawListeners=function(ba){return L(this,ba,!1)};w.listenerCount=function(ba,la){return"function"==typeof ba.listenerCount?ba.listenerCount(la):O.call(ba,la)};w.prototype.listenerCount=O;w.prototype.eventNames=function(){return 0<this._eventsCount?W(this._events):[]}},{}],8:[function(n,t){t.exports=function(){if("undefined"==typeof globalThis)return null;var w={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,
RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return w.RTCPeerConnection?w:null}},{}],9:[function(n,t,w){w.read=function(z,C,H,M,L){var O=8*L-M-1;var S=(1<<O)-1,T=S>>1,P=-7;L=H?L-1:0;var W=H?-1:1,Z=z[C+L];L+=W;H=Z&(1<<-P)-1;Z>>=-P;for(P+=O;0<P;H=256*H+z[C+L],L+=W,P-=8);O=H&(1<<-P)-1;H>>=-P;for(P+=M;0<P;O=
256*O+z[C+L],L+=W,P-=8);if(0===H)H=1-T;else{if(H===S)return O?NaN:1/0*(Z?-1:1);O+=e(2,M);H-=T}return(Z?-1:1)*O*e(2,H-M)};w.write=function(z,C,H,M,L,O){var S,T,P,W=Math.LN2,Z=Math.log,ca=8*O-L-1,ba=(1<<ca)-1,la=ba>>1,ea=23===L?e(2,-24)-e(2,-77):0;O=M?0:O-1;M=M?1:-1;var oa=0>C||0===C&&0>1/C?1:0;C=d(C);for(isNaN(C)||C===1/0?(T=isNaN(C)?1:0,S=ba):(S=c(Z(C)/W),1>C*(P=e(2,-S))&&(S--,P*=2),2<=(C+=1<=S+la?ea/P:ea*e(2,1-la))*P&&(S++,P/=2),S+la>=ba?(T=0,S=ba):1<=S+la?(T=(C*P-1)*e(2,L),S+=la):(T=C*e(2,la-1)*
e(2,L),S=0));8<=L;z[H+O]=255&T,O+=M,T/=256,L-=8);S=S<<L|T;for(ca+=L;0<ca;z[H+O]=255&S,O+=M,S/=256,ca-=8);z[H+O-M]|=128*oa}},{}],10:[function(n,t){t.exports="function"==typeof Object.create?function(w,z){z&&(w.super_=z,w.prototype=Object.create(z.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}))}:function(w,z){if(z){w.super_=z;var C=function(){};C.prototype=z.prototype;w.prototype=new C;w.prototype.constructor=w}}},{}],11:[function(n,t){function w(C,H,M,L){return z(C/M)+
" "+L+(H>=1.5*M?"s":"")}var z=Math.round;t.exports=function(C,H){H=H||{};var M=typeof C;if("string"==M&&0<C.length){a:{if(!(100<(C+="").length)&&(H=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(C))){C=parseFloat(H[1]);H=(H[2]||"ms").toLowerCase();C="years"===H||"year"===H||"yrs"===H||"yr"===H||"y"===H?315576E5*C:"weeks"===H||"week"===H||"w"===H?6048E5*C:"days"===H||"day"===H||"d"===H?864E5*C:"hours"===H||"hour"===
H||"hrs"===H||"hr"===H||"h"===H?36E5*C:"minutes"===H||"minute"===H||"mins"===H||"min"===H||"m"===H?6E4*C:"seconds"===H||"second"===H||"secs"===H||"sec"===H||"s"===H?1E3*C:"milliseconds"===H||"millisecond"===H||"msecs"===H||"msec"===H||"ms"===H?C:void 0;break a}C=void 0}return C}if("number"===M&&isFinite(C))return H.long?(H=d(C),C=864E5<=H?w(C,H,864E5,"day"):36E5<=H?w(C,H,36E5,"hour"):6E4<=H?w(C,H,6E4,"minute"):1E3<=H?w(C,H,1E3,"second"):C+" ms"):(H=d(C),C=864E5<=H?z(C/864E5)+"d":36E5<=H?z(C/36E5)+
"h":6E4<=H?z(C/6E4)+"m":1E3<=H?z(C/1E3)+"s":C+"ms"),C;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(C));}},{}],12:[function(n,t){function w(){throw Error("setTimeout has not been defined");}function z(){throw Error("clearTimeout has not been defined");}function C(ba){if(S===setTimeout)return setTimeout(ba,0);if((S===w||!S)&&setTimeout)return S=setTimeout,setTimeout(ba,0);try{return S(ba,0)}catch(la){try{return S.call(null,ba,0)}catch(ea){return S.call(this,ba,
0)}}}function H(){Z&&P&&(Z=!1,P.length?W=P.concat(W):ca=-1,W.length&&M())}function M(){if(!Z){var ba=C(H);Z=!0;for(var la=W.length;la;){P=W;for(W=[];++ca<la;)P&&P[ca].run();ca=-1;la=W.length}P=null;Z=!1;(function(ea){if(T===clearTimeout)return clearTimeout(ea);if((T===z||!T)&&clearTimeout)return T=clearTimeout,clearTimeout(ea);try{T(ea)}catch(oa){try{return T.call(null,ea)}catch(sa){return T.call(this,ea)}}})(ba)}}function L(ba,la){this.fun=ba;this.array=la}function O(){}n=t.exports={};try{var S=
"function"==typeof setTimeout?setTimeout:w}catch(ba){S=w}try{var T="function"==typeof clearTimeout?clearTimeout:z}catch(ba){T=z}!0;var P,W=[],Z=!1,ca=-1;n.nextTick=function(ba){var la=Array(arguments.length-1);if(1<arguments.length)for(var ea=1;ea<arguments.length;ea++)la[ea-1]=arguments[ea];W.push(new L(ba,la));1!==W.length||Z||C(M)};L.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=!0;n.env={};n.argv=[];n.version="";n.versions={};n.on=O;n.addListener=O;n.once=
O;n.off=O;n.removeListener=O;n.removeAllListeners=O;n.emit=O;n.prependListener=O;n.prependOnceListener=O;n.listeners=function(){return[]};n.binding=function(){throw Error("process.binding is not supported");};n.cwd=function(){return"/"};n.chdir=function(){throw Error("process.chdir is not supported");};n.umask=function(){return 0}},{}],13:[function(n,t){(function(w){(function(){let z;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"==typeof window?w:window):C=>(z||=Promise.resolve()).then(C).catch(H=>
setTimeout(()=>{throw H;},0))}).call(this)}).call(this,void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{}],14:[function(n,t){(function(w,z){(function(){var C=n("safe-buffer").Buffer,H=z.crypto||z.msCrypto;t.exports=H&&H.getRandomValues?function(M,L){if(4294967295<M)throw new RangeError("requested too many random bytes");var O=C.allocUnsafe(M);if(0<M)if(65536<M)for(var S=0;S<M;S+=65536)H.getRandomValues(O.slice(S,
S+65536));else H.getRandomValues(O);return"function"==typeof L?w.nextTick(function(){L(null,O)}):O}:function(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11");}}).call(this)}).call(this,n("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{_process:12,"safe-buffer":30}],15:[function(n,t){function w(H,
M,L){L||=Error;var O=function(S){function T(P,W,Z){return S.call(this,"string"==typeof M?M:M(P,W,Z))||this}return function(P,W){P.prototype=Object.create(W.prototype);P.prototype.constructor=P;P.__proto__=W}(T,S),T}(L);O.prototype.name=L.name;O.prototype.code=H;C[H]=O}function z(H,M){if(Array.isArray(H)){var L=H.length;return H=H.map(function(O){return O+""}),2<L?"one of ".concat(M," ").concat(H.slice(0,L-1).join(", "),", or ")+H[L-1]:2===L?"one of ".concat(M," ").concat(H[0]," or ").concat(H[1]):
"of ".concat(M," ").concat(H[0])}return"of ".concat(M," ").concat(H+"")}var C={};w("ERR_INVALID_OPT_VALUE",function(H,M){return'The value "'+M+'" is invalid for option "'+H+'"'},TypeError);w("ERR_INVALID_ARG_TYPE",function(H,M,L){var O;if("string"==typeof M&&function(T,P,W){return T.substr(!W||0>W?0:+W,P.length)===P}(M,"not ")?(O="must not be",M=M.replace(/^not /,"")):O="must be",function(T,P,W){return(void 0===W||W>T.length)&&(W=T.length),T.substring(W-P.length,W)===P}(H," argument"))H="The ".concat(H,
" ").concat(O," ").concat(z(M,"type"));else{var S=function(T,P,W){return"number"!=typeof W&&(W=0),!(W+P.length>T.length)&&-1!==T.indexOf(P,W)}(H,".")?"property":"argument";H='The "'.concat(H,'" ').concat(S," ").concat(O," ").concat(z(M,"type"))}return H+=". Received type ".concat(typeof L)},TypeError);w("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");w("ERR_METHOD_NOT_IMPLEMENTED",function(H){return"The "+H+" method is not implemented"});w("ERR_STREAM_PREMATURE_CLOSE","Premature close");w("ERR_STREAM_DESTROYED",
function(H){return"Cannot call "+H+" after a stream was destroyed"});w("ERR_MULTIPLE_CALLBACK","Callback called multiple times");w("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");w("ERR_STREAM_WRITE_AFTER_END","write after end");w("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);w("ERR_UNKNOWN_ENCODING",function(H){return"Unknown encoding: "+H},TypeError);w("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");t.exports.codes=C},{}],16:[function(n,
t){(function(w){(function(){function z(P){return this instanceof z?(L.call(this,P),O.call(this,P),this.allowHalfOpen=!0,void(P&&(!1===P.readable&&(this.readable=!1),!1===P.writable&&(this.writable=!1),!1===P.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",C))))):new z(P)}function C(){this._writableState.ended||w.nextTick(H,this)}function H(P){P.end()}var M=Object.keys||function(P){var W=[],Z;for(Z in P)W.push(Z);return W};t.exports=z;var L=n("./_stream_readable"),O=n("./_stream_writable");n("inherits")(z,
L);for(var S=M(O.prototype),T=0;T<S.length;T++)M=S[T],z.prototype[M]||(z.prototype[M]=O.prototype[M]);Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});Object.defineProperty(z.prototype,
"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(P){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=P,this._writableState.destroyed=P)}})}).call(this)}).call(this,n("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(n,t){function w(C){return this instanceof w?void z.call(this,
C):new w(C)}t.exports=w;var z=n("./_stream_transform");n("inherits")(w,z);w.prototype._transform=function(C,H,M){M(null,C)}},{"./_stream_transform":19,inherits:10}],18:[function(n,t){(function(w,z){(function(){function C(ia,fa,za){ya=ya||n("./_stream_duplex");ia=ia||{};"boolean"!=typeof za&&(za=fa instanceof ya);this.objectMode=!!ia.objectMode;za&&(this.objectMode=this.objectMode||!!ia.readableObjectMode);this.highWaterMark=Vc(this,ia,"readableHighWaterMark",za);this.buffer=new eb;this.length=0;this.pipes=
null;this.pipesCount=0;this.flowing=null;this.reading=this.endEmitted=this.ended=!1;this.sync=!0;this.resumeScheduled=this.readableListening=this.emittedReadable=this.needReadable=!1;this.paused=!0;this.emitClose=!1!==ia.emitClose;this.autoDestroy=!!ia.autoDestroy;this.destroyed=!1;this.defaultEncoding=ia.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=!1;this.encoding=this.decoder=null;ia.encoding&&(!Nb&&(Nb=n("string_decoder/").StringDecoder),this.decoder=new Nb(ia.encoding),this.encoding=
ia.encoding)}function H(ia){if(ya=ya||n("./_stream_duplex"),!(this instanceof H))return new H(ia);this._readableState=new C(ia,this,this instanceof ya);this.readable=!0;ia&&("function"==typeof ia.read&&(this._read=ia.read),"function"==typeof ia.destroy&&(this._destroy=ia.destroy));Ya.call(this)}function M(ia,fa,za,Ra,Sb){Ma("readableAddChunk",fa);var Na=ia._readableState;if(null===fa)Na.reading=!1,(Ma("onEofChunk"),Na.ended)||(Na.decoder&&(fa=Na.decoder.end())&&fa.length&&(Na.buffer.push(fa),Na.length+=
Na.objectMode?1:fa.length),Na.ended=!0,Na.sync?S(ia):(Na.needReadable=!1,!Na.emittedReadable&&(Na.emittedReadable=!0,T(ia))));else{if(!Sb){Sb=fa;var Lb;var sc=(Ja.isBuffer(Sb)||Sb instanceof ac||"string"==typeof Sb||void 0===Sb||Na.objectMode||(Lb=new R("chunk",["string","Buffer","Uint8Array"],Sb)),Lb)}if(sc)Ca(ia,sc);else if(Na.objectMode||fa&&0<fa.length)if("string"==typeof fa||Na.objectMode||Object.getPrototypeOf(fa)===Ja.prototype||(fa=Ja.from(fa)),Ra)Na.endEmitted?Ca(ia,new qa):L(ia,Na,fa,!0);
else if(Na.ended)Ca(ia,new V);else{if(Na.destroyed)return!1;Na.reading=!1;Na.decoder&&!za?(fa=Na.decoder.write(fa),Na.objectMode||0!==fa.length?L(ia,Na,fa,!1):P(ia,Na)):L(ia,Na,fa,!1)}else Ra||(Na.reading=!1,P(ia,Na))}return!Na.ended&&(Na.length<Na.highWaterMark||0===Na.length)}function L(ia,fa,za,Ra){fa.flowing&&0===fa.length&&!fa.sync?(fa.awaitDrain=0,ia.emit("data",za)):(fa.length+=fa.objectMode?1:za.length,Ra?fa.buffer.unshift(za):fa.buffer.push(za),fa.needReadable&&S(ia));P(ia,fa)}function O(ia,
fa){if(0>=ia||0===fa.length&&fa.ended)ia=0;else if(fa.objectMode)ia=1;else if(ia==ia){if(ia>fa.highWaterMark){var za=ia;var Ra=(1073741824<=za?za=1073741824:(za--,za|=za>>>1,za|=za>>>2,za|=za>>>4,za|=za>>>8,za|=za>>>16,za++),za);fa.highWaterMark=Ra}ia=ia<=fa.length?ia:fa.ended?fa.length:(fa.needReadable=!0,0)}else ia=fa.flowing&&fa.length?fa.buffer.head.data.length:fa.length;return ia}function S(ia){var fa=ia._readableState;Ma("emitReadable",fa.needReadable,fa.emittedReadable);fa.needReadable=!1;
fa.emittedReadable||(Ma("emitReadable",fa.flowing),fa.emittedReadable=!0,w.nextTick(T,ia))}function T(ia){var fa=ia._readableState;Ma("emitReadable_",fa.destroyed,fa.length,fa.ended);!fa.destroyed&&(fa.length||fa.ended)&&(ia.emit("readable"),fa.emittedReadable=!1);fa.needReadable=!fa.flowing&&!fa.ended&&fa.length<=fa.highWaterMark;la(ia)}function P(ia,fa){fa.readingMore||(fa.readingMore=!0,w.nextTick(W,ia,fa))}function W(ia,fa){for(;!fa.reading&&!fa.ended&&(fa.length<fa.highWaterMark||fa.flowing&&
0===fa.length);){var za=fa.length;if(Ma("maybeReadMore read 0"),ia.read(0),za===fa.length)break}fa.readingMore=!1}function Z(ia){var fa=ia._readableState;fa.readableListening=0<ia.listenerCount("readable");fa.resumeScheduled&&!fa.paused?fa.flowing=!0:0<ia.listenerCount("data")&&ia.resume()}function ca(ia){Ma("readable nexttick read 0");ia.read(0)}function ba(ia,fa){Ma("resume",fa.reading);fa.reading||ia.read(0);fa.resumeScheduled=!1;ia.emit("resume");la(ia);fa.flowing&&!fa.reading&&ia.read(0)}function la(ia){var fa=
ia._readableState;for(Ma("flow",fa.flowing);fa.flowing&&null!==ia.read(););}function ea(ia,fa){return 0===fa.length?null:(fa.objectMode?za=fa.buffer.shift():!ia||ia>=fa.length?(za=fa.decoder?fa.buffer.join(""):1===fa.buffer.length?fa.buffer.first():fa.buffer.concat(fa.length),fa.buffer.clear()):za=fa.buffer.consume(ia,fa.decoder),za);var za}function oa(ia){var fa=ia._readableState;Ma("endReadable",fa.endEmitted);fa.endEmitted||(fa.ended=!0,w.nextTick(sa,fa,ia))}function sa(ia,fa){if(Ma("endReadableNT",
ia.endEmitted,ia.length),!ia.endEmitted&&0===ia.length&&(ia.endEmitted=!0,fa.readable=!1,fa.emit("end"),ia.autoDestroy))ia=fa._writableState,(!ia||ia.autoDestroy&&ia.finished)&&fa.destroy()}function xa(ia,fa){for(var za=0,Ra=ia.length;za<Ra;za++)if(ia[za]===fa)return za;return-1}var ya;t.exports=H;H.ReadableState=C;n("events").EventEmitter;var Ya=n("./internal/streams/stream"),Ja=n("buffer").Buffer,ac=z.Uint8Array||function(){},Ia=n("util");var Ma=Ia&&Ia.debuglog?Ia.debuglog("stream"):function(){};
var Nb,Qb,dd,eb=n("./internal/streams/buffer_list");Ia=n("./internal/streams/destroy");var Vc=n("./internal/streams/state").getHighWaterMark,Q=n("../errors").codes,R=Q.ERR_INVALID_ARG_TYPE,V=Q.ERR_STREAM_PUSH_AFTER_EOF,ja=Q.ERR_METHOD_NOT_IMPLEMENTED,qa=Q.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n("inherits")(H,Ya);var Ca=Ia.errorOrDestroy,Aa=["error","close","destroy","pause","resume"];Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},
set:function(ia){this._readableState&&(this._readableState.destroyed=ia)}});H.prototype.destroy=Ia.destroy;H.prototype._undestroy=Ia.undestroy;H.prototype._destroy=function(ia,fa){fa(ia)};H.prototype.push=function(ia,fa){var za,Ra=this._readableState;return Ra.objectMode?za=!0:"string"==typeof ia&&((fa=fa||Ra.defaultEncoding)!==Ra.encoding&&(ia=Ja.from(ia,fa),fa=""),za=!0),M(this,ia,fa,!1,za)};H.prototype.unshift=function(ia){return M(this,ia,null,!0,!1)};H.prototype.isPaused=function(){return!1===
this._readableState.flowing};H.prototype.setEncoding=function(ia){Nb||=n("string_decoder/").StringDecoder;ia=new Nb(ia);this._readableState.decoder=ia;this._readableState.encoding=this._readableState.decoder.encoding;for(var fa=this._readableState.buffer.head,za="";null!==fa;)za+=ia.write(fa.data),fa=fa.next;return this._readableState.buffer.clear(),""!==za&&this._readableState.buffer.push(za),this._readableState.length=za.length,this};H.prototype.read=function(ia){Ma("read",ia);ia=parseInt(ia,10);
var fa=this._readableState,za=ia;if(0!==ia&&(fa.emittedReadable=!1),0===ia&&fa.needReadable&&((0===fa.highWaterMark?0<fa.length:fa.length>=fa.highWaterMark)||fa.ended))return Ma("read: emitReadable",fa.length,fa.ended),0===fa.length&&fa.ended?oa(this):S(this),null;if(0===(ia=O(ia,fa))&&fa.ended)return 0===fa.length&&oa(this),null;var Ra,Sb=fa.needReadable;return Ma("need readable",Sb),(0===fa.length||fa.length-ia<fa.highWaterMark)&&Ma("length less than watermark",Sb=!0),fa.ended||fa.reading?Ma("reading or ended",
!1):Sb&&(Ma("do read"),fa.reading=!0,fa.sync=!0,0===fa.length&&(fa.needReadable=!0),this._read(fa.highWaterMark),fa.sync=!1,!fa.reading&&(ia=O(za,fa))),null===(Ra=0<ia?ea(ia,fa):null)?(fa.needReadable=fa.length<=fa.highWaterMark,ia=0):(fa.length-=ia,fa.awaitDrain=0),0===fa.length&&(!fa.ended&&(fa.needReadable=!0),za!==ia&&fa.ended&&oa(this)),null!==Ra&&this.emit("data",Ra),Ra};H.prototype._read=function(){Ca(this,new ja("_read()"))};H.prototype.pipe=function(ia,fa){function za(bc,xc){Ma("onunpipe");
bc===bb&&xc&&!1===xc.hasUnpiped&&(xc.hasUnpiped=!0,Ma("cleanup"),ia.removeListener("close",Lb),ia.removeListener("finish",sc),ia.removeListener("drain",ff),ia.removeListener("error",Na),ia.removeListener("unpipe",za),bb.removeListener("end",Ra),bb.removeListener("end",ef),bb.removeListener("data",Sb),oh=!0,wc.awaitDrain&&(!ia._writableState||ia._writableState.needDrain)&&ff())}function Ra(){Ma("onend");ia.end()}function Sb(bc){Ma("ondata");bc=ia.write(bc);Ma("dest.write",bc);!1===bc&&((1===wc.pipesCount&&
wc.pipes===ia||1<wc.pipesCount&&-1!==xa(wc.pipes,ia))&&!oh&&(Ma("false write response, pause",wc.awaitDrain),wc.awaitDrain++),bb.pause())}function Na(bc){Ma("onerror",bc);ef();ia.removeListener("error",Na);0===ia.listeners("error").length&&Ca(ia,bc)}function Lb(){ia.removeListener("finish",sc);ef()}function sc(){Ma("onfinish");ia.removeListener("close",Lb);ef()}function ef(){Ma("unpipe");bb.unpipe(ia)}var bb=this,wc=this._readableState;switch(wc.pipesCount){case 0:wc.pipes=ia;break;case 1:wc.pipes=
[wc.pipes,ia];break;default:wc.pipes.push(ia)}wc.pipesCount+=1;Ma("pipe count=%d opts=%j",wc.pipesCount,fa);fa=fa&&!1===fa.end||ia===w.stdout||ia===w.stderr?ef:Ra;wc.endEmitted?w.nextTick(fa):bb.once("end",fa);ia.on("unpipe",za);var ff=function(bc){return function(){var xc=bc._readableState;Ma("pipeOnDrain",xc.awaitDrain);xc.awaitDrain&&xc.awaitDrain--;0===xc.awaitDrain&&bc.listeners("data").length&&(xc.flowing=!0,la(bc))}}(bb);ia.on("drain",ff);var oh=!1;return bb.on("data",Sb),function(bc,xc,ie){"function"==
typeof bc.prependListener?bc.prependListener(xc,ie):bc._events&&bc._events[xc]?Array.isArray(bc._events[xc])?bc._events[xc].unshift(ie):bc._events[xc]=[ie,bc._events[xc]]:bc.on(xc,ie)}(ia,"error",Na),ia.once("close",Lb),ia.once("finish",sc),ia.emit("pipe",bb),wc.flowing||(Ma("pipe resume"),bb.resume()),ia};H.prototype.unpipe=function(ia){var fa=this._readableState,za={hasUnpiped:!1};if(0===fa.pipesCount)return this;if(1===fa.pipesCount)return ia&&ia!==fa.pipes||(ia||=fa.pipes,fa.pipes=null,fa.pipesCount=
0,fa.flowing=!1,ia&&ia.emit("unpipe",this,za)),this;if(!ia){ia=fa.pipes;za=fa.pipesCount;fa.pipes=null;fa.pipesCount=0;fa.flowing=!1;for(fa=0;fa<za;fa++)ia[fa].emit("unpipe",this,{hasUnpiped:!1});return this}var Ra=xa(fa.pipes,ia);return-1===Ra||(fa.pipes.splice(Ra,1),--fa.pipesCount,1===fa.pipesCount&&(fa.pipes=fa.pipes[0]),ia.emit("unpipe",this,za)),this};H.prototype.on=function(ia,fa){fa=Ya.prototype.on.call(this,ia,fa);var za=this._readableState;return"data"===ia?(za.readableListening=0<this.listenerCount("readable"),
!1!==za.flowing&&this.resume()):"readable"==ia&&!za.endEmitted&&!za.readableListening&&(za.readableListening=za.needReadable=!0,za.flowing=!1,za.emittedReadable=!1,Ma("on readable",za.length,za.reading),za.length?S(this):!za.reading&&w.nextTick(ca,this)),fa};H.prototype.addListener=H.prototype.on;H.prototype.removeListener=function(ia,fa){fa=Ya.prototype.removeListener.call(this,ia,fa);return"readable"===ia&&w.nextTick(Z,this),fa};H.prototype.removeAllListeners=function(ia){var fa=Ya.prototype.removeAllListeners.apply(this,
arguments);return("readable"===ia||void 0===ia)&&w.nextTick(Z,this),fa};H.prototype.resume=function(){var ia=this._readableState;ia.flowing||(Ma("resume"),ia.flowing=!ia.readableListening,ia.resumeScheduled||(ia.resumeScheduled=!0,w.nextTick(ba,this,ia)));return ia.paused=!1,this};H.prototype.pause=function(){return Ma("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Ma("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,
this};H.prototype.wrap=function(ia){var fa=this,za=this._readableState,Ra=!1,Sb;for(Sb in ia.on("end",function(){if(Ma("wrapped end"),za.decoder&&!za.ended){var Na=za.decoder.end();Na&&Na.length&&fa.push(Na)}fa.push(null)}),ia.on("data",function(Na){Ma("wrapped data");za.decoder&&(Na=za.decoder.write(Na));za.objectMode&&null==Na||!(za.objectMode||Na&&Na.length)||fa.push(Na)||(Ra=!0,ia.pause())}),ia)void 0===this[Sb]&&"function"==typeof ia[Sb]&&(this[Sb]=function(Na){return function(){return ia[Na].apply(ia,
arguments)}}(Sb));for(Sb=0;Sb<Aa.length;Sb++)ia.on(Aa[Sb],this.emit.bind(this,Aa[Sb]));return this._read=function(Na){Ma("wrapped _read",Na);Ra&&(Ra=!1,ia.resume())},this};"function"==typeof Symbol&&(H.prototype[Symbol.asyncIterator]=function(){return void 0===Qb&&(Qb=n("./internal/streams/async_iterator")),Qb(this)});Object.defineProperty(H.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(H.prototype,"readableBuffer",
{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(H.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ia){this._readableState&&(this._readableState.flowing=ia)}});H._fromList=ea;Object.defineProperty(H.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});"function"==typeof Symbol&&(H.from=function(ia,fa){return void 0===dd&&(dd=n("./internal/streams/from")),
dd(H,ia,fa)})}).call(this)}).call(this,n("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,
util:2}],19:[function(n,t){function w(P,W){var Z=this._transformState;Z.transforming=!1;var ca=Z.writecb;if(null===ca)return this.emit("error",new L);Z.writechunk=null;Z.writecb=null;null!=W&&this.push(W);ca(P);P=this._readableState;P.reading=!1;(P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark)}function z(P){return this instanceof z?(T.call(this,P),this._transformState={afterTransform:w.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},
this._readableState.needReadable=!0,this._readableState.sync=!1,P&&("function"==typeof P.transform&&(this._transform=P.transform),"function"==typeof P.flush&&(this._flush=P.flush)),void this.on("prefinish",C)):new z(P)}function C(){var P=this;"function"!=typeof this._flush||this._readableState.destroyed?H(this,null,null):this._flush(function(W,Z){H(P,W,Z)})}function H(P,W,Z){if(W)return P.emit("error",W);if(null!=Z&&P.push(Z),P._writableState.length)throw new S;if(P._transformState.transforming)throw new O;
return P.push(null)}t.exports=z;t=n("../errors").codes;var M=t.ERR_METHOD_NOT_IMPLEMENTED,L=t.ERR_MULTIPLE_CALLBACK,O=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,S=t.ERR_TRANSFORM_WITH_LENGTH_0,T=n("./_stream_duplex");n("inherits")(z,T);z.prototype.push=function(P,W){return this._transformState.needTransform=!1,T.prototype.push.call(this,P,W)};z.prototype._transform=function(P,W,Z){Z(new M("_transform()"))};z.prototype._write=function(P,W,Z){var ca=this._transformState;(ca.writecb=Z,ca.writechunk=P,ca.writeencoding=
W,ca.transforming)||(P=this._readableState,(ca.needTransform||P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark))};z.prototype._read=function(){var P=this._transformState;null===P.writechunk||P.transforming?P.needTransform=!0:(P.transforming=!0,this._transform(P.writechunk,P.writeencoding,P.afterTransform))};z.prototype._destroy=function(P,W){T.prototype._destroy.call(this,P,function(Z){W(Z)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(n,t){(function(w,
z){(function(){function C(R){var V=this;this.entry=this.next=null;this.finish=function(){var ja=V.entry;for(V.entry=null;ja;){var qa=ja.callback;R.pendingcb--;qa(void 0);ja=ja.next}R.corkedRequestsFree.next=V;!0}}function H(){}function M(R,V,ja){ba=ba||n("./_stream_duplex");R=R||{};"boolean"!=typeof ja&&(ja=V instanceof ba);this.objectMode=!!R.objectMode;ja&&(this.objectMode=this.objectMode||!!R.writableObjectMode);this.highWaterMark=Ya(this,R,"writableHighWaterMark",ja);this.destroyed=this.finished=
this.ended=this.ending=this.needDrain=this.finalCalled=!1;this.decodeStrings=!1!==R.decodeStrings;this.defaultEncoding=R.defaultEncoding||"utf8";this.length=0;this.writing=!1;this.corked=0;this.sync=!0;this.bufferProcessing=!1;this.onwrite=function(qa){S(V,qa)};this.writecb=null;this.writelen=0;this.lastBufferedRequest=this.bufferedRequest=null;this.pendingcb=0;this.errorEmitted=this.prefinished=!1;this.emitClose=!1!==R.emitClose;this.autoDestroy=!!R.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=
new C(this)}function L(R){var V=this instanceof(ba=ba||n("./_stream_duplex"));return V||la.call(L,this)?(this._writableState=new M(R,this,V),this.writable=!0,R&&("function"==typeof R.write&&(this._write=R.write),"function"==typeof R.writev&&(this._writev=R.writev),"function"==typeof R.destroy&&(this._destroy=R.destroy),"function"==typeof R.final&&(this._final=R.final)),void oa.call(this)):new L(R)}function O(R,V,ja,qa,Ca,Aa,ia){V.writelen=qa;V.writecb=ia;V.writing=!0;V.sync=!0;V.destroyed?V.onwrite(new Qb("write")):
ja?R._writev(Ca,V.onwrite):R._write(Ca,Aa,V.onwrite);V.sync=!1}function S(R,V){var ja=R._writableState,qa=ja.sync,Ca=ja.writecb;if("function"!=typeof Ca)throw new Ma;(function(Aa){Aa.writing=!1;Aa.writecb=null;Aa.length-=Aa.writelen;Aa.writelen=0}(ja),V)?!function(Aa,ia,fa,za,Ra){--ia.pendingcb;fa?(w.nextTick(Ra,za),w.nextTick(ca,Aa,ia),Aa._writableState.errorEmitted=!0,Q(Aa,za)):(Ra(za),Aa._writableState.errorEmitted=!0,Q(Aa,za),ca(Aa,ia))}(R,ja,qa,V,Ca):((V=W(ja)||R.destroyed)||ja.corked||ja.bufferProcessing||
!ja.bufferedRequest||P(R,ja),qa?w.nextTick(T,R,ja,V,Ca):T(R,ja,V,Ca))}function T(R,V,ja,qa){ja||0===V.length&&V.needDrain&&(V.needDrain=!1,R.emit("drain"));V.pendingcb--;qa();ca(R,V)}function P(R,V){V.bufferProcessing=!0;var ja=V.bufferedRequest;if(R._writev&&ja&&ja.next){var qa=Array(V.bufferedRequestCount),Ca=V.corkedRequestsFree;Ca.entry=ja;for(var Aa=0,ia=!0;ja;)qa[Aa]=ja,ja.isBuf||(ia=!1),ja=ja.next,Aa+=1;qa.allBuffers=ia;O(R,V,!0,V.length,qa,"",Ca.finish);V.pendingcb++;V.lastBufferedRequest=
null;Ca.next?(V.corkedRequestsFree=Ca.next,Ca.next=null):V.corkedRequestsFree=new C(V);V.bufferedRequestCount=0}else{for(;ja&&(qa=ja.chunk,O(R,V,!1,V.objectMode?1:qa.length,qa,ja.encoding,ja.callback),ja=ja.next,V.bufferedRequestCount--,!V.writing););null===ja&&(V.lastBufferedRequest=null)}V.bufferedRequest=ja;V.bufferProcessing=!1}function W(R){return R.ending&&0===R.length&&null===R.bufferedRequest&&!R.finished&&!R.writing}function Z(R,V){R._final(function(ja){V.pendingcb--;ja&&Q(R,ja);V.prefinished=
!0;R.emit("prefinish");ca(R,V)})}function ca(R,V){var ja=W(V),qa;if(qa=ja)V.prefinished||V.finalCalled||("function"!=typeof R._final||V.destroyed?(V.prefinished=!0,R.emit("prefinish")):(V.pendingcb++,V.finalCalled=!0,w.nextTick(Z,R,V))),qa=0===V.pendingcb&&(V.finished=!0,R.emit("finish"),V.autoDestroy);qa&&(V=R._readableState,(!V||V.autoDestroy&&V.endEmitted)&&R.destroy());return ja}var ba;t.exports=L;L.WritableState=M;var la,ea={deprecate:n("util-deprecate")},oa=n("./internal/streams/stream"),sa=
n("buffer").Buffer,xa=z.Uint8Array||function(){},ya=n("./internal/streams/destroy"),Ya=n("./internal/streams/state").getHighWaterMark,Ja=n("../errors").codes,ac=Ja.ERR_INVALID_ARG_TYPE,Ia=Ja.ERR_METHOD_NOT_IMPLEMENTED,Ma=Ja.ERR_MULTIPLE_CALLBACK,Nb=Ja.ERR_STREAM_CANNOT_PIPE,Qb=Ja.ERR_STREAM_DESTROYED,dd=Ja.ERR_STREAM_NULL_VALUES,eb=Ja.ERR_STREAM_WRITE_AFTER_END,Vc=Ja.ERR_UNKNOWN_ENCODING,Q=ya.errorOrDestroy;n("inherits")(L,oa);M.prototype.getBuffer=function(){for(var R=this.bufferedRequest,V=[];R;)V.push(R),
R=R.next;return V};(function(){try{Object.defineProperty(M.prototype,"buffer",{get:ea.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(R){}})();"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(la=Function.prototype[Symbol.hasInstance],Object.defineProperty(L,Symbol.hasInstance,{value:function(R){return!!la.call(this,R)||this===L&&R&&R._writableState instanceof
M}})):la=function(R){return R instanceof this};L.prototype.pipe=function(){Q(this,new Nb)};L.prototype.write=function(R,V,ja){var qa=this._writableState,Ca=!1,Aa;if(Aa=!qa.objectMode)Aa=R,Aa=sa.isBuffer(Aa)||Aa instanceof xa;Aa&&!sa.isBuffer(R)&&(R=sa.from(R));"function"==typeof V&&(ja=V,V=null);Aa?V="buffer":!V&&(V=qa.defaultEncoding);"function"!=typeof ja&&(ja=H);if(qa.ending)qa=ja,ja=new eb,Q(this,ja),w.nextTick(qa,ja);else{var ia;if(!(ia=Aa)){var fa=R,za=ja,Ra;ia=(null===fa?Ra=new dd:"string"!=
typeof fa&&!qa.objectMode&&(Ra=new ac("chunk",["string","Buffer"],fa)),!Ra||(Q(this,Ra),w.nextTick(za,Ra),!1))}ia&&(qa.pendingcb++,Ca=Aa,Ca||(Aa=R,Ra=(qa.objectMode||!1===qa.decodeStrings||"string"!=typeof Aa||(Aa=sa.from(Aa,V)),Aa),R!==Ra&&(Ca=!0,V="buffer",R=Ra)),Aa=qa.objectMode?1:R.length,qa.length+=Aa,Ra=qa.length<qa.highWaterMark,(Ra||(qa.needDrain=!0),qa.writing||qa.corked)?(Aa=qa.lastBufferedRequest,qa.lastBufferedRequest={chunk:R,encoding:V,isBuf:Ca,callback:ja,next:null},Aa?Aa.next=qa.lastBufferedRequest:
qa.bufferedRequest=qa.lastBufferedRequest,qa.bufferedRequestCount+=1):O(this,qa,!1,Aa,R,V,ja),Ca=Ra)}return Ca};L.prototype.cork=function(){this._writableState.corked++};L.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,!R.writing&&!R.corked&&!R.bufferProcessing&&R.bufferedRequest&&P(this,R))};L.prototype.setDefaultEncoding=function(R){if("string"==typeof R&&(R=R.toLowerCase()),!(-1<"hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw".split(" ").indexOf((R+
"").toLowerCase())))throw new Vc(R);return this._writableState.defaultEncoding=R,this};Object.defineProperty(L.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(L.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});L.prototype._write=function(R,V,ja){ja(new Ia("_write()"))};L.prototype._writev=null;L.prototype.end=function(R,V,ja){var qa=this._writableState;
"function"==typeof R?(ja=R,R=null,V=null):"function"==typeof V&&(ja=V,V=null);null!=R&&this.write(R,V);qa.corked&&(qa.corked=1,this.uncork());qa.ending||(R=ja,qa.ending=!0,ca(this,qa),R&&(qa.finished?w.nextTick(R):this.once("finish",R)),qa.ended=!0,this.writable=!1);return this};Object.defineProperty(L.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});Object.defineProperty(L.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&
this._writableState.destroyed},set:function(R){this._writableState&&(this._writableState.destroyed=R)}});L.prototype.destroy=ya.destroy;L.prototype._undestroy=ya.undestroy;L.prototype._destroy=function(R,V){V(R)}}).call(this)}).call(this,n("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,
"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(n,t){(function(w){(function(){function z(oa,sa,xa){return sa in oa?Object.defineProperty(oa,sa,{value:xa,enumerable:!0,configurable:!0,writable:!0}):oa[sa]=xa,oa}function C(oa,sa){return{value:oa,done:sa}}function H(oa){var sa=oa[S];if(null!==sa){var xa=oa[ba].read();null!==xa&&(oa[Z]=null,oa[S]=null,oa[T]=null,sa(C(xa,!1)))}}function M(oa){w.nextTick(H,oa)}var L,O=n("./end-of-stream"),S=Symbol("lastResolve"),
T=Symbol("lastReject"),P=Symbol("error"),W=Symbol("ended"),Z=Symbol("lastPromise"),ca=Symbol("handlePromise"),ba=Symbol("stream"),la=Object.getPrototypeOf(function(){}),ea=Object.setPrototypeOf((L={get stream(){return this[ba]},next:function(){var oa=this,sa=this[P];if(null!==sa)return Promise.reject(sa);if(this[W])return Promise.resolve(C(void 0,!0));if(this[ba].destroyed)return new Promise(function(xa,ya){w.nextTick(function(){oa[P]?ya(oa[P]):xa(C(void 0,!0))})});if(sa=this[Z])sa=new Promise(function(xa,
ya){return function(Ya,Ja){xa.then(function(){return ya[W]?void Ya(C(void 0,!0)):void ya[ca](Ya,Ja)},Ja)}}(sa,this));else{sa=this[ba].read();if(null!==sa)return Promise.resolve(C(sa,!1));sa=new Promise(this[ca])}return this[Z]=sa,sa}},z(L,Symbol.asyncIterator,function(){return this}),z(L,"return",function(){var oa=this;return new Promise(function(sa,xa){oa[ba].destroy(null,function(ya){return ya?void xa(ya):void sa(C(void 0,!0))})})}),L),la);t.exports=function(oa){var sa,xa=Object.create(ea,(z(sa=
{},ba,{value:oa,writable:!0}),z(sa,S,{value:null,writable:!0}),z(sa,T,{value:null,writable:!0}),z(sa,P,{value:null,writable:!0}),z(sa,W,{value:oa._readableState.endEmitted,writable:!0}),z(sa,ca,{value:function(ya,Ya){var Ja=xa[ba].read();Ja?(xa[Z]=null,xa[S]=null,xa[T]=null,ya(C(Ja,!1))):(xa[S]=ya,xa[T]=Ya)},writable:!0}),sa));return xa[Z]=null,O(oa,function(ya){if(ya&&"ERR_STREAM_PREMATURE_CLOSE"!==ya.code){var Ya=xa[T];return null!==Ya&&(xa[Z]=null,xa[S]=null,xa[T]=null,Ya(ya)),void(xa[P]=ya)}ya=
xa[S];null!==ya&&(xa[Z]=null,xa[S]=null,xa[T]=null,ya(C(void 0,!0)));xa[W]=!0}),oa.on("readable",M.bind(null,xa)),xa}}).call(this)}).call(this,n("_process"))},{"./end-of-stream":24,_process:12}],22:[function(n,t){function w(L,O){var S=Object.keys(L);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(L);O&&(T=T.filter(function(P){return Object.getOwnPropertyDescriptor(L,P).enumerable}));S.push.apply(S,T)}return S}function z(L,O){for(var S,T=0;T<O.length;T++)(S=O[T]).enumerable=S.enumerable||
!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(L,S.key,S)}var C=n("buffer").Buffer,H=n("util").inspect,M=H&&H.custom||"inspect";t.exports=function(){function L(){if(!(this instanceof L))throw new TypeError("Cannot call a class as a function");this.tail=this.head=null;this.length=0}return function(O,S,T){S&&z(O.prototype,S);T&&z(O,T)}(L,[{key:"push",value:function(O){O={data:O,next:null};0<this.length?this.tail.next=O:this.head=O;this.tail=O;++this.length}},{key:"unshift",
value:function(O){O={data:O,next:this.head};0===this.length&&(this.tail=O);this.head=O;++this.length}},{key:"shift",value:function(){if(0!==this.length){var O=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,O}}},{key:"clear",value:function(){this.head=this.tail=null;this.length=0}},{key:"join",value:function(O){if(0===this.length)return"";for(var S=this.head,T=""+S.data;S=S.next;)T+=O+S.data;return T}},{key:"concat",value:function(O){if(0===this.length)return C.alloc(0);
O=C.allocUnsafe(O>>>0);for(var S=this.head,T=0;S;)C.prototype.copy.call(S.data,O,T),T+=S.data.length,S=S.next;return O}},{key:"consume",value:function(O,S){var T;return O<this.head.data.length?(T=this.head.data.slice(0,O),this.head.data=this.head.data.slice(O)):T=O===this.head.data.length?this.shift():S?this._getString(O):this._getBuffer(O),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(O){var S=this.head,T=1,P=S.data;for(O-=P.length;S=S.next;){var W=S.data,
Z=O>W.length?W.length:O;if(P+=Z===W.length?W:W.slice(0,O),0==(O-=Z)){Z===W.length?(++T,this.head=S.next?S.next:this.tail=null):(this.head=S,S.data=W.slice(Z));break}++T}return this.length-=T,P}},{key:"_getBuffer",value:function(O){var S=C.allocUnsafe(O),T=this.head,P=1;T.data.copy(S);for(O-=T.data.length;T=T.next;){var W=T.data,Z=O>W.length?W.length:O;if(W.copy(S,S.length-O,0,Z),0==(O-=Z)){Z===W.length?(++P,this.head=T.next?T.next:this.tail=null):(this.head=T,T.data=W.slice(Z));break}++P}return this.length-=
P,S}},{key:M,value:function(O,S){return H(this,function(T){for(var P,W=1;W<arguments.length;W++)P=null==arguments[W]?{}:arguments[W],W%2?w(Object(P),!0).forEach(function(Z){var ca=P[Z];Z in T?Object.defineProperty(T,Z,{value:ca,enumerable:!0,configurable:!0,writable:!0}):T[Z]=ca}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(P)):w(Object(P)).forEach(function(Z){Object.defineProperty(T,Z,Object.getOwnPropertyDescriptor(P,Z))});return T}({},S,{depth:0,
customInspect:!1}))}}]),L}()},{buffer:3,util:2}],23:[function(n,t){(function(w){(function(){function z(M,L){H(M,L);C(M)}function C(M){M._writableState&&!M._writableState.emitClose||M._readableState&&!M._readableState.emitClose||M.emit("close")}function H(M,L){M.emit("error",L)}t.exports={destroy:function(M,L){var O=this,S=this._writableState&&this._writableState.destroyed;return this._readableState&&this._readableState.destroyed||S?(L?L(M):M&&(this._writableState?!this._writableState.errorEmitted&&
(this._writableState.errorEmitted=!0,w.nextTick(H,this,M)):w.nextTick(H,this,M)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(M||null,function(T){!L&&T?O._writableState?O._writableState.errorEmitted?w.nextTick(C,O):(O._writableState.errorEmitted=!0,w.nextTick(z,O,T)):w.nextTick(z,O,T):L?(w.nextTick(C,O),L(T)):w.nextTick(C,O)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=
!1,this._readableState.ended=!1,this._readableState.endEmitted=!1);this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(M,L){var O=M._readableState,S=M._writableState;O&&O.autoDestroy||S&&S.autoDestroy?M.destroy(L):M.emit("error",L)}}}).call(this)}).call(this,n("_process"))},
{_process:12}],24:[function(n,t){function w(){}var z=n("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;t.exports=function O(H,M,L){if("function"==typeof M)return O(H,null,M);M||={};L=function(sa){var xa=!1;return function(){if(!xa){xa=!0;for(var ya=arguments.length,Ya=Array(ya),Ja=0;Ja<ya;Ja++)Ya[Ja]=arguments[Ja];sa.apply(this,Ya)}}}(L||w);var S=M.readable||!1!==M.readable&&H.readable,T=M.writable||!1!==M.writable&&H.writable,P=function(){H.writable||Z()},W=H._writableState&&H._writableState.finished,
Z=function(){T=!1;W=!0;S||L.call(H)},ca=H._readableState&&H._readableState.endEmitted,ba=function(){S=!1;ca=!0;T||L.call(H)},la=function(sa){L.call(H,sa)},ea=function(){var sa;return S&&!ca?(H._readableState&&H._readableState.ended||(sa=new z),L.call(H,sa)):T&&!W?(H._writableState&&H._writableState.ended||(sa=new z),L.call(H,sa)):void 0},oa=function(){H.req.on("finish",Z)};return H.setHeader&&"function"==typeof H.abort?(H.on("complete",Z),H.on("abort",ea),H.req?oa():H.on("request",oa)):T&&!H._writableState&&
(H.on("end",P),H.on("close",P)),H.on("end",ba),H.on("finish",Z),!1!==M.error&&H.on("error",la),H.on("close",ea),function(){H.removeListener("complete",Z);H.removeListener("abort",ea);H.removeListener("request",oa);H.req&&H.req.removeListener("finish",Z);H.removeListener("end",P);H.removeListener("close",P);H.removeListener("finish",Z);H.removeListener("end",ba);H.removeListener("error",la);H.removeListener("close",ea)}}},{"../../../errors":15}],25:[function(n,t){t.exports=function(){throw Error("Readable.from is not available in the browser");
}},{}],26:[function(n,t){function w(T){if(T)throw T;}function z(T,P,W,Z){Z=function(la){var ea=!1;return function(){ea||(ea=!0,la.apply(void 0,arguments))}}(Z);var ca=!1;T.on("close",function(){ca=!0});void 0===M&&(M=n("./end-of-stream"));M(T,{readable:P,writable:W},function(la){return la?Z(la):(ca=!0,void Z())});var ba=!1;return function(la){if(!ca)return ba?void 0:(ba=!0,T.setHeader&&"function"==typeof T.abort?T.abort():"function"==typeof T.destroy?T.destroy():void Z(la||new S("pipe")))}}function C(T){T()}
function H(T,P){return T.pipe(P)}var M,L=n("../../../errors").codes,O=L.ERR_MISSING_ARGS,S=L.ERR_STREAM_DESTROYED;t.exports=function(){for(var T=arguments.length,P=Array(T),W=0;W<T;W++)P[W]=arguments[W];var Z=P.length&&"function"==typeof P[P.length-1]?P.pop():w;if(Array.isArray(P[0])&&(P=P[0]),2>P.length)throw new O("streams");var ca,ba=P.map(function(la,ea){var oa=ea<P.length-1;return z(la,oa,0<ea,function(sa){ca||=sa;sa&&ba.forEach(C);oa||(ba.forEach(C),Z(ca))})});return P.reduce(H)}},{"../../../errors":15,
"./end-of-stream":24}],27:[function(n,t){var w=n("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(z,C,H,M){C=null==C.highWaterMark?M?C[H]:null:C.highWaterMark;if(null!=C){if(!isFinite(C)||c(C)!==C||0>C)throw new w(M?H:"highWaterMark",C);return c(C)}return z.objectMode?16:16384}}},{"../../../errors":15}],28:[function(n,t){t.exports=n("events").EventEmitter},{events:7}],29:[function(n,t,w){(w=t.exports=n("./lib/_stream_readable.js")).Stream=w;w.Readable=w;w.Writable=
n("./lib/_stream_writable.js");w.Duplex=n("./lib/_stream_duplex.js");w.Transform=n("./lib/_stream_transform.js");w.PassThrough=n("./lib/_stream_passthrough.js");w.finished=n("./lib/internal/streams/end-of-stream.js");w.pipeline=n("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],
30:[function(n,t,w){function z(L,O){for(var S in L)O[S]=L[S]}function C(L,O,S){return M(L,O,S)}var H=n("buffer"),M=H.Buffer;M.from&&M.alloc&&M.allocUnsafe&&M.allocUnsafeSlow?t.exports=H:(z(H,w),w.Buffer=C);C.prototype=Object.create(M.prototype);z(M,C);C.from=function(L,O,S){if("number"==typeof L)throw new TypeError("Argument must not be a number");return M(L,O,S)};C.alloc=function(L,O,S){if("number"!=typeof L)throw new TypeError("Argument must be a number");L=M(L);return void 0===O?L.fill(0):"string"==
typeof S?L.fill(O,S):L.fill(O),L};C.allocUnsafe=function(L){if("number"!=typeof L)throw new TypeError("Argument must be a number");return M(L)};C.allocUnsafeSlow=function(L){if("number"!=typeof L)throw new TypeError("Argument must be a number");return H.SlowBuffer(L)}},{buffer:3}],31:[function(n,t,w){function z(ca){switch(this.encoding=function(ba){var la=function(ea){if(!ea)return"utf8";for(var oa;;)switch(ea){case "utf8":case "utf-8":return"utf8";case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return"utf16le";
case "latin1":case "binary":return"latin1";case "base64":case "ascii":case "hex":return ea;default:if(oa)return;ea=(""+ea).toLowerCase();oa=!0}}(ba);if("string"!=typeof la&&(W.isEncoding===Z||!Z(ba)))throw Error("Unknown encoding: "+ba);return la||ba}(ca),this.encoding){case "utf16le":this.text=M;this.end=L;ca=4;break;case "utf8":this.fillLast=H;ca=4;break;case "base64":this.text=O;this.end=S;ca=3;break;default:return this.write=T,void(this.end=P)}this.lastTotal=this.lastNeed=0;this.lastChar=W.allocUnsafe(ca)}
function C(ca){return 127>=ca?0:6==ca>>5?2:14==ca>>4?3:30==ca>>3?4:2==ca>>6?-1:-2}function H(ca){var ba=this.lastTotal-this.lastNeed;a:if(128!=(192&ca[0]))var la=(this.lastNeed=0,"\ufffd");else{if(1<this.lastNeed&&1<ca.length){if(128!=(192&ca[1])){la=(this.lastNeed=1,"\ufffd");break a}if(2<this.lastNeed&&2<ca.length&&128!=(192&ca[2])){la=(this.lastNeed=2,"\ufffd");break a}}la=void 0}return void 0===la?this.lastNeed<=ca.length?(ca.copy(this.lastChar,ba,0,this.lastNeed),this.lastChar.toString(this.encoding,
0,this.lastTotal)):(ca.copy(this.lastChar,ba,0,ca.length),void(this.lastNeed-=ca.length)):la}function M(ca,ba){if(0==(ca.length-ba)%2){if(ba=ca.toString("utf16le",ba)){var la=ba.charCodeAt(ba.length-1);if(55296<=la&&56319>=la)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=ca[ca.length-2],this.lastChar[1]=ca[ca.length-1],ba.slice(0,-1)}return ba}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=ca[ca.length-1],ca.toString("utf16le",ba,ca.length-1)}function L(ca){ca=ca&&ca.length?this.write(ca):
"";return this.lastNeed?ca+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):ca}function O(ca,ba){var la=(ca.length-ba)%3;return 0==la?ca.toString("base64",ba):(this.lastNeed=3-la,this.lastTotal=3,1==la?this.lastChar[0]=ca[ca.length-1]:(this.lastChar[0]=ca[ca.length-2],this.lastChar[1]=ca[ca.length-1]),ca.toString("base64",ba,ca.length-la))}function S(ca){ca=ca&&ca.length?this.write(ca):"";return this.lastNeed?ca+this.lastChar.toString("base64",0,3-this.lastNeed):ca}function T(ca){return ca.toString(this.encoding)}
function P(ca){return ca&&ca.length?this.write(ca):""}var W=n("safe-buffer").Buffer,Z=W.isEncoding||function(ca){switch((ca=""+ca)&&ca.toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":case "raw":return!0;default:return!1}};w.StringDecoder=z;z.prototype.write=function(ca){if(0===ca.length)return"";var ba;if(this.lastNeed){if(void 0===(ba=this.fillLast(ca)))return"";var la=this.lastNeed;this.lastNeed=
0}else la=0;return la<ca.length?ba?ba+this.text(ca,la):this.text(ca,la):ba||""};z.prototype.end=function(ca){ca=ca&&ca.length?this.write(ca):"";return this.lastNeed?ca+"\ufffd":ca};z.prototype.text=function(ca,ba){var la=ca.length-1;if(la<ba)var ea=0;else{var oa=C(ca[la]);ea=0<=oa?(0<oa&&(this.lastNeed=oa-1),oa):--la<ba||-2===oa?0:0<=(oa=C(ca[la]))?(0<oa&&(this.lastNeed=oa-2),oa):--la<ba||-2===oa?0:0<=(oa=C(ca[la]))?(0<oa&&(2===oa?oa=0:this.lastNeed=oa-3),oa):0}if(!this.lastNeed)return ca.toString("utf8",
ba);this.lastTotal=ea;ea=ca.length-(ea-this.lastNeed);return ca.copy(this.lastChar,0,ea),ca.toString("utf8",ba,ea)};z.prototype.fillLast=function(ca){return this.lastNeed<=ca.length?(ca.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(ca.copy(this.lastChar,this.lastTotal-this.lastNeed,0,ca.length),void(this.lastNeed-=ca.length))}},{"safe-buffer":30}],32:[function(n,t){(function(w){(function(){function z(C){try{if(!w.localStorage)return!1}catch(H){return!1}C=
w.localStorage[C];return null!=C&&"true"===(C+"").toLowerCase()}t.exports=function(C,H){if(z("noDeprecation"))return C;var M=!1;return function(){if(!M){if(z("throwDeprecation"))throw Error(H);z("traceDeprecation")?console.trace(H):console.warn(H);M=!0}return C.apply(this,arguments)}}}).call(this)}).call(this,void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{}],"/":[function(n,t){function w(P){return P.replace(/a=ice-options:trickle\s\n/g,
"")}const z=n("debug")("simple-peer"),C=n("get-browser-rtc"),H=n("randombytes"),M=n("readable-stream"),L=n("queue-microtask"),O=n("err-code"),{Buffer:S}=n("buffer");class T extends M.Duplex{constructor(P){if(super(P=Object.assign({allowHalfOpen:!1},P)),this._id=H(4).toString("hex").slice(0,7),this._debug("new peer %o",P),this.channelName=P.initiator?P.channelName||H(20).toString("hex"):null,this.initiator=P.initiator||!1,this.channelConfig=P.channelConfig||T.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,
this.config=Object.assign({},T.config,P.config),this.offerOptions=P.offerOptions||{},this.answerOptions=P.answerOptions||{},this.sdpTransform=P.sdpTransform||(W=>W),this.streams=P.streams||(P.stream?[P.stream]:[]),this.trickle=void 0===P.trickle||P.trickle,this.allowHalfTrickle=void 0!==P.allowHalfTrickle&&P.allowHalfTrickle,this.iceCompleteTimeout=P.iceCompleteTimeout||5E3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,
this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=P.wrtc&&"object"==typeof P.wrtc?P.wrtc:C(),!this._wrtc)throw"undefined"==typeof window?O(Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):O(Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._iceComplete=this._channelReady=this._pcReady=!1;this._channel=this._iceCompleteTimer=null;this._pendingCandidates=[];this._isNegotiating=!1;this._firstNegotiation=
!0;this._queuedNegotiation=this._batchedNegotiation=!1;this._sendersAwaitingStable=[];this._senderMap=new Map;this._closingInterval=null;this._remoteTracks=[];this._remoteStreams=[];this._interval=this._cb=this._chunk=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(W){return void this.destroy(O(W,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId;this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()};this._pc.onicegatheringstatechange=
()=>{this._onIceStateChange()};this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()};this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()};this._pc.onicecandidate=W=>{this._onIceCandidate(W)};"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch(W=>{this.destroy(O(W,"ERR_PC_PEER_IDENTITY"))});this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=W=>{this._setupData(W)};
this.streams&&this.streams.forEach(W=>{this.addStream(W)});this._pc.ontrack=W=>{this._onTrack(W)};this._debug("initial negotiation");this._needsNegotiation();this._onFinishBound=()=>{this._onFinish()};this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(P){if(!this.destroying){if(this.destroyed)throw O(Error("cannot signal after peer is destroyed"),
"ERR_DESTROYED");if("string"==typeof P)try{P=JSON.parse(P)}catch(W){P={}}this._debug("signal()");P.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation());P.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(P.transceiverRequest.kind,P.transceiverRequest.init));P.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(P.candidate):this._pendingCandidates.push(P.candidate));
P.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(P)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(W=>{this._addIceCandidate(W)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(W=>{this.destroy(O(W,"ERR_SET_REMOTE_DESCRIPTION"))});P.sdp||P.candidate||P.renegotiate||P.transceiverRequest||this.destroy(O(Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(P){const W=new this._wrtc.RTCIceCandidate(P);
this._pc.addIceCandidate(W).catch(Z=>{!W.address||W.address.endsWith(".local")?console.warn("Ignoring unsupported ICE candidate."):this.destroy(O(Z,"ERR_ADD_ICE_CANDIDATE"))})}send(P){if(!this.destroying){if(this.destroyed)throw O(Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(P)}}addTransceiver(P,W){if(!this.destroying){if(this.destroyed)throw O(Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(P,
W),this._needsNegotiation()}catch(Z){this.destroy(O(Z,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:P,init:W}})}}addStream(P){if(!this.destroying){if(this.destroyed)throw O(Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()");P.getTracks().forEach(W=>{this.addTrack(W,P)})}}addTrack(P,W){if(!this.destroying){if(this.destroyed)throw O(Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");
var Z=this._senderMap.get(P)||new Map,ca=Z.get(W);if(ca)throw ca.removed?O(Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):O(Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");ca=this._pc.addTrack(P,W);Z.set(W,ca);this._senderMap.set(P,Z);this._needsNegotiation()}}replaceTrack(P,W,Z){if(!this.destroying){if(this.destroyed)throw O(Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");
Z=(P=this._senderMap.get(P))?P.get(Z):null;if(!Z)throw O(Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");W&&this._senderMap.set(W,P);null==Z.replaceTrack?this.destroy(O(Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):Z.replaceTrack(W)}}removeTrack(P,W){if(!this.destroying){if(this.destroyed)throw O(Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");W=(P=this._senderMap.get(P))?P.get(W):
null;if(!W)throw O(Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{W.removed=!0,this._pc.removeTrack(W)}catch(Z){"NS_ERROR_UNEXPECTED"===Z.name?this._sendersAwaitingStable.push(W):this.destroy(O(Z,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}}removeStream(P){if(!this.destroying){if(this.destroyed)throw O(Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()");P.getTracks().forEach(W=>{this.removeTrack(W,P)})}}_needsNegotiation(){this._debug("_needsNegotiation");
this._batchedNegotiation||(this._batchedNegotiation=!0,L(()=>{this._batchedNegotiation=!1;this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded");this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw O(Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):
(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0}));this._isNegotiating=!0}}destroy(P){this._destroy(P,()=>{})}_destroy(P,W){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",P&&(P.message||P)),L(()=>{if(this.destroyed=!0,this.destroying=
!1,this._debug("destroy (error: %s)",P&&(P.message||P)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),
this._onFinishBound=null,this._channel){try{this._channel.close()}catch(Z){}this._channel.onmessage=null;this._channel.onopen=null;this._channel.onclose=null;this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(Z){}this._pc.oniceconnectionstatechange=null;this._pc.onicegatheringstatechange=null;this._pc.onsignalingstatechange=null;this._pc.onicecandidate=null;this._pc.ontrack=null;this._pc.ondatachannel=null}this._channel=this._pc=null;P&&this.emit("error",P);this.emit("close");W()}))}_setupData(P){if(!P.channel)return this.destroy(O(Error("Data channel event is missing `channel` property"),
"ERR_DATA_CHANNEL"));this._channel=P.channel;this._channel.binaryType="arraybuffer";"number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=65536);this.channelName=this._channel.label;this._channel.onmessage=Z=>{this._onChannelMessage(Z)};this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()};this._channel.onopen=()=>{this._onChannelOpen()};this._channel.onclose=()=>{this._onChannelClose()};this._channel.onerror=Z=>{this.destroy(O(Z.error instanceof
Error?Z.error:Error(`Datachannel error: ${Z.message} ${Z.filename}:${Z.lineno}:${Z.colno}`),"ERR_DATA_CHANNEL"))};let W=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(W&&this._onChannelClose(),W=!0):W=!1},5E3)}_read(){}_write(P,W,Z){if(this.destroyed)return Z(O(Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(P)}catch(ca){return this.destroy(O(ca,"ERR_DATA_CHANNEL"))}65536<this._channel.bufferedAmount?
(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=Z):Z(null)}else this._debug("write before connect"),this._chunk=P,this._cb=Z}_onFinish(){if(!this.destroyed){const P=()=>{setTimeout(()=>this.destroy(),1E3)};this._connected?P():this.once("connect",P)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),
this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(P=>{if(!this.destroyed){this.trickle||this.allowHalfTrickle||(P.sdp=w(P.sdp));P.sdp=this.sdpTransform(P.sdp);var W=()=>{if(!this.destroyed){const Z=this._pc.localDescription||P;this._debug("signal");this.emit("signal",{type:Z.type,sdp:Z.sdp})}};this._pc.setLocalDescription(P).then(()=>{this._debug("createOffer success");this.destroyed||(this.trickle||
this._iceComplete?W():this.once("_iceComplete",W))}).catch(Z=>{this.destroy(O(Z,"ERR_SET_LOCAL_DESCRIPTION"))})}}).catch(P=>{this.destroy(O(P,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(P=>{P.mid||!P.sender.track||P.requested||(P.requested=!0,this.addTransceiver(P.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(P=>{if(!this.destroyed){this.trickle||this.allowHalfTrickle||(P.sdp=
w(P.sdp));P.sdp=this.sdpTransform(P.sdp);var W=()=>{if(!this.destroyed){const Z=this._pc.localDescription||P;this._debug("signal");this.emit("signal",{type:Z.type,sdp:Z.sdp});this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(P).then(()=>{this.destroyed||(this.trickle||this._iceComplete?W():this.once("_iceComplete",W))}).catch(Z=>{this.destroy(O(Z,"ERR_SET_LOCAL_DESCRIPTION"))})}}).catch(P=>{this.destroy(O(P,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||
"failed"===this._pc.connectionState&&this.destroy(O(Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var P=this._pc.iceConnectionState,W=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",P,W);this.emit("iceStateChange",P,W);"connected"!==P&&"completed"!==P||(this._pcReady=!0,this._maybeReady());"failed"===P&&this.destroy(O(Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE"));"closed"===P&&this.destroy(O(Error("Ice connection closed."),
"ERR_ICE_CONNECTION_CLOSED"))}}getStats(P){const W=Z=>("[object Array]"===Object.prototype.toString.call(Z.values)&&Z.values.forEach(ca=>{Object.assign(Z,ca)}),Z);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(Z=>{const ca=[];Z.forEach(ba=>{ca.push(W(ba))});P(null,ca)},Z=>P(Z)):0<this._pc.getStats.length?this._pc.getStats(Z=>{if(!this.destroyed){var ca=[];Z.result().forEach(ba=>{const la={};ba.names().forEach(ea=>{la[ea]=ba.stat(ea)});la.id=ba.id;la.type=ba.type;
la.timestamp=ba.timestamp;ca.push(W(la))});P(null,ca)}},Z=>P(Z)):P(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),!this._connected&&!this._connecting&&this._pcReady&&this._channelReady){this._connecting=!0;var P=()=>{this.destroyed||this.getStats((W,Z)=>{if(!this.destroyed){W&&(Z=[]);var ca={},ba={},la={},ea=!1;Z.forEach(sa=>{"remotecandidate"!==sa.type&&"remote-candidate"!==sa.type||(ca[sa.id]=sa);"localcandidate"!==sa.type&&"local-candidate"!==
sa.type||(ba[sa.id]=sa);"candidatepair"!==sa.type&&"candidate-pair"!==sa.type||(la[sa.id]=sa)});var oa=sa=>{ea=!0;var xa=ba[sa.localCandidateId];xa&&(xa.ip||xa.address)?(this.localAddress=xa.ip||xa.address,this.localPort=+xa.port):xa&&xa.ipAddress?(this.localAddress=xa.ipAddress,this.localPort=+xa.portNumber):"string"==typeof sa.googLocalAddress&&(xa=sa.googLocalAddress.split(":"),this.localAddress=xa[0],this.localPort=+xa[1]);this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":
"IPv4");(xa=ca[sa.remoteCandidateId])&&(xa.ip||xa.address)?(this.remoteAddress=xa.ip||xa.address,this.remotePort=+xa.port):xa&&xa.ipAddress?(this.remoteAddress=xa.ipAddress,this.remotePort=+xa.portNumber):"string"==typeof sa.googRemoteAddress&&(xa=sa.googRemoteAddress.split(":"),this.remoteAddress=xa[0],this.remotePort=+xa[1]);this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4");this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,
this.remotePort)};if(Z.forEach(sa=>{"transport"===sa.type&&sa.selectedCandidatePairId&&oa(la[sa.selectedCandidatePairId]);("googCandidatePair"===sa.type&&"true"===sa.googActiveConnection||("candidatepair"===sa.type||"candidate-pair"===sa.type)&&sa.selected)&&oa(sa)}),ea||Object.keys(la).length&&!Object.keys(ba).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(sa){return this.destroy(O(sa,"ERR_DATA_CHANNEL"))}this._chunk=null;this._debug('sent chunk from "write before connect"');
W=this._cb;this._cb=null;W(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref());this._debug("connect");this.emit("connect")}else setTimeout(P,100)}})};P()}}_onInterval(){this._cb&&this._channel&&!(65536<this._channel.bufferedAmount)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",
this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(P=>{this._pc.removeTrack(P);this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(P){this.destroyed||(P.candidate&&this.trickle?
this.emit("signal",{type:"candidate",candidate:{candidate:P.candidate.candidate,sdpMLineIndex:P.candidate.sdpMLineIndex,sdpMid:P.candidate.sdpMid}}):!P.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),P.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(P){this.destroyed||(P=P.data,P instanceof ArrayBuffer&&(P=S.from(P)),this.push(P))}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);
const P=this._cb;this._cb=null;P(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(P){this.destroyed||P.streams.forEach(W=>{this._debug("on track");this.emit("track",P.track,W);this._remoteTracks.push({track:P.track,stream:W});this._remoteStreams.some(Z=>Z.id===W.id)||(this._remoteStreams.push(W),L(()=>{this._debug("on stream");
this.emit("stream",W)}))})}_debug(){const P=[].slice.call(arguments);P[0]="["+this._id+"] "+P[0];z.apply(null,P)}}T.WEBRTC_SUPPORT=!!C();T.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};T.channelConfig={};t.exports=T},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/"))});
const writeSyncStep1$$module$libs$y_webrtc_min=(a,b)=>{writeVarUint$$module$libs$y_webrtc_min(a,0);b=encodeStateVector$$module$libs$y_webrtc_min(b);writeVarUint8Array$$module$libs$y_webrtc_min(a,b)},writeSyncStep2$$module$libs$y_webrtc_min=(a,b,c)=>{writeVarUint$$module$libs$y_webrtc_min(a,1);writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeStateAsUpdate$$module$libs$y_webrtc_min(b,c))},readSyncStep2$$module$libs$y_webrtc_min=(a,b,c)=>{try{applyUpdate$$module$libs$y_webrtc_min(b,readVarUint8Array$$module$libs$y_webrtc_min(a),
c)}catch(d){console.error("Caught error while handling a Yjs update",d)}},readUpdate$1$$module$libs$y_webrtc_min=readSyncStep2$$module$libs$y_webrtc_min,readSyncMessage$$module$libs$y_webrtc_min=(a,b,c,d)=>{const e=readVarUint$$module$libs$y_webrtc_min(a);switch(e){case 0:writeSyncStep2$$module$libs$y_webrtc_min(b,c,readVarUint8Array$$module$libs$y_webrtc_min(a));break;case 1:readSyncStep2$$module$libs$y_webrtc_min(a,c,d);break;case 2:readSyncStep2$$module$libs$y_webrtc_min(a,c,d);break;default:throw Error("Unknown message type");
}return e};
class Awareness$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a){super();this.doc=a;this.clientID=a.clientID;this.states=new Map;this.meta=new Map;this._checkInterval=setInterval(()=>{const b=getUnixTime$$module$libs$y_webrtc_min();null!==this.getLocalState()&&15E3<=b-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const c=[];this.meta.forEach((d,e)=>{e!==this.clientID&&3E4<=b-d.lastUpdated&&this.states.has(e)&&c.push(e)});0<
c.length&&removeAwarenessStates$$module$libs$y_webrtc_min(this,c,"timeout")},floor$$module$libs$y_webrtc_min(3E3));a.on("destroy",()=>{this.destroy()});this.setLocalState({})}destroy(){this.emit("destroy",[this]);this.setLocalState(null);super.destroy();clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(a){const b=this.clientID;var c=this.meta.get(b),d=void 0===c?0:c.clock+1;c=this.states.get(b);null===a?this.states.delete(b):this.states.set(b,
a);this.meta.set(b,{clock:d,lastUpdated:getUnixTime$$module$libs$y_webrtc_min()});d=[];const e=[],g=[],n=[];null===a?n.push(b):null==c?null!=a&&d.push(b):(e.push(b),equalityDeep$$module$libs$y_webrtc_min(c,a)||g.push(b));(0<d.length||0<g.length||0<n.length)&&this.emit("change",[{added:d,updated:g,removed:n},"local"]);this.emit("update",[{added:d,updated:e,removed:n},"local"])}setLocalStateField(a,b){const c=this.getLocalState();null!==c&&this.setLocalState({...c,[a]:b})}getStates(){return this.states}}
const removeAwarenessStates$$module$libs$y_webrtc_min=(a,b,c)=>{const d=[];for(let e=0;e<b.length;e++){const g=b[e];if(a.states.has(g)){if(a.states.delete(g),g===a.clientID){const n=a.meta.get(g);a.meta.set(g,{clock:n.clock+1,lastUpdated:getUnixTime$$module$libs$y_webrtc_min()})}d.push(g)}}0<d.length&&(a.emit("change",[{added:[],updated:[],removed:d},c]),a.emit("update",[{added:[],updated:[],removed:d},c]))},encodeAwarenessUpdate$$module$libs$y_webrtc_min=(a,b,c=a.states)=>{const d=b.length,e=createEncoder$$module$libs$y_webrtc_min();
writeVarUint$$module$libs$y_webrtc_min(e,d);for(let g=0;g<d;g++){const n=b[g],t=c.get(n)||null,w=a.meta.get(n).clock;writeVarUint$$module$libs$y_webrtc_min(e,n);writeVarUint$$module$libs$y_webrtc_min(e,w);writeVarString$$module$libs$y_webrtc_min(e,JSON.stringify(t))}return toUint8Array$$module$libs$y_webrtc_min(e)},encrypt$$module$libs$y_webrtc_min=(a,b)=>{if(!b)return resolve$$module$libs$y_webrtc_min(a);const c=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",
iv:c},b,a).then(d=>{const e=createEncoder$$module$libs$y_webrtc_min();return writeVarString$$module$libs$y_webrtc_min(e,"AES-GCM"),writeVarUint8Array$$module$libs$y_webrtc_min(e,c),writeVarUint8Array$$module$libs$y_webrtc_min(e,new Uint8Array(d)),toUint8Array$$module$libs$y_webrtc_min(e)})},decrypt$$module$libs$y_webrtc_min=(a,b)=>{if(!b)return resolve$$module$libs$y_webrtc_min(a);a=createDecoder$$module$libs$y_webrtc_min(a);var c;"AES-GCM"!==readVarString$$module$libs$y_webrtc_min(a)&&(c=create$2$$module$libs$y_webrtc_min("Unknown encryption algorithm"),
Promise.reject(c));c=readVarUint8Array$$module$libs$y_webrtc_min(a);a=readVarUint8Array$$module$libs$y_webrtc_min(a);return crypto.subtle.decrypt({name:"AES-GCM",iv:c},b,a).then(d=>new Uint8Array(d))},log$$module$libs$y_webrtc_min=((a,b)=>{const c=loggingColors$$module$libs$y_webrtc_min[nextColor$$module$libs$y_webrtc_min];var d=getVariable$$module$libs$y_webrtc_min("log");d=null!==d&&("*"===d||"true"===d||(new RegExp(d,"gi")).test(b));return nextColor$$module$libs$y_webrtc_min=(nextColor$$module$libs$y_webrtc_min+
1)%loggingColors$$module$libs$y_webrtc_min.length,b+=": ",d?(...e)=>{const g=getUnixTime$$module$libs$y_webrtc_min(),n=g-lastLoggingTime$$module$libs$y_webrtc_min;lastLoggingTime$$module$libs$y_webrtc_min=g;a(c,b,UNCOLOR$$module$libs$y_webrtc_min,...e.map(t=>"string"==typeof t||"symbol"==typeof t?t:JSON.stringify(t)),c," +"+n+"ms")}:nop$$module$libs$y_webrtc_min})(print$$module$libs$y_webrtc_min,"y-webrtc"),signalingConns$$module$libs$y_webrtc_min=new Map,rooms$$module$libs$y_webrtc_min=new Map,checkIsSynced$$module$libs$y_webrtc_min=
a=>{let b=!0;a.webrtcConns.forEach(c=>{c.synced||(b=!1)});(!b&&a.synced||b&&!a.synced)&&(a.synced=b,a.provider.emit("synced",[{synced:b}]),log$$module$libs$y_webrtc_min("synced ",BOLD$$module$libs$y_webrtc_min,a.name,UNBOLD$$module$libs$y_webrtc_min," with all peers"))},readMessage$$module$libs$y_webrtc_min=(a,b,c)=>{var d=createDecoder$$module$libs$y_webrtc_min(b);b=createEncoder$$module$libs$y_webrtc_min();var e=readVarUint$$module$libs$y_webrtc_min(d);if(void 0===a)return null;var g=a.awareness,
n=a.doc;let t=!1;switch(e){case 0:writeVarUint$$module$libs$y_webrtc_min(b,0);g=readSyncMessage$$module$libs$y_webrtc_min(d,b,n,a);1!==g||a.synced||c();0===g&&(t=!0);break;case 3:writeVarUint$$module$libs$y_webrtc_min(b,1);writeVarUint8Array$$module$libs$y_webrtc_min(b,encodeAwarenessUpdate$$module$libs$y_webrtc_min(g,Array.from(g.getStates().keys())));t=!0;break;case 1:c=readVarUint8Array$$module$libs$y_webrtc_min(d);c=createDecoder$$module$libs$y_webrtc_min(c);d=getUnixTime$$module$libs$y_webrtc_min();
e=[];n=[];const w=[],z=[],C=readVarUint$$module$libs$y_webrtc_min(c);for(let H=0;H<C;H++){const M=readVarUint$$module$libs$y_webrtc_min(c);let L=readVarUint$$module$libs$y_webrtc_min(c);const O=JSON.parse(readVarString$$module$libs$y_webrtc_min(c)),S=g.meta.get(M),T=g.states.get(M),P=void 0===S?0:S.clock;(P<L||P===L&&null===O&&g.states.has(M))&&(null===O?M===g.clientID&&null!=g.getLocalState()?L++:g.states.delete(M):g.states.set(M,O),g.meta.set(M,{clock:L,lastUpdated:d}),void 0===S&&null!==O?e.push(M):
void 0!==S&&null===O?z.push(M):null!==O&&(equalityDeep$$module$libs$y_webrtc_min(O,T)||w.push(M),n.push(M)))}(0<e.length||0<w.length||0<z.length)&&g.emit("change",[{added:e,updated:w,removed:z},a]);(0<e.length||0<n.length||0<z.length)&&g.emit("update",[{added:e,updated:n,removed:z},a]);break;case 4:g=1===readUint8$$module$libs$y_webrtc_min(d);c=readVarString$$module$libs$y_webrtc_min(d);c!==a.peerId&&(a.bcConns.has(c)&&!g||!a.bcConns.has(c)&&g)&&(d=[],e=[],g?(a.bcConns.add(c),e.push(c)):(a.bcConns.delete(c),
d.push(c)),a.provider.emit("peers",[{added:e,removed:d,webrtcPeers:Array.from(a.webrtcConns.keys()),bcPeers:Array.from(a.bcConns)}]),broadcastBcPeerId$$module$libs$y_webrtc_min(a));break;default:return console.error("Unable to compute message"),b}return t?b:null},sendWebrtcConn$$module$libs$y_webrtc_min=(a,b)=>{log$$module$libs$y_webrtc_min("send message to ",BOLD$$module$libs$y_webrtc_min,a.remotePeerId,UNBOLD$$module$libs$y_webrtc_min,GREY$$module$libs$y_webrtc_min," (",a.room.name,")",UNCOLOR$$module$libs$y_webrtc_min);
try{a.peer.send(toUint8Array$$module$libs$y_webrtc_min(b))}catch(c){}};
class WebrtcConn$$module$libs$y_webrtc_min{constructor(a,b,c,d){log$$module$libs$y_webrtc_min("establishing connection to ",BOLD$$module$libs$y_webrtc_min,c);this.room=d;this.remotePeerId=c;this.synced=this.connected=this.closed=!1;this.peer=new simplepeer_min$$module$libs$y_webrtc_min({initiator:b,...d.provider.peerOpts});this.peer.on("signal",e=>{publishSignalingMessage$$module$libs$y_webrtc_min(a,d,{to:c,from:d.peerId,type:"signal",signal:e})});this.peer.on("connect",()=>{log$$module$libs$y_webrtc_min("connected to ",
BOLD$$module$libs$y_webrtc_min,c);this.connected=!0;var e=d.provider.doc;const g=d.awareness;var n=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(n,0);writeSyncStep1$$module$libs$y_webrtc_min(n,e);sendWebrtcConn$$module$libs$y_webrtc_min(this,n);e=g.getStates();0<e.size&&(n=createEncoder$$module$libs$y_webrtc_min(),writeVarUint$$module$libs$y_webrtc_min(n,1),writeVarUint8Array$$module$libs$y_webrtc_min(n,encodeAwarenessUpdate$$module$libs$y_webrtc_min(g,Array.from(e.keys()))),
sendWebrtcConn$$module$libs$y_webrtc_min(this,n))});this.peer.on("close",()=>{this.connected=!1;this.closed=!0;d.webrtcConns.has(this.remotePeerId)&&(d.webrtcConns.delete(this.remotePeerId),d.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(d.webrtcConns.keys()),bcPeers:Array.from(d.bcConns)}]));checkIsSynced$$module$libs$y_webrtc_min(d);this.peer.destroy();log$$module$libs$y_webrtc_min("closed connection to ",BOLD$$module$libs$y_webrtc_min,c);announceSignalingInfo$$module$libs$y_webrtc_min(d)});
this.peer.on("error",e=>{log$$module$libs$y_webrtc_min("Error in connection to ",BOLD$$module$libs$y_webrtc_min,c,": ",e);announceSignalingInfo$$module$libs$y_webrtc_min(d)});this.peer.on("data",e=>{e=((g,n)=>{const t=g.room;return log$$module$libs$y_webrtc_min("received message from ",BOLD$$module$libs$y_webrtc_min,g.remotePeerId,GREY$$module$libs$y_webrtc_min," (",t.name,")",UNBOLD$$module$libs$y_webrtc_min,UNCOLOR$$module$libs$y_webrtc_min),readMessage$$module$libs$y_webrtc_min(t,n,()=>{g.synced=
!0;log$$module$libs$y_webrtc_min("synced ",BOLD$$module$libs$y_webrtc_min,t.name,UNBOLD$$module$libs$y_webrtc_min," with ",BOLD$$module$libs$y_webrtc_min,g.remotePeerId);checkIsSynced$$module$libs$y_webrtc_min(t)})})(this,e);null!==e&&sendWebrtcConn$$module$libs$y_webrtc_min(this,e)})}destroy(){this.peer.destroy()}}
const broadcastBcMessage$$module$libs$y_webrtc_min=(a,b)=>encrypt$$module$libs$y_webrtc_min(b,a.key).then(c=>a.mux(()=>((d,e,g=null)=>{d=getChannel$$module$libs$y_webrtc_min(d);d.bc.postMessage(e);d.subs.forEach(n=>n(e,g))})(a.name,c))),broadcastRoomMessage$$module$libs$y_webrtc_min=(a,b)=>{a.bcconnected&&broadcastBcMessage$$module$libs$y_webrtc_min(a,b);((c,d)=>{log$$module$libs$y_webrtc_min("broadcast message in ",BOLD$$module$libs$y_webrtc_min,c.name,UNBOLD$$module$libs$y_webrtc_min);c.webrtcConns.forEach(e=>
{try{e.peer.send(d)}catch(g){}})})(a,b)},announceSignalingInfo$$module$libs$y_webrtc_min=a=>{signalingConns$$module$libs$y_webrtc_min.forEach(b=>{b.connected&&(b.send({type:"subscribe",topics:[a.name]}),a.webrtcConns.size<a.provider.maxConns&&publishSignalingMessage$$module$libs$y_webrtc_min(b,a,{type:"announce",from:a.peerId}))})},broadcastBcPeerId$$module$libs$y_webrtc_min=a=>{if(a.provider.filterBcConns){const b=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(b,
4);write$$module$libs$y_webrtc_min(b,1);writeVarString$$module$libs$y_webrtc_min(b,a.peerId);broadcastBcMessage$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(b))}};
class Room$$module$libs$y_webrtc_min{constructor(a,b,c,d){this.peerId=uuidv4$$module$libs$y_webrtc_min();this.doc=a;this.awareness=b.awareness;this.provider=b;this.synced=!1;this.name=c;this.key=d;this.webrtcConns=new Map;this.bcConns=new Set;this.mux=(()=>{let e=!0;return(g,n)=>{if(e){e=!1;try{g()}finally{e=!0}}else void 0!==n&&n()}})();this.bcconnected=!1;this._bcSubscriber=e=>decrypt$$module$libs$y_webrtc_min(new Uint8Array(e),d).then(g=>this.mux(()=>{const n=readMessage$$module$libs$y_webrtc_min(this,
g,()=>{});n&&broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(n))}));this._docUpdateHandler=(e,g)=>{g=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(g,0);writeVarUint$$module$libs$y_webrtc_min(g,2);writeVarUint8Array$$module$libs$y_webrtc_min(g,e);broadcastRoomMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(g))};this._awarenessUpdateHandler=({added:e,updated:g,removed:n},t)=>{e=e.concat(g).concat(n);
g=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(g,1);writeVarUint8Array$$module$libs$y_webrtc_min(g,encodeAwarenessUpdate$$module$libs$y_webrtc_min(this.awareness,e));broadcastRoomMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(g))};this._beforeUnloadHandler=()=>{removeAwarenessStates$$module$libs$y_webrtc_min(this.awareness,[a.clientID],"window unload");rooms$$module$libs$y_webrtc_min.forEach(e=>{e.disconnect()})};"undefined"!=typeof window?
window.addEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!=typeof process&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler);this.awareness.on("update",this._awarenessUpdateHandler);announceSignalingInfo$$module$libs$y_webrtc_min(this);var a=this.name;var b=this._bcSubscriber;getChannel$$module$libs$y_webrtc_min(a).subs.add(b);this.bcconnected=!0;broadcastBcPeerId$$module$libs$y_webrtc_min(this);a=createEncoder$$module$libs$y_webrtc_min();
writeVarUint$$module$libs$y_webrtc_min(a,0);writeSyncStep1$$module$libs$y_webrtc_min(a,this.doc);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,0);writeSyncStep2$$module$libs$y_webrtc_min(a,this.doc);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,
3);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,1);writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeAwarenessUpdate$$module$libs$y_webrtc_min(this.awareness,[this.doc.clientID]));broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a))}disconnect(){signalingConns$$module$libs$y_webrtc_min.forEach(b=>{b.connected&&b.send({type:"unsubscribe",
topics:[this.name]})});removeAwarenessStates$$module$libs$y_webrtc_min(this.awareness,[this.doc.clientID],"disconnect");const a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,4);write$$module$libs$y_webrtc_min(a,0);writeVarString$$module$libs$y_webrtc_min(a,this.peerId);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));((b,c)=>{const d=getChannel$$module$libs$y_webrtc_min(b);d.subs.delete(c)&&0===d.subs.size&&(d.bc.close(),
channels$$module$libs$y_webrtc_min.delete(b))})(this.name,this._bcSubscriber);this.bcconnected=!1;this.doc.off("update",this._docUpdateHandler);this.awareness.off("update",this._awarenessUpdateHandler);this.webrtcConns.forEach(b=>b.destroy())}destroy(){this.disconnect();"undefined"!=typeof window?window.removeEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!=typeof process&&process.off("exit",this._beforeUnloadHandler)}}
const publishSignalingMessage$$module$libs$y_webrtc_min=(a,b,c)=>{b.key?((d,e)=>{const g=createEncoder$$module$libs$y_webrtc_min();return writeAny$$module$libs$y_webrtc_min(g,d),encrypt$$module$libs$y_webrtc_min(toUint8Array$$module$libs$y_webrtc_min(g),e)})(c,b.key).then(d=>{a.send({type:"publish",topic:b.name,data:toBase64$$module$libs$y_webrtc_min(d)})}):a.send({type:"publish",topic:b.name,data:c})};
class SignalingConn$$module$libs$y_webrtc_min extends WebsocketClient$$module$libs$y_webrtc_min{constructor(a){super(a);this.providers=new Set;this.on("connect",()=>{log$$module$libs$y_webrtc_min(`connected (${a})`);const b=Array.from(rooms$$module$libs$y_webrtc_min.keys());this.send({type:"subscribe",topics:b});rooms$$module$libs$y_webrtc_min.forEach(c=>publishSignalingMessage$$module$libs$y_webrtc_min(this,c,{type:"announce",from:c.peerId}))});this.on("message",b=>{switch(b.type){case "publish":var c=
b.topic;const g=rooms$$module$libs$y_webrtc_min.get(c);if(null==g||"string"!=typeof c)return;c=n=>{const t=g.webrtcConns,w=g.peerId;if(!(null==n||n.from===w||void 0!==n.to&&n.to!==w||g.bcConns.has(n.from))){var z=t.has(n.from)?()=>{}:()=>g.provider.emit("peers",[{removed:[],added:[n.from],webrtcPeers:Array.from(g.webrtcConns.keys()),bcPeers:Array.from(g.bcConns)}]);switch(n.type){case "announce":t.size<g.provider.maxConns&&(setIfUndefined$$module$libs$y_webrtc_min(t,n.from,()=>new WebrtcConn$$module$libs$y_webrtc_min(this,
!0,n.from,g)),z());break;case "signal":n.to===w&&(setIfUndefined$$module$libs$y_webrtc_min(t,n.from,()=>new WebrtcConn$$module$libs$y_webrtc_min(this,!1,n.from,g)).peer.signal(n.signal),z())}}};g.key?"string"==typeof b.data&&(d=fromBase64$$module$libs$y_webrtc_min(b.data),e=g.key,decrypt$$module$libs$y_webrtc_min(d,e).then(n=>readAny$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(new Uint8Array(n))))).then(c):c(b.data)}var d,e});this.on("disconnect",()=>log$$module$libs$y_webrtc_min(`disconnect (${a})`))}}
class WebrtcProvider$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,b,{signaling:c=["wss://y-webrtc-eu.fly.dev"],password:d=null,awareness:e=new Awareness$$module$libs$y_webrtc_min(b),maxConns:g=20+floor$$module$libs$y_webrtc_min(15*rand$$module$libs$y_webrtc_min()),filterBcConns:n=!0,peerOpts:t={}}={}){super();this.roomName=a;this.doc=b;this.filterBcConns=n;this.awareness=e;this.shouldConnect=!1;this.signalingUrls=c;this.signalingConns=[];this.maxConns=g;this.peerOpts=
t;this.key=d?((w,z)=>{w=encodeUtf8$$module$libs$y_webrtc_min(w).buffer;const C=encodeUtf8$$module$libs$y_webrtc_min(z).buffer;return crypto.subtle.importKey("raw",w,"PBKDF2",!1,["deriveKey"]).then(H=>crypto.subtle.deriveKey({name:"PBKDF2",salt:C,iterations:1E5,hash:"SHA-256"},H,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))})(d,a):resolve$$module$libs$y_webrtc_min(null);this.room=null;this.key.then(w=>{if(rooms$$module$libs$y_webrtc_min.has(a))throw create$2$$module$libs$y_webrtc_min(`A Yjs Doc connected to room "${a}" already exists!`);
w=new Room$$module$libs$y_webrtc_min(b,this,a,w);this.room=(rooms$$module$libs$y_webrtc_min.set(a,w),w);this.shouldConnect?this.room.connect():this.room.disconnect()});this.connect();this.destroy=this.destroy.bind(this);b.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0;this.signalingUrls.forEach(a=>{const b=setIfUndefined$$module$libs$y_webrtc_min(signalingConns$$module$libs$y_webrtc_min,a,()=>new SignalingConn$$module$libs$y_webrtc_min(a));
this.signalingConns.push(b);b.providers.add(this)});this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1;this.signalingConns.forEach(a=>{a.providers.delete(this);0===a.providers.size&&(a.destroy(),signalingConns$$module$libs$y_webrtc_min.delete(a.url))});this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy);this.key.then(()=>{this.room.destroy();rooms$$module$libs$y_webrtc_min.delete(this.roomName)});super.destroy()}}var module$libs$y_webrtc_min={};
module$libs$y_webrtc_min.AbsolutePosition=AbsolutePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractConnector=AbstractConnector$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractStruct=AbstractStruct$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractType=AbstractType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Array=YArray$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentAny=ContentAny$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.ContentBinary=ContentBinary$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentDeleted=ContentDeleted$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentEmbed=ContentEmbed$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentFormat=ContentFormat$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentJSON=ContentJSON$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentString=ContentString$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.ContentType=ContentType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Doc=Doc$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.GC=GC$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ID=ID$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Item=Item$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Map=YMap$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.PermanentUserData=PermanentUserData$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.RelativePosition=RelativePosition$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.Room=Room$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.SignalingConn=SignalingConn$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Snapshot=Snapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Text=YText$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Transaction=Transaction$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.UndoManager=UndoManager$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.UpdateEncoderV1=UpdateEncoderV1$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.WebrtcConn=WebrtcConn$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.WebrtcProvider=WebrtcProvider$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlElement=YXmlElement$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlFragment=YXmlFragment$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlHook=YXmlHook$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlText=YXmlText$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YArrayEvent=YArrayEvent$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.YEvent=YEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YMapEvent=YMapEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YTextEvent=YTextEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YXmlEvent=YXmlEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.applyUpdate=applyUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.applyUpdateV2=applyUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.cleanupYTextFormatting=cleanupYTextFormatting$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.compareIDs=compareIDs$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.compareRelativePositions=compareRelativePositions$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.convertUpdateFormatV1ToV2=convertUpdateFormatV1ToV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.convertUpdateFormatV2ToV1=convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createAbsolutePositionFromRelativePosition=createAbsolutePositionFromRelativePosition$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.createDeleteSet=createDeleteSet$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createDeleteSetFromStructStore=createDeleteSetFromStructStore$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createDocFromSnapshot=createDocFromSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createID=createID$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createRelativePositionFromJSON=createRelativePositionFromJSON$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.createRelativePositionFromTypeIndex=createRelativePositionFromTypeIndex$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createSnapshot=createSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeRelativePosition=decodeRelativePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeSnapshot=decodeSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeSnapshotV2=decodeSnapshotV2$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.decodeStateVector=decodeStateVector$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeUpdate=decodeUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeUpdateV2=decodeUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.diffUpdate=diffUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.diffUpdateV2=diffUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.emptySnapshot=emptySnapshot$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.encodeRelativePosition=encodeRelativePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeSnapshot=encodeSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeSnapshotV2=encodeSnapshotV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateAsUpdate=encodeStateAsUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateAsUpdateV2=encodeStateAsUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateVector=encodeStateVector$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.encodeStateVectorFromUpdate=encodeStateVectorFromUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateVectorFromUpdateV2=encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.equalSnapshots=equalSnapshots$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.findIndexSS=findIndexSS$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.findRootTypeKey=findRootTypeKey$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.getItem=getItem$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.getState=getState$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.getTypeChildren=getTypeChildren$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.isDeleted=isDeleted$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.isParentOf=isParentOf$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.iterateDeletedStructs=iterateDeletedStructs$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.logType=logType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.logUpdate=logUpdate$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.logUpdateV2=logUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.mergeUpdates=mergeUpdates$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.mergeUpdatesV2=mergeUpdatesV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.obfuscateUpdate=obfuscateUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.obfuscateUpdateV2=obfuscateUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.parseUpdateMeta=parseUpdateMeta$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.parseUpdateMetaV2=parseUpdateMetaV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.readUpdate=readUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.readUpdateV2=readUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.relativePositionToJSON=relativePositionToJSON$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.snapshot=snapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.transact=transact$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.tryGc=tryGc$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.typeListToArraySnapshot=typeListToArraySnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.typeMapGetSnapshot=typeMapGetSnapshot$$module$libs$y_webrtc_min;const html$$module$radial=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class AnimateSvg$$module$radial extends k$$module$libs$preact{constructor(a){super();this.mainId=uuidv4$$module$utils();this.mainId2=uuidv4$$module$utils();this.setState({kill:!1});this.out=!1}}
class RadialMenuButton$$module$radial extends k$$module$libs$preact{constructor(a){super();this.mainId=uuidv4$$module$utils();this.mainId2=uuidv4$$module$utils();this.setState({kill:!0});this.out=!1}componentDidUpdate(a){a.uuid!=this.props.uuid&&this.props.cond?this.inx():a.id!=this.props.id?this.inx():(this.props.cond&&this.out&&this.inx(),this.props.cond||this.out||this.outx())}componentDidMount(){const a=document.getElementById(this.mainId),b=document.getElementById(this.mainId+"z");a&&a.beginElement();
b&&b.beginElement();this.out=!1;this.setState({kill:!1})}inx(){const a=document.getElementById(this.mainId),b=document.getElementById(this.mainId+"z");this.out=!1;this.state.kill=!1;a&&a.beginElement();b&&b.beginElement()}outx(){const a=document.getElementById(this.mainId2),b=document.getElementById(this.mainId2+"z");a&&a.beginElement();b&&b.beginElement();let c=this;this.out=!0;window.setTimeout(function(){window.app.sense_mode=!1;c.setState({kill:!0})},350)}mouseover(){window.app.sense_mode=!0}mouseout(){window.app.sense_mode=
!1}render(a,b){b=b.kill&&!a.cond?html$$module$radial``:html$$module$radial`
            <g
              opacity="${this.props.enabled?1:.3}"
              transform="scale(${a.scale})"
              onmouseover="${()=>{this.mouseover()}}"
              onmouseout="${()=>{this.mouseout()}}"
            >
              <circle
                cx="-8.0776e-10"
                cy="2.1588e-9"
                r="5.538"
                fill="#000"
                fill-opacity=".28921"
                style="paint-order:fill markers stroke"
              />
              <circle
                cx="-8.0776e-10"
                cy="2.1588e-9"
                r="4.7411"
                fill="#d1d1d1"
                style="paint-order:fill markers stroke"
              />
              <use
                fill="${this.props.color||"#222222ff"}"
                xlink:href="${window.app.theme.svg}#${this.props.icon}"
              />
              <path
                d="m0.049757-4.5469a4.5948 4.5948 0 0 0-4.5948 4.5948 4.5948 4.5948 0 0 0 2.1786 3.9046 4.5948 4.5948 0 0 1-1.9714-3.7706 4.5948 4.5948 0 0 1 4.5948-4.5948 4.5948 4.5948 0 0 1 2.3904 0.67114 4.5948 4.5948 0 0 0-2.5976-0.80512z"
                fill="#fff"
                style="paint-order:fill markers stroke"
              />
              <path
                d="m-0.057583 4.5765a4.5948 4.5948 0 0 0 4.5948-4.5948 4.5948 4.5948 0 0 0-2.1786-3.9045 4.5948 4.5948 0 0 1 1.9715 3.7706 4.5948 4.5948 0 0 1-4.5948 4.5948 4.5948 4.5948 0 0 1-2.3904-0.67114 4.5948 4.5948 0 0 0 2.5976 0.80511z"
                fill="#999"
                style="paint-order:fill markers stroke"
              />
            </g>
          `;b=this.props.enabled&&this.props.cond?html$$module$radial` <a
            class="test"
            onClick=${c=>{window.app.sense_mode=!1;c.disable=!0;this.props.onClick()}}
          >
            ${b}
          </a>`:html$$module$radial`${b}`;return html$$module$radial` <g transform="rotate(${this.props.angle}, 0,0)">
      <animate
        id="${this.mainId}z"
        attributeName="opacity"
        begin="indefinite"
        dur="0.35s"
        from="0.0"
        restart="always"
        to="1.0"
        fill="freeze"
      />
      <animateTransform
        attributeName="transform"
        type="scale"
        additive="sum"
        from="0.5 0.5"
        restart="always"
        to="1 1"
        id="${this.mainId}"
        begin="indefinite"
        dur="0.35s"
      />
      <animate
        id="${this.mainId2}z"
        attributeName="opacity"
        begin="indefinite"
        restart="always"
        dur="0.35s"
        from="1.0"
        to="0.0"
        fill="freeze"
      />
      <animateTransform
        attributeName="transform"
        type="scale"
        restart="always"
        additive="sum"
        from="1 1"
        to="0.5 0.5"
        id="${this.mainId2}"
        begin="indefinite"
        dur="0.35s"
      />
      <g transform="translate(${Math.max(12,12*this.props.scale)})">
        <g transform="rotate(-${this.props.angle}, 0,0)">
          ${b}
          <title>${a.tooltip}</title>
        </g>
      </g></g
    >`}}class RadialMenu$$module$radial extends k$$module$libs$preact{constructor(a){super()}render(a,b){}}var module$radial={};module$radial.AnimateSvg=AnimateSvg$$module$radial;module$radial.RadialMenu=RadialMenu$$module$radial;module$radial.RadialMenuButton=RadialMenuButton$$module$radial;const html$$module$hexmenu=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),HexBitmask$$module$hexmenu={IS_HEX_AN_OCEAN:1,IS_HEX_OCCUPIED:2,IS_HEX_HAS_RIVER:4,IS_HEX_HAS_TRAIL:8,IS_HEX_COASTAL:16,IS_HEX_HAS_BORDER:32,IS_HEX_VALID_RIVER_SOURCE:64,IS_HEX_EXTENDING_REALM:128,IS_HEX_EXTENDING_REGION:256};function HiddenRadialMenuButton$$module$hexmenu(a){}function HexBiomeMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_mountains"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Mountains"+a.cls)}
      angle="0"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-mountains"
      tooltip="Roll an empty Mountains hex"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_forest"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Forest"+a.cls)}
      angle="51"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-forest"
      tooltip="Roll an empty Forest hex"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_plains"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Plains"+a.cls)}
      angle="102"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-plains"
      tooltip="Roll an empty Plains hex"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_desert"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Desert"+a.cls)}
      angle="153"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-desert"
      tooltip="Roll an empty Desert hex"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_jungle"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Jungle"+a.cls)}
      angle="204"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-jungle"
      tooltip="Roll an empty Jungle hex"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_swamps"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Swamps"+a.cls)}
      angle="255"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-swamps"
      tooltip="Roll an empty Swamps hex"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_tundra"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.appender("Tundra"+a.cls)}
      angle="306"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-tundra"
      tooltip="Roll an empty Tundra hex"
    />
  </g>`}function HexSettlementMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_city"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Settlement","City")}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-city"
      tooltip="Roll a new City"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_town"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Settlement","Town")}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-town"
      tooltip="Roll a new Town"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_village"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Settlement","Village")}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-village"
      tooltip="Roll a new Village"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_inn"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Inn","Inn")}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-inn"
      tooltip="Roll a new Inn"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_dwelling"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Residency","Residency")}
      angle="120"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-dwelling"
      tooltip="Roll a new Dwelling"
    />
  </g>`}function HexGeneratorMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_dungeon"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Dungeon","Dungeon")}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-dungeon"
      tooltip="Roll a new Dungeon"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_settlement"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRollSettlementMenu()}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-settlement"
      tooltip="Roll a new settlement"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_draw_river"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onDrawRiver(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_VALID_RIVER_SOURCE}
      icon="icon-river"
      tooltip="Roll a new River"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_realm"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendRealm()}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN}
      icon="icon-realm"
      tooltip="Roll a new Realm"
    />
    <${HiddenRadialMenuButton$$module$hexmenu}
      id="radial_button_roll_region"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRollRegionMenu()}
      angle="120"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM}
      icon="icon-region"
      tooltip="Roll a new empty Region in adjacent realm"
    />
    <${HiddenRadialMenuButton$$module$hexmenu}
      id="radial_button_roll_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick2=${()=>a.handler.onRollHexMenu()}
      onClick=${()=>a.handler.onAppendHex()}
      angle="180"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION}
      icon="icon-hex"
      tooltip="Roll a new empty Hex in adjacent region"
    />
  </g>`}function HexCleanupMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_clean_river"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onClearHexRiver(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-river"
      tooltip="Remove River"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_clean_trail"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onClearHexTrails(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-trail"
      tooltip="Rebuild Trails"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_reroll_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRerollHex(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-feature"
      tooltip="Reroll an Empty Hex (removes everything inside!)"
    />
  </g>`}function HexDeleteMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveHex(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_HAS_BORDER||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN&&a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_COASTAL}
      icon="icon-hex"
      tooltip="Delete Hex (coastlines or water only)"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_region"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveRegion(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-region"
      tooltip="Delete Region"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_realm"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveRealm(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-realm"
      tooltip="Delete the entire Realm!"
    />
  </g>`}function HexMainMenu$$module$hexmenu(a){return html$$module$hexmenu` <g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_trash"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onDeleteMenu(a.menu.uuid)}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_COASTAL))}
      icon="icon-trash"
      tooltip="Destroy hex or hexes (including everything on!)"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_broom"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRerollMenu(a.menu.uuid)}
      angle="180"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-broom"
      tooltip="Remove / Rebuild Features"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_dice"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendMenu(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-dice"
      tooltip="Roll new entities"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_remap"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemapEntity(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-remap"
      tooltip="Rearrange Realm Hex Map"
    />
  </g>`}class HexMenu$$module$hexmenu extends k$$module$libs$preact{constructor(){super()}componentWillUnmount(){window.app.sense_mode=!1}render(a){return 0==a.menu.type?html$$module$hexmenu` <${HexMainMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:1==a.menu.type?html$$module$hexmenu` <${HexGeneratorMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:4==a.menu.type?html$$module$hexmenu` <${HexSettlementMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:5==a.menu.type?html$$module$hexmenu` <${HexBiomeMenu$$module$hexmenu}
          menu=${a.menu}
          appender=${b=>a.handler.onAppendRegion(b)}
          cls="Region"
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:6==a.menu.type?html$$module$hexmenu` <${HexBiomeMenu$$module$hexmenu}
          menu=${a.menu}
          appender=${b=>a.handler.onAppendHex(b)}
          cls="Hex"
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:2==a.menu.type?html$$module$hexmenu` <${HexCleanupMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:3==a.menu.type?html$$module$hexmenu` <${HexDeleteMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:html$$module$hexmenu``}}var module$hexmenu={};module$hexmenu.HexBitmask=HexBitmask$$module$hexmenu;module$hexmenu.HexMenu=HexMenu$$module$hexmenu;const html$$module$SvgMap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function easeInOutSine$$module$SvgMap(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b}function easeInOutCubic$$module$SvgMap(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b}function isTouchDevice$$module$SvgMap(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}
class SvgMap$$module$SvgMap extends k$$module$libs$preact{constructor(){super();this.state={offset:{x:10,y:10},dim:{w:1500,h:1500},drag:!1};this.predrag=this.drag=!1;this.factor=.1;this.oy=this.ox=0;this.inhibit_pointer_events=this.minimap=!1;this.sizeToFit=this.sizeToFit.bind(this)}sizeToFit(){var a=document.getElementById("canvas");if(a)if(this.width){var b=this.width;const c=this.height;this.width=a.getBoundingClientRect().width||1;this.height=a.getBoundingClientRect().height||1;a=this.state.dim.w/
b;const d=this.state.dim.h/c,e={w:this.width*a,h:this.height*d};this.setState({dim:e,offset:{x:this.state.offset.x-(this.width-b)*a/2,y:this.state.offset.y-(this.height-c)*d/2},zoom_factor:this.width*this.height/(e.w*e.h)})}else this.width=a.getBoundingClientRect().width||1,this.height=a.getBoundingClientRect().height||1,b={w:this.state.dim.w,h:this.height/this.width*this.state.dim.w},this.setState({dim:b,zoom_factor:this.width*this.height/(b.w*b.h)})}clientToCanvasCoords(a){let b=document.getElementById("canvas"),
c=b.createSVGPoint();c.x=a.clientX;c.y=a.clientY;return c.matrixTransform(b.getScreenCTM().inverse())}componentDidMount(a,b,c){let d=this;if(!this.minimap){var e=document.getElementById("canvas");if(e){(new ResizeObserver(this.sizeToFit)).observe(e);e.addEventListener("dblclick",function(n){0!=n.button||d.touch_is_on||d.camera_moving||d.inhibit_pointer_events||(d.state.menu||(window.app.sense_mode=!1),d.ox=n.offsetX,d.oy=n.offsetY,d.tmp=d.state.offset,window.app.tokens&&!window.app.kill_hotkey_mode&&
window.app.selected_token&&(n=window.app.tokens[window.app.selected_token.uuid].get(window.app.selected_token.tuid),setTokenData$$module$battlemap(n.tuid,{x:n.x,y:n.y,l:n.light,t:n.tid,r:n.r,pc:n.pc,u:n.tuid,d:n.uuid,no_base:n.no_base,c:8>n.c?n.c+1:0})))});e.addEventListener("pointerdown",function(n){0!=n.button||d.touch_is_on||d.camera_moving||d.inhibit_pointer_events||(d.state.menu||(window.app.sense_mode=!1),d.predrag=!0,d.setState({drag:!0}),d.ox=n.offsetX,d.oy=n.offsetY,d.tmp=d.state.offset,
window.app.tokens&&!window.app.kill_hotkey_mode&&window.app.selected_token&&(n=d.clientToCanvasCoords(n),d.drag=!1,d.setState({drag:!1}),d.token_move={cp:n,t_uuid:window.app.selected_token.uuid,tuid:window.app.selected_token.tuid}))});e.addEventListener("pointermove",function(n){if(!window.app.sense_mode&&!d.camera_moving&&!d.inhibit_pointer_events)if(d.predrag&&(d.drag=!0),d.drag)if(window.app.inhibit_click=!0,d.token_move){var t=d.token_move.cp,w=d.clientToCanvasCoords(n);n=w.x-t.x;var z=w.y-t.y;
t=window.app.tokens[d.token_move.t_uuid].get(d.token_move.tuid);n={x:t.x+=n,y:t.y+=z,l:t.light,t:t.tid,r:t.r,pc:t.pc,u:t.tuid,d:t.uuid,no_base:t.no_base,c:t.c};setTokenData$$module$battlemap(t.tuid,n);d.setState({drag:!1});d.token_move.cp=w}else window.app.last_selected&&(window.app.last_selected.setState({class:"baseout"}),window.app.last_selected=null),w=n.offsetX-d.ox,n=n.offsetY-d.oy,t=e.getBoundingClientRect().width||1,z=e.getBoundingClientRect().height||1,d.setState({offset:{x:d.tmp.x-d.state.dim.w/
t*w,y:d.tmp.y-d.state.dim.h/z*n},menu:!1});else window.app.inhibit_click=!1},{passive:!0});document.addEventListener("mouseup",function(n){d.token_move=!1;d.drag&&(d.setState({drag:!1}),d.drag=!1);d.predrag=!1},{passive:!0});document.addEventListener("onClick",function(n){window.app.inhibit_click&&(window.app.inhibit_click=!1,n.stopPropagation())},{passive:!0});var g=Date.now();e.addEventListener("wheel",function(n){if(window.app.tokens&&(d.clientToCanvasCoords(n),window.app.selected_token)){var t=
window.app.tokens[window.app.selected_token.uuid].get(window.app.selected_token.tuid);if(d.props.vtt&&t.pc||!d.props.vtt){var w=0<n.deltaY?1:-1;n={l:t.light,t:t.tid,x:t.x,y:t.y,r:t.r+=15*w,pc:t.pc,u:t.tuid,d:t.uuid,no_base:t.no_base,c:t.c};setTokenData$$module$battlemap(t.tuid,n);d.setState({drag:!1});return}}d.stopCamera();d.props.hex_uuid&&!d.props.vtt&&$$$module$libs$preact_router_module("/sandbox/"+d.props.instance);if(!(d.inhibit_pointer_events||(t=Date.now(),n.stopPropagation(),w=0<n.deltaY?
1:-1,-1==w&&1E7<d.state.zoom_factor||1==w&&.1>d.state.zoom_factor))){t=1-(t-g)/1E3*10;.7<t&&(t=.7);.2>t&&(t=.2);w=1+t*w;t=n.offsetX*w-n.offsetX;n=n.offsetY*w-n.offsetY;var z=e.getBoundingClientRect().width||1,C=e.getBoundingClientRect().height||1,H=z*C/(C/z*w*d.state.dim.w*w*d.state.dim.w);d.setState({offset:{x:d.state.offset.x-d.state.dim.w/z*t,y:d.state.offset.y-d.state.dim.h/C*n},dim:{w:d.state.dim.w*w,h:d.state.dim.h*w},zoom_factor:H,res:d.getResPrefix(H)});return!0}},{passive:!0});a=n=>{var t;
const w=z=>Math.hypot(z.touches[0].pageX-z.touches[1].pageX,z.touches[0].pageY-z.touches[1].pageY);n.addEventListener("touchstart",z=>{d.stopCamera();d.inhibit_pointer_events=!1;1===z.touches.length&&(d.touch_is_on=!0,z.preventDefault(),d.drag=!0,d.ox=z.touches[0].pageX,d.oy=z.touches[0].pageY,d.tmp=d.state.offset);2===z.touches.length&&(z.preventDefault(),d.inhibit_pointer_events=!0,t=w(z))},{passive:!0});n.addEventListener("touchmove",z=>{if(2===z.touches.length){z.preventDefault();let L;L=z.scale?
z.scale:w(z)/t;.9>L&&(L=.95);1.1<L&&(L=1.05);L=1/L;var C=[(z.touches[0].pageX+z.touches[1].pageX)/2,(z.touches[0].pageY+z.touches[1].pageY)/2];z=C[0]*L-C[0];C=C[1]*L-C[1];var H=e.getBoundingClientRect().width||1,M=e.getBoundingClientRect().height||1;const O=H*M/(d.state.dim.w*L*d.state.dim.h*L);1>L&&1E7<d.state.zoom_factor||1<L&&.1>d.state.zoom_factor||d.setState({offset:{x:d.state.offset.x-d.state.dim.w/H*z,y:d.state.offset.y-d.state.dim.h/M*C},dim:{w:d.state.dim.w*L,h:d.state.dim.h*L},zoom_factor:O,
res:d.getResPrefix(O)})}});n.addEventListener("touchend",z=>{d.touchinterval=window.setTimeout(function(){},500);n.style.transform="";n.style.WebkitTransform="";n.style.zIndex=""})};isTouchDevice$$module$SvgMap()&&a(e)}}}getResPrefix(a){let b="";20>a&&(b="low-");2>a&&(b="empty-");return b}waypoint(a,b,c,d,e,g=null){window.clearInterval(this.interval);let n=this.state.offset.x,t=this.state.offset.y,w=this.state.dim.w,z=this.state.dim.h,C=0,H=this;const M=10*e;this.camera_moving=!0;let L=document.getElementById("canvas");
this.interval=window.setInterval(function(){const O=H.height/H.width;var S=c*O,T=a-n-c/2,P=b-t-S/2,W=c-w;S-=z;C++;let Z=easeInOutSine$$module$SvgMap;T=Z(10*C,n,T,M);P=Z(10*C,t,P,M);W=Z(10*C,w,W,M);S=Z(10*C,z,S,M);this.width=L.getBoundingClientRect().width||1;this.height=L.getBoundingClientRect().height||1;H.setState({offset:{x:T,y:P},dim:{w:W,h:W*O},zoom_factor:H.width*H.height/(W*S),col1:"rect1",res:H.getResPrefix(H.width*H.height/(W*S))});C==e&&(H.stopCamera(),g&&g())},10)}stopCamera(){window.clearInterval(this.interval);
this.camera_moving=!1}minimapOnLocation(a,b,c,d){const e=Math.abs(this.state.dim.w-c);if(20>Math.hypot(this.state.offset.x-a,this.state.offset.y-b)||20<e||200>this.state.zoom_factor)this.waypoint(a,b,c,d,50);else{let g=this;this.waypoint(a,b,100*c,100*d,100,function(){g.waypoint(a,b,c,d,100)})}}}var module$SvgMap={};module$SvgMap.SvgMap=SvgMap$$module$SvgMap;const html$$module$settlements=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
var thickLineToPolygon$$module$settlements=function(){function a(b,c,d,e){c=(c.y-b.y)/(c.x-b.x);e=(e.y-d.y)/(e.x-d.x);if(c!==e)return b=b.y-c*b.x,d=(b-(d.y-e*d.x))/(e-c),{x:d,y:c*d+b}}return function(b,c){for(var d,e,g=[],n,t,w,z,C,H,M,L,O,S=0,T=b.length-1;S<T;S++)n=!S,t=S===b.length-2,d=b[S],L=b[S+1],M=L.x-d.x,d=L.y-d.y,L=c/(2*Math.sqrt(M*M+d*d)),d*=-L,e=L*M,M={x:b[S].x+d,y:b[S].y+e},L={x:b[S+1].x+d,y:b[S+1].y+e},O={x:b[S].x-d,y:b[S].y-e},d={x:b[S+1].x-d,y:b[S+1].y-e},n||((C=a(w[0],w[1],M,L))&&g.unshift(C),
(H=a(z[0],z[1],O,d))&&g.push(H)),n&&(g.unshift(M),g.push(O)),t&&(g.unshift(L),g.push(d)),t||(w=[M,L],z=[O,d]);return g}}();function coordsToPoints$$module$settlements(a){let b=[];for(let c=0;c<a.length;c++)b.push({x:a[c][0],y:a[c][1]});return b}function pointsToCoords$$module$settlements(a){let b=[];for(let c=0;c<a.length;c++)b.push([a[c].x,a[c].y]);return b}
function makeSmoothPolygon$$module$settlements(a){a.push(a[0]);a=turf.polygonSmooth(turf.polygon([a]),{iterations:3});let b="";turf.featureEach(a,(c,d)=>{c=turf.getCoords(turf.getGeom(c))[0];b="M "+c[0][0]+" "+c[0][1]+" ";for(d=1;d<c.length;d++)b=b+"L "+c[d][0]+" "+c[d][1]+" ";b+="Z"});return b}function makePolygon$$module$settlements(a){let b="M "+a[0][0]+" "+a[0][1]+" ";for(let c=1;c<a.length;c++)b=b+"L "+a[c][0]+" "+a[c][1]+" ";return b+"Z"}
function makePath$$module$settlements(a){let b="M "+a[0][0]+" "+a[0][1]+" ";for(let c=1;c<a.length;c++)b=b+"L "+a[c][0]+" "+a[c][1]+" ";return b}function makeCurvedPath$$module$settlements(a){let b="M "+a[0][0]+" "+a[0][1]+" ";for(let c=1;c<a.length;c++)b=b+"L "+a[c][0]+" "+a[c][1]+" ";return b}
function makePolygonFromLine$$module$settlements(a,b){a=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),b));b="M "+a[0][0]+" "+a[0][1]+" ";for(let c=1;c<a.length;c++)b=b+"L "+a[c][0]+" "+a[c][1]+" ";return b+"Z"}
function makeSmoothPolygonFromLine$$module$settlements(a,b){a=a.slice();b=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),b));b.push(b[0]);b=turf.polygon([b]);return makeSmoothPolygon$$module$settlements(b.geometry.coordinates[0])}
function makeMergedPolygon$$module$settlements(a,b,c){a=a.slice();b[0].push(b[0][0]);b=turf.polygon(b);const d=turf.centerOfMass(b).geometry.coordinates;a.unshift(d);c=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),c));c.push(c[0]);c=turf.polygon([c]);c=turf.union(b,c);return makeSmoothPolygon$$module$settlements(c.geometry.coordinates[0])}
class Marker$$module$settlements extends k$$module$libs$preact{constructor(){super();this.setState({hover:"",radius:3})}mouseover(){this.setState({hover:"marker-label-hover",radius:7})}mouseout(){this.setState({hover:"",radius:3})}getLocationURL(){return"/sandbox/"+this.props.instance+"/location/"+this.props.uuid}render(a,b){let c=5E4>a.zoom_factor?1:Math.sqrt(5E4)/Math.sqrt(a.zoom_factor);c=.3>c?.3:c;const d=""!=b.hover?html$$module$settlements`
            <g
              id="active-poi-label"
              transform="translate( ${a.coords.x} , ${a.coords.y}) rotate(${-1*a.rotate})"
            >
              <text
                transform="translate( 0, ${-20*c}) scale(${c})"
                class="marker-label ${b.hover}"
                font-size="0.8em"
                text-anchor="middle"
              >
                ${a.title}
              </text>
            </g>
          `:html$$module$settlements``;return html$$module$settlements`
      ${d}

      <g
        transform="translate( ${a.coords.x} , ${a.coords.y}) rotate(${-1*a.rotate})"
      >
        <circle
          class="marker-circle"
          transform="scale(${c})"
          r="${b.radius}"
          fill="${a.uuid==a.location?"#00ff00":"#ff0000"}"
        >
        </circle>
        <a href="${this.getLocationURL()}">
          <circle
            transform="scale(${c})"
            opacity="0"
            cursor="pointer"
            r="${2*b.radius}"
            onmouseover="${()=>{this.mouseover()}}"
            onmouseout="${()=>{this.mouseout()}}"
          >
          </circle
        ></a>
      </g>
    `}}var module$settlements={};module$settlements.Marker=Marker$$module$settlements;module$settlements.makeCurvedPath=makeCurvedPath$$module$settlements;module$settlements.makeMergedPolygon=makeMergedPolygon$$module$settlements;module$settlements.makePath=makePath$$module$settlements;module$settlements.makePolygon=makePolygon$$module$settlements;module$settlements.makeSmoothPolygon=makeSmoothPolygon$$module$settlements;module$settlements.makeSmoothPolygonFromLine=makeSmoothPolygonFromLine$$module$settlements;const html$$module$citymap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function Towers$$module$citymap(a){if(!(2>a.coords.length))return html$$module$citymap`
    ${a.coords.map(b=>html$$module$citymap` <circle cx="${b[0]}" cy="${b[1]}" r=${8} fill="#292929" /> `)};
  `}class Wall$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makePath$$module$settlements(a.coords)}"
        stroke="#292929"
        stroke-width="8"
        fill="none"
    /></g>`}}class Estuary$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g>
      <path
        d="${makeMergedPolygon$$module$settlements(a.river,a.water,a.river_width)}"
        fill=${window.app.theme.river_main_color}
        stroke=${window.app.theme.river_main_color}
        stroke-width="10"
        fill=${window.app.theme.river_main_color}
      />
      <path
        d="${makeMergedPolygon$$module$settlements(a.river,a.water,a.river_width)}"
        stroke=${window.app.theme.river_flow_color}
        stroke-width="2"
        fill=${window.app.theme.river_main_color}
      />
    </g>`}}class River$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){const b=a.coords.slice();return html$$module$citymap`<g>
      <path
        d="${makeSmoothPolygonFromLine$$module$settlements(b,a.width)}"
        fill=${window.app.theme.river_main_color}
        stroke="none"
      />
      <path
        d="${makeSmoothPolygonFromLine$$module$settlements(b,.8*a.width)}"
        stroke=${window.app.theme.river_flow_color}
        stroke-width="1"
        fill="none"
      />
    </g>`}}function Square$$module$citymap(a){return html$$module$citymap`<g
    ><path d="${makePolygon$$module$settlements(a.coords[0])}" fill="#00000022"
  /></g>`}class Building$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){if(!(4>a.coords[0].length))return 2==a.coords.length&&a.coords[1]?html$$module$citymap`
          <circle
            cx="${a.coords[0][0][0]}"
            cy="${a.coords[0][0][1]}"
            r="12"
            fill="#ff0000"
          />
        `:html$$module$citymap``,html$$module$citymap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#181818"
        stroke-width="1"
        fill="#22222299"
    /></g>`}}class Water$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g>
      <path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke=${window.app.theme.river_main_color}
        stroke-width="8"
        fill="none"
      />
      <path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke=${window.app.theme.river_flow_color}
        stroke-width="2"
        fill=${window.app.theme.river_main_color}
      />
    </g>`}}
class InnerCityMap$$module$citymap extends k$$module$libs$preact{constructor(){super();this.setState({watabou:null})}fetch_map(a,b,c=!1){const d=window.app.settlements_cache[this.props.uuid];d&&!c&&this.setState({watabou:d.map_data,poi:d.poi});api_call_city$$module$api_shim(a,b).then(e=>{e.map_data.processed_walls=this.preprocess_walls(e.map_data);this.setState({watabou:e.map_data,poi:e.poi});window.app.settlements_cache[this.props.uuid]=e})}componentDidMount(a,b,c){this.fetch_map(this.props.instance,this.props.hex)}componentWillUpdate(a,
b,c){this.props.uuid==a.uuid&&this.props.location==a.location||this.fetch_map(a.instance,a.hex,!0)}preprocess_walls(a){if(!a)return[];let b=[],c=[],d=[],e=[];if("mfcg"!=a.features[0].generator)return[];0<a.features[4].geometries.length&&(d=d.concat(a.features[4].geometries[0].coordinates));a.features[13]&&(c=c.concat(a.features[13].coordinates[0][0]));0<a.features[2].geometries.length&&a.features[2].geometries.map(n=>{e=e.concat(n.coordinates)});a.features[3].geometries.map(n=>{n=n.coordinates[0];
let t=[],w=null;for(const z of n){let C=0;for(const H of c)if(z[0]==H[0]&&z[1]==H[1]&&(C++,1==C)){w=z;break}1!=C?(0==t.length&&w&&(t=[w]),t.push(z)):(t.push(z),1<t.length&&b.push(t),t=[])}t.push(n[0]);b.push(t)});let g=[];b.map(n=>{let t=[],w=n[n.length-1];for(let H=0;H<n.length;H++){const M=n[H];var z=H==n.length-1?n[0]:n[H+1],C=!1;let L=0;for(const O of d)if(M[0]==O[0]&&M[1]==O[1]){C=!0;L=.2;break}for(const O of e)if(M[0]==O[0]&&M[1]==O[1]){L=.1;C=!0;break}C?(C=L*z[0]+(1-L)*M[0],z=L*z[1]+(1-L)*
M[1],t.push([L*w[0]+(1-L)*M[0],L*w[1]+(1-L)*M[1]]),g.push(t),t=[[C,z]]):t.push(M);w=M}g.push(t)});return g}render(a,b){if(!b.watabou||"mfcg"!=b.watabou.features[0].generator)return html$$module$citymap``;const c=b.watabou.features[0].coast_dir||0,d=void 0!==b.watabou.features[0].coast_dir?-900:0,e=b.watabou.features[0].riverWidth;let g=html$$module$citymap``;0<b.watabou.features[4].geometries.length&&13<b.watabou.features.length?g=html$$module$citymap` <${Estuary$$module$citymap}
        river=${b.watabou.features[4].geometries[0].coordinates}
        water=${b.watabou.features[13].coordinates[0]}
        river_width=${b.watabou.features[0].riverWidth}
      />`:0<b.watabou.features[4].geometries.length?g=html$$module$citymap`
        ${b.watabou.features[4].geometries.map(w=>html$$module$citymap` <${River$$module$citymap}
            width=${e}
            coords=${w.coordinates}
          />`)}
      `:b.watabou.features[13]&&(g=html$$module$citymap`
        ${b.watabou.features[13].coordinates.map(w=>html$$module$citymap` <${Water$$module$citymap} coords=${w} />`)}
      `);const n=b.watabou.features[0].rotate_river,t=n?n:60*c;return html$$module$citymap`
      <defs>
        <radialGradient id="${a.hex}_gradient_alpha">
          <stop
            offset=${"City"==a.feature?"30%":"20%"}
            stop-color="white"
          />
          <stop
            offset=${"City"==a.feature?"45%":"30%"}
            stop-color="black"
          />
        </radialGradient>
      </defs>
      <mask id="${a.hex}">
        <polygon
          transform="scale(0.99)"
          fill="#ffffff"
          points="1000,-1800 -1000,-1800 -2000,000 -1000,1800 1000,1800 2000,0"
        />
      </mask>
      <polygon
        fill="transparent"
        points="500,-900 -500,-900 -1000,000 -500,900 500,900 1000,0"
        onClick=${w=>this.clicked(a.uuid,w)}
      />
      <g
        transform="scale(0.005 0.005) rotate(${t})"
        mask="url(#${a.hex})"
      >
        <mask id="${a.hex}_gradient_mask">
          <polygon
            transform="scale(${d?1.5:1}) translate(0,${.2*d})"
            fill="url('#${a.hex}_gradient_alpha')"
            points="1000,-1800 -1000,-1800 -2000,000 -1000,1800 1000,1800 2000,0"
          />
        </mask>
        <g
          transform="translate(0,${d})"
          mask="url(#${a.hex}_gradient_mask)"
        >
          ${b.watabou.features[8].coordinates.map(w=>html$$module$citymap` <${Square$$module$citymap} coords=${w} />`)}
          ${g}
          ${b.watabou.features[6].coordinates.map(w=>html$$module$citymap` <${Building$$module$citymap} coords=${w} />`)}
          <!--FIXME: This is too wasteful to loop through all the buildings.-->
          ${b.watabou.processed_walls.map(w=>html$$module$citymap` <${Wall$$module$citymap} coords=${w} />`)}
          ${b.watabou.processed_walls.map(w=>html$$module$citymap` <${Towers$$module$citymap} coords=${w} />`)}
          ${a.vtt||b.poi.map(w=>html$$module$citymap` <${Marker$$module$settlements}
              coords=${w.coords}
              uuid=${w.uuid}
              instance=${a.instance}
              title=${w.title}
              radius="4"
              rotate=${t}
              location=${a.location}
              zoom_factor=${a.zoom_factor/5}
            />`)}
          <use xlink:href="#active-poi-label" />
        </g>
      </g>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#333"
        stroke-width="0.5"
        fill="none"
      />
    `}clicked(a,b){if(window.app.inhibit_click)window.app.inhibit_click=!1;else if(a&&window.app.token_hotkey_mode&&window.app.vtt_referee){let c=document.getElementById("canvas"),d=c.createSVGPoint();d.x=b.clientX;d.y=b.clientY;b=d.matrixTransform(c.getScreenCTM().inverse());this.props.onToken(a,b)}else window.app.kill_hotkey_mode||this.props.onClick(a,window.app.hotkey_mode&&window.app.vtt_referee)}}
class CityMap$$module$citymap extends BaseBattleMap$$module$battlemap{constructor(){super();this.tokens_scale=.002}render(a,b){return html$$module$citymap`
      <${InnerCityMap$$module$citymap}
        id=${a.id}
        instance=${a.instance}
        hex=${a.hex}
        uuid=${a.uuid}
        location=${a.location}
        zoom_factor=${a.zoom_factor}
        uuid=${a.uuid}
        vtt=${a.vtt}
        onToken=${(c,d)=>{this.addToken(c,d)}}
        onClick=${()=>{}}
      />
      <${Tokens$$module$battlemap}
        uuid=${a.uuid}
        vtt=${a.vtt}
        tokens_scale=${this.tokens_scale}
      />
    `}}var module$citymap={};module$citymap.CityMap=CityMap$$module$citymap;function metaball$$module$metaballs(a){a.forEach(d=>d.c=[d.x,d.y]);let b="";for(let d=0;d<a.length;d++){var c=a.slice(0,3);a.push(a.shift());const e=curvesBetweenCircles$$module$metaballs(c[0].r,c[1].r,c[0].c,c[1].c);c=curvesBetweenCircles$$module$metaballs(c[1].r,c[2].r,c[1].c,c[2].c);0===d&&(b+=`M ${e.p[1][0]},${e.p[1][1]} `);b+=`C ${e.h[1][0]},${e.h[1][1]} ${e.h[3][0]},${e.h[3][1]} ${e.p[3][0]},${e.p[3][1]}`;b+=`A ${c.r1}, ${c.r1}, 1, 0, 1, ${c.p[1][0]}, ${c.p[1][1]}`}return b+"Z"}
function metablob$$module$metaballs(a,b){let c=[];for(let d=0;6>d;d++){const e=getVector$$module$metaballs([a.x,a.y],Math.PI/3*d,a.r*(.5*noise$$module$libs$perlin(b)+.5));c.push({x:e[0],y:e[1],r:1.5*noise$$module$libs$perlin(b*d)+a.r/2})}return metaball$$module$metaballs(c)}
function curvesBetweenCircles$$module$metaballs(a,b,c,d,e=2.4,g=.5){var n=Math.PI/2;const t=dist$$module$metaballs(c,d);var w=0,z=0;if(0===a||0===b||t<=Math.abs(a-b))return null;t<a+b&&(w=Math.acos((a*a+t*t-b*b)/(2*a*t)),z=Math.acos((b*b+t*t-a*a)/(2*b*t)));var C=angle$$module$metaballs(d,c),H=Math.acos((a-b)/t),M=C+w+(H-w)*g,L=C-w-(H-w)*g;w=C+Math.PI-z-(Math.PI-z-H)*g;C=C-Math.PI+z+(Math.PI-z-H)*g;z=getVector$$module$metaballs(c,M,a);c=getVector$$module$metaballs(c,L,a);H=getVector$$module$metaballs(d,
w,b);d=getVector$$module$metaballs(d,C,b);const O=a+b;e=Math.min(g*e,dist$$module$metaballs(z,H)/O)*Math.min(1,2*t/(a+b));g=a*e;e*=b;M=getVector$$module$metaballs(z,M-n,g);L=getVector$$module$metaballs(c,L+n,g);w=getVector$$module$metaballs(H,w+n,e);n=getVector$$module$metaballs(d,C-n,e);return{p:[z,c,H,d],h:[M,L,w,n],escaped:t>a,r:b,r1:a}}function dist$$module$metaballs([a,b],[c,d]){return((a-c)**2+(b-d)**2)**.5}function angle$$module$metaballs([a,b],[c,d]){return Math.atan2(b-d,a-c)}
function getVector$$module$metaballs([a,b],c,d){return[a+d*Math.cos(c),b+d*Math.sin(c)]}var module$metaballs={};module$metaballs.metaball=metaball$$module$metaballs;module$metaballs.metablob=metablob$$module$metaballs;const html$$module$villagemap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Road$$module$villagemap extends k$$module$libs$preact{render(){return html$$module$villagemap`<g>
      <path
        d="${makeCurvedPath$$module$settlements(this.props.coords)}"
        stroke="#333"
        stroke-width="2"
        fill="none"
    /></g>`}}class Tree$$module$villagemap extends k$$module$libs$preact{render(){const a=metablob$$module$metaballs({x:this.props.coords[0],y:this.props.coords[1],r:6},this.props.index);return html$$module$villagemap`
      <path d="${a}" stroke="#405040" fill="#475f47" stroke-width="0.75" />
    `}}class Buildings$$module$villagemap extends k$$module$libs$preact{render(){return html$$module$villagemap`
      ${this.props.buildings.map(a=>html$$module$villagemap`
          <g>
            <path
              d="${makePolygon$$module$settlements(a[0])}"
              stroke="#222"
              stroke-width="1"
              fill="#444444"
            />
          </g>
        `)}
    `}}
class Water$$module$villagemap extends k$$module$libs$preact{render(){let a=this.props.coords[0];this.props.coast&&0==this.props.index&&1==this.props.coords.length&&15<a.length&&(a[0][0]*=2,a[0][1]-=280,a[1][0]*=1.9,a[1][1]-=160,a[2][0]*=1.8,a[2][1]-=130,a[3][0]*=1.7,a[3][1]-=120,a[4][0]*=1.6,a[4][1]-=100,a[5][0]*=1.5,a[5][1]-=80,a[6][0]*=1.3,a[6][1]-=60,a[7][0]*=1.1,a[7][1]-=30,a[a.length-3][0]*=2,a[a.length-3][1]-=100,a[a.length-1][0]*=2.1,a[a.length-1][1]-=100,a[a.length-2][0]*=2.3,a[a.length-2][1]-=
100,this.props.coords.push([]));return html$$module$villagemap`<g>
      <path
        d="${makeSmoothPolygon$$module$settlements(a)}"
        stroke=${window.app.theme.river_main_color}
        stroke-width="4"
        fill=${window.app.theme.river_main_color}
      >
      </path>
      <path
        d="${makeSmoothPolygon$$module$settlements(a)}"
        stroke=${window.app.theme.river_flow_color}
        stroke-width="1"
        fill=${window.app.theme.river_main_color}
      >
      </path>
    </g>`}}class Square$$module$villagemap extends k$$module$libs$preact{render(){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(this.props.coords[0])}"
        stroke="#333"
        stroke-width="2"
        fill="#998877"
    /></g>`}}class Field$$module$villagemap extends k$$module$libs$preact{render(){return html$$module$villagemap`<g>
      <path d="${makeSmoothPolygon$$module$settlements(this.props.coords[0])}" fill="#596f39" />
      <path
        d="${makeSmoothPolygon$$module$settlements(this.props.coords[0])}"
        stroke="#506030"
        stroke-width="1"
        fill="url(#${this.props.hex}_diagonalHatch)"
    /></g>`}}
class InnerVillageMap$$module$villagemap extends k$$module$libs$preact{constructor(){super();this.state={watabou:null}}fetch_map(a,b,c=!1){const d=window.app.settlements_cache[this.props.uuid];d&&!c&&this.setState({watabou:d.map_data,poi:d.poi});api_call_city$$module$api_shim(a,b).then(e=>{this.setState({watabou:e.map_data,poi:e.poi});window.app.settlements_cache[this.props.uuid]=e})}componentWillMount(a,b,c){this.fetch_map(this.props.instance,this.props.hex)}componentWillUpdate(a,b,c){this.props.uuid==
a.uuid&&this.props.location==a.location||this.fetch_map(a.instance,a.hex,!0)}render(a,b){if(null===b.watabou||"vg"!=b.watabou.features[0].generator)return html$$module$villagemap``;const c=void 0!==b.watabou.features[0].coast_dir,d=b.watabou.features[0].coast_dir||0,e=void 0!==b.watabou.features[0].coast_dir?-600:0;let g=html$$module$villagemap``,n=html$$module$villagemap``,t=html$$module$villagemap``,w=html$$module$villagemap``;for(const C of b.watabou.features)"squares"==C.id&&(w=html$$module$villagemap`
          ${C.coordinates.map(H=>html$$module$villagemap` <${Square$$module$villagemap} coords=${H} />`)}
        `),"water"==C.id&&(g=html$$module$villagemap`
          ${[C.coordinates.at(-1)].map((H,M)=>html$$module$villagemap` <${Water$$module$villagemap}
              coast=${c}
              coords=${H}
              index=${M}
            />`)}
        `),"fields"==C.id&&(n=html$$module$villagemap`
          ${C.coordinates.map(H=>html$$module$villagemap` <${Field$$module$villagemap} coords=${H} hex=${a.hex} />`)}
        `),"trees"==C.id&&(t=html$$module$villagemap`
          ${C.coordinates.map((H,M)=>{if(0==M%8)return html$$module$villagemap` <${Tree$$module$villagemap} coords=${H} index=${M} />`})}
        `);const z=60*d;return html$$module$villagemap`
      <defs>
        <radialGradient id="${a.hex}_gradient_alpha">
          <stop offset="20%" stop-color="white" />
          <stop offset="23%" stop-color="black" />
        </radialGradient>
      </defs>

      <pattern
        id="${a.hex}_diagonalHatch"
        patternUnits="userSpaceOnUse"
        width="4"
        height="4"
      >
        <path
          d="M-1,1 l2,-2
           M0,4 l4,-4
           M3,5 l2,-2"
          style="stroke:#546633; stroke-width:1"
        />
      </pattern>

      <mask id="${a.hex}">
        <polygon
          fill="#ffffff"
          points="500,-900 -500,-900 -1000,000 -500,900 500,900 1000,0"
        />
      </mask>
      <g
        transform="scale(0.01 0.01) rotate(${z})"
        mask="url(#${a.hex})"
      >
        <mask id="${a.hex}_gradient_mask">
          <polygon
            transform="scale(${e?5:1})"
            fill="url('#${a.hex}_gradient_alpha')"
            points="500,-900 -500,-900 -1000,000 -500,900 500,900 1000,0"
          />
        </mask>
        <polygon
          fill="transparent"
          points="500,-900 -500,-900 -1000,000 -500,900 500,900 1000,0"
          onClick=${C=>this.clicked(a.uuid,C)}
        />
        <g
          transform="translate(0,${e})"
          mask="url(#${a.hex}_gradient_mask)"
        >
          ${g} ${n}
          ${b.watabou.features[5].geometries.map(C=>html$$module$villagemap` <${Road$$module$villagemap} coords=${C.coordinates} />`)}
          ${w}
          <${Buildings$$module$villagemap} buildings=${b.watabou.features[2].coordinates} />
          ${t}
          <!--FIXME: This is too wasteful to loop through all the buildings.-->
          ${a.vtt||b.poi.map(C=>html$$module$villagemap` <${Marker$$module$settlements}
              coords=${C.coords}
              uuid=${C.uuid}
              instance=${a.instance}
              title=${C.title}
              radius="2"
              rotate=${z}
              location=${a.location}
              zoom_factor=${a.zoom_factor}
            />`)}
          <use xlink:href="#active-poi-label" />
        </g>
      </g>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#333"
        stroke-width="0.5"
        fill="none"
      />
    `}clicked(a,b){if(window.app.inhibit_click)window.app.inhibit_click=!1;else if(a&&window.app.token_hotkey_mode&&window.app.vtt_referee){let c=document.getElementById("canvas"),d=c.createSVGPoint();d.x=b.clientX;d.y=b.clientY;b=d.matrixTransform(c.getScreenCTM().inverse());this.props.onToken(a,b)}else window.app.kill_hotkey_mode||this.props.onClick(a,window.app.hotkey_mode&&window.app.vtt_referee)}}
class VillageMap$$module$villagemap extends BaseBattleMap$$module$battlemap{constructor(){super();this.tokens_scale=.002}render(a,b){return html$$module$villagemap`
      <${InnerVillageMap$$module$villagemap}
        id=${a.id}
        instance=${a.instance}
        hex=${a.hex}
        uuid=${a.uuid}
        location=${a.location}
        zoom_factor=${a.zoom_factor}
        uuid=${a.uuid}
        vtt=${a.vtt}
        onToken=${(c,d)=>{this.addToken(c,d)}}
        onClick=${()=>{}}
      />
      <${Tokens$$module$battlemap}
        uuid=${a.uuid}
        vtt=${a.vtt}
        tokens_scale=${this.tokens_scale}
      />
    `}}var module$villagemap={};module$villagemap.VillageMap=VillageMap$$module$villagemap;const html$$module$dungeonmap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),kScale$$module$dungeonmap=.01,kScaleMultiplier$$module$dungeonmap=10*kScale$$module$dungeonmap;function getAreaMaskFillColor$$module$dungeonmap(a){return a.vtt?a.reveal?"#fff":"#000":window.app.hotkey_mode?a.reveal?"#fff":"#666":"#eee"}class DungeonEntrance$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,b){b=0;0==a.dir&&(b=180);3==a.dir&&(b=90);1==a.dir&&(b=270);return html$$module$dungeonmap`
      <g transform="translate(${10*a.x}, ${10*a.y})">
        <g transform="rotate(${b}, 5, 5)">
          <rect x="0" y="1" width="10" height="1" fill="#292828" />
          <rect x="1" y="3" width="8" height="1" fill="#292828" />
          <rect x="2" y="5" width="6" height="1" fill="#292828" />
          <rect x="3" y="7" width="4" height="1" fill="#292828" />
          <rect x="4" y="9" width="2" height="1" fill="#292828" />
        </g>
      </g>
    `}}class DungeonPortal$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,b){b=0;"S"==a.wall&&(b=180);"E"==a.wall&&(b=90);"W"==a.wall&&(b=270);if(0==a.type)return html$$module$dungeonmap`
        <g transform="translate(${10*a.x}, ${10*a.y})">
          <g transform="rotate(${b}, 5, 5)">
            <rect x="-1" y="5.5" width="12" height="3" fill="#292828" />
            <rect
              x="2"
              y="5"
              width="6"
              height="4"
              fill="#fff"
              stroke="#292828"
            />
            <title>${a.uuid}</title>
          </g>
        </g>
      `;if(!a.vtt)return html$$module$dungeonmap`
        <g transform="translate(${10*a.x}, ${10*a.y})">
          <g transform="rotate(${b}, 5, 5)">
            <rect x="-1" y="6.5" width="12" height="3" fill="#292828" />
            <text
              transform="translate(3, 9) rotate(90)"
              class="dcoords"
              alignment-baseline="baseline"
              text-anchor="middle"
              >S</text
            >
            <title>${a.uuid}</title>
          </g>
        </g>
      `}}
class DungeonPillars$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,b){if(50>a.w*a.h||1==a.w||1==a.h)return html$$module$dungeonmap``;b=[];if(a.w!=a.h)if(a.w<=a.h)for(var c=a.y+1;c<a.y+a.h;c++)b.push({x:10*(a.x+1),y:10*c}),b.push({x:10*(a.x+a.w-1),y:10*c});else for(c=a.x+1;c<a.x+a.w;c++)b.push({x:10*c,y:10*(a.y+1)}),b.push({x:10*c,y:10*(a.y+a.h-1)});return html$$module$dungeonmap`${b.map(d=>html$$module$dungeonmap` <circle cx="${d.x}" cy="${d.y}" r="2" fill="#212121" /> `)}`}}
class DungeonCavernLink$$module$dungeonmap extends TokenSurface$$module$battlemap{get_path(a){let b="M "+a[0].x+","+a[0].y+" ";for(let c=1;c<a.length;c++)b=b+"L "+a[c].x+","+a[c].y+" ";return b+" Z"}render(a,b){b=1==a.label_mode?html$$module$dungeonmap`
            <g transform="translate(${a.coords[0]} ${a.coords[1]})">
              <text
                transform="rotate(0)"
                class="dcoords"
                alignment-baseline="baseline"
                text-anchor="middle"
                >${a.number}</text
              >
            </g>
          `:2==a.label_mode&&a.hazard?html$$module$dungeonmap`
            <g transform="translate(${a.coords[0]} ${a.coords[1]})">
              <g>
                <path
                  fill="#333"
                  d="m-0.0171-4.27c-0.495 0.00238-0.991 0.113-1.44 0.326-0.645 0.314-1.36 0.792-1.47 1.56 5.31e-5 0.602 0.165 1.19 0.207 1.79 0.117 0.411-0.416 0.721-0.194 1.13 0.381 0.392 0.576 1.04 1.14 1.2 0.507 0.144 0.296 0.316 0.642 0.664 0.315 0.317 0.821 0.531 1.31 0.46 0.524-0.112 0.788-0.355 1.06-0.704 0.144-0.566 0.971-0.461 1.2-1.03 0.307-0.361 0.757-0.94 0.221-1.35 0.0289-0.708 0.183-1.4 0.227-2.11-0.0347-0.73-0.695-1.22-1.29-1.53-0.492-0.284-1.05-0.421-1.61-0.418zm-1.49 3.69c0.083 0.00119 0.166 0.016 0.244 0.0456 0.347 0.114 0.873 0.28 0.839 0.733-0.116 0.441-0.601 0.695-1.03 0.724-0.544 0.167-0.721-0.429-0.694-0.847-0.0783-0.411 0.282-0.662 0.642-0.657zm3.01 0.0243c0.102-0.00168 0.203 0.00525 0.299 0.0199 0.496 0.314 0.374 1.07 0.0195 1.45-0.552 0.113-1.48-0.199-1.44-0.887 0.211-0.403 0.675-0.572 1.12-0.579zm2.9 0.101c-0.277 0.00347-0.622 0.142-0.769 0.457-0.468 0.731-1.12 1.55-0.969 1.8 0.975-0.709 1.84-0.0859 2.08-0.526 0.214-0.406-0.458-0.699-0.00891-1.33 0.182-0.256-0.0355-0.406-0.33-0.402zm-8.84 0.0584c-0.281 0.00542-0.48 0.154-0.303 0.402 0.449 0.632-0.223 0.925-0.00891 1.33 0.232 0.44 1.1-0.183 2.08 0.526 0.151-0.25-0.501-1.07-0.969-1.8-0.152-0.324-0.514-0.462-0.795-0.456zm4.48 1.39c0.0676 0.00608 0.118 0.119 0.209 0.24 0.233 0.309 0.159 0.55-0.242 0.525-0.563-0.0355-0.402-0.153-0.228-0.464 0.128-0.229 0.202-0.307 0.261-0.301zm1.87 1.41c-0.582 0.0104-0.663 0.888-0.0568 1.04 0.945 0.228 0.125 0.787 0.838 0.778 0.713-0.0093 0.301-0.286 0.438-0.49 0.127-0.19 0.612-0.0972 0.454-0.517-0.159-0.42-0.564-0.158-0.943-0.322-0.319-0.0314-0.498-0.484-0.702-0.49-0.00951-3.01e-4 -0.0189-3.01e-4 -0.0281-2e-4zm-3.85 0.0584c-0.204 0.00598-0.383 0.459-0.702 0.49-0.378 0.164-0.784-0.0982-0.943 0.322-0.159 0.42 0.326 0.327 0.454 0.517 0.137 0.204-0.276 0.481 0.438 0.49 0.713 0.0093-0.107-0.55 0.838-0.778 0.616-0.157 0.523-1.06-0.0849-1.04z"
                />
              </g>
            </g>
          `:html$$module$dungeonmap``;b=html$$module$dungeonmap` <a onClick=${c=>this.clicked(a.uuid,c)}>
      <path d="${this.get_path(a.polygon)}" fill="transparent" />${b}</a
    >`;return html$$module$dungeonmap`<g>${b} </g>`}}
class DungeonCavern$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}make_line(a,b,c,d,e,g,n,t=!1,w=!1){let z=a=0,C=0;b!=d&&(a=5,z=(d-b)/5);c!=e&&(a=5,C=(e-c)/5);d="";for(t=t?0:1;t<=a-(w?0:1);t++)e=noise$$module$libs$perlin(this.inc),e*=1==t||t==a-1?.6:1.25,e*=0==t||t==a?.2:1.25,this.inc+=.2,d=d+" L "+(b+e*g+t*z)+","+(c+e*n+t*C);return d}get_path(a){if(this.cache&&a==this.cached_polygon)return this.cache;let b="M "+a[0].x+","+a[0].y+" ";for(let c=1;c<a.length;c++){const d=1<
a[c].c,e=1<a[c-1].c;if(e&&d){b=b+"L "+a[c].x+","+a[c].y+" ";continue}const g=[-1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,1];this.rvi=this.rvi==g.length-1?0:this.rvi+1;let n=g[this.rvi];this.rvi=this.rvi==g.length-1?0:this.rvi+1;b+=this.make_line(this.props,a[c-1].x,a[c-1].y,a[c].x,a[c].y,n,g[this.rvi],e,d)}b+=this.make_line(this.props,a[a.length-1].x,a[a.length-1].y,a[0].x,a[0].y,0,0);this.cache=b+" Z";this.cached_polygon=a;return this.cache}render(a,b){this.rvi=this.inc=0;b=getAreaMaskFillColor$$module$dungeonmap(a);
a=html$$module$dungeonmap`<path
      d="${this.get_path(a.polygon)}"
      stroke="${b}"
      stroke-width="1"
      fill="${b}"
    />`;return html$$module$dungeonmap`<g>${a} </g>`}}class DungeonArea$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}make_line(a,b,c,d,e,g,n){let t=0,w=0,z=0;b!=d&&(t=5*a.w,w=b>d?-2:2);c!=e&&(t=5*a.h,z=c>e?-2:2);a="";d=0;for(e=1;e<=t;e++){let C=noise$$module$libs$perlin(d);C*=2==e||e==t-2?1:1==e||e==t-1?.5:0==e||e==t?.3:2;d+=.3;a=a+" L "+(b+C*g+e*w)+","+(c+C*n+e*z)}return a}getPortalMask(a,b){return"E"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x}"
        y="${10*a.y-.2}"
        width="3"
        height="10.4"
        fill="${b}"
      />`:"W"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x+7}"
        y="${10*a.y-.2}"
        width="3"
        height="10.4"
        fill="${b}"
      />`:"N"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x-.2}"
        y="${10*a.y+7}"
        width="10.4"
        height="3"
        fill="${b}"
      />`:"S"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x-.2}"
        y="${10*a.y}"
        width="10.4"
        height="3"
        fill="${b}"
      />`:html$$module$dungeonmap``}get_path(a){const b=10*a.x+.25,c=b+10*a.w,d=10*a.y+.25,e=d+10*a.h;return this.cache="M "+b+","+d+this.make_line(a,b,d,c,d,0,-1)+this.make_line(a,c,d,c,e,1,0)+this.make_line(a,c,e,b,e,0,1)+this.make_line(a,b,e,b,d,-1,0)+" Z"}render(a,b){b=a.vbx-0;var c=a.vby-0,d=a.vby+a.vbh+0;if(!(a.x*kScaleMultiplier$$module$dungeonmap>a.vbx+a.vbw+0||a.y*kScaleMultiplier$$module$dungeonmap>d||a.x*kScaleMultiplier$$module$dungeonmap+a.w*kScaleMultiplier$$module$dungeonmap<b||a.y*
kScaleMultiplier$$module$dungeonmap+a.h*kScaleMultiplier$$module$dungeonmap<c)){b=getAreaMaskFillColor$$module$dungeonmap(a);c=html$$module$dungeonmap`<rect
      x="${10*a.x+.25}"
      y="${10*a.y+.25}"
      width="${10*a.w}"
      height="${10*a.h}"
      fill="${b}"
    />`;3==a.lod&&(c=html$$module$dungeonmap`<path d="${this.get_path(a)}" fill="${b}" />`);d=[];if(a.portals)for(const e of a.portals)0==e.type&&d.push(this.getPortalMask(e,b));return html$$module$dungeonmap`<g
      >${c}
      <${(a.reveal||!a.vtt)&&DungeonPillars$$module$dungeonmap}
        x=${a.x}
        y=${a.y}
        w=${a.w}
        h=${a.h}
      />
      ${d.map(e=>e)}
    </g>`}}}const vals$$module$dungeonmap=[{x:-1,y:0,r:.3},{x:-1,y:1,r:.6},{x:1,y:2,r:.2},{x:0,y:1,r:.4},{x:0,y:0,r:1},{x:1,y:2,r:.2},{x:-1,y:-1,r:.5},{x:0,y:0,r:.8},{x:2,y:1,r:.2},{x:0,y:0,r:.6},{x:0,y:0,r:1.3},{x:1,y:0,r:.9}];function DungeonCavernStains$$module$dungeonmap(a){let b=0;return html$$module$dungeonmap`
    ${a.polygon.map(c=>{let d=[];d.push(vals$$module$dungeonmap[b]);b=b==vals$$module$dungeonmap.length-1?0:b+1;d.push(vals$$module$dungeonmap[b]);b=b==vals$$module$dungeonmap.length-1?0:b+1;d.push(vals$$module$dungeonmap[b]);b=b==vals$$module$dungeonmap.length-1?0:b+1;d.push(vals$$module$dungeonmap[b]);b=b==vals$$module$dungeonmap.length-1?0:b+1;if(1==c.c&&1==Math.floor(Math.abs(c.x))%3)return html$$module$dungeonmap`${d.map(e=>html$$module$dungeonmap`<circle
            cx="${c.x+e.x}"
            cy="${c.y+e.y}"
            r="${e.r}"
            fill="#212121"
          />`)}`})}
  `}class DungeonAreaLink$$module$dungeonmap extends TokenSurface$$module$battlemap{render(a,b){b=a.vbx-0;const c=a.vby-0,d=a.vby+a.vbh+0;if(!(a.x*kScaleMultiplier$$module$dungeonmap>a.vbx+a.vbw+0||a.y*kScaleMultiplier$$module$dungeonmap>d||a.x*kScaleMultiplier$$module$dungeonmap+a.w*kScaleMultiplier$$module$dungeonmap<b||a.y*kScaleMultiplier$$module$dungeonmap+a.h*kScaleMultiplier$$module$dungeonmap<c))return b=html$$module$dungeonmap``,0!=a.t&&1==a.label_mode&&(b=html$$module$dungeonmap`
        <g
          transform="translate(${10*a.x+10*a.w/2} ${10*a.y+10*a.h/2+2})"
        >
          <text
            transform="rotate(0)"
            class="dcoords"
            alignment-baseline="baseline"
            text-anchor="middle"
            >${a.n}</text
          >
        </g>
      `),0!=a.t&&2==a.label_mode&&a.hazard&&(b=html$$module$dungeonmap`
        <g
          transform="translate(${10*a.x+10*a.w/2} ${10*a.y+10*a.h/2+2})"
        >
          <g>
            <path
              fill="#333"
              d="m-0.0171-4.27c-0.495 0.00238-0.991 0.113-1.44 0.326-0.645 0.314-1.36 0.792-1.47 1.56 5.31e-5 0.602 0.165 1.19 0.207 1.79 0.117 0.411-0.416 0.721-0.194 1.13 0.381 0.392 0.576 1.04 1.14 1.2 0.507 0.144 0.296 0.316 0.642 0.664 0.315 0.317 0.821 0.531 1.31 0.46 0.524-0.112 0.788-0.355 1.06-0.704 0.144-0.566 0.971-0.461 1.2-1.03 0.307-0.361 0.757-0.94 0.221-1.35 0.0289-0.708 0.183-1.4 0.227-2.11-0.0347-0.73-0.695-1.22-1.29-1.53-0.492-0.284-1.05-0.421-1.61-0.418zm-1.49 3.69c0.083 0.00119 0.166 0.016 0.244 0.0456 0.347 0.114 0.873 0.28 0.839 0.733-0.116 0.441-0.601 0.695-1.03 0.724-0.544 0.167-0.721-0.429-0.694-0.847-0.0783-0.411 0.282-0.662 0.642-0.657zm3.01 0.0243c0.102-0.00168 0.203 0.00525 0.299 0.0199 0.496 0.314 0.374 1.07 0.0195 1.45-0.552 0.113-1.48-0.199-1.44-0.887 0.211-0.403 0.675-0.572 1.12-0.579zm2.9 0.101c-0.277 0.00347-0.622 0.142-0.769 0.457-0.468 0.731-1.12 1.55-0.969 1.8 0.975-0.709 1.84-0.0859 2.08-0.526 0.214-0.406-0.458-0.699-0.00891-1.33 0.182-0.256-0.0355-0.406-0.33-0.402zm-8.84 0.0584c-0.281 0.00542-0.48 0.154-0.303 0.402 0.449 0.632-0.223 0.925-0.00891 1.33 0.232 0.44 1.1-0.183 2.08 0.526 0.151-0.25-0.501-1.07-0.969-1.8-0.152-0.324-0.514-0.462-0.795-0.456zm4.48 1.39c0.0676 0.00608 0.118 0.119 0.209 0.24 0.233 0.309 0.159 0.55-0.242 0.525-0.563-0.0355-0.402-0.153-0.228-0.464 0.128-0.229 0.202-0.307 0.261-0.301zm1.87 1.41c-0.582 0.0104-0.663 0.888-0.0568 1.04 0.945 0.228 0.125 0.787 0.838 0.778 0.713-0.0093 0.301-0.286 0.438-0.49 0.127-0.19 0.612-0.0972 0.454-0.517-0.159-0.42-0.564-0.158-0.943-0.322-0.319-0.0314-0.498-0.484-0.702-0.49-0.00951-3.01e-4 -0.0189-3.01e-4 -0.0281-2e-4zm-3.85 0.0584c-0.204 0.00598-0.383 0.459-0.702 0.49-0.378 0.164-0.784-0.0982-0.943 0.322-0.159 0.42 0.326 0.327 0.454 0.517 0.137 0.204-0.276 0.481 0.438 0.49 0.713 0.0093-0.107-0.55 0.838-0.778 0.616-0.157 0.523-1.06-0.0849-1.04z"
            />
          </g>
        </g>
      `),html$$module$dungeonmap`<a onClick=${e=>this.clicked(a.uuid,e)}
      ><rect
        x="${10*a.x}"
        y="${10*a.y}"
        width="${10*a.w}"
        height="${10*a.h}"
        fill="transparent"
      />
      ${b}
    </a>`}}function DungeonCaveMap$$module$dungeonmap(a){return html$$module$dungeonmap`
    <g transform="scale(${kScale$$module$dungeonmap}) rotate(0)">
      <g>
        <mask id="FilterMask">
          <rect
            x="-1000"
            y="-1000"
            width="2000"
            height="2000"
            filter="url(#noise)"
          />
        </mask>
        <${a.vtt&&TorchMask$$module$battlemap} uuid=${a.uuid} />
        <mask id="AreasMask${a.uuid}">
          <g mask="url(#LightMask${a.uuid})">
            ${a.dungeon.caverns.map(b=>html$$module$dungeonmap`<${DungeonCavern$$module$dungeonmap}
                lod="${a.lod}"
                reveal="${b.reveal}"
                polygon="${b.polygon}"
                offset=${a.offset}
                dim=${a.dim}
                vtt=${a.vtt}
              />`)}
          </g>
        </mask>
      </g>
      <!--g mask="url(#AreasMask)"-->
      <g mask="url(#AreasMask${a.uuid})">
        <rect x="-1000" y="-1000" width="2000" height="2000" fill="#d5d1ce" />
        <g>
          <rect
            class="cgrid"
            x="-1000"
            y="-1000"
            width="2000"
            height="2000"
            mask="url(#FilterMask)"
            fill="url(#grid)"
          />
        </g>
      </g>
      <g>
        ${a.dungeon.caverns.map(b=>html$$module$dungeonmap`<${DungeonCavernStains$$module$dungeonmap} polygon="${b.polygon}" />`)}
      </g>
      <g>
        ${a.vtt||a.dungeon.caverns.map(b=>html$$module$dungeonmap`<${DungeonCavernLink$$module$dungeonmap}
            onClick=${a.onClick}
            onToken=${a.onToken}
            uuid=${b.uuid}
            coords=${b.center}
            number=${b.n}
            hazard=${b.hazard}
            lod="${a.lod}"
            polygon="${b.polygon}"
            offset=${a.offset}
            dim=${a.dim}
            label_mode=${a.label_mode}
          />`)}
      </g>

      <g>
        ${a.vtt||a.dungeon.points.map(b=>html$$module$dungeonmap`<rect
            x=${b.x-3}
            y=${b.y-3}
            width="6"
            height="6"
            fill="#ff0000"
          />`)}
      </g>
    </g>
  `}function DungeonStructureMap$$module$dungeonmap(a){return html$$module$dungeonmap` <g transform="scale(${kScale$$module$dungeonmap}) rotate(0)">
    <g>
      <mask id="FilterMask">
        <rect
          x="-1000"
          y="-1000"
          width="2000"
          height="2000"
          filter="url(#noise)"
        />
      </mask>
      <${a.vtt&&TorchMask$$module$battlemap} uuid=${a.uuid} />
      <mask id="AreasMask${a.uuid}">
        <g mask="url(#LightMask${a.uuid})">
          ${a.dungeon.areas.map(b=>html$$module$dungeonmap`<${DungeonArea$$module$dungeonmap}
              lod="${a.lod}"
              x="${b.x}"
              y="${b.y}"
              w="${b.w}"
              h="${b.h}"
              portals="${b.portals}"
              passages="${b.passages}"
              reveal="${b.reveal}"
              vbx=${a.offset.x}
              vby=${a.offset.y}
              vbw=${a.dim.w}
              vbh=${a.dim.h}
              vtt=${a.vtt}
            />`)}
        </g>
      </mask>
    </g>
    <!--g mask="url(#AreasMask)"-->
    <g mask="url(#AreasMask${a.uuid})">
      <rect x="-1000" y="-1000" width="2000" height="2000" fill="#d5d1ce" />
      <g>
        <rect
          class="cgrid"
          x="-1000"
          y="-1000"
          width="2000"
          height="2000"
          mask="url(#FilterMask)"
          fill="url(#grid)"
        />
        ${a.details}
        ${a.dungeon.stairs.map(b=>html$$module$dungeonmap`<${DungeonEntrance$$module$dungeonmap}
            lod="${a.lod}"
            x="${b.x}"
            y="${b.y}"
            dir="${b.d}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
          />`)}
      </g>
      <g>
        ${a.vtt||a.dungeon.areas.map(b=>html$$module$dungeonmap`<${DungeonAreaLink$$module$dungeonmap}
            onClick=${a.onClick}
            onToken=${a.onToken}
            lod="${a.lod}"
            x="${b.x}"
            y="${b.y}"
            w="${b.w}"
            h="${b.h}"
            t="${b.t}"
            n="${b.n}"
            hazard=${b.hazard}
            duuid="${a.uuid}"
            uuid="${b.uuid}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
            label_mode=${a.label_mode}
          />`)}
      </g>
      <g>
        ${a.dungeon.portals.map(b=>html$$module$dungeonmap`<${DungeonPortal$$module$dungeonmap}
            lod="${a.lod}"
            x="${b.x}"
            y="${b.y}"
            wall="${b.wall}"
            type="${b.type}"
            uuid="${b.uuid}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
            vtt=${a.vtt}
          />`)}
      </g>
    </g>
  </g>`}
class DungeonMap$$module$dungeonmap extends BaseBattleMap$$module$battlemap{constructor(){super();this.sync_areas=!0;this.areaClicked=this.areaClicked.bind(this);this.cavernClicked=this.cavernClicked.bind(this);this.setState({show:!0,dungeon:{areas:[{x:10,y:10,w:50,h:50},{x:60,y:10,w:50,h:50},{x:10,y:70,w:50,h:50},{x:10,y:100,w:50,h:50},{x:200,y:20,w:50,h:50},{x:210,y:210,w:50,h:50}],portals:[]}});this.corners=[];this.uuid_to_coords={}}componentWillMount(a,b,c){this.request_map_data(this.props.hex);let d=
this;window.app.reroll_handlers.set("dungeon"+this.props.hex,async function(){await d.request_map_data(d.props.hex);window.app.yarray.set("reload",[d.props.uuid])});super.componentWillMount(a,b,c)}processStructureData(a){function b(d,e,g,n){let t=!1;for(let w of n.areas)if(w!=d&&(e>=w.x&&e<=w.x+w.w&&g==w.y||e>=w.x&&e<=w.x+w.w&&g==w.y+w.h||g>=w.y&&g<=w.y+w.h&&e==w.x||g>=w.y&&g<=w.y+w.h&&e==w.x+w.w)){t=!0;break}return!t}this.corners=[];this.uuid_to_coords={};let c=0;a.stairs=[];a.portals=[];for(let d of a.areas){d.portals&&
(a.portals=a.portals.concat(d.portals));void 0===d.uuid&&(d.uuid=c++);d.e&&a.stairs.push(d.e);this.setRevealByPeers(d);this.uuid_to_coords[d.uuid]=[10*d.x+10*d.w/2,10*d.y+10*d.h/2];if(b(d,d.x,d.y,a)){const e=d.x,g=d.y;this.corners.push({x:e,y:g,d:`M ${10*e}, ${10*g} L
              ${10*(e+1)}, ${10*g} C
              ${10*e+2},${10*g+2}
              ${10*e+2},${10*g+2} ${10*e},
              ${10*(g+1)} Z`,culler:function(n,t,w,z){return e*kScaleMultiplier$$module$dungeonmap>w||g*kScaleMultiplier$$module$dungeonmap>z||(e+1)*kScaleMultiplier$$module$dungeonmap<n||(g+1)*kScaleMultiplier$$module$dungeonmap<t}})}if(b(d,d.x+d.w,d.y,a)){const e=d.x+d.w,g=d.y;this.corners.push({x:e,y:g,d:`M ${10*e}, ${10*g} L
              ${10*(e-1)}, ${10*g} C
              ${10*e-2},${10*g+2}
              ${10*e-2},${10*g+2} ${10*e},
              ${10*(g+1)} Z`,culler:function(n,t,w,z){return(e-1)*kScaleMultiplier$$module$dungeonmap>w||g*kScaleMultiplier$$module$dungeonmap>z||e*kScaleMultiplier$$module$dungeonmap<n||(g+1)*kScaleMultiplier$$module$dungeonmap<t}})}if(b(d,d.x+d.w,d.y+d.h,a)){const e=d.x+d.w,g=d.y+d.h;this.corners.push({x:e,y:g,d:`M ${10*e}, ${10*g} L
              ${10*(e-1)}, ${10*g} C
              ${10*e-2},${10*g-2}
              ${10*e-2},${10*g-2} ${10*e},
              ${10*(g-1)} Z`,culler:function(n,t,w,z){return(e-1)*kScaleMultiplier$$module$dungeonmap>w||(g-1)*kScaleMultiplier$$module$dungeonmap>z||e*kScaleMultiplier$$module$dungeonmap<n||g*kScaleMultiplier$$module$dungeonmap<t}})}if(b(d,d.x,d.y+d.h,a)){const e=d.x,g=d.y+d.h;this.corners.push({x:e,y:g,d:`M ${10*e}, ${10*g} L
              ${10*(e+1)}, ${10*g} C
              ${10*e+2},${10*g-2}
              ${10*e+2},${10*g-2} ${10*e},
              ${10*(g-1)} Z`,culler:function(n,t,w,z){return e*kScaleMultiplier$$module$dungeonmap>w||(g-1)*kScaleMultiplier$$module$dungeonmap>z||(e+1)*kScaleMultiplier$$module$dungeonmap<n||g*kScaleMultiplier$$module$dungeonmap<t}})}}this.setState({dungeon:a});this.loaded=!0}processCaveData(a){a.points=[];this.uuid_to_coords={};let b=0;for(var c of a.caverns){var d=c.polygon;d.push(d[0]);turf.polygon([this.pointsToCoords(d)]);d=polylabel$$module$libs$polylabel([this.pointsToCoords(d)],1);c.center=
d;this.uuid_to_coords[c.uuid]=d;this.setRevealByPeers(c);for(d=0;d<c.polygon.length;d++){var e=c.polygon[d];if(1<e.c)continue;let g=c.polygon[0==d?c.polygon.length-1:d-1],n=c.polygon[d==c.polygon.length-1?0:d+1];c.polygon[d]={x:(e.x+(g.x+n.x)/2)/2,y:(e.y+(g.y+n.y)/2)/2};c.polygon[d].c=e.c}}c=[-1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,1];d=0;for(let g of a.caverns)for(e=0;e<g.polygon.length;e++)1==g.polygon[e].c&&(b+=.1,g.polygon[e].x+=2*noise$$module$libs$perlin(b)*c[d],d=d==
c.length-1?0:d+1,b+=.1,g.polygon[e].y+=2*noise$$module$libs$perlin(b)*c[d],d=d==c.length-1?0:d+1);this.setState({dungeon:a});this.loaded=!0}async request_map_data(a){api_call_dungeon$$module$api_shim(this.props.instance,a).then(b=>{void 0!==b.caverns?this.processCaveData(b):this.processStructureData(b);api_call_hazards$$module$api_shim(this.props.instance,a).then(c=>{for(let d of c.hazards)if(void 0!==this.state.dungeon.caverns)for(let e of this.state.dungeon.caverns)d.n==e.n&&(e.hazard=!0);else for(let e of this.state.dungeon.areas)d.n==
e.n&&(e.hazard=!0)})})}clickHandler(a,b,c){let d=this.state.dungeon;if(!window.app.vtt_referee||c)for(let e of a)e.uuid===b&&(e.reveal=!e.reveal,this.updatePeerOnReveal(e.uuid,e.reveal));this.setState({dungeon:d});c||this.uuid_to_coords[b]&&$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/location/"+b)}areaClicked(a,b=!1){this.clickHandler(this.state.dungeon.areas,a,b)}cavernClicked(a,b=!1){this.clickHandler(this.state.dungeon.caverns,a,b)}render(a,b){if(0==this.loaded)return html$$module$dungeonmap`
        <polygon
          points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
          stroke="#333"
          stroke-width="0"
          fill="#232121"
          style="stroke-width:0.2;"
        />
      `;noiseSeed$$module$libs$perlin(10);let c=3;5E4>a.zoom_factor&&(c=2);let d=html$$module$dungeonmap``;const e=a.offset.x-0,g=a.offset.y-0,n=a.offset.x+a.dim.w+0,t=a.offset.y+a.dim.h+0;if(1<c){let w="";3==c&&(w="filter: url(#displacementFilter)");d=html$$module$dungeonmap`<g opacity="0.3"
        >${this.corners.map(z=>{if(!z.culler(e,g,n,t))return html$$module$dungeonmap` <path
            transform=${3==c&&"translate(-0.5, -0.5)"}
            d="${z.d}"
            fill="#444444"
            style="${w}"
          />`})}
      </g>`}return html$$module$dungeonmap`
      <style>
        .cgrid {
          //filter: contrast(2.3);
        }
        .dcoords {
          font-size: 0.3em;
          font-family: 'Lakki Reddy';
          font-weight: bolder;
          paint-order: stroke;
          pointer-events: none;
          fill: #ddd;
          stroke: #333;
          stroke-width: 3px;
          stroke-linejoin: round;
        }
      </style>
      <filter id="noise" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence
          type="fractalNoise"
          baseFrequency="0.125"
          numOctaves="2"
          seed="15"
          stitchTiles="stitch"
          result="turbulence"
        ></feTurbulence>
        <feComponentTransfer>
          <feFuncR type="discrete" tableValues="0 0 1 1" />
          <feFuncG type="discrete" tableValues="2 2 0 0" />
          <feFuncB type="discrete" tableValues="0 0 1 1" />
        </feComponentTransfer>
      </filter>
      <filter id="displacementFilter">
        <feTurbulence
          type="turbulence"
          baseFrequency="0.5"
          numOctaves="2"
          result="turbulence"
        />
        <feDisplacementMap
          in2="turbulence"
          in="SourceGraphic"
          scale="3"
          xChannelSelector="R"
          yChannelSelector="G"
        />
      </filter>

      <defs>
        <radialGradient id="TorchGradient${a.uuid}">
          <stop offset="10%" stop-color="#ffffffff" />
          <stop offset="30%" stop-color="#ffffffff" />
          <stop offset="95%" stop-color="#ffffff00" />
        </radialGradient>
        <pattern
          id="smallGrid"
          width="5"
          height="5"
          patternUnits="userSpaceOnUse"
        >
          <path
            d="M 5 0 L 0 0 0 5"
            fill="none"
            stroke="#86817c"
            stroke-width="0.2"
          />
        </pattern>
        <pattern
          id="grid"
          overflow="visible"
          width="10"
          height="10"
          patternUnits="userSpaceOnUse"
        >
          <rect width="10" height="10" fill="url(#smallGrid)" />
          <path
            d="M 10 0 L 0 0 0 10"
            fill="none"
            stroke="#86817c"
            stroke-width="1"
          />
        </pattern>
      </defs>

      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#333"
        stroke-width="0.3"
        fill="#232121"
      />
      <${void 0!==b.dungeon.caverns?DungeonCaveMap$$module$dungeonmap:DungeonStructureMap$$module$dungeonmap}
        dungeon=${b.dungeon}
        onClick=${void 0!==b.dungeon.caverns?this.cavernClicked:this.areaClicked}
        onToken=${(w,z)=>this.addToken(w,z)}
        details=${d}
        uuid=${a.uuid}
        lod=${c}
        offset=${a.offset}
        dim=${a.dim}
        label_mode=${a.label_mode}
        vtt=${a.vtt}
      />
      <${Tokens$$module$battlemap}
        uuid=${a.uuid}
        vtt=${a.vtt}
        tokens_scale=${this.tokens_scale}
      />
    `}}var module$dungeonmap={};module$dungeonmap.DungeonMap=DungeonMap$$module$dungeonmap;const html$$module$hex=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function clamp$$module$hex(a,b,c){return Math.min(Math.max(a,b),c)}function getOffset$$module$hex(a,b,c=0,d=0){return[30*a+Math.abs(b)%2*15-c,10.4*b*Math.cos(Math.PI/6)-d]}function getHexCoords$$module$hex(a,b){b/=10.4*Math.cos(Math.PI/6);return[Math.floor(a/30+Math.abs(b)%2),Math.floor(b)]}
function intersects$$module$hex(a,b,c,d,e,g){a=Math.abs(a-(c+e/2));b=Math.abs(b-(d+g/2));return a>e/2+9||b>g/2+9?!1:a<=e/2||b<=g/2?!0:81>=(a-e/2)**2+(b-g/2)**2}class Borderline$$module$hex extends k$$module$libs$preact{constructor(a){super();this.cls="borderline_fixed"}render(a,b){"borderline"==this.cls?this.cls="borderline_fixed":"continent"==this.cls&&(this.cls="borderline");.5>a.zoom_factor&&(this.cls="continent");return html$$module$hex` <g
      ><polygon
        class="${this.cls}"
        strokeWidth="${.15*a.arm}"
        strokeLinecap="round"
        fill="transparent"
        color="#ff0000"
        stroke="${a.color}"
        points="${a.borders}"
      />
    </g>`}}function makeHex$$module$hex(a){const b=20.8*Math.cos(Math.PI/6),c=a[0]-10;a=a[1]-b/2+.16;return[[5+.1/Math.sqrt(3)+c,.1+a],[15-.1/Math.sqrt(3)+c,.1+a],[20-2/Math.sqrt(3)*.1+c,.5*b+a],[15-.1/Math.sqrt(3)+c,b-.1+a],[5+.1/Math.sqrt(3)+c,b-.1+a],[2/Math.sqrt(3)*.1+c,.5*b+a]].join()}function HexRiver$$module$hex(a){return 20<a.zoom_factor?html$$module$hex`
        <g opacity="${1-a.opacity}">
          <path
            d="${a.riverline}"
            stroke=${window.app.theme.river_edge_color}
            stroke-width="2.25"
            fill="none"
          />
          <path
            d="${a.riverline}"
            stroke=${window.app.theme.river_flow_color}
            stroke-width="1.75"
            stroke-dasharray="4 1 2 3 1 3 2 6 4 3 5 6 7 3 2 1 7 6 4 5 6 3 5 4 1 2 3 4"
            stroke-dashoffset="3"
            fill="none"
          >
            <animate
              id="p1"
              attributeName="stroke-dashoffset"
              begin="0.1s;f1.end+0.4s"
              values="2037;0"
              dur="1015s"
              calcMode="linear"
              repeatCount="indefinite"
            />
          </path>
          <path
            d="${a.riverline}"
            stroke=${window.app.theme.river_main_color}
            stroke-width="1.5"
            fill="none"
          />
        </g>
      `:html$$module$hex` <g opacity="${1-a.opacity}">
        <path
          d="${a.riverline}"
          stroke=${window.app.theme.river_main_color}
          stroke-width="2.25"
          fill="none"
        />
      </g>`}function HexTrail$$module$hex(a){return html$$module$hex` <g opacity="${1-a.opacity}">
    ${a.trailslines.map(b=>html$$module$hex`
        <path
          d="${b}"
          stroke=${window.app.theme.trail_color}
          stroke-width="1"
          stroke-linecap="round"
          stroke-dasharray="0 2"
          fill="none"
        />
      `)}
  </g>`}class BaseHex$$module$hex extends k$$module$libs$preact{isGenericMap(a){return!a||"Other"===a||"Inn"===a||"Residency"===a}getOffset(a=0,b=0){return getOffset$$module$hex(this.props.nx,this.props.ny,a,b)}getTranslation(a){return"translate("+a[0].toString()+", "+a[1].toString()+")"}}
class VttHex$$module$hex extends BaseHex$$module$hex{render(a){var b=getOffset$$module$hex(a.nx,a.ny);if(!(b[0]<this.props.ox-20||b[1]<this.props.oy-20||b[0]>this.props.ox+this.props.dimw+20||b[1]>this.props.oy+this.props.dimh+20)){this.t_poly=this.getTranslation(b);var c=clamp$$module$hex(a.zoom_factor/5E3,0,1),d=clamp$$module$hex((a.zoom_factor-2500)/5E3,0,1),e="empty-"==this.props.res?html$$module$hex``:html$$module$hex` <g opacity="${1-c}"
            ><use
              xlink:href="${window.app.theme.svg}#${this.props.res}${a.pod}"
              fill="${this.props.color}"
              transform="${this.t_poly}"
            />
          </g>`,g=1E3<a.zoom_factor?intersects$$module$hex(b[0],b[1],a.ox,a.oy,a.dimw,a.dimh):!1,n="City"!=a.feature&&"Town"!=a.feature||!g||"partial"==a.revealed?"Village"==a.feature&&g&&"partial"!=a.revealed?html$$module$hex` <g opacity="${c}" transform="${this.t_poly}">
              <${VillageMap$$module$villagemap}
                id=${a.feature_uuid}
                instance=${a.instance}
                hex=${a.uuid}
                zoff=${({x:b[0],y:b[1]})}
                uuid=${a.feature_uuid}
                location=${a.location_uuid}
                vtt="true"
                zoom_factor=${a.zoom_factor}
              />
            </g>`:html$$module$hex``:html$$module$hex` <g opacity="${c}" transform="${this.t_poly}">
            <${CityMap$$module$citymap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              zoff=${({x:b[0],y:b[1]})}
              feature=${a.feature}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
              vtt="true"
              zoom_factor=${a.zoom_factor}
            />
          </g>`,t="Dungeon"==a.feature&&1E3<a.zoom_factor&&g?html$$module$hex` <g opacity="${d}" transform="${this.t_poly}">
            <${DungeonMap$$module$dungeonmap}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              offset=${({x:a.ox-b[0],y:a.oy-b[1]})}
              zoff=${({x:b[0],y:b[1]})}
              dim=${({w:a.dimw,h:a.dimh})}
              zoom_factor=${a.zoom_factor}
              vtt="true"
              tokens=${a.tokens}
            />
          </g>`:html$$module$hex``;b=g&&1E3<a.zoom_factor&&this.isGenericMap(a.feature)?html$$module$hex` <g opacity="${d}" transform="${this.t_poly}">
            <${BattleMap$$module$battlemap}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.uuid}
              offset=${({x:a.ox-b[0],y:a.oy-b[1]})}
              zoff=${({x:b[0],y:b[1]})}
              dim=${({w:a.dimw,h:a.dimh})}
              zoom_factor=${a.zoom_factor}
              vtt="true"
              tokens=${a.tokens}
            />
          </g>`:html$$module$hex``;d=a.riverline&&html$$module$hex` <${HexRiver$$module$hex}
        riverline=${a.riverline}
        zoom_factor=${a.zoom_factor}
        opacity=${c}
      />`;c=a.trailslines&&"partial"!=a.revealed&&html$$module$hex` <${HexTrail$$module$hex}
        trailslines=${a.trailslines}
        opacity=${c}
      />`;return a.revealed&&""!=a.revealed?html$$module$hex` <use
            xlink:href="${window.app.theme.svg}#empty-${a.pod}"
            fill="${this.props.color}"
            transform="${this.t_poly}"
          />
          ${d}${e}${c}${n}${t}${b}`:html$$module$hex``}}}
class Hex$$module$hex extends BaseHex$$module$hex{clicked(a){a.preventDefault();window.app.inhibit_click?window.app.inhibit_click=!1:(this.props.menuHandler.onHexClicked(this.props.nx,this.props.ny,this.props.uuid,this.props.type,this),this.setState({class:"selected"}),window.app.last_selected&&window.app.last_selected.setState({class:"baseout"}),window.app.last_selected=this)}render(a){var b=getOffset$$module$hex(a.nx,a.ny);if(!(.5>a.zoom_factor||b[0]<this.props.ox-20||b[1]<this.props.oy-20||b[0]>
this.props.ox+this.props.dimw+20||b[1]>this.props.oy+this.props.dimh+20)){this.t_poly=this.getTranslation(b);var c=clamp$$module$hex(a.zoom_factor/5E3,0,1),d=clamp$$module$hex((a.zoom_factor-2500)/5E3,0,1),e="empty-"==this.props.res||html$$module$hex` <g opacity="${1-c}"
        ><use
          xlink:href="${window.app.theme.svg}#${this.props.res}${a.type}"
          fill="${this.props.color}"
          transform="${this.t_poly}"
        />
      </g>`,g=1E3<a.zoom_factor&&intersects$$module$hex(b[0],b[1],a.ox,a.oy,a.dimw,a.dimh),n=a.trailslines&&html$$module$hex` <${HexTrail$$module$hex}
        trailslines=${a.trailslines}
        opacity=${c}
      />`,t="City"!=a.feature&&"Town"!=a.feature||!g?"Village"==a.feature&&g?html$$module$hex` <g opacity="${c}" transform="${this.t_poly}">
              <${VillageMap$$module$villagemap}
                id=${a.feature_uuid}
                instance=${a.instance}
                zoff=${({x:b[0],y:b[1]})}
                hex=${a.uuid}
                uuid=${a.feature_uuid}
                location=${a.location_uuid}
                zoom_factor=${a.zoom_factor}
              />
            </g>`:html$$module$hex``:html$$module$hex` <g opacity="${c}" transform="${this.t_poly}">
            <${CityMap$$module$citymap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              zoff=${({x:b[0],y:b[1]})}
              feature=${a.feature}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
              zoom_factor=${a.zoom_factor}
            />
          </g>`,w="Dungeon"==a.feature&&1E3<a.zoom_factor&&g&&html$$module$hex` <g opacity="${d}" transform="${this.t_poly}">
        <${DungeonMap$$module$dungeonmap}
          instance=${a.instance}
          hex=${a.uuid}
          uuid=${a.feature_uuid}
          offset=${({x:a.ox-b[0],y:a.oy-b[1]})}
          zoff=${({x:b[0],y:b[1]})}
          dim=${({w:a.dimw,h:a.dimh})}
          zoom_factor=${a.zoom_factor}
          label_mode=${a.show_labels%3}
          tokens=${a.tokens}
        />
      </g>`;b=this.isGenericMap(a.feature)&&1E3<a.zoom_factor&&g&&html$$module$hex` <g opacity="${d}" transform="${this.t_poly}">
        <${BattleMap$$module$battlemap}
          instance=${a.instance}
          hex=${a.uuid}
          uuid=${a.uuid}
          offset=${({x:a.ox-b[0],y:a.oy-b[1]})}
          zoff=${({x:b[0],y:b[1]})}
          dim=${({w:a.dimw,h:a.dimh})}
          zoom_factor=${a.zoom_factor}
          label_mode=${a.show_labels%3}
          tokens=${a.tokens}
        />
      </g>`;c=a.riverline&&html$$module$hex` <${HexRiver$$module$hex}
        riverline=${a.riverline}
        zoom_factor=${a.zoom_factor}
        opacity=${c}
      />`;return html$$module$hex`<a onClick=${z=>this.clicked(z)}>
        <use
          xlink:href="${window.app.theme.svg}#empty-${a.type}"
          fill="#000"
          transform="${this.t_poly}"
        />
        ${c}${e}${n}
        ${a.show_hex_numbers&&html$$module$hex`
          <text
            dy="-5"
            class="cc-label"
            opacity="${a.hex_numbers_opacity}"
            transform="${this.t_poly}"
            font-size="0.1em"
          >
            ${a.cc}
          </text>
        `}
      </a>
      ${t}${w}${b}`}}}
class BaseHexMask$$module$hex extends k$$module$libs$preact{getOffset(a=0,b=0){return getOffset$$module$hex(this.props.nx,this.props.ny,a,b)}getTranslation(a){return"translate("+a[0].toString()+", "+a[1].toString()+")"}clicked(a){a.preventDefault();if(window.app.inhibit_click)window.app.inhibit_click=!1;else if(a=this.props.uuid,this.props.flag_hotkey_mode)this.props.menuHandler.onHexClicked(this.props.nx,this.props.ny,this.props.uuid,this.props.type,this);else{var b=window.app.yarray.get(a)&&"partial"==
window.app.yarray.get(a)[0],c=window.app.yarray.get(a)&&"reveal"==window.app.yarray.get(a)[0];window.app.hotkey_mode&&(window.app.yarray.set(a,[c?"":b?"reveal":"partial"]),saveState$$module$state(this.props.instance,"default"));this.forceUpdate()}}}
class HexMask$$module$hex extends BaseHexMask$$module$hex{render(a){var b=getOffset$$module$hex(a.nx,a.ny);if(!(.5>a.zoom_factor||b[0]<this.props.ox-20||b[1]<this.props.oy-20||b[0]>this.props.ox+this.props.dimw+20||b[1]>this.props.oy+this.props.dimh+20))return this.t_poly=this.getTranslation(b),b=window.app.yarray.get(a.uuid),html$$module$hex`
      <a
        style=${a.flag_hotkey_mode&&"pointer-events: none;"}
        id="${a.uuid}_hex_mask"
        onClick=${c=>this.clicked(c)}
      >
        <use
          xlink:href="${window.app.theme.svg}#${b&&"partial"==b[0]?"empty-partial-mask":b&&""!=b?"empty-no-mask":"empty-mask"}"
          transform="${this.t_poly}"
        />
      </a>
    `}}class SeaHexMask$$module$hex extends BaseHexMask$$module$hex{render(a){var b=getOffset$$module$hex(a.nx,a.ny,0,0);b="translate("+b[0].toString()+", "+b[1].toString()+")";a=window.app.yarray.get(a.uuid);return html$$module$hex`
      <a style=${""} onClick=${c=>this.clicked(c)}>
        <use xlink:href="${window.app.theme.svg}#${a&&"reveal"==a[0]?"ocean-revealed":a&&"partial"==a[0]?"ocean-masked-partial":"ocean-masked"}" transform="${b}" />
      </a>
    `}}class VttSeaHex$$module$hex extends BaseHex$$module$hex{render(a){const b=getOffset$$module$hex(a.nx,a.ny);if(!(b[0]<this.props.ox-20||b[1]<this.props.oy-20||b[0]>this.props.ox+this.props.dimw+20||b[1]>this.props.oy+this.props.dimh+20))return this.t_poly=this.getTranslation(b),(a=window.app.yarray.get(a.uuid))&&""!=a&&html$$module$hex`
        <use
          xlink:href="${window.app.theme.svg}#ocean"
          transform="${this.t_poly}"
        />
      `}}function sea_clicked$$module$hex(a,b){window.app.solo_mode&&window.app.map.map.map_data.mark_as_visited_by_coords(b.instance,b.nx,b.ny);a.preventDefault();if(window.app.inhibit_click)window.app.inhibit_click=!1;else b.menuHandler.onHexClicked(b.nx,b.ny,b.uuid,b.type,null)}function SeaHex$$module$hex(a){const b=getOffset$$module$hex(a.nx,a.ny,0,0);return html$$module$hex`
    <a onClick=${c=>sea_clicked$$module$hex(c,a)}>
      <polygon
        transform="${"translate("+b[0].toString()+", "+b[1].toString()+")"}"
        points="5 -9 -5 -9 -10 0 -5 9 5 9 10 0"
        fill=${window.app.theme.ocean_fill}
        stroke=${window.app.theme.ocean_stroke}
        stroke-width=".3"
      />
    </a>
  `}
class SoloHex$$module$hex extends BaseHex$$module$hex{clicked(a){a.preventDefault();window.app.inhibit_click?window.app.inhibit_click=!1:(this.props.menuHandler.onHexClicked(this.props.nx,this.props.ny,this.props.uuid,this.props.type,this),this.setState({class:"selected"}),window.app.last_selected&&window.app.last_selected.setState({class:"baseout"}),window.app.last_selected=this,window.app.map.map.map_data.mark_as_visited(this.props.instance,this.props.uuid))}render(a){var b=getOffset$$module$hex(a.nx,a.ny);
if(!(b[0]<this.props.ox-20||b[1]<this.props.oy-20||b[0]>this.props.ox+this.props.dimw+20||b[1]>this.props.oy+this.props.dimh+20)){this.t_poly=this.getTranslation(b);var c=clamp$$module$hex(a.zoom_factor/5E3,0,1),d=clamp$$module$hex((a.zoom_factor-2500)/5E3,0,1),e=window.app.map.map.map_data.is_visited(a.uuid),g="empty-"==this.props.res||html$$module$hex` <g opacity="${1-c}"
        ><use
          xlink:href="${window.app.theme.svg}#${this.props.res}${2==e?a.type:e}"
          fill="${this.props.color}"
          transform="${this.t_poly}"
        />
      </g>`,n=1E3<a.zoom_factor&&intersects$$module$hex(b[0],b[1],a.ox,a.oy,a.dimw,a.dimh),t=a.trailslines&&html$$module$hex` <${HexTrail$$module$hex}
        trailslines=${a.trailslines}
        opacity=${c}
      />`,w="City"!=a.feature&&"Town"!=a.feature||!n?"Village"==a.feature&&n?html$$module$hex` <g opacity="${c}" transform="${this.t_poly}">
              <${VillageMap$$module$villagemap}
                id=${a.feature_uuid}
                instance=${a.instance}
                zoff=${({x:b[0],y:b[1]})}
                hex=${a.uuid}
                uuid=${a.feature_uuid}
                location=${a.location_uuid}
                zoom_factor=${a.zoom_factor}
              />
            </g>`:html$$module$hex``:html$$module$hex` <g opacity="${c}" transform="${this.t_poly}">
            <${CityMap$$module$citymap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              zoff=${({x:b[0],y:b[1]})}
              feature=${a.feature}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
              zoom_factor=${a.zoom_factor}
            />
          </g>`,z="Dungeon"==a.feature&&1E3<a.zoom_factor&&n&&html$$module$hex` <g opacity="${d}" transform="${this.t_poly}">
        <${DungeonMap$$module$dungeonmap}
          instance=${a.instance}
          hex=${a.uuid}
          uuid=${a.feature_uuid}
          offset=${({x:a.ox-b[0],y:a.oy-b[1]})}
          zoff=${({x:b[0],y:b[1]})}
          dim=${({w:a.dimw,h:a.dimh})}
          zoom_factor=${a.zoom_factor}
          label_mode=${a.show_labels%3}
          tokens=${a.tokens}
        />
      </g>`;b=this.isGenericMap(a.feature)&&1E3<a.zoom_factor&&n&&html$$module$hex` <g opacity="${d}" transform="${this.t_poly}">
        <${BattleMap$$module$battlemap}
          instance=${a.instance}
          hex=${a.uuid}
          uuid=${a.uuid}
          offset=${({x:a.ox-b[0],y:a.oy-b[1]})}
          zoff=${({x:b[0],y:b[1]})}
          dim=${({w:a.dimw,h:a.dimh})}
          zoom_factor=${a.zoom_factor}
          label_mode=${a.show_labels%3}
          tokens=${a.tokens}
        />
      </g>`;c=a.riverline&&html$$module$hex` <${HexRiver$$module$hex}
        riverline=${a.riverline}
        zoom_factor=${a.zoom_factor}
        opacity=${c}
      />`;return e?2!=e?html$$module$hex`<a onClick=${C=>this.clicked(C)}>
        <use
          xlink:href="${window.app.theme.svg}#empty-${a.type}"
          fill="#000"
          opacity="1.0"
          transform="${this.t_poly}"
        />
        <g opacity="0.2"> ${g} </g>
      </a>`:html$$module$hex`<a onClick=${C=>this.clicked(C)}>
          <use
            xlink:href="${window.app.theme.svg}#empty-${a.type}"
            fill="#000"
            transform="${this.t_poly}"
          />
          ${c}${g}${t}
          ${a.show_hex_numbers&&html$$module$hex`
            <text
              dy="-5"
              class="cc-label"
              opacity="${a.hex_numbers_opacity}"
              transform="${this.t_poly}"
              font-size="0.1em"
            >
              ${a.cc}
            </text>
          `}
        </a>
        ${w}${z}${b}`:html$$module$hex`<a onClick=${C=>this.clicked(C)}>
        <polygon
          transform="${this.t_poly},scale(0.95)"
          points="5 -9 -5 -9 -10 0 -5 9 5 9 10 0"
          fill=${window.app.theme.ocean_fill}
          fill="#838383"
          stroke=${window.app.theme.ocean_stroke}
          stroke="none"
          stroke-width="0"
        />
      </a>`}}}var module$hex={};module$hex.BaseHex=BaseHex$$module$hex;module$hex.Borderline=Borderline$$module$hex;module$hex.Hex=Hex$$module$hex;module$hex.HexMask=HexMask$$module$hex;module$hex.SeaHex=SeaHex$$module$hex;module$hex.SeaHexMask=SeaHexMask$$module$hex;module$hex.SoloHex=SoloHex$$module$hex;module$hex.VttHex=VttHex$$module$hex;module$hex.VttSeaHex=VttSeaHex$$module$hex;module$hex.getHexCoords=getHexCoords$$module$hex;module$hex.getOffset=getOffset$$module$hex;module$hex.makeHex=makeHex$$module$hex;function makeRealmPolygon$$module$api(a){function b(t,w,z){e.push([{x:w[0]+t[0],y:w[1]+t[1]},{x:z[0]+t[0],y:z[1]+t[1]}])}function c(t){return Math.floor(t/3).toFixed(15)}var d=20.8*Math.cos(Math.PI/6);let e=[];for(var g of a){a=getOffset$$module$hex(g.hex_x,g.hex_y,10,7.5*1.04);for(var n of g.borders)0==n&&b(a,[5+.1/Math.sqrt(3),.1],[15-.1/Math.sqrt(3),.1]),1==n&&b(a,[15-.1/Math.sqrt(3),.1],[20-2/Math.sqrt(3)*.1,.5*d]),2==n&&b(a,[20-2/Math.sqrt(3)*.1,.5*d],[15-.1/Math.sqrt(3),d-.1]),3==n&&b(a,[15-
.1/Math.sqrt(3),d-.1],[5+.1/Math.sqrt(3),d-.1]),4==n&&b(a,[5+.1/Math.sqrt(3),d-.1],[2/Math.sqrt(3)*.1,.5*d]),5==n&&b(a,[2/Math.sqrt(3)*.1,.5*d],[5+.1/Math.sqrt(3),.1])}d=[];g=e[0][1];n=0;for(d.push({x:g.x,y:g.y});;){e.splice(n,1);if(0==e.length)break;n=0;for(a=0;a<e.length;a++){const t=e[a];if(c(t[0].x)===c(g.x)&&c(t[0].y)===c(g.y)){d.push({x:t[1].x,y:t[1].y});g=t[1];break}if(c(t[1].x)===c(g.x)&&c(t[1].y)===c(g.y)){d.push({x:t[0].x,y:t[0].y});g=t[0];break}n++}if(n==e.length)return console.log("ERROR"),
[]}return d}function makeWall$$module$api(a){let b="";a.forEach(function(c){b=b+c.x+","+(c.y-1)+" "});return b}function makeRealmLabel$$module$api(a,b,c){if(0<c.length){const d=get_polygon_area$$module$utils(c);c=polylabel$$module$libs$polylabel([make_tuple_polygon$$module$utils(c)],1);return[b.name.split(/[ ]/),{x:c[0],y:c[1]},clamp$$module$utils(1E-5*d,1,2),a]}return[[],{x:0,y:0},2,""]}
function RiverLine$$module$api(a,b,c){function d(n,t,w){g.push([{x:t[0]+n[0],y:t[1]+n[1]},{x:w[0]+n[0],y:w[1]+n[1]}])}const e=20.8*Math.cos(Math.PI/6);let g=[];a=getOffset$$module$hex(a,b,10,10.4*Math.cos(Math.PI/6));b=[10+.1/Math.sqrt(3),.5*e];for(const n of c)0==n&&d(a,[10+.1/Math.sqrt(3),.1],b),1==n&&d(a,[17.5-.1/Math.sqrt(3),.25*e],b),2==n&&d(a,[17.5-.1/Math.sqrt(3),.75*e],b),3==n&&d(a,[10+.1/Math.sqrt(3),e-.1],b),4==n&&d(a,[2.5+.1/Math.sqrt(3),.75*e],b),5==n&&d(a,[2.5+.1/Math.sqrt(3),.25*e],
b);c="";if(1==g.length)for(const n of g)c=c+"M "+n[1].x+" "+n[1].y+" L "+n[0].x+" "+n[0].y+" ";2==g.length&&(c=c+"M "+g[0][0].x+" "+g[0][0].y+" C "+g[0][1].x+" "+g[0][1].y+","+g[0][1].x+" "+g[0][1].y+","+g[1][0].x+" "+g[1][0].y+" ");return c}
function convertHexType$$module$api(a,b=!1){let c=a.type;"empty"!=a.type&&(c="DesertHex"==a.type?"desert":"PlainsHex"==a.type?"plains":"TundraHex"==a.type?"tundra":"JungleHex"==a.type?"jungle":"SwampsHex"==a.type?"swamps":"CoastHex"==a.type?"coast":"OceanHex"==a.type?"ocean":"ForestHex"==a.type?3<a.x%3+a.y%4&&void 0===a.feature?"forest-var":"forest":"mountains");const d=c;void 0===a.feature||b||(c+={Inn:"-inn",Residency:"-inn",Dungeon:"-dungeon",Village:"-village",Town:"-town",City:"-city",Other:""}[a.feature]);
return[a.type,c,d]}function setupHexProps$$module$api(a){a.rivers&&(a.riverline=RiverLine$$module$api(a.x,a.y,a.rivers));if(a.trails){let b=[];if(a.trails){let c=0;1==a.trails.length%2&&(b.push([a.trails[c]]),c++);for(;c<a.trails.length;c+=2)b.push([a.trails[c],a.trails[c+1]])}a.trailslines=[];b.map(c=>{a.trailslines.push(RiverLine$$module$api(a.x,a.y,c))})}[a.cls,a.type,a.partial_type]=convertHexType$$module$api(a)}
class MapData$$module$api{constructor(){this.reset()}reset(){this.uuid_to_coords={};this.populated_coords=new Map}neighbor(a,b){switch(b){case 1:return{x:a.x,y:a.y-2};case 2:return{x:a.x+Math.abs(a.y%2),y:a.y-1};case 3:return{x:a.x+Math.abs(a.y%2),y:a.y+1};case 4:return{x:a.x,y:a.y+2};case 5:return{x:a.x-Math.abs(a.y+1)%2,y:a.y+1};case 6:return{x:a.x-Math.abs(a.y+1)%2,y:a.y-1}}}isNotRevealed(a,b){const c=canonical_coords$$module$utils(a,b);return this.populated_coords.has(c)?!0:(a=window.app.yarray.get("ocean:"+
a+","+b),""==a||!a)}mark_as_visited_by_coords(a,b,c){for(let e=1;6>=e;e++){var d=this.neighbor({x:b,y:c},e);this.populated_coords.has(canonical_coords$$module$utils(d.x,d.y))?(d=this.populated_coords.get(canonical_coords$$module$utils(d.x,d.y)),window.app.yarray.has(d)||window.app.yarray.set(d,["partial"]),this.uuid_to_coords[d].visited||(this.uuid_to_coords[d].type.includes("rim")?this.uuid_to_coords[d].visited="rim-"+this.uuid_to_coords[d].partial_type:this.uuid_to_coords[d].visited=this.uuid_to_coords[d].partial_type)):
window.app.yarray.set("ocean:"+d.x+","+d.y,["revealed"])}saveState$$module$state(a,"solo")}mark_as_visited(a,b){window.app.yarray.set(b,["revealed"]);(b=this.getHexDataByUUID(b))&&this.mark_as_visited_by_coords(a,b.x,b.y)}is_visited(a){if(window.app.yarray.has(a)){const b=window.app.yarray.get(a);if("revealed"==b[0])return 2;if("partial"==b[0]&&(a=this.uuid_to_coords[a]))return a.type.includes("rim")?"rim-"+a.partial_type:a.partial_type}return!1}getHexDataByUUID(a){return this.uuid_to_coords[a]}hexRegion(a){return this.uuid_to_coords[a].region}hexRealm(a){return this.uuid_to_coords[a].realm}isPopulated(a,
b){return this.populated_coords.has(canonical_coords$$module$utils(a,b))}isOccupied(a){a=this.getHexDataByUUID(a);return void 0===a?!1:void 0!==a.feature&&"Other"!=a.feature}isBorderline(a){a=this.getHexDataByUUID(a);return void 0===a?!1:a.borderline}isRiverSource(a){a=this.getHexDataByUUID(a);if(void 0===a||!a.type.includes("mountains"))return!1;for(let c=1;6>=c;c++){var b=this.neighbor({x:a.x,y:a.y},c);b=canonical_coords$$module$utils(b.x,b.y);if(this.populated_coords.has(b)&&(b=this.populated_coords.get(b),
!this.getHexDataByUUID(b).type.includes("mountains")))return!0}return!1}isCoastal(a){a=this.getHexDataByUUID(a);if(void 0===a)return!1;for(let b=1;6>=b;b++){const c=this.neighbor({x:a.x,y:a.y},b);if(!this.isPopulated(c.x,c.y))return!0}return!1}isInner(a){if(void 0===a)return!1;const b=a.cls;for(let d=1;6>=d;d++){var c=this.neighbor({x:a.x,y:a.y},d);c=canonical_coords$$module$utils(c.x,c.y);c=this.populated_coords.get(c);c=this.getHexDataByUUID(c);if(!c||c.cls!=b)return!1}return!0}getRealmOnCoast(a,
b){if(this.populated_coords.has(canonical_coords$$module$utils(a,b)))return null;let c=null;for(let e=1;6>=e;e++){var d=this.neighbor({x:a,y:b},e);d=canonical_coords$$module$utils(d.x,d.y);if(this.populated_coords.has(d)){d=this.populated_coords.get(d);d=this.getHexDataByUUID(d);if(c&&c!=d.realm)return null;c||(c=d.realm)}}return c}getRegionOnCoast(a,b){if(this.populated_coords.has(canonical_coords$$module$utils(a,b)))return null;let c=[];for(let e=1;6>=e;e++){var d=this.neighbor({x:a,y:b},e);d=canonical_coords$$module$utils(d.x,
d.y);this.populated_coords.has(d)&&(d=this.populated_coords.get(d),d=this.getHexDataByUUID(d),c.push([d.region,d.cls]))}return 0==c.length?null:c[Math.floor(Math.random()*c.length)]}addOceanHex(a,b){const c=canonical_coords$$module$utils(a,b);this.uuid_to_coords[c]={x:a,y:b,type:"",feature:""};return c}reload(a,b){return new Promise(c=>{window.app.map_cache&&!b&&(this.hexlist=window.app.map_cache.hexlist,this.borders=window.app.map_cache.borders,this.uuid_to_coords=window.app.map_cache.uuid_to_coords,
this.populated_coords=window.app.map_cache.populated_coords,this.loaded=!0,this.postMapLoadedCallback&&this.postMapLoadedCallback(),c());this.reset();api_call_map$$module$api_shim(a).then(d=>{if(d&&d.map){this.regions=d.regions;var e=[],g=[];d.borders||(d.borders={});Object.keys(d.borders).forEach(w=>{const z=makeRealmPolygon$$module$api(d.borders[w]);e.push({uuid:w,wall:makeWall$$module$api(z),poly:z});g.push(makeRealmLabel$$module$api(w,d.realms[w],z))});d.map||(d.map=[]);var n=[];d.map.map(w=>
{setupHexProps$$module$api(w);n.push({x:w.x,y:w.y});w.original_type=w.type;w.cc=canonical_coords$$module$utils(w.x,w.y)||"BASE";this.uuid_to_coords[w.uuid]={x:w.x,y:w.y,cls:w.cls,type:w.type,partial_type:w.partial_type,feature:w.feature,feature_uuid:w.feature_uuid,rotation:w.river_dir?w.river_dir:w.harbor?60*w.harbor:0,harbor:w.harbor,borderline:w.borderline,region:w.region,realm:w.realm};this.populated_coords.set(canonical_coords$$module$utils(w.x,w.y),w.uuid)});var t=get_centroidic_point$$module$utils(n)||
{x:0,y:0};t=getOffset$$module$hex(t.x,t.y);this.hexlist=d.map;this.apply_theme_effects();this.borders=e;this.initial_offset={x:t[0],y:t[1]};this.realm_labels=g;this.postMapLoadedCallback&&this.postMapLoadedCallback();window.app.map_cache={hexlist:d.map,borders:e,realm_labels:g,uuid_to_coords:this.uuid_to_coords,populated_coords:this.populated_coords};c(!0)}else c(!1)})})}apply_theme_effects(){this.hexlist&&this.hexlist.map(a=>{a.type=window.app.theme.no_rims?a.original_type:!this.isInner(a)&&"ocean"!==
a.type||a.rivers&&window.app.theme.rims_for_rivers&&("ForestHex"==a.cls||"JungleHex"==a.cls)?a.feature&&"Other"!==a.feature?a.original_type:"rim-"+a.partial_type:a.original_type;this.uuid_to_coords[a.uuid].type=a.type})}}var module$api={};module$api.MapData=MapData$$module$api;module$api.RiverLine=RiverLine$$module$api;const html$$module$hexmap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function Underwear$$module$hexmap(a){return html$$module$hexmap` <g
    ><polygon
      class="${a.fow?"underwear-fow":"underwear"}"
      points="${a.borders}"
    />
  </g>`}function MapPin$$module$hexmap(a){let b=1E3<a.zoom_factor?1.3-clamp$$module$utils(a.zoom_factor/5E3,0,1):clamp$$module$utils(a.zoom_factor/2-.2,0,1);return html$$module$hexmap`
    <g
      opacity="${b}"
      transform="translate( ${a.pin.x} , ${a.pin.y}) scale(${5/(Math.sqrt(a.zoom_factor)/1)})"
      fill="#550000"
      stroke="#ff8888"
      stroke-width="0.4"
    >
      <path
        d="m-0.00716-9.475c-1.497 1.05e-5 -2.932 1.164-3.244 3.085-0.3842 2.362 2.149 4.35 3.246 6.387 1.199-2.069 3.692-3.622 3.242-6.387-0.3125-1.921-1.747-3.085-3.244-3.085zm0.001044 1.576a1.561 1.561 0 0 1 1.561 1.561 1.561 1.561 0 0 1-1.561 1.561 1.561 1.561 0 0 1-1.561-1.561 1.561 1.561 0 0 1 1.561-1.561z"
      />
    </g>
  `}
class VttHexMap$$module$hexmap extends SvgMap$$module$SvgMap{constructor(){super();this.map_data=new MapData$$module$api;this.setState({offset:{x:0,y:0},dim:{w:1500,h:1500},col1:"col1",res:"empty-",hexlist:[],sea:[],flags:[],spinner:!1});this.loaded=!1}fillOceanHexes(a,b,c,d){let e=[];const g=getHexCoords$$module$hex(a,b);a=getHexCoords$$module$hex(a+c,b+d);for(b=g[0]-2;b<a[0]+1;b++)for(c=g[1];c<a[1]+2;c++){d="ocean:"+b+","+c;const n=window.app.yarray.get(d);n&&""!=n&&e.push({x:b,y:c,type:"ocean",uuid:d})}return e}navigateToHex(a,
b){a=this.map_data.getHexDataByUUID(a);if(void 0!==a){var c=getOffset$$module$hex(a.x,a.y),d=b?b.zoom:100,e=b?b.zoom:100;b=window.app.zooming_into_entity?500:0;window.app.zooming_into_entity=!1;window.setTimeout(()=>{this.minimapOnLocation(c[0],c[1],d,e)},b)}}sort_hexlist(a){a.sort(function(b,c){return b.y>c.y?-1:b.y<c.y?1:0});return a}getMatrix(a){this.props.spinner(1,!0);this.map_data.reload(this.props.instance,a).then(b=>{b?(window.setTimeout(()=>{this.updateReveals(this.map_data.hexlist)},2E3),
this.setState({hexlist:this.sort_hexlist(this.map_data.hexlist),offset:this.loaded?this.state.offset:{x:this.map_data.initial_offset.x-this.state.dim.w/2,y:this.map_data.initial_offset.y-this.state.dim.h/2}}),this.loaded=!0):this.forceUpdate();this.setState({spinner:!1});this.props.spinner(1,!1)})}onHexClicked(a,b,c,d,e){}updateReveals(a){for(let b=0;b<a.length;b++){const c=window.app.yarray.get(a[b].uuid);a[b].pod=c&&"partial"==c[0]?a[b].partial_type:a[b].type;a[b].revealed=c&&c[0]}this.setState({hexlist:a})}postMapLoaded(a){this.loaded?
a():this.postMapLoadedCallback=a}componentDidMount(a,b,c){this.postMapLoadedCallback=this.updateReveals;this.getMatrix();super.componentDidMount(a,b,c);window.app.yarray.observe(this.yarr_observer=d=>{d.keysChanged.has("flags")?(this.setState({flags:window.app.yarray.get("flags")}),this.updateReveals(this.state.hexlist)):d.keysChanged.has("jumper")?this.navigateToHex(window.app.yarray.get("jumper")):d.keysChanged.has("map")?this.getMatrix(!0):this.updateReveals(this.state.hexlist)})}is_within_frustrum(a,
b=40){return a.x>this.state.offset.x-b||a.y>this.state.offset.y-b||a.x<this.state.offset.x+this.state.dim.w+b||a.y<this.state.offset.y+this.state.dim.h+b}hexBitmask(){return 0}render(a,b){const c=this.fillOceanHexes(b.offset.x,b.offset.y,b.dim.w,b.dim.h);return html$$module$hexmap`<div
      id="hexmap"
      class="${"col1"}"
      style="overflow:hidden;${a.visible?"":"display:none;"}"
    >
      <svg
        id="canvas"
        class="${a.desaturate_palette?"desaturated":"colorful"} vtt"
        preserveAspectRatio="xMidYMid meet"
        viewBox="${this.state.offset.x} ${this.state.offset.y} ${this.state.dim.w} ${this.state.dim.h}"
      >
        ${window.app.theme.svg_style}
        <g id="viewport">
          <g class="pod-wrap">
            ${c.map(d=>html$$module$hexmap`<${VttSeaHex$$module$hex}
                res="${b.res}"
                type="${d.type}"
                class="base"
                uuid="${d.uuid}"
                nx="${d.x}"
                ny="${d.y}"
                ox="${b.offset.x}"
                oy="${b.offset.y}"
                dimw="${b.dim.w}"
                dimh="${b.dim.h}"
                zoom_factor=${b.zoom_factor}
                menuHandler="${this}"
              />`)}
            ${b.hexlist.map(d=>html$$module$hexmap`<${VttHex$$module$hex}
                res="${b.res}"
                pod="${d.pod}"
                revealed=${d.revealed}
                feature="${d.feature}"
                feature_uuid="${d.feature_uuid}"
                class="base"
                instance="${a.instance}"
                uuid=${d.uuid}
                riverline=${d.riverline}
                trailslines=${d.trailslines}
                location_uuid=${a.hex_uuid}
                nx="${d.x}"
                ny="${d.y}"
                zoom_factor=${b.zoom_factor}
                ox="${b.offset.x}"
                oy="${b.offset.y}"
                dimw="${b.dim.w}"
                dimh="${b.dim.h}"
                menuHandler="${this}"
                tokens=${this.tokens}
              />`)}
            <g>
              ${b.flags.map(d=>html$$module$hexmap`<polygon
                  class="flagged-hex"
                  points=${makeHex$$module$hex(getOffset$$module$hex(d.x,d.y))}
                />`)}
            </g>
          </g>
        </g>
      </svg>
    </div>`}}function InMapLabel$$module$hexmap(a){let b=0,c=1;a.zoom_factor>a.zoom_threshold&&(a.label_opacity_factor=a.zoom_factor/(10*a.zoom_threshold),b=1,c=-1);return html$$module$hexmap`
    <text
      opacity="${b+c*clamp$$module$utils(a.label_opacity_factor,0,1)}"
      transform="translate( ${a.l.x} , ${a.l.y}) rotate( ${a.l.r})"
      class="${a.label_class}"
      font-size="${a.l.fontsize}em"
      text-anchor="middle"
    >
      ${a.l.name.map((d,e)=>html$$module$hexmap`<tspan
          x="0"
          y="${e-a.l.name.length/2}em"
          dy="${a.yoffset}"
          >${d}</tspan
        >`)}
    </text>
  `}
class HexMap$$module$hexmap extends SvgMap$$module$SvgMap{constructor(){super();this.map_data=new MapData$$module$api;this.setState({offset:{x:0,y:0},dim:{w:1500,h:1500},col1:"col1",res:"empty-",hexlist:[],borders:[],realm_labels:[],sea:[],flags:[],spinner:!1});this.loaded=this.selected=!1;this.region_labels=[];this.hexlabels=[];this.hexpins=[];this.sea=[];this.menu_hotkey_type=0}async fillOceanHexesSolo(a,b,c,d){if(10>this.state.zoom_factor&&this.camera_moving)this.sea=[];else{var e=getHexCoords$$module$hex(a,b),
g=e[0]-2;e=e[1]-2;b=getHexCoords$$module$hex(a+c,b+d);a=b[0]+2;b=b[1]+2;for(c=0;g<a;g++)for(d=e;d<b;d++)if(!this.map_data.isPopulated(g,d)&&!this.map_data.isNotRevealed(g,d)){if(c>=this.sea.length)this.sea.push({x:g,y:d,type:"ocean",uuid:"ocean:"+g+","+d});else{let n=this.sea[c];n.x=g;n.y=d;n.type="ocean";n.uuid="ocean:"+g+","+d}c++}this.sea.length=c}}async fillOceanHexes(a,b,c,d){if(2>this.state.zoom_factor)this.sea=[];else if(10>this.state.zoom_factor&&(this.drag||this.camera_moving))this.sea=[];
else{var e=getHexCoords$$module$hex(a,b),g=e[0]-2;e=e[1]-2;b=getHexCoords$$module$hex(a+c,b+d);a=b[0]+2;b=b[1]+2;for(c=0;g<a;g++)for(d=e;d<b;d++)if(!this.map_data.isPopulated(g,d)){if(c>=this.sea.length)this.sea.push({x:g,y:d,type:"ocean",uuid:"ocean:"+g+","+d});else{let n=this.sea[c];n.x=g;n.y=d;n.type="ocean";n.uuid="ocean:"+g+","+d}c++}this.sea.length=c}}sort_hexlist(a){a.sort(function(b,c){return b.y<c.y?-1:b.y>c.y?1:0});return a}getMatrix(a){this.props.spinner(1,!0);this.map_data.reload(this.props.instance,
a).then(b=>{b&&(b=this.loaded?this.state.offset:{x:this.map_data.initial_offset.x-this.state.dim.w/2,y:this.map_data.initial_offset.y-this.state.dim.h/2},this.state.offset=b,this.setState({hexlist:this.sort_hexlist(this.map_data.hexlist),borders:this.map_data.borders,offset:b,realm_labels:this.map_data.realm_labels}),this.navigateToHex(this.props.hex_uuid),this.loaded=!0,this.makeRegionLabels(),this.makeHexLabels(),this.postMapLoadedCallback&&this.postMapLoadedCallback());this.setState({spinner:!1});
this.props.spinner(1,!1)});a&&window.app.yarray.set("map",!0)}onRerollHex(a){this.setState({spinner:!0});this.props.spinner(1,!0);const b=this.map_data.getHexDataByUUID(a);fetch("/reroll/"+this.props.instance+"/"+a+"/"+b.cls,{method:"GET"}).then(c=>401===c.status?(window.app.unauth(),this.getMatrix(),Promise.reject(c)):c.json()).then(c=>{this.state.menu&&(this.state.menu.c&&this.state.menu.c.setState({uuid:c.uuid}),this.state.menu.uuid=c.uuid);delete window.app.map_cache;this.getMatrix()}).catch(c=>
{console.error("Error:",c)})}onClearHexRiver(a){this.props.spinner(1,!0);fetch("/clear/"+this.props.instance+"/"+a+"/river",{method:"GET"}).then(b=>b.json()).then(b=>{delete window.app.map_cache;this.getMatrix()}).catch(b=>{console.error("Error:",b)})}onClearHexTrails(a){this.props.spinner(1,!0);fetch("/clear/"+this.props.instance+"/"+a+"/trails",{method:"GET"}).then(b=>b.json()).then(b=>{delete window.app.map_cache;this.getMatrix()}).catch(b=>{console.error("Error:",b)})}onDrawRiver(a){fetch("/draw/"+
this.props.instance+"/"+a+"/river",{method:"GET"}).then(b=>b.json()).then(b=>{delete window.app.map_cache;this.getMatrix()}).catch(b=>{console.error("Error:",b)})}onAppendMenu(){let a=this.state.menu;a.type=1;this.setState({menu:a})}onRerollMenu(){let a=this.state.menu;a.type=2;this.setState({menu:a})}onDeleteMenu(){let a=this.state.menu;a.type=3;this.setState({menu:a})}onRollSettlementMenu(){let a=this.state.menu;a.type=4;this.setState({menu:a})}onRollRegionMenu(){let a=this.state.menu;a.type=5;
this.setState({menu:a})}onRollHexMenu(){let a=this.state.menu;a.type=6;this.setState({menu:a})}onAppendRealm(){this.props.appendDialog(this.state.menu)}onAppendRegion(a){const b=this.map_data.getRealmOnCoast(this.state.menu.nx,this.state.menu.ny);b&&fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:b,attribute:"regions",type:a,nx:this.state.menu.nx,ny:this.state.menu.ny})}).then(c=>c.text()).then(c=>
{this.getMatrix(!0)}).catch(c=>{console.error("Error:",c)})}onAppendHex(a,b){const c=this.map_data.getRegionOnCoast(a,b);c&&fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:c[0],attribute:"Hexmap",type:c[1],nx:a,ny:b})}).then(d=>d.text()).then(d=>{this.getMatrix(!0);0!=this.menu_hotkey_type&&(this.state.menu=null)}).catch(d=>{console.error("Error:",d)})}onRemapEntity(a){this.props.spinner(1,
!0);this.setState({spinner:!0});fetch("/remap/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a})}).then(b=>{401===b.status&&window.app.unauth();b.text()}).then(b=>{this.getMatrix(!0)}).catch(b=>{console.error("Error:",b)})}onAppendFeatureInner(a,b,c){fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,
attribute:b,type:c})}).then(d=>d.text()).then(d=>{this.getMatrix(!0)}).catch(d=>{console.error("Error:",d)})}onAppendFeature(a,b,c){const d=this.map_data.getHexDataByUUID(a);"Other"==d.feature?this.onRemoveEntityInner(d.feature_uuid).then(()=>{}):this.props.spinner(1,!0);this.onAppendFeatureInner(a,b,c)}makeHexLabels(){let a=[];for(const b of this.map_data.hexlist)if(b.label){const c=getOffset$$module$hex(b.x,b.y);a.push({name:capitalize$$module$utils(b.label).split(/[ ]/),x:c[0],y:c[1],r:(110-b.label.toLowerCase().charCodeAt(0))/
2,fontsize:"0.15"})}this.hexlabels=a}toggleHexPin(){var a=this.pin_pos.x,b=this.pin_pos.y;for(let c=0;c<this.hexpins.length;c++){const d=this.hexpins[c];if(d.ox==a&&d.oy==b){this.hexpins.splice(c,1);saveState$$module$state(this.props.instance);this.forceUpdate();return}}getOffset$$module$hex(a,b);this.hexpins.push({ox:a,oy:b,x:this.pin_pos.ox,y:this.pin_pos.oy});saveState$$module$state(this.props.instance);this.forceUpdate()}makeRegionLabels(){this.region_polygon_data=new Map;let a=new Map;for(const e of this.map_data.hexlist)e.region&&
(a.has(e.region)||a.set(e.region,{label:this.map_data.regions[e.region],coords:[]}),a.get(e.region).coords.push([e.x,e.y]));let b=[],c=null,d=null;a.forEach((e,g)=>{var n=null,t=null;let w=null,z=null,C=0,H=[];for(const M of e.coords){C++;const L=M[0],O=M[1];H.push({x:L,y:O});if(!n||L<n)n=L;if(!w||O<w)w=O;if(!t||L>t)t=L;if(!z||O>z)z=O}if(!c||C<c)c=C;if(!d||C>d)d=C;n=getOutlineFromArray$$module$hexpoly(make_tuple_polygon$$module$utils(H));t=polylabel$$module$libs$polylabel([n[0]],1);this.region_polygon_data.set(g,
make_xy_polygon$$module$utils(n[0]));b.push({uuid:g,name:e.label.split(/[ ]/),x:t[0],y:t[1],r:18-e.label.length,n_hexes:C})});for(let e of b)e.fontsize=e.n_hexes/d*.2+.2;this.region_labels=b}onHexClickedInFlagMode(a,b){if(this.state.flag_hotkey_mode){let c=this.state.flags;c.push({x:a,y:b});this.setState({flags:c});window.app.yarray.set("flags",c);return!0}return!1}onHexClickedInCrawlMode(a,b,c,d){const e=this.map_data.populated_coords.get(canonical_coords$$module$utils(a,b));return this.props.hex_uuid?
("ocean"!=d||e?$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+c):(a=this.map_data.addOceanHex(a,b),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/coords/"+a)),!0):!1}onHexClickedInLockedFullMap(a,b,c,d){const e=this.map_data.populated_coords.get(canonical_coords$$module$utils(a,b));this.selected=!0;if(window.app.locked){if("ocean"!=d||e)this.onSelectHex(c);else a=this.map_data.addOceanHex(a,b),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+
"/coords/"+a);return!0}return!1}onHexClickedInAddHex(a,b,c,d){return 6==this.menu_hotkey_type?(this.onAppendHex(a,b),!0):!1}onHexClickedInRemoveHex(a,b,c,d){if(9==this.menu_hotkey_type){if("ocean"!=d)this.onRemoveHex(c);return!0}return!1}onHexClicked(a,b,c,d,e){if(!(this.state.hotkey_mode&&!this.state.flag_hotkey_mode||this.onHexClickedInFlagMode(a,b)||this.onHexClickedInCrawlMode(a,b,c,d)||this.onHexClickedInLockedFullMap(a,b,c,d)||this.onHexClickedInAddHex(a,b,c,d)||this.onHexClickedInRemoveHex(a,
b,c,d))){var g=getOffset$$module$hex(a,b);this.setState({menu:{type:this.menu_hotkey_type,c:e,uuid:c,hex_type:d,offset:{x:g[0],y:g[1]},nx:a,ny:b}})}}postMapLoaded(a){this.loaded?a():this.postMapLoadedCallback=a}onClickRealm(a){window.app.inhibit_click||$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/realm/"+a)}navigateToRegion(a){if(this.region_polygon_data&&this.region_polygon_data.has(a)){var b=this.region_polygon_data.get(a),c=get_polygon_extents$$module$utils(b);a=1.3*c.w;
c=1.3*c.h;b=get_polygon_centroid$$module$utils(b);this.minimapOnLocation(b.x,b.y,a,c)}}navigateToRealm(a){for(const c of this.state.borders)if(c.uuid==a){var b=get_polygon_extents$$module$utils(c.poly);const d=1.1*b.w;b=1.1*b.h;const e=get_polygon_centroid$$module$utils(c.poly);this.minimapOnLocation(e.x,e.y,d,b)}}navigateToHex(a,b){function c(z,C,H){H*=Math.PI/180;var M={};M.x=z*Math.cos(H)-C*Math.sin(H);M.y=z*Math.sin(H)+C*Math.cos(H);return M}if(!window.app.hotkey_mode&&(a=this.map_data.getHexDataByUUID(a),
void 0!==a)){var d=0,e=0;b&&(d=b.x,e=b.y);var g=200;if("City"==a.feature||"Town"==a.feature)e=c(d,e-(void 0!==a.harbor?900:0),a.rotation),d=e.x,e=e.y;"Village"==a.feature&&(void 0!==a.harbor&&(g=c(d,e-595,60*a.harbor),d=g.x,e=g.y),g=100);"Dungeon"==a.feature&&(g=100);var n=getOffset$$module$hex(a.x,a.y);b?(n[0]+=d/g,n[1]+=e/g,this.focused_hex=null):this.focused_hex=a;this.pin_pos={x:a.x,y:a.y,ox:n[0],oy:n[1]};var t=b?b.zoom:100,w=b?b.zoom:100;b=window.app.zooming_into_entity?500:0;window.app.zooming_into_entity=
!1;window.setTimeout(()=>{this.minimapOnLocation(n[0],n[1],t,w)},b)}}onSelectHex(a){void 0!==this.map_data.getHexDataByUUID(a)&&(this.onSelectHexInoked=!0,$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+a))}onRemoveEntityInner(a){return new Promise(b=>{this.props.spinner(1,!0);this.setState({spinner:!0});fetch("/remove/"+this.props.instance+"/"+a,{method:"GET"}).then(c=>c.json()).then(c=>{b()}).catch(c=>{console.error("Error:",c)})})}onRemoveEntity(a){this.onRemoveEntityInner(a).then(()=>
{delete window.app.map_cache;this.getMatrix(!0)})}onRemoveHex(a){this.onRemoveEntity(a)}onRemoveRegion(a){this.onRemoveEntity(this.map_data.hexRegion(a))}onRemoveRealm(a){this.onRemoveEntity(this.map_data.hexRealm(a))}componentDidMount(a,b,c){this.getMatrix();super.componentDidMount(a,b,c);window.addEventListener("keydown",d=>this.onKeyDown(d));window.addEventListener("keyup",d=>this.onKeyUp(d));window.addEventListener("mouseout",d=>{d=d.relatedTarget||d.toElement;d&&"HTML"!=d.nodeName||(this.setState({hotkey_mode:!1,
flag_hotkey_mode:!1}),window.app.hotkey_mode=!1,window.app.flag_hotkey_mode=!1,this.props.hotkeyMode(!1))})}onKeyUp(a){window.app.inhibit_hotkeys||this.props.editMode||is_electron$$module$api_shim||("Space"==a.code&&window.app.hotkey_mode&&this.props.hotkeyMode(!1),"KeyF"==a.code&&window.app.flag_hotkey_mode&&(this.props.hotkeyMode(!1,{flag_hotkey_mode:!1,flags:[]}),window.app.yarray.set("flags",[]),window.app.flag_hotkey_mode=!1),"KeyT"==a.code&&(window.app.token_hotkey_mode=!1,this.props.hotkeyMode(!1)),
"KeyK"==a.code&&(window.app.kill_hotkey_mode=!1,this.props.hotkeyMode(!1)),"KeyH"==a.code&&(this.menu_hotkey_type=0),"KeyC"==a.code&&(this.menu_hotkey_type=0))}onKeyDown(a){if(!window.app.inhibit_hotkeys&&!this.props.editMode&&(is_electron$$module$api_shim||("Space"!=a.code||window.app.hotkey_mode||(this.setState({hotkey_mode:!0}),this.props.hotkeyMode(!0),window.app.hotkey_mode=!0),"KeyF"!=a.code||window.app.flag_hotkey_mode||(this.props.hotkeyMode(!0,{flag_hotkey_mode:!0}),window.app.flag_hotkey_mode=
!0),"KeyT"!=a.code||window.app.token_hotkey_mode||(window.app.token_hotkey_mode=!0,this.props.hotkeyMode(!0)),"KeyK"!=a.code||window.app.kill_hotkey_mode||(window.app.kill_hotkey_mode=!0,this.props.hotkeyMode(!0)),"KeyL"==a.code&&this.props.toggleLabels(),"KeyJ"==a.code&&window.app.yarray.set("jumper",this.props.hex_uuid),"KeyP"==a.code&&this.toggleHexPin()),this.focused_hex&&this.props.hex_uuid)){var b=this.focused_hex.y,c=this.focused_hex.x;"w"==a.key&&(b-=2);"s"==a.key&&(b+=2);"e"!=a.key||a.ctrlKey||
(--b,0==Math.abs(b)%2&&c++);"q"==a.key&&(--b,1==Math.abs(b)%2&&c--);"a"==a.key&&(b+=1,1==Math.abs(b)%2&&c--);"d"==a.key&&(b+=1,0==Math.abs(b)%2&&c++);if(b!=this.focused_hex.y||c!=this.focused_hex.x){var d=this.map_data.populated_coords.get(canonical_coords$$module$utils(c,b)),e=d?null:this.map_data.addOceanHex(c,b);if(d||e)this.navigateToHex(d),d?this.map_data.mark_as_visited(this.props.instance,d):e&&this.map_data.mark_as_visited(this.props.instance,e),this.on_key_down_to&&window.clearTimeout(this.on_key_down_to);
this.on_key_down_to=window.setTimeout(()=>{$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+(e?"/coords/":"/hex/")+(e?e:d))},500)}}}componentDidUpdate(a,b,c){this.show_region_label="region"===this.props.type?this.props.hex_uuid:!1;this.show_realm_label="realm"===this.props.type?this.props.hex_uuid:!1;this.onSelectHexInoked&&(this.onSelectHexInoked=!1);0==a.locked&&1==this.props.locked&&(this.selected=null)}is_within_frustrum(a,b=40){return a.x>this.state.offset.x-b||a.y>this.state.offset.y-
b||a.x<this.state.offset.x+this.state.dim.w+b||a.y<this.state.offset.y+this.state.dim.h+b}hexBitmask(){const a=this.state.menu.uuid;let b=0;"ocean"===this.state.menu.hex_type&&(b|=HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN);this.map_data.isOccupied(a)&&(b|=HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED);this.map_data.isCoastal(a)&&(b|=HexBitmask$$module$hexmenu.IS_HEX_COASTAL);this.map_data.isRiverSource(a)&&(b|=HexBitmask$$module$hexmenu.IS_HEX_VALID_RIVER_SOURCE);this.map_data.isBorderline(a)&&(b|=
HexBitmask$$module$hexmenu.IS_HEX_HAS_BORDER);this.map_data.getRealmOnCoast(this.state.menu.nx,this.state.menu.ny)&&(b|=HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REALM);this.map_data.getRegionOnCoast(this.state.menu.nx,this.state.menu.ny)&&(b|=HexBitmask$$module$hexmenu.IS_HEX_EXTENDING_REGION);return b}calc_hex_numbers_opacity(){let a=0,b=1,c=(this.state.zoom_factor-3)/10;100<this.state.zoom_factor&&(a=1,c=this.state.zoom_factor/1E3,b=-1);return a+b*clamp$$module$utils(c,0,1)}render(a,b){var c=
this.focused_hex?getOffset$$module$hex(this.focused_hex.x,this.focused_hex.y,0,0):null;c=this.focused_hex?html$$module$hexmap` <polygon class="focused-hex" points=${makeHex$$module$hex(c)} /> `:html$$module$hexmap``;var d=1<b.zoom_factor&&1500>b.zoom_factor&&!a.locked&&!b.spinner;d||(this.selected=!1);var e=5/Math.sqrt(b.zoom_factor);d=this.state.menu?html$$module$hexmap`<${HexMenu$$module$hexmenu}
          menu=${this.state.menu}
          cond=${d}
          bitmask=${this.hexBitmask()}
          handler=${this}
          scale=${Math.min(Math.max(1.5*e,.5),3)}
        />`:html$$module$hexmap``;e=a.state_loaded?1:0;const g=window.app.solo_mode?"background-color: #838383":"",n=window.app.solo_mode?0:1,t=window.app.solo_mode?1:this.state.zoom_factor/4;window.app.solo_mode?this.fillOceanHexesSolo(b.offset.x,b.offset.y,b.dim.w,b.dim.h):this.fillOceanHexes(b.offset.x,b.offset.y,b.dim.w,b.dim.h);let w=this.state.col1;w=a.hex_uuid?"rect1":"col1";const z=b.hotkey_mode?SeaHexMask$$module$hex:SeaHex$$module$hex,C=window.app.solo_mode?SoloHex$$module$hex:Hex$$module$hex,
H=a.show_labels&2,M=this.calc_hex_numbers_opacity();return html$$module$hexmap`<div
      id="hexmap"
      class="${w}"
      style="overflow:hidden;${a.visible?"":"display:none;"}"
    >
      <svg
        id="canvas"
        class="${a.desaturate_palette?"desaturated":"colorful"} ${b.hotkey_mode&&"fow_mode"}"
        preserveAspectRatio="xMidYMid meet"
        viewBox="${this.state.offset.x} ${this.state.offset.y} ${this.state.dim.w} ${this.state.dim.h}"
        style="${g}"
      >
        ${window.app.theme.svg_style}
        <g id="viewport">
          <g class="pod-wrap" opacity="${e}">
            <g opacity="${t}">
              ${this.sea.map(L=>html$$module$hexmap`<${z}
                  id=${L.uuid}
                  res="${b.res}"
                  type="${L.type}"
                  class="base"
                  uuid="${L.uuid}"
                  instance=${a.instance}
                  nx="${L.x}"
                  ny="${L.y}"
                  ox="${b.offset.x}"
                  oy="${b.offset.y}"
                  dimw="${b.dim.w}"
                  dimh="${b.dim.h}"
                  zoom_factor=${b.zoom_factor}
                  menuHandler="${this}"
                  flag_hotkey_mode=${b.flag_hotkey_mode}
                />`)}
            </g>
            <g opacity="${n}">
              ${b.borders.map(L=>html$$module$hexmap` <${Underwear$$module$hexmap}
                  fow=${b.hotkey_mode}
                  borders="${L.wall}"
                />`)}
            </g>
            ${b.hexlist.map(L=>html$$module$hexmap`<${C}
                res="${b.res}"
                type="${L.type}"
                feature="${L.feature}"
                feature_uuid="${L.feature_uuid}"
                class="base"
                instance="${a.instance}"
                uuid=${L.uuid}
                riverline=${L.riverline}
                trailslines=${L.trailslines}
                location_uuid=${a.hex_uuid}
                nx="${L.x}"
                ny="${L.y}"
                cc="${L.cc}"
                zoom_factor=${b.zoom_factor}
                ox="${b.offset.x}"
                oy="${b.offset.y}"
                dimw="${b.dim.w}"
                dimh="${b.dim.h}"
                menuHandler="${this}"
                tokens=${this.tokens}
                hotkey_mode=${b.hotkey_mode}
                show_labels=${a.show_labels}
                show_hex_numbers=${H}
                hex_numbers_opacity=${M}
              />`)}
            ${b.hotkey_mode&&1E3>b.zoom_factor&&b.hexlist.map(L=>html$$module$hexmap`<${HexMask$$module$hex}
                uuid=${L.uuid}
                instance=${a.instance}
                nx="${L.x}"
                ny="${L.y}"
                zoom_factor=${b.zoom_factor}
                ox="${b.offset.x}"
                oy="${b.offset.y}"
                dimw="${b.dim.w}"
                dimh="${b.dim.h}"
                flag_hotkey_mode=${b.flag_hotkey_mode}
              />`)}
            <g opacity="${n}">
              ${b.zoom_factor<window.app.theme.borderline_zoom_factor&&b.borders.map(L=>html$$module$hexmap`<a onClick=${()=>this.onClickRealm(L.uuid)}>
                  <${Borderline$$module$hex}
                    borders="${L.wall}"
                    arm="10"
                    color="#ffffff"
                    zoom_factor=${b.zoom_factor}
                    ox="${this.state.offset.x}"
                    oy="${this.state.offset.y}"
                    dimw="${this.state.dim.w}"
                    dimh="${this.state.dim.h}"
                /></a>`)}
            </g>
            <g>${c}</g>
            <g>
              ${b.flags.map(L=>html$$module$hexmap`<polygon
                  class="flagged-hex"
                  points=${makeHex$$module$hex(getOffset$$module$hex(L.x,L.y))}
                />`)}
            </g>
            <g>
              ${"col1"==w&&a.show_labels%2&&!b.hotkey_mode?this.hexlabels.map(L=>{if(this.is_within_frustrum(L))return html$$module$hexmap`
                        <${InMapLabel$$module$hexmap}
                          zoom_factor=${this.state.zoom_factor}
                          zoom_threshold="300"
                          label_opacity_factor=${(this.state.zoom_factor-10)/20}
                          l=${L}
                          label_class="hex-label"
                          yoffset="2.5em"
                        />
                      `}):html$$module$hexmap``}
            </g>
            <g>
              ${"col1"==w&&a.show_labels%2&&!b.hotkey_mode||this.show_region_label?this.region_labels.map(L=>{if((!this.show_region_label||this.show_region_label==L.uuid)&&this.is_within_frustrum(L))return html$$module$hexmap`
                        <${InMapLabel$$module$hexmap}
                          zoom_factor=${this.state.zoom_factor}
                          zoom_threshold="50"
                          label_opacity_factor=${this.show_region_label?1:(this.state.zoom_factor-5)/10}
                          l=${L}
                          label_class="region-label"
                          yoffset="1em"
                        />
                      `}):html$$module$hexmap``}
            </g>
            <g>
              ${"col1"==w&&a.show_labels%2&&!b.hotkey_mode&&!this.show_region_label||this.show_realm_label?this.state.realm_labels.map(L=>{if(!this.show_realm_label||this.show_realm_label==L[3])return html$$module$hexmap`
                      <text
                        opacity="${1-clamp$$module$utils((this.state.zoom_factor-3)/10,0,1)}"
                        transform="translate( ${L[1].x} , ${L[1].y})"
                        class="realm-label"
                        font-size="${L[2]}em"
                        text-anchor="middle"
                      >
                        ${L[0].map((O,S)=>html$$module$hexmap`<tspan x="0" y="${S-2}em" dy="1em"
                            >${O}</tspan
                          >`)}
                      </text>
                    `}):html$$module$hexmap``}
            </g>
            <g>
              ${a.show_labels%4&&!b.hotkey_mode&&this.hexpins?this.hexpins.map(L=>{if(this.is_within_frustrum(L))return html$$module$hexmap`
                        <${MapPin$$module$hexmap}
                          zoom_factor=${this.state.zoom_factor}
                          pin=${L}
                        />
                      `}):html$$module$hexmap``}
            </g>
          </g>
        </g>
        <g>${d}</g>
      </svg>
    </div>`}}var module$hexmap={};module$hexmap.HexMap=HexMap$$module$hexmap;module$hexmap.VttHexMap=VttHexMap$$module$hexmap;const html$$module$spinner=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function InnerSpinner$$module$spinner(){return html$$module$spinner`
    <style>
      #eefEsROxk9w2_ts {
        animation: eefEsROxk9w2_ts__ts 2900ms linear infinite normal forwards;
      }
      @keyframes eefEsROxk9w2_ts__ts {
        0% {
          transform: translate(328.585373px, 76.258278px) rotate(91.041629deg)
            scale(0, 0);
        }
        34.482759% {
          transform: translate(328.585373px, 76.258278px) rotate(91.041629deg)
            scale(1, 1);
        }
        68.965517% {
          transform: translate(328.585373px, 76.258278px) rotate(91.041629deg)
            scale(0, 0);
        }
        100% {
          transform: translate(328.585373px, 76.258278px) rotate(91.041629deg)
            scale(0, 0);
        }
      }
      #eefEsROxk9w3_ts {
        animation: eefEsROxk9w3_ts__ts 2900ms linear infinite normal forwards;
      }
      @keyframes eefEsROxk9w3_ts__ts {
        0% {
          transform: translate(440.19521px, 139.159051px) rotate(91.041629deg)
            scale(0, 0);
        }
        13.793103% {
          transform: translate(440.19521px, 139.159051px) rotate(91.041629deg)
            scale(0, 0);
        }
        48.275862% {
          transform: translate(440.19521px, 139.159051px) rotate(91.041629deg)
            scale(1, 1);
        }
        82.758621% {
          transform: translate(440.19521px, 139.159051px) rotate(91.041629deg)
            scale(0, 0);
        }
        100% {
          transform: translate(440.19521px, 139.159051px) rotate(91.041629deg)
            scale(0, 0);
        }
      }
      #eefEsROxk9w4_ts {
        animation: eefEsROxk9w4_ts__ts 2900ms linear infinite normal forwards;
      }
      @keyframes eefEsROxk9w4_ts__ts {
        0% {
          transform: translate(440.19521px, 273.305491px) rotate(91.041629deg)
            scale(0, 0);
        }
        31.034483% {
          transform: translate(440.19521px, 273.305491px) rotate(91.041629deg)
            scale(0, 0);
        }
        65.517241% {
          transform: translate(440.19521px, 273.305491px) rotate(91.041629deg)
            scale(1, 1);
        }
        100% {
          transform: translate(440.19521px, 273.305491px) rotate(91.041629deg)
            scale(0, 0);
        }
      }
      #eefEsROxk9w5_ts {
        animation: eefEsROxk9w5_ts__ts 2900ms linear infinite normal forwards;
      }
      @keyframes eefEsROxk9w5_ts__ts {
        0% {
          transform: translate(328.747458px, 337.283861px) rotate(91.041629deg)
            scale(0.5, 0.5);
        }
        13.793103% {
          transform: translate(328.747458px, 337.283861px) rotate(91.041629deg)
            scale(0, 0);
        }
        48.275862% {
          transform: translate(328.747458px, 337.283861px) rotate(91.041629deg)
            scale(0, 0);
        }
        82.758621% {
          transform: translate(328.747458px, 337.283861px) rotate(91.041629deg)
            scale(1, 1);
        }
        100% {
          transform: translate(328.747458px, 337.283861px) rotate(91.041629deg)
            scale(0.5, 0.5);
        }
      }
      #eefEsROxk9w6_ts {
        animation: eefEsROxk9w6_ts__ts 2900ms linear infinite normal forwards;
      }
      @keyframes eefEsROxk9w6_ts__ts {
        0% {
          transform: translate(224.649822px, 273.703072px) rotate(91.041629deg)
            scale(1, 1);
        }
        34.482759% {
          transform: translate(224.649822px, 273.703072px) rotate(91.041629deg)
            scale(0, 0);
        }
        65.517241% {
          transform: translate(224.649822px, 273.703072px) rotate(91.041629deg)
            scale(0, 0);
        }
        100% {
          transform: translate(224.649822px, 273.703072px) rotate(91.041629deg)
            scale(1, 1);
        }
      }
      #eefEsROxk9w7_ts {
        animation: eefEsROxk9w7_ts__ts 2900ms linear infinite normal forwards;
      }
      @keyframes eefEsROxk9w7_ts__ts {
        0% {
          transform: translate(224.649822px, 143.849319px) rotate(91.041629deg)
            scale(0.5, 0.5);
        }
        17.241379% {
          transform: translate(224.649822px, 143.849319px) rotate(91.041629deg)
            scale(1, 1);
        }
        48.275862% {
          transform: translate(224.649822px, 143.849319px) rotate(91.041629deg)
            scale(0, 0);
        }
        82.758621% {
          transform: translate(224.649822px, 143.849319px) rotate(91.041629deg)
            scale(0, 0);
        }
        100% {
          transform: translate(224.649822px, 143.849319px) rotate(91.041629deg)
            scale(0.5, 0.5);
        }
      }
    </style>
    <g
      id="eefEsROxk9w2_ts"
      transform="translate(328.585373,76.258278) rotate(91.041629) scale(0,0)"
    >
      <polygon
        id="eefEsROxk9w2"
        points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
        transform="translate(0,0)"
        fill="#df286d"
        stroke="none"
        stroke-width="12"
      />
    </g>
    <g
      id="eefEsROxk9w3_ts"
      transform="translate(440.19521,139.159051) rotate(91.041629) scale(0,0)"
    >
      <polygon
        id="eefEsROxk9w3"
        points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
        transform="translate(0,0)"
        fill="#df286d"
        stroke="none"
        stroke-width="12"
      />
    </g>
    <g
      id="eefEsROxk9w4_ts"
      transform="translate(440.19521,273.305491) rotate(91.041629) scale(0,0)"
    >
      <polygon
        id="eefEsROxk9w4"
        points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
        transform="translate(0,0)"
        fill="#df286d"
        stroke="none"
        stroke-width="12"
      />
    </g>
    <g
      id="eefEsROxk9w5_ts"
      transform="translate(328.747458,337.283861) rotate(91.041629) scale(0.5,0.5)"
    >
      <polygon
        id="eefEsROxk9w5"
        points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
        transform="translate(0,0)"
        fill="#df286d"
        stroke="none"
        stroke-width="12"
      />
    </g>
    <g
      id="eefEsROxk9w6_ts"
      transform="translate(224.649822,273.703072) rotate(91.041629) scale(1,1)"
    >
      <polygon
        id="eefEsROxk9w6"
        points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
        transform="translate(0,0)"
        fill="#df286d"
        stroke="none"
        stroke-width="12"
      />
    </g>
    <g
      id="eefEsROxk9w7_ts"
      transform="translate(224.649822,143.849319) rotate(91.041629) scale(0.5,0.5)"
    >
      <polygon
        id="eefEsROxk9w7"
        points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
        transform="translate(0,0)"
        fill="#df286d"
        stroke="none"
        stroke-width="12"
      />
    </g>
  `}class Spinner$$module$spinner extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$spinner`
      <div id="hexspinner" style="${a.style}">
        <svg
          width="${a.width}"
          id="eefEsROxk9w1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          viewBox="0 0 640 480"
          shape-rendering="geometricPrecision"
          text-rendering="geometricPrecision"
          style="background:transparent;"
        >
          <${InnerSpinner$$module$spinner} />
        </svg>
      </div>
    `}}var module$spinner={};module$spinner.InnerSpinner=InnerSpinner$$module$spinner;module$spinner.Spinner=Spinner$$module$spinner;const html$$module$search=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class SearchBar$$module$search extends k$$module$libs$preact{constructor(){super();this.setState({callInvoked:!1,results:[]});this.search=this.search.bind(this);this.delayTimer=null}search(a){const b=document.getElementById("search-input").value;""==b||void 0===b?this.setState({results:[]}):(this.setState({callInvoked:!0}),api_call_search$$module$api_shim(a,b).then(c=>{this.setState({results:c.results,callInvoked:!1})}))}componentDidMount(){document.getElementById("search").addEventListener("keydown",a=>
{if("ArrowDown"==a.code)return a.preventDefault(),a.stopPropagation(),(this.curr=this.curr?this.curr.nextSibling:document.getElementById("search-results").firstChild)&&this.curr.firstChild.focus(),!1;if("ArrowUp"==a.code)return a.preventDefault(),a.stopPropagation(),(this.curr=this.curr?this.curr.previousSibling:document.getElementById("search-results").lastChild)&&this.curr.firstChild.focus(),!1})}delayed_search(a){this.delayTimer&&clearTimeout(this.delayTimer);let b=this;this.delayTimer=setTimeout(function(){b.search(a)},
150)}render(a,b){const c=0<b.results.length||!b.callInvoked?html$$module$search``:html$$module$search`
            <div style="width:100%;text-align:center;">
              <${Spinner$$module$spinner} style="" width="50px" />
            </div>
          `;return html$$module$search`
          <div> <input placeholder="Search" id="search-input" autocomplete="off" onkeypress="${()=>this.delayed_search(a.instance)}" onkeyup="${()=>this.delayed_search(a.instance)}"      
        onfocusin=${()=>window.app.inhibit_hotkeys=!0}
        onfocusout=${()=>window.app.inhibit_hotkeys=!1}

        > 

      </input>
      ${c}
          <ul id="search-results">
            ${b.results.map(d=>html$$module$search`<li>
                <a
                  href="/sandbox/${a.instance}/${d.type}/${d.uuid}${d.anchor?"/npc/"+d.anchor:""}"
                >
                  <div style="display:table-row;">
                    <div style="display:table-cell;">
                      <i
                        style="margin-right:0.5em;"
                        class="fa fa-solid fa-${d.icon}"
                      ></i>
                    </div>
                    <div style="display:table-cell;width:100%;">
                      ${d.value}
                    </div>
                  </div>
                  <div style="display:table-row;">
                    <div style="display:table-cell;"></div>
                    <div class="details" style="display:table-cell;width:100%;">
                      ${d.details}
                    </div>
                  </div>
                </a>
              </li>`)}
          </ul>
          </div>
      `}}var module$search={};module$search.SearchBar=SearchBar$$module$search;const html$$module$dialogs=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class GenerateRealmDialog$$module$dialogs extends ModalDialog$$module$utils{constructor(){super();this.state={show:!0,compiler:0,realm_type:"RealmTypeKingdom",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,
minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_jungle_region:12,maximum_tiles_per_jungle_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32,minimum_tiles_per_tundra_region:12,maximum_tiles_per_tundra_region:32,minimum_number_of_settlements:6,maximum_number_of_settlements:9,cities_probability:2,towns_probability:3,villages_probability:3,minimum_number_of_dwellings:7,
maximum_number_of_dwellings:11,house_probability:1,stronghold_probability:1,minimum_number_of_inns:3,maximum_number_of_inns:6,minimum_number_of_dungeons:6,maximum_number_of_dungeons:9,tombs_probability:1,temples_probability:1,caves_probability:1,prefer_small_dungeons:!1,minimum_number_of_factions:3,maximum_number_of_factions:5,cults_probability:1,militias_probability:1,syndicates_probability:1,wandering_monsters_max_hd:4,scroll_mod:"",treasure_factor:1};this.onSubmit=this.onSubmit.bind(this);this.onRealmType=
this.onRealmType.bind(this);this.onRealmPopulation=this.onRealmPopulation.bind(this);this.onMinimumNumberOfRegions=this.onMinimumNumberOfRegions.bind(this);this.onMaximumNumberOfRegions=this.onMaximumNumberOfRegions.bind(this);this.onMountainsProbability=this.onMountainsProbability.bind(this);this.onMinimumTilesPerMountainsRegion=this.onMinimumTilesPerMountainsRegion.bind(this);this.onMaximumTilesPerMountainsRegion=this.onMaximumTilesPerMountainsRegion.bind(this);this.onMinimumTilesPerForestRegion=
this.onMinimumTilesPerForestRegion.bind(this);this.onMaximumTilesPerForestRegion=this.onMaximumTilesPerForestRegion.bind(this);this.onMinimumTilesPerDesertRegion=this.onMinimumTilesPerDesertRegion.bind(this);this.onMaximumTilesPerDesertRegion=this.onMaximumTilesPerDesertRegion.bind(this);this.onMinimumTilesPerPlainsRegion=this.onMinimumTilesPerPlainsRegion.bind(this);this.onMaximumTilesPerPlainsRegion=this.onMaximumTilesPerPlainsRegion.bind(this);this.onMinimumTilesPerJungleRegion=this.onMinimumTilesPerJungleRegion.bind(this);
this.onMaximumTilesPerJungleRegion=this.onMaximumTilesPerJungleRegion.bind(this);this.onMinimumTilesPerSwampsRegion=this.onMinimumTilesPerSwampsRegion.bind(this);this.onMaximumTilesPerSwampsRegion=this.onMaximumTilesPerSwampsRegion.bind(this);this.onMinimumTilesPerTundraRegion=this.onMinimumTilesPerTundraRegion.bind(this);this.onMaximumTilesPerTundraRegion=this.onMaximumTilesPerTundraRegion.bind(this);this.onForestProbability=this.onForestProbability.bind(this);this.onDesertProbability=this.onDesertProbability.bind(this);
this.onPlainsProbability=this.onPlainsProbability.bind(this);this.onJungleProbability=this.onJungleProbability.bind(this);this.onSwampsProbability=this.onSwampsProbability.bind(this);this.onTundraProbability=this.onTundraProbability.bind(this);this.onMinimumNumberOfSettlements=this.onMinimumNumberOfSettlements.bind(this);this.onMaximumNumberOfSettlements=this.onMaximumNumberOfSettlements.bind(this);this.onCitiesProbability=this.onCitiesProbability.bind(this);this.onTownsProbability=this.onTownsProbability.bind(this);
this.onMinimumNumberOfDwellings=this.onMinimumNumberOfDwellings.bind(this);this.onMaximumNumberOfDwellings=this.onMaximumNumberOfDwellings.bind(this);this.onHouseProbability=this.onHouseProbability.bind(this);this.onStrongholdProbability=this.onStrongholdProbability.bind(this);this.onVillagesProbability=this.onVillagesProbability.bind(this);this.onMinimumNumberOfInns=this.onMinimumNumberOfInns.bind(this);this.onMaximumNumberOfInns=this.onMaximumNumberOfInns.bind(this);this.onMinimumNumberOfDungeons=
this.onMinimumNumberOfDungeons.bind(this);this.onMaximumNumberOfDungeons=this.onMaximumNumberOfDungeons.bind(this);this.onTombsProbability=this.onTombsProbability.bind(this);this.onTemplesProbability=this.onTemplesProbability.bind(this);this.onCavesProbability=this.onCavesProbability.bind(this);this.onPreferSmallDungeons=this.onPreferSmallDungeons.bind(this);this.onMinimumNumberOfFactions=this.onMinimumNumberOfFactions.bind(this);this.onMaximumNumberOfFactions=this.onMaximumNumberOfFactions.bind(this);
this.onCultsProbability=this.onCultsProbability.bind(this);this.onMilitiasProbability=this.onMilitiasProbability.bind(this);this.onSyndicatesProbability=this.onSyndicatesProbability.bind(this);this.onWanderingMonstersMaxHD=this.onWanderingMonstersMaxHD.bind(this);this.onScrollMod=this.onScrollMod.bind(this);this.onTreasureFactor=this.onTreasureFactor.bind(this)}show(){this.setState({show:!0})}hide(){this.setState({show:!1})}onRealmType(a){"RealmTypeLands"==a.target.value&&this.setState({realm_type:"RealmTypeLands",
minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:0,desert_probability:1,plains_probability:0,jungle_probability:4,swamps_probability:1,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_jungle_region:12,maximum_tiles_per_jungle_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeKingdom"==
a.target.value&&this.setState({realm_type:"RealmTypeKingdom",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,
maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeEmpire"==a.target.value&&this.setState({realm_type:"RealmTypeEmpire",minimum_number_of_regions:24,maximum_number_of_regions:32,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,
maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeDuchy"==a.target.value&&this.setState({realm_type:"RealmTypeDuchy",minimum_number_of_regions:4,maximum_number_of_regions:8,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,
tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeIsland"==a.target.value&&this.setState({realm_type:"RealmTypeIsland",minimum_number_of_regions:3,maximum_number_of_regions:7,
mountains_probability:3,forest_probability:0,desert_probability:1,plains_probability:0,jungle_probability:2,swamps_probability:0,tundra_probability:0,minimum_tiles_per_mountains_region:3,maximum_tiles_per_mountains_region:8,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:3,maximum_tiles_per_desert_region:8,minimum_tiles_per_jungle_region:3,maximum_tiles_per_jungle_region:8,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,
maximum_tiles_per_swamps_region:32,minimum_number_of_dungeons:1,maximum_number_of_dungeons:3,prefer_small_dungeons:!0,minimum_number_of_settlements:0,maximum_number_of_settlements:1,minimum_number_of_dwellings:2,maximum_number_of_dwellings:5,minimum_number_of_inns:0,maximum_number_of_inns:1,minimum_number_of_factions:0,maximum_number_of_factions:1,cities_probability:1,towns_probability:2,villages_probability:4})}onRealmPopulation(a){"now"==a.target.value&&this.setState({minimum_number_of_settlements:6,
maximum_number_of_settlements:9,minimum_number_of_dwellings:7,maximum_number_of_dwellings:11,minimum_number_of_inns:6,maximum_number_of_inns:9,minimum_number_of_factions:3,maximum_number_of_factions:5});"later"==a.target.value&&this.setState({minimum_number_of_settlements:0,maximum_number_of_settlements:0,minimum_number_of_dwellings:0,maximum_number_of_dwellings:0,minimum_number_of_inns:0,maximum_number_of_inns:0,minimum_number_of_factions:0,maximum_number_of_factions:0})}preventLower(a,b){return parseInt(a)>
parseInt(b)?a:b}onMinimumNumberOfRegions(a){this.state.maximum_number_of_regions<parseInt(a.target.value)&&(this.state.maximum_number_of_regions=parseInt(a.target.value),this.forceUpdate());this.state.minimum_number_of_regions=a.target.value}onMaximumNumberOfRegions(a){this.state.maximum_number_of_regions=this.preventLower(this.state.minimum_number_of_regions,a.target.value);this.forceUpdate()}onMountainsProbability(a){this.state.mountains_probability=a.target.value}onMinimumTilesPerMountainsRegion(a){this.state.maximum_tiles_per_mountains_region<
parseInt(a.target.value)&&(this.state.maximum_tiles_per_mountains_region=parseInt(a.target.value),this.forceUpdate());this.state.minimum_tiles_per_mountains_region=a.target.value}onMaximumTilesPerMountainsRegion(a){this.state.maximum_tiles_per_mountains_region=this.preventLower(this.state.minimum_tiles_per_mountains_region,a.target.value);this.forceUpdate()}onMinimumTilesPerForestRegion(a){this.state.maximum_tiles_per_forest_region<parseInt(a.target.value)&&(this.state.maximum_tiles_per_forest_region=
parseInt(a.target.value),this.forceUpdate());this.state.minimum_tiles_per_forest_region=a.target.value}onMaximumTilesPerForestRegion(a){this.state.maximum_tiles_per_forest_region=this.preventLower(this.state.minimum_tiles_per_forest_region,a.target.value);this.forceUpdate()}onMinimumTilesPerDesertRegion(a){this.state.maximum_tiles_per_desert_region<parseInt(a.target.value)&&(this.state.maximum_tiles_per_desert_region=parseInt(a.target.value),this.forceUpdate());this.state.minimum_tiles_per_desert_region=
a.target.value}onMaximumTilesPerDesertRegion(a){this.state.maximum_tiles_per_desert_region=this.preventLower(this.state.minimum_tiles_per_desert_region,a.target.value);this.forceUpdate()}onMinimumTilesPerPlainsRegion(a){this.state.maximum_tiles_per_plains_region<parseInt(a.target.value)&&(this.state.maximum_tiles_per_plains_region=parseInt(a.target.value),this.forceUpdate());this.state.minimum_tiles_per_plains_region=a.target.value}onMaximumTilesPerPlainsRegion(a){this.state.maximum_tiles_per_plains_region=
this.preventLower(this.state.minimum_tiles_per_plains_region,a.target.value);this.forceUpdate()}onMinimumTilesPerJungleRegion(a){this.state.maximum_tiles_per_jungle_region<parseInt(a.target.value)&&(this.state.maximum_tiles_per_jungle_region=parseInt(a.target.value),this.forceUpdate());this.state.minimum_tiles_per_jungle_region=a.target.value}onMaximumTilesPerJungleRegion(a){this.state.maximum_tiles_per_jungle_region=this.preventLower(this.state.minimum_tiles_per_jungle_region,a.target.value);this.forceUpdate()}onMinimumTilesPerSwampsRegion(a){this.state.maximum_tiles_per_swamps_region<
parseInt(a.target.value)&&(this.state.maximum_tiles_per_swamps_region=parseInt(a.target.value),this.forceUpdate());this.state.minimum_tiles_per_swamps_region=a.target.value}onMaximumTilesPerSwampsRegion(a){this.state.maximum_tiles_per_swamps_region=this.preventLower(this.state.minimum_tiles_per_swamps_region,a.target.value);this.forceUpdate()}onMinimumTilesPerTundraRegion(a){this.state.maximum_tiles_per_tundra_region<parseInt(a.target.value)&&(this.state.maximum_tiles_per_tundra_region=parseInt(a.target.value),
this.forceUpdate());this.state.minimum_tiles_per_tundra_region=a.target.value}onMaximumTilesPerTundraRegion(a){this.state.maximum_tiles_per_tundra_region=this.preventLower(this.state.minimum_tiles_per_tundra_region,a.target.value);this.forceUpdate()}preventAllBiomesProbabilitySetToZero(){return 0==parseInt(this.state.mountains_probability)&&0==parseInt(this.state.forest_probability)&&0==parseInt(this.state.desert_probability)&&0==parseInt(this.state.plains_probability)&&0==parseInt(this.state.jungle_probability)&&
0==parseInt(this.state.swamps_probability)&&0==parseInt(this.state.tundra_probability)?!0:!1}onForestProbability(a){this.state.forest_probability=a.target.value;this.preventAllBiomesProbabilitySetToZero()&&(this.state.forest_probability=1,this.forceUpdate())}onDesertProbability(a){this.state.desert_probability=a.target.value;this.preventAllBiomesProbabilitySetToZero()&&(this.state.desert_probability=1,this.forceUpdate())}onPlainsProbability(a){this.state.plains_probability=a.target.value;this.preventAllBiomesProbabilitySetToZero()&&
(this.state.plains_probability=1,this.forceUpdate())}onJungleProbability(a){this.state.jungle_probability=a.target.value;this.preventAllBiomesProbabilitySetToZero()&&(this.state.jungle_probability=1,this.forceUpdate())}onSwampsProbability(a){this.state.swamps_probability=a.target.value;this.preventAllBiomesProbabilitySetToZero()&&(this.state.swamps_probability=1,this.forceUpdate())}onTundraProbability(a){this.state.tundra_probability=a.target.value;this.preventAllBiomesProbabilitySetToZero()&&(this.state.tundra_probability=
1,this.forceUpdate())}onMinimumNumberOfSettlements(a){this.state.maximum_number_of_settlements<parseInt(a.target.value)&&(this.state.maximum_number_of_settlements=parseInt(a.target.value),this.forceUpdate());this.state.minimum_number_of_settlements=a.target.value}onMaximumNumberOfSettlements(a){this.state.maximum_number_of_settlements=this.preventLower(this.state.minimum_number_of_settlements,a.target.value);this.forceUpdate()}onCitiesProbability(a){this.state.cities_probability=a.target.value}onTownsProbability(a){this.state.towns_probability=
a.target.value}onVillagesProbability(a){this.state.villages_probability=a.target.value}onMinimumNumberOfDwellings(a){this.state.maximum_number_of_dwellings<parseInt(a.target.value)&&(this.state.maximum_number_of_dwellings=parseInt(a.target.value),this.forceUpdate());this.state.minimum_number_of_dwellings=a.target.value}onMaximumNumberOfDwellings(a){this.state.maximum_number_of_dwellings=this.preventLower(this.state.minimum_number_of_dwellings,a.target.value);this.forceUpdate()}onHouseProbability(a){this.state.house_probability=
a.target.value}onStrongholdProbability(a){this.state.stronghold_probability=a.target.value}onMinimumNumberOfInns(a){this.state.maximum_number_of_inns<parseInt(a.target.value)&&(this.state.maximum_number_of_inns=parseInt(a.target.value),this.forceUpdate());this.state.minimum_number_of_inns=a.target.value}onMaximumNumberOfInns(a){this.state.maximum_number_of_inns=this.preventLower(this.state.minimum_number_of_inns,a.target.value);this.forceUpdate()}onMinimumNumberOfDungeons(a){this.state.maximum_number_of_dungeons<
parseInt(a.target.value)&&(this.state.maximum_number_of_dungeons=parseInt(a.target.value),this.forceUpdate());this.state.minimum_number_of_dungeons=a.target.value}onMaximumNumberOfDungeons(a){this.state.maximum_number_of_dungeons=this.preventLower(this.state.minimum_number_of_dungeons,a.target.value);this.forceUpdate()}onTombsProbability(a){this.state.tombs_probability=a.target.value}onTemplesProbability(a){this.state.temples_probability=a.target.value}onCavesProbability(a){this.state.caves_probability=
a.target.value}onPreferSmallDungeons(a){this.state.prefer_small_dungeons=!this.state.prefer_small_dungeons}onMinimumNumberOfFactions(a){this.state.maximum_number_of_factions<parseInt(a.target.value)&&(this.state.maximum_number_of_factions=parseInt(a.target.value),this.forceUpdate());this.state.minimum_number_of_factions=a.target.value}onMaximumNumberOfFactions(a){this.state.maximum_number_of_factions=this.preventLower(this.state.minimum_number_of_factions,a.target.value);this.forceUpdate()}onCultsProbability(a){this.state.cults_probability=
a.target.value}onMilitiasProbability(a){this.state.militias_probability=a.target.value}onSyndicatesProbability(a){this.state.syndicates_probability=a.target.value}onWanderingMonstersMaxHD(a){this.state.wandering_monsters_max_hd=a.target.value}onTreasureFactor(a){this.state.treasure_factor=a.target.value}onScrollMod(a){this.state.scroll_mod=a.target.value;this.compile_timeout&&window.clearTimeout(this.compile_timeout);this.compile_timeout=window.setTimeout(()=>{this.setState({compiler:1});fetch("/compile/",
{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,module_id:this.state.scroll_mod})}).then(b=>b.json()).then(b=>{b.okay?this.setState({compiler:2}):this.setState({compiler:-9})}).catch(b=>{console.error("Error:",b)})},1E3)}onSubmit(){this.props.onOkay({RealmTypeKingdom:"RuledRealm",RealmTypeLands:"RuledRealm",RealmTypeDuchy:"RuledRealm",RealmTypeEmpire:"RuledRealm",RealmTypeIsland:"UnruledRealm"}[this.state.realm_type],
{realm_type:this.state.realm_type,minimum_number_of_regions:parseInt(this.state.minimum_number_of_regions),maximum_number_of_regions:parseInt(this.state.maximum_number_of_regions),mountains_probability:parseInt(this.state.mountains_probability),forest_probability:parseInt(this.state.forest_probability),desert_probability:parseInt(this.state.desert_probability),plains_probability:parseInt(this.state.plains_probability),jungle_probability:parseInt(this.state.jungle_probability),swamps_probability:parseInt(this.state.swamps_probability),
tundra_probability:parseInt(this.state.tundra_probability),minimum_tiles_per_mountains_region:parseInt(this.state.minimum_tiles_per_mountains_region),maximum_tiles_per_mountains_region:parseInt(this.state.maximum_tiles_per_mountains_region),minimum_tiles_per_forest_region:parseInt(this.state.minimum_tiles_per_forest_region),maximum_tiles_per_forest_region:parseInt(this.state.maximum_tiles_per_forest_region),minimum_tiles_per_desert_region:parseInt(this.state.minimum_tiles_per_desert_region),maximum_tiles_per_desert_region:parseInt(this.state.maximum_tiles_per_desert_region),
minimum_tiles_per_plains_region:parseInt(this.state.minimum_tiles_per_plains_region),maximum_tiles_per_plains_region:parseInt(this.state.maximum_tiles_per_plains_region),minimum_tiles_per_jungle_region:parseInt(this.state.minimum_tiles_per_jungle_region),maximum_tiles_per_jungle_region:parseInt(this.state.maximum_tiles_per_jungle_region),minimum_tiles_per_swamps_region:parseInt(this.state.minimum_tiles_per_swamps_region),maximum_tiles_per_swamps_region:parseInt(this.state.maximum_tiles_per_swamps_region),
minimum_tiles_per_tundra_region:parseInt(this.state.minimum_tiles_per_tundra_region),maximum_tiles_per_tundra_region:parseInt(this.state.maximum_tiles_per_tundra_region),minimum_number_of_settlements:parseInt(this.state.minimum_number_of_settlements),maximum_number_of_settlements:parseInt(this.state.maximum_number_of_settlements),cities_probability:parseInt(this.state.cities_probability),towns_probability:parseInt(this.state.towns_probability),villages_probability:parseInt(this.state.villages_probability),
minimum_number_of_dwellings:parseInt(this.state.minimum_number_of_dwellings),maximum_number_of_dwellings:parseInt(this.state.maximum_number_of_dwellings),house_probability:parseInt(this.state.house_probability),stronghold_probability:parseInt(this.state.stronghold_probability),minimum_number_of_inns:parseInt(this.state.minimum_number_of_inns),maximum_number_of_inns:parseInt(this.state.maximum_number_of_inns),minimum_number_of_dungeons:parseInt(this.state.minimum_number_of_dungeons),maximum_number_of_dungeons:parseInt(this.state.maximum_number_of_dungeons),
tombs_probability:parseInt(this.state.tombs_probability),temples_probability:parseInt(this.state.temples_probability),caves_probability:parseInt(this.state.caves_probability),prefer_small_dungeons:this.state.prefer_small_dungeons,minimum_number_of_factions:parseInt(this.state.minimum_number_of_factions),maximum_number_of_factions:parseInt(this.state.maximum_number_of_factions),cults_probability:parseInt(this.state.cults_probability),militias_probability:parseInt(this.state.militias_probability),syndicates_probability:parseInt(this.state.syndicates_probability),
wandering_monsters_max_hd:parseInt(this.state.wandering_monsters_max_hd),scroll_mod:this.state.scroll_mod,treasure_factor:parseFloat(this.state.treasure_factor)});this.setState({show:!1})}okay(a){this.props.onOkay(a);this.setState({show:!1})}cancel(){$$$module$libs$preact_router_module("/sandbox/"+this.props.instance)}render(a,b){return b.show?html$$module$dialogs` <!-- The Modal -->
      <div id="realm-generator" class="modal">
        <!-- Modal content -->
        <div class="modal-content modal-content-flex">
          <div class="modal-header">
            <span class="close">
              <a
                onClick="${c=>{this.cancel()}}"
              >
                ${"\u00d7"}
              </a>
            </span>
            <button form="generator-form" type="submit">GENERATE</button>
            <p>
              <small>
                Read more about building a sandbox in
                <a
                  style="text-decoration: underline; color: #aa5522"
                  href="https://docs.hexroll.app/building-a-sandbox/generating-a-realm/"
                  target="_blank"
                  ><strong>docs.hexroll.app</strong></a
                >
              </small>
            </p>
          </div>
          <div class="modal-body">
            <form id="generator-form" onSubmit="${this.onSubmit}">
              <h4 id="scale">Realm Template</h4>

              <p>
                <small>
                  Changing realm template options will preset the values in the
                  rest of this form for you to tweak further.
                </small>
              </p>

              <label for="realm_type">Realm Type:</label>

              <select
                name="realm_type"
                id="realm_type"
                value="${b.realm_type}"
                onInput="${this.onRealmType}"
              >
                <option value="RealmTypeEmpire">Empire</option>
                <option value="RealmTypeLands">Lands</option>
                <option value="RealmTypeKingdom" selected="selected">
                  Kingdom
                </option>
                <option value="RealmTypeDuchy">Duchy</option>
                <option value="RealmTypeIsland">Island</option>
              </select>

              <label for="realm_population">Population:</label>

              <select
                name="realm_population"
                id="realm_population"
                value="${b.realm_population}"
                onInput="${this.onRealmPopulation}"
              >
                <option value="now">Generate now</option>
                <option value="later">I'll add later</option>
              </select>

              <h4 id="terrain">Terrain</h4>
              <p>
                <small>
                  Tame the number of generated regions, biomes probabilities and
                  number of hexes per region.
                </small>
              </p>

              <h5>Number of regions</h5>
              <label for="minimum_number_of_regions">Generate between </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.minimum_number_of_regions}"
                onInput="${this.onMinimumNumberOfRegions}"
                min="1"
                max="32"
                pattern="[0-9]+"
                id="minimum_number_of_regions"
                name="minimum_number_of_regions"
              />
              <label for="maximum_number_of_regions"> to </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.maximum_number_of_regions}"
                onChange="${this.onMaximumNumberOfRegions}"
                min="1"
                max="32"
                pattern="[0-9]+"
                id="maximum_number_of_regions"
                name="maximum_number_of_regions"
              />
              <label for="maximum_number_of_regions"> regions. </label> <br />

              <div style="display:flex;">
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Mountains</title>
                    <use
                      xlink:href="${window.app.theme.svg}#mountains"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label
                      for="mountains_probability"
                      title="Probability Factor"
                    >
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.mountains_probability}"
                      onInput="${this.onMountainsProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="mountains_probability"
                      name="mountains_probability"
                    />
                  </div>

                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_mountains_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_mountains_region}"
                      onInput="${this.onMinimumTilesPerMountainsRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_mountains_region"
                      name="minimum_tiles_per_mountains_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_mountains_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_mountains_region}"
                      onChange="${this.onMaximumTilesPerMountainsRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_mountains_region"
                      name="maximum_tiles_per_mountains_region"
                    />
                  </div>
                </div>
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Forests</title>
                    <use
                      xlink:href="${window.app.theme.svg}#forest"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label for="forest_probability" title="Probability Factor">
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.forest_probability}"
                      onInput="${this.onForestProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="forest_probability"
                      name="forest_probability"
                    />
                  </div>

                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_forest_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_forest_region}"
                      onInput="${this.onMinimumTilesPerForestRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_forest_region"
                      name="minimum_tiles_per_forest_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_forest_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_forest_region}"
                      onChange="${this.onMaximumTilesPerForestRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_forest_region"
                      name="maximum_tiles_per_forest_region"
                    />
                  </div>
                </div>
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Plains/Grasslands</title>
                    <use
                      xlink:href="${window.app.theme.svg}#plains"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label for="plains_probability" title="Probability Factor">
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.plains_probability}"
                      onInput="${this.onPlainsProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="plains_probability"
                      name="plains_probability"
                    />
                  </div>

                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_plains_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_plains_region}"
                      onInput="${this.onMinimumTilesPerPlainsRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_plains_region"
                      name="minimum_tiles_per_plains_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_plains_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_plains_region}"
                      onChange="${this.onMaximumTilesPerPlainsRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_plains_region"
                      name="maximum_tiles_per_plains_region"
                    />
                  </div>
                </div>
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Deserts</title>
                    <use
                      xlink:href="${window.app.theme.svg}#desert"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label for="desert_probability" title="Probability Factor">
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.desert_probability}"
                      onInput="${this.onDesertProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="desert_probability"
                      name="desert_probability"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_desert_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_desert_region}"
                      onInput="${this.onMinimumTilesPerDesertRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_desert_region"
                      name="minimum_tiles_per_desert_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_desert_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_desert_region}"
                      onChange="${this.onMaximumTilesPerDesertRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_desert_region"
                      name="maximum_tiles_per_desert_region"
                    />
                  </div>
                </div>
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Jungles/Rainforests</title>
                    <use
                      xlink:href="${window.app.theme.svg}#jungle"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label for="jungle_probability" title="Probability Factor">
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.jungle_probability}"
                      onInput="${this.onJungleProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="jungle_probability"
                      name="jungle_probability"
                    />
                  </div>

                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_jungle_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_jungle_region}"
                      onInput="${this.onMinimumTilesPerJungleRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_jungle_region"
                      name="minimum_tiles_per_jungle_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_jungle_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_jungle_region}"
                      onChange="${this.onMaximumTilesPerJungleRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_jungle_region"
                      name="maximum_tiles_per_jungle_region"
                    />
                  </div>
                </div>
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Wetlands</title>
                    <use
                      xlink:href="${window.app.theme.svg}#swamps"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label for="swamps_probability" title="Probability Factor">
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.swamps_probability}"
                      onInput="${this.onSwampsProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="swamps_probability"
                      name="swamps_probability"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_swamps_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_swamps_region}"
                      onInput="${this.onMinimumTilesPerSwampsRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_swamps_region"
                      name="minimum_tiles_per_swamps_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_swamps_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_swamps_region}"
                      onChange="${this.onMaximumTilesPerSwampsRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_swamps_region"
                      name="maximum_tiles_per_swamps_region"
                    />
                  </div>
                </div>
                <div style="width:110px">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="background:none; max-width:100px; height:100px;"
                  >
                    <title>Tundras</title>
                    <use
                      xlink:href="${window.app.theme.svg}#tundra"
                      transform="translate(50,50) scale(${window.app.theme.generate_thumbnail_scale})"
                    />
                  </svg>
                  <div style="display:block;">
                    <label for="tundra_probability" title="Probability Factor">
                      ${"P\u00d7"}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.tundra_probability}"
                      onInput="${this.onTundraProbability}"
                      min="0"
                      max="10"
                      pattern="[0-9]+"
                      id="tundra_probability"
                      name="tundra_probability"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="minimum_tiles_per_tundra_region"
                      title="Minimum Number of Hexes Per Region"
                    >
                      ${">="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.minimum_tiles_per_tundra_region}"
                      onInput="${this.onMinimumTilesPerTundraRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="minimum_tiles_per_tundra_region"
                      name="minimum_tiles_per_tundra_region"
                    />
                  </div>
                  <div style="display:block;">
                    <label
                      for="maximum_tiles_per_tundra_region"
                      title="Maximum Number of Hexes per Region"
                    >
                      ${"<="}
                    </label>
                    <input
                      required
                      style="text-align:center"
                      size="3"
                      type="number"
                      value="${b.maximum_tiles_per_tundra_region}"
                      onChange="${this.onMaximumTilesPerTundraRegion}"
                      min="1"
                      max="50"
                      pattern="[0-9]+"
                      id="maximum_tiles_per_tundra_region"
                      name="maximum_tiles_per_tundra_region"
                    />
                  </div>
                </div>
              </div>

              <h4 id="dungeons">Dungeons</h4>
              <p>
                <small>
                  Generated dungeons will hold monsters, treasure and will open
                  up additional quest opportunities by other NPCs.
                </small>
              </p>
              <h5>Number of dungeons</h5>
              <label for="minimum_number_of_dungeons">Generate between </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.minimum_number_of_dungeons}"
                onInput="${this.onMinimumNumberOfDungeons}"
                min="0"
                max="18"
                pattern="[0-9]+"
                id="minimum_number_of_dungeons"
                name="minimum_number_of_dungeons"
              />
              <label for="maximum_number_of_dungeons"> to </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.maximum_number_of_dungeons}"
                onChange="${this.onMaximumNumberOfDungeons}"
                min="0"
                max="18"
                pattern="[0-9]+"
                id="maximum_number_of_dungeons"
                name="maximum_number_of_dungeons"
              />
              <label for="maximum_number_of_dungeons"> dungeons. </label> <br />

              <h5>Dungeon types probability</h5>
              <label for="caves_probability" title="Probability Factor">
                Caves ${"P\u00d7"}
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.caves_probability}"
                onInput="${this.onCavesProbability}"
                min="0"
                max="10"
                pattern="[0-9]+"
                id="caves_probability"
                name="caves_probability"
              />

              <label for="temples_probability" title="Probability Factor">
                Temples ${"P\u00d7"}
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.temples_probability}"
                onInput="${this.onTemplesProbability}"
                min="0"
                max="10"
                pattern="[0-9]+"
                id="temples_probability"
                name="temples_probability"
              />

              <label for="tombs_probability" title="Probability Factor">
                Tombs ${"P\u00d7"}
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.tombs_probability}"
                onInput="${this.onTombsProbability}"
                min="0"
                max="10"
                pattern="[0-9]+"
                id="tombs_probability"
                name="tombs_probability"
              />

              <h5>Dungeons Size</h5>

              <label for="prefer_small_dungeons" title="Prefer small dungeons">
                Prefer small dungeons
              </label>
              <input
                style=""
                type="checkbox"
                value="${b.prefer_small_dungeons}"
                onInput="${this.onPreferSmallDungeons}"
                id="prefer_small_dungeons"
                name="prefer_small_dungeons"
              />

              <h5>Wandering Monsters</h5>
              <label for="highest_wandering_monster_hitdice_in_dungeons">
                Wandering monsters highest HD is
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="3"
                min="1"
                max="15"
                value="${b.wandering_monsters_max_hd}"
                onInput="${this.onWanderingMonstersMaxHD}"
                pattern="[0-9]+"
                id="highest_wandering_monster_hitdice_in_dungeons"
                name="highest_wandering_monster_hitdice_in_dungeons"
              />
              <br />

              <h4 id="settlements">Settlements</h4>
              <p>
                <small>
                  Settlements is where most NPCs, taverns, shops and services
                  reside.
                </small>
              </p>
              <h5>Number of settlements</h5>
              <label for="minimum_number_of_settlements"
                >Generate between
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="12"
                value="${b.minimum_number_of_settlements}"
                onInput="${this.onMinimumNumberOfSettlements}"
                pattern="[0-9]+"
                id="minimum_number_of_settlements"
                name="minimum_number_of_settlements"
              />
              <label for="maximum_number_of_settlements"> to </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="12"
                pattern="[0-9]+"
                value="${b.maximum_number_of_settlements}"
                onChange="${this.onMaximumNumberOfSettlements}"
                id="maximum_number_of_settlements"
                name="maximum_number_of_settlements"
              />
              <label for="maximum_number_of_settlements"> settlements. </label>
              <br />

              <h5>Settlement types probability</h5>
              <label for="cities_probability"> Cities: </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="10"
                pattern="[0-9]+"
                value="${b.cities_probability}"
                onInput="${this.onCitiesProbability}"
                id="cities_probability"
                name="cities_probability"
              />

              <label for="towns_probability"> Towns: </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="10"
                pattern="[0-9]+"
                value="${b.towns_probability}"
                onInput="${this.onTownsProbability}"
                id="towns_probability"
                name="towns_probability"
              />

              <label for="villages_probability"> Villages: </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="10"
                pattern="[0-9]+"
                value="${b.villages_probability}"
                onInput="${this.onVillagesProbability}"
                id="villages_probability"
                name="villages_probability"
              />

              <h4 id="inns">Inns</h4>
              <h5>Number of inns (not in settlements)</h5>
              <label for="minimum_number_of_inns">Generate between </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.minimum_number_of_inns}"
                onInput="${this.onMinimumNumberOfInns}"
                min="0"
                max="9"
                pattern="[0-9]+"
                id="minimum_number_of_inns"
                name="minimum_number_of_inns"
              />
              <label for="maximum_number_of_inns"> to </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.maximum_number_of_inns}"
                onChange="${this.onMaximumNumberOfInns}"
                min="0"
                max="9"
                pattern="[0-9]+"
                id="maximum_number_of_inns"
                name="maximum_number_of_inns"
              />
              <label for="maximum_number_of_inns"> inns. </label> <br />
              <br />

              <h4 id="dwellings">Dwellings</h4>
              <p>
                <small>
                  Dwellings are isolated places of residence that can provide
                  additional encounter opportunities.
                </small>
              </p>
              <h5>Number of dwellings</h5>
              <label for="minimum_number_of_dwellings">Generate between </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="12"
                value="${b.minimum_number_of_dwellings}"
                onInput="${this.onMinimumNumberOfDwellings}"
                pattern="[0-9]+"
                id="minimum_number_of_dwellings"
                name="minimum_number_of_dwellings"
              />
              <label for="maximum_number_of_dwellings"> to </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="12"
                pattern="[0-9]+"
                value="${b.maximum_number_of_dwellings}"
                onChange="${this.onMaximumNumberOfDwellings}"
                id="maximum_number_of_dwellings"
                name="maximum_number_of_dwellings"
              />
              <label for="maximum_number_of_dwellings"> dwellings. </label>
              <br />

              <h5>Dwelling types probability</h5>
              <label for="house_probability"> Farms & Cabins: </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="10"
                pattern="[0-9]+"
                value="${b.house_probability}"
                onInput="${this.onHouseProbability}"
                id="house_probability"
                name="house_probability"
              />

              <label for="stronghold_probability"> Strongholds: </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                min="0"
                max="10"
                pattern="[0-9]+"
                value="${b.stronghold_probability}"
                onInput="${this.onStrongholdProbability}"
                id="stronghold_probability"
                name="stronghold_probability"
              />

              <br />

              <h4 id="factions">Factions</h4>
              <p>
                <small>
                  Factions provide more potential storylines and use NPCs
                  generated earlier as members or collaborators.
                </small>
              </p>
              <h5>Number of factions</h5>
              <label for="minimum_number_of_factions">Generate between </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.minimum_number_of_factions}"
                onInput="${this.onMinimumNumberOfFactions}"
                min="0"
                max="7"
                pattern="[0-9]+"
                id="minimum_number_of_factions"
                name="minimum_number_of_factions"
              />
              <label for="maximum_number_of_factions"> to </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.maximum_number_of_factions}"
                onChange="${this.onMaximumNumberOfFactions}"
                min="0"
                max="7"
                pattern="[0-9]+"
                id="maximum_number_of_factions"
                name="maximum_number_of_factions"
              />
              <label for="maximum_number_of_factions"> factions. </label> <br />

              <h5>Faction types probability</h5>
              <label for="cults_probability" title="Probability Factor">
                Cults ${"P\u00d7"}
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.cults_probability}"
                onInput="${this.onCultsProbability}"
                min="0"
                max="10"
                pattern="[0-9]+"
                id="cults_probability"
                name="cults_probability"
              />

              <label for="militias_probability" title="Probability Factor">
                Militias ${"P\u00d7"}
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.militias_probability}"
                onInput="${this.onMilitiasProbability}"
                min="0"
                max="10"
                pattern="[0-9]+"
                id="militias_probability"
                name="militias_probability"
              />

              <label for="syndicates_probability" title="Probability Factor">
                Syndicates ${"P\u00d7"}
              </label>
              <input
                required
                style="text-align:center"
                size="3"
                type="number"
                value="${b.syndicates_probability}"
                onInput="${this.onSyndicatesProbability}"
                min="0"
                max="10"
                pattern="[0-9]+"
                id="syndicates_probability"
                name="syndicates_probability"
              />
              <h4>Scroll Mods</h4>
              <label for="scroll-mod" title="Scroll ID">
                Scroll Id (8 characters)</label
              >
              <input
                style="text-align: center; letter-spacing:0.25em;"
                value="${b.scroll_mod}"
                pattern="[A-Za-z0-9][A-Za-z0-9][A-Za-z0-9][A-Za-z0-9][A-Za-z0-9][A-Za-z0-9][A-Za-z0-9][A-Za-z0-9]"
                placeholder="________"
                onInput="${this.onScrollMod}"
                size="7"
                maxlength="8"
                id="scroll-mod"
                name="scroll-mod"
              />
              <span style="font-family:'Oswald'; font-size:75%;"
                >${0==b.compiler?html$$module$dialogs``:1==b.compiler?html$$module$dialogs`
                        <span style="color:#222277">
                          <i class="fa fa-hourglass" /> Compiling
                        </span>
                      `:2==b.compiler?html$$module$dialogs`
                          <span style="color:#227722">
                            <i class="fa fa-dice" /> This scroll works!
                          </span>
                        `:html$$module$dialogs` <span style="color:#772222">
                          <i class="fa fa-bug" />
                          This scroll does not work!</span
                        >`}</span
              >

              <h4>Tweaks and Experiments</h4>
              <label for="treasure_factor"> Treasure Multiplier ${"T\u00d7"} </label>
              <input
                required
                style="text-align:center"
                size="5"
                type="number"
                value="${b.treasure_factor}"
                onInput="${this.onTreasureFactor}"
                min="0.01"
                max="10"
                step="0.01"
                pattern="[0-9.]+"
                id="treasure_factor"
                name="treasure_factor"
              />
              <p>
                <small>
                  Any generated treasure value will be multiplied by this value.
                </small>
              </p>
            </form>
          </div>
        </div>
      </div>`:html$$module$dialogs``}}var module$dialogs={};module$dialogs.GenerateRealmDialog=GenerateRealmDialog$$module$dialogs;const html$$module$hexview=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),is_mobile$$module$hexview=navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/),dice_enabled$$module$hexview=!is_mobile$$module$hexview&&!is_electron$$module$api_shim;class Toggles$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({visible:!0})}onLock(){this.setState({visible:!this.state.visible})}render(a,b){return html$$module$hexview`
      <div>
        <div style="display:inline-block; width:1.5em;">
          <a title="Map Toggles" onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${"fa-toggle-on"}"></i>
          </a>
        </div>
        <${Slider$$module$utils}
          id="toggle-labels"
          switch=${!b.visible}
          visible=${()=>html$$module$hexview`
              <a
                title="Toggle Labels [L]"
                onClick="${()=>a.onToggleLabels()}"
                ><i class="fa fa-solid fa-eye"></i>
              </a>
              <a
                title="Toggle Map Colors"
                onClick="${()=>a.onTogglePalette()}"
                ><i class="fa fa-solid fa-palette"></i>
              </a>
              ${!is_electron$$module$api_shim&&html$$module$hexview`
                <a
                  title="Change Map Theme"
                  onClick="${()=>a.onToggleTheme()}"
                  ><i class="fa fa-solid fa-paintbrush"></i>
                </a>
              `}
              ${dice_enabled$$module$hexview&&html$$module$hexview` <a
                title="Toggle Dice Bar [R]"
                onClick="${()=>a.onToggleDice()}"
              >
                <svg
                  style="position:relative; top:7px; filter: drop-shadow(#00000088 3px 3px 4px); "
                  width="10mm"
                  height="10mm"
                  version="1.1"
                  viewBox="-15.5 -15.5 31 31"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="m0.949-14.5c-9e-3 0.126-0.0274 0.393-0.0274 0.393 6e-3 0.386-0.143 1.1 0.569 1.32 1.82 0.559 4.82 1.32 6.66 1.81-1.96-1.02-5.23-2.53-7.2-3.53zm-1.95 0.0873c-3.65 0.998-5.25 1.55-7.61 3.29 1.95-0.518 4.57-1.05 6.45-1.7 0.587-0.289 1.56-1.38 1.16-1.6zm-0.843 3.27c-2.81 0.69-5.85 1.54-9.94 2.73 0.437 3.53 1.05 7.25 2.41 10.7 2.59-4.43 5.14-8.88 7.52-13.4zm3.68 0.0334c0.567 1.11 3.07 5.77 7.43 13.4 1.14-3.27 2.05-6.86 1.99-10.4-3.85-1.33-5.64-2.09-9.43-3.01zm-1.79 0.304-8.09 14.2c5.33-0.01 10.7 0.0298 16-0.0527-2.62-4.72-5.3-9.41-7.9-14.1zm12.8 6.51c-0.632 3.02-1.45 5.77-2.41 8.3 0.836 0.687 1.64 1.41 2.48 2.1 0.229-3.18 0.539-7.13-0.0687-10.4zm-25.8 0.0837c-0.378 3.41-0.248 6.91 0.0367 10.3 0.817-0.681 1.68-1.32 2.38-2.13-0.871-2.53-1.45-5.7-2.42-8.2zm11.8 9.19c-2.98 9e-3 -5.59 0.0591-6.54 0.122v0c2.46 3.22 5.02 6.36 7.7 9.4 2.67-3.02 5.18-6.18 7.63-9.39-2.45-0.106-5.81-0.139-8.79-0.131zm10.7 0.481c-0.855 1.07-1.71 2.15-2.57 3.22-1.12 1.41-2.24 2.81-3.37 4.22 2.9-1.7 5.78-3.45 8.67-5.18-0.891-0.777-1.78-1.56-2.73-2.26zm-19.1 0.0154c-0.901 0.745-1.83 1.46-2.65 2.29 2.87 1.8 5.79 3.51 8.71 5.23-2.01-2.52-4.03-5.02-6.06-7.53z"
                    fill="currentColor"
                  />
                </svg>
              </a>`}
              <a
                title=${a.spoilers_on?"Switch No-Spoilers On":"Switch No-Spoilers Off"}
                onClick="${()=>a.onToggleSpoilers()}"
                ><i
                  style="${!a.spoilers_on&&"color: #df286d"}"
                  class="fa fa-solid fa-mask"
                ></i>
              </a>
              ${is_electron$$module$api_shim||html$$module$hexview`<a
                title=${a.vttLive?"Switch VTT Off":"Switch VTT On"}
                onClick="${()=>a.onVtt()}"
                ><i
                  style="${a.vttLive&&"color: #df286d"}"
                  class="fa fa-solid fa-share-nodes"
                ></i>
              </a>`}
            `}
        />
      </div>
    `}}
class Toolbar$$module$hexview extends k$$module$libs$preact{constructor(){super();this.state={locked:!0}}componentWillUpdate(a){1==a.hidden&&0==this.props.hidden&&this.setState({locked:!0});this.setState({in_edit:"edit"==a.mode})}onLock(){this.setState({locked:!this.state.locked});this.state.locked?document.querySelectorAll(".btn-icon-hidden").forEach(function(a){a.classList.replace("btn-icon-hidden","btn-icon")}):document.querySelectorAll(".btn-icon").forEach(function(a){a.classList.replace("btn-icon","btn-icon-hidden")})}render(a,
b){return is_electron$$module$api_shim?html$$module$hexview``:html$$module$hexview`
      <div id="header-menu">
        <div style="float:right;display:inline-block; width:1.5em;">
          <a
            title="Edit this page [P]"
            class="${(b.in_edit||"coords"==a.type)&&"disabled"}"
            onclick="${()=>{this.setState({in_edit:!0});a.onEdit()}}"
            ><i class="fa fa-feather"></i
          ></a>
        </div>
        <div style="display:inline-block; width:1.5em;">
          <a
            title=${b.locked?"Unlock this page":"Lock this page"}
            class="${(b.in_edit||"toc"===a.type)&&"disabled"}"
            onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${b.locked?"fa-lock":"fa-lock-open"}"></i>
          </a>
        </div>
        <${Slider$$module$utils}
          id="drawer-append2"
          switch=${!b.locked}
          visible=${()=>html$$module$hexview`
              <a
                title="Reroll this page"
                class="${(b.in_edit||"toc"===a.type)&&"disabled"}"
                onclick="${()=>a.onReroll()}"
                ><i class="fa fa-dice"></i
              ></a>
            `}
        />
      </div>
    `}}class Drawer$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({locked:window.app.locked})}onLock(){window.app.locked=!window.app.locked;this.setState({locked:window.app.locked});this.props.onLock(window.app.locked)}render(a,b){return html$$module$hexview`
      <div>
        <div style="display:inline-block; width:1.5em;">
          <a
            title=${b.locked?"Unlock sandbox for editing":"Lock sandbox for editing"}
            class="${window.app.solo_mode&&"disabled"}"
            onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${b.locked?"fa-lock":"fa-lock-open"}"></i>
          </a>
        </div>
        <${Slider$$module$utils}
          id="drawer-append"
          switch=${!b.locked}
          visible=${()=>html$$module$hexview` <a
              title="Roll a Realm"
              onClick="${()=>a.onAppend()}"
              ><i class="fa fa-solid fa-circle-plus"></i>
            </a>`}
        />
      </div>
    `}}
class EntityEditor$$module$hexview extends k$$module$libs$preact{constructor(){super()}componentDidMount(a,b,c){let d=this;this.editor=tinymce.init({images_upload_handler:()=>Promise.reject({remove:!0}),protect:[/<a class="npc-anchor" id="[a-z0-9]*"><\/a>/g,/<style>.*<\/style>/g],relative_urls:!1,extended_valid_elements:"span[*]",document_base_url:window.location.hostname,inline:!0,formats:{"my-inline":{title:"checked HP",selector:"span.hp-mark",inline:"span",classes:["hp-mark-checked"]}},toolbar_persist:!0,
selector:"#entity"+this.props.toggle,promotion:!1,menubar:!1,statusbar:!1,toolbar_mode:"floating",toolbar_sticky:!0,fixed_toolbar_container:"#editor-toolbar",toolbar:"exit save | undo redo | link image | formatting | checkhp | revert",end_container_on_empty_block:"blockquote,span",style_formats:[{title:"Notes",items:[{title:"Default",block:"p",inline:"span",classes:["notes"],merge_siblings:!0,block_expand:!0}]},{title:"Headings",items:[{title:"Heading 1",format:"h5"},{title:"Heading 2",format:"h6"}]},
{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",
format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],toolbar_groups:{formatting:{icon:"format",tooltip:"Formatting",items:"styles | bold italic | table |  alignleft aligncenter alignright alignjustify | outdent indent | bullist "}},plugins:"advlist link image lists table fullscreen save image",quickbars_insert_toolbar:!1,quickbars_selection_toolbar:"styles | bold italic |  alignleft aligncenter alignright alignjustify | outdent indent | bullist  | checkhp",
table_default_attributes:{border:"0"},save_onsavecallback:()=>this.props.onSave(!0),setup:function(e){e.on("init",()=>{let g=e.getBody().querySelectorAll("a");for(let n of g)n.addEventListener("click",t=>{t.preventDefault();t.stopPropagation();return!1})});e.ui.registry.addButton("checkhp",{text:"Toggle HP",icon:"table-delete-table",classes:"ampforwp-copy-content-button ",tooltip:"Mark lost monster hit points",onAction:function(){tinymce.activeEditor.formatter.toggle("my-inline");tinymce.activeEditor.setDirty(!0)}});
e.ui.registry.addButton("revert",{text:"Revert",icon:"remove",classes:"ampforwp-copy-content-button ",tooltip:"Revert back to the generated version",onAction:function(){tinymce.activeEditor.windowManager.confirm("Are you sure you want to revert back to the generated page and lose your changes?",g=>{g&&(tinymce.activeEditor.setContent(""),d.props.onSave(!0))})}});e.ui.registry.addButton("exit",{icon:"browse",classes:"ampforwp-copy-content-button ",tooltip:"Discard Edits [ESC]",onAction:function(){d.props.onSave(!1)}})}}).then(()=>
{this.props.onEditorActive();tinymce.activeEditor.focus();this.setRename()})}setRename(){document.getElementById("editable-title")&&(document.getElementById("editable-title").setAttribute("contenteditable",!0),document.getElementById("editable-title").style["text-transform"]="none",document.getElementById("editable-title").addEventListener("keydown",a=>{"Escape"===a.code&&history.go(-1);if("Enter"===a.code)return tinymce.activeEditor.focus(),a.preventDefault(),a.stopPropagation(),this.props.onSave(!1),
!1}),document.getElementById("editable-title").addEventListener("keydown",a=>{if(66<a.target.innerText.length&&"Backspace"!=a.code&&"Delete"!=a.code&&"ArrowLeft"!=a.code&&"ArrowRight"!=a.code)return a.preventDefault(),a.stopPropagation(),!1}),document.getElementById("editable-title").addEventListener("input",a=>{const b=a.target.innerText;window.clearTimeout(this.rename_timeout);this.rename_timeout=window.setTimeout(()=>{fetch("/rename/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},
body:JSON.stringify({instance:this.props.instance,entity:a.target.attributes["data-entity"]?a.target.attributes["data-entity"].value:this.props.hex_uuid,attr:a.target.attributes["data-attr"].value,value:a.target.innerText})}).then(c=>c.text()).then(c=>{document.getElementById("editable-title").innerText=b;a.target.attributes["data-map-label"]&&this.props.onReloadMap()}).catch(c=>{console.error("Error:",c)})},2E3)},!1))}componentWillUnmount(){tinymce.remove()}render(){return html$$module$hexview`<div id="editor-toolbar"></div>`}}
class HexView$$module$hexview extends k$$module$libs$preact{constructor(){super();this.state={html:"",coords:{},appending:!1,waiting:!0,toggle:1,map_locked:!0,show_labels:1,desaturate_palette:!1,spoilers_on:!0,showReadme:!1,showSolo:!1,showHelp:!1,showTokenChooser:!1,packaging:!1,snackbar:!1,backpack_link:null,ephemeral:!1,modalOn:!1,activateEditor:!1,vtt_live:!1,show_dice_bar:!1,loaded:!1};this.onLock=this.onLock.bind(this);this.closeSnackbar=this.closeSnackbar.bind(this);this.appendCall=this.appendCall.bind(this);
this.appendDialog=this.appendDialog.bind(this);this.onToggleLabels=this.onToggleLabels.bind(this);this.onToggleDice=this.onToggleDice.bind(this);this.onTogglePalette=this.onTogglePalette.bind(this);this.onToggleTheme=this.onToggleTheme.bind(this);this.onToggleSpoilers=this.onToggleSpoilers.bind(this);this.onEditorActive=this.onEditorActive.bind(this);this.reroll=this.reroll.bind(this);this.append=this.append.bind(this);this.onReadme=this.onReadme.bind(this);this.toggleSpinner=this.toggleSpinner.bind(this);
this.spinners=[!1,!1]}toggleModal(){this.setState({modalOn:!this.state.modalOn})}spinnerState(a,b){this.spinners[a]=b;return this.spinners[0]||this.spinners[1]}toggleSpinner(a,b){this.setState({waiting:this.spinnerState(a,b)})}onEditorActive(){tinymce.activeEditor.undoManager.clear()}navigatedToOceanHexOnMount(){return"coords"==this.props.type?(this.get_ocean(),this.map.postMapLoaded(()=>{const a=parse_canonical_coords$$module$utils(this.props.hex_uuid);this.map.map_data.addOceanHex(a.x,a.y);this.map.navigateToHex(this.props.hex_uuid)}),
!0):!1}gotEntityForEditingOnMount(){return"edit"==this.props.mode?(this.get_entity(this.props.hex_uuid,()=>{this.preprocessContentForEdit();this.setState({activateEditor:!0})},!0),!0):!1}patchTocProps(a){"view"==a.mode&&"root"==a.hex_uuid&&(a.hex_uuid=a.instance,a.type="toc")}componentDidMount(a,b,c){window.app.solo_mode="solo"==this.props.mode||"new-solo"==this.props.mode;"new-solo"==this.props.mode&&(this.setState({show_labels:10,spoilers_on:!1}),window.setTimeout(()=>{saveState$$module$state(this.props.instance,
"solo")},500));this.props.mode="new-solo"==this.props.mode?"append":this.props.mode;window.addEventListener("keydown",d=>this.onKeyDown(d));this.patchTocProps(this.props);"vtt"==this.props.mode?window.app.vtt_on(this.props.instance):window.app.vtt_referee=!0;restoreState$$module$state(this.props.instance,"default",d=>{this.map.map_data.apply_theme_effects();window.app.vtt_referee&&(window.app.solo_mode="solo"==this.props.mode||d.state.solo_mode,this.setState({show_labels:window.app.solo_mode?10:d.state.show_labels,
show_dice_bar:d.state.show_dice_bar,desaturate_palette:d.state.desaturate_palette,spoilers_on:window.app.solo_mode?!1:d.state.spoilers_on,loaded:!0}),this.map.hexpins=d.state.pins?d.state.pins:[])},()=>{this.setState({loaded:!0})});this.props.hex_uuid&&(this.navigatedToOceanHexOnMount()||this.gotEntityForEditingOnMount()||this.get_entity(this.props.hex_uuid));this.map&&this.map.sizeToFit();"append"==this.props.mode&&(this.toggleSpinner(0,!1),this.toggleSpinner(1,!1));api_call_version$$module$api_shim(this.props.instance).then(d=>
{this.setState({BACKEND_BUILD_ID:d.build})});is_electron$$module$api_shim||fetch("/mode/"+this.props.instance,{method:"GET"}).then(d=>d.json()).then(d=>{this.setState({ephemeral:d.ephemeral,showExpired:d.expired})}).catch(d=>{console.error("Error:",d)})}componentDidUpdate(a){void 0===a.hex_uuid&&(window.app.zooming_into_entity=!0);const b=this.props.hex_uuid!=a.hex_uuid;var c=a.mode!=this.props.mode;a="edit"==a.mode;const d="edit"==this.props.mode,e=a&&c;c=d&&c;this.props.hex_uuid?(e&&this.setState({activateEditor:!1}),
"coords"==this.props.type?this.navigatedToOceanHexOnMount():((b||e)&&this.get_entity(this.props.hex_uuid,()=>{d&&this.preprocessContentForEdit();d&&this.setState({activateEditor:!0})},d,!0,b),!b&&c&&this.setState({activateEditor:!0}),!b&&e&&this.setState({activateEditor:!1}))):(a&&this.setState({activateEditor:!1}),this.map.sizeToFit());"search"==this.props.mode&&(this.props.mode="normal",document.getElementById("search-input")&&document.getElementById("search-input").focus())}componentWillUpdate(a){this.patchTocProps(a);
"append"==a.mode&&(this.spinners[0]=!1,this.spinners[1]=!1)}postprocessContentByState(a){a&&this.toolbar.state.locked&&a.querySelectorAll(".btn-icon").forEach(function(b){b.classList.replace("btn-icon","btn-icon-hidden")})}preprocessContentForEdit(){let a=document.getElementById("entity"+this.toggle);a&&(a.querySelectorAll(".map-coords").forEach(function(b){b.remove()}),"edit"==this.props.mode&&a.querySelectorAll(".inactive-quest").forEach(function(b){b.remove()}))}crossDissolve(a,b){let c=document.getElementById("entity"+
this.toggle);if(!a)return c.innerHTML=b,this.postprocessContentByState(c),c;this.toggle=1==this.toggle?2:1;if(a=document.getElementById("entity"+this.toggle))a.innerHTML=b;this.postprocessContentByState(a);a&&a.classList.remove("hidden");c&&c.classList.add("hidden");window.clearTimeout(this.entity_timeout);this.entity_timeout=window.setTimeout(()=>{c&&(c.innerHTML="")},1E3);return a}get_ocean(){this.crossDissolve(!0,"Reroll this hex to generate its content.");const a=`
      <span class="breadcrumbs">
        <a href="/sandbox/${this.props.instance}">SANDBOX</a>
      </span>
      <br />
      The Vast Ocean
    `;document.getElementById("hex_title").innerHTML=a;document.title="Hex "+this.props.hex_uuid}get_entity(a,b,c=!1,d=!0,e=!0){d&&["entity-editor-placeholder"].map(n=>{document.getElementById(n)&&document.getElementById(n).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})});let g=document.implementation.createHTMLDocument();c&&api_call_html$$module$api_shim("view",this.props.instance,a).then(n=>{g.open();g.write(n);g.close();g.getElementById("title")&&(n=g.getElementById("title").innerHTML,
document.getElementById("hex_title").innerHTML=n)});api_call_html$$module$api_shim(this.props.mode,this.props.instance,a).then(n=>{if(this.toggle){var t=document.getElementById("entity"+this.toggle).innerHTML;if(n==t)return;this.last_data=n}t=this.crossDissolve(e,n);if(document.getElementById("title")){var w=document.getElementById("title").innerHTML;document.getElementById("title").remove();document.getElementById("hex_title").innerHTML=w;w=document.getElementById("doc-title");document.title=w?w.innerHTML:
"HEXROLL 2 - Roll a Sandbox";w&&document.getElementById("doc-title").remove()}this.props.npc&&(w=document.getElementById(this.props.npc))&&w.scrollIntoView(!0);if(t||"edit"==this.props.mode)if(t="edit"==this.props.mode?g.getElementsByClassName("map-coords")[0]:t&&t.getElementsByClassName("map-coords")[0])if(t.hasAttribute("hex")){const z=t.getAttribute("hex"),C=t.getAttribute("x"),H=t.getAttribute("y"),M=t.getAttribute("zoom");this.map.postMapLoaded(()=>{this.reveal_next_location&&(this.map.map_data.mark_as_visited(this.props.instance,
z),this.reveal_next_location=!1,this.setState({showSolo:!1}));this.map.navigateToHex(z,{x:C,y:H,zoom:M})})}else t.hasAttribute("region")?this.map.postMapLoaded(()=>{this.map.navigateToRegion(a)}):this.map.postMapLoaded(()=>{this.map.navigateToRealm(a)});else this.map.navigateToHex(a);b&&b(n)})}edit(a){$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid+"/edit")}onEditorClose(a){a?this.override(tinymce.activeEditor.getContent(),()=>{this.setState({activateEditor:!1});
$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid)}):(this.setState({activateEditor:!1}),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid))}override(a,b){fetch("/override/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:this.props.hex_uuid,content:a})}).then(c=>c.text()).then(c=>{b()}).catch(c=>
{console.error("Error:",c)})}append(a,b,c){fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:b,type:c})}).then(d=>d.text()).then(d=>{this.props.hex_uuid&&("coords"==this.props.type?this.get_ocean():this.get_entity(this.props.hex_uuid));this.map.getMatrix(!0)}).catch(d=>{console.error("Error:",d)})}reroll(a,b,c){if(!window.app.inhibit_rerolls)if("coords"==this.props.type)(b=this.map.map_data.getHexDataByUUID(this.props.hex_uuid))&&
this.appendCall("OceanHex",null,"ocean",b.x,b.y);else{this.toggleSpinner(0,!0);c=document.getElementsByClassName("fa-dice");for(let e of c)e.classList.add("rolled");window.app.inhibit_rerolls=!0;var d=this;void 0===a&&(a=this.props.hex_uuid);void 0===b&&(b="default");fetch("/reroll/"+this.props.instance+"/"+a+"/"+b,{method:"GET"}).then(e=>401===e.status?(window.app.unauth(),Promise.reject(e)):e.json()).then(e=>{if(e){var g=!1;for(const [,n]of window.app.reroll_handlers)n(),g=!0;g||this.map.getMatrix(!0);
a==this.props.hex_uuid?$$$module$libs$preact_router_module("/sandbox/"+d.props.instance+"/"+d.props.type+"/"+e.uuid,!0):(this.get_entity(this.props.hex_uuid,!1,!1,!1),void 0!==d.props.type&&$$$module$libs$preact_router_module("/sandbox/"+d.props.instance+"/"+d.props.type+"/"+this.props.hex_uuid,!0))}else{e=document.getElementsByClassName("fa-dice");for(g of e)g.classList.remove("rolled")}window.app.inhibit_rerolls=!1;this.toggleSpinner(0,!1)}).catch(e=>{this.toggleSpinner(0,!1);window.app.inhibit_rerolls=
!1;console.error("Error:",e)})}}appendCall(a,b,c="realms",d=null,e=null){this.toggleSpinner(0,!0);"realms"==c&&$$$module$libs$preact_router_module("/sandbox/"+this.props.instance);this.toggleSpinner(0,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:this.props.instance,attribute:c,type:a,nx:this.menu?this.menu.nx:d,ny:this.menu?this.menu.ny:e,params:JSON.stringify(b)})}).then(g=>g.json()).then(g=>
{this.setState({appending:!1,waiting:this.spinnerState(0,!1)});this.menu=null;this.props.hex_uuid?(this.map.postMapLoaded(()=>{$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+g.uuid,!0)}),"OceanHex"==a&&window.app.solo_mode&&this.map.map_data.mark_as_visited(this.props.instance,g.uuid)):window.app.solo_mode&&(this.setState({showSolo:!0}),this.reveal_next_location=!0);this.map.getMatrix(!0)}).catch(g=>{console.error("Error:",g)})}appendDialog(a){this.menu=a?a:null;$$$module$libs$preact_router_module("/sandbox/"+
this.props.instance+"/append");this.setState({appending:!0,waiting:this.spinnerState(0,!1)})}onReadme(){this.setState({showReadme:!this.state.showReadme})}onHotkeyMode(a,b={}){this.setState({hotkey_mode:a});b.hotkey_mode=a;this.map.setState(b);window.app.hotkey_mode=a}clearHotkeyState(){this.onHotkeyMode(!1);window.app.token_hotkey_mode=!1;window.app.flag_hotkey_mode=!1;window.app.kill_hotkey_mode=!1}showTokenChooser(a){this.tokens_callback=a;this.setState({showTokenChooser:!this.state.showTokenChooser});
this.clearHotkeyState()}onLock(a){this.setState({map_locked:a})}onExit(){window.api.quit()}closeSnackbar(){this.setState({snackbar:!1})}onPatreon(){window.location.href="/claim/"+this.props.instance}onQuickHelp(){this.setState({showHelp:!0})}onDownload(){this.setState({packaging:!0,snackbar:!0});fetch("/pack/"+this.props.instance,{method:"GET"}).then(a=>a.json()).then(a=>{this.setState({packaging:!1,backpack_link:a.filename,snackbar:!0})}).catch(a=>{this.setState({packaging:!1,backpack_link:null,
snackbar:!0});console.error("Error:",a)})}onToggleLabels(a){this.setState({show_labels:12>this.state.show_labels?this.state.show_labels+1:1});saveState$$module$state(this.props.instance,"default")}onToggleDice(a){this.setState({show_dice_bar:!this.state.show_dice_bar});saveState$$module$state(this.props.instance,"default")}onTogglePalette(a){this.setState({desaturate_palette:!this.state.desaturate_palette});saveState$$module$state(this.props.instance,"default")}onToggleTheme(a){nextTheme$$module$themes();
this.map.map_data.apply_theme_effects();this.forceUpdate();saveState$$module$state(this.props.instance,"default")}onToggleSpoilers(a){this.setState({spoilers_on:!this.state.spoilers_on});saveState$$module$state(this.props.instance,"default")}onVtt(){window.app.vtt_on(this.props.instance);let a=10;const b=window.setInterval(()=>{!this.state.vtt_live&&window.app.provider&&window.app.provider.signalingConns[0].connected?(this.setState({show_vtt_message:!0,vtt_live:!this.state.vtt_live}),window.clearInterval(b)):
this.state.vtt_live&&!window.app.provider?(this.setState({show_vtt_message:!0,vtt_live:!this.state.vtt_live}),window.clearInterval(b)):0==a--&&window.clearInterval(b)},1E3)}onKeyDown(a){"Escape"===a.key&&"edit"==this.props.mode&&tinymce.activeEditor.hasFocus()&&history.go(-1);if(!window.app.inhibit_hotkeys&&"edit"!=this.props.mode){"Digit2"==a.code&&window.app.rollDice("1d20");"Digit3"==a.code&&window.app.rollDice("1d12");"Digit4"==a.code&&window.app.rollDice("1d10");"Digit5"==a.code&&window.app.rollDice("1d8");
"Digit6"==a.code&&window.app.rollDice("1d6");"Digit7"==a.code&&window.app.rollDice("1d4");"Digit8"==a.code&&window.app.rollDice("1d7");"Digit0"==a.code&&(window.app.rollDice("1d100"),window.app.rollDice("1d10"));"KeyH"==a.code&&this.setState({showHelp:!this.state.showHelp});"KeyC"==a.code&&window.app.clearAllDice();if("Backquote"==a.code&&window.app.vtt_referee)return $$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/search"),a.preventDefault(),a.stopPropagation(),!1;if(a.ctrlKey&&
"KeyS"==a.code)return a.preventDefault(),a.stopPropagation(),!1;if(a.ctrlKey&&"KeyE"==a.code&&!is_electron$$module$api_shim&&this.props.hex_uuid)return a.preventDefault(),a.stopPropagation(),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid+"/edit"),!1;if("KeyR"==a.code)this.onToggleDice()}}render(a,b){const c=a.hex_uuid&&"vtt"!=a.mode?"view_visible":"view_hidden",d="append"==a.mode?html$$module$hexview`
            <${GenerateRealmDialog$$module$dialogs}
              ref=${w=>this.dialog=w}
              toggleModal=${()=>this.toggleModal()}
              instance=${a.instance}
              onOkay=${this.appendCall}
            />
          `:html$$module$hexview``,e=b.showSolo?html$$module$hexview`
          <${SoloDialog$$module$readme}
            toggleModal=${()=>this.toggleModal()}
            instance=${this.props.instance}
            onExit=${()=>{this.setState({showSolo:!1})}}
          />
        `:html$$module$hexview``,g=b.showHelp?html$$module$hexview`
          <${HelpDialog$$module$readme}
            toggleModal=${()=>this.toggleModal()}
            onExit=${()=>{this.setState({showHelp:!1})}}
          />
        `:html$$module$hexview``,n=b.showReadme?html$$module$hexview`
          <${ReadmeDialog$$module$readme}
            toggleModal=${()=>this.toggleModal()}
            onExit=${this.onReadme}
          />
        `:html$$module$hexview``,t=b.showExpired&&"vtt"!=a.mode?html$$module$hexview`
            <${ExpiredDialog$$module$readme}
              toggleModal=${()=>this.toggleModal()}
              onExit=${()=>this.setState({showExpired:!1})}
            />
          `:html$$module$hexview``;return html$$module$hexview`
      ${d} ${n} ${t} ${e} ${g}
      <${b.show_vtt_message&&VttDialog$$module$readme}
        toggleModal=${()=>this.toggleModal()}
        instance=${a.instance}
        onExit=${()=>this.setState({show_vtt_message:!1})}
      />
      <${b.showTokenChooser&&TokenChooserDialog$$module$tokens}
        toggleModal=${()=>this.toggleModal()}
        callback=${this.tokens_callback}
        onExit=${()=>this.showTokenChooser()}
      />
      <div id="header" class="${c}">
        <h4>
          <div id="hex_title">Loading...<br /><br /></div>
          <${Toolbar$$module$hexview}
            ref=${w=>this.toolbar=w}
            onEdit=${()=>this.edit()}
            onReroll=${this.reroll}
            onLock=${this.onLock}
            mode=${a.mode}
            type=${a.type}
            hidden=${!a.hex_uuid}
          />
        </h4>
      </div>
      <div id="info-bar">
        <span class="info-bar-text">
          <a onClick=${this.onReadme}>
            <strong> HEXROLL 2nd Edition </strong>
          </a>
          | frontend build: ${BUILD_ID$$module$version} | backend build:
          ${b.BACKEND_BUILD_ID}</span
        >
        ${b.ephemeral&&html$$module$hexview`
          <a
            class="ephemeral-link"
            href="https://docs.hexroll.app/building-a-sandbox/ephemeral/"
            target="\u201d_blank\u201d"
          >
            <i class="fa-solid fa-warning"></i> Ephemeral Sandbox
          </a>
        `}
      </div>
      <${DiceRollSnackbar$$module$dicebox} />
      <${Dice$$module$dicebox}
        visible=${!(b.show_dice_bar&&!is_electron$$module$api_shim&&!b.modalOn&&b.map_locked&&!b.hotkey_mode&&!a.hex_uuid)&&"vtt"!=a.mode}
      />
      <${"vtt"==a.mode?VttHexMap$$module$hexmap:HexMap$$module$hexmap}
        visible="true"
        ref=${w=>this.map=w}
        instance="${a.instance}"
        wuuid=""
        locked=${b.map_locked}
        hex_uuid="${a.hex_uuid}"
        area_uuid="${a.area_uuid}"
        coords=${b.coords}
        show_labels=${b.show_labels}
        desaturate_palette=${b.desaturate_palette}
        appendDialog=${this.appendDialog}
        spinner=${this.toggleSpinner}
        editMode=${"edit"==a.mode}
        type=${a.type}
        hotkeyMode=${(w,z)=>{this.onHotkeyMode(w,z)}}
        toggleLabels=${()=>{this.onToggleLabels()}}
        vtt=${"vtt"==a.mode}
        state_loaded=${b.loaded}
      />
      <div id="content" class="${c}">
        <${Slider$$module$utils}
          id="search"
          switch=${!a.hex_uuid&&b.map_locked&&!b.modalOn&&"vtt"!=a.mode&&!b.hotkey_mode&&!b.waiting}
          visible=${()=>html$$module$hexview` <${SearchBar$$module$search} instance="${a.instance}" /> `}
        />
        <div id="map-toolbox">
          <${Slider$$module$utils}
            id="help-button"
            switch=${!a.hex_uuid&&!b.packaging&&!is_electron$$module$api_shim&&!b.modalOn&&"vtt"!=a.mode&&!b.hotkey_mode&&!b.waiting}
            visible=${()=>html$$module$hexview` <a
                title="Quick Help [H]"
                onClick="${()=>this.onQuickHelp()}"
                ><i class="fa fa-solid fa-circle-question"></i>
              </a>`}
          />
          <${Slider$$module$utils}
            id="download-button"
            switch=${!a.hex_uuid&&!b.packaging&&!is_electron$$module$api_shim&&!b.modalOn&&"vtt"!=a.mode&&!b.hotkey_mode&&!b.waiting}
            visible=${()=>html$$module$hexview` <a
                class="${window.app.solo_mode&&"disabled"}"
                title="Package & Download"
                onClick="${()=>this.onDownload()}"
                ><i class="fa fa-solid fa-circle-down"></i>
              </a>`}
          />
          <${Slider$$module$utils}
            id="toggles-menu"
            switch=${!a.hex_uuid&&!b.modalOn&&"vtt"!=a.mode&&!b.hotkey_mode&&!b.waiting}
            visible=${()=>html$$module$hexview`
                <${Toggles$$module$hexview}
                  onToggleLabels=${this.onToggleLabels}
                  onToggleDice=${this.onToggleDice}
                  onTogglePalette=${this.onTogglePalette}
                  onToggleTheme=${this.onToggleTheme}
                  onToggleSpoilers=${this.onToggleSpoilers}
                  spoilers_on=${b.spoilers_on}
                  ephemeral=${b.ephemeral}
                  vttLive=${b.vtt_live}
                  onVtt=${()=>{this.onVtt()}}
                />
              `}
          />
          <${Slider$$module$utils}
            id="drawer-menu"
            switch=${!a.hex_uuid&&!is_electron$$module$api_shim&&!b.modalOn&&"vtt"!=a.mode&&!b.hotkey_mode&&!b.waiting}
            visible=${()=>html$$module$hexview`
                <${Drawer$$module$hexview}
                  onAppend=${this.appendDialog}
                  onLock=${this.onLock}
                />
              `}
          />
          <${Slider$$module$utils}
            id="exit-button"
            switch=${!a.hex_uuid&&is_electron$$module$api_shim&&!b.modalOn&&!b.waiting}
            visible=${()=>html$$module$hexview`
                <a onClick="${()=>this.onExit()}"
                  ><i class="fa fa-solid fa-circle-xmark"></i>
                </a>
              `}
          />
        </div>
        <${Slider$$module$utils}
          id="backpacker-snackbar"
          switch=${b.snackbar}
          visible=${()=>b.packaging?html$$module$hexview`
                  <div>
                    <i class="fa fa-solid fa-gear animated-gear"></i>
                    Hexroll is now casting a <em>Package Sandbox</em> spell.
                    <br />
                    You will find the download link here in a few moments.
                  </div>
                `:b.backpack_link?html$$module$hexview`
                    <div>
                      <div class="snackbar-close">
                        <a onClick="${this.closeSnackbar}">
                          <i class="fa fa-solid fa-xmark"></i
                        ></a>
                      </div>
                      Your Hexroll Backpack file is ready to
                      <a href="${b.backpack_link}">download now</a>
                    </div>
                  `:html$$module$hexview`
                    <div>
                      We had a problem packing your sandbox. <br />This will be
                      looked into and you will be contacted soon.
                    </div>
                  `}
        />
        ${b.waiting?html$$module$hexview`
              <${Spinner$$module$spinner}
                width="100px"
                style="position:fixed; z-index:101000; left:2em; bottom: 2em;"
              />
            `:html$$module$hexview``}
        <div
          id="entity-container"
          class="${c} ${"edit"==a.mode&&"but_full_width"}"
          spoiler=${b.spoilers_on?"yes":"no"}
        >
          ${b.activateEditor?html$$module$hexview`<${EntityEditor$$module$hexview}
                instance=${a.instance}
                hex_uuid=${a.hex_uuid}
                onSave=${w=>this.onEditorClose(w)}
                onEditorActive=${this.onEditorActive}
                onReloadMap=${()=>{this.map.getMatrix(!0)}}
                toggle=${this.toggle}
              />`:html$$module$hexview``}
          <div
            id="entity-editor-placeholder"
            class="${b.activateEditor&&"occupied"}"
          ></div>
          <div style="z-index:-1;position:absolute;" id="entity1"></div>
          <div
            style="z-index:-1;position:absolute;"
            id="entity2"
            class="hidden"
          ></div>
        </div>
      </div>
    `}}var module$hexview={};module$hexview.HexView=HexView$$module$hexview;var t$$module$libs$history_production_min;!function(a){a.Pop="POP";a.Push="PUSH";a.Replace="REPLACE"}(t$$module$libs$history_production_min||={});
function e$$module$libs$history_production_min(a={}){function b(){let {pathname:S,search:T,hash:P}=t.location,W=w.state||{};return[W.idx,{pathname:S,search:T,hash:P,state:W.usr||null,key:W.key||"default"}]}function c(S){return"string"==typeof S?S:c$$module$libs$history_production_min(S)}function d(S,T=null){return Object.assign(Object.assign({pathname:M.pathname,hash:"",search:""},"string"==typeof S?u$$module$libs$history_production_min(S):S),{state:T,key:o$$module$libs$history_production_min()})}
function e(S,T,P){return!O.length||(O.call({action:S,location:T,retry:P}),!1)}function g(S){C=S;[H,M]=b();L.call({action:C,location:M})}function n(S){w.go(S)}let {window:t=document.defaultView}=a,w=t.history,z=null;t.addEventListener("popstate",function(){if(z)O.call(z),z=null;else{let S=t$$module$libs$history_production_min.Pop,[T,P]=b();if(O.length){if(null!=T){let W=H-T;W&&(z={action:S,location:P,retry(){n(-1*W)}},n(W))}}else g(S)}});let C=t$$module$libs$history_production_min.Pop,[H,M]=b(),L=
i$$module$libs$history_production_min(),O=i$$module$libs$history_production_min();return null==H&&(H=0,w.replaceState(Object.assign(Object.assign({},w.state),{idx:H}),"")),{get action(){return C},get location(){return M},createHref:c,push:function W(T,P){let Z=t$$module$libs$history_production_min.Push,ca=d(T,P);if(e(Z,ca,function(){W(T,P)})){let [ba,la]=[{usr:ca.state,key:ca.key,idx:H+1},c(ca)];try{w.pushState(ba,"",la)}catch(ea){t.location.assign(la)}g(Z)}},replace:function Z(P,W){let ca=t$$module$libs$history_production_min.Replace,
ba=d(P,W);if(e(ca,ba,function(){Z(P,W)})){let [la,ea]=[{usr:ba.state,key:ba.key,idx:H},c(ba)];w.replaceState(la,"",ea);g(ca)}},go:n,back(){n(-1)},forward(){n(1)},listen:P=>L.push(P),block(P){let W=O.push(P);return 1===O.length&&t.addEventListener("beforeunload",l$$module$libs$history_production_min),function(){W();O.length||t.removeEventListener("beforeunload",l$$module$libs$history_production_min)}}}}
function n$$module$libs$history_production_min(a={}){function b(){let {pathname:T="/",search:P="",hash:W=""}=u$$module$libs$history_production_min(w.location.hash.substr(1)),Z=z.state||{};return[Z.idx,{pathname:T,search:P,hash:W,state:Z.usr||null,key:Z.key||"default"}]}function c(){if(C)S.call(C),C=null;else{let T=t$$module$libs$history_production_min.Pop,[P,W]=b();if(S.length){if(null!=P){let Z=M-P;Z&&(C={action:T,location:W,retry(){t(-1*Z)}},t(Z))}}else n(T)}}function d(T){var P=document.querySelector("base"),
W="";P&&P.getAttribute("href")&&(P=w.location.href,W=P.indexOf("#"),W=-1===W?P:P.slice(0,W));return W+"#"+("string"==typeof T?T:c$$module$libs$history_production_min(T))}function e(T,P=null){return Object.assign(Object.assign({pathname:L.pathname,hash:"",search:""},"string"==typeof T?u$$module$libs$history_production_min(T):T),{state:P,key:o$$module$libs$history_production_min()})}function g(T,P,W){return!S.length||(S.call({action:T,location:P,retry:W}),!1)}function n(T){H=T;[M,L]=b();O.call({action:H,
location:L})}function t(T){z.go(T)}let {window:w=document.defaultView}=a,z=w.history,C=null;w.addEventListener("popstate",c);w.addEventListener("hashchange",()=>{let [,T]=b();c$$module$libs$history_production_min(T)!==c$$module$libs$history_production_min(L)&&c()});let H=t$$module$libs$history_production_min.Pop,[M,L]=b(),O=i$$module$libs$history_production_min(),S=i$$module$libs$history_production_min();return null==M&&(M=0,z.replaceState(Object.assign(Object.assign({},z.state),{idx:M}),"")),{get action(){return H},
get location(){return L},createHref:d,push:function Z(P,W){let ca=t$$module$libs$history_production_min.Push,ba=e(P,W);if(g(ca,ba,function(){Z(P,W)})){let [la,ea]=[{usr:ba.state,key:ba.key,idx:M+1},d(ba)];try{z.pushState(la,"",ea)}catch(oa){w.location.assign(ea)}n(ca)}},replace:function ca(W,Z){let ba=t$$module$libs$history_production_min.Replace,la=e(W,Z);if(g(ba,la,function(){ca(W,Z)})){let [ea,oa]=[{usr:la.state,key:la.key,idx:M},d(la)];z.replaceState(ea,"",oa);n(ba)}},go:t,back(){t(-1)},forward(){t(1)},
listen:W=>O.push(W),block(W){let Z=S.push(W);return 1===S.length&&w.addEventListener("beforeunload",l$$module$libs$history_production_min),function(){Z();S.length||w.removeEventListener("beforeunload",l$$module$libs$history_production_min)}}}}
function a$$module$libs$history_production_min(a={}){function b(L,O=null){return Object.assign(Object.assign({pathname:C.pathname,search:"",hash:""},"string"==typeof L?u$$module$libs$history_production_min(L):L),{state:O,key:o$$module$libs$history_production_min()})}function c(L,O,S){return!M.length||(M.call({action:L,location:O,retry:S}),!1)}function d(L,O){z=L;C=O;H.call({action:z,location:C})}function e(L){let O=r$$module$libs$history_production_min(w+L,0,t.length-1),S=t$$module$libs$history_production_min.Pop,
T=t[O];c(S,T,function(){e(L)})&&(w=O,d(S,T))}let {initialEntries:g=["/"],initialIndex:n}=a,t=g.map(L=>Object.assign({pathname:"/",search:"",hash:"",state:null,key:o$$module$libs$history_production_min()},"string"==typeof L?u$$module$libs$history_production_min(L):L)),w=r$$module$libs$history_production_min(null==n?t.length-1:n,0,t.length-1),z=t$$module$libs$history_production_min.Pop,C=t[w],H=i$$module$libs$history_production_min(),M=i$$module$libs$history_production_min();return{get index(){return w},
get action(){return z},get location(){return C},createHref:function(L){return"string"==typeof L?L:c$$module$libs$history_production_min(L)},push:function T(O,S){let P=t$$module$libs$history_production_min.Push,W=b(O,S);c(P,W,function(){T(O,S)})&&(w+=1,t.splice(w,t.length,W),d(P,W))},replace:function P(S,T){let W=t$$module$libs$history_production_min.Replace,Z=b(S,T);c(W,Z,function(){P(S,T)})&&(t[w]=Z,d(W,Z))},go:e,back(){e(-1)},forward(){e(1)},listen:S=>H.push(S),block:S=>M.push(S)}}
function r$$module$libs$history_production_min(a,b,c){return Math.min(Math.max(a,b),c)}function l$$module$libs$history_production_min(a){a.preventDefault();a.returnValue=""}function i$$module$libs$history_production_min(){let a=[];return{get length(){return a.length},push:b=>(a.push(b),function(){a=a.filter(c=>c!==b)}),call(b){a.forEach(c=>c&&c(b))}}}function o$$module$libs$history_production_min(){return Math.random().toString(36).substr(2,8)}
function c$$module$libs$history_production_min({pathname:a="/",search:b="",hash:c=""}){return b&&"?"!==b&&(a+="?"===b.charAt(0)?b:"?"+b),c&&"#"!==c&&(a+="#"===c.charAt(0)?c:"#"+c),a}function u$$module$libs$history_production_min(a){let b={};if(a){var c=a.indexOf("#");0<=c&&(b.hash=a.substr(c),a=a.substr(0,c));c=a.indexOf("?");0<=c&&(b.search=a.substr(c),a=a.substr(0,c));a&&(b.pathname=a)}return b}var module$libs$history_production_min={};module$libs$history_production_min.Action=t$$module$libs$history_production_min;
module$libs$history_production_min.createBrowserHistory=e$$module$libs$history_production_min;module$libs$history_production_min.createHashHistory=n$$module$libs$history_production_min;module$libs$history_production_min.createMemoryHistory=a$$module$libs$history_production_min;module$libs$history_production_min.createPath=c$$module$libs$history_production_min;module$libs$history_production_min.parsePath=u$$module$libs$history_production_min;const html$$module$code=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class YMock$$module$code{constructor(){this.map=new Map}observe(a){}unobserve(a){}get(a){return this.map.get(a)}set(a,b){this.map.set(a,b)}}
class App$$module$code extends k$$module$libs$preact{constructor(){super();this.state={mode:"hexmap",hexlist:[],borders:[],unauth:!1};this.theme_index=0;this.theme=THEMES$$module$themes.default;this.tokens_svg="/tokens.svg?"+BUILD_ID$$module$version;window.main=this;window.app=this;this.last_uuid=this.map2=null;this.inhibit_rerolls=this.inhibit_click=!1;this.settlements_cache={};this.locked=!0;this.tokens=new Map;this.yarray=new YMock$$module$code;this.zarray=new YMock$$module$code;this.reroll_handlers=
new Map;this.ydoc=new Doc$$module$libs$y_webrtc_min;this.yarray=this.ydoc.get("map",YMap$$module$libs$y_webrtc_min);this.zarray=this.ydoc.get("tokeninstances",YMap$$module$libs$y_webrtc_min);this.rarray=this.ydoc.get("rolls",YArray$$module$libs$y_webrtc_min)}doc_test(){const a=encodeStateAsUpdate$$module$libs$y_webrtc_min(this.ydoc);return Array.from(a)}apply_doc_update(a){applyUpdate$$module$libs$y_webrtc_min(this.ydoc,a)}vtt_on(a){this.provider?(this.ydoc.destroy(),this.provider.disconnect(),this.provider=
null):this.provider=new WebrtcProvider$$module$libs$y_webrtc_min(a,this.ydoc,{signaling:["wss://vtt.hexroll.app:4444"]})}hideMap(){this.minimap||(this.minimap=!0,document.getElementById("content").style.display="block",document.getElementById("entity-container").style.display="block",this.map.setState({col1:"rect1"}))}showMap(){this.setState({mode:"hexmap"});this.minimap&&(this.minimap=!1,document.getElementById("content").style.display="none",document.getElementById("entity").innerHTML="",this.map.setState({col1:"col1"}))}reroll(a){this.map.reroll(a,
"default")}reroll_ex(a,b,c){this.map.reroll(a,b,c)}append(a,b,c,d){a.style["pointer-events"]="none";this.map.append(b,c,d)}unauth(){this.setState({unauth:!0})}onAuthAck(){this.setState({unauth:!1})}rollDice(a){is_electron$$module$api_shim||(window.clearTimeout(this.clearDiceTimeout),document.getElementById("canvas").pauseAnimations(),this.diceBox.add(a))}clearAllDice(){is_electron$$module$api_shim||this.diceBox.clear()}componentDidMount(){is_electron$$module$api_shim||(this.diceBox=new il$$module$libs$dice_box_es("#dice-box",
{assetPath:"/assets/",theme:"smooth",gravity:6,mass:1,friction:.6,spinForce:6,throwForce:6,startingHeight:10,themeColor:"#aa3333"}),this.diceBox.init().then(()=>{this.diceBox.onRollComplete=a=>{document.getElementById("canvas").unpauseAnimations();this.rarray.push([{from:this.vtt_referee?"referee":"player",result:a}]);window.clearTimeout(this.clearDiceTimeout);this.clearDiceTimeout=window.setTimeout(()=>{this.diceBox.clear()},3E3)}}))}render(){const a=this.state.unauth?html$$module$code`
          <div id="myModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
              <div class="close">
                <a onClick="${()=>this.onAuthAck()}"> ${"\u00d7"} </a>
              </div>
              <h5>Hello Adventurer!</h5>
              <p>
                You are currently using an ephemeral sandbox. Ephemeral
                sandboxes have a 1,000,000 gp credit limit and are not
                guaranteed to stay online.
              </p>
              <p>
                If you are a Patreon subscriber, make sure you are logged in to
                claim this sandbox and enjoy an unlimited credit as well as
                online storage and cloud backup.
              </p>
            </div>
          </div>
        `:html$$module$code``;return html$$module$code`
      ${a}
      <${D$$module$libs$preact_router_module} history=${is_electron$$module$api_shim?n$$module$libs$history_production_min():void 0}>
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         mode="view"
         path="/"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         mode="view"
         path="/sandbox/:instance?"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/sandbox/:instance/toc"
         mode="view"
         hex_uuid="root"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/vtt/:instance"
         mode="vtt"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         mode="append"
         path="/sandbox/:instance/append"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/sandbox/:instance/search"
         mode="search"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/sandbox/:instance/:type/:hex_uuid/edit"
         mode="edit"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/vtt/:instance/:type/:hex_uuid/"
         mode="vtt"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/sandbox/:instance/:type/:hex_uuid/"
         mode="view"
       />
        <${HexView$$module$hexview}
         ref=${b=>this.map=b}
         path="/sandbox/:instance/:type/:hex_uuid/npc/:npc"
         mode="view"
       />
      </${D$$module$libs$preact_router_module}>
    `}}let app$$module$code;B$$module$libs$preact(html$$module$code`<div id="dice-box"></div>
    <${App$$module$code} ref=${a=>app$$module$code=a} />`,document.getElementById("app"));var module$code={};
