class Queue$$module$libs$polylabel{constructor(a=[],g=defaultCompare$$module$libs$polylabel){this.data=a;this.length=this.data.length;this.compare=g;if(0<this.length)for(a=(this.length>>1)-1;0<=a;a--)this._down(a)}push(a){this.data.push(a);this._up(this.length++)}pop(){if(0!==this.length){var a=this.data[0],g=this.data.pop();0<--this.length&&(this.data[0]=g,this._down(0));return a}}peek(){return this.data[0]}_up(a){const {data:g,compare:p}=this,t=g[a];for(;0<a;){const A=a-1>>1,D=g[A];if(0<=p(t,D))break;
g[a]=D;a=A}g[a]=t}_down(a){const {data:g,compare:p}=this,t=this.length>>1,A=g[a];for(;a<t;){let D=(a<<1)+1;const F=D+1;F<this.length&&0>p(g[F],g[D])&&(D=F);if(0<=p(g[D],A))break;g[a]=g[D];a=D}g[a]=A}}function defaultCompare$$module$libs$polylabel(a,g){return a<g?-1:a>g?1:0}
function polylabel$$module$libs$polylabel(a,g,p){g=g||1;for(var t,A,D,F,K=0;K<a[0].length;K++){var H=a[0][K];if(!K||H[0]<t)t=H[0];if(!K||H[1]<A)A=H[1];if(!K||H[0]>D)D=H[0];if(!K||H[1]>F)F=H[1]}var J=D-t,I=F-A,N=Math.min(J,I);H=N/2;if(0===N)return a=[t,A],a.distance=0,a;K=new Queue$$module$libs$polylabel(void 0,compareMax$$module$libs$polylabel);for(var T=t;T<D;T+=N)for(var O=A;O<F;O+=N)K.push(new Cell$$module$libs$polylabel(T+H,O+H,H,a));D=getCentroidCell$$module$libs$polylabel(a);t=new Cell$$module$libs$polylabel(t+
J/2,A+I/2,0,a);t.d>D.d&&(D=t);for(t=K.length;K.length;)A=K.pop(),A.d>D.d&&(D=A,p&&console.log("found best %f after %d probes",Math.round(1E4*A.d)/1E4,t)),A.max-D.d<=g||(H=A.h/2,K.push(new Cell$$module$libs$polylabel(A.x-H,A.y-H,H,a)),K.push(new Cell$$module$libs$polylabel(A.x+H,A.y-H,H,a)),K.push(new Cell$$module$libs$polylabel(A.x-H,A.y+H,H,a)),K.push(new Cell$$module$libs$polylabel(A.x+H,A.y+H,H,a)),t+=4);p&&(console.log("num probes: "+t),console.log("best distance: "+D.d));a=[D.x,D.y];a.distance=
D.d;return a}function compareMax$$module$libs$polylabel(a,g){return g.max-a.max}function Cell$$module$libs$polylabel(a,g,p,t){this.x=a;this.y=g;this.h=p;this.d=pointToPolygonDist$$module$libs$polylabel(a,g,t);this.max=this.d+this.h*Math.SQRT2}
function pointToPolygonDist$$module$libs$polylabel(a,g,p){for(var t=!1,A=Infinity,D=0;D<p.length;D++)for(var F=p[D],K=0,H=F.length,J=H-1;K<H;J=K++){var I=F[K];J=F[J];I[1]>g!==J[1]>g&&a<(J[0]-I[0])*(g-I[1])/(J[1]-I[1])+I[0]&&(t=!t);A=Math.min(A,getSegDistSq$$module$libs$polylabel(a,g,I,J))}return 0===A?0:(t?1:-1)*Math.sqrt(A)}
function getCentroidCell$$module$libs$polylabel(a){for(var g=0,p=0,t=0,A=a[0],D=0,F=A.length,K=F-1;D<F;K=D++){var H=A[D];K=A[K];var J=H[0]*K[1]-K[0]*H[1];p+=(H[0]+K[0])*J;t+=(H[1]+K[1])*J;g+=3*J}return 0===g?new Cell$$module$libs$polylabel(A[0][0],A[0][1],0,a):new Cell$$module$libs$polylabel(p/g,t/g,0,a)}
function getSegDistSq$$module$libs$polylabel(a,g,p,t){var A=p[0];p=p[1];var D=t[0]-A,F=t[1]-p;if(0!==D||0!==F){var K=((a-A)*D+(g-p)*F)/(D*D+F*F);1<K?(A=t[0],p=t[1]):0<K&&(A+=D*K,p+=F*K)}D=a-A;F=g-p;return D*D+F*F}var module$libs$polylabel={};module$libs$polylabel.polylabel=polylabel$$module$libs$polylabel;var n$$module$libs$htm=function(a,g,p,t){var A;g[0]=0;for(var D=1;D<g.length;D++){var F=g[D++],K=g[D]?(g[0]|=F?1:2,p[g[D++]]):g[++D];3===F?t[0]=K:4===F?t[1]=Object.assign(t[1]||{},K):5===F?(t[1]=t[1]||{})[g[++D]]=K:6===F?t[1][g[++D]]+=K+"":F?(A=a.apply(K,n$$module$libs$htm(a,K,p,["",null])),t.push(A),K[0]?g[0]|=2:(g[D-2]=0,g[D]=A)):t.push(K)}return t},t$$module$libs$htm=new Map,$jscompDefaultExport$$module$libs$htm=function(a){var g=t$$module$libs$htm.get(this);return g||(g=new Map,t$$module$libs$htm.set(this,
g)),1<(g=n$$module$libs$htm(this,g.get(a)||(g.set(a,g=function(p){for(var t,A,D=1,F="",K="",H=[0],J=function(T){1===D&&(T||(F=F.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?H.push(0,T,F):3===D&&(T||F)?(H.push(3,T,F),D=2):2===D&&"..."===F&&T?H.push(4,T,0):2===D&&F&&!T?H.push(5,0,!0,F):5<=D&&((F||!T&&5===D)&&(H.push(D,0,F,A),D=6),T&&(H.push(D,T,0,A),D=6));F=""},I=0;I<p.length;I++){I&&(1===D&&J(),J(I));for(var N=0;N<p[I].length;N++)t=p[I][N],1===D?"<"===t?(J(),H=[H],D=3):F+=t:4===D?"--"===F&&">"===t?(D=1,F=
""):F=t+F[0]:K?t===K?K="":F+=t:'"'===t||"'"===t?K=t:">"===t?(J(),D=1):D&&("="===t?(D=5,A=F,F=""):"/"===t&&(5>D||">"===p[I][N+1])?(J(),3===D&&(H=H[0]),D=H,(H=H[0]).push(2,0,D),D=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(J(),D=2):F+=t),3===D&&"!--"===F&&(D=4,H=H[0])}return J(),H}(a)),g),arguments,[])).length?g:g[0]},module$libs$htm={};module$libs$htm.default=$jscompDefaultExport$$module$libs$htm;var n$$module$libs$preact,l$$module$libs$preact,u$$module$libs$preact,i$$module$libs$preact,t$$module$libs$preact,r$$module$libs$preact,o$$module$libs$preact,f$$module$libs$preact,e$$module$libs$preact,c$$module$libs$preact={},s$$module$libs$preact=[],a$$module$libs$preact=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h$$module$libs$preact(a,g){for(var p in g)a[p]=g[p];return a}function v$$module$libs$preact(a){var g=a.parentNode;g&&g.removeChild(a)}
function y$$module$libs$preact(a,g,p){var t,A,D,F={};for(D in g)"key"==D?t=g[D]:"ref"==D?A=g[D]:F[D]=g[D];if(2<arguments.length&&(F.children=3<arguments.length?n$$module$libs$preact.call(arguments,2):p),"function"==typeof a&&null!=a.defaultProps)for(D in a.defaultProps)void 0===F[D]&&(F[D]=a.defaultProps[D]);return p$$module$libs$preact(a,F,t,A,null)}
function p$$module$libs$preact(a,g,p,t,A){a={type:a,props:g,key:p,ref:t,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==A?++u$$module$libs$preact:A};return null==A&&null!=l$$module$libs$preact.vnode&&l$$module$libs$preact.vnode(a),a}function d$$module$libs$preact(){return{current:null}}function _$$module$libs$preact(a){return a.children}function k$$module$libs$preact(a,g){this.props=a;this.context=g}
function b$$module$libs$preact(a,g){if(null==g)return a.__?b$$module$libs$preact(a.__,a.__.__k.indexOf(a)+1):null;for(var p;g<a.__k.length;g++)if(null!=(p=a.__k[g])&&null!=p.__e)return p.__e;return"function"==typeof a.type?b$$module$libs$preact(a):null}function g$$module$libs$preact(a){var g,p;if(null!=(a=a.__)&&null!=a.__c){a.__e=a.__c.base=null;for(g=0;g<a.__k.length;g++)if(null!=(p=a.__k[g])&&null!=p.__e){a.__e=a.__c.base=p.__e;break}return g$$module$libs$preact(a)}}
function m$$module$libs$preact(a){(!a.__d&&(a.__d=!0)&&t$$module$libs$preact.push(a)&&!w$$module$libs$preact.__r++||r$$module$libs$preact!==l$$module$libs$preact.debounceRendering)&&((r$$module$libs$preact=l$$module$libs$preact.debounceRendering)||o$$module$libs$preact)(w$$module$libs$preact)}
function w$$module$libs$preact(){var a,g,p,t,A,D,F,K;for(t$$module$libs$preact.sort(f$$module$libs$preact);a=t$$module$libs$preact.shift();)a.__d&&(g=t$$module$libs$preact.length,t=void 0,A=void 0,F=(D=(p=a).__v).__e,(K=p.__P)&&(t=[],(A=h$$module$libs$preact({},D)).__v=D.__v+1,L$$module$libs$preact(K,D,A,p.__n,void 0!==K.ownerSVGElement,null!=D.__h?[F]:null,t,null==F?b$$module$libs$preact(D):F,D.__h),M$$module$libs$preact(t,D),D.__e!=F&&g$$module$libs$preact(D)),t$$module$libs$preact.length>g&&t$$module$libs$preact.sort(f$$module$libs$preact));
w$$module$libs$preact.__r=0}
function x$$module$libs$preact(a,g,p,t,A,D,F,K,H,J){var I,N,T,O,W,ba,fa=t&&t.__k||s$$module$libs$preact,R=fa.length;p.__k=[];for(I=0;I<g.length;I++)if(null!=(O=p.__k[I]=null==(O=g[I])||"boolean"==typeof O||"function"==typeof O?null:"string"==typeof O||"number"==typeof O||"bigint"==typeof O?p$$module$libs$preact(null,O,null,null,O):Array.isArray(O)?p$$module$libs$preact(_$$module$libs$preact,{children:O},null,null,null):0<O.__b?p$$module$libs$preact(O.type,O.props,O.key,O.ref?O.ref:null,O.__v):O)){if(O.__=
p,O.__b=p.__b+1,null===(T=fa[I])||T&&O.key==T.key&&O.type===T.type)fa[I]=void 0;else for(N=0;N<R;N++){if((T=fa[N])&&O.key==T.key&&O.type===T.type){fa[N]=void 0;break}T=null}L$$module$libs$preact(a,O,T=T||c$$module$libs$preact,A,D,F,K,H,J);var da=O.__e;(N=O.ref)&&T.ref!=N&&(ba||=[],T.ref&&ba.push(T.ref,null,O),ba.push(N,O.__c||da,O));null!=da?(null==W&&(W=da),"function"==typeof O.type&&O.__k===T.__k?O.__d=H=A$$module$libs$preact(O,H,a):H=C$$module$libs$preact(a,O,T,fa,da,H),"function"==typeof p.type&&
(p.__d=H)):H&&T.__e==H&&H.parentNode!=a&&(H=b$$module$libs$preact(T))}p.__e=W;for(I=R;I--;)null!=fa[I]&&("function"==typeof p.type&&null!=fa[I].__e&&fa[I].__e==p.__d&&(p.__d=$$$module$libs$preact(t).nextSibling),S$$module$libs$preact(fa[I],fa[I]));if(ba)for(I=0;I<ba.length;I++)O$$module$libs$preact(ba[I],ba[++I],ba[++I])}
function A$$module$libs$preact(a,g,p){for(var t,A=a.__k,D=0;A&&D<A.length;D++)(t=A[D])&&(t.__=a,g="function"==typeof t.type?A$$module$libs$preact(t,g,p):C$$module$libs$preact(p,t,t,A,t.__e,g));return g}function P$$module$libs$preact(a,g){return g=g||[],null==a||"boolean"==typeof a||(Array.isArray(a)?a.some(function(p){P$$module$libs$preact(p,g)}):g.push(a)),g}
function C$$module$libs$preact(a,g,p,t,A,D){if(void 0!==g.__d){var F=g.__d;g.__d=void 0}else if(null==p||A!=D||null==A.parentNode)a:if(null==D||D.parentNode!==a)a.appendChild(A),F=null;else{g=D;for(p=0;(g=g.nextSibling)&&p<t.length;p+=1)if(g==A)break a;a.insertBefore(A,D);F=D}return void 0!==F?F:A.nextSibling}
function $$$module$libs$preact(a){var g,p,t;if(null==a.type||"string"==typeof a.type)return a.__e;if(a.__k)for(g=a.__k.length-1;0<=g;g--)if((p=a.__k[g])&&(t=$$$module$libs$preact(p)))return t;return null}function H$$module$libs$preact(a,g,p,t,A){for(var D in p)"children"===D||"key"===D||D in g||T$$module$libs$preact(a,D,null,p[D],t);for(D in g)A&&"function"!=typeof g[D]||"children"===D||"key"===D||"value"===D||"checked"===D||p[D]===g[D]||T$$module$libs$preact(a,D,g[D],p[D],t)}
function I$$module$libs$preact(a,g,p){"-"===g[0]?a.setProperty(g,null==p?"":p):a[g]=null==p?"":"number"!=typeof p||a$$module$libs$preact.test(g)?p:p+"px"}
function T$$module$libs$preact(a,g,p,t,A){a:if("style"===g)if("string"==typeof p)a.style.cssText=p;else{if("string"==typeof t&&(a.style.cssText=t=""),t)for(g in t)p&&g in p||I$$module$libs$preact(a.style,g,"");if(p)for(g in p)t&&p[g]===t[g]||I$$module$libs$preact(a.style,g,p[g])}else if("o"===g[0]&&"n"===g[1])A=g!==(g=g.replace(/Capture$/,"")),g=g.toLowerCase()in a?g.toLowerCase().slice(2):g.slice(2),a.l||(a.l={}),(a.l[g+A]=p)?t||a.addEventListener(g,A?z$$module$libs$preact:j$$module$libs$preact,
A):a.removeEventListener(g,A?z$$module$libs$preact:j$$module$libs$preact,A);else if("dangerouslySetInnerHTML"!==g){if(A)g=g.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==g&&"height"!==g&&"href"!==g&&"list"!==g&&"form"!==g&&"tabIndex"!==g&&"download"!==g&&g in a)try{a[g]=null==p?"":p;break a}catch(D){}"function"==typeof p||(null==p||!1===p&&-1==g.indexOf("-")?a.removeAttribute(g):a.setAttribute(g,p))}}
function j$$module$libs$preact(a){return this.l[a.type+!1](l$$module$libs$preact.event?l$$module$libs$preact.event(a):a)}function z$$module$libs$preact(a){return this.l[a.type+!0](l$$module$libs$preact.event?l$$module$libs$preact.event(a):a)}
function L$$module$libs$preact(a,g,p,t,A,D,F,K,H){var J,I,N,T,O,W,ba,fa,R,da,ha,ma,ka,pa,la=g.type;if(void 0!==g.constructor)return null;null!=p.__h&&(H=p.__h,K=g.__e=p.__e,g.__h=null,D=[K]);(J=l$$module$libs$preact.__b)&&J(g);try{a:if("function"==typeof la){if(fa=g.props,R=(J=la.contextType)&&t[J.__c],da=J?R?R.props.value:J.__:t,p.__c?ba=(I=g.__c=p.__c).__=I.__E:("prototype"in la&&la.prototype.render?g.__c=I=new la(fa,da):(g.__c=I=new k$$module$libs$preact(fa,da),I.constructor=la,I.render=q$$module$libs$preact),
R&&R.sub(I),I.props=fa,I.state||(I.state={}),I.context=da,I.__n=t,N=I.__d=!0,I.__h=[],I._sb=[]),null==I.__s&&(I.__s=I.state),null!=la.getDerivedStateFromProps&&(I.__s==I.state&&(I.__s=h$$module$libs$preact({},I.__s)),h$$module$libs$preact(I.__s,la.getDerivedStateFromProps(fa,I.__s))),T=I.props,O=I.state,I.__v=g,N)null==la.getDerivedStateFromProps&&null!=I.componentWillMount&&I.componentWillMount(),null!=I.componentDidMount&&I.__h.push(I.componentDidMount);else{if(null==la.getDerivedStateFromProps&&
fa!==T&&null!=I.componentWillReceiveProps&&I.componentWillReceiveProps(fa,da),!I.__e&&null!=I.shouldComponentUpdate&&!1===I.shouldComponentUpdate(fa,I.__s,da)||g.__v===p.__v){g.__v!==p.__v&&(I.props=fa,I.state=I.__s,I.__d=!1);I.__e=!1;g.__e=p.__e;g.__k=p.__k;g.__k.forEach(function(wa){wa&&(wa.__=g)});for(ha=0;ha<I._sb.length;ha++)I.__h.push(I._sb[ha]);I._sb=[];I.__h.length&&F.push(I);break a}null!=I.componentWillUpdate&&I.componentWillUpdate(fa,I.__s,da);null!=I.componentDidUpdate&&I.__h.push(function(){I.componentDidUpdate(T,
O,W)})}if(I.context=da,I.props=fa,I.__P=a,ma=l$$module$libs$preact.__r,ka=0,"prototype"in la&&la.prototype.render){I.state=I.__s;I.__d=!1;ma&&ma(g);J=I.render(I.props,I.state,I.context);for(pa=0;pa<I._sb.length;pa++)I.__h.push(I._sb[pa]);I._sb=[]}else{do I.__d=!1,ma&&ma(g),J=I.render(I.props,I.state,I.context),I.state=I.__s;while(I.__d&&25>++ka)}I.state=I.__s;null!=I.getChildContext&&(t=h$$module$libs$preact(h$$module$libs$preact({},t),I.getChildContext()));N||null==I.getSnapshotBeforeUpdate||(W=
I.getSnapshotBeforeUpdate(T,O));var ta=null!=J&&J.type===_$$module$libs$preact&&null==J.key?J.props.children:J;x$$module$libs$preact(a,Array.isArray(ta)?ta:[ta],g,p,t,A,D,F,K,H);I.base=g.__e;g.__h=null;I.__h.length&&F.push(I);ba&&(I.__E=I.__=null);I.__e=!1}else null==D&&g.__v===p.__v?(g.__k=p.__k,g.__e=p.__e):g.__e=N$$module$libs$preact(p.__e,g,p,t,A,D,F,H);(J=l$$module$libs$preact.diffed)&&J(g)}catch(wa){g.__v=null,(H||null!=D)&&(g.__e=K,g.__h=!!H,D[D.indexOf(K)]=null),l$$module$libs$preact.__e(wa,
g,p)}}function M$$module$libs$preact(a,g){l$$module$libs$preact.__c&&l$$module$libs$preact.__c(g,a);a.some(function(p){try{a=p.__h,p.__h=[],a.some(function(t){t.call(p)})}catch(t){l$$module$libs$preact.__e(t,p.__v)}})}
function N$$module$libs$preact(a,g,p,t,A,D,F,K){var H,J,I=p.props,N=g.props,T=g.type,O=0;if("svg"===T&&(A=!0),null!=D)for(;O<D.length;O++)if((H=D[O])&&"setAttribute"in H==!!T&&(T?H.localName===T:3===H.nodeType)){a=H;D[O]=null;break}if(null==a){if(null===T)return document.createTextNode(N);a=A?document.createElementNS("http://www.w3.org/2000/svg",T):document.createElement(T,N.is&&N);D=null;K=!1}if(null===T)I===N||K&&a.data===N||(a.data=N);else{if(D=D&&n$$module$libs$preact.call(a.childNodes),H=(I=
p.props||c$$module$libs$preact).dangerouslySetInnerHTML,J=N.dangerouslySetInnerHTML,!K){if(null!=D)for(I={},O=0;O<a.attributes.length;O++)I[a.attributes[O].name]=a.attributes[O].value;(J||H)&&(J&&(H&&J.__html==H.__html||J.__html===a.innerHTML)||(a.innerHTML=J&&J.__html||""))}if(H$$module$libs$preact(a,N,I,A,K),J)g.__k=[];else if(O=g.props.children,x$$module$libs$preact(a,Array.isArray(O)?O:[O],g,p,t,A&&"foreignObject"!==T,D,F,D?D[0]:p.__k&&b$$module$libs$preact(p,0),K),null!=D)for(O=D.length;O--;)null!=
D[O]&&v$$module$libs$preact(D[O]);K||("value"in N&&void 0!==(O=N.value)&&(O!==a.value||"progress"===T&&!O||"option"===T&&O!==I.value)&&T$$module$libs$preact(a,"value",O,I.value,!1),"checked"in N&&void 0!==(O=N.checked)&&O!==a.checked&&T$$module$libs$preact(a,"checked",O,I.checked,!1))}return a}function O$$module$libs$preact(a,g,p){try{"function"==typeof a?a(g):a.current=g}catch(t){l$$module$libs$preact.__e(t,p)}}
function S$$module$libs$preact(a,g,p){var t,A;if(l$$module$libs$preact.unmount&&l$$module$libs$preact.unmount(a),(t=a.ref)&&(t.current&&t.current!==a.__e||O$$module$libs$preact(t,null,g)),null!=(t=a.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(D){l$$module$libs$preact.__e(D,g)}t.base=t.__P=null;a.__c=void 0}if(t=a.__k)for(A=0;A<t.length;A++)t[A]&&S$$module$libs$preact(t[A],g,p||"function"!=typeof a.type);p||null==a.__e||v$$module$libs$preact(a.__e);a.__=a.__e=a.__d=void 0}
function q$$module$libs$preact(a,g,p){return this.constructor(a,p)}
function B$$module$libs$preact(a,g,p){var t;l$$module$libs$preact.__&&l$$module$libs$preact.__(a,g);var A=(t="function"==typeof p)?null:p&&p.__k||g.__k;var D=[];L$$module$libs$preact(g,a=(!t&&p||g).__k=y$$module$libs$preact(_$$module$libs$preact,null,[a]),A||c$$module$libs$preact,c$$module$libs$preact,void 0!==g.ownerSVGElement,!t&&p?[p]:A?null:g.firstChild?n$$module$libs$preact.call(g.childNodes):null,D,!t&&p?p:A?A.__e:g.firstChild,t);M$$module$libs$preact(D,a)}
function D$$module$libs$preact(a,g){B$$module$libs$preact(a,g,D$$module$libs$preact)}function E$$module$libs$preact(a,g,p){var t,A,D,F=h$$module$libs$preact({},a.props);for(D in g)"key"==D?t=g[D]:"ref"==D?A=g[D]:F[D]=g[D];return 2<arguments.length&&(F.children=3<arguments.length?n$$module$libs$preact.call(arguments,2):p),p$$module$libs$preact(a.type,F,t||a.key,A||a.ref,null)}
function F$$module$libs$preact(a,g){var p={__c:g="__cC"+e$$module$libs$preact++,__:a,Consumer:function(t,A){return t.children(A)},Provider:function(t){var A,D;return this.getChildContext||(A=[],(D={})[g]=this,this.getChildContext=function(){return D},this.shouldComponentUpdate=function(F){this.props.value!==F.value&&A.some(function(K){K.__e=!0;m$$module$libs$preact(K)})},this.sub=function(F){A.push(F);var K=F.componentWillUnmount;F.componentWillUnmount=function(){A.splice(A.indexOf(F),1);K&&K.call(F)}}),
t.children}};return p.Provider.__=p.Consumer.contextType=p}n$$module$libs$preact=s$$module$libs$preact.slice;l$$module$libs$preact={__e:function(a,g,p,t){for(var A,D,F;g=g.__;)if((A=g.__c)&&!A.__)try{if((D=A.constructor)&&null!=D.getDerivedStateFromError&&(A.setState(D.getDerivedStateFromError(a)),F=A.__d),null!=A.componentDidCatch&&(A.componentDidCatch(a,t||{}),F=A.__d),F)return A.__E=A}catch(K){a=K}throw a;}};u$$module$libs$preact=0;i$$module$libs$preact=function(a){return null!=a&&void 0===a.constructor};
k$$module$libs$preact.prototype.setState=function(a,g){var p=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=h$$module$libs$preact({},this.state);"function"==typeof a&&(a=a(h$$module$libs$preact({},p),this.props));a&&h$$module$libs$preact(p,a);null!=a&&this.__v&&(g&&this._sb.push(g),m$$module$libs$preact(this))};k$$module$libs$preact.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),m$$module$libs$preact(this))};k$$module$libs$preact.prototype.render=_$$module$libs$preact;
t$$module$libs$preact=[];o$$module$libs$preact="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout;f$$module$libs$preact=function(a,g){return a.__v.__b-g.__v.__b};e$$module$libs$preact=w$$module$libs$preact.__r=0;var module$libs$preact={};module$libs$preact.Component=k$$module$libs$preact;module$libs$preact.Fragment=_$$module$libs$preact;module$libs$preact.cloneElement=E$$module$libs$preact;module$libs$preact.createContext=F$$module$libs$preact;
module$libs$preact.createElement=y$$module$libs$preact;module$libs$preact.createRef=d$$module$libs$preact;module$libs$preact.h=y$$module$libs$preact;module$libs$preact.hydrate=D$$module$libs$preact;module$libs$preact.isValidElement=i$$module$libs$preact;module$libs$preact.options=l$$module$libs$preact;module$libs$preact.render=B$$module$libs$preact;module$libs$preact.toChildArray=P$$module$libs$preact;function rand$$module$utils(a,g){return Math.floor(Math.random()*(g-a+1)+a)}function dist$$module$utils(a,g){const p=a.x-g.x;a=a.y-g.y;return Math.sqrt(p*p+a*a)}function get_polygon_extents$$module$utils(a){if(3>a.length)return{w:0,h:0};let g=a[0].x,p=a[0].x,t=a[0].y,A=a[0].y;for(var D=0,F=a.length;D<F;D++){const K=a[D].x,H=a[D].y;g=g<K?g:K;p=p>K?p:K;t=t<H?g:H;A=A>H?p:H}return{w:Math.abs(g-p),h:Math.abs(t-A)}}
function get_polygon_area$$module$utils(a){for(var g=0,p=0,t=a.length;p<t;p++){var A=a[p==a.length-1?0:p+1].x,D=a[p].y;g+=a[p].x*a[p==a.length-1?0:p+1].y*.5;g-=A*D*.5}return Math.abs(g)}function clamp$$module$utils(a,g,p){return Math.min(Math.max(a,g),p)}function make_xy_polygon$$module$utils(a){let g=[];for(let p=0;p<a.length;p++)g.push({x:a[p][0],y:a[p][1]});return g}
function get_polygon_centroid$$module$utils(a){var g=a[0],p=a[a.length-1];g.x==p.x&&g.y==p.y||a.push(g);var t=p=g=0,A=a.length,D,F=0;for(D=A-1;F<A;D=F++){var K=a[F];D=a[D];var H=K.x*D.y-D.x*K.y;g+=H;p+=(K.x+D.x)*H;t+=(K.y+D.y)*H}H=3*g;return{x:p/H,y:t/H}}function get_centroidic_point$$module$utils(a){for(var g={x:0,y:0},p=0;p<a.length;p++){var t=a[p];g.x+=t.x;g.y+=t.y}g.x/=a.length;g.y/=a.length;p=1E6;t=-1;for(let A=0;A<a.length;A++){const D=dist$$module$utils(a[A],g);D<p&&(p=D,t=A)}return a[t]}
function uuidv4$$module$utils(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16))}class ModalDialog$$module$utils extends k$$module$libs$preact{componentDidMount(){this.props.toggleModal()}componentWillUnmount(){this.props.toggleModal()}}function canonical_coords$$module$utils(a,g){return(0<a?"E":0>a?"W":"")+(a?Math.abs(a):"")+(0<g?"S":0>g?"N":"")+(g?Math.abs(g):"")}
function parse_canonical_coords$$module$utils(a){a=/E?([0-9]+)?W?([0-9]+)?N?([0-9]+)?S?([0-9]+)?/.exec(a);return{x:a[1]||-1*a[2]||0,y:a[4]||-1*a[3]||0}}var module$utils={};module$utils.ModalDialog=ModalDialog$$module$utils;module$utils.canonical_coords=canonical_coords$$module$utils;module$utils.clamp=clamp$$module$utils;module$utils.dist=dist$$module$utils;module$utils.get_centroidic_point=get_centroidic_point$$module$utils;module$utils.get_polygon_area=get_polygon_area$$module$utils;
module$utils.get_polygon_centroid=get_polygon_centroid$$module$utils;module$utils.get_polygon_extents=get_polygon_extents$$module$utils;module$utils.make_xy_polygon=make_xy_polygon$$module$utils;module$utils.parse_canonical_coords=parse_canonical_coords$$module$utils;module$utils.rand=rand$$module$utils;module$utils.uuidv4=uuidv4$$module$utils;const html$$module$readme=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class TokenChooserDialog$$module$readme extends ModalDialog$$module$utils{onClick(a){this.props.callback(a);this.props.onExit()}render(a,g){return html$$module$readme` <!-- The Modal -->
      <div id="TokensChooser" class="modal">
        <!-- Modal content -->
        <div class="modal-content" style="background: #e1e1e1;max-width:820px;">
          <div class="close">
            <a onClick="${a.onExit}"> ${"\u00d7"} </a>
          </div>
          <div style="display:flex;flex-wrap:wrap;background: #e1e1e1;">
            ${[{id:"barbarian",scale:7,light:30,pc:!0},{id:"thief",scale:7,light:30,pc:!0},{id:"elf",scale:7,light:60,pc:!0},{id:"fighter",scale:7,light:30,pc:!0},{id:"cleric",scale:7,light:30,pc:!0},{id:"magicuser",scale:7,light:30,pc:!0},{id:"ranger",scale:7,light:30,pc:!0},{id:"miner",scale:7,light:60,pc:!0},{id:"sorcerer",scale:7,light:30,pc:!0},{id:"spearthrower",scale:7,light:30,pc:!0},{id:"barbarian",scale:7,pc:!0},{id:"thief",scale:7,pc:!0},{id:"elf",scale:7,pc:!0},{id:"fighter",scale:7,pc:!0},
{id:"cleric",scale:7,pc:!0},{id:"magicuser",scale:7,pc:!0},{id:"ranger",scale:7,pc:!0},{id:"miner",scale:7,pc:!0},{id:"sorcerer",scale:7,pc:!0},{id:"spearthrower",scale:7,pc:!0},{id:"body",scale:7},{id:"largechest",scale:8},{id:"chest",scale:8},{id:"coins",scale:8},{id:"bag",scale:8},{id:"barrel",scale:8},{id:"goblin",scale:7},{id:"cultist",scale:7},{id:"orc",scale:5},{id:"vampire",scale:7},{id:"skeleton_a",scale:7},{id:"zombie",scale:7},{id:"skeleton_b",scale:7},{id:"shrieker",scale:5},{id:"stirge",
scale:4},{id:"gargoyle",scale:5},{id:"displacer",scale:5},{id:"snake",scale:5},{id:"spider",scale:5},{id:"wolf",scale:5},{id:"bigcat",scale:3},{id:"bats",scale:4},{id:"giantbat",scale:3},{id:"insects",scale:3},{id:"tick",scale:5},{id:"centepide",scale:3},{id:"giantrat",scale:5},{id:"cockatrice",scale:5},{id:"bear",scale:4},{id:"slime",scale:8},{id:"gcube",scale:3},{id:"owlbear",scale:3},{id:"chimera",scale:3},{id:"minotaur",scale:3},{id:"cyclop",scale:3},{id:"dragon",scale:2},{id:"purpleworm",scale:1},
{id:"biglantern",scale:4,light:300}].map(p=>html$$module$readme`
                <div style="width:150px">
                  <a onClick=${()=>this.onClick(p)}>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      style="background:none; max-width:150px; height:150px;"
                    >
                      <use
                        xlink:href="${window.app.tokens_svg}#${p.id}"
                        transform="translate(75,75) scale(${1.5*p.scale})"
                      />
                      ${p.light&&30>=p.light&&html$$module$readme`
                        <use
                          fill="#ff0000"
                          xlink:href="${window.app.tokens_svg}#torch"
                          transform="translate(120,75) scale(15)"
                        />
                      `}
                      ${p.light&&30<p.light&&html$$module$readme`
                        <use
                          fill="#ff0000"
                          xlink:href="${window.app.tokens_svg}#lantern"
                          transform="translate(120,75) scale(15)"
                        />
                      `}
                    </svg>
                  </a>
                </div>
              `)}
          </div>
        </div>
      </div>`}}class VttDialog$$module$readme extends ModalDialog$$module$utils{render(a,g){return html$$module$readme` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <div class="close">
            <a onClick="${a.onExit}"> ${"\u00d7"} </a>
          </div>
          ${window.app.provider&&window.app.provider.connected?html$$module$readme`
                <h5>Your Virtual Table Top is ready!</h5>
                <p>
                  You are now connected to the sandbox VTT room. Share the
                  following link with your players:
                </p>
                <pre>
          https://hexroll.app/join/${a.instance}
          </pre
                >
                <p>
                  To reveal or conceal hexes or dungeon areas, hold down the
                  <span class="key-button">Spacebar</span>
                  key and click any hex or area.
                </p>
                <p>
                  To indicate hexes to your players, hold down the
                  <span class="key-button">F</span> key and click any hex you
                  wish to indicate. Release the key to clear any indicated hex.
                </p>
                <p>
                  To add tokens to dungeon maps, hold down the
                  <span class="key-button">T</span> key and click the position
                  you would like the token to be added to.
                </p>
                <p>
                  To remove tokens, hold down the
                  <span class="key-button">K</span> key and click the token you
                  wish to remove.
                </p>
              `:html$$module$readme`
                <h5>VTT Disconnected</h5>
                <p>You are disconnected from the sandbox VTT room.</p>
              `}
        </div>
      </div>`}}class ReadmeDialog$$module$readme extends ModalDialog$$module$utils{render(a,g){return html$$module$readme` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <div class="close">
            <a onClick="${a.onExit}"> ${"\u00d7"} </a>
          </div>
          <h5>Credits</h5>
          <p>
            HEXROLL is developed by Ithai Levi as part of Pen, Dice & Paper, a
            family project dedicated to tabletop role-playing games.
          </p>
          <p>
            This project was made possible thanks to the incredible support I've
            been getting from the Pen Dice & Paper
            <strong> Patreon community </strong>. Thank you folks for walking
            side by side with me.
          </p>
          <p>
            The support and kind words in the forums, subreddits and online
            groups keeps me super motivated. Thank you! folks.
          </p>
          <p>
            Thanks also goes to HEXROLL 1e Github contributors for their help
            extending and tuning the original model.
          </p>
          <p>
            And last, but certainly not least, thank you! Oleg Doyla, aka
            Watabou for your incredible city and village generators, powering
            HEXROLL's settlement generator.
          </p>
          <h5>Licenses</h5>

          <h6>Designation of Open Game Content</h6>
          This document contains Open Game Content, subject to the Open Game
          License, released under the Open Game License, Version 1.0a
          (reproduced below), as described in Section 1(d) of the License. All
          other content in this generated sandbox remains the property of the
          copyright holder. Sandbox content not covered by the OGL is licensed
          under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0
          International license (CC BY-NC-SA 4.0)

          <h6>OPEN GAME LICENSE Version 1.0a</h6>

          <p>
            The following text is the property of Wizards of the Coast, Inc. and
            is Copyright 2000 Wizards of the Coast, Inc ("Wizards"). All Rights
            Reserved.
          </p>

          <p>
            1. Definitions: (a)"Contributors" means the copyright and/or
            trademark owners who have contributed Open Game Content;
            (b)"Derivative Material" means copyrighted material including
            derivative works and translations (including into other computer
            languages), potation, modification, correction, addition, extension,
            upgrade, improvement, compilation, abridgment or other form in which
            an existing work may be recast, transformed or adapted; (c)
            "Distribute" means to reproduce, license, rent, lease, sell,
            broadcast, publicly display, transmit or otherwise distribute;
            (d)"Open Game Content" means the game mechanic and includes the
            methods, procedures, processes and routines to the extent such
            content does not embody the Product Identity and is an enhancement
            over the prior art and any additional content clearly identified as
            Open Game Content by the Contributor, and means any work covered by
            this License, including translations and derivative works under
            copyright law, but specifically excludes Product Identity. (e)
            "Product Identity" means product and product line names, logos and
            identifying marks including trade dress; artifacts; creatures
            characters; stories, storylines, plots, thematic elements, dialogue,
            incidents, language, artwork, symbols, designs, depictions,
            likenesses, formats, poses, concepts, themes and graphic,
            photographic and other visual or audio representations; names and
            descriptions of characters, spells, enchantments, personalities,
            teams, personas, likenesses and special abilities; places,
            locations, environments, creatures, equipment, magical or
            supernatural abilities or effects, logos, symbols, or graphic
            designs; and any other trademark or registered trademark clearly
            identified as Product identity by the owner of the Product Identity,
            and which specifically excludes the Open Game Content; (f)
            "Trademark" means the logos, names, mark, sign, motto, designs that
            are used by a Contributor to identify itself or its products or the
            associated products contributed to the Open Game License by the
            Contributor (g) "Use", "Used" or "Using" means to use, Distribute,
            copy, edit, format, modify, translate and otherwise create
            Derivative Material of Open Game Content. (h) "You" or "Your" means
            the licensee in terms of this agreement.
          </p>

          <p>
            2. The License: This License applies to any Open Game Content that
            contains a notice indicating that the Open Game Content may only be
            Used under and in terms of this License. You must affix such a
            notice to any Open Game Content that you Use. No terms may be added
            to or subtracted from this License except as described by the
            License itself. No other terms or conditions may be applied to any
            Open Game Content distributed using this License.
          </p>

          <p>
            3. Offer and Acceptance: By Using the Open Game Content You indicate
            Your acceptance of the terms of this License.
          </p>

          <p>
            4. Grant and Consideration: In consideration for agreeing to use
            this License, the Contributors grant You a perpetual, worldwide,
            royalty-free, non-exclusive license with the exact terms of this
            License to Use, the Open Game Content.
          </p>

          <p>
            5. Representation of Authority to Contribute: If You are
            contributing original material as Open Game Content, You represent
            that Your Contributions are Your original creation and/or You have
            sufficient rights to grant the rights conveyed by this License.
          </p>

          <p>
            6. Notice of License Copyright: You must update the COPYRIGHT NOTICE
            portion of this License to include the exact text of the COPYRIGHT
            NOTICE of any Open Game Content You are copying, modifying or
            distributing, and You must add the title, the copyright date, and
            the copyright holder's name to the COPYRIGHT NOTICE of any original
            Open Game Content you Distribute.
          </p>

          <p>
            7. Use of Product Identity: You agree not to Use any Product
            Identity, including as an indication as to compatibility, except as
            expressly licensed in another, independent Agreement with the owner
            of each element of that Product Identity. You agree not to indicate
            compatibility or co-adaptability with any Trademark or Registered
            Trademark in conjunction with a work containing Open Game Content
            except as expressly licensed in another, independent Agreement with
            the owner of such Trademark or Registered Trademark. The use of any
            Product Identity in Open Game Content does not constitute a
            challenge to the ownership of that Product Identity. The owner of
            any Product Identity used in Open Game Content shall retain all
            rights, title and interest in and to that Product Identity.
          </p>

          <p>
            8. Identification: If you distribute Open Game Content You must
            clearly indicate which portions of the work that you are
            distributing are Open Game Content.
          </p>

          <p>
            9. Updating the License: Wizards or its designated Agents may
            publish updated versions of this License. You may use any authorized
            version of this License to copy, modify and distribute any Open Game
            Content originally distributed under any version of this License.
          </p>

          <p>
            10. Copy of this License: You MUST include a copy of this License
            with every copy of the Open Game Content You Distribute.
          </p>

          <p>
            11. Use of Contributor Credits: You may not market or advertise the
            Open Game Content using the name of any Contributor unless You have
            written permission from the Contributor to do so.
          </p>

          <p>
            12. Inability to Comply: If it is impossible for You to comply with
            any of the terms of this License with respect to some or all of the
            Open Game Content due to statute, judicial order, or governmental
            regulation then You may not Use any Open Game Material so affected.
          </p>

          <p>
            13. Termination: This License will terminate automatically if You
            fail to comply with all terms herein and fail to cure such breach
            within 30 days of becoming aware of the breach. All sublicenses
            shall survive the termination of this License.
          </p>

          <p>
            14. Reformation: If any provision of this License is held to be
            unenforceable, such provision shall be reformed only to the extent
            necessary to make it enforceable.
          </p>

          <p>
            15. COPYRIGHT NOTICE Open Game License v 1.0 Copyright 2000, Wizards
            of the Coast, Inc.
          </p>

          <p>Hexroll is copyright &copy; 2021-2023 pendicepaper.com.</p>
        </div>
      </div>`}}var module$readme={};module$readme.ReadmeDialog=ReadmeDialog$$module$readme;module$readme.TokenChooserDialog=TokenChooserDialog$$module$readme;module$readme.VttDialog=VttDialog$$module$readme;const is_electron$$module$api_shim=!0;function api_call_html$$module$api_shim(a,g,p){return new Promise(async t=>{let A=await window.api.get(p);t(A)})}function api_call_map$$module$api_shim(a){return new Promise(async g=>{let p=JSON.parse(await window.api.map());g(p)})}function api_call_dungeon$$module$api_shim(a,g){return new Promise(async p=>{let t=JSON.parse(await window.api.dungeon(g));p(t)})}
function api_call_city$$module$api_shim(a,g){return new Promise(async p=>{let t=JSON.parse(await window.api.city(g));p(t)})}function api_call_version$$module$api_shim(a){return new Promise(async g=>{g({})})}function api_call_search$$module$api_shim(a,g){return new Promise(async p=>{let t={};t.results=await window.api.search(g);p(t)})}var module$api_shim={};module$api_shim.api_call_city=api_call_city$$module$api_shim;module$api_shim.api_call_dungeon=api_call_dungeon$$module$api_shim;
module$api_shim.api_call_html=api_call_html$$module$api_shim;module$api_shim.api_call_map=api_call_map$$module$api_shim;module$api_shim.api_call_search=api_call_search$$module$api_shim;module$api_shim.api_call_version=api_call_version$$module$api_shim;module$api_shim.is_electron=is_electron$$module$api_shim;const BUILD_ID$$module$version="2310081853";var module$version={};module$version.BUILD_ID=BUILD_ID$$module$version;var t$$module$libs$hooks_module,r$$module$libs$hooks_module,u$$module$libs$hooks_module,i$$module$libs$hooks_module,o$$module$libs$hooks_module=0,f$$module$libs$hooks_module=[],c$$module$libs$hooks_module=[],e$$module$libs$hooks_module=l$$module$libs$preact.__b,a$$module$libs$hooks_module=l$$module$libs$preact.__r,v$$module$libs$hooks_module=l$$module$libs$preact.diffed,l$$module$libs$hooks_module=l$$module$libs$preact.__c,m$$module$libs$hooks_module=l$$module$libs$preact.unmount;
function d$$module$libs$hooks_module(a,g){l$$module$libs$preact.__h&&l$$module$libs$preact.__h(r$$module$libs$hooks_module,a,o$$module$libs$hooks_module||g);o$$module$libs$hooks_module=0;g=r$$module$libs$hooks_module.__H||(r$$module$libs$hooks_module.__H={__:[],__h:[]});return a>=g.__.length&&g.__.push({__V:c$$module$libs$hooks_module}),g.__[a]}function h$$module$libs$hooks_module(a){return o$$module$libs$hooks_module=1,s$$module$libs$hooks_module(B$$module$libs$hooks_module,a)}
function s$$module$libs$hooks_module(a,g,p){var t=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,2);if(t.t=a,!t.__c&&(t.__=[p?p(g):B$$module$libs$hooks_module(void 0,g),function(K){var H=t.__N?t.__N[0]:t.__[0];K=t.t(H,K);H!==K&&(t.__N=[K,t.__[1]],t.__c.setState({}))}],t.__c=r$$module$libs$hooks_module,!r$$module$libs$hooks_module.u)){var A=function(K,H,J){if(!t.__c.__H)return!0;var I=t.__c.__H.__.filter(function(T){return T.__c});if(I.every(function(T){return!T.__N}))return!D||D.call(this,
K,H,J);var N=!1;return I.forEach(function(T){if(T.__N){var O=T.__[0];T.__=T.__N;T.__N=void 0;O!==T.__[0]&&(N=!0)}}),!(!N&&t.__c.props===K)&&(!D||D.call(this,K,H,J))};r$$module$libs$hooks_module.u=!0;var D=r$$module$libs$hooks_module.shouldComponentUpdate,F=r$$module$libs$hooks_module.componentWillUpdate;r$$module$libs$hooks_module.componentWillUpdate=function(K,H,J){if(this.__e){var I=D;D=void 0;A(K,H,J);D=I}F&&F.call(this,K,H,J)};r$$module$libs$hooks_module.shouldComponentUpdate=A}return t.__N||
t.__}function p$$module$libs$hooks_module(a,g){var p=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,3);!l$$module$libs$preact.__s&&z$$module$libs$hooks_module(p.__H,g)&&(p.__=a,p.i=g,r$$module$libs$hooks_module.__H.__h.push(p))}function y$$module$libs$hooks_module(a,g){var p=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,4);!l$$module$libs$preact.__s&&z$$module$libs$hooks_module(p.__H,g)&&(p.__=a,p.i=g,r$$module$libs$hooks_module.__h.push(p))}
function _$$module$libs$hooks_module(a){return o$$module$libs$hooks_module=5,F$$module$libs$hooks_module(function(){return{current:a}},[])}function A$$module$libs$hooks_module(a,g,p){o$$module$libs$hooks_module=6;y$$module$libs$hooks_module(function(){return"function"==typeof a?(a(g()),function(){return a(null)}):a?(a.current=g(),function(){return a.current=null}):void 0},null==p?p:p.concat(a))}
function F$$module$libs$hooks_module(a,g){var p=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,7);return z$$module$libs$hooks_module(p.__H,g)?(p.__V=a(),p.i=g,p.__h=a,p.__V):p.__}function T$$module$libs$hooks_module(a,g){return o$$module$libs$hooks_module=8,F$$module$libs$hooks_module(function(){return a},g)}
function q$$module$libs$hooks_module(a){var g=r$$module$libs$hooks_module.context[a.__c],p=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,9);return p.c=a,g?(null==p.__&&(p.__=!0,g.sub(r$$module$libs$hooks_module)),g.props.value):a.__}function x$$module$libs$hooks_module(a,g){l$$module$libs$preact.useDebugValue&&l$$module$libs$preact.useDebugValue(g?g(a):a)}
function P$$module$libs$hooks_module(a){var g=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,10),p=h$$module$libs$hooks_module();return g.__=a,r$$module$libs$hooks_module.componentDidCatch||(r$$module$libs$hooks_module.componentDidCatch=function(t,A){g.__&&g.__(t,A);p[1](t)}),[p[0],function(){p[1](void 0)}]}
function V$$module$libs$hooks_module(){var a=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,11);if(!a.__){for(var g=r$$module$libs$hooks_module.__v;null!==g&&!g.__m&&null!==g.__;)g=g.__;g=g.__m||(g.__m=[0,0]);a.__="P"+g[0]+"-"+g[1]++}return a.__}
function b$$module$libs$hooks_module(){for(var a;a=f$$module$libs$hooks_module.shift();)if(a.__P&&a.__H)try{a.__H.__h.forEach(k$$module$libs$hooks_module),a.__H.__h.forEach(w$$module$libs$hooks_module),a.__H.__h=[]}catch(g){a.__H.__h=[],l$$module$libs$preact.__e(g,a.__v)}}l$$module$libs$preact.__b=function(a){r$$module$libs$hooks_module=null;e$$module$libs$hooks_module&&e$$module$libs$hooks_module(a)};
l$$module$libs$preact.__r=function(a){a$$module$libs$hooks_module&&a$$module$libs$hooks_module(a);t$$module$libs$hooks_module=0;(a=(r$$module$libs$hooks_module=a.__c).__H)&&(u$$module$libs$hooks_module===r$$module$libs$hooks_module?(a.__h=[],r$$module$libs$hooks_module.__h=[],a.__.forEach(function(g){g.__N&&(g.__=g.__N);g.__V=c$$module$libs$hooks_module;g.__N=g.i=void 0})):(a.__h.forEach(k$$module$libs$hooks_module),a.__h.forEach(w$$module$libs$hooks_module),a.__h=[]));u$$module$libs$hooks_module=
r$$module$libs$hooks_module};
l$$module$libs$preact.diffed=function(a){v$$module$libs$hooks_module&&v$$module$libs$hooks_module(a);(a=a.__c)&&a.__H&&(a.__H.__h.length&&(1!==f$$module$libs$hooks_module.push(a)&&i$$module$libs$hooks_module===l$$module$libs$preact.requestAnimationFrame||((i$$module$libs$hooks_module=l$$module$libs$preact.requestAnimationFrame)||j$$module$libs$hooks_module)(b$$module$libs$hooks_module)),a.__H.__.forEach(function(g){g.i&&(g.__H=g.i);g.__V!==c$$module$libs$hooks_module&&(g.__=g.__V);g.i=void 0;g.__V=
c$$module$libs$hooks_module}));u$$module$libs$hooks_module=r$$module$libs$hooks_module=null};l$$module$libs$preact.__c=function(a,g){g.some(function(p){try{p.__h.forEach(k$$module$libs$hooks_module),p.__h=p.__h.filter(function(t){return!t.__||w$$module$libs$hooks_module(t)})}catch(t){g.some(function(A){A.__h&&(A.__h=[])}),g=[],l$$module$libs$preact.__e(t,p.__v)}});l$$module$libs$hooks_module&&l$$module$libs$hooks_module(a,g)};
l$$module$libs$preact.unmount=function(a){m$$module$libs$hooks_module&&m$$module$libs$hooks_module(a);var g;(a=a.__c)&&a.__H&&(a.__H.__.forEach(function(p){try{k$$module$libs$hooks_module(p)}catch(t){g=t}}),a.__H=void 0,g&&l$$module$libs$preact.__e(g,a.__v))};var g$$module$libs$hooks_module="function"==typeof requestAnimationFrame;
function j$$module$libs$hooks_module(a){var g,p=function(){clearTimeout(t);g$$module$libs$hooks_module&&cancelAnimationFrame(g);setTimeout(a)},t=setTimeout(p,100);g$$module$libs$hooks_module&&(g=requestAnimationFrame(p))}function k$$module$libs$hooks_module(a){var g=r$$module$libs$hooks_module,p=a.__c;"function"==typeof p&&(a.__c=void 0,p());r$$module$libs$hooks_module=g}function w$$module$libs$hooks_module(a){var g=r$$module$libs$hooks_module;a.__c=a.__();r$$module$libs$hooks_module=g}
function z$$module$libs$hooks_module(a,g){return!a||a.length!==g.length||g.some(function(p,t){return p!==a[t]})}function B$$module$libs$hooks_module(a,g){return"function"==typeof g?g(a):g}var module$libs$hooks_module={};module$libs$hooks_module.useCallback=T$$module$libs$hooks_module;module$libs$hooks_module.useContext=q$$module$libs$hooks_module;module$libs$hooks_module.useDebugValue=x$$module$libs$hooks_module;module$libs$hooks_module.useEffect=p$$module$libs$hooks_module;
module$libs$hooks_module.useErrorBoundary=P$$module$libs$hooks_module;module$libs$hooks_module.useId=V$$module$libs$hooks_module;module$libs$hooks_module.useImperativeHandle=A$$module$libs$hooks_module;module$libs$hooks_module.useLayoutEffect=y$$module$libs$hooks_module;module$libs$hooks_module.useMemo=F$$module$libs$hooks_module;module$libs$hooks_module.useReducer=s$$module$libs$hooks_module;module$libs$hooks_module.useRef=_$$module$libs$hooks_module;module$libs$hooks_module.useState=h$$module$libs$hooks_module;var a$$module$libs$preact_router_module={};function c$$module$libs$preact_router_module(a,g){for(var p in g)a[p]=g[p];return a}
function s$$module$libs$preact_router_module(a,g,p){var t=/(?:\?([^#]*))?(#.*)?$/,A=a.match(t),D={};if(A&&A[1]){A=A[1].split("&");for(var F=0;F<A.length;F++){var K=A[F].split("=");D[decodeURIComponent(K[0])]=decodeURIComponent(K.slice(1).join("="))}}a=d$$module$libs$preact_router_module(a.replace(t,""));g=d$$module$libs$preact_router_module(g||"");t=Math.max(a.length,g.length);for(A=0;A<t;A++)if(g[A]&&":"===g[A].charAt(0)){F=g[A].replace(/(^:|[+*?]+$)/g,"");K=(g[A].match(/[+*?]+$/)||a$$module$libs$preact_router_module)[0]||
"";var H=~K.indexOf("+"),J=~K.indexOf("*"),I=a[A]||"";if(!I&&!J&&(0>K.indexOf("?")||H)){var N=!1;break}if(D[F]=decodeURIComponent(I),H||J){D[F]=a.slice(A).map(decodeURIComponent).join("/");break}}else if(g[A]!==a[A]){N=!1;break}return(!0===p.default||!1!==N)&&D}function h$$module$libs$preact_router_module(a,g){return a.rank<g.rank?1:a.rank>g.rank?-1:a.index-g.index}
function v$$module$libs$preact_router_module(a,g){return a.index=g,a.rank=a.props.default?0:d$$module$libs$preact_router_module(a.props.path).map(l$$module$libs$preact_router_module).join(""),a.props}function d$$module$libs$preact_router_module(a){return a.replace(/(^\/+|\/+$)/g,"").split("/")}function l$$module$libs$preact_router_module(a){return":"==a.charAt(0)?1+"*+?".indexOf(a.charAt(a.length-1))||4:5}
var p$$module$libs$preact_router_module={},m$$module$libs$preact_router_module=[],y$$module$libs$preact_router_module=[],U$$module$libs$preact_router_module=null,g$$module$libs$preact_router_module={url:R$$module$libs$preact_router_module()},k$$module$libs$preact_router_module=F$$module$libs$preact(g$$module$libs$preact_router_module);
function C$$module$libs$preact_router_module(){var a=q$$module$libs$hooks_module(k$$module$libs$preact_router_module);if(a===g$$module$libs$preact_router_module){var g=h$$module$libs$hooks_module()[1];p$$module$libs$hooks_module(function(){return y$$module$libs$preact_router_module.push(g),function(){return y$$module$libs$preact_router_module.splice(y$$module$libs$preact_router_module.indexOf(g),1)}},[])}return[a,$$$module$libs$preact_router_module]}
function R$$module$libs$preact_router_module(){var a;return""+((a=U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module.location?U$$module$libs$preact_router_module.location:U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module.getCurrentLocation?U$$module$libs$preact_router_module.getCurrentLocation():"undefined"!=typeof location?location:p$$module$libs$preact_router_module).pathname||"")+(a.search||"")}
function $$$module$libs$preact_router_module(a,g){return void 0===g&&(g=!1),"string"!=typeof a&&a.url&&(g=a.replace,a=a.url),function(p){for(var t=m$$module$libs$preact_router_module.length;t--;)if(m$$module$libs$preact_router_module[t].canRoute(p))return!0;return!1}(a)&&function(p,t){void 0===t&&(t="push");U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module[t]?U$$module$libs$preact_router_module[t](p):"undefined"!=typeof history&&history[t+"State"]&&history[t+"State"](null,null,
p)}(a,g?"replace":"push"),I$$module$libs$preact_router_module(a)}function I$$module$libs$preact_router_module(a){for(var g=!1,p=0;p<m$$module$libs$preact_router_module.length;p++)m$$module$libs$preact_router_module[p].routeTo(a)&&(g=!0);return g}function M$$module$libs$preact_router_module(a){if(a&&a.getAttribute){var g=a.getAttribute("href");a=a.getAttribute("target");if(g&&g.match(/^\//g)&&(!a||a.match(/^_?self$/i)))return $$$module$libs$preact_router_module(g)}}
function b$$module$libs$preact_router_module(a){return a.stopImmediatePropagation&&a.stopImmediatePropagation(),a.stopPropagation&&a.stopPropagation(),a.preventDefault(),!1}
function W$$module$libs$preact_router_module(a){if(!(a.ctrlKey||a.metaKey||a.altKey||a.shiftKey||a.button)){var g=a.target;do if("a"===g.localName&&g.getAttribute("href")){if(g.hasAttribute("data-native")||g.hasAttribute("native"))break;if(M$$module$libs$preact_router_module(g))return b$$module$libs$preact_router_module(a)}while(g=g.parentNode)}}var w$$module$libs$preact_router_module=!1;
function D$$module$libs$preact_router_module(a){a.history&&(U$$module$libs$preact_router_module=a.history);this.state={url:a.url||R$$module$libs$preact_router_module()}}
c$$module$libs$preact_router_module(D$$module$libs$preact_router_module.prototype=new k$$module$libs$preact,{shouldComponentUpdate:function(a){return!0!==a.static||a.url!==this.props.url||a.onChange!==this.props.onChange},canRoute:function(a){var g=P$$module$libs$preact(this.props.children);return void 0!==this.g(g,a)},routeTo:function(a){this.setState({url:a});a=this.canRoute(a);return this.p||this.forceUpdate(),a},componentWillMount:function(){this.p=!0},componentDidMount:function(){var a=this;
w$$module$libs$preact_router_module||(w$$module$libs$preact_router_module=!0,U$$module$libs$preact_router_module||addEventListener("popstate",function(){I$$module$libs$preact_router_module(R$$module$libs$preact_router_module())}),addEventListener("click",W$$module$libs$preact_router_module));m$$module$libs$preact_router_module.push(this);U$$module$libs$preact_router_module&&(this.u=U$$module$libs$preact_router_module.listen(function(g){g=g.location||g;a.routeTo(""+(g.pathname||"")+(g.search||""))}));
this.p=!1},componentWillUnmount:function(){"function"==typeof this.u&&this.u();m$$module$libs$preact_router_module.splice(m$$module$libs$preact_router_module.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(a,g){a=a.filter(v$$module$libs$preact_router_module).sort(h$$module$libs$preact_router_module);for(var p=0;p<a.length;p++){var t=a[p],A=s$$module$libs$preact_router_module(g,t.props.path,t.props);if(A)return[t,A]}},render:function(a,
g){var p,t,A=a.onChange,D=g.url;g=this.c;a=this.g(P$$module$libs$preact(a.children),D);if(a&&(t=E$$module$libs$preact(a[0],c$$module$libs$preact_router_module(c$$module$libs$preact_router_module({url:D,matches:p=a[1]},p),{key:void 0,ref:void 0}))),D!==(g&&g.url)){c$$module$libs$preact_router_module(g$$module$libs$preact_router_module,g=this.c={url:D,previous:g&&g.url,current:t,path:t?t.props.path:null,matches:p});g.router=this;g.active=t?[t]:[];for(p=y$$module$libs$preact_router_module.length;p--;)y$$module$libs$preact_router_module[p]({});
"function"==typeof A&&A(g)}return y$$module$libs$preact(k$$module$libs$preact_router_module.Provider,{value:g},t)}});var E$$module$libs$preact_router_module=function(a){return y$$module$libs$preact("a",c$$module$libs$preact_router_module({onClick:W$$module$libs$preact_router_module},a))},L$$module$libs$preact_router_module=function(a){return y$$module$libs$preact(a.component,a)},module$libs$preact_router_module={};module$libs$preact_router_module.Link=E$$module$libs$preact_router_module;
module$libs$preact_router_module.Route=L$$module$libs$preact_router_module;module$libs$preact_router_module.Router=D$$module$libs$preact_router_module;module$libs$preact_router_module.default=D$$module$libs$preact_router_module;module$libs$preact_router_module.exec=s$$module$libs$preact_router_module;module$libs$preact_router_module.getCurrentUrl=R$$module$libs$preact_router_module;module$libs$preact_router_module.route=$$$module$libs$preact_router_module;
module$libs$preact_router_module.useRouter=C$$module$libs$preact_router_module;/*
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource>  queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource>  safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource>  simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
const create$$module$libs$y_webrtc_min=()=>new Map,copy$$module$libs$y_webrtc_min=a=>{const g=create$$module$libs$y_webrtc_min();return a.forEach((p,t)=>{g.set(t,p)}),g},setIfUndefined$$module$libs$y_webrtc_min=(a,g,p)=>{let t=a.get(g);return void 0===t&&a.set(g,t=p()),t},create$1$$module$libs$y_webrtc_min=()=>new Set,last$$module$libs$y_webrtc_min=a=>a[a.length-1],appendTo$$module$libs$y_webrtc_min=(a,g)=>{for(let p=0;p<g.length;p++)a.push(g[p])},from$$module$libs$y_webrtc_min=Array.from,isArray$$module$libs$y_webrtc_min=
Array.isArray;
class Observable$$module$libs$y_webrtc_min{constructor(){this._observers=create$$module$libs$y_webrtc_min()}on(a,g){setIfUndefined$$module$libs$y_webrtc_min(this._observers,a,create$1$$module$libs$y_webrtc_min).add(g)}once(a,g){const p=(...t)=>{this.off(a,p);g(...t)};this.on(a,p)}off(a,g){const p=this._observers.get(a);void 0!==p&&(p.delete(g),0===p.size&&this._observers.delete(a))}emit(a,g){return from$$module$libs$y_webrtc_min((this._observers.get(a)||create$$module$libs$y_webrtc_min()).values()).forEach(p=>p(...g))}destroy(){this._observers=
create$$module$libs$y_webrtc_min()}}
const floor$$module$libs$y_webrtc_min=Math.floor,abs$$module$libs$y_webrtc_min=Math.abs,log10$$module$libs$y_webrtc_min=Math.log10,min$$module$libs$y_webrtc_min=(a,g)=>a<g?a:g,max$$module$libs$y_webrtc_min=(a,g)=>a>g?a:g,isNegativeZero$$module$libs$y_webrtc_min=a=>0!==a?0>a:0>1/a,getUnixTime$$module$libs$y_webrtc_min=Date.now,setupWS$$module$libs$y_webrtc_min=a=>{if(a.shouldConnect&&null===a.ws){const g=new WebSocket(a.url),p=a.binaryType;let t=null;p&&(g.binaryType=p);a.ws=g;a.connecting=!0;a.connected=
!1;g.onmessage=F=>{a.lastMessageReceived=getUnixTime$$module$libs$y_webrtc_min();F=F.data;(F="string"==typeof F?JSON.parse(F):F)&&"pong"===F.type&&(clearTimeout(t),t=setTimeout(D,15E3));a.emit("message",[F,a])};const A=F=>{null!==a.ws&&(a.ws=null,a.connecting=!1,a.connected?(a.connected=!1,a.emit("disconnect",[{type:"disconnect",error:F},a])):a.unsuccessfulReconnects++,setTimeout(setupWS$$module$libs$y_webrtc_min,min$$module$libs$y_webrtc_min(1200*log10$$module$libs$y_webrtc_min(a.unsuccessfulReconnects+
1),2500),a));clearTimeout(t)},D=()=>{a.ws===g&&a.send({type:"ping"})};g.onclose=()=>A(null);g.onerror=F=>A(F);g.onopen=()=>{a.lastMessageReceived=getUnixTime$$module$libs$y_webrtc_min();a.connecting=!1;a.connected=!0;a.unsuccessfulReconnects=0;a.emit("connect",[{type:"connect"},a]);t=setTimeout(D,15E3)}}};
class WebsocketClient$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,{binaryType:g}={}){super();this.url=a;this.ws=null;this.binaryType=g||null;this.connecting=this.connected=!1;this.lastMessageReceived=this.unsuccessfulReconnects=0;this.shouldConnect=!0;this._checkInterval=setInterval(()=>{this.connected&&3E4<getUnixTime$$module$libs$y_webrtc_min()-this.lastMessageReceived&&this.ws.close()},15E3);setupWS$$module$libs$y_webrtc_min(this)}send(a){this.ws&&this.ws.send(JSON.stringify(a))}destroy(){clearInterval(this._checkInterval);
this.disconnect();super.destroy()}disconnect(){this.shouldConnect=!1;null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0;this.connected||null!==this.ws||setupWS$$module$libs$y_webrtc_min(this)}}
const create$2$$module$libs$y_webrtc_min=a=>Error(a),methodUnimplemented$$module$libs$y_webrtc_min=()=>{throw create$2$$module$libs$y_webrtc_min("Method unimplemented");},unexpectedCase$$module$libs$y_webrtc_min=()=>{throw create$2$$module$libs$y_webrtc_min("Unexpected case");},getRandomValues$$module$libs$y_webrtc_min=crypto.getRandomValues.bind(crypto),rand$$module$libs$y_webrtc_min=Math.random,uint32$$module$libs$y_webrtc_min=()=>getRandomValues$$module$libs$y_webrtc_min(new Uint32Array(1))[0],
uuidv4Template$$module$libs$y_webrtc_min="10000000-1000-4000-8000-100000000000",uuidv4$$module$libs$y_webrtc_min=()=>uuidv4Template$$module$libs$y_webrtc_min.replace(/[018]/g,a=>(a^uint32$$module$libs$y_webrtc_min()&15>>a/4).toString(16)),fromCharCode$$module$libs$y_webrtc_min=String.fromCharCode,trimLeftRegex$$module$libs$y_webrtc_min=/^\s*/g,fromCamelCaseRegex$$module$libs$y_webrtc_min=/([A-Z])/g,fromCamelCase$$module$libs$y_webrtc_min=(a,g)=>a.replace(fromCamelCaseRegex$$module$libs$y_webrtc_min,
p=>`${g}${p.toLowerCase()}`).replace(trimLeftRegex$$module$libs$y_webrtc_min,""),utf8TextEncoder$$module$libs$y_webrtc_min="undefined"!=typeof TextEncoder?new TextEncoder:null,encodeUtf8$$module$libs$y_webrtc_min=utf8TextEncoder$$module$libs$y_webrtc_min?a=>utf8TextEncoder$$module$libs$y_webrtc_min.encode(a):a=>{a=unescape(encodeURIComponent(a));const g=a.length,p=new Uint8Array(g);for(let t=0;t<g;t++)p[t]=a.codePointAt(t);return p};
let utf8TextDecoder$$module$libs$y_webrtc_min="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});utf8TextDecoder$$module$libs$y_webrtc_min&&1===utf8TextDecoder$$module$libs$y_webrtc_min.decode(new Uint8Array).length&&(utf8TextDecoder$$module$libs$y_webrtc_min=null);const repeat$$module$libs$y_webrtc_min=(a,g)=>((p,t)=>{const A=Array(p);for(let D=0;D<p;D++)A[D]=t(D,A);return A})(g,()=>a).join(""),undefinedToNull$$module$libs$y_webrtc_min=a=>void 0===a?null:a;
let _localStorage$$module$libs$y_webrtc_min=new class{constructor(){this.map=new Map}setItem(a,g){this.map.set(a,g)}getItem(a){return this.map.get(a)}},usePolyfill$$module$libs$y_webrtc_min=!0;try{"undefined"!=typeof localStorage&&(_localStorage$$module$libs$y_webrtc_min=localStorage,usePolyfill$$module$libs$y_webrtc_min=!1)}catch(a){}
const varStorage$$module$libs$y_webrtc_min=_localStorage$$module$libs$y_webrtc_min,assign$$module$libs$y_webrtc_min=Object.assign,keys$$module$libs$y_webrtc_min=Object.keys,length$$module$libs$y_webrtc_min=a=>keys$$module$libs$y_webrtc_min(a).length,hasProperty$$module$libs$y_webrtc_min=(a,g)=>Object.prototype.hasOwnProperty.call(a,g),callAll$$module$libs$y_webrtc_min=(a,g,p=0)=>{try{for(;p<a.length;p++)a[p](...g)}finally{p<a.length&&callAll$$module$libs$y_webrtc_min(a,g,p+1)}},nop$$module$libs$y_webrtc_min=
()=>{},id$$module$libs$y_webrtc_min=a=>a,equalityDeep$$module$libs$y_webrtc_min=(a,g)=>{if(null==a||null==g)return a===g;if(a.constructor!==g.constructor)return!1;if(a===g)return!0;switch(a.constructor){case ArrayBuffer:a=new Uint8Array(a),g=new Uint8Array(g);case Uint8Array:if(a.byteLength!==g.byteLength)return!1;for(var p=0;p<a.length;p++)if(a[p]!==g[p])return!1;break;case Set:if(a.size!==g.size)return!1;for(p of a)if(!g.has(p))return!1;break;case Map:if(a.size!==g.size)return!1;for(const t of a.keys())if(!g.has(t)||
!equalityDeep$$module$libs$y_webrtc_min(a.get(t),g.get(t)))return!1;break;case Object:if(length$$module$libs$y_webrtc_min(a)!==length$$module$libs$y_webrtc_min(g))return!1;for(const t in a)if(!hasProperty$$module$libs$y_webrtc_min(a,t)||!equalityDeep$$module$libs$y_webrtc_min(a[t],g[t]))return!1;break;case Array:if(a.length!==g.length)return!1;for(p=0;p<a.length;p++)if(!equalityDeep$$module$libs$y_webrtc_min(a[p],g[p]))return!1;break;default:return!1}return!0},isNode$$module$libs$y_webrtc_min="undefined"!=
typeof process&&process.release&&/node|io\.js/.test(process.release.name),isBrowser$$module$libs$y_webrtc_min="undefined"!=typeof window&&"undefined"!=typeof document&&!isNode$$module$libs$y_webrtc_min;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let params$$module$libs$y_webrtc_min;
const hasParam$$module$libs$y_webrtc_min=a=>(()=>{if(void 0===params$$module$libs$y_webrtc_min)if(isNode$$module$libs$y_webrtc_min){params$$module$libs$y_webrtc_min=create$$module$libs$y_webrtc_min();const g=process.argv;let p=null;for(let t=0;t<g.length;t++){const A=g[t];"-"===A[0]?(null!==p&&params$$module$libs$y_webrtc_min.set(p,""),p=A):null!==p&&(params$$module$libs$y_webrtc_min.set(p,A),p=null)}null!==p&&params$$module$libs$y_webrtc_min.set(p,"")}else"object"==typeof location?(params$$module$libs$y_webrtc_min=
create$$module$libs$y_webrtc_min(),(location.search||"?").slice(1).split("&").forEach(g=>{if(0!==g.length){const [p,t]=g.split("=");params$$module$libs$y_webrtc_min.set("--"+fromCamelCase$$module$libs$y_webrtc_min(p,"-"),t);params$$module$libs$y_webrtc_min.set("-"+fromCamelCase$$module$libs$y_webrtc_min(p,"-"),t)}})):params$$module$libs$y_webrtc_min=create$$module$libs$y_webrtc_min();return params$$module$libs$y_webrtc_min})().has(a),getVariable$$module$libs$y_webrtc_min=a=>undefinedToNull$$module$libs$y_webrtc_min(isNode$$module$libs$y_webrtc_min?
process.env[a.toUpperCase()]:varStorage$$module$libs$y_webrtc_min.getItem(a));hasParam$$module$libs$y_webrtc_min("--"+(name$$module$libs$y_webrtc_min="production"))||getVariable$$module$libs$y_webrtc_min(name$$module$libs$y_webrtc_min);var name$$module$libs$y_webrtc_min;const forceColor$$module$libs$y_webrtc_min=isNode$$module$libs$y_webrtc_min&&(value$$module$libs$y_webrtc_min=process.env.FORCE_COLOR,["true","1","2"].includes(value$$module$libs$y_webrtc_min));var value$$module$libs$y_webrtc_min;
const supportsColor$$module$libs$y_webrtc_min=!hasParam$$module$libs$y_webrtc_min("no-colors")&&(!isNode$$module$libs$y_webrtc_min||process.stdout.isTTY||forceColor$$module$libs$y_webrtc_min)&&(!isNode$$module$libs$y_webrtc_min||hasParam$$module$libs$y_webrtc_min("color")||forceColor$$module$libs$y_webrtc_min||null!==getVariable$$module$libs$y_webrtc_min("COLORTERM")||(getVariable$$module$libs$y_webrtc_min("TERM")||"").includes("color")),MAX_SAFE_INTEGER$$module$libs$y_webrtc_min=Number.MAX_SAFE_INTEGER,
isInteger$$module$libs$y_webrtc_min=Number.isInteger||(a=>"number"==typeof a&&isFinite(a)&&floor$$module$libs$y_webrtc_min(a)===a),errorUnexpectedEndOfArray$$module$libs$y_webrtc_min=create$2$$module$libs$y_webrtc_min("Unexpected end of array"),errorIntegerOutOfRange$$module$libs$y_webrtc_min=create$2$$module$libs$y_webrtc_min("Integer out of Range");class Decoder$$module$libs$y_webrtc_min{constructor(a){this.arr=a;this.pos=0}}
const createDecoder$$module$libs$y_webrtc_min=a=>new Decoder$$module$libs$y_webrtc_min(a),hasContent$$module$libs$y_webrtc_min=a=>a.pos!==a.arr.length,readVarUint8Array$$module$libs$y_webrtc_min=a=>{var g=readVarUint$$module$libs$y_webrtc_min(a);const p=createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.arr.buffer,a.pos+a.arr.byteOffset,g);return a.pos+=g,p},readUint8$$module$libs$y_webrtc_min=a=>a.arr[a.pos++],readVarUint$$module$libs$y_webrtc_min=a=>{let g=0,p=1;const t=a.arr.length;
for(;a.pos<t;){const A=a.arr[a.pos++];if(g+=(127&A)*p,p*=128,128>A)return g;if(g>MAX_SAFE_INTEGER$$module$libs$y_webrtc_min)throw errorIntegerOutOfRange$$module$libs$y_webrtc_min;}throw errorUnexpectedEndOfArray$$module$libs$y_webrtc_min;},readVarInt$$module$libs$y_webrtc_min=a=>{let g=a.arr[a.pos++],p=63&g,t=64;const A=0<(64&g)?-1:1;if(0==(128&g))return A*p;const D=a.arr.length;for(;a.pos<D;){if(g=a.arr[a.pos++],p+=(127&g)*t,t*=128,128>g)return A*p;if(p>MAX_SAFE_INTEGER$$module$libs$y_webrtc_min)throw errorIntegerOutOfRange$$module$libs$y_webrtc_min;
}throw errorUnexpectedEndOfArray$$module$libs$y_webrtc_min;},readVarString$$module$libs$y_webrtc_min=utf8TextDecoder$$module$libs$y_webrtc_min?a=>utf8TextDecoder$$module$libs$y_webrtc_min.decode(readVarUint8Array$$module$libs$y_webrtc_min(a)):a=>{let g=readVarUint$$module$libs$y_webrtc_min(a);if(0===g)return"";let p=String.fromCodePoint(readUint8$$module$libs$y_webrtc_min(a));if(100>--g)for(;g--;)p+=String.fromCodePoint(readUint8$$module$libs$y_webrtc_min(a));else for(;0<g;){const t=1E4>g?g:1E4,A=
a.arr.subarray(a.pos,a.pos+t);a.pos+=t;p+=String.fromCodePoint.apply(null,A);g-=t}return decodeURIComponent(escape(p))},readFromDataView$$module$libs$y_webrtc_min=(a,g)=>{const p=new DataView(a.arr.buffer,a.arr.byteOffset+a.pos,g);return a.pos+=g,p},readAnyLookupTable$$module$libs$y_webrtc_min=[a=>{},a=>null,readVarInt$$module$libs$y_webrtc_min,a=>readFromDataView$$module$libs$y_webrtc_min(a,4).getFloat32(0,!1),a=>readFromDataView$$module$libs$y_webrtc_min(a,8).getFloat64(0,!1),a=>readFromDataView$$module$libs$y_webrtc_min(a,
8).getBigInt64(0,!1),a=>!1,a=>!0,readVarString$$module$libs$y_webrtc_min,a=>{const g=readVarUint$$module$libs$y_webrtc_min(a),p={};for(let t=0;t<g;t++)p[readVarString$$module$libs$y_webrtc_min(a)]=readAny$$module$libs$y_webrtc_min(a);return p},a=>{const g=readVarUint$$module$libs$y_webrtc_min(a),p=[];for(let t=0;t<g;t++)p.push(readAny$$module$libs$y_webrtc_min(a));return p},readVarUint8Array$$module$libs$y_webrtc_min],readAny$$module$libs$y_webrtc_min=a=>readAnyLookupTable$$module$libs$y_webrtc_min[127-
readUint8$$module$libs$y_webrtc_min(a)](a);class RleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a,g){super(a);this.reader=g;this.s=null;this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),hasContent$$module$libs$y_webrtc_min(this)?this.count=readVarUint$$module$libs$y_webrtc_min(this)+1:this.count=-1),this.count--,this.s}}
class UintOptRleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a){super(a);this.count=this.s=0}read(){if(0===this.count){this.s=readVarInt$$module$libs$y_webrtc_min(this);const a=isNegativeZero$$module$libs$y_webrtc_min(this.s);this.count=1;a&&(this.s=-this.s,this.count=readVarUint$$module$libs$y_webrtc_min(this)+2)}return this.count--,this.s}}
class IntDiffOptRleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a){super(a);this.diff=this.count=this.s=0}read(){if(0===this.count){const a=readVarInt$$module$libs$y_webrtc_min(this),g=1&a;this.diff=floor$$module$libs$y_webrtc_min(a/2);this.count=1;g&&(this.count=readVarUint$$module$libs$y_webrtc_min(this)+2)}return this.s+=this.diff,this.count--,this.s}}
class StringDecoder$$module$libs$y_webrtc_min{constructor(a){this.decoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(a);this.str=readVarString$$module$libs$y_webrtc_min(this.decoder);this.spos=0}read(){const a=this.spos+this.decoder.read(),g=this.str.slice(this.spos,a);return this.spos=a,g}}
const createUint8ArrayFromLen$$module$libs$y_webrtc_min=a=>new Uint8Array(a),createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min=(a,g,p)=>new Uint8Array(a,g,p),toBase64$$module$libs$y_webrtc_min=isBrowser$$module$libs$y_webrtc_min?a=>{let g="";for(let p=0;p<a.byteLength;p++)g+=fromCharCode$$module$libs$y_webrtc_min(a[p]);return btoa(g)}:a=>Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString("base64"),fromBase64$$module$libs$y_webrtc_min=isBrowser$$module$libs$y_webrtc_min?a=>{a=atob(a);
const g=createUint8ArrayFromLen$$module$libs$y_webrtc_min(a.length);for(let p=0;p<a.length;p++)g[p]=a.charCodeAt(p);return g}:a=>{a=Buffer.from(a,"base64");return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)};class Encoder$$module$libs$y_webrtc_min{constructor(){this.cpos=0;this.cbuf=new Uint8Array(100);this.bufs=[]}}
const createEncoder$$module$libs$y_webrtc_min=()=>new Encoder$$module$libs$y_webrtc_min,toUint8Array$$module$libs$y_webrtc_min=a=>{var g=Uint8Array,p=a.cpos;for(var t=0;t<a.bufs.length;t++)p+=a.bufs[t].length;g=new g(p);p=0;for(t=0;t<a.bufs.length;t++){const A=a.bufs[t];g.set(A,p);p+=A.length}return g.set(createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.cbuf.buffer,0,a.cpos),p),g},write$$module$libs$y_webrtc_min=(a,g)=>{const p=a.cbuf.length;a.cpos===p&&(a.bufs.push(a.cbuf),a.cbuf=
new Uint8Array(2*p),a.cpos=0);a.cbuf[a.cpos++]=g},writeUint8$$module$libs$y_webrtc_min=write$$module$libs$y_webrtc_min,writeVarUint$$module$libs$y_webrtc_min=(a,g)=>{for(;127<g;)write$$module$libs$y_webrtc_min(a,128|127&g),g=floor$$module$libs$y_webrtc_min(g/128);write$$module$libs$y_webrtc_min(a,127&g)},writeVarInt$$module$libs$y_webrtc_min=(a,g)=>{const p=isNegativeZero$$module$libs$y_webrtc_min(g);p&&(g=-g);write$$module$libs$y_webrtc_min(a,(63<g?128:0)|(p?64:0)|63&g);for(g=floor$$module$libs$y_webrtc_min(g/
64);0<g;)write$$module$libs$y_webrtc_min(a,(127<g?128:0)|127&g),g=floor$$module$libs$y_webrtc_min(g/128)},_strBuffer$$module$libs$y_webrtc_min=new Uint8Array(3E4),_maxStrBSize$$module$libs$y_webrtc_min=_strBuffer$$module$libs$y_webrtc_min.length/3,writeVarString$$module$libs$y_webrtc_min=utf8TextEncoder$$module$libs$y_webrtc_min&&utf8TextEncoder$$module$libs$y_webrtc_min.encodeInto?(a,g)=>{if(g.length<_maxStrBSize$$module$libs$y_webrtc_min){g=utf8TextEncoder$$module$libs$y_webrtc_min.encodeInto(g,
_strBuffer$$module$libs$y_webrtc_min).written||0;writeVarUint$$module$libs$y_webrtc_min(a,g);for(let p=0;p<g;p++)write$$module$libs$y_webrtc_min(a,_strBuffer$$module$libs$y_webrtc_min[p])}else writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeUtf8$$module$libs$y_webrtc_min(g))}:(a,g)=>{g=unescape(encodeURIComponent(g));const p=g.length;writeVarUint$$module$libs$y_webrtc_min(a,p);for(let t=0;t<p;t++)write$$module$libs$y_webrtc_min(a,g.codePointAt(t))},writeUint8Array$$module$libs$y_webrtc_min=(a,
g)=>{const p=a.cbuf.length,t=a.cpos,A=min$$module$libs$y_webrtc_min(p-t,g.length),D=g.length-A;a.cbuf.set(g.subarray(0,A),t);a.cpos+=A;0<D&&(a.bufs.push(a.cbuf),a.cbuf=new Uint8Array(max$$module$libs$y_webrtc_min(2*p,D)),a.cbuf.set(g.subarray(A)),a.cpos=D)},writeVarUint8Array$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a,g.byteLength);writeUint8Array$$module$libs$y_webrtc_min(a,g)},writeOnDataView$$module$libs$y_webrtc_min=(a,g)=>{var p=a.cbuf.length;p-a.cpos<g&&(a.bufs.push(createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.cbuf.buffer,
0,a.cpos)),a.cbuf=new Uint8Array(2*max$$module$libs$y_webrtc_min(p,g)),a.cpos=0);p=new DataView(a.cbuf.buffer,a.cpos,g);return a.cpos+=g,p},floatTestBed$$module$libs$y_webrtc_min=new DataView(new ArrayBuffer(4)),writeAny$$module$libs$y_webrtc_min=(a,g)=>{switch(typeof g){case "string":write$$module$libs$y_webrtc_min(a,119);writeVarString$$module$libs$y_webrtc_min(a,g);break;case "number":isInteger$$module$libs$y_webrtc_min(g)&&2147483647>=abs$$module$libs$y_webrtc_min(g)?(write$$module$libs$y_webrtc_min(a,
125),writeVarInt$$module$libs$y_webrtc_min(a,g)):(p=g,floatTestBed$$module$libs$y_webrtc_min.setFloat32(0,p),floatTestBed$$module$libs$y_webrtc_min.getFloat32(0)===p?(write$$module$libs$y_webrtc_min(a,124),((t,A)=>{writeOnDataView$$module$libs$y_webrtc_min(t,4).setFloat32(0,A,!1)})(a,g)):(write$$module$libs$y_webrtc_min(a,123),((t,A)=>{writeOnDataView$$module$libs$y_webrtc_min(t,8).setFloat64(0,A,!1)})(a,g)));break;case "bigint":write$$module$libs$y_webrtc_min(a,122);((t,A)=>{writeOnDataView$$module$libs$y_webrtc_min(t,
8).setBigInt64(0,A,!1)})(a,g);break;case "object":if(null===g)write$$module$libs$y_webrtc_min(a,126);else if(isArray$$module$libs$y_webrtc_min(g))for(write$$module$libs$y_webrtc_min(a,117),writeVarUint$$module$libs$y_webrtc_min(a,g.length),p=0;p<g.length;p++)writeAny$$module$libs$y_webrtc_min(a,g[p]);else if(g instanceof Uint8Array)write$$module$libs$y_webrtc_min(a,116),writeVarUint8Array$$module$libs$y_webrtc_min(a,g);else{write$$module$libs$y_webrtc_min(a,118);p=Object.keys(g);writeVarUint$$module$libs$y_webrtc_min(a,
p.length);for(let t=0;t<p.length;t++){const A=p[t];writeVarString$$module$libs$y_webrtc_min(a,A);writeAny$$module$libs$y_webrtc_min(a,g[A])}}break;case "boolean":write$$module$libs$y_webrtc_min(a,g?120:121);break;default:write$$module$libs$y_webrtc_min(a,127)}var p};
class RleEncoder$$module$libs$y_webrtc_min extends Encoder$$module$libs$y_webrtc_min{constructor(a){super();this.w=a;this.s=null;this.count=0}write(a){this.s===a?this.count++:(0<this.count&&writeVarUint$$module$libs$y_webrtc_min(this,this.count-1),this.count=1,this.w(this,a),this.s=a)}}const flushUintOptRleEncoder$$module$libs$y_webrtc_min=a=>{0<a.count&&(writeVarInt$$module$libs$y_webrtc_min(a.encoder,1===a.count?a.s:-a.s),1<a.count&&writeVarUint$$module$libs$y_webrtc_min(a.encoder,a.count-2))};
class UintOptRleEncoder$$module$libs$y_webrtc_min{constructor(){this.encoder=new Encoder$$module$libs$y_webrtc_min;this.count=this.s=0}write(a){this.s===a?this.count++:(flushUintOptRleEncoder$$module$libs$y_webrtc_min(this),this.count=1,this.s=a)}toUint8Array(){return flushUintOptRleEncoder$$module$libs$y_webrtc_min(this),toUint8Array$$module$libs$y_webrtc_min(this.encoder)}}
const flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min=a=>{0<a.count&&(writeVarInt$$module$libs$y_webrtc_min(a.encoder,2*a.diff+(1===a.count?0:1)),1<a.count&&writeVarUint$$module$libs$y_webrtc_min(a.encoder,a.count-2))};
class IntDiffOptRleEncoder$$module$libs$y_webrtc_min{constructor(){this.encoder=new Encoder$$module$libs$y_webrtc_min;this.diff=this.count=this.s=0}write(a){this.diff===a-this.s?(this.s=a,this.count++):(flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min(this),this.count=1,this.diff=a-this.s,this.s=a)}toUint8Array(){return flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min(this),toUint8Array$$module$libs$y_webrtc_min(this.encoder)}}
class StringEncoder$$module$libs$y_webrtc_min{constructor(){this.sarr=[];this.s="";this.lensE=new UintOptRleEncoder$$module$libs$y_webrtc_min}write(a){this.s+=a;19<this.s.length&&(this.sarr.push(this.s),this.s="");this.lensE.write(a.length)}toUint8Array(){const a=new Encoder$$module$libs$y_webrtc_min;return this.sarr.push(this.s),this.s="",writeVarString$$module$libs$y_webrtc_min(a,this.sarr.join("")),writeUint8Array$$module$libs$y_webrtc_min(a,this.lensE.toUint8Array()),toUint8Array$$module$libs$y_webrtc_min(a)}}
class Pair$$module$libs$y_webrtc_min{constructor(a,g){this.left=a;this.right=g}}
const create$3$$module$libs$y_webrtc_min=(a,g)=>new Pair$$module$libs$y_webrtc_min(a,g),create$4$$module$libs$y_webrtc_min=("undefined"!=typeof DOMParser&&new DOMParser,Symbol),BOLD$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),UNBOLD$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),BLUE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),GREY$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),GREEN$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),
RED$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),PURPLE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),ORANGE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),UNCOLOR$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),loggingColors$$module$libs$y_webrtc_min=[GREEN$$module$libs$y_webrtc_min,PURPLE$$module$libs$y_webrtc_min,ORANGE$$module$libs$y_webrtc_min,BLUE$$module$libs$y_webrtc_min];
let nextColor$$module$libs$y_webrtc_min=0,lastLoggingTime$$module$libs$y_webrtc_min=getUnixTime$$module$libs$y_webrtc_min();
const _browserStyleMap$$module$libs$y_webrtc_min={[BOLD$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("font-weight","bold"),[UNBOLD$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("font-weight","normal"),[BLUE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","blue"),[GREEN$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","green"),[GREY$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","grey"),[RED$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color",
"red"),[PURPLE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","purple"),[ORANGE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","orange"),[UNCOLOR$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","black")},computeLoggingArgs$$module$libs$y_webrtc_min=supportsColor$$module$libs$y_webrtc_min?a=>{var g=[];const p=[],t=create$$module$libs$y_webrtc_min();let A=[],D=0;for(;D<a.length;D++){const K=a[D];var F=_browserStyleMap$$module$libs$y_webrtc_min[K];
if(void 0!==F)t.set(F.left,F.right);else{if(K.constructor!==String&&K.constructor!==Number)break;F=((H,J)=>{const I=[];for(const [N,T]of H)I.push(J(T,N));return I})(t,(H,J)=>`${J}:${H};`).join("");0<D||0<F.length?(g.push("%c"+K),p.push(F)):g.push(K)}}for(0<D&&(A=p,A.unshift(g.join("")));D<a.length;D++)g=a[D],g instanceof Symbol||A.push(g);return A}:a=>{const g=[];let p=0;for(;p<a.length;p++){const t=a[p];t.constructor===String||t.constructor===Number||t.constructor===Object&&g.push(JSON.stringify(t))}return g},
print$$module$libs$y_webrtc_min=(...a)=>{console.log(...computeLoggingArgs$$module$libs$y_webrtc_min(a));vconsoles$$module$libs$y_webrtc_min.forEach(g=>g.print(a))},vconsoles$$module$libs$y_webrtc_min=create$1$$module$libs$y_webrtc_min(),create$5$$module$libs$y_webrtc_min=a=>new Promise(a),resolve$$module$libs$y_webrtc_min=a=>Promise.resolve(a),channels$$module$libs$y_webrtc_min=new Map,BC$$module$libs$y_webrtc_min="undefined"==typeof BroadcastChannel?class{constructor(a){this.room=a;this.onmessage=
null;var g=this._onChange=p=>p.key===a&&null!==this.onmessage&&this.onmessage({data:fromBase64$$module$libs$y_webrtc_min(p.newValue||"")});usePolyfill$$module$libs$y_webrtc_min||addEventListener("storage",g)}postMessage(a){varStorage$$module$libs$y_webrtc_min.setItem(this.room,toBase64$$module$libs$y_webrtc_min(new Uint8Array(a)))}close(){var a=this._onChange;usePolyfill$$module$libs$y_webrtc_min||removeEventListener("storage",a)}}:BroadcastChannel,getChannel$$module$libs$y_webrtc_min=a=>setIfUndefined$$module$libs$y_webrtc_min(channels$$module$libs$y_webrtc_min,
a,()=>{const g=create$1$$module$libs$y_webrtc_min(),p=new BC$$module$libs$y_webrtc_min(a);return p.onmessage=t=>g.forEach(A=>A(t.data,"broadcastchannel")),{bc:p,subs:g}}),createIterator$$module$libs$y_webrtc_min=a=>({[Symbol.iterator](){return this},next:a}),iteratorMap$$module$libs$y_webrtc_min=(a,g)=>createIterator$$module$libs$y_webrtc_min(()=>{const {done:p,value:t}=a.next();return{done:p,value:p?void 0:g(t)}});
class AbstractConnector$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,g){super();this.doc=a;this.awareness=g}}class DeleteItem$$module$libs$y_webrtc_min{constructor(a,g){this.clock=a;this.len=g}}class DeleteSet$$module$libs$y_webrtc_min{constructor(){this.clients=new Map}}
const iterateDeletedStructs$$module$libs$y_webrtc_min=(a,g,p)=>g.clients.forEach((t,A)=>{A=a.doc.store.clients.get(A);for(let D=0;D<t.length;D++){const F=t[D];iterateStructs$$module$libs$y_webrtc_min(a,A,F.clock,F.len,p)}}),isDeleted$$module$libs$y_webrtc_min=(a,g)=>{a=a.clients.get(g.client);var p;if(p=void 0!==a){a:{g=g.clock;p=0;let t=a.length-1;for(;p<=t;){const A=floor$$module$libs$y_webrtc_min((p+t)/2),D=a[A],F=D.clock;if(F<=g){if(g<F+D.len){a=A;break a}p=A+1}else t=A-1}a=null}p=null!==a}return p},
sortAndMergeDeleteSet$$module$libs$y_webrtc_min=a=>{a.clients.forEach(g=>{let p,t;g.sort((A,D)=>A.clock-D.clock);for(t=p=1;p<g.length;p++){const A=g[t-1],D=g[p];A.clock+A.len>=D.clock?A.len=max$$module$libs$y_webrtc_min(A.len,D.clock+D.len-A.clock):(t<p&&(g[t]=D),t++)}g.length=t})},mergeDeleteSets$$module$libs$y_webrtc_min=a=>{const g=new DeleteSet$$module$libs$y_webrtc_min;for(let p=0;p<a.length;p++)a[p].clients.forEach((t,A)=>{if(!g.clients.has(A)){t=t.slice();for(let D=p+1;D<a.length;D++)appendTo$$module$libs$y_webrtc_min(t,
a[D].clients.get(A)||[]);g.clients.set(A,t)}});return sortAndMergeDeleteSet$$module$libs$y_webrtc_min(g),g},addToDeleteSet$$module$libs$y_webrtc_min=(a,g,p,t)=>{setIfUndefined$$module$libs$y_webrtc_min(a.clients,g,()=>[]).push(new DeleteItem$$module$libs$y_webrtc_min(p,t))},createDeleteSet$$module$libs$y_webrtc_min=()=>new DeleteSet$$module$libs$y_webrtc_min,createDeleteSetFromStructStore$$module$libs$y_webrtc_min=a=>{const g=createDeleteSet$$module$libs$y_webrtc_min();return a.clients.forEach((p,
t)=>{const A=[];for(let F=0;F<p.length;F++){var D=p[F];if(D.deleted){const K=D.id.clock;D=D.length;if(F+1<p.length)for(let H=p[F+1];F+1<p.length&&H.deleted;H=p[1+ ++F])D+=H.length;A.push(new DeleteItem$$module$libs$y_webrtc_min(K,D))}}0<A.length&&g.clients.set(t,A)}),g},writeDeleteSet$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,g.clients.size);from$$module$libs$y_webrtc_min(g.clients.entries()).sort((p,t)=>t[0]-p[0]).forEach(([p,t])=>{a.resetDsCurVal();writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,
p);p=t.length;writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,p);for(let A=0;A<p;A++){const D=t[A];a.writeDsClock(D.clock);a.writeDsLen(D.len)}})},readDeleteSet$$module$libs$y_webrtc_min=a=>{const g=new DeleteSet$$module$libs$y_webrtc_min,p=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let A=0;A<p;A++){a.resetDsCurVal();var t=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);const D=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);if(0<D){t=setIfUndefined$$module$libs$y_webrtc_min(g.clients,
t,()=>[]);for(let F=0;F<D;F++)t.push(new DeleteItem$$module$libs$y_webrtc_min(a.readDsClock(),a.readDsLen()))}}return g},readAndApplyDeleteSet$$module$libs$y_webrtc_min=(a,g,p)=>{const t=new DeleteSet$$module$libs$y_webrtc_min,A=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let D=0;D<A;D++){a.resetDsCurVal();const F=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),K=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),H=p.clients.get(F)||[],J=getState$$module$libs$y_webrtc_min(p,F);
for(let I=0;I<K;I++){const N=a.readDsClock(),T=N+a.readDsLen();if(N<J){J<T&&addToDeleteSet$$module$libs$y_webrtc_min(t,F,J,T-J);let O=findIndexSS$$module$libs$y_webrtc_min(H,N),W=H[O];for(!W.deleted&&W.id.clock<N&&(H.splice(O+1,0,splitItem$$module$libs$y_webrtc_min(g,W,N-W.id.clock)),O++);O<H.length&&(W=H[O++],W.id.clock<T);)W.deleted||(T<W.id.clock+W.length&&H.splice(O,0,splitItem$$module$libs$y_webrtc_min(g,W,T-W.id.clock)),W.delete(g))}else addToDeleteSet$$module$libs$y_webrtc_min(t,F,N,T-N)}}return 0<
t.clients.size?(a=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,0),writeDeleteSet$$module$libs$y_webrtc_min(a,t),a.toUint8Array()):null},generateNewClientId$$module$libs$y_webrtc_min=uint32$$module$libs$y_webrtc_min;
class Doc$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor({guid:a=uuidv4$$module$libs$y_webrtc_min(),collectionid:g=null,gc:p=!0,gcFilter:t=()=>!0,meta:A=null,autoLoad:D=!1,shouldLoad:F=!0}={}){super();this.gc=p;this.gcFilter=t;this.clientID=uint32$$module$libs$y_webrtc_min();this.guid=a;this.collectionid=g;this.share=new Map;this.store=new StructStore$$module$libs$y_webrtc_min;this._transaction=null;this._transactionCleanups=[];this.subdocs=new Set;this._item=null;
this.shouldLoad=F;this.autoLoad=D;this.meta=A;this.isSynced=this.isLoaded=!1;this.whenLoaded=create$5$$module$libs$y_webrtc_min(H=>{this.on("load",()=>{this.isLoaded=!0;H(this)})});const K=()=>create$5$$module$libs$y_webrtc_min(H=>{const J=I=>{void 0!==I&&!0!==I||(this.off("sync",J),H())};this.on("sync",J)});this.on("sync",H=>{!1===H&&this.isSynced&&(this.whenSynced=K());this.isSynced=void 0===H||!0===H;this.isLoaded||this.emit("load",[])});this.whenSynced=K()}load(){const a=this._item;null===a||
this.shouldLoad||transact$$module$libs$y_webrtc_min(a.parent.doc,g=>{g.subdocsLoaded.add(this)},null,!0);this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(from$$module$libs$y_webrtc_min(this.subdocs).map(a=>a.guid))}transact(a,g=null){return transact$$module$libs$y_webrtc_min(this,a,g)}get(a,g=AbstractType$$module$libs$y_webrtc_min){const p=setIfUndefined$$module$libs$y_webrtc_min(this.share,a,()=>{const A=new g;return A._integrate(this,null),A});var t=p.constructor;
if(g!==AbstractType$$module$libs$y_webrtc_min&&t!==g){if(t===AbstractType$$module$libs$y_webrtc_min){const A=new g;A._map=p._map;p._map.forEach(D=>{for(;null!==D;D=D.left)D.parent=A});A._start=p._start;for(t=A._start;null!==t;t=t.right)t.parent=A;return A._length=p._length,this.share.set(a,A),A._integrate(this,null),A}throw Error(`Type with the name ${a} has already been defined with a different constructor`);}return p}getArray(a=""){return this.get(a,YArray$$module$libs$y_webrtc_min)}getText(a=""){return this.get(a,
YText$$module$libs$y_webrtc_min)}getMap(a=""){return this.get(a,YMap$$module$libs$y_webrtc_min)}getXmlFragment(a=""){return this.get(a,YXmlFragment$$module$libs$y_webrtc_min)}toJSON(){const a={};return this.share.forEach((g,p)=>{a[p]=g.toJSON()}),a}destroy(){from$$module$libs$y_webrtc_min(this.subdocs).forEach(g=>g.destroy());const a=this._item;if(null!==a){this._item=null;const g=a.content;g.doc=new Doc$$module$libs$y_webrtc_min({guid:this.guid,...g.opts,shouldLoad:!1});g.doc._item=a;transact$$module$libs$y_webrtc_min(a.parent.doc,
p=>{const t=g.doc;a.deleted||p.subdocsAdded.add(t);p.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]);this.emit("destroy",[this]);super.destroy()}on(a,g){super.on(a,g)}off(a,g){super.off(a,g)}}class DSDecoderV1$$module$libs$y_webrtc_min{constructor(a){this.restDecoder=a}resetDsCurVal(){}readDsClock(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readDsLen(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}}
class UpdateDecoderV1$$module$libs$y_webrtc_min extends DSDecoderV1$$module$libs$y_webrtc_min{readLeftID(){return createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(this.restDecoder),readVarUint$$module$libs$y_webrtc_min(this.restDecoder))}readRightID(){return createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(this.restDecoder),readVarUint$$module$libs$y_webrtc_min(this.restDecoder))}readClient(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readInfo(){return readUint8$$module$libs$y_webrtc_min(this.restDecoder)}readString(){return readVarString$$module$libs$y_webrtc_min(this.restDecoder)}readParentInfo(){return 1===
readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readTypeRef(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readLen(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readAny(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readBuf(){var a=readVarUint8Array$$module$libs$y_webrtc_min(this.restDecoder);const g=createUint8ArrayFromLen$$module$libs$y_webrtc_min(a.byteLength);return g.set(a),g}readJSON(){return JSON.parse(readVarString$$module$libs$y_webrtc_min(this.restDecoder))}readKey(){return readVarString$$module$libs$y_webrtc_min(this.restDecoder)}}
class DSDecoderV2$$module$libs$y_webrtc_min{constructor(a){this.dsCurrVal=0;this.restDecoder=a}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=readVarUint$$module$libs$y_webrtc_min(this.restDecoder),this.dsCurrVal}readDsLen(){const a=readVarUint$$module$libs$y_webrtc_min(this.restDecoder)+1;return this.dsCurrVal+=a,a}}
class UpdateDecoderV2$$module$libs$y_webrtc_min extends DSDecoderV2$$module$libs$y_webrtc_min{constructor(a){super(a);this.keys=[];readVarUint$$module$libs$y_webrtc_min(a);this.keyClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.clientDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.leftClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));
this.rightClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.infoDecoder=new RleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a),readUint8$$module$libs$y_webrtc_min);this.stringDecoder=new StringDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.parentInfoDecoder=new RleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a),readUint8$$module$libs$y_webrtc_min);
this.typeRefDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.lenDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a))}readLeftID(){return new ID$$module$libs$y_webrtc_min(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ID$$module$libs$y_webrtc_min(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===
this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readBuf(){return readVarUint8Array$$module$libs$y_webrtc_min(this.restDecoder)}readJSON(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readKey(){var a=this.keyClockDecoder.read();if(a<this.keys.length)return this.keys[a];a=this.stringDecoder.read();return this.keys.push(a),a}}
class DSEncoderV1$$module$libs$y_webrtc_min{constructor(){this.restEncoder=createEncoder$$module$libs$y_webrtc_min()}toUint8Array(){return toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)}resetDsCurVal(){}writeDsClock(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeDsLen(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}}
class UpdateEncoderV1$$module$libs$y_webrtc_min extends DSEncoderV1$$module$libs$y_webrtc_min{writeLeftID(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.client);writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.clock)}writeRightID(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.client);writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.clock)}writeClient(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeInfo(a){write$$module$libs$y_webrtc_min(this.restEncoder,
a)}writeString(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,a)}writeParentInfo(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a?1:0)}writeTypeRef(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeLen(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeAny(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeBuf(a){writeVarUint8Array$$module$libs$y_webrtc_min(this.restEncoder,a)}writeJSON(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,
JSON.stringify(a))}writeKey(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,a)}}
class DSEncoderV2$$module$libs$y_webrtc_min{constructor(){this.restEncoder=createEncoder$$module$libs$y_webrtc_min();this.dsCurrVal=0}toUint8Array(){return toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(a){const g=a-this.dsCurrVal;this.dsCurrVal=a;writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,g)}writeDsLen(a){0===a&&unexpectedCase$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a-1);this.dsCurrVal+=
a}}
class UpdateEncoderV2$$module$libs$y_webrtc_min extends DSEncoderV2$$module$libs$y_webrtc_min{constructor(){super();this.keyMap=new Map;this.keyClock=0;this.keyClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.clientEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min;this.leftClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.rightClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.infoEncoder=new RleEncoder$$module$libs$y_webrtc_min(write$$module$libs$y_webrtc_min);this.stringEncoder=
new StringEncoder$$module$libs$y_webrtc_min;this.parentInfoEncoder=new RleEncoder$$module$libs$y_webrtc_min(write$$module$libs$y_webrtc_min);this.typeRefEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min;this.lenEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min}toUint8Array(){const a=createEncoder$$module$libs$y_webrtc_min();return writeVarUint$$module$libs$y_webrtc_min(a,0),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.keyClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,
this.clientEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.leftClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.rightClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.infoEncoder)),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.stringEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.parentInfoEncoder)),
writeVarUint8Array$$module$libs$y_webrtc_min(a,this.typeRefEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.lenEncoder.toUint8Array()),writeUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)),toUint8Array$$module$libs$y_webrtc_min(a)}writeLeftID(a){this.clientEncoder.write(a.client);this.leftClockEncoder.write(a.clock)}writeRightID(a){this.clientEncoder.write(a.client);this.rightClockEncoder.write(a.clock)}writeClient(a){this.clientEncoder.write(a)}writeInfo(a){this.infoEncoder.write(a)}writeString(a){this.stringEncoder.write(a)}writeParentInfo(a){this.parentInfoEncoder.write(a?
1:0)}writeTypeRef(a){this.typeRefEncoder.write(a)}writeLen(a){this.lenEncoder.write(a)}writeAny(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeBuf(a){writeVarUint8Array$$module$libs$y_webrtc_min(this.restEncoder,a)}writeJSON(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeKey(a){const g=this.keyMap.get(a);void 0===g?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(a)):this.keyClockEncoder.write(g)}}
const writeClientsStructs$$module$libs$y_webrtc_min=(a,g,p)=>{const t=new Map;p.forEach((A,D)=>{getState$$module$libs$y_webrtc_min(g,D)>A&&t.set(D,A)});getStateVector$$module$libs$y_webrtc_min(g).forEach((A,D)=>{p.has(D)||t.set(D,0)});writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,t.size);from$$module$libs$y_webrtc_min(t.entries()).sort((A,D)=>D[0]-A[0]).forEach(([A,D])=>{var F=g.clients.get(A);D=max$$module$libs$y_webrtc_min(D,F[0].id.clock);const K=findIndexSS$$module$libs$y_webrtc_min(F,
D);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,F.length-K);a.writeClient(A);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,D);A=F[K];A.write(a,D-A.id.clock);for(A=K+1;A<F.length;A++)F[A].write(a,0)})},readUpdateV2$$module$libs$y_webrtc_min=(a,g,p,t=new UpdateDecoderV2$$module$libs$y_webrtc_min(a))=>transact$$module$libs$y_webrtc_min(g,A=>{var D=A.local=!1,F=A.doc;const K=F.store;F=((J,I,N)=>{const T=[];let O=from$$module$libs$y_webrtc_min(N.keys()).sort((la,ta)=>la-ta);if(0===O.length)return null;
const W=()=>{if(0===O.length)return null;let la=N.get(O[O.length-1]);for(;la.refs.length===la.i;){if(O.pop(),!(0<O.length))return null;la=N.get(O[O.length-1])}return la};let ba=W();if(null===ba&&0===T.length)return null;const fa=new StructStore$$module$libs$y_webrtc_min,R=new Map,da=(la,ta)=>{const wa=R.get(la);(null==wa||wa>ta)&&R.set(la,ta)};let ha=ba.refs[ba.i++];const ma=new Map,ka=()=>{for(const la of T){const ta=la.id.client,wa=N.get(ta);wa?(wa.i--,fa.clients.set(ta,wa.refs.slice(wa.i)),N.delete(ta),
wa.i=0,wa.refs=[]):fa.clients.set(ta,[la]);O=O.filter(za=>za!==ta)}T.length=0};for(;;){if(ha.constructor!==Skip$$module$libs$y_webrtc_min){var pa=setIfUndefined$$module$libs$y_webrtc_min(ma,ha.id.client,()=>getState$$module$libs$y_webrtc_min(I,ha.id.client))-ha.id.clock;if(0>pa)T.push(ha),da(ha.id.client,ha.id.clock-1),ka();else{const la=ha.getMissing(J,I);if(null!==la){T.push(ha);pa=N.get(la)||{refs:[],i:0};if(pa.refs.length!==pa.i){ha=pa.refs[pa.i++];continue}da(la,getState$$module$libs$y_webrtc_min(I,
la));ka()}else(0===pa||pa<ha.length)&&(ha.integrate(J,pa),ma.set(ha.id.client,ha.id.clock+ha.length))}}if(0<T.length)ha=T.pop();else{if(!(null!==ba&&ba.i<ba.refs.length)&&(ba=W(),null===ba))break;ha=ba.refs[ba.i++]}}return 0<fa.clients.size?(J=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeClientsStructs$$module$libs$y_webrtc_min(J,fa,new Map),writeVarUint$$module$libs$y_webrtc_min(J.restEncoder,0),{missing:R,update:J.toUint8Array()}):null})(A,K,((J,I)=>{const N=create$$module$libs$y_webrtc_min(),
T=readVarUint$$module$libs$y_webrtc_min(J.restDecoder);for(let W=0;W<T;W++){const ba=readVarUint$$module$libs$y_webrtc_min(J.restDecoder),fa=Array(ba),R=J.readClient();let da=readVarUint$$module$libs$y_webrtc_min(J.restDecoder);N.set(R,{i:0,refs:fa});for(let ha=0;ha<ba;ha++){var O=J.readInfo();switch(31&O){case 0:O=J.readLen();fa[ha]=new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(R,da),O);da+=O;break;case 10:O=readVarUint$$module$libs$y_webrtc_min(J.restDecoder);fa[ha]=new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(R,
da),O);da+=O;break;default:const ma=0==(192&O);O=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(R,da),null,128==(128&O)?J.readLeftID():null,null,64==(64&O)?J.readRightID():null,ma?J.readParentInfo()?I.get(J.readString()):J.readLeftID():null,ma&&32==(32&O)?J.readString():null,readItemContent$$module$libs$y_webrtc_min(J,O));fa[ha]=O;da+=O.length}}}return N})(t,F));var H=K.pendingStructs;if(H){for(const [J,I]of H.missing)if(I<getState$$module$libs$y_webrtc_min(K,J)){D=!0;break}if(F){for(const [J,
I]of F.missing){const N=H.missing.get(J);(null==N||N>I)&&H.missing.set(J,I)}H.update=mergeUpdatesV2$$module$libs$y_webrtc_min([H.update,F.update])}}else K.pendingStructs=F;F=readAndApplyDeleteSet$$module$libs$y_webrtc_min(t,A,K);K.pendingDs?(H=new UpdateDecoderV2$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(K.pendingDs)),readVarUint$$module$libs$y_webrtc_min(H.restDecoder),H=readAndApplyDeleteSet$$module$libs$y_webrtc_min(H,A,K),K.pendingDs=F&&H?mergeUpdatesV2$$module$libs$y_webrtc_min([F,
H]):F||H):K.pendingDs=F;D&&(D=K.pendingStructs.update,K.pendingStructs=null,applyUpdateV2$$module$libs$y_webrtc_min(A.doc,D))},p,!1),readUpdate$$module$libs$y_webrtc_min=(a,g,p)=>readUpdateV2$$module$libs$y_webrtc_min(a,g,p,new UpdateDecoderV1$$module$libs$y_webrtc_min(a)),applyUpdateV2$$module$libs$y_webrtc_min=(a,g,p,t=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{g=createDecoder$$module$libs$y_webrtc_min(g);readUpdateV2$$module$libs$y_webrtc_min(g,a,p,new t(g))},applyUpdate$$module$libs$y_webrtc_min=
(a,g,p)=>applyUpdateV2$$module$libs$y_webrtc_min(a,g,p,UpdateDecoderV1$$module$libs$y_webrtc_min),encodeStateAsUpdateV2$$module$libs$y_webrtc_min=(a,g=new Uint8Array([0]),p=new UpdateEncoderV2$$module$libs$y_webrtc_min)=>{((A,D,F=new Map)=>{writeClientsStructs$$module$libs$y_webrtc_min(A,D.store,F);writeDeleteSet$$module$libs$y_webrtc_min(A,createDeleteSetFromStructStore$$module$libs$y_webrtc_min(D.store))})(p,a,decodeStateVector$$module$libs$y_webrtc_min(g));const t=[p.toUint8Array()];if(a.store.pendingDs&&
t.push(a.store.pendingDs),a.store.pendingStructs&&t.push(diffUpdateV2$$module$libs$y_webrtc_min(a.store.pendingStructs.update,g)),1<t.length){if(p.constructor===UpdateEncoderV1$$module$libs$y_webrtc_min)return mergeUpdates$$module$libs$y_webrtc_min(t.map((A,D)=>0===D?A:convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min(A)));if(p.constructor===UpdateEncoderV2$$module$libs$y_webrtc_min)return mergeUpdatesV2$$module$libs$y_webrtc_min(t)}return t[0]},encodeStateAsUpdate$$module$libs$y_webrtc_min=(a,
g)=>encodeStateAsUpdateV2$$module$libs$y_webrtc_min(a,g,new UpdateEncoderV1$$module$libs$y_webrtc_min),readStateVector$$module$libs$y_webrtc_min=a=>{const g=new Map,p=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let t=0;t<p;t++){const A=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),D=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);g.set(A,D)}return g},decodeStateVector$$module$libs$y_webrtc_min=a=>readStateVector$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a))),
writeStateVector$$module$libs$y_webrtc_min=(a,g)=>(writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,g.size),from$$module$libs$y_webrtc_min(g.entries()).sort((p,t)=>t[0]-p[0]).forEach(([p,t])=>{writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,p);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,t)}),a),encodeStateVectorV2$$module$libs$y_webrtc_min=(a,g=new DSEncoderV2$$module$libs$y_webrtc_min)=>{a instanceof Map?writeStateVector$$module$libs$y_webrtc_min(g,a):writeStateVector$$module$libs$y_webrtc_min(g,
getStateVector$$module$libs$y_webrtc_min(a.store));return g.toUint8Array()},encodeStateVector$$module$libs$y_webrtc_min=a=>encodeStateVectorV2$$module$libs$y_webrtc_min(a,new DSEncoderV1$$module$libs$y_webrtc_min);class EventHandler$$module$libs$y_webrtc_min{constructor(){this.l=[]}}
const createEventHandler$$module$libs$y_webrtc_min=()=>new EventHandler$$module$libs$y_webrtc_min,addEventHandlerListener$$module$libs$y_webrtc_min=(a,g)=>a.l.push(g),removeEventHandlerListener$$module$libs$y_webrtc_min=(a,g)=>{const p=a.l,t=p.length;a.l=p.filter(A=>g!==A);t===a.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},callEventHandlerListeners$$module$libs$y_webrtc_min=(a,g,p)=>callAll$$module$libs$y_webrtc_min(a.l,[g,p]);
class ID$$module$libs$y_webrtc_min{constructor(a,g){this.client=a;this.clock=g}}
const compareIDs$$module$libs$y_webrtc_min=(a,g)=>a===g||null!==a&&null!==g&&a.client===g.client&&a.clock===g.clock,createID$$module$libs$y_webrtc_min=(a,g)=>new ID$$module$libs$y_webrtc_min(a,g),writeID$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a,g.client);writeVarUint$$module$libs$y_webrtc_min(a,g.clock)},readID$$module$libs$y_webrtc_min=a=>createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(a),readVarUint$$module$libs$y_webrtc_min(a)),findRootTypeKey$$module$libs$y_webrtc_min=
a=>{for(const [g,p]of a.doc.share.entries())if(p===a)return g;throw unexpectedCase$$module$libs$y_webrtc_min();},isParentOf$$module$libs$y_webrtc_min=(a,g)=>{for(;null!==g;){if(g.parent===a)return!0;g=g.parent._item}return!1},logType$$module$libs$y_webrtc_min=a=>{const g=[];for(a=a._start;a;)g.push(a),a=a.right;console.log("Children: ",g);console.log("Children content: ",g.filter(p=>!p.deleted).map(p=>p.content))};
class PermanentUserData$$module$libs$y_webrtc_min{constructor(a,g=a.getMap("users")){const p=new Map;this.yusers=g;this.doc=a;this.clients=new Map;this.dss=p;const t=(A,D)=>{const F=A.get("ds");A=A.get("ids");const K=H=>this.clients.set(H,D);F.observe(H=>{H.changes.added.forEach(J=>{J.content.getContent().forEach(I=>{I instanceof Uint8Array&&this.dss.set(D,mergeDeleteSets$$module$libs$y_webrtc_min([this.dss.get(D)||createDeleteSet$$module$libs$y_webrtc_min(),readDeleteSet$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(I)))]))})})});
this.dss.set(D,mergeDeleteSets$$module$libs$y_webrtc_min(F.map(H=>readDeleteSet$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(H))))));A.observe(H=>H.changes.added.forEach(J=>J.content.getContent().forEach(K)));A.forEach(K)};g.observe(A=>{A.keysChanged.forEach(D=>t(g.get(D),D))});g.forEach(t)}setUserMapping(a,g,p,{filter:t=()=>!0}={}){const A=this.yusers;let D=A.get(p);D||(D=new YMap$$module$libs$y_webrtc_min,D.set("ids",new YArray$$module$libs$y_webrtc_min),
D.set("ds",new YArray$$module$libs$y_webrtc_min),A.set(p,D));D.get("ids").push([g]);A.observe(F=>{setTimeout(()=>{var K=A.get(p);if(K!==D){D=K;this.clients.forEach((J,I)=>{p===J&&D.get("ids").push([I])});K=new DSEncoderV1$$module$libs$y_webrtc_min;const H=this.dss.get(p);H&&(writeDeleteSet$$module$libs$y_webrtc_min(K,H),D.get("ds").push([K.toUint8Array()]))}},0)});a.on("afterTransaction",F=>{setTimeout(()=>{const K=D.get("ds"),H=F.deleteSet;if(F.local&&0<H.clients.size&&t(F,H)){const J=new DSEncoderV1$$module$libs$y_webrtc_min;
writeDeleteSet$$module$libs$y_webrtc_min(J,H);K.push([J.toUint8Array()])}})})}getUserByClientId(a){return this.clients.get(a)||null}getUserByDeletedId(a){for(const [g,p]of this.dss.entries())if(isDeleted$$module$libs$y_webrtc_min(p,a))return g;return null}}class RelativePosition$$module$libs$y_webrtc_min{constructor(a,g,p,t=0){this.type=a;this.tname=g;this.item=p;this.assoc=t}}
const relativePositionToJSON$$module$libs$y_webrtc_min=a=>{const g={};return a.type&&(g.type=a.type),a.tname&&(g.tname=a.tname),a.item&&(g.item=a.item),null!=a.assoc&&(g.assoc=a.assoc),g},createRelativePositionFromJSON$$module$libs$y_webrtc_min=a=>new RelativePosition$$module$libs$y_webrtc_min(null==a.type?null:createID$$module$libs$y_webrtc_min(a.type.client,a.type.clock),a.tname||null,null==a.item?null:createID$$module$libs$y_webrtc_min(a.item.client,a.item.clock),null==a.assoc?0:a.assoc);
class AbsolutePosition$$module$libs$y_webrtc_min{constructor(a,g,p=0){this.type=a;this.index=g;this.assoc=p}}
const createRelativePosition$$module$libs$y_webrtc_min=(a,g,p)=>{let t=null,A=null;return null===a._item?A=findRootTypeKey$$module$libs$y_webrtc_min(a):t=createID$$module$libs$y_webrtc_min(a._item.id.client,a._item.id.clock),new RelativePosition$$module$libs$y_webrtc_min(t,A,g,p)},createRelativePositionFromTypeIndex$$module$libs$y_webrtc_min=(a,g,p=0)=>{let t=a._start;if(0>p){if(0===g)return createRelativePosition$$module$libs$y_webrtc_min(a,null,p);g--}for(;null!==t;){if(!t.deleted&&t.countable){if(t.length>
g)return createRelativePosition$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(t.id.client,t.id.clock+g),p);g-=t.length}if(null===t.right&&0>p)return createRelativePosition$$module$libs$y_webrtc_min(a,t.lastId,p);t=t.right}return createRelativePosition$$module$libs$y_webrtc_min(a,null,p)},encodeRelativePosition$$module$libs$y_webrtc_min=a=>{const g=createEncoder$$module$libs$y_webrtc_min(),{type:p,tname:t,item:A,assoc:D}=a;if(null!==A)writeVarUint$$module$libs$y_webrtc_min(g,0),writeID$$module$libs$y_webrtc_min(g,
A);else if(null!==t)write$$module$libs$y_webrtc_min(g,1),writeVarString$$module$libs$y_webrtc_min(g,t);else{if(null===p)throw unexpectedCase$$module$libs$y_webrtc_min();write$$module$libs$y_webrtc_min(g,2);writeID$$module$libs$y_webrtc_min(g,p)}writeVarInt$$module$libs$y_webrtc_min(g,D);return toUint8Array$$module$libs$y_webrtc_min(g)},decodeRelativePosition$$module$libs$y_webrtc_min=a=>{var g=createDecoder$$module$libs$y_webrtc_min(a);let p=a=null,t=null;switch(readVarUint$$module$libs$y_webrtc_min(g)){case 0:t=
readID$$module$libs$y_webrtc_min(g);break;case 1:p=readVarString$$module$libs$y_webrtc_min(g);break;case 2:a=readID$$module$libs$y_webrtc_min(g)}g=hasContent$$module$libs$y_webrtc_min(g)?readVarInt$$module$libs$y_webrtc_min(g):0;return new RelativePosition$$module$libs$y_webrtc_min(a,p,t,g)},createAbsolutePositionFromRelativePosition$$module$libs$y_webrtc_min=(a,g)=>{var p=g.store;const t=a.item,A=a.type,D=a.tname;var F=a.assoc,K=null;let H=0;if(null!==t){if(getState$$module$libs$y_webrtc_min(p,t.client)<=
t.clock)return null;g=followRedone$$module$libs$y_webrtc_min(p,t);p=g.item;if(!(p instanceof Item$$module$libs$y_webrtc_min))return null;if(K=p.parent,null===K._item||!K._item.deleted)for(H=p.deleted||!p.countable?0:g.diff+(0<=F?0:1),F=p.left;null!==F;)!F.deleted&&F.countable&&(H+=F.length),F=F.left}else{if(null!==D)K=g.get(D);else{if(null===A)throw unexpectedCase$$module$libs$y_webrtc_min();if(getState$$module$libs$y_webrtc_min(p,A.client)<=A.clock)return null;({item:K}=followRedone$$module$libs$y_webrtc_min(p,
A));if(!(K instanceof Item$$module$libs$y_webrtc_min&&K.content instanceof ContentType$$module$libs$y_webrtc_min))return null;K=K.content.type}H=0<=F?K._length:0}return((J,I,N=0)=>new AbsolutePosition$$module$libs$y_webrtc_min(J,I,N))(K,H,a.assoc)},compareRelativePositions$$module$libs$y_webrtc_min=(a,g)=>a===g||null!==a&&null!==g&&a.tname===g.tname&&compareIDs$$module$libs$y_webrtc_min(a.item,g.item)&&compareIDs$$module$libs$y_webrtc_min(a.type,g.type)&&a.assoc===g.assoc;
class Snapshot$$module$libs$y_webrtc_min{constructor(a,g){this.ds=a;this.sv=g}}
const equalSnapshots$$module$libs$y_webrtc_min=(a,g)=>{var p=a.ds.clients;const t=g.ds.clients;a=a.sv;g=g.sv;if(a.size!==g.size||p.size!==t.size)return!1;for(const [A,D]of a.entries())if(g.get(A)!==D)return!1;for(const [A,D]of p.entries()){p=t.get(A)||[];if(D.length!==p.length)return!1;for(g=0;g<D.length;g++){a=D[g];const F=p[g];if(a.clock!==F.clock||a.len!==F.len)return!1}}return!0},encodeSnapshotV2$$module$libs$y_webrtc_min=(a,g=new DSEncoderV2$$module$libs$y_webrtc_min)=>(writeDeleteSet$$module$libs$y_webrtc_min(g,
a.ds),writeStateVector$$module$libs$y_webrtc_min(g,a.sv),g.toUint8Array()),encodeSnapshot$$module$libs$y_webrtc_min=a=>encodeSnapshotV2$$module$libs$y_webrtc_min(a,new DSEncoderV1$$module$libs$y_webrtc_min),decodeSnapshotV2$$module$libs$y_webrtc_min=(a,g=new DSDecoderV2$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a)))=>new Snapshot$$module$libs$y_webrtc_min(readDeleteSet$$module$libs$y_webrtc_min(g),readStateVector$$module$libs$y_webrtc_min(g)),decodeSnapshot$$module$libs$y_webrtc_min=
a=>decodeSnapshotV2$$module$libs$y_webrtc_min(a,new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a))),createSnapshot$$module$libs$y_webrtc_min=(a,g)=>new Snapshot$$module$libs$y_webrtc_min(a,g),emptySnapshot$$module$libs$y_webrtc_min=createSnapshot$$module$libs$y_webrtc_min(createDeleteSet$$module$libs$y_webrtc_min(),new Map),snapshot$$module$libs$y_webrtc_min=a=>createSnapshot$$module$libs$y_webrtc_min(createDeleteSetFromStructStore$$module$libs$y_webrtc_min(a.store),
getStateVector$$module$libs$y_webrtc_min(a.store)),isVisible$$module$libs$y_webrtc_min=(a,g)=>void 0===g?!a.deleted:g.sv.has(a.id.client)&&(g.sv.get(a.id.client)||0)>a.id.clock&&!isDeleted$$module$libs$y_webrtc_min(g.ds,a.id),splitSnapshotAffectedStructs$$module$libs$y_webrtc_min=(a,g)=>{const p=setIfUndefined$$module$libs$y_webrtc_min(a.meta,splitSnapshotAffectedStructs$$module$libs$y_webrtc_min,create$1$$module$libs$y_webrtc_min),t=a.doc.store;p.has(g)||(g.sv.forEach((A,D)=>{A<getState$$module$libs$y_webrtc_min(t,
D)&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(D,A))}),iterateDeletedStructs$$module$libs$y_webrtc_min(a,g.ds,A=>{}),p.add(g))},createDocFromSnapshot$$module$libs$y_webrtc_min=(a,g,p=new Doc$$module$libs$y_webrtc_min)=>{if(a.gc)throw Error("Garbage-collection must be disabled in `originDoc`!");const {sv:t,ds:A}=g,D=new UpdateEncoderV2$$module$libs$y_webrtc_min;return a.transact(F=>{let K=0;t.forEach(H=>{0<H&&K++});writeVarUint$$module$libs$y_webrtc_min(D.restEncoder,
K);for(const [H,J]of t){if(0===J)continue;J<getState$$module$libs$y_webrtc_min(a.store,H)&&getItemCleanStart$$module$libs$y_webrtc_min(F,createID$$module$libs$y_webrtc_min(H,J));const I=a.store.clients.get(H)||[],N=findIndexSS$$module$libs$y_webrtc_min(I,J-1);writeVarUint$$module$libs$y_webrtc_min(D.restEncoder,N+1);D.writeClient(H);writeVarUint$$module$libs$y_webrtc_min(D.restEncoder,0);for(let T=0;T<=N;T++)I[T].write(D,0)}writeDeleteSet$$module$libs$y_webrtc_min(D,A)}),applyUpdateV2$$module$libs$y_webrtc_min(p,
D.toUint8Array(),"snapshot"),p};class StructStore$$module$libs$y_webrtc_min{constructor(){this.clients=new Map;this.pendingDs=this.pendingStructs=null}}
const getStateVector$$module$libs$y_webrtc_min=a=>{const g=new Map;return a.clients.forEach((p,t)=>{p=p[p.length-1];g.set(t,p.id.clock+p.length)}),g},getState$$module$libs$y_webrtc_min=(a,g)=>{a=a.clients.get(g);if(void 0===a)return 0;a=a[a.length-1];return a.id.clock+a.length},addStruct$$module$libs$y_webrtc_min=(a,g)=>{let p=a.clients.get(g.id.client);if(void 0===p)p=[],a.clients.set(g.id.client,p);else if(a=p[p.length-1],a.id.clock+a.length!==g.id.clock)throw unexpectedCase$$module$libs$y_webrtc_min();
p.push(g)},findIndexSS$$module$libs$y_webrtc_min=(a,g)=>{let p=0,t=a.length-1,A=a[t],D=A.id.clock;if(D===g)return t;let F=floor$$module$libs$y_webrtc_min(g/(D+A.length-1)*t);for(;p<=t;){if(A=a[F],D=A.id.clock,D<=g){if(g<D+A.length)return F;p=F+1}else t=F-1;F=floor$$module$libs$y_webrtc_min((p+t)/2)}throw unexpectedCase$$module$libs$y_webrtc_min();},getItem$$module$libs$y_webrtc_min=(a,g)=>{a=a.clients.get(g.client);return a[findIndexSS$$module$libs$y_webrtc_min(a,g.clock)]},findIndexCleanStart$$module$libs$y_webrtc_min=
(a,g,p)=>{const t=findIndexSS$$module$libs$y_webrtc_min(g,p),A=g[t];return A.id.clock<p&&A instanceof Item$$module$libs$y_webrtc_min?(g.splice(t+1,0,splitItem$$module$libs$y_webrtc_min(a,A,p-A.id.clock)),t+1):t},getItemCleanStart$$module$libs$y_webrtc_min=(a,g)=>{const p=a.doc.store.clients.get(g.client);return p[findIndexCleanStart$$module$libs$y_webrtc_min(a,p,g.clock)]},getItemCleanEnd$$module$libs$y_webrtc_min=(a,g,p)=>{g=g.clients.get(p.client);const t=findIndexSS$$module$libs$y_webrtc_min(g,
p.clock),A=g[t];return p.clock!==A.id.clock+A.length-1&&A.constructor!==GC$$module$libs$y_webrtc_min&&g.splice(t+1,0,splitItem$$module$libs$y_webrtc_min(a,A,p.clock-A.id.clock+1)),A},iterateStructs$$module$libs$y_webrtc_min=(a,g,p,t,A)=>{if(0!==t){t=p+t;var D=findIndexCleanStart$$module$libs$y_webrtc_min(a,g,p);do p=g[D++],t<p.id.clock+p.length&&findIndexCleanStart$$module$libs$y_webrtc_min(a,g,t),A(p);while(D<g.length&&g[D].id.clock<t)}};
class Transaction$$module$libs$y_webrtc_min{constructor(a,g,p){this.doc=a;this.deleteSet=new DeleteSet$$module$libs$y_webrtc_min;this.beforeState=getStateVector$$module$libs$y_webrtc_min(a.store);this.afterState=new Map;this.changed=new Map;this.changedParentTypes=new Map;this._mergeStructs=[];this.origin=g;this.meta=new Map;this.local=p;this.subdocsAdded=new Set;this.subdocsRemoved=new Set;this.subdocsLoaded=new Set}}
const writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min=(a,g)=>{var p;if(p=!(0===g.deleteSet.clients.size&&!((t,A)=>{for(const [D,F]of t)if(A(F,D))return!0;return!1})(g.afterState,(t,A)=>g.beforeState.get(A)!==t)))sortAndMergeDeleteSet$$module$libs$y_webrtc_min(g.deleteSet),writeClientsStructs$$module$libs$y_webrtc_min(a,g.doc.store,g.beforeState),p=(writeDeleteSet$$module$libs$y_webrtc_min(a,g.deleteSet),!0);return p},addChangedTypeToTransaction$$module$libs$y_webrtc_min=(a,g,p)=>{const t=
g._item;(null===t||t.id.clock<(a.beforeState.get(t.id.client)||0)&&!t.deleted)&&setIfUndefined$$module$libs$y_webrtc_min(a.changed,g,create$1$$module$libs$y_webrtc_min).add(p)},tryToMergeWithLeft$$module$libs$y_webrtc_min=(a,g)=>{const p=a[g-1],t=a[g];p.deleted===t.deleted&&p.constructor===t.constructor&&p.mergeWith(t)&&(a.splice(g,1),t instanceof Item$$module$libs$y_webrtc_min&&null!==t.parentSub&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,p))},tryGcDeleteSet$$module$libs$y_webrtc_min=
(a,g,p)=>{for(const [t,A]of a.clients.entries()){a=g.clients.get(t);for(let D=A.length-1;0<=D;D--){const F=A[D],K=F.clock+F.len;for(let H=findIndexSS$$module$libs$y_webrtc_min(a,F.clock),J=a[H];H<a.length&&J.id.clock<K;J=a[++H]){const I=a[H];if(F.clock+F.len<=I.id.clock)break;I instanceof Item$$module$libs$y_webrtc_min&&I.deleted&&!I.keep&&p(I)&&I.gc(g,!1)}}}},tryMergeDeleteSet$$module$libs$y_webrtc_min=(a,g)=>{a.clients.forEach((p,t)=>{t=g.clients.get(t);for(let A=p.length-1;0<=A;A--){const D=p[A];
for(let F=min$$module$libs$y_webrtc_min(t.length-1,1+findIndexSS$$module$libs$y_webrtc_min(t,D.clock+D.len-1)),K=t[F];0<F&&K.id.clock>=D.clock;K=t[--F])tryToMergeWithLeft$$module$libs$y_webrtc_min(t,F)}})},tryGc$$module$libs$y_webrtc_min=(a,g,p)=>{tryGcDeleteSet$$module$libs$y_webrtc_min(a,g,p);tryMergeDeleteSet$$module$libs$y_webrtc_min(a,g)},cleanupTransactions$$module$libs$y_webrtc_min=(a,g)=>{if(g<a.length){const A=a[g],D=A.doc,F=D.store;var p=A.deleteSet,t=A._mergeStructs;try{sortAndMergeDeleteSet$$module$libs$y_webrtc_min(p);
A.afterState=getStateVector$$module$libs$y_webrtc_min(A.doc.store);D.emit("beforeObserverCalls",[A,D]);const K=[];A.changed.forEach((H,J)=>K.push(()=>{null!==J._item&&J._item.deleted||J._callObserver(A,H)}));K.push(()=>{A.changedParentTypes.forEach((H,J)=>K.push(()=>{null!==J._item&&J._item.deleted||((H=H.filter(I=>null===I.target._item||!I.target._item.deleted)).forEach(I=>{I.currentTarget=J}),H.sort((I,N)=>I.path.length-N.path.length),callEventHandlerListeners$$module$libs$y_webrtc_min(J._dEH,H,
A))}));K.push(()=>D.emit("afterTransaction",[A,D]))});callAll$$module$libs$y_webrtc_min(K,[])}finally{D.gc&&tryGcDeleteSet$$module$libs$y_webrtc_min(p,F,D.gcFilter);tryMergeDeleteSet$$module$libs$y_webrtc_min(p,F);A.afterState.forEach((I,N)=>{var T=A.beforeState.get(N)||0;if(T!==I)for(I=F.clients.get(N),T=max$$module$libs$y_webrtc_min(findIndexSS$$module$libs$y_webrtc_min(I,T),1),N=I.length-1;N>=T;N--)tryToMergeWithLeft$$module$libs$y_webrtc_min(I,N)});for(p=0;p<t.length;p++){const {client:I,clock:N}=
t[p].id,T=F.clients.get(I),O=findIndexSS$$module$libs$y_webrtc_min(T,N);O+1<T.length&&tryToMergeWithLeft$$module$libs$y_webrtc_min(T,O+1);0<O&&tryToMergeWithLeft$$module$libs$y_webrtc_min(T,O)}if(A.local||A.afterState.get(D.clientID)===A.beforeState.get(D.clientID)||(print$$module$libs$y_webrtc_min(ORANGE$$module$libs$y_webrtc_min,BOLD$$module$libs$y_webrtc_min,"[yjs] ",UNBOLD$$module$libs$y_webrtc_min,RED$$module$libs$y_webrtc_min,"Changed the client-id because another client seems to be using it."),
D.clientID=uint32$$module$libs$y_webrtc_min()),D.emit("afterTransactionCleanup",[A,D]),D._observers.has("update"))t=new UpdateEncoderV1$$module$libs$y_webrtc_min,writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min(t,A)&&D.emit("update",[t.toUint8Array(),A.origin,D,A]);D._observers.has("updateV2")&&(t=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min(t,A)&&D.emit("updateV2",[t.toUint8Array(),A.origin,D,A]));const {subdocsAdded:K,subdocsLoaded:H,
subdocsRemoved:J}=A;(0<K.size||0<J.size||0<H.size)&&(K.forEach(I=>{I.clientID=D.clientID;null==I.collectionid&&(I.collectionid=D.collectionid);D.subdocs.add(I)}),J.forEach(I=>D.subdocs.delete(I)),D.emit("subdocs",[{loaded:H,added:K,removed:J},D,A]),J.forEach(I=>I.destroy()));a.length<=g+1?(D._transactionCleanups=[],D.emit("afterAllTransactions",[D,a])):cleanupTransactions$$module$libs$y_webrtc_min(a,g+1)}}},transact$$module$libs$y_webrtc_min=(a,g,p=null,t=!0)=>{const A=a._transactionCleanups;let D=
!1,F=null;null===a._transaction&&(D=!0,a._transaction=new Transaction$$module$libs$y_webrtc_min(a,p,t),A.push(a._transaction),1===A.length&&a.emit("beforeAllTransactions",[a]),a.emit("beforeTransaction",[a._transaction,a]));try{F=g(a._transaction)}finally{D&&(g=a._transaction===A[0],a._transaction=null,g&&cleanupTransactions$$module$libs$y_webrtc_min(A,0))}return F};class StackItem$$module$libs$y_webrtc_min{constructor(a,g){this.insertions=g;this.deletions=a;this.meta=new Map}}
const clearUndoManagerStackItem$$module$libs$y_webrtc_min=(a,g,p)=>{iterateDeletedStructs$$module$libs$y_webrtc_min(a,p.deletions,t=>{t instanceof Item$$module$libs$y_webrtc_min&&g.scope.some(A=>isParentOf$$module$libs$y_webrtc_min(A,t))&&keepItem$$module$libs$y_webrtc_min(t,!1)})},popStackItem$$module$libs$y_webrtc_min=(a,g,p)=>{let t=null,A=null;const D=a.doc,F=a.scope;(transact$$module$libs$y_webrtc_min(D,K=>{for(;0<g.length&&null===t;){const H=D.store,J=g.pop(),I=new Set,N=[];let T=!1;iterateDeletedStructs$$module$libs$y_webrtc_min(K,
J.insertions,O=>{if(O instanceof Item$$module$libs$y_webrtc_min){if(null!==O.redone){let {item:W,diff:ba}=followRedone$$module$libs$y_webrtc_min(H,O.id);0<ba&&(W=getItemCleanStart$$module$libs$y_webrtc_min(K,createID$$module$libs$y_webrtc_min(W.id.client,W.id.clock+ba)));O=W}!O.deleted&&F.some(W=>isParentOf$$module$libs$y_webrtc_min(W,O))&&N.push(O)}});iterateDeletedStructs$$module$libs$y_webrtc_min(K,J.deletions,O=>{O instanceof Item$$module$libs$y_webrtc_min&&F.some(W=>isParentOf$$module$libs$y_webrtc_min(W,
O))&&!isDeleted$$module$libs$y_webrtc_min(J.insertions,O.id)&&I.add(O)});I.forEach(O=>{T=null!==redoItem$$module$libs$y_webrtc_min(K,O,I,J.insertions,a.ignoreRemoteMapChanges,a)||T});for(let O=N.length-1;0<=O;O--){const W=N[O];a.deleteFilter(W)&&(W.delete(K),T=!0)}t=T?J:null}K.changed.forEach((H,J)=>{H.has(null)&&J._searchMarker&&(J._searchMarker.length=0)});A=K},a),null!=t)&&a.emit("stack-item-popped",[{stackItem:t,type:p,changedParentTypes:A.changedParentTypes},a]);return t};
class UndoManager$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,{captureTimeout:g=500,captureTransaction:p=K=>!0,deleteFilter:t=()=>!0,trackedOrigins:A=new Set([null]),ignoreRemoteMapChanges:D=!1,doc:F=isArray$$module$libs$y_webrtc_min(a)?a[0].doc:a.doc}={}){super();this.scope=[];this.addToScope(a);this.deleteFilter=t;A.add(this);this.trackedOrigins=A;this.captureTransaction=p;this.undoStack=[];this.redoStack=[];this.redoing=this.undoing=!1;this.doc=F;this.lastChange=
0;this.ignoreRemoteMapChanges=D;this.captureTimeout=g;this.afterTransactionHandler=K=>{if(this.captureTransaction(K)&&this.scope.some(W=>K.changedParentTypes.has(W))&&(this.trackedOrigins.has(K.origin)||K.origin&&this.trackedOrigins.has(K.origin.constructor))){var H=this.undoing,J=this.redoing,I=H?this.redoStack:this.undoStack;H?this.stopCapturing():J||this.clear(!1,!0);var N=new DeleteSet$$module$libs$y_webrtc_min;K.afterState.forEach((W,ba)=>{const fa=K.beforeState.get(ba)||0;W-=fa;0<W&&addToDeleteSet$$module$libs$y_webrtc_min(N,
ba,fa,W)});var T=getUnixTime$$module$libs$y_webrtc_min(),O=!1;if(0<this.lastChange&&T-this.lastChange<this.captureTimeout&&0<I.length&&!H&&!J){const W=I[I.length-1];W.deletions=mergeDeleteSets$$module$libs$y_webrtc_min([W.deletions,K.deleteSet]);W.insertions=mergeDeleteSets$$module$libs$y_webrtc_min([W.insertions,N])}else I.push(new StackItem$$module$libs$y_webrtc_min(K.deleteSet,N)),O=!0;H||J||(this.lastChange=T);iterateDeletedStructs$$module$libs$y_webrtc_min(K,K.deleteSet,W=>{W instanceof Item$$module$libs$y_webrtc_min&&
this.scope.some(ba=>isParentOf$$module$libs$y_webrtc_min(ba,W))&&keepItem$$module$libs$y_webrtc_min(W,!0)});H=[{stackItem:I[I.length-1],origin:K.origin,type:H?"redo":"undo",changedParentTypes:K.changedParentTypes},this];O?this.emit("stack-item-added",H):this.emit("stack-item-updated",H)}};this.doc.on("afterTransaction",this.afterTransactionHandler);this.doc.on("destroy",()=>{this.destroy()})}addToScope(a){(a=isArray$$module$libs$y_webrtc_min(a)?a:[a]).forEach(g=>{this.scope.every(p=>p!==g)&&this.scope.push(g)})}addTrackedOrigin(a){this.trackedOrigins.add(a)}removeTrackedOrigin(a){this.trackedOrigins.delete(a)}clear(a=
!0,g=!0){(a&&this.canUndo()||g&&this.canRedo())&&this.doc.transact(p=>{a&&(this.undoStack.forEach(t=>clearUndoManagerStackItem$$module$libs$y_webrtc_min(p,this,t)),this.undoStack=[]);g&&(this.redoStack.forEach(t=>clearUndoManagerStackItem$$module$libs$y_webrtc_min(p,this,t)),this.redoStack=[]);this.emit("stack-cleared",[{undoStackCleared:a,redoStackCleared:g}])})}stopCapturing(){this.lastChange=0}undo(){let a;this.undoing=!0;try{a=popStackItem$$module$libs$y_webrtc_min(this,this.undoStack,"undo")}finally{this.undoing=
!1}return a}redo(){let a;this.redoing=!0;try{a=popStackItem$$module$libs$y_webrtc_min(this,this.redoStack,"redo")}finally{this.redoing=!1}return a}canUndo(){return 0<this.undoStack.length}canRedo(){return 0<this.redoStack.length}destroy(){this.trackedOrigins.delete(this);this.doc.off("afterTransaction",this.afterTransactionHandler);super.destroy()}}
class LazyStructReader$$module$libs$y_webrtc_min{constructor(a,g){this.gen=function*(p){const t=readVarUint$$module$libs$y_webrtc_min(p.restDecoder);for(let D=0;D<t;D++){const F=readVarUint$$module$libs$y_webrtc_min(p.restDecoder),K=p.readClient();let H=readVarUint$$module$libs$y_webrtc_min(p.restDecoder);for(let J=0;J<F;J++){var A=p.readInfo();if(10===A)A=readVarUint$$module$libs$y_webrtc_min(p.restDecoder),yield new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(K,H),A),H+=A;
else if(0!=(31&A)){const I=0==(192&A);A=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(K,H),null,128==(128&A)?p.readLeftID():null,null,64==(64&A)?p.readRightID():null,I?p.readParentInfo()?p.readString():p.readLeftID():null,I&&32==(32&A)?p.readString():null,readItemContent$$module$libs$y_webrtc_min(p,A));yield A;H+=A.length}else A=p.readLen(),yield new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(K,H),A),H+=A}}}(a);this.curr=null;this.done=!1;this.filterSkips=
g;this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===Skip$$module$libs$y_webrtc_min);return this.curr}}
const logUpdate$$module$libs$y_webrtc_min=a=>logUpdateV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),logUpdateV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{var p=[];a=new g(createDecoder$$module$libs$y_webrtc_min(a));g=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);for(let t=g.curr;null!==t;t=g.next())p.push(t);print$$module$libs$y_webrtc_min("Structs: ",p);p=readDeleteSet$$module$libs$y_webrtc_min(a);print$$module$libs$y_webrtc_min("DeleteSet: ",
p)},decodeUpdate$$module$libs$y_webrtc_min=a=>decodeUpdateV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),decodeUpdateV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{const p=[];a=new g(createDecoder$$module$libs$y_webrtc_min(a));g=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);for(let t=g.curr;null!==t;t=g.next())p.push(t);return{structs:p,ds:readDeleteSet$$module$libs$y_webrtc_min(a)}};
class LazyStructWriter$$module$libs$y_webrtc_min{constructor(a){this.written=this.startClock=this.currClient=0;this.encoder=a;this.clientStructs=[]}}
const mergeUpdates$$module$libs$y_webrtc_min=a=>mergeUpdatesV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min),encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min=(a,g=DSEncoderV2$$module$libs$y_webrtc_min,p=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{g=new g;p=new LazyStructReader$$module$libs$y_webrtc_min(new p(createDecoder$$module$libs$y_webrtc_min(a)),!1);let t=p.curr;if(null!==t){a=0;let A=t.id.client,D=0!==t.id.clock,F=D?
0:t.id.clock+t.length;for(;null!==t;t=p.next())A!==t.id.client&&(0!==F&&(a++,writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,A),writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,F)),A=t.id.client,F=0,D=0!==t.id.clock),t.constructor===Skip$$module$libs$y_webrtc_min&&(D=!0),D||(F=t.id.clock+t.length);0!==F&&(a++,writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,A),writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,F));p=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(p,
a);writeUint8Array$$module$libs$y_webrtc_min(p,toUint8Array$$module$libs$y_webrtc_min(g.restEncoder));return g.restEncoder=p,g.toUint8Array()}return writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,0),g.toUint8Array()},encodeStateVectorFromUpdate$$module$libs$y_webrtc_min=a=>encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min(a,DSEncoderV1$$module$libs$y_webrtc_min,UpdateDecoderV1$$module$libs$y_webrtc_min),parseUpdateMetaV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min)=>
{const p=new Map,t=new Map;a=new LazyStructReader$$module$libs$y_webrtc_min(new g(createDecoder$$module$libs$y_webrtc_min(a)),!1);g=a.curr;if(null!==g){let A=g.id.client,D=g.id.clock;for(p.set(A,D);null!==g;g=a.next())A!==g.id.client&&(t.set(A,D),p.set(g.id.client,g.id.clock),A=g.id.client),D=g.id.clock+g.length;t.set(A,D)}return{from:p,to:t}},parseUpdateMeta$$module$libs$y_webrtc_min=a=>parseUpdateMetaV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),sliceStruct$$module$libs$y_webrtc_min=
(a,g)=>{if(a.constructor===GC$$module$libs$y_webrtc_min){const {client:A,clock:D}=a.id;return new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(A,D+g),a.length-g)}if(a.constructor===Skip$$module$libs$y_webrtc_min){const {client:A,clock:D}=a.id;return new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(A,D+g),a.length-g)}const {client:p,clock:t}=a.id;return new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(p,t+g),null,createID$$module$libs$y_webrtc_min(p,
t+g-1),null,a.rightOrigin,a.parent,a.parentSub,a.content.splice(g))},mergeUpdatesV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min,p=UpdateEncoderV2$$module$libs$y_webrtc_min)=>{if(1===a.length)return a[0];a=a.map(H=>new g(createDecoder$$module$libs$y_webrtc_min(H)));let t=a.map(H=>new LazyStructReader$$module$libs$y_webrtc_min(H,!0)),A=null;p=new p;const D=new LazyStructWriter$$module$libs$y_webrtc_min(p);for(;t=t.filter(H=>null!==H.curr),t.sort((H,J)=>{if(H.curr.id.client===
J.curr.id.client){const I=H.curr.id.clock-J.curr.id.clock;return 0===I?H.curr.constructor===J.curr.constructor?0:H.curr.constructor===Skip$$module$libs$y_webrtc_min?1:-1:I}return J.curr.id.client-H.curr.id.client}),0!==t.length;){const H=t[0],J=H.curr.id.client;if(null!==A){for(var F=H.curr,K=!1;null!==F&&F.id.clock+F.length<=A.struct.id.clock+A.struct.length&&F.id.client>=A.struct.id.client;)F=H.next(),K=!0;if(null===F||F.id.client!==J||K&&F.id.clock>A.struct.id.clock+A.struct.length)continue;J!==
A.struct.id.client?(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(D,A.struct,A.offset),A={struct:F,offset:0},H.next()):A.struct.id.clock+A.struct.length<F.id.clock?A.struct.constructor===Skip$$module$libs$y_webrtc_min?A.struct.length=F.id.clock+F.length-A.struct.id.clock:(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(D,A.struct,A.offset),F=F.id.clock-A.struct.id.clock-A.struct.length,A={struct:new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(J,A.struct.id.clock+
A.struct.length),F),offset:0}):(K=A.struct.id.clock+A.struct.length-F.id.clock,0<K&&(A.struct.constructor===Skip$$module$libs$y_webrtc_min?A.struct.length-=K:F=sliceStruct$$module$libs$y_webrtc_min(F,K)),A.struct.mergeWith(F)||(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(D,A.struct,A.offset),A={struct:F,offset:0},H.next()))}else A={struct:H.curr,offset:0},H.next();for(F=H.curr;null!==F&&F.id.client===J&&F.id.clock===A.struct.id.clock+A.struct.length&&F.constructor!==Skip$$module$libs$y_webrtc_min;F=
H.next())writeStructToLazyStructWriter$$module$libs$y_webrtc_min(D,A.struct,A.offset),A={struct:F,offset:0}}null!==A&&(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(D,A.struct,A.offset),A=null);finishLazyStructWriting$$module$libs$y_webrtc_min(D);a=a.map(H=>readDeleteSet$$module$libs$y_webrtc_min(H));a=mergeDeleteSets$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(p,a),p.toUint8Array()},diffUpdateV2$$module$libs$y_webrtc_min=(a,g,p=UpdateDecoderV2$$module$libs$y_webrtc_min,
t=UpdateEncoderV2$$module$libs$y_webrtc_min)=>{g=decodeStateVector$$module$libs$y_webrtc_min(g);t=new t;const A=new LazyStructWriter$$module$libs$y_webrtc_min(t);a=new p(createDecoder$$module$libs$y_webrtc_min(a));for(p=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);p.curr;){const D=p.curr,F=D.id.client,K=g.get(F)||0;if(p.curr.constructor!==Skip$$module$libs$y_webrtc_min)if(D.id.clock+D.length>K)for(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(A,D,max$$module$libs$y_webrtc_min(K-
D.id.clock,0)),p.next();p.curr&&p.curr.id.client===F;)writeStructToLazyStructWriter$$module$libs$y_webrtc_min(A,p.curr,0),p.next();else for(;p.curr&&p.curr.id.client===F&&p.curr.id.clock+p.curr.length<=K;)p.next();else p.next()}finishLazyStructWriting$$module$libs$y_webrtc_min(A);g=readDeleteSet$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(t,g),t.toUint8Array()},diffUpdate$$module$libs$y_webrtc_min=(a,g)=>diffUpdateV2$$module$libs$y_webrtc_min(a,g,UpdateDecoderV1$$module$libs$y_webrtc_min,
UpdateEncoderV1$$module$libs$y_webrtc_min),flushLazyStructWriter$$module$libs$y_webrtc_min=a=>{0<a.written&&(a.clientStructs.push({written:a.written,restEncoder:toUint8Array$$module$libs$y_webrtc_min(a.encoder.restEncoder)}),a.encoder.restEncoder=createEncoder$$module$libs$y_webrtc_min(),a.written=0)},writeStructToLazyStructWriter$$module$libs$y_webrtc_min=(a,g,p)=>{0<a.written&&a.currClient!==g.id.client&&flushLazyStructWriter$$module$libs$y_webrtc_min(a);0===a.written&&(a.currClient=g.id.client,
a.encoder.writeClient(g.id.client),writeVarUint$$module$libs$y_webrtc_min(a.encoder.restEncoder,g.id.clock+p));g.write(a.encoder,p);a.written++},finishLazyStructWriting$$module$libs$y_webrtc_min=a=>{flushLazyStructWriter$$module$libs$y_webrtc_min(a);const g=a.encoder.restEncoder;writeVarUint$$module$libs$y_webrtc_min(g,a.clientStructs.length);for(let p=0;p<a.clientStructs.length;p++){const t=a.clientStructs[p];writeVarUint$$module$libs$y_webrtc_min(g,t.written);writeUint8Array$$module$libs$y_webrtc_min(g,
t.restEncoder)}},convertUpdateFormat$$module$libs$y_webrtc_min=(a,g,p,t)=>{a=new p(createDecoder$$module$libs$y_webrtc_min(a));p=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);t=new t;const A=new LazyStructWriter$$module$libs$y_webrtc_min(t);for(let D=p.curr;null!==D;D=p.next())writeStructToLazyStructWriter$$module$libs$y_webrtc_min(A,g(D),0);finishLazyStructWriting$$module$libs$y_webrtc_min(A);g=readDeleteSet$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(t,g),
t.toUint8Array()},createObfuscator$$module$libs$y_webrtc_min=({formatting:a=!0,subdocs:g=!0,yxml:p=!0}={})=>{let t=0;const A=create$$module$libs$y_webrtc_min(),D=create$$module$libs$y_webrtc_min(),F=create$$module$libs$y_webrtc_min(),K=create$$module$libs$y_webrtc_min();return K.set(null,null),H=>{switch(H.constructor){case GC$$module$libs$y_webrtc_min:case Skip$$module$libs$y_webrtc_min:return H;case Item$$module$libs$y_webrtc_min:var J=H.content;switch(J.constructor){case ContentDeleted$$module$libs$y_webrtc_min:break;
case ContentType$$module$libs$y_webrtc_min:p&&(J=J.type,J instanceof YXmlElement$$module$libs$y_webrtc_min&&(J.nodeName=setIfUndefined$$module$libs$y_webrtc_min(D,J.nodeName,()=>"node-"+t)),J instanceof YXmlHook$$module$libs$y_webrtc_min&&(J.hookName=setIfUndefined$$module$libs$y_webrtc_min(D,J.hookName,()=>"hook-"+t)));break;case ContentAny$$module$libs$y_webrtc_min:J.arr=J.arr.map(()=>t);break;case ContentBinary$$module$libs$y_webrtc_min:J.content=new Uint8Array([t]);break;case ContentDoc$$module$libs$y_webrtc_min:g&&
(J.opts={},J.doc.guid=t+"");break;case ContentEmbed$$module$libs$y_webrtc_min:J.embed={};break;case ContentFormat$$module$libs$y_webrtc_min:a&&(J.key=setIfUndefined$$module$libs$y_webrtc_min(F,J.key,()=>t+""),J.value=setIfUndefined$$module$libs$y_webrtc_min(K,J.value,()=>({i:t})));break;case ContentJSON$$module$libs$y_webrtc_min:J.arr=J.arr.map(()=>t);break;case ContentString$$module$libs$y_webrtc_min:J.str=repeat$$module$libs$y_webrtc_min(t%10+"",J.str.length);break;default:unexpectedCase$$module$libs$y_webrtc_min()}return H.parentSub&&
(H.parentSub=setIfUndefined$$module$libs$y_webrtc_min(A,H.parentSub,()=>t+"")),t++,H;default:unexpectedCase$$module$libs$y_webrtc_min()}}},obfuscateUpdate$$module$libs$y_webrtc_min=(a,g)=>convertUpdateFormat$$module$libs$y_webrtc_min(a,createObfuscator$$module$libs$y_webrtc_min(g),UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min),obfuscateUpdateV2$$module$libs$y_webrtc_min=(a,g)=>convertUpdateFormat$$module$libs$y_webrtc_min(a,createObfuscator$$module$libs$y_webrtc_min(g),
UpdateDecoderV2$$module$libs$y_webrtc_min,UpdateEncoderV2$$module$libs$y_webrtc_min),convertUpdateFormatV1ToV2$$module$libs$y_webrtc_min=a=>convertUpdateFormat$$module$libs$y_webrtc_min(a,id$$module$libs$y_webrtc_min,UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV2$$module$libs$y_webrtc_min),convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min=a=>convertUpdateFormat$$module$libs$y_webrtc_min(a,id$$module$libs$y_webrtc_min,UpdateDecoderV2$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min);
class YEvent$$module$libs$y_webrtc_min{constructor(a,g){this.currentTarget=this.target=a;this.transaction=g;this._delta=this._keys=this._changes=null}get path(){return getPathTo$$module$libs$y_webrtc_min(this.currentTarget,this.target)}deletes(a){return isDeleted$$module$libs$y_webrtc_min(this.transaction.deleteSet,a.id)}get keys(){if(null===this._keys){const a=new Map,g=this.target;this.transaction.changed.get(g).forEach(p=>{if(null!==p){const t=g._map.get(p);let A,D;if(this.adds(t)){let F=t.left;
for(;null!==F&&this.adds(F);)F=F.left;if(this.deletes(t)){if(null===F||!this.deletes(F))return;A="delete";D=last$$module$libs$y_webrtc_min(F.content.getContent())}else null!==F&&this.deletes(F)?(A="update",D=last$$module$libs$y_webrtc_min(F.content.getContent())):(A="add",D=void 0)}else{if(!this.deletes(t))return;A="delete";D=last$$module$libs$y_webrtc_min(t.content.getContent())}a.set(p,{action:A,oldValue:D})}});this._keys=a}return this._keys}get delta(){return this.changes.delta}adds(a){return a.id.clock>=
(this.transaction.beforeState.get(a.id.client)||0)}get changes(){let a=this._changes;if(null===a){var g=this.target;const p=create$1$$module$libs$y_webrtc_min(),t=create$1$$module$libs$y_webrtc_min(),A=[];a={added:p,deleted:t,delta:A,keys:this.keys};if(this.transaction.changed.get(g).has(null)){let D=null;for(g=g._start;null!==g;g=g.right)if(g.deleted){if(this.deletes(g)&&!this.adds(g)){if(null===D||void 0===D.delete)D&&A.push(D),D={delete:0};D.delete+=g.length;t.add(g)}}else if(this.adds(g)){if(null===
D||void 0===D.insert)D&&A.push(D),D={insert:[]};D.insert=D.insert.concat(g.content.getContent());p.add(g)}else{if(null===D||void 0===D.retain)D&&A.push(D),D={retain:0};D.retain+=g.length}null!==D&&void 0===D.retain&&D&&A.push(D)}this._changes=a}return a}}
const getPathTo$$module$libs$y_webrtc_min=(a,g)=>{const p=[];for(;null!==g._item&&g!==a;){if(null!==g._item.parentSub)p.unshift(g._item.parentSub);else{let t=0,A=g._item.parent._start;for(;A!==g._item&&null!==A;)A.deleted||t++,A=A.right;p.unshift(t)}g=g._item.parent}return p};let globalSearchMarkerTimestamp$$module$libs$y_webrtc_min=0;
class ArraySearchMarker$$module$libs$y_webrtc_min{constructor(a,g){a.marker=!0;this.p=a;this.index=g;this.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++}}
const overwriteMarker$$module$libs$y_webrtc_min=(a,g,p)=>{a.p.marker=!1;a.p=g;g.marker=!0;a.index=p;a.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++},findMarker$$module$libs$y_webrtc_min=(a,g)=>{if(null===a._start||0===g||null===a._searchMarker)return null;const p=0===a._searchMarker.length?null:a._searchMarker.reduce((D,F)=>abs$$module$libs$y_webrtc_min(g-D.index)<abs$$module$libs$y_webrtc_min(g-F.index)?D:F);let t=a._start,A=0;null!==p&&(t=p.p,A=p.index,p.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++);
for(;null!==t.right&&A<g;){if(!t.deleted&&t.countable){if(g<A+t.length)break;A+=t.length}t=t.right}for(;null!==t.left&&A>g;)t=t.left,!t.deleted&&t.countable&&(A-=t.length);for(;null!==t.left&&t.left.id.client===t.id.client&&t.left.id.clock+t.left.length===t.id.clock;)t=t.left,!t.deleted&&t.countable&&(A-=t.length);return null!==p&&abs$$module$libs$y_webrtc_min(p.index-A)<t.parent.length/80?(overwriteMarker$$module$libs$y_webrtc_min(p,t,A),p):((D,F,K)=>{if(80<=D.length)return D=D.reduce((H,J)=>H.timestamp<
J.timestamp?H:J),overwriteMarker$$module$libs$y_webrtc_min(D,F,K),D;F=new ArraySearchMarker$$module$libs$y_webrtc_min(F,K);return D.push(F),F})(a._searchMarker,t,A)},updateMarkerChanges$$module$libs$y_webrtc_min=(a,g,p)=>{for(let t=a.length-1;0<=t;t--){const A=a[t];if(0<p){let D=A.p;for(D.marker=!1;D&&(D.deleted||!D.countable);)(D=D.left)&&!D.deleted&&D.countable&&(A.index-=D.length);if(null===D||!0===D.marker){a.splice(t,1);continue}A.p=D;D.marker=!0}(g<A.index||0<p&&g===A.index)&&(A.index=max$$module$libs$y_webrtc_min(g,
A.index+p))}},getTypeChildren$$module$libs$y_webrtc_min=a=>{a=a._start;const g=[];for(;a;)g.push(a),a=a.right;return g},callTypeObservers$$module$libs$y_webrtc_min=(a,g,p)=>{const t=a,A=g.changedParentTypes;for(;setIfUndefined$$module$libs$y_webrtc_min(A,a,()=>[]).push(p),null!==a._item;)a=a._item.parent;callEventHandlerListeners$$module$libs$y_webrtc_min(t._eH,p,g)};
class AbstractType$$module$libs$y_webrtc_min{constructor(){this._item=null;this._map=new Map;this.doc=this._start=null;this._length=0;this._eH=createEventHandler$$module$libs$y_webrtc_min();this._dEH=createEventHandler$$module$libs$y_webrtc_min();this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(a,g){this.doc=a;this._item=g}_copy(){throw methodUnimplemented$$module$libs$y_webrtc_min();}clone(){throw methodUnimplemented$$module$libs$y_webrtc_min();}_write(a){}get _first(){let a=
this._start;for(;null!==a&&a.deleted;)a=a.right;return a}_callObserver(a,g){!a.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(a){addEventHandlerListener$$module$libs$y_webrtc_min(this._eH,a)}observeDeep(a){addEventHandlerListener$$module$libs$y_webrtc_min(this._dEH,a)}unobserve(a){removeEventHandlerListener$$module$libs$y_webrtc_min(this._eH,a)}unobserveDeep(a){removeEventHandlerListener$$module$libs$y_webrtc_min(this._dEH,a)}toJSON(){}}
const typeListSlice$$module$libs$y_webrtc_min=(a,g,p)=>{0>g&&(g=a._length+g);0>p&&(p=a._length+p);p-=g;const t=[];for(a=a._start;null!==a&&0<p;){if(a.countable&&!a.deleted){const A=a.content.getContent();if(A.length<=g)g-=A.length;else{for(;g<A.length&&0<p;g++)t.push(A[g]),p--;g=0}}a=a.right}return t},typeListToArray$$module$libs$y_webrtc_min=a=>{const g=[];for(a=a._start;null!==a;){if(a.countable&&!a.deleted){const p=a.content.getContent();for(let t=0;t<p.length;t++)g.push(p[t])}a=a.right}return g},
typeListToArraySnapshot$$module$libs$y_webrtc_min=(a,g)=>{const p=[];for(a=a._start;null!==a;){if(a.countable&&isVisible$$module$libs$y_webrtc_min(a,g)){const t=a.content.getContent();for(let A=0;A<t.length;A++)p.push(t[A])}a=a.right}return p},typeListForEach$$module$libs$y_webrtc_min=(a,g)=>{let p=0,t=a._start;for(;null!==t;){if(t.countable&&!t.deleted){const A=t.content.getContent();for(let D=0;D<A.length;D++)g(A[D],p++,a)}t=t.right}},typeListMap$$module$libs$y_webrtc_min=(a,g)=>{const p=[];return typeListForEach$$module$libs$y_webrtc_min(a,
(t,A)=>{p.push(g(t,A,a))}),p},typeListCreateIterator$$module$libs$y_webrtc_min=a=>{let g=a._start,p=null,t=0;return{[Symbol.iterator](){return this},next:()=>{if(null===p){for(;null!==g&&g.deleted;)g=g.right;if(null===g)return{done:!0,value:void 0};p=g.content.getContent();t=0;g=g.right}const A=p[t++];return p.length<=t&&(p=null),{done:!1,value:A}}}},typeListGet$$module$libs$y_webrtc_min=(a,g)=>{const p=findMarker$$module$libs$y_webrtc_min(a,g);a=a._start;for(null!==p&&(a=p.p,g-=p.index);null!==a;a=
a.right)if(!a.deleted&&a.countable){if(g<a.length)return a.content.getContent()[g];g-=a.length}},typeListInsertGenericsAfter$$module$libs$y_webrtc_min=(a,g,p,t)=>{let A=p;const D=a.doc,F=D.clientID,K=D.store,H=null===p?g._start:p.right;let J=[];const I=()=>{0<J.length&&(A=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(K,F)),A,A&&A.lastId,H,H&&H.id,g,null,new ContentAny$$module$libs$y_webrtc_min(J)),A.integrate(a,0),J=[])};t.forEach(N=>{if(null===
N)J.push(N);else switch(N.constructor){case Number:case Object:case Boolean:case Array:case String:J.push(N);break;default:switch(I(),N.constructor){case Uint8Array:case ArrayBuffer:A=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(K,F)),A,A&&A.lastId,H,H&&H.id,g,null,new ContentBinary$$module$libs$y_webrtc_min(new Uint8Array(N)));A.integrate(a,0);break;case Doc$$module$libs$y_webrtc_min:A=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,
getState$$module$libs$y_webrtc_min(K,F)),A,A&&A.lastId,H,H&&H.id,g,null,new ContentDoc$$module$libs$y_webrtc_min(N));A.integrate(a,0);break;default:if(!(N instanceof AbstractType$$module$libs$y_webrtc_min))throw Error("Unexpected content type in insert operation");A=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(K,F)),A,A&&A.lastId,H,H&&H.id,g,null,new ContentType$$module$libs$y_webrtc_min(N));A.integrate(a,0)}}});I()},lengthExceeded$$module$libs$y_webrtc_min=
create$2$$module$libs$y_webrtc_min("Length exceeded!"),typeListInsertGenerics$$module$libs$y_webrtc_min=(a,g,p,t)=>{if(p>g._length)throw lengthExceeded$$module$libs$y_webrtc_min;if(0===p)return g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,p,t.length),typeListInsertGenericsAfter$$module$libs$y_webrtc_min(a,g,null,t);const A=p,D=findMarker$$module$libs$y_webrtc_min(g,p);let F=g._start;for(null!==D&&(F=D.p,0===(p-=D.index)&&(F=F.prev,p+=F&&F.countable&&!F.deleted?F.length:
0));null!==F;F=F.right)if(!F.deleted&&F.countable){if(p<=F.length){p<F.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(F.id.client,F.id.clock+p));break}p-=F.length}return g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,A,t.length),typeListInsertGenericsAfter$$module$libs$y_webrtc_min(a,g,F,t)},typeListDelete$$module$libs$y_webrtc_min=(a,g,p,t)=>{if(0!==t){var A=p,D=t,F=findMarker$$module$libs$y_webrtc_min(g,p),K=g._start;for(null!==
F&&(K=F.p,p-=F.index);null!==K&&0<p;K=K.right)!K.deleted&&K.countable&&(p<K.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(K.id.client,K.id.clock+p)),p-=K.length);for(;0<t&&null!==K;)K.deleted||(t<K.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(K.id.client,K.id.clock+t)),K.delete(a),t-=K.length),K=K.right;if(0<t)throw lengthExceeded$$module$libs$y_webrtc_min;g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,
A,-D+t)}},typeMapDelete$$module$libs$y_webrtc_min=(a,g,p)=>{g=g._map.get(p);void 0!==g&&g.delete(a)},typeMapSet$$module$libs$y_webrtc_min=(a,g,p,t)=>{const A=g._map.get(p)||null,D=a.doc,F=D.clientID;if(null==t)t=new ContentAny$$module$libs$y_webrtc_min([t]);else switch(t.constructor){case Number:case Object:case Boolean:case Array:case String:t=new ContentAny$$module$libs$y_webrtc_min([t]);break;case Uint8Array:t=new ContentBinary$$module$libs$y_webrtc_min(t);break;case Doc$$module$libs$y_webrtc_min:t=
new ContentDoc$$module$libs$y_webrtc_min(t);break;default:if(!(t instanceof AbstractType$$module$libs$y_webrtc_min))throw Error("Unexpected content type");t=new ContentType$$module$libs$y_webrtc_min(t)}(new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(D.store,F)),A,A&&A.lastId,null,null,g,p,t)).integrate(a,0)},typeMapGet$$module$libs$y_webrtc_min=(a,g)=>{a=a._map.get(g);return void 0===a||a.deleted?void 0:a.content.getContent()[a.length-1]},
typeMapGetAll$$module$libs$y_webrtc_min=a=>{const g={};return a._map.forEach((p,t)=>{p.deleted||(g[t]=p.content.getContent()[p.length-1])}),g},typeMapHas$$module$libs$y_webrtc_min=(a,g)=>{a=a._map.get(g);return void 0!==a&&!a.deleted},typeMapGetSnapshot$$module$libs$y_webrtc_min=(a,g,p)=>{for(a=a._map.get(g)||null;null!==a&&(!p.sv.has(a.id.client)||a.id.clock>=(p.sv.get(a.id.client)||0));)a=a.left;return null!==a&&isVisible$$module$libs$y_webrtc_min(a,p)?a.content.getContent()[a.length-1]:void 0},
createMapIterator$$module$libs$y_webrtc_min=a=>{return g=a.entries(),p=t=>!t[1].deleted,createIterator$$module$libs$y_webrtc_min(()=>{let t;do t=g.next();while(!t.done&&!p(t.value));return t});var g,p};class YArrayEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g){super(a,g);this._transaction=g}}
class YArray$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(){super();this._prelimContent=[];this._searchMarker=[]}static from(a){const g=new YArray$$module$libs$y_webrtc_min;return g.push(a),g}_integrate(a,g){super._integrate(a,g);this.insert(0,this._prelimContent);this._prelimContent=null}_copy(){return new YArray$$module$libs$y_webrtc_min}clone(){const a=new YArray$$module$libs$y_webrtc_min;return a.insert(0,this.toArray().map(g=>g instanceof AbstractType$$module$libs$y_webrtc_min?
g.clone():g)),a}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(a,g){super._callObserver(a,g);callTypeObservers$$module$libs$y_webrtc_min(this,a,new YArrayEvent$$module$libs$y_webrtc_min(this,a))}insert(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,p=>{typeListInsertGenerics$$module$libs$y_webrtc_min(p,this,a,g)}):this._prelimContent.splice(a,0,...g)}push(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{((p,
t,A)=>{let D=(t._searchMarker||[]).reduce((F,K)=>K.index>F.index?K:F,{index:0,p:t._start}).p;if(D)for(;D.right;)D=D.right;typeListInsertGenericsAfter$$module$libs$y_webrtc_min(p,t,D,A)})(g,this,a)}):this._prelimContent.push(...a)}unshift(a){this.insert(0,a)}delete(a,g=1){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,p=>{typeListDelete$$module$libs$y_webrtc_min(p,this,a,g)}):this._prelimContent.splice(a,g)}get(a){return typeListGet$$module$libs$y_webrtc_min(this,a)}toArray(){return typeListToArray$$module$libs$y_webrtc_min(this)}slice(a=
0,g=this.length){return typeListSlice$$module$libs$y_webrtc_min(this,a,g)}toJSON(){return this.map(a=>a instanceof AbstractType$$module$libs$y_webrtc_min?a.toJSON():a)}map(a){return typeListMap$$module$libs$y_webrtc_min(this,a)}forEach(a){typeListForEach$$module$libs$y_webrtc_min(this,a)}[Symbol.iterator](){return typeListCreateIterator$$module$libs$y_webrtc_min(this)}_write(a){a.writeTypeRef(YArrayRefID$$module$libs$y_webrtc_min)}}
class YMapEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g,p){super(a,g);this.keysChanged=p}}
class YMap$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(a){super();this._prelimContent=null;this._prelimContent=void 0===a?new Map:new Map(a)}_integrate(a,g){super._integrate(a,g);this._prelimContent.forEach((p,t)=>{this.set(t,p)});this._prelimContent=null}_copy(){return new YMap$$module$libs$y_webrtc_min}clone(){const a=new YMap$$module$libs$y_webrtc_min;return this.forEach((g,p)=>{a.set(p,g instanceof AbstractType$$module$libs$y_webrtc_min?g.clone():g)}),
a}_callObserver(a,g){callTypeObservers$$module$libs$y_webrtc_min(this,a,new YMapEvent$$module$libs$y_webrtc_min(this,a,g))}toJSON(){const a={};return this._map.forEach((g,p)=>{g.deleted||(g=g.content.getContent()[g.length-1],a[p]=g instanceof AbstractType$$module$libs$y_webrtc_min?g.toJSON():g)}),a}get size(){return[...createMapIterator$$module$libs$y_webrtc_min(this._map)].length}keys(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),a=>a[0])}values(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),
a=>a[1].content.getContent()[a[1].length-1])}entries(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),a=>[a[0],a[1].content.getContent()[a[1].length-1]])}forEach(a){this._map.forEach((g,p)=>{g.deleted||a(g.content.getContent()[g.length-1],p,this)})}[Symbol.iterator](){return this.entries()}delete(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{typeMapDelete$$module$libs$y_webrtc_min(g,this,a)}):this._prelimContent.delete(a)}set(a,
g){return null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,p=>{typeMapSet$$module$libs$y_webrtc_min(p,this,a,g)}):this._prelimContent.set(a,g),g}get(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}has(a){return typeMapHas$$module$libs$y_webrtc_min(this,a)}clear(){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,a=>{this.forEach(function(g,p,t){typeMapDelete$$module$libs$y_webrtc_min(a,t,p)})}):this._prelimContent.clear()}_write(a){a.writeTypeRef(YMapRefID$$module$libs$y_webrtc_min)}}
const equalAttrs$$module$libs$y_webrtc_min=(a,g)=>a===g||"object"==typeof a&&"object"==typeof g&&a&&g&&((p,t)=>p===t||length$$module$libs$y_webrtc_min(p)===length$$module$libs$y_webrtc_min(t)&&((A,D)=>{for(const F in A)if(!D(A[F],F))return!1;return!0})(p,(A,D)=>(void 0!==A||hasProperty$$module$libs$y_webrtc_min(t,D))&&t[D]===A))(a,g);
class ItemTextListPosition$$module$libs$y_webrtc_min{constructor(a,g,p,t){this.left=a;this.right=g;this.index=p;this.currentAttributes=t}forward(){switch(null===this.right&&unexpectedCase$$module$libs$y_webrtc_min(),this.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:this.right.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length)}this.left=this.right;this.right=
this.right.right}}
const findNextPosition$$module$libs$y_webrtc_min=(a,g,p)=>{for(;null!==g.right&&0<p;){switch(g.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:g.right.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(g.currentAttributes,g.right.content);break;default:g.right.deleted||(p<g.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(g.right.id.client,g.right.id.clock+p)),g.index+=g.right.length,p-=g.right.length)}g.left=g.right;g.right=
g.right.right}return g},findPosition$$module$libs$y_webrtc_min=(a,g,p)=>{const t=new Map;var A=findMarker$$module$libs$y_webrtc_min(g,p);if(A)return g=new ItemTextListPosition$$module$libs$y_webrtc_min(A.p.left,A.p,A.index,t),findNextPosition$$module$libs$y_webrtc_min(a,g,p-A.index);A=new ItemTextListPosition$$module$libs$y_webrtc_min(null,g._start,0,t);return findNextPosition$$module$libs$y_webrtc_min(a,A,p)},insertNegatedAttributes$$module$libs$y_webrtc_min=(a,g,p,t)=>{for(;null!==p.right&&(!0===
p.right.deleted||p.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&equalAttrs$$module$libs$y_webrtc_min(t.get(p.right.content.key),p.right.content.value));)p.right.deleted||t.delete(p.right.content.key),p.forward();const A=a.doc,D=A.clientID;t.forEach((F,K)=>{const H=p.left,J=p.right;F=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(D,getState$$module$libs$y_webrtc_min(A.store,D)),H,H&&H.lastId,J,J&&J.id,g,null,new ContentFormat$$module$libs$y_webrtc_min(K,
F));F.integrate(a,0);p.right=F;p.forward()})},updateCurrentAttributes$$module$libs$y_webrtc_min=(a,g)=>{const {key:p,value:t}=g;null===t?a.delete(p):a.set(p,t)},minimizeAttributeChanges$$module$libs$y_webrtc_min=(a,g)=>{for(;null!==a.right&&(a.right.deleted||a.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&equalAttrs$$module$libs$y_webrtc_min(g[a.right.content.key]||null,a.right.content.value));)a.forward()},insertAttributes$$module$libs$y_webrtc_min=(a,g,p,t)=>{const A=a.doc,
D=A.clientID,F=new Map;for(const K in t){const H=t[K],J=p.currentAttributes.get(K)||null;if(!equalAttrs$$module$libs$y_webrtc_min(J,H)){F.set(K,J);const {left:I,right:N}=p;p.right=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(D,getState$$module$libs$y_webrtc_min(A.store,D)),I,I&&I.lastId,N,N&&N.id,g,null,new ContentFormat$$module$libs$y_webrtc_min(K,H));p.right.integrate(a,0);p.forward()}}return F},insertText$$module$libs$y_webrtc_min=(a,g,p,t,A)=>{p.currentAttributes.forEach((N,
T)=>{void 0===A[T]&&(A[T]=null)});const D=a.doc,F=D.clientID;minimizeAttributeChanges$$module$libs$y_webrtc_min(p,A);const K=insertAttributes$$module$libs$y_webrtc_min(a,g,p,A);t=t.constructor===String?new ContentString$$module$libs$y_webrtc_min(t):t instanceof AbstractType$$module$libs$y_webrtc_min?new ContentType$$module$libs$y_webrtc_min(t):new ContentEmbed$$module$libs$y_webrtc_min(t);let {left:H,right:J,index:I}=p;g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,
p.index,t.getLength());J=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(D.store,F)),H,H&&H.lastId,J,J&&J.id,g,null,t);J.integrate(a,0);p.right=J;p.index=I;p.forward();insertNegatedAttributes$$module$libs$y_webrtc_min(a,g,p,K)},formatText$$module$libs$y_webrtc_min=(a,g,p,t,A)=>{const D=a.doc,F=D.clientID;minimizeAttributeChanges$$module$libs$y_webrtc_min(p,A);const K=insertAttributes$$module$libs$y_webrtc_min(a,g,p,A);a:for(;null!==p.right&&
(0<t||0<K.size&&(p.right.deleted||p.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min));){if(!p.right.deleted)switch(p.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:const {key:H,value:J}=p.right.content,I=A[H];if(void 0!==I){if(equalAttrs$$module$libs$y_webrtc_min(I,J))K.delete(H);else{if(0===t)break a;K.set(H,J)}p.right.delete(a)}else p.currentAttributes.set(H,J);break;default:t<p.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(p.right.id.client,
p.right.id.clock+t)),t-=p.right.length}p.forward()}if(0<t){for(A="";0<t;t--)A+="\n";p.right=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(D.store,F)),p.left,p.left&&p.left.lastId,p.right,p.right&&p.right.id,g,null,new ContentString$$module$libs$y_webrtc_min(A));p.right.integrate(a,0);p.forward()}insertNegatedAttributes$$module$libs$y_webrtc_min(a,g,p,K)},cleanupFormattingGap$$module$libs$y_webrtc_min=(a,g,p,t,A)=>{let D=g;const F=create$$module$libs$y_webrtc_min();
for(;D&&(!D.countable||D.deleted);){if(!D.deleted&&D.content.constructor===ContentFormat$$module$libs$y_webrtc_min){var K=D.content;F.set(K.key,K)}D=D.right}K=0;let H=!1;for(;g!==D;){if(p===g&&(H=!0),!g.deleted){const J=g.content;switch(J.constructor){case ContentFormat$$module$libs$y_webrtc_min:const {key:I,value:N}=J,T=t.get(I)||null;F.get(I)===J&&T!==N||(g.delete(a),K++,H||(A.get(I)||null)!==N||T===N||(null===T?A.delete(I):A.set(I,T)));H||g.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(A,
J)}}g=g.right}return K},cleanupYTextFormatting$$module$libs$y_webrtc_min=a=>{let g=0;return transact$$module$libs$y_webrtc_min(a.doc,p=>{let t=a._start,A=a._start,D=create$$module$libs$y_webrtc_min();const F=copy$$module$libs$y_webrtc_min(D);for(;A;){if(!1===A.deleted)switch(A.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:updateCurrentAttributes$$module$libs$y_webrtc_min(F,A.content);break;default:g+=cleanupFormattingGap$$module$libs$y_webrtc_min(p,t,A,D,F),D=copy$$module$libs$y_webrtc_min(F),
t=A}A=A.right}}),g},deleteText$$module$libs$y_webrtc_min=(a,g,p)=>{const t=p,A=copy$$module$libs$y_webrtc_min(g.currentAttributes),D=g.right;for(;0<p&&null!==g.right;){if(!1===g.right.deleted)switch(g.right.content.constructor){case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:case ContentString$$module$libs$y_webrtc_min:p<g.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(g.right.id.client,g.right.id.clock+p)),p-=
g.right.length,g.right.delete(a)}g.forward()}D&&cleanupFormattingGap$$module$libs$y_webrtc_min(a,D,g.right,A,g.currentAttributes);a=(g.left||g.right).parent;return a._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(a._searchMarker,g.index,-t+p),g};
class YTextEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g,p){super(a,g);this.childListChanged=!1;this.keysChanged=new Set;p.forEach(t=>{null===t?this.childListChanged=!0:this.keysChanged.add(t)})}get changes(){null===this._changes&&(this._changes={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set});return this._changes}get delta(){if(null===this._delta){const a=[];transact$$module$libs$y_webrtc_min(this.target.doc,g=>{const p=new Map,t=new Map;
let A=this.target._start,D=null;const F={};let K="",H=0,J=0;const I=()=>{if(null!==D){let T=null;switch(D){case "delete":0<J&&(T={delete:J});J=0;break;case "insert":("object"==typeof K||0<K.length)&&(T={insert:K},0<p.size&&(T.attributes={},p.forEach((O,W)=>{null!==O&&(T.attributes[W]=O)})));K="";break;case "retain":0<H&&(T={retain:H},(O=>{for(const W in O)return!1;return!0})(F)||(T.attributes=assign$$module$libs$y_webrtc_min({},F))),H=0}T&&a.push(T);D=null}};for(;null!==A;){switch(A.content.constructor){case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:this.adds(A)?
this.deletes(A)||(I(),D="insert",K=A.content.getContent()[0],I()):this.deletes(A)?("delete"!==D&&(I(),D="delete"),J+=1):A.deleted||("retain"!==D&&(I(),D="retain"),H+=1);break;case ContentString$$module$libs$y_webrtc_min:this.adds(A)?this.deletes(A)||("insert"!==D&&(I(),D="insert"),K+=A.content.str):this.deletes(A)?("delete"!==D&&(I(),D="delete"),J+=A.length):A.deleted||("retain"!==D&&(I(),D="retain"),H+=A.length);break;case ContentFormat$$module$libs$y_webrtc_min:const {key:T,value:O}=A.content;if(this.adds(A)){if(!this.deletes(A)){var N=
p.get(T)||null;equalAttrs$$module$libs$y_webrtc_min(N,O)?null!==O&&A.delete(g):("retain"===D&&I(),equalAttrs$$module$libs$y_webrtc_min(O,t.get(T)||null)?delete F[T]:F[T]=O)}}else this.deletes(A)?(t.set(T,O),N=p.get(T)||null,equalAttrs$$module$libs$y_webrtc_min(N,O)||("retain"===D&&I(),F[T]=N)):A.deleted||(t.set(T,O),N=F[T],void 0!==N&&(equalAttrs$$module$libs$y_webrtc_min(N,O)?null!==N&&A.delete(g):("retain"===D&&I(),null===O?delete F[T]:F[T]=O)));A.deleted||("insert"===D&&I(),updateCurrentAttributes$$module$libs$y_webrtc_min(p,
A.content))}A=A.right}for(I();0<a.length;){g=a[a.length-1];if(void 0===g.retain||void 0!==g.attributes)break;a.pop()}});this._delta=a}return this._delta}}
class YText$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(a){super();this._pending=void 0!==a?[()=>this.insert(0,a)]:[];this._searchMarker=[]}get length(){return this._length}_integrate(a,g){super._integrate(a,g);try{this._pending.forEach(p=>p())}catch(p){console.error(p)}this._pending=null}_copy(){return new YText$$module$libs$y_webrtc_min}clone(){const a=new YText$$module$libs$y_webrtc_min;return a.applyDelta(this.toDelta()),a}_callObserver(a,g){super._callObserver(a,
g);var p=new YTextEvent$$module$libs$y_webrtc_min(this,a,g);g=a.doc;if(callTypeObservers$$module$libs$y_webrtc_min(this,a,p),!a.local){let t=!1;for(const [A,D]of a.afterState.entries())if(p=a.beforeState.get(A)||0,D!==p&&(iterateStructs$$module$libs$y_webrtc_min(a,g.store.clients.get(A),p,D,F=>{F.deleted||F.content.constructor!==ContentFormat$$module$libs$y_webrtc_min||(t=!0)}),t))break;t||iterateDeletedStructs$$module$libs$y_webrtc_min(a,a.deleteSet,A=>{A instanceof GC$$module$libs$y_webrtc_min||
t||A.parent===this&&A.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&(t=!0)});transact$$module$libs$y_webrtc_min(g,A=>{t?cleanupYTextFormatting$$module$libs$y_webrtc_min(this):iterateDeletedStructs$$module$libs$y_webrtc_min(A,A.deleteSet,D=>{if(!(D instanceof GC$$module$libs$y_webrtc_min)&&D.parent===this){for(;D&&D.right&&(D.right.deleted||!D.right.countable);)D=D.right;const F=new Set;for(;D&&(D.deleted||!D.countable);){if(!D.deleted&&D.content.constructor===ContentFormat$$module$libs$y_webrtc_min){const K=
D.content.key;F.has(K)?D.delete(A):F.add(K)}D=D.left}}})})}}toString(){let a="",g=this._start;for(;null!==g;)!g.deleted&&g.countable&&g.content.constructor===ContentString$$module$libs$y_webrtc_min&&(a+=g.content.str),g=g.right;return a}toJSON(){return this.toString()}applyDelta(a,{sanitize:g=!0}={}){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,p=>{const t=new ItemTextListPosition$$module$libs$y_webrtc_min(null,this._start,0,new Map);for(let A=0;A<a.length;A++){const D=a[A];if(void 0!==
D.insert){const F=g||"string"!=typeof D.insert||A!==a.length-1||null!==t.right||"\n"!==D.insert.slice(-1)?D.insert:D.insert.slice(0,-1);("string"!=typeof F||0<F.length)&&insertText$$module$libs$y_webrtc_min(p,this,t,F,D.attributes||{})}else void 0!==D.retain?formatText$$module$libs$y_webrtc_min(p,this,t,D.retain,D.attributes||{}):void 0!==D.delete&&deleteText$$module$libs$y_webrtc_min(p,t,D.delete)}}):this._pending.push(()=>this.applyDelta(a))}toDelta(a,g,p){function t(){if(0<K.length){const I={};
let N=!1;D.forEach((O,W)=>{N=!0;I[W]=O});const T={insert:K};N&&(T.attributes=I);A.push(T);K=""}}const A=[],D=new Map,F=this.doc;let K="",H=this._start;const J=()=>{for(;null!==H;){if(isVisible$$module$libs$y_webrtc_min(H,a)||void 0!==g&&isVisible$$module$libs$y_webrtc_min(H,g))switch(H.content.constructor){case ContentString$$module$libs$y_webrtc_min:var I=D.get("ychange");void 0===a||isVisible$$module$libs$y_webrtc_min(H,a)?void 0===g||isVisible$$module$libs$y_webrtc_min(H,g)?void 0!==I&&(t(),D.delete("ychange")):
void 0!==I&&I.user===H.id.client&&"added"===I.type||(t(),D.set("ychange",p?p("added",H.id):{type:"added"})):void 0!==I&&I.user===H.id.client&&"removed"===I.type||(t(),D.set("ychange",p?p("removed",H.id):{type:"removed"}));K+=H.content.str;break;case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:t();I={insert:H.content.getContent()[0]};if(0<D.size){const N={};I.attributes=N;D.forEach((T,O)=>{N[O]=T})}A.push(I);break;case ContentFormat$$module$libs$y_webrtc_min:isVisible$$module$libs$y_webrtc_min(H,
a)&&(t(),updateCurrentAttributes$$module$libs$y_webrtc_min(D,H.content))}H=H.right}t()};return a||g?transact$$module$libs$y_webrtc_min(F,I=>{a&&splitSnapshotAffectedStructs$$module$libs$y_webrtc_min(I,a);g&&splitSnapshotAffectedStructs$$module$libs$y_webrtc_min(I,g);J()},"cleanup"):J(),A}insert(a,g,p){if(!(0>=g.length)){var t=this.doc;null!==t?transact$$module$libs$y_webrtc_min(t,A=>{const D=findPosition$$module$libs$y_webrtc_min(A,this,a);p||(p={},D.currentAttributes.forEach((F,K)=>{p[K]=F}));insertText$$module$libs$y_webrtc_min(A,
this,D,g,p)}):this._pending.push(()=>this.insert(a,g,p))}}insertEmbed(a,g,p={}){const t=this.doc;null!==t?transact$$module$libs$y_webrtc_min(t,A=>{const D=findPosition$$module$libs$y_webrtc_min(A,this,a);insertText$$module$libs$y_webrtc_min(A,this,D,g,p)}):this._pending.push(()=>this.insertEmbed(a,g,p))}delete(a,g){if(0!==g){var p=this.doc;null!==p?transact$$module$libs$y_webrtc_min(p,t=>{deleteText$$module$libs$y_webrtc_min(t,findPosition$$module$libs$y_webrtc_min(t,this,a),g)}):this._pending.push(()=>
this.delete(a,g))}}format(a,g,p){if(0!==g){var t=this.doc;null!==t?transact$$module$libs$y_webrtc_min(t,A=>{const D=findPosition$$module$libs$y_webrtc_min(A,this,a);null!==D.right&&formatText$$module$libs$y_webrtc_min(A,this,D,g,p)}):this._pending.push(()=>this.format(a,g,p))}}removeAttribute(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{typeMapDelete$$module$libs$y_webrtc_min(g,this,a)}):this._pending.push(()=>this.removeAttribute(a))}setAttribute(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,
p=>{typeMapSet$$module$libs$y_webrtc_min(p,this,a,g)}):this._pending.push(()=>this.setAttribute(a,g))}getAttribute(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}getAttributes(){return typeMapGetAll$$module$libs$y_webrtc_min(this)}_write(a){a.writeTypeRef(YTextRefID$$module$libs$y_webrtc_min)}}
class YXmlTreeWalker$$module$libs$y_webrtc_min{constructor(a,g=()=>!0){this._filter=g;this._root=a;this._currentNode=a._start;this._firstCall=!0}[Symbol.iterator](){return this}next(){let a=this._currentNode,g=a&&a.content&&a.content.type;if(null!==a&&(!this._firstCall||a.deleted||!this._filter(g))){do if(g=a.content.type,a.deleted||g.constructor!==YXmlElement$$module$libs$y_webrtc_min&&g.constructor!==YXmlFragment$$module$libs$y_webrtc_min||null===g._start)for(;null!==a;){if(null!==a.right){a=a.right;
break}a=a.parent===this._root?null:a.parent._item}else a=g._start;while(null!==a&&(a.deleted||!this._filter(a.content.type)))}return this._firstCall=!1,null===a?{value:void 0,done:!0}:(this._currentNode=a,{value:a.content.type,done:!1})}}
class YXmlFragment$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(){super();this._prelimContent=[]}get firstChild(){const a=this._first;return a?a.content.getContent()[0]:null}_integrate(a,g){super._integrate(a,g);this.insert(0,this._prelimContent);this._prelimContent=null}_copy(){return new YXmlFragment$$module$libs$y_webrtc_min}clone(){const a=new YXmlFragment$$module$libs$y_webrtc_min;return a.insert(0,this.toArray().map(g=>g instanceof AbstractType$$module$libs$y_webrtc_min?
g.clone():g)),a}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(a){return new YXmlTreeWalker$$module$libs$y_webrtc_min(this,a)}querySelector(a){a=a.toUpperCase();const g=(new YXmlTreeWalker$$module$libs$y_webrtc_min(this,p=>p.nodeName&&p.nodeName.toUpperCase()===a)).next();return g.done?null:g.value}querySelectorAll(a){return a=a.toUpperCase(),from$$module$libs$y_webrtc_min(new YXmlTreeWalker$$module$libs$y_webrtc_min(this,g=>g.nodeName&&g.nodeName.toUpperCase()===
a))}_callObserver(a,g){callTypeObservers$$module$libs$y_webrtc_min(this,a,new YXmlEvent$$module$libs$y_webrtc_min(this,g,a))}toString(){return typeListMap$$module$libs$y_webrtc_min(this,a=>a.toString()).join("")}toJSON(){return this.toString()}toDOM(a=document,g={},p){const t=a.createDocumentFragment();return void 0!==p&&p._createAssociation(t,this),typeListForEach$$module$libs$y_webrtc_min(this,A=>{t.insertBefore(A.toDOM(a,g,p),null)}),t}insert(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,
p=>{typeListInsertGenerics$$module$libs$y_webrtc_min(p,this,a,g)}):this._prelimContent.splice(a,0,...g)}insertAfter(a,g){if(null!==this.doc)transact$$module$libs$y_webrtc_min(this.doc,p=>{typeListInsertGenericsAfter$$module$libs$y_webrtc_min(p,this,a&&a instanceof AbstractType$$module$libs$y_webrtc_min?a._item:a,g)});else{const p=this._prelimContent,t=null===a?0:p.findIndex(A=>A===a)+1;if(0===t&&null!==a)throw create$2$$module$libs$y_webrtc_min("Reference item not found");p.splice(t,0,...g)}}delete(a,
g=1){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,p=>{typeListDelete$$module$libs$y_webrtc_min(p,this,a,g)}):this._prelimContent.splice(a,g)}toArray(){return typeListToArray$$module$libs$y_webrtc_min(this)}push(a){this.insert(this.length,a)}unshift(a){this.insert(0,a)}get(a){return typeListGet$$module$libs$y_webrtc_min(this,a)}slice(a=0,g=this.length){return typeListSlice$$module$libs$y_webrtc_min(this,a,g)}forEach(a){typeListForEach$$module$libs$y_webrtc_min(this,a)}_write(a){a.writeTypeRef(YXmlFragmentRefID$$module$libs$y_webrtc_min)}}
class YXmlElement$$module$libs$y_webrtc_min extends YXmlFragment$$module$libs$y_webrtc_min{constructor(a="UNDEFINED"){super();this.nodeName=a;this._prelimAttrs=new Map}get nextSibling(){const a=this._item?this._item.next:null;return a?a.content.type:null}get prevSibling(){const a=this._item?this._item.prev:null;return a?a.content.type:null}_integrate(a,g){super._integrate(a,g);this._prelimAttrs.forEach((p,t)=>{this.setAttribute(t,p)});this._prelimAttrs=null}_copy(){return new YXmlElement$$module$libs$y_webrtc_min(this.nodeName)}clone(){const a=
new YXmlElement$$module$libs$y_webrtc_min(this.nodeName);return((g,p)=>{for(const t in g)p(g[t],t)})(this.getAttributes(),(g,p)=>{"string"==typeof g&&a.setAttribute(p,g)}),a.insert(0,this.toArray().map(g=>g instanceof AbstractType$$module$libs$y_webrtc_min?g.clone():g)),a}toString(){var a=this.getAttributes();const g=[],p=[];for(var t in a)p.push(t);p.sort();t=p.length;for(let A=0;A<t;A++){const D=p[A];g.push(D+'="'+a[D]+'"')}a=this.nodeName.toLocaleLowerCase();return`<${a}${0<g.length?" "+g.join(" "):
""}>${super.toString()}</${a}>`}removeAttribute(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{typeMapDelete$$module$libs$y_webrtc_min(g,this,a)}):this._prelimAttrs.delete(a)}setAttribute(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,p=>{typeMapSet$$module$libs$y_webrtc_min(p,this,a,g)}):this._prelimAttrs.set(a,g)}getAttribute(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}hasAttribute(a){return typeMapHas$$module$libs$y_webrtc_min(this,a)}getAttributes(){return typeMapGetAll$$module$libs$y_webrtc_min(this)}toDOM(a=
document,g={},p){const t=a.createElement(this.nodeName),A=this.getAttributes();for(const D in A){const F=A[D];"string"==typeof F&&t.setAttribute(D,F)}return typeListForEach$$module$libs$y_webrtc_min(this,D=>{t.appendChild(D.toDOM(a,g,p))}),void 0!==p&&p._createAssociation(t,this),t}_write(a){a.writeTypeRef(YXmlElementRefID$$module$libs$y_webrtc_min);a.writeKey(this.nodeName)}}
class YXmlEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g,p){super(a,p);this.childListChanged=!1;this.attributesChanged=new Set;g.forEach(t=>{null===t?this.childListChanged=!0:this.attributesChanged.add(t)})}}
class YXmlHook$$module$libs$y_webrtc_min extends YMap$$module$libs$y_webrtc_min{constructor(a){super();this.hookName=a}_copy(){return new YXmlHook$$module$libs$y_webrtc_min(this.hookName)}clone(){const a=new YXmlHook$$module$libs$y_webrtc_min(this.hookName);return this.forEach((g,p)=>{a.set(p,g)}),a}toDOM(a,g={},p){a=g[this.hookName];let t;return t=void 0!==a?a.createDom(this):document.createElement(this.hookName),t.setAttribute("data-yjs-hook",this.hookName),void 0!==p&&p._createAssociation(t,this),
t}_write(a){a.writeTypeRef(YXmlHookRefID$$module$libs$y_webrtc_min);a.writeKey(this.hookName)}}
class YXmlText$$module$libs$y_webrtc_min extends YText$$module$libs$y_webrtc_min{get nextSibling(){const a=this._item?this._item.next:null;return a?a.content.type:null}get prevSibling(){const a=this._item?this._item.prev:null;return a?a.content.type:null}_copy(){return new YXmlText$$module$libs$y_webrtc_min}clone(){const a=new YXmlText$$module$libs$y_webrtc_min;return a.applyDelta(this.toDelta()),a}toDOM(a=document,g,p){a=a.createTextNode(this.toString());return void 0!==p&&p._createAssociation(a,
this),a}toString(){return this.toDelta().map(a=>{const g=[];for(var p in a.attributes){var t=[];for(var A in a.attributes[p])t.push({key:A,value:a.attributes[p][A]});t.sort((D,F)=>D.key<F.key?-1:1);g.push({nodeName:p,attrs:t})}g.sort((D,F)=>D.nodeName<F.nodeName?-1:1);p="";for(t=0;t<g.length;t++){A=g[t];p+="<"+A.nodeName;for(let D=0;D<A.attrs.length;D++){const F=A.attrs[D];p+=` ${F.key}="${F.value}"`}p+=">"}p+=a.insert;for(a=g.length-1;0<=a;a--)p+=`</${g[a].nodeName}>`;return p}).join("")}toJSON(){return this.toString()}_write(a){a.writeTypeRef(YXmlTextRefID$$module$libs$y_webrtc_min)}}
class AbstractStruct$$module$libs$y_webrtc_min{constructor(a,g){this.id=a;this.length=g}get deleted(){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}write(a,g,p){throw methodUnimplemented$$module$libs$y_webrtc_min();}integrate(a,g){throw methodUnimplemented$$module$libs$y_webrtc_min();}}
class GC$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{get deleted(){return!0}delete(){}mergeWith(a){return this.constructor===a.constructor&&(this.length+=a.length,!0)}integrate(a,g){0<g&&(this.id.clock+=g,this.length-=g);addStruct$$module$libs$y_webrtc_min(a.doc.store,this)}write(a,g){a.writeInfo(0);a.writeLen(this.length-g)}getMissing(a,g){return null}}
class ContentBinary$$module$libs$y_webrtc_min{constructor(a){this.content=a}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ContentBinary$$module$libs$y_webrtc_min(this.content)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){}delete(a){}gc(a){}write(a,g){a.writeBuf(this.content)}getRef(){return 3}}
class ContentDeleted$$module$libs$y_webrtc_min{constructor(a){this.len=a}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ContentDeleted$$module$libs$y_webrtc_min(this.len)}splice(a){const g=new ContentDeleted$$module$libs$y_webrtc_min(this.len-a);return this.len=a,g}mergeWith(a){return this.len+=a.len,!0}integrate(a,g){addToDeleteSet$$module$libs$y_webrtc_min(a.deleteSet,g.id.client,g.id.clock,this.len);g.markDeleted()}delete(a){}gc(a){}write(a,g){a.writeLen(this.len-
g)}getRef(){return 1}}const createDocFromOpts$$module$libs$y_webrtc_min=(a,g)=>new Doc$$module$libs$y_webrtc_min({guid:a,...g,shouldLoad:g.shouldLoad||g.autoLoad||!1});
class ContentDoc$$module$libs$y_webrtc_min{constructor(a){a._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid.");this.doc=a;const g={};this.opts=g;a.gc||(g.gc=!1);a.autoLoad&&(g.autoLoad=!0);null!==a.meta&&(g.meta=a.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ContentDoc$$module$libs$y_webrtc_min(createDocFromOpts$$module$libs$y_webrtc_min(this.doc.guid,this.opts))}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();
}mergeWith(a){return!1}integrate(a,g){this.doc._item=g;a.subdocsAdded.add(this.doc);this.doc.shouldLoad&&a.subdocsLoaded.add(this.doc)}delete(a){a.subdocsAdded.has(this.doc)?a.subdocsAdded.delete(this.doc):a.subdocsRemoved.add(this.doc)}gc(a){}write(a,g){a.writeString(this.doc.guid);a.writeAny(this.opts)}getRef(){return 9}}
class ContentEmbed$$module$libs$y_webrtc_min{constructor(a){this.embed=a}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ContentEmbed$$module$libs$y_webrtc_min(this.embed)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){}delete(a){}gc(a){}write(a,g){a.writeJSON(this.embed)}getRef(){return 5}}
class ContentFormat$$module$libs$y_webrtc_min{constructor(a,g){this.key=a;this.value=g}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ContentFormat$$module$libs$y_webrtc_min(this.key,this.value)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){g.parent._searchMarker=null}delete(a){}gc(a){}write(a,g){a.writeKey(this.key);a.writeJSON(this.value)}getRef(){return 6}}
class ContentJSON$$module$libs$y_webrtc_min{constructor(a){this.arr=a}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentJSON$$module$libs$y_webrtc_min(this.arr)}splice(a){const g=new ContentJSON$$module$libs$y_webrtc_min(this.arr.slice(a));return this.arr=this.arr.slice(0,a),g}mergeWith(a){return this.arr=this.arr.concat(a.arr),!0}integrate(a,g){}delete(a){}gc(a){}write(a,g){const p=this.arr.length;for(a.writeLen(p-g);g<p;g++){const t=
this.arr[g];a.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}
class ContentAny$$module$libs$y_webrtc_min{constructor(a){this.arr=a}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentAny$$module$libs$y_webrtc_min(this.arr)}splice(a){const g=new ContentAny$$module$libs$y_webrtc_min(this.arr.slice(a));return this.arr=this.arr.slice(0,a),g}mergeWith(a){return this.arr=this.arr.concat(a.arr),!0}integrate(a,g){}delete(a){}gc(a){}write(a,g){const p=this.arr.length;for(a.writeLen(p-g);g<p;g++)a.writeAny(this.arr[g])}getRef(){return 8}}
class ContentString$$module$libs$y_webrtc_min{constructor(a){this.str=a}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ContentString$$module$libs$y_webrtc_min(this.str)}splice(a){const g=new ContentString$$module$libs$y_webrtc_min(this.str.slice(a));this.str=this.str.slice(0,a);const p=this.str.charCodeAt(a-1);return 55296<=p&&56319>=p&&(this.str=this.str.slice(0,a-1)+"\ufffd",g.str="\ufffd"+g.str.slice(1)),g}mergeWith(a){return this.str+=
a.str,!0}integrate(a,g){}delete(a){}gc(a){}write(a,g){a.writeString(0===g?this.str:this.str.slice(g))}getRef(){return 4}}
const typeRefs$$module$libs$y_webrtc_min=[a=>new YArray$$module$libs$y_webrtc_min,a=>new YMap$$module$libs$y_webrtc_min,a=>new YText$$module$libs$y_webrtc_min,a=>new YXmlElement$$module$libs$y_webrtc_min(a.readKey()),a=>new YXmlFragment$$module$libs$y_webrtc_min,a=>new YXmlHook$$module$libs$y_webrtc_min(a.readKey()),a=>new YXmlText$$module$libs$y_webrtc_min],YArrayRefID$$module$libs$y_webrtc_min=0,YMapRefID$$module$libs$y_webrtc_min=1,YTextRefID$$module$libs$y_webrtc_min=2,YXmlElementRefID$$module$libs$y_webrtc_min=
3,YXmlFragmentRefID$$module$libs$y_webrtc_min=4,YXmlHookRefID$$module$libs$y_webrtc_min=5,YXmlTextRefID$$module$libs$y_webrtc_min=6;
class ContentType$$module$libs$y_webrtc_min{constructor(a){this.type=a}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ContentType$$module$libs$y_webrtc_min(this.type._copy())}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){this.type._integrate(a.doc,g)}delete(a){let g=this.type._start;for(;null!==g;)g.deleted?a._mergeStructs.push(g):g.delete(a),g=g.right;this.type._map.forEach(p=>{p.deleted?a._mergeStructs.push(p):
p.delete(a)});a.changed.delete(this.type)}gc(a){let g=this.type._start;for(;null!==g;)g.gc(a,!0),g=g.right;this.type._start=null;this.type._map.forEach(p=>{for(;null!==p;)p.gc(a,!0),p=p.left});this.type._map=new Map}write(a,g){this.type._write(a)}getRef(){return 7}}
const followRedone$$module$libs$y_webrtc_min=(a,g)=>{let p=g,t=0;do 0<t&&(p=createID$$module$libs$y_webrtc_min(p.client,p.clock+t)),g=getItem$$module$libs$y_webrtc_min(a,p),t=p.clock-g.id.clock,p=g.redone;while(null!==p&&g instanceof Item$$module$libs$y_webrtc_min);return{item:g,diff:t}},keepItem$$module$libs$y_webrtc_min=(a,g)=>{for(;null!==a&&a.keep!==g;)a.keep=g,a=a.parent._item},splitItem$$module$libs$y_webrtc_min=(a,g,p)=>{const {client:t,clock:A}=g.id,D=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(t,
A+p),g,createID$$module$libs$y_webrtc_min(t,A+p-1),g.right,g.rightOrigin,g.parent,g.parentSub,g.content.splice(p));return g.deleted&&D.markDeleted(),g.keep&&(D.keep=!0),null!==g.redone&&(D.redone=createID$$module$libs$y_webrtc_min(g.redone.client,g.redone.clock+p)),g.right=D,null!==D.right&&(D.right.left=D),a._mergeStructs.push(D),null!==D.parentSub&&null===D.right&&D.parent._map.set(D.parentSub,D),g.length=p,D},isDeletedByUndoStack$$module$libs$y_webrtc_min=(a,g)=>((p,t)=>{for(let A=0;A<p.length;A++)if(t(p[A],
A,p))return!0;return!1})(a,p=>isDeleted$$module$libs$y_webrtc_min(p.deletions,g)),redoItem$$module$libs$y_webrtc_min=(a,g,p,t,A,D)=>{var F=a.doc,K=F.store;F=F.clientID;var H=g.redone;if(null!==H)return getItemCleanStart$$module$libs$y_webrtc_min(a,H);let J=g.parent._item;if(null!==J&&!0===J.deleted){if(null===J.redone&&(!p.has(J)||null===redoItem$$module$libs$y_webrtc_min(a,J,p,t,A,D)))return null;for(;null!==J.redone;)J=getItemCleanStart$$module$libs$y_webrtc_min(a,J.redone)}H=null===J?g.parent:
J.content.type;if(null===g.parentSub){A=g.left;for(p=g;null!==A;){for(t=A;null!==t&&t.parent._item!==J;)t=null===t.redone?null:getItemCleanStart$$module$libs$y_webrtc_min(a,t.redone);if(null!==t&&t.parent._item===J){A=t;break}A=A.left}for(;null!==p;){for(t=p;null!==t&&t.parent._item!==J;)t=null===t.redone?null:getItemCleanStart$$module$libs$y_webrtc_min(a,t.redone);if(null!==t&&t.parent._item===J){p=t;break}p=p.right}}else if(p=null,g.right&&!A){for(A=g;null!==A&&null!==A.right&&(A.right.redone||
isDeleted$$module$libs$y_webrtc_min(t,A.right.id)||isDeletedByUndoStack$$module$libs$y_webrtc_min(D.undoStack,A.right.id)||isDeletedByUndoStack$$module$libs$y_webrtc_min(D.redoStack,A.right.id));)for(A=A.right;A.redone;)A=getItemCleanStart$$module$libs$y_webrtc_min(a,A.redone);if(A&&null!==A.right)return null}else A=H._map.get(g.parentSub)||null;K=getState$$module$libs$y_webrtc_min(K,F);K=createID$$module$libs$y_webrtc_min(F,K);F=new Item$$module$libs$y_webrtc_min(K,A,A&&A.lastId,p,p&&p.id,H,g.parentSub,
g.content.copy());return g.redone=K,keepItem$$module$libs$y_webrtc_min(F,!0),F.integrate(a,0),F};
class Item$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{constructor(a,g,p,t,A,D,F,K){super(a,K.getLength());this.origin=p;this.left=g;this.right=t;this.rightOrigin=A;this.parent=D;this.parentSub=F;this.redone=null;this.content=K;this.info=this.content.isCountable()?2:0}set marker(a){0<(8&this.info)!==a&&(this.info^=8)}get marker(){return 0<(8&this.info)}get keep(){return 0<(1&this.info)}set keep(a){this.keep!==a&&(this.info^=1)}get countable(){return 0<(2&this.info)}get deleted(){return 0<
(4&this.info)}set deleted(a){this.deleted!==a&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(a,g){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=getState$$module$libs$y_webrtc_min(g,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=getState$$module$libs$y_webrtc_min(g,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ID$$module$libs$y_webrtc_min&&
this.id.client!==this.parent.client&&this.parent.clock>=getState$$module$libs$y_webrtc_min(g,this.parent.client))return this.parent.client;(this.origin&&(this.left=getItemCleanEnd$$module$libs$y_webrtc_min(a,g,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=getItemCleanStart$$module$libs$y_webrtc_min(a,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===GC$$module$libs$y_webrtc_min||this.right&&this.right.constructor===GC$$module$libs$y_webrtc_min)&&
(this.parent=null),this.parent)?this.parent.constructor===ID$$module$libs$y_webrtc_min&&(a=getItem$$module$libs$y_webrtc_min(g,this.parent),a.constructor===GC$$module$libs$y_webrtc_min?this.parent=null:this.parent=a.content.type):(this.left&&this.left.constructor===Item$$module$libs$y_webrtc_min&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Item$$module$libs$y_webrtc_min&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub));
return null}integrate(a,g){if(0<g&&(this.id.clock+=g,this.left=getItemCleanEnd$$module$libs$y_webrtc_min(a,a.doc.store,createID$$module$libs$y_webrtc_min(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(g),this.length-=g),this.parent){if(!(this.left||this.right&&null===this.right.left)||this.left&&this.left.right!==this.right){let p=this.left;if(null!==p)g=p.right;else if(null!==this.parentSub)for(g=this.parent._map.get(this.parentSub)||null;null!==g&&
null!==g.left;)g=g.left;else g=this.parent._start;const t=new Set,A=new Set;for(;null!==g&&g!==this.right;){if(A.add(g),t.add(g),compareIDs$$module$libs$y_webrtc_min(this.origin,g.origin))if(g.id.client<this.id.client)p=g,t.clear();else{if(compareIDs$$module$libs$y_webrtc_min(this.rightOrigin,g.rightOrigin))break}else{if(null===g.origin||!A.has(getItem$$module$libs$y_webrtc_min(a.doc.store,g.origin)))break;t.has(getItem$$module$libs$y_webrtc_min(a.doc.store,g.origin))||(p=g,t.clear())}g=g.right}this.left=
p}if(null!==this.left)this.right=this.left.right,this.left.right=this;else{if(null!==this.parentSub)for(g=this.parent._map.get(this.parentSub)||null;null!==g&&null!==g.left;)g=g.left;else g=this.parent._start,this.parent._start=this;this.right=g}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(a));null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length);addStruct$$module$libs$y_webrtc_min(a.doc.store,
this);this.content.integrate(a,this);addChangedTypeToTransaction$$module$libs$y_webrtc_min(a,this.parent,this.parentSub);(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(a)}else(new GC$$module$libs$y_webrtc_min(this.id,this.length)).integrate(a,0)}get next(){let a=this.right;for(;null!==a&&a.deleted;)a=a.right;return a}get prev(){let a=this.left;for(;null!==a&&a.deleted;)a=a.left;return a}get lastId(){return 1===this.length?this.id:createID$$module$libs$y_webrtc_min(this.id.client,
this.id.clock+this.length-1)}mergeWith(a){if(this.constructor===a.constructor&&compareIDs$$module$libs$y_webrtc_min(a.origin,this.lastId)&&this.right===a&&compareIDs$$module$libs$y_webrtc_min(this.rightOrigin,a.rightOrigin)&&this.id.client===a.id.client&&this.id.clock+this.length===a.id.clock&&this.deleted===a.deleted&&null===this.redone&&null===a.redone&&this.content.constructor===a.content.constructor&&this.content.mergeWith(a.content)){const g=this.parent._searchMarker;return g&&g.forEach(p=>{p.p===
a&&(p.p=this,!this.deleted&&this.countable&&(p.index-=this.length))}),a.keep&&(this.keep=!0),this.right=a.right,null!==this.right&&(this.right.left=this),this.length+=a.length,!0}return!1}delete(a){if(!this.deleted){const g=this.parent;this.countable&&null===this.parentSub&&(g._length-=this.length);this.markDeleted();addToDeleteSet$$module$libs$y_webrtc_min(a.deleteSet,this.id.client,this.id.clock,this.length);addChangedTypeToTransaction$$module$libs$y_webrtc_min(a,g,this.parentSub);this.content.delete(a)}}gc(a,
g){if(!this.deleted)throw unexpectedCase$$module$libs$y_webrtc_min();this.content.gc(a);g?(g=new GC$$module$libs$y_webrtc_min(this.id,this.length),a=a.clients.get(this.id.client),a[findIndexSS$$module$libs$y_webrtc_min(a,this.id.clock)]=g):this.content=new ContentDeleted$$module$libs$y_webrtc_min(this.length)}write(a,g){var p=0<g?createID$$module$libs$y_webrtc_min(this.id.client,this.id.clock+g-1):this.origin,t=this.rightOrigin;const A=this.parentSub,D=31&this.content.getRef()|(null===p?0:128)|(null===
t?0:64)|(null===A?0:32);if(a.writeInfo(D),null!==p&&a.writeLeftID(p),null!==t&&a.writeRightID(t),null===p&&null===t)p=this.parent,void 0!==p._item?(t=p._item,null===t?(p=findRootTypeKey$$module$libs$y_webrtc_min(p),a.writeParentInfo(!0),a.writeString(p)):(a.writeParentInfo(!1),a.writeLeftID(t.id))):p.constructor===String?(a.writeParentInfo(!0),a.writeString(p)):p.constructor===ID$$module$libs$y_webrtc_min?(a.writeParentInfo(!1),a.writeLeftID(p)):unexpectedCase$$module$libs$y_webrtc_min(),null!==A&&
a.writeString(A);this.content.write(a,g)}}
const readItemContent$$module$libs$y_webrtc_min=(a,g)=>contentRefs$$module$libs$y_webrtc_min[31&g](a),contentRefs$$module$libs$y_webrtc_min=[()=>{unexpectedCase$$module$libs$y_webrtc_min()},a=>new ContentDeleted$$module$libs$y_webrtc_min(a.readLen()),a=>{const g=a.readLen(),p=[];for(let t=0;t<g;t++){const A=a.readString();"undefined"===A?p.push(void 0):p.push(JSON.parse(A))}return new ContentJSON$$module$libs$y_webrtc_min(p)},a=>new ContentBinary$$module$libs$y_webrtc_min(a.readBuf()),a=>new ContentString$$module$libs$y_webrtc_min(a.readString()),
a=>new ContentEmbed$$module$libs$y_webrtc_min(a.readJSON()),a=>new ContentFormat$$module$libs$y_webrtc_min(a.readKey(),a.readJSON()),a=>new ContentType$$module$libs$y_webrtc_min(typeRefs$$module$libs$y_webrtc_min[a.readTypeRef()](a)),a=>{const g=a.readLen(),p=[];for(let t=0;t<g;t++)p.push(a.readAny());return new ContentAny$$module$libs$y_webrtc_min(p)},a=>new ContentDoc$$module$libs$y_webrtc_min(createDocFromOpts$$module$libs$y_webrtc_min(a.readString(),a.readAny())),()=>{unexpectedCase$$module$libs$y_webrtc_min()}];
class Skip$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{get deleted(){return!0}delete(){}mergeWith(a){return this.constructor===a.constructor&&(this.length+=a.length,!0)}integrate(a,g){unexpectedCase$$module$libs$y_webrtc_min()}write(a,g){a.writeInfo(10);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,this.length-g)}getMissing(a,g){return null}}
const glo$$module$libs$y_webrtc_min="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};!0===glo$$module$libs$y_webrtc_min["__ $YJS$ __"]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");glo$$module$libs$y_webrtc_min["__ $YJS$ __"]=!0;
var commonjsGlobal$$module$libs$y_webrtc_min="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire$$module$libs$y_webrtc_min(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs");}
var simplepeer_min$$module$libs$y_webrtc_min=function(a,g){return a(g={exports:{}},g.exports),g.exports}(function(a,g){var p,t,A;a.exports=(p=Math.floor,t=Math.abs,A=Math.pow,function J(F,K,H){function I(O,W){if(!K[O]){if(!F[O]){if(!W&&commonjsRequire$$module$libs$y_webrtc_min)return commonjsRequire$$module$libs$y_webrtc_min();if(N)return N(O,!0);W=Error("Cannot find module '"+O+"'");throw W.code="MODULE_NOT_FOUND",W;}W=K[O]={exports:{}};F[O][0].call(W.exports,function(ba){return I(F[O][1][ba]||ba)},
W,W.exports,J,F,K,H)}return K[O].exports}for(var N=commonjsRequire$$module$libs$y_webrtc_min,T=0;T<H.length;T++)I(H[T]);return I}({1:[function(F,K,H){function J(O){var W=O.length;if(0<W%4)throw Error("Invalid string. Length must be a multiple of 4");O=O.indexOf("=");return-1===O&&(O=W),[O,O===W?0:4-O%4]}H.byteLength=function(O){O=J(O);var W=O[1];return 3*(O[0]+W)/4-W};H.toByteArray=function(O){var W=J(O);var ba=W[0];W=W[1];var fa=new T(3*(ba+W)/4-W),R=0,da=0<W?ba-4:ba;for(ba=0;ba<da;ba+=4){var ha=
N[O.charCodeAt(ba)]<<18|N[O.charCodeAt(ba+1)]<<12|N[O.charCodeAt(ba+2)]<<6|N[O.charCodeAt(ba+3)];fa[R++]=255&ha>>16;fa[R++]=255&ha>>8;fa[R++]=255&ha}return 2===W&&(ha=N[O.charCodeAt(ba)]<<2|N[O.charCodeAt(ba+1)]>>4,fa[R++]=255&ha),1===W&&(ha=N[O.charCodeAt(ba)]<<10|N[O.charCodeAt(ba+1)]<<4|N[O.charCodeAt(ba+2)]>>2,fa[R++]=255&ha>>8,fa[R++]=255&ha),fa};H.fromByteArray=function(O){for(var W,ba=O.length,fa=ba%3,R=[],da=0,ha=ba-fa;da<ha;da+=16383){for(var ma=R,ka=ma.push,pa,la=O,ta=da+16383>ha?ha:da+
16383,wa=[],za=da;za<ta;za+=3)pa=(16711680&la[za]<<16)+(65280&la[za+1]<<8)+(255&la[za+2]),wa.push(I[63&pa>>18]+I[63&pa>>12]+I[63&pa>>6]+I[63&pa]);pa=wa.join("");ka.call(ma,pa)}return 1===fa?(W=O[ba-1],R.push(I[W>>2]+I[63&W<<4]+"==")):2===fa&&(W=(O[ba-2]<<8)+O[ba-1],R.push(I[W>>10]+I[63&W>>4]+I[63&W<<2]+"=")),R.join("")};var I=[],N=[],T="undefined"==typeof Uint8Array?Array:Uint8Array;for(F=0;64>F;++F)I[F]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[F],N["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(F)]=
F;N[45]=62;N[95]=63},{}],2:[function(){},{}],3:[function(F,K,H){(function(){(function(){function J(L){if(2147483647<L)throw new RangeError('The value "'+L+'" is invalid for option "size"');L=new Uint8Array(L);return L.__proto__=I.prototype,L}function I(L,M,Q){if("number"==typeof L){if("string"==typeof M)throw new TypeError('The "string" argument must be of type string. Received type number');return O(L)}return N(L,M,Q)}function N(L,M,Q){if("string"==typeof L)return function(oa,Ba){if(("string"!=typeof Ba||
""===Ba)&&(Ba="utf8"),!I.isEncoding(Ba))throw new TypeError("Unknown encoding: "+Ba);var ya=0|fa(oa,Ba),aa=J(ya);oa=aa.write(oa,Ba);return oa!==ya&&(aa=aa.slice(0,oa)),aa}(L,M);if(ArrayBuffer.isView(L))return W(L);if(null==L)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(Sa(L,ArrayBuffer)||L&&Sa(L.buffer,ArrayBuffer))return function(oa,Ba,ya){if(0>Ba||oa.byteLength<Ba)throw new RangeError('"offset" is outside of buffer bounds');
if(oa.byteLength<Ba+(ya||0))throw new RangeError('"length" is outside of buffer bounds');var aa;return(aa=void 0===Ba&&void 0===ya?new Uint8Array(oa):void 0===ya?new Uint8Array(oa,Ba):new Uint8Array(oa,Ba,ya)).__proto__=I.prototype,aa}(L,M,Q);if("number"==typeof L)throw new TypeError('The "value" argument must not be of type number. Received type number');var ca=L.valueOf&&L.valueOf();if(null!=ca&&ca!==L)return I.from(ca,M,Q);if(ca=function(oa){if(I.isBuffer(oa)){var Ba=0|ba(oa.length),ya=J(Ba);return 0===
ya.length||oa.copy(ya,0,0,Ba),ya}return void 0===oa.length?"Buffer"===oa.type&&Array.isArray(oa.data)?W(oa.data):void 0:"number"!=typeof oa.length||Ya(oa.length)?J(0):W(oa)}(L))return ca;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof L[Symbol.toPrimitive])return I.from(L[Symbol.toPrimitive]("string"),M,Q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);}function T(L){if("number"!=
typeof L)throw new TypeError('"size" argument must be of type number');if(0>L)throw new RangeError('The value "'+L+'" is invalid for option "size"');}function O(L){return T(L),J(0>L?0:0|ba(L))}function W(L){for(var M=0>L.length?0:0|ba(L.length),Q=J(M),ca=0;ca<M;ca+=1)Q[ca]=255&L[ca];return Q}function ba(L){if(2147483647<=L)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(2147483647).toString(16)+" bytes");return 0|L}function fa(L,M){if(I.isBuffer(L))return L.length;
if(ArrayBuffer.isView(L)||Sa(L,ArrayBuffer))return L.byteLength;if("string"!=typeof L)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);var Q=L.length,ca=2<arguments.length&&!0===arguments[2];if(!ca&&0===Q)return 0;for(var oa=!1;;)switch(M){case "ascii":case "latin1":case "binary":return Q;case "utf8":case "utf-8":return Vb(L).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*Q;case "hex":return Q>>>1;case "base64":return Kb(L).length;
default:if(oa)return ca?-1:Vb(L).length;M=(""+M).toLowerCase();oa=!0}}function R(L,M,Q){var ca=!1;if(((void 0===M||0>M)&&(M=0),M>this.length)||((void 0===Q||Q>this.length)&&(Q=this.length),0>=Q)||(Q>>>=0)<=(M>>>=0))return"";for(L||="utf8";;)switch(L){case "hex":L=M;M=this.length;(!L||0>L)&&(L=0);(!Q||0>Q||Q>M)&&(Q=M);for(M="";L<Q;++L)ca=this[L],ca=16>ca?"0"+ca.toString(16):ca.toString(16),M+=ca;return M;case "utf8":case "utf-8":return pa(this,M,Q);case "ascii":L=M;M="";for(Q=Zb(this.length,Q);L<Q;++L)M+=
uc(127&this[L]);return M;case "latin1":case "binary":L=M;M="";for(Q=Zb(this.length,Q);L<Q;++L)M+=uc(this[L]);return M;case "base64":return L=M,0===L&&Q===this.length?pd.fromByteArray(this):pd.fromByteArray(this.slice(L,Q));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":Q=this.slice(M,Q);L="";for(M=0;M<Q.length;M+=2)L+=uc(Q[M]+256*Q[M+1]);return L;default:if(ca)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase();ca=!0}}function da(L,M,Q){var ca=L[M];L[M]=L[Q];L[Q]=ca}function ha(L,
M,Q,ca,oa){if(0===L.length)return-1;if("string"==typeof Q?(ca=Q,Q=0):2147483647<Q?Q=2147483647:-2147483648>Q&&(Q=-2147483648),Ya(Q=+Q)&&(Q=oa?0:L.length-1),0>Q&&(Q=L.length+Q),Q>=L.length){if(oa)return-1;Q=L.length-1}else if(0>Q){if(!oa)return-1;Q=0}if("string"==typeof M&&(M=I.from(M,ca)),I.isBuffer(M))return 0===M.length?-1:ma(L,M,Q,ca,oa);if("number"==typeof M)return M&=255,"function"==typeof Uint8Array.prototype.indexOf?oa?Uint8Array.prototype.indexOf.call(L,M,Q):Uint8Array.prototype.lastIndexOf.call(L,
M,Q):ma(L,[M],Q,ca,oa);throw new TypeError("val must be string, number or Buffer");}function ma(L,M,Q,ca,oa){function Ba(xa,Oa){return 1===ya?xa[Oa]:xa.readUInt16BE(Oa*ya)}var ya=1,aa=L.length,Y=M.length;if(void 0!==ca&&("ucs2"===(ca=(ca+"").toLowerCase())||"ucs-2"===ca||"utf16le"===ca||"utf-16le"===ca)){if(2>L.length||2>M.length)return-1;ya=2;aa/=2;Y/=2;Q/=2}if(oa)for(ca=-1;Q<aa;Q++)if(Ba(L,Q)!==Ba(M,-1===ca?0:Q-ca))-1!==ca&&(Q-=Q-ca),ca=-1;else{if(-1===ca&&(ca=Q),Q-ca+1===Y)return ca*ya}else for(Q+
Y>aa&&(Q=aa-Y);0<=Q;Q--){aa=!0;for(ca=0;ca<Y;ca++)if(Ba(L,Q+ca)!==Ba(M,ca)){aa=!1;break}if(aa)return Q}return-1}function ka(L,M,Q,ca){for(var oa=[],Ba=0;Ba<M.length;++Ba)oa.push(255&M.charCodeAt(Ba));return Qd(oa,L,Q,ca)}function pa(L,M,Q){Q=Zb(L.length,Q);for(var ca=[];M<Q;){var oa,Ba,ya,aa,Y=L[M],xa=null,Oa=239<Y?4:223<Y?3:191<Y?2:1;M+Oa<=Q&&(1===Oa?128>Y&&(xa=Y):2===Oa?128==(192&(oa=L[M+1]))&&127<(aa=(31&Y)<<6|63&oa)&&(xa=aa):3===Oa?(oa=L[M+1],Ba=L[M+2],128==(192&oa)&&128==(192&Ba)&&2047<(aa=(15&
Y)<<12|(63&oa)<<6|63&Ba)&&(55296>aa||57343<aa)&&(xa=aa)):4===Oa&&(oa=L[M+1],Ba=L[M+2],ya=L[M+3],128==(192&oa)&&128==(192&Ba)&&128==(192&ya)&&65535<(aa=(15&Y)<<18|(63&oa)<<12|(63&Ba)<<6|63&ya)&&1114112>aa&&(xa=aa)));null===xa?(xa=65533,Oa=1):65535<xa&&(xa-=65536,ca.push(55296|1023&xa>>>10),xa=56320|1023&xa);ca.push(xa);M+=Oa}L=ca.length;if(4096>=L)ca=uc.apply(String,ca);else{Q="";for(oa=0;oa<L;)Q+=uc.apply(String,ca.slice(oa,oa+=4096));ca=Q}return ca}function la(L,M,Q){if(0!=L%1||0>L)throw new RangeError("offset is not uint");
if(L+M>Q)throw new RangeError("Trying to access beyond buffer length");}function ta(L,M,Q,ca,oa,Ba){if(!I.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>oa||M<Ba)throw new RangeError('"value" argument is out of bounds');if(Q+ca>L.length)throw new RangeError("Index out of range");}function wa(L,M,Q,ca){if(Q+ca>L.length)throw new RangeError("Index out of range");if(0>Q)throw new RangeError("Index out of range");}function za(L,M,Q,ca,oa){return M=+M,Q>>>=0,oa||wa(L,
0,Q,4),Rb.write(L,M,Q,ca,23,4),Q+4}function Ca(L,M,Q,ca,oa){return M=+M,Q>>>=0,oa||wa(L,0,Q,8),Rb.write(L,M,Q,ca,52,8),Q+8}function Vb(L,M){M=M||1/0;for(var Q,ca=L.length,oa=null,Ba=[],ya=0;ya<ca;++ya){if(55295<(Q=L.charCodeAt(ya))&&57344>Q){if(!oa){if(56319<Q){-1<(M-=3)&&Ba.push(239,191,189);continue}if(ya+1===ca){-1<(M-=3)&&Ba.push(239,191,189);continue}oa=Q;continue}if(56320>Q){-1<(M-=3)&&Ba.push(239,191,189);oa=Q;continue}Q=65536+(oa-55296<<10|Q-56320)}else oa&&-1<(M-=3)&&Ba.push(239,191,189);
if(oa=null,128>Q){if(0>--M)break;Ba.push(Q)}else if(2048>Q){if(0>(M-=2))break;Ba.push(192|Q>>6,128|63&Q)}else if(65536>Q){if(0>(M-=3))break;Ba.push(224|Q>>12,128|63&Q>>6,128|63&Q)}else{if(!(1114112>Q))throw Error("Invalid code point");if(0>(M-=4))break;Ba.push(240|Q>>18,128|63&Q>>12,128|63&Q>>6,128|63&Q)}}return Ba}function Kb(L){var M=pd,Q=M.toByteArray;if(2>(L=(L=L.split("=")[0]).trim().replace(Me,"")).length)L="";else for(;0!=L.length%4;)L+="=";return Q.call(M,L)}function Qd(L,M,Q,ca){for(var oa=
0;oa<ca&&!(oa+Q>=M.length||oa>=L.length);++oa)M[oa+Q]=L[oa];return oa}function Sa(L,M){return L instanceof M||null!=L&&null!=L.constructor&&null!=L.constructor.name&&L.constructor.name===M.name}function Ya(L){return L!=L}var uc=String.fromCharCode,Zb=Math.min,pd=F("base64-js"),Rb=F("ieee754");H.Buffer=I;H.SlowBuffer=function(L){return+L!=L&&(L=0),I.alloc(+L)};H.INSPECT_MAX_BYTES=50;H.kMaxLength=2147483647;I.TYPED_ARRAY_SUPPORT=function(){try{var L=new Uint8Array(1);return L.__proto__={__proto__:Uint8Array.prototype,
foo:function(){return 42}},42===L.foo()}catch(M){return!1}}();I.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(I.prototype,"parent",{enumerable:!0,get:function(){return I.isBuffer(this)?this.buffer:void 0}});Object.defineProperty(I.prototype,"offset",{enumerable:!0,get:function(){return I.isBuffer(this)?
this.byteOffset:void 0}});"undefined"!=typeof Symbol&&null!=Symbol.species&&I[Symbol.species]===I&&Object.defineProperty(I,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1});I.poolSize=8192;I.from=function(L,M,Q){return N(L,M,Q)};I.prototype.__proto__=Uint8Array.prototype;I.__proto__=Uint8Array;I.alloc=function(L,M,Q){return T(L),0>=L||void 0===M?J(L):"string"==typeof Q?J(L).fill(M,Q):J(L).fill(M)};I.allocUnsafe=function(L){return O(L)};I.allocUnsafeSlow=function(L){return O(L)};
I.isBuffer=function(L){return null!=L&&!0===L._isBuffer&&L!==I.prototype};I.compare=function(L,M){if(Sa(L,Uint8Array)&&(L=I.from(L,L.offset,L.byteLength)),Sa(M,Uint8Array)&&(M=I.from(M,M.offset,M.byteLength)),!I.isBuffer(L)||!I.isBuffer(M))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===M)return 0;for(var Q=L.length,ca=M.length,oa=0,Ba=Zb(Q,ca);oa<Ba;++oa)if(L[oa]!==M[oa]){Q=L[oa];ca=M[oa];break}return Q<ca?-1:ca<Q?1:0};I.isEncoding=function(L){switch((L+
"").toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};I.concat=function(L,M){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(0===L.length)return I.alloc(0);var Q;if(void 0===M)for(Q=M=0;Q<L.length;++Q)M+=L[Q].length;M=I.allocUnsafe(M);var ca=0;for(Q=0;Q<L.length;++Q){var oa=L[Q];if(Sa(oa,Uint8Array)&&(oa=I.from(oa)),
!I.isBuffer(oa))throw new TypeError('"list" argument must be an Array of Buffers');oa.copy(M,ca);ca+=oa.length}return M};I.byteLength=fa;I.prototype._isBuffer=!0;I.prototype.swap16=function(){var L=this.length;if(0!=L%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var M=0;M<L;M+=2)da(this,M,M+1);return this};I.prototype.swap32=function(){var L=this.length;if(0!=L%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var M=0;M<L;M+=4)da(this,M,M+3),da(this,
M+1,M+2);return this};I.prototype.swap64=function(){var L=this.length;if(0!=L%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var M=0;M<L;M+=8)da(this,M,M+7),da(this,M+1,M+6),da(this,M+2,M+5),da(this,M+3,M+4);return this};I.prototype.toString=function(){var L=this.length;return 0===L?"":0===arguments.length?pa(this,0,L):R.apply(this,arguments)};I.prototype.toLocaleString=I.prototype.toString;I.prototype.equals=function(L){if(!I.isBuffer(L))throw new TypeError("Argument must be a Buffer");
return this===L||0===I.compare(this,L)};I.prototype.inspect=function(){var L="",M=H.INSPECT_MAX_BYTES;return L=this.toString("hex",0,M).replace(/(.{2})/g,"$1 ").trim(),this.length>M&&(L+=" ... "),"<Buffer "+L+">"};I.prototype.compare=function(L,M,Q,ca,oa){if(Sa(L,Uint8Array)&&(L=I.from(L,L.offset,L.byteLength)),!I.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(void 0===M&&(M=0),void 0===Q&&(Q=L?L.length:0),void 0===ca&&
(ca=0),void 0===oa&&(oa=this.length),0>M||Q>L.length||0>ca||oa>this.length)throw new RangeError("out of range index");if(ca>=oa&&M>=Q)return 0;if(ca>=oa)return-1;if(M>=Q)return 1;if(this===L)return 0;var Ba=(oa>>>=0)-(ca>>>=0),ya=(Q>>>=0)-(M>>>=0),aa=Zb(Ba,ya);ca=this.slice(ca,oa);L=L.slice(M,Q);for(M=0;M<aa;++M)if(ca[M]!==L[M]){Ba=ca[M];ya=L[M];break}return Ba<ya?-1:ya<Ba?1:0};I.prototype.includes=function(L,M,Q){return-1!==this.indexOf(L,M,Q)};I.prototype.indexOf=function(L,M,Q){return ha(this,
L,M,Q,!0)};I.prototype.lastIndexOf=function(L,M,Q){return ha(this,L,M,Q,!1)};I.prototype.write=function(L,M,Q,ca){if(void 0===M)ca="utf8",Q=this.length,M=0;else if(void 0===Q&&"string"==typeof M)ca=M,Q=this.length,M=0;else{if(!isFinite(M))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");M>>>=0;isFinite(Q)?(Q>>>=0,void 0===ca&&(ca="utf8")):(ca=Q,Q=void 0)}var oa=this.length-M;if((void 0===Q||Q>oa)&&(Q=oa),0<L.length&&(0>Q||0>M)||M>this.length)throw new RangeError("Attempt to write outside buffer bounds");
ca||="utf8";for(oa=!1;;)switch(ca){case "hex":a:{M=+M||0;ca=this.length-M;Q?(Q=+Q)>ca&&(Q=ca):Q=ca;ca=L.length;Q>ca/2&&(Q=ca/2);for(oa=0;oa<Q;++oa){if(Ya(ca=parseInt(L.substr(2*oa,2),16))){Q=oa;break a}this[M+oa]=ca}Q=oa}return Q;case "utf8":case "utf-8":return Qd(Vb(L,this.length-M),this,M,Q);case "ascii":return ka(this,L,M,Q);case "latin1":case "binary":return ka(this,L,M,Q);case "base64":return Qd(Kb(L),this,M,Q);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ca=Q;oa=this.length-M;for(var Ba=
[],ya=0;ya<L.length&&!(0>(oa-=2));++ya){var aa=L.charCodeAt(ya);Q=aa>>8;aa%=256;Ba.push(aa);Ba.push(Q)}return Qd(Ba,this,M,ca);default:if(oa)throw new TypeError("Unknown encoding: "+ca);ca=(""+ca).toLowerCase();oa=!0}};I.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};I.prototype.slice=function(L,M){var Q=this.length;0>(L=~~L)?0>(L+=Q)&&(L=0):L>Q&&(L=Q);0>(M=void 0===M?Q:~~M)?0>(M+=Q)&&(M=0):M>Q&&(M=Q);M<L&&(M=L);L=this.subarray(L,M);return L.__proto__=
I.prototype,L};I.prototype.readUIntLE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=this[L];for(var ca=1,oa=0;++oa<M&&(ca*=256);)Q+=this[L+oa]*ca;return Q};I.prototype.readUIntBE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=this[L+--M];for(var ca=1;0<M&&(ca*=256);)Q+=this[L+--M]*ca;return Q};I.prototype.readUInt8=function(L,M){return L>>>=0,M||la(L,1,this.length),this[L]};I.prototype.readUInt16LE=function(L,M){return L>>>=0,M||la(L,2,this.length),this[L]|this[L+1]<<8};I.prototype.readUInt16BE=
function(L,M){return L>>>=0,M||la(L,2,this.length),this[L]<<8|this[L+1]};I.prototype.readUInt32LE=function(L,M){return L>>>=0,M||la(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+16777216*this[L+3]};I.prototype.readUInt32BE=function(L,M){return L>>>=0,M||la(L,4,this.length),16777216*this[L]+(this[L+1]<<16|this[L+2]<<8|this[L+3])};I.prototype.readIntLE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=this[L];for(var ca=1,oa=0;++oa<M&&(ca*=256);)Q+=this[L+oa]*ca;return Q>=128*ca&&(Q-=A(2,
8*M)),Q};I.prototype.readIntBE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=M;for(var ca=1,oa=this[L+--Q];0<Q&&(ca*=256);)oa+=this[L+--Q]*ca;return oa>=128*ca&&(oa-=A(2,8*M)),oa};I.prototype.readInt8=function(L,M){return L>>>=0,M||la(L,1,this.length),128&this[L]?-1*(255-this[L]+1):this[L]};I.prototype.readInt16LE=function(L,M){L>>>=0;M||la(L,2,this.length);L=this[L]|this[L+1]<<8;return 32768&L?4294901760|L:L};I.prototype.readInt16BE=function(L,M){L>>>=0;M||la(L,2,this.length);L=this[L+1]|
this[L]<<8;return 32768&L?4294901760|L:L};I.prototype.readInt32LE=function(L,M){return L>>>=0,M||la(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24};I.prototype.readInt32BE=function(L,M){return L>>>=0,M||la(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]};I.prototype.readFloatLE=function(L,M){return L>>>=0,M||la(L,4,this.length),Rb.read(this,L,!0,23,4)};I.prototype.readFloatBE=function(L,M){return L>>>=0,M||la(L,4,this.length),Rb.read(this,L,!1,23,4)};I.prototype.readDoubleLE=
function(L,M){return L>>>=0,M||la(L,8,this.length),Rb.read(this,L,!0,52,8)};I.prototype.readDoubleBE=function(L,M){return L>>>=0,M||la(L,8,this.length),Rb.read(this,L,!1,52,8)};I.prototype.writeUIntLE=function(L,M,Q,ca){L=+L;M>>>=0;Q>>>=0;ca||ta(this,L,M,Q,A(2,8*Q)-1,0);ca=1;var oa=0;for(this[M]=255&L;++oa<Q&&(ca*=256);)this[M+oa]=255&L/ca;return M+Q};I.prototype.writeUIntBE=function(L,M,Q,ca){L=+L;M>>>=0;Q>>>=0;ca||ta(this,L,M,Q,A(2,8*Q)-1,0);ca=Q-1;var oa=1;for(this[M+ca]=255&L;0<=--ca&&(oa*=256);)this[M+
ca]=255&L/oa;return M+Q};I.prototype.writeUInt8=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,1,255,0),this[M]=255&L,M+1};I.prototype.writeUInt16LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,65535,0),this[M]=255&L,this[M+1]=L>>>8,M+2};I.prototype.writeUInt16BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,65535,0),this[M]=L>>>8,this[M+1]=255&L,M+2};I.prototype.writeUInt32LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,4294967295,0),this[M+3]=L>>>24,this[M+2]=L>>>16,this[M+
1]=L>>>8,this[M]=255&L,M+4};I.prototype.writeUInt32BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,4294967295,0),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4};I.prototype.writeIntLE=function(L,M,Q,ca){(L=+L,M>>>=0,ca)||(ca=A(2,8*Q-1),ta(this,L,M,Q,ca-1,-ca));ca=0;var oa=1,Ba=0;for(this[M]=255&L;++ca<Q&&(oa*=256);)0>L&&0===Ba&&0!==this[M+ca-1]&&(Ba=1),this[M+ca]=255&(L/oa>>0)-Ba;return M+Q};I.prototype.writeIntBE=function(L,M,Q,ca){(L=+L,M>>>=0,ca)||(ca=A(2,8*Q-1),ta(this,
L,M,Q,ca-1,-ca));ca=Q-1;var oa=1,Ba=0;for(this[M+ca]=255&L;0<=--ca&&(oa*=256);)0>L&&0===Ba&&0!==this[M+ca+1]&&(Ba=1),this[M+ca]=255&(L/oa>>0)-Ba;return M+Q};I.prototype.writeInt8=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,1,127,-128),0>L&&(L=255+L+1),this[M]=255&L,M+1};I.prototype.writeInt16LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,32767,-32768),this[M]=255&L,this[M+1]=L>>>8,M+2};I.prototype.writeInt16BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,32767,-32768),this[M]=
L>>>8,this[M+1]=255&L,M+2};I.prototype.writeInt32LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,2147483647,-2147483648),this[M]=255&L,this[M+1]=L>>>8,this[M+2]=L>>>16,this[M+3]=L>>>24,M+4};I.prototype.writeInt32BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,2147483647,-2147483648),0>L&&(L=4294967295+L+1),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4};I.prototype.writeFloatLE=function(L,M,Q){return za(this,L,M,!0,Q)};I.prototype.writeFloatBE=function(L,M,Q){return za(this,
L,M,!1,Q)};I.prototype.writeDoubleLE=function(L,M,Q){return Ca(this,L,M,!0,Q)};I.prototype.writeDoubleBE=function(L,M,Q){return Ca(this,L,M,!1,Q)};I.prototype.copy=function(L,M,Q,ca){if(!I.isBuffer(L))throw new TypeError("argument should be a Buffer");if((Q||=0,ca||0===ca||(ca=this.length),M>=L.length&&(M=L.length),M||=0,0<ca&&ca<Q&&(ca=Q),ca===Q)||0===L.length||0===this.length)return 0;if(0>M)throw new RangeError("targetStart out of bounds");if(0>Q||Q>=this.length)throw new RangeError("Index out of range");
if(0>ca)throw new RangeError("sourceEnd out of bounds");ca>this.length&&(ca=this.length);L.length-M<ca-Q&&(ca=L.length-M+Q);var oa=ca-Q;if(this===L&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(M,Q,ca);else if(this===L&&Q<M&&M<ca)for(ca=oa-1;0<=ca;--ca)L[ca+M]=this[ca+Q];else Uint8Array.prototype.set.call(L,this.subarray(Q,ca),M);return oa};I.prototype.fill=function(L,M,Q,ca){if("string"==typeof L){if("string"==typeof M?(ca=M,M=0,Q=this.length):"string"==typeof Q&&(ca=Q,Q=this.length),
void 0!==ca&&"string"!=typeof ca)throw new TypeError("encoding must be a string");if("string"==typeof ca&&!I.isEncoding(ca))throw new TypeError("Unknown encoding: "+ca);if(1===L.length){var oa=L.charCodeAt(0);("utf8"===ca&&128>oa||"latin1"===ca)&&(L=oa)}}else"number"==typeof L&&(L&=255);if(0>M||this.length<M||this.length<Q)throw new RangeError("Out of range index");if(Q<=M)return this;if(M>>>=0,Q=void 0===Q?this.length:Q>>>0,L||=0,"number"==typeof L)for(ca=M;ca<Q;++ca)this[ca]=L;else{oa=I.isBuffer(L)?
L:I.from(L,ca);var Ba=oa.length;if(0===Ba)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(ca=0;ca<Q-M;++ca)this[ca+M]=oa[ca%Ba]}return this};var Me=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,F("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(F,K,H){(function(J){(function(){H.formatArgs=function(N){if(N[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+N[0]+(this.useColors?"%c ":" ")+"+"+K.exports.humanize(this.diff),this.useColors){var T=
"color: "+this.color;N.splice(1,0,T,"color: inherit");var O=0,W=0;N[0].replace(/%[a-zA-Z%]/g,ba=>{"%%"===ba||(O++,"%c"===ba&&(W=O))});N.splice(W,0,T)}};H.save=function(N){try{N?H.storage.setItem("debug",N):H.storage.removeItem("debug")}catch(T){}};H.load=function(){let N;try{N=H.storage.getItem("debug")}catch(T){}return!N&&void 0!==J&&"env"in J&&(N=J.env.DEBUG),N};H.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||
!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,
10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};a:{try{var I=localStorage;break a}catch(N){}I=void 0}H.storage=I;H.destroy=(()=>{let N=!1;return()=>{N||(N=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();H.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
H.log=console.debug||console.log||(()=>{});K.exports=F("./common")(H);({formatters:I}=K.exports);I.j=function(N){try{return JSON.stringify(N)}catch(T){return"[UnexpectedJSONParseError]: "+T.message}}}).call(this)}).call(this,F("_process"))},{"./common":5,_process:12}],5:[function(F,K){K.exports=function(H){function J(T){function O(...fa){if(O.enabled){var R=+new Date;O.diff=R-(W||R);O.prev=W;W=O.curr=R;fa[0]=J.coerce(fa[0]);"string"!=typeof fa[0]&&fa.unshift("%O");var da=0;fa[0]=fa[0].replace(/%([a-zA-Z%])/g,
(ha,ma)=>{if("%%"===ha)return"%";da++;ma=J.formatters[ma];"function"==typeof ma&&(ha=ma.call(O,fa[da]),fa.splice(da,1),da--);return ha});J.formatArgs.call(O,fa);(O.log||J.log).apply(O,fa)}}let W,ba=null;return O.namespace=T,O.useColors=J.useColors(),O.color=J.selectColor(T),O.extend=I,O.destroy=J.destroy,Object.defineProperty(O,"enabled",{enumerable:!0,configurable:!1,get:()=>null===ba?J.enabled(T):ba,set:fa=>{ba=fa}}),"function"==typeof J.init&&J.init(O),O}function I(T,O){T=J(this.namespace+(void 0===
O?":":O)+T);return T.log=this.log,T}function N(T){return T.toString().substring(2,T.toString().length-2).replace(/\.\*\?$/,"*")}return J.debug=J,J.default=J,J.coerce=function(T){return T instanceof Error?T.stack||T.message:T},J.disable=function(){const T=[...J.names.map(N),...J.skips.map(N).map(O=>"-"+O)].join();return J.enable(""),T},J.enable=function(T){let O;J.save(T);J.names=[];J.skips=[];const W=("string"==typeof T?T:"").split(/[\s,]+/),ba=W.length;for(O=0;O<ba;O++)W[O]&&("-"===(T=W[O].replace(/\*/g,
".*?"))[0]?J.skips.push(new RegExp("^"+T.substr(1)+"$")):J.names.push(new RegExp("^"+T+"$")))},J.enabled=function(T){if("*"===T[T.length-1])return!0;let O,W;O=0;for(W=J.skips.length;O<W;O++)if(J.skips[O].test(T))return!1;O=0;for(W=J.names.length;O<W;O++)if(J.names[O].test(T))return!0;return!1},J.humanize=F("ms"),J.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(H).forEach(T=>
{J[T]=H[T]}),J.names=[],J.skips=[],J.formatters={},J.selectColor=function(T){let O=0;for(let W=0;W<T.length;W++)O=(O<<5)-O+T.charCodeAt(W),O|=0;return J.colors[t(O)%J.colors.length]},J.enable(J.load()),J}},{ms:11}],6:[function(F,K){function H(J,I){for(const N in I)Object.defineProperty(J,N,{value:I[N],enumerable:!0,configurable:!0});return J}K.exports=function(J,I,N){if(!J||"string"==typeof J)throw new TypeError("Please pass an Error to err-code");N||={};"object"==typeof I&&(N=I,I="");I&&(N.code=
I);try{return H(J,N)}catch(T){return N.message=J.message,N.stack=J.stack,I=function(){},I.prototype=Object.create(Object.getPrototypeOf(J)),H(new I,N)}}},{}],7:[function(F,K){function H(){H.init.call(this)}function J(ka){if("function"!=typeof ka)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ka);}function I(ka,pa,la,ta){var wa,za,Ca;if(J(la),void 0===(za=ka._events)?(za=ka._events=Object.create(null),ka._eventsCount=0):(void 0!==za.newListener&&(ka.emit("newListener",
pa,la.listener?la.listener:la),za=ka._events),Ca=za[pa]),void 0===Ca)za[pa]=la,++ka._eventsCount;else if("function"==typeof Ca?Ca=za[pa]=ta?[la,Ca]:[Ca,la]:ta?Ca.unshift(la):Ca.push(la),0<(wa=void 0===ka._maxListeners?H.defaultMaxListeners:ka._maxListeners)&&Ca.length>wa&&!Ca.warned)Ca.warned=!0,la=Error("Possible EventEmitter memory leak detected. "+Ca.length+" "+pa+" listeners added. Use emitter.setMaxListeners() to increase limit"),la.name="MaxListenersExceededWarning",la.emitter=ka,la.type=pa,
la.count=Ca.length,console&&console.warn&&console.warn(la);return ka}function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(ka,pa,la){ka={fired:!1,wrapFn:void 0,target:ka,type:pa,listener:la};pa=N.bind(ka);return pa.listener=la,ka.wrapFn=pa,pa}function O(ka,pa,la){ka=ka._events;if(void 0===ka)return[];pa=ka[pa];if(void 0===pa)la=[];else if("function"==
typeof pa)la=la?[pa.listener||pa]:[pa];else if(la)for(la=Array(pa.length),ka=0;ka<la.length;++ka)la[ka]=pa[ka].listener||pa[ka];else la=ba(pa,pa.length);return la}function W(ka){var pa=this._events;if(void 0!==pa){ka=pa[ka];if("function"==typeof ka)return 1;if(void 0!==ka)return ka.length}return 0}function ba(ka,pa){for(var la=Array(pa),ta=0;ta<pa;++ta)la[ta]=ka[ta];return la}function fa(ka,pa,la,ta){if("function"==typeof ka.on)ta.once?ka.once(pa,la):ka.on(pa,la);else{if("function"!=typeof ka.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+
typeof ka);ka.addEventListener(pa,function Ca(za){ta.once&&ka.removeEventListener(pa,Ca);la(za)})}}var R=(F="object"==typeof Reflect?Reflect:null)&&"function"==typeof F.apply?F.apply:function(ka,pa,la){return Function.prototype.apply.call(ka,pa,la)};var da=F&&"function"==typeof F.ownKeys?F.ownKeys:Object.getOwnPropertySymbols?function(ka){return Object.getOwnPropertyNames(ka).concat(Object.getOwnPropertySymbols(ka))}:function(ka){return Object.getOwnPropertyNames(ka)};var ha=Number.isNaN||function(ka){return ka!=
ka};K.exports=H;K.exports.once=function(ka,pa){return new Promise(function(la,ta){function wa(Ca){ka.removeListener(pa,za);ta(Ca)}function za(){"function"==typeof ka.removeListener&&ka.removeListener("error",wa);la([].slice.call(arguments))}fa(ka,pa,za,{once:!0});"error"!==pa&&function(Ca,Vb,Kb){"function"==typeof Ca.on&&fa(Ca,"error",Vb,Kb)}(ka,wa,{once:!0})})};H.EventEmitter=H;H.prototype._events=void 0;H.prototype._eventsCount=0;H.prototype._maxListeners=void 0;var ma=10;Object.defineProperty(H,
"defaultMaxListeners",{enumerable:!0,get:function(){return ma},set:function(ka){if("number"!=typeof ka||0>ka||ha(ka))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ka+".");ma=ka}});H.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0);this._maxListeners=this._maxListeners||void 0};H.prototype.setMaxListeners=function(ka){if("number"!=
typeof ka||0>ka||ha(ka))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ka+".");return this._maxListeners=ka,this};H.prototype.getMaxListeners=function(){return void 0===this._maxListeners?H.defaultMaxListeners:this._maxListeners};H.prototype.emit=function(ka){for(var pa=[],la=1;la<arguments.length;la++)pa.push(arguments[la]);la="error"===ka;var ta=this._events;if(void 0!==ta)la=la&&void 0===ta.error;else if(!la)return!1;if(la){var wa;if(0<pa.length&&
(wa=pa[0]),wa instanceof Error)throw wa;pa=Error("Unhandled error."+(wa?" ("+wa.message+")":""));throw pa.context=wa,pa;}la=ta[ka];if(void 0===la)return!1;if("function"==typeof la)R(la,this,pa);else for(wa=la.length,ta=ba(la,wa),la=0;la<wa;++la)R(ta[la],this,pa);return!0};H.prototype.addListener=function(ka,pa){return I(this,ka,pa,!1)};H.prototype.on=H.prototype.addListener;H.prototype.prependListener=function(ka,pa){return I(this,ka,pa,!0)};H.prototype.once=function(ka,pa){return J(pa),this.on(ka,
T(this,ka,pa)),this};H.prototype.prependOnceListener=function(ka,pa){return J(pa),this.prependListener(ka,T(this,ka,pa)),this};H.prototype.removeListener=function(ka,pa){var la,ta,wa;if((J(pa),void 0===(ta=this._events))||void 0===(la=ta[ka]))return this;if(la===pa||la.listener===pa)0==--this._eventsCount?this._events=Object.create(null):(delete ta[ka],ta.removeListener&&this.emit("removeListener",ka,la.listener||pa));else if("function"!=typeof la){var za=-1;for(wa=la.length-1;0<=wa;wa--)if(la[wa]===
pa||la[wa].listener===pa){var Ca=la[wa].listener;za=wa;break}if(0>za)return this;if(0===za)la.shift();else{for(;za+1<la.length;za++)la[za]=la[za+1];la.pop()}1===la.length&&(ta[ka]=la[0]);void 0!==ta.removeListener&&this.emit("removeListener",ka,Ca||pa)}return this};H.prototype.off=H.prototype.removeListener;H.prototype.removeAllListeners=function(ka){var pa,la;if(void 0===(la=this._events))return this;if(void 0===la.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=
0):void 0!==la[ka]&&(0==--this._eventsCount?this._events=Object.create(null):delete la[ka]),this;if(0===arguments.length){var ta=Object.keys(la);for(la=0;la<ta.length;++la)"removeListener"!==(pa=ta[la])&&this.removeAllListeners(pa);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(pa=la[ka]))this.removeListener(ka,pa);else if(void 0!==pa)for(la=pa.length-1;0<=la;la--)this.removeListener(ka,pa[la]);return this};H.prototype.listeners=
function(ka){return O(this,ka,!0)};H.prototype.rawListeners=function(ka){return O(this,ka,!1)};H.listenerCount=function(ka,pa){return"function"==typeof ka.listenerCount?ka.listenerCount(pa):W.call(ka,pa)};H.prototype.listenerCount=W;H.prototype.eventNames=function(){return 0<this._eventsCount?da(this._events):[]}},{}],8:[function(F,K){K.exports=function(){if("undefined"==typeof globalThis)return null;var H={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,
RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return H.RTCPeerConnection?H:null}},{}],9:[function(F,K,H){H.read=function(J,I,N,T,O){var W=8*O-T-1;var ba=(1<<W)-1,fa=ba>>1,R=-7;O=N?O-1:0;var da=N?-1:1,ha=J[I+O];O+=da;N=ha&(1<<-R)-1;ha>>=-R;for(R+=W;0<R;N=256*N+J[I+O],O+=da,R-=8);W=N&(1<<-R)-1;N>>=-R;for(R+=
T;0<R;W=256*W+J[I+O],O+=da,R-=8);if(0===N)N=1-fa;else{if(N===ba)return W?NaN:1/0*(ha?-1:1);W+=A(2,T);N-=fa}return(ha?-1:1)*W*A(2,N-T)};H.write=function(J,I,N,T,O,W){var ba,fa,R,da=Math.LN2,ha=Math.log,ma=8*W-O-1,ka=(1<<ma)-1,pa=ka>>1,la=23===O?A(2,-24)-A(2,-77):0;W=T?0:W-1;T=T?1:-1;var ta=0>I||0===I&&0>1/I?1:0;I=t(I);for(isNaN(I)||I===1/0?(fa=isNaN(I)?1:0,ba=ka):(ba=p(ha(I)/da),1>I*(R=A(2,-ba))&&(ba--,R*=2),2<=(I+=1<=ba+pa?la/R:la*A(2,1-pa))*R&&(ba++,R/=2),ba+pa>=ka?(fa=0,ba=ka):1<=ba+pa?(fa=(I*R-
1)*A(2,O),ba+=pa):(fa=I*A(2,pa-1)*A(2,O),ba=0));8<=O;J[N+W]=255&fa,W+=T,fa/=256,O-=8);ba=ba<<O|fa;for(ma+=O;0<ma;J[N+W]=255&ba,W+=T,ba/=256,ma-=8);J[N+W-T]|=128*ta}},{}],10:[function(F,K){K.exports="function"==typeof Object.create?function(H,J){J&&(H.super_=J,H.prototype=Object.create(J.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}))}:function(H,J){if(J){H.super_=J;var I=function(){};I.prototype=J.prototype;H.prototype=new I;H.prototype.constructor=H}}},{}],11:[function(F,
K){function H(I,N,T,O){return J(I/T)+" "+O+(N>=1.5*T?"s":"")}var J=Math.round;K.exports=function(I,N){N=N||{};var T=typeof I;if("string"==T&&0<I.length){a:{if(!(100<(I+="").length)&&(N=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(I))){I=parseFloat(N[1]);N=(N[2]||"ms").toLowerCase();I="years"===N||"year"===N||"yrs"===N||"yr"===N||"y"===N?315576E5*I:"weeks"===N||"week"===N||"w"===N?6048E5*I:"days"===N||"day"===
N||"d"===N?864E5*I:"hours"===N||"hour"===N||"hrs"===N||"hr"===N||"h"===N?36E5*I:"minutes"===N||"minute"===N||"mins"===N||"min"===N||"m"===N?6E4*I:"seconds"===N||"second"===N||"secs"===N||"sec"===N||"s"===N?1E3*I:"milliseconds"===N||"millisecond"===N||"msecs"===N||"msec"===N||"ms"===N?I:void 0;break a}I=void 0}return I}if("number"===T&&isFinite(I))return N.long?(N=t(I),I=864E5<=N?H(I,N,864E5,"day"):36E5<=N?H(I,N,36E5,"hour"):6E4<=N?H(I,N,6E4,"minute"):1E3<=N?H(I,N,1E3,"second"):I+" ms"):(N=t(I),I=
864E5<=N?J(I/864E5)+"d":36E5<=N?J(I/36E5)+"h":6E4<=N?J(I/6E4)+"m":1E3<=N?J(I/1E3)+"s":I+"ms"),I;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(I));}},{}],12:[function(F,K){function H(){throw Error("setTimeout has not been defined");}function J(){throw Error("clearTimeout has not been defined");}function I(ka){if(ba===setTimeout)return setTimeout(ka,0);if((ba===H||!ba)&&setTimeout)return ba=setTimeout,setTimeout(ka,0);try{return ba(ka,0)}catch(pa){try{return ba.call(null,
ka,0)}catch(la){return ba.call(this,ka,0)}}}function N(){ha&&R&&(ha=!1,R.length?da=R.concat(da):ma=-1,da.length&&T())}function T(){if(!ha){var ka=I(N);ha=!0;for(var pa=da.length;pa;){R=da;for(da=[];++ma<pa;)R&&R[ma].run();ma=-1;pa=da.length}R=null;ha=!1;(function(la){if(fa===clearTimeout)return clearTimeout(la);if((fa===J||!fa)&&clearTimeout)return fa=clearTimeout,clearTimeout(la);try{fa(la)}catch(ta){try{return fa.call(null,la)}catch(wa){return fa.call(this,la)}}})(ka)}}function O(ka,pa){this.fun=
ka;this.array=pa}function W(){}F=K.exports={};try{var ba="function"==typeof setTimeout?setTimeout:H}catch(ka){ba=H}try{var fa="function"==typeof clearTimeout?clearTimeout:J}catch(ka){fa=J}!0;var R,da=[],ha=!1,ma=-1;F.nextTick=function(ka){var pa=Array(arguments.length-1);if(1<arguments.length)for(var la=1;la<arguments.length;la++)pa[la-1]=arguments[la];da.push(new O(ka,pa));1!==da.length||ha||I(T)};O.prototype.run=function(){this.fun.apply(null,this.array)};F.title="browser";F.browser=!0;F.env={};
F.argv=[];F.version="";F.versions={};F.on=W;F.addListener=W;F.once=W;F.off=W;F.removeListener=W;F.removeAllListeners=W;F.emit=W;F.prependListener=W;F.prependOnceListener=W;F.listeners=function(){return[]};F.binding=function(){throw Error("process.binding is not supported");};F.cwd=function(){return"/"};F.chdir=function(){throw Error("process.chdir is not supported");};F.umask=function(){return 0}},{}],13:[function(F,K){(function(H){(function(){let J;K.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"==
typeof window?H:window):I=>(J||=Promise.resolve()).then(I).catch(N=>setTimeout(()=>{throw N;},0))}).call(this)}).call(this,void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{}],14:[function(F,K){(function(H,J){(function(){var I=F("safe-buffer").Buffer,N=J.crypto||J.msCrypto;K.exports=N&&N.getRandomValues?function(T,O){if(4294967295<T)throw new RangeError("requested too many random bytes");
var W=I.allocUnsafe(T);if(0<T)if(65536<T)for(var ba=0;ba<T;ba+=65536)N.getRandomValues(W.slice(ba,ba+65536));else N.getRandomValues(W);return"function"==typeof O?H.nextTick(function(){O(null,W)}):W}:function(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11");}}).call(this)}).call(this,F("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},
{_process:12,"safe-buffer":30}],15:[function(F,K){function H(N,T,O){O||=Error;var W=function(ba){function fa(R,da,ha){return ba.call(this,"string"==typeof T?T:T(R,da,ha))||this}return function(R,da){R.prototype=Object.create(da.prototype);R.prototype.constructor=R;R.__proto__=da}(fa,ba),fa}(O);W.prototype.name=O.name;W.prototype.code=N;I[N]=W}function J(N,T){if(Array.isArray(N)){var O=N.length;return N=N.map(function(W){return W+""}),2<O?"one of ".concat(T," ").concat(N.slice(0,O-1).join(", "),", or ")+
N[O-1]:2===O?"one of ".concat(T," ").concat(N[0]," or ").concat(N[1]):"of ".concat(T," ").concat(N[0])}return"of ".concat(T," ").concat(N+"")}var I={};H("ERR_INVALID_OPT_VALUE",function(N,T){return'The value "'+T+'" is invalid for option "'+N+'"'},TypeError);H("ERR_INVALID_ARG_TYPE",function(N,T,O){var W;if("string"==typeof T&&function(fa,R,da){return fa.substr(!da||0>da?0:+da,R.length)===R}(T,"not ")?(W="must not be",T=T.replace(/^not /,"")):W="must be",function(fa,R,da){return(void 0===da||da>fa.length)&&
(da=fa.length),fa.substring(da-R.length,da)===R}(N," argument"))N="The ".concat(N," ").concat(W," ").concat(J(T,"type"));else{var ba=function(fa,R,da){return"number"!=typeof da&&(da=0),!(da+R.length>fa.length)&&-1!==fa.indexOf(R,da)}(N,".")?"property":"argument";N='The "'.concat(N,'" ').concat(ba," ").concat(W," ").concat(J(T,"type"))}return N+=". Received type ".concat(typeof O)},TypeError);H("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");H("ERR_METHOD_NOT_IMPLEMENTED",function(N){return"The "+
N+" method is not implemented"});H("ERR_STREAM_PREMATURE_CLOSE","Premature close");H("ERR_STREAM_DESTROYED",function(N){return"Cannot call "+N+" after a stream was destroyed"});H("ERR_MULTIPLE_CALLBACK","Callback called multiple times");H("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");H("ERR_STREAM_WRITE_AFTER_END","write after end");H("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);H("ERR_UNKNOWN_ENCODING",function(N){return"Unknown encoding: "+N},TypeError);H("ERR_STREAM_UNSHIFT_AFTER_END_EVENT",
"stream.unshift() after end event");K.exports.codes=I},{}],16:[function(F,K){(function(H){(function(){function J(R){return this instanceof J?(O.call(this,R),W.call(this,R),this.allowHalfOpen=!0,void(R&&(!1===R.readable&&(this.readable=!1),!1===R.writable&&(this.writable=!1),!1===R.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",I))))):new J(R)}function I(){this._writableState.ended||H.nextTick(N,this)}function N(R){R.end()}var T=Object.keys||function(R){var da=[],ha;for(ha in R)da.push(ha);
return da};K.exports=J;var O=F("./_stream_readable"),W=F("./_stream_writable");F("inherits")(J,O);for(var ba=T(W.prototype),fa=0;fa<ba.length;fa++)T=ba[fa],J.prototype[T]||(J.prototype[T]=W.prototype[T]);Object.defineProperty(J.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(J.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(J.prototype,
"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(R){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=R,this._writableState.destroyed=R)}})}).call(this)}).call(this,F("_process"))},{"./_stream_readable":18,"./_stream_writable":20,
_process:12,inherits:10}],17:[function(F,K){function H(I){return this instanceof H?void J.call(this,I):new H(I)}K.exports=H;var J=F("./_stream_transform");F("inherits")(H,J);H.prototype._transform=function(I,N,T){T(null,I)}},{"./_stream_transform":19,inherits:10}],18:[function(F,K){(function(H,J){(function(){function I(aa,Y,xa){Ca=Ca||F("./_stream_duplex");aa=aa||{};"boolean"!=typeof xa&&(xa=Y instanceof Ca);this.objectMode=!!aa.objectMode;xa&&(this.objectMode=this.objectMode||!!aa.readableObjectMode);
this.highWaterMark=Me(this,aa,"readableHighWaterMark",xa);this.buffer=new Rb;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.reading=this.endEmitted=this.ended=!1;this.sync=!0;this.resumeScheduled=this.readableListening=this.emittedReadable=this.needReadable=!1;this.paused=!0;this.emitClose=!1!==aa.emitClose;this.autoDestroy=!!aa.autoDestroy;this.destroyed=!1;this.defaultEncoding=aa.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=!1;this.encoding=this.decoder=null;
aa.encoding&&(!uc&&(uc=F("string_decoder/").StringDecoder),this.decoder=new uc(aa.encoding),this.encoding=aa.encoding)}function N(aa){if(Ca=Ca||F("./_stream_duplex"),!(this instanceof N))return new N(aa);this._readableState=new I(aa,this,this instanceof Ca);this.readable=!0;aa&&("function"==typeof aa.read&&(this._read=aa.read),"function"==typeof aa.destroy&&(this._destroy=aa.destroy));Vb.call(this)}function T(aa,Y,xa,Oa,Ob){Ya("readableAddChunk",Y);var Ka=aa._readableState;if(null===Y)Ka.reading=
!1,(Ya("onEofChunk"),Ka.ended)||(Ka.decoder&&(Y=Ka.decoder.end())&&Y.length&&(Ka.buffer.push(Y),Ka.length+=Ka.objectMode?1:Y.length),Ka.ended=!0,Ka.sync?ba(aa):(Ka.needReadable=!1,!Ka.emittedReadable&&(Ka.emittedReadable=!0,fa(aa))));else{if(!Ob){Ob=Y;var Ib;var qc=(Kb.isBuffer(Ob)||Ob instanceof Qd||"string"==typeof Ob||void 0===Ob||Ka.objectMode||(Ib=new M("chunk",["string","Buffer","Uint8Array"],Ob)),Ib)}if(qc)Ba(aa,qc);else if(Ka.objectMode||Y&&0<Y.length)if("string"==typeof Y||Ka.objectMode||
Object.getPrototypeOf(Y)===Kb.prototype||(Y=Kb.from(Y)),Oa)Ka.endEmitted?Ba(aa,new oa):O(aa,Ka,Y,!0);else if(Ka.ended)Ba(aa,new Q);else{if(Ka.destroyed)return!1;Ka.reading=!1;Ka.decoder&&!xa?(Y=Ka.decoder.write(Y),Ka.objectMode||0!==Y.length?O(aa,Ka,Y,!1):R(aa,Ka)):O(aa,Ka,Y,!1)}else Oa||(Ka.reading=!1,R(aa,Ka))}return!Ka.ended&&(Ka.length<Ka.highWaterMark||0===Ka.length)}function O(aa,Y,xa,Oa){Y.flowing&&0===Y.length&&!Y.sync?(Y.awaitDrain=0,aa.emit("data",xa)):(Y.length+=Y.objectMode?1:xa.length,
Oa?Y.buffer.unshift(xa):Y.buffer.push(xa),Y.needReadable&&ba(aa));R(aa,Y)}function W(aa,Y){if(0>=aa||0===Y.length&&Y.ended)aa=0;else if(Y.objectMode)aa=1;else if(aa==aa){if(aa>Y.highWaterMark){var xa=aa;var Oa=(1073741824<=xa?xa=1073741824:(xa--,xa|=xa>>>1,xa|=xa>>>2,xa|=xa>>>4,xa|=xa>>>8,xa|=xa>>>16,xa++),xa);Y.highWaterMark=Oa}aa=aa<=Y.length?aa:Y.ended?Y.length:(Y.needReadable=!0,0)}else aa=Y.flowing&&Y.length?Y.buffer.head.data.length:Y.length;return aa}function ba(aa){var Y=aa._readableState;
Ya("emitReadable",Y.needReadable,Y.emittedReadable);Y.needReadable=!1;Y.emittedReadable||(Ya("emitReadable",Y.flowing),Y.emittedReadable=!0,H.nextTick(fa,aa))}function fa(aa){var Y=aa._readableState;Ya("emitReadable_",Y.destroyed,Y.length,Y.ended);!Y.destroyed&&(Y.length||Y.ended)&&(aa.emit("readable"),Y.emittedReadable=!1);Y.needReadable=!Y.flowing&&!Y.ended&&Y.length<=Y.highWaterMark;pa(aa)}function R(aa,Y){Y.readingMore||(Y.readingMore=!0,H.nextTick(da,aa,Y))}function da(aa,Y){for(;!Y.reading&&
!Y.ended&&(Y.length<Y.highWaterMark||Y.flowing&&0===Y.length);){var xa=Y.length;if(Ya("maybeReadMore read 0"),aa.read(0),xa===Y.length)break}Y.readingMore=!1}function ha(aa){var Y=aa._readableState;Y.readableListening=0<aa.listenerCount("readable");Y.resumeScheduled&&!Y.paused?Y.flowing=!0:0<aa.listenerCount("data")&&aa.resume()}function ma(aa){Ya("readable nexttick read 0");aa.read(0)}function ka(aa,Y){Ya("resume",Y.reading);Y.reading||aa.read(0);Y.resumeScheduled=!1;aa.emit("resume");pa(aa);Y.flowing&&
!Y.reading&&aa.read(0)}function pa(aa){var Y=aa._readableState;for(Ya("flow",Y.flowing);Y.flowing&&null!==aa.read(););}function la(aa,Y){return 0===Y.length?null:(Y.objectMode?xa=Y.buffer.shift():!aa||aa>=Y.length?(xa=Y.decoder?Y.buffer.join(""):1===Y.buffer.length?Y.buffer.first():Y.buffer.concat(Y.length),Y.buffer.clear()):xa=Y.buffer.consume(aa,Y.decoder),xa);var xa}function ta(aa){var Y=aa._readableState;Ya("endReadable",Y.endEmitted);Y.endEmitted||(Y.ended=!0,H.nextTick(wa,Y,aa))}function wa(aa,
Y){if(Ya("endReadableNT",aa.endEmitted,aa.length),!aa.endEmitted&&0===aa.length&&(aa.endEmitted=!0,Y.readable=!1,Y.emit("end"),aa.autoDestroy))aa=Y._writableState,(!aa||aa.autoDestroy&&aa.finished)&&Y.destroy()}function za(aa,Y){for(var xa=0,Oa=aa.length;xa<Oa;xa++)if(aa[xa]===Y)return xa;return-1}var Ca;K.exports=N;N.ReadableState=I;F("events").EventEmitter;var Vb=F("./internal/streams/stream"),Kb=F("buffer").Buffer,Qd=J.Uint8Array||function(){},Sa=F("util");var Ya=Sa&&Sa.debuglog?Sa.debuglog("stream"):
function(){};var uc,Zb,pd,Rb=F("./internal/streams/buffer_list");Sa=F("./internal/streams/destroy");var Me=F("./internal/streams/state").getHighWaterMark,L=F("../errors").codes,M=L.ERR_INVALID_ARG_TYPE,Q=L.ERR_STREAM_PUSH_AFTER_EOF,ca=L.ERR_METHOD_NOT_IMPLEMENTED,oa=L.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;F("inherits")(N,Vb);var Ba=Sa.errorOrDestroy,ya=["error","close","destroy","pause","resume"];Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&
this._readableState.destroyed},set:function(aa){this._readableState&&(this._readableState.destroyed=aa)}});N.prototype.destroy=Sa.destroy;N.prototype._undestroy=Sa.undestroy;N.prototype._destroy=function(aa,Y){Y(aa)};N.prototype.push=function(aa,Y){var xa,Oa=this._readableState;return Oa.objectMode?xa=!0:"string"==typeof aa&&((Y=Y||Oa.defaultEncoding)!==Oa.encoding&&(aa=Kb.from(aa,Y),Y=""),xa=!0),T(this,aa,Y,!1,xa)};N.prototype.unshift=function(aa){return T(this,aa,null,!0,!1)};N.prototype.isPaused=
function(){return!1===this._readableState.flowing};N.prototype.setEncoding=function(aa){uc||=F("string_decoder/").StringDecoder;aa=new uc(aa);this._readableState.decoder=aa;this._readableState.encoding=this._readableState.decoder.encoding;for(var Y=this._readableState.buffer.head,xa="";null!==Y;)xa+=aa.write(Y.data),Y=Y.next;return this._readableState.buffer.clear(),""!==xa&&this._readableState.buffer.push(xa),this._readableState.length=xa.length,this};N.prototype.read=function(aa){Ya("read",aa);
aa=parseInt(aa,10);var Y=this._readableState,xa=aa;if(0!==aa&&(Y.emittedReadable=!1),0===aa&&Y.needReadable&&((0===Y.highWaterMark?0<Y.length:Y.length>=Y.highWaterMark)||Y.ended))return Ya("read: emitReadable",Y.length,Y.ended),0===Y.length&&Y.ended?ta(this):ba(this),null;if(0===(aa=W(aa,Y))&&Y.ended)return 0===Y.length&&ta(this),null;var Oa,Ob=Y.needReadable;return Ya("need readable",Ob),(0===Y.length||Y.length-aa<Y.highWaterMark)&&Ya("length less than watermark",Ob=!0),Y.ended||Y.reading?Ya("reading or ended",
!1):Ob&&(Ya("do read"),Y.reading=!0,Y.sync=!0,0===Y.length&&(Y.needReadable=!0),this._read(Y.highWaterMark),Y.sync=!1,!Y.reading&&(aa=W(xa,Y))),null===(Oa=0<aa?la(aa,Y):null)?(Y.needReadable=Y.length<=Y.highWaterMark,aa=0):(Y.length-=aa,Y.awaitDrain=0),0===Y.length&&(!Y.ended&&(Y.needReadable=!0),xa!==aa&&Y.ended&&ta(this)),null!==Oa&&this.emit("data",Oa),Oa};N.prototype._read=function(){Ba(this,new ca("_read()"))};N.prototype.pipe=function(aa,Y){function xa($b,vc){Ya("onunpipe");$b===$a&&vc&&!1===
vc.hasUnpiped&&(vc.hasUnpiped=!0,Ya("cleanup"),aa.removeListener("close",Ib),aa.removeListener("finish",qc),aa.removeListener("drain",ef),aa.removeListener("error",Ka),aa.removeListener("unpipe",xa),$a.removeListener("end",Oa),$a.removeListener("end",ff),$a.removeListener("data",Ob),lh=!0,wc.awaitDrain&&(!aa._writableState||aa._writableState.needDrain)&&ef())}function Oa(){Ya("onend");aa.end()}function Ob($b){Ya("ondata");$b=aa.write($b);Ya("dest.write",$b);!1===$b&&((1===wc.pipesCount&&wc.pipes===
aa||1<wc.pipesCount&&-1!==za(wc.pipes,aa))&&!lh&&(Ya("false write response, pause",wc.awaitDrain),wc.awaitDrain++),$a.pause())}function Ka($b){Ya("onerror",$b);ff();aa.removeListener("error",Ka);0===aa.listeners("error").length&&Ba(aa,$b)}function Ib(){aa.removeListener("finish",qc);ff()}function qc(){Ya("onfinish");aa.removeListener("close",Ib);ff()}function ff(){Ya("unpipe");$a.unpipe(aa)}var $a=this,wc=this._readableState;switch(wc.pipesCount){case 0:wc.pipes=aa;break;case 1:wc.pipes=[wc.pipes,
aa];break;default:wc.pipes.push(aa)}wc.pipesCount+=1;Ya("pipe count=%d opts=%j",wc.pipesCount,Y);Y=Y&&!1===Y.end||aa===H.stdout||aa===H.stderr?ff:Oa;wc.endEmitted?H.nextTick(Y):$a.once("end",Y);aa.on("unpipe",xa);var ef=function($b){return function(){var vc=$b._readableState;Ya("pipeOnDrain",vc.awaitDrain);vc.awaitDrain&&vc.awaitDrain--;0===vc.awaitDrain&&$b.listeners("data").length&&(vc.flowing=!0,pa($b))}}($a);aa.on("drain",ef);var lh=!1;return $a.on("data",Ob),function($b,vc,he){"function"==typeof $b.prependListener?
$b.prependListener(vc,he):$b._events&&$b._events[vc]?Array.isArray($b._events[vc])?$b._events[vc].unshift(he):$b._events[vc]=[he,$b._events[vc]]:$b.on(vc,he)}(aa,"error",Ka),aa.once("close",Ib),aa.once("finish",qc),aa.emit("pipe",$a),wc.flowing||(Ya("pipe resume"),$a.resume()),aa};N.prototype.unpipe=function(aa){var Y=this._readableState,xa={hasUnpiped:!1};if(0===Y.pipesCount)return this;if(1===Y.pipesCount)return aa&&aa!==Y.pipes||(aa||=Y.pipes,Y.pipes=null,Y.pipesCount=0,Y.flowing=!1,aa&&aa.emit("unpipe",
this,xa)),this;if(!aa){aa=Y.pipes;xa=Y.pipesCount;Y.pipes=null;Y.pipesCount=0;Y.flowing=!1;for(Y=0;Y<xa;Y++)aa[Y].emit("unpipe",this,{hasUnpiped:!1});return this}var Oa=za(Y.pipes,aa);return-1===Oa||(Y.pipes.splice(Oa,1),--Y.pipesCount,1===Y.pipesCount&&(Y.pipes=Y.pipes[0]),aa.emit("unpipe",this,xa)),this};N.prototype.on=function(aa,Y){Y=Vb.prototype.on.call(this,aa,Y);var xa=this._readableState;return"data"===aa?(xa.readableListening=0<this.listenerCount("readable"),!1!==xa.flowing&&this.resume()):
"readable"==aa&&!xa.endEmitted&&!xa.readableListening&&(xa.readableListening=xa.needReadable=!0,xa.flowing=!1,xa.emittedReadable=!1,Ya("on readable",xa.length,xa.reading),xa.length?ba(this):!xa.reading&&H.nextTick(ma,this)),Y};N.prototype.addListener=N.prototype.on;N.prototype.removeListener=function(aa,Y){Y=Vb.prototype.removeListener.call(this,aa,Y);return"readable"===aa&&H.nextTick(ha,this),Y};N.prototype.removeAllListeners=function(aa){var Y=Vb.prototype.removeAllListeners.apply(this,arguments);
return("readable"===aa||void 0===aa)&&H.nextTick(ha,this),Y};N.prototype.resume=function(){var aa=this._readableState;aa.flowing||(Ya("resume"),aa.flowing=!aa.readableListening,aa.resumeScheduled||(aa.resumeScheduled=!0,H.nextTick(ka,this,aa)));return aa.paused=!1,this};N.prototype.pause=function(){return Ya("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Ya("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};N.prototype.wrap=
function(aa){var Y=this,xa=this._readableState,Oa=!1,Ob;for(Ob in aa.on("end",function(){if(Ya("wrapped end"),xa.decoder&&!xa.ended){var Ka=xa.decoder.end();Ka&&Ka.length&&Y.push(Ka)}Y.push(null)}),aa.on("data",function(Ka){Ya("wrapped data");xa.decoder&&(Ka=xa.decoder.write(Ka));xa.objectMode&&null==Ka||!(xa.objectMode||Ka&&Ka.length)||Y.push(Ka)||(Oa=!0,aa.pause())}),aa)void 0===this[Ob]&&"function"==typeof aa[Ob]&&(this[Ob]=function(Ka){return function(){return aa[Ka].apply(aa,arguments)}}(Ob));
for(Ob=0;Ob<ya.length;Ob++)aa.on(ya[Ob],this.emit.bind(this,ya[Ob]));return this._read=function(Ka){Ya("wrapped _read",Ka);Oa&&(Oa=!1,aa.resume())},this};"function"==typeof Symbol&&(N.prototype[Symbol.asyncIterator]=function(){return void 0===Zb&&(Zb=F("./internal/streams/async_iterator")),Zb(this)});Object.defineProperty(N.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(N.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&
this._readableState.buffer}});Object.defineProperty(N.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(aa){this._readableState&&(this._readableState.flowing=aa)}});N._fromList=la;Object.defineProperty(N.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});"function"==typeof Symbol&&(N.from=function(aa,Y){return void 0===pd&&(pd=F("./internal/streams/from")),pd(N,aa,Y)})}).call(this)}).call(this,F("_process"),
void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(F,K){function H(R,da){var ha=
this._transformState;ha.transforming=!1;var ma=ha.writecb;if(null===ma)return this.emit("error",new O);ha.writechunk=null;ha.writecb=null;null!=da&&this.push(da);ma(R);R=this._readableState;R.reading=!1;(R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}function J(R){return this instanceof J?(fa.call(this,R),this._transformState={afterTransform:H.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=
!1,R&&("function"==typeof R.transform&&(this._transform=R.transform),"function"==typeof R.flush&&(this._flush=R.flush)),void this.on("prefinish",I)):new J(R)}function I(){var R=this;"function"!=typeof this._flush||this._readableState.destroyed?N(this,null,null):this._flush(function(da,ha){N(R,da,ha)})}function N(R,da,ha){if(da)return R.emit("error",da);if(null!=ha&&R.push(ha),R._writableState.length)throw new ba;if(R._transformState.transforming)throw new W;return R.push(null)}K.exports=J;K=F("../errors").codes;
var T=K.ERR_METHOD_NOT_IMPLEMENTED,O=K.ERR_MULTIPLE_CALLBACK,W=K.ERR_TRANSFORM_ALREADY_TRANSFORMING,ba=K.ERR_TRANSFORM_WITH_LENGTH_0,fa=F("./_stream_duplex");F("inherits")(J,fa);J.prototype.push=function(R,da){return this._transformState.needTransform=!1,fa.prototype.push.call(this,R,da)};J.prototype._transform=function(R,da,ha){ha(new T("_transform()"))};J.prototype._write=function(R,da,ha){var ma=this._transformState;(ma.writecb=ha,ma.writechunk=R,ma.writeencoding=da,ma.transforming)||(R=this._readableState,
(ma.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark))};J.prototype._read=function(){var R=this._transformState;null===R.writechunk||R.transforming?R.needTransform=!0:(R.transforming=!0,this._transform(R.writechunk,R.writeencoding,R.afterTransform))};J.prototype._destroy=function(R,da){fa.prototype._destroy.call(this,R,function(ha){da(ha)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(F,K){(function(H,J){(function(){function I(M){var Q=this;
this.entry=this.next=null;this.finish=function(){var ca=Q.entry;for(Q.entry=null;ca;){var oa=ca.callback;M.pendingcb--;oa(void 0);ca=ca.next}M.corkedRequestsFree.next=Q;!0}}function N(){}function T(M,Q,ca){ka=ka||F("./_stream_duplex");M=M||{};"boolean"!=typeof ca&&(ca=Q instanceof ka);this.objectMode=!!M.objectMode;ca&&(this.objectMode=this.objectMode||!!M.writableObjectMode);this.highWaterMark=Vb(this,M,"writableHighWaterMark",ca);this.destroyed=this.finished=this.ended=this.ending=this.needDrain=
this.finalCalled=!1;this.decodeStrings=!1!==M.decodeStrings;this.defaultEncoding=M.defaultEncoding||"utf8";this.length=0;this.writing=!1;this.corked=0;this.sync=!0;this.bufferProcessing=!1;this.onwrite=function(oa){ba(Q,oa)};this.writecb=null;this.writelen=0;this.lastBufferedRequest=this.bufferedRequest=null;this.pendingcb=0;this.errorEmitted=this.prefinished=!1;this.emitClose=!1!==M.emitClose;this.autoDestroy=!!M.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new I(this)}function O(M){var Q=
this instanceof(ka=ka||F("./_stream_duplex"));return Q||pa.call(O,this)?(this._writableState=new T(M,this,Q),this.writable=!0,M&&("function"==typeof M.write&&(this._write=M.write),"function"==typeof M.writev&&(this._writev=M.writev),"function"==typeof M.destroy&&(this._destroy=M.destroy),"function"==typeof M.final&&(this._final=M.final)),void ta.call(this)):new O(M)}function W(M,Q,ca,oa,Ba,ya,aa){Q.writelen=oa;Q.writecb=aa;Q.writing=!0;Q.sync=!0;Q.destroyed?Q.onwrite(new Zb("write")):ca?M._writev(Ba,
Q.onwrite):M._write(Ba,ya,Q.onwrite);Q.sync=!1}function ba(M,Q){var ca=M._writableState,oa=ca.sync,Ba=ca.writecb;if("function"!=typeof Ba)throw new Ya;(function(ya){ya.writing=!1;ya.writecb=null;ya.length-=ya.writelen;ya.writelen=0}(ca),Q)?!function(ya,aa,Y,xa,Oa){--aa.pendingcb;Y?(H.nextTick(Oa,xa),H.nextTick(ma,ya,aa),ya._writableState.errorEmitted=!0,L(ya,xa)):(Oa(xa),ya._writableState.errorEmitted=!0,L(ya,xa),ma(ya,aa))}(M,ca,oa,Q,Ba):((Q=da(ca)||M.destroyed)||ca.corked||ca.bufferProcessing||
!ca.bufferedRequest||R(M,ca),oa?H.nextTick(fa,M,ca,Q,Ba):fa(M,ca,Q,Ba))}function fa(M,Q,ca,oa){ca||0===Q.length&&Q.needDrain&&(Q.needDrain=!1,M.emit("drain"));Q.pendingcb--;oa();ma(M,Q)}function R(M,Q){Q.bufferProcessing=!0;var ca=Q.bufferedRequest;if(M._writev&&ca&&ca.next){var oa=Array(Q.bufferedRequestCount),Ba=Q.corkedRequestsFree;Ba.entry=ca;for(var ya=0,aa=!0;ca;)oa[ya]=ca,ca.isBuf||(aa=!1),ca=ca.next,ya+=1;oa.allBuffers=aa;W(M,Q,!0,Q.length,oa,"",Ba.finish);Q.pendingcb++;Q.lastBufferedRequest=
null;Ba.next?(Q.corkedRequestsFree=Ba.next,Ba.next=null):Q.corkedRequestsFree=new I(Q);Q.bufferedRequestCount=0}else{for(;ca&&(oa=ca.chunk,W(M,Q,!1,Q.objectMode?1:oa.length,oa,ca.encoding,ca.callback),ca=ca.next,Q.bufferedRequestCount--,!Q.writing););null===ca&&(Q.lastBufferedRequest=null)}Q.bufferedRequest=ca;Q.bufferProcessing=!1}function da(M){return M.ending&&0===M.length&&null===M.bufferedRequest&&!M.finished&&!M.writing}function ha(M,Q){M._final(function(ca){Q.pendingcb--;ca&&L(M,ca);Q.prefinished=
!0;M.emit("prefinish");ma(M,Q)})}function ma(M,Q){var ca=da(Q),oa;if(oa=ca)Q.prefinished||Q.finalCalled||("function"!=typeof M._final||Q.destroyed?(Q.prefinished=!0,M.emit("prefinish")):(Q.pendingcb++,Q.finalCalled=!0,H.nextTick(ha,M,Q))),oa=0===Q.pendingcb&&(Q.finished=!0,M.emit("finish"),Q.autoDestroy);oa&&(Q=M._readableState,(!Q||Q.autoDestroy&&Q.endEmitted)&&M.destroy());return ca}var ka;K.exports=O;O.WritableState=T;var pa,la={deprecate:F("util-deprecate")},ta=F("./internal/streams/stream"),
wa=F("buffer").Buffer,za=J.Uint8Array||function(){},Ca=F("./internal/streams/destroy"),Vb=F("./internal/streams/state").getHighWaterMark,Kb=F("../errors").codes,Qd=Kb.ERR_INVALID_ARG_TYPE,Sa=Kb.ERR_METHOD_NOT_IMPLEMENTED,Ya=Kb.ERR_MULTIPLE_CALLBACK,uc=Kb.ERR_STREAM_CANNOT_PIPE,Zb=Kb.ERR_STREAM_DESTROYED,pd=Kb.ERR_STREAM_NULL_VALUES,Rb=Kb.ERR_STREAM_WRITE_AFTER_END,Me=Kb.ERR_UNKNOWN_ENCODING,L=Ca.errorOrDestroy;F("inherits")(O,ta);T.prototype.getBuffer=function(){for(var M=this.bufferedRequest,Q=[];M;)Q.push(M),
M=M.next;return Q};(function(){try{Object.defineProperty(T.prototype,"buffer",{get:la.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(M){}})();"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(pa=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(M){return!!pa.call(this,M)||this===O&&M&&M._writableState instanceof
T}})):pa=function(M){return M instanceof this};O.prototype.pipe=function(){L(this,new uc)};O.prototype.write=function(M,Q,ca){var oa=this._writableState,Ba=!1,ya;if(ya=!oa.objectMode)ya=M,ya=wa.isBuffer(ya)||ya instanceof za;ya&&!wa.isBuffer(M)&&(M=wa.from(M));"function"==typeof Q&&(ca=Q,Q=null);ya?Q="buffer":!Q&&(Q=oa.defaultEncoding);"function"!=typeof ca&&(ca=N);if(oa.ending)oa=ca,ca=new Rb,L(this,ca),H.nextTick(oa,ca);else{var aa;if(!(aa=ya)){var Y=M,xa=ca,Oa;aa=(null===Y?Oa=new pd:"string"!=
typeof Y&&!oa.objectMode&&(Oa=new Qd("chunk",["string","Buffer"],Y)),!Oa||(L(this,Oa),H.nextTick(xa,Oa),!1))}aa&&(oa.pendingcb++,Ba=ya,Ba||(ya=M,Oa=(oa.objectMode||!1===oa.decodeStrings||"string"!=typeof ya||(ya=wa.from(ya,Q)),ya),M!==Oa&&(Ba=!0,Q="buffer",M=Oa)),ya=oa.objectMode?1:M.length,oa.length+=ya,Oa=oa.length<oa.highWaterMark,(Oa||(oa.needDrain=!0),oa.writing||oa.corked)?(ya=oa.lastBufferedRequest,oa.lastBufferedRequest={chunk:M,encoding:Q,isBuf:Ba,callback:ca,next:null},ya?ya.next=oa.lastBufferedRequest:
oa.bufferedRequest=oa.lastBufferedRequest,oa.bufferedRequestCount+=1):W(this,oa,!1,ya,M,Q,ca),Ba=Oa)}return Ba};O.prototype.cork=function(){this._writableState.corked++};O.prototype.uncork=function(){var M=this._writableState;M.corked&&(M.corked--,!M.writing&&!M.corked&&!M.bufferProcessing&&M.bufferedRequest&&R(this,M))};O.prototype.setDefaultEncoding=function(M){if("string"==typeof M&&(M=M.toLowerCase()),!(-1<"hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw".split(" ").indexOf((M+
"").toLowerCase())))throw new Me(M);return this._writableState.defaultEncoding=M,this};Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});O.prototype._write=function(M,Q,ca){ca(new Sa("_write()"))};O.prototype._writev=null;O.prototype.end=function(M,Q,ca){var oa=this._writableState;
"function"==typeof M?(ca=M,M=null,Q=null):"function"==typeof Q&&(ca=Q,Q=null);null!=M&&this.write(M,Q);oa.corked&&(oa.corked=1,this.uncork());oa.ending||(M=ca,oa.ending=!0,ma(this,oa),M&&(oa.finished?H.nextTick(M):this.once("finish",M)),oa.ended=!0,this.writable=!1);return this};Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&
this._writableState.destroyed},set:function(M){this._writableState&&(this._writableState.destroyed=M)}});O.prototype.destroy=Ca.destroy;O.prototype._undestroy=Ca.undestroy;O.prototype._destroy=function(M,Q){Q(M)}}).call(this)}).call(this,F("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,
"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(F,K){(function(H){(function(){function J(ta,wa,za){return wa in ta?Object.defineProperty(ta,wa,{value:za,enumerable:!0,configurable:!0,writable:!0}):ta[wa]=za,ta}function I(ta,wa){return{value:ta,done:wa}}function N(ta){var wa=ta[ba];if(null!==wa){var za=ta[ka].read();null!==za&&(ta[ha]=null,ta[ba]=null,ta[fa]=null,wa(I(za,!1)))}}function T(ta){H.nextTick(N,ta)}var O,W=F("./end-of-stream"),ba=Symbol("lastResolve"),
fa=Symbol("lastReject"),R=Symbol("error"),da=Symbol("ended"),ha=Symbol("lastPromise"),ma=Symbol("handlePromise"),ka=Symbol("stream"),pa=Object.getPrototypeOf(function(){}),la=Object.setPrototypeOf((O={get stream(){return this[ka]},next:function(){var ta=this,wa=this[R];if(null!==wa)return Promise.reject(wa);if(this[da])return Promise.resolve(I(void 0,!0));if(this[ka].destroyed)return new Promise(function(za,Ca){H.nextTick(function(){ta[R]?Ca(ta[R]):za(I(void 0,!0))})});if(wa=this[ha])wa=new Promise(function(za,
Ca){return function(Vb,Kb){za.then(function(){return Ca[da]?void Vb(I(void 0,!0)):void Ca[ma](Vb,Kb)},Kb)}}(wa,this));else{wa=this[ka].read();if(null!==wa)return Promise.resolve(I(wa,!1));wa=new Promise(this[ma])}return this[ha]=wa,wa}},J(O,Symbol.asyncIterator,function(){return this}),J(O,"return",function(){var ta=this;return new Promise(function(wa,za){ta[ka].destroy(null,function(Ca){return Ca?void za(Ca):void wa(I(void 0,!0))})})}),O),pa);K.exports=function(ta){var wa,za=Object.create(la,(J(wa=
{},ka,{value:ta,writable:!0}),J(wa,ba,{value:null,writable:!0}),J(wa,fa,{value:null,writable:!0}),J(wa,R,{value:null,writable:!0}),J(wa,da,{value:ta._readableState.endEmitted,writable:!0}),J(wa,ma,{value:function(Ca,Vb){var Kb=za[ka].read();Kb?(za[ha]=null,za[ba]=null,za[fa]=null,Ca(I(Kb,!1))):(za[ba]=Ca,za[fa]=Vb)},writable:!0}),wa));return za[ha]=null,W(ta,function(Ca){if(Ca&&"ERR_STREAM_PREMATURE_CLOSE"!==Ca.code){var Vb=za[fa];return null!==Vb&&(za[ha]=null,za[ba]=null,za[fa]=null,Vb(Ca)),void(za[R]=
Ca)}Ca=za[ba];null!==Ca&&(za[ha]=null,za[ba]=null,za[fa]=null,Ca(I(void 0,!0)));za[da]=!0}),ta.on("readable",T.bind(null,za)),za}}).call(this)}).call(this,F("_process"))},{"./end-of-stream":24,_process:12}],22:[function(F,K){function H(O,W){var ba=Object.keys(O);if(Object.getOwnPropertySymbols){var fa=Object.getOwnPropertySymbols(O);W&&(fa=fa.filter(function(R){return Object.getOwnPropertyDescriptor(O,R).enumerable}));ba.push.apply(ba,fa)}return ba}function J(O,W){for(var ba,fa=0;fa<W.length;fa++)(ba=
W[fa]).enumerable=ba.enumerable||!1,ba.configurable=!0,"value"in ba&&(ba.writable=!0),Object.defineProperty(O,ba.key,ba)}var I=F("buffer").Buffer,N=F("util").inspect,T=N&&N.custom||"inspect";K.exports=function(){function O(){if(!(this instanceof O))throw new TypeError("Cannot call a class as a function");this.tail=this.head=null;this.length=0}return function(W,ba,fa){ba&&J(W.prototype,ba);fa&&J(W,fa)}(O,[{key:"push",value:function(W){W={data:W,next:null};0<this.length?this.tail.next=W:this.head=W;
this.tail=W;++this.length}},{key:"unshift",value:function(W){W={data:W,next:this.head};0===this.length&&(this.tail=W);this.head=W;++this.length}},{key:"shift",value:function(){if(0!==this.length){var W=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,W}}},{key:"clear",value:function(){this.head=this.tail=null;this.length=0}},{key:"join",value:function(W){if(0===this.length)return"";for(var ba=this.head,fa=""+ba.data;ba=ba.next;)fa+=W+ba.data;return fa}},
{key:"concat",value:function(W){if(0===this.length)return I.alloc(0);W=I.allocUnsafe(W>>>0);for(var ba=this.head,fa=0;ba;)I.prototype.copy.call(ba.data,W,fa),fa+=ba.data.length,ba=ba.next;return W}},{key:"consume",value:function(W,ba){var fa;return W<this.head.data.length?(fa=this.head.data.slice(0,W),this.head.data=this.head.data.slice(W)):fa=W===this.head.data.length?this.shift():ba?this._getString(W):this._getBuffer(W),fa}},{key:"first",value:function(){return this.head.data}},{key:"_getString",
value:function(W){var ba=this.head,fa=1,R=ba.data;for(W-=R.length;ba=ba.next;){var da=ba.data,ha=W>da.length?da.length:W;if(R+=ha===da.length?da:da.slice(0,W),0==(W-=ha)){ha===da.length?(++fa,this.head=ba.next?ba.next:this.tail=null):(this.head=ba,ba.data=da.slice(ha));break}++fa}return this.length-=fa,R}},{key:"_getBuffer",value:function(W){var ba=I.allocUnsafe(W),fa=this.head,R=1;fa.data.copy(ba);for(W-=fa.data.length;fa=fa.next;){var da=fa.data,ha=W>da.length?da.length:W;if(da.copy(ba,ba.length-
W,0,ha),0==(W-=ha)){ha===da.length?(++R,this.head=fa.next?fa.next:this.tail=null):(this.head=fa,fa.data=da.slice(ha));break}++R}return this.length-=R,ba}},{key:T,value:function(W,ba){return N(this,function(fa){for(var R,da=1;da<arguments.length;da++)R=null==arguments[da]?{}:arguments[da],da%2?H(Object(R),!0).forEach(function(ha){var ma=R[ha];ha in fa?Object.defineProperty(fa,ha,{value:ma,enumerable:!0,configurable:!0,writable:!0}):fa[ha]=ma}):Object.getOwnPropertyDescriptors?Object.defineProperties(fa,
Object.getOwnPropertyDescriptors(R)):H(Object(R)).forEach(function(ha){Object.defineProperty(fa,ha,Object.getOwnPropertyDescriptor(R,ha))});return fa}({},ba,{depth:0,customInspect:!1}))}}]),O}()},{buffer:3,util:2}],23:[function(F,K){(function(H){(function(){function J(T,O){N(T,O);I(T)}function I(T){T._writableState&&!T._writableState.emitClose||T._readableState&&!T._readableState.emitClose||T.emit("close")}function N(T,O){T.emit("error",O)}K.exports={destroy:function(T,O){var W=this,ba=this._writableState&&
this._writableState.destroyed;return this._readableState&&this._readableState.destroyed||ba?(O?O(T):T&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,H.nextTick(N,this,T)):H.nextTick(N,this,T)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(T||null,function(fa){!O&&fa?W._writableState?W._writableState.errorEmitted?H.nextTick(I,W):(W._writableState.errorEmitted=!0,H.nextTick(J,
W,fa)):H.nextTick(J,W,fa):O?(H.nextTick(I,W),O(fa)):H.nextTick(I,W)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1);this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},
errorOrDestroy:function(T,O){var W=T._readableState,ba=T._writableState;W&&W.autoDestroy||ba&&ba.autoDestroy?T.destroy(O):T.emit("error",O)}}}).call(this)}).call(this,F("_process"))},{_process:12}],24:[function(F,K){function H(){}var J=F("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;K.exports=function W(N,T,O){if("function"==typeof T)return W(N,null,T);T||={};O=function(wa){var za=!1;return function(){if(!za){za=!0;for(var Ca=arguments.length,Vb=Array(Ca),Kb=0;Kb<Ca;Kb++)Vb[Kb]=arguments[Kb];
wa.apply(this,Vb)}}}(O||H);var ba=T.readable||!1!==T.readable&&N.readable,fa=T.writable||!1!==T.writable&&N.writable,R=function(){N.writable||ha()},da=N._writableState&&N._writableState.finished,ha=function(){fa=!1;da=!0;ba||O.call(N)},ma=N._readableState&&N._readableState.endEmitted,ka=function(){ba=!1;ma=!0;fa||O.call(N)},pa=function(wa){O.call(N,wa)},la=function(){var wa;return ba&&!ma?(N._readableState&&N._readableState.ended||(wa=new J),O.call(N,wa)):fa&&!da?(N._writableState&&N._writableState.ended||
(wa=new J),O.call(N,wa)):void 0},ta=function(){N.req.on("finish",ha)};return N.setHeader&&"function"==typeof N.abort?(N.on("complete",ha),N.on("abort",la),N.req?ta():N.on("request",ta)):fa&&!N._writableState&&(N.on("end",R),N.on("close",R)),N.on("end",ka),N.on("finish",ha),!1!==T.error&&N.on("error",pa),N.on("close",la),function(){N.removeListener("complete",ha);N.removeListener("abort",la);N.removeListener("request",ta);N.req&&N.req.removeListener("finish",ha);N.removeListener("end",R);N.removeListener("close",
R);N.removeListener("finish",ha);N.removeListener("end",ka);N.removeListener("error",pa);N.removeListener("close",la)}}},{"../../../errors":15}],25:[function(F,K){K.exports=function(){throw Error("Readable.from is not available in the browser");}},{}],26:[function(F,K){function H(fa){if(fa)throw fa;}function J(fa,R,da,ha){ha=function(pa){var la=!1;return function(){la||(la=!0,pa.apply(void 0,arguments))}}(ha);var ma=!1;fa.on("close",function(){ma=!0});void 0===T&&(T=F("./end-of-stream"));T(fa,{readable:R,
writable:da},function(pa){return pa?ha(pa):(ma=!0,void ha())});var ka=!1;return function(pa){if(!ma)return ka?void 0:(ka=!0,fa.setHeader&&"function"==typeof fa.abort?fa.abort():"function"==typeof fa.destroy?fa.destroy():void ha(pa||new ba("pipe")))}}function I(fa){fa()}function N(fa,R){return fa.pipe(R)}var T,O=F("../../../errors").codes,W=O.ERR_MISSING_ARGS,ba=O.ERR_STREAM_DESTROYED;K.exports=function(){for(var fa=arguments.length,R=Array(fa),da=0;da<fa;da++)R[da]=arguments[da];var ha=R.length&&
"function"==typeof R[R.length-1]?R.pop():H;if(Array.isArray(R[0])&&(R=R[0]),2>R.length)throw new W("streams");var ma,ka=R.map(function(pa,la){var ta=la<R.length-1;return J(pa,ta,0<la,function(wa){ma||=wa;wa&&ka.forEach(I);ta||(ka.forEach(I),ha(ma))})});return R.reduce(N)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(F,K){var H=F("../../../errors").codes.ERR_INVALID_OPT_VALUE;K.exports={getHighWaterMark:function(J,I,N,T){I=null==I.highWaterMark?T?I[N]:null:I.highWaterMark;if(null!=I){if(!isFinite(I)||
p(I)!==I||0>I)throw new H(T?N:"highWaterMark",I);return p(I)}return J.objectMode?16:16384}}},{"../../../errors":15}],28:[function(F,K){K.exports=F("events").EventEmitter},{events:7}],29:[function(F,K,H){(H=K.exports=F("./lib/_stream_readable.js")).Stream=H;H.Readable=H;H.Writable=F("./lib/_stream_writable.js");H.Duplex=F("./lib/_stream_duplex.js");H.Transform=F("./lib/_stream_transform.js");H.PassThrough=F("./lib/_stream_passthrough.js");H.finished=F("./lib/internal/streams/end-of-stream.js");H.pipeline=
F("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(F,K,H){function J(O,W){for(var ba in O)W[ba]=O[ba]}function I(O,W,ba){return T(O,W,ba)}var N=F("buffer"),T=N.Buffer;T.from&&T.alloc&&T.allocUnsafe&&T.allocUnsafeSlow?K.exports=N:(J(N,H),H.Buffer=I);I.prototype=
Object.create(T.prototype);J(T,I);I.from=function(O,W,ba){if("number"==typeof O)throw new TypeError("Argument must not be a number");return T(O,W,ba)};I.alloc=function(O,W,ba){if("number"!=typeof O)throw new TypeError("Argument must be a number");O=T(O);return void 0===W?O.fill(0):"string"==typeof ba?O.fill(W,ba):O.fill(W),O};I.allocUnsafe=function(O){if("number"!=typeof O)throw new TypeError("Argument must be a number");return T(O)};I.allocUnsafeSlow=function(O){if("number"!=typeof O)throw new TypeError("Argument must be a number");
return N.SlowBuffer(O)}},{buffer:3}],31:[function(F,K,H){function J(ma){switch(this.encoding=function(ka){var pa=function(la){if(!la)return"utf8";for(var ta;;)switch(la){case "utf8":case "utf-8":return"utf8";case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return"utf16le";case "latin1":case "binary":return"latin1";case "base64":case "ascii":case "hex":return la;default:if(ta)return;la=(""+la).toLowerCase();ta=!0}}(ka);if("string"!=typeof pa&&(da.isEncoding===ha||!ha(ka)))throw Error("Unknown encoding: "+
ka);return pa||ka}(ma),this.encoding){case "utf16le":this.text=T;this.end=O;ma=4;break;case "utf8":this.fillLast=N;ma=4;break;case "base64":this.text=W;this.end=ba;ma=3;break;default:return this.write=fa,void(this.end=R)}this.lastTotal=this.lastNeed=0;this.lastChar=da.allocUnsafe(ma)}function I(ma){return 127>=ma?0:6==ma>>5?2:14==ma>>4?3:30==ma>>3?4:2==ma>>6?-1:-2}function N(ma){var ka=this.lastTotal-this.lastNeed;a:if(128!=(192&ma[0]))var pa=(this.lastNeed=0,"\ufffd");else{if(1<this.lastNeed&&1<
ma.length){if(128!=(192&ma[1])){pa=(this.lastNeed=1,"\ufffd");break a}if(2<this.lastNeed&&2<ma.length&&128!=(192&ma[2])){pa=(this.lastNeed=2,"\ufffd");break a}}pa=void 0}return void 0===pa?this.lastNeed<=ma.length?(ma.copy(this.lastChar,ka,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(ma.copy(this.lastChar,ka,0,ma.length),void(this.lastNeed-=ma.length)):pa}function T(ma,ka){if(0==(ma.length-ka)%2){if(ka=ma.toString("utf16le",ka)){var pa=ka.charCodeAt(ka.length-1);if(55296<=
pa&&56319>=pa)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=ma[ma.length-2],this.lastChar[1]=ma[ma.length-1],ka.slice(0,-1)}return ka}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=ma[ma.length-1],ma.toString("utf16le",ka,ma.length-1)}function O(ma){ma=ma&&ma.length?this.write(ma):"";return this.lastNeed?ma+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):ma}function W(ma,ka){var pa=(ma.length-ka)%3;return 0==pa?ma.toString("base64",ka):(this.lastNeed=3-pa,this.lastTotal=
3,1==pa?this.lastChar[0]=ma[ma.length-1]:(this.lastChar[0]=ma[ma.length-2],this.lastChar[1]=ma[ma.length-1]),ma.toString("base64",ka,ma.length-pa))}function ba(ma){ma=ma&&ma.length?this.write(ma):"";return this.lastNeed?ma+this.lastChar.toString("base64",0,3-this.lastNeed):ma}function fa(ma){return ma.toString(this.encoding)}function R(ma){return ma&&ma.length?this.write(ma):""}var da=F("safe-buffer").Buffer,ha=da.isEncoding||function(ma){switch((ma=""+ma)&&ma.toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":case "raw":return!0;
default:return!1}};H.StringDecoder=J;J.prototype.write=function(ma){if(0===ma.length)return"";var ka;if(this.lastNeed){if(void 0===(ka=this.fillLast(ma)))return"";var pa=this.lastNeed;this.lastNeed=0}else pa=0;return pa<ma.length?ka?ka+this.text(ma,pa):this.text(ma,pa):ka||""};J.prototype.end=function(ma){ma=ma&&ma.length?this.write(ma):"";return this.lastNeed?ma+"\ufffd":ma};J.prototype.text=function(ma,ka){var pa=ma.length-1;if(pa<ka)var la=0;else{var ta=I(ma[pa]);la=0<=ta?(0<ta&&(this.lastNeed=
ta-1),ta):--pa<ka||-2===ta?0:0<=(ta=I(ma[pa]))?(0<ta&&(this.lastNeed=ta-2),ta):--pa<ka||-2===ta?0:0<=(ta=I(ma[pa]))?(0<ta&&(2===ta?ta=0:this.lastNeed=ta-3),ta):0}if(!this.lastNeed)return ma.toString("utf8",ka);this.lastTotal=la;la=ma.length-(la-this.lastNeed);return ma.copy(this.lastChar,0,la),ma.toString("utf8",ka,la)};J.prototype.fillLast=function(ma){return this.lastNeed<=ma.length?(ma.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):
(ma.copy(this.lastChar,this.lastTotal-this.lastNeed,0,ma.length),void(this.lastNeed-=ma.length))}},{"safe-buffer":30}],32:[function(F,K){(function(H){(function(){function J(I){try{if(!H.localStorage)return!1}catch(N){return!1}I=H.localStorage[I];return null!=I&&"true"===(I+"").toLowerCase()}K.exports=function(I,N){if(J("noDeprecation"))return I;var T=!1;return function(){if(!T){if(J("throwDeprecation"))throw Error(N);J("traceDeprecation")?console.trace(N):console.warn(N);T=!0}return I.apply(this,
arguments)}}}).call(this)}).call(this,void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{}],"/":[function(F,K){function H(R){return R.replace(/a=ice-options:trickle\s\n/g,"")}const J=F("debug")("simple-peer"),I=F("get-browser-rtc"),N=F("randombytes"),T=F("readable-stream"),O=F("queue-microtask"),W=F("err-code"),{Buffer:ba}=F("buffer");class fa extends T.Duplex{constructor(R){if(super(R=Object.assign({allowHalfOpen:!1},
R)),this._id=N(4).toString("hex").slice(0,7),this._debug("new peer %o",R),this.channelName=R.initiator?R.channelName||N(20).toString("hex"):null,this.initiator=R.initiator||!1,this.channelConfig=R.channelConfig||fa.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},fa.config,R.config),this.offerOptions=R.offerOptions||{},this.answerOptions=R.answerOptions||{},this.sdpTransform=R.sdpTransform||(da=>da),this.streams=R.streams||(R.stream?[R.stream]:[]),this.trickle=
void 0===R.trickle||R.trickle,this.allowHalfTrickle=void 0!==R.allowHalfTrickle&&R.allowHalfTrickle,this.iceCompleteTimeout=R.iceCompleteTimeout||5E3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=R.wrtc&&"object"==typeof R.wrtc?R.wrtc:I(),!this._wrtc)throw"undefined"==typeof window?W(Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),
"ERR_WEBRTC_SUPPORT"):W(Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._iceComplete=this._channelReady=this._pcReady=!1;this._channel=this._iceCompleteTimer=null;this._pendingCandidates=[];this._isNegotiating=!1;this._firstNegotiation=!0;this._queuedNegotiation=this._batchedNegotiation=!1;this._sendersAwaitingStable=[];this._senderMap=new Map;this._closingInterval=null;this._remoteTracks=[];this._remoteStreams=[];this._interval=this._cb=this._chunk=null;try{this._pc=
new this._wrtc.RTCPeerConnection(this.config)}catch(da){return void this.destroy(W(da,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId;this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()};this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()};this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()};this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()};this._pc.onicecandidate=da=>{this._onIceCandidate(da)};
"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch(da=>{this.destroy(W(da,"ERR_PC_PEER_IDENTITY"))});this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=da=>{this._setupData(da)};this.streams&&this.streams.forEach(da=>{this.addStream(da)});this._pc.ontrack=da=>{this._onTrack(da)};this._debug("initial negotiation");this._needsNegotiation();this._onFinishBound=()=>{this._onFinish()};
this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof R)try{R=JSON.parse(R)}catch(da){R={}}this._debug("signal()");R.renegotiate&&this.initiator&&
(this._debug("got request to renegotiate"),this._needsNegotiation());R.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(R.transceiverRequest.kind,R.transceiverRequest.init));R.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(R.candidate):this._pendingCandidates.push(R.candidate));R.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(R)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(da=>
{this._addIceCandidate(da)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(da=>{this.destroy(W(da,"ERR_SET_REMOTE_DESCRIPTION"))});R.sdp||R.candidate||R.renegotiate||R.transceiverRequest||this.destroy(W(Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(R){const da=new this._wrtc.RTCIceCandidate(R);this._pc.addIceCandidate(da).catch(ha=>{!da.address||da.address.endsWith(".local")?console.warn("Ignoring unsupported ICE candidate."):
this.destroy(W(ha,"ERR_ADD_ICE_CANDIDATE"))})}send(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(R)}}addTransceiver(R,da){if(!this.destroying){if(this.destroyed)throw W(Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(R,da),this._needsNegotiation()}catch(ha){this.destroy(W(ha,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",
{type:"transceiverRequest",transceiverRequest:{kind:R,init:da}})}}addStream(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()");R.getTracks().forEach(da=>{this.addTrack(da,R)})}}addTrack(R,da){if(!this.destroying){if(this.destroyed)throw W(Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");var ha=this._senderMap.get(R)||new Map,ma=ha.get(da);if(ma)throw ma.removed?W(Error("Track has been removed. You should enable/disable tracks that you want to re-add."),
"ERR_SENDER_REMOVED"):W(Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");ma=this._pc.addTrack(R,da);ha.set(da,ma);this._senderMap.set(R,ha);this._needsNegotiation()}}replaceTrack(R,da,ha){if(!this.destroying){if(this.destroyed)throw W(Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");ha=(R=this._senderMap.get(R))?R.get(ha):null;if(!ha)throw W(Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");
da&&this._senderMap.set(da,R);null==ha.replaceTrack?this.destroy(W(Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):ha.replaceTrack(da)}}removeTrack(R,da){if(!this.destroying){if(this.destroyed)throw W(Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");da=(R=this._senderMap.get(R))?R.get(da):null;if(!da)throw W(Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{da.removed=!0,this._pc.removeTrack(da)}catch(ha){"NS_ERROR_UNEXPECTED"===
ha.name?this._sendersAwaitingStable.push(da):this.destroy(W(ha,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}}removeStream(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()");R.getTracks().forEach(da=>{this.removeTrack(da,R)})}}_needsNegotiation(){this._debug("_needsNegotiation");this._batchedNegotiation||(this._batchedNegotiation=!0,O(()=>{this._batchedNegotiation=!1;this.initiator||!this._firstNegotiation?
(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded");this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw W(Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=
!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0}));this._isNegotiating=!0}}destroy(R){this._destroy(R,()=>{})}_destroy(R,da){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",R&&(R.message||R)),O(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",R&&(R.message||R)),this.readable=this.writable=!1,this._readableState.ended||
this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(ha){}this._channel.onmessage=
null;this._channel.onopen=null;this._channel.onclose=null;this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(ha){}this._pc.oniceconnectionstatechange=null;this._pc.onicegatheringstatechange=null;this._pc.onsignalingstatechange=null;this._pc.onicecandidate=null;this._pc.ontrack=null;this._pc.ondatachannel=null}this._channel=this._pc=null;R&&this.emit("error",R);this.emit("close");da()}))}_setupData(R){if(!R.channel)return this.destroy(W(Error("Data channel event is missing `channel` property"),
"ERR_DATA_CHANNEL"));this._channel=R.channel;this._channel.binaryType="arraybuffer";"number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=65536);this.channelName=this._channel.label;this._channel.onmessage=ha=>{this._onChannelMessage(ha)};this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()};this._channel.onopen=()=>{this._onChannelOpen()};this._channel.onclose=()=>{this._onChannelClose()};this._channel.onerror=ha=>{this.destroy(W(ha.error instanceof
Error?ha.error:Error(`Datachannel error: ${ha.message} ${ha.filename}:${ha.lineno}:${ha.colno}`),"ERR_DATA_CHANNEL"))};let da=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(da&&this._onChannelClose(),da=!0):da=!1},5E3)}_read(){}_write(R,da,ha){if(this.destroyed)return ha(W(Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(R)}catch(ma){return this.destroy(W(ma,"ERR_DATA_CHANNEL"))}65536<this._channel.bufferedAmount?
(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=ha):ha(null)}else this._debug("write before connect"),this._chunk=R,this._cb=ha}_onFinish(){if(!this.destroyed){const R=()=>{setTimeout(()=>this.destroy(),1E3)};this._connected?R():this.once("connect",R)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),
this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(R=>{if(!this.destroyed){this.trickle||this.allowHalfTrickle||(R.sdp=H(R.sdp));R.sdp=this.sdpTransform(R.sdp);var da=()=>{if(!this.destroyed){const ha=this._pc.localDescription||R;this._debug("signal");this.emit("signal",{type:ha.type,sdp:ha.sdp})}};this._pc.setLocalDescription(R).then(()=>{this._debug("createOffer success");this.destroyed||(this.trickle||
this._iceComplete?da():this.once("_iceComplete",da))}).catch(ha=>{this.destroy(W(ha,"ERR_SET_LOCAL_DESCRIPTION"))})}}).catch(R=>{this.destroy(W(R,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(R=>{R.mid||!R.sender.track||R.requested||(R.requested=!0,this.addTransceiver(R.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(R=>{if(!this.destroyed){this.trickle||this.allowHalfTrickle||
(R.sdp=H(R.sdp));R.sdp=this.sdpTransform(R.sdp);var da=()=>{if(!this.destroyed){const ha=this._pc.localDescription||R;this._debug("signal");this.emit("signal",{type:ha.type,sdp:ha.sdp});this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(R).then(()=>{this.destroyed||(this.trickle||this._iceComplete?da():this.once("_iceComplete",da))}).catch(ha=>{this.destroy(W(ha,"ERR_SET_LOCAL_DESCRIPTION"))})}}).catch(R=>{this.destroy(W(R,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||
"failed"===this._pc.connectionState&&this.destroy(W(Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var R=this._pc.iceConnectionState,da=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",R,da);this.emit("iceStateChange",R,da);"connected"!==R&&"completed"!==R||(this._pcReady=!0,this._maybeReady());"failed"===R&&this.destroy(W(Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE"));"closed"===R&&this.destroy(W(Error("Ice connection closed."),
"ERR_ICE_CONNECTION_CLOSED"))}}getStats(R){const da=ha=>("[object Array]"===Object.prototype.toString.call(ha.values)&&ha.values.forEach(ma=>{Object.assign(ha,ma)}),ha);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(ha=>{const ma=[];ha.forEach(ka=>{ma.push(da(ka))});R(null,ma)},ha=>R(ha)):0<this._pc.getStats.length?this._pc.getStats(ha=>{if(!this.destroyed){var ma=[];ha.result().forEach(ka=>{const pa={};ka.names().forEach(la=>{pa[la]=ka.stat(la)});pa.id=ka.id;pa.type=
ka.type;pa.timestamp=ka.timestamp;ma.push(da(pa))});R(null,ma)}},ha=>R(ha)):R(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),!this._connected&&!this._connecting&&this._pcReady&&this._channelReady){this._connecting=!0;var R=()=>{this.destroyed||this.getStats((da,ha)=>{if(!this.destroyed){da&&(ha=[]);var ma={},ka={},pa={},la=!1;ha.forEach(wa=>{"remotecandidate"!==wa.type&&"remote-candidate"!==wa.type||(ma[wa.id]=wa);"localcandidate"!==wa.type&&
"local-candidate"!==wa.type||(ka[wa.id]=wa);"candidatepair"!==wa.type&&"candidate-pair"!==wa.type||(pa[wa.id]=wa)});var ta=wa=>{la=!0;var za=ka[wa.localCandidateId];za&&(za.ip||za.address)?(this.localAddress=za.ip||za.address,this.localPort=+za.port):za&&za.ipAddress?(this.localAddress=za.ipAddress,this.localPort=+za.portNumber):"string"==typeof wa.googLocalAddress&&(za=wa.googLocalAddress.split(":"),this.localAddress=za[0],this.localPort=+za[1]);this.localAddress&&(this.localFamily=this.localAddress.includes(":")?
"IPv6":"IPv4");(za=ma[wa.remoteCandidateId])&&(za.ip||za.address)?(this.remoteAddress=za.ip||za.address,this.remotePort=+za.port):za&&za.ipAddress?(this.remoteAddress=za.ipAddress,this.remotePort=+za.portNumber):"string"==typeof wa.googRemoteAddress&&(za=wa.googRemoteAddress.split(":"),this.remoteAddress=za[0],this.remotePort=+za[1]);this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4");this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,
this.remoteAddress,this.remotePort)};if(ha.forEach(wa=>{"transport"===wa.type&&wa.selectedCandidatePairId&&ta(pa[wa.selectedCandidatePairId]);("googCandidatePair"===wa.type&&"true"===wa.googActiveConnection||("candidatepair"===wa.type||"candidate-pair"===wa.type)&&wa.selected)&&ta(wa)}),la||Object.keys(pa).length&&!Object.keys(ka).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(wa){return this.destroy(W(wa,"ERR_DATA_CHANNEL"))}this._chunk=null;this._debug('sent chunk from "write before connect"');
da=this._cb;this._cb=null;da(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref());this._debug("connect");this.emit("connect")}else setTimeout(R,100)}})};R()}}_onInterval(){this._cb&&this._channel&&!(65536<this._channel.bufferedAmount)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",
this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(R=>{this._pc.removeTrack(R);this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(R){this.destroyed||(R.candidate&&this.trickle?
this.emit("signal",{type:"candidate",candidate:{candidate:R.candidate.candidate,sdpMLineIndex:R.candidate.sdpMLineIndex,sdpMid:R.candidate.sdpMid}}):!R.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),R.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(R){this.destroyed||(R=R.data,R instanceof ArrayBuffer&&(R=ba.from(R)),this.push(R))}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);
const R=this._cb;this._cb=null;R(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(R){this.destroyed||R.streams.forEach(da=>{this._debug("on track");this.emit("track",R.track,da);this._remoteTracks.push({track:R.track,stream:da});this._remoteStreams.some(ha=>ha.id===da.id)||(this._remoteStreams.push(da),O(()=>{this._debug("on stream");
this.emit("stream",da)}))})}_debug(){const R=[].slice.call(arguments);R[0]="["+this._id+"] "+R[0];J.apply(null,R)}}fa.WEBRTC_SUPPORT=!!I();fa.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};fa.channelConfig={};K.exports=fa},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/"))});
const writeSyncStep1$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a,0);g=encodeStateVector$$module$libs$y_webrtc_min(g);writeVarUint8Array$$module$libs$y_webrtc_min(a,g)},writeSyncStep2$$module$libs$y_webrtc_min=(a,g,p)=>{writeVarUint$$module$libs$y_webrtc_min(a,1);writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeStateAsUpdate$$module$libs$y_webrtc_min(g,p))},readSyncStep2$$module$libs$y_webrtc_min=(a,g,p)=>{try{applyUpdate$$module$libs$y_webrtc_min(g,readVarUint8Array$$module$libs$y_webrtc_min(a),
p)}catch(t){console.error("Caught error while handling a Yjs update",t)}},readUpdate$1$$module$libs$y_webrtc_min=readSyncStep2$$module$libs$y_webrtc_min,readSyncMessage$$module$libs$y_webrtc_min=(a,g,p,t)=>{const A=readVarUint$$module$libs$y_webrtc_min(a);switch(A){case 0:writeSyncStep2$$module$libs$y_webrtc_min(g,p,readVarUint8Array$$module$libs$y_webrtc_min(a));break;case 1:readSyncStep2$$module$libs$y_webrtc_min(a,p,t);break;case 2:readSyncStep2$$module$libs$y_webrtc_min(a,p,t);break;default:throw Error("Unknown message type");
}return A};
class Awareness$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a){super();this.doc=a;this.clientID=a.clientID;this.states=new Map;this.meta=new Map;this._checkInterval=setInterval(()=>{const g=getUnixTime$$module$libs$y_webrtc_min();null!==this.getLocalState()&&15E3<=g-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const p=[];this.meta.forEach((t,A)=>{A!==this.clientID&&3E4<=g-t.lastUpdated&&this.states.has(A)&&p.push(A)});0<
p.length&&removeAwarenessStates$$module$libs$y_webrtc_min(this,p,"timeout")},floor$$module$libs$y_webrtc_min(3E3));a.on("destroy",()=>{this.destroy()});this.setLocalState({})}destroy(){this.emit("destroy",[this]);this.setLocalState(null);super.destroy();clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(a){const g=this.clientID;var p=this.meta.get(g),t=void 0===p?0:p.clock+1;p=this.states.get(g);null===a?this.states.delete(g):this.states.set(g,
a);this.meta.set(g,{clock:t,lastUpdated:getUnixTime$$module$libs$y_webrtc_min()});t=[];const A=[],D=[],F=[];null===a?F.push(g):null==p?null!=a&&t.push(g):(A.push(g),equalityDeep$$module$libs$y_webrtc_min(p,a)||D.push(g));(0<t.length||0<D.length||0<F.length)&&this.emit("change",[{added:t,updated:D,removed:F},"local"]);this.emit("update",[{added:t,updated:A,removed:F},"local"])}setLocalStateField(a,g){const p=this.getLocalState();null!==p&&this.setLocalState({...p,[a]:g})}getStates(){return this.states}}
const removeAwarenessStates$$module$libs$y_webrtc_min=(a,g,p)=>{const t=[];for(let A=0;A<g.length;A++){const D=g[A];if(a.states.has(D)){if(a.states.delete(D),D===a.clientID){const F=a.meta.get(D);a.meta.set(D,{clock:F.clock+1,lastUpdated:getUnixTime$$module$libs$y_webrtc_min()})}t.push(D)}}0<t.length&&(a.emit("change",[{added:[],updated:[],removed:t},p]),a.emit("update",[{added:[],updated:[],removed:t},p]))},encodeAwarenessUpdate$$module$libs$y_webrtc_min=(a,g,p=a.states)=>{const t=g.length,A=createEncoder$$module$libs$y_webrtc_min();
writeVarUint$$module$libs$y_webrtc_min(A,t);for(let D=0;D<t;D++){const F=g[D],K=p.get(F)||null,H=a.meta.get(F).clock;writeVarUint$$module$libs$y_webrtc_min(A,F);writeVarUint$$module$libs$y_webrtc_min(A,H);writeVarString$$module$libs$y_webrtc_min(A,JSON.stringify(K))}return toUint8Array$$module$libs$y_webrtc_min(A)},encrypt$$module$libs$y_webrtc_min=(a,g)=>{if(!g)return resolve$$module$libs$y_webrtc_min(a);const p=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",
iv:p},g,a).then(t=>{const A=createEncoder$$module$libs$y_webrtc_min();return writeVarString$$module$libs$y_webrtc_min(A,"AES-GCM"),writeVarUint8Array$$module$libs$y_webrtc_min(A,p),writeVarUint8Array$$module$libs$y_webrtc_min(A,new Uint8Array(t)),toUint8Array$$module$libs$y_webrtc_min(A)})},decrypt$$module$libs$y_webrtc_min=(a,g)=>{if(!g)return resolve$$module$libs$y_webrtc_min(a);a=createDecoder$$module$libs$y_webrtc_min(a);var p;"AES-GCM"!==readVarString$$module$libs$y_webrtc_min(a)&&(p=create$2$$module$libs$y_webrtc_min("Unknown encryption algorithm"),
Promise.reject(p));p=readVarUint8Array$$module$libs$y_webrtc_min(a);a=readVarUint8Array$$module$libs$y_webrtc_min(a);return crypto.subtle.decrypt({name:"AES-GCM",iv:p},g,a).then(t=>new Uint8Array(t))},log$$module$libs$y_webrtc_min=((a,g)=>{const p=loggingColors$$module$libs$y_webrtc_min[nextColor$$module$libs$y_webrtc_min];var t=getVariable$$module$libs$y_webrtc_min("log");t=null!==t&&("*"===t||"true"===t||(new RegExp(t,"gi")).test(g));return nextColor$$module$libs$y_webrtc_min=(nextColor$$module$libs$y_webrtc_min+
1)%loggingColors$$module$libs$y_webrtc_min.length,g+=": ",t?(...A)=>{const D=getUnixTime$$module$libs$y_webrtc_min(),F=D-lastLoggingTime$$module$libs$y_webrtc_min;lastLoggingTime$$module$libs$y_webrtc_min=D;a(p,g,UNCOLOR$$module$libs$y_webrtc_min,...A.map(K=>"string"==typeof K||"symbol"==typeof K?K:JSON.stringify(K)),p," +"+F+"ms")}:nop$$module$libs$y_webrtc_min})(print$$module$libs$y_webrtc_min,"y-webrtc"),signalingConns$$module$libs$y_webrtc_min=new Map,rooms$$module$libs$y_webrtc_min=new Map,checkIsSynced$$module$libs$y_webrtc_min=
a=>{let g=!0;a.webrtcConns.forEach(p=>{p.synced||(g=!1)});(!g&&a.synced||g&&!a.synced)&&(a.synced=g,a.provider.emit("synced",[{synced:g}]),log$$module$libs$y_webrtc_min("synced ",BOLD$$module$libs$y_webrtc_min,a.name,UNBOLD$$module$libs$y_webrtc_min," with all peers"))},readMessage$$module$libs$y_webrtc_min=(a,g,p)=>{var t=createDecoder$$module$libs$y_webrtc_min(g);g=createEncoder$$module$libs$y_webrtc_min();var A=readVarUint$$module$libs$y_webrtc_min(t);if(void 0===a)return null;var D=a.awareness,
F=a.doc;let K=!1;switch(A){case 0:writeVarUint$$module$libs$y_webrtc_min(g,0);D=readSyncMessage$$module$libs$y_webrtc_min(t,g,F,a);1!==D||a.synced||p();0===D&&(K=!0);break;case 3:writeVarUint$$module$libs$y_webrtc_min(g,1);writeVarUint8Array$$module$libs$y_webrtc_min(g,encodeAwarenessUpdate$$module$libs$y_webrtc_min(D,Array.from(D.getStates().keys())));K=!0;break;case 1:p=readVarUint8Array$$module$libs$y_webrtc_min(t);p=createDecoder$$module$libs$y_webrtc_min(p);t=getUnixTime$$module$libs$y_webrtc_min();
A=[];F=[];const H=[],J=[],I=readVarUint$$module$libs$y_webrtc_min(p);for(let N=0;N<I;N++){const T=readVarUint$$module$libs$y_webrtc_min(p);let O=readVarUint$$module$libs$y_webrtc_min(p);const W=JSON.parse(readVarString$$module$libs$y_webrtc_min(p)),ba=D.meta.get(T),fa=D.states.get(T),R=void 0===ba?0:ba.clock;(R<O||R===O&&null===W&&D.states.has(T))&&(null===W?T===D.clientID&&null!=D.getLocalState()?O++:D.states.delete(T):D.states.set(T,W),D.meta.set(T,{clock:O,lastUpdated:t}),void 0===ba&&null!==W?
A.push(T):void 0!==ba&&null===W?J.push(T):null!==W&&(equalityDeep$$module$libs$y_webrtc_min(W,fa)||H.push(T),F.push(T)))}(0<A.length||0<H.length||0<J.length)&&D.emit("change",[{added:A,updated:H,removed:J},a]);(0<A.length||0<F.length||0<J.length)&&D.emit("update",[{added:A,updated:F,removed:J},a]);break;case 4:D=1===readUint8$$module$libs$y_webrtc_min(t);p=readVarString$$module$libs$y_webrtc_min(t);p!==a.peerId&&(a.bcConns.has(p)&&!D||!a.bcConns.has(p)&&D)&&(t=[],A=[],D?(a.bcConns.add(p),A.push(p)):
(a.bcConns.delete(p),t.push(p)),a.provider.emit("peers",[{added:A,removed:t,webrtcPeers:Array.from(a.webrtcConns.keys()),bcPeers:Array.from(a.bcConns)}]),broadcastBcPeerId$$module$libs$y_webrtc_min(a));break;default:return console.error("Unable to compute message"),g}return K?g:null},sendWebrtcConn$$module$libs$y_webrtc_min=(a,g)=>{log$$module$libs$y_webrtc_min("send message to ",BOLD$$module$libs$y_webrtc_min,a.remotePeerId,UNBOLD$$module$libs$y_webrtc_min,GREY$$module$libs$y_webrtc_min," (",a.room.name,
")",UNCOLOR$$module$libs$y_webrtc_min);try{a.peer.send(toUint8Array$$module$libs$y_webrtc_min(g))}catch(p){}};
class WebrtcConn$$module$libs$y_webrtc_min{constructor(a,g,p,t){log$$module$libs$y_webrtc_min("establishing connection to ",BOLD$$module$libs$y_webrtc_min,p);this.room=t;this.remotePeerId=p;this.synced=this.connected=this.closed=!1;this.peer=new simplepeer_min$$module$libs$y_webrtc_min({initiator:g,...t.provider.peerOpts});this.peer.on("signal",A=>{publishSignalingMessage$$module$libs$y_webrtc_min(a,t,{to:p,from:t.peerId,type:"signal",signal:A})});this.peer.on("connect",()=>{log$$module$libs$y_webrtc_min("connected to ",
BOLD$$module$libs$y_webrtc_min,p);this.connected=!0;var A=t.provider.doc;const D=t.awareness;var F=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(F,0);writeSyncStep1$$module$libs$y_webrtc_min(F,A);sendWebrtcConn$$module$libs$y_webrtc_min(this,F);A=D.getStates();0<A.size&&(F=createEncoder$$module$libs$y_webrtc_min(),writeVarUint$$module$libs$y_webrtc_min(F,1),writeVarUint8Array$$module$libs$y_webrtc_min(F,encodeAwarenessUpdate$$module$libs$y_webrtc_min(D,Array.from(A.keys()))),
sendWebrtcConn$$module$libs$y_webrtc_min(this,F))});this.peer.on("close",()=>{this.connected=!1;this.closed=!0;t.webrtcConns.has(this.remotePeerId)&&(t.webrtcConns.delete(this.remotePeerId),t.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(t.webrtcConns.keys()),bcPeers:Array.from(t.bcConns)}]));checkIsSynced$$module$libs$y_webrtc_min(t);this.peer.destroy();log$$module$libs$y_webrtc_min("closed connection to ",BOLD$$module$libs$y_webrtc_min,p);announceSignalingInfo$$module$libs$y_webrtc_min(t)});
this.peer.on("error",A=>{log$$module$libs$y_webrtc_min("Error in connection to ",BOLD$$module$libs$y_webrtc_min,p,": ",A);announceSignalingInfo$$module$libs$y_webrtc_min(t)});this.peer.on("data",A=>{A=((D,F)=>{const K=D.room;return log$$module$libs$y_webrtc_min("received message from ",BOLD$$module$libs$y_webrtc_min,D.remotePeerId,GREY$$module$libs$y_webrtc_min," (",K.name,")",UNBOLD$$module$libs$y_webrtc_min,UNCOLOR$$module$libs$y_webrtc_min),readMessage$$module$libs$y_webrtc_min(K,F,()=>{D.synced=
!0;log$$module$libs$y_webrtc_min("synced ",BOLD$$module$libs$y_webrtc_min,K.name,UNBOLD$$module$libs$y_webrtc_min," with ",BOLD$$module$libs$y_webrtc_min,D.remotePeerId);checkIsSynced$$module$libs$y_webrtc_min(K)})})(this,A);null!==A&&sendWebrtcConn$$module$libs$y_webrtc_min(this,A)})}destroy(){this.peer.destroy()}}
const broadcastBcMessage$$module$libs$y_webrtc_min=(a,g)=>encrypt$$module$libs$y_webrtc_min(g,a.key).then(p=>a.mux(()=>((t,A,D=null)=>{t=getChannel$$module$libs$y_webrtc_min(t);t.bc.postMessage(A);t.subs.forEach(F=>F(A,D))})(a.name,p))),broadcastRoomMessage$$module$libs$y_webrtc_min=(a,g)=>{a.bcconnected&&broadcastBcMessage$$module$libs$y_webrtc_min(a,g);((p,t)=>{log$$module$libs$y_webrtc_min("broadcast message in ",BOLD$$module$libs$y_webrtc_min,p.name,UNBOLD$$module$libs$y_webrtc_min);p.webrtcConns.forEach(A=>
{try{A.peer.send(t)}catch(D){}})})(a,g)},announceSignalingInfo$$module$libs$y_webrtc_min=a=>{signalingConns$$module$libs$y_webrtc_min.forEach(g=>{g.connected&&(g.send({type:"subscribe",topics:[a.name]}),a.webrtcConns.size<a.provider.maxConns&&publishSignalingMessage$$module$libs$y_webrtc_min(g,a,{type:"announce",from:a.peerId}))})},broadcastBcPeerId$$module$libs$y_webrtc_min=a=>{if(a.provider.filterBcConns){const g=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(g,
4);write$$module$libs$y_webrtc_min(g,1);writeVarString$$module$libs$y_webrtc_min(g,a.peerId);broadcastBcMessage$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(g))}};
class Room$$module$libs$y_webrtc_min{constructor(a,g,p,t){this.peerId=uuidv4$$module$libs$y_webrtc_min();this.doc=a;this.awareness=g.awareness;this.provider=g;this.synced=!1;this.name=p;this.key=t;this.webrtcConns=new Map;this.bcConns=new Set;this.mux=(()=>{let A=!0;return(D,F)=>{if(A){A=!1;try{D()}finally{A=!0}}else void 0!==F&&F()}})();this.bcconnected=!1;this._bcSubscriber=A=>decrypt$$module$libs$y_webrtc_min(new Uint8Array(A),t).then(D=>this.mux(()=>{const F=readMessage$$module$libs$y_webrtc_min(this,
D,()=>{});F&&broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(F))}));this._docUpdateHandler=(A,D)=>{D=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(D,0);writeVarUint$$module$libs$y_webrtc_min(D,2);writeVarUint8Array$$module$libs$y_webrtc_min(D,A);broadcastRoomMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(D))};this._awarenessUpdateHandler=({added:A,updated:D,removed:F},K)=>{A=A.concat(D).concat(F);
D=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(D,1);writeVarUint8Array$$module$libs$y_webrtc_min(D,encodeAwarenessUpdate$$module$libs$y_webrtc_min(this.awareness,A));broadcastRoomMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(D))};this._beforeUnloadHandler=()=>{removeAwarenessStates$$module$libs$y_webrtc_min(this.awareness,[a.clientID],"window unload");rooms$$module$libs$y_webrtc_min.forEach(A=>{A.disconnect()})};"undefined"!=typeof window?
window.addEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!=typeof process&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler);this.awareness.on("update",this._awarenessUpdateHandler);announceSignalingInfo$$module$libs$y_webrtc_min(this);var a=this.name;var g=this._bcSubscriber;getChannel$$module$libs$y_webrtc_min(a).subs.add(g);this.bcconnected=!0;broadcastBcPeerId$$module$libs$y_webrtc_min(this);a=createEncoder$$module$libs$y_webrtc_min();
writeVarUint$$module$libs$y_webrtc_min(a,0);writeSyncStep1$$module$libs$y_webrtc_min(a,this.doc);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,0);writeSyncStep2$$module$libs$y_webrtc_min(a,this.doc);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,
3);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,1);writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeAwarenessUpdate$$module$libs$y_webrtc_min(this.awareness,[this.doc.clientID]));broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a))}disconnect(){signalingConns$$module$libs$y_webrtc_min.forEach(g=>{g.connected&&g.send({type:"unsubscribe",
topics:[this.name]})});removeAwarenessStates$$module$libs$y_webrtc_min(this.awareness,[this.doc.clientID],"disconnect");const a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,4);write$$module$libs$y_webrtc_min(a,0);writeVarString$$module$libs$y_webrtc_min(a,this.peerId);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));((g,p)=>{const t=getChannel$$module$libs$y_webrtc_min(g);t.subs.delete(p)&&0===t.subs.size&&(t.bc.close(),
channels$$module$libs$y_webrtc_min.delete(g))})(this.name,this._bcSubscriber);this.bcconnected=!1;this.doc.off("update",this._docUpdateHandler);this.awareness.off("update",this._awarenessUpdateHandler);this.webrtcConns.forEach(g=>g.destroy())}destroy(){this.disconnect();"undefined"!=typeof window?window.removeEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!=typeof process&&process.off("exit",this._beforeUnloadHandler)}}
const publishSignalingMessage$$module$libs$y_webrtc_min=(a,g,p)=>{g.key?((t,A)=>{const D=createEncoder$$module$libs$y_webrtc_min();return writeAny$$module$libs$y_webrtc_min(D,t),encrypt$$module$libs$y_webrtc_min(toUint8Array$$module$libs$y_webrtc_min(D),A)})(p,g.key).then(t=>{a.send({type:"publish",topic:g.name,data:toBase64$$module$libs$y_webrtc_min(t)})}):a.send({type:"publish",topic:g.name,data:p})};
class SignalingConn$$module$libs$y_webrtc_min extends WebsocketClient$$module$libs$y_webrtc_min{constructor(a){super(a);this.providers=new Set;this.on("connect",()=>{log$$module$libs$y_webrtc_min(`connected (${a})`);const g=Array.from(rooms$$module$libs$y_webrtc_min.keys());this.send({type:"subscribe",topics:g});rooms$$module$libs$y_webrtc_min.forEach(p=>publishSignalingMessage$$module$libs$y_webrtc_min(this,p,{type:"announce",from:p.peerId}))});this.on("message",g=>{switch(g.type){case "publish":var p=
g.topic;const D=rooms$$module$libs$y_webrtc_min.get(p);if(null==D||"string"!=typeof p)return;p=F=>{const K=D.webrtcConns,H=D.peerId;if(!(null==F||F.from===H||void 0!==F.to&&F.to!==H||D.bcConns.has(F.from))){var J=K.has(F.from)?()=>{}:()=>D.provider.emit("peers",[{removed:[],added:[F.from],webrtcPeers:Array.from(D.webrtcConns.keys()),bcPeers:Array.from(D.bcConns)}]);switch(F.type){case "announce":K.size<D.provider.maxConns&&(setIfUndefined$$module$libs$y_webrtc_min(K,F.from,()=>new WebrtcConn$$module$libs$y_webrtc_min(this,
!0,F.from,D)),J());break;case "signal":F.to===H&&(setIfUndefined$$module$libs$y_webrtc_min(K,F.from,()=>new WebrtcConn$$module$libs$y_webrtc_min(this,!1,F.from,D)).peer.signal(F.signal),J())}}};D.key?"string"==typeof g.data&&(t=fromBase64$$module$libs$y_webrtc_min(g.data),A=D.key,decrypt$$module$libs$y_webrtc_min(t,A).then(F=>readAny$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(new Uint8Array(F))))).then(p):p(g.data)}var t,A});this.on("disconnect",()=>log$$module$libs$y_webrtc_min(`disconnect (${a})`))}}
class WebrtcProvider$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,g,{signaling:p=["wss://y-webrtc-eu.fly.dev"],password:t=null,awareness:A=new Awareness$$module$libs$y_webrtc_min(g),maxConns:D=20+floor$$module$libs$y_webrtc_min(15*rand$$module$libs$y_webrtc_min()),filterBcConns:F=!0,peerOpts:K={}}={}){super();this.roomName=a;this.doc=g;this.filterBcConns=F;this.awareness=A;this.shouldConnect=!1;this.signalingUrls=p;this.signalingConns=[];this.maxConns=D;this.peerOpts=
K;this.key=t?((H,J)=>{H=encodeUtf8$$module$libs$y_webrtc_min(H).buffer;const I=encodeUtf8$$module$libs$y_webrtc_min(J).buffer;return crypto.subtle.importKey("raw",H,"PBKDF2",!1,["deriveKey"]).then(N=>crypto.subtle.deriveKey({name:"PBKDF2",salt:I,iterations:1E5,hash:"SHA-256"},N,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))})(t,a):resolve$$module$libs$y_webrtc_min(null);this.room=null;this.key.then(H=>{if(rooms$$module$libs$y_webrtc_min.has(a))throw create$2$$module$libs$y_webrtc_min(`A Yjs Doc connected to room "${a}" already exists!`);
H=new Room$$module$libs$y_webrtc_min(g,this,a,H);this.room=(rooms$$module$libs$y_webrtc_min.set(a,H),H);this.shouldConnect?this.room.connect():this.room.disconnect()});this.connect();this.destroy=this.destroy.bind(this);g.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0;this.signalingUrls.forEach(a=>{const g=setIfUndefined$$module$libs$y_webrtc_min(signalingConns$$module$libs$y_webrtc_min,a,()=>new SignalingConn$$module$libs$y_webrtc_min(a));
this.signalingConns.push(g);g.providers.add(this)});this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1;this.signalingConns.forEach(a=>{a.providers.delete(this);0===a.providers.size&&(a.destroy(),signalingConns$$module$libs$y_webrtc_min.delete(a.url))});this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy);this.key.then(()=>{this.room.destroy();rooms$$module$libs$y_webrtc_min.delete(this.roomName)});super.destroy()}}var module$libs$y_webrtc_min={};
module$libs$y_webrtc_min.AbsolutePosition=AbsolutePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractConnector=AbstractConnector$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractStruct=AbstractStruct$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractType=AbstractType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Array=YArray$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentAny=ContentAny$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.ContentBinary=ContentBinary$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentDeleted=ContentDeleted$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentEmbed=ContentEmbed$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentFormat=ContentFormat$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentJSON=ContentJSON$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentString=ContentString$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.ContentType=ContentType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Doc=Doc$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.GC=GC$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ID=ID$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Item=Item$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Map=YMap$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.PermanentUserData=PermanentUserData$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.RelativePosition=RelativePosition$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.Room=Room$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.SignalingConn=SignalingConn$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Snapshot=Snapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Text=YText$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Transaction=Transaction$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.UndoManager=UndoManager$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.UpdateEncoderV1=UpdateEncoderV1$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.WebrtcConn=WebrtcConn$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.WebrtcProvider=WebrtcProvider$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlElement=YXmlElement$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlFragment=YXmlFragment$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlHook=YXmlHook$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlText=YXmlText$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YArrayEvent=YArrayEvent$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.YEvent=YEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YMapEvent=YMapEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YTextEvent=YTextEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YXmlEvent=YXmlEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.applyUpdate=applyUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.applyUpdateV2=applyUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.cleanupYTextFormatting=cleanupYTextFormatting$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.compareIDs=compareIDs$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.compareRelativePositions=compareRelativePositions$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.convertUpdateFormatV1ToV2=convertUpdateFormatV1ToV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.convertUpdateFormatV2ToV1=convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createAbsolutePositionFromRelativePosition=createAbsolutePositionFromRelativePosition$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.createDeleteSet=createDeleteSet$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createDeleteSetFromStructStore=createDeleteSetFromStructStore$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createDocFromSnapshot=createDocFromSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createID=createID$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createRelativePositionFromJSON=createRelativePositionFromJSON$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.createRelativePositionFromTypeIndex=createRelativePositionFromTypeIndex$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createSnapshot=createSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeRelativePosition=decodeRelativePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeSnapshot=decodeSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeSnapshotV2=decodeSnapshotV2$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.decodeStateVector=decodeStateVector$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeUpdate=decodeUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeUpdateV2=decodeUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.diffUpdate=diffUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.diffUpdateV2=diffUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.emptySnapshot=emptySnapshot$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.encodeRelativePosition=encodeRelativePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeSnapshot=encodeSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeSnapshotV2=encodeSnapshotV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateAsUpdate=encodeStateAsUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateAsUpdateV2=encodeStateAsUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateVector=encodeStateVector$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.encodeStateVectorFromUpdate=encodeStateVectorFromUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateVectorFromUpdateV2=encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.equalSnapshots=equalSnapshots$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.findIndexSS=findIndexSS$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.findRootTypeKey=findRootTypeKey$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.getItem=getItem$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.getState=getState$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.getTypeChildren=getTypeChildren$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.isDeleted=isDeleted$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.isParentOf=isParentOf$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.iterateDeletedStructs=iterateDeletedStructs$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.logType=logType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.logUpdate=logUpdate$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.logUpdateV2=logUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.mergeUpdates=mergeUpdates$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.mergeUpdatesV2=mergeUpdatesV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.obfuscateUpdate=obfuscateUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.obfuscateUpdateV2=obfuscateUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.parseUpdateMeta=parseUpdateMeta$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.parseUpdateMetaV2=parseUpdateMetaV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.readUpdate=readUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.readUpdateV2=readUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.relativePositionToJSON=relativePositionToJSON$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.snapshot=snapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.transact=transact$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.tryGc=tryGc$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.typeListToArraySnapshot=typeListToArraySnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.typeMapGetSnapshot=typeMapGetSnapshot$$module$libs$y_webrtc_min;const html$$module$radial=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class AnimateSvg$$module$radial extends k$$module$libs$preact{constructor(a){super();this.mainId=uuidv4$$module$utils();this.mainId2=uuidv4$$module$utils();this.setState({kill:!1});this.out=!1}}
class RadialMenuButton$$module$radial extends k$$module$libs$preact{constructor(a){super();this.mainId=uuidv4$$module$utils();this.mainId2=uuidv4$$module$utils();this.setState({kill:!0});this.out=!1}componentDidUpdate(a){a.uuid!=this.props.uuid&&this.props.cond?this.inx():a.id!=this.props.id?this.inx():(this.props.cond&&this.out&&this.inx(),this.props.cond||this.out||this.outx())}componentDidMount(){const a=document.getElementById(this.mainId),g=document.getElementById(this.mainId+"z");a&&a.beginElement();
g&&g.beginElement();this.out=!1;this.setState({kill:!1})}inx(){const a=document.getElementById(this.mainId),g=document.getElementById(this.mainId+"z");this.out=!1;this.state.kill=!1;a&&a.beginElement();g&&g.beginElement()}outx(){const a=document.getElementById(this.mainId2),g=document.getElementById(this.mainId2+"z");a&&a.beginElement();g&&g.beginElement();let p=this;this.out=!0;window.setTimeout(function(){p.setState({kill:!0})},350)}render(a,g){g=g.kill&&!a.cond?html$$module$radial``:html$$module$radial`
            <g
              opacity="${this.props.enabled?1:.3}"
              transform="scale(${a.scale})"
            >
              <circle
                cx="-8.0776e-10"
                cy="2.1588e-9"
                r="5.538"
                fill="#000"
                fill-opacity=".28921"
                style="paint-order:fill markers stroke"
              />
              <circle
                cx="-8.0776e-10"
                cy="2.1588e-9"
                r="4.7411"
                fill="#d1d1d1"
                style="paint-order:fill markers stroke"
              />
              <use
                fill="${this.props.color||"#222222ff"}"
                xlink:href="${window.app.theme}#${this.props.icon}"
              />
              <path
                d="m0.049757-4.5469a4.5948 4.5948 0 0 0-4.5948 4.5948 4.5948 4.5948 0 0 0 2.1786 3.9046 4.5948 4.5948 0 0 1-1.9714-3.7706 4.5948 4.5948 0 0 1 4.5948-4.5948 4.5948 4.5948 0 0 1 2.3904 0.67114 4.5948 4.5948 0 0 0-2.5976-0.80512z"
                fill="#fff"
                style="paint-order:fill markers stroke"
              />
              <path
                d="m-0.057583 4.5765a4.5948 4.5948 0 0 0 4.5948-4.5948 4.5948 4.5948 0 0 0-2.1786-3.9045 4.5948 4.5948 0 0 1 1.9715 3.7706 4.5948 4.5948 0 0 1-4.5948 4.5948 4.5948 4.5948 0 0 1-2.3904-0.67114 4.5948 4.5948 0 0 0 2.5976 0.80511z"
                fill="#999"
                style="paint-order:fill markers stroke"
              />
            </g>
          `;g=this.props.enabled&&this.props.cond?html$$module$radial` <a class="test" onClick=${this.props.onClick}> ${g} </a>`:html$$module$radial`${g}`;return html$$module$radial` <g transform="rotate(${this.props.angle}, 0,0)">
      <animate
        id="${this.mainId}z"
        attributeName="opacity"
        begin="indefinite"
        dur="0.35s"
        from="0.0"
        restart="always"
        to="1.0"
        fill="freeze"
      />
      <animateTransform
        attributeName="transform"
        type="scale"
        additive="sum"
        from="0.5 0.5"
        restart="always"
        to="1 1"
        id="${this.mainId}"
        begin="indefinite"
        dur="0.35s"
      />
      <animate
        id="${this.mainId2}z"
        attributeName="opacity"
        begin="indefinite"
        restart="always"
        dur="0.35s"
        from="1.0"
        to="0.0"
        fill="freeze"
      />
      <animateTransform
        attributeName="transform"
        type="scale"
        restart="always"
        additive="sum"
        from="1 1"
        to="0.5 0.5"
        id="${this.mainId2}"
        begin="indefinite"
        dur="0.35s"
      />
      <g transform="translate(${Math.max(12,12*this.props.scale)})">
        <g transform="rotate(-${this.props.angle}, 0,0)">
          ${g}
          <title>${a.tooltip}</title>
        </g>
      </g></g
    >`}}class RadialMenu$$module$radial extends k$$module$libs$preact{constructor(a){super()}render(a,g){}}var module$radial={};module$radial.AnimateSvg=AnimateSvg$$module$radial;module$radial.RadialMenu=RadialMenu$$module$radial;module$radial.RadialMenuButton=RadialMenuButton$$module$radial;const html$$module$hexmenu=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),HexBitmask$$module$hexmenu={IS_HEX_AN_OCEAN:1,IS_HEX_OCCUPIED:2,IS_HEX_HAS_RIVER:4,IS_HEX_HAS_TRAIL:8,IS_HEX_COASTAL:16,IS_HEX_HAS_BORDER:32};function HexSettlementMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_city"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendSettlement(a.menu.uuid,"City")}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-city"
      tooltip="Roll a new City"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_town"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendSettlement(a.menu.uuid,"Town")}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-town"
      tooltip="Roll a new Town"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_village"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendSettlement(a.menu.uuid,"Village")}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-village"
      tooltip="Roll a new Village"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_inn"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Inn","Inn")}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-inn"
      tooltip="Roll a new Inn"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_dwelling"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Residency","Residency")}
      angle="120"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-dwelling"
      tooltip="Roll a new Dwelling"
    />
  </g>`}function HexGeneratorMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_dungeon"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Dungeon","Dungeon")}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-dungeon"
      tooltip="Roll a new Dungeon"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_settlement"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRollSettlementMenu()}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-settlement"
      tooltip="Roll a new settlement"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_draw_river"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onDrawRiver(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-river"
      tooltip="Roll a new River"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_realm"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendRealm()}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN}
      icon="icon-realm"
      tooltip="Roll a new Realm"
    />
  </g>`}function HexCleanupMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_clean_river"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onClearHexRiver(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-river"
      tooltip="Remove River"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_clean_trail"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onClearHexTrails(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-trail"
      tooltip="Rebuild Trails"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_reroll_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRerollHex(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-feature"
      tooltip="Reroll an Empty Hex (removes everthing inside!)"
    />
  </g>`}function HexDeleteMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveHex(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_HAS_BORDER||a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN&&a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_COASTAL}
      icon="icon-hex"
      tooltip="Delete Hex (coastlines or water only)"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_region"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveRegion(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-region"
      tooltip="Delete Region"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_realm"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveRealm(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-realm"
      tooltip="Delete the entire Realm!"
    />
  </g>`}function HexMainMenu$$module$hexmenu(a){return html$$module$hexmenu` <g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_trash"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onDeleteMenu(a.menu.uuid)}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_COASTAL))}
      icon="icon-trash"
      tooltip="Destroy hex or hexes (including everything on!)"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_broom"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRerollMenu(a.menu.uuid)}
      angle="180"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-broom"
      tooltip="Remove / Rebuild Features"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_dice"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendMenu(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-dice"
      tooltip="Roll new entities"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_remap"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemapEntity(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-remap"
      tooltip="Rearrange Realm Hex Map"
    />
  </g>`}class HexMenu$$module$hexmenu extends k$$module$libs$preact{constructor(){super()}render(a){return 0==a.menu.type?html$$module$hexmenu` <${HexMainMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:1==a.menu.type?html$$module$hexmenu` <${HexGeneratorMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:4==a.menu.type?html$$module$hexmenu` <${HexSettlementMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:2==a.menu.type?html$$module$hexmenu` <${HexCleanupMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:3==a.menu.type?html$$module$hexmenu` <${HexDeleteMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:html$$module$hexmenu``}}var module$hexmenu={};module$hexmenu.HexBitmask=HexBitmask$$module$hexmenu;module$hexmenu.HexMenu=HexMenu$$module$hexmenu;const html$$module$SvgMap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function easeInOutSine$$module$SvgMap(a,g,p,t){return-p/2*(Math.cos(Math.PI*a/t)-1)+g}function easeInOutCubic$$module$SvgMap(a,g,p,t){return 1>(a/=t/2)?p/2*a*a*a+g:p/2*((a-=2)*a*a+2)+g}function isTouchDevice$$module$SvgMap(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}
class SvgMap$$module$SvgMap extends k$$module$libs$preact{constructor(){super();this.state={offset:{x:10,y:10},dim:{w:1500,h:1500},drag:!1};this.predrag=this.drag=!1;this.factor=.1;this.oy=this.ox=0;this.inhibit_pointer_events=this.minimap=!1;this.sizeToFit=this.sizeToFit.bind(this)}sizeToFit(){var a=document.getElementById("canvas");if(a)if(this.width){var g=this.width;const p=this.height;this.width=a.getBoundingClientRect().width||1;this.height=a.getBoundingClientRect().height||1;a=this.state.dim.w/
g;const t=this.state.dim.h/p,A={w:this.width*a,h:this.height*t};this.setState({dim:A,offset:{x:this.state.offset.x-(this.width-g)*a/2,y:this.state.offset.y-(this.height-p)*t/2},zoom_factor:this.width*this.height/(A.w*A.h)})}else this.width=a.getBoundingClientRect().width||1,this.height=a.getBoundingClientRect().height||1,g={w:this.state.dim.w,h:this.height/this.width*this.state.dim.w},this.setState({dim:g,zoom_factor:this.width*this.height/(g.w*g.h)})}clientToCanvasCoords(a){let g=document.getElementById("canvas"),
p=g.createSVGPoint();p.x=a.clientX;p.y=a.clientY;return p.matrixTransform(g.getScreenCTM().inverse())}componentDidMount(a,g,p){let t=this;if(!this.minimap){var A=document.getElementById("canvas");if(A){(new ResizeObserver(this.sizeToFit)).observe(A);A.addEventListener("pointerdown",function(F){t.touch_is_on||t.inhibit_pointer_events||t.filterPointerCapture(F.clientX,F.clientY)||(t.predrag=!0,t.setState({drag:!0}),t.ox=F.offsetX,t.oy=F.offsetY,t.tmp=t.state.offset,window.app.tokens&&!window.app.kill_mode&&
window.app.selected_token&&(F=t.clientToCanvasCoords(F),t.drag=!1,t.setState({drag:!1}),t.token_move={cp:F,t_uuid:window.app.selected_token.uuid,tuid:window.app.selected_token.tuid}))});A.addEventListener("pointermove",function(F){if(!t.inhibit_pointer_events)if(t.predrag&&(t.drag=!0),t.drag)if(window.app.inhibit_click=!0,t.token_move){var K=t.token_move.cp,H=t.clientToCanvasCoords(F);F=H.x-K.x;var J=H.y-K.y;K=window.app.tokens[t.token_move.t_uuid].get(t.token_move.tuid);F={x:K.x+=F,y:K.y+=J,l:K.light,
t:K.tid,r:K.r,pc:K.pc,u:K.tuid,d:K.uuid};window.app.zarray.set(K.tuid,F);t.setState({drag:!1});t.token_move.cp=H}else window.app.last_selected&&(window.app.last_selected.setState({class:"baseout"}),window.app.last_selected=null),H=F.offsetX-t.ox,F=F.offsetY-t.oy,K=A.getBoundingClientRect().width||1,J=A.getBoundingClientRect().height||1,t.setState({offset:{x:t.tmp.x-t.state.dim.w/K*H,y:t.tmp.y-t.state.dim.h/J*F},menu:!1});else window.app.inhibit_click=!1},{passive:!0});document.addEventListener("mouseup",
function(F){t.token_move=!1;t.drag&&(t.setState({drag:!1}),t.drag=!1);t.predrag=!1},{passive:!0});document.addEventListener("onClick",function(F){window.app.inhibit_click&&(window.app.inhibit_click=!1,F.stopPropagation())},{passive:!0});var D=Date.now();A.addEventListener("wheel",function(F){if(window.app.tokens&&(t.clientToCanvasCoords(F),window.app.selected_token)){var K=window.app.tokens[window.app.selected_token.uuid].get(window.app.selected_token.tuid);if(t.props.vtt&&K.pc||!t.props.vtt){var H=
0<F.deltaY?1:-1;F={l:K.light,t:K.tid,x:K.x,y:K.y,r:K.r+=15*H,pc:K.pc,u:K.tuid,d:K.uuid};window.app.zarray.set(K.tuid,F);t.setState({drag:!1});return}}window.clearInterval(t.interval);t.props.hex_uuid&&!t.props.vtt&&$$$module$libs$preact_router_module("/sandbox/"+t.props.instance);if(!(t.inhibit_pointer_events||(K=Date.now(),F.stopPropagation(),H=0<F.deltaY?1:-1,-1==H&&1E7<t.state.zoom_factor||1==H&&.1>t.state.zoom_factor))){K=1-(K-D)/1E3*10;.7<K&&(K=.7);.2>K&&(K=.2);H=1+K*H;K=F.offsetX*H-F.offsetX;
F=F.offsetY*H-F.offsetY;var J=A.getBoundingClientRect().width||1,I=A.getBoundingClientRect().height||1,N=J*I/(I/J*H*t.state.dim.w*H*t.state.dim.w);t.setState({offset:{x:t.state.offset.x-t.state.dim.w/J*K,y:t.state.offset.y-t.state.dim.h/I*F},dim:{w:t.state.dim.w*H,h:t.state.dim.h*H},zoom_factor:N,res:t.getResPrefix(N)});return!0}},{passive:!0});a=F=>{var K;const H=J=>Math.hypot(J.touches[0].pageX-J.touches[1].pageX,J.touches[0].pageY-J.touches[1].pageY);F.addEventListener("touchstart",J=>{window.clearInterval(t.interval);
t.inhibit_pointer_events=!1;if(1===J.touches.length){t.touch_is_on=!0;J.preventDefault();if(t.filterPointerCapture(J.touches[0].pageX,J.touches[0].pageY))return;t.drag=!0;t.ox=J.touches[0].pageX;t.oy=J.touches[0].pageY;t.tmp=t.state.offset}2===J.touches.length&&(J.preventDefault(),t.inhibit_pointer_events=!0,K=H(J))},{passive:!0});F.addEventListener("touchmove",J=>{if(2===J.touches.length){J.preventDefault();let O;O=J.scale?J.scale:H(J)/K;.9>O&&(O=.9);1.1<O&&(O=1.1);O=1/O;var I=[(J.touches[0].pageX+
J.touches[1].pageX)/2,(J.touches[0].pageY+J.touches[1].pageY)/2];J=I[0]*O-I[0];I=I[1]*O-I[1];var N=A.getBoundingClientRect().width||1,T=A.getBoundingClientRect().height||1;const W=N*T/(t.state.dim.w*O*t.state.dim.h*O);t.setState({offset:{x:t.state.offset.x-t.state.dim.w/N*J,y:t.state.offset.y-t.state.dim.h/T*I},dim:{w:t.state.dim.w*O,h:t.state.dim.h*O},zoom_factor:W,res:t.getResPrefix(W)})}});F.addEventListener("touchend",J=>{t.touchinterval=window.setTimeout(function(){},500);F.style.transform="";
F.style.WebkitTransform="";F.style.zIndex=""})};isTouchDevice$$module$SvgMap()&&a(A)}}}getResPrefix(a){let g="";20>a&&(g="low-");2>a&&(g="empty-");return g}waypoint(a,g,p,t,A,D=null){window.clearInterval(this.interval);let F=this.state.offset.x,K=this.state.offset.y,H=this.state.dim.w,J=this.state.dim.h,I=0,N=this;const T=10*A;this.camera_moving=!0;this.interval=window.setInterval(function(){var O=N.height/N.width*p,W=a-F-p/2,ba=g-K-O/2,fa=p-H;O-=J;I++;let R=easeInOutSine$$module$SvgMap;W=R(10*I,
F,W,T);ba=R(10*I,K,ba,T);fa=R(10*I,H,fa,T);O=R(10*I,J,O,T);N.setState({offset:{x:W,y:ba},dim:{w:fa,h:O},zoom_factor:N.width*N.height/(fa*O),col1:"rect1",res:N.getResPrefix(N.width*N.height/(fa*O))});I==A&&(window.clearInterval(N.interval),N.camera_moving=!1,D&&D())},10)}minimapOnLocation(a,g,p,t){const A=Math.abs(this.state.dim.w-p);if(20>Math.hypot(this.state.offset.x-a,this.state.offset.y-g)||20<A||200>this.state.zoom_factor)this.waypoint(a,g,p,t,50);else{let D=this;this.waypoint(a,g,100*p,100*
t,100,function(){D.waypoint(a,g,p,t,100)})}}}var module$SvgMap={};module$SvgMap.SvgMap=SvgMap$$module$SvgMap;/*
 GNU Affero General Public License.
 Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 v. 1.2.0
 https://github.com/RaumZeit/MarchingSquares.js

 MarchingSquaresJS is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 MarchingSquaresJS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 As additional permission under GNU Affero General Public License version 3
 section 7, third-party projects (personal or commercial) may distribute,
 include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 requirement that said third-party project for that reason alone becomes
 subject to any requirement of the GNU Affero General Public License version 3.
 Any modifications to MarchingSquaresJS, however, must be shared with the public
 and made available.

 In summary this:
 - allows you to use MarchingSquaresJS at no cost
 - allows you to use MarchingSquaresJS for both personal and commercial purposes
 - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
   license as long as this license notice is included
 - enables you to keep the source code of your program that uses MarchingSquaresJS
   undisclosed
 - forces you to share any modifications you have made to MarchingSquaresJS,
   e.g. bug-fixes

 You should have received a copy of the GNU Affero General Public License
 along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 MIT
 @preserve
 @license GNU Affero General Public License.
 Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 v. 1.2.0
 https://github.com/RaumZeit/MarchingSquares.js

 MarchingSquaresJS is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 MarchingSquaresJS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 As additional permission under GNU Affero General Public License version 3
 section 7, third-party projects (personal or commercial) may distribute,
 include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 requirement that said third-party project for that reason alone becomes
 subject to any requirement of the GNU Affero General Public License version 3.
 Any modifications to MarchingSquaresJS, however, must be shared with the public
 and made available.

 In summary this:
 - allows you to use MarchingSquaresJS at no cost
 - allows you to use MarchingSquaresJS for both personal and commercial purposes
 - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
   license as long as this license notice is included
 - enables you to keep the source code of your program that uses MarchingSquaresJS
   undisclosed
 - forces you to share any modifications you have made to MarchingSquaresJS,
   e.g. bug-fixes

 You should have received a copy of the GNU Affero General Public License
 along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
*/
!function(a,g){"object"==typeof exports&&"undefined"!=typeof module?g(exports):"function"==typeof define&&define.amd?define(["exports"],g):g((a="undefined"!=typeof globalThis?globalThis:a||self).turf={})}(this,function(a){function g(b,c,e){void 0===e&&(e={});var k={type:"Feature"};return(0===e.id||e.id)&&(k.id=e.id),e.bbox&&(k.bbox=e.bbox),k.properties=c||{},k.geometry=b,k}function p(b,c,e){switch(b){case "Point":return t(c).geometry;case "LineString":return K(c).geometry;case "Polygon":return D(c).geometry;
case "MultiPoint":return N(c).geometry;case "MultiLineString":return I(c).geometry;case "MultiPolygon":return T(c).geometry;default:throw Error(b+" is invalid");}}function t(b,c,e){if(void 0===e&&(e={}),!b)throw Error("coordinates is required");if(!Array.isArray(b))throw Error("coordinates must be an Array");if(2>b.length)throw Error("coordinates must be at least 2 numbers long");if(!la(b[0])||!la(b[1]))throw Error("coordinates must contain numbers");return g({type:"Point",coordinates:b},c,e)}function A(b,
c,e){return void 0===e&&(e={}),J(b.map(function(k){return t(k,c)}),e)}function D(b,c,e){void 0===e&&(e={});for(var k=0;k<b.length;k++){var d=b[k];if(4>d.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var f=0;f<d[d.length-1].length;f++)if(d[d.length-1][f]!==d[0][f])throw Error("First and last Position are not equivalent.");}return g({type:"Polygon",coordinates:b},c,e)}function F(b,c,e){return void 0===e&&(e={}),J(b.map(function(k){return D(k,c)}),e)}function K(b,
c,e){if(void 0===e&&(e={}),2>b.length)throw Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:b},c,e)}function H(b,c,e){return void 0===e&&(e={}),J(b.map(function(k){return K(k,c)}),e)}function J(b,c){void 0===c&&(c={});var e={type:"FeatureCollection"};return c.id&&(e.id=c.id),c.bbox&&(e.bbox=c.bbox),e.features=b,e}function I(b,c,e){return void 0===e&&(e={}),g({type:"MultiLineString",coordinates:b},c,e)}function N(b,c,e){return void 0===e&&(e={}),
g({type:"MultiPoint",coordinates:b},c,e)}function T(b,c,e){return void 0===e&&(e={}),g({type:"MultiPolygon",coordinates:b},c,e)}function O(b,c,e){return void 0===e&&(e={}),g({type:"GeometryCollection",geometries:b},c,e)}function W(b,c){if(void 0===c&&(c=0),c&&!(0<=c))throw Error("precision must be a positive number");c=Math.pow(10,c||0);return Math.round(b*c)/c}function ba(b,c){void 0===c&&(c="kilometers");var e=mh[c];if(!e)throw Error(c+" units is invalid");return b*e}function fa(b,c){void 0===c&&
(c="kilometers");var e=mh[c];if(!e)throw Error(c+" units is invalid");return b/e}function R(b,c){return ha(fa(b,c))}function da(b){b%=360;return 0>b&&(b+=360),b}function ha(b){return b%(2*Math.PI)*180/Math.PI}function ma(b){return b%360*Math.PI/180}function ka(b,c,e){if(void 0===c&&(c="kilometers"),void 0===e&&(e="kilometers"),!(0<=b))throw Error("length must be a positive number");return ba(fa(b,c),e)}function pa(b,c,e){if(void 0===c&&(c="meters"),void 0===e&&(e="kilometers"),!(0<=b))throw Error("area must be a positive number");
c=nh[c];if(!c)throw Error("invalid original units");e=nh[e];if(!e)throw Error("invalid final units");return b/c*e}function la(b){return!isNaN(b)&&null!==b&&!Array.isArray(b)}function ta(b){return!!b&&b.constructor===Object}function wa(b){if(!b)throw Error("bbox is required");if(!Array.isArray(b))throw Error("bbox must be an Array");if(4!==b.length&&6!==b.length)throw Error("bbox must be an Array of 4 or 6 numbers");b.forEach(function(c){if(!la(c))throw Error("bbox must only contain numbers");})}function za(b){if(!b)throw Error("id is required");
if(-1===["string","number"].indexOf(typeof b))throw Error("id must be a number or a string");}function Ca(b,c,e){if(null!==b){var k,d,f,l,h=0;var m=b.type;for(var q="FeatureCollection"===m,n="Feature"===m,r=q?b.features.length:1,v=0;v<r;v++){var z=(f=!!(d=q?b.features[v].geometry:n?b.geometry:b)&&"GeometryCollection"===d.type)?d.geometries.length:1;for(var u=0;u<z;u++){var y=0,C=0;if(null!==(k=f?d.geometries[u]:d)){var w=k.coordinates;var x=k.type;switch(l=!e||"Polygon"!==x&&"MultiPolygon"!==x?0:
1,x){case null:break;case "Point":if(!1===c(w,h,v,y,C))return!1;h++;break;case "LineString":case "MultiPoint":for(m=0;m<w.length;m++){if(!1===c(w[m],h,v,y,C))return!1;h++;"MultiPoint"===x&&y++}"LineString"===x&&y++;break;case "Polygon":case "MultiLineString":for(m=0;m<w.length;m++){for(k=0;k<w[m].length-l;k++){if(!1===c(w[m][k],h,v,y,C))return!1;h++}"MultiLineString"===x&&y++;"Polygon"===x&&C++}"Polygon"===x&&y++;break;case "MultiPolygon":for(m=0;m<w.length;m++){for(k=C=0;k<w[m].length;k++){for(x=
0;x<w[m][k].length-l;x++){if(!1===c(w[m][k][x],h,v,y,C))return!1;h++}C++}y++}break;case "GeometryCollection":for(m=0;m<k.geometries.length;m++)if(!1===Ca(k.geometries[m],c,e))return!1;break;default:throw Error("Unknown Geometry Type");}}}}}}function Vb(b,c,e,k){var d=e;return Ca(b,function(f,l,h,m,q){d=0===l&&void 0===e?f:c(d,f,l,h,m,q)},k),d}function Kb(b,c){var e;switch(b.type){case "FeatureCollection":for(e=0;e<b.features.length&&!1!==c(b.features[e].properties,e);e++);break;case "Feature":c(b.properties,
0)}}function Qd(b,c,e){var k=e;return Kb(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k}function Sa(b,c){if("Feature"===b.type)c(b,0);else if("FeatureCollection"===b.type)for(var e=0;e<b.features.length&&!1!==c(b.features[e],e);e++);}function Ya(b,c,e){var k=e;return Sa(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k}function uc(b){var c=[];return Ca(b,function(e){c.push(e)}),c}function Zb(b,c){var e,k,d,f,l,h=0,m="FeatureCollection"===b.type,q="Feature"===b.type,n=m?b.features.length:1;for(e=
0;e<n;e++){var r=m?b.features[e].geometry:q?b.geometry:b;var v=m?b.features[e].properties:q?b.properties:{};var z=m?b.features[e].bbox:q?b.bbox:void 0;var u=m?b.features[e].id:q?b.id:void 0;var y=(l=!!r&&"GeometryCollection"===r.type)?r.geometries.length:1;for(d=0;d<y;d++)if(null!==(f=l?r.geometries[d]:r))switch(f.type){case "Point":case "LineString":case "MultiPoint":case "Polygon":case "MultiLineString":case "MultiPolygon":if(!1===c(f,h,v,z,u))return!1;break;case "GeometryCollection":for(k=0;k<
f.geometries.length;k++)if(!1===c(f.geometries[k],h,v,z,u))return!1;break;default:throw Error("Unknown Geometry Type");}else if(!1===c(null,h,v,z,u))return!1;h++}}function pd(b,c,e){var k=e;return Zb(b,function(d,f,l,h,m){k=0===f&&void 0===e?d:c(k,d,f,l,h,m)}),k}function Rb(b,c){Zb(b,function(e,k,d,f,l){var h=null===e?null:e.type;switch(h){case null:case "Point":case "LineString":case "Polygon":return!1!==c(g(e,d,{bbox:f,id:l}),k,0)&&void 0}switch(h){case "MultiPoint":var m="Point";break;case "MultiLineString":m=
"LineString";break;case "MultiPolygon":m="Polygon"}for(f=0;f<e.coordinates.length;f++)if(!1===c(g({type:m,coordinates:e.coordinates[f]},d),k,f))return!1})}function Me(b,c,e){var k=e;return Rb(b,function(d,f,l){k=0===f&&0===l&&void 0===e?d:c(k,d,f,l)}),k}function L(b,c){Rb(b,function(e,k,d){var f=0;if(e.geometry){var l=e.geometry.type;if("Point"!==l&&"MultiPoint"!==l){var h,m=0,q=0,n=0;return!1!==Ca(e,function(r,v,z,u,y){if(void 0===h||k>m||u>q||y>n)return h=r,m=k,q=u,n=y,void(f=0);v=K([h,r],e.properties);
if(!1===c(v,k,d,y,f))return!1;f++;h=r})&&void 0}}})}function M(b,c,e){var k=e,d=!1;return L(b,function(f,l,h,m,q){k=!1===d&&void 0===e?f:c(k,f,l,h,m,q);d=!0}),k}function Q(b,c){if(!b)throw Error("geojson is required");Rb(b,function(e,k,d){if(null!==e.geometry){var f=e.geometry.coordinates;switch(e.geometry.type){case "LineString":if(!1===c(e,k,d,0,0))return!1;break;case "Polygon":for(var l=0;l<f.length;l++)if(!1===c(K(f[l],e.properties),k,d,l))return!1}}})}function ca(b,c,e){var k=e;return Q(b,function(d,
f,l,h){k=0===f&&void 0===e?d:c(k,d,f,l,h)}),k}function oa(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.segmentIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;
default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":case "MultiPoint":return null;case "LineString":return 0>f&&(f=e.length+f-1),K([e[f],e[f+1]],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f-1),K([e[d][f],e[d][f+1]],l,c);case "MultiLineString":return 0>k&&(k=e.length+k),0>f&&(f=e[k].length+f-1),K([e[k][f],e[k][f+1]],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-f-1),
K([e[k][d][f],e[k][d][f+1]],l,c)}throw Error("geojson is invalid");}function Ba(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.coordIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;
default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":return t(e,l,c);case "MultiPoint":return 0>k&&(k=e.length+k),t(e[k],l,c);case "LineString":return 0>f&&(f=e.length+f),t(e[f],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f),t(e[d][f],l,c);case "MultiLineString":return 0>k&&(k=e.length+k),0>f&&(f=e[k].length+f),t(e[k][f],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-
f),t(e[k][d][f],l,c)}throw Error("geojson is invalid");}function ya(b){var c=[1/0,1/0,-1/0,-1/0];return Ca(b,function(e){c[0]>e[0]&&(c[0]=e[0]);c[1]>e[1]&&(c[1]=e[1]);c[2]<e[0]&&(c[2]=e[0]);c[3]<e[1]&&(c[3]=e[1])}),c}function aa(b){if(!b)throw Error("coord is required");if(!Array.isArray(b)){if("Feature"===b.type&&null!==b.geometry&&"Point"===b.geometry.type)return b.geometry.coordinates;if("Point"===b.type)return b.coordinates}if(Array.isArray(b)&&2<=b.length&&!Array.isArray(b[0])&&!Array.isArray(b[1]))return b;
throw Error("coord must be GeoJSON Point or an Array of numbers");}function Y(b){if(Array.isArray(b))return b;if("Feature"===b.type){if(null!==b.geometry)return b.geometry.coordinates}else if(b.coordinates)return b.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array");}function xa(b){if(1<b.length&&la(b[0])&&la(b[1]))return!0;if(Array.isArray(b[0])&&b[0].length)return xa(b[0]);throw Error("coordinates must only contain numbers");}function Oa(b,c,e){if(!c||!e)throw Error("type and name required");
if(!b||b.type!==c)throw Error("Invalid input to "+e+": must be a "+c+", given "+b.type);}function Ob(b,c,e){if(!b)throw Error("No feature passed");if(!e)throw Error(".featureOf() requires a name");if(!b||"Feature"!==b.type||!b.geometry)throw Error("Invalid input to "+e+", Feature with geometry required");if(!b.geometry||b.geometry.type!==c)throw Error("Invalid input to "+e+": must be a "+c+", given "+b.geometry.type);}function Ka(b,c,e){if(!b)throw Error("No featureCollection passed");if(!e)throw Error(".collectionOf() requires a name");
if(!b||"FeatureCollection"!==b.type)throw Error("Invalid input to "+e+", FeatureCollection required");var k=0;for(b=b.features;k<b.length;k++){var d=b[k];if(!d||"Feature"!==d.type||!d.geometry)throw Error("Invalid input to "+e+", Feature with geometry required");if(!d.geometry||d.geometry.type!==c)throw Error("Invalid input to "+e+": must be a "+c+", given "+d.geometry.type);}}function Ib(b){return"Feature"===b.type?b.geometry:b}function qc(b,c){return"FeatureCollection"===b.type?"FeatureCollection":
"GeometryCollection"===b.type?"GeometryCollection":"Feature"===b.type&&null!==b.geometry?b.geometry.type:b.type}function ff(b,c,e){e=e||{};for(var k=Object.keys(Rj),d=0;d<k.length;d++){var f=k[d],l=e[f];l=null!=l?l:Rj[f];oh[f]=l}oh.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+c);b=function(h){var m=[],q=0;return h.cells.forEach(function(n,r){n.forEach(function(v,z){var u;if(void 0!==v&&5!==(u=v).cval&&10!==u.cval&&0!==v.cval&&15!==v.cval){a:{v=h.cells;var y=v.length,
C=[],w=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],x=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],B="none bottom right right top top top top left bottom right right left bottom left none".split(" "),E=v[r][z],G=E.cval,P="none left bottom left right none bottom left top top none top right right bottom none".split(" ")[G];P=ef(E,P);C.push([z+P[0],r+P[1]]);P=B[G];P=ef(E,P);C.push([z+P[0],r+P[1]]);wc(E);for(var S=z+w[G],V=r+x[G],Z=G;0<=S&&0<=V&&V<y&&(S!=z||V!=r)&&void 0!==(E=v[V][S]);){if(0===(G=E.cval)||15===G){z=
C;u="mergeable";break a}P=B[G];u=w[G];var X=x[G];5!==G&&10!==G||(5===G?E.flipped?-1===x[Z]?(P="left",u=-1,X=0):(P="right",u=1,X=0):-1===w[Z]&&(P="bottom",u=0,X=-1):10===G&&(E.flipped?-1===w[Z]?(P="top",u=0,X=1):(P="bottom",u=0,X=-1):1===x[Z]&&(P="left",u=-1,X=0)));P=ef(E,P);C.push([S+P[0],V+P[1]]);wc(E);S+=u;V+=X;Z=G}z=C;u="closed"}v=!1;if("mergeable"===u)for(X=z[z.length-1][0],y=z[z.length-1][1],u=q-1;0<=u;u--)if(1E-7>=Math.abs(m[u][0][0]-X)&&1E-7>=Math.abs(m[u][0][1]-y)){for(v=z.length-2;0<=v;--v)m[u].unshift(z[v]);
v=!0;break}v||(m[q++]=z)}})}),m}(function(h,m){for(var q=h.length-1,n=h[0].length-1,r={rows:q,cols:n,cells:[]},v=0;v<q;++v){r.cells[v]=[];for(var z=0;z<n;++z){var u=0,y=h[v+1][z],C=h[v+1][z+1],w=h[v][z+1],x=h[v][z];if(!(isNaN(y)||isNaN(C)||isNaN(w)||isNaN(x))){u|=y>=m?8:0;u|=C>=m?4:0;u|=w>=m?2:0;var B,E,G,P=!1;if(5===(u|=x>=m?1:0)||10===u){var S=(y+C+w+x)/4;5===u&&S<m?(u=10,P=!0):10===u&&S<m&&(u=5,P=!0)}0!==u&&15!==u&&(S=B=E=G=.5,1===u?(E=1-$a(m,y,x),B=1-$a(m,w,x)):2===u?(B=$a(m,x,w),G=1-$a(m,C,w)):
3===u?(E=1-$a(m,y,x),G=1-$a(m,C,w)):4===u?(S=$a(m,y,C),G=$a(m,w,C)):5===u?(S=$a(m,y,C),G=$a(m,w,C),B=1-$a(m,w,x),E=1-$a(m,y,x)):6===u?(B=$a(m,x,w),S=$a(m,y,C)):7===u?(E=1-$a(m,y,x),S=$a(m,y,C)):8===u?(E=$a(m,x,y),S=1-$a(m,C,y)):9===u?(B=1-$a(m,w,x),S=1-$a(m,C,y)):10===u?(S=1-$a(m,C,y),G=1-$a(m,C,w),B=$a(m,x,w),E=$a(m,x,y)):11===u?(S=1-$a(m,C,y),G=1-$a(m,C,w)):12===u?(E=$a(m,x,y),G=$a(m,w,C)):13===u?(B=1-$a(m,w,x),G=$a(m,w,C)):14===u?(E=$a(m,x,y),B=$a(m,x,w)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+
u),r.cells[v][z]={cval:u,flipped:P,top:S,right:G,bottom:B,left:E})}}}return r}(b,c));return"function"==typeof oh.successCallback&&oh.successCallback(b),b}function $a(b,c,e){return(b-c)/(e-c)}function wc(b){0===b.cval||15===b.cval||5===b.cval||10===b.cval||(b.cval=15)}function ef(b,c){return"top"===c?[b.top,1]:"bottom"===c?[b.bottom,0]:"right"===c?[1,b.right]:"left"===c?[0,b.left]:void 0}function lh(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.zProperty||"elevation",k=c.flip;c=c.flags;
Ka(b,"Point","input must contain Points");b=function(q,n){var r={};return Sa(q,function(v){var z=Y(v)[1];r[z]||(r[z]=[]);r[z].push(v)}),Object.keys(r).map(function(v){return r[v].sort(function(z,u){return Y(z)[0]-Y(u)[0]})}).sort(function(v,z){return n?Y(v[0])[1]-Y(z[0])[1]:Y(z[0])[1]-Y(v[0])[1]})}(b,k);k=[];for(var d=0;d<b.length;d++){for(var f=b[d],l=[],h=0;h<f.length;h++){var m=f[h];m.properties[e]?l.push(m.properties[e]):l.push(0);!0===c&&(m.properties.matrixPosition=[d,h])}k.push(l)}return k}
function $b(b,c,e,k,d){vc(b,c,e||0,k||b.length-1,d||Cn)}function vc(b,c,e,k,d){for(;k>e;){if(600<k-e){var f=k-e+1,l=c-e+1,h=Math.log(f),m=.5*Math.exp(2*h/3);h=.5*Math.sqrt(h*m*(f-m)/f)*(0>l-f/2?-1:1);vc(b,c,Math.max(e,Math.floor(c-l*m/f+h)),Math.min(k,Math.floor(c+(f-l)*m/f+h)),d)}f=b[c];l=e;m=k;he(b,e,c);for(0<d(b[k],f)&&he(b,e,k);l<m;){he(b,l,m);l++;for(m--;0>d(b[l],f);)l++;for(;0<d(b[m],f);)m--}0===d(b[e],f)?he(b,e,m):he(b,++m,k);m<=c&&(e=m+1);c<=m&&(k=m-1)}}function he(b,c,e){var k=b[c];b[c]=
b[e];b[e]=k}function Cn(b,c){return b<c?-1:b>c?1:0}function mg(b,c){if(!(this instanceof mg))return new mg(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&this._initFormat(c);this.clear()}function Bf(b,c){ng(b,0,b.children.length,c,b)}function ng(b,c,e,k,d){d||=Cf(null);d.minX=1/0;d.minY=1/0;d.maxX=-1/0;d.maxY=-1/0;for(var f=c;f<e;f++)c=b.children[f],og(d,b.leaf?k(c):c);return d}function og(b,c){return b.minX=Math.min(b.minX,c.minX),b.minY=Math.min(b.minY,
c.minY),b.maxX=Math.max(b.maxX,c.maxX),b.maxY=Math.max(b.maxY,c.maxY),b}function Sj(b,c){return b.minX-c.minX}function Tj(b,c){return b.minY-c.minY}function oi(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function ph(b){return b.maxX-b.minX+(b.maxY-b.minY)}function pi(b,c){return b.minX<=c.minX&&b.minY<=c.minY&&c.maxX<=b.maxX&&c.maxY<=b.maxY}function qh(b,c){return c.minX<=b.maxX&&c.minY<=b.maxY&&c.maxX>=b.minX&&c.maxY>=b.minY}function Cf(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/
0,maxY:-1/0}}function Uj(b,c,e,k,d){for(var f,l=[c,e];l.length;)(e=l.pop())-(c=l.pop())<=k||(f=c+Math.ceil((e-c)/k/2)*k,Vj(b,f,c,e,d),l.push(c,f,f,e))}function ie(b){var c={exports:{}};return b(c,c.exports),c.exports}function pg(b,c){if(!(this instanceof pg))return new pg(b,c);if(this.data=b||[],this.length=this.data.length,this.compare=c||Dn,0<this.length)for(b=(this.length>>1)-1;0<=b;b--)this._down(b)}function Dn(b,c){return b<c?-1:b>c?1:0}function Wj(b,c,e){c=Math.max(0,void 0===c?2:c);e=e||0;
for(var k,d=b[0],f=b[0],l=b[0],h=b[0],m=0;m<b.length;m++){var q=b[m];q[0]<d[0]&&(d=q);q[0]>l[0]&&(l=q);q[1]<f[1]&&(f=q);q[1]>h[1]&&(h=q)}f=[d,f,l,h];d=f.slice();for(m=0;m<b.length;m++){h=b[m];l=h[0];h=h[1];q=!1;for(var n=0,r=f.length-1;n<f.length;r=n++){var v=f[n][0],z=f[n][1],u=f[r][0];r=f[r][1];z>h!=r>h&&l<(u-v)*(h-z)/(r-z)+v&&(q=!q)}q||d.push(b[m])}l=En(d);f=[];for(m=0;m<l.length;m++)f.push(d[l[m]]);b=Uc(16,["[0]","[1]","[0]","[1]"]).load(b);m=[];for(l=0;l<f.length;l++){var y=f[l];b.remove(y);
k=Xj(y,k);m.push(k)}d=Uc(16);for(l=0;l<m.length;l++)d.insert(qi(m[l]));c*=c;for(f=e*e;m.length;)if(e=m.shift(),l=e.p,h=e.next.p,q=ri(l,h),!(q<f)){q/=c;a:{var C=b;n=e.prev.p;v=l;z=h;u=e.next.next.p;r=q;var w=d,x=new Yj(null,Fn);for(C=C.data;C;){for(var B=0;B<C.children.length;B++){var E=C.children[B],G=C.leaf?si(E,v,z):Gn(v,z,E);G>r||x.push({node:E,dist:G})}for(;x.length&&!x.peek().node.children;){B=x.pop();E=B.node;G=si(E,n,v);var P=si(E,z,u);if(B.dist<G&&B.dist<P&&Zj(v,E,w)&&Zj(z,E,w)){n=E;break a}}(C=
x.pop())&&(C=C.node)}n=null}(y=n)&&Math.min(ri(y,l),ri(y,h))<=q&&(m.push(e),m.push(Xj(y,e)),b.remove(y),d.remove(e),d.insert(qi(e)),d.insert(qi(e.next)))}e=k;y=[];do y.push(e.p),e=e.next;while(e!==k);return y.push(e.p),y}function Fn(b,c){return b.dist-c.dist}function Gn(b,c,e){if(ak(b,e)||ak(c,e))return 0;var k=rh(b[0],b[1],c[0],c[1],e.minX,e.minY,e.maxX,e.minY);if(0===k)return 0;var d=rh(b[0],b[1],c[0],c[1],e.minX,e.minY,e.minX,e.maxY);if(0===d)return 0;var f=rh(b[0],b[1],c[0],c[1],e.maxX,e.minY,
e.maxX,e.maxY);if(0===f)return 0;b=rh(b[0],b[1],c[0],c[1],e.minX,e.maxY,e.maxX,e.maxY);return 0===b?0:Math.min(k,d,f,b)}function ak(b,c){return b[0]>=c.minX&&b[0]<=c.maxX&&b[1]>=c.minY&&b[1]<=c.maxY}function Zj(b,c,e){var k,d,f,l;e=e.search({minX:Math.min(b[0],c[0]),minY:Math.min(b[1],c[1]),maxX:Math.max(b[0],c[0]),maxY:Math.max(b[1],c[1])});for(var h=0;h<e.length;h++)if(k=e[h].p,d=e[h].next.p,f=b,k!==(l=c)&&d!==f&&0<sh(k,d,f)!=0<sh(k,d,l)&&0<sh(f,l,k)!=0<sh(f,l,d))return!1;return!0}function qi(b){var c=
b.p,e=b.next.p;return b.minX=Math.min(c[0],e[0]),b.minY=Math.min(c[1],e[1]),b.maxX=Math.max(c[0],e[0]),b.maxY=Math.max(c[1],e[1]),b}function Xj(b,c){b={p:b,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return c?(b.next=c.next,b.prev=c,c.next.prev=b,c.next=b):(b.prev=b,b.next=b),b}function ri(b,c){var e=b[0]-c[0];b=b[1]-c[1];return e*e+b*b}function si(b,c,e){var k=c[0];c=c[1];var d=e[0]-k,f=e[1]-c;if(0!==d||0!==f){var l=((b[0]-k)*d+(b[1]-c)*f)/(d*d+f*f);1<l?(k=e[0],c=e[1]):0<l&&(k+=d*l,c+=f*l)}return(d=
b[0]-k)*d+(f=b[1]-c)*f}function rh(b,c,e,k,d,f,l,h){var m,q,n,r,v=e-b,z=k-c,u=l-d,y=h-f,C=b-d,w=c-f,x=v*v+z*z,B=v*u+z*y,E=u*u+y*y;v=v*C+z*w;y=u*C+y*w;w=u=C=x*E-B*B;0===C?(q=0,u=1,r=y,w=E):(r=x*y-B*v,0>(q=B*y-E*v)?(q=0,r=y,w=E):q>u&&(q=u,r=y+B,w=E));0>r?(r=0,0>-v?q=0:-v>x?q=u:(q=-v,u=x)):r>w&&(r=w,0>-v+B?q=0:-v+B>x?q=u:(q=-v+B,u=x));r=(1-(n=0===r?0:r/w))*d+n*l-((1-(m=0===q?0:q/u))*b+m*e);b=(1-n)*f+n*h-((1-m)*c+m*k);return r*r+b*b}function bk(b,c){void 0===c&&(c={});c.concavity=c.concavity||1/0;var e=
[];if(Ca(b,function(k){e.push([k[0],k[1]])}),!e.length)return null;b=ck(e,c.concavity);return 3<b.length?D([b]):null}function Tb(b,c,e){if(void 0===e&&(e={}),!b)throw Error("point is required");if(!c)throw Error("polygon is required");b=aa(b);var k=Ib(c),d=c.bbox;c=k.coordinates;if(d&&!1===(d[0]<=b[0]&&d[1]<=b[1]&&d[2]>=b[0]&&d[3]>=b[1]))return!1;"Polygon"===k.type&&(c=[c]);k=!1;for(d=0;d<c.length&&!k;d++)if(dk(b,c[d][0],e.ignoreBoundary)){for(var f=!1,l=1;l<c[d].length&&!f;)dk(b,c[d][l],!e.ignoreBoundary)&&
(f=!0),l++;f||(k=!0)}return k}function dk(b,c,e){var k=!1;c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]&&(c=c.slice(0,c.length-1));for(var d=0,f=c.length-1;d<c.length;f=d++){var l=c[d][0],h=c[d][1],m=c[f][0];f=c[f][1];if(0==b[1]*(l-m)+h*(m-b[0])+f*(b[0]-l)&&0>=(l-b[0])*(m-b[0])&&0>=(h-b[1])*(f-b[1]))return!e;h>b[1]!=f>b[1]&&b[0]<(m-l)*(b[1]-h)/(f-h)+l&&(k=!k)}return k}function ti(b,c){var e=[];return Sa(b,function(k){var d=!1;if("Point"===k.geometry.type)Zb(c,function(l){Tb(k,l)&&(d=!0)}),
d&&e.push(k);else{if("MultiPoint"!==k.geometry.type)throw Error("Input geometry must be a Point or MultiPoint");var f=[];Zb(c,function(l){Ca(k,function(h){Tb(h,l)&&(d=!0,f.push(h))})});d&&e.push(N(f))}}),J(e)}function Lb(b,c,e){void 0===e&&(e={});var k=aa(b),d=aa(c);c=ma(d[1]-k[1]);b=ma(d[0]-k[0]);k=ma(k[1]);d=ma(d[1]);c=Math.pow(Math.sin(c/2),2)+Math.pow(Math.sin(b/2),2)*Math.cos(k)*Math.cos(d);return ba(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),e.units)}function ek(b,c){var e=!1;return J(function(k){if(3>
k.length)return[];k.sort(Hn);var d,f=k.length-1,l=k[f].x;var h=k[0].x;for(var m=k[f].y,q=m;f--;)k[f].y<m&&(m=k[f].y),k[f].y>q&&(q=k[f].y);var n,r=h-l,v=q-m;f=r>v?r:v;l=.5*(h+l);m=.5*(q+m);m=[new fk({__sentinel:!0,x:l-20*f,y:m-f},{__sentinel:!0,x:l,y:m+20*f},{__sentinel:!0,x:l+20*f,y:m-f})];q=[];l=[];for(f=k.length;f--;){l.length=0;for(n=m.length;n--;)0<(r=k[f].x-m[n].x)&&r*r>m[n].r?(q.push(m[n]),m.splice(n,1)):r*r+(v=k[f].y-m[n].y)*v>m[n].r||(l.push(m[n].a,m[n].b,m[n].b,m[n].c,m[n].c,m[n].a),m.splice(n,
1));var z=h=void 0;var u=l;var y=u.length;a:for(;y;){n=u[--y];var C=u[--y];for(d=y;d;)if(h=u[--d],C===(z=u[--d])&&n===h||C===h&&n===z){u.splice(y,2);u.splice(d,2);y-=2;continue a}}for(n=l.length;n;)z=l[--n],h=l[--n],d=k[f],C=z.x-h.x,u=z.y-h.y,C=2*(C*(d.y-z.y)-u*(d.x-z.x)),1E-12<Math.abs(C)&&m.push(new fk(h,z,d))}Array.prototype.push.apply(q,m);for(f=q.length;f--;)(q[f].a.__sentinel||q[f].b.__sentinel||q[f].c.__sentinel)&&q.splice(f,1);return q}(b.features.map(function(k){var d={x:k.geometry.coordinates[0],
y:k.geometry.coordinates[1]};return c?d.z=k.properties[c]:3===k.geometry.coordinates.length&&(e=!0,d.z=k.geometry.coordinates[2]),d})).map(function(k){var d=[k.a.x,k.a.y],f=[k.b.x,k.b.y],l=[k.c.x,k.c.y],h={};return e?(d.push(k.a.z),f.push(k.b.z),l.push(k.c.z)):h={a:k.a.z,b:k.b.z,c:k.c.z},D([[d,f,l,d]],h)}))}function Hn(b,c){return c.x-b.x}function Dc(b){if(!b)throw Error("geojson is required");switch(b.type){case "Feature":return gk(b);case "FeatureCollection":return function(c){var e={type:"FeatureCollection"};
return Object.keys(c).forEach(function(k){switch(k){case "type":case "features":break;default:e[k]=c[k]}}),e.features=c.features.map(function(k){return gk(k)}),e}(b);case "Point":case "LineString":case "Polygon":case "MultiPoint":case "MultiLineString":case "MultiPolygon":case "GeometryCollection":return ui(b);default:throw Error("unknown GeoJSON type");}}function gk(b){var c={type:"Feature"};return Object.keys(b).forEach(function(e){switch(e){case "type":case "properties":case "geometry":break;default:c[e]=
b[e]}}),c.properties=hk(b.properties),c.geometry=ui(b.geometry),c}function hk(b){var c={};return b?(Object.keys(b).forEach(function(e){var k=b[e];"object"==typeof k?null===k?c[e]=null:Array.isArray(k)?c[e]=k.map(function(d){return d}):c[e]=hk(k):c[e]=k}),c):c}function ui(b){var c={type:b.type};return b.bbox&&(c.bbox=b.bbox),"GeometryCollection"===b.type?(c.geometries=b.geometries.map(function(e){return ui(e)}),c):(c.coordinates=ik(b.coordinates),c)}function ik(b){return"object"!=typeof b[0]?b.slice():
b.map(function(c){return ik(c)})}function In(b,c){if(void 0===c&&(c={}),!ta(c=c||{}))throw Error("options is invalid");c=c.mutate;if("FeatureCollection"!==qc(b))throw Error("geojson must be a FeatureCollection");if(!b.features.length)throw Error("geojson is empty");!1!==c&&void 0!==c||(b=Dc(b));var e=[];b=ca(b,function(k,d){a:{var f=k.geometry.coordinates;var l=d.geometry.coordinates,h=th(f[0]),m=th(f[f.length-1]),q=th(l[0]),n=th(l[l.length-1]);if(h===n)f=l.concat(f.slice(1));else if(q===m)f=f.concat(l.slice(1));
else if(h===q)f=f.slice(1).reverse().concat(l);else{if(m!==n){f=null;break a}f=f.concat(l.reverse().slice(1))}f=K(f)}return f||(e.push(k),d)});return b&&e.push(b),e.length?1===e.length?e[0]:I(e.map(function(k){return k.coordinates})):null}function th(b){return b[0].toString()+","+b[1].toString()}function Jn(b){return b}function jk(b,c){function e(m){return l(m)}function k(m){for(var q=[],n=0,r=m.length;n<r;++n){var v,z=m[n],u=q;u.length&&u.pop();var y=h[0>z?~z:z],C=0;for(v=y.length;C<v;++C)u.push(l(y[C],
C));if(0>z)for(z=u.length,y=z-v;y<--z;)v=u[y],u[y++]=u[z],u[z]=v}return 2>q.length&&q.push(q[0]),q}function d(m){for(m=k(m);4>m.length;)m.push(m[0]);return m}function f(m){return m.map(d)}var l=function(m){if(null==m)return Jn;var q,n,r=m.scale[0],v=m.scale[1],z=m.translate[0],u=m.translate[1];return function(y,C){C||(q=n=0);C=2;var w=y.length,x=Array(w);x[0]=(q+=y[0])*r+z;for(x[1]=(n+=y[1])*v+u;C<w;)x[C]=y[C],++C;return x}}(b.transform),h=b.arcs;return function n(q){var r=q.type;switch(r){case "GeometryCollection":return{type:r,
geometries:q.geometries.map(n)};case "Point":q=l(q.coordinates);break;case "MultiPoint":q=q.coordinates.map(e);break;case "LineString":q=k(q.arcs);break;case "MultiLineString":q=q.arcs.map(k);break;case "Polygon":q=f(q.arcs);break;case "MultiPolygon":q=q.arcs.map(f);break;default:return null}return{type:r,coordinates:q}}(c)}function Kn(b,c){function e(m,q){for(var n in m){var r=m[n];delete q[r.start];delete r.start;delete r.end;r.forEach(function(v){k[0>v?~v:v]=1});l.push(r)}}var k={},d={},f={},l=
[],h=-1;return c.forEach(function(m,q){var n,r=b.arcs[0>m?~m:m];3>r.length&&!r[1][0]&&!r[1][1]&&(n=c[++h],c[h]=m,c[q]=n)}),c.forEach(function(m){var q=function(v){var z,u=b.arcs[0>v?~v:v],y=u[0];b.transform?(z=[0,0],u.forEach(function(C){z[0]+=C[0];z[1]+=C[1]})):z=u[u.length-1];return 0>v?[z,y]:[y,z]}(m);var n=q[0],r=q[1];(q=f[n])?(delete f[q.end],q.push(m),q.end=r,m=d[r])?(delete d[m.start],n=m===q?q:q.concat(m),d[n.start=q.start]=f[n.end=m.end]=n):d[q.start]=f[q.end]=q:(q=d[r])?(delete d[q.start],
q.unshift(m),q.start=n,m=f[n])?(delete f[m.end],n=m===q?q:m.concat(q),d[n.start=m.start]=f[n.end=q.end]=n):d[q.start]=f[q.end]=q:d[(q=[m]).start=n]=f[q.end=r]=q}),e(f,d),e(d,f),c.forEach(function(m){k[0>m?~m:m]||l.push([m])}),l}function Ln(b,c){function e(h){h.forEach(function(m){m.forEach(function(q){(d[q=0>q?~q:q]||(d[q]=[])).push(h)})});f.push(h)}function k(h){h=jk(b,{type:"Polygon",arcs:[h]}).coordinates[0];for(var m,q=-1,n=h.length,r=h[n-1],v=0;++q<n;)m=r,r=h[q],v+=m[0]*r[1]-m[1]*r[0];return Math.abs(v)}
var d={},f=[],l=[];return c.forEach(function q(m){switch(m.type){case "GeometryCollection":m.geometries.forEach(q);break;case "Polygon":e(m.arcs);break;case "MultiPolygon":m.arcs.forEach(e)}}),f.forEach(function(m){if(!m._){var q=[],n=[m];m._=1;for(l.push(q);m=n.pop();)q.push(m),m.forEach(function(r){r.forEach(function(v){d[0>v?~v:v].forEach(function(z){z._||(z._=1,n.push(z))})})})}}),f.forEach(function(m){delete m._}),{type:"MultiPolygon",arcs:l.map(function(m){var q=[];if(m.forEach(function(u){u.forEach(function(y){y.forEach(function(C){2>
d[0>C?~C:C].length&&q.push(C)})})}),1<(m=(q=Kn(b,q)).length))for(var n,r,v=1,z=k(q[0]);v<m;++v)(n=k(q[v]))>z&&(r=q[0],q[0]=q[v],q[v]=r,z=n);return q}).filter(function(m){return 0<m.length})}}function vi(b,c,e,k,d,f){3===arguments.length&&(k=f=Array,d=null);for(var l=new k(b=1<<Math.max(4,Math.ceil(Math.log(b)/Math.LN2))),h=new f(b),m=b-1,q=0;q<b;++q)l[q]=d;return{set:function(n,r){for(var v=c(n)&m,z=l[v],u=0;z!=d;){if(e(z,n))return h[v]=r;if(++u>=b)throw Error("full hashmap");z=l[v=v+1&m]}return l[v]=
n,h[v]=r,r},maybeSet:function(n,r){for(var v=c(n)&m,z=l[v],u=0;z!=d;){if(e(z,n))return h[v];if(++u>=b)throw Error("full hashmap");z=l[v=v+1&m]}return l[v]=n,h[v]=r,r},get:function(n,r){for(var v=c(n)&m,z=l[v],u=0;z!=d;){if(e(z,n))return h[v];if(++u>=b)break;z=l[v=v+1&m]}return r},keys:function(){for(var n=[],r=0,v=l.length;r<v;++r){var z=l[r];z!=d&&n.push(z)}return n}}}function gf(b,c){return b[0]===c[0]&&b[1]===c[1]}function wi(b){kk[0]=b[0];kk[1]=b[1];b=uh[0]^uh[1];return 2147483647&(b<<5^b>>7^
uh[2]^uh[3])}function Mn(b){function c(B,E,G,P){if(q[G]!==B)if(q[G]=B,B=n[G],0<=B){var S=r[G];B===E&&S===P||B===P&&S===E||(++z,v[G]=1)}else n[G]=E,r[G]=P}function e(B){return wi(f[B])}function k(B,E){return gf(f[B],f[E])}var d,f=b.coordinates,l=b.lines,h=b.rings,m=function(){for(var B=vi(1.4*f.length,e,k,Int32Array,-1,Int32Array),E=new Int32Array(f.length),G=0,P=f.length;G<P;++G)E[G]=B.maybeSet(G,G);return E}(),q=new Int32Array(f.length),n=new Int32Array(f.length),r=new Int32Array(f.length),v=new Int8Array(f.length),
z=0;b=0;for(d=f.length;b<d;++b)q[b]=n[b]=r[b]=-1;b=0;for(d=l.length;b<d;++b){var u=l[b];var y=u[0],C=u[1];u=m[y];var w=m[++y];++z;for(v[u]=1;++y<=C;)c(b,u,u=w,w=m[y]);++z;v[w]=1}b=0;for(d=f.length;b<d;++b)q[b]=-1;b=0;for(d=h.length;b<d;++b)for(u=h[b],l=u[0]+1,y=u[1],c(b,m[y-1],u=m[l-1],w=m[l]);++l<=y;)c(b,u,u=w,w=m[l]);q=n=r=null;var x;h=function(B,E,G,P,S){3===arguments.length&&(P=Array,S=null);for(var V=new P(B=1<<Math.max(4,Math.ceil(Math.log(B)/Math.LN2))),Z=B-1,X=0;X<B;++X)V[X]=S;return{add:function(ea){for(var na=
E(ea)&Z,qa=V[na],ia=0;qa!=S;){if(G(qa,ea))return!0;if(++ia>=B)throw Error("full hashset");qa=V[na=na+1&Z]}return V[na]=ea,!0},has:function(ea){for(var na=E(ea)&Z,qa=V[na],ia=0;qa!=S;){if(G(qa,ea))return!0;if(++ia>=B)break;qa=V[na=na+1&Z]}return!1},values:function(){for(var ea=[],na=0,qa=V.length;na<qa;++na){var ia=V[na];ia!=S&&ea.push(ia)}return ea}}}(1.4*z,wi,gf);b=0;for(d=f.length;b<d;++b)v[x=m[b]]&&h.add(f[x]);return h}function xi(b,c,e){for(var k,d=c+(e-- -c>>1);c<d;++c,--e)k=b[c],b[c]=b[e],b[e]=
k}function Nn(b){var c,e,k={};for(c in b)k[c]=null==(e=b[c])?{type:null}:("FeatureCollection"===e.type?On:"Feature"===e.type?lk:yi)(e);return k}function On(b){var c={type:"GeometryCollection",geometries:b.features.map(lk)};return null!=b.bbox&&(c.bbox=b.bbox),c}function lk(b){var c,e=yi(b.geometry);for(c in null!=b.id&&(e.id=b.id),null!=b.bbox&&(e.bbox=b.bbox),b.properties){e.properties=b.properties;break}return e}function yi(b){if(null==b)return{type:null};var c="GeometryCollection"===b.type?{type:"GeometryCollection",
geometries:b.geometries.map(yi)}:"Point"===b.type||"MultiPoint"===b.type?{type:b.type,coordinates:b.coordinates}:{type:b.type,arcs:b.coordinates};return null!=b.bbox&&(c.bbox=b.bbox),c}function Pn(b,c){function e(r){r&&vh.call(q,r.type)&&q[r.type](r)}function k(r){var v=[];do{var z=m.get(r);v.push(r[0]<r[1]?z:~z)}while(r=r.next);return v}function d(r){return r.map(k)}var f=function(r){function v(P){null!=P&&vh.call(E,P.type)&&E[P.type](P)}function z(P){var S=P[0];P=P[1];S<C&&(C=S);S>x&&(x=S);P<w&&
(w=P);P>B&&(B=P)}function u(P){P.forEach(z)}function y(P){P.forEach(u)}var C=1/0,w=1/0,x=-1/0,B=-1/0,E={GeometryCollection:function(P){P.geometries.forEach(v)},Point:function(P){z(P.coordinates)},MultiPoint:function(P){P.coordinates.forEach(z)},LineString:function(P){u(P.arcs)},MultiLineString:function(P){P.arcs.forEach(u)},Polygon:function(P){P.arcs.forEach(u)},MultiPolygon:function(P){P.arcs.forEach(y)}},G;for(G in r)v(r[G]);return x>=C&&B>=w?[C,w,x,B]:void 0}(b=Nn(b));c=0<c&&f&&function(r,v,z){function u(ea){return[Math.round((ea[0]-
E)*S),Math.round((ea[1]-G)*V)]}function y(ea,na){for(var qa,ia,ra,ja,Ma=-1,Pa=0,Sb=ea.length,Qa=Array(Sb);++Ma<Sb;)qa=ea[Ma],ja=Math.round((qa[0]-E)*S),qa=Math.round((qa[1]-G)*V),ja===ia&&qa===ra||(Qa[Pa++]=[ia=ja,ra=qa]);for(Qa.length=Pa;Pa<na;)Pa=Qa.push([Qa[0][0],Qa[0][1]]);return Qa}function C(ea){return y(ea,2)}function w(ea){return y(ea,4)}function x(ea){return ea.map(w)}function B(ea){null!=ea&&vh.call(Z,ea.type)&&Z[ea.type](ea)}var E=v[0],G=v[1],P=v[2];v=v[3];var S=P-E?(z-1)/(P-E):1,V=v-G?
(z-1)/(v-G):1,Z={GeometryCollection:function(ea){ea.geometries.forEach(B)},Point:function(ea){ea.coordinates=u(ea.coordinates)},MultiPoint:function(ea){ea.coordinates=ea.coordinates.map(u)},LineString:function(ea){ea.arcs=C(ea.arcs)},MultiLineString:function(ea){ea.arcs=ea.arcs.map(C)},Polygon:function(ea){ea.arcs=x(ea.arcs)},MultiPolygon:function(ea){ea.arcs=ea.arcs.map(x)}},X;for(X in r)B(r[X]);return{scale:[1/S,1/V],translate:[E,G]}}(b,f,c);var l=function(r){function v(X){var ea,na,qa,ia;if(qa=
V.get(ea=B[X[0]])){var ra=0;for(ia=qa.length;ra<ia;++ra){a:{var ja=na=qa[ra];var Ma=ja[0];var Pa=X[0];ja=ja[1];if(Ma-ja!=Pa-X[1])Ma=!1;else{for(;Ma<=ja;++Ma,++Pa)if(!gf(B[Ma],B[Pa])){Ma=!1;break a}Ma=!0}}if(Ma)return X[0]=na[0],void(X[1]=na[1])}}if(Ma=V.get(na=B[X[1]]))for(ra=0,ia=Ma.length;ra<ia;++ra){a:{var Sb=Pa=Ma[ra];ja=Sb[0];Sb=Sb[1];var Qa=X[1];if(ja-Sb!=X[0]-Qa)ja=!1;else{for(;ja<=Sb;++ja,--Qa)if(!gf(B[ja],B[Qa])){ja=!1;break a}ja=!0}}if(ja)return X[1]=Pa[0],void(X[0]=Pa[1])}qa?qa.push(X):
V.set(ea,[X]);Ma?Ma.push(X):V.set(na,[X]);Z.push(X)}function z(X){var ea,na,qa,ia;if(na=V.get(B[X[0]])){var ra=0;for(ia=na.length;ra<ia;++ra){if(u(qa=na[ra],X))return X[0]=qa[0],void(X[1]=qa[1]);if(y(qa,X))return X[0]=qa[1],void(X[1]=qa[0])}}if(na=V.get(ea=B[X[0]+C(X)]))for(ra=0,ia=na.length;ra<ia;++ra){if(u(qa=na[ra],X))return X[0]=qa[0],void(X[1]=qa[1]);if(y(qa,X))return X[0]=qa[1],void(X[1]=qa[0])}na?na.push(X):V.set(ea,[X]);Z.push(X)}function u(X,ea){var na=X[0],qa=ea[0],ia=X[1]-na;if(ia!==ea[1]-
qa)return!1;X=C(X);ea=C(ea);for(var ra=0;ra<ia;++ra)if(!gf(B[na+(ra+X)%ia],B[qa+(ra+ea)%ia]))return!1;return!0}function y(X,ea){var na=X[0],qa=ea[1],ia=X[1]-na;if(ia!==qa-ea[0])return!1;X=C(X);ea=ia-C(ea);for(var ra=0;ra<ia;++ra)if(!gf(B[na+(ra+X)%ia],B[qa-(ra+ea)%ia]))return!1;return!0}function C(X){var ea=X[0];X=X[1];for(var na=ea,qa=na,ia=B[na];++na<X;){var ra=B[na];(ra[0]<ia[0]||ra[0]===ia[0]&&ra[1]<ia[1])&&(qa=na,ia=ra)}return qa-ea}var w,x,B=r.coordinates,E=r.lines,G=r.rings,P=E.length+G.length;
delete r.lines;delete r.rings;var S=0;for(x=E.length;S<x;++S)for(w=E[S];w=w.next;)++P;S=0;for(x=G.length;S<x;++S)for(w=G[S];w=w.next;)++P;var V=vi(2.8*P,wi,gf),Z=r.arcs=[];S=0;for(x=E.length;S<x;++S){w=E[S];do v(w);while(w=w.next)}S=0;for(x=G.length;S<x;++S)if((w=G[S]).next){do v(w);while(w=w.next)}else z(w);return r}(function(r){var v,z,u=Mn(r),y=r.coordinates,C=r.lines,w=r.rings;var x=0;for(z=C.length;x<z;++x)for(var B=C[x],E=B[0],G=B[1];++E<G;)u.has(y[E])&&(v={0:E,1:B[1]},B[1]=E,B=B.next=v);x=
0;for(z=w.length;x<z;++x){C=w[x];G=B=C[0];E=C[1];for(var P=u.has(y[B]);++G<E;)if(u.has(y[G]))if(P)v={0:G,1:C[1]},C[1]=G,C=C.next=v;else{v=y;P=B;var S=E;G=E-G;xi(v,P,S);xi(v,P,P+G);xi(v,P+G,S);y[E]=y[B];P=!0;G=B}}return r}(function(r){function v(P){P&&vh.call(E,P.type)&&E[P.type](P)}function z(P){for(var S=0,V=P.length;S<V;++S)B[++C]=P[S];P={0:C-V+1,1:C};return w.push(P),P}function u(P){for(var S=0,V=P.length;S<V;++S)B[++C]=P[S];P={0:C-V+1,1:C};return x.push(P),P}function y(P){return P.map(u)}var C=
-1,w=[],x=[],B=[],E={GeometryCollection:function(P){P.geometries.forEach(v)},LineString:function(P){P.arcs=z(P.arcs)},MultiLineString:function(P){P.arcs=P.arcs.map(z)},Polygon:function(P){P.arcs=P.arcs.map(u)},MultiPolygon:function(P){P.arcs=P.arcs.map(y)}},G;for(G in r)v(r[G]);return{type:"Topology",coordinates:B,lines:w,rings:x,objects:r}}(b))),h=l.coordinates,m=vi(1.4*l.arcs.length,Qn,Rn);b=l.objects;l.bbox=f;l.arcs=l.arcs.map(function(r,v){return m.set(r,v),h.slice(r[0],r[1]+1)});delete l.coordinates;
h=null;var q={GeometryCollection:function(r){r.geometries.forEach(e)},LineString:function(r){r.arcs=k(r.arcs)},MultiLineString:function(r){r.arcs=r.arcs.map(k)},Polygon:function(r){r.arcs=r.arcs.map(k)},MultiPolygon:function(r){r.arcs=r.arcs.map(d)}},n;for(n in b)e(b[n]);return c&&(l.transform=c,l.arcs=function(r){for(var v=-1,z=r.length;++v<z;){var u=r[v],y=0,C=1,w=u.length;var x=u[0];for(var B=x[0],E=x[1];++y<w;){var G=(x=u[y])[0];x=x[1];G===B&&x===E||(u[C++]=[G-B,x-E],B=G,E=x)}1===C&&(u[C++]=[0,
0]);u.length=C}return r}(l.arcs)),l}function Qn(b){var c,e=b[0];b=b[1];return b<e&&(c=e,e=b,b=c),e+31*b}function Rn(b,c){var e,k=b[0];b=b[1];var d=c[0];c=c[1];return b<k&&(e=k,k=b,b=e),c<d&&(e=d,d=c,c=e),k===d&&b===c}function Sn(b,c){if(void 0===c&&(c={}),"FeatureCollection"!==qc(b))throw Error("geojson must be a FeatureCollection");if(!b.features.length)throw Error("geojson is empty");!1!==c.mutate&&void 0!==c.mutate||(b=Dc(b));var e=[];Rb(b,function(k){e.push(k.geometry)});b=Pn({geoms:O(e).geometry});
return function(k){return jk(k,Ln.apply(this,arguments))}(b,b.objects.geoms.geometries)}function Tn(b,c){if(void 0===c&&(c={}),!ta(c=c||{}))throw Error("options is invalid");var e=c.mutate;if("FeatureCollection"!==qc(b))throw Error("geojson must be a FeatureCollection");if(!b.features.length)throw Error("geojson is empty");!1!==e&&void 0!==e||(b=Dc(b));e=function(k){var d={};Rb(k,function(f){d[f.geometry.type]=!0});k=Object.keys(d);return 1===k.length?k[0]:null}(b);if(!e)throw Error("geojson must be homogenous");
switch(e){case "LineString":return In(b,c);case "Polygon":return Sn(b,c);default:throw Error(e+" is not supported");}}function hf(b,c){void 0===c&&(c={});c="object"==typeof c?c.mutate:c;if(!b)throw Error("geojson is required");var e=qc(b),k=[];switch(e){case "LineString":k=zi(b);break;case "MultiLineString":case "Polygon":Y(b).forEach(function(f){k.push(zi(f))});break;case "MultiPolygon":Y(b).forEach(function(f){var l=[];f.forEach(function(h){l.push(zi(h))});k.push(l)});break;case "Point":return b;
case "MultiPoint":var d={};Y(b).forEach(function(f){var l=f.join("-");Object.prototype.hasOwnProperty.call(d,l)||(k.push(f),d[l]=!0)});break;default:throw Error(e+" geometry not supported");}return b.coordinates?!0===c?(b.coordinates=k,b):{type:e,coordinates:k}:!0===c?(b.geometry.coordinates=k,b):g({type:e,coordinates:k},b.properties,{bbox:b.bbox,id:b.id})}function zi(b){b=Y(b);if(2===b.length&&!mk(b[0],b[1]))return b;var c=[],e=b.length-1,k=c.length;c.push(b[0]);for(var d=1;d<e;d++){var f=c[c.length-
1];b[d][0]===f[0]&&b[d][1]===f[1]||(c.push(b[d]),2<(k=c.length)&&nk(c[k-3],c[k-1],c[k-2])&&c.splice(c.length-2,1))}if(c.push(b[b.length-1]),k=c.length,mk(b[0],b[b.length-1])&&4>k)throw Error("invalid polygon");return nk(c[k-3],c[k-1],c[k-2])&&c.splice(c.length-2,1),c}function mk(b,c){return b[0]===c[0]&&b[1]===c[1]}function nk(b,c,e){var k=e[0];e=e[1];var d=b[0];b=b[1];var f=c[0];c=c[1];var l=f-d,h=c-b;return 0===(k-d)*h-(e-b)*l&&(Math.abs(l)>=Math.abs(h)?0<l?d<=k&&k<=f:f<=k&&k<=d:0<h?b<=e&&e<=c:
c<=e&&e<=b)}function Ai(b,c,e,k,d){for(var f,l=k,h=c+1;h<e;h++){var m=b[h],q=b[c];var n=b[e];var r=q.x;q=q.y;var v=n.x-r,z=n.y-q;if(0!==v||0!==z){var u=((m.x-r)*v+(m.y-q)*z)/(v*v+z*z);1<u?(r=n.x,q=n.y):0<u&&(r+=v*u,q+=z*u)}n=(v=m.x-r)*v+(z=m.y-q)*z;n>l&&(f=h,l=n)}l>k&&(1<f-c&&Ai(b,c,f,k,d),d.push(b[f]),1<e-f&&Ai(b,f,e,k,d))}function Bi(b,c,e){if(2>=b.length)return b;c=void 0!==c?c*c:1;if(!e){for(var k,d,f,l=b[0],h=[l],m=1,q=b.length;m<q;m++)k=b[m],f=l,e=(d=k).x-f.x,d=d.y-f.y,e*e+d*d>c&&(h.push(k),
l=k);b=(l!==k&&h.push(k),h)}k=b.length-1;e=[b[0]];return Ai(b,0,k,c,e),e.push(b[k]),e}function ok(b,c,e){return Bi(b.map(function(k){return{x:k[0],y:k[1],z:k[2]}}),c,e).map(function(k){return k.z?[k.x,k.y,k.z]:[k.x,k.y]})}function pk(b,c,e){return b.map(function(k){k=k.map(function(f){return{x:f[0],y:f[1]}});if(4>k.length)throw Error("invalid polygon");for(var d=Bi(k,c,e).map(function(f){return[f.x,f.y]});3>d.length||3===d.length&&d[2][0]===d[0][0]&&d[2][1]===d[0][1];)d=Bi(k,c-=.01*c,e).map(function(f){return[f.x,
f.y]});return d[d.length-1][0]===d[0][0]&&d[d.length-1][1]===d[0][1]||d.push(d[0]),d})}function qk(b,c){void 0===c&&(c={});var e=c.resolution||1E4,k=c.sharpness||.85,d=[];b=Ib(b).coordinates.map(function(l){return{x:l[0],y:l[1]}});var f=new Un({duration:e,points:b,sharpness:k});e=function(l){var h=f.pos(l);0==Math.floor(l/100)%2&&d.push([h.x,h.y])};for(k=0;k<f.duration;k+=10)e(k);return e(f.duration),K(d,c.properties)}function Ci(b,c){void 0===c&&(c={});var e=Number(b[0]),k=Number(b[1]),d=Number(b[2]),
f=Number(b[3]);if(6===b.length)throw Error("@turf/bbox-polygon does not support BBox with 6 positions");var l=[e,k];return D([[l,[d,k],[d,f],[e,f],l]],c.properties,{bbox:b,id:c.id})}function rk(b){return Ci(ya(b))}function sk(b){var c=b[0],e=b[1],k=b[2],d=b[3];if(Lb(b.slice(0,2),[k,e])>=Lb(b.slice(0,2),[c,d]))return e=(e+d)/2,[c,e-(k-c)/2,k,e+(k-c)/2];c=(c+k)/2;return[c-(d-e)/2,e,c+(d-e)/2,d]}function je(b,c,e,k){void 0===k&&(k={});var d=aa(b);b=ma(d[0]);d=ma(d[1]);e=ma(e);c=fa(c,k.units);var f=Math.asin(Math.sin(d)*
Math.cos(c)+Math.cos(d)*Math.sin(c)*Math.cos(e));return t([ha(b+Math.atan2(Math.sin(e)*Math.sin(c)*Math.cos(d),Math.cos(c)-Math.sin(d)*Math.sin(f))),ha(f)],k.properties)}function Di(b,c,e){void 0===e&&(e={});for(var k=e.steps||64,d=e.properties?e.properties:!Array.isArray(b)&&"Feature"===b.type&&b.properties?b.properties:{},f=[],l=0;l<k;l++)f.push(je(b,c,-360*l/k,e).geometry.coordinates);return f.push(f[0]),D([f],d)}function Ae(b,c,e){if(void 0===e&&(e={}),!0===e.final)return(Ae(c,b)+180)%360;e=aa(b);
var k=aa(c);c=ma(e[0]);b=ma(k[0]);e=ma(e[1]);k=ma(k[1]);return ha(Math.atan2(Math.sin(b-c)*Math.cos(k),Math.cos(e)*Math.sin(k)-Math.sin(e)*Math.cos(k)*Math.cos(b-c)))}function wh(b,c){void 0===c&&(c={});b=ya(b);return t([(b[0]+b[2])/2,(b[1]+b[3])/2],c.properties,c)}function Ne(b,c){void 0===c&&(c={});var e=0,k=0,d=0;return Ca(b,function(f){e+=f[0];k+=f[1];d++},!0),t([e/d,k/d],c.properties)}function xh(b){var c=[];return"FeatureCollection"===b.type?Sa(b,function(e){Ca(e,function(k){c.push(t(k,e.properties))})}):
Ca(b,function(e){c.push(t(e,b.properties))}),J(c)}function yh(b,c,e){e=e||2;var k,d,f,l=c&&c.length,h=l?c[0]*e:b.length,m=tk(b,0,h,e,!0),q=[];if(!m)return q;if(l){l=e;var n,r=[];var v=0;for(n=c.length;v<n;v++){(k=tk(b,c[v]*l,v<n-1?c[v+1]*l:b.length,l,!1))===k.next&&(k.steiner=!0);var z=r,u=z.push,y=k,C=k;do y.x<C.x&&(C=y),y=y.next;while(y!==k);u.call(z,C)}r.sort(Vn);for(v=0;v<r.length;v++)Wn(r[v],m),m=qg(m,m.next)}if(b.length>80*e){var w=c=b[0];var x=k=b[1];for(l=e;l<h;l+=e)(d=b[l])<w&&(w=d),(f=b[l+
1])<x&&(x=f),d>c&&(c=d),f>k&&(k=f);var B=0!==(B=Math.max(c-w,k-x))?1/B:0}return rg(m,q,e,w,x,B),q}function tk(b,c,e,k,d){if(d===0<Ei(b,c,e,k))for(d=c;d<e;d+=k)var f=uk(d,b[d],b[d+1],f);else for(d=e-k;d>=c;d-=k)f=uk(d,b[d],b[d+1],f);return f&&jf(f,f.next)&&(sg(f),f=f.next),f}function qg(b,c){if(!b)return b;c||=b;var e=b;do if(b=!1,e.steiner||!jf(e,e.next)&&0!==Mc(e.prev,e,e.next))e=e.next;else{if(sg(e),(e=c=e.prev)===e.next)break;b=!0}while(b||e!==c);return c}function rg(b,c,e,k,d,f,l){if(b){if(!l&&
f){var h=b,m=h;do null===m.z&&(m.z=Fi(m.x,m.y,k,d,f)),m.prevZ=m.prev,m=m.nextZ=m.next;while(m!==h);m.prevZ.nextZ=null;m.prevZ=null;h=m;var q,n,r,v,z=1;do{m=h;var u=h=null;for(r=0;m;){r++;var y=m;for(q=v=0;q<z&&(v++,y=y.nextZ);q++);for(q=z;0<v||0<q&&y;)0!==v&&(0===q||!y||m.z<=y.z)?(n=m,m=m.nextZ,v--):(n=y,y=y.nextZ,q--),u?u.nextZ=n:h=n,n.prevZ=u,u=n;m=y}u.nextZ=null;z*=2}while(1<r)}for(m=b;b.prev!==b.next;){n=b.prev;h=b.next;if(f)a:{y=b;z=k;q=d;var C=f;u=y.prev;r=y.next;if(0<=Mc(u,y,r))y=!1;else{var w=
u.x>y.x?u.x>r.x?u.x:r.x:y.x>r.x?y.x:r.x,x=u.y>y.y?u.y>r.y?u.y:r.y:y.y>r.y?y.y:r.y;v=Fi(u.x<y.x?u.x<r.x?u.x:r.x:y.x<r.x?y.x:r.x,u.y<y.y?u.y<r.y?u.y:r.y:y.y<r.y?y.y:r.y,z,q,C);z=Fi(w,x,z,q,C);q=y.prevZ;for(C=y.nextZ;q&&q.z>=v&&C&&C.z<=z;){if(q!==y.prev&&q!==y.next&&Df(u.x,u.y,y.x,y.y,r.x,r.y,q.x,q.y)&&0<=Mc(q.prev,q,q.next)||(q=q.prevZ,C!==y.prev&&C!==y.next&&Df(u.x,u.y,y.x,y.y,r.x,r.y,C.x,C.y)&&0<=Mc(C.prev,C,C.next))){y=!1;break a}C=C.nextZ}for(;q&&q.z>=v;){if(q!==y.prev&&q!==y.next&&Df(u.x,u.y,y.x,
y.y,r.x,r.y,q.x,q.y)&&0<=Mc(q.prev,q,q.next)){y=!1;break a}q=q.prevZ}for(;C&&C.z<=z;){if(C!==y.prev&&C!==y.next&&Df(u.x,u.y,y.x,y.y,r.x,r.y,C.x,C.y)&&0<=Mc(C.prev,C,C.next)){y=!1;break a}C=C.nextZ}y=!0}}else a:if(y=b,u=y.prev,r=y.next,0<=Mc(u,y,r))y=!1;else{for(v=y.next.next;v!==y.prev;){if(Df(u.x,u.y,y.x,y.y,r.x,r.y,v.x,v.y)&&0<=Mc(v.prev,v,v.next)){y=!1;break a}v=v.next}y=!0}if(y)c.push(n.i/e),c.push(b.i/e),c.push(h.i/e),sg(b),m=b=h.next;else if((b=h)===m){if(l)if(1===l){l=rg;n=c;h=e;m=b;do y=m.prev,
u=m.next.next,!jf(y,u)&&vk(y,m,m.next,u)&&tg(y,u)&&tg(u,y)&&(n.push(y.i/h),n.push(m.i/h),n.push(u.i/h),sg(m),sg(m.next),m=b=u),m=m.next;while(m!==b);l(m,c,e,k,d,f,2)}else{if(2===l)a:{l=b;do{for(n=l.next.next;n!==l.prev;){if(l.i!==n.i&&Xn(l,n)){b=wk(l,n);l=qg(l,l.next);b=qg(b,b.next);rg(l,c,e,k,d,f);rg(b,c,e,k,d,f);break a}n=n.next}l=l.next}while(l!==b)}}else rg(qg(b),c,e,k,d,f,1);break}}}}function Vn(b,c){return b.x-c.x}function Wn(b,c){if(c=function(e,k){var d=k,f=e.x,l=e.y,h=-1/0;do{if(l<=d.y&&
l>=d.next.y&&d.next.y!==d.y){var m=d.x+(l-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(m<=f&&m>h){if(h=m,m===f){if(l===d.y)return d;if(l===d.next.y)return d.next}var q=d.x<d.next.x?d:d.next}}d=d.next}while(d!==k);if(!q)return null;if(f===h)return q.prev;var n;k=q;m=q.x;var r=q.y,v=1/0;for(d=q.next;d!==k;)f>=d.x&&d.x>=m&&f!==d.x&&Df(l<r?f:h,l,m,r,l<r?h:f,l,d.x,d.y)&&((n=Math.abs(l-d.y)/(f-d.x))<v||n===v&&d.x>q.x)&&tg(d,e)&&(q=d,v=n),d=d.next;return q}(b,c))b=wk(c,b),qg(b,b.next)}function Fi(b,c,e,k,d){return 1431655765&
((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-e)*d)|b<<8))|b<<4))|b<<2))|b<<1)|(1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-k)*d)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function Df(b,c,e,k,d,f,l,h){return 0<=(d-l)*(c-h)-(b-l)*(f-h)&&0<=(b-l)*(k-h)-(e-l)*(c-h)&&0<=(e-l)*(f-h)-(d-l)*(k-h)}function Xn(b,c){return b.next.i!==c.i&&b.prev.i!==c.i&&!function(e,k){var d=e;do{if(d.i!==e.i&&d.next.i!==e.i&&d.i!==k.i&&d.next.i!==k.i&&vk(d,d.next,e,k))return!0;d=d.next}while(d!==e);return!1}(b,
c)&&tg(b,c)&&tg(c,b)&&function(e,k){var d=e,f=!1,l=(e.x+k.x)/2;k=(e.y+k.y)/2;do d.y>k!=d.next.y>k&&d.next.y!==d.y&&l<(d.next.x-d.x)*(k-d.y)/(d.next.y-d.y)+d.x&&(f=!f),d=d.next;while(d!==e);return f}(b,c)}function Mc(b,c,e){return(c.y-b.y)*(e.x-c.x)-(c.x-b.x)*(e.y-c.y)}function jf(b,c){return b.x===c.x&&b.y===c.y}function vk(b,c,e,k){return!!(jf(b,c)&&jf(e,k)||jf(b,k)&&jf(e,c))||0<Mc(b,c,e)!=0<Mc(b,c,k)&&0<Mc(e,k,b)!=0<Mc(e,k,c)}function tg(b,c){return 0>Mc(b.prev,b,b.next)?0<=Mc(b,c,b.next)&&0<=Mc(b,
b.prev,c):0>Mc(b,c,b.prev)||0>Mc(b,b.next,c)}function wk(b,c){var e=new Gi(b.i,b.x,b.y),k=new Gi(c.i,c.x,c.y),d=b.next,f=c.prev;return b.next=c,c.prev=b,e.next=d,d.prev=e,k.next=e,e.prev=k,f.next=k,k.prev=f,k}function uk(b,c,e,k){b=new Gi(b,c,e);return k?(b.next=k.next,b.prev=k,k.next.prev=b,k.next=b):(b.prev=b,b.next=b),b}function sg(b){b.next.prev=b.prev;b.prev.next=b.next;b.prevZ&&(b.prevZ.nextZ=b.nextZ);b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function Gi(b,c,e){this.i=b;this.x=c;this.y=e;this.nextZ=
this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function Ei(b,c,e,k){for(var d=0,f=e-k;c<e;c+=k)d+=(b[f]-b[c])*(b[c+1]+b[f+1]),f=c;return d}function xk(b){var c=function(l){for(var h=l[0][0].length,m={vertices:[],holes:[],dimensions:h},q=0,n=0;n<l.length;n++){for(var r=0;r<l[n].length;r++)for(var v=0;v<h;v++)m.vertices.push(l[n][r][v]);0<n&&(q+=l[n-1].length,m.holes.push(q))}return m}(b),e=yk(c.vertices,c.holes,2);b=[];var k=[];e.forEach(function(l,h){l=e[h];k.push([c.vertices[2*l],c.vertices[2*
l+1]])});for(var d=0;d<k.length;d+=3){var f=k.slice(d,d+3);f.push(k[d]);b.push(D([f]))}return b}function zh(b,c){if(!b)throw Error("targetPoint is required");if(!c)throw Error("points is required");var e,k=1/0,d=0;return Sa(c,function(f,l){f=Lb(b,f);f<k&&(d=l,k=f)}),(e=Dc(c.features[d])).properties.featureIndex=d,e.properties.distanceToPoint=k,e}function kf(b){if(!b)throw Error("geojson is required");var c=[];return Rb(b,function(e){!function(k,d){var f=[],l=k.geometry;if(null!==l){switch(l.type){case "Polygon":f=
Y(l);break;case "LineString":f=[Y(l)]}f.forEach(function(h){(function(m,q){var n=[];return m.reduce(function(r,v){var z=K([r,v],q),u=r[0];r=r[1];var y=v[0],C=v[1];return z.bbox=[u<y?u:y,r<C?r:C,u>y?u:y,r>C?r:C],n.push(z),v}),n})(h,k.properties).forEach(function(m){m.id=d.length;d.push(m)})})}}(e,c)}),J(c)}function ug(b,c,e){if(null!==b){var k,d,f,l,h=0;var m=b.type;for(var q="FeatureCollection"===m,n="Feature"===m,r=q?b.features.length:1,v=0;v<r;v++){var z=(f=!!(d=q?b.features[v].geometry:n?b.geometry:
b)&&"GeometryCollection"===d.type)?d.geometries.length:1;for(var u=0;u<z;u++){var y=0,C=0;if(null!==(k=f?d.geometries[u]:d)){var w=k.coordinates;var x=k.type;switch(l=!e||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case "Point":if(!1===c(w,h,v,y,C))return!1;h++;break;case "LineString":case "MultiPoint":for(m=0;m<w.length;m++){if(!1===c(w[m],h,v,y,C))return!1;h++;"MultiPoint"===x&&y++}"LineString"===x&&y++;break;case "Polygon":case "MultiLineString":for(m=0;m<w.length;m++){for(k=0;k<w[m].length-
l;k++){if(!1===c(w[m][k],h,v,y,C))return!1;h++}"MultiLineString"===x&&y++;"Polygon"===x&&C++}"Polygon"===x&&y++;break;case "MultiPolygon":for(m=0;m<w.length;m++){for(k=C=0;k<w[m].length;k++){for(x=0;x<w[m][k].length-l;x++){if(!1===c(w[m][k][x],h,v,y,C))return!1;h++}C++}y++}break;case "GeometryCollection":for(m=0;m<k.geometries.length;m++)if(!1===ug(k.geometries[m],c,e))return!1;break;default:throw Error("Unknown Geometry Type");}}}}}}function zk(b,c){var e;switch(b.type){case "FeatureCollection":for(e=
0;e<b.features.length&&!1!==c(b.features[e].properties,e);e++);break;case "Feature":c(b.properties,0)}}function Ak(b,c){if("Feature"===b.type)c(b,0);else if("FeatureCollection"===b.type)for(var e=0;e<b.features.length&&!1!==c(b.features[e],e);e++);}function Hi(b,c){var e,k,d,f,l,h=0,m="FeatureCollection"===b.type,q="Feature"===b.type,n=m?b.features.length:1;for(e=0;e<n;e++){var r=m?b.features[e].geometry:q?b.geometry:b;var v=m?b.features[e].properties:q?b.properties:{};var z=m?b.features[e].bbox:
q?b.bbox:void 0;var u=m?b.features[e].id:q?b.id:void 0;var y=(l=!!r&&"GeometryCollection"===r.type)?r.geometries.length:1;for(d=0;d<y;d++)if(null!==(f=l?r.geometries[d]:r))switch(f.type){case "Point":case "LineString":case "MultiPoint":case "Polygon":case "MultiLineString":case "MultiPolygon":if(!1===c(f,h,v,z,u))return!1;break;case "GeometryCollection":for(k=0;k<f.geometries.length;k++)if(!1===c(f.geometries[k],h,v,z,u))return!1;break;default:throw Error("Unknown Geometry Type");}else if(!1===c(null,
h,v,z,u))return!1;h++}}function Ah(b,c){Hi(b,function(e,k,d,f,l){var h=null===e?null:e.type;switch(h){case null:case "Point":case "LineString":case "Polygon":return!1!==c(Ec.feature(e,d,{bbox:f,id:l}),k,0)&&void 0}switch(h){case "MultiPoint":var m="Point";break;case "MultiLineString":m="LineString";break;case "MultiPolygon":m="Polygon"}for(f=0;f<e.coordinates.length;f++)if(!1===c(Ec.feature({type:m,coordinates:e.coordinates[f]},d),k,f))return!1})}function Bk(b,c){Ah(b,function(e,k,d){var f=0;if(e.geometry){var l=
e.geometry.type;if("Point"!==l&&"MultiPoint"!==l){var h,m=0,q=0,n=0;return!1!==ug(e,function(r,v,z,u,y){if(void 0===h||k>m||u>q||y>n)return h=r,m=k,q=u,n=y,void(f=0);v=Ec.lineString([h,r],e.properties);if(!1===c(v,k,d,y,f))return!1;f++;h=r})&&void 0}}})}function Ck(b,c){if(!b)throw Error("geojson is required");Ah(b,function(e,k,d){if(null!==e.geometry){var f=e.geometry.coordinates;switch(e.geometry.type){case "LineString":if(!1===c(e,k,d,0,0))return!1;break;case "Polygon":for(var l=0;l<f.length;l++)if(!1===
c(Ec.lineString(f[l],e.properties),k,d,l))return!1}}})}function Ii(b){var c=[1/0,1/0,-1/0,-1/0];return Ji.coordEach(b,function(e){c[0]>e[0]&&(c[0]=e[0]);c[1]>e[1]&&(c[1]=e[1]);c[2]<e[0]&&(c[2]=e[0]);c[3]<e[1]&&(c[3]=e[1])}),c}function Dk(b){b=Uc(b);return b.insert=function(c){if("Feature"!==c.type)throw Error("invalid feature");return c.bbox=c.bbox?c.bbox:vg(c),Uc.prototype.insert.call(this,c)},b.load=function(c){var e=[];return Array.isArray(c)?c.forEach(function(k){if("Feature"!==k.type)throw Error("invalid features");
k.bbox=k.bbox?k.bbox:vg(k);e.push(k)}):Yn(c,function(k){if("Feature"!==k.type)throw Error("invalid features");k.bbox=k.bbox?k.bbox:vg(k);e.push(k)}),Uc.prototype.load.call(this,e)},b.remove=function(c,e){if("Feature"!==c.type)throw Error("invalid feature");return c.bbox=c.bbox?c.bbox:vg(c),Uc.prototype.remove.call(this,c,e)},b.clear=function(){return Uc.prototype.clear.call(this)},b.search=function(c){c=Uc.prototype.search.call(this,this.toBBox(c));return Ek(c)},b.collides=function(c){return Uc.prototype.collides.call(this,
this.toBBox(c))},b.all=function(){var c=Uc.prototype.all.call(this);return Ek(c)},b.toJSON=function(){return Uc.prototype.toJSON.call(this)},b.fromJSON=function(c){return Uc.prototype.fromJSON.call(this,c)},b.toBBox=function(c){if(c.bbox)c=c.bbox;else if(!Array.isArray(c)||4!==c.length)if(Array.isArray(c)&&6===c.length)c=[c[0],c[1],c[3],c[4]];else{if("Feature"!==c.type&&"FeatureCollection"!==c.type)throw Error("invalid geojson");c=vg(c)}return{minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]}},b}function ke(b,
c){var e={},k=[];if("LineString"===b.type&&(b=g(b)),"LineString"===c.type&&(c=g(c)),"Feature"===b.type&&"Feature"===c.type&&null!==b.geometry&&null!==c.geometry&&"LineString"===b.geometry.type&&"LineString"===c.geometry.type&&2===b.geometry.coordinates.length&&2===c.geometry.coordinates.length)return b=Fk(b,c),b&&k.push(b),J(k);var d=wg();return d.load(kf(c)),Sa(kf(b),function(f){Sa(d.search(f),function(l){if(l=Fk(f,l)){var h=Y(l).join(",");e[h]||(e[h]=!0,k.push(l))}})}),J(k)}function Fk(b,c){var e=
Y(b),k=Y(c);if(2!==e.length)throw Error("<intersects> line1 must only contain 2 coordinates");if(2!==k.length)throw Error("<intersects> line2 must only contain 2 coordinates");c=e[0][0];b=e[0][1];var d=e[1][0];e=e[1][1];var f=k[0][0],l=k[0][1],h=k[1][0],m=k[1][1];k=(m-l)*(d-c)-(h-f)*(e-b);if(0===k)return null;h=((h-f)*(b-l)-(m-l)*(c-f))/k;f=((d-c)*(b-l)-(e-b)*(c-f))/k;return 0<=h&&1>=h&&0<=f&&1>=f?t([c+h*(d-c),b+h*(e-b)]):null}function Be(b,c,e){void 0===e&&(e={});var k=t([1/0,1/0],{dist:1/0}),d=
0;return Rb(b,function(f){f=Y(f);for(var l=0;l<f.length-1;l++){var h=t(f[l]);h.properties.dist=Lb(c,h,e);var m=t(f[l+1]);m.properties.dist=Lb(c,m,e);var q=Lb(h,m,e),n=Math.max(h.properties.dist,m.properties.dist),r=Ae(h,m),v=je(c,n,r+90,e);n=je(c,n,r-90,e);v=ke(K([v.geometry.coordinates,n.geometry.coordinates]),K([h.geometry.coordinates,m.geometry.coordinates]));n=null;0<v.features.length&&((n=v.features[0]).properties.dist=Lb(c,n,e),n.properties.location=d+Lb(h,n,e));h.properties.dist<k.properties.dist&&
((k=h).properties.index=l,k.properties.location=d);m.properties.dist<k.properties.dist&&((k=m).properties.index=l+1,k.properties.location=d+q);n&&n.properties.dist<k.properties.dist&&((k=n).properties.index=l);d+=q}}),k}function Bh(b,c,e){void 0===e&&(e={});var k=aa(b),d=aa(c);d[0]+=180<d[0]-k[0]?-360:180<k[0]-d[0]?360:0;b=k[1]*Math.PI/180;var f=d[1]*Math.PI/180;c=f-b;k=Math.abs(d[0]-k[0])*Math.PI/180;k>Math.PI&&(k-=2*Math.PI);f=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(b/2+Math.PI/4));b=1E-11<Math.abs(f)?
c/f:Math.cos(b);return ka(6371008.8*Math.sqrt(c*c+b*b*k*k),"meters",e.units)}function Gk(b,c,e){if(void 0===e&&(e={}),e.method||(e.method="geodesic"),e.units||(e.units="kilometers"),!b)throw Error("pt is required");if(Array.isArray(b)?b=t(b):"Point"===b.type?b=g(b):Ob(b,"Point","point"),!c)throw Error("line is required");Array.isArray(c)?c=K(c):"LineString"===c.type?c=g(c):Ob(c,"LineString","line");var k=1/0,d=b.geometry.coordinates;return L(c,function(f){var l=f.geometry.coordinates[0];var h=f.geometry.coordinates[1];
f=e;var m=[h[0]-l[0],h[1]-l[1]];var q=[d[0]-l[0],d[1]-l[1]];q=q[0]*m[0]+q[1]*m[1];if(0>=q)l=Ki(d,l,{method:f.method,units:"degrees"});else{var n=m[0]*m[0]+m[1]*m[1];n<=q?l=Ki(d,h,{method:f.method,units:"degrees"}):(h=q/n,l=Ki(d,[l[0]+h*m[0],l[1]+h*m[1]],{method:f.method,units:"degrees"}))}l<k&&(k=l)}),ka(k,"degrees",e.units)}function Ki(b,c,e){return"planar"===e.method?Bh(b,c,e):Lb(b,c,e)}function Hk(b){b="FeatureCollection"!==b.type?"Feature"!==b.type?J([g(b)]):J([b]):b;for(var c=wh(b),e=!1,k=0;!e&&
k<b.features.length;){var d,f=b.features[k].geometry,l=!1;if("Point"===f.type)c.geometry.coordinates[0]===f.coordinates[0]&&c.geometry.coordinates[1]===f.coordinates[1]&&(e=!0);else if("MultiPoint"===f.type)for(l=!1,d=0;!l&&d<f.coordinates.length;)c.geometry.coordinates[0]===f.coordinates[d][0]&&c.geometry.coordinates[1]===f.coordinates[d][1]&&(e=!0,l=!0),d++;else if("LineString"===f.type)for(d=0;!l&&d<f.coordinates.length-1;)Ik(c.geometry.coordinates[0],c.geometry.coordinates[1],f.coordinates[d][0],
f.coordinates[d][1],f.coordinates[d+1][0],f.coordinates[d+1][1])&&(l=!0,e=!0),d++;else if("MultiLineString"===f.type)for(var h=0;h<f.coordinates.length;){l=!1;d=0;for(var m=f.coordinates[h];!l&&d<m.length-1;)Ik(c.geometry.coordinates[0],c.geometry.coordinates[1],m[d][0],m[d][1],m[d+1][0],m[d+1][1])&&(l=!0,e=!0),d++;h++}else"Polygon"!==f.type&&"MultiPolygon"!==f.type||Tb(c,f)&&(e=!0);k++}if(e)return c;e=J([]);for(k=0;k<b.features.length;k++)e.features=e.features.concat(xh(b.features[k]).features);
return t(zh(c,e).geometry.coordinates)}function Ik(b,c,e,k,d,f){return Math.sqrt((d-e)*(d-e)+(f-k)*(f-k))===Math.sqrt((b-e)*(b-e)+(c-k)*(c-k))+Math.sqrt((d-b)*(d-b)+(f-c)*(f-c))}function Li(b){return pd(b,function(c,e){a:{var k,d=0;switch(e.type){case "Polygon":e=Jk(e.coordinates);break a;case "MultiPolygon":for(k=0;k<e.coordinates.length;k++)d+=Jk(e.coordinates[k]);e=d;break a}e=0}return c+e},0)}function Jk(b){var c=0;if(b&&0<b.length){c+=Math.abs(Kk(b[0]));for(var e=1;e<b.length;e++)c-=Math.abs(Kk(b[e]))}return c}
function Kk(b){var c,e,k,d,f=0,l=b.length;if(2<l){for(d=0;d<l;d++){d===l-2?(c=l-2,e=l-1,k=0):d===l-1?(c=l-1,e=0,k=1):(c=d,e=d+1,k=d+2);var h=b[c];var m=b[e];f+=(b[k][0]*Math.PI/180-h[0]*Math.PI/180)*Math.sin(m[1]*Math.PI/180)}f=40680631590769*f/2}return f}function Mi(b,c){return void 0===c&&(c={}),M(b,function(e,k){k=k.geometry.coordinates;return e+Lb(k[0],k[1],c)},0)}function Lk(b,c,e,k){if(!ta(k=k||{}))throw Error("options is invalid");var d=[];if("Feature"===b.type)b=b.geometry.coordinates;else{if("LineString"!==
b.type)throw Error("input must be a LineString Feature or Geometry");b=b.coordinates}for(var f,l,h,m=b.length,q=0,n=0;n<b.length&&!(c>=q&&n===b.length-1);n++){if(q>c&&0===d.length){if(!(f=c-q))return d.push(b[n]),K(d);l=Ae(b[n],b[n-1])-180;h=je(b[n],f,l,k);d.push(h.geometry.coordinates)}if(q>=e)return(f=e-q)?(l=Ae(b[n],b[n-1])-180,h=je(b[n],f,l,k),d.push(h.geometry.coordinates),K(d)):(d.push(b[n]),K(d));if(q>=c&&d.push(b[n]),n===b.length-1)return K(d);q+=Lb(b[n],b[n+1],k)}if(q<c&&b.length===m)throw Error("Start position is beyond line");
c=b[b.length-1];return K([c,c])}function hd(b,c,e){void 0===e&&(e={});b=aa(b);c=Y(c);for(var k=0;k<c.length-1;k++){var d=!1;e.ignoreEndVertices&&(0===k&&(d="start"),k===c.length-2&&(d="end"),0===k&&k+1===c.length-1&&(d="both"));a:{var f=c[k],l=c[k+1],h=void 0===e.epsilon?null:e.epsilon,m=b[0],q=b[1],n=f[0];f=f[1];var r=l[0];l=l[1];var v=r-n,z=l-f,u=(b[0]-n)*z-(b[1]-f)*v;if(null!==h){if(Math.abs(u)>h){d=!1;break a}}else if(0!==u){d=!1;break a}d=d?"start"===d?Math.abs(v)>=Math.abs(z)?0<v?n<m&&m<=r:
r<=m&&m<n:0<z?f<q&&q<=l:l<=q&&q<f:"end"===d?Math.abs(v)>=Math.abs(z)?0<v?n<=m&&m<r:r<m&&m<=n:0<z?f<=q&&q<l:l<q&&q<=f:"both"===d&&(Math.abs(v)>=Math.abs(z)?0<v?n<m&&m<r:r<m&&m<n:0<z?f<q&&q<l:l<q&&q<f):Math.abs(v)>=Math.abs(z)?0<v?n<=m&&m<=r:r<=m&&m<=n:0<z?f<=q&&q<=l:l<=q&&q<=f}if(d)return!0}return!1}function Mk(b,c){b=Ib(b);c=Ib(c);var e=b.type,k=c.type;switch(e){case "Point":switch(k){case "MultiPoint":return function(d,f){var l,h=!1;for(l=0;l<f.coordinates.length;l++)if(Nk(f.coordinates[l],d.coordinates)){h=
!0;break}return h}(b,c);case "LineString":return hd(b,c,{ignoreEndVertices:!0});case "Polygon":case "MultiPolygon":return Tb(b,c,{ignoreBoundary:!0});default:throw Error("feature2 "+k+" geometry not supported");}case "MultiPoint":switch(k){case "MultiPoint":return function(d,f){for(var l=0;l<d.coordinates.length;l++){for(var h=!1,m=0;m<f.coordinates.length;m++)Nk(d.coordinates[l],f.coordinates[m])&&(h=!0);if(!h)return!1}return!0}(b,c);case "LineString":return function(d,f){for(var l=!1,h=0;h<d.coordinates.length;h++){if(!hd(d.coordinates[h],
f))return!1;l||=hd(d.coordinates[h],f,{ignoreEndVertices:!0})}return l}(b,c);case "Polygon":case "MultiPolygon":return function(d,f){for(var l=!0,h=!1,m=0;m<d.coordinates.length;m++){if(!(h=Tb(d.coordinates[1],f))){l=!1;break}h=Tb(d.coordinates[1],f,{ignoreBoundary:!0})}return l&&h}(b,c);default:throw Error("feature2 "+k+" geometry not supported");}case "LineString":switch(k){case "LineString":return function(d,f){for(var l=0;l<d.coordinates.length;l++)if(!hd(d.coordinates[l],f))return!1;return!0}(b,
c);case "Polygon":case "MultiPolygon":return function(d,f){var l=ya(f),h=ya(d);if(!Ok(l,h))return!1;h=!1;for(l=0;l<d.coordinates.length-1;l++){if(!Tb(d.coordinates[l],f))return!1;if(h||=Tb(d.coordinates[l],f,{ignoreBoundary:!0}),!h){h=d.coordinates[l];var m=d.coordinates[l+1];h=Tb([(h[0]+m[0])/2,(h[1]+m[1])/2],f,{ignoreBoundary:!0})}}return h}(b,c);default:throw Error("feature2 "+k+" geometry not supported");}case "Polygon":switch(k){case "Polygon":case "MultiPolygon":return function(d,f){var l=ya(d);
if(!Ok(ya(f),l))return!1;for(l=0;l<d.coordinates[0].length;l++)if(!Tb(d.coordinates[0][l],f))return!1;return!0}(b,c);default:throw Error("feature2 "+k+" geometry not supported");}default:throw Error("feature1 "+e+" geometry not supported");}}function Ok(b,c){return!(b[0]>c[0])&&!(b[2]<c[2])&&!(b[1]>c[1])&&!(b[3]<c[3])}function Nk(b,c){return b[0]===c[0]&&b[1]===c[1]}function Pk(b,c,e){void 0===e&&(e={});e.mask&&!e.units&&(e.units="kilometers");var k=[],d=b[0],f=b[1],l=b[2];b=b[3];var h=c/Lb([d,f],
[l,f],e)*(l-d);c=c/Lb([d,f],[d,b],e)*(b-f);var m=l-d,q=b-f;q=(q-Math.floor(q/c)*c)/2;for(d+=(m-Math.floor(m/h)*h)/2;d<=l;){for(m=f+q;m<=b;){var n=t([d,m],e.properties);e.mask?Mk(n,e.mask)&&k.push(n):k.push(n);m+=c}d+=h}return J(k)}function Qk(b,c){void 0===c&&(c={});var e=c.precision,k=c.coordinates;c=c.mutate;if(e=null==e||isNaN(e)?6:e,k=null==k||isNaN(k)?3:k,!b)throw Error("<geojson> is required");if("number"!=typeof e)throw Error("<precision> must be a number");if("number"!=typeof k)throw Error("<coordinates> must be a number");
!1!==c&&void 0!==c||(b=JSON.parse(JSON.stringify(b)));var d=Math.pow(10,e);return Ca(b,function(f){f.length>k&&f.splice(k,f.length);for(var l=0;l<f.length;l++)f[l]=Math.round(f[l]*d)/d;!0}),b}function Ni(b){if(!b)throw Error("geojson is required");var c=[];return Rb(b,function(e){c.push(e)}),J(c)}function Zn(b,c,e){function k(v,z,u,y){var C,w,x=f[v][z],B=f[v][z+1],E=f[u][y],G=f[u][y+1];if(xg(x,E)||xg(x,G)||xg(B,E)||xg(G,E))var P=null;else{P=x[0];var S=x[1],V=B[0],Z=B[1],X=E[0],ea=E[1],na=G[0],qa=
G[1],ia=(P-V)*(ea-qa)-(S-Z)*(X-na);P=0===ia?null:[((P*Z-S*V)*(X-na)-(P-V)*(X*qa-ea*na))/ia,((P*Z-S*V)*(ea-qa)-(S-Z)*(X*qa-ea*na))/ia]}null===P||(C=B[0]!==x[0]?(P[0]-x[0])/(B[0]-x[0]):(P[1]-x[1])/(B[1]-x[1]),w=G[0]!==E[0]?(P[0]-E[0])/(G[0]-E[0]):(P[1]-E[1])/(G[1]-E[1]),1<=C||0>=C||1<=w||0>=w)||(S=P,(V=!h[S])&&(h[S]=!0),c?l.push(c(P,v,z,x,B,C,u,y,E,G,w,V)):l.push(P))}function d(v,z){var u,y,C,w,x=f[v][z],B=f[v][z+1];return x[0]<B[0]?(u=x[0],y=B[0]):(u=B[0],y=x[0]),x[1]<B[1]?(C=x[1],w=B[1]):(C=B[1],
w=x[1]),{minX:u,minY:C,maxX:y,maxY:w,ring:v,edge:z}}if("Polygon"!==b.geometry.type)throw Error("The input feature must be a Polygon");void 0===e&&(e=1);var f=b.geometry.coordinates,l=[],h={};if(e){b=[];for(var m=0;m<f.length;m++)for(var q=0;q<f[m].length-1;q++)b.push(d(m,q));m=Uc();m.load(b)}for(var n=0;n<f.length;n++)for(var r=0;r<f[n].length-1;r++)if(e)m.search(d(n,r)).forEach(function(v){k(n,r,v.ring,v.edge)});else for(b=0;b<f.length;b++)for(q=0;q<f[b].length-1;q++)k(n,r,b,q);return c||(l={type:"Feature",
geometry:{type:"MultiPoint",coordinates:l}}),l}function xg(b,c){if(!b||!c||b.length!==c.length)return!1;for(var e=0,k=b.length;e<k;e++)if(b[e]instanceof Array&&c[e]instanceof Array){if(!xg(b[e],c[e]))return!1}else if(b[e]!==c[e])return!1;return!0}function $n(b){function c(){for(var w=[],x=0;x<r.features.length;x++)-1==r.features[x].properties.parent&&w.push(x);if(1<w.length)for(x=0;x<w.length;x++){for(var B=-1,E=0;E<r.features.length;E++)w[x]!=E&&Tb(r.features[w[x]].geometry.coordinates[0][0],r.features[E],
{ignoreBoundary:!0})&&Infinity>Li(r.features[E])&&(B=E);r.features[w[x]].properties.parent=B}}function e(){for(var w=0;w<r.features.length;w++)if(-1==r.features[w].properties.parent){var x=r.features[w].properties.winding;r.features[w].properties.netWinding=x;k(w,x)}}function k(w,x){for(var B=0;B<r.features.length;B++)if(r.features[B].properties.parent==w){var E=x+r.features[B].properties.winding;r.features[B].properties.netWinding=E;k(B,E)}}if("Feature"!=b.type)throw Error("The input must a geojson object of type Feature");
if(void 0===b.geometry||null==b.geometry)throw Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=b.geometry.type)throw Error("The input must be a geojson Polygon");for(var d=b.geometry.coordinates.length,f=[],l=0;l<d;l++){var h=b.geometry.coordinates[l];yg(h[0],h[h.length-1])||h.push(h[0]);f.push.apply(f,h.slice(0,h.length-1))}if(!function(w){for(var x={},B=1,E=0,G=w.length;E<G;++E){if(Object.prototype.hasOwnProperty.call(x,w[E])){B=0;break}x[w[E]]=1}return B}(f))throw Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");
f=f.length;var m=Zn(b,function(w,x,B,E,G,P,S,V,Z,X,ea,na){return[w,x,B,E,G,P,S,V,Z,X,ea,na]}),q=m.length;if(0==q){var n=[];for(l=0;l<d;l++)n.push(D([b.geometry.coordinates[l]],{parent:-1,winding:ao(b.geometry.coordinates[l])}));var r=J(n);return c(),e(),r}var v=[],z=[];for(l=0;l<d;l++)for(v.push([]),h=0;h<b.geometry.coordinates[l].length-1;h++)v[l].push([new Rk(b.geometry.coordinates[l][Ef(h+1,b.geometry.coordinates[l].length-1)],1,[l,h],[l,Ef(h+1,b.geometry.coordinates[l].length-1)],void 0)]),z.push(new Sk(b.geometry.coordinates[l][h],
[l,Ef(h-1,b.geometry.coordinates[l].length-1)],[l,h],void 0,void 0,!1,!0));for(l=0;l<q;l++)v[m[l][1]][m[l][2]].push(new Rk(m[l][0],m[l][5],[m[l][1],m[l][2]],[m[l][6],m[l][7]],void 0)),m[l][11]&&z.push(new Sk(m[l][0],[m[l][1],m[l][2]],[m[l][6],m[l][7]],void 0,void 0,!0,!0));m=z.length;for(l=0;l<v.length;l++)for(h=0;h<v[l].length;h++)v[l][h].sort(function(w,x){return w.param<x.param?-1:1});h=[];for(l=0;l<m;l++)h.push({minX:z[l].coord[0],minY:z[l].coord[1],maxX:z[l].coord[0],maxY:z[l].coord[1],index:l});
q=Uc();q.load(h);for(l=0;l<v.length;l++)for(h=0;h<v[l].length;h++)for(m=0;m<v[l][h].length;m++)u=m==v[l][h].length-1?v[l][Ef(h+1,b.geometry.coordinates[l].length-1)][0].coord:v[l][h][m+1].coord,u=q.search({minX:u[0],minY:u[1],maxX:u[0],maxY:u[1]})[0],v[l][h][m].nxtIsectAlongEdgeIn=u.index;for(l=0;l<v.length;l++)for(h=0;h<v[l].length;h++)for(m=0;m<v[l][h].length;m++){var u=v[l][h][m].coord,y=(u=q.search({minX:u[0],minY:u[1],maxX:u[0],maxY:u[1]})[0]).index;y<f?z[y].nxtIsectAlongRingAndEdge2=v[l][h][m].nxtIsectAlongEdgeIn:
yg(z[y].ringAndEdge1,v[l][h][m].ringAndEdgeIn)?z[y].nxtIsectAlongRingAndEdge1=v[l][h][m].nxtIsectAlongEdgeIn:z[y].nxtIsectAlongRingAndEdge2=v[l][h][m].nxtIsectAlongEdgeIn}f=[];for(h=l=0;h<d;h++){v=l;for(m=0;m<b.geometry.coordinates[h].length-1;m++)z[l].coord[0]<z[v].coord[0]&&(v=l),l++;q=z[v].nxtIsectAlongRingAndEdge2;for(m=0;m<z.length;m++)if(z[m].nxtIsectAlongRingAndEdge1==v||z[m].nxtIsectAlongRingAndEdge2==v){n=m;break}m=Ch([z[n].coord,z[v].coord,z[q].coord],!0)?1:-1;f.push({isect:v,parent:-1,
winding:m})}f.sort(function(w,x){return z[w.isect].coord>z[x.isect].coord?-1:1});for(n=[];0<f.length;){l=f.pop();b=l.isect;d=l.parent;h=l.winding;v=n.length;m=[z[b].coord];q=b;z[b].ringAndEdge1Walkable?(u=z[b].ringAndEdge1,y=z[b].nxtIsectAlongRingAndEdge1):(u=z[b].ringAndEdge2,y=z[b].nxtIsectAlongRingAndEdge2);for(;!yg(z[b].coord,z[y].coord);){m.push(z[y].coord);var C=void 0;for(l=0;l<f.length;l++)if(f[l].isect==y){C=l;break}if(null!=C&&f.splice(C,1),yg(u,z[y].ringAndEdge1)){if(u=z[y].ringAndEdge2,
z[y].ringAndEdge2Walkable=!1,z[y].ringAndEdge1Walkable)l={isect:y},Ch([z[q].coord,z[y].coord,z[z[y].nxtIsectAlongRingAndEdge2].coord],1==h)?(l.parent=d,l.winding=-h):(l.parent=v,l.winding=h),f.push(l);q=y;y=z[y].nxtIsectAlongRingAndEdge2}else{if(u=z[y].ringAndEdge1,z[y].ringAndEdge1Walkable=!1,z[y].ringAndEdge2Walkable)l={isect:y},Ch([z[q].coord,z[y].coord,z[z[y].nxtIsectAlongRingAndEdge1].coord],1==h)?(l.parent=d,l.winding=-h):(l.parent=v,l.winding=h),f.push(l);q=y;y=z[y].nxtIsectAlongRingAndEdge1}}m.push(z[y].coord);
n.push(D([m],{index:v,parent:d,winding:h,netWinding:void 0}))}r=J(n);return c(),e(),r}function Ch(b,c){if(void 0===c&&(c=!0),3!=b.length)throw Error("This function requires an array of three points [x,y]");return 0<=(b[1][0]-b[0][0])*(b[2][1]-b[0][1])-(b[1][1]-b[0][1])*(b[2][0]-b[0][0])==c}function ao(b){for(var c=0,e=0;e<b.length-1;e++)b[e][0]<b[c][0]&&(c=e);return Ch([b[Ef(c-1,b.length-1)],b[c],b[Ef(c+1,b.length-1)]],!0)?1:-1}function yg(b,c){if(!b||!c||b.length!=c.length)return!1;for(var e=0,k=
b.length;e<k;e++)if(b[e]instanceof Array&&c[e]instanceof Array){if(!yg(b[e],c[e]))return!1}else if(b[e]!=c[e])return!1;return!0}function Ef(b,c){return(b%c+c)%c}function Tk(b,c){var e=[],k=wg();return Rb(c,function(d){if(e.forEach(function(h,m){h.id=m}),e.length){var f=k.search(d);if(f.features.length){var l=Uk(d,f);e=e.filter(function(h){return h.id!==l.id});k.remove(l);Sa(Oi(l,d),function(h){e.push(h);k.insert(h)})}}else(e=Oi(b,d).features).forEach(function(h){h.bbox||(h.bbox=sk(ya(h)))}),k.load(J(e))}),
J(e)}function Oi(b,c){var e=[],k=Y(b)[0],d=Y(b)[b.geometry.coordinates.length-1];if(Pi(k,aa(c))||Pi(d,aa(c)))return J([b]);var f=wg();d=kf(b);f.load(d);f=f.search(c);if(!f.features.length)return J([b]);var l=Uk(c,f);b=Ya(d,function(h,m,q){m=Y(m)[1];var n=aa(c);return q===l.id?(h.push(n),e.push(K(h)),Pi(n,m)?[n]:[n,m]):(h.push(m),h)},[k]);return 1<b.length&&e.push(K(b)),J(e)}function Uk(b,c){if(!c.features.length)throw Error("lines must contain features");if(1===c.features.length)return c.features[0];
var e,k=1/0;return Sa(c,function(d){var f=Be(d,b).properties.dist;f<k&&(e=d,k=f)}),e}function Pi(b,c){return b[0]===c[0]&&b[1]===c[1]}function Vk(b,c,e,k,d){void 0===d&&(d={});var f=d.steps||64;e=Wk(e);var l=Wk(k);k=Array.isArray(b)||"Feature"!==b.type?{}:b.properties;if(e===l)return K(Di(b,c,d).geometry.coordinates[0],k);l=e<l?l:l+360;for(var h=e,m=[],q=0;h<l;)m.push(je(b,c,h,d).geometry.coordinates),h=e+360*++q/f;return h>l&&m.push(je(b,c,l,d).geometry.coordinates),K(m,k)}function Wk(b){b%=360;
return 0>b&&(b+=360),b}function zg(b,c){void 0===c&&(c={});var e=Ib(b);switch(c.properties||"Feature"!==b.type||(c.properties=b.properties),e.type){case "Polygon":return Qi(e,c);case "MultiPolygon":return function(k,d){void 0===d&&(d={});var f=Ib(k).coordinates,l=d.properties?d.properties:"Feature"===k.type?k.properties:{},h=[];return f.forEach(function(m){h.push(Xk(m,l))}),J(h)}(e,c);default:throw Error("invalid poly");}}function Qi(b,c){return void 0===c&&(c={}),Xk(Ib(b).coordinates,c.properties?
c.properties:"Feature"===b.type?b.properties:{})}function Xk(b,c){return 1<b.length?I(b,c):K(b[0],c)}function Yk(b,c){var e,k,d;void 0===c&&(c={});var f=c.properties,l=null===(e=c.autoComplete)||void 0===e||e,h=null===(k=c.orderCoords)||void 0===k||k;switch(null!==(d=c.mutate)&&void 0!==d&&d||(b=Dc(b)),b.type){case "FeatureCollection":var m=[];return b.features.forEach(function(q){m.push(Y(Zk(q,{},l,h)))}),T(m,f);default:return Zk(b,f,l,h)}}function Zk(b,c,e,k){c=c||("Feature"===b.type?b.properties:
{});var d=Ib(b);b=d.coordinates;d=d.type;if(!b.length)throw Error("line must contain coordinates");switch(d){case "LineString":return e&&(b=$k(b)),D([b],c);case "MultiLineString":var f=[],l=0;return b.forEach(function(h){if(e&&(h=$k(h)),k){var m=ya(K(h));m=Math.abs(m[0]-m[2])*Math.abs(m[1]-m[3]);m>l?(f.unshift(h),l=m):f.push(h)}else f.push(h)}),D(f,c);default:throw Error("geometry type "+d+" is not supported");}}function $k(b){var c=b[0],e=c[1],k=b[b.length-1],d=k[1];return c[0]===k[0]&&e===d||b.push(c),
b}function Ri(b,c,e,k){return 8&e?[b[0]+(c[0]-b[0])*(k[3]-b[1])/(c[1]-b[1]),k[3]]:4&e?[b[0]+(c[0]-b[0])*(k[1]-b[1])/(c[1]-b[1]),k[1]]:2&e?[k[2],b[1]+(c[1]-b[1])*(k[2]-b[0])/(c[0]-b[0])]:1&e?[k[0],b[1]+(c[1]-b[1])*(k[0]-b[0])/(c[0]-b[0])]:null}function Ff(b,c){var e=0;return b[0]<c[0]?e|=1:b[0]>c[2]&&(e|=2),b[1]<c[1]?e|=4:b[1]>c[3]&&(e|=8),e}function al(b,c){for(var e=[],k=0;k<b.length;k++){var d,f=void 0,l,h,m,q=void 0,n=b[k],r=c;for(m=1;8>=m;m*=2){q=[];var v=!(Ff(h=n[n.length-1],r)&m);for(l=0;l<
n.length;l++)(d=!(Ff(f=n[l],r)&m))!==v&&q.push(Ri(h,f,m,r)),d&&q.push(f),h=f,v=d;if(!(n=q).length)break}d=q;0<d.length&&(d[0][0]===d[d.length-1][0]&&d[0][1]===d[d.length-1][1]||d.push(d[0]),4<=d.length&&e.push(d))}return e}function bl(b,c,e){if(void 0===e&&(e={}),!ta(e=e||{}))throw Error("options is invalid");var k,d=e.tolerance||0,f=[],l=wg();b=kf(b);return l.load(b),L(c,function(h){var m=!1;h&&(Sa(l.search(h),function(q){if(!1===m){var n=Y(h).sort(),r=Y(q).sort();Gf(n,r)||(0===d?hd(n[0],q)&&hd(n[1],
q):Be(q,n[0]).properties.dist<=d&&Be(q,n[1]).properties.dist<=d)?(m=!0,k=k?cl(k,h):h):(0===d?hd(r[0],h)&&hd(r[1],h):Be(h,r[0]).properties.dist<=d&&Be(h,r[1]).properties.dist<=d)&&(k=k?cl(k,q):q)}}),!1===m&&k&&(f.push(k),k=void 0))}),k&&f.push(k),J(f)}function cl(b,c){c=Y(c);var e=Y(b),k=e[0];e=e[e.length-1];var d=b.geometry.coordinates;return Gf(c[0],k)?d.unshift(c[1]):Gf(c[0],e)?d.push(c[1]):Gf(c[1],k)?d.unshift(c[0]):Gf(c[1],e)&&d.push(c[0]),b}function dl(b){b%=360;return 0>b&&(b+=360),b}function lf(b,
c,e){var k;return void 0===e&&(e={}),180<(k=e.final?el(aa(c),aa(b)):el(aa(b),aa(c)))?-(360-k):k}function el(b,c){var e=ma(b[1]),k=ma(c[1]);b=ma(c[0]-b[0]);b>Math.PI&&(b-=2*Math.PI);b<-Math.PI&&(b+=2*Math.PI);return(ha(Math.atan2(b,Math.log(Math.tan(k/2+Math.PI/4)/Math.tan(e/2+Math.PI/4))))+360)%360}function Hf(b,c,e,k){void 0===k&&(k={});var d=0>c;c=ka(Math.abs(c),k.units,"meters");d&&(c=-Math.abs(c));b=aa(b);d=void 0;d=void 0===d?6371008.8:Number(d);c/=d;d=b[0]*Math.PI/180;var f=ma(b[1]);e=ma(e);
var l=c*Math.cos(e),h=f+l;Math.abs(h)>Math.PI/2&&(h=0<h?Math.PI-h:-Math.PI-h);var m=Math.log(Math.tan(h/2+Math.PI/4)/Math.tan(f/2+Math.PI/4));e=[(180*(d+c*Math.sin(e)/(1E-11<Math.abs(m)?l/m:Math.cos(f)))/Math.PI+540)%360-180,180*h/Math.PI];return e[0]+=180<e[0]-b[0]?-360:180<b[0]-e[0]?360:0,t(e,k.properties)}function fl(b,c,e,k,d,f){for(var l=0;l<b.length;l++){var h=b[l];k=b[l+1];l===b.length-1&&(k=b[0]);k=Ag(h,k,c);0>=e&&0<k?0>Ag(c,h,d)||(d=h):0<e&&0>=k&&(0<Ag(c,h,f)||(f=h));e=k}return[d,f]}function Ag(b,
c,e){return(c[0]-b[0])*(e[1]-b[1])-(e[0]-b[0])*(c[1]-b[1])}function Dh(b){for(var c,e=Y(b),k=0,d=1;d<e.length;)b=c||e[0],k+=((c=e[d])[0]-b[0])*(c[1]+b[1]),d++;return 0<k}function Eh(b,c){switch("Feature"===b.type?b.geometry.type:b.type){case "GeometryCollection":return Zb(b,function(e){Eh(e,c)}),b;case "LineString":return gl(Y(b),c),b;case "Polygon":return hl(Y(b),c),b;case "MultiLineString":return Y(b).forEach(function(e){gl(e,c)}),b;case "MultiPolygon":return Y(b).forEach(function(e){hl(e,c)}),
b;case "Point":case "MultiPoint":return b}}function gl(b,c){Dh(b)===c&&b.reverse()}function hl(b,c){Dh(b[0])!==c&&b[0].reverse();for(var e=1;e<b.length;e++)Dh(b[e])===c&&b[e].reverse()}function bo(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.zProperty||"elevation",k=c.flip;c=c.flags;Ka(b,"Point","input must contain Points");b=function(q,n){var r={};return Sa(q,function(v){var z=Y(v)[1];r[z]||(r[z]=[]);r[z].push(v)}),Object.keys(r).map(function(v){return r[v].sort(function(z,u){return Y(z)[0]-
Y(u)[0]})}).sort(function(v,z){return n?Y(v[0])[1]-Y(z[0])[1]:Y(z[0])[1]-Y(v[0])[1]})}(b,k);k=[];for(var d=0;d<b.length;d++){for(var f=b[d],l=[],h=0;h<f.length;h++){var m=f[h];m.properties[e]?l.push(m.properties[e]):l.push(0);!0===c&&(m.properties.matrixPosition=[d,h])}k.push(l)}return k}function co(b,c,e,k){k=k||{};for(var d=Object.keys(il),f=0;f<d.length;f++){var l=d[f],h=k[l];h=null!=h?h:il[l];mf[l]=h}mf.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+c+":"+(c+e)+"]");
var m;b=function(q,n,r){var v=q.length-1,z=q[0].length-1,u={rows:v,cols:z,cells:[]};r=n+Math.abs(r);for(var y=0;y<v;++y){u.cells[y]=[];for(var C=0;C<z;++C){var w=0,x=q[y+1][C],B=q[y+1][C+1],E=q[y][C+1],G=q[y][C];if(!(isNaN(x)||isNaN(B)||isNaN(E)||isNaN(G))){w|=x<n?0:x>r?128:64;w|=B<n?0:B>r?32:16;w|=E<n?0:E>r?8:4;var P=+(w|=G<n?0:G>r?2:1),S=0;if(17===w||18===w||33===w||34===w||38===w||68===w||72===w||98===w||102===w||132===w||136===w||137===w||152===w||153===w)S=(x+B+E+G)/4,S=S>r?2:S<n?0:1,34===w?
1===S?w=35:0===S&&(w=136):136===w?1===S?(w=35,S=4):0===S&&(w=34):17===w?1===S?(w=155,S=4):0===S&&(w=153):68===w?1===S?(w=103,S=4):0===S&&(w=102):153===w?1===S&&(w=155):102===w?1===S&&(w=103):152===w?2>S&&(w=156,S=1):137===w?2>S&&(w=139,S=1):98===w?2>S&&(w=99,S=1):38===w?2>S&&(w=39,S=1):18===w?0<S?(w=156,S=4):w=152:33===w?0<S?(w=139,S=4):w=137:72===w?0<S?(w=99,S=4):w=98:132===w&&(0<S?(w=39,S=4):w=38);if(0!=w&&170!=w){var V,Z,X,ea,na,qa,ia;var ra=V=Z=X=ea=na=qa=ia=.5;var ja=[];1===w?(Z=1-U(n,E,G),ia=
1-U(n,x,G),ja.push(Ja[w])):169===w?(Z=U(r,G,E),ia=U(r,G,x),ja.push(Ja[w])):4===w?(na=1-U(n,B,E),X=U(n,G,E),ja.push(Ga[w])):166===w?(na=U(r,E,B),X=1-U(r,E,G),ja.push(Ga[w])):16===w?(ea=U(n,E,B),V=U(n,x,B),ja.push(Ha[w])):154===w?(ea=1-U(r,B,E),V=1-U(r,B,x),ja.push(Ha[w])):64===w?(qa=U(n,G,x),ra=1-U(n,B,x),ja.push(Ta[w])):106===w?(qa=1-U(r,x,G),ra=U(r,x,B),ja.push(Ta[w])):168===w?(X=U(r,G,E),Z=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ja.push(La[w]),ja.push(Ja[w])):2===w?(X=1-U(n,E,G),Z=1-U(r,E,G),ia=1-U(r,
x,G),qa=1-U(n,x,G),ja.push(La[w]),ja.push(Ja[w])):162===w?(ea=U(r,E,B),na=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),ja.push(La[w]),ja.push(Ja[w])):8===w?(ea=1-U(n,B,E),na=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),ja.push(Ha[w]),ja.push(Ga[w])):138===w?(ea=1-U(n,B,E),na=1-U(r,B,E),ra=1-U(r,B,x),V=1-U(n,B,x),ja.push(Ha[w]),ja.push(Ga[w])):32===w?(ea=U(r,E,B),na=U(n,E,B),ra=U(n,x,B),V=U(r,x,B),ja.push(Ha[w]),ja.push(Ga[w])):42===w?(ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B),ja.push(Ua[w]),ja.push(Ta[w])):128===
w&&(ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x),ja.push(Ua[w]),ja.push(Ta[w]));5===w?(na=1-U(n,B,E),ia=1-U(n,x,G),ja.push(Ga[w])):165===w?(na=U(r,E,B),ia=U(r,G,x),ja.push(Ga[w])):20===w?(X=U(n,G,E),V=U(n,x,B),ja.push(La[w])):150===w?(X=1-U(r,E,G),V=1-U(r,B,x),ja.push(La[w])):80===w?(ea=U(n,E,B),qa=U(n,G,x),ja.push(Ha[w])):90===w?(ea=1-U(r,B,E),qa=1-U(r,x,G),ja.push(Ha[w])):65===w?(Z=1-U(n,E,G),ra=1-U(n,B,x),ja.push(Ja[w])):105===w?(Z=U(r,G,E),ra=U(r,x,B),ja.push(Ja[w])):160===w?(ea=U(r,E,B),
na=U(n,E,B),ia=U(n,G,x),qa=U(r,G,x),ja.push(Ha[w]),ja.push(Ga[w])):10===w?(ea=1-U(n,B,E),na=1-U(r,B,E),ia=1-U(r,x,G),qa=1-U(n,x,G),ja.push(Ha[w]),ja.push(Ga[w])):130===w?(X=1-U(n,E,G),Z=1-U(r,E,G),ra=1-U(r,B,x),V=1-U(n,B,x),ja.push(La[w]),ja.push(Ja[w])):40===w?(X=U(r,G,E),Z=U(n,G,E),ra=U(n,x,B),V=U(r,x,B),ja.push(La[w]),ja.push(Ja[w])):101===w?(na=U(r,E,B),ra=U(r,x,B),ja.push(Ga[w])):69===w?(na=1-U(n,B,E),ra=1-U(n,B,x),ja.push(Ga[w])):149===w?(ia=U(r,G,x),V=1-U(r,B,x),ja.push(Ua[w])):21===w?(ia=
1-U(n,x,G),V=U(n,x,B),ja.push(Ua[w])):86===w?(X=1-U(r,E,G),qa=1-U(r,x,G),ja.push(La[w])):84===w?(X=U(n,G,E),qa=U(n,G,x),ja.push(La[w])):89===w?(ea=1-U(r,B,E),Z=U(r,G,E),ja.push(Ja[w])):81===w?(ea=U(n,E,B),Z=1-U(n,E,G),ja.push(Ja[w])):96===w?(ea=U(r,E,B),na=U(n,E,B),qa=U(n,G,x),ra=U(r,x,B),ja.push(Ha[w]),ja.push(Ga[w])):74===w?(ea=1-U(n,B,E),na=1-U(r,B,E),qa=1-U(r,x,G),ra=1-U(n,B,x),ja.push(Ha[w]),ja.push(Ga[w])):24===w?(ea=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),V=U(n,x,B),ja.push(Ha[w]),ja.push(Ja[w])):
146===w?(ea=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),V=1-U(r,B,x),ja.push(Ha[w]),ja.push(Ja[w])):6===w?(na=1-U(n,B,E),X=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ja.push(Ga[w]),ja.push(La[w])):164===w?(na=U(r,E,B),X=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ja.push(Ga[w]),ja.push(La[w])):129===w?(Z=1-U(n,E,G),ia=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x),ja.push(Ja[w]),ja.push(Ua[w])):41===w?(Z=U(r,G,E),ia=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B),ja.push(Ja[w]),ja.push(Ua[w])):66===w?(X=1-U(n,E,G),Z=1-U(r,E,G),qa=1-U(r,x,G),ra=
1-U(n,B,x),ja.push(La[w]),ja.push(Ja[w])):104===w?(X=U(r,G,E),Z=U(n,G,E),qa=U(n,G,x),ra=U(r,x,B),ja.push(Ja[w]),ja.push(eb[w])):144===w?(ea=U(n,E,B),ia=U(n,G,x),qa=U(r,G,x),V=1-U(r,B,x),ja.push(Ha[w]),ja.push(Ta[w])):26===w?(ea=1-U(r,B,E),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,B),ja.push(Ha[w]),ja.push(Ta[w])):36===w?(na=U(r,E,B),X=U(n,G,E),ra=U(n,x,B),V=U(r,x,B),ja.push(Ga[w]),ja.push(La[w])):134===w?(na=1-U(n,B,E),X=1-U(r,E,G),ra=1-U(r,B,x),V=1-U(n,B,x),ja.push(Ga[w]),ja.push(La[w])):9===w?(ea=1-U(n,
B,E),na=1-U(r,B,E),Z=U(r,G,E),ia=1-U(n,x,G),ja.push(Ha[w]),ja.push(Ga[w])):161===w?(ea=U(r,E,B),na=U(n,E,B),Z=1-U(n,E,G),ia=U(r,G,x),ja.push(Ha[w]),ja.push(Ga[w])):37===w?(na=U(r,E,B),ia=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B),ja.push(Ga[w]),ja.push(Ua[w])):133===w?(na=1-U(n,B,E),ia=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x),ja.push(Ga[w]),ja.push(Ua[w])):148===w?(X=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),V=1-U(r,B,x),ja.push(La[w]),ja.push(Ta[w])):22===w?(X=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,B),ja.push(La[w]),
ja.push(Ta[w])):82===w?(ea=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),qa=1-U(r,x,G),ja.push(Ha[w]),ja.push(Ja[w])):88===w?(ea=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),qa=U(n,G,x),ja.push(Ha[w]),ja.push(Ja[w])):73===w?(ea=1-U(n,B,E),na=1-U(r,B,E),Z=U(r,G,E),ra=1-U(n,B,x),ja.push(Ha[w]),ja.push(Ga[w])):97===w?(ea=U(r,E,B),na=U(n,E,B),Z=1-U(n,E,G),ra=U(r,x,B),ja.push(Ha[w]),ja.push(Ga[w])):145===w?(ea=U(n,E,B),Z=1-U(n,E,G),ia=U(r,G,x),V=1-U(r,B,x),ja.push(Ha[w]),ja.push(Ua[w])):25===w?(ea=1-U(r,B,E),Z=U(r,G,E),ia=1-
U(n,x,G),V=U(n,x,B),ja.push(Ha[w]),ja.push(Ua[w])):70===w?(na=1-U(n,B,E),X=1-U(r,E,G),qa=1-U(r,x,G),ra=1-U(n,B,x),ja.push(Ga[w]),ja.push(La[w])):100===w?(na=U(r,E,B),X=U(n,G,E),qa=U(n,G,x),ra=U(r,x,B),ja.push(Ga[w]),ja.push(La[w])):34===w?(0===S?(ea=1-U(n,B,E),na=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x)):(ea=U(r,E,B),na=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ua[w]),ja.push(Ta[w])):
35===w?(4===S?(ea=1-U(n,B,E),na=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x)):(ea=U(r,E,B),na=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ja[w]),ja.push(Ta[w])):136===w?(0===S?(ea=U(r,E,B),na=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)):(ea=1-U(n,B,E),na=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x)),
ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ua[w]),ja.push(Ta[w])):153===w?(0===S?(ea=U(n,E,B),Z=1-U(n,E,G),ia=1-U(n,x,G),V=U(n,x,B)):(ea=1-U(r,B,E),Z=U(r,G,E),ia=U(r,G,x),V=1-U(r,B,x)),ja.push(Ha[w]),ja.push(Ja[w])):102===w?(0===S?(na=1-U(n,B,E),X=U(n,G,E),qa=U(n,G,x),ra=1-U(n,B,x)):(na=U(r,E,B),X=1-U(r,E,G),qa=1-U(r,x,G),ra=U(r,x,B)),ja.push(Ga[w]),ja.push(Ta[w])):155===w?(4===S?(ea=U(n,E,B),Z=1-U(n,E,G),ia=1-U(n,x,G),V=U(n,x,B)):(ea=1-U(r,B,E),Z=U(r,G,E),ia=U(r,G,x),V=1-U(r,B,x)),ja.push(Ha[w]),ja.push(Ua[w])):
103===w?(4===S?(na=1-U(n,B,E),X=U(n,G,E),qa=U(n,G,x),ra=1-U(n,B,x)):(na=U(r,E,B),X=1-U(r,E,G),qa=1-U(r,x,G),ra=U(r,x,B)),ja.push(Ga[w]),ja.push(La[w])):152===w?(0===S?(ea=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,B)):(ea=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),V=1-U(r,B,x)),ja.push(Ha[w]),ja.push(La[w]),ja.push(Ja[w])):156===w?(4===S?(ea=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,B)):(ea=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),ia=
U(n,G,x),qa=U(r,G,x),V=1-U(r,B,x)),ja.push(Ha[w]),ja.push(Ja[w]),ja.push(Ta[w])):137===w?(0===S?(ea=U(r,E,B),na=U(n,E,B),Z=1-U(n,E,G),ia=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)):(ea=1-U(n,B,E),na=1-U(r,B,E),Z=U(r,G,E),ia=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ja[w])):139===w?(4===S?(ea=U(r,E,B),na=U(n,E,B),Z=1-U(n,E,G),ia=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)):(ea=1-U(n,B,E),na=1-U(r,B,E),Z=U(r,G,E),ia=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ua[w])):
98===w?(0===S?(ea=1-U(n,B,E),na=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),qa=U(n,G,x),ra=1-U(n,B,x)):(ea=U(r,E,B),na=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),qa=1-U(r,x,G),ra=U(r,x,B)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ta[w])):99===w?(4===S?(ea=1-U(n,B,E),na=1-U(r,B,E),X=U(r,G,E),Z=U(n,G,E),qa=U(n,G,x),ra=1-U(n,B,x)):(ea=U(r,E,B),na=U(n,E,B),X=1-U(n,E,G),Z=1-U(r,E,G),qa=1-U(r,x,G),ra=U(r,x,B)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ja[w])):38===w?(0===S?(na=1-U(n,B,E),X=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ra=1-
U(r,B,x),V=1-U(n,B,x)):(na=U(r,E,B),X=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)),ja.push(Ga[w]),ja.push(Ua[w]),ja.push(Ta[w])):39===w?(4===S?(na=1-U(n,B,E),X=U(n,G,E),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,B,x),V=1-U(n,B,x)):(na=U(r,E,B),X=1-U(r,E,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,B),V=U(r,x,B)),ja.push(Ga[w]),ja.push(La[w]),ja.push(Ta[w])):85===w&&(ea=1,na=0,X=1,Z=0,ia=0,qa=1,ra=0,V=1);(0>ra||1<ra||0>V||1<V||0>ea||1<ea||0>X||1<X||0>ia||1<ia||0>qa||1<qa)&&console.log("MarchingSquaresJS-isoBands: "+
w+" "+P+" "+x+","+B+","+E+","+G+" "+S+" "+ra+" "+V+" "+ea+" "+na+" "+X+" "+Z+" "+ia+" "+qa);u.cells[y][C]={cval:w,cval_real:P,flipped:S,topleft:ra,topright:V,righttop:ea,rightbottom:na,bottomright:X,bottomleft:Z,leftbottom:ia,lefttop:qa,edges:ja}}}}}return u}(b,c,e);return mf.polygons?(mf.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),m=function(q){var n=[],r=0;return q.cells.forEach(function(v,z){v.forEach(function(u,y){void 0!==u&&(u=Ea[u.cval](u),
"object"==typeof u&&Si(u)?"object"==typeof u[0]&&Si(u[0])?"object"==typeof u[0][0]&&Si(u[0][0])?u.forEach(function(C){C.forEach(function(w){w[0]+=y;w[1]+=z});n[r++]=C}):(u.forEach(function(C){C[0]+=y;C[1]+=z}),n[r++]=u):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates"))})}),n}(b)):(mf.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),
m=function(q){for(var n=[],r=q.rows,v=q.cols,z=[],u=0;u<r;u++)for(var y=0;y<v;y++)if(void 0!==q.cells[u][y]&&0<q.cells[u][y].edges.length){var C=eo(q.cells[u][y]),w=null,x=y,B=u;null!==C&&z.push([C.p[0]+x,C.p[1]+B]);do{if(null===(w=fo(q.cells[B][x],C.x,C.y,C.o)))break;if(z.push([w.p[0]+x,w.p[1]+B]),x+=w.x,C=w,0>(B+=w.y)||B>=r||0>x||x>=v||void 0===q.cells[B][x]){C=go(q,x-=w.x,B-=w.y,w.x,w.y,w.o);if(null===C)break;C.path.forEach(function(E){z.push(E)});x=C.i;B=C.j}}while(void 0!==q.cells[B][x]&&0<q.cells[B][x].edges.length);
n.push(z);z=[];0<q.cells[u][y].edges.length&&y--}return n}(b)),"function"==typeof mf.successCallback&&mf.successCallback(m),m}function U(b,c,e){return(b-c)/(e-c)}function Si(b){return-1<b.constructor.toString().indexOf("Array")}function go(b,c,e,k,d,f){for(var l,h,m=c+k,q=e+d,n=[];;){if(void 0===b.cells[q]||void 0===b.cells[q][m])if(q-=d,m-=k,h=(l=b.cells[q][m]).cval_real,-1===d){if(0===f)if(1&h)n.push([m,q]),k=-1;else{if(!(4&h)){n.push([m+l.bottomright,q]);k=0;f=d=1;break}n.push([m+1,q]);k=1}else{if(!(1&
h)){if(4&h){n.push([m+l.bottomright,q]);k=0;f=d=1;break}n.push([m+l.bottomleft,q]);k=0;d=1;f=0;break}n.push([m,q]);k=-1}f=d=0}else if(1===d){if(0===f&&!(h&Rd)){if(h&Nc){n.push([m+l.topleft,q+1]);k=0;d=-1;f=0;break}n.push([m+l.topright,q+1]);k=0;d=-1;f=1;break}n.push([m+1,q+1]);k=1;d=0;f=1}else if(-1===k){if(0===f){if(!(h&Nc)){if(1&h){n.push([m,q+l.leftbottom]);k=1;f=d=0;break}n.push([m,q+l.lefttop]);k=1;d=0;f=1;break}}else if(!(h&Nc)){console.log("MarchingSquaresJS-isoBands: wtf");break}n.push([m,
q+1]);k=0;d=1;f=0}else{if(1!==k){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===f){if(!(4&h)){n.push([m+1,q+l.rightbottom]);k=-1;f=d=0;break}}else if(!(4&h)){if(h&Rd){n.push([m+1,q+l.righttop]);k=-1;d=0;f=1;break}n.push([m+1,q+l.rightbottom]);k=-1;f=d=0;break}n.push([m+1,q]);k=0;d=-1;f=1}else if(h=(l=b.cells[q][m]).cval_real,-1===k)if(0===f)if(void 0!==b.cells[q-1]&&void 0!==b.cells[q-1][m])k=0,d=-1,f=1;else{if(!(1&h)){n.push([m+l.bottomright,q]);k=0;f=d=1;break}n.push([m,
q])}else{if(!(h&Nc)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+m+","+q);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===k){if(0===f){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==b.cells[q+1]&&void 0!==b.cells[q+1][m])k=0,d=1,f=0;else{if(!(h&Rd)){n.push([m+l.topleft,q+1]);k=0;d=-1;f=0;break}n.push([m+1,q+1]);k=1;d=0;f=1}}else if(-1===d){if(1!==f){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==b.cells[q][m+
1])k=1,d=0;else{if(!(4&h)){n.push([m+1,q+l.righttop]);k=-1;d=0;f=1;break}n.push([m+1,q]);k=0;d=-1}f=1}else{if(1!==d){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==f){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==b.cells[q][m-1])k=-1,d=0;else{if(!(h&Nc)){n.push([m,q+l.leftbottom]);k=1;f=d=0;break}n.push([m,q+1]);k=0;d=1}f=0}if(q+=d,(m+=k)===c&&q===e)break}return{path:n,i:m,j:q,x:k,y:d,o:f}}function eo(b){if(0<b.edges.length){var c=b.cval_real;
switch(b.edges[b.edges.length-1]){case 0:return c&Rd?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[b.topleft,1],x:0,y:-1,o:0};case 1:return 4&c?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[1,b.rightbottom],x:-1,y:0,o:0};case 2:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[b.topleft,1],x:0,y:-1,o:0};case 3:return 1&c?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 4:return c&Rd?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[b.topright,1],x:0,y:-1,o:1};case 5:return 4&c?{p:[b.topright,1],x:0,y:-1,o:1}:{p:[1,
b.rightbottom],x:-1,y:0,o:0};case 6:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[b.topright,1],x:0,y:-1,o:1};case 7:return 1&c?{p:[b.topright,1],x:0,y:-1,o:1}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 8:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[1,b.righttop],x:-1,y:0,o:1};case 9:return 1&c?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 10:return 1&c?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[1,b.righttop],x:-1,y:0,o:1};case 11:return c&Nc?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[0,
b.lefttop],x:1,y:0,o:1};case 12:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[1,b.rightbottom],x:-1,y:0,o:0};case 13:return 1&c?{p:[1,b.rightbottom],x:-1,y:0,o:0}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 14:return 1&c?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[1,b.rightbottom],x:-1,y:0,o:0};case 15:return c&Nc?{p:[1,b.rightbottom],x:-1,y:0,o:0}:{p:[0,b.lefttop],x:1,y:0,o:1};case 16:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[0,b.leftbottom],x:1,y:0,o:0};case 17:return c&Nc?{p:[b.bottomright,0],x:0,
y:1,o:1}:{p:[0,b.lefttop],x:1,y:0,o:1};case 18:return 1&c?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 19:return c&Nc?{p:[b.bottomleft,0],x:0,y:1,o:0}:{p:[0,b.lefttop],x:1,y:0,o:1};case 20:return c&Nc?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[0,b.leftbottom],x:1,y:0,o:0};case 21:return c&Rd?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[b.topright,1],x:0,y:-1,o:1};case 22:return c&Nc?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[0,b.lefttop],x:1,y:0,o:1};case 23:return c&Rd?{p:[0,b.lefttop],x:1,y:0,
o:1}:{p:[b.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(b)}}return null}function fo(b,c,e,k){var d,f=b.cval;switch(c){case -1:switch(k){case 0:var l=Ga[f];var h=fb[f];var m=gb[f];var q=hb[f];break;default:l=Ha[f],h=ib[f],m=jb[f],q=kb[f]}break;case 1:switch(k){case 0:l=Ua[f];h=lb[f];m=mb[f];q=nb[f];break;default:l=Ta[f],h=ob[f],m=pb[f],q=qb[f]}break;default:switch(e){case -1:switch(k){case 0:l=eb[f];h=rb[f];m=sb[f];q=tb[f];break;
default:l=Db[f],h=ub[f],m=vb[f],q=wb[f]}break;case 1:switch(k){case 0:l=Ja[f];h=xb[f];m=yb[f];q=zb[f];break;default:l=La[f],h=Ab[f],m=Bb[f],q=Cb[f]}}}if(d=b.edges.indexOf(l),void 0===b.edges[d])return null;delete b.edges[d];for(k=d+1;k<b.edges.length;k++)b.edges[k-1]=b.edges[k];b.edges.pop();switch(f=b.cval_real,l){case 0:f&Rd?(c=b.topleft,e=1):(c=1,e=b.righttop);break;case 1:4&f?(c=1,e=b.rightbottom):(c=b.topleft,e=1);break;case 2:4&f?(c=b.topleft,e=1):(c=b.bottomright,e=0);break;case 3:1&f?(c=b.bottomleft,
e=0):(c=b.topleft,e=1);break;case 4:f&Rd?(c=b.topright,e=1):(c=1,e=b.righttop);break;case 5:4&f?(c=1,e=b.rightbottom):(c=b.topright,e=1);break;case 6:4&f?(c=b.topright,e=1):(c=b.bottomright,e=0);break;case 7:1&f?(c=b.bottomleft,e=0):(c=b.topright,e=1);break;case 8:4&f?(c=1,e=b.righttop):(c=b.bottomright,e=0);break;case 9:1&f?(c=b.bottomleft,e=0):(c=1,e=b.righttop);break;case 10:1&f?(c=1,e=b.righttop):(c=0,e=b.leftbottom);break;case 11:f&Nc?(c=0,e=b.lefttop):(c=1,e=b.righttop);break;case 12:4&f?(c=
1,e=b.rightbottom):(c=b.bottomright,e=0);break;case 13:1&f?(c=b.bottomleft,e=0):(c=1,e=b.rightbottom);break;case 14:1&f?(c=1,e=b.rightbottom):(c=0,e=b.leftbottom);break;case 15:f&Nc?(c=0,e=b.lefttop):(c=1,e=b.rightbottom);break;case 16:4&f?(c=0,e=b.leftbottom):(c=b.bottomright,e=0);break;case 17:f&Nc?(c=0,e=b.lefttop):(c=b.bottomright,e=0);break;case 18:1&f?(c=b.bottomleft,e=0):(c=0,e=b.leftbottom);break;case 19:f&Nc?(c=0,e=b.lefttop):(c=b.bottomleft,e=0);break;case 20:f&Nc?(c=0,e=b.leftbottom):(c=
b.topleft,e=1);break;case 21:f&Rd?(c=b.topright,e=1):(c=0,e=b.leftbottom);break;case 22:f&Nc?(c=0,e=b.lefttop):(c=b.topleft,e=1);break;case 23:f&Rd?(c=b.topright,e=1):(c=0,e=b.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(b),null}return void 0!==c&&void 0!==e&&void 0!==h&&void 0!==m&&void 0!==q||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(b),console.log(c+" "+e+" "+h+" "+m+" "+q)),{p:[c,e],x:h,y:m,o:q}}function ho(b){var c=
[],e=[];b.forEach(function(d){var f=Li(D([d]));e.push(f);c.push({ring:d,area:f})});e.sort(function(d,f){return f-d});var k=[];return e.forEach(function(d){for(var f=0;f<c.length;f++)if(c[f].area===d){k.push(c[f].ring);c.splice(f,1);break}}),k}function io(b){b=b.map(function(l){return{lrCoordinates:l,grouped:!1}});for(var c=[];!jo(b);)for(var e=0;e<b.length;e++)if(!b[e].grouped){var k=[];k.push(b[e].lrCoordinates);b[e].grouped=!0;for(var d=D([b[e].lrCoordinates]),f=e+1;f<b.length;f++)b[f].grouped||
ko(D([b[f].lrCoordinates]),d)&&(k.push(b[f].lrCoordinates),b[f].grouped=!0);c.push(k)}return c}function ko(b,c){b=xh(b);for(var e=0;e<b.features.length;e++)if(!Tb(b.features[e],c))return!1;return!0}function jo(b){for(var c=0;c<b.length;c++)if(!1===b[c].grouped)return!1;return!0}function jl(b,c,e){if(!ta(e=e||{}))throw Error("options is invalid");var k=e.pivot;e=e.mutate;if(!b)throw Error("geojson is required");if(null==c||isNaN(c))throw Error("angle is required");return 0===c||(k||=Ne(b),!1!==e&&
void 0!==e||(b=Dc(b)),Ca(b,function(d){var f=lf(k,d)+c,l=Bh(k,d);f=Y(Hf(k,l,f));d[0]=f[0];d[1]=f[1]})),b}function kl(b,c,e){if(!ta(e=e||{}))throw Error("options is invalid");var k=e.origin;e=e.mutate;if(!b)throw Error("geojson required");if("number"!=typeof c||0===c)throw Error("invalid factor");var d=Array.isArray(k)||"object"==typeof k;return!0!==e&&(b=Dc(b)),"FeatureCollection"!==b.type||d?ll(b,c,k):(Sa(b,function(f,l){b.features[l]=ll(f,c,k)}),b)}function ll(b,c,e){var k="Point"===qc(b);return e=
function(d,f){null==f&&(f="centroid");if(Array.isArray(f)||"object"==typeof f)return aa(f);var l=d.bbox?d.bbox:ya(d),h=l[0],m=l[1],q=l[2];l=l[3];switch(f){case "sw":case "southwest":case "westsouth":case "bottomleft":return t([h,m]);case "se":case "southeast":case "eastsouth":case "bottomright":return t([q,m]);case "nw":case "northwest":case "westnorth":case "topleft":return t([h,l]);case "ne":case "northeast":case "eastnorth":case "topright":return t([q,l]);case "center":return wh(d);case void 0:case null:case "centroid":return Ne(d);
default:throw Error("invalid origin");}}(b,e),1===c||k||Ca(b,function(d){var f=Bh(e,d),l=lf(e,d);f=Y(Hf(e,f*c,l));d[0]=f[0];d[1]=f[1];3===d.length&&(d[2]*=c)}),b}function Fh(b){var c=b[0];b=b[1];return[b[0]-c[0],b[1]-c[1]]}function Ti(b,c){return b[0]*c[1]-c[0]*b[1]}function lo(b,c){return!function(e,k){return 0===Ti(Fh(e),Fh(k))}(b,c)&&function(e,k){var d=e[0];e=Fh(e);var f=k[0];k=Fh(k);var l=Ti(e,k);return function(h,m){return[h[0]+m[0],h[1]+m[1]]}(d,function(h,m){return[h*m[0],h*m[1]]}(Ti([f[0]-
d[0],f[1]-d[1]],k)/l,e))}(b,c)}function ml(b,c,e){var k=[],d=R(c,e),f=Y(b),l=[];return f.forEach(function(h,m){if(m!==f.length-1){h=(q=h,n=f[m+1],r=d,v=Math.sqrt((q[0]-n[0])*(q[0]-n[0])+(q[1]-n[1])*(q[1]-n[1])),z=q[0]+r*(n[1]-q[1])/v,u=n[0]+r*(n[1]-q[1])/v,y=q[1]+r*(q[0]-n[0])/v,C=n[1]+r*(q[0]-n[0])/v,[[z,y],[u,C]]);if(k.push(h),0<m)q=k[m-1],n=lo(h,q),!1!==n&&(q[1]=n,h[0]=n),l.push(q[0]),m===f.length-2&&(l.push(h[0]),l.push(h[1]));2===f.length&&(l.push(h[0]),l.push(h[1]))}var q,n,r,v,z,u,y,C}),K(l,
b.properties)}function Ui(b,c,e){b=(c[0]-b[0])*(e[1]-c[1])-(e[0]-c[0])*(c[1]-b[1]);return(0<b)-(0>b)||+b}function nl(b,c){return c.geometry.coordinates[0].every(function(e){return Tb(t(e),b)})}function ol(b,c){var e=!0;return Rb(b,function(k){Rb(c,function(d){if(!1===e)return!1;e=function(f,l){switch(f.type){case "Point":switch(l.type){case "Point":return h=f.coordinates,m=l.coordinates,!(h[0]===m[0]&&h[1]===m[1]);case "LineString":return!pl(l,f);case "Polygon":return!Tb(f,l)}break;case "LineString":switch(l.type){case "Point":return!pl(f,
l);case "LineString":return f=0<ke(f,l).features.length?!0:!1,!f;case "Polygon":return!ql(l,f)}break;case "Polygon":switch(l.type){case "Point":return!Tb(l,f);case "LineString":return!ql(f,l);case "Polygon":a:{h=0;for(m=l.coordinates[0];h<m.length;h++)if(Tb(m[h],f)){f=!0;break a}h=0;for(m=f.coordinates[0];h<m.length;h++)if(Tb(m[h],l)){f=!0;break a}f=0<ke(zg(l),zg(f)).features.length?!0:!1}return!f}}var h,m;return!1}(k.geometry,d.geometry)})}),e}function pl(b,c){for(var e=0;e<b.coordinates.length-
1;e++){var k=b.coordinates[e],d=b.coordinates[e+1],f=c.coordinates,l=d[0]-k[0],h=d[1]-k[1];if(0==(f[0]-k[0])*h-(f[1]-k[1])*l&&(Math.abs(l)>=Math.abs(h)?0<l?k[0]<=f[0]&&f[0]<=d[0]:d[0]<=f[0]&&f[0]<=k[0]:0<h?k[1]<=f[1]&&f[1]<=d[1]:d[1]<=f[1]&&f[1]<=k[1]))return!0}return!1}function ql(b,c){for(var e=0,k=c.coordinates;e<k.length;e++)if(Tb(k[e],b))return!0;return 0<ke(c,zg(b)).features.length}function rl(b,c){return!(b[0]>c[0])&&!(b[2]<c[2])&&!(b[1]>c[1])&&!(b[3]<c[3])}function Vi(b,c){return b[0]===c[0]&&
b[1]===c[1]}function sl(b,c){for(var e=!1,k=!1,d=b.coordinates.length,f=0;f<d&&!e&&!k;){for(var l=0;l<c.coordinates.length-1;l++){var h=!0;0!==l&&l!==c.coordinates.length-2||(h=!1);tl(c.coordinates[l],c.coordinates[l+1],b.coordinates[f],h)?e=!0:k=!0}f++}return e&&k}function ul(b,c){for(var e=!1,k=!1,d=b.coordinates.length,f=0;f<d&&(!e||!k);f++)Tb(t(b.coordinates[f]),c)?e=!0:k=!0;return k&&e}function tl(b,c,e,k){var d=c[0]-b[0],f=c[1]-b[1];return 0==(e[0]-b[0])*f-(e[1]-b[1])*d&&(k?Math.abs(d)>=Math.abs(f)?
0<d?b[0]<=e[0]&&e[0]<=c[0]:c[0]<=e[0]&&e[0]<=b[0]:0<f?b[1]<=e[1]&&e[1]<=c[1]:c[1]<=e[1]&&e[1]<=b[1]:Math.abs(d)>=Math.abs(f)?0<d?b[0]<e[0]&&e[0]<c[0]:c[0]<e[0]&&e[0]<b[0]:0<f?b[1]<e[1]&&e[1]<c[1]:c[1]<e[1]&&e[1]<b[1])}function vl(b){return b.coordinates.map(function(c){return{type:b.type.replace("Multi",""),coordinates:c}})}function wl(b,c){return b.hasOwnProperty("coordinates")?b.coordinates.length===c.coordinates.length:b.length===c.length}function mo(b,c){return Gf(b,c,{strict:!0})}function xl(b,
c){var e=!1;return Rb(b,function(k){Rb(c,function(d){if(!0===e)return!0;e=!ol(k.geometry,d.geometry)})}),e}function yl(b,c,e){e=e||[];for(var k=0;k<b;k++)e[k]=c;return e}function zl(b,c){if(b.geometry&&b.geometry.type)return b.geometry.type;if(b.type)return b.type;throw Error("Invalid GeoJSON object for "+c);}function Al(b){for(var c=[];b.parent;)c.unshift(b),b=b.parent;return c}function If(b,c){c=c||{};this.nodes=[];this.diagonal=!!c.diagonal;this.grid=[];for(c=0;c<b.length;c++){this.grid[c]=[];
for(var e=0,k=b[c];e<k.length;e++){var d=new Gh(c,e,k[e]);this.grid[c][e]=d;this.nodes.push(d)}}this.init()}function Gh(b,c,e){this.x=b;this.y=c;this.weight=e}function Bl(b){this.content=[];this.scoreFunction=b}function no(b,c){for(var e=0;e<c.features.length;e++)if(Tb(b,c.features[e]))return!0;return!1}function Cl(b){return function(){return b}}function oo(b){return b[0]}function po(b){return b[1]}function Hh(){this._=null}function Ih(b){b.U=b.C=b.L=b.R=b.P=b.N=null}function Bg(b,c){var e=c.R,k=
c.U;k?k.L===c?k.L=e:k.R=e:b._=e;e.U=k;c.U=e;c.R=e.L;c.R&&(c.R.U=c);e.L=c}function Cg(b,c){var e=c.L,k=c.U;k?k.L===c?k.L=e:k.R=e:b._=e;e.U=k;c.U=e;c.L=e.R;c.L&&(c.L.U=c);e.R=c}function Dl(b){for(;b.L;)b=b.L;return b}function Dg(b,c,e,k){var d=[null,null],f=Vc.push(d)-1;return d.left=b,d.right=c,e&&Jh(d,b,c,e),k&&Jh(d,c,b,k),qd[b.index].halfedges.push(f),qd[c.index].halfedges.push(f),d}function Eg(b,c,e){c=[c,e];return c.left=b,c}function Jh(b,c,e,k){b[0]||b[1]?b.left===e?b[1]=k:b[0]=k:(b[0]=k,b.left=
c,b.right=e)}function qo(b,c,e,k,d){var f,l=b[0],h=b[1],m=l[0];l=l[1];var q=0,n=1,r=h[0]-m;h=h[1]-l;if(f=c-m,r||!(0<f)){if(f/=r,0>r){if(f<q)return;f<n&&(n=f)}else if(0<r){if(f>n)return;f>q&&(q=f)}if(f=k-m,r||!(0>f)){if(f/=r,0>r){if(f>n)return;f>q&&(q=f)}else if(0<r){if(f<q)return;f<n&&(n=f)}if(f=e-l,h||!(0<f)){if(f/=h,0>h){if(f<q)return;f<n&&(n=f)}else if(0<h){if(f>n)return;f>q&&(q=f)}if(f=d-l,h||!(0>f)){if(f/=h,0>h){if(f>n)return;f>q&&(q=f)}else if(0<h){if(f<q)return;f<n&&(n=f)}return!(0<q||1>n)||
(0<q&&(b[0]=[m+q*r,l+q*h]),1>n&&(b[1]=[m+n*r,l+n*h]),!0)}}}}}function ro(b,c,e,k,d){var f=b[1];if(f)return!0;var l,h=b[0],m=b.left;var q=b.right;f=m[0];m=m[1];var n=q[0],r=q[1],v=(f+n)/2;if(r===m){if(v<c||v>=k)return;if(f>n){if(h){if(h[1]>=d)return}else h=[v,e];f=[v,d]}else{if(h){if(h[1]<e)return}else h=[v,d];f=[v,e]}}else if(q=(m+r)/2-(l=(f-n)/(r-m))*v,-1>l||1<l)if(f>n){if(h){if(h[1]>=d)return}else h=[(e-q)/l,e];f=[(d-q)/l,d]}else{if(h){if(h[1]<e)return}else h=[(d-q)/l,d];f=[(e-q)/l,e]}else if(m<
r){if(h){if(h[0]>=k)return}else h=[c,l*c+q];f=[k,l*k+q]}else{if(h){if(h[0]<c)return}else h=[k,l*k+q];f=[c,l*c+q]}return b[0]=h,b[1]=f,!0}function so(b,c){b=b.site;var e=c.left,k=c.right;return b===k&&(k=e,e=b),k?Math.atan2(k[1]-e[1],k[0]-e[0]):(b===e?(e=c[1],k=c[0]):(e=c[0],k=c[1]),Math.atan2(e[0]-k[0],k[1]-e[1]))}function El(b,c){return c[+(c.left!==b.site)]}function to(){Ih(this);this.x=this.y=this.arc=this.site=this.cy=null}function Jf(b){var c=b.P,e=b.N;if(c&&e){var k=c.site;c=b.site;var d=e.site;
if(k!==d){e=c[0];var f=c[1],l=k[0]-e,h=k[1]-f;k=d[0]-e;var m=d[1]-f;d=2*(l*m-h*k);if(!(d>=-uo)){var q=l*l+h*h,n=k*k+m*m;h=(m*q-h*n)/d;k=(l*n-k*q)/d;l=Fl.pop()||new to;l.arc=b;l.site=c;l.x=h+e;l.y=(l.cy=k+f)+Math.sqrt(h*h+k*k);b.circle=l;b=null;for(c=Fg._;c;)if(l.y<c.y||l.y===c.y&&l.x<=c.x){if(!c.L){b=c.P;break}c=c.L}else{if(!c.R){b=c;break}c=c.R}Fg.insert(b,l);b||(Wi=l)}}}}function Kf(b){var c=b.circle;c&&(c.P||(Wi=c.N),Fg.remove(c),Fl.push(c),Ih(c),b.circle=null)}function vo(){Ih(this);this.edge=
this.site=this.circle=null}function Gl(b){var c=Hl.pop()||new vo;return c.site=b,c}function Xi(b){Kf(b);Lf.remove(b);Hl.push(b);Ih(b)}function wo(b){var c=b.circle,e=c.x,k=c.cy;c=[e,k];var d=b.P,f=b.N,l=[b];Xi(b);for(b=d;b.circle&&Math.abs(e-b.circle.x)<Wb&&Math.abs(k-b.circle.cy)<Wb;)d=b.P,l.unshift(b),Xi(b),b=d;l.unshift(b);Kf(b);for(d=f;d.circle&&Math.abs(e-d.circle.x)<Wb&&Math.abs(k-d.circle.cy)<Wb;)f=d.N,l.push(d),Xi(d),d=f;l.push(d);Kf(d);k=l.length;for(e=1;e<k;++e)d=l[e],b=l[e-1],Jh(d.edge,
b.site,d.site,c);b=l[0];(d=l[k-1]).edge=Dg(b.site,d.site,null,c);Jf(b);Jf(d)}function xo(b){for(var c,e,k,d,f=b[0],l=b[1],h=Lf._;h;)if((k=Il(h,l)-f)>Wb)h=h.L;else{var m=h;d=l;var q=m.N;q?d=Il(q,d):(m=m.site,d=m[1]===d?m[0]:1/0);if(!((d=f-d)>Wb)){k>-Wb?(c=h.P,e=h):d>-Wb?(c=h,e=h.N):c=e=h;break}if(!h.R){c=h;break}h=h.R}qd[b.index]={site:b,halfedges:[]};!0;k=Gl(b);if(Lf.insert(c,k),c||e){if(c===e)return Kf(c),e=Gl(c.site),Lf.insert(k,e),k.edge=e.edge=Dg(c.site,k.site),Jf(c),void Jf(e);if(e){Kf(c);Kf(e);
f=c.site;h=f[0];d=f[1];m=b[0]-h;q=b[1]-d;l=e.site;var n=l[0]-h,r=l[1]-d,v=2*(m*r-q*n),z=m*m+q*q,u=n*n+r*r;h=[(r*z-q*u)/v+h,(m*u-n*z)/v+d];Jh(e.edge,f,l,h);k.edge=Dg(f,b,null,h);e.edge=Dg(b,l,null,h);Jf(c);Jf(e)}else k.edge=Dg(c.site,k.site)}}function Il(b,c){var e=b.site,k=e[0],d=e[1],f=d-c;if(!f)return k;b=b.P;if(!b)return-1/0;b=(e=b.site)[0];e=e[1];c=e-c;if(!c)return b;var l=b-k,h=1/f-1/c,m=l/c;return h?(-m+Math.sqrt(m*m-2*h*(l*l/(-2*c)-e+c/2+d-f/2)))/h+k:(k+b)/2}function yo(b,c){return c[1]-b[1]||
c[0]-b[0]}function Yi(b,c){var e,k,d,f=b.sort(yo).pop();Vc=[];qd=Array(b.length);Lf=new Hh;for(Fg=new Hh;;)if(d=Wi,f&&(!d||f[1]<d.y||f[1]===d.y&&f[0]<d.x))f[0]===e&&f[1]===k||(xo(f),e=f[0],k=f[1]),f=b.pop();else{if(!d)break;wo(d.arc)}if(function(){for(var l,h,m,q,n=0,r=qd.length;n<r;++n)if((l=qd[n])&&(q=(h=l.halfedges).length)){var v=Array(q),z=Array(q);for(m=0;m<q;++m)v[m]=m,z[m]=so(l,Vc[h[m]]);v.sort(function(u,y){return z[y]-z[u]});for(m=0;m<q;++m)z[m]=h[v[m]];for(m=0;m<q;++m)h[m]=z[m]}}(),c)b=
+c[0][0],e=+c[0][1],k=+c[1][0],c=+c[1][1],!function(l,h,m,q){for(var n,r=Vc.length;r--;)ro(n=Vc[r],l,h,m,q)&&qo(n,l,h,m,q)&&(Math.abs(n[0][0]-n[1][0])>Wb||Math.abs(n[0][1]-n[1][1])>Wb)||delete Vc[r]}(b,e,k,c),function(l,h,m,q){var n,r,v,z,u,y,C,w=qd.length,x=!0;for(n=0;n<w;++n)if(r=qd[n]){var B=r.site;for(v=(z=r.halfedges).length;v--;)Vc[z[v]]||z.splice(v,1);v=0;for(u=z.length;v<u;){var E=Vc[z[v]];var G=(C=E[+(E.left===r.site)])[0];var P=C[1];E=(y=El(r,Vc[z[++v%u]]))[0];y=y[1];(Math.abs(G-E)>Wb||
Math.abs(P-y)>Wb)&&(z.splice(v,0,Vc.push(Eg(B,C,Math.abs(G-l)<Wb&&q-P>Wb?[l,Math.abs(E-l)<Wb?y:q]:Math.abs(P-q)<Wb&&m-G>Wb?[Math.abs(y-q)<Wb?E:m,q]:Math.abs(G-m)<Wb&&P-h>Wb?[m,Math.abs(E-m)<Wb?y:h]:Math.abs(P-h)<Wb&&G-l>Wb?[Math.abs(y-h)<Wb?E:l,h]:null))-1),++u)}u&&(x=!1)}if(x){var S,V,Z;v=1/0;n=0;for(x=null;n<w;++n)(r=qd[n])&&(Z=(S=(B=r.site)[0]-l)*S+(V=B[1]-h)*V)<v&&(v=Z,x=r);x&&(n=[l,h],l=[l,q],q=[m,q],h=[m,h],x.halfedges.push(Vc.push(Eg(B=x.site,n,l))-1,Vc.push(Eg(B,l,q))-1,Vc.push(Eg(B,q,h))-
1,Vc.push(Eg(B,h,n))-1))}for(n=0;n<w;++n)(r=qd[n])&&(r.halfedges.length||delete qd[n])}(b,e,k,c);this.edges=Vc;this.cells=qd;Lf=Fg=Vc=qd=null}function zo(b){return(b=b.slice()).push(b[0]),D([b])}function Jl(b,c,e,k){var d=(k=k||{}).steps||64,f=k.units||"kilometers",l=k.angle||0,h=k.pivot||b,m=k.properties||b.properties||{};if(!b)throw Error("center is required");if(!c)throw Error("xSemiAxis is required");if(!e)throw Error("ySemiAxis is required");if(!ta(k))throw Error("options must be an object");
if(!la(d))throw Error("steps must be a number");if(!la(l))throw Error("angle must be a number");k=aa(b);if("degrees"===f)var q=ma(l);else c=Hf(b,c,90,{units:f}),e=Hf(b,e,0,{units:f}),c=aa(c)[0]-k[0],e=aa(e)[1]-k[1];b=[];for(var n=0;n<d;n+=1){var r=-360*n/d,v=c*e/Math.sqrt(Math.pow(e,2)+Math.pow(c,2)*Math.pow(Math.tan(r*Math.PI/180),2)),z=c*e/Math.sqrt(Math.pow(c,2)+Math.pow(e,2)/Math.pow(Math.tan(r*Math.PI/180),2));if(-90>r&&-270<=r&&(v=-v),-180>r&&-360<=r&&(z=-z),"degrees"===f)r=z*Math.cos(q)-v*
Math.sin(q),v=v*Math.cos(q)+z*Math.sin(q),z=r;b.push([v+k[0],z+k[1]])}return b.push(b[0]),"degrees"===f?D([b],m):jl(D([b],m),l,{pivot:h})}function Zi(b,c){void 0===c&&(c={});var e=0,k=0,d=0;return Zb(b,function(f,l,h){var m=c.weight?null==h?void 0:h[c.weight]:void 0;if(!la(m=null==m?1:m))throw Error("weight value must be a number for feature index "+l);0<(m=Number(m))&&Ca(f,function(q){e+=q[0]*m;k+=q[1]*m;d+=m})}),t([e/d,k/d],c.properties,c)}function Kl(b,c,e,k,d){var f=k.tolerance||.001,l=0,h=0,
m=0,q=0;if(Sa(e,function(v){var z,u=null===(z=v.properties)||void 0===z?void 0:z.weight;z=null==u?1:u;if(!la(z=Number(z)))throw Error("weight value must be a number");0<z&&(q+=1,u=z*Lb(v,b),0===u&&(u=1),z/=u,l+=v.geometry.coordinates[0]*z,h+=v.geometry.coordinates[1]*z,m+=z)}),1>q)throw Error("no features to measure");var n=l/m,r=h/m;return 1===q||0===d||Math.abs(n-c[0])<f&&Math.abs(r-c[1])<f?t([n,r],{medianCandidates:k.medianCandidates}):(k.medianCandidates.push([n,r]),Kl([n,r],b,e,k,d-1))}function Ll(b,
c){return{x:b[0]-c[0],y:b[1]-c[1]}}function Ao(b,c){var e=0,k=0;Ca(b,function(d,f,l,h,m){m>e&&(e=m,k=f,c.push([]));l=b.coordinates[m][f-k+1];f=d[0];d=d[1];h=l[0];l=l[1];c[m].push([.75*f+.25*h,.75*d+.25*l]);c[m].push([.25*f+.75*h,.25*d+.75*l])},!0);c.forEach(function(d){d.push(d[0])})}function Bo(b,c){var e=0,k=0,d=0;Ca(b,function(f,l,h,m,q){m>d&&(d=m,k=l,c.push([[]]));q>e&&(e=q,k=l,c[m].push([]));h=b.coordinates[m][q][l-k+1];l=f[0];f=f[1];var n=h[0];h=h[1];c[m][q].push([.75*l+.25*n,.75*f+.25*h]);
c[m][q].push([.25*l+.75*n,.25*f+.75*h])},!0);c.forEach(function(f){f.forEach(function(l){l.push(l[0])})})}function Co(b,c,e){void 0===e&&(e=2);b=aa(b);var k=aa(c);c=b[0]-k[0];b=b[1]-k[1];return 1===e?Math.abs(c)+Math.abs(b):Math.pow(Math.pow(c,e)+Math.pow(b,e),1/e)}function Ml(b,c){var e=(c=c||{}).threshold||1E4,k=c.p||2,d=c.binary||!1,f=c.alpha||-1;c=c.standardization||!1;var l=[];Sa(b,function(n){l.push(Ne(n))});b=[];for(var h=0;h<l.length;h++)b[h]=[];for(h=0;h<l.length;h++)for(var m=h;m<l.length;m++){h===
m&&(b[h][m]=0);var q=Co(l[h],l[m],k);b[h][m]=q;b[m][h]=q}for(h=0;h<l.length;h++)for(m=0;m<l.length;m++)0!==(q=b[h][m])&&(b[h][m]=d?q<=e?1:0:q<=e?Math.pow(q,f):0);if(c)for(h=0;h<l.length;h++)for(e=b[h].reduce(function(n,r){return n+r},0),m=0;m<l.length;m++)b[h][m]/=e;return b}function Nl(b){for(var c=0,e=0;e<b.length;e++)c+=b[e];return c/b.length}function Ol(b,c){return void 0===c&&(c={}),Pl(b,"mercator",c)}function Ql(b,c){return void 0===c&&(c={}),Pl(b,"wgs84",c)}function Pl(b,c,e){void 0===e&&(e=
{});var k=(e=e||{}).mutate;if(!b)throw Error("geojson is required");return Array.isArray(b)&&la(b[0])?b="mercator"===c?Rl(b):Sl(b):(!0!==k&&(b=Dc(b)),Ca(b,function(d){var f="mercator"===c?Rl(d):Sl(d);d[0]=f[0];d[1]=f[1]})),b}function Rl(b){var c=Math.PI/180;if(180>=Math.abs(b[0]))var e=b[0];else e=b[0],e=b[0]-360*(0>e?-1:0<e?1:0);b=[6378137*e*c,6378137*Math.log(Math.tan(.25*Math.PI+.5*b[1]*c))];return 2.0037508342789244E7<b[0]&&(b[0]=2.0037508342789244E7),-2.0037508342789244E7>b[0]&&(b[0]=-2.0037508342789244E7),
2.0037508342789244E7<b[1]&&(b[1]=2.0037508342789244E7),-2.0037508342789244E7>b[1]&&(b[1]=-2.0037508342789244E7),b}function Sl(b){var c=180/Math.PI;return[b[0]*c/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-b[1]/6378137)))*c]}function Gg(b){return Array.isArray(b)?Tl(b):b&&b.bbox?Tl(b.bbox):[360*(Math.random()-.5),180*(Math.random()-.5)]}function Ul(b,c){void 0===c&&(c={});null==b&&(b=1);for(var e=[],k=0;k<b;k++)e.push(t(Gg(c.bbox)));return J(e)}function Vl(b,c){void 0===c&&(c={});null==b&&(b=1);la(c.num_vertices)&&
void 0!==c.num_vertices||(c.num_vertices=10);la(c.max_radial_length)&&void 0!==c.max_radial_length||(c.max_radial_length=10);for(var e=[],k=function(f){var l,h=[],m=Do(Array(c.num_vertices+1)).map(Math.random);m.forEach(function(q,n,r){r[n]=0<n?q+r[n-1]:q});m.forEach(function(q){q=2*q*Math.PI/m[m.length-1];var n=Math.random();h.push([n*(c.max_radial_length||10)*Math.sin(q),n*(c.max_radial_length||10)*Math.cos(q)])});h[h.length-1]=h[0];h=h.map((l=Gg(c.bbox),function(q){return[q[0]+l[0],q[1]+l[1]]}));
e.push(D([h]))},d=0;d<b;d++)k();return J(e)}function Wl(b,c){if(void 0===c&&(c={}),!ta(c=c||{}))throw Error("options is invalid");var e=c.bbox,k=c.num_vertices,d=c.max_length;c=c.max_rotation;null==b&&(b=1);(!la(k)||void 0===k||2>k)&&(k=10);la(d)&&void 0!==d||(d=1E-4);la(c)&&void 0!==c||(c=Math.PI/8);for(var f=[],l=0;l<b;l++){for(var h=[Gg(e)],m=0;m<k-1;m++){var q=(0===m?2*Math.random()*Math.PI:Math.tan((h[m][1]-h[m-1][1])/(h[m][0]-h[m-1][0])))+(Math.random()-.5)*c*2,n=Math.random()*d;h.push([h[m][0]+
n*Math.cos(q),h[m][1]+n*Math.sin(q)])}f.push(K(h))}return J(f)}function Tl(b){return[Math.random()*(b[2]-b[0])+b[0],Math.random()*(b[3]-b[1])+b[1]]}function Xl(b,c){if(!b)throw Error("geojson is required");if("FeatureCollection"!==b.type)throw Error("geojson must be a FeatureCollection");if(null==c)throw Error("filter is required");var e=[];return Sa(b,function(k){Kh(k.properties,c)&&e.push(k)}),J(e)}function $i(b,c,e){if(!b)throw Error("geojson is required");if("FeatureCollection"!==b.type)throw Error("geojson must be a FeatureCollection");
if(null==c)throw Error("property is required");c=aj(b,c);for(var k=Object.keys(c),d=0;d<k.length;d++){for(var f=k[d],l=c[f],h=[],m=0;m<l.length;m++)h.push(b.features[l[m]]);e(J(h),f,d)}}function Yl(b,c,e,k){var d=k;return $i(b,c,function(f,l,h){d=0===h&&void 0===k?f:e(d,f,l,h)}),d}function aj(b,c){var e={};return Sa(b,function(k,d){k=k.properties||{};Object.prototype.hasOwnProperty.call(k,String(c))&&(k=k[c],Object.prototype.hasOwnProperty.call(e,k)?e[k].push(d):e[k]=[d])}),e}function Kh(b,c){if(void 0===
b)return!1;var e=typeof c;if("number"===e||"string"===e)return Object.prototype.hasOwnProperty.call(b,c);if(Array.isArray(c)){for(e=0;e<c.length;e++)if(!Kh(b,c[e]))return!1;return!0}return bj(b,c)}function bj(b,c){for(var e=Object.keys(c),k=0;k<e.length;k++){var d=e[k];if(b[d]!==c[d])return!1}return!0}function Zl(b,c){if(!c||!c.length)return{};for(var e={},k=0;k<c.length;k++){var d=c[k];Object.prototype.hasOwnProperty.call(b,d)&&(e[d]=b[d])}return e}function Eo(b,c){return b>c?1:b<c?-1:0}function Oe(b,
c,e){for(var k=new Pe(null,null),d=k,f=k;;){var l=e(b,c.key);if(0>l){if(null===c.left)break;if(0>e(b,c.left.key)&&(l=c.left,c.left=l.right,l.right=c,null===(c=l).left))break;f=f.left=c;c=c.left}else{if(!(0<l))break;if(null===c.right)break;if(0<e(b,c.right.key)&&(l=c.right,c.right=l.left,l.left=c,null===(c=l).right))break;d=d.right=c;c=c.right}}return d.right=c.left,f.left=c.right,c.left=k.right,c.right=k.left,c}function cj(b,c,e,k){c=new Pe(b,c);if(null===e)return c.left=c.right=null,c;b=k(b,(e=Oe(b,
e,k)).key);return 0>b?(c.left=e.left,c.right=e,e.left=null):0<=b&&(c.right=e.right,c.left=e,e.right=null),c}function $l(b,c,e){var k=null,d=null;c&&(e=e((c=Oe(b,c,e)).key,b),0===e?(k=c.left,d=c.right):0>e?(d=c.right,c.right=null,k=c):(k=c.left,c.left=null,d=c));return{left:k,right:d}}function dj(b,c,e,k,d){b&&(k(c+(e?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+d(b)+"\n"),c+=e?"    ":"\u2502   ",b.left&&dj(b.left,c,!1,k,d),b.right&&dj(b.right,c,!0,k,d))}function ej(b,c,e,k){var d=k-e;if(0<d){d=e+
Math.floor(d/2);var f=new Pe(b[d],c[d]);return f.left=ej(b,c,e,d),f.right=ej(b,c,d+1,k),f}return null}function fj(b,c,e){var k=e-c;if(0<k){k=c+Math.floor(k/2);c=fj(b,c,k);var d=b.head;return d.left=c,b.head=b.head.next,d.right=fj(b,k+1,e),d}return null}function gj(b,c,e,k,d){if(!(e>=k)){for(var f=b[e+k>>1],l=e-1,h=k+1;;){do l++;while(0>d(b[l],f));do h--;while(0<d(b[h],f));if(l>=h)break;var m=b[l];b[l]=b[h];b[h]=m;m=c[l];c[l]=c[h];c[h]=m}gj(b,c,e,h,d);gj(b,c,h+1,k,d)}}function yd(b,c){if(!(b instanceof
c))throw new TypeError("Cannot call a class as a function");}function am(b,c){for(var e=0;e<c.length;e++){var k=c[e];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(b,k.key,k)}}function bd(b,c,e){return c&&am(b.prototype,c),e&&am(b,e),b}function id(){}function hj(b){this.message=b||""}function Mf(b){this.message=b||""}function Hg(b){this.message=b||""}function Lh(){}function Pb(b){return null===b?null:b.parent}function le(b,c){null!==b&&(b.color=
c)}function ij(b){return null===b?null:b.left}function bm(b){return null===b?null:b.right}function Ac(){this.root_=null;this.size_=0}function cm(){}function zd(b){this.array_=[];b instanceof kc&&this.addAll(b)}function Fo(){}function Go(){}function Ho(){}function Io(){}function Mh(b){this.message=b||""}function Ad(){this.array_=[]}function Sd(){this.reset()}function dm(b,c,e){var k=b.s=c+e,d=k-c;b.t=c-(k-d)+(e-d)}function em(b){return 1<b?0:-1>b?Nb:Math.acos(b)}function Nf(b){return 1<b?me:-1>b?-me:
Math.asin(b)}function Ig(){}function Nh(b,c){b&&fm.hasOwnProperty(b.type)&&fm[b.type](b,c)}function jj(b,c,e){var k=-1,d=b.length-e;for(c.lineStart();++k<d;)e=b[k],c.point(e[0],e[1],e[2]);c.lineEnd()}function gm(b,c){var e=-1,k=b.length;for(c.polygonStart();++e<k;)jj(b[e],c,1);c.polygonEnd()}function kj(b){return[Of(b[1],b[0]),Nf(b[2])]}function Pf(b){var c=b[0];b=b[1];var e=lc(b);return[e*lc(c),e*mc(c),mc(b)]}function Oh(b,c){return b[0]*c[0]+b[1]*c[1]+b[2]*c[2]}function Ph(b,c){return[b[1]*c[2]-
b[2]*c[1],b[2]*c[0]-b[0]*c[2],b[0]*c[1]-b[1]*c[0]]}function lj(b,c){b[0]+=c[0];b[1]+=c[1];b[2]+=c[2]}function Qh(b,c){return[b[0]*c,b[1]*c,b[2]*c]}function mj(b){var c=Jg(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=c;b[1]/=c;b[2]/=c}function hm(b,c){function e(k,d){return k=b(k,d),c(k[0],k[1])}return b.invert&&c.invert&&(e.invert=function(k,d){return(k=c.invert(k,d))&&b.invert(k[0],k[1])}),e}function nj(b,c){return[b>Nb?b-ne:b<-Nb?b+ne:b,c]}function im(b){return function(c,e){return[(c+=b)>Nb?c-ne:c<-Nb?
c+ne:c,e]}}function jm(b){var c=im(b);return c.invert=im(-b),c}function km(b,c){function e(h,m){var q=lc(m),n=lc(h)*q;h=mc(h)*q;m=mc(m);q=m*k+n*d;return[Of(h*f-q*l,n*k-m*d),Nf(q*f+h*l)]}var k=lc(b),d=mc(b),f=lc(c),l=mc(c);return e.invert=function(h,m){var q=lc(m),n=lc(h)*q;h=mc(h)*q;m=mc(m);q=m*f-h*l;return[Of(h*f+m*l,n*k+q*d),Nf(q*k-n*d)]},e}function lm(b,c){(c=Pf(c))[0]-=b;mj(c);b=em(-c[1]);return((0>-c[2]?-b:b)+ne-1E-6)%ne}function mm(){var b,c=[];return{point:function(e,k){b.push([e,k])},lineStart:function(){c.push(b=
[])},lineEnd:Ig,rejoin:function(){1<c.length&&c.push(c.pop().concat(c.shift()))},result:function(){var e=c;return c=[],b=null,e}}}function Rh(b,c){return 1E-6>Fc(b[0]-c[0])&&1E-6>Fc(b[1]-c[1])}function Sh(b,c,e,k){this.x=b;this.z=c;this.o=e;this.e=k;this.v=!1;this.n=this.p=null}function nm(b,c,e,k,d){var f=[],l=[];if(b.forEach(function(r){if(!(0>=(v=r.length-1))){var v,z=r[0],u=r[v];if(Rh(z,u)){d.lineStart();for(h=0;h<v;++h)d.point((z=r[h])[0],z[1]);d.lineEnd()}else f.push(v=new Sh(z,r,null,!0)),
l.push(v.o=new Sh(z,null,v,!1)),f.push(v=new Sh(u,r,null,!1)),l.push(v.o=new Sh(u,null,v,!0))}}),f.length){l.sort(c);om(f);om(l);var h=0;for(b=l.length;h<b;++h)l[h].e=e=!e;var m;for(c=f[0];;){for(var q=c,n=!0;q.v;)if((q=q.n)===c)return;e=q.z;d.lineStart();do{if(q.v=q.o.v=!0,q.e){if(n)for(h=0,b=e.length;h<b;++h)d.point((m=e[h])[0],m[1]);else k(q.x,q.n.x,1,d);q=q.n}else{if(n)for(e=q.p.z,h=e.length-1;0<=h;--h)d.point((m=e[h])[0],m[1]);else k(q.x,q.p.x,-1,d);q=q.p}e=(q=q.o).z;n=!n}while(!q.v);d.lineEnd()}}}
function om(b){if(c=b.length){for(var c,e,k=0,d=b[0];++k<c;)d.n=e=b[k],e.p=d,d=e;d.n=e=b[0];e.p=d}}function pm(b){var c,e,k=b.length;var d=-1;for(var f=0;++d<k;)f+=b[d].length;for(c=Array(f);0<=--k;)for(d=(e=b[k]).length;0<=--d;)c[--f]=e[d];return c}function Jo(b,c,e,k){function d(m,q,n,r){var v=0,z=0;if(null==m||(v=f(m,n))!==(z=f(q,n))||0>h(m,q)^0<n){do r.point(0===v||3===v?b:e,1<v?k:c);while((v=(v+n+4)%4)!==z)}else r.point(q[0],q[1])}function f(m,q){return 1E-6>Fc(m[0]-b)?0<q?0:3:1E-6>Fc(m[0]-e)?
0<q?2:1:1E-6>Fc(m[1]-c)?0<q?1:0:0<q?3:2}function l(m,q){return h(m.x,q.x)}function h(m,q){var n=f(m,1),r=f(q,1);return n!==r?n-r:0===n?q[1]-m[1]:1===n?m[0]-q[0]:2===n?m[1]-q[1]:q[0]-m[0]}return function(m){function q(Z,X){b<=Z&&Z<=e&&c<=X&&X<=k&&P.point(Z,X)}function n(Z,X){var ea=b<=Z&&Z<=e&&c<=X&&X<=k;if(v&&z.push([Z,X]),E)u=Z,y=X,C=ea,E=!1,ea&&(P.lineStart(),P.point(Z,X));else if(ea&&B)P.point(Z,X);else{var na=[w=Math.max(-1E9,Math.min(1E9,w)),x=Math.max(-1E9,Math.min(1E9,x))],qa=[Z=Math.max(-1E9,
Math.min(1E9,Z)),X=Math.max(-1E9,Math.min(1E9,X))];(function(ia,ra,ja,Ma,Pa,Sb){var Qa,Wc=ia[0],fc=ia[1],nc=0,cc=1,gc=ra[0]-Wc,Gc=ra[1]-fc;if(Qa=ja-Wc,gc||!(0<Qa)){if(Qa/=gc,0>gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}else if(0<gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}if(Qa=Pa-Wc,gc||!(0>Qa)){if(Qa/=gc,0>gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}else if(0<gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}if(Qa=Ma-fc,Gc||!(0<Qa)){if(Qa/=Gc,0>Gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}else if(0<Gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}if(Qa=Sb-fc,
Gc||!(0>Qa)){if(Qa/=Gc,0>Gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}else if(0<Gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}return 0<nc&&(ia[0]=Wc+nc*gc,ia[1]=fc+nc*Gc),1>cc&&(ra[0]=Wc+cc*gc,ra[1]=fc+cc*Gc),!0}}}}})(na,qa,b,c,e,k)?(B||(P.lineStart(),P.point(na[0],na[1])),P.point(qa[0],qa[1]),ea||P.lineEnd(),G=!1):ea&&(P.lineStart(),P.point(Z,X),G=!1)}w=Z;x=X;B=ea}var r,v,z,u,y,C,w,x,B,E,G,P=m,S=mm(),V={point:q,lineStart:function(){V.point=n;v&&v.push(z=[]);E=!0;B=!1;w=x=NaN},lineEnd:function(){r&&(n(u,y),C&&B&&S.rejoin(),
r.push(S.result()));V.point=q;B&&P.lineEnd()},polygonStart:function(){P=S;r=[];v=[];G=!0},polygonEnd:function(){for(var Z,X=Z=0,ea=v.length;X<ea;++X){var na=v[X],qa=1,ia=na.length,ra=na[0],ja=ra[0];for(ra=ra[1];qa<ia;++qa){var Ma=ja;var Pa=ra;ja=(ra=na[qa])[0];ra=ra[1];Pa<=k?ra>k&&(ja-Ma)*(k-Pa)>(ra-Pa)*(b-Ma)&&++Z:ra<=k&&(ja-Ma)*(k-Pa)<(ra-Pa)*(b-Ma)&&--Z}}X=G&&Z;ea=(r=pm(r)).length;(X||ea)&&(m.polygonStart(),X&&(m.lineStart(),d(null,null,1,m),m.lineEnd()),ea&&nm(r,l,Z,d,m),m.polygonEnd());P=m;r=
v=z=null}};return V}}function qm(b){return b}function rm(b,c,e,k){return function(d,f){function l(P,S){var V=d(P,S);b(P=V[0],S=V[1])&&f.point(P,S)}function h(P,S){P=d(P,S);C.point(P[0],P[1])}function m(){G.point=h;C.lineStart()}function q(){G.point=l;C.lineEnd()}function n(P,S){y.push([P,S]);P=d(P,S);B.point(P[0],P[1])}function r(){B.lineStart();y=[]}function v(){n(y[0][0],y[0][1]);B.lineEnd();var P;var S=B.clean();var V=x.result();var Z=V.length;if(y.pop(),z.push(y),y=null,Z)if(1&S){if(0<(V=(Z=V[0]).length-
1)){E||(f.polygonStart(),E=!0);f.lineStart();for(S=0;S<V;++S)f.point((P=Z[S])[0],P[1]);f.lineEnd()}}else 1<Z&&2&S&&V.push(V.pop().concat(V.shift())),u.push(V.filter(Ko))}var z,u,y,C=c(f),w=d.invert(k[0],k[1]),x=mm(),B=c(x),E=!1,G={point:l,lineStart:m,lineEnd:q,polygonStart:function(){G.point=n;G.lineStart=r;G.lineEnd=v;u=[];z=[]},polygonEnd:function(){G.point=l;G.lineStart=m;G.lineEnd=q;u=pm(u);var P=z;var S=w[0],V=w[1],Z=[mc(S),-lc(S),0],X=0,ea=0;oj.reset();for(var na=0,qa=P.length;na<qa;++na)if(ra=
(ia=P[na]).length){var ia,ra,ja=ia[ra-1],Ma=ja[0],Pa=ja[1]/2+sm,Sb=mc(Pa),Qa=lc(Pa);for(Pa=0;Pa<ra;++Pa,Ma=fc,Sb=nc,Qa=cc,ja=Wc){var Wc=ia[Pa],fc=Wc[0];cc=Wc[1]/2+sm;var nc=mc(cc),cc=lc(cc),gc=fc-Ma,Gc=0<=gc?1:-1,Qf=Gc*gc,Qe=Qf>Nb;Sb*=nc;if(oj.add(Of(Sb*Gc*mc(Qf),Qa*cc+Sb*lc(Qf))),X+=Qe?gc+Gc*ne:gc,Qe^Ma>=S^fc>=S)ja=Ph(Pf(ja),Pf(Wc)),mj(ja),Ma=Ph(Z,ja),mj(Ma),Ma=(Qe^0<=gc?-1:1)*Nf(Ma[2]),(V>Ma||V===Ma&&(ja[0]||ja[1]))&&(ea+=Qe^0<=gc?1:-1)}}P=(-1E-6>X||1E-6>X&&-1E-6>oj)^1&ea;u.length?(E||(f.polygonStart(),
E=!0),nm(u,Lo,P,e,f)):P&&(E||(f.polygonStart(),E=!0),f.lineStart(),e(null,null,1,f),f.lineEnd());E&&(f.polygonEnd(),E=!1);u=z=null},sphere:function(){f.polygonStart();f.lineStart();e(null,null,1,f);f.lineEnd();f.polygonEnd()}};return G}}function Ko(b){return 1<b.length}function Lo(b,c){return(0>(b=b.x)[0]?b[1]-me-1E-6:me-b[1])-(0>(c=c.x)[0]?c[1]-me-1E-6:me-c[1])}function Mo(b,c){function e(m,q){return lc(m)*lc(q)>f}function k(m,q,n){var r=[1,0,0],v=Ph(Pf(m),Pf(q)),z=Oh(v,v),u=v[0],y=z-u*u;if(!y)return!n&&
m;z=f*z/y;y=-f*u/y;u=Ph(r,v);r=Qh(r,z);lj(r,Qh(v,y));v=Oh(r,u);z=Oh(u,u);y=v*v-z*(Oh(r,r)-1);if(!(0>y)){var C=Jg(y);y=Qh(u,(-v-C)/z);if(lj(y,r),y=kj(y),!n)return y;var w;n=m[0];var x=q[0];m=m[1];q=q[1];x<n&&(w=n,n=x,x=w);var B=x-n,E=1E-6>Fc(B-Nb);if(!E&&q<m&&(w=m,m=q,q=w),E||1E-6>B?E?0<m+q^y[1]<(1E-6>Fc(y[0]-n)?m:q):m<=y[1]&&y[1]<=q:B>Nb^(n<=y[0]&&y[0]<=x))return w=Qh(u,(-v+C)/z),lj(w,r),[y,kj(w)]}}function d(m,q){var n=l?b:Nb-b,r=0;return m<-n?r|=1:m>n&&(r|=2),q<-n?r|=4:q>n&&(r|=8),r}var f=lc(b),
l=0<f,h=1E-6<Fc(f);return rm(e,function(m){var q,n,r,v,z;return{lineStart:function(){v=r=!1;z=1},point:function(u,y){var C,w=[u,y],x=e(u,y);u=l?x?0:d(u,y):x?d(u+(0>u?Nb:-Nb),y):0;if(!q&&(v=r=x)&&m.lineStart(),x!==r&&(!(C=k(q,w))||Rh(q,C)||Rh(w,C))&&(w[0]+=1E-6,w[1]+=1E-6,x=e(w[0],w[1])),x!==r)z=0,x?(m.lineStart(),C=k(w,q),m.point(C[0],C[1])):(C=k(q,w),m.point(C[0],C[1]),m.lineEnd()),q=C;else if(h&&q&&l^x){var B;u&n||!(B=k(w,q,!0))||(z=0,l?(m.lineStart(),m.point(B[0][0],B[0][1]),m.point(B[1][0],B[1][1]),
m.lineEnd()):(m.point(B[1][0],B[1][1]),m.lineEnd(),m.lineStart(),m.point(B[0][0],B[0][1])))}!x||q&&Rh(q,w)||m.point(w[0],w[1]);q=w;r=x;n=u},lineEnd:function(){r&&m.lineEnd();q=null},clean:function(){return z|(v&&r)<<1}}},function(m,q,n,r){var v=m;if(c){m=lc(b);var z=mc(b),u=n*c;null==v?(v=b+n*ne,q=b-u/2):(v=lm(m,v),q=lm(m,q),(0<n?v<q:v>q)&&(v+=n*ne));for(var y=v;0<n?y>q:y<q;y-=u)v=kj([m,-z*lc(y),-z*mc(y)]),r.point(v[0],v[1])}!0},l?[0,-b]:[-Nb,b-Nb])}function tm(b){return function(c){var e=new pj,
k;for(k in b)e[k]=b[k];return e.stream=c,e}}function pj(){}function um(b,c,e){var k=c[1][0]-c[0][0],d=c[1][1]-c[0][1],f=b.clipExtent&&b.clipExtent();b.scale(150).translate([0,0]);null!=f&&b.clipExtent(null);var l=b.stream(vm);e&&wm.hasOwnProperty(e.type)?wm[e.type](e,l):Nh(e,l);l=vm.result();e=Math.min(k/(l[1][0]-l[0][0]),d/(l[1][1]-l[0][1]));k=+c[0][0]+(k-e*(l[1][0]+l[0][0]))/2;c=+c[0][1]+(d-e*(l[1][1]+l[0][1]))/2;return null!=f&&b.clipExtent(f),b.scale(150*e).translate([k,c])}function xm(b,c){return+c?
function(e,k){function d(f,l,h,m,q,n,r,v,z,u,y,C,w,x){var B=r-f,E=v-l,G=B*B+E*E;if(G>4*k&&w--){var P=m+u,S=q+y,V=n+C,Z=Jg(P*P+S*S+V*V),X=Nf(V/=Z),ea=1E-6>Fc(Fc(V)-1)||1E-6>Fc(h-z)?(h+z)/2:Of(S,P),na=e(ea,X);X=na[0];na=na[1];var qa=X-f,ia=na-l,ra=E*qa-B*ia;(ra*ra/G>k||.3<Fc((B*qa+E*ia)/G-.5)||m*u+q*y+n*C<No)&&(d(f,l,h,m,q,n,X,na,ea,P/=Z,S/=Z,V,w,x),x.point(X,na),d(X,na,ea,P,S,V,r,v,z,u,y,C,w,x))}}return function(f){function l(X,ea){X=e(X,ea);f.point(X[0],X[1])}function h(){E=NaN;Z.point=m;f.lineStart()}
function m(X,ea){var na=Pf([X,ea]);ea=e(X,ea);d(E,G,B,P,S,V,E=ea[0],G=ea[1],B=X,P=na[0],S=na[1],V=na[2],16,f);f.point(E,G)}function q(){Z.point=l;f.lineEnd()}function n(){h();Z.point=r;Z.lineEnd=v}function r(X,ea){m(z=X,ea);u=E;y=G;C=P;w=S;x=V;Z.point=m}function v(){d(E,G,B,P,S,V,u,y,z,C,w,x,16,f);Z.lineEnd=q;q()}var z,u,y,C,w,x,B,E,G,P,S,V,Z={point:l,lineStart:h,lineEnd:q,polygonStart:function(){f.polygonStart();Z.lineStart=n},polygonEnd:function(){f.polygonEnd();Z.lineStart=h}};return Z}}(b,c):
function(e){return tm({point:function(k,d){k=e(k,d);this.stream.point(k[0],k[1])}})}(b)}function Oo(b){return function(c){function e(ia){return[(ia=n(ia[0]*Bd,ia[1]*Bd))[0]*C+h,m-ia[1]*C]}function k(ia){return(ia=n.invert((ia[0]-h)/C,(m-ia[1])/C))&&[ia[0]*Re,ia[1]*Re]}function d(ia,ra){return[(ia=l(ia,ra))[0]*C+h,m-ia[1]*C]}function f(){var ia=G,ra=P,ja=S;var Ma=(ia%=ne)?ra||ja?hm(jm(ia),km(ra,ja)):jm(ia):ra||ja?km(ra,ja):nj;n=hm(q=Ma,l);Ma=l(B,E);return h=w-Ma[0]*C,m=x+Ma[1]*C,u=y=null,e}var l,h,
m,q,n,r,v,z,u,y,C=150,w=480,x=250,B=0,E=0,G=0,P=0,S=0,V=null,Z=ym,X=null,ea=qm,na=.5,qa=xm(d,na);return e.stream=function(ia){return u&&y===ia?u:u=Po(Z(q,qa(ea(y=ia))))},e.clipAngle=function(ia){return arguments.length?(Z=+ia?Mo(V=ia*Bd,6*Bd):(V=null,ym),u=y=null,e):V*Re},e.clipExtent=function(ia){return arguments.length?(ea=null==ia?(X=r=v=z=null,qm):Jo(X=+ia[0][0],r=+ia[0][1],v=+ia[1][0],z=+ia[1][1]),u=y=null,e):null==X?null:[[X,r],[v,z]]},e.scale=function(ia){return arguments.length?(C=+ia,f()):
C},e.translate=function(ia){return arguments.length?(w=+ia[0],x=+ia[1],f()):[w,x]},e.center=function(ia){return arguments.length?(B=ia[0]%360*Bd,E=ia[1]%360*Bd,f()):[B*Re,E*Re]},e.rotate=function(ia){return arguments.length?(G=ia[0]%360*Bd,P=ia[1]%360*Bd,S=2<ia.length?ia[2]%360*Bd:0,f()):[G*Re,P*Re,S*Re]},e.precision=function(ia){return arguments.length?(qa=xm(d,na=ia*ia),u=y=null,e):Jg(na)},e.fitExtent=function(ia,ra){return um(e,ia,ra)},e.fitSize=function(ia,ra){return um(e,[[0,0],ia],ra)},function(){return l=
c.apply(this,arguments),e.invert=l.invert&&k,f()}}(function(){return b})()}function Th(b,c,e,k){var d=b.properties||{},f="Feature"===b.type?b.geometry:b;if("GeometryCollection"===f.type){var l=[];return Zb(b,function(m){(m=Th(m,c,e,k))&&l.push(m)}),J(l)}b=function(m){m=wh(m).geometry.coordinates;m=[-m[0],-m[1]];return Oo(zm).scale(79.4188).clipAngle(179.999).rotate(m).scale(6371008.8)}(f);f={type:f.type,coordinates:Am(f.coordinates,b)};f=(new qj).read(f);var h=ba(fa(c,e),"meters");f=xc.bufferOp(f,
h,k);if(!Bm((f=(new Cm).write(f)).coordinates))return g({type:f.type,coordinates:Dm(f.coordinates,b)},d)}function Bm(b){return Array.isArray(b[0])?Bm(b[0]):isNaN(b[0])}function Am(b,c){return"object"!=typeof b[0]?c(b):b.map(function(e){return Am(e,c)})}function Dm(b,c){return"object"!=typeof b[0]?c.invert(b):b.map(function(e){return Dm(e,c)})}function Kg(b,c,e){void 0===e&&(e={});b=Ib(b);c=Ib(c);c=Ce.intersection(b.coordinates,c.coordinates);return 0===c.length?null:1===c.length?D(c[0],e.properties):
T(c,e.properties)}function Em(b,c,e){void 0===e&&(e={});var k=JSON.stringify(e.properties||{}),d=b[0],f=b[1],l=b[2],h=b[3];b=(f+h)/2;var m=(d+l)/2;b=2*c/Lb([d,b],[l,b],e)*(l-d);c=2*c/Lb([m,f],[m,h],e)*(h-f);var q=b/2,n=2*q;m=Math.sqrt(3)/2*c;var r=l-d,v=h-f;l=.75*n;h=Math.floor((r-n)/(n-q/2));q=(h*l-q/2-r)/2-q/2+l/2;n=Math.floor((v-m)/m);r=(v-n*m)/2;(v=n*m-v>m/2)&&(r-=m/4);for(var z=[],u=[],y=0;6>y;y++){var C=2*Math.PI/6*y;z.push(Math.cos(C));u.push(Math.sin(C))}var w=[];for(y=0;y<=h;y++)for(C=0;C<=
n;C++){var x=1==y%2;if(!(0===C&&x||0===C&&v)){var B=y*l+d-q,E=C*m+f+r;(x&&(E-=m/2),!0===e.triangles)?Qo([B,E],b/2,c/2,JSON.parse(k),z,u).forEach(function(G){e.mask?Kg(e.mask,G)&&w.push(G):w.push(G)}):(x=Ro([B,E],b/2,c/2,JSON.parse(k),z,u),e.mask?Kg(e.mask,x)&&w.push(x):w.push(x))}}return J(w)}function Ro(b,c,e,k,d,f){for(var l=[],h=0;6>h;h++)l.push([b[0]+c*d[h],b[1]+e*f[h]]);return l.push(l[0].slice()),D([l],k)}function Qo(b,c,e,k,d,f){for(var l=[],h=0;6>h;h++){var m=[];m.push(b);m.push([b[0]+c*d[h],
b[1]+e*f[h]]);m.push([b[0]+c*d[(h+1)%6],b[1]+e*f[(h+1)%6]]);m.push(b);l.push(D([m],k))}return l}function Fm(b,c,e){void 0===e&&(e={});void 0===e&&(e={});var k=[],d=b[0],f=b[1],l=b[2],h=b[3];b=c/Lb([d,f],[l,f],e)*(l-d);c=c/Lb([d,f],[d,h],e)*(h-f);var m=l-d,q=h-f;l=Math.floor(m/b);h=Math.floor(q/c);q=(q-h*c)/2;d+=(m-l*b)/2;for(m=0;m<l;m++){for(var n=f+q,r=0;r<h;r++){var v=D([[[d,n],[d,n+c],[d+b,n+c],[d+b,n],[d,n]]],e.properties);e.mask?xl(e.mask,v)&&k.push(v):k.push(v);n+=c}d+=b}return J(k)}function Gm(b,
c,e){void 0===e&&(e={});var k=[],d=c/Lb([b[0],b[1]],[b[2],b[1]],e)*(b[2]-b[0]);c=c/Lb([b[0],b[1]],[b[0],b[3]],e)*(b[3]-b[1]);for(var f=0,l=b[0];l<=b[2];){for(var h=0,m=b[1];m<=b[3];){var q=null,n=null;0==f%2&&0==h%2?(q=D([[[l,m],[l,m+c],[l+d,m],[l,m]]],e.properties),n=D([[[l,m+c],[l+d,m+c],[l+d,m],[l,m+c]]],e.properties)):0==f%2&&1==h%2?(q=D([[[l,m],[l+d,m+c],[l+d,m],[l,m]]],e.properties),n=D([[[l,m],[l,m+c],[l+d,m+c],[l,m]]],e.properties)):0==h%2&&1==f%2?(q=D([[[l,m],[l,m+c],[l+d,m+c],[l,m]]],e.properties),
n=D([[[l,m],[l+d,m+c],[l+d,m],[l,m]]],e.properties)):1==h%2&&1==f%2&&(q=D([[[l,m],[l,m+c],[l+d,m],[l,m]]],e.properties),n=D([[[l,m+c],[l+d,m+c],[l+d,m],[l,m+c]]],e.properties));e.mask?(Kg(e.mask,q)&&k.push(q),Kg(e.mask,n)&&k.push(n)):(k.push(q),k.push(n));m+=c;h++}f++;l+=d}return J(k)}var mh={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:2.0902260511392E7,inches:39.37*6371008.8,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,
millimeters:6371008800,millimetres:6371008800,nauticalmiles:6371008.8/1852,radians:1,yards:6967335.223679999},Hm={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1E3,millimetres:1E3,nauticalmiles:1/1852,radians:1/6371008.8,yards:1.0936133},nh={acres:2.47105E-4,centimeters:1E4,centimetres:1E4,feet:10.763910417,hectares:1E-4,inches:1550.003100006,kilometers:1E-6,kilometres:1E-6,meters:1,metres:1,
miles:3.86E-7,millimeters:1E6,millimetres:1E6,yards:1.195990046},So=Object.freeze({__proto__:null,earthRadius:6371008.8,factors:mh,unitsFactors:Hm,areaFactors:nh,feature:g,geometry:p,point:t,points:A,polygon:D,polygons:F,lineString:K,lineStrings:H,featureCollection:J,multiLineString:I,multiPoint:N,multiPolygon:T,geometryCollection:O,round:W,radiansToLength:ba,lengthToRadians:fa,lengthToDegrees:R,bearingToAzimuth:da,radiansToDegrees:ha,degreesToRadians:ma,convertLength:ka,convertArea:pa,isNumber:la,
isObject:ta,validateBBox:wa,validateId:za}),To=Object.freeze({__proto__:null,coordAll:uc,coordEach:Ca,coordReduce:Vb,featureEach:Sa,featureReduce:Ya,findPoint:Ba,findSegment:oa,flattenEach:Rb,flattenReduce:Me,geomEach:Zb,geomReduce:pd,lineEach:Q,lineReduce:ca,propEach:Kb,propReduce:Qd,segmentEach:L,segmentReduce:M});ya.default=ya;var Uo=Object.freeze({__proto__:null,getCoord:aa,getCoords:Y,containsNumber:xa,geojsonType:Oa,featureOf:Ob,collectionOf:Ka,getGeom:Ib,getType:qc}),Im=Object.getOwnPropertySymbols,
Vo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,rj=function(){try{if(!Object.assign)return!1;var b=new String("abc");if(b[5]="de","5"===Object.getOwnPropertyNames(b)[0])return!1;var c={};for(b=0;10>b;b++)c["_"+String.fromCharCode(b)]=b;if("0123456789"!==Object.getOwnPropertyNames(c).map(function(k){return c[k]}).join(""))return!1;var e={};return"abcdefghijklmnopqrst".split("").forEach(function(k){e[k]=k}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},e)).join("")}catch(k){return!1}}()?
Object.assign:function(b,c){var e;if(null==b)throw new TypeError("Object.assign cannot be called with null or undefined");var k=Object(b);for(var d=1;d<arguments.length;d++){for(var f in e=Object(arguments[d]))Vo.call(e,f)&&(k[f]=e[f]);if(Im){var l=Im(e);for(var h=0;h<l.length;h++)Wo.call(e,l[h])&&(k[l[h]]=e[l[h]])}}return k},Rj={successCallback:null,verbose:!1},oh={},Vj=$b;Vj.default=$b;var Uc=mg;mg.prototype={all:function(){return this._all(this.data,[])},search:function(b){var c=this.data,e=[],
k=this.toBBox;if(!qh(b,c))return e;for(var d,f,l,h,m=[];c;){d=0;for(f=c.children.length;d<f;d++)l=c.children[d],qh(b,h=c.leaf?k(l):l)&&(c.leaf?e.push(l):pi(b,h)?this._all(l,e):m.push(l));c=m.pop()}return e},collides:function(b){var c=this.data,e=this.toBBox;if(!qh(b,c))return!1;for(var k,d,f,l,h=[];c;){k=0;for(d=c.children.length;k<d;k++)if(f=c.children[k],qh(b,l=c.leaf?e(f):f)){if(c.leaf||pi(b,l))return!0;h.push(f)}c=h.pop()}return!1},load:function(b){if(!b||!b.length)return this;if(b.length<this._minEntries){for(var c=
0,e=b.length;c<e;c++)this.insert(b[c]);return this}b=this._build(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this._splitRoot(this.data,b):(this.data.height<b.height&&(c=this.data,this.data=b,b=c),this._insert(b,this.data.height-b.height-1,!0)):this.data=b;return this},insert:function(b){return b&&this._insert(b,this.data.height-1),this},clear:function(){return this.data=Cf([]),this},remove:function(b,c){if(!b)return this;for(var e,k,d,f,l=this.data,h=this.toBBox(b),
m=[],q=[];l||m.length;){l||(l=m.pop(),k=m[m.length-1],e=q.pop(),f=!0);var n;if(n=l.leaf){a:{d=b;n=l.children;var r=c;if(r){for(var v=0;v<n.length;v++)if(r(d,n[v])){d=v;break a}d=-1}else d=n.indexOf(d)}n=-1!==d}if(n)return l.children.splice(d,1),m.push(l),this._condense(m),this;f||l.leaf||!pi(l,h)?k?(e++,l=k.children[e],f=!1):l=null:(m.push(l),q.push(e),e=0,k=l,l=l.children[0])}return this},toBBox:function(b){return b},compareMinX:Sj,compareMinY:Tj,toJSON:function(){return this.data},fromJSON:function(b){return this.data=
b,this},_all:function(b,c){for(var e=[];b;)b.leaf?c.push.apply(c,b.children):e.push.apply(e,b.children),b=e.pop();return c},_build:function(b,c,e,k){var d,f=e-c+1,l=this._maxEntries;if(f<=l)return Bf(d=Cf(b.slice(c,e+1)),this.toBBox),d;k||(k=Math.ceil(Math.log(f)/Math.log(l)),l=Math.ceil(f/Math.pow(l,k-1)));(d=Cf([])).leaf=!1;d.height=k;var h,m;f=Math.ceil(f/l);l=f*Math.ceil(Math.sqrt(l));for(Uj(b,c,e,l,this.compareMinX);c<=e;c+=l)for(Uj(b,c,m=Math.min(c+l-1,e),f,this.compareMinY),h=c;h<=m;h+=f){var q=
Math.min(h+f-1,m);d.children.push(this._build(b,h,q,k-1))}return Bf(d,this.toBBox),d},_chooseSubtree:function(b,c,e,k){for(var d,f,l,h,m,q,n,r,v,z;k.push(c),!c.leaf&&k.length-1!==e;){n=r=1/0;d=0;for(f=c.children.length;d<f;d++)m=oi(l=c.children[d]),v=b,z=l,(q=(Math.max(z.maxX,v.maxX)-Math.min(z.minX,v.minX))*(Math.max(z.maxY,v.maxY)-Math.min(z.minY,v.minY))-m)<r?(r=q,n=m<n?m:n,h=l):q===r&&m<n&&(n=m,h=l);c=h||c.children[0]}return c},_insert:function(b,c,e){var k=this.toBBox;e=e?b:k(b);k=[];var d=this._chooseSubtree(e,
this.data,c,k);d.children.push(b);for(og(d,e);0<=c&&k[c].children.length>this._maxEntries;)this._split(k,c),c--;this._adjustParentBBoxes(e,k,c)},_split:function(b,c){var e=b[c],k=e.children.length,d=this._minEntries;this._chooseSplitAxis(e,d,k);k=this._chooseSplitIndex(e,d,k);k=Cf(e.children.splice(k,e.children.length-k));k.height=e.height;k.leaf=e.leaf;Bf(e,this.toBBox);Bf(k,this.toBBox);c?b[c-1].children.push(k):this._splitRoot(e,k)},_splitRoot:function(b,c){this.data=Cf([b,c]);this.data.height=
b.height+1;this.data.leaf=!1;Bf(this.data,this.toBBox)},_chooseSplitIndex:function(b,c,e){var k,d,f;var l=d=1/0;for(k=c;k<=e-c;k++){var h=ng(b,0,k,this.toBBox);var m=ng(b,k,e,this.toBBox);var q=h;var n=m;var r=Math.max(q.minX,n.minX);var v=Math.max(q.minY,n.minY);var z=Math.min(q.maxX,n.maxX);q=Math.min(q.maxY,n.maxY);r=Math.max(0,z-r)*Math.max(0,q-v);h=oi(h)+oi(m);r<l?(l=r,f=k,d=h<d?h:d):r===l&&h<d&&(d=h,f=k)}return f},_chooseSplitAxis:function(b,c,e){var k=b.leaf?this.compareMinX:Sj,d=b.leaf?this.compareMinY:
Tj;this._allDistMargin(b,c,e,k)<this._allDistMargin(b,c,e,d)&&b.children.sort(k)},_allDistMargin:function(b,c,e,k){b.children.sort(k);var d=this.toBBox,f=ng(b,0,c,d),l=ng(b,e-c,e,d),h=ph(f)+ph(l);for(k=c;k<e-c;k++){var m=b.children[k];og(f,b.leaf?d(m):m);h+=ph(f)}for(k=e-c-1;k>=c;k--)m=b.children[k],og(l,b.leaf?d(m):m),h+=ph(l);return h},_adjustParentBBoxes:function(b,c,e){for(;0<=e;e--)og(c[e],b)},_condense:function(b){for(var c,e=b.length-1;0<=e;e--)0===b[e].children.length?0<e?(c=b[e-1].children).splice(c.indexOf(b[e]),
1):this.clear():Bf(b[e],this.toBBox)},_initFormat:function(b){var c=["return a"," - b",";"];this.compareMinX=new Function("a","b",c.join(b[0]));this.compareMinY=new Function("a","b",c.join(b[1]));this.toBBox=new Function("a","return {minX: a"+b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};")}};Uc.default=mg;var Uh=function(b,c,e){var k=b*c,d=Jm*b;d-=d-b;b-=d;var f=Jm*c;f-=f-c;c-=f;c=b*c-(k-d*f-b*f-d*c);return e?(e[0]=c,e[1]=k,e):[c,k]},Jm=+(Math.pow(2,27)+1),Xo=function(b,c){var e=0|b.length,
k=0|c.length;if(1===e&&1===k)return b=b[0],e=c[0],c=b+e,k=c-b,c=(b=b-(c-k)+(e-k))?[b,c]:[c],c;var d,f,l=Array(e+k),h=0,m=0,q=0,n=Math.abs,r=b[m],v=n(r),z=c[q],u=n(z);v<u?(f=r,(m+=1)<e&&(r=b[m],v=n(r))):(f=z,(q+=1)<k&&(z=c[q],u=n(z)));m<e&&v<u||q>=k?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(q+=1)<k&&(z=c[q],u=n(z)));for(var y,C,w=d+f,x,B=f-(w-d),E=w;m<e&&q<k;)v<u?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(q+=1)<k&&(z=c[q],u=n(z))),(x=(f=B)-((w=d+f)-d))&&(l[h++]=x),B=E-((y=E+w)-(C=y-E))+(w-C),E=y;for(;m<e;)(x=
(f=B)-((w=(d=r)+f)-d))&&(l[h++]=x),B=E-((y=E+w)-(C=y-E))+(w-C),E=y,(m+=1)<e&&(r=b[m]);for(;q<k;)(x=(f=B)-((w=(d=z)+f)-d))&&(l[h++]=x),B=E-((y=E+w)-(C=y-E))+(w-C),E=y,(q+=1)<k&&(z=c[q]);B&&(l[h++]=B);E&&(l[h++]=E);h||(l[h++]=0);return l.length=h,l},Yo=function(b,c){var e=b.length;if(1===e)return b=Uh(b[0],c),b[0]?b:[b[1]];var k=Array(2*e),d=[.1,.1],f=[.1,.1],l=0;Uh(b[0],c,d);d[0]&&(k[l++]=d[0]);for(var h=1;h<e;++h){Uh(b[h],c,f);var m=d[1];var q=f[0],n=d,r=m+q,v=r-m;q-=v;m-=r-v;n&&(n[0]=m+q,n[1]=r);
d[0]&&(k[l++]=d[0]);r=f[1];m=d[1];n=r+m;r=m-(n-r);d[1]=n;r&&(k[l++]=r)}d[1]&&(k[l++]=d[1]);0===l&&(k[l++]=0);return k.length=l,k},Zo=function(b,c){var e=0|b.length,k=0|c.length;if(1===e&&1===k)return b=b[0],e=-c[0],c=b+e,k=c-b,c=(b=b-(c-k)+(e-k))?[b,c]:[c],c;var d,f,l=Array(e+k),h=0,m=0,q=0,n=Math.abs,r=b[m],v=n(r),z=-c[q],u=n(z);v<u?(f=r,(m+=1)<e&&(r=b[m],v=n(r))):(f=z,(q+=1)<k&&(z=-c[q],u=n(z)));m<e&&v<u||q>=k?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(q+=1)<k&&(z=-c[q],u=n(z)));for(var y,C,w=d+f,x,
B=f-(w-d),E=w;m<e&&q<k;)v<u?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(q+=1)<k&&(z=-c[q],u=n(z))),(x=(f=B)-((w=d+f)-d))&&(l[h++]=x),B=E-((y=E+w)-(C=y-E))+(w-C),E=y;for(;m<e;)(x=(f=B)-((w=(d=r)+f)-d))&&(l[h++]=x),B=E-((y=E+w)-(C=y-E))+(w-C),E=y,(m+=1)<e&&(r=b[m]);for(;q<k;)(x=(f=B)-((w=(d=z)+f)-d))&&(l[h++]=x),B=E-((y=E+w)-(C=y-E))+(w-C),E=y,(q+=1)<k&&(z=-c[q]);B&&(l[h++]=B);E&&(l[h++]=E);h||(l[h++]=0);return l.length=h,l},Km=ie(function(b){function c(q,n){for(var r=Array(q.length-1),v=1;v<q.length;++v)for(var z=
r[v-1]=Array(q.length-1),u=0,y=0;u<q.length;++u)u!==n&&(z[y++]=q[v][u]);return r}function e(q){if(1===q.length)return q[0];if(2===q.length)return["sum(",q[0],",",q[1],")"].join("");var n=q.length>>1;return["sum(",e(q.slice(0,n)),",",e(q.slice(n)),")"].join("")}function k(q){if(2===q.length)return[["sum(prod(",q[0][0],",",q[1][1],"),prod(-",q[0][1],",",q[1][0],"))"].join("")];for(var n=[],r=0;r<q.length;++r)n.push(["scale(",e(k(c(q,r))),",",(v=r,1&v?"-":""),q[0][r],")"].join(""));return n;var v}function d(q){for(var n=
[],r=[],v=Array(q),z=0;z<q;++z){v[z]=Array(q);for(var u=0;u<q;++u)v[z][u]=["m",u,"[",q-z-1,"]"].join("")}z=[];for(u=0;u<q;++u)0==(1&u)?n.push.apply(n,k(c(v,u))):r.push.apply(r,k(c(v,u))),z.push("m"+u);n=e(n);r=e(r);q="orientation"+q+"Exact";q=["function ",q,"(",z.join(),"){var p=",n,",n=",r,",d=sub(p,n);return d[d.length-1];};return ",q].join("");return(new Function("sum","prod","scale","sub",q))(Xo,Uh,Yo,Zo)}function f(q){var n=m[q.length];return n||=m[q.length]=d(q.length),n.apply(void 0,q)}var l=
d(3),h=d(4),m=[function(){return 0},function(){return 0},function(q,n){return n[0]-q[0]},function(q,n,r){var v=(q[1]-r[1])*(n[0]-r[0]);var z=(q[0]-r[0])*(n[1]-r[1]),u=v-z;if(0<v){if(0>=z)return u;v+=z}else{if(!(0>v)||0<=z)return u;v=-(v+z)}v*=3.3306690738754716E-16;return u>=v||u<=-v?u:l(q,n,r)},function(q,n,r,v){var z=q[0]-v[0],u=n[0]-v[0],y=r[0]-v[0],C=q[1]-v[1],w=n[1]-v[1],x=r[1]-v[1],B=q[2]-v[2],E=n[2]-v[2],G=r[2]-v[2],P=u*x,S=y*w;y*=C;x*=z;z*=w;C*=u;u=B*(P-S)+E*(y-x)+G*(z-C);B=7.771561172376103E-16*
((Math.abs(P)+Math.abs(S))*Math.abs(B)+(Math.abs(y)+Math.abs(x))*Math.abs(E)+(Math.abs(z)+Math.abs(C))*Math.abs(G));return u>B||-u>B?u:h(q,n,r,v)}];!function(){for(;5>=m.length;)m.push(d(m.length));for(var q=[],n=["slow"],r=0;5>=r;++r)q.push("a"+r),n.push("o"+r);var v=["function getOrientation(",q.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;5>=r;++r)v.push("case ",r,":return o",r,"(",q.slice(0,r).join(),");");v.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");
n.push(v.join(""));q=Function.apply(void 0,n);b.exports=q.apply(void 0,[f].concat(m));for(r=0;5>=r;++r)b.exports[r]=m[r]}()}),En=function(b){var c=b.length;if(3>c){for(var e=Array(c),k=0;k<c;++k)e[k]=k;return 2===c&&b[0][0]===b[1][0]&&b[0][1]===b[1][1]?[0]:e}e=Array(c);for(k=0;k<c;++k)e[k]=k;e.sort(function(q,n){return b[q][0]-b[n][0]||b[q][1]-b[n][1]});var d=[e[0],e[1]],f=[e[0],e[1]];for(k=2;k<c;++k){for(var l=e[k],h=b[l],m=d.length;1<m&&0>=Lm(b[d[m-2]],b[d[m-1]],h);)--m,d.pop();d.push(l);for(m=
f.length;1<m&&0<=Lm(b[f[m-2]],b[f[m-1]],h);)--m,f.pop();f.push(l)}e=Array(f.length+d.length-2);c=0;for(l=(k=0,d.length);k<l;++k)e[c++]=d[k];for(k=f.length-2;0<k;--k)e[c++]=f[k];return e},Lm=Km[3],Yj=pg;pg.prototype={push:function(b){this.data.push(b);this.length++;this._up(this.length-1)},pop:function(){if(0!==this.length){var b=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),b}},peek:function(){return this.data[0]},_up:function(b){for(var c=
this.data,e=this.compare,k=c[b];0<b;){var d=b-1>>1,f=c[d];if(0<=e(k,f))break;c[b]=f;b=d}c[b]=k},_down:function(b){for(var c=this.data,e=this.compare,k=this.length>>1,d=c[b];b<k;){var f=1+(b<<1),l=f+1,h=c[f];if(l<this.length&&0>e(c[l],h)&&(f=l,h=c[l]),0<=e(h,d))break;c[b]=h;b=f}c[b]=d}};Yj.default=pg;var sh=Km[3],ck=Wj;ck.default=Wj;var fk=function(b,c,e){this.a=b;this.b=c;this.c=e;var k=c.x-b.x;var d=c.y-b.y,f=e.x-b.x,l=e.y-b.y,h=k*(b.x+c.x)+d*(b.y+c.y),m=f*(b.x+e.x)+l*(b.y+e.y);c=2*(k*(e.y-c.y)-
d*(e.x-c.x));this.x=(l*h-d*m)/c;this.y=(k*m-f*h)/c;k=this.x-b.x;b=this.y-b.y;this.r=k*k+b*b},vh=Object.prototype.hasOwnProperty,Mm=new ArrayBuffer(16),kk=new Float64Array(Mm),uh=new Uint32Array(Mm),Un=function(){function b(c){this.points=c.points||[];this.duration=c.duration||1E4;this.sharpness=c.sharpness||.85;this.centers=[];this.controls=[];this.stepLength=c.stepLength||60;this.length=this.points.length;for(c=this.delay=0;c<this.length;c++)this.points[c].z=this.points[c].z||0;for(c=0;c<this.length-
1;c++){var e=this.points[c],k=this.points[c+1];this.centers.push({x:(e.x+k.x)/2,y:(e.y+k.y)/2,z:(e.z+k.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(c=0;c<this.centers.length-1;c++){e=this.points[c+1].x-(this.centers[c].x+this.centers[c+1].x)/2;k=this.points[c+1].y-(this.centers[c].y+this.centers[c+1].y)/2;var d=this.points[c+1].z-(this.centers[c].y+this.centers[c+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[c+1].x+this.sharpness*(this.centers[c].x+e),y:(1-this.sharpness)*
this.points[c+1].y+this.sharpness*(this.centers[c].y+k),z:(1-this.sharpness)*this.points[c+1].z+this.sharpness*(this.centers[c].z+d)},{x:(1-this.sharpness)*this.points[c+1].x+this.sharpness*(this.centers[c+1].x+e),y:(1-this.sharpness)*this.points[c+1].y+this.sharpness*(this.centers[c+1].y+k),z:(1-this.sharpness)*this.points[c+1].z+this.sharpness*(this.centers[c+1].z+d)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),
this}return b.prototype.cacheSteps=function(c){var e=[],k=this.pos(0);e.push(0);for(var d=0;d<this.duration;d+=10){var f=this.pos(d);Math.sqrt((f.x-k.x)*(f.x-k.x)+(f.y-k.y)*(f.y-k.y)+(f.z-k.z)*(f.z-k.z))>c&&(e.push(d),k=f)}return e},b.prototype.vector=function(c){var e=this.pos(c+10);c=this.pos(c-10);return{angle:180*Math.atan2(e.y-c.y,e.x-c.x)/3.14,speed:Math.sqrt((c.x-e.x)*(c.x-e.x)+(c.y-e.y)*(c.y-e.y)+(c.z-e.z)*(c.z-e.z))}},b.prototype.pos=function(c){c-=this.delay;0>c&&(c=0);c>this.duration&&
(c=this.duration-1);c/=this.duration;if(1<=c)return this.points[this.length-1];var e=Math.floor((this.points.length-1)*c),k=(this.length-1)*c-e;c=this.points[e];var d=this.controls[e][1],f=this.controls[e+1][0];e=this.points[e+1];var l=k*k;k=[l*k,3*l*(1-k),3*k*(1-k)*(1-k),(1-k)*(1-k)*(1-k)];return{x:e.x*k[0]+f.x*k[1]+d.x*k[2]+c.x*k[3],y:e.y*k[0]+f.y*k[1]+d.y*k[2]+c.y*k[3],z:e.z*k[0]+f.z*k[1]+d.z*k[2]+c.z*k[3]}},b}(),yk=yh;yh.deviation=function(b,c,e,k){var d=c&&c.length,f=Math.abs(Ei(b,0,d?c[0]*e:
b.length,e));if(d){d=0;for(var l=c.length;d<l;d++)f-=Math.abs(Ei(b,c[d]*e,d<l-1?c[d+1]*e:b.length,e))}for(d=c=0;d<k.length;d+=3){l=k[d]*e;var h=k[d+1]*e,m=k[d+2]*e;c+=Math.abs((b[l]-b[m])*(b[h+1]-b[l+1])-(b[l]-b[h])*(b[m+1]-b[l+1]))}return 0===f&&0===c?0:Math.abs((c-f)/f)};yh.flatten=function(b){for(var c=b[0][0].length,e={vertices:[],holes:[],dimensions:c},k=0,d=0;d<b.length;d++){for(var f=0;f<b[d].length;f++)for(var l=0;l<c;l++)e.vertices.push(b[d][f][l]);0<d&&(k+=b[d-1].length,e.holes.push(k))}return e};
yk.default=yh;var Ec=ie(function(b,c){function e(u,y,C){void 0===C&&(C={});var w={type:"Feature"};return(0===C.id||C.id)&&(w.id=C.id),C.bbox&&(w.bbox=C.bbox),w.properties=y||{},w.geometry=u,w}function k(u,y,C){if(void 0===C&&(C={}),!u)throw Error("coordinates is required");if(!Array.isArray(u))throw Error("coordinates must be an Array");if(2>u.length)throw Error("coordinates must be at least 2 numbers long");if(!z(u[0])||!z(u[1]))throw Error("coordinates must contain numbers");return e({type:"Point",
coordinates:u},y,C)}function d(u,y,C){void 0===C&&(C={});for(var w=0;w<u.length;w++){var x=u[w];if(4>x.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var B=0;B<x[x.length-1].length;B++)if(x[x.length-1][B]!==x[0][B])throw Error("First and last Position are not equivalent.");}return e({type:"Polygon",coordinates:u},y,C)}function f(u,y,C){if(void 0===C&&(C={}),2>u.length)throw Error("coordinates must be an array of two or more positions");return e({type:"LineString",
coordinates:u},y,C)}function l(u,y){void 0===y&&(y={});var C={type:"FeatureCollection"};return y.id&&(C.id=y.id),y.bbox&&(C.bbox=y.bbox),C.features=u,C}function h(u,y,C){return void 0===C&&(C={}),e({type:"MultiLineString",coordinates:u},y,C)}function m(u,y,C){return void 0===C&&(C={}),e({type:"MultiPoint",coordinates:u},y,C)}function q(u,y,C){return void 0===C&&(C={}),e({type:"MultiPolygon",coordinates:u},y,C)}function n(u,y){void 0===y&&(y="kilometers");var C=c.factors[y];if(!C)throw Error(y+" units is invalid");
return u*C}function r(u,y){void 0===y&&(y="kilometers");var C=c.factors[y];if(!C)throw Error(y+" units is invalid");return u/C}function v(u){return u%(2*Math.PI)*180/Math.PI}function z(u){return!isNaN(u)&&null!==u&&!Array.isArray(u)}Object.defineProperty(c,"__esModule",{value:!0});c.earthRadius=6371008.8;c.factors={centimeters:100*c.earthRadius,centimetres:100*c.earthRadius,degrees:c.earthRadius/111325,feet:3.28084*c.earthRadius,inches:39.37*c.earthRadius,kilometers:c.earthRadius/1E3,kilometres:c.earthRadius/
1E3,meters:c.earthRadius,metres:c.earthRadius,miles:c.earthRadius/1609.344,millimeters:1E3*c.earthRadius,millimetres:1E3*c.earthRadius,nauticalmiles:c.earthRadius/1852,radians:1,yards:1.0936*c.earthRadius};c.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1E3,millimetres:1E3,nauticalmiles:1/1852,radians:1/c.earthRadius,yards:1.0936133};c.areaFactors={acres:2.47105E-4,centimeters:1E4,
centimetres:1E4,feet:10.763910417,hectares:1E-4,inches:1550.003100006,kilometers:1E-6,kilometres:1E-6,meters:1,metres:1,miles:3.86E-7,millimeters:1E6,millimetres:1E6,yards:1.195990046};c.feature=e;c.geometry=function(u,y,C){switch(u){case "Point":return k(y).geometry;case "LineString":return f(y).geometry;case "Polygon":return d(y).geometry;case "MultiPoint":return m(y).geometry;case "MultiLineString":return h(y).geometry;case "MultiPolygon":return q(y).geometry;default:throw Error(u+" is invalid");
}};c.point=k;c.points=function(u,y,C){return void 0===C&&(C={}),l(u.map(function(w){return k(w,y)}),C)};c.polygon=d;c.polygons=function(u,y,C){return void 0===C&&(C={}),l(u.map(function(w){return d(w,y)}),C)};c.lineString=f;c.lineStrings=function(u,y,C){return void 0===C&&(C={}),l(u.map(function(w){return f(w,y)}),C)};c.featureCollection=l;c.multiLineString=h;c.multiPoint=m;c.multiPolygon=q;c.geometryCollection=function(u,y,C){return void 0===C&&(C={}),e({type:"GeometryCollection",geometries:u},y,
C)};c.round=function(u,y){if(void 0===y&&(y=0),y&&!(0<=y))throw Error("precision must be a positive number");y=Math.pow(10,y||0);return Math.round(u*y)/y};c.radiansToLength=n;c.lengthToRadians=r;c.lengthToDegrees=function(u,y){return v(r(u,y))};c.bearingToAzimuth=function(u){u%=360;return 0>u&&(u+=360),u};c.radiansToDegrees=v;c.degreesToRadians=function(u){return u%360*Math.PI/180};c.convertLength=function(u,y,C){if(void 0===y&&(y="kilometers"),void 0===C&&(C="kilometers"),!(0<=u))throw Error("length must be a positive number");
return n(r(u,y),C)};c.convertArea=function(u,y,C){if(void 0===y&&(y="meters"),void 0===C&&(C="kilometers"),!(0<=u))throw Error("area must be a positive number");y=c.areaFactors[y];if(!y)throw Error("invalid original units");C=c.areaFactors[C];if(!C)throw Error("invalid final units");return u/y*C};c.isNumber=z;c.isObject=function(u){return!!u&&u.constructor===Object};c.validateBBox=function(u){if(!u)throw Error("bbox is required");if(!Array.isArray(u))throw Error("bbox must be an Array");if(4!==u.length&&
6!==u.length)throw Error("bbox must be an Array of 4 or 6 numbers");u.forEach(function(y){if(!z(y))throw Error("bbox must only contain numbers");})};c.validateId=function(u){if(!u)throw Error("id is required");if(-1===["string","number"].indexOf(typeof u))throw Error("id must be a number or a string");}}),Ji=Object.defineProperty({coordAll:function(b){var c=[];return ug(b,function(e){c.push(e)}),c},coordEach:ug,coordReduce:function(b,c,e,k){var d=e;return ug(b,function(f,l,h,m,q){d=0===l&&void 0===
e?f:c(d,f,l,h,m,q)},k),d},featureEach:Ak,featureReduce:function(b,c,e){var k=e;return Ak(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k},findPoint:function(b,c){if(c=c||{},!Ec.isObject(c))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.coordIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;
break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":return Ec.point(e,l,c);case "MultiPoint":return 0>k&&(k=e.length+k),Ec.point(e[k],l,c);case "LineString":return 0>f&&(f=e.length+f),Ec.point(e[f],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f),Ec.point(e[d][f],l,c);case "MultiLineString":return 0>
k&&(k=e.length+k),0>f&&(f=e[k].length+f),Ec.point(e[k][f],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-f),Ec.point(e[k][d][f],l,c)}throw Error("geojson is invalid");},findSegment:function(b,c){if(c=c||{},!Ec.isObject(c))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.segmentIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;
b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":case "MultiPoint":return null;case "LineString":return 0>f&&(f=e.length+f-1),Ec.lineString([e[f],e[f+1]],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f-1),Ec.lineString([e[d][f],
e[d][f+1]],l,c);case "MultiLineString":return 0>k&&(k=e.length+k),0>f&&(f=e[k].length+f-1),Ec.lineString([e[k][f],e[k][f+1]],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-f-1),Ec.lineString([e[k][d][f],e[k][d][f+1]],l,c)}throw Error("geojson is invalid");},flattenEach:Ah,flattenReduce:function(b,c,e){var k=e;return Ah(b,function(d,f,l){k=0===f&&0===l&&void 0===e?d:c(k,d,f,l)}),k},geomEach:Hi,geomReduce:function(b,c,e){var k=e;return Hi(b,function(d,
f,l,h,m){k=0===f&&void 0===e?d:c(k,d,f,l,h,m)}),k},lineEach:Ck,lineReduce:function(b,c,e){var k=e;return Ck(b,function(d,f,l,h){k=0===f&&void 0===e?d:c(k,d,f,l,h)}),k},propEach:zk,propReduce:function(b,c,e){var k=e;return zk(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k},segmentEach:Bk,segmentReduce:function(b,c,e){var k=e,d=!1;return Bk(b,function(f,l,h,m,q){k=!1===d&&void 0===e?f:c(k,f,l,h,m,q);d=!0}),k}},"__esModule",{value:!0});Ii.default=Ii;var vg=Object.defineProperty({default:Ii},"__esModule",
{value:!0}).default,Yn=Ji.featureEach,Ek=(Ji.coordEach,Ec.polygon,Ec.featureCollection),wg=Dk;wg.default=Dk;var Rk=function(b,c,e,k,d){this.coord=b;this.param=c;this.ringAndEdgeIn=e;this.ringAndEdgeOut=k;this.nxtIsectAlongEdgeIn=d},Sk=function(b,c,e,k,d,f,l){this.coord=b;this.ringAndEdge1=c;this.ringAndEdge2=e;this.nxtIsectAlongRingAndEdge1=k;this.nxtIsectAlongRingAndEdge2=d;this.ringAndEdge1Walkable=f;this.ringAndEdge2Walkable=l},Nm=Math.PI/180,Om=180/Math.PI,Lg=function(b,c){this.lon=b;this.lat=
c;this.x=Nm*b;this.y=Nm*c};Lg.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Lg.prototype.antipode=function(){return new Lg(0>this.lon?180+this.lon:-1*(180-this.lon),-1*this.lat)};var Pm=function(){this.coords=[];this.length=0};Pm.prototype.move_to=function(b){this.length++;this.coords.push(b)};var sj=function(b){this.properties=b||{};this.geometries=[]};sj.prototype.json=function(){if(0>=this.geometries.length)return{geometry:{type:"LineString",coordinates:null},
type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var b=[],c=0;c<this.geometries.length;c++)b.push(this.geometries[c].coords);return{geometry:{type:"MultiLineString",coordinates:b},type:"Feature",properties:this.properties}};sj.prototype.wkt=function(){for(var b="",c="LINESTRING(",e=function(d){c+=d[0]+" "+d[1]+","},k=0;k<this.geometries.length;k++){if(0===
this.geometries[k].coords.length)return"LINESTRING(empty)";this.geometries[k].coords.forEach(e);b+=c.substring(0,c.length-1)+")"}return b};var tj=function(b,c,e){if(!b||void 0===b.x||void 0===b.y)throw Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!c||void 0===c.x||void 0===c.y)throw Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Lg(b.x,b.y);this.end=new Lg(c.x,c.y);this.properties=
e||{};if(this.g=2*Math.asin(Math.sqrt(Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin((this.start.x-this.end.x)/2),2))),this.g===Math.PI)throw Error("it appears "+b.view()+" and "+c.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw Error("could not calculate great circle between "+b+" and "+c);};tj.prototype.interpolate=function(b){var c=Math.sin((1-b)*this.g)/
Math.sin(this.g);b=Math.sin(b*this.g)/Math.sin(this.g);var e=c*Math.cos(this.start.y)*Math.cos(this.start.x)+b*Math.cos(this.end.y)*Math.cos(this.end.x),k=c*Math.cos(this.start.y)*Math.sin(this.start.x)+b*Math.cos(this.end.y)*Math.sin(this.end.x);return[Om*Math.atan2(k,e),Om*Math.atan2(c*Math.sin(this.start.y)+b*Math.sin(this.end.y),Math.sqrt(Math.pow(e,2)+Math.pow(k,2)))]};tj.prototype.Arc=function(b,c){var e=[];if(!b||2>=b)e.push([this.start.lon,this.start.lat]),e.push([this.end.lon,this.end.lat]);
else for(var k=1/(b-1),d=0;d<b;++d){var f=this.interpolate(k*d);e.push(f)}f=!1;var l=0,h=c&&c.offset?c.offset:10;b=180-h;k=-180+h;d=360-h;for(c=1;c<e.length;++c){var m=e[c-1][0],q=e[c][0],n=Math.abs(q-m);n>d&&(q>b&&m<k||m>b&&q<k)?f=!0:n>l&&(l=n)}c=[];if(f&&l<h)for(f=[],c.push(f),l=0;l<e.length;++l)if(h=parseFloat(e[l][0]),0<l&&Math.abs(h-e[l-1][0])>d){n=parseFloat(e[l-1][0]);m=parseFloat(e[l-1][1]);var r=parseFloat(e[l][0]);q=parseFloat(e[l][1]);if(-180<n&&n<k&&180===r&&l+1<e.length&&-180<e[l-1][0]&&
e[l-1][0]<k)f.push([-180,e[l][1]]),l++,f.push([e[l][0],e[l][1]]);else if(n>b&&180>n&&-180===r&&l+1<e.length&&e[l-1][0]>b&&180>e[l-1][0])f.push([180,e[l][1]]),l++,f.push([e[l][0],e[l][1]]);else{if(n<k&&r>b){var v=n;n=r;r=v;v=m;m=q;q=v}(n>b&&r<k&&(r+=360),180>=n&&180<=r&&n<r)?(n=(180-n)/(r-n),m=n*q+(1-n)*m,f.push([e[l-1][0]>b?180:-180,m]),(f=[]).push([e[l-1][0]>b?-180:180,m])):f=[];c.push(f);f.push([h,e[l][1]])}}else f.push([e[l][0],e[l][1]]);else for(b=[],c.push(b),k=0;k<e.length;++k)b.push([e[k][0],
e[k][1]]);e=new sj(this.properties);for(b=0;b<c.length;++b)for(k=new Pm,e.geometries.push(k),d=c[b],f=0;f<d.length;++f)k.move_to(d[f]);return e};var Qm=ie(function(b,c){function e(k){var d=[],f;for(f in k)d.push(f);return d}(b.exports="function"==typeof Object.keys?Object.keys:e).shim=e}),Rm=ie(function(b,c){function e(d){return"[object Arguments]"==Object.prototype.toString.call(d)}function k(d){return d&&"object"==typeof d&&"number"==typeof d.length&&Object.prototype.hasOwnProperty.call(d,"callee")&&
!Object.prototype.propertyIsEnumerable.call(d,"callee")||!1}c="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(c=b.exports=c?e:k).supported=e;c.unsupported=k}),Gf=ie(function(b){function c(d){return!(!d||"object"!=typeof d||"number"!=typeof d.length)&&"function"==typeof d.copy&&"function"==typeof d.slice&&!(0<d.length&&"number"!=typeof d[0])}var e=Array.prototype.slice,k=b.exports=function(d,f,l){return l||={},d===f||(d instanceof Date&&f instanceof Date?d.getTime()===
f.getTime():!d||!f||"object"!=typeof d&&"object"!=typeof f?l.strict?d===f:d==f:function(h,m,q){var n,r;if(null==h||null==m||h.prototype!==m.prototype)return!1;if(Rm(h))return!!Rm(m)&&(h=e.call(h),m=e.call(m),k(h,m,q));if(c(h)){if(!c(m)||h.length!==m.length)return!1;for(n=0;n<h.length;n++)if(h[n]!==m[n])return!1;return!0}try{var v=Qm(h),z=Qm(m)}catch(u){return!1}if(v.length!=z.length)return!1;v.sort();z.sort();for(n=v.length-1;0<=n;n--)if(v[n]!=z[n])return!1;for(n=v.length-1;0<=n;n--)if(r=v[n],!k(h[r],
m[r],q))return!1;return typeof h==typeof m}(d,f,l))}}),il={successCallback:null,verbose:!1,polygons:!1},mf={},Nc=64,Rd=16,rb=[],sb=[],tb=[],ub=[],vb=[],wb=[],ib=[],jb=[],kb=[],fb=[],gb=[],hb=[],xb=[],yb=[],zb=[],Ab=[],Bb=[],Cb=[],ob=[],pb=[],qb=[],lb=[],mb=[],nb=[];ib[85]=fb[85]=-1;jb[85]=gb[85]=0;kb[85]=hb[85]=1;ob[85]=lb[85]=1;pb[85]=mb[85]=0;qb[85]=nb[85]=1;rb[85]=ub[85]=0;sb[85]=vb[85]=-1;tb[85]=zb[85]=0;Ab[85]=xb[85]=0;Bb[85]=yb[85]=1;wb[85]=Cb[85]=1;lb[1]=lb[169]=0;mb[1]=mb[169]=-1;nb[1]=nb[169]=
0;xb[1]=xb[169]=-1;yb[1]=yb[169]=0;zb[1]=zb[169]=0;fb[4]=fb[166]=0;gb[4]=gb[166]=-1;hb[4]=hb[166]=1;Ab[4]=Ab[166]=1;Bb[4]=Bb[166]=0;Cb[4]=Cb[166]=0;ib[16]=ib[154]=0;jb[16]=jb[154]=1;kb[16]=kb[154]=1;ub[16]=ub[154]=1;vb[16]=vb[154]=0;wb[16]=wb[154]=1;ob[64]=ob[106]=0;pb[64]=pb[106]=1;qb[64]=qb[106]=0;rb[64]=rb[106]=-1;sb[64]=sb[106]=0;tb[64]=tb[106]=1;ob[2]=ob[168]=0;pb[2]=pb[168]=-1;qb[2]=qb[168]=1;lb[2]=lb[168]=0;mb[2]=mb[168]=-1;nb[2]=nb[168]=0;xb[2]=xb[168]=-1;yb[2]=yb[168]=0;zb[2]=zb[168]=0;Ab[2]=
Ab[168]=-1;Bb[2]=Bb[168]=0;Cb[2]=Cb[168]=1;ib[8]=ib[162]=0;jb[8]=jb[162]=-1;kb[8]=kb[162]=0;fb[8]=fb[162]=0;gb[8]=gb[162]=-1;hb[8]=hb[162]=1;xb[8]=xb[162]=1;yb[8]=yb[162]=0;zb[8]=zb[162]=1;Ab[8]=Ab[162]=1;Bb[8]=Bb[162]=0;Cb[8]=Cb[162]=0;ib[32]=ib[138]=0;jb[32]=jb[138]=1;kb[32]=kb[138]=1;fb[32]=fb[138]=0;gb[32]=gb[138]=1;hb[32]=hb[138]=0;rb[32]=rb[138]=1;sb[32]=sb[138]=0;tb[32]=tb[138]=0;ub[32]=ub[138]=1;vb[32]=vb[138]=0;wb[32]=wb[138]=1;lb[128]=lb[42]=0;mb[128]=mb[42]=1;nb[128]=nb[42]=1;ob[128]=ob[42]=
0;pb[128]=pb[42]=1;qb[128]=qb[42]=0;rb[128]=rb[42]=-1;sb[128]=sb[42]=0;tb[128]=tb[42]=1;ub[128]=ub[42]=-1;vb[128]=vb[42]=0;wb[128]=wb[42]=0;fb[5]=fb[165]=-1;gb[5]=gb[165]=0;hb[5]=hb[165]=0;lb[5]=lb[165]=1;mb[5]=mb[165]=0;nb[5]=nb[165]=0;Ab[20]=Ab[150]=0;Bb[20]=Bb[150]=1;Cb[20]=Cb[150]=1;ub[20]=ub[150]=0;vb[20]=vb[150]=-1;wb[20]=wb[150]=1;ib[80]=ib[90]=-1;jb[80]=jb[90]=0;kb[80]=kb[90]=1;ob[80]=ob[90]=1;pb[80]=pb[90]=0;qb[80]=qb[90]=1;xb[65]=xb[105]=0;yb[65]=yb[105]=1;zb[65]=zb[105]=0;rb[65]=rb[105]=
0;sb[65]=sb[105]=-1;tb[65]=tb[105]=0;ib[160]=ib[10]=-1;jb[160]=jb[10]=0;kb[160]=kb[10]=1;fb[160]=fb[10]=-1;gb[160]=gb[10]=0;hb[160]=hb[10]=0;lb[160]=lb[10]=1;mb[160]=mb[10]=0;nb[160]=nb[10]=0;ob[160]=ob[10]=1;pb[160]=pb[10]=0;qb[160]=qb[10]=1;Ab[130]=Ab[40]=0;Bb[130]=Bb[40]=1;Cb[130]=Cb[40]=1;xb[130]=xb[40]=0;yb[130]=yb[40]=1;zb[130]=zb[40]=0;rb[130]=rb[40]=0;sb[130]=sb[40]=-1;tb[130]=tb[40]=0;ub[130]=ub[40]=0;vb[130]=vb[40]=-1;wb[130]=wb[40]=1;fb[37]=fb[133]=0;gb[37]=gb[133]=1;hb[37]=hb[133]=1;lb[37]=
lb[133]=0;mb[37]=mb[133]=1;nb[37]=nb[133]=0;rb[37]=rb[133]=-1;sb[37]=sb[133]=0;tb[37]=tb[133]=0;ub[37]=ub[133]=1;vb[37]=vb[133]=0;wb[37]=wb[133]=0;Ab[148]=Ab[22]=-1;Bb[148]=Bb[22]=0;Cb[148]=Cb[22]=0;lb[148]=lb[22]=0;mb[148]=mb[22]=-1;nb[148]=nb[22]=1;ob[148]=ob[22]=0;pb[148]=pb[22]=1;qb[148]=qb[22]=1;ub[148]=ub[22]=-1;vb[148]=vb[22]=0;wb[148]=wb[22]=1;ib[82]=ib[88]=0;jb[82]=jb[88]=-1;kb[82]=kb[88]=1;Ab[82]=Ab[88]=1;Bb[82]=Bb[88]=0;Cb[82]=Cb[88]=1;xb[82]=xb[88]=-1;yb[82]=yb[88]=0;zb[82]=zb[88]=1;ob[82]=
ob[88]=0;pb[82]=pb[88]=-1;qb[82]=qb[88]=0;ib[73]=ib[97]=0;jb[73]=jb[97]=1;kb[73]=kb[97]=0;fb[73]=fb[97]=0;gb[73]=gb[97]=-1;hb[73]=hb[97]=0;xb[73]=xb[97]=1;yb[73]=yb[97]=0;zb[73]=zb[97]=0;rb[73]=rb[97]=1;sb[73]=sb[97]=0;tb[73]=tb[97]=1;ib[145]=ib[25]=0;jb[145]=jb[25]=-1;kb[145]=kb[25]=0;xb[145]=xb[25]=1;yb[145]=yb[25]=0;zb[145]=zb[25]=1;lb[145]=lb[25]=0;mb[145]=mb[25]=1;nb[145]=nb[25]=1;ub[145]=ub[25]=-1;vb[145]=vb[25]=0;wb[145]=wb[25]=0;fb[70]=fb[100]=0;gb[70]=gb[100]=1;hb[70]=hb[100]=0;Ab[70]=Ab[100]=
-1;Bb[70]=Bb[100]=0;Cb[70]=Cb[100]=1;ob[70]=ob[100]=0;pb[70]=pb[100]=-1;qb[70]=qb[100]=1;rb[70]=rb[100]=1;sb[70]=sb[100]=0;tb[70]=tb[100]=0;fb[101]=fb[69]=0;gb[101]=gb[69]=1;hb[101]=hb[69]=0;rb[101]=rb[69]=1;sb[101]=sb[69]=0;tb[101]=tb[69]=0;lb[149]=lb[21]=0;mb[149]=mb[21]=1;nb[149]=nb[21]=1;ub[149]=ub[21]=-1;vb[149]=vb[21]=0;wb[149]=wb[21]=0;Ab[86]=Ab[84]=-1;Bb[86]=Bb[84]=0;Cb[86]=Cb[84]=1;ob[86]=ob[84]=0;pb[86]=pb[84]=-1;qb[86]=qb[84]=1;ib[89]=ib[81]=0;jb[89]=jb[81]=-1;kb[89]=kb[81]=0;xb[89]=xb[81]=
1;yb[89]=yb[81]=0;zb[89]=zb[81]=1;ib[96]=ib[74]=0;jb[96]=jb[74]=1;kb[96]=kb[74]=0;fb[96]=fb[74]=-1;gb[96]=gb[74]=0;hb[96]=hb[74]=1;ob[96]=ob[74]=1;pb[96]=pb[74]=0;qb[96]=qb[74]=0;rb[96]=rb[74]=1;sb[96]=sb[74]=0;tb[96]=tb[74]=1;ib[24]=ib[146]=0;jb[24]=jb[146]=-1;kb[24]=kb[146]=1;Ab[24]=Ab[146]=1;Bb[24]=Bb[146]=0;Cb[24]=Cb[146]=1;xb[24]=xb[146]=0;yb[24]=yb[146]=1;zb[24]=zb[146]=1;ub[24]=ub[146]=0;vb[24]=vb[146]=-1;wb[24]=wb[146]=0;fb[6]=fb[164]=-1;gb[6]=gb[164]=0;hb[6]=hb[164]=1;Ab[6]=Ab[164]=-1;Bb[6]=
Bb[164]=0;Cb[6]=Cb[164]=0;lb[6]=lb[164]=0;mb[6]=mb[164]=-1;nb[6]=nb[164]=1;ob[6]=ob[164]=1;pb[6]=pb[164]=0;qb[6]=qb[164]=0;xb[129]=xb[41]=0;yb[129]=yb[41]=1;zb[129]=zb[41]=1;lb[129]=lb[41]=0;mb[129]=mb[41]=1;nb[129]=nb[41]=0;rb[129]=rb[41]=-1;sb[129]=sb[41]=0;tb[129]=tb[41]=0;ub[129]=ub[41]=0;vb[129]=vb[41]=-1;wb[129]=wb[41]=0;Ab[66]=Ab[104]=0;Bb[66]=Bb[104]=1;Cb[66]=Cb[104]=0;xb[66]=xb[104]=-1;yb[66]=yb[104]=0;zb[66]=zb[104]=1;ob[66]=ob[104]=0;pb[66]=pb[104]=-1;qb[66]=qb[104]=0;rb[66]=rb[104]=0;
sb[66]=sb[104]=-1;tb[66]=tb[104]=1;ib[144]=ib[26]=-1;jb[144]=jb[26]=0;kb[144]=kb[26]=0;lb[144]=lb[26]=1;mb[144]=mb[26]=0;nb[144]=nb[26]=1;ob[144]=ob[26]=0;pb[144]=pb[26]=1;qb[144]=qb[26]=1;ub[144]=ub[26]=-1;vb[144]=vb[26]=0;wb[144]=wb[26]=1;fb[36]=fb[134]=0;gb[36]=gb[134]=1;hb[36]=hb[134]=1;Ab[36]=Ab[134]=0;Bb[36]=Bb[134]=1;Cb[36]=Cb[134]=0;rb[36]=rb[134]=0;sb[36]=sb[134]=-1;tb[36]=tb[134]=1;ub[36]=ub[134]=1;vb[36]=vb[134]=0;wb[36]=wb[134]=0;ib[9]=ib[161]=-1;jb[9]=jb[161]=0;kb[9]=kb[161]=0;fb[9]=
fb[161]=0;gb[9]=gb[161]=-1;hb[9]=hb[161]=0;xb[9]=xb[161]=1;yb[9]=yb[161]=0;zb[9]=zb[161]=0;lb[9]=lb[161]=1;mb[9]=mb[161]=0;nb[9]=nb[161]=1;ib[136]=0;jb[136]=1;kb[136]=1;fb[136]=0;gb[136]=1;hb[136]=0;Ab[136]=-1;Bb[136]=0;Cb[136]=1;xb[136]=-1;yb[136]=0;zb[136]=0;lb[136]=0;mb[136]=-1;nb[136]=0;ob[136]=0;pb[136]=-1;qb[136]=1;rb[136]=1;sb[136]=0;tb[136]=0;ub[136]=1;vb[136]=0;wb[136]=1;ib[34]=0;jb[34]=-1;kb[34]=0;fb[34]=0;gb[34]=-1;hb[34]=1;Ab[34]=1;Bb[34]=0;Cb[34]=0;xb[34]=1;yb[34]=0;zb[34]=1;lb[34]=0;
mb[34]=1;nb[34]=1;ob[34]=0;pb[34]=1;qb[34]=0;rb[34]=-1;sb[34]=0;tb[34]=1;ub[34]=-1;vb[34]=0;wb[34]=0;ib[35]=0;jb[35]=1;kb[35]=1;fb[35]=0;gb[35]=-1;hb[35]=1;Ab[35]=1;Bb[35]=0;Cb[35]=0;xb[35]=-1;yb[35]=0;zb[35]=0;lb[35]=0;mb[35]=-1;nb[35]=0;ob[35]=0;pb[35]=1;qb[35]=0;rb[35]=-1;sb[35]=0;tb[35]=1;ub[35]=1;vb[35]=0;wb[35]=1;ib[153]=0;jb[153]=1;kb[153]=1;xb[153]=-1;yb[153]=0;zb[153]=0;lb[153]=0;mb[153]=-1;nb[153]=0;ub[153]=1;vb[153]=0;wb[153]=1;fb[102]=0;gb[102]=-1;hb[102]=1;Ab[102]=1;Bb[102]=0;Cb[102]=
0;ob[102]=0;pb[102]=1;qb[102]=0;rb[102]=-1;sb[102]=0;tb[102]=1;ib[155]=0;jb[155]=-1;kb[155]=0;xb[155]=1;yb[155]=0;zb[155]=1;lb[155]=0;mb[155]=1;nb[155]=1;ub[155]=-1;vb[155]=0;wb[155]=0;fb[103]=0;gb[103]=1;hb[103]=0;Ab[103]=-1;Bb[103]=0;Cb[103]=1;ob[103]=0;pb[103]=-1;qb[103]=1;rb[103]=1;sb[103]=0;tb[103]=0;ib[152]=0;jb[152]=1;kb[152]=1;Ab[152]=-1;Bb[152]=0;Cb[152]=1;xb[152]=-1;yb[152]=0;zb[152]=0;lb[152]=0;mb[152]=-1;nb[152]=0;ob[152]=0;pb[152]=-1;qb[152]=1;ub[152]=1;vb[152]=0;wb[152]=1;ib[156]=0;
jb[156]=-1;kb[156]=1;Ab[156]=1;Bb[156]=0;Cb[156]=1;xb[156]=-1;yb[156]=0;zb[156]=0;lb[156]=0;mb[156]=-1;nb[156]=0;ob[156]=0;pb[156]=1;qb[156]=1;ub[156]=-1;vb[156]=0;wb[156]=1;ib[137]=0;jb[137]=1;kb[137]=1;fb[137]=0;gb[137]=1;hb[137]=0;xb[137]=-1;yb[137]=0;zb[137]=0;lb[137]=0;mb[137]=-1;nb[137]=0;rb[137]=1;sb[137]=0;tb[137]=0;ub[137]=1;vb[137]=0;wb[137]=1;ib[139]=0;jb[139]=1;kb[139]=1;fb[139]=0;gb[139]=-1;hb[139]=0;xb[139]=1;yb[139]=0;zb[139]=0;lb[139]=0;mb[139]=1;nb[139]=0;rb[139]=-1;sb[139]=0;tb[139]=
0;ub[139]=1;vb[139]=0;wb[139]=1;ib[98]=0;jb[98]=-1;kb[98]=0;fb[98]=0;gb[98]=-1;hb[98]=1;Ab[98]=1;Bb[98]=0;Cb[98]=0;xb[98]=1;yb[98]=0;zb[98]=1;ob[98]=0;pb[98]=1;qb[98]=0;rb[98]=-1;sb[98]=0;tb[98]=1;ib[99]=0;jb[99]=1;kb[99]=0;fb[99]=0;gb[99]=-1;hb[99]=1;Ab[99]=1;Bb[99]=0;Cb[99]=0;xb[99]=-1;yb[99]=0;zb[99]=1;ob[99]=0;pb[99]=-1;qb[99]=0;rb[99]=1;sb[99]=0;tb[99]=1;fb[38]=0;gb[38]=-1;hb[38]=1;Ab[38]=1;Bb[38]=0;Cb[38]=0;lb[38]=0;mb[38]=1;nb[38]=1;ob[38]=0;pb[38]=1;qb[38]=0;rb[38]=-1;sb[38]=0;tb[38]=1;ub[38]=
-1;vb[38]=0;wb[38]=0;fb[39]=0;gb[39]=1;hb[39]=1;Ab[39]=-1;Bb[39]=0;Cb[39]=0;lb[39]=0;mb[39]=-1;nb[39]=1;ob[39]=0;pb[39]=1;qb[39]=0;rb[39]=-1;sb[39]=0;tb[39]=1;ub[39]=1;vb[39]=0;wb[39]=0;var uj=function(b){return[[b.bottomleft,0],[0,0],[0,b.leftbottom]]},vj=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0]]},wj=function(b){return[[b.topright,1],[1,1],[1,b.righttop]]},xj=function(b){return[[0,b.lefttop],[0,1],[b.topleft,1]]},yj=function(b){return[[b.bottomright,0],[b.bottomleft,0],[0,b.leftbottom],
[0,b.lefttop]]},zj=function(b){return[[b.bottomright,0],[b.bottomleft,0],[1,b.righttop],[1,b.rightbottom]]},Aj=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.topleft,1],[b.topright,1]]},Bj=function(b){return[[0,b.leftbottom],[0,b.lefttop],[b.topleft,1],[b.topright,1]]},Ha=[],Ga=[],La=[],Ja=[],Ua=[],Ta=[],eb=[],Db=[];Ja[1]=Ua[1]=18;Ja[169]=Ua[169]=18;La[4]=Ga[4]=12;La[166]=Ga[166]=12;Ha[16]=Db[16]=4;Ha[154]=Db[154]=4;Ta[64]=eb[64]=22;Ta[106]=eb[106]=22;La[2]=Ta[2]=17;Ja[2]=Ua[2]=18;La[168]=
Ta[168]=17;Ja[168]=Ua[168]=18;Ha[8]=Ja[8]=9;Ga[8]=La[8]=12;Ha[162]=Ja[162]=9;Ga[162]=La[162]=12;Ha[32]=Db[32]=4;Ga[32]=eb[32]=1;Ha[138]=Db[138]=4;Ga[138]=eb[138]=1;Ua[128]=Db[128]=21;Ta[128]=eb[128]=22;Ua[42]=Db[42]=21;Ta[42]=eb[42]=22;Ga[5]=Ua[5]=14;Ga[165]=Ua[165]=14;La[20]=Db[20]=6;La[150]=Db[150]=6;Ha[80]=Ta[80]=11;Ha[90]=Ta[90]=11;Ja[65]=eb[65]=3;Ja[105]=eb[105]=3;Ha[160]=Ta[160]=11;Ga[160]=Ua[160]=14;Ha[10]=Ta[10]=11;Ga[10]=Ua[10]=14;La[130]=Db[130]=6;Ja[130]=eb[130]=3;La[40]=Db[40]=6;Ja[40]=
eb[40]=3;Ga[101]=eb[101]=1;Ga[69]=eb[69]=1;Ua[149]=Db[149]=21;Ua[21]=Db[21]=21;La[86]=Ta[86]=17;La[84]=Ta[84]=17;Ha[89]=Ja[89]=9;Ha[81]=Ja[81]=9;Ha[96]=eb[96]=0;Ga[96]=Ta[96]=15;Ha[74]=eb[74]=0;Ga[74]=Ta[74]=15;Ha[24]=La[24]=8;Ja[24]=Db[24]=7;Ha[146]=La[146]=8;Ja[146]=Db[146]=7;Ga[6]=Ta[6]=15;La[6]=Ua[6]=16;Ga[164]=Ta[164]=15;La[164]=Ua[164]=16;Ja[129]=Db[129]=7;Ua[129]=eb[129]=20;Ja[41]=Db[41]=7;Ua[41]=eb[41]=20;La[66]=eb[66]=2;Ja[66]=Ta[66]=19;La[104]=eb[104]=2;Ja[104]=Ta[104]=19;Ha[144]=Ua[144]=
10;Ta[144]=Db[144]=23;Ha[26]=Ua[26]=10;Ta[26]=Db[26]=23;Ga[36]=Db[36]=5;La[36]=eb[36]=2;Ga[134]=Db[134]=5;La[134]=eb[134]=2;Ha[9]=Ua[9]=10;Ga[9]=Ja[9]=13;Ha[161]=Ua[161]=10;Ga[161]=Ja[161]=13;Ga[37]=Db[37]=5;Ua[37]=eb[37]=20;Ga[133]=Db[133]=5;Ua[133]=eb[133]=20;La[148]=Ua[148]=16;Ta[148]=Db[148]=23;La[22]=Ua[22]=16;Ta[22]=Db[22]=23;Ha[82]=La[82]=8;Ja[82]=Ta[82]=19;Ha[88]=La[88]=8;Ja[88]=Ta[88]=19;Ha[73]=eb[73]=0;Ga[73]=Ja[73]=13;Ha[97]=eb[97]=0;Ga[97]=Ja[97]=13;Ha[145]=Ja[145]=9;Ua[145]=Db[145]=21;
Ha[25]=Ja[25]=9;Ua[25]=Db[25]=21;Ga[70]=eb[70]=1;La[70]=Ta[70]=17;Ga[100]=eb[100]=1;La[100]=Ta[100]=17;Ha[34]=Ja[34]=9;Ga[34]=La[34]=12;Ua[34]=Db[34]=21;Ta[34]=eb[34]=22;Ha[136]=Db[136]=4;Ga[136]=eb[136]=1;La[136]=Ta[136]=17;Ja[136]=Ua[136]=18;Ha[35]=Db[35]=4;Ga[35]=La[35]=12;Ja[35]=Ua[35]=18;Ta[35]=eb[35]=22;Ha[153]=Db[153]=4;Ja[153]=Ua[153]=18;Ga[102]=La[102]=12;Ta[102]=eb[102]=22;Ha[155]=Ja[155]=9;Ua[155]=Db[155]=23;Ga[103]=eb[103]=1;La[103]=Ta[103]=17;Ha[152]=Db[152]=4;La[152]=Ta[152]=17;Ja[152]=
Ua[152]=18;Ha[156]=La[156]=8;Ja[156]=Ua[156]=18;Ta[156]=Db[156]=23;Ha[137]=Db[137]=4;Ga[137]=eb[137]=1;Ja[137]=Ua[137]=18;Ha[139]=Db[139]=4;Ga[139]=Ja[139]=13;Ua[139]=eb[139]=20;Ha[98]=Ja[98]=9;Ga[98]=La[98]=12;Ta[98]=eb[98]=22;Ha[99]=eb[99]=0;Ga[99]=La[99]=12;Ja[99]=Ta[99]=19;Ga[38]=La[38]=12;Ua[38]=Db[38]=21;Ta[38]=eb[38]=22;Ga[39]=Db[39]=5;La[39]=Ua[39]=16;Ta[39]=eb[39]=22;var Ea=[];Ea[1]=Ea[169]=uj;Ea[4]=Ea[166]=vj;Ea[16]=Ea[154]=wj;Ea[64]=Ea[106]=xj;Ea[168]=Ea[2]=yj;Ea[162]=Ea[8]=zj;Ea[138]=
Ea[32]=Aj;Ea[42]=Ea[128]=Bj;Ea[5]=Ea[165]=function(b){return[[0,0],[0,b.leftbottom],[1,b.rightbottom],[1,0]]};Ea[20]=Ea[150]=function(b){return[[1,0],[b.bottomright,0],[b.topright,1],[1,1]]};Ea[80]=Ea[90]=function(b){return[[1,1],[1,b.righttop],[0,b.lefttop],[0,1]]};Ea[65]=Ea[105]=function(b){return[[b.bottomleft,0],[0,0],[0,1],[b.topleft,1]]};Ea[160]=Ea[10]=function(b){return[[1,b.righttop],[1,b.rightbottom],[0,b.leftbottom],[0,b.lefttop]]};Ea[130]=Ea[40]=function(b){return[[b.topleft,1],[b.topright,
1],[b.bottomright,0],[b.bottomleft,0]]};Ea[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]};Ea[101]=Ea[69]=function(b){return[[1,b.rightbottom],[1,0],[0,0],[0,1],[b.topleft,1]]};Ea[149]=Ea[21]=function(b){return[[b.topright,1],[1,1],[1,0],[0,0],[0,b.leftbottom]]};Ea[86]=Ea[84]=function(b){return[[1,0],[b.bottomright,0],[0,b.lefttop],[0,1],[1,1]]};Ea[89]=Ea[81]=function(b){return[[1,1],[1,b.righttop],[b.bottomleft,0],[0,0],[0,1]]};Ea[96]=Ea[74]=function(b){return[[1,b.righttop],[1,b.rightbottom],[0,
b.lefttop],[0,1],[b.topleft,1]]};Ea[24]=Ea[146]=function(b){return[[1,1],[1,b.righttop],[b.bottomright,0],[b.bottomleft,0],[b.topright,1]]};Ea[6]=Ea[164]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.leftbottom],[0,b.lefttop]]};Ea[129]=Ea[41]=function(b){return[[b.topright,1],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topleft,1]]};Ea[66]=Ea[104]=function(b){return[[b.bottomright,0],[b.bottomleft,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[144]=Ea[26]=function(b){return[[1,1],[1,
b.righttop],[0,b.leftbottom],[0,b.lefttop],[b.topright,1]]};Ea[36]=Ea[134]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[b.topleft,1],[b.topright,1]]};Ea[9]=Ea[161]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomleft,0],[0,0],[0,b.leftbottom]]};Ea[37]=Ea[133]=function(b){return[[1,b.rightbottom],[1,0],[0,0],[0,b.leftbottom],[b.topleft,1],[b.topright,1]]};Ea[148]=Ea[22]=function(b){return[[1,1],[1,0],[b.bottomright,0],[0,b.leftbottom],[0,b.lefttop],[b.topright,1]]};Ea[82]=
Ea[88]=function(b){return[[1,1],[1,b.righttop],[b.bottomright,0],[b.bottomleft,0],[0,b.lefttop],[0,1]]};Ea[73]=Ea[97]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomleft,0],[0,0],[0,1],[b.topleft,1]]};Ea[145]=Ea[25]=function(b){return[[1,1],[1,b.righttop],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topright,1]]};Ea[70]=Ea[100]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[34]=function(b){return[Bj(b),zj(b)]};Ea[35]=function(b){return[[1,
b.righttop],[1,b.rightbottom],[b.bottomright,0],[b.bottomleft,0],[0,b.leftbottom],[0,b.lefttop],[b.topleft,1],[b.topright,1]]};Ea[136]=function(b){return[Aj(b),yj(b)]};Ea[153]=function(b){return[wj(b),uj(b)]};Ea[102]=function(b){return[vj(b),xj(b)]};Ea[155]=function(b){return[[1,1],[1,b.righttop],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topright,1]]};Ea[103]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[152]=function(b){return[wj(b),yj(b)]};
Ea[156]=function(b){return[[1,1],[1,b.righttop],[b.bottomright,0],[b.bottomleft,0],[0,b.leftbottom],[0,b.lefttop],[b.topright,1]]};Ea[137]=function(b){return[Aj(b),uj(b)]};Ea[139]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topleft,1],[b.topright,1]]};Ea[98]=function(b){return[zj(b),xj(b)]};Ea[99]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomright,0],[b.bottomleft,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[38]=function(b){return[vj(b),
Bj(b)]};Ea[39]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.leftbottom],[0,b.lefttop],[b.topleft,1],[b.topright,1]]};var Sm=function(){function b(c){this.id=b.buildId(c);this.coordinates=c;this.innerEdges=[];this.outerEdges=[];this.outerEdgesSorted=!1}return b.buildId=function(c){return c.join(",")},b.prototype.removeInnerEdge=function(c){this.innerEdges=this.innerEdges.filter(function(e){return e.from.id!==c.from.id})},b.prototype.removeOuterEdge=function(c){this.outerEdges=
this.outerEdges.filter(function(e){return e.to.id!==c.to.id})},b.prototype.addOuterEdge=function(c){this.outerEdges.push(c);this.outerEdgesSorted=!1},b.prototype.sortOuterEdges=function(){var c=this;this.outerEdgesSorted||(this.outerEdges.sort(function(e,k){e=e.to;k=k.to;if(0<=e.coordinates[0]-c.coordinates[0]&&0>k.coordinates[0]-c.coordinates[0])return 1;if(0>e.coordinates[0]-c.coordinates[0]&&0<=k.coordinates[0]-c.coordinates[0])return-1;if(0==e.coordinates[0]-c.coordinates[0]&&0==k.coordinates[0]-
c.coordinates[0])return 0<=e.coordinates[1]-c.coordinates[1]||0<=k.coordinates[1]-c.coordinates[1]?e.coordinates[1]-k.coordinates[1]:k.coordinates[1]-e.coordinates[1];var d=Ui(c.coordinates,e.coordinates,k.coordinates);return 0>d?1:0<d?-1:Math.pow(e.coordinates[0]-c.coordinates[0],2)+Math.pow(e.coordinates[1]-c.coordinates[1],2)-(Math.pow(k.coordinates[0]-c.coordinates[0],2)+Math.pow(k.coordinates[1]-c.coordinates[1],2))}),this.outerEdgesSorted=!0)},b.prototype.getOuterEdges=function(){return this.sortOuterEdges(),
this.outerEdges},b.prototype.getOuterEdge=function(c){return this.sortOuterEdges(),this.outerEdges[c]},b.prototype.addInnerEdge=function(c){this.innerEdges.push(c)},b}(),$o=function(){function b(c,e){this.from=c;this.to=e;this.ring=this.symetric=this.label=this.next=void 0;this.from.addOuterEdge(this);this.to.addInnerEdge(this)}return b.prototype.getSymetric=function(){return this.symetric||(this.symetric=new b(this.to,this.from),this.symetric.symetric=this),this.symetric},b.prototype.deleteEdge=
function(){this.from.removeOuterEdge(this);this.to.removeInnerEdge(this)},b.prototype.isEqual=function(c){return this.from.id===c.from.id&&this.to.id===c.to.id},b.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},b.prototype.toLineString=function(){return K([this.from.coordinates,this.to.coordinates])},b.prototype.compareTo=function(c){return Ui(c.from.coordinates,c.to.coordinates,this.to.coordinates)},b}(),Tm=function(){function b(){this.edges=[];this.envelope=this.polygon=
void 0}return b.prototype.push=function(c){this.edges.push(c);this.polygon=this.envelope=void 0},b.prototype.get=function(c){return this.edges[c]},Object.defineProperty(b.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),b.prototype.forEach=function(c){this.edges.forEach(c)},b.prototype.map=function(c){return this.edges.map(c)},b.prototype.some=function(c){return this.edges.some(c)},b.prototype.isValid=function(){return!0},b.prototype.isHole=function(){var c=
this,e=this.edges.reduce(function(f,l,h){return l.from.coordinates[1]>c.edges[f].from.coordinates[1]&&(f=h),f},0),k=(0===e?this.length:e)-1,d=(e+1)%this.length;e=Ui(this.edges[k].from.coordinates,this.edges[e].from.coordinates,this.edges[d].from.coordinates);return 0===e?this.edges[k].from.coordinates[0]>this.edges[d].from.coordinates[0]:0<e},b.prototype.toMultiPoint=function(){return N(this.edges.map(function(c){return c.from.coordinates}))},b.prototype.toPolygon=function(){if(this.polygon)return this.polygon;
var c=this.edges.map(function(e){return e.from.coordinates});return c.push(this.edges[0].from.coordinates),this.polygon=D([c])},b.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=rk(this.toPolygon())},b.findEdgeRingContaining=function(c,e){var k,d,f=c.getEnvelope();return e.forEach(function(l){var h,m,q,n,r=l.getEnvelope();if((d&&(k=d.getEnvelope()),h=r.geometry.coordinates[0].map(function(z){return z[0]}),m=r.geometry.coordinates[0].map(function(z){return z[1]}),
q=f.geometry.coordinates[0].map(function(z){return z[0]}),n=f.geometry.coordinates[0].map(function(z){return z[1]}),Math.max.apply(null,h)!==Math.max.apply(null,q)||Math.max.apply(null,m)!==Math.max.apply(null,n)||Math.min.apply(null,h)!==Math.min.apply(null,q)||Math.min.apply(null,m)!==Math.min.apply(null,n))&&nl(r,f)){var v=void 0;h=function(z){l.some(function(u){return y=z,C=u.from.coordinates,y[0]===C[0]&&y[1]===C[1];var y,C})||(v=z)};m=0;for(q=c.map(function(z){return z.from.coordinates});m<
q.length;m++)h(q[m]);v&&l.inside(t(v))&&(d&&!nl(k,r)||(d=l))}}),d},b.prototype.inside=function(c){return Tb(c,this.toPolygon())},b}(),ap=function(){function b(){this.edges=[];this.nodes={}}return b.fromGeoJson=function(c){if(!c)throw Error("No geojson passed");if("FeatureCollection"!==c.type&&"GeometryCollection"!==c.type&&"MultiLineString"!==c.type&&"LineString"!==c.type&&"Feature"!==c.type)throw Error("Invalid input type '"+c.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature");
!0;var e=new b;return Rb(c,function(k){Ob(k,"LineString","Graph::fromGeoJson");Vb(k,function(d,f){if(d){d=e.getNode(d);var l=e.getNode(f);e.addEdge(d,l)}return f})}),e},b.prototype.getNode=function(c){var e=Sm.buildId(c),k=this.nodes[e];return k||=this.nodes[e]=new Sm(c),k},b.prototype.addEdge=function(c,e){c=new $o(c,e);e=c.getSymetric();this.edges.push(c);this.edges.push(e)},b.prototype.deleteDangles=function(){var c=this;Object.keys(this.nodes).map(function(e){return c.nodes[e]}).forEach(function(e){return c._removeIfDangle(e)})},
b.prototype._removeIfDangle=function(c){var e=this;if(1>=c.innerEdges.length){var k=c.getOuterEdges().map(function(d){return d.to});this.removeNode(c);k.forEach(function(d){return e._removeIfDangle(d)})}},b.prototype.deleteCutEdges=function(){var c=this;this._computeNextCWEdges();this._findLabeledEdgeRings();this.edges.forEach(function(e){e.label===e.symetric.label&&(c.removeEdge(e.symetric),c.removeEdge(e))})},b.prototype._computeNextCWEdges=function(c){var e=this;void 0===c?Object.keys(this.nodes).forEach(function(k){return e._computeNextCWEdges(e.nodes[k])}):
c.getOuterEdges().forEach(function(k,d){c.getOuterEdge((0===d?c.getOuterEdges().length:d)-1).symetric.next=k})},b.prototype._computeNextCCWEdges=function(c,e){var k,d;c=c.getOuterEdges();for(var f=c.length-1;0<=f;--f){var l=c[f],h=l.symetric,m=void 0,q=void 0;l.label===e&&(m=l);h.label===e&&(q=h);m&&q&&(q&&(d=q),m&&(d&&(d.next=m,d=void 0),k||=m))}d&&(d.next=k)},b.prototype._findLabeledEdgeRings=function(){var c=[],e=0;return this.edges.forEach(function(k){if(!(0<=k.label)){c.push(k);var d=k;do d.label=
e,d=d.next;while(!k.isEqual(d));e++}}),c},b.prototype.getEdgeRings=function(){var c=this;this._computeNextCWEdges();this.edges.forEach(function(k){k.label=void 0});this._findLabeledEdgeRings().forEach(function(k){c._findIntersectionNodes(k).forEach(function(d){c._computeNextCCWEdges(d,k.label)})});var e=[];return this.edges.forEach(function(k){k.ring||e.push(c._findEdgeRing(k))}),e},b.prototype._findIntersectionNodes=function(c){var e=[],k=c,d=function(){var f=0;k.from.getOuterEdges().forEach(function(l){l.label===
c.label&&++f});1<f&&e.push(k.from);k=k.next};do d();while(!c.isEqual(k));return e},b.prototype._findEdgeRing=function(c){var e=c,k=new Tm;do k.push(e),e.ring=k,e=e.next;while(!c.isEqual(e));return k},b.prototype.removeNode=function(c){var e=this;c.getOuterEdges().forEach(function(k){return e.removeEdge(k)});c.innerEdges.forEach(function(k){return e.removeEdge(k)});delete this.nodes[c.id]},b.prototype.removeEdge=function(c){this.edges=this.edges.filter(function(e){return!e.isEqual(c)});c.deleteEdge()},
b}(),Td=function(b){this.precision=b&&b.precision?b.precision:17;this.direction=!(!b||!b.direction)&&b.direction;this.pseudoNode=!(!b||!b.pseudoNode)&&b.pseudoNode;this.objectComparator=b&&b.objectComparator?b.objectComparator:mo};Td.prototype.compare=function(b,c){if(b.type!==c.type||!wl(b,c))return!1;switch(b.type){case "Point":return this.compareCoord(b.coordinates,c.coordinates);case "LineString":return this.compareLine(b.coordinates,c.coordinates,0,!1);case "Polygon":return this.comparePolygon(b,
c);case "Feature":return this.compareFeature(b,c);default:if(0===b.type.indexOf("Multi")){var e=this;b=vl(b);c=vl(c);return b.every(function(k){return this.some(function(d){return e.compare(k,d)})},c)}}return!1};Td.prototype.compareCoord=function(b,c){if(b.length!==c.length)return!1;for(var e=0;e<b.length;e++)if(b[e].toFixed(this.precision)!==c[e].toFixed(this.precision))return!1;return!0};Td.prototype.compareLine=function(b,c,e,k){if(!wl(b,c))return!1;b=this.pseudoNode?b:this.removePseudo(b);c=this.pseudoNode?
c:this.removePseudo(c);if(!k||this.compareCoord(b[0],c[0])||(c=this.fixStartIndex(c,b)))return k=this.compareCoord(b[e],c[e]),this.direction||k?this.comparePath(b,c):!!this.compareCoord(b[e],c[c.length-(1+e)])&&this.comparePath(b.slice().reverse(),c)};Td.prototype.fixStartIndex=function(b,c){for(var e,k=-1,d=0;d<b.length;d++)if(this.compareCoord(b[d],c[0])){k=d;break}return 0<=k&&(e=[].concat(b.slice(k,b.length),b.slice(1,k+1))),e};Td.prototype.comparePath=function(b,c){var e=this;return b.every(function(k,
d){return e.compareCoord(k,this[d])},c)};Td.prototype.comparePolygon=function(b,c){if(this.compareLine(b.coordinates[0],c.coordinates[0],1,!0)){b=b.coordinates.slice(1,b.coordinates.length);c=c.coordinates.slice(1,c.coordinates.length);var e=this;return b.every(function(k){return this.some(function(d){return e.compareLine(k,d,1,!0)})},c)}return!1};Td.prototype.compareFeature=function(b,c){return!(b.id!==c.id||!this.objectComparator(b.properties,c.properties)||!this.compareBBox(b,c))&&this.compare(b.geometry,
c.geometry)};Td.prototype.compareBBox=function(b,c){return!!(!b.bbox&&!c.bbox||b.bbox&&c.bbox&&this.compareCoord(b.bbox,c.bbox))};Td.prototype.removePseudo=function(b){return b};var bp=ie(function(b){function c(e,k,d,f){this.dataset=[];this.epsilon=1;this.minPts=2;this.distance=this._euclideanDistance;this.clusters=[];this.noise=[];this._visited=[];this._assigned=[];this._datasetLength=0;this._init(e,k,d,f)}c.prototype.run=function(e,k,d,f){this._init(e,k,d,f);for(e=0;e<this._datasetLength;e++)1!==
this._visited[e]&&(this._visited[e]=1,k=this._regionQuery(e),k.length<this.minPts?this.noise.push(e):(d=this.clusters.length,this.clusters.push([]),this._addToCluster(e,d),this._expandCluster(d,k)));return this.clusters};c.prototype._init=function(e,k,d,f){if(e){if(!(e instanceof Array))throw Error("Dataset must be of type array, "+typeof e+" given");this.dataset=e;this.clusters=[];this.noise=[];this._datasetLength=e.length;this._visited=Array(this._datasetLength);this._assigned=Array(this._datasetLength)}k&&
(this.epsilon=k);d&&(this.minPts=d);f&&(this.distance=f)};c.prototype._expandCluster=function(e,k){for(var d=0;d<k.length;d++){var f=k[d];if(1!==this._visited[f]){this._visited[f]=1;var l=this._regionQuery(f);l.length>=this.minPts&&(k=this._mergeArrays(k,l))}1!==this._assigned[f]&&this._addToCluster(f,e)}};c.prototype._addToCluster=function(e,k){this.clusters[k].push(e);this._assigned[e]=1};c.prototype._regionQuery=function(e){for(var k=[],d=0;d<this._datasetLength;d++)this.distance(this.dataset[e],
this.dataset[d])<this.epsilon&&k.push(d);return k};c.prototype._mergeArrays=function(e,k){for(var d=k.length,f=0;f<d;f++){var l=k[f];0>e.indexOf(l)&&e.push(l)}return e};c.prototype._euclideanDistance=function(e,k){for(var d=0,f=Math.min(e.length,k.length);f--;)d+=(e[f]-k[f])*(e[f]-k[f]);return Math.sqrt(d)};b.exports&&(b.exports=c)}),cp=ie(function(b){function c(e,k,d){this.k=3;this.dataset=[];this.assignments=[];this.centroids=[];this.init(e,k,d)}c.prototype.init=function(e,k,d){this.assignments=
[];this.centroids=[];void 0!==e&&(this.dataset=e);void 0!==k&&(this.k=k);void 0!==d&&(this.distance=d)};c.prototype.run=function(e,k){this.init(e,k);e=this.dataset.length;for(k=0;k<this.k;k++)this.centroids[k]=this.randomCentroid();for(k=!0;k;){k=this.assign();for(var d=0;d<this.k;d++){for(var f=Array(q),l=0,h=0;h<q;h++)f[h]=0;for(var m=0;m<e;m++){var q=this.dataset[m].length;if(d===this.assignments[m]){for(h=0;h<q;h++)f[h]+=this.dataset[m][h];l++}}if(0<l){for(h=0;h<q;h++)f[h]/=l;this.centroids[d]=
f}else this.centroids[d]=this.randomCentroid(),k=!0}}return this.getClusters()};c.prototype.randomCentroid=function(){var e=this.dataset.length-1;do{var k=Math.round(Math.random()*e);k=this.dataset[k]}while(0<=this.centroids.indexOf(k));return k};c.prototype.assign=function(){for(var e,k=!1,d=this.dataset.length,f=0;f<d;f++)(e=this.argmin(this.dataset[f],this.centroids,this.distance))!=this.assignments[f]&&(this.assignments[f]=e,k=!0);return k};c.prototype.getClusters=function(){for(var e,k=Array(this.k),
d=0;d<this.assignments.length;d++)void 0===k[e=this.assignments[d]]&&(k[e]=[]),k[e].push(d);return k};c.prototype.argmin=function(e,k,d){for(var f,l=Number.MAX_VALUE,h=0,m=k.length,q=0;q<m;q++)(f=d(e,k[q]))<l&&(l=f,h=q);return h};c.prototype.distance=function(e,k){for(var d=0,f=Math.min(e.length,k.length);f--;){var l=e[f]-k[f];d+=l*l}return Math.sqrt(d)};b.exports&&(b.exports=c)}),Um=ie(function(b){function c(e,k,d){this._queue=[];this._priorities=[];this._sorting="desc";this._init(e,k,d)}c.prototype.insert=
function(e,k){for(var d=this._queue.length,f=d;f--;){var l=this._priorities[f];"desc"===this._sorting?k>l&&(d=f):k<l&&(d=f)}this._insertAt(e,k,d)};c.prototype.remove=function(e){for(var k=this._queue.length;k--;)if(e===this._queue[k]){this._queue.splice(k,1);this._priorities.splice(k,1);break}};c.prototype.forEach=function(e){this._queue.forEach(e)};c.prototype.getElements=function(){return this._queue};c.prototype.getElementPriority=function(e){return this._priorities[e]};c.prototype.getPriorities=
function(){return this._priorities};c.prototype.getElementsWithPriorities=function(){for(var e=[],k=0,d=this._queue.length;k<d;k++)e.push([this._queue[k],this._priorities[k]]);return e};c.prototype._init=function(e,k,d){if(e&&k){if(this._queue=[],this._priorities=[],e.length!==k.length)throw Error("Arrays must have the same length");for(var f=0;f<e.length;f++)this.insert(e[f],k[f])}d&&(this._sorting=d)};c.prototype._insertAt=function(e,k,d){this._queue.length===d?(this._queue.push(e),this._priorities.push(k)):
(this._queue.splice(d,0,e),this._priorities.splice(d,0,k))};b.exports&&(b.exports=c)}),dp=ie(function(b){function c(k,d,f,l){this.minPts=this.epsilon=1;this.distance=this._euclideanDistance;this._reachability=[];this._processed=[];this._coreDistance=0;this._orderedList=[];this._init(k,d,f,l)}if(b.exports)var e=Um;c.prototype.run=function(k,d,f,l){this._init(k,d,f,l);k=0;for(d=this.dataset.length;k<d;k++)if(1!==this._processed[k]){this._processed[k]=1;this.clusters.push([k]);f=this.clusters.length-
1;this._orderedList.push(k);l=new e(null,null,"asc");var h=this._regionQuery(k);void 0!==this._distanceToCore(k)&&(this._updateQueue(k,h,l),this._expandCluster(f,l))}return this.clusters};c.prototype.getReachabilityPlot=function(){for(var k=[],d=0,f=this._orderedList.length;d<f;d++){var l=this._orderedList[d];k.push([l,this._reachability[l]])}return k};c.prototype._init=function(k,d,f,l){if(k){if(!(k instanceof Array))throw Error("Dataset must be of type array, "+typeof k+" given");this.dataset=k;
this.clusters=[];this._reachability=Array(this.dataset.length);this._processed=Array(this.dataset.length);this._coreDistance=0;this._orderedList=[]}d&&(this.epsilon=d);f&&(this.minPts=f);l&&(this.distance=l)};c.prototype._updateQueue=function(k,d,f){var l=this;this._coreDistance=this._distanceToCore(k);d.forEach(function(h){if(void 0===l._processed[h]){var m=l.distance(l.dataset[k],l.dataset[h]);m=Math.max(l._coreDistance,m);void 0===l._reachability[h]?(l._reachability[h]=m,f.insert(h,m)):m<l._reachability[h]&&
(l._reachability[h]=m,f.remove(h),f.insert(h,m))}})};c.prototype._expandCluster=function(k,d){for(var f=d.getElements(),l=0,h=f.length;l<h;l++){var m=f[l];if(void 0===this._processed[m]){var q=this._regionQuery(m);this._processed[m]=1;this.clusters[k].push(m);this._orderedList.push(m);void 0!==this._distanceToCore(m)&&(this._updateQueue(m,q,d),this._expandCluster(k,d))}}};c.prototype._distanceToCore=function(k){for(var d=this.epsilon,f=0;f<d;f++)if(this._regionQuery(k,f).length>=this.minPts)return f};
c.prototype._regionQuery=function(k,d){d=d||this.epsilon;for(var f=[],l=0,h=this.dataset.length;l<h;l++)this.distance(this.dataset[k],this.dataset[l])<d&&f.push(l);return f};c.prototype._euclideanDistance=function(k,d){for(var f=0,l=Math.min(k.length,d.length);l--;)f+=(k[l]-d[l])*(k[l]-d[l]);return Math.sqrt(f)};b.exports&&(b.exports=c)}),ep=ie(function(b){b.exports&&(b.exports={DBSCAN:bp,KMEANS:cp,OPTICS:dp,PriorityQueue:Um})}),Vm=function(b,c,e){for(var k=b.length,d=0,f=0;f<k;f++){var l=(b[f]||
0)-(c[f]||0);d+=l*l}return e?Math.sqrt(d):d},fp=function(b,c,e){b=Math.abs(b-c);return e?b:b*b},gp=function(b,c){var e=b[0].length?Vm:fp,k=[],d=b.length,f=b[Math.floor(Math.random()*d)];0<b[0].length&&f.join("_");for(k.push(f);k.length<c;){var l=[],h=k.length,m=0;f=[];for(var q=0;q<d;q++){for(var n=1/0,r=0;r<h;r++){var v=e(b[q],k[r]);v<=n&&(n=v)}l[q]=n}for(h=0;h<d;h++)m+=l[h];for(h=0;h<d;h++)f[h]={i:h,v:b[h],pr:l[h]/m,cs:0};f.sort(function(z,u){return z.pr-u.pr});f[0].cs=f[0].pr;for(l=1;l<d;l++)f[l].cs=
f[l-1].cs+f[l].pr;l=Math.random();for(m=0;m<d-1&&f[m++].cs<l;);k.push(f[m-1].v)}return k},hp=function(b,c,e,k){var d=[],f=[],l=[];k=k||1E4;var h=b.length,m=b[0].length,q=0<m,n=[];if(e)if("kmrand"==e){d={};e=[];var r=c<<2;var v=b.length;for(var z=0<b[0].length;e.length<c&&0<r--;){var u=b[Math.floor(Math.random()*v)],y=z?u.join("_"):""+u;d[y]||(d[y]=!0,e.push(u))}if(e.length<c)throw Error("Error initializating clusters");d=e}else d="kmpp"==e?gp(b,c):e;else for(e={};d.length<c;)r=Math.floor(Math.random()*
h),e[r]||(e[r]=!0,d.push(b[r]));do{yl(c,0,n);for(e=0;e<h;e++){r=1/0;for(z=v=0;z<c;z++)(l=q?Vm(b[e],d[z]):Math.abs(b[e]-d[z]))<=r&&(r=l,v=z);f[e]=v;n[v]++}r=[];for(v=(e=[],0);v<c;v++)r[v]=q?yl(m,0,r[v]):0,e[v]=d[v];if(q){for(v=0;v<c;v++)d[v]=[];for(v=0;v<h;v++)for(z=r[f[v]],u=b[v],y=0;y<m;y++)z[y]+=u[y];v=!0;for(z=0;z<c;z++){u=d[z];var C=r[z];y=e[z];for(var w=n[z],x=0;x<m;x++)u[x]=C[x]/w||0;if(v)for(C=0;C<m;C++)if(y[C]!=u[C]){v=!1;break}}}else{for(v=0;v<h;v++)r[f[v]]+=b[v];for(v=0;v<c;v++)d[v]=r[v]/
n[v]||0;v=!0;for(r=0;r<c;r++)if(e[r]!=d[r]){v=!1;break}}v=v||0>=--k}while(!v);return{it:1E4-k,k:c,idxs:f,centroids:d}},Vh={search:function(b,c,e,k){b.cleanDirty();var d=(k=k||{}).heuristic||Vh.heuristics.manhattan;k=k.closest||!1;var f=new Bl(function(z){return z.f}),l=c;c.h=d(c,e);for(f.push(c);0<f.size();){c=f.pop();if(c===e)return Al(c);c.closed=!0;for(var h=b.neighbors(c),m=0,q=h.length;m<q;++m){var n=h[m];if(!n.closed&&!n.isWall()){var r=c.g+n.getCost(c),v=n.visited;(!v||r<n.g)&&(n.visited=!0,
n.parent=c,n.h=n.h||d(n,e),n.g=r,n.f=n.g+n.h,b.markDirty(n),k&&(n.h<l.h||n.h===l.h&&n.g<l.g)&&(l=n),v?f.rescoreElement(n):f.push(n))}}}return k?Al(l):[]},heuristics:{manhattan:function(b,c){return Math.abs(c.x-b.x)+Math.abs(c.y-b.y)},diagonal:function(b,c){var e=Math.abs(c.x-b.x);b=Math.abs(c.y-b.y);return 1*(e+b)+(Math.sqrt(2)-2)*Math.min(e,b)}},cleanNode:function(b){b.f=0;b.g=0;b.h=0;b.visited=!1;b.closed=!1;b.parent=null}};If.prototype.init=function(){this.dirtyNodes=[];for(var b=0;b<this.nodes.length;b++)Vh.cleanNode(this.nodes[b])};
If.prototype.cleanDirty=function(){for(var b=0;b<this.dirtyNodes.length;b++)Vh.cleanNode(this.dirtyNodes[b]);this.dirtyNodes=[]};If.prototype.markDirty=function(b){this.dirtyNodes.push(b)};If.prototype.neighbors=function(b){var c=[],e=b.x;b=b.y;var k=this.grid;return k[e-1]&&k[e-1][b]&&c.push(k[e-1][b]),k[e+1]&&k[e+1][b]&&c.push(k[e+1][b]),k[e]&&k[e][b-1]&&c.push(k[e][b-1]),k[e]&&k[e][b+1]&&c.push(k[e][b+1]),this.diagonal&&(k[e-1]&&k[e-1][b-1]&&c.push(k[e-1][b-1]),k[e+1]&&k[e+1][b-1]&&c.push(k[e+
1][b-1]),k[e-1]&&k[e-1][b+1]&&c.push(k[e-1][b+1]),k[e+1]&&k[e+1][b+1]&&c.push(k[e+1][b+1])),c};If.prototype.toString=function(){for(var b,c,e,k,d=[],f=this.grid,l=0,h=f.length;l<h;l++){b=[];e=0;for(k=(c=f[l]).length;e<k;e++)b.push(c[e].weight);d.push(b.join(" "))}return d.join("\n")};Gh.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};Gh.prototype.getCost=function(b){return b&&b.x!==this.x&&b.y!==this.y?1.41421*this.weight:this.weight};Gh.prototype.isWall=function(){return 0===this.weight};
Bl.prototype={push:function(b){this.content.push(b);this.sinkDown(this.content.length-1)},pop:function(){var b=this.content[0],c=this.content.pop();return 0<this.content.length&&(this.content[0]=c,this.bubbleUp(0)),b},remove:function(b){var c=this.content.indexOf(b),e=this.content.pop();c!==this.content.length-1&&(this.content[c]=e,this.scoreFunction(e)<this.scoreFunction(b)?this.sinkDown(c):this.bubbleUp(c))},size:function(){return this.content.length},rescoreElement:function(b){this.sinkDown(this.content.indexOf(b))},
sinkDown:function(b){for(var c=this.content[b];0<b;){var e=(b+1>>1)-1,k=this.content[e];if(!(this.scoreFunction(c)<this.scoreFunction(k)))break;this.content[e]=c;this.content[b]=k;b=e}},bubbleUp:function(b){for(var c=this.content.length,e=this.content[b],k=this.scoreFunction(e);;){var d,f=b+1<<1,l=f-1,h=null;l<c&&(d=this.scoreFunction(this.content[l]))<k&&(h=l);f<c&&this.scoreFunction(this.content[f])<(null===h?k:d)&&(h=f);if(null===h)break;this.content[b]=this.content[h];this.content[h]=e;b=h}}};
Hh.prototype={constructor:Hh,insert:function(b,c){var e,k;if(b){if(c.P=b,c.N=b.N,b.N&&(b.N.P=c),b.N=c,b.R){for(b=b.R;b.L;)b=b.L;b.L=c}else b.R=c;var d=b}else this._?(b=Dl(this._),c.P=null,c.N=b,b.P=b.L=c,d=b):(c.P=c.N=null,this._=c,d=null);c.L=c.R=null;c.U=d;c.C=!0;for(b=c;d&&d.C;)d===(e=d.U).L?(k=e.R)&&k.C?(d.C=k.C=!1,e.C=!0,b=e):(b===d.R&&(Bg(this,d),d=(b=d).U),d.C=!1,e.C=!0,Cg(this,e)):(k=e.L)&&k.C?(d.C=k.C=!1,e.C=!0,b=e):(b===d.L&&(Cg(this,d),d=(b=d).U),d.C=!1,e.C=!0,Bg(this,e)),d=b.U;this._.C=
!1},remove:function(b){b.N&&(b.N.P=b.P);b.P&&(b.P.N=b.N);b.N=b.P=null;var c,e,k,d=b.U,f=b.L,l=b.R;if(e=f?l?Dl(l):f:l,d?d.L===b?d.L=e:d.R=e:this._=e,f&&l?(k=e.C,e.C=b.C,e.L=f,f.U=e,e!==l?(d=e.U,e.U=b.U,b=e.R,d.L=b,e.R=l,l.U=e):(e.U=d,d=e,b=e.R)):(k=b.C,b=e),b&&(b.U=d),!k)if(b&&b.C)b.C=!1;else{do{if(b===this._)break;if(b===d.L){if((c=d.R).C&&(c.C=!1,d.C=!0,Bg(this,d),c=d.R),c.L&&c.L.C||c.R&&c.R.C){c.R&&c.R.C||(c.L.C=!1,c.C=!0,Cg(this,c),c=d.R);c.C=d.C;d.C=c.R.C=!1;Bg(this,d);b=this._;break}}else if((c=
d.L).C&&(c.C=!1,d.C=!0,Cg(this,d),c=d.L),c.L&&c.L.C||c.R&&c.R.C){c.L&&c.L.C||(c.R.C=!1,c.C=!0,Bg(this,c),c=d.L);c.C=d.C;d.C=c.L.C=!1;Cg(this,d);b=this._;break}c.C=!0;b=d;d=d.U}while(!b.C);b&&(b.C=!1)}}};var Wi,Fl=[],Hl=[],Lf,qd,Fg,Vc,Wb=1E-6,uo=1E-12;Yi.prototype={constructor:Yi,polygons:function(){var b=this.edges;return this.cells.map(function(c){var e=c.halfedges.map(function(k){return El(c,b[k])});return e.data=c.site.data,e})},triangles:function(){var b=[],c=this.edges;return this.cells.forEach(function(e,
k){if(f=(d=e.halfedges).length)for(var d,f,l,h,m,q=e.site,n=-1,r=c[d[f-1]],v=r.left===q?r.right:r.left;++n<f;)e=v,v=(r=c[d[n]]).left===q?r.right:r.left,e&&v&&k<e.index&&k<v.index&&(h=e,m=v,0>((l=q)[0]-m[0])*(h[1]-l[1])-(l[0]-h[0])*(m[1]-l[1]))&&b.push([q.data,e.data,v.data])}),b},links:function(){return this.edges.filter(function(b){return b.right}).map(function(b){return{source:b.left.data,target:b.right.data}})},find:function(b,c,e){var k,d,f=this,l=f._found||0;for(k=f.cells.length;!(d=f.cells[l]);)if(++l>=
k)return null;k=b-d.site[0];var h=c-d.site[1],m=k*k+h*h;do d=f.cells[k=l],l=null,d.halfedges.forEach(function(q){var n=f.edges[q];q=n.left;if(q!==d.site&&q||(q=n.right)){n=b-q[0];var r=c-q[1];n=n*n+r*r;n<m&&(m=n,l=q.index)}});while(null!==l);return f._found=k,null==e||m<=e*e?d.site:null}};var ip=Object.freeze({__proto__:null,toMercator:Ol,toWgs84:Ql}),Do=function(){for(var b=0,c=0,e=arguments.length;c<e;c++)b+=arguments[c].length;b=Array(b);var k=0;for(c=0;c<e;c++)for(var d=arguments[c],f=0,l=d.length;f<
l;f++,k++)b[k]=d[f];return b},jp=Object.freeze({__proto__:null,randomPosition:Gg,randomPoint:Ul,randomPolygon:Vl,randomLineString:Wl}),kp=Object.freeze({__proto__:null,getCluster:Xl,clusterEach:$i,clusterReduce:Yl,createBins:aj,applyFilter:Kh,propertiesContainsFilter:bj,filterProperties:Zl}),Pe=function(b,c){this.next=null;this.key=b;this.data=c;this.right=this.left=null},Cj=function(){function b(c){void 0===c&&(c=Eo);this._root=null;this._size=0;this._comparator=c}return b.prototype.insert=function(c,
e){return this._size++,this._root=cj(c,e,this._root,this._comparator)},b.prototype.add=function(c,e){e=new Pe(c,e);null===this._root&&(e.left=e.right=null,this._size++,this._root=e);var k=this._comparator,d=Oe(c,this._root,k);c=k(c,d.key);return 0===c?this._root=d:(0>c?(e.left=d.left,e.right=d,d.left=null):0<c&&(e.right=d.right,e.left=d,d.right=null),this._size++,this._root=e),this._root},b.prototype.remove=function(c){this._root=this._remove(c,this._root,this._comparator)},b.prototype._remove=function(c,
e,k){var d;return null===e?null:0===k(c,(e=Oe(c,e,k)).key)?(null===e.left?d=e.right:(d=Oe(c,e.left,k)).right=e.right,this._size--,d):e},b.prototype.pop=function(){var c=this._root;if(c){for(;c.left;)c=c.left;return this._root=Oe(c.key,this._root,this._comparator),this._root=this._remove(c.key,this._root,this._comparator),{key:c.key,data:c.data}}return null},b.prototype.findStatic=function(c){for(var e=this._root,k=this._comparator;e;){var d=k(c,e.key);if(0===d)return e;e=0>d?e.left:e.right}return null},
b.prototype.find=function(c){return this._root&&(this._root=Oe(c,this._root,this._comparator),0!==this._comparator(c,this._root.key))?null:this._root},b.prototype.contains=function(c){for(var e=this._root,k=this._comparator;e;){var d=k(c,e.key);if(0===d)return!0;e=0>d?e.left:e.right}return!1},b.prototype.forEach=function(c,e){for(var k=this._root,d=[],f=!1;!f;)null!==k?(d.push(k),k=k.left):0!==d.length?(k=d.pop(),c.call(e,k),k=k.right):f=!0;return this},b.prototype.range=function(c,e,k,d){for(var f=
[],l=this._comparator,h=this._root;0!==f.length||h;)if(h)f.push(h),h=h.left;else{if(0<l((h=f.pop()).key,e))break;if(0<=l(h.key,c)&&k.call(d,h))break;h=h.right}return this},b.prototype.keys=function(){var c=[];return this.forEach(function(e){return c.push(e.key)}),c},b.prototype.values=function(){var c=[];return this.forEach(function(e){return c.push(e.data)}),c},b.prototype.min=function(){return this._root?this.minNode(this._root).key:null},b.prototype.max=function(){return this._root?this.maxNode(this._root).key:
null},b.prototype.minNode=function(c){if(void 0===c&&(c=this._root),c)for(;c.left;)c=c.left;return c},b.prototype.maxNode=function(c){if(void 0===c&&(c=this._root),c)for(;c.right;)c=c.right;return c},b.prototype.at=function(c){for(var e=this._root,k=!1,d=0,f=[];!k;)if(e)f.push(e),e=e.left;else if(0<f.length){if(e=f.pop(),d===c)return e;d++;e=e.right}else k=!0;return null},b.prototype.next=function(c){var e=this._root,k=null;if(c.right){for(k=c.right;k.left;)k=k.left;return k}for(var d=this._comparator;e;){var f=
d(c.key,e.key);if(0===f)break;0>f?(k=e,e=e.left):e=e.right}return k},b.prototype.prev=function(c){var e=this._root,k=null;if(null!==c.left){for(k=c.left;k.right;)k=k.right;return k}for(var d=this._comparator;e;){var f=d(c.key,e.key);if(0===f)break;0>f?e=e.left:(k=e,e=e.right)}return k},b.prototype.clear=function(){return this._root=null,this._size=0,this},b.prototype.toList=function(){for(var c=this._root,e=[],k=!1,d=new Pe(null,null),f=d;!k;)c?(e.push(c),c=c.left):0<e.length?c=(c=f=f.next=e.pop()).right:
k=!0;return f.next=null,d.next},b.prototype.load=function(c,e,k){void 0===e&&(e=[]);void 0===k&&(k=!1);var d=c.length,f=this._comparator;(k&&gj(c,e,0,d-1,f),null===this._root)?(this._root=ej(c,e,0,d),this._size=d):(c=function(l,h,m){for(var q=new Pe(null,null),n=q;null!==l&&null!==h;)0>m(l.key,h.key)?(n.next=l,l=l.next):(n.next=h,h=h.next),n=n.next;null!==l?n.next=l:null!==h&&(n.next=h);return q.next}(this.toList(),function(l,h){for(var m=new Pe(null,null),q=m,n=0;n<l.length;n++)q=q.next=new Pe(l[n],
h[n]);return q.next=null,m.next}(c,e),f),d=this._size+d,this._root=fj({head:c},0,d));return this},b.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(b.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),b.prototype.toString=function(c){void 0===c&&(c=function(k){return String(k.key)});var e=[];return dj(this._root,"",!0,function(k){return e.push(k)},
c),e.join("")},b.prototype.update=function(c,e,k){var d=this._comparator,f=$l(c,this._root,d),l=f.left;f=f.right;0>d(c,e)?f=cj(e,k,f,d):l=cj(e,k,l,d);c=l;e=f;this._root=null===e?c:(null===c||((e=Oe(c.key,e,d)).left=c),e)},b.prototype.split=function(c){return $l(c,this._root,this._comparator)},b}(),Mg=function(b,c){return b.ll.x<=c.x&&c.x<=b.ur.x&&b.ll.y<=c.y&&c.y<=b.ur.y},Dj=function(b,c){return c.ur.x<b.ll.x||b.ur.x<c.ll.x||c.ur.y<b.ll.y||b.ur.y<c.ll.y?null:{ll:{x:b.ll.x<c.ll.x?c.ll.x:b.ll.x,y:b.ll.y<
c.ll.y?c.ll.y:b.ll.y},ur:{x:b.ur.x<c.ur.x?b.ur.x:c.ur.x,y:b.ur.y<c.ur.y?b.ur.y:c.ur.y}}},Se=Number.EPSILON;void 0===Se&&(Se=Math.pow(2,-52));var lp=Se*Se,Ej=function(b,c){if(-Se<b&&b<Se&&-Se<c&&c<Se)return 0;var e=b-c;return e*e<lp*b*c?0:b<c?-1:1},mp=function(){function b(){yd(this,b);this.reset()}return bd(b,[{key:"reset",value:function(){this.xRounder=new Wm;this.yRounder=new Wm}},{key:"round",value:function(c,e){return{x:this.xRounder.round(c),y:this.yRounder.round(e)}}}]),b}(),Wm=function(){function b(){yd(this,
b);this.tree=new Cj;this.round(0)}return bd(b,[{key:"round",value:function(c){var e=this.tree.add(c),k=this.tree.prev(e);if(null!==k&&0===Ej(e.key,k.key))return this.tree.remove(c),k.key;k=this.tree.next(e);return null!==k&&0===Ej(e.key,k.key)?(this.tree.remove(c),k.key):c}}]),b}(),Ng=new mp,Og=function(b,c){return b.x*c.y-b.y*c.x},Pg=function(b,c){return b.x*c.x+b.y*c.y},Xm=function(b,c,e){b=Og({x:c.x-b.x,y:c.y-b.y},{x:e.x-b.x,y:e.y-b.y});return Ej(b,0)},Ym=function(b,c,e){return 0===c.y?null:{x:b.x+
c.x/c.y*(e-b.y),y:e}},Zm=function(b,c,e){return 0===c.x?null:{x:e,y:b.y+c.y/c.x*(e-b.x)}},oe=function(){function b(c,e){yd(this,b);void 0===c.events?c.events=[this]:c.events.push(this);this.point=c;this.isLeft=e}return bd(b,null,[{key:"compare",value:function(c,e){var k=b.comparePoints(c.point,e.point);return 0!==k?k:(c.point!==e.point&&c.link(e),c.isLeft!==e.isLeft?c.isLeft?1:-1:Wh.compare(c.segment,e.segment))}},{key:"comparePoints",value:function(c,e){return c.x<e.x?-1:c.x>e.x?1:c.y<e.y?-1:c.y>
e.y?1:0}}]),bd(b,[{key:"link",value:function(c){if(c.point===this.point)throw Error("Tried to link already linked events");c=c.point.events;for(var e=0,k=c.length;e<k;e++){var d=c[e];this.point.events.push(d);d.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var c=this.point.events.length,e=0;e<c;e++){var k=this.point.events[e];if(void 0===k.segment.consumedBy)for(var d=e+1;d<c;d++){var f=this.point.events[d];void 0===f.consumedBy&&k.otherSE.point.events===
f.otherSE.point.events&&k.segment.consume(f.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var c=[],e=0,k=this.point.events.length;e<k;e++){var d=this.point.events[e];d!==this&&!d.segment.ringOut&&d.segment.isInResult()&&c.push(d)}return c}},{key:"getLeftmostComparator",value:function(c){var e=this,k=new Map,d=function(f){var l,h,m,q,n,r=f.otherSE,v=k.set,z=(l=e.point,h=c.point,m=r.point,q={x:h.x-l.x,y:h.y-l.y},n={x:m.x-l.x,y:m.y-l.y},Og(n,q)/Math.sqrt(Pg(n,n))/Math.sqrt(Pg(q,q)));
l=e.point;h=c.point;r=r.point;h={x:h.x-l.x,y:h.y-l.y};r={x:r.x-l.x,y:r.y-l.y};r=Pg(r,h)/Math.sqrt(Pg(r,r))/Math.sqrt(Pg(h,h));v.call(k,f,{sine:z,cosine:r})};return function(f,l){k.has(f)||d(f);k.has(l)||d(l);var h=k.get(f);f=h.sine;h=h.cosine;var m=k.get(l);l=m.sine;m=m.cosine;return 0<=f&&0<=l?h<m?1:h>m?-1:0:0>f&&0>l?h<m?-1:h>m?1:0:l<f?-1:l>f?1:0}}}]),b}(),np=0,Wh=function(){function b(c,e,k,d){yd(this,b);this.id=++np;this.leftSE=c;c.segment=this;this.rightSE=c.otherSE=e;e.segment=this;e.otherSE=
c;this.rings=k;this.windings=d}return bd(b,null,[{key:"compare",value:function(c,e){var k=c.leftSE.point.x,d=e.leftSE.point.x,f=c.rightSE.point.x,l=e.rightSE.point.x;if(l<k)return 1;if(f<d)return-1;var h=c.leftSE.point.y,m=e.leftSE.point.y,q=c.rightSE.point.y,n=e.rightSE.point.y;if(k<d){if(m<h&&m<q)return 1;if(m>h&&m>q)return-1;f=c.comparePoint(e.leftSE.point);if(0>f)return 1;if(0<f)return-1;c=e.comparePoint(c.rightSE.point);return 0!==c?c:-1}if(k>d){if(h<m&&h<n)return-1;if(h>m&&h>n)return 1;f=e.comparePoint(c.leftSE.point);
if(0!==f)return f;c=c.comparePoint(e.rightSE.point);return 0>c?1:0<c?-1:1}if(h<m)return-1;if(h>m)return 1;if(f<l){var r=e.comparePoint(c.rightSE.point);if(0!==r)return r}if(f>l){r=c.comparePoint(e.rightSE.point);if(0>r)return 1;if(0<r)return-1}if(f!==l){h=q-h;k=f-k;m=n-m;d=l-d;if(h>k&&m<d)return 1;if(h<k&&m>d)return-1}return f>l?1:f<l||q<n?-1:q>n?1:c.id<e.id?-1:c.id>e.id?1:0}}]),bd(b,[{key:"replaceRightSE",value:function(c){this.rightSE=c;this.rightSE.segment=this;this.rightSE.otherSE=this.leftSE;
this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var c=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:c<e?c:e},ur:{x:this.rightSE.point.x,y:c>e?c:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(c){return c.x===this.leftSE.point.x&&c.y===this.leftSE.point.y||c.x===this.rightSE.point.x&&c.y===this.rightSE.point.y}},{key:"comparePoint",
value:function(c){if(this.isAnEndpoint(c))return 0;var e=this.leftSE.point,k=this.rightSE.point,d=this.vector();if(e.x===k.x)return c.x===e.x?0:c.x<e.x?1:-1;if(c.x===e.x+(c.y-e.y)/d.y*d.x)return 0;e=e.y+(c.x-e.x)/d.x*d.y;return c.y===e?0:c.y<e?-1:1}},{key:"getIntersection",value:function(c){var e=this.bbox(),k=c.bbox(),d=Dj(e,k);if(null===d)return null;var f=this.leftSE.point,l=this.rightSE.point,h=c.leftSE.point,m=c.rightSE.point,q=Mg(e,h)&&0===this.comparePoint(h),n=Mg(k,f)&&0===c.comparePoint(f);
e=Mg(e,m)&&0===this.comparePoint(m);k=Mg(k,l)&&0===c.comparePoint(l);if(n&&q)return k&&!e?l:!k&&e?m:null;if(n)return e&&f.x===m.x&&f.y===m.y?null:f;if(q)return k&&l.x===h.x&&l.y===h.y?null:h;if(k&&e)return null;if(k)return l;if(e)return m;c=function(r,v,z,u){if(0===v.x)return Zm(z,u,r.x);if(0===u.x)return Zm(r,v,z.x);if(0===v.y)return Ym(z,u,r.y);if(0===u.y)return Ym(r,v,z.y);var y=Og(v,u);if(0==y)return null;var C={x:z.x-r.x,y:z.y-r.y},w=Og(C,v)/y;y=Og(C,u)/y;return{x:(r.x+y*v.x+(z.x+w*u.x))/2,y:(r.y+
y*v.y+(z.y+w*u.y))/2}}(f,this.vector(),h,c.vector());return null===c?null:Mg(d,c)?Ng.round(c.x,c.y):null}},{key:"split",value:function(c){var e=[],k=void 0!==c.events,d=new oe(c,!0);c=new oe(c,!1);var f=this.rightSE;this.replaceRightSE(c);e.push(c);e.push(d);f=new b(d,f,this.rings.slice(),this.windings.slice());return 0<oe.comparePoints(f.leftSE.point,f.rightSE.point)&&f.swapEvents(),0<oe.comparePoints(this.leftSE.point,this.rightSE.point)&&this.swapEvents(),k&&(d.checkForConsuming(),c.checkForConsuming()),
e}},{key:"swapEvents",value:function(){var c=this.rightSE;this.rightSE=this.leftSE;this.leftSE=c;this.leftSE.isLeft=!0;this.rightSE.isLeft=!1;c=0;for(var e=this.windings.length;c<e;c++)this.windings[c]*=-1}},{key:"consume",value:function(c){for(var e=this;e.consumedBy;)e=e.consumedBy;for(;c.consumedBy;)c=c.consumedBy;var k=b.compare(e,c);if(0!==k){0<k&&(k=e,e=c,c=k);e.prev===c&&(k=e,e=c,c=k);k=0;for(var d=c.rings.length;k<d;k++){var f=c.rings[k],l=c.windings[k],h=e.rings.indexOf(f);-1===h?(e.rings.push(f),
e.windings.push(l)):e.windings[h]+=l}c.rings=null;c.windings=null;c.consumedBy=e;c.leftSE.consumedBy=e.leftSE;c.rightSE.consumedBy=e.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState?this._beforeState:this._beforeState=this.prev?(this.prev.consumedBy||
this.prev).afterState():{rings:[],windings:[],multiPolys:[]}}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var c=this.beforeState();this._afterState={rings:c.rings.slice(0),windings:c.windings.slice(0),multiPolys:[]};var e=this._afterState.rings,k=this._afterState.windings;c=this._afterState.multiPolys;for(var d=0,f=this.rings.length;d<f;d++){var l=this.rings[d],h=this.windings[d],m=e.indexOf(l);-1===m?(e.push(l),k.push(h)):k[m]+=h}d=[];f=[];l=0;for(h=e.length;l<
h;l++)if(0!==k[l]){m=e[l];var q=m.poly;-1===f.indexOf(q)&&(m.isExterior?d.push(q):(-1===f.indexOf(q)&&f.push(q),m=d.indexOf(m.poly),-1!==m&&d.splice(m,1)))}e=0;for(k=d.length;e<k;e++)f=d[e].multiPoly,-1===c.indexOf(f)&&c.push(f);return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var c=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Ud.type){case "union":this._isInResult=0===c.length!==(0===
e.length);break;case "intersection":var k,d;c.length<e.length?(k=c.length,d=e.length):(k=e.length,d=c.length);this._isInResult=d===Ud.numMultiPolys&&k<d;break;case "xor":this._isInResult=1==Math.abs(c.length-e.length)%2;break;case "difference":this._isInResult=(1===c.length&&c[0].isSubject)!==(1===e.length&&e[0].isSubject);break;default:throw Error("Unrecognized operation type found ".concat(Ud.type));}return this._isInResult}}],[{key:"fromRing",value:function(c,e,k){var d=oe.comparePoints(c,e);if(0>
d)d=c,c=e,e=1;else{if(!(0<d))throw Error("Tried to create degenerate segment at [".concat(c.x,", ").concat(c.y,"]"));d=e;e=-1}return new b(new oe(d,!0),new oe(c,!1),[k],[e])}}]),b}(),$m=function(){function b(c,e,k){if(yd(this,b),!Array.isArray(c)||0===c.length)throw Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=k,this.segments=[],"number"!=typeof c[0][0]||"number"!=typeof c[0][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");e=
Ng.round(c[0][0],c[0][1]);this.bbox={ll:{x:e.x,y:e.y},ur:{x:e.x,y:e.y}};k=e;for(var d=1,f=c.length;d<f;d++){if("number"!=typeof c[d][0]||"number"!=typeof c[d][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");var l=Ng.round(c[d][0],c[d][1]);l.x===k.x&&l.y===k.y||(this.segments.push(Wh.fromRing(k,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),k=l)}e.x===
k.x&&e.y===k.y||this.segments.push(Wh.fromRing(k,e,this))}return bd(b,[{key:"getSweepEvents",value:function(){for(var c=[],e=0,k=this.segments.length;e<k;e++){var d=this.segments[e];c.push(d.leftSE);c.push(d.rightSE)}return c}}]),b}(),op=function(){function b(c,e){if(yd(this,b),!Array.isArray(c))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new $m(c[0],this,!0);this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,
y:this.exteriorRing.bbox.ur.y}};this.interiorRings=[];for(var k=1,d=c.length;k<d;k++){var f=new $m(c[k],this,!1);f.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=f.bbox.ll.x);f.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=f.bbox.ll.y);f.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=f.bbox.ur.x);f.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=f.bbox.ur.y);this.interiorRings.push(f)}this.multiPoly=e}return bd(b,[{key:"getSweepEvents",value:function(){for(var c=this.exteriorRing.getSweepEvents(),e=0,k=this.interiorRings.length;e<
k;e++)for(var d=this.interiorRings[e].getSweepEvents(),f=0,l=d.length;f<l;f++)c.push(d[f]);return c}}]),b}(),an=function(){function b(c,e){if(yd(this,b),!Array.isArray(c))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof c[0][0][0]&&(c=[c])}catch(l){}this.polys=[];this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var k=0,d=c.length;k<d;k++){var f=new op(c[k],this);f.bbox.ll.x<
this.bbox.ll.x&&(this.bbox.ll.x=f.bbox.ll.x);f.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=f.bbox.ll.y);f.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=f.bbox.ur.x);f.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=f.bbox.ur.y);this.polys.push(f)}this.isSubject=e}return bd(b,[{key:"getSweepEvents",value:function(){for(var c=[],e=0,k=this.polys.length;e<k;e++)for(var d=this.polys[e].getSweepEvents(),f=0,l=d.length;f<l;f++)c.push(d[f]);return c}}]),b}(),pp=function(){function b(c){yd(this,b);this.events=c;for(var e=
0,k=c.length;e<k;e++)c[e].segment.ringOut=this;this.poly=null}return bd(b,null,[{key:"factory",value:function(c){for(var e=[],k=0,d=c.length;k<d;k++){var f=c[k];if(f.isInResult()&&!f.ringOut){var l,h=f.leftSE,m=f.rightSE;f=[h];for(var q=h.point,n=[];l=h,h=m,f.push(h),h.point!==q;)for(;;){m=h.getAvailableLinkedEvents();if(0===m.length)throw c=f[0].point,e=f[f.length-1].point,Error("Unable to complete output ring starting at [".concat(c.x,",")+" ".concat(c.y,"]. Last matching segment found ends at")+
" [".concat(e.x,", ").concat(e.y,"]."));if(1===m.length){m=m[0].otherSE;break}for(var r=null,v=0,z=n.length;v<z;v++)if(n[v].point===h.point){r=v;break}if(null===r){n.push({index:f.length,point:h.point});l=h.getLeftmostComparator(l);m=m.sort(l)[0].otherSE;break}m=n.splice(r)[0];m=f.splice(m.index);m.unshift(m[0].otherSE);e.push(new b(m.reverse()))}e.push(new b(f))}}return e}}]),bd(b,[{key:"getGeom",value:function(){for(var c=this.events[0].point,e=[c],k=1,d=this.events.length-1;k<d;k++){var f=this.events[k].point;
0!==Xm(f,c,this.events[k+1].point)&&(e.push(f),c=f)}if(1===e.length)return null;0===Xm(e[0],c,e[1])&&e.shift();e.push(e[0]);c=this.isExteriorRing()?1:-1;f=this.isExteriorRing()?0:e.length-1;k=this.isExteriorRing()?e.length:-1;for(d=[];f!=k;f+=c)d.push([e[f].x,e[f].y]);return d}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var c=this.enclosingRing();this._isExteriorRing=!c||!c.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===
this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var c=this.events[0],e=1,k=this.events.length;e<k;e++){var d=this.events[e];0<oe.compare(c,d)&&(c=d)}for(e=(c=c.segment.prevInResult())?c.prevInResult():null;;){if(!c)return null;if(!e)return c.ringOut;if(e.ringOut!==c.ringOut)return e.ringOut.enclosingRing()!==c.ringOut?c.ringOut:c.ringOut.enclosingRing();e=(c=e.prevInResult())?c.prevInResult():null}}}]),b}(),
bn=function(){function b(c){yd(this,b);this.exteriorRing=c;c.poly=this;this.interiorRings=[]}return bd(b,[{key:"addInterior",value:function(c){this.interiorRings.push(c);c.poly=this}},{key:"getGeom",value:function(){var c=[this.exteriorRing.getGeom()];if(null===c[0])return null;for(var e=0,k=this.interiorRings.length;e<k;e++){var d=this.interiorRings[e].getGeom();null!==d&&c.push(d)}return c}}]),b}(),qp=function(){function b(c){yd(this,b);this.rings=c;this.polys=this._composePolys(c)}return bd(b,
[{key:"getGeom",value:function(){for(var c=[],e=0,k=this.polys.length;e<k;e++){var d=this.polys[e].getGeom();null!==d&&c.push(d)}return c}},{key:"_composePolys",value:function(c){for(var e=[],k=0,d=c.length;k<d;k++){var f=c[k];if(!f.poly)if(f.isExteriorRing())e.push(new bn(f));else{var l=f.enclosingRing();l.poly||e.push(new bn(l));l.poly.addInterior(f)}}return e}}]),b}(),rp=function(){function b(c){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Wh.compare;yd(this,b);this.queue=c;this.tree=
new Cj(e);this.segments=[]}return bd(b,[{key:"process",value:function(c){var e=c.segment,k=[];if(c.consumedBy)return c.isLeft?this.queue.remove(c.otherSE):this.tree.remove(e),k;var d=c.isLeft?this.tree.insert(e):this.tree.find(e);if(!d)throw Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var f=d,l=d,h=d=void 0;void 0===
d;)null===(f=this.tree.prev(f))?d=null:void 0===f.key.consumedBy&&(d=f.key);for(;void 0===h;)null===(l=this.tree.next(l))?h=null:void 0===l.key.consumedBy&&(h=l.key);if(c.isLeft){f=null;if(d&&(l=d.getIntersection(e),null!==l&&(e.isAnEndpoint(l)||(f=l),!d.isAnEndpoint(l)))){l=this._splitSafely(d,l);for(var m=0,q=l.length;m<q;m++)k.push(l[m])}l=null;if(h&&(m=h.getIntersection(e),null!==m&&(e.isAnEndpoint(m)||(l=m),!h.isAnEndpoint(m))))for(h=this._splitSafely(h,m),m=0,q=h.length;m<q;m++)k.push(h[m]);
if(null!==f||null!==l)for(h=null===f?l:null===l?f:0>=oe.comparePoints(f,l)?f:l,this.queue.remove(e.rightSE),k.push(e.rightSE),h=e.split(h),f=0,l=h.length;f<l;f++)k.push(h[f]);0<k.length?(this.tree.remove(e),k.push(c)):(this.segments.push(e),e.prev=d)}else{if(d&&h&&(c=d.getIntersection(h),null!==c)){if(!d.isAnEndpoint(c))for(d=this._splitSafely(d,c),f=0,l=d.length;f<l;f++)k.push(d[f]);if(!h.isAnEndpoint(c))for(c=this._splitSafely(h,c),d=0,h=c.length;d<h;d++)k.push(c[d])}this.tree.remove(e)}return k}},
{key:"_splitSafely",value:function(c,e){this.tree.remove(c);var k=c.rightSE;this.queue.remove(k);e=c.split(e);return e.push(k),void 0===c.consumedBy&&this.tree.insert(c),e}}]),b}(),cn="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1E6,sp="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1E6,Ud=new (function(){function b(){yd(this,b)}return bd(b,[{key:"run",value:function(c,e,k){Ud.type=c;Ng.reset();c=[new an(e,!0)];e=0;for(var d=k.length;e<
d;e++)c.push(new an(k[e],!1));if(Ud.numMultiPolys=c.length,"difference"===Ud.type)for(k=c[0],e=1;e<c.length;)null!==Dj(c[e].bbox,k.bbox)?e++:c.splice(e,1);if("intersection"===Ud.type)for(k=0,e=c.length;k<e;k++){d=c[k];for(var f=k+1,l=c.length;f<l;f++)if(null===Dj(d.bbox,c[f].bbox))return[]}k=new Cj(oe.compare);e=0;for(d=c.length;e<d;e++){f=c[e].getSweepEvents();l=0;for(var h=f.length;l<h;l++)if(k.insert(f[l]),k.size>cn)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");
}c=new rp(k);e=k.size;for(d=k.pop();d;){d=d.key;if(k.size===e)throw c=d.segment,Error("Unable to pop() ".concat(d.isLeft?"left":"right"," SweepEvent ")+"[".concat(d.point.x,", ").concat(d.point.y,"] from segment #").concat(c.id," ")+"[".concat(c.leftSE.point.x,", ").concat(c.leftSE.point.y,"] -> ")+"[".concat(c.rightSE.point.x,", ").concat(c.rightSE.point.y,"] from queue. ")+"Please file a bug report.");if(k.size>cn)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");
if(c.segments.length>sp)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");e=c.process(d);d=0;for(f=e.length;d<f;d++)l=e[d],void 0===l.consumedBy&&k.insert(l);e=k.size;d=k.pop()}Ng.reset();c=pp.factory(c.segments);return(new qp(c)).getGeom()}}]),b}()),Ce={union:function(b){for(var c=arguments.length,e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("union",b,e)},intersection:function(b){for(var c=arguments.length,
e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("intersection",b,e)},xor:function(b){for(var c=arguments.length,e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("xor",b,e)},difference:function(b){for(var c=arguments.length,e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("difference",b,e)}};"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(b){if(null==this)throw new TypeError(this+" is not an object");
var c=Object(this),e=Math.max(Math.min(c.length,9007199254740991),0)||0,k=1 in arguments&&parseInt(Number(arguments[1]),10)||0;k=0>k?Math.max(e+k,0):Math.min(k,e);var d=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:e;for(d=0>d?Math.max(e+arguments[2],0):Math.min(d,e);k<d;)c[k]=b,++k;return c},writable:!0});Number.isFinite=Number.isFinite||function(b){return"number"==typeof b&&isFinite(b)};Number.isInteger=Number.isInteger||function(b){return"number"==typeof b&&isFinite(b)&&
Math.floor(b)===b};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(b){return b!=b};Math.trunc=Math.trunc||function(b){return 0>b?Math.ceil(b):Math.floor(b)};var nf=function(){};nf.prototype.interfaces_=function(){return[]};nf.prototype.getClass=function(){return nf};nf.prototype.equalsWithTolerance=function(b,c,e){return Math.abs(b-c)<=e};var ac=function(b){function c(e){b.call(this,e);this.name="IllegalArgumentException";this.message=e;this.stack=(new b).stack}
return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c}(Error),Wa=function(){},dn={MAX_VALUE:{configurable:!0}};Wa.isNaN=function(b){return Number.isNaN(b)};Wa.doubleToLongBits=function(b){return b};Wa.longBitsToDouble=function(b){return b};Wa.isInfinite=function(b){return!Number.isFinite(b)};dn.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Wa,dn);var jd=function(){},Xh=function(){},Rf=function(){},sa=function c(){if(this.x=null,
this.y=null,this.z=null,0===arguments.length)this.y=this.x=0,this.z=c.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x;this.y=e.y;this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=c.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},of={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};
sa.prototype.setOrdinate=function(c,e){switch(c){case sa.X:this.x=e;break;case sa.Y:this.y=e;break;case sa.Z:this.z=e;break;default:throw new ac("Invalid ordinate index: "+c);}};sa.prototype.equals2D=function(){if(1===arguments.length){var c=arguments[0];return this.x===c.x&&this.y===c.y}if(2===arguments.length){c=arguments[0];var e=arguments[1];return!!nf.equalsWithTolerance(this.x,c.x,e)&&!!nf.equalsWithTolerance(this.y,c.y,e)}};sa.prototype.getOrdinate=function(c){switch(c){case sa.X:return this.x;
case sa.Y:return this.y;case sa.Z:return this.z}throw new ac("Invalid ordinate index: "+c);};sa.prototype.equals3D=function(c){return this.x===c.x&&this.y===c.y&&(this.z===c.z||Wa.isNaN(this.z))&&Wa.isNaN(c.z)};sa.prototype.equals=function(c){return c instanceof sa&&this.equals2D(c)};sa.prototype.equalInZ=function(c,e){return nf.equalsWithTolerance(this.z,c.z,e)};sa.prototype.compareTo=function(c){return this.x<c.x?-1:this.x>c.x?1:this.y<c.y?-1:this.y>c.y?1:0};sa.prototype.clone=function(){};sa.prototype.copy=
function(){return new sa(this)};sa.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};sa.prototype.distance3D=function(c){var e=this.x-c.x,k=this.y-c.y;c=this.z-c.z;return Math.sqrt(e*e+k*k+c*c)};sa.prototype.distance=function(c){var e=this.x-c.x;c=this.y-c.y;return Math.sqrt(e*e+c*c)};sa.prototype.hashCode=function(){return 37*(629+sa.hashCode(this.x))+sa.hashCode(this.y)};sa.prototype.setCoordinate=function(c){this.x=c.x;this.y=c.y;this.z=c.z};sa.prototype.interfaces_=function(){return[jd,
Xh,id]};sa.prototype.getClass=function(){return sa};sa.hashCode=function(){if(1===arguments.length){var c=Wa.doubleToLongBits(arguments[0]);return Math.trunc((c^c)>>>32)}};of.DimensionalComparator.get=function(){return De};of.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800};of.NULL_ORDINATE.get=function(){return Wa.NaN};of.X.get=function(){return 0};of.Y.get=function(){return 1};of.Z.get=function(){return 2};Object.defineProperties(sa,of);var De=function(c){if((this._dimensionsToTest=2,
0!==arguments.length)&&1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new ac("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};De.prototype.compare=function(c,e){var k=De.compare(c.x,e.x);if(0!==k)return k;k=De.compare(c.y,e.y);return 0!==k?k:2>=this._dimensionsToTest?0:De.compare(c.z,e.z)};De.prototype.interfaces_=function(){return[Rf]};De.prototype.getClass=function(){return De};De.compare=function(c,e){return c<e?-1:c>e?1:Wa.isNaN(c)?Wa.isNaN(e)?0:-1:Wa.isNaN(e)?
1:0};var Sf=function(){};Sf.prototype.create=function(){};Sf.prototype.interfaces_=function(){return[]};Sf.prototype.getClass=function(){return Sf};var ua=function(){},Qg={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ua.prototype.interfaces_=function(){return[]};ua.prototype.getClass=function(){return ua};ua.toLocationSymbol=function(c){switch(c){case ua.EXTERIOR:return"e";case ua.BOUNDARY:return"b";case ua.INTERIOR:return"i";case ua.NONE:return"-"}throw new ac("Unknown location value: "+
c);};Qg.INTERIOR.get=function(){return 0};Qg.BOUNDARY.get=function(){return 1};Qg.EXTERIOR.get=function(){return 2};Qg.NONE.get=function(){return-1};Object.defineProperties(ua,Qg);var Va=function(c,e){return c.interfaces_&&-1<c.interfaces_().indexOf(e)},cd=function(){},en={LOG_10:{configurable:!0}};cd.prototype.interfaces_=function(){return[]};cd.prototype.getClass=function(){return cd};cd.log10=function(c){c=Math.log(c);return Wa.isInfinite(c)||Wa.isNaN(c)?c:c/cd.LOG_10};cd.min=function(c,e,k,d){return e<
c&&(c=e),k<c&&(c=k),d<c&&(c=d),c};cd.clamp=function(c,e,k){if("number"==typeof k&&"number"==typeof c&&"number"==typeof e||Number.isInteger(k)&&Number.isInteger(c)&&Number.isInteger(e))return c<e?e:c>k?k:c};cd.wrap=function(c,e){return 0>c?e- -c%e:c%e};cd.max=function(){if(3===arguments.length){var c=arguments[1],e=arguments[2],k=arguments[0];return c>k&&(k=c),e>k&&(k=e),k}if(4===arguments.length){c=arguments[1];e=arguments[2];k=arguments[3];var d=arguments[0];return c>d&&(d=c),e>d&&(d=e),k>d&&(d=
k),d}};cd.average=function(c,e){return(c+e)/2};en.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(cd,en);var Cd=function(c){this.str=c};Cd.prototype.append=function(c){this.str+=c};Cd.prototype.setCharAt=function(c,e){this.str=this.str.substr(0,c)+e+this.str.substr(c+1)};Cd.prototype.toString=function(c){return this.str};var Dd=function(c){this.value=c};Dd.prototype.intValue=function(){return this.value};Dd.prototype.compareTo=function(c){return this.value<c?-1:this.value>c?1:0};
Dd.isNaN=function(c){return Number.isNaN(c)};var Rg=function(){};Rg.isWhitespace=function(c){return 32>=c&&0<=c||127===c};Rg.toUpperCase=function(c){return c.toUpperCase()};var va=function e(){(this._hi=0,this._lo=0,0===arguments.length)?this.init(0):1===arguments.length?"number"==typeof arguments[0]?this.init(arguments[0]):arguments[0]instanceof e?this.init(arguments[0]):"string"==typeof arguments[0]&&e.call(this,e.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},
rd={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};va.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo};va.prototype.extractSignificantDigits=function(e,k){var d=this.abs(),f=va.magnitude(d._hi),l=va.TEN.pow(f);
(d=d.divide(l)).gt(va.TEN)?(d=d.divide(va.TEN),f+=1):d.lt(va.ONE)&&(d=d.multiply(va.TEN),--f);l=f+1;for(var h=new Cd,m=va.MAX_PRINT_DIGITS-1,q=0;q<=m;q++){e&&q===l&&h.append(".");var n=Math.trunc(d._hi);if(0>n)break;var r=!1,v=0;9<n?(r=!0,v="9"):v="0"+n;h.append(v);d=d.subtract(va.valueOf(n)).multiply(va.TEN);r&&d.selfAdd(va.TEN);n=!0;r=va.magnitude(d._hi);if(0>r&&Math.abs(r)>=m-q&&(n=!1),!n)break}return k[0]=f,h.toString()};va.prototype.sqr=function(){return this.multiply(this)};va.prototype.doubleValue=
function(){return this._hi+this._lo};va.prototype.subtract=function(e){if(e instanceof va)return this.add(e.negate());if("number"==typeof e)return this.add(-e)};va.prototype.equals=function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}};va.prototype.isZero=function(){return 0===this._hi&&0===this._lo};va.prototype.selfSubtract=function(e){if(e instanceof va)return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo);if("number"==typeof e)return this.isNaN()?this:
this.selfAdd(-e,0)};va.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};va.prototype.min=function(e){return this.le(e)?this:e};va.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof va){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){e=arguments[0];var k=arguments[1],d=null,f=null,l=null,h=null,m=null,q=null,n=null,
r=null;return m=this._hi/e,r=(d=(q=va.SPLIT*m)-(d=q-m))*(l=(r=va.SPLIT*e)-(l=r-e))-(n=m*e)+d*(h=e-l)+(f=m-d)*l+f*h,r=m+(q=(this._hi-n-r+this._lo-m*k)/e),this._hi=r,this._lo=m-r+q,this}};va.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};va.prototype.divide=function(e){if(e instanceof va){var k,d=null,f=null,l=null,h=null,m=null;var q=(l=this._hi/e._hi)-(k=(h=va.SPLIT*l)-(k=h-l));m=k*(d=(m=va.SPLIT*e._hi)-(d=m-e._hi))-(h=l*e._hi)+k*(f=e._hi-d)+q*d+q*f;e=m=l+(h=(this._hi-h-m+this._lo-
l*e._lo)/e._hi);return new va(e,l-m+h)}if("number"==typeof e)return Wa.isNaN(e)?va.createNaN():va.copy(this).selfDivide(e,0)};va.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo};va.prototype.pow=function(e){if(0===e)return va.valueOf(1);var k=new va(this),d=va.valueOf(1),f=Math.abs(e);if(1<f)for(;0<f;)1==f%2&&d.selfMultiply(k),0<(f/=2)&&(k=k.sqr());else d=k;return 0>e?d.reciprocal():d};va.prototype.ceil=function(){if(this.isNaN())return va.NaN;var e=Math.ceil(this._hi),
k=0;return e===this._hi&&(k=Math.ceil(this._lo)),new va(e,k)};va.prototype.compareTo=function(e){return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0};va.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()};va.prototype.setValue=function(e){if(e instanceof va||"number"==typeof e)return this.init(e),this};va.prototype.max=function(e){return this.ge(e)?this:e};va.prototype.sqrt=function(){if(this.isZero())return va.valueOf(0);if(this.isNegative())return va.NaN;
var e=1/Math.sqrt(this._hi),k=va.valueOf(this._hi*e);e*=.5*this.subtract(k.sqr())._hi;return k.add(e)};va.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof va){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if("number"==typeof arguments[0]){e=arguments[0];var k=null,d=null,f=null,l=null,h=null,m=null;return l=(f=this._hi+e)-(h=f-this._hi),d=(m=e-h+(this._hi-l)+this._lo)+(f-(k=f+m)),this._hi=k+d,this._lo=d+(k-this._hi),this}}else if(2===arguments.length){m=arguments[0];
e=arguments[1];k=null;f=this._hi+m;var q=this._lo+e;var n=f-(l=f-this._hi);d=q-(h=q-this._lo);m=(k=f+(l=m-l+(this._hi-n)+q))+(l=e-h+(this._lo-d)+(l+(f-k)));return this._hi=m,this._lo=l+(k-m),this}};va.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof va){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){e=arguments[0];var k=arguments[1],d=null,f;var l=(f=
va.SPLIT*this._hi)-this._hi;var h=va.SPLIT*e;l=f-l;var m=this._hi-l;var q=h-e;var n=(f=this._hi*e)+(h=l*(q=h-q)-f+l*(d=e-q)+m*q+m*d+(this._hi*k+this._lo*e));return this._hi=n,this._lo=h+(f-n),this}};va.prototype.selfSqr=function(){return this.selfMultiply(this)};va.prototype.floor=function(){if(this.isNaN())return va.NaN;var e=Math.floor(this._hi),k=0;return e===this._hi&&(k=Math.floor(this._lo)),new va(e,k)};va.prototype.negate=function(){return this.isNaN()?this:new va(-this._hi,-this._lo)};va.prototype.clone=
function(){};va.prototype.multiply=function(e){if(e instanceof va)return e.isNaN()?va.createNaN():va.copy(this).selfMultiply(e);if("number"==typeof e)return Wa.isNaN(e)?va.createNaN():va.copy(this).selfMultiply(e,0)};va.prototype.isNaN=function(){return Wa.isNaN(this._hi)};va.prototype.intValue=function(){return Math.trunc(this._hi)};va.prototype.toString=function(){var e=va.magnitude(this._hi);return-3<=e&&20>=e?this.toStandardNotation():this.toSciNotation()};va.prototype.toStandardNotation=function(){var e=
this.getSpecialNumberString();if(null!==e)return e;var k=Array(1).fill(null);e=this.extractSignificantDigits(!0,k);k=k[0]+1;var d=e;"."===e.charAt(0)?d="0"+e:0>k?d="0."+va.stringOfChar("0",-k)+e:-1===e.indexOf(".")&&(d=e+va.stringOfChar("0",k-e.length)+".0");return this.isNegative()?"-"+d:d};va.prototype.reciprocal=function(){var e,k,d,f,l=null,h;var m=(k=1/this._hi)-(f=(l=va.SPLIT*k)-(f=l-k));var q=(h=va.SPLIT*this._hi)-this._hi;var n=k+(l=(1-(d=k*this._hi)-(f*(q=h-q)-d+f*(e=this._hi-q)+m*q+m*e)-
k*this._lo)/this._hi);return new va(n,k-n+l)};va.prototype.toSciNotation=function(){if(this.isZero())return va.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(null!==e)return e;var k=Array(1).fill(null);e=this.extractSignificantDigits(!1,k);k=va.SCI_NOT_EXPONENT_CHAR+k[0];if("0"===e.charAt(0))throw Error("Found leading zero: "+e);var d="";1<e.length&&(d=e.substring(1));e=e.charAt(0)+"."+d;return this.isNegative()?"-"+e+k:e+k};va.prototype.abs=function(){return this.isNaN()?va.NaN:this.isNegative()?
this.negate():new va(this)};va.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo};va.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo};va.prototype.add=function(e){if(e instanceof va||"number"==typeof e)return va.copy(this).selfAdd(e)};va.prototype.init=function(){if(1===arguments.length)if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else{if(arguments[0]instanceof va){var e=arguments[0];this._hi=e._hi;this._lo=e._lo}}else 2===
arguments.length&&(e=arguments[1],this._hi=arguments[0],this._lo=e)};va.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo};va.prototype.isNegative=function(){return(0>this._hi||0===this._hi)&&0>this._lo};va.prototype.trunc=function(){return this.isNaN()?va.NaN:this.isPositive()?this.floor():this.ceil()};va.prototype.signum=function(){return 0<this._hi?1:0>this._hi?-1:0<this._lo?1:0>this._lo?-1:0};va.prototype.interfaces_=function(){return[id,jd,Xh]};va.prototype.getClass=
function(){return va};va.sqr=function(e){return va.valueOf(e).selfMultiply(e)};va.valueOf=function(e){if("string"==typeof e)return va.parse(e);if("number"==typeof e)return new va(e)};va.sqrt=function(e){return va.valueOf(e).sqrt()};va.parse=function(e){for(var k=0,d=e.length;Rg.isWhitespace(e.charAt(k));)k++;var f=!1;if(k<d){var l=e.charAt(k);"-"!==l&&"+"!==l||(k++,"-"===l&&(f=!0))}l=new va;for(var h=0,m=0,q=0;!(k>=d);){var n=e.charAt(k);if(k++,Rg.isDigit(n))n-=0,l.selfMultiply(va.TEN),l.selfAdd(n),
h++;else{if("."!==n){if("e"===n||"E"===n){k=e.substring(k);try{q=Dd.parseInt(k)}catch(r){throw r instanceof Error?Error("Invalid exponent "+k+" in string "+e):r;}break}throw Error("Unexpected character '"+n+"' at position "+k+" in string "+e);}m=h}}e=l;h=h-m-q;0===h?e=l:0<h?(e=va.TEN.pow(h),e=l.divide(e)):0>h&&(e=va.TEN.pow(-h),e=l.multiply(e));return f?e.negate():e};va.createNaN=function(){return new va(Wa.NaN,Wa.NaN)};va.copy=function(e){return new va(e)};va.magnitude=function(e){e=Math.abs(e);
var k=Math.trunc(Math.floor(Math.log(e)/Math.log(10)));return 10*Math.pow(10,k)<=e&&(k+=1),k};va.stringOfChar=function(e,k){for(var d=new Cd,f=0;f<k;f++)d.append(e);return d.toString()};rd.PI.get=function(){return new va(3.141592653589793,1.2246467991473532E-16)};rd.TWO_PI.get=function(){return new va(6.283185307179586,2.4492935982947064E-16)};rd.PI_2.get=function(){return new va(1.5707963267948966,6.123233995736766E-17)};rd.E.get=function(){return new va(2.718281828459045,1.4456468917292502E-16)};
rd.NaN.get=function(){return new va(Wa.NaN,Wa.NaN)};rd.EPS.get=function(){return 1.23259516440783E-32};rd.SPLIT.get=function(){return 134217729};rd.MAX_PRINT_DIGITS.get=function(){return 32};rd.TEN.get=function(){return va.valueOf(10)};rd.ONE.get=function(){return va.valueOf(1)};rd.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};rd.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(va,rd);var Xc=function(){},fn={DP_SAFE_EPSILON:{configurable:!0}};Xc.prototype.interfaces_=function(){return[]};
Xc.prototype.getClass=function(){return Xc};Xc.orientationIndex=function(e,k,d){var f=Xc.orientationIndexFilter(e,k,d);if(1>=f)return f;f=va.valueOf(k.x).selfAdd(-e.x);e=va.valueOf(k.y).selfAdd(-e.y);var l=va.valueOf(d.x).selfAdd(-k.x);k=va.valueOf(d.y).selfAdd(-k.y);return f.selfMultiply(k).selfSubtract(e.selfMultiply(l)).signum()};Xc.signOfDet2x2=function(e,k,d,f){return e.multiply(f).selfSubtract(k.multiply(d)).signum()};Xc.intersection=function(e,k,d,f){var l=va.valueOf(f.y).selfSubtract(d.y).selfMultiply(va.valueOf(k.x).selfSubtract(e.x)),
h=va.valueOf(f.x).selfSubtract(d.x).selfMultiply(va.valueOf(k.y).selfSubtract(e.y));l=l.subtract(h);h=va.valueOf(f.x).selfSubtract(d.x).selfMultiply(va.valueOf(e.y).selfSubtract(d.y));var m=va.valueOf(f.y).selfSubtract(d.y).selfMultiply(va.valueOf(e.x).selfSubtract(d.x));h=h.subtract(m).selfDivide(l).doubleValue();h=va.valueOf(e.x).selfAdd(va.valueOf(k.x).selfSubtract(e.x).selfMultiply(h)).doubleValue();m=va.valueOf(k.x).selfSubtract(e.x).selfMultiply(va.valueOf(e.y).selfSubtract(d.y));e=va.valueOf(k.y).selfSubtract(e.y).selfMultiply(va.valueOf(e.x).selfSubtract(d.x));
e=m.subtract(e).selfDivide(l).doubleValue();d=va.valueOf(d.y).selfAdd(va.valueOf(f.y).selfSubtract(d.y).selfMultiply(e)).doubleValue();return new sa(h,d)};Xc.orientationIndexFilter=function(e,k,d){var f=(e.x-d.x)*(k.y-d.y);k=(e.y-d.y)*(k.x-d.x);e=f-k;if(0<f){if(0>=k)return Xc.signum(e);f+=k}else{if(!(0>f)||0<=k)return Xc.signum(e);f=-f-k}f*=Xc.DP_SAFE_EPSILON;return e>=f||-e>=f?Xc.signum(e):2};Xc.signum=function(e){return 0<e?1:0>e?-1:0};fn.DP_SAFE_EPSILON.get=function(){return 1E-15};Object.defineProperties(Xc,
fn);var db=function(){},Sg={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Sg.X.get=function(){return 0};Sg.Y.get=function(){return 1};Sg.Z.get=function(){return 2};Sg.M.get=function(){return 3};db.prototype.setOrdinate=function(e,k,d){};db.prototype.size=function(){};db.prototype.getOrdinate=function(e,k){};db.prototype.getCoordinate=function(){};db.prototype.getCoordinateCopy=function(e){};db.prototype.getDimension=function(){};db.prototype.getX=function(e){};db.prototype.clone=
function(){};db.prototype.expandEnvelope=function(e){};db.prototype.copy=function(){};db.prototype.getY=function(e){};db.prototype.toCoordinateArray=function(){};db.prototype.interfaces_=function(){return[Xh]};db.prototype.getClass=function(){return db};Object.defineProperties(db,Sg);var gn=function(){},Tf=function(e){function k(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(k.__proto__=e),k.prototype=Object.create(e&&e.prototype),k.prototype.constructor=k,
k.prototype.interfaces_=function(){return[]},k.prototype.getClass=function(){return k},k}(gn),Oc=function(){};Oc.arraycopy=function(e,k,d,f,l){for(var h=0,m=k;m<k+l;m++)d[f+h]=e[m],h++};Oc.getProperty=function(e){return{"line.separator":"\n"}[e]};var sd=function k(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.y=this.x=0,this.w=1;else if(1===arguments.length){var d=arguments[0];this.x=d.x;this.y=d.y;this.w=1}else if(2===arguments.length)if("number"==typeof arguments[0]&&"number"==
typeof arguments[1])d=arguments[1],this.x=arguments[0],this.y=d,this.w=1;else if(arguments[0]instanceof k&&arguments[1]instanceof k){d=arguments[0];var f=arguments[1];this.x=d.y*f.w-f.y*d.w;this.y=f.x*d.w-d.x*f.w;this.w=d.x*f.y-f.x*d.y}else arguments[0]instanceof sa&&arguments[1]instanceof sa&&(d=arguments[0],f=arguments[1],this.x=d.y-f.y,this.y=f.x-d.x,this.w=d.x*f.y-f.x*d.y);else if(3===arguments.length)d=arguments[1],f=arguments[2],this.x=arguments[0],this.y=d,this.w=f;else if(4===arguments.length){var l=
arguments[0],h=arguments[1],m=arguments[2],q=arguments[3];d=l.y-h.y;f=h.x-l.x;l=l.x*h.y-h.x*l.y;h=m.y-q.y;var n=q.x-m.x;m=m.x*q.y-q.x*m.y;this.x=f*m-n*l;this.y=h*l-d*m;this.w=d*n-h*f}};sd.prototype.getY=function(){var k=this.y/this.w;if(Wa.isNaN(k)||Wa.isInfinite(k))throw new Tf;return k};sd.prototype.getX=function(){var k=this.x/this.w;if(Wa.isNaN(k)||Wa.isInfinite(k))throw new Tf;return k};sd.prototype.getCoordinate=function(){var k=new sa;return k.x=this.getX(),k.y=this.getY(),k};sd.prototype.interfaces_=
function(){return[]};sd.prototype.getClass=function(){return sd};sd.intersection=function(k,d,f,l){var h=k.y-d.y,m=d.x-k.x;k=k.x*d.y-d.x*k.y;d=f.y-l.y;var q=l.x-f.x;f=f.x*l.y-l.x*f.y;l=h*q-d*m;m=(m*f-q*k)/l;h=(d*k-h*f)/l;if(Wa.isNaN(m)||Wa.isInfinite(m)||Wa.isNaN(h)||Wa.isInfinite(h))throw new Tf;return new sa(m,h)};var Ia=function d(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof sa){var f=
arguments[0];this.init(f.x,f.x,f.y,f.y)}else arguments[0]instanceof d&&this.init(arguments[0]);else if(2===arguments.length){f=arguments[0];var l=arguments[1];this.init(f.x,l.x,f.y,l.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},hn={serialVersionUID:{configurable:!0}};Ia.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ia.prototype.equals=function(d){return d instanceof Ia?this.isNull()?d.isNull():this._maxx===d.getMaxX()&&this._maxy===
d.getMaxY()&&this._minx===d.getMinX()&&this._miny===d.getMinY():!1};Ia.prototype.intersection=function(d){return this.isNull()||d.isNull()||!this.intersects(d)?new Ia:new Ia(this._minx>d._minx?this._minx:d._minx,this._maxx<d._maxx?this._maxx:d._maxx,this._miny>d._miny?this._miny:d._miny,this._maxy<d._maxy?this._maxy:d._maxy)};Ia.prototype.isNull=function(){return this._maxx<this._minx};Ia.prototype.getMaxX=function(){return this._maxx};Ia.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof
sa){var d=arguments[0];return this.covers(d.x,d.y)}if(arguments[0]instanceof Ia)return d=arguments[0],!this.isNull()&&!d.isNull()&&d.getMinX()>=this._minx&&d.getMaxX()<=this._maxx&&d.getMinY()>=this._miny&&d.getMaxY()<=this._maxy}else if(2===arguments.length){d=arguments[0];var f=arguments[1];return!this.isNull()&&d>=this._minx&&d<=this._maxx&&f>=this._miny&&f<=this._maxy}};Ia.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Ia){var d=arguments[0];return!this.isNull()&&
!d.isNull()&&!(d._minx>this._maxx||d._maxx<this._minx||d._miny>this._maxy||d._maxy<this._miny)}if(arguments[0]instanceof sa)return d=arguments[0],this.intersects(d.x,d.y)}else if(2===arguments.length){d=arguments[0];var f=arguments[1];return!this.isNull()&&!(d>this._maxx||d<this._minx||f>this._maxy||f<this._miny)}};Ia.prototype.getMinY=function(){return this._miny};Ia.prototype.getMinX=function(){return this._minx};Ia.prototype.expandToInclude=function(){if(1===arguments.length)if(arguments[0]instanceof
sa){var d=arguments[0];this.expandToInclude(d.x,d.y)}else{if(arguments[0]instanceof Ia){d=arguments[0];if(d.isNull())return null;this.isNull()?(this._minx=d.getMinX(),this._maxx=d.getMaxX(),this._miny=d.getMinY(),this._maxy=d.getMaxY()):(d._minx<this._minx&&(this._minx=d._minx),d._maxx>this._maxx&&(this._maxx=d._maxx),d._miny<this._miny&&(this._miny=d._miny),d._maxy>this._maxy&&(this._maxy=d._maxy))}}else if(2===arguments.length){d=arguments[0];var f=arguments[1];this.isNull()?(this._minx=d,this._maxx=
d,this._miny=f,this._maxy=f):(d<this._minx&&(this._minx=d),d>this._maxx&&(this._maxx=d),f<this._miny&&(this._miny=f),f>this._maxy&&(this._maxy=f))}};Ia.prototype.minExtent=function(){if(this.isNull())return 0;var d=this.getWidth(),f=this.getHeight();return d<f?d:f};Ia.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};Ia.prototype.compareTo=function(d){return this.isNull()?d.isNull()?0:-1:d.isNull()?1:this._minx<d._minx?-1:this._minx>d._minx?1:this._miny<d._miny?-1:this._miny>
d._miny?1:this._maxx<d._maxx?-1:this._maxx>d._maxx?1:this._maxy<d._maxy?-1:this._maxy>d._maxy?1:0};Ia.prototype.translate=function(d,f){if(this.isNull())return null;this.init(this.getMinX()+d,this.getMaxX()+d,this.getMinY()+f,this.getMaxY()+f)};Ia.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};Ia.prototype.setToNull=function(){this._minx=0;this._maxx=-1;this._miny=0;this._maxy=-1};Ia.prototype.getHeight=function(){return this.isNull()?
0:this._maxy-this._miny};Ia.prototype.maxExtent=function(){if(this.isNull())return 0;var d=this.getWidth(),f=this.getHeight();return d>f?d:f};Ia.prototype.expandBy=function(){if(1===arguments.length){var d=arguments[0];this.expandBy(d,d)}else if(2===arguments.length){d=arguments[0];var f=arguments[1];if(this.isNull())return null;this._minx-=d;this._maxx+=d;this._miny-=f;this._maxy+=f;(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};Ia.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof
Ia||arguments[0]instanceof sa)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])};Ia.prototype.centre=function(){return this.isNull()?null:new sa((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};Ia.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length)if(arguments[0]instanceof sa){var d=arguments[0];this.init(d.x,d.x,d.y,d.y)}else arguments[0]instanceof Ia&&(d=arguments[0],this._minx=
d._minx,this._maxx=d._maxx,this._miny=d._miny,this._maxy=d._maxy);else if(2===arguments.length){d=arguments[0];var f=arguments[1];this.init(d.x,f.x,d.y,f.y)}else if(4===arguments.length){d=arguments[0];f=arguments[1];var l=arguments[2],h=arguments[3];d<f?(this._minx=d,this._maxx=f):(this._minx=f,this._maxx=d);l<h?(this._miny=l,this._maxy=h):(this._miny=h,this._maxy=l)}};Ia.prototype.getMaxY=function(){return this._maxy};Ia.prototype.distance=function(d){if(this.intersects(d))return 0;var f=0;this._maxx<
d._minx?f=d._minx-this._maxx:this._minx>d._maxx&&(f=this._minx-d._maxx);var l=0;return this._maxy<d._miny?l=d._miny-this._maxy:this._miny>d._maxy&&(l=this._miny-d._maxy),0===f?l:0===l?f:Math.sqrt(f*f+l*l)};Ia.prototype.hashCode=function(){return 37*(37*(37*(629+sa.hashCode(this._minx))+sa.hashCode(this._maxx))+sa.hashCode(this._miny))+sa.hashCode(this._maxy)};Ia.prototype.interfaces_=function(){return[jd,id]};Ia.prototype.getClass=function(){return Ia};Ia.intersects=function(){if(3===arguments.length){var d=
arguments[0],f=arguments[1],l=arguments[2];return l.x>=(d.x<f.x?d.x:f.x)&&l.x<=(d.x>f.x?d.x:f.x)&&l.y>=(d.y<f.y?d.y:f.y)&&l.y<=(d.y>f.y?d.y:f.y)}if(4===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];var h=arguments[3],m=Math.min(l.x,h.x),q=Math.max(l.x,h.x),n=Math.min(d.x,f.x),r=Math.max(d.x,f.x);return!(n>q)&&!(r<m)&&(m=Math.min(l.y,h.y),q=Math.max(l.y,h.y),n=Math.min(d.y,f.y),r=Math.max(d.y,f.y),!(n>q)&&!(r<m))}};hn.serialVersionUID.get=function(){return 0x51845cd552189800};Object.defineProperties(Ia,
hn);var tp=/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,up=/^\s*(\w+)\s*EMPTY\s*$/,Fj=/\s+/,jn=/\)\s*,\s*\(/,vp=/\)\s*\)\s*,\s*\(\s*\(/,Yh=/^\s*\(?(.*?)\)?\s*$/,Zh=function(d){this.geometryFactory=d||new bb};Zh.prototype.read=function(d){var f,l,h;d=d.replace(/[\n\r]/g," ");var m=tp.exec(d);if(-1!==d.search("EMPTY")&&((m=up.exec(d))[2]=void 0),m&&(l=m[1].toLowerCase(),h=m[2],Uf[l]&&(f=Uf[l].apply(this,[h]))),void 0===f)throw Error("Could not parse WKT "+d);return f};Zh.prototype.write=function(d){return this.extractGeometry(d)};
Zh.prototype.extractGeometry=function(d){var f=d.getGeometryType().toLowerCase();if(!pe[f])return null;var l=f.toUpperCase();return d.isEmpty()?l+" EMPTY":l+"("+pe[f].apply(this,[d])+")"};var pe={coordinate:function(d){return d.x+" "+d.y},point:function(d){return pe.coordinate.call(this,d._coordinates._coordinates[0])},multipoint:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push("("+pe.point.apply(this,[d._geometries[l]])+")");return f.join(",")},linestring:function(d){for(var f=
[],l=0,h=d._points._coordinates.length;l<h;++l)f.push(pe.coordinate.apply(this,[d._points._coordinates[l]]));return f.join(",")},linearring:function(d){for(var f=[],l=0,h=d._points._coordinates.length;l<h;++l)f.push(pe.coordinate.apply(this,[d._points._coordinates[l]]));return f.join(",")},multilinestring:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push("("+pe.linestring.apply(this,[d._geometries[l]])+")");return f.join(",")},polygon:function(d){var f=[];f.push("("+pe.linestring.apply(this,
[d._shell])+")");for(var l=0,h=d._holes.length;l<h;++l)f.push("("+pe.linestring.apply(this,[d._holes[l]])+")");return f.join(",")},multipolygon:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push("("+pe.polygon.apply(this,[d._geometries[l]])+")");return f.join(",")},geometrycollection:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push(this.extractGeometry(d._geometries[l]));return f.join(",")}},Uf={point:function(d){if(void 0===d)return this.geometryFactory.createPoint();
d=d.trim().split(Fj);return this.geometryFactory.createPoint(new sa(Number.parseFloat(d[0]),Number.parseFloat(d[1])))},multipoint:function(d){if(void 0===d)return this.geometryFactory.createMultiPoint();for(var f=d.trim().split(","),l=[],h=0,m=f.length;h<m;++h)d=f[h].replace(Yh,"$1"),l.push(Uf.point.apply(this,[d]));return this.geometryFactory.createMultiPoint(l)},linestring:function(d){if(void 0===d)return this.geometryFactory.createLineString();for(var f=d.trim().split(","),l=[],h=0,m=f.length;h<
m;++h)d=f[h].trim().split(Fj),l.push(new sa(Number.parseFloat(d[0]),Number.parseFloat(d[1])));return this.geometryFactory.createLineString(l)},linearring:function(d){if(void 0===d)return this.geometryFactory.createLinearRing();for(var f=d.trim().split(","),l=[],h=0,m=f.length;h<m;++h)d=f[h].trim().split(Fj),l.push(new sa(Number.parseFloat(d[0]),Number.parseFloat(d[1])));return this.geometryFactory.createLinearRing(l)},multilinestring:function(d){if(void 0===d)return this.geometryFactory.createMultiLineString();
for(var f=d.trim().split(jn),l=[],h=0,m=f.length;h<m;++h)d=f[h].replace(Yh,"$1"),l.push(Uf.linestring.apply(this,[d]));return this.geometryFactory.createMultiLineString(l)},polygon:function(d){if(void 0===d)return this.geometryFactory.createPolygon();var f;d=d.trim().split(jn);for(var l=[],h=0,m=d.length;h<m;++h){var q=d[h].replace(Yh,"$1");q=Uf.linestring.apply(this,[q]);q=this.geometryFactory.createLinearRing(q._points);0===h?f=q:l.push(q)}return this.geometryFactory.createPolygon(f,l)},multipolygon:function(d){if(void 0===
d)return this.geometryFactory.createMultiPolygon();for(var f=d.trim().split(vp),l=[],h=0,m=f.length;h<m;++h)d=f[h].replace(Yh,"$1"),l.push(Uf.polygon.apply(this,[d]));return this.geometryFactory.createMultiPolygon(l)},geometrycollection:function(d){if(void 0===d)return this.geometryFactory.createGeometryCollection();d=d.replace(/,\s*([A-Za-z])/g,"|$1").trim().split("|");for(var f=[],l=0,h=d.length;l<h;++l)f.push(this.read(d[l]));return this.geometryFactory.createGeometryCollection(f)}},qe=function(d){this.parser=
new Zh(d)};qe.prototype.write=function(d){return this.parser.write(d)};qe.toLineString=function(d,f){if(2!==arguments.length)throw Error("Not implemented");return"LINESTRING ( "+d.x+" "+d.y+", "+f.x+" "+f.y+" )"};var re=function(d){function f(l){d.call(this,l);this.name="RuntimeException";this.message=l;this.stack=(new d).stack}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f}(Error),$h=function(d){function f(){(d.call(this),0===arguments.length)?d.call(this):
1===arguments.length&&d.call(this,arguments[0])}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(re),Xa=function(){};Xa.prototype.interfaces_=function(){return[]};Xa.prototype.getClass=function(){return Xa};Xa.shouldNeverReachHere=function(){if(0===arguments.length)Xa.shouldNeverReachHere(null);else if(1===arguments.length){var d=arguments[0];throw new $h("Should never reach here"+
(null!==d?": "+d:""));}};Xa.isTrue=function(){var d;if(1===arguments.length)Xa.isTrue(arguments[0],null);else if(2===arguments.length&&(d=arguments[1],!arguments[0]))throw null===d?new $h:new $h(d);};Xa.equals=function(){var d,f,l;if(2===arguments.length)Xa.equals(arguments[0],arguments[1],null);else if(3===arguments.length&&(d=arguments[0],l=arguments[2],!(f=arguments[1]).equals(d)))throw new $h("Expected "+d+" but encountered "+f+(null!==l?": "+l:""));};var Xb=function(){this._result=null;this._inputLines=
Array(2).fill().map(function(){return Array(2)});this._intPt=Array(2).fill(null);this._precisionModel=this._pb=this._pa=this._isProper=this._intLineIndex=null;this._intPt[0]=new sa;this._intPt[1]=new sa;this._pa=this._intPt[0];this._pb=this._intPt[1];this._result=0},pf={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Xb.prototype.getIndexAlongSegment=
function(d,f){return this.computeIntLineIndex(),this._intLineIndex[d][f]};Xb.prototype.getTopologySummary=function(){var d=new Cd;return this.isEndPoint()&&d.append(" endpoint"),this._isProper&&d.append(" proper"),this.isCollinear()&&d.append(" collinear"),d.toString()};Xb.prototype.computeIntersection=function(d,f,l,h){this._inputLines[0][0]=d;this._inputLines[0][1]=f;this._inputLines[1][0]=l;this._inputLines[1][1]=h;this._result=this.computeIntersect(d,f,l,h)};Xb.prototype.getIntersectionNum=function(){return this._result};
Xb.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var d=arguments[0],f=this.getEdgeDistance(d,0),l=this.getEdgeDistance(d,1);f>l?(this._intLineIndex[d][0]=0,this._intLineIndex[d][1]=1):(this._intLineIndex[d][0]=1,this._intLineIndex[d][1]=0)}};Xb.prototype.isProper=function(){return this.hasIntersection()&&
this._isProper};Xb.prototype.setPrecisionModel=function(d){this._precisionModel=d};Xb.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var d=arguments[0],f=0;f<this._result;f++)if(!this._intPt[f].equals2D(this._inputLines[d][0])&&!this._intPt[f].equals2D(this._inputLines[d][1]))return!0;return!1}};Xb.prototype.getIntersection=function(d){return this._intPt[d]};Xb.prototype.isEndPoint=
function(){return this.hasIntersection()&&!this._isProper};Xb.prototype.hasIntersection=function(){return this._result!==Xb.NO_INTERSECTION};Xb.prototype.getEdgeDistance=function(d,f){return Xb.computeEdgeDistance(this._intPt[f],this._inputLines[d][0],this._inputLines[d][1])};Xb.prototype.isCollinear=function(){return this._result===Xb.COLLINEAR_INTERSECTION};Xb.prototype.toString=function(){return qe.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+qe.toLineString(this._inputLines[1][0],
this._inputLines[1][1])+this.getTopologySummary()};Xb.prototype.getEndpoint=function(d,f){return this._inputLines[d][f]};Xb.prototype.isIntersection=function(d){for(var f=0;f<this._result;f++)if(this._intPt[f].equals2D(d))return!0;return!1};Xb.prototype.getIntersectionAlongSegment=function(d,f){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[d][f]]};Xb.prototype.interfaces_=function(){return[]};Xb.prototype.getClass=function(){return Xb};Xb.computeEdgeDistance=function(d,f,l){var h=
Math.abs(l.x-f.x),m=Math.abs(l.y-f.y);if(d.equals(f))h=0;else if(d.equals(l))h=h>m?h:m;else{l=Math.abs(d.x-f.x);var q=Math.abs(d.y-f.y);0!==(h=h>m?l:q)||d.equals(f)||(h=Math.max(l,q))}return Xa.isTrue(!(0===h&&!d.equals(f)),"Bad distance calculation"),h};Xb.nonRobustComputeEdgeDistance=function(d,f,l){l=d.x-f.x;var h=d.y-f.y;l=Math.sqrt(l*l+h*h);return Xa.isTrue(!(0===l&&!d.equals(f)),"Invalid distance calculation"),l};pf.DONT_INTERSECT.get=function(){return 0};pf.DO_INTERSECT.get=function(){return 1};
pf.COLLINEAR.get=function(){return 2};pf.NO_INTERSECTION.get=function(){return 0};pf.POINT_INTERSECTION.get=function(){return 1};pf.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(Xb,pf);var Te=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.isInSegmentEnvelopes=function(l){var h=new Ia(this._inputLines[0][0],this._inputLines[0][1]),m=new Ia(this._inputLines[1][0],this._inputLines[1][1]);
return h.contains(l)&&m.contains(l)},f.prototype.computeIntersection=function(){if(3!==arguments.length)return d.prototype.computeIntersection.apply(this,arguments);var l=arguments[0],h=arguments[1],m=arguments[2];if(this._isProper=!1,Ia.intersects(h,m,l)&&0===Da.orientationIndex(h,m,l)&&0===Da.orientationIndex(m,h,l))return this._isProper=!0,(l.equals(h)||l.equals(m))&&(this._isProper=!1),this._result=d.POINT_INTERSECTION,null;this._result=d.NO_INTERSECTION},f.prototype.normalizeToMinimum=function(l,
h,m,q,n){n.x=this.smallestInAbsValue(l.x,h.x,m.x,q.x);n.y=this.smallestInAbsValue(l.y,h.y,m.y,q.y);l.x-=n.x;l.y-=n.y;h.x-=n.x;h.y-=n.y;m.x-=n.x;m.y-=n.y;q.x-=n.x;q.y-=n.y},f.prototype.safeHCoordinateIntersection=function(l,h,m,q){var n=null;try{n=sd.intersection(l,h,m,q)}catch(r){if(!(r instanceof Tf))throw r;n=f.nearestEndpoint(l,h,m,q)}return n},f.prototype.intersection=function(l,h,m,q){var n=this.intersectionWithNormalization(l,h,m,q);return this.isInSegmentEnvelopes(n)||(n=new sa(f.nearestEndpoint(l,
h,m,q))),null!==this._precisionModel&&this._precisionModel.makePrecise(n),n},f.prototype.smallestInAbsValue=function(l,h,m,q){var n=Math.abs(l);return Math.abs(h)<n&&(l=h,n=Math.abs(h)),Math.abs(m)<n&&(l=m,n=Math.abs(m)),Math.abs(q)<n&&(l=q),l},f.prototype.checkDD=function(l,h,m,q,n){l=Xc.intersection(l,h,m,q);h=this.isInSegmentEnvelopes(l);Oc.out.println("DD in env = "+h+"  --------------------- "+l);1E-4<n.distance(l)&&Oc.out.println("Distance = "+n.distance(l))},f.prototype.intersectionWithNormalization=
function(l,h,m,q){l=new sa(l);h=new sa(h);m=new sa(m);var n=new sa(q);q=new sa;this.normalizeToEnvCentre(l,h,m,n,q);l=this.safeHCoordinateIntersection(l,h,m,n);return l.x+=q.x,l.y+=q.y,l},f.prototype.computeCollinearIntersection=function(l,h,m,q){var n=Ia.intersects(l,h,m),r=Ia.intersects(l,h,q),v=Ia.intersects(m,q,l),z=Ia.intersects(m,q,h);return n&&r?(this._intPt[0]=m,this._intPt[1]=q,d.COLLINEAR_INTERSECTION):v&&z?(this._intPt[0]=l,this._intPt[1]=h,d.COLLINEAR_INTERSECTION):n&&v?(this._intPt[0]=
m,this._intPt[1]=l,!m.equals(l)||r||z?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):n&&z?(this._intPt[0]=m,this._intPt[1]=h,!m.equals(h)||r||v?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):r&&v?(this._intPt[0]=q,this._intPt[1]=l,!q.equals(l)||n||z?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):r&&z?(this._intPt[0]=q,this._intPt[1]=h,!q.equals(h)||n||v?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):d.NO_INTERSECTION},f.prototype.normalizeToEnvCentre=function(l,h,m,q,n){var r=l.x<h.x?l.x:h.x,v=l.y<
h.y?l.y:h.y,z=l.x>h.x?l.x:h.x,u=l.y>h.y?l.y:h.y,y=m.x<q.x?m.x:q.x,C=m.y<q.y?m.y:q.y,w=m.x>q.x?m.x:q.x,x=m.y>q.y?m.y:q.y;n.x=((r>y?r:y)+(z<w?z:w))/2;n.y=((v>C?v:C)+(u<x?u:x))/2;l.x-=n.x;l.y-=n.y;h.x-=n.x;h.y-=n.y;m.x-=n.x;m.y-=n.y;q.x-=n.x;q.y-=n.y},f.prototype.computeIntersect=function(l,h,m,q){if(this._isProper=!1,!Ia.intersects(l,h,m,q))return d.NO_INTERSECTION;var n=Da.orientationIndex(l,h,m),r=Da.orientationIndex(l,h,q);if(0<n&&0<r||0>n&&0>r)return d.NO_INTERSECTION;var v=Da.orientationIndex(m,
q,l),z=Da.orientationIndex(m,q,h);return 0<v&&0<z||0>v&&0>z?d.NO_INTERSECTION:0===n&&0===r&&0===v&&0===z?this.computeCollinearIntersection(l,h,m,q):(0===n||0===r||0===v||0===z?(this._isProper=!1,l.equals2D(m)||l.equals2D(q)?this._intPt[0]=l:h.equals2D(m)||h.equals2D(q)?this._intPt[0]=h:0===n?this._intPt[0]=new sa(m):0===r?this._intPt[0]=new sa(q):0===v?this._intPt[0]=new sa(l):0===z&&(this._intPt[0]=new sa(h))):(this._isProper=!0,this._intPt[0]=this.intersection(l,h,m,q)),d.POINT_INTERSECTION)},f.prototype.interfaces_=
function(){return[]},f.prototype.getClass=function(){return f},f.nearestEndpoint=function(l,h,m,q){var n=l,r=Da.distancePointLine(l,m,q),v=Da.distancePointLine(h,m,q);return v<r&&(r=v,n=h),(v=Da.distancePointLine(m,l,h))<r&&(r=v,n=m),Da.distancePointLine(q,l,h)<r&&(n=q),n},f}(Xb),qf=function(){};qf.prototype.interfaces_=function(){return[]};qf.prototype.getClass=function(){return qf};qf.orientationIndex=function(d,f,l){return qf.signOfDet2x2(f.x-d.x,f.y-d.y,l.x-f.x,l.y-f.y)};qf.signOfDet2x2=function(d,
f,l,h){var m,q=null;if(m=1,0===d||0===h)return 0===f||0===l?0:0<f?0<l?-m:m:0<l?m:-m;if(0===f||0===l)return 0<h?0<d?m:-m:0<d?-m:m;if(0<f?0<h?f<=h||(m=-m,q=d,d=l,l=q,q=f,f=h,h=q):f<=-h?(m=-m,l=-l,h=-h):(q=d,d=-l,l=q,q=f,f=-h,h=q):0<h?-f<=h?(m=-m,d=-d,f=-f):(q=-d,d=l,l=q,q=-f,f=h,h=q):f>=h?(d=-d,f=-f,l=-l,h=-h):(m=-m,q=-d,d=-l,l=q,q=-f,f=-h,h=q),0<d){if(!(0<l&&d<=l))return m}else{if(0<l||!(d>=l))return-m;m=-m;d=-d;l=-l}for(;;){if(0>(h-=(q=Math.floor(l/d))*f))return-m;if(h>f)return m;if(d>(l-=q*d)+l){if(f<
h+h)return m}else{if(f>h+h)return-m;l=d-l;h=f-h;m=-m}if(0===h)return 0===l?0:-m;if(0===l||0>(f-=(q=Math.floor(d/l))*h))return m;if(f>h)return-m;if(l>(d-=q*l)+d){if(h<f+f)return-m}else{if(h>f+f)return m;d=l-d;f=h-f;m=-m}if(0===f)return 0===d?0:m;if(0===d)return-m}};var Ed=function(d){this._crossingCount=0;this._isPointOnSegment=!1;this._p=d};Ed.prototype.countSegment=function(d,f){if(d.x<this._p.x&&f.x<this._p.x)return null;if(this._p.x===f.x&&this._p.y===f.y)return this._isPointOnSegment=!0,null;
if(d.y===this._p.y&&f.y===this._p.y){var l=d.x,h=f.x;return l>h&&(l=f.x,h=d.x),this._p.x>=l&&this._p.x<=h&&(this._isPointOnSegment=!0),null}if(d.y>this._p.y&&f.y<=this._p.y||f.y>this._p.y&&d.y<=this._p.y){l=d.y-this._p.y;h=f.y-this._p.y;d=qf.signOfDet2x2(d.x-this._p.x,l,f.x-this._p.x,h);if(0===d)return this._isPointOnSegment=!0,null;h<l&&(d=-d);0<d&&this._crossingCount++}};Ed.prototype.isPointInPolygon=function(){return this.getLocation()!==ua.EXTERIOR};Ed.prototype.getLocation=function(){return this._isPointOnSegment?
ua.BOUNDARY:1==this._crossingCount%2?ua.INTERIOR:ua.EXTERIOR};Ed.prototype.isOnSegment=function(){return this._isPointOnSegment};Ed.prototype.interfaces_=function(){return[]};Ed.prototype.getClass=function(){return Ed};Ed.locatePointInRing=function(d,f){if(d instanceof sa&&Va(f,db)){d=new Ed(d);for(var l=new sa,h=new sa,m=1;m<f.size()&&(f.getCoordinate(m,l),f.getCoordinate(m-1,h),d.countSegment(l,h),!d.isOnSegment());m++);return d.getLocation()}if(d instanceof sa&&f instanceof Array){d=new Ed(d);
for(l=1;l<f.length&&(d.countSegment(f[l],f[l-1]),!d.isOnSegment());l++);return d.getLocation()}};var Da=function(){},rf={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Da.prototype.interfaces_=function(){return[]};Da.prototype.getClass=function(){return Da};Da.orientationIndex=function(d,f,l){return Xc.orientationIndex(d,f,l)};Da.signedArea=function(d){if(d instanceof Array){if(3>
d.length)return 0;for(var f=0,l=d[0].x,h=1;h<d.length-1;h++)f+=(d[h].x-l)*(d[h-1].y-d[h+1].y);return f/2}if(Va(d,db)){f=d.size();if(3>f)return 0;l=new sa;h=new sa;var m=new sa;d.getCoordinate(0,h);d.getCoordinate(1,m);var q=h.x;m.x-=q;for(var n=0,r=1;r<f-1;r++)l.y=h.y,h.x=m.x,h.y=m.y,d.getCoordinate(r+1,m),m.x-=q,n+=h.x*(l.y-m.y);return n/2}};Da.distanceLineLine=function(d,f,l,h){if(d.equals(f))return Da.distancePointLine(d,l,h);if(l.equals(h))return Da.distancePointLine(h,d,f);var m=!1;if(Ia.intersects(d,
f,l,h)){var q=(f.x-d.x)*(h.y-l.y)-(f.y-d.y)*(h.x-l.x);if(0===q)m=!0;else{var n=((d.y-l.y)*(f.x-d.x)-(d.x-l.x)*(f.y-d.y))/q;q=((d.y-l.y)*(h.x-l.x)-(d.x-l.x)*(h.y-l.y))/q;(0>q||1<q||0>n||1<n)&&(m=!0)}}else m=!0;return m?cd.min(Da.distancePointLine(d,l,h),Da.distancePointLine(f,l,h),Da.distancePointLine(l,d,f),Da.distancePointLine(h,d,f)):0};Da.isPointInRing=function(d,f){return Da.locatePointInRing(d,f)!==ua.EXTERIOR};Da.computeLength=function(d){var f=d.size();if(1>=f)return 0;var l=0,h=new sa;d.getCoordinate(0,
h);for(var m=h.x,q=h.y,n=1;n<f;n++){d.getCoordinate(n,h);var r=h.x,v=h.y;m=r-m;q=v-q;l+=Math.sqrt(m*m+q*q);m=r;q=v}return l};Da.isCCW=function(d){var f=d.length-1;if(3>f)throw new ac("Ring has fewer than 4 points, so orientation cannot be determined");for(var l=d[0],h=0,m=1;m<=f;m++){var q=d[m];q.y>l.y&&(l=q,h=m)}q=h;do 0>--q&&(q=f);while(d[q].equals2D(l)&&q!==h);m=h;do m=(m+1)%f;while(d[m].equals2D(l)&&m!==h);f=d[q];d=d[m];if(f.equals2D(l)||d.equals2D(l)||f.equals2D(d))return!1;l=Da.computeOrientation(f,
l,d);h=!1;return h=0===l?f.x>d.x:0<l,h};Da.locatePointInRing=function(d,f){return Ed.locatePointInRing(d,f)};Da.distancePointLinePerpendicular=function(d,f,l){var h=(l.x-f.x)*(l.x-f.x)+(l.y-f.y)*(l.y-f.y);return Math.abs(((f.y-d.y)*(l.x-f.x)-(f.x-d.x)*(l.y-f.y))/h)*Math.sqrt(h)};Da.computeOrientation=function(d,f,l){return Da.orientationIndex(d,f,l)};Da.distancePointLine=function(){if(2===arguments.length){var d=arguments[0],f=arguments[1];if(0===f.length)throw new ac("Line array must contain at least one vertex");
for(var l=d.distance(f[0]),h=0;h<f.length-1;h++){var m=Da.distancePointLine(d,f[h],f[h+1]);m<l&&(l=m)}return l}if(3===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];if(f.x===l.x&&f.y===l.y)return d.distance(f);h=(l.x-f.x)*(l.x-f.x)+(l.y-f.y)*(l.y-f.y);m=((d.x-f.x)*(l.x-f.x)+(d.y-f.y)*(l.y-f.y))/h;return 0>=m?d.distance(f):1<=m?d.distance(l):Math.abs(((f.y-d.y)*(l.x-f.x)-(f.x-d.x)*(l.y-f.y))/h)*Math.sqrt(h)}};Da.isOnLine=function(d,f){for(var l=new Te,h=1;h<f.length;h++)if(l.computeIntersection(d,
f[h-1],f[h]),l.hasIntersection())return!0;return!1};rf.CLOCKWISE.get=function(){return-1};rf.RIGHT.get=function(){return Da.CLOCKWISE};rf.COUNTERCLOCKWISE.get=function(){return 1};rf.LEFT.get=function(){return Da.COUNTERCLOCKWISE};rf.COLLINEAR.get=function(){return 0};rf.STRAIGHT.get=function(){return Da.COLLINEAR};Object.defineProperties(Da,rf);var se=function(){};se.prototype.filter=function(d){};se.prototype.interfaces_=function(){return[]};se.prototype.getClass=function(){return se};var Ra=function(d){this._userData=
this._SRID=this._envelope=null;this._factory=d;this._SRID=d.getSRID()},Vd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Ra.prototype.isGeometryCollection=
function(){return this.getSortIndex()===Ra.SORTINDEX_GEOMETRYCOLLECTION};Ra.prototype.getFactory=function(){return this._factory};Ra.prototype.getGeometryN=function(d){return this};Ra.prototype.getArea=function(){return 0};Ra.prototype.isRectangle=function(){return!1};Ra.prototype.equals=function(d){if(d instanceof Ra)return null!==d&&this.equalsTopo(d);if(d instanceof Object)return d instanceof Ra?this.equalsExact(d):!1};Ra.prototype.equalsExact=function(d){return this===d||this.equalsExact(d,0)};
Ra.prototype.geometryChanged=function(){this.apply(Ra.geometryChangedFilter)};Ra.prototype.geometryChangedAction=function(){this._envelope=null};Ra.prototype.equalsNorm=function(d){return null!==d&&this.norm().equalsExact(d.norm())};Ra.prototype.getLength=function(){return 0};Ra.prototype.getNumGeometries=function(){return 1};Ra.prototype.compareTo=function(){if(1===arguments.length){var d=arguments[0];return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&
d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(d)}if(2===arguments.length){d=arguments[0];var f=arguments[1];return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(d,f)}};Ra.prototype.getUserData=function(){return this._userData};Ra.prototype.getSRID=function(){return this._SRID};Ra.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};
Ra.prototype.checkNotGeometryCollection=function(d){if(d.getSortIndex()===Ra.SORTINDEX_GEOMETRYCOLLECTION)throw new ac("This method does not support GeometryCollection arguments");};Ra.prototype.equal=function(d,f,l){return 0===l?d.equals(f):d.distance(f)<=l};Ra.prototype.norm=function(){var d=this.copy();return d.normalize(),d};Ra.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Ra.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=
this.computeEnvelopeInternal()),new Ia(this._envelope)};Ra.prototype.setSRID=function(d){this._SRID=d};Ra.prototype.setUserData=function(d){this._userData=d};Ra.prototype.compare=function(d,f){d=d.iterator();for(f=f.iterator();d.hasNext()&&f.hasNext();){var l=d.next(),h=f.next();l=l.compareTo(h);if(0!==l)return l}return d.hasNext()?1:f.hasNext()?-1:0};Ra.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Ra.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===
Ra.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Ra.SORTINDEX_MULTIPOINT||this.getSortIndex()===Ra.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Ra.SORTINDEX_MULTIPOLYGON};Ra.prototype.interfaces_=function(){return[Xh,jd,id]};Ra.prototype.getClass=function(){return Ra};Ra.hasNonEmptyElements=function(d){for(var f=0;f<d.length;f++)if(!d[f].isEmpty())return!0;return!1};Ra.hasNullElements=function(d){for(var f=0;f<d.length;f++)if(null===d[f])return!0;return!1};Vd.serialVersionUID.get=function(){return 0x799ea46522854c00};
Vd.SORTINDEX_POINT.get=function(){return 0};Vd.SORTINDEX_MULTIPOINT.get=function(){return 1};Vd.SORTINDEX_LINESTRING.get=function(){return 2};Vd.SORTINDEX_LINEARRING.get=function(){return 3};Vd.SORTINDEX_MULTILINESTRING.get=function(){return 4};Vd.SORTINDEX_POLYGON.get=function(){return 5};Vd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Vd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Vd.geometryChangedFilter.get=function(){return Gj};Object.defineProperties(Ra,Vd);var Gj=function(){};
Gj.interfaces_=function(){return[se]};Gj.filter=function(d){d.geometryChangedAction()};var Ee=function(){};Ee.prototype.filter=function(d){};Ee.prototype.interfaces_=function(){return[]};Ee.prototype.getClass=function(){return Ee};var kd=function(){},te={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},
MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};kd.prototype.isInBoundary=function(d){};kd.prototype.interfaces_=function(){return[]};kd.prototype.getClass=function(){return kd};te.Mod2BoundaryNodeRule.get=function(){return Vf};te.EndPointBoundaryNodeRule.get=function(){return Wf};te.MultiValentEndPointBoundaryNodeRule.get=function(){return Xf};te.MonoValentEndPointBoundaryNodeRule.get=function(){return Yf};
te.MOD2_BOUNDARY_RULE.get=function(){return new Vf};te.ENDPOINT_BOUNDARY_RULE.get=function(){return new Wf};te.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Xf};te.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Yf};te.OGC_SFS_BOUNDARY_RULE.get=function(){return kd.MOD2_BOUNDARY_RULE};Object.defineProperties(kd,te);var Vf=function(){};Vf.prototype.isInBoundary=function(d){return 1==d%2};Vf.prototype.interfaces_=function(){return[kd]};Vf.prototype.getClass=function(){return Vf};
var Wf=function(){};Wf.prototype.isInBoundary=function(d){return 0<d};Wf.prototype.interfaces_=function(){return[kd]};Wf.prototype.getClass=function(){return Wf};var Xf=function(){};Xf.prototype.isInBoundary=function(d){return 1<d};Xf.prototype.interfaces_=function(){return[kd]};Xf.prototype.getClass=function(){return Xf};var Yf=function(){};Yf.prototype.isInBoundary=function(d){return 1===d};Yf.prototype.interfaces_=function(){return[kd]};Yf.prototype.getClass=function(){return Yf};var kc=function(){};
kc.prototype.add=function(){};kc.prototype.addAll=function(){};kc.prototype.isEmpty=function(){};kc.prototype.iterator=function(){};kc.prototype.size=function(){};kc.prototype.toArray=function(){};kc.prototype.remove=function(){};hj.prototype=Error();hj.prototype.name="IndexOutOfBoundsException";var Zf=function(){};Zf.prototype.hasNext=function(){};Zf.prototype.next=function(){};Zf.prototype.remove=function(){};var ue=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),f.prototype=
Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.get=function(){},f.prototype.set=function(){},f.prototype.isEmpty=function(){},f}(kc);Mf.prototype=Error();Mf.prototype.name="NoSuchElementException";var Fa=function(d){function f(l){d.call(this);this.array_=[];l instanceof kc&&this.addAll(l)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.ensureCapacity=function(){},f.prototype.interfaces_=function(){return[d,kc]},f.prototype.add=
function(l){return 1===arguments.length?this.array_.push(l):this.array_.splice(arguments[0],arguments[1]),!0},f.prototype.clear=function(){this.array_=[]},f.prototype.addAll=function(l){for(l=l.iterator();l.hasNext();)this.add(l.next());return!0},f.prototype.set=function(l,h){var m=this.array_[l];return this.array_[l]=h,m},f.prototype.iterator=function(){return new wp(this)},f.prototype.get=function(l){if(0>l||l>=this.size())throw new hj;return this.array_[l]},f.prototype.isEmpty=function(){return 0===
this.array_.length},f.prototype.size=function(){return this.array_.length},f.prototype.toArray=function(){for(var l=[],h=0,m=this.array_.length;h<m;h++)l.push(this.array_[h]);return l},f.prototype.remove=function(l){for(var h=!1,m=0,q=this.array_.length;m<q;m++)if(this.array_[m]===l){this.array_.splice(m,1);h=!0;break}return h},f}(ue),wp=function(d){function f(l){d.call(this);this.arrayList_=l;this.position_=0}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=
f,f.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Mf;return this.arrayList_.get(this.position_++)},f.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},f.prototype.set=function(l){return this.arrayList_.set(this.position_-1,l)},f.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},f}(Zf),Tg=function(d){function f(){if(d.call(this),0!==arguments.length)if(1===arguments.length){var h=arguments[0];this.ensureCapacity(h.length);
this.add(h,!0)}else if(2===arguments.length){h=arguments[0];var m=arguments[1];this.ensureCapacity(h.length);this.add(h,m)}}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={coordArrayType:{configurable:!0}};return l.coordArrayType.get=function(){return[].fill(null)},f.prototype.getCoordinate=function(h){return this.get(h)},f.prototype.addAll=function(){if(2===arguments.length){for(var h=arguments[1],m=!1,q=arguments[0].iterator();q.hasNext();)this.add(q.next(),
h),m=!0;return m}return d.prototype.addAll.apply(this,arguments)},f.prototype.clone=function(){for(var h=d.prototype.clone.call(this),m=0;m<this.size();m++)h.add(m,this.get(m).copy());return h},f.prototype.toCoordinateArray=function(){return this.toArray(f.coordArrayType)},f.prototype.add=function(){if(1===arguments.length)d.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],
!0),!0;if(arguments[0]instanceof sa&&"boolean"==typeof arguments[1]){var h=arguments[0];if(!arguments[1]&&1<=this.size()&&this.get(this.size()-1).equals2D(h))return null;d.prototype.add.call(this,h)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){h=arguments[0];var m=arguments[1];if(arguments[2])for(var q=
0;q<h.length;q++)this.add(h[q],m);else for(q=h.length-1;0<=q;q--)this.add(h[q],m);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof sa){h=arguments[0];m=arguments[1];if(!arguments[2]&&(q=this.size(),0<q&&(0<h&&this.get(h-1).equals2D(m)||h<q&&this.get(h).equals2D(m))))return null;d.prototype.add.call(this,h,m)}}else if(4===arguments.length){h=arguments[0];m=arguments[1];var n=arguments[2];q=arguments[3];var r=1;for(n>q&&(r=-1);n!==q;n+=r)this.add(h[n],
m);return!0}},f.prototype.closeRing=function(){0<this.size()&&this.add(new sa(this.get(0)),!1)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},Object.defineProperties(f,l),f}(Fa),ab=function(){},ai={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};ai.ForwardComparator.get=function(){return Ug};ai.BidirectionalComparator.get=function(){return $f};ai.coordArrayType.get=function(){return[].fill(null)};
ab.prototype.interfaces_=function(){return[]};ab.prototype.getClass=function(){return ab};ab.isRing=function(d){return!(4>d.length)&&!!d[0].equals2D(d[d.length-1])};ab.ptNotInList=function(d,f){for(var l=0;l<d.length;l++){var h=d[l];if(0>ab.indexOf(h,f))return h}return null};ab.scroll=function(d,f){f=ab.indexOf(f,d);if(0>f)return null;var l=Array(d.length).fill(null);Oc.arraycopy(d,f,l,0,d.length-f);Oc.arraycopy(d,0,l,d.length-f,f);Oc.arraycopy(l,0,d,0,d.length)};ab.equals=function(){if(2===arguments.length){var d=
arguments[0],f=arguments[1];if(d===f)return!0;if(null===d||null===f||d.length!==f.length)return!1;for(var l=0;l<d.length;l++)if(!d[l].equals(f[l]))return!1;return!0}if(3===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];if(d===f)return!0;if(null===d||null===f||d.length!==f.length)return!1;for(var h=0;h<d.length;h++)if(0!==l.compare(d[h],f[h]))return!1;return!0}};ab.intersection=function(d,f){for(var l=new Tg,h=0;h<d.length;h++)f.intersects(d[h])&&l.add(d[h],!0);return l.toCoordinateArray()};
ab.hasRepeatedPoints=function(d){for(var f=1;f<d.length;f++)if(d[f-1].equals(d[f]))return!0;return!1};ab.removeRepeatedPoints=function(d){return ab.hasRepeatedPoints(d)?(new Tg(d,!1)).toCoordinateArray():d};ab.reverse=function(d){for(var f=d.length-1,l=Math.trunc(f/2),h=0;h<=l;h++){var m=d[h];d[h]=d[f-h];d[f-h]=m}};ab.removeNull=function(d){for(var f=0,l=0;l<d.length;l++)null!==d[l]&&f++;l=Array(f).fill(null);if(0===f)return l;for(var h=f=0;h<d.length;h++)null!==d[h]&&(l[f++]=d[h]);return l};ab.copyDeep=
function(){if(1===arguments.length){for(var d=arguments[0],f=Array(d.length).fill(null),l=0;l<d.length;l++)f[l]=new sa(d[l]);return f}if(5===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];for(var h=arguments[3],m=arguments[4],q=0;q<m;q++)l[h+q]=new sa(d[f+q])}};ab.isEqualReversed=function(d,f){for(var l=0;l<d.length;l++)if(0!==d[l].compareTo(f[d.length-l-1]))return!1;return!0};ab.envelope=function(d){for(var f=new Ia,l=0;l<d.length;l++)f.expandToInclude(d[l]);return f};ab.toCoordinateArray=
function(d){return d.toArray(ab.coordArrayType)};ab.atLeastNCoordinatesOrNothing=function(d,f){return f.length>=d?f:[]};ab.indexOf=function(d,f){for(var l=0;l<f.length;l++)if(d.equals(f[l]))return l;return-1};ab.increasingDirection=function(d){for(var f=0;f<Math.trunc(d.length/2);f++){var l=d[f].compareTo(d[d.length-1-f]);if(0!==l)return l}return 1};ab.compare=function(d,f){for(var l=0;l<d.length&&l<f.length;){var h=d[l].compareTo(f[l]);if(0!==h)return h;l++}return l<f.length?-1:l<d.length?1:0};ab.minCoordinate=
function(d){for(var f=null,l=0;l<d.length;l++)(null===f||0<f.compareTo(d[l]))&&(f=d[l]);return f};ab.extract=function(d,f,l){f=cd.clamp(f,0,d.length);var h=(l=cd.clamp(l,-1,d.length))-f+1;0>l&&(h=0);f>=d.length&&(h=0);l<f&&(h=0);var m=Array(h).fill(null);if(0===h)return m;for(h=0;f<=l;f++)m[h++]=d[f];return m};Object.defineProperties(ab,ai);var Ug=function(){};Ug.prototype.compare=function(d,f){return ab.compare(d,f)};Ug.prototype.interfaces_=function(){return[Rf]};Ug.prototype.getClass=function(){return Ug};
var $f=function(){};$f.prototype.compare=function(d,f){if(d.length<f.length)return-1;if(d.length>f.length)return 1;if(0===d.length)return 0;var l=ab.compare(d,f);return ab.isEqualReversed(d,f)?0:l};$f.prototype.OLDcompare=function(d,f){if(d.length<f.length)return-1;if(d.length>f.length)return 1;if(0===d.length)return 0;for(var l=ab.increasingDirection(d),h=ab.increasingDirection(f),m=0<l?0:d.length-1,q=0<h?0:d.length-1,n=0;n<d.length;n++){var r=d[m].compareTo(f[q]);if(0!==r)return r;m+=l;q+=h}return 0};
$f.prototype.interfaces_=function(){return[Rf]};$f.prototype.getClass=function(){return $f};var sf=function(){};sf.prototype.get=function(){};sf.prototype.put=function(){};sf.prototype.size=function(){};sf.prototype.values=function(){};sf.prototype.entrySet=function(){};var xp=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f}(sf);Hg.prototype=Error();Hg.prototype.name="OperationNotSupported";Lh.prototype=
new kc;Lh.prototype.contains=function(){};var Hj=function(d){function f(l){d.call(this);this.array_=[];l instanceof kc&&this.addAll(l)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.contains=function(l){for(var h=0,m=this.array_.length;h<m;h++)if(this.array_[h]===l)return!0;return!1},f.prototype.add=function(l){return!this.contains(l)&&(this.array_.push(l),!0)},f.prototype.addAll=function(l){for(l=l.iterator();l.hasNext();)this.add(l.next());
return!0},f.prototype.remove=function(l){throw Error();},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var l=[],h=0,m=this.array_.length;h<m;h++)l.push(this.array_[h]);return l},f.prototype.iterator=function(){return new yp(this)},f}(Lh),yp=function(d){function f(l){d.call(this);this.hashSet_=l;this.position_=0}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=
f,f.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Mf;return this.hashSet_.array_[this.position_++]},f.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},f.prototype.remove=function(){throw new Hg;},f}(Zf);Ac.prototype=new xp;Ac.prototype.get=function(d){for(var f=this.root_;null!==f;){var l=d.compareTo(f.key);if(0>l)f=f.left;else{if(!(0<l))return f.value;f=f.right}}return null};Ac.prototype.put=function(d,f){if(null===this.root_)return this.root_=
{key:d,value:f,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var l,h,m=this.root_;do if(l=m,0>(h=d.compareTo(m.key)))m=m.left;else{if(!(0<h))return l=m.value,m.value=f,l;m=m.right}while(null!==m);f={key:d,left:null,right:null,value:f,parent:l,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>h?l.left=f:l.right=f,this.fixAfterInsertion(f),this.size_++,null};Ac.prototype.fixAfterInsertion=
function(d){for(d.color=1;null!=d&&d!==this.root_&&1===d.parent.color;)if(Pb(d)===ij(Pb(Pb(d)))){var f=bm(Pb(Pb(d)));1===(null===f?0:f.color)?(le(Pb(d),0),le(f,0),le(Pb(Pb(d)),1),d=Pb(Pb(d))):(d===bm(Pb(d))&&(d=Pb(d),this.rotateLeft(d)),le(Pb(d),0),le(Pb(Pb(d)),1),this.rotateRight(Pb(Pb(d))))}else f=ij(Pb(Pb(d))),1===(null===f?0:f.color)?(le(Pb(d),0),le(f,0),le(Pb(Pb(d)),1),d=Pb(Pb(d))):(d===ij(Pb(d))&&(d=Pb(d),this.rotateRight(d)),le(Pb(d),0),le(Pb(Pb(d)),1),this.rotateLeft(Pb(Pb(d))));this.root_.color=
0};Ac.prototype.values=function(){var d=new Fa,f=this.getFirstEntry();if(null!==f)for(d.add(f.value);null!==(f=Ac.successor(f));)d.add(f.value);return d};Ac.prototype.entrySet=function(){var d=new Hj,f=this.getFirstEntry();if(null!==f)for(d.add(f);null!==(f=Ac.successor(f));)d.add(f);return d};Ac.prototype.rotateLeft=function(d){if(null!=d){var f=d.right;d.right=f.left;null!=f.left&&(f.left.parent=d);f.parent=d.parent;null===d.parent?this.root_=f:d.parent.left===d?d.parent.left=f:d.parent.right=f;
f.left=d;d.parent=f}};Ac.prototype.rotateRight=function(d){if(null!=d){var f=d.left;d.left=f.right;null!=f.right&&(f.right.parent=d);f.parent=d.parent;null===d.parent?this.root_=f:d.parent.right===d?d.parent.right=f:d.parent.left=f;f.right=d;d.parent=f}};Ac.prototype.getFirstEntry=function(){var d=this.root_;if(null!=d)for(;null!=d.left;)d=d.left;return d};Ac.successor=function(d){if(null===d)return null;if(null!==d.right){for(var f=d.right;null!==f.left;)f=f.left;return f}for(f=d.parent;null!==f&&
d===f.right;)d=f,f=f.parent;return f};Ac.prototype.size=function(){return this.size_};var Vg=function(){};Vg.prototype.interfaces_=function(){return[]};Vg.prototype.getClass=function(){return Vg};cm.prototype=new Lh;zd.prototype=new cm;zd.prototype.contains=function(d){for(var f=0,l=this.array_.length;f<l;f++)if(0===this.array_[f].compareTo(d))return!0;return!1};zd.prototype.add=function(d){if(this.contains(d))return!1;for(var f=0,l=this.array_.length;f<l;f++)if(1===this.array_[f].compareTo(d))return this.array_.splice(f,
0,d),!0;return this.array_.push(d),!0};zd.prototype.addAll=function(d){for(d=d.iterator();d.hasNext();)this.add(d.next());return!0};zd.prototype.remove=function(d){throw new Hg;};zd.prototype.size=function(){return this.array_.length};zd.prototype.isEmpty=function(){return 0===this.array_.length};zd.prototype.toArray=function(){for(var d=[],f=0,l=this.array_.length;f<l;f++)d.push(this.array_[f]);return d};zd.prototype.iterator=function(){return new bi(this)};var bi=function(d){this.treeSet_=d;this.position_=
0};bi.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Mf;return this.treeSet_.array_[this.position_++]};bi.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};bi.prototype.remove=function(){throw new Hg;};var Ue=function(){};Ue.sort=function(){var d,f=arguments[0];if(1===arguments.length){var l=function(m,q){return m.compareTo(q)};f.sort(l)}else if(2===arguments.length){var h=arguments[1];l=function(m,q){return h.compare(m,q)};f.sort(l)}else if(3===
arguments.length)for((d=f.slice(arguments[1],arguments[2])).sort(),l=f.slice(0,arguments[1]).concat(d,f.slice(arguments[2],f.length)),f.splice(0,f.length),d=0;d<l.length;d++)f.push(l[d]);else if(4===arguments.length)for(d=f.slice(arguments[1],arguments[2]),h=arguments[3],l=function(m,q){return h.compare(m,q)},d.sort(l),l=f.slice(0,arguments[1]).concat(d,f.slice(arguments[2],f.length)),f.splice(0,f.length),d=0;d<l.length;d++)f.push(l[d])};Ue.asList=function(d){for(var f=new Fa,l=0,h=d.length;l<h;l++)f.add(d[l]);
return f};var Eb=function(){},td={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};td.P.get=function(){return 0};td.L.get=function(){return 1};td.A.get=function(){return 2};td.FALSE.get=function(){return-1};td.TRUE.get=function(){return-2};td.DONTCARE.get=function(){return-3};
td.SYM_FALSE.get=function(){return"F"};td.SYM_TRUE.get=function(){return"T"};td.SYM_DONTCARE.get=function(){return"*"};td.SYM_P.get=function(){return"0"};td.SYM_L.get=function(){return"1"};td.SYM_A.get=function(){return"2"};Eb.prototype.interfaces_=function(){return[]};Eb.prototype.getClass=function(){return Eb};Eb.toDimensionSymbol=function(d){switch(d){case Eb.FALSE:return Eb.SYM_FALSE;case Eb.TRUE:return Eb.SYM_TRUE;case Eb.DONTCARE:return Eb.SYM_DONTCARE;case Eb.P:return Eb.SYM_P;case Eb.L:return Eb.SYM_L;
case Eb.A:return Eb.SYM_A}throw new ac("Unknown dimension value: "+d);};Eb.toDimensionValue=function(d){switch(Rg.toUpperCase(d)){case Eb.SYM_FALSE:return Eb.FALSE;case Eb.SYM_TRUE:return Eb.TRUE;case Eb.SYM_DONTCARE:return Eb.DONTCARE;case Eb.SYM_P:return Eb.P;case Eb.SYM_L:return Eb.L;case Eb.SYM_A:return Eb.A}throw new ac("Unknown dimension symbol: "+d);};Object.defineProperties(Eb,td);var Ve=function(){};Ve.prototype.filter=function(d){};Ve.prototype.interfaces_=function(){return[]};Ve.prototype.getClass=
function(){return Ve};var Wd=function(){};Wd.prototype.filter=function(d,f){};Wd.prototype.isDone=function(){};Wd.prototype.isGeometryChanged=function(){};Wd.prototype.interfaces_=function(){return[]};Wd.prototype.getClass=function(){return Wd};var ud=function(d){function f(h,m){if(d.call(this,m),this._geometries=h||[],d.hasNullElements(this._geometries))throw new ac("geometries must not contain null elements");}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=
f;var l={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){for(var h=new Ia,m=0;m<this._geometries.length;m++)h.expandToInclude(this._geometries[m].getEnvelopeInternal());return h},f.prototype.getGeometryN=function(h){return this._geometries[h]},f.prototype.getSortIndex=function(){return d.SORTINDEX_GEOMETRYCOLLECTION},f.prototype.getCoordinates=function(){for(var h=Array(this.getNumPoints()).fill(null),m=-1,q=0;q<this._geometries.length;q++)for(var n=this._geometries[q].getCoordinates(),
r=0;r<n.length;r++)h[++m]=n[r];return h},f.prototype.getArea=function(){for(var h=0,m=0;m<this._geometries.length;m++)h+=this._geometries[m].getArea();return h},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];if(!this.isEquivalentClass(h)||this._geometries.length!==h._geometries.length)return!1;for(var q=0;q<this._geometries.length;q++)if(!this._geometries[q].equalsExact(h._geometries[q],m))return!1;return!0}return d.prototype.equalsExact.apply(this,arguments)},
f.prototype.normalize=function(){for(var h=0;h<this._geometries.length;h++)this._geometries[h].normalize();Ue.sort(this._geometries)},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},f.prototype.getBoundaryDimension=function(){for(var h=Eb.FALSE,m=0;m<this._geometries.length;m++)h=Math.max(h,this._geometries[m].getBoundaryDimension());return h},f.prototype.getDimension=function(){for(var h=Eb.FALSE,m=0;m<this._geometries.length;m++)h=Math.max(h,
this._geometries[m].getDimension());return h},f.prototype.getLength=function(){for(var h=0,m=0;m<this._geometries.length;m++)h+=this._geometries[m].getLength();return h},f.prototype.getNumPoints=function(){for(var h=0,m=0;m<this._geometries.length;m++)h+=this._geometries[m].getNumPoints();return h},f.prototype.getNumGeometries=function(){return this._geometries.length},f.prototype.reverse=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<this._geometries.length;m++)h[m]=this._geometries[m].reverse();
return this.getFactory().createGeometryCollection(h)},f.prototype.compareToSameClass=function(){if(1===arguments.length){var h=arguments[0],m=new zd(Ue.asList(this._geometries));h=new zd(Ue.asList(h._geometries));return this.compare(m,h)}if(2===arguments.length){m=arguments[1];h=arguments[0];for(var q=this.getNumGeometries(),n=h.getNumGeometries(),r=0;r<q&&r<n;){var v=this.getGeometryN(r),z=h.getGeometryN(r);v=v.compareToSameClass(z,m);if(0!==v)return v;r++}return r<q?1:r<n?-1:0}},f.prototype.apply=
function(h){if(Va(h,Ee))for(var m=0;m<this._geometries.length;m++)this._geometries[m].apply(h);else if(Va(h,Wd)){if(0===this._geometries.length)return null;for(m=0;m<this._geometries.length&&(this._geometries[m].apply(h),!h.isDone());m++);h.isGeometryChanged()&&this.geometryChanged()}else if(Va(h,Ve))for(h.filter(this),m=0;m<this._geometries.length;m++)this._geometries[m].apply(h);else if(Va(h,se))for(h.filter(this),m=0;m<this._geometries.length;m++)this._geometries[m].apply(h)},f.prototype.getBoundary=
function(){return this.checkNotGeometryCollection(this),Xa.shouldNeverReachHere(),null},f.prototype.clone=function(){var h=d.prototype.clone.call(this);h._geometries=Array(this._geometries.length).fill(null);for(var m=0;m<this._geometries.length;m++)h._geometries[m]=this._geometries[m].clone();return h},f.prototype.getGeometryType=function(){return"GeometryCollection"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=this._geometries[m].copy();
return new f(h,this._factory)},f.prototype.isEmpty=function(){for(var h=0;h<this._geometries.length;h++)if(!this._geometries[h].isEmpty())return!1;return!0},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(f,l),f}(Ra),We=function(d){function f(){d.apply(this,arguments)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};
return f.prototype.getSortIndex=function(){return Ra.SORTINDEX_MULTILINESTRING},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&d.prototype.equalsExact.call(this,h,m)}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return this.isClosed()?Eb.FALSE:0},f.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var h=0;h<this._geometries.length;h++)if(!this._geometries[h].isClosed())return!1;
return!0},f.prototype.getDimension=function(){return 1},f.prototype.reverse=function(){for(var h=this._geometries.length,m=Array(h).fill(null),q=0;q<this._geometries.length;q++)m[h-1-q]=this._geometries[q].reverse();return this.getFactory().createMultiLineString(m)},f.prototype.getBoundary=function(){return(new ld(this)).getBoundary()},f.prototype.getGeometryType=function(){return"MultiLineString"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=
this._geometries[m].copy();return new f(h,this._factory)},f.prototype.interfaces_=function(){return[Vg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(f,l),f}(ud),ld=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var d=arguments[0],f=kd.MOD2_BOUNDARY_RULE;this._geom=d;this._geomFact=d.getFactory();this._bnRule=f}else 2===arguments.length&&(d=arguments[0],
f=arguments[1],this._geom=d,this._geomFact=d.getFactory(),this._bnRule=f)};ld.prototype.boundaryMultiLineString=function(d){if(this._geom.isEmpty())return this.getEmptyMultiPoint();d=this.computeBoundaryCoordinates(d);return 1===d.length?this._geomFact.createPoint(d[0]):this._geomFact.createMultiPointFromCoords(d)};ld.prototype.getBoundary=function(){return this._geom instanceof Hc?this.boundaryLineString(this._geom):this._geom instanceof We?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};
ld.prototype.boundaryLineString=function(d){return this._geom.isEmpty()?this.getEmptyMultiPoint():d.isClosed()?this._bnRule.isInBoundary(2)?d.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([d.getStartPoint(),d.getEndPoint()])};ld.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};ld.prototype.computeBoundaryCoordinates=function(d){var f=new Fa;this._endpointMap=new Ac;for(var l=0;l<d.getNumGeometries();l++){var h=d.getGeometryN(l);
0!==h.getNumPoints()&&(this.addEndpoint(h.getCoordinateN(0)),this.addEndpoint(h.getCoordinateN(h.getNumPoints()-1)))}for(d=this._endpointMap.entrySet().iterator();d.hasNext();)l=d.next(),h=l.getValue().count,this._bnRule.isInBoundary(h)&&f.add(l.getKey());return ab.toCoordinateArray(f)};ld.prototype.addEndpoint=function(d){var f=this._endpointMap.get(d);null===f&&(f=new ci,this._endpointMap.put(d,f));f.count++};ld.prototype.interfaces_=function(){return[]};ld.prototype.getClass=function(){return ld};
ld.getBoundary=function(){if(1===arguments.length)return(new ld(arguments[0])).getBoundary();if(2===arguments.length)return(new ld(arguments[0],arguments[1])).getBoundary()};var ci=function(){this.count=null};ci.prototype.interfaces_=function(){return[]};ci.prototype.getClass=function(){return ci};var zp=function(){},md=function(){},Ij={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};md.prototype.interfaces_=function(){return[]};md.prototype.getClass=function(){return md};md.chars=
function(d,f){for(var l=Array(f).fill(null),h=0;h<f;h++)l[h]=d;return String(l)};md.getStackTrace=function(){if(1===arguments.length){var d=arguments[0],f=new Ho,l=new Fo(f);return d.printStackTrace(l),f.toString()}if(2===arguments.length){d=arguments[1];f="";l=new Go(md.getStackTrace(arguments[0]));l=new Io(l);for(var h=0;h<d;h++)try{f+=l.readLine()+md.NEWLINE}catch(m){throw m;}return f}};md.split=function(d,f){var l=f.length,h=new Fa;d=""+d;for(var m=d.indexOf(f);0<=m;){var q=d.substring(0,m);h.add(q);
m=(d=d.substring(m+l)).indexOf(f)}0<d.length&&h.add(d);f=Array(h.size()).fill(null);for(l=0;l<f.length;l++)f[l]=h.get(l);return f};md.toString=function(){if(1===arguments.length)return md.SIMPLE_ORDINATE_FORMAT.format(arguments[0])};md.spaces=function(d){return md.chars(" ",d)};Ij.NEWLINE.get=function(){return Oc.getProperty("line.separator")};Ij.SIMPLE_ORDINATE_FORMAT.get=function(){return new zp("0.#")};Object.defineProperties(md,Ij);var dc=function(){};dc.prototype.interfaces_=function(){return[]};
dc.prototype.getClass=function(){return dc};dc.copyCoord=function(d,f,l,h){for(var m=Math.min(d.getDimension(),l.getDimension()),q=0;q<m;q++)l.setOrdinate(h,q,d.getOrdinate(f,q))};dc.isRing=function(d){var f=d.size();return 0===f||!(3>=f)&&d.getOrdinate(0,db.X)===d.getOrdinate(f-1,db.X)&&d.getOrdinate(0,db.Y)===d.getOrdinate(f-1,db.Y)};dc.isEqual=function(d,f){var l=d.size();if(l!==f.size())return!1;for(var h=Math.min(d.getDimension(),f.getDimension()),m=0;m<l;m++)for(var q=0;q<h;q++){var n=d.getOrdinate(m,
q),r=f.getOrdinate(m,q);if(!(d.getOrdinate(m,q)===f.getOrdinate(m,q)||Wa.isNaN(n)&&Wa.isNaN(r)))return!1}return!0};dc.extend=function(d,f,l){d=d.create(l,f.getDimension());var h=f.size();if(dc.copy(f,0,d,0,h),0<h)for(var m=h;m<l;m++)dc.copy(f,h-1,d,m,1);return d};dc.reverse=function(d){for(var f=d.size()-1,l=Math.trunc(f/2),h=0;h<=l;h++)dc.swap(d,h,f-h)};dc.swap=function(d,f,l){if(f===l)return null;for(var h=0;h<d.getDimension();h++){var m=d.getOrdinate(f,h);d.setOrdinate(f,h,d.getOrdinate(l,h));
d.setOrdinate(l,h,m)}};dc.copy=function(d,f,l,h,m){for(var q=0;q<m;q++)dc.copyCoord(d,f+q,l,h+q)};dc.toString=function(){if(1===arguments.length){var d=arguments[0],f=d.size();if(0===f)return"()";var l=d.getDimension(),h=new Cd;h.append("(");for(var m=0;m<f;m++){0<m&&h.append(" ");for(var q=0;q<l;q++)0<q&&h.append(","),h.append(md.toString(d.getOrdinate(m,q)))}return h.append(")"),h.toString()}};dc.ensureValidRing=function(d,f){var l=f.size();return 0===l?f:3>=l?dc.createClosedRing(d,f,4):f.getOrdinate(0,
db.X)===f.getOrdinate(l-1,db.X)&&f.getOrdinate(0,db.Y)===f.getOrdinate(l-1,db.Y)?f:dc.createClosedRing(d,f,l+1)};dc.createClosedRing=function(d,f,l){d=d.create(l,f.getDimension());var h=f.size();for(dc.copy(f,0,d,0,h);h<l;h++)dc.copy(f,0,d,h,1);return d};var Hc=function(d){function f(h,m){d.call(this,m);this._points=null;this.init(h)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=
function(){return this.isEmpty()?new Ia:this._points.expandEnvelope(new Ia)},f.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},f.prototype.getSortIndex=function(){return d.SORTINDEX_LINESTRING},f.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];if(!this.isEquivalentClass(h)||this._points.size()!==h._points.size())return!1;for(var q=0;q<this._points.size();q++)if(!this.equal(this._points.getCoordinate(q),
h._points.getCoordinate(q),m))return!1;return!0}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){for(var h=0;h<Math.trunc(this._points.size()/2);h++){var m=this._points.size()-1-h;if(!this._points.getCoordinate(h).equals(this._points.getCoordinate(m)))return 0<this._points.getCoordinate(h).compareTo(this._points.getCoordinate(m))&&dc.reverse(this._points),null}},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},f.prototype.getBoundaryDimension=
function(){return this.isClosed()?Eb.FALSE:0},f.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},f.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},f.prototype.getDimension=function(){return 1},f.prototype.getLength=function(){return Da.computeLength(this._points)},f.prototype.getNumPoints=function(){return this._points.size()},f.prototype.reverse=function(){var h=this._points.copy();
return dc.reverse(h),this.getFactory().createLineString(h)},f.prototype.compareToSameClass=function(){if(1===arguments.length){for(var h=arguments[0],m=0,q=0;m<this._points.size()&&q<h._points.size();){var n=this._points.getCoordinate(m).compareTo(h._points.getCoordinate(q));if(0!==n)return n;m++;q++}return m<this._points.size()?1:q<h._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},f.prototype.apply=function(h){if(Va(h,Ee))for(var m=0;m<
this._points.size();m++)h.filter(this._points.getCoordinate(m));else if(Va(h,Wd)){if(0===this._points.size())return null;for(m=0;m<this._points.size()&&(h.filter(this._points,m),!h.isDone());m++);h.isGeometryChanged()&&this.geometryChanged()}else Va(h,Ve)?h.filter(this):Va(h,se)&&h.filter(this)},f.prototype.getBoundary=function(){return(new ld(this)).getBoundary()},f.prototype.isEquivalentClass=function(h){return h instanceof f},f.prototype.clone=function(){var h=d.prototype.clone.call(this);return h._points=
this._points.clone(),h},f.prototype.getCoordinateN=function(h){return this._points.getCoordinate(h)},f.prototype.getGeometryType=function(){return"LineString"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._points},f.prototype.isEmpty=function(){return 0===this._points.size()},f.prototype.init=function(h){if(null===h&&(h=this.getFactory().getCoordinateSequenceFactory().create([])),1===h.size())throw new ac("Invalid number of points in LineString (found "+
h.size()+" - must be 0 or >= 2)");this._points=h},f.prototype.isCoordinate=function(h){for(var m=0;m<this._points.size();m++)if(this._points.getCoordinate(m).equals(h))return!0;return!1},f.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},f.prototype.getPointN=function(h){return this.getFactory().createPoint(this._points.getCoordinate(h))},f.prototype.interfaces_=function(){return[Vg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},
Object.defineProperties(f,l),f}(Ra),Wg=function(){};Wg.prototype.interfaces_=function(){return[]};Wg.prototype.getClass=function(){return Wg};var Xd=function(d){function f(h,m){d.call(this,m);this._coordinates=h||null;this.init(this._coordinates)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ia;var h=new Ia;return h.expandToInclude(this._coordinates.getX(0),
this._coordinates.getY(0)),h},f.prototype.getSortIndex=function(){return d.SORTINDEX_POINT},f.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&(!(!this.isEmpty()||!h.isEmpty())||this.isEmpty()===h.isEmpty()&&this.equal(h.getCoordinate(),this.getCoordinate(),m))}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=
function(){},f.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},f.prototype.getBoundaryDimension=function(){return Eb.FALSE},f.prototype.getDimension=function(){return 0},f.prototype.getNumPoints=function(){return this.isEmpty()?0:1},f.prototype.reverse=function(){return this.copy()},f.prototype.getX=function(){if(null===this.getCoordinate())throw Error("getX called on empty Point");return this.getCoordinate().x},f.prototype.compareToSameClass=
function(){if(1===arguments.length){var h=arguments[0];return this.getCoordinate().compareTo(h.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},f.prototype.apply=function(h){if(Va(h,Ee)){if(this.isEmpty())return null;h.filter(this.getCoordinate())}else if(Va(h,Wd)){if(this.isEmpty())return null;h.filter(this._coordinates,0);h.isGeometryChanged()&&this.geometryChanged()}else Va(h,Ve)?h.filter(this):Va(h,se)&&h.filter(this)},f.prototype.getBoundary=
function(){return this.getFactory().createGeometryCollection(null)},f.prototype.clone=function(){var h=d.prototype.clone.call(this);return h._coordinates=this._coordinates.clone(),h},f.prototype.getGeometryType=function(){return"Point"},f.prototype.copy=function(){return new f(this._coordinates.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._coordinates},f.prototype.getY=function(){if(null===this.getCoordinate())throw Error("getY called on empty Point");return this.getCoordinate().y},
f.prototype.isEmpty=function(){return 0===this._coordinates.size()},f.prototype.init=function(h){null===h&&(h=this.getFactory().getCoordinateSequenceFactory().create([]));Xa.isTrue(1>=h.size());this._coordinates=h},f.prototype.isSimple=function(){return!0},f.prototype.interfaces_=function(){return[Wg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(f,l),f}(Ra),Xe=function(){};Xe.prototype.interfaces_=function(){return[]};
Xe.prototype.getClass=function(){return Xe};var Fd=function(d){function f(h,m,q){if(d.call(this,q),this._shell=null,this._holes=null,null===h&&(h=this.getFactory().createLinearRing()),null===m&&(m=[]),d.hasNullElements(m))throw new ac("holes must not contain null elements");if(h.isEmpty()&&d.hasNonEmptyElements(m))throw new ac("shell is empty but holes are not");this._shell=h;this._holes=m}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};
return f.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},f.prototype.getSortIndex=function(){return d.SORTINDEX_POLYGON},f.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var h=Array(this.getNumPoints()).fill(null),m=-1,q=this._shell.getCoordinates(),n=0;n<q.length;n++)h[++m]=q[n];for(q=0;q<this._holes.length;q++){n=this._holes[q].getCoordinates();for(var r=0;r<n.length;r++)h[++m]=n[r]}return h},f.prototype.getArea=function(){var h=0+Math.abs(Da.signedArea(this._shell.getCoordinateSequence()));
for(var m=0;m<this._holes.length;m++)h-=Math.abs(Da.signedArea(this._holes[m].getCoordinateSequence()));return h},f.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var h=this._shell.getCoordinateSequence(),m=this.getEnvelopeInternal(),q=0;5>q;q++){var n=h.getX(q);if(n!==m.getMinX()&&n!==m.getMaxX())return!1;n=h.getY(q);if(n!==m.getMinY()&&n!==m.getMaxY())return!1}m=h.getX(0);q=h.getY(0);for(n=1;4>=n;n++){var r=h.getX(n),
v=h.getY(n);if(r!==m===(v!==q))return!1;m=r;q=v}return!0},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];if(!this.isEquivalentClass(h)||!this._shell.equalsExact(h._shell,m)||this._holes.length!==h._holes.length)return!1;for(var q=0;q<this._holes.length;q++)if(!this._holes[q].equalsExact(h._holes[q],m))return!1;return!0}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,
!0);for(var h=0;h<this._holes.length;h++)this.normalize(this._holes[h],!1);Ue.sort(this._holes)}else if(2===arguments.length){h=arguments[0];var m=arguments[1];if(h.isEmpty())return null;var q=Array(h.getCoordinates().length-1).fill(null);Oc.arraycopy(h.getCoordinates(),0,q,0,q.length);var n=ab.minCoordinate(h.getCoordinates());ab.scroll(q,n);Oc.arraycopy(q,0,h.getCoordinates(),0,q.length);h.getCoordinates()[q.length]=q[0];Da.isCCW(h.getCoordinates())===m&&ab.reverse(h.getCoordinates())}},f.prototype.getCoordinate=
function(){return this._shell.getCoordinate()},f.prototype.getNumInteriorRing=function(){return this._holes.length},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.getLength=function(){var h=0+this._shell.getLength();for(var m=0;m<this._holes.length;m++)h+=this._holes[m].getLength();return h},f.prototype.getNumPoints=function(){for(var h=this._shell.getNumPoints(),m=0;m<this._holes.length;m++)h+=this._holes[m].getNumPoints();return h},
f.prototype.reverse=function(){var h=this.copy();h._shell=this._shell.copy().reverse();h._holes=Array(this._holes.length).fill(null);for(var m=0;m<this._holes.length;m++)h._holes[m]=this._holes[m].copy().reverse();return h},f.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},f.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var h=arguments[1],m=arguments[0],q=this._shell.compareToSameClass(m._shell,
h);if(0!==q)return q;q=this.getNumInteriorRing();for(var n=m.getNumInteriorRing(),r=0;r<q&&r<n;){var v=this.getInteriorRingN(r),z=m.getInteriorRingN(r);v=v.compareToSameClass(z,h);if(0!==v)return v;r++}return r<q?1:r<n?-1:0}},f.prototype.apply=function(h){if(Va(h,Ee)){this._shell.apply(h);for(var m=0;m<this._holes.length;m++)this._holes[m].apply(h)}else if(Va(h,Wd)){if(this._shell.apply(h),!h.isDone())for(m=0;m<this._holes.length&&(this._holes[m].apply(h),!h.isDone());m++);h.isGeometryChanged()&&
this.geometryChanged()}else if(Va(h,Ve))h.filter(this);else if(Va(h,se))for(h.filter(this),this._shell.apply(h),m=0;m<this._holes.length;m++)this._holes[m].apply(h)},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var h=Array(this._holes.length+1).fill(null);h[0]=this._shell;for(var m=0;m<this._holes.length;m++)h[m+1]=this._holes[m];return 1>=h.length?this.getFactory().createLinearRing(h[0].getCoordinateSequence()):this.getFactory().createMultiLineString(h)},
f.prototype.clone=function(){var h=d.prototype.clone.call(this);h._shell=this._shell.clone();h._holes=Array(this._holes.length).fill(null);for(var m=0;m<this._holes.length;m++)h._holes[m]=this._holes[m].clone();return h},f.prototype.getGeometryType=function(){return"Polygon"},f.prototype.copy=function(){for(var h=this._shell.copy(),m=Array(this._holes.length).fill(null),q=0;q<m.length;q++)m[q]=this._holes[q].copy();return new f(h,m,this._factory)},f.prototype.getExteriorRing=function(){return this._shell},
f.prototype.isEmpty=function(){return this._shell.isEmpty()},f.prototype.getInteriorRingN=function(h){return this._holes[h]},f.prototype.interfaces_=function(){return[Xe]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(f,l),f}(Ra),ag=function(d){function f(){d.apply(this,arguments)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=
function(){return Ra.SORTINDEX_MULTIPOINT},f.prototype.isValid=function(){return!0},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&d.prototype.equalsExact.call(this,h,m)}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():d.prototype.getCoordinate.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return Eb.FALSE},
f.prototype.getDimension=function(){return 0},f.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},f.prototype.getGeometryType=function(){return"MultiPoint"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=this._geometries[m].copy();return new f(h,this._factory)},f.prototype.interfaces_=function(){return[Wg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},
Object.defineProperties(f,l),f}(ud),Yd=function(d){function f(h,m){h instanceof sa&&m instanceof bb&&(h=m.getCoordinateSequenceFactory().create(h));d.call(this,h,m);this.validateConstruction()}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return Ra.SORTINDEX_LINEARRING},f.prototype.getBoundaryDimension=function(){return Eb.FALSE},f.prototype.isClosed=
function(){return!!this.isEmpty()||d.prototype.isClosed.call(this)},f.prototype.reverse=function(){var h=this._points.copy();return dc.reverse(h),this.getFactory().createLinearRing(h)},f.prototype.validateConstruction=function(){if(!this.isEmpty()&&!d.prototype.isClosed.call(this))throw new ac("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<f.MINIMUM_VALID_SIZE)throw new ac("Invalid number of points in LinearRing (found "+
this.getCoordinateSequence().size()+" - must be 0 or >= 4)");},f.prototype.getGeometryType=function(){return"LinearRing"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},l.MINIMUM_VALID_SIZE.get=function(){return 4},l.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(f,l),f}(Hc),Fe=function(d){function f(){d.apply(this,arguments)}d&&(f.__proto__=d);f.prototype=
Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return Ra.SORTINDEX_MULTIPOLYGON},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&d.prototype.equalsExact.call(this,h,m)}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.reverse=
function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<this._geometries.length;m++)h[m]=this._geometries[m].reverse();return this.getFactory().createMultiPolygon(h)},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var h=new Fa,m=0;m<this._geometries.length;m++)for(var q=this._geometries[m].getBoundary(),n=0;n<q.getNumGeometries();n++)h.add(q.getGeometryN(n));m=Array(h.size()).fill(null);return this.getFactory().createMultiLineString(h.toArray(m))},
f.prototype.getGeometryType=function(){return"MultiPolygon"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=this._geometries[m].copy();return new f(h,this._factory)},f.prototype.interfaces_=function(){return[Xe]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(f,l),f}(ud),nd=function(d){this._factory=d||null;this._isUserDataCopied=!1},di={NoOpGeometryOperation:{configurable:!0},
CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};nd.prototype.setCopyUserData=function(d){this._isUserDataCopied=d};nd.prototype.edit=function(d,f){if(null===d)return null;f=this.editInternal(d,f);return this._isUserDataCopied&&f.setUserData(d.getUserData()),f};nd.prototype.editInternal=function(d,f){return null===this._factory&&(this._factory=d.getFactory()),d instanceof ud?this.editGeometryCollection(d,f):d instanceof Fd?this.editPolygon(d,f):d instanceof Xd||
d instanceof Hc?f.edit(d,this._factory):(Xa.shouldNeverReachHere("Unsupported Geometry class: "+d.getClass().getName()),null)};nd.prototype.editGeometryCollection=function(d,f){d=f.edit(d,this._factory);for(var l=new Fa,h=0;h<d.getNumGeometries();h++){var m=this.edit(d.getGeometryN(h),f);null===m||m.isEmpty()||l.add(m)}return d.getClass()===ag?this._factory.createMultiPoint(l.toArray([])):d.getClass()===We?this._factory.createMultiLineString(l.toArray([])):d.getClass()===Fe?this._factory.createMultiPolygon(l.toArray([])):
this._factory.createGeometryCollection(l.toArray([]))};nd.prototype.editPolygon=function(d,f){d=f.edit(d,this._factory);if(null===d&&(d=this._factory.createPolygon(null)),d.isEmpty())return d;var l=this.edit(d.getExteriorRing(),f);if(null===l||l.isEmpty())return this._factory.createPolygon();for(var h=new Fa,m=0;m<d.getNumInteriorRing();m++){var q=this.edit(d.getInteriorRingN(m),f);null===q||q.isEmpty()||h.add(q)}return this._factory.createPolygon(l,h.toArray([]))};nd.prototype.interfaces_=function(){return[]};
nd.prototype.getClass=function(){return nd};nd.GeometryEditorOperation=function(){};di.NoOpGeometryOperation.get=function(){return Xg};di.CoordinateOperation.get=function(){return Yg};di.CoordinateSequenceOperation.get=function(){return Zg};Object.defineProperties(nd,di);var Xg=function(){};Xg.prototype.edit=function(d,f){return d};Xg.prototype.interfaces_=function(){return[nd.GeometryEditorOperation]};Xg.prototype.getClass=function(){return Xg};var Yg=function(){};Yg.prototype.edit=function(d,f){var l=
this.editCoordinates(d.getCoordinates(),d);return null===l?d:d instanceof Yd?f.createLinearRing(l):d instanceof Hc?f.createLineString(l):d instanceof Xd?0<l.length?f.createPoint(l[0]):f.createPoint():d};Yg.prototype.interfaces_=function(){return[nd.GeometryEditorOperation]};Yg.prototype.getClass=function(){return Yg};var Zg=function(){};Zg.prototype.edit=function(d,f){return d instanceof Yd?f.createLinearRing(this.edit(d.getCoordinateSequence(),d)):d instanceof Hc?f.createLineString(this.edit(d.getCoordinateSequence(),
d)):d instanceof Xd?f.createPoint(this.edit(d.getCoordinateSequence(),d)):d};Zg.prototype.interfaces_=function(){return[nd.GeometryEditorOperation]};Zg.prototype.getClass=function(){return Zg};var hc=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length)if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var d=arguments[0];this._coordinates=Array(d).fill(null);for(var f=0;f<d;f++)this._coordinates[f]=new sa}else{if(Va(arguments[0],
db)){d=arguments[0];if(null===d)return this._coordinates=[].fill(null),null;this._dimension=d.getDimension();this._coordinates=Array(d.size()).fill(null);for(f=0;f<this._coordinates.length;f++)this._coordinates[f]=d.getCoordinateCopy(f)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1]))d=arguments[0],f=arguments[1],this._coordinates=d,this._dimension=f,null===d&&(this._coordinates=[].fill(null));else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1]))for(d=
arguments[0],f=arguments[1],this._coordinates=Array(d).fill(null),this._dimension=f,f=0;f<d;f++)this._coordinates[f]=new sa},kn={serialVersionUID:{configurable:!0}};hc.prototype.setOrdinate=function(d,f,l){switch(f){case db.X:this._coordinates[d].x=l;break;case db.Y:this._coordinates[d].y=l;break;case db.Z:this._coordinates[d].z=l;break;default:throw new ac("invalid ordinateIndex");}};hc.prototype.size=function(){return this._coordinates.length};hc.prototype.getOrdinate=function(d,f){switch(f){case db.X:return this._coordinates[d].x;
case db.Y:return this._coordinates[d].y;case db.Z:return this._coordinates[d].z}return Wa.NaN};hc.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var d=arguments[0],f=arguments[1];f.x=this._coordinates[d].x;f.y=this._coordinates[d].y;f.z=this._coordinates[d].z}};hc.prototype.getCoordinateCopy=function(d){return new sa(this._coordinates[d])};hc.prototype.getDimension=function(){return this._dimension};hc.prototype.getX=function(d){return this._coordinates[d].x};
hc.prototype.clone=function(){for(var d=Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)d[f]=this._coordinates[f].clone();return new hc(d,this._dimension)};hc.prototype.expandEnvelope=function(d){for(var f=0;f<this._coordinates.length;f++)d.expandToInclude(this._coordinates[f]);return d};hc.prototype.copy=function(){for(var d=Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)d[f]=this._coordinates[f].copy();return new hc(d,this._dimension)};hc.prototype.toString=function(){if(0<
this._coordinates.length){var d=new Cd(17*this._coordinates.length);d.append("(");d.append(this._coordinates[0]);for(var f=1;f<this._coordinates.length;f++)d.append(", "),d.append(this._coordinates[f]);return d.append(")"),d.toString()}return"()"};hc.prototype.getY=function(d){return this._coordinates[d].y};hc.prototype.toCoordinateArray=function(){return this._coordinates};hc.prototype.interfaces_=function(){return[db,id]};hc.prototype.getClass=function(){return hc};kn.serialVersionUID.get=function(){return-0xcb44a778db18e00};
Object.defineProperties(hc,kn);var Zd=function(){},Jj={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Zd.prototype.readResolve=function(){return Zd.instance()};Zd.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array||Va(arguments[0],db))return new hc(arguments[0])}else if(2===arguments.length){var d=arguments[0],f=arguments[1];return 3<f&&(f=3),2>f?new hc(d):new hc(d,f)}};Zd.prototype.interfaces_=function(){return[Sf,id]};Zd.prototype.getClass=
function(){return Zd};Zd.instance=function(){return Zd.instanceObject};Jj.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};Jj.instanceObject.get=function(){return new Zd};Object.defineProperties(Zd,Jj);var ln=function(d){function f(){d.call(this);this.map_=new Map}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.get=function(l){return this.map_.get(l)||null},f.prototype.put=function(l,h){return this.map_.set(l,h),h},f.prototype.values=
function(){for(var l=new Fa,h=this.map_.values(),m=h.next();!m.done;)l.add(m.value),m=h.next();return l},f.prototype.entrySet=function(){var l=new Hj;return this.map_.entries().forEach(function(h){return l.add(h)}),l},f.prototype.size=function(){return this.map_.size()},f}(sf),Fb=function f(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=f.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Gd){var l=arguments[0];this._modelType=l;l===f.FIXED&&this.setScale(1)}else"number"==
typeof arguments[0]?(l=arguments[0],this._modelType=f.FIXED,this.setScale(l)):arguments[0]instanceof f&&(l=arguments[0],this._modelType=l._modelType,this._scale=l._scale)},Kj={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Fb.prototype.equals=function(f){return f instanceof Fb?this._modelType===f._modelType&&this._scale===f._scale:!1};Fb.prototype.compareTo=function(f){var l=this.getMaximumSignificantDigits();f=f.getMaximumSignificantDigits();return(new Dd(l)).compareTo(new Dd(f))};
Fb.prototype.getScale=function(){return this._scale};Fb.prototype.isFloating=function(){return this._modelType===Fb.FLOATING||this._modelType===Fb.FLOATING_SINGLE};Fb.prototype.getType=function(){return this._modelType};Fb.prototype.toString=function(){var f="UNKNOWN";return this._modelType===Fb.FLOATING?f="Floating":this._modelType===Fb.FLOATING_SINGLE?f="Floating-Single":this._modelType===Fb.FIXED&&(f="Fixed (Scale="+this.getScale()+")"),f};Fb.prototype.makePrecise=function(f){if("number"==typeof f)return Wa.isNaN(f)||
this._modelType===Fb.FLOATING_SINGLE?f:this._modelType===Fb.FIXED?Math.round(f*this._scale)/this._scale:f;if(f instanceof sa){if(this._modelType===Fb.FLOATING)return null;f.x=this.makePrecise(f.x);f.y=this.makePrecise(f.y)}};Fb.prototype.getMaximumSignificantDigits=function(){var f=16;return this._modelType===Fb.FLOATING?f=16:this._modelType===Fb.FLOATING_SINGLE?f=6:this._modelType===Fb.FIXED&&(f=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),f};Fb.prototype.setScale=function(f){this._scale=
Math.abs(f)};Fb.prototype.interfaces_=function(){return[id,jd]};Fb.prototype.getClass=function(){return Fb};Fb.mostPrecise=function(f,l){return 0<=f.compareTo(l)?f:l};Kj.serialVersionUID.get=function(){return 0x6bee6404e9a25c00};Kj.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Fb,Kj);var Gd=function h(l){this._name=l||null;h.nameToTypeMap.put(l,this)},Lj={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Gd.prototype.readResolve=function(){return Gd.nameToTypeMap.get(this._name)};
Gd.prototype.toString=function(){return this._name};Gd.prototype.interfaces_=function(){return[id]};Gd.prototype.getClass=function(){return Gd};Lj.serialVersionUID.get=function(){return-0x4cb98acd40a6b400};Lj.nameToTypeMap.get=function(){return new ln};Object.defineProperties(Gd,Lj);Fb.Type=Gd;Fb.FIXED=new Gd("FIXED");Fb.FLOATING=new Gd("FLOATING");Fb.FLOATING_SINGLE=new Gd("FLOATING SINGLE");var bb=function h(){this._precisionModel=new Fb;this._SRID=0;this._coordinateSequenceFactory=h.getDefaultCoordinateSequenceFactory();
0===arguments.length||(1===arguments.length?Va(arguments[0],Sf)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Fb&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},mn={serialVersionUID:{configurable:!0}};bb.prototype.toGeometry=function(h){return h.isNull()?this.createPoint(null):h.getMinX()===
h.getMaxX()&&h.getMinY()===h.getMaxY()?this.createPoint(new sa(h.getMinX(),h.getMinY())):h.getMinX()===h.getMaxX()||h.getMinY()===h.getMaxY()?this.createLineString([new sa(h.getMinX(),h.getMinY()),new sa(h.getMaxX(),h.getMaxY())]):this.createPolygon(this.createLinearRing([new sa(h.getMinX(),h.getMinY()),new sa(h.getMinX(),h.getMaxY()),new sa(h.getMaxX(),h.getMaxY()),new sa(h.getMaxX(),h.getMinY()),new sa(h.getMinX(),h.getMinY())]),null)};bb.prototype.createLineString=function(h){return h?h instanceof
Array?new Hc(this.getCoordinateSequenceFactory().create(h),this):Va(h,db)?new Hc(h,this):void 0:new Hc(this.getCoordinateSequenceFactory().create([]),this)};bb.prototype.createMultiLineString=function(){if(0===arguments.length)return new We(null,this);if(1===arguments.length)return new We(arguments[0],this)};bb.prototype.buildGeometry=function(h){for(var m=null,q=!1,n=!1,r=h.iterator();r.hasNext();){var v=r.next(),z=v.getClass();null===m&&(m=z);z!==m&&(q=!0);v.isGeometryCollectionOrDerived()&&(n=
!0)}if(null===m)return this.createGeometryCollection();if(q||n)return this.createGeometryCollection(bb.toGeometryArray(h));m=h.iterator().next();if(1<h.size()){if(m instanceof Fd)return this.createMultiPolygon(bb.toPolygonArray(h));if(m instanceof Hc)return this.createMultiLineString(bb.toLineStringArray(h));if(m instanceof Xd)return this.createMultiPoint(bb.toPointArray(h));Xa.shouldNeverReachHere("Unhandled class: "+m.getClass().getName())}return m};bb.prototype.createMultiPointFromCoords=function(h){return this.createMultiPoint(null!==
h?this.getCoordinateSequenceFactory().create(h):null)};bb.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof sa){var h=arguments[0];return this.createPoint(null!==h?this.getCoordinateSequenceFactory().create([h]):null)}if(Va(arguments[0],db))return new Xd(arguments[0],this)}};bb.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};bb.prototype.createPolygon=
function(){if(0===arguments.length)return new Fd(null,null,this);if(1===arguments.length){if(Va(arguments[0],db)||arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Yd)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new Fd(arguments[0],arguments[1],this)};bb.prototype.getSRID=function(){return this._SRID};bb.prototype.createGeometryCollection=function(){if(0===arguments.length)return new ud(null,this);
if(1===arguments.length)return new ud(arguments[0],this)};bb.prototype.createGeometry=function(h){return(new nd(this)).edit(h,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})};bb.prototype.getPrecisionModel=function(){return this._precisionModel};bb.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var h=
arguments[0];return this.createLinearRing(null!==h?this.getCoordinateSequenceFactory().create(h):null)}if(Va(arguments[0],db))return new Yd(arguments[0],this)}};bb.prototype.createMultiPolygon=function(){if(0===arguments.length)return new Fe(null,this);if(1===arguments.length)return new Fe(arguments[0],this)};bb.prototype.createMultiPoint=function(){if(0===arguments.length)return new ag(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ag(arguments[0],this);if(arguments[0]instanceof
Array){var h=arguments[0];return this.createMultiPoint(null!==h?this.getCoordinateSequenceFactory().create(h):null)}if(Va(arguments[0],db)){h=arguments[0];if(null===h)return this.createMultiPoint([].fill(null));for(var m=Array(h.size()).fill(null),q=0;q<h.size();q++){var n=this.getCoordinateSequenceFactory().create(1,h.getDimension());dc.copy(h,q,n,0,1);m[q]=this.createPoint(n)}return this.createMultiPoint(m)}}};bb.prototype.interfaces_=function(){return[id]};bb.prototype.getClass=function(){return bb};
bb.toMultiPolygonArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toGeometryArray=function(h){if(null===h)return null;var m=Array(h.size()).fill(null);return h.toArray(m)};bb.getDefaultCoordinateSequenceFactory=function(){return Zd.instance()};bb.toMultiLineStringArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toLineStringArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toMultiPointArray=function(h){var m=Array(h.size()).fill(null);
return h.toArray(m)};bb.toLinearRingArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toPointArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toPolygonArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.createPointFromInternalCoord=function(h,m){return m.getPrecisionModel().makePrecise(h),m.getFactory().createPoint(h)};mn.serialVersionUID.get=function(){return-0x5ea75f2051eeb400};Object.defineProperties(bb,mn);var Ap="Point MultiPoint LineString MultiLineString Polygon MultiPolygon".split(" "),
ei=function(h){this.geometryFactory=h||new bb};ei.prototype.read=function(h){var m=(h="string"==typeof h?JSON.parse(h):h).type;if(!Hd[m])throw Error("Unknown GeoJSON type: "+h.type);return-1!==Ap.indexOf(m)?Hd[m].apply(this,[h.coordinates]):"GeometryCollection"===m?Hd[m].apply(this,[h.geometries]):Hd[m].apply(this,[h])};ei.prototype.write=function(h){var m=h.getGeometryType();if(!ve[m])throw Error("Geometry is not supported");return ve[m].apply(this,[h])};var Hd={Feature:function(h){var m={},q;for(q in h)m[q]=
h[q];if(h.geometry){if(!Hd[h.geometry.type])throw Error("Unknown GeoJSON type: "+h.type);m.geometry=this.read(h.geometry)}return h.bbox&&(m.bbox=Hd.bbox.apply(this,[h.bbox])),m},FeatureCollection:function(h){var m={};if(h.features){m.features=[];for(var q=0;q<h.features.length;++q)m.features.push(this.read(h.features[q]))}return h.bbox&&(m.bbox=this.parse.bbox.apply(this,[h.bbox])),m},coordinates:function(h){for(var m=[],q=0;q<h.length;++q){var n=h[q];m.push(new sa(n[0],n[1]))}return m},bbox:function(h){return this.geometryFactory.createLinearRing([new sa(h[0],
h[1]),new sa(h[2],h[1]),new sa(h[2],h[3]),new sa(h[0],h[3]),new sa(h[0],h[1])])},Point:function(h){h=new sa(h[0],h[1]);return this.geometryFactory.createPoint(h)},MultiPoint:function(h){for(var m=[],q=0;q<h.length;++q)m.push(Hd.Point.apply(this,[h[q]]));return this.geometryFactory.createMultiPoint(m)},LineString:function(h){h=Hd.coordinates.apply(this,[h]);return this.geometryFactory.createLineString(h)},MultiLineString:function(h){for(var m=[],q=0;q<h.length;++q)m.push(Hd.LineString.apply(this,[h[q]]));
return this.geometryFactory.createMultiLineString(m)},Polygon:function(h){var m=Hd.coordinates.apply(this,[h[0]]);m=this.geometryFactory.createLinearRing(m);for(var q=[],n=1;n<h.length;++n){var r=Hd.coordinates.apply(this,[h[n]]);r=this.geometryFactory.createLinearRing(r);q.push(r)}return this.geometryFactory.createPolygon(m,q)},MultiPolygon:function(h){for(var m=[],q=0;q<h.length;++q)m.push(Hd.Polygon.apply(this,[h[q]]));return this.geometryFactory.createMultiPolygon(m)},GeometryCollection:function(h){for(var m=
[],q=0;q<h.length;++q)m.push(this.read(h[q]));return this.geometryFactory.createGeometryCollection(m)}},ve={coordinate:function(h){return[h.x,h.y]},Point:function(h){return{type:"Point",coordinates:ve.coordinate.apply(this,[h.getCoordinate()])}},MultiPoint:function(h){for(var m=[],q=0;q<h._geometries.length;++q){var n=ve.Point.apply(this,[h._geometries[q]]);m.push(n.coordinates)}return{type:"MultiPoint",coordinates:m}},LineString:function(h){var m=[];h=h.getCoordinates();for(var q=0;q<h.length;++q)m.push(ve.coordinate.apply(this,
[h[q]]));return{type:"LineString",coordinates:m}},MultiLineString:function(h){for(var m=[],q=0;q<h._geometries.length;++q){var n=ve.LineString.apply(this,[h._geometries[q]]);m.push(n.coordinates)}return{type:"MultiLineString",coordinates:m}},Polygon:function(h){var m=[],q=ve.LineString.apply(this,[h._shell]);m.push(q.coordinates);for(q=0;q<h._holes.length;++q){var n=ve.LineString.apply(this,[h._holes[q]]);m.push(n.coordinates)}return{type:"Polygon",coordinates:m}},MultiPolygon:function(h){for(var m=
[],q=0;q<h._geometries.length;++q){var n=ve.Polygon.apply(this,[h._geometries[q]]);m.push(n.coordinates)}return{type:"MultiPolygon",coordinates:m}},GeometryCollection:function(h){for(var m=[],q=0;q<h._geometries.length;++q){var n=h._geometries[q],r=n.getGeometryType();m.push(ve[r].apply(this,[n]))}return{type:"GeometryCollection",geometries:m}}},qj=function(h){this.geometryFactory=h||new bb;this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new ei(this.geometryFactory)};qj.prototype.read=
function(h){h=this.parser.read(h);return this.precisionModel.getType()===Fb.FIXED&&this.reducePrecision(h),h};qj.prototype.reducePrecision=function(h){var m;if(h.coordinate)this.precisionModel.makePrecise(h.coordinate);else if(h.points){var q=0;for(m=h.points.length;q<m;q++)this.precisionModel.makePrecise(h.points[q])}else if(h.geometries)for(q=0,m=h.geometries.length;q<m;q++)this.reducePrecision(h.geometries[q])};var Cm=function(){this.parser=new ei(this.geometryFactory)};Cm.prototype.write=function(h){return this.parser.write(h)};
var Aa=function(){},fi={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Aa.prototype.interfaces_=function(){return[]};Aa.prototype.getClass=function(){return Aa};Aa.opposite=function(h){return h===Aa.LEFT?Aa.RIGHT:h===Aa.RIGHT?Aa.LEFT:h};fi.ON.get=function(){return 0};fi.LEFT.get=function(){return 1};fi.RIGHT.get=function(){return 2};Object.defineProperties(Aa,fi);Mh.prototype=Error();Mh.prototype.name="EmptyStackException";Ad.prototype=new ue;Ad.prototype.add=function(h){return this.array_.push(h),
!0};Ad.prototype.get=function(h){if(0>h||h>=this.size())throw Error();return this.array_[h]};Ad.prototype.push=function(h){return this.array_.push(h),h};Ad.prototype.pop=function(h){if(0===this.array_.length)throw new Mh;return this.array_.pop()};Ad.prototype.peek=function(){if(0===this.array_.length)throw new Mh;return this.array_[this.array_.length-1]};Ad.prototype.empty=function(){return 0===this.array_.length};Ad.prototype.isEmpty=function(){return this.empty()};Ad.prototype.search=function(h){return this.array_.indexOf(h)};
Ad.prototype.size=function(){return this.array_.length};Ad.prototype.toArray=function(){for(var h=[],m=0,q=this.array_.length;m<q;m++)h.push(this.array_[m]);return h};var Id=function(){this._minIndex=-1;this._orientedDe=this._minDe=this._minCoord=null};Id.prototype.getCoordinate=function(){return this._minCoord};Id.prototype.getRightmostSide=function(h,m){var q=this.getRightmostSideOfSegment(h,m);return 0>q&&(q=this.getRightmostSideOfSegment(h,m-1)),0>q&&(this._minCoord=null,this.checkForRightmostCoordinate(h)),
q};Id.prototype.findRightmostEdgeAtVertex=function(){var h=this._minDe.getEdge().getCoordinates();Xa.isTrue(0<this._minIndex&&this._minIndex<h.length,"rightmost point expected to be interior vertex of edge");var m=h[this._minIndex-1];h=h[this._minIndex+1];var q=Da.computeOrientation(this._minCoord,h,m),n=!1;(m.y<this._minCoord.y&&h.y<this._minCoord.y&&q===Da.COUNTERCLOCKWISE||m.y>this._minCoord.y&&h.y>this._minCoord.y&&q===Da.CLOCKWISE)&&(n=!0);n&&--this._minIndex};Id.prototype.getRightmostSideOfSegment=
function(h,m){h=h.getEdge().getCoordinates();if(0>m||m+1>=h.length||h[m].y===h[m+1].y)return-1;var q=Aa.LEFT;return h[m].y<h[m+1].y&&(q=Aa.RIGHT),q};Id.prototype.getEdge=function(){return this._orientedDe};Id.prototype.checkForRightmostCoordinate=function(h){for(var m=h.getEdge().getCoordinates(),q=0;q<m.length-1;q++)(null===this._minCoord||m[q].x>this._minCoord.x)&&(this._minDe=h,this._minIndex=q,this._minCoord=m[q])};Id.prototype.findRightmostEdgeAtNode=function(){this._minDe=this._minDe.getNode().getEdges().getRightmostEdge();
this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Id.prototype.findEdge=function(h){for(h=h.iterator();h.hasNext();){var m=h.next();m.isForward()&&this.checkForRightmostCoordinate(m)}Xa.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing");0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex();this._orientedDe=this._minDe;this.getRightmostSide(this._minDe,
this._minIndex)===Aa.LEFT&&(this._orientedDe=this._minDe.getSym())};Id.prototype.interfaces_=function(){return[]};Id.prototype.getClass=function(){return Id};var we=function(h){function m(q,n){h.call(this,m.msgWithCoord(q,n));this.pt=n?new sa(n):null;this.name="TopologyException"}return h&&(m.__proto__=h),m.prototype=Object.create(h&&h.prototype),m.prototype.constructor=m,m.prototype.getCoordinate=function(){return this.pt},m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},
m.msgWithCoord=function(q,n){return n?q:q+" [ "+n+" ]"},m}(re),gi=function(){this.array_=[]};gi.prototype.addLast=function(h){this.array_.push(h)};gi.prototype.removeFirst=function(){return this.array_.shift()};gi.prototype.isEmpty=function(){return 0===this.array_.length};var Ic=function(){this._finder=null;this._dirEdgeList=new Fa;this._nodes=new Fa;this._env=this._rightMostCoord=null;this._finder=new Id};Ic.prototype.clearVisitedEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();)h.next().setVisited(!1)};
Ic.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Ic.prototype.computeNodeDepth=function(h){for(var m=null,q=h.getEdges().iterator();q.hasNext();){var n=q.next();if(n.isVisited()||n.getSym().isVisited()){m=n;break}}if(null===m)throw new we("unable to find edge to compute depths at "+h.getCoordinate());h.getEdges().computeDepths(m);for(h=h.getEdges().iterator();h.hasNext();)m=h.next(),m.setVisited(!0),this.copySymDepths(m)};Ic.prototype.computeDepth=function(h){this.clearVisitedEdges();
var m=this._finder.getEdge();m.setEdgeDepths(Aa.RIGHT,h);this.copySymDepths(m);this.computeDepths(m)};Ic.prototype.create=function(h){this.addReachable(h);this._finder.findEdge(this._dirEdgeList);this._rightMostCoord=this._finder.getCoordinate()};Ic.prototype.findResultEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();){var m=h.next();1<=m.getDepth(Aa.RIGHT)&&0>=m.getDepth(Aa.LEFT)&&!m.isInteriorAreaEdge()&&m.setInResult(!0)}};Ic.prototype.computeDepths=function(h){var m=new Hj,
q=new gi,n=h.getNode();q.addLast(n);m.add(n);for(h.setVisited(!0);!q.isEmpty();)for(h=q.removeFirst(),m.add(h),this.computeNodeDepth(h),h=h.getEdges().iterator();h.hasNext();)n=h.next().getSym(),n.isVisited()||(n=n.getNode(),m.contains(n)||(q.addLast(n),m.add(n)))};Ic.prototype.compareTo=function(h){return this._rightMostCoord.x<h._rightMostCoord.x?-1:this._rightMostCoord.x>h._rightMostCoord.x?1:0};Ic.prototype.getEnvelope=function(){if(null===this._env){for(var h=new Ia,m=this._dirEdgeList.iterator();m.hasNext();)for(var q=
m.next().getEdge().getCoordinates(),n=0;n<q.length-1;n++)h.expandToInclude(q[n]);this._env=h}return this._env};Ic.prototype.addReachable=function(h){var m=new Ad;for(m.add(h);!m.empty();)h=m.pop(),this.add(h,m)};Ic.prototype.copySymDepths=function(h){var m=h.getSym();m.setDepth(Aa.LEFT,h.getDepth(Aa.RIGHT));m.setDepth(Aa.RIGHT,h.getDepth(Aa.LEFT))};Ic.prototype.add=function(h,m){h.setVisited(!0);this._nodes.add(h);for(h=h.getEdges().iterator();h.hasNext();){var q=h.next();this._dirEdgeList.add(q);
q=q.getSym().getNode();q.isVisited()||m.push(q)}};Ic.prototype.getNodes=function(){return this._nodes};Ic.prototype.getDirectedEdges=function(){return this._dirEdgeList};Ic.prototype.interfaces_=function(){return[jd]};Ic.prototype.getClass=function(){return Ic};var Qb=function m(){if(this.location=null,1===arguments.length)if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var q=arguments[0];this.init(1);this.location[Aa.ON]=q}else{if(arguments[0]instanceof
m&&(q=arguments[0],this.init(q.location.length),null!==q))for(var n=0;n<this.location.length;n++)this.location[n]=q.location[n]}else if(3===arguments.length){q=arguments[0];n=arguments[1];var r=arguments[2];this.init(3);this.location[Aa.ON]=q;this.location[Aa.LEFT]=n;this.location[Aa.RIGHT]=r}};Qb.prototype.setAllLocations=function(m){for(var q=0;q<this.location.length;q++)this.location[q]=m};Qb.prototype.isNull=function(){for(var m=0;m<this.location.length;m++)if(this.location[m]!==ua.NONE)return!1;
return!0};Qb.prototype.setAllLocationsIfNull=function(m){for(var q=0;q<this.location.length;q++)this.location[q]===ua.NONE&&(this.location[q]=m)};Qb.prototype.isLine=function(){return 1===this.location.length};Qb.prototype.merge=function(m){if(m.location.length>this.location.length){var q=Array(3).fill(null);q[Aa.ON]=this.location[Aa.ON];q[Aa.LEFT]=ua.NONE;q[Aa.RIGHT]=ua.NONE;this.location=q}for(q=0;q<this.location.length;q++)this.location[q]===ua.NONE&&q<m.location.length&&(this.location[q]=m.location[q])};
Qb.prototype.getLocations=function(){return this.location};Qb.prototype.flip=function(){if(1>=this.location.length)return null;var m=this.location[Aa.LEFT];this.location[Aa.LEFT]=this.location[Aa.RIGHT];this.location[Aa.RIGHT]=m};Qb.prototype.toString=function(){var m=new Cd;return 1<this.location.length&&m.append(ua.toLocationSymbol(this.location[Aa.LEFT])),m.append(ua.toLocationSymbol(this.location[Aa.ON])),1<this.location.length&&m.append(ua.toLocationSymbol(this.location[Aa.RIGHT])),m.toString()};
Qb.prototype.setLocations=function(m,q,n){this.location[Aa.ON]=m;this.location[Aa.LEFT]=q;this.location[Aa.RIGHT]=n};Qb.prototype.get=function(m){return m<this.location.length?this.location[m]:ua.NONE};Qb.prototype.isArea=function(){return 1<this.location.length};Qb.prototype.isAnyNull=function(){for(var m=0;m<this.location.length;m++)if(this.location[m]===ua.NONE)return!0;return!1};Qb.prototype.setLocation=function(){1===arguments.length?this.setLocation(Aa.ON,arguments[0]):2===arguments.length&&
(this.location[arguments[0]]=arguments[1])};Qb.prototype.init=function(m){this.location=Array(m).fill(null);this.setAllLocations(ua.NONE)};Qb.prototype.isEqualOnSide=function(m,q){return this.location[q]===m.location[q]};Qb.prototype.allPositionsEqual=function(m){for(var q=0;q<this.location.length;q++)if(this.location[q]!==m)return!1;return!0};Qb.prototype.interfaces_=function(){return[]};Qb.prototype.getClass=function(){return Qb};var Jb=function q(){if(this.elt=Array(2).fill(null),1===arguments.length)if(Number.isInteger(arguments[0])){var n=
arguments[0];this.elt[0]=new Qb(n);this.elt[1]=new Qb(n)}else arguments[0]instanceof q&&(n=arguments[0],this.elt[0]=new Qb(n.elt[0]),this.elt[1]=new Qb(n.elt[1]));else if(2===arguments.length){n=arguments[0];var r=arguments[1];this.elt[0]=new Qb(ua.NONE);this.elt[1]=new Qb(ua.NONE);this.elt[n].setLocation(r)}else if(3===arguments.length){n=arguments[0];r=arguments[1];var v=arguments[2];this.elt[0]=new Qb(n,r,v);this.elt[1]=new Qb(n,r,v)}else if(4===arguments.length){n=arguments[0];r=arguments[1];
v=arguments[2];var z=arguments[3];this.elt[0]=new Qb(ua.NONE,ua.NONE,ua.NONE);this.elt[1]=new Qb(ua.NONE,ua.NONE,ua.NONE);this.elt[n].setLocations(r,v,z)}};Jb.prototype.getGeometryCount=function(){var q=0;return this.elt[0].isNull()||q++,this.elt[1].isNull()||q++,q};Jb.prototype.setAllLocations=function(q,n){this.elt[q].setAllLocations(n)};Jb.prototype.isNull=function(q){return this.elt[q].isNull()};Jb.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var q=arguments[0];this.setAllLocationsIfNull(0,
q);this.setAllLocationsIfNull(1,q)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])};Jb.prototype.isLine=function(q){return this.elt[q].isLine()};Jb.prototype.merge=function(q){for(var n=0;2>n;n++)null===this.elt[n]&&null!==q.elt[n]?this.elt[n]=new Qb(q.elt[n]):this.elt[n].merge(q.elt[n])};Jb.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip()};Jb.prototype.getLocation=function(){if(1===arguments.length)return this.elt[arguments[0]].get(Aa.ON);if(2===
arguments.length)return this.elt[arguments[0]].get(arguments[1])};Jb.prototype.toString=function(){var q=new Cd;return null!==this.elt[0]&&(q.append("A:"),q.append(this.elt[0].toString())),null!==this.elt[1]&&(q.append(" B:"),q.append(this.elt[1].toString())),q.toString()};Jb.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length)return this.elt[arguments[0]].isArea()};Jb.prototype.isAnyNull=function(q){return this.elt[q].isAnyNull()};
Jb.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(Aa.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])};Jb.prototype.isEqualOnSide=function(q,n){return this.elt[0].isEqualOnSide(q.elt[0],n)&&this.elt[1].isEqualOnSide(q.elt[1],n)};Jb.prototype.allPositionsEqual=function(q,n){return this.elt[q].allPositionsEqual(n)};Jb.prototype.toLine=function(q){this.elt[q].isArea()&&(this.elt[q]=new Qb(this.elt[q].location[0]))};
Jb.prototype.interfaces_=function(){return[]};Jb.prototype.getClass=function(){return Jb};Jb.toLineLabel=function(q){for(var n=new Jb(ua.NONE),r=0;2>r;r++)n.setLocation(r,q.getLocation(r));return n};var ic=function(q,n){this._startDe=null;this._maxNodeDegree=-1;this._edges=new Fa;this._pts=new Fa;this._label=new Jb(ua.NONE);this._shell=this._isHole=this._ring=null;this._holes=new Fa;this._geometryFactory=n;this.computePoints(q);this.computeRing()};ic.prototype.computeRing=function(){if(null!==this._ring)return null;
for(var q=Array(this._pts.size()).fill(null),n=0;n<this._pts.size();n++)q[n]=this._pts.get(n);this._ring=this._geometryFactory.createLinearRing(q);this._isHole=Da.isCCW(this._ring.getCoordinates())};ic.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()};ic.prototype.computePoints=function(q){this._startDe=q;var n=!0;do{if(null===q)throw new we("Found null DirectedEdge");if(q.getEdgeRing()===this)throw new we("Directed Edge visited twice during ring-building at "+q.getCoordinate());
this._edges.add(q);var r=q.getLabel();Xa.isTrue(r.isArea());this.mergeLabel(r);this.addPoints(q.getEdge(),q.isForward(),n);n=!1;this.setEdgeRing(q,this);q=this.getNext(q)}while(q!==this._startDe)};ic.prototype.getLinearRing=function(){return this._ring};ic.prototype.getCoordinate=function(q){return this._pts.get(q)};ic.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var q=this._startDe;do{var n=q.getNode().getEdges().getOutgoingDegree(this);n>this._maxNodeDegree&&(this._maxNodeDegree=
n);q=this.getNext(q)}while(q!==this._startDe);this._maxNodeDegree*=2};ic.prototype.addPoints=function(q,n,r){q=q.getCoordinates();if(n)for(n=1,r&&(n=0),r=n;r<q.length;r++)this._pts.add(q[r]);else for(n=q.length-2,r&&(n=q.length-1),r=n;0<=r;r--)this._pts.add(q[r])};ic.prototype.isHole=function(){return this._isHole};ic.prototype.setInResult=function(){var q=this._startDe;do q.getEdge().setInResult(!0),q=q.getNext();while(q!==this._startDe)};ic.prototype.containsPoint=function(q){var n=this.getLinearRing();
if(!n.getEnvelopeInternal().contains(q)||!Da.isPointInRing(q,n.getCoordinates()))return!1;for(n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(q))return!1;return!0};ic.prototype.addHole=function(q){this._holes.add(q)};ic.prototype.isShell=function(){return null===this._shell};ic.prototype.getLabel=function(){return this._label};ic.prototype.getEdges=function(){return this._edges};ic.prototype.getMaxNodeDegree=function(){return 0>this._maxNodeDegree&&this.computeMaxNodeDegree(),this._maxNodeDegree};
ic.prototype.getShell=function(){return this._shell};ic.prototype.mergeLabel=function(){if(1===arguments.length){var q=arguments[0];this.mergeLabel(q,0);this.mergeLabel(q,1)}else if(2===arguments.length){q=arguments[1];var n=arguments[0].getLocation(q,Aa.RIGHT);if(n===ua.NONE)return null;if(this._label.getLocation(q)===ua.NONE)return this._label.setLocation(q,n),null}};ic.prototype.setShell=function(q){this._shell=q;null!==q&&q.addHole(this)};ic.prototype.toPolygon=function(q){for(var n=Array(this._holes.size()).fill(null),
r=0;r<this._holes.size();r++)n[r]=this._holes.get(r).getLinearRing();return q.createPolygon(this.getLinearRing(),n)};ic.prototype.interfaces_=function(){return[]};ic.prototype.getClass=function(){return ic};var Bp=function(q){function n(r,v){q.call(this,r,v)}return q&&(n.__proto__=q),n.prototype=Object.create(q&&q.prototype),n.prototype.constructor=n,n.prototype.setEdgeRing=function(r,v){r.setMinEdgeRing(v)},n.prototype.getNext=function(r){return r.getNextMin()},n.prototype.interfaces_=function(){return[]},
n.prototype.getClass=function(){return n},n}(ic),Cp=function(q){function n(r,v){q.call(this,r,v)}return q&&(n.__proto__=q),n.prototype=Object.create(q&&q.prototype),n.prototype.constructor=n,n.prototype.buildMinimalRings=function(){var r=new Fa,v=this._startDe;do{if(null===v.getMinEdgeRing()){var z=new Bp(v,this._geometryFactory);r.add(z)}v=v.getNext()}while(v!==this._startDe);return r},n.prototype.setEdgeRing=function(r,v){r.setEdgeRing(v)},n.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=
this._startDe;do r.getNode().getEdges().linkMinimalDirectedEdges(this),r=r.getNext();while(r!==this._startDe)},n.prototype.getNext=function(r){return r.getNext()},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(ic),dd=function(){(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length)&&1===arguments.length&&(this._label=arguments[0])};dd.prototype.setVisited=function(q){this._isVisited=q};dd.prototype.setInResult=
function(q){this._isInResult=q};dd.prototype.isCovered=function(){return this._isCovered};dd.prototype.isCoveredSet=function(){return this._isCoveredSet};dd.prototype.setLabel=function(q){this._label=q};dd.prototype.getLabel=function(){return this._label};dd.prototype.setCovered=function(q){this._isCovered=q;this._isCoveredSet=!0};dd.prototype.updateIM=function(q){Xa.isTrue(2<=this._label.getGeometryCount(),"found partial label");this.computeIM(q)};dd.prototype.isInResult=function(){return this._isInResult};
dd.prototype.isVisited=function(){return this._isVisited};dd.prototype.interfaces_=function(){return[]};dd.prototype.getClass=function(){return dd};var hi=function(q){function n(r,v){q.call(this);this._coord=r;this._edges=v;this._label=new Jb(0,ua.NONE)}return q&&(n.__proto__=q),n.prototype=Object.create(q&&q.prototype),n.prototype.constructor=n,n.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();)if(r.next().getEdge().isInResult())return!0;return!1},
n.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},n.prototype.getCoordinate=function(){return this._coord},n.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},n.prototype.computeIM=function(r){},n.prototype.computeMergedLocation=function(r,v){var z;(z=this._label.getLocation(v),r.isNull(v))||(r=r.getLocation(v),z!==ua.BOUNDARY&&(z=r));return z},n.prototype.setLabel=function(){if(2!==arguments.length)return q.prototype.setLabel.apply(this,arguments);
var r=arguments[0],v=arguments[1];null===this._label?this._label=new Jb(r,v):this._label.setLocation(r,v)},n.prototype.getEdges=function(){return this._edges},n.prototype.mergeLabel=function(r){if(r instanceof n)this.mergeLabel(r._label);else if(r instanceof Jb)for(var v=0;2>v;v++){var z=this.computeMergedLocation(r,v);this._label.getLocation(v)===ua.NONE&&this._label.setLocation(v,z)}},n.prototype.add=function(r){this._edges.insert(r);r.setNode(this)},n.prototype.setLabelBoundary=function(r){if(null===
this._label)return null;var v=ua.NONE;null!==this._label&&(v=this._label.getLocation(r));switch(v){case ua.BOUNDARY:v=ua.INTERIOR;break;default:v=ua.BOUNDARY}this._label.setLocation(r,v)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(dd),Jd=function(q){this.nodeMap=new Ac;this.nodeFact=q};Jd.prototype.find=function(q){return this.nodeMap.get(q)};Jd.prototype.addNode=function(q){if(q instanceof sa){var n=this.nodeMap.get(q);return null===n&&(n=this.nodeFact.createNode(q),
this.nodeMap.put(q,n)),n}if(q instanceof hi)return n=this.nodeMap.get(q.getCoordinate()),null===n?(this.nodeMap.put(q.getCoordinate(),q),q):(n.mergeLabel(q),n)};Jd.prototype.print=function(q){for(var n=this.iterator();n.hasNext();)n.next().print(q)};Jd.prototype.iterator=function(){return this.nodeMap.values().iterator()};Jd.prototype.values=function(){return this.nodeMap.values()};Jd.prototype.getBoundaryNodes=function(q){for(var n=new Fa,r=this.iterator();r.hasNext();){var v=r.next();v.getLabel().getLocation(q)===
ua.BOUNDARY&&n.add(v)}return n};Jd.prototype.add=function(q){var n=q.getCoordinate();this.addNode(n).add(q)};Jd.prototype.interfaces_=function(){return[]};Jd.prototype.getClass=function(){return Jd};var Mb=function(){},$g={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Mb.prototype.interfaces_=function(){return[]};Mb.prototype.getClass=function(){return Mb};Mb.isNorthern=function(q){return q===Mb.NE||q===Mb.NW};Mb.isOpposite=function(q,n){return q!==n&&2===(q-
n+4)%4};Mb.commonHalfPlane=function(q,n){if(q===n)return q;if(2===(q-n+4)%4)return-1;var r=q<n?q:n;return 0===r&&3===(q>n?q:n)?3:r};Mb.isInHalfPlane=function(q,n){return n===Mb.SE?q===Mb.SE||q===Mb.SW:q===n||q===n+1};Mb.quadrant=function(q,n){if("number"==typeof q&&"number"==typeof n){if(0===q&&0===n)throw new ac("Cannot compute the quadrant for point ( "+q+", "+n+" )");return 0<=q?0<=n?Mb.NE:Mb.SE:0<=n?Mb.NW:Mb.SW}if(q instanceof sa&&n instanceof sa){if(n.x===q.x&&n.y===q.y)throw new ac("Cannot compute the quadrant for two identical points "+
q);return n.x>=q.x?n.y>=q.y?Mb.NE:Mb.SE:n.y>=q.y?Mb.NW:Mb.SW}};$g.NE.get=function(){return 0};$g.NW.get=function(){return 1};$g.SW.get=function(){return 2};$g.SE.get=function(){return 3};Object.defineProperties(Mb,$g);var Bc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var q=arguments[1],n=arguments[2];this._edge=arguments[0];this.init(q,
n);this._label=null}else if(4===arguments.length){q=arguments[1];n=arguments[2];var r=arguments[3];this._edge=arguments[0];this.init(q,n);this._label=r}};Bc.prototype.compareDirection=function(q){return this._dx===q._dx&&this._dy===q._dy?0:this._quadrant>q._quadrant?1:this._quadrant<q._quadrant?-1:Da.computeOrientation(q._p0,q._p1,this._p1)};Bc.prototype.getDy=function(){return this._dy};Bc.prototype.getCoordinate=function(){return this._p0};Bc.prototype.setNode=function(q){this._node=q};Bc.prototype.print=
function(q){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),v=r.lastIndexOf(".");r=r.substring(v+1);q.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Bc.prototype.compareTo=function(q){return this.compareDirection(q)};Bc.prototype.getDirectedCoordinate=function(){return this._p1};Bc.prototype.getDx=function(){return this._dx};Bc.prototype.getLabel=function(){return this._label};Bc.prototype.getEdge=function(){return this._edge};Bc.prototype.getQuadrant=
function(){return this._quadrant};Bc.prototype.getNode=function(){return this._node};Bc.prototype.toString=function(){var q=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf(".");return"  "+n.substring(r+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+q+"   "+this._label};Bc.prototype.computeLabel=function(q){};Bc.prototype.init=function(q,n){this._p0=q;this._p1=n;this._dx=n.x-q.x;this._dy=n.y-q.y;this._quadrant=Mb.quadrant(this._dx,this._dy);Xa.isTrue(!(0===this._dx&&
0===this._dy),"EdgeEnd with identical endpoints found")};Bc.prototype.interfaces_=function(){return[jd]};Bc.prototype.getClass=function(){return Bc};var Mj=function(q){function n(r,v){(q.call(this,r),this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=v,v)?this.init(r.getCoordinate(0),r.getCoordinate(1)):(v=r.getNumPoints()-1,this.init(r.getCoordinate(v),r.getCoordinate(v-1)));
this.computeDirectedLabel()}return q&&(n.__proto__=q),n.prototype=Object.create(q&&q.prototype),n.prototype.constructor=n,n.prototype.getNextMin=function(){return this._nextMin},n.prototype.getDepth=function(r){return this._depth[r]},n.prototype.setVisited=function(r){this._isVisited=r},n.prototype.computeDirectedLabel=function(){this._label=new Jb(this._edge.getLabel());this._isForward||this._label.flip()},n.prototype.getNext=function(){return this._next},n.prototype.setDepth=function(r,v){if(-999!==
this._depth[r]&&this._depth[r]!==v)throw new we("assigned depths do not match",this.getCoordinate());this._depth[r]=v},n.prototype.isInteriorAreaEdge=function(){for(var r=!0,v=0;2>v;v++)this._label.isArea(v)&&this._label.getLocation(v,Aa.LEFT)===ua.INTERIOR&&this._label.getLocation(v,Aa.RIGHT)===ua.INTERIOR||(r=!1);return r},n.prototype.setNextMin=function(r){this._nextMin=r},n.prototype.print=function(r){q.prototype.print.call(this,r);r.print(" "+this._depth[Aa.LEFT]+"/"+this._depth[Aa.RIGHT]);r.print(" ("+
this.getDepthDelta()+")");this._isInResult&&r.print(" inResult")},n.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},n.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),v=!this._label.isArea(0)||this._label.allPositionsEqual(0,ua.EXTERIOR),z=!this._label.isArea(1)||this._label.allPositionsEqual(1,ua.EXTERIOR);return r&&v&&z},n.prototype.setEdgeRing=function(r){this._edgeRing=r},n.prototype.getMinEdgeRing=function(){return this._minEdgeRing},n.prototype.getDepthDelta=
function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},n.prototype.setInResult=function(r){this._isInResult=r},n.prototype.getSym=function(){return this._sym},n.prototype.isForward=function(){return this._isForward},n.prototype.getEdge=function(){return this._edge},n.prototype.printEdge=function(r){this.print(r);r.print(" ");this._isForward?this._edge.print(r):this._edge.printReverse(r)},n.prototype.setSym=function(r){this._sym=r},n.prototype.setVisitedEdge=function(r){this.setVisited(r);
this._sym.setVisited(r)},n.prototype.setEdgeDepths=function(r,v){var z=this.getEdge().getDepthDelta();this._isForward||(z=-z);var u=1;r===Aa.LEFT&&(u=-1);var y=Aa.opposite(r);z=v+z*u;this.setDepth(r,v);this.setDepth(y,z)},n.prototype.getEdgeRing=function(){return this._edgeRing},n.prototype.isInResult=function(){return this._isInResult},n.prototype.setNext=function(r){this._next=r},n.prototype.isVisited=function(){return this._isVisited},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=
function(){return n},n.depthFactor=function(r,v){return r===ua.EXTERIOR&&v===ua.INTERIOR?1:r===ua.INTERIOR&&v===ua.EXTERIOR?-1:0},n}(Bc),bg=function(){};bg.prototype.createNode=function(q){return new hi(q,null)};bg.prototype.interfaces_=function(){return[]};bg.prototype.getClass=function(){return bg};var Yb=function(){(this._edges=new Fa,this._nodes=null,this._edgeEndList=new Fa,0===arguments.length)?this._nodes=new Jd(new bg):1===arguments.length&&(this._nodes=new Jd(arguments[0]))};Yb.prototype.printEdges=
function(q){q.println("Edges:");for(var n=0;n<this._edges.size();n++){q.println("edge "+n+":");var r=this._edges.get(n);r.print(q);r.eiList.print(q)}};Yb.prototype.find=function(q){return this._nodes.find(q)};Yb.prototype.addNode=function(q){if(q instanceof hi||q instanceof sa)return this._nodes.addNode(q)};Yb.prototype.getNodeIterator=function(){return this._nodes.iterator()};Yb.prototype.linkResultDirectedEdges=function(){for(var q=this._nodes.iterator();q.hasNext();)q.next().getEdges().linkResultDirectedEdges()};
Yb.prototype.debugPrintln=function(q){Oc.out.println(q)};Yb.prototype.isBoundaryNode=function(q,n){n=this._nodes.find(n);if(null===n)return!1;n=n.getLabel();return null!==n&&n.getLocation(q)===ua.BOUNDARY};Yb.prototype.linkAllDirectedEdges=function(){for(var q=this._nodes.iterator();q.hasNext();)q.next().getEdges().linkAllDirectedEdges()};Yb.prototype.matchInSameDirection=function(q,n,r,v){return!!q.equals(r)&&Da.computeOrientation(q,n,v)===Da.COLLINEAR&&Mb.quadrant(q,n)===Mb.quadrant(r,v)};Yb.prototype.getEdgeEnds=
function(){return this._edgeEndList};Yb.prototype.debugPrint=function(q){Oc.out.print(q)};Yb.prototype.getEdgeIterator=function(){return this._edges.iterator()};Yb.prototype.findEdgeInSameDirection=function(q,n){for(var r=0;r<this._edges.size();r++){var v=this._edges.get(r),z=v.getCoordinates();if(this.matchInSameDirection(q,n,z[0],z[1])||this.matchInSameDirection(q,n,z[z.length-1],z[z.length-2]))return v}return null};Yb.prototype.insertEdge=function(q){this._edges.add(q)};Yb.prototype.findEdgeEnd=
function(q){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===q)return r}return null};Yb.prototype.addEdges=function(q){for(q=q.iterator();q.hasNext();){var n=q.next();this._edges.add(n);var r=new Mj(n,!0);n=new Mj(n,!1);r.setSym(n);n.setSym(r);this.add(r);this.add(n)}};Yb.prototype.add=function(q){this._nodes.add(q);this._edgeEndList.add(q)};Yb.prototype.getNodes=function(){return this._nodes.values()};Yb.prototype.findEdge=function(q,n){for(var r=0;r<this._edges.size();r++){var v=
this._edges.get(r),z=v.getCoordinates();if(q.equals(z[0])&&n.equals(z[1]))return v}return null};Yb.prototype.interfaces_=function(){return[]};Yb.prototype.getClass=function(){return Yb};Yb.linkResultDirectedEdges=function(q){for(q=q.iterator();q.hasNext();)q.next().getEdges().linkResultDirectedEdges()};var Yc=function(q){this._geometryFactory=null;this._shellList=new Fa;this._geometryFactory=q};Yc.prototype.sortShellsAndHoles=function(q,n,r){for(q=q.iterator();q.hasNext();){var v=q.next();v.isHole()?
r.add(v):n.add(v)}};Yc.prototype.computePolygons=function(q){var n=new Fa;for(q=q.iterator();q.hasNext();){var r=q.next().toPolygon(this._geometryFactory);n.add(r)}return n};Yc.prototype.placeFreeHoles=function(q,n){for(n=n.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var v=this.findEdgeRingContaining(r,q);if(null===v)throw new we("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(v)}}};Yc.prototype.buildMinimalEdgeRings=function(q,n,r){var v=new Fa;for(q=q.iterator();q.hasNext();){var z=
q.next();if(2<z.getMaxNodeDegree()){z.linkDirectedEdgesForMinimalEdgeRings();z=z.buildMinimalRings();var u=this.findShell(z);null!==u?(this.placePolygonHoles(u,z),n.add(u)):r.addAll(z)}else v.add(z)}return v};Yc.prototype.containsPoint=function(q){for(var n=this._shellList.iterator();n.hasNext();)if(n.next().containsPoint(q))return!0;return!1};Yc.prototype.buildMaximalEdgeRings=function(q){var n=new Fa;for(q=q.iterator();q.hasNext();){var r=q.next();r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()&&
(r=new Cp(r,this._geometryFactory),n.add(r),r.setInResult())}return n};Yc.prototype.placePolygonHoles=function(q,n){for(n=n.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(q)}};Yc.prototype.getPolygons=function(){return this.computePolygons(this._shellList)};Yc.prototype.findEdgeRingContaining=function(q,n){var r=q.getLinearRing();q=r.getEnvelopeInternal();r=r.getCoordinateN(0);var v=null,z=null;for(n=n.iterator();n.hasNext();){var u=n.next(),y=u.getLinearRing(),C=y.getEnvelopeInternal();
null!==v&&(z=v.getLinearRing().getEnvelopeInternal());var w=!1;C.contains(q)&&Da.isPointInRing(r,y.getCoordinates())&&(w=!0);w&&(null===v||z.contains(C))&&(v=u)}return v};Yc.prototype.findShell=function(q){var n=0,r=null;for(q=q.iterator();q.hasNext();){var v=q.next();v.isHole()||(r=v,n++)}return Xa.isTrue(1>=n,"found two shells in MinimalEdgeRing list"),r};Yc.prototype.add=function(){if(1===arguments.length){var q=arguments[0];this.add(q.getEdgeEnds(),q.getNodes())}else if(2===arguments.length){q=
arguments[0];Yb.linkResultDirectedEdges(arguments[1]);var n=this.buildMaximalEdgeRings(q);q=new Fa;n=this.buildMinimalEdgeRings(n,this._shellList,q);this.sortShellsAndHoles(n,this._shellList,q);this.placeFreeHoles(this._shellList,q)}};Yc.prototype.interfaces_=function(){return[]};Yc.prototype.getClass=function(){return Yc};var cg=function(){};cg.prototype.getBounds=function(){};cg.prototype.interfaces_=function(){return[]};cg.prototype.getClass=function(){return cg};var vd=function(q,n){this._bounds=
q;this._item=n};vd.prototype.getItem=function(){return this._item};vd.prototype.getBounds=function(){return this._bounds};vd.prototype.interfaces_=function(){return[cg,id]};vd.prototype.getClass=function(){return vd};var xe=function(){this._items=null;this._size=0;this._items=new Fa;this._items.add(null)};xe.prototype.poll=function(){if(this.isEmpty())return null;var q=this._items.get(1);return this._items.set(1,this._items.get(this._size)),--this._size,this.reorder(1),q};xe.prototype.size=function(){return this._size};
xe.prototype.reorder=function(q){for(var n=null,r=this._items.get(q);2*q<=this._size&&((n=2*q)!==this._size&&0>this._items.get(n+1).compareTo(this._items.get(n))&&n++,0>this._items.get(n).compareTo(r));q=n)this._items.set(q,this._items.get(n));this._items.set(q,r)};xe.prototype.clear=function(){this._size=0;this._items.clear()};xe.prototype.isEmpty=function(){return 0===this._size};xe.prototype.add=function(q){this._items.add(null);var n=this._size+=1;for(this._items.set(0,q);0>q.compareTo(this._items.get(Math.trunc(n/
2)));n/=2)this._items.set(n,this._items.get(Math.trunc(n/2)));this._items.set(n,q)};xe.prototype.interfaces_=function(){return[]};xe.prototype.getClass=function(){return xe};var Ge=function(){};Ge.prototype.visitItem=function(q){};Ge.prototype.interfaces_=function(){return[]};Ge.prototype.getClass=function(){return Ge};var tf=function(){};tf.prototype.insert=function(q,n){};tf.prototype.remove=function(q,n){};tf.prototype.query=function(){};tf.prototype.interfaces_=function(){return[]};tf.prototype.getClass=
function(){return tf};var oc=function(){(this._childBoundables=new Fa,this._bounds=null,this._level=null,0!==arguments.length)&&1===arguments.length&&(this._level=arguments[0])},nn={serialVersionUID:{configurable:!0}};oc.prototype.getLevel=function(){return this._level};oc.prototype.size=function(){return this._childBoundables.size()};oc.prototype.getChildBoundables=function(){return this._childBoundables};oc.prototype.addChildBoundable=function(q){Xa.isTrue(null===this._bounds);this._childBoundables.add(q)};
oc.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};oc.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds};oc.prototype.interfaces_=function(){return[cg,id]};oc.prototype.getClass=function(){return oc};nn.serialVersionUID.get=function(){return 0x5a1e55ec41369800};Object.defineProperties(oc,nn);var Kd=function(){};Kd.reverseOrder=function(){return{compare:function(q,n){return n.compareTo(q)}}};Kd.min=function(q){return Kd.sort(q),
q.get(0)};Kd.sort=function(q,n){var r=q.toArray();n?Ue.sort(r,n):Ue.sort(r);q=q.iterator();n=0;for(var v=r.length;n<v;n++)q.next(),q.set(r[n])};Kd.singletonList=function(q){var n=new Fa;return n.add(q),n};var jc=function(q,n,r){this._distance=null;this._boundable1=q;this._boundable2=n;this._itemDistance=r;this._distance=this.distance()};jc.prototype.expandToQueue=function(q,n){var r=jc.isComposite(this._boundable1),v=jc.isComposite(this._boundable2);if(r&&v)return jc.area(this._boundable1)>jc.area(this._boundable2)?
(this.expand(this._boundable1,this._boundable2,q,n),null):(this.expand(this._boundable2,this._boundable1,q,n),null);if(r)return this.expand(this._boundable1,this._boundable2,q,n),null;if(v)return this.expand(this._boundable2,this._boundable1,q,n),null;throw new ac("neither boundable is composite");};jc.prototype.isLeaves=function(){return!(jc.isComposite(this._boundable1)||jc.isComposite(this._boundable2))};jc.prototype.compareTo=function(q){return this._distance<q._distance?-1:this._distance>q._distance?
1:0};jc.prototype.expand=function(q,n,r,v){for(q=q.getChildBoundables().iterator();q.hasNext();){var z=q.next();z=new jc(z,n,this._itemDistance);z.getDistance()<v&&r.add(z)}};jc.prototype.getBoundable=function(q){return 0===q?this._boundable1:this._boundable2};jc.prototype.getDistance=function(){return this._distance};jc.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};
jc.prototype.interfaces_=function(){return[jd]};jc.prototype.getClass=function(){return jc};jc.area=function(q){return q.getBounds().getArea()};jc.isComposite=function(q){return q instanceof oc};var rc=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new Fa,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=n.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var r=arguments[0];Xa.isTrue(1<r,"Node capacity must be greater than 1");this._nodeCapacity=r}},ii={IntersectsOp:{configurable:!0},
serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};rc.prototype.getNodeCapacity=function(){return this._nodeCapacity};rc.prototype.lastNode=function(n){return n.get(n.size()-1)};rc.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var n=0,r=arguments[0].getChildBoundables().iterator();r.hasNext();){var v=r.next();v instanceof oc?n+=this.size(v):v instanceof vd&&(n+=1)}return n}};rc.prototype.removeItem=
function(n,r){for(var v=null,z=n.getChildBoundables().iterator();z.hasNext();){var u=z.next();u instanceof vd&&u.getItem()===r&&(v=u)}return null!==v&&(n.getChildBoundables().remove(v),!0)};rc.prototype.itemsTree=function(){if(0===arguments.length){this.build();var n=this.itemsTree(this._root);return null===n?new Fa:n}if(1===arguments.length){var r=arguments[0];n=new Fa;for(r=r.getChildBoundables().iterator();r.hasNext();){var v=r.next();v instanceof oc?(v=this.itemsTree(v),null!==v&&n.add(v)):v instanceof
vd?n.add(v.getItem()):Xa.shouldNeverReachHere()}return 0>=n.size()?null:n}};rc.prototype.insert=function(n,r){Xa.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built.");this._itemBoundables.add(new vd(n,r))};rc.prototype.boundablesAtLevel=function(){if(1===arguments.length){var n=arguments[0],r=new Fa;return this.boundablesAtLevel(n,this._root,r),r}if(3===arguments.length){n=arguments[0];var v=arguments[1];r=arguments[2];if(Xa.isTrue(-2<n),v.getLevel()===n)return r.add(v),
null;for(v=v.getChildBoundables().iterator();v.hasNext();){var z=v.next();z instanceof oc?this.boundablesAtLevel(n,z,r):(Xa.isTrue(z instanceof vd),-1===n&&r.add(z))}return null}};rc.prototype.query=function(){if(1===arguments.length){var n=arguments[0];this.build();var r=new Fa;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}if(2===arguments.length){n=arguments[0];r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),
n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(Va(arguments[2],Ge)&&arguments[0]instanceof Object&&arguments[1]instanceof oc){n=arguments[0];r=arguments[2];for(var v=arguments[1].getChildBoundables(),z=0;z<v.size();z++){var u=v.get(z);this.getIntersectsOp().intersects(u.getBounds(),n)&&(u instanceof oc?this.query(n,u,r):u instanceof vd?r.visitItem(u.getItem()):Xa.shouldNeverReachHere())}}else if(Va(arguments[2],ue)&&arguments[0]instanceof Object&&arguments[1]instanceof oc)for(n=arguments[0],
r=arguments[2],v=arguments[1].getChildBoundables(),z=0;z<v.size();z++)u=v.get(z),this.getIntersectsOp().intersects(u.getBounds(),n)&&(u instanceof oc?this.query(n,u,r):u instanceof vd?r.add(u.getItem()):Xa.shouldNeverReachHere())};rc.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1);this._itemBoundables=null;this._built=!0};rc.prototype.getRoot=function(){return this.build(),this._root};
rc.prototype.remove=function(){if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.remove(n,this._root,r)}if(3===arguments.length){n=arguments[0];r=arguments[1];var v=arguments[2],z=this.removeItem(r,v);if(z)return!0;for(var u=null,y=r.getChildBoundables().iterator();y.hasNext();){var C=y.next();if(this.getIntersectsOp().intersects(C.getBounds(),n)&&C instanceof oc&&(z=this.remove(n,C,v))){u=C;break}}return null!==
u&&u.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(u),z}};rc.prototype.createHigherLevels=function(n,r){Xa.isTrue(!n.isEmpty());n=this.createParentBoundables(n,r+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,r+1)};rc.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var n=0,r=arguments[0].getChildBoundables().iterator();r.hasNext();){var v=r.next();v instanceof oc&&(v=this.depth(v),
v>n&&(n=v))}return n+1}};rc.prototype.createParentBoundables=function(n,r){Xa.isTrue(!n.isEmpty());var v=new Fa;v.add(this.createNode(r));n=new Fa(n);Kd.sort(n,this.getComparator());for(n=n.iterator();n.hasNext();){var z=n.next();this.lastNode(v).getChildBoundables().size()===this.getNodeCapacity()&&v.add(this.createNode(r));this.lastNode(v).addChildBoundable(z)}return v};rc.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};rc.prototype.interfaces_=
function(){return[id]};rc.prototype.getClass=function(){return rc};rc.compareDoubles=function(n,r){return n>r?1:n<r?-1:0};ii.IntersectsOp.get=function(){return Dp};ii.serialVersionUID.get=function(){return-0x35ef64c82d4c5400};ii.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(rc,ii);var Dp=function(){},dg=function(){};dg.prototype.distance=function(n,r){};dg.prototype.interfaces_=function(){return[]};dg.prototype.getClass=function(){return dg};var Ep=function(n){function r(z){z=
z||r.DEFAULT_NODE_CAPACITY;n.call(this,z)}n&&(r.__proto__=n);r.prototype=Object.create(n&&n.prototype);r.prototype.constructor=r;var v={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return r.prototype.createParentBoundablesFromVerticalSlices=function(z,u){Xa.isTrue(0<z.length);for(var y=new Fa,C=0;C<z.length;C++)y.addAll(this.createParentBoundablesFromVerticalSlice(z[C],
u));return y},r.prototype.createNode=function(z){return new on(z)},r.prototype.size=function(){return 0===arguments.length?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},r.prototype.insert=function(){if(2!==arguments.length)return n.prototype.insert.apply(this,arguments);var z=arguments[0],u=arguments[1];if(z.isNull())return null;n.prototype.insert.call(this,z,u)},r.prototype.getIntersectsOp=function(){return r.intersectsOp},r.prototype.verticalSlices=function(z,u){var y=Math.trunc(Math.ceil(z.size()/
u)),C=Array(u).fill(null);z=z.iterator();for(var w=0;w<u;w++){C[w]=new Fa;for(var x=0;z.hasNext()&&x<y;){var B=z.next();C[w].add(B);x++}}return C},r.prototype.query=function(){if(1===arguments.length)return n.prototype.query.call(this,arguments[0]);2===arguments.length?n.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Va(arguments[2],Ge)&&arguments[0]instanceof Object&&arguments[1]instanceof oc?n.prototype.query.call(this,arguments[0],arguments[1],arguments[2]):Va(arguments[2],
ue)&&arguments[0]instanceof Object&&arguments[1]instanceof oc&&n.prototype.query.call(this,arguments[0],arguments[1],arguments[2]))},r.prototype.getComparator=function(){return r.yComparator},r.prototype.createParentBoundablesFromVerticalSlice=function(z,u){return n.prototype.createParentBoundables.call(this,z,u)},r.prototype.remove=function(){return 2===arguments.length?n.prototype.remove.call(this,arguments[0],arguments[1]):n.prototype.remove.apply(this,arguments)},r.prototype.depth=function(){return 0===
arguments.length?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},r.prototype.createParentBoundables=function(z,u){Xa.isTrue(!z.isEmpty());var y=Math.trunc(Math.ceil(z.size()/this.getNodeCapacity()));z=new Fa(z);Kd.sort(z,r.xComparator);y=this.verticalSlices(z,Math.trunc(Math.ceil(Math.sqrt(y))));return this.createParentBoundablesFromVerticalSlices(y,u)},r.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Va(arguments[0],dg)){var z=arguments[0];z=new jc(this.getRoot(),
this.getRoot(),z);return this.nearestNeighbour(z)}if(arguments[0]instanceof jc)return this.nearestNeighbour(arguments[0],Wa.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof r&&Va(arguments[1],dg)){z=arguments[0];var u=arguments[1];z=new jc(this.getRoot(),z.getRoot(),u);return this.nearestNeighbour(z)}if(arguments[0]instanceof jc&&"number"==typeof arguments[1]){var y=arguments[0];z=arguments[1];u=null;var C=new xe;for(C.add(y);!C.isEmpty()&&0<z;){y=C.poll();var w=y.getDistance();
if(w>=z)break;y.isLeaves()?(z=w,u=y):y.expandToQueue(C,z)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length)return z=arguments[2],u=new vd(arguments[0],arguments[1]),z=new jc(this.getRoot(),u,z),this.nearestNeighbour(z)[0]},r.prototype.interfaces_=function(){return[tf,id]},r.prototype.getClass=function(){return r},r.centreX=function(z){return r.avg(z.getMinX(),z.getMaxX())},r.avg=function(z,u){return(z+u)/2},r.centreY=function(z){return r.avg(z.getMinY(),
z.getMaxY())},v.STRtreeNode.get=function(){return on},v.serialVersionUID.get=function(){return 0x39920f7d5f261e0},v.xComparator.get=function(){return{interfaces_:function(){return[Rf]},compare:function(z,u){return n.compareDoubles(r.centreX(z.getBounds()),r.centreX(u.getBounds()))}}},v.yComparator.get=function(){return{interfaces_:function(){return[Rf]},compare:function(z,u){return n.compareDoubles(r.centreY(z.getBounds()),r.centreY(u.getBounds()))}}},v.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},
intersects:function(z,u){return z.intersects(u)}}},v.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(r,v),r}(rc),on=function(n){function r(v){n.call(this,v)}return n&&(r.__proto__=n),r.prototype=Object.create(n&&n.prototype),r.prototype.constructor=r,r.prototype.computeBounds=function(){for(var v=null,z=this.getChildBoundables().iterator();z.hasNext();){var u=z.next();null===v?v=new Ia(u.getBounds()):v.expandToInclude(u.getBounds())}return v},r.prototype.interfaces_=function(){return[]},
r.prototype.getClass=function(){return r},r}(oc),Pc=function(){};Pc.prototype.interfaces_=function(){return[]};Pc.prototype.getClass=function(){return Pc};Pc.relativeSign=function(n,r){return n<r?-1:n>r?1:0};Pc.compare=function(n,r,v){if(r.equals2D(v))return 0;var z=Pc.relativeSign(r.x,v.x);r=Pc.relativeSign(r.y,v.y);switch(n){case 0:return Pc.compareValue(z,r);case 1:return Pc.compareValue(r,z);case 2:return Pc.compareValue(r,-z);case 3:return Pc.compareValue(-z,r);case 4:return Pc.compareValue(-z,
-r);case 5:return Pc.compareValue(-r,-z);case 6:return Pc.compareValue(-r,z);case 7:return Pc.compareValue(z,-r)}return Xa.shouldNeverReachHere("invalid octant value"),0};Pc.compareValue=function(n,r){return 0>n?-1:0<n?1:0>r?-1:0<r?1:0};var He=function(n,r,v,z){this._isInterior=this._segmentOctant=this.segmentIndex=this.coord=null;this._segString=n;this.coord=new sa(r);this.segmentIndex=v;this._segmentOctant=z;this._isInterior=!r.equals2D(n.getCoordinate(v))};He.prototype.getCoordinate=function(){return this.coord};
He.prototype.print=function(n){n.print(this.coord);n.print(" seg # = "+this.segmentIndex)};He.prototype.compareTo=function(n){return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Pc.compare(this._segmentOctant,this.coord,n.coord)};He.prototype.isEndPoint=function(n){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===n};He.prototype.isInterior=function(){return this._isInterior};He.prototype.interfaces_=function(){return[jd]};
He.prototype.getClass=function(){return He};var Jc=function(n){this._nodeMap=new Ac;this._edge=n};Jc.prototype.getSplitCoordinates=function(){var n=new Tg;this.addEndpoints();for(var r=this.iterator(),v=r.next();r.hasNext();){var z=r.next();this.addEdgeCoordinates(v,z,n);v=z}return n.toCoordinateArray()};Jc.prototype.addCollapsedNodes=function(){var n=new Fa;this.findCollapsesFromInsertedNodes(n);this.findCollapsesFromExistingVertices(n);for(n=n.iterator();n.hasNext();){var r=n.next().intValue();
this.add(this._edge.getCoordinate(r),r)}};Jc.prototype.print=function(n){n.println("Intersections:");for(var r=this.iterator();r.hasNext();)r.next().print(n)};Jc.prototype.findCollapsesFromExistingVertices=function(n){for(var r=0;r<this._edge.size()-2;r++){var v=this._edge.getCoordinate(r),z=this._edge.getCoordinate(r+2);v.equals2D(z)&&n.add(new Dd(r+1))}};Jc.prototype.addEdgeCoordinates=function(n,r,v){var z=this._edge.getCoordinate(r.segmentIndex);z=r.isInterior()||!r.coord.equals2D(z);v.add(new sa(n.coord),
!1);for(n=n.segmentIndex+1;n<=r.segmentIndex;n++)v.add(this._edge.getCoordinate(n));z&&v.add(new sa(r.coord))};Jc.prototype.iterator=function(){return this._nodeMap.values().iterator()};Jc.prototype.addSplitEdges=function(n){this.addEndpoints();this.addCollapsedNodes();for(var r=this.iterator(),v=r.next();r.hasNext();){var z=r.next();v=this.createSplitEdge(v,z);n.add(v);v=z}};Jc.prototype.findCollapseIndex=function(n,r,v){if(!n.coord.equals2D(r.coord))return!1;var z=r.segmentIndex-n.segmentIndex;
return r.isInterior()||z--,1===z&&(v[0]=n.segmentIndex+1,!0)};Jc.prototype.findCollapsesFromInsertedNodes=function(n){for(var r=Array(1).fill(null),v=this.iterator(),z=v.next();v.hasNext();){var u=v.next();this.findCollapseIndex(z,u,r)&&n.add(new Dd(r[0]));z=u}};Jc.prototype.getEdge=function(){return this._edge};Jc.prototype.addEndpoints=function(){var n=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0);this.add(this._edge.getCoordinate(n),n)};Jc.prototype.createSplitEdge=function(n,r){var v=
r.segmentIndex-n.segmentIndex+2,z=this._edge.getCoordinate(r.segmentIndex);(z=r.isInterior()||!r.coord.equals2D(z))||v--;v=Array(v).fill(null);var u=0;v[u++]=new sa(n.coord);for(n=n.segmentIndex+1;n<=r.segmentIndex;n++)v[u++]=this._edge.getCoordinate(n);return z&&(v[u]=new sa(r.coord)),new ec(v,this._edge.getData())};Jc.prototype.add=function(n,r){r=new He(this._edge,n,r,this._edge.getSegmentOctant(r));var v=this._nodeMap.get(r);return null!==v?(Xa.isTrue(v.coord.equals2D(n),"Found equal nodes with different coordinates"),
v):(this._nodeMap.put(r,r),r)};Jc.prototype.checkSplitEdgesCorrectness=function(n){var r=this._edge.getCoordinates(),v=n.get(0).getCoordinate(0);if(!v.equals2D(r[0]))throw new re("bad split edge start point at "+v);n=n.get(n.size()-1).getCoordinates();n=n[n.length-1];if(!n.equals2D(r[r.length-1]))throw new re("bad split edge end point at "+n);};Jc.prototype.interfaces_=function(){return[]};Jc.prototype.getClass=function(){return Jc};var uf=function(){};uf.prototype.interfaces_=function(){return[]};
uf.prototype.getClass=function(){return uf};uf.octant=function(n,r){if("number"==typeof n&&"number"==typeof r){if(0===n&&0===r)throw new ac("Cannot compute the octant for point ( "+n+", "+r+" )");var v=Math.abs(n),z=Math.abs(r);return 0<=n?0<=r?v>=z?0:1:v>=z?7:6:0<=r?v>=z?3:2:v>=z?4:5}if(n instanceof sa&&r instanceof sa){v=r.x-n.x;r=r.y-n.y;if(0===v&&0===r)throw new ac("Cannot compute the octant for two identical points "+n);return uf.octant(v,r)}};var $d=function(){};$d.prototype.getCoordinates=
function(){};$d.prototype.size=function(){};$d.prototype.getCoordinate=function(n){};$d.prototype.isClosed=function(){};$d.prototype.setData=function(n){};$d.prototype.getData=function(){};$d.prototype.interfaces_=function(){return[]};$d.prototype.getClass=function(){return $d};var ah=function(){};ah.prototype.addIntersection=function(n,r){};ah.prototype.interfaces_=function(){return[$d]};ah.prototype.getClass=function(){return ah};var ec=function(n,r){this._nodeList=new Jc(this);this._pts=n;this._data=
r};ec.prototype.getCoordinates=function(){return this._pts};ec.prototype.size=function(){return this._pts.length};ec.prototype.getCoordinate=function(n){return this._pts[n]};ec.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};ec.prototype.getSegmentOctant=function(n){return n===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(n),this.getCoordinate(n+1))};ec.prototype.setData=function(n){this._data=n};ec.prototype.safeOctant=function(n,r){return n.equals2D(r)?
0:uf.octant(n,r)};ec.prototype.getData=function(){return this._data};ec.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var n=arguments[1],r=new sa(arguments[0].getIntersection(arguments[3]));this.addIntersection(r,n)}};ec.prototype.toString=function(){return qe.toLineString(new hc(this._pts))};ec.prototype.getNodeList=function(){return this._nodeList};ec.prototype.addIntersectionNode=function(n,r){var v=
r+1;v<this._pts.length&&n.equals2D(this._pts[v])&&(r=v);return this._nodeList.add(n,r)};ec.prototype.addIntersections=function(n,r,v){for(var z=0;z<n.getIntersectionNum();z++)this.addIntersection(n,r,v,z)};ec.prototype.interfaces_=function(){return[ah]};ec.prototype.getClass=function(){return ec};ec.getNodedSubstrings=function(){if(1===arguments.length){var n=arguments[0],r=new Fa;return ec.getNodedSubstrings(n,r),r}if(2===arguments.length)for(n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)};
var Na=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new sa,this.p1=new sa;else if(1===arguments.length){var n=arguments[0];this.p0=new sa(n.p0);this.p1=new sa(n.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){n=arguments[2];var r=arguments[3];this.p0=new sa(arguments[0],arguments[1]);this.p1=new sa(n,r)}},pn={serialVersionUID:{configurable:!0}};Na.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};Na.prototype.orientationIndex=
function(n){if(n instanceof Na){var r=Da.orientationIndex(this.p0,this.p1,n.p0);n=Da.orientationIndex(this.p0,this.p1,n.p1);return 0<=r&&0<=n||0>=r&&0>=n?Math.max(r,n):0}if(n instanceof sa)return Da.orientationIndex(this.p0,this.p1,n)};Na.prototype.toGeometry=function(n){return n.createLineString([this.p0,this.p1])};Na.prototype.isVertical=function(){return this.p0.x===this.p1.x};Na.prototype.equals=function(n){return n instanceof Na?this.p0.equals(n.p0)&&this.p1.equals(n.p1):!1};Na.prototype.intersection=
function(n){var r=new Te;return r.computeIntersection(this.p0,this.p1,n.p0,n.p1),r.hasIntersection()?r.getIntersection(0):null};Na.prototype.project=function(n){if(n instanceof sa){if(n.equals(this.p0)||n.equals(this.p1))return new sa(n);var r=this.projectionFactor(n),v=new sa;return v.x=this.p0.x+r*(this.p1.x-this.p0.x),v.y=this.p0.y+r*(this.p1.y-this.p0.y),v}if(n instanceof Na){var z=this.projectionFactor(n.p0);r=this.projectionFactor(n.p1);if(1<=z&&1<=r||0>=z&&0>=r)return null;v=this.project(n.p0);
0>z&&(v=this.p0);1<z&&(v=this.p1);n=this.project(n.p1);return 0>r&&(n=this.p0),1<r&&(n=this.p1),new Na(v,n)}};Na.prototype.normalize=function(){0>this.p1.compareTo(this.p0)&&this.reverse()};Na.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};Na.prototype.getCoordinate=function(n){return 0===n?this.p0:this.p1};Na.prototype.distancePerpendicular=function(n){return Da.distancePointLinePerpendicular(n,this.p0,this.p1)};Na.prototype.minY=function(){return Math.min(this.p0.y,
this.p1.y)};Na.prototype.midPoint=function(){return Na.midPoint(this.p0,this.p1)};Na.prototype.projectionFactor=function(n){if(n.equals(this.p0))return 0;if(n.equals(this.p1))return 1;var r=this.p1.x-this.p0.x,v=this.p1.y-this.p0.y,z=r*r+v*v;return 0>=z?Wa.NaN:((n.x-this.p0.x)*r+(n.y-this.p0.y)*v)/z};Na.prototype.closestPoints=function(n){var r=this.intersection(n);if(null!==r)return[r,r];r=Array(2).fill(null);var v=null,z=this.closestPoint(n.p0);var u=z.distance(n.p0);r[0]=z;r[1]=n.p0;z=this.closestPoint(n.p1);
(v=z.distance(n.p1))<u&&(u=v,r[0]=z,r[1]=n.p1);z=n.closestPoint(this.p0);(v=z.distance(this.p0))<u&&(u=v,r[0]=this.p0,r[1]=z);n=n.closestPoint(this.p1);return n.distance(this.p1)<u&&(r[0]=this.p1,r[1]=n),r};Na.prototype.closestPoint=function(n){var r=this.projectionFactor(n);return 0<r&&1>r?this.project(n):this.p0.distance(n)<this.p1.distance(n)?this.p0:this.p1};Na.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};Na.prototype.getLength=function(){return this.p0.distance(this.p1)};Na.prototype.compareTo=
function(n){var r=this.p0.compareTo(n.p0);return 0!==r?r:this.p1.compareTo(n.p1)};Na.prototype.reverse=function(){var n=this.p0;this.p0=this.p1;this.p1=n};Na.prototype.equalsTopo=function(n){return this.p0.equals(n.p0)&&(this.p1.equals(n.p1)||this.p0.equals(n.p1))&&this.p1.equals(n.p0)};Na.prototype.lineIntersection=function(n){try{return sd.intersection(this.p0,this.p1,n.p0,n.p1)}catch(r){if(!(r instanceof Tf))throw r;}return null};Na.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};
Na.prototype.pointAlongOffset=function(n,r){var v=this.p0.x+n*(this.p1.x-this.p0.x);n=this.p0.y+n*(this.p1.y-this.p0.y);var z=this.p1.x-this.p0.x,u=this.p1.y-this.p0.y,y=Math.sqrt(z*z+u*u),C=0,w=0;if(0!==r){if(0>=y)throw Error("Cannot compute offset from zero-length line segment");C=r*z/y;w=r*u/y}return new sa(v-w,n+C)};Na.prototype.setCoordinates=function(){if(1===arguments.length){var n=arguments[0];this.setCoordinates(n.p0,n.p1)}else if(2===arguments.length){n=arguments[0];var r=arguments[1];this.p0.x=
n.x;this.p0.y=n.y;this.p1.x=r.x;this.p1.y=r.y}};Na.prototype.segmentFraction=function(n){n=this.projectionFactor(n);return 0>n?n=0:(1<n||Wa.isNaN(n))&&(n=1),n};Na.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};Na.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};Na.prototype.distance=function(n){if(n instanceof Na)return Da.distanceLineLine(this.p0,this.p1,n.p0,n.p1);if(n instanceof sa)return Da.distancePointLine(n,this.p0,
this.p1)};Na.prototype.pointAlong=function(n){var r=new sa;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r};Na.prototype.hashCode=function(){var n=Wa.doubleToLongBits(this.p0.x);n^=31*Wa.doubleToLongBits(this.p0.y);n=Math.trunc(n)^Math.trunc(n>>32);var r=Wa.doubleToLongBits(this.p1.x);return r^=31*Wa.doubleToLongBits(this.p1.y),n^Math.trunc(r)^Math.trunc(r>>32)};Na.prototype.interfaces_=function(){return[jd,id]};Na.prototype.getClass=function(){return Na};Na.midPoint=
function(n,r){return new sa((n.x+r.x)/2,(n.y+r.y)/2)};pn.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(Na,pn);var bh=function(){this.tempEnv1=new Ia;this.tempEnv2=new Ia;this._overlapSeg1=new Na;this._overlapSeg2=new Na};bh.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var n=arguments[2],r=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1);n.getLineSegment(r,this._overlapSeg2);this.overlap(this._overlapSeg1,this._overlapSeg2)}};
bh.prototype.interfaces_=function(){return[]};bh.prototype.getClass=function(){return bh};var Zc=function(n,r,v,z){this._id=this._env=null;this._pts=n;this._start=r;this._end=v;this._context=z};Zc.prototype.getLineSegment=function(n,r){r.p0=this._pts[n];r.p1=this._pts[n+1]};Zc.prototype.computeSelect=function(n,r,v,z){if(z.tempEnv1.init(this._pts[r],this._pts[v]),1==v-r)return z.select(this,r),null;if(!n.intersects(z.tempEnv1))return null;var u=Math.trunc((r+v)/2);r<u&&this.computeSelect(n,r,u,z);
u<v&&this.computeSelect(n,u,v,z)};Zc.prototype.getCoordinates=function(){for(var n=Array(this._end-this._start+1).fill(null),r=0,v=this._start;v<=this._end;v++)n[r++]=this._pts[v];return n};Zc.prototype.computeOverlaps=function(n,r){this.computeOverlapsInternal(this._start,this._end,n,n._start,n._end,r)};Zc.prototype.setId=function(n){this._id=n};Zc.prototype.select=function(n,r){this.computeSelect(n,this._start,this._end,r)};Zc.prototype.getEnvelope=function(){null===this._env&&(this._env=new Ia(this._pts[this._start],
this._pts[this._end]));return this._env};Zc.prototype.getEndIndex=function(){return this._end};Zc.prototype.getStartIndex=function(){return this._start};Zc.prototype.getContext=function(){return this._context};Zc.prototype.getId=function(){return this._id};Zc.prototype.computeOverlapsInternal=function(n,r,v,z,u,y){var C=this._pts[n],w=this._pts[r],x=v._pts[z],B=v._pts[u];if(1==r-n&&1==u-z)return y.overlap(this,n,v,z),null;if(y.tempEnv1.init(C,w),y.tempEnv2.init(x,B),!y.tempEnv1.intersects(y.tempEnv2))return null;
C=Math.trunc((n+r)/2);w=Math.trunc((z+u)/2);n<C&&(z<w&&this.computeOverlapsInternal(n,C,v,z,w,y),w<u&&this.computeOverlapsInternal(n,C,v,w,u,y));C<r&&(z<w&&this.computeOverlapsInternal(C,r,v,z,w,y),w<u&&this.computeOverlapsInternal(C,r,v,w,u,y))};Zc.prototype.interfaces_=function(){return[]};Zc.prototype.getClass=function(){return Zc};var Ld=function(){};Ld.prototype.interfaces_=function(){return[]};Ld.prototype.getClass=function(){return Ld};Ld.getChainStartIndices=function(n){var r=0,v=new Fa;v.add(new Dd(r));
do r=Ld.findChainEnd(n,r),v.add(new Dd(r));while(r<n.length-1);return Ld.toIntArray(v)};Ld.findChainEnd=function(n,r){for(var v=r;v<n.length-1&&n[v].equals2D(n[v+1]);)v++;if(v>=n.length-1)return n.length-1;v=Mb.quadrant(n[v],n[v+1]);for(r+=1;r<n.length&&(n[r-1].equals2D(n[r])||Mb.quadrant(n[r-1],n[r])===v);)r++;return r-1};Ld.getChains=function(){if(1===arguments.length)return Ld.getChains(arguments[0],null);if(2===arguments.length){for(var n=arguments[0],r=arguments[1],v=new Fa,z=Ld.getChainStartIndices(n),
u=0;u<z.length-1;u++){var y=new Zc(n,z[u],z[u+1],r);v.add(y)}return v}};Ld.toIntArray=function(n){for(var r=Array(n.size()).fill(null),v=0;v<r.length;v++)r[v]=n.get(v).intValue();return r};var Ye=function(){};Ye.prototype.computeNodes=function(n){};Ye.prototype.getNodedSubstrings=function(){};Ye.prototype.interfaces_=function(){return[]};Ye.prototype.getClass=function(){return Ye};var ch=function(){(this._segInt=null,0!==arguments.length)&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};
ch.prototype.setSegmentIntersector=function(n){this._segInt=n};ch.prototype.interfaces_=function(){return[Ye]};ch.prototype.getClass=function(){return ch};var Nj=function(n){function r(z){z?n.call(this,z):n.call(this);this._monoChains=new Fa;this._index=new Ep;this._idCounter=0;this._nodedSegStrings=null;this._nOverlaps=0}n&&(r.__proto__=n);r.prototype=Object.create(n&&n.prototype);r.prototype.constructor=r;var v={SegmentOverlapAction:{configurable:!0}};return r.prototype.getMonotoneChains=function(){return this._monoChains},
r.prototype.getNodedSubstrings=function(){return ec.getNodedSubstrings(this._nodedSegStrings)},r.prototype.getIndex=function(){return this._index},r.prototype.add=function(z){for(z=Ld.getChains(z.getCoordinates(),z).iterator();z.hasNext();){var u=z.next();u.setId(this._idCounter++);this._index.insert(u.getEnvelope(),u);this._monoChains.add(u)}},r.prototype.computeNodes=function(z){this._nodedSegStrings=z;for(z=z.iterator();z.hasNext();)this.add(z.next());this.intersectChains()},r.prototype.intersectChains=
function(){for(var z=new qn(this._segInt),u=this._monoChains.iterator();u.hasNext();)for(var y=u.next(),C=this._index.query(y.getEnvelope()).iterator();C.hasNext();){var w=C.next();if(w.getId()>y.getId()&&(y.computeOverlaps(w,z),this._nOverlaps++),this._segInt.isDone())return null}},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},v.SegmentOverlapAction.get=function(){return qn},Object.defineProperties(r,v),r}(ch),qn=function(n){function r(v){n.call(this);this._si=
v}return n&&(r.__proto__=n),r.prototype=Object.create(n&&n.prototype),r.prototype.constructor=r,r.prototype.overlap=function(){if(4!==arguments.length)return n.prototype.overlap.apply(this,arguments);var v=arguments[1],z=arguments[2],u=arguments[3],y=arguments[0].getContext();z=z.getContext();this._si.processIntersections(y,v,z,u)},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},r}(bh),Gb=function r(){if(this._quadrantSegments=r.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=
r.CAP_ROUND,this._joinStyle=r.JOIN_ROUND,this._mitreLimit=r.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=r.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var v=arguments[1];this.setQuadrantSegments(arguments[0]);this.setEndCapStyle(v)}else if(4===arguments.length){v=arguments[1];var z=arguments[2],u=arguments[3];this.setQuadrantSegments(arguments[0]);this.setEndCapStyle(v);this.setJoinStyle(z);
this.setMitreLimit(u)}},ye={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Gb.prototype.getEndCapStyle=function(){return this._endCapStyle};Gb.prototype.isSingleSided=function(){return this._isSingleSided};Gb.prototype.setQuadrantSegments=function(r){this._quadrantSegments=
r;0===this._quadrantSegments&&(this._joinStyle=Gb.JOIN_BEVEL);0>this._quadrantSegments&&(this._joinStyle=Gb.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments));0>=r&&(this._quadrantSegments=1);this._joinStyle!==Gb.JOIN_ROUND&&(this._quadrantSegments=Gb.DEFAULT_QUADRANT_SEGMENTS)};Gb.prototype.getJoinStyle=function(){return this._joinStyle};Gb.prototype.setJoinStyle=function(r){this._joinStyle=r};Gb.prototype.setSimplifyFactor=function(r){this._simplifyFactor=0>r?0:r};Gb.prototype.getSimplifyFactor=
function(){return this._simplifyFactor};Gb.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Gb.prototype.setEndCapStyle=function(r){this._endCapStyle=r};Gb.prototype.getMitreLimit=function(){return this._mitreLimit};Gb.prototype.setMitreLimit=function(r){this._mitreLimit=r};Gb.prototype.setSingleSided=function(r){this._isSingleSided=r};Gb.prototype.interfaces_=function(){return[]};Gb.prototype.getClass=function(){return Gb};Gb.bufferDistanceError=function(r){return 1-Math.cos(Math.PI/
2/r/2)};ye.CAP_ROUND.get=function(){return 1};ye.CAP_FLAT.get=function(){return 2};ye.CAP_SQUARE.get=function(){return 3};ye.JOIN_ROUND.get=function(){return 1};ye.JOIN_MITRE.get=function(){return 2};ye.JOIN_BEVEL.get=function(){return 3};ye.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};ye.DEFAULT_MITRE_LIMIT.get=function(){return 5};ye.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01};Object.defineProperties(Gb,ye);var bc=function(r){this._isDeleted=this._distanceTol=null;this._angleOrientation=
Da.COUNTERCLOCKWISE;this._inputLine=r||null},dh={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};bc.prototype.isDeletable=function(r,v,z,u){var y=this._inputLine[r];v=this._inputLine[v];var C=this._inputLine[z];return!!this.isConcave(y,v,C)&&!!this.isShallow(y,v,C,u)&&this.isShallowSampled(y,v,r,z,u)};bc.prototype.deleteShallowConcavities=function(){for(var r=1,v=this.findNextNonDeletedIndex(r),z=this.findNextNonDeletedIndex(v),u=!1;z<this._inputLine.length;){var y=
!1;this.isDeletable(r,v,z,this._distanceTol)&&(this._isDeleted[v]=bc.DELETE,y=!0,u=!0);r=y?z:v;v=this.findNextNonDeletedIndex(r);z=this.findNextNonDeletedIndex(v)}return u};bc.prototype.isShallowConcavity=function(r,v,z,u){return Da.computeOrientation(r,v,z)===this._angleOrientation&&Da.distancePointLine(v,r,z)<u};bc.prototype.isShallowSampled=function(r,v,z,u,y){var C=Math.trunc((u-z)/bc.NUM_PTS_TO_CHECK);for(0>=C&&(C=1);z<u;z+=C)if(!this.isShallow(r,v,this._inputLine[z],y))return!1;return!0};bc.prototype.isConcave=
function(r,v,z){return Da.computeOrientation(r,v,z)===this._angleOrientation};bc.prototype.simplify=function(r){this._distanceTol=Math.abs(r);0>r&&(this._angleOrientation=Da.CLOCKWISE);this._isDeleted=Array(this._inputLine.length).fill(null);do r=this.deleteShallowConcavities();while(r);return this.collapseLine()};bc.prototype.findNextNonDeletedIndex=function(r){for(r+=1;r<this._inputLine.length&&this._isDeleted[r]===bc.DELETE;)r++;return r};bc.prototype.isShallow=function(r,v,z,u){return Da.distancePointLine(v,
r,z)<u};bc.prototype.collapseLine=function(){for(var r=new Tg,v=0;v<this._inputLine.length;v++)this._isDeleted[v]!==bc.DELETE&&r.add(this._inputLine[v]);return r.toCoordinateArray()};bc.prototype.interfaces_=function(){return[]};bc.prototype.getClass=function(){return bc};bc.simplify=function(r,v){return(new bc(r)).simplify(v)};dh.INIT.get=function(){return 0};dh.DELETE.get=function(){return 1};dh.KEEP.get=function(){return 1};dh.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(bc,
dh);var ed=function(){this._precisionModel=this._ptList=null;this._minimimVertexDistance=0;this._ptList=new Fa},rn={COORDINATE_ARRAY_TYPE:{configurable:!0}};ed.prototype.getCoordinates=function(){return this._ptList.toArray(ed.COORDINATE_ARRAY_TYPE)};ed.prototype.setPrecisionModel=function(r){this._precisionModel=r};ed.prototype.addPt=function(r){r=new sa(r);if(this._precisionModel.makePrecise(r),this.isRedundant(r))return null;this._ptList.add(r)};ed.prototype.revere=function(){};ed.prototype.addPts=
function(r,v){if(v)for(v=0;v<r.length;v++)this.addPt(r[v]);else for(v=r.length-1;0<=v;v--)this.addPt(r[v])};ed.prototype.isRedundant=function(r){if(1>this._ptList.size())return!1;var v=this._ptList.get(this._ptList.size()-1);return r.distance(v)<this._minimimVertexDistance};ed.prototype.toString=function(){return(new bb).createLineString(this.getCoordinates()).toString()};ed.prototype.closeRing=function(){if(1>this._ptList.size())return null;var r=new sa(this._ptList.get(0)),v=this._ptList.get(this._ptList.size()-
1);if(r.equals(v))return null;this._ptList.add(r)};ed.prototype.setMinimumVertexDistance=function(r){this._minimimVertexDistance=r};ed.prototype.interfaces_=function(){return[]};ed.prototype.getClass=function(){return ed};rn.COORDINATE_ARRAY_TYPE.get=function(){return[].fill(null)};Object.defineProperties(ed,rn);var cb=function(){},vf={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};
cb.prototype.interfaces_=function(){return[]};cb.prototype.getClass=function(){return cb};cb.toDegrees=function(r){return 180*r/Math.PI};cb.normalize=function(r){for(;r>Math.PI;)r-=cb.PI_TIMES_2;for(;r<=-Math.PI;)r+=cb.PI_TIMES_2;return r};cb.angle=function(){if(1===arguments.length){var r=arguments[0];return Math.atan2(r.y,r.x)}if(2===arguments.length){r=arguments[0];var v=arguments[1];return Math.atan2(v.y-r.y,v.x-r.x)}};cb.isAcute=function(r,v,z){return 0<(r.x-v.x)*(z.x-v.x)+(r.y-v.y)*(z.y-v.y)};
cb.isObtuse=function(r,v,z){return 0>(r.x-v.x)*(z.x-v.x)+(r.y-v.y)*(z.y-v.y)};cb.interiorAngle=function(r,v,z){r=cb.angle(v,r);v=cb.angle(v,z);return Math.abs(v-r)};cb.normalizePositive=function(r){if(0>r){for(;0>r;)r+=cb.PI_TIMES_2;r>=cb.PI_TIMES_2&&(r=0)}else{for(;r>=cb.PI_TIMES_2;)r-=cb.PI_TIMES_2;0>r&&(r=0)}return r};cb.angleBetween=function(r,v,z){r=cb.angle(v,r);v=cb.angle(v,z);return cb.diff(r,v)};cb.diff=function(r,v){var z=null;return(z=r<v?v-r:r-v)>Math.PI&&(z=2*Math.PI-z),z};cb.toRadians=
function(r){return r*Math.PI/180};cb.getTurn=function(r,v){r=Math.sin(v-r);return 0<r?cb.COUNTERCLOCKWISE:0>r?cb.CLOCKWISE:cb.NONE};cb.angleBetweenOriented=function(r,v,z){r=cb.angle(v,r);v=cb.angle(v,z)-r;return v<=-Math.PI?v+cb.PI_TIMES_2:v>Math.PI?v-cb.PI_TIMES_2:v};vf.PI_TIMES_2.get=function(){return 2*Math.PI};vf.PI_OVER_2.get=function(){return Math.PI/2};vf.PI_OVER_4.get=function(){return Math.PI/4};vf.COUNTERCLOCKWISE.get=function(){return Da.COUNTERCLOCKWISE};vf.CLOCKWISE.get=function(){return Da.CLOCKWISE};
vf.NONE.get=function(){return Da.COLLINEAR};Object.defineProperties(cb,vf);var Ub=function y(v,z,u){this._maxCurveSegmentError=0;this._filletAngleQuantum=null;this._closingSegLengthFactor=1;this._segList=null;this._distance=0;this._s2=this._s1=this._s0=this._li=this._bufParams=this._precisionModel=null;this._seg0=new Na;this._seg1=new Na;this._offset0=new Na;this._offset1=new Na;this._side=0;this._hasNarrowConcaveAngle=!1;this._precisionModel=v;this._bufParams=z;this._li=new Te;this._filletAngleQuantum=
Math.PI/2/z.getQuadrantSegments();8<=z.getQuadrantSegments()&&z.getJoinStyle()===Gb.JOIN_ROUND&&(this._closingSegLengthFactor=y.MAX_CLOSING_SEG_LEN_FACTOR);this.init(u)},eh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ub.prototype.addNextSegment=function(v,z){if(this._s0=this._s1,this._s1=this._s2,this._s2=v,this._seg0.setCoordinates(this._s0,
this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;v=Da.computeOrientation(this._s0,this._s1,this._s2);var u=v===Da.CLOCKWISE&&this._side===Aa.LEFT||v===Da.COUNTERCLOCKWISE&&this._side===Aa.RIGHT;0===v?this.addCollinear(z):u?this.addOutsideTurn(v,z):this.addInsideTurn(v,z)};Ub.prototype.addLineEndCap=function(v,
z){var u=new Na(v,z),y=new Na;this.computeOffsetSegment(u,Aa.LEFT,this._distance,y);var C=new Na;this.computeOffsetSegment(u,Aa.RIGHT,this._distance,C);v=Math.atan2(z.y-v.y,z.x-v.x);switch(this._bufParams.getEndCapStyle()){case Gb.CAP_ROUND:this._segList.addPt(y.p1);this.addFilletArc(z,v+Math.PI/2,v-Math.PI/2,Da.CLOCKWISE,this._distance);this._segList.addPt(C.p1);break;case Gb.CAP_FLAT:this._segList.addPt(y.p1);this._segList.addPt(C.p1);break;case Gb.CAP_SQUARE:z=new sa,z.x=Math.abs(this._distance)*
Math.cos(v),z.y=Math.abs(this._distance)*Math.sin(v),y=new sa(y.p1.x+z.x,y.p1.y+z.y),C=new sa(C.p1.x+z.x,C.p1.y+z.y),this._segList.addPt(y),this._segList.addPt(C)}};Ub.prototype.getCoordinates=function(){return this._segList.getCoordinates()};Ub.prototype.addMitreJoin=function(v,z,u,y){var C=!0,w=null;try{w=sd.intersection(z.p0,z.p1,u.p0,u.p1),(0>=y?1:w.distance(v)/Math.abs(y))>this._bufParams.getMitreLimit()&&(C=!1)}catch(x){if(!(x instanceof Tf))throw x;w=new sa(0,0);C=!1}C?this._segList.addPt(w):
this.addLimitedMitreJoin(z,u,y,this._bufParams.getMitreLimit())};Ub.prototype.addFilletCorner=function(v,z,u,y,C){var w=Math.atan2(z.y-v.y,z.x-v.x),x=Math.atan2(u.y-v.y,u.x-v.x);y===Da.CLOCKWISE?w<=x&&(w+=2*Math.PI):w>=x&&(w-=2*Math.PI);this._segList.addPt(z);this.addFilletArc(v,w,x,y,C);this._segList.addPt(u)};Ub.prototype.addOutsideTurn=function(v,z){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ub.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;
this._bufParams.getJoinStyle()===Gb.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Gb.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(z&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,v,this._distance),this._segList.addPt(this._offset1.p0))};Ub.prototype.createSquare=function(v){this._segList.addPt(new sa(v.x+this._distance,v.y+this._distance));this._segList.addPt(new sa(v.x+
this._distance,v.y-this._distance));this._segList.addPt(new sa(v.x-this._distance,v.y-this._distance));this._segList.addPt(new sa(v.x-this._distance,v.y+this._distance));this._segList.closeRing()};Ub.prototype.addSegments=function(v,z){this._segList.addPts(v,z)};Ub.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Ub.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Ub.prototype.initSideSegments=function(v,z,u){this._s1=v;this._s2=z;this._side=u;
this._seg1.setCoordinates(v,z);this.computeOffsetSegment(this._seg1,u,this._distance,this._offset1)};Ub.prototype.addLimitedMitreJoin=function(v,z,u,y){v=this._seg0.p1;var C=cb.angle(v,this._seg0.p0);z=cb.angleBetweenOriented(this._seg0.p0,v,this._seg1.p1)/2;C=cb.normalize(C+z);C=cb.normalize(C+Math.PI);y*=u;u-=y*Math.abs(Math.sin(z));y=new sa(v.x+y*Math.cos(C),v.y+y*Math.sin(C));y=new Na(v,y);v=y.pointAlongOffset(1,u);u=y.pointAlongOffset(1,-u);this._side===Aa.LEFT?(this._segList.addPt(v),this._segList.addPt(u)):
(this._segList.addPt(u),this._segList.addPt(v))};Ub.prototype.computeOffsetSegment=function(v,z,u,y){z=z===Aa.LEFT?1:-1;var C=v.p1.x-v.p0.x,w=v.p1.y-v.p0.y,x=Math.sqrt(C*C+w*w);C=z*u*C/x;u=z*u*w/x;y.p0.x=v.p0.x-u;y.p0.y=v.p0.y+C;y.p1.x=v.p1.x-u;y.p1.y=v.p1.y+C};Ub.prototype.addFilletArc=function(v,z,u,y,C){y=y===Da.CLOCKWISE?-1:1;u=Math.abs(z-u);var w=Math.trunc(u/this._filletAngleQuantum+.5);if(1>w)return null;w=u/w;for(var x=0,B=new sa;x<u;){var E=z+y*x;B.x=v.x+C*Math.cos(E);B.y=v.y+C*Math.sin(E);
this._segList.addPt(B);x+=w}};Ub.prototype.addInsideTurn=function(v,z){(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())?this._segList.addPt(this._li.getIntersection(0)):(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ub.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)?this._segList.addPt(this._offset0.p1):((this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor)?(v=new sa((this._closingSegLengthFactor*
this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(v),v=new sa((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(v)):this._segList.addPt(this._s1),this._segList.addPt(this._offset1.p0))};Ub.prototype.createCircle=function(v){var z=
new sa(v.x+this._distance,v.y);this._segList.addPt(z);this.addFilletArc(v,0,2*Math.PI,-1,this._distance);this._segList.closeRing()};Ub.prototype.addBevelJoin=function(v,z){this._segList.addPt(v.p1);this._segList.addPt(z.p0)};Ub.prototype.init=function(v){this._distance=v;this._maxCurveSegmentError=v*(1-Math.cos(this._filletAngleQuantum/2));this._segList=new ed;this._segList.setPrecisionModel(this._precisionModel);this._segList.setMinimumVertexDistance(v*Ub.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Ub.prototype.addCollinear=
function(v){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===Gb.JOIN_BEVEL||this._bufParams.getJoinStyle()===Gb.JOIN_MITRE?(v&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Da.CLOCKWISE,this._distance))};Ub.prototype.closeRing=function(){this._segList.closeRing()};Ub.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};
Ub.prototype.interfaces_=function(){return[]};Ub.prototype.getClass=function(){return Ub};eh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001};eh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001};eh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1E-6};eh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Ub,eh);var Qc=function(v,z){this._distance=0;this._precisionModel=v;this._bufParams=z};Qc.prototype.getOffsetCurve=function(v,z){if(this._distance=
z,0===z)return null;var u=0>z;z=this.getSegGen(Math.abs(z));1>=v.length?this.computePointCurve(v[0],z):this.computeOffsetCurve(v,u,z);v=z.getCoordinates();return u&&ab.reverse(v),v};Qc.prototype.computeSingleSidedBufferCurve=function(v,z,u){var y=this.simplifyTolerance(this._distance);if(z)for(u.addSegments(v,!0),v=bc.simplify(v,-y),z=v.length-1,u.initSideSegments(v[z],v[z-1],Aa.LEFT),u.addFirstSegment(),z-=2;0<=z;z--)u.addNextSegment(v[z],!0);else for(u.addSegments(v,!1),v=bc.simplify(v,y),z=v.length-
1,u.initSideSegments(v[0],v[1],Aa.LEFT),u.addFirstSegment(),y=2;y<=z;y++)u.addNextSegment(v[y],!0);u.addLastSegment();u.closeRing()};Qc.prototype.computeRingBufferCurve=function(v,z,u){var y=this.simplifyTolerance(this._distance);z===Aa.RIGHT&&(y=-y);v=bc.simplify(v,y);y=v.length-1;u.initSideSegments(v[y-1],v[0],z);for(z=1;z<=y;z++)u.addNextSegment(v[z],1!==z);u.closeRing()};Qc.prototype.computeLineBufferCurve=function(v,z){var u=this.simplifyTolerance(this._distance),y=bc.simplify(v,u),C=y.length-
1;z.initSideSegments(y[0],y[1],Aa.LEFT);for(var w=2;w<=C;w++)z.addNextSegment(y[w],!0);z.addLastSegment();z.addLineEndCap(y[C-1],y[C]);v=bc.simplify(v,-u);u=v.length-1;z.initSideSegments(v[u],v[u-1],Aa.LEFT);for(u-=2;0<=u;u--)z.addNextSegment(v[u],!0);z.addLastSegment();z.addLineEndCap(v[1],v[0]);z.closeRing()};Qc.prototype.computePointCurve=function(v,z){switch(this._bufParams.getEndCapStyle()){case Gb.CAP_ROUND:z.createCircle(v);break;case Gb.CAP_SQUARE:z.createSquare(v)}};Qc.prototype.getLineCurve=
function(v,z){if((this._distance=z,0>z&&!this._bufParams.isSingleSided())||0===z)return null;var u=this.getSegGen(Math.abs(z));1>=v.length?this.computePointCurve(v[0],u):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(v,0>z,u):this.computeLineBufferCurve(v,u);return u.getCoordinates()};Qc.prototype.getBufferParameters=function(){return this._bufParams};Qc.prototype.simplifyTolerance=function(v){return v*this._bufParams.getSimplifyFactor()};Qc.prototype.getRingCurve=function(v,z,
u){if(this._distance=u,2>=v.length)return this.getLineCurve(v,u);if(0===u)return Qc.copyCoordinates(v);u=this.getSegGen(u);return this.computeRingBufferCurve(v,z,u),u.getCoordinates()};Qc.prototype.computeOffsetCurve=function(v,z,u){var y=this.simplifyTolerance(this._distance);if(z)for(v=bc.simplify(v,-y),z=v.length-1,u.initSideSegments(v[z],v[z-1],Aa.LEFT),u.addFirstSegment(),z-=2;0<=z;z--)u.addNextSegment(v[z],!0);else for(v=bc.simplify(v,y),z=v.length-1,u.initSideSegments(v[0],v[1],Aa.LEFT),u.addFirstSegment(),
y=2;y<=z;y++)u.addNextSegment(v[y],!0);u.addLastSegment()};Qc.prototype.getSegGen=function(v){return new Ub(this._precisionModel,this._bufParams,v)};Qc.prototype.interfaces_=function(){return[]};Qc.prototype.getClass=function(){return Qc};Qc.copyCoordinates=function(v){for(var z=Array(v.length).fill(null),u=0;u<z.length;u++)z[u]=new sa(v[u]);return z};var wf=function(v){this._subgraphs=null;this._seg=new Na;this._cga=new Da;this._subgraphs=v},sn={DepthSegment:{configurable:!0}};wf.prototype.findStabbedSegments=
function(){if(1===arguments.length){for(var v=arguments[0],z=new Fa,u=this._subgraphs.iterator();u.hasNext();){var y=u.next(),C=y.getEnvelope();v.y<C.getMinY()||v.y>C.getMaxY()||this.findStabbedSegments(v,y.getDirectedEdges(),z)}return z}if(3===arguments.length)if(Va(arguments[2],ue)&&arguments[0]instanceof sa&&arguments[1]instanceof Mj)for(v=arguments[0],z=arguments[1],u=arguments[2],y=z.getEdge().getCoordinates(),C=0;C<y.length-1;C++){if(this._seg.p0=y[C],this._seg.p1=y[C+1],this._seg.p0.y>this._seg.p1.y&&
this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<v.x||this._seg.isHorizontal()||v.y<this._seg.p0.y||v.y>this._seg.p1.y||Da.computeOrientation(this._seg.p0,this._seg.p1,v)===Da.RIGHT)){var w=z.getDepth(Aa.LEFT);this._seg.p0.equals(y[C])||(w=z.getDepth(Aa.RIGHT));w=new Ze(this._seg,w);u.add(w)}}else if(Va(arguments[2],ue)&&arguments[0]instanceof sa&&Va(arguments[1],ue))for(v=arguments[0],z=arguments[2],u=arguments[1].iterator();u.hasNext();)y=u.next(),y.isForward()&&this.findStabbedSegments(v,
y,z)};wf.prototype.getDepth=function(v){v=this.findStabbedSegments(v);return 0===v.size()?0:Kd.min(v)._leftDepth};wf.prototype.interfaces_=function(){return[]};wf.prototype.getClass=function(){return wf};sn.DepthSegment.get=function(){return Ze};Object.defineProperties(wf,sn);var Ze=function(v,z){this._leftDepth=this._upwardSeg=null;this._upwardSeg=new Na(v);this._leftDepth=z};Ze.prototype.compareTo=function(v){if(this._upwardSeg.minX()>=v._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=v._upwardSeg.minX())return-1;
var z=this._upwardSeg.orientationIndex(v._upwardSeg);return 0!==z||0!==(z=-1*v._upwardSeg.orientationIndex(this._upwardSeg))?z:this._upwardSeg.compareTo(v._upwardSeg)};Ze.prototype.compareX=function(v,z){var u=v.p0.compareTo(z.p0);return 0!==u?u:v.p1.compareTo(z.p1)};Ze.prototype.toString=function(){return this._upwardSeg.toString()};Ze.prototype.interfaces_=function(){return[jd]};Ze.prototype.getClass=function(){return Ze};var Hb=function(v,z,u){this.p0=v||null;this.p1=z||null;this.p2=u||null};Hb.prototype.area=
function(){return Hb.area(this.p0,this.p1,this.p2)};Hb.prototype.signedArea=function(){return Hb.signedArea(this.p0,this.p1,this.p2)};Hb.prototype.interpolateZ=function(v){if(null===v)throw new ac("Supplied point is null.");return Hb.interpolateZ(v,this.p0,this.p1,this.p2)};Hb.prototype.longestSideLength=function(){return Hb.longestSideLength(this.p0,this.p1,this.p2)};Hb.prototype.isAcute=function(){return Hb.isAcute(this.p0,this.p1,this.p2)};Hb.prototype.circumcentre=function(){return Hb.circumcentre(this.p0,
this.p1,this.p2)};Hb.prototype.area3D=function(){return Hb.area3D(this.p0,this.p1,this.p2)};Hb.prototype.centroid=function(){return Hb.centroid(this.p0,this.p1,this.p2)};Hb.prototype.inCentre=function(){return Hb.inCentre(this.p0,this.p1,this.p2)};Hb.prototype.interfaces_=function(){return[]};Hb.prototype.getClass=function(){return Hb};Hb.area=function(v,z,u){return Math.abs(((u.x-v.x)*(z.y-v.y)-(z.x-v.x)*(u.y-v.y))/2)};Hb.signedArea=function(v,z,u){return((u.x-v.x)*(z.y-v.y)-(z.x-v.x)*(u.y-v.y))/
2};Hb.det=function(v,z,u,y){return v*y-z*u};Hb.interpolateZ=function(v,z,u,y){var C=z.x,w=z.y,x=u.x-C,B=y.x-C,E=u.y-w,G=y.y-w,P=x*G-B*E;C=v.x-C;v=v.y-w;return z.z+(G*C-B*v)/P*(u.z-z.z)+(-E*C+x*v)/P*(y.z-z.z)};Hb.longestSideLength=function(v,z,u){var y=v.distance(z);z=z.distance(u);v=u.distance(v);return z>y&&(y=z),v>y&&(y=v),y};Hb.isAcute=function(v,z,u){return!!cb.isAcute(v,z,u)&&!!cb.isAcute(z,u,v)&&!!cb.isAcute(u,v,z)};Hb.circumcentre=function(v,z,u){var y=u.x;u=u.y;var C=v.x-y;v=v.y-u;var w=z.x-
y,x=z.y-u;z=2*Hb.det(C,v,w,x);var B=Hb.det(v,C*C+v*v,x,w*w+x*x);C=Hb.det(C,C*C+v*v,w,w*w+x*x);return new sa(y-B/z,u+C/z)};Hb.perpendicularBisector=function(v,z){var u=z.x-v.x,y=z.y-v.y;z=new sd(v.x+u/2,v.y+y/2,1);v=new sd(v.x-y+u/2,v.y+u+y/2,1);return new sd(z,v)};Hb.angleBisector=function(v,z,u){var y=z.distance(v);z=y/(y+z.distance(u));return new sa(v.x+z*(u.x-v.x),v.y+z*(u.y-v.y))};Hb.area3D=function(v,z,u){var y=z.x-v.x,C=z.y-v.y,w=z.z-v.z;z=u.x-v.x;var x=u.y-v.y;u=u.z-v.z;v=C*u-w*x;w=w*z-y*u;
y=y*x-C*z;return Math.sqrt(v*v+w*w+y*y)/2};Hb.centroid=function(v,z,u){return new sa((v.x+z.x+u.x)/3,(v.y+z.y+u.y)/3)};Hb.inCentre=function(v,z,u){var y=z.distance(u),C=v.distance(u),w=v.distance(z),x=y+C+w;return new sa((y*v.x+C*z.x+w*u.x)/x,(y*v.y+C*z.y+w*u.y)/x)};var od=function(v,z,u){this._curveBuilder=this._distance=this._inputGeom=null;this._curveList=new Fa;this._inputGeom=v;this._distance=z;this._curveBuilder=u};od.prototype.addPoint=function(v){if(0>=this._distance)return null;v=v.getCoordinates();
v=this._curveBuilder.getLineCurve(v,this._distance);this.addCurve(v,ua.EXTERIOR,ua.INTERIOR)};od.prototype.addPolygon=function(v){var z=this._distance,u=Aa.LEFT;0>this._distance&&(z=-this._distance,u=Aa.RIGHT);var y=v.getExteriorRing(),C=ab.removeRepeatedPoints(y.getCoordinates());if(0>this._distance&&this.isErodedCompletely(y,this._distance)||0>=this._distance&&3>C.length)return null;this.addPolygonRing(C,z,u,ua.EXTERIOR,ua.INTERIOR);for(y=0;y<v.getNumInteriorRing();y++){C=v.getInteriorRingN(y);
var w=ab.removeRepeatedPoints(C.getCoordinates());0<this._distance&&this.isErodedCompletely(C,-this._distance)||this.addPolygonRing(w,z,Aa.opposite(u),ua.INTERIOR,ua.EXTERIOR)}};od.prototype.isTriangleErodedCompletely=function(v,z){v=new Hb(v[0],v[1],v[2]);var u=v.inCentre();return Da.distancePointLine(u,v.p0,v.p1)<Math.abs(z)};od.prototype.addLineString=function(v){if(0>=this._distance&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;v=ab.removeRepeatedPoints(v.getCoordinates());
v=this._curveBuilder.getLineCurve(v,this._distance);this.addCurve(v,ua.EXTERIOR,ua.INTERIOR)};od.prototype.addCurve=function(v,z,u){if(null===v||2>v.length)return null;v=new ec(v,new Jb(0,ua.BOUNDARY,z,u));this._curveList.add(v)};od.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};od.prototype.addPolygonRing=function(v,z,u,y,C){if(0===z&&v.length<Yd.MINIMUM_VALID_SIZE)return null;var w=y,x=C;v.length>=Yd.MINIMUM_VALID_SIZE&&Da.isCCW(v)&&(w=C,x=y,u=Aa.opposite(u));v=
this._curveBuilder.getRingCurve(v,u,z);this.addCurve(v,w,x)};od.prototype.add=function(v){if(v.isEmpty())return null;v instanceof Fd?this.addPolygon(v):v instanceof Hc?this.addLineString(v):v instanceof Xd?this.addPoint(v):(v instanceof ag||v instanceof We||v instanceof Fe||v instanceof ud)&&this.addCollection(v)};od.prototype.isErodedCompletely=function(v,z){var u=v.getCoordinates();if(4>u.length)return 0>z;if(4===u.length)return this.isTriangleErodedCompletely(u,z);v=v.getEnvelopeInternal();v=Math.min(v.getHeight(),
v.getWidth());return 0>z&&2*Math.abs(z)>v};od.prototype.addCollection=function(v){for(var z=0;z<v.getNumGeometries();z++){var u=v.getGeometryN(z);this.add(u)}};od.prototype.interfaces_=function(){return[]};od.prototype.getClass=function(){return od};var eg=function(){};eg.prototype.locate=function(v){};eg.prototype.interfaces_=function(){return[]};eg.prototype.getClass=function(){return eg};var ae=function(v){this._subcollectionIterator=this._max=null;this._parent=v;this._atStart=!0;this._index=0;
this._max=v.getNumGeometries()};ae.prototype.next=function(){if(this._atStart)return this._atStart=!1,ae.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Mf;var v=this._parent.getGeometryN(this._index++);return v instanceof ud?(this._subcollectionIterator=new ae(v),this._subcollectionIterator.next()):v};ae.prototype.remove=
function(){throw Error(this.getClass().getName());};ae.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};ae.prototype.interfaces_=function(){return[Zf]};ae.prototype.getClass=function(){return ae};ae.isAtomic=function(v){return!(v instanceof ud)};var fd=function(v){this._geom=v};fd.prototype.locate=function(v){return fd.locate(v,this._geom)};
fd.prototype.interfaces_=function(){return[eg]};fd.prototype.getClass=function(){return fd};fd.isPointInRing=function(v,z){return!!z.getEnvelopeInternal().intersects(v)&&Da.isPointInRing(v,z.getCoordinates())};fd.containsPointInPolygon=function(v,z){if(z.isEmpty())return!1;var u=z.getExteriorRing();if(!fd.isPointInRing(v,u))return!1;for(u=0;u<z.getNumInteriorRing();u++){var y=z.getInteriorRingN(u);if(fd.isPointInRing(v,y))return!1}return!0};fd.containsPoint=function(v,z){if(z instanceof Fd)return fd.containsPointInPolygon(v,
z);if(z instanceof ud)for(var u=new ae(z);u.hasNext();){var y=u.next();if(y!==z&&fd.containsPoint(v,y))return!0}return!1};fd.locate=function(v,z){return z.isEmpty()?ua.EXTERIOR:fd.containsPoint(v,z)?ua.INTERIOR:ua.EXTERIOR};var Cc=function(){this._edgeMap=new Ac;this._edgeList=null;this._ptInAreaLocation=[ua.NONE,ua.NONE]};Cc.prototype.getNextCW=function(v){this.getEdges();v=this._edgeList.indexOf(v);var z=v-1;return 0===v&&(z=this._edgeList.size()-1),this._edgeList.get(z)};Cc.prototype.propagateSideLabels=
function(v){for(var z=ua.NONE,u=this.iterator();u.hasNext();){var y=u.next().getLabel();y.isArea(v)&&y.getLocation(v,Aa.LEFT)!==ua.NONE&&(z=y.getLocation(v,Aa.LEFT))}if(z===ua.NONE)return null;for(u=this.iterator();u.hasNext();){y=u.next();var C=y.getLabel();if(C.getLocation(v,Aa.ON)===ua.NONE&&C.setLocation(v,Aa.ON,z),C.isArea(v)){var w=C.getLocation(v,Aa.LEFT),x=C.getLocation(v,Aa.RIGHT);if(x!==ua.NONE){if(x!==z)throw new we("side location conflict",y.getCoordinate());w===ua.NONE&&Xa.shouldNeverReachHere("found single null side (at "+
y.getCoordinate()+")");z=w}else Xa.isTrue(C.getLocation(v,Aa.LEFT)===ua.NONE,"found single null side"),C.setLocation(v,Aa.RIGHT,z),C.setLocation(v,Aa.LEFT,z)}}};Cc.prototype.getCoordinate=function(){var v=this.iterator();return v.hasNext()?v.next().getCoordinate():null};Cc.prototype.print=function(v){Oc.out.println("EdgeEndStar:   "+this.getCoordinate());for(var z=this.iterator();z.hasNext();)z.next().print(v)};Cc.prototype.isAreaLabelsConsistent=function(v){return this.computeEdgeEndLabels(v.getBoundaryNodeRule()),
this.checkAreaLabelsConsistent(0)};Cc.prototype.checkAreaLabelsConsistent=function(v){var z=this.getEdges();if(0>=z.size())return!0;var u=z.size()-1;z=z.get(u).getLabel().getLocation(v,Aa.LEFT);Xa.isTrue(z!==ua.NONE,"Found unlabelled area edge");for(u=this.iterator();u.hasNext();){var y=u.next().getLabel();Xa.isTrue(y.isArea(v),"Found non-area edge");var C=y.getLocation(v,Aa.LEFT);y=y.getLocation(v,Aa.RIGHT);if(C===y||y!==z)return!1;z=C}return!0};Cc.prototype.findIndex=function(v){this.iterator();
for(var z=0;z<this._edgeList.size();z++)if(this._edgeList.get(z)===v)return z;return-1};Cc.prototype.iterator=function(){return this.getEdges().iterator()};Cc.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Fa(this._edgeMap.values())),this._edgeList};Cc.prototype.getLocation=function(v,z,u){return this._ptInAreaLocation[v]===ua.NONE&&(this._ptInAreaLocation[v]=fd.locate(z,u[v].getGeometry())),this._ptInAreaLocation[v]};Cc.prototype.toString=function(){var v=new Cd;
v.append("EdgeEndStar:   "+this.getCoordinate());v.append("\n");for(var z=this.iterator();z.hasNext();){var u=z.next();v.append(u);v.append("\n")}return v.toString()};Cc.prototype.computeEdgeEndLabels=function(v){for(var z=this.iterator();z.hasNext();)z.next().computeLabel(v)};Cc.prototype.computeLabelling=function(v){this.computeEdgeEndLabels(v[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);for(var z=[!1,!1],u=this.iterator();u.hasNext();)for(var y=u.next().getLabel(),
C=0;2>C;C++)y.isLine(C)&&y.getLocation(C)===ua.BOUNDARY&&(z[C]=!0);for(u=this.iterator();u.hasNext();){y=u.next();C=y.getLabel();for(var w=0;2>w;w++)if(C.isAnyNull(w)){if(z[w])var x=ua.EXTERIOR;else x=y.getCoordinate(),x=this.getLocation(w,x,v);C.setAllLocationsIfNull(w,x)}}};Cc.prototype.getDegree=function(){return this._edgeMap.size()};Cc.prototype.insertEdgeEnd=function(v,z){this._edgeMap.put(v,z);this._edgeList=null};Cc.prototype.interfaces_=function(){return[]};Cc.prototype.getClass=function(){return Cc};
var Fp=function(v){function z(){v.call(this);this._label=this._resultAreaEdgeList=null;this._SCANNING_FOR_INCOMING=1;this._LINKING_TO_OUTGOING=2}return v&&(z.__proto__=v),z.prototype=Object.create(v&&v.prototype),z.prototype.constructor=z,z.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var u=null,y=null,C=this._SCANNING_FOR_INCOMING,w=0;w<this._resultAreaEdgeList.size();w++){var x=this._resultAreaEdgeList.get(w),B=x.getSym();if(x.getLabel().isArea())switch(null===u&&x.isInResult()&&
(u=x),C){case this._SCANNING_FOR_INCOMING:if(!B.isInResult())continue;y=B;C=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:x.isInResult()&&(y.setNext(x),C=this._SCANNING_FOR_INCOMING)}}if(C===this._LINKING_TO_OUTGOING){if(null===u)throw new we("no outgoing dirEdge found",this.getCoordinate());Xa.isTrue(u.isInResult(),"unable to link last incoming dirEdge");y.setNext(u)}},z.prototype.insert=function(u){this.insertEdgeEnd(u,u)},z.prototype.getRightmostEdge=function(){var u=this.getEdges(),
y=u.size();if(1>y)return null;var C=u.get(0);if(1===y)return C;u=u.get(y-1);y=C.getQuadrant();var w=u.getQuadrant();return Mb.isNorthern(y)&&Mb.isNorthern(w)?C:Mb.isNorthern(y)||Mb.isNorthern(w)?0!==C.getDy()?C:0!==u.getDy()?u:(Xa.shouldNeverReachHere("found two horizontal edges incident on node"),null):u},z.prototype.print=function(u){Oc.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var y=this.iterator();y.hasNext();){var C=y.next();u.print("out ");C.print(u);u.println();u.print("in ");
C.getSym().print(u);u.println()}},z.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Fa;for(var u=this.iterator();u.hasNext();){var y=u.next();(y.isInResult()||y.getSym().isInResult())&&this._resultAreaEdgeList.add(y)}return this._resultAreaEdgeList},z.prototype.updateLabelling=function(u){for(var y=this.iterator();y.hasNext();){var C=y.next().getLabel();C.setAllLocationsIfNull(0,u.getLocation(0));C.setAllLocationsIfNull(1,
u.getLocation(1))}},z.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var u=null,y=null,C=this._edgeList.size()-1;0<=C;C--){var w=this._edgeList.get(C),x=w.getSym();null===y&&(y=x);null!==u&&x.setNext(u);u=w}y.setNext(u)},z.prototype.computeDepths=function(){if(1===arguments.length){var u=arguments[0],y=this.findIndex(u),C=u.getDepth(Aa.LEFT),w=u.getDepth(Aa.RIGHT);C=this.computeDepths(y+1,this._edgeList.size(),C);if(this.computeDepths(0,y,C)!==w)throw new we("depth mismatch at "+u.getCoordinate());
}else if(3===arguments.length){u=arguments[1];y=arguments[2];for(w=arguments[0];w<u;w++)C=this._edgeList.get(w),C.setEdgeDepths(Aa.RIGHT,y),y=C.getDepth(Aa.LEFT);return y}},z.prototype.mergeSymLabels=function(){for(var u=this.iterator();u.hasNext();){var y=u.next();y.getLabel().merge(y.getSym().getLabel())}},z.prototype.linkMinimalDirectedEdges=function(u){for(var y=null,C=null,w=this._SCANNING_FOR_INCOMING,x=this._resultAreaEdgeList.size()-1;0<=x;x--){var B=this._resultAreaEdgeList.get(x),E=B.getSym();
switch(null===y&&B.getEdgeRing()===u&&(y=B),w){case this._SCANNING_FOR_INCOMING:if(E.getEdgeRing()!==u)continue;C=E;w=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:B.getEdgeRing()===u&&(C.setNextMin(B),w=this._SCANNING_FOR_INCOMING)}}w===this._LINKING_TO_OUTGOING&&(Xa.isTrue(null!==y,"found null for first outgoing dirEdge"),Xa.isTrue(y.getEdgeRing()===u,"unable to link last incoming dirEdge"),C.setNextMin(y))},z.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var u=
0,y=this.iterator();y.hasNext();)y.next().isInResult()&&u++;return u}if(1===arguments.length){u=arguments[0];y=0;for(var C=this.iterator();C.hasNext();)C.next().getEdgeRing()===u&&y++;return y}},z.prototype.getLabel=function(){return this._label},z.prototype.findCoveredLineEdges=function(){for(var u=ua.NONE,y=this.iterator();y.hasNext();){var C=y.next(),w=C.getSym();if(!C.isLineEdge()){if(C.isInResult()){u=ua.INTERIOR;break}if(w.isInResult()){u=ua.EXTERIOR;break}}}if(u===ua.NONE)return null;for(y=
this.iterator();y.hasNext();)C=y.next(),w=C.getSym(),C.isLineEdge()?C.getEdge().setCovered(u===ua.INTERIOR):(C.isInResult()&&(u=ua.EXTERIOR),w.isInResult()&&(u=ua.INTERIOR))},z.prototype.computeLabelling=function(u){v.prototype.computeLabelling.call(this,u);this._label=new Jb(ua.NONE);for(u=this.iterator();u.hasNext();)for(var y=u.next().getEdge().getLabel(),C=0;2>C;C++){var w=y.getLocation(C);w!==ua.INTERIOR&&w!==ua.BOUNDARY||this._label.setLocation(C,ua.INTERIOR)}},z.prototype.interfaces_=function(){return[]},
z.prototype.getClass=function(){return z},z}(Cc),tn=function(v){function z(){v.apply(this,arguments)}return v&&(z.__proto__=v),z.prototype=Object.create(v&&v.prototype),z.prototype.constructor=z,z.prototype.createNode=function(u){return new hi(u,new Fp)},z.prototype.interfaces_=function(){return[]},z.prototype.getClass=function(){return z},z}(bg),Ie=function u(z){this._orientation=null;this._pts=z;this._orientation=u.orientation(z)};Ie.prototype.compareTo=function(z){return Ie.compareOriented(this._pts,
this._orientation,z._pts,z._orientation)};Ie.prototype.interfaces_=function(){return[jd]};Ie.prototype.getClass=function(){return Ie};Ie.orientation=function(z){return 1===ab.increasingDirection(z)};Ie.compareOriented=function(z,u,y,C){var w=u?1:-1,x=C?1:-1,B=u?z.length:-1,E=C?y.length:-1;u=u?0:z.length-1;for(C=C?0:y.length-1;;){var G=z[u].compareTo(y[C]);if(0!==G)return G;G=(u+=w)===B;var P=(C+=x)===E;if(G&&!P)return-1;if(!G&&P)return 1;if(G&&P)return 0}};var wd=function(){this._edges=new Fa;this._ocaMap=
new Ac};wd.prototype.print=function(z){z.print("MULTILINESTRING ( ");for(var u=0;u<this._edges.size();u++){var y=this._edges.get(u);0<u&&z.print(",");z.print("(");y=y.getCoordinates();for(var C=0;C<y.length;C++)0<C&&z.print(","),z.print(y[C].x+" "+y[C].y);z.println(")")}z.print(")  ")};wd.prototype.addAll=function(z){for(z=z.iterator();z.hasNext();)this.add(z.next())};wd.prototype.findEdgeIndex=function(z){for(var u=0;u<this._edges.size();u++)if(this._edges.get(u).equals(z))return u;return-1};wd.prototype.iterator=
function(){return this._edges.iterator()};wd.prototype.getEdges=function(){return this._edges};wd.prototype.get=function(z){return this._edges.get(z)};wd.prototype.findEqualEdge=function(z){z=new Ie(z.getCoordinates());return this._ocaMap.get(z)};wd.prototype.add=function(z){this._edges.add(z);var u=new Ie(z.getCoordinates());this._ocaMap.put(u,z)};wd.prototype.interfaces_=function(){return[]};wd.prototype.getClass=function(){return wd};var $e=function(){};$e.prototype.processIntersections=function(z,
u,y,C){};$e.prototype.isDone=function(){};$e.prototype.interfaces_=function(){return[]};$e.prototype.getClass=function(){return $e};var gd=function(z){this._hasInterior=this._hasProperInterior=this._hasProper=this._hasIntersection=!1;this._isSelfIntersection=this._properIntersectionPoint=null;this.numTests=this.numProperIntersections=this.numInteriorIntersections=this.numIntersections=0;this._li=z};gd.prototype.isTrivialIntersection=function(z,u,y,C){return z===y&&1===this._li.getIntersectionNum()&&
(gd.isAdjacentSegments(u,C)||z.isClosed()&&(z=z.size()-1,0===u&&C===z||0===C&&u===z))?!0:!1};gd.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};gd.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};gd.prototype.getLineIntersector=function(){return this._li};gd.prototype.hasProperIntersection=function(){return this._hasProper};gd.prototype.processIntersections=function(z,u,y,C){if(z===y&&u===C)return null;this.numTests++;var w=z.getCoordinates()[u],
x=z.getCoordinates()[u+1],B=y.getCoordinates()[C],E=y.getCoordinates()[C+1];this._li.computeIntersection(w,x,B,E);this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(z,u,y,C)||(this._hasIntersection=!0,z.addIntersections(this._li,u,0),y.addIntersections(this._li,C,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};gd.prototype.hasIntersection=
function(){return this._hasIntersection};gd.prototype.isDone=function(){return!1};gd.prototype.hasInteriorIntersection=function(){return this._hasInterior};gd.prototype.interfaces_=function(){return[$e]};gd.prototype.getClass=function(){return gd};gd.isAdjacentSegments=function(z,u){return 1===Math.abs(z-u)};var Md=function(z,u,y){this.dist=this.segmentIndex=this.coord=null;this.coord=new sa(z);this.segmentIndex=u;this.dist=y};Md.prototype.getSegmentIndex=function(){return this.segmentIndex};Md.prototype.getCoordinate=
function(){return this.coord};Md.prototype.print=function(z){z.print(this.coord);z.print(" seg # = "+this.segmentIndex);z.println(" dist = "+this.dist)};Md.prototype.compareTo=function(z){return this.compare(z.segmentIndex,z.dist)};Md.prototype.isEndPoint=function(z){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===z};Md.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Md.prototype.getDistance=function(){return this.dist};Md.prototype.compare=
function(z,u){return this.segmentIndex<z?-1:this.segmentIndex>z?1:this.dist<u?-1:this.dist>u?1:0};Md.prototype.interfaces_=function(){return[jd]};Md.prototype.getClass=function(){return Md};var be=function(z){this._nodeMap=new Ac;this.edge=z};be.prototype.print=function(z){z.println("Intersections:");for(var u=this.iterator();u.hasNext();)u.next().print(z)};be.prototype.iterator=function(){return this._nodeMap.values().iterator()};be.prototype.addSplitEdges=function(z){this.addEndpoints();for(var u=
this.iterator(),y=u.next();u.hasNext();){var C=u.next();y=this.createSplitEdge(y,C);z.add(y);y=C}};be.prototype.addEndpoints=function(){var z=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0);this.add(this.edge.pts[z],z,0)};be.prototype.createSplitEdge=function(z,u){var y=u.segmentIndex-z.segmentIndex+2,C=this.edge.pts[u.segmentIndex];(C=0<u.dist||!u.coord.equals2D(C))||y--;y=Array(y).fill(null);var w=0;y[w++]=new sa(z.coord);for(z=z.segmentIndex+1;z<=u.segmentIndex;z++)y[w++]=this.edge.pts[z];
return C&&(y[w]=u.coord),new ji(y,new Jb(this.edge._label))};be.prototype.add=function(z,u,y){z=new Md(z,u,y);u=this._nodeMap.get(z);return null!==u?u:(this._nodeMap.put(z,z),z)};be.prototype.isIntersection=function(z){for(var u=this.iterator();u.hasNext();)if(u.next().coord.equals(z))return!0;return!1};be.prototype.interfaces_=function(){return[]};be.prototype.getClass=function(){return be};var af=function(){};af.prototype.getChainStartIndices=function(z){var u=0,y=new Fa;y.add(new Dd(u));do u=this.findChainEnd(z,
u),y.add(new Dd(u));while(u<z.length-1);return af.toIntArray(y)};af.prototype.findChainEnd=function(z,u){var y=Mb.quadrant(z[u],z[u+1]);for(u+=1;u<z.length&&Mb.quadrant(z[u-1],z[u])===y;)u++;return u-1};af.prototype.interfaces_=function(){return[]};af.prototype.getClass=function(){return af};af.toIntArray=function(z){for(var u=Array(z.size()).fill(null),y=0;y<u.length;y++)u[y]=z.get(y).intValue();return u};var ze=function(z){this.startIndex=this.pts=this.e=null;this.env1=new Ia;this.env2=new Ia;this.e=
z;this.pts=z.getCoordinates();this.startIndex=(new af).getChainStartIndices(this.pts)};ze.prototype.getCoordinates=function(){return this.pts};ze.prototype.getMaxX=function(z){var u=this.pts[this.startIndex[z]].x;z=this.pts[this.startIndex[z+1]].x;return u>z?u:z};ze.prototype.getMinX=function(z){var u=this.pts[this.startIndex[z]].x;z=this.pts[this.startIndex[z+1]].x;return u<z?u:z};ze.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var z=arguments[0],u=arguments[1],y=arguments[2];
this.computeIntersectsForChain(this.startIndex[z],this.startIndex[z+1],u,u.startIndex[y],u.startIndex[y+1],arguments[3])}else if(6===arguments.length){z=arguments[0];u=arguments[1];y=arguments[2];var C=arguments[3],w=arguments[4],x=arguments[5],B=this.pts[z],E=this.pts[u],G=y.pts[C],P=y.pts[w];if(1==u-z&&1==w-C)return x.addIntersections(this.e,z,y.e,C),null;if(this.env1.init(B,E),this.env2.init(G,P),!this.env1.intersects(this.env2))return null;B=Math.trunc((z+u)/2);E=Math.trunc((C+w)/2);z<B&&(C<E&&
this.computeIntersectsForChain(z,B,y,C,E,x),E<w&&this.computeIntersectsForChain(z,B,y,E,w,x));B<u&&(C<E&&this.computeIntersectsForChain(B,u,y,C,E,x),E<w&&this.computeIntersectsForChain(B,u,y,E,w,x))}};ze.prototype.getStartIndexes=function(){return this.startIndex};ze.prototype.computeIntersects=function(z,u){for(var y=0;y<this.startIndex.length-1;y++)for(var C=0;C<z.startIndex.length-1;C++)this.computeIntersectsForChain(y,z,C,u)};ze.prototype.interfaces_=function(){return[]};ze.prototype.getClass=
function(){return ze};var yc=function u(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var y=0;2>y;y++)for(var C=0;3>C;C++)this._depth[y][C]=u.NULL_VALUE},un={NULL_VALUE:{configurable:!0}};yc.prototype.getDepth=function(u,y){return this._depth[u][y]};yc.prototype.setDepth=function(u,y,C){this._depth[u][y]=C};yc.prototype.isNull=function(){if(0===arguments.length){for(var u=0;2>u;u++)for(var y=0;3>y;y++)if(this._depth[u][y]!==yc.NULL_VALUE)return!1;return!0}if(1===arguments.length)return this._depth[arguments[0]][1]===
yc.NULL_VALUE;if(2===arguments.length)return this._depth[arguments[0]][arguments[1]]===yc.NULL_VALUE};yc.prototype.normalize=function(){for(var u=0;2>u;u++)if(!this.isNull(u)){var y=this._depth[u][1];this._depth[u][2]<y&&(y=this._depth[u][2]);0>y&&(y=0);for(var C=1;3>C;C++){var w=0;this._depth[u][C]>y&&(w=1);this._depth[u][C]=w}}};yc.prototype.getDelta=function(u){return this._depth[u][Aa.RIGHT]-this._depth[u][Aa.LEFT]};yc.prototype.getLocation=function(u,y){return 0>=this._depth[u][y]?ua.EXTERIOR:
ua.INTERIOR};yc.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};yc.prototype.add=function(){if(1===arguments.length)for(var u=arguments[0],y=0;2>y;y++)for(var C=1;3>C;C++){var w=u.getLocation(y,C);w!==ua.EXTERIOR&&w!==ua.INTERIOR||(this.isNull(y,C)?this._depth[y][C]=yc.depthAtLocation(w):this._depth[y][C]+=yc.depthAtLocation(w))}else 3===arguments.length&&(u=arguments[0],y=arguments[1],arguments[2]===ua.INTERIOR&&this._depth[u][y]++)};
yc.prototype.interfaces_=function(){return[]};yc.prototype.getClass=function(){return yc};yc.depthAtLocation=function(u){return u===ua.EXTERIOR?0:u===ua.INTERIOR?1:yc.NULL_VALUE};un.NULL_VALUE.get=function(){return-1};Object.defineProperties(yc,un);var ji=function(u){function y(){if(u.call(this),this.pts=null,this._env=null,this.eiList=new be(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new yc,this._depthDelta=0,1===arguments.length)y.call(this,arguments[0],null);else if(2===
arguments.length){var C=arguments[1];this.pts=arguments[0];this._label=C}}return u&&(y.__proto__=u),y.prototype=Object.create(u&&u.prototype),y.prototype.constructor=y,y.prototype.getDepth=function(){return this._depth},y.prototype.getCollapsedEdge=function(){var C=Array(2).fill(null);return C[0]=this.pts[0],C[1]=this.pts[1],new y(C,Jb.toLineLabel(this._label))},y.prototype.isIsolated=function(){return this._isIsolated},y.prototype.getCoordinates=function(){return this.pts},y.prototype.setIsolated=
function(C){this._isIsolated=C},y.prototype.setName=function(C){this._name=C},y.prototype.equals=function(C){if(!(C instanceof y)||this.pts.length!==C.pts.length)return!1;for(var w=!0,x=!0,B=this.pts.length,E=0;E<this.pts.length;E++)if(this.pts[E].equals2D(C.pts[E])||(w=!1),this.pts[E].equals2D(C.pts[--B])||(x=!1),!w&&!x)return!1;return!0},y.prototype.getCoordinate=function(){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length)return this.pts[arguments[0]]},y.prototype.print=
function(C){C.print("edge "+this._name+": ");C.print("LINESTRING (");for(var w=0;w<this.pts.length;w++)0<w&&C.print(","),C.print(this.pts[w].x+" "+this.pts[w].y);C.print(")  "+this._label+" "+this._depthDelta)},y.prototype.computeIM=function(C){y.updateIM(this._label,C)},y.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},y.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},y.prototype.getMaximumSegmentIndex=
function(){return this.pts.length-1},y.prototype.getDepthDelta=function(){return this._depthDelta},y.prototype.getNumPoints=function(){return this.pts.length},y.prototype.printReverse=function(C){C.print("edge "+this._name+": ");for(var w=this.pts.length-1;0<=w;w--)C.print(this.pts[w]+" ");C.println("")},y.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new ze(this)),this._mce},y.prototype.getEnvelope=function(){if(null===this._env){this._env=new Ia;for(var C=0;C<this.pts.length;C++)this._env.expandToInclude(this.pts[C])}return this._env},
y.prototype.addIntersection=function(C,w,x,B){var E=new sa(C.getIntersection(B));C=C.getEdgeDistance(x,B);x=w+1;x<this.pts.length&&E.equals2D(this.pts[x])&&(w=x,C=0);this.eiList.add(E,w,C)},y.prototype.toString=function(){var C=new Cd;C.append("edge "+this._name+": ");C.append("LINESTRING (");for(var w=0;w<this.pts.length;w++)0<w&&C.append(","),C.append(this.pts[w].x+" "+this.pts[w].y);return C.append(")  "+this._label+" "+this._depthDelta),C.toString()},y.prototype.isPointwiseEqual=function(C){if(this.pts.length!==
C.pts.length)return!1;for(var w=0;w<this.pts.length;w++)if(!this.pts[w].equals2D(C.pts[w]))return!1;return!0},y.prototype.setDepthDelta=function(C){this._depthDelta=C},y.prototype.getEdgeIntersectionList=function(){return this.eiList},y.prototype.addIntersections=function(C,w,x){for(var B=0;B<C.getIntersectionNum();B++)this.addIntersection(C,w,x,B)},y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y.updateIM=function(){if(2!==arguments.length)return u.prototype.updateIM.apply(this,
arguments);var C=arguments[0],w=arguments[1];w.setAtLeastIfValid(C.getLocation(0,Aa.ON),C.getLocation(1,Aa.ON),1);C.isArea()&&(w.setAtLeastIfValid(C.getLocation(0,Aa.LEFT),C.getLocation(1,Aa.LEFT),2),w.setAtLeastIfValid(C.getLocation(0,Aa.RIGHT),C.getLocation(1,Aa.RIGHT),2))},y}(dd),Kc=function(u){this._graph=this._geomFact=this._workingNoder=this._workingPrecisionModel=null;this._edgeList=new wd;this._bufParams=u||null};Kc.prototype.setWorkingPrecisionModel=function(u){this._workingPrecisionModel=
u};Kc.prototype.insertUniqueEdge=function(u){var y=this._edgeList.findEqualEdge(u);if(null!==y){var C=y.getLabel(),w=u.getLabel();y.isPointwiseEqual(u)||(w=new Jb(u.getLabel())).flip();C.merge(w);u=Kc.depthDelta(w);u=y.getDepthDelta()+u;y.setDepthDelta(u)}else this._edgeList.add(u),u.setDepthDelta(Kc.depthDelta(u.getLabel()))};Kc.prototype.buildSubgraphs=function(u,y){var C=new Fa;for(u=u.iterator();u.hasNext();){var w=u.next(),x=w.getRightmostCoordinate();x=(new wf(C)).getDepth(x);w.computeDepth(x);
w.findResultEdges();C.add(w);y.add(w.getDirectedEdges(),w.getNodes())}};Kc.prototype.createSubgraphs=function(u){var y=new Fa;for(u=u.getNodes().iterator();u.hasNext();){var C=u.next();if(!C.isVisited()){var w=new Ic;w.create(C);y.add(w)}}return Kd.sort(y,Kd.reverseOrder()),y};Kc.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()};Kc.prototype.getNoder=function(u){if(null!==this._workingNoder)return this._workingNoder;var y=new Nj,C=new Te;return C.setPrecisionModel(u),
y.setSegmentIntersector(new gd(C)),y};Kc.prototype.buffer=function(u,y){var C=this._workingPrecisionModel;null===C&&(C=u.getPrecisionModel());this._geomFact=u.getFactory();var w=new Qc(C,this._bufParams);u=(new od(u,y,w)).getCurves();if(0>=u.size())return this.createEmptyResultGeometry();this.computeNodedEdges(u,C);this._graph=new Yb(new tn);this._graph.addEdges(this._edgeList.getEdges());C=this.createSubgraphs(this._graph);u=new Yc(this._geomFact);this.buildSubgraphs(C,u);C=u.getPolygons();return 0>=
C.size()?this.createEmptyResultGeometry():this._geomFact.buildGeometry(C)};Kc.prototype.computeNodedEdges=function(u,y){y=this.getNoder(y);y.computeNodes(u);for(u=y.getNodedSubstrings().iterator();u.hasNext();){y=u.next();var C=y.getCoordinates();2===C.length&&C[0].equals2D(C[1])||(C=y.getData(),y=new ji(y.getCoordinates(),new Jb(C)),this.insertUniqueEdge(y))}};Kc.prototype.setNoder=function(u){this._workingNoder=u};Kc.prototype.interfaces_=function(){return[]};Kc.prototype.getClass=function(){return Kc};
Kc.depthDelta=function(u){var y=u.getLocation(0,Aa.LEFT);u=u.getLocation(0,Aa.RIGHT);return y===ua.INTERIOR&&u===ua.EXTERIOR?1:y===ua.EXTERIOR&&u===ua.INTERIOR?-1:0};Kc.convertSegStrings=function(u){for(var y=new bb,C=new Fa;u.hasNext();){var w=u.next();w=y.createLineString(w.getCoordinates());C.add(w)}return y.buildGeometry(C)};var Je=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var u=arguments[1];this._noder=
arguments[0];this._scaleFactor=u;this._offsetY=this._offsetX=0;this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){u=arguments[1];var y=arguments[2],C=arguments[3];this._noder=arguments[0];this._scaleFactor=u;this._offsetX=y;this._offsetY=C;this._isScaled=!this.isIntegerPrecision()}};Je.prototype.rescale=function(u){if(Va(u,kc))for(u=u.iterator();u.hasNext();){var y=u.next();this.rescale(y.getCoordinates())}else if(u instanceof Array){for(y=0;y<u.length;y++)u[y].x=u[y].x/this._scaleFactor+
this._offsetX,u[y].y=u[y].y/this._scaleFactor+this._offsetY;2===u.length&&u[0].equals2D(u[1])&&Oc.out.println(u)}};Je.prototype.scale=function(u){if(Va(u,kc)){var y=new Fa;for(u=u.iterator();u.hasNext();){var C=u.next();y.add(new ec(this.scale(C.getCoordinates()),C.getData()))}return y}if(u instanceof Array){y=Array(u.length).fill(null);for(C=0;C<u.length;C++)y[C]=new sa(Math.round((u[C].x-this._offsetX)*this._scaleFactor),Math.round((u[C].y-this._offsetY)*this._scaleFactor),u[C].z);return ab.removeRepeatedPoints(y)}};
Je.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor};Je.prototype.getNodedSubstrings=function(){var u=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(u),u};Je.prototype.computeNodes=function(u){var y=u;this._isScaled&&(y=this.scale(u));this._noder.computeNodes(y)};Je.prototype.interfaces_=function(){return[Ye]};Je.prototype.getClass=function(){return Je};var Nd=function(u){this._li=new Te;this._segStrings=u},vn={fact:{configurable:!0}};Nd.prototype.checkEndPtVertexIntersections=
function(){if(0===arguments.length)for(var u=this._segStrings.iterator();u.hasNext();){var y=u.next().getCoordinates();this.checkEndPtVertexIntersections(y[0],this._segStrings);this.checkEndPtVertexIntersections(y[y.length-1],this._segStrings)}else if(2===arguments.length)for(u=arguments[0],y=arguments[1].iterator();y.hasNext();)for(var C=y.next().getCoordinates(),w=1;w<C.length-1;w++)if(C[w].equals(u))throw new re("found endpt/interior pt intersection at index "+w+" :pt "+u);};Nd.prototype.checkInteriorIntersections=
function(){if(0===arguments.length)for(var u=this._segStrings.iterator();u.hasNext();)for(var y=u.next(),C=this._segStrings.iterator();C.hasNext();){var w=C.next();this.checkInteriorIntersections(y,w)}else if(2===arguments.length){u=arguments[0];y=arguments[1];C=u.getCoordinates();w=y.getCoordinates();for(var x=0;x<C.length-1;x++)for(var B=0;B<w.length-1;B++)this.checkInteriorIntersections(u,x,y,B)}else if(4===arguments.length){w=arguments[0];x=arguments[1];y=arguments[2];C=arguments[3];if(w===y&&
x===C)return null;u=w.getCoordinates()[x];w=w.getCoordinates()[x+1];x=y.getCoordinates()[C];y=y.getCoordinates()[C+1];if(this._li.computeIntersection(u,w,x,y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,u,w)||this.hasInteriorIntersection(this._li,x,y)))throw new re("found non-noded intersection at "+u+"-"+w+" and "+x+"-"+y);}};Nd.prototype.checkValid=function(){this.checkEndPtVertexIntersections();this.checkInteriorIntersections();this.checkCollapses()};
Nd.prototype.checkCollapses=function(){if(0===arguments.length)for(var u=this._segStrings.iterator();u.hasNext();){var y=u.next();this.checkCollapses(y)}else if(1===arguments.length)for(u=arguments[0].getCoordinates(),y=0;y<u.length-2;y++)this.checkCollapse(u[y],u[y+1],u[y+2])};Nd.prototype.hasInteriorIntersection=function(u,y,C){for(var w=0;w<u.getIntersectionNum();w++){var x=u.getIntersection(w);if(!x.equals(y)&&!x.equals(C))return!0}return!1};Nd.prototype.checkCollapse=function(u,y,C){if(u.equals(C))throw new re("found non-noded collapse at "+
Nd.fact.createLineString([u,y,C]));};Nd.prototype.interfaces_=function(){return[]};Nd.prototype.getClass=function(){return Nd};vn.fact.get=function(){return new bb};Object.defineProperties(Nd,vn);var Rc=function(u,y,C){this._maxy=this._miny=this._maxx=this._minx=this._scaleFactor=this._p1Scaled=this._p0Scaled=this._ptScaled=this._originalPt=this._pt=this._li=null;this._corner=Array(4).fill(null);this._safeEnv=null;if(this._originalPt=u,this._pt=u,this._scaleFactor=y,this._li=C,0>=y)throw new ac("Scale factor must be non-zero");
1!==y&&(this._pt=new sa(this.scale(u.x),this.scale(u.y)),this._p0Scaled=new sa,this._p1Scaled=new sa);this.initCorners(this._pt)},wn={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Rc.prototype.intersectsScaled=function(u,y){var C=Math.max(u.x,y.x),w=Math.min(u.y,y.y),x=Math.max(u.y,y.y);if(C=this._maxx<Math.min(u.x,y.x)||this._minx>C||this._maxy<w||this._miny>x)return!1;u=this.intersectsToleranceSquare(u,y);return Xa.isTrue(!(C&&u),"Found bad envelope test"),u};Rc.prototype.initCorners=function(u){this._minx=
u.x-.5;this._maxx=u.x+.5;this._miny=u.y-.5;this._maxy=u.y+.5;this._corner[0]=new sa(this._maxx,this._maxy);this._corner[1]=new sa(this._minx,this._maxy);this._corner[2]=new sa(this._minx,this._miny);this._corner[3]=new sa(this._maxx,this._miny)};Rc.prototype.intersects=function(u,y){return 1===this._scaleFactor?this.intersectsScaled(u,y):(this.copyScaled(u,this._p0Scaled),this.copyScaled(y,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Rc.prototype.scale=function(u){return Math.round(u*
this._scaleFactor)};Rc.prototype.getCoordinate=function(){return this._originalPt};Rc.prototype.copyScaled=function(u,y){y.x=this.scale(u.x);y.y=this.scale(u.y)};Rc.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var u=Rc.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ia(this._originalPt.x-u,this._originalPt.x+u,this._originalPt.y-u,this._originalPt.y+u)}return this._safeEnv};Rc.prototype.intersectsPixelClosure=function(u,y){return this._li.computeIntersection(u,y,this._corner[0],
this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(u,y,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(u,y,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(u,y,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))};Rc.prototype.intersectsToleranceSquare=function(u,y){var C=!1,w=!1;return this._li.computeIntersection(u,y,this._corner[0],this._corner[1]),!!this._li.isProper()||
(this._li.computeIntersection(u,y,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(C=!0),this._li.computeIntersection(u,y,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(w=!0),this._li.computeIntersection(u,y,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!C||!w)||!!u.equals(this._pt)||!!y.equals(this._pt))))};Rc.prototype.addSnappedNode=function(u,y){var C=u.getCoordinate(y),w=u.getCoordinate(y+1);return!!this.intersects(C,
w)&&(u.addIntersection(this.getCoordinate(),y),!0)};Rc.prototype.interfaces_=function(){return[]};Rc.prototype.getClass=function(){return Rc};wn.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75};Object.defineProperties(Rc,wn);var fh=function(){this.tempEnv1=new Ia;this.selectedSegment=new Na};fh.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))};fh.prototype.interfaces_=function(){return[]};
fh.prototype.getClass=function(){return fh};var fg=function(u){this._index=u},xn={HotPixelSnapAction:{configurable:!0}};fg.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var u=arguments[0],y=arguments[1],C=arguments[2],w=u.getSafeEnvelope(),x=new yn(u,y,C);return this._index.query(w,{interfaces_:function(){return[Ge]},visitItem:function(B){B.select(w,x)}}),x.isNodeAdded()}};fg.prototype.interfaces_=function(){return[]};fg.prototype.getClass=
function(){return fg};xn.HotPixelSnapAction.get=function(){return yn};Object.defineProperties(fg,xn);var yn=function(u){function y(C,w,x){u.call(this);this._isNodeAdded=!1;this._hotPixel=C;this._parentEdge=w;this._hotPixelVertexIndex=x}return u&&(y.__proto__=u),y.prototype=Object.create(u&&u.prototype),y.prototype.constructor=y,y.prototype.isNodeAdded=function(){return this._isNodeAdded},y.prototype.select=function(){if(2!==arguments.length)return u.prototype.select.apply(this,arguments);var C=arguments[1],
w=arguments[0].getContext();if(null!==this._parentEdge&&w===this._parentEdge&&C===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(w,C)},y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y}(fh),xf=function(u){this._interiorIntersections=null;this._li=u;this._interiorIntersections=new Fa};xf.prototype.processIntersections=function(u,y,C,w){if(u===C&&y===w)return null;var x=u.getCoordinates()[y],B=u.getCoordinates()[y+1],E=C.getCoordinates()[w],
G=C.getCoordinates()[w+1];if(this._li.computeIntersection(x,B,E,G),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(x=0;x<this._li.getIntersectionNum();x++)this._interiorIntersections.add(this._li.getIntersection(x));u.addIntersections(this._li,y,0);C.addIntersections(this._li,w,1)}};xf.prototype.isDone=function(){return!1};xf.prototype.getInteriorIntersections=function(){return this._interiorIntersections};xf.prototype.interfaces_=function(){return[$e]};xf.prototype.getClass=function(){return xf};
var ce=function(u){this._nodedSegStrings=this._pointSnapper=this._noder=this._scaleFactor=this._li=null;this._pm=u;this._li=new Te;this._li.setPrecisionModel(u);this._scaleFactor=u.getScale()};ce.prototype.checkCorrectness=function(u){u=ec.getNodedSubstrings(u);u=new Nd(u);try{u.checkValid()}catch(y){if(!(y instanceof gn))throw y;y.printStackTrace()}};ce.prototype.getNodedSubstrings=function(){return ec.getNodedSubstrings(this._nodedSegStrings)};ce.prototype.snapRound=function(u,y){y=this.findInteriorIntersections(u,
y);this.computeIntersectionSnaps(y);this.computeVertexSnaps(u)};ce.prototype.findInteriorIntersections=function(u,y){y=new xf(y);return this._noder.setSegmentIntersector(y),this._noder.computeNodes(u),y.getInteriorIntersections()};ce.prototype.computeVertexSnaps=function(u){if(Va(u,kc))for(u=u.iterator();u.hasNext();){var y=u.next();this.computeVertexSnaps(y)}else if(u instanceof ec){y=u.getCoordinates();for(var C=0;C<y.length;C++){var w=new Rc(y[C],this._scaleFactor,this._li);this._pointSnapper.snap(w,
u,C)&&u.addIntersection(y[C],C)}}};ce.prototype.computeNodes=function(u){this._nodedSegStrings=u;this._noder=new Nj;this._pointSnapper=new fg(this._noder.getIndex());this.snapRound(u,this._li)};ce.prototype.computeIntersectionSnaps=function(u){for(u=u.iterator();u.hasNext();){var y=u.next();y=new Rc(y,this._scaleFactor,this._li);this._pointSnapper.snap(y)}};ce.prototype.interfaces_=function(){return[Ye]};ce.prototype.getClass=function(){return ce};var xc=function(){if(this._argGeom=null,this._distance=
null,this._bufParams=new Gb,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var u=arguments[1];this._argGeom=arguments[0];this._bufParams=u}},gg={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};xc.prototype.bufferFixedPrecision=function(u){var y=new Je(new ce(new Fb(1)),u.getScale()),C=new Kc(this._bufParams);C.setWorkingPrecisionModel(u);
C.setNoder(y);this._resultGeometry=C.buffer(this._argGeom,this._distance)};xc.prototype.bufferReducedPrecision=function(){if(0===arguments.length){for(var u=xc.MAX_PRECISION_DIGITS;0<=u;u--){try{this.bufferReducedPrecision(u)}catch(y){if(!(y instanceof we))throw y;this._saveException=y}if(null!==this._resultGeometry)return null}throw this._saveException;}1===arguments.length&&(u=xc.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),u=new Fb(u),this.bufferFixedPrecision(u))};xc.prototype.computeGeometry=
function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var u=this._argGeom.getFactory().getPrecisionModel();u.getType()===Fb.FIXED?this.bufferFixedPrecision(u):this.bufferReducedPrecision()};xc.prototype.setQuadrantSegments=function(u){this._bufParams.setQuadrantSegments(u)};xc.prototype.bufferOriginalPrecision=function(){try{this._resultGeometry=(new Kc(this._bufParams)).buffer(this._argGeom,this._distance)}catch(u){if(!(u instanceof re))throw u;this._saveException=
u}};xc.prototype.getResultGeometry=function(u){return this._distance=u,this.computeGeometry(),this._resultGeometry};xc.prototype.setEndCapStyle=function(u){this._bufParams.setEndCapStyle(u)};xc.prototype.interfaces_=function(){return[]};xc.prototype.getClass=function(){return xc};xc.bufferOp=function(){if(2===arguments.length){var u=arguments[1];return(new xc(arguments[0])).getResultGeometry(u)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ra&&"number"==typeof arguments[1]){u=
arguments[1];var y=arguments[2],C=new xc(arguments[0]);C.setQuadrantSegments(y);return C.getResultGeometry(u)}if(arguments[2]instanceof Gb&&arguments[0]instanceof Ra&&"number"==typeof arguments[1])return u=arguments[1],(new xc(arguments[0],arguments[2])).getResultGeometry(u)}else if(4===arguments.length){u=arguments[1];y=arguments[2];C=arguments[3];var w=new xc(arguments[0]);w.setQuadrantSegments(y);w.setEndCapStyle(C);return w.getResultGeometry(u)}};xc.precisionScaleFactor=function(u,y,C){u=u.getEnvelopeInternal();
y=cd.max(Math.abs(u.getMaxX()),Math.abs(u.getMaxY()),Math.abs(u.getMinX()),Math.abs(u.getMinY()))+2*(0<y?y:0);return Math.pow(10,C-Math.trunc(Math.log(y)/Math.log(10)+1))};gg.CAP_ROUND.get=function(){return Gb.CAP_ROUND};gg.CAP_BUTT.get=function(){return Gb.CAP_FLAT};gg.CAP_FLAT.get=function(){return Gb.CAP_FLAT};gg.CAP_SQUARE.get=function(){return Gb.CAP_SQUARE};gg.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(xc,gg);var $c=function(){if(this._lines=null,this._isForcedToLineString=
!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var u=arguments[1];this._lines=arguments[0];this._isForcedToLineString=u}};$c.prototype.filter=function(u){if(this._isForcedToLineString&&u instanceof Yd)return u=u.getFactory().createLineString(u.getCoordinateSequence()),this._lines.add(u),null;u instanceof Hc&&this._lines.add(u)};$c.prototype.setForceToLineString=function(u){this._isForcedToLineString=u};$c.prototype.interfaces_=function(){return[se]};$c.prototype.getClass=
function(){return $c};$c.getGeometry=function(){if(1===arguments.length){var u=arguments[0];return u.getFactory().buildGeometry($c.getLines(u))}if(2===arguments.length){u=arguments[0];var y=arguments[1];return u.getFactory().buildGeometry($c.getLines(u,y))}};$c.getLines=function(){if(1===arguments.length)return $c.getLines(arguments[0],!1);if(2===arguments.length){if(Va(arguments[0],kc)&&Va(arguments[1],kc)){for(var u=arguments[1],y=arguments[0].iterator();y.hasNext();){var C=y.next();$c.getLines(C,
u)}return u}if(arguments[0]instanceof Ra&&"boolean"==typeof arguments[1])return u=arguments[0],y=arguments[1],C=new Fa,u.apply(new $c(C,y)),C;if(arguments[0]instanceof Ra&&Va(arguments[1],kc))return u=arguments[0],y=arguments[1],u instanceof Hc?y.add(u):u.apply(new $c(y)),y}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Va(arguments[0],kc)&&Va(arguments[1],kc)){u=arguments[1];y=arguments[2];for(C=arguments[0].iterator();C.hasNext();){var w=C.next();$c.getLines(w,u,y)}return u}if("boolean"==
typeof arguments[2]&&arguments[0]instanceof Ra&&Va(arguments[1],kc))return u=arguments[1],arguments[0].apply(new $c(u,arguments[2])),u}};var de=function(){if((this._boundaryRule=kd.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length)&&1===arguments.length){var u=arguments[0];if(null===u)throw new ac("Rule must be non-null");this._boundaryRule=u}};de.prototype.locateInternal=function(u,y){if(u instanceof sa&&y instanceof Fd){if(y.isEmpty())return ua.EXTERIOR;var C=y.getExteriorRing();
C=this.locateInPolygonRing(u,C);if(C===ua.EXTERIOR)return ua.EXTERIOR;if(C===ua.BOUNDARY)return ua.BOUNDARY;for(C=0;C<y.getNumInteriorRing();C++){var w=y.getInteriorRingN(C);w=this.locateInPolygonRing(u,w);if(w===ua.INTERIOR)return ua.EXTERIOR;if(w===ua.BOUNDARY)return ua.BOUNDARY}return ua.INTERIOR}if(u instanceof sa&&y instanceof Hc){if(!y.getEnvelopeInternal().intersects(u))return ua.EXTERIOR;C=y.getCoordinates();return y.isClosed()||!u.equals(C[0])&&!u.equals(C[C.length-1])?Da.isOnLine(u,C)?ua.INTERIOR:
ua.EXTERIOR:ua.BOUNDARY}if(u instanceof sa&&y instanceof Xd)return y.getCoordinate().equals2D(u)?ua.INTERIOR:ua.EXTERIOR};de.prototype.locateInPolygonRing=function(u,y){return y.getEnvelopeInternal().intersects(u)?Da.locatePointInRing(u,y.getCoordinates()):ua.EXTERIOR};de.prototype.intersects=function(u,y){return this.locate(u,y)!==ua.EXTERIOR};de.prototype.updateLocationInfo=function(u){u===ua.INTERIOR&&(this._isIn=!0);u===ua.BOUNDARY&&this._numBoundaries++};de.prototype.computeLocation=function(u,
y){if(y instanceof Xd&&this.updateLocationInfo(this.locateInternal(u,y)),y instanceof Hc)this.updateLocationInfo(this.locateInternal(u,y));else if(y instanceof Fd)this.updateLocationInfo(this.locateInternal(u,y));else if(y instanceof We)for(var C=0;C<y.getNumGeometries();C++){var w=y.getGeometryN(C);this.updateLocationInfo(this.locateInternal(u,w))}else if(y instanceof Fe)for(C=0;C<y.getNumGeometries();C++)w=y.getGeometryN(C),this.updateLocationInfo(this.locateInternal(u,w));else if(y instanceof ud)for(C=
new ae(y);C.hasNext();)w=C.next(),w!==y&&this.computeLocation(u,w)};de.prototype.locate=function(u,y){return y.isEmpty()?ua.EXTERIOR:y instanceof Hc||y instanceof Fd?this.locateInternal(u,y):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(u,y),this._boundaryRule.isInBoundary(this._numBoundaries)?ua.BOUNDARY:0<this._numBoundaries||this._isIn?ua.INTERIOR:ua.EXTERIOR)};de.prototype.interfaces_=function(){return[]};de.prototype.getClass=function(){return de};var Od=function(u,y){this._pts=u;
this._data=y};Od.prototype.getCoordinates=function(){return this._pts};Od.prototype.size=function(){return this._pts.length};Od.prototype.getCoordinate=function(u){return this._pts[u]};Od.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Od.prototype.getSegmentOctant=function(u){return u===this._pts.length-1?-1:uf.octant(this.getCoordinate(u),this.getCoordinate(u+1))};Od.prototype.setData=function(u){this._data=u};Od.prototype.getData=function(){return this._data};
Od.prototype.toString=function(){return qe.toLineString(new hc(this._pts))};Od.prototype.interfaces_=function(){return[$d]};Od.prototype.getClass=function(){return Od};var sc=function(u){this._isCheckEndSegmentsOnly=this._findAllIntersections=!1;this._intSegments=this._interiorIntersection=this._li=null;this._intersections=new Fa;this._intersectionCount=0;this._keepIntersections=!0;this._li=u;this._interiorIntersection=null};sc.prototype.getInteriorIntersection=function(){return this._interiorIntersection};
sc.prototype.setCheckEndSegmentsOnly=function(u){this._isCheckEndSegmentsOnly=u};sc.prototype.getIntersectionSegments=function(){return this._intSegments};sc.prototype.count=function(){return this._intersectionCount};sc.prototype.getIntersections=function(){return this._intersections};sc.prototype.setFindAllIntersections=function(u){this._findAllIntersections=u};sc.prototype.setKeepIntersections=function(u){this._keepIntersections=u};sc.prototype.processIntersections=function(u,y,C,w){if(!this._findAllIntersections&&
this.hasIntersection()||u===C&&y===w||this._isCheckEndSegmentsOnly&&!this.isEndSegment(u,y)&&!this.isEndSegment(C,w))return null;var x=u.getCoordinates()[y];u=u.getCoordinates()[y+1];y=C.getCoordinates()[w];C=C.getCoordinates()[w+1];this._li.computeIntersection(x,u,y,C);this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=Array(4).fill(null),this._intSegments[0]=x,this._intSegments[1]=u,this._intSegments[2]=y,this._intSegments[3]=C,this._interiorIntersection=this._li.getIntersection(0),
this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};sc.prototype.isEndSegment=function(u,y){return 0===y||y>=u.size()-2};sc.prototype.hasIntersection=function(){return null!==this._interiorIntersection};sc.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection};sc.prototype.interfaces_=function(){return[$e]};sc.prototype.getClass=function(){return sc};sc.createAllIntersectionsFinder=function(u){u=new sc(u);
return u.setFindAllIntersections(!0),u};sc.createAnyIntersectionFinder=function(u){return new sc(u)};sc.createIntersectionCounter=function(u){u=new sc(u);return u.setFindAllIntersections(!0),u.setKeepIntersections(!1),u};var xd=function(u){this._li=new Te;this._findAllIntersections=!1;this._segInt=null;this._isValid=!0;this._segStrings=u};xd.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()};xd.prototype.getIntersections=function(){return this._segInt.getIntersections()};
xd.prototype.isValid=function(){return this.execute(),this._isValid};xd.prototype.setFindAllIntersections=function(u){this._findAllIntersections=u};xd.prototype.checkInteriorIntersections=function(){this._isValid=!0;this._segInt=new sc(this._li);this._segInt.setFindAllIntersections(this._findAllIntersections);var u=new Nj;if(u.setSegmentIntersector(this._segInt),u.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};xd.prototype.checkValid=function(){if(this.execute(),
!this._isValid)throw new we(this.getErrorMessage(),this._segInt.getInteriorIntersection());};xd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var u=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+qe.toLineString(u[0],u[1])+" and "+qe.toLineString(u[2],u[3])};xd.prototype.interfaces_=function(){return[]};xd.prototype.getClass=function(){return xd};xd.computeIntersections=function(u){u=new xd(u);return u.setFindAllIntersections(!0),
u.isValid(),u.getIntersections()};var bf=function C(y){this._nv=null;this._nv=new xd(C.toSegmentStrings(y))};bf.prototype.checkValid=function(){this._nv.checkValid()};bf.prototype.interfaces_=function(){return[]};bf.prototype.getClass=function(){return bf};bf.toSegmentStrings=function(y){var C=new Fa;for(y=y.iterator();y.hasNext();){var w=y.next();C.add(new Od(w.getCoordinates(),w))}return C};bf.checkValid=function(y){(new bf(y)).checkValid()};var yf=function(y){this._mapOp=y};yf.prototype.map=function(y){for(var C=
new Fa,w=0;w<y.getNumGeometries();w++){var x=this._mapOp.map(y.getGeometryN(w));x.isEmpty()||C.add(x)}return y.getFactory().createGeometryCollection(bb.toGeometryArray(C))};yf.prototype.interfaces_=function(){return[]};yf.prototype.getClass=function(){return yf};yf.map=function(y,C){return(new yf(C)).map(y)};var Pd=function(y,C,w){this._ptLocator=this._geometryFactory=this._op=null;this._lineEdgesList=new Fa;this._resultLineList=new Fa;this._op=y;this._geometryFactory=C;this._ptLocator=w};Pd.prototype.collectLines=
function(y){for(var C=this._op.getGraph().getEdgeEnds().iterator();C.hasNext();){var w=C.next();this.collectLineEdge(w,y,this._lineEdgesList);this.collectBoundaryTouchEdge(w,y,this._lineEdgesList)}};Pd.prototype.labelIsolatedLine=function(y,C){var w=this._ptLocator.locate(y.getCoordinate(),this._op.getArgGeometry(C));y.getLabel().setLocation(C,w)};Pd.prototype.build=function(y){return this.findCoveredLineEdges(),this.collectLines(y),this.buildLines(y),this._resultLineList};Pd.prototype.collectLineEdge=
function(y,C,w){var x=y.getLabel(),B=y.getEdge();y.isLineEdge()&&(y.isVisited()||!Za.isResultOfOp(x,C)||B.isCovered()||(w.add(B),y.setVisitedEdge(!0)))};Pd.prototype.findCoveredLineEdges=function(){for(var y=this._op.getGraph().getNodes().iterator();y.hasNext();)y.next().getEdges().findCoveredLineEdges();for(y=this._op.getGraph().getEdgeEnds().iterator();y.hasNext();){var C=y.next(),w=C.getEdge();C.isLineEdge()&&!w.isCoveredSet()&&(C=this._op.isCoveredByA(C.getCoordinate()),w.setCovered(C))}};Pd.prototype.labelIsolatedLines=
function(y){for(y=y.iterator();y.hasNext();){var C=y.next(),w=C.getLabel();C.isIsolated()&&(w.isNull(0)?this.labelIsolatedLine(C,0):this.labelIsolatedLine(C,1))}};Pd.prototype.buildLines=function(y){for(y=this._lineEdgesList.iterator();y.hasNext();){var C=y.next(),w=this._geometryFactory.createLineString(C.getCoordinates());this._resultLineList.add(w);C.setInResult(!0)}};Pd.prototype.collectBoundaryTouchEdge=function(y,C,w){var x=y.getLabel();return y.isLineEdge()||y.isVisited()||y.isInteriorAreaEdge()||
y.getEdge().isInResult()?null:(Xa.isTrue(!(y.isInResult()||y.getSym().isInResult())||!y.getEdge().isInResult()),void(Za.isResultOfOp(x,C)&&C===Za.INTERSECTION&&(w.add(y.getEdge()),y.setVisitedEdge(!0))))};Pd.prototype.interfaces_=function(){return[]};Pd.prototype.getClass=function(){return Pd};var zf=function(y,C){this._geometryFactory=this._op=null;this._resultPointList=new Fa;this._op=y;this._geometryFactory=C};zf.prototype.filterCoveredNodeToPoint=function(y){y=y.getCoordinate();this._op.isCoveredByLA(y)||
(y=this._geometryFactory.createPoint(y),this._resultPointList.add(y))};zf.prototype.extractNonCoveredResultNodes=function(y){for(var C=this._op.getGraph().getNodes().iterator();C.hasNext();){var w=C.next();if(!(w.isInResult()||w.isIncidentEdgeInResult()||0!==w.getEdges().getDegree()&&y!==Za.INTERSECTION)){var x=w.getLabel();Za.isResultOfOp(x,y)&&this.filterCoveredNodeToPoint(w)}}};zf.prototype.build=function(y){return this.extractNonCoveredResultNodes(y),this._resultPointList};zf.prototype.interfaces_=
function(){return[]};zf.prototype.getClass=function(){return zf};var Sc=function(){this._factory=this._inputGeom=null;this._preserveGeometryCollectionType=this._pruneEmptyGeometry=!0;this._preserveType=this._preserveCollections=!1};Sc.prototype.transformPoint=function(y,C){return this._factory.createPoint(this.transformCoordinates(y.getCoordinateSequence(),y))};Sc.prototype.transformPolygon=function(y,C){var w=!0;C=this.transformLinearRing(y.getExteriorRing(),y);null!==C&&C instanceof Yd&&!C.isEmpty()||
(w=!1);for(var x=new Fa,B=0;B<y.getNumInteriorRing();B++){var E=this.transformLinearRing(y.getInteriorRingN(B),y);null===E||E.isEmpty()||(E instanceof Yd||(w=!1),x.add(E))}if(w)return this._factory.createPolygon(C,x.toArray([]));y=new Fa;return null!==C&&y.add(C),y.addAll(x),this._factory.buildGeometry(y)};Sc.prototype.createCoordinateSequence=function(y){return this._factory.getCoordinateSequenceFactory().create(y)};Sc.prototype.getInputGeometry=function(){return this._inputGeom};Sc.prototype.transformMultiLineString=
function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=this.transformLineString(y.getGeometryN(w),y);null!==x&&(x.isEmpty()||C.add(x))}return this._factory.buildGeometry(C)};Sc.prototype.transformCoordinates=function(y,C){return this.copy(y)};Sc.prototype.transformLineString=function(y,C){return this._factory.createLineString(this.transformCoordinates(y.getCoordinateSequence(),y))};Sc.prototype.transformMultiPoint=function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=
this.transformPoint(y.getGeometryN(w),y);null!==x&&(x.isEmpty()||C.add(x))}return this._factory.buildGeometry(C)};Sc.prototype.transformMultiPolygon=function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=this.transformPolygon(y.getGeometryN(w),y);null!==x&&(x.isEmpty()||C.add(x))}return this._factory.buildGeometry(C)};Sc.prototype.copy=function(y){return y.copy()};Sc.prototype.transformGeometryCollection=function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=this.transform(y.getGeometryN(w));
null!==x&&(this._pruneEmptyGeometry&&x.isEmpty()||C.add(x))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(bb.toGeometryArray(C)):this._factory.buildGeometry(C)};Sc.prototype.transform=function(y){if(this._inputGeom=y,this._factory=y.getFactory(),y instanceof Xd)return this.transformPoint(y,null);if(y instanceof ag)return this.transformMultiPoint(y,null);if(y instanceof Yd)return this.transformLinearRing(y,null);if(y instanceof Hc)return this.transformLineString(y,
null);if(y instanceof We)return this.transformMultiLineString(y,null);if(y instanceof Fd)return this.transformPolygon(y,null);if(y instanceof Fe)return this.transformMultiPolygon(y,null);if(y instanceof ud)return this.transformGeometryCollection(y,null);throw new ac("Unknown Geometry subtype: "+y.getClass().getName());};Sc.prototype.transformLinearRing=function(y,C){y=this.transformCoordinates(y.getCoordinateSequence(),y);if(null===y)return this._factory.createLinearRing(null);C=y.size();return 0<
C&&4>C&&!this._preserveType?this._factory.createLineString(y):this._factory.createLinearRing(y)};Sc.prototype.interfaces_=function(){return[]};Sc.prototype.getClass=function(){return Sc};var ee=function x(C,w){(this._snapTolerance=0,this._srcPts=null,this._seg=new Na,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,C instanceof Hc&&"number"==typeof w)?x.call(this,C.getCoordinates(),w):C instanceof Array&&"number"==typeof w&&(this._srcPts=C,this._isClosed=x.isClosed(C),this._snapTolerance=
w)};ee.prototype.snapVertices=function(C,w){for(var x=this._isClosed?C.size()-1:C.size(),B=0;B<x;B++){var E=C.get(B);E=this.findSnapForVertex(E,w);null!==E&&(C.set(B,new sa(E)),0===B&&this._isClosed&&C.set(C.size()-1,new sa(E)))}};ee.prototype.findSnapForVertex=function(C,w){for(var x=0;x<w.length&&!C.equals2D(w[x]);x++)if(C.distance(w[x])<this._snapTolerance)return w[x];return null};ee.prototype.snapTo=function(C){var w=new Tg(this._srcPts);return this.snapVertices(w,C),this.snapSegments(w,C),w.toCoordinateArray()};
ee.prototype.snapSegments=function(C,w){if(0===w.length)return null;var x=w.length;w[0].equals2D(w[w.length-1])&&(x=w.length-1);for(var B=0;B<x;B++){var E=w[B],G=this.findSegmentIndexToSnap(E,C);0<=G&&C.add(G+1,new sa(E),!1)}};ee.prototype.findSegmentIndexToSnap=function(C,w){for(var x=Wa.MAX_VALUE,B=-1,E=0;E<w.size()-1;E++){if(this._seg.p0=w.get(E),this._seg.p1=w.get(E+1),this._seg.p0.equals2D(C)||this._seg.p1.equals2D(C)){if(this._allowSnappingToSourceVertices)continue;return-1}var G=this._seg.distance(C);
G<this._snapTolerance&&G<x&&(x=G,B=E)}return B};ee.prototype.setAllowSnappingToSourceVertices=function(C){this._allowSnappingToSourceVertices=C};ee.prototype.interfaces_=function(){return[]};ee.prototype.getClass=function(){return ee};ee.isClosed=function(C){return!(1>=C.length)&&C[0].equals2D(C[C.length-1])};var pc=function(C){this._srcGeom=C||null},zn={SNAP_PRECISION_FACTOR:{configurable:!0}};pc.prototype.snapTo=function(C,w){C=this.extractTargetCoordinates(C);return(new An(w,C)).transform(this._srcGeom)};
pc.prototype.snapToSelf=function(C,w){var x=this.extractTargetCoordinates(this._srcGeom);x=C=(new An(C,x,!0)).transform(this._srcGeom);return w&&Va(x,Xe)&&(x=C.buffer(0)),x};pc.prototype.computeSnapTolerance=function(C){return this.computeMinimumSegmentLength(C)/10};pc.prototype.extractTargetCoordinates=function(C){var w=new zd;C=C.getCoordinates();for(var x=0;x<C.length;x++)w.add(C[x]);return w.toArray([].fill(null))};pc.prototype.computeMinimumSegmentLength=function(C){for(var w=Wa.MAX_VALUE,x=
0;x<C.length-1;x++){var B=C[x].distance(C[x+1]);B<w&&(w=B)}return w};pc.prototype.interfaces_=function(){return[]};pc.prototype.getClass=function(){return pc};pc.snap=function(C,w,x){var B=Array(2).fill(null);C=new pc(C);B[0]=C.snapTo(w,x);w=new pc(w);return B[1]=w.snapTo(B[0],x),B};pc.computeOverlaySnapTolerance=function(){if(1===arguments.length){var C=arguments[0],w=pc.computeSizeBasedSnapTolerance(C);C=C.getPrecisionModel();C.getType()===Fb.FIXED&&(C=1/C.getScale()*2/1.415,C>w&&(w=C));return w}if(2===
arguments.length)return w=arguments[1],Math.min(pc.computeOverlaySnapTolerance(arguments[0]),pc.computeOverlaySnapTolerance(w))};pc.computeSizeBasedSnapTolerance=function(C){C=C.getEnvelopeInternal();return Math.min(C.getHeight(),C.getWidth())*pc.SNAP_PRECISION_FACTOR};pc.snapToSelf=function(C,w,x){return(new pc(C)).snapToSelf(w,x)};zn.SNAP_PRECISION_FACTOR.get=function(){return 1E-9};Object.defineProperties(pc,zn);var An=function(C){function w(x,B,E){C.call(this);this._snapTolerance=x||null;this._snapPts=
B||null;this._isSelfSnap=void 0!==E&&E}return C&&(w.__proto__=C),w.prototype=Object.create(C&&C.prototype),w.prototype.constructor=w,w.prototype.snapLine=function(x,B){x=new ee(x,this._snapTolerance);return x.setAllowSnappingToSourceVertices(this._isSelfSnap),x.snapTo(B)},w.prototype.transformCoordinates=function(x,B){x=x.toCoordinateArray();x=this.snapLine(x,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(x)},w.prototype.interfaces_=function(){return[]},w.prototype.getClass=
function(){return w},w}(Sc),Lc=function(){this._isFirst=!0;this._commonMantissaBitsCount=53;this._commonBits=0;this._commonSignExp=null};Lc.prototype.getCommon=function(){return Wa.longBitsToDouble(this._commonBits)};Lc.prototype.add=function(C){C=Wa.doubleToLongBits(C);return this._isFirst?(this._commonBits=C,this._commonSignExp=Lc.signExpBits(this._commonBits),this._isFirst=!1,null):Lc.signExpBits(C)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Lc.numCommonMostSigMantissaBits(this._commonBits,
C),void(this._commonBits=Lc.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))};Lc.prototype.toString=function(){if(1===arguments.length){var C=arguments[0],w=Wa.longBitsToDouble(C);C="0000000000000000000000000000000000000000000000000000000000000000"+Wa.toBinaryString(C);C=C.substring(C.length-64);return C.substring(0,1)+"  "+C.substring(1,12)+"(exp) "+C.substring(12)+" [ "+w+" ]"}};Lc.prototype.interfaces_=function(){return[]};Lc.prototype.getClass=function(){return Lc};Lc.getBit=
function(C,w){return 0!=(C&1<<w)?1:0};Lc.signExpBits=function(C){return C>>52};Lc.zeroLowerBits=function(C,w){return C&~((1<<w)-1)};Lc.numCommonMostSigMantissaBits=function(C,w){for(var x=0,B=52;0<=B;B--){if(Lc.getBit(C,B)!==Lc.getBit(w,B))return x;x++}return 52};var Ke=function(){this._commonCoord=null;this._ccFilter=new Af},Oj={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Ke.prototype.addCommonBits=function(C){var w=new Le(this._commonCoord);C.apply(w);C.geometryChanged()};
Ke.prototype.removeCommonBits=function(C){if(0===this._commonCoord.x&&0===this._commonCoord.y)return C;var w=new sa(this._commonCoord);w.x=-w.x;w.y=-w.y;w=new Le(w);return C.apply(w),C.geometryChanged(),C};Ke.prototype.getCommonCoordinate=function(){return this._commonCoord};Ke.prototype.add=function(C){C.apply(this._ccFilter);this._commonCoord=this._ccFilter.getCommonCoordinate()};Ke.prototype.interfaces_=function(){return[]};Ke.prototype.getClass=function(){return Ke};Oj.CommonCoordinateFilter.get=
function(){return Af};Oj.Translater.get=function(){return Le};Object.defineProperties(Ke,Oj);var Af=function(){this._commonBitsX=new Lc;this._commonBitsY=new Lc};Af.prototype.filter=function(C){this._commonBitsX.add(C.x);this._commonBitsY.add(C.y)};Af.prototype.getCommonCoordinate=function(){return new sa(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Af.prototype.interfaces_=function(){return[Ee]};Af.prototype.getClass=function(){return Af};var Le=function(C){this.trans=C};Le.prototype.filter=
function(C,w){var x=C.getOrdinate(w,0)+this.trans.x,B=C.getOrdinate(w,1)+this.trans.y;C.setOrdinate(w,0,x);C.setOrdinate(w,1,B)};Le.prototype.isDone=function(){return!1};Le.prototype.isGeometryChanged=function(){return!0};Le.prototype.interfaces_=function(){return[Wd]};Le.prototype.getClass=function(){return Le};var tc=function(C,w){this._geom=Array(2).fill(null);this._cbr=this._snapTolerance=null;this._geom[0]=C;this._geom[1]=w;this.computeSnapTolerance()};tc.prototype.selfSnap=function(C){return(new pc(C)).snapTo(C,
this._snapTolerance)};tc.prototype.removeCommonBits=function(C){this._cbr=new Ke;this._cbr.add(C[0]);this._cbr.add(C[1]);var w=Array(2).fill(null);return w[0]=this._cbr.removeCommonBits(C[0].copy()),w[1]=this._cbr.removeCommonBits(C[1].copy()),w};tc.prototype.prepareResult=function(C){return this._cbr.addCommonBits(C),C};tc.prototype.getResultGeometry=function(C){var w=this.snap(this._geom);C=Za.overlayOp(w[0],w[1],C);return this.prepareResult(C)};tc.prototype.checkValid=function(C){C.isValid()||
Oc.out.println("Snapped geometry is invalid")};tc.prototype.computeSnapTolerance=function(){this._snapTolerance=pc.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};tc.prototype.snap=function(C){C=this.removeCommonBits(C);return pc.snap(C[0],C[1],this._snapTolerance)};tc.prototype.interfaces_=function(){return[]};tc.prototype.getClass=function(){return tc};tc.overlayOp=function(C,w,x){return(new tc(C,w)).getResultGeometry(x)};tc.union=function(C,w){return tc.overlayOp(C,w,Za.UNION)};tc.intersection=
function(C,w){return tc.overlayOp(C,w,Za.INTERSECTION)};tc.symDifference=function(C,w){return tc.overlayOp(C,w,Za.SYMDIFFERENCE)};tc.difference=function(C,w){return tc.overlayOp(C,w,Za.DIFFERENCE)};var Tc=function(C,w){this._geom=Array(2).fill(null);this._geom[0]=C;this._geom[1]=w};Tc.prototype.getResultGeometry=function(C){var w=null,x=!1,B=null;try{w=Za.overlayOp(this._geom[0],this._geom[1],C),x=!0}catch(E){if(!(E instanceof re))throw E;B=E}if(!x)try{w=tc.overlayOp(this._geom[0],this._geom[1],C)}catch(E){throw E instanceof
re?B:E;}return w};Tc.prototype.interfaces_=function(){return[]};Tc.prototype.getClass=function(){return Tc};Tc.overlayOp=function(C,w,x){return(new Tc(C,w)).getResultGeometry(x)};Tc.union=function(C,w){return Tc.overlayOp(C,w,Za.UNION)};Tc.intersection=function(C,w){return Tc.overlayOp(C,w,Za.INTERSECTION)};Tc.symDifference=function(C,w){return Tc.overlayOp(C,w,Za.SYMDIFFERENCE)};Tc.difference=function(C,w){return Tc.overlayOp(C,w,Za.DIFFERENCE)};var gh=function(C,w){this.mce=C;this.chainIndex=w};
gh.prototype.computeIntersections=function(C,w){this.mce.computeIntersectsForChain(this.chainIndex,C.mce,C.chainIndex,w)};gh.prototype.interfaces_=function(){return[]};gh.prototype.getClass=function(){return gh};var ad=function w(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var x=arguments[0],B=arguments[1];this._eventType=w.DELETE;this._xValue=x;this._insertEvent=B}else if(3===arguments.length){x=
arguments[0];B=arguments[1];var E=arguments[2];this._eventType=w.INSERT;this._label=x;this._xValue=B;this._obj=E}},Pj={INSERT:{configurable:!0},DELETE:{configurable:!0}};ad.prototype.isDelete=function(){return this._eventType===ad.DELETE};ad.prototype.setDeleteEventIndex=function(w){this._deleteEventIndex=w};ad.prototype.getObject=function(){return this._obj};ad.prototype.compareTo=function(w){return this._xValue<w._xValue?-1:this._xValue>w._xValue?1:this._eventType<w._eventType?-1:this._eventType>
w._eventType?1:0};ad.prototype.getInsertEvent=function(){return this._insertEvent};ad.prototype.isInsert=function(){return this._eventType===ad.INSERT};ad.prototype.isSameLabel=function(w){return null!==this._label&&this._label===w._label};ad.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};ad.prototype.interfaces_=function(){return[jd]};ad.prototype.getClass=function(){return ad};Pj.INSERT.get=function(){return 1};Pj.DELETE.get=function(){return 2};Object.defineProperties(ad,
Pj);var ki=function(){};ki.prototype.interfaces_=function(){return[]};ki.prototype.getClass=function(){return ki};var zc=function(w,x,B){this._hasProperInterior=this._hasProper=this._hasIntersection=!1;this._isSelfIntersection=this._properIntersectionPoint=null;this.numTests=this._numIntersections=0;this._bdyNodes=null;this._isDoneWhenProperInt=this._isDone=!1;this._li=w;this._includeProper=x;this._recordIsolated=B};zc.prototype.isTrivialIntersection=function(w,x,B,E){return w===B&&1===this._li.getIntersectionNum()&&
(zc.isAdjacentSegments(x,E)||w.isClosed()&&(w=w.getNumPoints()-1,0===x&&E===w||0===E&&x===w))?!0:!1};zc.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};zc.prototype.setIsDoneIfProperInt=function(w){this._isDoneWhenProperInt=w};zc.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};zc.prototype.isBoundaryPointInternal=function(w,x){for(x=x.iterator();x.hasNext();){var B=x.next().getCoordinate();if(w.isIntersection(B))return!0}return!1};
zc.prototype.hasProperIntersection=function(){return this._hasProper};zc.prototype.hasIntersection=function(){return this._hasIntersection};zc.prototype.isDone=function(){return this._isDone};zc.prototype.isBoundaryPoint=function(w,x){return null!==x&&(!!this.isBoundaryPointInternal(w,x[0])||!!this.isBoundaryPointInternal(w,x[1]))};zc.prototype.setBoundaryNodes=function(w,x){this._bdyNodes=Array(2).fill(null);this._bdyNodes[0]=w;this._bdyNodes[1]=x};zc.prototype.addIntersections=function(w,x,B,E){if(w===
B&&x===E)return null;this.numTests++;var G=w.getCoordinates()[x],P=w.getCoordinates()[x+1],S=B.getCoordinates()[E],V=B.getCoordinates()[E+1];this._li.computeIntersection(G,P,S,V);this._li.hasIntersection()&&(this._recordIsolated&&(w.setIsolated(!1),B.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(w,x,B,E)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(w.addIntersections(this._li,x,0),B.addIntersections(this._li,E,1)),this._li.isProper()&&(this._properIntersectionPoint=
this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};zc.prototype.interfaces_=function(){return[]};zc.prototype.getClass=function(){return zc};zc.isAdjacentSegments=function(w,x){return 1===Math.abs(w-x)};var Gp=function(w){function x(){w.call(this);this.events=new Fa;this.nOverlaps=null}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=
x,x.prototype.prepareEvents=function(){Kd.sort(this.events);for(var B=0;B<this.events.size();B++){var E=this.events.get(B);E.isDelete()&&E.getInsertEvent().setDeleteEventIndex(B)}},x.prototype.computeIntersections=function(){if(1===arguments.length){var B=arguments[0];this.nOverlaps=0;this.prepareEvents();for(var E=0;E<this.events.size();E++){var G=this.events.get(E);if(G.isInsert()&&this.processOverlaps(E,G.getDeleteEventIndex(),G,B),B.isDone())break}}else 3===arguments.length&&(arguments[2]instanceof
zc&&Va(arguments[0],ue)&&Va(arguments[1],ue)?(B=arguments[0],E=arguments[1],G=arguments[2],this.addEdges(B,B),this.addEdges(E,E),this.computeIntersections(G)):"boolean"==typeof arguments[2]&&Va(arguments[0],ue)&&arguments[1]instanceof zc&&(B=arguments[0],E=arguments[1],arguments[2]?this.addEdges(B,null):this.addEdges(B),this.computeIntersections(E)))},x.prototype.addEdge=function(B,E){B=B.getMonotoneChainEdge();for(var G=B.getStartIndexes(),P=0;P<G.length-1;P++){var S=new gh(B,P);S=new ad(E,B.getMinX(P),
S);this.events.add(S);this.events.add(new ad(B.getMaxX(P),S))}},x.prototype.processOverlaps=function(B,E,G,P){for(var S=G.getObject();B<E;B++){var V=this.events.get(B);if(V.isInsert()){var Z=V.getObject();G.isSameLabel(V)||(S.computeIntersections(Z,P),this.nOverlaps++)}}},x.prototype.addEdges=function(){if(1===arguments.length)for(var B=arguments[0].iterator();B.hasNext();){var E=B.next();this.addEdge(E,E)}else if(2===arguments.length)for(B=arguments[1],E=arguments[0].iterator();E.hasNext();){var G=
E.next();this.addEdge(G,B)}},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(ki),fe=function(){this._min=Wa.POSITIVE_INFINITY;this._max=Wa.NEGATIVE_INFINITY},Bn={NodeComparator:{configurable:!0}};fe.prototype.getMin=function(){return this._min};fe.prototype.intersects=function(w,x){return!(this._min>x||this._max<w)};fe.prototype.getMax=function(){return this._max};fe.prototype.toString=function(){return qe.toLineString(new sa(this._min,0),new sa(this._max,
0))};fe.prototype.interfaces_=function(){return[]};fe.prototype.getClass=function(){return fe};Bn.NodeComparator.get=function(){return hh};Object.defineProperties(fe,Bn);var hh=function(){};hh.prototype.compare=function(w,x){w=(w._min+w._max)/2;x=(x._min+x._max)/2;return w<x?-1:w>x?1:0};hh.prototype.interfaces_=function(){return[Rf]};hh.prototype.getClass=function(){return hh};var Hp=function(w){function x(B,E,G){w.call(this);this._min=B;this._max=E;this._item=G}return w&&(x.__proto__=w),x.prototype=
Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.query=function(B,E,G){if(!this.intersects(B,E))return null;G.visitItem(this._item)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(fe),Ip=function(w){function x(B,E){w.call(this);this._node1=B;this._node2=E;this.buildExtent(this._node1,this._node2)}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.buildExtent=function(B,E){this._min=
Math.min(B._min,E._min);this._max=Math.max(B._max,E._max)},x.prototype.query=function(B,E,G){if(!this.intersects(B,E))return null;null!==this._node1&&this._node1.query(B,E,G);null!==this._node2&&this._node2.query(B,E,G)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(fe),ge=function(){this._leaves=new Fa;this._root=null;this._level=0};ge.prototype.buildTree=function(){Kd.sort(this._leaves,new fe.NodeComparator);for(var w=this._leaves,x,B=new Fa;;){if(this.buildLevel(w,
B),1===B.size())return B.get(0);x=w;w=B;B=x}};ge.prototype.insert=function(w,x,B){if(null!==this._root)throw Error("Index cannot be added to once it has been queried");this._leaves.add(new Hp(w,x,B))};ge.prototype.query=function(w,x,B){this.init();this._root.query(w,x,B)};ge.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()};ge.prototype.printNode=function(w){Oc.out.println(qe.toLineString(new sa(w._min,this._level),new sa(w._max,this._level)))};ge.prototype.init=
function(){if(null!==this._root)return null;this.buildRoot()};ge.prototype.buildLevel=function(w,x){this._level++;x.clear();for(var B=0;B<w.size();B+=2){var E=w.get(B);null===(B+1<w.size()?w.get(B):null)?x.add(E):(E=new Ip(w.get(B),w.get(B+1)),x.add(E))}};ge.prototype.interfaces_=function(){return[]};ge.prototype.getClass=function(){return ge};var hg=function(){this._items=new Fa};hg.prototype.visitItem=function(w){this._items.add(w)};hg.prototype.getItems=function(){return this._items};hg.prototype.interfaces_=
function(){return[Ge]};hg.prototype.getClass=function(){return hg};var ig=function(w){this._index=null;if(!Va(w,Xe))throw new ac("Argument must be Polygonal");this._index=new cf(w)},Qj={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};ig.prototype.locate=function(w){var x=new Ed(w),B=new jg(x);return this._index.query(w.y,w.y,B),x.getLocation()};ig.prototype.interfaces_=function(){return[eg]};ig.prototype.getClass=function(){return ig};Qj.SegmentVisitor.get=function(){return jg};
Qj.IntervalIndexedGeometry.get=function(){return cf};Object.defineProperties(ig,Qj);var jg=function(w){this._counter=w};jg.prototype.visitItem=function(w){this._counter.countSegment(w.getCoordinate(0),w.getCoordinate(1))};jg.prototype.interfaces_=function(){return[Ge]};jg.prototype.getClass=function(){return jg};var cf=function(w){this._index=new ge;this.init(w)};cf.prototype.init=function(w){for(w=$c.getLines(w).iterator();w.hasNext();){var x=w.next().getCoordinates();this.addLine(x)}};cf.prototype.addLine=
function(w){for(var x=1;x<w.length;x++){var B=new Na(w[x-1],w[x]);this._index.insert(Math.min(B.p0.y,B.p1.y),Math.max(B.p0.y,B.p1.y),B)}};cf.prototype.query=function(){if(2===arguments.length){var w=arguments[0],x=arguments[1],B=new hg;return this._index.query(w,x,B),B.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])};cf.prototype.interfaces_=function(){return[]};cf.prototype.getClass=function(){return cf};var ih=function(w){function x(){if(w.call(this),this._parentGeom=
null,this._lineEdgeMap=new ln,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new de,2===arguments.length){var B=arguments[1],E=kd.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0];this._parentGeom=B;this._boundaryNodeRule=E;null!==B&&this.add(B)}else 3===arguments.length&&(B=arguments[1],E=arguments[2],this._argIndex=arguments[0],this._parentGeom=
B,this._boundaryNodeRule=E,null!==B&&this.add(B))}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.insertBoundaryPoint=function(B,E){E=this._nodes.addNode(E).getLabel();var G=1;E.getLocation(B,Aa.ON)===ua.BOUNDARY&&G++;G=x.determineBoundary(this._boundaryNodeRule,G);E.setLocation(B,G)},x.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var B=arguments[1],
E=arguments[2],G=new zc(arguments[0],!0,!1);G.setIsDoneIfProperInt(E);E=this.createEdgeSetIntersector();var P=this._parentGeom instanceof Yd||this._parentGeom instanceof Fd||this._parentGeom instanceof Fe;return E.computeIntersections(this._edges,G,B||!P),this.addSelfIntersectionNodes(this._argIndex),G}},x.prototype.computeSplitEdges=function(B){for(var E=this._edges.iterator();E.hasNext();)E.next().eiList.addSplitEdges(B)},x.prototype.computeEdgeIntersections=function(B,E,G){E=new zc(E,G,!0);return E.setBoundaryNodes(this.getBoundaryNodes(),
B.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,B._edges,E),E},x.prototype.getGeometry=function(){return this._parentGeom},x.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},x.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},x.prototype.addPoint=function(B){B instanceof Xd?(B=B.getCoordinate(),this.insertPoint(this._argIndex,B,ua.INTERIOR)):B instanceof sa&&this.insertPoint(this._argIndex,B,ua.INTERIOR)},x.prototype.addPolygon=
function(B){this.addPolygonRing(B.getExteriorRing(),ua.EXTERIOR,ua.INTERIOR);for(var E=0;E<B.getNumInteriorRing();E++){var G=B.getInteriorRingN(E);this.addPolygonRing(G,ua.INTERIOR,ua.EXTERIOR)}},x.prototype.addEdge=function(B){this.insertEdge(B);B=B.getCoordinates();this.insertPoint(this._argIndex,B[0],ua.BOUNDARY);this.insertPoint(this._argIndex,B[B.length-1],ua.BOUNDARY)},x.prototype.addLineString=function(B){var E=ab.removeRepeatedPoints(B.getCoordinates());if(2>E.length)return this._hasTooFewPoints=
!0,this._invalidPoint=E[0],null;var G=new ji(E,new Jb(this._argIndex,ua.INTERIOR));this._lineEdgeMap.put(B,G);this.insertEdge(G);Xa.isTrue(2<=E.length,"found LineString with single point");this.insertBoundaryPoint(this._argIndex,E[0]);this.insertBoundaryPoint(this._argIndex,E[E.length-1])},x.prototype.getInvalidPoint=function(){return this._invalidPoint},x.prototype.getBoundaryPoints=function(){var B=this.getBoundaryNodes(),E=Array(B.size()).fill(null),G=0;for(B=B.iterator();B.hasNext();){var P=B.next();
E[G++]=P.getCoordinate().copy()}return E},x.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},x.prototype.addSelfIntersectionNode=function(B,E,G){if(this.isBoundaryNode(B,E))return null;G===ua.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(B,E):this.insertPoint(B,E,G)},x.prototype.addPolygonRing=function(B,E,G){if(B.isEmpty())return null;var P=ab.removeRepeatedPoints(B.getCoordinates());
if(4>P.length)return this._hasTooFewPoints=!0,this._invalidPoint=P[0],null;var S=E,V=G;Da.isCCW(P)&&(S=G,V=E);E=new ji(P,new Jb(this._argIndex,ua.BOUNDARY,S,V));this._lineEdgeMap.put(B,E);this.insertEdge(E);this.insertPoint(this._argIndex,P[0],ua.BOUNDARY)},x.prototype.insertPoint=function(B,E,G){E=this._nodes.addNode(E);var P=E.getLabel();null===P?E._label=new Jb(B,G):P.setLocation(B,G)},x.prototype.createEdgeSetIntersector=function(){return new Gp},x.prototype.addSelfIntersectionNodes=function(B){for(var E=
this._edges.iterator();E.hasNext();){var G=E.next(),P=G.getLabel().getLocation(B);for(G=G.eiList.iterator();G.hasNext();){var S=G.next();this.addSelfIntersectionNode(B,S.coord,P)}}},x.prototype.add=function(){if(1!==arguments.length)return w.prototype.add.apply(this,arguments);var B=arguments[0];if(B.isEmpty())return null;if(B instanceof Fe&&(this._useBoundaryDeterminationRule=!1),B instanceof Fd)this.addPolygon(B);else if(B instanceof Hc)this.addLineString(B);else if(B instanceof Xd)this.addPoint(B);
else{if(!(B instanceof ag||B instanceof We||B instanceof Fe||B instanceof ud))throw Error(B.getClass().getName());this.addCollection(B)}},x.prototype.addCollection=function(B){for(var E=0;E<B.getNumGeometries();E++){var G=B.getGeometryN(E);this.add(G)}},x.prototype.locate=function(B){return Va(this._parentGeom,Xe)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new ig(this._parentGeom)),this._areaPtLocator.locate(B)):this._ptLocator.locate(B,this._parentGeom)},
x.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):w.prototype.findEdge.apply(this,arguments)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x.determineBoundary=function(B,E){return B.isInBoundary(E)?ua.BOUNDARY:ua.INTERIOR},x}(Yb),kg=function(){if(this._li=new Te,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var w=arguments[0];this.setComputationPrecision(w.getPrecisionModel());this._arg=
Array(1).fill(null);this._arg[0]=new ih(0,w)}else if(2===arguments.length){w=arguments[0];var x=arguments[1],B=kd.OGC_SFS_BOUNDARY_RULE;0<=w.getPrecisionModel().compareTo(x.getPrecisionModel())?this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(x.getPrecisionModel());this._arg=Array(2).fill(null);this._arg[0]=new ih(0,w,B);this._arg[1]=new ih(1,x,B)}else 3===arguments.length&&(w=arguments[0],x=arguments[1],B=arguments[2],0<=w.getPrecisionModel().compareTo(x.getPrecisionModel())?
this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(x.getPrecisionModel()),this._arg=Array(2).fill(null),this._arg[0]=new ih(0,w,B),this._arg[1]=new ih(1,x,B))};kg.prototype.getArgGeometry=function(w){return this._arg[w].getGeometry()};kg.prototype.setComputationPrecision=function(w){this._resultPrecisionModel=w;this._li.setPrecisionModel(this._resultPrecisionModel)};kg.prototype.interfaces_=function(){return[]};kg.prototype.getClass=function(){return kg};var df=function(){};
df.prototype.interfaces_=function(){return[]};df.prototype.getClass=function(){return df};df.map=function(w,x){if(w instanceof Ra&&Va(x,df.MapOp)){for(var B=new Fa,E=0;E<w.getNumGeometries();E++){var G=x.map(w.getGeometryN(E));null!==G&&B.add(G)}return w.getFactory().buildGeometry(B)}if(Va(w,kc)&&Va(x,df.MapOp)){B=new Fa;for(w=w.iterator();w.hasNext();)E=w.next(),E=x.map(E),null!==E&&B.add(E);return B}};df.MapOp=function(){};var Za=function(w){function x(B,E){w.call(this,B,E);this._ptLocator=new de;
this._graph=this._resultGeom=this._geomFact=null;this._edgeList=new wd;this._resultPolyList=new Fa;this._resultLineList=new Fa;this._resultPointList=new Fa;this._graph=new Yb(new tn);this._geomFact=B.getFactory()}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.insertUniqueEdge=function(B){var E=this._edgeList.findEqualEdge(B);if(null!==E){var G=E.getLabel(),P=B.getLabel();E.isPointwiseEqual(B)||(P=new Jb(B.getLabel())).flip();B=E.getDepth();
B.isNull()&&B.add(G);B.add(P);G.merge(P)}else this._edgeList.add(B)},x.prototype.getGraph=function(){return this._graph},x.prototype.cancelDuplicateResultEdges=function(){for(var B=this._graph.getEdgeEnds().iterator();B.hasNext();){var E=B.next(),G=E.getSym();E.isInResult()&&G.isInResult()&&(E.setInResult(!1),G.setInResult(!1))}},x.prototype.isCoveredByLA=function(B){return!!this.isCovered(B,this._resultLineList)||!!this.isCovered(B,this._resultPolyList)},x.prototype.computeGeometry=function(B,E,
G,P){var S=new Fa;return S.addAll(B),S.addAll(E),S.addAll(G),S.isEmpty()?x.createEmptyResult(P,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(S)},x.prototype.mergeSymLabels=function(){for(var B=this._graph.getNodes().iterator();B.hasNext();)B.next().getEdges().mergeSymLabels()},x.prototype.isCovered=function(B,E){for(E=E.iterator();E.hasNext();){var G=E.next();if(this._ptLocator.locate(B,G)!==ua.EXTERIOR)return!0}return!1},x.prototype.replaceCollapsedEdges=
function(){for(var B=new Fa,E=this._edgeList.iterator();E.hasNext();){var G=E.next();G.isCollapsed()&&(E.remove(),B.add(G.getCollapsedEdge()))}this._edgeList.addAll(B)},x.prototype.updateNodeLabelling=function(){for(var B=this._graph.getNodes().iterator();B.hasNext();){var E=B.next(),G=E.getEdges().getLabel();E.getLabel().merge(G)}},x.prototype.getResultGeometry=function(B){return this.computeOverlay(B),this._resultGeom},x.prototype.insertUniqueEdges=function(B){for(B=B.iterator();B.hasNext();){var E=
B.next();this.insertUniqueEdge(E)}},x.prototype.computeOverlay=function(B){this.copyPoints(0);this.copyPoints(1);this._arg[0].computeSelfNodes(this._li,!1);this._arg[1].computeSelfNodes(this._li,!1);this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var E=new Fa;this._arg[0].computeSplitEdges(E);this._arg[1].computeSplitEdges(E);this.insertUniqueEdges(E);this.computeLabelsFromDepths();this.replaceCollapsedEdges();bf.checkValid(this._edgeList.getEdges());this._graph.addEdges(this._edgeList.getEdges());
this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(B);this.cancelDuplicateResultEdges();E=new Yc(this._geomFact);E.add(this._graph);this._resultPolyList=E.getPolygons();this._resultLineList=(new Pd(this,this._geomFact,this._ptLocator)).build(B);this._resultPointList=(new zf(this,this._geomFact,this._ptLocator)).build(B);this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,B)},x.prototype.labelIncompleteNode=function(B,E){var G=
this._ptLocator.locate(B.getCoordinate(),this._arg[E].getGeometry());B.getLabel().setLocation(E,G)},x.prototype.copyPoints=function(B){for(var E=this._arg[B].getNodeIterator();E.hasNext();){var G=E.next();this._graph.addNode(G.getCoordinate()).setLabel(B,G.getLabel().getLocation(B))}},x.prototype.findResultAreaEdges=function(B){for(var E=this._graph.getEdgeEnds().iterator();E.hasNext();){var G=E.next(),P=G.getLabel();P.isArea()&&!G.isInteriorAreaEdge()&&x.isResultOfOp(P.getLocation(0,Aa.RIGHT),P.getLocation(1,
Aa.RIGHT),B)&&G.setInResult(!0)}},x.prototype.computeLabelsFromDepths=function(){for(var B=this._edgeList.iterator();B.hasNext();){var E=B.next(),G=E.getLabel();E=E.getDepth();if(!E.isNull()){E.normalize();for(var P=0;2>P;P++)G.isNull(P)||!G.isArea()||E.isNull(P)||(0===E.getDelta(P)?G.toLine(P):(Xa.isTrue(!E.isNull(P,Aa.LEFT),"depth of LEFT side has not been initialized"),G.setLocation(P,Aa.LEFT,E.getLocation(P,Aa.LEFT)),Xa.isTrue(!E.isNull(P,Aa.RIGHT),"depth of RIGHT side has not been initialized"),
G.setLocation(P,Aa.RIGHT,E.getLocation(P,Aa.RIGHT))))}}},x.prototype.computeLabelling=function(){for(var B=this._graph.getNodes().iterator();B.hasNext();)B.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels();this.updateNodeLabelling()},x.prototype.labelIncompleteNodes=function(){for(var B=this._graph.getNodes().iterator();B.hasNext();){var E=B.next(),G=E.getLabel();E.isIsolated()&&(G.isNull(0)?this.labelIncompleteNode(E,0):this.labelIncompleteNode(E,1));E.getEdges().updateLabelling(G)}},
x.prototype.isCoveredByA=function(B){return!!this.isCovered(B,this._resultPolyList)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(kg);Za.overlayOp=function(w,x,B){return(new Za(w,x)).getResultGeometry(B)};Za.intersection=function(w,x){return w.isEmpty()||x.isEmpty()?Za.createEmptyResult(Za.INTERSECTION,w,x,w.getFactory()):w.isGeometryCollection()?yf.map(w,{interfaces_:function(){return[df.MapOp]},map:function(B){return B.intersection(x)}}):(w.checkNotGeometryCollection(w),
w.checkNotGeometryCollection(x),Tc.overlayOp(w,x,Za.INTERSECTION))};Za.symDifference=function(w,x){if(w.isEmpty()||x.isEmpty()){if(w.isEmpty()&&x.isEmpty())return Za.createEmptyResult(Za.SYMDIFFERENCE,w,x,w.getFactory());if(w.isEmpty())return x.copy();if(x.isEmpty())return w.copy()}return w.checkNotGeometryCollection(w),w.checkNotGeometryCollection(x),Tc.overlayOp(w,x,Za.SYMDIFFERENCE)};Za.resultDimension=function(w,x,B){x=x.getDimension();B=B.getDimension();var E=-1;switch(w){case Za.INTERSECTION:E=
Math.min(x,B);break;case Za.UNION:E=Math.max(x,B);break;case Za.DIFFERENCE:E=x;break;case Za.SYMDIFFERENCE:E=Math.max(x,B)}return E};Za.createEmptyResult=function(w,x,B,E){var G=null;switch(Za.resultDimension(w,x,B)){case -1:G=E.createGeometryCollection([].fill(null));break;case 0:G=E.createPoint();break;case 1:G=E.createLineString();break;case 2:G=E.createPolygon()}return G};Za.difference=function(w,x){return w.isEmpty()?Za.createEmptyResult(Za.DIFFERENCE,w,x,w.getFactory()):x.isEmpty()?w.copy():
(w.checkNotGeometryCollection(w),w.checkNotGeometryCollection(x),Tc.overlayOp(w,x,Za.DIFFERENCE))};Za.isResultOfOp=function(){if(2===arguments.length){var w=arguments[0],x=arguments[1],B=w.getLocation(0);w=w.getLocation(1);return Za.isResultOfOp(B,w,x)}if(3===arguments.length){x=arguments[0];B=arguments[1];w=arguments[2];switch(x===ua.BOUNDARY&&(x=ua.INTERIOR),B===ua.BOUNDARY&&(B=ua.INTERIOR),w){case Za.INTERSECTION:return x===ua.INTERIOR&&B===ua.INTERIOR;case Za.UNION:return x===ua.INTERIOR||B===
ua.INTERIOR;case Za.DIFFERENCE:return x===ua.INTERIOR&&B!==ua.INTERIOR;case Za.SYMDIFFERENCE:return x===ua.INTERIOR&&B!==ua.INTERIOR||x!==ua.INTERIOR&&B===ua.INTERIOR}return!1}};Za.INTERSECTION=1;Za.UNION=2;Za.DIFFERENCE=3;Za.SYMDIFFERENCE=4;Sd.prototype={constructor:Sd,reset:function(){this.s=this.t=0},add:function(w){dm(li,w,this.t);dm(this,li.s,this.s);this.s?this.t+=li.t:this.s=li.t},valueOf:function(){return this.s}};var li=new Sd,Nb=Math.PI,me=Nb/2,sm=Nb/4,ne=2*Nb,Re=180/Nb,Bd=Nb/180,Fc=Math.abs,
Jp=Math.atan,Of=Math.atan2,lc=Math.cos,mc=Math.sin,Jg=Math.sqrt,wm={Feature:function(w,x){Nh(w.geometry,x)},FeatureCollection:function(w,x){w=w.features;for(var B=-1,E=w.length;++B<E;)Nh(w[B].geometry,x)}},fm={Sphere:function(w,x){x.sphere()},Point:function(w,x){w=w.coordinates;x.point(w[0],w[1],w[2])},MultiPoint:function(w,x){for(var B=w.coordinates,E=-1,G=B.length;++E<G;)w=B[E],x.point(w[0],w[1],w[2])},LineString:function(w,x){jj(w.coordinates,x,0)},MultiLineString:function(w,x){w=w.coordinates;
for(var B=-1,E=w.length;++B<E;)jj(w[B],x,0)},Polygon:function(w,x){gm(w.coordinates,x)},MultiPolygon:function(w,x){w=w.coordinates;for(var B=-1,E=w.length;++B<E;)gm(w[B],x)},GeometryCollection:function(w,x){w=w.geometries;for(var B=-1,E=w.length;++B<E;)Nh(w[B],x)}};new Sd;new Sd;new Sd;nj.invert=nj;var oj=new Sd;new Sd;new Sd;new Sd;var lg=1/0,mi=lg,jh=-lg,ni=jh,vm={point:function(w,x){w<lg&&(lg=w);w>jh&&(jh=w);x<mi&&(mi=x);x>ni&&(ni=x)},lineStart:Ig,lineEnd:Ig,polygonStart:Ig,polygonEnd:Ig,result:function(){var w=
[[lg,mi],[jh,ni]];return jh=ni=-(mi=lg=1/0),w}};new Sd;var ym=rm(function(){return!0},function(w){var x,B=NaN,E=NaN,G=NaN;return{lineStart:function(){w.lineStart();x=1},point:function(P,S){var V=0<P?Nb:-Nb,Z=Fc(P-B);if(1E-6>Fc(Z-Nb))w.point(B,E=0<(E+S)/2?me:-me),w.point(G,E),w.lineEnd(),w.lineStart(),w.point(V,E),w.point(P,E),x=0;else if(G!==V&&Z>=Nb){1E-6>Fc(B-G)&&(B-=1E-6*G);1E-6>Fc(P-V)&&(P-=1E-6*V);Z=B;var X=E,ea=P,na,qa,ia=mc(Z-ea);E=1E-6<Fc(ia)?Jp((mc(X)*(qa=lc(S))*mc(ea)-mc(S)*(na=lc(X))*mc(Z))/
(na*qa*ia)):(X+S)/2;w.point(G,E);w.lineEnd();w.lineStart();w.point(V,E);x=0}w.point(B=P,E=S);G=V},lineEnd:function(){w.lineEnd();B=E=NaN},clean:function(){return 2-x}}},function(w,x,B,E){null==w?(B*=me,E.point(-Nb,B),E.point(0,B),E.point(Nb,B),E.point(Nb,0),E.point(Nb,-B),E.point(0,-B),E.point(-Nb,-B),E.point(-Nb,0),E.point(-Nb,B)):1E-6<Fc(w[0]-x[0])?(w=w[0]<x[0]?Nb:-Nb,B=B*w/2,E.point(-w,B),E.point(0,B),E.point(w,B)):E.point(x[0],x[1])},[-Nb,-me]);pj.prototype={constructor:pj,point:function(w,x){this.stream.point(w,
x)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var No=lc(30*Bd),Po=tm({point:function(w,x){this.stream.point(w*Bd,x*Bd)}}),zm=function(w){return function(x,B){var E=lc(x),G=lc(B);E=w(E*G);return[E*G*mc(x),E*mc(B)]}}(function(w){return(w=em(w))&&w/mc(w)});zm.invert=function(w){return function(x,B){var E=Jg(x*x+B*B),
G=w(E),P=mc(G);G=lc(G);return[Of(x*P,E*G),Nf(E&&B*P/E)]}}(function(w){return w});a.along=function(w,x,B){void 0===B&&(B={});w=Ib(w).coordinates;for(var E=0,G=0;G<w.length&&!(x>=E&&G===w.length-1);G++){if(E>=x)return(x-=E)?(E=Ae(w[G],w[G-1])-180,je(w[G],x,E,B)):t(w[G]);E+=Lb(w[G],w[G+1],B)}return t(w[w.length-1])};a.angle=function(w,x,B,E){if(void 0===E&&(E={}),!ta(E))throw Error("options is invalid");if(!w)throw Error("startPoint is required");if(!x)throw Error("midPoint is required");if(!B)throw Error("endPoint is required");
w=da(!0!==E.mercator?Ae(w,x):lf(w,x));x=da(!0!==E.mercator?Ae(B,x):lf(B,x));x=Math.abs(w-x);return!0===E.explementary?360-x:x};a.applyFilter=Kh;a.area=Li;a.areaFactors=nh;a.bbox=ya;a.bboxClip=function(w,x){var B=Ib(w),E=B.type;w="Feature"===w.type?w.properties:{};B=B.coordinates;switch(E){case "LineString":case "MultiLineString":var G=[];return"LineString"===E&&(B=[B]),B.forEach(function(P){var S=G,V,Z,X,ea,na=P.length,qa=Ff(P[0],x),ia=[];S||=[];for(V=1;V<na;V++){var ra=P[V-1];for(Z=X=Ff(ea=P[V],
x);;){if(!(qa|Z)){ia.push(ra);Z!==X?(ia.push(ea),V<na-1&&(S.push(ia),ia=[])):V===na-1&&ia.push(ea);break}if(qa&Z)break;qa?qa=Ff(ra=Ri(ra,ea,qa,x),x):Z=Ff(ea=Ri(ra,ea,Z,x),x)}qa=X}ia.length&&S.push(ia);!0}),1===G.length?K(G[0],w):I(G,w);case "Polygon":return D(al(B,x),w);case "MultiPolygon":return T(B.map(function(P){return al(P,x)}),w);default:throw Error("geometry "+E+" not supported");}};a.bboxPolygon=Ci;a.bearing=Ae;a.bearingToAngle=da;a.bearingToAzimuth=da;a.bezier=qk;a.bezierSpline=qk;a.booleanClockwise=
Dh;a.booleanContains=function(w,x){w=Ib(w);x=Ib(x);var B=w.type,E=x.type,G=w.coordinates,P=x.coordinates;switch(B){case "Point":switch(E){case "Point":return Vi(G,P);default:throw Error("feature2 "+E+" geometry not supported");}case "MultiPoint":switch(E){case "Point":return function(S,V){var Z,X=!1;for(Z=0;Z<S.coordinates.length;Z++)if(Vi(S.coordinates[Z],V.coordinates)){X=!0;break}return X}(w,x);case "MultiPoint":return function(S,V){var Z=0;for(V=V.coordinates;Z<V.length;Z++){for(var X=V[Z],ea=
!1,na=0,qa=S.coordinates;na<qa.length;na++)if(Vi(X,qa[na])){ea=!0;break}if(!ea)return!1}return!0}(w,x);default:throw Error("feature2 "+E+" geometry not supported");}case "LineString":switch(E){case "Point":return hd(x,w,{ignoreEndVertices:!0});case "LineString":return function(S,V){var Z=!1,X=0;for(V=V.coordinates;X<V.length;X++){var ea=V[X];if(hd({type:"Point",coordinates:ea},S,{ignoreEndVertices:!0})&&(Z=!0),!hd({type:"Point",coordinates:ea},S,{ignoreEndVertices:!1}))return!1}return Z}(w,x);case "MultiPoint":return function(S,
V){var Z=!1,X=0;for(V=V.coordinates;X<V.length;X++){var ea=V[X];if(hd(ea,S,{ignoreEndVertices:!0})&&(Z=!0),!hd(ea,S))return!1}return Z?!0:!1}(w,x);default:throw Error("feature2 "+E+" geometry not supported");}case "Polygon":switch(E){case "Point":return Tb(x,w,{ignoreBoundary:!0});case "LineString":return function(S,V){var Z=!1,X=0,ea=ya(S),na=ya(V);if(!rl(ea,na))return!1;for(;X<V.coordinates.length-1;X++)if(ea=V.coordinates[X],na=V.coordinates[X+1],Tb({type:"Point",coordinates:[(ea[0]+na[0])/2,(ea[1]+
na[1])/2]},S,{ignoreBoundary:!0})){Z=!0;break}return Z}(w,x);case "Polygon":return function(S,V){if("Feature"===S.type&&null===S.geometry||"Feature"===V.type&&null===V.geometry)return!1;var Z=ya(S),X=ya(V);if(!rl(Z,X))return!1;Z=0;for(V=Ib(V).coordinates;Z<V.length;Z++){X=0;for(var ea=V[Z];X<ea.length;X++)if(!Tb(ea[X],S))return!1}return!0}(w,x);case "MultiPoint":return function(S,V){var Z=0;for(V=V.coordinates;Z<V.length;Z++)if(!Tb(V[Z],S,{ignoreBoundary:!0}))return!1;return!0}(w,x);default:throw Error("feature2 "+
E+" geometry not supported");}default:throw Error("feature1 "+B+" geometry not supported");}};a.booleanCrosses=function(w,x){w=Ib(w);x=Ib(x);var B=w.type,E=x.type;switch(B){case "MultiPoint":switch(E){case "LineString":return sl(w,x);case "Polygon":return ul(w,x);default:throw Error("feature2 "+E+" geometry not supported");}case "LineString":switch(E){case "MultiPoint":return sl(x,w);case "LineString":a:{if(0<ke(w,x).features.length)for(B=0;B<w.coordinates.length-1;B++)for(E=0;E<x.coordinates.length-
1;E++){var G=!0;if(0!==E&&E!==x.coordinates.length-2||(G=!1),tl(w.coordinates[B],w.coordinates[B+1],x.coordinates[E],G)){w=!0;break a}}w=!1}return w;case "Polygon":return 0<ke(w,Qi(x)).features.length;default:throw Error("feature2 "+E+" geometry not supported");}case "Polygon":switch(E){case "MultiPoint":return ul(x,w);case "LineString":return 0<ke(x,Qi(w)).features.length;default:throw Error("feature2 "+E+" geometry not supported");}default:throw Error("feature1 "+B+" geometry not supported");}};
a.booleanDisjoint=ol;a.booleanEqual=function(w,x){return Ib(w).type===Ib(x).type&&(new Td({precision:6})).compare(hf(w),hf(x))};a.booleanIntersects=xl;a.booleanOverlap=function(w,x){var B=Ib(w),E=Ib(x),G=B.type,P=E.type;if("MultiPoint"===G&&"MultiPoint"!==P||("LineString"===G||"MultiLineString"===G)&&"LineString"!==P&&"MultiLineString"!==P||("Polygon"===G||"MultiPolygon"===G)&&"Polygon"!==P&&"MultiPolygon"!==P)throw Error("features must be of the same type");if("Point"===G)throw Error("Point geometry not supported");
if((new Td({precision:6})).compare(w,x))return!1;var S=0;switch(G){case "MultiPoint":for(w=0;w<B.coordinates.length;w++)for(G=0;G<E.coordinates.length;G++){P=B.coordinates[w];var V=E.coordinates[G];if(P[0]===V[0]&&P[1]===V[1])return!0}return!1;case "LineString":case "MultiLineString":L(w,function(Z){L(x,function(X){bl(Z,X).features.length&&S++})});break;case "Polygon":case "MultiPolygon":L(w,function(Z){L(x,function(X){ke(Z,X).features.length&&S++})})}return 0<S};a.booleanParallel=function(w,x){if(!w)throw Error("line1 is required");
if(!x)throw Error("line2 is required");if("LineString"!==zl(w,"line1"))throw Error("line1 must be a LineString");if("LineString"!==zl(x,"line2"))throw Error("line2 must be a LineString");w=kf(hf(w)).features;x=kf(hf(x)).features;for(var B=0;B<w.length;B++){var E=w[B].geometry.coordinates;if(!x[B])break;var G=x[B].geometry.coordinates;if(da(lf(E[0],E[1]))!==da(lf(G[0],G[1])))return!1}return!0};a.booleanPointInPolygon=Tb;a.booleanPointOnLine=hd;a.booleanWithin=Mk;a.buffer=function(w,x,B){var E=(B=B||
{}).units||"kilometers",G=B.steps||8;if(!w)throw Error("geojson is required");if("object"!=typeof B)throw Error("options must be an object");if("number"!=typeof G)throw Error("steps must be an number");if(void 0===x)throw Error("radius is required");if(0>=G)throw Error("steps must be greater than 0");var P=[];switch(w.type){case "GeometryCollection":return Zb(w,function(S){(S=Th(S,x,E,G))&&P.push(S)}),J(P);case "FeatureCollection":return Sa(w,function(S){(S=Th(S,x,E,G))&&Sa(S,function(V){V&&P.push(V)})}),
J(P)}return Th(w,x,E,G)};a.center=wh;a.centerMean=Zi;a.centerMedian=function(w,x){if(void 0===x&&(x={}),!ta(x=x||{}))throw Error("options is invalid");var B=x.counter||10;if(!la(B))throw Error("counter must be a number");var E=x.weight,G=Zi(w,{weight:x.weight}),P=J([]);Sa(w,function(S){var V;P.features.push(Ne(S,{properties:{weight:null===(V=S.properties)||void 0===V?void 0:V[E]}}))});return Kl(G.geometry.coordinates,[0,0],P,{tolerance:x.tolerance,medianCandidates:[]},B)};a.centerOfMass=function E(x,
B){switch(void 0===B&&(B={}),qc(x)){case "Point":return t(aa(x),B.properties);case "Polygon":var G=[];Ca(x,function(Ma){G.push(Ma)});var P,S,V,Z,X=Ne(x,{properties:B.properties}),ea=X.geometry.coordinates,na=x=0,qa=0,ia=G.map(function(Ma){return[Ma[0]-ea[0],Ma[1]-ea[1]]});for(P=0;P<G.length-1;P++){var ra=(S=ia[P])[0];var ja=S[1];S=(V=ia[P+1])[0];qa+=Z=ra*(V=V[1])-S*ja;x+=(ra+S)*Z;na+=(ja+V)*Z}if(0===qa)return X;P=1/(3*qa);return t([ea[0]+P*x,ea[1]+P*na],B.properties);default:return(na=bk(x))?E(na,
{properties:B.properties}):Ne(x,{properties:B.properties})}};a.centroid=Ne;a.circle=Di;a.cleanCoords=hf;a.clone=Dc;a.clusterEach=$i;a.clusterReduce=Yl;a.clusters=kp;a.clustersDbscan=function(x,B,E){void 0===E&&(E={});!0!==E.mutate&&(x=Dc(x));E.minPoints=E.minPoints||3;var G=new ep.DBSCAN,P=-1;return G.run(uc(x),ka(B,E.units),E.minPoints,Lb).forEach(function(S){P++;S.forEach(function(V){V=x.features[V];V.properties||(V.properties={});V.properties.cluster=P;V.properties.dbscan="core"})}),G.noise.forEach(function(S){S=
x.features[S];S.properties||(S.properties={});S.properties.cluster?S.properties.dbscan="edge":S.properties.dbscan="noise"}),x};a.clustersKmeans=function(x,B){void 0===B&&(B={});var E=x.features.length;B.numberOfClusters=B.numberOfClusters||Math.round(Math.sqrt(E/2));B.numberOfClusters>E&&(B.numberOfClusters=E);!0!==B.mutate&&(x=Dc(x));E=uc(x);var G=E.slice(0,B.numberOfClusters),P=hp(E,B.numberOfClusters,G),S={};return P.centroids.forEach(function(V,Z){S[Z]=V}),Sa(x,function(V,Z){Z=P.idxs[Z];V.properties.cluster=
Z;V.properties.centroid=S[Z]}),x};a.collect=function(x,B,E,G){var P=Uc(6);B=B.features.map(function(S){var V;return{minX:S.geometry.coordinates[0],minY:S.geometry.coordinates[1],maxX:S.geometry.coordinates[0],maxY:S.geometry.coordinates[1],property:null===(V=S.properties)||void 0===V?void 0:V[E]}});return P.load(B),x.features.forEach(function(S){S.properties||(S.properties={});var V=ya(S),Z=[];P.search({minX:V[0],minY:V[1],maxX:V[2],maxY:V[3]}).forEach(function(X){Tb([X.minX,X.minY],S)&&Z.push(X.property)});
S.properties[G]=Z}),x};a.collectionOf=Ka;a.combine=function(x){var B={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return Sa(x,function(E){var G,P,S,V;switch(null===(V=E.geometry)||void 0===V?void 0:V.type){case "Point":B.MultiPoint.coordinates.push(E.geometry.coordinates);B.MultiPoint.properties.push(E.properties);break;case "MultiPoint":(G=B.MultiPoint.coordinates).push.apply(G,E.geometry.coordinates);B.MultiPoint.properties.push(E.properties);
break;case "LineString":B.MultiLineString.coordinates.push(E.geometry.coordinates);B.MultiLineString.properties.push(E.properties);break;case "MultiLineString":(P=B.MultiLineString.coordinates).push.apply(P,E.geometry.coordinates);B.MultiLineString.properties.push(E.properties);break;case "Polygon":B.MultiPolygon.coordinates.push(E.geometry.coordinates);B.MultiPolygon.properties.push(E.properties);break;case "MultiPolygon":(S=B.MultiPolygon.coordinates).push.apply(S,E.geometry.coordinates),B.MultiPolygon.properties.push(E.properties)}}),
J(Object.keys(B).filter(function(E){return B[E].coordinates.length}).sort().map(function(E){return g({type:E,coordinates:B[E].coordinates},{collectedProperties:B[E].properties})}))};a.concave=function(x,B){void 0===B&&(B={});var E=B.maxEdge||1/0;x=ek(function(G){var P=[],S={};return Sa(G,function(V){if(V.geometry){var Z=V.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(S,Z)||(P.push(V),S[Z]=!0)}}),J(P)}(x));if(x.features=x.features.filter(function(G){var P=G.geometry.coordinates[0][0],
S=G.geometry.coordinates[0][1],V=G.geometry.coordinates[0][2];G=Lb(P,S,B);S=Lb(S,V,B);P=Lb(P,V,B);return G<=E&&S<=E&&P<=E}),1>x.features.length)return null;x=Tn(x);return 1===x.coordinates.length&&(x.coordinates=x.coordinates[0],x.type="Polygon"),g(x)};a.containsNumber=xa;a.convertArea=pa;a.convertDistance=ka;a.convertLength=ka;a.convex=bk;a.coordAll=uc;a.coordEach=Ca;a.coordReduce=Vb;a.createBins=aj;a.degrees2radians=ma;a.degreesToRadians=ma;a.destination=je;a.difference=function(x,B){var E=Ib(x);
B=Ib(B);x=x.properties||{};E=Ce.difference(E.coordinates,B.coordinates);return 0===E.length?null:1===E.length?D(E[0],x):T(E,x)};a.dissolve=function(x,B){if(!ta(B=B||{}))throw Error("options is invalid");var E=B.propertyName;Ka(x,"Polygon","dissolve");var G=[];if(!B.propertyName)return Ni(T(Ce.union.apply(null,x.features.map(function(V){return V.geometry.coordinates}))));var P={};Sa(x,function(V){Object.prototype.hasOwnProperty.call(P,V.properties[E])||(P[V.properties[E]]=[]);P[V.properties[E]].push(V)});
x=Object.keys(P);for(B=0;B<x.length;B++){var S=T(Ce.union.apply(null,P[x[B]].map(function(V){return V.geometry.coordinates})));S.properties[E]=x[B];G.push(S)}return Ni(J(G))};a.distance=Lb;a.distanceToDegrees=R;a.distanceToRadians=fa;a.distanceWeight=Ml;a.earthRadius=6371008.8;a.ellipse=Jl;a.envelope=rk;a.explode=xh;a.factors=mh;a.feature=g;a.featureCollection=J;a.featureEach=Sa;a.featureOf=Ob;a.featureReduce=Ya;a.filterProperties=Zl;a.findPoint=Ba;a.findSegment=oa;a.flatten=Ni;a.flattenEach=Rb;a.flattenReduce=
Me;a.flip=function(x,B){if(!ta(B=B||{}))throw Error("options is invalid");B=B.mutate;if(!x)throw Error("geojson is required");return!1!==B&&void 0!==B||(x=Dc(x)),Ca(x,function(E){var G=E[0];E[0]=E[1];E[1]=G}),x};a.geojsonType=Oa;a.geomEach=Zb;a.geomReduce=pd;a.geometry=p;a.geometryCollection=O;a.getCluster=Xl;a.getCoord=aa;a.getCoords=Y;a.getGeom=Ib;a.getType=qc;a.greatCircle=function(x,B,E){if("object"!=typeof(E=E||{}))throw Error("options is invalid");var G=E.properties,P=E.npoints;E=E.offset;return x=
aa(x),B=aa(B),G=G||{},P=P||100,E=E||10,(new tj({x:x[0],y:x[1]},{x:B[0],y:B[1]},G)).Arc(P,{offset:E}).json()};a.helpers=So;a.hexGrid=Em;a.inside=Tb;a.interpolate=function(x,B,E){if("object"!=typeof(E=E||{}))throw Error("options is invalid");var G=E.gridType,P=E.property,S=E.weight;if(!x)throw Error("points is required");if(Ka(x,"Point","input must contain Points"),!B)throw Error("cellSize is required");if(void 0!==S&&"number"!=typeof S)throw Error("weight must be a number");P=P||"elevation";G=G||"square";
S=S||1;var V=ya(x);switch(G){case "point":case "points":B=Pk(V,B,E);break;case "square":case "squares":B=Fm(V,B,E);break;case "hex":case "hexes":B=Em(V,B,E);break;case "triangle":case "triangles":B=Gm(V,B,E);break;default:throw Error("invalid gridType");}var Z=[];return Sa(B,function(X){var ea=0,na=0;Sa(x,function(ia){var ra,ja=Lb("point"===G?X:Ne(X),ia,E);if(void 0!==P&&(ra=ia.properties[P]),void 0===ra&&(ra=ia.geometry.coordinates[2]),void 0===ra)throw Error("zValue is missing");0===ja&&(ea=ra);
ia=1/Math.pow(ja,S);na+=ia;ea+=ia*ra});var qa=Dc(X);qa.properties[P]=ea/na;Z.push(qa)}),J(Z)};a.intersect=Kg;a.invariant=Uo;a.isNumber=la;a.isObject=ta;a.isobands=function(x,B,E){if(!ta(E=E||{}))throw Error("options is invalid");var G=E.zProperty||"elevation",P=E.commonProperties||{},S=E.breaksProperties||[];if(Ka(x,"Point","Input must contain Points"),!B)throw Error("breaks is required");if(!Array.isArray(B))throw Error("breaks is not an Array");if(!ta(P))throw Error("commonProperties is not an Object");
if(!Array.isArray(S))throw Error("breaksProperties is not an Array");E=bo(x,{zProperty:G,flip:!0});B=function(V,Z,X){for(var ea=[],na=1;na<Z.length;na++){var qa=+Z[na-1],ia=+Z[na],ra=io(ho(co(V,qa,ia-qa))),ja={};ja.groupedRings=ra;ja[X]=qa+"-"+ia;ea.push(ja)}return ea}(E,B,G);return J((B=function(V,Z,X){X=ya(X);var ea=X[0],na=X[1],qa=(X[2]-X[0])/(Z[0].length-1),ia=(X[3]-X[1])/(Z.length-1),ra=function(ja){ja[0]=ja[0]*qa+ea;ja[1]=ja[1]*ia+na};return V.forEach(function(ja){ja.groupedRings.forEach(function(Ma){Ma.forEach(function(Pa){Pa.forEach(ra)})})}),
V}(B,E,x)).map(function(V,Z){if(S[Z]&&!ta(S[Z]))throw Error("Each mappedProperty is required to be an Object");Z=rj({},P,S[Z]);return Z[G]=V[G],T(V.groupedRings,Z)}))};a.isolines=function(x,B,E){if(!ta(E=E||{}))throw Error("options is invalid");var G=E.zProperty||"elevation",P=E.commonProperties||{};E=E.breaksProperties||[];if(Ka(x,"Point","Input must contain Points"),!B)throw Error("breaks is required");if(!Array.isArray(B))throw Error("breaks must be an Array");if(!ta(P))throw Error("commonProperties must be an Object");
if(!Array.isArray(E))throw Error("breaksProperties must be an Array");var S=lh(x,{zProperty:G,flip:!0});return J(function(V,Z,X){X=ya(X);var ea=X[0],na=X[1],qa=(X[2]-X[0])/(Z[0].length-1),ia=(X[3]-X[1])/(Z.length-1),ra=function(ja){ja[0]=ja[0]*qa+ea;ja[1]=ja[1]*ia+na};return V.forEach(function(ja){Ca(ja,ra)}),V}(function(V,Z,X,ea,na){for(var qa=[],ia=1;ia<Z.length;ia++){var ra=+Z[ia],ja=rj({},ea,na[ia]);ja[X]=ra;ra=I(ff(V,ra),ja);qa.push(ra)}return qa}(S,B,G,P,E),S,x))};a.kinks=function(x){var B=
{type:"FeatureCollection",features:[]};if("LineString"===(x="Feature"===x.type?x.geometry:x).type)var E=[x.coordinates];else if("MultiLineString"===x.type)E=x.coordinates;else if("MultiPolygon"===x.type)E=[].concat.apply([],x.coordinates);else{if("Polygon"!==x.type)throw Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");E=x.coordinates}return E.forEach(function(G){E.forEach(function(P){for(var S=0;S<G.length-1;S++)for(var V=S;V<P.length-1;V++){if(G===
P){if(1===Math.abs(S-V))continue;if(0===S&&V===G.length-2&&G[S][0]===G[G.length-1][0]&&G[S][1]===G[G.length-1][1])continue}var Z,X=void 0,ea=void 0,na=void 0,qa=void 0,ia=G[S][0],ra=G[S][1],ja=G[S+1][0],Ma=G[S+1][1],Pa=P[V][0],Sb=P[V][1],Qa=P[V+1][0],Wc=P[V+1][1],fc={x:null,y:null,onLine1:!1,onLine2:!1};(Z=0===(qa=(Wc-Sb)*(ja-ia)-(Qa-Pa)*(Ma-ra))?null!==fc.x&&null!==fc.y&&fc:(X=(ja-ia)*(na=ra-Sb)-(Ma-ra)*(ea=ia-Pa),na=((Qa-Pa)*na-(Wc-Sb)*ea)/qa,ea=X/qa,fc.x=ia+na*(ja-ia),fc.y=ra+na*(Ma-ra),0<=na&&
1>=na&&(fc.onLine1=!0),0<=ea&&1>=ea&&(fc.onLine2=!0),!(!fc.onLine1||!fc.onLine2)&&[fc.x,fc.y]))&&B.features.push(t([Z[0],Z[1]]))}})}),B};a.length=Mi;a.lengthToDegrees=R;a.lengthToRadians=fa;a.lineArc=Vk;a.lineChunk=function(x,B,E){if(!ta(E=E||{}))throw Error("options is invalid");var G=E.units,P=E.reverse;if(!x)throw Error("geojson is required");if(0>=B)throw Error("segmentLength must be greater than 0");var S=[];return Rb(x,function(V){P&&(V.geometry.coordinates=V.geometry.coordinates.reverse());
(function(Z,X,ea,na){var qa=Mi(Z,{units:ea});if(qa<=X)return na(Z);qa/=X;Number.isInteger(qa)||(qa=Math.floor(qa)+1);for(var ia=0;ia<qa;ia++)na(Lk(Z,X*ia,X*(ia+1),{units:ea}),ia)})(V,B,G,function(Z){S.push(Z)})}),J(S)};a.lineDistance=Mi;a.lineEach=Q;a.lineIntersect=ke;a.lineOffset=function(x,B,E){if(!ta(E=E||{}))throw Error("options is invalid");var G=E.units;if(!x)throw Error("geojson is required");if(null==B||isNaN(B))throw Error("distance is required");E=qc(x);var P=x.properties;switch(E){case "LineString":return ml(x,
B,G);case "MultiLineString":var S=[];return Rb(x,function(V){S.push(ml(V,B,G).geometry.coordinates)}),I(S,P);default:throw Error("geometry "+E+" is not supported");}};a.lineOverlap=bl;a.lineReduce=ca;a.lineSegment=kf;a.lineSlice=function(x,B,E){var G=Y(E);if("LineString"!==qc(E))throw Error("line must be a LineString");x=Be(E,x);B=Be(E,B);x=[(B=x.properties.index<=B.properties.index?[x,B]:[B,x])[0].geometry.coordinates];for(var P=B[0].properties.index+1;P<B[1].properties.index+1;P++)x.push(G[P]);
return x.push(B[1].geometry.coordinates),K(x,E.properties)};a.lineSliceAlong=Lk;a.lineSplit=function(x,B){if(!x)throw Error("line is required");if(!B)throw Error("splitter is required");var E=qc(x),G=qc(B);if("LineString"!==E)throw Error("line must be LineString");if("FeatureCollection"===G)throw Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===G)throw Error("splitter cannot be a GeometryCollection");B=Qk(B,{precision:7});switch(G){case "Point":return Oi(x,B);case "MultiPoint":return Tk(x,
B);case "LineString":case "MultiLineString":case "Polygon":case "MultiPolygon":return Tk(x,ke(x,B))}};a.lineString=K;a.lineStringToPolygon=Yk;a.lineStrings=H;a.lineToPolygon=Yk;a.mask=function(x,B){var E=D(B&&B.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]);B=null;return"FeatureCollection"===x.type?B=T(2===x.features.length?Ce.union(x.features[0].geometry.coordinates,x.features[1].geometry.coordinates):Ce.union.apply(Ce,x.features.map(function(G){return G.geometry.coordinates}))):
B=T(Ce.union(x.geometry.coordinates)),B.geometry.coordinates.forEach(function(G){E.geometry.coordinates.push(G[0])}),E};a.meta=To;a.midpoint=function(x,B){return je(x,Lb(x,B)/2,Ae(x,B))};a.moranIndex=function(x,B){var E=B.inputField,G=Ml(x,{alpha:B.alpha||-1,binary:B.binary||!1,p:B.p||2,standardization:B.standardization||!0,threshold:B.threshold||1E5}),P=[];Sa(x,function(ra){P.push((ra.properties||{})[E])});for(var S=Nl(P),V=function(ra){for(var ja=Nl(ra),Ma=0,Pa=0;Pa<ra.length;Pa++)Ma+=Math.pow(ra[Pa]-
ja,2);return Ma/ra.length}(P),Z=0,X=B=x=0,ea=G.length,na=0;na<ea;na++){for(var qa=0,ia=0;ia<ea;ia++)Z+=G[na][ia]*(P[na]-S)*(P[ia]-S),x+=G[na][ia],B+=Math.pow(G[na][ia]+G[ia][na],2),qa+=G[na][ia]+G[ia][na];X+=Math.pow(qa,2)}G=Z/x/V;S=-1/(ea-1);V=(ea*ea*(B*=.5)-ea*X+x*x*3)/((ea-1)*(ea+1)*x*x)-S*S;x=Math.sqrt(V);return{expectedMoranIndex:S,moranIndex:G,stdNorm:x,zNorm:(G-S)/x}};a.multiLineString=I;a.multiPoint=N;a.multiPolygon=T;a.nearest=zh;a.nearestPoint=zh;a.nearestPointOnLine=Be;a.nearestPointToLine=
function(x,B,E){void 0===E&&(E={});var G=E.units;E=E.properties||{};x=function(V){var Z=[];switch(V.geometry?V.geometry.type:V.type){case "GeometryCollection":return Zb(V,function(X){"Point"===X.type&&Z.push({type:"Feature",properties:{},geometry:X})}),{type:"FeatureCollection",features:Z};case "FeatureCollection":return V.features=V.features.filter(function(X){return"Point"===X.geometry.type}),V;default:throw Error("points must be a Point Collection");}}(x);if(!x.features.length)throw Error("points must contain features");
if(!B)throw Error("line is required");if("LineString"!==qc(B))throw Error("line must be a LineString");var P=1/0,S=null;return Sa(x,function(V){var Z=Gk(V,B,{units:G});Z<P&&(P=Z,S=V)}),S&&(S.properties=rj({dist:P},S.properties,E)),S};a.planepoint=function(x,B){var E=aa(x);x=Ib(B).coordinates[0];if(4>x.length)throw Error("OuterRing of a Polygon must have 4 or more Positions.");B=B.properties||{};var G=B.a,P=B.b,S=B.c;B=E[0];E=E[1];var V=x[0][0],Z=x[0][1];G=void 0!==G?G:x[0][2];var X=x[1][0],ea=x[1][1];
P=void 0!==P?P:x[1][2];var na=x[2][0],qa=x[2][1];x=void 0!==S?S:x[2][2];return(x*(B-V)*(E-ea)+G*(B-X)*(E-qa)+P*(B-na)*(E-Z)-P*(B-V)*(E-qa)-x*(B-X)*(E-Z)-G*(B-na)*(E-ea))/((B-V)*(E-ea)+(B-X)*(E-qa)+(B-na)*(E-Z)-(B-V)*(E-qa)-(B-X)*(E-Z)-(B-na)*(E-ea))};a.point=t;a.pointGrid=Pk;a.pointOnFeature=Hk;a.pointOnLine=Be;a.pointOnSurface=Hk;a.pointToLineDistance=Gk;a.points=A;a.pointsWithinPolygon=ti;a.polygon=D;a.polygonSmooth=function(x,B){var E=[],G=B.iterations||1;if(!x)throw Error("inputPolys is required");
return Zb(x,function(P,S,V){switch(P.type){case "Polygon":S=[[]];for(var Z=0;Z<G;Z++){var X=[[]];var ea=P;0<Z&&(ea=D(S).geometry);Ao(ea,X);S=X.slice(0)}E.push(D(S,V));break;case "MultiPolygon":S=[[[]]];for(Z=0;Z<G;Z++)X=[[[]]],ea=P,0<Z&&(ea=T(S).geometry),Bo(ea,X),S=X.slice(0);E.push(T(S,V));break;default:throw Error("geometry is invalid, must be Polygon or MultiPolygon");}}),J(E)};a.polygonTangents=function(x,B){var E=Y(x),G=Y(B),P=ya(B),S=0,V=null;switch(E[0]>P[0]&&E[0]<P[2]&&E[1]>P[1]&&E[1]<P[3]&&
(S=(V=zh(x,xh(B))).properties.featureIndex),qc(B)){case "Polygon":var Z=G[0][S];var X=G[0][0];null!==V&&V.geometry.coordinates[1]<E[1]&&(X=G[0][S]);var ea=Ag(G[0][0],G[0][G[0].length-1],E);G=fl(G[0],E,ea,void 0,Z,X);Z=G[0];X=G[1];break;case "MultiPolygon":for(V=P=B=x=0;V<G[0].length;V++){x=V;for(var na=!1,qa=0;qa<G[0][V].length;qa++){if(B=qa,P===S){na=!0;break}P++}if(na)break}Z=G[0][x][B];X=G[0][x][B];ea=Ag(G[0][0][0],G[0][0][G[0][0].length-1],E);G.forEach(function(ia){ia=fl(ia[0],E,ea,void 0,Z,X);
Z=ia[0];X=ia[1]})}return J([t(Z),t(X)])};a.polygonToLine=zg;a.polygonToLineString=zg;a.polygonize=function(x){x=ap.fromGeoJson(x);x.deleteDangles();x.deleteCutEdges();var B=[],E=[];return x.getEdgeRings().filter(function(G){return G.isValid()}).forEach(function(G){G.isHole()?B.push(G):E.push(G)}),B.forEach(function(G){Tm.findEdgeRingContaining(G,E)&&E.push(G)}),J(E.map(function(G){return G.toPolygon()}))};a.polygons=F;a.projection=ip;a.propEach=Kb;a.propReduce=Qd;a.propertiesContainsFilter=bj;a.radians2degrees=
ha;a.radiansToDegrees=ha;a.radiansToDistance=ba;a.radiansToLength=ba;a.random=jp;a.randomLineString=Wl;a.randomPoint=Ul;a.randomPolygon=Vl;a.randomPosition=Gg;a.rewind=function(x,B){if(!ta(B=B||{}))throw Error("options is invalid");var E=B.reverse||!1;B=B.mutate||!1;if(!x)throw Error("<geojson> is required");if("boolean"!=typeof E)throw Error("<reverse> must be a boolean");if("boolean"!=typeof B)throw Error("<mutate> must be a boolean");!1===B&&(x=Dc(x));var G=[];switch(x.type){case "GeometryCollection":return Zb(x,
function(P){Eh(P,E)}),x;case "FeatureCollection":return Sa(x,function(P){Sa(Eh(P,E),function(S){G.push(S)})}),J(G)}return Eh(x,E)};a.rhumbBearing=lf;a.rhumbDestination=Hf;a.rhumbDistance=Bh;a.round=W;a.sample=function(x,B){if(!x)throw Error("featurecollection is required");if(null==B)throw Error("num is required");if("number"!=typeof B)throw Error("num must be a number");var E=x.features,G;x=E.slice(0);E=E.length;for(var P=E-B;E-- >P;)B=x[G=Math.floor((E+1)*Math.random())],x[G]=x[E],x[E]=B;x=x.slice(P);
return J(x)};a.sector=function(x,B,E,G,P){if(!ta(P=P||{}))throw Error("options is invalid");var S=P.properties;if(!x)throw Error("center is required");if(null==E)throw Error("bearing1 is required");if(null==G)throw Error("bearing2 is required");if(!B)throw Error("radius is required");if("object"!=typeof P)throw Error("options must be an object");if(dl(E)===dl(G))return Di(x,B,P);var V=Y(x);x=Vk(x,B,E,G,P);var Z=[[V]];return Ca(x,function(X){Z[0].push(X)}),Z[0].push(V),D(Z,S)};a.segmentEach=L;a.segmentReduce=
M;a.shortestPath=function(x,B,E){if(!ta(E=E||{}))throw Error("options is invalid");var G=E.resolution,P=E.minDistance,S=E.obstacles||J([]);if(!x)throw Error("start is required");if(!B)throw Error("end is required");if(G&&!la(G)||0>=G)throw Error("options.resolution must be a number, greater than 0");if(P)throw Error("options.minDistance is not yet implemented");P=aa(x);var V=aa(B);switch(x=t(P),B=t(V),qc(S)){case "FeatureCollection":if(0===S.features.length)return K([P,V]);break;case "Polygon":S=
J([g(Ib(S))]);break;default:throw Error("invalid obstacles");}var Z=S;Z.features.push(x);Z.features.push(B);var X=ya(kl(Ci(ya(Z)),1.15));G||=Lb([X[0],X[1]],[X[2],X[1]],E)/100;Z.features.pop();Z.features.pop();Z=X[0];var ea=X[1],na=X[2],qa=X[3];X=G/Lb([Z,ea],[na,ea],E)*(na-Z);E=G/Lb([Z,ea],[Z,qa],E)*(qa-ea);G=na-Z;var ia=qa-ea,ra=(G-Math.floor(G/X)*X)/2,ja=[],Ma=[];G=[];var Pa=[],Sb=1/0,Qa=1/0;qa-=(ia-Math.floor(ia/E)*E)/2;for(ia=0;qa>=ea;){for(var Wc=[],fc=[],nc=Z+ra,cc=0;nc<=na;){var gc=t([nc,qa]),
Gc=no(gc,S);Wc.push(Gc?0:1);fc.push(nc+"|"+qa);var Qf=Lb(gc,x);!Gc&&Qf<Sb&&(Sb=Qf,G={x:cc,y:ia});gc=Lb(gc,B);!Gc&&gc<Qa&&(Qa=gc,Pa={x:cc,y:ia});nc+=X;cc++}Ma.push(Wc);ja.push(fc);qa-=E;ia++}x=new If(Ma,{diagonal:!0});x=Vh.search(x,x.grid[G.y][G.x],x.grid[Pa.y][Pa.x]);var Qe=[P];return x.forEach(function(kh){kh=ja[kh.x][kh.y].split("|");Qe.push([+kh[0],+kh[1]])}),Qe.push(V),hf(K(Qe))};a.simplify=function(x,B){if(!ta(B=B||{}))throw Error("options is invalid");var E=void 0!==B.tolerance?B.tolerance:
1,G=B.highQuality||!1;B=B.mutate||!1;if(!x)throw Error("geojson is required");if(E&&0>E)throw Error("invalid tolerance");return!0!==B&&(x=Dc(x)),Zb(x,function(P){!function(S,V,Z){var X=S.type;if("Point"===X||"MultiPoint"===X)return S;hf(S,!0);var ea=S.coordinates;switch(X){case "LineString":S.coordinates=ok(ea,V,Z);break;case "MultiLineString":S.coordinates=ea.map(function(na){return ok(na,V,Z)});break;case "Polygon":S.coordinates=pk(ea,V,Z);break;case "MultiPolygon":S.coordinates=ea.map(function(na){return pk(na,
V,Z)})}}(P,E,G)}),x};a.square=sk;a.squareGrid=Fm;a.standardDeviationalEllipse=function(x,B){if(!ta(B=B||{}))throw Error("options is invalid");var E=B.steps||64,G=B.weight,P=B.properties||{};if(!la(E))throw Error("steps must be a number");if(!ta(P))throw Error("properties must be a number");B=uc(x).length;var S=Zi(x,{weight:G}),V=0,Z=0,X=0;Sa(x,function(Pa){var Sb=Pa.properties[G]||1;Pa=Ll(Y(Pa),Y(S));V+=Math.pow(Pa.x,2)*Sb;Z+=Math.pow(Pa.y,2)*Sb;X+=Pa.x*Pa.y*Sb});var ea=V-Z,na=Math.atan((ea+Math.sqrt(Math.pow(ea,
2)+4*Math.pow(X,2)))/(2*X));ea=180*na/Math.PI;var qa=0,ia=0,ra=0;Sa(x,function(Pa){var Sb=Pa.properties[G]||1;Pa=Ll(Y(Pa),Y(S));qa+=Math.pow(Pa.x*Math.cos(na)-Pa.y*Math.sin(na),2)*Sb;ia+=Math.pow(Pa.x*Math.sin(na)+Pa.y*Math.cos(na),2)*Sb;ra+=Sb});var ja=Math.sqrt(2*qa/ra),Ma=Math.sqrt(2*ia/ra);E=Jl(S,ja,Ma,{units:"degrees",angle:ea,steps:E,properties:P});x=ti(x,J([E]));x={meanCenterCoordinates:Y(S),semiMajorAxis:ja,semiMinorAxis:Ma,numberOfFeatures:B,angle:ea,percentageWithinEllipse:100*uc(x).length/
B};return E.properties.standardDeviationalEllipse=x,E};a.tag=function(x,B,E,G){return x=Dc(x),B=Dc(B),Sa(x,function(P){P.properties||(P.properties={});Sa(B,function(S){void 0===P.properties[G]&&Tb(P,S)&&(P.properties[G]=S.properties[E])})}),x};a.tesselate=function(x){if(!x.geometry||"Polygon"!==x.geometry.type&&"MultiPolygon"!==x.geometry.type)throw Error("input must be a Polygon or MultiPolygon");var B={type:"FeatureCollection",features:[]};return"Polygon"===x.geometry.type?B.features=xk(x.geometry.coordinates):
x.geometry.coordinates.forEach(function(E){B.features=B.features.concat(xk(E))}),B};a.tin=ek;a.toMercator=Ol;a.toWgs84=Ql;a.transformRotate=jl;a.transformScale=kl;a.transformTranslate=function(x,B,E,G){if(!ta(G=G||{}))throw Error("options is invalid");var P=G.units,S=G.zTranslation;G=G.mutate;if(!x)throw Error("geojson is required");if(null==B||isNaN(B))throw Error("distance is required");if(S&&"number"!=typeof S&&isNaN(S))throw Error("zTranslation is not a number");if(S=void 0!==S?S:0,0===B&&0===
S)return x;if(null==E||isNaN(E))throw Error("direction is required");return 0>B&&(B=-B,E+=180),!1!==G&&void 0!==G||(x=Dc(x)),Ca(x,function(V){var Z=Y(Hf(V,B,E,{units:P}));V[0]=Z[0];V[1]=Z[1];S&&3===V.length&&(V[2]+=S)}),x};a.triangleGrid=Gm;a.truncate=Qk;a.union=function(x,B,E){void 0===E&&(E={});x=Ib(x);B=Ib(B);B=Ce.union(x.coordinates,B.coordinates);return 0===B.length?null:1===B.length?D(B[0],E.properties):T(B,E.properties)};a.unitsFactors=Hm;a.unkinkPolygon=function(x){var B=[];return Rb(x,function(E){"Polygon"===
E.geometry.type&&Sa($n(E),function(G){B.push(D(G.geometry.coordinates,E.properties))})}),J(B)};a.validateBBox=wa;a.validateId=za;a.voronoi=function(x,B){if(!ta(B=B||{}))throw Error("options is invalid");B=B.bbox||[-180,-85,180,85];if(!x)throw Error("points is required");if(!Array.isArray(B))throw Error("bbox is invalid");return Ka(x,"Point","points"),J(function(){function E(V){return new Yi(V.map(function(Z,X){var ea=[Math.round(G(Z,X,V)/Wb)*Wb,Math.round(P(Z,X,V)/Wb)*Wb];return ea.index=X,ea.data=
Z,ea}),S)}var G=oo,P=po,S=null;return E.polygons=function(V){return E(V).polygons()},E.links=function(V){return E(V).links()},E.triangles=function(V){return E(V).triangles()},E.x=function(V){return arguments.length?(G="function"==typeof V?V:Cl(+V),E):G},E.y=function(V){return arguments.length?(P="function"==typeof V?V:Cl(+V),E):P},E.extent=function(V){return arguments.length?(S=null==V?null:[[+V[0][0],+V[0][1]],[+V[1][0],+V[1][1]]],E):S&&[[S[0][0],S[0][1]],[S[1][0],S[1][1]]]},E.size=function(V){return arguments.length?
(S=null==V?null:[[0,0],[+V[0],+V[1]]],E):S&&[S[1][0]-S[0][0],S[1][1]-S[0][1]]},E}().x(function(E){return E.geometry.coordinates[0]}).y(function(E){return E.geometry.coordinates[1]}).extent([[B[0],B[1]],[B[2],B[3]]]).polygons(x.features).map(zo))};a.within=ti;Object.defineProperty(a,"__esModule",{value:!0})});var module$libs$turf_min={};const html$$module$settlements=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
var thickLineToPolygon$$module$settlements=function(){function a(g,p,t,A){p=(p.y-g.y)/(p.x-g.x);A=(A.y-t.y)/(A.x-t.x);if(p!==A)return g=g.y-p*g.x,t=(g-(t.y-A*t.x))/(A-p),{x:t,y:p*t+g}}return function(g,p){for(var t,A,D=[],F,K,H,J,I,N,T,O,W,ba=0,fa=g.length-1;ba<fa;ba++)F=!ba,K=ba===g.length-2,t=g[ba],O=g[ba+1],T=O.x-t.x,t=O.y-t.y,O=p/(2*Math.sqrt(T*T+t*t)),t*=-O,A=O*T,T={x:g[ba].x+t,y:g[ba].y+A},O={x:g[ba+1].x+t,y:g[ba+1].y+A},W={x:g[ba].x-t,y:g[ba].y-A},t={x:g[ba+1].x-t,y:g[ba+1].y-A},F||((I=a(H[0],
H[1],T,O))&&D.unshift(I),(N=a(J[0],J[1],W,t))&&D.push(N)),F&&(D.unshift(T),D.push(W)),K&&(D.unshift(O),D.push(t)),K||(H=[T,O],J=[W,t]);return D}}();function coordsToPoints$$module$settlements(a){let g=[];for(let p=0;p<a.length;p++)g.push({x:a[p][0],y:a[p][1]});return g}function pointsToCoords$$module$settlements(a){let g=[];for(let p=0;p<a.length;p++)g.push([a[p].x,a[p].y]);return g}
function makeSmoothPolygon$$module$settlements(a){a.push(a[0]);a=turf.polygonSmooth(turf.polygon([a]),{iterations:3});let g="";turf.featureEach(a,(p,t)=>{p=turf.getCoords(turf.getGeom(p))[0];g="M "+p[0][0]+" "+p[0][1]+" ";for(t=1;t<p.length;t++)g=g+"L "+p[t][0]+" "+p[t][1]+" ";g+="Z"});return g}function makePolygon$$module$settlements(a){let g="M "+a[0][0]+" "+a[0][1]+" ";for(let p=1;p<a.length;p++)g=g+"L "+a[p][0]+" "+a[p][1]+" ";return g+"Z"}
function makeCurvedPath$$module$settlements(a){let g="M "+a[0][0]+" "+a[0][1]+" ";for(let p=1;p<a.length;p++)g=g+"L "+a[p][0]+" "+a[p][1]+" ";return g}function makePolygonFromLine$$module$settlements(a,g){a=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),g));g="M "+a[0][0]+" "+a[0][1]+" ";for(let p=1;p<a.length;p++)g=g+"L "+a[p][0]+" "+a[p][1]+" ";return g+"Z"}
function makeMergedPolygon$$module$settlements(a,g,p){a=a.slice();g[0].push(g[0][0]);g=turf.polygon(g);const t=turf.centerOfMass(g).geometry.coordinates;a.unshift(t);p=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),p));p.push(p[0]);p=turf.polygon([p]);p=turf.union(g,p);return makeSmoothPolygon$$module$settlements(p.geometry.coordinates[0])}
class Marker$$module$settlements extends k$$module$libs$preact{constructor(){super();this.setState({hover:"",radius:3})}mouseover(){this.setState({hover:"marker-label-hover",radius:10})}mouseout(){this.setState({hover:"",radius:3})}getLocationURL(){return"/sandbox/"+this.props.instance+"/location/"+this.props.uuid}render(a,g){const p=""!=g.hover?html$$module$settlements`
            <g
              id="active-poi-label"
              transform="translate( ${a.coords.x} , ${a.coords.y}) rotate(-${a.rotate})"
            >
              <text
                transform="translate( 0, -20)"
                class="marker-label ${g.hover}"
                font-size="0.8em"
                text-anchor="middle"
              >
                ${a.title}
              </text>
            </g>
          `:html$$module$settlements``;return html$$module$settlements`
      ${p}

      <g
        transform="translate( ${a.coords.x} , ${a.coords.y}) rotate(-${a.rotate})"
      >
        <circle
          class="marker-circle"
          r="${g.radius}"
          fill="${a.uuid==a.location?"#00ff00":"#ff0000"}"
        >
        </circle>
        <a href="${this.getLocationURL()}">
          <circle
            opacity="0"
            cursor="pointer"
            r="${2*g.radius}"
            onmouseover="${()=>{this.mouseover()}}"
            onmouseout="${()=>{this.mouseout()}}"
          >
          </circle
        ></a>
      </g>
    `}}var module$settlements={};module$settlements.Marker=Marker$$module$settlements;module$settlements.makeCurvedPath=makeCurvedPath$$module$settlements;module$settlements.makeMergedPolygon=makeMergedPolygon$$module$settlements;module$settlements.makePolygon=makePolygon$$module$settlements;module$settlements.makeSmoothPolygon=makeSmoothPolygon$$module$settlements;const html$$module$citymap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Wall$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#000000"
        stroke-width="8"
        fill="none"
    /></g>`}}class Estuary$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makeMergedPolygon$$module$settlements(a.river,a.water,a.river_width)}"
        fill="#1166aa"
    /></g>`}}class River$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makeCurvedPath$$module$settlements(a.coords)}"
        stroke="#1166aa"
        stroke-width="48"
        fill="none"
    /></g>`}}class Building$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){2==a.coords.length&&a.coords[1]?html$$module$citymap`
          <circle
            cx="${a.coords[0][0][0]}"
            cy="${a.coords[0][0][1]}"
            r="12"
            fill="#ff0000"
          />
        `:html$$module$citymap``;return html$$module$citymap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#000000"
        stroke-width="1"
        fill="#444444"
    /></g>`}}class Water$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="none"
        stroke-width="8"
        fill="#1166aa"
    /></g>`}}
class CityMap$$module$citymap extends k$$module$libs$preact{constructor(){super();this.setState({watabou:null})}fetch_map(a,g,p=!1){const t=window.app.settlements_cache[this.props.uuid];t&&!p&&this.setState({watabou:t.map_data,poi:t.poi});api_call_city$$module$api_shim(a,g).then(A=>{this.setState({watabou:A.map_data,poi:A.poi});window.app.settlements_cache[this.props.uuid]=A})}componentDidMount(a,g,p){this.fetch_map(this.props.instance,this.props.hex)}componentWillUpdate(a,g,p){this.props.uuid==a.uuid&&
this.props.location==a.location||this.fetch_map(a.instance,a.hex,!0)}render(a,g){if(null===g.watabou||"mfcg"!=g.watabou.features[0].generator)return html$$module$citymap``;const p=g.watabou.features[0].coast_dir||0,t=void 0!==g.watabou.features[0].coast_dir?-900:0;let A=html$$module$citymap``;0<g.watabou.features[4].geometries.length&&13<g.watabou.features.length?A=html$$module$citymap` <${Estuary$$module$citymap}
        river=${g.watabou.features[4].geometries[0].coordinates}
        water=${g.watabou.features[13].coordinates[0]}
        river_width=${g.watabou.features[0].riverWidth}
      />`:0<g.watabou.features[4].geometries.length?A=html$$module$citymap`
        ${g.watabou.features[4].geometries.map(F=>html$$module$citymap` <${River$$module$citymap} coords=${F.coordinates} />`)}
      `:g.watabou.features[13]&&(A=html$$module$citymap`
        ${g.watabou.features[13].coordinates.map(F=>html$$module$citymap` <${Water$$module$citymap} coords=${F} />`)}
      `);const D=60*p;return html$$module$citymap`
      <mask id="${a.hex}">
        <polygon
          fill="#ffffff"
          points="1000,-1800 -1000,-1800 -2000,000 -1000,1800 1000,1800 2000,0"
        />
      </mask>
      <g
        transform="scale(0.005 0.005) rotate(${D})"
        mask="url(#${a.hex})"
      >
        <g transform="translate(0,${t})">
          ${A}
          ${g.watabou.features[6].coordinates.map(F=>html$$module$citymap` <${Building$$module$citymap} coords=${F} />`)}
          <!--FIXME: This is too wasteful to loop through all the buildings.-->
          ${g.watabou.features[3].geometries.map(F=>html$$module$citymap` <${Wall$$module$citymap} coords=${F.coordinates} />`)}
          ${g.poi.map(F=>html$$module$citymap` <${Marker$$module$settlements}
              coords=${F.coords}
              uuid=${F.uuid}
              instance=${a.instance}
              title=${F.title}
              radius="4"
              rotate=${D}
              location=${a.location}
            />`)}
          <use xlink:href="#active-poi-label" />
        </g>
      </g>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#ff0000"
        stroke-width="2"
        fill="none"
        style="stroke-width:0.2;"
      />
    `}}var module$citymap={};module$citymap.CityMap=CityMap$$module$citymap;function metaball$$module$metaballs(a){a.forEach(t=>t.c=[t.x,t.y]);let g="";for(let t=0;t<a.length;t++){var p=a.slice(0,3);a.push(a.shift());const A=curvesBetweenCircles$$module$metaballs(p[0].r,p[1].r,p[0].c,p[1].c);p=curvesBetweenCircles$$module$metaballs(p[1].r,p[2].r,p[1].c,p[2].c);0===t&&(g+=`M ${A.p[1][0]},${A.p[1][1]} `);g+=`C ${A.h[1][0]},${A.h[1][1]} ${A.h[3][0]},${A.h[3][1]} ${A.p[3][0]},${A.p[3][1]}`;g+=`A ${p.r1}, ${p.r1}, 1, 0, 1, ${p.p[1][0]}, ${p.p[1][1]}`}return g+"Z"}
function metablob$$module$metaballs(a){let g=[];for(let p=0;6>p;p++){const t=getVector$$module$metaballs([a.x,a.y],Math.PI/3*p,.5*a.r);g.push({x:t[0],y:t[1],r:rand$$module$utils(2E3,3500)/1E3})}return metaball$$module$metaballs(g)}
function curvesBetweenCircles$$module$metaballs(a,g,p,t,A=2.4,D=.5){var F=Math.PI/2;const K=dist$$module$metaballs(p,t);var H=0,J=0;if(0===a||0===g||K<=Math.abs(a-g))return null;K<a+g&&(H=Math.acos((a*a+K*K-g*g)/(2*a*K)),J=Math.acos((g*g+K*K-a*a)/(2*g*K)));var I=angle$$module$metaballs(t,p),N=Math.acos((a-g)/K),T=I+H+(N-H)*D,O=I-H-(N-H)*D;H=I+Math.PI-J-(Math.PI-J-N)*D;I=I-Math.PI+J+(Math.PI-J-N)*D;J=getVector$$module$metaballs(p,T,a);p=getVector$$module$metaballs(p,O,a);N=getVector$$module$metaballs(t,
H,g);t=getVector$$module$metaballs(t,I,g);const W=a+g;A=Math.min(D*A,dist$$module$metaballs(J,N)/W)*Math.min(1,2*K/(a+g));D=a*A;A*=g;T=getVector$$module$metaballs(J,T-F,D);O=getVector$$module$metaballs(p,O+F,D);H=getVector$$module$metaballs(N,H+F,A);F=getVector$$module$metaballs(t,I-F,A);return{p:[J,p,N,t],h:[T,O,H,F],escaped:K>a,r:g,r1:a}}function dist$$module$metaballs([a,g],[p,t]){return((a-p)**2+(g-t)**2)**.5}function angle$$module$metaballs([a,g],[p,t]){return Math.atan2(g-t,a-p)}
function getVector$$module$metaballs([a,g],p,t){return[a+t*Math.cos(p),g+t*Math.sin(p)]}var module$metaballs={};module$metaballs.metaball=metaball$$module$metaballs;module$metaballs.metablob=metablob$$module$metaballs;const html$$module$villagemap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Road$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeCurvedPath$$module$settlements(a.coords)}"
        stroke="#333"
        stroke-width="2"
        fill="none"
    /></g>`}}class Tree$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){a=metablob$$module$metaballs({x:a.coords[0],y:a.coords[1],r:8});return html$$module$villagemap`
      <path d="${a}" stroke="#334433" fill="#445544" stroke-width="1" />
    `}}class Building$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){2==a.coords.length&&a.coords[1]?html$$module$villagemap`
          <circle
            cx="${a.coords[0][0][0]}"
            cy="${a.coords[0][0][1]}"
            r="12"
            fill="#ff0000"
          />
        `:html$$module$villagemap``;return html$$module$villagemap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#000000"
        stroke-width="1"
        fill="#444444"
    /></g>`}}class Water$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="none"
        stroke-width="8"
        fill="#1166aa"
    /></g>`}}class Square$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="#333"
        stroke-width="2"
        fill="#998877"
    /></g>`}}class Field$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="#406030"
        stroke-width="2"
        fill="#446633"
    /></g>`}}
class VillageMap$$module$villagemap extends k$$module$libs$preact{constructor(){super();this.setState({watabou:null})}fetch_map(a,g,p=!1){const t=window.app.settlements_cache[this.props.uuid];t&&!p&&this.setState({watabou:t.map_data,poi:t.poi});api_call_city$$module$api_shim(a,g).then(A=>{this.setState({watabou:A.map_data,poi:A.poi});window.app.settlements_cache[this.props.uuid]=A})}componentDidMount(a,g,p){this.fetch_map(this.props.instance,this.props.hex)}componentWillUpdate(a,g,p){this.props.uuid==a.uuid&&
this.props.location==a.location||this.fetch_map(a.instance,a.hex,!0)}render(a,g){if(null===g.watabou||"vg"!=g.watabou.features[0].generator)return html$$module$villagemap``;const p=g.watabou.features[0].coast_dir||0,t=void 0!==g.watabou.features[0].coast_dir?-650:0;let A=html$$module$villagemap``,D=html$$module$villagemap``,F=html$$module$villagemap``,K=html$$module$villagemap``;for(const J of g.watabou.features)"squares"==J.id&&(K=html$$module$villagemap`
          ${J.coordinates.map(I=>html$$module$villagemap` <${Square$$module$villagemap} coords=${I} />`)}
        `),"water"==J.id&&(A=html$$module$villagemap`
          ${J.coordinates.map(I=>html$$module$villagemap` <${Water$$module$villagemap} coords=${I} />`)}
        `),"fields"==J.id&&(D=html$$module$villagemap`
          ${J.coordinates.map(I=>html$$module$villagemap` <${Field$$module$villagemap} coords=${I} />`)}
        `),"trees"==J.id&&(F=html$$module$villagemap`
          ${J.coordinates.map((I,N)=>{if(0==N%8)return html$$module$villagemap` <${Tree$$module$villagemap} coords=${I} />`})}
        `);const H=60*p;return html$$module$villagemap`
      <mask id="${a.hex}">
        <polygon
          fill="#ffffff"
          points="500,-900 -500,-900 -1000,000 -500,900 500,900 1000,0"
        />
      </mask>
      <g
        transform="scale(0.01 0.01) rotate(${H})"
        mask="url(#${a.hex})"
      >
        <g transform="translate(0,${t})">
          ${A} ${D}
          ${g.watabou.features[5].geometries.map(J=>html$$module$villagemap` <${Road$$module$villagemap} coords=${J.coordinates} />`)}
          ${K}
          ${g.watabou.features[2].coordinates.map(J=>html$$module$villagemap` <${Building$$module$villagemap} coords=${J} />`)}
          ${F}
          <!--FIXME: This is too wasteful to loop through all the buildings.-->
          ${g.poi.map(J=>html$$module$villagemap` <${Marker$$module$settlements}
              coords=${J.coords}
              uuid=${J.uuid}
              instance=${a.instance}
              title=${J.title}
              radius="2"
              rotate=${H}
              location=${a.location}
            />`)}
          <use xlink:href="#active-poi-label" />
        </g>
      </g>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#ff0000"
        stroke-width="2"
        fill="none"
        style="stroke-width:0.2;"
      />
    `}}var module$villagemap={};module$villagemap.VillageMap=VillageMap$$module$villagemap;const PERLIN_YWRAPB$$module$libs$perlin=4,PERLIN_YWRAP$$module$libs$perlin=1<<PERLIN_YWRAPB$$module$libs$perlin,PERLIN_ZWRAPB$$module$libs$perlin=8,PERLIN_ZWRAP$$module$libs$perlin=1<<PERLIN_ZWRAPB$$module$libs$perlin,PERLIN_SIZE$$module$libs$perlin=4095;let perlin_octaves$$module$libs$perlin=4,perlin_amp_falloff$$module$libs$perlin=.5;const scaled_cosine$$module$libs$perlin=a=>.5*(1-Math.cos(a*Math.PI));let perlin$$module$libs$perlin;
function noise$$module$libs$perlin(a,g=0,p=0){if(null==perlin$$module$libs$perlin){perlin$$module$libs$perlin=Array(PERLIN_SIZE$$module$libs$perlin+1);for(var t=0;t<PERLIN_SIZE$$module$libs$perlin+1;t++)perlin$$module$libs$perlin[t]=Math.random()}0>a&&(a=-a);0>g&&(g=-g);0>p&&(p=-p);t=Math.floor(a);let A=Math.floor(g),D=Math.floor(p);a-=t;g-=A;p-=D;let F,K,H=0,J=.5,I,N,T;for(let O=0;O<perlin_octaves$$module$libs$perlin;O++){let W=t+(A<<PERLIN_YWRAPB$$module$libs$perlin)+(D<<PERLIN_ZWRAPB$$module$libs$perlin);
F=scaled_cosine$$module$libs$perlin(a);K=scaled_cosine$$module$libs$perlin(g);I=perlin$$module$libs$perlin[W&PERLIN_SIZE$$module$libs$perlin];I+=F*(perlin$$module$libs$perlin[W+1&PERLIN_SIZE$$module$libs$perlin]-I);N=perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin&PERLIN_SIZE$$module$libs$perlin];N+=F*(perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin+1&PERLIN_SIZE$$module$libs$perlin]-N);I+=K*(N-I);W+=PERLIN_ZWRAP$$module$libs$perlin;N=perlin$$module$libs$perlin[W&PERLIN_SIZE$$module$libs$perlin];
N+=F*(perlin$$module$libs$perlin[W+1&PERLIN_SIZE$$module$libs$perlin]-N);T=perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin&PERLIN_SIZE$$module$libs$perlin];T+=F*(perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin+1&PERLIN_SIZE$$module$libs$perlin]-T);N+=K*(T-N);I+=scaled_cosine$$module$libs$perlin(p)*(N-I);H+=I*J;J*=perlin_amp_falloff$$module$libs$perlin;t<<=1;a*=2;A<<=1;g*=2;D<<=1;p*=2;1<=a&&(t++,a--);1<=g&&(A++,g--);1<=p&&(D++,p--)}return H}
function noiseDetail$$module$libs$perlin(a,g){0<a&&(perlin_octaves$$module$libs$perlin=a);0<g&&(perlin_amp_falloff$$module$libs$perlin=g)}
function noiseSeed$$module$libs$perlin(a){const g=(()=>{let p,t;return{setSeed(A){t=p=(null==A?4294967296*Math.random():A)>>>0},getSeed(){return p},rand(){t=(1664525*t+1013904223)%4294967296;return t/4294967296}}})();g.setSeed(a);perlin$$module$libs$perlin=Array(PERLIN_SIZE$$module$libs$perlin+1);for(a=0;a<PERLIN_SIZE$$module$libs$perlin+1;a++)perlin$$module$libs$perlin[a]=g.rand()}var module$libs$perlin={};module$libs$perlin.noise=noise$$module$libs$perlin;module$libs$perlin.noiseSeed=noiseSeed$$module$libs$perlin;const html$$module$dungeonmap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),kScale$$module$dungeonmap=.01,kScaleMultiplier$$module$dungeonmap=10*kScale$$module$dungeonmap;function getAreaMaskFillColor$$module$dungeonmap(a){return a.vtt?a.reveal?"#fff":"#000":window.app.ctrl_mode?a.reveal?"#fff":"#666":"#eee"}
class Token$$module$dungeonmap{constructor(a,g,p,t,A,D,F,K,H,J,I=!1){this.uuid=a;this.tuid=g;this.x=p;this.y=t;this.w=D;this.h=F;this.r=A;this.offset=K;this.tid=H;this.light=J;this.pc=I}pointInside(a,g){const p=this.x+this.offset.x,t=this.y+this.offset.y,A=this.w/2,D=this.h/2;return a>=p-A&&a<=p+A&&g>=t-D&&g<=t+D}}class DungeonEntrance$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){g=0;0==a.dir&&(g=180);3==a.dir&&(g=90);1==a.dir&&(g=270);return html$$module$dungeonmap`
      <g transform="translate(${10*a.x}, ${10*a.y})">
        <g transform="rotate(${g}, 5, 5)">
          <rect x="0" y="1" width="10" height="1" fill="#292828" />
          <rect x="1" y="3" width="8" height="1" fill="#292828" />
          <rect x="2" y="5" width="6" height="1" fill="#292828" />
          <rect x="3" y="7" width="4" height="1" fill="#292828" />
          <rect x="4" y="9" width="2" height="1" fill="#292828" />
        </g>
      </g>
    `}}class DungeonPortal$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){g=0;"S"==a.wall&&(g=180);"E"==a.wall&&(g=90);"W"==a.wall&&(g=270);if(0==a.type)return html$$module$dungeonmap`
        <g transform="translate(${10*a.x}, ${10*a.y})">
          <g transform="rotate(${g}, 5, 5)">
            <rect x="-1" y="5.5" width="12" height="3" fill="#292828" />
            <rect
              x="2"
              y="5"
              width="6"
              height="4"
              fill="#fff"
              stroke="#292828"
            />
            <title>${a.uuid}</title>
          </g>
        </g>
      `;if(!a.vtt)return html$$module$dungeonmap`
        <g transform="translate(${10*a.x}, ${10*a.y})">
          <g transform="rotate(${g}, 5, 5)">
            <rect x="-1" y="6.5" width="12" height="3" fill="#292828" />
            <text
              transform="translate(3, 9) rotate(90)"
              class="dcoords"
              alignment-baseline="baseline"
              text-anchor="middle"
              >S</text
            >
            <title>${a.uuid}</title>
          </g>
        </g>
      `}}
class DungeonPillars$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){if(50>a.w*a.h||1==a.w||1==a.h)return html$$module$dungeonmap``;g=[];if(a.w!=a.h)if(a.w<=a.h)for(var p=a.y+1;p<a.y+a.h;p++)g.push({x:10*(a.x+1),y:10*p}),g.push({x:10*(a.x+a.w-1),y:10*p});else for(p=a.x+1;p<a.x+a.w;p++)g.push({x:10*p,y:10*(a.y+1)}),g.push({x:10*p,y:10*(a.y+a.h-1)});return html$$module$dungeonmap`${g.map(t=>html$$module$dungeonmap` <circle cx="${t.x}" cy="${t.y}" r="2" fill="#212121" /> `)}`}}
class DungeonLink$$module$dungeonmap extends k$$module$libs$preact{clicked(a,g){if(window.app.inhibit_click)window.app.inhibit_click=!1;else if(a,window.app.shift_mode&&window.app.vtt_referee){let p=document.getElementById("canvas"),t=p.createSVGPoint();t.x=g.clientX;t.y=g.clientY;g=t.matrixTransform(p.getScreenCTM().inverse());this.props.onToken(a,g)}else window.app.kill_mode||this.props.onClick(a,window.app.ctrl_mode&&window.app.vtt_referee)}}function TorchMask$$module$dungeonmap(a){return html$$module$dungeonmap` <mask id="LightMask${a.uuid}">
    <rect x="-1000" y="-1000" width="2000" height="2000" fill="#000" />
    ${Array.from(window.app.tokens[a.uuid]).map(([,g])=>g.light&&html$$module$dungeonmap` <circle
          cx=${g.x/kScale$$module$dungeonmap}
          cy=${g.y/kScale$$module$dungeonmap}
          r=${g.light}
          fill="url('#TorchGradient${a.uuid}')"
        />`)}
  </mask>`}class DungeonCavernLink$$module$dungeonmap extends DungeonLink$$module$dungeonmap{get_path(a){let g="M "+a[0].x+","+a[0].y+" ";for(let p=1;p<a.length;p++)g=g+"L "+a[p].x+","+a[p].y+" ";return g+" Z"}render(a,g){g=html$$module$dungeonmap`
      <g transform="translate(${a.coords[0]} ${a.coords[1]})">
        <text
          transform="rotate(0)"
          class="dcoords"
          alignment-baseline="baseline"
          text-anchor="middle"
          >${a.number}</text
        >
      </g>
    `;g=html$$module$dungeonmap` <a onClick=${p=>this.clicked(a.uuid,p)}>
      <path d="${this.get_path(a.polygon)}" fill="transparent" />${g}</a
    >`;return html$$module$dungeonmap`<g>${g} </g>`}}
class DungeonCavern$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}make_line(a,g,p,t,A,D,F,K=!1,H=!1){let J=a=0,I=0;g!=t&&(a=5,J=(t-g)/5);p!=A&&(a=5,I=(A-p)/5);t="";for(K=K?0:1;K<=a-(H?0:1);K++)A=noise$$module$libs$perlin(this.inc),A*=1==K||K==a-1?.6:1.25,A*=0==K||K==a?.2:1.25,this.inc+=.2,t=t+" L "+(g+A*D+K*J)+","+(p+A*F+K*I);return t}get_path(a){let g="M "+a[0].x+","+a[0].y+" ";for(let p=1;p<a.length;p++){const t=1<a[p].c,A=1<a[p-1].c;if(A&&t){g=g+"L "+a[p].x+","+a[p].y+
" ";continue}const D=[-1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,1];this.rvi=this.rvi==D.length-1?0:this.rvi+1;let F=D[this.rvi];this.rvi=this.rvi==D.length-1?0:this.rvi+1;g+=this.make_line(this.props,a[p-1].x,a[p-1].y,a[p].x,a[p].y,F,D[this.rvi],A,t)}g+=this.make_line(this.props,a[a.length-1].x,a[a.length-1].y,a[0].x,a[0].y,0,0);return g+" Z"}render(a,g){this.rvi=this.inc=0;g=getAreaMaskFillColor$$module$dungeonmap(a);a=html$$module$dungeonmap`<path
      d="${this.get_path(a.polygon)}"
      stroke="${g}"
      stroke-width="1"
      fill="${g}"
    />`;return html$$module$dungeonmap`<g>${a} </g>`}}class DungeonArea$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}make_line(a,g,p,t,A,D,F){let K=0,H=0,J=0;g!=t&&(K=5*a.w,H=g>t?-2:2);p!=A&&(K=5*a.h,J=p>A?-2:2);a="";t=0;for(A=0;A<=K;A++){let I=noise$$module$libs$perlin(t);I*=1==A||A==K-1?.6:1.5;I*=0==A||A==K?.2:1.5;t+=.3;a=a+" L "+(g+I*D+A*H)+","+(p+I*F+A*J)}return a}getPortalMask(a,g){return"E"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x}"
        y="${10*a.y-.2}"
        width="3"
        height="10.4"
        fill="${g}"
      />`:"W"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x+7}"
        y="${10*a.y-.2}"
        width="3"
        height="10.4"
        fill="${g}"
      />`:"N"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x-.2}"
        y="${10*a.y+7}"
        width="10.4"
        height="3"
        fill="${g}"
      />`:"S"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x-.2}"
        y="${10*a.y}"
        width="10.4"
        height="3"
        fill="${g}"
      />`:html$$module$dungeonmap``}get_path(a){const g=10*a.x,p=g+10*a.w,t=10*a.y,A=t+10*a.h;return"M "+g+","+t+this.make_line(a,g,t,p,t,0,-1)+this.make_line(a,p,t,p,A,1,0)+this.make_line(a,p,A,g,A,0,1)+this.make_line(a,g,A,g,t,-1,0)+" Z"}render(a,g){g=a.vbx-0;var p=a.vby-0,t=a.vby+a.vbh+0;if(!(a.x*kScaleMultiplier$$module$dungeonmap>a.vbx+a.vbw+0||a.y*kScaleMultiplier$$module$dungeonmap>t||a.x*kScaleMultiplier$$module$dungeonmap+a.w*kScaleMultiplier$$module$dungeonmap<g||a.y*kScaleMultiplier$$module$dungeonmap+
a.h*kScaleMultiplier$$module$dungeonmap<p)){g=getAreaMaskFillColor$$module$dungeonmap(a);p=html$$module$dungeonmap`<rect
      x="${10*a.x+.25}"
      y="${10*a.y+.25}"
      width="${10*a.w}"
      height="${10*a.h}"
      fill="${g}"
    />`;3==a.lod&&(p=html$$module$dungeonmap`<path d="${this.get_path(a)}" fill="${g}" />`);t=[];if(a.portals)for(const A of a.portals)0==A.type&&t.push(this.getPortalMask(A,g));return html$$module$dungeonmap`<g
      >${p}
      <${(a.reveal||!a.vtt)&&DungeonPillars$$module$dungeonmap}
        x=${a.x}
        y=${a.y}
        w=${a.w}
        h=${a.h}
      />
      ${t.map(A=>A)}
    </g>`}}}const vals$$module$dungeonmap=[{x:-1,y:0,r:.3},{x:-1,y:1,r:.6},{x:1,y:2,r:.2},{x:0,y:1,r:.4},{x:0,y:0,r:1},{x:1,y:2,r:.2},{x:-1,y:-1,r:.5},{x:0,y:0,r:.8},{x:2,y:1,r:.2},{x:0,y:0,r:.6},{x:0,y:0,r:1.3},{x:1,y:0,r:.9}];function DungeonCavernStains$$module$dungeonmap(a){let g=0;return html$$module$dungeonmap`
    ${a.polygon.map(p=>{let t=[];t.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;t.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;t.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;t.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;if(1==p.c&&1==Math.floor(Math.abs(p.x))%3)return html$$module$dungeonmap`${t.map(A=>html$$module$dungeonmap`<circle
            cx="${p.x+A.x}"
            cy="${p.y+A.y}"
            r="${A.r}"
            fill="#212121"
          />`)}`})}
  `}class DungeonAreaLink$$module$dungeonmap extends DungeonLink$$module$dungeonmap{render(a,g){g=a.vbx-0;const p=a.vby-0,t=a.vby+a.vbh+0;if(!(a.x*kScaleMultiplier$$module$dungeonmap>a.vbx+a.vbw+0||a.y*kScaleMultiplier$$module$dungeonmap>t||a.x*kScaleMultiplier$$module$dungeonmap+a.w*kScaleMultiplier$$module$dungeonmap<g||a.y*kScaleMultiplier$$module$dungeonmap+a.h*kScaleMultiplier$$module$dungeonmap<p))return g=html$$module$dungeonmap``,0!=a.t&&(g=html$$module$dungeonmap`
        <g
          transform="translate(${10*a.x+10*a.w/2} ${10*a.y+10*a.h/2+2})"
        >
          <text
            transform="rotate(0)"
            class="dcoords"
            alignment-baseline="baseline"
            text-anchor="middle"
            >${a.n}</text
          >
        </g>
      `),html$$module$dungeonmap`<a onClick=${A=>this.clicked(a.uuid,A)}
      ><rect
        x="${10*a.x}"
        y="${10*a.y}"
        width="${10*a.w}"
        height="${10*a.h}"
        fill="transparent"
      />
      ${g}
    </a>`}}function DungeonCaveMap$$module$dungeonmap(a){return html$$module$dungeonmap`
    <g transform="scale(${kScale$$module$dungeonmap}) rotate(0)">
      <g>
        <mask id="FilterMask">
          <rect
            x="-1000"
            y="-1000"
            width="2000"
            height="2000"
            filter="url(#noise)"
          />
        </mask>
        <${a.vtt&&TorchMask$$module$dungeonmap} uuid=${a.uuid} />
        <mask id="AreasMask${a.uuid}">
          <g mask="url(#LightMask${a.uuid})">
            ${a.dungeon.caverns.map(g=>html$$module$dungeonmap`<${DungeonCavern$$module$dungeonmap}
                lod="${a.lod}"
                reveal="${g.reveal}"
                polygon="${g.polygon}"
                offset=${a.offset}
                dim=${a.dim}
                vtt=${a.vtt}
              />`)}
          </g>
        </mask>
      </g>
      <!--g mask="url(#AreasMask)"-->
      <g mask="url(#AreasMask${a.uuid})">
        <rect x="-1000" y="-1000" width="2000" height="2000" fill="#d5d1ce" />
        <g>
          <rect
            class="cgrid"
            x="-1000"
            y="-1000"
            width="2000"
            height="2000"
            mask="url(#FilterMask)"
            fill="url(#grid)"
          />
        </g>
      </g>
      <g>
        ${a.dungeon.caverns.map(g=>html$$module$dungeonmap`<${DungeonCavernStains$$module$dungeonmap} polygon="${g.polygon}" />`)}
      </g>
      <g>
        ${a.vtt||a.dungeon.caverns.map(g=>html$$module$dungeonmap`<${DungeonCavernLink$$module$dungeonmap}
            onClick=${a.onClick}
            onToken=${a.onToken}
            uuid=${g.uuid}
            coords=${g.center}
            number=${g.n}
            lod="${a.lod}"
            polygon="${g.polygon}"
            offset=${a.offset}
            dim=${a.dim}
          />`)}
      </g>

      <g>
        ${a.vtt||a.dungeon.points.map(g=>html$$module$dungeonmap`<rect
            x=${g.x-3}
            y=${g.y-3}
            width="6"
            height="6"
            fill="#ff0000"
          />`)}
      </g>
    </g>
  `}function DungeonStructureMap$$module$dungeonmap(a){return html$$module$dungeonmap` <g transform="scale(${kScale$$module$dungeonmap}) rotate(0)">
    <g>
      <mask id="FilterMask">
        <rect
          x="-1000"
          y="-1000"
          width="2000"
          height="2000"
          filter="url(#noise)"
        />
      </mask>
      <${a.vtt&&TorchMask$$module$dungeonmap} uuid=${a.uuid} />
      <mask id="AreasMask${a.uuid}">
        <g mask="url(#LightMask${a.uuid})">
          ${a.dungeon.areas.map(g=>html$$module$dungeonmap`<${DungeonArea$$module$dungeonmap}
              lod="${a.lod}"
              x="${g.x}"
              y="${g.y}"
              w="${g.w}"
              h="${g.h}"
              portals="${g.portals}"
              passages="${g.passages}"
              reveal="${g.reveal}"
              vbx=${a.offset.x}
              vby=${a.offset.y}
              vbw=${a.dim.w}
              vbh=${a.dim.h}
              vtt=${a.vtt}
            />`)}
        </g>
      </mask>
    </g>
    <!--g mask="url(#AreasMask)"-->
    <g mask="url(#AreasMask${a.uuid})">
      <rect x="-1000" y="-1000" width="2000" height="2000" fill="#d5d1ce" />
      <g>
        <rect
          class="cgrid"
          x="-1000"
          y="-1000"
          width="2000"
          height="2000"
          mask="url(#FilterMask)"
          fill="url(#grid)"
        />
        ${a.details}
        ${a.dungeon.stairs.map(g=>html$$module$dungeonmap`<${DungeonEntrance$$module$dungeonmap}
            lod="${a.lod}"
            x="${g.x}"
            y="${g.y}"
            dir="${g.d}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
          />`)}
      </g>
      <g>
        ${a.vtt||a.dungeon.areas.map(g=>html$$module$dungeonmap`<${DungeonAreaLink$$module$dungeonmap}
            onClick=${a.onClick}
            onToken=${a.onToken}
            lod="${a.lod}"
            x="${g.x}"
            y="${g.y}"
            w="${g.w}"
            h="${g.h}"
            t="${g.t}"
            n="${g.n}"
            duuid="${a.uuid}"
            uuid="${g.uuid}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
          />`)}
      </g>
      <g>
        ${a.dungeon.portals.map(g=>html$$module$dungeonmap`<${DungeonPortal$$module$dungeonmap}
            lod="${a.lod}"
            x="${g.x}"
            y="${g.y}"
            wall="${g.wall}"
            type="${g.type}"
            uuid="${g.uuid}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
            vtt=${a.vtt}
          />`)}
      </g>
    </g>
  </g>`}
class DungeonMap$$module$dungeonmap extends k$$module$libs$preact{constructor(){super();this.areaClicked=this.areaClicked.bind(this);this.cavernClicked=this.cavernClicked.bind(this);this.loaded=!1;this.setState({show:!0,dungeon:{areas:[{x:10,y:10,w:50,h:50},{x:60,y:10,w:50,h:50},{x:10,y:70,w:50,h:50},{x:10,y:100,w:50,h:50},{x:200,y:20,w:50,h:50},{x:210,y:210,w:50,h:50}],portals:[]}});this.corners=[];this.uuid_to_coords={}}componentDidUpdate(a,g,p){this.props.uuid!=a.uuid&&this.request_map_data(this.props.hex)}setRevealByPeers(a){window.app.yarray.get(a.uuid)&&"reveal"==
window.app.yarray.get(a.uuid)[0]&&(a.reveal=!0)}processStructureData(a){function g(t,A,D,F){let K=!1;for(let H of F.areas)if(H!=t&&(A>=H.x&&A<=H.x+H.w&&D==H.y||A>=H.x&&A<=H.x+H.w&&D==H.y+H.h||D>=H.y&&D<=H.y+H.h&&A==H.x||D>=H.y&&D<=H.y+H.h&&A==H.x+H.w)){K=!0;break}return!K}this.corners=[];this.uuid_to_coords={};let p=0;a.stairs=[];a.portals=[];for(let t of a.areas){t.portals&&(a.portals=a.portals.concat(t.portals));void 0===t.uuid&&(t.uuid=p++);t.e&&a.stairs.push(t.e);this.setRevealByPeers(t);this.uuid_to_coords[t.uuid]=
[10*t.x+10*t.w/2,10*t.y+10*t.h/2];if(g(t,t.x,t.y,a)){const A=t.x,D=t.y;this.corners.push({x:A,y:D,d:`M ${10*A}, ${10*D} L
              ${10*(A+1)}, ${10*D} C
              ${10*A+2},${10*D+2}
              ${10*A+2},${10*D+2} ${10*A},
              ${10*(D+1)} Z`,culler:function(F,K,H,J){return A*kScaleMultiplier$$module$dungeonmap>H||D*kScaleMultiplier$$module$dungeonmap>J||(A+1)*kScaleMultiplier$$module$dungeonmap<F||(D+1)*kScaleMultiplier$$module$dungeonmap<K}})}if(g(t,t.x+t.w,t.y,a)){const A=t.x+t.w,D=t.y;this.corners.push({x:A,y:D,d:`M ${10*A}, ${10*D} L
              ${10*(A-1)}, ${10*D} C
              ${10*A-2},${10*D+2}
              ${10*A-2},${10*D+2} ${10*A},
              ${10*(D+1)} Z`,culler:function(F,K,H,J){return(A-1)*kScaleMultiplier$$module$dungeonmap>H||D*kScaleMultiplier$$module$dungeonmap>J||A*kScaleMultiplier$$module$dungeonmap<F||(D+1)*kScaleMultiplier$$module$dungeonmap<K}})}if(g(t,t.x+t.w,t.y+t.h,a)){const A=t.x+t.w,D=t.y+t.h;this.corners.push({x:A,y:D,d:`M ${10*A}, ${10*D} L
              ${10*(A-1)}, ${10*D} C
              ${10*A-2},${10*D-2}
              ${10*A-2},${10*D-2} ${10*A},
              ${10*(D-1)} Z`,culler:function(F,K,H,J){return(A-1)*kScaleMultiplier$$module$dungeonmap>H||(D-1)*kScaleMultiplier$$module$dungeonmap>J||A*kScaleMultiplier$$module$dungeonmap<F||D*kScaleMultiplier$$module$dungeonmap<K}})}if(g(t,t.x,t.y+t.h,a)){const A=t.x,D=t.y+t.h;this.corners.push({x:A,y:D,d:`M ${10*A}, ${10*D} L
              ${10*(A+1)}, ${10*D} C
              ${10*A+2},${10*D-2}
              ${10*A+2},${10*D-2} ${10*A},
              ${10*(D-1)} Z`,culler:function(F,K,H,J){return A*kScaleMultiplier$$module$dungeonmap>H||(D-1)*kScaleMultiplier$$module$dungeonmap>J||(A+1)*kScaleMultiplier$$module$dungeonmap<F||D*kScaleMultiplier$$module$dungeonmap<K}})}}this.setState({dungeon:a});this.loaded=!0}pointsToCoords(a){let g=[];for(let p=0;p<a.length;p++)g.push([a[p].x,a[p].y]);return g}processCaveData(a){a.points=[];this.uuid_to_coords={};let g=0;for(var p of a.caverns){var t=p.polygon;t.push(t[0]);turf.polygon([this.pointsToCoords(t)]);
t=polylabel$$module$libs$polylabel([this.pointsToCoords(t)],1);p.center=t;this.uuid_to_coords[p.uuid]=t;this.setRevealByPeers(p);for(t=0;t<p.polygon.length;t++){var A=p.polygon[t];if(1<A.c)continue;let D=p.polygon[0==t?p.polygon.length-1:t-1],F=p.polygon[t==p.polygon.length-1?0:t+1];p.polygon[t]={x:(A.x+(D.x+F.x)/2)/2,y:(A.y+(D.y+F.y)/2)/2};p.polygon[t].c=A.c}}p=[-1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,1];t=0;for(let D of a.caverns)for(A=0;A<D.polygon.length;A++)1==D.polygon[A].c&&
(g+=.1,D.polygon[A].x+=2*noise$$module$libs$perlin(g)*p[t],t=t==p.length-1?0:t+1,g+=.1,D.polygon[A].y+=2*noise$$module$libs$perlin(g)*p[t],t=t==p.length-1?0:t+1);this.setState({dungeon:a});this.loaded=!0}async request_map_data(a){api_call_dungeon$$module$api_shim(this.props.instance,a).then(g=>{void 0!==g.caverns?this.processCaveData(g):this.processStructureData(g)})}endSyncWithPeers(){window.app.yarray.unobserve(this.yarr_observer);window.app.zarray.unobserve(this.zarr_observer)}setLocalToken(a,
g){window.app.tokens[this.props.uuid].set(a,new Token$$module$dungeonmap(this.props.uuid,a,g.x,g.y,g.r,5*kScale$$module$dungeonmap,5*kScale$$module$dungeonmap,this.props.zoff,g.t,g.l,g.pc))}syncDungeonAreas(a,g){if(a)for(let p of a)g.keysChanged.has(p.uuid)&&window.app.yarray.get(p.uuid)&&("reveal"==window.app.yarray.get(p.uuid)[0]?p.reveal=!0:p.reveal=!1)}beginSyncWithPeers(){let a=this;window.app.zarray.observe(this.zarr_observer=g=>{for(const p of g.keysChanged)window.app.zarray.has(p)?(g=window.app.zarray.get(p),
g.d==this.props.uuid&&(this.setLocalToken(p,g),a.forceUpdate())):(window.app.tokens[this.props.uuid].delete(p),window.app.selected_token&&window.app.selected_token.tuid==p&&(window.app.selected_token=null),a.forceUpdate())});window.app.yarray.observe(this.yarr_observer=g=>{this.syncDungeonAreas(a.state.dungeon.caverns||a.state.dungeon.areas,g);a.forceUpdate()})}addToken(a,g){window.app.map.showTokenChooser(p=>{window.app.ydoc.transact(()=>{const t=uuidv4$$module$utils();window.app.zarray.set(t,{u:t,
t:p.id,x:g.x-this.props.zoff.x,y:g.y-this.props.zoff.y,r:0,l:p.light,pc:p.pc,d:this.props.uuid})})})}componentDidMount(a,g,p){this.request_map_data(this.props.hex);let t=this;window.app.reroll_handlers.set("dungeon",async function(){await t.request_map_data(t.props.hex)});window.app.tokens[this.props.uuid]=new Map;this.beginSyncWithPeers();for(const [A,D]of window.app.zarray)D.d==this.props.uuid&&this.setLocalToken(A,D)}componentWillUnmount(){window.app.reroll_handlers.delete("dungeon");this.endSyncWithPeers()}updatePeerOnReveal(a,
g){window.app.yarray.set(a,[g?"reveal":""])}clickHandler(a,g,p){let t=this.state.dungeon;if(!window.app.vtt_referee||p)for(let A of a)A.uuid===g&&(A.reveal=!A.reveal,this.updatePeerOnReveal(A.uuid,A.reveal));this.setState({dungeon:t});p||this.uuid_to_coords[g]&&$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/location/"+g)}areaClicked(a,g=!1){this.clickHandler(this.state.dungeon.areas,a,g)}cavernClicked(a,g=!1){this.clickHandler(this.state.dungeon.caverns,a,g)}render(a,g){if(0==
this.loaded)return html$$module$dungeonmap`
        <polygon
          points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
          stroke="#ff0000"
          stroke-width="0"
          fill="#232121"
          style="stroke-width:0.2;"
        />
      `;let p=3;5E4>a.zoom_factor&&(p=2);let t=html$$module$dungeonmap``;const A=a.offset.x-0,D=a.offset.y-0,F=a.offset.x+a.dim.w+0,K=a.offset.y+a.dim.h+0;if(1<p){let H="";3==p&&(H="filter: url(#displacementFilter)");t=html$$module$dungeonmap`<g opacity="0.3"
        >${this.corners.map(J=>{if(!J.culler(A,D,F,K))return html$$module$dungeonmap` <circle
            cx="${10*J.x}"
            cy="${10*J.y}"
            r="7"
            fill="#444444"
            style="${H}"
          />`,html$$module$dungeonmap` <path d="${J.d}" fill="#444444" style="${H}" />`})}
      </g>`}noiseSeed$$module$libs$perlin(10);g=void 0!==g.dungeon.caverns?html$$module$dungeonmap`<${DungeonCaveMap$$module$dungeonmap}
            dungeon=${g.dungeon}
            onClick=${this.cavernClicked}
            onToken=${(H,J)=>this.addToken(H,J)}
            details=${t}
            uuid=${a.uuid}
            lod=${p}
            offset=${a.offset}
            dim=${a.dim}
            vtt=${a.vtt}
          />`:html$$module$dungeonmap`<${DungeonStructureMap$$module$dungeonmap}
            dungeon=${g.dungeon}
            onClick=${this.areaClicked}
            onToken=${(H,J)=>this.addToken(H,J)}
            details=${t}
            uuid=${a.uuid}
            lod=${p}
            offset=${a.offset}
            dim=${a.dim}
            vtt=${a.vtt}
          />`;return html$$module$dungeonmap`
      <defs>
        <defs>
          <radialGradient id="TorchGradient${a.uuid}">
            <stop offset="10%" stop-color="#ffffffff" />
            <stop offset="30%" stop-color="#ffffffff" />
            <stop offset="95%" stop-color="#ffffff00" />
          </radialGradient>
        </defs>
        <pattern
          id="smallGrid"
          width="5"
          height="5"
          patternUnits="userSpaceOnUse"
        >
          <path
            d="M 5 0 L 0 0 0 5"
            fill="none"
            stroke="#86817c"
            stroke-width="0.2"
          />
        </pattern>
        <pattern
          id="grid"
          overflow="visible"
          width="10"
          height="10"
          patternUnits="userSpaceOnUse"
        >
          <rect width="10" height="10" fill="url(#smallGrid)" />
          <path
            d="M 10 0 L 0 0 0 10"
            fill="none"
            stroke="#86817c"
            stroke-width="1"
          />
        </pattern>
      </defs>
      <style>
        .cgrid {
          //filter: contrast(2.3);
        }
        .dcoords {
          font-size: 0.3em;
          font-family: 'Lakki Reddy';
          font-weight: bolder;
          paint-order: stroke;
          pointer-events: none;
          fill: #ddd;
          stroke: #333;
          stroke-width: 3px;
          stroke-linejoin: round;
        }
      </style>
      <filter id="noise" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence
          type="fractalNoise"
          baseFrequency="0.25"
          numOctaves="10"
          seed="15"
          stitchTiles="stitch"
          result="turbulence"
        ></feTurbulence>
        <feComponentTransfer>
          <feFuncR type="discrete" tableValues="0 0 1 1" />
          <feFuncG type="discrete" tableValues="2 2 0 0" />
          <feFuncB type="discrete" tableValues="0 0 1 1" />
        </feComponentTransfer>
      </filter>
      <filter id="displacementFilter">
        <feTurbulence
          type="turbulence"
          baseFrequency="0.5"
          numOctaves="10"
          result="turbulence"
        />
        <feDisplacementMap
          in2="turbulence"
          in="SourceGraphic"
          scale="5"
          xChannelSelector="R"
          yChannelSelector="G"
        />
      </filter>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#ff0000"
        stroke-width="0"
        fill="#232121"
        style="stroke-width:0.2;"
      />
      ${g}
      <g transform="scale(1.0) rotate(0)">
        ${Array.from(window.app.tokens[a.uuid]).map(([,H])=>html$$module$dungeonmap`
            <g
              onmouseenter=${()=>{if(window.app.vtt_referee||H.pc)window.app.selected_token={tuid:H.tuid,uuid:H.uuid}}}
              onmouseleave=${()=>{window.app.selected_token.tuid&&window.app.selected_token.tuid==H.tuid&&(window.app.selected_token=null)}}
              onclick=${()=>window.app.kill_mode&&window.app.zarray.delete(H.tuid)}
              transform="translate(${H.x},${H.y}) scale(0.006) rotate(${H.r})"
              fill="#232121"
              stroke=${H.pc||!a.vtt?"#fff":"none"}
              stroke-width="0.1"
              stroke-linejoin="round"
            >
              <circle cx="0" cy="0" r="5" opacity="0" />
              <use xlink:href="${window.app.tokens_svg}#${H.tid}" />
            </g>
          `)}
      </g>
    `}}var module$dungeonmap={};module$dungeonmap.DungeonMap=DungeonMap$$module$dungeonmap;const html$$module$hex=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function clamp$$module$hex(a,g,p){return Math.min(Math.max(a,g),p)}function getOffset$$module$hex(a,g,p=0,t=0){return[30*a+Math.abs(g)%2*15-p,10.4*g*Math.cos(Math.PI/6)-t]}function getHexCoords$$module$hex(a,g){g/=10.4*Math.cos(Math.PI/6);return[Math.floor(a/30+Math.abs(g)%2),Math.floor(g)]}
function intersects$$module$hex(a,g,p,t,A,D){a=Math.abs(a-(p+A/2));g=Math.abs(g-(t+D/2));return a>A/2+9||g>D/2+9?!1:a<=A/2||g<=D/2?!0:81>=(a-A/2)**2+(g-D/2)**2}class Borderline$$module$hex extends k$$module$libs$preact{constructor(a){super();this.cls="borderline_fixed"}render(a,g){"borderline"==this.cls?this.cls="borderline_fixed":"continent"==this.cls&&(this.cls="borderline");.5>a.zoom_factor&&(this.cls="continent");return html$$module$hex` <g
      ><polygon
        class="${this.cls}"
        strokeWidth="${.15*a.arm}"
        strokeLinecap="round"
        fill="transparent"
        color="#ff0000"
        stroke="${a.color}"
        points="${a.borders}"
      />
    </g>`}}function makeHex$$module$hex(a){const g=20.8*Math.cos(Math.PI/6),p=a[0]-10;a=a[1]-g/2+.16;return[[5+.1/Math.sqrt(3)+p,.1+a],[15-.1/Math.sqrt(3)+p,.1+a],[20-2/Math.sqrt(3)*.1+p,.5*g+a],[15-.1/Math.sqrt(3)+p,g-.1+a],[5+.1/Math.sqrt(3)+p,g-.1+a],[2/Math.sqrt(3)*.1+p,.5*g+a]].join()}function HexRiver$$module$hex(a){return 20<a.zoom_factor?html$$module$hex`
        <g opacity="${1-a.opacity}">
          <path
            d="${a.riverline}"
            stroke="#1166aa"
            xstroke="#333333"
            stroke-width="2.25"
            fill="none"
          />
          <path
            d="${a.riverline}"
            stroke="#3399cc"
            stroke-width="1.75"
            stroke-dasharray="4 1 2 3 1 3 2 6 4 3 5 6 7 3 2 1 7 6 4 5 6 3 5 4 1 2 3 4"
            stroke-dashoffset="3"
            fill="none"
          >
            <animate
              id="p1"
              attributeName="stroke-dashoffset"
              begin="0.1s;f1.end+0.4s"
              values="2037;0"
              dur="1015s"
              calcMode="linear"
              repeatCount="indefinite"
            />
          </path>
          <path
            d="${a.riverline}"
            stroke="#1166aa"
            xstroke="#333333"
            stroke-width="1.5"
            fill="none"
          />
        </g>
      `:html$$module$hex` <g opacity="${1-a.opacity}">
        <path
          d="${a.riverline}"
          stroke="#1166aa"
          xstroke="#333333"
          stroke-width="2.25"
          fill="none"
        />
      </g>`}function HexTrail$$module$hex(a){return html$$module$hex` <g opacity="${1-a.opacity}">
    ${a.trailslines.map(g=>html$$module$hex`
        <path
          d="${g}"
          stroke="#22222255"
          stroke-width="1"
          stroke-linecap="round"
          stroke-dasharray="0 2"
          fill="none"
        />
      `)}
  </g>`}class BaseHex$$module$hex extends k$$module$libs$preact{getOffset(a=0,g=0){return getOffset$$module$hex(this.props.nx,this.props.ny,a,g)}getTranslation(a){return"translate("+a[0].toString()+", "+a[1].toString()+")"}}
class VttHex$$module$hex extends BaseHex$$module$hex{render(a){var g=getOffset$$module$hex(a.nx,a.ny);if(!(g[0]<this.props.ox-20||g[1]<this.props.oy-20||g[0]>this.props.ox+this.props.dimw+20||g[1]>this.props.oy+this.props.dimh+20)){this.t_poly=this.getTranslation(g);var p=clamp$$module$hex(a.zoom_factor/5E3,0,1),t=clamp$$module$hex((a.zoom_factor-2500)/5E3,0,1),A="empty-"==this.props.res?html$$module$hex``:html$$module$hex` <g opacity="${1-p}"
            ><use
              xlink:href="${window.app.theme}#${this.props.res}${a.pod}"
              fill="${this.props.color}"
              transform="${this.t_poly}"
            />
          </g>`,D=1E3<a.zoom_factor?intersects$$module$hex(g[0],g[1],a.ox,a.oy,a.dimw,a.dimh):!1;g="Dungeon"==a.feature&&1E3<a.zoom_factor&&D?html$$module$hex` <g opacity="${t}" transform="${this.t_poly}">
            <${DungeonMap$$module$dungeonmap}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              offset=${({x:a.ox-g[0],y:a.oy-g[1]})}
              zoff=${({x:g[0],y:g[1]})}
              dim=${({w:a.dimw,h:a.dimh})}
              zoom_factor=${a.zoom_factor}
              vtt="true"
              tokens=${a.tokens}
            />
          </g>`:html$$module$hex``;return a.revealed&&""!=a.revealed?html$$module$hex` <use
            xlink:href="${window.app.theme}#empty-${a.pod}"
            fill="${this.props.color}"
            transform="${this.t_poly}"
          />
          <${a.riverline&&HexRiver$$module$hex}
            riverline=${a.riverline}
            zoom_factor=${a.zoom_factor}
            opacity=${p}
          />
          ${A}
          <${a.trailslines&&"partial"!=a.revealed&&HexTrail$$module$hex}
            trailslines=${a.trailslines}
            opacity=${p}
          />
          >${g}`:html$$module$hex``}}}
class Hex$$module$hex extends BaseHex$$module$hex{clicked(a){a.preventDefault();window.app.inhibit_click?window.app.inhibit_click=!1:(this.props.menuHandler.onHexClicked(this.props.nx,this.props.ny,this.props.uuid,this.props.type,this),this.setState({class:"selected"}),window.app.last_selected&&window.app.last_selected.setState({class:"baseout"}),window.app.last_selected=this)}render(a){var g=getOffset$$module$hex(a.nx,a.ny);if(!(.5>a.zoom_factor||g[0]<this.props.ox-20||g[1]<this.props.oy-20||g[0]>
this.props.ox+this.props.dimw+20||g[1]>this.props.oy+this.props.dimh+20)){this.t_poly=this.getTranslation(g);var p=clamp$$module$hex(a.zoom_factor/5E3,0,1),t=clamp$$module$hex((a.zoom_factor-2500)/5E3,0,1),A="empty-"==this.props.res||html$$module$hex` <g opacity="${1-p}"
        ><use
          xlink:href="${window.app.theme}#${this.props.res}${a.type}"
          fill="${this.props.color}"
          transform="${this.t_poly}"
        />
      </g>`,D=1E3<a.zoom_factor&&intersects$$module$hex(g[0],g[1],a.ox,a.oy,a.dimw,a.dimh),F="City"!=a.feature&&"Town"!=a.feature||!D?"Village"==a.feature&&D?html$$module$hex` <g opacity="${p}" transform="${this.t_poly}">
            <${VillageMap$$module$villagemap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
            />
          </g>`:html$$module$hex``:html$$module$hex` <g opacity="${p}" transform="${this.t_poly}">
            <${CityMap$$module$citymap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
            />
          </g>`;g="Dungeon"==a.feature&&1E3<a.zoom_factor&&D&&html$$module$hex` <g opacity="${t}" transform="${this.t_poly}">
        <${DungeonMap$$module$dungeonmap}
          instance=${a.instance}
          hex=${a.uuid}
          uuid=${a.feature_uuid}
          offset=${({x:a.ox-g[0],y:a.oy-g[1]})}
          zoff=${({x:g[0],y:g[1]})}
          dim=${({w:a.dimw,h:a.dimh})}
          zoom_factor=${a.zoom_factor}
          tokens=${a.tokens}
        />
      </g>`;return html$$module$hex`<a onClick=${K=>this.clicked(K)}>
        <use
          xlink:href="${window.app.theme}#empty-${a.type}"
          fill="#000"
          transform="${this.t_poly}"
        />

        <${a.riverline&&HexRiver$$module$hex}
          riverline=${a.riverline}
          zoom_factor=${a.zoom_factor}
          opacity=${p}
        />
        ${A}
        <${a.trailslines&&HexTrail$$module$hex}
          trailslines=${a.trailslines}
          opacity=${p}
        />
      </a>
      ${F}${g}`}}}
class BaseHexMask$$module$hex extends k$$module$libs$preact{getOffset(a=0,g=0){return getOffset$$module$hex(this.props.nx,this.props.ny,a,g)}getTranslation(a){return"translate("+a[0].toString()+", "+a[1].toString()+")"}clicked(a){a.preventDefault();if(window.app.inhibit_click)window.app.inhibit_click=!1;else if(a=this.props.uuid,this.props.flag_mode)this.props.menuHandler.onHexClicked(this.props.nx,this.props.ny,this.props.uuid,this.props.type,this);else{var g=window.app.yarray.get(a)&&"partial"==
window.app.yarray.get(a)[0],p=window.app.yarray.get(a)&&"reveal"==window.app.yarray.get(a)[0];window.app.ctrl_mode&&window.app.yarray.set(a,[p?"":g?"reveal":"partial"]);this.forceUpdate()}}}
class HexMask$$module$hex extends BaseHexMask$$module$hex{render(a){var g=getOffset$$module$hex(a.nx,a.ny);if(!(.5>a.zoom_factor||g[0]<this.props.ox-20||g[1]<this.props.oy-20||g[0]>this.props.ox+this.props.dimw+20||g[1]>this.props.oy+this.props.dimh+20))return this.t_poly=this.getTranslation(g),g=window.app.yarray.get(a.uuid),html$$module$hex`
      <a
        style=${a.flag_mode&&"pointer-events: none;"}
        id="${a.uuid}_hex_mask"
        onClick=${p=>this.clicked(p)}
      >
        <use
          xlink:href="${window.app.theme}#${g&&"partial"==g[0]?"empty-partial-mask":g&&""!=g?"empty-no-mask":"empty-mask"}"
          transform="${this.t_poly}"
        />
      </a>
    `}}class SeaHexMask$$module$hex extends BaseHexMask$$module$hex{render(a){var g=getOffset$$module$hex(a.nx,a.ny,0,0);g="translate("+g[0].toString()+", "+g[1].toString()+")";a=window.app.yarray.get(a.uuid);return html$$module$hex`
      <a style=${""} onClick=${p=>this.clicked(p)}>
        <use xlink:href="${window.app.theme}#${a&&"reveal"==a[0]?"ocean-revealed":a&&"partial"==a[0]?"ocean-masked-partial":"ocean-masked"}" transform="${g}" />
      </a>
    `}}class VttSeaHex$$module$hex extends BaseHex$$module$hex{render(a){const g=getOffset$$module$hex(a.nx,a.ny);if(!(g[0]<this.props.ox-20||g[1]<this.props.oy-20||g[0]>this.props.ox+this.props.dimw+20||g[1]>this.props.oy+this.props.dimh+20))return this.t_poly=this.getTranslation(g),(a=window.app.yarray.get(a.uuid))&&""!=a&&html$$module$hex`
        <use
          xlink:href="${window.app.theme}#ocean"
          transform="${this.t_poly}"
        />
      `}}function sea_clicked$$module$hex(a,g){a.preventDefault();if(window.app.inhibit_click)window.app.inhibit_click=!1;else g.menuHandler.onHexClicked(g.nx,g.ny,g.uuid,g.type,null)}function SeaHex$$module$hex(a){const g=getOffset$$module$hex(a.nx,a.ny,0,0);return html$$module$hex`
    <a onClick=${p=>sea_clicked$$module$hex(p,a)}>
      <use xlink:href="${window.app.theme}#ocean" transform="${"translate("+g[0].toString()+", "+g[1].toString()+")"}" />
    </a>
  `}var module$hex={};module$hex.BaseHex=BaseHex$$module$hex;module$hex.Borderline=Borderline$$module$hex;module$hex.Hex=Hex$$module$hex;module$hex.HexMask=HexMask$$module$hex;module$hex.SeaHex=SeaHex$$module$hex;module$hex.SeaHexMask=SeaHexMask$$module$hex;module$hex.VttHex=VttHex$$module$hex;module$hex.VttSeaHex=VttSeaHex$$module$hex;module$hex.getHexCoords=getHexCoords$$module$hex;module$hex.getOffset=getOffset$$module$hex;module$hex.makeHex=makeHex$$module$hex;function makeRealmPolygon$$module$api(a){function g(K,H,J){A.push([{x:H[0]+K[0],y:H[1]+K[1]},{x:J[0]+K[0],y:J[1]+K[1]}])}function p(K){return Math.floor(K/3).toFixed(15)}var t=20.8*Math.cos(Math.PI/6);let A=[];for(var D of a){a=getOffset$$module$hex(D.hex_x,D.hex_y,10,7.5*1.04);for(var F of D.borders)0==F&&g(a,[5+.1/Math.sqrt(3),.1],[15-.1/Math.sqrt(3),.1]),1==F&&g(a,[15-.1/Math.sqrt(3),.1],[20-2/Math.sqrt(3)*.1,.5*t]),2==F&&g(a,[20-2/Math.sqrt(3)*.1,.5*t],[15-.1/Math.sqrt(3),t-.1]),3==F&&g(a,[15-
.1/Math.sqrt(3),t-.1],[5+.1/Math.sqrt(3),t-.1]),4==F&&g(a,[5+.1/Math.sqrt(3),t-.1],[2/Math.sqrt(3)*.1,.5*t]),5==F&&g(a,[2/Math.sqrt(3)*.1,.5*t],[5+.1/Math.sqrt(3),.1])}t=[];D=A[0][1];F=0;for(t.push({x:D.x,y:D.y});;){A.splice(F,1);if(0==A.length)break;F=0;for(a=0;a<A.length;a++){const K=A[a];if(p(K[0].x)===p(D.x)&&p(K[0].y)===p(D.y)){t.push({x:K[1].x,y:K[1].y});D=K[1];break}if(p(K[1].x)===p(D.x)&&p(K[1].y)===p(D.y)){t.push({x:K[0].x,y:K[0].y});D=K[0];break}F++}if(F==A.length)return console.log("ERROR"),
[]}return t}function makeWall$$module$api(a){let g="";a.forEach(function(p){g=g+p.x+","+(p.y-1)+" "});return g}function makeRealmLabel$$module$api(a,g){if(0<g.length){const p=get_polygon_centroid$$module$utils(g);g=get_polygon_area$$module$utils(g);return[a.name.split(/[ ]/),p,clamp$$module$utils(1E-5*g,1,2)]}return[[],{x:0,y:0},2]}
function RiverLine$$module$api(a,g,p){function t(F,K,H){D.push([{x:K[0]+F[0],y:K[1]+F[1]},{x:H[0]+F[0],y:H[1]+F[1]}])}const A=20.8*Math.cos(Math.PI/6);let D=[];a=getOffset$$module$hex(a,g,10,10.4*Math.cos(Math.PI/6));g=[10+.1/Math.sqrt(3),.5*A];for(const F of p)0==F&&t(a,[10+.1/Math.sqrt(3),.1],g),1==F&&t(a,[17.5-.1/Math.sqrt(3),.25*A],g),2==F&&t(a,[17.5-.1/Math.sqrt(3),.75*A],g),3==F&&t(a,[10+.1/Math.sqrt(3),A-.1],g),4==F&&t(a,[2.5+.1/Math.sqrt(3),.75*A],g),5==F&&t(a,[2.5+.1/Math.sqrt(3),.25*A],
g);p="";if(1==D.length)for(const F of D)p=p+"M "+F[1].x+" "+F[1].y+" L "+F[0].x+" "+F[0].y+" ";2==D.length&&(p=p+"M "+D[0][0].x+" "+D[0][0].y+" C "+D[0][1].x+" "+D[0][1].y+","+D[0][1].x+" "+D[0][1].y+","+D[1][0].x+" "+D[1][0].y+" ");return p}
function convertHexType$$module$api(a,g=!1){let p=a.type;"empty"!=a.type&&(p="DesertHex"==a.type?"desert":"PlainsHex"==a.type?"plains":"TundraHex"==a.type?"tundra":"JungleHex"==a.type?"jungle":"SwampsHex"==a.type?"swamps":"CoastHex"==a.type?"coast":"OceanHex"==a.type?"ocean":"ForestHex"==a.type?3<a.x%3+a.y%4&&void 0===a.feature?"forest-var":"forest":"mountains");const t=p;void 0===a.feature||g||(p+={Inn:"-inn",Residency:"-inn",Dungeon:"-dungeon",Village:"-village",Town:"-town",City:"-city"}[a.feature]);
return[p,t]}function setupHexProps$$module$api(a){a.rivers&&(a.riverline=RiverLine$$module$api(a.x,a.y,a.rivers));if(a.trails){let g=[];if(a.trails){let p=0;1==a.trails.length%2&&(g.push([a.trails[p]]),p++);for(;p<a.trails.length;p+=2)g.push([a.trails[p],a.trails[p+1]])}a.trailslines=[];g.map(p=>{a.trailslines.push(RiverLine$$module$api(a.x,a.y,p))})}[a.type,a.partial_type]=convertHexType$$module$api(a)}
class MapData$$module$api{constructor(){this.reset()}reset(){this.uuid_to_coords={};this.populated_coords=new Map}neighbor(a,g){switch(g){case 1:return{x:a.x,y:a.y-2};case 2:return{x:a.x+a.y%2,y:a.y-1};case 3:return{x:a.x+a.y%2,y:a.y+1};case 4:return{x:a.x,y:a.y+2};case 5:return{x:a.x-(a.y+1)%2,y:a.y+1};case 6:return{x:a.x-(a.y+1)%2,y:a.y-1}}}getHexDataByUUID(a){return this.uuid_to_coords[a]}hexRegion(a){return this.uuid_to_coords[a].region}hexRealm(a){return this.uuid_to_coords[a].realm}isPopulated(a,
g){return this.populated_coords.has(canonical_coords$$module$utils(a,g))}isOccupied(a){a=this.getHexDataByUUID(a);return void 0===a?!1:void 0!==a.feature}isBorderline(a){a=this.getHexDataByUUID(a);return void 0===a?!1:a.borderline}isCoastal(a){a=this.getHexDataByUUID(a);if(void 0===a)return!1;for(let g=1;6>=g;g++){const p=this.neighbor({x:a.x,y:a.y},g);if(!this.isPopulated(p.x,p.y))return!0}return!1}addOceanHex(a,g){const p=canonical_coords$$module$utils(a,g);this.uuid_to_coords[p]={x:a,y:g,type:"",
feature:""};return p}reload(a,g){return new Promise(p=>{window.app.map_cache&&!g&&(this.hexlist=window.app.map_cache.hexlist,this.borders=window.app.map_cache.borders,this.uuid_to_coords=window.app.map_cache.uuid_to_coords,this.populated_coords=window.app.map_cache.populated_coords,this.loaded=!0,this.postMapLoadedCallback&&this.postMapLoadedCallback(),p());this.reset();api_call_map$$module$api_shim(a).then(t=>{if(t&&t.map){this.regions=t.regions;var A=[],D=[];t.borders||(t.borders={});Object.keys(t.borders).forEach(H=>
{const J=makeRealmPolygon$$module$api(t.borders[H]);A.push({uuid:H,wall:makeWall$$module$api(J),poly:J});D.push(makeRealmLabel$$module$api(t.realms[H],J))});t.map||(t.map=[]);var F=[];t.map.map(H=>{setupHexProps$$module$api(H);F.push({x:H.x,y:H.y});this.uuid_to_coords[H.uuid]={x:H.x,y:H.y,type:H.type,partial_type:H.partial_type,feature:H.feature,feature_uuid:H.feature_uuid,harbor:H.harbor,borderline:H.borderline,region:H.region,realm:H.realm};this.populated_coords.set(canonical_coords$$module$utils(H.x,
H.y),H.uuid)});var K=get_centroidic_point$$module$utils(F);K=getOffset$$module$hex(K.x,K.y);this.hexlist=t.map;this.borders=A;this.initial_offset={x:K[0],y:K[1]};this.realm_labels=D;this.postMapLoadedCallback&&this.postMapLoadedCallback();window.app.map_cache={hexlist:t.map,borders:A,realm_labels:D,uuid_to_coords:this.uuid_to_coords,populated_coords:this.populated_coords};p(!0)}else p(!1)})})}}var module$api={};module$api.MapData=MapData$$module$api;module$api.RiverLine=RiverLine$$module$api;const html$$module$hexmap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function Underwear$$module$hexmap(a){return html$$module$hexmap` <g
    ><polygon
      class="${a.fow?"underwear-fow":"underwear"}"
      points="${a.borders}"
    />
  </g>`}
class VttHexMap$$module$hexmap extends SvgMap$$module$SvgMap{constructor(){super();this.map_data=new MapData$$module$api;const a=getOffset$$module$hex(480,480,0,0);this.setState({offset:{x:a[0],y:a[1]},dim:{w:1500,h:1500},col1:"col1",res:"empty-",hexlist:[],sea:[],flags:[],spinner:!1});this.loaded=!1}fillOceanHexes(a,g,p,t){let A=[];const D=getHexCoords$$module$hex(a,g);a=getHexCoords$$module$hex(a+p,g+t);for(g=D[0]-2;g<a[0]+1;g++)for(p=D[1];p<a[1]+2;p++){t="ocean:"+g+","+p;const F=window.app.yarray.get(t);F&&
""!=F&&A.push({x:g,y:p,type:"ocean",uuid:t})}return A}navigateToHex(a,g){}filterPointerCapture(a,g){return!1}getMatrix(a){this.props.spinner(1,!0);this.map_data.reload(this.props.instance,a).then(g=>{g&&(this.updateReveals(this.map_data.hexlist),this.setState({hexlist:this.map_data.hexlist,offset:this.loaded?this.state.offset:{x:this.map_data.initial_offset.x-this.state.dim.w/2,y:this.map_data.initial_offset.y-this.state.dim.h/2}}),this.loaded=!0);this.setState({spinner:!1});this.props.spinner(1,
!1)})}onHexClicked(a,g,p,t,A){}updateReveals(a){for(let g=0;g<a.length;g++){const p=window.app.yarray.get(a[g].uuid);a[g].pod=p&&"partial"==p[0]?a[g].partial_type:a[g].type;a[g].revealed=p&&p[0]}this.setState({hexlist:a})}postMapLoaded(a){this.loaded?a():this.postMapLoadedCallback=a}componentDidMount(a,g,p){this.postMapLoadedCallback=this.updateReveals;this.getMatrix();super.componentDidMount(a,g,p);window.app.yarray.observe(this.yarr_observer=t=>{t.keysChanged.has("flags")?(this.setState({flags:window.app.yarray.get("flags")}),
this.updateReveals(this.state.hexlist)):t.keysChanged.has("map")?this.getMatrix(!0):this.updateReveals(this.state.hexlist)})}is_within_frustrum(a,g=40){return a.x>this.state.offset.x-g||a.y>this.state.offset.y-g||a.x<this.state.offset.x+this.state.dim.w+g||a.y<this.state.offset.y+this.state.dim.h+g}hexBitmask(){return 0}render(a,g){const p=this.fillOceanHexes(g.offset.x,g.offset.y,g.dim.w,g.dim.h);return html$$module$hexmap`<div
      id="hexmap"
      class="${"col1"}"
      style="overflow:hidden;${a.visible?"":"display:none;"}"
    >
      <svg
        id="canvas"
        class="${a.desaturate_palette?"desaturated":"colorful"} vtt"
        preserveAspectRatio="xMidYMid meet"
        viewBox="${this.state.offset.x} ${this.state.offset.y} ${this.state.dim.w} ${this.state.dim.h}"
      >
        <g id="viewport">
          <g class="pod-wrap">
            ${p.map(t=>html$$module$hexmap`<${VttSeaHex$$module$hex}
                res="${g.res}"
                type="${t.type}"
                class="base"
                uuid="${t.uuid}"
                nx="${t.x}"
                ny="${t.y}"
                ox="${g.offset.x}"
                oy="${g.offset.y}"
                dimw="${g.dim.w}"
                dimh="${g.dim.h}"
                zoom_factor=${g.zoom_factor}
                menuHandler="${this}"
              />`)}
            ${g.hexlist.map(t=>html$$module$hexmap`<${VttHex$$module$hex}
                res="${g.res}"
                pod="${t.pod}"
                revealed=${t.revealed}
                feature="${t.feature}"
                feature_uuid="${t.feature_uuid}"
                class="base"
                instance="${a.instance}"
                uuid=${t.uuid}
                riverline=${t.riverline}
                trailslines=${t.trailslines}
                location_uuid=${a.hex_uuid}
                nx="${t.x}"
                ny="${t.y}"
                zoom_factor=${g.zoom_factor}
                ox="${g.offset.x}"
                oy="${g.offset.y}"
                dimw="${g.dim.w}"
                dimh="${g.dim.h}"
                menuHandler="${this}"
                tokens=${this.tokens}
              />`)}
            <g>
              ${g.flags.map(t=>html$$module$hexmap`<polygon
                  class="flagged-hex"
                  points=${makeHex$$module$hex(getOffset$$module$hex(t.x,t.y))}
                />`)}
            </g>
          </g>
        </g>
      </svg>
    </div>`}}
class HexMap$$module$hexmap extends SvgMap$$module$SvgMap{constructor(){super();this.map_data=new MapData$$module$api;const a=getOffset$$module$hex(480,480,0,0);this.setState({offset:{x:a[0],y:a[1]},dim:{w:1500,h:1500},col1:"col1",res:"empty-",hexlist:[],borders:[],realm_labels:[],sea:[],flags:[],spinner:!1});this.loaded=this.selected=!1;this.labels=[];this.sea=[]}async fillOceanHexes(a,g,p,t){if(2>this.state.zoom_factor)this.sea=[];else if(10>this.state.zoom_factor&&(this.drag||this.camera_moving))this.sea=[];
else{var A=getHexCoords$$module$hex(a,g),D=A[0]-2;A=A[1]-2;g=getHexCoords$$module$hex(a+p,g+t);a=g[0]+2;g=g[1]+2;for(p=0;D<a;D++)for(t=A;t<g;t++)if(!this.map_data.isPopulated(D,t)){if(p>=this.sea.length)this.sea.push({x:D,y:t,type:"ocean",uuid:"ocean:"+D+","+t});else{let F=this.sea[p];F.x=D;F.y=t;F.type="ocean";F.uuid="ocean:"+D+","+t}p++}this.sea.length=p}}makeRealmLabel(a,g){const p=get_polygon_centroid$$module$utils(g);g=get_polygon_area$$module$utils(g);return[a.name.split(/[ ]/),p,clamp$$module$utils(1E-5*
g,1,2)]}getMatrix(a){this.props.spinner(1,!0);this.map_data.reload(this.props.instance,a).then(g=>{g&&(this.setState({hexlist:this.map_data.hexlist,borders:this.map_data.borders,offset:this.loaded?this.state.offset:{x:this.map_data.initial_offset.x-this.state.dim.w/2,y:this.map_data.initial_offset.y-this.state.dim.h/2},realm_labels:this.map_data.realm_labels}),this.navigateToHex(this.props.hex_uuid),this.loaded=!0,this.postMapLoadedCallback&&this.postMapLoadedCallback(),this.makeRegionLabels());this.setState({spinner:!1});
this.props.spinner(1,!1)});a&&window.app.yarray.set("map",!0)}onRerollHex(a){this.setState({spinner:!0});this.props.spinner(1,!0);fetch("/reroll/"+this.props.instance+"/"+a+"/default",{method:"GET"}).then(g=>401===g.status?(window.app.unauth(),this.getMatrix(),Promise.reject(g)):g.json()).then(g=>{this.state.menu.c.setState({uuid:g.uuid});this.state.menu.uuid=g.uuid;delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onClearHexRiver(a){this.props.spinner(1,!0);fetch("/clear/"+
this.props.instance+"/"+a+"/river",{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onClearHexTrails(a){this.props.spinner(1,!0);fetch("/clear/"+this.props.instance+"/"+a+"/trails",{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onDrawRiver(a){fetch("/draw/"+this.props.instance+"/"+a+"/river",{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;
this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onAppendMenu(){let a=this.state.menu;a.type=1;this.setState({menu:a})}onRerollMenu(){let a=this.state.menu;a.type=2;this.setState({menu:a})}onDeleteMenu(){let a=this.state.menu;a.type=3;this.setState({menu:a})}onRollSettlementMenu(){let a=this.state.menu;a.type=4;this.setState({menu:a})}onAppendRealm(){this.props.appendDialog(this.state.menu)}onRemapEntity(a){this.props.spinner(1,!0);this.setState({spinner:!0});fetch("/remap/",{method:"POST",
headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a})}).then(g=>{401===g.status&&window.app.unauth();g.text()}).then(g=>{this.getMatrix(!0)}).catch(g=>{console.error("Error:",g)})}onAppendSettlement(a,g){this.props.spinner(1,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:"Settlement",type:g})}).then(p=>
p.text()).then(p=>{this.getMatrix(!0)}).catch(p=>{console.error("Error:",p)})}onAppendFeature(a,g,p){this.props.spinner(1,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:g,type:p})}).then(t=>t.text()).then(t=>{this.getMatrix(!0)}).catch(t=>{console.error("Error:",t)})}makeRegionLabels(){let a=new Map;for(const A of this.map_data.hexlist)A.region&&(a.has(A.region)||a.set(A.region,
{label:this.map_data.regions[A.region],coords:[]}),a.get(A.region).coords.push([A.x,A.y]));let g=[],p=null,t=null;a.forEach(A=>{var D=null;let F=null,K=null,H=null,J=0,I=[];for(const N of A.coords){J++;const T=N[0],O=N[1];I.push({x:T,y:O});if(!D||T<D)D=T;if(!K||O<K)K=O;if(!F||T>F)F=T;if(!H||O>H)H=O}if(!p||J<p)p=J;if(!t||J>t)t=J;D=get_centroidic_point$$module$utils(I);D=getOffset$$module$hex(D.x,D.y,0,0);g.push({name:A.label.split(/[ ]/),x:D[0],y:D[1],r:18-A.label.length,n_hexes:J})});for(let A of g)A.fontsize=
A.n_hexes/t*.2+.2;this.labels=g}filterPointerCapture(a,g){var p=document.getElementById("canvas");let t=p.createSVGPoint();t.x=a;t.y=g;a=t.matrixTransform(p.getScreenCTM().inverse());return this.selected&&this.state.menu&&10>this.state.zoom_factor?(g=this.state.menu.offset.x,p=this.state.menu.offset.y,a=(a.x-g)*(a.x-g)+(a.y-p)*(a.y-p),256>a&&32<a):!1}onHexClickedInFlagMode(a,g){if(this.state.flag_mode){let p=this.state.flags;p.push({x:a,y:g});this.setState({flags:p});window.app.yarray.set("flags",
p);return!0}return!1}onHexClickedInCrawlMode(a,g,p,t){const A=this.map_data.populated_coords.get(canonical_coords$$module$utils(a,g));return this.props.hex_uuid?("ocean"!=t||A?$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+p):(a=this.map_data.addOceanHex(a,g),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/coords/"+a)),!0):!1}onHexClickedInLockedFullMap(a,g,p,t){const A=this.map_data.populated_coords.get(canonical_coords$$module$utils(a,g));this.selected=
!0;if(window.app.locked){if("ocean"!=t||A)this.onSelectHex(p);else a=this.map_data.addOceanHex(a,g),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/coords/"+a);return!0}return!1}onHexClicked(a,g,p,t,A){if(!(this.state.ctrl_mode&&!this.state.flag_mode||this.onHexClickedInFlagMode(a,g)||this.onHexClickedInCrawlMode(a,g,p,t)||this.onHexClickedInLockedFullMap(a,g,p,t))){var D=getOffset$$module$hex(a,g);this.setState({menu:{type:0,c:A,uuid:p,hex_type:t,offset:{x:D[0],y:D[1]},nx:a,
ny:g}})}}postMapLoaded(a){this.loaded?a():this.postMapLoadedCallback=a}onClickRealm(a){window.app.inhibit_click||$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/realm/"+a)}navigateToRealm(a){for(const p of this.state.borders)if(p.uuid==a){var g=get_polygon_extents$$module$utils(p.poly);const t=1.1*g.w;g=1.1*g.h;const A=get_polygon_centroid$$module$utils(p.poly);this.minimapOnLocation(A.x,A.y,t,g)}}navigateToHex(a,g){function p(K,H,J){J*=Math.PI/180;var I={};I.x=K*Math.cos(J)-
H*Math.sin(J);I.y=K*Math.sin(J)+H*Math.cos(J);return I}if(!window.app.ctrl_mode&&(a=this.map_data.getHexDataByUUID(a),void 0!==a)){var t=0,A=0;g&&(t=g.x,A=g.y);var D=200;"City"!=a.feature&&"Town"!=a.feature||void 0===a.harbor||(A=p(t,A-900,60*a.harbor),t=A.x,A=A.y);"Village"==a.feature&&(void 0!==a.harbor&&(D=p(t,A-675,60*a.harbor),t=D.x,A=D.y),D=100);"Dungeon"==a.feature&&(D=100);var F=getOffset$$module$hex(a.x,a.y);g?(F[0]+=t/D,F[1]+=A/D,this.focused_hex=null):this.focused_hex=a;this.minimapOnLocation(F[0],
F[1],g?g.zoom:100,g?g.zoom:100)}}onSelectHex(a){if(void 0!==this.map_data.getHexDataByUUID(a)){this.onSelectHexInoked=!0;$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+a);var g=this;window.setTimeout(()=>{g.navigateToHex(a)},500)}}onRemoveEntity(a){this.props.spinner(1,!0);this.setState({spinner:!0});fetch("/remove/"+this.props.instance+"/"+a,{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onRemoveHex(a){this.onRemoveEntity(a)}onRemoveRegion(a){this.onRemoveEntity(this.map_data.hexRegion(a))}onRemoveRealm(a){this.onRemoveEntity(this.map_data.hexRealm(a))}componentDidMount(a,
g,p){this.getMatrix();super.componentDidMount(a,g,p);window.addEventListener("keydown",t=>this.onKeyDown(t));window.addEventListener("keyup",t=>this.onKeyUp(t));window.addEventListener("mouseout",t=>{t=t.relatedTarget||t.toElement;t&&"HTML"!=t.nodeName||(this.setState({ctrl_mode:!1,flag_mode:!1}),window.app.ctrl_mode=!1,window.app.flag_mode=!1,this.props.ctrlMode(!1))})}onKeyUp(a){is_electron$$module$api_shim||("Space"==a.code&&window.app.ctrl_mode&&(this.setState({ctrl_mode:!1}),this.props.ctrlMode(!1),
window.app.ctrl_mode=!1),"KeyF"==a.code&&window.app.flag_mode&&(this.props.ctrlMode(!1),window.app.ctrl_mode=!1,this.setState({ctrl_mode:!1,flag_mode:!1,flags:[]}),window.app.yarray.set("flags",[]),window.app.flag_mode=!1),"KeyT"==a.code&&(window.app.shift_mode=!1,this.props.ctrlMode(!1),window.app.ctrl_mode=!1,this.setState({ctrl_mode:!1})),"KeyK"==a.code&&(window.app.kill_mode=!1,this.props.ctrlMode(!1),window.app.ctrl_mode=!1,this.setState({ctrl_mode:!1})))}onKeyDown(a){if(!window.app.inhibit_hotkeys&&
(is_electron$$module$api_shim||("Space"!=a.code||window.app.ctrl_mode||(this.setState({ctrl_mode:!0}),this.props.ctrlMode(!0),window.app.ctrl_mode=!0),"KeyF"!=a.code||window.app.flag_mode||(this.props.ctrlMode(!0),window.app.ctrl_mode=!0,this.setState({ctrl_mode:!0,flag_mode:!0}),window.app.flag_mode=!0),"KeyT"==a.code&&(window.app.shift_mode=!0,this.props.ctrlMode(!0),window.app.ctrl_mode=!0,this.setState({ctrl_mode:!0})),"KeyK"==a.code&&(window.app.kill_mode=!0,this.props.ctrlMode(!0),window.app.ctrl_mode=
!0,this.setState({ctrl_mode:!0}))),this.focused_hex&&this.props.hex_uuid)){var g=this.focused_hex.y,p=this.focused_hex.x;"w"==a.key&&(g-=2);"s"==a.key&&(g+=2);"e"==a.key&&(--g,0==Math.abs(g)%2&&p++);"q"==a.key&&(--g,1==Math.abs(g)%2&&p--);"a"==a.key&&(g+=1,1==Math.abs(g)%2&&p--);"d"==a.key&&(g+=1,0==Math.abs(g)%2&&p++);var t=this.map_data.populated_coords.get(canonical_coords$$module$utils(p,g)),A=t?null:this.map_data.addOceanHex(p,g);if(t||A)this.navigateToHex(t||A),this.on_key_down_to&&window.clearTimeout(this.on_key_down_to);
this.on_key_down_to=window.setTimeout(()=>{$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+(A?"/coords/":"/hex/")+(A?A:t))},500)}}componentDidUpdate(a,g,p){(a.hex_uuid!=this.props.hex_uuid&&this.props.hex_uuid&&a.hex_uuid||!a.hex_uuid&&this.props.hex_uuid&&!this.onSelectHexInoked)&&this.navigateToHex(this.props.hex_uuid);this.onSelectHexInoked&&(this.onSelectHexInoked=!1);0==a.locked&&1==this.props.locked&&(this.selected=null)}is_within_frustrum(a,g=40){return a.x>this.state.offset.x-
g||a.y>this.state.offset.y-g||a.x<this.state.offset.x+this.state.dim.w+g||a.y<this.state.offset.y+this.state.dim.h+g}hexBitmask(){const a=this.state.menu.uuid;let g=0;"ocean"===this.state.menu.hex_type&&(g|=HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN);this.map_data.isOccupied(a)&&(g|=HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED);this.map_data.isCoastal(a)&&(g|=HexBitmask$$module$hexmenu.IS_HEX_COASTAL);this.map_data.isBorderline(a)&&(g|=HexBitmask$$module$hexmenu.IS_HEX_HAS_BORDER);return g}render(a,
g){var p=this.focused_hex?getOffset$$module$hex(this.focused_hex.x,this.focused_hex.y,0,0):null;p=this.focused_hex?html$$module$hexmap` <polygon class="focused-hex" points=${makeHex$$module$hex(p)} /> `:html$$module$hexmap``;var t=1<g.zoom_factor&&1500>g.zoom_factor&&!a.locked&&!g.spinner;t||(this.selected=!1);var A=5/Math.sqrt(g.zoom_factor);t=this.state.menu?html$$module$hexmap`<${HexMenu$$module$hexmenu}
          menu=${this.state.menu}
          cond=${t}
          bitmask=${this.hexBitmask()}
          handler=${this}
          scale=${Math.min(Math.max(1.5*A,.5),3)}
        />`:html$$module$hexmap``;this.fillOceanHexes(g.offset.x,g.offset.y,g.dim.w,g.dim.h);A=this.state.col1;A=a.hex_uuid?"rect1":"col1";const D=g.ctrl_mode?SeaHexMask$$module$hex:SeaHex$$module$hex;return html$$module$hexmap`<div
      id="hexmap"
      class="${A}"
      style="overflow:hidden;${a.visible?"":"display:none;"}"
    >
      <svg
        id="canvas"
        class="${a.desaturate_palette?"desaturated":"colorful"} ${g.ctrl_mode&&"fow_mode"}"
        preserveAspectRatio="xMidYMid meet"
        viewBox="${this.state.offset.x} ${this.state.offset.y} ${this.state.dim.w} ${this.state.dim.h}"
      >
        <g id="viewport">
          <g class="pod-wrap">
            <g opacity="${this.state.zoom_factor/4}">
              ${this.sea.map(F=>html$$module$hexmap`<${D}
                  id=${F.uuid}
                  res="${g.res}"
                  type="${F.type}"
                  class="base"
                  uuid="${F.uuid}"
                  nx="${F.x}"
                  ny="${F.y}"
                  ox="${g.offset.x}"
                  oy="${g.offset.y}"
                  dimw="${g.dim.w}"
                  dimh="${g.dim.h}"
                  zoom_factor=${g.zoom_factor}
                  menuHandler="${this}"
                  flag_mode=${g.flag_mode}
                />`)}
            </g>
            <g>
              ${g.borders.map(F=>html$$module$hexmap` <${Underwear$$module$hexmap}
                  fow=${g.ctrl_mode}
                  borders="${F.wall}"
                />`)}
            </g>
            ${g.hexlist.map(F=>html$$module$hexmap`<${Hex$$module$hex}
                res="${g.res}"
                type="${F.type}"
                feature="${F.feature}"
                feature_uuid="${F.feature_uuid}"
                class="base"
                instance="${a.instance}"
                uuid=${F.uuid}
                riverline=${F.riverline}
                trailslines=${F.trailslines}
                location_uuid=${a.hex_uuid}
                nx="${F.x}"
                ny="${F.y}"
                zoom_factor=${g.zoom_factor}
                ox="${g.offset.x}"
                oy="${g.offset.y}"
                dimw="${g.dim.w}"
                dimh="${g.dim.h}"
                menuHandler="${this}"
                tokens=${this.tokens}
                ctrl_mode=${g.ctrl_mode}
              />`)}
            ${g.ctrl_mode&&1E3>g.zoom_factor&&g.hexlist.map(F=>html$$module$hexmap`<${HexMask$$module$hex}
                uuid=${F.uuid}
                nx="${F.x}"
                ny="${F.y}"
                zoom_factor=${g.zoom_factor}
                ox="${g.offset.x}"
                oy="${g.offset.y}"
                dimw="${g.dim.w}"
                dimh="${g.dim.h}"
                flag_mode=${g.flag_mode}
              />`)}
            <g>
              ${g.borders.map(F=>html$$module$hexmap`<a onClick=${()=>this.onClickRealm(F.uuid)}>
                  <${Borderline$$module$hex}
                    borders="${F.wall}"
                    arm="10"
                    color="#ffffff"
                    zoom_factor=${g.zoom_factor}
                    ox="${this.state.offset.x}"
                    oy="${this.state.offset.y}"
                    dimw="${this.state.dim.w}"
                    dimh="${this.state.dim.h}"
                /></a>`)}
            </g>
            <g>${p}</g>
            <g>
              ${g.flags.map(F=>html$$module$hexmap`<polygon
                  class="flagged-hex"
                  points=${makeHex$$module$hex(getOffset$$module$hex(F.x,F.y))}
                />`)}
            </g>
            <g>
              ${"col1"==A&&a.show_labels&&!g.ctrl_mode?this.labels.map(F=>{if(this.is_within_frustrum(F)){let K=(this.state.zoom_factor-5)/10,H=0,J=1;100<this.state.zoom_factor&&(K=this.state.zoom_factor/1E3,H=1,J=-1);return html$$module$hexmap`
                        <text
                          opacity="${H+J*clamp$$module$utils(K,0,1)}"
                          transform="translate( ${F.x} , ${F.y}) rotate( ${F.r})"
                          class="region-label"
                          font-size="${F.fontsize}em"
                          text-anchor="middle"
                        >
                          ${F.name.map((I,N)=>html$$module$hexmap`<tspan x="0" y="${N-2}em" dy="1em"
                              >${I}</tspan
                            >`)}
                        </text>
                      `}}):html$$module$hexmap``}
            </g>
            <g>
              ${a.show_labels&&!g.ctrl_mode?this.state.realm_labels.map(F=>html$$module$hexmap`
                      <text
                        opacity="${1-clamp$$module$utils((this.state.zoom_factor-3)/10,0,1)}"
                        transform="translate( ${F[1].x} , ${F[1].y})"
                        class="realm-label"
                        font-size="${F[2]}em"
                        text-anchor="middle"
                      >
                        ${F[0].map((K,H)=>html$$module$hexmap`<tspan x="0" y="${H-2}em" dy="1em"
                            >${K}</tspan
                          >`)}
                      </text>
                    `):html$$module$hexmap``}
            </g>
          </g>
        </g>
        <g>${t}</g>
      </svg>
    </div>`}}var module$hexmap={};module$hexmap.HexMap=HexMap$$module$hexmap;module$hexmap.VttHexMap=VttHexMap$$module$hexmap;const html$$module$spinner=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Spinner$$module$spinner extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$spinner`
      <div id="hexspinner" style="${a.style}">
        <svg
          width="${a.width}"
          id="eefEsROxk9w1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          viewBox="0 0 640 480"
          shape-rendering="geometricPrecision"
          text-rendering="geometricPrecision"
          style="background:transparent;"
        >
          <style>
            #eefEsROxk9w2_ts {
              animation: eefEsROxk9w2_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w2_ts__ts {
              0% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(0, 0);
              }
              34.482759% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(1, 1);
              }
              68.965517% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(0, 0);
              }
            }
            #eefEsROxk9w3_ts {
              animation: eefEsROxk9w3_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w3_ts__ts {
              0% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
              13.793103% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
              48.275862% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(1, 1);
              }
              82.758621% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
            }
            #eefEsROxk9w4_ts {
              animation: eefEsROxk9w4_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w4_ts__ts {
              0% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(0, 0);
              }
              31.034483% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(0, 0);
              }
              65.517241% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(1, 1);
              }
              100% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(0, 0);
              }
            }
            #eefEsROxk9w5_ts {
              animation: eefEsROxk9w5_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w5_ts__ts {
              0% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
              13.793103% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0, 0);
              }
              48.275862% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0, 0);
              }
              82.758621% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(1, 1);
              }
              100% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
            }
            #eefEsROxk9w6_ts {
              animation: eefEsROxk9w6_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w6_ts__ts {
              0% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(1, 1);
              }
              34.482759% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(0, 0);
              }
              65.517241% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(1, 1);
              }
            }
            #eefEsROxk9w7_ts {
              animation: eefEsROxk9w7_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w7_ts__ts {
              0% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
              17.241379% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(1, 1);
              }
              48.275862% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0, 0);
              }
              82.758621% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
            }
          </style>
          <g
            id="eefEsROxk9w2_ts"
            transform="translate(328.585373,76.258278) rotate(91.041629) scale(0,0)"
          >
            <polygon
              id="eefEsROxk9w2"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w3_ts"
            transform="translate(440.19521,139.159051) rotate(91.041629) scale(0,0)"
          >
            <polygon
              id="eefEsROxk9w3"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w4_ts"
            transform="translate(440.19521,273.305491) rotate(91.041629) scale(0,0)"
          >
            <polygon
              id="eefEsROxk9w4"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w5_ts"
            transform="translate(328.747458,337.283861) rotate(91.041629) scale(0.5,0.5)"
          >
            <polygon
              id="eefEsROxk9w5"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w6_ts"
            transform="translate(224.649822,273.703072) rotate(91.041629) scale(1,1)"
          >
            <polygon
              id="eefEsROxk9w6"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w7_ts"
            transform="translate(224.649822,143.849319) rotate(91.041629) scale(0.5,0.5)"
          >
            <polygon
              id="eefEsROxk9w7"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
        </svg>
      </div>
    `}}var module$spinner={};module$spinner.Spinner=Spinner$$module$spinner;const html$$module$search=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class SearchBar$$module$search extends k$$module$libs$preact{constructor(){super();this.setState({callInvoked:!1,results:[]});this.search=this.search.bind(this);this.delayTimer=null}search(a){const g=document.getElementById("search-input").value;""==g||void 0===g?this.setState({results:[]}):(this.setState({callInvoked:!0}),api_call_search$$module$api_shim(a,g).then(p=>{this.setState({results:p.results,callInvoked:!1})}))}delayed_search(a){this.delayTimer&&clearTimeout(this.delayTimer);let g=this;
this.delayTimer=setTimeout(function(){g.search(a)},150)}render(a,g){const p=0<g.results.length||!g.callInvoked?html$$module$search``:html$$module$search`
            <div style="width:100%;text-align:center;">
              <${Spinner$$module$spinner} style="" width="50px" />
            </div>
          `;return html$$module$search`
          <div> <input placeholder="Search" id="search-input" autocomplete="off" onkeypress="${()=>this.delayed_search(a.instance)}" onkeyup="${()=>this.delayed_search(a.instance)}"      
        onfocusin=${()=>window.app.inhibit_hotkeys=!0}
        onfocusout=${()=>window.app.inhibit_hotkeys=!1}

        > 

      </input>
      ${p}
          <ul id="search-results">
            ${g.results.map(t=>html$$module$search`<li>
                <a
                  href="/sandbox/${a.instance}/${t.type}/${t.uuid}${t.anchor?"/npc/"+t.anchor:""}"
                >
                  <div style="display:table-row;">
                    <div style="display:table-cell;">
                      <i
                        style="margin-right:0.5em;"
                        class="fa fa-solid fa-${t.icon}"
                      ></i>
                    </div>
                    <div style="display:table-cell;width:100%;">
                      ${t.value}
                    </div>
                  </div>
                  <div style="display:table-row;">
                    <div style="display:table-cell;"></div>
                    <div class="details" style="display:table-cell;width:100%;">
                      ${t.details}
                    </div>
                  </div>
                </a>
              </li>`)}
          </ul>
          </div>
      `}}var module$search={};module$search.SearchBar=SearchBar$$module$search;const html$$module$dialogs=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class GenerateRealmDialog$$module$dialogs extends ModalDialog$$module$utils{constructor(){super();this.state={show:!0,realm_type:"RealmTypeKingdom",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,
minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_jungle_region:12,maximum_tiles_per_jungle_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32,minimum_tiles_per_tundra_region:12,maximum_tiles_per_tundra_region:32,minimum_number_of_settlements:6,maximum_number_of_settlements:9,cities_probability:2,towns_probability:3,villages_probability:3,minimum_number_of_inns:3,
maximum_number_of_inns:6,minimum_number_of_dungeons:6,maximum_number_of_dungeons:9,tombs_probability:1,temples_probability:1,caves_probability:1,minimum_number_of_factions:3,maximum_number_of_factions:5,cults_probability:1,militias_probability:1,treasure_factor:1};this.onSubmit=this.onSubmit.bind(this);this.onRealmType=this.onRealmType.bind(this);this.onRealmPopulation=this.onRealmPopulation.bind(this);this.onMinimumNumberOfRegions=this.onMinimumNumberOfRegions.bind(this);this.onMaximumNumberOfRegions=
this.onMaximumNumberOfRegions.bind(this);this.onMountainsProbability=this.onMountainsProbability.bind(this);this.onMinimumTilesPerMountainsRegion=this.onMinimumTilesPerMountainsRegion.bind(this);this.onMaximumTilesPerMountainsRegion=this.onMaximumTilesPerMountainsRegion.bind(this);this.onMinimumTilesPerForestRegion=this.onMinimumTilesPerForestRegion.bind(this);this.onMaximumTilesPerForestRegion=this.onMaximumTilesPerForestRegion.bind(this);this.onMinimumTilesPerDesertRegion=this.onMinimumTilesPerDesertRegion.bind(this);
this.onMaximumTilesPerDesertRegion=this.onMaximumTilesPerDesertRegion.bind(this);this.onMinimumTilesPerPlainsRegion=this.onMinimumTilesPerPlainsRegion.bind(this);this.onMaximumTilesPerPlainsRegion=this.onMaximumTilesPerPlainsRegion.bind(this);this.onMinimumTilesPerJungleRegion=this.onMinimumTilesPerJungleRegion.bind(this);this.onMaximumTilesPerJungleRegion=this.onMaximumTilesPerJungleRegion.bind(this);this.onMinimumTilesPerSwampsRegion=this.onMinimumTilesPerSwampsRegion.bind(this);this.onMaximumTilesPerSwampsRegion=
this.onMaximumTilesPerSwampsRegion.bind(this);this.onMinimumTilesPerTundraRegion=this.onMinimumTilesPerTundraRegion.bind(this);this.onMaximumTilesPerTundraRegion=this.onMaximumTilesPerTundraRegion.bind(this);this.onForestProbability=this.onForestProbability.bind(this);this.onDesertProbability=this.onDesertProbability.bind(this);this.onPlainsProbability=this.onPlainsProbability.bind(this);this.onJungleProbability=this.onJungleProbability.bind(this);this.onSwampsProbability=this.onSwampsProbability.bind(this);
this.onTundraProbability=this.onTundraProbability.bind(this);this.onMinimumNumberOfSettlements=this.onMinimumNumberOfSettlements.bind(this);this.onMaximumNumberOfSettlements=this.onMaximumNumberOfSettlements.bind(this);this.onCitiesProbability=this.onCitiesProbability.bind(this);this.onTownsProbability=this.onTownsProbability.bind(this);this.onVillagesProbability=this.onVillagesProbability.bind(this);this.onMinimumNumberOfInns=this.onMinimumNumberOfInns.bind(this);this.onMaximumNumberOfInns=this.onMaximumNumberOfInns.bind(this);
this.onMinimumNumberOfDungeons=this.onMinimumNumberOfDungeons.bind(this);this.onMaximumNumberOfDungeons=this.onMaximumNumberOfDungeons.bind(this);this.onTombsProbability=this.onTombsProbability.bind(this);this.onTemplesProbability=this.onTemplesProbability.bind(this);this.onCavesProbability=this.onCavesProbability.bind(this);this.onMinimumNumberOfFactions=this.onMinimumNumberOfFactions.bind(this);this.onMaximumNumberOfFactions=this.onMaximumNumberOfFactions.bind(this);this.onCultsProbability=this.onCultsProbability.bind(this);
this.onMilitiasProbability=this.onMilitiasProbability.bind(this);this.onTreasureFactor=this.onTreasureFactor.bind(this)}show(){this.setState({show:!0})}hide(){this.setState({show:!1})}onRealmType(a){"RealmTypeLands"==a.target.value&&this.setState({realm_type:"RealmTypeLands",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:0,desert_probability:1,plains_probability:0,jungle_probability:4,swamps_probability:1,tundra_probability:0,minimum_tiles_per_mountains_region:12,
maximum_tiles_per_mountains_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_jungle_region:12,maximum_tiles_per_jungle_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeKingdom"==a.target.value&&this.setState({realm_type:"RealmTypeKingdom",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,
tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeEmpire"==a.target.value&&this.setState({realm_type:"RealmTypeEmpire",minimum_number_of_regions:24,maximum_number_of_regions:32,
mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});
"RealmTypeDuchy"==a.target.value&&this.setState({realm_type:"RealmTypeDuchy",minimum_number_of_regions:4,maximum_number_of_regions:8,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,
maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32})}onRealmPopulation(a){"now"==a.target.value&&this.setState({minimum_number_of_settlements:6,maximum_number_of_settlements:9,minimum_number_of_inns:6,maximum_number_of_inns:9,minimum_number_of_factions:3,maximum_number_of_factions:5});"later"==a.target.value&&this.setState({minimum_number_of_settlements:0,maximum_number_of_settlements:0,minimum_number_of_inns:0,maximum_number_of_inns:0,minimum_number_of_factions:0,
maximum_number_of_factions:0})}onMinimumNumberOfRegions(a){this.state.minimum_number_of_regions=a.target.value}onMaximumNumberOfRegions(a){this.state.maximum_number_of_regions=a.target.value}onMountainsProbability(a){this.state.mountains_probability=a.target.value}onMinimumTilesPerMountainsRegion(a){this.state.minimum_tiles_per_mountains_region=a.target.value}onMaximumTilesPerMountainsRegion(a){this.state.maximum_tiles_per_mountains_region=a.target.value}onMinimumTilesPerForestRegion(a){this.state.minimum_tiles_per_forest_region=
a.target.value}onMaximumTilesPerForestRegion(a){this.state.maximum_tiles_per_forest_region=a.target.value}onMinimumTilesPerDesertRegion(a){this.state.minimum_tiles_per_desert_region=a.target.value}onMaximumTilesPerDesertRegion(a){this.state.maximum_tiles_per_desert_region=a.target.value}onMinimumTilesPerPlainsRegion(a){this.state.minimum_tiles_per_plains_region=a.target.value}onMaximumTilesPerPlainsRegion(a){this.state.maximum_tiles_per_plains_region=a.target.value}onMinimumTilesPerJungleRegion(a){this.state.minimum_tiles_per_jungle_region=
a.target.value}onMaximumTilesPerJungleRegion(a){this.state.maximum_tiles_per_jungle_region=a.target.value}onMinimumTilesPerSwampsRegion(a){this.state.minimum_tiles_per_swamps_region=a.target.value}onMaximumTilesPerSwampsRegion(a){this.state.maximum_tiles_per_swamps_region=a.target.value}onMinimumTilesPerTundraRegion(a){this.state.minimum_tiles_per_tundra_region=a.target.value}onMaximumTilesPerTundraRegion(a){this.state.maximum_tiles_per_tundra_region=a.target.value}onForestProbability(a){this.state.forest_probability=
a.target.value}onDesertProbability(a){this.state.desert_probability=a.target.value}onPlainsProbability(a){this.state.plains_probability=a.target.value}onJungleProbability(a){this.state.jungle_probability=a.target.value}onSwampsProbability(a){this.state.swamps_probability=a.target.value}onTundraProbability(a){this.state.tundra_probability=a.target.value}onMinimumNumberOfSettlements(a){this.state.minimum_number_of_settlements=a.target.value}onMaximumNumberOfSettlements(a){this.state.maximum_number_of_settlements=
a.target.value}onCitiesProbability(a){this.state.cities_probability=a.target.value}onTownsProbability(a){this.state.towns_probability=a.target.value}onVillagesProbability(a){this.state.villages_probability=a.target.value}onMinimumNumberOfInns(a){this.state.minimum_number_of_inns=a.target.value}onMaximumNumberOfInns(a){this.state.maximum_number_of_inns=a.target.value}onMinimumNumberOfDungeons(a){this.state.minimum_number_of_dungeons=a.target.value}onMaximumNumberOfDungeons(a){this.state.maximum_number_of_dungeons=
a.target.value}onTombsProbability(a){this.state.tombs_probability=a.target.value}onTemplesProbability(a){this.state.temples_probability=a.target.value}onCavesProbability(a){this.state.caves_probability=a.target.value}onMinimumNumberOfFactions(a){this.state.minimum_number_of_factions=a.target.value}onMaximumNumberOfFactions(a){this.state.maximum_number_of_factions=a.target.value}onCultsProbability(a){this.state.cults_probability=a.target.value}onMilitiasProbability(a){this.state.militias_probability=
a.target.value}onTreasureFactor(a){this.state.treasure_factor=a.target.value}onSubmit(){this.props.onOkay("Generic",{realm_type:this.state.realm_type,minimum_number_of_regions:parseInt(this.state.minimum_number_of_regions),maximum_number_of_regions:parseInt(this.state.maximum_number_of_regions),mountains_probability:parseInt(this.state.mountains_probability),forest_probability:parseInt(this.state.forest_probability),desert_probability:parseInt(this.state.desert_probability),plains_probability:parseInt(this.state.plains_probability),
jungle_probability:parseInt(this.state.jungle_probability),swamps_probability:parseInt(this.state.swamps_probability),tundra_probability:parseInt(this.state.tundra_probability),minimum_tiles_per_mountains_region:parseInt(this.state.minimum_tiles_per_mountains_region),maximum_tiles_per_mountains_region:parseInt(this.state.maximum_tiles_per_mountains_region),minimum_tiles_per_forest_region:parseInt(this.state.minimum_tiles_per_forest_region),maximum_tiles_per_forest_region:parseInt(this.state.maximum_tiles_per_forest_region),
minimum_tiles_per_desert_region:parseInt(this.state.minimum_tiles_per_desert_region),maximum_tiles_per_desert_region:parseInt(this.state.maximum_tiles_per_desert_region),minimum_tiles_per_plains_region:parseInt(this.state.minimum_tiles_per_plains_region),maximum_tiles_per_plains_region:parseInt(this.state.maximum_tiles_per_plains_region),minimum_tiles_per_jungle_region:parseInt(this.state.minimum_tiles_per_jungle_region),maximum_tiles_per_jungle_region:parseInt(this.state.maximum_tiles_per_jungle_region),
minimum_tiles_per_swamps_region:parseInt(this.state.minimum_tiles_per_swamps_region),maximum_tiles_per_swamps_region:parseInt(this.state.maximum_tiles_per_swamps_region),minimum_tiles_per_tundra_region:parseInt(this.state.minimum_tiles_per_tundra_region),maximum_tiles_per_tundra_region:parseInt(this.state.maximum_tiles_per_tundra_region),minimum_number_of_settlements:parseInt(this.state.minimum_number_of_settlements),maximum_number_of_settlements:parseInt(this.state.maximum_number_of_settlements),
cities_probability:parseInt(this.state.cities_probability),towns_probability:parseInt(this.state.towns_probability),villages_probability:parseInt(this.state.villages_probability),minimum_number_of_inns:parseInt(this.state.minimum_number_of_inns),maximum_number_of_inns:parseInt(this.state.maximum_number_of_inns),minimum_number_of_dungeons:parseInt(this.state.minimum_number_of_dungeons),maximum_number_of_dungeons:parseInt(this.state.maximum_number_of_dungeons),tombs_probability:parseInt(this.state.tombs_probability),
temples_probability:parseInt(this.state.temples_probability),caves_probability:parseInt(this.state.caves_probability),minimum_number_of_factions:parseInt(this.state.minimum_number_of_factions),maximum_number_of_factions:parseInt(this.state.maximum_number_of_factions),cults_probability:parseInt(this.state.cults_probability),militias_probability:parseInt(this.state.militias_probability),treasure_factor:parseFloat(this.state.treasure_factor)});this.setState({show:!1})}okay(a){this.props.onOkay(a);this.setState({show:!1})}cancel(){$$$module$libs$preact_router_module("/sandbox/"+
this.props.instance)}render(a,g){return g.show?html$$module$dialogs` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <span class="close">
            <a
              onClick="${p=>{this.cancel()}}"
            >
              ${"\u00d7"}
            </a>
          </span>
          <!--a onclick="${()=>this.okay("Generic")}">generate a small Duchy</a-->
          <form onSubmit="${this.onSubmit}">
            <button type="submit">GENERATE</button>
            <h4 id="scale">Realm Template</h4>

            <label for="realm_type">Realm Type:</label>

            <select
              name="realm_type"
              id="realm_type"
              value="${g.realm_type}"
              onInput="${this.onRealmType}"
            >
              <option value="RealmTypeKingdom">Kingdom</option>
              <option value="RealmTypeLands">Lands</option>
              <option value="RealmTypeDuchy">Duchy</option>
              <option value="RealmTypeEmpire">Empire</option>
            </select>

            <label for="realm_population">Population:</label>

            <select
              name="realm_population"
              id="realm_population"
              value="${g.realm_population}"
              onInput="${this.onRealmPopulation}"
            >
              <option value="now">Generate now</option>
              <option value="later">I'll add later</option>
            </select>

            <h4 id="scale">Terrain</h4>
            <h5>Number of regions</h5>
            <label for="minimum_number_of_regions">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_regions}"
              onInput="${this.onMinimumNumberOfRegions}"
              min="1"
              max="32"
              pattern="[0-9]+"
              id="minimum_number_of_regions"
              name="minimum_number_of_regions"
            />
            <label for="maximum_number_of_regions"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_regions}"
              onInput="${this.onMaximumNumberOfRegions}"
              min="1"
              max="32"
              pattern="[0-9]+"
              id="maximum_number_of_regions"
              name="maximum_number_of_regions"
            />
            <label for="maximum_number_of_regions"> regions. </label> <br />

            <div style="display:flex;">
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#mountains"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="mountains_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.mountains_probability}"
                    onInput="${this.onMountainsProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="mountains_probability"
                    name="mountains_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="mountains_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_mountains_region}"
                    onInput="${this.onMinimumTilesPerMountainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_mountains_region"
                    name="minimum_tiles_per_mountains_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="mountains_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_mountains_region}"
                    onInput="${this.onMaximumTilesPerMountainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_mountains_region"
                    name="maximum_tiles_per_mountains_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#forest"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="forest_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.forest_probability}"
                    onInput="${this.onForestProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="forest_probability"
                    name="forest_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="forest_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_forest_region}"
                    onInput="${this.onMinimumTilesPerForestRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_forest_region"
                    name="minimum_tiles_per_forest_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="forest_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_forest_region}"
                    onInput="${this.onMaximumTilesPerForestRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_forest_region"
                    name="maximum_tiles_per_forest_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#plains"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="plains_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.plains_probability}"
                    onInput="${this.onPlainsProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="plains_probability"
                    name="plains_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="plains_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_plains_region}"
                    onInput="${this.onMinimumTilesPerPlainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_plains_region"
                    name="minimum_tiles_per_plains_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="plains_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_plains_region}"
                    onInput="${this.onMaximumTilesPerPlainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_plains_region"
                    name="maximum_tiles_per_plains_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#desert"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="desert_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.desert_probability}"
                    onInput="${this.onDesertProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="desert_probability"
                    name="desert_probability"
                  />
                </div>
                <div style="display:block;">
                  <label for="desert_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_desert_region}"
                    onInput="${this.onMinimumTilesPerDesertRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_desert_region"
                    name="minimum_tiles_per_desert_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="desert_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_desert_region}"
                    onInput="${this.onMaximumTilesPerDesertRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_desert_region"
                    name="maximum_tiles_per_desert_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#jungle"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="jungle_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.jungle_probability}"
                    onInput="${this.onJungleProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="jungle_probability"
                    name="jungle_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="jungle_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_jungle_region}"
                    onInput="${this.onMinimumTilesPerJungleRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_jungle_region"
                    name="minimum_tiles_per_jungle_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="jungle_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_jungle_region}"
                    onInput="${this.onMaximumTilesPerJungleRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_jungle_region"
                    name="maximum_tiles_per_jungle_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#swamps"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="swamps_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.swamps_probability}"
                    onInput="${this.onSwampsProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="swamps_probability"
                    name="swamps_probability"
                  />
                </div>
                <div style="display:block;">
                  <label for="swamps_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_swamps_region}"
                    onInput="${this.onMinimumTilesPerSwampsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_swamps_region"
                    name="minimum_tiles_per_swamps_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="swamps_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_swamps_region}"
                    onInput="${this.onMaximumTilesPerSwampsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_swamps_region"
                    name="maximum_tiles_per_swamps_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}#tundra"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="tundra_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.tundra_probability}"
                    onInput="${this.onTundraProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="tundra_probability"
                    name="tundra_probability"
                  />
                </div>
                <div style="display:block;">
                  <label for="tundra_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_tundra_region}"
                    onInput="${this.onMinimumTilesPerTundraRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_tundra_region"
                    name="minimum_tiles_per_tundra_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="tundra_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_tundra_region}"
                    onInput="${this.onMaximumTilesPerTundraRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_tundra_region"
                    name="maximum_tiles_per_tundra_region"
                  />
                </div>
              </div>
            </div>

            <h4 id="dungeons">Dungeons</h4>
            <h5>Number of dungeons</h5>
            <label for="minimum_number_of_dungeons">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_dungeons}"
              onInput="${this.onMinimumNumberOfDungeons}"
              min="0"
              max="18"
              pattern="[0-9]+"
              id="minimum_number_of_dungeons"
              name="minimum_number_of_dungeons"
            />
            <label for="maximum_number_of_dungeons"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_dungeons}"
              onInput="${this.onMaximumNumberOfDungeons}"
              min="0"
              max="18"
              pattern="[0-9]+"
              id="maximum_number_of_dungeons"
              name="maximum_number_of_dungeons"
            />
            <label for="maximum_number_of_dungeons"> dungeons. </label> <br />

            <h5>Dungeon types probability</h5>
            <label for="caves_probability"> Caves ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.caves_probability}"
              onInput="${this.onCavesProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="caves_probability"
              name="caves_probability"
            />

            <label for="temples_probability"> Temples ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.temples_probability}"
              onInput="${this.onTemplesProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="temples_probability"
              name="temples_probability"
            />

            <label for="tombs_probability"> Tombs ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.tombs_probability}"
              onInput="${this.onTombsProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="tombs_probability"
              name="tombs_probability"
            />

            <h5>Wandering Monsters</h5>
            <label for="highest_wandering_monster_hitdice_in_dungeons">
              Wandering monsters highest HD is
            </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="3"
              min="1"
              max="15"
              pattern="[0-9]+"
              id="highest_wandering_monster_hitdice_in_dungeons"
              name="highest_wandering_monster_hitdice_in_dungeons"
            />
            <br />

            <h4 id="settlements">Settlements</h4>
            <h5>Number of settlements</h5>
            <label for="minimum_number_of_settlements">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="12"
              value="${g.minimum_number_of_settlements}"
              onInput="${this.onMinimumNumberOfSettlements}"
              pattern="[0-9]+"
              id="minimum_number_of_settlements"
              name="minimum_number_of_settlements"
            />
            <label for="maximum_number_of_settlements"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="12"
              pattern="[0-9]+"
              value="${g.maximum_number_of_settlements}"
              onInput="${this.onMaximumNumberOfSettlements}"
              id="maximum_number_of_settlements"
              name="maximum_number_of_settlements"
            />
            <label for="maximum_number_of_settlements"> settlements. </label>
            <br />

            <h5>Settlement types probability</h5>
            <label for="cities_probability"> Cities: </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="10"
              pattern="[0-9]+"
              value="${g.cities_probability}"
              onInput="${this.onCitiesProbability}"
              id="cities_probability"
              name="cities_probability"
            />

            <label for="towns_probability"> Towns: </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="10"
              pattern="[0-9]+"
              value="${g.towns_probability}"
              onInput="${this.onTownsProbability}"
              id="towns_probability"
              name="towns_probability"
            />

            <label for="villages_probability"> Villages: </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="10"
              pattern="[0-9]+"
              value="${g.villages_probability}"
              onInput="${this.onVillagesProbability}"
              id="villages_probability"
              name="villages_probability"
            />

            <h4 id="inns">Inns</h4>
            <h5>Number of inns (not in settlements)</h5>
            <label for="minimum_number_of_inns">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_inns}"
              onInput="${this.onMinimumNumberOfInns}"
              min="0"
              max="9"
              pattern="[0-9]+"
              id="minimum_number_of_inns"
              name="minimum_number_of_inns"
            />
            <label for="maximum_number_of_inns"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_inns}"
              onInput="${this.onMaximumNumberOfInns}"
              min="0"
              max="9"
              pattern="[0-9]+"
              id="maximum_number_of_inns"
              name="maximum_number_of_inns"
            />
            <label for="maximum_number_of_inns"> inns. </label> <br />

            <br />

            <h4 id="factions">Factions</h4>
            <h5>Number of factions</h5>
            <label for="minimum_number_of_factions">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_factions}"
              onInput="${this.onMinimumNumberOfFactions}"
              min="0"
              max="7"
              pattern="[0-9]+"
              id="minimum_number_of_factions"
              name="minimum_number_of_factions"
            />
            <label for="maximum_number_of_factions"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_factions}"
              onInput="${this.onMaximumNumberOfFactions}"
              min="0"
              max="7"
              pattern="[0-9]+"
              id="maximum_number_of_factions"
              name="maximum_number_of_factions"
            />
            <label for="maximum_number_of_factions"> factions. </label> <br />

            <h5>Faction types probability</h5>
            <label for="cults_probability"> Cults ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.cults_probability}"
              onInput="${this.onCultsProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="cults_probability"
              name="cults_probability"
            />

            <label for="militias_probability"> Militias ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.militias_probability}"
              onInput="${this.onMilitiasProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="militias_probability"
              name="militias_probability"
            />
            <h4>Tweaks and Experiments</h4>
            <label for="treasure_factor"> Treasure Factor ${"T\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="decimal"
              value="${g.treasure_factor}"
              onInput="${this.onTreasureFactor}"
              min="0.001"
              max="10"
              pattern="[0-9.]+"
              id="treasure_factor"
              name="treasure_factor"
            />
          </form>
        </div>
      </div>`:html$$module$dialogs``}}var module$dialogs={};module$dialogs.GenerateRealmDialog=GenerateRealmDialog$$module$dialogs;const html$$module$hexview=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class Slider$$module$hexview extends k$$module$libs$preact{constructor(){super();this.state={transition:"hidden"}}componentDidMount(a,g,p){0==this.props.switch?this.setState({visible:!1,transition:"hidden"}):this.setState({visible:!0,transition:"visible"})}componentWillUpdate(a){if(this.props.switch!=a.switch){window.clearTimeout(this.interval);0==a.switch?this.setState({transition:"hidden"}):this.setState({transition:"visible"});var g=this;a.keep||(0==a.switch?this.interval=window.setTimeout(function(){g.setState({visible:!1})},
500):g.setState({visible:!0}))}}render(a,g){return html$$module$hexview`<div id="${a.id}" class="${g.transition}">
      ${g.visible?a.visible():html$$module$hexview``}
    </div> `}}class Toggles$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({visible:!0})}onLock(){this.setState({visible:!this.state.visible})}render(a,g){return html$$module$hexview`
      <div>
        <div style="display:inline-block; width:1.5em;">
          <a title="Map Toggles" onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${"fa-toggle-on"}"></i>
          </a>
        </div>
        <${Slider$$module$hexview}
          id="toggle-labels"
          switch=${!g.visible}
          visible=${()=>html$$module$hexview`
              <a title="Toggle Labels" onClick="${()=>a.onToggleLabels()}"
                ><i class="fa fa-solid fa-eye"></i>
              </a>
              <a
                title="Toggle Map Colors"
                onClick="${()=>a.onTogglePalette()}"
                ><i class="fa fa-solid fa-palette"></i>
              </a>
              ${is_electron$$module$api_shim||html$$module$hexview`<a
                title=${a.vttLive?"Switch VTT Off":"Switch VTT On"}
                onClick="${()=>a.onVtt()}"
                ><i
                  style="${a.vttLive&&"color: #df286d"}"
                  class="fa fa-solid fa-share-nodes"
                ></i>
              </a>`}
            `}
        />
      </div>
    `}}
class Toolbar$$module$hexview extends k$$module$libs$preact{constructor(){super();this.state={locked:!0}}componentWillUpdate(a){1==a.hidden&&0==this.props.hidden&&this.setState({locked:!0});"edit"==a.mode&&this.state.locked&&this.setState({locked:!1});this.setState({in_edit:"edit"==a.mode})}onLock(){this.setState({locked:!this.state.locked});if(this.state.locked)document.querySelectorAll(".btn-icon-hidden").forEach(function(a){a.classList.replace("btn-icon-hidden","btn-icon")});else if(document.querySelectorAll(".btn-icon").forEach(function(a){a.classList.replace("btn-icon","btn-icon-hidden")}),
this.state.in_edit)this.props.onEndEdit()}render(a,g){return is_electron$$module$api_shim?html$$module$hexview``:html$$module$hexview`
      <div id="header-menu">
        <div style="display:inline-block; width:1.5em;">
          <a
            title=${g.locked?"Unlock this page":"Lock this page"}
            onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${g.locked?"fa-lock":"fa-lock-open"}"></i>
          </a>
        </div>
        <${Slider$$module$hexview}
          id="drawer-append2"
          switch=${!g.locked}
          visible=${()=>html$$module$hexview`
              <a
                title="Reroll this page"
                class="${g.in_edit&&"disabled"}"
                onclick="${()=>a.onReroll()}"
                ><i class="fa fa-dice"></i
              ></a>
              <a
                title="Edit this page"
                class="${(g.in_edit||"coords"==a.type)&&"disabled"}"
                onclick="${()=>{this.setState({in_edit:!0});a.onEdit()}}"
                ><i class="fa fa-feather"></i
              ></a>
            `}
        />
      </div>
    `}}class Drawer$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({locked:window.app.locked})}onLock(){window.app.locked=!window.app.locked;this.setState({locked:window.app.locked});this.props.onLock(window.app.locked)}render(a,g){return html$$module$hexview`
      <div>
        <div style="display:inline-block; width:1.5em;">
          <a title=${g.locked?"Unlock sandbox for editing":"Lock sandbox for editing"} onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${g.locked?"fa-lock":"fa-lock-open"}"></i>
          </a>
        </div>
        <${Slider$$module$hexview}
          id="drawer-append"
          switch=${!g.locked}
          visible=${()=>html$$module$hexview` <a
              title="Roll a Realm"
              onClick="${()=>a.onAppend()}"
              ><i class="fa fa-solid fa-circle-plus"></i>
            </a>`}
        />
      </div>
    `}}
class EntityEditor$$module$hexview extends k$$module$libs$preact{constructor(){super()}componentDidMount(a,g,p){this.editor=tinymce.init({relative_urls:!1,document_base_url:"https://dev.hexroll.app",content_css:"/editor.css",selector:"textarea#entity_editor",promotion:!1,menubar:!1,statusbar:!1,height:"100%",toolbar:"undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | bullist | link | image | save",plugins:"advlist link image lists table fullscreen save image",save_onsavecallback:()=>
this.props.onSave()}).then(()=>{this.props.onEditorActive()})}componentWillUnmount(){tinymce.remove()}render(a){return html$$module$hexview`<textarea id="entity_editor" name="editor"></textarea>`}}
class HexView$$module$hexview extends k$$module$libs$preact{constructor(){super();this.state={html:"",coords:{},appending:!1,waiting:!0,toggle:1,map_locked:!0,show_labels:!0,desaturate_palette:!1,showReadme:!1,showTokenChooser:!1,packaging:!1,snackbar:!1,backpack_link:null,ephemeral:!1,modalOn:!1,activateEditor:!1,vtt_live:!1};this.onLock=this.onLock.bind(this);this.closeSnackbar=this.closeSnackbar.bind(this);this.appendCall=this.appendCall.bind(this);this.appendDialog=this.appendDialog.bind(this);
this.onToggleLabels=this.onToggleLabels.bind(this);this.onTogglePalette=this.onTogglePalette.bind(this);this.onEditorActive=this.onEditorActive.bind(this);this.setEditorValue=this.setEditorValue.bind(this);this.reroll=this.reroll.bind(this);this.append=this.append.bind(this);this.onReadme=this.onReadme.bind(this);this.toggleSpinner=this.toggleSpinner.bind(this);this.spinners=[!1,!1];this.forceRefresh=!1}toggleModal(){this.setState({modalOn:!this.state.modalOn})}spinnerState(a,g){this.spinners[a]=
g;return this.spinners[0]||this.spinners[1]}toggleSpinner(a,g){this.setState({waiting:this.spinnerState(a,g)})}setEditorValue(a){this.editor_v=a}onEditorActive(){tinymce.activeEditor.setContent(this.editor_v);tinymce.activeEditor.undoManager.clear()}navigatedToOceanHexOnMount(){return"coords"==this.props.type?(this.get_ocean(),this.map.postMapLoaded(()=>{const a=parse_canonical_coords$$module$utils(this.props.hex_uuid);this.map.map_data.addOceanHex(a.x,a.y);this.map.navigateToHex(this.props.hex_uuid)}),
!0):!1}gotEntityForEditingOnMount(){return"edit"==this.props.mode?(this.get_entity(this.props.hex_uuid,this.setEditorValue,!0),!0):!1}componentDidMount(a,g,p){"vtt"==this.props.mode?window.app.vtt_on(this.props.instance):window.app.vtt_referee=!0;this.props.hex_uuid&&(this.navigatedToOceanHexOnMount()||this.gotEntityForEditingOnMount()||this.get_entity(this.props.hex_uuid,this.setEditorValue));this.map&&this.map.sizeToFit();"append"==this.props.mode&&(this.toggleSpinner(0,!1),this.toggleSpinner(1,
!1));api_call_version$$module$api_shim(this.props.instance).then(t=>{this.setState({BACKEND_BUILD_ID:t.build})});is_electron$$module$api_shim||fetch("/mode/"+this.props.instance,{method:"GET"}).then(t=>t.json()).then(t=>{this.setState({ephemeral:t.ephemeral})}).catch(t=>{console.error("Error:",t)})}componentDidUpdate(a){if(this.props.hex_uuid)if("coords"==this.props.type)this.get_ocean();else{if(this.props.hex_uuid!=a.hex_uuid||this.forceRefresh)this.get_entity(this.props.hex_uuid,this.setEditorValue),
this.forceRefresh=!1}else this.map.sizeToFit();a.mode!=this.props.mode&&("edit"==a.mode&&this.setState({activateEditor:!1}),void 0!=this.props.hex_uuid&&("coords"==this.props.type?this.get_ocean():this.get_entity(this.props.hex_uuid,this.setEditorValue)))}componentWillUpdate(a){"append"==a.mode&&(this.spinners[0]=!1,this.spinners[1]=!1)}crossDissolve(a){let g=document.getElementById("entity"+this.toggle);this.toggle=1==this.toggle?2:1;let p=document.getElementById("entity"+this.toggle);p&&(p.innerHTML=
a);p&&this.toolbar.state.locked&&p.querySelectorAll(".btn-icon").forEach(function(t){t.classList.replace("btn-icon","btn-icon-hidden")});p&&p.classList.remove("hidden");g&&g.classList.add("hidden");window.clearTimeout(this.entity_timeout);this.entity_timeout=window.setTimeout(()=>{g&&(g.innerHTML="")},1E3);return p}get_ocean(){this.crossDissolve("Reroll this hex to generate its content.");const a=`
      <span class="breadcrumbs">
        <a href="/sandbox/${this.props.instance}">SANDBOX</a>
      </span>
      <br />
      The Vast Ocean
    `;document.getElementById("hex_title").innerHTML=a}get_entity(a,g,p=!1){0==this.forceRefresh&&(document.getElementById("entity1")&&document.getElementById("entity1").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),document.getElementById("entity2")&&document.getElementById("entity2").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}));let t=document.implementation.createHTMLDocument();p&&api_call_html$$module$api_shim("view",this.props.instance,a).then(A=>{t.open();
t.write(A);t.close();t.getElementById("title")&&(A=t.getElementById("title").innerHTML,document.getElementById("hex_title").innerHTML=A)});api_call_html$$module$api_shim(this.props.mode,this.props.instance,a).then(A=>{var D=this.crossDissolve(A);if(document.getElementById("title")){var F=document.getElementById("title").innerHTML;document.getElementById("title").remove();document.getElementById("hex_title").innerHTML=F}this.props.npc&&(F=document.getElementById(this.props.npc))&&F.scrollIntoView(!0);
if(D||"edit"==this.props.mode)if(D=D?D.getElementsByClassName("map-coords")[0]:t.getElementsByClassName("map-coords")[0])if(D.hasAttribute("hex")){const K=D.getAttribute("hex"),H=D.getAttribute("x"),J=D.getAttribute("y"),I=D.getAttribute("zoom");this.map.postMapLoaded(()=>{this.map.navigateToHex(K,{x:H,y:J,zoom:I})})}else this.map.postMapLoaded(()=>{this.map.navigateToRealm(a)});g&&"edit"==this.props.mode&&(g(A),this.setState({activateEditor:!0}))})}edit(a){$$$module$libs$preact_router_module("/sandbox/"+
this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid+"/edit")}onEditorSave(a){a||tinymce.activeEditor.isDirty()?this.override(tinymce.activeEditor.getContent(),()=>{this.setState({activateEditor:!1});$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid)}):(this.setState({activateEditor:!1}),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/"+this.props.type+"/"+this.props.hex_uuid))}override(a,g){fetch("/override/",
{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:this.props.hex_uuid,content:a})}).then(p=>p.text()).then(p=>{g()}).catch(p=>{console.error("Error:",p)})}append(a,g,p){fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:g,type:p})}).then(t=>t.text()).then(t=>{this.map.getMatrix(!0)}).catch(t=>
{console.error("Error:",t)})}reroll(a,g,p){if(!window.app.inhibit_rerolls)if("coords"==this.props.type)(g=this.map.map_data.getHexDataByUUID(this.props.hex_uuid))&&this.appendCall("OceanHex",null,"ocean",g.x,g.y);else{this.toggleSpinner(0,!0);p=document.getElementsByClassName("fa-dice");for(let A of p)A.classList.add("rolled");window.app.inhibit_rerolls=!0;var t=this;void 0===a&&(a=this.props.hex_uuid);void 0===g&&(g="default");fetch("/reroll/"+this.props.instance+"/"+a+"/"+g,{method:"GET"}).then(A=>
401===A.status?(window.app.unauth(),Promise.reject(A)):A.json()).then(A=>{let D=!1;for(const [,F]of window.app.reroll_handlers)F(),D=!0;D||this.map.getMatrix(!0);a==this.props.hex_uuid?$$$module$libs$preact_router_module("/sandbox/"+t.props.instance+"/"+t.props.type+"/"+A.uuid,!0):(this.forceRefresh=!0,void 0!==t.props.type&&$$$module$libs$preact_router_module("/sandbox/"+t.props.instance+"/"+t.props.type+"/"+this.props.hex_uuid,!0));window.app.inhibit_rerolls=!1;this.toggleSpinner(0,!1)}).catch(A=>
{this.toggleSpinner(0,!1);window.app.inhibit_rerolls=!1;console.error("Error:",A)})}}appendCall(a,g,p="realms",t=null,A=null){this.toggleSpinner(0,!0);"realms"==p&&$$$module$libs$preact_router_module("/sandbox/"+this.props.instance);this.toggleSpinner(0,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:this.props.instance,attribute:p,type:a,nx:this.menu?this.menu.nx:t,ny:this.menu?this.menu.ny:
A,params:JSON.stringify(g)})}).then(D=>D.json()).then(D=>{this.setState({appending:!1,waiting:this.spinnerState(0,!1)});this.props.hex_uuid&&this.map.postMapLoaded(()=>{$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+D.uuid,!0)});this.map.getMatrix(!0)}).catch(D=>{console.error("Error:",D)})}appendDialog(a){this.menu=a?a:null;$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/append");this.setState({appending:!0,waiting:this.spinnerState(0,!1)})}onReadme(){this.setState({showReadme:!this.state.showReadme})}onCtrlMode(a){this.setState({ctrl_mode:a})}showTokenChooser(a){this.tokens_callback=
a;this.setState({showTokenChooser:!this.state.showTokenChooser})}onLock(a){this.setState({map_locked:a})}onExit(){window.api.quit()}closeSnackbar(){this.setState({snackbar:!1})}onPatreon(){window.location.href="/claim/"+this.props.instance}onDownload(){this.setState({packaging:!0,snackbar:!0});fetch("/pack/"+this.props.instance,{method:"GET"}).then(a=>a.json()).then(a=>{this.setState({packaging:!1,backpack_link:a.filename,snackbar:!0})}).catch(a=>{this.setState({packaging:!1,backpack_link:null,snackbar:!0});
console.error("Error:",a)})}onToggleLabels(a){this.setState({show_labels:!this.state.show_labels})}onTogglePalette(a){this.setState({desaturate_palette:!this.state.desaturate_palette})}onVtt(){window.app.vtt_on(this.props.instance);let a=10;const g=window.setInterval(()=>{!this.state.vtt_live&&window.app.provider&&window.app.provider.signalingConns[0].connected?(this.setState({show_vtt_message:!0,vtt_live:!this.state.vtt_live}),window.clearInterval(g)):this.state.vtt_live&&!window.app.provider?(this.setState({show_vtt_message:!0,
vtt_live:!this.state.vtt_live}),window.clearInterval(g)):0==a--&&window.clearInterval(g)},1E3)}render(a,g){const p=a.hex_uuid&&"vtt"!=a.mode?"view_visible":"view_hidden",t="append"==a.mode?html$$module$hexview`
            <${GenerateRealmDialog$$module$dialogs}
              ref=${D=>this.dialog=D}
              toggleModal=${()=>this.toggleModal()}
              instance=${a.instance}
              onOkay=${this.appendCall}
            />
          `:html$$module$hexview``,A=g.showReadme?html$$module$hexview`
          <${ReadmeDialog$$module$readme}
            toggleModal=${()=>this.toggleModal()}
            onExit=${this.onReadme}
          />
        `:html$$module$hexview``;return html$$module$hexview`
      ${t} ${A}
      <${g.show_vtt_message&&VttDialog$$module$readme}
        toggleModal=${()=>this.toggleModal()}
        instance=${a.instance}
        onExit=${()=>this.setState({show_vtt_message:!1})}
      />
      <${g.showTokenChooser&&TokenChooserDialog$$module$readme}
        toggleModal=${()=>this.toggleModal()}
        callback=${this.tokens_callback}
        onExit=${()=>this.showTokenChooser()}
      />
      <div id="header" class="${p}">
        <h4>
          <div id="hex_title">Loading...<br /><br /></div>
          <${Toolbar$$module$hexview}
            ref=${D=>this.toolbar=D}
            onEdit=${()=>this.edit()}
            onEndEdit=${()=>this.onEditorSave()}
            onReroll=${this.reroll}
            onLock=${this.onLock}
            mode=${a.mode}
            type=${a.type}
            hidden=${!a.hex_uuid}
          />
        </h4>
      </div>
      <div
        style="color: #000000; opacity: 0.5; font-size:0.5em; z-index: 999909; position: fixed; bottom: 6px; right: 10px;"
      >
        <a onClick=${this.onReadme}> <strong> HEXROLL 2nd Edition </strong> </a
        >| ALPHA | frontend build: ${BUILD_ID$$module$version} | backend build:
        ${g.BACKEND_BUILD_ID}
      </div>
      <${"vtt"==a.mode?VttHexMap$$module$hexmap:HexMap$$module$hexmap}
        visible="true"
        ref=${D=>this.map=D}
        instance="${a.instance}"
        wuuid=""
        locked=${g.map_locked}
        hex_uuid="${a.hex_uuid}"
        area_uuid="${a.area_uuid}"
        coords=${g.coords}
        show_labels=${g.show_labels}
        desaturate_palette=${g.desaturate_palette}
        appendDialog=${this.appendDialog}
        spinner=${this.toggleSpinner}
        ctrlMode=${D=>{this.onCtrlMode(D)}}
        vtt=${"vtt"==a.mode}
      />
      <div id="content" class="${p}">
        <${Slider$$module$hexview}
          id="search"
          switch=${!a.hex_uuid&&g.map_locked&&!g.modalOn&&"vtt"!=a.mode&&!g.ctrl_mode&&!g.waiting}
          visible=${()=>html$$module$hexview` <${SearchBar$$module$search} instance="${a.instance}" /> `}
        />
        <${Slider$$module$hexview}
          id="patreon-button"
          switch=${!a.hex_uuid&&g.ephemeral&&!is_electron$$module$api_shim&&!g.modalOn&&"vtt"!=a.mode&&!g.ctrl_mode&&!g.waiting}
          visible=${()=>html$$module$hexview` <a
              title="Patreon members - login to bind with your sandbox"
              onClick="${()=>this.onPatreon()}"
              ><i class="fa-brands fa-patreon"></i>
            </a>`}
        />
        <${Slider$$module$hexview}
          id="download-button"
          switch=${!a.hex_uuid&&!g.packaging&&!is_electron$$module$api_shim&&!g.modalOn&&"vtt"!=a.mode&&!g.ctrl_mode&&!g.waiting}
          visible=${()=>html$$module$hexview` <a
              title="Package & Download"
              onClick="${()=>this.onDownload()}"
              ><i class="fa fa-solid fa-circle-down"></i>
            </a>`}
        />
        <${Slider$$module$hexview}
          id="toggles-menu"
          switch=${!a.hex_uuid&&!g.modalOn&&"vtt"!=a.mode&&!g.ctrl_mode&&!g.waiting}
          visible=${()=>html$$module$hexview`
              <${Toggles$$module$hexview}
                onToggleLabels=${this.onToggleLabels}
                onTogglePalette=${this.onTogglePalette}
                vttLive=${g.vtt_live}
                onVtt=${()=>{this.onVtt()}}
              />
            `}
        />
        <${Slider$$module$hexview}
          id="drawer-menu"
          switch=${!a.hex_uuid&&!is_electron$$module$api_shim&&!g.modalOn&&"vtt"!=a.mode&&!g.ctrl_mode&&!g.waiting}
          visible=${()=>html$$module$hexview`
              <${Drawer$$module$hexview} onAppend=${this.appendDialog} onLock=${this.onLock} />
            `}
        />
        <${Slider$$module$hexview}
          id="exit-button"
          switch=${!a.hex_uuid&&is_electron$$module$api_shim&&!g.modalOn&&!g.waiting}
          visible=${()=>html$$module$hexview`
              <a onClick="${()=>this.onExit()}"
                ><i class="fa fa-solid fa-circle-xmark"></i>
              </a>
            `}
        />
        <${Slider$$module$hexview}
          id="backpacker-snackbar"
          switch=${g.snackbar}
          visible=${()=>g.packaging?html$$module$hexview`
                  <div>
                    <i class="fa fa-solid fa-gear animated-gear"></i>
                    Hexroll is now casting a <em>Package Sandbox</em> spell.
                    <br />
                    You will find the download link here in a few moments.
                  </div>
                `:g.backpack_link?html$$module$hexview`
                  <div>
                    <div class="snackbar-close">
                      <a onClick="${this.closeSnackbar}">
                        <i class="fa fa-solid fa-xmark"></i
                      ></a>
                    </div>
                    Your Hexroll Backpack file is ready to
                    <a href="${g.backpack_link}">download now</a>
                  </div>
                `:html$$module$hexview`
                  <div>
                    We had a problem packing your sandbox. <br />This will be
                    looked into and you will be contacted soon.
                  </div>
                `}
        />
        ${g.waiting?html$$module$hexview`
              <${Spinner$$module$spinner}
                width="100px"
                style="position:fixed; z-index:101000; left:2em; bottom: 2em;"
              />
            `:html$$module$hexview``}
        <div
          style="z-index:0;"
          id="entity-container"
          class="${p} ${"edit"==a.mode&&"but_full_width"}"
        >
          ${g.activateEditor?html$$module$hexview`<${EntityEditor$$module$hexview}
                onSave=${()=>this.onEditorSave(!0)}
                onEditorActive=${this.onEditorActive}
              />`:html$$module$hexview`
                <div style="z-index:-1;position:absolute;" id="entity1"></div>
                <div
                  style="z-index:-1;position:absolute;"
                  id="entity2"
                  class="hidden"
                ></div>
              `}
        </div>
      </div>
    `}}var module$hexview={};module$hexview.HexView=HexView$$module$hexview;var t$$module$libs$history_production_min;!function(a){a.Pop="POP";a.Push="PUSH";a.Replace="REPLACE"}(t$$module$libs$history_production_min||={});
function e$$module$libs$history_production_min(a={}){function g(){let {pathname:ba,search:fa,hash:R}=K.location,da=H.state||{};return[da.idx,{pathname:ba,search:fa,hash:R,state:da.usr||null,key:da.key||"default"}]}function p(ba){return"string"==typeof ba?ba:c$$module$libs$history_production_min(ba)}function t(ba,fa=null){return Object.assign(Object.assign({pathname:T.pathname,hash:"",search:""},"string"==typeof ba?u$$module$libs$history_production_min(ba):ba),{state:fa,key:o$$module$libs$history_production_min()})}
function A(ba,fa,R){return!W.length||(W.call({action:ba,location:fa,retry:R}),!1)}function D(ba){I=ba;[N,T]=g();O.call({action:I,location:T})}function F(ba){H.go(ba)}let {window:K=document.defaultView}=a,H=K.history,J=null;K.addEventListener("popstate",function(){if(J)W.call(J),J=null;else{let ba=t$$module$libs$history_production_min.Pop,[fa,R]=g();if(W.length){if(null!=fa){let da=N-fa;da&&(J={action:ba,location:R,retry(){F(-1*da)}},F(da))}}else D(ba)}});let I=t$$module$libs$history_production_min.Pop,
[N,T]=g(),O=i$$module$libs$history_production_min(),W=i$$module$libs$history_production_min();return null==N&&(N=0,H.replaceState(Object.assign(Object.assign({},H.state),{idx:N}),"")),{get action(){return I},get location(){return T},createHref:p,push:function da(fa,R){let ha=t$$module$libs$history_production_min.Push,ma=t(fa,R);if(A(ha,ma,function(){da(fa,R)})){let [ka,pa]=[{usr:ma.state,key:ma.key,idx:N+1},p(ma)];try{H.pushState(ka,"",pa)}catch(la){K.location.assign(pa)}D(ha)}},replace:function ha(R,
da){let ma=t$$module$libs$history_production_min.Replace,ka=t(R,da);if(A(ma,ka,function(){ha(R,da)})){let [pa,la]=[{usr:ka.state,key:ka.key,idx:N},p(ka)];H.replaceState(pa,"",la);D(ma)}},go:F,back(){F(-1)},forward(){F(1)},listen:R=>O.push(R),block(R){let da=W.push(R);return 1===W.length&&K.addEventListener("beforeunload",l$$module$libs$history_production_min),function(){da();W.length||K.removeEventListener("beforeunload",l$$module$libs$history_production_min)}}}}
function n$$module$libs$history_production_min(a={}){function g(){let {pathname:fa="/",search:R="",hash:da=""}=u$$module$libs$history_production_min(H.location.hash.substr(1)),ha=J.state||{};return[ha.idx,{pathname:fa,search:R,hash:da,state:ha.usr||null,key:ha.key||"default"}]}function p(){if(I)ba.call(I),I=null;else{let fa=t$$module$libs$history_production_min.Pop,[R,da]=g();if(ba.length){if(null!=R){let ha=T-R;ha&&(I={action:fa,location:da,retry(){K(-1*ha)}},K(ha))}}else F(fa)}}function t(fa){var R=
document.querySelector("base"),da="";R&&R.getAttribute("href")&&(R=H.location.href,da=R.indexOf("#"),da=-1===da?R:R.slice(0,da));return da+"#"+("string"==typeof fa?fa:c$$module$libs$history_production_min(fa))}function A(fa,R=null){return Object.assign(Object.assign({pathname:O.pathname,hash:"",search:""},"string"==typeof fa?u$$module$libs$history_production_min(fa):fa),{state:R,key:o$$module$libs$history_production_min()})}function D(fa,R,da){return!ba.length||(ba.call({action:fa,location:R,retry:da}),
!1)}function F(fa){N=fa;[T,O]=g();W.call({action:N,location:O})}function K(fa){J.go(fa)}let {window:H=document.defaultView}=a,J=H.history,I=null;H.addEventListener("popstate",p);H.addEventListener("hashchange",()=>{let [,fa]=g();c$$module$libs$history_production_min(fa)!==c$$module$libs$history_production_min(O)&&p()});let N=t$$module$libs$history_production_min.Pop,[T,O]=g(),W=i$$module$libs$history_production_min(),ba=i$$module$libs$history_production_min();return null==T&&(T=0,J.replaceState(Object.assign(Object.assign({},
J.state),{idx:T}),"")),{get action(){return N},get location(){return O},createHref:t,push:function ha(R,da){let ma=t$$module$libs$history_production_min.Push,ka=A(R,da);if(D(ma,ka,function(){ha(R,da)})){let [pa,la]=[{usr:ka.state,key:ka.key,idx:T+1},t(ka)];try{J.pushState(pa,"",la)}catch(ta){H.location.assign(la)}F(ma)}},replace:function ma(da,ha){let ka=t$$module$libs$history_production_min.Replace,pa=A(da,ha);if(D(ka,pa,function(){ma(da,ha)})){let [la,ta]=[{usr:pa.state,key:pa.key,idx:T},t(pa)];
J.replaceState(la,"",ta);F(ka)}},go:K,back(){K(-1)},forward(){K(1)},listen:da=>W.push(da),block(da){let ha=ba.push(da);return 1===ba.length&&H.addEventListener("beforeunload",l$$module$libs$history_production_min),function(){ha();ba.length||H.removeEventListener("beforeunload",l$$module$libs$history_production_min)}}}}
function a$$module$libs$history_production_min(a={}){function g(O,W=null){return Object.assign(Object.assign({pathname:I.pathname,search:"",hash:""},"string"==typeof O?u$$module$libs$history_production_min(O):O),{state:W,key:o$$module$libs$history_production_min()})}function p(O,W,ba){return!T.length||(T.call({action:O,location:W,retry:ba}),!1)}function t(O,W){J=O;I=W;N.call({action:J,location:I})}function A(O){let W=r$$module$libs$history_production_min(H+O,0,K.length-1),ba=t$$module$libs$history_production_min.Pop,
fa=K[W];p(ba,fa,function(){A(O)})&&(H=W,t(ba,fa))}let {initialEntries:D=["/"],initialIndex:F}=a,K=D.map(O=>Object.assign({pathname:"/",search:"",hash:"",state:null,key:o$$module$libs$history_production_min()},"string"==typeof O?u$$module$libs$history_production_min(O):O)),H=r$$module$libs$history_production_min(null==F?K.length-1:F,0,K.length-1),J=t$$module$libs$history_production_min.Pop,I=K[H],N=i$$module$libs$history_production_min(),T=i$$module$libs$history_production_min();return{get index(){return H},
get action(){return J},get location(){return I},createHref:function(O){return"string"==typeof O?O:c$$module$libs$history_production_min(O)},push:function fa(W,ba){let R=t$$module$libs$history_production_min.Push,da=g(W,ba);p(R,da,function(){fa(W,ba)})&&(H+=1,K.splice(H,K.length,da),t(R,da))},replace:function R(ba,fa){let da=t$$module$libs$history_production_min.Replace,ha=g(ba,fa);p(da,ha,function(){R(ba,fa)})&&(K[H]=ha,t(da,ha))},go:A,back(){A(-1)},forward(){A(1)},listen:ba=>N.push(ba),block:ba=>
T.push(ba)}}function r$$module$libs$history_production_min(a,g,p){return Math.min(Math.max(a,g),p)}function l$$module$libs$history_production_min(a){a.preventDefault();a.returnValue=""}function i$$module$libs$history_production_min(){let a=[];return{get length(){return a.length},push:g=>(a.push(g),function(){a=a.filter(p=>p!==g)}),call(g){a.forEach(p=>p&&p(g))}}}function o$$module$libs$history_production_min(){return Math.random().toString(36).substr(2,8)}
function c$$module$libs$history_production_min({pathname:a="/",search:g="",hash:p=""}){return g&&"?"!==g&&(a+="?"===g.charAt(0)?g:"?"+g),p&&"#"!==p&&(a+="#"===p.charAt(0)?p:"#"+p),a}function u$$module$libs$history_production_min(a){let g={};if(a){var p=a.indexOf("#");0<=p&&(g.hash=a.substr(p),a=a.substr(0,p));p=a.indexOf("?");0<=p&&(g.search=a.substr(p),a=a.substr(0,p));a&&(g.pathname=a)}return g}var module$libs$history_production_min={};module$libs$history_production_min.Action=t$$module$libs$history_production_min;
module$libs$history_production_min.createBrowserHistory=e$$module$libs$history_production_min;module$libs$history_production_min.createHashHistory=n$$module$libs$history_production_min;module$libs$history_production_min.createMemoryHistory=a$$module$libs$history_production_min;module$libs$history_production_min.createPath=c$$module$libs$history_production_min;module$libs$history_production_min.parsePath=u$$module$libs$history_production_min;const html$$module$code=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class YMock$$module$code{constructor(){this.map=new Map}observe(a){}unobserve(a){}get(a){return this.map.get(a)}set(a,g){this.map.set(a,g)}}
class App$$module$code extends k$$module$libs$preact{constructor(){super();this.state={mode:"hexmap",hexlist:[],borders:[],unauth:!1};this.theme=is_electron$$module$api_shim?"hexroll-default-theme.svg?"+BUILD_ID$$module$version:"/hexroll-default-theme.svg?"+BUILD_ID$$module$version;this.tokens_svg="/tokens.svg?"+BUILD_ID$$module$version;window.main=this;window.app=this;this.last_uuid=this.map2=null;this.inhibit_rerolls=this.inhibit_click=!1;this.settlements_cache={};this.locked=!0;this.tokens=new Map;
this.yarray=new YMock$$module$code;this.zarray=new YMock$$module$code;this.reroll_handlers=new Map;this.ydoc=new Doc$$module$libs$y_webrtc_min;this.yarray=this.ydoc.get("map",YMap$$module$libs$y_webrtc_min);this.zarray=this.ydoc.get("tokeninstances",YMap$$module$libs$y_webrtc_min)}vtt_on(a){this.provider?(this.ydoc.destroy(),this.provider.disconnect(),this.provider=null):this.provider=new WebrtcProvider$$module$libs$y_webrtc_min(a,this.ydoc,{signaling:["wss://vtt.hexroll.app:4444"]})}hideMap(){this.minimap||
(this.minimap=!0,document.getElementById("content").style.display="block",document.getElementById("entity-container").style.display="block",this.map.setState({col1:"rect1"}))}showMap(){this.setState({mode:"hexmap"});this.minimap&&(this.minimap=!1,document.getElementById("content").style.display="none",document.getElementById("entity").innerHTML="",this.map.setState({col1:"col1"}))}reroll(a){this.map.reroll(a,"default")}reroll_ex(a,g,p){this.map.reroll(a,g,p)}append(a,g,p){this.map.append(a,g,p)}unauth(){this.setState({unauth:!0})}onAuthAck(){this.setState({unauth:!1})}render(){const a=
this.state.unauth?html$$module$code`
          <div id="myModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
              <div class="close">
                <a onClick="${()=>this.onAuthAck()}"> ${"\u00d7"} </a>
              </div>
              <h5>Hello Adventurer!</h5>
              <p>
                You are currently using an ephemeral sandbox. Ephemeral
                sandboxes have a 1,000,000 gp credit limit and are not
                guaranteed to stay online.
              </p>
              <p>
                If you are a Patreon subscriber, make sure you are logged in to
                claim this sandbox and enjoy an unlimited credit as well as
                online storage and cloud backup.
              </p>
            </div>
          </div>
        `:html$$module$code``;return html$$module$code`
      ${a}
      <${D$$module$libs$preact_router_module} history=${is_electron$$module$api_shim?n$$module$libs$history_production_min():void 0}>
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="normal"
         path="/"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="normal"
         path="/sandbox/:instance"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="normal"
         path="/vtt/:instance"
         mode="vtt"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="append"
         path="/sandbox/:instance/append"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/sandbox/:instance/:type/:hex_uuid/edit"
         mode="edit"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/vtt/:instance/:type/:hex_uuid/"
         mode="vtt"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/sandbox/:instance/:type/:hex_uuid/"
         mode="view"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/sandbox/:instance/:type/:hex_uuid/npc/:npc"
       />
      </${D$$module$libs$preact_router_module}>
    `}}let app$$module$code;B$$module$libs$preact(html$$module$code`<${App$$module$code} ref=${a=>app$$module$code=a} />`,document.getElementById("app"));var module$code={};
