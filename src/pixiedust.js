class Queue$$module$libs$polylabel{constructor(a=[],g=defaultCompare$$module$libs$polylabel){this.data=a;this.length=this.data.length;this.compare=g;if(0<this.length)for(a=(this.length>>1)-1;0<=a;a--)this._down(a)}push(a){this.data.push(a);this._up(this.length++)}pop(){if(0!==this.length){var a=this.data[0],g=this.data.pop();0<--this.length&&(this.data[0]=g,this._down(0));return a}}peek(){return this.data[0]}_up(a){const {data:g,compare:q}=this,u=g[a];for(;0<a;){const B=a-1>>1,E=g[B];if(0<=q(u,E))break;
g[a]=E;a=B}g[a]=u}_down(a){const {data:g,compare:q}=this,u=this.length>>1,B=g[a];for(;a<u;){let E=(a<<1)+1;const F=E+1;F<this.length&&0>q(g[F],g[E])&&(E=F);if(0<=q(g[E],B))break;g[a]=g[E];a=E}g[a]=B}}function defaultCompare$$module$libs$polylabel(a,g){return a<g?-1:a>g?1:0}
function polylabel$$module$libs$polylabel(a,g,q){g=g||1;for(var u,B,E,F,K=0;K<a[0].length;K++){var I=a[0][K];if(!K||I[0]<u)u=I[0];if(!K||I[1]<B)B=I[1];if(!K||I[0]>E)E=I[0];if(!K||I[1]>F)F=I[1]}var J=E-u,H=F-B,N=Math.min(J,H);I=N/2;if(0===N)return a=[u,B],a.distance=0,a;K=new Queue$$module$libs$polylabel(void 0,compareMax$$module$libs$polylabel);for(var T=u;T<E;T+=N)for(var O=B;O<F;O+=N)K.push(new Cell$$module$libs$polylabel(T+I,O+I,I,a));E=getCentroidCell$$module$libs$polylabel(a);u=new Cell$$module$libs$polylabel(u+
J/2,B+H/2,0,a);u.d>E.d&&(E=u);for(u=K.length;K.length;)B=K.pop(),B.d>E.d&&(E=B,q&&console.log("found best %f after %d probes",Math.round(1E4*B.d)/1E4,u)),B.max-E.d<=g||(I=B.h/2,K.push(new Cell$$module$libs$polylabel(B.x-I,B.y-I,I,a)),K.push(new Cell$$module$libs$polylabel(B.x+I,B.y-I,I,a)),K.push(new Cell$$module$libs$polylabel(B.x-I,B.y+I,I,a)),K.push(new Cell$$module$libs$polylabel(B.x+I,B.y+I,I,a)),u+=4);q&&(console.log("num probes: "+u),console.log("best distance: "+E.d));a=[E.x,E.y];a.distance=
E.d;return a}function compareMax$$module$libs$polylabel(a,g){return g.max-a.max}function Cell$$module$libs$polylabel(a,g,q,u){this.x=a;this.y=g;this.h=q;this.d=pointToPolygonDist$$module$libs$polylabel(a,g,u);this.max=this.d+this.h*Math.SQRT2}
function pointToPolygonDist$$module$libs$polylabel(a,g,q){for(var u=!1,B=Infinity,E=0;E<q.length;E++)for(var F=q[E],K=0,I=F.length,J=I-1;K<I;J=K++){var H=F[K];J=F[J];H[1]>g!==J[1]>g&&a<(J[0]-H[0])*(g-H[1])/(J[1]-H[1])+H[0]&&(u=!u);B=Math.min(B,getSegDistSq$$module$libs$polylabel(a,g,H,J))}return 0===B?0:(u?1:-1)*Math.sqrt(B)}
function getCentroidCell$$module$libs$polylabel(a){for(var g=0,q=0,u=0,B=a[0],E=0,F=B.length,K=F-1;E<F;K=E++){var I=B[E];K=B[K];var J=I[0]*K[1]-K[0]*I[1];q+=(I[0]+K[0])*J;u+=(I[1]+K[1])*J;g+=3*J}return 0===g?new Cell$$module$libs$polylabel(B[0][0],B[0][1],0,a):new Cell$$module$libs$polylabel(q/g,u/g,0,a)}
function getSegDistSq$$module$libs$polylabel(a,g,q,u){var B=q[0];q=q[1];var E=u[0]-B,F=u[1]-q;if(0!==E||0!==F){var K=((a-B)*E+(g-q)*F)/(E*E+F*F);1<K?(B=u[0],q=u[1]):0<K&&(B+=E*K,q+=F*K)}E=a-B;F=g-q;return E*E+F*F}var module$libs$polylabel={};module$libs$polylabel.polylabel=polylabel$$module$libs$polylabel;var n$$module$libs$htm=function(a,g,q,u){var B;g[0]=0;for(var E=1;E<g.length;E++){var F=g[E++],K=g[E]?(g[0]|=F?1:2,q[g[E++]]):g[++E];3===F?u[0]=K:4===F?u[1]=Object.assign(u[1]||{},K):5===F?(u[1]=u[1]||{})[g[++E]]=K:6===F?u[1][g[++E]]+=K+"":F?(B=a.apply(K,n$$module$libs$htm(a,K,q,["",null])),u.push(B),K[0]?g[0]|=2:(g[E-2]=0,g[E]=B)):u.push(K)}return u},t$$module$libs$htm=new Map,$jscompDefaultExport$$module$libs$htm=function(a){var g=t$$module$libs$htm.get(this);return g||(g=new Map,t$$module$libs$htm.set(this,
g)),1<(g=n$$module$libs$htm(this,g.get(a)||(g.set(a,g=function(q){for(var u,B,E=1,F="",K="",I=[0],J=function(T){1===E&&(T||(F=F.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?I.push(0,T,F):3===E&&(T||F)?(I.push(3,T,F),E=2):2===E&&"..."===F&&T?I.push(4,T,0):2===E&&F&&!T?I.push(5,0,!0,F):5<=E&&((F||!T&&5===E)&&(I.push(E,0,F,B),E=6),T&&(I.push(E,T,0,B),E=6));F=""},H=0;H<q.length;H++){H&&(1===E&&J(),J(H));for(var N=0;N<q[H].length;N++)u=q[H][N],1===E?"<"===u?(J(),I=[I],E=3):F+=u:4===E?"--"===F&&">"===u?(E=1,F=
""):F=u+F[0]:K?u===K?K="":F+=u:'"'===u||"'"===u?K=u:">"===u?(J(),E=1):E&&("="===u?(E=5,B=F,F=""):"/"===u&&(5>E||">"===q[H][N+1])?(J(),3===E&&(I=I[0]),E=I,(I=I[0]).push(2,0,E),E=0):" "===u||"\t"===u||"\n"===u||"\r"===u?(J(),E=2):F+=u),3===E&&"!--"===F&&(E=4,I=I[0])}return J(),I}(a)),g),arguments,[])).length?g:g[0]},module$libs$htm={};module$libs$htm.default=$jscompDefaultExport$$module$libs$htm;var n$$module$libs$preact,l$$module$libs$preact,u$$module$libs$preact,i$$module$libs$preact,t$$module$libs$preact,r$$module$libs$preact,o$$module$libs$preact,f$$module$libs$preact,e$$module$libs$preact,c$$module$libs$preact={},s$$module$libs$preact=[],a$$module$libs$preact=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h$$module$libs$preact(a,g){for(var q in g)a[q]=g[q];return a}function v$$module$libs$preact(a){var g=a.parentNode;g&&g.removeChild(a)}
function y$$module$libs$preact(a,g,q){var u,B,E,F={};for(E in g)"key"==E?u=g[E]:"ref"==E?B=g[E]:F[E]=g[E];if(2<arguments.length&&(F.children=3<arguments.length?n$$module$libs$preact.call(arguments,2):q),"function"==typeof a&&null!=a.defaultProps)for(E in a.defaultProps)void 0===F[E]&&(F[E]=a.defaultProps[E]);return p$$module$libs$preact(a,F,u,B,null)}
function p$$module$libs$preact(a,g,q,u,B){a={type:a,props:g,key:q,ref:u,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==B?++u$$module$libs$preact:B};return null==B&&null!=l$$module$libs$preact.vnode&&l$$module$libs$preact.vnode(a),a}function d$$module$libs$preact(){return{current:null}}function _$$module$libs$preact(a){return a.children}function k$$module$libs$preact(a,g){this.props=a;this.context=g}
function b$$module$libs$preact(a,g){if(null==g)return a.__?b$$module$libs$preact(a.__,a.__.__k.indexOf(a)+1):null;for(var q;g<a.__k.length;g++)if(null!=(q=a.__k[g])&&null!=q.__e)return q.__e;return"function"==typeof a.type?b$$module$libs$preact(a):null}function g$$module$libs$preact(a){var g,q;if(null!=(a=a.__)&&null!=a.__c){a.__e=a.__c.base=null;for(g=0;g<a.__k.length;g++)if(null!=(q=a.__k[g])&&null!=q.__e){a.__e=a.__c.base=q.__e;break}return g$$module$libs$preact(a)}}
function m$$module$libs$preact(a){(!a.__d&&(a.__d=!0)&&t$$module$libs$preact.push(a)&&!w$$module$libs$preact.__r++||r$$module$libs$preact!==l$$module$libs$preact.debounceRendering)&&((r$$module$libs$preact=l$$module$libs$preact.debounceRendering)||o$$module$libs$preact)(w$$module$libs$preact)}
function w$$module$libs$preact(){var a,g,q,u,B,E,F,K;for(t$$module$libs$preact.sort(f$$module$libs$preact);a=t$$module$libs$preact.shift();)a.__d&&(g=t$$module$libs$preact.length,u=void 0,B=void 0,F=(E=(q=a).__v).__e,(K=q.__P)&&(u=[],(B=h$$module$libs$preact({},E)).__v=E.__v+1,L$$module$libs$preact(K,E,B,q.__n,void 0!==K.ownerSVGElement,null!=E.__h?[F]:null,u,null==F?b$$module$libs$preact(E):F,E.__h),M$$module$libs$preact(u,E),E.__e!=F&&g$$module$libs$preact(E)),t$$module$libs$preact.length>g&&t$$module$libs$preact.sort(f$$module$libs$preact));
w$$module$libs$preact.__r=0}
function x$$module$libs$preact(a,g,q,u,B,E,F,K,I,J){var H,N,T,O,W,ba,fa=u&&u.__k||s$$module$libs$preact,R=fa.length;q.__k=[];for(H=0;H<g.length;H++)if(null!=(O=q.__k[H]=null==(O=g[H])||"boolean"==typeof O||"function"==typeof O?null:"string"==typeof O||"number"==typeof O||"bigint"==typeof O?p$$module$libs$preact(null,O,null,null,O):Array.isArray(O)?p$$module$libs$preact(_$$module$libs$preact,{children:O},null,null,null):0<O.__b?p$$module$libs$preact(O.type,O.props,O.key,O.ref?O.ref:null,O.__v):O)){if(O.__=
q,O.__b=q.__b+1,null===(T=fa[H])||T&&O.key==T.key&&O.type===T.type)fa[H]=void 0;else for(N=0;N<R;N++){if((T=fa[N])&&O.key==T.key&&O.type===T.type){fa[N]=void 0;break}T=null}L$$module$libs$preact(a,O,T=T||c$$module$libs$preact,B,E,F,K,I,J);var da=O.__e;(N=O.ref)&&T.ref!=N&&(ba||=[],T.ref&&ba.push(T.ref,null,O),ba.push(N,O.__c||da,O));null!=da?(null==W&&(W=da),"function"==typeof O.type&&O.__k===T.__k?O.__d=I=A$$module$libs$preact(O,I,a):I=C$$module$libs$preact(a,O,T,fa,da,I),"function"==typeof q.type&&
(q.__d=I)):I&&T.__e==I&&I.parentNode!=a&&(I=b$$module$libs$preact(T))}q.__e=W;for(H=R;H--;)null!=fa[H]&&("function"==typeof q.type&&null!=fa[H].__e&&fa[H].__e==q.__d&&(q.__d=$$$module$libs$preact(u).nextSibling),S$$module$libs$preact(fa[H],fa[H]));if(ba)for(H=0;H<ba.length;H++)O$$module$libs$preact(ba[H],ba[++H],ba[++H])}
function A$$module$libs$preact(a,g,q){for(var u,B=a.__k,E=0;B&&E<B.length;E++)(u=B[E])&&(u.__=a,g="function"==typeof u.type?A$$module$libs$preact(u,g,q):C$$module$libs$preact(q,u,u,B,u.__e,g));return g}function P$$module$libs$preact(a,g){return g=g||[],null==a||"boolean"==typeof a||(Array.isArray(a)?a.some(function(q){P$$module$libs$preact(q,g)}):g.push(a)),g}
function C$$module$libs$preact(a,g,q,u,B,E){if(void 0!==g.__d){var F=g.__d;g.__d=void 0}else if(null==q||B!=E||null==B.parentNode)a:if(null==E||E.parentNode!==a)a.appendChild(B),F=null;else{g=E;for(q=0;(g=g.nextSibling)&&q<u.length;q+=1)if(g==B)break a;a.insertBefore(B,E);F=E}return void 0!==F?F:B.nextSibling}
function $$$module$libs$preact(a){var g,q,u;if(null==a.type||"string"==typeof a.type)return a.__e;if(a.__k)for(g=a.__k.length-1;0<=g;g--)if((q=a.__k[g])&&(u=$$$module$libs$preact(q)))return u;return null}function H$$module$libs$preact(a,g,q,u,B){for(var E in q)"children"===E||"key"===E||E in g||T$$module$libs$preact(a,E,null,q[E],u);for(E in g)B&&"function"!=typeof g[E]||"children"===E||"key"===E||"value"===E||"checked"===E||q[E]===g[E]||T$$module$libs$preact(a,E,g[E],q[E],u)}
function I$$module$libs$preact(a,g,q){"-"===g[0]?a.setProperty(g,null==q?"":q):a[g]=null==q?"":"number"!=typeof q||a$$module$libs$preact.test(g)?q:q+"px"}
function T$$module$libs$preact(a,g,q,u,B){a:if("style"===g)if("string"==typeof q)a.style.cssText=q;else{if("string"==typeof u&&(a.style.cssText=u=""),u)for(g in u)q&&g in q||I$$module$libs$preact(a.style,g,"");if(q)for(g in q)u&&q[g]===u[g]||I$$module$libs$preact(a.style,g,q[g])}else if("o"===g[0]&&"n"===g[1])B=g!==(g=g.replace(/Capture$/,"")),g=g.toLowerCase()in a?g.toLowerCase().slice(2):g.slice(2),a.l||(a.l={}),(a.l[g+B]=q)?u||a.addEventListener(g,B?z$$module$libs$preact:j$$module$libs$preact,
B):a.removeEventListener(g,B?z$$module$libs$preact:j$$module$libs$preact,B);else if("dangerouslySetInnerHTML"!==g){if(B)g=g.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==g&&"height"!==g&&"href"!==g&&"list"!==g&&"form"!==g&&"tabIndex"!==g&&"download"!==g&&g in a)try{a[g]=null==q?"":q;break a}catch(E){}"function"==typeof q||(null==q||!1===q&&-1==g.indexOf("-")?a.removeAttribute(g):a.setAttribute(g,q))}}
function j$$module$libs$preact(a){return this.l[a.type+!1](l$$module$libs$preact.event?l$$module$libs$preact.event(a):a)}function z$$module$libs$preact(a){return this.l[a.type+!0](l$$module$libs$preact.event?l$$module$libs$preact.event(a):a)}
function L$$module$libs$preact(a,g,q,u,B,E,F,K,I){var J,H,N,T,O,W,ba,fa,R,da,ha,ma,ka,pa,la=g.type;if(void 0!==g.constructor)return null;null!=q.__h&&(I=q.__h,K=g.__e=q.__e,g.__h=null,E=[K]);(J=l$$module$libs$preact.__b)&&J(g);try{a:if("function"==typeof la){if(fa=g.props,R=(J=la.contextType)&&u[J.__c],da=J?R?R.props.value:J.__:u,q.__c?ba=(H=g.__c=q.__c).__=H.__E:("prototype"in la&&la.prototype.render?g.__c=H=new la(fa,da):(g.__c=H=new k$$module$libs$preact(fa,da),H.constructor=la,H.render=q$$module$libs$preact),
R&&R.sub(H),H.props=fa,H.state||(H.state={}),H.context=da,H.__n=u,N=H.__d=!0,H.__h=[],H._sb=[]),null==H.__s&&(H.__s=H.state),null!=la.getDerivedStateFromProps&&(H.__s==H.state&&(H.__s=h$$module$libs$preact({},H.__s)),h$$module$libs$preact(H.__s,la.getDerivedStateFromProps(fa,H.__s))),T=H.props,O=H.state,H.__v=g,N)null==la.getDerivedStateFromProps&&null!=H.componentWillMount&&H.componentWillMount(),null!=H.componentDidMount&&H.__h.push(H.componentDidMount);else{if(null==la.getDerivedStateFromProps&&
fa!==T&&null!=H.componentWillReceiveProps&&H.componentWillReceiveProps(fa,da),!H.__e&&null!=H.shouldComponentUpdate&&!1===H.shouldComponentUpdate(fa,H.__s,da)||g.__v===q.__v){g.__v!==q.__v&&(H.props=fa,H.state=H.__s,H.__d=!1);H.__e=!1;g.__e=q.__e;g.__k=q.__k;g.__k.forEach(function(wa){wa&&(wa.__=g)});for(ha=0;ha<H._sb.length;ha++)H.__h.push(H._sb[ha]);H._sb=[];H.__h.length&&F.push(H);break a}null!=H.componentWillUpdate&&H.componentWillUpdate(fa,H.__s,da);null!=H.componentDidUpdate&&H.__h.push(function(){H.componentDidUpdate(T,
O,W)})}if(H.context=da,H.props=fa,H.__P=a,ma=l$$module$libs$preact.__r,ka=0,"prototype"in la&&la.prototype.render){H.state=H.__s;H.__d=!1;ma&&ma(g);J=H.render(H.props,H.state,H.context);for(pa=0;pa<H._sb.length;pa++)H.__h.push(H._sb[pa]);H._sb=[]}else{do H.__d=!1,ma&&ma(g),J=H.render(H.props,H.state,H.context),H.state=H.__s;while(H.__d&&25>++ka)}H.state=H.__s;null!=H.getChildContext&&(u=h$$module$libs$preact(h$$module$libs$preact({},u),H.getChildContext()));N||null==H.getSnapshotBeforeUpdate||(W=
H.getSnapshotBeforeUpdate(T,O));var ta=null!=J&&J.type===_$$module$libs$preact&&null==J.key?J.props.children:J;x$$module$libs$preact(a,Array.isArray(ta)?ta:[ta],g,q,u,B,E,F,K,I);H.base=g.__e;g.__h=null;H.__h.length&&F.push(H);ba&&(H.__E=H.__=null);H.__e=!1}else null==E&&g.__v===q.__v?(g.__k=q.__k,g.__e=q.__e):g.__e=N$$module$libs$preact(q.__e,g,q,u,B,E,F,I);(J=l$$module$libs$preact.diffed)&&J(g)}catch(wa){g.__v=null,(I||null!=E)&&(g.__e=K,g.__h=!!I,E[E.indexOf(K)]=null),l$$module$libs$preact.__e(wa,
g,q)}}function M$$module$libs$preact(a,g){l$$module$libs$preact.__c&&l$$module$libs$preact.__c(g,a);a.some(function(q){try{a=q.__h,q.__h=[],a.some(function(u){u.call(q)})}catch(u){l$$module$libs$preact.__e(u,q.__v)}})}
function N$$module$libs$preact(a,g,q,u,B,E,F,K){var I,J,H=q.props,N=g.props,T=g.type,O=0;if("svg"===T&&(B=!0),null!=E)for(;O<E.length;O++)if((I=E[O])&&"setAttribute"in I==!!T&&(T?I.localName===T:3===I.nodeType)){a=I;E[O]=null;break}if(null==a){if(null===T)return document.createTextNode(N);a=B?document.createElementNS("http://www.w3.org/2000/svg",T):document.createElement(T,N.is&&N);E=null;K=!1}if(null===T)H===N||K&&a.data===N||(a.data=N);else{if(E=E&&n$$module$libs$preact.call(a.childNodes),I=(H=
q.props||c$$module$libs$preact).dangerouslySetInnerHTML,J=N.dangerouslySetInnerHTML,!K){if(null!=E)for(H={},O=0;O<a.attributes.length;O++)H[a.attributes[O].name]=a.attributes[O].value;(J||I)&&(J&&(I&&J.__html==I.__html||J.__html===a.innerHTML)||(a.innerHTML=J&&J.__html||""))}if(H$$module$libs$preact(a,N,H,B,K),J)g.__k=[];else if(O=g.props.children,x$$module$libs$preact(a,Array.isArray(O)?O:[O],g,q,u,B&&"foreignObject"!==T,E,F,E?E[0]:q.__k&&b$$module$libs$preact(q,0),K),null!=E)for(O=E.length;O--;)null!=
E[O]&&v$$module$libs$preact(E[O]);K||("value"in N&&void 0!==(O=N.value)&&(O!==a.value||"progress"===T&&!O||"option"===T&&O!==H.value)&&T$$module$libs$preact(a,"value",O,H.value,!1),"checked"in N&&void 0!==(O=N.checked)&&O!==a.checked&&T$$module$libs$preact(a,"checked",O,H.checked,!1))}return a}function O$$module$libs$preact(a,g,q){try{"function"==typeof a?a(g):a.current=g}catch(u){l$$module$libs$preact.__e(u,q)}}
function S$$module$libs$preact(a,g,q){var u,B;if(l$$module$libs$preact.unmount&&l$$module$libs$preact.unmount(a),(u=a.ref)&&(u.current&&u.current!==a.__e||O$$module$libs$preact(u,null,g)),null!=(u=a.__c)){if(u.componentWillUnmount)try{u.componentWillUnmount()}catch(E){l$$module$libs$preact.__e(E,g)}u.base=u.__P=null;a.__c=void 0}if(u=a.__k)for(B=0;B<u.length;B++)u[B]&&S$$module$libs$preact(u[B],g,q||"function"!=typeof a.type);q||null==a.__e||v$$module$libs$preact(a.__e);a.__=a.__e=a.__d=void 0}
function q$$module$libs$preact(a,g,q){return this.constructor(a,q)}
function B$$module$libs$preact(a,g,q){var u;l$$module$libs$preact.__&&l$$module$libs$preact.__(a,g);var B=(u="function"==typeof q)?null:q&&q.__k||g.__k;var E=[];L$$module$libs$preact(g,a=(!u&&q||g).__k=y$$module$libs$preact(_$$module$libs$preact,null,[a]),B||c$$module$libs$preact,c$$module$libs$preact,void 0!==g.ownerSVGElement,!u&&q?[q]:B?null:g.firstChild?n$$module$libs$preact.call(g.childNodes):null,E,!u&&q?q:B?B.__e:g.firstChild,u);M$$module$libs$preact(E,a)}
function D$$module$libs$preact(a,g){B$$module$libs$preact(a,g,D$$module$libs$preact)}function E$$module$libs$preact(a,g,q){var u,B,E,F=h$$module$libs$preact({},a.props);for(E in g)"key"==E?u=g[E]:"ref"==E?B=g[E]:F[E]=g[E];return 2<arguments.length&&(F.children=3<arguments.length?n$$module$libs$preact.call(arguments,2):q),p$$module$libs$preact(a.type,F,u||a.key,B||a.ref,null)}
function F$$module$libs$preact(a,g){var q={__c:g="__cC"+e$$module$libs$preact++,__:a,Consumer:function(u,B){return u.children(B)},Provider:function(u){var B,E;return this.getChildContext||(B=[],(E={})[g]=this,this.getChildContext=function(){return E},this.shouldComponentUpdate=function(F){this.props.value!==F.value&&B.some(function(K){K.__e=!0;m$$module$libs$preact(K)})},this.sub=function(F){B.push(F);var K=F.componentWillUnmount;F.componentWillUnmount=function(){B.splice(B.indexOf(F),1);K&&K.call(F)}}),
u.children}};return q.Provider.__=q.Consumer.contextType=q}n$$module$libs$preact=s$$module$libs$preact.slice;l$$module$libs$preact={__e:function(a,g,q,u){for(var B,E,F;g=g.__;)if((B=g.__c)&&!B.__)try{if((E=B.constructor)&&null!=E.getDerivedStateFromError&&(B.setState(E.getDerivedStateFromError(a)),F=B.__d),null!=B.componentDidCatch&&(B.componentDidCatch(a,u||{}),F=B.__d),F)return B.__E=B}catch(K){a=K}throw a;}};u$$module$libs$preact=0;i$$module$libs$preact=function(a){return null!=a&&void 0===a.constructor};
k$$module$libs$preact.prototype.setState=function(a,g){var q=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=h$$module$libs$preact({},this.state);"function"==typeof a&&(a=a(h$$module$libs$preact({},q),this.props));a&&h$$module$libs$preact(q,a);null!=a&&this.__v&&(g&&this._sb.push(g),m$$module$libs$preact(this))};k$$module$libs$preact.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),m$$module$libs$preact(this))};k$$module$libs$preact.prototype.render=_$$module$libs$preact;
t$$module$libs$preact=[];o$$module$libs$preact="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout;f$$module$libs$preact=function(a,g){return a.__v.__b-g.__v.__b};e$$module$libs$preact=w$$module$libs$preact.__r=0;var module$libs$preact={};module$libs$preact.Component=k$$module$libs$preact;module$libs$preact.Fragment=_$$module$libs$preact;module$libs$preact.cloneElement=E$$module$libs$preact;module$libs$preact.createContext=F$$module$libs$preact;
module$libs$preact.createElement=y$$module$libs$preact;module$libs$preact.createRef=d$$module$libs$preact;module$libs$preact.h=y$$module$libs$preact;module$libs$preact.hydrate=D$$module$libs$preact;module$libs$preact.isValidElement=i$$module$libs$preact;module$libs$preact.options=l$$module$libs$preact;module$libs$preact.render=B$$module$libs$preact;module$libs$preact.toChildArray=P$$module$libs$preact;const html$$module$readme=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class ReadmeDialog$$module$readme extends k$$module$libs$preact{constructor(){super()}render(a,g){return html$$module$readme` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <div class="close">
            <a onClick="${a.onExit}"> ${"\u00d7"} </a>
          </div>
          <h5>Credits</h5>
          <p>
            HEXROLL is developed by Ithai Levi as part of Pen, Dice & Paper, a
            family project dedicated to tabletop role-playing games.
          </p>
          <p>
            This project was made possible thanks to the incredible support I've
            been getting from the Pen Dice & Paper
            <strong> Patreon community </strong>. Thank you folks for walking
            side by side with me.
          </p>
          <p>
            The support and kind words in the forums, subreddits and online
            groups keeps me super motivated. Thank you! folks.
          </p>
          <p>
            Thanks also goes to HEXROLL 1e Github contributors for their help
            extending and tuning the original model.
          </p>
          <p>
            And last, but certainly not least, thank you! Oleg Doyla, aka
            Watabou for your incredible city and village generators, powering
            HEXROLL's settlement generator.
          </p>
          <h5>Licenses</h5>

          <h6>Designation of Open Game Content</h6>
          This document contains Open Game Content, subject to the Open Game
          License, released under the Open Game License, Version 1.0a
          (reproduced below), as described in Section 1(d) of the License. All
          other content in this generated sandbox remains the property of the
          copyright holder. Sandbox content not covered by the OGL is licensed
          under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0
          International license (CC BY-NC-SA 4.0)

          <h6>OPEN GAME LICENSE Version 1.0a</h6>

          <p>
            The following text is the property of Wizards of the Coast, Inc. and
            is Copyright 2000 Wizards of the Coast, Inc ("Wizards"). All Rights
            Reserved.
          </p>

          <p>
            1. Definitions: (a)"Contributors" means the copyright and/or
            trademark owners who have contributed Open Game Content;
            (b)"Derivative Material" means copyrighted material including
            derivative works and translations (including into other computer
            languages), potation, modification, correction, addition, extension,
            upgrade, improvement, compilation, abridgment or other form in which
            an existing work may be recast, transformed or adapted; (c)
            "Distribute" means to reproduce, license, rent, lease, sell,
            broadcast, publicly display, transmit or otherwise distribute;
            (d)"Open Game Content" means the game mechanic and includes the
            methods, procedures, processes and routines to the extent such
            content does not embody the Product Identity and is an enhancement
            over the prior art and any additional content clearly identified as
            Open Game Content by the Contributor, and means any work covered by
            this License, including translations and derivative works under
            copyright law, but specifically excludes Product Identity. (e)
            "Product Identity" means product and product line names, logos and
            identifying marks including trade dress; artifacts; creatures
            characters; stories, storylines, plots, thematic elements, dialogue,
            incidents, language, artwork, symbols, designs, depictions,
            likenesses, formats, poses, concepts, themes and graphic,
            photographic and other visual or audio representations; names and
            descriptions of characters, spells, enchantments, personalities,
            teams, personas, likenesses and special abilities; places,
            locations, environments, creatures, equipment, magical or
            supernatural abilities or effects, logos, symbols, or graphic
            designs; and any other trademark or registered trademark clearly
            identified as Product identity by the owner of the Product Identity,
            and which specifically excludes the Open Game Content; (f)
            "Trademark" means the logos, names, mark, sign, motto, designs that
            are used by a Contributor to identify itself or its products or the
            associated products contributed to the Open Game License by the
            Contributor (g) "Use", "Used" or "Using" means to use, Distribute,
            copy, edit, format, modify, translate and otherwise create
            Derivative Material of Open Game Content. (h) "You" or "Your" means
            the licensee in terms of this agreement.
          </p>

          <p>
            2. The License: This License applies to any Open Game Content that
            contains a notice indicating that the Open Game Content may only be
            Used under and in terms of this License. You must affix such a
            notice to any Open Game Content that you Use. No terms may be added
            to or subtracted from this License except as described by the
            License itself. No other terms or conditions may be applied to any
            Open Game Content distributed using this License.
          </p>

          <p>
            3. Offer and Acceptance: By Using the Open Game Content You indicate
            Your acceptance of the terms of this License.
          </p>

          <p>
            4. Grant and Consideration: In consideration for agreeing to use
            this License, the Contributors grant You a perpetual, worldwide,
            royalty-free, non-exclusive license with the exact terms of this
            License to Use, the Open Game Content.
          </p>

          <p>
            5. Representation of Authority to Contribute: If You are
            contributing original material as Open Game Content, You represent
            that Your Contributions are Your original creation and/or You have
            sufficient rights to grant the rights conveyed by this License.
          </p>

          <p>
            6. Notice of License Copyright: You must update the COPYRIGHT NOTICE
            portion of this License to include the exact text of the COPYRIGHT
            NOTICE of any Open Game Content You are copying, modifying or
            distributing, and You must add the title, the copyright date, and
            the copyright holder's name to the COPYRIGHT NOTICE of any original
            Open Game Content you Distribute.
          </p>

          <p>
            7. Use of Product Identity: You agree not to Use any Product
            Identity, including as an indication as to compatibility, except as
            expressly licensed in another, independent Agreement with the owner
            of each element of that Product Identity. You agree not to indicate
            compatibility or co-adaptability with any Trademark or Registered
            Trademark in conjunction with a work containing Open Game Content
            except as expressly licensed in another, independent Agreement with
            the owner of such Trademark or Registered Trademark. The use of any
            Product Identity in Open Game Content does not constitute a
            challenge to the ownership of that Product Identity. The owner of
            any Product Identity used in Open Game Content shall retain all
            rights, title and interest in and to that Product Identity.
          </p>

          <p>
            8. Identification: If you distribute Open Game Content You must
            clearly indicate which portions of the work that you are
            distributing are Open Game Content.
          </p>

          <p>
            9. Updating the License: Wizards or its designated Agents may
            publish updated versions of this License. You may use any authorized
            version of this License to copy, modify and distribute any Open Game
            Content originally distributed under any version of this License.
          </p>

          <p>
            10. Copy of this License: You MUST include a copy of this License
            with every copy of the Open Game Content You Distribute.
          </p>

          <p>
            11. Use of Contributor Credits: You may not market or advertise the
            Open Game Content using the name of any Contributor unless You have
            written permission from the Contributor to do so.
          </p>

          <p>
            12. Inability to Comply: If it is impossible for You to comply with
            any of the terms of this License with respect to some or all of the
            Open Game Content due to statute, judicial order, or governmental
            regulation then You may not Use any Open Game Material so affected.
          </p>

          <p>
            13. Termination: This License will terminate automatically if You
            fail to comply with all terms herein and fail to cure such breach
            within 30 days of becoming aware of the breach. All sublicenses
            shall survive the termination of this License.
          </p>

          <p>
            14. Reformation: If any provision of this License is held to be
            unenforceable, such provision shall be reformed only to the extent
            necessary to make it enforceable.
          </p>

          <p>
            15. COPYRIGHT NOTICE Open Game License v 1.0 Copyright 2000, Wizards
            of the Coast, Inc.
          </p>

          <p>Hexroll is copyright &copy; 2021-2023 pendicepaper.com.</p>
        </div>
      </div>`}}var module$readme={};module$readme.ReadmeDialog=ReadmeDialog$$module$readme;const is_electron$$module$api_shim=!0;function api_call_html$$module$api_shim(a,g,q){return new Promise(async u=>{let B=await window.api.get(q);u(B)})}function api_call_map$$module$api_shim(a){return new Promise(async g=>{let q=JSON.parse(await window.api.map());g(q)})}function api_call_dungeon$$module$api_shim(a,g){return new Promise(async q=>{let u=JSON.parse(await window.api.dungeon(g));q(u)})}
function api_call_city$$module$api_shim(a,g){return new Promise(async q=>{let u=JSON.parse(await window.api.city(g));q(u)})}function api_call_version$$module$api_shim(a){return new Promise(async g=>{g({})})}function api_call_search$$module$api_shim(a,g){return new Promise(async q=>{let u={};u.results=await window.api.search(g);q(u)})}var module$api_shim={};module$api_shim.api_call_city=api_call_city$$module$api_shim;module$api_shim.api_call_dungeon=api_call_dungeon$$module$api_shim;
module$api_shim.api_call_html=api_call_html$$module$api_shim;module$api_shim.api_call_map=api_call_map$$module$api_shim;module$api_shim.api_call_search=api_call_search$$module$api_shim;module$api_shim.api_call_version=api_call_version$$module$api_shim;module$api_shim.is_electron=is_electron$$module$api_shim;const BUILD_ID$$module$version="2309161201";var module$version={};module$version.BUILD_ID=BUILD_ID$$module$version;var t$$module$libs$hooks_module,r$$module$libs$hooks_module,u$$module$libs$hooks_module,i$$module$libs$hooks_module,o$$module$libs$hooks_module=0,f$$module$libs$hooks_module=[],c$$module$libs$hooks_module=[],e$$module$libs$hooks_module=l$$module$libs$preact.__b,a$$module$libs$hooks_module=l$$module$libs$preact.__r,v$$module$libs$hooks_module=l$$module$libs$preact.diffed,l$$module$libs$hooks_module=l$$module$libs$preact.__c,m$$module$libs$hooks_module=l$$module$libs$preact.unmount;
function d$$module$libs$hooks_module(a,g){l$$module$libs$preact.__h&&l$$module$libs$preact.__h(r$$module$libs$hooks_module,a,o$$module$libs$hooks_module||g);o$$module$libs$hooks_module=0;g=r$$module$libs$hooks_module.__H||(r$$module$libs$hooks_module.__H={__:[],__h:[]});return a>=g.__.length&&g.__.push({__V:c$$module$libs$hooks_module}),g.__[a]}function h$$module$libs$hooks_module(a){return o$$module$libs$hooks_module=1,s$$module$libs$hooks_module(B$$module$libs$hooks_module,a)}
function s$$module$libs$hooks_module(a,g,q){var u=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,2);if(u.t=a,!u.__c&&(u.__=[q?q(g):B$$module$libs$hooks_module(void 0,g),function(K){var I=u.__N?u.__N[0]:u.__[0];K=u.t(I,K);I!==K&&(u.__N=[K,u.__[1]],u.__c.setState({}))}],u.__c=r$$module$libs$hooks_module,!r$$module$libs$hooks_module.u)){var B=function(K,I,J){if(!u.__c.__H)return!0;var H=u.__c.__H.__.filter(function(T){return T.__c});if(H.every(function(T){return!T.__N}))return!E||E.call(this,
K,I,J);var N=!1;return H.forEach(function(T){if(T.__N){var O=T.__[0];T.__=T.__N;T.__N=void 0;O!==T.__[0]&&(N=!0)}}),!(!N&&u.__c.props===K)&&(!E||E.call(this,K,I,J))};r$$module$libs$hooks_module.u=!0;var E=r$$module$libs$hooks_module.shouldComponentUpdate,F=r$$module$libs$hooks_module.componentWillUpdate;r$$module$libs$hooks_module.componentWillUpdate=function(K,I,J){if(this.__e){var H=E;E=void 0;B(K,I,J);E=H}F&&F.call(this,K,I,J)};r$$module$libs$hooks_module.shouldComponentUpdate=B}return u.__N||
u.__}function p$$module$libs$hooks_module(a,g){var q=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,3);!l$$module$libs$preact.__s&&z$$module$libs$hooks_module(q.__H,g)&&(q.__=a,q.i=g,r$$module$libs$hooks_module.__H.__h.push(q))}function y$$module$libs$hooks_module(a,g){var q=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,4);!l$$module$libs$preact.__s&&z$$module$libs$hooks_module(q.__H,g)&&(q.__=a,q.i=g,r$$module$libs$hooks_module.__h.push(q))}
function _$$module$libs$hooks_module(a){return o$$module$libs$hooks_module=5,F$$module$libs$hooks_module(function(){return{current:a}},[])}function A$$module$libs$hooks_module(a,g,q){o$$module$libs$hooks_module=6;y$$module$libs$hooks_module(function(){return"function"==typeof a?(a(g()),function(){return a(null)}):a?(a.current=g(),function(){return a.current=null}):void 0},null==q?q:q.concat(a))}
function F$$module$libs$hooks_module(a,g){var q=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,7);return z$$module$libs$hooks_module(q.__H,g)?(q.__V=a(),q.i=g,q.__h=a,q.__V):q.__}function T$$module$libs$hooks_module(a,g){return o$$module$libs$hooks_module=8,F$$module$libs$hooks_module(function(){return a},g)}
function q$$module$libs$hooks_module(a){var g=r$$module$libs$hooks_module.context[a.__c],q=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,9);return q.c=a,g?(null==q.__&&(q.__=!0,g.sub(r$$module$libs$hooks_module)),g.props.value):a.__}function x$$module$libs$hooks_module(a,g){l$$module$libs$preact.useDebugValue&&l$$module$libs$preact.useDebugValue(g?g(a):a)}
function P$$module$libs$hooks_module(a){var g=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,10),q=h$$module$libs$hooks_module();return g.__=a,r$$module$libs$hooks_module.componentDidCatch||(r$$module$libs$hooks_module.componentDidCatch=function(u,B){g.__&&g.__(u,B);q[1](u)}),[q[0],function(){q[1](void 0)}]}
function V$$module$libs$hooks_module(){var a=d$$module$libs$hooks_module(t$$module$libs$hooks_module++,11);if(!a.__){for(var g=r$$module$libs$hooks_module.__v;null!==g&&!g.__m&&null!==g.__;)g=g.__;g=g.__m||(g.__m=[0,0]);a.__="P"+g[0]+"-"+g[1]++}return a.__}
function b$$module$libs$hooks_module(){for(var a;a=f$$module$libs$hooks_module.shift();)if(a.__P&&a.__H)try{a.__H.__h.forEach(k$$module$libs$hooks_module),a.__H.__h.forEach(w$$module$libs$hooks_module),a.__H.__h=[]}catch(g){a.__H.__h=[],l$$module$libs$preact.__e(g,a.__v)}}l$$module$libs$preact.__b=function(a){r$$module$libs$hooks_module=null;e$$module$libs$hooks_module&&e$$module$libs$hooks_module(a)};
l$$module$libs$preact.__r=function(a){a$$module$libs$hooks_module&&a$$module$libs$hooks_module(a);t$$module$libs$hooks_module=0;(a=(r$$module$libs$hooks_module=a.__c).__H)&&(u$$module$libs$hooks_module===r$$module$libs$hooks_module?(a.__h=[],r$$module$libs$hooks_module.__h=[],a.__.forEach(function(g){g.__N&&(g.__=g.__N);g.__V=c$$module$libs$hooks_module;g.__N=g.i=void 0})):(a.__h.forEach(k$$module$libs$hooks_module),a.__h.forEach(w$$module$libs$hooks_module),a.__h=[]));u$$module$libs$hooks_module=
r$$module$libs$hooks_module};
l$$module$libs$preact.diffed=function(a){v$$module$libs$hooks_module&&v$$module$libs$hooks_module(a);(a=a.__c)&&a.__H&&(a.__H.__h.length&&(1!==f$$module$libs$hooks_module.push(a)&&i$$module$libs$hooks_module===l$$module$libs$preact.requestAnimationFrame||((i$$module$libs$hooks_module=l$$module$libs$preact.requestAnimationFrame)||j$$module$libs$hooks_module)(b$$module$libs$hooks_module)),a.__H.__.forEach(function(g){g.i&&(g.__H=g.i);g.__V!==c$$module$libs$hooks_module&&(g.__=g.__V);g.i=void 0;g.__V=
c$$module$libs$hooks_module}));u$$module$libs$hooks_module=r$$module$libs$hooks_module=null};l$$module$libs$preact.__c=function(a,g){g.some(function(q){try{q.__h.forEach(k$$module$libs$hooks_module),q.__h=q.__h.filter(function(u){return!u.__||w$$module$libs$hooks_module(u)})}catch(u){g.some(function(B){B.__h&&(B.__h=[])}),g=[],l$$module$libs$preact.__e(u,q.__v)}});l$$module$libs$hooks_module&&l$$module$libs$hooks_module(a,g)};
l$$module$libs$preact.unmount=function(a){m$$module$libs$hooks_module&&m$$module$libs$hooks_module(a);var g;(a=a.__c)&&a.__H&&(a.__H.__.forEach(function(q){try{k$$module$libs$hooks_module(q)}catch(u){g=u}}),a.__H=void 0,g&&l$$module$libs$preact.__e(g,a.__v))};var g$$module$libs$hooks_module="function"==typeof requestAnimationFrame;
function j$$module$libs$hooks_module(a){var g,q=function(){clearTimeout(u);g$$module$libs$hooks_module&&cancelAnimationFrame(g);setTimeout(a)},u=setTimeout(q,100);g$$module$libs$hooks_module&&(g=requestAnimationFrame(q))}function k$$module$libs$hooks_module(a){var g=r$$module$libs$hooks_module,q=a.__c;"function"==typeof q&&(a.__c=void 0,q());r$$module$libs$hooks_module=g}function w$$module$libs$hooks_module(a){var g=r$$module$libs$hooks_module;a.__c=a.__();r$$module$libs$hooks_module=g}
function z$$module$libs$hooks_module(a,g){return!a||a.length!==g.length||g.some(function(q,u){return q!==a[u]})}function B$$module$libs$hooks_module(a,g){return"function"==typeof g?g(a):g}var module$libs$hooks_module={};module$libs$hooks_module.useCallback=T$$module$libs$hooks_module;module$libs$hooks_module.useContext=q$$module$libs$hooks_module;module$libs$hooks_module.useDebugValue=x$$module$libs$hooks_module;module$libs$hooks_module.useEffect=p$$module$libs$hooks_module;
module$libs$hooks_module.useErrorBoundary=P$$module$libs$hooks_module;module$libs$hooks_module.useId=V$$module$libs$hooks_module;module$libs$hooks_module.useImperativeHandle=A$$module$libs$hooks_module;module$libs$hooks_module.useLayoutEffect=y$$module$libs$hooks_module;module$libs$hooks_module.useMemo=F$$module$libs$hooks_module;module$libs$hooks_module.useReducer=s$$module$libs$hooks_module;module$libs$hooks_module.useRef=_$$module$libs$hooks_module;module$libs$hooks_module.useState=h$$module$libs$hooks_module;var a$$module$libs$preact_router_module={};function c$$module$libs$preact_router_module(a,g){for(var q in g)a[q]=g[q];return a}
function s$$module$libs$preact_router_module(a,g,q){var u=/(?:\?([^#]*))?(#.*)?$/,B=a.match(u),E={};if(B&&B[1]){B=B[1].split("&");for(var F=0;F<B.length;F++){var K=B[F].split("=");E[decodeURIComponent(K[0])]=decodeURIComponent(K.slice(1).join("="))}}a=d$$module$libs$preact_router_module(a.replace(u,""));g=d$$module$libs$preact_router_module(g||"");u=Math.max(a.length,g.length);for(B=0;B<u;B++)if(g[B]&&":"===g[B].charAt(0)){F=g[B].replace(/(^:|[+*?]+$)/g,"");K=(g[B].match(/[+*?]+$/)||a$$module$libs$preact_router_module)[0]||
"";var I=~K.indexOf("+"),J=~K.indexOf("*"),H=a[B]||"";if(!H&&!J&&(0>K.indexOf("?")||I)){var N=!1;break}if(E[F]=decodeURIComponent(H),I||J){E[F]=a.slice(B).map(decodeURIComponent).join("/");break}}else if(g[B]!==a[B]){N=!1;break}return(!0===q.default||!1!==N)&&E}function h$$module$libs$preact_router_module(a,g){return a.rank<g.rank?1:a.rank>g.rank?-1:a.index-g.index}
function v$$module$libs$preact_router_module(a,g){return a.index=g,a.rank=a.props.default?0:d$$module$libs$preact_router_module(a.props.path).map(l$$module$libs$preact_router_module).join(""),a.props}function d$$module$libs$preact_router_module(a){return a.replace(/(^\/+|\/+$)/g,"").split("/")}function l$$module$libs$preact_router_module(a){return":"==a.charAt(0)?1+"*+?".indexOf(a.charAt(a.length-1))||4:5}
var p$$module$libs$preact_router_module={},m$$module$libs$preact_router_module=[],y$$module$libs$preact_router_module=[],U$$module$libs$preact_router_module=null,g$$module$libs$preact_router_module={url:R$$module$libs$preact_router_module()},k$$module$libs$preact_router_module=F$$module$libs$preact(g$$module$libs$preact_router_module);
function C$$module$libs$preact_router_module(){var a=q$$module$libs$hooks_module(k$$module$libs$preact_router_module);if(a===g$$module$libs$preact_router_module){var g=h$$module$libs$hooks_module()[1];p$$module$libs$hooks_module(function(){return y$$module$libs$preact_router_module.push(g),function(){return y$$module$libs$preact_router_module.splice(y$$module$libs$preact_router_module.indexOf(g),1)}},[])}return[a,$$$module$libs$preact_router_module]}
function R$$module$libs$preact_router_module(){var a;return""+((a=U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module.location?U$$module$libs$preact_router_module.location:U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module.getCurrentLocation?U$$module$libs$preact_router_module.getCurrentLocation():"undefined"!=typeof location?location:p$$module$libs$preact_router_module).pathname||"")+(a.search||"")}
function $$$module$libs$preact_router_module(a,g){return void 0===g&&(g=!1),"string"!=typeof a&&a.url&&(g=a.replace,a=a.url),function(q){for(var u=m$$module$libs$preact_router_module.length;u--;)if(m$$module$libs$preact_router_module[u].canRoute(q))return!0;return!1}(a)&&function(q,u){void 0===u&&(u="push");U$$module$libs$preact_router_module&&U$$module$libs$preact_router_module[u]?U$$module$libs$preact_router_module[u](q):"undefined"!=typeof history&&history[u+"State"]&&history[u+"State"](null,null,
q)}(a,g?"replace":"push"),I$$module$libs$preact_router_module(a)}function I$$module$libs$preact_router_module(a){for(var g=!1,q=0;q<m$$module$libs$preact_router_module.length;q++)m$$module$libs$preact_router_module[q].routeTo(a)&&(g=!0);return g}function M$$module$libs$preact_router_module(a){if(a&&a.getAttribute){var g=a.getAttribute("href");a=a.getAttribute("target");if(g&&g.match(/^\//g)&&(!a||a.match(/^_?self$/i)))return $$$module$libs$preact_router_module(g)}}
function b$$module$libs$preact_router_module(a){return a.stopImmediatePropagation&&a.stopImmediatePropagation(),a.stopPropagation&&a.stopPropagation(),a.preventDefault(),!1}
function W$$module$libs$preact_router_module(a){if(!(a.ctrlKey||a.metaKey||a.altKey||a.shiftKey||a.button)){var g=a.target;do if("a"===g.localName&&g.getAttribute("href")){if(g.hasAttribute("data-native")||g.hasAttribute("native"))break;if(M$$module$libs$preact_router_module(g))return b$$module$libs$preact_router_module(a)}while(g=g.parentNode)}}var w$$module$libs$preact_router_module=!1;
function D$$module$libs$preact_router_module(a){a.history&&(U$$module$libs$preact_router_module=a.history);this.state={url:a.url||R$$module$libs$preact_router_module()}}
c$$module$libs$preact_router_module(D$$module$libs$preact_router_module.prototype=new k$$module$libs$preact,{shouldComponentUpdate:function(a){return!0!==a.static||a.url!==this.props.url||a.onChange!==this.props.onChange},canRoute:function(a){var g=P$$module$libs$preact(this.props.children);return void 0!==this.g(g,a)},routeTo:function(a){this.setState({url:a});a=this.canRoute(a);return this.p||this.forceUpdate(),a},componentWillMount:function(){this.p=!0},componentDidMount:function(){var a=this;
w$$module$libs$preact_router_module||(w$$module$libs$preact_router_module=!0,U$$module$libs$preact_router_module||addEventListener("popstate",function(){I$$module$libs$preact_router_module(R$$module$libs$preact_router_module())}),addEventListener("click",W$$module$libs$preact_router_module));m$$module$libs$preact_router_module.push(this);U$$module$libs$preact_router_module&&(this.u=U$$module$libs$preact_router_module.listen(function(g){g=g.location||g;a.routeTo(""+(g.pathname||"")+(g.search||""))}));
this.p=!1},componentWillUnmount:function(){"function"==typeof this.u&&this.u();m$$module$libs$preact_router_module.splice(m$$module$libs$preact_router_module.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(a,g){a=a.filter(v$$module$libs$preact_router_module).sort(h$$module$libs$preact_router_module);for(var q=0;q<a.length;q++){var u=a[q],B=s$$module$libs$preact_router_module(g,u.props.path,u.props);if(B)return[u,B]}},render:function(a,
g){var q,u,B=a.onChange,E=g.url;g=this.c;a=this.g(P$$module$libs$preact(a.children),E);if(a&&(u=E$$module$libs$preact(a[0],c$$module$libs$preact_router_module(c$$module$libs$preact_router_module({url:E,matches:q=a[1]},q),{key:void 0,ref:void 0}))),E!==(g&&g.url)){c$$module$libs$preact_router_module(g$$module$libs$preact_router_module,g=this.c={url:E,previous:g&&g.url,current:u,path:u?u.props.path:null,matches:q});g.router=this;g.active=u?[u]:[];for(q=y$$module$libs$preact_router_module.length;q--;)y$$module$libs$preact_router_module[q]({});
"function"==typeof B&&B(g)}return y$$module$libs$preact(k$$module$libs$preact_router_module.Provider,{value:g},u)}});var E$$module$libs$preact_router_module=function(a){return y$$module$libs$preact("a",c$$module$libs$preact_router_module({onClick:W$$module$libs$preact_router_module},a))},L$$module$libs$preact_router_module=function(a){return y$$module$libs$preact(a.component,a)},module$libs$preact_router_module={};module$libs$preact_router_module.Link=E$$module$libs$preact_router_module;
module$libs$preact_router_module.Route=L$$module$libs$preact_router_module;module$libs$preact_router_module.Router=D$$module$libs$preact_router_module;module$libs$preact_router_module.default=D$$module$libs$preact_router_module;module$libs$preact_router_module.exec=s$$module$libs$preact_router_module;module$libs$preact_router_module.getCurrentUrl=R$$module$libs$preact_router_module;module$libs$preact_router_module.route=$$$module$libs$preact_router_module;
module$libs$preact_router_module.useRouter=C$$module$libs$preact_router_module;/*
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource>  queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource>  safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource>  simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
const create$$module$libs$y_webrtc_min=()=>new Map,copy$$module$libs$y_webrtc_min=a=>{const g=create$$module$libs$y_webrtc_min();return a.forEach((q,u)=>{g.set(u,q)}),g},setIfUndefined$$module$libs$y_webrtc_min=(a,g,q)=>{let u=a.get(g);return void 0===u&&a.set(g,u=q()),u},create$1$$module$libs$y_webrtc_min=()=>new Set,last$$module$libs$y_webrtc_min=a=>a[a.length-1],appendTo$$module$libs$y_webrtc_min=(a,g)=>{for(let q=0;q<g.length;q++)a.push(g[q])},from$$module$libs$y_webrtc_min=Array.from,isArray$$module$libs$y_webrtc_min=
Array.isArray;
class Observable$$module$libs$y_webrtc_min{constructor(){this._observers=create$$module$libs$y_webrtc_min()}on(a,g){setIfUndefined$$module$libs$y_webrtc_min(this._observers,a,create$1$$module$libs$y_webrtc_min).add(g)}once(a,g){const q=(...u)=>{this.off(a,q);g(...u)};this.on(a,q)}off(a,g){const q=this._observers.get(a);void 0!==q&&(q.delete(g),0===q.size&&this._observers.delete(a))}emit(a,g){return from$$module$libs$y_webrtc_min((this._observers.get(a)||create$$module$libs$y_webrtc_min()).values()).forEach(q=>q(...g))}destroy(){this._observers=
create$$module$libs$y_webrtc_min()}}
const floor$$module$libs$y_webrtc_min=Math.floor,abs$$module$libs$y_webrtc_min=Math.abs,log10$$module$libs$y_webrtc_min=Math.log10,min$$module$libs$y_webrtc_min=(a,g)=>a<g?a:g,max$$module$libs$y_webrtc_min=(a,g)=>a>g?a:g,isNegativeZero$$module$libs$y_webrtc_min=a=>0!==a?0>a:0>1/a,getUnixTime$$module$libs$y_webrtc_min=Date.now,setupWS$$module$libs$y_webrtc_min=a=>{if(a.shouldConnect&&null===a.ws){const g=new WebSocket(a.url),q=a.binaryType;let u=null;q&&(g.binaryType=q);a.ws=g;a.connecting=!0;a.connected=
!1;g.onmessage=F=>{a.lastMessageReceived=getUnixTime$$module$libs$y_webrtc_min();F=F.data;(F="string"==typeof F?JSON.parse(F):F)&&"pong"===F.type&&(clearTimeout(u),u=setTimeout(E,15E3));a.emit("message",[F,a])};const B=F=>{null!==a.ws&&(a.ws=null,a.connecting=!1,a.connected?(a.connected=!1,a.emit("disconnect",[{type:"disconnect",error:F},a])):a.unsuccessfulReconnects++,setTimeout(setupWS$$module$libs$y_webrtc_min,min$$module$libs$y_webrtc_min(1200*log10$$module$libs$y_webrtc_min(a.unsuccessfulReconnects+
1),2500),a));clearTimeout(u)},E=()=>{a.ws===g&&a.send({type:"ping"})};g.onclose=()=>B(null);g.onerror=F=>B(F);g.onopen=()=>{a.lastMessageReceived=getUnixTime$$module$libs$y_webrtc_min();a.connecting=!1;a.connected=!0;a.unsuccessfulReconnects=0;a.emit("connect",[{type:"connect"},a]);u=setTimeout(E,15E3)}}};
class WebsocketClient$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,{binaryType:g}={}){super();this.url=a;this.ws=null;this.binaryType=g||null;this.connecting=this.connected=!1;this.lastMessageReceived=this.unsuccessfulReconnects=0;this.shouldConnect=!0;this._checkInterval=setInterval(()=>{this.connected&&3E4<getUnixTime$$module$libs$y_webrtc_min()-this.lastMessageReceived&&this.ws.close()},15E3);setupWS$$module$libs$y_webrtc_min(this)}send(a){this.ws&&this.ws.send(JSON.stringify(a))}destroy(){clearInterval(this._checkInterval);
this.disconnect();super.destroy()}disconnect(){this.shouldConnect=!1;null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0;this.connected||null!==this.ws||setupWS$$module$libs$y_webrtc_min(this)}}
const create$2$$module$libs$y_webrtc_min=a=>Error(a),methodUnimplemented$$module$libs$y_webrtc_min=()=>{throw create$2$$module$libs$y_webrtc_min("Method unimplemented");},unexpectedCase$$module$libs$y_webrtc_min=()=>{throw create$2$$module$libs$y_webrtc_min("Unexpected case");},getRandomValues$$module$libs$y_webrtc_min=crypto.getRandomValues.bind(crypto),rand$$module$libs$y_webrtc_min=Math.random,uint32$$module$libs$y_webrtc_min=()=>getRandomValues$$module$libs$y_webrtc_min(new Uint32Array(1))[0],
uuidv4Template$$module$libs$y_webrtc_min="10000000-1000-4000-8000-100000000000",uuidv4$$module$libs$y_webrtc_min=()=>uuidv4Template$$module$libs$y_webrtc_min.replace(/[018]/g,a=>(a^uint32$$module$libs$y_webrtc_min()&15>>a/4).toString(16)),fromCharCode$$module$libs$y_webrtc_min=String.fromCharCode,trimLeftRegex$$module$libs$y_webrtc_min=/^\s*/g,fromCamelCaseRegex$$module$libs$y_webrtc_min=/([A-Z])/g,fromCamelCase$$module$libs$y_webrtc_min=(a,g)=>a.replace(fromCamelCaseRegex$$module$libs$y_webrtc_min,
q=>`${g}${q.toLowerCase()}`).replace(trimLeftRegex$$module$libs$y_webrtc_min,""),utf8TextEncoder$$module$libs$y_webrtc_min="undefined"!=typeof TextEncoder?new TextEncoder:null,encodeUtf8$$module$libs$y_webrtc_min=utf8TextEncoder$$module$libs$y_webrtc_min?a=>utf8TextEncoder$$module$libs$y_webrtc_min.encode(a):a=>{a=unescape(encodeURIComponent(a));const g=a.length,q=new Uint8Array(g);for(let u=0;u<g;u++)q[u]=a.codePointAt(u);return q};
let utf8TextDecoder$$module$libs$y_webrtc_min="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});utf8TextDecoder$$module$libs$y_webrtc_min&&1===utf8TextDecoder$$module$libs$y_webrtc_min.decode(new Uint8Array).length&&(utf8TextDecoder$$module$libs$y_webrtc_min=null);const repeat$$module$libs$y_webrtc_min=(a,g)=>((q,u)=>{const B=Array(q);for(let E=0;E<q;E++)B[E]=u(E,B);return B})(g,()=>a).join(""),undefinedToNull$$module$libs$y_webrtc_min=a=>void 0===a?null:a;
let _localStorage$$module$libs$y_webrtc_min=new class{constructor(){this.map=new Map}setItem(a,g){this.map.set(a,g)}getItem(a){return this.map.get(a)}},usePolyfill$$module$libs$y_webrtc_min=!0;try{"undefined"!=typeof localStorage&&(_localStorage$$module$libs$y_webrtc_min=localStorage,usePolyfill$$module$libs$y_webrtc_min=!1)}catch(a){}
const varStorage$$module$libs$y_webrtc_min=_localStorage$$module$libs$y_webrtc_min,assign$$module$libs$y_webrtc_min=Object.assign,keys$$module$libs$y_webrtc_min=Object.keys,length$$module$libs$y_webrtc_min=a=>keys$$module$libs$y_webrtc_min(a).length,hasProperty$$module$libs$y_webrtc_min=(a,g)=>Object.prototype.hasOwnProperty.call(a,g),callAll$$module$libs$y_webrtc_min=(a,g,q=0)=>{try{for(;q<a.length;q++)a[q](...g)}finally{q<a.length&&callAll$$module$libs$y_webrtc_min(a,g,q+1)}},nop$$module$libs$y_webrtc_min=
()=>{},id$$module$libs$y_webrtc_min=a=>a,equalityDeep$$module$libs$y_webrtc_min=(a,g)=>{if(null==a||null==g)return a===g;if(a.constructor!==g.constructor)return!1;if(a===g)return!0;switch(a.constructor){case ArrayBuffer:a=new Uint8Array(a),g=new Uint8Array(g);case Uint8Array:if(a.byteLength!==g.byteLength)return!1;for(var q=0;q<a.length;q++)if(a[q]!==g[q])return!1;break;case Set:if(a.size!==g.size)return!1;for(q of a)if(!g.has(q))return!1;break;case Map:if(a.size!==g.size)return!1;for(const u of a.keys())if(!g.has(u)||
!equalityDeep$$module$libs$y_webrtc_min(a.get(u),g.get(u)))return!1;break;case Object:if(length$$module$libs$y_webrtc_min(a)!==length$$module$libs$y_webrtc_min(g))return!1;for(const u in a)if(!hasProperty$$module$libs$y_webrtc_min(a,u)||!equalityDeep$$module$libs$y_webrtc_min(a[u],g[u]))return!1;break;case Array:if(a.length!==g.length)return!1;for(q=0;q<a.length;q++)if(!equalityDeep$$module$libs$y_webrtc_min(a[q],g[q]))return!1;break;default:return!1}return!0},isNode$$module$libs$y_webrtc_min="undefined"!=
typeof process&&process.release&&/node|io\.js/.test(process.release.name),isBrowser$$module$libs$y_webrtc_min="undefined"!=typeof window&&"undefined"!=typeof document&&!isNode$$module$libs$y_webrtc_min;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let params$$module$libs$y_webrtc_min;
const hasParam$$module$libs$y_webrtc_min=a=>(()=>{if(void 0===params$$module$libs$y_webrtc_min)if(isNode$$module$libs$y_webrtc_min){params$$module$libs$y_webrtc_min=create$$module$libs$y_webrtc_min();const g=process.argv;let q=null;for(let u=0;u<g.length;u++){const B=g[u];"-"===B[0]?(null!==q&&params$$module$libs$y_webrtc_min.set(q,""),q=B):null!==q&&(params$$module$libs$y_webrtc_min.set(q,B),q=null)}null!==q&&params$$module$libs$y_webrtc_min.set(q,"")}else"object"==typeof location?(params$$module$libs$y_webrtc_min=
create$$module$libs$y_webrtc_min(),(location.search||"?").slice(1).split("&").forEach(g=>{if(0!==g.length){const [q,u]=g.split("=");params$$module$libs$y_webrtc_min.set("--"+fromCamelCase$$module$libs$y_webrtc_min(q,"-"),u);params$$module$libs$y_webrtc_min.set("-"+fromCamelCase$$module$libs$y_webrtc_min(q,"-"),u)}})):params$$module$libs$y_webrtc_min=create$$module$libs$y_webrtc_min();return params$$module$libs$y_webrtc_min})().has(a),getVariable$$module$libs$y_webrtc_min=a=>undefinedToNull$$module$libs$y_webrtc_min(isNode$$module$libs$y_webrtc_min?
process.env[a.toUpperCase()]:varStorage$$module$libs$y_webrtc_min.getItem(a));hasParam$$module$libs$y_webrtc_min("--"+(name$$module$libs$y_webrtc_min="production"))||getVariable$$module$libs$y_webrtc_min(name$$module$libs$y_webrtc_min);var name$$module$libs$y_webrtc_min;const forceColor$$module$libs$y_webrtc_min=isNode$$module$libs$y_webrtc_min&&(value$$module$libs$y_webrtc_min=process.env.FORCE_COLOR,["true","1","2"].includes(value$$module$libs$y_webrtc_min));var value$$module$libs$y_webrtc_min;
const supportsColor$$module$libs$y_webrtc_min=!hasParam$$module$libs$y_webrtc_min("no-colors")&&(!isNode$$module$libs$y_webrtc_min||process.stdout.isTTY||forceColor$$module$libs$y_webrtc_min)&&(!isNode$$module$libs$y_webrtc_min||hasParam$$module$libs$y_webrtc_min("color")||forceColor$$module$libs$y_webrtc_min||null!==getVariable$$module$libs$y_webrtc_min("COLORTERM")||(getVariable$$module$libs$y_webrtc_min("TERM")||"").includes("color")),MAX_SAFE_INTEGER$$module$libs$y_webrtc_min=Number.MAX_SAFE_INTEGER,
isInteger$$module$libs$y_webrtc_min=Number.isInteger||(a=>"number"==typeof a&&isFinite(a)&&floor$$module$libs$y_webrtc_min(a)===a),errorUnexpectedEndOfArray$$module$libs$y_webrtc_min=create$2$$module$libs$y_webrtc_min("Unexpected end of array"),errorIntegerOutOfRange$$module$libs$y_webrtc_min=create$2$$module$libs$y_webrtc_min("Integer out of Range");class Decoder$$module$libs$y_webrtc_min{constructor(a){this.arr=a;this.pos=0}}
const createDecoder$$module$libs$y_webrtc_min=a=>new Decoder$$module$libs$y_webrtc_min(a),hasContent$$module$libs$y_webrtc_min=a=>a.pos!==a.arr.length,readVarUint8Array$$module$libs$y_webrtc_min=a=>{var g=readVarUint$$module$libs$y_webrtc_min(a);const q=createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.arr.buffer,a.pos+a.arr.byteOffset,g);return a.pos+=g,q},readUint8$$module$libs$y_webrtc_min=a=>a.arr[a.pos++],readVarUint$$module$libs$y_webrtc_min=a=>{let g=0,q=1;const u=a.arr.length;
for(;a.pos<u;){const B=a.arr[a.pos++];if(g+=(127&B)*q,q*=128,128>B)return g;if(g>MAX_SAFE_INTEGER$$module$libs$y_webrtc_min)throw errorIntegerOutOfRange$$module$libs$y_webrtc_min;}throw errorUnexpectedEndOfArray$$module$libs$y_webrtc_min;},readVarInt$$module$libs$y_webrtc_min=a=>{let g=a.arr[a.pos++],q=63&g,u=64;const B=0<(64&g)?-1:1;if(0==(128&g))return B*q;const E=a.arr.length;for(;a.pos<E;){if(g=a.arr[a.pos++],q+=(127&g)*u,u*=128,128>g)return B*q;if(q>MAX_SAFE_INTEGER$$module$libs$y_webrtc_min)throw errorIntegerOutOfRange$$module$libs$y_webrtc_min;
}throw errorUnexpectedEndOfArray$$module$libs$y_webrtc_min;},readVarString$$module$libs$y_webrtc_min=utf8TextDecoder$$module$libs$y_webrtc_min?a=>utf8TextDecoder$$module$libs$y_webrtc_min.decode(readVarUint8Array$$module$libs$y_webrtc_min(a)):a=>{let g=readVarUint$$module$libs$y_webrtc_min(a);if(0===g)return"";let q=String.fromCodePoint(readUint8$$module$libs$y_webrtc_min(a));if(100>--g)for(;g--;)q+=String.fromCodePoint(readUint8$$module$libs$y_webrtc_min(a));else for(;0<g;){const u=1E4>g?g:1E4,B=
a.arr.subarray(a.pos,a.pos+u);a.pos+=u;q+=String.fromCodePoint.apply(null,B);g-=u}return decodeURIComponent(escape(q))},readFromDataView$$module$libs$y_webrtc_min=(a,g)=>{const q=new DataView(a.arr.buffer,a.arr.byteOffset+a.pos,g);return a.pos+=g,q},readAnyLookupTable$$module$libs$y_webrtc_min=[a=>{},a=>null,readVarInt$$module$libs$y_webrtc_min,a=>readFromDataView$$module$libs$y_webrtc_min(a,4).getFloat32(0,!1),a=>readFromDataView$$module$libs$y_webrtc_min(a,8).getFloat64(0,!1),a=>readFromDataView$$module$libs$y_webrtc_min(a,
8).getBigInt64(0,!1),a=>!1,a=>!0,readVarString$$module$libs$y_webrtc_min,a=>{const g=readVarUint$$module$libs$y_webrtc_min(a),q={};for(let u=0;u<g;u++)q[readVarString$$module$libs$y_webrtc_min(a)]=readAny$$module$libs$y_webrtc_min(a);return q},a=>{const g=readVarUint$$module$libs$y_webrtc_min(a),q=[];for(let u=0;u<g;u++)q.push(readAny$$module$libs$y_webrtc_min(a));return q},readVarUint8Array$$module$libs$y_webrtc_min],readAny$$module$libs$y_webrtc_min=a=>readAnyLookupTable$$module$libs$y_webrtc_min[127-
readUint8$$module$libs$y_webrtc_min(a)](a);class RleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a,g){super(a);this.reader=g;this.s=null;this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),hasContent$$module$libs$y_webrtc_min(this)?this.count=readVarUint$$module$libs$y_webrtc_min(this)+1:this.count=-1),this.count--,this.s}}
class UintOptRleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a){super(a);this.count=this.s=0}read(){if(0===this.count){this.s=readVarInt$$module$libs$y_webrtc_min(this);const a=isNegativeZero$$module$libs$y_webrtc_min(this.s);this.count=1;a&&(this.s=-this.s,this.count=readVarUint$$module$libs$y_webrtc_min(this)+2)}return this.count--,this.s}}
class IntDiffOptRleDecoder$$module$libs$y_webrtc_min extends Decoder$$module$libs$y_webrtc_min{constructor(a){super(a);this.diff=this.count=this.s=0}read(){if(0===this.count){const a=readVarInt$$module$libs$y_webrtc_min(this),g=1&a;this.diff=floor$$module$libs$y_webrtc_min(a/2);this.count=1;g&&(this.count=readVarUint$$module$libs$y_webrtc_min(this)+2)}return this.s+=this.diff,this.count--,this.s}}
class StringDecoder$$module$libs$y_webrtc_min{constructor(a){this.decoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(a);this.str=readVarString$$module$libs$y_webrtc_min(this.decoder);this.spos=0}read(){const a=this.spos+this.decoder.read(),g=this.str.slice(this.spos,a);return this.spos=a,g}}
const createUint8ArrayFromLen$$module$libs$y_webrtc_min=a=>new Uint8Array(a),createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min=(a,g,q)=>new Uint8Array(a,g,q),toBase64$$module$libs$y_webrtc_min=isBrowser$$module$libs$y_webrtc_min?a=>{let g="";for(let q=0;q<a.byteLength;q++)g+=fromCharCode$$module$libs$y_webrtc_min(a[q]);return btoa(g)}:a=>Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString("base64"),fromBase64$$module$libs$y_webrtc_min=isBrowser$$module$libs$y_webrtc_min?a=>{a=atob(a);
const g=createUint8ArrayFromLen$$module$libs$y_webrtc_min(a.length);for(let q=0;q<a.length;q++)g[q]=a.charCodeAt(q);return g}:a=>{a=Buffer.from(a,"base64");return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)};class Encoder$$module$libs$y_webrtc_min{constructor(){this.cpos=0;this.cbuf=new Uint8Array(100);this.bufs=[]}}
const createEncoder$$module$libs$y_webrtc_min=()=>new Encoder$$module$libs$y_webrtc_min,toUint8Array$$module$libs$y_webrtc_min=a=>{var g=Uint8Array,q=a.cpos;for(var u=0;u<a.bufs.length;u++)q+=a.bufs[u].length;g=new g(q);q=0;for(u=0;u<a.bufs.length;u++){const B=a.bufs[u];g.set(B,q);q+=B.length}return g.set(createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.cbuf.buffer,0,a.cpos),q),g},write$$module$libs$y_webrtc_min=(a,g)=>{const q=a.cbuf.length;a.cpos===q&&(a.bufs.push(a.cbuf),a.cbuf=
new Uint8Array(2*q),a.cpos=0);a.cbuf[a.cpos++]=g},writeUint8$$module$libs$y_webrtc_min=write$$module$libs$y_webrtc_min,writeVarUint$$module$libs$y_webrtc_min=(a,g)=>{for(;127<g;)write$$module$libs$y_webrtc_min(a,128|127&g),g=floor$$module$libs$y_webrtc_min(g/128);write$$module$libs$y_webrtc_min(a,127&g)},writeVarInt$$module$libs$y_webrtc_min=(a,g)=>{const q=isNegativeZero$$module$libs$y_webrtc_min(g);q&&(g=-g);write$$module$libs$y_webrtc_min(a,(63<g?128:0)|(q?64:0)|63&g);for(g=floor$$module$libs$y_webrtc_min(g/
64);0<g;)write$$module$libs$y_webrtc_min(a,(127<g?128:0)|127&g),g=floor$$module$libs$y_webrtc_min(g/128)},_strBuffer$$module$libs$y_webrtc_min=new Uint8Array(3E4),_maxStrBSize$$module$libs$y_webrtc_min=_strBuffer$$module$libs$y_webrtc_min.length/3,writeVarString$$module$libs$y_webrtc_min=utf8TextEncoder$$module$libs$y_webrtc_min&&utf8TextEncoder$$module$libs$y_webrtc_min.encodeInto?(a,g)=>{if(g.length<_maxStrBSize$$module$libs$y_webrtc_min){g=utf8TextEncoder$$module$libs$y_webrtc_min.encodeInto(g,
_strBuffer$$module$libs$y_webrtc_min).written||0;writeVarUint$$module$libs$y_webrtc_min(a,g);for(let q=0;q<g;q++)write$$module$libs$y_webrtc_min(a,_strBuffer$$module$libs$y_webrtc_min[q])}else writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeUtf8$$module$libs$y_webrtc_min(g))}:(a,g)=>{g=unescape(encodeURIComponent(g));const q=g.length;writeVarUint$$module$libs$y_webrtc_min(a,q);for(let u=0;u<q;u++)write$$module$libs$y_webrtc_min(a,g.codePointAt(u))},writeUint8Array$$module$libs$y_webrtc_min=(a,
g)=>{const q=a.cbuf.length,u=a.cpos,B=min$$module$libs$y_webrtc_min(q-u,g.length),E=g.length-B;a.cbuf.set(g.subarray(0,B),u);a.cpos+=B;0<E&&(a.bufs.push(a.cbuf),a.cbuf=new Uint8Array(max$$module$libs$y_webrtc_min(2*q,E)),a.cbuf.set(g.subarray(B)),a.cpos=E)},writeVarUint8Array$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a,g.byteLength);writeUint8Array$$module$libs$y_webrtc_min(a,g)},writeOnDataView$$module$libs$y_webrtc_min=(a,g)=>{var q=a.cbuf.length;q-a.cpos<g&&(a.bufs.push(createUint8ArrayViewFromArrayBuffer$$module$libs$y_webrtc_min(a.cbuf.buffer,
0,a.cpos)),a.cbuf=new Uint8Array(2*max$$module$libs$y_webrtc_min(q,g)),a.cpos=0);q=new DataView(a.cbuf.buffer,a.cpos,g);return a.cpos+=g,q},floatTestBed$$module$libs$y_webrtc_min=new DataView(new ArrayBuffer(4)),writeAny$$module$libs$y_webrtc_min=(a,g)=>{switch(typeof g){case "string":write$$module$libs$y_webrtc_min(a,119);writeVarString$$module$libs$y_webrtc_min(a,g);break;case "number":isInteger$$module$libs$y_webrtc_min(g)&&2147483647>=abs$$module$libs$y_webrtc_min(g)?(write$$module$libs$y_webrtc_min(a,
125),writeVarInt$$module$libs$y_webrtc_min(a,g)):(q=g,floatTestBed$$module$libs$y_webrtc_min.setFloat32(0,q),floatTestBed$$module$libs$y_webrtc_min.getFloat32(0)===q?(write$$module$libs$y_webrtc_min(a,124),((u,B)=>{writeOnDataView$$module$libs$y_webrtc_min(u,4).setFloat32(0,B,!1)})(a,g)):(write$$module$libs$y_webrtc_min(a,123),((u,B)=>{writeOnDataView$$module$libs$y_webrtc_min(u,8).setFloat64(0,B,!1)})(a,g)));break;case "bigint":write$$module$libs$y_webrtc_min(a,122);((u,B)=>{writeOnDataView$$module$libs$y_webrtc_min(u,
8).setBigInt64(0,B,!1)})(a,g);break;case "object":if(null===g)write$$module$libs$y_webrtc_min(a,126);else if(isArray$$module$libs$y_webrtc_min(g))for(write$$module$libs$y_webrtc_min(a,117),writeVarUint$$module$libs$y_webrtc_min(a,g.length),q=0;q<g.length;q++)writeAny$$module$libs$y_webrtc_min(a,g[q]);else if(g instanceof Uint8Array)write$$module$libs$y_webrtc_min(a,116),writeVarUint8Array$$module$libs$y_webrtc_min(a,g);else{write$$module$libs$y_webrtc_min(a,118);q=Object.keys(g);writeVarUint$$module$libs$y_webrtc_min(a,
q.length);for(let u=0;u<q.length;u++){const B=q[u];writeVarString$$module$libs$y_webrtc_min(a,B);writeAny$$module$libs$y_webrtc_min(a,g[B])}}break;case "boolean":write$$module$libs$y_webrtc_min(a,g?120:121);break;default:write$$module$libs$y_webrtc_min(a,127)}var q};
class RleEncoder$$module$libs$y_webrtc_min extends Encoder$$module$libs$y_webrtc_min{constructor(a){super();this.w=a;this.s=null;this.count=0}write(a){this.s===a?this.count++:(0<this.count&&writeVarUint$$module$libs$y_webrtc_min(this,this.count-1),this.count=1,this.w(this,a),this.s=a)}}const flushUintOptRleEncoder$$module$libs$y_webrtc_min=a=>{0<a.count&&(writeVarInt$$module$libs$y_webrtc_min(a.encoder,1===a.count?a.s:-a.s),1<a.count&&writeVarUint$$module$libs$y_webrtc_min(a.encoder,a.count-2))};
class UintOptRleEncoder$$module$libs$y_webrtc_min{constructor(){this.encoder=new Encoder$$module$libs$y_webrtc_min;this.count=this.s=0}write(a){this.s===a?this.count++:(flushUintOptRleEncoder$$module$libs$y_webrtc_min(this),this.count=1,this.s=a)}toUint8Array(){return flushUintOptRleEncoder$$module$libs$y_webrtc_min(this),toUint8Array$$module$libs$y_webrtc_min(this.encoder)}}
const flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min=a=>{0<a.count&&(writeVarInt$$module$libs$y_webrtc_min(a.encoder,2*a.diff+(1===a.count?0:1)),1<a.count&&writeVarUint$$module$libs$y_webrtc_min(a.encoder,a.count-2))};
class IntDiffOptRleEncoder$$module$libs$y_webrtc_min{constructor(){this.encoder=new Encoder$$module$libs$y_webrtc_min;this.diff=this.count=this.s=0}write(a){this.diff===a-this.s?(this.s=a,this.count++):(flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min(this),this.count=1,this.diff=a-this.s,this.s=a)}toUint8Array(){return flushIntDiffOptRleEncoder$$module$libs$y_webrtc_min(this),toUint8Array$$module$libs$y_webrtc_min(this.encoder)}}
class StringEncoder$$module$libs$y_webrtc_min{constructor(){this.sarr=[];this.s="";this.lensE=new UintOptRleEncoder$$module$libs$y_webrtc_min}write(a){this.s+=a;19<this.s.length&&(this.sarr.push(this.s),this.s="");this.lensE.write(a.length)}toUint8Array(){const a=new Encoder$$module$libs$y_webrtc_min;return this.sarr.push(this.s),this.s="",writeVarString$$module$libs$y_webrtc_min(a,this.sarr.join("")),writeUint8Array$$module$libs$y_webrtc_min(a,this.lensE.toUint8Array()),toUint8Array$$module$libs$y_webrtc_min(a)}}
class Pair$$module$libs$y_webrtc_min{constructor(a,g){this.left=a;this.right=g}}
const create$3$$module$libs$y_webrtc_min=(a,g)=>new Pair$$module$libs$y_webrtc_min(a,g),create$4$$module$libs$y_webrtc_min=("undefined"!=typeof DOMParser&&new DOMParser,Symbol),BOLD$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),UNBOLD$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),BLUE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),GREY$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),GREEN$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),
RED$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),PURPLE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),ORANGE$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),UNCOLOR$$module$libs$y_webrtc_min=create$4$$module$libs$y_webrtc_min(),loggingColors$$module$libs$y_webrtc_min=[GREEN$$module$libs$y_webrtc_min,PURPLE$$module$libs$y_webrtc_min,ORANGE$$module$libs$y_webrtc_min,BLUE$$module$libs$y_webrtc_min];
let nextColor$$module$libs$y_webrtc_min=0,lastLoggingTime$$module$libs$y_webrtc_min=getUnixTime$$module$libs$y_webrtc_min();
const _browserStyleMap$$module$libs$y_webrtc_min={[BOLD$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("font-weight","bold"),[UNBOLD$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("font-weight","normal"),[BLUE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","blue"),[GREEN$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","green"),[GREY$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","grey"),[RED$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color",
"red"),[PURPLE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","purple"),[ORANGE$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","orange"),[UNCOLOR$$module$libs$y_webrtc_min]:create$3$$module$libs$y_webrtc_min("color","black")},computeLoggingArgs$$module$libs$y_webrtc_min=supportsColor$$module$libs$y_webrtc_min?a=>{var g=[];const q=[],u=create$$module$libs$y_webrtc_min();let B=[],E=0;for(;E<a.length;E++){const K=a[E];var F=_browserStyleMap$$module$libs$y_webrtc_min[K];
if(void 0!==F)u.set(F.left,F.right);else{if(K.constructor!==String&&K.constructor!==Number)break;F=((I,J)=>{const H=[];for(const [N,T]of I)H.push(J(T,N));return H})(u,(I,J)=>`${J}:${I};`).join("");0<E||0<F.length?(g.push("%c"+K),q.push(F)):g.push(K)}}for(0<E&&(B=q,B.unshift(g.join("")));E<a.length;E++)g=a[E],g instanceof Symbol||B.push(g);return B}:a=>{const g=[];let q=0;for(;q<a.length;q++){const u=a[q];u.constructor===String||u.constructor===Number||u.constructor===Object&&g.push(JSON.stringify(u))}return g},
print$$module$libs$y_webrtc_min=(...a)=>{console.log(...computeLoggingArgs$$module$libs$y_webrtc_min(a));vconsoles$$module$libs$y_webrtc_min.forEach(g=>g.print(a))},vconsoles$$module$libs$y_webrtc_min=create$1$$module$libs$y_webrtc_min(),create$5$$module$libs$y_webrtc_min=a=>new Promise(a),resolve$$module$libs$y_webrtc_min=a=>Promise.resolve(a),channels$$module$libs$y_webrtc_min=new Map,BC$$module$libs$y_webrtc_min="undefined"==typeof BroadcastChannel?class{constructor(a){this.room=a;this.onmessage=
null;var g=this._onChange=q=>q.key===a&&null!==this.onmessage&&this.onmessage({data:fromBase64$$module$libs$y_webrtc_min(q.newValue||"")});usePolyfill$$module$libs$y_webrtc_min||addEventListener("storage",g)}postMessage(a){varStorage$$module$libs$y_webrtc_min.setItem(this.room,toBase64$$module$libs$y_webrtc_min(new Uint8Array(a)))}close(){var a=this._onChange;usePolyfill$$module$libs$y_webrtc_min||removeEventListener("storage",a)}}:BroadcastChannel,getChannel$$module$libs$y_webrtc_min=a=>setIfUndefined$$module$libs$y_webrtc_min(channels$$module$libs$y_webrtc_min,
a,()=>{const g=create$1$$module$libs$y_webrtc_min(),q=new BC$$module$libs$y_webrtc_min(a);return q.onmessage=u=>g.forEach(B=>B(u.data,"broadcastchannel")),{bc:q,subs:g}}),createIterator$$module$libs$y_webrtc_min=a=>({[Symbol.iterator](){return this},next:a}),iteratorMap$$module$libs$y_webrtc_min=(a,g)=>createIterator$$module$libs$y_webrtc_min(()=>{const {done:q,value:u}=a.next();return{done:q,value:q?void 0:g(u)}});
class AbstractConnector$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,g){super();this.doc=a;this.awareness=g}}class DeleteItem$$module$libs$y_webrtc_min{constructor(a,g){this.clock=a;this.len=g}}class DeleteSet$$module$libs$y_webrtc_min{constructor(){this.clients=new Map}}
const iterateDeletedStructs$$module$libs$y_webrtc_min=(a,g,q)=>g.clients.forEach((u,B)=>{B=a.doc.store.clients.get(B);for(let E=0;E<u.length;E++){const F=u[E];iterateStructs$$module$libs$y_webrtc_min(a,B,F.clock,F.len,q)}}),isDeleted$$module$libs$y_webrtc_min=(a,g)=>{a=a.clients.get(g.client);var q;if(q=void 0!==a){a:{g=g.clock;q=0;let u=a.length-1;for(;q<=u;){const B=floor$$module$libs$y_webrtc_min((q+u)/2),E=a[B],F=E.clock;if(F<=g){if(g<F+E.len){a=B;break a}q=B+1}else u=B-1}a=null}q=null!==a}return q},
sortAndMergeDeleteSet$$module$libs$y_webrtc_min=a=>{a.clients.forEach(g=>{let q,u;g.sort((B,E)=>B.clock-E.clock);for(u=q=1;q<g.length;q++){const B=g[u-1],E=g[q];B.clock+B.len>=E.clock?B.len=max$$module$libs$y_webrtc_min(B.len,E.clock+E.len-B.clock):(u<q&&(g[u]=E),u++)}g.length=u})},mergeDeleteSets$$module$libs$y_webrtc_min=a=>{const g=new DeleteSet$$module$libs$y_webrtc_min;for(let q=0;q<a.length;q++)a[q].clients.forEach((u,B)=>{if(!g.clients.has(B)){u=u.slice();for(let E=q+1;E<a.length;E++)appendTo$$module$libs$y_webrtc_min(u,
a[E].clients.get(B)||[]);g.clients.set(B,u)}});return sortAndMergeDeleteSet$$module$libs$y_webrtc_min(g),g},addToDeleteSet$$module$libs$y_webrtc_min=(a,g,q,u)=>{setIfUndefined$$module$libs$y_webrtc_min(a.clients,g,()=>[]).push(new DeleteItem$$module$libs$y_webrtc_min(q,u))},createDeleteSet$$module$libs$y_webrtc_min=()=>new DeleteSet$$module$libs$y_webrtc_min,createDeleteSetFromStructStore$$module$libs$y_webrtc_min=a=>{const g=createDeleteSet$$module$libs$y_webrtc_min();return a.clients.forEach((q,
u)=>{const B=[];for(let F=0;F<q.length;F++){var E=q[F];if(E.deleted){const K=E.id.clock;E=E.length;if(F+1<q.length)for(let I=q[F+1];F+1<q.length&&I.deleted;I=q[1+ ++F])E+=I.length;B.push(new DeleteItem$$module$libs$y_webrtc_min(K,E))}}0<B.length&&g.clients.set(u,B)}),g},writeDeleteSet$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,g.clients.size);from$$module$libs$y_webrtc_min(g.clients.entries()).sort((q,u)=>u[0]-q[0]).forEach(([q,u])=>{a.resetDsCurVal();writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,
q);q=u.length;writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,q);for(let B=0;B<q;B++){const E=u[B];a.writeDsClock(E.clock);a.writeDsLen(E.len)}})},readDeleteSet$$module$libs$y_webrtc_min=a=>{const g=new DeleteSet$$module$libs$y_webrtc_min,q=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let B=0;B<q;B++){a.resetDsCurVal();var u=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);const E=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);if(0<E){u=setIfUndefined$$module$libs$y_webrtc_min(g.clients,
u,()=>[]);for(let F=0;F<E;F++)u.push(new DeleteItem$$module$libs$y_webrtc_min(a.readDsClock(),a.readDsLen()))}}return g},readAndApplyDeleteSet$$module$libs$y_webrtc_min=(a,g,q)=>{const u=new DeleteSet$$module$libs$y_webrtc_min,B=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let E=0;E<B;E++){a.resetDsCurVal();const F=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),K=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),I=q.clients.get(F)||[],J=getState$$module$libs$y_webrtc_min(q,F);
for(let H=0;H<K;H++){const N=a.readDsClock(),T=N+a.readDsLen();if(N<J){J<T&&addToDeleteSet$$module$libs$y_webrtc_min(u,F,J,T-J);let O=findIndexSS$$module$libs$y_webrtc_min(I,N),W=I[O];for(!W.deleted&&W.id.clock<N&&(I.splice(O+1,0,splitItem$$module$libs$y_webrtc_min(g,W,N-W.id.clock)),O++);O<I.length&&(W=I[O++],W.id.clock<T);)W.deleted||(T<W.id.clock+W.length&&I.splice(O,0,splitItem$$module$libs$y_webrtc_min(g,W,T-W.id.clock)),W.delete(g))}else addToDeleteSet$$module$libs$y_webrtc_min(u,F,N,T-N)}}return 0<
u.clients.size?(a=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,0),writeDeleteSet$$module$libs$y_webrtc_min(a,u),a.toUint8Array()):null},generateNewClientId$$module$libs$y_webrtc_min=uint32$$module$libs$y_webrtc_min;
class Doc$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor({guid:a=uuidv4$$module$libs$y_webrtc_min(),collectionid:g=null,gc:q=!0,gcFilter:u=()=>!0,meta:B=null,autoLoad:E=!1,shouldLoad:F=!0}={}){super();this.gc=q;this.gcFilter=u;this.clientID=uint32$$module$libs$y_webrtc_min();this.guid=a;this.collectionid=g;this.share=new Map;this.store=new StructStore$$module$libs$y_webrtc_min;this._transaction=null;this._transactionCleanups=[];this.subdocs=new Set;this._item=null;
this.shouldLoad=F;this.autoLoad=E;this.meta=B;this.isSynced=this.isLoaded=!1;this.whenLoaded=create$5$$module$libs$y_webrtc_min(I=>{this.on("load",()=>{this.isLoaded=!0;I(this)})});const K=()=>create$5$$module$libs$y_webrtc_min(I=>{const J=H=>{void 0!==H&&!0!==H||(this.off("sync",J),I())};this.on("sync",J)});this.on("sync",I=>{!1===I&&this.isSynced&&(this.whenSynced=K());this.isSynced=void 0===I||!0===I;this.isLoaded||this.emit("load",[])});this.whenSynced=K()}load(){const a=this._item;null===a||
this.shouldLoad||transact$$module$libs$y_webrtc_min(a.parent.doc,g=>{g.subdocsLoaded.add(this)},null,!0);this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(from$$module$libs$y_webrtc_min(this.subdocs).map(a=>a.guid))}transact(a,g=null){return transact$$module$libs$y_webrtc_min(this,a,g)}get(a,g=AbstractType$$module$libs$y_webrtc_min){const q=setIfUndefined$$module$libs$y_webrtc_min(this.share,a,()=>{const B=new g;return B._integrate(this,null),B});var u=q.constructor;
if(g!==AbstractType$$module$libs$y_webrtc_min&&u!==g){if(u===AbstractType$$module$libs$y_webrtc_min){const B=new g;B._map=q._map;q._map.forEach(E=>{for(;null!==E;E=E.left)E.parent=B});B._start=q._start;for(u=B._start;null!==u;u=u.right)u.parent=B;return B._length=q._length,this.share.set(a,B),B._integrate(this,null),B}throw Error(`Type with the name ${a} has already been defined with a different constructor`);}return q}getArray(a=""){return this.get(a,YArray$$module$libs$y_webrtc_min)}getText(a=""){return this.get(a,
YText$$module$libs$y_webrtc_min)}getMap(a=""){return this.get(a,YMap$$module$libs$y_webrtc_min)}getXmlFragment(a=""){return this.get(a,YXmlFragment$$module$libs$y_webrtc_min)}toJSON(){const a={};return this.share.forEach((g,q)=>{a[q]=g.toJSON()}),a}destroy(){from$$module$libs$y_webrtc_min(this.subdocs).forEach(g=>g.destroy());const a=this._item;if(null!==a){this._item=null;const g=a.content;g.doc=new Doc$$module$libs$y_webrtc_min({guid:this.guid,...g.opts,shouldLoad:!1});g.doc._item=a;transact$$module$libs$y_webrtc_min(a.parent.doc,
q=>{const u=g.doc;a.deleted||q.subdocsAdded.add(u);q.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]);this.emit("destroy",[this]);super.destroy()}on(a,g){super.on(a,g)}off(a,g){super.off(a,g)}}class DSDecoderV1$$module$libs$y_webrtc_min{constructor(a){this.restDecoder=a}resetDsCurVal(){}readDsClock(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readDsLen(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}}
class UpdateDecoderV1$$module$libs$y_webrtc_min extends DSDecoderV1$$module$libs$y_webrtc_min{readLeftID(){return createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(this.restDecoder),readVarUint$$module$libs$y_webrtc_min(this.restDecoder))}readRightID(){return createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(this.restDecoder),readVarUint$$module$libs$y_webrtc_min(this.restDecoder))}readClient(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readInfo(){return readUint8$$module$libs$y_webrtc_min(this.restDecoder)}readString(){return readVarString$$module$libs$y_webrtc_min(this.restDecoder)}readParentInfo(){return 1===
readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readTypeRef(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readLen(){return readVarUint$$module$libs$y_webrtc_min(this.restDecoder)}readAny(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readBuf(){var a=readVarUint8Array$$module$libs$y_webrtc_min(this.restDecoder);const g=createUint8ArrayFromLen$$module$libs$y_webrtc_min(a.byteLength);return g.set(a),g}readJSON(){return JSON.parse(readVarString$$module$libs$y_webrtc_min(this.restDecoder))}readKey(){return readVarString$$module$libs$y_webrtc_min(this.restDecoder)}}
class DSDecoderV2$$module$libs$y_webrtc_min{constructor(a){this.dsCurrVal=0;this.restDecoder=a}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=readVarUint$$module$libs$y_webrtc_min(this.restDecoder),this.dsCurrVal}readDsLen(){const a=readVarUint$$module$libs$y_webrtc_min(this.restDecoder)+1;return this.dsCurrVal+=a,a}}
class UpdateDecoderV2$$module$libs$y_webrtc_min extends DSDecoderV2$$module$libs$y_webrtc_min{constructor(a){super(a);this.keys=[];readVarUint$$module$libs$y_webrtc_min(a);this.keyClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.clientDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.leftClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));
this.rightClockDecoder=new IntDiffOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.infoDecoder=new RleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a),readUint8$$module$libs$y_webrtc_min);this.stringDecoder=new StringDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.parentInfoDecoder=new RleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a),readUint8$$module$libs$y_webrtc_min);
this.typeRefDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a));this.lenDecoder=new UintOptRleDecoder$$module$libs$y_webrtc_min(readVarUint8Array$$module$libs$y_webrtc_min(a))}readLeftID(){return new ID$$module$libs$y_webrtc_min(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ID$$module$libs$y_webrtc_min(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===
this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readBuf(){return readVarUint8Array$$module$libs$y_webrtc_min(this.restDecoder)}readJSON(){return readAny$$module$libs$y_webrtc_min(this.restDecoder)}readKey(){var a=this.keyClockDecoder.read();if(a<this.keys.length)return this.keys[a];a=this.stringDecoder.read();return this.keys.push(a),a}}
class DSEncoderV1$$module$libs$y_webrtc_min{constructor(){this.restEncoder=createEncoder$$module$libs$y_webrtc_min()}toUint8Array(){return toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)}resetDsCurVal(){}writeDsClock(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeDsLen(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}}
class UpdateEncoderV1$$module$libs$y_webrtc_min extends DSEncoderV1$$module$libs$y_webrtc_min{writeLeftID(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.client);writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.clock)}writeRightID(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.client);writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a.clock)}writeClient(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeInfo(a){write$$module$libs$y_webrtc_min(this.restEncoder,
a)}writeString(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,a)}writeParentInfo(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a?1:0)}writeTypeRef(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeLen(a){writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a)}writeAny(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeBuf(a){writeVarUint8Array$$module$libs$y_webrtc_min(this.restEncoder,a)}writeJSON(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,
JSON.stringify(a))}writeKey(a){writeVarString$$module$libs$y_webrtc_min(this.restEncoder,a)}}
class DSEncoderV2$$module$libs$y_webrtc_min{constructor(){this.restEncoder=createEncoder$$module$libs$y_webrtc_min();this.dsCurrVal=0}toUint8Array(){return toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(a){const g=a-this.dsCurrVal;this.dsCurrVal=a;writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,g)}writeDsLen(a){0===a&&unexpectedCase$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(this.restEncoder,a-1);this.dsCurrVal+=
a}}
class UpdateEncoderV2$$module$libs$y_webrtc_min extends DSEncoderV2$$module$libs$y_webrtc_min{constructor(){super();this.keyMap=new Map;this.keyClock=0;this.keyClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.clientEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min;this.leftClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.rightClockEncoder=new IntDiffOptRleEncoder$$module$libs$y_webrtc_min;this.infoEncoder=new RleEncoder$$module$libs$y_webrtc_min(write$$module$libs$y_webrtc_min);this.stringEncoder=
new StringEncoder$$module$libs$y_webrtc_min;this.parentInfoEncoder=new RleEncoder$$module$libs$y_webrtc_min(write$$module$libs$y_webrtc_min);this.typeRefEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min;this.lenEncoder=new UintOptRleEncoder$$module$libs$y_webrtc_min}toUint8Array(){const a=createEncoder$$module$libs$y_webrtc_min();return writeVarUint$$module$libs$y_webrtc_min(a,0),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.keyClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,
this.clientEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.leftClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.rightClockEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.infoEncoder)),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.stringEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.parentInfoEncoder)),
writeVarUint8Array$$module$libs$y_webrtc_min(a,this.typeRefEncoder.toUint8Array()),writeVarUint8Array$$module$libs$y_webrtc_min(a,this.lenEncoder.toUint8Array()),writeUint8Array$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(this.restEncoder)),toUint8Array$$module$libs$y_webrtc_min(a)}writeLeftID(a){this.clientEncoder.write(a.client);this.leftClockEncoder.write(a.clock)}writeRightID(a){this.clientEncoder.write(a.client);this.rightClockEncoder.write(a.clock)}writeClient(a){this.clientEncoder.write(a)}writeInfo(a){this.infoEncoder.write(a)}writeString(a){this.stringEncoder.write(a)}writeParentInfo(a){this.parentInfoEncoder.write(a?
1:0)}writeTypeRef(a){this.typeRefEncoder.write(a)}writeLen(a){this.lenEncoder.write(a)}writeAny(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeBuf(a){writeVarUint8Array$$module$libs$y_webrtc_min(this.restEncoder,a)}writeJSON(a){writeAny$$module$libs$y_webrtc_min(this.restEncoder,a)}writeKey(a){const g=this.keyMap.get(a);void 0===g?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(a)):this.keyClockEncoder.write(g)}}
const writeClientsStructs$$module$libs$y_webrtc_min=(a,g,q)=>{const u=new Map;q.forEach((B,E)=>{getState$$module$libs$y_webrtc_min(g,E)>B&&u.set(E,B)});getStateVector$$module$libs$y_webrtc_min(g).forEach((B,E)=>{q.has(E)||u.set(E,0)});writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,u.size);from$$module$libs$y_webrtc_min(u.entries()).sort((B,E)=>E[0]-B[0]).forEach(([B,E])=>{var F=g.clients.get(B);E=max$$module$libs$y_webrtc_min(E,F[0].id.clock);const K=findIndexSS$$module$libs$y_webrtc_min(F,
E);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,F.length-K);a.writeClient(B);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,E);B=F[K];B.write(a,E-B.id.clock);for(B=K+1;B<F.length;B++)F[B].write(a,0)})},readUpdateV2$$module$libs$y_webrtc_min=(a,g,q,u=new UpdateDecoderV2$$module$libs$y_webrtc_min(a))=>transact$$module$libs$y_webrtc_min(g,B=>{var E=B.local=!1,F=B.doc;const K=F.store;F=((J,H,N)=>{const T=[];let O=from$$module$libs$y_webrtc_min(N.keys()).sort((la,ta)=>la-ta);if(0===O.length)return null;
const W=()=>{if(0===O.length)return null;let la=N.get(O[O.length-1]);for(;la.refs.length===la.i;){if(O.pop(),!(0<O.length))return null;la=N.get(O[O.length-1])}return la};let ba=W();if(null===ba&&0===T.length)return null;const fa=new StructStore$$module$libs$y_webrtc_min,R=new Map,da=(la,ta)=>{const wa=R.get(la);(null==wa||wa>ta)&&R.set(la,ta)};let ha=ba.refs[ba.i++];const ma=new Map,ka=()=>{for(const la of T){const ta=la.id.client,wa=N.get(ta);wa?(wa.i--,fa.clients.set(ta,wa.refs.slice(wa.i)),N.delete(ta),
wa.i=0,wa.refs=[]):fa.clients.set(ta,[la]);O=O.filter(za=>za!==ta)}T.length=0};for(;;){if(ha.constructor!==Skip$$module$libs$y_webrtc_min){var pa=setIfUndefined$$module$libs$y_webrtc_min(ma,ha.id.client,()=>getState$$module$libs$y_webrtc_min(H,ha.id.client))-ha.id.clock;if(0>pa)T.push(ha),da(ha.id.client,ha.id.clock-1),ka();else{const la=ha.getMissing(J,H);if(null!==la){T.push(ha);pa=N.get(la)||{refs:[],i:0};if(pa.refs.length!==pa.i){ha=pa.refs[pa.i++];continue}da(la,getState$$module$libs$y_webrtc_min(H,
la));ka()}else(0===pa||pa<ha.length)&&(ha.integrate(J,pa),ma.set(ha.id.client,ha.id.clock+ha.length))}}if(0<T.length)ha=T.pop();else{if(!(null!==ba&&ba.i<ba.refs.length)&&(ba=W(),null===ba))break;ha=ba.refs[ba.i++]}}return 0<fa.clients.size?(J=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeClientsStructs$$module$libs$y_webrtc_min(J,fa,new Map),writeVarUint$$module$libs$y_webrtc_min(J.restEncoder,0),{missing:R,update:J.toUint8Array()}):null})(B,K,((J,H)=>{const N=create$$module$libs$y_webrtc_min(),
T=readVarUint$$module$libs$y_webrtc_min(J.restDecoder);for(let W=0;W<T;W++){const ba=readVarUint$$module$libs$y_webrtc_min(J.restDecoder),fa=Array(ba),R=J.readClient();let da=readVarUint$$module$libs$y_webrtc_min(J.restDecoder);N.set(R,{i:0,refs:fa});for(let ha=0;ha<ba;ha++){var O=J.readInfo();switch(31&O){case 0:O=J.readLen();fa[ha]=new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(R,da),O);da+=O;break;case 10:O=readVarUint$$module$libs$y_webrtc_min(J.restDecoder);fa[ha]=new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(R,
da),O);da+=O;break;default:const ma=0==(192&O);O=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(R,da),null,128==(128&O)?J.readLeftID():null,null,64==(64&O)?J.readRightID():null,ma?J.readParentInfo()?H.get(J.readString()):J.readLeftID():null,ma&&32==(32&O)?J.readString():null,readItemContent$$module$libs$y_webrtc_min(J,O));fa[ha]=O;da+=O.length}}}return N})(u,F));var I=K.pendingStructs;if(I){for(const [J,H]of I.missing)if(H<getState$$module$libs$y_webrtc_min(K,J)){E=!0;break}if(F){for(const [J,
H]of F.missing){const N=I.missing.get(J);(null==N||N>H)&&I.missing.set(J,H)}I.update=mergeUpdatesV2$$module$libs$y_webrtc_min([I.update,F.update])}}else K.pendingStructs=F;F=readAndApplyDeleteSet$$module$libs$y_webrtc_min(u,B,K);K.pendingDs?(I=new UpdateDecoderV2$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(K.pendingDs)),readVarUint$$module$libs$y_webrtc_min(I.restDecoder),I=readAndApplyDeleteSet$$module$libs$y_webrtc_min(I,B,K),K.pendingDs=F&&I?mergeUpdatesV2$$module$libs$y_webrtc_min([F,
I]):F||I):K.pendingDs=F;E&&(E=K.pendingStructs.update,K.pendingStructs=null,applyUpdateV2$$module$libs$y_webrtc_min(B.doc,E))},q,!1),readUpdate$$module$libs$y_webrtc_min=(a,g,q)=>readUpdateV2$$module$libs$y_webrtc_min(a,g,q,new UpdateDecoderV1$$module$libs$y_webrtc_min(a)),applyUpdateV2$$module$libs$y_webrtc_min=(a,g,q,u=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{g=createDecoder$$module$libs$y_webrtc_min(g);readUpdateV2$$module$libs$y_webrtc_min(g,a,q,new u(g))},applyUpdate$$module$libs$y_webrtc_min=
(a,g,q)=>applyUpdateV2$$module$libs$y_webrtc_min(a,g,q,UpdateDecoderV1$$module$libs$y_webrtc_min),encodeStateAsUpdateV2$$module$libs$y_webrtc_min=(a,g=new Uint8Array([0]),q=new UpdateEncoderV2$$module$libs$y_webrtc_min)=>{((B,E,F=new Map)=>{writeClientsStructs$$module$libs$y_webrtc_min(B,E.store,F);writeDeleteSet$$module$libs$y_webrtc_min(B,createDeleteSetFromStructStore$$module$libs$y_webrtc_min(E.store))})(q,a,decodeStateVector$$module$libs$y_webrtc_min(g));const u=[q.toUint8Array()];if(a.store.pendingDs&&
u.push(a.store.pendingDs),a.store.pendingStructs&&u.push(diffUpdateV2$$module$libs$y_webrtc_min(a.store.pendingStructs.update,g)),1<u.length){if(q.constructor===UpdateEncoderV1$$module$libs$y_webrtc_min)return mergeUpdates$$module$libs$y_webrtc_min(u.map((B,E)=>0===E?B:convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min(B)));if(q.constructor===UpdateEncoderV2$$module$libs$y_webrtc_min)return mergeUpdatesV2$$module$libs$y_webrtc_min(u)}return u[0]},encodeStateAsUpdate$$module$libs$y_webrtc_min=(a,
g)=>encodeStateAsUpdateV2$$module$libs$y_webrtc_min(a,g,new UpdateEncoderV1$$module$libs$y_webrtc_min),readStateVector$$module$libs$y_webrtc_min=a=>{const g=new Map,q=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);for(let u=0;u<q;u++){const B=readVarUint$$module$libs$y_webrtc_min(a.restDecoder),E=readVarUint$$module$libs$y_webrtc_min(a.restDecoder);g.set(B,E)}return g},decodeStateVector$$module$libs$y_webrtc_min=a=>readStateVector$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a))),
writeStateVector$$module$libs$y_webrtc_min=(a,g)=>(writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,g.size),from$$module$libs$y_webrtc_min(g.entries()).sort((q,u)=>u[0]-q[0]).forEach(([q,u])=>{writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,q);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,u)}),a),encodeStateVectorV2$$module$libs$y_webrtc_min=(a,g=new DSEncoderV2$$module$libs$y_webrtc_min)=>{a instanceof Map?writeStateVector$$module$libs$y_webrtc_min(g,a):writeStateVector$$module$libs$y_webrtc_min(g,
getStateVector$$module$libs$y_webrtc_min(a.store));return g.toUint8Array()},encodeStateVector$$module$libs$y_webrtc_min=a=>encodeStateVectorV2$$module$libs$y_webrtc_min(a,new DSEncoderV1$$module$libs$y_webrtc_min);class EventHandler$$module$libs$y_webrtc_min{constructor(){this.l=[]}}
const createEventHandler$$module$libs$y_webrtc_min=()=>new EventHandler$$module$libs$y_webrtc_min,addEventHandlerListener$$module$libs$y_webrtc_min=(a,g)=>a.l.push(g),removeEventHandlerListener$$module$libs$y_webrtc_min=(a,g)=>{const q=a.l,u=q.length;a.l=q.filter(B=>g!==B);u===a.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},callEventHandlerListeners$$module$libs$y_webrtc_min=(a,g,q)=>callAll$$module$libs$y_webrtc_min(a.l,[g,q]);
class ID$$module$libs$y_webrtc_min{constructor(a,g){this.client=a;this.clock=g}}
const compareIDs$$module$libs$y_webrtc_min=(a,g)=>a===g||null!==a&&null!==g&&a.client===g.client&&a.clock===g.clock,createID$$module$libs$y_webrtc_min=(a,g)=>new ID$$module$libs$y_webrtc_min(a,g),writeID$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a,g.client);writeVarUint$$module$libs$y_webrtc_min(a,g.clock)},readID$$module$libs$y_webrtc_min=a=>createID$$module$libs$y_webrtc_min(readVarUint$$module$libs$y_webrtc_min(a),readVarUint$$module$libs$y_webrtc_min(a)),findRootTypeKey$$module$libs$y_webrtc_min=
a=>{for(const [g,q]of a.doc.share.entries())if(q===a)return g;throw unexpectedCase$$module$libs$y_webrtc_min();},isParentOf$$module$libs$y_webrtc_min=(a,g)=>{for(;null!==g;){if(g.parent===a)return!0;g=g.parent._item}return!1},logType$$module$libs$y_webrtc_min=a=>{const g=[];for(a=a._start;a;)g.push(a),a=a.right;console.log("Children: ",g);console.log("Children content: ",g.filter(q=>!q.deleted).map(q=>q.content))};
class PermanentUserData$$module$libs$y_webrtc_min{constructor(a,g=a.getMap("users")){const q=new Map;this.yusers=g;this.doc=a;this.clients=new Map;this.dss=q;const u=(B,E)=>{const F=B.get("ds");B=B.get("ids");const K=I=>this.clients.set(I,E);F.observe(I=>{I.changes.added.forEach(J=>{J.content.getContent().forEach(H=>{H instanceof Uint8Array&&this.dss.set(E,mergeDeleteSets$$module$libs$y_webrtc_min([this.dss.get(E)||createDeleteSet$$module$libs$y_webrtc_min(),readDeleteSet$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(H)))]))})})});
this.dss.set(E,mergeDeleteSets$$module$libs$y_webrtc_min(F.map(I=>readDeleteSet$$module$libs$y_webrtc_min(new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(I))))));B.observe(I=>I.changes.added.forEach(J=>J.content.getContent().forEach(K)));B.forEach(K)};g.observe(B=>{B.keysChanged.forEach(E=>u(g.get(E),E))});g.forEach(u)}setUserMapping(a,g,q,{filter:u=()=>!0}={}){const B=this.yusers;let E=B.get(q);E||(E=new YMap$$module$libs$y_webrtc_min,E.set("ids",new YArray$$module$libs$y_webrtc_min),
E.set("ds",new YArray$$module$libs$y_webrtc_min),B.set(q,E));E.get("ids").push([g]);B.observe(F=>{setTimeout(()=>{var K=B.get(q);if(K!==E){E=K;this.clients.forEach((J,H)=>{q===J&&E.get("ids").push([H])});K=new DSEncoderV1$$module$libs$y_webrtc_min;const I=this.dss.get(q);I&&(writeDeleteSet$$module$libs$y_webrtc_min(K,I),E.get("ds").push([K.toUint8Array()]))}},0)});a.on("afterTransaction",F=>{setTimeout(()=>{const K=E.get("ds"),I=F.deleteSet;if(F.local&&0<I.clients.size&&u(F,I)){const J=new DSEncoderV1$$module$libs$y_webrtc_min;
writeDeleteSet$$module$libs$y_webrtc_min(J,I);K.push([J.toUint8Array()])}})})}getUserByClientId(a){return this.clients.get(a)||null}getUserByDeletedId(a){for(const [g,q]of this.dss.entries())if(isDeleted$$module$libs$y_webrtc_min(q,a))return g;return null}}class RelativePosition$$module$libs$y_webrtc_min{constructor(a,g,q,u=0){this.type=a;this.tname=g;this.item=q;this.assoc=u}}
const relativePositionToJSON$$module$libs$y_webrtc_min=a=>{const g={};return a.type&&(g.type=a.type),a.tname&&(g.tname=a.tname),a.item&&(g.item=a.item),null!=a.assoc&&(g.assoc=a.assoc),g},createRelativePositionFromJSON$$module$libs$y_webrtc_min=a=>new RelativePosition$$module$libs$y_webrtc_min(null==a.type?null:createID$$module$libs$y_webrtc_min(a.type.client,a.type.clock),a.tname||null,null==a.item?null:createID$$module$libs$y_webrtc_min(a.item.client,a.item.clock),null==a.assoc?0:a.assoc);
class AbsolutePosition$$module$libs$y_webrtc_min{constructor(a,g,q=0){this.type=a;this.index=g;this.assoc=q}}
const createRelativePosition$$module$libs$y_webrtc_min=(a,g,q)=>{let u=null,B=null;return null===a._item?B=findRootTypeKey$$module$libs$y_webrtc_min(a):u=createID$$module$libs$y_webrtc_min(a._item.id.client,a._item.id.clock),new RelativePosition$$module$libs$y_webrtc_min(u,B,g,q)},createRelativePositionFromTypeIndex$$module$libs$y_webrtc_min=(a,g,q=0)=>{let u=a._start;if(0>q){if(0===g)return createRelativePosition$$module$libs$y_webrtc_min(a,null,q);g--}for(;null!==u;){if(!u.deleted&&u.countable){if(u.length>
g)return createRelativePosition$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(u.id.client,u.id.clock+g),q);g-=u.length}if(null===u.right&&0>q)return createRelativePosition$$module$libs$y_webrtc_min(a,u.lastId,q);u=u.right}return createRelativePosition$$module$libs$y_webrtc_min(a,null,q)},encodeRelativePosition$$module$libs$y_webrtc_min=a=>{const g=createEncoder$$module$libs$y_webrtc_min(),{type:q,tname:u,item:B,assoc:E}=a;if(null!==B)writeVarUint$$module$libs$y_webrtc_min(g,0),writeID$$module$libs$y_webrtc_min(g,
B);else if(null!==u)write$$module$libs$y_webrtc_min(g,1),writeVarString$$module$libs$y_webrtc_min(g,u);else{if(null===q)throw unexpectedCase$$module$libs$y_webrtc_min();write$$module$libs$y_webrtc_min(g,2);writeID$$module$libs$y_webrtc_min(g,q)}writeVarInt$$module$libs$y_webrtc_min(g,E);return toUint8Array$$module$libs$y_webrtc_min(g)},decodeRelativePosition$$module$libs$y_webrtc_min=a=>{var g=createDecoder$$module$libs$y_webrtc_min(a);let q=a=null,u=null;switch(readVarUint$$module$libs$y_webrtc_min(g)){case 0:u=
readID$$module$libs$y_webrtc_min(g);break;case 1:q=readVarString$$module$libs$y_webrtc_min(g);break;case 2:a=readID$$module$libs$y_webrtc_min(g)}g=hasContent$$module$libs$y_webrtc_min(g)?readVarInt$$module$libs$y_webrtc_min(g):0;return new RelativePosition$$module$libs$y_webrtc_min(a,q,u,g)},createAbsolutePositionFromRelativePosition$$module$libs$y_webrtc_min=(a,g)=>{var q=g.store;const u=a.item,B=a.type,E=a.tname;var F=a.assoc,K=null;let I=0;if(null!==u){if(getState$$module$libs$y_webrtc_min(q,u.client)<=
u.clock)return null;g=followRedone$$module$libs$y_webrtc_min(q,u);q=g.item;if(!(q instanceof Item$$module$libs$y_webrtc_min))return null;if(K=q.parent,null===K._item||!K._item.deleted)for(I=q.deleted||!q.countable?0:g.diff+(0<=F?0:1),F=q.left;null!==F;)!F.deleted&&F.countable&&(I+=F.length),F=F.left}else{if(null!==E)K=g.get(E);else{if(null===B)throw unexpectedCase$$module$libs$y_webrtc_min();if(getState$$module$libs$y_webrtc_min(q,B.client)<=B.clock)return null;({item:K}=followRedone$$module$libs$y_webrtc_min(q,
B));if(!(K instanceof Item$$module$libs$y_webrtc_min&&K.content instanceof ContentType$$module$libs$y_webrtc_min))return null;K=K.content.type}I=0<=F?K._length:0}return((J,H,N=0)=>new AbsolutePosition$$module$libs$y_webrtc_min(J,H,N))(K,I,a.assoc)},compareRelativePositions$$module$libs$y_webrtc_min=(a,g)=>a===g||null!==a&&null!==g&&a.tname===g.tname&&compareIDs$$module$libs$y_webrtc_min(a.item,g.item)&&compareIDs$$module$libs$y_webrtc_min(a.type,g.type)&&a.assoc===g.assoc;
class Snapshot$$module$libs$y_webrtc_min{constructor(a,g){this.ds=a;this.sv=g}}
const equalSnapshots$$module$libs$y_webrtc_min=(a,g)=>{var q=a.ds.clients;const u=g.ds.clients;a=a.sv;g=g.sv;if(a.size!==g.size||q.size!==u.size)return!1;for(const [B,E]of a.entries())if(g.get(B)!==E)return!1;for(const [B,E]of q.entries()){q=u.get(B)||[];if(E.length!==q.length)return!1;for(g=0;g<E.length;g++){a=E[g];const F=q[g];if(a.clock!==F.clock||a.len!==F.len)return!1}}return!0},encodeSnapshotV2$$module$libs$y_webrtc_min=(a,g=new DSEncoderV2$$module$libs$y_webrtc_min)=>(writeDeleteSet$$module$libs$y_webrtc_min(g,
a.ds),writeStateVector$$module$libs$y_webrtc_min(g,a.sv),g.toUint8Array()),encodeSnapshot$$module$libs$y_webrtc_min=a=>encodeSnapshotV2$$module$libs$y_webrtc_min(a,new DSEncoderV1$$module$libs$y_webrtc_min),decodeSnapshotV2$$module$libs$y_webrtc_min=(a,g=new DSDecoderV2$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a)))=>new Snapshot$$module$libs$y_webrtc_min(readDeleteSet$$module$libs$y_webrtc_min(g),readStateVector$$module$libs$y_webrtc_min(g)),decodeSnapshot$$module$libs$y_webrtc_min=
a=>decodeSnapshotV2$$module$libs$y_webrtc_min(a,new DSDecoderV1$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(a))),createSnapshot$$module$libs$y_webrtc_min=(a,g)=>new Snapshot$$module$libs$y_webrtc_min(a,g),emptySnapshot$$module$libs$y_webrtc_min=createSnapshot$$module$libs$y_webrtc_min(createDeleteSet$$module$libs$y_webrtc_min(),new Map),snapshot$$module$libs$y_webrtc_min=a=>createSnapshot$$module$libs$y_webrtc_min(createDeleteSetFromStructStore$$module$libs$y_webrtc_min(a.store),
getStateVector$$module$libs$y_webrtc_min(a.store)),isVisible$$module$libs$y_webrtc_min=(a,g)=>void 0===g?!a.deleted:g.sv.has(a.id.client)&&(g.sv.get(a.id.client)||0)>a.id.clock&&!isDeleted$$module$libs$y_webrtc_min(g.ds,a.id),splitSnapshotAffectedStructs$$module$libs$y_webrtc_min=(a,g)=>{const q=setIfUndefined$$module$libs$y_webrtc_min(a.meta,splitSnapshotAffectedStructs$$module$libs$y_webrtc_min,create$1$$module$libs$y_webrtc_min),u=a.doc.store;q.has(g)||(g.sv.forEach((B,E)=>{B<getState$$module$libs$y_webrtc_min(u,
E)&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(E,B))}),iterateDeletedStructs$$module$libs$y_webrtc_min(a,g.ds,B=>{}),q.add(g))},createDocFromSnapshot$$module$libs$y_webrtc_min=(a,g,q=new Doc$$module$libs$y_webrtc_min)=>{if(a.gc)throw Error("Garbage-collection must be disabled in `originDoc`!");const {sv:u,ds:B}=g,E=new UpdateEncoderV2$$module$libs$y_webrtc_min;return a.transact(F=>{let K=0;u.forEach(I=>{0<I&&K++});writeVarUint$$module$libs$y_webrtc_min(E.restEncoder,
K);for(const [I,J]of u){if(0===J)continue;J<getState$$module$libs$y_webrtc_min(a.store,I)&&getItemCleanStart$$module$libs$y_webrtc_min(F,createID$$module$libs$y_webrtc_min(I,J));const H=a.store.clients.get(I)||[],N=findIndexSS$$module$libs$y_webrtc_min(H,J-1);writeVarUint$$module$libs$y_webrtc_min(E.restEncoder,N+1);E.writeClient(I);writeVarUint$$module$libs$y_webrtc_min(E.restEncoder,0);for(let T=0;T<=N;T++)H[T].write(E,0)}writeDeleteSet$$module$libs$y_webrtc_min(E,B)}),applyUpdateV2$$module$libs$y_webrtc_min(q,
E.toUint8Array(),"snapshot"),q};class StructStore$$module$libs$y_webrtc_min{constructor(){this.clients=new Map;this.pendingDs=this.pendingStructs=null}}
const getStateVector$$module$libs$y_webrtc_min=a=>{const g=new Map;return a.clients.forEach((q,u)=>{q=q[q.length-1];g.set(u,q.id.clock+q.length)}),g},getState$$module$libs$y_webrtc_min=(a,g)=>{a=a.clients.get(g);if(void 0===a)return 0;a=a[a.length-1];return a.id.clock+a.length},addStruct$$module$libs$y_webrtc_min=(a,g)=>{let q=a.clients.get(g.id.client);if(void 0===q)q=[],a.clients.set(g.id.client,q);else if(a=q[q.length-1],a.id.clock+a.length!==g.id.clock)throw unexpectedCase$$module$libs$y_webrtc_min();
q.push(g)},findIndexSS$$module$libs$y_webrtc_min=(a,g)=>{let q=0,u=a.length-1,B=a[u],E=B.id.clock;if(E===g)return u;let F=floor$$module$libs$y_webrtc_min(g/(E+B.length-1)*u);for(;q<=u;){if(B=a[F],E=B.id.clock,E<=g){if(g<E+B.length)return F;q=F+1}else u=F-1;F=floor$$module$libs$y_webrtc_min((q+u)/2)}throw unexpectedCase$$module$libs$y_webrtc_min();},getItem$$module$libs$y_webrtc_min=(a,g)=>{a=a.clients.get(g.client);return a[findIndexSS$$module$libs$y_webrtc_min(a,g.clock)]},findIndexCleanStart$$module$libs$y_webrtc_min=
(a,g,q)=>{const u=findIndexSS$$module$libs$y_webrtc_min(g,q),B=g[u];return B.id.clock<q&&B instanceof Item$$module$libs$y_webrtc_min?(g.splice(u+1,0,splitItem$$module$libs$y_webrtc_min(a,B,q-B.id.clock)),u+1):u},getItemCleanStart$$module$libs$y_webrtc_min=(a,g)=>{const q=a.doc.store.clients.get(g.client);return q[findIndexCleanStart$$module$libs$y_webrtc_min(a,q,g.clock)]},getItemCleanEnd$$module$libs$y_webrtc_min=(a,g,q)=>{g=g.clients.get(q.client);const u=findIndexSS$$module$libs$y_webrtc_min(g,
q.clock),B=g[u];return q.clock!==B.id.clock+B.length-1&&B.constructor!==GC$$module$libs$y_webrtc_min&&g.splice(u+1,0,splitItem$$module$libs$y_webrtc_min(a,B,q.clock-B.id.clock+1)),B},iterateStructs$$module$libs$y_webrtc_min=(a,g,q,u,B)=>{if(0!==u){u=q+u;var E=findIndexCleanStart$$module$libs$y_webrtc_min(a,g,q);do q=g[E++],u<q.id.clock+q.length&&findIndexCleanStart$$module$libs$y_webrtc_min(a,g,u),B(q);while(E<g.length&&g[E].id.clock<u)}};
class Transaction$$module$libs$y_webrtc_min{constructor(a,g,q){this.doc=a;this.deleteSet=new DeleteSet$$module$libs$y_webrtc_min;this.beforeState=getStateVector$$module$libs$y_webrtc_min(a.store);this.afterState=new Map;this.changed=new Map;this.changedParentTypes=new Map;this._mergeStructs=[];this.origin=g;this.meta=new Map;this.local=q;this.subdocsAdded=new Set;this.subdocsRemoved=new Set;this.subdocsLoaded=new Set}}
const writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min=(a,g)=>{var q;if(q=!(0===g.deleteSet.clients.size&&!((u,B)=>{for(const [E,F]of u)if(B(F,E))return!0;return!1})(g.afterState,(u,B)=>g.beforeState.get(B)!==u)))sortAndMergeDeleteSet$$module$libs$y_webrtc_min(g.deleteSet),writeClientsStructs$$module$libs$y_webrtc_min(a,g.doc.store,g.beforeState),q=(writeDeleteSet$$module$libs$y_webrtc_min(a,g.deleteSet),!0);return q},addChangedTypeToTransaction$$module$libs$y_webrtc_min=(a,g,q)=>{const u=
g._item;(null===u||u.id.clock<(a.beforeState.get(u.id.client)||0)&&!u.deleted)&&setIfUndefined$$module$libs$y_webrtc_min(a.changed,g,create$1$$module$libs$y_webrtc_min).add(q)},tryToMergeWithLeft$$module$libs$y_webrtc_min=(a,g)=>{const q=a[g-1],u=a[g];q.deleted===u.deleted&&q.constructor===u.constructor&&q.mergeWith(u)&&(a.splice(g,1),u instanceof Item$$module$libs$y_webrtc_min&&null!==u.parentSub&&u.parent._map.get(u.parentSub)===u&&u.parent._map.set(u.parentSub,q))},tryGcDeleteSet$$module$libs$y_webrtc_min=
(a,g,q)=>{for(const [u,B]of a.clients.entries()){a=g.clients.get(u);for(let E=B.length-1;0<=E;E--){const F=B[E],K=F.clock+F.len;for(let I=findIndexSS$$module$libs$y_webrtc_min(a,F.clock),J=a[I];I<a.length&&J.id.clock<K;J=a[++I]){const H=a[I];if(F.clock+F.len<=H.id.clock)break;H instanceof Item$$module$libs$y_webrtc_min&&H.deleted&&!H.keep&&q(H)&&H.gc(g,!1)}}}},tryMergeDeleteSet$$module$libs$y_webrtc_min=(a,g)=>{a.clients.forEach((q,u)=>{u=g.clients.get(u);for(let B=q.length-1;0<=B;B--){const E=q[B];
for(let F=min$$module$libs$y_webrtc_min(u.length-1,1+findIndexSS$$module$libs$y_webrtc_min(u,E.clock+E.len-1)),K=u[F];0<F&&K.id.clock>=E.clock;K=u[--F])tryToMergeWithLeft$$module$libs$y_webrtc_min(u,F)}})},tryGc$$module$libs$y_webrtc_min=(a,g,q)=>{tryGcDeleteSet$$module$libs$y_webrtc_min(a,g,q);tryMergeDeleteSet$$module$libs$y_webrtc_min(a,g)},cleanupTransactions$$module$libs$y_webrtc_min=(a,g)=>{if(g<a.length){const B=a[g],E=B.doc,F=E.store;var q=B.deleteSet,u=B._mergeStructs;try{sortAndMergeDeleteSet$$module$libs$y_webrtc_min(q);
B.afterState=getStateVector$$module$libs$y_webrtc_min(B.doc.store);E.emit("beforeObserverCalls",[B,E]);const K=[];B.changed.forEach((I,J)=>K.push(()=>{null!==J._item&&J._item.deleted||J._callObserver(B,I)}));K.push(()=>{B.changedParentTypes.forEach((I,J)=>K.push(()=>{null!==J._item&&J._item.deleted||((I=I.filter(H=>null===H.target._item||!H.target._item.deleted)).forEach(H=>{H.currentTarget=J}),I.sort((H,N)=>H.path.length-N.path.length),callEventHandlerListeners$$module$libs$y_webrtc_min(J._dEH,I,
B))}));K.push(()=>E.emit("afterTransaction",[B,E]))});callAll$$module$libs$y_webrtc_min(K,[])}finally{E.gc&&tryGcDeleteSet$$module$libs$y_webrtc_min(q,F,E.gcFilter);tryMergeDeleteSet$$module$libs$y_webrtc_min(q,F);B.afterState.forEach((H,N)=>{var T=B.beforeState.get(N)||0;if(T!==H)for(H=F.clients.get(N),T=max$$module$libs$y_webrtc_min(findIndexSS$$module$libs$y_webrtc_min(H,T),1),N=H.length-1;N>=T;N--)tryToMergeWithLeft$$module$libs$y_webrtc_min(H,N)});for(q=0;q<u.length;q++){const {client:H,clock:N}=
u[q].id,T=F.clients.get(H),O=findIndexSS$$module$libs$y_webrtc_min(T,N);O+1<T.length&&tryToMergeWithLeft$$module$libs$y_webrtc_min(T,O+1);0<O&&tryToMergeWithLeft$$module$libs$y_webrtc_min(T,O)}if(B.local||B.afterState.get(E.clientID)===B.beforeState.get(E.clientID)||(print$$module$libs$y_webrtc_min(ORANGE$$module$libs$y_webrtc_min,BOLD$$module$libs$y_webrtc_min,"[yjs] ",UNBOLD$$module$libs$y_webrtc_min,RED$$module$libs$y_webrtc_min,"Changed the client-id because another client seems to be using it."),
E.clientID=uint32$$module$libs$y_webrtc_min()),E.emit("afterTransactionCleanup",[B,E]),E._observers.has("update"))u=new UpdateEncoderV1$$module$libs$y_webrtc_min,writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min(u,B)&&E.emit("update",[u.toUint8Array(),B.origin,E,B]);E._observers.has("updateV2")&&(u=new UpdateEncoderV2$$module$libs$y_webrtc_min,writeUpdateMessageFromTransaction$$module$libs$y_webrtc_min(u,B)&&E.emit("updateV2",[u.toUint8Array(),B.origin,E,B]));const {subdocsAdded:K,subdocsLoaded:I,
subdocsRemoved:J}=B;(0<K.size||0<J.size||0<I.size)&&(K.forEach(H=>{H.clientID=E.clientID;null==H.collectionid&&(H.collectionid=E.collectionid);E.subdocs.add(H)}),J.forEach(H=>E.subdocs.delete(H)),E.emit("subdocs",[{loaded:I,added:K,removed:J},E,B]),J.forEach(H=>H.destroy()));a.length<=g+1?(E._transactionCleanups=[],E.emit("afterAllTransactions",[E,a])):cleanupTransactions$$module$libs$y_webrtc_min(a,g+1)}}},transact$$module$libs$y_webrtc_min=(a,g,q=null,u=!0)=>{const B=a._transactionCleanups;let E=
!1,F=null;null===a._transaction&&(E=!0,a._transaction=new Transaction$$module$libs$y_webrtc_min(a,q,u),B.push(a._transaction),1===B.length&&a.emit("beforeAllTransactions",[a]),a.emit("beforeTransaction",[a._transaction,a]));try{F=g(a._transaction)}finally{E&&(g=a._transaction===B[0],a._transaction=null,g&&cleanupTransactions$$module$libs$y_webrtc_min(B,0))}return F};class StackItem$$module$libs$y_webrtc_min{constructor(a,g){this.insertions=g;this.deletions=a;this.meta=new Map}}
const clearUndoManagerStackItem$$module$libs$y_webrtc_min=(a,g,q)=>{iterateDeletedStructs$$module$libs$y_webrtc_min(a,q.deletions,u=>{u instanceof Item$$module$libs$y_webrtc_min&&g.scope.some(B=>isParentOf$$module$libs$y_webrtc_min(B,u))&&keepItem$$module$libs$y_webrtc_min(u,!1)})},popStackItem$$module$libs$y_webrtc_min=(a,g,q)=>{let u=null,B=null;const E=a.doc,F=a.scope;(transact$$module$libs$y_webrtc_min(E,K=>{for(;0<g.length&&null===u;){const I=E.store,J=g.pop(),H=new Set,N=[];let T=!1;iterateDeletedStructs$$module$libs$y_webrtc_min(K,
J.insertions,O=>{if(O instanceof Item$$module$libs$y_webrtc_min){if(null!==O.redone){let {item:W,diff:ba}=followRedone$$module$libs$y_webrtc_min(I,O.id);0<ba&&(W=getItemCleanStart$$module$libs$y_webrtc_min(K,createID$$module$libs$y_webrtc_min(W.id.client,W.id.clock+ba)));O=W}!O.deleted&&F.some(W=>isParentOf$$module$libs$y_webrtc_min(W,O))&&N.push(O)}});iterateDeletedStructs$$module$libs$y_webrtc_min(K,J.deletions,O=>{O instanceof Item$$module$libs$y_webrtc_min&&F.some(W=>isParentOf$$module$libs$y_webrtc_min(W,
O))&&!isDeleted$$module$libs$y_webrtc_min(J.insertions,O.id)&&H.add(O)});H.forEach(O=>{T=null!==redoItem$$module$libs$y_webrtc_min(K,O,H,J.insertions,a.ignoreRemoteMapChanges,a)||T});for(let O=N.length-1;0<=O;O--){const W=N[O];a.deleteFilter(W)&&(W.delete(K),T=!0)}u=T?J:null}K.changed.forEach((I,J)=>{I.has(null)&&J._searchMarker&&(J._searchMarker.length=0)});B=K},a),null!=u)&&a.emit("stack-item-popped",[{stackItem:u,type:q,changedParentTypes:B.changedParentTypes},a]);return u};
class UndoManager$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,{captureTimeout:g=500,captureTransaction:q=K=>!0,deleteFilter:u=()=>!0,trackedOrigins:B=new Set([null]),ignoreRemoteMapChanges:E=!1,doc:F=isArray$$module$libs$y_webrtc_min(a)?a[0].doc:a.doc}={}){super();this.scope=[];this.addToScope(a);this.deleteFilter=u;B.add(this);this.trackedOrigins=B;this.captureTransaction=q;this.undoStack=[];this.redoStack=[];this.redoing=this.undoing=!1;this.doc=F;this.lastChange=
0;this.ignoreRemoteMapChanges=E;this.captureTimeout=g;this.afterTransactionHandler=K=>{if(this.captureTransaction(K)&&this.scope.some(W=>K.changedParentTypes.has(W))&&(this.trackedOrigins.has(K.origin)||K.origin&&this.trackedOrigins.has(K.origin.constructor))){var I=this.undoing,J=this.redoing,H=I?this.redoStack:this.undoStack;I?this.stopCapturing():J||this.clear(!1,!0);var N=new DeleteSet$$module$libs$y_webrtc_min;K.afterState.forEach((W,ba)=>{const fa=K.beforeState.get(ba)||0;W-=fa;0<W&&addToDeleteSet$$module$libs$y_webrtc_min(N,
ba,fa,W)});var T=getUnixTime$$module$libs$y_webrtc_min(),O=!1;if(0<this.lastChange&&T-this.lastChange<this.captureTimeout&&0<H.length&&!I&&!J){const W=H[H.length-1];W.deletions=mergeDeleteSets$$module$libs$y_webrtc_min([W.deletions,K.deleteSet]);W.insertions=mergeDeleteSets$$module$libs$y_webrtc_min([W.insertions,N])}else H.push(new StackItem$$module$libs$y_webrtc_min(K.deleteSet,N)),O=!0;I||J||(this.lastChange=T);iterateDeletedStructs$$module$libs$y_webrtc_min(K,K.deleteSet,W=>{W instanceof Item$$module$libs$y_webrtc_min&&
this.scope.some(ba=>isParentOf$$module$libs$y_webrtc_min(ba,W))&&keepItem$$module$libs$y_webrtc_min(W,!0)});I=[{stackItem:H[H.length-1],origin:K.origin,type:I?"redo":"undo",changedParentTypes:K.changedParentTypes},this];O?this.emit("stack-item-added",I):this.emit("stack-item-updated",I)}};this.doc.on("afterTransaction",this.afterTransactionHandler);this.doc.on("destroy",()=>{this.destroy()})}addToScope(a){(a=isArray$$module$libs$y_webrtc_min(a)?a:[a]).forEach(g=>{this.scope.every(q=>q!==g)&&this.scope.push(g)})}addTrackedOrigin(a){this.trackedOrigins.add(a)}removeTrackedOrigin(a){this.trackedOrigins.delete(a)}clear(a=
!0,g=!0){(a&&this.canUndo()||g&&this.canRedo())&&this.doc.transact(q=>{a&&(this.undoStack.forEach(u=>clearUndoManagerStackItem$$module$libs$y_webrtc_min(q,this,u)),this.undoStack=[]);g&&(this.redoStack.forEach(u=>clearUndoManagerStackItem$$module$libs$y_webrtc_min(q,this,u)),this.redoStack=[]);this.emit("stack-cleared",[{undoStackCleared:a,redoStackCleared:g}])})}stopCapturing(){this.lastChange=0}undo(){let a;this.undoing=!0;try{a=popStackItem$$module$libs$y_webrtc_min(this,this.undoStack,"undo")}finally{this.undoing=
!1}return a}redo(){let a;this.redoing=!0;try{a=popStackItem$$module$libs$y_webrtc_min(this,this.redoStack,"redo")}finally{this.redoing=!1}return a}canUndo(){return 0<this.undoStack.length}canRedo(){return 0<this.redoStack.length}destroy(){this.trackedOrigins.delete(this);this.doc.off("afterTransaction",this.afterTransactionHandler);super.destroy()}}
class LazyStructReader$$module$libs$y_webrtc_min{constructor(a,g){this.gen=function*(q){const u=readVarUint$$module$libs$y_webrtc_min(q.restDecoder);for(let E=0;E<u;E++){const F=readVarUint$$module$libs$y_webrtc_min(q.restDecoder),K=q.readClient();let I=readVarUint$$module$libs$y_webrtc_min(q.restDecoder);for(let J=0;J<F;J++){var B=q.readInfo();if(10===B)B=readVarUint$$module$libs$y_webrtc_min(q.restDecoder),yield new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(K,I),B),I+=B;
else if(0!=(31&B)){const H=0==(192&B);B=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(K,I),null,128==(128&B)?q.readLeftID():null,null,64==(64&B)?q.readRightID():null,H?q.readParentInfo()?q.readString():q.readLeftID():null,H&&32==(32&B)?q.readString():null,readItemContent$$module$libs$y_webrtc_min(q,B));yield B;I+=B.length}else B=q.readLen(),yield new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(K,I),B),I+=B}}}(a);this.curr=null;this.done=!1;this.filterSkips=
g;this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===Skip$$module$libs$y_webrtc_min);return this.curr}}
const logUpdate$$module$libs$y_webrtc_min=a=>logUpdateV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),logUpdateV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{var q=[];a=new g(createDecoder$$module$libs$y_webrtc_min(a));g=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);for(let u=g.curr;null!==u;u=g.next())q.push(u);print$$module$libs$y_webrtc_min("Structs: ",q);q=readDeleteSet$$module$libs$y_webrtc_min(a);print$$module$libs$y_webrtc_min("DeleteSet: ",
q)},decodeUpdate$$module$libs$y_webrtc_min=a=>decodeUpdateV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),decodeUpdateV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{const q=[];a=new g(createDecoder$$module$libs$y_webrtc_min(a));g=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);for(let u=g.curr;null!==u;u=g.next())q.push(u);return{structs:q,ds:readDeleteSet$$module$libs$y_webrtc_min(a)}};
class LazyStructWriter$$module$libs$y_webrtc_min{constructor(a){this.written=this.startClock=this.currClient=0;this.encoder=a;this.clientStructs=[]}}
const mergeUpdates$$module$libs$y_webrtc_min=a=>mergeUpdatesV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min),encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min=(a,g=DSEncoderV2$$module$libs$y_webrtc_min,q=UpdateDecoderV2$$module$libs$y_webrtc_min)=>{g=new g;q=new LazyStructReader$$module$libs$y_webrtc_min(new q(createDecoder$$module$libs$y_webrtc_min(a)),!1);let u=q.curr;if(null!==u){a=0;let B=u.id.client,E=0!==u.id.clock,F=E?
0:u.id.clock+u.length;for(;null!==u;u=q.next())B!==u.id.client&&(0!==F&&(a++,writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,B),writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,F)),B=u.id.client,F=0,E=0!==u.id.clock),u.constructor===Skip$$module$libs$y_webrtc_min&&(E=!0),E||(F=u.id.clock+u.length);0!==F&&(a++,writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,B),writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,F));q=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(q,
a);writeUint8Array$$module$libs$y_webrtc_min(q,toUint8Array$$module$libs$y_webrtc_min(g.restEncoder));return g.restEncoder=q,g.toUint8Array()}return writeVarUint$$module$libs$y_webrtc_min(g.restEncoder,0),g.toUint8Array()},encodeStateVectorFromUpdate$$module$libs$y_webrtc_min=a=>encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min(a,DSEncoderV1$$module$libs$y_webrtc_min,UpdateDecoderV1$$module$libs$y_webrtc_min),parseUpdateMetaV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min)=>
{const q=new Map,u=new Map;a=new LazyStructReader$$module$libs$y_webrtc_min(new g(createDecoder$$module$libs$y_webrtc_min(a)),!1);g=a.curr;if(null!==g){let B=g.id.client,E=g.id.clock;for(q.set(B,E);null!==g;g=a.next())B!==g.id.client&&(u.set(B,E),q.set(g.id.client,g.id.clock),B=g.id.client),E=g.id.clock+g.length;u.set(B,E)}return{from:q,to:u}},parseUpdateMeta$$module$libs$y_webrtc_min=a=>parseUpdateMetaV2$$module$libs$y_webrtc_min(a,UpdateDecoderV1$$module$libs$y_webrtc_min),sliceStruct$$module$libs$y_webrtc_min=
(a,g)=>{if(a.constructor===GC$$module$libs$y_webrtc_min){const {client:B,clock:E}=a.id;return new GC$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(B,E+g),a.length-g)}if(a.constructor===Skip$$module$libs$y_webrtc_min){const {client:B,clock:E}=a.id;return new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(B,E+g),a.length-g)}const {client:q,clock:u}=a.id;return new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(q,u+g),null,createID$$module$libs$y_webrtc_min(q,
u+g-1),null,a.rightOrigin,a.parent,a.parentSub,a.content.splice(g))},mergeUpdatesV2$$module$libs$y_webrtc_min=(a,g=UpdateDecoderV2$$module$libs$y_webrtc_min,q=UpdateEncoderV2$$module$libs$y_webrtc_min)=>{if(1===a.length)return a[0];a=a.map(I=>new g(createDecoder$$module$libs$y_webrtc_min(I)));let u=a.map(I=>new LazyStructReader$$module$libs$y_webrtc_min(I,!0)),B=null;q=new q;const E=new LazyStructWriter$$module$libs$y_webrtc_min(q);for(;u=u.filter(I=>null!==I.curr),u.sort((I,J)=>{if(I.curr.id.client===
J.curr.id.client){const H=I.curr.id.clock-J.curr.id.clock;return 0===H?I.curr.constructor===J.curr.constructor?0:I.curr.constructor===Skip$$module$libs$y_webrtc_min?1:-1:H}return J.curr.id.client-I.curr.id.client}),0!==u.length;){const I=u[0],J=I.curr.id.client;if(null!==B){for(var F=I.curr,K=!1;null!==F&&F.id.clock+F.length<=B.struct.id.clock+B.struct.length&&F.id.client>=B.struct.id.client;)F=I.next(),K=!0;if(null===F||F.id.client!==J||K&&F.id.clock>B.struct.id.clock+B.struct.length)continue;J!==
B.struct.id.client?(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(E,B.struct,B.offset),B={struct:F,offset:0},I.next()):B.struct.id.clock+B.struct.length<F.id.clock?B.struct.constructor===Skip$$module$libs$y_webrtc_min?B.struct.length=F.id.clock+F.length-B.struct.id.clock:(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(E,B.struct,B.offset),F=F.id.clock-B.struct.id.clock-B.struct.length,B={struct:new Skip$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(J,B.struct.id.clock+
B.struct.length),F),offset:0}):(K=B.struct.id.clock+B.struct.length-F.id.clock,0<K&&(B.struct.constructor===Skip$$module$libs$y_webrtc_min?B.struct.length-=K:F=sliceStruct$$module$libs$y_webrtc_min(F,K)),B.struct.mergeWith(F)||(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(E,B.struct,B.offset),B={struct:F,offset:0},I.next()))}else B={struct:I.curr,offset:0},I.next();for(F=I.curr;null!==F&&F.id.client===J&&F.id.clock===B.struct.id.clock+B.struct.length&&F.constructor!==Skip$$module$libs$y_webrtc_min;F=
I.next())writeStructToLazyStructWriter$$module$libs$y_webrtc_min(E,B.struct,B.offset),B={struct:F,offset:0}}null!==B&&(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(E,B.struct,B.offset),B=null);finishLazyStructWriting$$module$libs$y_webrtc_min(E);a=a.map(I=>readDeleteSet$$module$libs$y_webrtc_min(I));a=mergeDeleteSets$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(q,a),q.toUint8Array()},diffUpdateV2$$module$libs$y_webrtc_min=(a,g,q=UpdateDecoderV2$$module$libs$y_webrtc_min,
u=UpdateEncoderV2$$module$libs$y_webrtc_min)=>{g=decodeStateVector$$module$libs$y_webrtc_min(g);u=new u;const B=new LazyStructWriter$$module$libs$y_webrtc_min(u);a=new q(createDecoder$$module$libs$y_webrtc_min(a));for(q=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);q.curr;){const E=q.curr,F=E.id.client,K=g.get(F)||0;if(q.curr.constructor!==Skip$$module$libs$y_webrtc_min)if(E.id.clock+E.length>K)for(writeStructToLazyStructWriter$$module$libs$y_webrtc_min(B,E,max$$module$libs$y_webrtc_min(K-
E.id.clock,0)),q.next();q.curr&&q.curr.id.client===F;)writeStructToLazyStructWriter$$module$libs$y_webrtc_min(B,q.curr,0),q.next();else for(;q.curr&&q.curr.id.client===F&&q.curr.id.clock+q.curr.length<=K;)q.next();else q.next()}finishLazyStructWriting$$module$libs$y_webrtc_min(B);g=readDeleteSet$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(u,g),u.toUint8Array()},diffUpdate$$module$libs$y_webrtc_min=(a,g)=>diffUpdateV2$$module$libs$y_webrtc_min(a,g,UpdateDecoderV1$$module$libs$y_webrtc_min,
UpdateEncoderV1$$module$libs$y_webrtc_min),flushLazyStructWriter$$module$libs$y_webrtc_min=a=>{0<a.written&&(a.clientStructs.push({written:a.written,restEncoder:toUint8Array$$module$libs$y_webrtc_min(a.encoder.restEncoder)}),a.encoder.restEncoder=createEncoder$$module$libs$y_webrtc_min(),a.written=0)},writeStructToLazyStructWriter$$module$libs$y_webrtc_min=(a,g,q)=>{0<a.written&&a.currClient!==g.id.client&&flushLazyStructWriter$$module$libs$y_webrtc_min(a);0===a.written&&(a.currClient=g.id.client,
a.encoder.writeClient(g.id.client),writeVarUint$$module$libs$y_webrtc_min(a.encoder.restEncoder,g.id.clock+q));g.write(a.encoder,q);a.written++},finishLazyStructWriting$$module$libs$y_webrtc_min=a=>{flushLazyStructWriter$$module$libs$y_webrtc_min(a);const g=a.encoder.restEncoder;writeVarUint$$module$libs$y_webrtc_min(g,a.clientStructs.length);for(let q=0;q<a.clientStructs.length;q++){const u=a.clientStructs[q];writeVarUint$$module$libs$y_webrtc_min(g,u.written);writeUint8Array$$module$libs$y_webrtc_min(g,
u.restEncoder)}},convertUpdateFormat$$module$libs$y_webrtc_min=(a,g,q,u)=>{a=new q(createDecoder$$module$libs$y_webrtc_min(a));q=new LazyStructReader$$module$libs$y_webrtc_min(a,!1);u=new u;const B=new LazyStructWriter$$module$libs$y_webrtc_min(u);for(let E=q.curr;null!==E;E=q.next())writeStructToLazyStructWriter$$module$libs$y_webrtc_min(B,g(E),0);finishLazyStructWriting$$module$libs$y_webrtc_min(B);g=readDeleteSet$$module$libs$y_webrtc_min(a);return writeDeleteSet$$module$libs$y_webrtc_min(u,g),
u.toUint8Array()},createObfuscator$$module$libs$y_webrtc_min=({formatting:a=!0,subdocs:g=!0,yxml:q=!0}={})=>{let u=0;const B=create$$module$libs$y_webrtc_min(),E=create$$module$libs$y_webrtc_min(),F=create$$module$libs$y_webrtc_min(),K=create$$module$libs$y_webrtc_min();return K.set(null,null),I=>{switch(I.constructor){case GC$$module$libs$y_webrtc_min:case Skip$$module$libs$y_webrtc_min:return I;case Item$$module$libs$y_webrtc_min:var J=I.content;switch(J.constructor){case ContentDeleted$$module$libs$y_webrtc_min:break;
case ContentType$$module$libs$y_webrtc_min:q&&(J=J.type,J instanceof YXmlElement$$module$libs$y_webrtc_min&&(J.nodeName=setIfUndefined$$module$libs$y_webrtc_min(E,J.nodeName,()=>"node-"+u)),J instanceof YXmlHook$$module$libs$y_webrtc_min&&(J.hookName=setIfUndefined$$module$libs$y_webrtc_min(E,J.hookName,()=>"hook-"+u)));break;case ContentAny$$module$libs$y_webrtc_min:J.arr=J.arr.map(()=>u);break;case ContentBinary$$module$libs$y_webrtc_min:J.content=new Uint8Array([u]);break;case ContentDoc$$module$libs$y_webrtc_min:g&&
(J.opts={},J.doc.guid=u+"");break;case ContentEmbed$$module$libs$y_webrtc_min:J.embed={};break;case ContentFormat$$module$libs$y_webrtc_min:a&&(J.key=setIfUndefined$$module$libs$y_webrtc_min(F,J.key,()=>u+""),J.value=setIfUndefined$$module$libs$y_webrtc_min(K,J.value,()=>({i:u})));break;case ContentJSON$$module$libs$y_webrtc_min:J.arr=J.arr.map(()=>u);break;case ContentString$$module$libs$y_webrtc_min:J.str=repeat$$module$libs$y_webrtc_min(u%10+"",J.str.length);break;default:unexpectedCase$$module$libs$y_webrtc_min()}return I.parentSub&&
(I.parentSub=setIfUndefined$$module$libs$y_webrtc_min(B,I.parentSub,()=>u+"")),u++,I;default:unexpectedCase$$module$libs$y_webrtc_min()}}},obfuscateUpdate$$module$libs$y_webrtc_min=(a,g)=>convertUpdateFormat$$module$libs$y_webrtc_min(a,createObfuscator$$module$libs$y_webrtc_min(g),UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min),obfuscateUpdateV2$$module$libs$y_webrtc_min=(a,g)=>convertUpdateFormat$$module$libs$y_webrtc_min(a,createObfuscator$$module$libs$y_webrtc_min(g),
UpdateDecoderV2$$module$libs$y_webrtc_min,UpdateEncoderV2$$module$libs$y_webrtc_min),convertUpdateFormatV1ToV2$$module$libs$y_webrtc_min=a=>convertUpdateFormat$$module$libs$y_webrtc_min(a,id$$module$libs$y_webrtc_min,UpdateDecoderV1$$module$libs$y_webrtc_min,UpdateEncoderV2$$module$libs$y_webrtc_min),convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min=a=>convertUpdateFormat$$module$libs$y_webrtc_min(a,id$$module$libs$y_webrtc_min,UpdateDecoderV2$$module$libs$y_webrtc_min,UpdateEncoderV1$$module$libs$y_webrtc_min);
class YEvent$$module$libs$y_webrtc_min{constructor(a,g){this.currentTarget=this.target=a;this.transaction=g;this._delta=this._keys=this._changes=null}get path(){return getPathTo$$module$libs$y_webrtc_min(this.currentTarget,this.target)}deletes(a){return isDeleted$$module$libs$y_webrtc_min(this.transaction.deleteSet,a.id)}get keys(){if(null===this._keys){const a=new Map,g=this.target;this.transaction.changed.get(g).forEach(q=>{if(null!==q){const u=g._map.get(q);let B,E;if(this.adds(u)){let F=u.left;
for(;null!==F&&this.adds(F);)F=F.left;if(this.deletes(u)){if(null===F||!this.deletes(F))return;B="delete";E=last$$module$libs$y_webrtc_min(F.content.getContent())}else null!==F&&this.deletes(F)?(B="update",E=last$$module$libs$y_webrtc_min(F.content.getContent())):(B="add",E=void 0)}else{if(!this.deletes(u))return;B="delete";E=last$$module$libs$y_webrtc_min(u.content.getContent())}a.set(q,{action:B,oldValue:E})}});this._keys=a}return this._keys}get delta(){return this.changes.delta}adds(a){return a.id.clock>=
(this.transaction.beforeState.get(a.id.client)||0)}get changes(){let a=this._changes;if(null===a){var g=this.target;const q=create$1$$module$libs$y_webrtc_min(),u=create$1$$module$libs$y_webrtc_min(),B=[];a={added:q,deleted:u,delta:B,keys:this.keys};if(this.transaction.changed.get(g).has(null)){let E=null;for(g=g._start;null!==g;g=g.right)if(g.deleted){if(this.deletes(g)&&!this.adds(g)){if(null===E||void 0===E.delete)E&&B.push(E),E={delete:0};E.delete+=g.length;u.add(g)}}else if(this.adds(g)){if(null===
E||void 0===E.insert)E&&B.push(E),E={insert:[]};E.insert=E.insert.concat(g.content.getContent());q.add(g)}else{if(null===E||void 0===E.retain)E&&B.push(E),E={retain:0};E.retain+=g.length}null!==E&&void 0===E.retain&&E&&B.push(E)}this._changes=a}return a}}
const getPathTo$$module$libs$y_webrtc_min=(a,g)=>{const q=[];for(;null!==g._item&&g!==a;){if(null!==g._item.parentSub)q.unshift(g._item.parentSub);else{let u=0,B=g._item.parent._start;for(;B!==g._item&&null!==B;)B.deleted||u++,B=B.right;q.unshift(u)}g=g._item.parent}return q};let globalSearchMarkerTimestamp$$module$libs$y_webrtc_min=0;
class ArraySearchMarker$$module$libs$y_webrtc_min{constructor(a,g){a.marker=!0;this.p=a;this.index=g;this.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++}}
const overwriteMarker$$module$libs$y_webrtc_min=(a,g,q)=>{a.p.marker=!1;a.p=g;g.marker=!0;a.index=q;a.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++},findMarker$$module$libs$y_webrtc_min=(a,g)=>{if(null===a._start||0===g||null===a._searchMarker)return null;const q=0===a._searchMarker.length?null:a._searchMarker.reduce((E,F)=>abs$$module$libs$y_webrtc_min(g-E.index)<abs$$module$libs$y_webrtc_min(g-F.index)?E:F);let u=a._start,B=0;null!==q&&(u=q.p,B=q.index,q.timestamp=globalSearchMarkerTimestamp$$module$libs$y_webrtc_min++);
for(;null!==u.right&&B<g;){if(!u.deleted&&u.countable){if(g<B+u.length)break;B+=u.length}u=u.right}for(;null!==u.left&&B>g;)u=u.left,!u.deleted&&u.countable&&(B-=u.length);for(;null!==u.left&&u.left.id.client===u.id.client&&u.left.id.clock+u.left.length===u.id.clock;)u=u.left,!u.deleted&&u.countable&&(B-=u.length);return null!==q&&abs$$module$libs$y_webrtc_min(q.index-B)<u.parent.length/80?(overwriteMarker$$module$libs$y_webrtc_min(q,u,B),q):((E,F,K)=>{if(80<=E.length)return E=E.reduce((I,J)=>I.timestamp<
J.timestamp?I:J),overwriteMarker$$module$libs$y_webrtc_min(E,F,K),E;F=new ArraySearchMarker$$module$libs$y_webrtc_min(F,K);return E.push(F),F})(a._searchMarker,u,B)},updateMarkerChanges$$module$libs$y_webrtc_min=(a,g,q)=>{for(let u=a.length-1;0<=u;u--){const B=a[u];if(0<q){let E=B.p;for(E.marker=!1;E&&(E.deleted||!E.countable);)(E=E.left)&&!E.deleted&&E.countable&&(B.index-=E.length);if(null===E||!0===E.marker){a.splice(u,1);continue}B.p=E;E.marker=!0}(g<B.index||0<q&&g===B.index)&&(B.index=max$$module$libs$y_webrtc_min(g,
B.index+q))}},getTypeChildren$$module$libs$y_webrtc_min=a=>{a=a._start;const g=[];for(;a;)g.push(a),a=a.right;return g},callTypeObservers$$module$libs$y_webrtc_min=(a,g,q)=>{const u=a,B=g.changedParentTypes;for(;setIfUndefined$$module$libs$y_webrtc_min(B,a,()=>[]).push(q),null!==a._item;)a=a._item.parent;callEventHandlerListeners$$module$libs$y_webrtc_min(u._eH,q,g)};
class AbstractType$$module$libs$y_webrtc_min{constructor(){this._item=null;this._map=new Map;this.doc=this._start=null;this._length=0;this._eH=createEventHandler$$module$libs$y_webrtc_min();this._dEH=createEventHandler$$module$libs$y_webrtc_min();this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(a,g){this.doc=a;this._item=g}_copy(){throw methodUnimplemented$$module$libs$y_webrtc_min();}clone(){throw methodUnimplemented$$module$libs$y_webrtc_min();}_write(a){}get _first(){let a=
this._start;for(;null!==a&&a.deleted;)a=a.right;return a}_callObserver(a,g){!a.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(a){addEventHandlerListener$$module$libs$y_webrtc_min(this._eH,a)}observeDeep(a){addEventHandlerListener$$module$libs$y_webrtc_min(this._dEH,a)}unobserve(a){removeEventHandlerListener$$module$libs$y_webrtc_min(this._eH,a)}unobserveDeep(a){removeEventHandlerListener$$module$libs$y_webrtc_min(this._dEH,a)}toJSON(){}}
const typeListSlice$$module$libs$y_webrtc_min=(a,g,q)=>{0>g&&(g=a._length+g);0>q&&(q=a._length+q);q-=g;const u=[];for(a=a._start;null!==a&&0<q;){if(a.countable&&!a.deleted){const B=a.content.getContent();if(B.length<=g)g-=B.length;else{for(;g<B.length&&0<q;g++)u.push(B[g]),q--;g=0}}a=a.right}return u},typeListToArray$$module$libs$y_webrtc_min=a=>{const g=[];for(a=a._start;null!==a;){if(a.countable&&!a.deleted){const q=a.content.getContent();for(let u=0;u<q.length;u++)g.push(q[u])}a=a.right}return g},
typeListToArraySnapshot$$module$libs$y_webrtc_min=(a,g)=>{const q=[];for(a=a._start;null!==a;){if(a.countable&&isVisible$$module$libs$y_webrtc_min(a,g)){const u=a.content.getContent();for(let B=0;B<u.length;B++)q.push(u[B])}a=a.right}return q},typeListForEach$$module$libs$y_webrtc_min=(a,g)=>{let q=0,u=a._start;for(;null!==u;){if(u.countable&&!u.deleted){const B=u.content.getContent();for(let E=0;E<B.length;E++)g(B[E],q++,a)}u=u.right}},typeListMap$$module$libs$y_webrtc_min=(a,g)=>{const q=[];return typeListForEach$$module$libs$y_webrtc_min(a,
(u,B)=>{q.push(g(u,B,a))}),q},typeListCreateIterator$$module$libs$y_webrtc_min=a=>{let g=a._start,q=null,u=0;return{[Symbol.iterator](){return this},next:()=>{if(null===q){for(;null!==g&&g.deleted;)g=g.right;if(null===g)return{done:!0,value:void 0};q=g.content.getContent();u=0;g=g.right}const B=q[u++];return q.length<=u&&(q=null),{done:!1,value:B}}}},typeListGet$$module$libs$y_webrtc_min=(a,g)=>{const q=findMarker$$module$libs$y_webrtc_min(a,g);a=a._start;for(null!==q&&(a=q.p,g-=q.index);null!==a;a=
a.right)if(!a.deleted&&a.countable){if(g<a.length)return a.content.getContent()[g];g-=a.length}},typeListInsertGenericsAfter$$module$libs$y_webrtc_min=(a,g,q,u)=>{let B=q;const E=a.doc,F=E.clientID,K=E.store,I=null===q?g._start:q.right;let J=[];const H=()=>{0<J.length&&(B=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(K,F)),B,B&&B.lastId,I,I&&I.id,g,null,new ContentAny$$module$libs$y_webrtc_min(J)),B.integrate(a,0),J=[])};u.forEach(N=>{if(null===
N)J.push(N);else switch(N.constructor){case Number:case Object:case Boolean:case Array:case String:J.push(N);break;default:switch(H(),N.constructor){case Uint8Array:case ArrayBuffer:B=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(K,F)),B,B&&B.lastId,I,I&&I.id,g,null,new ContentBinary$$module$libs$y_webrtc_min(new Uint8Array(N)));B.integrate(a,0);break;case Doc$$module$libs$y_webrtc_min:B=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,
getState$$module$libs$y_webrtc_min(K,F)),B,B&&B.lastId,I,I&&I.id,g,null,new ContentDoc$$module$libs$y_webrtc_min(N));B.integrate(a,0);break;default:if(!(N instanceof AbstractType$$module$libs$y_webrtc_min))throw Error("Unexpected content type in insert operation");B=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(K,F)),B,B&&B.lastId,I,I&&I.id,g,null,new ContentType$$module$libs$y_webrtc_min(N));B.integrate(a,0)}}});H()},lengthExceeded$$module$libs$y_webrtc_min=
create$2$$module$libs$y_webrtc_min("Length exceeded!"),typeListInsertGenerics$$module$libs$y_webrtc_min=(a,g,q,u)=>{if(q>g._length)throw lengthExceeded$$module$libs$y_webrtc_min;if(0===q)return g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,q,u.length),typeListInsertGenericsAfter$$module$libs$y_webrtc_min(a,g,null,u);const B=q,E=findMarker$$module$libs$y_webrtc_min(g,q);let F=g._start;for(null!==E&&(F=E.p,0===(q-=E.index)&&(F=F.prev,q+=F&&F.countable&&!F.deleted?F.length:
0));null!==F;F=F.right)if(!F.deleted&&F.countable){if(q<=F.length){q<F.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(F.id.client,F.id.clock+q));break}q-=F.length}return g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,B,u.length),typeListInsertGenericsAfter$$module$libs$y_webrtc_min(a,g,F,u)},typeListDelete$$module$libs$y_webrtc_min=(a,g,q,u)=>{if(0!==u){var B=q,E=u,F=findMarker$$module$libs$y_webrtc_min(g,q),K=g._start;for(null!==
F&&(K=F.p,q-=F.index);null!==K&&0<q;K=K.right)!K.deleted&&K.countable&&(q<K.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(K.id.client,K.id.clock+q)),q-=K.length);for(;0<u&&null!==K;)K.deleted||(u<K.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(K.id.client,K.id.clock+u)),K.delete(a),u-=K.length),K=K.right;if(0<u)throw lengthExceeded$$module$libs$y_webrtc_min;g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,
B,-E+u)}},typeMapDelete$$module$libs$y_webrtc_min=(a,g,q)=>{g=g._map.get(q);void 0!==g&&g.delete(a)},typeMapSet$$module$libs$y_webrtc_min=(a,g,q,u)=>{const B=g._map.get(q)||null,E=a.doc,F=E.clientID;if(null==u)u=new ContentAny$$module$libs$y_webrtc_min([u]);else switch(u.constructor){case Number:case Object:case Boolean:case Array:case String:u=new ContentAny$$module$libs$y_webrtc_min([u]);break;case Uint8Array:u=new ContentBinary$$module$libs$y_webrtc_min(u);break;case Doc$$module$libs$y_webrtc_min:u=
new ContentDoc$$module$libs$y_webrtc_min(u);break;default:if(!(u instanceof AbstractType$$module$libs$y_webrtc_min))throw Error("Unexpected content type");u=new ContentType$$module$libs$y_webrtc_min(u)}(new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(E.store,F)),B,B&&B.lastId,null,null,g,q,u)).integrate(a,0)},typeMapGet$$module$libs$y_webrtc_min=(a,g)=>{a=a._map.get(g);return void 0===a||a.deleted?void 0:a.content.getContent()[a.length-1]},
typeMapGetAll$$module$libs$y_webrtc_min=a=>{const g={};return a._map.forEach((q,u)=>{q.deleted||(g[u]=q.content.getContent()[q.length-1])}),g},typeMapHas$$module$libs$y_webrtc_min=(a,g)=>{a=a._map.get(g);return void 0!==a&&!a.deleted},typeMapGetSnapshot$$module$libs$y_webrtc_min=(a,g,q)=>{for(a=a._map.get(g)||null;null!==a&&(!q.sv.has(a.id.client)||a.id.clock>=(q.sv.get(a.id.client)||0));)a=a.left;return null!==a&&isVisible$$module$libs$y_webrtc_min(a,q)?a.content.getContent()[a.length-1]:void 0},
createMapIterator$$module$libs$y_webrtc_min=a=>{return g=a.entries(),q=u=>!u[1].deleted,createIterator$$module$libs$y_webrtc_min(()=>{let u;do u=g.next();while(!u.done&&!q(u.value));return u});var g,q};class YArrayEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g){super(a,g);this._transaction=g}}
class YArray$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(){super();this._prelimContent=[];this._searchMarker=[]}static from(a){const g=new YArray$$module$libs$y_webrtc_min;return g.push(a),g}_integrate(a,g){super._integrate(a,g);this.insert(0,this._prelimContent);this._prelimContent=null}_copy(){return new YArray$$module$libs$y_webrtc_min}clone(){const a=new YArray$$module$libs$y_webrtc_min;return a.insert(0,this.toArray().map(g=>g instanceof AbstractType$$module$libs$y_webrtc_min?
g.clone():g)),a}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(a,g){super._callObserver(a,g);callTypeObservers$$module$libs$y_webrtc_min(this,a,new YArrayEvent$$module$libs$y_webrtc_min(this,a))}insert(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,q=>{typeListInsertGenerics$$module$libs$y_webrtc_min(q,this,a,g)}):this._prelimContent.splice(a,0,...g)}push(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{((q,
u,B)=>{let E=(u._searchMarker||[]).reduce((F,K)=>K.index>F.index?K:F,{index:0,p:u._start}).p;if(E)for(;E.right;)E=E.right;typeListInsertGenericsAfter$$module$libs$y_webrtc_min(q,u,E,B)})(g,this,a)}):this._prelimContent.push(...a)}unshift(a){this.insert(0,a)}delete(a,g=1){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,q=>{typeListDelete$$module$libs$y_webrtc_min(q,this,a,g)}):this._prelimContent.splice(a,g)}get(a){return typeListGet$$module$libs$y_webrtc_min(this,a)}toArray(){return typeListToArray$$module$libs$y_webrtc_min(this)}slice(a=
0,g=this.length){return typeListSlice$$module$libs$y_webrtc_min(this,a,g)}toJSON(){return this.map(a=>a instanceof AbstractType$$module$libs$y_webrtc_min?a.toJSON():a)}map(a){return typeListMap$$module$libs$y_webrtc_min(this,a)}forEach(a){typeListForEach$$module$libs$y_webrtc_min(this,a)}[Symbol.iterator](){return typeListCreateIterator$$module$libs$y_webrtc_min(this)}_write(a){a.writeTypeRef(YArrayRefID$$module$libs$y_webrtc_min)}}
class YMapEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g,q){super(a,g);this.keysChanged=q}}
class YMap$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(a){super();this._prelimContent=null;this._prelimContent=void 0===a?new Map:new Map(a)}_integrate(a,g){super._integrate(a,g);this._prelimContent.forEach((q,u)=>{this.set(u,q)});this._prelimContent=null}_copy(){return new YMap$$module$libs$y_webrtc_min}clone(){const a=new YMap$$module$libs$y_webrtc_min;return this.forEach((g,q)=>{a.set(q,g instanceof AbstractType$$module$libs$y_webrtc_min?g.clone():g)}),
a}_callObserver(a,g){callTypeObservers$$module$libs$y_webrtc_min(this,a,new YMapEvent$$module$libs$y_webrtc_min(this,a,g))}toJSON(){const a={};return this._map.forEach((g,q)=>{g.deleted||(g=g.content.getContent()[g.length-1],a[q]=g instanceof AbstractType$$module$libs$y_webrtc_min?g.toJSON():g)}),a}get size(){return[...createMapIterator$$module$libs$y_webrtc_min(this._map)].length}keys(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),a=>a[0])}values(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),
a=>a[1].content.getContent()[a[1].length-1])}entries(){return iteratorMap$$module$libs$y_webrtc_min(createMapIterator$$module$libs$y_webrtc_min(this._map),a=>[a[0],a[1].content.getContent()[a[1].length-1]])}forEach(a){this._map.forEach((g,q)=>{g.deleted||a(g.content.getContent()[g.length-1],q,this)})}[Symbol.iterator](){return this.entries()}delete(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{typeMapDelete$$module$libs$y_webrtc_min(g,this,a)}):this._prelimContent.delete(a)}set(a,
g){return null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,q=>{typeMapSet$$module$libs$y_webrtc_min(q,this,a,g)}):this._prelimContent.set(a,g),g}get(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}has(a){return typeMapHas$$module$libs$y_webrtc_min(this,a)}clear(){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,a=>{this.forEach(function(g,q,u){typeMapDelete$$module$libs$y_webrtc_min(a,u,q)})}):this._prelimContent.clear()}_write(a){a.writeTypeRef(YMapRefID$$module$libs$y_webrtc_min)}}
const equalAttrs$$module$libs$y_webrtc_min=(a,g)=>a===g||"object"==typeof a&&"object"==typeof g&&a&&g&&((q,u)=>q===u||length$$module$libs$y_webrtc_min(q)===length$$module$libs$y_webrtc_min(u)&&((B,E)=>{for(const F in B)if(!E(B[F],F))return!1;return!0})(q,(B,E)=>(void 0!==B||hasProperty$$module$libs$y_webrtc_min(u,E))&&u[E]===B))(a,g);
class ItemTextListPosition$$module$libs$y_webrtc_min{constructor(a,g,q,u){this.left=a;this.right=g;this.index=q;this.currentAttributes=u}forward(){switch(null===this.right&&unexpectedCase$$module$libs$y_webrtc_min(),this.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:this.right.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length)}this.left=this.right;this.right=
this.right.right}}
const findNextPosition$$module$libs$y_webrtc_min=(a,g,q)=>{for(;null!==g.right&&0<q;){switch(g.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:g.right.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(g.currentAttributes,g.right.content);break;default:g.right.deleted||(q<g.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(g.right.id.client,g.right.id.clock+q)),g.index+=g.right.length,q-=g.right.length)}g.left=g.right;g.right=
g.right.right}return g},findPosition$$module$libs$y_webrtc_min=(a,g,q)=>{const u=new Map;var B=findMarker$$module$libs$y_webrtc_min(g,q);if(B)return g=new ItemTextListPosition$$module$libs$y_webrtc_min(B.p.left,B.p,B.index,u),findNextPosition$$module$libs$y_webrtc_min(a,g,q-B.index);B=new ItemTextListPosition$$module$libs$y_webrtc_min(null,g._start,0,u);return findNextPosition$$module$libs$y_webrtc_min(a,B,q)},insertNegatedAttributes$$module$libs$y_webrtc_min=(a,g,q,u)=>{for(;null!==q.right&&(!0===
q.right.deleted||q.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&equalAttrs$$module$libs$y_webrtc_min(u.get(q.right.content.key),q.right.content.value));)q.right.deleted||u.delete(q.right.content.key),q.forward();const B=a.doc,E=B.clientID;u.forEach((F,K)=>{const I=q.left,J=q.right;F=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(E,getState$$module$libs$y_webrtc_min(B.store,E)),I,I&&I.lastId,J,J&&J.id,g,null,new ContentFormat$$module$libs$y_webrtc_min(K,
F));F.integrate(a,0);q.right=F;q.forward()})},updateCurrentAttributes$$module$libs$y_webrtc_min=(a,g)=>{const {key:q,value:u}=g;null===u?a.delete(q):a.set(q,u)},minimizeAttributeChanges$$module$libs$y_webrtc_min=(a,g)=>{for(;null!==a.right&&(a.right.deleted||a.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&equalAttrs$$module$libs$y_webrtc_min(g[a.right.content.key]||null,a.right.content.value));)a.forward()},insertAttributes$$module$libs$y_webrtc_min=(a,g,q,u)=>{const B=a.doc,
E=B.clientID,F=new Map;for(const K in u){const I=u[K],J=q.currentAttributes.get(K)||null;if(!equalAttrs$$module$libs$y_webrtc_min(J,I)){F.set(K,J);const {left:H,right:N}=q;q.right=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(E,getState$$module$libs$y_webrtc_min(B.store,E)),H,H&&H.lastId,N,N&&N.id,g,null,new ContentFormat$$module$libs$y_webrtc_min(K,I));q.right.integrate(a,0);q.forward()}}return F},insertText$$module$libs$y_webrtc_min=(a,g,q,u,B)=>{q.currentAttributes.forEach((N,
T)=>{void 0===B[T]&&(B[T]=null)});const E=a.doc,F=E.clientID;minimizeAttributeChanges$$module$libs$y_webrtc_min(q,B);const K=insertAttributes$$module$libs$y_webrtc_min(a,g,q,B);u=u.constructor===String?new ContentString$$module$libs$y_webrtc_min(u):u instanceof AbstractType$$module$libs$y_webrtc_min?new ContentType$$module$libs$y_webrtc_min(u):new ContentEmbed$$module$libs$y_webrtc_min(u);let {left:I,right:J,index:H}=q;g._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(g._searchMarker,
q.index,u.getLength());J=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(E.store,F)),I,I&&I.lastId,J,J&&J.id,g,null,u);J.integrate(a,0);q.right=J;q.index=H;q.forward();insertNegatedAttributes$$module$libs$y_webrtc_min(a,g,q,K)},formatText$$module$libs$y_webrtc_min=(a,g,q,u,B)=>{const E=a.doc,F=E.clientID;minimizeAttributeChanges$$module$libs$y_webrtc_min(q,B);const K=insertAttributes$$module$libs$y_webrtc_min(a,g,q,B);a:for(;null!==q.right&&
(0<u||0<K.size&&(q.right.deleted||q.right.content.constructor===ContentFormat$$module$libs$y_webrtc_min));){if(!q.right.deleted)switch(q.right.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:const {key:I,value:J}=q.right.content,H=B[I];if(void 0!==H){if(equalAttrs$$module$libs$y_webrtc_min(H,J))K.delete(I);else{if(0===u)break a;K.set(I,J)}q.right.delete(a)}else q.currentAttributes.set(I,J);break;default:u<q.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(q.right.id.client,
q.right.id.clock+u)),u-=q.right.length}q.forward()}if(0<u){for(B="";0<u;u--)B+="\n";q.right=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(F,getState$$module$libs$y_webrtc_min(E.store,F)),q.left,q.left&&q.left.lastId,q.right,q.right&&q.right.id,g,null,new ContentString$$module$libs$y_webrtc_min(B));q.right.integrate(a,0);q.forward()}insertNegatedAttributes$$module$libs$y_webrtc_min(a,g,q,K)},cleanupFormattingGap$$module$libs$y_webrtc_min=(a,g,q,u,B)=>{let E=g;const F=create$$module$libs$y_webrtc_min();
for(;E&&(!E.countable||E.deleted);){if(!E.deleted&&E.content.constructor===ContentFormat$$module$libs$y_webrtc_min){var K=E.content;F.set(K.key,K)}E=E.right}K=0;let I=!1;for(;g!==E;){if(q===g&&(I=!0),!g.deleted){const J=g.content;switch(J.constructor){case ContentFormat$$module$libs$y_webrtc_min:const {key:H,value:N}=J,T=u.get(H)||null;F.get(H)===J&&T!==N||(g.delete(a),K++,I||(B.get(H)||null)!==N||T===N||(null===T?B.delete(H):B.set(H,T)));I||g.deleted||updateCurrentAttributes$$module$libs$y_webrtc_min(B,
J)}}g=g.right}return K},cleanupYTextFormatting$$module$libs$y_webrtc_min=a=>{let g=0;return transact$$module$libs$y_webrtc_min(a.doc,q=>{let u=a._start,B=a._start,E=create$$module$libs$y_webrtc_min();const F=copy$$module$libs$y_webrtc_min(E);for(;B;){if(!1===B.deleted)switch(B.content.constructor){case ContentFormat$$module$libs$y_webrtc_min:updateCurrentAttributes$$module$libs$y_webrtc_min(F,B.content);break;default:g+=cleanupFormattingGap$$module$libs$y_webrtc_min(q,u,B,E,F),E=copy$$module$libs$y_webrtc_min(F),
u=B}B=B.right}}),g},deleteText$$module$libs$y_webrtc_min=(a,g,q)=>{const u=q,B=copy$$module$libs$y_webrtc_min(g.currentAttributes),E=g.right;for(;0<q&&null!==g.right;){if(!1===g.right.deleted)switch(g.right.content.constructor){case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:case ContentString$$module$libs$y_webrtc_min:q<g.right.length&&getItemCleanStart$$module$libs$y_webrtc_min(a,createID$$module$libs$y_webrtc_min(g.right.id.client,g.right.id.clock+q)),q-=
g.right.length,g.right.delete(a)}g.forward()}E&&cleanupFormattingGap$$module$libs$y_webrtc_min(a,E,g.right,B,g.currentAttributes);a=(g.left||g.right).parent;return a._searchMarker&&updateMarkerChanges$$module$libs$y_webrtc_min(a._searchMarker,g.index,-u+q),g};
class YTextEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g,q){super(a,g);this.childListChanged=!1;this.keysChanged=new Set;q.forEach(u=>{null===u?this.childListChanged=!0:this.keysChanged.add(u)})}get changes(){null===this._changes&&(this._changes={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set});return this._changes}get delta(){if(null===this._delta){const a=[];transact$$module$libs$y_webrtc_min(this.target.doc,g=>{const q=new Map,u=new Map;
let B=this.target._start,E=null;const F={};let K="",I=0,J=0;const H=()=>{if(null!==E){let T=null;switch(E){case "delete":0<J&&(T={delete:J});J=0;break;case "insert":("object"==typeof K||0<K.length)&&(T={insert:K},0<q.size&&(T.attributes={},q.forEach((O,W)=>{null!==O&&(T.attributes[W]=O)})));K="";break;case "retain":0<I&&(T={retain:I},(O=>{for(const W in O)return!1;return!0})(F)||(T.attributes=assign$$module$libs$y_webrtc_min({},F))),I=0}T&&a.push(T);E=null}};for(;null!==B;){switch(B.content.constructor){case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:this.adds(B)?
this.deletes(B)||(H(),E="insert",K=B.content.getContent()[0],H()):this.deletes(B)?("delete"!==E&&(H(),E="delete"),J+=1):B.deleted||("retain"!==E&&(H(),E="retain"),I+=1);break;case ContentString$$module$libs$y_webrtc_min:this.adds(B)?this.deletes(B)||("insert"!==E&&(H(),E="insert"),K+=B.content.str):this.deletes(B)?("delete"!==E&&(H(),E="delete"),J+=B.length):B.deleted||("retain"!==E&&(H(),E="retain"),I+=B.length);break;case ContentFormat$$module$libs$y_webrtc_min:const {key:T,value:O}=B.content;if(this.adds(B)){if(!this.deletes(B)){var N=
q.get(T)||null;equalAttrs$$module$libs$y_webrtc_min(N,O)?null!==O&&B.delete(g):("retain"===E&&H(),equalAttrs$$module$libs$y_webrtc_min(O,u.get(T)||null)?delete F[T]:F[T]=O)}}else this.deletes(B)?(u.set(T,O),N=q.get(T)||null,equalAttrs$$module$libs$y_webrtc_min(N,O)||("retain"===E&&H(),F[T]=N)):B.deleted||(u.set(T,O),N=F[T],void 0!==N&&(equalAttrs$$module$libs$y_webrtc_min(N,O)?null!==N&&B.delete(g):("retain"===E&&H(),null===O?delete F[T]:F[T]=O)));B.deleted||("insert"===E&&H(),updateCurrentAttributes$$module$libs$y_webrtc_min(q,
B.content))}B=B.right}for(H();0<a.length;){g=a[a.length-1];if(void 0===g.retain||void 0!==g.attributes)break;a.pop()}});this._delta=a}return this._delta}}
class YText$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(a){super();this._pending=void 0!==a?[()=>this.insert(0,a)]:[];this._searchMarker=[]}get length(){return this._length}_integrate(a,g){super._integrate(a,g);try{this._pending.forEach(q=>q())}catch(q){console.error(q)}this._pending=null}_copy(){return new YText$$module$libs$y_webrtc_min}clone(){const a=new YText$$module$libs$y_webrtc_min;return a.applyDelta(this.toDelta()),a}_callObserver(a,g){super._callObserver(a,
g);var q=new YTextEvent$$module$libs$y_webrtc_min(this,a,g);g=a.doc;if(callTypeObservers$$module$libs$y_webrtc_min(this,a,q),!a.local){let u=!1;for(const [B,E]of a.afterState.entries())if(q=a.beforeState.get(B)||0,E!==q&&(iterateStructs$$module$libs$y_webrtc_min(a,g.store.clients.get(B),q,E,F=>{F.deleted||F.content.constructor!==ContentFormat$$module$libs$y_webrtc_min||(u=!0)}),u))break;u||iterateDeletedStructs$$module$libs$y_webrtc_min(a,a.deleteSet,B=>{B instanceof GC$$module$libs$y_webrtc_min||
u||B.parent===this&&B.content.constructor===ContentFormat$$module$libs$y_webrtc_min&&(u=!0)});transact$$module$libs$y_webrtc_min(g,B=>{u?cleanupYTextFormatting$$module$libs$y_webrtc_min(this):iterateDeletedStructs$$module$libs$y_webrtc_min(B,B.deleteSet,E=>{if(!(E instanceof GC$$module$libs$y_webrtc_min)&&E.parent===this){for(;E&&E.right&&(E.right.deleted||!E.right.countable);)E=E.right;const F=new Set;for(;E&&(E.deleted||!E.countable);){if(!E.deleted&&E.content.constructor===ContentFormat$$module$libs$y_webrtc_min){const K=
E.content.key;F.has(K)?E.delete(B):F.add(K)}E=E.left}}})})}}toString(){let a="",g=this._start;for(;null!==g;)!g.deleted&&g.countable&&g.content.constructor===ContentString$$module$libs$y_webrtc_min&&(a+=g.content.str),g=g.right;return a}toJSON(){return this.toString()}applyDelta(a,{sanitize:g=!0}={}){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,q=>{const u=new ItemTextListPosition$$module$libs$y_webrtc_min(null,this._start,0,new Map);for(let B=0;B<a.length;B++){const E=a[B];if(void 0!==
E.insert){const F=g||"string"!=typeof E.insert||B!==a.length-1||null!==u.right||"\n"!==E.insert.slice(-1)?E.insert:E.insert.slice(0,-1);("string"!=typeof F||0<F.length)&&insertText$$module$libs$y_webrtc_min(q,this,u,F,E.attributes||{})}else void 0!==E.retain?formatText$$module$libs$y_webrtc_min(q,this,u,E.retain,E.attributes||{}):void 0!==E.delete&&deleteText$$module$libs$y_webrtc_min(q,u,E.delete)}}):this._pending.push(()=>this.applyDelta(a))}toDelta(a,g,q){function u(){if(0<K.length){const H={};
let N=!1;E.forEach((O,W)=>{N=!0;H[W]=O});const T={insert:K};N&&(T.attributes=H);B.push(T);K=""}}const B=[],E=new Map,F=this.doc;let K="",I=this._start;const J=()=>{for(;null!==I;){if(isVisible$$module$libs$y_webrtc_min(I,a)||void 0!==g&&isVisible$$module$libs$y_webrtc_min(I,g))switch(I.content.constructor){case ContentString$$module$libs$y_webrtc_min:var H=E.get("ychange");void 0===a||isVisible$$module$libs$y_webrtc_min(I,a)?void 0===g||isVisible$$module$libs$y_webrtc_min(I,g)?void 0!==H&&(u(),E.delete("ychange")):
void 0!==H&&H.user===I.id.client&&"added"===H.type||(u(),E.set("ychange",q?q("added",I.id):{type:"added"})):void 0!==H&&H.user===I.id.client&&"removed"===H.type||(u(),E.set("ychange",q?q("removed",I.id):{type:"removed"}));K+=I.content.str;break;case ContentType$$module$libs$y_webrtc_min:case ContentEmbed$$module$libs$y_webrtc_min:u();H={insert:I.content.getContent()[0]};if(0<E.size){const N={};H.attributes=N;E.forEach((T,O)=>{N[O]=T})}B.push(H);break;case ContentFormat$$module$libs$y_webrtc_min:isVisible$$module$libs$y_webrtc_min(I,
a)&&(u(),updateCurrentAttributes$$module$libs$y_webrtc_min(E,I.content))}I=I.right}u()};return a||g?transact$$module$libs$y_webrtc_min(F,H=>{a&&splitSnapshotAffectedStructs$$module$libs$y_webrtc_min(H,a);g&&splitSnapshotAffectedStructs$$module$libs$y_webrtc_min(H,g);J()},"cleanup"):J(),B}insert(a,g,q){if(!(0>=g.length)){var u=this.doc;null!==u?transact$$module$libs$y_webrtc_min(u,B=>{const E=findPosition$$module$libs$y_webrtc_min(B,this,a);q||(q={},E.currentAttributes.forEach((F,K)=>{q[K]=F}));insertText$$module$libs$y_webrtc_min(B,
this,E,g,q)}):this._pending.push(()=>this.insert(a,g,q))}}insertEmbed(a,g,q={}){const u=this.doc;null!==u?transact$$module$libs$y_webrtc_min(u,B=>{const E=findPosition$$module$libs$y_webrtc_min(B,this,a);insertText$$module$libs$y_webrtc_min(B,this,E,g,q)}):this._pending.push(()=>this.insertEmbed(a,g,q))}delete(a,g){if(0!==g){var q=this.doc;null!==q?transact$$module$libs$y_webrtc_min(q,u=>{deleteText$$module$libs$y_webrtc_min(u,findPosition$$module$libs$y_webrtc_min(u,this,a),g)}):this._pending.push(()=>
this.delete(a,g))}}format(a,g,q){if(0!==g){var u=this.doc;null!==u?transact$$module$libs$y_webrtc_min(u,B=>{const E=findPosition$$module$libs$y_webrtc_min(B,this,a);null!==E.right&&formatText$$module$libs$y_webrtc_min(B,this,E,g,q)}):this._pending.push(()=>this.format(a,g,q))}}removeAttribute(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{typeMapDelete$$module$libs$y_webrtc_min(g,this,a)}):this._pending.push(()=>this.removeAttribute(a))}setAttribute(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,
q=>{typeMapSet$$module$libs$y_webrtc_min(q,this,a,g)}):this._pending.push(()=>this.setAttribute(a,g))}getAttribute(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}getAttributes(){return typeMapGetAll$$module$libs$y_webrtc_min(this)}_write(a){a.writeTypeRef(YTextRefID$$module$libs$y_webrtc_min)}}
class YXmlTreeWalker$$module$libs$y_webrtc_min{constructor(a,g=()=>!0){this._filter=g;this._root=a;this._currentNode=a._start;this._firstCall=!0}[Symbol.iterator](){return this}next(){let a=this._currentNode,g=a&&a.content&&a.content.type;if(null!==a&&(!this._firstCall||a.deleted||!this._filter(g))){do if(g=a.content.type,a.deleted||g.constructor!==YXmlElement$$module$libs$y_webrtc_min&&g.constructor!==YXmlFragment$$module$libs$y_webrtc_min||null===g._start)for(;null!==a;){if(null!==a.right){a=a.right;
break}a=a.parent===this._root?null:a.parent._item}else a=g._start;while(null!==a&&(a.deleted||!this._filter(a.content.type)))}return this._firstCall=!1,null===a?{value:void 0,done:!0}:(this._currentNode=a,{value:a.content.type,done:!1})}}
class YXmlFragment$$module$libs$y_webrtc_min extends AbstractType$$module$libs$y_webrtc_min{constructor(){super();this._prelimContent=[]}get firstChild(){const a=this._first;return a?a.content.getContent()[0]:null}_integrate(a,g){super._integrate(a,g);this.insert(0,this._prelimContent);this._prelimContent=null}_copy(){return new YXmlFragment$$module$libs$y_webrtc_min}clone(){const a=new YXmlFragment$$module$libs$y_webrtc_min;return a.insert(0,this.toArray().map(g=>g instanceof AbstractType$$module$libs$y_webrtc_min?
g.clone():g)),a}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(a){return new YXmlTreeWalker$$module$libs$y_webrtc_min(this,a)}querySelector(a){a=a.toUpperCase();const g=(new YXmlTreeWalker$$module$libs$y_webrtc_min(this,q=>q.nodeName&&q.nodeName.toUpperCase()===a)).next();return g.done?null:g.value}querySelectorAll(a){return a=a.toUpperCase(),from$$module$libs$y_webrtc_min(new YXmlTreeWalker$$module$libs$y_webrtc_min(this,g=>g.nodeName&&g.nodeName.toUpperCase()===
a))}_callObserver(a,g){callTypeObservers$$module$libs$y_webrtc_min(this,a,new YXmlEvent$$module$libs$y_webrtc_min(this,g,a))}toString(){return typeListMap$$module$libs$y_webrtc_min(this,a=>a.toString()).join("")}toJSON(){return this.toString()}toDOM(a=document,g={},q){const u=a.createDocumentFragment();return void 0!==q&&q._createAssociation(u,this),typeListForEach$$module$libs$y_webrtc_min(this,B=>{u.insertBefore(B.toDOM(a,g,q),null)}),u}insert(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,
q=>{typeListInsertGenerics$$module$libs$y_webrtc_min(q,this,a,g)}):this._prelimContent.splice(a,0,...g)}insertAfter(a,g){if(null!==this.doc)transact$$module$libs$y_webrtc_min(this.doc,q=>{typeListInsertGenericsAfter$$module$libs$y_webrtc_min(q,this,a&&a instanceof AbstractType$$module$libs$y_webrtc_min?a._item:a,g)});else{const q=this._prelimContent,u=null===a?0:q.findIndex(B=>B===a)+1;if(0===u&&null!==a)throw create$2$$module$libs$y_webrtc_min("Reference item not found");q.splice(u,0,...g)}}delete(a,
g=1){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,q=>{typeListDelete$$module$libs$y_webrtc_min(q,this,a,g)}):this._prelimContent.splice(a,g)}toArray(){return typeListToArray$$module$libs$y_webrtc_min(this)}push(a){this.insert(this.length,a)}unshift(a){this.insert(0,a)}get(a){return typeListGet$$module$libs$y_webrtc_min(this,a)}slice(a=0,g=this.length){return typeListSlice$$module$libs$y_webrtc_min(this,a,g)}forEach(a){typeListForEach$$module$libs$y_webrtc_min(this,a)}_write(a){a.writeTypeRef(YXmlFragmentRefID$$module$libs$y_webrtc_min)}}
class YXmlElement$$module$libs$y_webrtc_min extends YXmlFragment$$module$libs$y_webrtc_min{constructor(a="UNDEFINED"){super();this.nodeName=a;this._prelimAttrs=new Map}get nextSibling(){const a=this._item?this._item.next:null;return a?a.content.type:null}get prevSibling(){const a=this._item?this._item.prev:null;return a?a.content.type:null}_integrate(a,g){super._integrate(a,g);this._prelimAttrs.forEach((q,u)=>{this.setAttribute(u,q)});this._prelimAttrs=null}_copy(){return new YXmlElement$$module$libs$y_webrtc_min(this.nodeName)}clone(){const a=
new YXmlElement$$module$libs$y_webrtc_min(this.nodeName);return((g,q)=>{for(const u in g)q(g[u],u)})(this.getAttributes(),(g,q)=>{"string"==typeof g&&a.setAttribute(q,g)}),a.insert(0,this.toArray().map(g=>g instanceof AbstractType$$module$libs$y_webrtc_min?g.clone():g)),a}toString(){var a=this.getAttributes();const g=[],q=[];for(var u in a)q.push(u);q.sort();u=q.length;for(let B=0;B<u;B++){const E=q[B];g.push(E+'="'+a[E]+'"')}a=this.nodeName.toLocaleLowerCase();return`<${a}${0<g.length?" "+g.join(" "):
""}>${super.toString()}</${a}>`}removeAttribute(a){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,g=>{typeMapDelete$$module$libs$y_webrtc_min(g,this,a)}):this._prelimAttrs.delete(a)}setAttribute(a,g){null!==this.doc?transact$$module$libs$y_webrtc_min(this.doc,q=>{typeMapSet$$module$libs$y_webrtc_min(q,this,a,g)}):this._prelimAttrs.set(a,g)}getAttribute(a){return typeMapGet$$module$libs$y_webrtc_min(this,a)}hasAttribute(a){return typeMapHas$$module$libs$y_webrtc_min(this,a)}getAttributes(){return typeMapGetAll$$module$libs$y_webrtc_min(this)}toDOM(a=
document,g={},q){const u=a.createElement(this.nodeName),B=this.getAttributes();for(const E in B){const F=B[E];"string"==typeof F&&u.setAttribute(E,F)}return typeListForEach$$module$libs$y_webrtc_min(this,E=>{u.appendChild(E.toDOM(a,g,q))}),void 0!==q&&q._createAssociation(u,this),u}_write(a){a.writeTypeRef(YXmlElementRefID$$module$libs$y_webrtc_min);a.writeKey(this.nodeName)}}
class YXmlEvent$$module$libs$y_webrtc_min extends YEvent$$module$libs$y_webrtc_min{constructor(a,g,q){super(a,q);this.childListChanged=!1;this.attributesChanged=new Set;g.forEach(u=>{null===u?this.childListChanged=!0:this.attributesChanged.add(u)})}}
class YXmlHook$$module$libs$y_webrtc_min extends YMap$$module$libs$y_webrtc_min{constructor(a){super();this.hookName=a}_copy(){return new YXmlHook$$module$libs$y_webrtc_min(this.hookName)}clone(){const a=new YXmlHook$$module$libs$y_webrtc_min(this.hookName);return this.forEach((g,q)=>{a.set(q,g)}),a}toDOM(a,g={},q){a=g[this.hookName];let u;return u=void 0!==a?a.createDom(this):document.createElement(this.hookName),u.setAttribute("data-yjs-hook",this.hookName),void 0!==q&&q._createAssociation(u,this),
u}_write(a){a.writeTypeRef(YXmlHookRefID$$module$libs$y_webrtc_min);a.writeKey(this.hookName)}}
class YXmlText$$module$libs$y_webrtc_min extends YText$$module$libs$y_webrtc_min{get nextSibling(){const a=this._item?this._item.next:null;return a?a.content.type:null}get prevSibling(){const a=this._item?this._item.prev:null;return a?a.content.type:null}_copy(){return new YXmlText$$module$libs$y_webrtc_min}clone(){const a=new YXmlText$$module$libs$y_webrtc_min;return a.applyDelta(this.toDelta()),a}toDOM(a=document,g,q){a=a.createTextNode(this.toString());return void 0!==q&&q._createAssociation(a,
this),a}toString(){return this.toDelta().map(a=>{const g=[];for(var q in a.attributes){var u=[];for(var B in a.attributes[q])u.push({key:B,value:a.attributes[q][B]});u.sort((E,F)=>E.key<F.key?-1:1);g.push({nodeName:q,attrs:u})}g.sort((E,F)=>E.nodeName<F.nodeName?-1:1);q="";for(u=0;u<g.length;u++){B=g[u];q+="<"+B.nodeName;for(let E=0;E<B.attrs.length;E++){const F=B.attrs[E];q+=` ${F.key}="${F.value}"`}q+=">"}q+=a.insert;for(a=g.length-1;0<=a;a--)q+=`</${g[a].nodeName}>`;return q}).join("")}toJSON(){return this.toString()}_write(a){a.writeTypeRef(YXmlTextRefID$$module$libs$y_webrtc_min)}}
class AbstractStruct$$module$libs$y_webrtc_min{constructor(a,g){this.id=a;this.length=g}get deleted(){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}write(a,g,q){throw methodUnimplemented$$module$libs$y_webrtc_min();}integrate(a,g){throw methodUnimplemented$$module$libs$y_webrtc_min();}}
class GC$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{get deleted(){return!0}delete(){}mergeWith(a){return this.constructor===a.constructor&&(this.length+=a.length,!0)}integrate(a,g){0<g&&(this.id.clock+=g,this.length-=g);addStruct$$module$libs$y_webrtc_min(a.doc.store,this)}write(a,g){a.writeInfo(0);a.writeLen(this.length-g)}getMissing(a,g){return null}}
class ContentBinary$$module$libs$y_webrtc_min{constructor(a){this.content=a}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new ContentBinary$$module$libs$y_webrtc_min(this.content)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){}delete(a){}gc(a){}write(a,g){a.writeBuf(this.content)}getRef(){return 3}}
class ContentDeleted$$module$libs$y_webrtc_min{constructor(a){this.len=a}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ContentDeleted$$module$libs$y_webrtc_min(this.len)}splice(a){const g=new ContentDeleted$$module$libs$y_webrtc_min(this.len-a);return this.len=a,g}mergeWith(a){return this.len+=a.len,!0}integrate(a,g){addToDeleteSet$$module$libs$y_webrtc_min(a.deleteSet,g.id.client,g.id.clock,this.len);g.markDeleted()}delete(a){}gc(a){}write(a,g){a.writeLen(this.len-
g)}getRef(){return 1}}const createDocFromOpts$$module$libs$y_webrtc_min=(a,g)=>new Doc$$module$libs$y_webrtc_min({guid:a,...g,shouldLoad:g.shouldLoad||g.autoLoad||!1});
class ContentDoc$$module$libs$y_webrtc_min{constructor(a){a._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid.");this.doc=a;const g={};this.opts=g;a.gc||(g.gc=!1);a.autoLoad&&(g.autoLoad=!0);null!==a.meta&&(g.meta=a.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ContentDoc$$module$libs$y_webrtc_min(createDocFromOpts$$module$libs$y_webrtc_min(this.doc.guid,this.opts))}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();
}mergeWith(a){return!1}integrate(a,g){this.doc._item=g;a.subdocsAdded.add(this.doc);this.doc.shouldLoad&&a.subdocsLoaded.add(this.doc)}delete(a){a.subdocsAdded.has(this.doc)?a.subdocsAdded.delete(this.doc):a.subdocsRemoved.add(this.doc)}gc(a){}write(a,g){a.writeString(this.doc.guid);a.writeAny(this.opts)}getRef(){return 9}}
class ContentEmbed$$module$libs$y_webrtc_min{constructor(a){this.embed=a}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ContentEmbed$$module$libs$y_webrtc_min(this.embed)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){}delete(a){}gc(a){}write(a,g){a.writeJSON(this.embed)}getRef(){return 5}}
class ContentFormat$$module$libs$y_webrtc_min{constructor(a,g){this.key=a;this.value=g}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ContentFormat$$module$libs$y_webrtc_min(this.key,this.value)}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){g.parent._searchMarker=null}delete(a){}gc(a){}write(a,g){a.writeKey(this.key);a.writeJSON(this.value)}getRef(){return 6}}
class ContentJSON$$module$libs$y_webrtc_min{constructor(a){this.arr=a}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentJSON$$module$libs$y_webrtc_min(this.arr)}splice(a){const g=new ContentJSON$$module$libs$y_webrtc_min(this.arr.slice(a));return this.arr=this.arr.slice(0,a),g}mergeWith(a){return this.arr=this.arr.concat(a.arr),!0}integrate(a,g){}delete(a){}gc(a){}write(a,g){const q=this.arr.length;for(a.writeLen(q-g);g<q;g++){const u=
this.arr[g];a.writeString(void 0===u?"undefined":JSON.stringify(u))}}getRef(){return 2}}
class ContentAny$$module$libs$y_webrtc_min{constructor(a){this.arr=a}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ContentAny$$module$libs$y_webrtc_min(this.arr)}splice(a){const g=new ContentAny$$module$libs$y_webrtc_min(this.arr.slice(a));return this.arr=this.arr.slice(0,a),g}mergeWith(a){return this.arr=this.arr.concat(a.arr),!0}integrate(a,g){}delete(a){}gc(a){}write(a,g){const q=this.arr.length;for(a.writeLen(q-g);g<q;g++)a.writeAny(this.arr[g])}getRef(){return 8}}
class ContentString$$module$libs$y_webrtc_min{constructor(a){this.str=a}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ContentString$$module$libs$y_webrtc_min(this.str)}splice(a){const g=new ContentString$$module$libs$y_webrtc_min(this.str.slice(a));this.str=this.str.slice(0,a);const q=this.str.charCodeAt(a-1);return 55296<=q&&56319>=q&&(this.str=this.str.slice(0,a-1)+"\ufffd",g.str="\ufffd"+g.str.slice(1)),g}mergeWith(a){return this.str+=
a.str,!0}integrate(a,g){}delete(a){}gc(a){}write(a,g){a.writeString(0===g?this.str:this.str.slice(g))}getRef(){return 4}}
const typeRefs$$module$libs$y_webrtc_min=[a=>new YArray$$module$libs$y_webrtc_min,a=>new YMap$$module$libs$y_webrtc_min,a=>new YText$$module$libs$y_webrtc_min,a=>new YXmlElement$$module$libs$y_webrtc_min(a.readKey()),a=>new YXmlFragment$$module$libs$y_webrtc_min,a=>new YXmlHook$$module$libs$y_webrtc_min(a.readKey()),a=>new YXmlText$$module$libs$y_webrtc_min],YArrayRefID$$module$libs$y_webrtc_min=0,YMapRefID$$module$libs$y_webrtc_min=1,YTextRefID$$module$libs$y_webrtc_min=2,YXmlElementRefID$$module$libs$y_webrtc_min=
3,YXmlFragmentRefID$$module$libs$y_webrtc_min=4,YXmlHookRefID$$module$libs$y_webrtc_min=5,YXmlTextRefID$$module$libs$y_webrtc_min=6;
class ContentType$$module$libs$y_webrtc_min{constructor(a){this.type=a}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ContentType$$module$libs$y_webrtc_min(this.type._copy())}splice(a){throw methodUnimplemented$$module$libs$y_webrtc_min();}mergeWith(a){return!1}integrate(a,g){this.type._integrate(a.doc,g)}delete(a){let g=this.type._start;for(;null!==g;)g.deleted?a._mergeStructs.push(g):g.delete(a),g=g.right;this.type._map.forEach(q=>{q.deleted?a._mergeStructs.push(q):
q.delete(a)});a.changed.delete(this.type)}gc(a){let g=this.type._start;for(;null!==g;)g.gc(a,!0),g=g.right;this.type._start=null;this.type._map.forEach(q=>{for(;null!==q;)q.gc(a,!0),q=q.left});this.type._map=new Map}write(a,g){this.type._write(a)}getRef(){return 7}}
const followRedone$$module$libs$y_webrtc_min=(a,g)=>{let q=g,u=0;do 0<u&&(q=createID$$module$libs$y_webrtc_min(q.client,q.clock+u)),g=getItem$$module$libs$y_webrtc_min(a,q),u=q.clock-g.id.clock,q=g.redone;while(null!==q&&g instanceof Item$$module$libs$y_webrtc_min);return{item:g,diff:u}},keepItem$$module$libs$y_webrtc_min=(a,g)=>{for(;null!==a&&a.keep!==g;)a.keep=g,a=a.parent._item},splitItem$$module$libs$y_webrtc_min=(a,g,q)=>{const {client:u,clock:B}=g.id,E=new Item$$module$libs$y_webrtc_min(createID$$module$libs$y_webrtc_min(u,
B+q),g,createID$$module$libs$y_webrtc_min(u,B+q-1),g.right,g.rightOrigin,g.parent,g.parentSub,g.content.splice(q));return g.deleted&&E.markDeleted(),g.keep&&(E.keep=!0),null!==g.redone&&(E.redone=createID$$module$libs$y_webrtc_min(g.redone.client,g.redone.clock+q)),g.right=E,null!==E.right&&(E.right.left=E),a._mergeStructs.push(E),null!==E.parentSub&&null===E.right&&E.parent._map.set(E.parentSub,E),g.length=q,E},isDeletedByUndoStack$$module$libs$y_webrtc_min=(a,g)=>((q,u)=>{for(let B=0;B<q.length;B++)if(u(q[B],
B,q))return!0;return!1})(a,q=>isDeleted$$module$libs$y_webrtc_min(q.deletions,g)),redoItem$$module$libs$y_webrtc_min=(a,g,q,u,B,E)=>{var F=a.doc,K=F.store;F=F.clientID;var I=g.redone;if(null!==I)return getItemCleanStart$$module$libs$y_webrtc_min(a,I);let J=g.parent._item;if(null!==J&&!0===J.deleted){if(null===J.redone&&(!q.has(J)||null===redoItem$$module$libs$y_webrtc_min(a,J,q,u,B,E)))return null;for(;null!==J.redone;)J=getItemCleanStart$$module$libs$y_webrtc_min(a,J.redone)}I=null===J?g.parent:
J.content.type;if(null===g.parentSub){B=g.left;for(q=g;null!==B;){for(u=B;null!==u&&u.parent._item!==J;)u=null===u.redone?null:getItemCleanStart$$module$libs$y_webrtc_min(a,u.redone);if(null!==u&&u.parent._item===J){B=u;break}B=B.left}for(;null!==q;){for(u=q;null!==u&&u.parent._item!==J;)u=null===u.redone?null:getItemCleanStart$$module$libs$y_webrtc_min(a,u.redone);if(null!==u&&u.parent._item===J){q=u;break}q=q.right}}else if(q=null,g.right&&!B){for(B=g;null!==B&&null!==B.right&&(B.right.redone||
isDeleted$$module$libs$y_webrtc_min(u,B.right.id)||isDeletedByUndoStack$$module$libs$y_webrtc_min(E.undoStack,B.right.id)||isDeletedByUndoStack$$module$libs$y_webrtc_min(E.redoStack,B.right.id));)for(B=B.right;B.redone;)B=getItemCleanStart$$module$libs$y_webrtc_min(a,B.redone);if(B&&null!==B.right)return null}else B=I._map.get(g.parentSub)||null;K=getState$$module$libs$y_webrtc_min(K,F);K=createID$$module$libs$y_webrtc_min(F,K);F=new Item$$module$libs$y_webrtc_min(K,B,B&&B.lastId,q,q&&q.id,I,g.parentSub,
g.content.copy());return g.redone=K,keepItem$$module$libs$y_webrtc_min(F,!0),F.integrate(a,0),F};
class Item$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{constructor(a,g,q,u,B,E,F,K){super(a,K.getLength());this.origin=q;this.left=g;this.right=u;this.rightOrigin=B;this.parent=E;this.parentSub=F;this.redone=null;this.content=K;this.info=this.content.isCountable()?2:0}set marker(a){0<(8&this.info)!==a&&(this.info^=8)}get marker(){return 0<(8&this.info)}get keep(){return 0<(1&this.info)}set keep(a){this.keep!==a&&(this.info^=1)}get countable(){return 0<(2&this.info)}get deleted(){return 0<
(4&this.info)}set deleted(a){this.deleted!==a&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(a,g){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=getState$$module$libs$y_webrtc_min(g,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=getState$$module$libs$y_webrtc_min(g,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ID$$module$libs$y_webrtc_min&&
this.id.client!==this.parent.client&&this.parent.clock>=getState$$module$libs$y_webrtc_min(g,this.parent.client))return this.parent.client;(this.origin&&(this.left=getItemCleanEnd$$module$libs$y_webrtc_min(a,g,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=getItemCleanStart$$module$libs$y_webrtc_min(a,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===GC$$module$libs$y_webrtc_min||this.right&&this.right.constructor===GC$$module$libs$y_webrtc_min)&&
(this.parent=null),this.parent)?this.parent.constructor===ID$$module$libs$y_webrtc_min&&(a=getItem$$module$libs$y_webrtc_min(g,this.parent),a.constructor===GC$$module$libs$y_webrtc_min?this.parent=null:this.parent=a.content.type):(this.left&&this.left.constructor===Item$$module$libs$y_webrtc_min&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Item$$module$libs$y_webrtc_min&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub));
return null}integrate(a,g){if(0<g&&(this.id.clock+=g,this.left=getItemCleanEnd$$module$libs$y_webrtc_min(a,a.doc.store,createID$$module$libs$y_webrtc_min(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(g),this.length-=g),this.parent){if(!(this.left||this.right&&null===this.right.left)||this.left&&this.left.right!==this.right){let q=this.left;if(null!==q)g=q.right;else if(null!==this.parentSub)for(g=this.parent._map.get(this.parentSub)||null;null!==g&&
null!==g.left;)g=g.left;else g=this.parent._start;const u=new Set,B=new Set;for(;null!==g&&g!==this.right;){if(B.add(g),u.add(g),compareIDs$$module$libs$y_webrtc_min(this.origin,g.origin))if(g.id.client<this.id.client)q=g,u.clear();else{if(compareIDs$$module$libs$y_webrtc_min(this.rightOrigin,g.rightOrigin))break}else{if(null===g.origin||!B.has(getItem$$module$libs$y_webrtc_min(a.doc.store,g.origin)))break;u.has(getItem$$module$libs$y_webrtc_min(a.doc.store,g.origin))||(q=g,u.clear())}g=g.right}this.left=
q}if(null!==this.left)this.right=this.left.right,this.left.right=this;else{if(null!==this.parentSub)for(g=this.parent._map.get(this.parentSub)||null;null!==g&&null!==g.left;)g=g.left;else g=this.parent._start,this.parent._start=this;this.right=g}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(a));null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length);addStruct$$module$libs$y_webrtc_min(a.doc.store,
this);this.content.integrate(a,this);addChangedTypeToTransaction$$module$libs$y_webrtc_min(a,this.parent,this.parentSub);(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(a)}else(new GC$$module$libs$y_webrtc_min(this.id,this.length)).integrate(a,0)}get next(){let a=this.right;for(;null!==a&&a.deleted;)a=a.right;return a}get prev(){let a=this.left;for(;null!==a&&a.deleted;)a=a.left;return a}get lastId(){return 1===this.length?this.id:createID$$module$libs$y_webrtc_min(this.id.client,
this.id.clock+this.length-1)}mergeWith(a){if(this.constructor===a.constructor&&compareIDs$$module$libs$y_webrtc_min(a.origin,this.lastId)&&this.right===a&&compareIDs$$module$libs$y_webrtc_min(this.rightOrigin,a.rightOrigin)&&this.id.client===a.id.client&&this.id.clock+this.length===a.id.clock&&this.deleted===a.deleted&&null===this.redone&&null===a.redone&&this.content.constructor===a.content.constructor&&this.content.mergeWith(a.content)){const g=this.parent._searchMarker;return g&&g.forEach(q=>{q.p===
a&&(q.p=this,!this.deleted&&this.countable&&(q.index-=this.length))}),a.keep&&(this.keep=!0),this.right=a.right,null!==this.right&&(this.right.left=this),this.length+=a.length,!0}return!1}delete(a){if(!this.deleted){const g=this.parent;this.countable&&null===this.parentSub&&(g._length-=this.length);this.markDeleted();addToDeleteSet$$module$libs$y_webrtc_min(a.deleteSet,this.id.client,this.id.clock,this.length);addChangedTypeToTransaction$$module$libs$y_webrtc_min(a,g,this.parentSub);this.content.delete(a)}}gc(a,
g){if(!this.deleted)throw unexpectedCase$$module$libs$y_webrtc_min();this.content.gc(a);g?(g=new GC$$module$libs$y_webrtc_min(this.id,this.length),a=a.clients.get(this.id.client),a[findIndexSS$$module$libs$y_webrtc_min(a,this.id.clock)]=g):this.content=new ContentDeleted$$module$libs$y_webrtc_min(this.length)}write(a,g){var q=0<g?createID$$module$libs$y_webrtc_min(this.id.client,this.id.clock+g-1):this.origin,u=this.rightOrigin;const B=this.parentSub,E=31&this.content.getRef()|(null===q?0:128)|(null===
u?0:64)|(null===B?0:32);if(a.writeInfo(E),null!==q&&a.writeLeftID(q),null!==u&&a.writeRightID(u),null===q&&null===u)q=this.parent,void 0!==q._item?(u=q._item,null===u?(q=findRootTypeKey$$module$libs$y_webrtc_min(q),a.writeParentInfo(!0),a.writeString(q)):(a.writeParentInfo(!1),a.writeLeftID(u.id))):q.constructor===String?(a.writeParentInfo(!0),a.writeString(q)):q.constructor===ID$$module$libs$y_webrtc_min?(a.writeParentInfo(!1),a.writeLeftID(q)):unexpectedCase$$module$libs$y_webrtc_min(),null!==B&&
a.writeString(B);this.content.write(a,g)}}
const readItemContent$$module$libs$y_webrtc_min=(a,g)=>contentRefs$$module$libs$y_webrtc_min[31&g](a),contentRefs$$module$libs$y_webrtc_min=[()=>{unexpectedCase$$module$libs$y_webrtc_min()},a=>new ContentDeleted$$module$libs$y_webrtc_min(a.readLen()),a=>{const g=a.readLen(),q=[];for(let u=0;u<g;u++){const B=a.readString();"undefined"===B?q.push(void 0):q.push(JSON.parse(B))}return new ContentJSON$$module$libs$y_webrtc_min(q)},a=>new ContentBinary$$module$libs$y_webrtc_min(a.readBuf()),a=>new ContentString$$module$libs$y_webrtc_min(a.readString()),
a=>new ContentEmbed$$module$libs$y_webrtc_min(a.readJSON()),a=>new ContentFormat$$module$libs$y_webrtc_min(a.readKey(),a.readJSON()),a=>new ContentType$$module$libs$y_webrtc_min(typeRefs$$module$libs$y_webrtc_min[a.readTypeRef()](a)),a=>{const g=a.readLen(),q=[];for(let u=0;u<g;u++)q.push(a.readAny());return new ContentAny$$module$libs$y_webrtc_min(q)},a=>new ContentDoc$$module$libs$y_webrtc_min(createDocFromOpts$$module$libs$y_webrtc_min(a.readString(),a.readAny())),()=>{unexpectedCase$$module$libs$y_webrtc_min()}];
class Skip$$module$libs$y_webrtc_min extends AbstractStruct$$module$libs$y_webrtc_min{get deleted(){return!0}delete(){}mergeWith(a){return this.constructor===a.constructor&&(this.length+=a.length,!0)}integrate(a,g){unexpectedCase$$module$libs$y_webrtc_min()}write(a,g){a.writeInfo(10);writeVarUint$$module$libs$y_webrtc_min(a.restEncoder,this.length-g)}getMissing(a,g){return null}}
const glo$$module$libs$y_webrtc_min="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};!0===glo$$module$libs$y_webrtc_min["__ $YJS$ __"]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");glo$$module$libs$y_webrtc_min["__ $YJS$ __"]=!0;
var commonjsGlobal$$module$libs$y_webrtc_min="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire$$module$libs$y_webrtc_min(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs");}
var simplepeer_min$$module$libs$y_webrtc_min=function(a,g){return a(g={exports:{}},g.exports),g.exports}(function(a,g){var q,u,B;a.exports=(q=Math.floor,u=Math.abs,B=Math.pow,function J(F,K,I){function H(O,W){if(!K[O]){if(!F[O]){if(!W&&commonjsRequire$$module$libs$y_webrtc_min)return commonjsRequire$$module$libs$y_webrtc_min();if(N)return N(O,!0);W=Error("Cannot find module '"+O+"'");throw W.code="MODULE_NOT_FOUND",W;}W=K[O]={exports:{}};F[O][0].call(W.exports,function(ba){return H(F[O][1][ba]||ba)},
W,W.exports,J,F,K,I)}return K[O].exports}for(var N=commonjsRequire$$module$libs$y_webrtc_min,T=0;T<I.length;T++)H(I[T]);return H}({1:[function(F,K,I){function J(O){var W=O.length;if(0<W%4)throw Error("Invalid string. Length must be a multiple of 4");O=O.indexOf("=");return-1===O&&(O=W),[O,O===W?0:4-O%4]}I.byteLength=function(O){O=J(O);var W=O[1];return 3*(O[0]+W)/4-W};I.toByteArray=function(O){var W=J(O);var ba=W[0];W=W[1];var fa=new T(3*(ba+W)/4-W),R=0,da=0<W?ba-4:ba;for(ba=0;ba<da;ba+=4){var ha=
N[O.charCodeAt(ba)]<<18|N[O.charCodeAt(ba+1)]<<12|N[O.charCodeAt(ba+2)]<<6|N[O.charCodeAt(ba+3)];fa[R++]=255&ha>>16;fa[R++]=255&ha>>8;fa[R++]=255&ha}return 2===W&&(ha=N[O.charCodeAt(ba)]<<2|N[O.charCodeAt(ba+1)]>>4,fa[R++]=255&ha),1===W&&(ha=N[O.charCodeAt(ba)]<<10|N[O.charCodeAt(ba+1)]<<4|N[O.charCodeAt(ba+2)]>>2,fa[R++]=255&ha>>8,fa[R++]=255&ha),fa};I.fromByteArray=function(O){for(var W,ba=O.length,fa=ba%3,R=[],da=0,ha=ba-fa;da<ha;da+=16383){for(var ma=R,ka=ma.push,pa,la=O,ta=da+16383>ha?ha:da+
16383,wa=[],za=da;za<ta;za+=3)pa=(16711680&la[za]<<16)+(65280&la[za+1]<<8)+(255&la[za+2]),wa.push(H[63&pa>>18]+H[63&pa>>12]+H[63&pa>>6]+H[63&pa]);pa=wa.join("");ka.call(ma,pa)}return 1===fa?(W=O[ba-1],R.push(H[W>>2]+H[63&W<<4]+"==")):2===fa&&(W=(O[ba-2]<<8)+O[ba-1],R.push(H[W>>10]+H[63&W>>4]+H[63&W<<2]+"=")),R.join("")};var H=[],N=[],T="undefined"==typeof Uint8Array?Array:Uint8Array;for(F=0;64>F;++F)H[F]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[F],N["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(F)]=
F;N[45]=62;N[95]=63},{}],2:[function(){},{}],3:[function(F,K,I){(function(){(function(){function J(L){if(2147483647<L)throw new RangeError('The value "'+L+'" is invalid for option "size"');L=new Uint8Array(L);return L.__proto__=H.prototype,L}function H(L,M,Q){if("number"==typeof L){if("string"==typeof M)throw new TypeError('The "string" argument must be of type string. Received type number');return O(L)}return N(L,M,Q)}function N(L,M,Q){if("string"==typeof L)return function(oa,Ba){if(("string"!=typeof Ba||
""===Ba)&&(Ba="utf8"),!H.isEncoding(Ba))throw new TypeError("Unknown encoding: "+Ba);var ya=0|fa(oa,Ba),aa=J(ya);oa=aa.write(oa,Ba);return oa!==ya&&(aa=aa.slice(0,oa)),aa}(L,M);if(ArrayBuffer.isView(L))return W(L);if(null==L)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(Sa(L,ArrayBuffer)||L&&Sa(L.buffer,ArrayBuffer))return function(oa,Ba,ya){if(0>Ba||oa.byteLength<Ba)throw new RangeError('"offset" is outside of buffer bounds');
if(oa.byteLength<Ba+(ya||0))throw new RangeError('"length" is outside of buffer bounds');var aa;return(aa=void 0===Ba&&void 0===ya?new Uint8Array(oa):void 0===ya?new Uint8Array(oa,Ba):new Uint8Array(oa,Ba,ya)).__proto__=H.prototype,aa}(L,M,Q);if("number"==typeof L)throw new TypeError('The "value" argument must not be of type number. Received type number');var ca=L.valueOf&&L.valueOf();if(null!=ca&&ca!==L)return H.from(ca,M,Q);if(ca=function(oa){if(H.isBuffer(oa)){var Ba=0|ba(oa.length),ya=J(Ba);return 0===
ya.length||oa.copy(ya,0,0,Ba),ya}return void 0===oa.length?"Buffer"===oa.type&&Array.isArray(oa.data)?W(oa.data):void 0:"number"!=typeof oa.length||Ya(oa.length)?J(0):W(oa)}(L))return ca;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof L[Symbol.toPrimitive])return H.from(L[Symbol.toPrimitive]("string"),M,Q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);}function T(L){if("number"!=
typeof L)throw new TypeError('"size" argument must be of type number');if(0>L)throw new RangeError('The value "'+L+'" is invalid for option "size"');}function O(L){return T(L),J(0>L?0:0|ba(L))}function W(L){for(var M=0>L.length?0:0|ba(L.length),Q=J(M),ca=0;ca<M;ca+=1)Q[ca]=255&L[ca];return Q}function ba(L){if(2147483647<=L)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(2147483647).toString(16)+" bytes");return 0|L}function fa(L,M){if(H.isBuffer(L))return L.length;
if(ArrayBuffer.isView(L)||Sa(L,ArrayBuffer))return L.byteLength;if("string"!=typeof L)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);var Q=L.length,ca=2<arguments.length&&!0===arguments[2];if(!ca&&0===Q)return 0;for(var oa=!1;;)switch(M){case "ascii":case "latin1":case "binary":return Q;case "utf8":case "utf-8":return Vb(L).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*Q;case "hex":return Q>>>1;case "base64":return Kb(L).length;
default:if(oa)return ca?-1:Vb(L).length;M=(""+M).toLowerCase();oa=!0}}function R(L,M,Q){var ca=!1;if(((void 0===M||0>M)&&(M=0),M>this.length)||((void 0===Q||Q>this.length)&&(Q=this.length),0>=Q)||(Q>>>=0)<=(M>>>=0))return"";for(L||="utf8";;)switch(L){case "hex":L=M;M=this.length;(!L||0>L)&&(L=0);(!Q||0>Q||Q>M)&&(Q=M);for(M="";L<Q;++L)ca=this[L],ca=16>ca?"0"+ca.toString(16):ca.toString(16),M+=ca;return M;case "utf8":case "utf-8":return pa(this,M,Q);case "ascii":L=M;M="";for(Q=Zb(this.length,Q);L<Q;++L)M+=
uc(127&this[L]);return M;case "latin1":case "binary":L=M;M="";for(Q=Zb(this.length,Q);L<Q;++L)M+=uc(this[L]);return M;case "base64":return L=M,0===L&&Q===this.length?pd.fromByteArray(this):pd.fromByteArray(this.slice(L,Q));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":Q=this.slice(M,Q);L="";for(M=0;M<Q.length;M+=2)L+=uc(Q[M]+256*Q[M+1]);return L;default:if(ca)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase();ca=!0}}function da(L,M,Q){var ca=L[M];L[M]=L[Q];L[Q]=ca}function ha(L,
M,Q,ca,oa){if(0===L.length)return-1;if("string"==typeof Q?(ca=Q,Q=0):2147483647<Q?Q=2147483647:-2147483648>Q&&(Q=-2147483648),Ya(Q=+Q)&&(Q=oa?0:L.length-1),0>Q&&(Q=L.length+Q),Q>=L.length){if(oa)return-1;Q=L.length-1}else if(0>Q){if(!oa)return-1;Q=0}if("string"==typeof M&&(M=H.from(M,ca)),H.isBuffer(M))return 0===M.length?-1:ma(L,M,Q,ca,oa);if("number"==typeof M)return M&=255,"function"==typeof Uint8Array.prototype.indexOf?oa?Uint8Array.prototype.indexOf.call(L,M,Q):Uint8Array.prototype.lastIndexOf.call(L,
M,Q):ma(L,[M],Q,ca,oa);throw new TypeError("val must be string, number or Buffer");}function ma(L,M,Q,ca,oa){function Ba(xa,Oa){return 1===ya?xa[Oa]:xa.readUInt16BE(Oa*ya)}var ya=1,aa=L.length,Y=M.length;if(void 0!==ca&&("ucs2"===(ca=(ca+"").toLowerCase())||"ucs-2"===ca||"utf16le"===ca||"utf-16le"===ca)){if(2>L.length||2>M.length)return-1;ya=2;aa/=2;Y/=2;Q/=2}if(oa)for(ca=-1;Q<aa;Q++)if(Ba(L,Q)!==Ba(M,-1===ca?0:Q-ca))-1!==ca&&(Q-=Q-ca),ca=-1;else{if(-1===ca&&(ca=Q),Q-ca+1===Y)return ca*ya}else for(Q+
Y>aa&&(Q=aa-Y);0<=Q;Q--){aa=!0;for(ca=0;ca<Y;ca++)if(Ba(L,Q+ca)!==Ba(M,ca)){aa=!1;break}if(aa)return Q}return-1}function ka(L,M,Q,ca){for(var oa=[],Ba=0;Ba<M.length;++Ba)oa.push(255&M.charCodeAt(Ba));return Qd(oa,L,Q,ca)}function pa(L,M,Q){Q=Zb(L.length,Q);for(var ca=[];M<Q;){var oa,Ba,ya,aa,Y=L[M],xa=null,Oa=239<Y?4:223<Y?3:191<Y?2:1;M+Oa<=Q&&(1===Oa?128>Y&&(xa=Y):2===Oa?128==(192&(oa=L[M+1]))&&127<(aa=(31&Y)<<6|63&oa)&&(xa=aa):3===Oa?(oa=L[M+1],Ba=L[M+2],128==(192&oa)&&128==(192&Ba)&&2047<(aa=(15&
Y)<<12|(63&oa)<<6|63&Ba)&&(55296>aa||57343<aa)&&(xa=aa)):4===Oa&&(oa=L[M+1],Ba=L[M+2],ya=L[M+3],128==(192&oa)&&128==(192&Ba)&&128==(192&ya)&&65535<(aa=(15&Y)<<18|(63&oa)<<12|(63&Ba)<<6|63&ya)&&1114112>aa&&(xa=aa)));null===xa?(xa=65533,Oa=1):65535<xa&&(xa-=65536,ca.push(55296|1023&xa>>>10),xa=56320|1023&xa);ca.push(xa);M+=Oa}L=ca.length;if(4096>=L)ca=uc.apply(String,ca);else{Q="";for(oa=0;oa<L;)Q+=uc.apply(String,ca.slice(oa,oa+=4096));ca=Q}return ca}function la(L,M,Q){if(0!=L%1||0>L)throw new RangeError("offset is not uint");
if(L+M>Q)throw new RangeError("Trying to access beyond buffer length");}function ta(L,M,Q,ca,oa,Ba){if(!H.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>oa||M<Ba)throw new RangeError('"value" argument is out of bounds');if(Q+ca>L.length)throw new RangeError("Index out of range");}function wa(L,M,Q,ca){if(Q+ca>L.length)throw new RangeError("Index out of range");if(0>Q)throw new RangeError("Index out of range");}function za(L,M,Q,ca,oa){return M=+M,Q>>>=0,oa||wa(L,
0,Q,4),Rb.write(L,M,Q,ca,23,4),Q+4}function Ca(L,M,Q,ca,oa){return M=+M,Q>>>=0,oa||wa(L,0,Q,8),Rb.write(L,M,Q,ca,52,8),Q+8}function Vb(L,M){M=M||1/0;for(var Q,ca=L.length,oa=null,Ba=[],ya=0;ya<ca;++ya){if(55295<(Q=L.charCodeAt(ya))&&57344>Q){if(!oa){if(56319<Q){-1<(M-=3)&&Ba.push(239,191,189);continue}if(ya+1===ca){-1<(M-=3)&&Ba.push(239,191,189);continue}oa=Q;continue}if(56320>Q){-1<(M-=3)&&Ba.push(239,191,189);oa=Q;continue}Q=65536+(oa-55296<<10|Q-56320)}else oa&&-1<(M-=3)&&Ba.push(239,191,189);
if(oa=null,128>Q){if(0>--M)break;Ba.push(Q)}else if(2048>Q){if(0>(M-=2))break;Ba.push(192|Q>>6,128|63&Q)}else if(65536>Q){if(0>(M-=3))break;Ba.push(224|Q>>12,128|63&Q>>6,128|63&Q)}else{if(!(1114112>Q))throw Error("Invalid code point");if(0>(M-=4))break;Ba.push(240|Q>>18,128|63&Q>>12,128|63&Q>>6,128|63&Q)}}return Ba}function Kb(L){var M=pd,Q=M.toByteArray;if(2>(L=(L=L.split("=")[0]).trim().replace(Me,"")).length)L="";else for(;0!=L.length%4;)L+="=";return Q.call(M,L)}function Qd(L,M,Q,ca){for(var oa=
0;oa<ca&&!(oa+Q>=M.length||oa>=L.length);++oa)M[oa+Q]=L[oa];return oa}function Sa(L,M){return L instanceof M||null!=L&&null!=L.constructor&&null!=L.constructor.name&&L.constructor.name===M.name}function Ya(L){return L!=L}var uc=String.fromCharCode,Zb=Math.min,pd=F("base64-js"),Rb=F("ieee754");I.Buffer=H;I.SlowBuffer=function(L){return+L!=L&&(L=0),H.alloc(+L)};I.INSPECT_MAX_BYTES=50;I.kMaxLength=2147483647;H.TYPED_ARRAY_SUPPORT=function(){try{var L=new Uint8Array(1);return L.__proto__={__proto__:Uint8Array.prototype,
foo:function(){return 42}},42===L.foo()}catch(M){return!1}}();H.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){return H.isBuffer(this)?this.buffer:void 0}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){return H.isBuffer(this)?
this.byteOffset:void 0}});"undefined"!=typeof Symbol&&null!=Symbol.species&&H[Symbol.species]===H&&Object.defineProperty(H,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1});H.poolSize=8192;H.from=function(L,M,Q){return N(L,M,Q)};H.prototype.__proto__=Uint8Array.prototype;H.__proto__=Uint8Array;H.alloc=function(L,M,Q){return T(L),0>=L||void 0===M?J(L):"string"==typeof Q?J(L).fill(M,Q):J(L).fill(M)};H.allocUnsafe=function(L){return O(L)};H.allocUnsafeSlow=function(L){return O(L)};
H.isBuffer=function(L){return null!=L&&!0===L._isBuffer&&L!==H.prototype};H.compare=function(L,M){if(Sa(L,Uint8Array)&&(L=H.from(L,L.offset,L.byteLength)),Sa(M,Uint8Array)&&(M=H.from(M,M.offset,M.byteLength)),!H.isBuffer(L)||!H.isBuffer(M))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===M)return 0;for(var Q=L.length,ca=M.length,oa=0,Ba=Zb(Q,ca);oa<Ba;++oa)if(L[oa]!==M[oa]){Q=L[oa];ca=M[oa];break}return Q<ca?-1:ca<Q?1:0};H.isEncoding=function(L){switch((L+
"").toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};H.concat=function(L,M){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(0===L.length)return H.alloc(0);var Q;if(void 0===M)for(Q=M=0;Q<L.length;++Q)M+=L[Q].length;M=H.allocUnsafe(M);var ca=0;for(Q=0;Q<L.length;++Q){var oa=L[Q];if(Sa(oa,Uint8Array)&&(oa=H.from(oa)),
!H.isBuffer(oa))throw new TypeError('"list" argument must be an Array of Buffers');oa.copy(M,ca);ca+=oa.length}return M};H.byteLength=fa;H.prototype._isBuffer=!0;H.prototype.swap16=function(){var L=this.length;if(0!=L%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var M=0;M<L;M+=2)da(this,M,M+1);return this};H.prototype.swap32=function(){var L=this.length;if(0!=L%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var M=0;M<L;M+=4)da(this,M,M+3),da(this,
M+1,M+2);return this};H.prototype.swap64=function(){var L=this.length;if(0!=L%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var M=0;M<L;M+=8)da(this,M,M+7),da(this,M+1,M+6),da(this,M+2,M+5),da(this,M+3,M+4);return this};H.prototype.toString=function(){var L=this.length;return 0===L?"":0===arguments.length?pa(this,0,L):R.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(L){if(!H.isBuffer(L))throw new TypeError("Argument must be a Buffer");
return this===L||0===H.compare(this,L)};H.prototype.inspect=function(){var L="",M=I.INSPECT_MAX_BYTES;return L=this.toString("hex",0,M).replace(/(.{2})/g,"$1 ").trim(),this.length>M&&(L+=" ... "),"<Buffer "+L+">"};H.prototype.compare=function(L,M,Q,ca,oa){if(Sa(L,Uint8Array)&&(L=H.from(L,L.offset,L.byteLength)),!H.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(void 0===M&&(M=0),void 0===Q&&(Q=L?L.length:0),void 0===ca&&
(ca=0),void 0===oa&&(oa=this.length),0>M||Q>L.length||0>ca||oa>this.length)throw new RangeError("out of range index");if(ca>=oa&&M>=Q)return 0;if(ca>=oa)return-1;if(M>=Q)return 1;if(this===L)return 0;var Ba=(oa>>>=0)-(ca>>>=0),ya=(Q>>>=0)-(M>>>=0),aa=Zb(Ba,ya);ca=this.slice(ca,oa);L=L.slice(M,Q);for(M=0;M<aa;++M)if(ca[M]!==L[M]){Ba=ca[M];ya=L[M];break}return Ba<ya?-1:ya<Ba?1:0};H.prototype.includes=function(L,M,Q){return-1!==this.indexOf(L,M,Q)};H.prototype.indexOf=function(L,M,Q){return ha(this,
L,M,Q,!0)};H.prototype.lastIndexOf=function(L,M,Q){return ha(this,L,M,Q,!1)};H.prototype.write=function(L,M,Q,ca){if(void 0===M)ca="utf8",Q=this.length,M=0;else if(void 0===Q&&"string"==typeof M)ca=M,Q=this.length,M=0;else{if(!isFinite(M))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");M>>>=0;isFinite(Q)?(Q>>>=0,void 0===ca&&(ca="utf8")):(ca=Q,Q=void 0)}var oa=this.length-M;if((void 0===Q||Q>oa)&&(Q=oa),0<L.length&&(0>Q||0>M)||M>this.length)throw new RangeError("Attempt to write outside buffer bounds");
ca||="utf8";for(oa=!1;;)switch(ca){case "hex":a:{M=+M||0;ca=this.length-M;Q?(Q=+Q)>ca&&(Q=ca):Q=ca;ca=L.length;Q>ca/2&&(Q=ca/2);for(oa=0;oa<Q;++oa){if(Ya(ca=parseInt(L.substr(2*oa,2),16))){Q=oa;break a}this[M+oa]=ca}Q=oa}return Q;case "utf8":case "utf-8":return Qd(Vb(L,this.length-M),this,M,Q);case "ascii":return ka(this,L,M,Q);case "latin1":case "binary":return ka(this,L,M,Q);case "base64":return Qd(Kb(L),this,M,Q);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ca=Q;oa=this.length-M;for(var Ba=
[],ya=0;ya<L.length&&!(0>(oa-=2));++ya){var aa=L.charCodeAt(ya);Q=aa>>8;aa%=256;Ba.push(aa);Ba.push(Q)}return Qd(Ba,this,M,ca);default:if(oa)throw new TypeError("Unknown encoding: "+ca);ca=(""+ca).toLowerCase();oa=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};H.prototype.slice=function(L,M){var Q=this.length;0>(L=~~L)?0>(L+=Q)&&(L=0):L>Q&&(L=Q);0>(M=void 0===M?Q:~~M)?0>(M+=Q)&&(M=0):M>Q&&(M=Q);M<L&&(M=L);L=this.subarray(L,M);return L.__proto__=
H.prototype,L};H.prototype.readUIntLE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=this[L];for(var ca=1,oa=0;++oa<M&&(ca*=256);)Q+=this[L+oa]*ca;return Q};H.prototype.readUIntBE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=this[L+--M];for(var ca=1;0<M&&(ca*=256);)Q+=this[L+--M]*ca;return Q};H.prototype.readUInt8=function(L,M){return L>>>=0,M||la(L,1,this.length),this[L]};H.prototype.readUInt16LE=function(L,M){return L>>>=0,M||la(L,2,this.length),this[L]|this[L+1]<<8};H.prototype.readUInt16BE=
function(L,M){return L>>>=0,M||la(L,2,this.length),this[L]<<8|this[L+1]};H.prototype.readUInt32LE=function(L,M){return L>>>=0,M||la(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+16777216*this[L+3]};H.prototype.readUInt32BE=function(L,M){return L>>>=0,M||la(L,4,this.length),16777216*this[L]+(this[L+1]<<16|this[L+2]<<8|this[L+3])};H.prototype.readIntLE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=this[L];for(var ca=1,oa=0;++oa<M&&(ca*=256);)Q+=this[L+oa]*ca;return Q>=128*ca&&(Q-=B(2,
8*M)),Q};H.prototype.readIntBE=function(L,M,Q){L>>>=0;M>>>=0;Q||la(L,M,this.length);Q=M;for(var ca=1,oa=this[L+--Q];0<Q&&(ca*=256);)oa+=this[L+--Q]*ca;return oa>=128*ca&&(oa-=B(2,8*M)),oa};H.prototype.readInt8=function(L,M){return L>>>=0,M||la(L,1,this.length),128&this[L]?-1*(255-this[L]+1):this[L]};H.prototype.readInt16LE=function(L,M){L>>>=0;M||la(L,2,this.length);L=this[L]|this[L+1]<<8;return 32768&L?4294901760|L:L};H.prototype.readInt16BE=function(L,M){L>>>=0;M||la(L,2,this.length);L=this[L+1]|
this[L]<<8;return 32768&L?4294901760|L:L};H.prototype.readInt32LE=function(L,M){return L>>>=0,M||la(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24};H.prototype.readInt32BE=function(L,M){return L>>>=0,M||la(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]};H.prototype.readFloatLE=function(L,M){return L>>>=0,M||la(L,4,this.length),Rb.read(this,L,!0,23,4)};H.prototype.readFloatBE=function(L,M){return L>>>=0,M||la(L,4,this.length),Rb.read(this,L,!1,23,4)};H.prototype.readDoubleLE=
function(L,M){return L>>>=0,M||la(L,8,this.length),Rb.read(this,L,!0,52,8)};H.prototype.readDoubleBE=function(L,M){return L>>>=0,M||la(L,8,this.length),Rb.read(this,L,!1,52,8)};H.prototype.writeUIntLE=function(L,M,Q,ca){L=+L;M>>>=0;Q>>>=0;ca||ta(this,L,M,Q,B(2,8*Q)-1,0);ca=1;var oa=0;for(this[M]=255&L;++oa<Q&&(ca*=256);)this[M+oa]=255&L/ca;return M+Q};H.prototype.writeUIntBE=function(L,M,Q,ca){L=+L;M>>>=0;Q>>>=0;ca||ta(this,L,M,Q,B(2,8*Q)-1,0);ca=Q-1;var oa=1;for(this[M+ca]=255&L;0<=--ca&&(oa*=256);)this[M+
ca]=255&L/oa;return M+Q};H.prototype.writeUInt8=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,1,255,0),this[M]=255&L,M+1};H.prototype.writeUInt16LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,65535,0),this[M]=255&L,this[M+1]=L>>>8,M+2};H.prototype.writeUInt16BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,65535,0),this[M]=L>>>8,this[M+1]=255&L,M+2};H.prototype.writeUInt32LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,4294967295,0),this[M+3]=L>>>24,this[M+2]=L>>>16,this[M+
1]=L>>>8,this[M]=255&L,M+4};H.prototype.writeUInt32BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,4294967295,0),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4};H.prototype.writeIntLE=function(L,M,Q,ca){(L=+L,M>>>=0,ca)||(ca=B(2,8*Q-1),ta(this,L,M,Q,ca-1,-ca));ca=0;var oa=1,Ba=0;for(this[M]=255&L;++ca<Q&&(oa*=256);)0>L&&0===Ba&&0!==this[M+ca-1]&&(Ba=1),this[M+ca]=255&(L/oa>>0)-Ba;return M+Q};H.prototype.writeIntBE=function(L,M,Q,ca){(L=+L,M>>>=0,ca)||(ca=B(2,8*Q-1),ta(this,
L,M,Q,ca-1,-ca));ca=Q-1;var oa=1,Ba=0;for(this[M+ca]=255&L;0<=--ca&&(oa*=256);)0>L&&0===Ba&&0!==this[M+ca+1]&&(Ba=1),this[M+ca]=255&(L/oa>>0)-Ba;return M+Q};H.prototype.writeInt8=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,1,127,-128),0>L&&(L=255+L+1),this[M]=255&L,M+1};H.prototype.writeInt16LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,32767,-32768),this[M]=255&L,this[M+1]=L>>>8,M+2};H.prototype.writeInt16BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,2,32767,-32768),this[M]=
L>>>8,this[M+1]=255&L,M+2};H.prototype.writeInt32LE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,2147483647,-2147483648),this[M]=255&L,this[M+1]=L>>>8,this[M+2]=L>>>16,this[M+3]=L>>>24,M+4};H.prototype.writeInt32BE=function(L,M,Q){return L=+L,M>>>=0,Q||ta(this,L,M,4,2147483647,-2147483648),0>L&&(L=4294967295+L+1),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4};H.prototype.writeFloatLE=function(L,M,Q){return za(this,L,M,!0,Q)};H.prototype.writeFloatBE=function(L,M,Q){return za(this,
L,M,!1,Q)};H.prototype.writeDoubleLE=function(L,M,Q){return Ca(this,L,M,!0,Q)};H.prototype.writeDoubleBE=function(L,M,Q){return Ca(this,L,M,!1,Q)};H.prototype.copy=function(L,M,Q,ca){if(!H.isBuffer(L))throw new TypeError("argument should be a Buffer");if((Q||=0,ca||0===ca||(ca=this.length),M>=L.length&&(M=L.length),M||=0,0<ca&&ca<Q&&(ca=Q),ca===Q)||0===L.length||0===this.length)return 0;if(0>M)throw new RangeError("targetStart out of bounds");if(0>Q||Q>=this.length)throw new RangeError("Index out of range");
if(0>ca)throw new RangeError("sourceEnd out of bounds");ca>this.length&&(ca=this.length);L.length-M<ca-Q&&(ca=L.length-M+Q);var oa=ca-Q;if(this===L&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(M,Q,ca);else if(this===L&&Q<M&&M<ca)for(ca=oa-1;0<=ca;--ca)L[ca+M]=this[ca+Q];else Uint8Array.prototype.set.call(L,this.subarray(Q,ca),M);return oa};H.prototype.fill=function(L,M,Q,ca){if("string"==typeof L){if("string"==typeof M?(ca=M,M=0,Q=this.length):"string"==typeof Q&&(ca=Q,Q=this.length),
void 0!==ca&&"string"!=typeof ca)throw new TypeError("encoding must be a string");if("string"==typeof ca&&!H.isEncoding(ca))throw new TypeError("Unknown encoding: "+ca);if(1===L.length){var oa=L.charCodeAt(0);("utf8"===ca&&128>oa||"latin1"===ca)&&(L=oa)}}else"number"==typeof L&&(L&=255);if(0>M||this.length<M||this.length<Q)throw new RangeError("Out of range index");if(Q<=M)return this;if(M>>>=0,Q=void 0===Q?this.length:Q>>>0,L||=0,"number"==typeof L)for(ca=M;ca<Q;++ca)this[ca]=L;else{oa=H.isBuffer(L)?
L:H.from(L,ca);var Ba=oa.length;if(0===Ba)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(ca=0;ca<Q-M;++ca)this[ca+M]=oa[ca%Ba]}return this};var Me=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,F("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(F,K,I){(function(J){(function(){I.formatArgs=function(N){if(N[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+N[0]+(this.useColors?"%c ":" ")+"+"+K.exports.humanize(this.diff),this.useColors){var T=
"color: "+this.color;N.splice(1,0,T,"color: inherit");var O=0,W=0;N[0].replace(/%[a-zA-Z%]/g,ba=>{"%%"===ba||(O++,"%c"===ba&&(W=O))});N.splice(W,0,T)}};I.save=function(N){try{N?I.storage.setItem("debug",N):I.storage.removeItem("debug")}catch(T){}};I.load=function(){let N;try{N=I.storage.getItem("debug")}catch(T){}return!N&&void 0!==J&&"env"in J&&(N=J.env.DEBUG),N};I.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||
!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,
10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};a:{try{var H=localStorage;break a}catch(N){}H=void 0}I.storage=H;I.destroy=(()=>{let N=!1;return()=>{N||(N=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();I.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
I.log=console.debug||console.log||(()=>{});K.exports=F("./common")(I);({formatters:H}=K.exports);H.j=function(N){try{return JSON.stringify(N)}catch(T){return"[UnexpectedJSONParseError]: "+T.message}}}).call(this)}).call(this,F("_process"))},{"./common":5,_process:12}],5:[function(F,K){K.exports=function(I){function J(T){function O(...fa){if(O.enabled){var R=+new Date;O.diff=R-(W||R);O.prev=W;W=O.curr=R;fa[0]=J.coerce(fa[0]);"string"!=typeof fa[0]&&fa.unshift("%O");var da=0;fa[0]=fa[0].replace(/%([a-zA-Z%])/g,
(ha,ma)=>{if("%%"===ha)return"%";da++;ma=J.formatters[ma];"function"==typeof ma&&(ha=ma.call(O,fa[da]),fa.splice(da,1),da--);return ha});J.formatArgs.call(O,fa);(O.log||J.log).apply(O,fa)}}let W,ba=null;return O.namespace=T,O.useColors=J.useColors(),O.color=J.selectColor(T),O.extend=H,O.destroy=J.destroy,Object.defineProperty(O,"enabled",{enumerable:!0,configurable:!1,get:()=>null===ba?J.enabled(T):ba,set:fa=>{ba=fa}}),"function"==typeof J.init&&J.init(O),O}function H(T,O){T=J(this.namespace+(void 0===
O?":":O)+T);return T.log=this.log,T}function N(T){return T.toString().substring(2,T.toString().length-2).replace(/\.\*\?$/,"*")}return J.debug=J,J.default=J,J.coerce=function(T){return T instanceof Error?T.stack||T.message:T},J.disable=function(){const T=[...J.names.map(N),...J.skips.map(N).map(O=>"-"+O)].join();return J.enable(""),T},J.enable=function(T){let O;J.save(T);J.names=[];J.skips=[];const W=("string"==typeof T?T:"").split(/[\s,]+/),ba=W.length;for(O=0;O<ba;O++)W[O]&&("-"===(T=W[O].replace(/\*/g,
".*?"))[0]?J.skips.push(new RegExp("^"+T.substr(1)+"$")):J.names.push(new RegExp("^"+T+"$")))},J.enabled=function(T){if("*"===T[T.length-1])return!0;let O,W;O=0;for(W=J.skips.length;O<W;O++)if(J.skips[O].test(T))return!1;O=0;for(W=J.names.length;O<W;O++)if(J.names[O].test(T))return!0;return!1},J.humanize=F("ms"),J.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(I).forEach(T=>
{J[T]=I[T]}),J.names=[],J.skips=[],J.formatters={},J.selectColor=function(T){let O=0;for(let W=0;W<T.length;W++)O=(O<<5)-O+T.charCodeAt(W),O|=0;return J.colors[u(O)%J.colors.length]},J.enable(J.load()),J}},{ms:11}],6:[function(F,K){function I(J,H){for(const N in H)Object.defineProperty(J,N,{value:H[N],enumerable:!0,configurable:!0});return J}K.exports=function(J,H,N){if(!J||"string"==typeof J)throw new TypeError("Please pass an Error to err-code");N||={};"object"==typeof H&&(N=H,H="");H&&(N.code=
H);try{return I(J,N)}catch(T){return N.message=J.message,N.stack=J.stack,H=function(){},H.prototype=Object.create(Object.getPrototypeOf(J)),I(new H,N)}}},{}],7:[function(F,K){function I(){I.init.call(this)}function J(ka){if("function"!=typeof ka)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ka);}function H(ka,pa,la,ta){var wa,za,Ca;if(J(la),void 0===(za=ka._events)?(za=ka._events=Object.create(null),ka._eventsCount=0):(void 0!==za.newListener&&(ka.emit("newListener",
pa,la.listener?la.listener:la),za=ka._events),Ca=za[pa]),void 0===Ca)za[pa]=la,++ka._eventsCount;else if("function"==typeof Ca?Ca=za[pa]=ta?[la,Ca]:[Ca,la]:ta?Ca.unshift(la):Ca.push(la),0<(wa=void 0===ka._maxListeners?I.defaultMaxListeners:ka._maxListeners)&&Ca.length>wa&&!Ca.warned)Ca.warned=!0,la=Error("Possible EventEmitter memory leak detected. "+Ca.length+" "+pa+" listeners added. Use emitter.setMaxListeners() to increase limit"),la.name="MaxListenersExceededWarning",la.emitter=ka,la.type=pa,
la.count=Ca.length,console&&console.warn&&console.warn(la);return ka}function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(ka,pa,la){ka={fired:!1,wrapFn:void 0,target:ka,type:pa,listener:la};pa=N.bind(ka);return pa.listener=la,ka.wrapFn=pa,pa}function O(ka,pa,la){ka=ka._events;if(void 0===ka)return[];pa=ka[pa];if(void 0===pa)la=[];else if("function"==
typeof pa)la=la?[pa.listener||pa]:[pa];else if(la)for(la=Array(pa.length),ka=0;ka<la.length;++ka)la[ka]=pa[ka].listener||pa[ka];else la=ba(pa,pa.length);return la}function W(ka){var pa=this._events;if(void 0!==pa){ka=pa[ka];if("function"==typeof ka)return 1;if(void 0!==ka)return ka.length}return 0}function ba(ka,pa){for(var la=Array(pa),ta=0;ta<pa;++ta)la[ta]=ka[ta];return la}function fa(ka,pa,la,ta){if("function"==typeof ka.on)ta.once?ka.once(pa,la):ka.on(pa,la);else{if("function"!=typeof ka.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+
typeof ka);ka.addEventListener(pa,function Ca(za){ta.once&&ka.removeEventListener(pa,Ca);la(za)})}}var R=(F="object"==typeof Reflect?Reflect:null)&&"function"==typeof F.apply?F.apply:function(ka,pa,la){return Function.prototype.apply.call(ka,pa,la)};var da=F&&"function"==typeof F.ownKeys?F.ownKeys:Object.getOwnPropertySymbols?function(ka){return Object.getOwnPropertyNames(ka).concat(Object.getOwnPropertySymbols(ka))}:function(ka){return Object.getOwnPropertyNames(ka)};var ha=Number.isNaN||function(ka){return ka!=
ka};K.exports=I;K.exports.once=function(ka,pa){return new Promise(function(la,ta){function wa(Ca){ka.removeListener(pa,za);ta(Ca)}function za(){"function"==typeof ka.removeListener&&ka.removeListener("error",wa);la([].slice.call(arguments))}fa(ka,pa,za,{once:!0});"error"!==pa&&function(Ca,Vb,Kb){"function"==typeof Ca.on&&fa(Ca,"error",Vb,Kb)}(ka,wa,{once:!0})})};I.EventEmitter=I;I.prototype._events=void 0;I.prototype._eventsCount=0;I.prototype._maxListeners=void 0;var ma=10;Object.defineProperty(I,
"defaultMaxListeners",{enumerable:!0,get:function(){return ma},set:function(ka){if("number"!=typeof ka||0>ka||ha(ka))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ka+".");ma=ka}});I.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0);this._maxListeners=this._maxListeners||void 0};I.prototype.setMaxListeners=function(ka){if("number"!=
typeof ka||0>ka||ha(ka))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ka+".");return this._maxListeners=ka,this};I.prototype.getMaxListeners=function(){return void 0===this._maxListeners?I.defaultMaxListeners:this._maxListeners};I.prototype.emit=function(ka){for(var pa=[],la=1;la<arguments.length;la++)pa.push(arguments[la]);la="error"===ka;var ta=this._events;if(void 0!==ta)la=la&&void 0===ta.error;else if(!la)return!1;if(la){var wa;if(0<pa.length&&
(wa=pa[0]),wa instanceof Error)throw wa;pa=Error("Unhandled error."+(wa?" ("+wa.message+")":""));throw pa.context=wa,pa;}la=ta[ka];if(void 0===la)return!1;if("function"==typeof la)R(la,this,pa);else for(wa=la.length,ta=ba(la,wa),la=0;la<wa;++la)R(ta[la],this,pa);return!0};I.prototype.addListener=function(ka,pa){return H(this,ka,pa,!1)};I.prototype.on=I.prototype.addListener;I.prototype.prependListener=function(ka,pa){return H(this,ka,pa,!0)};I.prototype.once=function(ka,pa){return J(pa),this.on(ka,
T(this,ka,pa)),this};I.prototype.prependOnceListener=function(ka,pa){return J(pa),this.prependListener(ka,T(this,ka,pa)),this};I.prototype.removeListener=function(ka,pa){var la,ta,wa;if((J(pa),void 0===(ta=this._events))||void 0===(la=ta[ka]))return this;if(la===pa||la.listener===pa)0==--this._eventsCount?this._events=Object.create(null):(delete ta[ka],ta.removeListener&&this.emit("removeListener",ka,la.listener||pa));else if("function"!=typeof la){var za=-1;for(wa=la.length-1;0<=wa;wa--)if(la[wa]===
pa||la[wa].listener===pa){var Ca=la[wa].listener;za=wa;break}if(0>za)return this;if(0===za)la.shift();else{for(;za+1<la.length;za++)la[za]=la[za+1];la.pop()}1===la.length&&(ta[ka]=la[0]);void 0!==ta.removeListener&&this.emit("removeListener",ka,Ca||pa)}return this};I.prototype.off=I.prototype.removeListener;I.prototype.removeAllListeners=function(ka){var pa,la;if(void 0===(la=this._events))return this;if(void 0===la.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=
0):void 0!==la[ka]&&(0==--this._eventsCount?this._events=Object.create(null):delete la[ka]),this;if(0===arguments.length){var ta=Object.keys(la);for(la=0;la<ta.length;++la)"removeListener"!==(pa=ta[la])&&this.removeAllListeners(pa);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(pa=la[ka]))this.removeListener(ka,pa);else if(void 0!==pa)for(la=pa.length-1;0<=la;la--)this.removeListener(ka,pa[la]);return this};I.prototype.listeners=
function(ka){return O(this,ka,!0)};I.prototype.rawListeners=function(ka){return O(this,ka,!1)};I.listenerCount=function(ka,pa){return"function"==typeof ka.listenerCount?ka.listenerCount(pa):W.call(ka,pa)};I.prototype.listenerCount=W;I.prototype.eventNames=function(){return 0<this._eventsCount?da(this._events):[]}},{}],8:[function(F,K){K.exports=function(){if("undefined"==typeof globalThis)return null;var I={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,
RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return I.RTCPeerConnection?I:null}},{}],9:[function(F,K,I){I.read=function(J,H,N,T,O){var W=8*O-T-1;var ba=(1<<W)-1,fa=ba>>1,R=-7;O=N?O-1:0;var da=N?-1:1,ha=J[H+O];O+=da;N=ha&(1<<-R)-1;ha>>=-R;for(R+=W;0<R;N=256*N+J[H+O],O+=da,R-=8);W=N&(1<<-R)-1;N>>=-R;for(R+=
T;0<R;W=256*W+J[H+O],O+=da,R-=8);if(0===N)N=1-fa;else{if(N===ba)return W?NaN:1/0*(ha?-1:1);W+=B(2,T);N-=fa}return(ha?-1:1)*W*B(2,N-T)};I.write=function(J,H,N,T,O,W){var ba,fa,R,da=Math.LN2,ha=Math.log,ma=8*W-O-1,ka=(1<<ma)-1,pa=ka>>1,la=23===O?B(2,-24)-B(2,-77):0;W=T?0:W-1;T=T?1:-1;var ta=0>H||0===H&&0>1/H?1:0;H=u(H);for(isNaN(H)||H===1/0?(fa=isNaN(H)?1:0,ba=ka):(ba=q(ha(H)/da),1>H*(R=B(2,-ba))&&(ba--,R*=2),2<=(H+=1<=ba+pa?la/R:la*B(2,1-pa))*R&&(ba++,R/=2),ba+pa>=ka?(fa=0,ba=ka):1<=ba+pa?(fa=(H*R-
1)*B(2,O),ba+=pa):(fa=H*B(2,pa-1)*B(2,O),ba=0));8<=O;J[N+W]=255&fa,W+=T,fa/=256,O-=8);ba=ba<<O|fa;for(ma+=O;0<ma;J[N+W]=255&ba,W+=T,ba/=256,ma-=8);J[N+W-T]|=128*ta}},{}],10:[function(F,K){K.exports="function"==typeof Object.create?function(I,J){J&&(I.super_=J,I.prototype=Object.create(J.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}))}:function(I,J){if(J){I.super_=J;var H=function(){};H.prototype=J.prototype;I.prototype=new H;I.prototype.constructor=I}}},{}],11:[function(F,
K){function I(H,N,T,O){return J(H/T)+" "+O+(N>=1.5*T?"s":"")}var J=Math.round;K.exports=function(H,N){N=N||{};var T=typeof H;if("string"==T&&0<H.length){a:{if(!(100<(H+="").length)&&(N=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(H))){H=parseFloat(N[1]);N=(N[2]||"ms").toLowerCase();H="years"===N||"year"===N||"yrs"===N||"yr"===N||"y"===N?315576E5*H:"weeks"===N||"week"===N||"w"===N?6048E5*H:"days"===N||"day"===
N||"d"===N?864E5*H:"hours"===N||"hour"===N||"hrs"===N||"hr"===N||"h"===N?36E5*H:"minutes"===N||"minute"===N||"mins"===N||"min"===N||"m"===N?6E4*H:"seconds"===N||"second"===N||"secs"===N||"sec"===N||"s"===N?1E3*H:"milliseconds"===N||"millisecond"===N||"msecs"===N||"msec"===N||"ms"===N?H:void 0;break a}H=void 0}return H}if("number"===T&&isFinite(H))return N.long?(N=u(H),H=864E5<=N?I(H,N,864E5,"day"):36E5<=N?I(H,N,36E5,"hour"):6E4<=N?I(H,N,6E4,"minute"):1E3<=N?I(H,N,1E3,"second"):H+" ms"):(N=u(H),H=
864E5<=N?J(H/864E5)+"d":36E5<=N?J(H/36E5)+"h":6E4<=N?J(H/6E4)+"m":1E3<=N?J(H/1E3)+"s":H+"ms"),H;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(H));}},{}],12:[function(F,K){function I(){throw Error("setTimeout has not been defined");}function J(){throw Error("clearTimeout has not been defined");}function H(ka){if(ba===setTimeout)return setTimeout(ka,0);if((ba===I||!ba)&&setTimeout)return ba=setTimeout,setTimeout(ka,0);try{return ba(ka,0)}catch(pa){try{return ba.call(null,
ka,0)}catch(la){return ba.call(this,ka,0)}}}function N(){ha&&R&&(ha=!1,R.length?da=R.concat(da):ma=-1,da.length&&T())}function T(){if(!ha){var ka=H(N);ha=!0;for(var pa=da.length;pa;){R=da;for(da=[];++ma<pa;)R&&R[ma].run();ma=-1;pa=da.length}R=null;ha=!1;(function(la){if(fa===clearTimeout)return clearTimeout(la);if((fa===J||!fa)&&clearTimeout)return fa=clearTimeout,clearTimeout(la);try{fa(la)}catch(ta){try{return fa.call(null,la)}catch(wa){return fa.call(this,la)}}})(ka)}}function O(ka,pa){this.fun=
ka;this.array=pa}function W(){}F=K.exports={};try{var ba="function"==typeof setTimeout?setTimeout:I}catch(ka){ba=I}try{var fa="function"==typeof clearTimeout?clearTimeout:J}catch(ka){fa=J}!0;var R,da=[],ha=!1,ma=-1;F.nextTick=function(ka){var pa=Array(arguments.length-1);if(1<arguments.length)for(var la=1;la<arguments.length;la++)pa[la-1]=arguments[la];da.push(new O(ka,pa));1!==da.length||ha||H(T)};O.prototype.run=function(){this.fun.apply(null,this.array)};F.title="browser";F.browser=!0;F.env={};
F.argv=[];F.version="";F.versions={};F.on=W;F.addListener=W;F.once=W;F.off=W;F.removeListener=W;F.removeAllListeners=W;F.emit=W;F.prependListener=W;F.prependOnceListener=W;F.listeners=function(){return[]};F.binding=function(){throw Error("process.binding is not supported");};F.cwd=function(){return"/"};F.chdir=function(){throw Error("process.chdir is not supported");};F.umask=function(){return 0}},{}],13:[function(F,K){(function(I){(function(){let J;K.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"==
typeof window?I:window):H=>(J||=Promise.resolve()).then(H).catch(N=>setTimeout(()=>{throw N;},0))}).call(this)}).call(this,void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{}],14:[function(F,K){(function(I,J){(function(){var H=F("safe-buffer").Buffer,N=J.crypto||J.msCrypto;K.exports=N&&N.getRandomValues?function(T,O){if(4294967295<T)throw new RangeError("requested too many random bytes");
var W=H.allocUnsafe(T);if(0<T)if(65536<T)for(var ba=0;ba<T;ba+=65536)N.getRandomValues(W.slice(ba,ba+65536));else N.getRandomValues(W);return"function"==typeof O?I.nextTick(function(){O(null,W)}):W}:function(){throw Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11");}}).call(this)}).call(this,F("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},
{_process:12,"safe-buffer":30}],15:[function(F,K){function I(N,T,O){O||=Error;var W=function(ba){function fa(R,da,ha){return ba.call(this,"string"==typeof T?T:T(R,da,ha))||this}return function(R,da){R.prototype=Object.create(da.prototype);R.prototype.constructor=R;R.__proto__=da}(fa,ba),fa}(O);W.prototype.name=O.name;W.prototype.code=N;H[N]=W}function J(N,T){if(Array.isArray(N)){var O=N.length;return N=N.map(function(W){return W+""}),2<O?"one of ".concat(T," ").concat(N.slice(0,O-1).join(", "),", or ")+
N[O-1]:2===O?"one of ".concat(T," ").concat(N[0]," or ").concat(N[1]):"of ".concat(T," ").concat(N[0])}return"of ".concat(T," ").concat(N+"")}var H={};I("ERR_INVALID_OPT_VALUE",function(N,T){return'The value "'+T+'" is invalid for option "'+N+'"'},TypeError);I("ERR_INVALID_ARG_TYPE",function(N,T,O){var W;if("string"==typeof T&&function(fa,R,da){return fa.substr(!da||0>da?0:+da,R.length)===R}(T,"not ")?(W="must not be",T=T.replace(/^not /,"")):W="must be",function(fa,R,da){return(void 0===da||da>fa.length)&&
(da=fa.length),fa.substring(da-R.length,da)===R}(N," argument"))N="The ".concat(N," ").concat(W," ").concat(J(T,"type"));else{var ba=function(fa,R,da){return"number"!=typeof da&&(da=0),!(da+R.length>fa.length)&&-1!==fa.indexOf(R,da)}(N,".")?"property":"argument";N='The "'.concat(N,'" ').concat(ba," ").concat(W," ").concat(J(T,"type"))}return N+=". Received type ".concat(typeof O)},TypeError);I("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");I("ERR_METHOD_NOT_IMPLEMENTED",function(N){return"The "+
N+" method is not implemented"});I("ERR_STREAM_PREMATURE_CLOSE","Premature close");I("ERR_STREAM_DESTROYED",function(N){return"Cannot call "+N+" after a stream was destroyed"});I("ERR_MULTIPLE_CALLBACK","Callback called multiple times");I("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");I("ERR_STREAM_WRITE_AFTER_END","write after end");I("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);I("ERR_UNKNOWN_ENCODING",function(N){return"Unknown encoding: "+N},TypeError);I("ERR_STREAM_UNSHIFT_AFTER_END_EVENT",
"stream.unshift() after end event");K.exports.codes=H},{}],16:[function(F,K){(function(I){(function(){function J(R){return this instanceof J?(O.call(this,R),W.call(this,R),this.allowHalfOpen=!0,void(R&&(!1===R.readable&&(this.readable=!1),!1===R.writable&&(this.writable=!1),!1===R.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",H))))):new J(R)}function H(){this._writableState.ended||I.nextTick(N,this)}function N(R){R.end()}var T=Object.keys||function(R){var da=[],ha;for(ha in R)da.push(ha);
return da};K.exports=J;var O=F("./_stream_readable"),W=F("./_stream_writable");F("inherits")(J,O);for(var ba=T(W.prototype),fa=0;fa<ba.length;fa++)T=ba[fa],J.prototype[T]||(J.prototype[T]=W.prototype[T]);Object.defineProperty(J.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(J.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(J.prototype,
"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(R){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=R,this._writableState.destroyed=R)}})}).call(this)}).call(this,F("_process"))},{"./_stream_readable":18,"./_stream_writable":20,
_process:12,inherits:10}],17:[function(F,K){function I(H){return this instanceof I?void J.call(this,H):new I(H)}K.exports=I;var J=F("./_stream_transform");F("inherits")(I,J);I.prototype._transform=function(H,N,T){T(null,H)}},{"./_stream_transform":19,inherits:10}],18:[function(F,K){(function(I,J){(function(){function H(aa,Y,xa){Ca=Ca||F("./_stream_duplex");aa=aa||{};"boolean"!=typeof xa&&(xa=Y instanceof Ca);this.objectMode=!!aa.objectMode;xa&&(this.objectMode=this.objectMode||!!aa.readableObjectMode);
this.highWaterMark=Me(this,aa,"readableHighWaterMark",xa);this.buffer=new Rb;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.reading=this.endEmitted=this.ended=!1;this.sync=!0;this.resumeScheduled=this.readableListening=this.emittedReadable=this.needReadable=!1;this.paused=!0;this.emitClose=!1!==aa.emitClose;this.autoDestroy=!!aa.autoDestroy;this.destroyed=!1;this.defaultEncoding=aa.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=!1;this.encoding=this.decoder=null;
aa.encoding&&(!uc&&(uc=F("string_decoder/").StringDecoder),this.decoder=new uc(aa.encoding),this.encoding=aa.encoding)}function N(aa){if(Ca=Ca||F("./_stream_duplex"),!(this instanceof N))return new N(aa);this._readableState=new H(aa,this,this instanceof Ca);this.readable=!0;aa&&("function"==typeof aa.read&&(this._read=aa.read),"function"==typeof aa.destroy&&(this._destroy=aa.destroy));Vb.call(this)}function T(aa,Y,xa,Oa,Ob){Ya("readableAddChunk",Y);var Ka=aa._readableState;if(null===Y)Ka.reading=
!1,(Ya("onEofChunk"),Ka.ended)||(Ka.decoder&&(Y=Ka.decoder.end())&&Y.length&&(Ka.buffer.push(Y),Ka.length+=Ka.objectMode?1:Y.length),Ka.ended=!0,Ka.sync?ba(aa):(Ka.needReadable=!1,!Ka.emittedReadable&&(Ka.emittedReadable=!0,fa(aa))));else{if(!Ob){Ob=Y;var Ib;var qc=(Kb.isBuffer(Ob)||Ob instanceof Qd||"string"==typeof Ob||void 0===Ob||Ka.objectMode||(Ib=new M("chunk",["string","Buffer","Uint8Array"],Ob)),Ib)}if(qc)Ba(aa,qc);else if(Ka.objectMode||Y&&0<Y.length)if("string"==typeof Y||Ka.objectMode||
Object.getPrototypeOf(Y)===Kb.prototype||(Y=Kb.from(Y)),Oa)Ka.endEmitted?Ba(aa,new oa):O(aa,Ka,Y,!0);else if(Ka.ended)Ba(aa,new Q);else{if(Ka.destroyed)return!1;Ka.reading=!1;Ka.decoder&&!xa?(Y=Ka.decoder.write(Y),Ka.objectMode||0!==Y.length?O(aa,Ka,Y,!1):R(aa,Ka)):O(aa,Ka,Y,!1)}else Oa||(Ka.reading=!1,R(aa,Ka))}return!Ka.ended&&(Ka.length<Ka.highWaterMark||0===Ka.length)}function O(aa,Y,xa,Oa){Y.flowing&&0===Y.length&&!Y.sync?(Y.awaitDrain=0,aa.emit("data",xa)):(Y.length+=Y.objectMode?1:xa.length,
Oa?Y.buffer.unshift(xa):Y.buffer.push(xa),Y.needReadable&&ba(aa));R(aa,Y)}function W(aa,Y){if(0>=aa||0===Y.length&&Y.ended)aa=0;else if(Y.objectMode)aa=1;else if(aa==aa){if(aa>Y.highWaterMark){var xa=aa;var Oa=(1073741824<=xa?xa=1073741824:(xa--,xa|=xa>>>1,xa|=xa>>>2,xa|=xa>>>4,xa|=xa>>>8,xa|=xa>>>16,xa++),xa);Y.highWaterMark=Oa}aa=aa<=Y.length?aa:Y.ended?Y.length:(Y.needReadable=!0,0)}else aa=Y.flowing&&Y.length?Y.buffer.head.data.length:Y.length;return aa}function ba(aa){var Y=aa._readableState;
Ya("emitReadable",Y.needReadable,Y.emittedReadable);Y.needReadable=!1;Y.emittedReadable||(Ya("emitReadable",Y.flowing),Y.emittedReadable=!0,I.nextTick(fa,aa))}function fa(aa){var Y=aa._readableState;Ya("emitReadable_",Y.destroyed,Y.length,Y.ended);!Y.destroyed&&(Y.length||Y.ended)&&(aa.emit("readable"),Y.emittedReadable=!1);Y.needReadable=!Y.flowing&&!Y.ended&&Y.length<=Y.highWaterMark;pa(aa)}function R(aa,Y){Y.readingMore||(Y.readingMore=!0,I.nextTick(da,aa,Y))}function da(aa,Y){for(;!Y.reading&&
!Y.ended&&(Y.length<Y.highWaterMark||Y.flowing&&0===Y.length);){var xa=Y.length;if(Ya("maybeReadMore read 0"),aa.read(0),xa===Y.length)break}Y.readingMore=!1}function ha(aa){var Y=aa._readableState;Y.readableListening=0<aa.listenerCount("readable");Y.resumeScheduled&&!Y.paused?Y.flowing=!0:0<aa.listenerCount("data")&&aa.resume()}function ma(aa){Ya("readable nexttick read 0");aa.read(0)}function ka(aa,Y){Ya("resume",Y.reading);Y.reading||aa.read(0);Y.resumeScheduled=!1;aa.emit("resume");pa(aa);Y.flowing&&
!Y.reading&&aa.read(0)}function pa(aa){var Y=aa._readableState;for(Ya("flow",Y.flowing);Y.flowing&&null!==aa.read(););}function la(aa,Y){return 0===Y.length?null:(Y.objectMode?xa=Y.buffer.shift():!aa||aa>=Y.length?(xa=Y.decoder?Y.buffer.join(""):1===Y.buffer.length?Y.buffer.first():Y.buffer.concat(Y.length),Y.buffer.clear()):xa=Y.buffer.consume(aa,Y.decoder),xa);var xa}function ta(aa){var Y=aa._readableState;Ya("endReadable",Y.endEmitted);Y.endEmitted||(Y.ended=!0,I.nextTick(wa,Y,aa))}function wa(aa,
Y){if(Ya("endReadableNT",aa.endEmitted,aa.length),!aa.endEmitted&&0===aa.length&&(aa.endEmitted=!0,Y.readable=!1,Y.emit("end"),aa.autoDestroy))aa=Y._writableState,(!aa||aa.autoDestroy&&aa.finished)&&Y.destroy()}function za(aa,Y){for(var xa=0,Oa=aa.length;xa<Oa;xa++)if(aa[xa]===Y)return xa;return-1}var Ca;K.exports=N;N.ReadableState=H;F("events").EventEmitter;var Vb=F("./internal/streams/stream"),Kb=F("buffer").Buffer,Qd=J.Uint8Array||function(){},Sa=F("util");var Ya=Sa&&Sa.debuglog?Sa.debuglog("stream"):
function(){};var uc,Zb,pd,Rb=F("./internal/streams/buffer_list");Sa=F("./internal/streams/destroy");var Me=F("./internal/streams/state").getHighWaterMark,L=F("../errors").codes,M=L.ERR_INVALID_ARG_TYPE,Q=L.ERR_STREAM_PUSH_AFTER_EOF,ca=L.ERR_METHOD_NOT_IMPLEMENTED,oa=L.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;F("inherits")(N,Vb);var Ba=Sa.errorOrDestroy,ya=["error","close","destroy","pause","resume"];Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&
this._readableState.destroyed},set:function(aa){this._readableState&&(this._readableState.destroyed=aa)}});N.prototype.destroy=Sa.destroy;N.prototype._undestroy=Sa.undestroy;N.prototype._destroy=function(aa,Y){Y(aa)};N.prototype.push=function(aa,Y){var xa,Oa=this._readableState;return Oa.objectMode?xa=!0:"string"==typeof aa&&((Y=Y||Oa.defaultEncoding)!==Oa.encoding&&(aa=Kb.from(aa,Y),Y=""),xa=!0),T(this,aa,Y,!1,xa)};N.prototype.unshift=function(aa){return T(this,aa,null,!0,!1)};N.prototype.isPaused=
function(){return!1===this._readableState.flowing};N.prototype.setEncoding=function(aa){uc||=F("string_decoder/").StringDecoder;aa=new uc(aa);this._readableState.decoder=aa;this._readableState.encoding=this._readableState.decoder.encoding;for(var Y=this._readableState.buffer.head,xa="";null!==Y;)xa+=aa.write(Y.data),Y=Y.next;return this._readableState.buffer.clear(),""!==xa&&this._readableState.buffer.push(xa),this._readableState.length=xa.length,this};N.prototype.read=function(aa){Ya("read",aa);
aa=parseInt(aa,10);var Y=this._readableState,xa=aa;if(0!==aa&&(Y.emittedReadable=!1),0===aa&&Y.needReadable&&((0===Y.highWaterMark?0<Y.length:Y.length>=Y.highWaterMark)||Y.ended))return Ya("read: emitReadable",Y.length,Y.ended),0===Y.length&&Y.ended?ta(this):ba(this),null;if(0===(aa=W(aa,Y))&&Y.ended)return 0===Y.length&&ta(this),null;var Oa,Ob=Y.needReadable;return Ya("need readable",Ob),(0===Y.length||Y.length-aa<Y.highWaterMark)&&Ya("length less than watermark",Ob=!0),Y.ended||Y.reading?Ya("reading or ended",
!1):Ob&&(Ya("do read"),Y.reading=!0,Y.sync=!0,0===Y.length&&(Y.needReadable=!0),this._read(Y.highWaterMark),Y.sync=!1,!Y.reading&&(aa=W(xa,Y))),null===(Oa=0<aa?la(aa,Y):null)?(Y.needReadable=Y.length<=Y.highWaterMark,aa=0):(Y.length-=aa,Y.awaitDrain=0),0===Y.length&&(!Y.ended&&(Y.needReadable=!0),xa!==aa&&Y.ended&&ta(this)),null!==Oa&&this.emit("data",Oa),Oa};N.prototype._read=function(){Ba(this,new ca("_read()"))};N.prototype.pipe=function(aa,Y){function xa($b,vc){Ya("onunpipe");$b===$a&&vc&&!1===
vc.hasUnpiped&&(vc.hasUnpiped=!0,Ya("cleanup"),aa.removeListener("close",Ib),aa.removeListener("finish",qc),aa.removeListener("drain",ef),aa.removeListener("error",Ka),aa.removeListener("unpipe",xa),$a.removeListener("end",Oa),$a.removeListener("end",ff),$a.removeListener("data",Ob),lh=!0,wc.awaitDrain&&(!aa._writableState||aa._writableState.needDrain)&&ef())}function Oa(){Ya("onend");aa.end()}function Ob($b){Ya("ondata");$b=aa.write($b);Ya("dest.write",$b);!1===$b&&((1===wc.pipesCount&&wc.pipes===
aa||1<wc.pipesCount&&-1!==za(wc.pipes,aa))&&!lh&&(Ya("false write response, pause",wc.awaitDrain),wc.awaitDrain++),$a.pause())}function Ka($b){Ya("onerror",$b);ff();aa.removeListener("error",Ka);0===aa.listeners("error").length&&Ba(aa,$b)}function Ib(){aa.removeListener("finish",qc);ff()}function qc(){Ya("onfinish");aa.removeListener("close",Ib);ff()}function ff(){Ya("unpipe");$a.unpipe(aa)}var $a=this,wc=this._readableState;switch(wc.pipesCount){case 0:wc.pipes=aa;break;case 1:wc.pipes=[wc.pipes,
aa];break;default:wc.pipes.push(aa)}wc.pipesCount+=1;Ya("pipe count=%d opts=%j",wc.pipesCount,Y);Y=Y&&!1===Y.end||aa===I.stdout||aa===I.stderr?ff:Oa;wc.endEmitted?I.nextTick(Y):$a.once("end",Y);aa.on("unpipe",xa);var ef=function($b){return function(){var vc=$b._readableState;Ya("pipeOnDrain",vc.awaitDrain);vc.awaitDrain&&vc.awaitDrain--;0===vc.awaitDrain&&$b.listeners("data").length&&(vc.flowing=!0,pa($b))}}($a);aa.on("drain",ef);var lh=!1;return $a.on("data",Ob),function($b,vc,he){"function"==typeof $b.prependListener?
$b.prependListener(vc,he):$b._events&&$b._events[vc]?Array.isArray($b._events[vc])?$b._events[vc].unshift(he):$b._events[vc]=[he,$b._events[vc]]:$b.on(vc,he)}(aa,"error",Ka),aa.once("close",Ib),aa.once("finish",qc),aa.emit("pipe",$a),wc.flowing||(Ya("pipe resume"),$a.resume()),aa};N.prototype.unpipe=function(aa){var Y=this._readableState,xa={hasUnpiped:!1};if(0===Y.pipesCount)return this;if(1===Y.pipesCount)return aa&&aa!==Y.pipes||(aa||=Y.pipes,Y.pipes=null,Y.pipesCount=0,Y.flowing=!1,aa&&aa.emit("unpipe",
this,xa)),this;if(!aa){aa=Y.pipes;xa=Y.pipesCount;Y.pipes=null;Y.pipesCount=0;Y.flowing=!1;for(Y=0;Y<xa;Y++)aa[Y].emit("unpipe",this,{hasUnpiped:!1});return this}var Oa=za(Y.pipes,aa);return-1===Oa||(Y.pipes.splice(Oa,1),--Y.pipesCount,1===Y.pipesCount&&(Y.pipes=Y.pipes[0]),aa.emit("unpipe",this,xa)),this};N.prototype.on=function(aa,Y){Y=Vb.prototype.on.call(this,aa,Y);var xa=this._readableState;return"data"===aa?(xa.readableListening=0<this.listenerCount("readable"),!1!==xa.flowing&&this.resume()):
"readable"==aa&&!xa.endEmitted&&!xa.readableListening&&(xa.readableListening=xa.needReadable=!0,xa.flowing=!1,xa.emittedReadable=!1,Ya("on readable",xa.length,xa.reading),xa.length?ba(this):!xa.reading&&I.nextTick(ma,this)),Y};N.prototype.addListener=N.prototype.on;N.prototype.removeListener=function(aa,Y){Y=Vb.prototype.removeListener.call(this,aa,Y);return"readable"===aa&&I.nextTick(ha,this),Y};N.prototype.removeAllListeners=function(aa){var Y=Vb.prototype.removeAllListeners.apply(this,arguments);
return("readable"===aa||void 0===aa)&&I.nextTick(ha,this),Y};N.prototype.resume=function(){var aa=this._readableState;aa.flowing||(Ya("resume"),aa.flowing=!aa.readableListening,aa.resumeScheduled||(aa.resumeScheduled=!0,I.nextTick(ka,this,aa)));return aa.paused=!1,this};N.prototype.pause=function(){return Ya("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Ya("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};N.prototype.wrap=
function(aa){var Y=this,xa=this._readableState,Oa=!1,Ob;for(Ob in aa.on("end",function(){if(Ya("wrapped end"),xa.decoder&&!xa.ended){var Ka=xa.decoder.end();Ka&&Ka.length&&Y.push(Ka)}Y.push(null)}),aa.on("data",function(Ka){Ya("wrapped data");xa.decoder&&(Ka=xa.decoder.write(Ka));xa.objectMode&&null==Ka||!(xa.objectMode||Ka&&Ka.length)||Y.push(Ka)||(Oa=!0,aa.pause())}),aa)void 0===this[Ob]&&"function"==typeof aa[Ob]&&(this[Ob]=function(Ka){return function(){return aa[Ka].apply(aa,arguments)}}(Ob));
for(Ob=0;Ob<ya.length;Ob++)aa.on(ya[Ob],this.emit.bind(this,ya[Ob]));return this._read=function(Ka){Ya("wrapped _read",Ka);Oa&&(Oa=!1,aa.resume())},this};"function"==typeof Symbol&&(N.prototype[Symbol.asyncIterator]=function(){return void 0===Zb&&(Zb=F("./internal/streams/async_iterator")),Zb(this)});Object.defineProperty(N.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(N.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&
this._readableState.buffer}});Object.defineProperty(N.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(aa){this._readableState&&(this._readableState.flowing=aa)}});N._fromList=la;Object.defineProperty(N.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});"function"==typeof Symbol&&(N.from=function(aa,Y){return void 0===pd&&(pd=F("./internal/streams/from")),pd(N,aa,Y)})}).call(this)}).call(this,F("_process"),
void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(F,K){function I(R,da){var ha=
this._transformState;ha.transforming=!1;var ma=ha.writecb;if(null===ma)return this.emit("error",new O);ha.writechunk=null;ha.writecb=null;null!=da&&this.push(da);ma(R);R=this._readableState;R.reading=!1;(R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}function J(R){return this instanceof J?(fa.call(this,R),this._transformState={afterTransform:I.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=
!1,R&&("function"==typeof R.transform&&(this._transform=R.transform),"function"==typeof R.flush&&(this._flush=R.flush)),void this.on("prefinish",H)):new J(R)}function H(){var R=this;"function"!=typeof this._flush||this._readableState.destroyed?N(this,null,null):this._flush(function(da,ha){N(R,da,ha)})}function N(R,da,ha){if(da)return R.emit("error",da);if(null!=ha&&R.push(ha),R._writableState.length)throw new ba;if(R._transformState.transforming)throw new W;return R.push(null)}K.exports=J;K=F("../errors").codes;
var T=K.ERR_METHOD_NOT_IMPLEMENTED,O=K.ERR_MULTIPLE_CALLBACK,W=K.ERR_TRANSFORM_ALREADY_TRANSFORMING,ba=K.ERR_TRANSFORM_WITH_LENGTH_0,fa=F("./_stream_duplex");F("inherits")(J,fa);J.prototype.push=function(R,da){return this._transformState.needTransform=!1,fa.prototype.push.call(this,R,da)};J.prototype._transform=function(R,da,ha){ha(new T("_transform()"))};J.prototype._write=function(R,da,ha){var ma=this._transformState;(ma.writecb=ha,ma.writechunk=R,ma.writeencoding=da,ma.transforming)||(R=this._readableState,
(ma.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark))};J.prototype._read=function(){var R=this._transformState;null===R.writechunk||R.transforming?R.needTransform=!0:(R.transforming=!0,this._transform(R.writechunk,R.writeencoding,R.afterTransform))};J.prototype._destroy=function(R,da){fa.prototype._destroy.call(this,R,function(ha){da(ha)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(F,K){(function(I,J){(function(){function H(M){var Q=this;
this.entry=this.next=null;this.finish=function(){var ca=Q.entry;for(Q.entry=null;ca;){var oa=ca.callback;M.pendingcb--;oa(void 0);ca=ca.next}M.corkedRequestsFree.next=Q;!0}}function N(){}function T(M,Q,ca){ka=ka||F("./_stream_duplex");M=M||{};"boolean"!=typeof ca&&(ca=Q instanceof ka);this.objectMode=!!M.objectMode;ca&&(this.objectMode=this.objectMode||!!M.writableObjectMode);this.highWaterMark=Vb(this,M,"writableHighWaterMark",ca);this.destroyed=this.finished=this.ended=this.ending=this.needDrain=
this.finalCalled=!1;this.decodeStrings=!1!==M.decodeStrings;this.defaultEncoding=M.defaultEncoding||"utf8";this.length=0;this.writing=!1;this.corked=0;this.sync=!0;this.bufferProcessing=!1;this.onwrite=function(oa){ba(Q,oa)};this.writecb=null;this.writelen=0;this.lastBufferedRequest=this.bufferedRequest=null;this.pendingcb=0;this.errorEmitted=this.prefinished=!1;this.emitClose=!1!==M.emitClose;this.autoDestroy=!!M.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new H(this)}function O(M){var Q=
this instanceof(ka=ka||F("./_stream_duplex"));return Q||pa.call(O,this)?(this._writableState=new T(M,this,Q),this.writable=!0,M&&("function"==typeof M.write&&(this._write=M.write),"function"==typeof M.writev&&(this._writev=M.writev),"function"==typeof M.destroy&&(this._destroy=M.destroy),"function"==typeof M.final&&(this._final=M.final)),void ta.call(this)):new O(M)}function W(M,Q,ca,oa,Ba,ya,aa){Q.writelen=oa;Q.writecb=aa;Q.writing=!0;Q.sync=!0;Q.destroyed?Q.onwrite(new Zb("write")):ca?M._writev(Ba,
Q.onwrite):M._write(Ba,ya,Q.onwrite);Q.sync=!1}function ba(M,Q){var ca=M._writableState,oa=ca.sync,Ba=ca.writecb;if("function"!=typeof Ba)throw new Ya;(function(ya){ya.writing=!1;ya.writecb=null;ya.length-=ya.writelen;ya.writelen=0}(ca),Q)?!function(ya,aa,Y,xa,Oa){--aa.pendingcb;Y?(I.nextTick(Oa,xa),I.nextTick(ma,ya,aa),ya._writableState.errorEmitted=!0,L(ya,xa)):(Oa(xa),ya._writableState.errorEmitted=!0,L(ya,xa),ma(ya,aa))}(M,ca,oa,Q,Ba):((Q=da(ca)||M.destroyed)||ca.corked||ca.bufferProcessing||
!ca.bufferedRequest||R(M,ca),oa?I.nextTick(fa,M,ca,Q,Ba):fa(M,ca,Q,Ba))}function fa(M,Q,ca,oa){ca||0===Q.length&&Q.needDrain&&(Q.needDrain=!1,M.emit("drain"));Q.pendingcb--;oa();ma(M,Q)}function R(M,Q){Q.bufferProcessing=!0;var ca=Q.bufferedRequest;if(M._writev&&ca&&ca.next){var oa=Array(Q.bufferedRequestCount),Ba=Q.corkedRequestsFree;Ba.entry=ca;for(var ya=0,aa=!0;ca;)oa[ya]=ca,ca.isBuf||(aa=!1),ca=ca.next,ya+=1;oa.allBuffers=aa;W(M,Q,!0,Q.length,oa,"",Ba.finish);Q.pendingcb++;Q.lastBufferedRequest=
null;Ba.next?(Q.corkedRequestsFree=Ba.next,Ba.next=null):Q.corkedRequestsFree=new H(Q);Q.bufferedRequestCount=0}else{for(;ca&&(oa=ca.chunk,W(M,Q,!1,Q.objectMode?1:oa.length,oa,ca.encoding,ca.callback),ca=ca.next,Q.bufferedRequestCount--,!Q.writing););null===ca&&(Q.lastBufferedRequest=null)}Q.bufferedRequest=ca;Q.bufferProcessing=!1}function da(M){return M.ending&&0===M.length&&null===M.bufferedRequest&&!M.finished&&!M.writing}function ha(M,Q){M._final(function(ca){Q.pendingcb--;ca&&L(M,ca);Q.prefinished=
!0;M.emit("prefinish");ma(M,Q)})}function ma(M,Q){var ca=da(Q),oa;if(oa=ca)Q.prefinished||Q.finalCalled||("function"!=typeof M._final||Q.destroyed?(Q.prefinished=!0,M.emit("prefinish")):(Q.pendingcb++,Q.finalCalled=!0,I.nextTick(ha,M,Q))),oa=0===Q.pendingcb&&(Q.finished=!0,M.emit("finish"),Q.autoDestroy);oa&&(Q=M._readableState,(!Q||Q.autoDestroy&&Q.endEmitted)&&M.destroy());return ca}var ka;K.exports=O;O.WritableState=T;var pa,la={deprecate:F("util-deprecate")},ta=F("./internal/streams/stream"),
wa=F("buffer").Buffer,za=J.Uint8Array||function(){},Ca=F("./internal/streams/destroy"),Vb=F("./internal/streams/state").getHighWaterMark,Kb=F("../errors").codes,Qd=Kb.ERR_INVALID_ARG_TYPE,Sa=Kb.ERR_METHOD_NOT_IMPLEMENTED,Ya=Kb.ERR_MULTIPLE_CALLBACK,uc=Kb.ERR_STREAM_CANNOT_PIPE,Zb=Kb.ERR_STREAM_DESTROYED,pd=Kb.ERR_STREAM_NULL_VALUES,Rb=Kb.ERR_STREAM_WRITE_AFTER_END,Me=Kb.ERR_UNKNOWN_ENCODING,L=Ca.errorOrDestroy;F("inherits")(O,ta);T.prototype.getBuffer=function(){for(var M=this.bufferedRequest,Q=[];M;)Q.push(M),
M=M.next;return Q};(function(){try{Object.defineProperty(T.prototype,"buffer",{get:la.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(M){}})();"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(pa=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(M){return!!pa.call(this,M)||this===O&&M&&M._writableState instanceof
T}})):pa=function(M){return M instanceof this};O.prototype.pipe=function(){L(this,new uc)};O.prototype.write=function(M,Q,ca){var oa=this._writableState,Ba=!1,ya;if(ya=!oa.objectMode)ya=M,ya=wa.isBuffer(ya)||ya instanceof za;ya&&!wa.isBuffer(M)&&(M=wa.from(M));"function"==typeof Q&&(ca=Q,Q=null);ya?Q="buffer":!Q&&(Q=oa.defaultEncoding);"function"!=typeof ca&&(ca=N);if(oa.ending)oa=ca,ca=new Rb,L(this,ca),I.nextTick(oa,ca);else{var aa;if(!(aa=ya)){var Y=M,xa=ca,Oa;aa=(null===Y?Oa=new pd:"string"!=
typeof Y&&!oa.objectMode&&(Oa=new Qd("chunk",["string","Buffer"],Y)),!Oa||(L(this,Oa),I.nextTick(xa,Oa),!1))}aa&&(oa.pendingcb++,Ba=ya,Ba||(ya=M,Oa=(oa.objectMode||!1===oa.decodeStrings||"string"!=typeof ya||(ya=wa.from(ya,Q)),ya),M!==Oa&&(Ba=!0,Q="buffer",M=Oa)),ya=oa.objectMode?1:M.length,oa.length+=ya,Oa=oa.length<oa.highWaterMark,(Oa||(oa.needDrain=!0),oa.writing||oa.corked)?(ya=oa.lastBufferedRequest,oa.lastBufferedRequest={chunk:M,encoding:Q,isBuf:Ba,callback:ca,next:null},ya?ya.next=oa.lastBufferedRequest:
oa.bufferedRequest=oa.lastBufferedRequest,oa.bufferedRequestCount+=1):W(this,oa,!1,ya,M,Q,ca),Ba=Oa)}return Ba};O.prototype.cork=function(){this._writableState.corked++};O.prototype.uncork=function(){var M=this._writableState;M.corked&&(M.corked--,!M.writing&&!M.corked&&!M.bufferProcessing&&M.bufferedRequest&&R(this,M))};O.prototype.setDefaultEncoding=function(M){if("string"==typeof M&&(M=M.toLowerCase()),!(-1<"hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw".split(" ").indexOf((M+
"").toLowerCase())))throw new Me(M);return this._writableState.defaultEncoding=M,this};Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});O.prototype._write=function(M,Q,ca){ca(new Sa("_write()"))};O.prototype._writev=null;O.prototype.end=function(M,Q,ca){var oa=this._writableState;
"function"==typeof M?(ca=M,M=null,Q=null):"function"==typeof Q&&(ca=Q,Q=null);null!=M&&this.write(M,Q);oa.corked&&(oa.corked=1,this.uncork());oa.ending||(M=ca,oa.ending=!0,ma(this,oa),M&&(oa.finished?I.nextTick(M):this.once("finish",M)),oa.ended=!0,this.writable=!1);return this};Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&
this._writableState.destroyed},set:function(M){this._writableState&&(this._writableState.destroyed=M)}});O.prototype.destroy=Ca.destroy;O.prototype._undestroy=Ca.undestroy;O.prototype._destroy=function(M,Q){Q(M)}}).call(this)}).call(this,F("_process"),void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,
"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(F,K){(function(I){(function(){function J(ta,wa,za){return wa in ta?Object.defineProperty(ta,wa,{value:za,enumerable:!0,configurable:!0,writable:!0}):ta[wa]=za,ta}function H(ta,wa){return{value:ta,done:wa}}function N(ta){var wa=ta[ba];if(null!==wa){var za=ta[ka].read();null!==za&&(ta[ha]=null,ta[ba]=null,ta[fa]=null,wa(H(za,!1)))}}function T(ta){I.nextTick(N,ta)}var O,W=F("./end-of-stream"),ba=Symbol("lastResolve"),
fa=Symbol("lastReject"),R=Symbol("error"),da=Symbol("ended"),ha=Symbol("lastPromise"),ma=Symbol("handlePromise"),ka=Symbol("stream"),pa=Object.getPrototypeOf(function(){}),la=Object.setPrototypeOf((O={get stream(){return this[ka]},next:function(){var ta=this,wa=this[R];if(null!==wa)return Promise.reject(wa);if(this[da])return Promise.resolve(H(void 0,!0));if(this[ka].destroyed)return new Promise(function(za,Ca){I.nextTick(function(){ta[R]?Ca(ta[R]):za(H(void 0,!0))})});if(wa=this[ha])wa=new Promise(function(za,
Ca){return function(Vb,Kb){za.then(function(){return Ca[da]?void Vb(H(void 0,!0)):void Ca[ma](Vb,Kb)},Kb)}}(wa,this));else{wa=this[ka].read();if(null!==wa)return Promise.resolve(H(wa,!1));wa=new Promise(this[ma])}return this[ha]=wa,wa}},J(O,Symbol.asyncIterator,function(){return this}),J(O,"return",function(){var ta=this;return new Promise(function(wa,za){ta[ka].destroy(null,function(Ca){return Ca?void za(Ca):void wa(H(void 0,!0))})})}),O),pa);K.exports=function(ta){var wa,za=Object.create(la,(J(wa=
{},ka,{value:ta,writable:!0}),J(wa,ba,{value:null,writable:!0}),J(wa,fa,{value:null,writable:!0}),J(wa,R,{value:null,writable:!0}),J(wa,da,{value:ta._readableState.endEmitted,writable:!0}),J(wa,ma,{value:function(Ca,Vb){var Kb=za[ka].read();Kb?(za[ha]=null,za[ba]=null,za[fa]=null,Ca(H(Kb,!1))):(za[ba]=Ca,za[fa]=Vb)},writable:!0}),wa));return za[ha]=null,W(ta,function(Ca){if(Ca&&"ERR_STREAM_PREMATURE_CLOSE"!==Ca.code){var Vb=za[fa];return null!==Vb&&(za[ha]=null,za[ba]=null,za[fa]=null,Vb(Ca)),void(za[R]=
Ca)}Ca=za[ba];null!==Ca&&(za[ha]=null,za[ba]=null,za[fa]=null,Ca(H(void 0,!0)));za[da]=!0}),ta.on("readable",T.bind(null,za)),za}}).call(this)}).call(this,F("_process"))},{"./end-of-stream":24,_process:12}],22:[function(F,K){function I(O,W){var ba=Object.keys(O);if(Object.getOwnPropertySymbols){var fa=Object.getOwnPropertySymbols(O);W&&(fa=fa.filter(function(R){return Object.getOwnPropertyDescriptor(O,R).enumerable}));ba.push.apply(ba,fa)}return ba}function J(O,W){for(var ba,fa=0;fa<W.length;fa++)(ba=
W[fa]).enumerable=ba.enumerable||!1,ba.configurable=!0,"value"in ba&&(ba.writable=!0),Object.defineProperty(O,ba.key,ba)}var H=F("buffer").Buffer,N=F("util").inspect,T=N&&N.custom||"inspect";K.exports=function(){function O(){if(!(this instanceof O))throw new TypeError("Cannot call a class as a function");this.tail=this.head=null;this.length=0}return function(W,ba,fa){ba&&J(W.prototype,ba);fa&&J(W,fa)}(O,[{key:"push",value:function(W){W={data:W,next:null};0<this.length?this.tail.next=W:this.head=W;
this.tail=W;++this.length}},{key:"unshift",value:function(W){W={data:W,next:this.head};0===this.length&&(this.tail=W);this.head=W;++this.length}},{key:"shift",value:function(){if(0!==this.length){var W=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,W}}},{key:"clear",value:function(){this.head=this.tail=null;this.length=0}},{key:"join",value:function(W){if(0===this.length)return"";for(var ba=this.head,fa=""+ba.data;ba=ba.next;)fa+=W+ba.data;return fa}},
{key:"concat",value:function(W){if(0===this.length)return H.alloc(0);W=H.allocUnsafe(W>>>0);for(var ba=this.head,fa=0;ba;)H.prototype.copy.call(ba.data,W,fa),fa+=ba.data.length,ba=ba.next;return W}},{key:"consume",value:function(W,ba){var fa;return W<this.head.data.length?(fa=this.head.data.slice(0,W),this.head.data=this.head.data.slice(W)):fa=W===this.head.data.length?this.shift():ba?this._getString(W):this._getBuffer(W),fa}},{key:"first",value:function(){return this.head.data}},{key:"_getString",
value:function(W){var ba=this.head,fa=1,R=ba.data;for(W-=R.length;ba=ba.next;){var da=ba.data,ha=W>da.length?da.length:W;if(R+=ha===da.length?da:da.slice(0,W),0==(W-=ha)){ha===da.length?(++fa,this.head=ba.next?ba.next:this.tail=null):(this.head=ba,ba.data=da.slice(ha));break}++fa}return this.length-=fa,R}},{key:"_getBuffer",value:function(W){var ba=H.allocUnsafe(W),fa=this.head,R=1;fa.data.copy(ba);for(W-=fa.data.length;fa=fa.next;){var da=fa.data,ha=W>da.length?da.length:W;if(da.copy(ba,ba.length-
W,0,ha),0==(W-=ha)){ha===da.length?(++R,this.head=fa.next?fa.next:this.tail=null):(this.head=fa,fa.data=da.slice(ha));break}++R}return this.length-=R,ba}},{key:T,value:function(W,ba){return N(this,function(fa){for(var R,da=1;da<arguments.length;da++)R=null==arguments[da]?{}:arguments[da],da%2?I(Object(R),!0).forEach(function(ha){var ma=R[ha];ha in fa?Object.defineProperty(fa,ha,{value:ma,enumerable:!0,configurable:!0,writable:!0}):fa[ha]=ma}):Object.getOwnPropertyDescriptors?Object.defineProperties(fa,
Object.getOwnPropertyDescriptors(R)):I(Object(R)).forEach(function(ha){Object.defineProperty(fa,ha,Object.getOwnPropertyDescriptor(R,ha))});return fa}({},ba,{depth:0,customInspect:!1}))}}]),O}()},{buffer:3,util:2}],23:[function(F,K){(function(I){(function(){function J(T,O){N(T,O);H(T)}function H(T){T._writableState&&!T._writableState.emitClose||T._readableState&&!T._readableState.emitClose||T.emit("close")}function N(T,O){T.emit("error",O)}K.exports={destroy:function(T,O){var W=this,ba=this._writableState&&
this._writableState.destroyed;return this._readableState&&this._readableState.destroyed||ba?(O?O(T):T&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,I.nextTick(N,this,T)):I.nextTick(N,this,T)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(T||null,function(fa){!O&&fa?W._writableState?W._writableState.errorEmitted?I.nextTick(H,W):(W._writableState.errorEmitted=!0,I.nextTick(J,
W,fa)):I.nextTick(J,W,fa):O?(I.nextTick(H,W),O(fa)):I.nextTick(H,W)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1);this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},
errorOrDestroy:function(T,O){var W=T._readableState,ba=T._writableState;W&&W.autoDestroy||ba&&ba.autoDestroy?T.destroy(O):T.emit("error",O)}}}).call(this)}).call(this,F("_process"))},{_process:12}],24:[function(F,K){function I(){}var J=F("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;K.exports=function W(N,T,O){if("function"==typeof T)return W(N,null,T);T||={};O=function(wa){var za=!1;return function(){if(!za){za=!0;for(var Ca=arguments.length,Vb=Array(Ca),Kb=0;Kb<Ca;Kb++)Vb[Kb]=arguments[Kb];
wa.apply(this,Vb)}}}(O||I);var ba=T.readable||!1!==T.readable&&N.readable,fa=T.writable||!1!==T.writable&&N.writable,R=function(){N.writable||ha()},da=N._writableState&&N._writableState.finished,ha=function(){fa=!1;da=!0;ba||O.call(N)},ma=N._readableState&&N._readableState.endEmitted,ka=function(){ba=!1;ma=!0;fa||O.call(N)},pa=function(wa){O.call(N,wa)},la=function(){var wa;return ba&&!ma?(N._readableState&&N._readableState.ended||(wa=new J),O.call(N,wa)):fa&&!da?(N._writableState&&N._writableState.ended||
(wa=new J),O.call(N,wa)):void 0},ta=function(){N.req.on("finish",ha)};return N.setHeader&&"function"==typeof N.abort?(N.on("complete",ha),N.on("abort",la),N.req?ta():N.on("request",ta)):fa&&!N._writableState&&(N.on("end",R),N.on("close",R)),N.on("end",ka),N.on("finish",ha),!1!==T.error&&N.on("error",pa),N.on("close",la),function(){N.removeListener("complete",ha);N.removeListener("abort",la);N.removeListener("request",ta);N.req&&N.req.removeListener("finish",ha);N.removeListener("end",R);N.removeListener("close",
R);N.removeListener("finish",ha);N.removeListener("end",ka);N.removeListener("error",pa);N.removeListener("close",la)}}},{"../../../errors":15}],25:[function(F,K){K.exports=function(){throw Error("Readable.from is not available in the browser");}},{}],26:[function(F,K){function I(fa){if(fa)throw fa;}function J(fa,R,da,ha){ha=function(pa){var la=!1;return function(){la||(la=!0,pa.apply(void 0,arguments))}}(ha);var ma=!1;fa.on("close",function(){ma=!0});void 0===T&&(T=F("./end-of-stream"));T(fa,{readable:R,
writable:da},function(pa){return pa?ha(pa):(ma=!0,void ha())});var ka=!1;return function(pa){if(!ma)return ka?void 0:(ka=!0,fa.setHeader&&"function"==typeof fa.abort?fa.abort():"function"==typeof fa.destroy?fa.destroy():void ha(pa||new ba("pipe")))}}function H(fa){fa()}function N(fa,R){return fa.pipe(R)}var T,O=F("../../../errors").codes,W=O.ERR_MISSING_ARGS,ba=O.ERR_STREAM_DESTROYED;K.exports=function(){for(var fa=arguments.length,R=Array(fa),da=0;da<fa;da++)R[da]=arguments[da];var ha=R.length&&
"function"==typeof R[R.length-1]?R.pop():I;if(Array.isArray(R[0])&&(R=R[0]),2>R.length)throw new W("streams");var ma,ka=R.map(function(pa,la){var ta=la<R.length-1;return J(pa,ta,0<la,function(wa){ma||=wa;wa&&ka.forEach(H);ta||(ka.forEach(H),ha(ma))})});return R.reduce(N)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(F,K){var I=F("../../../errors").codes.ERR_INVALID_OPT_VALUE;K.exports={getHighWaterMark:function(J,H,N,T){H=null==H.highWaterMark?T?H[N]:null:H.highWaterMark;if(null!=H){if(!isFinite(H)||
q(H)!==H||0>H)throw new I(T?N:"highWaterMark",H);return q(H)}return J.objectMode?16:16384}}},{"../../../errors":15}],28:[function(F,K){K.exports=F("events").EventEmitter},{events:7}],29:[function(F,K,I){(I=K.exports=F("./lib/_stream_readable.js")).Stream=I;I.Readable=I;I.Writable=F("./lib/_stream_writable.js");I.Duplex=F("./lib/_stream_duplex.js");I.Transform=F("./lib/_stream_transform.js");I.PassThrough=F("./lib/_stream_passthrough.js");I.finished=F("./lib/internal/streams/end-of-stream.js");I.pipeline=
F("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(F,K,I){function J(O,W){for(var ba in O)W[ba]=O[ba]}function H(O,W,ba){return T(O,W,ba)}var N=F("buffer"),T=N.Buffer;T.from&&T.alloc&&T.allocUnsafe&&T.allocUnsafeSlow?K.exports=N:(J(N,I),I.Buffer=H);H.prototype=
Object.create(T.prototype);J(T,H);H.from=function(O,W,ba){if("number"==typeof O)throw new TypeError("Argument must not be a number");return T(O,W,ba)};H.alloc=function(O,W,ba){if("number"!=typeof O)throw new TypeError("Argument must be a number");O=T(O);return void 0===W?O.fill(0):"string"==typeof ba?O.fill(W,ba):O.fill(W),O};H.allocUnsafe=function(O){if("number"!=typeof O)throw new TypeError("Argument must be a number");return T(O)};H.allocUnsafeSlow=function(O){if("number"!=typeof O)throw new TypeError("Argument must be a number");
return N.SlowBuffer(O)}},{buffer:3}],31:[function(F,K,I){function J(ma){switch(this.encoding=function(ka){var pa=function(la){if(!la)return"utf8";for(var ta;;)switch(la){case "utf8":case "utf-8":return"utf8";case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return"utf16le";case "latin1":case "binary":return"latin1";case "base64":case "ascii":case "hex":return la;default:if(ta)return;la=(""+la).toLowerCase();ta=!0}}(ka);if("string"!=typeof pa&&(da.isEncoding===ha||!ha(ka)))throw Error("Unknown encoding: "+
ka);return pa||ka}(ma),this.encoding){case "utf16le":this.text=T;this.end=O;ma=4;break;case "utf8":this.fillLast=N;ma=4;break;case "base64":this.text=W;this.end=ba;ma=3;break;default:return this.write=fa,void(this.end=R)}this.lastTotal=this.lastNeed=0;this.lastChar=da.allocUnsafe(ma)}function H(ma){return 127>=ma?0:6==ma>>5?2:14==ma>>4?3:30==ma>>3?4:2==ma>>6?-1:-2}function N(ma){var ka=this.lastTotal-this.lastNeed;a:if(128!=(192&ma[0]))var pa=(this.lastNeed=0,"\ufffd");else{if(1<this.lastNeed&&1<
ma.length){if(128!=(192&ma[1])){pa=(this.lastNeed=1,"\ufffd");break a}if(2<this.lastNeed&&2<ma.length&&128!=(192&ma[2])){pa=(this.lastNeed=2,"\ufffd");break a}}pa=void 0}return void 0===pa?this.lastNeed<=ma.length?(ma.copy(this.lastChar,ka,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(ma.copy(this.lastChar,ka,0,ma.length),void(this.lastNeed-=ma.length)):pa}function T(ma,ka){if(0==(ma.length-ka)%2){if(ka=ma.toString("utf16le",ka)){var pa=ka.charCodeAt(ka.length-1);if(55296<=
pa&&56319>=pa)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=ma[ma.length-2],this.lastChar[1]=ma[ma.length-1],ka.slice(0,-1)}return ka}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=ma[ma.length-1],ma.toString("utf16le",ka,ma.length-1)}function O(ma){ma=ma&&ma.length?this.write(ma):"";return this.lastNeed?ma+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):ma}function W(ma,ka){var pa=(ma.length-ka)%3;return 0==pa?ma.toString("base64",ka):(this.lastNeed=3-pa,this.lastTotal=
3,1==pa?this.lastChar[0]=ma[ma.length-1]:(this.lastChar[0]=ma[ma.length-2],this.lastChar[1]=ma[ma.length-1]),ma.toString("base64",ka,ma.length-pa))}function ba(ma){ma=ma&&ma.length?this.write(ma):"";return this.lastNeed?ma+this.lastChar.toString("base64",0,3-this.lastNeed):ma}function fa(ma){return ma.toString(this.encoding)}function R(ma){return ma&&ma.length?this.write(ma):""}var da=F("safe-buffer").Buffer,ha=da.isEncoding||function(ma){switch((ma=""+ma)&&ma.toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":case "raw":return!0;
default:return!1}};I.StringDecoder=J;J.prototype.write=function(ma){if(0===ma.length)return"";var ka;if(this.lastNeed){if(void 0===(ka=this.fillLast(ma)))return"";var pa=this.lastNeed;this.lastNeed=0}else pa=0;return pa<ma.length?ka?ka+this.text(ma,pa):this.text(ma,pa):ka||""};J.prototype.end=function(ma){ma=ma&&ma.length?this.write(ma):"";return this.lastNeed?ma+"\ufffd":ma};J.prototype.text=function(ma,ka){var pa=ma.length-1;if(pa<ka)var la=0;else{var ta=H(ma[pa]);la=0<=ta?(0<ta&&(this.lastNeed=
ta-1),ta):--pa<ka||-2===ta?0:0<=(ta=H(ma[pa]))?(0<ta&&(this.lastNeed=ta-2),ta):--pa<ka||-2===ta?0:0<=(ta=H(ma[pa]))?(0<ta&&(2===ta?ta=0:this.lastNeed=ta-3),ta):0}if(!this.lastNeed)return ma.toString("utf8",ka);this.lastTotal=la;la=ma.length-(la-this.lastNeed);return ma.copy(this.lastChar,0,la),ma.toString("utf8",ka,la)};J.prototype.fillLast=function(ma){return this.lastNeed<=ma.length?(ma.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):
(ma.copy(this.lastChar,this.lastTotal-this.lastNeed,0,ma.length),void(this.lastNeed-=ma.length))}},{"safe-buffer":30}],32:[function(F,K){(function(I){(function(){function J(H){try{if(!I.localStorage)return!1}catch(N){return!1}H=I.localStorage[H];return null!=H&&"true"===(H+"").toLowerCase()}K.exports=function(H,N){if(J("noDeprecation"))return H;var T=!1;return function(){if(!T){if(J("throwDeprecation"))throw Error(N);J("traceDeprecation")?console.trace(N):console.warn(N);T=!0}return H.apply(this,
arguments)}}}).call(this)}).call(this,void 0===commonjsGlobal$$module$libs$y_webrtc_min?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:commonjsGlobal$$module$libs$y_webrtc_min)},{}],"/":[function(F,K){function I(R){return R.replace(/a=ice-options:trickle\s\n/g,"")}const J=F("debug")("simple-peer"),H=F("get-browser-rtc"),N=F("randombytes"),T=F("readable-stream"),O=F("queue-microtask"),W=F("err-code"),{Buffer:ba}=F("buffer");class fa extends T.Duplex{constructor(R){if(super(R=Object.assign({allowHalfOpen:!1},
R)),this._id=N(4).toString("hex").slice(0,7),this._debug("new peer %o",R),this.channelName=R.initiator?R.channelName||N(20).toString("hex"):null,this.initiator=R.initiator||!1,this.channelConfig=R.channelConfig||fa.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},fa.config,R.config),this.offerOptions=R.offerOptions||{},this.answerOptions=R.answerOptions||{},this.sdpTransform=R.sdpTransform||(da=>da),this.streams=R.streams||(R.stream?[R.stream]:[]),this.trickle=
void 0===R.trickle||R.trickle,this.allowHalfTrickle=void 0!==R.allowHalfTrickle&&R.allowHalfTrickle,this.iceCompleteTimeout=R.iceCompleteTimeout||5E3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=R.wrtc&&"object"==typeof R.wrtc?R.wrtc:H(),!this._wrtc)throw"undefined"==typeof window?W(Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),
"ERR_WEBRTC_SUPPORT"):W(Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._iceComplete=this._channelReady=this._pcReady=!1;this._channel=this._iceCompleteTimer=null;this._pendingCandidates=[];this._isNegotiating=!1;this._firstNegotiation=!0;this._queuedNegotiation=this._batchedNegotiation=!1;this._sendersAwaitingStable=[];this._senderMap=new Map;this._closingInterval=null;this._remoteTracks=[];this._remoteStreams=[];this._interval=this._cb=this._chunk=null;try{this._pc=
new this._wrtc.RTCPeerConnection(this.config)}catch(da){return void this.destroy(W(da,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId;this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()};this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()};this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()};this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()};this._pc.onicecandidate=da=>{this._onIceCandidate(da)};
"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch(da=>{this.destroy(W(da,"ERR_PC_PEER_IDENTITY"))});this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=da=>{this._setupData(da)};this.streams&&this.streams.forEach(da=>{this.addStream(da)});this._pc.ontrack=da=>{this._onTrack(da)};this._debug("initial negotiation");this._needsNegotiation();this._onFinishBound=()=>{this._onFinish()};
this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof R)try{R=JSON.parse(R)}catch(da){R={}}this._debug("signal()");R.renegotiate&&this.initiator&&
(this._debug("got request to renegotiate"),this._needsNegotiation());R.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(R.transceiverRequest.kind,R.transceiverRequest.init));R.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(R.candidate):this._pendingCandidates.push(R.candidate));R.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(R)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(da=>
{this._addIceCandidate(da)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(da=>{this.destroy(W(da,"ERR_SET_REMOTE_DESCRIPTION"))});R.sdp||R.candidate||R.renegotiate||R.transceiverRequest||this.destroy(W(Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(R){const da=new this._wrtc.RTCIceCandidate(R);this._pc.addIceCandidate(da).catch(ha=>{!da.address||da.address.endsWith(".local")?console.warn("Ignoring unsupported ICE candidate."):
this.destroy(W(ha,"ERR_ADD_ICE_CANDIDATE"))})}send(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(R)}}addTransceiver(R,da){if(!this.destroying){if(this.destroyed)throw W(Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(R,da),this._needsNegotiation()}catch(ha){this.destroy(W(ha,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",
{type:"transceiverRequest",transceiverRequest:{kind:R,init:da}})}}addStream(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()");R.getTracks().forEach(da=>{this.addTrack(da,R)})}}addTrack(R,da){if(!this.destroying){if(this.destroyed)throw W(Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");var ha=this._senderMap.get(R)||new Map,ma=ha.get(da);if(ma)throw ma.removed?W(Error("Track has been removed. You should enable/disable tracks that you want to re-add."),
"ERR_SENDER_REMOVED"):W(Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");ma=this._pc.addTrack(R,da);ha.set(da,ma);this._senderMap.set(R,ha);this._needsNegotiation()}}replaceTrack(R,da,ha){if(!this.destroying){if(this.destroyed)throw W(Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");ha=(R=this._senderMap.get(R))?R.get(ha):null;if(!ha)throw W(Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");
da&&this._senderMap.set(da,R);null==ha.replaceTrack?this.destroy(W(Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):ha.replaceTrack(da)}}removeTrack(R,da){if(!this.destroying){if(this.destroyed)throw W(Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");da=(R=this._senderMap.get(R))?R.get(da):null;if(!da)throw W(Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{da.removed=!0,this._pc.removeTrack(da)}catch(ha){"NS_ERROR_UNEXPECTED"===
ha.name?this._sendersAwaitingStable.push(da):this.destroy(W(ha,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}}removeStream(R){if(!this.destroying){if(this.destroyed)throw W(Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()");R.getTracks().forEach(da=>{this.removeTrack(da,R)})}}_needsNegotiation(){this._debug("_needsNegotiation");this._batchedNegotiation||(this._batchedNegotiation=!0,O(()=>{this._batchedNegotiation=!1;this.initiator||!this._firstNegotiation?
(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded");this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw W(Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=
!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0}));this._isNegotiating=!0}}destroy(R){this._destroy(R,()=>{})}_destroy(R,da){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",R&&(R.message||R)),O(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",R&&(R.message||R)),this.readable=this.writable=!1,this._readableState.ended||
this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(ha){}this._channel.onmessage=
null;this._channel.onopen=null;this._channel.onclose=null;this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(ha){}this._pc.oniceconnectionstatechange=null;this._pc.onicegatheringstatechange=null;this._pc.onsignalingstatechange=null;this._pc.onicecandidate=null;this._pc.ontrack=null;this._pc.ondatachannel=null}this._channel=this._pc=null;R&&this.emit("error",R);this.emit("close");da()}))}_setupData(R){if(!R.channel)return this.destroy(W(Error("Data channel event is missing `channel` property"),
"ERR_DATA_CHANNEL"));this._channel=R.channel;this._channel.binaryType="arraybuffer";"number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=65536);this.channelName=this._channel.label;this._channel.onmessage=ha=>{this._onChannelMessage(ha)};this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()};this._channel.onopen=()=>{this._onChannelOpen()};this._channel.onclose=()=>{this._onChannelClose()};this._channel.onerror=ha=>{this.destroy(W(ha.error instanceof
Error?ha.error:Error(`Datachannel error: ${ha.message} ${ha.filename}:${ha.lineno}:${ha.colno}`),"ERR_DATA_CHANNEL"))};let da=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(da&&this._onChannelClose(),da=!0):da=!1},5E3)}_read(){}_write(R,da,ha){if(this.destroyed)return ha(W(Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(R)}catch(ma){return this.destroy(W(ma,"ERR_DATA_CHANNEL"))}65536<this._channel.bufferedAmount?
(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=ha):ha(null)}else this._debug("write before connect"),this._chunk=R,this._cb=ha}_onFinish(){if(!this.destroyed){const R=()=>{setTimeout(()=>this.destroy(),1E3)};this._connected?R():this.once("connect",R)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),
this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(R=>{if(!this.destroyed){this.trickle||this.allowHalfTrickle||(R.sdp=I(R.sdp));R.sdp=this.sdpTransform(R.sdp);var da=()=>{if(!this.destroyed){const ha=this._pc.localDescription||R;this._debug("signal");this.emit("signal",{type:ha.type,sdp:ha.sdp})}};this._pc.setLocalDescription(R).then(()=>{this._debug("createOffer success");this.destroyed||(this.trickle||
this._iceComplete?da():this.once("_iceComplete",da))}).catch(ha=>{this.destroy(W(ha,"ERR_SET_LOCAL_DESCRIPTION"))})}}).catch(R=>{this.destroy(W(R,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(R=>{R.mid||!R.sender.track||R.requested||(R.requested=!0,this.addTransceiver(R.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(R=>{if(!this.destroyed){this.trickle||this.allowHalfTrickle||
(R.sdp=I(R.sdp));R.sdp=this.sdpTransform(R.sdp);var da=()=>{if(!this.destroyed){const ha=this._pc.localDescription||R;this._debug("signal");this.emit("signal",{type:ha.type,sdp:ha.sdp});this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(R).then(()=>{this.destroyed||(this.trickle||this._iceComplete?da():this.once("_iceComplete",da))}).catch(ha=>{this.destroy(W(ha,"ERR_SET_LOCAL_DESCRIPTION"))})}}).catch(R=>{this.destroy(W(R,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||
"failed"===this._pc.connectionState&&this.destroy(W(Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var R=this._pc.iceConnectionState,da=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",R,da);this.emit("iceStateChange",R,da);"connected"!==R&&"completed"!==R||(this._pcReady=!0,this._maybeReady());"failed"===R&&this.destroy(W(Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE"));"closed"===R&&this.destroy(W(Error("Ice connection closed."),
"ERR_ICE_CONNECTION_CLOSED"))}}getStats(R){const da=ha=>("[object Array]"===Object.prototype.toString.call(ha.values)&&ha.values.forEach(ma=>{Object.assign(ha,ma)}),ha);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(ha=>{const ma=[];ha.forEach(ka=>{ma.push(da(ka))});R(null,ma)},ha=>R(ha)):0<this._pc.getStats.length?this._pc.getStats(ha=>{if(!this.destroyed){var ma=[];ha.result().forEach(ka=>{const pa={};ka.names().forEach(la=>{pa[la]=ka.stat(la)});pa.id=ka.id;pa.type=
ka.type;pa.timestamp=ka.timestamp;ma.push(da(pa))});R(null,ma)}},ha=>R(ha)):R(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),!this._connected&&!this._connecting&&this._pcReady&&this._channelReady){this._connecting=!0;var R=()=>{this.destroyed||this.getStats((da,ha)=>{if(!this.destroyed){da&&(ha=[]);var ma={},ka={},pa={},la=!1;ha.forEach(wa=>{"remotecandidate"!==wa.type&&"remote-candidate"!==wa.type||(ma[wa.id]=wa);"localcandidate"!==wa.type&&
"local-candidate"!==wa.type||(ka[wa.id]=wa);"candidatepair"!==wa.type&&"candidate-pair"!==wa.type||(pa[wa.id]=wa)});var ta=wa=>{la=!0;var za=ka[wa.localCandidateId];za&&(za.ip||za.address)?(this.localAddress=za.ip||za.address,this.localPort=+za.port):za&&za.ipAddress?(this.localAddress=za.ipAddress,this.localPort=+za.portNumber):"string"==typeof wa.googLocalAddress&&(za=wa.googLocalAddress.split(":"),this.localAddress=za[0],this.localPort=+za[1]);this.localAddress&&(this.localFamily=this.localAddress.includes(":")?
"IPv6":"IPv4");(za=ma[wa.remoteCandidateId])&&(za.ip||za.address)?(this.remoteAddress=za.ip||za.address,this.remotePort=+za.port):za&&za.ipAddress?(this.remoteAddress=za.ipAddress,this.remotePort=+za.portNumber):"string"==typeof wa.googRemoteAddress&&(za=wa.googRemoteAddress.split(":"),this.remoteAddress=za[0],this.remotePort=+za[1]);this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4");this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,
this.remoteAddress,this.remotePort)};if(ha.forEach(wa=>{"transport"===wa.type&&wa.selectedCandidatePairId&&ta(pa[wa.selectedCandidatePairId]);("googCandidatePair"===wa.type&&"true"===wa.googActiveConnection||("candidatepair"===wa.type||"candidate-pair"===wa.type)&&wa.selected)&&ta(wa)}),la||Object.keys(pa).length&&!Object.keys(ka).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(wa){return this.destroy(W(wa,"ERR_DATA_CHANNEL"))}this._chunk=null;this._debug('sent chunk from "write before connect"');
da=this._cb;this._cb=null;da(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref());this._debug("connect");this.emit("connect")}else setTimeout(R,100)}})};R()}}_onInterval(){this._cb&&this._channel&&!(65536<this._channel.bufferedAmount)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",
this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(R=>{this._pc.removeTrack(R);this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(R){this.destroyed||(R.candidate&&this.trickle?
this.emit("signal",{type:"candidate",candidate:{candidate:R.candidate.candidate,sdpMLineIndex:R.candidate.sdpMLineIndex,sdpMid:R.candidate.sdpMid}}):!R.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),R.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(R){this.destroyed||(R=R.data,R instanceof ArrayBuffer&&(R=ba.from(R)),this.push(R))}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);
const R=this._cb;this._cb=null;R(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(R){this.destroyed||R.streams.forEach(da=>{this._debug("on track");this.emit("track",R.track,da);this._remoteTracks.push({track:R.track,stream:da});this._remoteStreams.some(ha=>ha.id===da.id)||(this._remoteStreams.push(da),O(()=>{this._debug("on stream");
this.emit("stream",da)}))})}_debug(){const R=[].slice.call(arguments);R[0]="["+this._id+"] "+R[0];J.apply(null,R)}}fa.WEBRTC_SUPPORT=!!H();fa.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};fa.channelConfig={};K.exports=fa},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/"))});
const writeSyncStep1$$module$libs$y_webrtc_min=(a,g)=>{writeVarUint$$module$libs$y_webrtc_min(a,0);g=encodeStateVector$$module$libs$y_webrtc_min(g);writeVarUint8Array$$module$libs$y_webrtc_min(a,g)},writeSyncStep2$$module$libs$y_webrtc_min=(a,g,q)=>{writeVarUint$$module$libs$y_webrtc_min(a,1);writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeStateAsUpdate$$module$libs$y_webrtc_min(g,q))},readSyncStep2$$module$libs$y_webrtc_min=(a,g,q)=>{try{applyUpdate$$module$libs$y_webrtc_min(g,readVarUint8Array$$module$libs$y_webrtc_min(a),
q)}catch(u){console.error("Caught error while handling a Yjs update",u)}},readUpdate$1$$module$libs$y_webrtc_min=readSyncStep2$$module$libs$y_webrtc_min,readSyncMessage$$module$libs$y_webrtc_min=(a,g,q,u)=>{const B=readVarUint$$module$libs$y_webrtc_min(a);switch(B){case 0:writeSyncStep2$$module$libs$y_webrtc_min(g,q,readVarUint8Array$$module$libs$y_webrtc_min(a));break;case 1:readSyncStep2$$module$libs$y_webrtc_min(a,q,u);break;case 2:readSyncStep2$$module$libs$y_webrtc_min(a,q,u);break;default:throw Error("Unknown message type");
}return B};
class Awareness$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a){super();this.doc=a;this.clientID=a.clientID;this.states=new Map;this.meta=new Map;this._checkInterval=setInterval(()=>{const g=getUnixTime$$module$libs$y_webrtc_min();null!==this.getLocalState()&&15E3<=g-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const q=[];this.meta.forEach((u,B)=>{B!==this.clientID&&3E4<=g-u.lastUpdated&&this.states.has(B)&&q.push(B)});0<
q.length&&removeAwarenessStates$$module$libs$y_webrtc_min(this,q,"timeout")},floor$$module$libs$y_webrtc_min(3E3));a.on("destroy",()=>{this.destroy()});this.setLocalState({})}destroy(){this.emit("destroy",[this]);this.setLocalState(null);super.destroy();clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(a){const g=this.clientID;var q=this.meta.get(g),u=void 0===q?0:q.clock+1;q=this.states.get(g);null===a?this.states.delete(g):this.states.set(g,
a);this.meta.set(g,{clock:u,lastUpdated:getUnixTime$$module$libs$y_webrtc_min()});u=[];const B=[],E=[],F=[];null===a?F.push(g):null==q?null!=a&&u.push(g):(B.push(g),equalityDeep$$module$libs$y_webrtc_min(q,a)||E.push(g));(0<u.length||0<E.length||0<F.length)&&this.emit("change",[{added:u,updated:E,removed:F},"local"]);this.emit("update",[{added:u,updated:B,removed:F},"local"])}setLocalStateField(a,g){const q=this.getLocalState();null!==q&&this.setLocalState({...q,[a]:g})}getStates(){return this.states}}
const removeAwarenessStates$$module$libs$y_webrtc_min=(a,g,q)=>{const u=[];for(let B=0;B<g.length;B++){const E=g[B];if(a.states.has(E)){if(a.states.delete(E),E===a.clientID){const F=a.meta.get(E);a.meta.set(E,{clock:F.clock+1,lastUpdated:getUnixTime$$module$libs$y_webrtc_min()})}u.push(E)}}0<u.length&&(a.emit("change",[{added:[],updated:[],removed:u},q]),a.emit("update",[{added:[],updated:[],removed:u},q]))},encodeAwarenessUpdate$$module$libs$y_webrtc_min=(a,g,q=a.states)=>{const u=g.length,B=createEncoder$$module$libs$y_webrtc_min();
writeVarUint$$module$libs$y_webrtc_min(B,u);for(let E=0;E<u;E++){const F=g[E],K=q.get(F)||null,I=a.meta.get(F).clock;writeVarUint$$module$libs$y_webrtc_min(B,F);writeVarUint$$module$libs$y_webrtc_min(B,I);writeVarString$$module$libs$y_webrtc_min(B,JSON.stringify(K))}return toUint8Array$$module$libs$y_webrtc_min(B)},encrypt$$module$libs$y_webrtc_min=(a,g)=>{if(!g)return resolve$$module$libs$y_webrtc_min(a);const q=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",
iv:q},g,a).then(u=>{const B=createEncoder$$module$libs$y_webrtc_min();return writeVarString$$module$libs$y_webrtc_min(B,"AES-GCM"),writeVarUint8Array$$module$libs$y_webrtc_min(B,q),writeVarUint8Array$$module$libs$y_webrtc_min(B,new Uint8Array(u)),toUint8Array$$module$libs$y_webrtc_min(B)})},decrypt$$module$libs$y_webrtc_min=(a,g)=>{if(!g)return resolve$$module$libs$y_webrtc_min(a);a=createDecoder$$module$libs$y_webrtc_min(a);var q;"AES-GCM"!==readVarString$$module$libs$y_webrtc_min(a)&&(q=create$2$$module$libs$y_webrtc_min("Unknown encryption algorithm"),
Promise.reject(q));q=readVarUint8Array$$module$libs$y_webrtc_min(a);a=readVarUint8Array$$module$libs$y_webrtc_min(a);return crypto.subtle.decrypt({name:"AES-GCM",iv:q},g,a).then(u=>new Uint8Array(u))},log$$module$libs$y_webrtc_min=((a,g)=>{const q=loggingColors$$module$libs$y_webrtc_min[nextColor$$module$libs$y_webrtc_min];var u=getVariable$$module$libs$y_webrtc_min("log");u=null!==u&&("*"===u||"true"===u||(new RegExp(u,"gi")).test(g));return nextColor$$module$libs$y_webrtc_min=(nextColor$$module$libs$y_webrtc_min+
1)%loggingColors$$module$libs$y_webrtc_min.length,g+=": ",u?(...B)=>{const E=getUnixTime$$module$libs$y_webrtc_min(),F=E-lastLoggingTime$$module$libs$y_webrtc_min;lastLoggingTime$$module$libs$y_webrtc_min=E;a(q,g,UNCOLOR$$module$libs$y_webrtc_min,...B.map(K=>"string"==typeof K||"symbol"==typeof K?K:JSON.stringify(K)),q," +"+F+"ms")}:nop$$module$libs$y_webrtc_min})(print$$module$libs$y_webrtc_min,"y-webrtc"),signalingConns$$module$libs$y_webrtc_min=new Map,rooms$$module$libs$y_webrtc_min=new Map,checkIsSynced$$module$libs$y_webrtc_min=
a=>{let g=!0;a.webrtcConns.forEach(q=>{q.synced||(g=!1)});(!g&&a.synced||g&&!a.synced)&&(a.synced=g,a.provider.emit("synced",[{synced:g}]),log$$module$libs$y_webrtc_min("synced ",BOLD$$module$libs$y_webrtc_min,a.name,UNBOLD$$module$libs$y_webrtc_min," with all peers"))},readMessage$$module$libs$y_webrtc_min=(a,g,q)=>{var u=createDecoder$$module$libs$y_webrtc_min(g);g=createEncoder$$module$libs$y_webrtc_min();var B=readVarUint$$module$libs$y_webrtc_min(u);if(void 0===a)return null;var E=a.awareness,
F=a.doc;let K=!1;switch(B){case 0:writeVarUint$$module$libs$y_webrtc_min(g,0);E=readSyncMessage$$module$libs$y_webrtc_min(u,g,F,a);1!==E||a.synced||q();0===E&&(K=!0);break;case 3:writeVarUint$$module$libs$y_webrtc_min(g,1);writeVarUint8Array$$module$libs$y_webrtc_min(g,encodeAwarenessUpdate$$module$libs$y_webrtc_min(E,Array.from(E.getStates().keys())));K=!0;break;case 1:q=readVarUint8Array$$module$libs$y_webrtc_min(u);q=createDecoder$$module$libs$y_webrtc_min(q);u=getUnixTime$$module$libs$y_webrtc_min();
B=[];F=[];const I=[],J=[],H=readVarUint$$module$libs$y_webrtc_min(q);for(let N=0;N<H;N++){const T=readVarUint$$module$libs$y_webrtc_min(q);let O=readVarUint$$module$libs$y_webrtc_min(q);const W=JSON.parse(readVarString$$module$libs$y_webrtc_min(q)),ba=E.meta.get(T),fa=E.states.get(T),R=void 0===ba?0:ba.clock;(R<O||R===O&&null===W&&E.states.has(T))&&(null===W?T===E.clientID&&null!=E.getLocalState()?O++:E.states.delete(T):E.states.set(T,W),E.meta.set(T,{clock:O,lastUpdated:u}),void 0===ba&&null!==W?
B.push(T):void 0!==ba&&null===W?J.push(T):null!==W&&(equalityDeep$$module$libs$y_webrtc_min(W,fa)||I.push(T),F.push(T)))}(0<B.length||0<I.length||0<J.length)&&E.emit("change",[{added:B,updated:I,removed:J},a]);(0<B.length||0<F.length||0<J.length)&&E.emit("update",[{added:B,updated:F,removed:J},a]);break;case 4:E=1===readUint8$$module$libs$y_webrtc_min(u);q=readVarString$$module$libs$y_webrtc_min(u);q!==a.peerId&&(a.bcConns.has(q)&&!E||!a.bcConns.has(q)&&E)&&(u=[],B=[],E?(a.bcConns.add(q),B.push(q)):
(a.bcConns.delete(q),u.push(q)),a.provider.emit("peers",[{added:B,removed:u,webrtcPeers:Array.from(a.webrtcConns.keys()),bcPeers:Array.from(a.bcConns)}]),broadcastBcPeerId$$module$libs$y_webrtc_min(a));break;default:return console.error("Unable to compute message"),g}return K?g:null},sendWebrtcConn$$module$libs$y_webrtc_min=(a,g)=>{log$$module$libs$y_webrtc_min("send message to ",BOLD$$module$libs$y_webrtc_min,a.remotePeerId,UNBOLD$$module$libs$y_webrtc_min,GREY$$module$libs$y_webrtc_min," (",a.room.name,
")",UNCOLOR$$module$libs$y_webrtc_min);try{a.peer.send(toUint8Array$$module$libs$y_webrtc_min(g))}catch(q){}};
class WebrtcConn$$module$libs$y_webrtc_min{constructor(a,g,q,u){log$$module$libs$y_webrtc_min("establishing connection to ",BOLD$$module$libs$y_webrtc_min,q);this.room=u;this.remotePeerId=q;this.synced=this.connected=this.closed=!1;this.peer=new simplepeer_min$$module$libs$y_webrtc_min({initiator:g,...u.provider.peerOpts});this.peer.on("signal",B=>{publishSignalingMessage$$module$libs$y_webrtc_min(a,u,{to:q,from:u.peerId,type:"signal",signal:B})});this.peer.on("connect",()=>{log$$module$libs$y_webrtc_min("connected to ",
BOLD$$module$libs$y_webrtc_min,q);this.connected=!0;var B=u.provider.doc;const E=u.awareness;var F=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(F,0);writeSyncStep1$$module$libs$y_webrtc_min(F,B);sendWebrtcConn$$module$libs$y_webrtc_min(this,F);B=E.getStates();0<B.size&&(F=createEncoder$$module$libs$y_webrtc_min(),writeVarUint$$module$libs$y_webrtc_min(F,1),writeVarUint8Array$$module$libs$y_webrtc_min(F,encodeAwarenessUpdate$$module$libs$y_webrtc_min(E,Array.from(B.keys()))),
sendWebrtcConn$$module$libs$y_webrtc_min(this,F))});this.peer.on("close",()=>{this.connected=!1;this.closed=!0;u.webrtcConns.has(this.remotePeerId)&&(u.webrtcConns.delete(this.remotePeerId),u.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(u.webrtcConns.keys()),bcPeers:Array.from(u.bcConns)}]));checkIsSynced$$module$libs$y_webrtc_min(u);this.peer.destroy();log$$module$libs$y_webrtc_min("closed connection to ",BOLD$$module$libs$y_webrtc_min,q);announceSignalingInfo$$module$libs$y_webrtc_min(u)});
this.peer.on("error",B=>{log$$module$libs$y_webrtc_min("Error in connection to ",BOLD$$module$libs$y_webrtc_min,q,": ",B);announceSignalingInfo$$module$libs$y_webrtc_min(u)});this.peer.on("data",B=>{B=((E,F)=>{const K=E.room;return log$$module$libs$y_webrtc_min("received message from ",BOLD$$module$libs$y_webrtc_min,E.remotePeerId,GREY$$module$libs$y_webrtc_min," (",K.name,")",UNBOLD$$module$libs$y_webrtc_min,UNCOLOR$$module$libs$y_webrtc_min),readMessage$$module$libs$y_webrtc_min(K,F,()=>{E.synced=
!0;log$$module$libs$y_webrtc_min("synced ",BOLD$$module$libs$y_webrtc_min,K.name,UNBOLD$$module$libs$y_webrtc_min," with ",BOLD$$module$libs$y_webrtc_min,E.remotePeerId);checkIsSynced$$module$libs$y_webrtc_min(K)})})(this,B);null!==B&&sendWebrtcConn$$module$libs$y_webrtc_min(this,B)})}destroy(){this.peer.destroy()}}
const broadcastBcMessage$$module$libs$y_webrtc_min=(a,g)=>encrypt$$module$libs$y_webrtc_min(g,a.key).then(q=>a.mux(()=>((u,B,E=null)=>{u=getChannel$$module$libs$y_webrtc_min(u);u.bc.postMessage(B);u.subs.forEach(F=>F(B,E))})(a.name,q))),broadcastRoomMessage$$module$libs$y_webrtc_min=(a,g)=>{a.bcconnected&&broadcastBcMessage$$module$libs$y_webrtc_min(a,g);((q,u)=>{log$$module$libs$y_webrtc_min("broadcast message in ",BOLD$$module$libs$y_webrtc_min,q.name,UNBOLD$$module$libs$y_webrtc_min);q.webrtcConns.forEach(B=>
{try{B.peer.send(u)}catch(E){}})})(a,g)},announceSignalingInfo$$module$libs$y_webrtc_min=a=>{signalingConns$$module$libs$y_webrtc_min.forEach(g=>{g.connected&&(g.send({type:"subscribe",topics:[a.name]}),a.webrtcConns.size<a.provider.maxConns&&publishSignalingMessage$$module$libs$y_webrtc_min(g,a,{type:"announce",from:a.peerId}))})},broadcastBcPeerId$$module$libs$y_webrtc_min=a=>{if(a.provider.filterBcConns){const g=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(g,
4);write$$module$libs$y_webrtc_min(g,1);writeVarString$$module$libs$y_webrtc_min(g,a.peerId);broadcastBcMessage$$module$libs$y_webrtc_min(a,toUint8Array$$module$libs$y_webrtc_min(g))}};
class Room$$module$libs$y_webrtc_min{constructor(a,g,q,u){this.peerId=uuidv4$$module$libs$y_webrtc_min();this.doc=a;this.awareness=g.awareness;this.provider=g;this.synced=!1;this.name=q;this.key=u;this.webrtcConns=new Map;this.bcConns=new Set;this.mux=(()=>{let B=!0;return(E,F)=>{if(B){B=!1;try{E()}finally{B=!0}}else void 0!==F&&F()}})();this.bcconnected=!1;this._bcSubscriber=B=>decrypt$$module$libs$y_webrtc_min(new Uint8Array(B),u).then(E=>this.mux(()=>{const F=readMessage$$module$libs$y_webrtc_min(this,
E,()=>{});F&&broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(F))}));this._docUpdateHandler=(B,E)=>{E=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(E,0);writeVarUint$$module$libs$y_webrtc_min(E,2);writeVarUint8Array$$module$libs$y_webrtc_min(E,B);broadcastRoomMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(E))};this._awarenessUpdateHandler=({added:B,updated:E,removed:F},K)=>{B=B.concat(E).concat(F);
E=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(E,1);writeVarUint8Array$$module$libs$y_webrtc_min(E,encodeAwarenessUpdate$$module$libs$y_webrtc_min(this.awareness,B));broadcastRoomMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(E))};this._beforeUnloadHandler=()=>{removeAwarenessStates$$module$libs$y_webrtc_min(this.awareness,[a.clientID],"window unload");rooms$$module$libs$y_webrtc_min.forEach(B=>{B.disconnect()})};"undefined"!=typeof window?
window.addEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!=typeof process&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler);this.awareness.on("update",this._awarenessUpdateHandler);announceSignalingInfo$$module$libs$y_webrtc_min(this);var a=this.name;var g=this._bcSubscriber;getChannel$$module$libs$y_webrtc_min(a).subs.add(g);this.bcconnected=!0;broadcastBcPeerId$$module$libs$y_webrtc_min(this);a=createEncoder$$module$libs$y_webrtc_min();
writeVarUint$$module$libs$y_webrtc_min(a,0);writeSyncStep1$$module$libs$y_webrtc_min(a,this.doc);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,0);writeSyncStep2$$module$libs$y_webrtc_min(a,this.doc);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,
3);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,1);writeVarUint8Array$$module$libs$y_webrtc_min(a,encodeAwarenessUpdate$$module$libs$y_webrtc_min(this.awareness,[this.doc.clientID]));broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a))}disconnect(){signalingConns$$module$libs$y_webrtc_min.forEach(g=>{g.connected&&g.send({type:"unsubscribe",
topics:[this.name]})});removeAwarenessStates$$module$libs$y_webrtc_min(this.awareness,[this.doc.clientID],"disconnect");const a=createEncoder$$module$libs$y_webrtc_min();writeVarUint$$module$libs$y_webrtc_min(a,4);write$$module$libs$y_webrtc_min(a,0);writeVarString$$module$libs$y_webrtc_min(a,this.peerId);broadcastBcMessage$$module$libs$y_webrtc_min(this,toUint8Array$$module$libs$y_webrtc_min(a));((g,q)=>{const u=getChannel$$module$libs$y_webrtc_min(g);u.subs.delete(q)&&0===u.subs.size&&(u.bc.close(),
channels$$module$libs$y_webrtc_min.delete(g))})(this.name,this._bcSubscriber);this.bcconnected=!1;this.doc.off("update",this._docUpdateHandler);this.awareness.off("update",this._awarenessUpdateHandler);this.webrtcConns.forEach(g=>g.destroy())}destroy(){this.disconnect();"undefined"!=typeof window?window.removeEventListener("beforeunload",this._beforeUnloadHandler):"undefined"!=typeof process&&process.off("exit",this._beforeUnloadHandler)}}
const publishSignalingMessage$$module$libs$y_webrtc_min=(a,g,q)=>{g.key?((u,B)=>{const E=createEncoder$$module$libs$y_webrtc_min();return writeAny$$module$libs$y_webrtc_min(E,u),encrypt$$module$libs$y_webrtc_min(toUint8Array$$module$libs$y_webrtc_min(E),B)})(q,g.key).then(u=>{a.send({type:"publish",topic:g.name,data:toBase64$$module$libs$y_webrtc_min(u)})}):a.send({type:"publish",topic:g.name,data:q})};
class SignalingConn$$module$libs$y_webrtc_min extends WebsocketClient$$module$libs$y_webrtc_min{constructor(a){super(a);this.providers=new Set;this.on("connect",()=>{log$$module$libs$y_webrtc_min(`connected (${a})`);const g=Array.from(rooms$$module$libs$y_webrtc_min.keys());this.send({type:"subscribe",topics:g});rooms$$module$libs$y_webrtc_min.forEach(q=>publishSignalingMessage$$module$libs$y_webrtc_min(this,q,{type:"announce",from:q.peerId}))});this.on("message",g=>{switch(g.type){case "publish":var q=
g.topic;const E=rooms$$module$libs$y_webrtc_min.get(q);if(null==E||"string"!=typeof q)return;q=F=>{const K=E.webrtcConns,I=E.peerId;if(!(null==F||F.from===I||void 0!==F.to&&F.to!==I||E.bcConns.has(F.from))){var J=K.has(F.from)?()=>{}:()=>E.provider.emit("peers",[{removed:[],added:[F.from],webrtcPeers:Array.from(E.webrtcConns.keys()),bcPeers:Array.from(E.bcConns)}]);switch(F.type){case "announce":K.size<E.provider.maxConns&&(setIfUndefined$$module$libs$y_webrtc_min(K,F.from,()=>new WebrtcConn$$module$libs$y_webrtc_min(this,
!0,F.from,E)),J());break;case "signal":F.to===I&&(setIfUndefined$$module$libs$y_webrtc_min(K,F.from,()=>new WebrtcConn$$module$libs$y_webrtc_min(this,!1,F.from,E)).peer.signal(F.signal),J())}}};E.key?"string"==typeof g.data&&(u=fromBase64$$module$libs$y_webrtc_min(g.data),B=E.key,decrypt$$module$libs$y_webrtc_min(u,B).then(F=>readAny$$module$libs$y_webrtc_min(createDecoder$$module$libs$y_webrtc_min(new Uint8Array(F))))).then(q):q(g.data)}var u,B});this.on("disconnect",()=>log$$module$libs$y_webrtc_min(`disconnect (${a})`))}}
class WebrtcProvider$$module$libs$y_webrtc_min extends Observable$$module$libs$y_webrtc_min{constructor(a,g,{signaling:q=["wss://y-webrtc-eu.fly.dev"],password:u=null,awareness:B=new Awareness$$module$libs$y_webrtc_min(g),maxConns:E=20+floor$$module$libs$y_webrtc_min(15*rand$$module$libs$y_webrtc_min()),filterBcConns:F=!0,peerOpts:K={}}={}){super();this.roomName=a;this.doc=g;this.filterBcConns=F;this.awareness=B;this.shouldConnect=!1;this.signalingUrls=q;this.signalingConns=[];this.maxConns=E;this.peerOpts=
K;this.key=u?((I,J)=>{I=encodeUtf8$$module$libs$y_webrtc_min(I).buffer;const H=encodeUtf8$$module$libs$y_webrtc_min(J).buffer;return crypto.subtle.importKey("raw",I,"PBKDF2",!1,["deriveKey"]).then(N=>crypto.subtle.deriveKey({name:"PBKDF2",salt:H,iterations:1E5,hash:"SHA-256"},N,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))})(u,a):resolve$$module$libs$y_webrtc_min(null);this.room=null;this.key.then(I=>{if(rooms$$module$libs$y_webrtc_min.has(a))throw create$2$$module$libs$y_webrtc_min(`A Yjs Doc connected to room "${a}" already exists!`);
I=new Room$$module$libs$y_webrtc_min(g,this,a,I);this.room=(rooms$$module$libs$y_webrtc_min.set(a,I),I);this.shouldConnect?this.room.connect():this.room.disconnect()});this.connect();this.destroy=this.destroy.bind(this);g.on("destroy",this.destroy)}get connected(){return null!==this.room&&this.shouldConnect}connect(){this.shouldConnect=!0;this.signalingUrls.forEach(a=>{const g=setIfUndefined$$module$libs$y_webrtc_min(signalingConns$$module$libs$y_webrtc_min,a,()=>new SignalingConn$$module$libs$y_webrtc_min(a));
this.signalingConns.push(g);g.providers.add(this)});this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1;this.signalingConns.forEach(a=>{a.providers.delete(this);0===a.providers.size&&(a.destroy(),signalingConns$$module$libs$y_webrtc_min.delete(a.url))});this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy);this.key.then(()=>{this.room.destroy();rooms$$module$libs$y_webrtc_min.delete(this.roomName)});super.destroy()}}var module$libs$y_webrtc_min={};
module$libs$y_webrtc_min.AbsolutePosition=AbsolutePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractConnector=AbstractConnector$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractStruct=AbstractStruct$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.AbstractType=AbstractType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Array=YArray$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentAny=ContentAny$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.ContentBinary=ContentBinary$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentDeleted=ContentDeleted$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentEmbed=ContentEmbed$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentFormat=ContentFormat$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentJSON=ContentJSON$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ContentString=ContentString$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.ContentType=ContentType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Doc=Doc$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.GC=GC$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.ID=ID$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Item=Item$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Map=YMap$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.PermanentUserData=PermanentUserData$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.RelativePosition=RelativePosition$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.Room=Room$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.SignalingConn=SignalingConn$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Snapshot=Snapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Text=YText$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.Transaction=Transaction$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.UndoManager=UndoManager$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.UpdateEncoderV1=UpdateEncoderV1$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.WebrtcConn=WebrtcConn$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.WebrtcProvider=WebrtcProvider$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlElement=YXmlElement$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlFragment=YXmlFragment$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlHook=YXmlHook$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.XmlText=YXmlText$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YArrayEvent=YArrayEvent$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.YEvent=YEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YMapEvent=YMapEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YTextEvent=YTextEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.YXmlEvent=YXmlEvent$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.applyUpdate=applyUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.applyUpdateV2=applyUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.cleanupYTextFormatting=cleanupYTextFormatting$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.compareIDs=compareIDs$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.compareRelativePositions=compareRelativePositions$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.convertUpdateFormatV1ToV2=convertUpdateFormatV1ToV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.convertUpdateFormatV2ToV1=convertUpdateFormatV2ToV1$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createAbsolutePositionFromRelativePosition=createAbsolutePositionFromRelativePosition$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.createDeleteSet=createDeleteSet$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createDeleteSetFromStructStore=createDeleteSetFromStructStore$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createDocFromSnapshot=createDocFromSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createID=createID$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createRelativePositionFromJSON=createRelativePositionFromJSON$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.createRelativePositionFromTypeIndex=createRelativePositionFromTypeIndex$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.createSnapshot=createSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeRelativePosition=decodeRelativePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeSnapshot=decodeSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeSnapshotV2=decodeSnapshotV2$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.decodeStateVector=decodeStateVector$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeUpdate=decodeUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.decodeUpdateV2=decodeUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.diffUpdate=diffUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.diffUpdateV2=diffUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.emptySnapshot=emptySnapshot$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.encodeRelativePosition=encodeRelativePosition$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeSnapshot=encodeSnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeSnapshotV2=encodeSnapshotV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateAsUpdate=encodeStateAsUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateAsUpdateV2=encodeStateAsUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateVector=encodeStateVector$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.encodeStateVectorFromUpdate=encodeStateVectorFromUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.encodeStateVectorFromUpdateV2=encodeStateVectorFromUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.equalSnapshots=equalSnapshots$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.findIndexSS=findIndexSS$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.findRootTypeKey=findRootTypeKey$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.getItem=getItem$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.getState=getState$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.getTypeChildren=getTypeChildren$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.isDeleted=isDeleted$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.isParentOf=isParentOf$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.iterateDeletedStructs=iterateDeletedStructs$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.logType=logType$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.logUpdate=logUpdate$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.logUpdateV2=logUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.mergeUpdates=mergeUpdates$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.mergeUpdatesV2=mergeUpdatesV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.obfuscateUpdate=obfuscateUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.obfuscateUpdateV2=obfuscateUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.parseUpdateMeta=parseUpdateMeta$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.parseUpdateMetaV2=parseUpdateMetaV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.readUpdate=readUpdate$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.readUpdateV2=readUpdateV2$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.relativePositionToJSON=relativePositionToJSON$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.snapshot=snapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.transact=transact$$module$libs$y_webrtc_min;
module$libs$y_webrtc_min.tryGc=tryGc$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.typeListToArraySnapshot=typeListToArraySnapshot$$module$libs$y_webrtc_min;module$libs$y_webrtc_min.typeMapGetSnapshot=typeMapGetSnapshot$$module$libs$y_webrtc_min;function uuidv4$$module$radial(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16))}const html$$module$radial=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class AnimateSvg$$module$radial extends k$$module$libs$preact{constructor(a){super();this.mainId=uuidv4$$module$radial();this.mainId2=uuidv4$$module$radial();this.setState({kill:!1});this.out=!1}}
class RadialMenuButton$$module$radial extends k$$module$libs$preact{constructor(a){super();this.mainId=uuidv4$$module$radial();this.mainId2=uuidv4$$module$radial();this.setState({kill:!0});this.out=!1}componentDidUpdate(a){a.uuid!=this.props.uuid&&this.props.cond?this.inx():a.id!=this.props.id?this.inx():(this.props.cond&&this.out&&this.inx(),this.props.cond||this.out||this.outx())}componentDidMount(){const a=document.getElementById(this.mainId),g=document.getElementById(this.mainId+"z");a&&a.beginElement();
g&&g.beginElement();this.out=!1;this.setState({kill:!1})}inx(){const a=document.getElementById(this.mainId),g=document.getElementById(this.mainId+"z");this.out=!1;this.state.kill=!1;a&&a.beginElement();g&&g.beginElement()}outx(){const a=document.getElementById(this.mainId2),g=document.getElementById(this.mainId2+"z");a&&a.beginElement();g&&g.beginElement();let q=this;this.out=!0;window.setTimeout(function(){q.setState({kill:!0})},350)}render(a,g){g=g.kill&&!a.cond?html$$module$radial``:html$$module$radial`
            <g
              opacity="${this.props.enabled?1:.3}"
              transform="scale(${a.scale})"
            >
              <circle
                cx="-8.0776e-10"
                cy="2.1588e-9"
                r="5.538"
                fill="#000"
                fill-opacity=".28921"
                style="paint-order:fill markers stroke"
              />
              <circle
                cx="-8.0776e-10"
                cy="2.1588e-9"
                r="4.7411"
                fill="#d1d1d1"
                style="paint-order:fill markers stroke"
              />
              <use
                fill="${this.props.color||"#222222ff"}"
                xlink:href="${window.app.theme}.svg#${this.props.icon}"
              />
              <path
                d="m0.049757-4.5469a4.5948 4.5948 0 0 0-4.5948 4.5948 4.5948 4.5948 0 0 0 2.1786 3.9046 4.5948 4.5948 0 0 1-1.9714-3.7706 4.5948 4.5948 0 0 1 4.5948-4.5948 4.5948 4.5948 0 0 1 2.3904 0.67114 4.5948 4.5948 0 0 0-2.5976-0.80512z"
                fill="#fff"
                style="paint-order:fill markers stroke"
              />
              <path
                d="m-0.057583 4.5765a4.5948 4.5948 0 0 0 4.5948-4.5948 4.5948 4.5948 0 0 0-2.1786-3.9045 4.5948 4.5948 0 0 1 1.9715 3.7706 4.5948 4.5948 0 0 1-4.5948 4.5948 4.5948 4.5948 0 0 1-2.3904-0.67114 4.5948 4.5948 0 0 0 2.5976 0.80511z"
                fill="#999"
                style="paint-order:fill markers stroke"
              />
            </g>
          `;g=this.props.enabled&&this.props.cond?html$$module$radial` <a class="test" onClick=${this.props.onClick}> ${g} </a>`:html$$module$radial`${g}`;return html$$module$radial` <g transform="rotate(${this.props.angle}, 0,0)">
      <animate
        id="${this.mainId}z"
        attributeName="opacity"
        begin="indefinite"
        dur="0.35s"
        from="0.0"
        restart="always"
        to="1.0"
        fill="freeze"
      />
      <animateTransform
        attributeName="transform"
        type="scale"
        additive="sum"
        from="0.5 0.5"
        restart="always"
        to="1 1"
        id="${this.mainId}"
        begin="indefinite"
        dur="0.35s"
      />
      <animate
        id="${this.mainId2}z"
        attributeName="opacity"
        begin="indefinite"
        restart="always"
        dur="0.35s"
        from="1.0"
        to="0.0"
        fill="freeze"
      />
      <animateTransform
        attributeName="transform"
        type="scale"
        restart="always"
        additive="sum"
        from="1 1"
        to="0.5 0.5"
        id="${this.mainId2}"
        begin="indefinite"
        dur="0.35s"
      />
      <g transform="translate(${Math.max(12,12*this.props.scale)})">
        <g transform="rotate(-${this.props.angle}, 0,0)">
          ${g}
          <title>${a.tooltip}</title>
        </g>
      </g></g
    >`}}class RadialMenu$$module$radial extends k$$module$libs$preact{constructor(a){super()}render(a,g){}}var module$radial={};module$radial.AnimateSvg=AnimateSvg$$module$radial;module$radial.RadialMenu=RadialMenu$$module$radial;module$radial.RadialMenuButton=RadialMenuButton$$module$radial;const html$$module$hexmenu=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),HexBitmask$$module$hexmenu={IS_HEX_AN_OCEAN:1,IS_HEX_OCCUPIED:2,IS_HEX_HAS_RIVER:4,IS_HEX_HAS_TRAIL:8,IS_HEX_COASTAL:16,IS_HEX_HAS_BORDER:32};function HexSettlementMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_city"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendSettlement(a.menu.uuid,"City")}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-city"
      tooltip="Roll a new City"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_town"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendSettlement(a.menu.uuid,"Town")}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-town"
      tooltip="Roll a new Town"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_village"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendSettlement(a.menu.uuid,"Village")}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-village"
      tooltip="Roll a new Village"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_inn"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Inn","Inn")}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-inn"
      tooltip="Roll a new Inn"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_dwelling"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Residency","Residency")}
      angle="120"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-dwelling"
      tooltip="Roll a new Dwelling"
    />
  </g>`}function HexGeneratorMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_dungeon"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendFeature(a.menu.uuid,"Dungeon","Dungeon")}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-dungeon"
      tooltip="Roll a new Dungeon"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_settlement"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRollSettlementMenu()}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)&&!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED)}
      icon="icon-settlement"
      tooltip="Roll a new settlement"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_draw_river"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onDrawRiver(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-river"
      tooltip="Roll a new River"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_roll_realm"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendRealm()}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN}
      icon="icon-realm"
      tooltip="Roll a new Realm"
    />
  </g>`}function HexCleanupMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_clean_river"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onClearHexRiver(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-river"
      tooltip="Remove River"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_clean_trail"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onClearHexTrails(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-trail"
      tooltip="Rebuild Trails"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_reroll_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRerollHex(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-feature"
      tooltip="Reroll an Empty Hex (removes everthing inside!)"
    />
  </g>`}function HexDeleteMenu$$module$hexmenu(a){return html$$module$hexmenu`<g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_hex"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveHex(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_HAS_BORDER}
      icon="icon-hex"
      tooltip="Delete Hex (coastlines only)"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_region"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveRegion(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-region"
      tooltip="Delete Region"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_delete_realm"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemoveRealm(a.menu.uuid)}
      angle="360"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-realm"
      tooltip="Delete the entire Realm!"
    />
  </g>`}function HexMainMenu$$module$hexmenu(a){return html$$module$hexmenu` <g
    transform="translate( ${a.menu.offset.x},
          ${a.menu.offset.y} )"
  >
    <${RadialMenuButton$$module$radial}
      id="radial_button_trash"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onDeleteMenu(a.menu.uuid)}
      angle="60"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-trash"
      tooltip="Destroy Land (and anything on it!)"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_broom"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRerollMenu(a.menu.uuid)}
      angle="180"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-broom"
      tooltip="Remove / Rebuild Features"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_dice"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onAppendMenu(a.menu.uuid)}
      angle="240"
      selected=${this.selected}
      scale=${a.scale}
      enabled="1"
      icon="icon-dice"
      tooltip="Roll new entities"
    />
    <${RadialMenuButton$$module$radial}
      id="radial_button_remap"
      uuid=${a.menu.uuid}
      cond=${a.cond}
      onClick=${()=>a.handler.onRemapEntity(a.menu.uuid)}
      angle="300"
      selected=${this.selected}
      scale=${a.scale}
      enabled=${!(a.bitmask&HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN)}
      icon="icon-remap"
      tooltip="Rearrange Realm Hex Map"
    />
  </g>`}class HexMenu$$module$hexmenu extends k$$module$libs$preact{constructor(){super()}render(a){return 0==a.menu.type?html$$module$hexmenu` <${HexMainMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:1==a.menu.type?html$$module$hexmenu` <${HexGeneratorMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:4==a.menu.type?html$$module$hexmenu` <${HexSettlementMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:2==a.menu.type?html$$module$hexmenu` <${HexCleanupMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:3==a.menu.type?html$$module$hexmenu` <${HexDeleteMenu$$module$hexmenu}
          menu=${a.menu}
          handler=${a.handler}
          scale=${a.scale}
          cond=${a.cond}
          bitmask=${a.bitmask}
        />`:html$$module$hexmenu``}}var module$hexmenu={};module$hexmenu.HexBitmask=HexBitmask$$module$hexmenu;module$hexmenu.HexMenu=HexMenu$$module$hexmenu;const html$$module$SvgMap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function easeInOutSine$$module$SvgMap(a,g,q,u){return-q/2*(Math.cos(Math.PI*a/u)-1)+g}function easeInOutCubic$$module$SvgMap(a,g,q,u){return 1>(a/=u/2)?q/2*a*a*a+g:q/2*((a-=2)*a*a+2)+g}function isTouchDevice$$module$SvgMap(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}
class SvgMap$$module$SvgMap extends k$$module$libs$preact{constructor(){super();this.state={offset:{x:10,y:10},dim:{w:1500,h:1500},drag:!1};this.predrag=this.drag=!1;this.factor=.1;this.oy=this.ox=0;this.inhibit_pointer_events=this.minimap=!1;this.sizeToFit=this.sizeToFit.bind(this)}sizeToFit(){var a=document.getElementById("canvas");if(a)if(this.width){var g=this.width;const q=this.height;this.width=a.getBoundingClientRect().width;this.height=a.getBoundingClientRect().height;a=this.state.dim.w/g;
const u=this.state.dim.h/q,B={w:this.width*a,h:this.height*u};this.setState({dim:B,offset:{x:this.state.offset.x-(this.width-g)*a/2,y:this.state.offset.y-(this.height-q)*u/2},zoom_factor:this.width*this.height/(B.w*B.h)})}else this.width=a.getBoundingClientRect().width,this.height=a.getBoundingClientRect().height,g={w:this.state.dim.w,h:this.height/this.width*this.state.dim.w},this.setState({dim:g,zoom_factor:this.width*this.height/(g.w*g.h)})}componentDidMount(a,g,q){let u=this;if(!this.minimap){var B=
document.getElementById("canvas");if(B){(new ResizeObserver(this.sizeToFit)).observe(B);B.addEventListener("pointerdown",function(F){u.touch_is_on||u.inhibit_pointer_events||u.filterPointerCapture(F.clientX,F.clientY)||(u.predrag=!0,u.setState({drag:!0}),u.ox=F.offsetX,u.oy=F.offsetY,u.tmp=u.state.offset)});B.addEventListener("pointermove",function(F){if(!u.inhibit_pointer_events)if(u.predrag&&(u.drag=!0),u.drag){window.app.inhibit_click=!0;window.app.last_selected&&(window.app.last_selected.setState({class:"baseout"}),
window.app.last_selected=null);var K=F.offsetX-u.ox;F=F.offsetY-u.oy;var I=B.getBoundingClientRect().width,J=B.getBoundingClientRect().height;u.setState({offset:{x:u.tmp.x-u.state.dim.w/I*K,y:u.tmp.y-u.state.dim.h/J*F},menu:!1})}else window.app.inhibit_click=!1},{passive:!0});document.addEventListener("mouseup",function(F){u.drag&&(u.setState({drag:!1}),u.drag=!1);u.predrag=!1},{passive:!0});document.addEventListener("onClick",function(F){window.app.inhibit_click&&(window.app.inhibit_click=!1,F.stopPropagation())},
{passive:!0});var E=Date.now();B.addEventListener("wheel",function(F){window.clearInterval(u.interval);u.props.hex_uuid&&$$$module$libs$preact_router_module("/sandbox/"+u.props.instance);if(!u.inhibit_pointer_events){var K=Date.now();F.stopPropagation();var I=0<F.deltaY?1:-1;if(!(-1==I&&1E7<u.state.zoom_factor||1==I&&.1>u.state.zoom_factor)){K=1-(K-E)/1E3*10;.7<K&&(K=.7);.2>K&&(K=.2);I=1+K*I;K=F.offsetX*I-F.offsetX;F=F.offsetY*I-F.offsetY;var J=B.getBoundingClientRect().width,H=B.getBoundingClientRect().height,
N=J*H/(H/J*I*u.state.dim.w*I*u.state.dim.w);u.setState({offset:{x:u.state.offset.x-u.state.dim.w/J*K,y:u.state.offset.y-u.state.dim.h/H*F},dim:{w:u.state.dim.w*I,h:u.state.dim.h*I},zoom_factor:N,res:u.getResPrefix(N)});return!0}}},{passive:!0});a=F=>{var K;const I=J=>Math.hypot(J.touches[0].pageX-J.touches[1].pageX,J.touches[0].pageY-J.touches[1].pageY);F.addEventListener("touchstart",J=>{window.clearInterval(u.interval);u.inhibit_pointer_events=!1;if(1===J.touches.length){u.touch_is_on=!0;J.preventDefault();
if(u.filterPointerCapture(J.touches[0].pageX,J.touches[0].pageY))return;u.drag=!0;u.ox=J.touches[0].pageX;u.oy=J.touches[0].pageY;u.tmp=u.state.offset}2===J.touches.length&&(J.preventDefault(),u.inhibit_pointer_events=!0,K=I(J))},{passive:!0});F.addEventListener("touchmove",J=>{if(2===J.touches.length){J.preventDefault();let O;O=J.scale?J.scale:I(J)/K;.9>O&&(O=.9);1.1<O&&(O=1.1);O=1/O;var H=[(J.touches[0].pageX+J.touches[1].pageX)/2,(J.touches[0].pageY+J.touches[1].pageY)/2];J=H[0]*O-H[0];H=H[1]*
O-H[1];var N=B.getBoundingClientRect().width,T=B.getBoundingClientRect().height;const W=N*T/(u.state.dim.w*O*u.state.dim.h*O);u.setState({offset:{x:u.state.offset.x-u.state.dim.w/N*J,y:u.state.offset.y-u.state.dim.h/T*H},dim:{w:u.state.dim.w*O,h:u.state.dim.h*O},zoom_factor:W,res:u.getResPrefix(W)})}});F.addEventListener("touchend",J=>{u.touchinterval=window.setTimeout(function(){},500);F.style.transform="";F.style.WebkitTransform="";F.style.zIndex=""})};isTouchDevice$$module$SvgMap()&&a(B)}}}getResPrefix(a){let g=
"";20>a&&(g="low-");2>a&&(g="empty-");return g}waypoint(a,g,q,u,B,E=null){window.clearInterval(this.interval);let F=this.state.offset.x,K=this.state.offset.y,I=this.state.dim.w,J=this.state.dim.h,H=0,N=this;const T=10*B;this.camera_moving=!0;this.interval=window.setInterval(function(){var O=N.height/N.width*q,W=a-F-q/2,ba=g-K-O/2,fa=q-I;O-=J;H++;let R=easeInOutSine$$module$SvgMap;W=R(10*H,F,W,T);ba=R(10*H,K,ba,T);fa=R(10*H,I,fa,T);O=R(10*H,J,O,T);N.setState({offset:{x:W,y:ba},dim:{w:fa,h:O},zoom_factor:N.width*
N.height/(fa*O),col1:"rect1",res:N.getResPrefix(N.width*N.height/(fa*O))});H==B&&(window.clearInterval(N.interval),N.camera_moving=!1,E&&E())},10)}minimapOnLocation(a,g,q,u){const B=Math.abs(this.state.dim.w-q);if(20>Math.hypot(this.state.offset.x-a,this.state.offset.y-g)||20<B||200>this.state.zoom_factor)this.waypoint(a,g,q,u,50);else{let E=this;this.waypoint(a,g,100*q,100*u,100,function(){E.waypoint(a,g,q,u,100)})}}}var module$SvgMap={};module$SvgMap.SvgMap=SvgMap$$module$SvgMap;function rand$$module$utils(a,g){return Math.floor(Math.random()*(g-a+1)+a)}function dist$$module$utils(a,g){const q=a.x-g.x;a=a.y-g.y;return Math.sqrt(q*q+a*a)}function get_polygon_extents$$module$utils(a){if(3>a.length)return{w:0,h:0};let g=a[0].x,q=a[0].x,u=a[0].y,B=a[0].y;for(var E=0,F=a.length;E<F;E++){const K=a[E].x,I=a[E].y;g=g<K?g:K;q=q>K?q:K;u=u<I?g:I;B=B>I?q:I}return{w:Math.abs(g-q),h:Math.abs(u-B)}}
function get_polygon_area$$module$utils(a){for(var g=0,q=0,u=a.length;q<u;q++){var B=a[q==a.length-1?0:q+1].x,E=a[q].y;g+=a[q].x*a[q==a.length-1?0:q+1].y*.5;g-=B*E*.5}return Math.abs(g)}function clamp$$module$utils(a,g,q){return Math.min(Math.max(a,g),q)}function make_xy_polygon$$module$utils(a){let g=[];for(let q=0;q<a.length;q++)g.push({x:a[q][0],y:a[q][1]});return g}
function get_polygon_centroid$$module$utils(a){var g=a[0],q=a[a.length-1];g.x==q.x&&g.y==q.y||a.push(g);var u=q=g=0,B=a.length,E,F=0;for(E=B-1;F<B;E=F++){var K=a[F];E=a[E];var I=K.x*E.y-E.x*K.y;g+=I;q+=(K.x+E.x)*I;u+=(K.y+E.y)*I}I=3*g;return{x:q/I,y:u/I}}function get_centroidic_point$$module$utils(a){for(var g={x:0,y:0},q=0;q<a.length;q++){var u=a[q];g.x+=u.x;g.y+=u.y}g.x/=a.length;g.y/=a.length;q=1E6;u=-1;for(let B=0;B<a.length;B++){const E=dist$$module$utils(a[B],g);E<q&&(q=E,u=B)}return a[u]}
var module$utils={};module$utils.clamp=clamp$$module$utils;module$utils.dist=dist$$module$utils;module$utils.get_centroidic_point=get_centroidic_point$$module$utils;module$utils.get_polygon_area=get_polygon_area$$module$utils;module$utils.get_polygon_centroid=get_polygon_centroid$$module$utils;module$utils.get_polygon_extents=get_polygon_extents$$module$utils;module$utils.make_xy_polygon=make_xy_polygon$$module$utils;module$utils.rand=rand$$module$utils;/*
 GNU Affero General Public License.
 Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 v. 1.2.0
 https://github.com/RaumZeit/MarchingSquares.js

 MarchingSquaresJS is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 MarchingSquaresJS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 As additional permission under GNU Affero General Public License version 3
 section 7, third-party projects (personal or commercial) may distribute,
 include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 requirement that said third-party project for that reason alone becomes
 subject to any requirement of the GNU Affero General Public License version 3.
 Any modifications to MarchingSquaresJS, however, must be shared with the public
 and made available.

 In summary this:
 - allows you to use MarchingSquaresJS at no cost
 - allows you to use MarchingSquaresJS for both personal and commercial purposes
 - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
   license as long as this license notice is included
 - enables you to keep the source code of your program that uses MarchingSquaresJS
   undisclosed
 - forces you to share any modifications you have made to MarchingSquaresJS,
   e.g. bug-fixes

 You should have received a copy of the GNU Affero General Public License
 along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 MIT
 @preserve
 @license GNU Affero General Public License.
 Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 v. 1.2.0
 https://github.com/RaumZeit/MarchingSquares.js

 MarchingSquaresJS is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 MarchingSquaresJS is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 As additional permission under GNU Affero General Public License version 3
 section 7, third-party projects (personal or commercial) may distribute,
 include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 requirement that said third-party project for that reason alone becomes
 subject to any requirement of the GNU Affero General Public License version 3.
 Any modifications to MarchingSquaresJS, however, must be shared with the public
 and made available.

 In summary this:
 - allows you to use MarchingSquaresJS at no cost
 - allows you to use MarchingSquaresJS for both personal and commercial purposes
 - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
   license as long as this license notice is included
 - enables you to keep the source code of your program that uses MarchingSquaresJS
   undisclosed
 - forces you to share any modifications you have made to MarchingSquaresJS,
   e.g. bug-fixes

 You should have received a copy of the GNU Affero General Public License
 along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
*/
!function(a,g){"object"==typeof exports&&"undefined"!=typeof module?g(exports):"function"==typeof define&&define.amd?define(["exports"],g):g((a="undefined"!=typeof globalThis?globalThis:a||self).turf={})}(this,function(a){function g(b,c,e){void 0===e&&(e={});var k={type:"Feature"};return(0===e.id||e.id)&&(k.id=e.id),e.bbox&&(k.bbox=e.bbox),k.properties=c||{},k.geometry=b,k}function q(b,c,e){switch(b){case "Point":return u(c).geometry;case "LineString":return K(c).geometry;case "Polygon":return E(c).geometry;
case "MultiPoint":return N(c).geometry;case "MultiLineString":return H(c).geometry;case "MultiPolygon":return T(c).geometry;default:throw Error(b+" is invalid");}}function u(b,c,e){if(void 0===e&&(e={}),!b)throw Error("coordinates is required");if(!Array.isArray(b))throw Error("coordinates must be an Array");if(2>b.length)throw Error("coordinates must be at least 2 numbers long");if(!la(b[0])||!la(b[1]))throw Error("coordinates must contain numbers");return g({type:"Point",coordinates:b},c,e)}function B(b,
c,e){return void 0===e&&(e={}),J(b.map(function(k){return u(k,c)}),e)}function E(b,c,e){void 0===e&&(e={});for(var k=0;k<b.length;k++){var d=b[k];if(4>d.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var f=0;f<d[d.length-1].length;f++)if(d[d.length-1][f]!==d[0][f])throw Error("First and last Position are not equivalent.");}return g({type:"Polygon",coordinates:b},c,e)}function F(b,c,e){return void 0===e&&(e={}),J(b.map(function(k){return E(k,c)}),e)}function K(b,
c,e){if(void 0===e&&(e={}),2>b.length)throw Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:b},c,e)}function I(b,c,e){return void 0===e&&(e={}),J(b.map(function(k){return K(k,c)}),e)}function J(b,c){void 0===c&&(c={});var e={type:"FeatureCollection"};return c.id&&(e.id=c.id),c.bbox&&(e.bbox=c.bbox),e.features=b,e}function H(b,c,e){return void 0===e&&(e={}),g({type:"MultiLineString",coordinates:b},c,e)}function N(b,c,e){return void 0===e&&(e={}),
g({type:"MultiPoint",coordinates:b},c,e)}function T(b,c,e){return void 0===e&&(e={}),g({type:"MultiPolygon",coordinates:b},c,e)}function O(b,c,e){return void 0===e&&(e={}),g({type:"GeometryCollection",geometries:b},c,e)}function W(b,c){if(void 0===c&&(c=0),c&&!(0<=c))throw Error("precision must be a positive number");c=Math.pow(10,c||0);return Math.round(b*c)/c}function ba(b,c){void 0===c&&(c="kilometers");var e=mh[c];if(!e)throw Error(c+" units is invalid");return b*e}function fa(b,c){void 0===c&&
(c="kilometers");var e=mh[c];if(!e)throw Error(c+" units is invalid");return b/e}function R(b,c){return ha(fa(b,c))}function da(b){b%=360;return 0>b&&(b+=360),b}function ha(b){return b%(2*Math.PI)*180/Math.PI}function ma(b){return b%360*Math.PI/180}function ka(b,c,e){if(void 0===c&&(c="kilometers"),void 0===e&&(e="kilometers"),!(0<=b))throw Error("length must be a positive number");return ba(fa(b,c),e)}function pa(b,c,e){if(void 0===c&&(c="meters"),void 0===e&&(e="kilometers"),!(0<=b))throw Error("area must be a positive number");
c=nh[c];if(!c)throw Error("invalid original units");e=nh[e];if(!e)throw Error("invalid final units");return b/c*e}function la(b){return!isNaN(b)&&null!==b&&!Array.isArray(b)}function ta(b){return!!b&&b.constructor===Object}function wa(b){if(!b)throw Error("bbox is required");if(!Array.isArray(b))throw Error("bbox must be an Array");if(4!==b.length&&6!==b.length)throw Error("bbox must be an Array of 4 or 6 numbers");b.forEach(function(c){if(!la(c))throw Error("bbox must only contain numbers");})}function za(b){if(!b)throw Error("id is required");
if(-1===["string","number"].indexOf(typeof b))throw Error("id must be a number or a string");}function Ca(b,c,e){if(null!==b){var k,d,f,l,h=0;var m=b.type;for(var p="FeatureCollection"===m,n="Feature"===m,r=p?b.features.length:1,v=0;v<r;v++){var z=(f=!!(d=p?b.features[v].geometry:n?b.geometry:b)&&"GeometryCollection"===d.type)?d.geometries.length:1;for(var t=0;t<z;t++){var y=0,C=0;if(null!==(k=f?d.geometries[t]:d)){var w=k.coordinates;var x=k.type;switch(l=!e||"Polygon"!==x&&"MultiPolygon"!==x?0:
1,x){case null:break;case "Point":if(!1===c(w,h,v,y,C))return!1;h++;break;case "LineString":case "MultiPoint":for(m=0;m<w.length;m++){if(!1===c(w[m],h,v,y,C))return!1;h++;"MultiPoint"===x&&y++}"LineString"===x&&y++;break;case "Polygon":case "MultiLineString":for(m=0;m<w.length;m++){for(k=0;k<w[m].length-l;k++){if(!1===c(w[m][k],h,v,y,C))return!1;h++}"MultiLineString"===x&&y++;"Polygon"===x&&C++}"Polygon"===x&&y++;break;case "MultiPolygon":for(m=0;m<w.length;m++){for(k=C=0;k<w[m].length;k++){for(x=
0;x<w[m][k].length-l;x++){if(!1===c(w[m][k][x],h,v,y,C))return!1;h++}C++}y++}break;case "GeometryCollection":for(m=0;m<k.geometries.length;m++)if(!1===Ca(k.geometries[m],c,e))return!1;break;default:throw Error("Unknown Geometry Type");}}}}}}function Vb(b,c,e,k){var d=e;return Ca(b,function(f,l,h,m,p){d=0===l&&void 0===e?f:c(d,f,l,h,m,p)},k),d}function Kb(b,c){var e;switch(b.type){case "FeatureCollection":for(e=0;e<b.features.length&&!1!==c(b.features[e].properties,e);e++);break;case "Feature":c(b.properties,
0)}}function Qd(b,c,e){var k=e;return Kb(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k}function Sa(b,c){if("Feature"===b.type)c(b,0);else if("FeatureCollection"===b.type)for(var e=0;e<b.features.length&&!1!==c(b.features[e],e);e++);}function Ya(b,c,e){var k=e;return Sa(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k}function uc(b){var c=[];return Ca(b,function(e){c.push(e)}),c}function Zb(b,c){var e,k,d,f,l,h=0,m="FeatureCollection"===b.type,p="Feature"===b.type,n=m?b.features.length:1;for(e=
0;e<n;e++){var r=m?b.features[e].geometry:p?b.geometry:b;var v=m?b.features[e].properties:p?b.properties:{};var z=m?b.features[e].bbox:p?b.bbox:void 0;var t=m?b.features[e].id:p?b.id:void 0;var y=(l=!!r&&"GeometryCollection"===r.type)?r.geometries.length:1;for(d=0;d<y;d++)if(null!==(f=l?r.geometries[d]:r))switch(f.type){case "Point":case "LineString":case "MultiPoint":case "Polygon":case "MultiLineString":case "MultiPolygon":if(!1===c(f,h,v,z,t))return!1;break;case "GeometryCollection":for(k=0;k<
f.geometries.length;k++)if(!1===c(f.geometries[k],h,v,z,t))return!1;break;default:throw Error("Unknown Geometry Type");}else if(!1===c(null,h,v,z,t))return!1;h++}}function pd(b,c,e){var k=e;return Zb(b,function(d,f,l,h,m){k=0===f&&void 0===e?d:c(k,d,f,l,h,m)}),k}function Rb(b,c){Zb(b,function(e,k,d,f,l){var h=null===e?null:e.type;switch(h){case null:case "Point":case "LineString":case "Polygon":return!1!==c(g(e,d,{bbox:f,id:l}),k,0)&&void 0}switch(h){case "MultiPoint":var m="Point";break;case "MultiLineString":m=
"LineString";break;case "MultiPolygon":m="Polygon"}for(f=0;f<e.coordinates.length;f++)if(!1===c(g({type:m,coordinates:e.coordinates[f]},d),k,f))return!1})}function Me(b,c,e){var k=e;return Rb(b,function(d,f,l){k=0===f&&0===l&&void 0===e?d:c(k,d,f,l)}),k}function L(b,c){Rb(b,function(e,k,d){var f=0;if(e.geometry){var l=e.geometry.type;if("Point"!==l&&"MultiPoint"!==l){var h,m=0,p=0,n=0;return!1!==Ca(e,function(r,v,z,t,y){if(void 0===h||k>m||t>p||y>n)return h=r,m=k,p=t,n=y,void(f=0);v=K([h,r],e.properties);
if(!1===c(v,k,d,y,f))return!1;f++;h=r})&&void 0}}})}function M(b,c,e){var k=e,d=!1;return L(b,function(f,l,h,m,p){k=!1===d&&void 0===e?f:c(k,f,l,h,m,p);d=!0}),k}function Q(b,c){if(!b)throw Error("geojson is required");Rb(b,function(e,k,d){if(null!==e.geometry){var f=e.geometry.coordinates;switch(e.geometry.type){case "LineString":if(!1===c(e,k,d,0,0))return!1;break;case "Polygon":for(var l=0;l<f.length;l++)if(!1===c(K(f[l],e.properties),k,d,l))return!1}}})}function ca(b,c,e){var k=e;return Q(b,function(d,
f,l,h){k=0===f&&void 0===e?d:c(k,d,f,l,h)}),k}function oa(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.segmentIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;
default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":case "MultiPoint":return null;case "LineString":return 0>f&&(f=e.length+f-1),K([e[f],e[f+1]],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f-1),K([e[d][f],e[d][f+1]],l,c);case "MultiLineString":return 0>k&&(k=e.length+k),0>f&&(f=e[k].length+f-1),K([e[k][f],e[k][f+1]],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-f-1),
K([e[k][d][f],e[k][d][f+1]],l,c)}throw Error("geojson is invalid");}function Ba(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.coordIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;
default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":return u(e,l,c);case "MultiPoint":return 0>k&&(k=e.length+k),u(e[k],l,c);case "LineString":return 0>f&&(f=e.length+f),u(e[f],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f),u(e[d][f],l,c);case "MultiLineString":return 0>k&&(k=e.length+k),0>f&&(f=e[k].length+f),u(e[k][f],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-
f),u(e[k][d][f],l,c)}throw Error("geojson is invalid");}function ya(b){var c=[1/0,1/0,-1/0,-1/0];return Ca(b,function(e){c[0]>e[0]&&(c[0]=e[0]);c[1]>e[1]&&(c[1]=e[1]);c[2]<e[0]&&(c[2]=e[0]);c[3]<e[1]&&(c[3]=e[1])}),c}function aa(b){if(!b)throw Error("coord is required");if(!Array.isArray(b)){if("Feature"===b.type&&null!==b.geometry&&"Point"===b.geometry.type)return b.geometry.coordinates;if("Point"===b.type)return b.coordinates}if(Array.isArray(b)&&2<=b.length&&!Array.isArray(b[0])&&!Array.isArray(b[1]))return b;
throw Error("coord must be GeoJSON Point or an Array of numbers");}function Y(b){if(Array.isArray(b))return b;if("Feature"===b.type){if(null!==b.geometry)return b.geometry.coordinates}else if(b.coordinates)return b.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array");}function xa(b){if(1<b.length&&la(b[0])&&la(b[1]))return!0;if(Array.isArray(b[0])&&b[0].length)return xa(b[0]);throw Error("coordinates must only contain numbers");}function Oa(b,c,e){if(!c||!e)throw Error("type and name required");
if(!b||b.type!==c)throw Error("Invalid input to "+e+": must be a "+c+", given "+b.type);}function Ob(b,c,e){if(!b)throw Error("No feature passed");if(!e)throw Error(".featureOf() requires a name");if(!b||"Feature"!==b.type||!b.geometry)throw Error("Invalid input to "+e+", Feature with geometry required");if(!b.geometry||b.geometry.type!==c)throw Error("Invalid input to "+e+": must be a "+c+", given "+b.geometry.type);}function Ka(b,c,e){if(!b)throw Error("No featureCollection passed");if(!e)throw Error(".collectionOf() requires a name");
if(!b||"FeatureCollection"!==b.type)throw Error("Invalid input to "+e+", FeatureCollection required");var k=0;for(b=b.features;k<b.length;k++){var d=b[k];if(!d||"Feature"!==d.type||!d.geometry)throw Error("Invalid input to "+e+", Feature with geometry required");if(!d.geometry||d.geometry.type!==c)throw Error("Invalid input to "+e+": must be a "+c+", given "+d.geometry.type);}}function Ib(b){return"Feature"===b.type?b.geometry:b}function qc(b,c){return"FeatureCollection"===b.type?"FeatureCollection":
"GeometryCollection"===b.type?"GeometryCollection":"Feature"===b.type&&null!==b.geometry?b.geometry.type:b.type}function ff(b,c,e){e=e||{};for(var k=Object.keys(Rj),d=0;d<k.length;d++){var f=k[d],l=e[f];l=null!=l?l:Rj[f];oh[f]=l}oh.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+c);b=function(h){var m=[],p=0;return h.cells.forEach(function(n,r){n.forEach(function(v,z){var t;if(void 0!==v&&5!==(t=v).cval&&10!==t.cval&&0!==v.cval&&15!==v.cval){a:{v=h.cells;var y=v.length,
C=[],w=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],x=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],A="none bottom right right top top top top left bottom right right left bottom left none".split(" "),D=v[r][z],G=D.cval,P="none left bottom left right none bottom left top top none top right right bottom none".split(" ")[G];P=ef(D,P);C.push([z+P[0],r+P[1]]);P=A[G];P=ef(D,P);C.push([z+P[0],r+P[1]]);wc(D);for(var S=z+w[G],V=r+x[G],Z=G;0<=S&&0<=V&&V<y&&(S!=z||V!=r)&&void 0!==(D=v[V][S]);){if(0===(G=D.cval)||15===G){z=
C;t="mergeable";break a}P=A[G];t=w[G];var X=x[G];5!==G&&10!==G||(5===G?D.flipped?-1===x[Z]?(P="left",t=-1,X=0):(P="right",t=1,X=0):-1===w[Z]&&(P="bottom",t=0,X=-1):10===G&&(D.flipped?-1===w[Z]?(P="top",t=0,X=1):(P="bottom",t=0,X=-1):1===x[Z]&&(P="left",t=-1,X=0)));P=ef(D,P);C.push([S+P[0],V+P[1]]);wc(D);S+=t;V+=X;Z=G}z=C;t="closed"}v=!1;if("mergeable"===t)for(X=z[z.length-1][0],y=z[z.length-1][1],t=p-1;0<=t;t--)if(1E-7>=Math.abs(m[t][0][0]-X)&&1E-7>=Math.abs(m[t][0][1]-y)){for(v=z.length-2;0<=v;--v)m[t].unshift(z[v]);
v=!0;break}v||(m[p++]=z)}})}),m}(function(h,m){for(var p=h.length-1,n=h[0].length-1,r={rows:p,cols:n,cells:[]},v=0;v<p;++v){r.cells[v]=[];for(var z=0;z<n;++z){var t=0,y=h[v+1][z],C=h[v+1][z+1],w=h[v][z+1],x=h[v][z];if(!(isNaN(y)||isNaN(C)||isNaN(w)||isNaN(x))){t|=y>=m?8:0;t|=C>=m?4:0;t|=w>=m?2:0;var A,D,G,P=!1;if(5===(t|=x>=m?1:0)||10===t){var S=(y+C+w+x)/4;5===t&&S<m?(t=10,P=!0):10===t&&S<m&&(t=5,P=!0)}0!==t&&15!==t&&(S=A=D=G=.5,1===t?(D=1-$a(m,y,x),A=1-$a(m,w,x)):2===t?(A=$a(m,x,w),G=1-$a(m,C,w)):
3===t?(D=1-$a(m,y,x),G=1-$a(m,C,w)):4===t?(S=$a(m,y,C),G=$a(m,w,C)):5===t?(S=$a(m,y,C),G=$a(m,w,C),A=1-$a(m,w,x),D=1-$a(m,y,x)):6===t?(A=$a(m,x,w),S=$a(m,y,C)):7===t?(D=1-$a(m,y,x),S=$a(m,y,C)):8===t?(D=$a(m,x,y),S=1-$a(m,C,y)):9===t?(A=1-$a(m,w,x),S=1-$a(m,C,y)):10===t?(S=1-$a(m,C,y),G=1-$a(m,C,w),A=$a(m,x,w),D=$a(m,x,y)):11===t?(S=1-$a(m,C,y),G=1-$a(m,C,w)):12===t?(D=$a(m,x,y),G=$a(m,w,C)):13===t?(A=1-$a(m,w,x),G=$a(m,w,C)):14===t?(D=$a(m,x,y),A=$a(m,x,w)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+
t),r.cells[v][z]={cval:t,flipped:P,top:S,right:G,bottom:A,left:D})}}}return r}(b,c));return"function"==typeof oh.successCallback&&oh.successCallback(b),b}function $a(b,c,e){return(b-c)/(e-c)}function wc(b){0===b.cval||15===b.cval||5===b.cval||10===b.cval||(b.cval=15)}function ef(b,c){return"top"===c?[b.top,1]:"bottom"===c?[b.bottom,0]:"right"===c?[1,b.right]:"left"===c?[0,b.left]:void 0}function lh(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.zProperty||"elevation",k=c.flip;c=c.flags;
Ka(b,"Point","input must contain Points");b=function(p,n){var r={};return Sa(p,function(v){var z=Y(v)[1];r[z]||(r[z]=[]);r[z].push(v)}),Object.keys(r).map(function(v){return r[v].sort(function(z,t){return Y(z)[0]-Y(t)[0]})}).sort(function(v,z){return n?Y(v[0])[1]-Y(z[0])[1]:Y(z[0])[1]-Y(v[0])[1]})}(b,k);k=[];for(var d=0;d<b.length;d++){for(var f=b[d],l=[],h=0;h<f.length;h++){var m=f[h];m.properties[e]?l.push(m.properties[e]):l.push(0);!0===c&&(m.properties.matrixPosition=[d,h])}k.push(l)}return k}
function $b(b,c,e,k,d){vc(b,c,e||0,k||b.length-1,d||Cn)}function vc(b,c,e,k,d){for(;k>e;){if(600<k-e){var f=k-e+1,l=c-e+1,h=Math.log(f),m=.5*Math.exp(2*h/3);h=.5*Math.sqrt(h*m*(f-m)/f)*(0>l-f/2?-1:1);vc(b,c,Math.max(e,Math.floor(c-l*m/f+h)),Math.min(k,Math.floor(c+(f-l)*m/f+h)),d)}f=b[c];l=e;m=k;he(b,e,c);for(0<d(b[k],f)&&he(b,e,k);l<m;){he(b,l,m);l++;for(m--;0>d(b[l],f);)l++;for(;0<d(b[m],f);)m--}0===d(b[e],f)?he(b,e,m):he(b,++m,k);m<=c&&(e=m+1);c<=m&&(k=m-1)}}function he(b,c,e){var k=b[c];b[c]=
b[e];b[e]=k}function Cn(b,c){return b<c?-1:b>c?1:0}function mg(b,c){if(!(this instanceof mg))return new mg(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&this._initFormat(c);this.clear()}function Bf(b,c){ng(b,0,b.children.length,c,b)}function ng(b,c,e,k,d){d||=Cf(null);d.minX=1/0;d.minY=1/0;d.maxX=-1/0;d.maxY=-1/0;for(var f=c;f<e;f++)c=b.children[f],og(d,b.leaf?k(c):c);return d}function og(b,c){return b.minX=Math.min(b.minX,c.minX),b.minY=Math.min(b.minY,
c.minY),b.maxX=Math.max(b.maxX,c.maxX),b.maxY=Math.max(b.maxY,c.maxY),b}function Sj(b,c){return b.minX-c.minX}function Tj(b,c){return b.minY-c.minY}function oi(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function ph(b){return b.maxX-b.minX+(b.maxY-b.minY)}function pi(b,c){return b.minX<=c.minX&&b.minY<=c.minY&&c.maxX<=b.maxX&&c.maxY<=b.maxY}function qh(b,c){return c.minX<=b.maxX&&c.minY<=b.maxY&&c.maxX>=b.minX&&c.maxY>=b.minY}function Cf(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/
0,maxY:-1/0}}function Uj(b,c,e,k,d){for(var f,l=[c,e];l.length;)(e=l.pop())-(c=l.pop())<=k||(f=c+Math.ceil((e-c)/k/2)*k,Vj(b,f,c,e,d),l.push(c,f,f,e))}function ie(b){var c={exports:{}};return b(c,c.exports),c.exports}function pg(b,c){if(!(this instanceof pg))return new pg(b,c);if(this.data=b||[],this.length=this.data.length,this.compare=c||Dn,0<this.length)for(b=(this.length>>1)-1;0<=b;b--)this._down(b)}function Dn(b,c){return b<c?-1:b>c?1:0}function Wj(b,c,e){c=Math.max(0,void 0===c?2:c);e=e||0;
for(var k,d=b[0],f=b[0],l=b[0],h=b[0],m=0;m<b.length;m++){var p=b[m];p[0]<d[0]&&(d=p);p[0]>l[0]&&(l=p);p[1]<f[1]&&(f=p);p[1]>h[1]&&(h=p)}f=[d,f,l,h];d=f.slice();for(m=0;m<b.length;m++){h=b[m];l=h[0];h=h[1];p=!1;for(var n=0,r=f.length-1;n<f.length;r=n++){var v=f[n][0],z=f[n][1],t=f[r][0];r=f[r][1];z>h!=r>h&&l<(t-v)*(h-z)/(r-z)+v&&(p=!p)}p||d.push(b[m])}l=En(d);f=[];for(m=0;m<l.length;m++)f.push(d[l[m]]);b=Uc(16,["[0]","[1]","[0]","[1]"]).load(b);m=[];for(l=0;l<f.length;l++){var y=f[l];b.remove(y);
k=Xj(y,k);m.push(k)}d=Uc(16);for(l=0;l<m.length;l++)d.insert(qi(m[l]));c*=c;for(f=e*e;m.length;)if(e=m.shift(),l=e.p,h=e.next.p,p=ri(l,h),!(p<f)){p/=c;a:{var C=b;n=e.prev.p;v=l;z=h;t=e.next.next.p;r=p;var w=d,x=new Yj(null,Fn);for(C=C.data;C;){for(var A=0;A<C.children.length;A++){var D=C.children[A],G=C.leaf?si(D,v,z):Gn(v,z,D);G>r||x.push({node:D,dist:G})}for(;x.length&&!x.peek().node.children;){A=x.pop();D=A.node;G=si(D,n,v);var P=si(D,z,t);if(A.dist<G&&A.dist<P&&Zj(v,D,w)&&Zj(z,D,w)){n=D;break a}}(C=
x.pop())&&(C=C.node)}n=null}(y=n)&&Math.min(ri(y,l),ri(y,h))<=p&&(m.push(e),m.push(Xj(y,e)),b.remove(y),d.remove(e),d.insert(qi(e)),d.insert(qi(e.next)))}e=k;y=[];do y.push(e.p),e=e.next;while(e!==k);return y.push(e.p),y}function Fn(b,c){return b.dist-c.dist}function Gn(b,c,e){if(ak(b,e)||ak(c,e))return 0;var k=rh(b[0],b[1],c[0],c[1],e.minX,e.minY,e.maxX,e.minY);if(0===k)return 0;var d=rh(b[0],b[1],c[0],c[1],e.minX,e.minY,e.minX,e.maxY);if(0===d)return 0;var f=rh(b[0],b[1],c[0],c[1],e.maxX,e.minY,
e.maxX,e.maxY);if(0===f)return 0;b=rh(b[0],b[1],c[0],c[1],e.minX,e.maxY,e.maxX,e.maxY);return 0===b?0:Math.min(k,d,f,b)}function ak(b,c){return b[0]>=c.minX&&b[0]<=c.maxX&&b[1]>=c.minY&&b[1]<=c.maxY}function Zj(b,c,e){var k,d,f,l;e=e.search({minX:Math.min(b[0],c[0]),minY:Math.min(b[1],c[1]),maxX:Math.max(b[0],c[0]),maxY:Math.max(b[1],c[1])});for(var h=0;h<e.length;h++)if(k=e[h].p,d=e[h].next.p,f=b,k!==(l=c)&&d!==f&&0<sh(k,d,f)!=0<sh(k,d,l)&&0<sh(f,l,k)!=0<sh(f,l,d))return!1;return!0}function qi(b){var c=
b.p,e=b.next.p;return b.minX=Math.min(c[0],e[0]),b.minY=Math.min(c[1],e[1]),b.maxX=Math.max(c[0],e[0]),b.maxY=Math.max(c[1],e[1]),b}function Xj(b,c){b={p:b,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return c?(b.next=c.next,b.prev=c,c.next.prev=b,c.next=b):(b.prev=b,b.next=b),b}function ri(b,c){var e=b[0]-c[0];b=b[1]-c[1];return e*e+b*b}function si(b,c,e){var k=c[0];c=c[1];var d=e[0]-k,f=e[1]-c;if(0!==d||0!==f){var l=((b[0]-k)*d+(b[1]-c)*f)/(d*d+f*f);1<l?(k=e[0],c=e[1]):0<l&&(k+=d*l,c+=f*l)}return(d=
b[0]-k)*d+(f=b[1]-c)*f}function rh(b,c,e,k,d,f,l,h){var m,p,n,r,v=e-b,z=k-c,t=l-d,y=h-f,C=b-d,w=c-f,x=v*v+z*z,A=v*t+z*y,D=t*t+y*y;v=v*C+z*w;y=t*C+y*w;w=t=C=x*D-A*A;0===C?(p=0,t=1,r=y,w=D):(r=x*y-A*v,0>(p=A*y-D*v)?(p=0,r=y,w=D):p>t&&(p=t,r=y+A,w=D));0>r?(r=0,0>-v?p=0:-v>x?p=t:(p=-v,t=x)):r>w&&(r=w,0>-v+A?p=0:-v+A>x?p=t:(p=-v+A,t=x));r=(1-(n=0===r?0:r/w))*d+n*l-((1-(m=0===p?0:p/t))*b+m*e);b=(1-n)*f+n*h-((1-m)*c+m*k);return r*r+b*b}function bk(b,c){void 0===c&&(c={});c.concavity=c.concavity||1/0;var e=
[];if(Ca(b,function(k){e.push([k[0],k[1]])}),!e.length)return null;b=ck(e,c.concavity);return 3<b.length?E([b]):null}function Tb(b,c,e){if(void 0===e&&(e={}),!b)throw Error("point is required");if(!c)throw Error("polygon is required");b=aa(b);var k=Ib(c),d=c.bbox;c=k.coordinates;if(d&&!1===(d[0]<=b[0]&&d[1]<=b[1]&&d[2]>=b[0]&&d[3]>=b[1]))return!1;"Polygon"===k.type&&(c=[c]);k=!1;for(d=0;d<c.length&&!k;d++)if(dk(b,c[d][0],e.ignoreBoundary)){for(var f=!1,l=1;l<c[d].length&&!f;)dk(b,c[d][l],!e.ignoreBoundary)&&
(f=!0),l++;f||(k=!0)}return k}function dk(b,c,e){var k=!1;c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]&&(c=c.slice(0,c.length-1));for(var d=0,f=c.length-1;d<c.length;f=d++){var l=c[d][0],h=c[d][1],m=c[f][0];f=c[f][1];if(0==b[1]*(l-m)+h*(m-b[0])+f*(b[0]-l)&&0>=(l-b[0])*(m-b[0])&&0>=(h-b[1])*(f-b[1]))return!e;h>b[1]!=f>b[1]&&b[0]<(m-l)*(b[1]-h)/(f-h)+l&&(k=!k)}return k}function ti(b,c){var e=[];return Sa(b,function(k){var d=!1;if("Point"===k.geometry.type)Zb(c,function(l){Tb(k,l)&&(d=!0)}),
d&&e.push(k);else{if("MultiPoint"!==k.geometry.type)throw Error("Input geometry must be a Point or MultiPoint");var f=[];Zb(c,function(l){Ca(k,function(h){Tb(h,l)&&(d=!0,f.push(h))})});d&&e.push(N(f))}}),J(e)}function Lb(b,c,e){void 0===e&&(e={});var k=aa(b),d=aa(c);c=ma(d[1]-k[1]);b=ma(d[0]-k[0]);k=ma(k[1]);d=ma(d[1]);c=Math.pow(Math.sin(c/2),2)+Math.pow(Math.sin(b/2),2)*Math.cos(k)*Math.cos(d);return ba(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),e.units)}function ek(b,c){var e=!1;return J(function(k){if(3>
k.length)return[];k.sort(Hn);var d,f=k.length-1,l=k[f].x;var h=k[0].x;for(var m=k[f].y,p=m;f--;)k[f].y<m&&(m=k[f].y),k[f].y>p&&(p=k[f].y);var n,r=h-l,v=p-m;f=r>v?r:v;l=.5*(h+l);m=.5*(p+m);m=[new fk({__sentinel:!0,x:l-20*f,y:m-f},{__sentinel:!0,x:l,y:m+20*f},{__sentinel:!0,x:l+20*f,y:m-f})];p=[];l=[];for(f=k.length;f--;){l.length=0;for(n=m.length;n--;)0<(r=k[f].x-m[n].x)&&r*r>m[n].r?(p.push(m[n]),m.splice(n,1)):r*r+(v=k[f].y-m[n].y)*v>m[n].r||(l.push(m[n].a,m[n].b,m[n].b,m[n].c,m[n].c,m[n].a),m.splice(n,
1));var z=h=void 0;var t=l;var y=t.length;a:for(;y;){n=t[--y];var C=t[--y];for(d=y;d;)if(h=t[--d],C===(z=t[--d])&&n===h||C===h&&n===z){t.splice(y,2);t.splice(d,2);y-=2;continue a}}for(n=l.length;n;)z=l[--n],h=l[--n],d=k[f],C=z.x-h.x,t=z.y-h.y,C=2*(C*(d.y-z.y)-t*(d.x-z.x)),1E-12<Math.abs(C)&&m.push(new fk(h,z,d))}Array.prototype.push.apply(p,m);for(f=p.length;f--;)(p[f].a.__sentinel||p[f].b.__sentinel||p[f].c.__sentinel)&&p.splice(f,1);return p}(b.features.map(function(k){var d={x:k.geometry.coordinates[0],
y:k.geometry.coordinates[1]};return c?d.z=k.properties[c]:3===k.geometry.coordinates.length&&(e=!0,d.z=k.geometry.coordinates[2]),d})).map(function(k){var d=[k.a.x,k.a.y],f=[k.b.x,k.b.y],l=[k.c.x,k.c.y],h={};return e?(d.push(k.a.z),f.push(k.b.z),l.push(k.c.z)):h={a:k.a.z,b:k.b.z,c:k.c.z},E([[d,f,l,d]],h)}))}function Hn(b,c){return c.x-b.x}function Dc(b){if(!b)throw Error("geojson is required");switch(b.type){case "Feature":return gk(b);case "FeatureCollection":return function(c){var e={type:"FeatureCollection"};
return Object.keys(c).forEach(function(k){switch(k){case "type":case "features":break;default:e[k]=c[k]}}),e.features=c.features.map(function(k){return gk(k)}),e}(b);case "Point":case "LineString":case "Polygon":case "MultiPoint":case "MultiLineString":case "MultiPolygon":case "GeometryCollection":return ui(b);default:throw Error("unknown GeoJSON type");}}function gk(b){var c={type:"Feature"};return Object.keys(b).forEach(function(e){switch(e){case "type":case "properties":case "geometry":break;default:c[e]=
b[e]}}),c.properties=hk(b.properties),c.geometry=ui(b.geometry),c}function hk(b){var c={};return b?(Object.keys(b).forEach(function(e){var k=b[e];"object"==typeof k?null===k?c[e]=null:Array.isArray(k)?c[e]=k.map(function(d){return d}):c[e]=hk(k):c[e]=k}),c):c}function ui(b){var c={type:b.type};return b.bbox&&(c.bbox=b.bbox),"GeometryCollection"===b.type?(c.geometries=b.geometries.map(function(e){return ui(e)}),c):(c.coordinates=ik(b.coordinates),c)}function ik(b){return"object"!=typeof b[0]?b.slice():
b.map(function(c){return ik(c)})}function In(b,c){if(void 0===c&&(c={}),!ta(c=c||{}))throw Error("options is invalid");c=c.mutate;if("FeatureCollection"!==qc(b))throw Error("geojson must be a FeatureCollection");if(!b.features.length)throw Error("geojson is empty");!1!==c&&void 0!==c||(b=Dc(b));var e=[];b=ca(b,function(k,d){a:{var f=k.geometry.coordinates;var l=d.geometry.coordinates,h=th(f[0]),m=th(f[f.length-1]),p=th(l[0]),n=th(l[l.length-1]);if(h===n)f=l.concat(f.slice(1));else if(p===m)f=f.concat(l.slice(1));
else if(h===p)f=f.slice(1).reverse().concat(l);else{if(m!==n){f=null;break a}f=f.concat(l.reverse().slice(1))}f=K(f)}return f||(e.push(k),d)});return b&&e.push(b),e.length?1===e.length?e[0]:H(e.map(function(k){return k.coordinates})):null}function th(b){return b[0].toString()+","+b[1].toString()}function Jn(b){return b}function jk(b,c){function e(m){return l(m)}function k(m){for(var p=[],n=0,r=m.length;n<r;++n){var v,z=m[n],t=p;t.length&&t.pop();var y=h[0>z?~z:z],C=0;for(v=y.length;C<v;++C)t.push(l(y[C],
C));if(0>z)for(z=t.length,y=z-v;y<--z;)v=t[y],t[y++]=t[z],t[z]=v}return 2>p.length&&p.push(p[0]),p}function d(m){for(m=k(m);4>m.length;)m.push(m[0]);return m}function f(m){return m.map(d)}var l=function(m){if(null==m)return Jn;var p,n,r=m.scale[0],v=m.scale[1],z=m.translate[0],t=m.translate[1];return function(y,C){C||(p=n=0);C=2;var w=y.length,x=Array(w);x[0]=(p+=y[0])*r+z;for(x[1]=(n+=y[1])*v+t;C<w;)x[C]=y[C],++C;return x}}(b.transform),h=b.arcs;return function n(p){var r=p.type;switch(r){case "GeometryCollection":return{type:r,
geometries:p.geometries.map(n)};case "Point":p=l(p.coordinates);break;case "MultiPoint":p=p.coordinates.map(e);break;case "LineString":p=k(p.arcs);break;case "MultiLineString":p=p.arcs.map(k);break;case "Polygon":p=f(p.arcs);break;case "MultiPolygon":p=p.arcs.map(f);break;default:return null}return{type:r,coordinates:p}}(c)}function Kn(b,c){function e(m,p){for(var n in m){var r=m[n];delete p[r.start];delete r.start;delete r.end;r.forEach(function(v){k[0>v?~v:v]=1});l.push(r)}}var k={},d={},f={},l=
[],h=-1;return c.forEach(function(m,p){var n,r=b.arcs[0>m?~m:m];3>r.length&&!r[1][0]&&!r[1][1]&&(n=c[++h],c[h]=m,c[p]=n)}),c.forEach(function(m){var p=function(v){var z,t=b.arcs[0>v?~v:v],y=t[0];b.transform?(z=[0,0],t.forEach(function(C){z[0]+=C[0];z[1]+=C[1]})):z=t[t.length-1];return 0>v?[z,y]:[y,z]}(m);var n=p[0],r=p[1];(p=f[n])?(delete f[p.end],p.push(m),p.end=r,m=d[r])?(delete d[m.start],n=m===p?p:p.concat(m),d[n.start=p.start]=f[n.end=m.end]=n):d[p.start]=f[p.end]=p:(p=d[r])?(delete d[p.start],
p.unshift(m),p.start=n,m=f[n])?(delete f[m.end],n=m===p?p:m.concat(p),d[n.start=m.start]=f[n.end=p.end]=n):d[p.start]=f[p.end]=p:d[(p=[m]).start=n]=f[p.end=r]=p}),e(f,d),e(d,f),c.forEach(function(m){k[0>m?~m:m]||l.push([m])}),l}function Ln(b,c){function e(h){h.forEach(function(m){m.forEach(function(p){(d[p=0>p?~p:p]||(d[p]=[])).push(h)})});f.push(h)}function k(h){h=jk(b,{type:"Polygon",arcs:[h]}).coordinates[0];for(var m,p=-1,n=h.length,r=h[n-1],v=0;++p<n;)m=r,r=h[p],v+=m[0]*r[1]-m[1]*r[0];return Math.abs(v)}
var d={},f=[],l=[];return c.forEach(function p(m){switch(m.type){case "GeometryCollection":m.geometries.forEach(p);break;case "Polygon":e(m.arcs);break;case "MultiPolygon":m.arcs.forEach(e)}}),f.forEach(function(m){if(!m._){var p=[],n=[m];m._=1;for(l.push(p);m=n.pop();)p.push(m),m.forEach(function(r){r.forEach(function(v){d[0>v?~v:v].forEach(function(z){z._||(z._=1,n.push(z))})})})}}),f.forEach(function(m){delete m._}),{type:"MultiPolygon",arcs:l.map(function(m){var p=[];if(m.forEach(function(t){t.forEach(function(y){y.forEach(function(C){2>
d[0>C?~C:C].length&&p.push(C)})})}),1<(m=(p=Kn(b,p)).length))for(var n,r,v=1,z=k(p[0]);v<m;++v)(n=k(p[v]))>z&&(r=p[0],p[0]=p[v],p[v]=r,z=n);return p}).filter(function(m){return 0<m.length})}}function vi(b,c,e,k,d,f){3===arguments.length&&(k=f=Array,d=null);for(var l=new k(b=1<<Math.max(4,Math.ceil(Math.log(b)/Math.LN2))),h=new f(b),m=b-1,p=0;p<b;++p)l[p]=d;return{set:function(n,r){for(var v=c(n)&m,z=l[v],t=0;z!=d;){if(e(z,n))return h[v]=r;if(++t>=b)throw Error("full hashmap");z=l[v=v+1&m]}return l[v]=
n,h[v]=r,r},maybeSet:function(n,r){for(var v=c(n)&m,z=l[v],t=0;z!=d;){if(e(z,n))return h[v];if(++t>=b)throw Error("full hashmap");z=l[v=v+1&m]}return l[v]=n,h[v]=r,r},get:function(n,r){for(var v=c(n)&m,z=l[v],t=0;z!=d;){if(e(z,n))return h[v];if(++t>=b)break;z=l[v=v+1&m]}return r},keys:function(){for(var n=[],r=0,v=l.length;r<v;++r){var z=l[r];z!=d&&n.push(z)}return n}}}function gf(b,c){return b[0]===c[0]&&b[1]===c[1]}function wi(b){kk[0]=b[0];kk[1]=b[1];b=uh[0]^uh[1];return 2147483647&(b<<5^b>>7^
uh[2]^uh[3])}function Mn(b){function c(A,D,G,P){if(p[G]!==A)if(p[G]=A,A=n[G],0<=A){var S=r[G];A===D&&S===P||A===P&&S===D||(++z,v[G]=1)}else n[G]=D,r[G]=P}function e(A){return wi(f[A])}function k(A,D){return gf(f[A],f[D])}var d,f=b.coordinates,l=b.lines,h=b.rings,m=function(){for(var A=vi(1.4*f.length,e,k,Int32Array,-1,Int32Array),D=new Int32Array(f.length),G=0,P=f.length;G<P;++G)D[G]=A.maybeSet(G,G);return D}(),p=new Int32Array(f.length),n=new Int32Array(f.length),r=new Int32Array(f.length),v=new Int8Array(f.length),
z=0;b=0;for(d=f.length;b<d;++b)p[b]=n[b]=r[b]=-1;b=0;for(d=l.length;b<d;++b){var t=l[b];var y=t[0],C=t[1];t=m[y];var w=m[++y];++z;for(v[t]=1;++y<=C;)c(b,t,t=w,w=m[y]);++z;v[w]=1}b=0;for(d=f.length;b<d;++b)p[b]=-1;b=0;for(d=h.length;b<d;++b)for(t=h[b],l=t[0]+1,y=t[1],c(b,m[y-1],t=m[l-1],w=m[l]);++l<=y;)c(b,t,t=w,w=m[l]);p=n=r=null;var x;h=function(A,D,G,P,S){3===arguments.length&&(P=Array,S=null);for(var V=new P(A=1<<Math.max(4,Math.ceil(Math.log(A)/Math.LN2))),Z=A-1,X=0;X<A;++X)V[X]=S;return{add:function(ea){for(var na=
D(ea)&Z,qa=V[na],ia=0;qa!=S;){if(G(qa,ea))return!0;if(++ia>=A)throw Error("full hashset");qa=V[na=na+1&Z]}return V[na]=ea,!0},has:function(ea){for(var na=D(ea)&Z,qa=V[na],ia=0;qa!=S;){if(G(qa,ea))return!0;if(++ia>=A)break;qa=V[na=na+1&Z]}return!1},values:function(){for(var ea=[],na=0,qa=V.length;na<qa;++na){var ia=V[na];ia!=S&&ea.push(ia)}return ea}}}(1.4*z,wi,gf);b=0;for(d=f.length;b<d;++b)v[x=m[b]]&&h.add(f[x]);return h}function xi(b,c,e){for(var k,d=c+(e-- -c>>1);c<d;++c,--e)k=b[c],b[c]=b[e],b[e]=
k}function Nn(b){var c,e,k={};for(c in b)k[c]=null==(e=b[c])?{type:null}:("FeatureCollection"===e.type?On:"Feature"===e.type?lk:yi)(e);return k}function On(b){var c={type:"GeometryCollection",geometries:b.features.map(lk)};return null!=b.bbox&&(c.bbox=b.bbox),c}function lk(b){var c,e=yi(b.geometry);for(c in null!=b.id&&(e.id=b.id),null!=b.bbox&&(e.bbox=b.bbox),b.properties){e.properties=b.properties;break}return e}function yi(b){if(null==b)return{type:null};var c="GeometryCollection"===b.type?{type:"GeometryCollection",
geometries:b.geometries.map(yi)}:"Point"===b.type||"MultiPoint"===b.type?{type:b.type,coordinates:b.coordinates}:{type:b.type,arcs:b.coordinates};return null!=b.bbox&&(c.bbox=b.bbox),c}function Pn(b,c){function e(r){r&&vh.call(p,r.type)&&p[r.type](r)}function k(r){var v=[];do{var z=m.get(r);v.push(r[0]<r[1]?z:~z)}while(r=r.next);return v}function d(r){return r.map(k)}var f=function(r){function v(P){null!=P&&vh.call(D,P.type)&&D[P.type](P)}function z(P){var S=P[0];P=P[1];S<C&&(C=S);S>x&&(x=S);P<w&&
(w=P);P>A&&(A=P)}function t(P){P.forEach(z)}function y(P){P.forEach(t)}var C=1/0,w=1/0,x=-1/0,A=-1/0,D={GeometryCollection:function(P){P.geometries.forEach(v)},Point:function(P){z(P.coordinates)},MultiPoint:function(P){P.coordinates.forEach(z)},LineString:function(P){t(P.arcs)},MultiLineString:function(P){P.arcs.forEach(t)},Polygon:function(P){P.arcs.forEach(t)},MultiPolygon:function(P){P.arcs.forEach(y)}},G;for(G in r)v(r[G]);return x>=C&&A>=w?[C,w,x,A]:void 0}(b=Nn(b));c=0<c&&f&&function(r,v,z){function t(ea){return[Math.round((ea[0]-
D)*S),Math.round((ea[1]-G)*V)]}function y(ea,na){for(var qa,ia,ra,ja,Ma=-1,Pa=0,Sb=ea.length,Qa=Array(Sb);++Ma<Sb;)qa=ea[Ma],ja=Math.round((qa[0]-D)*S),qa=Math.round((qa[1]-G)*V),ja===ia&&qa===ra||(Qa[Pa++]=[ia=ja,ra=qa]);for(Qa.length=Pa;Pa<na;)Pa=Qa.push([Qa[0][0],Qa[0][1]]);return Qa}function C(ea){return y(ea,2)}function w(ea){return y(ea,4)}function x(ea){return ea.map(w)}function A(ea){null!=ea&&vh.call(Z,ea.type)&&Z[ea.type](ea)}var D=v[0],G=v[1],P=v[2];v=v[3];var S=P-D?(z-1)/(P-D):1,V=v-G?
(z-1)/(v-G):1,Z={GeometryCollection:function(ea){ea.geometries.forEach(A)},Point:function(ea){ea.coordinates=t(ea.coordinates)},MultiPoint:function(ea){ea.coordinates=ea.coordinates.map(t)},LineString:function(ea){ea.arcs=C(ea.arcs)},MultiLineString:function(ea){ea.arcs=ea.arcs.map(C)},Polygon:function(ea){ea.arcs=x(ea.arcs)},MultiPolygon:function(ea){ea.arcs=ea.arcs.map(x)}},X;for(X in r)A(r[X]);return{scale:[1/S,1/V],translate:[D,G]}}(b,f,c);var l=function(r){function v(X){var ea,na,qa,ia;if(qa=
V.get(ea=A[X[0]])){var ra=0;for(ia=qa.length;ra<ia;++ra){a:{var ja=na=qa[ra];var Ma=ja[0];var Pa=X[0];ja=ja[1];if(Ma-ja!=Pa-X[1])Ma=!1;else{for(;Ma<=ja;++Ma,++Pa)if(!gf(A[Ma],A[Pa])){Ma=!1;break a}Ma=!0}}if(Ma)return X[0]=na[0],void(X[1]=na[1])}}if(Ma=V.get(na=A[X[1]]))for(ra=0,ia=Ma.length;ra<ia;++ra){a:{var Sb=Pa=Ma[ra];ja=Sb[0];Sb=Sb[1];var Qa=X[1];if(ja-Sb!=X[0]-Qa)ja=!1;else{for(;ja<=Sb;++ja,--Qa)if(!gf(A[ja],A[Qa])){ja=!1;break a}ja=!0}}if(ja)return X[1]=Pa[0],void(X[0]=Pa[1])}qa?qa.push(X):
V.set(ea,[X]);Ma?Ma.push(X):V.set(na,[X]);Z.push(X)}function z(X){var ea,na,qa,ia;if(na=V.get(A[X[0]])){var ra=0;for(ia=na.length;ra<ia;++ra){if(t(qa=na[ra],X))return X[0]=qa[0],void(X[1]=qa[1]);if(y(qa,X))return X[0]=qa[1],void(X[1]=qa[0])}}if(na=V.get(ea=A[X[0]+C(X)]))for(ra=0,ia=na.length;ra<ia;++ra){if(t(qa=na[ra],X))return X[0]=qa[0],void(X[1]=qa[1]);if(y(qa,X))return X[0]=qa[1],void(X[1]=qa[0])}na?na.push(X):V.set(ea,[X]);Z.push(X)}function t(X,ea){var na=X[0],qa=ea[0],ia=X[1]-na;if(ia!==ea[1]-
qa)return!1;X=C(X);ea=C(ea);for(var ra=0;ra<ia;++ra)if(!gf(A[na+(ra+X)%ia],A[qa+(ra+ea)%ia]))return!1;return!0}function y(X,ea){var na=X[0],qa=ea[1],ia=X[1]-na;if(ia!==qa-ea[0])return!1;X=C(X);ea=ia-C(ea);for(var ra=0;ra<ia;++ra)if(!gf(A[na+(ra+X)%ia],A[qa-(ra+ea)%ia]))return!1;return!0}function C(X){var ea=X[0];X=X[1];for(var na=ea,qa=na,ia=A[na];++na<X;){var ra=A[na];(ra[0]<ia[0]||ra[0]===ia[0]&&ra[1]<ia[1])&&(qa=na,ia=ra)}return qa-ea}var w,x,A=r.coordinates,D=r.lines,G=r.rings,P=D.length+G.length;
delete r.lines;delete r.rings;var S=0;for(x=D.length;S<x;++S)for(w=D[S];w=w.next;)++P;S=0;for(x=G.length;S<x;++S)for(w=G[S];w=w.next;)++P;var V=vi(2.8*P,wi,gf),Z=r.arcs=[];S=0;for(x=D.length;S<x;++S){w=D[S];do v(w);while(w=w.next)}S=0;for(x=G.length;S<x;++S)if((w=G[S]).next){do v(w);while(w=w.next)}else z(w);return r}(function(r){var v,z,t=Mn(r),y=r.coordinates,C=r.lines,w=r.rings;var x=0;for(z=C.length;x<z;++x)for(var A=C[x],D=A[0],G=A[1];++D<G;)t.has(y[D])&&(v={0:D,1:A[1]},A[1]=D,A=A.next=v);x=
0;for(z=w.length;x<z;++x){C=w[x];G=A=C[0];D=C[1];for(var P=t.has(y[A]);++G<D;)if(t.has(y[G]))if(P)v={0:G,1:C[1]},C[1]=G,C=C.next=v;else{v=y;P=A;var S=D;G=D-G;xi(v,P,S);xi(v,P,P+G);xi(v,P+G,S);y[D]=y[A];P=!0;G=A}}return r}(function(r){function v(P){P&&vh.call(D,P.type)&&D[P.type](P)}function z(P){for(var S=0,V=P.length;S<V;++S)A[++C]=P[S];P={0:C-V+1,1:C};return w.push(P),P}function t(P){for(var S=0,V=P.length;S<V;++S)A[++C]=P[S];P={0:C-V+1,1:C};return x.push(P),P}function y(P){return P.map(t)}var C=
-1,w=[],x=[],A=[],D={GeometryCollection:function(P){P.geometries.forEach(v)},LineString:function(P){P.arcs=z(P.arcs)},MultiLineString:function(P){P.arcs=P.arcs.map(z)},Polygon:function(P){P.arcs=P.arcs.map(t)},MultiPolygon:function(P){P.arcs=P.arcs.map(y)}},G;for(G in r)v(r[G]);return{type:"Topology",coordinates:A,lines:w,rings:x,objects:r}}(b))),h=l.coordinates,m=vi(1.4*l.arcs.length,Qn,Rn);b=l.objects;l.bbox=f;l.arcs=l.arcs.map(function(r,v){return m.set(r,v),h.slice(r[0],r[1]+1)});delete l.coordinates;
h=null;var p={GeometryCollection:function(r){r.geometries.forEach(e)},LineString:function(r){r.arcs=k(r.arcs)},MultiLineString:function(r){r.arcs=r.arcs.map(k)},Polygon:function(r){r.arcs=r.arcs.map(k)},MultiPolygon:function(r){r.arcs=r.arcs.map(d)}},n;for(n in b)e(b[n]);return c&&(l.transform=c,l.arcs=function(r){for(var v=-1,z=r.length;++v<z;){var t=r[v],y=0,C=1,w=t.length;var x=t[0];for(var A=x[0],D=x[1];++y<w;){var G=(x=t[y])[0];x=x[1];G===A&&x===D||(t[C++]=[G-A,x-D],A=G,D=x)}1===C&&(t[C++]=[0,
0]);t.length=C}return r}(l.arcs)),l}function Qn(b){var c,e=b[0];b=b[1];return b<e&&(c=e,e=b,b=c),e+31*b}function Rn(b,c){var e,k=b[0];b=b[1];var d=c[0];c=c[1];return b<k&&(e=k,k=b,b=e),c<d&&(e=d,d=c,c=e),k===d&&b===c}function Sn(b,c){if(void 0===c&&(c={}),"FeatureCollection"!==qc(b))throw Error("geojson must be a FeatureCollection");if(!b.features.length)throw Error("geojson is empty");!1!==c.mutate&&void 0!==c.mutate||(b=Dc(b));var e=[];Rb(b,function(k){e.push(k.geometry)});b=Pn({geoms:O(e).geometry});
return function(k){return jk(k,Ln.apply(this,arguments))}(b,b.objects.geoms.geometries)}function Tn(b,c){if(void 0===c&&(c={}),!ta(c=c||{}))throw Error("options is invalid");var e=c.mutate;if("FeatureCollection"!==qc(b))throw Error("geojson must be a FeatureCollection");if(!b.features.length)throw Error("geojson is empty");!1!==e&&void 0!==e||(b=Dc(b));e=function(k){var d={};Rb(k,function(f){d[f.geometry.type]=!0});k=Object.keys(d);return 1===k.length?k[0]:null}(b);if(!e)throw Error("geojson must be homogenous");
switch(e){case "LineString":return In(b,c);case "Polygon":return Sn(b,c);default:throw Error(e+" is not supported");}}function hf(b,c){void 0===c&&(c={});c="object"==typeof c?c.mutate:c;if(!b)throw Error("geojson is required");var e=qc(b),k=[];switch(e){case "LineString":k=zi(b);break;case "MultiLineString":case "Polygon":Y(b).forEach(function(f){k.push(zi(f))});break;case "MultiPolygon":Y(b).forEach(function(f){var l=[];f.forEach(function(h){l.push(zi(h))});k.push(l)});break;case "Point":return b;
case "MultiPoint":var d={};Y(b).forEach(function(f){var l=f.join("-");Object.prototype.hasOwnProperty.call(d,l)||(k.push(f),d[l]=!0)});break;default:throw Error(e+" geometry not supported");}return b.coordinates?!0===c?(b.coordinates=k,b):{type:e,coordinates:k}:!0===c?(b.geometry.coordinates=k,b):g({type:e,coordinates:k},b.properties,{bbox:b.bbox,id:b.id})}function zi(b){b=Y(b);if(2===b.length&&!mk(b[0],b[1]))return b;var c=[],e=b.length-1,k=c.length;c.push(b[0]);for(var d=1;d<e;d++){var f=c[c.length-
1];b[d][0]===f[0]&&b[d][1]===f[1]||(c.push(b[d]),2<(k=c.length)&&nk(c[k-3],c[k-1],c[k-2])&&c.splice(c.length-2,1))}if(c.push(b[b.length-1]),k=c.length,mk(b[0],b[b.length-1])&&4>k)throw Error("invalid polygon");return nk(c[k-3],c[k-1],c[k-2])&&c.splice(c.length-2,1),c}function mk(b,c){return b[0]===c[0]&&b[1]===c[1]}function nk(b,c,e){var k=e[0];e=e[1];var d=b[0];b=b[1];var f=c[0];c=c[1];var l=f-d,h=c-b;return 0===(k-d)*h-(e-b)*l&&(Math.abs(l)>=Math.abs(h)?0<l?d<=k&&k<=f:f<=k&&k<=d:0<h?b<=e&&e<=c:
c<=e&&e<=b)}function Ai(b,c,e,k,d){for(var f,l=k,h=c+1;h<e;h++){var m=b[h],p=b[c];var n=b[e];var r=p.x;p=p.y;var v=n.x-r,z=n.y-p;if(0!==v||0!==z){var t=((m.x-r)*v+(m.y-p)*z)/(v*v+z*z);1<t?(r=n.x,p=n.y):0<t&&(r+=v*t,p+=z*t)}n=(v=m.x-r)*v+(z=m.y-p)*z;n>l&&(f=h,l=n)}l>k&&(1<f-c&&Ai(b,c,f,k,d),d.push(b[f]),1<e-f&&Ai(b,f,e,k,d))}function Bi(b,c,e){if(2>=b.length)return b;c=void 0!==c?c*c:1;if(!e){for(var k,d,f,l=b[0],h=[l],m=1,p=b.length;m<p;m++)k=b[m],f=l,e=(d=k).x-f.x,d=d.y-f.y,e*e+d*d>c&&(h.push(k),
l=k);b=(l!==k&&h.push(k),h)}k=b.length-1;e=[b[0]];return Ai(b,0,k,c,e),e.push(b[k]),e}function ok(b,c,e){return Bi(b.map(function(k){return{x:k[0],y:k[1],z:k[2]}}),c,e).map(function(k){return k.z?[k.x,k.y,k.z]:[k.x,k.y]})}function pk(b,c,e){return b.map(function(k){k=k.map(function(f){return{x:f[0],y:f[1]}});if(4>k.length)throw Error("invalid polygon");for(var d=Bi(k,c,e).map(function(f){return[f.x,f.y]});3>d.length||3===d.length&&d[2][0]===d[0][0]&&d[2][1]===d[0][1];)d=Bi(k,c-=.01*c,e).map(function(f){return[f.x,
f.y]});return d[d.length-1][0]===d[0][0]&&d[d.length-1][1]===d[0][1]||d.push(d[0]),d})}function qk(b,c){void 0===c&&(c={});var e=c.resolution||1E4,k=c.sharpness||.85,d=[];b=Ib(b).coordinates.map(function(l){return{x:l[0],y:l[1]}});var f=new Un({duration:e,points:b,sharpness:k});e=function(l){var h=f.pos(l);0==Math.floor(l/100)%2&&d.push([h.x,h.y])};for(k=0;k<f.duration;k+=10)e(k);return e(f.duration),K(d,c.properties)}function Ci(b,c){void 0===c&&(c={});var e=Number(b[0]),k=Number(b[1]),d=Number(b[2]),
f=Number(b[3]);if(6===b.length)throw Error("@turf/bbox-polygon does not support BBox with 6 positions");var l=[e,k];return E([[l,[d,k],[d,f],[e,f],l]],c.properties,{bbox:b,id:c.id})}function rk(b){return Ci(ya(b))}function sk(b){var c=b[0],e=b[1],k=b[2],d=b[3];if(Lb(b.slice(0,2),[k,e])>=Lb(b.slice(0,2),[c,d]))return e=(e+d)/2,[c,e-(k-c)/2,k,e+(k-c)/2];c=(c+k)/2;return[c-(d-e)/2,e,c+(d-e)/2,d]}function je(b,c,e,k){void 0===k&&(k={});var d=aa(b);b=ma(d[0]);d=ma(d[1]);e=ma(e);c=fa(c,k.units);var f=Math.asin(Math.sin(d)*
Math.cos(c)+Math.cos(d)*Math.sin(c)*Math.cos(e));return u([ha(b+Math.atan2(Math.sin(e)*Math.sin(c)*Math.cos(d),Math.cos(c)-Math.sin(d)*Math.sin(f))),ha(f)],k.properties)}function Di(b,c,e){void 0===e&&(e={});for(var k=e.steps||64,d=e.properties?e.properties:!Array.isArray(b)&&"Feature"===b.type&&b.properties?b.properties:{},f=[],l=0;l<k;l++)f.push(je(b,c,-360*l/k,e).geometry.coordinates);return f.push(f[0]),E([f],d)}function Ae(b,c,e){if(void 0===e&&(e={}),!0===e.final)return(Ae(c,b)+180)%360;e=aa(b);
var k=aa(c);c=ma(e[0]);b=ma(k[0]);e=ma(e[1]);k=ma(k[1]);return ha(Math.atan2(Math.sin(b-c)*Math.cos(k),Math.cos(e)*Math.sin(k)-Math.sin(e)*Math.cos(k)*Math.cos(b-c)))}function wh(b,c){void 0===c&&(c={});b=ya(b);return u([(b[0]+b[2])/2,(b[1]+b[3])/2],c.properties,c)}function Ne(b,c){void 0===c&&(c={});var e=0,k=0,d=0;return Ca(b,function(f){e+=f[0];k+=f[1];d++},!0),u([e/d,k/d],c.properties)}function xh(b){var c=[];return"FeatureCollection"===b.type?Sa(b,function(e){Ca(e,function(k){c.push(u(k,e.properties))})}):
Ca(b,function(e){c.push(u(e,b.properties))}),J(c)}function yh(b,c,e){e=e||2;var k,d,f,l=c&&c.length,h=l?c[0]*e:b.length,m=tk(b,0,h,e,!0),p=[];if(!m)return p;if(l){l=e;var n,r=[];var v=0;for(n=c.length;v<n;v++){(k=tk(b,c[v]*l,v<n-1?c[v+1]*l:b.length,l,!1))===k.next&&(k.steiner=!0);var z=r,t=z.push,y=k,C=k;do y.x<C.x&&(C=y),y=y.next;while(y!==k);t.call(z,C)}r.sort(Vn);for(v=0;v<r.length;v++)Wn(r[v],m),m=qg(m,m.next)}if(b.length>80*e){var w=c=b[0];var x=k=b[1];for(l=e;l<h;l+=e)(d=b[l])<w&&(w=d),(f=b[l+
1])<x&&(x=f),d>c&&(c=d),f>k&&(k=f);var A=0!==(A=Math.max(c-w,k-x))?1/A:0}return rg(m,p,e,w,x,A),p}function tk(b,c,e,k,d){if(d===0<Ei(b,c,e,k))for(d=c;d<e;d+=k)var f=uk(d,b[d],b[d+1],f);else for(d=e-k;d>=c;d-=k)f=uk(d,b[d],b[d+1],f);return f&&jf(f,f.next)&&(sg(f),f=f.next),f}function qg(b,c){if(!b)return b;c||=b;var e=b;do if(b=!1,e.steiner||!jf(e,e.next)&&0!==Mc(e.prev,e,e.next))e=e.next;else{if(sg(e),(e=c=e.prev)===e.next)break;b=!0}while(b||e!==c);return c}function rg(b,c,e,k,d,f,l){if(b){if(!l&&
f){var h=b,m=h;do null===m.z&&(m.z=Fi(m.x,m.y,k,d,f)),m.prevZ=m.prev,m=m.nextZ=m.next;while(m!==h);m.prevZ.nextZ=null;m.prevZ=null;h=m;var p,n,r,v,z=1;do{m=h;var t=h=null;for(r=0;m;){r++;var y=m;for(p=v=0;p<z&&(v++,y=y.nextZ);p++);for(p=z;0<v||0<p&&y;)0!==v&&(0===p||!y||m.z<=y.z)?(n=m,m=m.nextZ,v--):(n=y,y=y.nextZ,p--),t?t.nextZ=n:h=n,n.prevZ=t,t=n;m=y}t.nextZ=null;z*=2}while(1<r)}for(m=b;b.prev!==b.next;){n=b.prev;h=b.next;if(f)a:{y=b;z=k;p=d;var C=f;t=y.prev;r=y.next;if(0<=Mc(t,y,r))y=!1;else{var w=
t.x>y.x?t.x>r.x?t.x:r.x:y.x>r.x?y.x:r.x,x=t.y>y.y?t.y>r.y?t.y:r.y:y.y>r.y?y.y:r.y;v=Fi(t.x<y.x?t.x<r.x?t.x:r.x:y.x<r.x?y.x:r.x,t.y<y.y?t.y<r.y?t.y:r.y:y.y<r.y?y.y:r.y,z,p,C);z=Fi(w,x,z,p,C);p=y.prevZ;for(C=y.nextZ;p&&p.z>=v&&C&&C.z<=z;){if(p!==y.prev&&p!==y.next&&Df(t.x,t.y,y.x,y.y,r.x,r.y,p.x,p.y)&&0<=Mc(p.prev,p,p.next)||(p=p.prevZ,C!==y.prev&&C!==y.next&&Df(t.x,t.y,y.x,y.y,r.x,r.y,C.x,C.y)&&0<=Mc(C.prev,C,C.next))){y=!1;break a}C=C.nextZ}for(;p&&p.z>=v;){if(p!==y.prev&&p!==y.next&&Df(t.x,t.y,y.x,
y.y,r.x,r.y,p.x,p.y)&&0<=Mc(p.prev,p,p.next)){y=!1;break a}p=p.prevZ}for(;C&&C.z<=z;){if(C!==y.prev&&C!==y.next&&Df(t.x,t.y,y.x,y.y,r.x,r.y,C.x,C.y)&&0<=Mc(C.prev,C,C.next)){y=!1;break a}C=C.nextZ}y=!0}}else a:if(y=b,t=y.prev,r=y.next,0<=Mc(t,y,r))y=!1;else{for(v=y.next.next;v!==y.prev;){if(Df(t.x,t.y,y.x,y.y,r.x,r.y,v.x,v.y)&&0<=Mc(v.prev,v,v.next)){y=!1;break a}v=v.next}y=!0}if(y)c.push(n.i/e),c.push(b.i/e),c.push(h.i/e),sg(b),m=b=h.next;else if((b=h)===m){if(l)if(1===l){l=rg;n=c;h=e;m=b;do y=m.prev,
t=m.next.next,!jf(y,t)&&vk(y,m,m.next,t)&&tg(y,t)&&tg(t,y)&&(n.push(y.i/h),n.push(m.i/h),n.push(t.i/h),sg(m),sg(m.next),m=b=t),m=m.next;while(m!==b);l(m,c,e,k,d,f,2)}else{if(2===l)a:{l=b;do{for(n=l.next.next;n!==l.prev;){if(l.i!==n.i&&Xn(l,n)){b=wk(l,n);l=qg(l,l.next);b=qg(b,b.next);rg(l,c,e,k,d,f);rg(b,c,e,k,d,f);break a}n=n.next}l=l.next}while(l!==b)}}else rg(qg(b),c,e,k,d,f,1);break}}}}function Vn(b,c){return b.x-c.x}function Wn(b,c){if(c=function(e,k){var d=k,f=e.x,l=e.y,h=-1/0;do{if(l<=d.y&&
l>=d.next.y&&d.next.y!==d.y){var m=d.x+(l-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(m<=f&&m>h){if(h=m,m===f){if(l===d.y)return d;if(l===d.next.y)return d.next}var p=d.x<d.next.x?d:d.next}}d=d.next}while(d!==k);if(!p)return null;if(f===h)return p.prev;var n;k=p;m=p.x;var r=p.y,v=1/0;for(d=p.next;d!==k;)f>=d.x&&d.x>=m&&f!==d.x&&Df(l<r?f:h,l,m,r,l<r?h:f,l,d.x,d.y)&&((n=Math.abs(l-d.y)/(f-d.x))<v||n===v&&d.x>p.x)&&tg(d,e)&&(p=d,v=n),d=d.next;return p}(b,c))b=wk(c,b),qg(b,b.next)}function Fi(b,c,e,k,d){return 1431655765&
((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-e)*d)|b<<8))|b<<4))|b<<2))|b<<1)|(1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-k)*d)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function Df(b,c,e,k,d,f,l,h){return 0<=(d-l)*(c-h)-(b-l)*(f-h)&&0<=(b-l)*(k-h)-(e-l)*(c-h)&&0<=(e-l)*(f-h)-(d-l)*(k-h)}function Xn(b,c){return b.next.i!==c.i&&b.prev.i!==c.i&&!function(e,k){var d=e;do{if(d.i!==e.i&&d.next.i!==e.i&&d.i!==k.i&&d.next.i!==k.i&&vk(d,d.next,e,k))return!0;d=d.next}while(d!==e);return!1}(b,
c)&&tg(b,c)&&tg(c,b)&&function(e,k){var d=e,f=!1,l=(e.x+k.x)/2;k=(e.y+k.y)/2;do d.y>k!=d.next.y>k&&d.next.y!==d.y&&l<(d.next.x-d.x)*(k-d.y)/(d.next.y-d.y)+d.x&&(f=!f),d=d.next;while(d!==e);return f}(b,c)}function Mc(b,c,e){return(c.y-b.y)*(e.x-c.x)-(c.x-b.x)*(e.y-c.y)}function jf(b,c){return b.x===c.x&&b.y===c.y}function vk(b,c,e,k){return!!(jf(b,c)&&jf(e,k)||jf(b,k)&&jf(e,c))||0<Mc(b,c,e)!=0<Mc(b,c,k)&&0<Mc(e,k,b)!=0<Mc(e,k,c)}function tg(b,c){return 0>Mc(b.prev,b,b.next)?0<=Mc(b,c,b.next)&&0<=Mc(b,
b.prev,c):0>Mc(b,c,b.prev)||0>Mc(b,b.next,c)}function wk(b,c){var e=new Gi(b.i,b.x,b.y),k=new Gi(c.i,c.x,c.y),d=b.next,f=c.prev;return b.next=c,c.prev=b,e.next=d,d.prev=e,k.next=e,e.prev=k,f.next=k,k.prev=f,k}function uk(b,c,e,k){b=new Gi(b,c,e);return k?(b.next=k.next,b.prev=k,k.next.prev=b,k.next=b):(b.prev=b,b.next=b),b}function sg(b){b.next.prev=b.prev;b.prev.next=b.next;b.prevZ&&(b.prevZ.nextZ=b.nextZ);b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function Gi(b,c,e){this.i=b;this.x=c;this.y=e;this.nextZ=
this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function Ei(b,c,e,k){for(var d=0,f=e-k;c<e;c+=k)d+=(b[f]-b[c])*(b[c+1]+b[f+1]),f=c;return d}function xk(b){var c=function(l){for(var h=l[0][0].length,m={vertices:[],holes:[],dimensions:h},p=0,n=0;n<l.length;n++){for(var r=0;r<l[n].length;r++)for(var v=0;v<h;v++)m.vertices.push(l[n][r][v]);0<n&&(p+=l[n-1].length,m.holes.push(p))}return m}(b),e=yk(c.vertices,c.holes,2);b=[];var k=[];e.forEach(function(l,h){l=e[h];k.push([c.vertices[2*l],c.vertices[2*
l+1]])});for(var d=0;d<k.length;d+=3){var f=k.slice(d,d+3);f.push(k[d]);b.push(E([f]))}return b}function zh(b,c){if(!b)throw Error("targetPoint is required");if(!c)throw Error("points is required");var e,k=1/0,d=0;return Sa(c,function(f,l){f=Lb(b,f);f<k&&(d=l,k=f)}),(e=Dc(c.features[d])).properties.featureIndex=d,e.properties.distanceToPoint=k,e}function kf(b){if(!b)throw Error("geojson is required");var c=[];return Rb(b,function(e){!function(k,d){var f=[],l=k.geometry;if(null!==l){switch(l.type){case "Polygon":f=
Y(l);break;case "LineString":f=[Y(l)]}f.forEach(function(h){(function(m,p){var n=[];return m.reduce(function(r,v){var z=K([r,v],p),t=r[0];r=r[1];var y=v[0],C=v[1];return z.bbox=[t<y?t:y,r<C?r:C,t>y?t:y,r>C?r:C],n.push(z),v}),n})(h,k.properties).forEach(function(m){m.id=d.length;d.push(m)})})}}(e,c)}),J(c)}function ug(b,c,e){if(null!==b){var k,d,f,l,h=0;var m=b.type;for(var p="FeatureCollection"===m,n="Feature"===m,r=p?b.features.length:1,v=0;v<r;v++){var z=(f=!!(d=p?b.features[v].geometry:n?b.geometry:
b)&&"GeometryCollection"===d.type)?d.geometries.length:1;for(var t=0;t<z;t++){var y=0,C=0;if(null!==(k=f?d.geometries[t]:d)){var w=k.coordinates;var x=k.type;switch(l=!e||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case "Point":if(!1===c(w,h,v,y,C))return!1;h++;break;case "LineString":case "MultiPoint":for(m=0;m<w.length;m++){if(!1===c(w[m],h,v,y,C))return!1;h++;"MultiPoint"===x&&y++}"LineString"===x&&y++;break;case "Polygon":case "MultiLineString":for(m=0;m<w.length;m++){for(k=0;k<w[m].length-
l;k++){if(!1===c(w[m][k],h,v,y,C))return!1;h++}"MultiLineString"===x&&y++;"Polygon"===x&&C++}"Polygon"===x&&y++;break;case "MultiPolygon":for(m=0;m<w.length;m++){for(k=C=0;k<w[m].length;k++){for(x=0;x<w[m][k].length-l;x++){if(!1===c(w[m][k][x],h,v,y,C))return!1;h++}C++}y++}break;case "GeometryCollection":for(m=0;m<k.geometries.length;m++)if(!1===ug(k.geometries[m],c,e))return!1;break;default:throw Error("Unknown Geometry Type");}}}}}}function zk(b,c){var e;switch(b.type){case "FeatureCollection":for(e=
0;e<b.features.length&&!1!==c(b.features[e].properties,e);e++);break;case "Feature":c(b.properties,0)}}function Ak(b,c){if("Feature"===b.type)c(b,0);else if("FeatureCollection"===b.type)for(var e=0;e<b.features.length&&!1!==c(b.features[e],e);e++);}function Hi(b,c){var e,k,d,f,l,h=0,m="FeatureCollection"===b.type,p="Feature"===b.type,n=m?b.features.length:1;for(e=0;e<n;e++){var r=m?b.features[e].geometry:p?b.geometry:b;var v=m?b.features[e].properties:p?b.properties:{};var z=m?b.features[e].bbox:
p?b.bbox:void 0;var t=m?b.features[e].id:p?b.id:void 0;var y=(l=!!r&&"GeometryCollection"===r.type)?r.geometries.length:1;for(d=0;d<y;d++)if(null!==(f=l?r.geometries[d]:r))switch(f.type){case "Point":case "LineString":case "MultiPoint":case "Polygon":case "MultiLineString":case "MultiPolygon":if(!1===c(f,h,v,z,t))return!1;break;case "GeometryCollection":for(k=0;k<f.geometries.length;k++)if(!1===c(f.geometries[k],h,v,z,t))return!1;break;default:throw Error("Unknown Geometry Type");}else if(!1===c(null,
h,v,z,t))return!1;h++}}function Ah(b,c){Hi(b,function(e,k,d,f,l){var h=null===e?null:e.type;switch(h){case null:case "Point":case "LineString":case "Polygon":return!1!==c(Ec.feature(e,d,{bbox:f,id:l}),k,0)&&void 0}switch(h){case "MultiPoint":var m="Point";break;case "MultiLineString":m="LineString";break;case "MultiPolygon":m="Polygon"}for(f=0;f<e.coordinates.length;f++)if(!1===c(Ec.feature({type:m,coordinates:e.coordinates[f]},d),k,f))return!1})}function Bk(b,c){Ah(b,function(e,k,d){var f=0;if(e.geometry){var l=
e.geometry.type;if("Point"!==l&&"MultiPoint"!==l){var h,m=0,p=0,n=0;return!1!==ug(e,function(r,v,z,t,y){if(void 0===h||k>m||t>p||y>n)return h=r,m=k,p=t,n=y,void(f=0);v=Ec.lineString([h,r],e.properties);if(!1===c(v,k,d,y,f))return!1;f++;h=r})&&void 0}}})}function Ck(b,c){if(!b)throw Error("geojson is required");Ah(b,function(e,k,d){if(null!==e.geometry){var f=e.geometry.coordinates;switch(e.geometry.type){case "LineString":if(!1===c(e,k,d,0,0))return!1;break;case "Polygon":for(var l=0;l<f.length;l++)if(!1===
c(Ec.lineString(f[l],e.properties),k,d,l))return!1}}})}function Ii(b){var c=[1/0,1/0,-1/0,-1/0];return Ji.coordEach(b,function(e){c[0]>e[0]&&(c[0]=e[0]);c[1]>e[1]&&(c[1]=e[1]);c[2]<e[0]&&(c[2]=e[0]);c[3]<e[1]&&(c[3]=e[1])}),c}function Dk(b){b=Uc(b);return b.insert=function(c){if("Feature"!==c.type)throw Error("invalid feature");return c.bbox=c.bbox?c.bbox:vg(c),Uc.prototype.insert.call(this,c)},b.load=function(c){var e=[];return Array.isArray(c)?c.forEach(function(k){if("Feature"!==k.type)throw Error("invalid features");
k.bbox=k.bbox?k.bbox:vg(k);e.push(k)}):Yn(c,function(k){if("Feature"!==k.type)throw Error("invalid features");k.bbox=k.bbox?k.bbox:vg(k);e.push(k)}),Uc.prototype.load.call(this,e)},b.remove=function(c,e){if("Feature"!==c.type)throw Error("invalid feature");return c.bbox=c.bbox?c.bbox:vg(c),Uc.prototype.remove.call(this,c,e)},b.clear=function(){return Uc.prototype.clear.call(this)},b.search=function(c){c=Uc.prototype.search.call(this,this.toBBox(c));return Ek(c)},b.collides=function(c){return Uc.prototype.collides.call(this,
this.toBBox(c))},b.all=function(){var c=Uc.prototype.all.call(this);return Ek(c)},b.toJSON=function(){return Uc.prototype.toJSON.call(this)},b.fromJSON=function(c){return Uc.prototype.fromJSON.call(this,c)},b.toBBox=function(c){if(c.bbox)c=c.bbox;else if(!Array.isArray(c)||4!==c.length)if(Array.isArray(c)&&6===c.length)c=[c[0],c[1],c[3],c[4]];else{if("Feature"!==c.type&&"FeatureCollection"!==c.type)throw Error("invalid geojson");c=vg(c)}return{minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]}},b}function ke(b,
c){var e={},k=[];if("LineString"===b.type&&(b=g(b)),"LineString"===c.type&&(c=g(c)),"Feature"===b.type&&"Feature"===c.type&&null!==b.geometry&&null!==c.geometry&&"LineString"===b.geometry.type&&"LineString"===c.geometry.type&&2===b.geometry.coordinates.length&&2===c.geometry.coordinates.length)return b=Fk(b,c),b&&k.push(b),J(k);var d=wg();return d.load(kf(c)),Sa(kf(b),function(f){Sa(d.search(f),function(l){if(l=Fk(f,l)){var h=Y(l).join(",");e[h]||(e[h]=!0,k.push(l))}})}),J(k)}function Fk(b,c){var e=
Y(b),k=Y(c);if(2!==e.length)throw Error("<intersects> line1 must only contain 2 coordinates");if(2!==k.length)throw Error("<intersects> line2 must only contain 2 coordinates");c=e[0][0];b=e[0][1];var d=e[1][0];e=e[1][1];var f=k[0][0],l=k[0][1],h=k[1][0],m=k[1][1];k=(m-l)*(d-c)-(h-f)*(e-b);if(0===k)return null;h=((h-f)*(b-l)-(m-l)*(c-f))/k;f=((d-c)*(b-l)-(e-b)*(c-f))/k;return 0<=h&&1>=h&&0<=f&&1>=f?u([c+h*(d-c),b+h*(e-b)]):null}function Be(b,c,e){void 0===e&&(e={});var k=u([1/0,1/0],{dist:1/0}),d=
0;return Rb(b,function(f){f=Y(f);for(var l=0;l<f.length-1;l++){var h=u(f[l]);h.properties.dist=Lb(c,h,e);var m=u(f[l+1]);m.properties.dist=Lb(c,m,e);var p=Lb(h,m,e),n=Math.max(h.properties.dist,m.properties.dist),r=Ae(h,m),v=je(c,n,r+90,e);n=je(c,n,r-90,e);v=ke(K([v.geometry.coordinates,n.geometry.coordinates]),K([h.geometry.coordinates,m.geometry.coordinates]));n=null;0<v.features.length&&((n=v.features[0]).properties.dist=Lb(c,n,e),n.properties.location=d+Lb(h,n,e));h.properties.dist<k.properties.dist&&
((k=h).properties.index=l,k.properties.location=d);m.properties.dist<k.properties.dist&&((k=m).properties.index=l+1,k.properties.location=d+p);n&&n.properties.dist<k.properties.dist&&((k=n).properties.index=l);d+=p}}),k}function Bh(b,c,e){void 0===e&&(e={});var k=aa(b),d=aa(c);d[0]+=180<d[0]-k[0]?-360:180<k[0]-d[0]?360:0;b=k[1]*Math.PI/180;var f=d[1]*Math.PI/180;c=f-b;k=Math.abs(d[0]-k[0])*Math.PI/180;k>Math.PI&&(k-=2*Math.PI);f=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(b/2+Math.PI/4));b=1E-11<Math.abs(f)?
c/f:Math.cos(b);return ka(6371008.8*Math.sqrt(c*c+b*b*k*k),"meters",e.units)}function Gk(b,c,e){if(void 0===e&&(e={}),e.method||(e.method="geodesic"),e.units||(e.units="kilometers"),!b)throw Error("pt is required");if(Array.isArray(b)?b=u(b):"Point"===b.type?b=g(b):Ob(b,"Point","point"),!c)throw Error("line is required");Array.isArray(c)?c=K(c):"LineString"===c.type?c=g(c):Ob(c,"LineString","line");var k=1/0,d=b.geometry.coordinates;return L(c,function(f){var l=f.geometry.coordinates[0];var h=f.geometry.coordinates[1];
f=e;var m=[h[0]-l[0],h[1]-l[1]];var p=[d[0]-l[0],d[1]-l[1]];p=p[0]*m[0]+p[1]*m[1];if(0>=p)l=Ki(d,l,{method:f.method,units:"degrees"});else{var n=m[0]*m[0]+m[1]*m[1];n<=p?l=Ki(d,h,{method:f.method,units:"degrees"}):(h=p/n,l=Ki(d,[l[0]+h*m[0],l[1]+h*m[1]],{method:f.method,units:"degrees"}))}l<k&&(k=l)}),ka(k,"degrees",e.units)}function Ki(b,c,e){return"planar"===e.method?Bh(b,c,e):Lb(b,c,e)}function Hk(b){b="FeatureCollection"!==b.type?"Feature"!==b.type?J([g(b)]):J([b]):b;for(var c=wh(b),e=!1,k=0;!e&&
k<b.features.length;){var d,f=b.features[k].geometry,l=!1;if("Point"===f.type)c.geometry.coordinates[0]===f.coordinates[0]&&c.geometry.coordinates[1]===f.coordinates[1]&&(e=!0);else if("MultiPoint"===f.type)for(l=!1,d=0;!l&&d<f.coordinates.length;)c.geometry.coordinates[0]===f.coordinates[d][0]&&c.geometry.coordinates[1]===f.coordinates[d][1]&&(e=!0,l=!0),d++;else if("LineString"===f.type)for(d=0;!l&&d<f.coordinates.length-1;)Ik(c.geometry.coordinates[0],c.geometry.coordinates[1],f.coordinates[d][0],
f.coordinates[d][1],f.coordinates[d+1][0],f.coordinates[d+1][1])&&(l=!0,e=!0),d++;else if("MultiLineString"===f.type)for(var h=0;h<f.coordinates.length;){l=!1;d=0;for(var m=f.coordinates[h];!l&&d<m.length-1;)Ik(c.geometry.coordinates[0],c.geometry.coordinates[1],m[d][0],m[d][1],m[d+1][0],m[d+1][1])&&(l=!0,e=!0),d++;h++}else"Polygon"!==f.type&&"MultiPolygon"!==f.type||Tb(c,f)&&(e=!0);k++}if(e)return c;e=J([]);for(k=0;k<b.features.length;k++)e.features=e.features.concat(xh(b.features[k]).features);
return u(zh(c,e).geometry.coordinates)}function Ik(b,c,e,k,d,f){return Math.sqrt((d-e)*(d-e)+(f-k)*(f-k))===Math.sqrt((b-e)*(b-e)+(c-k)*(c-k))+Math.sqrt((d-b)*(d-b)+(f-c)*(f-c))}function Li(b){return pd(b,function(c,e){a:{var k,d=0;switch(e.type){case "Polygon":e=Jk(e.coordinates);break a;case "MultiPolygon":for(k=0;k<e.coordinates.length;k++)d+=Jk(e.coordinates[k]);e=d;break a}e=0}return c+e},0)}function Jk(b){var c=0;if(b&&0<b.length){c+=Math.abs(Kk(b[0]));for(var e=1;e<b.length;e++)c-=Math.abs(Kk(b[e]))}return c}
function Kk(b){var c,e,k,d,f=0,l=b.length;if(2<l){for(d=0;d<l;d++){d===l-2?(c=l-2,e=l-1,k=0):d===l-1?(c=l-1,e=0,k=1):(c=d,e=d+1,k=d+2);var h=b[c];var m=b[e];f+=(b[k][0]*Math.PI/180-h[0]*Math.PI/180)*Math.sin(m[1]*Math.PI/180)}f=40680631590769*f/2}return f}function Mi(b,c){return void 0===c&&(c={}),M(b,function(e,k){k=k.geometry.coordinates;return e+Lb(k[0],k[1],c)},0)}function Lk(b,c,e,k){if(!ta(k=k||{}))throw Error("options is invalid");var d=[];if("Feature"===b.type)b=b.geometry.coordinates;else{if("LineString"!==
b.type)throw Error("input must be a LineString Feature or Geometry");b=b.coordinates}for(var f,l,h,m=b.length,p=0,n=0;n<b.length&&!(c>=p&&n===b.length-1);n++){if(p>c&&0===d.length){if(!(f=c-p))return d.push(b[n]),K(d);l=Ae(b[n],b[n-1])-180;h=je(b[n],f,l,k);d.push(h.geometry.coordinates)}if(p>=e)return(f=e-p)?(l=Ae(b[n],b[n-1])-180,h=je(b[n],f,l,k),d.push(h.geometry.coordinates),K(d)):(d.push(b[n]),K(d));if(p>=c&&d.push(b[n]),n===b.length-1)return K(d);p+=Lb(b[n],b[n+1],k)}if(p<c&&b.length===m)throw Error("Start position is beyond line");
c=b[b.length-1];return K([c,c])}function hd(b,c,e){void 0===e&&(e={});b=aa(b);c=Y(c);for(var k=0;k<c.length-1;k++){var d=!1;e.ignoreEndVertices&&(0===k&&(d="start"),k===c.length-2&&(d="end"),0===k&&k+1===c.length-1&&(d="both"));a:{var f=c[k],l=c[k+1],h=void 0===e.epsilon?null:e.epsilon,m=b[0],p=b[1],n=f[0];f=f[1];var r=l[0];l=l[1];var v=r-n,z=l-f,t=(b[0]-n)*z-(b[1]-f)*v;if(null!==h){if(Math.abs(t)>h){d=!1;break a}}else if(0!==t){d=!1;break a}d=d?"start"===d?Math.abs(v)>=Math.abs(z)?0<v?n<m&&m<=r:
r<=m&&m<n:0<z?f<p&&p<=l:l<=p&&p<f:"end"===d?Math.abs(v)>=Math.abs(z)?0<v?n<=m&&m<r:r<m&&m<=n:0<z?f<=p&&p<l:l<p&&p<=f:"both"===d&&(Math.abs(v)>=Math.abs(z)?0<v?n<m&&m<r:r<m&&m<n:0<z?f<p&&p<l:l<p&&p<f):Math.abs(v)>=Math.abs(z)?0<v?n<=m&&m<=r:r<=m&&m<=n:0<z?f<=p&&p<=l:l<=p&&p<=f}if(d)return!0}return!1}function Mk(b,c){b=Ib(b);c=Ib(c);var e=b.type,k=c.type;switch(e){case "Point":switch(k){case "MultiPoint":return function(d,f){var l,h=!1;for(l=0;l<f.coordinates.length;l++)if(Nk(f.coordinates[l],d.coordinates)){h=
!0;break}return h}(b,c);case "LineString":return hd(b,c,{ignoreEndVertices:!0});case "Polygon":case "MultiPolygon":return Tb(b,c,{ignoreBoundary:!0});default:throw Error("feature2 "+k+" geometry not supported");}case "MultiPoint":switch(k){case "MultiPoint":return function(d,f){for(var l=0;l<d.coordinates.length;l++){for(var h=!1,m=0;m<f.coordinates.length;m++)Nk(d.coordinates[l],f.coordinates[m])&&(h=!0);if(!h)return!1}return!0}(b,c);case "LineString":return function(d,f){for(var l=!1,h=0;h<d.coordinates.length;h++){if(!hd(d.coordinates[h],
f))return!1;l||=hd(d.coordinates[h],f,{ignoreEndVertices:!0})}return l}(b,c);case "Polygon":case "MultiPolygon":return function(d,f){for(var l=!0,h=!1,m=0;m<d.coordinates.length;m++){if(!(h=Tb(d.coordinates[1],f))){l=!1;break}h=Tb(d.coordinates[1],f,{ignoreBoundary:!0})}return l&&h}(b,c);default:throw Error("feature2 "+k+" geometry not supported");}case "LineString":switch(k){case "LineString":return function(d,f){for(var l=0;l<d.coordinates.length;l++)if(!hd(d.coordinates[l],f))return!1;return!0}(b,
c);case "Polygon":case "MultiPolygon":return function(d,f){var l=ya(f),h=ya(d);if(!Ok(l,h))return!1;h=!1;for(l=0;l<d.coordinates.length-1;l++){if(!Tb(d.coordinates[l],f))return!1;if(h||=Tb(d.coordinates[l],f,{ignoreBoundary:!0}),!h){h=d.coordinates[l];var m=d.coordinates[l+1];h=Tb([(h[0]+m[0])/2,(h[1]+m[1])/2],f,{ignoreBoundary:!0})}}return h}(b,c);default:throw Error("feature2 "+k+" geometry not supported");}case "Polygon":switch(k){case "Polygon":case "MultiPolygon":return function(d,f){var l=ya(d);
if(!Ok(ya(f),l))return!1;for(l=0;l<d.coordinates[0].length;l++)if(!Tb(d.coordinates[0][l],f))return!1;return!0}(b,c);default:throw Error("feature2 "+k+" geometry not supported");}default:throw Error("feature1 "+e+" geometry not supported");}}function Ok(b,c){return!(b[0]>c[0])&&!(b[2]<c[2])&&!(b[1]>c[1])&&!(b[3]<c[3])}function Nk(b,c){return b[0]===c[0]&&b[1]===c[1]}function Pk(b,c,e){void 0===e&&(e={});e.mask&&!e.units&&(e.units="kilometers");var k=[],d=b[0],f=b[1],l=b[2];b=b[3];var h=c/Lb([d,f],
[l,f],e)*(l-d);c=c/Lb([d,f],[d,b],e)*(b-f);var m=l-d,p=b-f;p=(p-Math.floor(p/c)*c)/2;for(d+=(m-Math.floor(m/h)*h)/2;d<=l;){for(m=f+p;m<=b;){var n=u([d,m],e.properties);e.mask?Mk(n,e.mask)&&k.push(n):k.push(n);m+=c}d+=h}return J(k)}function Qk(b,c){void 0===c&&(c={});var e=c.precision,k=c.coordinates;c=c.mutate;if(e=null==e||isNaN(e)?6:e,k=null==k||isNaN(k)?3:k,!b)throw Error("<geojson> is required");if("number"!=typeof e)throw Error("<precision> must be a number");if("number"!=typeof k)throw Error("<coordinates> must be a number");
!1!==c&&void 0!==c||(b=JSON.parse(JSON.stringify(b)));var d=Math.pow(10,e);return Ca(b,function(f){f.length>k&&f.splice(k,f.length);for(var l=0;l<f.length;l++)f[l]=Math.round(f[l]*d)/d;!0}),b}function Ni(b){if(!b)throw Error("geojson is required");var c=[];return Rb(b,function(e){c.push(e)}),J(c)}function Zn(b,c,e){function k(v,z,t,y){var C,w,x=f[v][z],A=f[v][z+1],D=f[t][y],G=f[t][y+1];if(xg(x,D)||xg(x,G)||xg(A,D)||xg(G,D))var P=null;else{P=x[0];var S=x[1],V=A[0],Z=A[1],X=D[0],ea=D[1],na=G[0],qa=
G[1],ia=(P-V)*(ea-qa)-(S-Z)*(X-na);P=0===ia?null:[((P*Z-S*V)*(X-na)-(P-V)*(X*qa-ea*na))/ia,((P*Z-S*V)*(ea-qa)-(S-Z)*(X*qa-ea*na))/ia]}null===P||(C=A[0]!==x[0]?(P[0]-x[0])/(A[0]-x[0]):(P[1]-x[1])/(A[1]-x[1]),w=G[0]!==D[0]?(P[0]-D[0])/(G[0]-D[0]):(P[1]-D[1])/(G[1]-D[1]),1<=C||0>=C||1<=w||0>=w)||(S=P,(V=!h[S])&&(h[S]=!0),c?l.push(c(P,v,z,x,A,C,t,y,D,G,w,V)):l.push(P))}function d(v,z){var t,y,C,w,x=f[v][z],A=f[v][z+1];return x[0]<A[0]?(t=x[0],y=A[0]):(t=A[0],y=x[0]),x[1]<A[1]?(C=x[1],w=A[1]):(C=A[1],
w=x[1]),{minX:t,minY:C,maxX:y,maxY:w,ring:v,edge:z}}if("Polygon"!==b.geometry.type)throw Error("The input feature must be a Polygon");void 0===e&&(e=1);var f=b.geometry.coordinates,l=[],h={};if(e){b=[];for(var m=0;m<f.length;m++)for(var p=0;p<f[m].length-1;p++)b.push(d(m,p));m=Uc();m.load(b)}for(var n=0;n<f.length;n++)for(var r=0;r<f[n].length-1;r++)if(e)m.search(d(n,r)).forEach(function(v){k(n,r,v.ring,v.edge)});else for(b=0;b<f.length;b++)for(p=0;p<f[b].length-1;p++)k(n,r,b,p);return c||(l={type:"Feature",
geometry:{type:"MultiPoint",coordinates:l}}),l}function xg(b,c){if(!b||!c||b.length!==c.length)return!1;for(var e=0,k=b.length;e<k;e++)if(b[e]instanceof Array&&c[e]instanceof Array){if(!xg(b[e],c[e]))return!1}else if(b[e]!==c[e])return!1;return!0}function $n(b){function c(){for(var w=[],x=0;x<r.features.length;x++)-1==r.features[x].properties.parent&&w.push(x);if(1<w.length)for(x=0;x<w.length;x++){for(var A=-1,D=0;D<r.features.length;D++)w[x]!=D&&Tb(r.features[w[x]].geometry.coordinates[0][0],r.features[D],
{ignoreBoundary:!0})&&Infinity>Li(r.features[D])&&(A=D);r.features[w[x]].properties.parent=A}}function e(){for(var w=0;w<r.features.length;w++)if(-1==r.features[w].properties.parent){var x=r.features[w].properties.winding;r.features[w].properties.netWinding=x;k(w,x)}}function k(w,x){for(var A=0;A<r.features.length;A++)if(r.features[A].properties.parent==w){var D=x+r.features[A].properties.winding;r.features[A].properties.netWinding=D;k(A,D)}}if("Feature"!=b.type)throw Error("The input must a geojson object of type Feature");
if(void 0===b.geometry||null==b.geometry)throw Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=b.geometry.type)throw Error("The input must be a geojson Polygon");for(var d=b.geometry.coordinates.length,f=[],l=0;l<d;l++){var h=b.geometry.coordinates[l];yg(h[0],h[h.length-1])||h.push(h[0]);f.push.apply(f,h.slice(0,h.length-1))}if(!function(w){for(var x={},A=1,D=0,G=w.length;D<G;++D){if(Object.prototype.hasOwnProperty.call(x,w[D])){A=0;break}x[w[D]]=1}return A}(f))throw Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");
f=f.length;var m=Zn(b,function(w,x,A,D,G,P,S,V,Z,X,ea,na){return[w,x,A,D,G,P,S,V,Z,X,ea,na]}),p=m.length;if(0==p){var n=[];for(l=0;l<d;l++)n.push(E([b.geometry.coordinates[l]],{parent:-1,winding:ao(b.geometry.coordinates[l])}));var r=J(n);return c(),e(),r}var v=[],z=[];for(l=0;l<d;l++)for(v.push([]),h=0;h<b.geometry.coordinates[l].length-1;h++)v[l].push([new Rk(b.geometry.coordinates[l][Ef(h+1,b.geometry.coordinates[l].length-1)],1,[l,h],[l,Ef(h+1,b.geometry.coordinates[l].length-1)],void 0)]),z.push(new Sk(b.geometry.coordinates[l][h],
[l,Ef(h-1,b.geometry.coordinates[l].length-1)],[l,h],void 0,void 0,!1,!0));for(l=0;l<p;l++)v[m[l][1]][m[l][2]].push(new Rk(m[l][0],m[l][5],[m[l][1],m[l][2]],[m[l][6],m[l][7]],void 0)),m[l][11]&&z.push(new Sk(m[l][0],[m[l][1],m[l][2]],[m[l][6],m[l][7]],void 0,void 0,!0,!0));m=z.length;for(l=0;l<v.length;l++)for(h=0;h<v[l].length;h++)v[l][h].sort(function(w,x){return w.param<x.param?-1:1});h=[];for(l=0;l<m;l++)h.push({minX:z[l].coord[0],minY:z[l].coord[1],maxX:z[l].coord[0],maxY:z[l].coord[1],index:l});
p=Uc();p.load(h);for(l=0;l<v.length;l++)for(h=0;h<v[l].length;h++)for(m=0;m<v[l][h].length;m++)t=m==v[l][h].length-1?v[l][Ef(h+1,b.geometry.coordinates[l].length-1)][0].coord:v[l][h][m+1].coord,t=p.search({minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]})[0],v[l][h][m].nxtIsectAlongEdgeIn=t.index;for(l=0;l<v.length;l++)for(h=0;h<v[l].length;h++)for(m=0;m<v[l][h].length;m++){var t=v[l][h][m].coord,y=(t=p.search({minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]})[0]).index;y<f?z[y].nxtIsectAlongRingAndEdge2=v[l][h][m].nxtIsectAlongEdgeIn:
yg(z[y].ringAndEdge1,v[l][h][m].ringAndEdgeIn)?z[y].nxtIsectAlongRingAndEdge1=v[l][h][m].nxtIsectAlongEdgeIn:z[y].nxtIsectAlongRingAndEdge2=v[l][h][m].nxtIsectAlongEdgeIn}f=[];for(h=l=0;h<d;h++){v=l;for(m=0;m<b.geometry.coordinates[h].length-1;m++)z[l].coord[0]<z[v].coord[0]&&(v=l),l++;p=z[v].nxtIsectAlongRingAndEdge2;for(m=0;m<z.length;m++)if(z[m].nxtIsectAlongRingAndEdge1==v||z[m].nxtIsectAlongRingAndEdge2==v){n=m;break}m=Ch([z[n].coord,z[v].coord,z[p].coord],!0)?1:-1;f.push({isect:v,parent:-1,
winding:m})}f.sort(function(w,x){return z[w.isect].coord>z[x.isect].coord?-1:1});for(n=[];0<f.length;){l=f.pop();b=l.isect;d=l.parent;h=l.winding;v=n.length;m=[z[b].coord];p=b;z[b].ringAndEdge1Walkable?(t=z[b].ringAndEdge1,y=z[b].nxtIsectAlongRingAndEdge1):(t=z[b].ringAndEdge2,y=z[b].nxtIsectAlongRingAndEdge2);for(;!yg(z[b].coord,z[y].coord);){m.push(z[y].coord);var C=void 0;for(l=0;l<f.length;l++)if(f[l].isect==y){C=l;break}if(null!=C&&f.splice(C,1),yg(t,z[y].ringAndEdge1)){if(t=z[y].ringAndEdge2,
z[y].ringAndEdge2Walkable=!1,z[y].ringAndEdge1Walkable)l={isect:y},Ch([z[p].coord,z[y].coord,z[z[y].nxtIsectAlongRingAndEdge2].coord],1==h)?(l.parent=d,l.winding=-h):(l.parent=v,l.winding=h),f.push(l);p=y;y=z[y].nxtIsectAlongRingAndEdge2}else{if(t=z[y].ringAndEdge1,z[y].ringAndEdge1Walkable=!1,z[y].ringAndEdge2Walkable)l={isect:y},Ch([z[p].coord,z[y].coord,z[z[y].nxtIsectAlongRingAndEdge1].coord],1==h)?(l.parent=d,l.winding=-h):(l.parent=v,l.winding=h),f.push(l);p=y;y=z[y].nxtIsectAlongRingAndEdge1}}m.push(z[y].coord);
n.push(E([m],{index:v,parent:d,winding:h,netWinding:void 0}))}r=J(n);return c(),e(),r}function Ch(b,c){if(void 0===c&&(c=!0),3!=b.length)throw Error("This function requires an array of three points [x,y]");return 0<=(b[1][0]-b[0][0])*(b[2][1]-b[0][1])-(b[1][1]-b[0][1])*(b[2][0]-b[0][0])==c}function ao(b){for(var c=0,e=0;e<b.length-1;e++)b[e][0]<b[c][0]&&(c=e);return Ch([b[Ef(c-1,b.length-1)],b[c],b[Ef(c+1,b.length-1)]],!0)?1:-1}function yg(b,c){if(!b||!c||b.length!=c.length)return!1;for(var e=0,k=
b.length;e<k;e++)if(b[e]instanceof Array&&c[e]instanceof Array){if(!yg(b[e],c[e]))return!1}else if(b[e]!=c[e])return!1;return!0}function Ef(b,c){return(b%c+c)%c}function Tk(b,c){var e=[],k=wg();return Rb(c,function(d){if(e.forEach(function(h,m){h.id=m}),e.length){var f=k.search(d);if(f.features.length){var l=Uk(d,f);e=e.filter(function(h){return h.id!==l.id});k.remove(l);Sa(Oi(l,d),function(h){e.push(h);k.insert(h)})}}else(e=Oi(b,d).features).forEach(function(h){h.bbox||(h.bbox=sk(ya(h)))}),k.load(J(e))}),
J(e)}function Oi(b,c){var e=[],k=Y(b)[0],d=Y(b)[b.geometry.coordinates.length-1];if(Pi(k,aa(c))||Pi(d,aa(c)))return J([b]);var f=wg();d=kf(b);f.load(d);f=f.search(c);if(!f.features.length)return J([b]);var l=Uk(c,f);b=Ya(d,function(h,m,p){m=Y(m)[1];var n=aa(c);return p===l.id?(h.push(n),e.push(K(h)),Pi(n,m)?[n]:[n,m]):(h.push(m),h)},[k]);return 1<b.length&&e.push(K(b)),J(e)}function Uk(b,c){if(!c.features.length)throw Error("lines must contain features");if(1===c.features.length)return c.features[0];
var e,k=1/0;return Sa(c,function(d){var f=Be(d,b).properties.dist;f<k&&(e=d,k=f)}),e}function Pi(b,c){return b[0]===c[0]&&b[1]===c[1]}function Vk(b,c,e,k,d){void 0===d&&(d={});var f=d.steps||64;e=Wk(e);var l=Wk(k);k=Array.isArray(b)||"Feature"!==b.type?{}:b.properties;if(e===l)return K(Di(b,c,d).geometry.coordinates[0],k);l=e<l?l:l+360;for(var h=e,m=[],p=0;h<l;)m.push(je(b,c,h,d).geometry.coordinates),h=e+360*++p/f;return h>l&&m.push(je(b,c,l,d).geometry.coordinates),K(m,k)}function Wk(b){b%=360;
return 0>b&&(b+=360),b}function zg(b,c){void 0===c&&(c={});var e=Ib(b);switch(c.properties||"Feature"!==b.type||(c.properties=b.properties),e.type){case "Polygon":return Qi(e,c);case "MultiPolygon":return function(k,d){void 0===d&&(d={});var f=Ib(k).coordinates,l=d.properties?d.properties:"Feature"===k.type?k.properties:{},h=[];return f.forEach(function(m){h.push(Xk(m,l))}),J(h)}(e,c);default:throw Error("invalid poly");}}function Qi(b,c){return void 0===c&&(c={}),Xk(Ib(b).coordinates,c.properties?
c.properties:"Feature"===b.type?b.properties:{})}function Xk(b,c){return 1<b.length?H(b,c):K(b[0],c)}function Yk(b,c){var e,k,d;void 0===c&&(c={});var f=c.properties,l=null===(e=c.autoComplete)||void 0===e||e,h=null===(k=c.orderCoords)||void 0===k||k;switch(null!==(d=c.mutate)&&void 0!==d&&d||(b=Dc(b)),b.type){case "FeatureCollection":var m=[];return b.features.forEach(function(p){m.push(Y(Zk(p,{},l,h)))}),T(m,f);default:return Zk(b,f,l,h)}}function Zk(b,c,e,k){c=c||("Feature"===b.type?b.properties:
{});var d=Ib(b);b=d.coordinates;d=d.type;if(!b.length)throw Error("line must contain coordinates");switch(d){case "LineString":return e&&(b=$k(b)),E([b],c);case "MultiLineString":var f=[],l=0;return b.forEach(function(h){if(e&&(h=$k(h)),k){var m=ya(K(h));m=Math.abs(m[0]-m[2])*Math.abs(m[1]-m[3]);m>l?(f.unshift(h),l=m):f.push(h)}else f.push(h)}),E(f,c);default:throw Error("geometry type "+d+" is not supported");}}function $k(b){var c=b[0],e=c[1],k=b[b.length-1],d=k[1];return c[0]===k[0]&&e===d||b.push(c),
b}function Ri(b,c,e,k){return 8&e?[b[0]+(c[0]-b[0])*(k[3]-b[1])/(c[1]-b[1]),k[3]]:4&e?[b[0]+(c[0]-b[0])*(k[1]-b[1])/(c[1]-b[1]),k[1]]:2&e?[k[2],b[1]+(c[1]-b[1])*(k[2]-b[0])/(c[0]-b[0])]:1&e?[k[0],b[1]+(c[1]-b[1])*(k[0]-b[0])/(c[0]-b[0])]:null}function Ff(b,c){var e=0;return b[0]<c[0]?e|=1:b[0]>c[2]&&(e|=2),b[1]<c[1]?e|=4:b[1]>c[3]&&(e|=8),e}function al(b,c){for(var e=[],k=0;k<b.length;k++){var d,f=void 0,l,h,m,p=void 0,n=b[k],r=c;for(m=1;8>=m;m*=2){p=[];var v=!(Ff(h=n[n.length-1],r)&m);for(l=0;l<
n.length;l++)(d=!(Ff(f=n[l],r)&m))!==v&&p.push(Ri(h,f,m,r)),d&&p.push(f),h=f,v=d;if(!(n=p).length)break}d=p;0<d.length&&(d[0][0]===d[d.length-1][0]&&d[0][1]===d[d.length-1][1]||d.push(d[0]),4<=d.length&&e.push(d))}return e}function bl(b,c,e){if(void 0===e&&(e={}),!ta(e=e||{}))throw Error("options is invalid");var k,d=e.tolerance||0,f=[],l=wg();b=kf(b);return l.load(b),L(c,function(h){var m=!1;h&&(Sa(l.search(h),function(p){if(!1===m){var n=Y(h).sort(),r=Y(p).sort();Gf(n,r)||(0===d?hd(n[0],p)&&hd(n[1],
p):Be(p,n[0]).properties.dist<=d&&Be(p,n[1]).properties.dist<=d)?(m=!0,k=k?cl(k,h):h):(0===d?hd(r[0],h)&&hd(r[1],h):Be(h,r[0]).properties.dist<=d&&Be(h,r[1]).properties.dist<=d)&&(k=k?cl(k,p):p)}}),!1===m&&k&&(f.push(k),k=void 0))}),k&&f.push(k),J(f)}function cl(b,c){c=Y(c);var e=Y(b),k=e[0];e=e[e.length-1];var d=b.geometry.coordinates;return Gf(c[0],k)?d.unshift(c[1]):Gf(c[0],e)?d.push(c[1]):Gf(c[1],k)?d.unshift(c[0]):Gf(c[1],e)&&d.push(c[0]),b}function dl(b){b%=360;return 0>b&&(b+=360),b}function lf(b,
c,e){var k;return void 0===e&&(e={}),180<(k=e.final?el(aa(c),aa(b)):el(aa(b),aa(c)))?-(360-k):k}function el(b,c){var e=ma(b[1]),k=ma(c[1]);b=ma(c[0]-b[0]);b>Math.PI&&(b-=2*Math.PI);b<-Math.PI&&(b+=2*Math.PI);return(ha(Math.atan2(b,Math.log(Math.tan(k/2+Math.PI/4)/Math.tan(e/2+Math.PI/4))))+360)%360}function Hf(b,c,e,k){void 0===k&&(k={});var d=0>c;c=ka(Math.abs(c),k.units,"meters");d&&(c=-Math.abs(c));b=aa(b);d=void 0;d=void 0===d?6371008.8:Number(d);c/=d;d=b[0]*Math.PI/180;var f=ma(b[1]);e=ma(e);
var l=c*Math.cos(e),h=f+l;Math.abs(h)>Math.PI/2&&(h=0<h?Math.PI-h:-Math.PI-h);var m=Math.log(Math.tan(h/2+Math.PI/4)/Math.tan(f/2+Math.PI/4));e=[(180*(d+c*Math.sin(e)/(1E-11<Math.abs(m)?l/m:Math.cos(f)))/Math.PI+540)%360-180,180*h/Math.PI];return e[0]+=180<e[0]-b[0]?-360:180<b[0]-e[0]?360:0,u(e,k.properties)}function fl(b,c,e,k,d,f){for(var l=0;l<b.length;l++){var h=b[l];k=b[l+1];l===b.length-1&&(k=b[0]);k=Ag(h,k,c);0>=e&&0<k?0>Ag(c,h,d)||(d=h):0<e&&0>=k&&(0<Ag(c,h,f)||(f=h));e=k}return[d,f]}function Ag(b,
c,e){return(c[0]-b[0])*(e[1]-b[1])-(e[0]-b[0])*(c[1]-b[1])}function Dh(b){for(var c,e=Y(b),k=0,d=1;d<e.length;)b=c||e[0],k+=((c=e[d])[0]-b[0])*(c[1]+b[1]),d++;return 0<k}function Eh(b,c){switch("Feature"===b.type?b.geometry.type:b.type){case "GeometryCollection":return Zb(b,function(e){Eh(e,c)}),b;case "LineString":return gl(Y(b),c),b;case "Polygon":return hl(Y(b),c),b;case "MultiLineString":return Y(b).forEach(function(e){gl(e,c)}),b;case "MultiPolygon":return Y(b).forEach(function(e){hl(e,c)}),
b;case "Point":case "MultiPoint":return b}}function gl(b,c){Dh(b)===c&&b.reverse()}function hl(b,c){Dh(b[0])!==c&&b[0].reverse();for(var e=1;e<b.length;e++)Dh(b[e])===c&&b[e].reverse()}function bo(b,c){if(!ta(c=c||{}))throw Error("options is invalid");var e=c.zProperty||"elevation",k=c.flip;c=c.flags;Ka(b,"Point","input must contain Points");b=function(p,n){var r={};return Sa(p,function(v){var z=Y(v)[1];r[z]||(r[z]=[]);r[z].push(v)}),Object.keys(r).map(function(v){return r[v].sort(function(z,t){return Y(z)[0]-
Y(t)[0]})}).sort(function(v,z){return n?Y(v[0])[1]-Y(z[0])[1]:Y(z[0])[1]-Y(v[0])[1]})}(b,k);k=[];for(var d=0;d<b.length;d++){for(var f=b[d],l=[],h=0;h<f.length;h++){var m=f[h];m.properties[e]?l.push(m.properties[e]):l.push(0);!0===c&&(m.properties.matrixPosition=[d,h])}k.push(l)}return k}function co(b,c,e,k){k=k||{};for(var d=Object.keys(il),f=0;f<d.length;f++){var l=d[f],h=k[l];h=null!=h?h:il[l];mf[l]=h}mf.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+c+":"+(c+e)+"]");
var m;b=function(p,n,r){var v=p.length-1,z=p[0].length-1,t={rows:v,cols:z,cells:[]};r=n+Math.abs(r);for(var y=0;y<v;++y){t.cells[y]=[];for(var C=0;C<z;++C){var w=0,x=p[y+1][C],A=p[y+1][C+1],D=p[y][C+1],G=p[y][C];if(!(isNaN(x)||isNaN(A)||isNaN(D)||isNaN(G))){w|=x<n?0:x>r?128:64;w|=A<n?0:A>r?32:16;w|=D<n?0:D>r?8:4;var P=+(w|=G<n?0:G>r?2:1),S=0;if(17===w||18===w||33===w||34===w||38===w||68===w||72===w||98===w||102===w||132===w||136===w||137===w||152===w||153===w)S=(x+A+D+G)/4,S=S>r?2:S<n?0:1,34===w?
1===S?w=35:0===S&&(w=136):136===w?1===S?(w=35,S=4):0===S&&(w=34):17===w?1===S?(w=155,S=4):0===S&&(w=153):68===w?1===S?(w=103,S=4):0===S&&(w=102):153===w?1===S&&(w=155):102===w?1===S&&(w=103):152===w?2>S&&(w=156,S=1):137===w?2>S&&(w=139,S=1):98===w?2>S&&(w=99,S=1):38===w?2>S&&(w=39,S=1):18===w?0<S?(w=156,S=4):w=152:33===w?0<S?(w=139,S=4):w=137:72===w?0<S?(w=99,S=4):w=98:132===w&&(0<S?(w=39,S=4):w=38);if(0!=w&&170!=w){var V,Z,X,ea,na,qa,ia;var ra=V=Z=X=ea=na=qa=ia=.5;var ja=[];1===w?(Z=1-U(n,D,G),ia=
1-U(n,x,G),ja.push(Ja[w])):169===w?(Z=U(r,G,D),ia=U(r,G,x),ja.push(Ja[w])):4===w?(na=1-U(n,A,D),X=U(n,G,D),ja.push(Ga[w])):166===w?(na=U(r,D,A),X=1-U(r,D,G),ja.push(Ga[w])):16===w?(ea=U(n,D,A),V=U(n,x,A),ja.push(Ha[w])):154===w?(ea=1-U(r,A,D),V=1-U(r,A,x),ja.push(Ha[w])):64===w?(qa=U(n,G,x),ra=1-U(n,A,x),ja.push(Ta[w])):106===w?(qa=1-U(r,x,G),ra=U(r,x,A),ja.push(Ta[w])):168===w?(X=U(r,G,D),Z=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ja.push(La[w]),ja.push(Ja[w])):2===w?(X=1-U(n,D,G),Z=1-U(r,D,G),ia=1-U(r,
x,G),qa=1-U(n,x,G),ja.push(La[w]),ja.push(Ja[w])):162===w?(ea=U(r,D,A),na=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),ja.push(La[w]),ja.push(Ja[w])):8===w?(ea=1-U(n,A,D),na=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),ja.push(Ha[w]),ja.push(Ga[w])):138===w?(ea=1-U(n,A,D),na=1-U(r,A,D),ra=1-U(r,A,x),V=1-U(n,A,x),ja.push(Ha[w]),ja.push(Ga[w])):32===w?(ea=U(r,D,A),na=U(n,D,A),ra=U(n,x,A),V=U(r,x,A),ja.push(Ha[w]),ja.push(Ga[w])):42===w?(ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A),ja.push(Ua[w]),ja.push(Ta[w])):128===
w&&(ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x),ja.push(Ua[w]),ja.push(Ta[w]));5===w?(na=1-U(n,A,D),ia=1-U(n,x,G),ja.push(Ga[w])):165===w?(na=U(r,D,A),ia=U(r,G,x),ja.push(Ga[w])):20===w?(X=U(n,G,D),V=U(n,x,A),ja.push(La[w])):150===w?(X=1-U(r,D,G),V=1-U(r,A,x),ja.push(La[w])):80===w?(ea=U(n,D,A),qa=U(n,G,x),ja.push(Ha[w])):90===w?(ea=1-U(r,A,D),qa=1-U(r,x,G),ja.push(Ha[w])):65===w?(Z=1-U(n,D,G),ra=1-U(n,A,x),ja.push(Ja[w])):105===w?(Z=U(r,G,D),ra=U(r,x,A),ja.push(Ja[w])):160===w?(ea=U(r,D,A),
na=U(n,D,A),ia=U(n,G,x),qa=U(r,G,x),ja.push(Ha[w]),ja.push(Ga[w])):10===w?(ea=1-U(n,A,D),na=1-U(r,A,D),ia=1-U(r,x,G),qa=1-U(n,x,G),ja.push(Ha[w]),ja.push(Ga[w])):130===w?(X=1-U(n,D,G),Z=1-U(r,D,G),ra=1-U(r,A,x),V=1-U(n,A,x),ja.push(La[w]),ja.push(Ja[w])):40===w?(X=U(r,G,D),Z=U(n,G,D),ra=U(n,x,A),V=U(r,x,A),ja.push(La[w]),ja.push(Ja[w])):101===w?(na=U(r,D,A),ra=U(r,x,A),ja.push(Ga[w])):69===w?(na=1-U(n,A,D),ra=1-U(n,A,x),ja.push(Ga[w])):149===w?(ia=U(r,G,x),V=1-U(r,A,x),ja.push(Ua[w])):21===w?(ia=
1-U(n,x,G),V=U(n,x,A),ja.push(Ua[w])):86===w?(X=1-U(r,D,G),qa=1-U(r,x,G),ja.push(La[w])):84===w?(X=U(n,G,D),qa=U(n,G,x),ja.push(La[w])):89===w?(ea=1-U(r,A,D),Z=U(r,G,D),ja.push(Ja[w])):81===w?(ea=U(n,D,A),Z=1-U(n,D,G),ja.push(Ja[w])):96===w?(ea=U(r,D,A),na=U(n,D,A),qa=U(n,G,x),ra=U(r,x,A),ja.push(Ha[w]),ja.push(Ga[w])):74===w?(ea=1-U(n,A,D),na=1-U(r,A,D),qa=1-U(r,x,G),ra=1-U(n,A,x),ja.push(Ha[w]),ja.push(Ga[w])):24===w?(ea=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),V=U(n,x,A),ja.push(Ha[w]),ja.push(Ja[w])):
146===w?(ea=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),V=1-U(r,A,x),ja.push(Ha[w]),ja.push(Ja[w])):6===w?(na=1-U(n,A,D),X=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ja.push(Ga[w]),ja.push(La[w])):164===w?(na=U(r,D,A),X=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ja.push(Ga[w]),ja.push(La[w])):129===w?(Z=1-U(n,D,G),ia=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x),ja.push(Ja[w]),ja.push(Ua[w])):41===w?(Z=U(r,G,D),ia=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A),ja.push(Ja[w]),ja.push(Ua[w])):66===w?(X=1-U(n,D,G),Z=1-U(r,D,G),qa=1-U(r,x,G),ra=
1-U(n,A,x),ja.push(La[w]),ja.push(Ja[w])):104===w?(X=U(r,G,D),Z=U(n,G,D),qa=U(n,G,x),ra=U(r,x,A),ja.push(Ja[w]),ja.push(eb[w])):144===w?(ea=U(n,D,A),ia=U(n,G,x),qa=U(r,G,x),V=1-U(r,A,x),ja.push(Ha[w]),ja.push(Ta[w])):26===w?(ea=1-U(r,A,D),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,A),ja.push(Ha[w]),ja.push(Ta[w])):36===w?(na=U(r,D,A),X=U(n,G,D),ra=U(n,x,A),V=U(r,x,A),ja.push(Ga[w]),ja.push(La[w])):134===w?(na=1-U(n,A,D),X=1-U(r,D,G),ra=1-U(r,A,x),V=1-U(n,A,x),ja.push(Ga[w]),ja.push(La[w])):9===w?(ea=1-U(n,
A,D),na=1-U(r,A,D),Z=U(r,G,D),ia=1-U(n,x,G),ja.push(Ha[w]),ja.push(Ga[w])):161===w?(ea=U(r,D,A),na=U(n,D,A),Z=1-U(n,D,G),ia=U(r,G,x),ja.push(Ha[w]),ja.push(Ga[w])):37===w?(na=U(r,D,A),ia=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A),ja.push(Ga[w]),ja.push(Ua[w])):133===w?(na=1-U(n,A,D),ia=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x),ja.push(Ga[w]),ja.push(Ua[w])):148===w?(X=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),V=1-U(r,A,x),ja.push(La[w]),ja.push(Ta[w])):22===w?(X=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,A),ja.push(La[w]),
ja.push(Ta[w])):82===w?(ea=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),qa=1-U(r,x,G),ja.push(Ha[w]),ja.push(Ja[w])):88===w?(ea=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),qa=U(n,G,x),ja.push(Ha[w]),ja.push(Ja[w])):73===w?(ea=1-U(n,A,D),na=1-U(r,A,D),Z=U(r,G,D),ra=1-U(n,A,x),ja.push(Ha[w]),ja.push(Ga[w])):97===w?(ea=U(r,D,A),na=U(n,D,A),Z=1-U(n,D,G),ra=U(r,x,A),ja.push(Ha[w]),ja.push(Ga[w])):145===w?(ea=U(n,D,A),Z=1-U(n,D,G),ia=U(r,G,x),V=1-U(r,A,x),ja.push(Ha[w]),ja.push(Ua[w])):25===w?(ea=1-U(r,A,D),Z=U(r,G,D),ia=1-
U(n,x,G),V=U(n,x,A),ja.push(Ha[w]),ja.push(Ua[w])):70===w?(na=1-U(n,A,D),X=1-U(r,D,G),qa=1-U(r,x,G),ra=1-U(n,A,x),ja.push(Ga[w]),ja.push(La[w])):100===w?(na=U(r,D,A),X=U(n,G,D),qa=U(n,G,x),ra=U(r,x,A),ja.push(Ga[w]),ja.push(La[w])):34===w?(0===S?(ea=1-U(n,A,D),na=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x)):(ea=U(r,D,A),na=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ua[w]),ja.push(Ta[w])):
35===w?(4===S?(ea=1-U(n,A,D),na=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x)):(ea=U(r,D,A),na=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ja[w]),ja.push(Ta[w])):136===w?(0===S?(ea=U(r,D,A),na=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)):(ea=1-U(n,A,D),na=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x)),
ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ua[w]),ja.push(Ta[w])):153===w?(0===S?(ea=U(n,D,A),Z=1-U(n,D,G),ia=1-U(n,x,G),V=U(n,x,A)):(ea=1-U(r,A,D),Z=U(r,G,D),ia=U(r,G,x),V=1-U(r,A,x)),ja.push(Ha[w]),ja.push(Ja[w])):102===w?(0===S?(na=1-U(n,A,D),X=U(n,G,D),qa=U(n,G,x),ra=1-U(n,A,x)):(na=U(r,D,A),X=1-U(r,D,G),qa=1-U(r,x,G),ra=U(r,x,A)),ja.push(Ga[w]),ja.push(Ta[w])):155===w?(4===S?(ea=U(n,D,A),Z=1-U(n,D,G),ia=1-U(n,x,G),V=U(n,x,A)):(ea=1-U(r,A,D),Z=U(r,G,D),ia=U(r,G,x),V=1-U(r,A,x)),ja.push(Ha[w]),ja.push(Ua[w])):
103===w?(4===S?(na=1-U(n,A,D),X=U(n,G,D),qa=U(n,G,x),ra=1-U(n,A,x)):(na=U(r,D,A),X=1-U(r,D,G),qa=1-U(r,x,G),ra=U(r,x,A)),ja.push(Ga[w]),ja.push(La[w])):152===w?(0===S?(ea=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,A)):(ea=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),V=1-U(r,A,x)),ja.push(Ha[w]),ja.push(La[w]),ja.push(Ja[w])):156===w?(4===S?(ea=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),V=U(n,x,A)):(ea=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),ia=
U(n,G,x),qa=U(r,G,x),V=1-U(r,A,x)),ja.push(Ha[w]),ja.push(Ja[w]),ja.push(Ta[w])):137===w?(0===S?(ea=U(r,D,A),na=U(n,D,A),Z=1-U(n,D,G),ia=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)):(ea=1-U(n,A,D),na=1-U(r,A,D),Z=U(r,G,D),ia=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ja[w])):139===w?(4===S?(ea=U(r,D,A),na=U(n,D,A),Z=1-U(n,D,G),ia=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)):(ea=1-U(n,A,D),na=1-U(r,A,D),Z=U(r,G,D),ia=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ua[w])):
98===w?(0===S?(ea=1-U(n,A,D),na=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),qa=U(n,G,x),ra=1-U(n,A,x)):(ea=U(r,D,A),na=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),qa=1-U(r,x,G),ra=U(r,x,A)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ta[w])):99===w?(4===S?(ea=1-U(n,A,D),na=1-U(r,A,D),X=U(r,G,D),Z=U(n,G,D),qa=U(n,G,x),ra=1-U(n,A,x)):(ea=U(r,D,A),na=U(n,D,A),X=1-U(n,D,G),Z=1-U(r,D,G),qa=1-U(r,x,G),ra=U(r,x,A)),ja.push(Ha[w]),ja.push(Ga[w]),ja.push(Ja[w])):38===w?(0===S?(na=1-U(n,A,D),X=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ra=1-
U(r,A,x),V=1-U(n,A,x)):(na=U(r,D,A),X=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)),ja.push(Ga[w]),ja.push(Ua[w]),ja.push(Ta[w])):39===w?(4===S?(na=1-U(n,A,D),X=U(n,G,D),ia=U(n,G,x),qa=U(r,G,x),ra=1-U(r,A,x),V=1-U(n,A,x)):(na=U(r,D,A),X=1-U(r,D,G),ia=1-U(r,x,G),qa=1-U(n,x,G),ra=U(n,x,A),V=U(r,x,A)),ja.push(Ga[w]),ja.push(La[w]),ja.push(Ta[w])):85===w&&(ea=1,na=0,X=1,Z=0,ia=0,qa=1,ra=0,V=1);(0>ra||1<ra||0>V||1<V||0>ea||1<ea||0>X||1<X||0>ia||1<ia||0>qa||1<qa)&&console.log("MarchingSquaresJS-isoBands: "+
w+" "+P+" "+x+","+A+","+D+","+G+" "+S+" "+ra+" "+V+" "+ea+" "+na+" "+X+" "+Z+" "+ia+" "+qa);t.cells[y][C]={cval:w,cval_real:P,flipped:S,topleft:ra,topright:V,righttop:ea,rightbottom:na,bottomright:X,bottomleft:Z,leftbottom:ia,lefttop:qa,edges:ja}}}}}return t}(b,c,e);return mf.polygons?(mf.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),m=function(p){var n=[],r=0;return p.cells.forEach(function(v,z){v.forEach(function(t,y){void 0!==t&&(t=Ea[t.cval](t),
"object"==typeof t&&Si(t)?"object"==typeof t[0]&&Si(t[0])?"object"==typeof t[0][0]&&Si(t[0][0])?t.forEach(function(C){C.forEach(function(w){w[0]+=y;w[1]+=z});n[r++]=C}):(t.forEach(function(C){C[0]+=y;C[1]+=z}),n[r++]=t):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates"))})}),n}(b)):(mf.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),
m=function(p){for(var n=[],r=p.rows,v=p.cols,z=[],t=0;t<r;t++)for(var y=0;y<v;y++)if(void 0!==p.cells[t][y]&&0<p.cells[t][y].edges.length){var C=eo(p.cells[t][y]),w=null,x=y,A=t;null!==C&&z.push([C.p[0]+x,C.p[1]+A]);do{if(null===(w=fo(p.cells[A][x],C.x,C.y,C.o)))break;if(z.push([w.p[0]+x,w.p[1]+A]),x+=w.x,C=w,0>(A+=w.y)||A>=r||0>x||x>=v||void 0===p.cells[A][x]){C=go(p,x-=w.x,A-=w.y,w.x,w.y,w.o);if(null===C)break;C.path.forEach(function(D){z.push(D)});x=C.i;A=C.j}}while(void 0!==p.cells[A][x]&&0<p.cells[A][x].edges.length);
n.push(z);z=[];0<p.cells[t][y].edges.length&&y--}return n}(b)),"function"==typeof mf.successCallback&&mf.successCallback(m),m}function U(b,c,e){return(b-c)/(e-c)}function Si(b){return-1<b.constructor.toString().indexOf("Array")}function go(b,c,e,k,d,f){for(var l,h,m=c+k,p=e+d,n=[];;){if(void 0===b.cells[p]||void 0===b.cells[p][m])if(p-=d,m-=k,h=(l=b.cells[p][m]).cval_real,-1===d){if(0===f)if(1&h)n.push([m,p]),k=-1;else{if(!(4&h)){n.push([m+l.bottomright,p]);k=0;f=d=1;break}n.push([m+1,p]);k=1}else{if(!(1&
h)){if(4&h){n.push([m+l.bottomright,p]);k=0;f=d=1;break}n.push([m+l.bottomleft,p]);k=0;d=1;f=0;break}n.push([m,p]);k=-1}f=d=0}else if(1===d){if(0===f&&!(h&Rd)){if(h&Nc){n.push([m+l.topleft,p+1]);k=0;d=-1;f=0;break}n.push([m+l.topright,p+1]);k=0;d=-1;f=1;break}n.push([m+1,p+1]);k=1;d=0;f=1}else if(-1===k){if(0===f){if(!(h&Nc)){if(1&h){n.push([m,p+l.leftbottom]);k=1;f=d=0;break}n.push([m,p+l.lefttop]);k=1;d=0;f=1;break}}else if(!(h&Nc)){console.log("MarchingSquaresJS-isoBands: wtf");break}n.push([m,
p+1]);k=0;d=1;f=0}else{if(1!==k){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===f){if(!(4&h)){n.push([m+1,p+l.rightbottom]);k=-1;f=d=0;break}}else if(!(4&h)){if(h&Rd){n.push([m+1,p+l.righttop]);k=-1;d=0;f=1;break}n.push([m+1,p+l.rightbottom]);k=-1;f=d=0;break}n.push([m+1,p]);k=0;d=-1;f=1}else if(h=(l=b.cells[p][m]).cval_real,-1===k)if(0===f)if(void 0!==b.cells[p-1]&&void 0!==b.cells[p-1][m])k=0,d=-1,f=1;else{if(!(1&h)){n.push([m+l.bottomright,p]);k=0;f=d=1;break}n.push([m,
p])}else{if(!(h&Nc)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+m+","+p);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===k){if(0===f){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==b.cells[p+1]&&void 0!==b.cells[p+1][m])k=0,d=1,f=0;else{if(!(h&Rd)){n.push([m+l.topleft,p+1]);k=0;d=-1;f=0;break}n.push([m+1,p+1]);k=1;d=0;f=1}}else if(-1===d){if(1!==f){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==b.cells[p][m+
1])k=1,d=0;else{if(!(4&h)){n.push([m+1,p+l.righttop]);k=-1;d=0;f=1;break}n.push([m+1,p]);k=0;d=-1}f=1}else{if(1!==d){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==f){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==b.cells[p][m-1])k=-1,d=0;else{if(!(h&Nc)){n.push([m,p+l.leftbottom]);k=1;f=d=0;break}n.push([m,p+1]);k=0;d=1}f=0}if(p+=d,(m+=k)===c&&p===e)break}return{path:n,i:m,j:p,x:k,y:d,o:f}}function eo(b){if(0<b.edges.length){var c=b.cval_real;
switch(b.edges[b.edges.length-1]){case 0:return c&Rd?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[b.topleft,1],x:0,y:-1,o:0};case 1:return 4&c?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[1,b.rightbottom],x:-1,y:0,o:0};case 2:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[b.topleft,1],x:0,y:-1,o:0};case 3:return 1&c?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 4:return c&Rd?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[b.topright,1],x:0,y:-1,o:1};case 5:return 4&c?{p:[b.topright,1],x:0,y:-1,o:1}:{p:[1,
b.rightbottom],x:-1,y:0,o:0};case 6:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[b.topright,1],x:0,y:-1,o:1};case 7:return 1&c?{p:[b.topright,1],x:0,y:-1,o:1}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 8:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[1,b.righttop],x:-1,y:0,o:1};case 9:return 1&c?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 10:return 1&c?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[1,b.righttop],x:-1,y:0,o:1};case 11:return c&Nc?{p:[1,b.righttop],x:-1,y:0,o:1}:{p:[0,
b.lefttop],x:1,y:0,o:1};case 12:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[1,b.rightbottom],x:-1,y:0,o:0};case 13:return 1&c?{p:[1,b.rightbottom],x:-1,y:0,o:0}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 14:return 1&c?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[1,b.rightbottom],x:-1,y:0,o:0};case 15:return c&Nc?{p:[1,b.rightbottom],x:-1,y:0,o:0}:{p:[0,b.lefttop],x:1,y:0,o:1};case 16:return 4&c?{p:[b.bottomright,0],x:0,y:1,o:1}:{p:[0,b.leftbottom],x:1,y:0,o:0};case 17:return c&Nc?{p:[b.bottomright,0],x:0,
y:1,o:1}:{p:[0,b.lefttop],x:1,y:0,o:1};case 18:return 1&c?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[b.bottomleft,0],x:0,y:1,o:0};case 19:return c&Nc?{p:[b.bottomleft,0],x:0,y:1,o:0}:{p:[0,b.lefttop],x:1,y:0,o:1};case 20:return c&Nc?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[0,b.leftbottom],x:1,y:0,o:0};case 21:return c&Rd?{p:[0,b.leftbottom],x:1,y:0,o:0}:{p:[b.topright,1],x:0,y:-1,o:1};case 22:return c&Nc?{p:[b.topleft,1],x:0,y:-1,o:0}:{p:[0,b.lefttop],x:1,y:0,o:1};case 23:return c&Rd?{p:[0,b.lefttop],x:1,y:0,
o:1}:{p:[b.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(b)}}return null}function fo(b,c,e,k){var d,f=b.cval;switch(c){case -1:switch(k){case 0:var l=Ga[f];var h=fb[f];var m=gb[f];var p=hb[f];break;default:l=Ha[f],h=ib[f],m=jb[f],p=kb[f]}break;case 1:switch(k){case 0:l=Ua[f];h=lb[f];m=mb[f];p=nb[f];break;default:l=Ta[f],h=ob[f],m=pb[f],p=qb[f]}break;default:switch(e){case -1:switch(k){case 0:l=eb[f];h=rb[f];m=sb[f];p=tb[f];break;
default:l=Db[f],h=ub[f],m=vb[f],p=wb[f]}break;case 1:switch(k){case 0:l=Ja[f];h=xb[f];m=yb[f];p=zb[f];break;default:l=La[f],h=Ab[f],m=Bb[f],p=Cb[f]}}}if(d=b.edges.indexOf(l),void 0===b.edges[d])return null;delete b.edges[d];for(k=d+1;k<b.edges.length;k++)b.edges[k-1]=b.edges[k];b.edges.pop();switch(f=b.cval_real,l){case 0:f&Rd?(c=b.topleft,e=1):(c=1,e=b.righttop);break;case 1:4&f?(c=1,e=b.rightbottom):(c=b.topleft,e=1);break;case 2:4&f?(c=b.topleft,e=1):(c=b.bottomright,e=0);break;case 3:1&f?(c=b.bottomleft,
e=0):(c=b.topleft,e=1);break;case 4:f&Rd?(c=b.topright,e=1):(c=1,e=b.righttop);break;case 5:4&f?(c=1,e=b.rightbottom):(c=b.topright,e=1);break;case 6:4&f?(c=b.topright,e=1):(c=b.bottomright,e=0);break;case 7:1&f?(c=b.bottomleft,e=0):(c=b.topright,e=1);break;case 8:4&f?(c=1,e=b.righttop):(c=b.bottomright,e=0);break;case 9:1&f?(c=b.bottomleft,e=0):(c=1,e=b.righttop);break;case 10:1&f?(c=1,e=b.righttop):(c=0,e=b.leftbottom);break;case 11:f&Nc?(c=0,e=b.lefttop):(c=1,e=b.righttop);break;case 12:4&f?(c=
1,e=b.rightbottom):(c=b.bottomright,e=0);break;case 13:1&f?(c=b.bottomleft,e=0):(c=1,e=b.rightbottom);break;case 14:1&f?(c=1,e=b.rightbottom):(c=0,e=b.leftbottom);break;case 15:f&Nc?(c=0,e=b.lefttop):(c=1,e=b.rightbottom);break;case 16:4&f?(c=0,e=b.leftbottom):(c=b.bottomright,e=0);break;case 17:f&Nc?(c=0,e=b.lefttop):(c=b.bottomright,e=0);break;case 18:1&f?(c=b.bottomleft,e=0):(c=0,e=b.leftbottom);break;case 19:f&Nc?(c=0,e=b.lefttop):(c=b.bottomleft,e=0);break;case 20:f&Nc?(c=0,e=b.leftbottom):(c=
b.topleft,e=1);break;case 21:f&Rd?(c=b.topright,e=1):(c=0,e=b.leftbottom);break;case 22:f&Nc?(c=0,e=b.lefttop):(c=b.topleft,e=1);break;case 23:f&Rd?(c=b.topright,e=1):(c=0,e=b.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(b),null}return void 0!==c&&void 0!==e&&void 0!==h&&void 0!==m&&void 0!==p||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(b),console.log(c+" "+e+" "+h+" "+m+" "+p)),{p:[c,e],x:h,y:m,o:p}}function ho(b){var c=
[],e=[];b.forEach(function(d){var f=Li(E([d]));e.push(f);c.push({ring:d,area:f})});e.sort(function(d,f){return f-d});var k=[];return e.forEach(function(d){for(var f=0;f<c.length;f++)if(c[f].area===d){k.push(c[f].ring);c.splice(f,1);break}}),k}function io(b){b=b.map(function(l){return{lrCoordinates:l,grouped:!1}});for(var c=[];!jo(b);)for(var e=0;e<b.length;e++)if(!b[e].grouped){var k=[];k.push(b[e].lrCoordinates);b[e].grouped=!0;for(var d=E([b[e].lrCoordinates]),f=e+1;f<b.length;f++)b[f].grouped||
ko(E([b[f].lrCoordinates]),d)&&(k.push(b[f].lrCoordinates),b[f].grouped=!0);c.push(k)}return c}function ko(b,c){b=xh(b);for(var e=0;e<b.features.length;e++)if(!Tb(b.features[e],c))return!1;return!0}function jo(b){for(var c=0;c<b.length;c++)if(!1===b[c].grouped)return!1;return!0}function jl(b,c,e){if(!ta(e=e||{}))throw Error("options is invalid");var k=e.pivot;e=e.mutate;if(!b)throw Error("geojson is required");if(null==c||isNaN(c))throw Error("angle is required");return 0===c||(k||=Ne(b),!1!==e&&
void 0!==e||(b=Dc(b)),Ca(b,function(d){var f=lf(k,d)+c,l=Bh(k,d);f=Y(Hf(k,l,f));d[0]=f[0];d[1]=f[1]})),b}function kl(b,c,e){if(!ta(e=e||{}))throw Error("options is invalid");var k=e.origin;e=e.mutate;if(!b)throw Error("geojson required");if("number"!=typeof c||0===c)throw Error("invalid factor");var d=Array.isArray(k)||"object"==typeof k;return!0!==e&&(b=Dc(b)),"FeatureCollection"!==b.type||d?ll(b,c,k):(Sa(b,function(f,l){b.features[l]=ll(f,c,k)}),b)}function ll(b,c,e){var k="Point"===qc(b);return e=
function(d,f){null==f&&(f="centroid");if(Array.isArray(f)||"object"==typeof f)return aa(f);var l=d.bbox?d.bbox:ya(d),h=l[0],m=l[1],p=l[2];l=l[3];switch(f){case "sw":case "southwest":case "westsouth":case "bottomleft":return u([h,m]);case "se":case "southeast":case "eastsouth":case "bottomright":return u([p,m]);case "nw":case "northwest":case "westnorth":case "topleft":return u([h,l]);case "ne":case "northeast":case "eastnorth":case "topright":return u([p,l]);case "center":return wh(d);case void 0:case null:case "centroid":return Ne(d);
default:throw Error("invalid origin");}}(b,e),1===c||k||Ca(b,function(d){var f=Bh(e,d),l=lf(e,d);f=Y(Hf(e,f*c,l));d[0]=f[0];d[1]=f[1];3===d.length&&(d[2]*=c)}),b}function Fh(b){var c=b[0];b=b[1];return[b[0]-c[0],b[1]-c[1]]}function Ti(b,c){return b[0]*c[1]-c[0]*b[1]}function lo(b,c){return!function(e,k){return 0===Ti(Fh(e),Fh(k))}(b,c)&&function(e,k){var d=e[0];e=Fh(e);var f=k[0];k=Fh(k);var l=Ti(e,k);return function(h,m){return[h[0]+m[0],h[1]+m[1]]}(d,function(h,m){return[h*m[0],h*m[1]]}(Ti([f[0]-
d[0],f[1]-d[1]],k)/l,e))}(b,c)}function ml(b,c,e){var k=[],d=R(c,e),f=Y(b),l=[];return f.forEach(function(h,m){if(m!==f.length-1){h=(p=h,n=f[m+1],r=d,v=Math.sqrt((p[0]-n[0])*(p[0]-n[0])+(p[1]-n[1])*(p[1]-n[1])),z=p[0]+r*(n[1]-p[1])/v,t=n[0]+r*(n[1]-p[1])/v,y=p[1]+r*(p[0]-n[0])/v,C=n[1]+r*(p[0]-n[0])/v,[[z,y],[t,C]]);if(k.push(h),0<m)p=k[m-1],n=lo(h,p),!1!==n&&(p[1]=n,h[0]=n),l.push(p[0]),m===f.length-2&&(l.push(h[0]),l.push(h[1]));2===f.length&&(l.push(h[0]),l.push(h[1]))}var p,n,r,v,z,t,y,C}),K(l,
b.properties)}function Ui(b,c,e){b=(c[0]-b[0])*(e[1]-c[1])-(e[0]-c[0])*(c[1]-b[1]);return(0<b)-(0>b)||+b}function nl(b,c){return c.geometry.coordinates[0].every(function(e){return Tb(u(e),b)})}function ol(b,c){var e=!0;return Rb(b,function(k){Rb(c,function(d){if(!1===e)return!1;e=function(f,l){switch(f.type){case "Point":switch(l.type){case "Point":return h=f.coordinates,m=l.coordinates,!(h[0]===m[0]&&h[1]===m[1]);case "LineString":return!pl(l,f);case "Polygon":return!Tb(f,l)}break;case "LineString":switch(l.type){case "Point":return!pl(f,
l);case "LineString":return f=0<ke(f,l).features.length?!0:!1,!f;case "Polygon":return!ql(l,f)}break;case "Polygon":switch(l.type){case "Point":return!Tb(l,f);case "LineString":return!ql(f,l);case "Polygon":a:{h=0;for(m=l.coordinates[0];h<m.length;h++)if(Tb(m[h],f)){f=!0;break a}h=0;for(m=f.coordinates[0];h<m.length;h++)if(Tb(m[h],l)){f=!0;break a}f=0<ke(zg(l),zg(f)).features.length?!0:!1}return!f}}var h,m;return!1}(k.geometry,d.geometry)})}),e}function pl(b,c){for(var e=0;e<b.coordinates.length-
1;e++){var k=b.coordinates[e],d=b.coordinates[e+1],f=c.coordinates,l=d[0]-k[0],h=d[1]-k[1];if(0==(f[0]-k[0])*h-(f[1]-k[1])*l&&(Math.abs(l)>=Math.abs(h)?0<l?k[0]<=f[0]&&f[0]<=d[0]:d[0]<=f[0]&&f[0]<=k[0]:0<h?k[1]<=f[1]&&f[1]<=d[1]:d[1]<=f[1]&&f[1]<=k[1]))return!0}return!1}function ql(b,c){for(var e=0,k=c.coordinates;e<k.length;e++)if(Tb(k[e],b))return!0;return 0<ke(c,zg(b)).features.length}function rl(b,c){return!(b[0]>c[0])&&!(b[2]<c[2])&&!(b[1]>c[1])&&!(b[3]<c[3])}function Vi(b,c){return b[0]===c[0]&&
b[1]===c[1]}function sl(b,c){for(var e=!1,k=!1,d=b.coordinates.length,f=0;f<d&&!e&&!k;){for(var l=0;l<c.coordinates.length-1;l++){var h=!0;0!==l&&l!==c.coordinates.length-2||(h=!1);tl(c.coordinates[l],c.coordinates[l+1],b.coordinates[f],h)?e=!0:k=!0}f++}return e&&k}function ul(b,c){for(var e=!1,k=!1,d=b.coordinates.length,f=0;f<d&&(!e||!k);f++)Tb(u(b.coordinates[f]),c)?e=!0:k=!0;return k&&e}function tl(b,c,e,k){var d=c[0]-b[0],f=c[1]-b[1];return 0==(e[0]-b[0])*f-(e[1]-b[1])*d&&(k?Math.abs(d)>=Math.abs(f)?
0<d?b[0]<=e[0]&&e[0]<=c[0]:c[0]<=e[0]&&e[0]<=b[0]:0<f?b[1]<=e[1]&&e[1]<=c[1]:c[1]<=e[1]&&e[1]<=b[1]:Math.abs(d)>=Math.abs(f)?0<d?b[0]<e[0]&&e[0]<c[0]:c[0]<e[0]&&e[0]<b[0]:0<f?b[1]<e[1]&&e[1]<c[1]:c[1]<e[1]&&e[1]<b[1])}function vl(b){return b.coordinates.map(function(c){return{type:b.type.replace("Multi",""),coordinates:c}})}function wl(b,c){return b.hasOwnProperty("coordinates")?b.coordinates.length===c.coordinates.length:b.length===c.length}function mo(b,c){return Gf(b,c,{strict:!0})}function xl(b,
c){var e=!1;return Rb(b,function(k){Rb(c,function(d){if(!0===e)return!0;e=!ol(k.geometry,d.geometry)})}),e}function yl(b,c,e){e=e||[];for(var k=0;k<b;k++)e[k]=c;return e}function zl(b,c){if(b.geometry&&b.geometry.type)return b.geometry.type;if(b.type)return b.type;throw Error("Invalid GeoJSON object for "+c);}function Al(b){for(var c=[];b.parent;)c.unshift(b),b=b.parent;return c}function If(b,c){c=c||{};this.nodes=[];this.diagonal=!!c.diagonal;this.grid=[];for(c=0;c<b.length;c++){this.grid[c]=[];
for(var e=0,k=b[c];e<k.length;e++){var d=new Gh(c,e,k[e]);this.grid[c][e]=d;this.nodes.push(d)}}this.init()}function Gh(b,c,e){this.x=b;this.y=c;this.weight=e}function Bl(b){this.content=[];this.scoreFunction=b}function no(b,c){for(var e=0;e<c.features.length;e++)if(Tb(b,c.features[e]))return!0;return!1}function Cl(b){return function(){return b}}function oo(b){return b[0]}function po(b){return b[1]}function Hh(){this._=null}function Ih(b){b.U=b.C=b.L=b.R=b.P=b.N=null}function Bg(b,c){var e=c.R,k=
c.U;k?k.L===c?k.L=e:k.R=e:b._=e;e.U=k;c.U=e;c.R=e.L;c.R&&(c.R.U=c);e.L=c}function Cg(b,c){var e=c.L,k=c.U;k?k.L===c?k.L=e:k.R=e:b._=e;e.U=k;c.U=e;c.L=e.R;c.L&&(c.L.U=c);e.R=c}function Dl(b){for(;b.L;)b=b.L;return b}function Dg(b,c,e,k){var d=[null,null],f=Vc.push(d)-1;return d.left=b,d.right=c,e&&Jh(d,b,c,e),k&&Jh(d,c,b,k),qd[b.index].halfedges.push(f),qd[c.index].halfedges.push(f),d}function Eg(b,c,e){c=[c,e];return c.left=b,c}function Jh(b,c,e,k){b[0]||b[1]?b.left===e?b[1]=k:b[0]=k:(b[0]=k,b.left=
c,b.right=e)}function qo(b,c,e,k,d){var f,l=b[0],h=b[1],m=l[0];l=l[1];var p=0,n=1,r=h[0]-m;h=h[1]-l;if(f=c-m,r||!(0<f)){if(f/=r,0>r){if(f<p)return;f<n&&(n=f)}else if(0<r){if(f>n)return;f>p&&(p=f)}if(f=k-m,r||!(0>f)){if(f/=r,0>r){if(f>n)return;f>p&&(p=f)}else if(0<r){if(f<p)return;f<n&&(n=f)}if(f=e-l,h||!(0<f)){if(f/=h,0>h){if(f<p)return;f<n&&(n=f)}else if(0<h){if(f>n)return;f>p&&(p=f)}if(f=d-l,h||!(0>f)){if(f/=h,0>h){if(f>n)return;f>p&&(p=f)}else if(0<h){if(f<p)return;f<n&&(n=f)}return!(0<p||1>n)||
(0<p&&(b[0]=[m+p*r,l+p*h]),1>n&&(b[1]=[m+n*r,l+n*h]),!0)}}}}}function ro(b,c,e,k,d){var f=b[1];if(f)return!0;var l,h=b[0],m=b.left;var p=b.right;f=m[0];m=m[1];var n=p[0],r=p[1],v=(f+n)/2;if(r===m){if(v<c||v>=k)return;if(f>n){if(h){if(h[1]>=d)return}else h=[v,e];f=[v,d]}else{if(h){if(h[1]<e)return}else h=[v,d];f=[v,e]}}else if(p=(m+r)/2-(l=(f-n)/(r-m))*v,-1>l||1<l)if(f>n){if(h){if(h[1]>=d)return}else h=[(e-p)/l,e];f=[(d-p)/l,d]}else{if(h){if(h[1]<e)return}else h=[(d-p)/l,d];f=[(e-p)/l,e]}else if(m<
r){if(h){if(h[0]>=k)return}else h=[c,l*c+p];f=[k,l*k+p]}else{if(h){if(h[0]<c)return}else h=[k,l*k+p];f=[c,l*c+p]}return b[0]=h,b[1]=f,!0}function so(b,c){b=b.site;var e=c.left,k=c.right;return b===k&&(k=e,e=b),k?Math.atan2(k[1]-e[1],k[0]-e[0]):(b===e?(e=c[1],k=c[0]):(e=c[0],k=c[1]),Math.atan2(e[0]-k[0],k[1]-e[1]))}function El(b,c){return c[+(c.left!==b.site)]}function to(){Ih(this);this.x=this.y=this.arc=this.site=this.cy=null}function Jf(b){var c=b.P,e=b.N;if(c&&e){var k=c.site;c=b.site;var d=e.site;
if(k!==d){e=c[0];var f=c[1],l=k[0]-e,h=k[1]-f;k=d[0]-e;var m=d[1]-f;d=2*(l*m-h*k);if(!(d>=-uo)){var p=l*l+h*h,n=k*k+m*m;h=(m*p-h*n)/d;k=(l*n-k*p)/d;l=Fl.pop()||new to;l.arc=b;l.site=c;l.x=h+e;l.y=(l.cy=k+f)+Math.sqrt(h*h+k*k);b.circle=l;b=null;for(c=Fg._;c;)if(l.y<c.y||l.y===c.y&&l.x<=c.x){if(!c.L){b=c.P;break}c=c.L}else{if(!c.R){b=c;break}c=c.R}Fg.insert(b,l);b||(Wi=l)}}}}function Kf(b){var c=b.circle;c&&(c.P||(Wi=c.N),Fg.remove(c),Fl.push(c),Ih(c),b.circle=null)}function vo(){Ih(this);this.edge=
this.site=this.circle=null}function Gl(b){var c=Hl.pop()||new vo;return c.site=b,c}function Xi(b){Kf(b);Lf.remove(b);Hl.push(b);Ih(b)}function wo(b){var c=b.circle,e=c.x,k=c.cy;c=[e,k];var d=b.P,f=b.N,l=[b];Xi(b);for(b=d;b.circle&&Math.abs(e-b.circle.x)<Wb&&Math.abs(k-b.circle.cy)<Wb;)d=b.P,l.unshift(b),Xi(b),b=d;l.unshift(b);Kf(b);for(d=f;d.circle&&Math.abs(e-d.circle.x)<Wb&&Math.abs(k-d.circle.cy)<Wb;)f=d.N,l.push(d),Xi(d),d=f;l.push(d);Kf(d);k=l.length;for(e=1;e<k;++e)d=l[e],b=l[e-1],Jh(d.edge,
b.site,d.site,c);b=l[0];(d=l[k-1]).edge=Dg(b.site,d.site,null,c);Jf(b);Jf(d)}function xo(b){for(var c,e,k,d,f=b[0],l=b[1],h=Lf._;h;)if((k=Il(h,l)-f)>Wb)h=h.L;else{var m=h;d=l;var p=m.N;p?d=Il(p,d):(m=m.site,d=m[1]===d?m[0]:1/0);if(!((d=f-d)>Wb)){k>-Wb?(c=h.P,e=h):d>-Wb?(c=h,e=h.N):c=e=h;break}if(!h.R){c=h;break}h=h.R}qd[b.index]={site:b,halfedges:[]};!0;k=Gl(b);if(Lf.insert(c,k),c||e){if(c===e)return Kf(c),e=Gl(c.site),Lf.insert(k,e),k.edge=e.edge=Dg(c.site,k.site),Jf(c),void Jf(e);if(e){Kf(c);Kf(e);
f=c.site;h=f[0];d=f[1];m=b[0]-h;p=b[1]-d;l=e.site;var n=l[0]-h,r=l[1]-d,v=2*(m*r-p*n),z=m*m+p*p,t=n*n+r*r;h=[(r*z-p*t)/v+h,(m*t-n*z)/v+d];Jh(e.edge,f,l,h);k.edge=Dg(f,b,null,h);e.edge=Dg(b,l,null,h);Jf(c);Jf(e)}else k.edge=Dg(c.site,k.site)}}function Il(b,c){var e=b.site,k=e[0],d=e[1],f=d-c;if(!f)return k;b=b.P;if(!b)return-1/0;b=(e=b.site)[0];e=e[1];c=e-c;if(!c)return b;var l=b-k,h=1/f-1/c,m=l/c;return h?(-m+Math.sqrt(m*m-2*h*(l*l/(-2*c)-e+c/2+d-f/2)))/h+k:(k+b)/2}function yo(b,c){return c[1]-b[1]||
c[0]-b[0]}function Yi(b,c){var e,k,d,f=b.sort(yo).pop();Vc=[];qd=Array(b.length);Lf=new Hh;for(Fg=new Hh;;)if(d=Wi,f&&(!d||f[1]<d.y||f[1]===d.y&&f[0]<d.x))f[0]===e&&f[1]===k||(xo(f),e=f[0],k=f[1]),f=b.pop();else{if(!d)break;wo(d.arc)}if(function(){for(var l,h,m,p,n=0,r=qd.length;n<r;++n)if((l=qd[n])&&(p=(h=l.halfedges).length)){var v=Array(p),z=Array(p);for(m=0;m<p;++m)v[m]=m,z[m]=so(l,Vc[h[m]]);v.sort(function(t,y){return z[y]-z[t]});for(m=0;m<p;++m)z[m]=h[v[m]];for(m=0;m<p;++m)h[m]=z[m]}}(),c)b=
+c[0][0],e=+c[0][1],k=+c[1][0],c=+c[1][1],!function(l,h,m,p){for(var n,r=Vc.length;r--;)ro(n=Vc[r],l,h,m,p)&&qo(n,l,h,m,p)&&(Math.abs(n[0][0]-n[1][0])>Wb||Math.abs(n[0][1]-n[1][1])>Wb)||delete Vc[r]}(b,e,k,c),function(l,h,m,p){var n,r,v,z,t,y,C,w=qd.length,x=!0;for(n=0;n<w;++n)if(r=qd[n]){var A=r.site;for(v=(z=r.halfedges).length;v--;)Vc[z[v]]||z.splice(v,1);v=0;for(t=z.length;v<t;){var D=Vc[z[v]];var G=(C=D[+(D.left===r.site)])[0];var P=C[1];D=(y=El(r,Vc[z[++v%t]]))[0];y=y[1];(Math.abs(G-D)>Wb||
Math.abs(P-y)>Wb)&&(z.splice(v,0,Vc.push(Eg(A,C,Math.abs(G-l)<Wb&&p-P>Wb?[l,Math.abs(D-l)<Wb?y:p]:Math.abs(P-p)<Wb&&m-G>Wb?[Math.abs(y-p)<Wb?D:m,p]:Math.abs(G-m)<Wb&&P-h>Wb?[m,Math.abs(D-m)<Wb?y:h]:Math.abs(P-h)<Wb&&G-l>Wb?[Math.abs(y-h)<Wb?D:l,h]:null))-1),++t)}t&&(x=!1)}if(x){var S,V,Z;v=1/0;n=0;for(x=null;n<w;++n)(r=qd[n])&&(Z=(S=(A=r.site)[0]-l)*S+(V=A[1]-h)*V)<v&&(v=Z,x=r);x&&(n=[l,h],l=[l,p],p=[m,p],h=[m,h],x.halfedges.push(Vc.push(Eg(A=x.site,n,l))-1,Vc.push(Eg(A,l,p))-1,Vc.push(Eg(A,p,h))-
1,Vc.push(Eg(A,h,n))-1))}for(n=0;n<w;++n)(r=qd[n])&&(r.halfedges.length||delete qd[n])}(b,e,k,c);this.edges=Vc;this.cells=qd;Lf=Fg=Vc=qd=null}function zo(b){return(b=b.slice()).push(b[0]),E([b])}function Jl(b,c,e,k){var d=(k=k||{}).steps||64,f=k.units||"kilometers",l=k.angle||0,h=k.pivot||b,m=k.properties||b.properties||{};if(!b)throw Error("center is required");if(!c)throw Error("xSemiAxis is required");if(!e)throw Error("ySemiAxis is required");if(!ta(k))throw Error("options must be an object");
if(!la(d))throw Error("steps must be a number");if(!la(l))throw Error("angle must be a number");k=aa(b);if("degrees"===f)var p=ma(l);else c=Hf(b,c,90,{units:f}),e=Hf(b,e,0,{units:f}),c=aa(c)[0]-k[0],e=aa(e)[1]-k[1];b=[];for(var n=0;n<d;n+=1){var r=-360*n/d,v=c*e/Math.sqrt(Math.pow(e,2)+Math.pow(c,2)*Math.pow(Math.tan(r*Math.PI/180),2)),z=c*e/Math.sqrt(Math.pow(c,2)+Math.pow(e,2)/Math.pow(Math.tan(r*Math.PI/180),2));if(-90>r&&-270<=r&&(v=-v),-180>r&&-360<=r&&(z=-z),"degrees"===f)r=z*Math.cos(p)-v*
Math.sin(p),v=v*Math.cos(p)+z*Math.sin(p),z=r;b.push([v+k[0],z+k[1]])}return b.push(b[0]),"degrees"===f?E([b],m):jl(E([b],m),l,{pivot:h})}function Zi(b,c){void 0===c&&(c={});var e=0,k=0,d=0;return Zb(b,function(f,l,h){var m=c.weight?null==h?void 0:h[c.weight]:void 0;if(!la(m=null==m?1:m))throw Error("weight value must be a number for feature index "+l);0<(m=Number(m))&&Ca(f,function(p){e+=p[0]*m;k+=p[1]*m;d+=m})}),u([e/d,k/d],c.properties,c)}function Kl(b,c,e,k,d){var f=k.tolerance||.001,l=0,h=0,
m=0,p=0;if(Sa(e,function(v){var z,t=null===(z=v.properties)||void 0===z?void 0:z.weight;z=null==t?1:t;if(!la(z=Number(z)))throw Error("weight value must be a number");0<z&&(p+=1,t=z*Lb(v,b),0===t&&(t=1),z/=t,l+=v.geometry.coordinates[0]*z,h+=v.geometry.coordinates[1]*z,m+=z)}),1>p)throw Error("no features to measure");var n=l/m,r=h/m;return 1===p||0===d||Math.abs(n-c[0])<f&&Math.abs(r-c[1])<f?u([n,r],{medianCandidates:k.medianCandidates}):(k.medianCandidates.push([n,r]),Kl([n,r],b,e,k,d-1))}function Ll(b,
c){return{x:b[0]-c[0],y:b[1]-c[1]}}function Ao(b,c){var e=0,k=0;Ca(b,function(d,f,l,h,m){m>e&&(e=m,k=f,c.push([]));l=b.coordinates[m][f-k+1];f=d[0];d=d[1];h=l[0];l=l[1];c[m].push([.75*f+.25*h,.75*d+.25*l]);c[m].push([.25*f+.75*h,.25*d+.75*l])},!0);c.forEach(function(d){d.push(d[0])})}function Bo(b,c){var e=0,k=0,d=0;Ca(b,function(f,l,h,m,p){m>d&&(d=m,k=l,c.push([[]]));p>e&&(e=p,k=l,c[m].push([]));h=b.coordinates[m][p][l-k+1];l=f[0];f=f[1];var n=h[0];h=h[1];c[m][p].push([.75*l+.25*n,.75*f+.25*h]);
c[m][p].push([.25*l+.75*n,.25*f+.75*h])},!0);c.forEach(function(f){f.forEach(function(l){l.push(l[0])})})}function Co(b,c,e){void 0===e&&(e=2);b=aa(b);var k=aa(c);c=b[0]-k[0];b=b[1]-k[1];return 1===e?Math.abs(c)+Math.abs(b):Math.pow(Math.pow(c,e)+Math.pow(b,e),1/e)}function Ml(b,c){var e=(c=c||{}).threshold||1E4,k=c.p||2,d=c.binary||!1,f=c.alpha||-1;c=c.standardization||!1;var l=[];Sa(b,function(n){l.push(Ne(n))});b=[];for(var h=0;h<l.length;h++)b[h]=[];for(h=0;h<l.length;h++)for(var m=h;m<l.length;m++){h===
m&&(b[h][m]=0);var p=Co(l[h],l[m],k);b[h][m]=p;b[m][h]=p}for(h=0;h<l.length;h++)for(m=0;m<l.length;m++)0!==(p=b[h][m])&&(b[h][m]=d?p<=e?1:0:p<=e?Math.pow(p,f):0);if(c)for(h=0;h<l.length;h++)for(e=b[h].reduce(function(n,r){return n+r},0),m=0;m<l.length;m++)b[h][m]/=e;return b}function Nl(b){for(var c=0,e=0;e<b.length;e++)c+=b[e];return c/b.length}function Ol(b,c){return void 0===c&&(c={}),Pl(b,"mercator",c)}function Ql(b,c){return void 0===c&&(c={}),Pl(b,"wgs84",c)}function Pl(b,c,e){void 0===e&&(e=
{});var k=(e=e||{}).mutate;if(!b)throw Error("geojson is required");return Array.isArray(b)&&la(b[0])?b="mercator"===c?Rl(b):Sl(b):(!0!==k&&(b=Dc(b)),Ca(b,function(d){var f="mercator"===c?Rl(d):Sl(d);d[0]=f[0];d[1]=f[1]})),b}function Rl(b){var c=Math.PI/180;if(180>=Math.abs(b[0]))var e=b[0];else e=b[0],e=b[0]-360*(0>e?-1:0<e?1:0);b=[6378137*e*c,6378137*Math.log(Math.tan(.25*Math.PI+.5*b[1]*c))];return 2.0037508342789244E7<b[0]&&(b[0]=2.0037508342789244E7),-2.0037508342789244E7>b[0]&&(b[0]=-2.0037508342789244E7),
2.0037508342789244E7<b[1]&&(b[1]=2.0037508342789244E7),-2.0037508342789244E7>b[1]&&(b[1]=-2.0037508342789244E7),b}function Sl(b){var c=180/Math.PI;return[b[0]*c/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-b[1]/6378137)))*c]}function Gg(b){return Array.isArray(b)?Tl(b):b&&b.bbox?Tl(b.bbox):[360*(Math.random()-.5),180*(Math.random()-.5)]}function Ul(b,c){void 0===c&&(c={});null==b&&(b=1);for(var e=[],k=0;k<b;k++)e.push(u(Gg(c.bbox)));return J(e)}function Vl(b,c){void 0===c&&(c={});null==b&&(b=1);la(c.num_vertices)&&
void 0!==c.num_vertices||(c.num_vertices=10);la(c.max_radial_length)&&void 0!==c.max_radial_length||(c.max_radial_length=10);for(var e=[],k=function(f){var l,h=[],m=Do(Array(c.num_vertices+1)).map(Math.random);m.forEach(function(p,n,r){r[n]=0<n?p+r[n-1]:p});m.forEach(function(p){p=2*p*Math.PI/m[m.length-1];var n=Math.random();h.push([n*(c.max_radial_length||10)*Math.sin(p),n*(c.max_radial_length||10)*Math.cos(p)])});h[h.length-1]=h[0];h=h.map((l=Gg(c.bbox),function(p){return[p[0]+l[0],p[1]+l[1]]}));
e.push(E([h]))},d=0;d<b;d++)k();return J(e)}function Wl(b,c){if(void 0===c&&(c={}),!ta(c=c||{}))throw Error("options is invalid");var e=c.bbox,k=c.num_vertices,d=c.max_length;c=c.max_rotation;null==b&&(b=1);(!la(k)||void 0===k||2>k)&&(k=10);la(d)&&void 0!==d||(d=1E-4);la(c)&&void 0!==c||(c=Math.PI/8);for(var f=[],l=0;l<b;l++){for(var h=[Gg(e)],m=0;m<k-1;m++){var p=(0===m?2*Math.random()*Math.PI:Math.tan((h[m][1]-h[m-1][1])/(h[m][0]-h[m-1][0])))+(Math.random()-.5)*c*2,n=Math.random()*d;h.push([h[m][0]+
n*Math.cos(p),h[m][1]+n*Math.sin(p)])}f.push(K(h))}return J(f)}function Tl(b){return[Math.random()*(b[2]-b[0])+b[0],Math.random()*(b[3]-b[1])+b[1]]}function Xl(b,c){if(!b)throw Error("geojson is required");if("FeatureCollection"!==b.type)throw Error("geojson must be a FeatureCollection");if(null==c)throw Error("filter is required");var e=[];return Sa(b,function(k){Kh(k.properties,c)&&e.push(k)}),J(e)}function $i(b,c,e){if(!b)throw Error("geojson is required");if("FeatureCollection"!==b.type)throw Error("geojson must be a FeatureCollection");
if(null==c)throw Error("property is required");c=aj(b,c);for(var k=Object.keys(c),d=0;d<k.length;d++){for(var f=k[d],l=c[f],h=[],m=0;m<l.length;m++)h.push(b.features[l[m]]);e(J(h),f,d)}}function Yl(b,c,e,k){var d=k;return $i(b,c,function(f,l,h){d=0===h&&void 0===k?f:e(d,f,l,h)}),d}function aj(b,c){var e={};return Sa(b,function(k,d){k=k.properties||{};Object.prototype.hasOwnProperty.call(k,String(c))&&(k=k[c],Object.prototype.hasOwnProperty.call(e,k)?e[k].push(d):e[k]=[d])}),e}function Kh(b,c){if(void 0===
b)return!1;var e=typeof c;if("number"===e||"string"===e)return Object.prototype.hasOwnProperty.call(b,c);if(Array.isArray(c)){for(e=0;e<c.length;e++)if(!Kh(b,c[e]))return!1;return!0}return bj(b,c)}function bj(b,c){for(var e=Object.keys(c),k=0;k<e.length;k++){var d=e[k];if(b[d]!==c[d])return!1}return!0}function Zl(b,c){if(!c||!c.length)return{};for(var e={},k=0;k<c.length;k++){var d=c[k];Object.prototype.hasOwnProperty.call(b,d)&&(e[d]=b[d])}return e}function Eo(b,c){return b>c?1:b<c?-1:0}function Oe(b,
c,e){for(var k=new Pe(null,null),d=k,f=k;;){var l=e(b,c.key);if(0>l){if(null===c.left)break;if(0>e(b,c.left.key)&&(l=c.left,c.left=l.right,l.right=c,null===(c=l).left))break;f=f.left=c;c=c.left}else{if(!(0<l))break;if(null===c.right)break;if(0<e(b,c.right.key)&&(l=c.right,c.right=l.left,l.left=c,null===(c=l).right))break;d=d.right=c;c=c.right}}return d.right=c.left,f.left=c.right,c.left=k.right,c.right=k.left,c}function cj(b,c,e,k){c=new Pe(b,c);if(null===e)return c.left=c.right=null,c;b=k(b,(e=Oe(b,
e,k)).key);return 0>b?(c.left=e.left,c.right=e,e.left=null):0<=b&&(c.right=e.right,c.left=e,e.right=null),c}function $l(b,c,e){var k=null,d=null;c&&(e=e((c=Oe(b,c,e)).key,b),0===e?(k=c.left,d=c.right):0>e?(d=c.right,c.right=null,k=c):(k=c.left,c.left=null,d=c));return{left:k,right:d}}function dj(b,c,e,k,d){b&&(k(c+(e?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+d(b)+"\n"),c+=e?"    ":"\u2502   ",b.left&&dj(b.left,c,!1,k,d),b.right&&dj(b.right,c,!0,k,d))}function ej(b,c,e,k){var d=k-e;if(0<d){d=e+
Math.floor(d/2);var f=new Pe(b[d],c[d]);return f.left=ej(b,c,e,d),f.right=ej(b,c,d+1,k),f}return null}function fj(b,c,e){var k=e-c;if(0<k){k=c+Math.floor(k/2);c=fj(b,c,k);var d=b.head;return d.left=c,b.head=b.head.next,d.right=fj(b,k+1,e),d}return null}function gj(b,c,e,k,d){if(!(e>=k)){for(var f=b[e+k>>1],l=e-1,h=k+1;;){do l++;while(0>d(b[l],f));do h--;while(0<d(b[h],f));if(l>=h)break;var m=b[l];b[l]=b[h];b[h]=m;m=c[l];c[l]=c[h];c[h]=m}gj(b,c,e,h,d);gj(b,c,h+1,k,d)}}function yd(b,c){if(!(b instanceof
c))throw new TypeError("Cannot call a class as a function");}function am(b,c){for(var e=0;e<c.length;e++){var k=c[e];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(b,k.key,k)}}function bd(b,c,e){return c&&am(b.prototype,c),e&&am(b,e),b}function id(){}function hj(b){this.message=b||""}function Mf(b){this.message=b||""}function Hg(b){this.message=b||""}function Lh(){}function Pb(b){return null===b?null:b.parent}function le(b,c){null!==b&&(b.color=
c)}function ij(b){return null===b?null:b.left}function bm(b){return null===b?null:b.right}function Ac(){this.root_=null;this.size_=0}function cm(){}function zd(b){this.array_=[];b instanceof kc&&this.addAll(b)}function Fo(){}function Go(){}function Ho(){}function Io(){}function Mh(b){this.message=b||""}function Ad(){this.array_=[]}function Sd(){this.reset()}function dm(b,c,e){var k=b.s=c+e,d=k-c;b.t=c-(k-d)+(e-d)}function em(b){return 1<b?0:-1>b?Nb:Math.acos(b)}function Nf(b){return 1<b?me:-1>b?-me:
Math.asin(b)}function Ig(){}function Nh(b,c){b&&fm.hasOwnProperty(b.type)&&fm[b.type](b,c)}function jj(b,c,e){var k=-1,d=b.length-e;for(c.lineStart();++k<d;)e=b[k],c.point(e[0],e[1],e[2]);c.lineEnd()}function gm(b,c){var e=-1,k=b.length;for(c.polygonStart();++e<k;)jj(b[e],c,1);c.polygonEnd()}function kj(b){return[Of(b[1],b[0]),Nf(b[2])]}function Pf(b){var c=b[0];b=b[1];var e=lc(b);return[e*lc(c),e*mc(c),mc(b)]}function Oh(b,c){return b[0]*c[0]+b[1]*c[1]+b[2]*c[2]}function Ph(b,c){return[b[1]*c[2]-
b[2]*c[1],b[2]*c[0]-b[0]*c[2],b[0]*c[1]-b[1]*c[0]]}function lj(b,c){b[0]+=c[0];b[1]+=c[1];b[2]+=c[2]}function Qh(b,c){return[b[0]*c,b[1]*c,b[2]*c]}function mj(b){var c=Jg(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=c;b[1]/=c;b[2]/=c}function hm(b,c){function e(k,d){return k=b(k,d),c(k[0],k[1])}return b.invert&&c.invert&&(e.invert=function(k,d){return(k=c.invert(k,d))&&b.invert(k[0],k[1])}),e}function nj(b,c){return[b>Nb?b-ne:b<-Nb?b+ne:b,c]}function im(b){return function(c,e){return[(c+=b)>Nb?c-ne:c<-Nb?
c+ne:c,e]}}function jm(b){var c=im(b);return c.invert=im(-b),c}function km(b,c){function e(h,m){var p=lc(m),n=lc(h)*p;h=mc(h)*p;m=mc(m);p=m*k+n*d;return[Of(h*f-p*l,n*k-m*d),Nf(p*f+h*l)]}var k=lc(b),d=mc(b),f=lc(c),l=mc(c);return e.invert=function(h,m){var p=lc(m),n=lc(h)*p;h=mc(h)*p;m=mc(m);p=m*f-h*l;return[Of(h*f+m*l,n*k+p*d),Nf(p*k-n*d)]},e}function lm(b,c){(c=Pf(c))[0]-=b;mj(c);b=em(-c[1]);return((0>-c[2]?-b:b)+ne-1E-6)%ne}function mm(){var b,c=[];return{point:function(e,k){b.push([e,k])},lineStart:function(){c.push(b=
[])},lineEnd:Ig,rejoin:function(){1<c.length&&c.push(c.pop().concat(c.shift()))},result:function(){var e=c;return c=[],b=null,e}}}function Rh(b,c){return 1E-6>Fc(b[0]-c[0])&&1E-6>Fc(b[1]-c[1])}function Sh(b,c,e,k){this.x=b;this.z=c;this.o=e;this.e=k;this.v=!1;this.n=this.p=null}function nm(b,c,e,k,d){var f=[],l=[];if(b.forEach(function(r){if(!(0>=(v=r.length-1))){var v,z=r[0],t=r[v];if(Rh(z,t)){d.lineStart();for(h=0;h<v;++h)d.point((z=r[h])[0],z[1]);d.lineEnd()}else f.push(v=new Sh(z,r,null,!0)),
l.push(v.o=new Sh(z,null,v,!1)),f.push(v=new Sh(t,r,null,!1)),l.push(v.o=new Sh(t,null,v,!0))}}),f.length){l.sort(c);om(f);om(l);var h=0;for(b=l.length;h<b;++h)l[h].e=e=!e;var m;for(c=f[0];;){for(var p=c,n=!0;p.v;)if((p=p.n)===c)return;e=p.z;d.lineStart();do{if(p.v=p.o.v=!0,p.e){if(n)for(h=0,b=e.length;h<b;++h)d.point((m=e[h])[0],m[1]);else k(p.x,p.n.x,1,d);p=p.n}else{if(n)for(e=p.p.z,h=e.length-1;0<=h;--h)d.point((m=e[h])[0],m[1]);else k(p.x,p.p.x,-1,d);p=p.p}e=(p=p.o).z;n=!n}while(!p.v);d.lineEnd()}}}
function om(b){if(c=b.length){for(var c,e,k=0,d=b[0];++k<c;)d.n=e=b[k],e.p=d,d=e;d.n=e=b[0];e.p=d}}function pm(b){var c,e,k=b.length;var d=-1;for(var f=0;++d<k;)f+=b[d].length;for(c=Array(f);0<=--k;)for(d=(e=b[k]).length;0<=--d;)c[--f]=e[d];return c}function Jo(b,c,e,k){function d(m,p,n,r){var v=0,z=0;if(null==m||(v=f(m,n))!==(z=f(p,n))||0>h(m,p)^0<n){do r.point(0===v||3===v?b:e,1<v?k:c);while((v=(v+n+4)%4)!==z)}else r.point(p[0],p[1])}function f(m,p){return 1E-6>Fc(m[0]-b)?0<p?0:3:1E-6>Fc(m[0]-e)?
0<p?2:1:1E-6>Fc(m[1]-c)?0<p?1:0:0<p?3:2}function l(m,p){return h(m.x,p.x)}function h(m,p){var n=f(m,1),r=f(p,1);return n!==r?n-r:0===n?p[1]-m[1]:1===n?m[0]-p[0]:2===n?m[1]-p[1]:p[0]-m[0]}return function(m){function p(Z,X){b<=Z&&Z<=e&&c<=X&&X<=k&&P.point(Z,X)}function n(Z,X){var ea=b<=Z&&Z<=e&&c<=X&&X<=k;if(v&&z.push([Z,X]),D)t=Z,y=X,C=ea,D=!1,ea&&(P.lineStart(),P.point(Z,X));else if(ea&&A)P.point(Z,X);else{var na=[w=Math.max(-1E9,Math.min(1E9,w)),x=Math.max(-1E9,Math.min(1E9,x))],qa=[Z=Math.max(-1E9,
Math.min(1E9,Z)),X=Math.max(-1E9,Math.min(1E9,X))];(function(ia,ra,ja,Ma,Pa,Sb){var Qa,Wc=ia[0],fc=ia[1],nc=0,cc=1,gc=ra[0]-Wc,Gc=ra[1]-fc;if(Qa=ja-Wc,gc||!(0<Qa)){if(Qa/=gc,0>gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}else if(0<gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}if(Qa=Pa-Wc,gc||!(0>Qa)){if(Qa/=gc,0>gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}else if(0<gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}if(Qa=Ma-fc,Gc||!(0<Qa)){if(Qa/=Gc,0>Gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}else if(0<Gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}if(Qa=Sb-fc,
Gc||!(0>Qa)){if(Qa/=Gc,0>Gc){if(Qa>cc)return;Qa>nc&&(nc=Qa)}else if(0<Gc){if(Qa<nc)return;Qa<cc&&(cc=Qa)}return 0<nc&&(ia[0]=Wc+nc*gc,ia[1]=fc+nc*Gc),1>cc&&(ra[0]=Wc+cc*gc,ra[1]=fc+cc*Gc),!0}}}}})(na,qa,b,c,e,k)?(A||(P.lineStart(),P.point(na[0],na[1])),P.point(qa[0],qa[1]),ea||P.lineEnd(),G=!1):ea&&(P.lineStart(),P.point(Z,X),G=!1)}w=Z;x=X;A=ea}var r,v,z,t,y,C,w,x,A,D,G,P=m,S=mm(),V={point:p,lineStart:function(){V.point=n;v&&v.push(z=[]);D=!0;A=!1;w=x=NaN},lineEnd:function(){r&&(n(t,y),C&&A&&S.rejoin(),
r.push(S.result()));V.point=p;A&&P.lineEnd()},polygonStart:function(){P=S;r=[];v=[];G=!0},polygonEnd:function(){for(var Z,X=Z=0,ea=v.length;X<ea;++X){var na=v[X],qa=1,ia=na.length,ra=na[0],ja=ra[0];for(ra=ra[1];qa<ia;++qa){var Ma=ja;var Pa=ra;ja=(ra=na[qa])[0];ra=ra[1];Pa<=k?ra>k&&(ja-Ma)*(k-Pa)>(ra-Pa)*(b-Ma)&&++Z:ra<=k&&(ja-Ma)*(k-Pa)<(ra-Pa)*(b-Ma)&&--Z}}X=G&&Z;ea=(r=pm(r)).length;(X||ea)&&(m.polygonStart(),X&&(m.lineStart(),d(null,null,1,m),m.lineEnd()),ea&&nm(r,l,Z,d,m),m.polygonEnd());P=m;r=
v=z=null}};return V}}function qm(b){return b}function rm(b,c,e,k){return function(d,f){function l(P,S){var V=d(P,S);b(P=V[0],S=V[1])&&f.point(P,S)}function h(P,S){P=d(P,S);C.point(P[0],P[1])}function m(){G.point=h;C.lineStart()}function p(){G.point=l;C.lineEnd()}function n(P,S){y.push([P,S]);P=d(P,S);A.point(P[0],P[1])}function r(){A.lineStart();y=[]}function v(){n(y[0][0],y[0][1]);A.lineEnd();var P;var S=A.clean();var V=x.result();var Z=V.length;if(y.pop(),z.push(y),y=null,Z)if(1&S){if(0<(V=(Z=V[0]).length-
1)){D||(f.polygonStart(),D=!0);f.lineStart();for(S=0;S<V;++S)f.point((P=Z[S])[0],P[1]);f.lineEnd()}}else 1<Z&&2&S&&V.push(V.pop().concat(V.shift())),t.push(V.filter(Ko))}var z,t,y,C=c(f),w=d.invert(k[0],k[1]),x=mm(),A=c(x),D=!1,G={point:l,lineStart:m,lineEnd:p,polygonStart:function(){G.point=n;G.lineStart=r;G.lineEnd=v;t=[];z=[]},polygonEnd:function(){G.point=l;G.lineStart=m;G.lineEnd=p;t=pm(t);var P=z;var S=w[0],V=w[1],Z=[mc(S),-lc(S),0],X=0,ea=0;oj.reset();for(var na=0,qa=P.length;na<qa;++na)if(ra=
(ia=P[na]).length){var ia,ra,ja=ia[ra-1],Ma=ja[0],Pa=ja[1]/2+sm,Sb=mc(Pa),Qa=lc(Pa);for(Pa=0;Pa<ra;++Pa,Ma=fc,Sb=nc,Qa=cc,ja=Wc){var Wc=ia[Pa],fc=Wc[0];cc=Wc[1]/2+sm;var nc=mc(cc),cc=lc(cc),gc=fc-Ma,Gc=0<=gc?1:-1,Qf=Gc*gc,Qe=Qf>Nb;Sb*=nc;if(oj.add(Of(Sb*Gc*mc(Qf),Qa*cc+Sb*lc(Qf))),X+=Qe?gc+Gc*ne:gc,Qe^Ma>=S^fc>=S)ja=Ph(Pf(ja),Pf(Wc)),mj(ja),Ma=Ph(Z,ja),mj(Ma),Ma=(Qe^0<=gc?-1:1)*Nf(Ma[2]),(V>Ma||V===Ma&&(ja[0]||ja[1]))&&(ea+=Qe^0<=gc?1:-1)}}P=(-1E-6>X||1E-6>X&&-1E-6>oj)^1&ea;t.length?(D||(f.polygonStart(),
D=!0),nm(t,Lo,P,e,f)):P&&(D||(f.polygonStart(),D=!0),f.lineStart(),e(null,null,1,f),f.lineEnd());D&&(f.polygonEnd(),D=!1);t=z=null},sphere:function(){f.polygonStart();f.lineStart();e(null,null,1,f);f.lineEnd();f.polygonEnd()}};return G}}function Ko(b){return 1<b.length}function Lo(b,c){return(0>(b=b.x)[0]?b[1]-me-1E-6:me-b[1])-(0>(c=c.x)[0]?c[1]-me-1E-6:me-c[1])}function Mo(b,c){function e(m,p){return lc(m)*lc(p)>f}function k(m,p,n){var r=[1,0,0],v=Ph(Pf(m),Pf(p)),z=Oh(v,v),t=v[0],y=z-t*t;if(!y)return!n&&
m;z=f*z/y;y=-f*t/y;t=Ph(r,v);r=Qh(r,z);lj(r,Qh(v,y));v=Oh(r,t);z=Oh(t,t);y=v*v-z*(Oh(r,r)-1);if(!(0>y)){var C=Jg(y);y=Qh(t,(-v-C)/z);if(lj(y,r),y=kj(y),!n)return y;var w;n=m[0];var x=p[0];m=m[1];p=p[1];x<n&&(w=n,n=x,x=w);var A=x-n,D=1E-6>Fc(A-Nb);if(!D&&p<m&&(w=m,m=p,p=w),D||1E-6>A?D?0<m+p^y[1]<(1E-6>Fc(y[0]-n)?m:p):m<=y[1]&&y[1]<=p:A>Nb^(n<=y[0]&&y[0]<=x))return w=Qh(t,(-v+C)/z),lj(w,r),[y,kj(w)]}}function d(m,p){var n=l?b:Nb-b,r=0;return m<-n?r|=1:m>n&&(r|=2),p<-n?r|=4:p>n&&(r|=8),r}var f=lc(b),
l=0<f,h=1E-6<Fc(f);return rm(e,function(m){var p,n,r,v,z;return{lineStart:function(){v=r=!1;z=1},point:function(t,y){var C,w=[t,y],x=e(t,y);t=l?x?0:d(t,y):x?d(t+(0>t?Nb:-Nb),y):0;if(!p&&(v=r=x)&&m.lineStart(),x!==r&&(!(C=k(p,w))||Rh(p,C)||Rh(w,C))&&(w[0]+=1E-6,w[1]+=1E-6,x=e(w[0],w[1])),x!==r)z=0,x?(m.lineStart(),C=k(w,p),m.point(C[0],C[1])):(C=k(p,w),m.point(C[0],C[1]),m.lineEnd()),p=C;else if(h&&p&&l^x){var A;t&n||!(A=k(w,p,!0))||(z=0,l?(m.lineStart(),m.point(A[0][0],A[0][1]),m.point(A[1][0],A[1][1]),
m.lineEnd()):(m.point(A[1][0],A[1][1]),m.lineEnd(),m.lineStart(),m.point(A[0][0],A[0][1])))}!x||p&&Rh(p,w)||m.point(w[0],w[1]);p=w;r=x;n=t},lineEnd:function(){r&&m.lineEnd();p=null},clean:function(){return z|(v&&r)<<1}}},function(m,p,n,r){var v=m;if(c){m=lc(b);var z=mc(b),t=n*c;null==v?(v=b+n*ne,p=b-t/2):(v=lm(m,v),p=lm(m,p),(0<n?v<p:v>p)&&(v+=n*ne));for(var y=v;0<n?y>p:y<p;y-=t)v=kj([m,-z*lc(y),-z*mc(y)]),r.point(v[0],v[1])}!0},l?[0,-b]:[-Nb,b-Nb])}function tm(b){return function(c){var e=new pj,
k;for(k in b)e[k]=b[k];return e.stream=c,e}}function pj(){}function um(b,c,e){var k=c[1][0]-c[0][0],d=c[1][1]-c[0][1],f=b.clipExtent&&b.clipExtent();b.scale(150).translate([0,0]);null!=f&&b.clipExtent(null);var l=b.stream(vm);e&&wm.hasOwnProperty(e.type)?wm[e.type](e,l):Nh(e,l);l=vm.result();e=Math.min(k/(l[1][0]-l[0][0]),d/(l[1][1]-l[0][1]));k=+c[0][0]+(k-e*(l[1][0]+l[0][0]))/2;c=+c[0][1]+(d-e*(l[1][1]+l[0][1]))/2;return null!=f&&b.clipExtent(f),b.scale(150*e).translate([k,c])}function xm(b,c){return+c?
function(e,k){function d(f,l,h,m,p,n,r,v,z,t,y,C,w,x){var A=r-f,D=v-l,G=A*A+D*D;if(G>4*k&&w--){var P=m+t,S=p+y,V=n+C,Z=Jg(P*P+S*S+V*V),X=Nf(V/=Z),ea=1E-6>Fc(Fc(V)-1)||1E-6>Fc(h-z)?(h+z)/2:Of(S,P),na=e(ea,X);X=na[0];na=na[1];var qa=X-f,ia=na-l,ra=D*qa-A*ia;(ra*ra/G>k||.3<Fc((A*qa+D*ia)/G-.5)||m*t+p*y+n*C<No)&&(d(f,l,h,m,p,n,X,na,ea,P/=Z,S/=Z,V,w,x),x.point(X,na),d(X,na,ea,P,S,V,r,v,z,t,y,C,w,x))}}return function(f){function l(X,ea){X=e(X,ea);f.point(X[0],X[1])}function h(){D=NaN;Z.point=m;f.lineStart()}
function m(X,ea){var na=Pf([X,ea]);ea=e(X,ea);d(D,G,A,P,S,V,D=ea[0],G=ea[1],A=X,P=na[0],S=na[1],V=na[2],16,f);f.point(D,G)}function p(){Z.point=l;f.lineEnd()}function n(){h();Z.point=r;Z.lineEnd=v}function r(X,ea){m(z=X,ea);t=D;y=G;C=P;w=S;x=V;Z.point=m}function v(){d(D,G,A,P,S,V,t,y,z,C,w,x,16,f);Z.lineEnd=p;p()}var z,t,y,C,w,x,A,D,G,P,S,V,Z={point:l,lineStart:h,lineEnd:p,polygonStart:function(){f.polygonStart();Z.lineStart=n},polygonEnd:function(){f.polygonEnd();Z.lineStart=h}};return Z}}(b,c):
function(e){return tm({point:function(k,d){k=e(k,d);this.stream.point(k[0],k[1])}})}(b)}function Oo(b){return function(c){function e(ia){return[(ia=n(ia[0]*Bd,ia[1]*Bd))[0]*C+h,m-ia[1]*C]}function k(ia){return(ia=n.invert((ia[0]-h)/C,(m-ia[1])/C))&&[ia[0]*Re,ia[1]*Re]}function d(ia,ra){return[(ia=l(ia,ra))[0]*C+h,m-ia[1]*C]}function f(){var ia=G,ra=P,ja=S;var Ma=(ia%=ne)?ra||ja?hm(jm(ia),km(ra,ja)):jm(ia):ra||ja?km(ra,ja):nj;n=hm(p=Ma,l);Ma=l(A,D);return h=w-Ma[0]*C,m=x+Ma[1]*C,t=y=null,e}var l,h,
m,p,n,r,v,z,t,y,C=150,w=480,x=250,A=0,D=0,G=0,P=0,S=0,V=null,Z=ym,X=null,ea=qm,na=.5,qa=xm(d,na);return e.stream=function(ia){return t&&y===ia?t:t=Po(Z(p,qa(ea(y=ia))))},e.clipAngle=function(ia){return arguments.length?(Z=+ia?Mo(V=ia*Bd,6*Bd):(V=null,ym),t=y=null,e):V*Re},e.clipExtent=function(ia){return arguments.length?(ea=null==ia?(X=r=v=z=null,qm):Jo(X=+ia[0][0],r=+ia[0][1],v=+ia[1][0],z=+ia[1][1]),t=y=null,e):null==X?null:[[X,r],[v,z]]},e.scale=function(ia){return arguments.length?(C=+ia,f()):
C},e.translate=function(ia){return arguments.length?(w=+ia[0],x=+ia[1],f()):[w,x]},e.center=function(ia){return arguments.length?(A=ia[0]%360*Bd,D=ia[1]%360*Bd,f()):[A*Re,D*Re]},e.rotate=function(ia){return arguments.length?(G=ia[0]%360*Bd,P=ia[1]%360*Bd,S=2<ia.length?ia[2]%360*Bd:0,f()):[G*Re,P*Re,S*Re]},e.precision=function(ia){return arguments.length?(qa=xm(d,na=ia*ia),t=y=null,e):Jg(na)},e.fitExtent=function(ia,ra){return um(e,ia,ra)},e.fitSize=function(ia,ra){return um(e,[[0,0],ia],ra)},function(){return l=
c.apply(this,arguments),e.invert=l.invert&&k,f()}}(function(){return b})()}function Th(b,c,e,k){var d=b.properties||{},f="Feature"===b.type?b.geometry:b;if("GeometryCollection"===f.type){var l=[];return Zb(b,function(m){(m=Th(m,c,e,k))&&l.push(m)}),J(l)}b=function(m){m=wh(m).geometry.coordinates;m=[-m[0],-m[1]];return Oo(zm).scale(79.4188).clipAngle(179.999).rotate(m).scale(6371008.8)}(f);f={type:f.type,coordinates:Am(f.coordinates,b)};f=(new qj).read(f);var h=ba(fa(c,e),"meters");f=xc.bufferOp(f,
h,k);if(!Bm((f=(new Cm).write(f)).coordinates))return g({type:f.type,coordinates:Dm(f.coordinates,b)},d)}function Bm(b){return Array.isArray(b[0])?Bm(b[0]):isNaN(b[0])}function Am(b,c){return"object"!=typeof b[0]?c(b):b.map(function(e){return Am(e,c)})}function Dm(b,c){return"object"!=typeof b[0]?c.invert(b):b.map(function(e){return Dm(e,c)})}function Kg(b,c,e){void 0===e&&(e={});b=Ib(b);c=Ib(c);c=Ce.intersection(b.coordinates,c.coordinates);return 0===c.length?null:1===c.length?E(c[0],e.properties):
T(c,e.properties)}function Em(b,c,e){void 0===e&&(e={});var k=JSON.stringify(e.properties||{}),d=b[0],f=b[1],l=b[2],h=b[3];b=(f+h)/2;var m=(d+l)/2;b=2*c/Lb([d,b],[l,b],e)*(l-d);c=2*c/Lb([m,f],[m,h],e)*(h-f);var p=b/2,n=2*p;m=Math.sqrt(3)/2*c;var r=l-d,v=h-f;l=.75*n;h=Math.floor((r-n)/(n-p/2));p=(h*l-p/2-r)/2-p/2+l/2;n=Math.floor((v-m)/m);r=(v-n*m)/2;(v=n*m-v>m/2)&&(r-=m/4);for(var z=[],t=[],y=0;6>y;y++){var C=2*Math.PI/6*y;z.push(Math.cos(C));t.push(Math.sin(C))}var w=[];for(y=0;y<=h;y++)for(C=0;C<=
n;C++){var x=1==y%2;if(!(0===C&&x||0===C&&v)){var A=y*l+d-p,D=C*m+f+r;(x&&(D-=m/2),!0===e.triangles)?Qo([A,D],b/2,c/2,JSON.parse(k),z,t).forEach(function(G){e.mask?Kg(e.mask,G)&&w.push(G):w.push(G)}):(x=Ro([A,D],b/2,c/2,JSON.parse(k),z,t),e.mask?Kg(e.mask,x)&&w.push(x):w.push(x))}}return J(w)}function Ro(b,c,e,k,d,f){for(var l=[],h=0;6>h;h++)l.push([b[0]+c*d[h],b[1]+e*f[h]]);return l.push(l[0].slice()),E([l],k)}function Qo(b,c,e,k,d,f){for(var l=[],h=0;6>h;h++){var m=[];m.push(b);m.push([b[0]+c*d[h],
b[1]+e*f[h]]);m.push([b[0]+c*d[(h+1)%6],b[1]+e*f[(h+1)%6]]);m.push(b);l.push(E([m],k))}return l}function Fm(b,c,e){void 0===e&&(e={});void 0===e&&(e={});var k=[],d=b[0],f=b[1],l=b[2],h=b[3];b=c/Lb([d,f],[l,f],e)*(l-d);c=c/Lb([d,f],[d,h],e)*(h-f);var m=l-d,p=h-f;l=Math.floor(m/b);h=Math.floor(p/c);p=(p-h*c)/2;d+=(m-l*b)/2;for(m=0;m<l;m++){for(var n=f+p,r=0;r<h;r++){var v=E([[[d,n],[d,n+c],[d+b,n+c],[d+b,n],[d,n]]],e.properties);e.mask?xl(e.mask,v)&&k.push(v):k.push(v);n+=c}d+=b}return J(k)}function Gm(b,
c,e){void 0===e&&(e={});var k=[],d=c/Lb([b[0],b[1]],[b[2],b[1]],e)*(b[2]-b[0]);c=c/Lb([b[0],b[1]],[b[0],b[3]],e)*(b[3]-b[1]);for(var f=0,l=b[0];l<=b[2];){for(var h=0,m=b[1];m<=b[3];){var p=null,n=null;0==f%2&&0==h%2?(p=E([[[l,m],[l,m+c],[l+d,m],[l,m]]],e.properties),n=E([[[l,m+c],[l+d,m+c],[l+d,m],[l,m+c]]],e.properties)):0==f%2&&1==h%2?(p=E([[[l,m],[l+d,m+c],[l+d,m],[l,m]]],e.properties),n=E([[[l,m],[l,m+c],[l+d,m+c],[l,m]]],e.properties)):0==h%2&&1==f%2?(p=E([[[l,m],[l,m+c],[l+d,m+c],[l,m]]],e.properties),
n=E([[[l,m],[l+d,m+c],[l+d,m],[l,m]]],e.properties)):1==h%2&&1==f%2&&(p=E([[[l,m],[l,m+c],[l+d,m],[l,m]]],e.properties),n=E([[[l,m+c],[l+d,m+c],[l+d,m],[l,m+c]]],e.properties));e.mask?(Kg(e.mask,p)&&k.push(p),Kg(e.mask,n)&&k.push(n)):(k.push(p),k.push(n));m+=c;h++}f++;l+=d}return J(k)}var mh={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:2.0902260511392E7,inches:39.37*6371008.8,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,
millimeters:6371008800,millimetres:6371008800,nauticalmiles:6371008.8/1852,radians:1,yards:6967335.223679999},Hm={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1E3,millimetres:1E3,nauticalmiles:1/1852,radians:1/6371008.8,yards:1.0936133},nh={acres:2.47105E-4,centimeters:1E4,centimetres:1E4,feet:10.763910417,hectares:1E-4,inches:1550.003100006,kilometers:1E-6,kilometres:1E-6,meters:1,metres:1,
miles:3.86E-7,millimeters:1E6,millimetres:1E6,yards:1.195990046},So=Object.freeze({__proto__:null,earthRadius:6371008.8,factors:mh,unitsFactors:Hm,areaFactors:nh,feature:g,geometry:q,point:u,points:B,polygon:E,polygons:F,lineString:K,lineStrings:I,featureCollection:J,multiLineString:H,multiPoint:N,multiPolygon:T,geometryCollection:O,round:W,radiansToLength:ba,lengthToRadians:fa,lengthToDegrees:R,bearingToAzimuth:da,radiansToDegrees:ha,degreesToRadians:ma,convertLength:ka,convertArea:pa,isNumber:la,
isObject:ta,validateBBox:wa,validateId:za}),To=Object.freeze({__proto__:null,coordAll:uc,coordEach:Ca,coordReduce:Vb,featureEach:Sa,featureReduce:Ya,findPoint:Ba,findSegment:oa,flattenEach:Rb,flattenReduce:Me,geomEach:Zb,geomReduce:pd,lineEach:Q,lineReduce:ca,propEach:Kb,propReduce:Qd,segmentEach:L,segmentReduce:M});ya.default=ya;var Uo=Object.freeze({__proto__:null,getCoord:aa,getCoords:Y,containsNumber:xa,geojsonType:Oa,featureOf:Ob,collectionOf:Ka,getGeom:Ib,getType:qc}),Im=Object.getOwnPropertySymbols,
Vo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,rj=function(){try{if(!Object.assign)return!1;var b=new String("abc");if(b[5]="de","5"===Object.getOwnPropertyNames(b)[0])return!1;var c={};for(b=0;10>b;b++)c["_"+String.fromCharCode(b)]=b;if("0123456789"!==Object.getOwnPropertyNames(c).map(function(k){return c[k]}).join(""))return!1;var e={};return"abcdefghijklmnopqrst".split("").forEach(function(k){e[k]=k}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},e)).join("")}catch(k){return!1}}()?
Object.assign:function(b,c){var e;if(null==b)throw new TypeError("Object.assign cannot be called with null or undefined");var k=Object(b);for(var d=1;d<arguments.length;d++){for(var f in e=Object(arguments[d]))Vo.call(e,f)&&(k[f]=e[f]);if(Im){var l=Im(e);for(var h=0;h<l.length;h++)Wo.call(e,l[h])&&(k[l[h]]=e[l[h]])}}return k},Rj={successCallback:null,verbose:!1},oh={},Vj=$b;Vj.default=$b;var Uc=mg;mg.prototype={all:function(){return this._all(this.data,[])},search:function(b){var c=this.data,e=[],
k=this.toBBox;if(!qh(b,c))return e;for(var d,f,l,h,m=[];c;){d=0;for(f=c.children.length;d<f;d++)l=c.children[d],qh(b,h=c.leaf?k(l):l)&&(c.leaf?e.push(l):pi(b,h)?this._all(l,e):m.push(l));c=m.pop()}return e},collides:function(b){var c=this.data,e=this.toBBox;if(!qh(b,c))return!1;for(var k,d,f,l,h=[];c;){k=0;for(d=c.children.length;k<d;k++)if(f=c.children[k],qh(b,l=c.leaf?e(f):f)){if(c.leaf||pi(b,l))return!0;h.push(f)}c=h.pop()}return!1},load:function(b){if(!b||!b.length)return this;if(b.length<this._minEntries){for(var c=
0,e=b.length;c<e;c++)this.insert(b[c]);return this}b=this._build(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this._splitRoot(this.data,b):(this.data.height<b.height&&(c=this.data,this.data=b,b=c),this._insert(b,this.data.height-b.height-1,!0)):this.data=b;return this},insert:function(b){return b&&this._insert(b,this.data.height-1),this},clear:function(){return this.data=Cf([]),this},remove:function(b,c){if(!b)return this;for(var e,k,d,f,l=this.data,h=this.toBBox(b),
m=[],p=[];l||m.length;){l||(l=m.pop(),k=m[m.length-1],e=p.pop(),f=!0);var n;if(n=l.leaf){a:{d=b;n=l.children;var r=c;if(r){for(var v=0;v<n.length;v++)if(r(d,n[v])){d=v;break a}d=-1}else d=n.indexOf(d)}n=-1!==d}if(n)return l.children.splice(d,1),m.push(l),this._condense(m),this;f||l.leaf||!pi(l,h)?k?(e++,l=k.children[e],f=!1):l=null:(m.push(l),p.push(e),e=0,k=l,l=l.children[0])}return this},toBBox:function(b){return b},compareMinX:Sj,compareMinY:Tj,toJSON:function(){return this.data},fromJSON:function(b){return this.data=
b,this},_all:function(b,c){for(var e=[];b;)b.leaf?c.push.apply(c,b.children):e.push.apply(e,b.children),b=e.pop();return c},_build:function(b,c,e,k){var d,f=e-c+1,l=this._maxEntries;if(f<=l)return Bf(d=Cf(b.slice(c,e+1)),this.toBBox),d;k||(k=Math.ceil(Math.log(f)/Math.log(l)),l=Math.ceil(f/Math.pow(l,k-1)));(d=Cf([])).leaf=!1;d.height=k;var h,m;f=Math.ceil(f/l);l=f*Math.ceil(Math.sqrt(l));for(Uj(b,c,e,l,this.compareMinX);c<=e;c+=l)for(Uj(b,c,m=Math.min(c+l-1,e),f,this.compareMinY),h=c;h<=m;h+=f){var p=
Math.min(h+f-1,m);d.children.push(this._build(b,h,p,k-1))}return Bf(d,this.toBBox),d},_chooseSubtree:function(b,c,e,k){for(var d,f,l,h,m,p,n,r,v,z;k.push(c),!c.leaf&&k.length-1!==e;){n=r=1/0;d=0;for(f=c.children.length;d<f;d++)m=oi(l=c.children[d]),v=b,z=l,(p=(Math.max(z.maxX,v.maxX)-Math.min(z.minX,v.minX))*(Math.max(z.maxY,v.maxY)-Math.min(z.minY,v.minY))-m)<r?(r=p,n=m<n?m:n,h=l):p===r&&m<n&&(n=m,h=l);c=h||c.children[0]}return c},_insert:function(b,c,e){var k=this.toBBox;e=e?b:k(b);k=[];var d=this._chooseSubtree(e,
this.data,c,k);d.children.push(b);for(og(d,e);0<=c&&k[c].children.length>this._maxEntries;)this._split(k,c),c--;this._adjustParentBBoxes(e,k,c)},_split:function(b,c){var e=b[c],k=e.children.length,d=this._minEntries;this._chooseSplitAxis(e,d,k);k=this._chooseSplitIndex(e,d,k);k=Cf(e.children.splice(k,e.children.length-k));k.height=e.height;k.leaf=e.leaf;Bf(e,this.toBBox);Bf(k,this.toBBox);c?b[c-1].children.push(k):this._splitRoot(e,k)},_splitRoot:function(b,c){this.data=Cf([b,c]);this.data.height=
b.height+1;this.data.leaf=!1;Bf(this.data,this.toBBox)},_chooseSplitIndex:function(b,c,e){var k,d,f;var l=d=1/0;for(k=c;k<=e-c;k++){var h=ng(b,0,k,this.toBBox);var m=ng(b,k,e,this.toBBox);var p=h;var n=m;var r=Math.max(p.minX,n.minX);var v=Math.max(p.minY,n.minY);var z=Math.min(p.maxX,n.maxX);p=Math.min(p.maxY,n.maxY);r=Math.max(0,z-r)*Math.max(0,p-v);h=oi(h)+oi(m);r<l?(l=r,f=k,d=h<d?h:d):r===l&&h<d&&(d=h,f=k)}return f},_chooseSplitAxis:function(b,c,e){var k=b.leaf?this.compareMinX:Sj,d=b.leaf?this.compareMinY:
Tj;this._allDistMargin(b,c,e,k)<this._allDistMargin(b,c,e,d)&&b.children.sort(k)},_allDistMargin:function(b,c,e,k){b.children.sort(k);var d=this.toBBox,f=ng(b,0,c,d),l=ng(b,e-c,e,d),h=ph(f)+ph(l);for(k=c;k<e-c;k++){var m=b.children[k];og(f,b.leaf?d(m):m);h+=ph(f)}for(k=e-c-1;k>=c;k--)m=b.children[k],og(l,b.leaf?d(m):m),h+=ph(l);return h},_adjustParentBBoxes:function(b,c,e){for(;0<=e;e--)og(c[e],b)},_condense:function(b){for(var c,e=b.length-1;0<=e;e--)0===b[e].children.length?0<e?(c=b[e-1].children).splice(c.indexOf(b[e]),
1):this.clear():Bf(b[e],this.toBBox)},_initFormat:function(b){var c=["return a"," - b",";"];this.compareMinX=new Function("a","b",c.join(b[0]));this.compareMinY=new Function("a","b",c.join(b[1]));this.toBBox=new Function("a","return {minX: a"+b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};")}};Uc.default=mg;var Uh=function(b,c,e){var k=b*c,d=Jm*b;d-=d-b;b-=d;var f=Jm*c;f-=f-c;c-=f;c=b*c-(k-d*f-b*f-d*c);return e?(e[0]=c,e[1]=k,e):[c,k]},Jm=+(Math.pow(2,27)+1),Xo=function(b,c){var e=0|b.length,
k=0|c.length;if(1===e&&1===k)return b=b[0],e=c[0],c=b+e,k=c-b,c=(b=b-(c-k)+(e-k))?[b,c]:[c],c;var d,f,l=Array(e+k),h=0,m=0,p=0,n=Math.abs,r=b[m],v=n(r),z=c[p],t=n(z);v<t?(f=r,(m+=1)<e&&(r=b[m],v=n(r))):(f=z,(p+=1)<k&&(z=c[p],t=n(z)));m<e&&v<t||p>=k?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(p+=1)<k&&(z=c[p],t=n(z)));for(var y,C,w=d+f,x,A=f-(w-d),D=w;m<e&&p<k;)v<t?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(p+=1)<k&&(z=c[p],t=n(z))),(x=(f=A)-((w=d+f)-d))&&(l[h++]=x),A=D-((y=D+w)-(C=y-D))+(w-C),D=y;for(;m<e;)(x=
(f=A)-((w=(d=r)+f)-d))&&(l[h++]=x),A=D-((y=D+w)-(C=y-D))+(w-C),D=y,(m+=1)<e&&(r=b[m]);for(;p<k;)(x=(f=A)-((w=(d=z)+f)-d))&&(l[h++]=x),A=D-((y=D+w)-(C=y-D))+(w-C),D=y,(p+=1)<k&&(z=c[p]);A&&(l[h++]=A);D&&(l[h++]=D);h||(l[h++]=0);return l.length=h,l},Yo=function(b,c){var e=b.length;if(1===e)return b=Uh(b[0],c),b[0]?b:[b[1]];var k=Array(2*e),d=[.1,.1],f=[.1,.1],l=0;Uh(b[0],c,d);d[0]&&(k[l++]=d[0]);for(var h=1;h<e;++h){Uh(b[h],c,f);var m=d[1];var p=f[0],n=d,r=m+p,v=r-m;p-=v;m-=r-v;n&&(n[0]=m+p,n[1]=r);
d[0]&&(k[l++]=d[0]);r=f[1];m=d[1];n=r+m;r=m-(n-r);d[1]=n;r&&(k[l++]=r)}d[1]&&(k[l++]=d[1]);0===l&&(k[l++]=0);return k.length=l,k},Zo=function(b,c){var e=0|b.length,k=0|c.length;if(1===e&&1===k)return b=b[0],e=-c[0],c=b+e,k=c-b,c=(b=b-(c-k)+(e-k))?[b,c]:[c],c;var d,f,l=Array(e+k),h=0,m=0,p=0,n=Math.abs,r=b[m],v=n(r),z=-c[p],t=n(z);v<t?(f=r,(m+=1)<e&&(r=b[m],v=n(r))):(f=z,(p+=1)<k&&(z=-c[p],t=n(z)));m<e&&v<t||p>=k?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(p+=1)<k&&(z=-c[p],t=n(z)));for(var y,C,w=d+f,x,
A=f-(w-d),D=w;m<e&&p<k;)v<t?(d=r,(m+=1)<e&&(r=b[m],v=n(r))):(d=z,(p+=1)<k&&(z=-c[p],t=n(z))),(x=(f=A)-((w=d+f)-d))&&(l[h++]=x),A=D-((y=D+w)-(C=y-D))+(w-C),D=y;for(;m<e;)(x=(f=A)-((w=(d=r)+f)-d))&&(l[h++]=x),A=D-((y=D+w)-(C=y-D))+(w-C),D=y,(m+=1)<e&&(r=b[m]);for(;p<k;)(x=(f=A)-((w=(d=z)+f)-d))&&(l[h++]=x),A=D-((y=D+w)-(C=y-D))+(w-C),D=y,(p+=1)<k&&(z=-c[p]);A&&(l[h++]=A);D&&(l[h++]=D);h||(l[h++]=0);return l.length=h,l},Km=ie(function(b){function c(p,n){for(var r=Array(p.length-1),v=1;v<p.length;++v)for(var z=
r[v-1]=Array(p.length-1),t=0,y=0;t<p.length;++t)t!==n&&(z[y++]=p[v][t]);return r}function e(p){if(1===p.length)return p[0];if(2===p.length)return["sum(",p[0],",",p[1],")"].join("");var n=p.length>>1;return["sum(",e(p.slice(0,n)),",",e(p.slice(n)),")"].join("")}function k(p){if(2===p.length)return[["sum(prod(",p[0][0],",",p[1][1],"),prod(-",p[0][1],",",p[1][0],"))"].join("")];for(var n=[],r=0;r<p.length;++r)n.push(["scale(",e(k(c(p,r))),",",(v=r,1&v?"-":""),p[0][r],")"].join(""));return n;var v}function d(p){for(var n=
[],r=[],v=Array(p),z=0;z<p;++z){v[z]=Array(p);for(var t=0;t<p;++t)v[z][t]=["m",t,"[",p-z-1,"]"].join("")}z=[];for(t=0;t<p;++t)0==(1&t)?n.push.apply(n,k(c(v,t))):r.push.apply(r,k(c(v,t))),z.push("m"+t);n=e(n);r=e(r);p="orientation"+p+"Exact";p=["function ",p,"(",z.join(),"){var p=",n,",n=",r,",d=sub(p,n);return d[d.length-1];};return ",p].join("");return(new Function("sum","prod","scale","sub",p))(Xo,Uh,Yo,Zo)}function f(p){var n=m[p.length];return n||=m[p.length]=d(p.length),n.apply(void 0,p)}var l=
d(3),h=d(4),m=[function(){return 0},function(){return 0},function(p,n){return n[0]-p[0]},function(p,n,r){var v=(p[1]-r[1])*(n[0]-r[0]);var z=(p[0]-r[0])*(n[1]-r[1]),t=v-z;if(0<v){if(0>=z)return t;v+=z}else{if(!(0>v)||0<=z)return t;v=-(v+z)}v*=3.3306690738754716E-16;return t>=v||t<=-v?t:l(p,n,r)},function(p,n,r,v){var z=p[0]-v[0],t=n[0]-v[0],y=r[0]-v[0],C=p[1]-v[1],w=n[1]-v[1],x=r[1]-v[1],A=p[2]-v[2],D=n[2]-v[2],G=r[2]-v[2],P=t*x,S=y*w;y*=C;x*=z;z*=w;C*=t;t=A*(P-S)+D*(y-x)+G*(z-C);A=7.771561172376103E-16*
((Math.abs(P)+Math.abs(S))*Math.abs(A)+(Math.abs(y)+Math.abs(x))*Math.abs(D)+(Math.abs(z)+Math.abs(C))*Math.abs(G));return t>A||-t>A?t:h(p,n,r,v)}];!function(){for(;5>=m.length;)m.push(d(m.length));for(var p=[],n=["slow"],r=0;5>=r;++r)p.push("a"+r),n.push("o"+r);var v=["function getOrientation(",p.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;5>=r;++r)v.push("case ",r,":return o",r,"(",p.slice(0,r).join(),");");v.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");
n.push(v.join(""));p=Function.apply(void 0,n);b.exports=p.apply(void 0,[f].concat(m));for(r=0;5>=r;++r)b.exports[r]=m[r]}()}),En=function(b){var c=b.length;if(3>c){for(var e=Array(c),k=0;k<c;++k)e[k]=k;return 2===c&&b[0][0]===b[1][0]&&b[0][1]===b[1][1]?[0]:e}e=Array(c);for(k=0;k<c;++k)e[k]=k;e.sort(function(p,n){return b[p][0]-b[n][0]||b[p][1]-b[n][1]});var d=[e[0],e[1]],f=[e[0],e[1]];for(k=2;k<c;++k){for(var l=e[k],h=b[l],m=d.length;1<m&&0>=Lm(b[d[m-2]],b[d[m-1]],h);)--m,d.pop();d.push(l);for(m=
f.length;1<m&&0<=Lm(b[f[m-2]],b[f[m-1]],h);)--m,f.pop();f.push(l)}e=Array(f.length+d.length-2);c=0;for(l=(k=0,d.length);k<l;++k)e[c++]=d[k];for(k=f.length-2;0<k;--k)e[c++]=f[k];return e},Lm=Km[3],Yj=pg;pg.prototype={push:function(b){this.data.push(b);this.length++;this._up(this.length-1)},pop:function(){if(0!==this.length){var b=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),b}},peek:function(){return this.data[0]},_up:function(b){for(var c=
this.data,e=this.compare,k=c[b];0<b;){var d=b-1>>1,f=c[d];if(0<=e(k,f))break;c[b]=f;b=d}c[b]=k},_down:function(b){for(var c=this.data,e=this.compare,k=this.length>>1,d=c[b];b<k;){var f=1+(b<<1),l=f+1,h=c[f];if(l<this.length&&0>e(c[l],h)&&(f=l,h=c[l]),0<=e(h,d))break;c[b]=h;b=f}c[b]=d}};Yj.default=pg;var sh=Km[3],ck=Wj;ck.default=Wj;var fk=function(b,c,e){this.a=b;this.b=c;this.c=e;var k=c.x-b.x;var d=c.y-b.y,f=e.x-b.x,l=e.y-b.y,h=k*(b.x+c.x)+d*(b.y+c.y),m=f*(b.x+e.x)+l*(b.y+e.y);c=2*(k*(e.y-c.y)-
d*(e.x-c.x));this.x=(l*h-d*m)/c;this.y=(k*m-f*h)/c;k=this.x-b.x;b=this.y-b.y;this.r=k*k+b*b},vh=Object.prototype.hasOwnProperty,Mm=new ArrayBuffer(16),kk=new Float64Array(Mm),uh=new Uint32Array(Mm),Un=function(){function b(c){this.points=c.points||[];this.duration=c.duration||1E4;this.sharpness=c.sharpness||.85;this.centers=[];this.controls=[];this.stepLength=c.stepLength||60;this.length=this.points.length;for(c=this.delay=0;c<this.length;c++)this.points[c].z=this.points[c].z||0;for(c=0;c<this.length-
1;c++){var e=this.points[c],k=this.points[c+1];this.centers.push({x:(e.x+k.x)/2,y:(e.y+k.y)/2,z:(e.z+k.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(c=0;c<this.centers.length-1;c++){e=this.points[c+1].x-(this.centers[c].x+this.centers[c+1].x)/2;k=this.points[c+1].y-(this.centers[c].y+this.centers[c+1].y)/2;var d=this.points[c+1].z-(this.centers[c].y+this.centers[c+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[c+1].x+this.sharpness*(this.centers[c].x+e),y:(1-this.sharpness)*
this.points[c+1].y+this.sharpness*(this.centers[c].y+k),z:(1-this.sharpness)*this.points[c+1].z+this.sharpness*(this.centers[c].z+d)},{x:(1-this.sharpness)*this.points[c+1].x+this.sharpness*(this.centers[c+1].x+e),y:(1-this.sharpness)*this.points[c+1].y+this.sharpness*(this.centers[c+1].y+k),z:(1-this.sharpness)*this.points[c+1].z+this.sharpness*(this.centers[c+1].z+d)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),
this}return b.prototype.cacheSteps=function(c){var e=[],k=this.pos(0);e.push(0);for(var d=0;d<this.duration;d+=10){var f=this.pos(d);Math.sqrt((f.x-k.x)*(f.x-k.x)+(f.y-k.y)*(f.y-k.y)+(f.z-k.z)*(f.z-k.z))>c&&(e.push(d),k=f)}return e},b.prototype.vector=function(c){var e=this.pos(c+10);c=this.pos(c-10);return{angle:180*Math.atan2(e.y-c.y,e.x-c.x)/3.14,speed:Math.sqrt((c.x-e.x)*(c.x-e.x)+(c.y-e.y)*(c.y-e.y)+(c.z-e.z)*(c.z-e.z))}},b.prototype.pos=function(c){c-=this.delay;0>c&&(c=0);c>this.duration&&
(c=this.duration-1);c/=this.duration;if(1<=c)return this.points[this.length-1];var e=Math.floor((this.points.length-1)*c),k=(this.length-1)*c-e;c=this.points[e];var d=this.controls[e][1],f=this.controls[e+1][0];e=this.points[e+1];var l=k*k;k=[l*k,3*l*(1-k),3*k*(1-k)*(1-k),(1-k)*(1-k)*(1-k)];return{x:e.x*k[0]+f.x*k[1]+d.x*k[2]+c.x*k[3],y:e.y*k[0]+f.y*k[1]+d.y*k[2]+c.y*k[3],z:e.z*k[0]+f.z*k[1]+d.z*k[2]+c.z*k[3]}},b}(),yk=yh;yh.deviation=function(b,c,e,k){var d=c&&c.length,f=Math.abs(Ei(b,0,d?c[0]*e:
b.length,e));if(d){d=0;for(var l=c.length;d<l;d++)f-=Math.abs(Ei(b,c[d]*e,d<l-1?c[d+1]*e:b.length,e))}for(d=c=0;d<k.length;d+=3){l=k[d]*e;var h=k[d+1]*e,m=k[d+2]*e;c+=Math.abs((b[l]-b[m])*(b[h+1]-b[l+1])-(b[l]-b[h])*(b[m+1]-b[l+1]))}return 0===f&&0===c?0:Math.abs((c-f)/f)};yh.flatten=function(b){for(var c=b[0][0].length,e={vertices:[],holes:[],dimensions:c},k=0,d=0;d<b.length;d++){for(var f=0;f<b[d].length;f++)for(var l=0;l<c;l++)e.vertices.push(b[d][f][l]);0<d&&(k+=b[d-1].length,e.holes.push(k))}return e};
yk.default=yh;var Ec=ie(function(b,c){function e(t,y,C){void 0===C&&(C={});var w={type:"Feature"};return(0===C.id||C.id)&&(w.id=C.id),C.bbox&&(w.bbox=C.bbox),w.properties=y||{},w.geometry=t,w}function k(t,y,C){if(void 0===C&&(C={}),!t)throw Error("coordinates is required");if(!Array.isArray(t))throw Error("coordinates must be an Array");if(2>t.length)throw Error("coordinates must be at least 2 numbers long");if(!z(t[0])||!z(t[1]))throw Error("coordinates must contain numbers");return e({type:"Point",
coordinates:t},y,C)}function d(t,y,C){void 0===C&&(C={});for(var w=0;w<t.length;w++){var x=t[w];if(4>x.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var A=0;A<x[x.length-1].length;A++)if(x[x.length-1][A]!==x[0][A])throw Error("First and last Position are not equivalent.");}return e({type:"Polygon",coordinates:t},y,C)}function f(t,y,C){if(void 0===C&&(C={}),2>t.length)throw Error("coordinates must be an array of two or more positions");return e({type:"LineString",
coordinates:t},y,C)}function l(t,y){void 0===y&&(y={});var C={type:"FeatureCollection"};return y.id&&(C.id=y.id),y.bbox&&(C.bbox=y.bbox),C.features=t,C}function h(t,y,C){return void 0===C&&(C={}),e({type:"MultiLineString",coordinates:t},y,C)}function m(t,y,C){return void 0===C&&(C={}),e({type:"MultiPoint",coordinates:t},y,C)}function p(t,y,C){return void 0===C&&(C={}),e({type:"MultiPolygon",coordinates:t},y,C)}function n(t,y){void 0===y&&(y="kilometers");var C=c.factors[y];if(!C)throw Error(y+" units is invalid");
return t*C}function r(t,y){void 0===y&&(y="kilometers");var C=c.factors[y];if(!C)throw Error(y+" units is invalid");return t/C}function v(t){return t%(2*Math.PI)*180/Math.PI}function z(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(c,"__esModule",{value:!0});c.earthRadius=6371008.8;c.factors={centimeters:100*c.earthRadius,centimetres:100*c.earthRadius,degrees:c.earthRadius/111325,feet:3.28084*c.earthRadius,inches:39.37*c.earthRadius,kilometers:c.earthRadius/1E3,kilometres:c.earthRadius/
1E3,meters:c.earthRadius,metres:c.earthRadius,miles:c.earthRadius/1609.344,millimeters:1E3*c.earthRadius,millimetres:1E3*c.earthRadius,nauticalmiles:c.earthRadius/1852,radians:1,yards:1.0936*c.earthRadius};c.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1E3,millimetres:1E3,nauticalmiles:1/1852,radians:1/c.earthRadius,yards:1.0936133};c.areaFactors={acres:2.47105E-4,centimeters:1E4,
centimetres:1E4,feet:10.763910417,hectares:1E-4,inches:1550.003100006,kilometers:1E-6,kilometres:1E-6,meters:1,metres:1,miles:3.86E-7,millimeters:1E6,millimetres:1E6,yards:1.195990046};c.feature=e;c.geometry=function(t,y,C){switch(t){case "Point":return k(y).geometry;case "LineString":return f(y).geometry;case "Polygon":return d(y).geometry;case "MultiPoint":return m(y).geometry;case "MultiLineString":return h(y).geometry;case "MultiPolygon":return p(y).geometry;default:throw Error(t+" is invalid");
}};c.point=k;c.points=function(t,y,C){return void 0===C&&(C={}),l(t.map(function(w){return k(w,y)}),C)};c.polygon=d;c.polygons=function(t,y,C){return void 0===C&&(C={}),l(t.map(function(w){return d(w,y)}),C)};c.lineString=f;c.lineStrings=function(t,y,C){return void 0===C&&(C={}),l(t.map(function(w){return f(w,y)}),C)};c.featureCollection=l;c.multiLineString=h;c.multiPoint=m;c.multiPolygon=p;c.geometryCollection=function(t,y,C){return void 0===C&&(C={}),e({type:"GeometryCollection",geometries:t},y,
C)};c.round=function(t,y){if(void 0===y&&(y=0),y&&!(0<=y))throw Error("precision must be a positive number");y=Math.pow(10,y||0);return Math.round(t*y)/y};c.radiansToLength=n;c.lengthToRadians=r;c.lengthToDegrees=function(t,y){return v(r(t,y))};c.bearingToAzimuth=function(t){t%=360;return 0>t&&(t+=360),t};c.radiansToDegrees=v;c.degreesToRadians=function(t){return t%360*Math.PI/180};c.convertLength=function(t,y,C){if(void 0===y&&(y="kilometers"),void 0===C&&(C="kilometers"),!(0<=t))throw Error("length must be a positive number");
return n(r(t,y),C)};c.convertArea=function(t,y,C){if(void 0===y&&(y="meters"),void 0===C&&(C="kilometers"),!(0<=t))throw Error("area must be a positive number");y=c.areaFactors[y];if(!y)throw Error("invalid original units");C=c.areaFactors[C];if(!C)throw Error("invalid final units");return t/y*C};c.isNumber=z;c.isObject=function(t){return!!t&&t.constructor===Object};c.validateBBox=function(t){if(!t)throw Error("bbox is required");if(!Array.isArray(t))throw Error("bbox must be an Array");if(4!==t.length&&
6!==t.length)throw Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(y){if(!z(y))throw Error("bbox must only contain numbers");})};c.validateId=function(t){if(!t)throw Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw Error("id must be a number or a string");}}),Ji=Object.defineProperty({coordAll:function(b){var c=[];return ug(b,function(e){c.push(e)}),c},coordEach:ug,coordReduce:function(b,c,e,k){var d=e;return ug(b,function(f,l,h,m,p){d=0===l&&void 0===
e?f:c(d,f,l,h,m,p)},k),d},featureEach:Ak,featureReduce:function(b,c,e){var k=e;return Ak(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k},findPoint:function(b,c){if(c=c||{},!Ec.isObject(c))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.coordIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;
break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":return Ec.point(e,l,c);case "MultiPoint":return 0>k&&(k=e.length+k),Ec.point(e[k],l,c);case "LineString":return 0>f&&(f=e.length+f),Ec.point(e[f],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f),Ec.point(e[d][f],l,c);case "MultiLineString":return 0>
k&&(k=e.length+k),0>f&&(f=e[k].length+f),Ec.point(e[k][f],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-f),Ec.point(e[k][d][f],l,c)}throw Error("geojson is invalid");},findSegment:function(b,c){if(c=c||{},!Ec.isObject(c))throw Error("options is invalid");var e=c.featureIndex||0,k=c.multiFeatureIndex||0,d=c.geometryIndex||0,f=c.segmentIndex||0,l=c.properties;switch(b.type){case "FeatureCollection":0>e&&(e=b.features.length+e);l=l||b.features[e].properties;
b=b.features[e].geometry;break;case "Feature":l=l||b.properties;b=b.geometry;break;case "Point":case "MultiPoint":return null;case "LineString":case "Polygon":case "MultiLineString":case "MultiPolygon":break;default:throw Error("geojson is invalid");}if(null===b)return null;e=b.coordinates;switch(b.type){case "Point":case "MultiPoint":return null;case "LineString":return 0>f&&(f=e.length+f-1),Ec.lineString([e[f],e[f+1]],l,c);case "Polygon":return 0>d&&(d=e.length+d),0>f&&(f=e[d].length+f-1),Ec.lineString([e[d][f],
e[d][f+1]],l,c);case "MultiLineString":return 0>k&&(k=e.length+k),0>f&&(f=e[k].length+f-1),Ec.lineString([e[k][f],e[k][f+1]],l,c);case "MultiPolygon":return 0>k&&(k=e.length+k),0>d&&(d=e[k].length+d),0>f&&(f=e[k][d].length-f-1),Ec.lineString([e[k][d][f],e[k][d][f+1]],l,c)}throw Error("geojson is invalid");},flattenEach:Ah,flattenReduce:function(b,c,e){var k=e;return Ah(b,function(d,f,l){k=0===f&&0===l&&void 0===e?d:c(k,d,f,l)}),k},geomEach:Hi,geomReduce:function(b,c,e){var k=e;return Hi(b,function(d,
f,l,h,m){k=0===f&&void 0===e?d:c(k,d,f,l,h,m)}),k},lineEach:Ck,lineReduce:function(b,c,e){var k=e;return Ck(b,function(d,f,l,h){k=0===f&&void 0===e?d:c(k,d,f,l,h)}),k},propEach:zk,propReduce:function(b,c,e){var k=e;return zk(b,function(d,f){k=0===f&&void 0===e?d:c(k,d,f)}),k},segmentEach:Bk,segmentReduce:function(b,c,e){var k=e,d=!1;return Bk(b,function(f,l,h,m,p){k=!1===d&&void 0===e?f:c(k,f,l,h,m,p);d=!0}),k}},"__esModule",{value:!0});Ii.default=Ii;var vg=Object.defineProperty({default:Ii},"__esModule",
{value:!0}).default,Yn=Ji.featureEach,Ek=(Ji.coordEach,Ec.polygon,Ec.featureCollection),wg=Dk;wg.default=Dk;var Rk=function(b,c,e,k,d){this.coord=b;this.param=c;this.ringAndEdgeIn=e;this.ringAndEdgeOut=k;this.nxtIsectAlongEdgeIn=d},Sk=function(b,c,e,k,d,f,l){this.coord=b;this.ringAndEdge1=c;this.ringAndEdge2=e;this.nxtIsectAlongRingAndEdge1=k;this.nxtIsectAlongRingAndEdge2=d;this.ringAndEdge1Walkable=f;this.ringAndEdge2Walkable=l},Nm=Math.PI/180,Om=180/Math.PI,Lg=function(b,c){this.lon=b;this.lat=
c;this.x=Nm*b;this.y=Nm*c};Lg.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Lg.prototype.antipode=function(){return new Lg(0>this.lon?180+this.lon:-1*(180-this.lon),-1*this.lat)};var Pm=function(){this.coords=[];this.length=0};Pm.prototype.move_to=function(b){this.length++;this.coords.push(b)};var sj=function(b){this.properties=b||{};this.geometries=[]};sj.prototype.json=function(){if(0>=this.geometries.length)return{geometry:{type:"LineString",coordinates:null},
type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var b=[],c=0;c<this.geometries.length;c++)b.push(this.geometries[c].coords);return{geometry:{type:"MultiLineString",coordinates:b},type:"Feature",properties:this.properties}};sj.prototype.wkt=function(){for(var b="",c="LINESTRING(",e=function(d){c+=d[0]+" "+d[1]+","},k=0;k<this.geometries.length;k++){if(0===
this.geometries[k].coords.length)return"LINESTRING(empty)";this.geometries[k].coords.forEach(e);b+=c.substring(0,c.length-1)+")"}return b};var tj=function(b,c,e){if(!b||void 0===b.x||void 0===b.y)throw Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!c||void 0===c.x||void 0===c.y)throw Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Lg(b.x,b.y);this.end=new Lg(c.x,c.y);this.properties=
e||{};if(this.g=2*Math.asin(Math.sqrt(Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin((this.start.x-this.end.x)/2),2))),this.g===Math.PI)throw Error("it appears "+b.view()+" and "+c.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw Error("could not calculate great circle between "+b+" and "+c);};tj.prototype.interpolate=function(b){var c=Math.sin((1-b)*this.g)/
Math.sin(this.g);b=Math.sin(b*this.g)/Math.sin(this.g);var e=c*Math.cos(this.start.y)*Math.cos(this.start.x)+b*Math.cos(this.end.y)*Math.cos(this.end.x),k=c*Math.cos(this.start.y)*Math.sin(this.start.x)+b*Math.cos(this.end.y)*Math.sin(this.end.x);return[Om*Math.atan2(k,e),Om*Math.atan2(c*Math.sin(this.start.y)+b*Math.sin(this.end.y),Math.sqrt(Math.pow(e,2)+Math.pow(k,2)))]};tj.prototype.Arc=function(b,c){var e=[];if(!b||2>=b)e.push([this.start.lon,this.start.lat]),e.push([this.end.lon,this.end.lat]);
else for(var k=1/(b-1),d=0;d<b;++d){var f=this.interpolate(k*d);e.push(f)}f=!1;var l=0,h=c&&c.offset?c.offset:10;b=180-h;k=-180+h;d=360-h;for(c=1;c<e.length;++c){var m=e[c-1][0],p=e[c][0],n=Math.abs(p-m);n>d&&(p>b&&m<k||m>b&&p<k)?f=!0:n>l&&(l=n)}c=[];if(f&&l<h)for(f=[],c.push(f),l=0;l<e.length;++l)if(h=parseFloat(e[l][0]),0<l&&Math.abs(h-e[l-1][0])>d){n=parseFloat(e[l-1][0]);m=parseFloat(e[l-1][1]);var r=parseFloat(e[l][0]);p=parseFloat(e[l][1]);if(-180<n&&n<k&&180===r&&l+1<e.length&&-180<e[l-1][0]&&
e[l-1][0]<k)f.push([-180,e[l][1]]),l++,f.push([e[l][0],e[l][1]]);else if(n>b&&180>n&&-180===r&&l+1<e.length&&e[l-1][0]>b&&180>e[l-1][0])f.push([180,e[l][1]]),l++,f.push([e[l][0],e[l][1]]);else{if(n<k&&r>b){var v=n;n=r;r=v;v=m;m=p;p=v}(n>b&&r<k&&(r+=360),180>=n&&180<=r&&n<r)?(n=(180-n)/(r-n),m=n*p+(1-n)*m,f.push([e[l-1][0]>b?180:-180,m]),(f=[]).push([e[l-1][0]>b?-180:180,m])):f=[];c.push(f);f.push([h,e[l][1]])}}else f.push([e[l][0],e[l][1]]);else for(b=[],c.push(b),k=0;k<e.length;++k)b.push([e[k][0],
e[k][1]]);e=new sj(this.properties);for(b=0;b<c.length;++b)for(k=new Pm,e.geometries.push(k),d=c[b],f=0;f<d.length;++f)k.move_to(d[f]);return e};var Qm=ie(function(b,c){function e(k){var d=[],f;for(f in k)d.push(f);return d}(b.exports="function"==typeof Object.keys?Object.keys:e).shim=e}),Rm=ie(function(b,c){function e(d){return"[object Arguments]"==Object.prototype.toString.call(d)}function k(d){return d&&"object"==typeof d&&"number"==typeof d.length&&Object.prototype.hasOwnProperty.call(d,"callee")&&
!Object.prototype.propertyIsEnumerable.call(d,"callee")||!1}c="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(c=b.exports=c?e:k).supported=e;c.unsupported=k}),Gf=ie(function(b){function c(d){return!(!d||"object"!=typeof d||"number"!=typeof d.length)&&"function"==typeof d.copy&&"function"==typeof d.slice&&!(0<d.length&&"number"!=typeof d[0])}var e=Array.prototype.slice,k=b.exports=function(d,f,l){return l||={},d===f||(d instanceof Date&&f instanceof Date?d.getTime()===
f.getTime():!d||!f||"object"!=typeof d&&"object"!=typeof f?l.strict?d===f:d==f:function(h,m,p){var n,r;if(null==h||null==m||h.prototype!==m.prototype)return!1;if(Rm(h))return!!Rm(m)&&(h=e.call(h),m=e.call(m),k(h,m,p));if(c(h)){if(!c(m)||h.length!==m.length)return!1;for(n=0;n<h.length;n++)if(h[n]!==m[n])return!1;return!0}try{var v=Qm(h),z=Qm(m)}catch(t){return!1}if(v.length!=z.length)return!1;v.sort();z.sort();for(n=v.length-1;0<=n;n--)if(v[n]!=z[n])return!1;for(n=v.length-1;0<=n;n--)if(r=v[n],!k(h[r],
m[r],p))return!1;return typeof h==typeof m}(d,f,l))}}),il={successCallback:null,verbose:!1,polygons:!1},mf={},Nc=64,Rd=16,rb=[],sb=[],tb=[],ub=[],vb=[],wb=[],ib=[],jb=[],kb=[],fb=[],gb=[],hb=[],xb=[],yb=[],zb=[],Ab=[],Bb=[],Cb=[],ob=[],pb=[],qb=[],lb=[],mb=[],nb=[];ib[85]=fb[85]=-1;jb[85]=gb[85]=0;kb[85]=hb[85]=1;ob[85]=lb[85]=1;pb[85]=mb[85]=0;qb[85]=nb[85]=1;rb[85]=ub[85]=0;sb[85]=vb[85]=-1;tb[85]=zb[85]=0;Ab[85]=xb[85]=0;Bb[85]=yb[85]=1;wb[85]=Cb[85]=1;lb[1]=lb[169]=0;mb[1]=mb[169]=-1;nb[1]=nb[169]=
0;xb[1]=xb[169]=-1;yb[1]=yb[169]=0;zb[1]=zb[169]=0;fb[4]=fb[166]=0;gb[4]=gb[166]=-1;hb[4]=hb[166]=1;Ab[4]=Ab[166]=1;Bb[4]=Bb[166]=0;Cb[4]=Cb[166]=0;ib[16]=ib[154]=0;jb[16]=jb[154]=1;kb[16]=kb[154]=1;ub[16]=ub[154]=1;vb[16]=vb[154]=0;wb[16]=wb[154]=1;ob[64]=ob[106]=0;pb[64]=pb[106]=1;qb[64]=qb[106]=0;rb[64]=rb[106]=-1;sb[64]=sb[106]=0;tb[64]=tb[106]=1;ob[2]=ob[168]=0;pb[2]=pb[168]=-1;qb[2]=qb[168]=1;lb[2]=lb[168]=0;mb[2]=mb[168]=-1;nb[2]=nb[168]=0;xb[2]=xb[168]=-1;yb[2]=yb[168]=0;zb[2]=zb[168]=0;Ab[2]=
Ab[168]=-1;Bb[2]=Bb[168]=0;Cb[2]=Cb[168]=1;ib[8]=ib[162]=0;jb[8]=jb[162]=-1;kb[8]=kb[162]=0;fb[8]=fb[162]=0;gb[8]=gb[162]=-1;hb[8]=hb[162]=1;xb[8]=xb[162]=1;yb[8]=yb[162]=0;zb[8]=zb[162]=1;Ab[8]=Ab[162]=1;Bb[8]=Bb[162]=0;Cb[8]=Cb[162]=0;ib[32]=ib[138]=0;jb[32]=jb[138]=1;kb[32]=kb[138]=1;fb[32]=fb[138]=0;gb[32]=gb[138]=1;hb[32]=hb[138]=0;rb[32]=rb[138]=1;sb[32]=sb[138]=0;tb[32]=tb[138]=0;ub[32]=ub[138]=1;vb[32]=vb[138]=0;wb[32]=wb[138]=1;lb[128]=lb[42]=0;mb[128]=mb[42]=1;nb[128]=nb[42]=1;ob[128]=ob[42]=
0;pb[128]=pb[42]=1;qb[128]=qb[42]=0;rb[128]=rb[42]=-1;sb[128]=sb[42]=0;tb[128]=tb[42]=1;ub[128]=ub[42]=-1;vb[128]=vb[42]=0;wb[128]=wb[42]=0;fb[5]=fb[165]=-1;gb[5]=gb[165]=0;hb[5]=hb[165]=0;lb[5]=lb[165]=1;mb[5]=mb[165]=0;nb[5]=nb[165]=0;Ab[20]=Ab[150]=0;Bb[20]=Bb[150]=1;Cb[20]=Cb[150]=1;ub[20]=ub[150]=0;vb[20]=vb[150]=-1;wb[20]=wb[150]=1;ib[80]=ib[90]=-1;jb[80]=jb[90]=0;kb[80]=kb[90]=1;ob[80]=ob[90]=1;pb[80]=pb[90]=0;qb[80]=qb[90]=1;xb[65]=xb[105]=0;yb[65]=yb[105]=1;zb[65]=zb[105]=0;rb[65]=rb[105]=
0;sb[65]=sb[105]=-1;tb[65]=tb[105]=0;ib[160]=ib[10]=-1;jb[160]=jb[10]=0;kb[160]=kb[10]=1;fb[160]=fb[10]=-1;gb[160]=gb[10]=0;hb[160]=hb[10]=0;lb[160]=lb[10]=1;mb[160]=mb[10]=0;nb[160]=nb[10]=0;ob[160]=ob[10]=1;pb[160]=pb[10]=0;qb[160]=qb[10]=1;Ab[130]=Ab[40]=0;Bb[130]=Bb[40]=1;Cb[130]=Cb[40]=1;xb[130]=xb[40]=0;yb[130]=yb[40]=1;zb[130]=zb[40]=0;rb[130]=rb[40]=0;sb[130]=sb[40]=-1;tb[130]=tb[40]=0;ub[130]=ub[40]=0;vb[130]=vb[40]=-1;wb[130]=wb[40]=1;fb[37]=fb[133]=0;gb[37]=gb[133]=1;hb[37]=hb[133]=1;lb[37]=
lb[133]=0;mb[37]=mb[133]=1;nb[37]=nb[133]=0;rb[37]=rb[133]=-1;sb[37]=sb[133]=0;tb[37]=tb[133]=0;ub[37]=ub[133]=1;vb[37]=vb[133]=0;wb[37]=wb[133]=0;Ab[148]=Ab[22]=-1;Bb[148]=Bb[22]=0;Cb[148]=Cb[22]=0;lb[148]=lb[22]=0;mb[148]=mb[22]=-1;nb[148]=nb[22]=1;ob[148]=ob[22]=0;pb[148]=pb[22]=1;qb[148]=qb[22]=1;ub[148]=ub[22]=-1;vb[148]=vb[22]=0;wb[148]=wb[22]=1;ib[82]=ib[88]=0;jb[82]=jb[88]=-1;kb[82]=kb[88]=1;Ab[82]=Ab[88]=1;Bb[82]=Bb[88]=0;Cb[82]=Cb[88]=1;xb[82]=xb[88]=-1;yb[82]=yb[88]=0;zb[82]=zb[88]=1;ob[82]=
ob[88]=0;pb[82]=pb[88]=-1;qb[82]=qb[88]=0;ib[73]=ib[97]=0;jb[73]=jb[97]=1;kb[73]=kb[97]=0;fb[73]=fb[97]=0;gb[73]=gb[97]=-1;hb[73]=hb[97]=0;xb[73]=xb[97]=1;yb[73]=yb[97]=0;zb[73]=zb[97]=0;rb[73]=rb[97]=1;sb[73]=sb[97]=0;tb[73]=tb[97]=1;ib[145]=ib[25]=0;jb[145]=jb[25]=-1;kb[145]=kb[25]=0;xb[145]=xb[25]=1;yb[145]=yb[25]=0;zb[145]=zb[25]=1;lb[145]=lb[25]=0;mb[145]=mb[25]=1;nb[145]=nb[25]=1;ub[145]=ub[25]=-1;vb[145]=vb[25]=0;wb[145]=wb[25]=0;fb[70]=fb[100]=0;gb[70]=gb[100]=1;hb[70]=hb[100]=0;Ab[70]=Ab[100]=
-1;Bb[70]=Bb[100]=0;Cb[70]=Cb[100]=1;ob[70]=ob[100]=0;pb[70]=pb[100]=-1;qb[70]=qb[100]=1;rb[70]=rb[100]=1;sb[70]=sb[100]=0;tb[70]=tb[100]=0;fb[101]=fb[69]=0;gb[101]=gb[69]=1;hb[101]=hb[69]=0;rb[101]=rb[69]=1;sb[101]=sb[69]=0;tb[101]=tb[69]=0;lb[149]=lb[21]=0;mb[149]=mb[21]=1;nb[149]=nb[21]=1;ub[149]=ub[21]=-1;vb[149]=vb[21]=0;wb[149]=wb[21]=0;Ab[86]=Ab[84]=-1;Bb[86]=Bb[84]=0;Cb[86]=Cb[84]=1;ob[86]=ob[84]=0;pb[86]=pb[84]=-1;qb[86]=qb[84]=1;ib[89]=ib[81]=0;jb[89]=jb[81]=-1;kb[89]=kb[81]=0;xb[89]=xb[81]=
1;yb[89]=yb[81]=0;zb[89]=zb[81]=1;ib[96]=ib[74]=0;jb[96]=jb[74]=1;kb[96]=kb[74]=0;fb[96]=fb[74]=-1;gb[96]=gb[74]=0;hb[96]=hb[74]=1;ob[96]=ob[74]=1;pb[96]=pb[74]=0;qb[96]=qb[74]=0;rb[96]=rb[74]=1;sb[96]=sb[74]=0;tb[96]=tb[74]=1;ib[24]=ib[146]=0;jb[24]=jb[146]=-1;kb[24]=kb[146]=1;Ab[24]=Ab[146]=1;Bb[24]=Bb[146]=0;Cb[24]=Cb[146]=1;xb[24]=xb[146]=0;yb[24]=yb[146]=1;zb[24]=zb[146]=1;ub[24]=ub[146]=0;vb[24]=vb[146]=-1;wb[24]=wb[146]=0;fb[6]=fb[164]=-1;gb[6]=gb[164]=0;hb[6]=hb[164]=1;Ab[6]=Ab[164]=-1;Bb[6]=
Bb[164]=0;Cb[6]=Cb[164]=0;lb[6]=lb[164]=0;mb[6]=mb[164]=-1;nb[6]=nb[164]=1;ob[6]=ob[164]=1;pb[6]=pb[164]=0;qb[6]=qb[164]=0;xb[129]=xb[41]=0;yb[129]=yb[41]=1;zb[129]=zb[41]=1;lb[129]=lb[41]=0;mb[129]=mb[41]=1;nb[129]=nb[41]=0;rb[129]=rb[41]=-1;sb[129]=sb[41]=0;tb[129]=tb[41]=0;ub[129]=ub[41]=0;vb[129]=vb[41]=-1;wb[129]=wb[41]=0;Ab[66]=Ab[104]=0;Bb[66]=Bb[104]=1;Cb[66]=Cb[104]=0;xb[66]=xb[104]=-1;yb[66]=yb[104]=0;zb[66]=zb[104]=1;ob[66]=ob[104]=0;pb[66]=pb[104]=-1;qb[66]=qb[104]=0;rb[66]=rb[104]=0;
sb[66]=sb[104]=-1;tb[66]=tb[104]=1;ib[144]=ib[26]=-1;jb[144]=jb[26]=0;kb[144]=kb[26]=0;lb[144]=lb[26]=1;mb[144]=mb[26]=0;nb[144]=nb[26]=1;ob[144]=ob[26]=0;pb[144]=pb[26]=1;qb[144]=qb[26]=1;ub[144]=ub[26]=-1;vb[144]=vb[26]=0;wb[144]=wb[26]=1;fb[36]=fb[134]=0;gb[36]=gb[134]=1;hb[36]=hb[134]=1;Ab[36]=Ab[134]=0;Bb[36]=Bb[134]=1;Cb[36]=Cb[134]=0;rb[36]=rb[134]=0;sb[36]=sb[134]=-1;tb[36]=tb[134]=1;ub[36]=ub[134]=1;vb[36]=vb[134]=0;wb[36]=wb[134]=0;ib[9]=ib[161]=-1;jb[9]=jb[161]=0;kb[9]=kb[161]=0;fb[9]=
fb[161]=0;gb[9]=gb[161]=-1;hb[9]=hb[161]=0;xb[9]=xb[161]=1;yb[9]=yb[161]=0;zb[9]=zb[161]=0;lb[9]=lb[161]=1;mb[9]=mb[161]=0;nb[9]=nb[161]=1;ib[136]=0;jb[136]=1;kb[136]=1;fb[136]=0;gb[136]=1;hb[136]=0;Ab[136]=-1;Bb[136]=0;Cb[136]=1;xb[136]=-1;yb[136]=0;zb[136]=0;lb[136]=0;mb[136]=-1;nb[136]=0;ob[136]=0;pb[136]=-1;qb[136]=1;rb[136]=1;sb[136]=0;tb[136]=0;ub[136]=1;vb[136]=0;wb[136]=1;ib[34]=0;jb[34]=-1;kb[34]=0;fb[34]=0;gb[34]=-1;hb[34]=1;Ab[34]=1;Bb[34]=0;Cb[34]=0;xb[34]=1;yb[34]=0;zb[34]=1;lb[34]=0;
mb[34]=1;nb[34]=1;ob[34]=0;pb[34]=1;qb[34]=0;rb[34]=-1;sb[34]=0;tb[34]=1;ub[34]=-1;vb[34]=0;wb[34]=0;ib[35]=0;jb[35]=1;kb[35]=1;fb[35]=0;gb[35]=-1;hb[35]=1;Ab[35]=1;Bb[35]=0;Cb[35]=0;xb[35]=-1;yb[35]=0;zb[35]=0;lb[35]=0;mb[35]=-1;nb[35]=0;ob[35]=0;pb[35]=1;qb[35]=0;rb[35]=-1;sb[35]=0;tb[35]=1;ub[35]=1;vb[35]=0;wb[35]=1;ib[153]=0;jb[153]=1;kb[153]=1;xb[153]=-1;yb[153]=0;zb[153]=0;lb[153]=0;mb[153]=-1;nb[153]=0;ub[153]=1;vb[153]=0;wb[153]=1;fb[102]=0;gb[102]=-1;hb[102]=1;Ab[102]=1;Bb[102]=0;Cb[102]=
0;ob[102]=0;pb[102]=1;qb[102]=0;rb[102]=-1;sb[102]=0;tb[102]=1;ib[155]=0;jb[155]=-1;kb[155]=0;xb[155]=1;yb[155]=0;zb[155]=1;lb[155]=0;mb[155]=1;nb[155]=1;ub[155]=-1;vb[155]=0;wb[155]=0;fb[103]=0;gb[103]=1;hb[103]=0;Ab[103]=-1;Bb[103]=0;Cb[103]=1;ob[103]=0;pb[103]=-1;qb[103]=1;rb[103]=1;sb[103]=0;tb[103]=0;ib[152]=0;jb[152]=1;kb[152]=1;Ab[152]=-1;Bb[152]=0;Cb[152]=1;xb[152]=-1;yb[152]=0;zb[152]=0;lb[152]=0;mb[152]=-1;nb[152]=0;ob[152]=0;pb[152]=-1;qb[152]=1;ub[152]=1;vb[152]=0;wb[152]=1;ib[156]=0;
jb[156]=-1;kb[156]=1;Ab[156]=1;Bb[156]=0;Cb[156]=1;xb[156]=-1;yb[156]=0;zb[156]=0;lb[156]=0;mb[156]=-1;nb[156]=0;ob[156]=0;pb[156]=1;qb[156]=1;ub[156]=-1;vb[156]=0;wb[156]=1;ib[137]=0;jb[137]=1;kb[137]=1;fb[137]=0;gb[137]=1;hb[137]=0;xb[137]=-1;yb[137]=0;zb[137]=0;lb[137]=0;mb[137]=-1;nb[137]=0;rb[137]=1;sb[137]=0;tb[137]=0;ub[137]=1;vb[137]=0;wb[137]=1;ib[139]=0;jb[139]=1;kb[139]=1;fb[139]=0;gb[139]=-1;hb[139]=0;xb[139]=1;yb[139]=0;zb[139]=0;lb[139]=0;mb[139]=1;nb[139]=0;rb[139]=-1;sb[139]=0;tb[139]=
0;ub[139]=1;vb[139]=0;wb[139]=1;ib[98]=0;jb[98]=-1;kb[98]=0;fb[98]=0;gb[98]=-1;hb[98]=1;Ab[98]=1;Bb[98]=0;Cb[98]=0;xb[98]=1;yb[98]=0;zb[98]=1;ob[98]=0;pb[98]=1;qb[98]=0;rb[98]=-1;sb[98]=0;tb[98]=1;ib[99]=0;jb[99]=1;kb[99]=0;fb[99]=0;gb[99]=-1;hb[99]=1;Ab[99]=1;Bb[99]=0;Cb[99]=0;xb[99]=-1;yb[99]=0;zb[99]=1;ob[99]=0;pb[99]=-1;qb[99]=0;rb[99]=1;sb[99]=0;tb[99]=1;fb[38]=0;gb[38]=-1;hb[38]=1;Ab[38]=1;Bb[38]=0;Cb[38]=0;lb[38]=0;mb[38]=1;nb[38]=1;ob[38]=0;pb[38]=1;qb[38]=0;rb[38]=-1;sb[38]=0;tb[38]=1;ub[38]=
-1;vb[38]=0;wb[38]=0;fb[39]=0;gb[39]=1;hb[39]=1;Ab[39]=-1;Bb[39]=0;Cb[39]=0;lb[39]=0;mb[39]=-1;nb[39]=1;ob[39]=0;pb[39]=1;qb[39]=0;rb[39]=-1;sb[39]=0;tb[39]=1;ub[39]=1;vb[39]=0;wb[39]=0;var uj=function(b){return[[b.bottomleft,0],[0,0],[0,b.leftbottom]]},vj=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0]]},wj=function(b){return[[b.topright,1],[1,1],[1,b.righttop]]},xj=function(b){return[[0,b.lefttop],[0,1],[b.topleft,1]]},yj=function(b){return[[b.bottomright,0],[b.bottomleft,0],[0,b.leftbottom],
[0,b.lefttop]]},zj=function(b){return[[b.bottomright,0],[b.bottomleft,0],[1,b.righttop],[1,b.rightbottom]]},Aj=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.topleft,1],[b.topright,1]]},Bj=function(b){return[[0,b.leftbottom],[0,b.lefttop],[b.topleft,1],[b.topright,1]]},Ha=[],Ga=[],La=[],Ja=[],Ua=[],Ta=[],eb=[],Db=[];Ja[1]=Ua[1]=18;Ja[169]=Ua[169]=18;La[4]=Ga[4]=12;La[166]=Ga[166]=12;Ha[16]=Db[16]=4;Ha[154]=Db[154]=4;Ta[64]=eb[64]=22;Ta[106]=eb[106]=22;La[2]=Ta[2]=17;Ja[2]=Ua[2]=18;La[168]=
Ta[168]=17;Ja[168]=Ua[168]=18;Ha[8]=Ja[8]=9;Ga[8]=La[8]=12;Ha[162]=Ja[162]=9;Ga[162]=La[162]=12;Ha[32]=Db[32]=4;Ga[32]=eb[32]=1;Ha[138]=Db[138]=4;Ga[138]=eb[138]=1;Ua[128]=Db[128]=21;Ta[128]=eb[128]=22;Ua[42]=Db[42]=21;Ta[42]=eb[42]=22;Ga[5]=Ua[5]=14;Ga[165]=Ua[165]=14;La[20]=Db[20]=6;La[150]=Db[150]=6;Ha[80]=Ta[80]=11;Ha[90]=Ta[90]=11;Ja[65]=eb[65]=3;Ja[105]=eb[105]=3;Ha[160]=Ta[160]=11;Ga[160]=Ua[160]=14;Ha[10]=Ta[10]=11;Ga[10]=Ua[10]=14;La[130]=Db[130]=6;Ja[130]=eb[130]=3;La[40]=Db[40]=6;Ja[40]=
eb[40]=3;Ga[101]=eb[101]=1;Ga[69]=eb[69]=1;Ua[149]=Db[149]=21;Ua[21]=Db[21]=21;La[86]=Ta[86]=17;La[84]=Ta[84]=17;Ha[89]=Ja[89]=9;Ha[81]=Ja[81]=9;Ha[96]=eb[96]=0;Ga[96]=Ta[96]=15;Ha[74]=eb[74]=0;Ga[74]=Ta[74]=15;Ha[24]=La[24]=8;Ja[24]=Db[24]=7;Ha[146]=La[146]=8;Ja[146]=Db[146]=7;Ga[6]=Ta[6]=15;La[6]=Ua[6]=16;Ga[164]=Ta[164]=15;La[164]=Ua[164]=16;Ja[129]=Db[129]=7;Ua[129]=eb[129]=20;Ja[41]=Db[41]=7;Ua[41]=eb[41]=20;La[66]=eb[66]=2;Ja[66]=Ta[66]=19;La[104]=eb[104]=2;Ja[104]=Ta[104]=19;Ha[144]=Ua[144]=
10;Ta[144]=Db[144]=23;Ha[26]=Ua[26]=10;Ta[26]=Db[26]=23;Ga[36]=Db[36]=5;La[36]=eb[36]=2;Ga[134]=Db[134]=5;La[134]=eb[134]=2;Ha[9]=Ua[9]=10;Ga[9]=Ja[9]=13;Ha[161]=Ua[161]=10;Ga[161]=Ja[161]=13;Ga[37]=Db[37]=5;Ua[37]=eb[37]=20;Ga[133]=Db[133]=5;Ua[133]=eb[133]=20;La[148]=Ua[148]=16;Ta[148]=Db[148]=23;La[22]=Ua[22]=16;Ta[22]=Db[22]=23;Ha[82]=La[82]=8;Ja[82]=Ta[82]=19;Ha[88]=La[88]=8;Ja[88]=Ta[88]=19;Ha[73]=eb[73]=0;Ga[73]=Ja[73]=13;Ha[97]=eb[97]=0;Ga[97]=Ja[97]=13;Ha[145]=Ja[145]=9;Ua[145]=Db[145]=21;
Ha[25]=Ja[25]=9;Ua[25]=Db[25]=21;Ga[70]=eb[70]=1;La[70]=Ta[70]=17;Ga[100]=eb[100]=1;La[100]=Ta[100]=17;Ha[34]=Ja[34]=9;Ga[34]=La[34]=12;Ua[34]=Db[34]=21;Ta[34]=eb[34]=22;Ha[136]=Db[136]=4;Ga[136]=eb[136]=1;La[136]=Ta[136]=17;Ja[136]=Ua[136]=18;Ha[35]=Db[35]=4;Ga[35]=La[35]=12;Ja[35]=Ua[35]=18;Ta[35]=eb[35]=22;Ha[153]=Db[153]=4;Ja[153]=Ua[153]=18;Ga[102]=La[102]=12;Ta[102]=eb[102]=22;Ha[155]=Ja[155]=9;Ua[155]=Db[155]=23;Ga[103]=eb[103]=1;La[103]=Ta[103]=17;Ha[152]=Db[152]=4;La[152]=Ta[152]=17;Ja[152]=
Ua[152]=18;Ha[156]=La[156]=8;Ja[156]=Ua[156]=18;Ta[156]=Db[156]=23;Ha[137]=Db[137]=4;Ga[137]=eb[137]=1;Ja[137]=Ua[137]=18;Ha[139]=Db[139]=4;Ga[139]=Ja[139]=13;Ua[139]=eb[139]=20;Ha[98]=Ja[98]=9;Ga[98]=La[98]=12;Ta[98]=eb[98]=22;Ha[99]=eb[99]=0;Ga[99]=La[99]=12;Ja[99]=Ta[99]=19;Ga[38]=La[38]=12;Ua[38]=Db[38]=21;Ta[38]=eb[38]=22;Ga[39]=Db[39]=5;La[39]=Ua[39]=16;Ta[39]=eb[39]=22;var Ea=[];Ea[1]=Ea[169]=uj;Ea[4]=Ea[166]=vj;Ea[16]=Ea[154]=wj;Ea[64]=Ea[106]=xj;Ea[168]=Ea[2]=yj;Ea[162]=Ea[8]=zj;Ea[138]=
Ea[32]=Aj;Ea[42]=Ea[128]=Bj;Ea[5]=Ea[165]=function(b){return[[0,0],[0,b.leftbottom],[1,b.rightbottom],[1,0]]};Ea[20]=Ea[150]=function(b){return[[1,0],[b.bottomright,0],[b.topright,1],[1,1]]};Ea[80]=Ea[90]=function(b){return[[1,1],[1,b.righttop],[0,b.lefttop],[0,1]]};Ea[65]=Ea[105]=function(b){return[[b.bottomleft,0],[0,0],[0,1],[b.topleft,1]]};Ea[160]=Ea[10]=function(b){return[[1,b.righttop],[1,b.rightbottom],[0,b.leftbottom],[0,b.lefttop]]};Ea[130]=Ea[40]=function(b){return[[b.topleft,1],[b.topright,
1],[b.bottomright,0],[b.bottomleft,0]]};Ea[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]};Ea[101]=Ea[69]=function(b){return[[1,b.rightbottom],[1,0],[0,0],[0,1],[b.topleft,1]]};Ea[149]=Ea[21]=function(b){return[[b.topright,1],[1,1],[1,0],[0,0],[0,b.leftbottom]]};Ea[86]=Ea[84]=function(b){return[[1,0],[b.bottomright,0],[0,b.lefttop],[0,1],[1,1]]};Ea[89]=Ea[81]=function(b){return[[1,1],[1,b.righttop],[b.bottomleft,0],[0,0],[0,1]]};Ea[96]=Ea[74]=function(b){return[[1,b.righttop],[1,b.rightbottom],[0,
b.lefttop],[0,1],[b.topleft,1]]};Ea[24]=Ea[146]=function(b){return[[1,1],[1,b.righttop],[b.bottomright,0],[b.bottomleft,0],[b.topright,1]]};Ea[6]=Ea[164]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.leftbottom],[0,b.lefttop]]};Ea[129]=Ea[41]=function(b){return[[b.topright,1],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topleft,1]]};Ea[66]=Ea[104]=function(b){return[[b.bottomright,0],[b.bottomleft,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[144]=Ea[26]=function(b){return[[1,1],[1,
b.righttop],[0,b.leftbottom],[0,b.lefttop],[b.topright,1]]};Ea[36]=Ea[134]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[b.topleft,1],[b.topright,1]]};Ea[9]=Ea[161]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomleft,0],[0,0],[0,b.leftbottom]]};Ea[37]=Ea[133]=function(b){return[[1,b.rightbottom],[1,0],[0,0],[0,b.leftbottom],[b.topleft,1],[b.topright,1]]};Ea[148]=Ea[22]=function(b){return[[1,1],[1,0],[b.bottomright,0],[0,b.leftbottom],[0,b.lefttop],[b.topright,1]]};Ea[82]=
Ea[88]=function(b){return[[1,1],[1,b.righttop],[b.bottomright,0],[b.bottomleft,0],[0,b.lefttop],[0,1]]};Ea[73]=Ea[97]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomleft,0],[0,0],[0,1],[b.topleft,1]]};Ea[145]=Ea[25]=function(b){return[[1,1],[1,b.righttop],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topright,1]]};Ea[70]=Ea[100]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[34]=function(b){return[Bj(b),zj(b)]};Ea[35]=function(b){return[[1,
b.righttop],[1,b.rightbottom],[b.bottomright,0],[b.bottomleft,0],[0,b.leftbottom],[0,b.lefttop],[b.topleft,1],[b.topright,1]]};Ea[136]=function(b){return[Aj(b),yj(b)]};Ea[153]=function(b){return[wj(b),uj(b)]};Ea[102]=function(b){return[vj(b),xj(b)]};Ea[155]=function(b){return[[1,1],[1,b.righttop],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topright,1]]};Ea[103]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[152]=function(b){return[wj(b),yj(b)]};
Ea[156]=function(b){return[[1,1],[1,b.righttop],[b.bottomright,0],[b.bottomleft,0],[0,b.leftbottom],[0,b.lefttop],[b.topright,1]]};Ea[137]=function(b){return[Aj(b),uj(b)]};Ea[139]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomleft,0],[0,0],[0,b.leftbottom],[b.topleft,1],[b.topright,1]]};Ea[98]=function(b){return[zj(b),xj(b)]};Ea[99]=function(b){return[[1,b.righttop],[1,b.rightbottom],[b.bottomright,0],[b.bottomleft,0],[0,b.lefttop],[0,1],[b.topleft,1]]};Ea[38]=function(b){return[vj(b),
Bj(b)]};Ea[39]=function(b){return[[1,b.rightbottom],[1,0],[b.bottomright,0],[0,b.leftbottom],[0,b.lefttop],[b.topleft,1],[b.topright,1]]};var Sm=function(){function b(c){this.id=b.buildId(c);this.coordinates=c;this.innerEdges=[];this.outerEdges=[];this.outerEdgesSorted=!1}return b.buildId=function(c){return c.join(",")},b.prototype.removeInnerEdge=function(c){this.innerEdges=this.innerEdges.filter(function(e){return e.from.id!==c.from.id})},b.prototype.removeOuterEdge=function(c){this.outerEdges=
this.outerEdges.filter(function(e){return e.to.id!==c.to.id})},b.prototype.addOuterEdge=function(c){this.outerEdges.push(c);this.outerEdgesSorted=!1},b.prototype.sortOuterEdges=function(){var c=this;this.outerEdgesSorted||(this.outerEdges.sort(function(e,k){e=e.to;k=k.to;if(0<=e.coordinates[0]-c.coordinates[0]&&0>k.coordinates[0]-c.coordinates[0])return 1;if(0>e.coordinates[0]-c.coordinates[0]&&0<=k.coordinates[0]-c.coordinates[0])return-1;if(0==e.coordinates[0]-c.coordinates[0]&&0==k.coordinates[0]-
c.coordinates[0])return 0<=e.coordinates[1]-c.coordinates[1]||0<=k.coordinates[1]-c.coordinates[1]?e.coordinates[1]-k.coordinates[1]:k.coordinates[1]-e.coordinates[1];var d=Ui(c.coordinates,e.coordinates,k.coordinates);return 0>d?1:0<d?-1:Math.pow(e.coordinates[0]-c.coordinates[0],2)+Math.pow(e.coordinates[1]-c.coordinates[1],2)-(Math.pow(k.coordinates[0]-c.coordinates[0],2)+Math.pow(k.coordinates[1]-c.coordinates[1],2))}),this.outerEdgesSorted=!0)},b.prototype.getOuterEdges=function(){return this.sortOuterEdges(),
this.outerEdges},b.prototype.getOuterEdge=function(c){return this.sortOuterEdges(),this.outerEdges[c]},b.prototype.addInnerEdge=function(c){this.innerEdges.push(c)},b}(),$o=function(){function b(c,e){this.from=c;this.to=e;this.ring=this.symetric=this.label=this.next=void 0;this.from.addOuterEdge(this);this.to.addInnerEdge(this)}return b.prototype.getSymetric=function(){return this.symetric||(this.symetric=new b(this.to,this.from),this.symetric.symetric=this),this.symetric},b.prototype.deleteEdge=
function(){this.from.removeOuterEdge(this);this.to.removeInnerEdge(this)},b.prototype.isEqual=function(c){return this.from.id===c.from.id&&this.to.id===c.to.id},b.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},b.prototype.toLineString=function(){return K([this.from.coordinates,this.to.coordinates])},b.prototype.compareTo=function(c){return Ui(c.from.coordinates,c.to.coordinates,this.to.coordinates)},b}(),Tm=function(){function b(){this.edges=[];this.envelope=this.polygon=
void 0}return b.prototype.push=function(c){this.edges.push(c);this.polygon=this.envelope=void 0},b.prototype.get=function(c){return this.edges[c]},Object.defineProperty(b.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),b.prototype.forEach=function(c){this.edges.forEach(c)},b.prototype.map=function(c){return this.edges.map(c)},b.prototype.some=function(c){return this.edges.some(c)},b.prototype.isValid=function(){return!0},b.prototype.isHole=function(){var c=
this,e=this.edges.reduce(function(f,l,h){return l.from.coordinates[1]>c.edges[f].from.coordinates[1]&&(f=h),f},0),k=(0===e?this.length:e)-1,d=(e+1)%this.length;e=Ui(this.edges[k].from.coordinates,this.edges[e].from.coordinates,this.edges[d].from.coordinates);return 0===e?this.edges[k].from.coordinates[0]>this.edges[d].from.coordinates[0]:0<e},b.prototype.toMultiPoint=function(){return N(this.edges.map(function(c){return c.from.coordinates}))},b.prototype.toPolygon=function(){if(this.polygon)return this.polygon;
var c=this.edges.map(function(e){return e.from.coordinates});return c.push(this.edges[0].from.coordinates),this.polygon=E([c])},b.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=rk(this.toPolygon())},b.findEdgeRingContaining=function(c,e){var k,d,f=c.getEnvelope();return e.forEach(function(l){var h,m,p,n,r=l.getEnvelope();if((d&&(k=d.getEnvelope()),h=r.geometry.coordinates[0].map(function(z){return z[0]}),m=r.geometry.coordinates[0].map(function(z){return z[1]}),
p=f.geometry.coordinates[0].map(function(z){return z[0]}),n=f.geometry.coordinates[0].map(function(z){return z[1]}),Math.max.apply(null,h)!==Math.max.apply(null,p)||Math.max.apply(null,m)!==Math.max.apply(null,n)||Math.min.apply(null,h)!==Math.min.apply(null,p)||Math.min.apply(null,m)!==Math.min.apply(null,n))&&nl(r,f)){var v=void 0;h=function(z){l.some(function(t){return y=z,C=t.from.coordinates,y[0]===C[0]&&y[1]===C[1];var y,C})||(v=z)};m=0;for(p=c.map(function(z){return z.from.coordinates});m<
p.length;m++)h(p[m]);v&&l.inside(u(v))&&(d&&!nl(k,r)||(d=l))}}),d},b.prototype.inside=function(c){return Tb(c,this.toPolygon())},b}(),ap=function(){function b(){this.edges=[];this.nodes={}}return b.fromGeoJson=function(c){if(!c)throw Error("No geojson passed");if("FeatureCollection"!==c.type&&"GeometryCollection"!==c.type&&"MultiLineString"!==c.type&&"LineString"!==c.type&&"Feature"!==c.type)throw Error("Invalid input type '"+c.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature");
!0;var e=new b;return Rb(c,function(k){Ob(k,"LineString","Graph::fromGeoJson");Vb(k,function(d,f){if(d){d=e.getNode(d);var l=e.getNode(f);e.addEdge(d,l)}return f})}),e},b.prototype.getNode=function(c){var e=Sm.buildId(c),k=this.nodes[e];return k||=this.nodes[e]=new Sm(c),k},b.prototype.addEdge=function(c,e){c=new $o(c,e);e=c.getSymetric();this.edges.push(c);this.edges.push(e)},b.prototype.deleteDangles=function(){var c=this;Object.keys(this.nodes).map(function(e){return c.nodes[e]}).forEach(function(e){return c._removeIfDangle(e)})},
b.prototype._removeIfDangle=function(c){var e=this;if(1>=c.innerEdges.length){var k=c.getOuterEdges().map(function(d){return d.to});this.removeNode(c);k.forEach(function(d){return e._removeIfDangle(d)})}},b.prototype.deleteCutEdges=function(){var c=this;this._computeNextCWEdges();this._findLabeledEdgeRings();this.edges.forEach(function(e){e.label===e.symetric.label&&(c.removeEdge(e.symetric),c.removeEdge(e))})},b.prototype._computeNextCWEdges=function(c){var e=this;void 0===c?Object.keys(this.nodes).forEach(function(k){return e._computeNextCWEdges(e.nodes[k])}):
c.getOuterEdges().forEach(function(k,d){c.getOuterEdge((0===d?c.getOuterEdges().length:d)-1).symetric.next=k})},b.prototype._computeNextCCWEdges=function(c,e){var k,d;c=c.getOuterEdges();for(var f=c.length-1;0<=f;--f){var l=c[f],h=l.symetric,m=void 0,p=void 0;l.label===e&&(m=l);h.label===e&&(p=h);m&&p&&(p&&(d=p),m&&(d&&(d.next=m,d=void 0),k||=m))}d&&(d.next=k)},b.prototype._findLabeledEdgeRings=function(){var c=[],e=0;return this.edges.forEach(function(k){if(!(0<=k.label)){c.push(k);var d=k;do d.label=
e,d=d.next;while(!k.isEqual(d));e++}}),c},b.prototype.getEdgeRings=function(){var c=this;this._computeNextCWEdges();this.edges.forEach(function(k){k.label=void 0});this._findLabeledEdgeRings().forEach(function(k){c._findIntersectionNodes(k).forEach(function(d){c._computeNextCCWEdges(d,k.label)})});var e=[];return this.edges.forEach(function(k){k.ring||e.push(c._findEdgeRing(k))}),e},b.prototype._findIntersectionNodes=function(c){var e=[],k=c,d=function(){var f=0;k.from.getOuterEdges().forEach(function(l){l.label===
c.label&&++f});1<f&&e.push(k.from);k=k.next};do d();while(!c.isEqual(k));return e},b.prototype._findEdgeRing=function(c){var e=c,k=new Tm;do k.push(e),e.ring=k,e=e.next;while(!c.isEqual(e));return k},b.prototype.removeNode=function(c){var e=this;c.getOuterEdges().forEach(function(k){return e.removeEdge(k)});c.innerEdges.forEach(function(k){return e.removeEdge(k)});delete this.nodes[c.id]},b.prototype.removeEdge=function(c){this.edges=this.edges.filter(function(e){return!e.isEqual(c)});c.deleteEdge()},
b}(),Td=function(b){this.precision=b&&b.precision?b.precision:17;this.direction=!(!b||!b.direction)&&b.direction;this.pseudoNode=!(!b||!b.pseudoNode)&&b.pseudoNode;this.objectComparator=b&&b.objectComparator?b.objectComparator:mo};Td.prototype.compare=function(b,c){if(b.type!==c.type||!wl(b,c))return!1;switch(b.type){case "Point":return this.compareCoord(b.coordinates,c.coordinates);case "LineString":return this.compareLine(b.coordinates,c.coordinates,0,!1);case "Polygon":return this.comparePolygon(b,
c);case "Feature":return this.compareFeature(b,c);default:if(0===b.type.indexOf("Multi")){var e=this;b=vl(b);c=vl(c);return b.every(function(k){return this.some(function(d){return e.compare(k,d)})},c)}}return!1};Td.prototype.compareCoord=function(b,c){if(b.length!==c.length)return!1;for(var e=0;e<b.length;e++)if(b[e].toFixed(this.precision)!==c[e].toFixed(this.precision))return!1;return!0};Td.prototype.compareLine=function(b,c,e,k){if(!wl(b,c))return!1;b=this.pseudoNode?b:this.removePseudo(b);c=this.pseudoNode?
c:this.removePseudo(c);if(!k||this.compareCoord(b[0],c[0])||(c=this.fixStartIndex(c,b)))return k=this.compareCoord(b[e],c[e]),this.direction||k?this.comparePath(b,c):!!this.compareCoord(b[e],c[c.length-(1+e)])&&this.comparePath(b.slice().reverse(),c)};Td.prototype.fixStartIndex=function(b,c){for(var e,k=-1,d=0;d<b.length;d++)if(this.compareCoord(b[d],c[0])){k=d;break}return 0<=k&&(e=[].concat(b.slice(k,b.length),b.slice(1,k+1))),e};Td.prototype.comparePath=function(b,c){var e=this;return b.every(function(k,
d){return e.compareCoord(k,this[d])},c)};Td.prototype.comparePolygon=function(b,c){if(this.compareLine(b.coordinates[0],c.coordinates[0],1,!0)){b=b.coordinates.slice(1,b.coordinates.length);c=c.coordinates.slice(1,c.coordinates.length);var e=this;return b.every(function(k){return this.some(function(d){return e.compareLine(k,d,1,!0)})},c)}return!1};Td.prototype.compareFeature=function(b,c){return!(b.id!==c.id||!this.objectComparator(b.properties,c.properties)||!this.compareBBox(b,c))&&this.compare(b.geometry,
c.geometry)};Td.prototype.compareBBox=function(b,c){return!!(!b.bbox&&!c.bbox||b.bbox&&c.bbox&&this.compareCoord(b.bbox,c.bbox))};Td.prototype.removePseudo=function(b){return b};var bp=ie(function(b){function c(e,k,d,f){this.dataset=[];this.epsilon=1;this.minPts=2;this.distance=this._euclideanDistance;this.clusters=[];this.noise=[];this._visited=[];this._assigned=[];this._datasetLength=0;this._init(e,k,d,f)}c.prototype.run=function(e,k,d,f){this._init(e,k,d,f);for(e=0;e<this._datasetLength;e++)1!==
this._visited[e]&&(this._visited[e]=1,k=this._regionQuery(e),k.length<this.minPts?this.noise.push(e):(d=this.clusters.length,this.clusters.push([]),this._addToCluster(e,d),this._expandCluster(d,k)));return this.clusters};c.prototype._init=function(e,k,d,f){if(e){if(!(e instanceof Array))throw Error("Dataset must be of type array, "+typeof e+" given");this.dataset=e;this.clusters=[];this.noise=[];this._datasetLength=e.length;this._visited=Array(this._datasetLength);this._assigned=Array(this._datasetLength)}k&&
(this.epsilon=k);d&&(this.minPts=d);f&&(this.distance=f)};c.prototype._expandCluster=function(e,k){for(var d=0;d<k.length;d++){var f=k[d];if(1!==this._visited[f]){this._visited[f]=1;var l=this._regionQuery(f);l.length>=this.minPts&&(k=this._mergeArrays(k,l))}1!==this._assigned[f]&&this._addToCluster(f,e)}};c.prototype._addToCluster=function(e,k){this.clusters[k].push(e);this._assigned[e]=1};c.prototype._regionQuery=function(e){for(var k=[],d=0;d<this._datasetLength;d++)this.distance(this.dataset[e],
this.dataset[d])<this.epsilon&&k.push(d);return k};c.prototype._mergeArrays=function(e,k){for(var d=k.length,f=0;f<d;f++){var l=k[f];0>e.indexOf(l)&&e.push(l)}return e};c.prototype._euclideanDistance=function(e,k){for(var d=0,f=Math.min(e.length,k.length);f--;)d+=(e[f]-k[f])*(e[f]-k[f]);return Math.sqrt(d)};b.exports&&(b.exports=c)}),cp=ie(function(b){function c(e,k,d){this.k=3;this.dataset=[];this.assignments=[];this.centroids=[];this.init(e,k,d)}c.prototype.init=function(e,k,d){this.assignments=
[];this.centroids=[];void 0!==e&&(this.dataset=e);void 0!==k&&(this.k=k);void 0!==d&&(this.distance=d)};c.prototype.run=function(e,k){this.init(e,k);e=this.dataset.length;for(k=0;k<this.k;k++)this.centroids[k]=this.randomCentroid();for(k=!0;k;){k=this.assign();for(var d=0;d<this.k;d++){for(var f=Array(p),l=0,h=0;h<p;h++)f[h]=0;for(var m=0;m<e;m++){var p=this.dataset[m].length;if(d===this.assignments[m]){for(h=0;h<p;h++)f[h]+=this.dataset[m][h];l++}}if(0<l){for(h=0;h<p;h++)f[h]/=l;this.centroids[d]=
f}else this.centroids[d]=this.randomCentroid(),k=!0}}return this.getClusters()};c.prototype.randomCentroid=function(){var e=this.dataset.length-1;do{var k=Math.round(Math.random()*e);k=this.dataset[k]}while(0<=this.centroids.indexOf(k));return k};c.prototype.assign=function(){for(var e,k=!1,d=this.dataset.length,f=0;f<d;f++)(e=this.argmin(this.dataset[f],this.centroids,this.distance))!=this.assignments[f]&&(this.assignments[f]=e,k=!0);return k};c.prototype.getClusters=function(){for(var e,k=Array(this.k),
d=0;d<this.assignments.length;d++)void 0===k[e=this.assignments[d]]&&(k[e]=[]),k[e].push(d);return k};c.prototype.argmin=function(e,k,d){for(var f,l=Number.MAX_VALUE,h=0,m=k.length,p=0;p<m;p++)(f=d(e,k[p]))<l&&(l=f,h=p);return h};c.prototype.distance=function(e,k){for(var d=0,f=Math.min(e.length,k.length);f--;){var l=e[f]-k[f];d+=l*l}return Math.sqrt(d)};b.exports&&(b.exports=c)}),Um=ie(function(b){function c(e,k,d){this._queue=[];this._priorities=[];this._sorting="desc";this._init(e,k,d)}c.prototype.insert=
function(e,k){for(var d=this._queue.length,f=d;f--;){var l=this._priorities[f];"desc"===this._sorting?k>l&&(d=f):k<l&&(d=f)}this._insertAt(e,k,d)};c.prototype.remove=function(e){for(var k=this._queue.length;k--;)if(e===this._queue[k]){this._queue.splice(k,1);this._priorities.splice(k,1);break}};c.prototype.forEach=function(e){this._queue.forEach(e)};c.prototype.getElements=function(){return this._queue};c.prototype.getElementPriority=function(e){return this._priorities[e]};c.prototype.getPriorities=
function(){return this._priorities};c.prototype.getElementsWithPriorities=function(){for(var e=[],k=0,d=this._queue.length;k<d;k++)e.push([this._queue[k],this._priorities[k]]);return e};c.prototype._init=function(e,k,d){if(e&&k){if(this._queue=[],this._priorities=[],e.length!==k.length)throw Error("Arrays must have the same length");for(var f=0;f<e.length;f++)this.insert(e[f],k[f])}d&&(this._sorting=d)};c.prototype._insertAt=function(e,k,d){this._queue.length===d?(this._queue.push(e),this._priorities.push(k)):
(this._queue.splice(d,0,e),this._priorities.splice(d,0,k))};b.exports&&(b.exports=c)}),dp=ie(function(b){function c(k,d,f,l){this.minPts=this.epsilon=1;this.distance=this._euclideanDistance;this._reachability=[];this._processed=[];this._coreDistance=0;this._orderedList=[];this._init(k,d,f,l)}if(b.exports)var e=Um;c.prototype.run=function(k,d,f,l){this._init(k,d,f,l);k=0;for(d=this.dataset.length;k<d;k++)if(1!==this._processed[k]){this._processed[k]=1;this.clusters.push([k]);f=this.clusters.length-
1;this._orderedList.push(k);l=new e(null,null,"asc");var h=this._regionQuery(k);void 0!==this._distanceToCore(k)&&(this._updateQueue(k,h,l),this._expandCluster(f,l))}return this.clusters};c.prototype.getReachabilityPlot=function(){for(var k=[],d=0,f=this._orderedList.length;d<f;d++){var l=this._orderedList[d];k.push([l,this._reachability[l]])}return k};c.prototype._init=function(k,d,f,l){if(k){if(!(k instanceof Array))throw Error("Dataset must be of type array, "+typeof k+" given");this.dataset=k;
this.clusters=[];this._reachability=Array(this.dataset.length);this._processed=Array(this.dataset.length);this._coreDistance=0;this._orderedList=[]}d&&(this.epsilon=d);f&&(this.minPts=f);l&&(this.distance=l)};c.prototype._updateQueue=function(k,d,f){var l=this;this._coreDistance=this._distanceToCore(k);d.forEach(function(h){if(void 0===l._processed[h]){var m=l.distance(l.dataset[k],l.dataset[h]);m=Math.max(l._coreDistance,m);void 0===l._reachability[h]?(l._reachability[h]=m,f.insert(h,m)):m<l._reachability[h]&&
(l._reachability[h]=m,f.remove(h),f.insert(h,m))}})};c.prototype._expandCluster=function(k,d){for(var f=d.getElements(),l=0,h=f.length;l<h;l++){var m=f[l];if(void 0===this._processed[m]){var p=this._regionQuery(m);this._processed[m]=1;this.clusters[k].push(m);this._orderedList.push(m);void 0!==this._distanceToCore(m)&&(this._updateQueue(m,p,d),this._expandCluster(k,d))}}};c.prototype._distanceToCore=function(k){for(var d=this.epsilon,f=0;f<d;f++)if(this._regionQuery(k,f).length>=this.minPts)return f};
c.prototype._regionQuery=function(k,d){d=d||this.epsilon;for(var f=[],l=0,h=this.dataset.length;l<h;l++)this.distance(this.dataset[k],this.dataset[l])<d&&f.push(l);return f};c.prototype._euclideanDistance=function(k,d){for(var f=0,l=Math.min(k.length,d.length);l--;)f+=(k[l]-d[l])*(k[l]-d[l]);return Math.sqrt(f)};b.exports&&(b.exports=c)}),ep=ie(function(b){b.exports&&(b.exports={DBSCAN:bp,KMEANS:cp,OPTICS:dp,PriorityQueue:Um})}),Vm=function(b,c,e){for(var k=b.length,d=0,f=0;f<k;f++){var l=(b[f]||
0)-(c[f]||0);d+=l*l}return e?Math.sqrt(d):d},fp=function(b,c,e){b=Math.abs(b-c);return e?b:b*b},gp=function(b,c){var e=b[0].length?Vm:fp,k=[],d=b.length,f=b[Math.floor(Math.random()*d)];0<b[0].length&&f.join("_");for(k.push(f);k.length<c;){var l=[],h=k.length,m=0;f=[];for(var p=0;p<d;p++){for(var n=1/0,r=0;r<h;r++){var v=e(b[p],k[r]);v<=n&&(n=v)}l[p]=n}for(h=0;h<d;h++)m+=l[h];for(h=0;h<d;h++)f[h]={i:h,v:b[h],pr:l[h]/m,cs:0};f.sort(function(z,t){return z.pr-t.pr});f[0].cs=f[0].pr;for(l=1;l<d;l++)f[l].cs=
f[l-1].cs+f[l].pr;l=Math.random();for(m=0;m<d-1&&f[m++].cs<l;);k.push(f[m-1].v)}return k},hp=function(b,c,e,k){var d=[],f=[],l=[];k=k||1E4;var h=b.length,m=b[0].length,p=0<m,n=[];if(e)if("kmrand"==e){d={};e=[];var r=c<<2;var v=b.length;for(var z=0<b[0].length;e.length<c&&0<r--;){var t=b[Math.floor(Math.random()*v)],y=z?t.join("_"):""+t;d[y]||(d[y]=!0,e.push(t))}if(e.length<c)throw Error("Error initializating clusters");d=e}else d="kmpp"==e?gp(b,c):e;else for(e={};d.length<c;)r=Math.floor(Math.random()*
h),e[r]||(e[r]=!0,d.push(b[r]));do{yl(c,0,n);for(e=0;e<h;e++){r=1/0;for(z=v=0;z<c;z++)(l=p?Vm(b[e],d[z]):Math.abs(b[e]-d[z]))<=r&&(r=l,v=z);f[e]=v;n[v]++}r=[];for(v=(e=[],0);v<c;v++)r[v]=p?yl(m,0,r[v]):0,e[v]=d[v];if(p){for(v=0;v<c;v++)d[v]=[];for(v=0;v<h;v++)for(z=r[f[v]],t=b[v],y=0;y<m;y++)z[y]+=t[y];v=!0;for(z=0;z<c;z++){t=d[z];var C=r[z];y=e[z];for(var w=n[z],x=0;x<m;x++)t[x]=C[x]/w||0;if(v)for(C=0;C<m;C++)if(y[C]!=t[C]){v=!1;break}}}else{for(v=0;v<h;v++)r[f[v]]+=b[v];for(v=0;v<c;v++)d[v]=r[v]/
n[v]||0;v=!0;for(r=0;r<c;r++)if(e[r]!=d[r]){v=!1;break}}v=v||0>=--k}while(!v);return{it:1E4-k,k:c,idxs:f,centroids:d}},Vh={search:function(b,c,e,k){b.cleanDirty();var d=(k=k||{}).heuristic||Vh.heuristics.manhattan;k=k.closest||!1;var f=new Bl(function(z){return z.f}),l=c;c.h=d(c,e);for(f.push(c);0<f.size();){c=f.pop();if(c===e)return Al(c);c.closed=!0;for(var h=b.neighbors(c),m=0,p=h.length;m<p;++m){var n=h[m];if(!n.closed&&!n.isWall()){var r=c.g+n.getCost(c),v=n.visited;(!v||r<n.g)&&(n.visited=!0,
n.parent=c,n.h=n.h||d(n,e),n.g=r,n.f=n.g+n.h,b.markDirty(n),k&&(n.h<l.h||n.h===l.h&&n.g<l.g)&&(l=n),v?f.rescoreElement(n):f.push(n))}}}return k?Al(l):[]},heuristics:{manhattan:function(b,c){return Math.abs(c.x-b.x)+Math.abs(c.y-b.y)},diagonal:function(b,c){var e=Math.abs(c.x-b.x);b=Math.abs(c.y-b.y);return 1*(e+b)+(Math.sqrt(2)-2)*Math.min(e,b)}},cleanNode:function(b){b.f=0;b.g=0;b.h=0;b.visited=!1;b.closed=!1;b.parent=null}};If.prototype.init=function(){this.dirtyNodes=[];for(var b=0;b<this.nodes.length;b++)Vh.cleanNode(this.nodes[b])};
If.prototype.cleanDirty=function(){for(var b=0;b<this.dirtyNodes.length;b++)Vh.cleanNode(this.dirtyNodes[b]);this.dirtyNodes=[]};If.prototype.markDirty=function(b){this.dirtyNodes.push(b)};If.prototype.neighbors=function(b){var c=[],e=b.x;b=b.y;var k=this.grid;return k[e-1]&&k[e-1][b]&&c.push(k[e-1][b]),k[e+1]&&k[e+1][b]&&c.push(k[e+1][b]),k[e]&&k[e][b-1]&&c.push(k[e][b-1]),k[e]&&k[e][b+1]&&c.push(k[e][b+1]),this.diagonal&&(k[e-1]&&k[e-1][b-1]&&c.push(k[e-1][b-1]),k[e+1]&&k[e+1][b-1]&&c.push(k[e+
1][b-1]),k[e-1]&&k[e-1][b+1]&&c.push(k[e-1][b+1]),k[e+1]&&k[e+1][b+1]&&c.push(k[e+1][b+1])),c};If.prototype.toString=function(){for(var b,c,e,k,d=[],f=this.grid,l=0,h=f.length;l<h;l++){b=[];e=0;for(k=(c=f[l]).length;e<k;e++)b.push(c[e].weight);d.push(b.join(" "))}return d.join("\n")};Gh.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};Gh.prototype.getCost=function(b){return b&&b.x!==this.x&&b.y!==this.y?1.41421*this.weight:this.weight};Gh.prototype.isWall=function(){return 0===this.weight};
Bl.prototype={push:function(b){this.content.push(b);this.sinkDown(this.content.length-1)},pop:function(){var b=this.content[0],c=this.content.pop();return 0<this.content.length&&(this.content[0]=c,this.bubbleUp(0)),b},remove:function(b){var c=this.content.indexOf(b),e=this.content.pop();c!==this.content.length-1&&(this.content[c]=e,this.scoreFunction(e)<this.scoreFunction(b)?this.sinkDown(c):this.bubbleUp(c))},size:function(){return this.content.length},rescoreElement:function(b){this.sinkDown(this.content.indexOf(b))},
sinkDown:function(b){for(var c=this.content[b];0<b;){var e=(b+1>>1)-1,k=this.content[e];if(!(this.scoreFunction(c)<this.scoreFunction(k)))break;this.content[e]=c;this.content[b]=k;b=e}},bubbleUp:function(b){for(var c=this.content.length,e=this.content[b],k=this.scoreFunction(e);;){var d,f=b+1<<1,l=f-1,h=null;l<c&&(d=this.scoreFunction(this.content[l]))<k&&(h=l);f<c&&this.scoreFunction(this.content[f])<(null===h?k:d)&&(h=f);if(null===h)break;this.content[b]=this.content[h];this.content[h]=e;b=h}}};
Hh.prototype={constructor:Hh,insert:function(b,c){var e,k;if(b){if(c.P=b,c.N=b.N,b.N&&(b.N.P=c),b.N=c,b.R){for(b=b.R;b.L;)b=b.L;b.L=c}else b.R=c;var d=b}else this._?(b=Dl(this._),c.P=null,c.N=b,b.P=b.L=c,d=b):(c.P=c.N=null,this._=c,d=null);c.L=c.R=null;c.U=d;c.C=!0;for(b=c;d&&d.C;)d===(e=d.U).L?(k=e.R)&&k.C?(d.C=k.C=!1,e.C=!0,b=e):(b===d.R&&(Bg(this,d),d=(b=d).U),d.C=!1,e.C=!0,Cg(this,e)):(k=e.L)&&k.C?(d.C=k.C=!1,e.C=!0,b=e):(b===d.L&&(Cg(this,d),d=(b=d).U),d.C=!1,e.C=!0,Bg(this,e)),d=b.U;this._.C=
!1},remove:function(b){b.N&&(b.N.P=b.P);b.P&&(b.P.N=b.N);b.N=b.P=null;var c,e,k,d=b.U,f=b.L,l=b.R;if(e=f?l?Dl(l):f:l,d?d.L===b?d.L=e:d.R=e:this._=e,f&&l?(k=e.C,e.C=b.C,e.L=f,f.U=e,e!==l?(d=e.U,e.U=b.U,b=e.R,d.L=b,e.R=l,l.U=e):(e.U=d,d=e,b=e.R)):(k=b.C,b=e),b&&(b.U=d),!k)if(b&&b.C)b.C=!1;else{do{if(b===this._)break;if(b===d.L){if((c=d.R).C&&(c.C=!1,d.C=!0,Bg(this,d),c=d.R),c.L&&c.L.C||c.R&&c.R.C){c.R&&c.R.C||(c.L.C=!1,c.C=!0,Cg(this,c),c=d.R);c.C=d.C;d.C=c.R.C=!1;Bg(this,d);b=this._;break}}else if((c=
d.L).C&&(c.C=!1,d.C=!0,Cg(this,d),c=d.L),c.L&&c.L.C||c.R&&c.R.C){c.L&&c.L.C||(c.R.C=!1,c.C=!0,Bg(this,c),c=d.L);c.C=d.C;d.C=c.L.C=!1;Cg(this,d);b=this._;break}c.C=!0;b=d;d=d.U}while(!b.C);b&&(b.C=!1)}}};var Wi,Fl=[],Hl=[],Lf,qd,Fg,Vc,Wb=1E-6,uo=1E-12;Yi.prototype={constructor:Yi,polygons:function(){var b=this.edges;return this.cells.map(function(c){var e=c.halfedges.map(function(k){return El(c,b[k])});return e.data=c.site.data,e})},triangles:function(){var b=[],c=this.edges;return this.cells.forEach(function(e,
k){if(f=(d=e.halfedges).length)for(var d,f,l,h,m,p=e.site,n=-1,r=c[d[f-1]],v=r.left===p?r.right:r.left;++n<f;)e=v,v=(r=c[d[n]]).left===p?r.right:r.left,e&&v&&k<e.index&&k<v.index&&(h=e,m=v,0>((l=p)[0]-m[0])*(h[1]-l[1])-(l[0]-h[0])*(m[1]-l[1]))&&b.push([p.data,e.data,v.data])}),b},links:function(){return this.edges.filter(function(b){return b.right}).map(function(b){return{source:b.left.data,target:b.right.data}})},find:function(b,c,e){var k,d,f=this,l=f._found||0;for(k=f.cells.length;!(d=f.cells[l]);)if(++l>=
k)return null;k=b-d.site[0];var h=c-d.site[1],m=k*k+h*h;do d=f.cells[k=l],l=null,d.halfedges.forEach(function(p){var n=f.edges[p];p=n.left;if(p!==d.site&&p||(p=n.right)){n=b-p[0];var r=c-p[1];n=n*n+r*r;n<m&&(m=n,l=p.index)}});while(null!==l);return f._found=k,null==e||m<=e*e?d.site:null}};var ip=Object.freeze({__proto__:null,toMercator:Ol,toWgs84:Ql}),Do=function(){for(var b=0,c=0,e=arguments.length;c<e;c++)b+=arguments[c].length;b=Array(b);var k=0;for(c=0;c<e;c++)for(var d=arguments[c],f=0,l=d.length;f<
l;f++,k++)b[k]=d[f];return b},jp=Object.freeze({__proto__:null,randomPosition:Gg,randomPoint:Ul,randomPolygon:Vl,randomLineString:Wl}),kp=Object.freeze({__proto__:null,getCluster:Xl,clusterEach:$i,clusterReduce:Yl,createBins:aj,applyFilter:Kh,propertiesContainsFilter:bj,filterProperties:Zl}),Pe=function(b,c){this.next=null;this.key=b;this.data=c;this.right=this.left=null},Cj=function(){function b(c){void 0===c&&(c=Eo);this._root=null;this._size=0;this._comparator=c}return b.prototype.insert=function(c,
e){return this._size++,this._root=cj(c,e,this._root,this._comparator)},b.prototype.add=function(c,e){e=new Pe(c,e);null===this._root&&(e.left=e.right=null,this._size++,this._root=e);var k=this._comparator,d=Oe(c,this._root,k);c=k(c,d.key);return 0===c?this._root=d:(0>c?(e.left=d.left,e.right=d,d.left=null):0<c&&(e.right=d.right,e.left=d,d.right=null),this._size++,this._root=e),this._root},b.prototype.remove=function(c){this._root=this._remove(c,this._root,this._comparator)},b.prototype._remove=function(c,
e,k){var d;return null===e?null:0===k(c,(e=Oe(c,e,k)).key)?(null===e.left?d=e.right:(d=Oe(c,e.left,k)).right=e.right,this._size--,d):e},b.prototype.pop=function(){var c=this._root;if(c){for(;c.left;)c=c.left;return this._root=Oe(c.key,this._root,this._comparator),this._root=this._remove(c.key,this._root,this._comparator),{key:c.key,data:c.data}}return null},b.prototype.findStatic=function(c){for(var e=this._root,k=this._comparator;e;){var d=k(c,e.key);if(0===d)return e;e=0>d?e.left:e.right}return null},
b.prototype.find=function(c){return this._root&&(this._root=Oe(c,this._root,this._comparator),0!==this._comparator(c,this._root.key))?null:this._root},b.prototype.contains=function(c){for(var e=this._root,k=this._comparator;e;){var d=k(c,e.key);if(0===d)return!0;e=0>d?e.left:e.right}return!1},b.prototype.forEach=function(c,e){for(var k=this._root,d=[],f=!1;!f;)null!==k?(d.push(k),k=k.left):0!==d.length?(k=d.pop(),c.call(e,k),k=k.right):f=!0;return this},b.prototype.range=function(c,e,k,d){for(var f=
[],l=this._comparator,h=this._root;0!==f.length||h;)if(h)f.push(h),h=h.left;else{if(0<l((h=f.pop()).key,e))break;if(0<=l(h.key,c)&&k.call(d,h))break;h=h.right}return this},b.prototype.keys=function(){var c=[];return this.forEach(function(e){return c.push(e.key)}),c},b.prototype.values=function(){var c=[];return this.forEach(function(e){return c.push(e.data)}),c},b.prototype.min=function(){return this._root?this.minNode(this._root).key:null},b.prototype.max=function(){return this._root?this.maxNode(this._root).key:
null},b.prototype.minNode=function(c){if(void 0===c&&(c=this._root),c)for(;c.left;)c=c.left;return c},b.prototype.maxNode=function(c){if(void 0===c&&(c=this._root),c)for(;c.right;)c=c.right;return c},b.prototype.at=function(c){for(var e=this._root,k=!1,d=0,f=[];!k;)if(e)f.push(e),e=e.left;else if(0<f.length){if(e=f.pop(),d===c)return e;d++;e=e.right}else k=!0;return null},b.prototype.next=function(c){var e=this._root,k=null;if(c.right){for(k=c.right;k.left;)k=k.left;return k}for(var d=this._comparator;e;){var f=
d(c.key,e.key);if(0===f)break;0>f?(k=e,e=e.left):e=e.right}return k},b.prototype.prev=function(c){var e=this._root,k=null;if(null!==c.left){for(k=c.left;k.right;)k=k.right;return k}for(var d=this._comparator;e;){var f=d(c.key,e.key);if(0===f)break;0>f?e=e.left:(k=e,e=e.right)}return k},b.prototype.clear=function(){return this._root=null,this._size=0,this},b.prototype.toList=function(){for(var c=this._root,e=[],k=!1,d=new Pe(null,null),f=d;!k;)c?(e.push(c),c=c.left):0<e.length?c=(c=f=f.next=e.pop()).right:
k=!0;return f.next=null,d.next},b.prototype.load=function(c,e,k){void 0===e&&(e=[]);void 0===k&&(k=!1);var d=c.length,f=this._comparator;(k&&gj(c,e,0,d-1,f),null===this._root)?(this._root=ej(c,e,0,d),this._size=d):(c=function(l,h,m){for(var p=new Pe(null,null),n=p;null!==l&&null!==h;)0>m(l.key,h.key)?(n.next=l,l=l.next):(n.next=h,h=h.next),n=n.next;null!==l?n.next=l:null!==h&&(n.next=h);return p.next}(this.toList(),function(l,h){for(var m=new Pe(null,null),p=m,n=0;n<l.length;n++)p=p.next=new Pe(l[n],
h[n]);return p.next=null,m.next}(c,e),f),d=this._size+d,this._root=fj({head:c},0,d));return this},b.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(b.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),b.prototype.toString=function(c){void 0===c&&(c=function(k){return String(k.key)});var e=[];return dj(this._root,"",!0,function(k){return e.push(k)},
c),e.join("")},b.prototype.update=function(c,e,k){var d=this._comparator,f=$l(c,this._root,d),l=f.left;f=f.right;0>d(c,e)?f=cj(e,k,f,d):l=cj(e,k,l,d);c=l;e=f;this._root=null===e?c:(null===c||((e=Oe(c.key,e,d)).left=c),e)},b.prototype.split=function(c){return $l(c,this._root,this._comparator)},b}(),Mg=function(b,c){return b.ll.x<=c.x&&c.x<=b.ur.x&&b.ll.y<=c.y&&c.y<=b.ur.y},Dj=function(b,c){return c.ur.x<b.ll.x||b.ur.x<c.ll.x||c.ur.y<b.ll.y||b.ur.y<c.ll.y?null:{ll:{x:b.ll.x<c.ll.x?c.ll.x:b.ll.x,y:b.ll.y<
c.ll.y?c.ll.y:b.ll.y},ur:{x:b.ur.x<c.ur.x?b.ur.x:c.ur.x,y:b.ur.y<c.ur.y?b.ur.y:c.ur.y}}},Se=Number.EPSILON;void 0===Se&&(Se=Math.pow(2,-52));var lp=Se*Se,Ej=function(b,c){if(-Se<b&&b<Se&&-Se<c&&c<Se)return 0;var e=b-c;return e*e<lp*b*c?0:b<c?-1:1},mp=function(){function b(){yd(this,b);this.reset()}return bd(b,[{key:"reset",value:function(){this.xRounder=new Wm;this.yRounder=new Wm}},{key:"round",value:function(c,e){return{x:this.xRounder.round(c),y:this.yRounder.round(e)}}}]),b}(),Wm=function(){function b(){yd(this,
b);this.tree=new Cj;this.round(0)}return bd(b,[{key:"round",value:function(c){var e=this.tree.add(c),k=this.tree.prev(e);if(null!==k&&0===Ej(e.key,k.key))return this.tree.remove(c),k.key;k=this.tree.next(e);return null!==k&&0===Ej(e.key,k.key)?(this.tree.remove(c),k.key):c}}]),b}(),Ng=new mp,Og=function(b,c){return b.x*c.y-b.y*c.x},Pg=function(b,c){return b.x*c.x+b.y*c.y},Xm=function(b,c,e){b=Og({x:c.x-b.x,y:c.y-b.y},{x:e.x-b.x,y:e.y-b.y});return Ej(b,0)},Ym=function(b,c,e){return 0===c.y?null:{x:b.x+
c.x/c.y*(e-b.y),y:e}},Zm=function(b,c,e){return 0===c.x?null:{x:e,y:b.y+c.y/c.x*(e-b.x)}},oe=function(){function b(c,e){yd(this,b);void 0===c.events?c.events=[this]:c.events.push(this);this.point=c;this.isLeft=e}return bd(b,null,[{key:"compare",value:function(c,e){var k=b.comparePoints(c.point,e.point);return 0!==k?k:(c.point!==e.point&&c.link(e),c.isLeft!==e.isLeft?c.isLeft?1:-1:Wh.compare(c.segment,e.segment))}},{key:"comparePoints",value:function(c,e){return c.x<e.x?-1:c.x>e.x?1:c.y<e.y?-1:c.y>
e.y?1:0}}]),bd(b,[{key:"link",value:function(c){if(c.point===this.point)throw Error("Tried to link already linked events");c=c.point.events;for(var e=0,k=c.length;e<k;e++){var d=c[e];this.point.events.push(d);d.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var c=this.point.events.length,e=0;e<c;e++){var k=this.point.events[e];if(void 0===k.segment.consumedBy)for(var d=e+1;d<c;d++){var f=this.point.events[d];void 0===f.consumedBy&&k.otherSE.point.events===
f.otherSE.point.events&&k.segment.consume(f.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var c=[],e=0,k=this.point.events.length;e<k;e++){var d=this.point.events[e];d!==this&&!d.segment.ringOut&&d.segment.isInResult()&&c.push(d)}return c}},{key:"getLeftmostComparator",value:function(c){var e=this,k=new Map,d=function(f){var l,h,m,p,n,r=f.otherSE,v=k.set,z=(l=e.point,h=c.point,m=r.point,p={x:h.x-l.x,y:h.y-l.y},n={x:m.x-l.x,y:m.y-l.y},Og(n,p)/Math.sqrt(Pg(n,n))/Math.sqrt(Pg(p,p)));
l=e.point;h=c.point;r=r.point;h={x:h.x-l.x,y:h.y-l.y};r={x:r.x-l.x,y:r.y-l.y};r=Pg(r,h)/Math.sqrt(Pg(r,r))/Math.sqrt(Pg(h,h));v.call(k,f,{sine:z,cosine:r})};return function(f,l){k.has(f)||d(f);k.has(l)||d(l);var h=k.get(f);f=h.sine;h=h.cosine;var m=k.get(l);l=m.sine;m=m.cosine;return 0<=f&&0<=l?h<m?1:h>m?-1:0:0>f&&0>l?h<m?-1:h>m?1:0:l<f?-1:l>f?1:0}}}]),b}(),np=0,Wh=function(){function b(c,e,k,d){yd(this,b);this.id=++np;this.leftSE=c;c.segment=this;this.rightSE=c.otherSE=e;e.segment=this;e.otherSE=
c;this.rings=k;this.windings=d}return bd(b,null,[{key:"compare",value:function(c,e){var k=c.leftSE.point.x,d=e.leftSE.point.x,f=c.rightSE.point.x,l=e.rightSE.point.x;if(l<k)return 1;if(f<d)return-1;var h=c.leftSE.point.y,m=e.leftSE.point.y,p=c.rightSE.point.y,n=e.rightSE.point.y;if(k<d){if(m<h&&m<p)return 1;if(m>h&&m>p)return-1;f=c.comparePoint(e.leftSE.point);if(0>f)return 1;if(0<f)return-1;c=e.comparePoint(c.rightSE.point);return 0!==c?c:-1}if(k>d){if(h<m&&h<n)return-1;if(h>m&&h>n)return 1;f=e.comparePoint(c.leftSE.point);
if(0!==f)return f;c=c.comparePoint(e.rightSE.point);return 0>c?1:0<c?-1:1}if(h<m)return-1;if(h>m)return 1;if(f<l){var r=e.comparePoint(c.rightSE.point);if(0!==r)return r}if(f>l){r=c.comparePoint(e.rightSE.point);if(0>r)return 1;if(0<r)return-1}if(f!==l){h=p-h;k=f-k;m=n-m;d=l-d;if(h>k&&m<d)return 1;if(h<k&&m>d)return-1}return f>l?1:f<l||p<n?-1:p>n?1:c.id<e.id?-1:c.id>e.id?1:0}}]),bd(b,[{key:"replaceRightSE",value:function(c){this.rightSE=c;this.rightSE.segment=this;this.rightSE.otherSE=this.leftSE;
this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var c=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:c<e?c:e},ur:{x:this.rightSE.point.x,y:c>e?c:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(c){return c.x===this.leftSE.point.x&&c.y===this.leftSE.point.y||c.x===this.rightSE.point.x&&c.y===this.rightSE.point.y}},{key:"comparePoint",
value:function(c){if(this.isAnEndpoint(c))return 0;var e=this.leftSE.point,k=this.rightSE.point,d=this.vector();if(e.x===k.x)return c.x===e.x?0:c.x<e.x?1:-1;if(c.x===e.x+(c.y-e.y)/d.y*d.x)return 0;e=e.y+(c.x-e.x)/d.x*d.y;return c.y===e?0:c.y<e?-1:1}},{key:"getIntersection",value:function(c){var e=this.bbox(),k=c.bbox(),d=Dj(e,k);if(null===d)return null;var f=this.leftSE.point,l=this.rightSE.point,h=c.leftSE.point,m=c.rightSE.point,p=Mg(e,h)&&0===this.comparePoint(h),n=Mg(k,f)&&0===c.comparePoint(f);
e=Mg(e,m)&&0===this.comparePoint(m);k=Mg(k,l)&&0===c.comparePoint(l);if(n&&p)return k&&!e?l:!k&&e?m:null;if(n)return e&&f.x===m.x&&f.y===m.y?null:f;if(p)return k&&l.x===h.x&&l.y===h.y?null:h;if(k&&e)return null;if(k)return l;if(e)return m;c=function(r,v,z,t){if(0===v.x)return Zm(z,t,r.x);if(0===t.x)return Zm(r,v,z.x);if(0===v.y)return Ym(z,t,r.y);if(0===t.y)return Ym(r,v,z.y);var y=Og(v,t);if(0==y)return null;var C={x:z.x-r.x,y:z.y-r.y},w=Og(C,v)/y;y=Og(C,t)/y;return{x:(r.x+y*v.x+(z.x+w*t.x))/2,y:(r.y+
y*v.y+(z.y+w*t.y))/2}}(f,this.vector(),h,c.vector());return null===c?null:Mg(d,c)?Ng.round(c.x,c.y):null}},{key:"split",value:function(c){var e=[],k=void 0!==c.events,d=new oe(c,!0);c=new oe(c,!1);var f=this.rightSE;this.replaceRightSE(c);e.push(c);e.push(d);f=new b(d,f,this.rings.slice(),this.windings.slice());return 0<oe.comparePoints(f.leftSE.point,f.rightSE.point)&&f.swapEvents(),0<oe.comparePoints(this.leftSE.point,this.rightSE.point)&&this.swapEvents(),k&&(d.checkForConsuming(),c.checkForConsuming()),
e}},{key:"swapEvents",value:function(){var c=this.rightSE;this.rightSE=this.leftSE;this.leftSE=c;this.leftSE.isLeft=!0;this.rightSE.isLeft=!1;c=0;for(var e=this.windings.length;c<e;c++)this.windings[c]*=-1}},{key:"consume",value:function(c){for(var e=this;e.consumedBy;)e=e.consumedBy;for(;c.consumedBy;)c=c.consumedBy;var k=b.compare(e,c);if(0!==k){0<k&&(k=e,e=c,c=k);e.prev===c&&(k=e,e=c,c=k);k=0;for(var d=c.rings.length;k<d;k++){var f=c.rings[k],l=c.windings[k],h=e.rings.indexOf(f);-1===h?(e.rings.push(f),
e.windings.push(l)):e.windings[h]+=l}c.rings=null;c.windings=null;c.consumedBy=e;c.leftSE.consumedBy=e.leftSE;c.rightSE.consumedBy=e.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState?this._beforeState:this._beforeState=this.prev?(this.prev.consumedBy||
this.prev).afterState():{rings:[],windings:[],multiPolys:[]}}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var c=this.beforeState();this._afterState={rings:c.rings.slice(0),windings:c.windings.slice(0),multiPolys:[]};var e=this._afterState.rings,k=this._afterState.windings;c=this._afterState.multiPolys;for(var d=0,f=this.rings.length;d<f;d++){var l=this.rings[d],h=this.windings[d],m=e.indexOf(l);-1===m?(e.push(l),k.push(h)):k[m]+=h}d=[];f=[];l=0;for(h=e.length;l<
h;l++)if(0!==k[l]){m=e[l];var p=m.poly;-1===f.indexOf(p)&&(m.isExterior?d.push(p):(-1===f.indexOf(p)&&f.push(p),m=d.indexOf(m.poly),-1!==m&&d.splice(m,1)))}e=0;for(k=d.length;e<k;e++)f=d[e].multiPoly,-1===c.indexOf(f)&&c.push(f);return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var c=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Ud.type){case "union":this._isInResult=0===c.length!==(0===
e.length);break;case "intersection":var k,d;c.length<e.length?(k=c.length,d=e.length):(k=e.length,d=c.length);this._isInResult=d===Ud.numMultiPolys&&k<d;break;case "xor":this._isInResult=1==Math.abs(c.length-e.length)%2;break;case "difference":this._isInResult=(1===c.length&&c[0].isSubject)!==(1===e.length&&e[0].isSubject);break;default:throw Error("Unrecognized operation type found ".concat(Ud.type));}return this._isInResult}}],[{key:"fromRing",value:function(c,e,k){var d=oe.comparePoints(c,e);if(0>
d)d=c,c=e,e=1;else{if(!(0<d))throw Error("Tried to create degenerate segment at [".concat(c.x,", ").concat(c.y,"]"));d=e;e=-1}return new b(new oe(d,!0),new oe(c,!1),[k],[e])}}]),b}(),$m=function(){function b(c,e,k){if(yd(this,b),!Array.isArray(c)||0===c.length)throw Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=k,this.segments=[],"number"!=typeof c[0][0]||"number"!=typeof c[0][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");e=
Ng.round(c[0][0],c[0][1]);this.bbox={ll:{x:e.x,y:e.y},ur:{x:e.x,y:e.y}};k=e;for(var d=1,f=c.length;d<f;d++){if("number"!=typeof c[d][0]||"number"!=typeof c[d][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");var l=Ng.round(c[d][0],c[d][1]);l.x===k.x&&l.y===k.y||(this.segments.push(Wh.fromRing(k,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),k=l)}e.x===
k.x&&e.y===k.y||this.segments.push(Wh.fromRing(k,e,this))}return bd(b,[{key:"getSweepEvents",value:function(){for(var c=[],e=0,k=this.segments.length;e<k;e++){var d=this.segments[e];c.push(d.leftSE);c.push(d.rightSE)}return c}}]),b}(),op=function(){function b(c,e){if(yd(this,b),!Array.isArray(c))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new $m(c[0],this,!0);this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,
y:this.exteriorRing.bbox.ur.y}};this.interiorRings=[];for(var k=1,d=c.length;k<d;k++){var f=new $m(c[k],this,!1);f.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=f.bbox.ll.x);f.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=f.bbox.ll.y);f.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=f.bbox.ur.x);f.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=f.bbox.ur.y);this.interiorRings.push(f)}this.multiPoly=e}return bd(b,[{key:"getSweepEvents",value:function(){for(var c=this.exteriorRing.getSweepEvents(),e=0,k=this.interiorRings.length;e<
k;e++)for(var d=this.interiorRings[e].getSweepEvents(),f=0,l=d.length;f<l;f++)c.push(d[f]);return c}}]),b}(),an=function(){function b(c,e){if(yd(this,b),!Array.isArray(c))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof c[0][0][0]&&(c=[c])}catch(l){}this.polys=[];this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var k=0,d=c.length;k<d;k++){var f=new op(c[k],this);f.bbox.ll.x<
this.bbox.ll.x&&(this.bbox.ll.x=f.bbox.ll.x);f.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=f.bbox.ll.y);f.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=f.bbox.ur.x);f.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=f.bbox.ur.y);this.polys.push(f)}this.isSubject=e}return bd(b,[{key:"getSweepEvents",value:function(){for(var c=[],e=0,k=this.polys.length;e<k;e++)for(var d=this.polys[e].getSweepEvents(),f=0,l=d.length;f<l;f++)c.push(d[f]);return c}}]),b}(),pp=function(){function b(c){yd(this,b);this.events=c;for(var e=
0,k=c.length;e<k;e++)c[e].segment.ringOut=this;this.poly=null}return bd(b,null,[{key:"factory",value:function(c){for(var e=[],k=0,d=c.length;k<d;k++){var f=c[k];if(f.isInResult()&&!f.ringOut){var l,h=f.leftSE,m=f.rightSE;f=[h];for(var p=h.point,n=[];l=h,h=m,f.push(h),h.point!==p;)for(;;){m=h.getAvailableLinkedEvents();if(0===m.length)throw c=f[0].point,e=f[f.length-1].point,Error("Unable to complete output ring starting at [".concat(c.x,",")+" ".concat(c.y,"]. Last matching segment found ends at")+
" [".concat(e.x,", ").concat(e.y,"]."));if(1===m.length){m=m[0].otherSE;break}for(var r=null,v=0,z=n.length;v<z;v++)if(n[v].point===h.point){r=v;break}if(null===r){n.push({index:f.length,point:h.point});l=h.getLeftmostComparator(l);m=m.sort(l)[0].otherSE;break}m=n.splice(r)[0];m=f.splice(m.index);m.unshift(m[0].otherSE);e.push(new b(m.reverse()))}e.push(new b(f))}}return e}}]),bd(b,[{key:"getGeom",value:function(){for(var c=this.events[0].point,e=[c],k=1,d=this.events.length-1;k<d;k++){var f=this.events[k].point;
0!==Xm(f,c,this.events[k+1].point)&&(e.push(f),c=f)}if(1===e.length)return null;0===Xm(e[0],c,e[1])&&e.shift();e.push(e[0]);c=this.isExteriorRing()?1:-1;f=this.isExteriorRing()?0:e.length-1;k=this.isExteriorRing()?e.length:-1;for(d=[];f!=k;f+=c)d.push([e[f].x,e[f].y]);return d}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var c=this.enclosingRing();this._isExteriorRing=!c||!c.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===
this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var c=this.events[0],e=1,k=this.events.length;e<k;e++){var d=this.events[e];0<oe.compare(c,d)&&(c=d)}for(e=(c=c.segment.prevInResult())?c.prevInResult():null;;){if(!c)return null;if(!e)return c.ringOut;if(e.ringOut!==c.ringOut)return e.ringOut.enclosingRing()!==c.ringOut?c.ringOut:c.ringOut.enclosingRing();e=(c=e.prevInResult())?c.prevInResult():null}}}]),b}(),
bn=function(){function b(c){yd(this,b);this.exteriorRing=c;c.poly=this;this.interiorRings=[]}return bd(b,[{key:"addInterior",value:function(c){this.interiorRings.push(c);c.poly=this}},{key:"getGeom",value:function(){var c=[this.exteriorRing.getGeom()];if(null===c[0])return null;for(var e=0,k=this.interiorRings.length;e<k;e++){var d=this.interiorRings[e].getGeom();null!==d&&c.push(d)}return c}}]),b}(),qp=function(){function b(c){yd(this,b);this.rings=c;this.polys=this._composePolys(c)}return bd(b,
[{key:"getGeom",value:function(){for(var c=[],e=0,k=this.polys.length;e<k;e++){var d=this.polys[e].getGeom();null!==d&&c.push(d)}return c}},{key:"_composePolys",value:function(c){for(var e=[],k=0,d=c.length;k<d;k++){var f=c[k];if(!f.poly)if(f.isExteriorRing())e.push(new bn(f));else{var l=f.enclosingRing();l.poly||e.push(new bn(l));l.poly.addInterior(f)}}return e}}]),b}(),rp=function(){function b(c){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Wh.compare;yd(this,b);this.queue=c;this.tree=
new Cj(e);this.segments=[]}return bd(b,[{key:"process",value:function(c){var e=c.segment,k=[];if(c.consumedBy)return c.isLeft?this.queue.remove(c.otherSE):this.tree.remove(e),k;var d=c.isLeft?this.tree.insert(e):this.tree.find(e);if(!d)throw Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var f=d,l=d,h=d=void 0;void 0===
d;)null===(f=this.tree.prev(f))?d=null:void 0===f.key.consumedBy&&(d=f.key);for(;void 0===h;)null===(l=this.tree.next(l))?h=null:void 0===l.key.consumedBy&&(h=l.key);if(c.isLeft){f=null;if(d&&(l=d.getIntersection(e),null!==l&&(e.isAnEndpoint(l)||(f=l),!d.isAnEndpoint(l)))){l=this._splitSafely(d,l);for(var m=0,p=l.length;m<p;m++)k.push(l[m])}l=null;if(h&&(m=h.getIntersection(e),null!==m&&(e.isAnEndpoint(m)||(l=m),!h.isAnEndpoint(m))))for(h=this._splitSafely(h,m),m=0,p=h.length;m<p;m++)k.push(h[m]);
if(null!==f||null!==l)for(h=null===f?l:null===l?f:0>=oe.comparePoints(f,l)?f:l,this.queue.remove(e.rightSE),k.push(e.rightSE),h=e.split(h),f=0,l=h.length;f<l;f++)k.push(h[f]);0<k.length?(this.tree.remove(e),k.push(c)):(this.segments.push(e),e.prev=d)}else{if(d&&h&&(c=d.getIntersection(h),null!==c)){if(!d.isAnEndpoint(c))for(d=this._splitSafely(d,c),f=0,l=d.length;f<l;f++)k.push(d[f]);if(!h.isAnEndpoint(c))for(c=this._splitSafely(h,c),d=0,h=c.length;d<h;d++)k.push(c[d])}this.tree.remove(e)}return k}},
{key:"_splitSafely",value:function(c,e){this.tree.remove(c);var k=c.rightSE;this.queue.remove(k);e=c.split(e);return e.push(k),void 0===c.consumedBy&&this.tree.insert(c),e}}]),b}(),cn="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1E6,sp="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1E6,Ud=new (function(){function b(){yd(this,b)}return bd(b,[{key:"run",value:function(c,e,k){Ud.type=c;Ng.reset();c=[new an(e,!0)];e=0;for(var d=k.length;e<
d;e++)c.push(new an(k[e],!1));if(Ud.numMultiPolys=c.length,"difference"===Ud.type)for(k=c[0],e=1;e<c.length;)null!==Dj(c[e].bbox,k.bbox)?e++:c.splice(e,1);if("intersection"===Ud.type)for(k=0,e=c.length;k<e;k++){d=c[k];for(var f=k+1,l=c.length;f<l;f++)if(null===Dj(d.bbox,c[f].bbox))return[]}k=new Cj(oe.compare);e=0;for(d=c.length;e<d;e++){f=c[e].getSweepEvents();l=0;for(var h=f.length;l<h;l++)if(k.insert(f[l]),k.size>cn)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");
}c=new rp(k);e=k.size;for(d=k.pop();d;){d=d.key;if(k.size===e)throw c=d.segment,Error("Unable to pop() ".concat(d.isLeft?"left":"right"," SweepEvent ")+"[".concat(d.point.x,", ").concat(d.point.y,"] from segment #").concat(c.id," ")+"[".concat(c.leftSE.point.x,", ").concat(c.leftSE.point.y,"] -> ")+"[".concat(c.rightSE.point.x,", ").concat(c.rightSE.point.y,"] from queue. ")+"Please file a bug report.");if(k.size>cn)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");
if(c.segments.length>sp)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");e=c.process(d);d=0;for(f=e.length;d<f;d++)l=e[d],void 0===l.consumedBy&&k.insert(l);e=k.size;d=k.pop()}Ng.reset();c=pp.factory(c.segments);return(new qp(c)).getGeom()}}]),b}()),Ce={union:function(b){for(var c=arguments.length,e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("union",b,e)},intersection:function(b){for(var c=arguments.length,
e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("intersection",b,e)},xor:function(b){for(var c=arguments.length,e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("xor",b,e)},difference:function(b){for(var c=arguments.length,e=Array(1<c?c-1:0),k=1;k<c;k++)e[k-1]=arguments[k];return Ud.run("difference",b,e)}};"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(b){if(null==this)throw new TypeError(this+" is not an object");
var c=Object(this),e=Math.max(Math.min(c.length,9007199254740991),0)||0,k=1 in arguments&&parseInt(Number(arguments[1]),10)||0;k=0>k?Math.max(e+k,0):Math.min(k,e);var d=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:e;for(d=0>d?Math.max(e+arguments[2],0):Math.min(d,e);k<d;)c[k]=b,++k;return c},writable:!0});Number.isFinite=Number.isFinite||function(b){return"number"==typeof b&&isFinite(b)};Number.isInteger=Number.isInteger||function(b){return"number"==typeof b&&isFinite(b)&&
Math.floor(b)===b};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(b){return b!=b};Math.trunc=Math.trunc||function(b){return 0>b?Math.ceil(b):Math.floor(b)};var nf=function(){};nf.prototype.interfaces_=function(){return[]};nf.prototype.getClass=function(){return nf};nf.prototype.equalsWithTolerance=function(b,c,e){return Math.abs(b-c)<=e};var ac=function(b){function c(e){b.call(this,e);this.name="IllegalArgumentException";this.message=e;this.stack=(new b).stack}
return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c}(Error),Wa=function(){},dn={MAX_VALUE:{configurable:!0}};Wa.isNaN=function(b){return Number.isNaN(b)};Wa.doubleToLongBits=function(b){return b};Wa.longBitsToDouble=function(b){return b};Wa.isInfinite=function(b){return!Number.isFinite(b)};dn.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Wa,dn);var jd=function(){},Xh=function(){},Rf=function(){},sa=function c(){if(this.x=null,
this.y=null,this.z=null,0===arguments.length)this.y=this.x=0,this.z=c.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x;this.y=e.y;this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=c.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},of={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};
sa.prototype.setOrdinate=function(c,e){switch(c){case sa.X:this.x=e;break;case sa.Y:this.y=e;break;case sa.Z:this.z=e;break;default:throw new ac("Invalid ordinate index: "+c);}};sa.prototype.equals2D=function(){if(1===arguments.length){var c=arguments[0];return this.x===c.x&&this.y===c.y}if(2===arguments.length){c=arguments[0];var e=arguments[1];return!!nf.equalsWithTolerance(this.x,c.x,e)&&!!nf.equalsWithTolerance(this.y,c.y,e)}};sa.prototype.getOrdinate=function(c){switch(c){case sa.X:return this.x;
case sa.Y:return this.y;case sa.Z:return this.z}throw new ac("Invalid ordinate index: "+c);};sa.prototype.equals3D=function(c){return this.x===c.x&&this.y===c.y&&(this.z===c.z||Wa.isNaN(this.z))&&Wa.isNaN(c.z)};sa.prototype.equals=function(c){return c instanceof sa&&this.equals2D(c)};sa.prototype.equalInZ=function(c,e){return nf.equalsWithTolerance(this.z,c.z,e)};sa.prototype.compareTo=function(c){return this.x<c.x?-1:this.x>c.x?1:this.y<c.y?-1:this.y>c.y?1:0};sa.prototype.clone=function(){};sa.prototype.copy=
function(){return new sa(this)};sa.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};sa.prototype.distance3D=function(c){var e=this.x-c.x,k=this.y-c.y;c=this.z-c.z;return Math.sqrt(e*e+k*k+c*c)};sa.prototype.distance=function(c){var e=this.x-c.x;c=this.y-c.y;return Math.sqrt(e*e+c*c)};sa.prototype.hashCode=function(){return 37*(629+sa.hashCode(this.x))+sa.hashCode(this.y)};sa.prototype.setCoordinate=function(c){this.x=c.x;this.y=c.y;this.z=c.z};sa.prototype.interfaces_=function(){return[jd,
Xh,id]};sa.prototype.getClass=function(){return sa};sa.hashCode=function(){if(1===arguments.length){var c=Wa.doubleToLongBits(arguments[0]);return Math.trunc((c^c)>>>32)}};of.DimensionalComparator.get=function(){return De};of.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800};of.NULL_ORDINATE.get=function(){return Wa.NaN};of.X.get=function(){return 0};of.Y.get=function(){return 1};of.Z.get=function(){return 2};Object.defineProperties(sa,of);var De=function(c){if((this._dimensionsToTest=2,
0!==arguments.length)&&1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new ac("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};De.prototype.compare=function(c,e){var k=De.compare(c.x,e.x);if(0!==k)return k;k=De.compare(c.y,e.y);return 0!==k?k:2>=this._dimensionsToTest?0:De.compare(c.z,e.z)};De.prototype.interfaces_=function(){return[Rf]};De.prototype.getClass=function(){return De};De.compare=function(c,e){return c<e?-1:c>e?1:Wa.isNaN(c)?Wa.isNaN(e)?0:-1:Wa.isNaN(e)?
1:0};var Sf=function(){};Sf.prototype.create=function(){};Sf.prototype.interfaces_=function(){return[]};Sf.prototype.getClass=function(){return Sf};var ua=function(){},Qg={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ua.prototype.interfaces_=function(){return[]};ua.prototype.getClass=function(){return ua};ua.toLocationSymbol=function(c){switch(c){case ua.EXTERIOR:return"e";case ua.BOUNDARY:return"b";case ua.INTERIOR:return"i";case ua.NONE:return"-"}throw new ac("Unknown location value: "+
c);};Qg.INTERIOR.get=function(){return 0};Qg.BOUNDARY.get=function(){return 1};Qg.EXTERIOR.get=function(){return 2};Qg.NONE.get=function(){return-1};Object.defineProperties(ua,Qg);var Va=function(c,e){return c.interfaces_&&-1<c.interfaces_().indexOf(e)},cd=function(){},en={LOG_10:{configurable:!0}};cd.prototype.interfaces_=function(){return[]};cd.prototype.getClass=function(){return cd};cd.log10=function(c){c=Math.log(c);return Wa.isInfinite(c)||Wa.isNaN(c)?c:c/cd.LOG_10};cd.min=function(c,e,k,d){return e<
c&&(c=e),k<c&&(c=k),d<c&&(c=d),c};cd.clamp=function(c,e,k){if("number"==typeof k&&"number"==typeof c&&"number"==typeof e||Number.isInteger(k)&&Number.isInteger(c)&&Number.isInteger(e))return c<e?e:c>k?k:c};cd.wrap=function(c,e){return 0>c?e- -c%e:c%e};cd.max=function(){if(3===arguments.length){var c=arguments[1],e=arguments[2],k=arguments[0];return c>k&&(k=c),e>k&&(k=e),k}if(4===arguments.length){c=arguments[1];e=arguments[2];k=arguments[3];var d=arguments[0];return c>d&&(d=c),e>d&&(d=e),k>d&&(d=
k),d}};cd.average=function(c,e){return(c+e)/2};en.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(cd,en);var Cd=function(c){this.str=c};Cd.prototype.append=function(c){this.str+=c};Cd.prototype.setCharAt=function(c,e){this.str=this.str.substr(0,c)+e+this.str.substr(c+1)};Cd.prototype.toString=function(c){return this.str};var Dd=function(c){this.value=c};Dd.prototype.intValue=function(){return this.value};Dd.prototype.compareTo=function(c){return this.value<c?-1:this.value>c?1:0};
Dd.isNaN=function(c){return Number.isNaN(c)};var Rg=function(){};Rg.isWhitespace=function(c){return 32>=c&&0<=c||127===c};Rg.toUpperCase=function(c){return c.toUpperCase()};var va=function e(){(this._hi=0,this._lo=0,0===arguments.length)?this.init(0):1===arguments.length?"number"==typeof arguments[0]?this.init(arguments[0]):arguments[0]instanceof e?this.init(arguments[0]):"string"==typeof arguments[0]&&e.call(this,e.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},
rd={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};va.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo};va.prototype.extractSignificantDigits=function(e,k){var d=this.abs(),f=va.magnitude(d._hi),l=va.TEN.pow(f);
(d=d.divide(l)).gt(va.TEN)?(d=d.divide(va.TEN),f+=1):d.lt(va.ONE)&&(d=d.multiply(va.TEN),--f);l=f+1;for(var h=new Cd,m=va.MAX_PRINT_DIGITS-1,p=0;p<=m;p++){e&&p===l&&h.append(".");var n=Math.trunc(d._hi);if(0>n)break;var r=!1,v=0;9<n?(r=!0,v="9"):v="0"+n;h.append(v);d=d.subtract(va.valueOf(n)).multiply(va.TEN);r&&d.selfAdd(va.TEN);n=!0;r=va.magnitude(d._hi);if(0>r&&Math.abs(r)>=m-p&&(n=!1),!n)break}return k[0]=f,h.toString()};va.prototype.sqr=function(){return this.multiply(this)};va.prototype.doubleValue=
function(){return this._hi+this._lo};va.prototype.subtract=function(e){if(e instanceof va)return this.add(e.negate());if("number"==typeof e)return this.add(-e)};va.prototype.equals=function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}};va.prototype.isZero=function(){return 0===this._hi&&0===this._lo};va.prototype.selfSubtract=function(e){if(e instanceof va)return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo);if("number"==typeof e)return this.isNaN()?this:
this.selfAdd(-e,0)};va.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};va.prototype.min=function(e){return this.le(e)?this:e};va.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof va){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){e=arguments[0];var k=arguments[1],d=null,f=null,l=null,h=null,m=null,p=null,n=null,
r=null;return m=this._hi/e,r=(d=(p=va.SPLIT*m)-(d=p-m))*(l=(r=va.SPLIT*e)-(l=r-e))-(n=m*e)+d*(h=e-l)+(f=m-d)*l+f*h,r=m+(p=(this._hi-n-r+this._lo-m*k)/e),this._hi=r,this._lo=m-r+p,this}};va.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};va.prototype.divide=function(e){if(e instanceof va){var k,d=null,f=null,l=null,h=null,m=null;var p=(l=this._hi/e._hi)-(k=(h=va.SPLIT*l)-(k=h-l));m=k*(d=(m=va.SPLIT*e._hi)-(d=m-e._hi))-(h=l*e._hi)+k*(f=e._hi-d)+p*d+p*f;e=m=l+(h=(this._hi-h-m+this._lo-
l*e._lo)/e._hi);return new va(e,l-m+h)}if("number"==typeof e)return Wa.isNaN(e)?va.createNaN():va.copy(this).selfDivide(e,0)};va.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo};va.prototype.pow=function(e){if(0===e)return va.valueOf(1);var k=new va(this),d=va.valueOf(1),f=Math.abs(e);if(1<f)for(;0<f;)1==f%2&&d.selfMultiply(k),0<(f/=2)&&(k=k.sqr());else d=k;return 0>e?d.reciprocal():d};va.prototype.ceil=function(){if(this.isNaN())return va.NaN;var e=Math.ceil(this._hi),
k=0;return e===this._hi&&(k=Math.ceil(this._lo)),new va(e,k)};va.prototype.compareTo=function(e){return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0};va.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()};va.prototype.setValue=function(e){if(e instanceof va||"number"==typeof e)return this.init(e),this};va.prototype.max=function(e){return this.ge(e)?this:e};va.prototype.sqrt=function(){if(this.isZero())return va.valueOf(0);if(this.isNegative())return va.NaN;
var e=1/Math.sqrt(this._hi),k=va.valueOf(this._hi*e);e*=.5*this.subtract(k.sqr())._hi;return k.add(e)};va.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof va){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if("number"==typeof arguments[0]){e=arguments[0];var k=null,d=null,f=null,l=null,h=null,m=null;return l=(f=this._hi+e)-(h=f-this._hi),d=(m=e-h+(this._hi-l)+this._lo)+(f-(k=f+m)),this._hi=k+d,this._lo=d+(k-this._hi),this}}else if(2===arguments.length){m=arguments[0];
e=arguments[1];k=null;f=this._hi+m;var p=this._lo+e;var n=f-(l=f-this._hi);d=p-(h=p-this._lo);m=(k=f+(l=m-l+(this._hi-n)+p))+(l=e-h+(this._lo-d)+(l+(f-k)));return this._hi=m,this._lo=l+(k-m),this}};va.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof va){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){e=arguments[0];var k=arguments[1],d=null,f;var l=(f=
va.SPLIT*this._hi)-this._hi;var h=va.SPLIT*e;l=f-l;var m=this._hi-l;var p=h-e;var n=(f=this._hi*e)+(h=l*(p=h-p)-f+l*(d=e-p)+m*p+m*d+(this._hi*k+this._lo*e));return this._hi=n,this._lo=h+(f-n),this}};va.prototype.selfSqr=function(){return this.selfMultiply(this)};va.prototype.floor=function(){if(this.isNaN())return va.NaN;var e=Math.floor(this._hi),k=0;return e===this._hi&&(k=Math.floor(this._lo)),new va(e,k)};va.prototype.negate=function(){return this.isNaN()?this:new va(-this._hi,-this._lo)};va.prototype.clone=
function(){};va.prototype.multiply=function(e){if(e instanceof va)return e.isNaN()?va.createNaN():va.copy(this).selfMultiply(e);if("number"==typeof e)return Wa.isNaN(e)?va.createNaN():va.copy(this).selfMultiply(e,0)};va.prototype.isNaN=function(){return Wa.isNaN(this._hi)};va.prototype.intValue=function(){return Math.trunc(this._hi)};va.prototype.toString=function(){var e=va.magnitude(this._hi);return-3<=e&&20>=e?this.toStandardNotation():this.toSciNotation()};va.prototype.toStandardNotation=function(){var e=
this.getSpecialNumberString();if(null!==e)return e;var k=Array(1).fill(null);e=this.extractSignificantDigits(!0,k);k=k[0]+1;var d=e;"."===e.charAt(0)?d="0"+e:0>k?d="0."+va.stringOfChar("0",-k)+e:-1===e.indexOf(".")&&(d=e+va.stringOfChar("0",k-e.length)+".0");return this.isNegative()?"-"+d:d};va.prototype.reciprocal=function(){var e,k,d,f,l=null,h;var m=(k=1/this._hi)-(f=(l=va.SPLIT*k)-(f=l-k));var p=(h=va.SPLIT*this._hi)-this._hi;var n=k+(l=(1-(d=k*this._hi)-(f*(p=h-p)-d+f*(e=this._hi-p)+m*p+m*e)-
k*this._lo)/this._hi);return new va(n,k-n+l)};va.prototype.toSciNotation=function(){if(this.isZero())return va.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(null!==e)return e;var k=Array(1).fill(null);e=this.extractSignificantDigits(!1,k);k=va.SCI_NOT_EXPONENT_CHAR+k[0];if("0"===e.charAt(0))throw Error("Found leading zero: "+e);var d="";1<e.length&&(d=e.substring(1));e=e.charAt(0)+"."+d;return this.isNegative()?"-"+e+k:e+k};va.prototype.abs=function(){return this.isNaN()?va.NaN:this.isNegative()?
this.negate():new va(this)};va.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo};va.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo};va.prototype.add=function(e){if(e instanceof va||"number"==typeof e)return va.copy(this).selfAdd(e)};va.prototype.init=function(){if(1===arguments.length)if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else{if(arguments[0]instanceof va){var e=arguments[0];this._hi=e._hi;this._lo=e._lo}}else 2===
arguments.length&&(e=arguments[1],this._hi=arguments[0],this._lo=e)};va.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo};va.prototype.isNegative=function(){return(0>this._hi||0===this._hi)&&0>this._lo};va.prototype.trunc=function(){return this.isNaN()?va.NaN:this.isPositive()?this.floor():this.ceil()};va.prototype.signum=function(){return 0<this._hi?1:0>this._hi?-1:0<this._lo?1:0>this._lo?-1:0};va.prototype.interfaces_=function(){return[id,jd,Xh]};va.prototype.getClass=
function(){return va};va.sqr=function(e){return va.valueOf(e).selfMultiply(e)};va.valueOf=function(e){if("string"==typeof e)return va.parse(e);if("number"==typeof e)return new va(e)};va.sqrt=function(e){return va.valueOf(e).sqrt()};va.parse=function(e){for(var k=0,d=e.length;Rg.isWhitespace(e.charAt(k));)k++;var f=!1;if(k<d){var l=e.charAt(k);"-"!==l&&"+"!==l||(k++,"-"===l&&(f=!0))}l=new va;for(var h=0,m=0,p=0;!(k>=d);){var n=e.charAt(k);if(k++,Rg.isDigit(n))n-=0,l.selfMultiply(va.TEN),l.selfAdd(n),
h++;else{if("."!==n){if("e"===n||"E"===n){k=e.substring(k);try{p=Dd.parseInt(k)}catch(r){throw r instanceof Error?Error("Invalid exponent "+k+" in string "+e):r;}break}throw Error("Unexpected character '"+n+"' at position "+k+" in string "+e);}m=h}}e=l;h=h-m-p;0===h?e=l:0<h?(e=va.TEN.pow(h),e=l.divide(e)):0>h&&(e=va.TEN.pow(-h),e=l.multiply(e));return f?e.negate():e};va.createNaN=function(){return new va(Wa.NaN,Wa.NaN)};va.copy=function(e){return new va(e)};va.magnitude=function(e){e=Math.abs(e);
var k=Math.trunc(Math.floor(Math.log(e)/Math.log(10)));return 10*Math.pow(10,k)<=e&&(k+=1),k};va.stringOfChar=function(e,k){for(var d=new Cd,f=0;f<k;f++)d.append(e);return d.toString()};rd.PI.get=function(){return new va(3.141592653589793,1.2246467991473532E-16)};rd.TWO_PI.get=function(){return new va(6.283185307179586,2.4492935982947064E-16)};rd.PI_2.get=function(){return new va(1.5707963267948966,6.123233995736766E-17)};rd.E.get=function(){return new va(2.718281828459045,1.4456468917292502E-16)};
rd.NaN.get=function(){return new va(Wa.NaN,Wa.NaN)};rd.EPS.get=function(){return 1.23259516440783E-32};rd.SPLIT.get=function(){return 134217729};rd.MAX_PRINT_DIGITS.get=function(){return 32};rd.TEN.get=function(){return va.valueOf(10)};rd.ONE.get=function(){return va.valueOf(1)};rd.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};rd.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(va,rd);var Xc=function(){},fn={DP_SAFE_EPSILON:{configurable:!0}};Xc.prototype.interfaces_=function(){return[]};
Xc.prototype.getClass=function(){return Xc};Xc.orientationIndex=function(e,k,d){var f=Xc.orientationIndexFilter(e,k,d);if(1>=f)return f;f=va.valueOf(k.x).selfAdd(-e.x);e=va.valueOf(k.y).selfAdd(-e.y);var l=va.valueOf(d.x).selfAdd(-k.x);k=va.valueOf(d.y).selfAdd(-k.y);return f.selfMultiply(k).selfSubtract(e.selfMultiply(l)).signum()};Xc.signOfDet2x2=function(e,k,d,f){return e.multiply(f).selfSubtract(k.multiply(d)).signum()};Xc.intersection=function(e,k,d,f){var l=va.valueOf(f.y).selfSubtract(d.y).selfMultiply(va.valueOf(k.x).selfSubtract(e.x)),
h=va.valueOf(f.x).selfSubtract(d.x).selfMultiply(va.valueOf(k.y).selfSubtract(e.y));l=l.subtract(h);h=va.valueOf(f.x).selfSubtract(d.x).selfMultiply(va.valueOf(e.y).selfSubtract(d.y));var m=va.valueOf(f.y).selfSubtract(d.y).selfMultiply(va.valueOf(e.x).selfSubtract(d.x));h=h.subtract(m).selfDivide(l).doubleValue();h=va.valueOf(e.x).selfAdd(va.valueOf(k.x).selfSubtract(e.x).selfMultiply(h)).doubleValue();m=va.valueOf(k.x).selfSubtract(e.x).selfMultiply(va.valueOf(e.y).selfSubtract(d.y));e=va.valueOf(k.y).selfSubtract(e.y).selfMultiply(va.valueOf(e.x).selfSubtract(d.x));
e=m.subtract(e).selfDivide(l).doubleValue();d=va.valueOf(d.y).selfAdd(va.valueOf(f.y).selfSubtract(d.y).selfMultiply(e)).doubleValue();return new sa(h,d)};Xc.orientationIndexFilter=function(e,k,d){var f=(e.x-d.x)*(k.y-d.y);k=(e.y-d.y)*(k.x-d.x);e=f-k;if(0<f){if(0>=k)return Xc.signum(e);f+=k}else{if(!(0>f)||0<=k)return Xc.signum(e);f=-f-k}f*=Xc.DP_SAFE_EPSILON;return e>=f||-e>=f?Xc.signum(e):2};Xc.signum=function(e){return 0<e?1:0>e?-1:0};fn.DP_SAFE_EPSILON.get=function(){return 1E-15};Object.defineProperties(Xc,
fn);var db=function(){},Sg={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Sg.X.get=function(){return 0};Sg.Y.get=function(){return 1};Sg.Z.get=function(){return 2};Sg.M.get=function(){return 3};db.prototype.setOrdinate=function(e,k,d){};db.prototype.size=function(){};db.prototype.getOrdinate=function(e,k){};db.prototype.getCoordinate=function(){};db.prototype.getCoordinateCopy=function(e){};db.prototype.getDimension=function(){};db.prototype.getX=function(e){};db.prototype.clone=
function(){};db.prototype.expandEnvelope=function(e){};db.prototype.copy=function(){};db.prototype.getY=function(e){};db.prototype.toCoordinateArray=function(){};db.prototype.interfaces_=function(){return[Xh]};db.prototype.getClass=function(){return db};Object.defineProperties(db,Sg);var gn=function(){},Tf=function(e){function k(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(k.__proto__=e),k.prototype=Object.create(e&&e.prototype),k.prototype.constructor=k,
k.prototype.interfaces_=function(){return[]},k.prototype.getClass=function(){return k},k}(gn),Oc=function(){};Oc.arraycopy=function(e,k,d,f,l){for(var h=0,m=k;m<k+l;m++)d[f+h]=e[m],h++};Oc.getProperty=function(e){return{"line.separator":"\n"}[e]};var sd=function k(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.y=this.x=0,this.w=1;else if(1===arguments.length){var d=arguments[0];this.x=d.x;this.y=d.y;this.w=1}else if(2===arguments.length)if("number"==typeof arguments[0]&&"number"==
typeof arguments[1])d=arguments[1],this.x=arguments[0],this.y=d,this.w=1;else if(arguments[0]instanceof k&&arguments[1]instanceof k){d=arguments[0];var f=arguments[1];this.x=d.y*f.w-f.y*d.w;this.y=f.x*d.w-d.x*f.w;this.w=d.x*f.y-f.x*d.y}else arguments[0]instanceof sa&&arguments[1]instanceof sa&&(d=arguments[0],f=arguments[1],this.x=d.y-f.y,this.y=f.x-d.x,this.w=d.x*f.y-f.x*d.y);else if(3===arguments.length)d=arguments[1],f=arguments[2],this.x=arguments[0],this.y=d,this.w=f;else if(4===arguments.length){var l=
arguments[0],h=arguments[1],m=arguments[2],p=arguments[3];d=l.y-h.y;f=h.x-l.x;l=l.x*h.y-h.x*l.y;h=m.y-p.y;var n=p.x-m.x;m=m.x*p.y-p.x*m.y;this.x=f*m-n*l;this.y=h*l-d*m;this.w=d*n-h*f}};sd.prototype.getY=function(){var k=this.y/this.w;if(Wa.isNaN(k)||Wa.isInfinite(k))throw new Tf;return k};sd.prototype.getX=function(){var k=this.x/this.w;if(Wa.isNaN(k)||Wa.isInfinite(k))throw new Tf;return k};sd.prototype.getCoordinate=function(){var k=new sa;return k.x=this.getX(),k.y=this.getY(),k};sd.prototype.interfaces_=
function(){return[]};sd.prototype.getClass=function(){return sd};sd.intersection=function(k,d,f,l){var h=k.y-d.y,m=d.x-k.x;k=k.x*d.y-d.x*k.y;d=f.y-l.y;var p=l.x-f.x;f=f.x*l.y-l.x*f.y;l=h*p-d*m;m=(m*f-p*k)/l;h=(d*k-h*f)/l;if(Wa.isNaN(m)||Wa.isInfinite(m)||Wa.isNaN(h)||Wa.isInfinite(h))throw new Tf;return new sa(m,h)};var Ia=function d(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof sa){var f=
arguments[0];this.init(f.x,f.x,f.y,f.y)}else arguments[0]instanceof d&&this.init(arguments[0]);else if(2===arguments.length){f=arguments[0];var l=arguments[1];this.init(f.x,l.x,f.y,l.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},hn={serialVersionUID:{configurable:!0}};Ia.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ia.prototype.equals=function(d){return d instanceof Ia?this.isNull()?d.isNull():this._maxx===d.getMaxX()&&this._maxy===
d.getMaxY()&&this._minx===d.getMinX()&&this._miny===d.getMinY():!1};Ia.prototype.intersection=function(d){return this.isNull()||d.isNull()||!this.intersects(d)?new Ia:new Ia(this._minx>d._minx?this._minx:d._minx,this._maxx<d._maxx?this._maxx:d._maxx,this._miny>d._miny?this._miny:d._miny,this._maxy<d._maxy?this._maxy:d._maxy)};Ia.prototype.isNull=function(){return this._maxx<this._minx};Ia.prototype.getMaxX=function(){return this._maxx};Ia.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof
sa){var d=arguments[0];return this.covers(d.x,d.y)}if(arguments[0]instanceof Ia)return d=arguments[0],!this.isNull()&&!d.isNull()&&d.getMinX()>=this._minx&&d.getMaxX()<=this._maxx&&d.getMinY()>=this._miny&&d.getMaxY()<=this._maxy}else if(2===arguments.length){d=arguments[0];var f=arguments[1];return!this.isNull()&&d>=this._minx&&d<=this._maxx&&f>=this._miny&&f<=this._maxy}};Ia.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Ia){var d=arguments[0];return!this.isNull()&&
!d.isNull()&&!(d._minx>this._maxx||d._maxx<this._minx||d._miny>this._maxy||d._maxy<this._miny)}if(arguments[0]instanceof sa)return d=arguments[0],this.intersects(d.x,d.y)}else if(2===arguments.length){d=arguments[0];var f=arguments[1];return!this.isNull()&&!(d>this._maxx||d<this._minx||f>this._maxy||f<this._miny)}};Ia.prototype.getMinY=function(){return this._miny};Ia.prototype.getMinX=function(){return this._minx};Ia.prototype.expandToInclude=function(){if(1===arguments.length)if(arguments[0]instanceof
sa){var d=arguments[0];this.expandToInclude(d.x,d.y)}else{if(arguments[0]instanceof Ia){d=arguments[0];if(d.isNull())return null;this.isNull()?(this._minx=d.getMinX(),this._maxx=d.getMaxX(),this._miny=d.getMinY(),this._maxy=d.getMaxY()):(d._minx<this._minx&&(this._minx=d._minx),d._maxx>this._maxx&&(this._maxx=d._maxx),d._miny<this._miny&&(this._miny=d._miny),d._maxy>this._maxy&&(this._maxy=d._maxy))}}else if(2===arguments.length){d=arguments[0];var f=arguments[1];this.isNull()?(this._minx=d,this._maxx=
d,this._miny=f,this._maxy=f):(d<this._minx&&(this._minx=d),d>this._maxx&&(this._maxx=d),f<this._miny&&(this._miny=f),f>this._maxy&&(this._maxy=f))}};Ia.prototype.minExtent=function(){if(this.isNull())return 0;var d=this.getWidth(),f=this.getHeight();return d<f?d:f};Ia.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};Ia.prototype.compareTo=function(d){return this.isNull()?d.isNull()?0:-1:d.isNull()?1:this._minx<d._minx?-1:this._minx>d._minx?1:this._miny<d._miny?-1:this._miny>
d._miny?1:this._maxx<d._maxx?-1:this._maxx>d._maxx?1:this._maxy<d._maxy?-1:this._maxy>d._maxy?1:0};Ia.prototype.translate=function(d,f){if(this.isNull())return null;this.init(this.getMinX()+d,this.getMaxX()+d,this.getMinY()+f,this.getMaxY()+f)};Ia.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};Ia.prototype.setToNull=function(){this._minx=0;this._maxx=-1;this._miny=0;this._maxy=-1};Ia.prototype.getHeight=function(){return this.isNull()?
0:this._maxy-this._miny};Ia.prototype.maxExtent=function(){if(this.isNull())return 0;var d=this.getWidth(),f=this.getHeight();return d>f?d:f};Ia.prototype.expandBy=function(){if(1===arguments.length){var d=arguments[0];this.expandBy(d,d)}else if(2===arguments.length){d=arguments[0];var f=arguments[1];if(this.isNull())return null;this._minx-=d;this._maxx+=d;this._miny-=f;this._maxy+=f;(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};Ia.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof
Ia||arguments[0]instanceof sa)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])};Ia.prototype.centre=function(){return this.isNull()?null:new sa((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};Ia.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length)if(arguments[0]instanceof sa){var d=arguments[0];this.init(d.x,d.x,d.y,d.y)}else arguments[0]instanceof Ia&&(d=arguments[0],this._minx=
d._minx,this._maxx=d._maxx,this._miny=d._miny,this._maxy=d._maxy);else if(2===arguments.length){d=arguments[0];var f=arguments[1];this.init(d.x,f.x,d.y,f.y)}else if(4===arguments.length){d=arguments[0];f=arguments[1];var l=arguments[2],h=arguments[3];d<f?(this._minx=d,this._maxx=f):(this._minx=f,this._maxx=d);l<h?(this._miny=l,this._maxy=h):(this._miny=h,this._maxy=l)}};Ia.prototype.getMaxY=function(){return this._maxy};Ia.prototype.distance=function(d){if(this.intersects(d))return 0;var f=0;this._maxx<
d._minx?f=d._minx-this._maxx:this._minx>d._maxx&&(f=this._minx-d._maxx);var l=0;return this._maxy<d._miny?l=d._miny-this._maxy:this._miny>d._maxy&&(l=this._miny-d._maxy),0===f?l:0===l?f:Math.sqrt(f*f+l*l)};Ia.prototype.hashCode=function(){return 37*(37*(37*(629+sa.hashCode(this._minx))+sa.hashCode(this._maxx))+sa.hashCode(this._miny))+sa.hashCode(this._maxy)};Ia.prototype.interfaces_=function(){return[jd,id]};Ia.prototype.getClass=function(){return Ia};Ia.intersects=function(){if(3===arguments.length){var d=
arguments[0],f=arguments[1],l=arguments[2];return l.x>=(d.x<f.x?d.x:f.x)&&l.x<=(d.x>f.x?d.x:f.x)&&l.y>=(d.y<f.y?d.y:f.y)&&l.y<=(d.y>f.y?d.y:f.y)}if(4===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];var h=arguments[3],m=Math.min(l.x,h.x),p=Math.max(l.x,h.x),n=Math.min(d.x,f.x),r=Math.max(d.x,f.x);return!(n>p)&&!(r<m)&&(m=Math.min(l.y,h.y),p=Math.max(l.y,h.y),n=Math.min(d.y,f.y),r=Math.max(d.y,f.y),!(n>p)&&!(r<m))}};hn.serialVersionUID.get=function(){return 0x51845cd552189800};Object.defineProperties(Ia,
hn);var tp=/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,up=/^\s*(\w+)\s*EMPTY\s*$/,Fj=/\s+/,jn=/\)\s*,\s*\(/,vp=/\)\s*\)\s*,\s*\(\s*\(/,Yh=/^\s*\(?(.*?)\)?\s*$/,Zh=function(d){this.geometryFactory=d||new bb};Zh.prototype.read=function(d){var f,l,h;d=d.replace(/[\n\r]/g," ");var m=tp.exec(d);if(-1!==d.search("EMPTY")&&((m=up.exec(d))[2]=void 0),m&&(l=m[1].toLowerCase(),h=m[2],Uf[l]&&(f=Uf[l].apply(this,[h]))),void 0===f)throw Error("Could not parse WKT "+d);return f};Zh.prototype.write=function(d){return this.extractGeometry(d)};
Zh.prototype.extractGeometry=function(d){var f=d.getGeometryType().toLowerCase();if(!pe[f])return null;var l=f.toUpperCase();return d.isEmpty()?l+" EMPTY":l+"("+pe[f].apply(this,[d])+")"};var pe={coordinate:function(d){return d.x+" "+d.y},point:function(d){return pe.coordinate.call(this,d._coordinates._coordinates[0])},multipoint:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push("("+pe.point.apply(this,[d._geometries[l]])+")");return f.join(",")},linestring:function(d){for(var f=
[],l=0,h=d._points._coordinates.length;l<h;++l)f.push(pe.coordinate.apply(this,[d._points._coordinates[l]]));return f.join(",")},linearring:function(d){for(var f=[],l=0,h=d._points._coordinates.length;l<h;++l)f.push(pe.coordinate.apply(this,[d._points._coordinates[l]]));return f.join(",")},multilinestring:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push("("+pe.linestring.apply(this,[d._geometries[l]])+")");return f.join(",")},polygon:function(d){var f=[];f.push("("+pe.linestring.apply(this,
[d._shell])+")");for(var l=0,h=d._holes.length;l<h;++l)f.push("("+pe.linestring.apply(this,[d._holes[l]])+")");return f.join(",")},multipolygon:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push("("+pe.polygon.apply(this,[d._geometries[l]])+")");return f.join(",")},geometrycollection:function(d){for(var f=[],l=0,h=d._geometries.length;l<h;++l)f.push(this.extractGeometry(d._geometries[l]));return f.join(",")}},Uf={point:function(d){if(void 0===d)return this.geometryFactory.createPoint();
d=d.trim().split(Fj);return this.geometryFactory.createPoint(new sa(Number.parseFloat(d[0]),Number.parseFloat(d[1])))},multipoint:function(d){if(void 0===d)return this.geometryFactory.createMultiPoint();for(var f=d.trim().split(","),l=[],h=0,m=f.length;h<m;++h)d=f[h].replace(Yh,"$1"),l.push(Uf.point.apply(this,[d]));return this.geometryFactory.createMultiPoint(l)},linestring:function(d){if(void 0===d)return this.geometryFactory.createLineString();for(var f=d.trim().split(","),l=[],h=0,m=f.length;h<
m;++h)d=f[h].trim().split(Fj),l.push(new sa(Number.parseFloat(d[0]),Number.parseFloat(d[1])));return this.geometryFactory.createLineString(l)},linearring:function(d){if(void 0===d)return this.geometryFactory.createLinearRing();for(var f=d.trim().split(","),l=[],h=0,m=f.length;h<m;++h)d=f[h].trim().split(Fj),l.push(new sa(Number.parseFloat(d[0]),Number.parseFloat(d[1])));return this.geometryFactory.createLinearRing(l)},multilinestring:function(d){if(void 0===d)return this.geometryFactory.createMultiLineString();
for(var f=d.trim().split(jn),l=[],h=0,m=f.length;h<m;++h)d=f[h].replace(Yh,"$1"),l.push(Uf.linestring.apply(this,[d]));return this.geometryFactory.createMultiLineString(l)},polygon:function(d){if(void 0===d)return this.geometryFactory.createPolygon();var f;d=d.trim().split(jn);for(var l=[],h=0,m=d.length;h<m;++h){var p=d[h].replace(Yh,"$1");p=Uf.linestring.apply(this,[p]);p=this.geometryFactory.createLinearRing(p._points);0===h?f=p:l.push(p)}return this.geometryFactory.createPolygon(f,l)},multipolygon:function(d){if(void 0===
d)return this.geometryFactory.createMultiPolygon();for(var f=d.trim().split(vp),l=[],h=0,m=f.length;h<m;++h)d=f[h].replace(Yh,"$1"),l.push(Uf.polygon.apply(this,[d]));return this.geometryFactory.createMultiPolygon(l)},geometrycollection:function(d){if(void 0===d)return this.geometryFactory.createGeometryCollection();d=d.replace(/,\s*([A-Za-z])/g,"|$1").trim().split("|");for(var f=[],l=0,h=d.length;l<h;++l)f.push(this.read(d[l]));return this.geometryFactory.createGeometryCollection(f)}},qe=function(d){this.parser=
new Zh(d)};qe.prototype.write=function(d){return this.parser.write(d)};qe.toLineString=function(d,f){if(2!==arguments.length)throw Error("Not implemented");return"LINESTRING ( "+d.x+" "+d.y+", "+f.x+" "+f.y+" )"};var re=function(d){function f(l){d.call(this,l);this.name="RuntimeException";this.message=l;this.stack=(new d).stack}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f}(Error),$h=function(d){function f(){(d.call(this),0===arguments.length)?d.call(this):
1===arguments.length&&d.call(this,arguments[0])}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},f}(re),Xa=function(){};Xa.prototype.interfaces_=function(){return[]};Xa.prototype.getClass=function(){return Xa};Xa.shouldNeverReachHere=function(){if(0===arguments.length)Xa.shouldNeverReachHere(null);else if(1===arguments.length){var d=arguments[0];throw new $h("Should never reach here"+
(null!==d?": "+d:""));}};Xa.isTrue=function(){var d;if(1===arguments.length)Xa.isTrue(arguments[0],null);else if(2===arguments.length&&(d=arguments[1],!arguments[0]))throw null===d?new $h:new $h(d);};Xa.equals=function(){var d,f,l;if(2===arguments.length)Xa.equals(arguments[0],arguments[1],null);else if(3===arguments.length&&(d=arguments[0],l=arguments[2],!(f=arguments[1]).equals(d)))throw new $h("Expected "+d+" but encountered "+f+(null!==l?": "+l:""));};var Xb=function(){this._result=null;this._inputLines=
Array(2).fill().map(function(){return Array(2)});this._intPt=Array(2).fill(null);this._precisionModel=this._pb=this._pa=this._isProper=this._intLineIndex=null;this._intPt[0]=new sa;this._intPt[1]=new sa;this._pa=this._intPt[0];this._pb=this._intPt[1];this._result=0},pf={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Xb.prototype.getIndexAlongSegment=
function(d,f){return this.computeIntLineIndex(),this._intLineIndex[d][f]};Xb.prototype.getTopologySummary=function(){var d=new Cd;return this.isEndPoint()&&d.append(" endpoint"),this._isProper&&d.append(" proper"),this.isCollinear()&&d.append(" collinear"),d.toString()};Xb.prototype.computeIntersection=function(d,f,l,h){this._inputLines[0][0]=d;this._inputLines[0][1]=f;this._inputLines[1][0]=l;this._inputLines[1][1]=h;this._result=this.computeIntersect(d,f,l,h)};Xb.prototype.getIntersectionNum=function(){return this._result};
Xb.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var d=arguments[0],f=this.getEdgeDistance(d,0),l=this.getEdgeDistance(d,1);f>l?(this._intLineIndex[d][0]=0,this._intLineIndex[d][1]=1):(this._intLineIndex[d][0]=1,this._intLineIndex[d][1]=0)}};Xb.prototype.isProper=function(){return this.hasIntersection()&&
this._isProper};Xb.prototype.setPrecisionModel=function(d){this._precisionModel=d};Xb.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var d=arguments[0],f=0;f<this._result;f++)if(!this._intPt[f].equals2D(this._inputLines[d][0])&&!this._intPt[f].equals2D(this._inputLines[d][1]))return!0;return!1}};Xb.prototype.getIntersection=function(d){return this._intPt[d]};Xb.prototype.isEndPoint=
function(){return this.hasIntersection()&&!this._isProper};Xb.prototype.hasIntersection=function(){return this._result!==Xb.NO_INTERSECTION};Xb.prototype.getEdgeDistance=function(d,f){return Xb.computeEdgeDistance(this._intPt[f],this._inputLines[d][0],this._inputLines[d][1])};Xb.prototype.isCollinear=function(){return this._result===Xb.COLLINEAR_INTERSECTION};Xb.prototype.toString=function(){return qe.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+qe.toLineString(this._inputLines[1][0],
this._inputLines[1][1])+this.getTopologySummary()};Xb.prototype.getEndpoint=function(d,f){return this._inputLines[d][f]};Xb.prototype.isIntersection=function(d){for(var f=0;f<this._result;f++)if(this._intPt[f].equals2D(d))return!0;return!1};Xb.prototype.getIntersectionAlongSegment=function(d,f){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[d][f]]};Xb.prototype.interfaces_=function(){return[]};Xb.prototype.getClass=function(){return Xb};Xb.computeEdgeDistance=function(d,f,l){var h=
Math.abs(l.x-f.x),m=Math.abs(l.y-f.y);if(d.equals(f))h=0;else if(d.equals(l))h=h>m?h:m;else{l=Math.abs(d.x-f.x);var p=Math.abs(d.y-f.y);0!==(h=h>m?l:p)||d.equals(f)||(h=Math.max(l,p))}return Xa.isTrue(!(0===h&&!d.equals(f)),"Bad distance calculation"),h};Xb.nonRobustComputeEdgeDistance=function(d,f,l){l=d.x-f.x;var h=d.y-f.y;l=Math.sqrt(l*l+h*h);return Xa.isTrue(!(0===l&&!d.equals(f)),"Invalid distance calculation"),l};pf.DONT_INTERSECT.get=function(){return 0};pf.DO_INTERSECT.get=function(){return 1};
pf.COLLINEAR.get=function(){return 2};pf.NO_INTERSECTION.get=function(){return 0};pf.POINT_INTERSECTION.get=function(){return 1};pf.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(Xb,pf);var Te=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.isInSegmentEnvelopes=function(l){var h=new Ia(this._inputLines[0][0],this._inputLines[0][1]),m=new Ia(this._inputLines[1][0],this._inputLines[1][1]);
return h.contains(l)&&m.contains(l)},f.prototype.computeIntersection=function(){if(3!==arguments.length)return d.prototype.computeIntersection.apply(this,arguments);var l=arguments[0],h=arguments[1],m=arguments[2];if(this._isProper=!1,Ia.intersects(h,m,l)&&0===Da.orientationIndex(h,m,l)&&0===Da.orientationIndex(m,h,l))return this._isProper=!0,(l.equals(h)||l.equals(m))&&(this._isProper=!1),this._result=d.POINT_INTERSECTION,null;this._result=d.NO_INTERSECTION},f.prototype.normalizeToMinimum=function(l,
h,m,p,n){n.x=this.smallestInAbsValue(l.x,h.x,m.x,p.x);n.y=this.smallestInAbsValue(l.y,h.y,m.y,p.y);l.x-=n.x;l.y-=n.y;h.x-=n.x;h.y-=n.y;m.x-=n.x;m.y-=n.y;p.x-=n.x;p.y-=n.y},f.prototype.safeHCoordinateIntersection=function(l,h,m,p){var n=null;try{n=sd.intersection(l,h,m,p)}catch(r){if(!(r instanceof Tf))throw r;n=f.nearestEndpoint(l,h,m,p)}return n},f.prototype.intersection=function(l,h,m,p){var n=this.intersectionWithNormalization(l,h,m,p);return this.isInSegmentEnvelopes(n)||(n=new sa(f.nearestEndpoint(l,
h,m,p))),null!==this._precisionModel&&this._precisionModel.makePrecise(n),n},f.prototype.smallestInAbsValue=function(l,h,m,p){var n=Math.abs(l);return Math.abs(h)<n&&(l=h,n=Math.abs(h)),Math.abs(m)<n&&(l=m,n=Math.abs(m)),Math.abs(p)<n&&(l=p),l},f.prototype.checkDD=function(l,h,m,p,n){l=Xc.intersection(l,h,m,p);h=this.isInSegmentEnvelopes(l);Oc.out.println("DD in env = "+h+"  --------------------- "+l);1E-4<n.distance(l)&&Oc.out.println("Distance = "+n.distance(l))},f.prototype.intersectionWithNormalization=
function(l,h,m,p){l=new sa(l);h=new sa(h);m=new sa(m);var n=new sa(p);p=new sa;this.normalizeToEnvCentre(l,h,m,n,p);l=this.safeHCoordinateIntersection(l,h,m,n);return l.x+=p.x,l.y+=p.y,l},f.prototype.computeCollinearIntersection=function(l,h,m,p){var n=Ia.intersects(l,h,m),r=Ia.intersects(l,h,p),v=Ia.intersects(m,p,l),z=Ia.intersects(m,p,h);return n&&r?(this._intPt[0]=m,this._intPt[1]=p,d.COLLINEAR_INTERSECTION):v&&z?(this._intPt[0]=l,this._intPt[1]=h,d.COLLINEAR_INTERSECTION):n&&v?(this._intPt[0]=
m,this._intPt[1]=l,!m.equals(l)||r||z?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):n&&z?(this._intPt[0]=m,this._intPt[1]=h,!m.equals(h)||r||v?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):r&&v?(this._intPt[0]=p,this._intPt[1]=l,!p.equals(l)||n||z?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):r&&z?(this._intPt[0]=p,this._intPt[1]=h,!p.equals(h)||n||v?d.COLLINEAR_INTERSECTION:d.POINT_INTERSECTION):d.NO_INTERSECTION},f.prototype.normalizeToEnvCentre=function(l,h,m,p,n){var r=l.x<h.x?l.x:h.x,v=l.y<
h.y?l.y:h.y,z=l.x>h.x?l.x:h.x,t=l.y>h.y?l.y:h.y,y=m.x<p.x?m.x:p.x,C=m.y<p.y?m.y:p.y,w=m.x>p.x?m.x:p.x,x=m.y>p.y?m.y:p.y;n.x=((r>y?r:y)+(z<w?z:w))/2;n.y=((v>C?v:C)+(t<x?t:x))/2;l.x-=n.x;l.y-=n.y;h.x-=n.x;h.y-=n.y;m.x-=n.x;m.y-=n.y;p.x-=n.x;p.y-=n.y},f.prototype.computeIntersect=function(l,h,m,p){if(this._isProper=!1,!Ia.intersects(l,h,m,p))return d.NO_INTERSECTION;var n=Da.orientationIndex(l,h,m),r=Da.orientationIndex(l,h,p);if(0<n&&0<r||0>n&&0>r)return d.NO_INTERSECTION;var v=Da.orientationIndex(m,
p,l),z=Da.orientationIndex(m,p,h);return 0<v&&0<z||0>v&&0>z?d.NO_INTERSECTION:0===n&&0===r&&0===v&&0===z?this.computeCollinearIntersection(l,h,m,p):(0===n||0===r||0===v||0===z?(this._isProper=!1,l.equals2D(m)||l.equals2D(p)?this._intPt[0]=l:h.equals2D(m)||h.equals2D(p)?this._intPt[0]=h:0===n?this._intPt[0]=new sa(m):0===r?this._intPt[0]=new sa(p):0===v?this._intPt[0]=new sa(l):0===z&&(this._intPt[0]=new sa(h))):(this._isProper=!0,this._intPt[0]=this.intersection(l,h,m,p)),d.POINT_INTERSECTION)},f.prototype.interfaces_=
function(){return[]},f.prototype.getClass=function(){return f},f.nearestEndpoint=function(l,h,m,p){var n=l,r=Da.distancePointLine(l,m,p),v=Da.distancePointLine(h,m,p);return v<r&&(r=v,n=h),(v=Da.distancePointLine(m,l,h))<r&&(r=v,n=m),Da.distancePointLine(p,l,h)<r&&(n=p),n},f}(Xb),qf=function(){};qf.prototype.interfaces_=function(){return[]};qf.prototype.getClass=function(){return qf};qf.orientationIndex=function(d,f,l){return qf.signOfDet2x2(f.x-d.x,f.y-d.y,l.x-f.x,l.y-f.y)};qf.signOfDet2x2=function(d,
f,l,h){var m,p=null;if(m=1,0===d||0===h)return 0===f||0===l?0:0<f?0<l?-m:m:0<l?m:-m;if(0===f||0===l)return 0<h?0<d?m:-m:0<d?-m:m;if(0<f?0<h?f<=h||(m=-m,p=d,d=l,l=p,p=f,f=h,h=p):f<=-h?(m=-m,l=-l,h=-h):(p=d,d=-l,l=p,p=f,f=-h,h=p):0<h?-f<=h?(m=-m,d=-d,f=-f):(p=-d,d=l,l=p,p=-f,f=h,h=p):f>=h?(d=-d,f=-f,l=-l,h=-h):(m=-m,p=-d,d=-l,l=p,p=-f,f=-h,h=p),0<d){if(!(0<l&&d<=l))return m}else{if(0<l||!(d>=l))return-m;m=-m;d=-d;l=-l}for(;;){if(0>(h-=(p=Math.floor(l/d))*f))return-m;if(h>f)return m;if(d>(l-=p*d)+l){if(f<
h+h)return m}else{if(f>h+h)return-m;l=d-l;h=f-h;m=-m}if(0===h)return 0===l?0:-m;if(0===l||0>(f-=(p=Math.floor(d/l))*h))return m;if(f>h)return-m;if(l>(d-=p*l)+d){if(h<f+f)return-m}else{if(h>f+f)return m;d=l-d;f=h-f;m=-m}if(0===f)return 0===d?0:m;if(0===d)return-m}};var Ed=function(d){this._crossingCount=0;this._isPointOnSegment=!1;this._p=d};Ed.prototype.countSegment=function(d,f){if(d.x<this._p.x&&f.x<this._p.x)return null;if(this._p.x===f.x&&this._p.y===f.y)return this._isPointOnSegment=!0,null;
if(d.y===this._p.y&&f.y===this._p.y){var l=d.x,h=f.x;return l>h&&(l=f.x,h=d.x),this._p.x>=l&&this._p.x<=h&&(this._isPointOnSegment=!0),null}if(d.y>this._p.y&&f.y<=this._p.y||f.y>this._p.y&&d.y<=this._p.y){l=d.y-this._p.y;h=f.y-this._p.y;d=qf.signOfDet2x2(d.x-this._p.x,l,f.x-this._p.x,h);if(0===d)return this._isPointOnSegment=!0,null;h<l&&(d=-d);0<d&&this._crossingCount++}};Ed.prototype.isPointInPolygon=function(){return this.getLocation()!==ua.EXTERIOR};Ed.prototype.getLocation=function(){return this._isPointOnSegment?
ua.BOUNDARY:1==this._crossingCount%2?ua.INTERIOR:ua.EXTERIOR};Ed.prototype.isOnSegment=function(){return this._isPointOnSegment};Ed.prototype.interfaces_=function(){return[]};Ed.prototype.getClass=function(){return Ed};Ed.locatePointInRing=function(d,f){if(d instanceof sa&&Va(f,db)){d=new Ed(d);for(var l=new sa,h=new sa,m=1;m<f.size()&&(f.getCoordinate(m,l),f.getCoordinate(m-1,h),d.countSegment(l,h),!d.isOnSegment());m++);return d.getLocation()}if(d instanceof sa&&f instanceof Array){d=new Ed(d);
for(l=1;l<f.length&&(d.countSegment(f[l],f[l-1]),!d.isOnSegment());l++);return d.getLocation()}};var Da=function(){},rf={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Da.prototype.interfaces_=function(){return[]};Da.prototype.getClass=function(){return Da};Da.orientationIndex=function(d,f,l){return Xc.orientationIndex(d,f,l)};Da.signedArea=function(d){if(d instanceof Array){if(3>
d.length)return 0;for(var f=0,l=d[0].x,h=1;h<d.length-1;h++)f+=(d[h].x-l)*(d[h-1].y-d[h+1].y);return f/2}if(Va(d,db)){f=d.size();if(3>f)return 0;l=new sa;h=new sa;var m=new sa;d.getCoordinate(0,h);d.getCoordinate(1,m);var p=h.x;m.x-=p;for(var n=0,r=1;r<f-1;r++)l.y=h.y,h.x=m.x,h.y=m.y,d.getCoordinate(r+1,m),m.x-=p,n+=h.x*(l.y-m.y);return n/2}};Da.distanceLineLine=function(d,f,l,h){if(d.equals(f))return Da.distancePointLine(d,l,h);if(l.equals(h))return Da.distancePointLine(h,d,f);var m=!1;if(Ia.intersects(d,
f,l,h)){var p=(f.x-d.x)*(h.y-l.y)-(f.y-d.y)*(h.x-l.x);if(0===p)m=!0;else{var n=((d.y-l.y)*(f.x-d.x)-(d.x-l.x)*(f.y-d.y))/p;p=((d.y-l.y)*(h.x-l.x)-(d.x-l.x)*(h.y-l.y))/p;(0>p||1<p||0>n||1<n)&&(m=!0)}}else m=!0;return m?cd.min(Da.distancePointLine(d,l,h),Da.distancePointLine(f,l,h),Da.distancePointLine(l,d,f),Da.distancePointLine(h,d,f)):0};Da.isPointInRing=function(d,f){return Da.locatePointInRing(d,f)!==ua.EXTERIOR};Da.computeLength=function(d){var f=d.size();if(1>=f)return 0;var l=0,h=new sa;d.getCoordinate(0,
h);for(var m=h.x,p=h.y,n=1;n<f;n++){d.getCoordinate(n,h);var r=h.x,v=h.y;m=r-m;p=v-p;l+=Math.sqrt(m*m+p*p);m=r;p=v}return l};Da.isCCW=function(d){var f=d.length-1;if(3>f)throw new ac("Ring has fewer than 4 points, so orientation cannot be determined");for(var l=d[0],h=0,m=1;m<=f;m++){var p=d[m];p.y>l.y&&(l=p,h=m)}p=h;do 0>--p&&(p=f);while(d[p].equals2D(l)&&p!==h);m=h;do m=(m+1)%f;while(d[m].equals2D(l)&&m!==h);f=d[p];d=d[m];if(f.equals2D(l)||d.equals2D(l)||f.equals2D(d))return!1;l=Da.computeOrientation(f,
l,d);h=!1;return h=0===l?f.x>d.x:0<l,h};Da.locatePointInRing=function(d,f){return Ed.locatePointInRing(d,f)};Da.distancePointLinePerpendicular=function(d,f,l){var h=(l.x-f.x)*(l.x-f.x)+(l.y-f.y)*(l.y-f.y);return Math.abs(((f.y-d.y)*(l.x-f.x)-(f.x-d.x)*(l.y-f.y))/h)*Math.sqrt(h)};Da.computeOrientation=function(d,f,l){return Da.orientationIndex(d,f,l)};Da.distancePointLine=function(){if(2===arguments.length){var d=arguments[0],f=arguments[1];if(0===f.length)throw new ac("Line array must contain at least one vertex");
for(var l=d.distance(f[0]),h=0;h<f.length-1;h++){var m=Da.distancePointLine(d,f[h],f[h+1]);m<l&&(l=m)}return l}if(3===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];if(f.x===l.x&&f.y===l.y)return d.distance(f);h=(l.x-f.x)*(l.x-f.x)+(l.y-f.y)*(l.y-f.y);m=((d.x-f.x)*(l.x-f.x)+(d.y-f.y)*(l.y-f.y))/h;return 0>=m?d.distance(f):1<=m?d.distance(l):Math.abs(((f.y-d.y)*(l.x-f.x)-(f.x-d.x)*(l.y-f.y))/h)*Math.sqrt(h)}};Da.isOnLine=function(d,f){for(var l=new Te,h=1;h<f.length;h++)if(l.computeIntersection(d,
f[h-1],f[h]),l.hasIntersection())return!0;return!1};rf.CLOCKWISE.get=function(){return-1};rf.RIGHT.get=function(){return Da.CLOCKWISE};rf.COUNTERCLOCKWISE.get=function(){return 1};rf.LEFT.get=function(){return Da.COUNTERCLOCKWISE};rf.COLLINEAR.get=function(){return 0};rf.STRAIGHT.get=function(){return Da.COLLINEAR};Object.defineProperties(Da,rf);var se=function(){};se.prototype.filter=function(d){};se.prototype.interfaces_=function(){return[]};se.prototype.getClass=function(){return se};var Ra=function(d){this._userData=
this._SRID=this._envelope=null;this._factory=d;this._SRID=d.getSRID()},Vd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Ra.prototype.isGeometryCollection=
function(){return this.getSortIndex()===Ra.SORTINDEX_GEOMETRYCOLLECTION};Ra.prototype.getFactory=function(){return this._factory};Ra.prototype.getGeometryN=function(d){return this};Ra.prototype.getArea=function(){return 0};Ra.prototype.isRectangle=function(){return!1};Ra.prototype.equals=function(d){if(d instanceof Ra)return null!==d&&this.equalsTopo(d);if(d instanceof Object)return d instanceof Ra?this.equalsExact(d):!1};Ra.prototype.equalsExact=function(d){return this===d||this.equalsExact(d,0)};
Ra.prototype.geometryChanged=function(){this.apply(Ra.geometryChangedFilter)};Ra.prototype.geometryChangedAction=function(){this._envelope=null};Ra.prototype.equalsNorm=function(d){return null!==d&&this.norm().equalsExact(d.norm())};Ra.prototype.getLength=function(){return 0};Ra.prototype.getNumGeometries=function(){return 1};Ra.prototype.compareTo=function(){if(1===arguments.length){var d=arguments[0];return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&
d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(d)}if(2===arguments.length){d=arguments[0];var f=arguments[1];return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(d,f)}};Ra.prototype.getUserData=function(){return this._userData};Ra.prototype.getSRID=function(){return this._SRID};Ra.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};
Ra.prototype.checkNotGeometryCollection=function(d){if(d.getSortIndex()===Ra.SORTINDEX_GEOMETRYCOLLECTION)throw new ac("This method does not support GeometryCollection arguments");};Ra.prototype.equal=function(d,f,l){return 0===l?d.equals(f):d.distance(f)<=l};Ra.prototype.norm=function(){var d=this.copy();return d.normalize(),d};Ra.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Ra.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=
this.computeEnvelopeInternal()),new Ia(this._envelope)};Ra.prototype.setSRID=function(d){this._SRID=d};Ra.prototype.setUserData=function(d){this._userData=d};Ra.prototype.compare=function(d,f){d=d.iterator();for(f=f.iterator();d.hasNext()&&f.hasNext();){var l=d.next(),h=f.next();l=l.compareTo(h);if(0!==l)return l}return d.hasNext()?1:f.hasNext()?-1:0};Ra.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Ra.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===
Ra.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Ra.SORTINDEX_MULTIPOINT||this.getSortIndex()===Ra.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Ra.SORTINDEX_MULTIPOLYGON};Ra.prototype.interfaces_=function(){return[Xh,jd,id]};Ra.prototype.getClass=function(){return Ra};Ra.hasNonEmptyElements=function(d){for(var f=0;f<d.length;f++)if(!d[f].isEmpty())return!0;return!1};Ra.hasNullElements=function(d){for(var f=0;f<d.length;f++)if(null===d[f])return!0;return!1};Vd.serialVersionUID.get=function(){return 0x799ea46522854c00};
Vd.SORTINDEX_POINT.get=function(){return 0};Vd.SORTINDEX_MULTIPOINT.get=function(){return 1};Vd.SORTINDEX_LINESTRING.get=function(){return 2};Vd.SORTINDEX_LINEARRING.get=function(){return 3};Vd.SORTINDEX_MULTILINESTRING.get=function(){return 4};Vd.SORTINDEX_POLYGON.get=function(){return 5};Vd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Vd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Vd.geometryChangedFilter.get=function(){return Gj};Object.defineProperties(Ra,Vd);var Gj=function(){};
Gj.interfaces_=function(){return[se]};Gj.filter=function(d){d.geometryChangedAction()};var Ee=function(){};Ee.prototype.filter=function(d){};Ee.prototype.interfaces_=function(){return[]};Ee.prototype.getClass=function(){return Ee};var kd=function(){},te={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},
MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};kd.prototype.isInBoundary=function(d){};kd.prototype.interfaces_=function(){return[]};kd.prototype.getClass=function(){return kd};te.Mod2BoundaryNodeRule.get=function(){return Vf};te.EndPointBoundaryNodeRule.get=function(){return Wf};te.MultiValentEndPointBoundaryNodeRule.get=function(){return Xf};te.MonoValentEndPointBoundaryNodeRule.get=function(){return Yf};
te.MOD2_BOUNDARY_RULE.get=function(){return new Vf};te.ENDPOINT_BOUNDARY_RULE.get=function(){return new Wf};te.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Xf};te.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Yf};te.OGC_SFS_BOUNDARY_RULE.get=function(){return kd.MOD2_BOUNDARY_RULE};Object.defineProperties(kd,te);var Vf=function(){};Vf.prototype.isInBoundary=function(d){return 1==d%2};Vf.prototype.interfaces_=function(){return[kd]};Vf.prototype.getClass=function(){return Vf};
var Wf=function(){};Wf.prototype.isInBoundary=function(d){return 0<d};Wf.prototype.interfaces_=function(){return[kd]};Wf.prototype.getClass=function(){return Wf};var Xf=function(){};Xf.prototype.isInBoundary=function(d){return 1<d};Xf.prototype.interfaces_=function(){return[kd]};Xf.prototype.getClass=function(){return Xf};var Yf=function(){};Yf.prototype.isInBoundary=function(d){return 1===d};Yf.prototype.interfaces_=function(){return[kd]};Yf.prototype.getClass=function(){return Yf};var kc=function(){};
kc.prototype.add=function(){};kc.prototype.addAll=function(){};kc.prototype.isEmpty=function(){};kc.prototype.iterator=function(){};kc.prototype.size=function(){};kc.prototype.toArray=function(){};kc.prototype.remove=function(){};hj.prototype=Error();hj.prototype.name="IndexOutOfBoundsException";var Zf=function(){};Zf.prototype.hasNext=function(){};Zf.prototype.next=function(){};Zf.prototype.remove=function(){};var ue=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),f.prototype=
Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.get=function(){},f.prototype.set=function(){},f.prototype.isEmpty=function(){},f}(kc);Mf.prototype=Error();Mf.prototype.name="NoSuchElementException";var Fa=function(d){function f(l){d.call(this);this.array_=[];l instanceof kc&&this.addAll(l)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.ensureCapacity=function(){},f.prototype.interfaces_=function(){return[d,kc]},f.prototype.add=
function(l){return 1===arguments.length?this.array_.push(l):this.array_.splice(arguments[0],arguments[1]),!0},f.prototype.clear=function(){this.array_=[]},f.prototype.addAll=function(l){for(l=l.iterator();l.hasNext();)this.add(l.next());return!0},f.prototype.set=function(l,h){var m=this.array_[l];return this.array_[l]=h,m},f.prototype.iterator=function(){return new wp(this)},f.prototype.get=function(l){if(0>l||l>=this.size())throw new hj;return this.array_[l]},f.prototype.isEmpty=function(){return 0===
this.array_.length},f.prototype.size=function(){return this.array_.length},f.prototype.toArray=function(){for(var l=[],h=0,m=this.array_.length;h<m;h++)l.push(this.array_[h]);return l},f.prototype.remove=function(l){for(var h=!1,m=0,p=this.array_.length;m<p;m++)if(this.array_[m]===l){this.array_.splice(m,1);h=!0;break}return h},f}(ue),wp=function(d){function f(l){d.call(this);this.arrayList_=l;this.position_=0}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=
f,f.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Mf;return this.arrayList_.get(this.position_++)},f.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},f.prototype.set=function(l){return this.arrayList_.set(this.position_-1,l)},f.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},f}(Zf),Tg=function(d){function f(){if(d.call(this),0!==arguments.length)if(1===arguments.length){var h=arguments[0];this.ensureCapacity(h.length);
this.add(h,!0)}else if(2===arguments.length){h=arguments[0];var m=arguments[1];this.ensureCapacity(h.length);this.add(h,m)}}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={coordArrayType:{configurable:!0}};return l.coordArrayType.get=function(){return[].fill(null)},f.prototype.getCoordinate=function(h){return this.get(h)},f.prototype.addAll=function(){if(2===arguments.length){for(var h=arguments[1],m=!1,p=arguments[0].iterator();p.hasNext();)this.add(p.next(),
h),m=!0;return m}return d.prototype.addAll.apply(this,arguments)},f.prototype.clone=function(){for(var h=d.prototype.clone.call(this),m=0;m<this.size();m++)h.add(m,this.get(m).copy());return h},f.prototype.toCoordinateArray=function(){return this.toArray(f.coordArrayType)},f.prototype.add=function(){if(1===arguments.length)d.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],
!0),!0;if(arguments[0]instanceof sa&&"boolean"==typeof arguments[1]){var h=arguments[0];if(!arguments[1]&&1<=this.size()&&this.get(this.size()-1).equals2D(h))return null;d.prototype.add.call(this,h)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){h=arguments[0];var m=arguments[1];if(arguments[2])for(var p=
0;p<h.length;p++)this.add(h[p],m);else for(p=h.length-1;0<=p;p--)this.add(h[p],m);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof sa){h=arguments[0];m=arguments[1];if(!arguments[2]&&(p=this.size(),0<p&&(0<h&&this.get(h-1).equals2D(m)||h<p&&this.get(h).equals2D(m))))return null;d.prototype.add.call(this,h,m)}}else if(4===arguments.length){h=arguments[0];m=arguments[1];var n=arguments[2];p=arguments[3];var r=1;for(n>p&&(r=-1);n!==p;n+=r)this.add(h[n],
m);return!0}},f.prototype.closeRing=function(){0<this.size()&&this.add(new sa(this.get(0)),!1)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},Object.defineProperties(f,l),f}(Fa),ab=function(){},ai={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};ai.ForwardComparator.get=function(){return Ug};ai.BidirectionalComparator.get=function(){return $f};ai.coordArrayType.get=function(){return[].fill(null)};
ab.prototype.interfaces_=function(){return[]};ab.prototype.getClass=function(){return ab};ab.isRing=function(d){return!(4>d.length)&&!!d[0].equals2D(d[d.length-1])};ab.ptNotInList=function(d,f){for(var l=0;l<d.length;l++){var h=d[l];if(0>ab.indexOf(h,f))return h}return null};ab.scroll=function(d,f){f=ab.indexOf(f,d);if(0>f)return null;var l=Array(d.length).fill(null);Oc.arraycopy(d,f,l,0,d.length-f);Oc.arraycopy(d,0,l,d.length-f,f);Oc.arraycopy(l,0,d,0,d.length)};ab.equals=function(){if(2===arguments.length){var d=
arguments[0],f=arguments[1];if(d===f)return!0;if(null===d||null===f||d.length!==f.length)return!1;for(var l=0;l<d.length;l++)if(!d[l].equals(f[l]))return!1;return!0}if(3===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];if(d===f)return!0;if(null===d||null===f||d.length!==f.length)return!1;for(var h=0;h<d.length;h++)if(0!==l.compare(d[h],f[h]))return!1;return!0}};ab.intersection=function(d,f){for(var l=new Tg,h=0;h<d.length;h++)f.intersects(d[h])&&l.add(d[h],!0);return l.toCoordinateArray()};
ab.hasRepeatedPoints=function(d){for(var f=1;f<d.length;f++)if(d[f-1].equals(d[f]))return!0;return!1};ab.removeRepeatedPoints=function(d){return ab.hasRepeatedPoints(d)?(new Tg(d,!1)).toCoordinateArray():d};ab.reverse=function(d){for(var f=d.length-1,l=Math.trunc(f/2),h=0;h<=l;h++){var m=d[h];d[h]=d[f-h];d[f-h]=m}};ab.removeNull=function(d){for(var f=0,l=0;l<d.length;l++)null!==d[l]&&f++;l=Array(f).fill(null);if(0===f)return l;for(var h=f=0;h<d.length;h++)null!==d[h]&&(l[f++]=d[h]);return l};ab.copyDeep=
function(){if(1===arguments.length){for(var d=arguments[0],f=Array(d.length).fill(null),l=0;l<d.length;l++)f[l]=new sa(d[l]);return f}if(5===arguments.length){d=arguments[0];f=arguments[1];l=arguments[2];for(var h=arguments[3],m=arguments[4],p=0;p<m;p++)l[h+p]=new sa(d[f+p])}};ab.isEqualReversed=function(d,f){for(var l=0;l<d.length;l++)if(0!==d[l].compareTo(f[d.length-l-1]))return!1;return!0};ab.envelope=function(d){for(var f=new Ia,l=0;l<d.length;l++)f.expandToInclude(d[l]);return f};ab.toCoordinateArray=
function(d){return d.toArray(ab.coordArrayType)};ab.atLeastNCoordinatesOrNothing=function(d,f){return f.length>=d?f:[]};ab.indexOf=function(d,f){for(var l=0;l<f.length;l++)if(d.equals(f[l]))return l;return-1};ab.increasingDirection=function(d){for(var f=0;f<Math.trunc(d.length/2);f++){var l=d[f].compareTo(d[d.length-1-f]);if(0!==l)return l}return 1};ab.compare=function(d,f){for(var l=0;l<d.length&&l<f.length;){var h=d[l].compareTo(f[l]);if(0!==h)return h;l++}return l<f.length?-1:l<d.length?1:0};ab.minCoordinate=
function(d){for(var f=null,l=0;l<d.length;l++)(null===f||0<f.compareTo(d[l]))&&(f=d[l]);return f};ab.extract=function(d,f,l){f=cd.clamp(f,0,d.length);var h=(l=cd.clamp(l,-1,d.length))-f+1;0>l&&(h=0);f>=d.length&&(h=0);l<f&&(h=0);var m=Array(h).fill(null);if(0===h)return m;for(h=0;f<=l;f++)m[h++]=d[f];return m};Object.defineProperties(ab,ai);var Ug=function(){};Ug.prototype.compare=function(d,f){return ab.compare(d,f)};Ug.prototype.interfaces_=function(){return[Rf]};Ug.prototype.getClass=function(){return Ug};
var $f=function(){};$f.prototype.compare=function(d,f){if(d.length<f.length)return-1;if(d.length>f.length)return 1;if(0===d.length)return 0;var l=ab.compare(d,f);return ab.isEqualReversed(d,f)?0:l};$f.prototype.OLDcompare=function(d,f){if(d.length<f.length)return-1;if(d.length>f.length)return 1;if(0===d.length)return 0;for(var l=ab.increasingDirection(d),h=ab.increasingDirection(f),m=0<l?0:d.length-1,p=0<h?0:d.length-1,n=0;n<d.length;n++){var r=d[m].compareTo(f[p]);if(0!==r)return r;m+=l;p+=h}return 0};
$f.prototype.interfaces_=function(){return[Rf]};$f.prototype.getClass=function(){return $f};var sf=function(){};sf.prototype.get=function(){};sf.prototype.put=function(){};sf.prototype.size=function(){};sf.prototype.values=function(){};sf.prototype.entrySet=function(){};var xp=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f}(sf);Hg.prototype=Error();Hg.prototype.name="OperationNotSupported";Lh.prototype=
new kc;Lh.prototype.contains=function(){};var Hj=function(d){function f(l){d.call(this);this.array_=[];l instanceof kc&&this.addAll(l)}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.contains=function(l){for(var h=0,m=this.array_.length;h<m;h++)if(this.array_[h]===l)return!0;return!1},f.prototype.add=function(l){return!this.contains(l)&&(this.array_.push(l),!0)},f.prototype.addAll=function(l){for(l=l.iterator();l.hasNext();)this.add(l.next());
return!0},f.prototype.remove=function(l){throw Error();},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var l=[],h=0,m=this.array_.length;h<m;h++)l.push(this.array_[h]);return l},f.prototype.iterator=function(){return new yp(this)},f}(Lh),yp=function(d){function f(l){d.call(this);this.hashSet_=l;this.position_=0}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=
f,f.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Mf;return this.hashSet_.array_[this.position_++]},f.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},f.prototype.remove=function(){throw new Hg;},f}(Zf);Ac.prototype=new xp;Ac.prototype.get=function(d){for(var f=this.root_;null!==f;){var l=d.compareTo(f.key);if(0>l)f=f.left;else{if(!(0<l))return f.value;f=f.right}}return null};Ac.prototype.put=function(d,f){if(null===this.root_)return this.root_=
{key:d,value:f,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var l,h,m=this.root_;do if(l=m,0>(h=d.compareTo(m.key)))m=m.left;else{if(!(0<h))return l=m.value,m.value=f,l;m=m.right}while(null!==m);f={key:d,left:null,right:null,value:f,parent:l,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>h?l.left=f:l.right=f,this.fixAfterInsertion(f),this.size_++,null};Ac.prototype.fixAfterInsertion=
function(d){for(d.color=1;null!=d&&d!==this.root_&&1===d.parent.color;)if(Pb(d)===ij(Pb(Pb(d)))){var f=bm(Pb(Pb(d)));1===(null===f?0:f.color)?(le(Pb(d),0),le(f,0),le(Pb(Pb(d)),1),d=Pb(Pb(d))):(d===bm(Pb(d))&&(d=Pb(d),this.rotateLeft(d)),le(Pb(d),0),le(Pb(Pb(d)),1),this.rotateRight(Pb(Pb(d))))}else f=ij(Pb(Pb(d))),1===(null===f?0:f.color)?(le(Pb(d),0),le(f,0),le(Pb(Pb(d)),1),d=Pb(Pb(d))):(d===ij(Pb(d))&&(d=Pb(d),this.rotateRight(d)),le(Pb(d),0),le(Pb(Pb(d)),1),this.rotateLeft(Pb(Pb(d))));this.root_.color=
0};Ac.prototype.values=function(){var d=new Fa,f=this.getFirstEntry();if(null!==f)for(d.add(f.value);null!==(f=Ac.successor(f));)d.add(f.value);return d};Ac.prototype.entrySet=function(){var d=new Hj,f=this.getFirstEntry();if(null!==f)for(d.add(f);null!==(f=Ac.successor(f));)d.add(f);return d};Ac.prototype.rotateLeft=function(d){if(null!=d){var f=d.right;d.right=f.left;null!=f.left&&(f.left.parent=d);f.parent=d.parent;null===d.parent?this.root_=f:d.parent.left===d?d.parent.left=f:d.parent.right=f;
f.left=d;d.parent=f}};Ac.prototype.rotateRight=function(d){if(null!=d){var f=d.left;d.left=f.right;null!=f.right&&(f.right.parent=d);f.parent=d.parent;null===d.parent?this.root_=f:d.parent.right===d?d.parent.right=f:d.parent.left=f;f.right=d;d.parent=f}};Ac.prototype.getFirstEntry=function(){var d=this.root_;if(null!=d)for(;null!=d.left;)d=d.left;return d};Ac.successor=function(d){if(null===d)return null;if(null!==d.right){for(var f=d.right;null!==f.left;)f=f.left;return f}for(f=d.parent;null!==f&&
d===f.right;)d=f,f=f.parent;return f};Ac.prototype.size=function(){return this.size_};var Vg=function(){};Vg.prototype.interfaces_=function(){return[]};Vg.prototype.getClass=function(){return Vg};cm.prototype=new Lh;zd.prototype=new cm;zd.prototype.contains=function(d){for(var f=0,l=this.array_.length;f<l;f++)if(0===this.array_[f].compareTo(d))return!0;return!1};zd.prototype.add=function(d){if(this.contains(d))return!1;for(var f=0,l=this.array_.length;f<l;f++)if(1===this.array_[f].compareTo(d))return this.array_.splice(f,
0,d),!0;return this.array_.push(d),!0};zd.prototype.addAll=function(d){for(d=d.iterator();d.hasNext();)this.add(d.next());return!0};zd.prototype.remove=function(d){throw new Hg;};zd.prototype.size=function(){return this.array_.length};zd.prototype.isEmpty=function(){return 0===this.array_.length};zd.prototype.toArray=function(){for(var d=[],f=0,l=this.array_.length;f<l;f++)d.push(this.array_[f]);return d};zd.prototype.iterator=function(){return new bi(this)};var bi=function(d){this.treeSet_=d;this.position_=
0};bi.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Mf;return this.treeSet_.array_[this.position_++]};bi.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};bi.prototype.remove=function(){throw new Hg;};var Ue=function(){};Ue.sort=function(){var d,f=arguments[0];if(1===arguments.length){var l=function(m,p){return m.compareTo(p)};f.sort(l)}else if(2===arguments.length){var h=arguments[1];l=function(m,p){return h.compare(m,p)};f.sort(l)}else if(3===
arguments.length)for((d=f.slice(arguments[1],arguments[2])).sort(),l=f.slice(0,arguments[1]).concat(d,f.slice(arguments[2],f.length)),f.splice(0,f.length),d=0;d<l.length;d++)f.push(l[d]);else if(4===arguments.length)for(d=f.slice(arguments[1],arguments[2]),h=arguments[3],l=function(m,p){return h.compare(m,p)},d.sort(l),l=f.slice(0,arguments[1]).concat(d,f.slice(arguments[2],f.length)),f.splice(0,f.length),d=0;d<l.length;d++)f.push(l[d])};Ue.asList=function(d){for(var f=new Fa,l=0,h=d.length;l<h;l++)f.add(d[l]);
return f};var Eb=function(){},td={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};td.P.get=function(){return 0};td.L.get=function(){return 1};td.A.get=function(){return 2};td.FALSE.get=function(){return-1};td.TRUE.get=function(){return-2};td.DONTCARE.get=function(){return-3};
td.SYM_FALSE.get=function(){return"F"};td.SYM_TRUE.get=function(){return"T"};td.SYM_DONTCARE.get=function(){return"*"};td.SYM_P.get=function(){return"0"};td.SYM_L.get=function(){return"1"};td.SYM_A.get=function(){return"2"};Eb.prototype.interfaces_=function(){return[]};Eb.prototype.getClass=function(){return Eb};Eb.toDimensionSymbol=function(d){switch(d){case Eb.FALSE:return Eb.SYM_FALSE;case Eb.TRUE:return Eb.SYM_TRUE;case Eb.DONTCARE:return Eb.SYM_DONTCARE;case Eb.P:return Eb.SYM_P;case Eb.L:return Eb.SYM_L;
case Eb.A:return Eb.SYM_A}throw new ac("Unknown dimension value: "+d);};Eb.toDimensionValue=function(d){switch(Rg.toUpperCase(d)){case Eb.SYM_FALSE:return Eb.FALSE;case Eb.SYM_TRUE:return Eb.TRUE;case Eb.SYM_DONTCARE:return Eb.DONTCARE;case Eb.SYM_P:return Eb.P;case Eb.SYM_L:return Eb.L;case Eb.SYM_A:return Eb.A}throw new ac("Unknown dimension symbol: "+d);};Object.defineProperties(Eb,td);var Ve=function(){};Ve.prototype.filter=function(d){};Ve.prototype.interfaces_=function(){return[]};Ve.prototype.getClass=
function(){return Ve};var Wd=function(){};Wd.prototype.filter=function(d,f){};Wd.prototype.isDone=function(){};Wd.prototype.isGeometryChanged=function(){};Wd.prototype.interfaces_=function(){return[]};Wd.prototype.getClass=function(){return Wd};var ud=function(d){function f(h,m){if(d.call(this,m),this._geometries=h||[],d.hasNullElements(this._geometries))throw new ac("geometries must not contain null elements");}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=
f;var l={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){for(var h=new Ia,m=0;m<this._geometries.length;m++)h.expandToInclude(this._geometries[m].getEnvelopeInternal());return h},f.prototype.getGeometryN=function(h){return this._geometries[h]},f.prototype.getSortIndex=function(){return d.SORTINDEX_GEOMETRYCOLLECTION},f.prototype.getCoordinates=function(){for(var h=Array(this.getNumPoints()).fill(null),m=-1,p=0;p<this._geometries.length;p++)for(var n=this._geometries[p].getCoordinates(),
r=0;r<n.length;r++)h[++m]=n[r];return h},f.prototype.getArea=function(){for(var h=0,m=0;m<this._geometries.length;m++)h+=this._geometries[m].getArea();return h},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];if(!this.isEquivalentClass(h)||this._geometries.length!==h._geometries.length)return!1;for(var p=0;p<this._geometries.length;p++)if(!this._geometries[p].equalsExact(h._geometries[p],m))return!1;return!0}return d.prototype.equalsExact.apply(this,arguments)},
f.prototype.normalize=function(){for(var h=0;h<this._geometries.length;h++)this._geometries[h].normalize();Ue.sort(this._geometries)},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},f.prototype.getBoundaryDimension=function(){for(var h=Eb.FALSE,m=0;m<this._geometries.length;m++)h=Math.max(h,this._geometries[m].getBoundaryDimension());return h},f.prototype.getDimension=function(){for(var h=Eb.FALSE,m=0;m<this._geometries.length;m++)h=Math.max(h,
this._geometries[m].getDimension());return h},f.prototype.getLength=function(){for(var h=0,m=0;m<this._geometries.length;m++)h+=this._geometries[m].getLength();return h},f.prototype.getNumPoints=function(){for(var h=0,m=0;m<this._geometries.length;m++)h+=this._geometries[m].getNumPoints();return h},f.prototype.getNumGeometries=function(){return this._geometries.length},f.prototype.reverse=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<this._geometries.length;m++)h[m]=this._geometries[m].reverse();
return this.getFactory().createGeometryCollection(h)},f.prototype.compareToSameClass=function(){if(1===arguments.length){var h=arguments[0],m=new zd(Ue.asList(this._geometries));h=new zd(Ue.asList(h._geometries));return this.compare(m,h)}if(2===arguments.length){m=arguments[1];h=arguments[0];for(var p=this.getNumGeometries(),n=h.getNumGeometries(),r=0;r<p&&r<n;){var v=this.getGeometryN(r),z=h.getGeometryN(r);v=v.compareToSameClass(z,m);if(0!==v)return v;r++}return r<p?1:r<n?-1:0}},f.prototype.apply=
function(h){if(Va(h,Ee))for(var m=0;m<this._geometries.length;m++)this._geometries[m].apply(h);else if(Va(h,Wd)){if(0===this._geometries.length)return null;for(m=0;m<this._geometries.length&&(this._geometries[m].apply(h),!h.isDone());m++);h.isGeometryChanged()&&this.geometryChanged()}else if(Va(h,Ve))for(h.filter(this),m=0;m<this._geometries.length;m++)this._geometries[m].apply(h);else if(Va(h,se))for(h.filter(this),m=0;m<this._geometries.length;m++)this._geometries[m].apply(h)},f.prototype.getBoundary=
function(){return this.checkNotGeometryCollection(this),Xa.shouldNeverReachHere(),null},f.prototype.clone=function(){var h=d.prototype.clone.call(this);h._geometries=Array(this._geometries.length).fill(null);for(var m=0;m<this._geometries.length;m++)h._geometries[m]=this._geometries[m].clone();return h},f.prototype.getGeometryType=function(){return"GeometryCollection"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=this._geometries[m].copy();
return new f(h,this._factory)},f.prototype.isEmpty=function(){for(var h=0;h<this._geometries.length;h++)if(!this._geometries[h].isEmpty())return!1;return!0},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(f,l),f}(Ra),We=function(d){function f(){d.apply(this,arguments)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};
return f.prototype.getSortIndex=function(){return Ra.SORTINDEX_MULTILINESTRING},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&d.prototype.equalsExact.call(this,h,m)}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return this.isClosed()?Eb.FALSE:0},f.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var h=0;h<this._geometries.length;h++)if(!this._geometries[h].isClosed())return!1;
return!0},f.prototype.getDimension=function(){return 1},f.prototype.reverse=function(){for(var h=this._geometries.length,m=Array(h).fill(null),p=0;p<this._geometries.length;p++)m[h-1-p]=this._geometries[p].reverse();return this.getFactory().createMultiLineString(m)},f.prototype.getBoundary=function(){return(new ld(this)).getBoundary()},f.prototype.getGeometryType=function(){return"MultiLineString"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=
this._geometries[m].copy();return new f(h,this._factory)},f.prototype.interfaces_=function(){return[Vg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(f,l),f}(ud),ld=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var d=arguments[0],f=kd.MOD2_BOUNDARY_RULE;this._geom=d;this._geomFact=d.getFactory();this._bnRule=f}else 2===arguments.length&&(d=arguments[0],
f=arguments[1],this._geom=d,this._geomFact=d.getFactory(),this._bnRule=f)};ld.prototype.boundaryMultiLineString=function(d){if(this._geom.isEmpty())return this.getEmptyMultiPoint();d=this.computeBoundaryCoordinates(d);return 1===d.length?this._geomFact.createPoint(d[0]):this._geomFact.createMultiPointFromCoords(d)};ld.prototype.getBoundary=function(){return this._geom instanceof Hc?this.boundaryLineString(this._geom):this._geom instanceof We?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};
ld.prototype.boundaryLineString=function(d){return this._geom.isEmpty()?this.getEmptyMultiPoint():d.isClosed()?this._bnRule.isInBoundary(2)?d.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([d.getStartPoint(),d.getEndPoint()])};ld.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};ld.prototype.computeBoundaryCoordinates=function(d){var f=new Fa;this._endpointMap=new Ac;for(var l=0;l<d.getNumGeometries();l++){var h=d.getGeometryN(l);
0!==h.getNumPoints()&&(this.addEndpoint(h.getCoordinateN(0)),this.addEndpoint(h.getCoordinateN(h.getNumPoints()-1)))}for(d=this._endpointMap.entrySet().iterator();d.hasNext();)l=d.next(),h=l.getValue().count,this._bnRule.isInBoundary(h)&&f.add(l.getKey());return ab.toCoordinateArray(f)};ld.prototype.addEndpoint=function(d){var f=this._endpointMap.get(d);null===f&&(f=new ci,this._endpointMap.put(d,f));f.count++};ld.prototype.interfaces_=function(){return[]};ld.prototype.getClass=function(){return ld};
ld.getBoundary=function(){if(1===arguments.length)return(new ld(arguments[0])).getBoundary();if(2===arguments.length)return(new ld(arguments[0],arguments[1])).getBoundary()};var ci=function(){this.count=null};ci.prototype.interfaces_=function(){return[]};ci.prototype.getClass=function(){return ci};var zp=function(){},md=function(){},Ij={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};md.prototype.interfaces_=function(){return[]};md.prototype.getClass=function(){return md};md.chars=
function(d,f){for(var l=Array(f).fill(null),h=0;h<f;h++)l[h]=d;return String(l)};md.getStackTrace=function(){if(1===arguments.length){var d=arguments[0],f=new Ho,l=new Fo(f);return d.printStackTrace(l),f.toString()}if(2===arguments.length){d=arguments[1];f="";l=new Go(md.getStackTrace(arguments[0]));l=new Io(l);for(var h=0;h<d;h++)try{f+=l.readLine()+md.NEWLINE}catch(m){throw m;}return f}};md.split=function(d,f){var l=f.length,h=new Fa;d=""+d;for(var m=d.indexOf(f);0<=m;){var p=d.substring(0,m);h.add(p);
m=(d=d.substring(m+l)).indexOf(f)}0<d.length&&h.add(d);f=Array(h.size()).fill(null);for(l=0;l<f.length;l++)f[l]=h.get(l);return f};md.toString=function(){if(1===arguments.length)return md.SIMPLE_ORDINATE_FORMAT.format(arguments[0])};md.spaces=function(d){return md.chars(" ",d)};Ij.NEWLINE.get=function(){return Oc.getProperty("line.separator")};Ij.SIMPLE_ORDINATE_FORMAT.get=function(){return new zp("0.#")};Object.defineProperties(md,Ij);var dc=function(){};dc.prototype.interfaces_=function(){return[]};
dc.prototype.getClass=function(){return dc};dc.copyCoord=function(d,f,l,h){for(var m=Math.min(d.getDimension(),l.getDimension()),p=0;p<m;p++)l.setOrdinate(h,p,d.getOrdinate(f,p))};dc.isRing=function(d){var f=d.size();return 0===f||!(3>=f)&&d.getOrdinate(0,db.X)===d.getOrdinate(f-1,db.X)&&d.getOrdinate(0,db.Y)===d.getOrdinate(f-1,db.Y)};dc.isEqual=function(d,f){var l=d.size();if(l!==f.size())return!1;for(var h=Math.min(d.getDimension(),f.getDimension()),m=0;m<l;m++)for(var p=0;p<h;p++){var n=d.getOrdinate(m,
p),r=f.getOrdinate(m,p);if(!(d.getOrdinate(m,p)===f.getOrdinate(m,p)||Wa.isNaN(n)&&Wa.isNaN(r)))return!1}return!0};dc.extend=function(d,f,l){d=d.create(l,f.getDimension());var h=f.size();if(dc.copy(f,0,d,0,h),0<h)for(var m=h;m<l;m++)dc.copy(f,h-1,d,m,1);return d};dc.reverse=function(d){for(var f=d.size()-1,l=Math.trunc(f/2),h=0;h<=l;h++)dc.swap(d,h,f-h)};dc.swap=function(d,f,l){if(f===l)return null;for(var h=0;h<d.getDimension();h++){var m=d.getOrdinate(f,h);d.setOrdinate(f,h,d.getOrdinate(l,h));
d.setOrdinate(l,h,m)}};dc.copy=function(d,f,l,h,m){for(var p=0;p<m;p++)dc.copyCoord(d,f+p,l,h+p)};dc.toString=function(){if(1===arguments.length){var d=arguments[0],f=d.size();if(0===f)return"()";var l=d.getDimension(),h=new Cd;h.append("(");for(var m=0;m<f;m++){0<m&&h.append(" ");for(var p=0;p<l;p++)0<p&&h.append(","),h.append(md.toString(d.getOrdinate(m,p)))}return h.append(")"),h.toString()}};dc.ensureValidRing=function(d,f){var l=f.size();return 0===l?f:3>=l?dc.createClosedRing(d,f,4):f.getOrdinate(0,
db.X)===f.getOrdinate(l-1,db.X)&&f.getOrdinate(0,db.Y)===f.getOrdinate(l-1,db.Y)?f:dc.createClosedRing(d,f,l+1)};dc.createClosedRing=function(d,f,l){d=d.create(l,f.getDimension());var h=f.size();for(dc.copy(f,0,d,0,h);h<l;h++)dc.copy(f,0,d,h,1);return d};var Hc=function(d){function f(h,m){d.call(this,m);this._points=null;this.init(h)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=
function(){return this.isEmpty()?new Ia:this._points.expandEnvelope(new Ia)},f.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},f.prototype.getSortIndex=function(){return d.SORTINDEX_LINESTRING},f.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];if(!this.isEquivalentClass(h)||this._points.size()!==h._points.size())return!1;for(var p=0;p<this._points.size();p++)if(!this.equal(this._points.getCoordinate(p),
h._points.getCoordinate(p),m))return!1;return!0}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){for(var h=0;h<Math.trunc(this._points.size()/2);h++){var m=this._points.size()-1-h;if(!this._points.getCoordinate(h).equals(this._points.getCoordinate(m)))return 0<this._points.getCoordinate(h).compareTo(this._points.getCoordinate(m))&&dc.reverse(this._points),null}},f.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},f.prototype.getBoundaryDimension=
function(){return this.isClosed()?Eb.FALSE:0},f.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},f.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},f.prototype.getDimension=function(){return 1},f.prototype.getLength=function(){return Da.computeLength(this._points)},f.prototype.getNumPoints=function(){return this._points.size()},f.prototype.reverse=function(){var h=this._points.copy();
return dc.reverse(h),this.getFactory().createLineString(h)},f.prototype.compareToSameClass=function(){if(1===arguments.length){for(var h=arguments[0],m=0,p=0;m<this._points.size()&&p<h._points.size();){var n=this._points.getCoordinate(m).compareTo(h._points.getCoordinate(p));if(0!==n)return n;m++;p++}return m<this._points.size()?1:p<h._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},f.prototype.apply=function(h){if(Va(h,Ee))for(var m=0;m<
this._points.size();m++)h.filter(this._points.getCoordinate(m));else if(Va(h,Wd)){if(0===this._points.size())return null;for(m=0;m<this._points.size()&&(h.filter(this._points,m),!h.isDone());m++);h.isGeometryChanged()&&this.geometryChanged()}else Va(h,Ve)?h.filter(this):Va(h,se)&&h.filter(this)},f.prototype.getBoundary=function(){return(new ld(this)).getBoundary()},f.prototype.isEquivalentClass=function(h){return h instanceof f},f.prototype.clone=function(){var h=d.prototype.clone.call(this);return h._points=
this._points.clone(),h},f.prototype.getCoordinateN=function(h){return this._points.getCoordinate(h)},f.prototype.getGeometryType=function(){return"LineString"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._points},f.prototype.isEmpty=function(){return 0===this._points.size()},f.prototype.init=function(h){if(null===h&&(h=this.getFactory().getCoordinateSequenceFactory().create([])),1===h.size())throw new ac("Invalid number of points in LineString (found "+
h.size()+" - must be 0 or >= 2)");this._points=h},f.prototype.isCoordinate=function(h){for(var m=0;m<this._points.size();m++)if(this._points.getCoordinate(m).equals(h))return!0;return!1},f.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},f.prototype.getPointN=function(h){return this.getFactory().createPoint(this._points.getCoordinate(h))},f.prototype.interfaces_=function(){return[Vg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},
Object.defineProperties(f,l),f}(Ra),Wg=function(){};Wg.prototype.interfaces_=function(){return[]};Wg.prototype.getClass=function(){return Wg};var Xd=function(d){function f(h,m){d.call(this,m);this._coordinates=h||null;this.init(this._coordinates)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ia;var h=new Ia;return h.expandToInclude(this._coordinates.getX(0),
this._coordinates.getY(0)),h},f.prototype.getSortIndex=function(){return d.SORTINDEX_POINT},f.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&(!(!this.isEmpty()||!h.isEmpty())||this.isEmpty()===h.isEmpty()&&this.equal(h.getCoordinate(),this.getCoordinate(),m))}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=
function(){},f.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},f.prototype.getBoundaryDimension=function(){return Eb.FALSE},f.prototype.getDimension=function(){return 0},f.prototype.getNumPoints=function(){return this.isEmpty()?0:1},f.prototype.reverse=function(){return this.copy()},f.prototype.getX=function(){if(null===this.getCoordinate())throw Error("getX called on empty Point");return this.getCoordinate().x},f.prototype.compareToSameClass=
function(){if(1===arguments.length){var h=arguments[0];return this.getCoordinate().compareTo(h.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},f.prototype.apply=function(h){if(Va(h,Ee)){if(this.isEmpty())return null;h.filter(this.getCoordinate())}else if(Va(h,Wd)){if(this.isEmpty())return null;h.filter(this._coordinates,0);h.isGeometryChanged()&&this.geometryChanged()}else Va(h,Ve)?h.filter(this):Va(h,se)&&h.filter(this)},f.prototype.getBoundary=
function(){return this.getFactory().createGeometryCollection(null)},f.prototype.clone=function(){var h=d.prototype.clone.call(this);return h._coordinates=this._coordinates.clone(),h},f.prototype.getGeometryType=function(){return"Point"},f.prototype.copy=function(){return new f(this._coordinates.copy(),this._factory)},f.prototype.getCoordinateSequence=function(){return this._coordinates},f.prototype.getY=function(){if(null===this.getCoordinate())throw Error("getY called on empty Point");return this.getCoordinate().y},
f.prototype.isEmpty=function(){return 0===this._coordinates.size()},f.prototype.init=function(h){null===h&&(h=this.getFactory().getCoordinateSequenceFactory().create([]));Xa.isTrue(1>=h.size());this._coordinates=h},f.prototype.isSimple=function(){return!0},f.prototype.interfaces_=function(){return[Wg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(f,l),f}(Ra),Xe=function(){};Xe.prototype.interfaces_=function(){return[]};
Xe.prototype.getClass=function(){return Xe};var Fd=function(d){function f(h,m,p){if(d.call(this,p),this._shell=null,this._holes=null,null===h&&(h=this.getFactory().createLinearRing()),null===m&&(m=[]),d.hasNullElements(m))throw new ac("holes must not contain null elements");if(h.isEmpty()&&d.hasNonEmptyElements(m))throw new ac("shell is empty but holes are not");this._shell=h;this._holes=m}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};
return f.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},f.prototype.getSortIndex=function(){return d.SORTINDEX_POLYGON},f.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var h=Array(this.getNumPoints()).fill(null),m=-1,p=this._shell.getCoordinates(),n=0;n<p.length;n++)h[++m]=p[n];for(p=0;p<this._holes.length;p++){n=this._holes[p].getCoordinates();for(var r=0;r<n.length;r++)h[++m]=n[r]}return h},f.prototype.getArea=function(){var h=0+Math.abs(Da.signedArea(this._shell.getCoordinateSequence()));
for(var m=0;m<this._holes.length;m++)h-=Math.abs(Da.signedArea(this._holes[m].getCoordinateSequence()));return h},f.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var h=this._shell.getCoordinateSequence(),m=this.getEnvelopeInternal(),p=0;5>p;p++){var n=h.getX(p);if(n!==m.getMinX()&&n!==m.getMaxX())return!1;n=h.getY(p);if(n!==m.getMinY()&&n!==m.getMaxY())return!1}m=h.getX(0);p=h.getY(0);for(n=1;4>=n;n++){var r=h.getX(n),
v=h.getY(n);if(r!==m===(v!==p))return!1;m=r;p=v}return!0},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];if(!this.isEquivalentClass(h)||!this._shell.equalsExact(h._shell,m)||this._holes.length!==h._holes.length)return!1;for(var p=0;p<this._holes.length;p++)if(!this._holes[p].equalsExact(h._holes[p],m))return!1;return!0}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,
!0);for(var h=0;h<this._holes.length;h++)this.normalize(this._holes[h],!1);Ue.sort(this._holes)}else if(2===arguments.length){h=arguments[0];var m=arguments[1];if(h.isEmpty())return null;var p=Array(h.getCoordinates().length-1).fill(null);Oc.arraycopy(h.getCoordinates(),0,p,0,p.length);var n=ab.minCoordinate(h.getCoordinates());ab.scroll(p,n);Oc.arraycopy(p,0,h.getCoordinates(),0,p.length);h.getCoordinates()[p.length]=p[0];Da.isCCW(h.getCoordinates())===m&&ab.reverse(h.getCoordinates())}},f.prototype.getCoordinate=
function(){return this._shell.getCoordinate()},f.prototype.getNumInteriorRing=function(){return this._holes.length},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.getLength=function(){var h=0+this._shell.getLength();for(var m=0;m<this._holes.length;m++)h+=this._holes[m].getLength();return h},f.prototype.getNumPoints=function(){for(var h=this._shell.getNumPoints(),m=0;m<this._holes.length;m++)h+=this._holes[m].getNumPoints();return h},
f.prototype.reverse=function(){var h=this.copy();h._shell=this._shell.copy().reverse();h._holes=Array(this._holes.length).fill(null);for(var m=0;m<this._holes.length;m++)h._holes[m]=this._holes[m].copy().reverse();return h},f.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},f.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var h=arguments[1],m=arguments[0],p=this._shell.compareToSameClass(m._shell,
h);if(0!==p)return p;p=this.getNumInteriorRing();for(var n=m.getNumInteriorRing(),r=0;r<p&&r<n;){var v=this.getInteriorRingN(r),z=m.getInteriorRingN(r);v=v.compareToSameClass(z,h);if(0!==v)return v;r++}return r<p?1:r<n?-1:0}},f.prototype.apply=function(h){if(Va(h,Ee)){this._shell.apply(h);for(var m=0;m<this._holes.length;m++)this._holes[m].apply(h)}else if(Va(h,Wd)){if(this._shell.apply(h),!h.isDone())for(m=0;m<this._holes.length&&(this._holes[m].apply(h),!h.isDone());m++);h.isGeometryChanged()&&
this.geometryChanged()}else if(Va(h,Ve))h.filter(this);else if(Va(h,se))for(h.filter(this),this._shell.apply(h),m=0;m<this._holes.length;m++)this._holes[m].apply(h)},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var h=Array(this._holes.length+1).fill(null);h[0]=this._shell;for(var m=0;m<this._holes.length;m++)h[m+1]=this._holes[m];return 1>=h.length?this.getFactory().createLinearRing(h[0].getCoordinateSequence()):this.getFactory().createMultiLineString(h)},
f.prototype.clone=function(){var h=d.prototype.clone.call(this);h._shell=this._shell.clone();h._holes=Array(this._holes.length).fill(null);for(var m=0;m<this._holes.length;m++)h._holes[m]=this._holes[m].clone();return h},f.prototype.getGeometryType=function(){return"Polygon"},f.prototype.copy=function(){for(var h=this._shell.copy(),m=Array(this._holes.length).fill(null),p=0;p<m.length;p++)m[p]=this._holes[p].copy();return new f(h,m,this._factory)},f.prototype.getExteriorRing=function(){return this._shell},
f.prototype.isEmpty=function(){return this._shell.isEmpty()},f.prototype.getInteriorRingN=function(h){return this._holes[h]},f.prototype.interfaces_=function(){return[Xe]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(f,l),f}(Ra),ag=function(d){function f(){d.apply(this,arguments)}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=
function(){return Ra.SORTINDEX_MULTIPOINT},f.prototype.isValid=function(){return!0},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&d.prototype.equalsExact.call(this,h,m)}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():d.prototype.getCoordinate.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return Eb.FALSE},
f.prototype.getDimension=function(){return 0},f.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},f.prototype.getGeometryType=function(){return"MultiPoint"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=this._geometries[m].copy();return new f(h,this._factory)},f.prototype.interfaces_=function(){return[Wg]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},
Object.defineProperties(f,l),f}(ud),Yd=function(d){function f(h,m){h instanceof sa&&m instanceof bb&&(h=m.getCoordinateSequenceFactory().create(h));d.call(this,h,m);this.validateConstruction()}d&&(f.__proto__=d);f.prototype=Object.create(d&&d.prototype);f.prototype.constructor=f;var l={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return Ra.SORTINDEX_LINEARRING},f.prototype.getBoundaryDimension=function(){return Eb.FALSE},f.prototype.isClosed=
function(){return!!this.isEmpty()||d.prototype.isClosed.call(this)},f.prototype.reverse=function(){var h=this._points.copy();return dc.reverse(h),this.getFactory().createLinearRing(h)},f.prototype.validateConstruction=function(){if(!this.isEmpty()&&!d.prototype.isClosed.call(this))throw new ac("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<f.MINIMUM_VALID_SIZE)throw new ac("Invalid number of points in LinearRing (found "+
this.getCoordinateSequence().size()+" - must be 0 or >= 4)");},f.prototype.getGeometryType=function(){return"LinearRing"},f.prototype.copy=function(){return new f(this._points.copy(),this._factory)},f.prototype.interfaces_=function(){return[]},f.prototype.getClass=function(){return f},l.MINIMUM_VALID_SIZE.get=function(){return 4},l.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(f,l),f}(Hc),Fe=function(d){function f(){d.apply(this,arguments)}d&&(f.__proto__=d);f.prototype=
Object.create(d&&d.prototype);f.prototype.constructor=f;var l={serialVersionUID:{configurable:!0}};return f.prototype.getSortIndex=function(){return Ra.SORTINDEX_MULTIPOLYGON},f.prototype.equalsExact=function(){if(2===arguments.length){var h=arguments[0],m=arguments[1];return!!this.isEquivalentClass(h)&&d.prototype.equalsExact.call(this,h,m)}return d.prototype.equalsExact.apply(this,arguments)},f.prototype.getBoundaryDimension=function(){return 1},f.prototype.getDimension=function(){return 2},f.prototype.reverse=
function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<this._geometries.length;m++)h[m]=this._geometries[m].reverse();return this.getFactory().createMultiPolygon(h)},f.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var h=new Fa,m=0;m<this._geometries.length;m++)for(var p=this._geometries[m].getBoundary(),n=0;n<p.getNumGeometries();n++)h.add(p.getGeometryN(n));m=Array(h.size()).fill(null);return this.getFactory().createMultiLineString(h.toArray(m))},
f.prototype.getGeometryType=function(){return"MultiPolygon"},f.prototype.copy=function(){for(var h=Array(this._geometries.length).fill(null),m=0;m<h.length;m++)h[m]=this._geometries[m].copy();return new f(h,this._factory)},f.prototype.interfaces_=function(){return[Xe]},f.prototype.getClass=function(){return f},l.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(f,l),f}(ud),nd=function(d){this._factory=d||null;this._isUserDataCopied=!1},di={NoOpGeometryOperation:{configurable:!0},
CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};nd.prototype.setCopyUserData=function(d){this._isUserDataCopied=d};nd.prototype.edit=function(d,f){if(null===d)return null;f=this.editInternal(d,f);return this._isUserDataCopied&&f.setUserData(d.getUserData()),f};nd.prototype.editInternal=function(d,f){return null===this._factory&&(this._factory=d.getFactory()),d instanceof ud?this.editGeometryCollection(d,f):d instanceof Fd?this.editPolygon(d,f):d instanceof Xd||
d instanceof Hc?f.edit(d,this._factory):(Xa.shouldNeverReachHere("Unsupported Geometry class: "+d.getClass().getName()),null)};nd.prototype.editGeometryCollection=function(d,f){d=f.edit(d,this._factory);for(var l=new Fa,h=0;h<d.getNumGeometries();h++){var m=this.edit(d.getGeometryN(h),f);null===m||m.isEmpty()||l.add(m)}return d.getClass()===ag?this._factory.createMultiPoint(l.toArray([])):d.getClass()===We?this._factory.createMultiLineString(l.toArray([])):d.getClass()===Fe?this._factory.createMultiPolygon(l.toArray([])):
this._factory.createGeometryCollection(l.toArray([]))};nd.prototype.editPolygon=function(d,f){d=f.edit(d,this._factory);if(null===d&&(d=this._factory.createPolygon(null)),d.isEmpty())return d;var l=this.edit(d.getExteriorRing(),f);if(null===l||l.isEmpty())return this._factory.createPolygon();for(var h=new Fa,m=0;m<d.getNumInteriorRing();m++){var p=this.edit(d.getInteriorRingN(m),f);null===p||p.isEmpty()||h.add(p)}return this._factory.createPolygon(l,h.toArray([]))};nd.prototype.interfaces_=function(){return[]};
nd.prototype.getClass=function(){return nd};nd.GeometryEditorOperation=function(){};di.NoOpGeometryOperation.get=function(){return Xg};di.CoordinateOperation.get=function(){return Yg};di.CoordinateSequenceOperation.get=function(){return Zg};Object.defineProperties(nd,di);var Xg=function(){};Xg.prototype.edit=function(d,f){return d};Xg.prototype.interfaces_=function(){return[nd.GeometryEditorOperation]};Xg.prototype.getClass=function(){return Xg};var Yg=function(){};Yg.prototype.edit=function(d,f){var l=
this.editCoordinates(d.getCoordinates(),d);return null===l?d:d instanceof Yd?f.createLinearRing(l):d instanceof Hc?f.createLineString(l):d instanceof Xd?0<l.length?f.createPoint(l[0]):f.createPoint():d};Yg.prototype.interfaces_=function(){return[nd.GeometryEditorOperation]};Yg.prototype.getClass=function(){return Yg};var Zg=function(){};Zg.prototype.edit=function(d,f){return d instanceof Yd?f.createLinearRing(this.edit(d.getCoordinateSequence(),d)):d instanceof Hc?f.createLineString(this.edit(d.getCoordinateSequence(),
d)):d instanceof Xd?f.createPoint(this.edit(d.getCoordinateSequence(),d)):d};Zg.prototype.interfaces_=function(){return[nd.GeometryEditorOperation]};Zg.prototype.getClass=function(){return Zg};var hc=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length)if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var d=arguments[0];this._coordinates=Array(d).fill(null);for(var f=0;f<d;f++)this._coordinates[f]=new sa}else{if(Va(arguments[0],
db)){d=arguments[0];if(null===d)return this._coordinates=[].fill(null),null;this._dimension=d.getDimension();this._coordinates=Array(d.size()).fill(null);for(f=0;f<this._coordinates.length;f++)this._coordinates[f]=d.getCoordinateCopy(f)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1]))d=arguments[0],f=arguments[1],this._coordinates=d,this._dimension=f,null===d&&(this._coordinates=[].fill(null));else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1]))for(d=
arguments[0],f=arguments[1],this._coordinates=Array(d).fill(null),this._dimension=f,f=0;f<d;f++)this._coordinates[f]=new sa},kn={serialVersionUID:{configurable:!0}};hc.prototype.setOrdinate=function(d,f,l){switch(f){case db.X:this._coordinates[d].x=l;break;case db.Y:this._coordinates[d].y=l;break;case db.Z:this._coordinates[d].z=l;break;default:throw new ac("invalid ordinateIndex");}};hc.prototype.size=function(){return this._coordinates.length};hc.prototype.getOrdinate=function(d,f){switch(f){case db.X:return this._coordinates[d].x;
case db.Y:return this._coordinates[d].y;case db.Z:return this._coordinates[d].z}return Wa.NaN};hc.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var d=arguments[0],f=arguments[1];f.x=this._coordinates[d].x;f.y=this._coordinates[d].y;f.z=this._coordinates[d].z}};hc.prototype.getCoordinateCopy=function(d){return new sa(this._coordinates[d])};hc.prototype.getDimension=function(){return this._dimension};hc.prototype.getX=function(d){return this._coordinates[d].x};
hc.prototype.clone=function(){for(var d=Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)d[f]=this._coordinates[f].clone();return new hc(d,this._dimension)};hc.prototype.expandEnvelope=function(d){for(var f=0;f<this._coordinates.length;f++)d.expandToInclude(this._coordinates[f]);return d};hc.prototype.copy=function(){for(var d=Array(this.size()).fill(null),f=0;f<this._coordinates.length;f++)d[f]=this._coordinates[f].copy();return new hc(d,this._dimension)};hc.prototype.toString=function(){if(0<
this._coordinates.length){var d=new Cd(17*this._coordinates.length);d.append("(");d.append(this._coordinates[0]);for(var f=1;f<this._coordinates.length;f++)d.append(", "),d.append(this._coordinates[f]);return d.append(")"),d.toString()}return"()"};hc.prototype.getY=function(d){return this._coordinates[d].y};hc.prototype.toCoordinateArray=function(){return this._coordinates};hc.prototype.interfaces_=function(){return[db,id]};hc.prototype.getClass=function(){return hc};kn.serialVersionUID.get=function(){return-0xcb44a778db18e00};
Object.defineProperties(hc,kn);var Zd=function(){},Jj={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Zd.prototype.readResolve=function(){return Zd.instance()};Zd.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array||Va(arguments[0],db))return new hc(arguments[0])}else if(2===arguments.length){var d=arguments[0],f=arguments[1];return 3<f&&(f=3),2>f?new hc(d):new hc(d,f)}};Zd.prototype.interfaces_=function(){return[Sf,id]};Zd.prototype.getClass=
function(){return Zd};Zd.instance=function(){return Zd.instanceObject};Jj.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};Jj.instanceObject.get=function(){return new Zd};Object.defineProperties(Zd,Jj);var ln=function(d){function f(){d.call(this);this.map_=new Map}return d&&(f.__proto__=d),f.prototype=Object.create(d&&d.prototype),f.prototype.constructor=f,f.prototype.get=function(l){return this.map_.get(l)||null},f.prototype.put=function(l,h){return this.map_.set(l,h),h},f.prototype.values=
function(){for(var l=new Fa,h=this.map_.values(),m=h.next();!m.done;)l.add(m.value),m=h.next();return l},f.prototype.entrySet=function(){var l=new Hj;return this.map_.entries().forEach(function(h){return l.add(h)}),l},f.prototype.size=function(){return this.map_.size()},f}(sf),Fb=function f(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=f.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Gd){var l=arguments[0];this._modelType=l;l===f.FIXED&&this.setScale(1)}else"number"==
typeof arguments[0]?(l=arguments[0],this._modelType=f.FIXED,this.setScale(l)):arguments[0]instanceof f&&(l=arguments[0],this._modelType=l._modelType,this._scale=l._scale)},Kj={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Fb.prototype.equals=function(f){return f instanceof Fb?this._modelType===f._modelType&&this._scale===f._scale:!1};Fb.prototype.compareTo=function(f){var l=this.getMaximumSignificantDigits();f=f.getMaximumSignificantDigits();return(new Dd(l)).compareTo(new Dd(f))};
Fb.prototype.getScale=function(){return this._scale};Fb.prototype.isFloating=function(){return this._modelType===Fb.FLOATING||this._modelType===Fb.FLOATING_SINGLE};Fb.prototype.getType=function(){return this._modelType};Fb.prototype.toString=function(){var f="UNKNOWN";return this._modelType===Fb.FLOATING?f="Floating":this._modelType===Fb.FLOATING_SINGLE?f="Floating-Single":this._modelType===Fb.FIXED&&(f="Fixed (Scale="+this.getScale()+")"),f};Fb.prototype.makePrecise=function(f){if("number"==typeof f)return Wa.isNaN(f)||
this._modelType===Fb.FLOATING_SINGLE?f:this._modelType===Fb.FIXED?Math.round(f*this._scale)/this._scale:f;if(f instanceof sa){if(this._modelType===Fb.FLOATING)return null;f.x=this.makePrecise(f.x);f.y=this.makePrecise(f.y)}};Fb.prototype.getMaximumSignificantDigits=function(){var f=16;return this._modelType===Fb.FLOATING?f=16:this._modelType===Fb.FLOATING_SINGLE?f=6:this._modelType===Fb.FIXED&&(f=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),f};Fb.prototype.setScale=function(f){this._scale=
Math.abs(f)};Fb.prototype.interfaces_=function(){return[id,jd]};Fb.prototype.getClass=function(){return Fb};Fb.mostPrecise=function(f,l){return 0<=f.compareTo(l)?f:l};Kj.serialVersionUID.get=function(){return 0x6bee6404e9a25c00};Kj.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Fb,Kj);var Gd=function h(l){this._name=l||null;h.nameToTypeMap.put(l,this)},Lj={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Gd.prototype.readResolve=function(){return Gd.nameToTypeMap.get(this._name)};
Gd.prototype.toString=function(){return this._name};Gd.prototype.interfaces_=function(){return[id]};Gd.prototype.getClass=function(){return Gd};Lj.serialVersionUID.get=function(){return-0x4cb98acd40a6b400};Lj.nameToTypeMap.get=function(){return new ln};Object.defineProperties(Gd,Lj);Fb.Type=Gd;Fb.FIXED=new Gd("FIXED");Fb.FLOATING=new Gd("FLOATING");Fb.FLOATING_SINGLE=new Gd("FLOATING SINGLE");var bb=function h(){this._precisionModel=new Fb;this._SRID=0;this._coordinateSequenceFactory=h.getDefaultCoordinateSequenceFactory();
0===arguments.length||(1===arguments.length?Va(arguments[0],Sf)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Fb&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},mn={serialVersionUID:{configurable:!0}};bb.prototype.toGeometry=function(h){return h.isNull()?this.createPoint(null):h.getMinX()===
h.getMaxX()&&h.getMinY()===h.getMaxY()?this.createPoint(new sa(h.getMinX(),h.getMinY())):h.getMinX()===h.getMaxX()||h.getMinY()===h.getMaxY()?this.createLineString([new sa(h.getMinX(),h.getMinY()),new sa(h.getMaxX(),h.getMaxY())]):this.createPolygon(this.createLinearRing([new sa(h.getMinX(),h.getMinY()),new sa(h.getMinX(),h.getMaxY()),new sa(h.getMaxX(),h.getMaxY()),new sa(h.getMaxX(),h.getMinY()),new sa(h.getMinX(),h.getMinY())]),null)};bb.prototype.createLineString=function(h){return h?h instanceof
Array?new Hc(this.getCoordinateSequenceFactory().create(h),this):Va(h,db)?new Hc(h,this):void 0:new Hc(this.getCoordinateSequenceFactory().create([]),this)};bb.prototype.createMultiLineString=function(){if(0===arguments.length)return new We(null,this);if(1===arguments.length)return new We(arguments[0],this)};bb.prototype.buildGeometry=function(h){for(var m=null,p=!1,n=!1,r=h.iterator();r.hasNext();){var v=r.next(),z=v.getClass();null===m&&(m=z);z!==m&&(p=!0);v.isGeometryCollectionOrDerived()&&(n=
!0)}if(null===m)return this.createGeometryCollection();if(p||n)return this.createGeometryCollection(bb.toGeometryArray(h));m=h.iterator().next();if(1<h.size()){if(m instanceof Fd)return this.createMultiPolygon(bb.toPolygonArray(h));if(m instanceof Hc)return this.createMultiLineString(bb.toLineStringArray(h));if(m instanceof Xd)return this.createMultiPoint(bb.toPointArray(h));Xa.shouldNeverReachHere("Unhandled class: "+m.getClass().getName())}return m};bb.prototype.createMultiPointFromCoords=function(h){return this.createMultiPoint(null!==
h?this.getCoordinateSequenceFactory().create(h):null)};bb.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof sa){var h=arguments[0];return this.createPoint(null!==h?this.getCoordinateSequenceFactory().create([h]):null)}if(Va(arguments[0],db))return new Xd(arguments[0],this)}};bb.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};bb.prototype.createPolygon=
function(){if(0===arguments.length)return new Fd(null,null,this);if(1===arguments.length){if(Va(arguments[0],db)||arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Yd)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new Fd(arguments[0],arguments[1],this)};bb.prototype.getSRID=function(){return this._SRID};bb.prototype.createGeometryCollection=function(){if(0===arguments.length)return new ud(null,this);
if(1===arguments.length)return new ud(arguments[0],this)};bb.prototype.createGeometry=function(h){return(new nd(this)).edit(h,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})};bb.prototype.getPrecisionModel=function(){return this._precisionModel};bb.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var h=
arguments[0];return this.createLinearRing(null!==h?this.getCoordinateSequenceFactory().create(h):null)}if(Va(arguments[0],db))return new Yd(arguments[0],this)}};bb.prototype.createMultiPolygon=function(){if(0===arguments.length)return new Fe(null,this);if(1===arguments.length)return new Fe(arguments[0],this)};bb.prototype.createMultiPoint=function(){if(0===arguments.length)return new ag(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ag(arguments[0],this);if(arguments[0]instanceof
Array){var h=arguments[0];return this.createMultiPoint(null!==h?this.getCoordinateSequenceFactory().create(h):null)}if(Va(arguments[0],db)){h=arguments[0];if(null===h)return this.createMultiPoint([].fill(null));for(var m=Array(h.size()).fill(null),p=0;p<h.size();p++){var n=this.getCoordinateSequenceFactory().create(1,h.getDimension());dc.copy(h,p,n,0,1);m[p]=this.createPoint(n)}return this.createMultiPoint(m)}}};bb.prototype.interfaces_=function(){return[id]};bb.prototype.getClass=function(){return bb};
bb.toMultiPolygonArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toGeometryArray=function(h){if(null===h)return null;var m=Array(h.size()).fill(null);return h.toArray(m)};bb.getDefaultCoordinateSequenceFactory=function(){return Zd.instance()};bb.toMultiLineStringArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toLineStringArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toMultiPointArray=function(h){var m=Array(h.size()).fill(null);
return h.toArray(m)};bb.toLinearRingArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toPointArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.toPolygonArray=function(h){var m=Array(h.size()).fill(null);return h.toArray(m)};bb.createPointFromInternalCoord=function(h,m){return m.getPrecisionModel().makePrecise(h),m.getFactory().createPoint(h)};mn.serialVersionUID.get=function(){return-0x5ea75f2051eeb400};Object.defineProperties(bb,mn);var Ap="Point MultiPoint LineString MultiLineString Polygon MultiPolygon".split(" "),
ei=function(h){this.geometryFactory=h||new bb};ei.prototype.read=function(h){var m=(h="string"==typeof h?JSON.parse(h):h).type;if(!Hd[m])throw Error("Unknown GeoJSON type: "+h.type);return-1!==Ap.indexOf(m)?Hd[m].apply(this,[h.coordinates]):"GeometryCollection"===m?Hd[m].apply(this,[h.geometries]):Hd[m].apply(this,[h])};ei.prototype.write=function(h){var m=h.getGeometryType();if(!ve[m])throw Error("Geometry is not supported");return ve[m].apply(this,[h])};var Hd={Feature:function(h){var m={},p;for(p in h)m[p]=
h[p];if(h.geometry){if(!Hd[h.geometry.type])throw Error("Unknown GeoJSON type: "+h.type);m.geometry=this.read(h.geometry)}return h.bbox&&(m.bbox=Hd.bbox.apply(this,[h.bbox])),m},FeatureCollection:function(h){var m={};if(h.features){m.features=[];for(var p=0;p<h.features.length;++p)m.features.push(this.read(h.features[p]))}return h.bbox&&(m.bbox=this.parse.bbox.apply(this,[h.bbox])),m},coordinates:function(h){for(var m=[],p=0;p<h.length;++p){var n=h[p];m.push(new sa(n[0],n[1]))}return m},bbox:function(h){return this.geometryFactory.createLinearRing([new sa(h[0],
h[1]),new sa(h[2],h[1]),new sa(h[2],h[3]),new sa(h[0],h[3]),new sa(h[0],h[1])])},Point:function(h){h=new sa(h[0],h[1]);return this.geometryFactory.createPoint(h)},MultiPoint:function(h){for(var m=[],p=0;p<h.length;++p)m.push(Hd.Point.apply(this,[h[p]]));return this.geometryFactory.createMultiPoint(m)},LineString:function(h){h=Hd.coordinates.apply(this,[h]);return this.geometryFactory.createLineString(h)},MultiLineString:function(h){for(var m=[],p=0;p<h.length;++p)m.push(Hd.LineString.apply(this,[h[p]]));
return this.geometryFactory.createMultiLineString(m)},Polygon:function(h){var m=Hd.coordinates.apply(this,[h[0]]);m=this.geometryFactory.createLinearRing(m);for(var p=[],n=1;n<h.length;++n){var r=Hd.coordinates.apply(this,[h[n]]);r=this.geometryFactory.createLinearRing(r);p.push(r)}return this.geometryFactory.createPolygon(m,p)},MultiPolygon:function(h){for(var m=[],p=0;p<h.length;++p)m.push(Hd.Polygon.apply(this,[h[p]]));return this.geometryFactory.createMultiPolygon(m)},GeometryCollection:function(h){for(var m=
[],p=0;p<h.length;++p)m.push(this.read(h[p]));return this.geometryFactory.createGeometryCollection(m)}},ve={coordinate:function(h){return[h.x,h.y]},Point:function(h){return{type:"Point",coordinates:ve.coordinate.apply(this,[h.getCoordinate()])}},MultiPoint:function(h){for(var m=[],p=0;p<h._geometries.length;++p){var n=ve.Point.apply(this,[h._geometries[p]]);m.push(n.coordinates)}return{type:"MultiPoint",coordinates:m}},LineString:function(h){var m=[];h=h.getCoordinates();for(var p=0;p<h.length;++p)m.push(ve.coordinate.apply(this,
[h[p]]));return{type:"LineString",coordinates:m}},MultiLineString:function(h){for(var m=[],p=0;p<h._geometries.length;++p){var n=ve.LineString.apply(this,[h._geometries[p]]);m.push(n.coordinates)}return{type:"MultiLineString",coordinates:m}},Polygon:function(h){var m=[],p=ve.LineString.apply(this,[h._shell]);m.push(p.coordinates);for(p=0;p<h._holes.length;++p){var n=ve.LineString.apply(this,[h._holes[p]]);m.push(n.coordinates)}return{type:"Polygon",coordinates:m}},MultiPolygon:function(h){for(var m=
[],p=0;p<h._geometries.length;++p){var n=ve.Polygon.apply(this,[h._geometries[p]]);m.push(n.coordinates)}return{type:"MultiPolygon",coordinates:m}},GeometryCollection:function(h){for(var m=[],p=0;p<h._geometries.length;++p){var n=h._geometries[p],r=n.getGeometryType();m.push(ve[r].apply(this,[n]))}return{type:"GeometryCollection",geometries:m}}},qj=function(h){this.geometryFactory=h||new bb;this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new ei(this.geometryFactory)};qj.prototype.read=
function(h){h=this.parser.read(h);return this.precisionModel.getType()===Fb.FIXED&&this.reducePrecision(h),h};qj.prototype.reducePrecision=function(h){var m;if(h.coordinate)this.precisionModel.makePrecise(h.coordinate);else if(h.points){var p=0;for(m=h.points.length;p<m;p++)this.precisionModel.makePrecise(h.points[p])}else if(h.geometries)for(p=0,m=h.geometries.length;p<m;p++)this.reducePrecision(h.geometries[p])};var Cm=function(){this.parser=new ei(this.geometryFactory)};Cm.prototype.write=function(h){return this.parser.write(h)};
var Aa=function(){},fi={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Aa.prototype.interfaces_=function(){return[]};Aa.prototype.getClass=function(){return Aa};Aa.opposite=function(h){return h===Aa.LEFT?Aa.RIGHT:h===Aa.RIGHT?Aa.LEFT:h};fi.ON.get=function(){return 0};fi.LEFT.get=function(){return 1};fi.RIGHT.get=function(){return 2};Object.defineProperties(Aa,fi);Mh.prototype=Error();Mh.prototype.name="EmptyStackException";Ad.prototype=new ue;Ad.prototype.add=function(h){return this.array_.push(h),
!0};Ad.prototype.get=function(h){if(0>h||h>=this.size())throw Error();return this.array_[h]};Ad.prototype.push=function(h){return this.array_.push(h),h};Ad.prototype.pop=function(h){if(0===this.array_.length)throw new Mh;return this.array_.pop()};Ad.prototype.peek=function(){if(0===this.array_.length)throw new Mh;return this.array_[this.array_.length-1]};Ad.prototype.empty=function(){return 0===this.array_.length};Ad.prototype.isEmpty=function(){return this.empty()};Ad.prototype.search=function(h){return this.array_.indexOf(h)};
Ad.prototype.size=function(){return this.array_.length};Ad.prototype.toArray=function(){for(var h=[],m=0,p=this.array_.length;m<p;m++)h.push(this.array_[m]);return h};var Id=function(){this._minIndex=-1;this._orientedDe=this._minDe=this._minCoord=null};Id.prototype.getCoordinate=function(){return this._minCoord};Id.prototype.getRightmostSide=function(h,m){var p=this.getRightmostSideOfSegment(h,m);return 0>p&&(p=this.getRightmostSideOfSegment(h,m-1)),0>p&&(this._minCoord=null,this.checkForRightmostCoordinate(h)),
p};Id.prototype.findRightmostEdgeAtVertex=function(){var h=this._minDe.getEdge().getCoordinates();Xa.isTrue(0<this._minIndex&&this._minIndex<h.length,"rightmost point expected to be interior vertex of edge");var m=h[this._minIndex-1];h=h[this._minIndex+1];var p=Da.computeOrientation(this._minCoord,h,m),n=!1;(m.y<this._minCoord.y&&h.y<this._minCoord.y&&p===Da.COUNTERCLOCKWISE||m.y>this._minCoord.y&&h.y>this._minCoord.y&&p===Da.CLOCKWISE)&&(n=!0);n&&--this._minIndex};Id.prototype.getRightmostSideOfSegment=
function(h,m){h=h.getEdge().getCoordinates();if(0>m||m+1>=h.length||h[m].y===h[m+1].y)return-1;var p=Aa.LEFT;return h[m].y<h[m+1].y&&(p=Aa.RIGHT),p};Id.prototype.getEdge=function(){return this._orientedDe};Id.prototype.checkForRightmostCoordinate=function(h){for(var m=h.getEdge().getCoordinates(),p=0;p<m.length-1;p++)(null===this._minCoord||m[p].x>this._minCoord.x)&&(this._minDe=h,this._minIndex=p,this._minCoord=m[p])};Id.prototype.findRightmostEdgeAtNode=function(){this._minDe=this._minDe.getNode().getEdges().getRightmostEdge();
this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Id.prototype.findEdge=function(h){for(h=h.iterator();h.hasNext();){var m=h.next();m.isForward()&&this.checkForRightmostCoordinate(m)}Xa.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing");0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex();this._orientedDe=this._minDe;this.getRightmostSide(this._minDe,
this._minIndex)===Aa.LEFT&&(this._orientedDe=this._minDe.getSym())};Id.prototype.interfaces_=function(){return[]};Id.prototype.getClass=function(){return Id};var we=function(h){function m(p,n){h.call(this,m.msgWithCoord(p,n));this.pt=n?new sa(n):null;this.name="TopologyException"}return h&&(m.__proto__=h),m.prototype=Object.create(h&&h.prototype),m.prototype.constructor=m,m.prototype.getCoordinate=function(){return this.pt},m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},
m.msgWithCoord=function(p,n){return n?p:p+" [ "+n+" ]"},m}(re),gi=function(){this.array_=[]};gi.prototype.addLast=function(h){this.array_.push(h)};gi.prototype.removeFirst=function(){return this.array_.shift()};gi.prototype.isEmpty=function(){return 0===this.array_.length};var Ic=function(){this._finder=null;this._dirEdgeList=new Fa;this._nodes=new Fa;this._env=this._rightMostCoord=null;this._finder=new Id};Ic.prototype.clearVisitedEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();)h.next().setVisited(!1)};
Ic.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Ic.prototype.computeNodeDepth=function(h){for(var m=null,p=h.getEdges().iterator();p.hasNext();){var n=p.next();if(n.isVisited()||n.getSym().isVisited()){m=n;break}}if(null===m)throw new we("unable to find edge to compute depths at "+h.getCoordinate());h.getEdges().computeDepths(m);for(h=h.getEdges().iterator();h.hasNext();)m=h.next(),m.setVisited(!0),this.copySymDepths(m)};Ic.prototype.computeDepth=function(h){this.clearVisitedEdges();
var m=this._finder.getEdge();m.setEdgeDepths(Aa.RIGHT,h);this.copySymDepths(m);this.computeDepths(m)};Ic.prototype.create=function(h){this.addReachable(h);this._finder.findEdge(this._dirEdgeList);this._rightMostCoord=this._finder.getCoordinate()};Ic.prototype.findResultEdges=function(){for(var h=this._dirEdgeList.iterator();h.hasNext();){var m=h.next();1<=m.getDepth(Aa.RIGHT)&&0>=m.getDepth(Aa.LEFT)&&!m.isInteriorAreaEdge()&&m.setInResult(!0)}};Ic.prototype.computeDepths=function(h){var m=new Hj,
p=new gi,n=h.getNode();p.addLast(n);m.add(n);for(h.setVisited(!0);!p.isEmpty();)for(h=p.removeFirst(),m.add(h),this.computeNodeDepth(h),h=h.getEdges().iterator();h.hasNext();)n=h.next().getSym(),n.isVisited()||(n=n.getNode(),m.contains(n)||(p.addLast(n),m.add(n)))};Ic.prototype.compareTo=function(h){return this._rightMostCoord.x<h._rightMostCoord.x?-1:this._rightMostCoord.x>h._rightMostCoord.x?1:0};Ic.prototype.getEnvelope=function(){if(null===this._env){for(var h=new Ia,m=this._dirEdgeList.iterator();m.hasNext();)for(var p=
m.next().getEdge().getCoordinates(),n=0;n<p.length-1;n++)h.expandToInclude(p[n]);this._env=h}return this._env};Ic.prototype.addReachable=function(h){var m=new Ad;for(m.add(h);!m.empty();)h=m.pop(),this.add(h,m)};Ic.prototype.copySymDepths=function(h){var m=h.getSym();m.setDepth(Aa.LEFT,h.getDepth(Aa.RIGHT));m.setDepth(Aa.RIGHT,h.getDepth(Aa.LEFT))};Ic.prototype.add=function(h,m){h.setVisited(!0);this._nodes.add(h);for(h=h.getEdges().iterator();h.hasNext();){var p=h.next();this._dirEdgeList.add(p);
p=p.getSym().getNode();p.isVisited()||m.push(p)}};Ic.prototype.getNodes=function(){return this._nodes};Ic.prototype.getDirectedEdges=function(){return this._dirEdgeList};Ic.prototype.interfaces_=function(){return[jd]};Ic.prototype.getClass=function(){return Ic};var Qb=function m(){if(this.location=null,1===arguments.length)if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var p=arguments[0];this.init(1);this.location[Aa.ON]=p}else{if(arguments[0]instanceof
m&&(p=arguments[0],this.init(p.location.length),null!==p))for(var n=0;n<this.location.length;n++)this.location[n]=p.location[n]}else if(3===arguments.length){p=arguments[0];n=arguments[1];var r=arguments[2];this.init(3);this.location[Aa.ON]=p;this.location[Aa.LEFT]=n;this.location[Aa.RIGHT]=r}};Qb.prototype.setAllLocations=function(m){for(var p=0;p<this.location.length;p++)this.location[p]=m};Qb.prototype.isNull=function(){for(var m=0;m<this.location.length;m++)if(this.location[m]!==ua.NONE)return!1;
return!0};Qb.prototype.setAllLocationsIfNull=function(m){for(var p=0;p<this.location.length;p++)this.location[p]===ua.NONE&&(this.location[p]=m)};Qb.prototype.isLine=function(){return 1===this.location.length};Qb.prototype.merge=function(m){if(m.location.length>this.location.length){var p=Array(3).fill(null);p[Aa.ON]=this.location[Aa.ON];p[Aa.LEFT]=ua.NONE;p[Aa.RIGHT]=ua.NONE;this.location=p}for(p=0;p<this.location.length;p++)this.location[p]===ua.NONE&&p<m.location.length&&(this.location[p]=m.location[p])};
Qb.prototype.getLocations=function(){return this.location};Qb.prototype.flip=function(){if(1>=this.location.length)return null;var m=this.location[Aa.LEFT];this.location[Aa.LEFT]=this.location[Aa.RIGHT];this.location[Aa.RIGHT]=m};Qb.prototype.toString=function(){var m=new Cd;return 1<this.location.length&&m.append(ua.toLocationSymbol(this.location[Aa.LEFT])),m.append(ua.toLocationSymbol(this.location[Aa.ON])),1<this.location.length&&m.append(ua.toLocationSymbol(this.location[Aa.RIGHT])),m.toString()};
Qb.prototype.setLocations=function(m,p,n){this.location[Aa.ON]=m;this.location[Aa.LEFT]=p;this.location[Aa.RIGHT]=n};Qb.prototype.get=function(m){return m<this.location.length?this.location[m]:ua.NONE};Qb.prototype.isArea=function(){return 1<this.location.length};Qb.prototype.isAnyNull=function(){for(var m=0;m<this.location.length;m++)if(this.location[m]===ua.NONE)return!0;return!1};Qb.prototype.setLocation=function(){1===arguments.length?this.setLocation(Aa.ON,arguments[0]):2===arguments.length&&
(this.location[arguments[0]]=arguments[1])};Qb.prototype.init=function(m){this.location=Array(m).fill(null);this.setAllLocations(ua.NONE)};Qb.prototype.isEqualOnSide=function(m,p){return this.location[p]===m.location[p]};Qb.prototype.allPositionsEqual=function(m){for(var p=0;p<this.location.length;p++)if(this.location[p]!==m)return!1;return!0};Qb.prototype.interfaces_=function(){return[]};Qb.prototype.getClass=function(){return Qb};var Jb=function p(){if(this.elt=Array(2).fill(null),1===arguments.length)if(Number.isInteger(arguments[0])){var n=
arguments[0];this.elt[0]=new Qb(n);this.elt[1]=new Qb(n)}else arguments[0]instanceof p&&(n=arguments[0],this.elt[0]=new Qb(n.elt[0]),this.elt[1]=new Qb(n.elt[1]));else if(2===arguments.length){n=arguments[0];var r=arguments[1];this.elt[0]=new Qb(ua.NONE);this.elt[1]=new Qb(ua.NONE);this.elt[n].setLocation(r)}else if(3===arguments.length){n=arguments[0];r=arguments[1];var v=arguments[2];this.elt[0]=new Qb(n,r,v);this.elt[1]=new Qb(n,r,v)}else if(4===arguments.length){n=arguments[0];r=arguments[1];
v=arguments[2];var z=arguments[3];this.elt[0]=new Qb(ua.NONE,ua.NONE,ua.NONE);this.elt[1]=new Qb(ua.NONE,ua.NONE,ua.NONE);this.elt[n].setLocations(r,v,z)}};Jb.prototype.getGeometryCount=function(){var p=0;return this.elt[0].isNull()||p++,this.elt[1].isNull()||p++,p};Jb.prototype.setAllLocations=function(p,n){this.elt[p].setAllLocations(n)};Jb.prototype.isNull=function(p){return this.elt[p].isNull()};Jb.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var p=arguments[0];this.setAllLocationsIfNull(0,
p);this.setAllLocationsIfNull(1,p)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])};Jb.prototype.isLine=function(p){return this.elt[p].isLine()};Jb.prototype.merge=function(p){for(var n=0;2>n;n++)null===this.elt[n]&&null!==p.elt[n]?this.elt[n]=new Qb(p.elt[n]):this.elt[n].merge(p.elt[n])};Jb.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip()};Jb.prototype.getLocation=function(){if(1===arguments.length)return this.elt[arguments[0]].get(Aa.ON);if(2===
arguments.length)return this.elt[arguments[0]].get(arguments[1])};Jb.prototype.toString=function(){var p=new Cd;return null!==this.elt[0]&&(p.append("A:"),p.append(this.elt[0].toString())),null!==this.elt[1]&&(p.append(" B:"),p.append(this.elt[1].toString())),p.toString()};Jb.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length)return this.elt[arguments[0]].isArea()};Jb.prototype.isAnyNull=function(p){return this.elt[p].isAnyNull()};
Jb.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(Aa.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])};Jb.prototype.isEqualOnSide=function(p,n){return this.elt[0].isEqualOnSide(p.elt[0],n)&&this.elt[1].isEqualOnSide(p.elt[1],n)};Jb.prototype.allPositionsEqual=function(p,n){return this.elt[p].allPositionsEqual(n)};Jb.prototype.toLine=function(p){this.elt[p].isArea()&&(this.elt[p]=new Qb(this.elt[p].location[0]))};
Jb.prototype.interfaces_=function(){return[]};Jb.prototype.getClass=function(){return Jb};Jb.toLineLabel=function(p){for(var n=new Jb(ua.NONE),r=0;2>r;r++)n.setLocation(r,p.getLocation(r));return n};var ic=function(p,n){this._startDe=null;this._maxNodeDegree=-1;this._edges=new Fa;this._pts=new Fa;this._label=new Jb(ua.NONE);this._shell=this._isHole=this._ring=null;this._holes=new Fa;this._geometryFactory=n;this.computePoints(p);this.computeRing()};ic.prototype.computeRing=function(){if(null!==this._ring)return null;
for(var p=Array(this._pts.size()).fill(null),n=0;n<this._pts.size();n++)p[n]=this._pts.get(n);this._ring=this._geometryFactory.createLinearRing(p);this._isHole=Da.isCCW(this._ring.getCoordinates())};ic.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()};ic.prototype.computePoints=function(p){this._startDe=p;var n=!0;do{if(null===p)throw new we("Found null DirectedEdge");if(p.getEdgeRing()===this)throw new we("Directed Edge visited twice during ring-building at "+p.getCoordinate());
this._edges.add(p);var r=p.getLabel();Xa.isTrue(r.isArea());this.mergeLabel(r);this.addPoints(p.getEdge(),p.isForward(),n);n=!1;this.setEdgeRing(p,this);p=this.getNext(p)}while(p!==this._startDe)};ic.prototype.getLinearRing=function(){return this._ring};ic.prototype.getCoordinate=function(p){return this._pts.get(p)};ic.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var p=this._startDe;do{var n=p.getNode().getEdges().getOutgoingDegree(this);n>this._maxNodeDegree&&(this._maxNodeDegree=
n);p=this.getNext(p)}while(p!==this._startDe);this._maxNodeDegree*=2};ic.prototype.addPoints=function(p,n,r){p=p.getCoordinates();if(n)for(n=1,r&&(n=0),r=n;r<p.length;r++)this._pts.add(p[r]);else for(n=p.length-2,r&&(n=p.length-1),r=n;0<=r;r--)this._pts.add(p[r])};ic.prototype.isHole=function(){return this._isHole};ic.prototype.setInResult=function(){var p=this._startDe;do p.getEdge().setInResult(!0),p=p.getNext();while(p!==this._startDe)};ic.prototype.containsPoint=function(p){var n=this.getLinearRing();
if(!n.getEnvelopeInternal().contains(p)||!Da.isPointInRing(p,n.getCoordinates()))return!1;for(n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(p))return!1;return!0};ic.prototype.addHole=function(p){this._holes.add(p)};ic.prototype.isShell=function(){return null===this._shell};ic.prototype.getLabel=function(){return this._label};ic.prototype.getEdges=function(){return this._edges};ic.prototype.getMaxNodeDegree=function(){return 0>this._maxNodeDegree&&this.computeMaxNodeDegree(),this._maxNodeDegree};
ic.prototype.getShell=function(){return this._shell};ic.prototype.mergeLabel=function(){if(1===arguments.length){var p=arguments[0];this.mergeLabel(p,0);this.mergeLabel(p,1)}else if(2===arguments.length){p=arguments[1];var n=arguments[0].getLocation(p,Aa.RIGHT);if(n===ua.NONE)return null;if(this._label.getLocation(p)===ua.NONE)return this._label.setLocation(p,n),null}};ic.prototype.setShell=function(p){this._shell=p;null!==p&&p.addHole(this)};ic.prototype.toPolygon=function(p){for(var n=Array(this._holes.size()).fill(null),
r=0;r<this._holes.size();r++)n[r]=this._holes.get(r).getLinearRing();return p.createPolygon(this.getLinearRing(),n)};ic.prototype.interfaces_=function(){return[]};ic.prototype.getClass=function(){return ic};var Bp=function(p){function n(r,v){p.call(this,r,v)}return p&&(n.__proto__=p),n.prototype=Object.create(p&&p.prototype),n.prototype.constructor=n,n.prototype.setEdgeRing=function(r,v){r.setMinEdgeRing(v)},n.prototype.getNext=function(r){return r.getNextMin()},n.prototype.interfaces_=function(){return[]},
n.prototype.getClass=function(){return n},n}(ic),Cp=function(p){function n(r,v){p.call(this,r,v)}return p&&(n.__proto__=p),n.prototype=Object.create(p&&p.prototype),n.prototype.constructor=n,n.prototype.buildMinimalRings=function(){var r=new Fa,v=this._startDe;do{if(null===v.getMinEdgeRing()){var z=new Bp(v,this._geometryFactory);r.add(z)}v=v.getNext()}while(v!==this._startDe);return r},n.prototype.setEdgeRing=function(r,v){r.setEdgeRing(v)},n.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=
this._startDe;do r.getNode().getEdges().linkMinimalDirectedEdges(this),r=r.getNext();while(r!==this._startDe)},n.prototype.getNext=function(r){return r.getNext()},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(ic),dd=function(){(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length)&&1===arguments.length&&(this._label=arguments[0])};dd.prototype.setVisited=function(p){this._isVisited=p};dd.prototype.setInResult=
function(p){this._isInResult=p};dd.prototype.isCovered=function(){return this._isCovered};dd.prototype.isCoveredSet=function(){return this._isCoveredSet};dd.prototype.setLabel=function(p){this._label=p};dd.prototype.getLabel=function(){return this._label};dd.prototype.setCovered=function(p){this._isCovered=p;this._isCoveredSet=!0};dd.prototype.updateIM=function(p){Xa.isTrue(2<=this._label.getGeometryCount(),"found partial label");this.computeIM(p)};dd.prototype.isInResult=function(){return this._isInResult};
dd.prototype.isVisited=function(){return this._isVisited};dd.prototype.interfaces_=function(){return[]};dd.prototype.getClass=function(){return dd};var hi=function(p){function n(r,v){p.call(this);this._coord=r;this._edges=v;this._label=new Jb(0,ua.NONE)}return p&&(n.__proto__=p),n.prototype=Object.create(p&&p.prototype),n.prototype.constructor=n,n.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();)if(r.next().getEdge().isInResult())return!0;return!1},
n.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},n.prototype.getCoordinate=function(){return this._coord},n.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},n.prototype.computeIM=function(r){},n.prototype.computeMergedLocation=function(r,v){var z;(z=this._label.getLocation(v),r.isNull(v))||(r=r.getLocation(v),z!==ua.BOUNDARY&&(z=r));return z},n.prototype.setLabel=function(){if(2!==arguments.length)return p.prototype.setLabel.apply(this,arguments);
var r=arguments[0],v=arguments[1];null===this._label?this._label=new Jb(r,v):this._label.setLocation(r,v)},n.prototype.getEdges=function(){return this._edges},n.prototype.mergeLabel=function(r){if(r instanceof n)this.mergeLabel(r._label);else if(r instanceof Jb)for(var v=0;2>v;v++){var z=this.computeMergedLocation(r,v);this._label.getLocation(v)===ua.NONE&&this._label.setLocation(v,z)}},n.prototype.add=function(r){this._edges.insert(r);r.setNode(this)},n.prototype.setLabelBoundary=function(r){if(null===
this._label)return null;var v=ua.NONE;null!==this._label&&(v=this._label.getLocation(r));switch(v){case ua.BOUNDARY:v=ua.INTERIOR;break;default:v=ua.BOUNDARY}this._label.setLocation(r,v)},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},n}(dd),Jd=function(p){this.nodeMap=new Ac;this.nodeFact=p};Jd.prototype.find=function(p){return this.nodeMap.get(p)};Jd.prototype.addNode=function(p){if(p instanceof sa){var n=this.nodeMap.get(p);return null===n&&(n=this.nodeFact.createNode(p),
this.nodeMap.put(p,n)),n}if(p instanceof hi)return n=this.nodeMap.get(p.getCoordinate()),null===n?(this.nodeMap.put(p.getCoordinate(),p),p):(n.mergeLabel(p),n)};Jd.prototype.print=function(p){for(var n=this.iterator();n.hasNext();)n.next().print(p)};Jd.prototype.iterator=function(){return this.nodeMap.values().iterator()};Jd.prototype.values=function(){return this.nodeMap.values()};Jd.prototype.getBoundaryNodes=function(p){for(var n=new Fa,r=this.iterator();r.hasNext();){var v=r.next();v.getLabel().getLocation(p)===
ua.BOUNDARY&&n.add(v)}return n};Jd.prototype.add=function(p){var n=p.getCoordinate();this.addNode(n).add(p)};Jd.prototype.interfaces_=function(){return[]};Jd.prototype.getClass=function(){return Jd};var Mb=function(){},$g={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Mb.prototype.interfaces_=function(){return[]};Mb.prototype.getClass=function(){return Mb};Mb.isNorthern=function(p){return p===Mb.NE||p===Mb.NW};Mb.isOpposite=function(p,n){return p!==n&&2===(p-
n+4)%4};Mb.commonHalfPlane=function(p,n){if(p===n)return p;if(2===(p-n+4)%4)return-1;var r=p<n?p:n;return 0===r&&3===(p>n?p:n)?3:r};Mb.isInHalfPlane=function(p,n){return n===Mb.SE?p===Mb.SE||p===Mb.SW:p===n||p===n+1};Mb.quadrant=function(p,n){if("number"==typeof p&&"number"==typeof n){if(0===p&&0===n)throw new ac("Cannot compute the quadrant for point ( "+p+", "+n+" )");return 0<=p?0<=n?Mb.NE:Mb.SE:0<=n?Mb.NW:Mb.SW}if(p instanceof sa&&n instanceof sa){if(n.x===p.x&&n.y===p.y)throw new ac("Cannot compute the quadrant for two identical points "+
p);return n.x>=p.x?n.y>=p.y?Mb.NE:Mb.SE:n.y>=p.y?Mb.NW:Mb.SW}};$g.NE.get=function(){return 0};$g.NW.get=function(){return 1};$g.SW.get=function(){return 2};$g.SE.get=function(){return 3};Object.defineProperties(Mb,$g);var Bc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var p=arguments[1],n=arguments[2];this._edge=arguments[0];this.init(p,
n);this._label=null}else if(4===arguments.length){p=arguments[1];n=arguments[2];var r=arguments[3];this._edge=arguments[0];this.init(p,n);this._label=r}};Bc.prototype.compareDirection=function(p){return this._dx===p._dx&&this._dy===p._dy?0:this._quadrant>p._quadrant?1:this._quadrant<p._quadrant?-1:Da.computeOrientation(p._p0,p._p1,this._p1)};Bc.prototype.getDy=function(){return this._dy};Bc.prototype.getCoordinate=function(){return this._p0};Bc.prototype.setNode=function(p){this._node=p};Bc.prototype.print=
function(p){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),v=r.lastIndexOf(".");r=r.substring(v+1);p.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Bc.prototype.compareTo=function(p){return this.compareDirection(p)};Bc.prototype.getDirectedCoordinate=function(){return this._p1};Bc.prototype.getDx=function(){return this._dx};Bc.prototype.getLabel=function(){return this._label};Bc.prototype.getEdge=function(){return this._edge};Bc.prototype.getQuadrant=
function(){return this._quadrant};Bc.prototype.getNode=function(){return this._node};Bc.prototype.toString=function(){var p=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf(".");return"  "+n.substring(r+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+p+"   "+this._label};Bc.prototype.computeLabel=function(p){};Bc.prototype.init=function(p,n){this._p0=p;this._p1=n;this._dx=n.x-p.x;this._dy=n.y-p.y;this._quadrant=Mb.quadrant(this._dx,this._dy);Xa.isTrue(!(0===this._dx&&
0===this._dy),"EdgeEnd with identical endpoints found")};Bc.prototype.interfaces_=function(){return[jd]};Bc.prototype.getClass=function(){return Bc};var Mj=function(p){function n(r,v){(p.call(this,r),this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=v,v)?this.init(r.getCoordinate(0),r.getCoordinate(1)):(v=r.getNumPoints()-1,this.init(r.getCoordinate(v),r.getCoordinate(v-1)));
this.computeDirectedLabel()}return p&&(n.__proto__=p),n.prototype=Object.create(p&&p.prototype),n.prototype.constructor=n,n.prototype.getNextMin=function(){return this._nextMin},n.prototype.getDepth=function(r){return this._depth[r]},n.prototype.setVisited=function(r){this._isVisited=r},n.prototype.computeDirectedLabel=function(){this._label=new Jb(this._edge.getLabel());this._isForward||this._label.flip()},n.prototype.getNext=function(){return this._next},n.prototype.setDepth=function(r,v){if(-999!==
this._depth[r]&&this._depth[r]!==v)throw new we("assigned depths do not match",this.getCoordinate());this._depth[r]=v},n.prototype.isInteriorAreaEdge=function(){for(var r=!0,v=0;2>v;v++)this._label.isArea(v)&&this._label.getLocation(v,Aa.LEFT)===ua.INTERIOR&&this._label.getLocation(v,Aa.RIGHT)===ua.INTERIOR||(r=!1);return r},n.prototype.setNextMin=function(r){this._nextMin=r},n.prototype.print=function(r){p.prototype.print.call(this,r);r.print(" "+this._depth[Aa.LEFT]+"/"+this._depth[Aa.RIGHT]);r.print(" ("+
this.getDepthDelta()+")");this._isInResult&&r.print(" inResult")},n.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},n.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),v=!this._label.isArea(0)||this._label.allPositionsEqual(0,ua.EXTERIOR),z=!this._label.isArea(1)||this._label.allPositionsEqual(1,ua.EXTERIOR);return r&&v&&z},n.prototype.setEdgeRing=function(r){this._edgeRing=r},n.prototype.getMinEdgeRing=function(){return this._minEdgeRing},n.prototype.getDepthDelta=
function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},n.prototype.setInResult=function(r){this._isInResult=r},n.prototype.getSym=function(){return this._sym},n.prototype.isForward=function(){return this._isForward},n.prototype.getEdge=function(){return this._edge},n.prototype.printEdge=function(r){this.print(r);r.print(" ");this._isForward?this._edge.print(r):this._edge.printReverse(r)},n.prototype.setSym=function(r){this._sym=r},n.prototype.setVisitedEdge=function(r){this.setVisited(r);
this._sym.setVisited(r)},n.prototype.setEdgeDepths=function(r,v){var z=this.getEdge().getDepthDelta();this._isForward||(z=-z);var t=1;r===Aa.LEFT&&(t=-1);var y=Aa.opposite(r);z=v+z*t;this.setDepth(r,v);this.setDepth(y,z)},n.prototype.getEdgeRing=function(){return this._edgeRing},n.prototype.isInResult=function(){return this._isInResult},n.prototype.setNext=function(r){this._next=r},n.prototype.isVisited=function(){return this._isVisited},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=
function(){return n},n.depthFactor=function(r,v){return r===ua.EXTERIOR&&v===ua.INTERIOR?1:r===ua.INTERIOR&&v===ua.EXTERIOR?-1:0},n}(Bc),bg=function(){};bg.prototype.createNode=function(p){return new hi(p,null)};bg.prototype.interfaces_=function(){return[]};bg.prototype.getClass=function(){return bg};var Yb=function(){(this._edges=new Fa,this._nodes=null,this._edgeEndList=new Fa,0===arguments.length)?this._nodes=new Jd(new bg):1===arguments.length&&(this._nodes=new Jd(arguments[0]))};Yb.prototype.printEdges=
function(p){p.println("Edges:");for(var n=0;n<this._edges.size();n++){p.println("edge "+n+":");var r=this._edges.get(n);r.print(p);r.eiList.print(p)}};Yb.prototype.find=function(p){return this._nodes.find(p)};Yb.prototype.addNode=function(p){if(p instanceof hi||p instanceof sa)return this._nodes.addNode(p)};Yb.prototype.getNodeIterator=function(){return this._nodes.iterator()};Yb.prototype.linkResultDirectedEdges=function(){for(var p=this._nodes.iterator();p.hasNext();)p.next().getEdges().linkResultDirectedEdges()};
Yb.prototype.debugPrintln=function(p){Oc.out.println(p)};Yb.prototype.isBoundaryNode=function(p,n){n=this._nodes.find(n);if(null===n)return!1;n=n.getLabel();return null!==n&&n.getLocation(p)===ua.BOUNDARY};Yb.prototype.linkAllDirectedEdges=function(){for(var p=this._nodes.iterator();p.hasNext();)p.next().getEdges().linkAllDirectedEdges()};Yb.prototype.matchInSameDirection=function(p,n,r,v){return!!p.equals(r)&&Da.computeOrientation(p,n,v)===Da.COLLINEAR&&Mb.quadrant(p,n)===Mb.quadrant(r,v)};Yb.prototype.getEdgeEnds=
function(){return this._edgeEndList};Yb.prototype.debugPrint=function(p){Oc.out.print(p)};Yb.prototype.getEdgeIterator=function(){return this._edges.iterator()};Yb.prototype.findEdgeInSameDirection=function(p,n){for(var r=0;r<this._edges.size();r++){var v=this._edges.get(r),z=v.getCoordinates();if(this.matchInSameDirection(p,n,z[0],z[1])||this.matchInSameDirection(p,n,z[z.length-1],z[z.length-2]))return v}return null};Yb.prototype.insertEdge=function(p){this._edges.add(p)};Yb.prototype.findEdgeEnd=
function(p){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===p)return r}return null};Yb.prototype.addEdges=function(p){for(p=p.iterator();p.hasNext();){var n=p.next();this._edges.add(n);var r=new Mj(n,!0);n=new Mj(n,!1);r.setSym(n);n.setSym(r);this.add(r);this.add(n)}};Yb.prototype.add=function(p){this._nodes.add(p);this._edgeEndList.add(p)};Yb.prototype.getNodes=function(){return this._nodes.values()};Yb.prototype.findEdge=function(p,n){for(var r=0;r<this._edges.size();r++){var v=
this._edges.get(r),z=v.getCoordinates();if(p.equals(z[0])&&n.equals(z[1]))return v}return null};Yb.prototype.interfaces_=function(){return[]};Yb.prototype.getClass=function(){return Yb};Yb.linkResultDirectedEdges=function(p){for(p=p.iterator();p.hasNext();)p.next().getEdges().linkResultDirectedEdges()};var Yc=function(p){this._geometryFactory=null;this._shellList=new Fa;this._geometryFactory=p};Yc.prototype.sortShellsAndHoles=function(p,n,r){for(p=p.iterator();p.hasNext();){var v=p.next();v.isHole()?
r.add(v):n.add(v)}};Yc.prototype.computePolygons=function(p){var n=new Fa;for(p=p.iterator();p.hasNext();){var r=p.next().toPolygon(this._geometryFactory);n.add(r)}return n};Yc.prototype.placeFreeHoles=function(p,n){for(n=n.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var v=this.findEdgeRingContaining(r,p);if(null===v)throw new we("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(v)}}};Yc.prototype.buildMinimalEdgeRings=function(p,n,r){var v=new Fa;for(p=p.iterator();p.hasNext();){var z=
p.next();if(2<z.getMaxNodeDegree()){z.linkDirectedEdgesForMinimalEdgeRings();z=z.buildMinimalRings();var t=this.findShell(z);null!==t?(this.placePolygonHoles(t,z),n.add(t)):r.addAll(z)}else v.add(z)}return v};Yc.prototype.containsPoint=function(p){for(var n=this._shellList.iterator();n.hasNext();)if(n.next().containsPoint(p))return!0;return!1};Yc.prototype.buildMaximalEdgeRings=function(p){var n=new Fa;for(p=p.iterator();p.hasNext();){var r=p.next();r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()&&
(r=new Cp(r,this._geometryFactory),n.add(r),r.setInResult())}return n};Yc.prototype.placePolygonHoles=function(p,n){for(n=n.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(p)}};Yc.prototype.getPolygons=function(){return this.computePolygons(this._shellList)};Yc.prototype.findEdgeRingContaining=function(p,n){var r=p.getLinearRing();p=r.getEnvelopeInternal();r=r.getCoordinateN(0);var v=null,z=null;for(n=n.iterator();n.hasNext();){var t=n.next(),y=t.getLinearRing(),C=y.getEnvelopeInternal();
null!==v&&(z=v.getLinearRing().getEnvelopeInternal());var w=!1;C.contains(p)&&Da.isPointInRing(r,y.getCoordinates())&&(w=!0);w&&(null===v||z.contains(C))&&(v=t)}return v};Yc.prototype.findShell=function(p){var n=0,r=null;for(p=p.iterator();p.hasNext();){var v=p.next();v.isHole()||(r=v,n++)}return Xa.isTrue(1>=n,"found two shells in MinimalEdgeRing list"),r};Yc.prototype.add=function(){if(1===arguments.length){var p=arguments[0];this.add(p.getEdgeEnds(),p.getNodes())}else if(2===arguments.length){p=
arguments[0];Yb.linkResultDirectedEdges(arguments[1]);var n=this.buildMaximalEdgeRings(p);p=new Fa;n=this.buildMinimalEdgeRings(n,this._shellList,p);this.sortShellsAndHoles(n,this._shellList,p);this.placeFreeHoles(this._shellList,p)}};Yc.prototype.interfaces_=function(){return[]};Yc.prototype.getClass=function(){return Yc};var cg=function(){};cg.prototype.getBounds=function(){};cg.prototype.interfaces_=function(){return[]};cg.prototype.getClass=function(){return cg};var vd=function(p,n){this._bounds=
p;this._item=n};vd.prototype.getItem=function(){return this._item};vd.prototype.getBounds=function(){return this._bounds};vd.prototype.interfaces_=function(){return[cg,id]};vd.prototype.getClass=function(){return vd};var xe=function(){this._items=null;this._size=0;this._items=new Fa;this._items.add(null)};xe.prototype.poll=function(){if(this.isEmpty())return null;var p=this._items.get(1);return this._items.set(1,this._items.get(this._size)),--this._size,this.reorder(1),p};xe.prototype.size=function(){return this._size};
xe.prototype.reorder=function(p){for(var n=null,r=this._items.get(p);2*p<=this._size&&((n=2*p)!==this._size&&0>this._items.get(n+1).compareTo(this._items.get(n))&&n++,0>this._items.get(n).compareTo(r));p=n)this._items.set(p,this._items.get(n));this._items.set(p,r)};xe.prototype.clear=function(){this._size=0;this._items.clear()};xe.prototype.isEmpty=function(){return 0===this._size};xe.prototype.add=function(p){this._items.add(null);var n=this._size+=1;for(this._items.set(0,p);0>p.compareTo(this._items.get(Math.trunc(n/
2)));n/=2)this._items.set(n,this._items.get(Math.trunc(n/2)));this._items.set(n,p)};xe.prototype.interfaces_=function(){return[]};xe.prototype.getClass=function(){return xe};var Ge=function(){};Ge.prototype.visitItem=function(p){};Ge.prototype.interfaces_=function(){return[]};Ge.prototype.getClass=function(){return Ge};var tf=function(){};tf.prototype.insert=function(p,n){};tf.prototype.remove=function(p,n){};tf.prototype.query=function(){};tf.prototype.interfaces_=function(){return[]};tf.prototype.getClass=
function(){return tf};var oc=function(){(this._childBoundables=new Fa,this._bounds=null,this._level=null,0!==arguments.length)&&1===arguments.length&&(this._level=arguments[0])},nn={serialVersionUID:{configurable:!0}};oc.prototype.getLevel=function(){return this._level};oc.prototype.size=function(){return this._childBoundables.size()};oc.prototype.getChildBoundables=function(){return this._childBoundables};oc.prototype.addChildBoundable=function(p){Xa.isTrue(null===this._bounds);this._childBoundables.add(p)};
oc.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};oc.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds};oc.prototype.interfaces_=function(){return[cg,id]};oc.prototype.getClass=function(){return oc};nn.serialVersionUID.get=function(){return 0x5a1e55ec41369800};Object.defineProperties(oc,nn);var Kd=function(){};Kd.reverseOrder=function(){return{compare:function(p,n){return n.compareTo(p)}}};Kd.min=function(p){return Kd.sort(p),
p.get(0)};Kd.sort=function(p,n){var r=p.toArray();n?Ue.sort(r,n):Ue.sort(r);p=p.iterator();n=0;for(var v=r.length;n<v;n++)p.next(),p.set(r[n])};Kd.singletonList=function(p){var n=new Fa;return n.add(p),n};var jc=function(p,n,r){this._distance=null;this._boundable1=p;this._boundable2=n;this._itemDistance=r;this._distance=this.distance()};jc.prototype.expandToQueue=function(p,n){var r=jc.isComposite(this._boundable1),v=jc.isComposite(this._boundable2);if(r&&v)return jc.area(this._boundable1)>jc.area(this._boundable2)?
(this.expand(this._boundable1,this._boundable2,p,n),null):(this.expand(this._boundable2,this._boundable1,p,n),null);if(r)return this.expand(this._boundable1,this._boundable2,p,n),null;if(v)return this.expand(this._boundable2,this._boundable1,p,n),null;throw new ac("neither boundable is composite");};jc.prototype.isLeaves=function(){return!(jc.isComposite(this._boundable1)||jc.isComposite(this._boundable2))};jc.prototype.compareTo=function(p){return this._distance<p._distance?-1:this._distance>p._distance?
1:0};jc.prototype.expand=function(p,n,r,v){for(p=p.getChildBoundables().iterator();p.hasNext();){var z=p.next();z=new jc(z,n,this._itemDistance);z.getDistance()<v&&r.add(z)}};jc.prototype.getBoundable=function(p){return 0===p?this._boundable1:this._boundable2};jc.prototype.getDistance=function(){return this._distance};jc.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};
jc.prototype.interfaces_=function(){return[jd]};jc.prototype.getClass=function(){return jc};jc.area=function(p){return p.getBounds().getArea()};jc.isComposite=function(p){return p instanceof oc};var rc=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new Fa,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=n.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var r=arguments[0];Xa.isTrue(1<r,"Node capacity must be greater than 1");this._nodeCapacity=r}},ii={IntersectsOp:{configurable:!0},
serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};rc.prototype.getNodeCapacity=function(){return this._nodeCapacity};rc.prototype.lastNode=function(n){return n.get(n.size()-1)};rc.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var n=0,r=arguments[0].getChildBoundables().iterator();r.hasNext();){var v=r.next();v instanceof oc?n+=this.size(v):v instanceof vd&&(n+=1)}return n}};rc.prototype.removeItem=
function(n,r){for(var v=null,z=n.getChildBoundables().iterator();z.hasNext();){var t=z.next();t instanceof vd&&t.getItem()===r&&(v=t)}return null!==v&&(n.getChildBoundables().remove(v),!0)};rc.prototype.itemsTree=function(){if(0===arguments.length){this.build();var n=this.itemsTree(this._root);return null===n?new Fa:n}if(1===arguments.length){var r=arguments[0];n=new Fa;for(r=r.getChildBoundables().iterator();r.hasNext();){var v=r.next();v instanceof oc?(v=this.itemsTree(v),null!==v&&n.add(v)):v instanceof
vd?n.add(v.getItem()):Xa.shouldNeverReachHere()}return 0>=n.size()?null:n}};rc.prototype.insert=function(n,r){Xa.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built.");this._itemBoundables.add(new vd(n,r))};rc.prototype.boundablesAtLevel=function(){if(1===arguments.length){var n=arguments[0],r=new Fa;return this.boundablesAtLevel(n,this._root,r),r}if(3===arguments.length){n=arguments[0];var v=arguments[1];r=arguments[2];if(Xa.isTrue(-2<n),v.getLevel()===n)return r.add(v),
null;for(v=v.getChildBoundables().iterator();v.hasNext();){var z=v.next();z instanceof oc?this.boundablesAtLevel(n,z,r):(Xa.isTrue(z instanceof vd),-1===n&&r.add(z))}return null}};rc.prototype.query=function(){if(1===arguments.length){var n=arguments[0];this.build();var r=new Fa;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}if(2===arguments.length){n=arguments[0];r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),
n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(Va(arguments[2],Ge)&&arguments[0]instanceof Object&&arguments[1]instanceof oc){n=arguments[0];r=arguments[2];for(var v=arguments[1].getChildBoundables(),z=0;z<v.size();z++){var t=v.get(z);this.getIntersectsOp().intersects(t.getBounds(),n)&&(t instanceof oc?this.query(n,t,r):t instanceof vd?r.visitItem(t.getItem()):Xa.shouldNeverReachHere())}}else if(Va(arguments[2],ue)&&arguments[0]instanceof Object&&arguments[1]instanceof oc)for(n=arguments[0],
r=arguments[2],v=arguments[1].getChildBoundables(),z=0;z<v.size();z++)t=v.get(z),this.getIntersectsOp().intersects(t.getBounds(),n)&&(t instanceof oc?this.query(n,t,r):t instanceof vd?r.add(t.getItem()):Xa.shouldNeverReachHere())};rc.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1);this._itemBoundables=null;this._built=!0};rc.prototype.getRoot=function(){return this.build(),this._root};
rc.prototype.remove=function(){if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.remove(n,this._root,r)}if(3===arguments.length){n=arguments[0];r=arguments[1];var v=arguments[2],z=this.removeItem(r,v);if(z)return!0;for(var t=null,y=r.getChildBoundables().iterator();y.hasNext();){var C=y.next();if(this.getIntersectsOp().intersects(C.getBounds(),n)&&C instanceof oc&&(z=this.remove(n,C,v))){t=C;break}}return null!==
t&&t.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(t),z}};rc.prototype.createHigherLevels=function(n,r){Xa.isTrue(!n.isEmpty());n=this.createParentBoundables(n,r+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,r+1)};rc.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var n=0,r=arguments[0].getChildBoundables().iterator();r.hasNext();){var v=r.next();v instanceof oc&&(v=this.depth(v),
v>n&&(n=v))}return n+1}};rc.prototype.createParentBoundables=function(n,r){Xa.isTrue(!n.isEmpty());var v=new Fa;v.add(this.createNode(r));n=new Fa(n);Kd.sort(n,this.getComparator());for(n=n.iterator();n.hasNext();){var z=n.next();this.lastNode(v).getChildBoundables().size()===this.getNodeCapacity()&&v.add(this.createNode(r));this.lastNode(v).addChildBoundable(z)}return v};rc.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};rc.prototype.interfaces_=
function(){return[id]};rc.prototype.getClass=function(){return rc};rc.compareDoubles=function(n,r){return n>r?1:n<r?-1:0};ii.IntersectsOp.get=function(){return Dp};ii.serialVersionUID.get=function(){return-0x35ef64c82d4c5400};ii.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(rc,ii);var Dp=function(){},dg=function(){};dg.prototype.distance=function(n,r){};dg.prototype.interfaces_=function(){return[]};dg.prototype.getClass=function(){return dg};var Ep=function(n){function r(z){z=
z||r.DEFAULT_NODE_CAPACITY;n.call(this,z)}n&&(r.__proto__=n);r.prototype=Object.create(n&&n.prototype);r.prototype.constructor=r;var v={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return r.prototype.createParentBoundablesFromVerticalSlices=function(z,t){Xa.isTrue(0<z.length);for(var y=new Fa,C=0;C<z.length;C++)y.addAll(this.createParentBoundablesFromVerticalSlice(z[C],
t));return y},r.prototype.createNode=function(z){return new on(z)},r.prototype.size=function(){return 0===arguments.length?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},r.prototype.insert=function(){if(2!==arguments.length)return n.prototype.insert.apply(this,arguments);var z=arguments[0],t=arguments[1];if(z.isNull())return null;n.prototype.insert.call(this,z,t)},r.prototype.getIntersectsOp=function(){return r.intersectsOp},r.prototype.verticalSlices=function(z,t){var y=Math.trunc(Math.ceil(z.size()/
t)),C=Array(t).fill(null);z=z.iterator();for(var w=0;w<t;w++){C[w]=new Fa;for(var x=0;z.hasNext()&&x<y;){var A=z.next();C[w].add(A);x++}}return C},r.prototype.query=function(){if(1===arguments.length)return n.prototype.query.call(this,arguments[0]);2===arguments.length?n.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Va(arguments[2],Ge)&&arguments[0]instanceof Object&&arguments[1]instanceof oc?n.prototype.query.call(this,arguments[0],arguments[1],arguments[2]):Va(arguments[2],
ue)&&arguments[0]instanceof Object&&arguments[1]instanceof oc&&n.prototype.query.call(this,arguments[0],arguments[1],arguments[2]))},r.prototype.getComparator=function(){return r.yComparator},r.prototype.createParentBoundablesFromVerticalSlice=function(z,t){return n.prototype.createParentBoundables.call(this,z,t)},r.prototype.remove=function(){return 2===arguments.length?n.prototype.remove.call(this,arguments[0],arguments[1]):n.prototype.remove.apply(this,arguments)},r.prototype.depth=function(){return 0===
arguments.length?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},r.prototype.createParentBoundables=function(z,t){Xa.isTrue(!z.isEmpty());var y=Math.trunc(Math.ceil(z.size()/this.getNodeCapacity()));z=new Fa(z);Kd.sort(z,r.xComparator);y=this.verticalSlices(z,Math.trunc(Math.ceil(Math.sqrt(y))));return this.createParentBoundablesFromVerticalSlices(y,t)},r.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Va(arguments[0],dg)){var z=arguments[0];z=new jc(this.getRoot(),
this.getRoot(),z);return this.nearestNeighbour(z)}if(arguments[0]instanceof jc)return this.nearestNeighbour(arguments[0],Wa.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof r&&Va(arguments[1],dg)){z=arguments[0];var t=arguments[1];z=new jc(this.getRoot(),z.getRoot(),t);return this.nearestNeighbour(z)}if(arguments[0]instanceof jc&&"number"==typeof arguments[1]){var y=arguments[0];z=arguments[1];t=null;var C=new xe;for(C.add(y);!C.isEmpty()&&0<z;){y=C.poll();var w=y.getDistance();
if(w>=z)break;y.isLeaves()?(z=w,t=y):y.expandToQueue(C,z)}return[t.getBoundable(0).getItem(),t.getBoundable(1).getItem()]}}else if(3===arguments.length)return z=arguments[2],t=new vd(arguments[0],arguments[1]),z=new jc(this.getRoot(),t,z),this.nearestNeighbour(z)[0]},r.prototype.interfaces_=function(){return[tf,id]},r.prototype.getClass=function(){return r},r.centreX=function(z){return r.avg(z.getMinX(),z.getMaxX())},r.avg=function(z,t){return(z+t)/2},r.centreY=function(z){return r.avg(z.getMinY(),
z.getMaxY())},v.STRtreeNode.get=function(){return on},v.serialVersionUID.get=function(){return 0x39920f7d5f261e0},v.xComparator.get=function(){return{interfaces_:function(){return[Rf]},compare:function(z,t){return n.compareDoubles(r.centreX(z.getBounds()),r.centreX(t.getBounds()))}}},v.yComparator.get=function(){return{interfaces_:function(){return[Rf]},compare:function(z,t){return n.compareDoubles(r.centreY(z.getBounds()),r.centreY(t.getBounds()))}}},v.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},
intersects:function(z,t){return z.intersects(t)}}},v.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(r,v),r}(rc),on=function(n){function r(v){n.call(this,v)}return n&&(r.__proto__=n),r.prototype=Object.create(n&&n.prototype),r.prototype.constructor=r,r.prototype.computeBounds=function(){for(var v=null,z=this.getChildBoundables().iterator();z.hasNext();){var t=z.next();null===v?v=new Ia(t.getBounds()):v.expandToInclude(t.getBounds())}return v},r.prototype.interfaces_=function(){return[]},
r.prototype.getClass=function(){return r},r}(oc),Pc=function(){};Pc.prototype.interfaces_=function(){return[]};Pc.prototype.getClass=function(){return Pc};Pc.relativeSign=function(n,r){return n<r?-1:n>r?1:0};Pc.compare=function(n,r,v){if(r.equals2D(v))return 0;var z=Pc.relativeSign(r.x,v.x);r=Pc.relativeSign(r.y,v.y);switch(n){case 0:return Pc.compareValue(z,r);case 1:return Pc.compareValue(r,z);case 2:return Pc.compareValue(r,-z);case 3:return Pc.compareValue(-z,r);case 4:return Pc.compareValue(-z,
-r);case 5:return Pc.compareValue(-r,-z);case 6:return Pc.compareValue(-r,z);case 7:return Pc.compareValue(z,-r)}return Xa.shouldNeverReachHere("invalid octant value"),0};Pc.compareValue=function(n,r){return 0>n?-1:0<n?1:0>r?-1:0<r?1:0};var He=function(n,r,v,z){this._isInterior=this._segmentOctant=this.segmentIndex=this.coord=null;this._segString=n;this.coord=new sa(r);this.segmentIndex=v;this._segmentOctant=z;this._isInterior=!r.equals2D(n.getCoordinate(v))};He.prototype.getCoordinate=function(){return this.coord};
He.prototype.print=function(n){n.print(this.coord);n.print(" seg # = "+this.segmentIndex)};He.prototype.compareTo=function(n){return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Pc.compare(this._segmentOctant,this.coord,n.coord)};He.prototype.isEndPoint=function(n){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===n};He.prototype.isInterior=function(){return this._isInterior};He.prototype.interfaces_=function(){return[jd]};
He.prototype.getClass=function(){return He};var Jc=function(n){this._nodeMap=new Ac;this._edge=n};Jc.prototype.getSplitCoordinates=function(){var n=new Tg;this.addEndpoints();for(var r=this.iterator(),v=r.next();r.hasNext();){var z=r.next();this.addEdgeCoordinates(v,z,n);v=z}return n.toCoordinateArray()};Jc.prototype.addCollapsedNodes=function(){var n=new Fa;this.findCollapsesFromInsertedNodes(n);this.findCollapsesFromExistingVertices(n);for(n=n.iterator();n.hasNext();){var r=n.next().intValue();
this.add(this._edge.getCoordinate(r),r)}};Jc.prototype.print=function(n){n.println("Intersections:");for(var r=this.iterator();r.hasNext();)r.next().print(n)};Jc.prototype.findCollapsesFromExistingVertices=function(n){for(var r=0;r<this._edge.size()-2;r++){var v=this._edge.getCoordinate(r),z=this._edge.getCoordinate(r+2);v.equals2D(z)&&n.add(new Dd(r+1))}};Jc.prototype.addEdgeCoordinates=function(n,r,v){var z=this._edge.getCoordinate(r.segmentIndex);z=r.isInterior()||!r.coord.equals2D(z);v.add(new sa(n.coord),
!1);for(n=n.segmentIndex+1;n<=r.segmentIndex;n++)v.add(this._edge.getCoordinate(n));z&&v.add(new sa(r.coord))};Jc.prototype.iterator=function(){return this._nodeMap.values().iterator()};Jc.prototype.addSplitEdges=function(n){this.addEndpoints();this.addCollapsedNodes();for(var r=this.iterator(),v=r.next();r.hasNext();){var z=r.next();v=this.createSplitEdge(v,z);n.add(v);v=z}};Jc.prototype.findCollapseIndex=function(n,r,v){if(!n.coord.equals2D(r.coord))return!1;var z=r.segmentIndex-n.segmentIndex;
return r.isInterior()||z--,1===z&&(v[0]=n.segmentIndex+1,!0)};Jc.prototype.findCollapsesFromInsertedNodes=function(n){for(var r=Array(1).fill(null),v=this.iterator(),z=v.next();v.hasNext();){var t=v.next();this.findCollapseIndex(z,t,r)&&n.add(new Dd(r[0]));z=t}};Jc.prototype.getEdge=function(){return this._edge};Jc.prototype.addEndpoints=function(){var n=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0);this.add(this._edge.getCoordinate(n),n)};Jc.prototype.createSplitEdge=function(n,r){var v=
r.segmentIndex-n.segmentIndex+2,z=this._edge.getCoordinate(r.segmentIndex);(z=r.isInterior()||!r.coord.equals2D(z))||v--;v=Array(v).fill(null);var t=0;v[t++]=new sa(n.coord);for(n=n.segmentIndex+1;n<=r.segmentIndex;n++)v[t++]=this._edge.getCoordinate(n);return z&&(v[t]=new sa(r.coord)),new ec(v,this._edge.getData())};Jc.prototype.add=function(n,r){r=new He(this._edge,n,r,this._edge.getSegmentOctant(r));var v=this._nodeMap.get(r);return null!==v?(Xa.isTrue(v.coord.equals2D(n),"Found equal nodes with different coordinates"),
v):(this._nodeMap.put(r,r),r)};Jc.prototype.checkSplitEdgesCorrectness=function(n){var r=this._edge.getCoordinates(),v=n.get(0).getCoordinate(0);if(!v.equals2D(r[0]))throw new re("bad split edge start point at "+v);n=n.get(n.size()-1).getCoordinates();n=n[n.length-1];if(!n.equals2D(r[r.length-1]))throw new re("bad split edge end point at "+n);};Jc.prototype.interfaces_=function(){return[]};Jc.prototype.getClass=function(){return Jc};var uf=function(){};uf.prototype.interfaces_=function(){return[]};
uf.prototype.getClass=function(){return uf};uf.octant=function(n,r){if("number"==typeof n&&"number"==typeof r){if(0===n&&0===r)throw new ac("Cannot compute the octant for point ( "+n+", "+r+" )");var v=Math.abs(n),z=Math.abs(r);return 0<=n?0<=r?v>=z?0:1:v>=z?7:6:0<=r?v>=z?3:2:v>=z?4:5}if(n instanceof sa&&r instanceof sa){v=r.x-n.x;r=r.y-n.y;if(0===v&&0===r)throw new ac("Cannot compute the octant for two identical points "+n);return uf.octant(v,r)}};var $d=function(){};$d.prototype.getCoordinates=
function(){};$d.prototype.size=function(){};$d.prototype.getCoordinate=function(n){};$d.prototype.isClosed=function(){};$d.prototype.setData=function(n){};$d.prototype.getData=function(){};$d.prototype.interfaces_=function(){return[]};$d.prototype.getClass=function(){return $d};var ah=function(){};ah.prototype.addIntersection=function(n,r){};ah.prototype.interfaces_=function(){return[$d]};ah.prototype.getClass=function(){return ah};var ec=function(n,r){this._nodeList=new Jc(this);this._pts=n;this._data=
r};ec.prototype.getCoordinates=function(){return this._pts};ec.prototype.size=function(){return this._pts.length};ec.prototype.getCoordinate=function(n){return this._pts[n]};ec.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};ec.prototype.getSegmentOctant=function(n){return n===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(n),this.getCoordinate(n+1))};ec.prototype.setData=function(n){this._data=n};ec.prototype.safeOctant=function(n,r){return n.equals2D(r)?
0:uf.octant(n,r)};ec.prototype.getData=function(){return this._data};ec.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var n=arguments[1],r=new sa(arguments[0].getIntersection(arguments[3]));this.addIntersection(r,n)}};ec.prototype.toString=function(){return qe.toLineString(new hc(this._pts))};ec.prototype.getNodeList=function(){return this._nodeList};ec.prototype.addIntersectionNode=function(n,r){var v=
r+1;v<this._pts.length&&n.equals2D(this._pts[v])&&(r=v);return this._nodeList.add(n,r)};ec.prototype.addIntersections=function(n,r,v){for(var z=0;z<n.getIntersectionNum();z++)this.addIntersection(n,r,v,z)};ec.prototype.interfaces_=function(){return[ah]};ec.prototype.getClass=function(){return ec};ec.getNodedSubstrings=function(){if(1===arguments.length){var n=arguments[0],r=new Fa;return ec.getNodedSubstrings(n,r),r}if(2===arguments.length)for(n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)};
var Na=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new sa,this.p1=new sa;else if(1===arguments.length){var n=arguments[0];this.p0=new sa(n.p0);this.p1=new sa(n.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){n=arguments[2];var r=arguments[3];this.p0=new sa(arguments[0],arguments[1]);this.p1=new sa(n,r)}},pn={serialVersionUID:{configurable:!0}};Na.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};Na.prototype.orientationIndex=
function(n){if(n instanceof Na){var r=Da.orientationIndex(this.p0,this.p1,n.p0);n=Da.orientationIndex(this.p0,this.p1,n.p1);return 0<=r&&0<=n||0>=r&&0>=n?Math.max(r,n):0}if(n instanceof sa)return Da.orientationIndex(this.p0,this.p1,n)};Na.prototype.toGeometry=function(n){return n.createLineString([this.p0,this.p1])};Na.prototype.isVertical=function(){return this.p0.x===this.p1.x};Na.prototype.equals=function(n){return n instanceof Na?this.p0.equals(n.p0)&&this.p1.equals(n.p1):!1};Na.prototype.intersection=
function(n){var r=new Te;return r.computeIntersection(this.p0,this.p1,n.p0,n.p1),r.hasIntersection()?r.getIntersection(0):null};Na.prototype.project=function(n){if(n instanceof sa){if(n.equals(this.p0)||n.equals(this.p1))return new sa(n);var r=this.projectionFactor(n),v=new sa;return v.x=this.p0.x+r*(this.p1.x-this.p0.x),v.y=this.p0.y+r*(this.p1.y-this.p0.y),v}if(n instanceof Na){var z=this.projectionFactor(n.p0);r=this.projectionFactor(n.p1);if(1<=z&&1<=r||0>=z&&0>=r)return null;v=this.project(n.p0);
0>z&&(v=this.p0);1<z&&(v=this.p1);n=this.project(n.p1);return 0>r&&(n=this.p0),1<r&&(n=this.p1),new Na(v,n)}};Na.prototype.normalize=function(){0>this.p1.compareTo(this.p0)&&this.reverse()};Na.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};Na.prototype.getCoordinate=function(n){return 0===n?this.p0:this.p1};Na.prototype.distancePerpendicular=function(n){return Da.distancePointLinePerpendicular(n,this.p0,this.p1)};Na.prototype.minY=function(){return Math.min(this.p0.y,
this.p1.y)};Na.prototype.midPoint=function(){return Na.midPoint(this.p0,this.p1)};Na.prototype.projectionFactor=function(n){if(n.equals(this.p0))return 0;if(n.equals(this.p1))return 1;var r=this.p1.x-this.p0.x,v=this.p1.y-this.p0.y,z=r*r+v*v;return 0>=z?Wa.NaN:((n.x-this.p0.x)*r+(n.y-this.p0.y)*v)/z};Na.prototype.closestPoints=function(n){var r=this.intersection(n);if(null!==r)return[r,r];r=Array(2).fill(null);var v=null,z=this.closestPoint(n.p0);var t=z.distance(n.p0);r[0]=z;r[1]=n.p0;z=this.closestPoint(n.p1);
(v=z.distance(n.p1))<t&&(t=v,r[0]=z,r[1]=n.p1);z=n.closestPoint(this.p0);(v=z.distance(this.p0))<t&&(t=v,r[0]=this.p0,r[1]=z);n=n.closestPoint(this.p1);return n.distance(this.p1)<t&&(r[0]=this.p1,r[1]=n),r};Na.prototype.closestPoint=function(n){var r=this.projectionFactor(n);return 0<r&&1>r?this.project(n):this.p0.distance(n)<this.p1.distance(n)?this.p0:this.p1};Na.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};Na.prototype.getLength=function(){return this.p0.distance(this.p1)};Na.prototype.compareTo=
function(n){var r=this.p0.compareTo(n.p0);return 0!==r?r:this.p1.compareTo(n.p1)};Na.prototype.reverse=function(){var n=this.p0;this.p0=this.p1;this.p1=n};Na.prototype.equalsTopo=function(n){return this.p0.equals(n.p0)&&(this.p1.equals(n.p1)||this.p0.equals(n.p1))&&this.p1.equals(n.p0)};Na.prototype.lineIntersection=function(n){try{return sd.intersection(this.p0,this.p1,n.p0,n.p1)}catch(r){if(!(r instanceof Tf))throw r;}return null};Na.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};
Na.prototype.pointAlongOffset=function(n,r){var v=this.p0.x+n*(this.p1.x-this.p0.x);n=this.p0.y+n*(this.p1.y-this.p0.y);var z=this.p1.x-this.p0.x,t=this.p1.y-this.p0.y,y=Math.sqrt(z*z+t*t),C=0,w=0;if(0!==r){if(0>=y)throw Error("Cannot compute offset from zero-length line segment");C=r*z/y;w=r*t/y}return new sa(v-w,n+C)};Na.prototype.setCoordinates=function(){if(1===arguments.length){var n=arguments[0];this.setCoordinates(n.p0,n.p1)}else if(2===arguments.length){n=arguments[0];var r=arguments[1];this.p0.x=
n.x;this.p0.y=n.y;this.p1.x=r.x;this.p1.y=r.y}};Na.prototype.segmentFraction=function(n){n=this.projectionFactor(n);return 0>n?n=0:(1<n||Wa.isNaN(n))&&(n=1),n};Na.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};Na.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};Na.prototype.distance=function(n){if(n instanceof Na)return Da.distanceLineLine(this.p0,this.p1,n.p0,n.p1);if(n instanceof sa)return Da.distancePointLine(n,this.p0,
this.p1)};Na.prototype.pointAlong=function(n){var r=new sa;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r};Na.prototype.hashCode=function(){var n=Wa.doubleToLongBits(this.p0.x);n^=31*Wa.doubleToLongBits(this.p0.y);n=Math.trunc(n)^Math.trunc(n>>32);var r=Wa.doubleToLongBits(this.p1.x);return r^=31*Wa.doubleToLongBits(this.p1.y),n^Math.trunc(r)^Math.trunc(r>>32)};Na.prototype.interfaces_=function(){return[jd,id]};Na.prototype.getClass=function(){return Na};Na.midPoint=
function(n,r){return new sa((n.x+r.x)/2,(n.y+r.y)/2)};pn.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(Na,pn);var bh=function(){this.tempEnv1=new Ia;this.tempEnv2=new Ia;this._overlapSeg1=new Na;this._overlapSeg2=new Na};bh.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var n=arguments[2],r=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1);n.getLineSegment(r,this._overlapSeg2);this.overlap(this._overlapSeg1,this._overlapSeg2)}};
bh.prototype.interfaces_=function(){return[]};bh.prototype.getClass=function(){return bh};var Zc=function(n,r,v,z){this._id=this._env=null;this._pts=n;this._start=r;this._end=v;this._context=z};Zc.prototype.getLineSegment=function(n,r){r.p0=this._pts[n];r.p1=this._pts[n+1]};Zc.prototype.computeSelect=function(n,r,v,z){if(z.tempEnv1.init(this._pts[r],this._pts[v]),1==v-r)return z.select(this,r),null;if(!n.intersects(z.tempEnv1))return null;var t=Math.trunc((r+v)/2);r<t&&this.computeSelect(n,r,t,z);
t<v&&this.computeSelect(n,t,v,z)};Zc.prototype.getCoordinates=function(){for(var n=Array(this._end-this._start+1).fill(null),r=0,v=this._start;v<=this._end;v++)n[r++]=this._pts[v];return n};Zc.prototype.computeOverlaps=function(n,r){this.computeOverlapsInternal(this._start,this._end,n,n._start,n._end,r)};Zc.prototype.setId=function(n){this._id=n};Zc.prototype.select=function(n,r){this.computeSelect(n,this._start,this._end,r)};Zc.prototype.getEnvelope=function(){null===this._env&&(this._env=new Ia(this._pts[this._start],
this._pts[this._end]));return this._env};Zc.prototype.getEndIndex=function(){return this._end};Zc.prototype.getStartIndex=function(){return this._start};Zc.prototype.getContext=function(){return this._context};Zc.prototype.getId=function(){return this._id};Zc.prototype.computeOverlapsInternal=function(n,r,v,z,t,y){var C=this._pts[n],w=this._pts[r],x=v._pts[z],A=v._pts[t];if(1==r-n&&1==t-z)return y.overlap(this,n,v,z),null;if(y.tempEnv1.init(C,w),y.tempEnv2.init(x,A),!y.tempEnv1.intersects(y.tempEnv2))return null;
C=Math.trunc((n+r)/2);w=Math.trunc((z+t)/2);n<C&&(z<w&&this.computeOverlapsInternal(n,C,v,z,w,y),w<t&&this.computeOverlapsInternal(n,C,v,w,t,y));C<r&&(z<w&&this.computeOverlapsInternal(C,r,v,z,w,y),w<t&&this.computeOverlapsInternal(C,r,v,w,t,y))};Zc.prototype.interfaces_=function(){return[]};Zc.prototype.getClass=function(){return Zc};var Ld=function(){};Ld.prototype.interfaces_=function(){return[]};Ld.prototype.getClass=function(){return Ld};Ld.getChainStartIndices=function(n){var r=0,v=new Fa;v.add(new Dd(r));
do r=Ld.findChainEnd(n,r),v.add(new Dd(r));while(r<n.length-1);return Ld.toIntArray(v)};Ld.findChainEnd=function(n,r){for(var v=r;v<n.length-1&&n[v].equals2D(n[v+1]);)v++;if(v>=n.length-1)return n.length-1;v=Mb.quadrant(n[v],n[v+1]);for(r+=1;r<n.length&&(n[r-1].equals2D(n[r])||Mb.quadrant(n[r-1],n[r])===v);)r++;return r-1};Ld.getChains=function(){if(1===arguments.length)return Ld.getChains(arguments[0],null);if(2===arguments.length){for(var n=arguments[0],r=arguments[1],v=new Fa,z=Ld.getChainStartIndices(n),
t=0;t<z.length-1;t++){var y=new Zc(n,z[t],z[t+1],r);v.add(y)}return v}};Ld.toIntArray=function(n){for(var r=Array(n.size()).fill(null),v=0;v<r.length;v++)r[v]=n.get(v).intValue();return r};var Ye=function(){};Ye.prototype.computeNodes=function(n){};Ye.prototype.getNodedSubstrings=function(){};Ye.prototype.interfaces_=function(){return[]};Ye.prototype.getClass=function(){return Ye};var ch=function(){(this._segInt=null,0!==arguments.length)&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};
ch.prototype.setSegmentIntersector=function(n){this._segInt=n};ch.prototype.interfaces_=function(){return[Ye]};ch.prototype.getClass=function(){return ch};var Nj=function(n){function r(z){z?n.call(this,z):n.call(this);this._monoChains=new Fa;this._index=new Ep;this._idCounter=0;this._nodedSegStrings=null;this._nOverlaps=0}n&&(r.__proto__=n);r.prototype=Object.create(n&&n.prototype);r.prototype.constructor=r;var v={SegmentOverlapAction:{configurable:!0}};return r.prototype.getMonotoneChains=function(){return this._monoChains},
r.prototype.getNodedSubstrings=function(){return ec.getNodedSubstrings(this._nodedSegStrings)},r.prototype.getIndex=function(){return this._index},r.prototype.add=function(z){for(z=Ld.getChains(z.getCoordinates(),z).iterator();z.hasNext();){var t=z.next();t.setId(this._idCounter++);this._index.insert(t.getEnvelope(),t);this._monoChains.add(t)}},r.prototype.computeNodes=function(z){this._nodedSegStrings=z;for(z=z.iterator();z.hasNext();)this.add(z.next());this.intersectChains()},r.prototype.intersectChains=
function(){for(var z=new qn(this._segInt),t=this._monoChains.iterator();t.hasNext();)for(var y=t.next(),C=this._index.query(y.getEnvelope()).iterator();C.hasNext();){var w=C.next();if(w.getId()>y.getId()&&(y.computeOverlaps(w,z),this._nOverlaps++),this._segInt.isDone())return null}},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},v.SegmentOverlapAction.get=function(){return qn},Object.defineProperties(r,v),r}(ch),qn=function(n){function r(v){n.call(this);this._si=
v}return n&&(r.__proto__=n),r.prototype=Object.create(n&&n.prototype),r.prototype.constructor=r,r.prototype.overlap=function(){if(4!==arguments.length)return n.prototype.overlap.apply(this,arguments);var v=arguments[1],z=arguments[2],t=arguments[3],y=arguments[0].getContext();z=z.getContext();this._si.processIntersections(y,v,z,t)},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},r}(bh),Gb=function r(){if(this._quadrantSegments=r.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=
r.CAP_ROUND,this._joinStyle=r.JOIN_ROUND,this._mitreLimit=r.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=r.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var v=arguments[1];this.setQuadrantSegments(arguments[0]);this.setEndCapStyle(v)}else if(4===arguments.length){v=arguments[1];var z=arguments[2],t=arguments[3];this.setQuadrantSegments(arguments[0]);this.setEndCapStyle(v);this.setJoinStyle(z);
this.setMitreLimit(t)}},ye={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Gb.prototype.getEndCapStyle=function(){return this._endCapStyle};Gb.prototype.isSingleSided=function(){return this._isSingleSided};Gb.prototype.setQuadrantSegments=function(r){this._quadrantSegments=
r;0===this._quadrantSegments&&(this._joinStyle=Gb.JOIN_BEVEL);0>this._quadrantSegments&&(this._joinStyle=Gb.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments));0>=r&&(this._quadrantSegments=1);this._joinStyle!==Gb.JOIN_ROUND&&(this._quadrantSegments=Gb.DEFAULT_QUADRANT_SEGMENTS)};Gb.prototype.getJoinStyle=function(){return this._joinStyle};Gb.prototype.setJoinStyle=function(r){this._joinStyle=r};Gb.prototype.setSimplifyFactor=function(r){this._simplifyFactor=0>r?0:r};Gb.prototype.getSimplifyFactor=
function(){return this._simplifyFactor};Gb.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Gb.prototype.setEndCapStyle=function(r){this._endCapStyle=r};Gb.prototype.getMitreLimit=function(){return this._mitreLimit};Gb.prototype.setMitreLimit=function(r){this._mitreLimit=r};Gb.prototype.setSingleSided=function(r){this._isSingleSided=r};Gb.prototype.interfaces_=function(){return[]};Gb.prototype.getClass=function(){return Gb};Gb.bufferDistanceError=function(r){return 1-Math.cos(Math.PI/
2/r/2)};ye.CAP_ROUND.get=function(){return 1};ye.CAP_FLAT.get=function(){return 2};ye.CAP_SQUARE.get=function(){return 3};ye.JOIN_ROUND.get=function(){return 1};ye.JOIN_MITRE.get=function(){return 2};ye.JOIN_BEVEL.get=function(){return 3};ye.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};ye.DEFAULT_MITRE_LIMIT.get=function(){return 5};ye.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01};Object.defineProperties(Gb,ye);var bc=function(r){this._isDeleted=this._distanceTol=null;this._angleOrientation=
Da.COUNTERCLOCKWISE;this._inputLine=r||null},dh={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};bc.prototype.isDeletable=function(r,v,z,t){var y=this._inputLine[r];v=this._inputLine[v];var C=this._inputLine[z];return!!this.isConcave(y,v,C)&&!!this.isShallow(y,v,C,t)&&this.isShallowSampled(y,v,r,z,t)};bc.prototype.deleteShallowConcavities=function(){for(var r=1,v=this.findNextNonDeletedIndex(r),z=this.findNextNonDeletedIndex(v),t=!1;z<this._inputLine.length;){var y=
!1;this.isDeletable(r,v,z,this._distanceTol)&&(this._isDeleted[v]=bc.DELETE,y=!0,t=!0);r=y?z:v;v=this.findNextNonDeletedIndex(r);z=this.findNextNonDeletedIndex(v)}return t};bc.prototype.isShallowConcavity=function(r,v,z,t){return Da.computeOrientation(r,v,z)===this._angleOrientation&&Da.distancePointLine(v,r,z)<t};bc.prototype.isShallowSampled=function(r,v,z,t,y){var C=Math.trunc((t-z)/bc.NUM_PTS_TO_CHECK);for(0>=C&&(C=1);z<t;z+=C)if(!this.isShallow(r,v,this._inputLine[z],y))return!1;return!0};bc.prototype.isConcave=
function(r,v,z){return Da.computeOrientation(r,v,z)===this._angleOrientation};bc.prototype.simplify=function(r){this._distanceTol=Math.abs(r);0>r&&(this._angleOrientation=Da.CLOCKWISE);this._isDeleted=Array(this._inputLine.length).fill(null);do r=this.deleteShallowConcavities();while(r);return this.collapseLine()};bc.prototype.findNextNonDeletedIndex=function(r){for(r+=1;r<this._inputLine.length&&this._isDeleted[r]===bc.DELETE;)r++;return r};bc.prototype.isShallow=function(r,v,z,t){return Da.distancePointLine(v,
r,z)<t};bc.prototype.collapseLine=function(){for(var r=new Tg,v=0;v<this._inputLine.length;v++)this._isDeleted[v]!==bc.DELETE&&r.add(this._inputLine[v]);return r.toCoordinateArray()};bc.prototype.interfaces_=function(){return[]};bc.prototype.getClass=function(){return bc};bc.simplify=function(r,v){return(new bc(r)).simplify(v)};dh.INIT.get=function(){return 0};dh.DELETE.get=function(){return 1};dh.KEEP.get=function(){return 1};dh.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(bc,
dh);var ed=function(){this._precisionModel=this._ptList=null;this._minimimVertexDistance=0;this._ptList=new Fa},rn={COORDINATE_ARRAY_TYPE:{configurable:!0}};ed.prototype.getCoordinates=function(){return this._ptList.toArray(ed.COORDINATE_ARRAY_TYPE)};ed.prototype.setPrecisionModel=function(r){this._precisionModel=r};ed.prototype.addPt=function(r){r=new sa(r);if(this._precisionModel.makePrecise(r),this.isRedundant(r))return null;this._ptList.add(r)};ed.prototype.revere=function(){};ed.prototype.addPts=
function(r,v){if(v)for(v=0;v<r.length;v++)this.addPt(r[v]);else for(v=r.length-1;0<=v;v--)this.addPt(r[v])};ed.prototype.isRedundant=function(r){if(1>this._ptList.size())return!1;var v=this._ptList.get(this._ptList.size()-1);return r.distance(v)<this._minimimVertexDistance};ed.prototype.toString=function(){return(new bb).createLineString(this.getCoordinates()).toString()};ed.prototype.closeRing=function(){if(1>this._ptList.size())return null;var r=new sa(this._ptList.get(0)),v=this._ptList.get(this._ptList.size()-
1);if(r.equals(v))return null;this._ptList.add(r)};ed.prototype.setMinimumVertexDistance=function(r){this._minimimVertexDistance=r};ed.prototype.interfaces_=function(){return[]};ed.prototype.getClass=function(){return ed};rn.COORDINATE_ARRAY_TYPE.get=function(){return[].fill(null)};Object.defineProperties(ed,rn);var cb=function(){},vf={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};
cb.prototype.interfaces_=function(){return[]};cb.prototype.getClass=function(){return cb};cb.toDegrees=function(r){return 180*r/Math.PI};cb.normalize=function(r){for(;r>Math.PI;)r-=cb.PI_TIMES_2;for(;r<=-Math.PI;)r+=cb.PI_TIMES_2;return r};cb.angle=function(){if(1===arguments.length){var r=arguments[0];return Math.atan2(r.y,r.x)}if(2===arguments.length){r=arguments[0];var v=arguments[1];return Math.atan2(v.y-r.y,v.x-r.x)}};cb.isAcute=function(r,v,z){return 0<(r.x-v.x)*(z.x-v.x)+(r.y-v.y)*(z.y-v.y)};
cb.isObtuse=function(r,v,z){return 0>(r.x-v.x)*(z.x-v.x)+(r.y-v.y)*(z.y-v.y)};cb.interiorAngle=function(r,v,z){r=cb.angle(v,r);v=cb.angle(v,z);return Math.abs(v-r)};cb.normalizePositive=function(r){if(0>r){for(;0>r;)r+=cb.PI_TIMES_2;r>=cb.PI_TIMES_2&&(r=0)}else{for(;r>=cb.PI_TIMES_2;)r-=cb.PI_TIMES_2;0>r&&(r=0)}return r};cb.angleBetween=function(r,v,z){r=cb.angle(v,r);v=cb.angle(v,z);return cb.diff(r,v)};cb.diff=function(r,v){var z=null;return(z=r<v?v-r:r-v)>Math.PI&&(z=2*Math.PI-z),z};cb.toRadians=
function(r){return r*Math.PI/180};cb.getTurn=function(r,v){r=Math.sin(v-r);return 0<r?cb.COUNTERCLOCKWISE:0>r?cb.CLOCKWISE:cb.NONE};cb.angleBetweenOriented=function(r,v,z){r=cb.angle(v,r);v=cb.angle(v,z)-r;return v<=-Math.PI?v+cb.PI_TIMES_2:v>Math.PI?v-cb.PI_TIMES_2:v};vf.PI_TIMES_2.get=function(){return 2*Math.PI};vf.PI_OVER_2.get=function(){return Math.PI/2};vf.PI_OVER_4.get=function(){return Math.PI/4};vf.COUNTERCLOCKWISE.get=function(){return Da.COUNTERCLOCKWISE};vf.CLOCKWISE.get=function(){return Da.CLOCKWISE};
vf.NONE.get=function(){return Da.COLLINEAR};Object.defineProperties(cb,vf);var Ub=function y(v,z,t){this._maxCurveSegmentError=0;this._filletAngleQuantum=null;this._closingSegLengthFactor=1;this._segList=null;this._distance=0;this._s2=this._s1=this._s0=this._li=this._bufParams=this._precisionModel=null;this._seg0=new Na;this._seg1=new Na;this._offset0=new Na;this._offset1=new Na;this._side=0;this._hasNarrowConcaveAngle=!1;this._precisionModel=v;this._bufParams=z;this._li=new Te;this._filletAngleQuantum=
Math.PI/2/z.getQuadrantSegments();8<=z.getQuadrantSegments()&&z.getJoinStyle()===Gb.JOIN_ROUND&&(this._closingSegLengthFactor=y.MAX_CLOSING_SEG_LEN_FACTOR);this.init(t)},eh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ub.prototype.addNextSegment=function(v,z){if(this._s0=this._s1,this._s1=this._s2,this._s2=v,this._seg0.setCoordinates(this._s0,
this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;v=Da.computeOrientation(this._s0,this._s1,this._s2);var t=v===Da.CLOCKWISE&&this._side===Aa.LEFT||v===Da.COUNTERCLOCKWISE&&this._side===Aa.RIGHT;0===v?this.addCollinear(z):t?this.addOutsideTurn(v,z):this.addInsideTurn(v,z)};Ub.prototype.addLineEndCap=function(v,
z){var t=new Na(v,z),y=new Na;this.computeOffsetSegment(t,Aa.LEFT,this._distance,y);var C=new Na;this.computeOffsetSegment(t,Aa.RIGHT,this._distance,C);v=Math.atan2(z.y-v.y,z.x-v.x);switch(this._bufParams.getEndCapStyle()){case Gb.CAP_ROUND:this._segList.addPt(y.p1);this.addFilletArc(z,v+Math.PI/2,v-Math.PI/2,Da.CLOCKWISE,this._distance);this._segList.addPt(C.p1);break;case Gb.CAP_FLAT:this._segList.addPt(y.p1);this._segList.addPt(C.p1);break;case Gb.CAP_SQUARE:z=new sa,z.x=Math.abs(this._distance)*
Math.cos(v),z.y=Math.abs(this._distance)*Math.sin(v),y=new sa(y.p1.x+z.x,y.p1.y+z.y),C=new sa(C.p1.x+z.x,C.p1.y+z.y),this._segList.addPt(y),this._segList.addPt(C)}};Ub.prototype.getCoordinates=function(){return this._segList.getCoordinates()};Ub.prototype.addMitreJoin=function(v,z,t,y){var C=!0,w=null;try{w=sd.intersection(z.p0,z.p1,t.p0,t.p1),(0>=y?1:w.distance(v)/Math.abs(y))>this._bufParams.getMitreLimit()&&(C=!1)}catch(x){if(!(x instanceof Tf))throw x;w=new sa(0,0);C=!1}C?this._segList.addPt(w):
this.addLimitedMitreJoin(z,t,y,this._bufParams.getMitreLimit())};Ub.prototype.addFilletCorner=function(v,z,t,y,C){var w=Math.atan2(z.y-v.y,z.x-v.x),x=Math.atan2(t.y-v.y,t.x-v.x);y===Da.CLOCKWISE?w<=x&&(w+=2*Math.PI):w>=x&&(w-=2*Math.PI);this._segList.addPt(z);this.addFilletArc(v,w,x,y,C);this._segList.addPt(t)};Ub.prototype.addOutsideTurn=function(v,z){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ub.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;
this._bufParams.getJoinStyle()===Gb.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Gb.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(z&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,v,this._distance),this._segList.addPt(this._offset1.p0))};Ub.prototype.createSquare=function(v){this._segList.addPt(new sa(v.x+this._distance,v.y+this._distance));this._segList.addPt(new sa(v.x+
this._distance,v.y-this._distance));this._segList.addPt(new sa(v.x-this._distance,v.y-this._distance));this._segList.addPt(new sa(v.x-this._distance,v.y+this._distance));this._segList.closeRing()};Ub.prototype.addSegments=function(v,z){this._segList.addPts(v,z)};Ub.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Ub.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Ub.prototype.initSideSegments=function(v,z,t){this._s1=v;this._s2=z;this._side=t;
this._seg1.setCoordinates(v,z);this.computeOffsetSegment(this._seg1,t,this._distance,this._offset1)};Ub.prototype.addLimitedMitreJoin=function(v,z,t,y){v=this._seg0.p1;var C=cb.angle(v,this._seg0.p0);z=cb.angleBetweenOriented(this._seg0.p0,v,this._seg1.p1)/2;C=cb.normalize(C+z);C=cb.normalize(C+Math.PI);y*=t;t-=y*Math.abs(Math.sin(z));y=new sa(v.x+y*Math.cos(C),v.y+y*Math.sin(C));y=new Na(v,y);v=y.pointAlongOffset(1,t);t=y.pointAlongOffset(1,-t);this._side===Aa.LEFT?(this._segList.addPt(v),this._segList.addPt(t)):
(this._segList.addPt(t),this._segList.addPt(v))};Ub.prototype.computeOffsetSegment=function(v,z,t,y){z=z===Aa.LEFT?1:-1;var C=v.p1.x-v.p0.x,w=v.p1.y-v.p0.y,x=Math.sqrt(C*C+w*w);C=z*t*C/x;t=z*t*w/x;y.p0.x=v.p0.x-t;y.p0.y=v.p0.y+C;y.p1.x=v.p1.x-t;y.p1.y=v.p1.y+C};Ub.prototype.addFilletArc=function(v,z,t,y,C){y=y===Da.CLOCKWISE?-1:1;t=Math.abs(z-t);var w=Math.trunc(t/this._filletAngleQuantum+.5);if(1>w)return null;w=t/w;for(var x=0,A=new sa;x<t;){var D=z+y*x;A.x=v.x+C*Math.cos(D);A.y=v.y+C*Math.sin(D);
this._segList.addPt(A);x+=w}};Ub.prototype.addInsideTurn=function(v,z){(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())?this._segList.addPt(this._li.getIntersection(0)):(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ub.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)?this._segList.addPt(this._offset0.p1):((this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor)?(v=new sa((this._closingSegLengthFactor*
this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(v),v=new sa((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1)),this._segList.addPt(v)):this._segList.addPt(this._s1),this._segList.addPt(this._offset1.p0))};Ub.prototype.createCircle=function(v){var z=
new sa(v.x+this._distance,v.y);this._segList.addPt(z);this.addFilletArc(v,0,2*Math.PI,-1,this._distance);this._segList.closeRing()};Ub.prototype.addBevelJoin=function(v,z){this._segList.addPt(v.p1);this._segList.addPt(z.p0)};Ub.prototype.init=function(v){this._distance=v;this._maxCurveSegmentError=v*(1-Math.cos(this._filletAngleQuantum/2));this._segList=new ed;this._segList.setPrecisionModel(this._precisionModel);this._segList.setMinimumVertexDistance(v*Ub.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Ub.prototype.addCollinear=
function(v){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===Gb.JOIN_BEVEL||this._bufParams.getJoinStyle()===Gb.JOIN_MITRE?(v&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Da.CLOCKWISE,this._distance))};Ub.prototype.closeRing=function(){this._segList.closeRing()};Ub.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};
Ub.prototype.interfaces_=function(){return[]};Ub.prototype.getClass=function(){return Ub};eh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001};eh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001};eh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1E-6};eh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Ub,eh);var Qc=function(v,z){this._distance=0;this._precisionModel=v;this._bufParams=z};Qc.prototype.getOffsetCurve=function(v,z){if(this._distance=
z,0===z)return null;var t=0>z;z=this.getSegGen(Math.abs(z));1>=v.length?this.computePointCurve(v[0],z):this.computeOffsetCurve(v,t,z);v=z.getCoordinates();return t&&ab.reverse(v),v};Qc.prototype.computeSingleSidedBufferCurve=function(v,z,t){var y=this.simplifyTolerance(this._distance);if(z)for(t.addSegments(v,!0),v=bc.simplify(v,-y),z=v.length-1,t.initSideSegments(v[z],v[z-1],Aa.LEFT),t.addFirstSegment(),z-=2;0<=z;z--)t.addNextSegment(v[z],!0);else for(t.addSegments(v,!1),v=bc.simplify(v,y),z=v.length-
1,t.initSideSegments(v[0],v[1],Aa.LEFT),t.addFirstSegment(),y=2;y<=z;y++)t.addNextSegment(v[y],!0);t.addLastSegment();t.closeRing()};Qc.prototype.computeRingBufferCurve=function(v,z,t){var y=this.simplifyTolerance(this._distance);z===Aa.RIGHT&&(y=-y);v=bc.simplify(v,y);y=v.length-1;t.initSideSegments(v[y-1],v[0],z);for(z=1;z<=y;z++)t.addNextSegment(v[z],1!==z);t.closeRing()};Qc.prototype.computeLineBufferCurve=function(v,z){var t=this.simplifyTolerance(this._distance),y=bc.simplify(v,t),C=y.length-
1;z.initSideSegments(y[0],y[1],Aa.LEFT);for(var w=2;w<=C;w++)z.addNextSegment(y[w],!0);z.addLastSegment();z.addLineEndCap(y[C-1],y[C]);v=bc.simplify(v,-t);t=v.length-1;z.initSideSegments(v[t],v[t-1],Aa.LEFT);for(t-=2;0<=t;t--)z.addNextSegment(v[t],!0);z.addLastSegment();z.addLineEndCap(v[1],v[0]);z.closeRing()};Qc.prototype.computePointCurve=function(v,z){switch(this._bufParams.getEndCapStyle()){case Gb.CAP_ROUND:z.createCircle(v);break;case Gb.CAP_SQUARE:z.createSquare(v)}};Qc.prototype.getLineCurve=
function(v,z){if((this._distance=z,0>z&&!this._bufParams.isSingleSided())||0===z)return null;var t=this.getSegGen(Math.abs(z));1>=v.length?this.computePointCurve(v[0],t):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(v,0>z,t):this.computeLineBufferCurve(v,t);return t.getCoordinates()};Qc.prototype.getBufferParameters=function(){return this._bufParams};Qc.prototype.simplifyTolerance=function(v){return v*this._bufParams.getSimplifyFactor()};Qc.prototype.getRingCurve=function(v,z,
t){if(this._distance=t,2>=v.length)return this.getLineCurve(v,t);if(0===t)return Qc.copyCoordinates(v);t=this.getSegGen(t);return this.computeRingBufferCurve(v,z,t),t.getCoordinates()};Qc.prototype.computeOffsetCurve=function(v,z,t){var y=this.simplifyTolerance(this._distance);if(z)for(v=bc.simplify(v,-y),z=v.length-1,t.initSideSegments(v[z],v[z-1],Aa.LEFT),t.addFirstSegment(),z-=2;0<=z;z--)t.addNextSegment(v[z],!0);else for(v=bc.simplify(v,y),z=v.length-1,t.initSideSegments(v[0],v[1],Aa.LEFT),t.addFirstSegment(),
y=2;y<=z;y++)t.addNextSegment(v[y],!0);t.addLastSegment()};Qc.prototype.getSegGen=function(v){return new Ub(this._precisionModel,this._bufParams,v)};Qc.prototype.interfaces_=function(){return[]};Qc.prototype.getClass=function(){return Qc};Qc.copyCoordinates=function(v){for(var z=Array(v.length).fill(null),t=0;t<z.length;t++)z[t]=new sa(v[t]);return z};var wf=function(v){this._subgraphs=null;this._seg=new Na;this._cga=new Da;this._subgraphs=v},sn={DepthSegment:{configurable:!0}};wf.prototype.findStabbedSegments=
function(){if(1===arguments.length){for(var v=arguments[0],z=new Fa,t=this._subgraphs.iterator();t.hasNext();){var y=t.next(),C=y.getEnvelope();v.y<C.getMinY()||v.y>C.getMaxY()||this.findStabbedSegments(v,y.getDirectedEdges(),z)}return z}if(3===arguments.length)if(Va(arguments[2],ue)&&arguments[0]instanceof sa&&arguments[1]instanceof Mj)for(v=arguments[0],z=arguments[1],t=arguments[2],y=z.getEdge().getCoordinates(),C=0;C<y.length-1;C++){if(this._seg.p0=y[C],this._seg.p1=y[C+1],this._seg.p0.y>this._seg.p1.y&&
this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<v.x||this._seg.isHorizontal()||v.y<this._seg.p0.y||v.y>this._seg.p1.y||Da.computeOrientation(this._seg.p0,this._seg.p1,v)===Da.RIGHT)){var w=z.getDepth(Aa.LEFT);this._seg.p0.equals(y[C])||(w=z.getDepth(Aa.RIGHT));w=new Ze(this._seg,w);t.add(w)}}else if(Va(arguments[2],ue)&&arguments[0]instanceof sa&&Va(arguments[1],ue))for(v=arguments[0],z=arguments[2],t=arguments[1].iterator();t.hasNext();)y=t.next(),y.isForward()&&this.findStabbedSegments(v,
y,z)};wf.prototype.getDepth=function(v){v=this.findStabbedSegments(v);return 0===v.size()?0:Kd.min(v)._leftDepth};wf.prototype.interfaces_=function(){return[]};wf.prototype.getClass=function(){return wf};sn.DepthSegment.get=function(){return Ze};Object.defineProperties(wf,sn);var Ze=function(v,z){this._leftDepth=this._upwardSeg=null;this._upwardSeg=new Na(v);this._leftDepth=z};Ze.prototype.compareTo=function(v){if(this._upwardSeg.minX()>=v._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=v._upwardSeg.minX())return-1;
var z=this._upwardSeg.orientationIndex(v._upwardSeg);return 0!==z||0!==(z=-1*v._upwardSeg.orientationIndex(this._upwardSeg))?z:this._upwardSeg.compareTo(v._upwardSeg)};Ze.prototype.compareX=function(v,z){var t=v.p0.compareTo(z.p0);return 0!==t?t:v.p1.compareTo(z.p1)};Ze.prototype.toString=function(){return this._upwardSeg.toString()};Ze.prototype.interfaces_=function(){return[jd]};Ze.prototype.getClass=function(){return Ze};var Hb=function(v,z,t){this.p0=v||null;this.p1=z||null;this.p2=t||null};Hb.prototype.area=
function(){return Hb.area(this.p0,this.p1,this.p2)};Hb.prototype.signedArea=function(){return Hb.signedArea(this.p0,this.p1,this.p2)};Hb.prototype.interpolateZ=function(v){if(null===v)throw new ac("Supplied point is null.");return Hb.interpolateZ(v,this.p0,this.p1,this.p2)};Hb.prototype.longestSideLength=function(){return Hb.longestSideLength(this.p0,this.p1,this.p2)};Hb.prototype.isAcute=function(){return Hb.isAcute(this.p0,this.p1,this.p2)};Hb.prototype.circumcentre=function(){return Hb.circumcentre(this.p0,
this.p1,this.p2)};Hb.prototype.area3D=function(){return Hb.area3D(this.p0,this.p1,this.p2)};Hb.prototype.centroid=function(){return Hb.centroid(this.p0,this.p1,this.p2)};Hb.prototype.inCentre=function(){return Hb.inCentre(this.p0,this.p1,this.p2)};Hb.prototype.interfaces_=function(){return[]};Hb.prototype.getClass=function(){return Hb};Hb.area=function(v,z,t){return Math.abs(((t.x-v.x)*(z.y-v.y)-(z.x-v.x)*(t.y-v.y))/2)};Hb.signedArea=function(v,z,t){return((t.x-v.x)*(z.y-v.y)-(z.x-v.x)*(t.y-v.y))/
2};Hb.det=function(v,z,t,y){return v*y-z*t};Hb.interpolateZ=function(v,z,t,y){var C=z.x,w=z.y,x=t.x-C,A=y.x-C,D=t.y-w,G=y.y-w,P=x*G-A*D;C=v.x-C;v=v.y-w;return z.z+(G*C-A*v)/P*(t.z-z.z)+(-D*C+x*v)/P*(y.z-z.z)};Hb.longestSideLength=function(v,z,t){var y=v.distance(z);z=z.distance(t);v=t.distance(v);return z>y&&(y=z),v>y&&(y=v),y};Hb.isAcute=function(v,z,t){return!!cb.isAcute(v,z,t)&&!!cb.isAcute(z,t,v)&&!!cb.isAcute(t,v,z)};Hb.circumcentre=function(v,z,t){var y=t.x;t=t.y;var C=v.x-y;v=v.y-t;var w=z.x-
y,x=z.y-t;z=2*Hb.det(C,v,w,x);var A=Hb.det(v,C*C+v*v,x,w*w+x*x);C=Hb.det(C,C*C+v*v,w,w*w+x*x);return new sa(y-A/z,t+C/z)};Hb.perpendicularBisector=function(v,z){var t=z.x-v.x,y=z.y-v.y;z=new sd(v.x+t/2,v.y+y/2,1);v=new sd(v.x-y+t/2,v.y+t+y/2,1);return new sd(z,v)};Hb.angleBisector=function(v,z,t){var y=z.distance(v);z=y/(y+z.distance(t));return new sa(v.x+z*(t.x-v.x),v.y+z*(t.y-v.y))};Hb.area3D=function(v,z,t){var y=z.x-v.x,C=z.y-v.y,w=z.z-v.z;z=t.x-v.x;var x=t.y-v.y;t=t.z-v.z;v=C*t-w*x;w=w*z-y*t;
y=y*x-C*z;return Math.sqrt(v*v+w*w+y*y)/2};Hb.centroid=function(v,z,t){return new sa((v.x+z.x+t.x)/3,(v.y+z.y+t.y)/3)};Hb.inCentre=function(v,z,t){var y=z.distance(t),C=v.distance(t),w=v.distance(z),x=y+C+w;return new sa((y*v.x+C*z.x+w*t.x)/x,(y*v.y+C*z.y+w*t.y)/x)};var od=function(v,z,t){this._curveBuilder=this._distance=this._inputGeom=null;this._curveList=new Fa;this._inputGeom=v;this._distance=z;this._curveBuilder=t};od.prototype.addPoint=function(v){if(0>=this._distance)return null;v=v.getCoordinates();
v=this._curveBuilder.getLineCurve(v,this._distance);this.addCurve(v,ua.EXTERIOR,ua.INTERIOR)};od.prototype.addPolygon=function(v){var z=this._distance,t=Aa.LEFT;0>this._distance&&(z=-this._distance,t=Aa.RIGHT);var y=v.getExteriorRing(),C=ab.removeRepeatedPoints(y.getCoordinates());if(0>this._distance&&this.isErodedCompletely(y,this._distance)||0>=this._distance&&3>C.length)return null;this.addPolygonRing(C,z,t,ua.EXTERIOR,ua.INTERIOR);for(y=0;y<v.getNumInteriorRing();y++){C=v.getInteriorRingN(y);
var w=ab.removeRepeatedPoints(C.getCoordinates());0<this._distance&&this.isErodedCompletely(C,-this._distance)||this.addPolygonRing(w,z,Aa.opposite(t),ua.INTERIOR,ua.EXTERIOR)}};od.prototype.isTriangleErodedCompletely=function(v,z){v=new Hb(v[0],v[1],v[2]);var t=v.inCentre();return Da.distancePointLine(t,v.p0,v.p1)<Math.abs(z)};od.prototype.addLineString=function(v){if(0>=this._distance&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;v=ab.removeRepeatedPoints(v.getCoordinates());
v=this._curveBuilder.getLineCurve(v,this._distance);this.addCurve(v,ua.EXTERIOR,ua.INTERIOR)};od.prototype.addCurve=function(v,z,t){if(null===v||2>v.length)return null;v=new ec(v,new Jb(0,ua.BOUNDARY,z,t));this._curveList.add(v)};od.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};od.prototype.addPolygonRing=function(v,z,t,y,C){if(0===z&&v.length<Yd.MINIMUM_VALID_SIZE)return null;var w=y,x=C;v.length>=Yd.MINIMUM_VALID_SIZE&&Da.isCCW(v)&&(w=C,x=y,t=Aa.opposite(t));v=
this._curveBuilder.getRingCurve(v,t,z);this.addCurve(v,w,x)};od.prototype.add=function(v){if(v.isEmpty())return null;v instanceof Fd?this.addPolygon(v):v instanceof Hc?this.addLineString(v):v instanceof Xd?this.addPoint(v):(v instanceof ag||v instanceof We||v instanceof Fe||v instanceof ud)&&this.addCollection(v)};od.prototype.isErodedCompletely=function(v,z){var t=v.getCoordinates();if(4>t.length)return 0>z;if(4===t.length)return this.isTriangleErodedCompletely(t,z);v=v.getEnvelopeInternal();v=Math.min(v.getHeight(),
v.getWidth());return 0>z&&2*Math.abs(z)>v};od.prototype.addCollection=function(v){for(var z=0;z<v.getNumGeometries();z++){var t=v.getGeometryN(z);this.add(t)}};od.prototype.interfaces_=function(){return[]};od.prototype.getClass=function(){return od};var eg=function(){};eg.prototype.locate=function(v){};eg.prototype.interfaces_=function(){return[]};eg.prototype.getClass=function(){return eg};var ae=function(v){this._subcollectionIterator=this._max=null;this._parent=v;this._atStart=!0;this._index=0;
this._max=v.getNumGeometries()};ae.prototype.next=function(){if(this._atStart)return this._atStart=!1,ae.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Mf;var v=this._parent.getGeometryN(this._index++);return v instanceof ud?(this._subcollectionIterator=new ae(v),this._subcollectionIterator.next()):v};ae.prototype.remove=
function(){throw Error(this.getClass().getName());};ae.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};ae.prototype.interfaces_=function(){return[Zf]};ae.prototype.getClass=function(){return ae};ae.isAtomic=function(v){return!(v instanceof ud)};var fd=function(v){this._geom=v};fd.prototype.locate=function(v){return fd.locate(v,this._geom)};
fd.prototype.interfaces_=function(){return[eg]};fd.prototype.getClass=function(){return fd};fd.isPointInRing=function(v,z){return!!z.getEnvelopeInternal().intersects(v)&&Da.isPointInRing(v,z.getCoordinates())};fd.containsPointInPolygon=function(v,z){if(z.isEmpty())return!1;var t=z.getExteriorRing();if(!fd.isPointInRing(v,t))return!1;for(t=0;t<z.getNumInteriorRing();t++){var y=z.getInteriorRingN(t);if(fd.isPointInRing(v,y))return!1}return!0};fd.containsPoint=function(v,z){if(z instanceof Fd)return fd.containsPointInPolygon(v,
z);if(z instanceof ud)for(var t=new ae(z);t.hasNext();){var y=t.next();if(y!==z&&fd.containsPoint(v,y))return!0}return!1};fd.locate=function(v,z){return z.isEmpty()?ua.EXTERIOR:fd.containsPoint(v,z)?ua.INTERIOR:ua.EXTERIOR};var Cc=function(){this._edgeMap=new Ac;this._edgeList=null;this._ptInAreaLocation=[ua.NONE,ua.NONE]};Cc.prototype.getNextCW=function(v){this.getEdges();v=this._edgeList.indexOf(v);var z=v-1;return 0===v&&(z=this._edgeList.size()-1),this._edgeList.get(z)};Cc.prototype.propagateSideLabels=
function(v){for(var z=ua.NONE,t=this.iterator();t.hasNext();){var y=t.next().getLabel();y.isArea(v)&&y.getLocation(v,Aa.LEFT)!==ua.NONE&&(z=y.getLocation(v,Aa.LEFT))}if(z===ua.NONE)return null;for(t=this.iterator();t.hasNext();){y=t.next();var C=y.getLabel();if(C.getLocation(v,Aa.ON)===ua.NONE&&C.setLocation(v,Aa.ON,z),C.isArea(v)){var w=C.getLocation(v,Aa.LEFT),x=C.getLocation(v,Aa.RIGHT);if(x!==ua.NONE){if(x!==z)throw new we("side location conflict",y.getCoordinate());w===ua.NONE&&Xa.shouldNeverReachHere("found single null side (at "+
y.getCoordinate()+")");z=w}else Xa.isTrue(C.getLocation(v,Aa.LEFT)===ua.NONE,"found single null side"),C.setLocation(v,Aa.RIGHT,z),C.setLocation(v,Aa.LEFT,z)}}};Cc.prototype.getCoordinate=function(){var v=this.iterator();return v.hasNext()?v.next().getCoordinate():null};Cc.prototype.print=function(v){Oc.out.println("EdgeEndStar:   "+this.getCoordinate());for(var z=this.iterator();z.hasNext();)z.next().print(v)};Cc.prototype.isAreaLabelsConsistent=function(v){return this.computeEdgeEndLabels(v.getBoundaryNodeRule()),
this.checkAreaLabelsConsistent(0)};Cc.prototype.checkAreaLabelsConsistent=function(v){var z=this.getEdges();if(0>=z.size())return!0;var t=z.size()-1;z=z.get(t).getLabel().getLocation(v,Aa.LEFT);Xa.isTrue(z!==ua.NONE,"Found unlabelled area edge");for(t=this.iterator();t.hasNext();){var y=t.next().getLabel();Xa.isTrue(y.isArea(v),"Found non-area edge");var C=y.getLocation(v,Aa.LEFT);y=y.getLocation(v,Aa.RIGHT);if(C===y||y!==z)return!1;z=C}return!0};Cc.prototype.findIndex=function(v){this.iterator();
for(var z=0;z<this._edgeList.size();z++)if(this._edgeList.get(z)===v)return z;return-1};Cc.prototype.iterator=function(){return this.getEdges().iterator()};Cc.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Fa(this._edgeMap.values())),this._edgeList};Cc.prototype.getLocation=function(v,z,t){return this._ptInAreaLocation[v]===ua.NONE&&(this._ptInAreaLocation[v]=fd.locate(z,t[v].getGeometry())),this._ptInAreaLocation[v]};Cc.prototype.toString=function(){var v=new Cd;
v.append("EdgeEndStar:   "+this.getCoordinate());v.append("\n");for(var z=this.iterator();z.hasNext();){var t=z.next();v.append(t);v.append("\n")}return v.toString()};Cc.prototype.computeEdgeEndLabels=function(v){for(var z=this.iterator();z.hasNext();)z.next().computeLabel(v)};Cc.prototype.computeLabelling=function(v){this.computeEdgeEndLabels(v[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);for(var z=[!1,!1],t=this.iterator();t.hasNext();)for(var y=t.next().getLabel(),
C=0;2>C;C++)y.isLine(C)&&y.getLocation(C)===ua.BOUNDARY&&(z[C]=!0);for(t=this.iterator();t.hasNext();){y=t.next();C=y.getLabel();for(var w=0;2>w;w++)if(C.isAnyNull(w)){if(z[w])var x=ua.EXTERIOR;else x=y.getCoordinate(),x=this.getLocation(w,x,v);C.setAllLocationsIfNull(w,x)}}};Cc.prototype.getDegree=function(){return this._edgeMap.size()};Cc.prototype.insertEdgeEnd=function(v,z){this._edgeMap.put(v,z);this._edgeList=null};Cc.prototype.interfaces_=function(){return[]};Cc.prototype.getClass=function(){return Cc};
var Fp=function(v){function z(){v.call(this);this._label=this._resultAreaEdgeList=null;this._SCANNING_FOR_INCOMING=1;this._LINKING_TO_OUTGOING=2}return v&&(z.__proto__=v),z.prototype=Object.create(v&&v.prototype),z.prototype.constructor=z,z.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,y=null,C=this._SCANNING_FOR_INCOMING,w=0;w<this._resultAreaEdgeList.size();w++){var x=this._resultAreaEdgeList.get(w),A=x.getSym();if(x.getLabel().isArea())switch(null===t&&x.isInResult()&&
(t=x),C){case this._SCANNING_FOR_INCOMING:if(!A.isInResult())continue;y=A;C=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:x.isInResult()&&(y.setNext(x),C=this._SCANNING_FOR_INCOMING)}}if(C===this._LINKING_TO_OUTGOING){if(null===t)throw new we("no outgoing dirEdge found",this.getCoordinate());Xa.isTrue(t.isInResult(),"unable to link last incoming dirEdge");y.setNext(t)}},z.prototype.insert=function(t){this.insertEdgeEnd(t,t)},z.prototype.getRightmostEdge=function(){var t=this.getEdges(),
y=t.size();if(1>y)return null;var C=t.get(0);if(1===y)return C;t=t.get(y-1);y=C.getQuadrant();var w=t.getQuadrant();return Mb.isNorthern(y)&&Mb.isNorthern(w)?C:Mb.isNorthern(y)||Mb.isNorthern(w)?0!==C.getDy()?C:0!==t.getDy()?t:(Xa.shouldNeverReachHere("found two horizontal edges incident on node"),null):t},z.prototype.print=function(t){Oc.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var y=this.iterator();y.hasNext();){var C=y.next();t.print("out ");C.print(t);t.println();t.print("in ");
C.getSym().print(t);t.println()}},z.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Fa;for(var t=this.iterator();t.hasNext();){var y=t.next();(y.isInResult()||y.getSym().isInResult())&&this._resultAreaEdgeList.add(y)}return this._resultAreaEdgeList},z.prototype.updateLabelling=function(t){for(var y=this.iterator();y.hasNext();){var C=y.next().getLabel();C.setAllLocationsIfNull(0,t.getLocation(0));C.setAllLocationsIfNull(1,
t.getLocation(1))}},z.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,y=null,C=this._edgeList.size()-1;0<=C;C--){var w=this._edgeList.get(C),x=w.getSym();null===y&&(y=x);null!==t&&x.setNext(t);t=w}y.setNext(t)},z.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],y=this.findIndex(t),C=t.getDepth(Aa.LEFT),w=t.getDepth(Aa.RIGHT);C=this.computeDepths(y+1,this._edgeList.size(),C);if(this.computeDepths(0,y,C)!==w)throw new we("depth mismatch at "+t.getCoordinate());
}else if(3===arguments.length){t=arguments[1];y=arguments[2];for(w=arguments[0];w<t;w++)C=this._edgeList.get(w),C.setEdgeDepths(Aa.RIGHT,y),y=C.getDepth(Aa.LEFT);return y}},z.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var y=t.next();y.getLabel().merge(y.getSym().getLabel())}},z.prototype.linkMinimalDirectedEdges=function(t){for(var y=null,C=null,w=this._SCANNING_FOR_INCOMING,x=this._resultAreaEdgeList.size()-1;0<=x;x--){var A=this._resultAreaEdgeList.get(x),D=A.getSym();
switch(null===y&&A.getEdgeRing()===t&&(y=A),w){case this._SCANNING_FOR_INCOMING:if(D.getEdgeRing()!==t)continue;C=D;w=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:A.getEdgeRing()===t&&(C.setNextMin(A),w=this._SCANNING_FOR_INCOMING)}}w===this._LINKING_TO_OUTGOING&&(Xa.isTrue(null!==y,"found null for first outgoing dirEdge"),Xa.isTrue(y.getEdgeRing()===t,"unable to link last incoming dirEdge"),C.setNextMin(y))},z.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=
0,y=this.iterator();y.hasNext();)y.next().isInResult()&&t++;return t}if(1===arguments.length){t=arguments[0];y=0;for(var C=this.iterator();C.hasNext();)C.next().getEdgeRing()===t&&y++;return y}},z.prototype.getLabel=function(){return this._label},z.prototype.findCoveredLineEdges=function(){for(var t=ua.NONE,y=this.iterator();y.hasNext();){var C=y.next(),w=C.getSym();if(!C.isLineEdge()){if(C.isInResult()){t=ua.INTERIOR;break}if(w.isInResult()){t=ua.EXTERIOR;break}}}if(t===ua.NONE)return null;for(y=
this.iterator();y.hasNext();)C=y.next(),w=C.getSym(),C.isLineEdge()?C.getEdge().setCovered(t===ua.INTERIOR):(C.isInResult()&&(t=ua.EXTERIOR),w.isInResult()&&(t=ua.INTERIOR))},z.prototype.computeLabelling=function(t){v.prototype.computeLabelling.call(this,t);this._label=new Jb(ua.NONE);for(t=this.iterator();t.hasNext();)for(var y=t.next().getEdge().getLabel(),C=0;2>C;C++){var w=y.getLocation(C);w!==ua.INTERIOR&&w!==ua.BOUNDARY||this._label.setLocation(C,ua.INTERIOR)}},z.prototype.interfaces_=function(){return[]},
z.prototype.getClass=function(){return z},z}(Cc),tn=function(v){function z(){v.apply(this,arguments)}return v&&(z.__proto__=v),z.prototype=Object.create(v&&v.prototype),z.prototype.constructor=z,z.prototype.createNode=function(t){return new hi(t,new Fp)},z.prototype.interfaces_=function(){return[]},z.prototype.getClass=function(){return z},z}(bg),Ie=function t(z){this._orientation=null;this._pts=z;this._orientation=t.orientation(z)};Ie.prototype.compareTo=function(z){return Ie.compareOriented(this._pts,
this._orientation,z._pts,z._orientation)};Ie.prototype.interfaces_=function(){return[jd]};Ie.prototype.getClass=function(){return Ie};Ie.orientation=function(z){return 1===ab.increasingDirection(z)};Ie.compareOriented=function(z,t,y,C){var w=t?1:-1,x=C?1:-1,A=t?z.length:-1,D=C?y.length:-1;t=t?0:z.length-1;for(C=C?0:y.length-1;;){var G=z[t].compareTo(y[C]);if(0!==G)return G;G=(t+=w)===A;var P=(C+=x)===D;if(G&&!P)return-1;if(!G&&P)return 1;if(G&&P)return 0}};var wd=function(){this._edges=new Fa;this._ocaMap=
new Ac};wd.prototype.print=function(z){z.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var y=this._edges.get(t);0<t&&z.print(",");z.print("(");y=y.getCoordinates();for(var C=0;C<y.length;C++)0<C&&z.print(","),z.print(y[C].x+" "+y[C].y);z.println(")")}z.print(")  ")};wd.prototype.addAll=function(z){for(z=z.iterator();z.hasNext();)this.add(z.next())};wd.prototype.findEdgeIndex=function(z){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(z))return t;return-1};wd.prototype.iterator=
function(){return this._edges.iterator()};wd.prototype.getEdges=function(){return this._edges};wd.prototype.get=function(z){return this._edges.get(z)};wd.prototype.findEqualEdge=function(z){z=new Ie(z.getCoordinates());return this._ocaMap.get(z)};wd.prototype.add=function(z){this._edges.add(z);var t=new Ie(z.getCoordinates());this._ocaMap.put(t,z)};wd.prototype.interfaces_=function(){return[]};wd.prototype.getClass=function(){return wd};var $e=function(){};$e.prototype.processIntersections=function(z,
t,y,C){};$e.prototype.isDone=function(){};$e.prototype.interfaces_=function(){return[]};$e.prototype.getClass=function(){return $e};var gd=function(z){this._hasInterior=this._hasProperInterior=this._hasProper=this._hasIntersection=!1;this._isSelfIntersection=this._properIntersectionPoint=null;this.numTests=this.numProperIntersections=this.numInteriorIntersections=this.numIntersections=0;this._li=z};gd.prototype.isTrivialIntersection=function(z,t,y,C){return z===y&&1===this._li.getIntersectionNum()&&
(gd.isAdjacentSegments(t,C)||z.isClosed()&&(z=z.size()-1,0===t&&C===z||0===C&&t===z))?!0:!1};gd.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};gd.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};gd.prototype.getLineIntersector=function(){return this._li};gd.prototype.hasProperIntersection=function(){return this._hasProper};gd.prototype.processIntersections=function(z,t,y,C){if(z===y&&t===C)return null;this.numTests++;var w=z.getCoordinates()[t],
x=z.getCoordinates()[t+1],A=y.getCoordinates()[C],D=y.getCoordinates()[C+1];this._li.computeIntersection(w,x,A,D);this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(z,t,y,C)||(this._hasIntersection=!0,z.addIntersections(this._li,t,0),y.addIntersections(this._li,C,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};gd.prototype.hasIntersection=
function(){return this._hasIntersection};gd.prototype.isDone=function(){return!1};gd.prototype.hasInteriorIntersection=function(){return this._hasInterior};gd.prototype.interfaces_=function(){return[$e]};gd.prototype.getClass=function(){return gd};gd.isAdjacentSegments=function(z,t){return 1===Math.abs(z-t)};var Md=function(z,t,y){this.dist=this.segmentIndex=this.coord=null;this.coord=new sa(z);this.segmentIndex=t;this.dist=y};Md.prototype.getSegmentIndex=function(){return this.segmentIndex};Md.prototype.getCoordinate=
function(){return this.coord};Md.prototype.print=function(z){z.print(this.coord);z.print(" seg # = "+this.segmentIndex);z.println(" dist = "+this.dist)};Md.prototype.compareTo=function(z){return this.compare(z.segmentIndex,z.dist)};Md.prototype.isEndPoint=function(z){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===z};Md.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Md.prototype.getDistance=function(){return this.dist};Md.prototype.compare=
function(z,t){return this.segmentIndex<z?-1:this.segmentIndex>z?1:this.dist<t?-1:this.dist>t?1:0};Md.prototype.interfaces_=function(){return[jd]};Md.prototype.getClass=function(){return Md};var be=function(z){this._nodeMap=new Ac;this.edge=z};be.prototype.print=function(z){z.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(z)};be.prototype.iterator=function(){return this._nodeMap.values().iterator()};be.prototype.addSplitEdges=function(z){this.addEndpoints();for(var t=
this.iterator(),y=t.next();t.hasNext();){var C=t.next();y=this.createSplitEdge(y,C);z.add(y);y=C}};be.prototype.addEndpoints=function(){var z=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0);this.add(this.edge.pts[z],z,0)};be.prototype.createSplitEdge=function(z,t){var y=t.segmentIndex-z.segmentIndex+2,C=this.edge.pts[t.segmentIndex];(C=0<t.dist||!t.coord.equals2D(C))||y--;y=Array(y).fill(null);var w=0;y[w++]=new sa(z.coord);for(z=z.segmentIndex+1;z<=t.segmentIndex;z++)y[w++]=this.edge.pts[z];
return C&&(y[w]=t.coord),new ji(y,new Jb(this.edge._label))};be.prototype.add=function(z,t,y){z=new Md(z,t,y);t=this._nodeMap.get(z);return null!==t?t:(this._nodeMap.put(z,z),z)};be.prototype.isIntersection=function(z){for(var t=this.iterator();t.hasNext();)if(t.next().coord.equals(z))return!0;return!1};be.prototype.interfaces_=function(){return[]};be.prototype.getClass=function(){return be};var af=function(){};af.prototype.getChainStartIndices=function(z){var t=0,y=new Fa;y.add(new Dd(t));do t=this.findChainEnd(z,
t),y.add(new Dd(t));while(t<z.length-1);return af.toIntArray(y)};af.prototype.findChainEnd=function(z,t){var y=Mb.quadrant(z[t],z[t+1]);for(t+=1;t<z.length&&Mb.quadrant(z[t-1],z[t])===y;)t++;return t-1};af.prototype.interfaces_=function(){return[]};af.prototype.getClass=function(){return af};af.toIntArray=function(z){for(var t=Array(z.size()).fill(null),y=0;y<t.length;y++)t[y]=z.get(y).intValue();return t};var ze=function(z){this.startIndex=this.pts=this.e=null;this.env1=new Ia;this.env2=new Ia;this.e=
z;this.pts=z.getCoordinates();this.startIndex=(new af).getChainStartIndices(this.pts)};ze.prototype.getCoordinates=function(){return this.pts};ze.prototype.getMaxX=function(z){var t=this.pts[this.startIndex[z]].x;z=this.pts[this.startIndex[z+1]].x;return t>z?t:z};ze.prototype.getMinX=function(z){var t=this.pts[this.startIndex[z]].x;z=this.pts[this.startIndex[z+1]].x;return t<z?t:z};ze.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var z=arguments[0],t=arguments[1],y=arguments[2];
this.computeIntersectsForChain(this.startIndex[z],this.startIndex[z+1],t,t.startIndex[y],t.startIndex[y+1],arguments[3])}else if(6===arguments.length){z=arguments[0];t=arguments[1];y=arguments[2];var C=arguments[3],w=arguments[4],x=arguments[5],A=this.pts[z],D=this.pts[t],G=y.pts[C],P=y.pts[w];if(1==t-z&&1==w-C)return x.addIntersections(this.e,z,y.e,C),null;if(this.env1.init(A,D),this.env2.init(G,P),!this.env1.intersects(this.env2))return null;A=Math.trunc((z+t)/2);D=Math.trunc((C+w)/2);z<A&&(C<D&&
this.computeIntersectsForChain(z,A,y,C,D,x),D<w&&this.computeIntersectsForChain(z,A,y,D,w,x));A<t&&(C<D&&this.computeIntersectsForChain(A,t,y,C,D,x),D<w&&this.computeIntersectsForChain(A,t,y,D,w,x))}};ze.prototype.getStartIndexes=function(){return this.startIndex};ze.prototype.computeIntersects=function(z,t){for(var y=0;y<this.startIndex.length-1;y++)for(var C=0;C<z.startIndex.length-1;C++)this.computeIntersectsForChain(y,z,C,t)};ze.prototype.interfaces_=function(){return[]};ze.prototype.getClass=
function(){return ze};var yc=function t(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var y=0;2>y;y++)for(var C=0;3>C;C++)this._depth[y][C]=t.NULL_VALUE},un={NULL_VALUE:{configurable:!0}};yc.prototype.getDepth=function(t,y){return this._depth[t][y]};yc.prototype.setDepth=function(t,y,C){this._depth[t][y]=C};yc.prototype.isNull=function(){if(0===arguments.length){for(var t=0;2>t;t++)for(var y=0;3>y;y++)if(this._depth[t][y]!==yc.NULL_VALUE)return!1;return!0}if(1===arguments.length)return this._depth[arguments[0]][1]===
yc.NULL_VALUE;if(2===arguments.length)return this._depth[arguments[0]][arguments[1]]===yc.NULL_VALUE};yc.prototype.normalize=function(){for(var t=0;2>t;t++)if(!this.isNull(t)){var y=this._depth[t][1];this._depth[t][2]<y&&(y=this._depth[t][2]);0>y&&(y=0);for(var C=1;3>C;C++){var w=0;this._depth[t][C]>y&&(w=1);this._depth[t][C]=w}}};yc.prototype.getDelta=function(t){return this._depth[t][Aa.RIGHT]-this._depth[t][Aa.LEFT]};yc.prototype.getLocation=function(t,y){return 0>=this._depth[t][y]?ua.EXTERIOR:
ua.INTERIOR};yc.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};yc.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],y=0;2>y;y++)for(var C=1;3>C;C++){var w=t.getLocation(y,C);w!==ua.EXTERIOR&&w!==ua.INTERIOR||(this.isNull(y,C)?this._depth[y][C]=yc.depthAtLocation(w):this._depth[y][C]+=yc.depthAtLocation(w))}else 3===arguments.length&&(t=arguments[0],y=arguments[1],arguments[2]===ua.INTERIOR&&this._depth[t][y]++)};
yc.prototype.interfaces_=function(){return[]};yc.prototype.getClass=function(){return yc};yc.depthAtLocation=function(t){return t===ua.EXTERIOR?0:t===ua.INTERIOR?1:yc.NULL_VALUE};un.NULL_VALUE.get=function(){return-1};Object.defineProperties(yc,un);var ji=function(t){function y(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new be(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new yc,this._depthDelta=0,1===arguments.length)y.call(this,arguments[0],null);else if(2===
arguments.length){var C=arguments[1];this.pts=arguments[0];this._label=C}}return t&&(y.__proto__=t),y.prototype=Object.create(t&&t.prototype),y.prototype.constructor=y,y.prototype.getDepth=function(){return this._depth},y.prototype.getCollapsedEdge=function(){var C=Array(2).fill(null);return C[0]=this.pts[0],C[1]=this.pts[1],new y(C,Jb.toLineLabel(this._label))},y.prototype.isIsolated=function(){return this._isIsolated},y.prototype.getCoordinates=function(){return this.pts},y.prototype.setIsolated=
function(C){this._isIsolated=C},y.prototype.setName=function(C){this._name=C},y.prototype.equals=function(C){if(!(C instanceof y)||this.pts.length!==C.pts.length)return!1;for(var w=!0,x=!0,A=this.pts.length,D=0;D<this.pts.length;D++)if(this.pts[D].equals2D(C.pts[D])||(w=!1),this.pts[D].equals2D(C.pts[--A])||(x=!1),!w&&!x)return!1;return!0},y.prototype.getCoordinate=function(){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length)return this.pts[arguments[0]]},y.prototype.print=
function(C){C.print("edge "+this._name+": ");C.print("LINESTRING (");for(var w=0;w<this.pts.length;w++)0<w&&C.print(","),C.print(this.pts[w].x+" "+this.pts[w].y);C.print(")  "+this._label+" "+this._depthDelta)},y.prototype.computeIM=function(C){y.updateIM(this._label,C)},y.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},y.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},y.prototype.getMaximumSegmentIndex=
function(){return this.pts.length-1},y.prototype.getDepthDelta=function(){return this._depthDelta},y.prototype.getNumPoints=function(){return this.pts.length},y.prototype.printReverse=function(C){C.print("edge "+this._name+": ");for(var w=this.pts.length-1;0<=w;w--)C.print(this.pts[w]+" ");C.println("")},y.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new ze(this)),this._mce},y.prototype.getEnvelope=function(){if(null===this._env){this._env=new Ia;for(var C=0;C<this.pts.length;C++)this._env.expandToInclude(this.pts[C])}return this._env},
y.prototype.addIntersection=function(C,w,x,A){var D=new sa(C.getIntersection(A));C=C.getEdgeDistance(x,A);x=w+1;x<this.pts.length&&D.equals2D(this.pts[x])&&(w=x,C=0);this.eiList.add(D,w,C)},y.prototype.toString=function(){var C=new Cd;C.append("edge "+this._name+": ");C.append("LINESTRING (");for(var w=0;w<this.pts.length;w++)0<w&&C.append(","),C.append(this.pts[w].x+" "+this.pts[w].y);return C.append(")  "+this._label+" "+this._depthDelta),C.toString()},y.prototype.isPointwiseEqual=function(C){if(this.pts.length!==
C.pts.length)return!1;for(var w=0;w<this.pts.length;w++)if(!this.pts[w].equals2D(C.pts[w]))return!1;return!0},y.prototype.setDepthDelta=function(C){this._depthDelta=C},y.prototype.getEdgeIntersectionList=function(){return this.eiList},y.prototype.addIntersections=function(C,w,x){for(var A=0;A<C.getIntersectionNum();A++)this.addIntersection(C,w,x,A)},y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,
arguments);var C=arguments[0],w=arguments[1];w.setAtLeastIfValid(C.getLocation(0,Aa.ON),C.getLocation(1,Aa.ON),1);C.isArea()&&(w.setAtLeastIfValid(C.getLocation(0,Aa.LEFT),C.getLocation(1,Aa.LEFT),2),w.setAtLeastIfValid(C.getLocation(0,Aa.RIGHT),C.getLocation(1,Aa.RIGHT),2))},y}(dd),Kc=function(t){this._graph=this._geomFact=this._workingNoder=this._workingPrecisionModel=null;this._edgeList=new wd;this._bufParams=t||null};Kc.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=
t};Kc.prototype.insertUniqueEdge=function(t){var y=this._edgeList.findEqualEdge(t);if(null!==y){var C=y.getLabel(),w=t.getLabel();y.isPointwiseEqual(t)||(w=new Jb(t.getLabel())).flip();C.merge(w);t=Kc.depthDelta(w);t=y.getDepthDelta()+t;y.setDepthDelta(t)}else this._edgeList.add(t),t.setDepthDelta(Kc.depthDelta(t.getLabel()))};Kc.prototype.buildSubgraphs=function(t,y){var C=new Fa;for(t=t.iterator();t.hasNext();){var w=t.next(),x=w.getRightmostCoordinate();x=(new wf(C)).getDepth(x);w.computeDepth(x);
w.findResultEdges();C.add(w);y.add(w.getDirectedEdges(),w.getNodes())}};Kc.prototype.createSubgraphs=function(t){var y=new Fa;for(t=t.getNodes().iterator();t.hasNext();){var C=t.next();if(!C.isVisited()){var w=new Ic;w.create(C);y.add(w)}}return Kd.sort(y,Kd.reverseOrder()),y};Kc.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()};Kc.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var y=new Nj,C=new Te;return C.setPrecisionModel(t),
y.setSegmentIntersector(new gd(C)),y};Kc.prototype.buffer=function(t,y){var C=this._workingPrecisionModel;null===C&&(C=t.getPrecisionModel());this._geomFact=t.getFactory();var w=new Qc(C,this._bufParams);t=(new od(t,y,w)).getCurves();if(0>=t.size())return this.createEmptyResultGeometry();this.computeNodedEdges(t,C);this._graph=new Yb(new tn);this._graph.addEdges(this._edgeList.getEdges());C=this.createSubgraphs(this._graph);t=new Yc(this._geomFact);this.buildSubgraphs(C,t);C=t.getPolygons();return 0>=
C.size()?this.createEmptyResultGeometry():this._geomFact.buildGeometry(C)};Kc.prototype.computeNodedEdges=function(t,y){y=this.getNoder(y);y.computeNodes(t);for(t=y.getNodedSubstrings().iterator();t.hasNext();){y=t.next();var C=y.getCoordinates();2===C.length&&C[0].equals2D(C[1])||(C=y.getData(),y=new ji(y.getCoordinates(),new Jb(C)),this.insertUniqueEdge(y))}};Kc.prototype.setNoder=function(t){this._workingNoder=t};Kc.prototype.interfaces_=function(){return[]};Kc.prototype.getClass=function(){return Kc};
Kc.depthDelta=function(t){var y=t.getLocation(0,Aa.LEFT);t=t.getLocation(0,Aa.RIGHT);return y===ua.INTERIOR&&t===ua.EXTERIOR?1:y===ua.EXTERIOR&&t===ua.INTERIOR?-1:0};Kc.convertSegStrings=function(t){for(var y=new bb,C=new Fa;t.hasNext();){var w=t.next();w=y.createLineString(w.getCoordinates());C.add(w)}return y.buildGeometry(C)};var Je=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[1];this._noder=
arguments[0];this._scaleFactor=t;this._offsetY=this._offsetX=0;this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){t=arguments[1];var y=arguments[2],C=arguments[3];this._noder=arguments[0];this._scaleFactor=t;this._offsetX=y;this._offsetY=C;this._isScaled=!this.isIntegerPrecision()}};Je.prototype.rescale=function(t){if(Va(t,kc))for(t=t.iterator();t.hasNext();){var y=t.next();this.rescale(y.getCoordinates())}else if(t instanceof Array){for(y=0;y<t.length;y++)t[y].x=t[y].x/this._scaleFactor+
this._offsetX,t[y].y=t[y].y/this._scaleFactor+this._offsetY;2===t.length&&t[0].equals2D(t[1])&&Oc.out.println(t)}};Je.prototype.scale=function(t){if(Va(t,kc)){var y=new Fa;for(t=t.iterator();t.hasNext();){var C=t.next();y.add(new ec(this.scale(C.getCoordinates()),C.getData()))}return y}if(t instanceof Array){y=Array(t.length).fill(null);for(C=0;C<t.length;C++)y[C]=new sa(Math.round((t[C].x-this._offsetX)*this._scaleFactor),Math.round((t[C].y-this._offsetY)*this._scaleFactor),t[C].z);return ab.removeRepeatedPoints(y)}};
Je.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor};Je.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Je.prototype.computeNodes=function(t){var y=t;this._isScaled&&(y=this.scale(t));this._noder.computeNodes(y)};Je.prototype.interfaces_=function(){return[Ye]};Je.prototype.getClass=function(){return Je};var Nd=function(t){this._li=new Te;this._segStrings=t},vn={fact:{configurable:!0}};Nd.prototype.checkEndPtVertexIntersections=
function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var y=t.next().getCoordinates();this.checkEndPtVertexIntersections(y[0],this._segStrings);this.checkEndPtVertexIntersections(y[y.length-1],this._segStrings)}else if(2===arguments.length)for(t=arguments[0],y=arguments[1].iterator();y.hasNext();)for(var C=y.next().getCoordinates(),w=1;w<C.length-1;w++)if(C[w].equals(t))throw new re("found endpt/interior pt intersection at index "+w+" :pt "+t);};Nd.prototype.checkInteriorIntersections=
function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var y=t.next(),C=this._segStrings.iterator();C.hasNext();){var w=C.next();this.checkInteriorIntersections(y,w)}else if(2===arguments.length){t=arguments[0];y=arguments[1];C=t.getCoordinates();w=y.getCoordinates();for(var x=0;x<C.length-1;x++)for(var A=0;A<w.length-1;A++)this.checkInteriorIntersections(t,x,y,A)}else if(4===arguments.length){w=arguments[0];x=arguments[1];y=arguments[2];C=arguments[3];if(w===y&&
x===C)return null;t=w.getCoordinates()[x];w=w.getCoordinates()[x+1];x=y.getCoordinates()[C];y=y.getCoordinates()[C+1];if(this._li.computeIntersection(t,w,x,y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,t,w)||this.hasInteriorIntersection(this._li,x,y)))throw new re("found non-noded intersection at "+t+"-"+w+" and "+x+"-"+y);}};Nd.prototype.checkValid=function(){this.checkEndPtVertexIntersections();this.checkInteriorIntersections();this.checkCollapses()};
Nd.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var y=t.next();this.checkCollapses(y)}else if(1===arguments.length)for(t=arguments[0].getCoordinates(),y=0;y<t.length-2;y++)this.checkCollapse(t[y],t[y+1],t[y+2])};Nd.prototype.hasInteriorIntersection=function(t,y,C){for(var w=0;w<t.getIntersectionNum();w++){var x=t.getIntersection(w);if(!x.equals(y)&&!x.equals(C))return!0}return!1};Nd.prototype.checkCollapse=function(t,y,C){if(t.equals(C))throw new re("found non-noded collapse at "+
Nd.fact.createLineString([t,y,C]));};Nd.prototype.interfaces_=function(){return[]};Nd.prototype.getClass=function(){return Nd};vn.fact.get=function(){return new bb};Object.defineProperties(Nd,vn);var Rc=function(t,y,C){this._maxy=this._miny=this._maxx=this._minx=this._scaleFactor=this._p1Scaled=this._p0Scaled=this._ptScaled=this._originalPt=this._pt=this._li=null;this._corner=Array(4).fill(null);this._safeEnv=null;if(this._originalPt=t,this._pt=t,this._scaleFactor=y,this._li=C,0>=y)throw new ac("Scale factor must be non-zero");
1!==y&&(this._pt=new sa(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new sa,this._p1Scaled=new sa);this.initCorners(this._pt)},wn={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Rc.prototype.intersectsScaled=function(t,y){var C=Math.max(t.x,y.x),w=Math.min(t.y,y.y),x=Math.max(t.y,y.y);if(C=this._maxx<Math.min(t.x,y.x)||this._minx>C||this._maxy<w||this._miny>x)return!1;t=this.intersectsToleranceSquare(t,y);return Xa.isTrue(!(C&&t),"Found bad envelope test"),t};Rc.prototype.initCorners=function(t){this._minx=
t.x-.5;this._maxx=t.x+.5;this._miny=t.y-.5;this._maxy=t.y+.5;this._corner[0]=new sa(this._maxx,this._maxy);this._corner[1]=new sa(this._minx,this._maxy);this._corner[2]=new sa(this._minx,this._miny);this._corner[3]=new sa(this._maxx,this._miny)};Rc.prototype.intersects=function(t,y){return 1===this._scaleFactor?this.intersectsScaled(t,y):(this.copyScaled(t,this._p0Scaled),this.copyScaled(y,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Rc.prototype.scale=function(t){return Math.round(t*
this._scaleFactor)};Rc.prototype.getCoordinate=function(){return this._originalPt};Rc.prototype.copyScaled=function(t,y){y.x=this.scale(t.x);y.y=this.scale(t.y)};Rc.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Rc.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ia(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};Rc.prototype.intersectsPixelClosure=function(t,y){return this._li.computeIntersection(t,y,this._corner[0],
this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,y,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,y,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,y,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))};Rc.prototype.intersectsToleranceSquare=function(t,y){var C=!1,w=!1;return this._li.computeIntersection(t,y,this._corner[0],this._corner[1]),!!this._li.isProper()||
(this._li.computeIntersection(t,y,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(C=!0),this._li.computeIntersection(t,y,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(w=!0),this._li.computeIntersection(t,y,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!C||!w)||!!t.equals(this._pt)||!!y.equals(this._pt))))};Rc.prototype.addSnappedNode=function(t,y){var C=t.getCoordinate(y),w=t.getCoordinate(y+1);return!!this.intersects(C,
w)&&(t.addIntersection(this.getCoordinate(),y),!0)};Rc.prototype.interfaces_=function(){return[]};Rc.prototype.getClass=function(){return Rc};wn.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75};Object.defineProperties(Rc,wn);var fh=function(){this.tempEnv1=new Ia;this.selectedSegment=new Na};fh.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))};fh.prototype.interfaces_=function(){return[]};
fh.prototype.getClass=function(){return fh};var fg=function(t){this._index=t},xn={HotPixelSnapAction:{configurable:!0}};fg.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var t=arguments[0],y=arguments[1],C=arguments[2],w=t.getSafeEnvelope(),x=new yn(t,y,C);return this._index.query(w,{interfaces_:function(){return[Ge]},visitItem:function(A){A.select(w,x)}}),x.isNodeAdded()}};fg.prototype.interfaces_=function(){return[]};fg.prototype.getClass=
function(){return fg};xn.HotPixelSnapAction.get=function(){return yn};Object.defineProperties(fg,xn);var yn=function(t){function y(C,w,x){t.call(this);this._isNodeAdded=!1;this._hotPixel=C;this._parentEdge=w;this._hotPixelVertexIndex=x}return t&&(y.__proto__=t),y.prototype=Object.create(t&&t.prototype),y.prototype.constructor=y,y.prototype.isNodeAdded=function(){return this._isNodeAdded},y.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var C=arguments[1],
w=arguments[0].getContext();if(null!==this._parentEdge&&w===this._parentEdge&&C===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(w,C)},y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y}(fh),xf=function(t){this._interiorIntersections=null;this._li=t;this._interiorIntersections=new Fa};xf.prototype.processIntersections=function(t,y,C,w){if(t===C&&y===w)return null;var x=t.getCoordinates()[y],A=t.getCoordinates()[y+1],D=C.getCoordinates()[w],
G=C.getCoordinates()[w+1];if(this._li.computeIntersection(x,A,D,G),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(x=0;x<this._li.getIntersectionNum();x++)this._interiorIntersections.add(this._li.getIntersection(x));t.addIntersections(this._li,y,0);C.addIntersections(this._li,w,1)}};xf.prototype.isDone=function(){return!1};xf.prototype.getInteriorIntersections=function(){return this._interiorIntersections};xf.prototype.interfaces_=function(){return[$e]};xf.prototype.getClass=function(){return xf};
var ce=function(t){this._nodedSegStrings=this._pointSnapper=this._noder=this._scaleFactor=this._li=null;this._pm=t;this._li=new Te;this._li.setPrecisionModel(t);this._scaleFactor=t.getScale()};ce.prototype.checkCorrectness=function(t){t=ec.getNodedSubstrings(t);t=new Nd(t);try{t.checkValid()}catch(y){if(!(y instanceof gn))throw y;y.printStackTrace()}};ce.prototype.getNodedSubstrings=function(){return ec.getNodedSubstrings(this._nodedSegStrings)};ce.prototype.snapRound=function(t,y){y=this.findInteriorIntersections(t,
y);this.computeIntersectionSnaps(y);this.computeVertexSnaps(t)};ce.prototype.findInteriorIntersections=function(t,y){y=new xf(y);return this._noder.setSegmentIntersector(y),this._noder.computeNodes(t),y.getInteriorIntersections()};ce.prototype.computeVertexSnaps=function(t){if(Va(t,kc))for(t=t.iterator();t.hasNext();){var y=t.next();this.computeVertexSnaps(y)}else if(t instanceof ec){y=t.getCoordinates();for(var C=0;C<y.length;C++){var w=new Rc(y[C],this._scaleFactor,this._li);this._pointSnapper.snap(w,
t,C)&&t.addIntersection(y[C],C)}}};ce.prototype.computeNodes=function(t){this._nodedSegStrings=t;this._noder=new Nj;this._pointSnapper=new fg(this._noder.getIndex());this.snapRound(t,this._li)};ce.prototype.computeIntersectionSnaps=function(t){for(t=t.iterator();t.hasNext();){var y=t.next();y=new Rc(y,this._scaleFactor,this._li);this._pointSnapper.snap(y)}};ce.prototype.interfaces_=function(){return[Ye]};ce.prototype.getClass=function(){return ce};var xc=function(){if(this._argGeom=null,this._distance=
null,this._bufParams=new Gb,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var t=arguments[1];this._argGeom=arguments[0];this._bufParams=t}},gg={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};xc.prototype.bufferFixedPrecision=function(t){var y=new Je(new ce(new Fb(1)),t.getScale()),C=new Kc(this._bufParams);C.setWorkingPrecisionModel(t);
C.setNoder(y);this._resultGeometry=C.buffer(this._argGeom,this._distance)};xc.prototype.bufferReducedPrecision=function(){if(0===arguments.length){for(var t=xc.MAX_PRECISION_DIGITS;0<=t;t--){try{this.bufferReducedPrecision(t)}catch(y){if(!(y instanceof we))throw y;this._saveException=y}if(null!==this._resultGeometry)return null}throw this._saveException;}1===arguments.length&&(t=xc.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),t=new Fb(t),this.bufferFixedPrecision(t))};xc.prototype.computeGeometry=
function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Fb.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};xc.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};xc.prototype.bufferOriginalPrecision=function(){try{this._resultGeometry=(new Kc(this._bufParams)).buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof re))throw t;this._saveException=
t}};xc.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};xc.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};xc.prototype.interfaces_=function(){return[]};xc.prototype.getClass=function(){return xc};xc.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return(new xc(arguments[0])).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ra&&"number"==typeof arguments[1]){t=
arguments[1];var y=arguments[2],C=new xc(arguments[0]);C.setQuadrantSegments(y);return C.getResultGeometry(t)}if(arguments[2]instanceof Gb&&arguments[0]instanceof Ra&&"number"==typeof arguments[1])return t=arguments[1],(new xc(arguments[0],arguments[2])).getResultGeometry(t)}else if(4===arguments.length){t=arguments[1];y=arguments[2];C=arguments[3];var w=new xc(arguments[0]);w.setQuadrantSegments(y);w.setEndCapStyle(C);return w.getResultGeometry(t)}};xc.precisionScaleFactor=function(t,y,C){t=t.getEnvelopeInternal();
y=cd.max(Math.abs(t.getMaxX()),Math.abs(t.getMaxY()),Math.abs(t.getMinX()),Math.abs(t.getMinY()))+2*(0<y?y:0);return Math.pow(10,C-Math.trunc(Math.log(y)/Math.log(10)+1))};gg.CAP_ROUND.get=function(){return Gb.CAP_ROUND};gg.CAP_BUTT.get=function(){return Gb.CAP_FLAT};gg.CAP_FLAT.get=function(){return Gb.CAP_FLAT};gg.CAP_SQUARE.get=function(){return Gb.CAP_SQUARE};gg.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(xc,gg);var $c=function(){if(this._lines=null,this._isForcedToLineString=
!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var t=arguments[1];this._lines=arguments[0];this._isForcedToLineString=t}};$c.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Yd)return t=t.getFactory().createLineString(t.getCoordinateSequence()),this._lines.add(t),null;t instanceof Hc&&this._lines.add(t)};$c.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};$c.prototype.interfaces_=function(){return[se]};$c.prototype.getClass=
function(){return $c};$c.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry($c.getLines(t))}if(2===arguments.length){t=arguments[0];var y=arguments[1];return t.getFactory().buildGeometry($c.getLines(t,y))}};$c.getLines=function(){if(1===arguments.length)return $c.getLines(arguments[0],!1);if(2===arguments.length){if(Va(arguments[0],kc)&&Va(arguments[1],kc)){for(var t=arguments[1],y=arguments[0].iterator();y.hasNext();){var C=y.next();$c.getLines(C,
t)}return t}if(arguments[0]instanceof Ra&&"boolean"==typeof arguments[1])return t=arguments[0],y=arguments[1],C=new Fa,t.apply(new $c(C,y)),C;if(arguments[0]instanceof Ra&&Va(arguments[1],kc))return t=arguments[0],y=arguments[1],t instanceof Hc?y.add(t):t.apply(new $c(y)),y}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Va(arguments[0],kc)&&Va(arguments[1],kc)){t=arguments[1];y=arguments[2];for(C=arguments[0].iterator();C.hasNext();){var w=C.next();$c.getLines(w,t,y)}return t}if("boolean"==
typeof arguments[2]&&arguments[0]instanceof Ra&&Va(arguments[1],kc))return t=arguments[1],arguments[0].apply(new $c(t,arguments[2])),t}};var de=function(){if((this._boundaryRule=kd.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length)&&1===arguments.length){var t=arguments[0];if(null===t)throw new ac("Rule must be non-null");this._boundaryRule=t}};de.prototype.locateInternal=function(t,y){if(t instanceof sa&&y instanceof Fd){if(y.isEmpty())return ua.EXTERIOR;var C=y.getExteriorRing();
C=this.locateInPolygonRing(t,C);if(C===ua.EXTERIOR)return ua.EXTERIOR;if(C===ua.BOUNDARY)return ua.BOUNDARY;for(C=0;C<y.getNumInteriorRing();C++){var w=y.getInteriorRingN(C);w=this.locateInPolygonRing(t,w);if(w===ua.INTERIOR)return ua.EXTERIOR;if(w===ua.BOUNDARY)return ua.BOUNDARY}return ua.INTERIOR}if(t instanceof sa&&y instanceof Hc){if(!y.getEnvelopeInternal().intersects(t))return ua.EXTERIOR;C=y.getCoordinates();return y.isClosed()||!t.equals(C[0])&&!t.equals(C[C.length-1])?Da.isOnLine(t,C)?ua.INTERIOR:
ua.EXTERIOR:ua.BOUNDARY}if(t instanceof sa&&y instanceof Xd)return y.getCoordinate().equals2D(t)?ua.INTERIOR:ua.EXTERIOR};de.prototype.locateInPolygonRing=function(t,y){return y.getEnvelopeInternal().intersects(t)?Da.locatePointInRing(t,y.getCoordinates()):ua.EXTERIOR};de.prototype.intersects=function(t,y){return this.locate(t,y)!==ua.EXTERIOR};de.prototype.updateLocationInfo=function(t){t===ua.INTERIOR&&(this._isIn=!0);t===ua.BOUNDARY&&this._numBoundaries++};de.prototype.computeLocation=function(t,
y){if(y instanceof Xd&&this.updateLocationInfo(this.locateInternal(t,y)),y instanceof Hc)this.updateLocationInfo(this.locateInternal(t,y));else if(y instanceof Fd)this.updateLocationInfo(this.locateInternal(t,y));else if(y instanceof We)for(var C=0;C<y.getNumGeometries();C++){var w=y.getGeometryN(C);this.updateLocationInfo(this.locateInternal(t,w))}else if(y instanceof Fe)for(C=0;C<y.getNumGeometries();C++)w=y.getGeometryN(C),this.updateLocationInfo(this.locateInternal(t,w));else if(y instanceof ud)for(C=
new ae(y);C.hasNext();)w=C.next(),w!==y&&this.computeLocation(t,w)};de.prototype.locate=function(t,y){return y.isEmpty()?ua.EXTERIOR:y instanceof Hc||y instanceof Fd?this.locateInternal(t,y):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,y),this._boundaryRule.isInBoundary(this._numBoundaries)?ua.BOUNDARY:0<this._numBoundaries||this._isIn?ua.INTERIOR:ua.EXTERIOR)};de.prototype.interfaces_=function(){return[]};de.prototype.getClass=function(){return de};var Od=function(t,y){this._pts=t;
this._data=y};Od.prototype.getCoordinates=function(){return this._pts};Od.prototype.size=function(){return this._pts.length};Od.prototype.getCoordinate=function(t){return this._pts[t]};Od.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Od.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:uf.octant(this.getCoordinate(t),this.getCoordinate(t+1))};Od.prototype.setData=function(t){this._data=t};Od.prototype.getData=function(){return this._data};
Od.prototype.toString=function(){return qe.toLineString(new hc(this._pts))};Od.prototype.interfaces_=function(){return[$d]};Od.prototype.getClass=function(){return Od};var sc=function(t){this._isCheckEndSegmentsOnly=this._findAllIntersections=!1;this._intSegments=this._interiorIntersection=this._li=null;this._intersections=new Fa;this._intersectionCount=0;this._keepIntersections=!0;this._li=t;this._interiorIntersection=null};sc.prototype.getInteriorIntersection=function(){return this._interiorIntersection};
sc.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};sc.prototype.getIntersectionSegments=function(){return this._intSegments};sc.prototype.count=function(){return this._intersectionCount};sc.prototype.getIntersections=function(){return this._intersections};sc.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};sc.prototype.setKeepIntersections=function(t){this._keepIntersections=t};sc.prototype.processIntersections=function(t,y,C,w){if(!this._findAllIntersections&&
this.hasIntersection()||t===C&&y===w||this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,y)&&!this.isEndSegment(C,w))return null;var x=t.getCoordinates()[y];t=t.getCoordinates()[y+1];y=C.getCoordinates()[w];C=C.getCoordinates()[w+1];this._li.computeIntersection(x,t,y,C);this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=Array(4).fill(null),this._intSegments[0]=x,this._intSegments[1]=t,this._intSegments[2]=y,this._intSegments[3]=C,this._interiorIntersection=this._li.getIntersection(0),
this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};sc.prototype.isEndSegment=function(t,y){return 0===y||y>=t.size()-2};sc.prototype.hasIntersection=function(){return null!==this._interiorIntersection};sc.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection};sc.prototype.interfaces_=function(){return[$e]};sc.prototype.getClass=function(){return sc};sc.createAllIntersectionsFinder=function(t){t=new sc(t);
return t.setFindAllIntersections(!0),t};sc.createAnyIntersectionFinder=function(t){return new sc(t)};sc.createIntersectionCounter=function(t){t=new sc(t);return t.setFindAllIntersections(!0),t.setKeepIntersections(!1),t};var xd=function(t){this._li=new Te;this._findAllIntersections=!1;this._segInt=null;this._isValid=!0;this._segStrings=t};xd.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()};xd.prototype.getIntersections=function(){return this._segInt.getIntersections()};
xd.prototype.isValid=function(){return this.execute(),this._isValid};xd.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};xd.prototype.checkInteriorIntersections=function(){this._isValid=!0;this._segInt=new sc(this._li);this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Nj;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};xd.prototype.checkValid=function(){if(this.execute(),
!this._isValid)throw new we(this.getErrorMessage(),this._segInt.getInteriorIntersection());};xd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+qe.toLineString(t[0],t[1])+" and "+qe.toLineString(t[2],t[3])};xd.prototype.interfaces_=function(){return[]};xd.prototype.getClass=function(){return xd};xd.computeIntersections=function(t){t=new xd(t);return t.setFindAllIntersections(!0),
t.isValid(),t.getIntersections()};var bf=function C(y){this._nv=null;this._nv=new xd(C.toSegmentStrings(y))};bf.prototype.checkValid=function(){this._nv.checkValid()};bf.prototype.interfaces_=function(){return[]};bf.prototype.getClass=function(){return bf};bf.toSegmentStrings=function(y){var C=new Fa;for(y=y.iterator();y.hasNext();){var w=y.next();C.add(new Od(w.getCoordinates(),w))}return C};bf.checkValid=function(y){(new bf(y)).checkValid()};var yf=function(y){this._mapOp=y};yf.prototype.map=function(y){for(var C=
new Fa,w=0;w<y.getNumGeometries();w++){var x=this._mapOp.map(y.getGeometryN(w));x.isEmpty()||C.add(x)}return y.getFactory().createGeometryCollection(bb.toGeometryArray(C))};yf.prototype.interfaces_=function(){return[]};yf.prototype.getClass=function(){return yf};yf.map=function(y,C){return(new yf(C)).map(y)};var Pd=function(y,C,w){this._ptLocator=this._geometryFactory=this._op=null;this._lineEdgesList=new Fa;this._resultLineList=new Fa;this._op=y;this._geometryFactory=C;this._ptLocator=w};Pd.prototype.collectLines=
function(y){for(var C=this._op.getGraph().getEdgeEnds().iterator();C.hasNext();){var w=C.next();this.collectLineEdge(w,y,this._lineEdgesList);this.collectBoundaryTouchEdge(w,y,this._lineEdgesList)}};Pd.prototype.labelIsolatedLine=function(y,C){var w=this._ptLocator.locate(y.getCoordinate(),this._op.getArgGeometry(C));y.getLabel().setLocation(C,w)};Pd.prototype.build=function(y){return this.findCoveredLineEdges(),this.collectLines(y),this.buildLines(y),this._resultLineList};Pd.prototype.collectLineEdge=
function(y,C,w){var x=y.getLabel(),A=y.getEdge();y.isLineEdge()&&(y.isVisited()||!Za.isResultOfOp(x,C)||A.isCovered()||(w.add(A),y.setVisitedEdge(!0)))};Pd.prototype.findCoveredLineEdges=function(){for(var y=this._op.getGraph().getNodes().iterator();y.hasNext();)y.next().getEdges().findCoveredLineEdges();for(y=this._op.getGraph().getEdgeEnds().iterator();y.hasNext();){var C=y.next(),w=C.getEdge();C.isLineEdge()&&!w.isCoveredSet()&&(C=this._op.isCoveredByA(C.getCoordinate()),w.setCovered(C))}};Pd.prototype.labelIsolatedLines=
function(y){for(y=y.iterator();y.hasNext();){var C=y.next(),w=C.getLabel();C.isIsolated()&&(w.isNull(0)?this.labelIsolatedLine(C,0):this.labelIsolatedLine(C,1))}};Pd.prototype.buildLines=function(y){for(y=this._lineEdgesList.iterator();y.hasNext();){var C=y.next(),w=this._geometryFactory.createLineString(C.getCoordinates());this._resultLineList.add(w);C.setInResult(!0)}};Pd.prototype.collectBoundaryTouchEdge=function(y,C,w){var x=y.getLabel();return y.isLineEdge()||y.isVisited()||y.isInteriorAreaEdge()||
y.getEdge().isInResult()?null:(Xa.isTrue(!(y.isInResult()||y.getSym().isInResult())||!y.getEdge().isInResult()),void(Za.isResultOfOp(x,C)&&C===Za.INTERSECTION&&(w.add(y.getEdge()),y.setVisitedEdge(!0))))};Pd.prototype.interfaces_=function(){return[]};Pd.prototype.getClass=function(){return Pd};var zf=function(y,C){this._geometryFactory=this._op=null;this._resultPointList=new Fa;this._op=y;this._geometryFactory=C};zf.prototype.filterCoveredNodeToPoint=function(y){y=y.getCoordinate();this._op.isCoveredByLA(y)||
(y=this._geometryFactory.createPoint(y),this._resultPointList.add(y))};zf.prototype.extractNonCoveredResultNodes=function(y){for(var C=this._op.getGraph().getNodes().iterator();C.hasNext();){var w=C.next();if(!(w.isInResult()||w.isIncidentEdgeInResult()||0!==w.getEdges().getDegree()&&y!==Za.INTERSECTION)){var x=w.getLabel();Za.isResultOfOp(x,y)&&this.filterCoveredNodeToPoint(w)}}};zf.prototype.build=function(y){return this.extractNonCoveredResultNodes(y),this._resultPointList};zf.prototype.interfaces_=
function(){return[]};zf.prototype.getClass=function(){return zf};var Sc=function(){this._factory=this._inputGeom=null;this._preserveGeometryCollectionType=this._pruneEmptyGeometry=!0;this._preserveType=this._preserveCollections=!1};Sc.prototype.transformPoint=function(y,C){return this._factory.createPoint(this.transformCoordinates(y.getCoordinateSequence(),y))};Sc.prototype.transformPolygon=function(y,C){var w=!0;C=this.transformLinearRing(y.getExteriorRing(),y);null!==C&&C instanceof Yd&&!C.isEmpty()||
(w=!1);for(var x=new Fa,A=0;A<y.getNumInteriorRing();A++){var D=this.transformLinearRing(y.getInteriorRingN(A),y);null===D||D.isEmpty()||(D instanceof Yd||(w=!1),x.add(D))}if(w)return this._factory.createPolygon(C,x.toArray([]));y=new Fa;return null!==C&&y.add(C),y.addAll(x),this._factory.buildGeometry(y)};Sc.prototype.createCoordinateSequence=function(y){return this._factory.getCoordinateSequenceFactory().create(y)};Sc.prototype.getInputGeometry=function(){return this._inputGeom};Sc.prototype.transformMultiLineString=
function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=this.transformLineString(y.getGeometryN(w),y);null!==x&&(x.isEmpty()||C.add(x))}return this._factory.buildGeometry(C)};Sc.prototype.transformCoordinates=function(y,C){return this.copy(y)};Sc.prototype.transformLineString=function(y,C){return this._factory.createLineString(this.transformCoordinates(y.getCoordinateSequence(),y))};Sc.prototype.transformMultiPoint=function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=
this.transformPoint(y.getGeometryN(w),y);null!==x&&(x.isEmpty()||C.add(x))}return this._factory.buildGeometry(C)};Sc.prototype.transformMultiPolygon=function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=this.transformPolygon(y.getGeometryN(w),y);null!==x&&(x.isEmpty()||C.add(x))}return this._factory.buildGeometry(C)};Sc.prototype.copy=function(y){return y.copy()};Sc.prototype.transformGeometryCollection=function(y,C){C=new Fa;for(var w=0;w<y.getNumGeometries();w++){var x=this.transform(y.getGeometryN(w));
null!==x&&(this._pruneEmptyGeometry&&x.isEmpty()||C.add(x))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(bb.toGeometryArray(C)):this._factory.buildGeometry(C)};Sc.prototype.transform=function(y){if(this._inputGeom=y,this._factory=y.getFactory(),y instanceof Xd)return this.transformPoint(y,null);if(y instanceof ag)return this.transformMultiPoint(y,null);if(y instanceof Yd)return this.transformLinearRing(y,null);if(y instanceof Hc)return this.transformLineString(y,
null);if(y instanceof We)return this.transformMultiLineString(y,null);if(y instanceof Fd)return this.transformPolygon(y,null);if(y instanceof Fe)return this.transformMultiPolygon(y,null);if(y instanceof ud)return this.transformGeometryCollection(y,null);throw new ac("Unknown Geometry subtype: "+y.getClass().getName());};Sc.prototype.transformLinearRing=function(y,C){y=this.transformCoordinates(y.getCoordinateSequence(),y);if(null===y)return this._factory.createLinearRing(null);C=y.size();return 0<
C&&4>C&&!this._preserveType?this._factory.createLineString(y):this._factory.createLinearRing(y)};Sc.prototype.interfaces_=function(){return[]};Sc.prototype.getClass=function(){return Sc};var ee=function x(C,w){(this._snapTolerance=0,this._srcPts=null,this._seg=new Na,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,C instanceof Hc&&"number"==typeof w)?x.call(this,C.getCoordinates(),w):C instanceof Array&&"number"==typeof w&&(this._srcPts=C,this._isClosed=x.isClosed(C),this._snapTolerance=
w)};ee.prototype.snapVertices=function(C,w){for(var x=this._isClosed?C.size()-1:C.size(),A=0;A<x;A++){var D=C.get(A);D=this.findSnapForVertex(D,w);null!==D&&(C.set(A,new sa(D)),0===A&&this._isClosed&&C.set(C.size()-1,new sa(D)))}};ee.prototype.findSnapForVertex=function(C,w){for(var x=0;x<w.length&&!C.equals2D(w[x]);x++)if(C.distance(w[x])<this._snapTolerance)return w[x];return null};ee.prototype.snapTo=function(C){var w=new Tg(this._srcPts);return this.snapVertices(w,C),this.snapSegments(w,C),w.toCoordinateArray()};
ee.prototype.snapSegments=function(C,w){if(0===w.length)return null;var x=w.length;w[0].equals2D(w[w.length-1])&&(x=w.length-1);for(var A=0;A<x;A++){var D=w[A],G=this.findSegmentIndexToSnap(D,C);0<=G&&C.add(G+1,new sa(D),!1)}};ee.prototype.findSegmentIndexToSnap=function(C,w){for(var x=Wa.MAX_VALUE,A=-1,D=0;D<w.size()-1;D++){if(this._seg.p0=w.get(D),this._seg.p1=w.get(D+1),this._seg.p0.equals2D(C)||this._seg.p1.equals2D(C)){if(this._allowSnappingToSourceVertices)continue;return-1}var G=this._seg.distance(C);
G<this._snapTolerance&&G<x&&(x=G,A=D)}return A};ee.prototype.setAllowSnappingToSourceVertices=function(C){this._allowSnappingToSourceVertices=C};ee.prototype.interfaces_=function(){return[]};ee.prototype.getClass=function(){return ee};ee.isClosed=function(C){return!(1>=C.length)&&C[0].equals2D(C[C.length-1])};var pc=function(C){this._srcGeom=C||null},zn={SNAP_PRECISION_FACTOR:{configurable:!0}};pc.prototype.snapTo=function(C,w){C=this.extractTargetCoordinates(C);return(new An(w,C)).transform(this._srcGeom)};
pc.prototype.snapToSelf=function(C,w){var x=this.extractTargetCoordinates(this._srcGeom);x=C=(new An(C,x,!0)).transform(this._srcGeom);return w&&Va(x,Xe)&&(x=C.buffer(0)),x};pc.prototype.computeSnapTolerance=function(C){return this.computeMinimumSegmentLength(C)/10};pc.prototype.extractTargetCoordinates=function(C){var w=new zd;C=C.getCoordinates();for(var x=0;x<C.length;x++)w.add(C[x]);return w.toArray([].fill(null))};pc.prototype.computeMinimumSegmentLength=function(C){for(var w=Wa.MAX_VALUE,x=
0;x<C.length-1;x++){var A=C[x].distance(C[x+1]);A<w&&(w=A)}return w};pc.prototype.interfaces_=function(){return[]};pc.prototype.getClass=function(){return pc};pc.snap=function(C,w,x){var A=Array(2).fill(null);C=new pc(C);A[0]=C.snapTo(w,x);w=new pc(w);return A[1]=w.snapTo(A[0],x),A};pc.computeOverlaySnapTolerance=function(){if(1===arguments.length){var C=arguments[0],w=pc.computeSizeBasedSnapTolerance(C);C=C.getPrecisionModel();C.getType()===Fb.FIXED&&(C=1/C.getScale()*2/1.415,C>w&&(w=C));return w}if(2===
arguments.length)return w=arguments[1],Math.min(pc.computeOverlaySnapTolerance(arguments[0]),pc.computeOverlaySnapTolerance(w))};pc.computeSizeBasedSnapTolerance=function(C){C=C.getEnvelopeInternal();return Math.min(C.getHeight(),C.getWidth())*pc.SNAP_PRECISION_FACTOR};pc.snapToSelf=function(C,w,x){return(new pc(C)).snapToSelf(w,x)};zn.SNAP_PRECISION_FACTOR.get=function(){return 1E-9};Object.defineProperties(pc,zn);var An=function(C){function w(x,A,D){C.call(this);this._snapTolerance=x||null;this._snapPts=
A||null;this._isSelfSnap=void 0!==D&&D}return C&&(w.__proto__=C),w.prototype=Object.create(C&&C.prototype),w.prototype.constructor=w,w.prototype.snapLine=function(x,A){x=new ee(x,this._snapTolerance);return x.setAllowSnappingToSourceVertices(this._isSelfSnap),x.snapTo(A)},w.prototype.transformCoordinates=function(x,A){x=x.toCoordinateArray();x=this.snapLine(x,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(x)},w.prototype.interfaces_=function(){return[]},w.prototype.getClass=
function(){return w},w}(Sc),Lc=function(){this._isFirst=!0;this._commonMantissaBitsCount=53;this._commonBits=0;this._commonSignExp=null};Lc.prototype.getCommon=function(){return Wa.longBitsToDouble(this._commonBits)};Lc.prototype.add=function(C){C=Wa.doubleToLongBits(C);return this._isFirst?(this._commonBits=C,this._commonSignExp=Lc.signExpBits(this._commonBits),this._isFirst=!1,null):Lc.signExpBits(C)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Lc.numCommonMostSigMantissaBits(this._commonBits,
C),void(this._commonBits=Lc.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))};Lc.prototype.toString=function(){if(1===arguments.length){var C=arguments[0],w=Wa.longBitsToDouble(C);C="0000000000000000000000000000000000000000000000000000000000000000"+Wa.toBinaryString(C);C=C.substring(C.length-64);return C.substring(0,1)+"  "+C.substring(1,12)+"(exp) "+C.substring(12)+" [ "+w+" ]"}};Lc.prototype.interfaces_=function(){return[]};Lc.prototype.getClass=function(){return Lc};Lc.getBit=
function(C,w){return 0!=(C&1<<w)?1:0};Lc.signExpBits=function(C){return C>>52};Lc.zeroLowerBits=function(C,w){return C&~((1<<w)-1)};Lc.numCommonMostSigMantissaBits=function(C,w){for(var x=0,A=52;0<=A;A--){if(Lc.getBit(C,A)!==Lc.getBit(w,A))return x;x++}return 52};var Ke=function(){this._commonCoord=null;this._ccFilter=new Af},Oj={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Ke.prototype.addCommonBits=function(C){var w=new Le(this._commonCoord);C.apply(w);C.geometryChanged()};
Ke.prototype.removeCommonBits=function(C){if(0===this._commonCoord.x&&0===this._commonCoord.y)return C;var w=new sa(this._commonCoord);w.x=-w.x;w.y=-w.y;w=new Le(w);return C.apply(w),C.geometryChanged(),C};Ke.prototype.getCommonCoordinate=function(){return this._commonCoord};Ke.prototype.add=function(C){C.apply(this._ccFilter);this._commonCoord=this._ccFilter.getCommonCoordinate()};Ke.prototype.interfaces_=function(){return[]};Ke.prototype.getClass=function(){return Ke};Oj.CommonCoordinateFilter.get=
function(){return Af};Oj.Translater.get=function(){return Le};Object.defineProperties(Ke,Oj);var Af=function(){this._commonBitsX=new Lc;this._commonBitsY=new Lc};Af.prototype.filter=function(C){this._commonBitsX.add(C.x);this._commonBitsY.add(C.y)};Af.prototype.getCommonCoordinate=function(){return new sa(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Af.prototype.interfaces_=function(){return[Ee]};Af.prototype.getClass=function(){return Af};var Le=function(C){this.trans=C};Le.prototype.filter=
function(C,w){var x=C.getOrdinate(w,0)+this.trans.x,A=C.getOrdinate(w,1)+this.trans.y;C.setOrdinate(w,0,x);C.setOrdinate(w,1,A)};Le.prototype.isDone=function(){return!1};Le.prototype.isGeometryChanged=function(){return!0};Le.prototype.interfaces_=function(){return[Wd]};Le.prototype.getClass=function(){return Le};var tc=function(C,w){this._geom=Array(2).fill(null);this._cbr=this._snapTolerance=null;this._geom[0]=C;this._geom[1]=w;this.computeSnapTolerance()};tc.prototype.selfSnap=function(C){return(new pc(C)).snapTo(C,
this._snapTolerance)};tc.prototype.removeCommonBits=function(C){this._cbr=new Ke;this._cbr.add(C[0]);this._cbr.add(C[1]);var w=Array(2).fill(null);return w[0]=this._cbr.removeCommonBits(C[0].copy()),w[1]=this._cbr.removeCommonBits(C[1].copy()),w};tc.prototype.prepareResult=function(C){return this._cbr.addCommonBits(C),C};tc.prototype.getResultGeometry=function(C){var w=this.snap(this._geom);C=Za.overlayOp(w[0],w[1],C);return this.prepareResult(C)};tc.prototype.checkValid=function(C){C.isValid()||
Oc.out.println("Snapped geometry is invalid")};tc.prototype.computeSnapTolerance=function(){this._snapTolerance=pc.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};tc.prototype.snap=function(C){C=this.removeCommonBits(C);return pc.snap(C[0],C[1],this._snapTolerance)};tc.prototype.interfaces_=function(){return[]};tc.prototype.getClass=function(){return tc};tc.overlayOp=function(C,w,x){return(new tc(C,w)).getResultGeometry(x)};tc.union=function(C,w){return tc.overlayOp(C,w,Za.UNION)};tc.intersection=
function(C,w){return tc.overlayOp(C,w,Za.INTERSECTION)};tc.symDifference=function(C,w){return tc.overlayOp(C,w,Za.SYMDIFFERENCE)};tc.difference=function(C,w){return tc.overlayOp(C,w,Za.DIFFERENCE)};var Tc=function(C,w){this._geom=Array(2).fill(null);this._geom[0]=C;this._geom[1]=w};Tc.prototype.getResultGeometry=function(C){var w=null,x=!1,A=null;try{w=Za.overlayOp(this._geom[0],this._geom[1],C),x=!0}catch(D){if(!(D instanceof re))throw D;A=D}if(!x)try{w=tc.overlayOp(this._geom[0],this._geom[1],C)}catch(D){throw D instanceof
re?A:D;}return w};Tc.prototype.interfaces_=function(){return[]};Tc.prototype.getClass=function(){return Tc};Tc.overlayOp=function(C,w,x){return(new Tc(C,w)).getResultGeometry(x)};Tc.union=function(C,w){return Tc.overlayOp(C,w,Za.UNION)};Tc.intersection=function(C,w){return Tc.overlayOp(C,w,Za.INTERSECTION)};Tc.symDifference=function(C,w){return Tc.overlayOp(C,w,Za.SYMDIFFERENCE)};Tc.difference=function(C,w){return Tc.overlayOp(C,w,Za.DIFFERENCE)};var gh=function(C,w){this.mce=C;this.chainIndex=w};
gh.prototype.computeIntersections=function(C,w){this.mce.computeIntersectsForChain(this.chainIndex,C.mce,C.chainIndex,w)};gh.prototype.interfaces_=function(){return[]};gh.prototype.getClass=function(){return gh};var ad=function w(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var x=arguments[0],A=arguments[1];this._eventType=w.DELETE;this._xValue=x;this._insertEvent=A}else if(3===arguments.length){x=
arguments[0];A=arguments[1];var D=arguments[2];this._eventType=w.INSERT;this._label=x;this._xValue=A;this._obj=D}},Pj={INSERT:{configurable:!0},DELETE:{configurable:!0}};ad.prototype.isDelete=function(){return this._eventType===ad.DELETE};ad.prototype.setDeleteEventIndex=function(w){this._deleteEventIndex=w};ad.prototype.getObject=function(){return this._obj};ad.prototype.compareTo=function(w){return this._xValue<w._xValue?-1:this._xValue>w._xValue?1:this._eventType<w._eventType?-1:this._eventType>
w._eventType?1:0};ad.prototype.getInsertEvent=function(){return this._insertEvent};ad.prototype.isInsert=function(){return this._eventType===ad.INSERT};ad.prototype.isSameLabel=function(w){return null!==this._label&&this._label===w._label};ad.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};ad.prototype.interfaces_=function(){return[jd]};ad.prototype.getClass=function(){return ad};Pj.INSERT.get=function(){return 1};Pj.DELETE.get=function(){return 2};Object.defineProperties(ad,
Pj);var ki=function(){};ki.prototype.interfaces_=function(){return[]};ki.prototype.getClass=function(){return ki};var zc=function(w,x,A){this._hasProperInterior=this._hasProper=this._hasIntersection=!1;this._isSelfIntersection=this._properIntersectionPoint=null;this.numTests=this._numIntersections=0;this._bdyNodes=null;this._isDoneWhenProperInt=this._isDone=!1;this._li=w;this._includeProper=x;this._recordIsolated=A};zc.prototype.isTrivialIntersection=function(w,x,A,D){return w===A&&1===this._li.getIntersectionNum()&&
(zc.isAdjacentSegments(x,D)||w.isClosed()&&(w=w.getNumPoints()-1,0===x&&D===w||0===D&&x===w))?!0:!1};zc.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};zc.prototype.setIsDoneIfProperInt=function(w){this._isDoneWhenProperInt=w};zc.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};zc.prototype.isBoundaryPointInternal=function(w,x){for(x=x.iterator();x.hasNext();){var A=x.next().getCoordinate();if(w.isIntersection(A))return!0}return!1};
zc.prototype.hasProperIntersection=function(){return this._hasProper};zc.prototype.hasIntersection=function(){return this._hasIntersection};zc.prototype.isDone=function(){return this._isDone};zc.prototype.isBoundaryPoint=function(w,x){return null!==x&&(!!this.isBoundaryPointInternal(w,x[0])||!!this.isBoundaryPointInternal(w,x[1]))};zc.prototype.setBoundaryNodes=function(w,x){this._bdyNodes=Array(2).fill(null);this._bdyNodes[0]=w;this._bdyNodes[1]=x};zc.prototype.addIntersections=function(w,x,A,D){if(w===
A&&x===D)return null;this.numTests++;var G=w.getCoordinates()[x],P=w.getCoordinates()[x+1],S=A.getCoordinates()[D],V=A.getCoordinates()[D+1];this._li.computeIntersection(G,P,S,V);this._li.hasIntersection()&&(this._recordIsolated&&(w.setIsolated(!1),A.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(w,x,A,D)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(w.addIntersections(this._li,x,0),A.addIntersections(this._li,D,1)),this._li.isProper()&&(this._properIntersectionPoint=
this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};zc.prototype.interfaces_=function(){return[]};zc.prototype.getClass=function(){return zc};zc.isAdjacentSegments=function(w,x){return 1===Math.abs(w-x)};var Gp=function(w){function x(){w.call(this);this.events=new Fa;this.nOverlaps=null}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=
x,x.prototype.prepareEvents=function(){Kd.sort(this.events);for(var A=0;A<this.events.size();A++){var D=this.events.get(A);D.isDelete()&&D.getInsertEvent().setDeleteEventIndex(A)}},x.prototype.computeIntersections=function(){if(1===arguments.length){var A=arguments[0];this.nOverlaps=0;this.prepareEvents();for(var D=0;D<this.events.size();D++){var G=this.events.get(D);if(G.isInsert()&&this.processOverlaps(D,G.getDeleteEventIndex(),G,A),A.isDone())break}}else 3===arguments.length&&(arguments[2]instanceof
zc&&Va(arguments[0],ue)&&Va(arguments[1],ue)?(A=arguments[0],D=arguments[1],G=arguments[2],this.addEdges(A,A),this.addEdges(D,D),this.computeIntersections(G)):"boolean"==typeof arguments[2]&&Va(arguments[0],ue)&&arguments[1]instanceof zc&&(A=arguments[0],D=arguments[1],arguments[2]?this.addEdges(A,null):this.addEdges(A),this.computeIntersections(D)))},x.prototype.addEdge=function(A,D){A=A.getMonotoneChainEdge();for(var G=A.getStartIndexes(),P=0;P<G.length-1;P++){var S=new gh(A,P);S=new ad(D,A.getMinX(P),
S);this.events.add(S);this.events.add(new ad(A.getMaxX(P),S))}},x.prototype.processOverlaps=function(A,D,G,P){for(var S=G.getObject();A<D;A++){var V=this.events.get(A);if(V.isInsert()){var Z=V.getObject();G.isSameLabel(V)||(S.computeIntersections(Z,P),this.nOverlaps++)}}},x.prototype.addEdges=function(){if(1===arguments.length)for(var A=arguments[0].iterator();A.hasNext();){var D=A.next();this.addEdge(D,D)}else if(2===arguments.length)for(A=arguments[1],D=arguments[0].iterator();D.hasNext();){var G=
D.next();this.addEdge(G,A)}},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(ki),fe=function(){this._min=Wa.POSITIVE_INFINITY;this._max=Wa.NEGATIVE_INFINITY},Bn={NodeComparator:{configurable:!0}};fe.prototype.getMin=function(){return this._min};fe.prototype.intersects=function(w,x){return!(this._min>x||this._max<w)};fe.prototype.getMax=function(){return this._max};fe.prototype.toString=function(){return qe.toLineString(new sa(this._min,0),new sa(this._max,
0))};fe.prototype.interfaces_=function(){return[]};fe.prototype.getClass=function(){return fe};Bn.NodeComparator.get=function(){return hh};Object.defineProperties(fe,Bn);var hh=function(){};hh.prototype.compare=function(w,x){w=(w._min+w._max)/2;x=(x._min+x._max)/2;return w<x?-1:w>x?1:0};hh.prototype.interfaces_=function(){return[Rf]};hh.prototype.getClass=function(){return hh};var Hp=function(w){function x(A,D,G){w.call(this);this._min=A;this._max=D;this._item=G}return w&&(x.__proto__=w),x.prototype=
Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.query=function(A,D,G){if(!this.intersects(A,D))return null;G.visitItem(this._item)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(fe),Ip=function(w){function x(A,D){w.call(this);this._node1=A;this._node2=D;this.buildExtent(this._node1,this._node2)}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.buildExtent=function(A,D){this._min=
Math.min(A._min,D._min);this._max=Math.max(A._max,D._max)},x.prototype.query=function(A,D,G){if(!this.intersects(A,D))return null;null!==this._node1&&this._node1.query(A,D,G);null!==this._node2&&this._node2.query(A,D,G)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(fe),ge=function(){this._leaves=new Fa;this._root=null;this._level=0};ge.prototype.buildTree=function(){Kd.sort(this._leaves,new fe.NodeComparator);for(var w=this._leaves,x,A=new Fa;;){if(this.buildLevel(w,
A),1===A.size())return A.get(0);x=w;w=A;A=x}};ge.prototype.insert=function(w,x,A){if(null!==this._root)throw Error("Index cannot be added to once it has been queried");this._leaves.add(new Hp(w,x,A))};ge.prototype.query=function(w,x,A){this.init();this._root.query(w,x,A)};ge.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()};ge.prototype.printNode=function(w){Oc.out.println(qe.toLineString(new sa(w._min,this._level),new sa(w._max,this._level)))};ge.prototype.init=
function(){if(null!==this._root)return null;this.buildRoot()};ge.prototype.buildLevel=function(w,x){this._level++;x.clear();for(var A=0;A<w.size();A+=2){var D=w.get(A);null===(A+1<w.size()?w.get(A):null)?x.add(D):(D=new Ip(w.get(A),w.get(A+1)),x.add(D))}};ge.prototype.interfaces_=function(){return[]};ge.prototype.getClass=function(){return ge};var hg=function(){this._items=new Fa};hg.prototype.visitItem=function(w){this._items.add(w)};hg.prototype.getItems=function(){return this._items};hg.prototype.interfaces_=
function(){return[Ge]};hg.prototype.getClass=function(){return hg};var ig=function(w){this._index=null;if(!Va(w,Xe))throw new ac("Argument must be Polygonal");this._index=new cf(w)},Qj={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};ig.prototype.locate=function(w){var x=new Ed(w),A=new jg(x);return this._index.query(w.y,w.y,A),x.getLocation()};ig.prototype.interfaces_=function(){return[eg]};ig.prototype.getClass=function(){return ig};Qj.SegmentVisitor.get=function(){return jg};
Qj.IntervalIndexedGeometry.get=function(){return cf};Object.defineProperties(ig,Qj);var jg=function(w){this._counter=w};jg.prototype.visitItem=function(w){this._counter.countSegment(w.getCoordinate(0),w.getCoordinate(1))};jg.prototype.interfaces_=function(){return[Ge]};jg.prototype.getClass=function(){return jg};var cf=function(w){this._index=new ge;this.init(w)};cf.prototype.init=function(w){for(w=$c.getLines(w).iterator();w.hasNext();){var x=w.next().getCoordinates();this.addLine(x)}};cf.prototype.addLine=
function(w){for(var x=1;x<w.length;x++){var A=new Na(w[x-1],w[x]);this._index.insert(Math.min(A.p0.y,A.p1.y),Math.max(A.p0.y,A.p1.y),A)}};cf.prototype.query=function(){if(2===arguments.length){var w=arguments[0],x=arguments[1],A=new hg;return this._index.query(w,x,A),A.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])};cf.prototype.interfaces_=function(){return[]};cf.prototype.getClass=function(){return cf};var ih=function(w){function x(){if(w.call(this),this._parentGeom=
null,this._lineEdgeMap=new ln,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new de,2===arguments.length){var A=arguments[1],D=kd.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0];this._parentGeom=A;this._boundaryNodeRule=D;null!==A&&this.add(A)}else 3===arguments.length&&(A=arguments[1],D=arguments[2],this._argIndex=arguments[0],this._parentGeom=
A,this._boundaryNodeRule=D,null!==A&&this.add(A))}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.insertBoundaryPoint=function(A,D){D=this._nodes.addNode(D).getLabel();var G=1;D.getLocation(A,Aa.ON)===ua.BOUNDARY&&G++;G=x.determineBoundary(this._boundaryNodeRule,G);D.setLocation(A,G)},x.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var A=arguments[1],
D=arguments[2],G=new zc(arguments[0],!0,!1);G.setIsDoneIfProperInt(D);D=this.createEdgeSetIntersector();var P=this._parentGeom instanceof Yd||this._parentGeom instanceof Fd||this._parentGeom instanceof Fe;return D.computeIntersections(this._edges,G,A||!P),this.addSelfIntersectionNodes(this._argIndex),G}},x.prototype.computeSplitEdges=function(A){for(var D=this._edges.iterator();D.hasNext();)D.next().eiList.addSplitEdges(A)},x.prototype.computeEdgeIntersections=function(A,D,G){D=new zc(D,G,!0);return D.setBoundaryNodes(this.getBoundaryNodes(),
A.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,A._edges,D),D},x.prototype.getGeometry=function(){return this._parentGeom},x.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},x.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},x.prototype.addPoint=function(A){A instanceof Xd?(A=A.getCoordinate(),this.insertPoint(this._argIndex,A,ua.INTERIOR)):A instanceof sa&&this.insertPoint(this._argIndex,A,ua.INTERIOR)},x.prototype.addPolygon=
function(A){this.addPolygonRing(A.getExteriorRing(),ua.EXTERIOR,ua.INTERIOR);for(var D=0;D<A.getNumInteriorRing();D++){var G=A.getInteriorRingN(D);this.addPolygonRing(G,ua.INTERIOR,ua.EXTERIOR)}},x.prototype.addEdge=function(A){this.insertEdge(A);A=A.getCoordinates();this.insertPoint(this._argIndex,A[0],ua.BOUNDARY);this.insertPoint(this._argIndex,A[A.length-1],ua.BOUNDARY)},x.prototype.addLineString=function(A){var D=ab.removeRepeatedPoints(A.getCoordinates());if(2>D.length)return this._hasTooFewPoints=
!0,this._invalidPoint=D[0],null;var G=new ji(D,new Jb(this._argIndex,ua.INTERIOR));this._lineEdgeMap.put(A,G);this.insertEdge(G);Xa.isTrue(2<=D.length,"found LineString with single point");this.insertBoundaryPoint(this._argIndex,D[0]);this.insertBoundaryPoint(this._argIndex,D[D.length-1])},x.prototype.getInvalidPoint=function(){return this._invalidPoint},x.prototype.getBoundaryPoints=function(){var A=this.getBoundaryNodes(),D=Array(A.size()).fill(null),G=0;for(A=A.iterator();A.hasNext();){var P=A.next();
D[G++]=P.getCoordinate().copy()}return D},x.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},x.prototype.addSelfIntersectionNode=function(A,D,G){if(this.isBoundaryNode(A,D))return null;G===ua.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(A,D):this.insertPoint(A,D,G)},x.prototype.addPolygonRing=function(A,D,G){if(A.isEmpty())return null;var P=ab.removeRepeatedPoints(A.getCoordinates());
if(4>P.length)return this._hasTooFewPoints=!0,this._invalidPoint=P[0],null;var S=D,V=G;Da.isCCW(P)&&(S=G,V=D);D=new ji(P,new Jb(this._argIndex,ua.BOUNDARY,S,V));this._lineEdgeMap.put(A,D);this.insertEdge(D);this.insertPoint(this._argIndex,P[0],ua.BOUNDARY)},x.prototype.insertPoint=function(A,D,G){D=this._nodes.addNode(D);var P=D.getLabel();null===P?D._label=new Jb(A,G):P.setLocation(A,G)},x.prototype.createEdgeSetIntersector=function(){return new Gp},x.prototype.addSelfIntersectionNodes=function(A){for(var D=
this._edges.iterator();D.hasNext();){var G=D.next(),P=G.getLabel().getLocation(A);for(G=G.eiList.iterator();G.hasNext();){var S=G.next();this.addSelfIntersectionNode(A,S.coord,P)}}},x.prototype.add=function(){if(1!==arguments.length)return w.prototype.add.apply(this,arguments);var A=arguments[0];if(A.isEmpty())return null;if(A instanceof Fe&&(this._useBoundaryDeterminationRule=!1),A instanceof Fd)this.addPolygon(A);else if(A instanceof Hc)this.addLineString(A);else if(A instanceof Xd)this.addPoint(A);
else{if(!(A instanceof ag||A instanceof We||A instanceof Fe||A instanceof ud))throw Error(A.getClass().getName());this.addCollection(A)}},x.prototype.addCollection=function(A){for(var D=0;D<A.getNumGeometries();D++){var G=A.getGeometryN(D);this.add(G)}},x.prototype.locate=function(A){return Va(this._parentGeom,Xe)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new ig(this._parentGeom)),this._areaPtLocator.locate(A)):this._ptLocator.locate(A,this._parentGeom)},
x.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):w.prototype.findEdge.apply(this,arguments)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x.determineBoundary=function(A,D){return A.isInBoundary(D)?ua.BOUNDARY:ua.INTERIOR},x}(Yb),kg=function(){if(this._li=new Te,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var w=arguments[0];this.setComputationPrecision(w.getPrecisionModel());this._arg=
Array(1).fill(null);this._arg[0]=new ih(0,w)}else if(2===arguments.length){w=arguments[0];var x=arguments[1],A=kd.OGC_SFS_BOUNDARY_RULE;0<=w.getPrecisionModel().compareTo(x.getPrecisionModel())?this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(x.getPrecisionModel());this._arg=Array(2).fill(null);this._arg[0]=new ih(0,w,A);this._arg[1]=new ih(1,x,A)}else 3===arguments.length&&(w=arguments[0],x=arguments[1],A=arguments[2],0<=w.getPrecisionModel().compareTo(x.getPrecisionModel())?
this.setComputationPrecision(w.getPrecisionModel()):this.setComputationPrecision(x.getPrecisionModel()),this._arg=Array(2).fill(null),this._arg[0]=new ih(0,w,A),this._arg[1]=new ih(1,x,A))};kg.prototype.getArgGeometry=function(w){return this._arg[w].getGeometry()};kg.prototype.setComputationPrecision=function(w){this._resultPrecisionModel=w;this._li.setPrecisionModel(this._resultPrecisionModel)};kg.prototype.interfaces_=function(){return[]};kg.prototype.getClass=function(){return kg};var df=function(){};
df.prototype.interfaces_=function(){return[]};df.prototype.getClass=function(){return df};df.map=function(w,x){if(w instanceof Ra&&Va(x,df.MapOp)){for(var A=new Fa,D=0;D<w.getNumGeometries();D++){var G=x.map(w.getGeometryN(D));null!==G&&A.add(G)}return w.getFactory().buildGeometry(A)}if(Va(w,kc)&&Va(x,df.MapOp)){A=new Fa;for(w=w.iterator();w.hasNext();)D=w.next(),D=x.map(D),null!==D&&A.add(D);return A}};df.MapOp=function(){};var Za=function(w){function x(A,D){w.call(this,A,D);this._ptLocator=new de;
this._graph=this._resultGeom=this._geomFact=null;this._edgeList=new wd;this._resultPolyList=new Fa;this._resultLineList=new Fa;this._resultPointList=new Fa;this._graph=new Yb(new tn);this._geomFact=A.getFactory()}return w&&(x.__proto__=w),x.prototype=Object.create(w&&w.prototype),x.prototype.constructor=x,x.prototype.insertUniqueEdge=function(A){var D=this._edgeList.findEqualEdge(A);if(null!==D){var G=D.getLabel(),P=A.getLabel();D.isPointwiseEqual(A)||(P=new Jb(A.getLabel())).flip();A=D.getDepth();
A.isNull()&&A.add(G);A.add(P);G.merge(P)}else this._edgeList.add(A)},x.prototype.getGraph=function(){return this._graph},x.prototype.cancelDuplicateResultEdges=function(){for(var A=this._graph.getEdgeEnds().iterator();A.hasNext();){var D=A.next(),G=D.getSym();D.isInResult()&&G.isInResult()&&(D.setInResult(!1),G.setInResult(!1))}},x.prototype.isCoveredByLA=function(A){return!!this.isCovered(A,this._resultLineList)||!!this.isCovered(A,this._resultPolyList)},x.prototype.computeGeometry=function(A,D,
G,P){var S=new Fa;return S.addAll(A),S.addAll(D),S.addAll(G),S.isEmpty()?x.createEmptyResult(P,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(S)},x.prototype.mergeSymLabels=function(){for(var A=this._graph.getNodes().iterator();A.hasNext();)A.next().getEdges().mergeSymLabels()},x.prototype.isCovered=function(A,D){for(D=D.iterator();D.hasNext();){var G=D.next();if(this._ptLocator.locate(A,G)!==ua.EXTERIOR)return!0}return!1},x.prototype.replaceCollapsedEdges=
function(){for(var A=new Fa,D=this._edgeList.iterator();D.hasNext();){var G=D.next();G.isCollapsed()&&(D.remove(),A.add(G.getCollapsedEdge()))}this._edgeList.addAll(A)},x.prototype.updateNodeLabelling=function(){for(var A=this._graph.getNodes().iterator();A.hasNext();){var D=A.next(),G=D.getEdges().getLabel();D.getLabel().merge(G)}},x.prototype.getResultGeometry=function(A){return this.computeOverlay(A),this._resultGeom},x.prototype.insertUniqueEdges=function(A){for(A=A.iterator();A.hasNext();){var D=
A.next();this.insertUniqueEdge(D)}},x.prototype.computeOverlay=function(A){this.copyPoints(0);this.copyPoints(1);this._arg[0].computeSelfNodes(this._li,!1);this._arg[1].computeSelfNodes(this._li,!1);this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var D=new Fa;this._arg[0].computeSplitEdges(D);this._arg[1].computeSplitEdges(D);this.insertUniqueEdges(D);this.computeLabelsFromDepths();this.replaceCollapsedEdges();bf.checkValid(this._edgeList.getEdges());this._graph.addEdges(this._edgeList.getEdges());
this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(A);this.cancelDuplicateResultEdges();D=new Yc(this._geomFact);D.add(this._graph);this._resultPolyList=D.getPolygons();this._resultLineList=(new Pd(this,this._geomFact,this._ptLocator)).build(A);this._resultPointList=(new zf(this,this._geomFact,this._ptLocator)).build(A);this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,A)},x.prototype.labelIncompleteNode=function(A,D){var G=
this._ptLocator.locate(A.getCoordinate(),this._arg[D].getGeometry());A.getLabel().setLocation(D,G)},x.prototype.copyPoints=function(A){for(var D=this._arg[A].getNodeIterator();D.hasNext();){var G=D.next();this._graph.addNode(G.getCoordinate()).setLabel(A,G.getLabel().getLocation(A))}},x.prototype.findResultAreaEdges=function(A){for(var D=this._graph.getEdgeEnds().iterator();D.hasNext();){var G=D.next(),P=G.getLabel();P.isArea()&&!G.isInteriorAreaEdge()&&x.isResultOfOp(P.getLocation(0,Aa.RIGHT),P.getLocation(1,
Aa.RIGHT),A)&&G.setInResult(!0)}},x.prototype.computeLabelsFromDepths=function(){for(var A=this._edgeList.iterator();A.hasNext();){var D=A.next(),G=D.getLabel();D=D.getDepth();if(!D.isNull()){D.normalize();for(var P=0;2>P;P++)G.isNull(P)||!G.isArea()||D.isNull(P)||(0===D.getDelta(P)?G.toLine(P):(Xa.isTrue(!D.isNull(P,Aa.LEFT),"depth of LEFT side has not been initialized"),G.setLocation(P,Aa.LEFT,D.getLocation(P,Aa.LEFT)),Xa.isTrue(!D.isNull(P,Aa.RIGHT),"depth of RIGHT side has not been initialized"),
G.setLocation(P,Aa.RIGHT,D.getLocation(P,Aa.RIGHT))))}}},x.prototype.computeLabelling=function(){for(var A=this._graph.getNodes().iterator();A.hasNext();)A.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels();this.updateNodeLabelling()},x.prototype.labelIncompleteNodes=function(){for(var A=this._graph.getNodes().iterator();A.hasNext();){var D=A.next(),G=D.getLabel();D.isIsolated()&&(G.isNull(0)?this.labelIncompleteNode(D,0):this.labelIncompleteNode(D,1));D.getEdges().updateLabelling(G)}},
x.prototype.isCoveredByA=function(A){return!!this.isCovered(A,this._resultPolyList)},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x},x}(kg);Za.overlayOp=function(w,x,A){return(new Za(w,x)).getResultGeometry(A)};Za.intersection=function(w,x){return w.isEmpty()||x.isEmpty()?Za.createEmptyResult(Za.INTERSECTION,w,x,w.getFactory()):w.isGeometryCollection()?yf.map(w,{interfaces_:function(){return[df.MapOp]},map:function(A){return A.intersection(x)}}):(w.checkNotGeometryCollection(w),
w.checkNotGeometryCollection(x),Tc.overlayOp(w,x,Za.INTERSECTION))};Za.symDifference=function(w,x){if(w.isEmpty()||x.isEmpty()){if(w.isEmpty()&&x.isEmpty())return Za.createEmptyResult(Za.SYMDIFFERENCE,w,x,w.getFactory());if(w.isEmpty())return x.copy();if(x.isEmpty())return w.copy()}return w.checkNotGeometryCollection(w),w.checkNotGeometryCollection(x),Tc.overlayOp(w,x,Za.SYMDIFFERENCE)};Za.resultDimension=function(w,x,A){x=x.getDimension();A=A.getDimension();var D=-1;switch(w){case Za.INTERSECTION:D=
Math.min(x,A);break;case Za.UNION:D=Math.max(x,A);break;case Za.DIFFERENCE:D=x;break;case Za.SYMDIFFERENCE:D=Math.max(x,A)}return D};Za.createEmptyResult=function(w,x,A,D){var G=null;switch(Za.resultDimension(w,x,A)){case -1:G=D.createGeometryCollection([].fill(null));break;case 0:G=D.createPoint();break;case 1:G=D.createLineString();break;case 2:G=D.createPolygon()}return G};Za.difference=function(w,x){return w.isEmpty()?Za.createEmptyResult(Za.DIFFERENCE,w,x,w.getFactory()):x.isEmpty()?w.copy():
(w.checkNotGeometryCollection(w),w.checkNotGeometryCollection(x),Tc.overlayOp(w,x,Za.DIFFERENCE))};Za.isResultOfOp=function(){if(2===arguments.length){var w=arguments[0],x=arguments[1],A=w.getLocation(0);w=w.getLocation(1);return Za.isResultOfOp(A,w,x)}if(3===arguments.length){x=arguments[0];A=arguments[1];w=arguments[2];switch(x===ua.BOUNDARY&&(x=ua.INTERIOR),A===ua.BOUNDARY&&(A=ua.INTERIOR),w){case Za.INTERSECTION:return x===ua.INTERIOR&&A===ua.INTERIOR;case Za.UNION:return x===ua.INTERIOR||A===
ua.INTERIOR;case Za.DIFFERENCE:return x===ua.INTERIOR&&A!==ua.INTERIOR;case Za.SYMDIFFERENCE:return x===ua.INTERIOR&&A!==ua.INTERIOR||x!==ua.INTERIOR&&A===ua.INTERIOR}return!1}};Za.INTERSECTION=1;Za.UNION=2;Za.DIFFERENCE=3;Za.SYMDIFFERENCE=4;Sd.prototype={constructor:Sd,reset:function(){this.s=this.t=0},add:function(w){dm(li,w,this.t);dm(this,li.s,this.s);this.s?this.t+=li.t:this.s=li.t},valueOf:function(){return this.s}};var li=new Sd,Nb=Math.PI,me=Nb/2,sm=Nb/4,ne=2*Nb,Re=180/Nb,Bd=Nb/180,Fc=Math.abs,
Jp=Math.atan,Of=Math.atan2,lc=Math.cos,mc=Math.sin,Jg=Math.sqrt,wm={Feature:function(w,x){Nh(w.geometry,x)},FeatureCollection:function(w,x){w=w.features;for(var A=-1,D=w.length;++A<D;)Nh(w[A].geometry,x)}},fm={Sphere:function(w,x){x.sphere()},Point:function(w,x){w=w.coordinates;x.point(w[0],w[1],w[2])},MultiPoint:function(w,x){for(var A=w.coordinates,D=-1,G=A.length;++D<G;)w=A[D],x.point(w[0],w[1],w[2])},LineString:function(w,x){jj(w.coordinates,x,0)},MultiLineString:function(w,x){w=w.coordinates;
for(var A=-1,D=w.length;++A<D;)jj(w[A],x,0)},Polygon:function(w,x){gm(w.coordinates,x)},MultiPolygon:function(w,x){w=w.coordinates;for(var A=-1,D=w.length;++A<D;)gm(w[A],x)},GeometryCollection:function(w,x){w=w.geometries;for(var A=-1,D=w.length;++A<D;)Nh(w[A],x)}};new Sd;new Sd;new Sd;nj.invert=nj;var oj=new Sd;new Sd;new Sd;new Sd;var lg=1/0,mi=lg,jh=-lg,ni=jh,vm={point:function(w,x){w<lg&&(lg=w);w>jh&&(jh=w);x<mi&&(mi=x);x>ni&&(ni=x)},lineStart:Ig,lineEnd:Ig,polygonStart:Ig,polygonEnd:Ig,result:function(){var w=
[[lg,mi],[jh,ni]];return jh=ni=-(mi=lg=1/0),w}};new Sd;var ym=rm(function(){return!0},function(w){var x,A=NaN,D=NaN,G=NaN;return{lineStart:function(){w.lineStart();x=1},point:function(P,S){var V=0<P?Nb:-Nb,Z=Fc(P-A);if(1E-6>Fc(Z-Nb))w.point(A,D=0<(D+S)/2?me:-me),w.point(G,D),w.lineEnd(),w.lineStart(),w.point(V,D),w.point(P,D),x=0;else if(G!==V&&Z>=Nb){1E-6>Fc(A-G)&&(A-=1E-6*G);1E-6>Fc(P-V)&&(P-=1E-6*V);Z=A;var X=D,ea=P,na,qa,ia=mc(Z-ea);D=1E-6<Fc(ia)?Jp((mc(X)*(qa=lc(S))*mc(ea)-mc(S)*(na=lc(X))*mc(Z))/
(na*qa*ia)):(X+S)/2;w.point(G,D);w.lineEnd();w.lineStart();w.point(V,D);x=0}w.point(A=P,D=S);G=V},lineEnd:function(){w.lineEnd();A=D=NaN},clean:function(){return 2-x}}},function(w,x,A,D){null==w?(A*=me,D.point(-Nb,A),D.point(0,A),D.point(Nb,A),D.point(Nb,0),D.point(Nb,-A),D.point(0,-A),D.point(-Nb,-A),D.point(-Nb,0),D.point(-Nb,A)):1E-6<Fc(w[0]-x[0])?(w=w[0]<x[0]?Nb:-Nb,A=A*w/2,D.point(-w,A),D.point(0,A),D.point(w,A)):D.point(x[0],x[1])},[-Nb,-me]);pj.prototype={constructor:pj,point:function(w,x){this.stream.point(w,
x)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var No=lc(30*Bd),Po=tm({point:function(w,x){this.stream.point(w*Bd,x*Bd)}}),zm=function(w){return function(x,A){var D=lc(x),G=lc(A);D=w(D*G);return[D*G*mc(x),D*mc(A)]}}(function(w){return(w=em(w))&&w/mc(w)});zm.invert=function(w){return function(x,A){var D=Jg(x*x+A*A),
G=w(D),P=mc(G);G=lc(G);return[Of(x*P,D*G),Nf(D&&A*P/D)]}}(function(w){return w});a.along=function(w,x,A){void 0===A&&(A={});w=Ib(w).coordinates;for(var D=0,G=0;G<w.length&&!(x>=D&&G===w.length-1);G++){if(D>=x)return(x-=D)?(D=Ae(w[G],w[G-1])-180,je(w[G],x,D,A)):u(w[G]);D+=Lb(w[G],w[G+1],A)}return u(w[w.length-1])};a.angle=function(w,x,A,D){if(void 0===D&&(D={}),!ta(D))throw Error("options is invalid");if(!w)throw Error("startPoint is required");if(!x)throw Error("midPoint is required");if(!A)throw Error("endPoint is required");
w=da(!0!==D.mercator?Ae(w,x):lf(w,x));x=da(!0!==D.mercator?Ae(A,x):lf(A,x));x=Math.abs(w-x);return!0===D.explementary?360-x:x};a.applyFilter=Kh;a.area=Li;a.areaFactors=nh;a.bbox=ya;a.bboxClip=function(w,x){var A=Ib(w),D=A.type;w="Feature"===w.type?w.properties:{};A=A.coordinates;switch(D){case "LineString":case "MultiLineString":var G=[];return"LineString"===D&&(A=[A]),A.forEach(function(P){var S=G,V,Z,X,ea,na=P.length,qa=Ff(P[0],x),ia=[];S||=[];for(V=1;V<na;V++){var ra=P[V-1];for(Z=X=Ff(ea=P[V],
x);;){if(!(qa|Z)){ia.push(ra);Z!==X?(ia.push(ea),V<na-1&&(S.push(ia),ia=[])):V===na-1&&ia.push(ea);break}if(qa&Z)break;qa?qa=Ff(ra=Ri(ra,ea,qa,x),x):Z=Ff(ea=Ri(ra,ea,Z,x),x)}qa=X}ia.length&&S.push(ia);!0}),1===G.length?K(G[0],w):H(G,w);case "Polygon":return E(al(A,x),w);case "MultiPolygon":return T(A.map(function(P){return al(P,x)}),w);default:throw Error("geometry "+D+" not supported");}};a.bboxPolygon=Ci;a.bearing=Ae;a.bearingToAngle=da;a.bearingToAzimuth=da;a.bezier=qk;a.bezierSpline=qk;a.booleanClockwise=
Dh;a.booleanContains=function(w,x){w=Ib(w);x=Ib(x);var A=w.type,D=x.type,G=w.coordinates,P=x.coordinates;switch(A){case "Point":switch(D){case "Point":return Vi(G,P);default:throw Error("feature2 "+D+" geometry not supported");}case "MultiPoint":switch(D){case "Point":return function(S,V){var Z,X=!1;for(Z=0;Z<S.coordinates.length;Z++)if(Vi(S.coordinates[Z],V.coordinates)){X=!0;break}return X}(w,x);case "MultiPoint":return function(S,V){var Z=0;for(V=V.coordinates;Z<V.length;Z++){for(var X=V[Z],ea=
!1,na=0,qa=S.coordinates;na<qa.length;na++)if(Vi(X,qa[na])){ea=!0;break}if(!ea)return!1}return!0}(w,x);default:throw Error("feature2 "+D+" geometry not supported");}case "LineString":switch(D){case "Point":return hd(x,w,{ignoreEndVertices:!0});case "LineString":return function(S,V){var Z=!1,X=0;for(V=V.coordinates;X<V.length;X++){var ea=V[X];if(hd({type:"Point",coordinates:ea},S,{ignoreEndVertices:!0})&&(Z=!0),!hd({type:"Point",coordinates:ea},S,{ignoreEndVertices:!1}))return!1}return Z}(w,x);case "MultiPoint":return function(S,
V){var Z=!1,X=0;for(V=V.coordinates;X<V.length;X++){var ea=V[X];if(hd(ea,S,{ignoreEndVertices:!0})&&(Z=!0),!hd(ea,S))return!1}return Z?!0:!1}(w,x);default:throw Error("feature2 "+D+" geometry not supported");}case "Polygon":switch(D){case "Point":return Tb(x,w,{ignoreBoundary:!0});case "LineString":return function(S,V){var Z=!1,X=0,ea=ya(S),na=ya(V);if(!rl(ea,na))return!1;for(;X<V.coordinates.length-1;X++)if(ea=V.coordinates[X],na=V.coordinates[X+1],Tb({type:"Point",coordinates:[(ea[0]+na[0])/2,(ea[1]+
na[1])/2]},S,{ignoreBoundary:!0})){Z=!0;break}return Z}(w,x);case "Polygon":return function(S,V){if("Feature"===S.type&&null===S.geometry||"Feature"===V.type&&null===V.geometry)return!1;var Z=ya(S),X=ya(V);if(!rl(Z,X))return!1;Z=0;for(V=Ib(V).coordinates;Z<V.length;Z++){X=0;for(var ea=V[Z];X<ea.length;X++)if(!Tb(ea[X],S))return!1}return!0}(w,x);case "MultiPoint":return function(S,V){var Z=0;for(V=V.coordinates;Z<V.length;Z++)if(!Tb(V[Z],S,{ignoreBoundary:!0}))return!1;return!0}(w,x);default:throw Error("feature2 "+
D+" geometry not supported");}default:throw Error("feature1 "+A+" geometry not supported");}};a.booleanCrosses=function(w,x){w=Ib(w);x=Ib(x);var A=w.type,D=x.type;switch(A){case "MultiPoint":switch(D){case "LineString":return sl(w,x);case "Polygon":return ul(w,x);default:throw Error("feature2 "+D+" geometry not supported");}case "LineString":switch(D){case "MultiPoint":return sl(x,w);case "LineString":a:{if(0<ke(w,x).features.length)for(A=0;A<w.coordinates.length-1;A++)for(D=0;D<x.coordinates.length-
1;D++){var G=!0;if(0!==D&&D!==x.coordinates.length-2||(G=!1),tl(w.coordinates[A],w.coordinates[A+1],x.coordinates[D],G)){w=!0;break a}}w=!1}return w;case "Polygon":return 0<ke(w,Qi(x)).features.length;default:throw Error("feature2 "+D+" geometry not supported");}case "Polygon":switch(D){case "MultiPoint":return ul(x,w);case "LineString":return 0<ke(x,Qi(w)).features.length;default:throw Error("feature2 "+D+" geometry not supported");}default:throw Error("feature1 "+A+" geometry not supported");}};
a.booleanDisjoint=ol;a.booleanEqual=function(w,x){return Ib(w).type===Ib(x).type&&(new Td({precision:6})).compare(hf(w),hf(x))};a.booleanIntersects=xl;a.booleanOverlap=function(w,x){var A=Ib(w),D=Ib(x),G=A.type,P=D.type;if("MultiPoint"===G&&"MultiPoint"!==P||("LineString"===G||"MultiLineString"===G)&&"LineString"!==P&&"MultiLineString"!==P||("Polygon"===G||"MultiPolygon"===G)&&"Polygon"!==P&&"MultiPolygon"!==P)throw Error("features must be of the same type");if("Point"===G)throw Error("Point geometry not supported");
if((new Td({precision:6})).compare(w,x))return!1;var S=0;switch(G){case "MultiPoint":for(w=0;w<A.coordinates.length;w++)for(G=0;G<D.coordinates.length;G++){P=A.coordinates[w];var V=D.coordinates[G];if(P[0]===V[0]&&P[1]===V[1])return!0}return!1;case "LineString":case "MultiLineString":L(w,function(Z){L(x,function(X){bl(Z,X).features.length&&S++})});break;case "Polygon":case "MultiPolygon":L(w,function(Z){L(x,function(X){ke(Z,X).features.length&&S++})})}return 0<S};a.booleanParallel=function(w,x){if(!w)throw Error("line1 is required");
if(!x)throw Error("line2 is required");if("LineString"!==zl(w,"line1"))throw Error("line1 must be a LineString");if("LineString"!==zl(x,"line2"))throw Error("line2 must be a LineString");w=kf(hf(w)).features;x=kf(hf(x)).features;for(var A=0;A<w.length;A++){var D=w[A].geometry.coordinates;if(!x[A])break;var G=x[A].geometry.coordinates;if(da(lf(D[0],D[1]))!==da(lf(G[0],G[1])))return!1}return!0};a.booleanPointInPolygon=Tb;a.booleanPointOnLine=hd;a.booleanWithin=Mk;a.buffer=function(w,x,A){var D=(A=A||
{}).units||"kilometers",G=A.steps||8;if(!w)throw Error("geojson is required");if("object"!=typeof A)throw Error("options must be an object");if("number"!=typeof G)throw Error("steps must be an number");if(void 0===x)throw Error("radius is required");if(0>=G)throw Error("steps must be greater than 0");var P=[];switch(w.type){case "GeometryCollection":return Zb(w,function(S){(S=Th(S,x,D,G))&&P.push(S)}),J(P);case "FeatureCollection":return Sa(w,function(S){(S=Th(S,x,D,G))&&Sa(S,function(V){V&&P.push(V)})}),
J(P)}return Th(w,x,D,G)};a.center=wh;a.centerMean=Zi;a.centerMedian=function(w,x){if(void 0===x&&(x={}),!ta(x=x||{}))throw Error("options is invalid");var A=x.counter||10;if(!la(A))throw Error("counter must be a number");var D=x.weight,G=Zi(w,{weight:x.weight}),P=J([]);Sa(w,function(S){var V;P.features.push(Ne(S,{properties:{weight:null===(V=S.properties)||void 0===V?void 0:V[D]}}))});return Kl(G.geometry.coordinates,[0,0],P,{tolerance:x.tolerance,medianCandidates:[]},A)};a.centerOfMass=function D(x,
A){switch(void 0===A&&(A={}),qc(x)){case "Point":return u(aa(x),A.properties);case "Polygon":var G=[];Ca(x,function(Ma){G.push(Ma)});var P,S,V,Z,X=Ne(x,{properties:A.properties}),ea=X.geometry.coordinates,na=x=0,qa=0,ia=G.map(function(Ma){return[Ma[0]-ea[0],Ma[1]-ea[1]]});for(P=0;P<G.length-1;P++){var ra=(S=ia[P])[0];var ja=S[1];S=(V=ia[P+1])[0];qa+=Z=ra*(V=V[1])-S*ja;x+=(ra+S)*Z;na+=(ja+V)*Z}if(0===qa)return X;P=1/(3*qa);return u([ea[0]+P*x,ea[1]+P*na],A.properties);default:return(na=bk(x))?D(na,
{properties:A.properties}):Ne(x,{properties:A.properties})}};a.centroid=Ne;a.circle=Di;a.cleanCoords=hf;a.clone=Dc;a.clusterEach=$i;a.clusterReduce=Yl;a.clusters=kp;a.clustersDbscan=function(x,A,D){void 0===D&&(D={});!0!==D.mutate&&(x=Dc(x));D.minPoints=D.minPoints||3;var G=new ep.DBSCAN,P=-1;return G.run(uc(x),ka(A,D.units),D.minPoints,Lb).forEach(function(S){P++;S.forEach(function(V){V=x.features[V];V.properties||(V.properties={});V.properties.cluster=P;V.properties.dbscan="core"})}),G.noise.forEach(function(S){S=
x.features[S];S.properties||(S.properties={});S.properties.cluster?S.properties.dbscan="edge":S.properties.dbscan="noise"}),x};a.clustersKmeans=function(x,A){void 0===A&&(A={});var D=x.features.length;A.numberOfClusters=A.numberOfClusters||Math.round(Math.sqrt(D/2));A.numberOfClusters>D&&(A.numberOfClusters=D);!0!==A.mutate&&(x=Dc(x));D=uc(x);var G=D.slice(0,A.numberOfClusters),P=hp(D,A.numberOfClusters,G),S={};return P.centroids.forEach(function(V,Z){S[Z]=V}),Sa(x,function(V,Z){Z=P.idxs[Z];V.properties.cluster=
Z;V.properties.centroid=S[Z]}),x};a.collect=function(x,A,D,G){var P=Uc(6);A=A.features.map(function(S){var V;return{minX:S.geometry.coordinates[0],minY:S.geometry.coordinates[1],maxX:S.geometry.coordinates[0],maxY:S.geometry.coordinates[1],property:null===(V=S.properties)||void 0===V?void 0:V[D]}});return P.load(A),x.features.forEach(function(S){S.properties||(S.properties={});var V=ya(S),Z=[];P.search({minX:V[0],minY:V[1],maxX:V[2],maxY:V[3]}).forEach(function(X){Tb([X.minX,X.minY],S)&&Z.push(X.property)});
S.properties[G]=Z}),x};a.collectionOf=Ka;a.combine=function(x){var A={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return Sa(x,function(D){var G,P,S,V;switch(null===(V=D.geometry)||void 0===V?void 0:V.type){case "Point":A.MultiPoint.coordinates.push(D.geometry.coordinates);A.MultiPoint.properties.push(D.properties);break;case "MultiPoint":(G=A.MultiPoint.coordinates).push.apply(G,D.geometry.coordinates);A.MultiPoint.properties.push(D.properties);
break;case "LineString":A.MultiLineString.coordinates.push(D.geometry.coordinates);A.MultiLineString.properties.push(D.properties);break;case "MultiLineString":(P=A.MultiLineString.coordinates).push.apply(P,D.geometry.coordinates);A.MultiLineString.properties.push(D.properties);break;case "Polygon":A.MultiPolygon.coordinates.push(D.geometry.coordinates);A.MultiPolygon.properties.push(D.properties);break;case "MultiPolygon":(S=A.MultiPolygon.coordinates).push.apply(S,D.geometry.coordinates),A.MultiPolygon.properties.push(D.properties)}}),
J(Object.keys(A).filter(function(D){return A[D].coordinates.length}).sort().map(function(D){return g({type:D,coordinates:A[D].coordinates},{collectedProperties:A[D].properties})}))};a.concave=function(x,A){void 0===A&&(A={});var D=A.maxEdge||1/0;x=ek(function(G){var P=[],S={};return Sa(G,function(V){if(V.geometry){var Z=V.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(S,Z)||(P.push(V),S[Z]=!0)}}),J(P)}(x));if(x.features=x.features.filter(function(G){var P=G.geometry.coordinates[0][0],
S=G.geometry.coordinates[0][1],V=G.geometry.coordinates[0][2];G=Lb(P,S,A);S=Lb(S,V,A);P=Lb(P,V,A);return G<=D&&S<=D&&P<=D}),1>x.features.length)return null;x=Tn(x);return 1===x.coordinates.length&&(x.coordinates=x.coordinates[0],x.type="Polygon"),g(x)};a.containsNumber=xa;a.convertArea=pa;a.convertDistance=ka;a.convertLength=ka;a.convex=bk;a.coordAll=uc;a.coordEach=Ca;a.coordReduce=Vb;a.createBins=aj;a.degrees2radians=ma;a.degreesToRadians=ma;a.destination=je;a.difference=function(x,A){var D=Ib(x);
A=Ib(A);x=x.properties||{};D=Ce.difference(D.coordinates,A.coordinates);return 0===D.length?null:1===D.length?E(D[0],x):T(D,x)};a.dissolve=function(x,A){if(!ta(A=A||{}))throw Error("options is invalid");var D=A.propertyName;Ka(x,"Polygon","dissolve");var G=[];if(!A.propertyName)return Ni(T(Ce.union.apply(null,x.features.map(function(V){return V.geometry.coordinates}))));var P={};Sa(x,function(V){Object.prototype.hasOwnProperty.call(P,V.properties[D])||(P[V.properties[D]]=[]);P[V.properties[D]].push(V)});
x=Object.keys(P);for(A=0;A<x.length;A++){var S=T(Ce.union.apply(null,P[x[A]].map(function(V){return V.geometry.coordinates})));S.properties[D]=x[A];G.push(S)}return Ni(J(G))};a.distance=Lb;a.distanceToDegrees=R;a.distanceToRadians=fa;a.distanceWeight=Ml;a.earthRadius=6371008.8;a.ellipse=Jl;a.envelope=rk;a.explode=xh;a.factors=mh;a.feature=g;a.featureCollection=J;a.featureEach=Sa;a.featureOf=Ob;a.featureReduce=Ya;a.filterProperties=Zl;a.findPoint=Ba;a.findSegment=oa;a.flatten=Ni;a.flattenEach=Rb;a.flattenReduce=
Me;a.flip=function(x,A){if(!ta(A=A||{}))throw Error("options is invalid");A=A.mutate;if(!x)throw Error("geojson is required");return!1!==A&&void 0!==A||(x=Dc(x)),Ca(x,function(D){var G=D[0];D[0]=D[1];D[1]=G}),x};a.geojsonType=Oa;a.geomEach=Zb;a.geomReduce=pd;a.geometry=q;a.geometryCollection=O;a.getCluster=Xl;a.getCoord=aa;a.getCoords=Y;a.getGeom=Ib;a.getType=qc;a.greatCircle=function(x,A,D){if("object"!=typeof(D=D||{}))throw Error("options is invalid");var G=D.properties,P=D.npoints;D=D.offset;return x=
aa(x),A=aa(A),G=G||{},P=P||100,D=D||10,(new tj({x:x[0],y:x[1]},{x:A[0],y:A[1]},G)).Arc(P,{offset:D}).json()};a.helpers=So;a.hexGrid=Em;a.inside=Tb;a.interpolate=function(x,A,D){if("object"!=typeof(D=D||{}))throw Error("options is invalid");var G=D.gridType,P=D.property,S=D.weight;if(!x)throw Error("points is required");if(Ka(x,"Point","input must contain Points"),!A)throw Error("cellSize is required");if(void 0!==S&&"number"!=typeof S)throw Error("weight must be a number");P=P||"elevation";G=G||"square";
S=S||1;var V=ya(x);switch(G){case "point":case "points":A=Pk(V,A,D);break;case "square":case "squares":A=Fm(V,A,D);break;case "hex":case "hexes":A=Em(V,A,D);break;case "triangle":case "triangles":A=Gm(V,A,D);break;default:throw Error("invalid gridType");}var Z=[];return Sa(A,function(X){var ea=0,na=0;Sa(x,function(ia){var ra,ja=Lb("point"===G?X:Ne(X),ia,D);if(void 0!==P&&(ra=ia.properties[P]),void 0===ra&&(ra=ia.geometry.coordinates[2]),void 0===ra)throw Error("zValue is missing");0===ja&&(ea=ra);
ia=1/Math.pow(ja,S);na+=ia;ea+=ia*ra});var qa=Dc(X);qa.properties[P]=ea/na;Z.push(qa)}),J(Z)};a.intersect=Kg;a.invariant=Uo;a.isNumber=la;a.isObject=ta;a.isobands=function(x,A,D){if(!ta(D=D||{}))throw Error("options is invalid");var G=D.zProperty||"elevation",P=D.commonProperties||{},S=D.breaksProperties||[];if(Ka(x,"Point","Input must contain Points"),!A)throw Error("breaks is required");if(!Array.isArray(A))throw Error("breaks is not an Array");if(!ta(P))throw Error("commonProperties is not an Object");
if(!Array.isArray(S))throw Error("breaksProperties is not an Array");D=bo(x,{zProperty:G,flip:!0});A=function(V,Z,X){for(var ea=[],na=1;na<Z.length;na++){var qa=+Z[na-1],ia=+Z[na],ra=io(ho(co(V,qa,ia-qa))),ja={};ja.groupedRings=ra;ja[X]=qa+"-"+ia;ea.push(ja)}return ea}(D,A,G);return J((A=function(V,Z,X){X=ya(X);var ea=X[0],na=X[1],qa=(X[2]-X[0])/(Z[0].length-1),ia=(X[3]-X[1])/(Z.length-1),ra=function(ja){ja[0]=ja[0]*qa+ea;ja[1]=ja[1]*ia+na};return V.forEach(function(ja){ja.groupedRings.forEach(function(Ma){Ma.forEach(function(Pa){Pa.forEach(ra)})})}),
V}(A,D,x)).map(function(V,Z){if(S[Z]&&!ta(S[Z]))throw Error("Each mappedProperty is required to be an Object");Z=rj({},P,S[Z]);return Z[G]=V[G],T(V.groupedRings,Z)}))};a.isolines=function(x,A,D){if(!ta(D=D||{}))throw Error("options is invalid");var G=D.zProperty||"elevation",P=D.commonProperties||{};D=D.breaksProperties||[];if(Ka(x,"Point","Input must contain Points"),!A)throw Error("breaks is required");if(!Array.isArray(A))throw Error("breaks must be an Array");if(!ta(P))throw Error("commonProperties must be an Object");
if(!Array.isArray(D))throw Error("breaksProperties must be an Array");var S=lh(x,{zProperty:G,flip:!0});return J(function(V,Z,X){X=ya(X);var ea=X[0],na=X[1],qa=(X[2]-X[0])/(Z[0].length-1),ia=(X[3]-X[1])/(Z.length-1),ra=function(ja){ja[0]=ja[0]*qa+ea;ja[1]=ja[1]*ia+na};return V.forEach(function(ja){Ca(ja,ra)}),V}(function(V,Z,X,ea,na){for(var qa=[],ia=1;ia<Z.length;ia++){var ra=+Z[ia],ja=rj({},ea,na[ia]);ja[X]=ra;ra=H(ff(V,ra),ja);qa.push(ra)}return qa}(S,A,G,P,D),S,x))};a.kinks=function(x){var A=
{type:"FeatureCollection",features:[]};if("LineString"===(x="Feature"===x.type?x.geometry:x).type)var D=[x.coordinates];else if("MultiLineString"===x.type)D=x.coordinates;else if("MultiPolygon"===x.type)D=[].concat.apply([],x.coordinates);else{if("Polygon"!==x.type)throw Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");D=x.coordinates}return D.forEach(function(G){D.forEach(function(P){for(var S=0;S<G.length-1;S++)for(var V=S;V<P.length-1;V++){if(G===
P){if(1===Math.abs(S-V))continue;if(0===S&&V===G.length-2&&G[S][0]===G[G.length-1][0]&&G[S][1]===G[G.length-1][1])continue}var Z,X=void 0,ea=void 0,na=void 0,qa=void 0,ia=G[S][0],ra=G[S][1],ja=G[S+1][0],Ma=G[S+1][1],Pa=P[V][0],Sb=P[V][1],Qa=P[V+1][0],Wc=P[V+1][1],fc={x:null,y:null,onLine1:!1,onLine2:!1};(Z=0===(qa=(Wc-Sb)*(ja-ia)-(Qa-Pa)*(Ma-ra))?null!==fc.x&&null!==fc.y&&fc:(X=(ja-ia)*(na=ra-Sb)-(Ma-ra)*(ea=ia-Pa),na=((Qa-Pa)*na-(Wc-Sb)*ea)/qa,ea=X/qa,fc.x=ia+na*(ja-ia),fc.y=ra+na*(Ma-ra),0<=na&&
1>=na&&(fc.onLine1=!0),0<=ea&&1>=ea&&(fc.onLine2=!0),!(!fc.onLine1||!fc.onLine2)&&[fc.x,fc.y]))&&A.features.push(u([Z[0],Z[1]]))}})}),A};a.length=Mi;a.lengthToDegrees=R;a.lengthToRadians=fa;a.lineArc=Vk;a.lineChunk=function(x,A,D){if(!ta(D=D||{}))throw Error("options is invalid");var G=D.units,P=D.reverse;if(!x)throw Error("geojson is required");if(0>=A)throw Error("segmentLength must be greater than 0");var S=[];return Rb(x,function(V){P&&(V.geometry.coordinates=V.geometry.coordinates.reverse());
(function(Z,X,ea,na){var qa=Mi(Z,{units:ea});if(qa<=X)return na(Z);qa/=X;Number.isInteger(qa)||(qa=Math.floor(qa)+1);for(var ia=0;ia<qa;ia++)na(Lk(Z,X*ia,X*(ia+1),{units:ea}),ia)})(V,A,G,function(Z){S.push(Z)})}),J(S)};a.lineDistance=Mi;a.lineEach=Q;a.lineIntersect=ke;a.lineOffset=function(x,A,D){if(!ta(D=D||{}))throw Error("options is invalid");var G=D.units;if(!x)throw Error("geojson is required");if(null==A||isNaN(A))throw Error("distance is required");D=qc(x);var P=x.properties;switch(D){case "LineString":return ml(x,
A,G);case "MultiLineString":var S=[];return Rb(x,function(V){S.push(ml(V,A,G).geometry.coordinates)}),H(S,P);default:throw Error("geometry "+D+" is not supported");}};a.lineOverlap=bl;a.lineReduce=ca;a.lineSegment=kf;a.lineSlice=function(x,A,D){var G=Y(D);if("LineString"!==qc(D))throw Error("line must be a LineString");x=Be(D,x);A=Be(D,A);x=[(A=x.properties.index<=A.properties.index?[x,A]:[A,x])[0].geometry.coordinates];for(var P=A[0].properties.index+1;P<A[1].properties.index+1;P++)x.push(G[P]);
return x.push(A[1].geometry.coordinates),K(x,D.properties)};a.lineSliceAlong=Lk;a.lineSplit=function(x,A){if(!x)throw Error("line is required");if(!A)throw Error("splitter is required");var D=qc(x),G=qc(A);if("LineString"!==D)throw Error("line must be LineString");if("FeatureCollection"===G)throw Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===G)throw Error("splitter cannot be a GeometryCollection");A=Qk(A,{precision:7});switch(G){case "Point":return Oi(x,A);case "MultiPoint":return Tk(x,
A);case "LineString":case "MultiLineString":case "Polygon":case "MultiPolygon":return Tk(x,ke(x,A))}};a.lineString=K;a.lineStringToPolygon=Yk;a.lineStrings=I;a.lineToPolygon=Yk;a.mask=function(x,A){var D=E(A&&A.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]);A=null;return"FeatureCollection"===x.type?A=T(2===x.features.length?Ce.union(x.features[0].geometry.coordinates,x.features[1].geometry.coordinates):Ce.union.apply(Ce,x.features.map(function(G){return G.geometry.coordinates}))):
A=T(Ce.union(x.geometry.coordinates)),A.geometry.coordinates.forEach(function(G){D.geometry.coordinates.push(G[0])}),D};a.meta=To;a.midpoint=function(x,A){return je(x,Lb(x,A)/2,Ae(x,A))};a.moranIndex=function(x,A){var D=A.inputField,G=Ml(x,{alpha:A.alpha||-1,binary:A.binary||!1,p:A.p||2,standardization:A.standardization||!0,threshold:A.threshold||1E5}),P=[];Sa(x,function(ra){P.push((ra.properties||{})[D])});for(var S=Nl(P),V=function(ra){for(var ja=Nl(ra),Ma=0,Pa=0;Pa<ra.length;Pa++)Ma+=Math.pow(ra[Pa]-
ja,2);return Ma/ra.length}(P),Z=0,X=A=x=0,ea=G.length,na=0;na<ea;na++){for(var qa=0,ia=0;ia<ea;ia++)Z+=G[na][ia]*(P[na]-S)*(P[ia]-S),x+=G[na][ia],A+=Math.pow(G[na][ia]+G[ia][na],2),qa+=G[na][ia]+G[ia][na];X+=Math.pow(qa,2)}G=Z/x/V;S=-1/(ea-1);V=(ea*ea*(A*=.5)-ea*X+x*x*3)/((ea-1)*(ea+1)*x*x)-S*S;x=Math.sqrt(V);return{expectedMoranIndex:S,moranIndex:G,stdNorm:x,zNorm:(G-S)/x}};a.multiLineString=H;a.multiPoint=N;a.multiPolygon=T;a.nearest=zh;a.nearestPoint=zh;a.nearestPointOnLine=Be;a.nearestPointToLine=
function(x,A,D){void 0===D&&(D={});var G=D.units;D=D.properties||{};x=function(V){var Z=[];switch(V.geometry?V.geometry.type:V.type){case "GeometryCollection":return Zb(V,function(X){"Point"===X.type&&Z.push({type:"Feature",properties:{},geometry:X})}),{type:"FeatureCollection",features:Z};case "FeatureCollection":return V.features=V.features.filter(function(X){return"Point"===X.geometry.type}),V;default:throw Error("points must be a Point Collection");}}(x);if(!x.features.length)throw Error("points must contain features");
if(!A)throw Error("line is required");if("LineString"!==qc(A))throw Error("line must be a LineString");var P=1/0,S=null;return Sa(x,function(V){var Z=Gk(V,A,{units:G});Z<P&&(P=Z,S=V)}),S&&(S.properties=rj({dist:P},S.properties,D)),S};a.planepoint=function(x,A){var D=aa(x);x=Ib(A).coordinates[0];if(4>x.length)throw Error("OuterRing of a Polygon must have 4 or more Positions.");A=A.properties||{};var G=A.a,P=A.b,S=A.c;A=D[0];D=D[1];var V=x[0][0],Z=x[0][1];G=void 0!==G?G:x[0][2];var X=x[1][0],ea=x[1][1];
P=void 0!==P?P:x[1][2];var na=x[2][0],qa=x[2][1];x=void 0!==S?S:x[2][2];return(x*(A-V)*(D-ea)+G*(A-X)*(D-qa)+P*(A-na)*(D-Z)-P*(A-V)*(D-qa)-x*(A-X)*(D-Z)-G*(A-na)*(D-ea))/((A-V)*(D-ea)+(A-X)*(D-qa)+(A-na)*(D-Z)-(A-V)*(D-qa)-(A-X)*(D-Z)-(A-na)*(D-ea))};a.point=u;a.pointGrid=Pk;a.pointOnFeature=Hk;a.pointOnLine=Be;a.pointOnSurface=Hk;a.pointToLineDistance=Gk;a.points=B;a.pointsWithinPolygon=ti;a.polygon=E;a.polygonSmooth=function(x,A){var D=[],G=A.iterations||1;if(!x)throw Error("inputPolys is required");
return Zb(x,function(P,S,V){switch(P.type){case "Polygon":S=[[]];for(var Z=0;Z<G;Z++){var X=[[]];var ea=P;0<Z&&(ea=E(S).geometry);Ao(ea,X);S=X.slice(0)}D.push(E(S,V));break;case "MultiPolygon":S=[[[]]];for(Z=0;Z<G;Z++)X=[[[]]],ea=P,0<Z&&(ea=T(S).geometry),Bo(ea,X),S=X.slice(0);D.push(T(S,V));break;default:throw Error("geometry is invalid, must be Polygon or MultiPolygon");}}),J(D)};a.polygonTangents=function(x,A){var D=Y(x),G=Y(A),P=ya(A),S=0,V=null;switch(D[0]>P[0]&&D[0]<P[2]&&D[1]>P[1]&&D[1]<P[3]&&
(S=(V=zh(x,xh(A))).properties.featureIndex),qc(A)){case "Polygon":var Z=G[0][S];var X=G[0][0];null!==V&&V.geometry.coordinates[1]<D[1]&&(X=G[0][S]);var ea=Ag(G[0][0],G[0][G[0].length-1],D);G=fl(G[0],D,ea,void 0,Z,X);Z=G[0];X=G[1];break;case "MultiPolygon":for(V=P=A=x=0;V<G[0].length;V++){x=V;for(var na=!1,qa=0;qa<G[0][V].length;qa++){if(A=qa,P===S){na=!0;break}P++}if(na)break}Z=G[0][x][A];X=G[0][x][A];ea=Ag(G[0][0][0],G[0][0][G[0][0].length-1],D);G.forEach(function(ia){ia=fl(ia[0],D,ea,void 0,Z,X);
Z=ia[0];X=ia[1]})}return J([u(Z),u(X)])};a.polygonToLine=zg;a.polygonToLineString=zg;a.polygonize=function(x){x=ap.fromGeoJson(x);x.deleteDangles();x.deleteCutEdges();var A=[],D=[];return x.getEdgeRings().filter(function(G){return G.isValid()}).forEach(function(G){G.isHole()?A.push(G):D.push(G)}),A.forEach(function(G){Tm.findEdgeRingContaining(G,D)&&D.push(G)}),J(D.map(function(G){return G.toPolygon()}))};a.polygons=F;a.projection=ip;a.propEach=Kb;a.propReduce=Qd;a.propertiesContainsFilter=bj;a.radians2degrees=
ha;a.radiansToDegrees=ha;a.radiansToDistance=ba;a.radiansToLength=ba;a.random=jp;a.randomLineString=Wl;a.randomPoint=Ul;a.randomPolygon=Vl;a.randomPosition=Gg;a.rewind=function(x,A){if(!ta(A=A||{}))throw Error("options is invalid");var D=A.reverse||!1;A=A.mutate||!1;if(!x)throw Error("<geojson> is required");if("boolean"!=typeof D)throw Error("<reverse> must be a boolean");if("boolean"!=typeof A)throw Error("<mutate> must be a boolean");!1===A&&(x=Dc(x));var G=[];switch(x.type){case "GeometryCollection":return Zb(x,
function(P){Eh(P,D)}),x;case "FeatureCollection":return Sa(x,function(P){Sa(Eh(P,D),function(S){G.push(S)})}),J(G)}return Eh(x,D)};a.rhumbBearing=lf;a.rhumbDestination=Hf;a.rhumbDistance=Bh;a.round=W;a.sample=function(x,A){if(!x)throw Error("featurecollection is required");if(null==A)throw Error("num is required");if("number"!=typeof A)throw Error("num must be a number");var D=x.features,G;x=D.slice(0);D=D.length;for(var P=D-A;D-- >P;)A=x[G=Math.floor((D+1)*Math.random())],x[G]=x[D],x[D]=A;x=x.slice(P);
return J(x)};a.sector=function(x,A,D,G,P){if(!ta(P=P||{}))throw Error("options is invalid");var S=P.properties;if(!x)throw Error("center is required");if(null==D)throw Error("bearing1 is required");if(null==G)throw Error("bearing2 is required");if(!A)throw Error("radius is required");if("object"!=typeof P)throw Error("options must be an object");if(dl(D)===dl(G))return Di(x,A,P);var V=Y(x);x=Vk(x,A,D,G,P);var Z=[[V]];return Ca(x,function(X){Z[0].push(X)}),Z[0].push(V),E(Z,S)};a.segmentEach=L;a.segmentReduce=
M;a.shortestPath=function(x,A,D){if(!ta(D=D||{}))throw Error("options is invalid");var G=D.resolution,P=D.minDistance,S=D.obstacles||J([]);if(!x)throw Error("start is required");if(!A)throw Error("end is required");if(G&&!la(G)||0>=G)throw Error("options.resolution must be a number, greater than 0");if(P)throw Error("options.minDistance is not yet implemented");P=aa(x);var V=aa(A);switch(x=u(P),A=u(V),qc(S)){case "FeatureCollection":if(0===S.features.length)return K([P,V]);break;case "Polygon":S=
J([g(Ib(S))]);break;default:throw Error("invalid obstacles");}var Z=S;Z.features.push(x);Z.features.push(A);var X=ya(kl(Ci(ya(Z)),1.15));G||=Lb([X[0],X[1]],[X[2],X[1]],D)/100;Z.features.pop();Z.features.pop();Z=X[0];var ea=X[1],na=X[2],qa=X[3];X=G/Lb([Z,ea],[na,ea],D)*(na-Z);D=G/Lb([Z,ea],[Z,qa],D)*(qa-ea);G=na-Z;var ia=qa-ea,ra=(G-Math.floor(G/X)*X)/2,ja=[],Ma=[];G=[];var Pa=[],Sb=1/0,Qa=1/0;qa-=(ia-Math.floor(ia/D)*D)/2;for(ia=0;qa>=ea;){for(var Wc=[],fc=[],nc=Z+ra,cc=0;nc<=na;){var gc=u([nc,qa]),
Gc=no(gc,S);Wc.push(Gc?0:1);fc.push(nc+"|"+qa);var Qf=Lb(gc,x);!Gc&&Qf<Sb&&(Sb=Qf,G={x:cc,y:ia});gc=Lb(gc,A);!Gc&&gc<Qa&&(Qa=gc,Pa={x:cc,y:ia});nc+=X;cc++}Ma.push(Wc);ja.push(fc);qa-=D;ia++}x=new If(Ma,{diagonal:!0});x=Vh.search(x,x.grid[G.y][G.x],x.grid[Pa.y][Pa.x]);var Qe=[P];return x.forEach(function(kh){kh=ja[kh.x][kh.y].split("|");Qe.push([+kh[0],+kh[1]])}),Qe.push(V),hf(K(Qe))};a.simplify=function(x,A){if(!ta(A=A||{}))throw Error("options is invalid");var D=void 0!==A.tolerance?A.tolerance:
1,G=A.highQuality||!1;A=A.mutate||!1;if(!x)throw Error("geojson is required");if(D&&0>D)throw Error("invalid tolerance");return!0!==A&&(x=Dc(x)),Zb(x,function(P){!function(S,V,Z){var X=S.type;if("Point"===X||"MultiPoint"===X)return S;hf(S,!0);var ea=S.coordinates;switch(X){case "LineString":S.coordinates=ok(ea,V,Z);break;case "MultiLineString":S.coordinates=ea.map(function(na){return ok(na,V,Z)});break;case "Polygon":S.coordinates=pk(ea,V,Z);break;case "MultiPolygon":S.coordinates=ea.map(function(na){return pk(na,
V,Z)})}}(P,D,G)}),x};a.square=sk;a.squareGrid=Fm;a.standardDeviationalEllipse=function(x,A){if(!ta(A=A||{}))throw Error("options is invalid");var D=A.steps||64,G=A.weight,P=A.properties||{};if(!la(D))throw Error("steps must be a number");if(!ta(P))throw Error("properties must be a number");A=uc(x).length;var S=Zi(x,{weight:G}),V=0,Z=0,X=0;Sa(x,function(Pa){var Sb=Pa.properties[G]||1;Pa=Ll(Y(Pa),Y(S));V+=Math.pow(Pa.x,2)*Sb;Z+=Math.pow(Pa.y,2)*Sb;X+=Pa.x*Pa.y*Sb});var ea=V-Z,na=Math.atan((ea+Math.sqrt(Math.pow(ea,
2)+4*Math.pow(X,2)))/(2*X));ea=180*na/Math.PI;var qa=0,ia=0,ra=0;Sa(x,function(Pa){var Sb=Pa.properties[G]||1;Pa=Ll(Y(Pa),Y(S));qa+=Math.pow(Pa.x*Math.cos(na)-Pa.y*Math.sin(na),2)*Sb;ia+=Math.pow(Pa.x*Math.sin(na)+Pa.y*Math.cos(na),2)*Sb;ra+=Sb});var ja=Math.sqrt(2*qa/ra),Ma=Math.sqrt(2*ia/ra);D=Jl(S,ja,Ma,{units:"degrees",angle:ea,steps:D,properties:P});x=ti(x,J([D]));x={meanCenterCoordinates:Y(S),semiMajorAxis:ja,semiMinorAxis:Ma,numberOfFeatures:A,angle:ea,percentageWithinEllipse:100*uc(x).length/
A};return D.properties.standardDeviationalEllipse=x,D};a.tag=function(x,A,D,G){return x=Dc(x),A=Dc(A),Sa(x,function(P){P.properties||(P.properties={});Sa(A,function(S){void 0===P.properties[G]&&Tb(P,S)&&(P.properties[G]=S.properties[D])})}),x};a.tesselate=function(x){if(!x.geometry||"Polygon"!==x.geometry.type&&"MultiPolygon"!==x.geometry.type)throw Error("input must be a Polygon or MultiPolygon");var A={type:"FeatureCollection",features:[]};return"Polygon"===x.geometry.type?A.features=xk(x.geometry.coordinates):
x.geometry.coordinates.forEach(function(D){A.features=A.features.concat(xk(D))}),A};a.tin=ek;a.toMercator=Ol;a.toWgs84=Ql;a.transformRotate=jl;a.transformScale=kl;a.transformTranslate=function(x,A,D,G){if(!ta(G=G||{}))throw Error("options is invalid");var P=G.units,S=G.zTranslation;G=G.mutate;if(!x)throw Error("geojson is required");if(null==A||isNaN(A))throw Error("distance is required");if(S&&"number"!=typeof S&&isNaN(S))throw Error("zTranslation is not a number");if(S=void 0!==S?S:0,0===A&&0===
S)return x;if(null==D||isNaN(D))throw Error("direction is required");return 0>A&&(A=-A,D+=180),!1!==G&&void 0!==G||(x=Dc(x)),Ca(x,function(V){var Z=Y(Hf(V,A,D,{units:P}));V[0]=Z[0];V[1]=Z[1];S&&3===V.length&&(V[2]+=S)}),x};a.triangleGrid=Gm;a.truncate=Qk;a.union=function(x,A,D){void 0===D&&(D={});x=Ib(x);A=Ib(A);A=Ce.union(x.coordinates,A.coordinates);return 0===A.length?null:1===A.length?E(A[0],D.properties):T(A,D.properties)};a.unitsFactors=Hm;a.unkinkPolygon=function(x){var A=[];return Rb(x,function(D){"Polygon"===
D.geometry.type&&Sa($n(D),function(G){A.push(E(G.geometry.coordinates,D.properties))})}),J(A)};a.validateBBox=wa;a.validateId=za;a.voronoi=function(x,A){if(!ta(A=A||{}))throw Error("options is invalid");A=A.bbox||[-180,-85,180,85];if(!x)throw Error("points is required");if(!Array.isArray(A))throw Error("bbox is invalid");return Ka(x,"Point","points"),J(function(){function D(V){return new Yi(V.map(function(Z,X){var ea=[Math.round(G(Z,X,V)/Wb)*Wb,Math.round(P(Z,X,V)/Wb)*Wb];return ea.index=X,ea.data=
Z,ea}),S)}var G=oo,P=po,S=null;return D.polygons=function(V){return D(V).polygons()},D.links=function(V){return D(V).links()},D.triangles=function(V){return D(V).triangles()},D.x=function(V){return arguments.length?(G="function"==typeof V?V:Cl(+V),D):G},D.y=function(V){return arguments.length?(P="function"==typeof V?V:Cl(+V),D):P},D.extent=function(V){return arguments.length?(S=null==V?null:[[+V[0][0],+V[0][1]],[+V[1][0],+V[1][1]]],D):S&&[[S[0][0],S[0][1]],[S[1][0],S[1][1]]]},D.size=function(V){return arguments.length?
(S=null==V?null:[[0,0],[+V[0],+V[1]]],D):S&&[S[1][0]-S[0][0],S[1][1]-S[0][1]]},D}().x(function(D){return D.geometry.coordinates[0]}).y(function(D){return D.geometry.coordinates[1]}).extent([[A[0],A[1]],[A[2],A[3]]]).polygons(x.features).map(zo))};a.within=ti;Object.defineProperty(a,"__esModule",{value:!0})});var module$libs$turf_min={};const html$$module$settlements=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
var thickLineToPolygon$$module$settlements=function(){function a(g,q,u,B){q=(q.y-g.y)/(q.x-g.x);B=(B.y-u.y)/(B.x-u.x);if(q!==B)return g=g.y-q*g.x,u=(g-(u.y-B*u.x))/(B-q),{x:u,y:q*u+g}}return function(g,q){for(var u,B,E=[],F,K,I,J,H,N,T,O,W,ba=0,fa=g.length-1;ba<fa;ba++)F=!ba,K=ba===g.length-2,u=g[ba],O=g[ba+1],T=O.x-u.x,u=O.y-u.y,O=q/(2*Math.sqrt(T*T+u*u)),u*=-O,B=O*T,T={x:g[ba].x+u,y:g[ba].y+B},O={x:g[ba+1].x+u,y:g[ba+1].y+B},W={x:g[ba].x-u,y:g[ba].y-B},u={x:g[ba+1].x-u,y:g[ba+1].y-B},F||((H=a(I[0],
I[1],T,O))&&E.unshift(H),(N=a(J[0],J[1],W,u))&&E.push(N)),F&&(E.unshift(T),E.push(W)),K&&(E.unshift(O),E.push(u)),K||(I=[T,O],J=[W,u]);return E}}();function coordsToPoints$$module$settlements(a){let g=[];for(let q=0;q<a.length;q++)g.push({x:a[q][0],y:a[q][1]});return g}function pointsToCoords$$module$settlements(a){let g=[];for(let q=0;q<a.length;q++)g.push([a[q].x,a[q].y]);return g}
function makeSmoothPolygon$$module$settlements(a){a.push(a[0]);a=turf.polygonSmooth(turf.polygon([a]),{iterations:3});let g="";turf.featureEach(a,(q,u)=>{q=turf.getCoords(turf.getGeom(q))[0];g="M "+q[0][0]+" "+q[0][1]+" ";for(u=1;u<q.length;u++)g=g+"L "+q[u][0]+" "+q[u][1]+" ";g+="Z"});return g}function makePolygon$$module$settlements(a){let g="M "+a[0][0]+" "+a[0][1]+" ";for(let q=1;q<a.length;q++)g=g+"L "+a[q][0]+" "+a[q][1]+" ";return g+"Z"}
function makeCurvedPath$$module$settlements(a){let g="M "+a[0][0]+" "+a[0][1]+" ";for(let q=1;q<a.length;q++)g=g+"L "+a[q][0]+" "+a[q][1]+" ";return g}function makePolygonFromLine$$module$settlements(a,g){a=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),g));g="M "+a[0][0]+" "+a[0][1]+" ";for(let q=1;q<a.length;q++)g=g+"L "+a[q][0]+" "+a[q][1]+" ";return g+"Z"}
function makeMergedPolygon$$module$settlements(a,g,q){a=a.slice();g[0].push(g[0][0]);g=turf.polygon(g);const u=turf.centerOfMass(g).geometry.coordinates;a.unshift(u);q=pointsToCoords$$module$settlements(thickLineToPolygon$$module$settlements(coordsToPoints$$module$settlements(a),q));q.push(q[0]);q=turf.polygon([q]);q=turf.union(g,q);return makeSmoothPolygon$$module$settlements(q.geometry.coordinates[0])}
class Marker$$module$settlements extends k$$module$libs$preact{constructor(){super();this.setState({hover:"",radius:3})}mouseover(){this.setState({hover:"marker-label-hover",radius:10})}mouseout(){this.setState({hover:"",radius:3})}getLocationURL(){return"/sandbox/"+this.props.instance+"/location/"+this.props.uuid}render(a,g){const q=""!=g.hover?html$$module$settlements`
            <g
              id="active-poi-label"
              transform="translate( ${a.coords.x} , ${a.coords.y}) rotate(-${a.rotate})"
            >
              <text
                transform="translate( 0, -20)"
                class="marker-label ${g.hover}"
                font-size="0.8em"
                text-anchor="middle"
              >
                ${a.title}
              </text>
            </g>
          `:html$$module$settlements``;return html$$module$settlements`
      ${q}

      <g
        transform="translate( ${a.coords.x} , ${a.coords.y}) rotate(-${a.rotate})"
      >
        <circle
          class="marker-circle"
          r="${g.radius}"
          fill="${a.uuid==a.location?"#00ff00":"#ff0000"}"
        >
        </circle>
        <a href="${this.getLocationURL()}">
          <circle
            opacity="0"
            cursor="pointer"
            r="${2*g.radius}"
            onmouseover="${()=>{this.mouseover()}}"
            onmouseout="${()=>{this.mouseout()}}"
          >
          </circle
        ></a>
      </g>
    `}}var module$settlements={};module$settlements.Marker=Marker$$module$settlements;module$settlements.makeCurvedPath=makeCurvedPath$$module$settlements;module$settlements.makeMergedPolygon=makeMergedPolygon$$module$settlements;module$settlements.makePolygon=makePolygon$$module$settlements;module$settlements.makeSmoothPolygon=makeSmoothPolygon$$module$settlements;const html$$module$citymap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Wall$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#000000"
        stroke-width="8"
        fill="none"
    /></g>`}}class Estuary$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makeMergedPolygon$$module$settlements(a.river,a.water,a.river_width)}"
        fill="#1166aa"
    /></g>`}}class River$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makeCurvedPath$$module$settlements(a.coords)}"
        stroke="#1166aa"
        stroke-width="48"
        fill="none"
    /></g>`}}class Building$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){2==a.coords.length&&a.coords[1]?html$$module$citymap`
          <circle
            cx="${a.coords[0][0][0]}"
            cy="${a.coords[0][0][1]}"
            r="12"
            fill="#ff0000"
          />
        `:html$$module$citymap``;return html$$module$citymap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#000000"
        stroke-width="1"
        fill="#444444"
    /></g>`}}class Water$$module$citymap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$citymap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="none"
        stroke-width="8"
        fill="#1166aa"
    /></g>`}}
class CityMap$$module$citymap extends k$$module$libs$preact{constructor(){super();this.setState({watabou:null})}fetch_map(a,g,q=!1){const u=window.app.settlements_cache[this.props.uuid];u&&!q&&this.setState({watabou:u.map_data,poi:u.poi});api_call_city$$module$api_shim(a,g).then(B=>{this.setState({watabou:B.map_data,poi:B.poi});window.app.settlements_cache[this.props.uuid]=B})}componentDidMount(a,g,q){this.fetch_map(this.props.instance,this.props.hex)}componentWillUpdate(a,g,q){this.props.uuid==a.uuid&&
this.props.location==a.location||this.fetch_map(a.instance,a.hex,!0)}render(a,g){if(null===g.watabou||"mfcg"!=g.watabou.features[0].generator)return html$$module$citymap``;const q=g.watabou.features[0].coast_dir||0,u=void 0!==g.watabou.features[0].coast_dir?-900:0;let B=html$$module$citymap``;0<g.watabou.features[4].geometries.length&&13<g.watabou.features.length?B=html$$module$citymap` <${Estuary$$module$citymap}
        river=${g.watabou.features[4].geometries[0].coordinates}
        water=${g.watabou.features[13].coordinates[0]}
        river_width=${g.watabou.features[0].riverWidth}
      />`:0<g.watabou.features[4].geometries.length?B=html$$module$citymap`
        ${g.watabou.features[4].geometries.map(F=>html$$module$citymap` <${River$$module$citymap} coords=${F.coordinates} />`)}
      `:g.watabou.features[13]&&(B=html$$module$citymap`
        ${g.watabou.features[13].coordinates.map(F=>html$$module$citymap` <${Water$$module$citymap} coords=${F} />`)}
      `);const E=60*q;return html$$module$citymap`
      <mask id="${a.hex}">
        <polygon
          fill="#ffffff"
          points="1000,-1800 -1000,-1800 -2000,000 -1000,1800 1000,1800 2000,0"
        />
      </mask>
      <g
        transform="scale(0.005 0.005) rotate(${E})"
        mask="url(#${a.hex})"
      >
        <g transform="translate(0,${u})">
          ${B}
          ${g.watabou.features[6].coordinates.map(F=>html$$module$citymap` <${Building$$module$citymap} coords=${F} />`)}
          <!--FIXME: This is too wasteful to loop through all the buildings.-->
          ${g.watabou.features[3].geometries.map(F=>html$$module$citymap` <${Wall$$module$citymap} coords=${F.coordinates} />`)}
          ${g.poi.map(F=>html$$module$citymap` <${Marker$$module$settlements}
              coords=${F.coords}
              uuid=${F.uuid}
              instance=${a.instance}
              title=${F.title}
              radius="4"
              rotate=${E}
              location=${a.location}
            />`)}
          <use xlink:href="#active-poi-label" />
        </g>
      </g>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#ff0000"
        stroke-width="2"
        fill="none"
        style="stroke-width:0.2;"
      />
    `}}var module$citymap={};module$citymap.CityMap=CityMap$$module$citymap;function metaball$$module$metaballs(a){a.forEach(u=>u.c=[u.x,u.y]);let g="";for(let u=0;u<a.length;u++){var q=a.slice(0,3);a.push(a.shift());const B=curvesBetweenCircles$$module$metaballs(q[0].r,q[1].r,q[0].c,q[1].c);q=curvesBetweenCircles$$module$metaballs(q[1].r,q[2].r,q[1].c,q[2].c);0===u&&(g+=`M ${B.p[1][0]},${B.p[1][1]} `);g+=`C ${B.h[1][0]},${B.h[1][1]} ${B.h[3][0]},${B.h[3][1]} ${B.p[3][0]},${B.p[3][1]}`;g+=`A ${q.r1}, ${q.r1}, 1, 0, 1, ${q.p[1][0]}, ${q.p[1][1]}`}return g+"Z"}
function metablob$$module$metaballs(a){let g=[];for(let q=0;6>q;q++){const u=getVector$$module$metaballs([a.x,a.y],Math.PI/3*q,.5*a.r);g.push({x:u[0],y:u[1],r:rand$$module$utils(2E3,3500)/1E3})}return metaball$$module$metaballs(g)}
function curvesBetweenCircles$$module$metaballs(a,g,q,u,B=2.4,E=.5){var F=Math.PI/2;const K=dist$$module$metaballs(q,u);var I=0,J=0;if(0===a||0===g||K<=Math.abs(a-g))return null;K<a+g&&(I=Math.acos((a*a+K*K-g*g)/(2*a*K)),J=Math.acos((g*g+K*K-a*a)/(2*g*K)));var H=angle$$module$metaballs(u,q),N=Math.acos((a-g)/K),T=H+I+(N-I)*E,O=H-I-(N-I)*E;I=H+Math.PI-J-(Math.PI-J-N)*E;H=H-Math.PI+J+(Math.PI-J-N)*E;J=getVector$$module$metaballs(q,T,a);q=getVector$$module$metaballs(q,O,a);N=getVector$$module$metaballs(u,
I,g);u=getVector$$module$metaballs(u,H,g);const W=a+g;B=Math.min(E*B,dist$$module$metaballs(J,N)/W)*Math.min(1,2*K/(a+g));E=a*B;B*=g;T=getVector$$module$metaballs(J,T-F,E);O=getVector$$module$metaballs(q,O+F,E);I=getVector$$module$metaballs(N,I+F,B);F=getVector$$module$metaballs(u,H-F,B);return{p:[J,q,N,u],h:[T,O,I,F],escaped:K>a,r:g,r1:a}}function dist$$module$metaballs([a,g],[q,u]){return((a-q)**2+(g-u)**2)**.5}function angle$$module$metaballs([a,g],[q,u]){return Math.atan2(g-u,a-q)}
function getVector$$module$metaballs([a,g],q,u){return[a+u*Math.cos(q),g+u*Math.sin(q)]}var module$metaballs={};module$metaballs.metaball=metaball$$module$metaballs;module$metaballs.metablob=metablob$$module$metaballs;const html$$module$villagemap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Road$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeCurvedPath$$module$settlements(a.coords)}"
        stroke="#333"
        stroke-width="2"
        fill="none"
    /></g>`}}class Tree$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){a=metablob$$module$metaballs({x:a.coords[0],y:a.coords[1],r:8});return html$$module$villagemap`
      <path d="${a}" stroke="#334433" fill="#445544" stroke-width="1" />
    `}}class Building$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){2==a.coords.length&&a.coords[1]?html$$module$villagemap`
          <circle
            cx="${a.coords[0][0][0]}"
            cy="${a.coords[0][0][1]}"
            r="12"
            fill="#ff0000"
          />
        `:html$$module$villagemap``;return html$$module$villagemap`<g
      ><path
        d="${makePolygon$$module$settlements(a.coords[0])}"
        stroke="#000000"
        stroke-width="1"
        fill="#444444"
    /></g>`}}class Water$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="none"
        stroke-width="8"
        fill="#1166aa"
    /></g>`}}class Square$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="#333"
        stroke-width="2"
        fill="#998877"
    /></g>`}}class Field$$module$villagemap extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$villagemap`<g
      ><path
        d="${makeSmoothPolygon$$module$settlements(a.coords[0])}"
        stroke="#406030"
        stroke-width="2"
        fill="#446633"
    /></g>`}}
class VillageMap$$module$villagemap extends k$$module$libs$preact{constructor(){super();this.setState({watabou:null})}fetch_map(a,g,q=!1){const u=window.app.settlements_cache[this.props.uuid];u&&!q&&this.setState({watabou:u.map_data,poi:u.poi});api_call_city$$module$api_shim(a,g).then(B=>{this.setState({watabou:B.map_data,poi:B.poi});window.app.settlements_cache[this.props.uuid]=B})}componentDidMount(a,g,q){this.fetch_map(this.props.instance,this.props.hex)}componentWillUpdate(a,g,q){this.props.uuid==a.uuid&&
this.props.location==a.location||this.fetch_map(a.instance,a.hex,!0)}render(a,g){if(null===g.watabou||"vg"!=g.watabou.features[0].generator)return html$$module$villagemap``;const q=g.watabou.features[0].coast_dir||0,u=void 0!==g.watabou.features[0].coast_dir?-650:0;let B=html$$module$villagemap``,E=html$$module$villagemap``,F=html$$module$villagemap``,K=html$$module$villagemap``;for(const J of g.watabou.features)"squares"==J.id&&(K=html$$module$villagemap`
          ${J.coordinates.map(H=>html$$module$villagemap` <${Square$$module$villagemap} coords=${H} />`)}
        `),"water"==J.id&&(B=html$$module$villagemap`
          ${J.coordinates.map(H=>html$$module$villagemap` <${Water$$module$villagemap} coords=${H} />`)}
        `),"fields"==J.id&&(E=html$$module$villagemap`
          ${J.coordinates.map(H=>html$$module$villagemap` <${Field$$module$villagemap} coords=${H} />`)}
        `),"trees"==J.id&&(F=html$$module$villagemap`
          ${J.coordinates.map((H,N)=>{if(0==N%8)return html$$module$villagemap` <${Tree$$module$villagemap} coords=${H} />`})}
        `);const I=60*q;return html$$module$villagemap`
      <mask id="${a.hex}">
        <polygon
          fill="#ffffff"
          points="500,-900 -500,-900 -1000,000 -500,900 500,900 1000,0"
        />
      </mask>
      <g
        transform="scale(0.01 0.01) rotate(${I})"
        mask="url(#${a.hex})"
      >
        <g transform="translate(0,${u})">
          ${B} ${E}
          ${g.watabou.features[5].geometries.map(J=>html$$module$villagemap` <${Road$$module$villagemap} coords=${J.coordinates} />`)}
          ${K}
          ${g.watabou.features[2].coordinates.map(J=>html$$module$villagemap` <${Building$$module$villagemap} coords=${J} />`)}
          ${F}
          <!--FIXME: This is too wasteful to loop through all the buildings.-->
          ${g.poi.map(J=>html$$module$villagemap` <${Marker$$module$settlements}
              coords=${J.coords}
              uuid=${J.uuid}
              instance=${a.instance}
              title=${J.title}
              radius="2"
              rotate=${I}
              location=${a.location}
            />`)}
          <use xlink:href="#active-poi-label" />
        </g>
      </g>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#ff0000"
        stroke-width="2"
        fill="none"
        style="stroke-width:0.2;"
      />
    `}}var module$villagemap={};module$villagemap.VillageMap=VillageMap$$module$villagemap;const PERLIN_YWRAPB$$module$libs$perlin=4,PERLIN_YWRAP$$module$libs$perlin=1<<PERLIN_YWRAPB$$module$libs$perlin,PERLIN_ZWRAPB$$module$libs$perlin=8,PERLIN_ZWRAP$$module$libs$perlin=1<<PERLIN_ZWRAPB$$module$libs$perlin,PERLIN_SIZE$$module$libs$perlin=4095;let perlin_octaves$$module$libs$perlin=4,perlin_amp_falloff$$module$libs$perlin=.5;const scaled_cosine$$module$libs$perlin=a=>.5*(1-Math.cos(a*Math.PI));let perlin$$module$libs$perlin;
function noise$$module$libs$perlin(a,g=0,q=0){if(null==perlin$$module$libs$perlin){perlin$$module$libs$perlin=Array(PERLIN_SIZE$$module$libs$perlin+1);for(var u=0;u<PERLIN_SIZE$$module$libs$perlin+1;u++)perlin$$module$libs$perlin[u]=Math.random()}0>a&&(a=-a);0>g&&(g=-g);0>q&&(q=-q);u=Math.floor(a);let B=Math.floor(g),E=Math.floor(q);a-=u;g-=B;q-=E;let F,K,I=0,J=.5,H,N,T;for(let O=0;O<perlin_octaves$$module$libs$perlin;O++){let W=u+(B<<PERLIN_YWRAPB$$module$libs$perlin)+(E<<PERLIN_ZWRAPB$$module$libs$perlin);
F=scaled_cosine$$module$libs$perlin(a);K=scaled_cosine$$module$libs$perlin(g);H=perlin$$module$libs$perlin[W&PERLIN_SIZE$$module$libs$perlin];H+=F*(perlin$$module$libs$perlin[W+1&PERLIN_SIZE$$module$libs$perlin]-H);N=perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin&PERLIN_SIZE$$module$libs$perlin];N+=F*(perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin+1&PERLIN_SIZE$$module$libs$perlin]-N);H+=K*(N-H);W+=PERLIN_ZWRAP$$module$libs$perlin;N=perlin$$module$libs$perlin[W&PERLIN_SIZE$$module$libs$perlin];
N+=F*(perlin$$module$libs$perlin[W+1&PERLIN_SIZE$$module$libs$perlin]-N);T=perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin&PERLIN_SIZE$$module$libs$perlin];T+=F*(perlin$$module$libs$perlin[W+PERLIN_YWRAP$$module$libs$perlin+1&PERLIN_SIZE$$module$libs$perlin]-T);N+=K*(T-N);H+=scaled_cosine$$module$libs$perlin(q)*(N-H);I+=H*J;J*=perlin_amp_falloff$$module$libs$perlin;u<<=1;a*=2;B<<=1;g*=2;E<<=1;q*=2;1<=a&&(u++,a--);1<=g&&(B++,g--);1<=q&&(E++,q--)}return I}
function noiseDetail$$module$libs$perlin(a,g){0<a&&(perlin_octaves$$module$libs$perlin=a);0<g&&(perlin_amp_falloff$$module$libs$perlin=g)}
function noiseSeed$$module$libs$perlin(a){const g=(()=>{let q,u;return{setSeed(B){u=q=(null==B?4294967296*Math.random():B)>>>0},getSeed(){return q},rand(){u=(1664525*u+1013904223)%4294967296;return u/4294967296}}})();g.setSeed(a);perlin$$module$libs$perlin=Array(PERLIN_SIZE$$module$libs$perlin+1);for(a=0;a<PERLIN_SIZE$$module$libs$perlin+1;a++)perlin$$module$libs$perlin[a]=g.rand()}var module$libs$perlin={};module$libs$perlin.noise=noise$$module$libs$perlin;module$libs$perlin.noiseSeed=noiseSeed$$module$libs$perlin;const html$$module$dungeonmap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact),kScale$$module$dungeonmap=.01,kScaleMultiplier$$module$dungeonmap=10*kScale$$module$dungeonmap;class dDungeonPortal$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){g=0;"S"==a.wall&&(g=180);"E"==a.wall&&(g=90);"W"==a.wall&&(g=270);return html$$module$dungeonmap`
      <g transform="translate(${10*a.x}, ${10*a.y})">
        <g transform="rotate(${g}, 5, 5)">
          <rect x="-3" y="5" width="5" height="4" fill="#292828" />
          <rect x="8" y="5" width="5" height="4" fill="#292828" />
          <rect x="2" y="6" width="6" height="2" fill="none" stroke="#292828" />
        </g>
      </g>
    `}}class DungeonEntrance$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){g=0;0==a.dir&&(g=180);3==a.dir&&(g=90);1==a.dir&&(g=270);return html$$module$dungeonmap`
      <g transform="translate(${10*a.x}, ${10*a.y})">
        <g transform="rotate(${g}, 5, 5)">
          <rect x="0" y="1" width="10" height="1" fill="#292828" />
          <rect x="1" y="3" width="8" height="1" fill="#292828" />
          <rect x="2" y="5" width="6" height="1" fill="#292828" />
          <rect x="3" y="7" width="4" height="1" fill="#292828" />
          <rect x="4" y="9" width="2" height="1" fill="#292828" />
        </g>
      </g>
    `}}class DungeonPortal$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){g=0;"S"==a.wall&&(g=180);"E"==a.wall&&(g=90);"W"==a.wall&&(g=270);return 0==a.type?html$$module$dungeonmap`
        <g transform="translate(${10*a.x}, ${10*a.y})">
          <g transform="rotate(${g}, 5, 5)">
            <rect x="-1" y="5.5" width="12" height="3" fill="#292828" />
            <rect
              x="2"
              y="5"
              width="6"
              height="4"
              fill="#fff"
              stroke="#292828"
            />
            <title>${a.uuid}</title>
          </g>
        </g>
      `:html$$module$dungeonmap`
        <g transform="translate(${10*a.x}, ${10*a.y})">
          <g transform="rotate(${g}, 5, 5)">
            <rect x="-1" y="6.5" width="12" height="3" fill="#292828" />
            <text
              transform="translate(3, 9) rotate(90)"
              class="dcoords"
              alignment-baseline="baseline"
              text-anchor="middle"
              >S</text
            >
            <title>${a.uuid}</title>
          </g>
        </g>
      `}}
class DungeonPillars$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}render(a,g){if(50>a.w*a.h||1==a.w||1==a.h)return html$$module$dungeonmap``;g=[];if(a.w!=a.h)if(a.w<=a.h)for(var q=a.y+1;q<a.y+a.h;q++)g.push({x:10*(a.x+1),y:10*q}),g.push({x:10*(a.x+a.w-1),y:10*q});else for(q=a.x+1;q<a.x+a.w;q++)g.push({x:10*q,y:10*(a.y+1)}),g.push({x:10*q,y:10*(a.y+a.h-1)});return html$$module$dungeonmap`${g.map(u=>html$$module$dungeonmap` <circle cx="${u.x}" cy="${u.y}" r="2" fill="#212121" /> `)}`}}
class DungeonCavernLink$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}clicked(a){if(window.app.inhibit_click)window.app.inhibit_click=!1;else this.props.onClick(a)}get_path(a){let g="M "+a[0].x+","+a[0].y+" ";for(let q=1;q<a.length;q++)g=g+"L "+a[q].x+","+a[q].y+" ";return g+" Z"}render(a,g){g=html$$module$dungeonmap`
      <g transform="translate(${a.coords[0]} ${a.coords[1]})">
        <text
          transform="rotate(0)"
          class="dcoords"
          alignment-baseline="baseline"
          text-anchor="middle"
          >${a.number}</text
        >
      </g>
    `;g=html$$module$dungeonmap` <a onClick=${()=>this.clicked(a.uuid)}>
      <path d="${this.get_path(a.polygon)}" fill="transparent" />${g}</a
    >`;return html$$module$dungeonmap`<g>${g} </g>`}}
class DungeonCavern$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}make_line(a,g,q,u,B,E,F,K=!1,I=!1){let J=a=0,H=0;g!=u&&(a=5,J=(u-g)/5);q!=B&&(a=5,H=(B-q)/5);u="";for(K=K?0:1;K<=a-(I?0:1);K++)B=noise$$module$libs$perlin(this.inc),B*=1==K||K==a-1?.6:1.25,B*=0==K||K==a?.2:1.25,this.inc+=.2,u=u+" L "+(g+B*E+K*J)+","+(q+B*F+K*H);return u}get_path(a){let g="M "+a[0].x+","+a[0].y+" ";for(let q=1;q<a.length;q++){const u=1<a[q].c,B=1<a[q-1].c;if(B&&u){g=g+"L "+a[q].x+","+a[q].y+
" ";continue}const E=[-1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,1];this.rvi=this.rvi==E.length-1?0:this.rvi+1;let F=E[this.rvi];this.rvi=this.rvi==E.length-1?0:this.rvi+1;g+=this.make_line(this.props,a[q-1].x,a[q-1].y,a[q].x,a[q].y,F,E[this.rvi],B,u)}g+=this.make_line(this.props,a[a.length-1].x,a[a.length-1].y,a[0].x,a[0].y,0,0);return g+" Z"}render(a,g){this.rvi=this.inc=0;g="#666";a.reveal&&(g="#fff");a=html$$module$dungeonmap`<path
      d="${this.get_path(a.polygon)}"
      stroke="${g}"
      stroke-width="1"
      fill="${g}"
    />`;return html$$module$dungeonmap`<g>${a} </g>`}}class DungeonArea$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}make_line(a,g,q,u,B,E,F){let K=0,I=0,J=0;g!=u&&(K=5*a.w,I=g>u?-2:2);q!=B&&(K=5*a.h,J=q>B?-2:2);a="";u=0;for(B=0;B<=K;B++){let H=noise$$module$libs$perlin(u);H*=1==B||B==K-1?.6:1.5;H*=0==B||B==K?.2:1.5;u+=.3;a=a+" L "+(g+H*E+B*I)+","+(q+H*F+B*J)}return a}getPortalMask(a,g){return"E"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x}"
        y="${10*a.y-.2}"
        width="3"
        height="10.4"
        fill="${g}"
      />`:"W"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x+7}"
        y="${10*a.y-.2}"
        width="3"
        height="10.4"
        fill="${g}"
      />`:"N"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x-.2}"
        y="${10*a.y+7}"
        width="10.4"
        height="3"
        fill="${g}"
      />`:"S"==a.wall?html$$module$dungeonmap`<rect
        x="${10*a.x-.2}"
        y="${10*a.y}"
        width="10.4"
        height="3"
        fill="${g}"
      />`:html$$module$dungeonmap``}get_path(a){const g=10*a.x,q=g+10*a.w,u=10*a.y,B=u+10*a.h;return"M "+g+","+u+this.make_line(a,g,u,q,u,0,-1)+this.make_line(a,q,u,q,B,1,0)+this.make_line(a,q,B,g,B,0,1)+this.make_line(a,g,B,g,u,-1,0)+" Z"}render(a,g){g=a.vbx-0;var q=a.vby-0,u=a.vby+a.vbh+0;if(!(a.x*kScaleMultiplier$$module$dungeonmap>a.vbx+a.vbw+0||a.y*kScaleMultiplier$$module$dungeonmap>u||a.x*kScaleMultiplier$$module$dungeonmap+a.w*kScaleMultiplier$$module$dungeonmap<g||a.y*kScaleMultiplier$$module$dungeonmap+
a.h*kScaleMultiplier$$module$dungeonmap<q)){g="#666";a.reveal&&(g="#fff");q=html$$module$dungeonmap`<rect
      x="${10*a.x+.25}"
      y="${10*a.y+.25}"
      width="${10*a.w}"
      height="${10*a.h}"
      fill="${g}"
    />`;3==a.lod&&(q=html$$module$dungeonmap`<path d="${this.get_path(a)}" fill="${g}" />`);u=[];if(a.portals)for(const B of a.portals)0==B.type&&u.push(this.getPortalMask(B,g));return html$$module$dungeonmap`<g
      >${q}
      <${DungeonPillars$$module$dungeonmap} x=${a.x} y=${a.y} w=${a.w} h=${a.h} />
      ${u.map(B=>B)}
    </g>`}}}const vals$$module$dungeonmap=[{x:-1,y:0,r:.3},{x:-1,y:1,r:.6},{x:1,y:2,r:.2},{x:0,y:1,r:.4},{x:0,y:0,r:1},{x:1,y:2,r:.2},{x:-1,y:-1,r:.5},{x:0,y:0,r:.8},{x:2,y:1,r:.2},{x:0,y:0,r:.6},{x:0,y:0,r:1.3},{x:1,y:0,r:.9}];function DungeonCavernStains$$module$dungeonmap(a){let g=0;return html$$module$dungeonmap`
    ${a.polygon.map(q=>{let u=[];u.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;u.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;u.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;u.push(vals$$module$dungeonmap[g]);g=g==vals$$module$dungeonmap.length-1?0:g+1;if(1==q.c&&1==Math.floor(Math.abs(q.x))%3)return html$$module$dungeonmap`${u.map(B=>html$$module$dungeonmap`<circle
            cx="${q.x+B.x}"
            cy="${q.y+B.y}"
            r="${B.r}"
            fill="#212121"
          />`)}`})}
  `}
class DungeonAreaLink$$module$dungeonmap extends k$$module$libs$preact{constructor(){super()}clicked(a){if(window.app.inhibit_click)window.app.inhibit_click=!1;else this.props.onClick(a)}render(a,g){g=a.vbx-0;const q=a.vby-0,u=a.vby+a.vbh+0;if(!(a.x*kScaleMultiplier$$module$dungeonmap>a.vbx+a.vbw+0||a.y*kScaleMultiplier$$module$dungeonmap>u||a.x*kScaleMultiplier$$module$dungeonmap+a.w*kScaleMultiplier$$module$dungeonmap<g||a.y*kScaleMultiplier$$module$dungeonmap+a.h*kScaleMultiplier$$module$dungeonmap<q))return g=
html$$module$dungeonmap``,0!=a.t&&(g=html$$module$dungeonmap`
        <g
          transform="translate(${10*a.x+10*a.w/2} ${10*a.y+10*a.h/2+2})"
        >
          <text
            transform="rotate(0)"
            class="dcoords"
            alignment-baseline="baseline"
            text-anchor="middle"
            >${a.n}</text
          >
        </g>
      `),html$$module$dungeonmap`<a onClick=${()=>this.clicked(a.uuid)}
      ><rect
        x="${10*a.x}"
        y="${10*a.y}"
        width="${10*a.w}"
        height="${10*a.h}"
        fill="transparent"
      />
      ${g}
    </a>`}}function DungeonCaveMap$$module$dungeonmap(a){return html$$module$dungeonmap`
    <g transform="scale(${kScale$$module$dungeonmap}) rotate(0)">
      <g>
        <mask id="FilterMask">
          <rect
            x="-1000"
            y="-1000"
            width="2000"
            height="2000"
            filter="url(#noise)"
          />
        </mask>
        <mask id="AreasMask${a.uuid}">
          <g>
            ${a.dungeon.caverns.map(g=>html$$module$dungeonmap`<${DungeonCavern$$module$dungeonmap}
                lod="${a.lod}"
                reveal="${g.reveal}"
                polygon="${g.polygon}"
                offset=${a.offset}
                dim=${a.dim}
              />`)}
          </g>
        </mask>
      </g>
      <!--g mask="url(#AreasMask)"-->
      <g mask="url(#AreasMask${a.uuid})">
        <rect x="-1000" y="-1000" width="2000" height="2000" fill="#d5d1ce" />
        <g>
          <rect
            class="cgrid"
            x="-1000"
            y="-1000"
            width="2000"
            height="2000"
            mask="url(#FilterMask)"
            fill="url(#grid)"
          />
        </g>
      </g>
      <g>
        ${a.dungeon.caverns.map(g=>html$$module$dungeonmap`<${DungeonCavernStains$$module$dungeonmap} polygon="${g.polygon}" />`)}
      </g>
      <g>
        ${a.dungeon.caverns.map(g=>html$$module$dungeonmap`<${DungeonCavernLink$$module$dungeonmap}
            onClick=${a.onClick}
            uuid=${g.uuid}
            coords=${g.center}
            number=${g.n}
            lod="${a.lod}"
            polygon="${g.polygon}"
            offset=${a.offset}
            dim=${a.dim}
          />`)}
      </g>

      <g>
        ${a.dungeon.points.map(g=>html$$module$dungeonmap`<rect
            x=${g.x-3}
            y=${g.y-3}
            width="6"
            height="6"
            fill="#ff0000"
          />`)}
      </g>
    </g>
  `}function DungeonStructureMap$$module$dungeonmap(a){return html$$module$dungeonmap` <g transform="scale(${kScale$$module$dungeonmap}) rotate(0)">
    <g>
      <mask id="FilterMask">
        <rect
          x="-1000"
          y="-1000"
          width="2000"
          height="2000"
          filter="url(#noise)"
        />
      </mask>
      <mask id="AreasMask${a.uuid}">
        <g>
          ${a.dungeon.areas.map(g=>html$$module$dungeonmap`<${DungeonArea$$module$dungeonmap}
              lod="${a.lod}"
              x="${g.x}"
              y="${g.y}"
              w="${g.w}"
              h="${g.h}"
              portals="${g.portals}"
              passages="${g.passages}"
              reveal="${g.reveal}"
              vbx=${a.offset.x}
              vby=${a.offset.y}
              vbw=${a.dim.w}
              vbh=${a.dim.h}
            />`)}
        </g>
      </mask>
    </g>
    <!--g mask="url(#AreasMask)"-->
    <g mask="url(#AreasMask${a.uuid})">
      <rect x="-1000" y="-1000" width="2000" height="2000" fill="#d5d1ce" />
      <g>
        <rect
          class="cgrid"
          x="-1000"
          y="-1000"
          width="2000"
          height="2000"
          mask="url(#FilterMask)"
          fill="url(#grid)"
        />
        ${a.details}
        ${a.dungeon.stairs.map(g=>html$$module$dungeonmap`<${DungeonEntrance$$module$dungeonmap}
            lod="${a.lod}"
            x="${g.x}"
            y="${g.y}"
            dir="${g.d}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
          />`)}
      </g>
      <g>
        ${a.dungeon.areas.map(g=>html$$module$dungeonmap`<${DungeonAreaLink$$module$dungeonmap}
            onClick=${a.onClick}
            lod="${a.lod}"
            x="${g.x}"
            y="${g.y}"
            w="${g.w}"
            h="${g.h}"
            t="${g.t}"
            n="${g.n}"
            duuid="${a.uuid}"
            uuid="${g.uuid}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
          />`)}
      </g>
      <g>
        ${a.dungeon.portals.map(g=>html$$module$dungeonmap`<${DungeonPortal$$module$dungeonmap}
            lod="${a.lod}"
            x="${g.x}"
            y="${g.y}"
            wall="${g.wall}"
            type="${g.type}"
            uuid="${g.uuid}"
            vbx=${a.offset.x}
            vby=${a.offset.y}
            vbw=${a.dim.w}
            vbh=${a.dim.h}
          />`)}
      </g>
    </g>
  </g>`}
class DungeonMap$$module$dungeonmap extends k$$module$libs$preact{constructor(){super();this.areaClicked=this.areaClicked.bind(this);this.cavernClicked=this.cavernClicked.bind(this);this.loaded=!1;this.setState({errored:!1,show:!0,dungeon:{areas:[{x:10,y:10,w:50,h:50},{x:60,y:10,w:50,h:50},{x:10,y:70,w:50,h:50},{x:10,y:100,w:50,h:50},{x:200,y:20,w:50,h:50},{x:210,y:210,w:50,h:50}],portals:[]}});this.corners=[];this.uuid_to_coords={}}componentDidUpdate(a,g,q){this.props.uuid!=a.uuid&&this.request_map_data(this.props.hex)}setRevealByPeers(a){window.app.yarray.get(a.uuid)&&"reveal"==
window.app.yarray.get(a.uuid)[0]&&(a.reveal=!0)}processStructureData(a){function g(u,B,E,F){let K=!1;for(let I of F.areas)if(I!=u&&(B>=I.x&&B<=I.x+I.w&&E==I.y||B>=I.x&&B<=I.x+I.w&&E==I.y+I.h||E>=I.y&&E<=I.y+I.h&&B==I.x||E>=I.y&&E<=I.y+I.h&&B==I.x+I.w)){K=!0;break}return!K}this.corners=[];this.uuid_to_coords={};let q=0;a.stairs=[];a.portals=[];for(let u of a.areas){u.portals&&(a.portals=a.portals.concat(u.portals));void 0===u.uuid&&(u.uuid=q++);u.e&&a.stairs.push(u.e);this.setRevealByPeers(u);this.uuid_to_coords[u.uuid]=
[10*u.x+10*u.w/2,10*u.y+10*u.h/2];if(g(u,u.x,u.y,a)){const B=u.x,E=u.y;this.corners.push({x:B,y:E,d:`M ${10*B}, ${10*E} L
              ${10*(B+1)}, ${10*E} C
              ${10*B+2},${10*E+2}
              ${10*B+2},${10*E+2} ${10*B},
              ${10*(E+1)} Z`,culler:function(F,K,I,J){return B*kScaleMultiplier$$module$dungeonmap>I||E*kScaleMultiplier$$module$dungeonmap>J||(B+1)*kScaleMultiplier$$module$dungeonmap<F||(E+1)*kScaleMultiplier$$module$dungeonmap<K}})}if(g(u,u.x+u.w,u.y,a)){const B=u.x+u.w,E=u.y;this.corners.push({x:B,y:E,d:`M ${10*B}, ${10*E} L
              ${10*(B-1)}, ${10*E} C
              ${10*B-2},${10*E+2}
              ${10*B-2},${10*E+2} ${10*B},
              ${10*(E+1)} Z`,culler:function(F,K,I,J){return(B-1)*kScaleMultiplier$$module$dungeonmap>I||E*kScaleMultiplier$$module$dungeonmap>J||B*kScaleMultiplier$$module$dungeonmap<F||(E+1)*kScaleMultiplier$$module$dungeonmap<K}})}if(g(u,u.x+u.w,u.y+u.h,a)){const B=u.x+u.w,E=u.y+u.h;this.corners.push({x:B,y:E,d:`M ${10*B}, ${10*E} L
              ${10*(B-1)}, ${10*E} C
              ${10*B-2},${10*E-2}
              ${10*B-2},${10*E-2} ${10*B},
              ${10*(E-1)} Z`,culler:function(F,K,I,J){return(B-1)*kScaleMultiplier$$module$dungeonmap>I||(E-1)*kScaleMultiplier$$module$dungeonmap>J||B*kScaleMultiplier$$module$dungeonmap<F||E*kScaleMultiplier$$module$dungeonmap<K}})}if(g(u,u.x,u.y+u.h,a)){const B=u.x,E=u.y+u.h;this.corners.push({x:B,y:E,d:`M ${10*B}, ${10*E} L
              ${10*(B+1)}, ${10*E} C
              ${10*B+2},${10*E-2}
              ${10*B+2},${10*E-2} ${10*B},
              ${10*(E-1)} Z`,culler:function(F,K,I,J){return B*kScaleMultiplier$$module$dungeonmap>I||(E-1)*kScaleMultiplier$$module$dungeonmap>J||(B+1)*kScaleMultiplier$$module$dungeonmap<F||E*kScaleMultiplier$$module$dungeonmap<K}})}}this.setState({dungeon:a});this.loaded=!0}pointsToCoords(a){let g=[];for(let q=0;q<a.length;q++)g.push([a[q].x,a[q].y]);return g}processCaveData(a){a.points=[];this.uuid_to_coords={};let g=0;for(var q of a.caverns){var u=q.polygon;u.push(u[0]);turf.polygon([this.pointsToCoords(u)]);
u=polylabel$$module$libs$polylabel([this.pointsToCoords(u)],1);q.center=u;this.uuid_to_coords[q.uuid]=u;this.setRevealByPeers(q);for(u=0;u<q.polygon.length;u++){var B=q.polygon[u];if(1<B.c)continue;let E=q.polygon[0==u?q.polygon.length-1:u-1],F=q.polygon[u==q.polygon.length-1?0:u+1];q.polygon[u]={x:(B.x+(E.x+F.x)/2)/2,y:(B.y+(E.y+F.y)/2)/2};q.polygon[u].c=B.c}}q=[-1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,1,1];u=0;for(let E of a.caverns)for(B=0;B<E.polygon.length;B++)1==E.polygon[B].c&&
(g+=.1,E.polygon[B].x+=2*noise$$module$libs$perlin(g)*q[u],u=u==q.length-1?0:u+1,g+=.1,E.polygon[B].y+=2*noise$$module$libs$perlin(g)*q[u],u=u==q.length-1?0:u+1);this.setState({dungeon:a});this.loaded=!0}async request_map_data(a){api_call_dungeon$$module$api_shim(this.props.instance,a).then(g=>{void 0!==g.caverns?this.processCaveData(g):this.processStructureData(g)})}beginSyncWithPeers(){let a=this;window.app.yarray.observe(g=>{let q=a.state.dungeon;for(let u of q.areas)g.keysChanged.has(u.uuid)&&
window.app.yarray.get(u.uuid)&&"reveal"==window.app.yarray.get(u.uuid)[0]&&(u.reveal=!0);a.setState({dungeon:q})})}componentDidMount(a,g,q){this.request_map_data(this.props.hex);this.beginSyncWithPeers();let u=this;window.app.reroll_handlers.set("dungeon",async function(){await u.request_map_data(u.props.hex)})}componentWillUnmount(){window.app.reroll_handlers.delete("dungeon")}updatePeerOnReveal(a){window.app.yarray.set(a,["reveal"])}areaClicked(a){let g=this.state.dungeon;for(let q of g.areas)q.uuid===
a&&(q.reveal=!0,this.updatePeerOnReveal(q.uuid));this.setState({dungeon:g});this.uuid_to_coords[a]&&$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/location/"+a)}cavernClicked(a){let g=this.state.dungeon;for(let q of g.caverns)q.uuid===a&&(q.reveal=!0,this.updatePeerOnReveal(q.uuid));this.setState({dungeon:g});this.uuid_to_coords[a]&&$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/location/"+a)}render(a,g){if(0==this.loaded)return html$$module$dungeonmap`
        <polygon
          points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
          stroke="#ff0000"
          stroke-width="0"
          fill="#232121"
          style="stroke-width:0.2;"
        />
      `;let q=3;5E4>a.zoom_factor&&(q=2);let u=html$$module$dungeonmap``;const B=a.offset.x-0,E=a.offset.y-0,F=a.offset.x+a.dim.w+0,K=a.offset.y+a.dim.h+0;if(1<q){let I="";3==q&&(I="filter: url(#displacementFilter)");u=html$$module$dungeonmap`<g opacity="0.3"
        >${this.corners.map(J=>{if(!J.culler(B,E,F,K))return html$$module$dungeonmap` <circle
            cx="${10*J.x}"
            cy="${10*J.y}"
            r="7"
            fill="#444444"
            style="${I}"
          />`,html$$module$dungeonmap` <path d="${J.d}" fill="#444444" style="${I}" />`})}
      </g>`}noiseSeed$$module$libs$perlin(10);a=void 0!==g.dungeon.caverns?html$$module$dungeonmap`<${DungeonCaveMap$$module$dungeonmap}
            dungeon=${g.dungeon}
            onClick=${this.cavernClicked}
            details=${u}
            uuid=${a.uuid}
            lod=${q}
            offset=${a.offset}
            dim=${a.dim}
          />`:html$$module$dungeonmap`<${DungeonStructureMap$$module$dungeonmap}
            dungeon=${g.dungeon}
            onClick=${this.areaClicked}
            details=${u}
            uuid=${a.uuid}
            lod=${q}
            offset=${a.offset}
            dim=${a.dim}
          />`;return html$$module$dungeonmap`
      <defs>
        <pattern
          id="smallGrid"
          width="5"
          height="5"
          patternUnits="userSpaceOnUse"
        >
          <path
            d="M 5 0 L 0 0 0 5"
            fill="none"
            stroke="#86817c"
            stroke-width="0.2"
          />
        </pattern>
        <pattern
          id="grid"
          overflow="visible"
          width="10"
          height="10"
          patternUnits="userSpaceOnUse"
        >
          <rect width="10" height="10" fill="url(#smallGrid)" />
          <path
            d="M 10 0 L 0 0 0 10"
            fill="none"
            stroke="#86817c"
            stroke-width="1"
          />
        </pattern>
      </defs>
      <style>
        .cgrid {
          //filter: contrast(2.3);
        }
        .dcoords {
          font-size: 0.3em;
          font-family: 'Lakki Reddy';
          font-weight: bolder;
          paint-order: stroke;
          pointer-events: none;
          fill: #ddd;
          stroke: #333;
          stroke-width: 3px;
          stroke-linejoin: bevel;
        }
      </style>
      <filter id="noise" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence
          type="fractalNoise"
          baseFrequency="0.25"
          numOctaves="10"
          seed="15"
          stitchTiles="stitch"
          result="turbulence"
        ></feTurbulence>
        <feComponentTransfer>
          <feFuncR type="discrete" tableValues="0 0 1 1" />
          <feFuncG type="discrete" tableValues="2 2 0 0" />
          <feFuncB type="discrete" tableValues="0 0 1 1" />
        </feComponentTransfer>
      </filter>
      <filter id="displacementFilter">
        <feTurbulence
          type="turbulence"
          baseFrequency="0.5"
          numOctaves="10"
          result="turbulence"
        />
        <feDisplacementMap
          in2="turbulence"
          in="SourceGraphic"
          scale="5"
          xChannelSelector="R"
          yChannelSelector="G"
        />
      </filter>
      <polygon
        points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"
        stroke="#ff0000"
        stroke-width="0"
        fill="#232121"
        style="stroke-width:0.2;"
      />
      ${a}
    `}}var module$dungeonmap={};module$dungeonmap.DungeonMap=DungeonMap$$module$dungeonmap;const html$$module$hex=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function clamp$$module$hex(a,g,q){return Math.min(Math.max(a,g),q)}function getOffset$$module$hex(a,g,q=0,u=0){return[30*a+Math.abs(g)%2*15-q,10.4*g*Math.cos(Math.PI/6)-u]}function getHexCoords$$module$hex(a,g){g/=10.4*Math.cos(Math.PI/6);return[Math.floor(a/30+Math.abs(g)%2),Math.floor(g)]}
function intersects$$module$hex(a,g,q,u,B,E){a=Math.abs(a-(q+B/2));g=Math.abs(g-(u+E/2));return a>B/2+9||g>E/2+9?!1:a<=B/2||g<=E/2?!0:81>=(a-B/2)**2+(g-E/2)**2}class Borderline$$module$hex extends k$$module$libs$preact{constructor(a){super();this.cls="borderline_fixed"}render(a,g){"borderline"==this.cls?this.cls="borderline_fixed":"continent"==this.cls&&(this.cls="borderline");.5>a.zoom_factor&&(this.cls="continent");return html$$module$hex` <g
      ><polygon
        class="${this.cls}"
        strokeWidth="${.15*a.arm}"
        strokeLinecap="round"
        fill="transparent"
        color="#ff0000"
        stroke="${a.color}"
        points="${a.borders}"
      />
    </g>`}}function makeHex$$module$hex(a){const g=20.8*Math.cos(Math.PI/6),q=a[0]-10;a=a[1]-g/2+.16;return[[5+.1/Math.sqrt(3)+q,.1+a],[15-.1/Math.sqrt(3)+q,.1+a],[20-2/Math.sqrt(3)*.1+q,.5*g+a],[15-.1/Math.sqrt(3)+q,g-.1+a],[5+.1/Math.sqrt(3)+q,g-.1+a],[2/Math.sqrt(3)*.1+q,.5*g+a]].join()}
class Hex$$module$hex extends k$$module$libs$preact{constructor(a){super();this.state={errored:!1,pod:"pod",class:"base",uuid:a.uuid};this.basics=!1}componentDidUpdate(){window.app.last_selected!=this&&(this.state.class="base")}getOffset(a=0,g=0){return getOffset$$module$hex(this.props.nx,this.props.ny,a,g)}getTranslation(a){return"translate("+a[0].toString()+", "+a[1].toString()+")"}getTranslationOff(a,g,q){return"translate("+(a[0]-g).toString()+", "+(a[1]-q).toString()+")"}clicked(a){a.preventDefault();
window.app.inhibit_click?window.app.inhibit_click=!1:(this.props.menuHandler.onEditMenu(this.props.nx,this.props.ny,this.props.uuid,this),this.setState({class:"selected"}),window.app.last_selected&&window.app.last_selected.setState({class:"baseout"}),window.app.last_selected=this)}render(a){const g=getOffset$$module$hex(a.nx,a.ny);if(!(.5>a.zoom_factor||g[0]<this.props.ox-20||g[1]<this.props.oy-20||g[0]>this.props.ox+this.props.dimw+20||g[1]>this.props.oy+this.props.dimh+20)){this.pod=a.type;this.t_poly=
this.getTranslation(g);var q=clamp$$module$hex(a.zoom_factor/5E3,0,1),u=clamp$$module$hex((a.zoom_factor-2500)/5E3,0,1),B="empty-"==this.props.res?html$$module$hex``:html$$module$hex` <g opacity="${1-q}"
            ><use
              xlink:href="${window.app.theme}.svg#${this.props.res}${this.pod}"
              fill="${this.props.color}"
              transform="${this.t_poly}"
            />
          </g>`,E=a.riverline&&20<a.zoom_factor?html$$module$hex`
            <g opacity="${1-q}">
              <path
                d="${a.riverline}"
                stroke="#1166aa"
                xstroke="#333333"
                stroke-width="2.25"
                fill="none"
              />
              <path
                d="${a.riverline}"
                stroke="#3399cc"
                stroke-width="1.75"
                stroke-dasharray="4 1 2 3 1 3 2 6 4 3 5 6 7 3 2 1 7 6 4 5 6 3 5 4 1 2 3 4"
                stroke-dashoffset="3"
                fill="none"
              >
                <animate
                  id="p1"
                  attributeName="stroke-dashoffset"
                  begin="0.1s;f1.end+0.4s"
                  values="2037;0"
                  dur="1015s"
                  calcMode="linear"
                  repeatCount="indefinite"
                />
              </path>
              <path
                d="${a.riverline}"
                stroke="#1166aa"
                xstroke="#333333"
                stroke-width="1.5"
                fill="none"
              />
            </g>
          `:a.riverline?html$$module$hex` <g opacity="${1-q}">
            <path
              d="${a.riverline}"
              stroke="#1166aa"
              xstroke="#333333"
              stroke-width="2.25"
              fill="none"
            />
          </g>`:html$$module$hex``,F=a.trailslines?html$$module$hex` <g opacity="${1-q}">
          ${a.trailslines.map(I=>html$$module$hex`
              <path
                d="${I}"
                stroke="#22222255"
                stroke-width="1"
                stroke-linecap="round"
                stroke-dasharray="0 2"
                fill="none"
              />
            `)}
        </g>`:html$$module$hex``,K=1E3<a.zoom_factor?intersects$$module$hex(g[0],g[1],a.ox,a.oy,a.dimw,a.dimh):!1;q="City"!=a.feature&&"Town"!=a.feature||!K?"Village"==a.feature&&K?html$$module$hex` <g opacity="${q}" transform="${this.t_poly}">
            <${VillageMap$$module$villagemap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
            />
          </g>`:html$$module$hex``:html$$module$hex` <g opacity="${q}" transform="${this.t_poly}">
            <${CityMap$$module$citymap}
              id=${a.feature_uuid}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              location=${a.location_uuid}
            />
          </g>`;a="Dungeon"==a.feature&&1E3<a.zoom_factor&&K?html$$module$hex` <g opacity="${u}" transform="${this.t_poly}">
            <${DungeonMap$$module$dungeonmap}
              instance=${a.instance}
              hex=${a.uuid}
              uuid=${a.feature_uuid}
              offset=${({x:a.ox-g[0],y:a.oy-g[1]})}
              dim=${({w:a.dimw,h:a.dimh})}
              zoom_factor=${a.zoom_factor}
            />
          </g>`:html$$module$hex``;return html$$module$hex`<a onClick=${I=>this.clicked(I)}>
        <use
          xlink:href="${window.app.theme}.svg#empty-${this.pod}"
          fill="${this.props.color}"
          transform="${this.t_poly}"
        />${E}${B}${F}
      </a>
      ${q}${a}`}}}var module$hex={};module$hex.Borderline=Borderline$$module$hex;module$hex.Hex=Hex$$module$hex;module$hex.getHexCoords=getHexCoords$$module$hex;module$hex.getOffset=getOffset$$module$hex;module$hex.makeHex=makeHex$$module$hex;function makeRealmPolygon$$module$api(a){function g(K,I,J){B.push([{x:I[0]+K[0],y:I[1]+K[1]},{x:J[0]+K[0],y:J[1]+K[1]}])}function q(K){return Math.floor(K/3).toFixed(15)}var u=20.8*Math.cos(Math.PI/6);let B=[];for(var E of a){a=getOffset$$module$hex(E.hex_x,E.hex_y,10,7.5*1.04);for(var F of E.borders)0==F&&g(a,[5+.1/Math.sqrt(3),.1],[15-.1/Math.sqrt(3),.1]),1==F&&g(a,[15-.1/Math.sqrt(3),.1],[20-2/Math.sqrt(3)*.1,.5*u]),2==F&&g(a,[20-2/Math.sqrt(3)*.1,.5*u],[15-.1/Math.sqrt(3),u-.1]),3==F&&g(a,[15-
.1/Math.sqrt(3),u-.1],[5+.1/Math.sqrt(3),u-.1]),4==F&&g(a,[5+.1/Math.sqrt(3),u-.1],[2/Math.sqrt(3)*.1,.5*u]),5==F&&g(a,[2/Math.sqrt(3)*.1,.5*u],[5+.1/Math.sqrt(3),.1])}u=[];E=B[0][1];F=0;for(u.push({x:E.x,y:E.y});;){B.splice(F,1);if(0==B.length)break;F=0;for(a=0;a<B.length;a++){const K=B[a];if(q(K[0].x)===q(E.x)&&q(K[0].y)===q(E.y)){u.push({x:K[1].x,y:K[1].y});E=K[1];break}if(q(K[1].x)===q(E.x)&&q(K[1].y)===q(E.y)){u.push({x:K[0].x,y:K[0].y});E=K[0];break}F++}if(F==B.length)return console.log("ERROR"),
[]}return u}function makeWall$$module$api(a){let g="";a.forEach(function(q){g=g+q.x+","+(q.y-1)+" "});return g}function makeRealmLabel$$module$api(a,g){if(0<g.length){const q=get_polygon_centroid$$module$utils(g);g=get_polygon_area$$module$utils(g);return[a.name.split(/[ ]/),q,clamp$$module$utils(1E-5*g,1,2)]}return[[],{x:0,y:0},2]}
function RiverLine$$module$api(a,g,q){function u(F,K,I){E.push([{x:K[0]+F[0],y:K[1]+F[1]},{x:I[0]+F[0],y:I[1]+F[1]}])}const B=20.8*Math.cos(Math.PI/6);let E=[];a=getOffset$$module$hex(a,g,10,10.4*Math.cos(Math.PI/6));g=[10+.1/Math.sqrt(3),.5*B];for(const F of q)0==F&&u(a,[10+.1/Math.sqrt(3),.1],g),1==F&&u(a,[17.5-.1/Math.sqrt(3),.25*B],g),2==F&&u(a,[17.5-.1/Math.sqrt(3),.75*B],g),3==F&&u(a,[10+.1/Math.sqrt(3),B-.1],g),4==F&&u(a,[2.5+.1/Math.sqrt(3),.75*B],g),5==F&&u(a,[2.5+.1/Math.sqrt(3),.25*B],
g);q="";if(1==E.length)for(const F of E)q=q+"M "+F[1].x+" "+F[1].y+" L "+F[0].x+" "+F[0].y+" ";2==E.length&&(q=q+"M "+E[0][0].x+" "+E[0][0].y+" C "+E[0][1].x+" "+E[0][1].y+","+E[0][1].x+" "+E[0][1].y+","+E[1][0].x+" "+E[1][0].y+" ");return q}
function convertHexType$$module$api(a){let g=a.type;"empty"!=a.type&&(g="DesertHex"==a.type?"desert":"PlainsHex"==a.type?"plains":"TundraHex"==a.type?"tundra":"JungleHex"==a.type?"jungle":"SwampsHex"==a.type?"swamps":"CoastHex"==a.type?"coast":"OceanHex"==a.type?"ocean":"ForestHex"==a.type?3<a.x%3+a.y%4&&void 0===a.feature?"forest-var":"forest":"mountains");void 0!==a.feature&&(g+={Inn:"-inn",Residency:"-inn",Dungeon:"-dungeon",Village:"-village",Town:"-town",City:"-city"}[a.feature]);return g}
function setupHexProps$$module$api(a){a.rivers&&(a.riverline=RiverLine$$module$api(a.x,a.y,a.rivers));if(a.trails){let g=[];if(a.trails){let q=0;1==a.trails.length%2&&(g.push([a.trails[q]]),q++);for(;q<a.trails.length;q+=2)g.push([a.trails[q],a.trails[q+1]])}a.trailslines=[];g.map(q=>{a.trailslines.push(RiverLine$$module$api(a.x,a.y,q))})}a.type=convertHexType$$module$api(a)}
class MapData$$module$api{constructor(){this.reset()}reset(){this.uuid_to_coords={};this.populated_coords=new Map}neighbor(a,g){switch(g){case 1:return{x:a.x,y:a.y-2};case 2:return{x:a.x+a.y%2,y:a.y-1};case 3:return{x:a.x+a.y%2,y:a.y+1};case 4:return{x:a.x,y:a.y+2};case 5:return{x:a.x-(a.y+1)%2,y:a.y+1};case 6:return{x:a.x-(a.y+1)%2,y:a.y-1}}}getHexDataByUUID(a){return this.uuid_to_coords[a]}hexRegion(a){return this.uuid_to_coords[a].region}hexRealm(a){return this.uuid_to_coords[a].realm}isPopulated(a,
g){return this.populated_coords.has(""+a+"-"+g)}isOccupied(a){a=this.getHexDataByUUID(a);return void 0===a?!1:void 0!==a.feature}isBorderline(a){a=this.getHexDataByUUID(a);return void 0===a?!1:a.borderline}isCoastal(a){a=this.getHexDataByUUID(a);if(void 0===a)return!1;for(let g=1;6>=g;g++){const q=this.neighbor({x:a.x,y:a.y},g);if(!this.isPopulated(q.x,q.y))return!0}return!1}addOceanHex(a,g){this.uuid_to_coords[""+a+g]={x:a,y:g,type:"",feature:""}}reload(a,g){return new Promise(q=>{window.app.map_cache&&
!g&&(this.hexlist=window.app.map_cache.hexlist,this.borders=window.app.map_cache.borders,this.uuid_to_coords=window.app.map_cache.uuid_to_coords,this.populated_coords=window.app.map_cache.populated_coords,this.loaded=!0,this.postMapLoadedCallback&&this.postMapLoadedCallback(),q());this.reset();api_call_map$$module$api_shim(a).then(u=>{if(u&&u.map){this.regions=u.regions;var B=[],E=[];u.borders||(u.borders={});Object.keys(u.borders).forEach(I=>{const J=makeRealmPolygon$$module$api(u.borders[I]);B.push({uuid:I,
wall:makeWall$$module$api(J),poly:J});E.push(makeRealmLabel$$module$api(u.realms[I],J))});u.map||(u.map=[]);var F=[];u.map.map(I=>{setupHexProps$$module$api(I);F.push({x:I.x,y:I.y});this.uuid_to_coords[I.uuid]={x:I.x,y:I.y,type:I.type,feature:I.feature,feature_uuid:I.feature_uuid,harbor:I.harbor,borderline:I.borderline,region:I.region,realm:I.realm};this.populated_coords.set(""+I.x+"-"+I.y,I.uuid)});var K=get_centroidic_point$$module$utils(F);K=getOffset$$module$hex(K.x,K.y);this.hexlist=u.map;this.borders=
B;this.initial_offset={x:K[0],y:K[1]};this.realm_labels=E;this.postMapLoadedCallback&&this.postMapLoadedCallback();window.app.map_cache={hexlist:u.map,borders:B,realm_labels:E,uuid_to_coords:this.uuid_to_coords,populated_coords:this.populated_coords};q(!0)}else q(!1)})})}}var module$api={};module$api.MapData=MapData$$module$api;module$api.RiverLine=RiverLine$$module$api;const html$$module$hexmap=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);function Underwear$$module$hexmap(a){return html$$module$hexmap` <g><polygon class="underwear" points="${a.borders}" /> </g>`}const max_prefill$$module$hexmap=3E3;
class HexMap$$module$hexmap extends SvgMap$$module$SvgMap{constructor(){super();this.map_data=new MapData$$module$api;const a=getOffset$$module$hex(480,480,0,0);this.setState({errored:!1,offset:{x:a[0],y:a[1]},dim:{w:1500,h:1500},col1:"col1",res:"empty-",hexlist:[],borders:[],realm_labels:[],sea:[],spinner:!1});this.loaded=this.selected=!1;this.labels=[];this.prefillOceanHexes()}prefillOceanHexes(){this.sea=[];for(let a=0;a<max_prefill$$module$hexmap;a++)this.sea.push({x:0,y:0,type:"ocean",uuid:"ocean"})}fillOceanHexes(a,
g,q,u){let B=0,E=[];if(30>this.state.zoom_factor&&(this.drag||this.camera_moving))return[];if(10<this.state.zoom_factor){const F=getHexCoords$$module$hex(a,g);a=getHexCoords$$module$hex(a+q,g+u);for(g=F[0]-2;g<a[0]+1;g++)for(q=F[1];q<a[1]+2;q++)this.map_data.isPopulated(g,q)||(u=this.sea[B],B+=B==max_prefill$$module$hexmap-1?0:1,u.x=g,u.y=q,E.push(u))}return E}makeRealmLabel(a,g){const q=get_polygon_centroid$$module$utils(g);g=get_polygon_area$$module$utils(g);return[a.name.split(/[ ]/),q,clamp$$module$utils(1E-5*
g,1,2)]}getMatrix(a){this.props.spinner(1,!0);this.map_data.reload(this.props.instance,a).then(g=>{g&&(this.setState({hexlist:this.map_data.hexlist,borders:this.map_data.borders,offset:this.loaded?this.state.offset:{x:this.map_data.initial_offset.x-this.state.dim.w/2,y:this.map_data.initial_offset.y-this.state.dim.h/2},realm_labels:this.map_data.realm_labels}),this.navigateToHex(this.props.hex_uuid),this.loaded=!0,this.postMapLoadedCallback&&this.postMapLoadedCallback(),this.makeRegionLabels());this.setState({spinner:!1});
this.props.spinner(1,!1)})}onRerollHex(a){this.setState({spinner:!0});this.props.spinner(1,!0);fetch("/reroll/"+this.props.instance+"/"+a+"/default",{method:"GET"}).then(g=>401===g.status?(window.app.unauth(),this.getMatrix(),Promise.reject(g)):g.json()).then(g=>{this.state.menu.c.setState({uuid:g.uuid});this.state.menu.uuid=g.uuid;delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onClearHexRiver(a){this.props.spinner(1,!0);fetch("/clear/"+this.props.instance+"/"+
a+"/river",{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onClearHexTrails(a){this.props.spinner(1,!0);fetch("/clear/"+this.props.instance+"/"+a+"/trails",{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onDrawRiver(a){fetch("/draw/"+this.props.instance+"/"+a+"/river",{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>
{console.error("Error:",g)})}onAppendMenu(){let a=this.state.menu;a.type=1;this.setState({menu:a})}onRerollMenu(){let a=this.state.menu;a.type=2;this.setState({menu:a})}onDeleteMenu(){let a=this.state.menu;a.type=3;this.setState({menu:a})}onRollSettlementMenu(){let a=this.state.menu;a.type=4;this.setState({menu:a})}onAppendRealm(){this.props.appendDialog(this.state.menu)}onRemapEntity(a){this.props.spinner(1,!0);this.setState({spinner:!0});fetch("/remap/",{method:"POST",headers:{Accept:"application/json",
"Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a})}).then(g=>{401===g.status&&window.app.unauth();g.text()}).then(g=>{this.getMatrix(!0)}).catch(g=>{console.error("Error:",g)})}onAppendSettlement(a,g){this.props.spinner(1,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:"Settlement",type:g})}).then(q=>q.text()).then(q=>{this.getMatrix(!0)}).catch(q=>
{console.error("Error:",q)})}onAppendFeature(a,g,q){this.props.spinner(1,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:g,type:q})}).then(u=>u.text()).then(u=>{this.getMatrix(!0)}).catch(u=>{console.error("Error:",u)})}makeRegionLabels(){let a=new Map;for(const B of this.map_data.hexlist)a.has(B.region)||a.set(B.region,{label:this.map_data.regions[B.region],coords:[]}),a.get(B.region).coords.push([B.x,
B.y]);let g=[],q=null,u=null;a.forEach(B=>{var E=null;let F=null,K=null,I=null,J=0,H=[];for(const N of B.coords){J++;const T=N[0],O=N[1];H.push({x:T,y:O});if(!E||T<E)E=T;if(!K||O<K)K=O;if(!F||T>F)F=T;if(!I||O>I)I=O}if(!q||J<q)q=J;if(!u||J>u)u=J;E=get_centroidic_point$$module$utils(H);E=getOffset$$module$hex(E.x,E.y,0,0);g.push({name:B.label.split(/[ ]/),x:E[0],y:E[1],r:18-B.label.length,n_hexes:J})});for(let B of g)B.fontsize=B.n_hexes/u*.2+.2;this.labels=g}filterPointerCapture(a,g){var q=document.getElementById("canvas");
let u=q.createSVGPoint();u.x=a;u.y=g;a=u.matrixTransform(q.getScreenCTM().inverse());return this.selected&&this.state.menu&&10>this.state.zoom_factor?(g=this.state.menu.offset.x,q=this.state.menu.offset.y,a=(a.x-g)*(a.x-g)+(a.y-q)*(a.y-q),256>a&&32<a):!1}onEditMenu(a,g,q,u){if(this.props.hex_uuid)"ocean"==q?(this.map_data.addOceanHex(a,g),$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/coords/"+a+g)):$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+
q);else{var B=getOffset$$module$hex(a,g);this.selected=!0;if(window.app.locked)this.onSelectHex(q);else this.setState({menu:{type:0,c:u,uuid:q,offset:{x:B[0],y:B[1]},nx:a,ny:g}})}}postMapLoaded(a){this.loaded?a():this.postMapLoadedCallback=a}onClickRealm(a){window.app.inhibit_click||$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/realm/"+a)}navigateToRealm(a){for(const q of this.state.borders)if(q.uuid==a){var g=get_polygon_extents$$module$utils(q.poly);const u=1.1*g.w;g=1.1*
g.h;const B=get_polygon_centroid$$module$utils(q.poly);this.minimapOnLocation(B.x,B.y,u,g)}}navigateToHex(a,g){function q(K,I,J){J*=Math.PI/180;var H={};H.x=K*Math.cos(J)-I*Math.sin(J);H.y=K*Math.sin(J)+I*Math.cos(J);return H}a=this.map_data.getHexDataByUUID(a);if(void 0!==a){var u=0,B=0;g&&(u=g.x,B=g.y);var E=200;"City"!=a.feature&&"Town"!=a.feature||void 0===a.harbor||(B=q(u,B-900,60*a.harbor),u=B.x,B=B.y);"Village"==a.feature&&(void 0!==a.harbor&&(E=q(u,B-675,60*a.harbor),u=E.x,B=E.y),E=100);"Dungeon"==
a.feature&&(E=100);var F=getOffset$$module$hex(a.x,a.y);g?(F[0]+=u/E,F[1]+=B/E,this.focused_hex=null):this.focused_hex=a;this.minimapOnLocation(F[0],F[1],g?g.zoom:100,g?g.zoom:100)}}onSelectHex(a){if(void 0===this.map_data.getHexDataByUUID(a))console.debug("no hex data");else{this.onSelectHexInoked=!0;$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/hex/"+a);var g=this;window.setTimeout(()=>{g.navigateToHex(a)},500)}}onRemoveEntity(a){this.props.spinner(1,!0);this.setState({spinner:!0});
fetch("/remove/"+this.props.instance+"/"+a,{method:"GET"}).then(g=>g.json()).then(g=>{delete window.app.map_cache;this.getMatrix()}).catch(g=>{console.error("Error:",g)})}onRemoveHex(a){this.onRemoveEntity(a)}onRemoveRegion(a){this.onRemoveEntity(this.map_data.hexRegion(a))}onRemoveRealm(a){this.onRemoveEntity(this.map_data.hexRealm(a))}componentDidMount(a,g,q){this.getMatrix();super.componentDidMount(a,g,q);window.addEventListener("keydown",u=>this.onKeyDown(u))}onKeyDown(a){if(this.focused_hex&&
this.props.hex_uuid){var g=this.focused_hex.y,q=this.focused_hex.x;"w"==a.key&&(g-=2);"s"==a.key&&(g+=2);"e"==a.key&&(--g,0==Math.abs(g)%2&&q++);"q"==a.key&&(--g,1==Math.abs(g)%2&&q--);"a"==a.key&&(g+=1,1==Math.abs(g)%2&&q--);"d"==a.key&&(g+=1,0==Math.abs(g)%2&&q++);var u=this.map_data.populated_coords.get(""+q+"-"+g);u&&(this.navigateToHex(u),this.on_key_down_to&&window.clearTimeout(this.on_key_down_to),this.on_key_down_to=window.setTimeout(()=>{$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+
"/hex/"+u)},500))}}componentDidUpdate(a,g,q){(a.hex_uuid!=this.props.hex_uuid&&this.props.hex_uuid&&a.hex_uuid||!a.hex_uuid&&this.props.hex_uuid&&!this.onSelectHexInoked)&&this.navigateToHex(this.props.hex_uuid);this.onSelectHexInoked&&(this.onSelectHexInoked=!1);0==a.locked&&1==this.props.locked&&(this.selected=null)}is_within_frustrum(a,g=40){return a.x>this.state.offset.x-g||a.y>this.state.offset.y-g||a.x<this.state.offset.x+this.state.dim.w+g||a.y<this.state.offset.y+this.state.dim.h+g}hexBitmask(){const a=
this.state.menu.uuid;let g=0;"ocean"===a&&(g|=HexBitmask$$module$hexmenu.IS_HEX_AN_OCEAN);this.map_data.isOccupied(a)&&(g|=HexBitmask$$module$hexmenu.IS_HEX_OCCUPIED);this.map_data.isCoastal(a)&&(g|=HexBitmask$$module$hexmenu.IS_HEX_COASTAL);this.map_data.isBorderline(a)&&(g|=HexBitmask$$module$hexmenu.IS_HEX_HAS_BORDER);return g}render(a,g){var q=this.focused_hex?getOffset$$module$hex(this.focused_hex.x,this.focused_hex.y,0,0):null;q=this.focused_hex?html$$module$hexmap`
          <polygon
            class="focused-hex"
            points=${makeHex$$module$hex(q)}
          >
          </circle>
        `:html$$module$hexmap``;var u=1<g.zoom_factor&&1500>g.zoom_factor&&!a.locked&&!g.spinner;u||(this.selected=!1);var B=5/Math.sqrt(g.zoom_factor);u=this.state.menu?html$$module$hexmap`<${HexMenu$$module$hexmenu}
          menu=${this.state.menu}
          cond=${u}
          bitmask=${this.hexBitmask()}
          handler=${this}
          scale=${Math.min(Math.max(1.5*B,.5),3)}
        />`:html$$module$hexmap``;B=this.fillOceanHexes(g.offset.x,g.offset.y,g.dim.w,g.dim.h);let E=this.state.col1;E=a.hex_uuid?"rect1":"col1";return html$$module$hexmap`<div
      id="hexmap"
      class="${E}"
      style="overflow:hidden;${a.visible?"":"display:none;"}"
    >
      <svg
        id="canvas"
        class="${a.desaturate_palette?"desaturated":"colorful"}"
        preserveAspectRatio="xMidYMid meet"
        viewBox="${this.state.offset.x} ${this.state.offset.y} ${this.state.dim.w} ${this.state.dim.h}"
      >
        <g id="viewport">
          <g class="pod-wrap">
            <g opacity="${this.state.zoom_factor/40}">
              ${B.map(F=>html$$module$hexmap`<${Hex$$module$hex}
                  res="${g.res}"
                  type="${F.type}"
                  class="base"
                  uuid="${F.uuid}"
                  nx="${F.x}"
                  ny="${F.y}"
                  ox="${g.offset.x}"
                  oy="${g.offset.y}"
                  dimw="${g.dim.w}"
                  dimh="${g.dim.h}"
                  zoom_factor=${g.zoom_factor}
                  menuHandler="${this}"
                />`)}
            </g>
            <g>
              ${g.borders.map(F=>html$$module$hexmap` <${Underwear$$module$hexmap} borders="${F.wall}" />`)}
            </g>
            ${g.hexlist.map(F=>html$$module$hexmap`<${Hex$$module$hex}
                res="${g.res}"
                type="${F.type}"
                feature="${F.feature}"
                feature_uuid="${F.feature_uuid}"
                class="base"
                instance="${a.instance}"
                uuid=${F.uuid}
                riverline=${F.riverline}
                trailslines=${F.trailslines}
                location_uuid=${a.hex_uuid}
                nx="${F.x}"
                ny="${F.y}"
                zoom_factor=${g.zoom_factor}
                ox="${g.offset.x}"
                oy="${g.offset.y}"
                dimw="${g.dim.w}"
                dimh="${g.dim.h}"
                menuHandler="${this}"
              />`)}
            <g>
              ${g.borders.map(F=>html$$module$hexmap`<a onClick=${()=>this.onClickRealm(F.uuid)}>
                  <${Borderline$$module$hex}
                    borders="${F.wall}"
                    arm="10"
                    color="#ffffff"
                    zoom_factor=${g.zoom_factor}
                    ox="${this.state.offset.x}"
                    oy="${this.state.offset.y}"
                    dimw="${this.state.dim.w}"
                    dimh="${this.state.dim.h}"
                /></a>`)}
            </g>
            <g>${q}</g>
            <g>
              ${"col1"==E&&a.show_labels?this.labels.map(F=>{if(this.is_within_frustrum(F)){let K=(this.state.zoom_factor-5)/10,I=0,J=1;100<this.state.zoom_factor&&(K=this.state.zoom_factor/1E3,I=1,J=-1);return html$$module$hexmap`
                        <text
                          opacity="${I+J*clamp$$module$utils(K,0,1)}"
                          transform="translate( ${F.x} , ${F.y}) rotate( ${F.r})"
                          class="region-label"
                          font-size="${F.fontsize}em"
                          text-anchor="middle"
                        >
                          ${F.name.map((H,N)=>html$$module$hexmap`<tspan x="0" y="${N-2}em" dy="1em"
                              >${H}</tspan
                            >`)}
                        </text>
                      `}}):html$$module$hexmap``}
            </g>
            <g>
              ${a.show_labels?this.state.realm_labels.map(F=>html$$module$hexmap`
                      <text
                        opacity="${1-clamp$$module$utils((this.state.zoom_factor-3)/10,0,1)}"
                        transform="translate( ${F[1].x} , ${F[1].y})"
                        class="realm-label"
                        font-size="${F[2]}em"
                        text-anchor="middle"
                      >
                        ${F[0].map((K,I)=>html$$module$hexmap`<tspan x="0" y="${I-2}em" dy="1em"
                            >${K}</tspan
                          >`)}
                      </text>
                    `):html$$module$hexmap``}
            </g>
          </g>
        </g>
        <g>${u}</g>
      </svg>
    </div>`}}var module$hexmap={};module$hexmap.HexMap=HexMap$$module$hexmap;const html$$module$spinner=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class Spinner$$module$spinner extends k$$module$libs$preact{constructor(){super()}render(a){return html$$module$spinner`
      <div id="hexspinner" style="${a.style}">
        <svg
          width="${a.width}"
          id="eefEsROxk9w1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          viewBox="0 0 640 480"
          shape-rendering="geometricPrecision"
          text-rendering="geometricPrecision"
          style="background:transparent;"
        >
          <style>
            #eefEsROxk9w2_ts {
              animation: eefEsROxk9w2_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w2_ts__ts {
              0% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(0, 0);
              }
              34.482759% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(1, 1);
              }
              68.965517% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(328.585373px, 76.258278px)
                  rotate(91.041629deg) scale(0, 0);
              }
            }
            #eefEsROxk9w3_ts {
              animation: eefEsROxk9w3_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w3_ts__ts {
              0% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
              13.793103% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
              48.275862% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(1, 1);
              }
              82.758621% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(440.19521px, 139.159051px)
                  rotate(91.041629deg) scale(0, 0);
              }
            }
            #eefEsROxk9w4_ts {
              animation: eefEsROxk9w4_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w4_ts__ts {
              0% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(0, 0);
              }
              31.034483% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(0, 0);
              }
              65.517241% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(1, 1);
              }
              100% {
                transform: translate(440.19521px, 273.305491px)
                  rotate(91.041629deg) scale(0, 0);
              }
            }
            #eefEsROxk9w5_ts {
              animation: eefEsROxk9w5_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w5_ts__ts {
              0% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
              13.793103% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0, 0);
              }
              48.275862% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0, 0);
              }
              82.758621% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(1, 1);
              }
              100% {
                transform: translate(328.747458px, 337.283861px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
            }
            #eefEsROxk9w6_ts {
              animation: eefEsROxk9w6_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w6_ts__ts {
              0% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(1, 1);
              }
              34.482759% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(0, 0);
              }
              65.517241% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(224.649822px, 273.703072px)
                  rotate(91.041629deg) scale(1, 1);
              }
            }
            #eefEsROxk9w7_ts {
              animation: eefEsROxk9w7_ts__ts 2900ms linear infinite normal
                forwards;
            }
            @keyframes eefEsROxk9w7_ts__ts {
              0% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
              17.241379% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(1, 1);
              }
              48.275862% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0, 0);
              }
              82.758621% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0, 0);
              }
              100% {
                transform: translate(224.649822px, 143.849319px)
                  rotate(91.041629deg) scale(0.5, 0.5);
              }
            }
          </style>
          <g
            id="eefEsROxk9w2_ts"
            transform="translate(328.585373,76.258278) rotate(91.041629) scale(0,0)"
          >
            <polygon
              id="eefEsROxk9w2"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w3_ts"
            transform="translate(440.19521,139.159051) rotate(91.041629) scale(0,0)"
          >
            <polygon
              id="eefEsROxk9w3"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w4_ts"
            transform="translate(440.19521,273.305491) rotate(91.041629) scale(0,0)"
          >
            <polygon
              id="eefEsROxk9w4"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w5_ts"
            transform="translate(328.747458,337.283861) rotate(91.041629) scale(0.5,0.5)"
          >
            <polygon
              id="eefEsROxk9w5"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w6_ts"
            transform="translate(224.649822,273.703072) rotate(91.041629) scale(1,1)"
          >
            <polygon
              id="eefEsROxk9w6"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
          <g
            id="eefEsROxk9w7_ts"
            transform="translate(224.649822,143.849319) rotate(91.041629) scale(0.5,0.5)"
          >
            <polygon
              id="eefEsROxk9w7"
              points="0,-70.923853 61.421858,-35.461927 61.421858,35.461926 0,70.923853 -61.421858,35.461926 -61.421858,-35.461927 0,-70.923853"
              transform="translate(0,0)"
              fill="#df286d"
              stroke="rgb(0,0,0)"
              stroke-width="12"
            />
          </g>
        </svg>
      </div>
    `}}var module$spinner={};module$spinner.Spinner=Spinner$$module$spinner;const html$$module$search=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class SearchBar$$module$search extends k$$module$libs$preact{constructor(){super();this.setState({callInvoked:!1,results:[]});this.search=this.search.bind(this);this.delayTimer=null}search(a){const g=document.getElementById("search-input").value;""==g||void 0===g?this.setState({results:[]}):(this.setState({callInvoked:!0}),api_call_search$$module$api_shim(a,g).then(q=>{this.setState({results:q.results,callInvoked:!1})}))}delayed_search(a){this.delayTimer&&clearTimeout(this.delayTimer);let g=this;
this.delayTimer=setTimeout(function(){g.search(a)},150)}render(a,g){const q=0<g.results.length||!g.callInvoked?html$$module$search``:html$$module$search`
            <div style="width:100%;text-align:center;">
              <${Spinner$$module$spinner} style="" width="50px" />
            </div>
          `;return html$$module$search`
          <div> <input id="search-input" autocomplete="off" onkeypress="${()=>this.delayed_search(a.instance)}" onkeyup="${()=>this.delayed_search(a.instance)}"      > 

      </input>
      ${q}
          <ul id="search-results">
            ${g.results.map(u=>html$$module$search`<li>
                <a
                  href="/sandbox/${a.instance}/${u.type}/${u.uuid}${u.anchor?"/npc/"+u.anchor:""}"
                >
                  <div style="display:table-row;">
                    <div style="display:table-cell;">
                      <i
                        style="margin-right:0.5em;"
                        class="fa fa-solid fa-${u.icon}"
                      ></i>
                    </div>
                    <div style="display:table-cell;width:100%;">
                      ${u.value}
                    </div>
                  </div>
                  <div style="display:table-row;">
                    <div style="display:table-cell;"></div>
                    <div class="details" style="display:table-cell;width:100%;">
                      ${u.details}
                    </div>
                  </div>
                </a>
              </li>`)}
          </ul>
          </div>
      `}}var module$search={};module$search.SearchBar=SearchBar$$module$search;const html$$module$dialogs=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class GenerateRealmDialog$$module$dialogs extends k$$module$libs$preact{constructor(){super();this.state={show:!0,realm_type:"RealmTypeKingdom",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,
maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_jungle_region:12,maximum_tiles_per_jungle_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32,minimum_tiles_per_tundra_region:12,maximum_tiles_per_tundra_region:32,minimum_number_of_settlements:6,maximum_number_of_settlements:9,cities_probability:2,towns_probability:3,villages_probability:3,minimum_number_of_inns:3,maximum_number_of_inns:6,minimum_number_of_dungeons:6,
maximum_number_of_dungeons:9,tombs_probability:1,temples_probability:1,caves_probability:1,minimum_number_of_factions:3,maximum_number_of_factions:5,cults_probability:1,militias_probability:1,treasure_factor:1};this.onSubmit=this.onSubmit.bind(this);this.onRealmType=this.onRealmType.bind(this);this.onRealmPopulation=this.onRealmPopulation.bind(this);this.onMinimumNumberOfRegions=this.onMinimumNumberOfRegions.bind(this);this.onMaximumNumberOfRegions=this.onMaximumNumberOfRegions.bind(this);this.onMountainsProbability=
this.onMountainsProbability.bind(this);this.onMinimumTilesPerMountainsRegion=this.onMinimumTilesPerMountainsRegion.bind(this);this.onMaximumTilesPerMountainsRegion=this.onMaximumTilesPerMountainsRegion.bind(this);this.onMinimumTilesPerForestRegion=this.onMinimumTilesPerForestRegion.bind(this);this.onMaximumTilesPerForestRegion=this.onMaximumTilesPerForestRegion.bind(this);this.onMinimumTilesPerDesertRegion=this.onMinimumTilesPerDesertRegion.bind(this);this.onMaximumTilesPerDesertRegion=this.onMaximumTilesPerDesertRegion.bind(this);
this.onMinimumTilesPerPlainsRegion=this.onMinimumTilesPerPlainsRegion.bind(this);this.onMaximumTilesPerPlainsRegion=this.onMaximumTilesPerPlainsRegion.bind(this);this.onMinimumTilesPerJungleRegion=this.onMinimumTilesPerJungleRegion.bind(this);this.onMaximumTilesPerJungleRegion=this.onMaximumTilesPerJungleRegion.bind(this);this.onMinimumTilesPerSwampsRegion=this.onMinimumTilesPerSwampsRegion.bind(this);this.onMaximumTilesPerSwampsRegion=this.onMaximumTilesPerSwampsRegion.bind(this);this.onMinimumTilesPerTundraRegion=
this.onMinimumTilesPerTundraRegion.bind(this);this.onMaximumTilesPerTundraRegion=this.onMaximumTilesPerTundraRegion.bind(this);this.onForestProbability=this.onForestProbability.bind(this);this.onDesertProbability=this.onDesertProbability.bind(this);this.onPlainsProbability=this.onPlainsProbability.bind(this);this.onJungleProbability=this.onJungleProbability.bind(this);this.onSwampsProbability=this.onSwampsProbability.bind(this);this.onTundraProbability=this.onTundraProbability.bind(this);this.onMinimumNumberOfSettlements=
this.onMinimumNumberOfSettlements.bind(this);this.onMaximumNumberOfSettlements=this.onMaximumNumberOfSettlements.bind(this);this.onCitiesProbability=this.onCitiesProbability.bind(this);this.onTownsProbability=this.onTownsProbability.bind(this);this.onVillagesProbability=this.onVillagesProbability.bind(this);this.onMinimumNumberOfInns=this.onMinimumNumberOfInns.bind(this);this.onMaximumNumberOfInns=this.onMaximumNumberOfInns.bind(this);this.onMinimumNumberOfDungeons=this.onMinimumNumberOfDungeons.bind(this);
this.onMaximumNumberOfDungeons=this.onMaximumNumberOfDungeons.bind(this);this.onTombsProbability=this.onTombsProbability.bind(this);this.onTemplesProbability=this.onTemplesProbability.bind(this);this.onCavesProbability=this.onCavesProbability.bind(this);this.onMinimumNumberOfFactions=this.onMinimumNumberOfFactions.bind(this);this.onMaximumNumberOfFactions=this.onMaximumNumberOfFactions.bind(this);this.onCultsProbability=this.onCultsProbability.bind(this);this.onMilitiasProbability=this.onMilitiasProbability.bind(this);
this.onTreasureFactor=this.onTreasureFactor.bind(this)}show(){this.setState({show:!0})}hide(){this.setState({show:!1})}onRealmType(a){"RealmTypeLands"==a.target.value&&this.setState({realm_type:"RealmTypeLands",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:0,desert_probability:1,plains_probability:0,jungle_probability:4,swamps_probability:1,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_desert_region:12,
maximum_tiles_per_desert_region:32,minimum_tiles_per_jungle_region:12,maximum_tiles_per_jungle_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeKingdom"==a.target.value&&this.setState({realm_type:"RealmTypeKingdom",minimum_number_of_regions:6,maximum_number_of_regions:12,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,
maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeEmpire"==a.target.value&&this.setState({realm_type:"RealmTypeEmpire",minimum_number_of_regions:24,maximum_number_of_regions:32,mountains_probability:3,forest_probability:5,
desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,maximum_tiles_per_swamps_region:32});"RealmTypeDuchy"==a.target.value&&this.setState({realm_type:"RealmTypeDuchy",
minimum_number_of_regions:4,maximum_number_of_regions:8,mountains_probability:3,forest_probability:5,desert_probability:1,plains_probability:4,jungle_probability:0,swamps_probability:2,tundra_probability:0,minimum_tiles_per_mountains_region:12,maximum_tiles_per_mountains_region:32,minimum_tiles_per_forest_region:12,maximum_tiles_per_forest_region:32,minimum_tiles_per_desert_region:12,maximum_tiles_per_desert_region:32,minimum_tiles_per_plains_region:12,maximum_tiles_per_plains_region:32,minimum_tiles_per_swamps_region:12,
maximum_tiles_per_swamps_region:32})}onRealmPopulation(a){"now"==a.target.value&&this.setState({minimum_number_of_settlements:6,maximum_number_of_settlements:9,minimum_number_of_inns:6,maximum_number_of_inns:9,minimum_number_of_factions:3,maximum_number_of_factions:5});"later"==a.target.value&&this.setState({minimum_number_of_settlements:0,maximum_number_of_settlements:0,minimum_number_of_inns:0,maximum_number_of_inns:0,minimum_number_of_factions:0,maximum_number_of_factions:0})}onMinimumNumberOfRegions(a){this.state.minimum_number_of_regions=
a.target.value}onMaximumNumberOfRegions(a){this.state.maximum_number_of_regions=a.target.value}onMountainsProbability(a){this.state.mountains_probability=a.target.value}onMinimumTilesPerMountainsRegion(a){this.state.minimum_tiles_per_mountains_region=a.target.value}onMaximumTilesPerMountainsRegion(a){this.state.maximum_tiles_per_mountains_region=a.target.value}onMinimumTilesPerForestRegion(a){this.state.minimum_tiles_per_forest_region=a.target.value}onMaximumTilesPerForestRegion(a){this.state.maximum_tiles_per_forest_region=
a.target.value}onMinimumTilesPerDesertRegion(a){this.state.minimum_tiles_per_desert_region=a.target.value}onMaximumTilesPerDesertRegion(a){this.state.maximum_tiles_per_desert_region=a.target.value}onMinimumTilesPerPlainsRegion(a){this.state.minimum_tiles_per_plains_region=a.target.value}onMaximumTilesPerPlainsRegion(a){this.state.maximum_tiles_per_plains_region=a.target.value}onMinimumTilesPerJungleRegion(a){this.state.minimum_tiles_per_jungle_region=a.target.value}onMaximumTilesPerJungleRegion(a){this.state.maximum_tiles_per_jungle_region=
a.target.value}onMinimumTilesPerSwampsRegion(a){this.state.minimum_tiles_per_swamps_region=a.target.value}onMaximumTilesPerSwampsRegion(a){this.state.maximum_tiles_per_swamps_region=a.target.value}onMinimumTilesPerTundraRegion(a){this.state.minimum_tiles_per_tundra_region=a.target.value}onMaximumTilesPerTundraRegion(a){this.state.maximum_tiles_per_tundra_region=a.target.value}onForestProbability(a){this.state.forest_probability=a.target.value}onDesertProbability(a){this.state.desert_probability=a.target.value}onPlainsProbability(a){this.state.plains_probability=
a.target.value}onJungleProbability(a){this.state.jungle_probability=a.target.value}onSwampsProbability(a){this.state.swamps_probability=a.target.value}onTundraProbability(a){this.state.tundra_probability=a.target.value}onMinimumNumberOfSettlements(a){this.state.minimum_number_of_settlements=a.target.value}onMaximumNumberOfSettlements(a){this.state.maximum_number_of_settlements=a.target.value}onCitiesProbability(a){this.state.cities_probability=a.target.value}onTownsProbability(a){this.state.towns_probability=
a.target.value}onVillagesProbability(a){this.state.villages_probability=a.target.value}onMinimumNumberOfInns(a){this.state.minimum_number_of_inns=a.target.value}onMaximumNumberOfInns(a){this.state.maximum_number_of_inns=a.target.value}onMinimumNumberOfDungeons(a){this.state.minimum_number_of_dungeons=a.target.value}onMaximumNumberOfDungeons(a){this.state.maximum_number_of_dungeons=a.target.value}onTombsProbability(a){this.state.tombs_probability=a.target.value}onTemplesProbability(a){this.state.temples_probability=
a.target.value}onCavesProbability(a){this.state.caves_probability=a.target.value}onMinimumNumberOfFactions(a){this.state.minimum_number_of_factions=a.target.value}onMaximumNumberOfFactions(a){this.state.maximum_number_of_factions=a.target.value}onCultsProbability(a){this.state.cults_probability=a.target.value}onMilitiasProbability(a){this.state.militias_probability=a.target.value}onTreasureFactor(a){this.state.treasure_factor=a.target.value}onSubmit(){this.props.onOkay("Generic",{realm_type:this.state.realm_type,
minimum_number_of_regions:parseInt(this.state.minimum_number_of_regions),maximum_number_of_regions:parseInt(this.state.maximum_number_of_regions),mountains_probability:parseInt(this.state.mountains_probability),forest_probability:parseInt(this.state.forest_probability),desert_probability:parseInt(this.state.desert_probability),plains_probability:parseInt(this.state.plains_probability),jungle_probability:parseInt(this.state.jungle_probability),swamps_probability:parseInt(this.state.swamps_probability),
tundra_probability:parseInt(this.state.tundra_probability),minimum_tiles_per_mountains_region:parseInt(this.state.minimum_tiles_per_mountains_region),maximum_tiles_per_mountains_region:parseInt(this.state.maximum_tiles_per_mountains_region),minimum_tiles_per_forest_region:parseInt(this.state.minimum_tiles_per_forest_region),maximum_tiles_per_forest_region:parseInt(this.state.maximum_tiles_per_forest_region),minimum_tiles_per_desert_region:parseInt(this.state.minimum_tiles_per_desert_region),maximum_tiles_per_desert_region:parseInt(this.state.maximum_tiles_per_desert_region),
minimum_tiles_per_plains_region:parseInt(this.state.minimum_tiles_per_plains_region),maximum_tiles_per_plains_region:parseInt(this.state.maximum_tiles_per_plains_region),minimum_tiles_per_jungle_region:parseInt(this.state.minimum_tiles_per_jungle_region),maximum_tiles_per_jungle_region:parseInt(this.state.maximum_tiles_per_jungle_region),minimum_tiles_per_swamps_region:parseInt(this.state.minimum_tiles_per_swamps_region),maximum_tiles_per_swamps_region:parseInt(this.state.maximum_tiles_per_swamps_region),
minimum_tiles_per_tundra_region:parseInt(this.state.minimum_tiles_per_tundra_region),maximum_tiles_per_tundra_region:parseInt(this.state.maximum_tiles_per_tundra_region),minimum_number_of_settlements:parseInt(this.state.minimum_number_of_settlements),maximum_number_of_settlements:parseInt(this.state.maximum_number_of_settlements),cities_probability:parseInt(this.state.cities_probability),towns_probability:parseInt(this.state.towns_probability),villages_probability:parseInt(this.state.villages_probability),
minimum_number_of_inns:parseInt(this.state.minimum_number_of_inns),maximum_number_of_inns:parseInt(this.state.maximum_number_of_inns),minimum_number_of_dungeons:parseInt(this.state.minimum_number_of_dungeons),maximum_number_of_dungeons:parseInt(this.state.maximum_number_of_dungeons),tombs_probability:parseInt(this.state.tombs_probability),temples_probability:parseInt(this.state.temples_probability),caves_probability:parseInt(this.state.caves_probability),minimum_number_of_factions:parseInt(this.state.minimum_number_of_factions),
maximum_number_of_factions:parseInt(this.state.maximum_number_of_factions),cults_probability:parseInt(this.state.cults_probability),militias_probability:parseInt(this.state.militias_probability),treasure_factor:parseFloat(this.state.treasure_factor)});this.setState({show:!1})}okay(a){this.props.onOkay(a);this.setState({show:!1})}cancel(){$$$module$libs$preact_router_module("/sandbox/"+this.props.instance)}render(a,g){return g.show?html$$module$dialogs` <!-- The Modal -->
      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <span class="close">
            <a
              onClick="${q=>{this.cancel()}}"
            >
              ${"\u00d7"}
            </a>
          </span>
          <!--a onclick="${()=>this.okay("Generic")}">generate a small Duchy</a-->
          <form onSubmit="${this.onSubmit}">
            <button type="submit">GENERATE</button>
            <h4 id="scale">Realm Template</h4>

            <label for="realm_type">Realm Type:</label>

            <select
              name="realm_type"
              id="realm_type"
              value="${g.realm_type}"
              onInput="${this.onRealmType}"
            >
              <option value="RealmTypeKingdom">Kingdom</option>
              <option value="RealmTypeLands">Lands</option>
              <option value="RealmTypeDuchy">Duchy</option>
              <option value="RealmTypeEmpire">Empire</option>
            </select>

            <label for="realm_population">Population:</label>

            <select
              name="realm_population"
              id="realm_population"
              value="${g.realm_population}"
              onInput="${this.onRealmPopulation}"
            >
              <option value="now">Generate now</option>
              <option value="later">I'll add later</option>
            </select>

            <h4 id="scale">Terrain</h4>
            <h5>Number of regions</h5>
            <label for="minimum_number_of_regions">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_regions}"
              onInput="${this.onMinimumNumberOfRegions}"
              min="1"
              max="32"
              pattern="[0-9]+"
              id="minimum_number_of_regions"
              name="minimum_number_of_regions"
            />
            <label for="maximum_number_of_regions"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_regions}"
              onInput="${this.onMaximumNumberOfRegions}"
              min="1"
              max="32"
              pattern="[0-9]+"
              id="maximum_number_of_regions"
              name="maximum_number_of_regions"
            />
            <label for="maximum_number_of_regions"> regions. </label> <br />

            <div style="display:flex;">
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#mountains"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="mountains_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.mountains_probability}"
                    onInput="${this.onMountainsProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="mountains_probability"
                    name="mountains_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="mountains_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_mountains_region}"
                    onInput="${this.onMinimumTilesPerMountainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_mountains_region"
                    name="minimum_tiles_per_mountains_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="mountains_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_mountains_region}"
                    onInput="${this.onMaximumTilesPerMountainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_mountains_region"
                    name="maximum_tiles_per_mountains_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#forest"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="forest_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.forest_probability}"
                    onInput="${this.onForestProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="forest_probability"
                    name="forest_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="forest_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_forest_region}"
                    onInput="${this.onMinimumTilesPerForestRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_forest_region"
                    name="minimum_tiles_per_forest_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="forest_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_forest_region}"
                    onInput="${this.onMaximumTilesPerForestRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_forest_region"
                    name="maximum_tiles_per_forest_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#plains"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="plains_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.plains_probability}"
                    onInput="${this.onPlainsProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="plains_probability"
                    name="plains_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="plains_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_plains_region}"
                    onInput="${this.onMinimumTilesPerPlainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_plains_region"
                    name="minimum_tiles_per_plains_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="plains_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_plains_region}"
                    onInput="${this.onMaximumTilesPerPlainsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_plains_region"
                    name="maximum_tiles_per_plains_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#desert"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="desert_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.desert_probability}"
                    onInput="${this.onDesertProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="desert_probability"
                    name="desert_probability"
                  />
                </div>
                <div style="display:block;">
                  <label for="desert_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_desert_region}"
                    onInput="${this.onMinimumTilesPerDesertRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_desert_region"
                    name="minimum_tiles_per_desert_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="desert_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_desert_region}"
                    onInput="${this.onMaximumTilesPerDesertRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_desert_region"
                    name="maximum_tiles_per_desert_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#jungle"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="jungle_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.jungle_probability}"
                    onInput="${this.onJungleProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="jungle_probability"
                    name="jungle_probability"
                  />
                </div>

                <div style="display:block;">
                  <label for="jungle_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_jungle_region}"
                    onInput="${this.onMinimumTilesPerJungleRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_jungle_region"
                    name="minimum_tiles_per_jungle_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="jungle_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_jungle_region}"
                    onInput="${this.onMaximumTilesPerJungleRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_jungle_region"
                    name="maximum_tiles_per_jungle_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#swamps"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="swamps_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.swamps_probability}"
                    onInput="${this.onSwampsProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="swamps_probability"
                    name="swamps_probability"
                  />
                </div>
                <div style="display:block;">
                  <label for="swamps_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_swamps_region}"
                    onInput="${this.onMinimumTilesPerSwampsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_swamps_region"
                    name="minimum_tiles_per_swamps_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="swamps_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_swamps_region}"
                    onInput="${this.onMaximumTilesPerSwampsRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_swamps_region"
                    name="maximum_tiles_per_swamps_region"
                  />
                </div>
              </div>
              <div style="width:110px">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  style="background:none; max-width:100px; height:100px;"
                >
                  <use
                    xlink:href="${window.app.theme}.svg#tundra"
                    transform="translate(50,50) scale(5,5)"
                  />
                </svg>
                <div style="display:block;">
                  <label for="tundra_probability"> ${"P\u00d7"} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.tundra_probability}"
                    onInput="${this.onTundraProbability}"
                    min="0"
                    max="10"
                    pattern="[0-9]+"
                    id="tundra_probability"
                    name="tundra_probability"
                  />
                </div>
                <div style="display:block;">
                  <label for="tundra_probability"> ${">="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.minimum_tiles_per_tundra_region}"
                    onInput="${this.onMinimumTilesPerTundraRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="minimum_tiles_per_tundra_region"
                    name="minimum_tiles_per_tundra_region"
                  />
                </div>
                <div style="display:block;">
                  <label for="tundra_probability"> ${"<="} </label>
                  <input
                    style="text-align:center"
                    size="3"
                    type="number"
                    value="${g.maximum_tiles_per_tundra_region}"
                    onInput="${this.onMaximumTilesPerTundraRegion}"
                    min="1"
                    max="50"
                    pattern="[0-9]+"
                    id="maximum_tiles_per_tundra_region"
                    name="maximum_tiles_per_tundra_region"
                  />
                </div>
              </div>
            </div>

            <h4 id="dungeons">Dungeons</h4>
            <h5>Number of dungeons</h5>
            <label for="minimum_number_of_dungeons">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_dungeons}"
              onInput="${this.onMinimumNumberOfDungeons}"
              min="0"
              max="18"
              pattern="[0-9]+"
              id="minimum_number_of_dungeons"
              name="minimum_number_of_dungeons"
            />
            <label for="maximum_number_of_dungeons"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_dungeons}"
              onInput="${this.onMaximumNumberOfDungeons}"
              min="0"
              max="18"
              pattern="[0-9]+"
              id="maximum_number_of_dungeons"
              name="maximum_number_of_dungeons"
            />
            <label for="maximum_number_of_dungeons"> dungeons. </label> <br />

            <h5>Dungeon types probability</h5>
            <label for="caves_probability"> Caves ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.caves_probability}"
              onInput="${this.onCavesProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="caves_probability"
              name="caves_probability"
            />

            <label for="temples_probability"> Temples ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.temples_probability}"
              onInput="${this.onTemplesProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="temples_probability"
              name="temples_probability"
            />

            <label for="tombs_probability"> Tombs ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.tombs_probability}"
              onInput="${this.onTombsProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="tombs_probability"
              name="tombs_probability"
            />

            <h5>Wandering Monsters</h5>
            <label for="highest_wandering_monster_hitdice_in_dungeons">
              Wandering monsters highest HD is
            </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="3"
              min="1"
              max="15"
              pattern="[0-9]+"
              id="highest_wandering_monster_hitdice_in_dungeons"
              name="highest_wandering_monster_hitdice_in_dungeons"
            />
            <br />

            <h4 id="settlements">Settlements</h4>
            <h5>Number of settlements</h5>
            <label for="minimum_number_of_settlements">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="12"
              value="${g.minimum_number_of_settlements}"
              onInput="${this.onMinimumNumberOfSettlements}"
              pattern="[0-9]+"
              id="minimum_number_of_settlements"
              name="minimum_number_of_settlements"
            />
            <label for="maximum_number_of_settlements"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="12"
              pattern="[0-9]+"
              value="${g.maximum_number_of_settlements}"
              onInput="${this.onMaximumNumberOfSettlements}"
              id="maximum_number_of_settlements"
              name="maximum_number_of_settlements"
            />
            <label for="maximum_number_of_settlements"> settlements. </label>
            <br />

            <h5>Settlement types probability</h5>
            <label for="cities_probability"> Cities: </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="10"
              pattern="[0-9]+"
              value="${g.cities_probability}"
              onInput="${this.onCitiesProbability}"
              id="cities_probability"
              name="cities_probability"
            />

            <label for="towns_probability"> Towns: </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="10"
              pattern="[0-9]+"
              value="${g.towns_probability}"
              onInput="${this.onTownsProbability}"
              id="towns_probability"
              name="towns_probability"
            />

            <label for="villages_probability"> Villages: </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              min="0"
              max="10"
              pattern="[0-9]+"
              value="${g.villages_probability}"
              onInput="${this.onVillagesProbability}"
              id="villages_probability"
              name="villages_probability"
            />

            <h4 id="inns">Inns</h4>
            <h5>Number of inns (not in settlements)</h5>
            <label for="minimum_number_of_inns">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_inns}"
              onInput="${this.onMinimumNumberOfInns}"
              min="0"
              max="9"
              pattern="[0-9]+"
              id="minimum_number_of_inns"
              name="minimum_number_of_inns"
            />
            <label for="maximum_number_of_inns"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_inns}"
              onInput="${this.onMaximumNumberOfInns}"
              min="0"
              max="9"
              pattern="[0-9]+"
              id="maximum_number_of_inns"
              name="maximum_number_of_inns"
            />
            <label for="maximum_number_of_inns"> inns. </label> <br />

            <br />

            <h4 id="factions">Factions</h4>
            <h5>Number of factions</h5>
            <label for="minimum_number_of_factions">Generate between </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.minimum_number_of_factions}"
              onInput="${this.onMinimumNumberOfFactions}"
              min="0"
              max="7"
              pattern="[0-9]+"
              id="minimum_number_of_factions"
              name="minimum_number_of_factions"
            />
            <label for="maximum_number_of_factions"> to </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.maximum_number_of_factions}"
              onInput="${this.onMaximumNumberOfFactions}"
              min="0"
              max="7"
              pattern="[0-9]+"
              id="maximum_number_of_factions"
              name="maximum_number_of_factions"
            />
            <label for="maximum_number_of_factions"> factions. </label> <br />

            <h5>Faction types probability</h5>
            <label for="cults_probability"> Cults ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.cults_probability}"
              onInput="${this.onCultsProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="cults_probability"
              name="cults_probability"
            />

            <label for="militias_probability"> Militias ${"P\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="number"
              value="${g.militias_probability}"
              onInput="${this.onMilitiasProbability}"
              min="0"
              max="10"
              pattern="[0-9]+"
              id="militias_probability"
              name="militias_probability"
            />
            <h4>Tweaks and Experiments</h4>
            <label for="treasure_factor"> Treasure Factor ${"T\u00d7"} </label>
            <input
              style="text-align:center"
              size="3"
              type="decimal"
              value="${g.treasure_factor}"
              onInput="${this.onTreasureFactor}"
              min="0.001"
              max="10"
              pattern="[0-9.]+"
              id="treasure_factor"
              name="treasure_factor"
            />
          </form>
        </div>
      </div>`:html$$module$dialogs``}}var module$dialogs={};module$dialogs.GenerateRealmDialog=GenerateRealmDialog$$module$dialogs;const html$$module$hexview=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);
class Slider$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({transition:"hidden"})}componentDidMount(a,g,q){0==this.props.switch?(this.state.transition="hidden",this.setState({visible:!1})):(this.state.transition="visible",this.setState({visible:!0}))}componentWillUpdate(a){if(this.props.switch!=a.switch){window.clearTimeout(this.interval);this.state.transition=0==a.switch?"hidden":"visible";var g=this;a.keep||(0==a.switch?this.interval=window.setTimeout(function(){g.setState({visible:!1})},
500):g.setState({visible:!0}))}}render(a,g){return html$$module$hexview`<div id="${a.id}" class="${g.transition}">
      ${g.visible?a.visible():html$$module$hexview``}
    </div> `}}class Toggles$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({visible:!0})}onLock(){this.setState({visible:!this.state.visible})}render(a,g){return html$$module$hexview`
      <div>
        <div style="display:inline-block; width:1.5em;">
          <a title="Visual Toggles" onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${"fa-toggle-on"}"></i>
          </a>
        </div>
        <${Slider$$module$hexview}
          id="toggle-labels"
          switch=${!g.visible}
          visible=${()=>html$$module$hexview`
              <a onClick="${()=>a.onToggleLabels()}"
                ><i class="fa fa-solid fa-eye"></i>
              </a>
              <a onClick="${()=>a.onTogglePalette()}"
                ><i class="fa fa-solid fa-palette"></i>
              </a>
            `}
        />
      </div>
    `}}
class Toolbar$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({locked:!0})}componentWillUpdate(a){1==a.hidden&&0==this.props.hidden&&this.setState({locked:!0})}onLock(){this.setState({locked:!this.state.locked});this.state.locked?document.querySelectorAll(".btn-icon-hidden").forEach(function(a){a.classList.replace("btn-icon-hidden","btn-icon")}):document.querySelectorAll(".btn-icon").forEach(function(a){a.classList.replace("btn-icon","btn-icon-hidden")})}render(a,g){return is_electron$$module$api_shim?
html$$module$hexview``:html$$module$hexview`
      <div id="header-menu">
        <div style="display:inline-block; width:1.5em;">
          <a onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${g.locked?"fa-lock":"fa-lock-open"}"></i>
          </a>
        </div>
        <${Slider$$module$hexview}
          id="drawer-append2"
          switch=${!g.locked}
          visible=${()=>html$$module$hexview`
              <a onclick="${()=>a.onReroll()}"
                ><i class="fa fa-dice"></i
              ></a>
              <a onclick="${()=>a.onEdit()}"
                ><i class="fa fa-feather"></i
              ></a>
            `}
        />
      </div>
    `}}class Drawer$$module$hexview extends k$$module$libs$preact{constructor(){super();this.setState({locked:window.app.locked})}onLock(){window.app.locked=!window.app.locked;this.setState({locked:window.app.locked});this.props.onLock(window.app.locked)}render(a,g){return html$$module$hexview`
      <div>
        <div style="display:inline-block; width:1.5em;">
          <a
            title="Lock or unlock sandbox for editing"
            onClick="${()=>this.onLock()}"
            ><i class="fa fa-solid ${g.locked?"fa-lock":"fa-lock-open"}"></i>
          </a>
        </div>
        <${Slider$$module$hexview}
          id="drawer-append"
          switch=${!g.locked}
          visible=${()=>html$$module$hexview` <a onClick="${()=>a.onAppend()}"
              ><i class="fa fa-solid fa-circle-plus"></i>
            </a>`}
        />
      </div>
    `}}
class EntityEditor$$module$hexview extends k$$module$libs$preact{constructor(){super()}componentDidMount(a,g,q){this.editor=tinymce.init({selector:"textarea#entity_editor",promotion:!1,menubar:!1,statusbar:!1,toolbar:"undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | outdent indent",plugins:"advlist link image lists table fullscreen"}).then(()=>{tinymce.activeEditor.execCommand("mceFullScreen")}).then(()=>{this.props.onEditorActive()})}componentWillUnmount(){tinymce.remove()}render(a){return html$$module$hexview`<textarea id="entity_editor" name="editor"></textarea>`}}
class HexView$$module$hexview extends k$$module$libs$preact{constructor(){super();this.state={html:"",coords:{},appending:!1,waiting:!0,toggle:1,map_locked:!0,show_labels:!0,desaturate_palette:!1,showReadme:!1,packaging:!1,snackbar:!1,backpack_link:null,ephemeral:!1};this.onLock=this.onLock.bind(this);this.closeSnackbar=this.closeSnackbar.bind(this);this.appendCall=this.appendCall.bind(this);this.appendDialog=this.appendDialog.bind(this);this.onToggleLabels=this.onToggleLabels.bind(this);this.onTogglePalette=
this.onTogglePalette.bind(this);this.onEditorActive=this.onEditorActive.bind(this);this.reroll=this.reroll.bind(this);this.append=this.append.bind(this);this.onReadme=this.onReadme.bind(this);this.toggleSpinner=this.toggleSpinner.bind(this);this.spinners=[!1,!1];this.forceRefresh=!1}spinnerState(a,g){this.spinners[a]=g;return this.spinners[0]||this.spinners[1]}toggleSpinner(a,g){this.setState({waiting:this.spinnerState(a,g)})}setEditorValue(a){document.getElementById("entity_editor")&&tinymce.activeEditor.setContent(a)}onEditorActive(){tinymce.activeEditor.setContent(this.editor_value)}componentDidMount(a,
g,q){void 0!=this.props.hex_uuid&&("coords"==this.props.type?this.get_ocean():this.get_entity(this.props.hex_uuid,this.setEditorValue));this.map&&this.map.sizeToFit();"append"==this.props.mode&&(this.toggleSpinner(0,!1),this.toggleSpinner(1,!1));api_call_version$$module$api_shim(this.props.instance).then(u=>{this.setState({BACKEND_BUILD_ID:u.build})});is_electron$$module$api_shim||fetch("/mode/"+this.props.instance,{method:"GET"}).then(u=>u.json()).then(u=>{this.setState({ephemeral:u.ephemeral})}).catch(u=>
{console.error("Error:",u)})}componentDidUpdate(a){if(this.props.hex_uuid)if("coords"==this.props.type)this.get_ocean();else{if(this.props.hex_uuid!=a.hex_uuid||this.forceRefresh)this.get_entity(this.props.hex_uuid,this.setEditorValue),this.forceRefresh=!1}else this.map.sizeToFit()}componentWillUpdate(a){"append"==a.mode&&(this.spinners[0]=!1,this.spinners[1]=!1)}crossDissolve(a){let g=document.getElementById("entity"+this.toggle);this.toggle=1==this.toggle?2:1;let q=document.getElementById("entity"+
this.toggle);q&&(q.innerHTML=a);this.editor_value=a;this.toolbar.state.locked&&q.querySelectorAll(".btn-icon").forEach(function(u){u.classList.replace("btn-icon","btn-icon-hidden")});q&&q.classList.remove("hidden");g&&g.classList.add("hidden");window.clearTimeout(this.entity_timeout);this.entity_timeout=window.setTimeout(()=>{g&&(g.innerHTML="")},1E3);return q}get_ocean(){this.crossDissolve("");const a=`
      <span class="breadcrumbs">
        <a href="/sandbox/${this.props.instance}">SANDBOX</a>
      </span>
      <br />
      The Vast Ocean
    `;document.getElementById("hex_title").innerHTML=a}get_entity(a,g){0==this.forceRefresh&&(document.getElementById("entity1").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),document.getElementById("entity2").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}));api_call_html$$module$api_shim(this.props.mode,this.props.instance,a).then(q=>{q=this.crossDissolve(q);if(document.getElementById("title")){var u=document.getElementById("title").innerHTML;document.getElementById("title").remove();
document.getElementById("hex_title").innerHTML=u}this.props.npc&&(u=document.getElementById(this.props.npc))&&u.scrollIntoView(!0);if(q&&(q=q.getElementsByClassName("map-coords")[0]))if(q.hasAttribute("hex")){const B=q.getAttribute("hex"),E=q.getAttribute("x"),F=q.getAttribute("y"),K=q.getAttribute("zoom");this.map.postMapLoaded(()=>{this.map.navigateToHex(B,{x:E,y:F,zoom:K})})}else this.map.postMapLoaded(()=>{this.map.navigateToRealm(a)});g&&g(this.editor_value)})}edit(a){$$$module$libs$preact_router_module("/sandbox/"+
this.props.instance+"/hex/"+this.props.hex_uuid+"/edit")}append(a,g,q){fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,entity:a,attribute:g,type:q})}).then(u=>u.text()).then(u=>{this.map.getMatrix(!0)}).catch(u=>{console.error("Error:",u)})}reroll(a,g,q){if(!window.app.inhibit_rerolls){this.toggleSpinner(0,!0);q=document.getElementsByClassName("fa-dice");for(let B of q)B.classList.add("rolled");
window.app.inhibit_rerolls=!0;var u=this;void 0===a&&(a=this.props.hex_uuid);void 0===g&&(g="default");fetch("/reroll/"+this.props.instance+"/"+a+"/"+g,{method:"GET"}).then(B=>401===B.status?(window.app.unauth(),Promise.reject(B)):B.json()).then(B=>{let E=!1;for(const [,F]of window.app.reroll_handlers)F(),E=!0;E||this.map.getMatrix(!0);a==this.props.hex_uuid?$$$module$libs$preact_router_module("/sandbox/"+u.props.instance+"/"+u.props.type+"/"+B.uuid,!0):(this.forceRefresh=!0,void 0!==u.props.type&&
$$$module$libs$preact_router_module("/sandbox/"+u.props.instance+"/"+u.props.type+"/"+this.props.hex_uuid,!0));window.app.inhibit_rerolls=!1;this.toggleSpinner(0,!1)}).catch(B=>{this.toggleSpinner(0,!1);window.app.inhibit_rerolls=!1;console.error("Error:",B)})}}appendCall(a,g){this.toggleSpinner(0,!0);$$$module$libs$preact_router_module("/sandbox/"+this.props.instance);this.toggleSpinner(0,!0);fetch("/append/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({instance:this.props.instance,
entity:this.props.instance,attribute:"realms",type:a,nx:this.menu?this.menu.nx:null,ny:this.menu?this.menu.ny:null,params:JSON.stringify(g)})}).then(q=>q.text()).then(q=>{this.setState({appending:!1,waiting:this.spinnerState(0,!1)});this.map.getMatrix(!0)}).catch(q=>{console.error("Error:",q)})}appendDialog(a){this.menu=a?a:null;$$$module$libs$preact_router_module("/sandbox/"+this.props.instance+"/append");this.setState({appending:!0,waiting:this.spinnerState(0,!1)})}onReadme(){this.setState({showReadme:!this.state.showReadme})}onLock(a){this.setState({map_locked:a})}onExit(){window.api.quit()}closeSnackbar(){this.setState({snackbar:!1})}onPatreon(){window.location.href=
"/claim/"+this.props.instance}onDownload(){this.setState({packaging:!0,snackbar:!0});fetch("/pack/"+this.props.instance,{method:"GET"}).then(a=>a.json()).then(a=>{this.setState({packaging:!1,backpack_link:a.filename,snackbar:!0})}).catch(a=>{this.setState({packaging:!1,backpack_link:null,snackbar:!0});console.error("Error:",a)})}onToggleLabels(a){this.setState({show_labels:!this.state.show_labels})}onTogglePalette(a){this.setState({desaturate_palette:!this.state.desaturate_palette})}render(a,g){const q=
a.hex_uuid?"view_visible":"view_hidden",u="append"==a.mode?html$$module$hexview`
            <${GenerateRealmDialog$$module$dialogs}
              ref=${E=>this.dialog=E}
              instance=${a.instance}
              onOkay=${this.appendCall}
            />
          `:html$$module$hexview``,B=g.showReadme?html$$module$hexview` <${ReadmeDialog$$module$readme} onExit=${this.onReadme} /> `:html$$module$hexview``;return html$$module$hexview`
      ${u} ${B}
      <div id="header" class="${q}">
        <h4>
          <div id="hex_title">Loading...<br /><br /></div>
          <${Toolbar$$module$hexview}
            ref=${E=>this.toolbar=E}
            onEdit=${this.edit}
            onReroll=${this.reroll}
            onLock=${this.onLock}
            hidden=${!a.hex_uuid}
          />
        </h4>
      </div>
      <div
        style="color: #000000; opacity: 0.5; font-size:0.5em; z-index: 999909; position: fixed; bottom: 6px; right: 10px;"
      >
        <a onClick=${this.onReadme}> <strong> HEXROLL 2nd Edition </strong> </a
        >| ALPHA | frontend build: ${BUILD_ID$$module$version} | backend build:
        ${g.BACKEND_BUILD_ID}
      </div>
      <${HexMap$$module$hexmap}
        visible=${"edit"!=a.mode}
        ref=${E=>this.map=E}
        instance="${a.instance}"
        wuuid=""
        locked=${g.map_locked}
        hex_uuid="${a.hex_uuid}"
        area_uuid="${a.area_uuid}"
        coords=${g.coords}
        show_labels=${g.show_labels}
        desaturate_palette=${g.desaturate_palette}
        appendDialog=${this.appendDialog}
        spinner=${this.toggleSpinner}
      />
      <div id="content" class="${q}">
        <${Slider$$module$hexview}
          id="search"
          switch=${"append"!=a.mode&&!a.hex_uuid&&g.map_locked&&!g.showReadme&&!g.waiting}
          visible=${()=>html$$module$hexview` <${SearchBar$$module$search} instance="${a.instance}" /> `}
        />
        <${Slider$$module$hexview}
          id="patreon-button"
          switch=${"append"!=a.mode&&!a.hex_uuid&&!g.packaging&&g.ephemeral&&!is_electron$$module$api_shim&&!g.showReadme&&!g.waiting}
          visible=${()=>html$$module$hexview` <a
              title="Bind sandbox with your Patreon membership"
              onClick="${()=>this.onPatreon()}"
              ><i class="fa-brands fa-patreon"></i>
            </a>`}
        />
        <${Slider$$module$hexview}
          id="download-button"
          switch=${"append"!=a.mode&&!a.hex_uuid&&!g.packaging&&!is_electron$$module$api_shim&&!g.showReadme&&!g.waiting}
          visible=${()=>html$$module$hexview` <a
              title="Package & Download"
              onClick="${()=>this.onDownload()}"
              ><i class="fa fa-solid fa-circle-down"></i>
            </a>`}
        />
        <${Slider$$module$hexview}
          id="toggles-menu"
          switch=${"append"!=a.mode&&!a.hex_uuid&&!g.showReadme&&!g.waiting}
          visible=${()=>html$$module$hexview`
              <${Toggles$$module$hexview}
                onToggleLabels=${this.onToggleLabels}
                onTogglePalette=${this.onTogglePalette}
              />
            `}
        />
        <${Slider$$module$hexview}
          id="drawer-menu"
          switch=${"append"!=a.mode&&!a.hex_uuid&&!is_electron$$module$api_shim&&!g.showReadme&&!g.waiting}
          visible=${()=>html$$module$hexview`
              <${Drawer$$module$hexview} onAppend=${this.appendDialog} onLock=${this.onLock} />
            `}
        />
        <${Slider$$module$hexview}
          id="exit-button"
          switch=${"append"!=a.mode&&!a.hex_uuid&&is_electron$$module$api_shim&&!g.showReadme&&!g.waiting}
          visible=${()=>html$$module$hexview`
              <a onClick="${()=>this.onExit()}"
                ><i class="fa fa-solid fa-circle-xmark"></i>
              </a>
            `}
        />
        <${Slider$$module$hexview}
          id="backpacker-snackbar"
          switch=${g.snackbar}
          visible=${()=>g.packaging?html$$module$hexview`
                  <div>
                    <i class="fa fa-solid fa-gear animated-gear"></i>
                    Hexroll is now casting a <em>Package Sandbox</em> spell.
                    <br />
                    You will find the download link here in a few moments.
                  </div>
                `:g.backpack_link?html$$module$hexview`
                  <div>
                    <div class="snackbar-close">
                      <a onClick="${this.closeSnackbar}">
                        <i class="fa fa-solid fa-xmark"></i
                      ></a>
                    </div>
                    Your Hexroll Backpack file is ready to
                    <a href="${g.backpack_link}">download now</a>
                  </div>
                `:html$$module$hexview`
                  <div>
                    We had a problem packing your sandbox. <br />This will be
                    looked into and you will be contacted soon.
                  </div>
                `}
        />
        ${g.waiting?html$$module$hexview`
              <${Spinner$$module$spinner}
                width="100px"
                style="position:fixed; z-index:101000; left:2em; bottom: 2em;"
              />
            `:html$$module$hexview``}
        <div style="z-index:0;" id="entity-container" class="${q}">
          <!--trix-editor id="entity1"></trix-editor-->
          ${"edit"==a.mode?html$$module$hexview`<${EntityEditor$$module$hexview}
                editor_value=${this.editor_value}
                onEditorActive=${this.onEditorActive}
              />`:html$$module$hexview`
                <div style="z-index:-1;position:absolute;" id="entity1"></div>
                <div
                  style="z-index:-1;position:absolute;"
                  id="entity2"
                  class="hidden"
                ></div>
              `}
        </div>
      </div>
    `}}var module$hexview={};module$hexview.HexView=HexView$$module$hexview;var t$$module$libs$history_production_min;!function(a){a.Pop="POP";a.Push="PUSH";a.Replace="REPLACE"}(t$$module$libs$history_production_min||={});
function e$$module$libs$history_production_min(a={}){function g(){let {pathname:ba,search:fa,hash:R}=K.location,da=I.state||{};return[da.idx,{pathname:ba,search:fa,hash:R,state:da.usr||null,key:da.key||"default"}]}function q(ba){return"string"==typeof ba?ba:c$$module$libs$history_production_min(ba)}function u(ba,fa=null){return Object.assign(Object.assign({pathname:T.pathname,hash:"",search:""},"string"==typeof ba?u$$module$libs$history_production_min(ba):ba),{state:fa,key:o$$module$libs$history_production_min()})}
function B(ba,fa,R){return!W.length||(W.call({action:ba,location:fa,retry:R}),!1)}function E(ba){H=ba;[N,T]=g();O.call({action:H,location:T})}function F(ba){I.go(ba)}let {window:K=document.defaultView}=a,I=K.history,J=null;K.addEventListener("popstate",function(){if(J)W.call(J),J=null;else{let ba=t$$module$libs$history_production_min.Pop,[fa,R]=g();if(W.length){if(null!=fa){let da=N-fa;da&&(J={action:ba,location:R,retry(){F(-1*da)}},F(da))}}else E(ba)}});let H=t$$module$libs$history_production_min.Pop,
[N,T]=g(),O=i$$module$libs$history_production_min(),W=i$$module$libs$history_production_min();return null==N&&(N=0,I.replaceState(Object.assign(Object.assign({},I.state),{idx:N}),"")),{get action(){return H},get location(){return T},createHref:q,push:function da(fa,R){let ha=t$$module$libs$history_production_min.Push,ma=u(fa,R);if(B(ha,ma,function(){da(fa,R)})){let [ka,pa]=[{usr:ma.state,key:ma.key,idx:N+1},q(ma)];try{I.pushState(ka,"",pa)}catch(la){K.location.assign(pa)}E(ha)}},replace:function ha(R,
da){let ma=t$$module$libs$history_production_min.Replace,ka=u(R,da);if(B(ma,ka,function(){ha(R,da)})){let [pa,la]=[{usr:ka.state,key:ka.key,idx:N},q(ka)];I.replaceState(pa,"",la);E(ma)}},go:F,back(){F(-1)},forward(){F(1)},listen:R=>O.push(R),block(R){let da=W.push(R);return 1===W.length&&K.addEventListener("beforeunload",l$$module$libs$history_production_min),function(){da();W.length||K.removeEventListener("beforeunload",l$$module$libs$history_production_min)}}}}
function n$$module$libs$history_production_min(a={}){function g(){let {pathname:fa="/",search:R="",hash:da=""}=u$$module$libs$history_production_min(I.location.hash.substr(1)),ha=J.state||{};return[ha.idx,{pathname:fa,search:R,hash:da,state:ha.usr||null,key:ha.key||"default"}]}function q(){if(H)ba.call(H),H=null;else{let fa=t$$module$libs$history_production_min.Pop,[R,da]=g();if(ba.length){if(null!=R){let ha=T-R;ha&&(H={action:fa,location:da,retry(){K(-1*ha)}},K(ha))}}else F(fa)}}function u(fa){var R=
document.querySelector("base"),da="";R&&R.getAttribute("href")&&(R=I.location.href,da=R.indexOf("#"),da=-1===da?R:R.slice(0,da));return da+"#"+("string"==typeof fa?fa:c$$module$libs$history_production_min(fa))}function B(fa,R=null){return Object.assign(Object.assign({pathname:O.pathname,hash:"",search:""},"string"==typeof fa?u$$module$libs$history_production_min(fa):fa),{state:R,key:o$$module$libs$history_production_min()})}function E(fa,R,da){return!ba.length||(ba.call({action:fa,location:R,retry:da}),
!1)}function F(fa){N=fa;[T,O]=g();W.call({action:N,location:O})}function K(fa){J.go(fa)}let {window:I=document.defaultView}=a,J=I.history,H=null;I.addEventListener("popstate",q);I.addEventListener("hashchange",()=>{let [,fa]=g();c$$module$libs$history_production_min(fa)!==c$$module$libs$history_production_min(O)&&q()});let N=t$$module$libs$history_production_min.Pop,[T,O]=g(),W=i$$module$libs$history_production_min(),ba=i$$module$libs$history_production_min();return null==T&&(T=0,J.replaceState(Object.assign(Object.assign({},
J.state),{idx:T}),"")),{get action(){return N},get location(){return O},createHref:u,push:function ha(R,da){let ma=t$$module$libs$history_production_min.Push,ka=B(R,da);if(E(ma,ka,function(){ha(R,da)})){let [pa,la]=[{usr:ka.state,key:ka.key,idx:T+1},u(ka)];try{J.pushState(pa,"",la)}catch(ta){I.location.assign(la)}F(ma)}},replace:function ma(da,ha){let ka=t$$module$libs$history_production_min.Replace,pa=B(da,ha);if(E(ka,pa,function(){ma(da,ha)})){let [la,ta]=[{usr:pa.state,key:pa.key,idx:T},u(pa)];
J.replaceState(la,"",ta);F(ka)}},go:K,back(){K(-1)},forward(){K(1)},listen:da=>W.push(da),block(da){let ha=ba.push(da);return 1===ba.length&&I.addEventListener("beforeunload",l$$module$libs$history_production_min),function(){ha();ba.length||I.removeEventListener("beforeunload",l$$module$libs$history_production_min)}}}}
function a$$module$libs$history_production_min(a={}){function g(O,W=null){return Object.assign(Object.assign({pathname:H.pathname,search:"",hash:""},"string"==typeof O?u$$module$libs$history_production_min(O):O),{state:W,key:o$$module$libs$history_production_min()})}function q(O,W,ba){return!T.length||(T.call({action:O,location:W,retry:ba}),!1)}function u(O,W){J=O;H=W;N.call({action:J,location:H})}function B(O){let W=r$$module$libs$history_production_min(I+O,0,K.length-1),ba=t$$module$libs$history_production_min.Pop,
fa=K[W];q(ba,fa,function(){B(O)})&&(I=W,u(ba,fa))}let {initialEntries:E=["/"],initialIndex:F}=a,K=E.map(O=>Object.assign({pathname:"/",search:"",hash:"",state:null,key:o$$module$libs$history_production_min()},"string"==typeof O?u$$module$libs$history_production_min(O):O)),I=r$$module$libs$history_production_min(null==F?K.length-1:F,0,K.length-1),J=t$$module$libs$history_production_min.Pop,H=K[I],N=i$$module$libs$history_production_min(),T=i$$module$libs$history_production_min();return{get index(){return I},
get action(){return J},get location(){return H},createHref:function(O){return"string"==typeof O?O:c$$module$libs$history_production_min(O)},push:function fa(W,ba){let R=t$$module$libs$history_production_min.Push,da=g(W,ba);q(R,da,function(){fa(W,ba)})&&(I+=1,K.splice(I,K.length,da),u(R,da))},replace:function R(ba,fa){let da=t$$module$libs$history_production_min.Replace,ha=g(ba,fa);q(da,ha,function(){R(ba,fa)})&&(K[I]=ha,u(da,ha))},go:B,back(){B(-1)},forward(){B(1)},listen:ba=>N.push(ba),block:ba=>
T.push(ba)}}function r$$module$libs$history_production_min(a,g,q){return Math.min(Math.max(a,g),q)}function l$$module$libs$history_production_min(a){a.preventDefault();a.returnValue=""}function i$$module$libs$history_production_min(){let a=[];return{get length(){return a.length},push:g=>(a.push(g),function(){a=a.filter(q=>q!==g)}),call(g){a.forEach(q=>q&&q(g))}}}function o$$module$libs$history_production_min(){return Math.random().toString(36).substr(2,8)}
function c$$module$libs$history_production_min({pathname:a="/",search:g="",hash:q=""}){return g&&"?"!==g&&(a+="?"===g.charAt(0)?g:"?"+g),q&&"#"!==q&&(a+="#"===q.charAt(0)?q:"#"+q),a}function u$$module$libs$history_production_min(a){let g={};if(a){var q=a.indexOf("#");0<=q&&(g.hash=a.substr(q),a=a.substr(0,q));q=a.indexOf("?");0<=q&&(g.search=a.substr(q),a=a.substr(0,q));a&&(g.pathname=a)}return g}var module$libs$history_production_min={};module$libs$history_production_min.Action=t$$module$libs$history_production_min;
module$libs$history_production_min.createBrowserHistory=e$$module$libs$history_production_min;module$libs$history_production_min.createHashHistory=n$$module$libs$history_production_min;module$libs$history_production_min.createMemoryHistory=a$$module$libs$history_production_min;module$libs$history_production_min.createPath=c$$module$libs$history_production_min;module$libs$history_production_min.parsePath=u$$module$libs$history_production_min;const html$$module$code=$jscompDefaultExport$$module$libs$htm.bind(y$$module$libs$preact);class YMock$$module$code{constructor(){this.map=new Map}observe(a){}get(a){return this.map.get(a)}set(a,g){this.map.set(a,g)}}
class App$$module$code extends k$$module$libs$preact{constructor(){super();this.state={mode:"hexmap",hexlist:[],borders:[],unauth:!1};this.theme=is_electron$$module$api_shim?"hexroll-default-theme":"/hexroll-default-theme";window.main=this;window.app=this;this.last_uuid=this.map2=null;this.inhibit_rerolls=this.inhibit_click=!1;this.settlements_cache={};this.locked=!0;this.yarray=new YMock$$module$code;this.reroll_handlers=new Map}hideMap(){this.minimap||(this.minimap=!0,document.getElementById("content").style.display=
"block",document.getElementById("entity-container").style.display="block",this.map.setState({col1:"rect1"}))}showMap(){this.setState({mode:"hexmap"});this.minimap&&(this.minimap=!1,document.getElementById("content").style.display="none",document.getElementById("entity").innerHTML="",this.map.setState({col1:"col1"}))}reroll(a){this.map.reroll(a,"default")}reroll_ex(a,g,q){this.map.reroll(a,g,q)}append(a,g,q){this.map.append(a,g,q)}unauth(){this.setState({unauth:!0})}onAuthAck(){this.setState({unauth:!1})}render(){const a=
this.state.unauth?html$$module$code`
          <div id="myModal" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
              <div class="close">
                <a onClick="${()=>this.onAuthAck()}"> ${"\u00d7"} </a>
              </div>
              <h5>Hello Adventurer!</h5>
              <p>
                You are currently using an ephemeral sandbox. Ephemeral
                sandboxes have a 1,000,000 gp credit limit and are not
                guaranteed to stay online.
              </p>
              <p>
                If you are a Patreon subscriber, make sure you are logged in to
                claim this sandbox and enjoy an unlimited credit as well as
                online storage and cloud backup.
              </p>
            </div>
          </div>
        `:html$$module$code``;return html$$module$code`
      ${a}
      <${D$$module$libs$preact_router_module} history=${is_electron$$module$api_shim?n$$module$libs$history_production_min():void 0}>
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="normal"
         path="/"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="normal"
         path="/sandbox/:instance"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         mode="append"
         path="/sandbox/:instance/append"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/sandbox/:instance/:type/:hex_uuid/edit"
         mode="edit"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/sandbox/:instance/:type/:hex_uuid/"
         mode="view"
       />
        <${HexView$$module$hexview}
         ref=${g=>this.map=g}
         path="/sandbox/:instance/:type/:hex_uuid/npc/:npc"
       />
      </${D$$module$libs$preact_router_module}>
    `}}let app$$module$code;B$$module$libs$preact(html$$module$code`<${App$$module$code} ref=${a=>app$$module$code=a} />`,document.getElementById("app"));var module$code={};
